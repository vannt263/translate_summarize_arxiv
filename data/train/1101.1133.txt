{
  "article_text": [
    "a central issue in complex systems research is to understand the formation and the properties of spatio - temporal patterns found in physics and biology . to this end",
    ", an essential step is the definition of appropriate measures of their form : quantitative estimators that allow to compare different patterns and to objectively validate models .",
    "this paper focuses on the family of spatial patterns that are `` network - like '' .",
    "network - like patterns are common in natural and artificial systems : they are found in leaf veins , fractures on the surface of materials , patterns of urban streets and animal trails  /  galleries , river networks , blood vessels and circulatory systems .",
    "the factors underlying the formation of these patterns are different from system to system : surface cracks result from the shrinkage and stress of materials ; urban streets are generated by human activity and so on . in spite of intrinsic differences ,",
    "a few simple morphogenetic events describe the formation of all these patterns : nucleation of new network components , elongation of existing segments , branching and intersection .",
    "the final topology of the pattern is completely determined by the sequence of such growth events , plus a pruning event : the cut or removal of already formed segments .",
    "many studies have used topological estimators to describe the form of network - like patterns and better understand their morphogenesis and functional properties .",
    "one of the first progresses in this direction goes back to the horton - strahler coefficients  @xcite , a simple but powerful tool to describe quantitatively the form of hydrogeologic networks .",
    "the coefficients , which work by assigning rank numbers to every branch of a tree - like network , were successfully applied to the study of different systems , from river networks  @xcite , to leaf patterns  @xcite , and even to ant trail  @xcite and termite gallery  @xcite patterns .",
    "unfortunately , horton ",
    "strahler s coefficients can not be computed on networks with cycles .",
    "this has a profound impact on the applicability of the method , as many real - world network - like patterns have cycles .",
    "general graphs are characterized by a whole set of measures of the local and global organization : node degree , assortativity between nodes , clustering coefficient , frequency of specific subgraphs , presence and number of cycles , diameter , path length etc .",
    "several studies have computed graph measures and used them to quantify the local and large scale organization of real world spatial patterns , such as urban street patterns  @xcite , systems of animal trails  @xcite and galleries  @xcite , networks of channels in trabecular bones  @xcite , networks of fungal hyphae  @xcite .",
    "unfortunately , purely topological estimators , however useful , do not fully account for the organization of 2d network - like patterns which undergo specific constraints .",
    "for instance , in planar graphs , the average node degree can not be higher than six  @xcite .",
    "in addition , for a number of network - like patterns , the degree distribution is even more regular than what is imposed by planarity : the large majority of nodes is found to have degree equal to three in very different systems , such as two - dimensional foams  @xcite , honeycomb patterns and biological epithelia  @xcite , leaf vein networks  @xcite , fracture patterns  @xcite . in self - organized , `` bottom - up '' towns  @xcite the majority of junctions between streets also have degree three ( though the same does not hold for planned towns , where the majority of crossroads have degree four  @xcite or even higher  @xcite ) . the homogeneity of degree is reflected by an homogeneity in the length of network cycles that are composed by six edges on average in all the aforementioned systems .",
    "similarly , network distances are not very informative as they basically scale with euclidian distances in all these systems .    here",
    "we want to use the spatial information to provide a deeper understanding of the pattern .",
    "we focus in particular on the information carried by the angles formed at junctions .",
    "this choice is motivated by two complementary arguments , one about the physics of the growth of the network - like pattern , which can influence directly the branching angles , and the other about dynamic properties ( e.g. navigation ) that may be associated with the resulting network .    throughout the text ,",
    "as we consider spatial networks , we will make extensive use of the words _ edge _ , _ arc _ and _ segment _ with the following definitions : an _ edge _ is a curve -generally almost linear- between two consecutive junctions ( classical network edge ) ; an _ arc _ is a directed edge when an orientation is added to the network ; a _ segment _ is a series of contiguous edges grouped together as described later in section [ sec : algorithm ] and used to reveal a structuration at a larger scale .",
    "network - like patterns often are formed as the result of a sequential process , where new segments appear at different times  @xcite without undergoing further reorganization .",
    "one example of such patterns is provided by the fracture lines on the glaze of ceramics illustrated in figure  [ fig : examplecrack ] .",
    "bohn et al .",
    "@xcite suggested that urban streets patterns fall into this same morphological class .",
    "the appearance , elongation and termination of new segments is affected by the older segments ; the older segments , however , do not undergo further reorganisation as a consequence of the appearance of new ones . under these conditions ( sequential process ,",
    "growth with no deletion of edges and absence of reorganization ) the temporal hierarchy in the appearance of segments is reflected into the spatial hierarchy of lengths and arrangements of the final pattern  @xcite . across a junction",
    "the edges belonging to the older segment are the straight continuation of one another ; conversely , the edge belonging to the newer segment typically forms a large angle with the others .",
    "but the local angle information is not sufficient in itself to attribute the edges to the same or a different segment : consider the case of a junction like the one in figure [ fig : algorithm]-a . in the absence of any information , the most natural inference is to group edges @xmath0 and @xmath1 into the same , older , segment .",
    "the attribution is more problematic if one already knows that @xmath2 is older : then it would be more natural to group @xmath2 and @xmath0 into the same old segment , and assume @xmath1 appeared later . in summary ,",
    "the best inference about what network edges should be grouped into the same segment depends on the continuity between adjacent edges , but also on the information already available about the order of appearance of other segments .",
    "it can be constructed only sequentially .",
    "when the network - like pattern is also the support for a transportation function , as it is for instance the case with patterns of urban streets , the angles of edges at intersections and junctions play a role for navigation and orientation .    in architecture , this concept has been theorized under the name of `` space syntax ''  @xcite . with the space syntax method of analysis",
    ", urban street patterns are fragmented into a number of straight segments ( ideally the minimum number of segments in which the line of view is conserved ) and one analyses the network obtained representing straight segments as nodes , and intersections between segments as edges . then selecting a line ( a street ) as a starting point",
    ", one can number each line in the map according to how many changes of direction separate it from the starting line .",
    "this measure is generally referred to as `` depth '' and is a measure of distance : it represents the minimum number of changes of direction to go from the origin to any other place in the street network .",
    "this kind of measure has been correlated with different aspects of social life : patterns of pedestrian movement , traffic , property value and so on  @xcite .",
    "nevertheless , the process of fragmenting street patterns into segments with the same line of sight was not proven to always have a computable solution and it might be too sensitive to small differences of orientation of the urban grid  @xcite .    in the physics literature , analogous ideas are followed through what is usually called a `` dual network '' approach ( though a more appropriate definition would be `` line network '' approach ) , where named streets  @xcite or contiguous segments  @xcite are mapped into network nodes and there is an edge whenever two streets intersect or bifurcate .",
    "dual networks also provide a convenient representation for measuring the amount of information necessary to navigate inside the network  @xcite , in particular for navigation strategies relying more upon the continuity of linear elements than on salient points .",
    "in fact one can imagine to describe a path through the network with instructions of the form : `` go straight for n steps ( n junctions or crossroads ) , or until you find a salient point ( a traffic light , a square ... ) '' , followed by information on which new direction to take . in general a `` simple '' path",
    "will be one that involves only few deviations from the current direction , not necessarily a short one .",
    "however , the result will not be the same depending on the direction followed .",
    "let s illustrate this with reference to the junction of figure [ fig : algorithm]-a .",
    "moving from edge @xmath0 to @xmath1 , or in the opposite direction from @xmath1 to @xmath0 does not involve any change of direction .",
    "going from @xmath0 to @xmath2 requires one change of direction ( i.e. to abandon the straightest path and take an alternative one ) , but the opposite is not true since @xmath0 is the more direct continuation of movement when coming from @xmath2 .",
    "both the argument about network growth and the argument about navigation illustrate the interest of classifying the edges of network - like patterns using information provided by junctions angles .",
    "our exaxmples also indicate that the process is not symmetric with respect to the starting point used for classification .    in the following section [ sec : algorithm ] we introduce a new algorithm that given a local rule ( namely an evaluation of the angles at each junction ) and a set of arbitrarily chosen root edges , assigns a rank ( expressed by an integer number ) to each edge of the network - like pattern .",
    "contiguous edges with the same rank can then be grouped together into segments .",
    "the numbers of segments for each given rank and their average properties provide a quantitative statistical characterization of the morphology of the pattern .",
    "possible applications to lattices and real world spatial networks are explored in the remaining sections [ sec : lattices ] to [ sec : conclusions ] .",
    "the classification and numbering of segments involves two steps .",
    "first , given a root edge , or a set of root edges , a rank number is assigned to each edge . then , the contiguous edges with the same rank are grouped into segments .",
    "let us denote by @xmath3 a graph which models a network - like structure .",
    "given a root edge @xmath4 in @xmath3 , the rank of an edge @xmath5 of @xmath3 expresses the minimum number of direction changes needed to reach @xmath5 when coming from @xmath4",
    ". we can also take into account a set @xmath6 of root edges ; in this case , the rank of @xmath5 is the minimum number of direction changes when coming from the closest root edge in @xmath6 .",
    "the propagation of ranks across a junction depends on the direction in which the junction is traversed .",
    "for instance , in the graph of figure [ fig : algorithm]-a if we set the rank of edge @xmath7 to zero ( @xmath8 by convention ) , then the rank of @xmath9 is equal to 1 ( @xmath10 ) , but the same relation does not hold in the opposite direction : if we set the rank of @xmath9 to zero ( @xmath11 by convention ) , then the rank of @xmath7 is also equal to zero ( @xmath8 : no deviation from the straightest path when going from @xmath9 to @xmath7 ) .    generally speaking , each edge @xmath5 can be crossed in two directions ; by convention , we denote @xmath12 ( resp .",
    "@xmath13 ) the arc associated to @xmath5 when it is crossed towards the right ( resp . towards the left ) . to make the computation of all the ranks easier , we consider the directed line graph @xmath14 ( fig [ fig : algorithm]-b ) which models the connections between all the arcs .",
    "the vertices of @xmath14 are the arcs @xmath15 associated to any edge of @xmath3 , and two vertices @xmath16 and @xmath17 ( the star means either @xmath18 or @xmath19 ) are linked together in @xmath14 if the destination of @xmath16 is also the origin of @xmath17 .",
    "for instance , the crossing of the path @xmath20 from the left is modeled by @xmath21 in @xmath14 , and the crossing in the opposite direction by @xmath22 .",
    "there is no connection between @xmath23 and @xmath24 as the navigation @xmath25 is not directly possible .",
    "weights are assigned to the arcs of @xmath14 as follows .",
    "the weight @xmath26 is equal to @xmath27 when the path formed in the initial graph by the edges @xmath5 and @xmath28 is the straightest one and @xmath29 otherwise .",
    "we can also introduce a threshold on the maximum angle , implying that if the straightest pairing of edges still involves a too large angle , then it also will have weight equal to 1 .",
    "formally , @xmath30 when ( 1 ) the angle formed in the initial graph @xmath3 by @xmath16 and @xmath17 is the minimum angle formed by @xmath16 and its adjacent edges , and ( 2 ) this angle is smaller than a given threshold ( @xmath31 degrees in our analyses ) .",
    "once defined a root edge @xmath4 in the initial graph whose rank is equal to @xmath27 by convention , the rank @xmath32 of any other edge @xmath5 can be easily obtained by a distance computation in @xmath14 : @xmath33 where @xmath34 is the shortest path length in the directed line graph @xmath14 weighted by @xmath35 .",
    "when a set @xmath6 of root vertices is considered , the rank of @xmath5 is the minimum of the ranks computed from all the edges of @xmath6 with the above formula .",
    "several adjacent edges with the same rank can be grouped together into `` segments '' .",
    "a segment is a series of edges all having the same rank and with exactly two ends ( not including junctions ) .",
    "the segment is initialized with any edge of @xmath3 .",
    "its continuation is determined by pairing together adjacent edges of the same rank until one of the following conditions is encountered :    1 .",
    "there are no more edges with the same rank at one extremity .",
    "[ list : no_more_edges ] 2 .",
    "the segment intersects an edge of lower rank .",
    "[ list : lower_rank ]    in the special case when three or more edges with the same rank are incident to the same junction , the continuation of the segments is determined by pairing together the two edges that provide the straightest continuation of one another . then , we proceed in a similar way pairing together all the other edges incident to the node .",
    "if an odd number of edges with the same rank meet at a junction , one edge remains excluded from all the pairings and the segment containing that edge is ended at the junction .",
    "we can give an intuitive justification for the above rules .",
    "imagine the case of a network - like pattern resulting from a sequential growth process , such as for instance fracture lines on ceramics .",
    "grouping edges into segments is equivalent to identify those network edges that belong to the same line of fracture . with condition [ list : lower_rank ]",
    "we impose that younger lines of fracture ( higher ranks ) never cross already formed fracture lines .",
    "a parallel can also be found with what happens for urban street patterns , where small streets usually change their name when crossing larger ones .",
    "figure [ fig : group_segments ] shows examples of how segments are grouped together . in a1 the near - horizontal edges have lower rank than the near - vertical edges . in this case , the near - vertical edges form two distinct segments ( a2 ) , in spite of being in direct continuity .",
    "b1 presents exactly the same pattern , except that now all the edges have the same rank . in this case",
    ", the edges are grouped together in two intersecting segments , one near - horizontal and one near - vertical ( b2 ) .",
    "when there is an odd number of edges incident to a junction , as in c1 , the couple(s ) of edges that deviate less from each other s direction are paired together in the same segment(s ) and the remaining edge forms a segment by itself , which is ended at the junction ( c2 ) .    to summarize ,",
    "the straight contiguity of edges is well represented by a directed line graph @xmath36 whose arcs are weighted with appropriately chosen weights .",
    "the arbitrary selection of a set of root edges in @xmath3 allows to express changes of direction in terms of a distance measure , allowing to assign each edge of @xmath3 a ranking number .",
    "edges that are more likely to belong to the same spatio - temporal event of network formation can be grouped together into segments .",
    "the c++ computer code implementing the rank computation and segment mapping is available as online supplementary material , alongside with sample networks to test it .",
    "in this section we explore the distribution of segment ranks and edge ranks in a simple lattice model . in particular",
    ", we introduce a class of lattice models that we call `` mondrian '' lattices ( figure [ fig : lattice ] ) , intended to mimic the growth process and the characteristics of hierarchical network - like patterns . in order to build the lattice ,",
    "we start with a single rectangular domain and we iterate the following operation : each rectangular cell of the lattice is divided in two smaller rectangles by introducing a new cut parallel to one of its sides ( let s say horizontal or vertical ) at a random position chosen from a normal distribution around its centre .",
    "the cuts can either be `` alternating '' , where horizontal cuts at time @xmath37 are followed by vertical cuts at time @xmath38 , and vice - versa , or `` random '' , where the horizontal or vertical direction of cut is chosen randomly for each cell and each division .    here , and",
    "in the rest of the paper , we will focus mainly on two kinds of statistics .",
    "the first is the histogram of _ segment _ ranks ( the frequency of occurrence of segments with a given rank ) .",
    "the second measure relies on _ edges _ ( not segments ) and looks at how the ranks of individual edges increase with their topological distance from the roots .",
    "the topological distance between an edge @xmath39 and a root @xmath40 is the minimum number of junctions on a path between @xmath40 and @xmath39 in @xmath3 .",
    "intuitively , the rank measures the number of direction changes needed to reach a particular edge and the topological distance measures the number of vertices crossed .",
    "hence , if we plot the rank @xmath41 of each network edge @xmath5 against its topological distance from the roots @xmath42 , we obtain a characteristic distribution that can be fitted with a linear function of the form    @xmath43    the slope of the fitting line is @xmath44 , and its inverse @xmath45 , gives the average length of the straight segments .",
    "this can also be interpreted as the largest scale at which spatial organization is observed .",
    "figure [ fig : lattices_6_12_18 ] , top row , displays the histogram of segment ranks for mondrian lattices after 6 , 12 and 18 iterations of divisions .",
    "the orange and cyan histograms are for alternating and random divisions , respectively . for random divisions",
    "the asymptotic distribution can be approximated by a normal distribution :    @xmath46    where @xmath47 ( where @xmath37 is the number of iterations of the division process ) , @xmath48 and @xmath49 .",
    "( details on how the parameters @xmath50 , @xmath51 and @xmath52 were estimated are provided in the appendix ) . in practice , for a pattern observed at a given time , @xmath37 is usually unknown , and it is easier to approximate it in terms of the number of cells @xmath53 , assuming that the relation @xmath54 holds . the number of cells for a planar graph in turn is obtained from the number of edges and vertices in the network through the euler s formula , @xmath55 ( where @xmath56 is the number of vertices and @xmath57 the number of edges ) . in this way we can compute the theoretical rank distribution for lattices of given size .",
    "such theoretical distributions are reported as dotted lines on top of the histograms of figure [ fig : lattices_6_12_18 ] , top row , as well as in different figures throughout the paper .",
    "figure [ fig : lattices_6_12_18 ] , bottom row , plots the rank @xmath41 vs. the topological distance @xmath42 for each network edge @xmath5 of alternating mondrian lattices of different sizes ( 6 , 12 and 18 iterations of division ) , together with a linear fit of the distribution ( continuous red line ) .",
    "we can see that when the number of iterations of division increases , the overall slope decreases , revealing in fact a curved relation .",
    "this is not surprising , as topological distances typically scale with the square root of the lattice size , while ranks increase with the logarithm of the size .",
    "these simple lattice models may not be representative of the configurations of real world patterns with less regular edge orientations . in order to assess the robustness of rank indices when the edge orientations are altered , we proceeded as follows .",
    "starting from a lattice of @xmath58 cells , obtained through alternating divisions , we iterated the following operation : at each time step the node positions are shifted by computing the resultant of vectors directed along the incident edges and oriented centrifugally .",
    "each vector has magnitude arbitrarily fixed to @xmath59 , where @xmath19 is the length of the side of the grid .",
    "this progressively transforms the mondrian lattice of figure [ fig : lattice]-a into the foam - like patterns of [ fig : latticesdegradate]-b and c. in order to prevent the lattice from shrinking during this process , we impose periodic boundary conditions by merging together the opposite sides of the lattice .",
    "after the degradation phase , the boundaries are separated again , and the rank computation proceeds normally , except that new nodes have been introduced along the perimeter of the lattice , doubling the nodes already existing on the opposite side of the lattice .",
    "such an evolution from orthogonal to symmetric junctions is not a purely geometric artifice : many real world patterns do actually evolve from an orthogonal to a symmetric configuration , as the result of forces that minimize the local length of the network edges . for instance , in basaltic lava rocks , the junctions , initially appearing at right angles , progressively evolve towards a symmetric configuration with angles of 120 degrees as the joints grow inward during solidification of lava  @xcite . in a similar way",
    ", leaf veins seem to intersect at right angles when they first appear , but then to evolve continuously towards more symmetric foam - like junctions  @xcite .",
    "figure [ fig : latticesdegradate ] shows two snapshots -at different steps of degradation- of the lattice in figure [ fig : lattice ] .",
    "the three lattices ( fig [ fig : lattice]-a and fig [ fig : latticesdegradate]-b , c ) all correspond to a portion of the orthogonal mondrian lattice with @xmath58 cells from which the plots of figure [ fig : lattice12degradata ] are drawn .",
    "the plots in figure [ fig : lattice12degradata ] report the statistics of segment histograms ( top ) and edge rank vs. edge distance ( bottom ) for the three levels of degradation of a ( no degradation ) , b ( 70 iterations of degradation ) and c ( 140 iterations ) . with increasing degradation",
    ", the histogram of segment ranks becomes flatter and its center shifts far to the right of the theoretical peak expected for pure mondrian lattices .",
    "the slope of edge rank vs. edge distance , that is nearly zero for the original lattice a , increases progressively .",
    "figure [ fig : slopedegradation ] shows that the slope undergoes a continuous transition on a relatively large scale ( i.e. it is still relatively low also for networks , such as the lattice b , whose histogram of segment ranks is already flat ) .",
    "this means that once the large scale coherence is lost , the length over which coherence persists ( inverse of the slope ) , decreases continuously . in other words",
    "the slope is a quantitative measure of the amount of disorder between the two extremes of a mondrian lattice ( @xmath60 ) and a foam like pattern ( @xmath61 ) . in the case of this latter ,",
    "the rank increases at almost every junction .    in general , real world patterns",
    "are expected to deviate in various ways from these simple lattice models . in the rest of the paper",
    "we explore the distribution of ranks and segment statistics in three different examples of real world network - like patterns : the pattern of fracture on the surface of materials , patterns of leaf veins in dicotyledon plants , and the pattern of urban streets in ( unplanned ) towns .",
    "crack patterns often form on the surface of materials as the result of the shrinking of one material layer frustrated by its deposition on a non - shrinking substrate .",
    "this kind of pattern formation has been extensively observed and reproduced in controlled settings on a variety of materials , including mud , ceramics and coffee grounds .",
    "the final patterns result from the combination of two distinct processes : the nucleation of new fractures and the propagation of already existing ones  @xcite .",
    "nucleation of new fractures usually involves the formation of tripartite junctions with equal angles of about 120 degrees  @xcite .",
    "conversely , junctions formed by propagating fractures are the result of either two fractures meeting at a point ( usually with an orthogonal angle ) , or of the branching of one growing fracture ( in this latter case the angles formed at the junction are less predictable ) . if the crack pattern is produced in a non - elastic material , there is no reorganization after its formation and the final form of the pattern reflects the mechanisms of formation .",
    "depending on the characteristics of the material , either nucleation of new fractures will be the most frequent process , or propagation of already formed fractures over long distances .",
    "nucleation is more frequent in the case of very thin layers or inhomogeneous materials ; propagation is predominant in brittle , homogeneous materials such as ceramics .",
    "patterns resulting mainly from the propagation of already formed fracture lines present a well defined hierarchy due to the sequential formation process .",
    "one such pattern is shown in figure [ fig : examplecrack ] .",
    "figure [ fig : excrackanalysed ] shows the ranks inferred by our algorithm when the two long horizontal lines are selected as roots .",
    "there is a partial mismatch between real and inferred hierarchy .",
    "this is in part due to the fact that when a cell is cut in two halves by a fracture , then the two halves become independent and it is no longer possible to establish a temporal relation between the new fracture events within a cell and those in the neighboring one . in the case of perfect hierarchical organization (",
    "as is the case for the pattern shown in figure [ fig : excrackanalysed ] ) one could also gain information by considering the organization of angles at both extremities of a segment : the fracture line marked with @xmath62 terminates the fracture marked with @xmath63 , indicating that this latter is actually more recent .",
    "unfortunately , a method that considers both extremities would lose generality and could not resolve a `` circular configuration '' where a segment `` a '' is terminated by another segment `` b '' , the segment `` b '' is terminated by `` c '' and segment `` c '' is terminated by `` a '' .    once acknowledged that , depending on the characteristics of the material , some fracture patterns are mostly dominated by the nucleation of new fractures , and others by the elongation of existing ones , we want to test if our algorithm gives different classification results in the two cases .",
    "to this end , let us consider the crack patterns formed in three different materials : paint , desiccating clay and ceramics ( figure [ fig : cracks ] from top to bottom ) .",
    "the patterns were photographed with a digital camera , converted to grayscale images , high - pass filtered to remove inhomogeneities in the illumination , binarized by simple thresholding and cleaned applying a binary morphological majority filter ( see  @xcite for a review of common image processing techniques ) .",
    "the images of the fracture patterns were then skeletonized with a topology preserving algorithm based on distance transformation  @xcite to obtain a 8-connected skeleton ( a skeleton where two pixels are considered to be connected if they share either a face or a corner , opposed to a 4-connected skeleton where only pixels that share a face are considered to be connected ) . for each skeleton pixel",
    ", we counted the number of pixels in their 8-neighborhood that also belonged to the skeleton , and all the pixels having a number of neighbors not equal to 2 were marked .",
    "all the connected sets of marked skeleton pixels were mapped into a network node . whenever there was in the image an unmarked 8-connected path between two clusters of pixels identified as nodes we introduced an edge between the corresponding nodes .",
    "the orientation of each edge was estimated from the coordinates of the two endpoints . in a subsequent step ,",
    "edges shorter than a threshold length (  3 pixels ) were removed and the nodes at the two endpoints merged together .",
    "a rectangular section of the pattern is studied and all the edges crossing one side of the rectangle are selected as roots for the assignment of ranks .",
    "figure [ fig : cracks ] reports the statistics obtained on the three patterns , together with a snapshot of a small region of the original patterns ( on the right ) , where the structure is colored according to the rank of the corresponding network edge .",
    "very different distributions are observed for the cracks formed in paint and clay , versus cracks formed in ceramics : in the former two , the lack of large scale organization is reflected into the linear increase of ranks with the topological distance from the root and in a flat histogram of segment ranks .",
    "indeed , the junctions originating from nucleation of new fractures , whose angles are @xmath64 degrees , always determine an increase in the rank of edges across the junction .",
    "the inverse of the slope of the curve fitting the data gives an indication of the length over which crack elongation proceeds : about three junctions .",
    "conversely , for cracks formed in ceramics , the edge ranks are almost completely independent of the topological distance of edges from the roots , because of the large scale organization typical of these patterns .",
    "the slope of the rank vs. distance distribution ( bottom plot , central column ) is thus close to zero , but we can still see a deviation of the rank histogram toward the left of the theoretical normal distribution expected for a pure mondrian lattice ( figure [ fig : cracks ] , bottom left plot ) .",
    "such small deviation is probably due to the fact that the analyzed region is a portion of a larger pattern and the cuts introduced by the arbitrary frame disconnected some edges from the network path that gives them their real rank .",
    "this also shows that rank distribution is a quite sensitive measurement .",
    "leaf veins in the leaves of flowering plants form characteristic patterns that can be used by botanists as keys for taxonomic identification .",
    "however this identification is done by eye and does not rely on quantitative measurements .",
    "the pattern is hierarchical , and the diameter of a vein roughly reflects its order of appearance during leaf morphogenesis , with larger veins being older than smaller ones  @xcite .",
    "botanists define discrete vein orders looking at vein width at the point of branching from its parent vein : the large primary vein or midvein is continuous with the stem vascular bundles ; secondary veins branch from the primary vein ; tertiary veins are defined by their narrower width where they branch from the secondary veins and so on .",
    "we tested our ranking algorithm on the vein patterns of angiosperm leaves .",
    "the leaves were skeletonized with 10% sodium hydroxide solution and the pattern was scanned with a commercial scanner in transmission mode with a resolution superior to 2000 pixels / inch and 256 gray levels .",
    "a network representation was extracted from the images in a similar way to what we described for cracks . in the ranking procedure ,",
    "the leaf stem is selected as root edge .",
    "this is in agreement with its special role for both transportation and leaf morphogenesis : the leaf stem is both the source ( through xylem ) and the sink ( through phloem ) of all transportation taking place in the leaf vein network , as well as the first vein to form during leaf morphogenesis  @xcite .",
    "figure [ fig : leaves ] shows a portion of leaf of _ hymenanthera chathamica _ with highlighted vein ranks obtained from our algorithm : veins with rank equal to 1 or 2 are shown in color in a , veins with rank 1 to 3 are highlighted in b and veins with rank 1 to 4 in c. the classification does not take into account the diameters of the veins , but only the orientation of the edges .",
    "nevertheless , the results of classification match well the diameter of the veins : from the figure , we can see that veins marked with higher ranks have in general smaller size ( which roughly corresponds to say that they have appeared later ) . in this sense",
    ", we also recover the vein patterns as derived from the botanical classification .",
    "this is consistent with the hypothesis that the older veins are not only larger but also straighter , as can be derived from the relation existing between vein sizes and junction angles  @xcite .",
    "however , some small veins attached to the main vein are given a small rank , while one would intuitively ascribe them to a higher rank .",
    "this illustrates well the non complete reversibility of the fragmentation process : for each vein we can infer the order of appearance with respect to the parent vein , but not the exact age .",
    "technically , also the botanical classification -based on diameters- has the same problem , because of the existing correlation between branching angles and diameter of veins .",
    "figure [ fig : statsleaves ] reports the histogram of segment ranks and the plot of edge rank vs. distance for both the _ hymenanthera chathamica _",
    "( _ hc _ ) leaf and for a leaf of _ ficus religiosa _",
    "( _ fr _ ) .",
    "network is about one magnitude order smaller than the _",
    "fr_. however , both networks are hierarchical : the histogram of segment ranks is peaked close to the theoretical value and the fitted slope of edge rank vs. distance is close to zero .",
    "the larger _ fr _ pattern is very close to the perfect hierarchical pattern ( its segment histogram overlaps quite well with the one of a perfect mondrian lattice of the same size ) .",
    "conversely , the histogram of segment ranks for _ hc _ deviates slightly from the theoretical one : it is still a gaussian but shifted to higher values . unlike the case of fractures , this can not be ascribed to boundary effects as the whole leaf with the boundary veins is analysed , nor to a simple small number of veins , as the network is large and the distribution is already very well defined .",
    "this shift might be due to the different plasticity of the veins during their maturation in the two plant species .",
    "more measurements should be made to check if this shift is due to the difference in species or to the different maturation of the leaves depending on their sizes .",
    "the growth of urban street systems is a complex process determined by a series of historical events and involving feed - back and regulation from global network processes , such as traffic and transportation .",
    "however , in a first approximation , for self - organized cities , the general form of these patterns can be described in terms of simple models where new streets appear over time with no reorganisation  @xcite . within such models ,",
    "the first streets connect the first houses to the country . as the urban pattern grows , new streets bifurcate from existing ones in the direction of not yet urbanized areas , or to join already existing streets . in this respect , the process of growth of urban streets shares similarities with the growth of fracture patterns  @xcite , which supports the fact of assigning ranks to streets in a similar way .",
    "we here test our ranking method on the towns of cordoba ( spain ) and venice ( italy ) and compare the statistics obtained for the two towns . in both cases",
    "we choose the perimeter of the town as root for the rank computation .",
    "( the shores of venice and the highway ring around cordoba ) .",
    "figure [ fig : cordoba ] displays a map of the town of cordoba , where each edge is colored according to its rank .",
    "the highlighted region in the figure corresponds to the historical city centre .",
    "almost all the edges with highest rank appear to fall inside this region .",
    "higher ranks often are the mark of lack of global organization .",
    "a possible outlook for future analysis could be testing if higher ranks correspond to parts of town that developed in a period of more self - organized , organic growth ( e.g. periods when the central power was weaker ) .",
    "overall , the histogram of segment ranks ( reported in figure [ fig : towns ] top , left ) is still compatible with that of a hierarchical network , that is , it overlaps with the distribution expected for a mondrian lattice of the same size .",
    "the distribution of edge ranks vs. edge distance from the root edges is nearly flat , with a slight slope that can likely be ascribed to the relatively small size of the network .",
    "when the same analysis is carried out on the street pattern of venice , a quite different behavior is found : segments rank up to much higher values , suggesting an absence of large scale organization in this street pattern ( figure [ fig : towns ] , middle column ) .",
    "this does not seem to be a pure artifact of our method , but agrees with other elements of the organization of venice , where streets are not the principal element of organization of the town .",
    "this is reflected , for instance , in the fact that still today houses and buildings are not numbered according to their position along a street , but following a subdivision by districts ( `` sestieri '' ) .",
    "interestingly , when for venice one considers the transportation system including both streets and channels , the rank distribution gets closer to one of a hierarchical network ( figure [ fig : towns ] , right ) .",
    "this reveals that the channels are the original part of the transportation system , and the origin of the town organization .",
    "the houses were first built along the channels with direct access to them ( figure [ fig : venezia ] ) , and the streets appeared inside the islands delimited by the channels , as secondary divisions for inland house access . thus removing the channels from the analysis is removing the large coherent structure , and thus has a direct visible impact on the rank distribution . on the contrary , with the channels",
    "included , the hierarchical structure of successive divisions is recovered .",
    "so , the rank analysis has the potential of showing some peculiarities of specific towns , and at the same time of pointing to the possible reasons for these peculiarities .",
    "in this article we introduced a new method to analyze spatial networks with loops and define quantitative measurements on them .",
    "the need to characterize quantitatively the form ( and the possible morphogenesis ) of network - like patterns motivated us to introduce a procedure for assigning ranks to all the edges of the pattern and group several edges into segments . using a local spatial characteristic , the branching angles",
    ", we are able to quantify the large scale coherence of the pattern .",
    "the first measurement we propose , the distributionof segment ranks , is a very sensitive indicator of the existence of a large scale spatial coherence and of hierarchical subdivisions .",
    "when this large scale coherence is lost , the measurement quantifies the scale over which organization persists , up to the point of purely local organization .",
    "this scale is directly given by the inverse of the slope of edge ranks vs. edge distances from the root . when tested on lattice models ,",
    "these measurements show a dichotomy between two types of network , one with large scale coherence and one with purely local organization .",
    "the method is efficient on different real patterns of various origin , from fractures to leaf venation and urban streets .",
    "the obtained measures show the potential to discriminate between patterns with hierarchical history of growth and patterns grown out of more local rules . for fracture patterns ,",
    "the two cases of many locally generated fractures that reconnect and few fractures propagating on large distance can be distinguished with no ambiguity . for leaf venation pattern , the method clearly reveals a hierarchical growth mechanism .",
    "in addition , the rank assigned to network segments correlates to some extent with the temporal order of appearance of the same segments , and hence the measure is informative on the process of growth itself .",
    "the matching between ranks and order of appearance however is not perfect , and the information provided by the ranks should be complemented from other sources for individual systems .",
    "for instance , with leaf veins one could consider both ranks and vein diameter to obtain a better classification of veins into discrete orders .",
    "this analysis is also sensitive on town streets , and is able to reveal the particular organization of streets in venice , whose structure can be explained as a secondary construction from the channels .",
    "the town structures are otherwise coherent with that of a sequential sub - division pattern , indicating some underlying logic in its development .",
    "we believe that the method can be generally applied to different types of patterns , revealing not only their structure but also in part the history of their growth . in the present paper",
    ", we built the classification from local angle information .",
    "more generally , however , any other local information can be used , such as -for instance- the size of the connecting element , to construct a similar hierarchy .",
    "it is thus a new , general and efficient way to analyze networks with loops and group patterns of very diverse origins into the same structure and development classes .",
    "the distribution of segment ranks in a mondrian lattice can be computed more easily if one recognizes that the cuts within a cell only affect the distribution of segment ranks for that particular cell , but not for the neighbouring ones .",
    "we can identify two kinds of cells ( `` a '' and `` b '' in figure [ fig : diagram ] ) , and two possible cuts for each cell ( either orthogonal or parallel to the side with the lowest rank ) . for any given cell and cut combination ,",
    "both the resulting cells and the new segments added are determined : a cell of type `` a '' , whose minimum rank is @xmath65 can give rise either to two cells of type `` a '' and with minimum rank @xmath65 , or to two cells of type `` b '' also with minimum rank @xmath65 . in the first case , the cut will introduce a new segment with rank @xmath66 , while in the second it will introduce a segment with rank @xmath67 . a cell of type `` b '' and minimum rank @xmath65 can generate two cells of type `` b '' and rank @xmath65 ; in this case it will add a new segment with rank @xmath66 as well as a new segment with rank @xmath67 .",
    "this latter results from the `` cut '' operated by the new segment with rank @xmath66 on the already existing segment with rank @xmath67 ( because we impose that a segment with higher rank is always ended when it meets one with lower rank ) .",
    "if the cut is in the other direction , the same `` b '' cell can generate one cell b with minimum rank @xmath65 and one cell `` a '' with minimum rank @xmath66 .",
    "if we assume that all the cuts have the same probability , that all the cells in the lattice are cut once for each time step and we take the average realizations , we obtain the following equations for the evolution of the pattern : @xmath68 where @xmath69 indicates the number of cells of type `` a '' with minimum rank @xmath65 at iteration @xmath37 and similarly for @xmath70 .",
    "@xmath71 is the total number of segments with rank @xmath65 at iteration @xmath37 .",
    "we iterate the above equations , starting with a single cell of type @xmath72 and minimum rank @xmath73 . with these formulae",
    "it is painless to go to very high numbers of cells and obtain well defined distributions .",
    "the first observation in the iterations is that the peaks of the distributions of @xmath50 , @xmath72 and @xmath74 shifts to the right by one rank unit every six iteration steps .",
    "these shifts have different phases for @xmath50 , @xmath72 and @xmath74 .",
    "in particular the phase shift for @xmath74 is @xmath75 , that is , the peak position @xmath51 of @xmath74 increases by one unit with pace @xmath76 . figure [ fig : mondrian_iterations]-a plots the position of the maximum @xmath51 as a function of the number of iterations for a few iterations of equations [ eq : segmentiterations ] around @xmath77",
    ".    we also guessed the way the maxima increase in amplitude with simple relationships : the scale of the numbers of cells @xmath50 , cells @xmath72 and segments @xmath74 is by contruction @xmath78 ( the number of cells ) .",
    "however , the maximum value does not simply scale in proportion to the number of cells , because the distribution gets larger while it moves to the right for increasing values of @xmath37 .",
    "in particular , the scaling of standard deviation can be easily approximated by a simple formula as @xmath79 .",
    "we found that if the the distribution is normalized by @xmath80 , then the maximum remains nearly stable through iterations ( this is shown for a few iterations of equations [ eq : segmentiterations ] around @xmath77 in figure [ fig : mondrian_iterations]-b ) .",
    "when the distribution is rescaled in this way in width , position and amplitude , then it falls onto a perfect parabola in log coordinates ( shown in figure [ fig : mondrian_iterations]-c after 1000 iterations ) , without any change when increasing the number of iterations , except for attenuating fluctuations .",
    "so , even if we lack a theoretical demonstration , we know that the expression of @xmath81 in equation [ theoreticalsegments ] is a guassian and the dependencies on the parameters are asymptotically exact . fitting a gaussian on this distribution after a very large number of iterations ( @xmath82 , that is , a number of cells of @xmath83 , -numerical approximation problems appear in our code around iteration 1024- ) , give the fitting parameters used in equation [ theoreticalsegments ] of 1.043 and 1.020 respectively ( these numbers could possibly be approximations of @xmath84 and @xmath85 , respectively ) .",
    "we are grateful to fabien picarougne for comments and advice on the c++ implementation of the algorithm .",
    "we thank alessio cardillo , christian jost and arianna bottinelli for comments on previous versions of the manuscript .",
    "this work was supported by anr-06-byos-0008 .",
    "was also supported by an erc starting grant to david sumpter ( ref : idcab ) ."
  ],
  "abstract_text": [
    "<S> we propose a new method for quantitative characterization of spatial network - like patterns with loops , such as surface fracture patterns , leaf vein networks and patterns of urban streets . </S>",
    "<S> such patterns are not well characterized by purely topological estimators : also patterns that both look different and result from different morphogenetic processes can have similar topology . a local geometric cue -the angles formed by the different branches at junctions- can complement topological information and allow to quantify the large scale spatial coherence of the pattern . for patterns that grow over time , such as fracture lines on the surface of ceramics , the rank assigned by our method to each individual segment of the pattern approximates the order of appearance of that segment . </S>",
    "<S> we apply the method to various network - like patterns and we find a continuous but sharp dichotomy between two classes of spatial networks : _ hierarchical _ and _ homogeneous_. the first class results from a sequential growth process and presents large scale organization , the latter presents local , but not global organization . </S>"
  ]
}