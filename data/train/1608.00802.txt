{
  "article_text": [
    "ultra - light axions ( ulas ) are candidate particles for dark matter motivated by string theory compactifications @xcite that behave as `` fuzzy dark matter '' ( fdm ) @xcite . in these models , the gravitational growth of perturbations",
    "is suppressed below the `` quantum jeans length '' corresponding to the de broglie wavelength of particles with virial velocities .",
    "this effect has also been studied in the contexts of scalar field @xcite , bose - einstein condensate @xcite , or wave dark matter @xcite . for sufficiently light particles ( @xmath1 ev ) ,",
    "the jeans length is of the order of several kpc or larger , allowing mass - dependent constraints on the relative fraction of fdm to cdm from observations of galactic density profiles , halo statistics , large - scale structure , and the cmb @xcite .",
    "moreover , mixed dark matter models consisting of fdm and cdm have been proposed to solve the small scale problems of pure cdm scenarios @xcite including the missing satellites @xcite and cusp - core problems @xcite .",
    "ulas share the bosonic properties and the vacuum realignment production mechanism with the qcd - axion .",
    "the mass of the latter is , however , constrained by black hole superradiance to @xmath2 ev @xcite , pushing the quantum jeans length to scales too small to be observable in cosmological phenomena .",
    "the currently strongest constraints on the scalar field mass have been obtained from the luminosity function of high-@xmath3 galaxies and measurements of the optical depth to reionization @xcite .",
    "the resulting minimal mass of @xmath4 still produces sufficiently large halo cores to agree with observations @xcite .",
    "thus , fdm currently appears not to suffer from the _ catch 22 _ problem as warm dark matter does @xcite .    in the nonrelativistic limit , the dynamics of fdm",
    "is governed by the coupled schrdinger - poisson ( sp ) equations whose ground state solutions , equivalent to the well - known ( nonrelativistic ) boson stars , have been studied extensively in spherical or cylindrical symmetry @xcite .",
    "only recently , simulations of the comoving sp equations with cosmological initial conditions have become feasible @xcite .",
    "they show the formation of dark matter halos consisting of solitonic cores with ground state ( boson star ) density profiles , embedded in an nfw - like outer halo .",
    "three - dimensional simulations of merging solitonic cores have confirmed this result @xcite .    in order to resolve oscillatory patterns carrying momentum information on scales of @xmath5 ,",
    "cosmological simulations based on the discretized sp equations require computational resources that currently only allow small box sizes @xmath6 mpc@xmath7 , making predictions based on halo statistics practically impossible . on the other hand , like in warm dark matter scenarios , some constraints rely predominantly on delayed structure formation and the absence of low - mass halos rather than the existence of halo cores .",
    "these are captured to some extent by the linear transfer function , whereas dynamical effects during nonlinear gravitational collapse produce only higher order corrections . following this argument , standard n - body simulations with fdm initial conditions",
    "have been used to derive contraints on scalar field masses from reionization and damped lyman-@xmath8 observations @xcite .",
    "however , the accuracy of this approach has not been tested so far for fdm .    in this work ,",
    "we present a particle - mesh scheme including an additional force term to account for the quantum pressure gradient in the madelung formulation of the schrdinger equation .",
    "it is intended to provide a coarse - grained description of the sp dynamics instead of a fully accurate alternative representation by keeping track of the exact energy budget without resolving the fine - scale structure .",
    "it aims to model the effects of quantum pressure on scales where differences between the dynamics of cdm and fdm are moderate .",
    "the method can be understood as an intermediate approach between grid - based schrdinger solvers and n - body codes .",
    "because the quantum pressure depends on the second derivative of the density field it is extremely sensitive to small scale fluctuations . to mitigate this effect , we choose a discretization which inherently conserves energy .",
    "an alternative approach to simulate the sp equations in the madelung form with a particle - based method can be found in @xcite , see also the discussion in @xcite .",
    "the paper is organized as follows . in",
    ", the employed numerical method and parameters are described .",
    "the method is then tested in non - cosmological test problems . in the results of our cosmological runs",
    "are presented .",
    "the results are summarized and discussed in .",
    "nonrelativistic fdm obeys the schrdinger - poisson equations , @xmath9 and @xmath10 the schrdinger equation can be recast using the expressions @xmath11 and @xmath12 . separating real and imaginary parts yields @xmath13 and @xmath14 where the so - called quantum pressure is given by @xmath15 this representation resembles the euler equations of fluid dynamics .",
    "it is known as the madelung transformation of the schrdinger equation @xcite .    for our simulations , we modified the particle - mesh scheme of the cosmology code nyx @xcite in order to account for the quantum pressure @xmath16 . in analogy to smoothed - particle hydrodynamics ( sph ) @xcite",
    ", we derive an equation of motion for the particles from a lagrangian which ensures inherent energy conservation . to define an adequate lagrangian ,",
    "an expression for the kinetic energy of the scalar field under the madelung transformation is needed .",
    "it is given by @xmath17 here , @xmath18 will be numerically represented by the kinetic energy of the the particles .",
    "@xmath19 is the energy carried by the density gradient .",
    "it can also be understood as the potential energy corresponding to the quantum pressure .",
    "neglecting gravity , the lagrangian therefore reads @xmath20    writing the lagrangian in terms of the positions @xmath21 , velocities @xmath22 and masses @xmath23 of the particles with indices @xmath24 , we find for @xmath18 : @xmath25 for @xmath19 , we use the expression for the density at a given point @xmath26 used in sph codes @xcite , @xmath27 where @xmath28 is the smoothing kernel with a given smoothing length @xmath29 .",
    "thus , @xmath30    the gradient is replaced by finite differences and integrals are evaluated on the rectangular grid that is already used in the particle - mesh scheme for gravity in nyx , @xmath31 here , @xmath32 denote the grid points with a separation of @xmath33 and @xmath34 . using the second lagrange equation , @xmath35 and noting that @xmath36 yields the following equation of motion : @xmath37 @xmath38 is the numerical laplace operator ( 7 point stencil )",
    ". one can therefore recognize the quantum pressure evaluated by finite differences on the right hand side of . by construction ,",
    "the discretized equation of motion conserves the discretized versions of the energy expressions as given by and .",
    "the additional force term was incorporated into the existing leapfrog scheme for gravitational acceleration in nyx .",
    "the principal steps for its computation are i ) to compute density on the grid using equation ( ) , ii ) to compute the quantum pressure on the grid using the 7 point stencil and , and iii ) to compute the acceleration on each particle by convolving the pressure with the gradient of the smoothing kernel according to .",
    "the same smoothing kernel is used for the density interpolation in the gravity solver , so that the density field in nyx is always computed by .",
    "the additional acceleration leads to a modified condition for the time step @xmath39 in order to enforce that particles must not move farther than @xmath33 in a single time step @xcite .",
    "we choose the following smoothing kernel @xcite : @xmath40 @xmath41 was empirically found to optimize energy conservation and computational efficiency and therefore chosen for the simulations of solitonic core collisions . in the cosmological simulations , we used @xmath42 since kernel radii with an uneven number of cells give rise to a less noisy density field after initialization with the zeldovich approximation .",
    "this is especially important for fdm initial conditions featuring a steep cut - off in the initial power spectrum .",
    "we assume a scalar field mass of @xmath43 ev throughout this paper .      in @xcite ,",
    "three - dimensional simulations of the sp equations were used for a detailed parameter study of colliding and merging solitonic halo cores . as shown in @xcite , the density structure of cores in fdm halos",
    "is identical to newtonian boson stars . here",
    ", we will use the results of @xcite to compare the particle - mesh code described above to numerical solutions of the discretized sp equations in a non - symmetric , dynamical setup on a static background . for details about the schrdinger solver , see @xcite .        for the simulation shown in , we initialized a density profile which is close to the spherically symmetric ground state solution of the sp equations as given in @xcite which we will refer to as ( solitonic ) cores .",
    "we use @xmath44 particles and a grid resolution of @xmath45 where @xmath46 is the radius that encloses @xmath47 of the mass of the core .",
    "as expected , the code conserves total energy up to less than @xmath48 .",
    "owing to small numerical deviations from the exact solution , the density profile oscillates stably around the ground state .",
    "considering the different energy terms , this behaviour corresponds to a periodic exchange between the gradient energy @xmath19 and the gravitational potential energy @xmath28 .",
    "the characteristic ( quasi - normal ) period @xmath49 seen in our solutions is very close to that given by @xcite .        shows a head - on collision of two cores , using the same number of particles per core and spatial resolution as above . due to their initial relative velocity",
    "the total energy is positive .",
    "according to @xcite , one expects the cores to exhibit solitonic behavior , i.e. to pass through each other without significantly altering their density profiles .",
    "while overlapping , the cores are expected to form an interference pattern . in figure , our results",
    "are compared to those obtained from the grid - based schrdinger solver used in @xcite .",
    "as expected from the discussion in above , the coarse - grained nature of the particle - mesh method does not capture the interference pattern but nevertheless reproduces the solution of the schrdinger solver before and after the cores overlap .    in .",
    "we plot the energy terms for both codes where , in the case of the particle - mesh scheme , we split @xmath18 into the part resulting from the grid - scale bulk motion of the fluid , defined by @xmath50 and the remaining part corresponding to the particle velocity dispersion .",
    "the most distinguishable feature is that during overlapping phase , energy is stored in two different ways .",
    "while in the schrdinger solution gradient energy increases as a result of the formation of an interference pattern , in the particle - mesh scheme the exact same amount of energy is stored in particle velocity dispersion . in other words , on scales where the true density profile is unresolved , particles are largely unaffected by quantum pressure and therefore stream freely .",
    "this is in obvious contrast with solutions of where @xmath51 is single - valued at each point .",
    "our numerical scheme can therefore be interpreted as an approximate , coarse - grained representation of the sp equations whose validity on the scales of interest must be verified by numerical tests .",
    "our results show that energy conservation is crucial for establishing the correct behavior on resolved scales .",
    "further evidence for this interpretation is provided by .",
    "it shows the radial density profiles of the final state in simulations of two merging cores with initial orbital angular momentum . in agreement with the results of sp simulations @xcite",
    ", they consist of a central solitonic core and an outer halo with nfw - like profile . as expected , we do not observe the granular structure surrounding the core seen in the sp simulations .",
    "as in @xcite , the mass of the central core is independent of angular momentum .",
    "law as in the outer regions of a nfw profile .",
    "the initial set - up and resolution is equal to the one in figure but with an initial velocity of @xmath52 km / s in opposite directions perpendicular to the symmetry axis instead of a velocity towards each other .",
    "the runs have different mass ratios @xmath53 between the two cores where the lighter one always has the same mass as in figure . ]",
    "in order to isolate the dynamical impact of quantum pressure , we compare cosmological simulations using the particle - mesh scheme ( `` fdm simulations '' ) with standard n - body simulations ( apart from the unusual smoothing kernel ) using identical initial conditions ( `` cdm simulations '' ) . in comoving coordinates ,",
    "the quantum pressure is given by @xmath54 initial conditions for particles in the zeldovich approximation are generated with the music code @xcite .",
    "we set @xmath55 km / s / mpc , @xmath56 and @xmath57 for our test calculations .    as a first test",
    ", we initialize the simulations with a standard cdm transfer function as parameterized in @xcite . by keeping small scales in the inital power spectrum",
    "unsuppressed , the effect of quantum pressure on the evolution of perturbations can be observed more clearly .",
    "the comoving box size is @xmath58 mpc resolved by @xmath59 cells .",
    "compares the power spectra at @xmath60 and @xmath61 where the perturbations are only mildly nonlinear . while the power on large scales is equal in both cases , on smaller scales the power spectrum remains at approximately the initial level in the fdm simulation .",
    "also shows the quantum jeans scale @xcite , @xmath62 at the corresponding redshifts .",
    "as expected , the region between suppressed and unsuppressed growth of perturbations coincides with the range of @xmath63 between @xmath60 and @xmath61 as a result of its dependence on the scale factor .",
    "and the jeans scales @xmath63 at @xmath60 and @xmath61 . ]",
    "accounting for the suppression of small scale power in linear structure growth since the beginning of structure formation can be expressed by a transfer function @xmath64 modifying the cdm power spectrum , @xmath65 which is approximately given by the redshift - independent analytical expression @xcite @xmath66 where @xmath67 .",
    "it corresponds to a sharp cut - off at the jeans scale at matter - radiation equality @xmath68 . due to the qualitative difference in the linear power spectra of fdm and cdm already at the beginning of the simulations ,",
    "the results in clearly can not be taken as a realistic simulation of fdm .",
    "as a second , more realistic test of the effects of fdm quantum pressure , we used to initialize the density fields .",
    "the pressureless ( cdm ) simulations are therefore equivalent to the n - body simulations presented in @xcite . in order to investigate the scale dependence of the effects of quantum pressure at fixed axion mass ,",
    "we used two simulation boxes with @xmath69 mpc and @xmath70 mpc resolved by @xmath71 cells . because @xmath72 , power at the jeans scale at @xmath60 is strongly suppressed .",
    "thus , although we resolve the jeans scale , the influence of quantum pressure on linear structure growth is not as visible as in because there is not as much structure on the relevant scales at initialization .",
    "instead , we must look for differences in nonlinear structure growth .",
    "note , however , that the employed resolution is not sufficient to resolve the solitonic cores in dark matter halos as observed in @xcite .         per cell for the two box sizes i.e. resolutions .",
    "]    the relative difference of the fdm and cdm power spectra for both simulation boxes can be seen in .",
    "our central result is that these differences grow up to @xmath73 on scales close to the quantum jeans length , while they become nearly undetectable on larger scales .",
    "somewhat contrary to expectations , we observe more power on small scales in the fdm simulations compared to the pressureless n - body simulations . in both simulation boxes ,",
    "the difference in the power spectrum drops again at the smallest resolved scales caused by the numerical particle smoothing .",
    "the results for the power spectrum are consistent with the relative density contrast whose amplitude is of the order of several @xmath0 , as seen in .",
    "interestingly , the largest differences are located around the filaments where an interference - like pattern can be identified .",
    "finally , shows the root - mean - square relative deviations per cell .",
    "the deviations increase with decreasing redshift suggesting that even higher deviations can be found at @xmath74 .",
    "because differences exist primarily on smaller scales , the simulation with higher spatial resolution shows larger deviations .",
    "we have presented a new particle - mesh scheme that allows the investigation of the effects of ultra - light axion ( or `` fuzzy '' ) dark matter ( fdm ) on cosmological structures at scales close to the quantum jeans length .",
    "this was achieved by adding an additional force term , given by the quantum pressure in the madelung form of the schrdinger equation , to a standard n - body code in an energy conserving way .",
    "it was tested against known numerical results for the structure and oscillations of single solitonic cores , for the shapes of final radial density profiles in core mergers , and for the linear growth of perturbations in cosmological simulations .",
    "it is intended as an approximate method to find coarse - grained solutions to the governing schrdinger - poisson ( sp ) equations , capturing the resolved modifications to the density profile while leaving the small - scale interference pattern of the true sp solutions unresolved .",
    "our main goal was to detect the dynamical effects of quantum pressure during structure formation at lower redshifts , i.e. those that are not already captured by the linear transfer function used to initialize the simulations .",
    "comparing our fdm simulations with the new scheme to standard n - body simulations with identical initial conditions , we indeed find significant differences in the resulting density fields .",
    "interestingly , the largest relative deviations in the density field are located around the filaments , i.e. the first nonlinear structures to form on a given scale in cosmological structure formation ( but note that our simulations fail to resolve solitonic halo cores where even larger differences might occur ) .",
    "the maximum difference in the resulting power spectra is of the order of @xmath0 at @xmath75 on scales around the quantum jeans length . for observational probes of structure formation that reach a comparable level of precision",
    ", numerical predictions will have to include the dynamical effects of quantum pressure .",
    "this is our central result .    in future work",
    ", we will study the dynamical effects of fdm on the halo mass function and at lower redshifts , requiring larger simulations boxes while still resolving the jeans length .",
    "it will also be interesting to search for potential observable consequences of the predicted density patterns around filaments .",
    "we thank j .- f .",
    "engels for help with the nyx code and c. behrens , x. du , d.j.e .",
    "marsh , and b. schwabe for many useful discussions .",
    "the simulations were performed with resources provided by the north - german supercomputing alliance ( hlrn ) .",
    "we acknowledge the yt toolkit @xcite that was used for our analysis of numerical data .    43ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ] ",
    "+ 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty link:\\doibase 10.1103/physrevd.81.123530 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.85.1158 [ * * , ( ) ] link:\\doibase 10.1111/j.1365 - 2966.2011.19012.x [ * * , ( ) ] ,   link:\\doibase 10.1111/j.1365 - 2966.2012.20603.x [ * * , ( ) ] ,   link:\\doibase 10.1142/s021773231430002x [ * * ,   ( ) ] ,   link:\\doibase 10.1088/1475 - 7516/2014/09/011 [ * * , ( ) ] ,   link:\\doibase 10.1103/physrevd.91.023519 [ * * , ( ) ] ,   link:\\doibase 10.1103/physrevd.84.043531 [ * * , ( ) ] ,   link:\\doibase 10.1007/s10714 - 015 - 1865 - 9 [ * * ,   ( ) ] , link:\\doibase 10.1016/j.physletb.2016.03.016 [ * * ,   ( ) ] ,   @noop ( ) ,   @noop ( ) , http://stacks.iop.org/1538-4357/534/i=2/a=l127 [ * * ,   ( ) ] link:\\doibase 10.1093/mnras / stt2079 [ * * ,   ( ) ] ,   link:\\doibase 10.1086/312287 [ * * , ( ) ] http://stacks.iop.org/0004-637x/522/i=1/a=82 [ * * , ( ) ] link:\\doibase 10.1086/518025 [ * * ,   ( ) ] ,   link:\\doibase 10.1103/physrevd.91.084011 [ * * , ( ) ] ,   link:\\doibase 10.1093/mnras / stv624 [ * * ,   ( ) ] ,   link:\\doibase 10.3847/0004 - 637x/818/1/89 [ * * ,   ( ) ] http://stacks.iop.org/1475-7516/2016/i=04/a=012 [ * * ,   ( ) ] link:\\doibase    10.1103/physrevlett.113.261302 [ * * ,   ( ) ] link:\\doibase 10.1093/mnras / stv1050 [ * * , ( ) ] ,   @noop ( ) ,   link:\\doibase 10.1111/j.1365 - 2966.2012.21284.x [ * * , ( ) ] ,   link:\\doibase 10.1103/physrev.187.1767 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevd.69.124033 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevd.74.063504 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevd.74.103002 [ * * ,   ( ) ] link:\\doibase 10.12942/lrr-2012 - 6 [ * * ,   ( ) ] ,   link:\\doibase 10.1103/physrevd.83.103513 [ * * ,   ( ) ] ,   link:\\doibase 10.1088/0004 - 637x/697/1/850 [ * * , ( ) ] ,   @noop * * ,   ( ) ,   @noop ( ) ,   link:\\doibase 10.1103/physreve.91.053304 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevd.91.123520 [ * * ,   ( ) ] link:\\doibase 10.1007/bf01400372 [ * * ,   ( ) ] link:\\doibase    10.1088/0004 - 637x/765/1/39 [ * * ,   ( ) ] link:\\doibase 10.1088/0034 - 4885/68/8/r01 [ * * ,   ( ) ] link:\\doibase 10.1146/annurev.aa.30.090192.002551 [ * * ,   ( ) ] link:\\doibase 10.1111/j.1365 - 2966.2011.18820.x [ * * ,   ( ) ] http://stacks.iop.org/0004-637x/496/i=2/a=605 [ * * , ( ) ] link:\\doibase    10.1088/0067 - 0049/192/1/9 [ * * ,   ( ) ] ,"
  ],
  "abstract_text": [
    "<S> we study cosmological structure formation with ultra - light axion dark matter ( or `` fuzzy dark matter '' , fdm ) using a particle - mesh scheme to account for the quantum pressure arising in the madelung formulation of the schrdinger - poisson equations . </S>",
    "<S> sub - percent level energy conservation and correct linear behavior are demonstrated . </S>",
    "<S> whereas the code gives rise to the same core - halo profiles as direct simulations of the schrdinger equation , it does not reproduce the detailed interference patterns at the resolution used here . in cosmological simulations with fdm inital conditions , </S>",
    "<S> we find a maximum relative difference of o(@xmath0 ) in the power spectrum near the quantum jeans length compared to using a standard n - body code with identical initial conditions . </S>",
    "<S> this shows that the effect of quantum pressure during nonlinear structure formation can not be neglected for precision constraints on a dark matter component consisting of ultra - light axions . </S>"
  ]
}