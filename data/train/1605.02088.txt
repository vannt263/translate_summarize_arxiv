{
  "article_text": [
    ", in our study of all _ rxte_-observations of gro  j1008@xmath057 @xcite .",
    "fitting all 43 observations separately results in the green histogram .",
    "as soon as we perform a simultaneous fit with @xmath1 global continuum parameter the uncertainties decrease significantly as shown by the red histogram . finally , using @xmath2 global parameters ( blue histogram ) results in a median of @xmath3 in the uncertainties ( compare the arrows on top ) .",
    "]    nowadays , the still increasing computation speed and available memory allows us to analyze large datasets at the same time . using x - ray spectra of accreting neutron stars as an example",
    ", we have shown in a previous paper ( * ? ? ?",
    "* hereafter paper i ) that loading and fitting the spectra simultaneously has several advantages compared to the `` classical '' way of x - ray data analysis , which is treating every observation individually .",
    "in particular , instead of fixing parameters to a mean value one can determine them by a joint fit to all datasets under consideration .",
    "due to the reduced number of degrees of freedom the remaining parameters can be better constrained ( see fig .  [ fig:1008gamma ] as an example ) .",
    "furthermore , parameters no longer need to be independent , but can be combined into functions .",
    "for instance , the slope of the spectra might be described as a function of flux with the coefficients of this function as fit - parameters .",
    "the disadvantages of fitting many datasets simultaneously are , however , an increased runtime and a complex handling because of the large number of parameters . in paper",
    "i , we have introduced functions to facilitate this handling , which have been implemented into the ` interactive spectral interpretation system ` ( isis ) @xcite . while these functions are already available as part of the ` isisscripts ` they are continuously updated and new features are implemented .",
    "one important question , which we raised in paper i , is about the goodness of a simultaneous fit as it is , e.g. , calculated after the commonly used @xmath4-statistics , particularly the case where some datasets are not described well by the chosen model . due to the potential large total number of datasets ,",
    "the information about failed fits can be hidden in the applied fit - statistics .",
    "after we have given a reminder about the terminology of simultaneous fits in section  [ sec : reminder ] , we describe the problem of detecting failed fits in more detail in section  [ sec : solution ] and provide possible solutions .",
    "we will conclude this paper by applying these solutions to examples in section  [ sec : examples ] .",
    "and b has @xmath5 datasets . a model with @xmath6 parameters",
    "is fitted such that each data - group has its own set of @xmath7 parameters , called group parameters .",
    "the common @xmath8 parameters between the groups are the so - called global parameters . ]",
    "as we have described in paper i , a _ data - group _ contains all datasets which have been taken simultaneously in time or , in general , represent the same state of the observed object . in the example",
    "illustrated in fig .",
    "[ fig : terminology ] two data - groups , a and b , have been added to the simultaneous fit , containing @xmath9 and @xmath5 datasets , respectively .",
    "thus , a dataset is labeled by the data - group it belongs to , e.g. , b3 is the third dataset in the second data - group . after a model with @xmath10 parameters",
    "has been defined each of these data - groups is fitted by an individual set of parameters , called _",
    "group parameters_. consequently , all datasets belonging to a specific data - group are described by the same parameter values .",
    "a specific group parameter can now be marked as a so - called _",
    "global parameter_. the value of the corresponding group parameters will now be tied to this global parameter , i.e , this parameter has a common value among all data - groups . instead of tying group parameters together to a global value",
    ", a parameter function may be defined , to which the group parameters are set instead .",
    "this function takes , e.g. , other parameters as input to calculate the value for each group parameter . in this case , correlations between model parameters , e.g , as predicted by theory can be implemented and fitted directly .",
    "as an indicator for the goodness of a fit the analysis software used , e.g isis or xspec @xcite , usually displays the fit - statistics after the model has been fitted to the data . here , we chose the @xmath4-statistics since the developed functions for a simultaneous fit have been first applied to accreting neutron stars .",
    "the high count rates satisfies the gaussian approxmation of the uncertainties , which are actually poisson distributed . in principle , however , the discussed issues and their solutions can be generalized for any kind of fit - statistics .    for each datapoint",
    "@xmath11 the difference between the @xmath12 and the @xmath13 is calculated and normalized by the measurement uncertainty , @xmath14 , of the data .",
    "the sum over all @xmath9 datapoints is called the @xmath15-square , @xmath16 and is displayed after a fit .",
    "additionally , the sum is normalized to the total number of degrees of freedom , @xmath17 with the number of free fit - parameters @xmath10 , since the @xmath4 increases with @xmath9 . this normalized sum , called the reduced @xmath15-square , @xmath18 is also displayed .",
    "for gaussian distributed data the expected value is @xmath19 for a perfect fit of the chosen model .",
    "however , once the probability distribution is changed , e.g. , when a spectrum has been rebinned , the expected value changes as well . consequently , a reliable measure for the goodness of the fit has to be defined with some forethought .",
    "the @xmath20 threshold , for which a simultaneous fit is acceptable , strongly depends on the considered case .",
    "in particular , a few data - groups might not be described well by the chosen model , which would result in an unacceptable @xmath20 when fitted individually . however , in case of a simultaneous fit , this information might be hidden in the classical definition of the @xmath20 ( eq .  [ eq : redchisqr ] ) .",
    "let us consider @xmath21 data - groups and a model with @xmath10 group parameters and @xmath8 global parameters .",
    "then , the total @xmath20 is @xmath22 with the number of degrees of freedom , @xmath23 , and the @xmath24 for each data - group @xmath25 after eq .",
    "[ eq : chisqr ] .",
    "now , we assume a failed fit with @xmath26 for a particular @xmath25 to be present , while for the remaining data - groups @xmath27 . for @xmath28 the @xmath20 after eq .  [",
    "eq : redchisqr : simfit ] is still near unity and , thus , suggests a successful simultaneous fit . in the following , we present three possibilities to investigate the goodness of a simultaneous fit more carefully .",
    "a trivial but effective solution is to check the goodness of the fit for each data - group individually .",
    "here , in the chosen case of the @xmath4-statistics , the @xmath29 is calculated for each data - group , @xmath25 , after @xmath30 where @xmath31 are the number of datapoints in the data - group , and @xmath7 is the number of free group parameters . due to that the global parameters are not taken into account here , the @xmath29 is , however , different to that performed by a single fit of the data - group .    in the case of a large number of data - groups ,",
    "it is more convenient to sort the @xmath29 into a histogram to help investigating the goodness of the fit to all data - groups .",
    "we have added such a histogram to the simultaneous fit functions as part of the ` isisscripts ` .",
    "after a fit has been performed using the fit - functions ` fit_groups ` or ` fit_global ` ( see paper i ) this histogram is added to the default output of the fit - statistics . in this way , failed fits of specific data - groups can be identified by the user at first glance .      instead of a few failed fits to certain data - groups",
    ", one might ask if the chosen model fails in the global context of a simultaneous fit . to answer this question , a special goodness of the simultaneous fit",
    "is needed to take its logical structure into account . as explained in section  [ sec : reminder ] , a data - group represents a certain state of the observed object , e.g. , the datasets where taken at the same time .",
    "thus , the data - groups are statistically independent of each other . calculating the goodness of the fit in a traditional way , which is the @xmath20 after eq .  [ eq : redchisqr : simfit ] in our case ,",
    "does not , however , take this aspect into account . as a solution we propose to define a _ combined goodness of the fit _ calculating the weighted mean of the individual goodness of each data - group . in the case of @xmath4-statistics ,",
    "a combined reduced @xmath4 is calculated by @xmath32 with @xmath33 computed after eq .",
    "[ eq : chisqr ] for each data - group , @xmath25 , and a weighting factor , @xmath34 , for the number of global parameters , @xmath8 : @xmath35 thus , @xmath34 normalizes the effect of data - group @xmath25 on the determination of the global parameters , @xmath8 , by its number of degrees of freedom relative to the total number of degrees of freedom of the simultaneous fit . equation  [ eq : mu ] is , however , an approximation only .",
    "a data - group might not be sensitive to a certain global parameter , e.g , if the spectra in this data - group do not cover the energy range necessary to determine the parameter .",
    "a failed fit to a specific data - group , for example with a high individual @xmath29 , has a higher impact on the @xmath36 ( eq .",
    "[ eq : combredchisqr ] ) than on the traditional @xmath20 ( eq .  [ eq : redchisqr ] ) . in general",
    "we expect @xmath37 , even if all data - groups are fitted well . in the case of a good simultaneous fit ( better than a certain threshold ) , a weak feature in the data might still be unnoticed , if it is not detected in any individual data - group .",
    "such a feature can be investigated by stacking the residuals , as outlined in the following section .",
    "we note , however , that eq .",
    "[ eq : combredchisqr ] is the result of an empirical study .",
    "a more sophisticated goodness of a simultaneous fit should be based on a different type of fit - statistics suitable for a simultaneous analysis of many datasets , such as a bayesian approach or a joint likelihood formalism similar to @xcite .      once datasets can be technically stacked to achieve a higher signal - to - noise ratio , e.g. , when spectra have the same energy grid and channel binning , further weak features might get visible .",
    "this is a common technique in astrophysics ( see , e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "however , when stacked datasets are analyzed , differences in the individual datasets , like source intrinsic variability , can no longer be revealed .    in case of a simultaneous fit ,",
    "the residuals of all data - groups can be stacked instead .",
    "the stacking dramatically increases the total exposure in each channel bin .",
    "thus , the stacked residuals of all data - groups , @xmath38 , as a function of the energy bin , @xmath11 , can be investigated to further verify the goodness of the simultaneous fit @xmath39 this task can be achieved using , e.g , the ` plot_data ` function written by m.  a.  nowak .    we can show that the combined reduced @xmath4 is effectively equal to the goodness of a fit of the stacked data in the first place .",
    "assuming the same number of degrees of freedom , @xmath17 , for each data - group , eq .",
    "[ eq : combredchisqr ] gives @xmath40 with @xmath41 and having used eq .",
    "[ eq : chisqr ] .",
    "now , the summand no longer depends on @xmath25 or @xmath11 explicitly .",
    "thus , the order of the sums in eq .",
    "[ eq : chisqrequal ] may be switched .",
    "if we finally interpret @xmath11 as a spectral energy bin we end up with the goodness as a function of @xmath11 : @xmath42 this means that all datasets of the simultaneous fit are first summed up for each energy bin in the combined reduced @xmath4 .",
    "in contrast to stacking the data in the first place , however , source variability can still be taken into account during a simultaneous fit .",
    "note that once all data - groups have the same number of degrees of freedom , the @xmath36 ( eq .  [ eq : chisqrequal ] ) is equal to the classical @xmath20 ( eq .  [ eq : redchisqr ] ) .",
    "to further investigate the goodness of the simultaneous fit in such a case , the histogram of the goodness of all data - groups ( see sec .",
    "[ sec : histogram ] ) and , if possible , the stacked residuals should be investigated .",
    "57 ( blue : pca ; red : hexte ) .",
    "residual features are left in pca , which are caused by calibration uncertainties .",
    "these features are not detected in that detail in the residuals of the single spectrum with the highest signal ( c ) . ]",
    "the be x - ray binary gro j1008@xmath057 was regularly monitored by _ rxte _ during outbursts in 2007 december , 2005 february , and 2011 april with a few additional pointings by _ suzaku _ and _ swift_. a detailed analysis of the spectra has been published in @xcite and in paper i we have demonstrated , as an example , the advantages of a simultaneous fit based on these data ( see also fig .  [ fig:1008gamma ] ) . the @xmath20 of 1.10 with 3651 degrees of freedom ( see table  4 of khnel at al",
    ". , 2013 @xcite ) calculated after eq .",
    "[ eq : redchisqr : simfit ] indicates a good fit of the underlying model to the data . using the combined reduced @xmath4 defined in eq .",
    "[ eq : combredchisqr ] we find , however , @xmath43 .",
    "the reason for this significant worsening of the goodness are calibration uncertainties in _ rxte_-pca , which are visible in the stacked residuals of all 43 data - groups as shown in fig .",
    "[ fig:1008 ] : the strong residuals below 7kev are probably caused by insufficient modeling of the xe l - edges , the absorption feature at 10kev by the be / cu collimator , and the sharp features around 30kev by the xe k - edge ( for a description of the pca see * ? ? ?",
    "these calibration issues have been detected in a combined analysis of the crab pulsar by @xcite as well .",
    "however , the calibration issues , which are responsible for the high @xmath36 , do not affect the continuum model of gro  j1008@xmath057 because of their low significance in the individual data - groups .",
    "these calibrations features might have an influence , however , in data with a much higher signal - to - noise ratio than the datasets used here or once narrow features , such as emission lines , are studied .",
    "emission line only ( b ) .",
    "note that the residual flux in this line is @xmath4415 times lower compared to the stacked residuals . ]     of all individual data - groups of the 88 _ xmm - newton_-spectra of vela  x-1 are shown . ]",
    "another excellent example for a simultaneous fit was performed by @xcite .",
    "these authors have analyzed 88 spectra recorded by _ xmm - newton _ during a giant flare of vela  x-1 .",
    "although the continuum parameters were changing dramatically within the @xmath45ks observation a single model consisting of three absorbed power - laws is able to describe the data with a @xmath46 with 9765 degrees of freedom @xcite . due to a global photon index for all power - laws and data - groups the absorption column densities and iron line fluxes",
    "could be constrained well .    because every data - group is a single spectrum taken by the _ xmm_-epic - pn camera and a common energy grid",
    "was used , the @xmath36 equals the @xmath20 here .",
    "thus , it is preferred to calculate the stacked residuals of all data - groups according to eq .",
    "[ eq : sumresiduals ] . to demonstrate the advantage of this tool we have used the continuum model only , i.e. without any fluorescence line taken into account , and evaluated this model without any channel grouping to achieve the highest possible energy resolution . the resulting stacked residuals in the iron line region ( 59kev )",
    "are shown in fig .",
    "[ fig : vela ] . the iron k@xmath47 line at @xmath48kev and the k@xmath49 line at @xmath50kev are nicely resolved .",
    "the tail following the k@xmath49 line is probably caused by a slight mismatch of the continuum model with the data and requires a more detailed analysis . note that the flux of this mismatch is a few @xmath51photonss@xmath52@xmath53 , which is detectable only in these stacked residuals featuring 100ks exposure time and after the strong continuum variability on ks - timescales has been subtracted .    as a further demonstrative example , the histogram of the goodness of the fits of the 88 data - groups calculated after eq .",
    "[ eq : groupchi ] is shown in fig .",
    "[ fig : velachi ] .",
    "the median @xmath20 is around 1.3 , indicating that the model still could be improved slightly .",
    "investigating the three outliers with @xmath54 indeed proves that the residuals around in the iron line region are left , which are responsible for the high @xmath20 and very similar to those shown in fig .",
    "[ fig : vela ] .",
    "there are no , however , extended residuals visible .",
    "thus , the continuum parameters presented in @xcite are still valid .",
    "emission line at 6.4kev is visible , which is not detected in the residuals of any individual spectrum ( c ) . ]",
    "the last example shown in this work is the outburst of the transient pulsar xte  1859 + 083 in 2015 april .",
    "this source was in quiescence since its bright outburst in 1996/1997 @xcite . during the recent outburst several short observations by _ swift _",
    "were performed . a first analysis of these data in combination with _",
    "integral _ spectra reports an absorbed power - law shape of the source s x - ray continuum @xcite .",
    "we have extracted and analyzed seven _",
    "swift_-xrt spectra and can confirm these findings .",
    "however , after examining the stacked residuals of all spectra an iron k@xmath47 emission line at 6.4kev shows up that has not been detected before ( see fig .",
    "[ fig : xte ] ) .",
    "we define the equivalent width of this line as a global parameter and find a value of @xmath55ev ( uncertainty is at the 90% confidence level , @xmath56 with 585 degrees of freedom ) .",
    "we have continued developing functions to handle simultaneous fits in isis , which we have introduced in paper  i. in particular , we have concentrated on tools for checking the goodness of the fits to discover failed fits of individual data - groups or global discrepancies of the model .",
    "we propose to    * investigate the distribution of the goodness of fits to all individual data - groups * calculate a combined goodness , here the @xmath57 , which takes the individual nature of each data - group into account * look at the stacked residuals of all data - groups to reveal weak features    during a simultaneous fit in order to find the global best - fit .",
    "we have demonstrated the tremendous benefit of analyzing the stacked residuals by observations of three accreting neutron stars , in which we could identify weak features that had not been detected before .",
    "m.  khnel was supported by the bundesministerium fr wirtschaft und technologie under deutsches zentrum fr luft- und raumfahrt grants 50or1113 and 50or1207 .",
    "the ` slxfig ` module , developed by john e. davis , was used to produce all figures shown in this paper .",
    "we are thankful for the constructive and critical comments by the reviewers , which were helpful to significantly improve the quality of the paper .",
    "j.  c. houck , l.  a. denicola .",
    "isis : an interactive spectral interpretation system for high resolution x - xay spectroscopy . in n.",
    "manset , c.  veillet , d.  crabtree ( eds . ) , _ astronomical data analysis software and systems ix _ , vol .",
    "216 of _ astron .",
    "soc . of the pacific conf .",
    "series _ , p. 591 .",
    "2000 .",
    "b.  anderson , j.  chiang , j.  cohen - tanugi , et  al . using likelihood for combined data set analysis . in y.",
    "fukazawa , y.  tanaka , r.  itoh ( eds . ) , _ proceedings of the 5th fermi symposium _ , arxiv 1502.03081 , 2015"
  ],
  "abstract_text": [
    "<S> in a previous work , we introduced a tool for analyzing multiple datasets simultaneously , which has been implemented into isis . </S>",
    "<S> this tool was used to fit many spectra of x - ray binaries . </S>",
    "<S> however , the large number of degrees of freedom and individual datasets raise an issue about a good measure for a simultaneous fit quality .    </S>",
    "<S> we present three ways to check the goodness of these fits : we investigate the goodness of each fit in all datasets , we define a combined goodness exploiting the logical structure of a simultaneous fit , and we stack the fit residuals of all datasets to detect weak features . </S>",
    "<S> these tools are applied to all _ rxte_-spectra from gro  1008@xmath057 , revealing calibration features that are not detected significantly in any single spectrum . </S>",
    "<S> stacking the residuals from the best - fit model for the vela  x-1 and xte  j1859 + 083 data evidences fluorescent emission lines that would have gone undetected otherwise .    </S>",
    "<S> a    a    a    a    a    a    b    c , d    e    f    g    g    h    i    i    j    a </S>"
  ]
}