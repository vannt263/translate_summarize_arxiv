{
  "article_text": [
    "we thank john chodera , gavin crooks , gerhard hummer , christopher jarzynski , and attila szabo for helpful discussions .",
    "this research was supported by the intramural research program of the nih , niddk ."
  ],
  "abstract_text": [
    "<S> an optimized method for estimating path - ensemble averages using data from processes driven in opposite directions is presented . based on this estimator , bidirectional expressions for reconstructing free energies and potentials of mean force from single - molecule force spectroscopy  </S>",
    "<S> valid for biasing potentials of arbitrary stiffness  are developed . </S>",
    "<S> numerical simulations on a model potential indicate that these methods perform better than unidirectional strategies .    </S>",
    "<S> crooks path - ensemble average theorem ( eq .  </S>",
    "<S> [ eq : cpeat ] ) encompasses a set of exact results in nonequilibrium statistical mechanics pertinent to systems driven from thermal equilibrium by a time - dependent external potential @xcite . </S>",
    "<S> these include jarzynski s equality @xcite and the crooks fluctuation theorem @xcite , which relate equilibrium free energy differences to the nonequilibrium work distribution , as well as reweighting relations that allow one to recover arbitrary equilibrium ensemble averages from measurements of driven nonequilibrium processes @xcite . </S>",
    "<S> because of the intimate connection between such processes and molecular force spectroscopy , these theorems have been widely invoked to extract free energies and potentials of mean force ( pmfs ) from single - molecule pulling experiments @xcite .    while formally correct , the practical utility of these relations is limited by the presence of exponential averages of the work , which are dominated by rare events and therefore have notoriously slow convergence properties @xcite . in order to improve their convergence , </S>",
    "<S> strategies such as work - weighted trajectory sampling @xcite have been proposed . here </S>",
    "<S> we suggest another method to accelerate the convergence of these averages : including trajectories from the reverse process in the forward path - ensemble . </S>",
    "<S> this is motivated in part by the observation that the exponential average of the work in the forward process is dominated by those rare trajectories that resemble time - reversed counterparts ( `` conjugate twins '' ) of typical trajectories generated by the reverse protocol @xcite . </S>",
    "<S> thus , our goals are to construct optimized forward path - ensemble average estimators that explicitly include such trajectories , and apply them to the problem of estimating free energies and potentials of mean force from single - molecule pulling experiments .    </S>",
    "<S> the starting point of our analysis is crooks path - ensemble average theorem , which relates the forward average of an arbitrary functional @xmath0 $ ] of the phase space trajectory @xmath1 to its work - weighted average in the reverse process , namely @xcite @xmath2 in the above , the forward average @xmath3 is an average over all trajectories ( path - ensemble average ) generated in the forward process , wherein an external parameter ( e.g. the position of a harmonic trap in a single - molecule pulling experiment ) is driven from the value @xmath4 to @xmath5 in @xmath6 units of time after equilibration at @xmath4 , while @xmath7 is a similarly defined average in the reverse direction , from @xmath5 to @xmath4 . </S>",
    "<S> the total work @xmath8 $ ] accumulated up to the final time @xmath6 is defined in terms of the time - dependent hamiltonian @xmath9 as @xmath10 , while @xmath11 is the free energy difference between the equilibrium states corresponding to the endpoints @xmath4 and @xmath5 . finally , the notation @xmath12 $ ] is a shorthand for the value of the functional when evaluated over the time - reversal of @xmath13 , viz . </S>",
    "<S> @xmath14 .    by choosing @xmath15 = \\delta[\\gamma - \\gamma']$ ] in eq .  </S>",
    "<S> ( [ eq : cpeat ] ) and using the property @xmath16 = - w[\\gamma]$ ] , one obtains an identity between the distribution of trajectories in the two directions @xcite , @xmath17 where @xmath18 and @xmath19 are the probabilities of observing a particular trajectory @xmath13 in the forward and reverse processes , respectively . </S>",
    "<S> this result offers a means of achieving the aforementioned goal  trajectories from the reverse process can indeed be included in the forward path - ensemble when their density is reweighted by @xmath20 . </S>",
    "<S> our next goal is to optimally combine direct estimates of @xmath18 from forward processes with indirect estimates obtained from @xmath19 via eq .  </S>",
    "<S> ( [ eq : path_cft ] ) ; this will be done with the weighted histogram analysis method ( wham ) @xcite .    </S>",
    "<S> the objective of wham is to find an optimal ( i.e. least variance ) estimator for a desired probability distribution from a series of independent estimates of biased distributions , where `` biased '' here means that the distribution of interest is related to the remaining ones by a simple reweighting factor . </S>",
    "<S> to be specific , given a series of normalized distributions @xmath21 of a random variable @xmath22 , with @xmath23 , and @xmath24 unbiasing relations of the form @xmath25 where @xmath26 is the distribution of interest and @xmath27 is the unbiasing factor for the @xmath28-th distribution , the wham strategy seeks a linear combination of @xmath24 independent estimates of @xmath26 obtained from the measured biased distributions @xmath21 via eq .  </S>",
    "<S> ( [ eq : wham1 ] ) , such that its variance @xmath29 $ ] is minimized . </S>",
    "<S> this results in @xcite @xmath30 where @xmath31 is the number of samples in the estimate of the @xmath28-th distribution . </S>",
    "<S> ( for notational simplicity , here we do not distinguish the exact distribution and its sample estimate ) . </S>",
    "<S> applied to the problem of estimating @xmath18 from @xmath32 forward and @xmath33 reverse trajectories , eqs .  </S>",
    "<S> ( [ eq : path_cft])-([eq : wham2 ] ) give an optimized estimator for the forward probability distribution of trajectories in terms of the measured forward and reverse densities : @xmath34    we are now ready to derive the main results of our paper . taking the average of @xmath35 $ ] using the optimized density from eq .  </S>",
    "<S> ( [ eq : density_optimal ] ) , we obtain the following estimator for the forward path - ensemble average of @xmath36 : @xmath37 where in the last average we have again used the property that the total work is odd under time - reversal . </S>",
    "<S> ( an analogous expression for the reverse path - ensemble can be obtained by switching the definitions of forward and reverse . ) </S>",
    "<S> this general result forms the basis of our bidirectional method , and different applications can be obtained with suitable choices of @xmath36 .    </S>",
    "<S> our first example is concerned with free energy differences , where we choose @xmath38 , with @xmath39 $ ] defined as the partial work between times @xmath40 and @xmath41 along the trajectory @xmath13 , i.e. @xmath42 . </S>",
    "<S> ( note that , according to this notation , the total work @xmath43 coincides with @xmath44 ) . </S>",
    "<S> invoking jarzynski s equality @xmath45 for the l.h.s . </S>",
    "<S> of eq .  </S>",
    "<S> ( [ eq : f_general ] ) , this choice of @xmath36 gives @xmath46 where @xmath47 is the free energy difference between the equilibrium states defined by the hamiltonians @xmath48 and @xmath49 , and in the last average we have used the property @xmath50 = - w_{\\tau - t}^\\tau[\\gamma]$ ] . for the particular cases where </S>",
    "<S> @xmath51 or @xmath52 , this result can be rearranged to yield the bennett acceptance ratio ( bar ) formula for @xmath53 @xcite , as generalized to nonequilibrium processes by crooks @xcite ( for a multistate extension , see @xcite ) . </S>",
    "<S> the above equation further generalizes bar to estimate intermediate free energy differences @xmath54 . </S>",
    "<S> operationally , when estimating an intermediate free energy difference , we must first estimate @xmath53 to use in the r.h.s . of eq .  </S>",
    "<S> ( [ eq : optimal_ft ] ) . this can be accomplished with bar , which has been shown to be a maximum likelihood estimator of @xmath53 @xcite .    </S>",
    "<S> free energy differences can also be estimated using a cumulant expansion of jarzynski s equality @xcite . in order to analyze bidirectional data with this approach </S>",
    "<S> , one should apply eq .  </S>",
    "<S> ( [ eq : f_general ] ) to estimate moments of the work distribution , choosing @xmath55 . </S>",
    "<S> this is more rigorous than a method which applies the crooks fluctuation theorem between states which are not in equilibrium @xcite . </S>",
    "<S> a bidirectional estimator for the energetic contribution to @xmath54 can be obtained by choosing @xmath56 in eq .  </S>",
    "<S> ( [ eq : f_general ] ) . </S>",
    "<S> this results in the average energy at time @xmath57 , as was shown in the unidirectional case @xcite .    in the context of single - molecule pulling experiments , </S>",
    "<S> the system is typically driven out of equilibrium by a time - dependent potential @xmath58 acting on a collective coordinate @xmath59 ( e.g. the end - to - end distance of a protein ) such that the total hamiltonian is @xmath60 , where @xmath61 is the ( time - independent ) hamiltonian in the absence of the external perturbation . in this case , the free energy difference @xmath54 involves the equilibrium states of the system corresponding to the potential at @xmath62 and @xmath63 . </S>",
    "<S> however , one is often more interested in the potential of mean force @xmath64 of the unperturbed hamiltonian , i.e. in the effective potential dictating the equilibrium distribution of @xmath65-values in the absence of the external potential . </S>",
    "<S> although in the limit of sufficiently stiff potentials the free energy difference approaches the pmf @xcite , this approximation fails for soft springs @xcite such as those used in optical tweezer experiments @xcite , in which case one should use more rigorous methods . </S>",
    "<S> one approach starts from the observation that the equilibrium distribution of @xmath65-values in the absence of the external potential ( i.e. the unbiased distribution ) is given by @xmath66 @xcite , where @xmath67 is an overall normalization constant , which can be shown to be independent of @xmath57 . with this result in mind , a bidirectional estimator for @xmath68 can be obtained from eq .  </S>",
    "<S> ( [ eq : f_general ] ) by choosing @xmath69 . </S>",
    "<S> moreover , since this expression for @xmath68 is correct for all times @xmath57 , different estimates of @xmath68 can be obtained from different time - slices during the pulling process , and these can in turn be combined according to the wham prescription ( eqs .  </S>",
    "<S> ( [ eq : wham1 ] ) and ( [ eq : wham2 ] ) ) . </S>",
    "<S> indeed , rewriting the above result for @xmath68 in the form of eq .  </S>",
    "<S> ( [ eq : wham1 ] ) , viz . </S>",
    "<S> @xmath70 } \\ , \\left [ \\frac { \\langle \\delta(z - z_t ) e^{-\\beta w_0^t } \\rangle_f } { e^{-\\beta \\delta f_t } } \\right],\\ ] ] where the factor @xmath71 is introduced to normalize the distribution in square brackets , one arrives at the hummer - szabo estimator for @xmath68 @xcite , @xmath72 } } , \\ ] ] where @xmath73 is defined up to an additive constant . </S>",
    "<S> the above pmf formalism has been extended to account for multiple pulling protocols @xcite and multiple dimensions @xcite .    in order to optimally include trajectories from the reverse perturbation in eq .  </S>",
    "<S> ( [ eq : hsz ] ) , we choose @xmath69 in eq .  </S>",
    "<S> ( [ eq : f_general ] ) and substitute the ensuing expression for @xmath74 in eq .  </S>",
    "<S> ( [ eq : hsz ] ) . </S>",
    "<S> this leads to our bidirectional pmf estimator : @xmath75    e^{\\beta \\delta f_t}}{\\sum_t e^{-\\beta [ v(z;t ) - </S>",
    "<S> \\delta f_t]}},\\ ] ] where @xmath54 is estimated via eq .  </S>",
    "<S> ( [ eq : optimal_ft ] ) and @xmath76 via bar . </S>",
    "<S> ( as in wham , @xmath54 can also be estimated self - consistently by iterative cycles of eq .  </S>",
    "<S> ( [ eq : gz ] ) and numerically integrating @xmath77}dz/\\int e^{-\\beta\\left[g_o(z')+v(z';0)\\right]}dz'$ ] . ) if we switch the definitions of forward and reverse , then @xmath78 differs by the constant @xmath53 .    to demonstrate these results , we perform brownian dynamics simulations on a one - dimensional potential whose unperturbed hamiltonian is @xmath79 ( as used by hummer @xcite ) . </S>",
    "<S> the time - dependent hamiltonian is @xmath80 , with @xmath81 and @xmath82 chosen as 15 . in the forward direction , </S>",
    "<S> the center of the potential @xmath83 is linearly varied from -1.5 to 1.5 over 750 steps ; it is varied from 1.5 to -1.5 in the reverse direction . before pulling , </S>",
    "<S> trajectories are equilibrated for 100 steps . </S>",
    "<S> dynamics are run with a diffusion coefficient d = 1 , temperature parameter @xmath84 , and time step @xmath85 . </S>",
    "<S> work is calculated with the discrete formula @xmath86 $ ] .     </S>",
    "<S> ( color online ) comparison of @xmath54 estimators : jarzynski s equality applied to 500 forward ( rightward triangles ) or reverse pullings ( leftward triangles , time reversed so that @xmath87 at @xmath88 ) ; our optimized estimator , eq .  </S>",
    "<S> ( [ eq : optimal_ft ] ) ( upward triangles ) and eq .  </S>",
    "<S> ( 16 ) of ref .  </S>",
    "<S> @xcite ( dotted line ) applied to 250 pullings in each direction . </S>",
    "<S> the exact @xmath54 , calculated by applying gauss - kronrod quadrature in matlab 7.5 to numerically integrate @xmath89 between @xmath90 , is shown as a shaded line . ]    for @xmath54 estimates on this model system , our bidirectional strategy outperforms existent methods ( fig . </S>",
    "<S> [ fig : ft ] ) . </S>",
    "<S> unidirectional estimates of @xmath54 based on jarzynski s equality are markedly biased as the states are further perturbed from the starting equilibrium state . </S>",
    "<S> chelli and coworkers have also developed an asymptotically correct bidirectional estimator that reduces to bar at the end states ( eq .  ( 16 ) in @xcite ) . </S>",
    "<S> however , their derivation is limited to deterministic systems , and although we have empirical evidence that their estimator approaches the correct @xmath54 for brownian simulations in the limit of a large number of trajectories ( data not shown ) , it leads to a more pronounced bias than eq .  </S>",
    "<S> ( [ eq : optimal_ft ] ) for the simulations under the above conditions ( fig .  </S>",
    "<S> [ fig : ft ] ) . </S>",
    "<S> we suspect that this slower convergence is due to the use of an unoptimized jarzynski estimator ( see eq .  </S>",
    "<S> ( 7 ) in @xcite ) , but since a general derivation of their results is not yet available , it is presently difficult to verify this as the source of discrepancy between these two estimators , and we leave this question for future investigations .    </S>",
    "<S> our pmf reconstruction methods also compare favorably with unidirectional methods ( fig . </S>",
    "<S> [ fig : pmfs ] ) . as with @xmath54 , reconstructed pmfs from separate forward and reverse processes increasingly overestimate the pmf farther from region sampled by the original state . in contrast , our bidirectional formula , eq .  </S>",
    "<S> ( [ eq : gz ] ) , optimally combines the data to reduce this bias . </S>",
    "<S> as the method of chelli and coworkers for pmf reconstruction requires a stiff - spring assumption , it is not applicable here .     </S>",
    "<S> ( color online ) comparison of pmf estimators : ( a ) hummer and szabo s method , eq .  </S>",
    "<S> ( [ eq : hsz ] ) , applied to 500 forward ( rightward triangles ) or reverse ( leftward triangles ) pullings . </S>",
    "<S> ( b ) our estimator , eq .  </S>",
    "<S> ( [ eq : gz ] ) , applied to 250 forward and 250 reverse pullings ( upward triangles ) . </S>",
    "<S> the shaded line is the exact pmf . </S>",
    "<S> pmfs from forward and bidirectional data are shifted to align with the exact pmf at @xmath91 ; for the reverse , they are aligned at @xmath92 . in ( b ) , the harmonic potential used in our pullings is shown as a dashed line . ]    in summary , building on the observation that the convergence of jarzynski s nonequilibrium work average is dominated by time - reversed counterparts of trajectories generated via the reverse process @xcite , we have introduced a formula that optimally includes such trajectories in generic nonequilibrium path - averages ( eq .  </S>",
    "<S> ( [ eq : f_general ] ) ) . as an application of this result </S>",
    "<S> , we have derived a bidirectional estimator for free energy differences in terms of nonequilibrium measurements of work ( eq .  ( [ eq : optimal_ft ] ) ) . </S>",
    "<S> although it reduces to bar for the special case of endpoint free energy differences @xmath53 , our formula also allows for the estimation of intermediate values @xmath54 of the free energy during the switching process . when applied to the problem of estimating potentials of mean force @xmath64 in nonequilibrium force spectroscopy , our methods yield a bidirectional estimator for @xmath64 that optimally combines time - slices from forward and reverse measurements of position and work ( eq .  ( [ eq : gz ] ) ) . </S>",
    "<S> numerical comparison of our formula with unidirectional estimates based on the jarzynski equality @xcite or the hummer - szabo method @xcite reveal that our reconstructed free energy differences are of better overall quality than these unidirectional estimators , which are increasingly biased as one drives the system farther away from its original equilibrium state . </S>",
    "<S> it has been noted that faster pullings farther from equilibrium contain less instrument noise and therefore lead to more accurate free energy estimates @xcite . </S>",
    "<S> it is thus expected that our bidirectional estimators will further improve the quality of such experimental estimates by appreciably reducing the finite - sample bias most evident in fast pullings . </S>"
  ]
}