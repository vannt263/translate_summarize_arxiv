{
  "article_text": [
    "spline smoothing is widely used in many different areas to study the relationship between a response variable @xmath0 and an independent variable @xmath1 , see e.g. wahba @xcite for a detailed presentation , and have many applications in approximation problems , see e.g. duchon @xcite , quak & schumaker @xcite , de boor & schumaker @xcite or lopez de silanez & apprato @xcite . in many fields of interest , including physical and medical sciences ,",
    "one is often interested in imposing a monotonic relationship between two such variables .",
    "typical examples include the analysis of dose - response curves in pharmakinetics ( kelly & rice  @xcite ) , growth curves in biology and many specific practical problems discussed in the literature cited below .",
    "note that without loss of generality , monotone smoothing is considered in this paper as the problem of computing an increasing function . for calculating a decreasing smoother one can simply reverse the `` @xmath1 axis '' and then apply the same methodology .",
    "unconstrained spline smoothing consists in minimizing over an appropriate functional space @xmath2 a criterion that represents a balance between two terms : fidelity to the data and smoothness of the fitting spline . if @xmath2 is a reproducing kernel hilbert spaces ( rkhs ) , then it is well known ( see e.g. wahba @xcite ) that a closed form solution can be computed by solving a simple linear system of equations . the simplest idea that comes to mind",
    "to incorporate monotonicity constraints is to restrict the search space @xmath2 to a subset of monotone functions , and then to take as a monotone smoother the function which minimizes the same criterion over this restricted space .",
    "existence , approximation properties and the numerical computation of such monotone smoothers have been widely studied , see e.g. utreras @xcite , andersson & elfving @xcite , elfving & andersson @xcite , irvine , marin & smith @xcite , beatson & ziegler @xcite .    however , finding the exact solution of a smoothing problem in a constrained space is generally a difficult task and most existing algorithms only produce approximate solutions . as a closed form solution for such monotone smoothers does not exist in general ,",
    "their numerical computation is generally done by determining the fitted values of the smoothing spline on a finite set of points ( usually the observed covariates ) and uses a set of inequality constraints to impose restrictions on the value of the fitted function at these points",
    ". however , the algorithms used to compute these estimators can be computationally intensive since they involve a large set of inequality constraints ( see e.g. schwetlick & kunert @xcite , he & shi @xcite , turlach @xcite and the discussion therein ) .    in this paper",
    ", we introduce a new class of monotone smoothers that have a closed form expression which depends on the underlying rkhs , and which can be computed using classical unconstrained spline smoothing techniques .",
    "thus , unlike some monotone smoothers , this method does not require the use of quadratic programming under linear constraints and has therefore a low computational cost .",
    "our approach is based on tools that have been recently developed in the context of image warping for the construction of diffeomorphisms in two or three dimensions ( see e.g. trouv @xcite , miller , trouv & younes @xcite , glauns @xcite , younes @xcite , @xcite , see also apprato & gout @xcite for the use of diffeomorphism in spline approximation ) .",
    "trouv , younes and their collaborators have proposed to compute smooth diffeomorphisms as the solutions of a new class of ordinary differential equation governed by a time - dependent velocity field . in a one - dimensional ( 1d ) setting , it is easy to see that a diffeomorphism is a smooth and monotone function , and thus the main idea of this paper is to adapt such tools for the construction of 1d monotone smoothers .",
    "our approach also yields a new method to compute smooth diffeomorphisms for the alignment of landmarks in a 2d or 3d setting . some examples in the 2d case for image warping ( see e.g. bigot _ et al . _",
    "@xcite ) are given in the section on numerical experiments , but for simplicity our theoretical results are presented in a 1d setting .",
    "our main contributions are the following : first we show how one can generate a strictly monotone function as the solution of an ordinary differential equation ( ode ) .",
    "we also prove that for some functional classes , any monotone function can be represented as the solution of such an ode .",
    "secondly , a new criterion to fit a monotone spline is proposed and we show that the minimizer of this criterion has a simple closed form expression . as an illustrative example",
    ", we explain how the overall methodology can be applied to the problem of monotonizing any estimator of a regression function . indeed , in statistics , a possible smoothing method under shape constraints consists in first using an unconstrained estimator ( such as a spline , wavelets or kernel smoother ) and then projecting the resulting curve estimate onto a constrained subspace of regression functions which is usually a convex set ( see e.g. mammen , marron , turlach & wand  @xcite and mammen & thomas - agnan  @xcite ) .",
    "for the problem of monotone regression , this approach is generally referred to as smooth and then monotonize . however , as pointed out by gijbels  @xcite many of these monotone estimates appear less smooth than the unconstrained estimates due to the projection step .",
    "moreover , it is not clear how one can compute numerically the projection of a curve estimate onto a constrained subspace for any unconstrained estimator .",
    "our monotone estimator does not suffer from these two drawbacks since it can be easily computed , and it yields surprisingly very smooth estimates .",
    "the remainder of the paper is structured as follows : section [ secrkhs ] gives a brief overview of rkhs and the general spline smoothing problem . in section [ secode ] , we show how one can generate a strictly monotone function as the solution of an ode . in section [ sechomeo ] , we propose a new class of monotone smoothers that we call homeomorphic smoothing splines . in section",
    "[ sec : stat ] , we apply this methodology to nonparametric regression under monotonicity constraints .",
    "section [ secsimu ] presents a short monte carlo study on the efficiency of this approach and a comparison with another constrained estimate .",
    "finally , another application of homeomorphic splines is presented in a 2d setting for matching problems involving the alignment of landmarks .",
    "the appendix provides the proofs of the main results .",
    "let @xmath3 a be rkhs of functions in @xmath4 with positive definite kernel @xmath5 , meaning that for all @xmath6 there exists an element @xmath7 such that for all @xmath8 in @xmath3 , we have @xmath9 where @xmath10 denotes the scalar product on @xmath3 whose derived norm is @xmath11 ( for more details on rkhs we refer to atteia @xcite , atteia & gaches @xcite , aronszajn @xcite , duchon @xcite , wahba @xcite , berlinet & thomas - agnan @xcite ) .",
    "let @xmath12 be functions ( not necessarily in @xmath4 ) such that for any set of distinct points @xmath13 in @xmath14 , the matrix @xmath15 with elements @xmath16 has full rank @xmath17 .",
    "let @xmath18 and assume that we have @xmath19 distinct pairs of points @xmath20 .",
    "then the general spline smoothing problem is to find the minimizer @xmath21 for any @xmath22 of the form @xmath23 , where @xmath24 .",
    "it is well known that the solution of this smoothing problem is unique and of the form : @xmath25 where @xmath26 are solutions of a simple linear system of equations ( see e.g. wahba @xcite ) .    throughout this paper",
    ", we will assume @xmath27 with @xmath28 and @xmath29 , these conditions are convenient for satisfying the uniform lipschitz condition stated in lemma [ lemlipbound ] ( see the appendix ) .",
    "as an example of a rkhs , we will often use the sobolev space of order @xmath30 ( see berlinet and thomas - agnan @xcite ) @xmath31 endowed with the norm @xmath32 with this choice for the @xmath33 s , any function @xmath34 is of the form @xmath35 where @xmath36 and @xmath24 .",
    "hence , one can define a norm in @xmath37 by setting @xmath38 note that @xmath37 is a banach space for this norm . from now , to simplify the notations we will omit the superscript @xmath37 and write @xmath39 .",
    "the smoothing spline @xmath40 defined previously is not necessarily a monotone function .",
    "we thus propose to use a connection between monotone functions and time - dependent vector fields to incorporate monotonicity constraints into the computation of @xmath40 .",
    "let us explain the basic ideas ( as described e.g. in younes @xcite ) to generate smooth diffeomorphisms .",
    "take any @xmath41 with @xmath42 .",
    "then if @xmath43 is chosen sufficiently small the perturbation @xmath44 of the identity function , is a strictly increasing _ small _ diffeomorphism .",
    "now , if @xmath45 are continuously differentiable functions on @xmath14 and if @xmath46 is sufficiently small such that @xmath47 are small diffeomorphisms on @xmath14 , then we can construct the following sequence of diffeomorphisms @xmath48 .",
    "then , note that @xmath49 which can also be written as @xmath50 .",
    "\\label{eqodedis}\\ ] ] as @xmath51 and @xmath52 , ( [ eqodedis ] ) looks like a discretized version of an inhomogeneous differential equation of the following form ( by introducing a continuous time variable @xmath53 ) : @xmath54    in the sequel , @xmath55 will be a function of two variables @xmath56 , and for a fixed @xmath53 we will use the notation @xmath57 to refer to the application @xmath58 .",
    "the variable @xmath53 varies in the finite time interval @xmath59 $ ] while @xmath60 belongs to @xmath61 .",
    "similarly @xmath62 depends both on the time @xmath53 and the variable @xmath60 , and @xmath63 will refer to @xmath64 .",
    "thus , equation ( [ edo ] ) is equivalent to : @xmath65    as we will see , under mild conditions on the time - dependent vector field @xmath66}$ ] , the solution of the above ode is a diffeomorphism at all time @xmath53 and thus a monotone function .",
    "the main idea of this paper is thus the following : we transfer the problem of computing a monotone spline from a set of @xmath19 data points @xmath67 to the problem of computing an appropriate vector field @xmath68}$ ] which depends on these data points .",
    "a monotone smoother @xmath69 is then defined as the solution at time @xmath70 of the ode ( [ edo ] ) governed by the vector field @xmath68}$ ] , i.e @xmath71 with @xmath72 .",
    "the main advantage of this approach is that the computation of @xmath68}$ ] will be obtained from an unconstrained smoothing problem , and therefore the calculation of @xmath69 only requires to run an ode without imposing any specific constraints .",
    "this yields a fitting function @xmath69 which is guaranteed to be monotone .      following the notations in younes @xcite , let us state several definitions .",
    "+    @xmath73 is the space of time - dependent vector fields @xmath74)$ ] such that @xmath75 .",
    "@xmath76 is the space of time - dependent vector fields @xmath74)$ ] such that @xmath77 finally , @xmath78 is the set of all time - dependent vector field @xmath79)$ ] .",
    "+    the definitions of @xmath80 are classical in the context of time - dependent pde which are formulated as banach space - valued functions , see e.g. renardy & rogers @xcite .",
    "note that by the cauchy - schwarz inequality , @xmath81 , and thus @xmath82 .",
    "for @xmath83 , we formally define an ode governed by the time - dependent vector field @xmath84)$ ] as @xmath85    let @xmath86 $ ] .",
    "a function @xmath87 is called a solution of the equation ( [ eqodecont ] ) with initial condition the identity if for all @xmath88 , @xmath89 is a continuous function from @xmath90 $ ] to @xmath14 , @xmath91 for all @xmath88 , and for all @xmath92 $ ] and all @xmath88 , @xmath93 +    the following theorem , whose proof is deferred to the appendix , shows that the solution of the equation ( [ eqodecont ] ) is unique and is a homeomorphism for all time @xmath92 $ ] .",
    "+    [ thode ] assume that the kernel @xmath5 is bounded on @xmath94 , and that there exists a constant @xmath95 such that for any @xmath24 @xmath96 let @xmath83 .",
    "then , for all @xmath88 and @xmath92 $ ] , there exists a unique solution of ( [ eqodecont ] ) with initial condition the identity .",
    "besides , for all @xmath92 $ ] , @xmath97 is a homeomorphism from @xmath98 to @xmath99",
    ". +    the above uniformly lipschitz assumption ( [ eqasslip ] ) for the kernel @xmath5 is not restrictive as it is satisfied in many cases of interest .",
    "indeed , observe that for for any @xmath100 : @xmath101 if @xmath5 is a radial kernel of the form @xmath102 for some function @xmath103 , then the above equation implies that @xmath104 .",
    "hence , @xmath105 satisfies equation ( [ eqasslip ] ) provided @xmath106 is uniformly lipschitz on @xmath14 .",
    "this is the case for a gaussian kernel : @xmath107 , and also in the sobolev case where @xmath5 is given by ( see e.g. @xcite ) : @xmath108}{2 m \\exp((2m-1 ) ( i \\frac{\\pi}{2m}+\\frac{k \\pi } { m})}. $ ] + * remark : * this framework can be extended to a 2d setting for generating diffeomorphism of @xmath94 . for this , let @xmath109 denote a set of smooth functions from @xmath94 to @xmath94 ( see section [ sec : h2 ] for an example ) and define @xmath110 ) \\mbox { with }   v_t \\in \\tilde{{\\ensuremath{{\\mathcal h}}}}_{2 } \\mbox { for all } t \\in [ 0,1 ]   \\}$ ] .",
    "let let @xmath98 be an open subset of @xmath94 and define an ode governed by the time - dependent vector field @xmath84 ) \\in   \\tilde{\\mathcal{x}}$ ] as : @xmath111 with @xmath112 .",
    "using arguments in the proof of theorem [ thode ] and assuming that the functions @xmath105 in @xmath113 are sufficiently smooth and satisfy a uniform lipschitz condition of the type ( [ eqasslip ] ) , then one can easily show that the solution of such an ode is unique and is a diffeomorphism from @xmath98 to @xmath114 for all time @xmath92 $ ] .",
    "a natural question is to ask if any monotone function can be written as the solution of an ode governed by a time - dependent vector field .",
    "first , consider the case where @xmath31 and @xmath115 belongs to the sobolev space @xmath116 ) = \\{f : [ 0,1 ] \\to { \\ensuremath{\\mathbb{r } } } , \\text{$f^{(m-1)}$ is absolutely continuous with } \\int_{0}^{1 } |f^{(m)}(x)|^{2}dx < + \\infty \\}.\\ ] ] then , if @xmath115 is monotone , one of our main results is the following theorem which states that @xmath115 can be represented as the solution at time @xmath70 of an ode : +    [ theovf ] assume that @xmath117 .",
    "let @xmath118 and @xmath119)$ ] be such that @xmath120 for all @xmath121 $ ] and define @xmath122 , for all @xmath92 $ ] .",
    "then , there exits a time - dependent vector field @xmath123}$ ] depending on @xmath115 , such that @xmath124 for all @xmath92 $ ] and which satisfies @xmath125 , and thus @xmath126 moreover for all @xmath92 $ ] one has that @xmath127 .",
    "\\label{eqvf1}\\ ] ] for all @xmath92 $ ] , the function @xmath128 can be chosen as the unique element of minimal norm in @xmath129 which satisfies equation ( [ eqvf1 ] ) .",
    "+    to the best of our knowledge , this representation of a monotone function by such an ode has not been used before .",
    "the formulation ( [ eqvf1 ] ) suggests the following trick to compute a monotone smoother from a set of @xmath19 data points @xmath130 \\times { \\ensuremath{\\mathbb{r } } } $ ] : if one considers @xmath131 as an approximation of @xmath132 for some function @xmath115 , then to obtain a good approximation of @xmath133 , one can use the @xmath131 s to compute a vector field @xmath134 that satisfies roughly the interpolating conditions ( [ eqvf1 ] ) at the design points .",
    "more precisely , at any time @xmath53 , the vector field @xmath135 is obtained by smoothing the `` data '' @xmath136 . finally , to compute a monotone smoother",
    "@xmath69 we just have to run the ode ( [ eqodecont ] ) with the vector field @xmath134 .    when @xmath137 , it is not clear if one can obtain a general correspondence between monotone functions and their representation via a vector field @xmath138 .",
    "however , we believe that the proof of theorem [ theovf ] could be adapted to other rkhs .",
    "let @xmath139 be a set of data points with @xmath140 $ ] and @xmath141 .",
    "a new smoothing spline problem under monotonicity constraints can be formulated in the following way : for a time - dependent vector field @xmath142 , define the `` energy '' @xmath143 where @xmath144 , and @xmath145 is a regularization parameter . then , take @xmath146 and a monotone smoother @xmath147 is obtained by taking @xmath148 the following proposition gives sufficient conditions for the existence of @xmath149 : +    [ propexist ] assume that the conditions of theorem [ thode ] are satisfied .",
    "assume that @xmath150 and that the kernel @xmath151 is continuous .",
    "suppose that the @xmath152 s and the @xmath131 s are such that the @xmath19 `` design points '' @xmath153 are distinct in @xmath14 for any @xmath92 $ ] .",
    "then , the optimization problem ( [ eqhomeospline1 ] ) has a unique solution @xmath154 such that at each time @xmath92 $ ] , @xmath155 is the solution of the following standard unconstrained smoothing problem : find @xmath156 which minimizes @xmath157 where @xmath144 .",
    "moreover @xmath158 , and @xmath147 is a monotone function on @xmath90 $ ]",
    ". +    let us remark that if one defines @xmath159 as the subspace of functions @xmath160 such that @xmath115 is a strictly monotone function on @xmath90 $ ] , then a monotone smoother @xmath161 can de defined by mininizing the classical spline smoothing criterion over the restricted space @xmath159 i.e. @xmath162 general smoothing splines problems under under shape constraints such as monotonicity have been studied in detail in utreras @xcite .",
    "theorems proving the existence , uniqueness and general results concerning the characterization of @xmath161 are given in utreras @xcite , together with a study of the convergence rate of @xmath161 in a nonparametric regression setting .",
    "hence , it would be interesting to study the relationship that may exist between the estimators @xmath161 and @xmath147 .",
    "however , we believe that this problem is not an easy task which is beyond the scope of this paper .      [ [ numerical - computation ] ] numerical computation + + + + + + + + + + + + + + + + + + + + +    the optimization problem ( [ eqener0 ] ) amounts to solve , at each time @xmath92 $ ] , a simple finite - dimensional least - square problem which yields a very simple algorithm to compute a smooth increasing function : choose a discretization @xmath164 of the time - interval @xmath90 $ ] ( we took @xmath165 ) and set @xmath166 for @xmath121 $ ] . then repeat for @xmath167 :",
    "find the solution @xmath168 of the unconstrained smoothing problem ( [ eqener0 ] ) for each @xmath169 , and then compute @xmath170 .",
    "the proposed numerical scheme is based on @xmath171 which replaces the theoretical relation @xmath172 .",
    "remark that equation ( [ eq : euler ] ) shows that if @xmath173 for all @xmath53 , then @xmath174 remains monotone provided @xmath175 is monotone .",
    "this condition is not really restrictive since we have shown that @xmath176}$ ] is in @xmath76 and that @xmath177 is a continuous map on @xmath59 $ ] .",
    "thus , our estimator based on the euler scheme ( [ eq : euler ] ) remains monotone if @xmath15 is chosen sufficiently large , namely greater than @xmath178 } \\|v^{n,\\lambda}_t\\|$ ] .",
    "another important question is the error made using the euler discretization scheme instead of the correct ode this point is left open since it is far beyond the scope of this paper but the use of the gronwall lemma should enable to derive upper bound between the theoretical @xmath179 and the approximated one derived from ( [ eq : euler ] ) .    [ [ choice - of - the - regularization - parameter ] ] choice of the regularization parameter + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    a fundamental issue is the choice of the regularization parameter @xmath180 . in our simulations , we have obtained good results via an empirical choice of @xmath180 inspired by the generalized cross - validation ( gcv ) criterion of craven & wahba @xcite , see also girard @xcite for fast cross - validation methods . for @xmath181 and",
    "@xmath92 $ ] , define @xmath182 and @xmath183 .",
    "then , note that at each time @xmath92 $ ] the smoothing spline @xmath155 evaluated at the `` design points '' @xmath184 is a linear function of the observations @xmath185 , i.e. there exists a matrix @xmath186 such that @xmath187 , with @xmath188 .",
    "therefore , to choose the smoothing parameter @xmath180 , we simply propose to minimize the following empirical gcv - type criterion : @xmath189^{2 } dt}. \\label{eqgcv}\\ ] ] in the above equation , the quantity @xmath190^{2 } dt$ ] can be interpreted as a measure of the degree of freedom of the smoothing spline @xmath191 .",
    "the quantity @xmath192 is therefore the classical gcv criteria which is the ratio between the empirical error and the complexity of a smoothing procedure . to set a good penalization parameter @xmath180",
    ", we simply use a grid search to minimize @xmath192 .",
    "[ [ computational - cost ] ] computational cost + + + + + + + + + + + + + + + + + +    the proposed method has a relatively low computational cost compared to classical constrained optimization methods . if @xmath193 denotes a discretization of @xmath90 $ ] ( with @xmath15 ndependent of @xmath19 ) , our method requires for each @xmath194 the inversion of a symmetric definite matrix of size @xmath195 which is possible using @xmath196 operations with a cholesky algorithm for instance .",
    "the computational cost of our method is thus @xmath197 .",
    "numerical computation of a constrained spline smoothing problem such as ( [ eqsmoothsplineconst ] ) is generally done by using a set of inequality constraints to impose monotonicity on the value of the fitted function at a finite number of points .",
    "however , such algorithms can be computationally intensive since solving a general problem of quadratic optimization with linear constraints is generally np - hard ( see e.g. pardalos & vavasis @xcite ) .",
    "primal - dual methods for instance can iteratively solve the problem but their complexity is larger than @xmath196 .",
    "consider the standard nonparametric regression problem on a bounded interval : @xmath198 where @xmath199 \\rightarrow { \\ensuremath{\\mathbb{r } } } $ ] and @xmath200 are independent and identically distributed ( i.i.d . )",
    "variables with zero mean and variance @xmath201 .",
    "the regression function @xmath115 is assumed to belong to a class of strictly increasing functions @xmath202 that satisfy some smoothness conditions to be defined later . smoothing procedures for monotone regression can be found in he & shi @xcite , kelly & rice  @xcite , mammen  @xcite , mammen & thomas - agnan  @xcite , hall & huang  @xcite , mammen , marron , turlach & wand  @xcite , dette , neumeyer & pilz  @xcite and antoniadis , bigot & gijbels  @xcite .    in this section , we explain how homeomorphic splines can be used as a smooth and then monotonize method .",
    "let @xmath203 be an unconstrained estimator obtained from the data @xmath204 ( e.g. by spline , kernel or wavelet smoothing ) .",
    "our goal is to construct a monotone estimator @xmath205 which inherits the asymptotic properties of the unconstrained estimator @xmath203 in terms of the empirical mean squared error : @xmath206 for this , starting from the values @xmath207 instead of the observed @xmath208 s , take the vector field @xmath209 which minimizes the following criterion : @xmath210 where @xmath144",
    ". then @xmath211 is defined as the solution at time @xmath212 of the ode ( [ eqodecont ] ) governed by the time - dependent vector field @xmath209 .",
    "the following theorem shows that under mild conditions on the design and the unconstrained estimator , the monotone estimator @xmath211 inherits the asymptotic properties of @xmath213 in term of rate of convergence . to the best of our knowledge ,",
    "this is the first consistency result on estimators defined through large diffeomorphism models governed by ode .",
    "+    [ theomain ] assume that the conditions of theorem [ thode ] are satisfied , and that the kernel @xmath151 is continuous .",
    "moreover assume that the function @xmath115 is continuously differentiable on @xmath90 $ ] with @xmath120 for all @xmath121 $ ] and that there exists a time - dependent vector field @xmath214 such that for all @xmath92 $ ] : @xmath215,\\ ] ] where @xmath122 .",
    "suppose that the unconstrained estimator @xmath213 and the points @xmath216 satisfy the following property : +    a1 : :    for all @xmath92 $ ] and all    @xmath217 with @xmath218 ,    @xmath219    then , @xmath220 and thus @xmath211 is a monotone function on @xmath90 $ ] . if we further assume that : +    a2 : :    there exists a weight function    @xmath221 \\to ] 0,+\\infty[$ ] such that for any    @xmath222,{\\ensuremath{\\mathbb{r } } } ) $ ]    one has    @xmath223 , a3 : :    @xmath224 .",
    "+    then , for any sequence @xmath225 , we have that there exists a deterministic constant @xmath226 ( not depending on @xmath19 ) such that with probability tending to one as @xmath227 : @xmath228    equation ( [ eqalmost ] ) may not be satisfied for time points @xmath229 such that @xmath230 . since the function @xmath231 is injective , this can only happen for a finite number of time points @xmath92 $ ] .",
    "hence assumption * a1 * is generally satisfied provided the design points are distinct .",
    "moreover , if equation ( [ eqalmost ] ) is not satisfied for some points @xmath53 , one can argue that it is possible to modify the estimator @xmath213 without changing its asymptotic properties ( by slightly varying e.g. the smoothing parameter used to compute it ) such that ( [ eqalmost ] ) is true for any @xmath92 $ ] and all @xmath217 .",
    "note that under assumption * a1 * , proposition [ propexist ] implies that @xmath209 can be easily implemented using unconstrained spline smoothing .",
    "the assumption * a2 * means that in some sense the design points are sampled according to the density @xmath232 .",
    "the assumption * a3 * is satisfied whenever the expected empirical mean squared error @xmath233 converges to zero as @xmath227 .",
    "the fact that @xmath158 guarantees that @xmath203 is a monotone function .",
    "moreover , one can see that if @xmath163 decays as fast as the empirical error @xmath234 then the estimator @xmath235 has the same asymptotic convergence rate than the unconstrained estimator @xmath203 . similar results for smooth and then monotonize approaches are discussed in mammen & thomas - agnan  @xcite , mammen , marron , turlach & wand  @xcite .",
    "however , the advantages of our approach over existing methods are the following : it yields a monotone smoother which has a closed form expression and which is guaranteed to be monotone on the whole interval @xmath90 $ ] .",
    "moreover , our approach is very general as it is not restricted to functions belonging to sobolev spaces .",
    "let us return to the specific case where @xmath236)$ ] and @xmath31 .",
    "the asymptotic properties and optimal rates of convergence ( in the minimax sense ) of unconstrained estimators for functions belonging to sobolev spaces has been extensively studied ( see e.g. nussbaum @xcite , speckman @xcite ) . the estimator @xmath237 of speckman @xcite is based on the use of the demmler - reinsch spline basis and on a smoothing parameter @xmath238 ( see speckman @xcite for further details ) .",
    "speckman @xcite has shown that for an appropriate choice @xmath239 then @xmath240 if @xmath236)$ ] which is known to be the minimax rate of convergence for functions belonging to sobolev balls .",
    "this result is based on the assumption that the design points are such that @xmath241 where @xmath242 \\to [ 0,1]$ ] is a continuously differentiable function with @xmath243 for some constant @xmath244 .",
    "hence , the estimator of speckman @xcite satisfies assumption * a2 * with @xmath245 , and one can check that assumption * a1 * also holds .",
    "the following corollary is thus an immediate consequence of theorem [ theovf ] and theorem [ theomain ] : +    assume that @xmath117 .",
    "let @xmath118 and @xmath119)$ ] be such that @xmath120 for all @xmath121 $ ] .",
    "then , the monotone estimator @xmath235 based on the minimax estimator @xmath246 of speckman @xcite is such that @xmath247 provided @xmath248 .",
    "+    to obtain an adaptive choice of @xmath180 ( not depending on the unknown regularity @xmath249 of @xmath115 ) , the above corollary suggests to take @xmath250 to have a monotone estimator whose empirical mean squared error decays as fast as @xmath234 .",
    "this choice may yield satisfactory estimates but in our simulations a data - based choice for @xmath180 using a gcv criteria ( [ eqgcv ] ) gives much better results .",
    "dette , neumeyer and pilz  @xcite have recently proposed another type of smooth and then monotonize method which combines density and regression estimation with kernel smoothers .",
    "this approach has been shown to be very successful on many simulated and real data sets ( see dette and pilz  @xcite ) and we shall therefore use it as a benchmark to assess the quality of our monotone estimator . similarly to our approach , it requires a preliminary unconstrained estimator @xmath203 .",
    "this estimator is then used to estimate the inverse @xmath251 of the regression function . for",
    "this dette , neumeyer and pilz  @xcite propose to use the following estimator @xmath252 where @xmath253 is a positive kernel function with compact support , @xmath254 a bandwidth that controls the smoothness of @xmath255 and @xmath256 is an integer not necessarily equal to the sample size @xmath19 which controls the numerical precision of the procedure . a monotone estimator @xmath257 is then obtained by reflection of the function @xmath255 at the line @xmath258 ( see dette , neumeyer and pilz  @xcite for further details ) . in dette and pilz  @xcite , it is proposed to use a local linear estimate ( see fan and gijbels @xcite ) with epanechnikov kernel for the unconstrained estimator @xmath203 .",
    "the bandwidth @xmath259 of this unconstrained estimate is chosen as @xmath260 , where @xmath261 . for the choice of the bandwidth @xmath254",
    ", it is recommended to choose @xmath262 .",
    "however , for a fair comparison with our data - based choice of @xmath180 via gcv , the best choice for @xmath254 is chosen by cross - validation via a grid search .",
    "we investigate the regression model with a regular design i.e. @xmath263 , normally distributed errors , sample size @xmath264 and a signal to noise ratio ( snr ) of 3 .",
    "the signal - to - noise ratio is measured as @xmath265 , where @xmath266 is the estimated standard deviation of the regression function , @xmath267 over the sample @xmath268 , and @xmath269 is the true standard deviation of the noise in the data .",
    "the monotone regression functions that we consider are ( see dette and pilz  @xcite ) @xmath270 these functions correspond to , respectively , a function with a `` continuous jump '' , a strictly increasing curve with a plateau , and a convex function .",
    "the different functions are displayed in figures [ figm1]-[figm3 ] .    in figures",
    "[ figm1]-[figm3 ] , we present some curves for the estimates of these three test functions . a gaussian kernel has been used to compute the homeomorphic smoothing splines ( using other kernels gives similar results ) . for the choice of the regularization parameter @xmath180 the gcv criterion ( [ eqgcv ] )",
    "is used , and recall that we use cross - validation for the choice of @xmath254 . as one can see in figures [ figm1]-[figm3 ] , the homeomorphic smoothing spline based on the local linear estimator gives results similar to those obtained via the estimator of dette , neumeyer and pilz  @xcite .",
    "however , our approach yields monotone estimator that are visually much smoother and very close to the true regression in all cases .",
    "homeomorphic smoothing splines also seems to give very nice results even if the unconstrained estimator @xmath203 is very oscillating as it is the case for the local linear estimator in figure [ figm2 ] and figure [ figm3 ] .",
    ".mean integrated squared error ( mise ) over the 100 simulations for each method . [",
    "cols=\"^,^,^,^\",options=\"header \" , ]     [ tabmise ]    to compare these two monotone estimates , we have used 100 simulations runs for each regression function .",
    "the same unconstrained estimator ( a local linear estimate with epanechnikov kernel ) is used .",
    "for the 100 simulations , we have calculated the pointwise mean squared error ( mse ) for the two estimates @xmath205 and @xmath257 , evaluated on an equidistant grid of size @xmath271 .",
    "curves for the mse of the three estimate are displayed in figure [ figmse3 ] .",
    "again , these simulations clearly show that our approach compares similarly to the monotone estimator of dette , neumeyer & pilz  @xcite for the signal @xmath272 and @xmath273 , and outperforms dette et al.s estimator for the function @xmath274 .",
    "table [ tabmise ] shows that it gives better results in terms of mean integrated squared error ( mise over @xmath90 $ ] ) for the three test functions .",
    "let @xmath275 and @xmath276 be two sets of @xmath19 landmark in @xmath94 .",
    "the problem of landmark matching is to find a function @xmath277 such that @xmath278 for all @xmath279 ( see e.g camion & younes @xcite and references therein ) .",
    "let @xmath280 be a rkhs of functions in @xmath281 with positive definite kernel @xmath5 and denote by @xmath113 the set of functions @xmath277 given by @xmath282 where @xmath283 , @xmath284 is @xmath285 matrix and @xmath286 .",
    "landmark matching can be formulated as the problem of finding the minimizer @xmath287 under mild assumptions on the landmarks , the solution of this matching problem is unique and of the form : @xmath288 where @xmath289 are solutions of a simple linear system of equations ( see e.g camion & younes @xcite ) . however , there are no constraints in this approach which guarantees that @xmath290 is a one - to - one mapping of @xmath94 .",
    "indeed , folding are possible for small values of @xmath180 as shown in figure [ fig : alignland ] , where the mapping @xmath290 is displayed via the deformation of an equally spaced grid of points in @xmath94 .    .",
    "let @xmath110 ) \\mbox { with }   v_t \\in \\tilde{{\\ensuremath{{\\mathcal h}}}}_{2 } \\mbox { for all } t \\in [ 0,1 ]   \\}$ ] .",
    "diffeomorphic matching of two sets of landmarks in @xmath94 by homeomorphic spline is defined as the problem of finding a time - dependent vector field @xmath291 , which minimizes the `` energy '' @xmath292 with @xmath145 a regularization parameter and @xmath293 where for each @xmath92 $ ] , @xmath294 , @xmath295 is @xmath285 matrix and @xmath296 .",
    "then , by taking @xmath297 a diffeomorphic mapping between these two sets of landmarks is obtained by computing @xmath298 under mild assumptions , and arguing as in the proof of proposition [ propexist ] , the optimization problem ( [ eqhomeospline2d ] ) has a unique solution @xmath299 such that at each time @xmath92 $ ] , @xmath155 is the solution of the following standard unconstrained smoothing problem : find @xmath300 which minimizes @xmath301 where @xmath302 . hence",
    ", the computation of the diffeomorphic mapping @xmath147 is obtained using unconstrained spline smoothing and by running an ode .",
    "numerically , we use an euler scheme similar to the one proposed in section [ seccomp ] .",
    "remark that the formulation ( [ eqhomeospline2d ] ) is somewhat similar to the geodesic smoothing spline problem proposed by camion & younes @xcite in 2d setting . to compute a smooth diffeomorphism to align two sets of landmarks",
    "@xmath303 in @xmath304 , camion & younes @xcite suggest to minimize the following energy @xmath305 over all time - dependent vector fields and all landmark trajectories @xmath306 with initial conditions @xmath307 and @xmath308 .",
    "this leads to an optimization problem which can be solved by a gradient - descent algorithm . in our formulation ( [ eqhomeospline2d ] ) ,",
    "the landmarks trajectories are fixed , and correspond to linear paths @xmath309 between @xmath152 and @xmath131 .",
    "this makes the optimization problem ( [ eqyou ] ) easier to solve .",
    "an example of diffeomorphic mapping is shown in figure [ fig : alignland ] , and one can see that even for small values of @xmath180 the mapping remains one - to - one contrary to unconstrained spline smoothing .",
    "an example of landmark - based image warping is also displayed in figure [ fig : alignimg ] which illustrates the advantages of homeospline over unconstrained spline smoothing which may lead to unrealistic matching .",
    "homeomorphic splines allows one to compute with a low computational cost , monotone regressors in a 1d setting . in the presence of noisy data ,",
    "this leads to an estimator which performs at least as well as existing ones .",
    "moreover such an estimator has an optimal rate of convergence over a large class of functional spaces .",
    "homeomorphic splines can also be extended in a 2d setting for landmarks and image warping . in future work",
    ", we plan to investigate applications for 2d regression under monotonicity constraints , and also to study the asymptotic normality of our estimator .",
    "+ * acknowledgments : * we would like to gratefully acknowledge christine thomas - agnan for discussions about rkhs , and anestis antoniadis , alain trouv and laurent younes for very helpful comments on an early version of the manuscript .",
    "* proof of theorem [ thode ] : * the key point to derive this result is the use of the following lemma which follows immediately from condition ( [ eqasslip ] ) and the assumption @xmath310 , @xmath311 , @xmath312 made in section [ secrkhs ] .",
    "[ lemlipbound ] suppose that the assumptions of theorem [ thode ] are satisfied .",
    "then , for any @xmath313 , there exists a constant @xmath314 ( not depending on @xmath8 ) such that for all @xmath315 , @xmath316 , and @xmath317 .",
    "+      * invertibility of the solution :* for @xmath318 , @xmath88 and any @xmath319 $ ] , we denote by @xmath320 the value at time @xmath53 of the unique solution of the equation @xmath321 which is equal to @xmath60 at time @xmath322 .",
    "the solution @xmath320 is equal to @xmath323 at time @xmath324 $ ] , and thus also equal to @xmath325 which implies that @xmath326 and thus @xmath327 which proves that for all @xmath92 $ ] @xmath328 is invertible , and that its inverse is given by @xmath329 .",
    "* continuity of @xmath97 and its inverse : * @xmath97 is a homeomorphism using gronwall s lemma and the arguments in younes @xcite .",
    "this ends the proof of theorem [ thode ] .",
    "@xmath330 + * proof of theorem [ theovf ] : * let @xmath92 $ ] and define the interval @xmath331 = [ a_{t},b_{t}].$ ] given our assumptions on @xmath115 the function @xmath122 is a continuously differentiable homeomorphism from @xmath90 $ ] to @xmath332 such that its inverse is continuous and differentiable with @xmath333 which shows that @xmath334 is continuous since we have assumed that @xmath120 for all @xmath121 $ ] . hence , @xmath97 is a diffeomorphism from @xmath90 $ ] to @xmath332 .",
    "moreover , the above formula for @xmath334 and the fact that @xmath335)$ ] implies that @xmath336 belongs to @xmath337 by application of the chain rule of differentiation .",
    "let @xmath338 the function defined on @xmath332 such that @xmath339 given that @xmath97 is a diffeomorphism from @xmath90 $ ] to @xmath332 and that @xmath340 , we can again apply the chain rule of differentiation to show that @xmath338 belongs to @xmath337 . now , define the sub - space @xmath341 of functions in @xmath129 which coincide with @xmath338 on @xmath342 $ ] . first , we shall prove that @xmath341 is not empty .",
    "indeed , choose @xmath343 and @xmath344 and define the hermite polynomials @xmath345 and @xmath346 of degree @xmath347 such that for all @xmath348 , @xmath349 and @xmath350 , and @xmath351 and @xmath352 .",
    "then , define the function @xmath353 on @xmath14 such that @xmath354-\\infty , c_{t } [ , \\\\ p_{0}(y ) & \\mbox { for } y \\in [ c_{t},a_{t } [ , \\\\ \\tilde{f}_{t}(y ) & \\mbox { for } y \\in [ a_{t},b_{t } ] , \\\\",
    "p_{1}(y ) & \\mbox { for } y \\in ] b_{t},d_{t } ] , \\\\ 0 & \\mbox { for } y \\in ] d_{t},+\\infty [ , \\\\ \\end{array } \\right.\\ ] ] by construction of @xmath345 and @xmath346 and the fact that @xmath355 , we have that @xmath353 belongs to @xmath129 , and thus @xmath341 is not empty . since the space @xmath341 is closed and convex , it contains a unique element of minimum norm that we denote by @xmath128 which satisfies equation ( [ eqvf1 ] ) by construction of @xmath341 , which completes the proof theorem [ theovf ] . @xmath330    * proof of proposition [ propexist ] :* let @xmath92 $ ] .",
    "given our assumptions on the @xmath152 s and the @xmath131 s we can define the function @xmath356 as the smoothing spline which minimizes the energy @xmath357 as defined in equation ( [ eqener0 ] ) .",
    "then , by definition of @xmath358 we have that for any @xmath359 , @xmath360 which implies that for any @xmath142 @xmath361 which proves that @xmath209 is a minimum of @xmath362 .",
    "then , the uniqueness of @xmath209 follows from the strict convexity of @xmath363 .",
    "now , for @xmath181 and @xmath92 $ ] , let @xmath364 and @xmath365 .",
    "then , the time - dependent vector field @xmath155 is such that for any @xmath6 ( see wahba @xcite ) @xmath366 where the coefficients @xmath367 and @xmath368 are given by : @xmath369 and @xmath370 with @xmath188 , @xmath371 and @xmath372 is the @xmath195 matrix with elements @xmath373 = k(\\hat{x}_{i}^{t},\\hat{x}_{j}^{t})$ ] , @xmath374 is the @xmath375 matrix with elements @xmath376 = 1 $ ] and @xmath377 = \\hat{x}_{i}^{t}$ ] , and @xmath378 is the @xmath195 matrix given by @xmath379 then by the continuity of @xmath5 and the continuity of matrix inversion , it follows that the coefficients @xmath380 and @xmath381 are continuous functions of @xmath53 on @xmath90 $ ] . hence , @xmath382 is a continuous function on @xmath90 $ ] which implies that @xmath383 .",
    "hence @xmath158 which completes the proof of proposition [ propexist ] using theorem [ thode ] .",
    "@xmath330    * proof of theorem [ theomain ] : * in the proof , @xmath384 will denote a constant whose value may change from line to line . for @xmath181 and @xmath92 $ ] , let @xmath385 , @xmath386 and @xmath387 .",
    "one can remark that the smoothing spline @xmath155 evaluated at the `` design points '' @xmath388 is a linear function of the observations @xmath185 and can therefore be written as @xmath389 where @xmath390 then , under the assumptions of theorem [ theomain ] , the following lemma holds ( the proof follows using arguments in craven & wahba @xcite ) :            @xmath397 where @xmath144 .",
    "we will show that @xmath209 converges in probability to @xmath133 for the norm @xmath398 .",
    "let @xmath399 @xmath400 be a compact set in @xmath76 and take @xmath401 : @xmath402 where @xmath403 and @xmath404dw_{n}(x ) dt,\\end{aligned}\\ ] ] with @xmath405 , since @xmath406 , we have that @xmath407 then , remark that @xmath408 , where @xmath409 @xmath410 and @xmath411    @xmath412dw_{n}(x ) dt .",
    "$ ] let @xmath413 , then @xmath414 by fubini theorem .",
    "lemma [ lemlipbound ] , implies that @xmath415 is bounded on @xmath90 $ ] by @xmath416 then , from the compactness of @xmath400 it follows that there exists a constant @xmath384 such that for all @xmath401 @xmath417 hence , by definition of @xmath418 and @xmath419 the inequality above finally implies that @xmath420 now , using cauchy - schwarz inequality we have that @xmath421 where @xmath422 and @xmath423 note that using lemma [ lemlipbound ] , it follows that @xmath424 then , one has that @xmath425 and thus @xmath426 by assumption , @xmath427 in probability , and thus @xmath428 by combining the above equation with the bound for @xmath429 , we finally obtain that in probability @xmath430 so finally , we obtain from ( [ eqi12 ] ) that @xmath431 in probability as @xmath432 which implies together with equation ( [ eqe2 ] ) that @xmath433 in probability as @xmath434 now , remark that since @xmath435 and @xmath436 are positive and strictly convex functionals , they have a unique minimum over the set of time - dependent vector fields @xmath78 .",
    "moreover , by definition of @xmath437 one has that for any @xmath92 $ ] , @xmath438 which implies that @xmath133 is the minimum of @xmath439",
    ". let @xmath46 and define @xmath440 and let @xmath441 be the frontier of @xmath442 . since @xmath133 is the minimum of @xmath439 , there exits @xmath443 such that for any @xmath444 @xmath445 obviously , @xmath442 is a compact subset of @xmath446 , and thus @xmath447 converges to zero in probability .",
    "this implies that for any @xmath448 , there exists @xmath449 such that for any @xmath450 , @xmath451 similarly , there exists @xmath452 such that for any @xmath453 , @xmath454 hence , we have that for any @xmath455 , @xmath456 this implies that except on a set of probability less than @xmath457 , @xmath458 has a local minimum in the interior of @xmath442 which is thus the global minimum @xmath209 since @xmath458 is strictly convex .",
    "hence , we finally have that for any @xmath46 then with probability tending to one @xmath209 belongs to @xmath442 which implies that @xmath209 converges in probability to @xmath133 for the norm @xmath459 .",
    "this proves that there exists a constant @xmath460 ( not depending on @xmath19 ) such that as @xmath461 , @xmath462 which completes the proof of lemma [ lemexist ] .",
    "@xmath330 + now , since @xmath158 , theorem [ thode ] implies that we can define @xmath211 and @xmath463 as the solutions respectively at time @xmath70 and time @xmath92 $ ] of the ode @xmath464 .",
    "we shall now control the empirical error @xmath465 .",
    "first , @xmath466 and note that for any @xmath92 $ ] @xmath467 which implies that ( using cauchy - schwarz inequality and the fact that @xmath468 ) @xmath469 to bound this sum , we shall use the following lemma whose proof can be found in younes @xcite        hence , @xmath481 since by definition of @xmath482 one has @xmath483 , and where @xmath484 .",
    "similarly , we have that @xmath485 where @xmath486 and @xmath487 .",
    "hence , @xmath488 now , remark that @xmath489 and observe that by lemma [ lemeig ] @xmath490 and let @xmath491 be the solution of the following smoothing problem : find @xmath492 which minimizes @xmath493 where @xmath144 .",
    "then , by definition of @xmath491 we have that @xmath494 finally , by combing equations ( [ eqi1a ] ) and the above inequality , we obtain that there exists a constant @xmath384 such that @xmath495 now using lemma [ lemexist ] , and combining the above relation with equations ( [ eqct3 ] ) and ( [ eqa ] ) , we finally obtain in probability @xmath496 where @xmath497 for some constant @xmath498 .",
    "similarly , by lemma [ lemexist ] we have that there exists a constant @xmath499 such that ( in probability ) for any @xmath500 $ ] @xmath501 then , by combining the previous inequalities , we derive from lemma ( [ lemyou ] ) that @xmath502 now , since @xmath503 and @xmath504 , we finally obtain that there exists a constant @xmath226 such that with probability tending to one as @xmath227 @xmath505 which completes the proof of theorem [ theomain ] .",
    "@xmath330                                        gijbels , i.  ( 2005 ) .",
    "monotone regression , to appear in _ encyclopedia of statistical sciences , second edition_. editors s. kotz , n.l .",
    "johnson , c.b .",
    "read , n. balakrishnan , and b. vidakovic .",
    "wiley , new york .",
    "glauns , j. ( 2005 ) .",
    "modles dformables en appariement de formes .",
    "transport par diffomorphismes de points , de mesures et de courants pour la comparaison de formes et lanatomie numrique , _ phd thesis ( in french ) , universit paris 13_.                lopez de silanes , m.c . and",
    "apprato , d. ( 1988 ) .",
    "approximation error estimates on a bounded domain in @xmath507 interpolating and smoothing discrete @xmath508-splines .",
    "_ numerische mathematik _ ,",
    "* 53 * , ( 3 ) 367376 ."
  ],
  "abstract_text": [
    "<S> in this paper we introduce a new class of diffeomorphic smoothers based on general spline smoothing techniques and on the use of some tools that have been recently developed in the context of image warping to compute smooth diffeomorphisms . </S>",
    "<S> this diffeomorphic spline is defined as the solution of an ordinary differential equation governed by an appropriate time - dependent vector field . </S>",
    "<S> this solution has a closed form expression which can be computed using classical unconstrained spline smoothing techniques . </S>",
    "<S> this method does not require the use of quadratic or linear programming under inequality constraints and has therefore a low computational cost . </S>",
    "<S> in a one dimensional setting incorporating diffeomorphic constraints is equivalent to impose monotonicity . </S>",
    "<S> thus , as an illustration , it is shown that such a monotone spline can be used to monotonize any unconstrained estimator of a regression function , and that this monotone smoother inherits the convergence properties of the unconstrained estimator . some numerical experiments are proposed to illustrate its finite sample performances , and to compare them with another monotone estimator . </S>",
    "<S> we also provide a two - dimensional application on the computation of diffeomorphisms for landmark and image matching .    _ key words and phrases : _ reproducing kernel hilbert space , constrained smoothing ; monotonicity ; splines ; nonparametric regression ; diffeomorphism ; ordinary differential equation ; time - dependent vector field . </S>",
    "<S> + _ ams 1991 subject classifications _ : primary 62g08 ; secondary 65dxx . </S>"
  ]
}