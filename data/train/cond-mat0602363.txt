{
  "article_text": [
    "some years ago , maggs and collaborators @xcite introduced a local reformulation of the statistical mechanics of a coulomb gas of mobile charged entities , relying on the fact that the long - range coulomb interaction could be recovered from a hamiltonian written in terms of an electric field variable coupled to the charge density via gauss law . since the publication of this paper , more recent",
    "work has focused on improving the efficiency and capability of the method so that it may be applied to larger and more realistic systems @xcite .",
    "the partition function in this approach is written as a functional integral over an electric field variable containing a physical longitudinal ( gradient ) part incorporating the electrostatic potential energy , as well as an unphysical transverse ( curl ) part .",
    "the latter component of the electric field can easily be seen to decouple from the charged particle motion , _ provided the dielectric constant does not change in the course of the simulation _",
    "( i.e. is non - dynamical ) . note that a spatially varying dielectric medium is perfectly allowable in the context of the original method : the integration over the transverse parts of the electric field variable only introduces spurious interactions if the dielectric function is also a function of the particle locations .",
    "this latter situation is of course quite common in simulations of biophysical interest , for example if the charges are attached to a polymer undergoing conformational changes .    in a recent paper @xcite",
    ", we suggested a new algorithm for compensating for the spurious interactions introduced by the integration over the curl part of the electric field in situations of this type .",
    "the extra terms actually correspond simply to the inverse determinant of the poisson operator @xmath0 . removing them",
    "therefore amounts to the problem of introducing a positive power of the determinant of a local operator into a functional integral .",
    "this problem has been intensively studied in elementary particle theory , where the inclusion of virtual quark effects in lattice quantum chromodynamics simulations require the introduction of just such a determinant in a functional integral . in particular , the multiboson method introduced by lscher @xcite seems ideally suited for the task at hand , for reasons explained below .",
    "re - expressing the poisson determinant in terms of an integral over a finite number @xmath1 of additional bosonic fields , we arrive at a local hamiltonian and a partition function that can be easily simulated by standard metropolis / heatbath techniques . in this approach ,",
    "an update of the system proceeds by successive , and independent , updates of ( a ) charged particle locations , ( b ) electric field values ( on the links of the lattice ) , and ( c ) all @xmath1 multiboson fields ( on the sites of the lattice ) .",
    "the algorithm studied in ref .",
    "@xcite does suffer however from a serious drawback .",
    "the multiboson fields are in general rather strongly coupled to the particle locations , so that a particle move leaving the boson fields unchanged becomes difficult when it induces a large corresponding change in the multiboson energy , without allowing the multiboson fields to relax in response to the new particle location .",
    "the problem becomes acute when the number @xmath1 of multiboson fields is increased : for example , to model more accurately the low momentum modes on a large lattice .",
    "one then finds an acceptance rate for particle moves that decreases exponentially with @xmath1 .",
    "the goal of the present paper is to show that a modified update procedure which couples particle moves and boson field updates greatly ameliorates this acceptance problem .",
    "efficient simulation with a large number of multiboson fields is necessary for performing realistic simulations on large lattices .    in section 2 ,",
    "we review the basic multiboson algorithm introduced in ref .",
    "@xcite , valid for systems with dynamically varying dielectric functions .",
    "the new coupled update method , allowing the multiboson fields to relax appropriately as the particles are moved , is explained in detail in section 3 .",
    "detailed numerical tests of the new method , with comparisons to the original , uncoupled approach , are presented in section 4",
    ". finally , we offer some concluding remarks in section 5 .",
    "in this section we review the multiboson reformulation of ref .",
    "@xcite for coulomb gas systems with varying dielectric .",
    "consider the partition function of a system consisting of @xmath2 free charges ( mobile or fixed ) @xmath3 at locations @xmath4 , corresponding to a free charge density @xmath5 where the system is also described by a linear dielectric function ( here assumed isotropic ) @xmath6 .",
    "we shall suppress the dependence of @xmath6 on particle locations , but the procedure we shall describe is precisely devised to properly account for this dependence in the electrostatic energetics of the problem . breaking the electric displacement into longitudinal and transverse parts using the general helmholtz decomposition , @xmath7 as the transverse and longitudinal components are orthogonal to each other , one has @xmath8 it follows that the imposition of maxwell s second law ( curl - free electric field ) implies that the electrostatic energy of the system is given purely in terms of the longitudinal part of the electric displacement @xmath9 accordingly , the canonical partition function for the system at inverse temperature @xmath10 becomes @xmath11 where @xmath12 must be determined by first solving @xmath13 , from which one obtains @xmath14 .",
    "note that the ( non - existent ) transverse part of the displacement field plays no role in this result .    in ref .",
    "@xcite we have shown how to write a representation for the above partition function by writing the coulomb energy boltzmann weight @xmath15 in terms of an integral over an unrestricted electric displacement field @xmath16 ( i.e. one containing both longitudinal and transverse parts ) , as well as over a set of multiboson fields with a local hamiltonian .",
    "the integration over the multiboson fields is arranged to generate a factor which exactly cancels the contribution from the integral over the spurious transverse part @xmath17 for arbitrary dielectric functions @xmath6 . although the factor itself is a determinant and highly non - local , the multiboson hamiltonian is local and therefore conventional monte carlo simulation techniques can be applied .",
    "first , we review some notational issues ( for further details , see @xcite ) . in order to write a well - defined functional integral for @xmath18 ,",
    "we consider a lattice coulomb gas with an electric displacement vector field @xmath19 defined on lattice links , where lattice sites are denoted @xmath20 and @xmath21 indicating the spatial direction of the link .",
    "dielectric values are associated with links on the lattice ( rather than sites ) so that the dielectric function on the lattice becomes @xmath22 . introducing left ( resp .",
    "right ) lattice derivatives @xmath23 ( resp .",
    "@xmath24 ) , the lattice version of eq .",
    "[ eq : helmdecomp1 ] becomes @xmath25 here the electrostatic potential is represented by a lattice site field @xmath26 satisfying the poisson equation @xmath27 it is then straightforward to show that the contribution to the functional integral @xmath28 from the integration over the unphysical transverse degrees of freedom @xmath29 yields the factor @xmath30 , where @xmath31 is essentially the lattice poisson operator : @xmath32 the unwanted determinant factor induced by the transverse integrations can be removed by introducing a set of additional fields with a local hamiltonian chosen to generate a _ positive _ square - root determinant canceling the unwanted contribution . as explained in @xcite , one begins from a uniform polynomial approximation to the function @xmath33 in the interval [ @xmath34 for small @xmath35 . in terms of the complex roots of the polynomial @xmath36 ,",
    "one may choose , for example ( the choice is not unique and partly a matter of convenience @xcite ) the chebyshev polynomial of order @xmath37 with @xmath38 this representation extends as follows to the determinant of a real positive symmetric operator with spectrum in the interval [ @xmath39 @xmath40 where the representation becomes exact in the limit @xmath41 .",
    "( in practice , the poisson operator needs to be rescaled , so that its spectrum fits in the unit interval . )",
    "the crucial step in the multiboson procedure is the replacement of the determinant factor in eq .",
    "[ eq : detpoly ] by an equivalent gaussian integral over a set of @xmath42 boson site fields @xmath43 .",
    "the choice of @xmath42 is dictated by the necessity to adequately describe the low eigenvalues of the poisson operator @xmath31 : in ref .",
    "@xcite , this was determined empirically by studying a model in which the structure factor of the system was analytically known in the charge - free limit .",
    "more generally , we expect that as the lowest eigenvalue of @xmath31 on a lattice of dimension @xmath44x@xmath44x@xmath44 is typically of order @xmath45 , the value of @xmath42 will have to increase as the lattice size does . however , the precise character of the scaling of @xmath42 with @xmath44 clearly depends on the sensitivity of the observables studied to the infrared spectrum of @xmath31 .    inserting a delta - function to enforce the lattice version of gauss law ( thereby fixing the longitudinal part of the electric displacement appropriately ) , the expression found for the correct partition function ( eq .  [ eq : partfunc ] )",
    "@xcite becomes    @xmath46    note that the effective hamiltonian appearing in the exponent here is completely local .",
    "monte carlo simulation of the system is in principle straightforward : a state of the system is characterized by ( i ) particle locations @xmath4 , which in general will influence the dielectric function @xmath6 ( which more accurately should be denoted @xmath47 ) , ( ii ) the lattice displacement field @xmath19 ( respecting locally the gauss law constraint ) , and ( iii ) the @xmath1 auxiliary scalar fields @xmath48 , and simulation requires updates of all of these variables with a procedure respecting detailed balance and according to the indicated boltzmann weight .",
    "in @xcite , the multiboson approach was tested on a system of particles ( both neutral and charged ) with a dielectric different from that of the ambient medium .",
    "this model , first studied in ref .",
    "@xcite , provides a clean testbed for algorithms dealing with the full electrostatic energetics of a system with a dynamical dielectric function .",
    "the latter changes through the simulation as the dielectric constant along a link in the @xmath49 direction from a lattice site @xmath20 is defined through the relation @xmath50 where @xmath51 and @xmath52 are either the background dielectric constant or the particle dielectric constant depending on whether there is a particle on site @xmath20 or site @xmath53 respectively .",
    "for example , in the simulations discussed below , the background dielectric constant is set to @xmath54 , while the dielectric constant associated with the particle is set to @xmath55 .",
    "if the particles are electrically neutral , then we expect the electric displacement to vanish _ irrespective _ of the particle locations , leading to a flat ( wave - number independent ) density - density structure factor .",
    "the simulations of eq .",
    "[ eq : mbosaction ] in ref .",
    "@xcite show that with a relatively small number of multiboson fields ( @xmath42=4 on a 16x16x16 lattice ) the neutral system yields a flat structure factor within statistical errors .",
    "for the rest of this paper , we shall use this model system to discuss issues of acceptance rates and simulation efficiency in the multiboson approach .    unfortunately , the simulation procedure of ref .",
    "@xcite , which we now review briefly , leads to an acceptance rate for particle moves that falls extremely rapidly as the number of multiboson fields is increased .",
    "for example , in our 16x16x16 test lattice the procedure of ref .",
    "@xcite gives a particle move acceptance rate of 0.011 when 8 multiboson fields are used , but the acceptance rate drops to less than 2e-7 when 32 multiboson fields are used . as we emphasized above , increasing @xmath42 will be necessary if we wish to go to much larger lattices , in order to apply the method to systems of real biophysical interest , for example .",
    "specifically , the monte carlo procedure of @xcite consisted of    1 .   a metropolis move of a particle ( randomly chosen ) to a neighboring site ,",
    "holding the electric displacement field @xmath19 and the multiboson fields @xmath56 fixed .",
    "2 .   a heat - bath ( or worm @xcite ) update of the electric displacement field @xmath19 , with particle locations and multiboson fields held fixed .",
    "3 .   a metropolis ( or heat - bath )",
    "update of the multiboson fields , with electric displacement field and particle locations held fixed .",
    "the acceptance problems of the method arise from the first step above : metropolis moves of the particles along lattice links . as the number of multiboson fields increases , the change in the contribution of the multiboson hamiltonian to the boltzmann weight increases ( roughly linearly in @xmath42 ) and the acceptance rate for moves decreases exponentially .",
    "the origin of the decrease is simply that the displacement of a particle to a neighboring site leaving the multiboson fields unchanged places the system on the tail of the old multiboson gaussian , with the multiboson gaussian corresponding to the new particle location having very little overlap with the old one .",
    "the heat - bath approaches used in the second and third steps above have of course no such acceptance problems .",
    "the displacement of the multiboson gaussian induced by a particle move holds the key to finding a more efficient move algorithm : one clearly needs to update the particle positions and multiboson fields _",
    "simultaneously_. we now show that the gaussian dependence of the hamiltonian on the multiboson fields allows us to do this with a heat - bath approach that yields greatly increased ( for larger values of @xmath1 , by several orders of magnitude ) acceptance rates for particle moves .",
    "let us denote the multiboson contribution to the boltzmann weight in eq.([eq : mbosaction ] ) by @xmath57 .",
    "now consider a particle move across a link connecting two nearest neighbor sites @xmath58 on the lattice ( i.e. we assume that initially there is a particle at one , but not both of these sites ) .",
    "the complete set of multiboson fields on the lattice can be grouped as @xmath59 , where the fields _ not _ on sites @xmath60 or @xmath61 are collectively labeled @xmath62 .",
    "the next step is to expose the dependence of the multiboson energy on just the fields at sites @xmath60 and @xmath61 : this will allow us to derive a heat - bath procedure for simultaneously moving the particle between @xmath60 and @xmath61 and updating all multiboson fields on these two sites , thereby  adapting \" the multiboson fields dynamically to the updated particle position . as the multiboson energy is a quadratic function of the multiboson fields , we must have @xmath63 here , the coefficients @xmath64 , as well as the residual term @xmath65 all depend on the fields @xmath62 _ not _ on the pair of sites @xmath58 , as well as the dielectric field @xmath66 , which of course depends on particle locations via eq.([eq : dieleq ] ) .",
    "it is straightforward to find explicit expressions for these coefficients in terms of @xmath66 and the @xmath62 fields .",
    "we shall use greek indices @xmath67 , running over six values , to denote positive and negative spatial directions out of a given lattice site , while unit vectors in the corresponding directions are denoted @xmath68 etc .",
    "now let us assume that site @xmath61 is the nearest neighbor of site @xmath60 in the @xmath69 direction .",
    "defining the site field @xmath70 one finds for the quadratic coefficients @xmath71 while for the coefficient linear in @xmath72 one has @xmath73 with a similar equation ( replacing @xmath60 by @xmath61 ) for the coefficient @xmath74 .    defining diagonal matrices @xmath75 , @xmath76 , and a @xmath77x@xmath77 matrix @xmath78 by + @xmath79 and a @xmath80 dimensional column vector containing the coefficients @xmath81 : @xmath82 + with a similar representation for the fields @xmath83 : @xmath84 the boltzmann weight for the fields @xmath83 may be written @xmath85 with @xmath86 as the multiboson fields for different index @xmath87 do not interact , the @xmath88x@xmath88 matrix algebra implicit in the above equations actually decouples into @xmath1 independent 2x2 problems .",
    "in particular , the total weight for the @xmath83 field pair , with a particle at either @xmath60 or @xmath61 , is found by integrating out these fields : @xmath89    with these preliminaries , we can now state the procedure needed to implement a coupled heat - bath particle move / multiboson field update .",
    "the first step is to determine a relative boltzmann weight for placing a particle either at site @xmath60 or site @xmath61 .",
    "this weight is determined as a product of three factors :    1 .   if the particle is charged , a contribution from the electric field term @xmath90 , where the prime indicates that only lattice links connected to site @xmath60 _ or _",
    "site @xmath61 are included . here",
    "the dependence on particle location is entirely through the change a particle move induces in the dielectric field .",
    "2 .   a contribution from the dielectric factor @xmath91 , with the same interpretation of the primed sum .",
    "a contribution from the multiboson energy @xmath92 arising from the total integrated weight @xmath93 of the @xmath83 fields computed in eq.([eq : intwgt ] ) , together with the portion of the multiboson energy depending on the neighboring multiboson fields @xmath62 ( which also depends on particle location only through the dielectric field ) .",
    "a decision on a final location for the particle ( either site @xmath60 or site @xmath61 ) is now made on the basis of the relative weight determined from the product of the three factors described above . once a particle location has been decided , a new set of multiboson fields on sites @xmath60 and",
    "@xmath61 are calculated by heat - bath by determining @xmath94 according to the gaussian boltzmann weight @xmath95 , and then setting @xmath96",
    "is plotted.,width=480 ]        we tested the efficiency of our improved simulation technique by simulating a system of 1000 neutral particles on a 16x16x16 lattice as studied in ref .",
    "@xcite . for the simulations of this paper",
    "we have chosen a dielectric constant ratio between the particles and the background medium to be 0.05 ( in typical molecular dynamics biophysical simulations , for example , the protein interior is given an effective dielectric constant of @xmath97 4 while the aqueous medium is @xmath97 80 ) .",
    "in particular , in the simulations the particles have a dielectric constant of 0.05 and the background dielectric constant is 1.0 .",
    "the dimensionless inverse temperature is 0.25 , as in the previous simulations of this system .",
    "the relevant physical quantity for systems of this type is the structure function defined as the fourier transform @xmath98 of the coordinate space density - density correlation function ( ref .",
    "as we work on a spatial lattice , the allowed momentum magnitude values @xmath99 are discrete : we have chosen to average the structure factor @xmath100 over degenerate values of the magnitude of the fourier momentum vector ( on a 16x16x16 lattice , there are 115 nonzero distinct allowed values ) .",
    "this data set is measured every 10 sweeps , and error bars extracted at the end of the runs by blocking the measurements in order to take autocorrelations into effect .",
    "this allows a measurement of a chi - squared goodness - of - fit of the final averaged data to the exact answer , which for neutral dielectric particles is simply a flat structure function @xmath101 where @xmath2 is the number of particles and @xmath102 the number of spatial points on the lattice .",
    "as emphasized in section 2 , the choice of the number @xmath1 of multiboson fields introduced to model the dielectric contribution to the partition function is dictated by the need to properly describe the low ( infrared ) part of the spectrum of the poisson operator @xmath103 , which contains eigenvalues of order @xmath104 on @xmath44x@xmath44x@xmath44 lattices .",
    "too small a choice for @xmath1 can be expected to lead to systematic deviations in the structure factor of eq .",
    "[ eq : exactstruc ] for small momenta @xmath105 . on the other hand ,",
    "too large a choice leads to rapidly falling acceptance rates for multiboson updates and is clearly more computationally costly per monte carlo update step . the systematic deviation in the structure factor resulting from too small a choice for @xmath1 is shown in fig .",
    "[ fig : structfact ] , where we compare the structure factors on a 16x16x16 lattice for @xmath1064,8,16 .",
    "it is clear that for this problem , 4 multiboson fields are inadequate , giving a distinct curvature to the structure factor , and a large chi - squared per degree of freedom of 36.4 , whereas the chi - squared per d.o.f . for the simulation with 16 multiboson fields",
    "is only 1.94 .",
    "depending on the physical parameter regime , and the size of lattice used , it will evidently be necessary to increase @xmath1 to achieve adequate accuracy , at least for long - range features of the physics .",
    "unfortunately , the update procedure introduced in ref .",
    "@xcite suffers from the drawback that , for fixed physical parameters ( lattice size , dielectric constant , etc ) , the acceptance rates for multiboson updates decreases exponentially rapidly with @xmath1 .",
    "this makes the uncoupled multiboson method impractical for much larger lattices than those studied in our previous work . in fig .",
    "[ fig : accrates ] we compare the acceptance rates using the original update procedure , in which particle moves were decoupled from updates of the multiboson fields , with the acceptance rates using the new procedure described in section 3 , in which particle moves are coupled to readjustments in the multiboson field . for larger values of @xmath1",
    "it is clear that the acceptance rates are increased by orders of magnitude ( e.g. by about @xmath107 for @xmath1=32 ) .",
    "although the new , coupled procedure is more computationally intensive , it does not require significantly more computational time per monte carlo sweep .",
    "we observe that for a run with the parameters described above with 16 bosons , the computational time per monte carlo sweep using the coupled update method is only about 13% greater than in the original uncoupled algorithm .",
    "this additional computational cost is insignificant given the great increase in particle move acceptances that the coupled method provides .",
    "by using an update method where the proposed particle moves include a relaxation of the multiboson field to adjust to the change in particle location we have been able to dramatically increase the acceptance rates for larger systems that require a larger number @xmath1 of multiboson fields to accurately model the long wavelength physics of the system . for both the original uncoupled and the improved coupled update algorithms , and for the physical parameters used here , the dependence of the acceptance rate on @xmath1 is exponential ( @xmath108 ) .",
    "the coefficient in the exponent , @xmath109 , is @xmath110 for the coupled algorithm and @xmath111 for the original method , amounting to a difference in acceptance rates of 4 orders of magnitude for a simulation with 32 multiboson fields .",
    "tests done with charged particles show similar improvements to the acceptance rates , although for some parameter regions the electric field must also be coupled into the particle moves to obtain reasonable acceptance rates @xcite .      99 a. duncan , r.d .",
    "sedgewick and r.d .",
    "coalson , phys .",
    "e * 73 * , 016705 ( 2006 ) a.c .",
    "maggs and v.  rossetto , phys .",
    "88 * , 196402 ( 2002 ) a.c .",
    "maggs , j.  chem .",
    "phys .  * 120 * , 3108 ( 2004 ) l.  levrel , f.  alet , j.  rottler , and a.c .",
    "maggs , pramana * 64 * , 1001 ( 2005 ) l.  levrel and a.c .",
    "maggs , ` cond - mat/0503744 ` ( 2005 ) a.  duncan , r.d .",
    "sedgewick , and r.d .",
    "coalson , ` cond - mat/0508266 ` ( to be published in comp .",
    "a.  duncan , r.d .",
    "sedgewick , and r.d .",
    "coalson , phys .",
    "e * 71 * , 046702 ( 2005 ) m. lscher , nucl .",
    "b * 418 * , 637 ( 1994 ) f.  alet and e.  srensen , phys .",
    "e * 67 * , 015701 ( 2003 )"
  ],
  "abstract_text": [
    "<S> a recent reformulation @xcite of the problem of coulomb gases in the presence of a dynamical dielectric medium showed that finite temperature simulations of such systems can be accomplished on the basis of completely local hamiltonians on a spatial lattice by including additional bosonic fields . for large systems , the monte carlo algorithm proposed in ref .  </S>",
    "<S> @xcite becomes inefficient due to a low acceptance rate for particle moves in a fixed background multiboson field . </S>",
    "<S> we show here how this problem can be circumvented by use of a coupled particle - multiboson update procedure that improves acceptance rates on large lattices by orders of magnitude . </S>",
    "<S> the method is tested on a one - component plasma with neutral dielectric particles for a variety of system sizes . </S>"
  ]
}