{
  "article_text": [
    "many modern measuring devices use cmos or ccd solid - state photosensors to convert light into a digital signal . due to imperfections of photosensors such",
    "a conversion is not ideal and leads to noise in the measured signal .",
    "therefore , one can either estimate and reduce the impact of noise from the sensor , or simulate and predict the impact of noise on the images quality .",
    "the problem of noise estimation has been addressed by the emva1288 standard  @xcite .",
    "the high - level simulation of noise in photosensors , however , is still an area of active research .",
    "the main problem is that photosensors are affected by many different sources of noise , some of which can not be modelled adequately using only gaussian noise .",
    "[ review:2r2]different numerical models of cmos  @xcite and ccd  @xcite sensors are reported in the literature .",
    "the photosensor models differ by the generality and the scope of the noise sources being included .",
    "high - level simulators  @xcite are used for the evaluation of how different noise sources influence image quality  @xcite , while low - level simulator models specific aspects of the solid - sate physics of a sensor  @xcite . the thoroughness of noise modelling differs as well ;",
    "for example , in some models of the photosensor , the dark current shot noise is described by its mean value  @xcite , while other models use more sophisticated statistical description of noise  @xcite .",
    "[ review2jei : r1q1 - 2 ] sophisticated software integrated suits such as the image systems evaluation toolkit  @xcite ( iset ) were developed recently .    [ [ review:1r2 ] ] models of cmos photosensors : + + + + + + + + + + + + + + + + + + + + + + + + + + + +    both high - level  @xcite and low - level  @xcite numerical models of cmos photosensors are reported in the literature .",
    "low - level simulators like medici  @xcite , which are able to model the 2-d distributions of potential and carrier concentrations , are used for simulation of solid - state physics in cmos photosensors  @xcite .",
    "some of the papers deal with the numerical modelling of colour images that allow end users to see the effects of the noise on the images  @xcite .",
    "other papers focus on the specific types of noise ; for example , the analysis of temporal noise in cmos active pixels sensors can be found in  @xcite , an autoregressive model of fixed - pattern noise ( fpn ) was presented in  @xcite along with other fpn models  @xcite .",
    "high - level models ( e.g. ,  @xcite ) often assume that the adc , sense node and source follower are completely linear , which , as we will show in this paper , is not always the case .",
    "[ [ models - of - ccd - photosensors ] ] models of ccd photosensors : + + + + + + + + + + + + + + + + + + + + + + + + + + +    the models of ccd photosensors  @xcite and their noise parameters estimation  @xcite are generally simpler than models of cmos sensors . the model by flory  @xcite describes the noise of the sensor electronics as a combination of shot noise and amplifiers noise .",
    "the ccd camera noise model by cox  @xcite includes photon and electronic shot noise , dark - current noise and readout noise ; however the model suggests that noise is stationary .",
    "healey and kondepudy  @xcite model camera noise with offset fixed - pattern noise ( fpn ) , photon and dark - current shot noise , read noise and photo response non - uniformity ( prnu ) .",
    "[ review2jei : r2_q2]an adequate model was proposed by costantini and ssstrunk  @xcite , where noises was categorised in four main types : photon shot noise , photo response non uniformity , dark current shot noise and read noise .",
    "[ [ review:18r2 ] ] the purpose of the article : + + + + + + + + + + + + + + + + + + + + + + + + + + +    this article provides a literature review of the noise models that are used in the simulations of ccd and cmos photosensors and give a working numerical model of a photosensor .",
    "the aim of this article is to summarise the advances in numerical simulations of photosensors and provide a matlab implementation of a ccd / cmos sensor model , which has been demonstrated to adequately describe noise properties of a hardware cmos photosensor .",
    "the experimental results for a hardware 5 t cmos photosensor are provided in the article as validation for the developed numerical simulator .",
    "the article addresses the issue of the lack of high - level models of photosensors .",
    "it is shown that the dark noise may have more complicated structure than is typically assumed and therefore requires a more sophisticated statistical description .",
    "the formulated high - level model of a photosensor allows the simulation of realistic noise effects on the images and can be useful for testing of image processing algorithms .",
    "[ [ software - implementation ] ] software implementation : + + + + + + + + + + + + + + + + + + + + + + + +    the matlab - based software implementation of the high - level ccd / cmos photosensor model described in this article is freely available on the website ` https://code.google.com/p/highlevelsensorsim/ ` and also on email request .",
    "the software simulator written as a series of functions that call the corresponding sub - functions sequentially to add the noise with specified parameters .",
    "two example test files are supplied that run : ( 1 ) a * simple * sensor model , which is completely linear and where all noise are gaussian , and ( 2 ) an * advanced * model , which has v / v and v / e non - linearities , lognormal noise models and other specific noises .",
    "both test files use the same code : adjusting the parameters in the test file , a user can turn the noise sources on or off and trigger non - linearities .",
    "the matlab code has a thorough documentation , both as comments inside the m - files and rendered for web view  @xcite in a browser ( see _ /help _ directory and _ index.html _ file inside ) .",
    "introduction _ _    noise sources in solid - state photosensors : _ _    from photon to charge : _ _    _ photon shot noise and prnu _    _ dark signal , dark current fpn and dark current shot noise _    _ source follower noise ( johnson noise , flicker ( 1/f ) noise , and random telegraph noise ) _    from charge to voltage : _ _    _ sense node reset noise ( ktc noise ) _",
    "_ offset fpn _",
    "_ gain non - linearities ( v/@xmath0 gain and v / v gain non - linearity ) _    _ correlated double sampling _    from voltage to digital numbers _ ( including differential and integral linearity errors ) _    simulation methodology _ _    model : from photon to charge : _",
    "_    _ simulating photon shot noise and prnu _",
    "_ converting photons to electrons _    _ simulating dark signal , dark current fpn and dark current shot noise _    _ simulating source follower noise _    model : from charge to voltage : _",
    "_    _ simulating sense node reset noise ( ktc noise ) and offset fpn _    _ converting electrons to voltage _    _ simulating v/@xmath0 and v / v gain non - linearity _    model : from voltage to digital numbers _ _    _ simulating adc non - linearity _    _ simulating quantisation noise _    experimental validation of the photosensor model _ _    radiometric function _ _    photon transfer curve _ _",
    "signal - to - noise ratio _ _    photo response non - uniformity _ _    noise spectrogram _ _    dark signal performance for different integration times : _ _    _ short integration time _    _ long integration time _",
    "conclusion _ _",
    "many noise sources contribute to the resulting noise image that is produced by photosensors .",
    "noise sources can be broadly classified as either * fixed - pattern * ( time - invariant ) or * temporal * ( time - variant ) noise .",
    "fixed - pattern noise refers to any spatial pattern that does not change significantly from frame to frame .",
    "temporal noise , on the other hand , changes from one frame to the next .",
    "these noise sources will be described in detail in the following subsections .",
    "[ review2jei : r2_q3 ]      the ability of a semiconductor to produce electrons from incident photons is referred to as _ quantum efficiency _",
    "[ review:5r2][review:29r1 ] quantum efficiency can be supplied by the sensor manufacturer in the form of spectral responsivity as a function of wavelength , or measured empirically .",
    "[ review2jei : r2q9 - 1]for the sake of simplicty , we assume that the light is monochromatic , and therefore we need the spectral response of the sensor at one wavelength .",
    "the charge collected in each pixel of a sensor array is converted to voltage by a _ sense capacitor _ and a _ source - follower amplifier_. the sense node is shared for all pixels in the case of a ccd . in cmos sensors , the sense node is located inside each pixel .",
    "the process of photon capturing has an uncertainty that arises from random fluctuations when photons are collected by the photodiode .",
    "such uncertainty leads to _ photon shot noise _ and is described by the poisson process . in the case of a high level of light ( more than 1000 arrival events  @xcite of photons ) ,",
    "the poisson distribution may be approximated by a gaussian distribution .",
    "however , this is not justified for low - light conditions .",
    "the method of the approximation of the poisson distribution by gaussian is discussed in detail in  @xcite .",
    "[ review:12r1]the photo response non - uniformity ( prnu ) is the spatial variation in pixel output under uniform illumination mainly due to variations in the surface area of the photodiodes .",
    "this occurs due to variations in substrate material during the fabrication of the sensor  @xcite .",
    "the prnu is signal - dependent ( proportional to the input signal ) and is fixed - pattern ( time - invariant ) .",
    "[ review:30r1 ] the prnu factor is typically @xmath1 for a given sensor  @xcite , but varies from one sensor to another .",
    "it is noteworthy that the prnu pattern can be used as a unique identification fingerprint for digital cameras  @xcite .",
    "[ review:13r1 ] read noise is defined as any noise that is not a function of the signal  @xcite ; it is a combination of the remaining noise generated between the photodiode and the output of the adc circuitry .",
    "the read noise consists of : _ dark current shot noise _ ( sec .",
    "[ subsec : dshot ] ) , _ dark current fixed pattern noise _ ( sec .",
    "[ subsec : dfpn ] ) , _ sense node reset noise _",
    "[ sec : subsection : snresetnoise ] ) , _ source follower noise _",
    "[ sec : sfnoise ] ) , _ adc quantisation noise _ ( sec .",
    "[ subsec : adcnoise ] ) .",
    "dark current is the thermally generated electrons  @xcite discharging the pixel just as if a photon had hit the pixel .",
    "the dark current generally arises from surface defects in the @xmath2 interface  @xcite , surface generation  @xcite , thermal generation  @xcite , and imperfections of the semiconductor manufacturing process  @xcite .",
    "the average dark current @xmath3 [ e@xmath4/sec / pixel ] can be characterised by  @xcite:[review:16r1 ] @xmath5 where @xmath6 is the pixel area [ @xmath7 , @xmath8 [ na/@xmath7 is the dark current [ review:7r2]figure - of - merit can be estimated from the measurements to ensure that the number that manufacturers publish is consistent with the sensor performance . using photon transfer methodology  @xcite , one can estimate the dark current fpn factor @xmath9 and the dark current figure - of - merit @xmath8 .",
    "this can be done by plotting dark current shot noise and dark current fpn versus a dark signal .",
    "this is called `` dark transfer curve '' , out of which those parameters can be deduced .",
    "the procedure is described on page 170 - 171 in  @xcite . ]",
    "( varies with the sensor and usually reported by the manufacturer ) at 300k , @xmath10 [ ev ] is the band gap energy of the semiconductor which also varies with temperature , @xmath11 is the temperature in k , and @xmath12 is boltzman s constant .",
    "[ review:37r1]it was reported  @xcite that for a ccd photosensor operated in multipinned phase ( mpp ) mode , the average dark current @xmath13 can be described as : @xmath14 where the first term is more important as the temperature increases , whereas the second term dominates at lower temperatures .",
    "temperature dependence of the dark current is explained in details in  @xcite .",
    "the relationship between band gap energy and temperature can be described by varshni s empirical expression  @xcite : @xmath15 where @xmath16 , @xmath17 and @xmath18 are material constants . for silicon",
    "@xmath19 $ ] , @xmath20 [ ev / k ] , and @xmath21 [ k ] .",
    "the dark signal varies from pixel to pixel , it is linear with respect to integration time , and doubles with every @xmath22 increase of temperature  @xcite .",
    "when the exposure begins , a dark current is generated even if there is no light .",
    "the longer the exposure time @xmath23 , the more dark signal @xmath24 ( number of electrons per pixel ) will be generated : @xmath25 [ review:13 - 2r1]where @xmath3 is the average dark current from eq .  [",
    "eq : darkcurrentrate ] . in simulation",
    "we use eq .",
    "[ eq : darkcurrent ] to calculate the dark signal per pixel .",
    "but the dark signal @xmath24 is a subject of the _ dark current shot noise _ due to random generation of the electrons .",
    "[ review:37 - 1r1 ] an additional noise results from the dark signal due to the electrons being generated randomly by the photosensor .",
    "such noise is called dark current shot noise  @xcite and is described by the poisson distribution as the random arrival of electrons  @xcite as : @xmath26 where @xmath3 is the average dark current [ @xmath0/sec / pixel ] as described by eq .",
    "[ eq : darkcurrentrate ] . in a real sensor ,",
    "the pixels differ slightly from one to another [ review2jei : r2q5 ] resulting in another source of noise called _ dark current fixed pattern noise_.      [ review:33r1]pixels in a hardware photosensor can not be manufactured exactly the same from perfectly pure materials .",
    "there will always be variations in the photo detector area that are spatially uncorrelated  @xcite , surface defects at the @xmath2 interface  @xcite , and discrete randomly - distributed charge generation centres  @xcite .",
    "these defects provide a mechanism for thermally - excited carriers to move between the valence and conduction bands  @xcite .",
    "consequently , the average dark signal is not uniform but has a spatially - random and fixed - pattern noise ( fpn ) structure .",
    "the dark current fpn can be expressed  @xcite as follows:[review:32r1 ] @xmath27 where @xmath23 is the integration time , @xmath3 is the average dark current described in eq.[eq : darkcurrentrate ] , and @xmath9 is the dark current fpn factor that is typically @xmath28 for ccd and cmos sensors .",
    "there are also so called `` outliers '' or `` dark spikes ''  @xcite ; that is , some pixels generate a dark signal values much higher than the mean value of the dark signal .",
    "the mechanism of such `` dark spikes '' or `` outliers '' can be described by the poole - frenkel effect  @xcite ( increase in emission rate from a defect in the presence of an electric field ) .",
    "[ review:4r1]in high - end ccd and cmos sensors the source follower noise has been decreased to a value of one electron rms  @xcite",
    ". however , source follower noise for industry - grade sensors can be significant and therefore should be included in a photosensor model .",
    "the source follower noise consists of white noise , flicker noise ( 1/f noise ) , and random telegraph noise ( rtn ) .",
    "[ [ johnson - noise - white - noise ] ] johnson noise ( white noise ) + + + + + + + + + + + + + + + + + + + + + + + + + + +    similar to the sense node , the source follower amplifier has a resistance that generates thermal noise .",
    "such noise is governed by the johnson white noise equation  @xcite .",
    "the noise is commonly referred to as johnson noise , johnson - nyquist or simply as a white noise  @xcite .    [",
    "[ flicker-1f - noise ] ] flicker ( 1/f ) noise + + + + + + + + + + + + + + + + + + +    the flicker noise , also referred to as 1/f noise , is generally due to imperfect contacts between two materials at the junction  @xcite , including metal - to - metal , metal - to - semiconductor and semiconductor - to - semiconductor .",
    "since mosfets are used inside each pixel , cmos image sensors exhibit higher 1/f noise than ccd sensors .",
    "more details and discussions about 1/f noise can be found in  @xcite .",
    "[ [ random - telegraph - noise ] ] random telegraph noise + + + + + + + + + + + + + + + + + + + + + +    as the ccd and cmos pixels are shrinking  @xcite in dimension , the low - frequency noise is subsequently increasing  @xcite .",
    "the origin of rtn is attributed to the random trapping and emission of mobile charge carriers resulting in discrete modulation of the channel current , which can be modelled  @xcite as a random telegraph signal",
    ". however , the modelling and explanation of both flicker noise and rtn are still subjects of active research  @xcite .",
    "it was shown  @xcite that voltage fluctuations , which exhibit a @xmath29 power spectrum , can be described by the fisher - tippet - gumbel distribution .",
    "further details about rtn noise in photosensors can be found in  @xcite .",
    "the conversion from charge to voltage is not perfect in the real photosensor : sense node reset noise , source follower noise , and offset fixed pattern noise add an uncertainty to the measured signal  @xcite .",
    "these noise sources are described in this subsection .",
    "prior to the measurement of each pixel s charge packet , the sense node capacitor is reset to a reference voltage level  @xcite .",
    "noise is generated at the sense node by an uncertainty in the reference voltage level due to thermal variations in the channel resistance of the mosfet reset transistor .",
    "the reference level of the sense capacitor is therefore different from pixel to pixel  @xcite .",
    "it was reported  @xcite that the reset noise can be a significant contributor to dark noise .",
    "the reset noise voltage is given by : @xmath30 where @xmath31 is boltzmann s constant , @xmath32 is the sense node capacitance [ f ] , and @xmath11 is the temperature [ k ] .    because reset noise can be significant  @xcite ( about 50 rms electrons ) , most high - performance photosensors incorporate a noise - reduction mechanism such as correlated double sampling ( cds ; see subsection [ subsec : cdsdescription ] and subsection [ subsec : cdssimulation ] ) .    [ [ sense - node - reset - noise - for - ccd - and - cmos - sensors ] ] sense node reset noise for ccd and cmos sensors : + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    for ccd sensors , the sense node reset noise is removed by cds  @xcite . in cmos photosensors , it is difficult to remove the reset noise given the specific cmos pixel architectures , even after application of cds .",
    "the cds suppresses the low frequency noise components , although it increases the thermal noise contributions  @xcite .",
    "pixels in the same column of the photosensor share a column amplifier .",
    "[ review:36 - 1r1]differences in the gain and offset of these column amplifiers contribute to a column - wise offset fixed pattern noise .",
    "the offset fixed pattern noise ( offset fpn ) is caused by an offset in the integrating amplifier , size variations in the integrating capacitor , and as variation of bias / offset voltages  @xcite .",
    "[ review:6r2 ] specifically , cmos offset fpn is due to threshold voltages differences in the pixel source follower amplifier  @xcite .",
    "offset fpn arises from the fact that pixels in the same column of a cmos sensor share the same column amplifier .",
    "the difference in gain and the offsets of such an amplifier is a source of column - to - column offset fpn  @xcite .",
    "this type of noise appears as `` stripes '' in the image and can result in significant image quality degradation .",
    "modelling of the offset fpn is discussed in subsection  [ sec : subses : elgamalfpn ] .",
    "both ccd and cmos sensors may exhibit v / v ( voltage - voltage conversion ) [ review:8r2 ] and v/@xmath0 ( voltage - electrons conversion ) non - linearity .",
    "the v / v non - linearities is mainly  @xcite due to the source follower amplifier .",
    "the v/@xmath0 non - linearity is due to the sense node capacitance @xmath32 .",
    "the v/@xmath0 non - linearity is a problem mostly for cmos sensors , whereas for ccd sensors the v/@xmath0 non - linearity is usually negligible .",
    "the v/@xmath0 non - linearity affects both fpn and shot noise .",
    "it can also be thought of as a sense node capacitor non - linearity .",
    "when a small signal is measured , the sense node capacitance @xmath32 may change negligibly . for a large signal ,",
    "a change of @xmath32 affects the signal being measured .",
    "the v/@xmath0 non - linearity can be expressed as  @xcite:[review:17r1 ] @xmath33,\\ ] ] where @xmath34 is the total signal in electrons , the constant @xmath35 is @xmath36 , @xmath37 is the reference voltage to which the sense node is reset .",
    "the v / v non - linearity is caused by the non - linear response of source follower amplifier  @xcite . in our simulations",
    ", we implemented the linear change of source follower gain @xmath38 similar to the model in  @xcite .",
    "the v / v gain non - linearity is described as : @xmath39 [ review:17 - 1r1]where @xmath40 is the voltage that corresponds to the signal collected by the sense node , @xmath41 is the voltage that corresponds to the full - well signal , and @xmath42 is used to control the amount of non - linearity in the source follower gain @xmath38 .",
    "the parameter of non - linearity @xmath42 can be taken from the specifications of a photosensor .",
    "the new source follower gain @xmath43 from eq .",
    "[ eq : sfnewgain ] is then used for the conversion in eq .",
    "[ eq : conversiontosourcefollower ] in subsection  [ sec : simulationsourcefollower ] to simulate the v / v non - linearity .",
    "[ review:3r1]fixed pattern noise performance of cmos sensors is usually lower than for ccd sensors  @xcite .",
    "for this reason cmos sensors use noise reduction circuits such as correlated double sampling ( cds ) .",
    "the cds circuits are located per column and usually consist of two sample - and - hold ( s&h ) circuits  @xcite . during the pixel read - out cycle ,",
    "two samples are taken : the first when the pixel is in the reset state and the second when the charge has been transferred to the read - out node .    during the reset stage ,",
    "the photodiode capacitance is charged to a reset voltage .",
    "the reset voltage is read by the first sample - and - hold ( s&h ) in a correlated double sampling ( cds ) circuit  @xcite .",
    "then the exposure begins : the photodiode capacitor is discharged during an exposure ( integration ) time at a rate proportional to the incident illumination .",
    "this voltage is then read by the second sample - and - hold of the cds .",
    "the cds circuit subtracts the signal pixel value from the reset value .",
    "the main purpose of cds is to eliminate fixed pattern noise caused by random variations in the threshold voltage of the reset and pixel amplifier transistors .",
    "many variants of cds were proposed and implemented  @xcite .",
    "many sensors use correlated double sampling to eliminate column patters and pixels patterns .",
    "pixel noise reduced by the cds is known as `` crowbar '' that significantly reduces the effect of the reset column noise  @xcite .",
    "[ review:34r1]an analogue - to - digital converter ( adc ) transforms a voltage signal into discrete codes .",
    "an @xmath44-bit adc has @xmath45 possible output codes with the difference between code being @xmath46 .",
    "the resolution of the adc indicates the number of discrete values that can be produced over the range of analogue values and can be expressed as : @xmath47 where @xmath48 is the maximum voltage that can be quantified , @xmath49 is minimum quantifiable voltage , and @xmath50 is the number of voltage intervals .",
    "therefore , the output of an adc can be represented as : @xmath51 the lower the reference voltage @xmath52 , the smaller the range of the voltages one can measure .      in terms of the adc , the following non - linearity and noise",
    "should be considered for the simulations of the photosensors : integral linearity error , differential linearity error , quantisation error , and adc offset .",
    "[ [ differential - linearity - error ] ] differential linearity error + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    ( dle ) indicates the deviation from the ideal 1 lsb ( least significant bit ) step size of the analogue input signal corresponding to a code - to - code increment  @xcite .",
    "assume that the voltage that corresponds to a step of 1 lsb is @xmath53 .",
    "in the ideal case , a change in the input voltage of @xmath53 causes a change in the digital code of 1 lsb .",
    "if an input voltage that is more than @xmath53 is required to change a digital code by 1 lsb , then the adc has _",
    "dle error_[review:35r1 ] . in this case , the digital output remains constant when the input voltage changes from , for example , @xmath54 to @xmath55 , therefore corresponding the digital code can never appear at the output .",
    "that is , that code _ is missing_.    [ [ integral - linearity - error ] ] integral linearity error + + + + + + + + + + + + + + + + + + + + + + + +    ( ile ) is the maximum deviation of the input / output characteristic from a straight line passed through its end points  @xcite . for each voltage in the adc input ,",
    "there is a corresponding code at the adc output .",
    "if an adc transfer function is ideal , the steps are perfectly superimposed on a line .",
    "however , most real adc s exhibit deviation from the straight line , which can be expressed in percentage of the reference voltage or in lsbs .",
    "therefore , ile is a measure of the straightness of the transfer function and can be greater than the differential non - linearity .",
    "taking the ile into account is important because it can not be calibrated out .",
    "[ [ quantisation - errors ] ] quantisation errors + + + + + + + + + + + + + + + + + + +    are caused by the rounding , since an adc has a finite precision . the probability distribution of quantisation noise is generally assumed to be uniform .",
    "hence we use the uniform distribution to model the rounding errors ( see subsection  [ subsec : adcnoise ] ) .    [",
    "[ adc - offset - error ] ] adc offset error + + + + + + + + + + + + + + + +    may occur due to the dc offset associated with the analogue inputs to the adc .",
    "the magnitude of the adc offset depends on the gain and input range selection .",
    "the photosensor model was implemented in matlab as a set of functions that generate noise according to the models discussed above .",
    "the functions sequentially transform the input to number of photons , to number of electrons , to voltages , and finally to a digital signal , as shown in fig .",
    "[ fig : camerascheme ] .",
    "one can simulate either ccd or cmos photosensors by turning the models of noise on and off .",
    "the simulation software contains routines for the simulation of the sensor and also scripts for the estimation of the noise characteristics .",
    "[ review:11-diagramr1 ]    [ review:21 - 8r1 ] the numerical model of the photosensor simulates the temporal and fixed - pattern characteristics of noise sources accordingly .",
    "the matrices for the fixed - pattern ( time - invariant ) noise are calculated once and then saved to a file .",
    "those matrices will be loaded again to calculate the fixed pattern noise ; therefore , the noise will always remain the same reflecting the fixed pattern nature of the noise . on the other hand ,",
    "the matrices for the temporal ( time - variant ) noise are recalculated each time the simulation begins .",
    "[ review:5r1 ] the input to the model of the photosensor is assumed to be a matrix @xmath56 that corresponds to the opical field .",
    "for the estimation purpose , the input can be a uniform light field ( i.e. , uniform image ) or [ review:5 - 1r1 ] gradient image ( i.e. , linear transition from no light to saturation level ) .",
    "[ review2jei : r1_q3 ] then the sensor s irradiance @xmath57 , which is in units of [ w / m@xmath58 , converted to the average number of photons @xmath59 collected by each pixel during the integration ( exposure ) time : @xmath60 where @xmath6 is the area of a pixel [ m@xmath58 , @xmath61 is integration ( exposure ) time , @xmath62 is the energy of a single photon at wavelength @xmath63 , @xmath64 is planck s constant and @xmath65 is the speed of light .",
    "therefore , each @xmath66-th element of the [ review:21 - 1r1 ] matrix @xmath59 contains the number of photons that have been collected by the @xmath66-th pixel of the `` software '' photosensor during the integration time @xmath61 .",
    "the photon shot noise is due to the random arrival of photons and can be described by a poisson process as discussed in subsection  [ sec : photonshot ] .",
    "[ review:20r1]therefore , for each @xmath66-th element of the matrix @xmath59 that contains the number of collected photons , a photon shot noise is simulated as a poisson process @xmath67 with mean @xmath68 : @xmath69 in matlab , we use the ` poissrnd ` function that generates poisson random numbers with mean @xmath68 .",
    "[ review:23r1 ] that is , the number of collected photons in [ review:21r1 ] @xmath66-th pixel of the simulated photosensor in the matrix @xmath59 is used as the mean @xmath68 for the generation of poisson random numbers to simulate the photon shot noise .",
    "the input of the ` poissrnd ` function will be the matrix @xmath59 that contains the number of collected photons .",
    "the output will be the matrix @xmath70 , i.e. , the signal with added photon shot noise .",
    "[ review:21 - 7r1 ] the matrix @xmath71 is recalculated each time the simulations are started , which corresponds to the temporal nature of the photon shot noise .",
    "[ review:9r2 ] the matrix that contains the number of collected photons during the exposure time , including the photon shot noise @xmath59 , is converted to the matrix @xmath72 proportional to electrons for each @xmath66-th pixel as follows : [ review:19r1]@xmath73 where @xmath74 is the quantum efficiency [ e@xmath4/incident photons ] for the given wavelength .",
    "the quantum efficiency for a photosensor is a function of wavelength and is usually provided by the manufacturer .",
    "the photo response non - uniformity ( prnu ) is considered in our numerical model as a temporally - fixed light signal non - uniformity . according to our experimental results ( see subsection  [ subsec : prnudiscussion ] )",
    ", the prnu can be modelled using a gaussian distribution for each @xmath66-th pixel of the matrix @xmath75:[review:11r1][review:12 - 1r1 ] @xmath76 [ review:6r1]where @xmath77 is the prnu factor value .",
    "since the prnu does not change from one frame to the next , the matrix @xmath78 is calculated once and then saved to a file .",
    "[ review:21 - 4r1 ] in the simulations , the matrix @xmath78 can be loaded again to calculate the photo response non - uniformity . therefore , since the same matrix is used for all simulations of the photo response non - uniformity , it will always remain the same as it should be .",
    "the dark signal is calculated using eq .",
    "[ eq : darkcurrentrate ] for all pixels in the model .",
    "it is implemented using ` ones ` function in matlab as a matrix of the same size as the simulated photosensor . for each @xmath66-th pixel",
    "we have : @xmath79 where @xmath3 is the average dark current from eq .",
    "[ eq : darkcurrentrate ] , repeated here for convenience : @xmath80    in this article we conduct all measurements at the room temperature @xmath81 c. the matrix @xmath82 represents a constant value of dark signal generated during the integration time @xmath23 . however , since the electrons are generated randomly , the dark signal is a subject of a _ dark current shot noise_.      [ review:22 - 1r1]similar to the photon shot noise , the _ dark current shot noise _ is due to the random arrival of the generated electrons and therefore described by a poisson process .",
    "the dark current shot noise can be simulated as a poisson process @xmath67 with mean @xmath68 as follows:[review:11 - 1r1 ] @xmath83 we use the ` poissrnd ` function that generates poisson random numbers with mean @xmath68 for each @xmath66-th element of the matrix @xmath82 from eq .",
    "[ eq : darkcurrentsignalsimulation ] that contains dark signal in electrons .",
    "the input of the ` poissrnd ` function will be the matrix @xmath82 that contains the number of electrons , and the output will be the matrix @xmath84 with added dark current shot noise .",
    "[ review:21 - 6r1 ] the matrix @xmath84 that corresponds to the dark current shot noise is recalculated each time the simulations are started , which corresponds to the temporal nature of the dark current shot noise .      following the discussion in subsection  [ subsec : dfpn ] , the dark current fixed pattern noise ( fpn ) is simulated using non - symmetric distributions to account for the `` outliers '' or `` hot pixels '' .",
    "it is usually assumed that the dark current fpn can be described by gaussian distribution .",
    "however , such an assumption provides a poor approximation of a complicated noise picture .",
    "this is shown in the experimental results in subsection  [ subsec : darkfpnperf ] .",
    "[ review:31 - 6r1]studies show  @xcite that a more adequate model of dark current fpn is to use non - symmetric probability distributions .",
    "the concept is to use two distributions to describe very `` leaky '' pixels that exhibit higher noise level than others .",
    "the first distribution is used for the main body of the dark current fpn , with a uniform distribution superimposed to model `` leaky '' pixels . for simulations at room - temperature ( @xmath85 c ) authors in",
    "@xcite use a _ logistic distribution _",
    ", where a higher proportion of the population is distributed in the tails  @xcite . for higher temperatures , inverse gaussian  @xcite and log - normal  @xcite distributions have been proposed .",
    "it was reported  @xcite that the log - normal distribution works well for conventional 3 t aps cmos sensors with comparatively high dark current .    in our simulations we use the log - normal distribution for the simulation of dark current fpn in the case of short integration times , and superimposing other distributions for long integration times .",
    "the actual simulation code implements various models , including log - normal , gaussian , and wald distribution to elumate the dark current fpn noise for short- and long - term integration times .",
    "the dark current fpn for each pixel of the matrix @xmath84 from eq .",
    "[ eq : dshotnoisesimulation ] is computed as follows[review:31 - 5r1 ] : @xmath86 where @xmath87 is from eq .",
    "[ eq : darkcurrentfpn ] , @xmath3 is the average dark current , and @xmath9 is the dark current fpn factor .",
    "since the dark current fpn does not change from one frame to the next , the matrix @xmath88 is calculated once and then can be re - used similar to the prnu simulations in subsection  [ subsec : prnusimulation ] .",
    "the experimental results provided in subsection  [ subsec : darkfpnperf ] confirm that non - symmetric models , and in particular the log - normal distribution , adequately describe the dark current fpn in cmos sensors , especially in the case of a long integration time ( longer than 30 - 60 seconds ) .",
    "our results are consistent with  @xcite ; however , as we show in subsection  [ subsec : verylongfpn ] , using only one distribution can not adequately describe the dark current fpn statistics . for long - exposure case , one needs to superimpose two ( or more , depending on the sensor ) probability distributions , as will be shown in subsection  [ subsec : darkfpnperf ] .",
    "the components of the source follower noise were discussed in subsection  [ sec : sfnoise ] . in the simulations ,",
    "the source follower noise can be approximated as : @xmath89)},\\ ] ] where @xmath90 is the source follower noise [ @xmath0 rms ] , @xmath91 is the readout clock frequency ( typically several mhz ) , @xmath92 is the cds sample - to - sampling time [ sec ] , @xmath93 is a sense node conversion gain from eq .",
    "[ eq : conversiontovoltage ] , @xmath38 is a source follower gain from eq .  [",
    "eq : conversiontosourcefollower ] , @xmath94 is the correlated double sampling ( cds ) dominant time constant usually  @xcite @xmath95 [ sec ] . in order to approximate the source follower noise",
    ", we need to calculate the power spectrum of the noise @xmath96 and the cds transfer function @xmath97 .",
    "the power spectrum @xmath96 of the source follower noise can be approximated  @xcite as : @xmath98 where @xmath99 is the thermal white noise in @xmath100 ( typically @xmath101 ) , @xmath102 is the flicker noise corner frequency in [ hz ] , and @xmath103 is the random telegraph noise ( rtn ) power spectrum that is given by  @xcite : @xmath104 where @xmath105 is the random telegraph noise ( rtn ) characteristic time constant [ sec ] and @xmath106 [ a ] is the source follower current modulation induced by rtn .",
    "these constants are usually provided in the photosensor specifications and therefore can be used for the simulations .",
    "the @xmath97 is the cds transfer function and is given by the following expression  @xcite : @xmath107 \\cdot [ 2 - 2\\cos(2\\pi f t_s ) ] .\\ ] ]    in ccd photosensors , source follower noise is typically limited by the flicker noise .",
    "on the other hand , in cmos photosensors the source follower noise is typically limited by the rtn noise .",
    "[ review:4 - 1r1 ] using parameters provided in the specifications for the photosensors , one has to calculate eq .",
    "[ eq : sigma_sf ] using the vector @xmath97 from eq .",
    "[ eq : h_cds ] and @xmath96 from eq .",
    "[ eq : s_sf ] .",
    "the functions @xmath96 , @xmath103 , and @xmath97 can be calculated for each frequency value @xmath108 using vector notation to streamline the simulation code .",
    "we assume the source follower noise to be additive and gaussian - distributed : @xmath109,\\ ] ] where the standard deviation of source follower noise @xmath110 is given by eq .",
    "[ eq : sigma_sf ] .",
    "the computed matrix @xmath111 represents the source follower noise ( in electrons ) .",
    "[ review:14r1]the simulation of charge to voltage conversion is performed as follows .",
    "the light signal @xmath112 contains photon shot noise ( already added to the matrix @xmath75 from eq .",
    "[ eq : photonstoelectrons ] ) and the prnu:[review:11 - 2r1 ]    @xmath113    the dark signal matrix @xmath114 consists of dark signal , dark current shot noise , dark current fpn from eq .",
    "[ eq : darkfpnsimulation ] , and source follower noise @xmath111 is from eq.[eq : sourcefollowernoisesimulation ] as follows :    @xmath115    then the matrices that correspond to the light signal @xmath112 and dark signal @xmath116 are summed together and rounded :    @xmath117    [ review2jei : r1_q1]the number of electrons is then truncated to the full well ( the maximum number of electrons in the pixel ) and rounded .",
    "then the v/@xmath0 non - linearity is applied ( if desired ) to this sum using eq .",
    "[ eq : sensenodenonlin ] and converted to voltage by multiplication by the sense node conversion gain @xmath93 .",
    "the details are provided in the following subsections .",
    "the ktc noise is occurs in cmos sensors ( as we mentioned before in subsection  [ sec : subsection : snresetnoise ] ) , while for ccd sensors the sense node reset noise is removed  @xcite by correlated double sampling ( cds ) .",
    "random fluctuations of charge on the sense node during the reset stage result in a corresponding photodiode reset voltage fluctuation .",
    "the sense node reset noise is given by eq.[eq : ktcnoise ] , repeated here for convenience :    @xmath118    the simulation of the sense node reset noise may be performed as an addition of non - symmetric probability distribution to the reference voltage @xmath37 . however , the form of distribution depends on the sensor s architecture and the reset technique  @xcite .",
    "an inverse - gaussian distribution can be used for the simulation of ktc noise which corresponds to a hard reset technique in the cmos sensor , and the log - normal distribution can be used for soft - reset technique .",
    "the sense node reset noise can be simulated for each @xmath66-th pixel for the soft - reset case as : @xmath119 where @xmath120 is from eq.[eq : ktcnoise ] and then added to the matrix @xmath121 in volts that corresponds to the reference voltage .      a model of the offset fpn in cmos sensors was represented  @xcite as the sum of two components : a column and a pixel component .",
    "each component is modelled by a first order isotropic autoregressive process , where the processes are assumed uncorrelated .",
    "the model  @xcite uses autoregressive processes to model the offset fpn since the parameters can be easily and efficiently estimated from the hardware sensor data  @xcite.[review:36r1 ]    [ review:31 - 7r1]the column offset fpn from the model  @xcite can be described as follows .",
    "the noise is generated for each @xmath122-th column index of the matrix @xmath123 that corresponds to the voltage signal of the photosensor .",
    "the model assumes that the column offset fpn is a first order isotropic autoregressive process of the form : @xmath124 where the @xmath125 are zero mean , uncorrelated random variables with the variance @xmath126 , and @xmath127 $ ] is a parameter that characterises the dependency of @xmath128 on its two neighbours  @xcite .",
    "the data in the matrix @xmath128 the repeated for every row to make the matrix of the appropriate size .",
    "more details are provided in  @xcite .",
    "the simulation of the charge - to - voltage conversion uses the sense node gain @xmath93 [ v/@xmath0 ] as a parameter that is in the range @xmath130 \\mu v / e^-$ ] ( sensor - dependent ) . conversion from charge to voltage",
    "is performed in the sense node as follows : @xmath131 where @xmath132 is the matrix of sense node voltages , @xmath37 is the reference voltage , @xmath133 is the matrix that corresponds to the total number of electrons collected by the `` software '' sensor ( see eq.[eq : totalsignalcollected ] ) during the integration time , and @xmath93 is the sense node gain in [ v/@xmath134 .    in case",
    "when the sense node reset noise ( ktc noise ) is simulated , the matrix that contains the reset noise @xmath135 from eq .",
    "[ eq : snresetsimulation ] is added to the @xmath37 in eq .",
    "[ eq : conversiontovoltage ] : @xmath136    after that , the source follower gain @xmath38 [ v / v ] is applied : @xmath137 where @xmath38 is a source follower gain [ v / v ] .    if the offset fpn is simulated , the matrix @xmath138 that corresponds to the offset fpn noise is added as follows : @xmath139 next , the v / v non - linearity from eq .  [",
    "eq : vvnonlin ] is applied if necessary and the resulting matrix of voltages is stored in @xmath140 .",
    "after that , the matrix @xmath140 that corresponds to voltages is converted to digital numbers .      for the simulation model",
    ", the v/@xmath0 non - linearity can be expressed from eq.[eq : venonlinsignal ] as : @xmath141\\ ] ] where @xmath142 is the charge of an electron , and @xmath17 is the coefficient of non - linearity .",
    "the parameter @xmath17 is usually provided in the photosensor specifications .",
    "the voltage matrix is multiplied by the new source follower gain @xmath43 : @xmath143 where @xmath132 is the sense node voltage signal , @xmath144 is the source follower voltage signal , and @xmath43 is a new source follower gain according to eq.[eq : sfnewgain ] repeated here for convenience : @xmath145 the next step involves the adc for quantisation to a digital signal .",
    "[ review:3 - 1r1]in this paper , we use the algorithm of correlated double sampling ( cds ) that is similar to the method described in  @xcite .",
    "the algorithm is as follows . during the simulations ,",
    "two images are acquired : a light image that contains both signal and noise , and a dark image with zero exposure time .",
    "the cds algorithm then subtracts these two images to eliminate fixed pattern noise .    in the real hardware sensor ,",
    "the cds techniques can be different and more sophisticated .",
    "this can contribute to mismatch between the data from the real sensor and from the numerical simulator .",
    "that is , the cds algorithms in the simulations can be less aggressive and therefore the residual noise on the image can be larger than on the actual sensor .      after the electron matrix has been converted to voltages , the sense node reset noise and offset fpn noise",
    "are added , the v / v gain non - linearity is applied ( if desired ) , the adc non - linearity is applied ( if necessary ) .",
    "finally the result is multiplied by adc gain and rounded to produce the signal as a digital number : @xmath146 where @xmath147 is the total voltage signal accumulated during one frame acquisition , @xmath52 is the maximum voltage that can be quantified by an adc , and @xmath123 is the total voltage signal accumulated by the end of the exposure ( integration ) time and conversion .",
    "usually @xmath148 from eq .",
    "[ eq : sourcefollowervoltage ] after the optional v / v non - linearity is applied . in this case , the conversion from voltages to digital signal is linear . the non - linear case is considered below .      in our model , we simulate the integral linearity error ( ile ) of the adc as a dependency of adc gain @xmath149 on the signal value .",
    "denote @xmath150 as an adc non - linearity ratio ( e.g. , @xmath151 ) .",
    "the linear adc gain can be calculated from eq .",
    "[ eq : kadc ] as @xmath152 and used as @xmath149 .",
    "the non - linearity coefficient @xmath153 is calculated as : @xmath154 where @xmath48 is the maximum voltage that can be quantified by an adc : @xmath155 where @xmath149 is the linear adc gain .",
    "the new non - linear adc conversion gain @xmath156 is then used for the simulations for eq .",
    "[ eq : adcconvertersimulation ] .",
    "it is assumed that the quantisation error is uniformly distributed between -0.5 and + 0.5 of the lsb and uncorrelated with the signal .",
    "denote @xmath157 the quantising step of the adc .",
    "for the ideal dc , the quantisation noise is : @xmath158 if @xmath159 then the quantisation noise is @xmath160 dn . the quantisation error has a uniform distribution .",
    "we do not assume any particular architecture of the adc in our high - level sensor model .",
    "using the formulated photosensor model , we were able to simulate realistically noised images similar to those obtained from a hardware cmos photosensor . a comparison with custom - made 5 t cmos photosensor with @xmath161 pixels of size @xmath162 is provided to validate the developed numerical model .",
    "[ review:10r2]the simulations were performed as follows .",
    "the parameters of the hardware cmos sensor were taken from the specifications ( see table  [ tab : photosensorsim ] ) provided by the manufacturer and used in the simulations .",
    "a series of the measurements were conducted both for the hardware sensor and the simulated `` software '' photosensor .",
    "the methods and procedures of the measurement were the same for the hardware and the simulated photosensor .",
    "for example , in case of estimation of the radiometric function , the flat field for the hardware sensor was generated by an array of leds .",
    "the measurements were performed for monochromatic light with wavelength @xmath163 m ( [ review2jei : r2q9 - 2 ] we assume for the same of simplicty that the light is monochromatic , and therefore we need the spectral response of the sensor at one wavelength @xmath163 m ) .",
    "[ review:5 - 2r1 ] for the numerical model , the uniform image was used that corresponds to the light signal of the leds .",
    "[ review2jei : r2q7 ] the measurements were conducted at room temperature ( @xmath164c ) if not stated otherwise .    [",
    "text : nonlinearities ]    .parameters of the simulated cmos sensor ( taken from the manufacturer s specifications ) . [ cols= \" < , < \" , ]",
    "as seen from the results in table  [ tab : spectrogramcalc ] , the read noise can be indeed considered white , with the non - whiteness coefficient @xmath165 , which is consistent with the model  @xcite .",
    "the non - flatness coefficient for the hardware sensor is slightly greater than that of the simulations ; the uncertainty of the measurements is larger as well .      in this subsection",
    "we discuss the complexity of the dark current fpn models .",
    "it is shown that the assumptions usually made in the literature ( i.e. , that the dark signal is gaussian ) are not always consistent with the noise in the hardware photosensor .",
    "the experimental results of dark signal for long integration times ( see fig .  [",
    "fig : plotdarksignallongtimemultiple3in1_longtime_experiment ] ) illustrate the complexity of the dark signal : while for rather short integration time times ( less than 100 seconds ) the distribution can be approximated as gaussian , longer integration times have a lot more complicated structure .",
    "this is important is such applications as , e.g. , astronomy , where the integration times can be very long for dim objects .",
    "we measured the dark [ review2jei : r1q6 ] signal of the hardware cmos sensor for two different cases :    1 .   _ short integration time _",
    "( less than 100 seconds ) : the only one probability distribution ( main distribution ) is used for description of the noise statistics ; 2 .",
    "_ long integration time _ ( longer than 100 seconds ) : a main distribution and a superimposed distribution are used ( for very long integration times the second superimposed distribution is used as well ) .",
    "we provide the analysis of dark signal statistics using superimposed distributions .",
    "the data provided in this subsection was measured at room temperature ( @xmath164c ) as before .    [ [ method - of - measurements-3 ] ] method of measurements : + + + + + + + + + + + + + + + + + + + + + + +    we took 32 dark frames for each integration time and averaged them in order to reduce the temporal noise and [ review2jei : r1q5 ] get the dark current fpn data .",
    "the normalised frequency of occurrences of noise values in the averaged dark image was estimated .",
    "for the estimation of statistical parameters of the dark current fpn we used a maximum likelihood estimator ( mle ) .",
    "all estimated statistical parameters reported are within a 95% confidence interval if not stated otherwise . for the description of the dark current fpn ( which is the main contributor of the dark noise , especially in short integration times ) ,",
    "we use the following distributions :    * log - normal distribution : @xmath166 * gamma distribution : @xmath167 $ ]    as superimposed distributions , the uniform distribution and gaussian distribution were used , as discussed below .",
    "we measured the dark current fpn for the hardware cmos sensor and compared the results with our high - level sensor model .",
    "the 5 t cmos hardware sensor has in - built circuitry for noise cancelling that uses correlated double sampling ( cds ) technique .",
    "the details of the cds algorithm , however , have not been disclosed by the manufacturer .",
    "consequently , the noise on the images is reduced , so the comparison of the numerical models with the hardware data is approximate .",
    "the measurements presented in fig .  [ fig : plotdarksignallongtimemultiple3in1_shorttimelinlin ] were taken for integration times of 0.001 second , which are typical for , e.g. , wavefront sensing in adaptive optics .",
    "the probability density function of the dark current fpn can be considered as gaussian for the short integration times , and the ml estimated values of @xmath168 and @xmath169 for the gaussian distribution were obtained from the experimental data for 0.001 second . while gaussian distribution provides and adequate description of the dark signal , it underestimates the `` outliers '' or `` dark spikes '' , and this is why we use the log - normal distribution ( see fig .",
    "[ fig : plotdarksignallongtimemultiple3in1_shorttimelinlin ] , data marked by `` @xmath170 ' ' ) .",
    "the mle parameters for the log - normal distribution were found as @xmath171 and @xmath172 .",
    "as integration time increases up to 100 seconds , the distribution of dark current fpn tends to be more asymmetric , however , the log - normal parameters remain similar to the very short integration time case ( @xmath173 and @xmath174 for the case of 100 second integration time ) .",
    "therefore , the log - normal distribution can still be considered as a reasonable model for the dark signal , which is consistent with the results reported in  @xcite .",
    "it is noteworthy that the gamma distribution was found to be a better approximation for a 3 t cmos photosensor in  @xcite , but for our 5 t cmos sensor the gamma distribution appears to underestimate the `` dark spikes '' , as can be noted from fig .",
    "[ fig : plotdarksignallongtimemultiple3in1_shorttimesemilog100_sec_img_2489pdfestimationexpvssim ] .",
    "[ review2jei : r1q6 - 1]also , one can notice that the dark current estimated from the measurements of the hardware sensor in this section are different from the model of dark current values in eq .",
    "[ eq : darkcurrentrate ] .",
    "this is expected , since our hardware cmos sensors has on - chip noise suppressing circuitry ( see subsection  [ subsec : cdsdescription ] ) that removes dark noise levels .",
    "the non - gaussian nature of dark current fpn is more apparent as the integration time increases .",
    "one can see in fig .",
    "[ fig : plotdarksignallongtimemultiple3in1_shorttimelinlin150_sec_img_0012pdfestimationexpvssim ] that either the log - normal or gamma distributions alone do not describe the data adequately .",
    "therefore , in the case of long integration time , it is necessary to superimpose another probability distribution , as mentioned in  @xcite , in order to create a distribution with a very long `` tail '' to simulate `` outliers '' .",
    "the overall distribution for the simulation of the dark signal was constructed as follows .",
    "first , the gamma distribution was generated with parameters @xmath175 and @xmath176 , which were estimated from the hardware cmos photosensor data .",
    "next , the product of two uniform distributions on the interval @xmath177 $ ] was superimposed ( the parameters were chosen to fit both the `` outliers '' and to widen the left part of the probability density ) . the results are shown in fig .",
    "[ fig : plotdarksignallongtimemultiple3in1_shorttimelinlin150_sec_img_0012pdfestimationexpvssim ] .",
    "one can see a better agreement of the superimposed distribution described above with the experimental estimation of the dark signal statistics .    - ) and using a superimposed probability distribution ( -@xmath178- ) . ]",
    "the dark signal statistics is getting more complicated with very long integration time .",
    "the dark current fpn is no longer the main contributor to the noise statistics : one would expect the noise measurements to be dominated by thermally - generated electron noise .",
    "those are the two distributions ( see fig .",
    "[ fig : plotdarksignallongtimemultiple3in1_longtime ] ) that underlie the dark signal measurements .",
    "the dark signal in these cases may require modelling based on the experimental data for a particular type of a photosensor . in our example , we were able to compose a distribution to describe the experimental dark signal probability distribution using the superimposed distributions as follows :    1 .",
    "main distribution : gamma with parameters @xmath179 and @xmath180 ; 2 .   superimposed : uniform distribution on interval",
    "@xmath181 $ ] ; 3 .   superimposed : gaussian distribution with parameters @xmath182 and @xmath183 .",
    "the composed distribution describes the dark current fpn ( @xmath184 symbol ) with good accuracy , as seen in fig .",
    "[ fig : plotdarksignallongtimemultiple3in1_longtime ] .",
    "one can see from the provided data that the approximation of dark current fpn using only a gaussian distribution is poor .",
    "on the other hand , the superimposed distributions provide a better description of the complex structure of the dark current fpn .",
    "[ subsec : darknoisemeasurementdiscussion ] the modelling of the dark signal is complicated , since it is difficult to derive a model for the parameters of the superimposed probability distributions .",
    "the description of long - exposure dark current fpn is complicated because the statistical parameters are dependent on temperature and exposure ( integration ) time in a non - trivial way and likely to vary from one photosensor to another .",
    "an additional problem for the analysis of the dark signal is that the exact cds algorithm is usually not disclosed by the manufacturer , and even if disclosed , it is difficult to simulate precisely .",
    "furthermore , additional on - chip ( e.g. , transfer noise ) and off - chip noise ( clock - jitter noise , preamplifier noise , etc . ) can contribute  @xcite to the resulting noise distribution .",
    "nonetheless , the description based on superimposed distributions gives acceptable results for the fixed sensor s parameters ( temperature , photosensor technology ) .",
    "the experimental data along with the models developed in this subsection describe the dark current fpn noise for different integration times .",
    "three cases were considered :    * _ short integration time ( less than 100 seconds ) _ , where a lognormal distribution is adequate as a main distribution , * _ long integration time ( longer than 100 - 150 seconds ) _ , where another distribution must be superimposed to a main distribution ( or several , in case of integration times longer than 300 seconds ) .    at short integration times",
    ", the noise is the variability of dark current across pixels , that is , dark current fpn ( or dark signal non - uniformity , dsnu ) .",
    "[ review2jei : r2_q15 ] at long integration times , one would expect the noise measurements to be dominated by thermally - generated electron noise .",
    "those are the two distributions ( see fig .",
    "[ fig : plotdarksignallongtimemultiple3in1_longtime_experiment ] and fig .",
    "[ fig : plotdarksignallongtimemultiple3in1_longtime ] ) that presumably underlie the measurements .",
    "as the integration time increases further , the probability distribution of the resulting dark signal gets more complicated and harder to model .",
    "the article provides a literature review of the noise models that are used for the simulations of noise in ccd and cmos photosensors . a high - level model of ccd and cmos photosensors based on a literature review",
    "is formulated in this paper .",
    "the experimental results for a hardware 5 t cmos photosensor are presented as a validation for the developed model of a photosensor .",
    "the formulated model of the cmos photosensor was compared with the data from a custom - made hardware photosensor for validation of the photosensor model .",
    "results of photon transfer curve ( ptc ) estimation show the importance of the non - linearity introduced in the model . using the models of v / v and the adc",
    "non - linearity allow to better match the properties of the hardware cmos sensor .",
    "it has been also demonstrated that the dark current fpn and in particular the dark `` spikes '' in the case of a long integration time has a more complicated distribution than previously discussed in the literature . the gamma distribution with a superimposed uniform and gaussian distributions",
    "are shown to be a reasonable approximation of the dark `` spikes '' for long integration time .",
    "the article summarises the efforts in numerical simulations of solid - state photosensors providing an extensive survey of literature on noise in photosensors . a high - level model of cmos / ccd sensors",
    "has been formulated in order to provide engineers with insight on the noise impact on images quality .",
    "using such a high - level photosensor model , one can simulate either ccd or cmos sensors by application of appropriate noise models .",
    "the formulated high - level simulation model can be used to synthesise realistically noised images for the development and testing of the image processing algorithms .",
    "the authors are gratefully acknowledge personal communications with _ dr . james r. janesick _ and his valuable comments .",
    "kolehmainen , j.  aikio , m.  karppinen , a.j .",
    "mattila , j.t .",
    "makinen , k.  kataja , k.  tukkiniemi , and p.  karioja . .",
    "in _ proceedings of spie - optical modeling and performance predictions _ , volume 5178 , pages 204212 , 2004 .",
    "r.  costantini and s.  ssstrunk . .",
    "in _ proceedings of is&t / spie electronic imaging - sensors and camera systems for scientific , industrial , and digital photography applications _ , volume 5301 , pages 408419 , 2004 .",
    "mikhail  v. konnik and james welsh .",
    "open - source framework for documentation of scientific software written on matlab - compatible programming languages . in _ proceedings of spie astronomical telescopes + instrumentation - software and cyberinfrastructure for astronomy ii _ , volume 8451 - 102 , 2012 .",
    "mo  chen , jessica fridrich , miroslav goljan , and jan luk .",
    "source digital camcorder identification using sensor photo response non - uniformity . in _ proceedings of spie - security , steganography , and watermarking of multimedia contents ix _ ,",
    "volume 6505 , page 65051 g , 2007 .",
    "yuan chen , s.m .",
    "guertin , m.  petkov , d.n .",
    "nguyen , and f.  novak . a chip and pixel qualification methodology on imaging sensors . in _ in proceedings of 42nd annual ieee reliability physics symposium _ ,",
    "pages 435  439 , april 2004 .",
    "loukianova , h.o .",
    "folkerts , j.p.v .",
    "maas , d.w.e .",
    "verbugt , a.j .",
    "mierop , w.  hoekstra , e.  roks , and a.j.p .",
    "leakage current modeling of test structures for characterization of dark current in cmos image sensors .",
    ", 50(1):77  83 , 2003 .",
    "r.  widenhorn , m.m .",
    "blouke , a.  weber , a.  rest , and e.  bodegom . .",
    "in _ proceedings of spie - sensors and camera systems for scientific , industrial , and digital photography applications iii _ , volume 4669 , pages 193201 , 2002 .",
    "n.  sakaguchi , n.  nakamura , s.  ohsawa , y.  endo , y.  matsunaga , k.  ooi , and o.  yoshida .",
    "dark current fixed pattern noise reduction for the 2/3-in two - million pixel hdtv stack - ccd imager .",
    ", 44(10):1658 1662 , 1997 .",
    "j.  janesick , j.  pinter , r.  potter , t.  elliott , j.  andrews , j.  tower , m.  grygon , and d.  keller . .",
    "in _ proceedings of spie - high energy , optical , and infrared detectors for astronomy iv _ , volume 7742 , pages 77420b77420b30 , 2010 .",
    "thomas  j. fellers and michael  w. davidson .",
    "ccd noise sources and signal - to - noise ratio .",
    "technical report , national high magnetic field laboratory , the florida state university , tallahassee , florida , usa , 2010 .",
    "h.  rhodes , g.  agranov , c.  hong , u.  boettiger , r.  mauritzson , j.  ladd , i.  karasev , j.  mckee , e.  jenkins , w.  quinlin , i.  patrick , j.  li , x.  fan , r.  panicacci , s.  smith , c.  mouli , and j.  bruce . . ,",
    "pages 718 , 2004 .",
    "b.  fowler , m.d .",
    "godfrey , j.  balicki , and j.  canfield . .",
    "in _ proceedings of spie - sensors and camera systems for scientific , industrial , and digital photography applications _ , volume 3965 , pages 126135 , 2000 .",
    "g.  deptuch , j.d .",
    "berst , g.  claus , c.  colledani , w.  dulinski , u.  goerlach , yu .",
    "gornoushkin , y.  hu , d.  husson , g.  orazi , r.  turchetta , j.l .",
    "riester , and m.  winter .",
    "design and testing of monolithic active pixel sensors for charged particle tracking . in _",
    "ieee nuclear science symposium conference record , volume 1 , pages 3/103 -3/110 _ , 2000 .",
    "c.  xu , s.  chao , and m.  chan . a new correlated double sampling ( cds ) technique for low voltage design environment in advanced cmos technology . in _ proceedings of the 28th european solid - state circuits conference ( esscirc ) _ , pages 117120 , 2002 .",
    "gzen kkl , yusuf leblebici , and sandro carrara .",
    "a switched capacitor fully differential correlated double sampling circuit for cmos image sensors . in",
    "_ proceedings of 5th international symposium on medical information & communication technology ( ismict ) _ , pages 113116 , 2011 .",
    "r.  turchetta , p.p .",
    "allport , g.  casse , a.  clark , j.  crooks , a.  evans , a.  fant , a.r .",
    "faruqi , m.j .",
    "french , r.  henderson , q.  morrissey , d.  prior , m.  prydderch , j.j .",
    "velthuis , g.  villani , n.  waltham , b.  willmore , and p.  willmore .",
    "cmos monolithic active pixel sensors ( maps ) : new eyes for science . , 560(1):139  142 , 2006 ."
  ],
  "abstract_text": [
    "<S> in many applications , such as development and testing of image processing algorithms , it is often necessary to simulate images containing realistic noise from solid - state photosensors . a high - level model of ccd and cmos photosensors based on a literature review </S>",
    "<S> is formulated in this paper . </S>",
    "<S> the model includes photo - response non - uniformity , photon shot noise , dark current fixed pattern noise , dark current shot noise , offset fixed pattern noise , source follower noise , sense node reset noise , and quantisation noise . </S>",
    "<S> the model also includes voltage - to - voltage , voltage - to - electrons , and analogue - to - digital converter non - linearities . </S>",
    "<S> the formulated model can be used to create synthetic images for testing and validation of image processing algorithms in the presence of realistic images noise . </S>",
    "<S> an example of the simulated cmos photosensor and a comparison with a custom - made cmos hardware sensor is presented . </S>",
    "<S> procedures for characterisation from both light and dark noises are described . </S>",
    "<S> experimental results that confirm the validity of the numerical model are provided . </S>",
    "<S> the paper addresses the issue of the lack of comprehensive high - level photosensor models that enable engineers to simulate realistic effects of noise on the images obtained from solid - state photosensors . </S>"
  ]
}