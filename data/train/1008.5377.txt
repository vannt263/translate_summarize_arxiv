{
  "article_text": [
    "over the past two decades atomistic simulation of chemical , material and biological systems has become a routine and important tool for understanding , analyzing and predicting experiment .",
    "time scales of interest now often span into the microsecond range so as to monitor processes such as protein folding and transport through membranes .",
    "however , the shortest atomic time scales in these systems , typically for bonded interactions such as stretches and bends , are of the scale of femtoseconds and therefore time steps of this order are required to stably evolve the system . as a result ,",
    "billions of steps are needed to reach the time scales of interest , making such simulations a formidable challenge .",
    "chemical systems typically involve interactions occurring on many time scales ranging from rapidly varying , but cheap to calculate , bonded interactions to slow , but expensive , long range electrostatics .",
    "multiple time scale methods can be used to exploit this separation in time scales by updating the slow interactions less frequently than the fast interactions , in principle allowing significant computational savings to be achieved .",
    "@xcite however , the maximum outer time step which can be obtained is in practice limited by the resonance between the slow and fast modes .",
    "@xcite this results in energy building up in the high frequency modes , raising the temperature of the system and leading to unstable trajectories and incorrect sampling . as a result",
    "the fastest mode in the system still dictates how frequently the slowest interactions must be calculated , thereby limiting the maximum obtainable speed - up .",
    "@xcite    a commonly used approach to delay the resonance barrier is to remove the high frequencies in the system by constraining them .",
    "@xcite for example in water one can constrain the oxygen - hydrogen bond length and intramolecular hydrogen - hydrogen distance .",
    "this allows a larger outer time step to be used but requires prior knowledge of the coordinates that comprise the fast modes . in simple systems",
    "these coordinates may be known , but in complex biological and materials systems this is not always the case and one could risk constraining a degree of freedom which has vital importance to mechanism or function .",
    "the molly method can be viewed in a similar fashion since it requires prior specification of coordinates of fast modes which are then used to filter out the destabilizing components of the slow forces .",
    "@xcite    it is now well established that large time steps can be achieved while retaining full flexibility by coupling the system to a bath .",
    "@xcite we note that the bath serves two purposes : to remove energy which builds up in the modes and to disrupt the high frequency modes from resonating with the lower frequencies .",
    "the most common choice is to couple each atom in the system to a white noise langevin ( wnl ) bath which acts uniformly across the spectrum of the system .",
    "@xcite however , as has been pointed out previously ,  @xcite the strength of the system - bath coupling needed to stabilize large time steps significantly disrupts the motion of the slow modes thereby greatly hindering diffusive and orientational motion . as we will show this leads to a situation where any computational speed - ups gained by increasing the outer time step are largely outweighed by the decrease in the rate at which different configurations are explored . to avoid",
    "this one would ideally like to couple strongly to high frequency motion in the system while leaving low frequencies unperturbed .",
    "this can be achieved by transforming to the normal modes of the system at each time step and then evolving using a strong coupling to high frequencies with weak coupling to low ones .",
    "indeed , it has been shown for a simple biological system in implicit solvent that this approach is very successful at removing resonance issues while preserving dynamics .",
    "@xcite however , in practice performing normal mode transformations at each step for large systems is prohibitively expensive .    in this paper",
    "we attempt to reconcile the simplicity of the wnl approach with the effectiveness of the targeted normal mode approach by using tailored colored noise .",
    "recent work has made this possible by showing how the generalized langevin equation ( gle ) can be used to thermostat molecular dynamics simulations using an extended wnl formalism .",
    "@xcite unlike white noise , colored noise can be tailored to have a frequency dependent coupling which allows for much greater flexibility in its application .",
    "for example a simple colored noise thermostat was designed for use in car - parrinello _ ab - initio _ molecular dynamics simulations which only targets atomic motion while allowing the high frequency fictitious electronic degrees of freedom to evolve freely .",
    "@xcite in this work we will demonstrate how colored noise can instead be used to design a bath which heavily damps high frequencies while leaving low frequencies largely unaffected . the simple scheme which results allows the resonance barrier to be postponed facilitating the use of large outer time steps while yielding accurate sampling and minimal impact on the dynamics .",
    "applications of this approach to flexible water and an aqueous solution of alanine dipeptide demonstrate that significant increases in computational efficiency can be achieved while requiring little _ a priori _ knowledge of the system .",
    "the outline of the paper is as follows .",
    "section ii briefly reviews the colored noise thermostatting approach and shows how colored noise profiles can be constructed in a transparent way by combining simple analytic forms .",
    "the implementation of the gle thermostat in a standard reference system propagator algorithm ( respa )  @xcite is then discussed .",
    "section iii outlines the simulations performed using this scheme to calculate the static and dynamic properties of a fully flexible model of liquid water and an aqueous solution of alanine dipeptide .",
    "section iv discusses the results of these applications and sec . v concludes .",
    "for a particle of mass @xmath0 with position @xmath1 and momentum @xmath2 moving on a one dimensional potential energy surface @xmath3 , the generalized langevin equation is ,  @xcite @xmath4 where @xmath5 is the memory kernel , @xmath6 is a non - markovian `` colored '' random force and @xmath7 is the force due the potential .",
    "the fluctuation - dissipation theorem dictates that for an equilibrium system at temperature @xmath8 , @xmath5 and @xmath6 are related by , @xmath9 where @xmath10 is the boltzmann constant .    in the case where the random force is uncorrelated , @xmath11 , the white noise langevin equation ,",
    "@xmath12 is recovered . here",
    "@xmath13 is a gaussian markov process with unit variance and the fluctuation dissipation theorem in eq .",
    "( [ eq : fluc_dis ] ) reduces to , @xmath14 which is commonly used as a tool to thermostat molecular dynamics simulations",
    ".    a colored noise thermostat can be implemented by exactly mapping equation [ eq : genlang ] onto a markovian dynamics in an extended space consisting of a set of auxiliary momenta , @xmath15 , that are coupled to the system momentum , @xmath2 , in the presence of a markovian bath .",
    "@xcite the equations of motion are given by : @xmath16 where @xmath17 is a vector of uncorrelated gaussian noise .",
    "the drift ( or damping ) matrix ( @xmath18 ) , may be related to the diffusion matrix ( @xmath19 ) by a recasted fluctuation - dissipation theorem .",
    "@xcite @xmath20 the matrix elements of @xmath18 , @xmath21 determine the form of the memory kernel that acts on the system via @xmath22 if the extended momenta are uncoupled from the system equation , eq .",
    "( [ eq : langmat ] ) reduces to the white noise langevin equation ( eq .  ( [ eq : wnllang ] ) ) with @xmath23 . in the next section",
    "we will describe how eq .",
    "( [ eq : memory ] ) can be used to design a drift matrix that yields a colored noise profile such that the high frequency modes are strongly coupled and slow modes weakly coupled to the bath .",
    "the effect of the bath on the system is determined by the details of @xmath5 . using the extended white noise langevin framework outlined above the effect of the bath and the form of the memory kernel",
    "is determined by customizing the drift matrix @xmath18 ( see eq .",
    "( [ eq : memory ] ) ) .    the expression given in the right hand side of eq .",
    "( [ eq : memory ] ) consists of two terms , a simple white noise component of strength @xmath24 and one that depends upon the coupling of the auxiliary momenta .",
    "this second term is a scalar and is therefore invariant to the choice of basis .",
    "the time dependence of the second term of eq .",
    "( [ eq : memory ] ) is contained in the matrix exponential of submatrix , @xmath25 and it is therefore transparently expressed in its eigenbasis .",
    "the eigendecomposition of the submatrix yields @xmath26 , where @xmath27 is the diagonal eigenvalue matrix .",
    "matrix @xmath28 is comprised of the set of eigenvectors in its columns and may be used to rotate , @xmath25 into the eigenbasis . the memory function is now expressed as , @xmath29 in order to recover correct equilibrium behavior in the @xmath30 limit , it is a necessary but not sufficient condition that the real part of the eigenvalues of @xmath25 are chosen to be positive .",
    "@xcite the resultant kernel consists of a linear combination of exponential decaying forms , arising from the real eigenvalues , and damped oscillatory ones from the complex conjugate pairs .",
    "in considering the effect of a colored noise bath it is physically intuitive to consider the memory spectrum , @xmath31 , which is the fourier transform of the memory kernel . given that the memory function may be expressed as a linear combination of a white noise term and a set of exponential forms with real or complex conjugate pairs of eigenvalues , the memory spectrum is readily computable . for a given eigenvalue @xmath32 , the fourier transform of the corresponding exponential function is a lorentzian , @xmath33 the width and center of the lorentzian is given by the real and imaginary parts of the corresponding eigenvalue , respectively . therefore , the memory spectrum is expressible as a constant @xmath34 from which a set of lorentzian functions are added or subtracted . in order to generate the correct equilibrium distribution ,",
    "forms must be chosen such that @xmath31 is always greater than zero .",
    "@xcite    although the form of the memory function as given by eq .",
    "( [ eq : memeigen ] ) appears simple , `` translating '' a chosen form into a stable drift matrix is non - trivial .",
    "this is due to the fact that although the basis in which the submatrix @xmath25 is expressed is arbitrary with respect to the form of the memory function , this choice of basis is crucial for the generation of stable dynamics within the colored noise thermostat implementation .",
    "namely , a requirement of the integration of the equations of motion is that the symmetric part of @xmath18 must be positive definite ( see sec .",
    "[ ssec : int ] ) .",
    "indeed , it is possible to choose forms of the kernel based on eq .",
    "( [ eq : memeigen ] ) such that @xmath35 while violating this condition .    despite these difficulties , it is possible to construct drift matrices which correspond to a memory spectrum of a desired form where the matrix elements are transparently relatable to the the time dependence , namely the eigenvalues of @xmath25 are explicit parameters of @xmath18 .",
    "drift matrices of this sort have already appeared in the literature ,  @xcite and their details are summarized in appendix [ app : forms ] .",
    "we now present such a form that is tailored for the problem at hand .    in selecting the details of the colored noise profile",
    "it is instructive to first consider the memory spectrum , which provides information about how strongly the modes of the system exchange energy with the bath at a given frequency .",
    "@xcite additionally , the @xmath36 value of the memory spectrum is inversely proportional to the diffusion constant of a free particle ( @xmath37 ) coupled to the bath .",
    "therefore , if a profile is required that couples the bath strongly to high frequency modes and more weakly to low ones , one can start by constructing a memory kernel whose spectrum is small at low frequencies and large near the frequencies where strong coupling is desired .",
    "the following drift matrix ,    @xmath38    corresponds to a memory spectrum which possesses such a form .",
    "the associated memory kernel and spectrum are given by the following equations : @xmath39    the memory spectrum of eq .",
    "( [ eq:3x3spec ] ) is shown schematically in figure [ fig:3x3 ] .",
    "it can be understood as a white noise of strength @xmath40 from which a pair of lorentzians of width @xmath41 centered at @xmath42 is subtracted . in this way",
    "the lortenzian terms can be thought of as partially `` canceling out '' the white noise component at low frequencies .",
    "the shape is such that its value is @xmath43 at @xmath36 and approaches a value @xmath44 as @xmath45 . in order to fulfill our design requirements of the noise profile , we take the parameter @xmath46 to be an arbitrarily small ( non - zero ) number . the parameter @xmath47 is related to the frequency at which the memory spectrum begins to rise rapidly .",
    "when the parameters are chosen to have positive values , @xmath31 is an even , positive definite function , as is required to generate the correct equilibrium distribution .    the colored noise profile expressed in eqs .",
    "( [ eq:3x3 ] ) , ( [ eq:3x3mem ] ) , and ( [ eq:3x3spec ] ) provides a transparent and readily tunable form for the drift matrix of the colored noise thermostat with an associated memory spectrum of the shape that we desire .",
    "however the coupling of the bath to system is non - local , and although intuition can inform our choice of the shape of the memory spectrum , one can not _ a priori _ determine the exact values of the parameters @xmath40 and @xmath47 which adequately couple to high frequency modes and simultaneously minimize the perturbation on low frequency modes .    in previous work ,",
    "colored noise thermostats have been successfully tuned according to the energy relaxation times of harmonic oscillators coupled to the thermostat .",
    "@xcite however in this work we find it more appropriate to estimate the disturbance of the spectrum of a test harmonic oscillator engendered by the colored noise thermostat .",
    "the velocity autocorrelation function ( and hence spectrum ) for an oscillator with frequency @xmath48 in the presence of the colored noise thermostat may be exactly computed by matrix algebra .  @xcite the spectrum is both broadened and shifted with respect to the free oscillator result , and the size of these differences provides some measure of the strength of the system - bath coupling . for frequencies that are small compared to the bath parameter @xmath47 and when @xmath46 is negligible , the ratio of the peak position of the system - bath spectrum ( @xmath49 ) to that of the free spectrum ( @xmath48 ) may be estimated by the following expression ( see appendix [ app : shift ] ) , @xmath50 it is important to note that this estimate depends on the value of the friction in the high frequency limit , and is a function of the ratio @xmath51 .",
    "this underscores the non - locality in frequency space of the system - bath interaction .",
    "equation [ eq : shift ] provides an estimate of the impact of the colored noise thermostat on the low frequency modes . in order to ensure that the high frequency modes are sufficiently damped , the parameter @xmath40 is set to be large .",
    "a lower bound is provided by the white noise friction that is required to stabilize any resonance instabilities that are present in the system .",
    "fine tuning can then be accomplished by testing the performance of a set of noise profiles on a realistic system in conjunction with a multiple time scale integrator . however , since most biomolecular systems have similar spectral features the profiles presented here should provide good performance in a broad range of studies without reparameterization .",
    "the parameters for the colored noise profiles that will be utilized in this study are given in table [ tab : tab1 ] .    in order to gauge the impact of the colored noise thermostat , the spectrum of a flexible water model  @xcite in the presence of a bath as defined by parameter set gle - 12 fs in table [ tab : tab1 ] is plotted in figure [ fig : spec ] .",
    "the result is compared to microcanonical and white noise langevin dynamics with a friction that is equivalent to the @xmath52 limit of the colored profile .",
    "it can be readily seen that , when compared with the microcanonical dynamics , the lower frequency modes are less disturbed than those related to bending and stretching .",
    "it is the intramolecular modes that have been targeted for damping and one can see that the impact of the colored bath on the oxygen - hydrogen stretch at @xmath53 ps@xmath54 is comparable to that engendered by the high - friction white noise bath .",
    "furthermore we note that the ratio of the low frequency peak positions of the thermostatted spectra to the microcanonical peak positions is approximately @xmath55 .",
    "this value is close to the estimate provided by eq .",
    "( [ eq : shift ] ) , which predicts a shift of @xmath56 ( see table [ tab : tab1 ] ) .",
    ".the parameters sets of the drift matrix ( eq .  ( [ eq:3x3 ] ) ) which are utilized in this study .",
    "parameter sets are labeled according to the outer time step which they are used in conjunction with ( see sec . [ sec : details ] ) .",
    "[ cols=\"^,^,^,^,^\",options=\"header \" , ]",
    "in this paper , we have shown that by coupling a standard multiple time scale scheme to a colored noise bath large outer time steps can be employed while obtaining accurate sampling and minimally perturbing the dynamics .",
    "the scheme was illustrated with applications to flexible water and a fully flexible simulation of aqueous alanine dipeptide .",
    "our results suggest that , when combined with our scheme , a 12 fs outer time step seems a good compromise between size of outer time step and minimizing the impact on the dynamics . with this outer time step the damping needed to obtain potential energies within @xmath57 of the benchmark values decreased diffusion by only @xmath58 .",
    "in contrast , stabilization of the simulation at this outer time step using white noise decreases the diffusion constant by over 2.5 times .",
    "even more promising , the dynamical perturbation due to our colored noise scheme compared favorably with the weak white noise damping ( @xmath59 ps@xmath54 ) required to stabilize a multiple time scale simulation in which all bonds to hydrogen are constrained .",
    "@xcite this suggests that , in conjunction with multiple time scale algorithms , this method may be utilized in lieu of constraints .    in our serial code",
    "using a 12 fs outer time step yielded a computational speed - up of 4.3 times compared to our baseline mts calculations using a 2 fs outer time step and a 17 times speed up compared to flexible simulations without a multiple time scale scheme that employ a 0.5 fs time step .",
    "even further increases may be achieved when the computational architecture or parallelization scheme makes long range electrostatics comparatively costly to evaluate .",
    "@xcite it is therefore clear that this scheme provides an efficient approach to perform equilibration or configurational sampling .",
    "although our approach perturbs the dynamics we note that the alanine dipeptide molecule used in our benchmark simulation was specifically chosen to allow us to view many transitions and hence converge the dynamical properties within small bounds . in typical , large - scale biological system where long time - scale processes are of interest",
    "this would not be the case and hence the small change in the dynamics due to this method will likely be dwarfed by the statistical errors . in this case",
    "the ability to generate longer trajectories using this approach facilitates a decrease in the statistical errors bars .",
    "the similarities in the spectra of many aqueous and biological systems suggest that our noise profiles should provide good out - of - the box performance for other fully flexible systems .",
    "however , the flexibility of the colored noise approach affords such a large degree of versatility that further tuning may yield improved results .",
    "our matrices may also provide a basis for other applications where energy must be rapidly dissipated to ensure accurate sampling such as in the case of fast - deposition metadynamics .",
    "@xcite the methods outlined in sec .",
    "ii and appendix [ app : forms ] provide a starting point for such developments .",
    "this research was supported from a grant to b.j.b . from the national science foundation via grant nsf - che-0910943 .",
    "it is often convenient to consider drift matrices whose elements are transparently related to the time dependence of the memory kernel ( i.e. the eigenvalues of submatrix @xmath25 ) .",
    "this facilitates the use of readily tunable colored noise profiles that are based on a small set of parameters .",
    "in addition to the form presented in this work ( eq .  ( [ eq:3x3 ] ) ) , two other of such matrices have appeared in the literature .",
    "the drift matrix for a simple exponential noise is given by  @xcite @xmath60 where the memory function and spectra are : @xmath61 whereas the following drift matrix ,  @xcite    @xmath62    corresponds to a term of damped oscillatory noise whose spectra is centered at @xmath63 : @xmath64    in the above equations , the parameter , @xmath65 , corresponds to the real part and @xmath66 to the magnitude of the imaginary part of the eigenvalue(s ) of submatrix , @xmath25 . as in section",
    "[ sec : theory ] , the parameter @xmath46 is proportional to the value of the memory spectra at @xmath36 , such that @xmath67 .",
    "drift matrices that correspond to stable dynamics may be combined such that the resultant memory function is a weighted sum of the corresponding memory functions of each component .",
    "@xcite for example , the drift matrix that corresponds to the sum of the noise profiles of whose drift matrices are given by @xmath68 and @xmath69 is given by , @xmath70 where components are expressed in the notation of eq .",
    "( [ eq : acomp ] ) . in this way",
    ", forms such as those presented here may be utilized as `` building blocks '' for more flexible colored noise profiles .    making use of this machinery , it is possible to design a form that couples strongly to certain modes and weakly to others .",
    "( [ eq : comb ] ) may be applied to add together noise profiles of the damped oscillatory ( eq .  ( [ eq : spec_b ] ) ) or the `` canceling '' ( eq .",
    "( [ eq:3x3spec ] ) ) type .",
    "it must be noted that this formalism has drawbacks when compared to the profiles utilized in the main text .",
    "namely , the dimensionality of the resultant drift matrix grows with the number of targeted modes and that the greater sensitivity to the details of the spectra implies less robust performance across different systems .",
    "however , this sensitivity also facilitates fine control of the colored noise profile for very specific applications .",
    "in order to estimate the perturbation on the dynamical properties of a system caused by coupling to a colored noise thermostat one can study the behavior of a one - dimensional harmonic model . in this limit",
    ", microcanonical dynamical results in a @xmath71-function power spectrum peaked at the oscillator s characteristic frequency @xmath72 .",
    "the presence of the noise will modify the line shape of the peak , shifting its center and broadening it .",
    "a measure of these two effects can be used to estimate the magnitude of the disturbance .    to achieve this",
    ", one must consider the matrices @xmath73 and @xmath74 which describe the dynamics in the full @xmath75 space .",
    "@xcite one can then find the stationary covariance matrix @xmath76 by solving @xmath77 and compute the first order correlation matrix @xmath78 and its fourier transform , @xmath79_{ij}\\left[\\left(\\mathbf{c}_{qp}\\right)_{ii}\\left(\\mathbf{c}_{qp}\\right)_{jj}\\right]^{-1/2}.\\end{aligned}\\ ] ] the position and value at the maximum of the @xmath80 term can then be used to characterize the deformed peak .    when @xmath81 is built out of the @xmath82 canceling noise matrix in eq .",
    "( [ eq:3x3 ] ) and we set @xmath83 so as to consider the case of small disturbance on the low - frequency modes we obtain , @xmath84{3}\\sqrt{\\gamma\\tilde{\\omega } } & \\sqrt{\\gamma\\tilde{\\omega}}/\\sqrt[4]{3}\\\\ 0 & \\sqrt[4]{3}\\sqrt{\\gamma\\tilde{\\omega } } & \\sqrt{3}\\tilde{\\omega } & \\tilde{\\omega}\\\\ 0 & -\\sqrt{\\gamma\\tilde{\\omega}}/\\sqrt[4]{3 } & -\\tilde{\\omega } & 0\\end{array}\\right).\\end{aligned}\\ ] ] solving for @xmath80 we obtain      we then take @xmath47 to be much larger than all other frequencies entering our problem , and write them as a ratio with respect to @xmath47 , i.e. @xmath86 , @xmath87 , @xmath88 .",
    "one then finds the relevant extremal point , @xmath89 , and an estimate of the peak width as @xmath90 $ ] .",
    "this leads to expressions which can then be expanded in powers of @xmath72 , eventually yielding @xmath91 and @xmath92 \\nonumber\\end{aligned}\\ ] ]"
  ],
  "abstract_text": [
    "<S> multiple time scale molecular dynamics enhances computational efficiency by updating slow motions less frequently than fast motions . </S>",
    "<S> however , in practice the largest outer time step possible is limited not by the physical forces but by resonances between the fast and slow modes . in this paper </S>",
    "<S> we show that this problem can be alleviated by using a simple colored noise thermostatting scheme which selectively targets the high frequency modes in the system . for two sample problems , flexible water and solvated alanine dipeptide , we demonstrate that this allows the use of large outer time steps while still obtaining accurate sampling and minimizing the perturbation of the dynamics . </S>",
    "<S> furthermore , this approach is shown to be comparable to constraining fast motions , thus providing an alternative to molecular dynamics with constraints . </S>"
  ]
}