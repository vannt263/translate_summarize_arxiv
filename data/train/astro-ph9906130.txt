{
  "article_text": [
    "the quantitative analysis of stellar spectra is one of the most important tools of modern astrophysics .",
    "basically all our knowledge about structure and evolution of stars , and hence about galactic evolution in general , rests on the interpretation of their electromagnetic spectrum .",
    "the formation of the observed spectrum is usually confined to a very thin layer on top of the stellar core , the atmosphere .",
    "spectral analysis is performed by modeling the temperature and pressure stratification of the atmosphere and computing synthetic spectra which are then compared to observation .",
    "fitting synthetic spectra from a grid of models yields the basic photospheric parameters , effective temperature , surface gravity , and chemical composition .",
    "comparison with theoretical evolutionary calculations allows the derivation of stellar parameters like mass , radius and total luminosity .",
    "the so - called classical stellar atmosphere problem considers the transfer of electromagnetic radiation , released by interior energy sources , through the outermost layers of a star into free space by making three specific physical assumptions . at first",
    "it is assumed that the atmosphere is in hydrostatic equilibrium , thus , the matter which interacts with photons is at rest .",
    "second , the transfer of energy through the atmosphere is entirely due to photons , i.e.heat conduction and large scale convection are regarded as negligible ( so - called radiative equilibrium ) .",
    "the effectiveness of photon transfer depends on the total opacity and emissivity of the matter which are strongly state and frequency dependent quantities .",
    "they depend in detail on the occupation density of atomic levels which in turn are determined by the local temperature and electron density as well as by the radiation field , whose nature is non - local in character .",
    "the occupation of any atomic level is balanced by radiative and collisional population and de - population processes ( statistical equilibrium ; our third assumption ) , i.e.  the interaction of atoms with other particles and photons .",
    "mathematically , the whole problem consists of the solution of the radiation transfer equations simultaneously with the equations for hydrostatic and radiative equilibrium , together with the statistical equilibrium , or , rate equations .",
    "a stellar atmosphere is radiating into the circumstellar space and thus evidently is an open thermodynamic system , hence it can not be in thermodynamic equilibrium ( te ) and thus we can not simply assign a temperature .",
    "the `` local thermodynamic equilibrium '' ( lte ) is a working hypothesis which assumes te not for the atmosphere as a whole but for small volume elements . as a consequence ,",
    "the atomic population numbers are depending only on the local ( electron ) temperature and electron density via the saha - boltzmann equations .",
    "computing models by replacing the saha - boltzmann equations by the rate equations are called non - lte ( or nlte ) models .",
    "this designation is unfortunate because still , the velocity distribution of particles is assumed to be maxwellian , i.e.  we can still define a local temperature .",
    "nlte calculations are tremendously more costly than lte calculations , however , it is hard to predict if nlte effects are important in a specific problem",
    ". generally , nlte effects are large at high temperatures and low densities , which implies intense radiation fields hence frequent radiative processes and less frequent particle collisions which tend to enforce lte conditions .    relaxing the lte assumption leads to the classical model atmosphere problem , i.e.  solution of the radiation transfer equations assuming hydrostatic , radiative and statistical equilibrium .",
    "such models are applicable to the vast majority of stars .",
    "the numerical problem going from lte to realistic nlte models has only recently been solved and is the topic of this paper .",
    "we now have the tools in hand to consider non - classical models , which consider the radiation transfer in more general environments , for example in expanding stellar atmospheres .",
    "this is the topic of another paper in this volume @xcite .",
    "stellar atmosphere modeling has made significant progress within the recent years .",
    "this is based on the development of new numerical techniques for model construction as well as on the fact that reliable atomic data have become available for many species .",
    "of course these achievements go along with a strong increase of computing power . model atmospheres assuming lte have been highly refined by the inclusion of many more atomic and molecular opacity sources , however , elaborated numerical techniques for lte model computation are available for many years .",
    "the progress is most remarkable in the field of nlte model atmospheres .",
    "the replacement of the saha - boltzmann equations ( lte ) by the atomic rate equations ( nlte ) requires a different numerical solution technique , otherwise metal opacities can not be accounted for at all .",
    "such techniques were developed with big success during the last decade , triggered by important papers by cannon @xcite and scharmer @xcite .",
    "the accelerated lambda iteration ( ali ) is the basis of this development .",
    "combined with statistical methods we are finally able to compute so - called metal line blanketed nlte models ( considering many millions of spectral lines ) with a very high level of sophistication .    in this paper",
    "we discuss the basic ideas behind the new numerical methods for nlte modeling .",
    "at first we state the classical model atmosphere problem and describe the ali solution technique .",
    "we then focus on the nlte metal line blanketing problem and its solution by the introduction of the superlevel concept and statistical methods to treat the opacities ( opacity sampling and opacity distribution functions ) .",
    "finally we demonstrate successful applications of the new models by presenting a few exemplary case studies .",
    "in the following text we outline the general stellar atmosphere problem , but will discuss various details of numerical implementation as applied to our computer program pro2 .",
    "we assume plane parallel geometry , which is well justified for most stars because the atmospheres are thin compared to the stellar radius .",
    "the only parameters which characterize uniquely such an atmosphere are the effective temperature ( ) , which is a measure for the amount of energy transported through the atmosphere per unit area and time ( see eq.[nominal ] ) , the surface gravity ( @xmath0 ) , and the chemical composition .",
    "generalization to spherical symmetry to account for extended ( static ) atmospheres mainly affects the radiation transfer equation and is straightforward @xcite . to construct model atmospheres",
    "we have developed our program which solves simultaneously a set of equations that is highly coupled and non - linear . because of the coupling , no equation is determining uniquely a single quantity ",
    "all equations determine a number of state parameters .",
    "however , each of them is usually thought of as determining a particular quantity .",
    "these equations are :    * the radiation transfer equations which are solved for the ( angular ) mean intensities @xmath1 , on a pre - chosen frequency grid comprising @xmath2 points .",
    "the formal solution is given by @xmath3 , where @xmath4 is the source function as defined later ( eq.[source ] ) .",
    "although @xmath5 is written as an operator , one may think of @xmath5 as a _ process _ of obtaining the mean intensity from the source function . * the hydrostatic equilibrium equation which determines the total particle density @xmath6 . *",
    "the radiative equilibrium equation from which the temperature @xmath7 follows . * the particle conservation equation , determining the electron density @xmath8 . * the statistical equilibrium equations which are solved for the population densities @xmath9 of the atomic levels allowed to depart from lte ( nlte levels ) . * the definition equation for a fictitious massive particle density @xmath10 which is introduced for a convenient representation of the solution procedure .",
    "this set of equations has to be solved at each point @xmath11 of a grid comprising @xmath12 depth points .",
    "thus we are looking for solution vectors @xmath13 the complete linearization ( cl ) method @xcite solves this set by linearizing the equations with respect to all variables .",
    "the basic advantage of the ali ( or `` operator splitting '' ) method is that it allows to eliminate at the outset the explicit occurrence of the mean intensities @xmath14 from the solution scheme by expressing these variables by the current , yet to be determined , occupation densities and temperature .",
    "this is accomplished by an iteration procedure which may be written as ( suppressing indices indicating depth and frequency dependency of variables ) : @xmath15 this means that the actual mean intensity at any iteration step @xmath16 is computed by applying an approximate lambda operator ( alo ) @xmath17 on the actual ( thermal ) source function @xmath18 plus a correction term that is computed from quantities known from the previous iteration step .",
    "this correction term includes the exact lambda operator @xmath5 which guarantees the exact solution of the radiation transfer problem in the limit of convergence : @xmath3 .",
    "the use of @xmath5 in eq.[ali ] only indicates that a formal solution of the transfer equation is performed but in fact the operator is usually not constructed explicitly . instead",
    "a feautrier solution scheme @xcite or any other standard method can be employed to solve the transfer equation that is set up as a differential equation .",
    "the resulting set of equations for the reduced solution vectors @xmath19 is of course still non - linear .",
    "the solution is obtained by linearization and iteration which is performed either with a usual newton - raphson iteration or by other , much faster methods like the quasi - newton or kantorovich variants @xcite .",
    "the first model atmosphere calculations with the ali method were performed by werner @xcite .",
    "another advantage of the ali method is that the explicit depth coupling of the solution vectors eq.[psi1 ] through the transfer equation can be avoided if one restricts to diagonal ( i.e.  local ) approximate @xmath5-operators .",
    "then the solution vectors eq.[psi2 ] are independent from each other and the solution procedure within one iteration step of eq.[ali ] is much more straightforward .",
    "depth coupling is provided by the correction term that involves the exact solution of the transfer equation . the hydrostatic equation which also gives an explicit depth coupling ,",
    "may be taken out of the set of equations and can  as experience shows ",
    "be solved in between two iteration steps of eq.[ali ]",
    ". then full advantage of a local alo can be taken .",
    "the linearized system may be written as @xmath20 where @xmath21 is the current estimate for the solution vector at depth @xmath11 and @xmath22 is the correction vector to be computed .",
    "using a tri - diagonal @xmath17 operator the resulting system for @xmath22 is  like in the classical cl scheme  of block tri - diagonal form coupling each depth point @xmath11 to its nearest neighbors @xmath23 : @xmath24 the quantities @xmath25 are ( @xmath26 ) matrices where @xmath27 is the total number of physical variables , i.e. , @xmath28 , and @xmath29 is the residual error in the equations .",
    "the solution is obtained by the feautrier scheme . with starting values @xmath30 ) and @xmath31 we sweep from the outer boundary of the atmosphere inside and calculate at each depth : @xmath32 at the inner boundary we have @xmath33 and sweeping back outside we calculate the correction vectors , first @xmath34 and then successively @xmath35 . as already mentioned , the system eq.[tri ] breaks into @xmath12 independent equations @xmath36 ( @xmath37 ) when a local @xmath17 operator is used . the additional numerical effort to set up the subdiagonal matrices and matrix multiplications in the tri - diagonal case",
    "is outweighed by the faster global convergence of the ali cycle , accomplished by the explicit depth coupling in the linearization procedure @xcite .",
    "the principal advantage of the ali over the cl method becomes clear at this point .",
    "each matrix inversion in eq.[feau ] requires @xmath38 operations whereas in the cl method @xmath39 operations are needed . since the number of frequency points @xmath2 is much larger than the number of levels @xmath40 , the matrix inversion in the cl approach",
    "is dominated by @xmath2 .",
    "recent developments concern the problem that the total number of atomic levels tractable in nlte with the ali method described so far is restricted to the order of 250 , from our experience with pro2 .",
    "this limit is a consequence of the non - linearity of the equations , and in order to overcome it , measures must be taken in order to achieve a linear system whose numerical solution is much more stable .",
    "such a pre - conditioning procedure has been first applied in the ali context by werner & husfeld @xcite .",
    "more advanced work achieves linearity by replacing the @xmath5 operator with the @xmath41 operator ( and by judiciously considering some populations as `` old '' and some as `` new '' ones within an ali step ) which is formally defined by writing @xmath42 where the total opacity @xmath43 ( as defined in sect.[opa ] ) is calculated from the previous ali cycle .",
    "the advantage is that the emissivity @xmath44 ( sect.[opa ] ) is linear in the populations , whereas the source function @xmath45 is not .",
    "hence the new operator @xmath41 gives the solution of the transfer problem by acting on a linear function .",
    "this idea is based on rybicki & hummer @xcite who applied it to the line formation problem , i.e. restricting the set of equations to the transfer and rate equations and regarding the atmospheric structure as fixed .",
    "hauschildt @xcite generalized it to solve the full model atmosphere problem .",
    "in addition , splitting the set of statistical equations and solving it separately for each chemical element means that now many hundreds of levels per species are tractable in nlte .",
    "a very robust method and fast variant of the ali method , the ali / cl hybrid scheme , allows for the linearization of the radiation field for selected frequencies @xcite , but it is not implemented in pro2 .",
    "any numerical method requires a formal solution ( i.e.  atmospheric structure already given ) of the radiation transfer problem .",
    "the radiation transfer at any particular depth point can be described by the following equation , formally written for positive and negative @xmath46 ( which is the cosine of the angle between direction of propagation and outward directed normal to the surface ) separately , i.e.  for inward and for outward directional intensities @xmath47 with frequency @xmath48 : @xmath49.\\ ] ] @xmath50 is the optical depth ( which can be defined via the column mass @xmath51 that is used in the other structural equations and later introduced in sect.[defm ] by @xmath52 , with the mass density @xmath53 ) and @xmath54 is the local source function . introducing the feautrier variable @xmath55",
    "we obtain the second - order form @xcite : @xmath56.\\ ] ] we may separate the thomson emissivity term ( scattering from free electrons , assumed coherent , with cross - section @xmath57 ) from the source function so that @xmath58 where @xmath59 is the ratio of thermal emissivity to total opacity as described in detail below ( sect.[opa ] ) : @xmath60 . since the mean intensity is the angular integral over the feautrier intensity",
    "the transfer equation becomes @xmath61 thomson scattering complicates the situation by the explicit angle coupling but the solution can be obtained with the standard feautrier scheme . assuming complete frequency redistribution in spectral lines @xcite , no explicit frequency coupling occurs so that the parallel solution for all frequencies enables a very efficient vectorization on the computer .",
    "the following boundary conditions are used for the transfer equation . at the inner boundary where the optical depth is at maximum , @xmath62",
    ", we have @xmath63 where we specify @xmath64 from the diffusion approximation : @xmath65 @xmath66 is the planck function and @xmath67 the nominal ( frequency integrated ) eddington flux : @xmath68 with the stefan - boltzmann constant @xmath69 . at the outer boundary",
    "we take @xmath70 , assuming that @xmath71 is a linear function of @xmath51 for @xmath72 . since @xmath73 , it is not exactly valid to assume no incident radiation at the stellar surface .",
    "instead we specify @xmath74 after scharmer & nordlund @xcite : @xmath75\\ ] ] which follows from eq.[te ] assuming @xmath76 for @xmath77 .",
    "then we get @xmath78 the boundary conditions are discretized performing taylor expansions which yield second - order accuracy @xcite .",
    "the statistical equilibrium equations are set up according to @xcite .",
    "the number of atomic levels , ionization stages and chemical species , as well as all radiative and collisional transitions are taken from the input model atom supplied by the user ( sect.[atom ] ) .",
    "ionization into excited states of the next ionization stage is allowed for .",
    "dielectronic recombination and autoionization processes can also be included in the model atom .      as usual the atomic energy levels are ordered sequentially by increasing excitation energy , starting with the lowest ionization stage .",
    "then for each atomic level @xmath79 of any ionization stage of any species the rate equation describes the equilibrium of rates into and rates out of this level : @xmath80 the rate coefficients @xmath81 have radiative and collisional components : @xmath82 .",
    "radiative upward and downward rates are respectively given by : @xmath83 @xmath84 photon cross - sections are denoted by @xmath85 .",
    "@xmath86 is the boltzmann lte population ratio in the case of line transitions : @xmath87 , where the @xmath88 are the statistical weights .",
    "the lte population number of a particular level is defined relative to the ground state of the next ion , so that in the case of recombination from a ground state @xmath89 we have by definition @xmath90 with the saha - boltzmann factor @xmath91 where @xmath92 is the ionization potential of the level @xmath79 .",
    "care must be taken in the case of recombination from an excited level into the next low ion . then @xmath93 .",
    "dielectronic recombination is included following @xcite .",
    "assuming now that @xmath94 is a ground state of ion @xmath95 , then the recombination rate into level @xmath79 of ion @xmath96 via an autoionization level @xmath97 ( with ionization potential @xmath98 , having a negative value when lying above the ionization limit ) is : @xmath99 the reverse process , the autoionization rate , is given by : @xmath100 the oscillator strength for the stabilizing transition ( i.e.  transition i@xmath101c ) is denoted by @xmath102 , and @xmath103 is the mean intensity averaged over the line profile .",
    "the program simply takes @xmath104 from the continuum frequency point closest to the transition frequency , which is reasonable because the autoionization line profiles are extremely broad .",
    "the population of autoionization levels is assumed to be in lte and therefore such levels do not appear explicitly in the rate equations .",
    "the computation of collisional rates is generally dependent on the specific ion or even transition .",
    "several options , covering the most important cases , may be chosen by the user .",
    "the rate equation for the highest level of a given chemical species is redundant .",
    "it is replaced by the abundance definition equation .",
    "this equation simply relates the total population of all levels of a particular species to the total population of all hydrogen levels .",
    "summation over all levels usually includes not only nlte levels but also levels which are treated in lte , according to the specification in the model atom . denoting the number of ionization stages of species @xmath95 with @xmath105 , the number of nlte and lte levels per ion with @xmath106 and @xmath107 , respectively , we can write : @xmath108 = y_k \\left[\\sum_{i=1}^{nl(h)}n_{i}+\\sum_{i=1}^{lte(h)}n_{i}^{\\star}+n_p\\right ] .\\ ] ] on the right hand side we sum up all hydrogen level populations including the proton density @xmath109 , and @xmath110 is the number abundance ratio of species @xmath95 relative to hydrogen .",
    "we close the system of statistical equilibrium equations by invoking charge conservation .",
    "we denote the total number of chemical species with @xmath111 , the charge of ion @xmath112 with @xmath113 ( in units of the electron charge ) and write : @xmath114=n_e .\\ ] ]      we introduce a vector comprising the occupation numbers of all nlte levels , @xmath115 @xmath116 . then the statistical equilibrium equation is written as : @xmath117 the gross structure of the rate matrix @xmath118 is of block matrix form , because transitions between levels occur within one ionization stage or to the ground state of the next ion .",
    "the structure is complicated by ionizations into excited levels and by the abundance definition and charge conservation equations which give additional non - zero elements in the corresponding lines of @xmath119 .",
    "radiative equilibrium denotes the fact that the energy transport is exclusively performed by photons .",
    "it can be enforced by adjusting the temperature stratification either during the linearization procedure or in between ali iterations . in the former case a linear combination of two different formulations is used and in the latter case a classical temperature correction procedure ( unsld - lucy ) , generalized to nlte problems , is utilized .",
    "the latter is particularly interesting , because it allows to exploit the blocked form of the rate coefficient matrix .",
    "this will enable an economic block - by - block solution followed by a subsequent unsld - lucy temperature correction step .",
    "on the other side , however , this correction procedure may decelerate the global convergence behavior of the ali iteration .",
    "the two forms of writing down the radiative equilibrium condition follow from the postulation that the energy emitted by a volume element per unit time is equal to the absorbed energy per unit time ( integral form ) : @xmath120 where scattering terms in @xmath71 and @xmath45 cancel out .",
    "this formulation is equivalent to invoking flux constancy throughout the atmosphere ( differential form ) involving the nominal flux @xmath67 ( eq.[nominal ] ) : @xmath121 where @xmath122 is the variable eddington factor , defined as @xmath123 and computed from the feautrier variable @xmath124 ( eq.[udef ] ) after the formal solution .",
    "as discussed e.g.  in @xcite the differential form is more accurate at large depths , while the integral form behaves numerically better at small depths . instead of arbitrarily selecting that depth in the atmosphere where we switch from one formulation to the other",
    ", we use a linear combination of both constraint equations which guarantees a smooth transition with depth , based on physical grounds @xcite . before adding up both equations we have to take two measures . at first",
    "we divide eq.[int ] by the absorption mean of the opacity , @xmath125 , for scaling reasons : @xmath126 where @xmath127 is the true opacity without electron scattering . then we multiply eq.[diff ] with a similar average of the diagonal elements of the @xmath17 matrix : @xmath128 these two steps determine the relative weight of both equations in a particular depth .",
    "numerical experience shows that it is necessary to damp overcorrections by adding the following term , which is computed from quantities of the previous iteration step and which vanishes in the limit of convergence , to the right hand side of eq.[diff ] : @xmath129 we write the equation of radiative equilibrium in its final form : @xmath130 we note that explicit depth coupling is introduced by the differential form eq.[diff ] through the derivative @xmath131 even if a purely local @xmath17 operator is used .",
    "therefore the linearization procedure can no longer be performed independently at each depth point and the question becomes relevant at which boundary to start with .",
    "numerical experience shows that it is essential to start at the outer boundary and to continue going inwards .",
    "if a tri - diagonal operator is used , nearest neighbor depth coupling is introduced anyhow .",
    "the program user can choose either the linear combination eq.[combi ] or the purely integral form eq.[int ] , the latter may be necessary to start the iteration under certain circumstances . the linear combination ,",
    "however , is found to give a much faster convergence behavior .      closely following lucy @xcite ( but avoiding the eddington approximation and using variable eddington factors instead ) and generalizing to nlte one can derive for each depth point a temperature correction @xmath132 to be applied to the actual temperature in order to achieve flux constancy . using @xmath133 ,",
    "the zeroth momentum ( i.e.  angle averaged form ) of the radiation transfer eq.[te ] is : @xmath134 with @xmath135 from eq.[ali ] and the eddington flux @xmath136 . in the lte case with electron scattering",
    ", @xmath45 can be written as the sum of a thermal and a scattering contribution : @xmath137 in the nlte case we formally write in analogy : @xmath138 with quantities @xmath139 and @xmath140 which can be freely evaluated but which are not independent of each other , since @xmath140 must be expressed by @xmath141 in order to yield @xmath45 on the r.h.s .  of eq.[gamma ] . with this substitution eq.[zmrt ] reads : @xmath142 integrating over frequencies , the condition of flux conservation then reads : @xmath143 where we used the following definitions for @xmath144 , @xmath145 , and @xmath146 : @xmath147 @xmath148 since we can choose @xmath139 freely , we can define which opacities shall contribute , finally resulting in a favorable scaling of factors in eq.[lucy ] .",
    "usually we start with all processes included in @xmath139 to begin with moderate corrections .",
    "following hauschildt ( priv .",
    "one can optionally exclude bound - bound or bound - free transitions which is necessary if strong lines or continua dominate numerically the radiative equilibrium in optically thin regions .",
    "note that this measure does not affect the solution in the case of convergence , but only the convergence rate .",
    "without such an acceleration , the unsld - lucy procedure may run into pseudo - convergence .    integrating the first momentum of the radiation transfer equation over frequency we obtain : @xmath149 using eq.[zmrti ] and the depth integrated form of eq.[fmrti ] we proceed as described by lucy @xcite .",
    "we finally obtain , with frequency averaged eddington factors @xmath150 and @xmath151 as well as @xmath152 defined in analogy to eq.[mean ] , the temperature correction at any depth : @xmath153\\ ] ]    where @xmath154 is the difference between the actual and the nominal eddington flux . in practice",
    "it is useful to accelerate this procedure by extrapolating the last , say , ten corrections .",
    "the unsld - lucy procedure provides model atmospheres with a relative deviation from the flux constancy smaller than 10@xmath155 which is a factor of ten better when compared to the procedure employing eq.[diff ] . due to the decoupling of the temperature from the statistical equilibrium",
    "the unsld - lucy procedure is numerically much more stable allowing to calculate models which otherwise failed to converge .",
    "the price is a slower overall convergence of the ali iteration by a factor of two .",
    "we write the equation for hydrostatic equilibrium as @xcite : @xmath156 where @xmath0 is the surface gravity and @xmath51 the column mass .",
    "@xmath157 is the total pressure comprising gas , radiation and turbulent pressures , so that : @xmath158 with boltzmann s constant @xmath95 and the turbulent velocity @xmath159 .",
    "the hydrostatic equation may either be solved simultaneously with all other equations or separately in between iterations .",
    "the overall convergence behavior is usually the same in both cases .",
    "if taken into the linearization scheme and a local @xmath17 operator is used then , like in the case of the radiative equilibrium equation , explicit depth coupling enters via the depth derivative @xmath160 .",
    "again , solution of the linearized equations has to proceed inwards starting at the outer boundary . the starting value in the first depth point ( subscript @xmath161 ) is @xmath162 where @xmath163 is the variable eddington factor denoting the ratio of @xmath164 at the surface , kept fixed during linearization .      the total particle density @xmath6 is the sum of electron density plus the population density of all atomic states , lte and nlte levels",
    "we may write down the particle conservation equation in the following form that contains explicitly only the hydrogen population numbers : @xmath165 \\sum_{k=1}^{natom}y_k .\\ ] ]      a fictitious massive particle density @xmath10 is introduced for notational convenience .",
    "it is defined by @xmath166 the mass of a chemical species in amu is denoted by @xmath167 . introducing the mass of a hydrogen atom @xmath168 ,",
    "we may simply write for the material density @xmath169      thermal opacity and emissivity are made up by atomic radiative bound - bound , bound - free and free - free transitions . for each chemical species we compute and sum up : @xmath170 \\nonumber\\end{aligned}\\ ] ] where the total opacity includes thomson scattering , i.e.@xmath171 , and @xmath172 .",
    "\\nonumber\\end{aligned}\\ ] ] the first index of variables marked with two indices denotes the ionization stage and the second one denotes the ionic level .",
    "thus @xmath173 denotes the cross - section for photoionization from level @xmath79 of ion @xmath112 into level @xmath95 of ion @xmath174 .",
    "the double summation over the bound - free continua takes into account the possibility that a particular level may be ionized into more than one level of the next high ion .",
    "again , note the definition of the lte population number @xmath175 in this case , which depends on the level @xmath176 of the parent ion : @xmath177 note also , that the concept of lte levels ( whose population densities do enter , e.g.  the number or charge conservation equations ) in the atomic models of complex ions is therefore not unambiguous .",
    "the present code always assumes that lte levels in the model atoms are populated in lte with respect to the ground state of the upper ion .",
    "the source function used for the approximate radiation transfer is the ratio @xmath178 , thus , excludes thomson scattering . for the exact formal solution of course , the total opacity @xmath43 in the expression eq.[source ] includes the thomson term ( @xmath179 ) .",
    "as high - lying atomic levels are strongly perturbed by other charged particles in the plasma they are broadened and finally dissolved .",
    "this effect is observable by line merging at series limits and has to be accounted for in line profile analyses .",
    "moreover , line overlap couples the radiation field in many lines and flux blocking can strongly affect the global atmospheric structure .",
    "numerically , we treat the level dissolution in terms of occupation probabilities , which for lte plasmas can be defined as the ratio of the level populations to those in absence of perturbations . a phenomenological theory for these quantities",
    "was given in @xcite .",
    "the non - trivial generalization to nlte plasmas was performed by hubeny @xcite . in practice",
    "an individual occupation probability factor ( depending on @xmath180 , and principal quantum number ) , is applied to each atomic level which describes the probability that the level is dissolved .",
    "furthermore , the rate equations eq.[rates ] must be generalized in a unique and unambiguous manner .",
    "for details see @xcite . as an example",
    ", fig.[humi ] shows these occupation probabilities for hydrogen and helium levels as a function of depth in a white dwarf atmosphere .",
    "in all constraint equations described above the mean intensities @xmath104 are substituted by the approximate radiation field eq.[ali ] in order to eliminate these variables from the solution vector eq.[psi1 ] . in principle",
    "the approximate lambda operator may be of arbitrary form as long as the iteration procedure converges . in practice",
    "however an optimum choice is desired in order to achieve convergence with a minimum amount of iteration steps .",
    "the history of the alos is interesting and was summarized in detail by hubeny @xcite . of utmost importance were two papers by olson and collaborators @xcite who overcame the major drawback of early alos , namely the occurrence of free parameters controlling the convergence process , and who found the optimum choice of alos .",
    "our model atmosphere program enables the use of either a diagonal or a tri - diagonal alo , both are set up following @xcite .      in this case the mean intensity @xmath181 at a particular depth @xmath11 in the current iteration step is computed solely from the local source function @xmath182 and a correction term @xmath183 , the latter involving the source functions ( of all depths ) from the previous iteration . dropping the iteration count and introducing indices denoting depth points we can rewrite eq.[ali ] : @xmath184 in the discrete form we now think of @xmath17 as a matrix acting on a vector whose elements comprise the source functions of all depths .",
    "then @xmath185 is the diagonal element of the @xmath17 matrix corresponding to depth point @xmath11 .",
    "writing @xmath186 ( for numerical computation see eq.[matrix ] below ) we have a purely local expression for the mean intensity : @xmath187      much better convergence is obtained if the mean intensity is computed not only from the local source function but also from the source function of the neighboring depths points .",
    "then the matrix representation of @xmath17 is of tri - diagonal form and we may write @xmath188 where @xmath189 and @xmath190 represent the upper and lower subdiagonal elements of @xmath17 and @xmath191 the source functions at the adjacent depths . in analogy",
    "the correction term becomes @xmath192 again all quantities for the computation of @xmath183 are from the previous iteration and the first term denotes the exact formal solution of the transfer equation .",
    "we emphasize again that the actual source functions in eq.[trij ] are computed from the actual population densities and temperature which are unknown .",
    "we therefore have a non - linear set of equations which is solved by either a newton - raphson iteration or other techniques , resulting in the solution of a tri - diagonal linear equation of the form eq.[tri ] .",
    "as was shown in @xcite the elements of the optimum @xmath17 matrix are given by the corresponding elements of the exact @xmath5 matrix .",
    "the diagonal and subdiagonal elements are computed from @xcite : @xmath193 with @xmath194 . at large optical depths with increasing @xmath195 steps",
    "( the depth grid is equidistant in @xmath196 ) the subdiagonals @xmath190 and @xmath189 vanish and the diagonal @xmath197 approaches unity , resembling the fact that the radiation field is more and more determined by local properties of the matter . at very small optical depths all elements of @xmath17 vanish , reflecting the non - localness of the radiation field in this case .",
    "pro2 allows usage of an acceleration scheme to speed up convergence of the iteration cycle eq.[ali ] .",
    "we implemented the scheme originally proposed by ng @xcite .",
    "it extrapolates the correction vector @xmath22 from the previous three iterations . from our experience",
    "the extrapolation often yields over - corrections resulting in alternating convergence or even divergence . and usually the application of a tri - diagonal alo results in a satisfactorily fast convergence so that the acceleration scheme is rarely used .",
    "the complete set of non - linear equations for a single iteration step eq.[ali ] comprises at each depth the equations for statistical , radiative , and hydrostatic equilibrium and the particle conservation equation . for the numerical solution",
    "we introduce discrete depth and frequency grids .",
    "the equations are then linearized and solved by a suitable iterative scheme .",
    "explicit angle dependency of the radiation field is not required here and consequently eliminated by the use of variable eddington factors .",
    "angle dependency is only considered in the formal solution of the transfer equation .",
    "the program requires an input model atmosphere structure as a starting approximation together with an atomic data file , as well as a frequency grid .",
    "depth and frequency grids are therefore set up in advance by separate programs .",
    "a depth grid is set up by an auxiliary program which computes , starting from a gray approximation , a lte continuum model using the unsld - lucy temperature correction procedure . in this program depth",
    "points are set equidistantly on a logarithmic ( rosseland ) optical depth scale .",
    "the user may choose the inner and outer boundary points and the total number of grid points ( typically 90 ) .",
    "the converged lte model ( temperature and density structure , given on a column mass depth scale ) is written to a file that is read by pro2 .",
    "the nlte code uses the column mass as an independent depth variable .",
    "the frequency grid is established based upon the atomic data input file ( see sect.[atom ] ) .",
    "frequency points are set blue- and redward of each absorption edge and for each spectral line .",
    "gaps are filled up by setting continuum points .",
    "finally , the quadrature weights are computed .",
    "the user may change default options for this procedure .",
    "frequency integrals appearing e.g.in eq.[combi ] are replaced by quadrature sums and differential quotients involving depth derivatives by difference quotients .",
    "all variables @xmath198 are replaced by @xmath199 where @xmath200 denotes a small perturbation of @xmath198 .",
    "terms not linear in these perturbations are neglected .",
    "the perturbations are expressed by perturbations of the basic variables : @xmath201 as an illustrative example we linearize the equation for radiative equilibrium .",
    "most other linearized equations may be found in @xcite .",
    "assigning two indices ( @xmath11 for depth and @xmath79 for frequency of a grid with nf points ) to the variables and denoting the quadrature weights with @xmath202 eq.[combi ] becomes : @xmath203+\\delta\\chi{_{di}}[s{_{di}}-j{_{di } } ] )   } \\nonumber\\\\ & & + { \\bar\\lambda_j^\\star}\\sum_{i=1}^{nf }   \\frac{w_i}{\\delta\\tau_i}(\\delta j{_{di}}f{_{di}}-\\delta j{_{d-1,i}}f{_{d-1,i } } )   = f_0+{\\bar\\lambda_j^\\star}{\\cal h}- \\nonumber\\\\ & & \\sum_{i=1}^{nf}w_i\\frac{\\chi{_{di}}}{\\bar\\kappa_j}(s{_{di}}-j{_{di } } ) -{\\bar\\lambda_j^\\star}\\sum_{i=1}^{nf}\\frac{w_i}{\\delta\\tau_i}(f{_{di}}j{_{di}}-f{_{d-1,i}}j{_{d-1,i } } ) .\\end{aligned}\\ ] ] note that we do not linearize @xmath204 .",
    "because of this , convergence properties may be significantly deteriorated in some cases .",
    "perturbations @xmath205 are expressed by eq.[deltax ] , and the perturbation of the mean intensity @xmath206 is , according to eq.[trij ] , given through the perturbations of the source function at the actual and the two adjacent depths : @xmath207 where @xmath208 are the @xmath5 matrix elements from eq.[matrix ] .",
    "the @xmath209 involve the term @xmath210 which is neglected because we only want to account for nearest neighbor coupling .",
    "we write @xmath211 with the help of eq.[deltax ] and observe that for any variable @xmath212 @xmath213 derivatives of opacity and emissivity with respect to temperature , electron and population densities are computed from analytical expressions ( see e.g.@xcite ) .",
    "we finally get from eq.[lin ] : @xmath214 \\right.\\nonumber \\\\   & & \\left.+{\\bar\\lambda_j^\\star}\\sum_{i}^{nf}\\frac{w_i}{\\delta\\tau_i}(f{_{di}}b{_{di}}-f{_{d-1,i}}a{_{di } } ) \\frac{\\partial s{_{di}}}{\\partial t } \\right\\}+ \\nonumber\\\\   & & \\delta t{_{d+1,i}}\\left\\ { \\sum_{i}^{nf}-\\frac{w_i}{\\bar\\kappa_j } \\frac{\\partial s{_{d+1,i}}}{\\partial t}\\chi{_{di}}a{_{d+1,i}}\\right.\\nonumber \\\\ & & \\left .",
    "+ { \\bar\\lambda_j^\\star}\\sum_{i}^{nf}\\frac{w_i}{\\delta\\tau_i } ( f{_{di}}a{_{d+1,i}}-f{_{d-1,i}}b{_{d+1,i}})\\frac{\\partial s{_{d+1,i}}}{\\partial t } \\right\\}+ \\nonumber \\\\ & & \\delta n_{e_{d-1,i}}\\{\\cdots\\ }      + \\delta n_{e_{d , i}}\\{\\cdots\\ }      + \\delta n_{e_{d+1,i}}\\{\\cdots\\}+ \\nonumber \\\\ & & \\sum_{l=1}^{nl}\\delta n_{l_{d-1,i}}\\{\\cdots\\ }      + \\sum_{l=1}^{nl}\\delta n_{l_{d , i}}\\{\\cdots\\ }      + \\sum_{l=1}^{nl}\\delta n_{l_{d+1,i}}\\{\\cdots\\ } \\nonumber \\\\   &   & = { \\rm r.h.s.}\\end{aligned}\\ ] ] curly brackets @xmath215 denote terms that are similar to those multiplied with the perturbations of the temperature . instead of partial derivatives in respect to @xmath7 , they contain derivatives in respect to @xmath8 and the populations @xmath216 .",
    "they all represent coefficients of the matrices @xmath25 in eq.[tri ] .      as described in sect.[eins2 ]",
    "the linearized equations have a tri - diagonal block - matrix form , see eq.[tri ] .",
    "inversion of the grand matrix ( @xmath217 sized @xmath218 , i.e.  about @xmath219 in typical applications ) is performed with a block - gaussian elimination scheme , which means that our iteration of the non - linear equations represents a multi - dimensional newton - raphson method . the problem is structurally simplified when explicit depth coupling is avoided by the use of a local alo , however , the numerical effort is not much reduced , because in both cases the main effort lies with the inversion of matrices sized @xmath26 .",
    "the newton - raphson iteration involves two numerically expensive steps , first setting up the jacobian ( comprising @xmath25 ) and then inverting it .",
    "additionally , the matrix inversions in eq.[feau ] limit their size to about @xmath220 because otherwise numerical accuracy is lost .",
    "two variants recently introduced in stellar atmosphere calculations are able to improve both , numerical accuracy and , most of all , computational speed .",
    "broyden s variant @xcite belongs to the family of so - called quasi - newton methods and it was first used in model atmosphere calculations in @xcite .",
    "it avoids the repeated set - up of the jacobian by the use of an update formula . on top of this , it also gives an update formula for the _ inverse _ jacobian . in the case of a local alo the solution of the linearized system at any depth is @xmath221",
    "let @xmath222 be the @xmath95-th iterate of the inverse jacobian , then an update can be found from : @xmath223 where @xmath224 denotes the dyadic product and where we have defined : @xmath225 the convergence rate is super - linear , i.e.  slower than the quadratic rate of the newton - raphson method , but this is more than compensated by the tremendous speed - up for a single iteration step .",
    "it is not always necessary to begin the iteration with the calculation of an exact jacobian and its inversion .",
    "experience shows that in an advanced stage of the overall ( ali- ) iteration eq.[ali ] ( i.e.  when corrections become small , of the order 1% ) we can start the linearization cycle eq.[xxx ] by using the inverse jacobian from the previous overall iteration .",
    "computational speed - up is extreme in this case , however , it requires storage of the jacobians of all depths .",
    "more difficult is the application to the tri - diagonal alo case .",
    "here we have to update the grand matrix @xmath226 which , as already mentioned , is of block tri - diagonal form .",
    "we can not update their inverse , because it is never computed explicitly .",
    "furthermore we need an update formula that preserves the block tri - diagonal form which is a prerequisite for its inversion by the feautrier scheme eq.[feau ] .",
    "such a formula was found by schubert @xcite : @xmath227 where @xmath228 with the structure matrix @xmath229 as defined by : @xmath230 the vectors @xmath231 and @xmath232 are defined as above but now they span over the quantities of all instead of a single depth point . with this formula",
    "we obtain new submatrices @xmath25 and @xmath233 with which the feautrier scheme eq.[feau ] is solved again .",
    "this procedure saves the computation of derivatives .",
    "another feature realized in our program also saves the repeated inversion of @xmath234 by updating its inverse with the broyden formula eq.[xxx ] .",
    "similar to the diagonal alo case it is also possible to pass starting matrices from one overall iteration eq.[ali ] to the next for the update of @xmath235 and the matrix @xmath236 . in both cases",
    "the user specifies two threshold values for the maximum relative correction in @xmath237 which cause the program to switch from newton - raphson to broyden stages 1 and 2 . during stage 1 each new overall cycle eq.[ali ]",
    "is started with an exact calculation and inversion of all matrices involved and in stage 2 these matrices are passed through each iteration .",
    "another variant , the kantorovich method was recently introduced into model atmosphere calculations @xcite .",
    "it is more simple and straightforward to implement .",
    "this method simply keeps fixed the jacobian during the linearization cycle and it is surprisingly stable .",
    "in fact it turns out to be even more stable ( i.e.  it can be utilized in an earlier stage of iteration ) than the broyden method in the tri - diagonal alo case .",
    "the user of pro2 may choose this variant in two stages in analogy to the broyden variant .",
    "it was found that in the stage 2 it is necessary to update the jacobian , say , every 5 or 10 overall iterations in order to prevent divergence .",
    "despite the capacity increase for the nlte treatment of model atmosphere problems by introducing the ali method combined with pre - conditioning techniques , the blanketing by millions of lines from the iron group elements arising from transitions between some @xmath238 levels could only be attacked with the help of statistical methods .",
    "these have been introduced into nlte model atmosphere work by anderson @xcite . at the outset",
    ", model atoms are constructed by combining many thousand of levels into a relatively small number of superlevels which can be treated with ali ( or other ) methods .",
    "then , in order to reduce the computational effort , two approaches were developed which vastly decrease the number of frequency points ( and hence the number of transfer equations to be solved ) to describe properly the complex frequency dependence of the opacity .",
    "these two approaches have their roots in lte modeling techniques , where for the same reason statistical methods are applied for the opacity treatment : the opacity distribution function ( odf ) and opacity sampling ( os ) approaches . both are based on the circumstance that the opacity ( in the lte approximation ) is a function of two only local thermodynamic quantities .",
    "roughly speaking , each opacity source can be written in terms of a population density and a photon cross - section for the respective radiative transition : +    @xmath239     +   + in lte the population follows from the saha - boltzmann equations , hence @xmath240 .",
    "the os and odf methods use such pre - tabulated ( on a very fine frequency mesh ) @xmath241 during the model atmosphere calculations .",
    "the nlte situation is more complicated , because pre - tabulation of opacities is not useful .",
    "the population densities at any depth now also depend explicitly on the radiation field ( via the rate equations which substitute the te saha - boltzmann statistics ) and thus on the populations in each other depth of the atmosphere . as a consequence , the os and odf methods",
    "are not applied to opacity tabulations , but on tabulations of the photon cross - sections @xmath242 .",
    "these do depend on local quantities only , e.g.  line broadening by stark and doppler effects is calculated from @xmath7 and @xmath8 . in the nlte case",
    "the cross - section takes over the role which the opacity played in the lte case .",
    "so , strictly speaking , the designation os and odf is not quite correct in the nlte context .",
    "the strategy in our code is the following .",
    "before any model atmosphere calculation is started , the atomic data are prepared by constructing superlevels , and the cross - sections for superlines .",
    "then these cross - sections are either sampled on a coarse frequency grid or odfs are constructed .",
    "these data are put into the model atom which is read by the code .",
    "the code does not know if os or odfs are used , i.e.  it is written to be independent of any of these approaches .",
    "the large number of atomic levels in a single ionization stage is grouped into a small number of typically 1020 superlevels or , energy bands .",
    "grouping is performed by inspecting a level diagram ( fig.[levelfig ] ) which shows the number of levels ( times their statistical weight ) per energy bin as a function of excitation energy .",
    "gaps and peaks in this distribution are used to define energy bands .",
    "each of these bands is then treated as a single nlte level with suitably averaged statistical weight and energy .",
    "all individual lines connecting levels out of two distinct bands are combined to a band - band transition with a so - called complex photon cross - section .",
    "this cross - section essentially is a sum of all individual line profiles which however conserves the exact location of the lines in the frequency spectrum .",
    "this co - addition is performed once and for all and on a very fine frequency mesh to account for the profile shape of every line , before any model atmosphere calculation begins .",
    "these complex cross - sections ( examples are seen in the top panels of figs.[xfig ] and [ odffig ] ) are tabulated and later used to construct odfs or to perform os for the model calculations .",
    "= 9.1 cm    each of the model bands @xmath243 is treated as one single nlte level with an average energy @xmath244 and statistical weight @xmath245 which are computed from all the individual levels ( @xmath246 , @xmath247 ) within a particular band : @xmath248 where @xmath249 .",
    "@xmath250 is a characteristic temperature , pre - chosen and fixed throughout the model calculations , and at which the ionization stage in question is most strongly populated .",
    "energy levels of all iron group elements @xmath251 in the same ionization stage contribute to these model bands according to their abundance @xmath252 .",
    "all individual line transitions with cross - sections @xmath253 between two model bands @xmath243 and @xmath254 are combined to one complex band - band transition with a cross - section @xmath255 as described by : @xmath256 @xmath257 is the normalized profile of an individual line .",
    "this means that all individual lines are correctly accounted for in a sense that their real position within the frequency spectrum is not affected by the introduction of atomic model bands .",
    "the complex cross - sections ( each possibly representing many thousand individual lines ) are computed in _ advance _ of the model atmosphere calculations on a fine frequency grid with a resolution smaller than one thermal doppler width ( typically @xmath258 @xmath259 ) .",
    "this is done at two values for the electron density ( @xmath260 and @xmath261 ) and the nlte code accounts for depth dependent electron collisional broadening by interpolation .",
    "individual line photon cross - sections are represented by voigt profiles including stark broadening .",
    "collisional excitation rates between atomic model bands are treated with a generalized van regemorter @xcite formula : @xmath262 @xmath263 where @xmath264 $ ] .",
    "@xmath265 is the ionization potential of hydrogen ( in electron volts ) , @xmath266 is the first exponential integral and @xmath267 a constant depending on the ionic charge .",
    "the @xmath268 involve the f - values of all individual lines and they are computed together with the radiative cross - sections .",
    "third degree polynomials in @xmath269 are fitted to @xmath268 and the coefficients are written into the atomic input data file for the nlte code .",
    "photoionization cross - sections for iron group elements have numerous strong resonances that are difficult to deal with . as a first approximation one can calculate hydrogen - like cross - sections @xmath270 for the individual levels @xmath112 and combine them to a complex ionization cross - section for every model band : @xmath271 this cross - section is stored in a file and read by the code . other data to be used alternatively ( available e.g.  from the opacity project )",
    "may easily be prepared and stored in such a file by the user . for collisional",
    "ionization one may select seaton s @xcite formula with a mean ( hydrogen - like ) ionization cross - section .",
    "the os or , alternatively , odf approaches are introduced merely in order to save computing time during the model atmosphere calculations . in principle",
    "it is possible to proceed directly with the complex cross - sections constructed as described above .",
    "however , this would require a very fine frequency mesh over the entire spectrum in order to discretize the cross - sections in a similar detailed manner , resulting in some @xmath238 frequency points .",
    "since computation time scales linearly with the number of frequency points in the ali formalism , a reduction to some thousand or ten thousand points easily reduces the computational effort by an order of magnitude .",
    "opacity sampling is the more straightforward approach .",
    "the fine cross - section is sampled by a coarse frequency grid and the resulting coarse cross - section is used for the model calculation ( fig.[xfig ] ) .",
    "individual lines are no longer accounted for in an exact way , but this is not necessary in order to account for the line blanketing effects , i.e.  effects of metal lines on the global atmospheric structure like surface cooling and backwarming of deeper layers . a high resolution",
    "synthetic spectrum can be obtained easily after model construction by performing a single solution of the radiation transfer equation on a fine frequency mesh .",
    "= 9.1 cm    the quality of the sampling procedure can be checked by a quadrature of the cross - section on the frequency grid ( with weights @xmath272 ) : @xmath273 renormalization may be performed if necessary .",
    "this reduction of the cross - sections by sampling is also performed before the model calculations begin .",
    "the alternative way is the construction of opacity distribution functions ( or , more correctly , cross - section distribution functions ) .",
    "each complex cross - section is re - ordered in such a way that the resulting odf is a monotonous function ( see fig.[odffig ] , middle panel ) .",
    "the resulting smooth run of the cross - section over frequency can be approximated by a simple step function with typically one dozen of intervals .",
    "this cross - section is then fed into the model atmosphere code which can use a coarse frequency mesh to appropriately incorporate the odfs . in order to avoid unrealistic systematic effects , however ,",
    "the cross - section bins within each odf are re - shuffled randomly ( bottom panel of fig.[odffig ] ) .",
    "= 9.1 cm    many numerical tests concerning model atom construction with superlevels were performed by studying the effects of details in band definition and widths . also , the resulting model atmospheres using odf and os approaches were compared and generally , good agreement was found @xcite .",
    "all recent progress in stellar atmosphere modeling would have been impossible without the availability of atomic input data .",
    "major data sources were put at public disposal by the opacity project @xcite and the work by kurucz @xcite .",
    "these sources provide energy levels , transition probabilities , and bound - free photon cross - sections .",
    "the iron project @xcite is delivering electron collision strengths which are important for nlte calculations and which were hardly available up to now .",
    "we can not over - emphasize these vital contributions to our work .",
    "the atomic species that are to be included in the model atmosphere calculations are entirely determined by an atomic data input file . for each ionization stage of any chemical element",
    "the user defines atomic levels by the ionization potential and statistical weight and assigning a name ( character string ) to them .",
    "these level names are used to define radiative and collisional bound - bound and bound - free transitions among the levels as well as free - free opacities .",
    "the declaration of such transitions is generally complemented by a number which specifies the formula which pro2 shall use to calculate cross - sections for the rates and opacities .",
    "depending on the formula chosen by the user , additional input data are occasionally expected , such like oscillator strengths or line broadening data .",
    "alternatively , photon cross - sections for lines and continua may be read from external files whose names need to be declared with the definition of the transitions .",
    "construction of model atoms involving large datasets , e.g.  from the opacity project , is automated and requires a minimum of work by the user .",
    "the interested reader is referred to a comprehensive user s guide for pro2 available from the authors @xcite .",
    "one important motivation for developing and applying the ali method for stellar atmospheres was the unsolved problem of nlte metal line blanketing in hot stars .",
    "we want to focus here on two topics which highlight the successful application of the new models . the first concerns the balmer line problem which until recently appeared to be a fundamental drawback of nlte models .",
    "the second example describes the abundance determination of iron group elements in evolved compact stars by constructing self - consistent models which can reproduce simultaneously the observed spectral properties of white dwarfs and subdwarf o stars ( sdo ) from the optical region through the extreme ultraviolet regime .",
    "fitting synthetic profiles to observed balmer lines is the principal ingredient of most spectroscopic analyses .",
    "the so - called balmer line problem represents the failure to achieve a consistent fit to the hydrogen balmer line spectrum of any hot sdo star whose effective temperature exceeds about 70000k .",
    "results of  determinations drastically differ , up to a factor of two , depending on which particular line is fitted .",
    "this problem was uncovered a few years ago during nlte analyses of very hot subdwarfs and central stars of planetary nebulae @xcite . since then",
    ", it cast severe doubt upon nlte model atmosphere analysis techniques as a whole . with new available models computed with the ali method we were able to demonstrate that the problem is due to the neglect or improper inclusion of metal opacities @xcite .",
    "we showed that the balmer line problem can be solved when surface cooling by photon escape from the stark wings of lines from the c , n , o elements is accounted for ( see figs.[tempfig ] and [ bd28fig ] ) .      the optical spectra of hot white dwarfs and sdo stars are dominated by helium and/or hydrogen lines .",
    "metals are highly ionized and their spectral lines are almost exclusively located in the uv and extreme uv regions .",
    "high resolution spectroscopy with the international ultraviolet explorer ( iue ) has revealed a wealth of spectral features from iron and nickel which , however , could not be analyzed because of the lack of appropriate nlte calculations .",
    "first attempts for quantitative analyses were performed with line formation calculations on pre - specified temperature and pressure model structures which in turn were obtained from simplified lte or nlte models , i.e.  disregarding metal line blanketing effects @xcite .",
    "subsequently fully line blanketed lte models were employed , however , nlte effects turned out to be non - negligible @xcite .",
    "our latest models @xcite include 1.5 million lines from the iron group elements , which are taken from kurucz s @xcite line list . as an example for the quality of the fits we can achieve , fig.[feige67fig ] shows a portion of the uv spectrum of the sdo star feige  67 and the best fitting model .",
    "the derived abundances suggest that radiative levitation is responsible for the extraordinarily high heavy element abundances in these stars .",
    "we have described in detail the numerical solution of the classical model atmosphere problem .",
    "the construction of metal line blanketed models in hydrostatic and radiative equilibrium under nlte conditions was the last and long - standing problem of classical model atmosphere theory and it is finally solved with a high degree of sophistication .",
    "application of these models leads to highly successful analyses of hot compact stars .",
    "spectral properties from the extreme uv through the optical region are for the first time correctly reproduced by these models .",
    "the essential milestones for this development , starting from the pioneering work of auer & mihalas @xcite are :    * introduction of the accelerated lambda iteration ( ali , or `` operator splitting '' methods ) , based upon early work by cannon @xcite and scharmer @xcite .",
    "first ali model atmospheres were constructed by werner @xcite . *",
    "introduction of statistical approaches to treat the iron group elements in nlte by anderson @xcite .",
    "* computation of atomic data by kurucz @xcite , by the opacity project @xcite and subsequent improvements , and by the iron project @xcite .",
    "we would like to thank wolf - rainer hamann , ulrich heber , ivan hubeny and thomas rauch for discussions , help , and contributions when we developed the pro2 code .",
    "we thank ivan hubeny for carefully reading the manuscript , which helped to improve this paper .",
    "this work was funded during the recent years by the dfg and dara / dlr through several grants .",
    "werner k. , rauch t. , dreizler s. 1998 , a user s guide for the pro2 nlte model atmosphere program package , internal report , institut fr astronomie und astrophysik , universitt tbingen ( http://astro.uni-tuebingen.de/ )"
  ],
  "abstract_text": [
    "<S> we introduce the classical stellar atmosphere problem and describe in detail its numerical solution . </S>",
    "<S> the problem consists of the solution of the radiation transfer equations under the constraints of hydrostatic , radiative and statistical equilibrium ( non - lte ) . </S>",
    "<S> we outline the basic idea of the accelerated lambda iteration ( ali ) technique and statistical methods which finally allow the construction of non - lte model atmospheres considering the influence of millions of metal absorption lines . </S>",
    "<S> some applications of the new models are presented . </S>"
  ]
}