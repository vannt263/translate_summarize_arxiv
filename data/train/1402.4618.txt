{
  "article_text": [
    "mean field models are a standard tool in physics when analyzing a large number of particles , where an individual particle has negligible impact upon the ensemble .",
    "similar models are the foundation of competitive equilibrium theory in economics , and mean field models are increasingly popular in control theory @xcite .",
    "the present work considers application to distributed control , inspired by numerical results in our prior work @xcite on automated demand response for a large collection of loads . the goal was to obtain _ ancillary service _ to help regulate the power grid , as in many prior works @xcite .",
    "the paper @xcite focused on a large population of `` on - off '' loads , with special attention to residential pool pumps .",
    "the normal operation of a pool pump was modeled as a markov decision process , which included as an exogenous input a regulation signal from a balancing authority .",
    "this resulted in an input - output system with input equal to the regulation signal , and output equal to the number of pools in operation . in the numerical example considered , the control system had some very attractive properties : its linearization was stable , and simulations of one million pools resulted in behavior very closely matched to the deterministic linear model obtained from linearization of the markovian dynamics .",
    "most important was the finding that the linearization was _",
    "minimum phase_. this is a valuable property in any control system .    in this paper we set out to see why these conclusions might be expected in greater generality .    to explain the goals of the paper we take a high - level look at the prior work @xcite",
    ". shown in is a state transition diagram for the discrete - time markovian model considered in @xcite . the variables @xmath5 and",
    "@xmath6 indicate the probability of turning a pool pump on ( respectively , off ) , which depends upon how long the pool has been off ( respectively , on ) .",
    "a continuous time counterpart is described by a model on a continuous state space ,",
    "@xmath7 if @xmath8 , this means that the pool pump has been operating for exactly @xmath9 seconds . if @xmath10 , this implies that the pump was turned on at time @xmath11 .",
    "the differential generator for this markovian model is defined for functions @xmath12 that are differentiable in their second variable .",
    "there are functions @xmath13 and @xmath14 such that for any such @xmath15 , @xmath16 + \\frac{\\partial}{\\partial \\tau } f\\ , ( \\oplus,\\tau ) , \\qquad \\quad\\\\   \\hfill x= ( \\oplus,\\tau ) \\\\[.2 cm ] q^\\oplus(\\tau ) [ f(\\oplus,0 ) - f(\\ominus,\\tau ) ] + \\frac{\\partial}{\\partial \\tau } f\\ , ( \\ominus,\\tau ) , \\\\ \\hfill x= ( \\ominus,\\tau ) \\end{cases}\\ ] ] hence @xmath17 is the _ jump rate _ to the on - state , for a pool that has been off for @xmath9 seconds .    in this prior work",
    "the markovian dynamics were controlled through a signal @xmath1 that is broadcast to all pools .",
    "for this continuous time model , the jump rates would be modified by this signal . with @xmath18 pools , on letting @xmath19",
    "denote the state of the @xmath20th pool , the following limit is shown to hold under mild assumptions : @xmath21 if @xmath22 denotes the transformed generator at time @xmath23 , then the limit is the solution to the differential equation , @xmath24 this means that for functions @xmath15 satisfying the conditions above , @xmath25 the output is defined by a linear function of @xmath26 : for a function @xmath27 , @xmath28 the coupled equations ( [ e : mustate],[e : muoutput ] ) describe a nonlinear input - output model of the form considered in this paper .",
    "the input @xmath29 and output @xmath30 are assumed to be real - valued .    because is linear in the `` state '' @xmath26 , and",
    "is also linear in @xmath26 , it is easy to obtain a linearized model given some structure on the controlled generator .",
    "the question addressed in this paper is , _",
    "why should the linearized system have good properties for the purposes of control _ ?",
    "we address this question for models in continuous time , since the analysis is most elegant in this setting . while many of the results in this paper can be extended to a general state space setting , for the remainder of the paper we restrict to a finite state space , @xmath31 .",
    "the family of generators @xmath32 is a collection of @xmath33 matrices , which are assumed to be a smooth function of the scalar parameter @xmath34 .",
    "the linear model is intended to approximate the nonlinear model near an equilibrium . to define the equilibrium we let @xmath35 denote an invariant probability measure for the markov process with generator @xmath36 .",
    "this satisfies the invariance equation , @xmath37 for the nonlinear model , if @xmath38 and if @xmath39 , then @xmath40 for all @xmath23 .",
    "the linear model evolves according to the @xmath41-dimensional linear state space equations , @xmath42 the @xmath20th component of @xmath43 is intended to approximate @xmath44 .",
    "the @xmath33 matrix @xmath45 is the transpose of @xmath46 .",
    "the @xmath41-dimensional row vector @xmath47 has components @xmath48 where @xmath49 .",
    "the output @xmath50 is intended to approximate @xmath51 .    letting @xmath52 denote the derivative of @xmath53 with respect to @xmath34 , evaluated at @xmath54 , the @xmath41-dimensional column vector @xmath55 can be expressed , @xmath56    the transfer function for this model is @xmath57^{-1}b$ ] , @xmath58 .",
    "the minimum phase condition means that all zeros of @xmath3 lie in the strict left half plane . in this paper",
    "we establish a stronger condition on the transfer function : under the assumption that the nominal markov model is _",
    "reversible _ , the linear dynamics satisfy the _ positive real _ condition , @xmath59    we obtain positivity by establishing the following identity , @xmath60 where the right hand side denotes the power spectral density for @xmath61 with @xmath62 the stationary markov process with generator @xmath63",
    ".    the positive real condition is established only when the family of generators is constructed using the optimal control approach described in .",
    "this recalls a similar result from linear optimal control theory , where it is known that the positive real condition holds for a certain transfer function , provided the system is controlled using state feedback based on linear - quadratic optimal control @xcite .",
    "we do not know if there is any connection between the main results of this paper , and these celebrated results from linear control theory .",
    "the remainder of the paper is organized as follows : contains an extension of todorov s optimal control framework to markovian models in continuous time .",
    "this is the basis of the mean - field model in , and the main result that establishes the identity .",
    "an example is given to show that reversibility of the nominal model is necessary in general .",
    "conclusions and discussion are contained in .",
    "here we describe a stochastic optimal control problem in which the input is completely unconstrained .",
    "the optimization criterion will include a scalar weighting term @xmath34 .",
    "the optimal solution will define the generator @xmath64 that is used in the mean field analysis that follows .",
    "we consider a model in continuous time , with finite state space @xmath31 .",
    "the optimization is based on a _ nominal _ markov process on this state space .",
    "its generator ( i.e. , rate matrix ) is defined for functions @xmath12 via , @xmath65\\ , , \\quad x\\in\\state .",
    "\\label{e : gendef } \\end{aligned}\\ ] ] the transition semigroup is the exponential , @xmath66 , @xmath67 .",
    "the markov process is assumed to be irreducible , so that there is a unique invariant probability measure @xmath35 : interpreted as a row vector , it satisfies @xmath68 and @xmath69 for @xmath67 .",
    "for fixed @xmath70 and fixed initial condition @xmath71 , let @xmath72 denote the probability distribution for the stochastic process @xmath73 for the nominal model .",
    "this is an unusual stochastic control problem because there is no explicit `` input '' .",
    "any modification @xmath74 of @xmath72 is permitted .",
    "a particular optimization objective will ensure that an optimal solution is markovian .",
    "it is assumed that a utility function @xmath27 is given , that represents some benefit as a function of state .",
    "the cost of deviation @xmath75 is defined by kullback - leibler divergence , denoted @xmath76 .",
    "the @xmath70-stage welfare is defined as the difference , @xmath77 -d(p \\| p^0)\\ ] ] where in the expectation @xmath73 is distributed according to @xmath74",
    ". the maximizer exists , and is denoted @xmath78 ( or @xmath79 when the time horizon is emphasized ) .",
    "the parameter @xmath34 is a real scalar . for notational simplicity , until we take @xmath80 .    before proceeding with the formula for @xmath78 , it is helpful to recall the definition of divergence in this sample - path setting .",
    "we let @xmath81 denote the sigma algebra generated by the stochastic process @xmath82 .",
    "a log - likelihood ratio is interpreted as an @xmath81-measurable random variable : if @xmath74 admits a log likelihood ratio @xmath83 , this means that for any @xmath81-measurable random variable @xmath84 we can write , @xmath85 = \\expect[e^l f ] \\label{e : likely}\\ ] ] where the expectation on the left is under @xmath74 , and the expectation on the right is under @xmath72 ( the subscript is not used for the nominal model ) .",
    "the k - l divergence is then defined to be , @xmath86\\ ] ] if @xmath83 does not exist , then @xmath87 .",
    "[ t : checkp ] suppose that the nominal model is irreducible , and that @xmath71 is specified .",
    "then @xmath79 is unique , and is given by the twisted ( or ` tilted ' ) distribution that is uniquely defined by the log likelihood ratio , @xmath88 the optimal welfare @xmath89 coincides with the constant @xmath90 appearing in , which is equal to the cumulative log - moment generating function , @xmath91\\bigr ) \\label{e : lambdanorm1}\\ ] ] where the expectation is w.r.t .  the nominal model .",
    "optimality of @xmath78 ( with log likelihood ratio ) is a consequence of kullback s inequality ( see eqn ( 4.5 ) of @xcite ) .",
    "see also theorem 3.1.2 of @xcite for a version of this result on a finite probability space .",
    "the papers @xcite contain more background and other applications of this result .",
    "an explicit value for the optimal welfare follows : we have , @xmath92 = -\\lambda^*_t   + \\expect_{p^*}\\bigl[\\int_0^t \\util(x_t)\\ , dt\\bigr]\\ ] ] and consequently , @xmath93    the formula follows from the fact that @xmath94 defines a probability distribution : @xmath95= e^{-\\lambda^*_t}\\expect \\bigl [ \\exp\\bigl(\\int_0^t   \\util(x_t ) \\ ,",
    "dt\\bigr ) \\bigr ] \\label{e : lambdanorm}\\ ] ] @xmath96    while the optimal probability measure @xmath97 is markovian , it is not time - homogeneous .",
    "we now consider an infinite horizon optimization problem : find a markov process for which the associated family of distributions @xmath98 , with initial condition @xmath71 , attains the limit , @xmath99 this has a solution defined by a time - homogeneous markov process , whose generator is denoted @xmath100 .",
    "its construction is based on the solution to an eigenvector problem : let @xmath101 denote the diagonal matrix @xmath102 , and let @xmath103 denote a non - trivial solution to the eigenvector problem , @xmath104 v = \\lambda v \\label{e : evector}\\ ] ] where @xmath105 is the eigenvalue of @xmath106 with maximal real - part ( the perron - froebenius eigenvalue @xcite ) .",
    "[ t : checkgenerate ] the following hold under the assumptions of :    @xmath107 ; the eigenvalue appearing in .",
    "the generator for the markov process that attains the optimal average welfare @xmath108 is obtained by normalizing @xmath106 , and applying a similarity transformation using @xmath109 : @xmath110\\ind_{v } \\label{e : cgenerate}\\ ] ]    for each @xmath70 , the welfare for the distribution @xmath111 is given by , @xmath112\\ ] ] @xmath96    the eigenvector equation implies that @xmath113 for all @xmath114 , as required for a markovian generator .    part ( i )",
    "is essentially known : from it follows that @xmath108 is the multiplicative - ergodic limit , @xmath115   \\bigr ) \\label{e : cinftylambda}\\ ] ] the right hand side is denoted @xmath116 in @xcite , where it is shown in far greater generality that the multiplicative - ergodic limit @xmath116 coincides with the eigenvector @xmath105 .    the proof that @xmath117 and the proof of the remaining claims of the theorem will follow from a representation of the markov process with generator @xmath100 .",
    "let @xmath118 denote the probability measure on sample paths , with given initial condition @xmath71 . for finite @xmath70 , if @xmath84 is an @xmath81-measurable functional then , for the markovian model with generator @xmath100 we have ( exactly as in ) , @xmath119 = \\expect\\bigl [ e^{\\cl_t}f\\bigr]\\ ] ] where the expectation is with respect to @xmath72 , and @xmath120\\ , dt\\ ] ] using the fact that @xmath111 is a probability distribution gives , @xmath121= e^{-\\lambda",
    "t}\\expect \\bigl [   \\frac{v(x_t)}{v(x_0 ) }   \\exp\\bigl(\\int_0^t   \\util(x_t ) \\ , dt\\bigr ) \\bigr]\\ ] ] the identity @xmath122 follows : since @xmath123 is strictly positive and finite - valued , it follows that @xmath118 is infinite - horizon optimal : @xmath124 this establishes ( ii ) .",
    "given the formula for @xmath125 , the total welfare at time @xmath70 using @xmath118 is thus , @xmath126 -d(\\cp_t \\| p^0_t ) \\\\    & =   - \\expect\\bigl[\\log\\bigl ( \\frac{v(x_t)}{v(x_0 ) } \\bigr )   \\bigr ]   + \\lambda t \\end{aligned}\\ ] ] which establishes ( iii ) . @xmath96",
    "up to now we have only two generators : the nominal generator @xmath63 , and its transformation obtained as the solution to an optimal control problem .",
    "we next construct a parameterized family of generators denoted @xmath32 .",
    "for each @xmath34 , this is obtained as the infinite - horizon optimal control solution of the previous section , with the finite - horizon welfare defined in . if @xmath54 then @xmath127 . for arbitrary @xmath34 ,",
    "the generator @xmath64 that solves the infinite - horizon optimal control problem is of the form , in which @xmath128 is a solution to the eigenvector problem , @xmath129 v_\\zeta = \\lambda_\\zeta v_\\zeta \\label{e : evectorz}\\ ] ] where @xmath130\\ ] ]    the solutions to are used to define the continuous family of generators , @xmath131\\ind_{v_\\zeta } $ ] , or componenet - wise , @xmath132 @xmath133 \\label{e : cgenerate - zeta}\\ ] ]    the mean field model is the nonlinear state space model defined by , which in this finite state space setting becomes , @xmath134 recall that @xmath35 denotes the unique invariant probability measure for the nominal model .",
    "the nominal model is called reversible if the detailed - balance equations hold : @xmath135    [ t : reversiblepassive ] suppose that the nominal model is reversible",
    ". then its linearization satisfies , @xmath136 where @xmath137^{-1}b$ for $ s\\in\\co$. } \\label{e : g}\\ ] ]    the proof of the proposition involves a sequence of steps .",
    "the first steps are contained in : the power spectral density for @xmath138 can be expressed in terms of the family of _ resolvent matrices _ for the markov process , and these can be interpreted as a component of the transfer function @xmath3 .",
    "the formula is based on these results , and a closer look at the linearization contained in , which closes with a proof of .    before proceeding with these technical arguments",
    ", we give an example to show that the positive real condition may not hold if the nominal model is not reversible .",
    "moreover , this example shows that without reversibility , the linearization may not be minimum phase .",
    "consider the markov chain with eight states , whose transition diagram and generator are shown in .",
    "this markov process can not be reversible because some transitions are uni - directional .",
    "for example , an immediate transition from @xmath139 to @xmath140 is possible , but not from @xmath140 to @xmath139 .    in the notation of this paper",
    "we have @xmath141 , and we take @xmath142 for @xmath143 . the utility function @xmath27 is taken to be @xmath144 .    shown in is a nyquist plot for the transfer function @xmath145^{-1 } b$ ] with @xmath146 and @xmath147 .",
    "the nyquist plot shows that the system is not positive real . a pole - zero plot ( not shown )",
    "reveals that the system is not minimum phase : there is a zero in the right half plane , at approximately @xmath148 .",
    "this example demonstrates that the positive real condition obtained in requires assumptions on the nominal model .",
    "reversibility is used to obtain the identity that implies the positive real condition .",
    "we know of no alternate assumptions that imply the positive - real condition .",
    "the family of resolvent matrices are defined for @xmath58 by the integral , @xmath149 this is well defined whenever @xmath150 .",
    "it can be shown using ( or the representation @xmath151 ) that the resolvent equation holds @xmath152 ; equivalently , @xmath153^{-1 }   \\label{e : rsgen}\\ ] ] we already see that this forms a component of @xmath154 in ( recall that @xmath155 ) .",
    "consequently , for each @xmath156 satisfying @xmath150 , @xmath157^{-1}b = b^\\transpose [ is - a^\\transpose]^{-1}c^\\transpose = b^\\transpose r_s c^\\transpose   \\label{e : gr}\\ ] ] based on this identity , the following result shows that the frequency response is similar to a cross - power spectral density :    [ t : ginterpret ] the frequency response for the transfer function with @xmath155 can be expressed , for @xmath158 , by @xmath159\\ , dt\\ ] ] where @xmath160 and @xmath161 , @xmath162 .",
    "the proof begins with the representation , which holds by definition whenever @xmath150 . from the definition of the resolvent matrix , gives , @xmath163\\ , dt    \\\\ &",
    "= \\int_0^\\infty e^{-s t } \\expect_\\pi[f(x_0 ) g(x_t)]\\ , dt    \\end{aligned}\\ ] ] where the final equality follows from the definition of @xmath15 and  @xmath164 .    to complete the proof we must extend to @xmath165 , for which @xmath166 . for this",
    "we note that @xmath167 , so that @xmath168 = 0 , $ ] where the convergence rate is exponential .",
    "@xmath96      to apply prop .",
    "[ t : ginterpret ] we require a representation of the matrix @xmath55 defined in . for this",
    "we normalize the eigenvector so that @xmath169 for all @xmath34 ; this is without loss of generality since the components @xmath170 of the generator are defined in terms of the ratio @xmath171 .",
    "let @xmath172 denote the solution to poisson s equation , @xmath173 with boundary condition @xmath174 . for a finite - state space markov process",
    ", one solution to poisson s equation is given by @xmath175\\ , dt , \\quad",
    "x\\in\\state \\label{e : fishpi0}\\ ] ] and then we take @xmath176 , @xmath114 .",
    "let @xmath177 denote the generator for the time - reversed process , @xmath178    [ t : b ] the entries of @xmath55 are given by , @xmath179\\ ] ] if the process is reversible , then @xmath180 .",
    "@xmath96    to prove the proposition we first need the following formulae for the derivatives of @xmath181 and @xmath182 .",
    "we omit the proof , which is similar to the discrete - time case @xcite .",
    "[ t : hder ] the log - moment generating function has derivative at the origin given by , @xmath183 the derivative of the eigenvector is the solution to poisson s equation , @xmath184 @xmath96    [ [ proof - of ] ] proof of + + + + + + + + +    applying the lemma to gives , for all @xmath185 , @xmath186 \\generate ( x^i , x^j ) [ 1 + \\zeta h_0(x^j ) ] \\\\ &   \\quad +   [ \\zeta \\util(x^i )    - \\lambda_\\zeta ] \\ind\\{x^i = x^j\\ } + o(\\zeta )    \\\\    & =   [ 1- \\zeta h_0(x^i ) ] \\generate ( x^i , x^j ) [ 1 + \\zeta h_0(x^j ) ] \\\\    & \\quad +   \\zeta [ \\util(x^i ) - \\ynom ] \\ind\\{x^i = x^j\\ }      + o(\\zeta ) \\end{aligned}\\ ] ] from the definition @xmath187 ( see ) , we conclude that the derivative is given by , @xmath188 the entries of the matrix @xmath55 are thus given by , @xmath189 where in the second identity we used the invariance equation , @xmath190 .",
    "the second identity is equivalent to the desired representation .",
    "[ [ proof - of-1 ] ] proof of + + + + + + + + +    tells us that under reversibility we have @xmath191 , and hence in the notation of , @xmath192 and then give , @xmath193\\ , dt    \\\\ & = 2\\int_0^\\infty e^{-j\\omega t } \\expect_\\pi[\\tilutil(x_0 ) \\tilutil(x_t)]\\ , dt    \\end{aligned}\\ ] ] thus follows : @xmath194\\ , dt    \\\\ & =   \\int_{-\\infty}^\\infty e^{-j\\omega t } \\expect_\\pi[\\tilutil(x_0 ) \\tilutil(x_t)]\\ , dt    \\end{aligned}\\ ] ] @xmath96",
    "this paper gives a general condition under which the linearization of a mean field model is positive - real .",
    "the linearization around @xmath54 is a natural choice , but the main result of the paper can be extended to any constant value : if @xmath195 is reversible , then so is @xmath64 for each fixed @xmath0 .",
    "based on this observation , it is possible to show that the linearization about any fixed value of @xmath196 is positive real under the assumptions of .",
    "this suggests an open question : is the nonlinear model with state equation passive ?",
    "passivity would be a valuable property for the purposes of control .",
    "there are many open questions in the context of design .",
    "can we obtain more general sufficient conditions for the positive real condition , the weaker minimum phase condition , or the stronger passivity condition for the nonlinear model ?",
    "m.  huang , p.  e. caines , and r.  p. malhame .",
    "large - population cost - coupled lqg problems with nonuniform agents : individual - mass behavior and decentralized @xmath197-nash equilibria .",
    ", 52(9):15601571 , 2007 .",
    "i.  kontoyiannis and s.  p. meyn .",
    "spectral theory and limit theorems for geometrically ergodic markov processes . , 13:304362 , 2003 . i.  kontoyiannis and s.  p. meyn .",
    "large deviations asymptotics and the spectral theory of multiplicatively regular markov processes . , 10(3):61123 ( electronic ) , 2005 .",
    "z.  ma , d.  callaway , and i.  hiskens . decentralized charging control for large populations of plug - in electric vehicles : application of the nash certainty equivalence principle . in _",
    "control applications ( cca ) , 2010 ieee international conference on _ , pages 191195 , 2010 .",
    "s.  meyn , p.  barooah , a.  bui , y.  chen , and j.  ehren .",
    "ancillary service to the grid using intelligent deferrable loads . , 2014 .",
    "based on the invited paper published in the _ proceedings of the 52nd ieee conf . on decision and control _ ,",
    "pages 69466953 , 2013 ."
  ],
  "abstract_text": [
    "<S> mean - field models are a popular tool in a variety of fields . </S>",
    "<S> they provide an understanding of the impact of interactions among a large number of particles or people or other `` self - interested agents '' , and are an increasingly popular tool in distributed control .    </S>",
    "<S> this paper considers a particular randomized distributed control architecture introduced in our own recent work . in numerical results </S>",
    "<S> it was found that the associated mean - field model had attractive properties for purposes of control . in particular , </S>",
    "<S> when viewed as an input - output system , its linearization was found to be minimum phase .    in this paper </S>",
    "<S> we take a closer look at the control model . </S>",
    "<S> the results are summarized as follows :    the markov decision process framework of todorov is extended to continuous time models , in which the `` control cost '' is based on relative entropy . </S>",
    "<S> this is the basis of the construction of a family of markovian generators , parameterized by a scalar @xmath0 .    </S>",
    "<S> a decentralized control architecture is proposed in which each agent evolves as a controlled markov process . </S>",
    "<S> a central authority broadcasts a common control signal @xmath1 to each agent . </S>",
    "<S> the central authority chooses @xmath1 based on an aggregate scalar output of the markovian agents .    </S>",
    "<S> _ this is the basis of the mean field model . _    </S>",
    "<S> provided the control - free system ( with @xmath2 ) is a reversible markov process , the following identity holds for the transfer function @xmath3 obtained from the linearization , @xmath4 where the right hand side denotes the power spectral density for the output of any one of the individual markov processes ( with @xmath2 ) . </S>"
  ]
}