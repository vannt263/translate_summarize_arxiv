{
  "article_text": [
    "gaussian graphical models are parametric statistical models for jointly normal random variables whose dependence structure is determined by a graph . in this work ,",
    "we consider gaussian graphical models on mixed graphs which have both directed edges and bidirected edges . in the causal modeling framework for graphical models",
    "@xcite , the directed edges represent direct causal effects of one variable on another , while the bidirected edges represent the effects of unobserved confounders that lead to correlations between the error terms of the variables . in other contexts ,",
    "the gaussian graphical models we study are known as linear structural equation models , and the directed edges describe linear relationships between variables with correlated errors .",
    "a fundamental problem in the study of graphical models is to characterize the distributions that can arise .",
    "the models are typically presented using parametric descriptions , and we wish to give conditions on the distributions which could appear for some choice of parameters . in the case of graphical models which only have directed edges without directed cycles ( so - called _ directed acyclic graphs _ or dags ) ,",
    "it is well - known that a probability distribution belongs to the model if and only if the distribution satisfies all the conditional independence constraints implied by the graph ( * ? ? ?",
    "* thm 3.27 ) .    for gaussian graphical models ,",
    "the model consists of all covariance matrices @xmath0 which arise for some choice of parameters .",
    "each conditional independence statement @xmath1 , translates to a rank condition on a submatrix of the covariance matrix @xmath2 , namely that the matrix @xmath3 has rank @xmath4 .",
    "( note that for sets @xmath5 and @xmath6 , @xmath7 denotes the submatrix of @xmath2 with row index set @xmath5 and column index set @xmath6 . ) in other words , all @xmath8 subdeterminants of @xmath3 are zero .    in previous work @xcite",
    ", we generalized the rank dropping condition from conditional independence to arbitrary minors , via _ trek separation_. this gives necessary and sufficient conditions in terms of the underlying graph @xmath9 , and sets @xmath10 and @xmath11 , such that @xmath12 .",
    "these vanishing determinantal constraints are among the most natural to study . in the present paper",
    ", we extend the result of @xcite to give explicit cancellation - free expansions for the non - vanishing determinants @xmath13 .",
    "this has potential applications to the algebraic study of graphical models including to the identifiability problem for gaussian graphical models @xcite .",
    "besides this , our formulas for @xmath13 involve elegant combinatorics in the spirit of classical enumerative combinatorics results on determinants of matrices associated to graphs @xcite .",
    "for example , our results give the expansion of @xmath13 in terms of _ nonintersecting trek flows _ , and we show that after collecting terms , every monomial in the expansion appears with a coefficient of the form @xmath14 for some @xmath15 , determined by combinatorial properties of the flow .",
    "this paper is organized as follows . in the next section ,",
    "we give an introduction to gaussian graphical models and the special  paths \" in mixed graphs we need to study , called _",
    "treks_. in section [ sec : results ] we describe our main results on the expansions of the determinants of submatrices of @xmath2 arising from a gaussian graphical model .",
    "these results are based on a generalization of the lindstrm - gessel - viennot lemma for graphs with cycles , which is described in section [ sec : kelli ] .",
    "finally , section [ sec : proofs ] contains the proofs of the most general statements from section [ sec : results ] using the methods of section [ sec : kelli ] .",
    "let @xmath16 be a mixed graph with vertex set @xmath17 , bidirected edge set @xmath11 , and directed edge set @xmath18 .",
    "thus @xmath19 is a directed graph without loops or multiple edges called the _ directed part _ of @xmath9 , and @xmath20 is an undirected graph without loops or multiple edges called the _ bidirected part _ of @xmath9 .",
    "the qualification _ bidirected _ stems from these edges statistical interpretation in graphical models .",
    "a bidirected edge between vertices @xmath21 and @xmath22 is denoted @xmath23 and a directed edge from @xmath21 to @xmath22 is denoted @xmath24 .",
    "let @xmath25 denote the set of @xmath26 real symmetric positive definite matrices .",
    "let @xmath27 denote the set of positive definite matrices with off - diagonal nonzero entries only in positions corresponding to bidirected edges of @xmath9 , i.e. @xmath28    let @xmath29 be a jointly normal random vector @xmath30 with @xmath31 . for each @xmath32 ,",
    "let @xmath33 be a real parameter .",
    "define a new random vector @xmath34 by @xmath35 let @xmath36 be the @xmath26 matrix with @xmath37 in the @xmath38 position if @xmath39 , and zero otherwise . equation ( [ eq : linear ] ) can be rearranged as @xmath40 , where @xmath5 is a @xmath26 identity matrix . from this",
    ", we deduce that @xmath41 where @xmath42 provided that the matrix @xmath43 is invertible .",
    "given @xmath44 , let @xmath45 be the submatrix of @xmath2 with row index set @xmath10 and column index set @xmath11 .",
    "suppose @xmath46 .",
    "in previous work @xcite , we gave a combinatorial condition for when @xmath12 .",
    "in this paper , we explain how to expand @xmath47 explicitly in monomials without cancellation .",
    "henceforth , rather than thinking about the @xmath37 and @xmath48 as parameters , we choose to think about them as indeterminates ( or polynomial variables ) .",
    "hence , we are interested in expanding @xmath13 as a polynomial or a rational function , depending on the context .",
    "one of the key combinatorial definitions we need is the definition of a trek .    a _ trek _ in @xmath9 from @xmath49 to @xmath50 is a pair @xmath51 , where @xmath52 is a directed path from some vertex @xmath53 to @xmath21 and @xmath54 is a directed path from some vertex @xmath55 to @xmath22 , satisfying the further requirement that if @xmath56 , then there must be a bidirected edge @xmath57 .",
    "the vertices @xmath21 and @xmath22 are called the _ initial vertex _ and the _ final vertex _ of the trek , respectively .    in this definition ,",
    "a path is an ordered sequence of edges in @xmath18 in which the head of each edge equals the tail of the next edge .",
    "a path may have no edges , in which case , we also specify where the path starts , which is also where it ends ; we call such a path an empty path . later in the paper",
    "we will work mostly with self - avoiding paths , in which each vertex is the head of at most one edge of the path and the tail of at most one edge of the path ; such a path is uniquely determined by its edge set ( and initial vertex when empty ) . for the moment , however , @xmath52 and @xmath54 need not be self - avoiding .",
    "note also that either ( or both ) of the paths @xmath58 and @xmath59 are allowed to be an empty path , in which case @xmath60 or @xmath61 , respectively ( or both ) . two treks @xmath62 and @xmath63 are the same if both @xmath64 and @xmath65 . in particular ,",
    "two treks might contains exactly the same set of edges ( even with the same multiplicities ) but be different treks .",
    "if all directed edges in @xmath9 are pointing down the page  which they can be arranged to do if the directed part of @xmath9 happens to be acyclic  then one can think of a trek between @xmath21 and @xmath22 as a path of edges that starts at @xmath21 , goes up for a time to @xmath53 , possibly traverses a single bidirected edge to a vertex @xmath55 , and then turns around and goes down for a time to @xmath22 ; see figure  [ fig : trekswap1 ] below .",
    "we stress , however , that our results below are not restricted to the case where the directed part of @xmath9 is acyclic .    to any trek @xmath66",
    ", we associate the _ trek monomial _",
    "@xmath67 , where @xmath68 , and similarly , @xmath69 .",
    "here @xmath70 are the initial vertices of @xmath71 , and a variable @xmath72 appears in @xmath73 and @xmath74 with its respective multiplicities in the paths @xmath52 and @xmath54 .",
    "the reason for introducing treks and trek monomials is the following result :    [ prop : trekexpand ] let @xmath16 be a graph , and @xmath75 .",
    "then for all @xmath76 , @xmath77 where the sum runs over all treks @xmath78 in @xmath9 from @xmath21 to @xmath22 .",
    "proposition [ prop : trekexpand ] can be proven use the expansion @xmath79 and the combinatorial interpretation of the @xmath80 entry of @xmath81 as the sum of @xmath82 over all directed paths @xmath83 of length @xmath84 from @xmath85 to @xmath86 in the graph @xmath19 .",
    "see @xcite .     yields a trek with the same trek monomial .",
    "the two treks on the right are the same .",
    "the number of treks from @xmath21 to @xmath22 with this trek system monomial equals @xmath87 . ]",
    "as stated previously , there might be many treks in @xmath88 that use exactly the same set of edges , so the expression for @xmath89 might have repeated terms . as a prelude to our main results ,",
    "we discuss how to simplify this expression in the case where @xmath19 is acyclic .",
    "let @xmath66 be a trek with @xmath90 and @xmath91 .",
    "since @xmath19 is acyclic , the @xmath92 are mutually distinct , and so are the @xmath93 .",
    "but it may happen that @xmath92 equals @xmath93 , and then @xmath94 with @xmath95 and @xmath96 is a trek with @xmath97 .",
    "we call this procedure _ tailswapping _ at @xmath98 ; see figure  [ fig : trekswap1 ] .",
    "it turns out that any trek @xmath99 with @xmath100 can be obtained from @xmath78 by repeated tailswapping .",
    "we call such treks _ equivalent _ to @xmath78 , and we write @xmath101 . if @xmath102 ( so that @xmath53 equals @xmath55 ) , then then clearly @xmath103 . similarly , if @xmath104 and @xmath105 , then tailswapping at @xmath106 gives the same result as tailswapping at @xmath98",
    ". denote by @xmath107 the number of pairs @xmath108 with @xmath109 and by @xmath110 the number of edges that @xmath52 and @xmath54 have in common .",
    "the above discussion , together with the observation that tailswapping at distinct pairs of indices commutes then yields the following proposition .",
    "[ prop:2n1 ] let @xmath16 be a mixed graph such that @xmath19 is directed acyclic , and let @xmath111 .",
    "then for all @xmath76 , @xmath112_\\sim } 2^{i(t)-e(t)}m_{t}.\\ ] ] where the sum runs over equivalence classes of treks .    we will greatly generalize proposition [ prop:2n1 ] in section [ sec : results ] .",
    "in particular , the fact that all coefficients in @xmath47 are powers of @xmath113 persists when @xmath19 is a directed acyclic graph .",
    "now we return to the general case , where @xmath19 may contain cycles .",
    "since each entry @xmath89 is the sum of trek monomials from @xmath21 to @xmath22 , the determinant @xmath13 will be a ( signed ) sum of products of trek monomials .",
    "indeed , expanding the determinant using the standard leibniz expansion yields the following :    [ prop : detsigmaeasy ] let @xmath114 , with @xmath115 .",
    "let @xmath116 and @xmath117 .",
    "then @xmath118    there are two issues with this expansion .",
    "the first is that distinct tuples @xmath119 can lead to the same monomial @xmath120 and thus cancellation can occur .",
    "the second is that when the directed part of @xmath9 contains directed cycles , this expansion is a formal power series rather than a polynomial ( of course , this already happens when @xmath10 and @xmath11 are singletons ) . in the general case",
    "our aim is to write this formal power series as a rational function in which the denominator and the numerator are both in a suitable sense cancellation - free .",
    "an important simplification that we can make when describing the graphs , matrices , and determinants is to eliminate the bidirected edges under consideration .",
    "associated to the graph @xmath16 , we introduce the bidirected subdivision @xmath121 , which has only directed edges .",
    "we start will all vertices and directed edges in @xmath9 .",
    "then , for each bidirected edge @xmath23 in @xmath9 , we introduce a new vertex @xmath122 , and two directed edges @xmath123 and @xmath124 .",
    "the resulting graph is the bidirected subdivision of @xmath9 .",
    "combinatorial expressions for the entries @xmath89 associated to the graph @xmath9 can be obtained from the corresponding expressions for @xmath121 as described in the following proposition .",
    "let @xmath16 be a graph and let @xmath121 be its bidirected subdivision .",
    "write @xmath111 for the covariance matrix for the graph @xmath9 and @xmath125 for the covariance matrix for the bidirected subdivision @xmath121",
    ". let @xmath126 $ ] be a polynomial .",
    "then @xmath127 if and only if @xmath128 .",
    "furthermore , the expansion of @xmath129 can be recovered from the expansion of @xmath130 by the following procedure :    1 .",
    "remove any monomial that contains a @xmath131 or @xmath132 .",
    "2 .   set all remaining @xmath133 and @xmath134 variables to @xmath135 .",
    "3 .   change @xmath136 to @xmath48 .",
    "4 .   change all remaining @xmath137 and @xmath138 to @xmath37 and @xmath139 , respectively .    consider the @xmath140-algebra homomorphism @xmath141 \\rightarrow { \\mathbb{r}}[[\\lambda^ { * } , \\omega^{*}]]$ ] defined by @xmath142 we claim that @xmath143 .",
    "first , we prove the claim .",
    "let @xmath144 and @xmath145 be the matrices for the bidirected subdivision @xmath146 .",
    "we realize both matrices as block matrices with the first set of row / column labels corresponding to bidirected edges @xmath23 , and hence the vertices @xmath122 in @xmath146 .",
    "then @xmath144 and @xmath145 have the form @xmath147 where @xmath148 , @xmath149 , @xmath36 is the directed edge matrix from the graph @xmath9 , and @xmath150 is a matrix whose @xmath151 entry is @xmath152 if @xmath153 , and is zero otherwise . note that @xmath154 from which we deduce that @xmath155 the entry in the bottom right - hand corner of this matrix is the expression for the submatrix @xmath156 , so the claim is equivalent to saying that the map @xmath157 is that map that takes @xmath158 in @xmath159 and replaces it with @xmath160 .",
    "but it is easy to see that @xmath161 and for @xmath162 , @xmath163 if @xmath164 and @xmath165 if @xmath166 .",
    "now we will show that the claim proves the proposition .",
    "first of all , the map @xmath157 is injective . indeed",
    ", suppose that @xmath167 and @xmath168 is irreducible .",
    "then , since @xmath138 only appears in @xmath169 , then @xmath139 could not appear in @xmath168 .",
    "similarly , we can then rule out @xmath48 appearing in @xmath168 , and @xmath37 appearing in @xmath168 .",
    "this forces @xmath168 to be the zero polynomial .",
    "since @xmath157 is injective , we deduce the first part of the proposition , a power series @xmath129 is zero if and only if @xmath170 is zero .",
    "for the second part , we note that the following map @xmath171 applied to @xmath130 produces @xmath129 : @xmath172 that can be seen by applying the operations on the factorization @xmath173 to produce @xmath159 .",
    "this corresponds to the four - step procedure from the statement of the proposition , since the expressions involving @xmath174 will cancel with terms coming from @xmath175 .",
    "henceforth , we focus solely on the case of graphs with no bidirected edges .",
    "in this section , we assume @xmath176 is a directed graph , possibly obtained as the bidirected subdivision of some mixed graph . our goal is to find a cancellation - free analogue of the formula for @xmath13 in proposition  [ prop : detsigmaeasy ] .",
    "the exact meaning of cancellation - free depends on the context . if @xmath9 is acyclic , then @xmath13 is a polynomial in the variables @xmath139 and the variables @xmath37 for directed edges @xmath24 , and cancellation - free means that we determine which monomials have non - zero coefficients in @xmath13 , and what those coefficients are .    if , on the other hand , @xmath9 contains directed cycles , then there may be infinitely many treks from @xmath21 to @xmath22 . in this case",
    "@xmath13 is a formal power series representing a rational function ( as is clear from @xmath177 using cramer s rule ) .",
    "we will then write @xmath13 as a fraction @xmath178 where @xmath179 and @xmath180 are polynomials with known monomials and known coefficients .",
    "the formula that we derive in the general case has @xmath181 when specialized to the acyclic case , hence our proof will immediately focus on the general case . for the purpose of exposition , however , we first present the formula for the acyclic case , before dealing with the general case , which is more combinatorially complicated .",
    "let @xmath10 and @xmath11 be sets of @xmath85 vertices .",
    "trek system _ @xmath182 from @xmath10 to @xmath11 consists of @xmath85 treks whose initial vertices exhaust the set @xmath10 and whose final vertices exhaust the set @xmath11 .",
    "such a trek system gives rise to a bijection @xmath183 mapping @xmath184 to the final vertex of the ( unique ) trek in @xmath182 starting at @xmath184 . given a linear ordering @xmath185 of @xmath10 and a linear ordering @xmath186 of @xmath11 , this bijection determines an element @xmath187 of @xmath188 ( which depends on the linear orderings of @xmath10 and @xmath11 ) , and we define @xmath189 .",
    "we define the _ trek system monomial _ @xmath190 as the the product of the trek monomials @xmath191 ranging over @xmath192 . the formula in proposition  [ prop : detsigmaeasy ] can then be rewritten as @xmath193 where @xmath182 runs over all trek systems from @xmath10 to @xmath11 .",
    "cancellation can happen if distinct @xmath194 and @xmath195 are the same . to achieve a cancellation - free formula we introduce the following notion ( see @xcite ) .",
    "a trek system @xmath182 from @xmath10 to @xmath11 has _ no sided intersection _",
    "if the left parts @xmath52 for @xmath196 are mutually vertex - disjoint and also the right parts @xmath54 for @xmath196 are mutually vertex - disjoint ( but any @xmath52 may have vertices in common with any @xmath197 ) . otherwise , @xmath182 is said to have a sided intersection .",
    "we write @xmath198 for the set of trek systems from @xmath10 to @xmath11 with no sided intersection .",
    "in @xcite it is proved that in one may restrict @xmath182 to run over all trek systems without sided intersection .",
    "our first new result is that these terms all have the same sign and thus do not cancel .",
    "[ thm : positivityacyclic ] let @xmath176 be an acyclic digraph and let @xmath10 and @xmath11 be subsets of @xmath17 of the same cardinality .",
    "assume we have fixed linear orderings of @xmath10 and @xmath11 .",
    "if two trek systems @xmath182 and @xmath199 from @xmath10 to @xmath11 without sided intersection satisfy @xmath200 , then @xmath201 .    , and dashed directed edges denote parts of right paths in @xmath182 . on the left an up - down cycle",
    "is created , on the right , we traverse a right path up without hitting a further left path . ]    to obtain the desired cancellation - free formula we therefore only need to compute the number of trek systems @xmath199 with the same trek system monomial as @xmath182 . for this",
    "we introduce combinatorial objects that we call _ up - down cycles _ in @xmath182 . rather than giving a formal definition",
    "we describe their construction ; see figure  [ fig : updown1 ] for an example .",
    "let @xmath202 be an edge in some left path @xmath52 of @xmath182 , and assume that @xmath202 is _ not _ contained in any right path of @xmath182 .",
    "follow the directed path @xmath52 _ downwards _ ,",
    "i.e. with the direction of the graph , starting with @xmath202 ; since @xmath182 has no sided intersection , we will never intersect another left path . if no vertex on @xmath52 after the edge @xmath202 is in any right path , then @xmath202 is not in any up - down cycle . otherwise , let @xmath203 be the first vertex on @xmath52 after @xmath202 ( possibly @xmath203 equals @xmath204 ) that is also on some ( necessarily unique ) right path @xmath197 of a trek @xmath205 . then follow @xmath197 _ upwards _",
    ", i.e. against the direction of the graph , from @xmath203 .",
    "if we never intersect another vertex on any left path ( different from @xmath203 ) , then again @xmath202 is not in any up - down cycle .",
    "otherwise , let @xmath206 be the first vertex encountered when traversing @xmath197 upwards that is contained in any left path from @xmath182 ; say @xmath207 . then follow @xmath207 down from @xmath206 , etc .",
    "continuing in this manner we construct a sequence of non - empty paths @xmath208 in @xmath9 that are alternatingly contained in left paths and right paths of @xmath182 and that do not contain edges shared by some left path with some right path ( because we always turn at the _ first _ possible vertex in each step ) .",
    "only three things can happen : we traverse a left path downward to its final vertex without hitting a further right path , we traverse a right path upward to its initial vertex without hitting a further left path , or we eventually follow the original path @xmath52 from somewhere above the edge @xmath202 . in the final case ,",
    "the sequence of paths closes up and the union of their edge sets is what we call an _ up - down cycle _ in @xmath182 .",
    "the set of all up - down cycles in is denoted @xmath209 . for",
    "a more formal definition see the next subsection on the general directed case .",
    "[ thm : poweroftwoacyclic ] let @xmath176 be an acyclic digraph and let @xmath10 and @xmath11 be subsets of @xmath17 of the same cardinality , and assume we have fixed linear orderings of @xmath10 and @xmath11 , as in theorem  [ thm : positivityacyclic ] .",
    "let @xmath182 be a trek system in @xmath9 without sided intersection .",
    "then the number of trek systems @xmath210 with @xmath211 equals @xmath212 .",
    "a consequence of the previous two theorems is the following formula .",
    "[ cor : cancellationfreeacyclic ] let @xmath176 , @xmath10 , and @xmath11 be as in theorem  [ thm : positivityacyclic ] .",
    "then @xmath213_\\sim \\in { \\mathcal{t}}(a , b)/\\sim } { { \\rm sign } \\,}({\\mathbf{t } } ) 2^{|{\\mathrm{ud}}({\\mathbf{t}})| } m_{{\\mathbf{t}}}\\ ] ] where the sum runs over equivalence classes of the relation @xmath214 defined by @xmath215 if and only if @xmath216 .",
    "for a general digraph @xmath176 that may contain cycles , the analogues of theorems  [ thm : positivityacyclic ] and  [ thm : poweroftwoacyclic ] and corollary  [ cor : cancellationfreeacyclic ] require some notions from @xcite .    let @xmath217 and @xmath218 be @xmath85-subsets of @xmath17 with fixed linear orderings .",
    "a _ self - avoiding flow _ from @xmath10 to @xmath11 in @xmath9 is a pair @xmath219 where @xmath220 is a set of @xmath85 self - avoiding and pairwise vertex - disjoint paths whose initial vertices exhaust @xmath10 and whose final vertices exhaust @xmath11 , and where @xmath221 is a set of non - empty , self - avoiding directed cycles that are pairwise vertex - disjoint and that are also vertex - disjoint from all paths in @xmath220 .",
    "the path component @xmath220 gives rise to a bijection @xmath183 , which through the linear orderings corresponds to an element @xmath222 .",
    "the _ sign _",
    "@xmath223 is defined as @xmath224 , where @xmath225 denotes the number of cycles in the collection @xmath221 .    in this definition",
    "a self - avoiding cycle is identified with its set of edges ( without distinguished initial vertex ) .",
    "we introduce a trek analogue of this notion as follows .",
    "let @xmath217 and @xmath218 be @xmath85-subsets of @xmath17 with fixed linear orderings .",
    "a _ self - avoiding trek flow _ in the digraph @xmath9 is a pair @xmath226 where @xmath227 is a self - avoiding flow from a ( necessarily unique ) @xmath85-subset @xmath180 of @xmath17 to @xmath10 , and @xmath228 is a self - avoiding flow from the same set @xmath180 to @xmath11 .",
    "we call @xmath180 the set of _ tops _ of the trek flow .",
    "we write @xmath198 for the set of self - avoiding trek flows from @xmath10 to @xmath11 .",
    "note that our notation @xmath182 and @xmath198 is consistent with the acyclic case : there the cycle components @xmath229 and @xmath230 of @xmath227 and @xmath228 are empty , and the condition that the path component of @xmath227 ( respectively , @xmath228 ) consists of self - avoiding and pairwise vertex - disjoint paths is equivalent to the condition that a trek system has no sided intersection .",
    "the _ sign _ of a self - avoiding trek flow @xmath226 from @xmath10 to @xmath11 ( relative to fixed linear orderings on these sets ) is defined as @xmath231 .",
    "( this depends on the orderings of @xmath10 and @xmath11 , but not on the linear ordering of the set of tops , as long as the same ordering is used for determining the signs of both @xmath228 and @xmath227 ) .    the _ trek flow monomial _",
    "@xmath190 is defined as the product of the variables @xmath139 for @xmath232 , the variables @xmath37 corresponding to all edges @xmath24 used by paths and cycles in @xmath227 and @xmath228 , taken with the appropriate multiplicities .",
    "note that , in particular , the fact that @xmath182 is self - avoiding implies that each @xmath37 appears with degree at most @xmath113 in @xmath190 .",
    "using a theorem by the third author @xcite , we will write @xmath47 as a rational function where both the numerator and the denominator are signed sums over self - avoiding trek flows ; see below",
    ". the following theorem says that no cancellation occurs .",
    "[ thm : positivitygeneral ] let @xmath176 be a digraph and let @xmath10 and @xmath11 be subsets of @xmath17 of the same cardinality , both with fixed linear orderings .",
    "if two self - avoiding trek flows @xmath182 and @xmath199 from @xmath10 to @xmath11 satisfy @xmath200 , then @xmath201 .",
    "next we compute the number of trek flows @xmath199 with the same trek flow monomial as @xmath182 .",
    "again , our main combinatorial tools are up - down cycles , which we define more formally at this point .",
    "let @xmath226 be a self - avoiding trek flow , and let @xmath150 be the set of edges used by @xmath227 or by @xmath228 but _ not _ by both .",
    "define a directed graph @xmath233 with vertex set @xmath150 as follows : an element @xmath234 used by @xmath227 has at most one outgoing arrow in @xmath233 . if @xmath204 is visited by some path or cycle in @xmath228 _ and _ has an incoming edge @xmath235 there , then the arrow from @xmath236 points to @xmath168 . if @xmath204 is not visited by any path or cycle in @xmath228 ( not even by an empty path based at @xmath204 ) _ and _ has an outgoing edge @xmath237 in @xmath227 , then the arrow from @xmath236 points to @xmath168 . in all other cases",
    ", @xmath236 has no outgoing arrow in @xmath233 .",
    "similarly , an element @xmath234 used by @xmath228 has at most one outgoing arrow .",
    "if @xmath238 is visited by @xmath227 _ and _ has an outgoing edge @xmath239 there , then the arrow from @xmath236 points to @xmath168 .",
    "if @xmath238 is not visited by @xmath227 _ and _ has an incoming arrow @xmath240 in @xmath228 , then the arrow from @xmath236 points to @xmath168 .",
    "in all other cases , @xmath236 has no outgoing arrow .",
    "now an _ up - down cycle _ in @xmath182 is the support @xmath241 of any non - empty directed cycle in the digraph @xmath233 .",
    "we write @xmath209 for the set of all up - down cycles in @xmath182 .",
    "in fact , the definition of @xmath233 forces every element of @xmath150 to have at most one incoming arrow , as well . as a consequence , @xmath233 is a union of vertex - disjoint directed cycles and paths .",
    "this implies that distinct up - down cycles in @xmath182 do not share edges , a fact that we will use later .",
    "it is easily verified that this definition of up - down cycle agrees with the construction given in the acyclic case .",
    "one new aspect is that the edges of a directed cycle in the cycle component of @xmath227 which avoid @xmath228 ( or vice versa ) also form an up - down cycle .",
    "[ thm : poweroftwogeneral ]    let @xmath176 be a digraph and let @xmath10 and @xmath11 be subsets of @xmath17 of the same cardinality , both with fixed linear orderings , as in theorem  [ thm : positivitygeneral ] .",
    "let @xmath182 be a self - avoiding trek flow in @xmath9 .",
    "then the number of trek flows @xmath242 with @xmath211 equals @xmath212 .    finally , we state our general cancellation - free rational expression for @xmath13 .",
    "[ cor : cancellationfreegeneral ] let @xmath176 , @xmath10 , and @xmath11 be as in theorem  [ thm : positivitygeneral ] .",
    "then @xmath243_\\sim \\in { \\mathcal{t}}(a , b)/\\sim } { { \\rm sign } \\,}({\\mathbf{t } } ) 2^{|{\\mathrm{ud}}({\\mathbf{t}})| } m_{{\\mathbf{t } } } } { \\sum_{[{\\mathbf{t}}]_\\sim \\in { \\mathcal{t}}(\\emptyset,\\emptyset)/\\sim } { { \\rm sign } \\,}({\\mathbf{t } } ) 2^{|{\\mathrm{ud}}({\\mathbf{t}})| } m_{{\\mathbf{t}}}},\\ ] ] where both run over equivalence classes of the relation @xmath214 defined by @xmath215 if and only if @xmath216 .    note that every self - avoiding trek flow from the empty set to itself is of the form @xmath244",
    ". in particular , when @xmath9 is acyclic and there are no cycles , the denominator contains only one term , corresponding to @xmath245 , and our formula specializes to the formula in corollary  [ cor : cancellationfreeacyclic ] .",
    "in this section we recall a generalization of the lindstrm - gessel - viennot lemma @xcite to arbitrary graphs ; for a different generalization see @xcite .",
    "thus let @xmath176 be an arbitrary finite directed graph , and associate an edge variable @xmath37 to each @xmath39 .",
    "let @xmath217 and @xmath218 be @xmath85-subsets of @xmath17 , and let @xmath246 denote their _ weighted path matrix _ , i.e. , the @xmath247-matrix over @xmath248 $ ] whose @xmath122-entry is the sum over all directed paths in @xmath9 from @xmath249 to @xmath250 of the product of the edge variables along the path .    to express @xmath251 as a rational function in the edge variables , we recall from section  [ sec : results ] the notion of self - avoiding flow from @xmath10 to @xmath11 in @xmath9 , and we write @xmath252 for the ( necessarily finite ) set of all such flows .",
    "[ thm : pathmatrixdet ] the determinant of the weighted path matrix from @xmath10 to @xmath11 is given by @xmath253 where the denominator is the sum over all self - avoiding flows consisting of vertex - disjoint cycles only .",
    "in this section we prove theorems  [ thm : positivitygeneral ] and [ thm : poweroftwogeneral ] and corollary  [ cor : cancellationfreegeneral ] , which immediately imply their acyclic special cases .",
    "let @xmath176 be a directed graph and let @xmath217 and @xmath218 be @xmath85-subsets of @xmath17 .",
    "we first deduce the corollary from the two theorems",
    ".    we will apply theorem  [ thm : pathmatrixdet ] with @xmath9 replaced by the digraph @xmath254 constructed from @xmath9 as follows : in the disjoint union of the opposite graph @xmath255 with @xmath9 add an arrow from any vertex @xmath256 of @xmath255 to the corresponding vertex @xmath21 in @xmath9 .",
    "these arrows get labels @xmath139 , while every edge @xmath257 in @xmath258 gets the same label @xmath37 as its opposite @xmath24 in @xmath9 . with this notation ,",
    "the submatrix @xmath259 of our graphical model equals the path matrix @xmath260 in theorem  [ thm : pathmatrixdet ] .",
    "similarly , self - avoiding trek flows in @xmath9 from @xmath10 to @xmath11 are in bijection with self - avoiding flows in @xmath254 from @xmath261 to @xmath11 , and the bijection preserves signs .",
    "thus theorem  [ thm : pathmatrixdet ] yields the expression @xmath262 theorem  [ thm : positivitygeneral ] shows that self - avoiding trek flows from @xmath10 to @xmath11 with the same trek flow monomial have the same sign , and theorem  [ thm : poweroftwogeneral ] counts the number of such trek flows in each equivalence class .",
    "this gives the desired formula @xmath243_\\sim \\in { \\mathcal{t}}(a , b)/\\sim } { { \\rm sign } \\,}({\\mathbf{t } } ) 2^{|{\\mathrm{ud}}({\\mathbf{t}})| } m_{{\\mathbf{t } } } } { \\sum_{[{\\mathbf{t}}]_\\sim \\in { \\mathcal{t}}(\\emptyset,\\emptyset)/\\sim } { { \\rm sign } \\,}({\\mathbf{t } } ) 2^{|{\\mathrm{ud}}({\\mathbf{t}})| } m_{{\\mathbf{t}}}}.\\ ] ]    the remainder of this section focuses on the proofs of theorems  [ thm : positivitygeneral ] and  [ thm : poweroftwogeneral ] .",
    "the proofs are closely intertwined and mostly contained in the main body of the text .",
    "first we want to reduce our arguments to the case where @xmath10 and @xmath11 are disjoint . for this , we first modify @xmath9 as follows . for each @xmath263 , introduce copies @xmath264 with edges @xmath265 and call the resulting graph @xmath266 . let @xmath267 and @xmath268 inherit their linear orderings from @xmath10 and @xmath11 respectively . adding the new edges",
    "gives a bijection from self - avoiding trek flows in @xmath9 from @xmath10 to @xmath11 to self - avoiding trek flows in @xmath266 from @xmath269 to @xmath270 .",
    "for theorem  [ thm : positivitygeneral ] we observe that this bijection preserves signs , and for theorem  [ thm : poweroftwogeneral ] we observe that it also preserves the number of up - down cycles  indeed , the new edges are not part of any up - down cycle .",
    "thus , we may drop the accents and write @xmath271 for @xmath272 , or in other words , assume @xmath10 and @xmath11 are disjoint subsets of @xmath17 .",
    "next fix a self - avoiding trek flow @xmath273 from @xmath10 to @xmath11 with set of tops @xmath274 , and choose the linear orderings such that @xmath275 and @xmath276 connect @xmath277 $ ] to @xmath249 and to @xmath278 , respectively , so that the path components of both flows have sign @xmath135 .",
    "we want to show that any self - avoiding trek flow @xmath199 from @xmath10 to @xmath11 with the same trek flow monomial as @xmath182 has the same sign as @xmath182 , and that the number of such self - avoiding trek flows is @xmath212 .    to this end , color the edges of @xmath9 with @xmath279 if they are in some path or cycle of @xmath227 and with @xmath135 if they are used by @xmath228 .",
    "delete edges of @xmath9 without any color ; these are irrelevant for what follows . then contract all bi - colored edges in @xmath9 .",
    "this may yield some additional isolated vertices ( corresponding to fully contracted cycles all of whose edges are bi - colored ) ; delete all isolated vertices .",
    "contracting bi - colored edges and deleting resulting empty cycles and other isolated vertices gives a bijection between self - avoiding trek flows @xmath199 from @xmath10 to @xmath11 in the original graph satisfying @xmath211 and self - avoiding trek flows in the resulting graph having _ full support _",
    "( i.e. , containing all edges exactly once ) and having @xmath180 as set of tops .",
    "this bijection is sign - preserving because it does not affect the bijections @xmath183 and because it deletes cycles in pairs .",
    "also note that the number of up - down cycles in @xmath182 does not change , since up - down cycles by definition do not contain bi - colored edges .",
    "again , we change notation so that @xmath9 stands for the new graph .",
    "next , consider any monochromatic cycle in @xmath9 that has no vertices in common with paths or cycles of the other color .",
    "this cycle can be moved freely between the left and right cycle components of a self - avoiding trek flow with full support without changing the sign or the trek flow monomial . moving such a cycle gives a factor @xmath113 when counting self - avoiding trek flows of full support with @xmath180 as set of tops , and this factor is accounted for by the fact that the cycle counts as an up - down cycle .",
    "so it suffices to prove our theorems for the simplified graph where all such cycles ( edges and vertices ) are deleted from @xmath9 .",
    "update @xmath9 again .",
    "finally , contract all vertices with exactly one incoming edge and one outgoing edge ( necessarily of the same color ) .",
    "this can now be done without contracting a monochromatic cycle ( since such cycles always intersect a cycle of the other color after we have removed the monochromatic cycles from the preceding according to the preceding paragraph ) .",
    "again , there is a sign - preserving bijection , and the number of up - down cycles is invariant .",
    "after these modifications , the vertices in @xmath180 have exactly two outgoing edges , one colored @xmath279 and one colored @xmath135 , and no incoming edges , the vertices in @xmath280 have exactly one incoming edge colored @xmath279 ( for @xmath10 ) or @xmath135 ( for @xmath11 ) and no outgoing edges , and all other vertices in @xmath9 have exactly two incoming edges ( of different colors ) and exactly two outgoing edges ( again of different colors ) .",
    "the resulting graph , again denoted @xmath176 , does not have any loops ( but of course it may have directed cycles ) .",
    "we can recover @xmath182 from the coloring by taking for @xmath228 the @xmath279-colored edges and for @xmath227 the @xmath135-colored edges .",
    "we may therefore identify @xmath182 with the @xmath281-coloring .",
    "more generally , self - avoiding trek flows @xmath199 from @xmath10 to @xmath11 with the same monomial as @xmath182 correspond bijectively to edge colorings @xmath282 with the same properties as @xmath182 , namely : the incoming edges into @xmath10 are colored @xmath279 , the incoming edges into @xmath11 are colored @xmath135 , the outgoing edges of each vertex in @xmath283 are colored with distinct colors , and so are the two incoming edges of each vertex in @xmath284 .",
    "we identify such @xmath199 with their colorings .",
    "then the sum @xmath285 ( modulo @xmath113 ) is an edge coloring where the sum of the colors of the edges entering any vertex is zero , and so is the sum of the colors leaving any vertex .",
    "conversely , adding a coloring @xmath286 with these properties to @xmath182 yields a self - avoiding trek flow @xmath199 with the same monomial as @xmath182 .",
    "since the conditions on @xmath286 define a subgroup @xmath287 of @xmath288 the number of self - avoiding trek flows @xmath199 with the same monomial as @xmath182 is a power of @xmath113 .",
    "the following proposition completes the proof of theorem  [ thm : poweroftwogeneral ] .    to each up - down cycle @xmath289 in @xmath182",
    "assign an edge coloring @xmath282 that colors the edges in @xmath289 with @xmath135 and the remaining edges with @xmath279 .",
    "the resulting _ up - down - colorings _ form a basis of @xmath287 as a vector space over @xmath281 .",
    "let @xmath286 be a non - zero element of @xmath287 and let @xmath290 be an edge contained in the left part of @xmath182 that is colored @xmath135 by @xmath286",
    ". then @xmath203 has a unique other incoming edge @xmath291 that must also be colored @xmath135 by @xmath286 , and this edge must be in the right part of @xmath182 .",
    "then @xmath206 has a unique other outgoing edge @xmath292 that must also be colored @xmath135 by @xmath286 , and this edge must be in @xmath293 , etc .",
    "all these edges are distinct , until you get back to @xmath294 .",
    "this gives an up - down cycle whose coloring can be subtracted from @xmath286 to get a coloring with fewer edges colored @xmath135 .",
    "this proves that up - down colorings span @xmath287 . since distinct up - down cycles are edge - disjoint , up - down colorings are also linearly independent .",
    "to prove that the signs of @xmath199 and @xmath182 are the same , it now suffices to prove that adding to @xmath182 a coloring supported on an up - down cycle does not change the sign . for this",
    "we prove lemma [ lemma : signswitch ] . to do this we first need to give a definition of signs of other combinatorial objects , which are used in the proof .    [ def : sgndeltaupsilon ] let @xmath295 be an element of @xmath188 , let @xmath296 be subsets of @xmath297 $ ] of the same cardinality , and let @xmath298 be a bijection from @xmath297-y$ ] to @xmath297-x$ ] .",
    "we define the _ sign _ of the pair @xmath299 as follows .",
    "construct a directed bipartite graph @xmath254 on two copies @xmath297_1,[k]_2 $ ] of @xmath297 $ ] with @xmath295 prescribing the arrows from @xmath297_1 $ ] to @xmath297_2 $ ] ( `` down '' ) and @xmath298 prescribing the arrows from @xmath297_2 $ ] ( `` up '' ) .",
    "the graph @xmath254 defines a bijection @xmath300 which maps @xmath301 to the endpoint of the path in @xmath254 starting at @xmath302 . the sign @xmath303 is defined as the sign of @xmath187 ( relative to the natural linear orderings on @xmath304 $ ] ) times @xmath305 raised to the number of directed cycles in @xmath254 .",
    "we prove the lemma by induction on @xmath308 .",
    "it is trivially true if @xmath302 and @xmath309 are both equal to @xmath297 $ ] : then the graph @xmath254 does not have any upward arrows and @xmath310 , and @xmath311 , so that @xmath312 equals @xmath135 , independently of @xmath295 .",
    "now suppose that the lemma is true for all @xmath313-y \\to [ k]-x$ ] .",
    "pick such an @xmath298 , let @xmath301 and @xmath314 , and let @xmath315 be the extension of @xmath298 to @xmath297-y+y$ ] sending @xmath204 to @xmath238 .",
    "let @xmath307 and construct @xmath254 and @xmath187 as in the definition ( from the pair @xmath316 ) . to analyze how @xmath317 differs from @xmath303 we distinguish two cases :    1 .",
    "@xmath318 : in this case , adding the upward arrow @xmath319 to @xmath254 creates an additional cycle in @xmath254 , and this contributes a factor @xmath320 to the sign . furthermore , the new bijection @xmath321 is the restriction of @xmath187 to @xmath322 .",
    "hence we have @xmath323 in conclusion , @xmath324 is this latter expression times @xmath320 ( for the additional cycle created in @xmath254 ) .",
    "@xmath325 : in this case , no new cycle is created when adding to @xmath254 the upward arrow @xmath319 .",
    "let @xmath326 , so that in the new graph the path starting at @xmath327 passes through @xmath328 in that order .",
    "then the new permutation @xmath321 equals @xmath187 on @xmath329 and sends @xmath330 to @xmath331 .",
    "hence we have @xmath332 } \\right)\\\\ & = { { \\rm sign } \\,}\\left ( \\frac{1 } { ( u - x)(y - z)\\prod_{i \\in x - u - x}[(\\pi(i)-y)(i - x ) ] } \\right)\\\\ & = -{{\\rm sign } \\,}\\left ( \\frac{1 } { \\prod_{i \\in x - x}[(i - x ) ] \\prod_{i \\in x - u}[(\\pi(i)-y ) ] } \\right)\\\\ & = -(-1)^{|\\{i \\in x \\mid i < x\\}|+|\\{j \\in y \\mid j < y\\}| . } \\end{aligned}\\ ] ]        [ lm : delta01 ] fix a natural number @xmath85 .",
    "let @xmath333 be elements of @xmath188 and let @xmath334 be bijections between subsets @xmath297-y_0,[k]-y_1 $ ] and @xmath297-x_0,[k]-x_1 $ ] , respectively .",
    "hence @xmath335 for @xmath336 ; we do not require that @xmath337 .",
    "then we have the following identity : @xmath338    now we return to our proof of positivity ; the following arguments are clarified in example  [ ex : updownswap ] below .",
    "suppose that @xmath199 and @xmath182 differ by an up - down cycle @xmath286 , considered as an edge coloring as above .",
    "label the vertices with incoming edges of @xmath286-color @xmath279 and outgoing edges of @xmath286-color @xmath135 by the numbers @xmath339 ( we identify these with a first copy @xmath297_1 $ ] of @xmath297 $ ] ) , and similarly label the vertices with outgoing edges of @xmath286-color @xmath279 and incoming @xmath286-color @xmath135 by @xmath339 ( identifying them with a second copy @xmath297_2 $ ] ) .",
    "note that there are , indeed , equally many of both , since the edges of @xmath286-color @xmath135 and @xmath182-color @xmath279 form @xmath85 vertex - disjoint paths from the first set to the second set .",
    "denote the corresponding bijection by @xmath340 .",
    "similarly , the edges of @xmath286-color @xmath135 and @xmath182-color @xmath135 give a bijection @xmath341 .",
    "now some directed paths with @xmath182-color @xmath279 emanating from @xmath297_2 $ ] ( hence with @xmath286-color @xmath279 ) may `` loop back '' to @xmath297_1 $ ] ; this gives an bijection @xmath342 from a subset @xmath297_2-y_0 $ ] of @xmath297_2 $ ] to a @xmath297_1-x_0 $ ] .",
    "similarly , we obtain an injective map @xmath343 from a subset of @xmath297_2-y_1 $ ] into @xmath297_1-x_1 $ ] by following directed paths of @xmath182-color @xmath135 emanating from @xmath297_2 $ ] .    to change @xmath182 into @xmath199 the colors in the up - down cycle are interchanged .",
    "this means that the roles of @xmath344 and @xmath345 are interchanged .",
    "the total change in trek flow sign is exactly the change from @xmath346 into @xmath347 .",
    "indeed , the change in sign of the left flow @xmath227 is exactly @xmath348 , and the change in sign of the right flow @xmath228 is exactly @xmath349 . now lemma  [ lm : delta01 ] implies that that @xmath182 and @xmath199 have the same sign .",
    "this concludes our proof of positivity for general digraphs .",
    "we conclude the paper with an example illustrating the arguments just given .        in figure  [",
    "fig : examplepos ] we have @xmath350 , the elements of @xmath351_1 $ ] are denoted @xmath352 , and the elements of @xmath351_2 $ ] are denoted @xmath353 . on the left is a fragment of @xmath182 with @xmath279-colored edges solid and @xmath135-colored edges dashed . on the right",
    "is the corresponding fragment of @xmath199 .",
    "the bijection @xmath344 maps @xmath354 and is depicted by straight solid arrows on the left and by dashed solid arrows on the right .",
    "the bijection @xmath345 maps @xmath355 and is depicted by straight dashed arrows on the left and by straight solid arrows on the right .",
    "together these form the up - down cycle .",
    "the partial map up @xmath342 maps @xmath356 ( curved solid arrow ) and the partial map @xmath343 maps @xmath357 ( curved dashed arrows ) .",
    "the remaining arrows are fragments of paths leading from the set of tops to the up - down cycle and from the up - down cycle to @xmath280 .",
    "the map @xmath358 constructed from @xmath359 as in definition  [ def : sgndeltaupsilon ] can be read off from the left - hand picture : it maps @xmath360 and has sign @xmath135 ; the number of cycles in the digraph @xmath361 as in that definition is zero .",
    "so @xmath362 .",
    "similarly , @xmath363 constructed from @xmath364 is @xmath365 , with sign @xmath135 , and @xmath366 has two cycles @xmath367 and @xmath368 , so @xmath369 , as well .",
    "on the right , the roles of @xmath344 and @xmath345 are reversed .",
    "the pair @xmath370 leads to no cycles and to the map @xmath371 with sign @xmath320 .",
    "thus @xmath372 .",
    "similarly , @xmath373 leads to the map @xmath365 with sign @xmath135 and to one cycle @xmath368 , so @xmath374 . note that @xmath375 in accordance with lemma  [ lm : delta01 ] , and this shows that the sign of @xmath182 does not change under swapping the @xmath279 and @xmath135-labels in the up - down cycle , resulting in @xmath199"
  ],
  "abstract_text": [
    "<S> gaussian graphical models are parametric statistical models for jointly normal random variables whose dependence structure is determined by a graph . in previous work , we introduced trek separation , which gives a necessary and sufficient condition in terms of the graph for when a subdeterminant is zero for all covariance matrices that belong to the gaussian graphical model . here </S>",
    "<S> we extend this result to give explicit cancellation - free formulas for the expansions of nonzero subdeterminants . </S>"
  ]
}