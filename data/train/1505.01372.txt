{
  "article_text": [
    "traffic flow can be described at different scales , depending on the level of details one wants to observe .",
    "typically , three scales of observation can be adopted : _ microscopic _ (",
    "single vehicles are tracked ) , _ mesoscopic _ ( averaged quantities like density and mean velocity are tracked but car - to - car interactions are not completely lost ) and _ macroscopic _ ( only averaged quantities are observed ) .    limiting our attention to differential models ,",
    "the most famous microscopic models are those of _ follow - the - leader _ type , also known as _ car - following _ models @xcite . in such a models , the dynamics of each vehicle depend on the vehicle in front of it , so that , in a cascade , the whole traffic flow is determined by the dynamics of the very first vehicle ( the _ leader _ ) .",
    "the oldest macroscopic model is instead the lwr model @xcite , which dates back to 1955 and is inspired by the laws of fluid - dynamics .    generally speaking , microscopic models are considered more justifiable because the behavior of every single vehicle can be described with high precision and it is immediately clear which kind of interactions are considered . on the contrary ,",
    "macroscopic models are based on assumptions which are hardly correct or at least verifiable ( among others , the actual validity of the continuum hypothesis and the negligibleness of car - to - car interactions ) . as a consequence ,",
    "it is often desirable establishing a connection between microscopic and macroscopic models in order to justify and validate the latter on the basis of the verifiable modeling assumptions of the former .",
    "connections between microscopic follow - the - leader and macroscopic fluid - dynamics traffic flow models are already well understood in the case of vehicles moving on a _",
    "single road_. analogous connections in the case of _ road networks _ are instead lacking .",
    "this is probably due to the fact that macroscopic traffic models on networks are in general ill - posed , since the conservation of the mass is not sufficient alone to characterize a unique solution at junctions .",
    "this ambiguity makes more difficult to find the right limit of the microscopic model , which , in turn , can be defined in different ways near the junctions .",
    "_ in this paper we propose a very natural extension of a first - order follow - the - leader model on road networks and then we prove that its solution tends to the solution of the lwr - based multi - path model introduced in @xcite in the limit , i.e.  as the number of vehicles tends to infinity while their total length is kept constant .",
    "the limit is proved extending to networks the results already existing for a single road , and it is then confirmed by numerical experiments .",
    "it is useful to recall that the multi - path method is able to select automatically an admissible solution at junction , thus resolving ill - posedness issues .",
    "we also recall that the solution selected by the multi - path method does not match the one obtained by maximizing the flux at junction .",
    "therefore , the connection with the microscopic model promotes the solution computed by the multi - path method as `` more natural '' , while the one computed by maximizing the flux should be seen as the `` most desirable '' , to be achieved by means of _ ad hoc _ traffic regulations .    _ relevant literature . _",
    "the literature about microscopic and macroscopic traffic flow models is huge and a detailed review is out of the scope of the paper . for a quick introduction to the field",
    "we suggest the book @xcite and the surveys @xcite .",
    "regarding first - order models on a single unidirectional road , the micro - to - macro limit was already deeply investigated by means of different techniques : the papers @xcite use standard techniques coming from the theory of conservation laws ; the paper @xcite instead proves the limit relying also on measure theory .",
    "the microscopic solution is interpreted as an empirical measure which is proven to converge to the entropy solution of the macroscopic model in the 1-wesserstein topology ; finally , the papers @xcite attack the problem exploiting the link between conservation laws and hamilton - jacobi equations .",
    "micro - to - macro limit for second - order models was instead investigated in @xcite , where the aw - rascle model is derived as the limit of a second - order follow - the - leader model .",
    "macroscopic - only traffic models on networks were deeply investigated starting from @xcite . a complete introduction can be found in the book @xcite , which discusses several methods to characterize a unique solution at junctions .",
    "let us also mention the source - destination model introduced in @xcite ( see also @xcite ) and the buffer models @xcite .",
    "recently , the lwr - based multi - path model on networks was introduced in the paper @xcite , together with a godunov - based numerical scheme to solve the associated system of conservation laws with discontinuous flux .",
    "the relationship between the multi - path model and more standard methods ( like , e.g. , the one proposed in @xcite based on the maximization of the flux at junction ) was investigated in @xcite .    to our knowledge , there is no systematic theory about the extension of the follow - the - leader models on networks .",
    "it is plain that at the microscopic level one can easily reach a high level of detail , including junctions with spatial extension ( non point ) , multi - lane roads , multi - class vehicles , traffic lights and priorities .",
    "several highly sophisticated simulators are available since many years ( free and commercial ) , see , e.g. , @xcite and references therein to have an idea of the models and methods commonly used .",
    "nevertheless , it is unclear which average flux is actually observed at junction by the many - particle limit of any car - following model .    beside this ,",
    "let us also mention that the relationship between microscopic and macroscopic models was exploited to create hybrid models , see , e.g. , @xcite .",
    "in such a models the averaged quantities are observed where a detailed description is not needed ( e.g. , far from the junctions ) while microscopic dynamics are considered elsewhere .",
    "however , this approach gives no clue about the macroscopic behavior of the microscopic model at junctions .",
    "_ paper organization .",
    "_ in section  [ sec : background ] we introduce the follow - the - leader model and the lwr model on a single road .",
    "we also recall the existing results about the micro - to - macro limit on a single road following @xcite . in section",
    "[ sec : ftlnetw ] we extend the follow - the - leader model to networks , and in section [ sec : limit ] , which is the core of the paper , we show the relationship between the follow - the - leader model on networks and the lwr - based multi - path model . in section [ sec : numerics ] we present fully discrete algorithms for the numerical solution to the equations related to the models previously discussed and finally in section [ sec : tests ] we confirm our findings by means of some numerical tests .",
    "let us describe the first - order follow - the - leader model we will use as main ingredient in the rest of the paper .",
    "we assume here that vehicles move on a single infinite road with a single lane .",
    "vehicles are initially located one after the other and can not overtake each other .",
    "we denote by @xmath0 the number of vehicles , by @xmath1 the length of the single vehicles , and by @xmath2 their total length .",
    "we have @xmath3 this relation is crucial for the micro - to - macro limit since it translates the fact that the total length does not change when the number of vehicles tends to infinity , because the cars `` shrink '' accordingly .",
    "we denote by @xmath4 the position of the @xmath5-th car and we assume that at the initial time @xmath6 cars are labeled in order , i.e.  @xmath7 .",
    "this guarantees that the @xmath8-th car is just in front of the @xmath5-th one .",
    "moreover , it is assumed that at @xmath6 cars do not overlap , i.e.  @xmath9 , @xmath10 .",
    "we are now ready to introduce the model , described by the following system of odes @xmath11 where @xmath12 and @xmath13 is such that @xmath14 , \\qquad w(\\delta):=v\\left(\\frac{\\ell_n}{\\delta}\\right),\\ ] ] with @xmath15;[0,{v_{\\textup{max}}}])$ ] any function such that @xmath16 the @xmath17-th car is the leader and it is assumed to move at maximal velocity @xmath18 .",
    "note that the properties introduced above guarantee that the cars do not overlap at any later time @xmath19 , see ( * ? ? ?",
    "* lemma 1 ) .",
    "the macroscopic limit of the previous model is given by the well known lwr model , which describes the evolution of the average ( normalized ) density of vehicles @xmath20 $ ] by means of the following conservation law @xmath21 relationship ( [ link_v_w ] ) makes the link between the two models .    in order to recall precisely the results about the correspondence between the two models , we need to introduce first the natural spaces for the macroscopic density @xmath22 and for the vectors of vehicles positions @xmath23 , at any fixed time : @xmath24)~:~\\int_{\\mathbb{r}}r(x)dx=\\mathcal l \\text { and supp($r$ ) is compact}\\right\\}\\ ] ] and @xmath25",
    "we also introduce the operators @xmath26 and @xmath27 , defined respectively as @xmath28:=\\mathbf{y}= \\left\\ { \\begin{array}{l } y_n=\\max(\\text{supp}(r ) ) , \\\\",
    "y_i=\\max\\left\\{z\\in{\\mathbb{r}}~:~\\displaystyle\\int_z^{{y_{i+1}}}r(x)dx=\\ell_n\\right\\ } , \\quad i = n-1,\\ldots,2,1 \\end{array } \\right.\\ ] ] and @xmath29:=r_n=\\sum_{i=1}^{n-1}\\frac{\\ell_n}{\\delta_i}\\chi_{[{y_i},{y_{i+1}})},\\ ] ] where @xmath30 is the indicator function of any subset @xmath31 .",
    "the discretization operator @xmath32 acts on a macroscopic density @xmath33 , providing a vector of positions @xmath34 $ ] whose components partition the support of the density into segments on which @xmath22 has fixed integral @xmath35 . on the contrary , the operator @xmath36 antidiscretizes a microscopic vector of positions @xmath37 , giving a _ piecewise constant _",
    "density @xmath38 $ ] .",
    "we are now ready to state the main result about the convergence of the microscopic model ( [ ftl_1road ] ) to the macroscopic one ( [ lwr_1road ] ) .",
    "the proof can be found in @xcite ( see also @xcite ) .",
    "[ teo : rossi ] let ( [ link_v_w ] ) and ( [ properties_of_v ] ) hold .",
    "choose @xmath39)$ ] and @xmath40 $ ] .",
    "let @xmath41 be the solution of ( [ ftl_1road ] ) with initial condition @xmath42 .",
    "define @xmath43 $ ] .",
    "then @xmath44 converges almost everywhere and in @xmath45 to the unique entropy solution @xmath22 to the problem ( [ lwr_1road ] ) with initial condition @xmath46 .",
    "in this section we extend the follow - the - leader model described in section [ sec : background ] to a road network .",
    "we define a road network @xmath47 as a direct graph with @xmath48 arcs ( roads ) and @xmath49 nodes ( junctions ) .",
    "we assume that for each junction @xmath50 , there exist disjoint subsets @xmath51 , representing , respectively , the incoming roads to @xmath52 and the outgoing roads from @xmath52 . among junctions ,",
    "we distinguish two particular subsets consisting of origins @xmath53 , which are the junctions @xmath52 such that @xmath54 , and destinations @xmath55 , which are the junctions @xmath52 such that @xmath56 . finally , we denote by @xmath57 the length of the road @xmath58 for any @xmath59 . at initial time",
    ", @xmath17 vehicles are located anywhere in the network .",
    "a natural extension of the follow - the - leader model is derived as follows .",
    "we label the @xmath17 vehicles by an index @xmath60 and we denote by @xmath61 the road that the vehicle @xmath5 is traveling at time @xmath62 .",
    "we also denote by @xmath4 the position of the vehicle @xmath5 at time @xmath62 , defined as the distance from the origin of the road @xmath63 .",
    "there are three main differences with respect to the model on a single road , which require some modifications in the definition of @xmath64 and @xmath13 .",
    "* a*. the concept of `` ahead '' must be redefined because at junctions it is unclear which is the space in front of a car , unless a preference among the outgoing roads is assigned .",
    "we assume that each vehicle has a sequence of roads ( i.e. , a path ) assigned at the initial time to travel along , so that it is always clear which is the space in front of the vehicle .",
    "we also assume that drivers can actually see the space ahead , so that they can always evaluate the distance between them and the car in front , even if the latter is in the next road .",
    "given that , _ a vehicle is a leader if it is the first vehicle on its road and there is no other vehicles in the next roads along its path_. it is important to note that now more than one leader can be present on the network at the same time , and vehicles can gain or loose the leadership .",
    "* b*. the vehicle @xmath65 is no longer necessarily in front of vehicle @xmath5 .",
    "this force us to introduce a new notation to refer to the vehicle in front . if a vehicle is not a leader , we denote by @xmath66 the label of the car just in front of car @xmath5 .",
    "if it is a leader , we set @xmath67 .",
    "the distance between a ( nonleader ) vehicle and the vehicle in front is now computed as @xmath68 ( l^{{\\textsc{r}}(i , t)}-{y_i}(t))+\\sum_{\\textsc{s } } l^\\textsc{s } + y_{{\\textsc{next}}(i)}(t ) , & \\text{if } { \\textsc{r}}(i , t)\\neq{\\textsc{r}}({\\textsc{next}}(i),t ) \\end{array } \\right.\\ ] ] where the summation with respect to s is done over all the empty roads between @xmath63 and @xmath69 ( if any ) along the sequence of roads followed by vehicle @xmath5 .",
    "it is important to note that @xmath70 is in general discontinuous because at any time other cars can join or leave the @xmath5-th car s path , thus reducing or increasing abruptly the distance @xmath71 ( or even changing the leader / follower status of the @xmath5-th car ) .    *",
    "c*. the non - overlapping condition @xmath72 is no longer guaranteed , even if it holds at the initial time @xmath6 . to see this ,",
    "let us consider the simple case of a merge , see fig .",
    "[ fig : overlapping ] .",
    "assume that the outgoing road is empty and some cars are traveling along both the incoming roads ( fig .",
    "[ fig : overlapping]-left ) .",
    "assume also that the two leader cars are going to reach the junction nearly or exactly at the same moment ( note that two cars are leader at this time ) .",
    "as soon as one of the two cars goes through the junction , the other one becomes a follower and its distance @xmath71 , defined by ( [ def : deltai ] ) , could be less than @xmath35 or even 0 ( fig .",
    "[ fig : overlapping]-right ) .         however , two important observations can be made :    * the number of overlapping cars at a junction is bounded by the number of incoming roads of that junction . in other words , cars do not stack one over the other without limits , since the newly coming vehicles perceive the presence of the overlapping vehicles in front and behave normally , without getting too close to them . as a consequence ,",
    "the total length of overlapping vehicles will tend to zero as @xmath73 . *",
    "the space interval in which overlap can occur is @xmath74 $ ] , which shrinks to @xmath75 when @xmath76 .    from now on",
    "we allow the above described `` mild '' overlap to happen and we handle it extending the function @xmath13 defined in ( [ link_v_w ] ) by means of a new function @xmath77 defined as follows : @xmath78 , \\qquad   w^*(\\delta)=\\left\\ { \\begin{array}{ll } w(\\delta ) , & \\text{if } \\delta\\geq\\ell_n\\\\ 0 , & \\text{if } \\delta\\leq\\ell_n   \\end{array } \\right.\\ ] ] i.e.  we assume that ( smashed ) vehicles with @xmath79 stops completely until the vehicle in front leaves a space @xmath80 , then they re - start moving normally . if more than one vehicle is found to be _ exactly _ in the same place , the one with the largest label is taken as vehicle `` in front '' and the others `` behind '' .",
    "we are now ready to introduce the follow - the - leader model on networks . for any @xmath60",
    "we write @xmath81 with suitable admissible initial conditions @xmath82 .",
    "in addition , when @xmath83 , the road @xmath63 must be updated according to the @xmath5-th vehicle s path and @xmath4 must be reset to 0 ( similarly to a new initial condition ) .",
    "the extension of the follow - the - leader model described above defines implicitly a certain behavior of vehicles at junctions .",
    "since vehicles can not overtake each other , they basically adopt a fifo behavior ( see ( * ? ? ?",
    "* appendix b ) for a general discussion in the context of traffic flow ) . consider for example the case of a diverge ( see fig .",
    "[ fig : networks_for_tests](top - right ) ) and assume that one of the two outgoing roads is fully congested . if the first car on the incoming road wants to go to the congested road , it will stop .",
    "after that , all the following cars will stop too , even if they want to turn to the other outgoing road .",
    "the fifo behavior will be kept in the macroscopic limit .    beside the overlap issue",
    ", the model exhibits other unrealistic behaviors .",
    "let us consider the junction depicted in fig .",
    "[ fig : networks_for_tests](bottom ) .",
    "if two cars arrive at the junction from distinct roads exactly at the same time and then they want to go to distinct roads , they will not be affected at all by each other , and , in particular , they will not slow down .",
    "this odd behavior can be easily avoided by considering enlarged ( non point ) junctions or allowing cars which approach a junction to see along _ all _ the incoming roads , but then it can be more difficult to prove the relationship between the microscopic model and the corresponding macroscopic model .      in order to pass to the limit for @xmath73 , it is convenient to reformulate the model introduced in the previous section",
    ". let us consider all the possible paths on @xmath47 joining all the origin nodes @xmath53 with all the destination nodes @xmath55 , see fig .",
    "[ fig : paths ] .",
    "each path is considered as a _ single uninterrupted road _ , with no junctions ( except for its origin and destination ) .",
    "[ width=0.49]./figs / networkp1 ( 8,28)@xmath84    [ width=0.49]./figs / networkp2 ( 80,22)@xmath85    note that paths can share some arcs of the network .",
    "let us denote by @xmath86 the total number of paths and let us divide the @xmath17 vehicles in @xmath86 populations , on the basis of the path they are following .",
    "let us denote by @xmath87 , @xmath88 , the number of vehicles following path @xmath89 ( we have @xmath90 ) , and label _ univocally _ all vehicles by the multi - index @xmath84 , @xmath91 ,  @xmath88 .",
    "let us also denote by @xmath92 the position of the vehicle @xmath5 of population @xmath89 at time @xmath62 , defined as the distance from the origin of the path @xmath89 ( not from the origin of the current road ) . since paths can overlap , a vehicle @xmath85 belonging to a population @xmath93 with position @xmath94 can be found along path @xmath89 at time @xmath62",
    "let us denote by @xmath95 the distance between the vehicle @xmath85 at time @xmath62 and the origin of path @xmath89 , along path @xmath89 .",
    "in other words @xmath96 acts as a change of coordinates between any path @xmath93 intersecting path @xmath89 and path @xmath89 . the function @xmath96 is trivially extended to vehicles already belonging to population @xmath89 simply setting @xmath97 .",
    "most important , we redefine the concept of distance between two vehicles .",
    "first , we define @xmath98 as the multi - index of the nearest vehicle belonging to population @xmath99 in front of the vehicle @xmath84 along the path @xmath89 ( setting it to @xmath75 if there is no such a vehicle ) .",
    "then , we define the @xmath89-_distance _ between a ( nonleader ) vehicle and the vehicle in front as @xmath100 this corresponds to consider only vehicles of population @xmath89 , neglecting the presence of the others .",
    "we also keep considering the distance between two contiguous vehicles traveling along path @xmath89 , regardless the population they belong to . to this end we define , for any nonleader vehicle of any population , @xmath101 where @xmath102 is the vehicle in front of the vehicle @xmath85 , no matter the population it belongs to .    in the new formulation",
    "the model ( [ ftl_netw ] ) becomes , @xmath103 for any @xmath88 and @xmath91 .",
    "note that ( [ ftl_netw_paths ] ) is a system of @xmath86 coupled systems of odes with discontinuous right - hand side .",
    "as already mentioned , the discontinuity comes from the fact that cars following paths other than @xmath89 can abruptly join or leave path @xmath89 , thus decreasing or increasing the distance @xmath104 .",
    "however , in the time intervals in which no car crosses junctions the system falls in the standard theory of the odes . to deal with the discontinuity",
    ", we will consider the integral form of ( [ ftl_netw_paths ] ) and we assume that there exists a solution in the sense of carathodory .",
    "to begin with , we note that condition ( [ link_v_w ] ) clarifies the relationship between the average density and the distance between vehicles which is valid in the limit @xmath73 ( see theorem [ teo : rossi ] ) .",
    "it states that @xmath105 in section [ sec : ftlnewtpaths ] we have introduced @xmath89-distances which must be now related to the right average densities . to do that ,",
    "let us use again ( with an abuse of notation ) the operators @xmath32 and @xmath36 introduced in section [ sec : background ] , modifying in a obvious manner the sets @xmath106 ( considering the total length @xmath107 of cars belonging to population @xmath89 ) and @xmath108 to deal with the new framework .",
    "define @xmath109 and @xmath110 the new density functions are @xmath111= \\sum_{\\substack{\\text{followers $ ( i , p)$ } \\\\   \\text{of pop.\\ } p}}\\frac{\\ell_n}{\\delta_i^p}\\chi_{[y_{i , p}(t),y_{{\\textsc{next}}(i , p;p)}(t))},\\ ] ] @xmath112= \\sum_{\\substack{\\text{followers $ ( k , q)$ } \\\\",
    "\\text{on path } p \\\\",
    "pop.)}}}\\frac{\\ell_n}{\\delta_{k , q}^p}\\chi_{[c_p(k , q , t),c_p({\\textsc{next}}(k , q;\\bullet),t))}.\\ ] ] both functions @xmath113 and @xmath114 are defined on the whole path @xmath89 .",
    "the function @xmath115 corresponds to the density of vehicles belonging to population @xmath89 , while the function @xmath116 represents the _ total _ density along path @xmath89 , which depends on all vehicles belonging to population @xmath89 plus all vehicles following a path @xmath99 which shares some roads with path @xmath89 , see fig .",
    "[ fig : mu_omega ] .    [ width=0.75]./figs / mu_omega ( 8,28)@xmath115 ( 40,33)@xmath116    defining the limits ( if they exist ) @xmath117 we get , in analogy to ( [ m2m_crucial ] ) , @xmath118    in order to introduce the macroscopic model we will also need the correspondence between the microscopic and the macroscopic velocity . to this end",
    ", we define the function @xmath119 such that @xmath120,\\qquad   v^*(r)= \\left\\ { \\begin{array}{ll } v(r ) , & \\text{if } r\\leq 1 \\\\ 0 , & \\text{if } r\\geq 1 .",
    "\\end{array } \\right.\\ ] ] it is easy to see that the relation in ( [ link_v_w ] ) still holds , more precisely @xmath121    at this point it is crucial to note that a path , by definition , has no junctions ( except for its origin and destination ) and therefore is indistinguishable from a single road . as a consequence",
    ", we can follow in broad terms the results already proved in @xcite for the micro - to - macro limit on a single road .    using ( [ m2m_new ] ) , and reasoning by analogy with the 1d case , we claim that , for any fixed @xmath88 , the macroscopic equation associated to the model ( [ ftl_netw_paths ] ) is @xmath122 note that in equation ( [ lwrlimit ] ) both densities @xmath123 and @xmath124 appear .",
    "this is due to the fact that equation ( [ ftl_netw_paths ] ) describes the evolution of the population @xmath89 only , but the velocity is evaluated considering the distance @xmath125 , which is indeed related to the _ total _ density on the path . equation ( [ lwrlimit ] ) accounts for all populations of cars and then it must be seen as a system of pdes .    to prove the correspondence ,",
    "let us fictitiously extend each path to @xmath126 , setting the density to 0 after the leader and before the last follower . in this way",
    "we simplify the problem getting rid of the boundary conditions .    before entering the proof of the main result",
    ", we need to simplify the notations .",
    "fix @xmath127 and denote by @xmath5 the index of a generic nonleader car belonging to the @xmath89-th population .",
    "denote the index of the first car ahead of the @xmath5-th one , belonging to population @xmath89 , simply by @xmath65 .",
    "denote by @xmath128 the index of a generic car belonging to any population , including the @xmath89-th one .",
    "denote the index of the car in front of the @xmath128-th car by @xmath129 .",
    "finally , denote by @xmath130 the index of a generic car belonging to any population between car @xmath5 ( included ) and car @xmath65 ( excluded ) , see fig .",
    "[ fig : proof](top ) ; and by @xmath131 the index of the first car belonging to population @xmath89 on the left of the car @xmath128 ( @xmath132 if the @xmath128-th car belongs to population @xmath89 ) , see fig .",
    "[ fig : proof](bottom ) . assume for simplicity that the leftmost car belongs to population @xmath89 so that @xmath131 is well defined .",
    "[ width=]./figs / proof ( 12.0,5)@xmath133(45,5)@xmath5(88,5)@xmath134(63.5,5)@xmath130     +    [ width=]./figs / proof ( 44.5,5)@xmath131(63.5,5)@xmath128(69.5,5)@xmath135(87,5)@xmath136    denote the initial density for the vehicles of population @xmath89 by @xmath137)$ ] ( dropping the superscript @xmath89 for simplicity ) , and denote the corresponding initial positions of vehicles by @xmath138 .",
    "denote the positions of the @xmath87 vehicles of population @xmath89 at time @xmath62 by @xmath139 and the positions of vehicles of any population ( @xmath89-th included ) at time @xmath62 by @xmath140 ( note that their number is variable in time ) .",
    "finally let us denote by @xmath141 the final time for the simulation and consider a test function @xmath142\\times{\\mathbb{r}};{\\mathbb{r}})$ ] .",
    "we are now ready to prove the correspondence between the microscopic follow - the - leader model ( [ ftl_netw_paths ] ) and the macroscopic model ( [ lwrlimit ] ) , for any fixed @xmath127 . recalling ( * ? ? ? * formula ( 4.5 ) )",
    "the weak ( integral ) form of the equation ( [ lwrlimit ] ) with the initial condition @xmath143 , we compute @xmath144 by definition , the densities @xmath145 and @xmath146 are constant in the interval @xmath147 for any @xmath62",
    ". therefore we have @xmath148 where @xmath149 . denoting by @xmath150 the total derivative of @xmath151 w.r.t .",
    "time , we have , for @xmath152 , @xmath153 where the quantity @xmath154 uniformly bounds from above the modulus of @xmath151 and all its derivatives up to second order .",
    "equivalently , we can write @xmath155 using the latter estimate in the expression for @xmath156 above and defining @xmath157 we get @xmath158 @xmath159 @xmath160 @xmath161 @xmath162 at this point we got rid of the populations @xmath99 s , @xmath93 , and thus we are back to the case of a single road with a single population of vehicles . by the way",
    ", we have also resolved the discontinuity issues around the junctions .",
    "therefore , from now on the proof follows the one in @xcite .",
    "recalling that @xmath163 , we have @xmath164 @xmath165 to proceed further , let us define @xmath166 and note that it does not depend on @xmath87 or @xmath17 .",
    "we have @xmath167 since @xmath168 ( see ( * ? ? ?",
    "2.1 ) ) and @xmath169 , all the terms in the latter quantity vanish as @xmath76 .",
    "moreover there exists @xmath170 such that @xmath171 almost everywhere ( see ( * ? ? ?",
    "3 ) ) . in conclusion",
    ", we have proved the following    [ teo : mainresult ] let ( [ link_v_w ] ) and ( [ properties_of_v ] ) hold , and consider the extensions ( [ def : w * ] ) and ( [ def : v * ] ) .",
    "fix @xmath127 , and choose @xmath172)$ ] and @xmath173 $ ] .",
    "let @xmath174 be the solution of ( [ ftl_netw_paths ] ) with initial condition @xmath175 ( assuming the other solutions @xmath176 , @xmath177 are given ) .",
    "define @xmath178 $ ] .",
    "then , @xmath179 is a weak solution to ( [ lwrlimit ] ) ( assuming the other solutions @xmath180 , @xmath93 are given ) with initial condition @xmath181 .",
    "now we note that the system of pdes ( [ lwrlimit ] ) is nothing else that the multi - path model studied in @xcite , @xmath182 where @xmath183 is the sum of all densities @xmath184 , @xmath185 , living at time @xmath62 at the point @xmath186 along path @xmath89 and @xmath187 is the velocity of the cars .",
    "it is a system of @xmath86 conservation laws with discontinuous flux which provides an alternative method to deal with traffic flow on networks .",
    "it is characterized by the fact that junctions are embedded in the equations themselves , so that the dynamics at junctions have not to be resolved separately by _ ad hoc _ procedures , like , e.g. , the maximization of the flux .",
    "it appears that the model maximizes the flux but under the additional constraints of equidistribution of the fluxes from the incoming roads ( i.e.  the incoming roads have assigned the same priority ) .",
    "we proved the correspondence in the limit between the microscopic and the macroscopic model _",
    "population by population _",
    ", i.e.  fixing @xmath89 and assuming the other solutions to be given .",
    "this is different from considering the convergence of the fully coupled system of odes ( [ ftl_netw_paths ] ) to the system of pdes ( [ lwrlimit ] ) . on the other hand ,",
    "a complete study is much harder because the microscopic vector field is not regular and because theoretical results for the multi - path model are still missing .",
    "in this section we give some details about the discretization of the microscopic and macroscopic equations .      for numerical purposes , it is convenient to discretize the follow - the - leader model as it is described in section [ sec : ftlnetw_natural ] , rather than its equivalent formulation on paths .",
    "first we set @xmath188 and @xmath189 then , we introduce a time step @xmath190 and we denote by @xmath191 , @xmath192 the approximate position @xmath193 of the vehicle @xmath5 at time @xmath194 .",
    "the discretization is obtained by the explicit euler scheme @xmath195 for any car @xmath60 , and admissible initial condition @xmath196 .",
    "when a vehicle crosses the junction and goes beyond it , let say @xmath197 , it is assigned to the next road on the basis of its preference , and its position is updated as @xmath198 .",
    "we assume that no cars enter the road network after the initial time and that cars leave the network once they have reached a destination node .    at the discrete level",
    ", a cfl - like condition is needed to ensure that vehicles do not bump into the one in front .",
    "far from the junction , this condition is given by @xmath199 substituting ( [ greeshields ] ) in ( [ cfl_ftl_gen ] ) we get @xmath200 unfortunately , this condition does not prevent vehicle overlapping near the junction , as already discussed in section [ sec : ftlnetw_natural ] . in a discrete",
    "setting , the overlapping can happen also _ after _ the junction , more precisely it can happen either in the space interval @xmath201 $ ] of one incoming road @xmath58 or in the space interval @xmath202 of one outgoing road .",
    "@xmath203 is the maximal distance one vehicle can travel in one time step .",
    "it can be seen that in the discrete setting the overlapping zone shrinks to @xmath75 for @xmath73 and @xmath204 , and not only for @xmath73 . however , the overlapping is still `` mild '' , in the sense that the number of bumped vehicles is bounded by the number of incoming roads , see section [ sec : ftlnetw_natural ] .      for the numerical discretization of the multi - path system ( [ lwrlimit ] )",
    "we employ the godunov - based scheme introduced in @xcite . for the sake of completeness",
    ", we briefly recall the scheme . along each path",
    "@xmath89 , a space discretization is considered , defining a space step @xmath205 and space nodes @xmath206 , @xmath207 , where @xmath208 is the number of space nodes on path @xmath89 .",
    "we denote by @xmath209 and @xmath210 the approximations of the values @xmath211 and @xmath212 , respectively .",
    "the scheme reads , for any @xmath207 and @xmath213 , @xmath214 with initial conditions @xmath215 , and @xmath216 note that @xmath217 is the sum of all densities living at @xmath218 ( along path @xmath89 ) at time @xmath219 .",
    "the function @xmath220 is instead the classical godunov flux @xmath221 where @xmath222 } f(\\rho)$ ] . recalling ( [ greeshields ] ) , we have @xmath223 and @xmath224 .",
    "we employ dirichlet - zero boundary conditions @xmath225 at origin and destination nodes .    the multi - path model , at least at the discrete level , does not allow the total density to be larger than 1 ( * ? ? ?",
    "this seems in contradiction with the possibility of overlapping in the microscopic model .",
    "actually this is not , because the overlapping is `` mild '' , i.e.  it concerns at most a finite number of cars , and then it is invisible at macroscopic level . however , a counterpart of the overlapping features at macroscopic level exists : the cells after the junctions act as a sort of _ buffer _ ( * ? ? ?",
    "5.2 ) , which is able to gather a flux of vehicles larger than maximal one , which is @xmath226 .",
    "the actual maximal flux is instead @xmath227 , where @xmath228 is the number of incoming roads .",
    "in this section we study the micro - to - macro limit by means of some numerical tests , finding a good agreement with theoretical findings of the previous sections .",
    "we consider the case of a simple network with 1 junction and ( i ) a merge , ( ii ) a diverge , and ( iii ) 2 incoming roads and 2 outgoing roads , see fig .",
    "[ fig : networks_for_tests ] .    [ width=0.49]./figs/2in1 ( 20,38)road 1 ( 18,15)road 2 ( 67,20)road 3    ./figs/1in2 ( 20,22)road 1 ( 60,35)road 3 ( 70,15)road 4     +    ./figs/2in2 ( 20,38)road 1 ( 14,16)road 2 ( 58,35)road 3 ( 70,17)road 4    in the cases ( ii ) and ( iii ) , additional parameters are needed to describe the behavior of the vehicles at the junction .",
    "they are usually referred to as _ distribution coefficients _ and specify the percentage of vehicles which wish to turn to the left and to the right .",
    "since we are considering here simple networks with only 1 junction , specifying the car s turning conduct at junction is equivalent to define the car s path on the network . in the case of more complex networks with more than 1 junction",
    ", we should instead assign the whole sequence of decisions each car makes at junctions . if we stick with per - junction coefficients , thus losing the global behavior of drivers , we expect convergence , in the limit , to the hybrid version of the multi - path model described in ( * ? ? ?",
    "* remark 1 ) .",
    "let us denote the distribution coefficients by @xmath229 , where @xmath230 is the index of the incoming road and @xmath231 is the index of the outgoing road .",
    "clearly it is required that @xmath232 in the follow - the - leader model , each vehicle traveling along road @xmath230 is assigned to the road @xmath231 with probability @xmath233 . in the multi - path model ,",
    "these coefficients are used to define properly the partial densities @xmath123 s at the initial time given the initial condition for the total density .    to improve readability and ease the comparison",
    ", we only show the total density , and we redefine it on single roads , rather than on paths .",
    "we also come back to the original notation @xmath22 , denoting by @xmath234 the total density on each road @xmath59 .",
    "we assume that all roads have the same length @xmath235 , and we divide them in @xmath236 space nodes .",
    "comparison with the solution of the multi - path scheme is obtained by computing the average density of the microscopic vehicles , defined for each space node @xmath128 and time step @xmath237 as @xmath238:= \\frac{\\ell_n}{\\delta x}\\#{\\{i~:~y_i^s\\in [ x_k , x_{k+1})\\}},\\ ] ] where @xmath239 denotes the cardinality of any set @xmath240 .",
    "this quantity corresponds to the total length of cars found in each space cell divided by the length of the cell .      in this section",
    "we consider a network with three roads and one junction , with two incoming roads and one outgoing road .",
    "we denote by @xmath241 , @xmath242 and @xmath243 the density on the first incoming road , the second incoming road and the outgoing road , respectively ( fig .",
    "[ fig : networks_for_tests ] ) .",
    "initial conditions are @xmath244 we run the simulation until the final time @xmath245 .",
    "[ fig:2in1_results ] shows the density computed by the multi - path model and the follow - the - leader model for two different choices of @xmath35 and @xmath246 .",
    "( blue circles ) . left : @xmath247 ( max number of cars per cell @xmath248 ) , @xmath249 .",
    "right : @xmath250 ( max number of cars per cell @xmath251 ) , @xmath252.,title=\"fig:\",scaledwidth=46.0% ]   ( blue circles ) . left : @xmath247 ( max number of cars per cell @xmath248 ) , @xmath249 .",
    "right : @xmath250 ( max number of cars per cell @xmath251 ) , @xmath252.,title=\"fig:\",scaledwidth=46.0% ]    since the outgoing road is not able to gather the fluxes coming from the incoming roads , two queues are formed and propagate back along the incoming roads ( with different speed ) .",
    "incoming fluxes are equidistributed and queues have the same level of density , equal to @xmath253 such that @xmath254 . since we compare two numerically approximate densities , we expect a perfect match only for @xmath73 and @xmath255 .",
    "that said , numerical evidence confirms the convergence results , and also shows that the microscopic scheme is not diffusive as instead it is the macroscopic scheme .",
    "this is perfectly visible across the discontinuities .      in this section",
    "we consider a network with three roads and one junction , with one incoming road and two outgoing roads .",
    "we denote by @xmath241 , @xmath243 and @xmath256 the density on the incoming road , the first outgoing road and the second outgoing road , respectively ( fig .",
    "[ fig : networks_for_tests ] ) .",
    "initial conditions are @xmath257 and distribution coefficients are @xmath258 we run the simulation until the final time @xmath245 . fig .",
    "[ fig:1in2_results ] shows the density computed by the multi - path model and the follow - the - leader model for two different choices of @xmath35 and @xmath246 .",
    "( blue circles ) . left : @xmath259 ( max number of cars per cell @xmath260 ) , @xmath261 .",
    "right : @xmath262 ( max number of cars per cell @xmath263 ) , @xmath264.,title=\"fig:\",scaledwidth=46.0% ] ( blue circles ) . left : @xmath259 ( max number of cars per cell @xmath260 ) , @xmath261 .",
    "right : @xmath262 ( max number of cars per cell @xmath263 ) , @xmath264.,title=\"fig:\",scaledwidth=46.0% ]    as expected , the density splits among the two outgoing roads .",
    "the corresponding flux splits with ratio @xmath265 and mass is conserved .",
    "again , numerical evidence confirms the convergence results , however , the convergence is much slower than the previous case .",
    "this is probably due to the presence of the distribution coefficients @xmath266 which introduce stochasticity in the system .",
    "note that we are showing the outcome of a single run and not the average of many runs .      in this section",
    "we consider a network with four roads and one junction , with two incoming roads and two outgoing roads .",
    "we denote by @xmath241 , @xmath242 , @xmath243 and @xmath256 the density on the first incoming road , the second incoming road , the first outgoing road , and the second outgoing road , respectively ( fig .",
    "[ fig : networks_for_tests ] ) .",
    "initial conditions are @xmath267 and distribution coefficients are @xmath268 we run the simulation until the final time @xmath269 . fig .",
    "[ fig:2in2_results ] shows the density computed by the multi - path model and the follow - the - leader model .",
    "( blue circles ) .",
    "@xmath270 ( max number of cars per cell @xmath271 ) , @xmath272.,scaledwidth=70.0% ]    again , numerical evidence confirms the convergence results , however , the convergence is even slower than the previous case .",
    "in this paper we have investigated the many - particle limit for a natural extension of the follow - the - leader model on networks .",
    "numerical tests have shown a slow convergence to the limit solution .",
    "this means that a large number of particles is required to get a precision comparable with that of the associate macroscopic model . in addition , the vector storing cars indices must be reordered after every time step in order to find the car in front of any car , so that a long computational time is needed . in conclusion , we discourage the use of the microsimulator but our results justify any multiscale approaches where the micro and the macro scale live together and exchange information .    the convergence result proven in this paper is only one of the possible micro - to - macro limits which can be investigated in the framework of traffic flow models on networks .",
    "first of all , one could define the proper follow - the - leader model which corresponds to , e.g. , the lwr model with maximization of flux at junctions .",
    "this requires a nontrivial management of the junctions , in which an authority is able to decide who passes the junction and when .",
    "second , one can consider analogous techniques for second - order models . in this case",
    "the problem is completely open because a second - order multi - path does not yet exist and then it can be difficult to find the right limit model .",
    "finally , it could be interesting the investigation of the many - particle limit for meso - to - macro models . to this end",
    ", useful references could be the papers @xcite , which deals with kinetic models on networks , and @xcite about fundamental diagrams for kinetic equations .",
    "the authors wish to thank f. s. priuli , m. falcone , and b. piccoli for the useful discussions and suggestions .",
    "a. bressan , _ hyperbolic systems of conservation laws . the one - dimensional cauchy problem _ , volume 20 of oxford lecture series in mathematics and its applications .",
    "oxford university press , oxford , 2000 .",
    "m. di francesco and m. d. rosini , _ rigorous derivation of nonlinear scalar conservation laws from follow - the - leader type models via many particle limit _ , arch .",
    "rational mech .",
    ", * 217 * ( 2015 ) , 831871 .",
    "m. fellendorf and p. vortisch , _ microscopic traffic flow simulator vissim _ , in : j. barcel ( ed . ) , fundamentals of traffic simulation , international series in operations research & management science 145 , 6393 , springer , 2010 .",
    "m. garavello and b. piccoli , _ a multibuffer model for lwr road networks _ , advances in dynamic network modeling in complex transportation systems , complex networks and dynamic systems , vol .  2 , 2013 , 143161 ."
  ],
  "abstract_text": [
    "<S> connections between microscopic follow - the - leader and macroscopic fluid - dynamics traffic flow models are already well understood in the case of vehicles moving on a single road . </S>",
    "<S> analogous connections in the case of road networks are instead lacking . </S>",
    "<S> this is probably due to the fact that macroscopic traffic models on networks are in general ill - posed , since the conservation of the mass is not sufficient alone to characterize a unique solution at junctions . </S>",
    "<S> this ambiguity makes more difficult to find the right limit of the microscopic model , which , in turn , can be defined in different ways near the junctions . in this paper </S>",
    "<S> we show that a natural extension of the first - order follow - the - leader model on networks corresponds , as the number of vehicles tends to infinity , to the lwr - based multi - path model introduced in @xcite .    </S>",
    "<S> emiliano cristiani    istituto per le applicazioni del calcolo `` m. picone ''    consiglio nazionale delle ricerche    rome , italy    smita sahu    dipartimento di matematica `` g. castelnuovo ''    sapienza , universit di roma    rome , italy </S>"
  ]
}