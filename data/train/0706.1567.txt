{
  "article_text": [
    "we define a _ circulant _ to be any square matrix whose rows are consecutive right circular shifts of each other . in other words",
    ", it is any @xmath0-by-@xmath0 matrix @xmath12 where @xmath13 depends only on @xmath14 mod @xmath0 .",
    "thus , a circulant is a special type of toeplitz matrix .",
    "circulant matrices occur in numerous applications and have been studied extensively ; for instance , see @xcite .",
    "surprisingly , for many applications the interest in circulants does not directly stem from the circular symmetry just described .",
    "for example , every desarguesian finite projective plane can be represented as a circulant , by a theorem of singer . in other words ,",
    "if @xmath15 is a prime power , there is an @xmath0-by-@xmath0 circulant matrix ( where @xmath16 ) in which each row has @xmath17 entries being @xmath2 and the rest being @xmath1 , with the further condition that the componentwise product of any two rows has exactly one @xmath2 . here",
    "the rows represent lines and the columns points , where a line contains a point whenever the corresponding entry in the circulant is a @xmath2 .",
    "in this paper we are primarily interested in circulants with entries @xmath1 and @xmath2 , which we call @xmath18  circulants .",
    "one can think of a @xmath18  circulant as an incidence structure , or as the nonzero block of the adjacency matrix of a bipartite graph .",
    "many interesting examples of incidence structures correspond to @xmath18  circulants ; for instance , these include the much - studied subject of `` cyclic difference sets '' .",
    "the _ weight _ of a @xmath18  circulant is the number of @xmath2 s in each row .",
    "often the @xmath0-by-@xmath0 circulants of interest have weight quite small compared to @xmath0 . in this paper",
    "we prove that , for circulants of weight at most @xmath6 , various equivalence relations are the same .",
    "we need some notation to state our result . for any @xmath0-by-@xmath0 @xmath18  circulant @xmath3 ,",
    "let @xmath19 be the set of integers mod  @xmath0 corresponding to the columns in which the top row of @xmath3 contains an entry @xmath2 ; here the leftmost column is labeled @xmath1 , the next is @xmath2 , and so on . also , @xmath20 denotes the transpose of the matrix @xmath3 .",
    "[ thm intro ] let @xmath3 and @xmath4 be two @xmath0-by-@xmath0 @xmath18  circulants of weight at most @xmath6",
    ". then the following are equivalent :    1 .",
    "there exist @xmath21 such that @xmath22 and @xmath9 .",
    "2 .   there are @xmath0-by-@xmath0 permutation matrices @xmath10 such that @xmath11 .",
    "3 .   there is an @xmath0-by-@xmath0 permutation matrix @xmath23 such that @xmath24 .",
    "the complex matrices @xmath25 and @xmath26 are similar .",
    "it is not difficult to prove that @xmath27 .",
    "the bulk of our effort in proving theorem  [ thm intro ] is devoted to proving @xmath28 in the case of weight @xmath6 ( smaller weights are easier to handle ) .",
    "we give counterexamples to this result for every weight larger than @xmath6 .",
    "however , for weights @xmath29 and @xmath30 , the result can be salvaged to some extent : we show that it holds as long as every prime factor of @xmath0 is sufficiently large . on the other hand , for each weight exceeding @xmath30 , we give counterexamples for every sufficiently large @xmath0 .    in the context of isomorphisms of circulant graphs ,",
    "many authors have studied questions of a similar flavor as theorem  [ thm intro ] . in that context , we restrict to @xmath31 in condition ( 1 ) and to @xmath32 in ( 2 ) , getting conditions ( 1 ) and ( 2 ) .",
    "the equivalence of ( 1 ) and ( 2 ) is known as the dm  problem ; it is not always true , but the combined efforts of several authors have shown precisely when it holds ( cf .",
    "@xcite and the references therein ) .",
    "likewise , the equivalence of ( 1 ) to the similarity of @xmath3 and @xmath4 is called the spectral dm  problem , and is still being studied @xcite .",
    "the equivalence of ( 1 ) and ( 2 ) amounts to a bipartite analogue of the dm  problem . from the perspective of circulant matrices ,",
    "condition ( 2 ) is a more natural equivalence than ( 2 ) , and condition ( 2 ) arises in various applications .    in the next section",
    "we prove some preliminary results about the various equivalence relations under consideration .",
    "then in section  [ sec 2 ] we give a quick proof of theorem  [ thm intro ] in case the weight @xmath33 is at most @xmath34 .",
    "the next three sections prove theorem  [ thm intro ] in the much more difficult case @xmath35 : in section  [ sec sda ] we reduce the problem to a question about vanishing sums of roots of unity , which we resolve in sections  [ sec roots ] and [ sec 3 ] .",
    "we discuss the cases @xmath36 and @xmath37 in section  [ sec 4 ] , and the case @xmath38 in section  [ sec 6 ] . in section",
    "[ sec adam ] we explain how our problem relates to the dm   problem .",
    "finally , in section  [ sec ack ] we suggest some directions for future research .",
    "in almost any application of circulants , the first row can be replaced with any circular shift of itself .",
    "for example , both circulants below represent the projective plane of order 2 ( also known as the fano plane ) :    @xmath39    applying a circular shift to every row of a circulant has the effect of applying a circular shift to the order of the rows , which is equivalent to applying a circular shift to the columns .",
    "the top row of a circulant can be identified with a set of residues mod  @xmath0 , by listing the positions containing an entry of @xmath2 ; here the leftmost position is labeled @xmath1 , the next is labeled @xmath2 , and so on .",
    "thus , the circulants above are identified with the sets @xmath40 and @xmath41 mod  @xmath42 , which we will denote as @xmath43 and @xmath44 .",
    "we now establish some notation that will be used throughout the paper .",
    "let @xmath45 be the unit circular shift on @xmath0-dimensional vectors over @xmath46 .",
    "thus , if @xmath47 is a column unit vector with a @xmath2 in position @xmath48 and a @xmath1 elsewhere , then @xmath45 is defined by @xmath49 for @xmath50 , where the indices are computed mod  @xmath0 . in other words , @xmath45 is the matrix @xmath51 note that the transpose of @xmath45 equals the inverse of @xmath45 , and also the powers of @xmath45 are precisely the circular shifts by various amounts .",
    "the circulant corresponding to the residue set @xmath52 is @xmath53    for the applications we have in mind , we want to consider two circulants equivalent if one can be obtained from the other by row and column permutations .",
    "this motivates the following definition :    two circulants @xmath3 and @xmath4 are said to be _",
    "p-_q _ _  _ equivalent _ if there exist permutation matrices @xmath23 and @xmath54 such that @xmath55 .",
    "this clearly defines an equivalence relation .",
    "however , note that for most choices of @xmath0-by-@xmath0 matrices @xmath56 , where @xmath3 is a @xmath18  circulant and @xmath23 and @xmath54 are permutation matrices , the matrix @xmath57 will not be circulant . in order that @xmath57 be circulant , @xmath23 and @xmath54 must be quite special .    applying a circular shift to a circulant has the effect of adding a constant to its set of residues , i.e. , applying an element of the additive group of residues mod  @xmath0 .",
    "this operation leads to a _",
    "p-_q _ _   equivalent matrix , since , we can take @xmath23 to be the shift and @xmath54 to be the identity .",
    "it is also true , but less obvious , that multiplication by a unit @xmath8 mod @xmath0 produces a _",
    "_   equivalent circulant : here we choose @xmath58 and @xmath59 , so if the residue set of @xmath3 is @xmath52 then the residue set of @xmath57 is @xmath60 .",
    "we restate this as the following definition and proposition .",
    "two subsets @xmath61 are _ linearly equivalent _ if there is a unit @xmath8 in @xmath62 such that @xmath63 .",
    "the two sets are _",
    "affinely equivalent _ if there exist @xmath21 , with @xmath8 a unit , such that @xmath64 .",
    "[ prop affpq ] if two subsets of @xmath62 are affinely equivalent , then the associated @xmath18  circulants are _ p-_q _",
    "_   equivalent .",
    "the main focus of this paper is on the converse of this result .",
    "the following example shows that the converse is not always true .",
    "it exhibits an explicit _ p-_q _ _   equivalence between the circulants having residue sets @xmath65 these sets are affinely inequivalent since the first set has two arithmetic progressions of length @xmath6 ( @xmath66 and @xmath67 ) but the second set has none .",
    "@xmath68 where    @xmath69    we now derive a crucial property of _",
    "p-_q _ _  equivalent circulants . if @xmath3 and @xmath4 are",
    "_ p-_q _ _  equivalent circulants , then @xmath70 since the the transpose of a permutation matrix is its inverse .",
    "this proves a necessary condition for _ p-_q _ _  equivalence :    [ prop pqspec ] if the circulants @xmath3 and @xmath4 are _ p-_q _",
    "_   equivalent then @xmath25 and @xmath26 are similar matrices , and in fact there is a permutation matrix which conjugates one to the other .",
    "we call @xmath25 the _ autocorrelation matrix _ of the circulant @xmath3 . in the example above , the autocorrelation matrices are actually equal , not just similar . note that if @xmath3 is a circulant then @xmath25 is also a circulant , although if @xmath3 is a @xmath18  circulant then @xmath25 might not be @xmath18  -valued : if @xmath71 then @xmath72    in order to discuss when circulant matrices are similar , we first compute their eigenvalues . we do this via the well - known method for diagonalizing circulant matrices",
    ". let @xmath73 be the square root of @xmath74 which lies in the upper half - plane .",
    "let @xmath75 and let @xmath76 be the vandermonde matrix @xmath77 .",
    "it turns out that @xmath76 diagonalizes every @xmath0-by-@xmath0 circulant .",
    "let @xmath78 with @xmath79 .",
    "then @xmath80 is a diagonal matrix with @xmath81 ( one way to prove this is to verify directly that @xmath82 , and then use the invertibility of the vandermonde matrix @xmath76 . ) as a result , if @xmath83 is the residue set for a @xmath18  circulant @xmath3 then the multiset of eigenvalues of @xmath25 is @xmath84    [ lcm_prop ] if @xmath3 is the circulant with residue set @xmath85 , then the number of times that @xmath86 occurs as an eigenvalue of @xmath87 is equal to @xmath88 .    if @xmath89 , the gcd is @xmath0 so the statement is true because @xmath90 .",
    "now assume @xmath91 .",
    "as above , the eigenvalues of @xmath87 are in bijection with the values @xmath92 , where @xmath93 corresponds to the sum in ( [ eigen ] ) .",
    "this sum has @xmath86 terms of unit magnitude , so it equals @xmath86 if and only if each term is @xmath2 .",
    "this happens if and only if @xmath94 , where @xmath95 ; this can be restated as @xmath96 .",
    "finally , the number of values @xmath92 with this property is @xmath97 .",
    "in this section we show that , for @xmath98 , two @xmath0-by-@xmath0 @xmath18  circulants of weight @xmath33 are affinely equivalent if and only if they are _ p-_q _ _  equivalent ; in fact , we show that these properties are equivalent to similarity of the autocorrelation matrices . if @xmath99 this is clear , since all @xmath0-by-@xmath0 @xmath18  circulants of weight @xmath33 are affinely equivalent . for @xmath100",
    "the result is contained in the following theorem .",
    "[ thm 2 ] the number of affine classes of @xmath0-by-@xmath0 weight-@xmath34 @xmath18  circulants is @xmath101 , where @xmath102 denotes the number of divisors of @xmath0 . furthermore , weight-@xmath34 circulants in distinct affine classes have dissimilar autocorrelation matrices .",
    "let @xmath103 be the residue set corresponding to a weight-@xmath34 circulant .",
    "put @xmath104 .",
    "plainly @xmath105 is affinely equivalent to @xmath106 , which is linearly equivalent to @xmath107 .",
    "conversely , by proposition  [ lcm_prop ] , if @xmath108 are divisors of @xmath0 with @xmath109 , then @xmath107 and @xmath110 correspond to circulants with dissimilar autocorrelation matrices .",
    "the result follows .",
    "in the previous section we proved theorem  [ thm intro ] for @xmath98 . the remaining case @xmath35 is vastly more difficult . in this section we begin our attack on this case by showing that two weight-@xmath6 circulants are affinely equivalent if and only if their autocorrelation matrices are linearly equivalent .",
    "more explicitly , if @xmath111 is a set of @xmath33 residues mod @xmath0 , let @xmath112 be the multiset of @xmath86 residues @xmath113 .",
    "if @xmath114 is affinely equivalent to another residue set @xmath115 , then there is a unit @xmath8 mod  @xmath0 such that @xmath116 .",
    "we will prove the converse when @xmath35 .",
    "since @xmath117 , it suffices to prove the converse in case @xmath118 .    for positive integers @xmath0 and @xmath33 ,",
    "the _ same difference assertion _ , or @xmath119 , is the following assertion : for any sets @xmath120 of @xmath33 residues mod @xmath0 , we have @xmath121 if and only if @xmath114 is affinely equivalent to @xmath115 .",
    "as noted above , @xmath119 is equivalent to saying that , for any two @xmath0-by-@xmath0 @xmath18  circulants of weight @xmath33 , affine equivalence of the circulants is equivalent to linear equivalence of the autocorrelation matrices .    [ prop sda3 ] @xmath122 is true for each @xmath123 .",
    "suppose @xmath114 and @xmath115 are order-@xmath6 subsets of @xmath62 with @xmath124 .",
    "identify elements of @xmath62 with points on the circle of circumference @xmath0 centered at the origin , via @xmath125 . in this way we can identify @xmath114 and @xmath115 with sets of 3 points on this circle , where the arclength between two points equals the difference between the corresponding elements of @xmath62 . in the following diagram",
    ", @xmath114 is recorded in the left - hand circle , and @xmath115 is recorded in the right - hand circle .    in each diagram the circle is divided into three arcs ; mark the shortest arc with a slash , the second - shortest arc with a double slash , and the longest arc with a triple slash . note",
    "that @xmath126 consists of the three arclengths from the left - hand circle , together with all sums of two such arclengths , and three copies of @xmath1 .",
    "thus the arclengths with a slash and double - slash in the left circle must equal the corresponding arclengths in the right circle .",
    "hence the two triangles have equal angles , so they are congruent .",
    "we can make their angles occur in the same order , by replacing @xmath114 by @xmath127 if necessary .",
    "then there is a rotation which makes the triangles coincide .",
    "thus @xmath114 and @xmath115 are affinely equivalent .",
    "this proof shows that the multiplicative coefficient can be taken to be @xmath128 .",
    "we only need information about @xmath35 for our main result , but we will say more about larger values of @xmath33 later in the paper . for example , @xmath129 is not always true , one counterexample being the sets @xmath130 and @xmath131 : one easily checks that @xmath124 , but @xmath114 and @xmath115 are affinely inequivalent since @xmath114 contains arithmetic progressions of length @xmath6 but @xmath115 does not .",
    "however , in section  [ sec 4 ] we will prove @xmath129 for odd @xmath0 , and @xmath132 for @xmath0 coprime to @xmath133 .",
    "but in section  [ sec 6 ] we will give counterexamples to @xmath119 whenever @xmath134 and @xmath135 .",
    "the proof of our main result relies on some facts about vanishing sums of roots of unity , which we discuss in this section .",
    "let @xmath136 be a multiset of roots of unity such that @xmath137 .",
    "if the only sub - multisets of @xmath136 with zero sum are the empty set and @xmath136 , we say @xmath136 is a _",
    "minimal _ vanishing sum of roots of unity .",
    "the _ weight _ of the sum is the size of the multiset @xmath136 .",
    "we can multiply any vanishing sum of roots of unity by an arbitrary root of unity , without affecting minimality .",
    "vanishing sums of roots of unity have been studied extensively .",
    "in our situation , it turns out that we need to understand vanishing sums of twelve roots of unity .",
    "in fact , it is shown in @xcite that , up to multiplying by an arbitrary root of unity , there are precisely @xmath138 minimal vanishing sums of weight at most @xmath139 .",
    "however , complications arise in passing from minimal vanishing sums to nonminimal vanishing sums , since each minimal sum can be multiplied by an arbitrary root of unity : thus there are infinitely many vanishing sums of twelve roots of unity , so one can not simply test them all .",
    "we give a self - contained approach which does not require the results from @xcite .",
    "[ mann ] let @xmath136 be a weight-@xmath140 minimal vanishing sum of roots of unity , and suppose @xmath141 .",
    "let @xmath0 be the least common multiple of the orders of the roots of unity in @xmath136 .",
    "then @xmath0 divides the product of the primes not exceeding @xmath140 .",
    "if @xmath140 is prime and @xmath142 then @xmath136 consists of all the @xmath143 roots of unity ( so @xmath144 ) . if @xmath145 is prime and @xmath146 then @xmath147 .",
    "first we show @xmath0 is squarefree . if not then @xmath148 where @xmath149 is prime , @xmath150 , and @xmath93 is coprime to @xmath149 .",
    "let @xmath151 be a primitive @xmath152 root of unity .",
    "for any @xmath48 with @xmath153 , we can write @xmath154 where @xmath155 , so @xmath156 . rewriting our sum of roots of unity in this manner",
    ", we get a vanishing linear combination of @xmath157 with coefficients in @xmath158 .",
    "the field extension @xmath159 has degree @xmath160/[{{\\mathbb q}}(\\zeta^p):{{\\mathbb q}}]= \\phi(n)/\\phi(n / p)=p$ ] .",
    "hence our vanishing linear combination must have all coefficients being zero . by minimality",
    ", only one coefficient can be a nontrivial sum of roots of unity .",
    "since the sum includes @xmath2 , it follows that every root of unity in the sum has order dividing @xmath161 , a contradiction .",
    "thus @xmath0 is squarefree .",
    "now let @xmath149 be a prime dividing @xmath0 , and rewrite the sum as @xmath162 where each @xmath163 is a sum of @xmath164 roots of unity .",
    "since the sum includes @xmath2 , the term @xmath165 is a nontrivial sum of roots of unity . by the definition of @xmath0",
    ", some other @xmath163 must also be a nontrivial sum of roots of unity . by minimality ,",
    "any @xmath163 which is nontrivial must be nonzero .",
    "letting @xmath166 be the set of @xmath167 roots of unity , we know that @xmath168 is an extension of @xmath169 of degree @xmath170/[{{\\mathbb q}}(\\mu_{n / p}):{{\\mathbb q}}]=\\phi(n)/\\phi(n / p)=p-1 $ ] .",
    "thusthe polynomial @xmath171 ( whose roots are the primitive @xmath172 roots of unity ) is irreducible over @xmath169 , so every @xmath163 takes the same value . in particular , each @xmath163 is nonzero , so our sum has weight at least @xmath149 , whence @xmath0 divides the product of the primes not exceeding @xmath140 .",
    "if @xmath173 then every @xmath163 is a single root of unity , and @xmath174 , so every @xmath175 and thus our sum consists of all the @xmath172 roots of unity ( and @xmath176 ) .",
    "finally , suppose @xmath177 .",
    "then all but one @xmath163 consists of a single root of unity @xmath178 , and one @xmath163 is the sum of two roots of unity @xmath179 .",
    "since all @xmath163 have the same value , we have @xmath180 , which is a weight - three vanishing sum of roots of unity , and thus ( from what we proved so far ) must be a scalar times the sum of the cube roots of unity .",
    "hence both @xmath181 and @xmath182 are sixth roots of unity times @xmath178 .",
    "since our original sum includes @xmath2 , one of @xmath183 equals @xmath2 , so they all are sixth roots of unity and thus @xmath0 divides @xmath184 .",
    "this concludes the proof .",
    "all but the last sentence of the lemma was proved by mann @xcite .",
    "[ small relations ] every minimal vanishing sum of roots of unity of weight @xmath185 has @xmath140 being prime and moreover has the form @xmath186 where @xmath178 is a fixed root of unity and the @xmath187 are all the distinct @xmath143 roots of unity .    lemma  [ mann ] proves this unless the sum is a scalar times a sum involving only sixth roots of unity .",
    "so consider a minimal vanishing sum of sixth roots of unity , which we may assume includes @xmath2 .",
    "rewrite this sum in the form @xmath188 , where each @xmath163 is a sum of @xmath2 s and @xmath74 s . since @xmath189 is irreducible over @xmath190",
    ", every @xmath163 must have the same value .",
    "if this common value is zero , then by minimality our vanishing sum is @xmath191 .",
    "if the common value is not zero , then by minimality our vanishing sum is the sum of the cube roots of unity .",
    "in this section we complete the proof of theorem  [ thm intro ] by proving    [ k=3 ] let @xmath192 and @xmath193 @xmath194 be multisets of @xmath195 roots of unity , where @xmath196 .",
    "suppose that the two multisets @xmath197 and @xmath198 are identical .",
    "then there is an integer @xmath8 coprime to @xmath0 such that @xmath199 .",
    "first we show that this result implies theorem  [ thm intro ] .",
    "the implication @xmath200 is proposition  [ prop affpq ] , the implication @xmath201 is proposition  [ prop pqspec ] , and the implication @xmath202 is obvious .",
    "thus it suffices to prove @xmath28 .",
    "so let @xmath3 and @xmath4 be @xmath18   circulants with residue sets @xmath203 and @xmath204 , where @xmath205 , and suppose that @xmath25 and @xmath26 are similar . to complete the proof , we must show that @xmath114 and @xmath115 are affinely equivalent . for @xmath98 this",
    "was proved in theorem  [ thm 2 ] , so suppose @xmath35 . by proposition  [ prop sda3 ] , it suffices to prove that @xmath206 and @xmath207 are linearly equivalent . on the other hand ,",
    "since @xmath25 and @xmath26 are similar , they have the same eigenvalues ; recalling their eigenvalues from ( [ eigen ] ) , it follows that @xmath208 where @xmath151 is a fixed primitive @xmath152 root of unity .",
    "write @xmath209 for @xmath210 , where arithmetic on indices is done modulo  @xmath6 . then the @xmath211 are @xmath152 roots of unity with @xmath212 . put @xmath213",
    "define @xmath214 and @xmath215 similarly .",
    "then the equality of eigenvalues implies that @xmath216 now theorem  [ k=3 ] implies there is an integer @xmath8 coprime to @xmath0 such that @xmath217 . since @xmath218",
    ", it follows that @xmath219 , which as noted above is sufficient to complete the proof .",
    "our proof of theorem  [ k=3 ] uses the following lemmas .",
    "[ lcm trick ] suppose @xmath136 and @xmath215 are multisets of @xmath152 roots of unity with @xmath220 , and the multisets @xmath221 and @xmath198 are the same .",
    "then the least common multiple @xmath222 of the orders of the elements of @xmath136 equals the corresponding @xmath223 .",
    "moreover , @xmath224 consists of @xmath225 copies of @xmath226 .",
    "this is similar to propositon [ lcm_prop ] .",
    "the number @xmath227 equals @xmath228 precisely when @xmath93 is divisible by the stated least common multiple @xmath229 , so the number of such @xmath93 in @xmath230 equals @xmath231 . since @xmath220",
    ", it follows that @xmath232 and thus @xmath233 .",
    "the final assertion is obvious .",
    "[ conjugation ] suppose @xmath234 is a set of roots of unity which includes two complex conjugate roots of unity .",
    "let @xmath15 be the least common multiple of the orders of the various @xmath235 .",
    "then every @xmath211 has order dividing @xmath236 .    if @xmath237 then @xmath238 is an @xmath239 root of unity , so @xmath211 is a @xmath240 root of unity .",
    "since every @xmath235 is an @xmath239 root of unity , it follows that every @xmath241 has order dividing @xmath236 .",
    "we now prove our main result .",
    "suppose the multisets @xmath136 and @xmath215 provide a counterexample .",
    "by lemma  [ lcm trick ] , we may assume that @xmath0 is the least common multiple of the orders of the elements of @xmath136 , and also that @xmath0 is the corresponding least common multiple for @xmath215 . by hypothesis",
    ", the sum of the elements of @xmath136 equals the sum of the @xmath242 powers of the elements of @xmath215 , for some @xmath93 .",
    "thus @xmath243 is a vanishing sum of twelve roots of unity . for notational convenience ,",
    "we will write this vanishing sum as @xmath244 , where @xmath245 and where moreover all @xmath246 s and @xmath247 s are @xmath152 roots of unity and @xmath0 is the least common multiple of the orders of either the @xmath246 s or the @xmath247 s . note that multiplying the sum by @xmath74 has the affect of switching the @xmath246 s and @xmath247 s . in",
    "what follows , we implicitly use this symmetry , as well as possibly relabeling the @xmath246 s and @xmath247 s or replacing all the @xmath246 s ( or @xmath247 s ) by their complex conjugates .",
    "first we treat some small values of @xmath0 , namely the values @xmath248 @xmath249 and their divisors . a simple magma program verifies the result in these cases .",
    "henceforth assume @xmath0 does not divide @xmath250 , and consider a minimal vanishing subsum which includes a root of unity whose order does not divide @xmath251 .",
    "first suppose this subsum includes two complex conjugate roots of unity .",
    "let @xmath15 be the least common multiple of the orders of the ratios of roots of unity involved in the subsum .",
    "by lemma  [ conjugation ] , every root of unity in the subsum has order dividing @xmath236 . by lemma  [ mann ] , @xmath15 divides either @xmath252 or @xmath253 , so we must have @xmath254 and @xmath255 . since @xmath255 , lemma  [ mann ] implies that the subsum has weight twelve , and all twelve roots of unity have order dividing @xmath256 , so @xmath257 , a case which was treated by our magma program .",
    "thus any root of unity in our vanishing sum whose order does not divide @xmath251 must be contained in a minimal vanishing subsum which does not include two complex conjugates , and hence has weight at most six .",
    "consider one such subsum .",
    "if the weight is six then the sum includes one element from each pair @xmath258 and one from each pair @xmath259 . by lemma  [ mann ] , every element of the sum is a @xmath260 root of unity times some fixed constant @xmath261 . since @xmath262 , we see that either @xmath261 or @xmath263 is a @xmath260 root of unity .",
    "thus @xmath264 , a case which was treated by our magma program .",
    "if the weight is five then we may assume the sum includes one element from each pair @xmath258 and one from @xmath265 and one from @xmath266 .",
    "by corollary [ small relations ] , the roots of unity in this sum are fifth roots of unity times one another . since @xmath262",
    ", we see as above that the @xmath246 are @xmath267 roots of unity , so @xmath268 and @xmath269 are @xmath260 roots of unity .",
    "thus @xmath270 has order dividing @xmath271 . but @xmath272 implies @xmath273 , so @xmath274 , a contradiction .",
    "there are no minimal vanishing sums of weight four , by corollary  [ small relations ] .",
    "suppose the weight is three .",
    "by corollary [ small relations ] , the three roots of unity in the sum are cube roots of unity times one another ( and all three are distinct ) .",
    "since the sum involves an element of order not dividing @xmath251 , it follows that all three roots of unity in the sum have order not dividing @xmath251 .",
    "if the sum includes only elements of the form @xmath275 , then since @xmath262 we see that the @xmath246 s are cube roots of unity , a contradiction .",
    "thus , without loss we may assume the sum is @xmath276 . since the order of @xmath277 does not divide @xmath251 , and @xmath278",
    ", we may assume the order of @xmath269 does not divide @xmath251 .",
    "thus the minimal vanishing subsum involving @xmath279 does not include any complex conjugates , and has weight at most three .",
    "the possibilities are    1 .",
    "@xmath280 2 .",
    "@xmath281 3 .",
    "@xmath282 .    in case",
    "( 2 ) we have @xmath283 , so @xmath284 has order @xmath29 . in cases ( 1 ) and ( 3 ) ,",
    "@xmath285 is a sixth root of unity times @xmath269 , so the order of @xmath286 does not divide @xmath251 .",
    "thus in every case @xmath286 is not a cube root of unity , so @xmath287 is not a cube root of unity times @xmath288 .",
    "hence the minimal vanishing subsum involving @xmath288 is @xmath289 , so @xmath290 and @xmath291 where @xmath292 is a primitive cube root of unity .",
    "thus @xmath293 .    in case ( 2 ) we have @xmath294 and @xmath284 , so @xmath288 and @xmath295 have order @xmath296 while @xmath268 has order @xmath297 , so we must have @xmath298 and thus @xmath269 and @xmath299 have order @xmath300 .",
    "but then @xmath301 and @xmath302 , which is a contradiction since neither of @xmath300 or @xmath296 divides the other . in case",
    "( 3 ) we have @xmath303 and @xmath304 , so @xmath305 ; since @xmath293 , it follows that the order of @xmath288 divides @xmath139 , a contradiction .",
    "so suppose we are in case ( 1 ) .",
    "since @xmath306 is not a cube root of unity , it follows that @xmath269 is not a cube root of unity times @xmath307 , so we must have @xmath308 . by corollary [ small relations ] ,",
    "@xmath309 , but also @xmath310 , so the order of @xmath288 divides @xmath271 , a contradiction .",
    "we have shown that every summand whose order does not divide @xmath251 is involved in a minimal vanishing sum of weight two .",
    "suppose @xmath311 . from the definition of the @xmath246 and @xmath247",
    ", it follows that @xmath312 .",
    "in particular , the least common multiple of the orders of the @xmath313 equals the corresponding least common multiple for the @xmath241 , which we know equals the corresponding least common multiple for the @xmath314 , namely @xmath0 .",
    "thus @xmath93 is coprime to @xmath0 , contradicting our assumption that the @xmath241 and @xmath314 are a counterexample to the desired result .",
    "next suppose that @xmath315 and the order of @xmath288 does not divide @xmath250 .",
    "then @xmath316 has order not dividing @xmath251 , so we may assume @xmath317 .",
    "next , @xmath318 has order not dividing @xmath251 , so we may assume @xmath268 has order not dividing @xmath251 , whence @xmath319 .",
    "we do not have @xmath320 , since that would imply @xmath321 .",
    "thus @xmath322 , so @xmath323 , whence @xmath324 . thus @xmath325 , and",
    "we have already achieved a contradiction in this situation .",
    "suppose that @xmath326 and the order of @xmath288 does not divide @xmath250 .",
    "since @xmath327 , we may assume the order of @xmath295 does not divide @xmath250 as well .",
    "thus , after possibly switching @xmath269 and @xmath299 , we must have either @xmath328 or @xmath329 .",
    "if @xmath328 , then @xmath330 is a vanishing sum , but there are no minimal vanishing sums of weights four or one so we must have @xmath331 , which is a case we have already handled .",
    "thus @xmath329 , so @xmath332 , contradiction .",
    "finally , we may assume that the order of @xmath333 does not divide @xmath250 .",
    "the minimal vanishing subsum involving @xmath333 must have weight two , and is not of the form @xmath334 or @xmath335 .",
    "the only remaining possibility is @xmath336 ; here we know @xmath337 , so we may assume @xmath338 , whence @xmath339 .",
    "switching the roles of @xmath211 and @xmath214 , we may also assume that @xmath340 and @xmath341 .",
    "since @xmath342 , at least one of @xmath333 and @xmath343 has even order , so by possibly switching @xmath333 and @xmath343 we may assume that @xmath333 has even order",
    ". then @xmath344 .",
    "similarly we may assume that @xmath345 has even order , so @xmath345 has order @xmath0 .",
    "thus there is an @xmath93 coprime to @xmath0 such that @xmath346 , and it follows that @xmath347 and @xmath348 .",
    "this again is a contradiction , and as we have now treated every case it follows that the supposed counterexample does not exist .    in the above argument",
    ", we used that all the eigenvalues of @xmath25 and @xmath26 are the same .",
    "one can actually obtain a lot of information from just the hypothesis that these matrices have a single eigenvalue in common .",
    "namely , by expanding on the above argument , one can show :    if @xmath349 are roots of unity with @xmath350 and @xmath351 , then the multisets @xmath352 and @xmath353 satisfy one of the following , with @xmath354,@xmath355,@xmath356,@xmath357,@xmath358,@xmath359 being roots of unity with the orders indicated",
    ".    1 .   @xmath360 .",
    "2 .   @xmath361 and @xmath362 .",
    "3 .   after possibly switching @xmath136 and @xmath215 we have one of the following 1 .",
    "@xmath363 and @xmath364 2 .",
    "@xmath365 and + @xmath366 3 .",
    "@xmath367 and + @xmath368 4 .",
    "@xmath369 and + @xmath370 5 .",
    "@xmath371 and + @xmath372 6 .",
    "both @xmath136 and @xmath215 are among the multisets ( with sum @xmath74 ) 1 .",
    "@xmath373 ; 2 .",
    "@xmath374 ; 3 .",
    "@xmath375 .    * note .",
    "* in the above proposition , there is a solution which uses case 3.f.iii for both @xmath136 and @xmath215 but with @xmath376 a different primitive fifth root of unity in @xmath215 than @xmath136 .",
    "this is the only case where we need different choices of @xmath377 and @xmath378 in @xmath136 and @xmath215 .",
    "new phenomena occur when we move to @xmath36 . for instance , in section  [ sec equiv ] we showed that the residue sets @xmath379 and @xmath380 correspond to @xmath18  circulants which are _",
    "p-_q _ _  equivalent but not affinely equivalent .",
    "also , one can show that the autocorrelation matrices of the circulants corresponding to @xmath381 and @xmath382 are similar , but are not conjugate via a permutation matrix ( so the circulants are not _",
    "p-_q _ _  equivalent ) .",
    "these examples show that , when @xmath36 , condition ( 2 ) of theorem  [ thm intro ] does not imply condition ( 1 ) , and condition ( 4 ) does not imply condition ( 3 ) .    still , for @xmath36 and @xmath37 we now show that theorem  [ thm intro ] is true whenever @xmath0 is not divisible by small primes . as in the case @xmath35",
    ", we proceed by proving @xmath119 and then examining vanishing sums of roots of unity .",
    "[ lem 4 ] @xmath129 is true if @xmath0 is odd .",
    "@xmath132 is true if @xmath0 is coprime to @xmath133 .",
    "suppose @xmath383 and @xmath384 are 4-element subsets of @xmath62 with @xmath385 .",
    "then there is a permutation @xmath386 of the set @xmath387 of order-@xmath34 subsets of @xmath388 , and a map @xmath389 , such that @xmath390    we tested via computer that , for every choice of @xmath386 and @xmath391 , the above identity implies that @xmath392 and @xmath393 are affinely equivalent so long as @xmath0 is odd .",
    "in fact , if we think of the @xmath394 s and @xmath395 s as indeterminates , then there exist @xmath396 and @xmath397 such that , for each @xmath210 , the equation @xmath398 is a rational linear combination of the equations ( [ xyeq ] ) ( for any fixed choice of @xmath386 and @xmath391 ) .",
    "moreover , the denominators of the coefficients in this combination have no prime factors besides @xmath34 and @xmath399 .",
    "this proves @xmath129 when @xmath0 is coprime to @xmath400 .",
    "values of @xmath0 which are odd multiples of @xmath399 require an additional argument : for such @xmath0 , consider a pair @xmath401 for which the above linear combination has a coefficient with denominator divisible by @xmath399 .",
    "it turns out that @xmath402 and @xmath403 are @xmath404-linear combinations of the equations ( [ xyeq ] ) , for every @xmath405 , so viewing @xmath406 as members of @xmath407 , it follows that all the @xmath394 s are congruent to one another mod  @xmath408 , and likewise the @xmath395 s .",
    "we can translate the @xmath394 s and @xmath395 s so that ( say ) @xmath409 , without affecting the pairwise differences between @xmath394 s or @xmath395 s .",
    "thus we may assume that every @xmath394 and @xmath395 is divisible by @xmath408 , so it suffices to prove that @xmath410 and @xmath411 are affinely equivalent subsets of @xmath412 .",
    "in each case , it turns out that ( [ xyeq ] ) allows one to write every @xmath394 and @xmath395 as a multiple of @xmath413 , so we get two explicit subsets of @xmath412 and they do indeed turn out to be affinely equivalent .",
    "we treated the case @xmath37 in a similar manner . in this case",
    "it turns out that there is always a system of equations like ( [ i4 ] ) which are rational linear combinations of the equations like ( [ xyeq ] ) , and the denominators of the coefficients in these combinations are not divisible by any primes besides @xmath34 and @xmath30 .",
    "experimentally , it seems that @xmath129 fails if and only if @xmath0 is divisible by @xmath297 , and that @xmath132 fails if and only if @xmath414 and @xmath415 .",
    "however , such refinements of lemma  [ lem 4 ] would not affect our next result .",
    "if @xmath416 and every prime factor of @xmath0 is greater than @xmath417 , then the properties @xmath418 , @xmath419 , @xmath420 , @xmath421 from theorem  [ thm intro ] are equivalent conditions on @xmath0-by-@xmath0 @xmath18  circulants @xmath3 and @xmath4 of weight  @xmath33 .",
    "suppose @xmath33 and @xmath0 satisfy the hypotheses .",
    "if the circulants corresponding to @xmath203 and @xmath204 have similar autocorrelation matrices , then as in the previous section by considering eigenvalues we find a vanishing sum @xmath45 of @xmath417 @xmath422 roots of unity . by lemma  [ mann ] , since the prime factors of @xmath0 are larger than @xmath417 , every minimal vanishing subsum of @xmath45 must be a pair @xmath423 .",
    "since @xmath0 is odd , no two @xmath152 roots of unity are negatives of one another , so we must have an equality of multisets @xmath424 for some integer @xmath8 , where @xmath151 is a primitive @xmath152 root of unity .",
    "by lemma [ lcm trick ] , we may assume @xmath22 .",
    "thus , the multisets of differences @xmath126 and @xmath425 are linearly equivalent , so lemma  [ lem 4 ] implies @xmath114 and @xmath115 are affinely equivalent .",
    "when @xmath38 , there are examples showing that our spectral approach will not work , even if the prime factors of @xmath0 are large .",
    "more precisely , for every @xmath38 and every @xmath135 , we will exhibit two @xmath0-by-@xmath0 weight-@xmath33 @xmath18  circulants which are not _ p-_q _ _  equivalent but yet have the same autocorrelation matrices .",
    "we emphasize that this shows one can not relate _",
    "p-_q _ _  equivalence to affine equivalence by means of autocorrelation similarity ; but it may still be true for @xmath38 that _ p-_q _ _  equivalence and affine equivalence are related for some other reason .    for @xmath38 ,",
    "consider the sets of integers @xmath114 and @xmath115 defined as the complements in @xmath426 of the sets @xmath427 and @xmath428 , respectively .",
    "in other words , @xmath429 and @xmath430 we will show that @xmath114 and @xmath115 have the same multisets of differences , i.e. , @xmath124 , but that for any @xmath135 they define @xmath0-by-@xmath0 @xmath18  circulants which are not _",
    "p-_q _ _  equivalent .    if @xmath38 then @xmath124 .",
    "we compute @xmath431 .",
    "since @xmath432 , this consists of all differences between two elements of @xmath114 which involve @xmath6 or @xmath433 .",
    "thus , this is the multiset of elements @xmath434 with @xmath48 in the union of the two multisets @xmath435 and @xmath436 .",
    "the corresponding multiset for @xmath115 is the union of @xmath437 and @xmath438 .",
    "thus @xmath439 , so @xmath124 .",
    "let @xmath440 and @xmath441 be the images of @xmath114 and @xmath115 in @xmath62 , and let @xmath442 and @xmath443 be the corresponding @xmath0-by-@xmath0 circulants .    if @xmath38 and @xmath135 , then @xmath442 and @xmath443 are not",
    "_ p-_q _ _  equivalent .",
    "first assume @xmath444 .",
    "the top row of @xmath442 has dot - product @xmath2 with precisely ten rows of @xmath442 , namely the shifts of the top row by @xmath445 in either direction .",
    "the bound @xmath135 ensures that in computing these dot - products , it suffices to add or subtract an integer from the indices : we need not reduce the indices mod  @xmath0 .",
    "likewise , the top row of @xmath442 has dot - product @xmath34 with precisely two rows of @xmath442 , namely the shifts of the top row by @xmath446 in either direction .",
    "the componentwise product of the top row of @xmath442 with the sum of these twelve rows is the vector @xmath447 where the ` 4 ' occurs in position @xmath1 and the ` 3 ' occurs in position @xmath448 .",
    "the corresponding product for @xmath4 is @xmath449 where the entries ` 3 ' are in positions @xmath1 , @xmath448 and @xmath450 .",
    "if @xmath443 were gotten by permuting the rows and columns of @xmath442 , then @xmath451 would be a permutation of @xmath452 .",
    "but this is not the case , since ` 4 ' is an entry in @xmath452 but not in @xmath451 .",
    "if @xmath453 then the top row of @xmath442 has dot - product @xmath34 with more than two rows of @xmath442 , but its componentwise product with the sum of all such rows is not a permutation of the corresponding product for @xmath443 .",
    "this proves the result in every case .",
    "a much - studied problem is the    for which @xmath0 do there exist @xmath0-by-@xmath0 @xmath18  circulants @xmath3 and @xmath4 which are not linearly equivalent but for which @xmath454 for some permutation matrix @xmath23 ?    actually , dm   made the conjecture that this @xmath455  equivalence was always the same as linear equivalence , but a counterexample was published soon thereafter .",
    "this led many authors to seek ways to weaken the original conjecture to make it true .",
    "this problem resembles the problem studied in this paper , which we now rename :    describe the @xmath18  circulants @xmath3 and @xmath4 which are not affinely equivalent but for which @xmath456 for some permutation matrices @xmath23 and @xmath54 .",
    "dm   was interested in isomorphisms between directed graphs that had prescribed vertex transitive symmetry groups , in this case the cyclic group .",
    "our problem asks the same question for directed bipartite graphs which have the same group acting on each part .",
    "muzychuk has given a magnificent solution to the original dm  problem  @xcite : the answer is all @xmath0 which are divisible by either @xmath297 or by the square of an odd prime .",
    "his proof uses detailed considerations of schur algebras , among other things .",
    "as far as we know , the @xmath0 s occurring in solutions to the bipartite dm   problem might be precisely the @xmath0 s which solve the dm  problem ; however , it seems that muzychuk s method does not apply to the bipartite problem .",
    "we note , however , that babai s group - theoretic proof of the dm  conjecture in the case of prime @xmath0 can be extended ( with some effort ) to the bipartite situation .",
    "there is evidence that these are different problems .",
    "the first counterexample to the dm   conjecture ( from @xcite ) was the pair of circulants @xmath457 and @xmath458 .",
    "on the other hand , theorem  [ thm intro ] shows that there are no weight three `` counterexamples '' ( permutation equivalent but not affinely equivalent ) for the bipartite dm   problem .    however , there is often a connection between counterexamples in the two problems .",
    "our original counterexample of circulants that are _ p-_q _ _  but not affinely equivalent was @xmath459 and @xmath460 .",
    "these two circulants do not directly form a counterexample for the dm  problem because they are not @xmath455  equivalent .",
    "but the affine equivalence class of @xmath379 includes @xmath461 , which is @xmath455  equivalent to @xmath462 , which in turn is affinely equivalent to @xmath380 .",
    "thus , by picking different members of the two affine equivalence classes , we can turn our bipartite dm  counterexample into an dm  counterexample .",
    "we did some computer searches to find bipartite dm  counterexamples , and most of the examples we found were affinely equivalent to dmcounterexamples .",
    "however , in weight six there are bipartite dm   counterexamples like @xmath463 and @xmath464 which are not affinely equivalent to dm   counterexamples .",
    "we do not know how rare such examples will be for larger weights .",
    "it is a pleasure to thank bradley brock for helpful discussions on vanishing sums of roots of unity , and marshall w. buck for help with equation solving .",
    "there are several different directions for future research depending on what equivalence relations and what parameter ranges are of the most interest . for larger densites ,",
    "say @xmath465 , it may still be true that the autocorrelation spectra usually determine the affine equivalence classes .    in some applications",
    "it is natural to study sparse circulants whose nonzero entries can be @xmath74 as well as @xmath2 .",
    "also , the notion of spectral equivalence could be relaxed to simply having the same mimimal polynomial or having the same characteristic polynomial modulo some fixed prime ."
  ],
  "abstract_text": [
    "<S> we consider @xmath0-by-@xmath0 circulant matrices having entries @xmath1 and @xmath2 . </S>",
    "<S> such matrices can be identified with sets of residues mod  @xmath0 , corresponding to the columns in which the top row contains an entry @xmath2 . </S>",
    "<S> let @xmath3 and @xmath4 be two such matrices , and suppose that the corresponding residue sets @xmath5 have size at most @xmath6 . </S>",
    "<S> we prove that the following are equivalent : ( 1 ) there are integers @xmath7 mod  @xmath0 , with @xmath8 a unit , such that @xmath9 ; ( 2 ) there are permutation matrices @xmath10 such that @xmath11 . </S>",
    "<S> our proof relies on some new results about vanishing sums of roots of unity . </S>",
    "<S> we give examples showing this result is not always true for denser circulants , as well as results showing it continues to hold in some situations . </S>",
    "<S> we also explain how our problem relates to the dm problem on isomorphisms of circulant directed graphs . </S>"
  ]
}