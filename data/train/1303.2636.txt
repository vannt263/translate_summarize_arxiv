{
  "article_text": [
    "in energy harvesting communications , users transmit messages using energy harvested from nature @xcite . in such systems ,",
    "transmission policies of the users need to be carefully designed according to the energy arrival profiles .",
    "recent work addresses this energy management problem for various energy harvesting communication settings @xcite .",
    "when the energy management policies are optimized as in @xcite , the resulting performance of the system depends only on the energy arrival profiles . in this paper , we introduce the notion of _ energy cooperation _ in energy harvesting communications where users can share a portion of their harvested energy with the other users by means of wireless energy transfer @xcite .",
    "this energy cooperation enables us to control and optimize the energy arrivals at users to the extent possible . in the classical setting of cooperation @xcite",
    ", users help each other in the transmission of their data by exploiting the broadcast nature of wireless communications and the resulting overheard information .",
    "in contrast to the usual notion of cooperation , which is at the _ signal level _ , energy cooperation we introduce here is at the _ battery energy level_. in a multi - user setting , energy may be abundant in one user in which case the loss incurred by transferring it to another user may be less than the gain it yields for the other user .",
    "it is this cooperation that we wish to explore in this paper for several basic multi - user scenarios , where energy can be transferred from one user to another through a separate wireless energy transfer unit .",
    "wireless energy transfer has been recently proposed as a promising technique for a wide variety of wireless networking applications @xcite . in future wireless networks ,",
    "nodes are envisioned to be capable of harvesting energy from the environment and transferring energy to other nodes , rendering the network energy self - sufficient and self - sustaining with a significantly prolonged lifetime .",
    "wireless energy transfer is a relatively new concept for wireless communications ; however , it has been considered in other contexts earlier : wireless powering of engineering systems by microwave power transfer technology has been used in many applications @xcite for a long time , such as space missions @xcite and optical communications @xcite . while microwave power transfer is viewed as the key technology for large - scale cellular networks @xcite , recent advances in wireless energy transfer technology supports feasibility of wireless network design in smaller scales . in @xcite ,",
    "wireless energy transfer with strong inductive coupling has been demonstrated with relatively high efficiency over relatively long distances with small device sizes .",
    "another related line of research in medical implanting applications has been presented in @xcite where wireless nodes are powered by wireless energy transfer , which also use the wirelessly transferred energy for communications .",
    "rfid technology is another prominent example along this direction , where nodes harvest received energy and use the harvested energy ( via reflection ) for communication @xcite .",
    "relying on the possibility of efficient wireless energy transfer , in this paper , we investigate the optimum communication schemes in multi - user systems with nodes that have energy harvesting and energy transfer capabilities .    in communication systems with wireless energy transfer , energy and information flow simultaneously .",
    "motivated by this nature of such systems , the trade - off between energy and information transmission has been addressed in several recent works @xcite . among these works ,",
    "the one that is most pertinent to our work is @xcite , where multi - user communication systems with simultaneous energy and information transmission are studied .",
    "our problem formulation captures a different trade - off than those studied in @xcite since in our model wireless energy transfer is maintained by a separate wireless energy transfer unit , and the harvested energy source is independent of the received signal energy .    in this paper , we study the offline optimal energy management problem for several basic multi - user network structures with energy harvesting transmitters and one - way wireless energy transfer .",
    "offline throughput maximization problem has been recently investigated for various settings with energy harvesting transmitters in @xcite . in @xcite , transmission completion time minimization problem for an energy harvesting transmitter with an unlimited sized battery",
    "is solved , and this solution is extended to the case of a transmitter with a finite sized battery in @xcite by showing its equivalence to a throughput maximization problem .",
    "references @xcite extend the throughput maximization problem and its solution to fading , broadcast , multiple access and interference channels . in @xcite , the end - to - end throughput maximization problem",
    "is solved for two - hop cooperative relay networks for various settings .",
    "extensions of the throughput maximization problem for nodes with battery imperfections are considered in @xcite , and processing costs are incorporated in @xcite .    as extensively emphasized in @xcite , in energy harvesting transmitters , energy arrivals in time impose energy causality constraints on the transmission policies of the users . in the optimal policy , due to the concavity of the throughput in powers , energy needs to be allocated as constant as possible over time subject to energy causality constraints . in the presence of wireless energy transfer , energy causality constraints take a new form : energy can flow in time from the past to the future for each user , and from one user to the other at each time .",
    "this requires a careful joint management of energy flow in two separate dimensions , and different management policies are required depending on how users share the common wireless medium and interact over it . in this context , we analyze several basic multi - user energy harvesting network structures with wireless energy transfer . to capture the main trade - offs and insights that arise due to wireless energy transfer , we focus our attention on simple two- and three - user communication systems .",
    "first , we examine additive gaussian two - hop relay channel with one - way energy transfer from the source node to the relay node where the objective is to maximize the end - to - end throughput .",
    "next , we consider the gaussian two - way channel with one - way energy transfer , and the two - user gaussian multiple access channel with one - way energy transfer .",
    "for these two channel models , we determine the two - dimensional simultaneously achievable throughput regions .",
    "for all three cases , we use a lagrangian approach and determine the optimum transmit powers and energy transfer policies via the kkt optimality conditions .",
    "in particular , we develop a _ two - dimensional directional water - filling algorithm _ which optimally controls the energy flow in time and among users .",
    "as observed in @xcite , energy harvesting setting gives rise to a _",
    "water - filling algorithm , where energy can flow only from the past to the future due to the energy causality constraints .",
    "in addition , with wireless energy transfer , at any give time , energy can flow from one user to the other depending on the direction of wireless energy transfer .",
    "therefore , the directionality of energy flow in two separate dimensions requires careful management of energy over time and users .",
    "solutions obtained in each setting yield new insights on energy cooperation at the battery energy level in the presence of wireless energy transfer .",
    "in this section , we consider a two - hop relay channel consisting of a source node , a relay node and a destination node as shown in fig .",
    "[ sysmod1 ] .",
    "the two queues at the source and the relay nodes are the data and energy queues .",
    "the energies that arrive at the source and the relay nodes are saved in the corresponding energy queues .",
    "the data queue of the source always carries some data packets to be delivered to the destination .",
    "the data packets sent from the source node cause a depletion of energy from the source energy queue and an increase in the relay data queue .",
    "these data packets are then served out of the relay data queue with a cost of energy depletion from the relay energy queue .",
    "the relay operates in a full - duplex mode , i.e. , the data and energy queues of the relay are updated simultaneously in every slot .",
    "we assume that the data and energy buffer sizes are unlimited .",
    "in addition , energy expenditure is only due to data transmissions ; any other energy costs , e.g. , processing , circuitry , are not considered in this paper .",
    "there is a separate wireless energy transfer unit at the source node , and therefore , the source node may wish to share a portion of its energy with the relay node so that the relay can forward more data .",
    "the channels from the source to the relay and from the relay to the destination are additive white gaussian noise ( awgn ) channels .",
    "the received signals @xmath0 and @xmath1 at the relay and the destination , respectively , are given by @xmath2 and @xmath3 , where @xmath4 and @xmath5 are the channel coefficients for the source - to - relay and relay - to - destination channels , respectively .",
    "@xmath6 and @xmath7 are gaussian noises each with zero - mean and unit - variance .",
    "we assume that @xmath8 without loss of generality as otherwise the energy arrivals can be properly scaled .",
    "time is slotted and there are a total of @xmath9 equal length slots . without loss of generality , we assume that the slots are of unit length . at times",
    "@xmath10 , the source harvests energy with amounts @xmath11 and the relay harvests energy with amounts @xmath12 .",
    "energy transfer efficiency is @xmath13 , where @xmath14 .",
    "this means that when the source transfers @xmath15 amount of energy to the relay through the wireless energy transfer unit in slot @xmath16 , @xmath17 amount of energy enters the energy queue of the relay in the next slot .",
    "similarly , when the source uses power @xmath18 for data transmission , the data queue of the relay is increased by @xmath19 bits in the next slot .",
    "the source and relay slots are indexed by one slot delay , so that , the slot subscripts are aligned at the source and the relay ; see fig .",
    "[ slotmodel ] .",
    "power policy of the source is the sequences @xmath18 and @xmath15 , and the power policy of the relay is the sequence @xmath20 .    as the energy that has not arrived yet",
    "can not be used for data transmission or energy transfer , the power policies of the source and the relay are constrained by the causality of energy in time .",
    "these constraints yield the following feasible set : @xmath21 where vectors @xmath22 , @xmath23 and @xmath24 denote sequences @xmath25 and @xmath15 , respectively .",
    "@xmath26 is the feasible set due to energy causality in harvested and transferred energies and is valid for the two - way and multiple access system models as well .",
    "for the two - hop relay channel model , we have an additional constraint : the relay transmits data that arrives from the source .",
    "therefore , the power policies of the source and the relay need to satisfy the following data causality constraints at the relay : @xmath27 we formulate the end - to - end throughput maximization problem in the next section .",
    "the optimal offline end - to - end throughput maximization problem with wireless energy transfer subject to energy causality at both nodes and data causality at the relay node is : @xmath28 it can be shown that ( [ opt_probrelay1 ] ) is equivalent to a convex optimization problem ( see @xcite ) , by a change of variables from @xmath29 to @xmath30 .",
    "thus , ( [ opt_probrelay1 ] ) can be solved using standard techniques @xcite .",
    "the lagrangian function for the problem in ( [ opt_probrelay1 ] ) is : @xmath31 lagrange multiplier @xmath32 is due to the constraint that @xmath33 .",
    "note that the same constraints apply for @xmath18 and @xmath20 ; however , @xmath18 and @xmath20 are always non - zero in the optimal policy , therefore we exclude them .",
    "similarly , we exclude the constraints @xmath34 in the lagrangian function as these constraints can never be satisfied with equality in the optimal policy .",
    "this is because , if the source transfers all of its arrived energy at some slot , then the relay will have no data to send at that slot , and allocating a small portion of the arrived energy for source transmission strictly increases the throughput in this case .",
    "the kkt conditions for this problem are : @xmath35 with the additional complementary slackness conditions as : @xmath36 from ( [ kkt_relay ] ) , ( [ kkt_source ] ) and ( [ kkt_energy ] ) we get : @xmath37 next , we obtain necessary optimality conditions for ( [ opt_probrelay1 ] ) .",
    "the first necessary optimality condition for ( [ opt_probrelay1 ] ) is that the source has to send as many bits as the relay can send and the relay has to finish up all the data in its data buffer . in other words , in the optimal policy , no data should be left in the data queue of the relay at the end .",
    "[ opt_cond1 ] the optimal power sequences @xmath38 , @xmath39 must satisfy the constraint @xmath40 .",
    "suppose the stated constraint is satisfied with strict inequality .",
    "then , we can increase some @xmath15 , increase @xmath20 and decrease @xmath18 without violating the energy constraints and improve the overall throughput which contradicts the optimality of @xmath39 , @xmath38 , @xmath41 .",
    "we note that if the relay energy profile is sufficient to forward all the bits in the optimal source data stream with respect to the source energy profile , that is , if the separable policy in @xcite yields a policy that satisfies the necessary condition in lemma [ opt_cond1 ] , then it is the optimal solution for ( [ opt_probrelay1 ] ) and no energy transfer is needed .",
    "the second observation about the optimal policy is that the source has to exhaust the energies that have been harvested throughout the communication session either for data transmission or in the form of wireless energy transfer .",
    "[ opt_cond2 ] the optimal power profiles @xmath38 , @xmath39 and energy transfers @xmath41 must satisfy @xmath42 .",
    "suppose this constraint is satisfied with strict inequality .",
    "then , we can increase some @xmath15 and then increase @xmath18 and @xmath20 to achieve a larger throughput and satisfy the constraints of ( [ opt_probrelay1 ] ) .",
    "this contradicts the optimality of @xmath43 .",
    "next , we observe that if there is a non - zero energy transfer from the source to the relay , then the relay has to exhaust all of its energy in the optimal policy .",
    "[ opt_cond3 ] for the optimal power sequences @xmath38 , @xmath39 and energy transfer sequence @xmath41 , if @xmath44 for some @xmath16 , then @xmath45 .",
    "suppose this constraint is satisfied with strict inequality .",
    "using a similar argument as in lemma [ opt_cond2 ] , we can decrease @xmath15 and increase @xmath20 to achieve a larger throughput and satisfy the constraints of problem ( [ opt_probrelay1 ] ) .",
    "this contradicts the optimality of @xmath43 .",
    "finally , we note that , in the optimal policy , the total energy expenditure at the relay must be higher than the total energy expenditure at the source .",
    "[ opt_cond4 ] the optimal power sequences @xmath38 and @xmath39 must satisfy @xmath46 , and with equality if and only if @xmath47 for all @xmath16",
    ".    we will give a proof based on majorization theory and schur convexity @xcite .",
    "we denote the optimal source and relay rate allocation vectors as @xmath48 $ ] and @xmath49 $ ] , where @xmath50 and @xmath51 , for @xmath52 .",
    "first , we note that the optimal rate allocations of both the source and the relay are monotone non - decreasing sequences by ( * ? ? ?",
    "* lemmas 1 and 4 ) , i.e. , @xmath53 and @xmath54 , for @xmath55 .",
    "second , we note the data causality constraint at the relay @xmath56 , for all @xmath57 , and the equality @xmath58 by lemma  [ opt_cond1 ] . these imply that @xmath59 is majorized by @xmath60 , which is denoted by @xmath61 ; see ( * ? ? ?",
    "* definition 1.a.1 ) .",
    "since @xmath62 and @xmath63 is strictly convex , @xmath64 is a strictly schur convex function of @xmath59 ( * ? ? ?",
    "* proposition 3.c.1 ) .",
    "then , since @xmath61 , we have that @xmath65 ( * ? ? ?",
    "* proposition 4.b.1 ) .",
    "moreover , due to the strict convexity of @xmath66 , and the resulting strict schur convexity , equality is possible only when @xmath67 for all @xmath16 .",
    "an immediate application of lemma [ opt_cond4 ] is that if @xmath68 , i.e. , if the total energy of the relay is less than the total energy of the source , then the relay can not forward the source data stream only with its own energy . in this case",
    ", we must have @xmath44 for some @xmath16 , i.e. , some energy transfer is strictly needed .",
    "we state this in the following lemma .",
    "[ opt_cond5 ] if the data buffer of the relay is empty at some slot @xmath69 , @xmath70 , then @xmath71 , and with equality only when @xmath47 for all @xmath72 .",
    "if the data buffer of the relay is empty at some slot @xmath69 , @xmath70 , then we must have @xmath73 . together with the data causality constraints at the relay @xmath74 , for @xmath75",
    ", we conclude that the subvector @xmath76 $ ] is majorized by the subvector @xmath77 $ ] , i.e. , @xmath78 .",
    "then , @xmath79 , and with equality iff @xmath80 due to the strict schur convexity .",
    "necessary conditions in lemmas  [ opt_cond1 ] through [ opt_cond5 ] do not provide detailed structural properties for the optimal policy for an algorithmic solution . in the next sections , we consider specific scenarios to gain insight on the optimal policy .",
    "in particular , we examine cases that correspond to practically interesting settings , such as the case of only one of the nodes harvesting energy .",
    "we consider the scenario where the relay energy arrival profile is higher at the beginning , intersects the energy arrival profile of the source once , and remains lower until the end of the communication , as shown in fig .",
    "[ spec1 ] .",
    "in particular , we assume that there exists @xmath81 $ ] such that @xmath82 , for all @xmath83 , and @xmath84 , for all @xmath85 . in fig .",
    "[ spec1 ] , @xmath86 .",
    "we note that this case also covers the setting where the relay is not energy harvesting , and only the source harvests energy during the communication session .    for this case",
    ", we propose the following solution .",
    "form a new energy arrival profile as : @xmath87 as shown in fig .",
    "[ spec1 ] , and maximize the throughput with respect to this profile . in particular , use @xmath88 for @xmath83 , and @xmath89 for @xmath90 ; and perform energy transfer only at slots @xmath91 .",
    "the resulting power sequences are matched for the source and the relay .",
    "more specifically , we propose @xmath92 where @xmath93    we next show that there exist @xmath94 that satisfy ( [ kkt_relay])-([comp_slack ] ) and yield the solution in ( [ prop1])-([prop2 ] ) via ( [ relay_soln])-([transfer_soln ] ) .",
    "in particular , @xmath95 and @xmath96 for @xmath85 . since @xmath97 for all @xmath98",
    ", we have from ( [ relay_soln ] ) and ( [ source_soln ] ) @xmath99 hence , @xmath100 , which implies that @xmath101 and @xmath102 for @xmath103 . moreover , @xmath104 whenever @xmath89 is active for some @xmath90 . as in @xcite",
    ", we can show that such @xmath105 that yield the power sequence in ( [ prop1])-([prop2 ] ) are uniquely found for @xmath90 .",
    "it remains to find the lagrange multipliers for @xmath83 .",
    "we observe that @xmath106 and @xmath107 for @xmath83 .",
    "that is , the relay power constraint is not active in the first @xmath108 slots , i.e. , @xmath109 , @xmath83 . to justify this claim",
    ", we note that since @xmath47 for @xmath85 , we have @xmath110 . by lemma  [ opt_cond5 ] ,",
    "selecting @xmath111 for @xmath83 is the minimum energy consuming policy at the relay .",
    "since by assumption @xmath112 for @xmath83 , @xmath111 is feasible and hence optimal , which in turn implies that @xmath109 for @xmath83 . as a consequence , @xmath113 , i.e. , constant for all @xmath83 . as @xmath114",
    ", we can specify @xmath115 recursively , with @xmath116 only when @xmath88 constraint is active , as follows @xmath117 moreover , @xmath118 for slots where @xmath88 constraint is active and @xmath119 .",
    "note that if @xmath44 for some @xmath16 , the optimal source and relay power sequences are unique while there may exist infinitely many @xmath41 that yield the same optimal power levels .",
    "a particular case covered is when only the source has energy replenishments and the relay has all its energy available initially , i.e. , @xmath120 and @xmath121 for @xmath122 .",
    "if @xmath123 , the relay can forward all the bits sent from the source and the optimal policy is trivial . if @xmath124 , the optimal policy is obtained by forming a common energy profile via energy transfer and matching the power and rate sequences .",
    "another special case is when @xmath125 , i.e. , when @xmath126 for all @xmath16 . in this case ,",
    "@xmath127 for all @xmath16 and matching the relay and source power sequences is optimal with @xmath128 . when @xmath129 , we have @xmath130 , @xmath131 .",
    "the source optimizes the throughput according to @xmath132 and the relay power is matched with the source .",
    "we consider the scenario where the source has all of its energy available at the beginning ( i.e. , @xmath133 only ) , and the relay harvests energy throughout the communication .",
    "let the relay energy profile not be satisfactory to forward the optimal source data stream which has constant rate @xmath134 .",
    "assume @xmath135 for some @xmath16 .",
    "since the source is not energy harvesting , the total energy of the source will then be @xmath136 yielding an optimal transmission power of @xmath137 .",
    "hence , the throughput of the source is independent of the slot index @xmath16 the energy is transferred .",
    "however , transferring the energy at slot @xmath138 can only increase the relay transmit powers after that slot ; therefore , energy transfer has to be performed as early as possible , i.e. , at the first slot .",
    "hence , the jointly optimal policy is @xmath139 and @xmath140 for the remaining slots as shown in fig .",
    "[ spec2 ] .",
    "note that the power sequences of the source and the relay are not matched .",
    "@xmath141 is found by solving a fixed point equation as : @xmath142 where @xmath143 is the maximum number of bits corresponding to the energy arrival sequence @xmath144 .",
    "in this section , we consider a two - way channel as shown in fig .",
    "[ sysmodtwc ] .",
    "the two queues at the nodes are the data and energy queues .",
    "the energies that arrive at the nodes are saved in the corresponding energy queues .",
    "the data queues of both users always carry some data packets .",
    "the physical layer is a memoryless gaussian two - way channel @xcite where the channel inputs and outputs are @xmath145 , @xmath146 and @xmath147 , @xmath148 , respectively .",
    "the input - output relations are @xmath149 and @xmath150 where @xmath151 and @xmath152 are independent gaussian noises with zero - mean and unit - variance . in slot @xmath153 ,",
    "the first and second users harvest energy in amounts @xmath154 and @xmath155 , respectively .",
    "there is a separate wireless energy transfer unit at the first user , that transfers energy from the first user to the second user with efficiency @xmath14 .",
    "the power policy of user @xmath156 is composed of the sequences @xmath18 and @xmath15 , and the power policy of user @xmath157 is the sequence @xmath20 .    for the gaussian two - way channel with individual power constraints @xmath158 and @xmath159 , rate pairs @xmath160 with @xmath161",
    "are achievable @xcite . for a fixed energy transfer vector @xmath24 , and feasible power control policies @xmath22 and @xmath23 ,",
    "the set of achievable rates is : @xmath162 the notation shows the dependence of the region on the energy transfer vector @xmath24 .",
    "this region is shown in fig .",
    "[ twowaycap ] for different values of @xmath24 .",
    "each of these regions are rectangles of the form @xmath163 where @xmath164 is the maximum throughput achieved for user @xmath16 found by maximizing ( [ capdelta ] ) constrained to the feasibility constraints @xmath26 . as @xmath24 is increased , energy is transferred from user 1 to user 2 therefore @xmath165 decreases while @xmath166 increases . by taking the union of the regions over all possible energy transfer vectors and power policies for the users ,",
    "we obtain the capacity region of the gaussian two - way channel as : @xmath167 we determine the capacity region of the gaussian two - way channel in the next section , by solving weighted rate maximization problems which trace the boundary of the capacity region .",
    "in this section , we characterize the capacity region as well as the optimal power allocation and energy transfer policies .",
    "we start by noting that the capacity region is convex in the following lemma .",
    "the proof of this lemma is provided in appendix  [ pf1 ] .",
    "[ convexlemma ] @xmath168 is a convex region .",
    "since @xmath168 is convex , each boundary point can be found by solving the following weighted rate maximization problem : @xmath169 the problem in ( [ opt_prob1 ] ) is a convex optimization problem as the objective function is concave and the feasible set is a convex set @xcite .",
    "we write the lagrangian function for ( [ opt_prob1 ] ) as : @xmath170 + \\sum_{k=1}^t \\mu_k \\left(\\sum_{i=1}^k { p_{i } } - ( { e_{i } } - \\delta_i ) \\right ) \\\\ & + \\sum_{k=1}^t \\eta_k \\left(\\sum_{i=1}^k { \\bar{p}_{i } } - ( { \\bar{e}_{i } } + \\alpha \\delta_i ) \\right ) - \\sum_{k=1}^t \\rho_k \\delta_k \\label{lagrangian_relay}\\end{aligned}\\ ] ] where we do not include constraints @xmath34 since these constraints can never be satisfied with equality in the optimal policy for the gaussian two - way channel for @xmath171 , as that would require @xmath172 for some @xmath16 , which is suboptimal .",
    "zero powers are optimal only in the degenerate case @xmath173 , which corresponds to maximizing @xmath174 , whose solution is point 3 in fig .",
    "[ twowaycap ] .",
    "the kkt conditions for this problem are : @xmath175 with the additional complementary slackness conditions as : @xmath176 from ( [ kkt_source_twc ] ) , ( [ kkt_relay_twc ] ) and ( [ kkt_energy_twc ] ) we get : @xmath177        we will give the solution for general @xmath178 in the sequel . before that",
    ", we note that in the extreme case when @xmath179 , the problem reduces to maximizing the first user s throughput only and hence any energy transfer is strictly sub - optimal , i.e. , @xmath180 is optimal .",
    "this corresponds to point 1 in fig .",
    "[ twowaycap ] .",
    "similarly , when @xmath181 , the problem reduces to maximizing the second user s throughput only and the first user must transfer all of its energy to the second user , i.e. , @xmath182 is optimal .",
    "this corresponds to point 3 in fig .",
    "[ twowaycap ] . when @xmath183 , we obtain the points between points 1 and 3 in fig .",
    "[ twowaycap ] . in this case , for a given energy transfer profile @xmath184 , the optimization problem can be separated into two optimization problems , each only in terms of the power control policy of the corresponding user . for fixed @xmath24 ,",
    "the optimal power policies of the two users can be found by @xcite .",
    "next , we provide the necessary optimality condition for a non - zero energy transfer .",
    "[ ratiolemma ] for the optimal power sequences @xmath185 and energy transfer sequence @xmath41 , if @xmath44 for a slot @xmath16 , then @xmath186    from ( [ source_soln_twc ] ) , ( [ relay_soln_twc ] ) and ( [ transfer_soln_twc ] ) , we have @xmath187 if there is a non - zero energy transfer , @xmath44 , we have from ( [ comp_slack3 ] ) , @xmath95 .",
    "therefore , ( [ ratio ] ) must be satisfied if @xmath188 .    in order to devise an algorithmic solution",
    ", we apply a change of variable @xmath189 and re - write the optimization problem in terms of @xmath190 as follows : @xmath191 the optimal power allocation for this problem is : @xmath192 where @xmath193 and @xmath194 in slot @xmath16 are defined by @xmath195    the power level expressions in ( [ newlevel1])-([newlevel2 ] ) lead to a directional water - filling interpretation @xcite . in particular , we note that energy has to be jointly allocated in time and user dimensions together .",
    "this calls for a _ two - dimensional directional water - filling _ algorithm where energy is allowed to flow in two dimensions , from left to right ( in time ) and from up to down ( among users ) .",
    "we , next , explain this algorithm .",
    "we utilize _ right permeable taps _ to account for energy which will be used in the future and _ down permeable taps _ to account for energy that will be transferred from user @xmath156 to user @xmath157 ; see fig .",
    "[ twodirwfmetertaps ] .",
    "we note from the kkt conditions that @xmath196 in slots where there is non - zero energy transfer .",
    "note that in the original problem , this implies that if some energy is transferred , then the power levels in that slot need to satisfy ( [ ratio ] ) .",
    "the base levels for users 1 and 2 are @xmath156 and @xmath197 , respectively . moreover , to facilitate the water flow interpretation , we scale the energy arrivals of user 2 by @xmath197 as seen in ( [ opt_prob2 ] ) .",
    "if the resulting water levels are higher for user @xmath156 or not monotonically increasing in time for both users , then water has to flow until the levels are balanced .    while finding the balanced water levels , the two dimensions of the water flow ( i.e. , in time and among users ) are coupled and therefore it is not easy to determine beforehand which taps will be open or closed in the optimal solution .",
    "in particular , the water flow of user @xmath157 from time slot @xmath16 to time slot @xmath198 , @xmath199 , may become redundant if some energy is transferred from user @xmath156 in time slot @xmath198 . to circumvent this difficulty ,",
    "we let each tap ( right / down permeable ) have a _ meter _ measuring the water that has already passed through it and we allow that tap to let the water flow back if an update in the allocation necessitates it . this way , we keep track of the source of the energy and whether it is transferred to future time slots or to the other user . first , we fill energy into the slots with all taps closed .",
    "then , we open only the right permeable taps and perform directional water - filling ( over time ) for both users individually @xcite .",
    "then , we open the down taps one by one in a backward fashion . if water flows down through a tap , the amount is measured by the meter .",
    "water levels in the slots connected by the bi - directional horizontal taps need to be equal .",
    "whenever water flows down through a down permeable tap , the water levels must satisfy the proportionality relationship in ( [ ratio ] ) . when the water levels are properly balanced , the optimal solution is obtained .",
    "an example run of the algorithm is given in fig .",
    "[ twodirwfmetertaps ] for @xmath200 and @xmath201 .",
    "initially , we open the right permeable taps and the water levels are equalized for the first user .",
    "then , we open the down permeable taps . in the second slot there is no need for energy transfer because @xmath202 . in the first slot",
    "there will be some non - zero energy transfer since @xmath203 , and some water flows through the first down permeable tap .",
    "since user 1 s right permeable tap has a positive meter at that point , some water is allowed to flow from right to left thereby equalizing the water levels of user 1 s first and second slots and user 2 s first slot .          in order to show",
    "more specifically how the algorithm runs and further justify the particular sequence of steps followed in the two - dimensional water - filling algorithm , we next provide a numerical example where @xmath204 $ ] mj , @xmath205 $ ] mj and @xmath206 .",
    "@xmath207 , @xmath208 denote the horizontal taps of the first and second users connecting the @xmath16th and @xmath209st slots , @xmath210 denotes the @xmath16th vertical tap .",
    "the optimal solution is @xmath211 $ ] and @xmath212 $ ] , which is obtained by spreading the energy as equally as possible in two dimensions among the users and time slots , subject to energy causality . in order to understand why the particular order of tap openings is optimal ,",
    "we next consider two sub - optimal orderings of tap openings .",
    "assume that we open the horizontal taps first and keep the vertical taps closed .",
    "this yields the transient water levels @xmath213 $ ] and @xmath214 $ ] .",
    "now , if we open the vertical taps , water is transferred in the second and third slots and the balanced final levels are @xmath215 $ ] and @xmath216 $ ] .",
    "this profile is not optimal since the second user changes its power level when the battery is non - empty , violating ( * ? ? ?",
    "* lemma 2 ) .",
    "now , assume that we open the vertical taps first and keep the horizontal taps closed .",
    "energy is transferred in the second slot and the new transient water levels will be @xmath217 $ ] and @xmath218 $ ] . then , when we open the horizontal taps , we will have @xmath219 $ ] and @xmath220 $ ] .",
    "this profile is not optimal either , as after energy transfer , the source power level is less than the relay power level , violating lemma  [ ratiolemma ] .",
    "we now show how the two - dimensional directional water - filling algorithm works .",
    "first , we open the horizontal taps to get @xmath213 $ ] and @xmath214 $ ] with the water meters reading @xmath221 $ ] and @xmath222 $ ] . recall that the taps with positive meter readings allow bi - directional energy transfer .",
    "next , we open the vertical taps in a backward fashion . once @xmath223 is opened , water flows to the second user and since @xmath224 , @xmath225 are bi - directional it starts to fill all the slots of the second user .",
    "a balance is established when @xmath211 $ ] and @xmath212 $ ] , which is the optimal solution .",
    "in this section , we consider the multiple access channel scenario shown in fig .",
    "[ macmodelfig ] . in the multiple access channel ,",
    "the received signal is @xmath226 where @xmath145 and @xmath146 are signals of user 1 and user 2 , respectively , and @xmath227 is a gaussian noise with zero - mean and unit - variance . for the gaussian two - user multiple access channel with individual power constraints @xmath158 and @xmath159 ,",
    "rate pairs @xmath160 with @xmath161 , @xmath228 are achievable @xcite . for a fixed energy transfer vector @xmath24 , and feasible power control policies @xmath22 and @xmath23 ,",
    "the set of achievable rates is a pentagon defined as @xcite : @xmath229 for each feasible @xmath230 , the region is a pentagon .",
    "we obtain the capacity region by taking the union of these regions over all feasible power allocations and energy transfer profiles : @xmath231 we determine the capacity region of the gaussian multiple access channel in the next section .",
    "in this section , we characterize the capacity region as well as the optimal power allocation and energy transfer policies .",
    "first , we note in the following lemma that the capacity region is convex .",
    "we prove this lemma in appendix  [ pf2 ] .",
    "[ convexlemmamac ] @xmath232 is a convex region .    since the region is convex , each boundary point is a solution to @xmath233 @xcite for some @xmath234 $ ] .",
    "we examine two cases separately , @xmath235 and @xmath236 .",
    "we show that when @xmath235 , no energy transfer from user 1 to user 2 is needed .",
    "note that as @xmath235 , the boundary points between @xmath156 , @xmath157 and @xmath237 in fig .",
    "[ maccap ] are found by solving the problem : @xmath238 the problem in ( [ opt_prob1 m ] ) is a convex optimization problem as the objective function is concave and the feasible set is a convex set @xcite .",
    "we write the lagrangian function for ( [ opt_prob1 m ] ) as : @xmath239 + \\sum_{k=1}^t \\mu_k \\left(\\sum_{i=1}^k { p_{i } } - ( { e_{i } } - \\delta_i ) \\right ) \\\\ & + \\sum_{k=1}^t \\eta_k \\left(\\sum_{i=1}^k { \\bar{p}_{i } } - ( { \\bar{e}_{i } } + \\alpha \\delta_i ) \\right ) + \\sum_{k=1}^t \\gamma_k \\left(\\sum_{i=1}^k \\delta_i - { e_{i } } \\right ) - \\sum_{k=1}^t \\rho_k \\delta_k \\label{lagrangian_mac}\\end{aligned}\\ ] ] where we now included the constraints @xmath34 .",
    "the kkt conditions are : @xmath240 since @xmath235 , from ( [ kkt_sourcem])-([kkt_relaym ] ) , we have @xmath241 , which is satisfied with equality iff @xmath242 .",
    "this together with ( [ kkt_energym ] ) implies that @xmath243 , which is satisfied with equality iff @xmath242 and @xmath201 . therefore ,",
    "unless we have exactly @xmath242 and @xmath201 , we must have @xmath244 for all @xmath16 .",
    "this together with the complementary slackness conditions @xmath245 implies that we must have @xmath246 for all @xmath16 , i.e. , no energy transfer is needed . however ,",
    "when @xmath200 and additionally if @xmath201 , then there may exist multiple different optimal energy transfer profiles , including the one with no energy transfer .     and @xmath247 .",
    "]    since energy transfer is not needed , optimal power control policies for the two users are the same as those in the energy harvesting multiple access channel with no energy transfer and can be found by the _ generalized backward directional water - filling algorithm _ described in @xcite .",
    "that is , the capacity region boundary from point @xmath156 to point @xmath237 in fig .",
    "[ maccap ] is found by the algorithm in @xcite .",
    "specifically , for @xmath242 , we have @xmath248 for all @xmath69 and the sum - rate optimal power policies are obtained by applying single - user directional water - filling algorithm to the sum of the energy profiles of the two users @xcite .      here ,",
    "we consider the remaining parts of the boundary , namely the points from point @xmath237 to point @xmath249 in fig .",
    "[ maccap ] . in this case",
    ", we need to solve the following optimization problem : @xmath250 which is a convex optimization problem and the corresponding kkt conditions are : @xmath251 we do not have an analytical closed form solution for ( [ kkt_relaym2])-([kkt_energym2 ] ) . since ( [ opt_prob2 m ] ) is a convex optimization problem , standard numerical methods for convex optimization may be employed .",
    "we find that the solution of ( [ opt_prob2 m ] ) has a simple form in some special cases , which we investigate next .",
    "when @xmath201 , we find that the optimal solution of ( [ opt_prob2 m ] ) requires all the energy of user @xmath156 transferred to user @xmath157 . to verify this fact , we note from ( [ kkt_relaym2])-([kkt_sourcem2 ] ) that @xmath252 , since @xmath253 . combining this with ( [ kkt_energym2 ] ) , we obtain @xmath254 .",
    "note that if @xmath255 , then @xmath256 and hence @xmath257 , which is not possible .",
    "thus , in the optimal solution , we must have @xmath258 .",
    "therefore , user 1 should not transmit any data , and instead should transfer all of its energy to user 2 by the end of @xmath9 slots .",
    "this policy corresponds to point @xmath249 in fig .",
    "[ maccap ] . on the other hand , sum - rate optimal point , point 3 , achieves the same throughput as point 4 .",
    "this implies that when @xmath201 , points @xmath157 , @xmath237 and @xmath249 in fig .",
    "[ maccap ] lie on the @xmath259 line . in particular , the optimal throughput of user @xmath157 , which is obtained by single - user throughput maximization subject to harvested energies of user 2 plus the harvested energies of user 1 , coincides with the optimal sum - throughput .    when @xmath247 , points @xmath237 and @xmath249 in fig .",
    "[ maccap ] are not on the same line .",
    "we observe that when @xmath260 is sufficiently large , user 1 transfers all of its energy to user 2 . in order to verify this claim",
    ", we note that , if user 1 transfers some but not all of its energy at the end of @xmath9 slots , then @xmath256 . in this case , from ( [ kkt_relaym2])-([kkt_energym2 ] ) and as @xmath261 , we have @xmath262 since @xmath263 , we conclude that if @xmath264 , then ( [ ff ] ) can not be satisfied which forces all of the energy of user 1 to be transferred to user 2 so that @xmath265 .",
    "note that @xmath264 is equivalent to @xmath266 .",
    "hence , if @xmath266 , in the optimal solution , user 1 transfers all of its energy to user 2 .",
    "this implies that the capacity region boundary intersects the horizontal line in fig .",
    "[ maccap ] with slope less than or equal to @xmath197 .",
    "in this section , we provide numerical examples for the multi - user settings studied and illustrate the resulting optimal policies . in all examples , we assume that the slot length is 1 second , noise spectral density is @xmath267 w / hz and the available bandwidth is 1 mhz . moreover , path loss of each link in each model is set to 100 db for convenience .",
    "we first consider the two - hop relay channel with energy harvesting and energy transfer in section  [ model ] . in our first numerical study ,",
    "the source and the relay have the energy arrival profiles @xmath268 $ ] mj and @xmath269 $ ] mj , respectively , and the wireless energy transfer efficiency is @xmath270 .",
    "we note that for these energy harvesting profiles the relay energy profile is higher at the beginning and lower at the end with crossing only once in the third slot .",
    "therefore , the resulting optimal rate profiles are matched in the optimal policy .",
    "an optimal energy transfer vector is @xmath271 $ ] mj and the resulting optimal power allocation vectors after the energy transfer are @xmath272 $ ] mw . we note that while the optimal energy transfer profile is not unique , resulting optimal powers are unique .",
    "next , we change the energy arrival profiles for the source and the relay as @xmath273 $ ] mj and @xmath274 $ ] mj , respectively , with energy transfer efficiency @xmath270 .",
    "note that the source node is not energy harvesting . in this case",
    ", we find the optimal energy transfer vector as @xmath275 $ ] mj and the resulting optimal power vectors are @xmath276 $ ] mw . note that the optimal power sequences for the source and the relay match in this specific example , which does not hold in general .",
    "in this section , we consider the gaussian two - way channel model in section  [ twcmodel ] .",
    "the energy arrival profiles of user 1 and user 2 are @xmath277 $ ] mj and @xmath278 $ ] mj , respectively , and the wireless energy transfer efficiency is set to @xmath279 .",
    "we found the capacity region by running the two - dimensional directional water - filling algorithm for all @xmath280 .",
    "we plot the resulting capacity region in fig .",
    "[ twccapsim ] , where we also plot the capacity region when energy transfer is not allowed .",
    "note that when energy transfer is not allowed , the capacity region is the rectangle with single - user optimal rates subject to the individual energy arrivals .",
    "we observe that the availability of wireless energy transfer significantly improves the capacity region .          in this section",
    ", we consider the gaussian multiple access channel model in section  [ macmodel ] .",
    "the energy arrival profiles of user 1 and user 2 are @xmath281 $ ] mj and @xmath282 $ ] mj , respectively , and wireless energy transfer efficiency is @xmath270 .",
    "we plot the resulting capacity region in fig .",
    "[ maccapsim ] and we compare it with the region when no energy transfer is allowed .",
    "note that when no energy transfer is allowed , the region is found by the backward directional water - filling algorithm in @xcite .",
    "we observe in fig .",
    "[ maccapsim ] that the boundary of the capacity regions when energy transfer is allowed and not allowed match when the priority of user 1 is higher than the priority of user 2 .",
    "however , the availability of wireless energy transfer significantly improves the capacity region when priority of user 2 is higher than the priority of user 1 .",
    "energy cooperation made possible by wireless energy transfer is a fundamental shift in terms of the energy dynamics of a wireless network , yielding new performance limits . in this paper",
    ", we studied the communication performance of simple two- and three - node wireless networks in a deterministic setting where nodes harvest energy from the environment and wireless energy transfer is possible from one user to another in one - way and with efficiency @xmath13 .",
    "we first considered the gaussian two - hop relay channel and studied the end - to - end throughput maximization problem .",
    "we showed that if the relay energy profile is higher first and then lower , the rates of the source and the relay nodes need to be matched in the optimal policy .",
    "we also showed that if the source is not energy harvesting , then transferring energy in the first slot is optimal .",
    "next , we studied the capacity region of the gaussian two - way channel .",
    "we showed that the boundary of the capacity region is achieved by policies that are given by a generalized version of two - dimensional directional water - filling algorithm .",
    "finally , we studied the gaussian multiple access channel .",
    "we showed that no energy transfer is needed if the priority of the first user is higher , and all of the energy needs to be transferred to the second user if the priority of the second user is sufficiently high .",
    "these results reveal new insights on how energy is optimally allocated in multi - user scenarios when wireless energy transfer is available as a new degree of freedom in network design .",
    "we remark that the analysis for finding the optimal policies in each multi - user setting can be extended for the cases when bi - directional energy transfer is allowed . in the two - hop relay setting , if bi - directional energy transfer is allowed , perfectly matching the energy profiles of the source and the relay nodes would be feasible and hence optimal : in this case , we collect energy arrivals of the source and the relay in a single energy queue and perform a single - user optimization .",
    "we then divide resulting power allocation equally for the source and the relay .",
    "similarly , @xcite recently presented the extension of the analysis for two - way and multiple access channels when bi - directional energy transfer is allowed .",
    "consider two feasible power policies and energy transfer profiles @xmath283 and @xmath284 .",
    "let us consider a new policy as a convex combination of these two policies , i.e. , @xmath285 for @xmath286 .",
    "first we show that this new policy is feasible : @xmath287 we use similar arguments for @xmath288 and show that the policy @xmath289 is feasible .",
    "now , consider the upper corner points of the achievable rate regions for @xmath283 and @xmath284 . since @xmath290 is concave in @xmath291 , we have @xmath292 this means that the new policy @xmath289 achieves a higher throughput for both users than the line connecting the two upper corner points under policies @xmath283 and @xmath284 .",
    "therefore , the region @xmath168 is a convex region .",
    "consider two feasible power policies and energy transfer profiles @xmath283 and @xmath284 .",
    "let us consider a new policy as a convex combination of these two policies , i.e. , @xmath285 for @xmath286 .",
    "since the constraints in set @xmath26 are linear in the power vectors , it can be shown as in the proof of lemma  [ convexlemma ] in appendix  [ pf1 ] that this new policy is feasible .",
    "now , let @xmath293 be the pentagon created by the policy @xmath294 , for @xmath295 .",
    "choose @xmath296 and @xmath297 to form @xmath298 for @xmath299 .",
    "we need to show that @xmath300 .",
    "we proceed as follows : @xmath301 similarly , we show @xmath302 .",
    "finally @xmath303 these inequalities show that @xmath300 since it satisfies the boundary conditions of @xmath304 .",
    "therefore , the region @xmath168 is a convex region ."
  ],
  "abstract_text": [
    "<S> in energy harvesting communications , users transmit messages using energy harvested from nature during the course of communication . with an optimum transmit policy , </S>",
    "<S> the performance of the system depends only on the energy arrival profiles . in this paper </S>",
    "<S> , we introduce the concept of _ energy cooperation _ , where a user wirelessly transmits a portion of its energy to another energy harvesting user . </S>",
    "<S> this enables shaping and optimization of the energy arrivals at the energy - receiving node , and improves the overall system performance , despite the loss incurred in energy transfer . </S>",
    "<S> we consider several basic multi - user network structures with energy harvesting and wireless energy transfer capabilities : relay channel , two - way channel and multiple access channel . </S>",
    "<S> we determine energy management policies that maximize the system throughput within a given duration using a lagrangian formulation and the resulting kkt optimality conditions . </S>",
    "<S> we develop a _ two - dimensional directional water - filling algorithm _ which optimally controls the flow of harvested energy in two dimensions : in time ( from past to future ) and among users ( from energy - transferring to energy - receiving ) and show that a generalized version of this algorithm achieves the boundary of the capacity region of the two - way channel . </S>"
  ]
}