{
  "article_text": [
    "the bethe lattice is a valuable substrate , on top of which many cooperative models are solved exactly @xcite and show critical behaviors with mean - field critical exponents and gaussian critical fluctuations .",
    "a regular bethe lattice is equivalent to an infinite random regular graph , which is locally treelike and has only infinite cycles ( loops ) and no boundary .",
    "this is in contrast with an infinite cayley tree in which the boundary suppresses phase transitions , e.g. , in the ising model on a cayley tree , finite or infinite , long - range order never emerges .",
    "the configuration model @xcite of a sparse uncorrelated network and its generalizations represent a heterogeneous version of the bethe lattice .",
    "this basic model also provides exact solutions for percolation and other problems in infinite random networks @xcite .",
    "self - consistency equations for the probability of reaching a finite branch by following a link yield the solution of percolation problems for infinite locally treelike random networks @xcite .",
    "recently it was found in ref .",
    "@xcite that such self - consistency equations produce a good approximation of the percolation behavior of large but still finite , sparse graphs .",
    "this conclusion was supported by numerical simulations .",
    "the equations are written for a given graph from which a fraction @xmath0 of links are removed . these self - consistency equations  termed message passing equations in the context of finite graphs ",
    "predict a sharp continuous phase transition for any finite graph , e.g. , for the @xmath1-clique ( four interconnected nodes ) . in reality ,",
    "a continuous phase transition is absent in finite systems .",
    "the same is true for transitions in other models produced by using the locally treelike approximation on finite graphs containing loops . in this paper , instead of describing a given finite system with some unknown accuracy",
    ", we address the issue of this useful approximation from a complementary perspective .",
    "namely , if the message passing equations in principle can not precisely describe physical models on finite graphs , then what do they describe ? for each given finite graph , we construct a related infinite network for which these equations provide an exact description of the cooperative models . this infinite network is a generalization of the bethe lattice with percolation properties that are described exactly by the message passing equations on the finite graph @xcite .",
    "the closer the original finite graph is to this construction , the better the approximation provided by the message passing equations .",
    "we therefore give a physical interpretation of the solutions of these equations for percolation on a finite graph .",
    "we express these solutions in the critical region in terms of the principal eigenvector components of the non - backtracking matrix . as another example we consider the problem of optimal percolation @xcite .",
    "we show that using our network construction , an approximate algorithm for finding the so - called decycling number @xcite can be formulated in simple terms of the principal eigenvector of the non - backtracking matrix .",
    "we introduce a way to quantify the accuracy of the message passing algorithm and indicate two classes of networks for which the approximation fails .",
    "we calculate the time complexity associated with message passing algorithms and show that in a wide range of important situations this method is less efficient than direct numerical simulations .",
    "to build the _ non - backtracking expansion _ of an arbitrary finite , connected , undirected graph @xmath2 , we first construct the tree @xmath3 in the following way .",
    "for any given node @xmath4 of @xmath2 , @xmath5 is a star graph consisting of a node labeled @xmath4 in the center , and for any node @xmath6 in @xmath2 for which a link @xmath7 exists , we attach a node to the center node in @xmath5 and label it @xmath6 . for general @xmath8",
    "we define @xmath3 in a recursive way . to any leaf labeled @xmath9 in @xmath10",
    ", we attach a node labeled @xmath11 if and only if @xmath12 , where @xmath13 is the non - backtracking matrix of graph @xmath2 and @xmath6 is the label of the parent node of leaf @xmath9 in @xmath10 .",
    "the non - backtracking matrix @xcite is defined as @xmath14 , where @xmath15 and @xmath16 are end node pairs of links in the original graph .",
    "note that both directions must be taken into account for each link .",
    "we see that the branches emanating from the root @xmath4 in @xmath3 correspond exactly to non - backtracking walks in the original graph @xmath2 starting from node @xmath4 .",
    "in this construction the nodes of the resulting tree have only labels of the original finite graph , @xmath17 , so different nodes in this tree can have the same labels .",
    "the same is true for nodes in each individual branch of the tree .",
    "figure  [ fig : trees](b ) explains @xmath3 for the finite graph in fig .",
    "[ fig : trees](a ) .     and",
    "( c ) the branch @xmath18 for an example graph ( a ) .",
    "the root ( starting node ) in @xmath19 is shown by an empty circle and the starting link in @xmath18 is marked with a dashed line .",
    "@xmath20 is the number of nodes in the network.,width=226 ]    taking the limit @xmath21 and formally excluding the boundary , we obtain a structure in which all nodes of the same label @xmath4 and all links of the same label @xmath7 are topologically equivalent .",
    "this construction is a generalization of the bethe lattice and we call it the non - backtracking expansion ( nbe ) of graph @xmath2",
    ". it is a specific bethe lattice preserving the local topology of connections of the graph @xmath2 .",
    "for example , the nbe of the @xmath1-clique is simply a regular bethe lattice of coordination number 3 .",
    "a more explicit definition of the nbe can be given using the `` @xmath22-cloned '' network @xcite of the given graph @xmath2 .",
    "this network is constructed as follows .",
    "let the nodes of @xmath2 be labeled @xmath17 .",
    "we make @xmath22 replicas of all these nodes , still labelled @xmath17 within each of the @xmath22 replicas .",
    "the @xmath23 nodes obtained in this way are the nodes of the @xmath22-cloned network @xmath24 defined as follows .",
    "let @xmath24 be the network that is maximally random under the constraint that if and only if nodes @xmath4 and @xmath6 are connected in @xmath2 , then any of the @xmath22 nodes labeled @xmath4 in @xmath24 is connected to exactly one node labeled @xmath6 ( of , in total , @xmath22 such nodes ) .",
    "in other words , make @xmath22 copies of graph @xmath2 and consider all possible rewirings that preserve the labels of end nodes of all links , with equal statistical weights ( uniform randomness ) .",
    "figure  [ fig : bethe ] explains this construction for @xmath25 .     for the finite graph in fig .",
    "[ fig : trees](a ) , according to ref .",
    "three of the members of the statistical ensemble of graphs constituting @xmath26 are shown as examples.,width=226 ]    let us take the limit @xmath27 and consider the infinite network @xmath28 .",
    "this network is locally treelike : any finite neighborhood of any node @xmath4 is given by the tree @xmath29 .",
    "all loops in this network are infinite , and all nodes of label @xmath4 ( and links of label @xmath7 ) are topologically equivalent .",
    "the network @xmath28 gives exactly the nbe of graph @xmath2 .    to discuss the properties of the nbe",
    "it is helpful to define the branch @xmath30 as the tree that is recursively generated by the non - backtracking walks of length @xmath31 in @xmath2 starting from the link @xmath7 , as shown in fig .",
    "[ fig : trees](c )",
    ". clearly , @xmath32 consists of all branches @xmath30 ( all @xmath6 , for which there is a link @xmath33 in graph @xmath2 ) .",
    "let us consider properties of these constructions .",
    "let @xmath34 be the number of links of label @xmath35 on the surface of @xmath36 ( these are links from parent @xmath9 on the surface of sphere @xmath37 to child @xmath11 on the surface of sphere @xmath31 ) .",
    "let @xmath38 be the size ( number of nodes ) of the surface of @xmath36 , so that @xmath39 is the relative number of links of label @xmath35 on the surface of @xmath36 .",
    "every link on the surface of @xmath40 must emanate from the end node of a link on the surface of @xmath36 , so @xmath41 that is @xmath42 taking @xmath43 , the ratio @xmath44 converges to an asymptotic mean branching @xmath45 and the numbers @xmath46 must also converge to some asymptotic values @xmath47 . for @xmath43 ,",
    "therefore , we get @xmath48 or , in vector form , @xmath49 equation ( [ eq:40 ] ) is a right eigenvector equation for the non - backtracking matrix of the original graph @xmath2 . according to the perron - frobenius theorem @xcite , the non - backtracking matrix @xmath13 has exactly one strictly non - negative right eigenvector , and this is the eigenvector corresponding to the leading eigenvalue .",
    "all of the components of @xmath50 are , by definition , non - negative , therefore the mean branching @xmath45 is equal to the leading eigenvalue @xmath51 of @xmath13 .",
    "we note that the leading eigenvalue and the corresponding right eigenvector are independent of the starting link @xmath33 , so we have the following general result .",
    "the asymptotic mean branching of @xmath36 , for any @xmath33 , is given by the leading eigenvalue @xmath51 of the non - backtracking matrix of graph @xmath2 . from the construction of @xmath52 , it is clear that @xmath52 must also have the same asymptotic mean branching for any root @xmath4 .",
    "the asymptotic relative number of links @xmath35 on the surface of @xmath36 ( or @xmath52 ) are given by the components of the principal right eigenvector @xmath53 of @xmath13 .",
    "these asymptotic relative numbers are , again , independent of the starting link ( or node ) .",
    "now we can find the asymptotic relative number @xmath54 of nodes of label @xmath4 on the surface ( of either @xmath55 or @xmath56 , independent of the starting link @xmath57 or root @xmath58 ) : @xmath59 where @xmath60 denotes the set of nearest neighbors of node @xmath4 in graph @xmath2 .",
    "the asymptotic relative number of nodes @xmath4 must also be the same on the layer just beneath the surface , and each node in this layer must be the starting node of a link on the surface , so we can also write @xmath61 where @xmath62 is the degree of nodes @xmath4 . equations  ( [ eq:50 ] ) and ( [ eq:60 ] ) give a general relationship between the components of the eigenvector @xmath53 .",
    "note that @xmath54 is the asymptotic probability to find a non - backtracking random walker at node @xmath4 after an infinitely long walk .",
    "this quantity coincides with the non - backtracking centrality of @xcite .",
    "let us return to @xmath38 , the size of the surface of @xmath36 .",
    "let @xmath63 be the sum of the sizes of all such surfaces , and @xmath64 be the relative size of the surface of @xmath36 .",
    "then @xmath65 or @xmath66 in the limit @xmath43 , the ratio @xmath67 converges to the asymptotic mean branching @xmath45 and the numbers @xmath68 must also converge to some asymptotic values @xmath69 .",
    "we can write @xmath70 or , in vector form , @xmath71 which is just a left eigenvector equation for @xmath13 .",
    "the same reasoning applies as before , so @xmath45 is equal to the leading eigenvalue of @xmath13 , @xmath51 .",
    "the vector @xmath72 is equal to the corresponding left eigenvector @xmath73 .",
    "then the asymptotic relative sizes of the surfaces of @xmath36 are given by the components of @xmath73 .",
    "we express the asymptotic relative sizes @xmath74 of the surfaces of @xmath52 in terms of these components : @xmath75 from the symmetric relationship between the left and right eigenvectors we see that @xmath76 , therefore @xmath77 thus the asymptotic relative size of the surface of @xmath3 is equal to the asymptotic relative number of nodes of label @xmath4 on the surface of any @xmath56 independently of @xmath58 .",
    "this quantity is expressed in terms of the components of the principal ( left or right ) eigenvector of the non - backtracking matrix of the original graph @xmath2 .",
    "it is clear from the above constructions that for an arbitrary graph @xmath2 , the interior of the infinite network @xmath78 is given exactly by @xmath79 , independently of @xmath58 .",
    "note , however , that the distribution of the numbers of nodes of different labels in @xmath79 is given by eq .",
    "( [ eq:50 ] ) , while the same distribution for @xmath78 is uniform  we made the same @xmath22 number of copies of every node .",
    "this discrepancy is reconciled by the presence of infinite loops : nodes in the infinite network @xmath78 are `` matched up '' at infinity to provide the overall uniform distribution of node labels .",
    "it is informative to consider the dispersion @xmath80 of the relative number of node labels within a distance @xmath81 of an arbitrarily chosen starting node in both @xmath56 and @xmath82 .",
    "suppose that @xmath31 and @xmath22 are such that the number of nodes in both @xmath56 and @xmath82 is @xmath20 and that @xmath20 is large .",
    "the dispersion @xmath80 in both cases will converge to @xmath83 but will go to zero for @xmath82 as @xmath81 approaches @xmath84 , while it remains the same for any @xmath81 in the case of @xmath56 . here",
    "the variables @xmath85 are the asymptotic values given by eq .",
    "( [ eq:50 ] ) .",
    "figure  [ fig : approach ] qualitatively illustrates this behavior .     of an arbitrarily chosen node in the non - backtracking expansion @xmath82 and the tree @xmath56 .",
    "the number of nodes in both @xmath24 and @xmath86 is denoted by @xmath20.,width=264 ]",
    "we now consider the problem of approximating percolation on finite graphs .",
    "the critical singularity in percolation occurs only in infinite networks where the giant connected component can be strictly defined . in a large",
    "though finite random graph a so - called scaling window , in which the behavior of the largest connected cluster noticeably deviates from the singular behavior of the giant connected component , is narrow . in a recent work karrer",
    "@xcite considered this problem of `` approximate '' percolation on a finite graph by solving self - consistency equations for the probabilities of reaching finite clusters by following a link in a given direction .",
    "such self - consistency equations provide an exact solution for percolation in infinite locally treelike random networks , and in finite graphs they give an approximation to the behavior of the largest connected cluster . the larger and more `` locally treelike '' the finite graph is , the better this approximation is expected to be . for an arbitrary connected finite graph the `` approximate critical point ''",
    "is given by the inverse of the leading eigenvalue of the non - backtracking matrix of the graph .",
    "it was shown in ref .",
    "@xcite that for infinite graphs , this is a tight lower bound on the exact percolation threshold .",
    "the question arises : more than treating it purely as an approximation , what is the exact meaning of the solutions of self - consistency equations on a finite graph ? the results of ref .",
    "@xcite rely on solving the following set of basic equations : @xmath87 where @xmath88 is the probability generating function for the distribution of the sizes of finite clusters reachable by following links @xmath89 from @xmath4 to @xmath6 .",
    "( in the context of finite graphs , the meaning of finite clusters is : not the largest cluster . ) here @xmath90 denotes the set of the nearest neighbors of node @xmath6 excluding node @xmath4 . clearly , in finite graphs , these equations do not hold exactly , but may be approximately correct if the graph in question is large and sparse . in our non - backtracking expansion ( the network @xmath91 ) , however , eqs .",
    "( [ eq:140 ] ) hold exactly and by solving them , we actually obtain the exact percolation results for @xmath92 . in ref .",
    "@xcite it is shown that the value of @xmath93 , at which a non - trivial solution to eqs .",
    "( [ eq:140 ] ) appears , is given by the inverse of the leading eigenvalue of the non - backtracking matrix of the given graph .",
    "this coincides with our result that the mean branching of the network @xmath91 is also given by the leading eigenvalue of the non - backtracking matrix .",
    "the inverse of this value is a true critical point in our non - backtracking expansion .",
    "the order parameter is the relative size of the giant connected component , and is given by @xmath94 where @xmath95 are the solutions of eq.([eq:140 ] ) at @xmath96 , for a given value of @xmath93 .",
    "the degree distribution of any nbe coincides with the degree distribution of the original finite graph , therefore it necessarily has a cutoff  the maximum degree in the original graph .",
    "consequently the order parameter exponent @xmath97 , @xmath98 , for the nbe of any finite graph .",
    "we express the slope @xmath99 of the order parameter at @xmath100 in terms of the components of the principal eigenvector of the non - backtracking matrix which naturally emerges when linearizing eq .",
    "( [ eq:140 ] ) .",
    "we can not do this directly , unlike , e.g. , in refs .",
    "@xcite , since the non - backtracking matrix is not symmetric , and so the full set of its eigenvectors does not form an orthogonal basis . to surpass this difficulty , we introduce a new symmetric matrix @xmath101 where @xmath51 is the leading eigenvalue of the non - backtracking matrix and matrices @xmath102 , @xmath103 and @xmath104 are the adjacency matrix , the degree matrix ( @xmath105 ) and the identity matrix , respectively .",
    "its eigenvectors already constitute a complete orthogonal basis .",
    "the leading eigenvalue of the non - backtracking matrix , @xmath51 , is also an eigenvalue of @xmath106 , and the corresponding eigenvector components can be expressed in terms of the components of the principal eigenvector of the non - backtracking matrix .",
    "these useful properties of matrix @xmath106 enable us to calculate the slope of the order parameter at @xmath107 , ( see appendix for details of the derivation )    @xmath108    figure  [ fig : curves ] compares the slopes of the order parameter @xmath109 calculated in the critical region solving eq .",
    "( [ eq:143 ] ) for the 4-clique , an erds  rnyi random graph and three real networks with the slopes found by using formula  ( [ eq:145 ] ) .",
    "note the perfect agreement at @xmath100 .",
    "the curves in figure  [ fig : curves](b ) also reveal the sizes of the regions in which the relation @xmath110 is applicable for these networks .",
    "the slope of the order parameter may also be obtained using a different method , that does not rely on symmetric matrices .",
    "this alternative method uses the fact that for any diagonalizable matrix , the complex conjugate of any left eigenvector corresponding to one eigenvalue is orthogonal to all right eigenvectors corresponding to a different eigenvalue ( and vice versa , the conjugate of any right eigenvector corresponding to one eigenvalue is orthogonal to all left eigenvectors corresponding to a different eigenvalue ) .",
    "this method yields a simpler expression for the slope , ( see appendix for details of the derivation ) @xmath111 both approaches have their respective merit and they provide equivalent expressions for the slope of the order parameter , eq .",
    "( [ eq:145 ] ) and eq .",
    "( [ eq:145b ] ) .",
    "the first method introduces a new symmetric matrix , which may be useful for various problems on undirected graphs , where the underlying matrix  the adjacency matrix  is symmetric .",
    "the second approach requires only that the relevant matrix be diagonalizable , therefore it may be used to treat a wide range of problems in non - symmetric systems , e.g. , percolation on directed networks .",
    "a detailed discussion of these issues will be presented elsewhere .     as a function of @xmath93 , computed using eq .",
    "( [ eq:143 ] ) , for the 4-clique , an erds  rnyi graph , the zachary karate club network @xcite , a subgraph of the gnutella peer - to - peer file sharing network @xcite and a snapshot of the internet at the autonomous systems level @xcite .",
    "( b ) normalized slopes of the same example networks , obtained using eq .",
    "( [ eq:145 ] ) ( or eq .",
    "( [ eq:145b ] ) ) .",
    "all normalized slopes go to @xmath112 at @xmath113.,width=264 ]    the above methods can be applied to the general class of problems defined by the set of message passing equations @xmath114 with the condition that @xmath115 where @xmath116 is a constant , independent of @xmath89 and @xmath117 . for any such model the solutions @xmath118 of eq .",
    "( [ eq:146 ] ) and the order parameter @xmath119 near @xmath100 can be calculated using our schemes ( see appendix ) .    as another example of the application of our results , we consider an algorithm approximating optimal percolation , suggested in ref .",
    "it was shown that an efficient way of destroying a network ( removing the least number of nodes in order to disconnect the giant component ) is by sequentially removing nodes according to their collective influence @xmath120 .",
    "this characteristic of node @xmath4 is defined as @xmath121 where @xmath62 is the degree of node @xmath4 and @xmath122 is the set of the nodes that are at a distance @xmath31 from node @xmath4 . in this algorithm",
    ", @xmath31 must be large but smaller than the diameter of the graph under consideration .",
    "let us consider the same problem on the non - backtracking expansion of a finite graph .",
    "we see that in this case the collective influences @xmath120taking @xmath43are just the asymptotic relative sizes of the surfaces of @xmath52 , multiplied by @xmath123 .",
    "we have already expressed these relative sizes in terms of the components of the principal eigenvector of the non - backtracking matrix of the original graph , see eq .",
    "( [ eq:120 ] ) .",
    "if a finite graph under consideration is large and has no short loops , we can assume that using our expression is a good approximation to the optimal way of disconnecting the graph .",
    "an improvement on the collective influence method is suggested in ref .",
    "it was shown empirically that better attack performance can be achieved by sequentially removing nodes according to the following centrality measure ( collective influence propagation ) @xmath124 where @xmath125 and @xmath126 are the components of the principal left and right eigenvectors of the non - backtracking matrix , respectively .",
    "it was also shown in @xcite analytically that removing a node according to eq .",
    "( [ eq:160 ] ) results in the biggest decrease of @xmath51 , the leading eigenvalue of the non - backtracking matrix , i.e. , the mean branching of the corresponding nbe .",
    "thus , this method produces `` step - wise optimal '' percolation . from the result",
    "@xmath76 we see that using the centrality index of eq .",
    "( [ eq:160 ] ) is actually equivalent to using @xmath127 considering the non - backtracking expansion we can give a physical interpretation of the product @xmath128 .",
    "this is the relative number of infinite paths in the nbe passing through a link @xmath89 ( or link @xmath129 ) .",
    "the relative number of infinite paths arriving at a link @xmath89 is given by @xmath126 and the relative number of infinite paths starting from a link @xmath89 is given by @xmath125 ( see section [ s3 ] ) .",
    "summing the product @xmath128 over all neighbors @xmath6 of node @xmath4 , we get the relative number of infinite paths in the nbe passing through a node @xmath4 , which is exactly the @xmath130 centrality index .",
    "one can consider the `` step - wise optimal '' removal of edges instead of nodes .",
    "for this problem , the expression ( [ eq:162 ] ) should be replaced by the following edge centrality measure : @xmath131 for edge @xmath132 .",
    "note that in the recent work @xcite a method for finding the decycling number of graphs was presented , outperforming all previous approaches to optimal percolation .",
    "we have shown that when we are using message passing equations to approximately solve any given problem on a finite graph , we are actually solving the problem exactly on the non - backtracking expansion of the given finite graph . at present",
    "there is no theory available to determine how good this approximation is in the general case .",
    "we now briefly discuss the accuracy of this approximation , through the example of random percolation , and how well it may be expected to work in certain situations .",
    "note that although we defined the nbe for finite graphs , it may also be defined for infinite networks as a limit of finite networks . from refs . @xcite and @xcite we know that for infinite networks the critical point ( for percolation ) of the nbe is a lower bound on that of the original network .",
    "an even stronger statement is also true : the relative size of the giant component in the nbe is an upper bound on that of the original network ( for any link activation probability @xmath93 ) .",
    "this is easily seen considering the following .",
    "the solutions @xmath95 of eq .",
    "( [ eq:140 ] ) are a lower bound on the actual probabilities of reaching a finite cluster when following link @xmath89 in the direction of @xmath6 , due to the presence of loops in the original network ( see @xcite ) . according to eq .",
    "( [ eq:143 ] ) , therefore , the order parameter of the nbe is an upper bound on that of the original network . with this result in mind",
    "we can quantify the _ badness _ @xmath133 of the nbe approximation as @xmath134 where @xmath109 is the order parameter of the original network and @xmath135 is the order parameter of the corresponding nbe , for given link activation probability @xmath93 .",
    "for infinite networks the absolute value in eq .",
    "( [ eq:170 ] ) is not necessary , as @xmath136 for any @xmath93 in this case . for finite graphs , however , @xmath137 for @xmath138 , where @xmath139 is the critical point of the nbe and @xmath109 is the relative size of the largest component .",
    "therefore the absolute value in eq .",
    "( [ eq:170 ] ) is required to make this a universally applicable , meaningful measure of the badness of the approximation . for uncorrelated random networks",
    "the nbe coincides with the network itself ( in the infinite size limit ) , therefore @xmath140 .",
    "we now consider two representative examples of networks , having the same nbe , where the approximation fails : a two dimensional square lattice and a synthetic modular network given by the following construction .",
    "consider @xmath141 subnetworks , each of which is a random regular network of @xmath22 nodes and degree @xmath1 . in each of the subnetworks ,",
    "let us remove @xmath142 randomly selected links , leaving @xmath1 nodes with degree @xmath143 .",
    "then , let us connect these affected nodes to similar affected nodes in other subnetworks randomly , restoring the uniform degree @xmath1 for every node in the network .",
    "in the limit @xmath144 this network has no finite loops and has modularity @xmath145 .",
    "the corresponding nbe is exactly the same as the one for a two dimensional square lattice .",
    "this nbe also coincides with that of a @xmath146-clique , it is a random regular network of degree @xmath1 .",
    "the above examples are particularly badly approximated by the nbe as can be seen in fig .",
    "[ fig : bad_fit ] ( a ) .    .",
    "( b ) real - world networks : the road network of california @xcite , and an amazon co - purchase network @xcite . in all cases the simulation results differ significantly from the message passing solutions .",
    "see table [ table1 ] for details.,width=264 ]    .size ( number of nodes ) , mean degree and the badness value @xmath133 ( defined in eq .",
    "( [ eq:170 ] ) ) for the networks considered in this section . [ cols=\"<,^,^,^\",options=\"header \" , ]     these two examples represent two classes of networks that are not well approximated by the nbe : low dimensional networks and highly modular networks .",
    "low dimensional networks have many short loops , therefore are essentially non - treelike .",
    "a modification of the original message passing method has been suggested in @xcite to deal with clustering and in @xcite for networks with loopy motifs .",
    "low dimensionality , however , implies many intertwined loops of many different sizes , which appears to be a significant factor in rendering such systems untreatable by the locally treelike approximation .",
    "interestingly , even if there are no finite loops in the network , the nbe may still be a bad approximation if the modularity is very high ( see the model modular network `` communities '' in fig . [",
    "fig : bad_fit ] ( a ) ) . a message passing method for modular networks",
    "is suggested in @xcite , however , to use it , one needs to know the modular structure of the network a priori .",
    "the problem is , that there is no unique definition of modularity in networks .",
    "also , finding the community structure of a network  using any meaningful definition of modularity  typically leads to np - hard decision problems @xcite . in fig .",
    "[ fig : bad_fit ] ( b ) we present real - world examples of the two classes of networks discussed above , a planar network ( road network of california @xcite ) and a modular network ( amazon co - purchase network @xcite ) .",
    "the respective badness values are shown in table [ table1 ] .",
    "an instructive example that simultaneously demonstrates the pitfalls and the remarkable power of this approximation is the neural network of the roundworm caenorhabditis elegans ( c. elegans ) @xcite .",
    "we investigated the hermaphrodite c. elegans , combining both chemical and electrical synapses and removing multiple links and self - loops .",
    "this neural network contains two obvious communities : the pharynx and the main body of the roundworm .",
    "the two communities are separated by only 2 links , hence the obvious modular structure of the network .",
    "[ fig : c_elegans ] shows percolation simulation results and the corresponding message passing solutions for the whole network and also for the two subnetworks ( obtained by cutting the 2 links separating the modules ) .",
    "the nbe approximation is not particularly good when the whole network is considered , but is remarkably accurate for the two subnetworks .",
    "these subnetworks are very small , and have high clustering coefficients ( @xmath147 for the pharynx and @xmath148 for the main body ) , implying that modularity is a much more important factor in determining the accuracy of the approximation .    , of the pharynx network!),width=264 ]",
    "figure [ fig : perfect_fit ] shows `` less correlated '' networks  also studied in @xcite  where the badness values of the approximation are very close to @xmath149 ( see table [ table1 ] ) .",
    "these networks are small worlds , i.e. , infinite - dimensional , and have low modularities .",
    "we showed above that low dimensionality and high modularity are two attributes that cause the approximation to fail .",
    "modular networks are ubiquitous in nature , therefore such excellent agreement as in fig .",
    "[ fig : perfect_fit ] ( or ref .",
    "@xcite ) may not actually be a very common case .",
    "finally , we discuss another serious limitation of the nbe approximation , its time complexity .",
    "a significant advantage of using message passing equations as opposed to doing simulations is that , supposedly , the computational time required to find the solutions is much less than the time involved in doing the actual simulations and averaging over many realizations .",
    "this is not always true , however .",
    "the number of operations required in the nbe approximation ( i.e. , when solving the message passing equations by iterations ) is @xmath150 . here , the number of iterations to convergence is denoted by @xmath151 .",
    "assuming @xmath151 to be at least proportional to the diameter of the network , it must grow at least logarithmically with the system size .",
    "the behavior of the quantities @xmath152 and @xmath153 depends very strongly on the degree distribution . for rapidly decaying and scale - free distributions the overall time complexity of the nbe approximation",
    "is given by @xmath154 as can be seen from eq .",
    "( [ eq:180 ] ) , for large scale - free networks with low degree distribution exponents the message passing method proves to be completely intractable .",
    "let us compare these results with the time complexity of doing actual simulations .",
    "say we want to determine the size of the `` giant '' percolating cluster in a large graph to a given accuracy ( given standard error ) .",
    "the quantity we re interested in is an average over @xmath141 samples , @xmath155 , where @xmath156 is a binary quantity ( @xmath157 or @xmath158 ) indicating whether a given node of the graph is in the giant component or not .",
    "the standard error of the estimate for @xmath119 is simply @xmath159 , where @xmath160 is the standard deviation of @xmath156 .",
    "therefore , for a given desired error in @xmath119 the number of node samples needed is independent of the system size . to determine whether a node belongs to the giant component",
    ", we must explore the neighborhood of this node ( e.g. , using a simple breadth first search ) up to a distance @xmath161 , where @xmath162 is the typical size of a finite cluster .",
    "the typical cluster size depends on the distance from the critical point , but not the system size . considering the above",
    ", we arrive at the following conclusion . at a given distance from the critical point , for a given desired accuracy",
    ", the order parameter can be determined using simulations in constant time for any network architecture .",
    "this is in strong contrast with the message passing approach , where the accuracy is unknown and the time complexity significantly higher . while the message passing method may be faster in certain small networks , it is always inferior to simple simulations for large enough networks",
    "message passing equations often provide a good approximation to the behavior of interacting models on large sparse networks . in this paper , for any finite graph , we have presented a network construction for which the message passing equations are exact , thereby giving a physical interpretation of this approximation . for a wide range of problems , represented by message passing equations",
    ", we showed how to express the solutions near the critical point in terms of the principal eigenvector components of the non - backtracking matrix .",
    "it is well established that this approximation should work well for infinite - dimensional ( small - world ) networks which are sparse and have no strong degree - degree correlations .",
    "it is not clear how well it should work for networks of low dimensionality , many loops and correlations .",
    "we introduced a way of quantifying the accuracy of the approximation and we elaborated on two distinct classes of networks where this approach fails : low dimensional and highly modular networks .",
    "as real - world examples of these cases we considered the road network of california and an amazon co - purchase network , where the message passing equations , indeed , proved a bad approximation .",
    "message passing methods based on the locally treelike approximation have a wide range of applicability and , in some cases , provide good results .",
    "however , as we have shown , for increasingly large systems these methods have a high computational cost compared with simple simulations .",
    "also , while one can always find an estimate of the error associated with simulations in a straightforward way , the accuracy of message passing methods is entirely unknown .",
    "all the results of this paper apply also to weighted graphs . in this case",
    "one must work with a weighted non - backtracking matrix , obtained by multiplying each row of the unweighted non - backtracking matrix by the weight of the corresponding link . using this modified matrix ,",
    "the critical point and the solutions near the critical point are determined identically to the unweighted case .",
    "the network construction presented here may be generalized straightforwardly to directed graphs .",
    "the directed percolation critical point is still given by the inverse of the leading eigenvalue of the non - backtracking matrix .",
    "solutions near the critical point can be found using the method we introduced for non - symmetric systems ( see method 2 in appendix ) .",
    "the non - backtracking expansion can be generalized to various percolation problems for interdependent and multiplex networks @xcite . in the case of multiplex networks ,",
    "the only difference from single layer ( simplex ) networks is that the resulting infinite network ( the nbe ) will consist of links of different colors , corresponding to links of different layers .",
    "the message passing equations written for any given model on finite multiplex networks @xcite will be exact in the corresponding nbe , just as in simplex networks .",
    "a number of percolation problems on multiplex and interdependent networks exhibit discontinuous transitions . in order to retain the interesting physics in these systems",
    ", one has to account for the nonlinear terms in the basic equations @xcite . finding the analytical solutions similar to our eqs .",
    "( [ eq:145 ] ) and ( [ eq:145b ] ) at discontinuous transitions in multiplex networks is an interesting challenge for the future .",
    "0.3 cm    this work was supported by the fet proactive ip project multiplex 317532 .",
    "we stated that in the class of physical problems on undirected networks defined by eqs .",
    "( [ eq:146 ] ) and ( [ eq:147 ] ) the solution near @xmath100 can be expressed in terms of the components of the principal eigenvector of the non - backtracking matrix . here",
    "we derive this expression in the particular case of the message passing equations ( [ eq:140 ] ) for percolation .",
    "we expand the message passing equations , eq .",
    "( [ eq:140 ] ) , as @xmath163 where @xmath164 .",
    "the set of eigenvectors of the non - backtracking matrix , @xmath165 , forms a complete basis enabling us to express the vector @xmath166 as a linear combination of the eigenvectors @xmath167 notice that both @xmath168 and the coefficients @xmath169 vary with @xmath93 , approaching @xmath149 when @xmath170 . replacing @xmath171 with @xmath172 in eq .",
    "( [ eq1 ] ) , we obtain the equation @xmath173 where we used the identity @xmath174 since @xmath165 is the eigenvector of the non - backtracking matrix with eigenvalue @xmath175 . since all @xmath169 approach @xmath149 as @xmath176 , eq .",
    "( [ eq3 ] ) implies that there is an eigenvalue @xmath177 , such that @xmath178 , and that for @xmath179 the coefficients @xmath180 approach @xmath149 as @xmath181 or faster .",
    "furthermore , by the perron - frobenius theorem if all components of @xmath53 are non - negative , then the eigenvalue @xmath51 is positive real and has the largest absolute value ( hence , the subscript @xmath112 ) . in this way we find that at small @xmath182 @xmath183 where @xmath184 are the components of the principal eigenvector of the non - backtracking matrix . from this point",
    "onwards one may use two different approaches .",
    "_ method 1 _ introduces an auxiliary symmetric matrix , to proceed with the derivation in the standard way .",
    "_ method 2 _ exploits a useful property of the left and right eigenvectors of diagonalizable matrices , resulting in a much shorter derivation and a more compact final result .",
    "let us consider the following sums , over the set of nearest neighbors @xmath185 of node @xmath4 @xmath186 we sum both sides of eq .",
    "( [ eq1 ] ) : @xmath187 replacing @xmath188 in the first of these equations with the right - hand side of the second equation we obtain @xmath189 , \\label{eq7}\\ ] ] where @xmath62 is the degree of node @xmath4 .",
    "let us introduce the matrix @xmath106 with elements @xmath190 defined as @xmath191 where @xmath192 are the elements of the adjacency matrix .",
    "the matrix @xmath106 is symmetric , and so we can express @xmath193 as a linear combination of its eigenvectors , @xmath194 , which form a complete orthogonal basis , @xmath195 in the following we denote the eigenvalues of @xmath106 by @xmath196 .",
    "these eigenvalues are different from the eigenvalues @xmath175 of the non - backtracking matrix .",
    "we replace @xmath197 and @xmath171 in eq .",
    "( [ eq7 ] ) with their decompositions , eqs .",
    "( [ eq9 ] ) and ( [ eq4 ] ) , respectively , @xmath198 c_{\\tilde{\\lambda } } u^{(\\tilde{\\lambda})}_{i }   { = }   { - } p_c\\sum_{\\lambda , \\lambda ' } c_{\\lambda } c_{\\lambda ' } \\sum_{j \\in \\partial_i}\\!\\ !",
    "\\left ( p_c \\!\\!\\!\\!\\!\\ ! \\sum_{k , k'>k \\in \\partial_i \\backslash j } \\!\\!\\!\\!\\!\\!\\!\\ !",
    "v^{(\\lambda)}_{i\\leftarrow k } v^{(\\lambda')}_{i\\leftarrow k ' } { - } \\!\\!\\!\\!\\!\\!\\ !",
    "\\sum_{k , k'>k \\in \\partial_j \\backslash i } \\!\\!\\!\\!\\!\\!\\!\\ !",
    "v^{(\\lambda)}_{j\\leftarrow k } v^{(\\lambda')}_{j\\leftarrow k'}\\right){+ } \\dots . \\label{eq10}\\ ] ] this equation implies that among the eigenvalues @xmath196 there is one , say @xmath199 , equal to @xmath200 . notice that the eigenvalue @xmath199 is not the leading eigenvalue of @xmath106 . note also that according to eqs .",
    "( [ eq4 ] ) , ( [ eq5 ] ) , and ( [ eq9 ] ) , @xmath201 , while the rest of the coefficients @xmath169 and @xmath202 approach @xmath149 as @xmath181 or faster . to obtain @xmath203",
    "we multiply both sides of eq .",
    "( [ eq10 ] ) by @xmath204 and sum over @xmath4 .",
    "the result is @xmath205 notice that the contribution of the first term on the left - hand side of eq .",
    "( [ eq10 ] ) is @xmath149 because the eigenvectors @xmath194 are orthogonal .",
    "finally , we express the order parameter near @xmath100 in terms of the principal eigenvector components of the non - backtracking matrix as @xmath206 where @xmath207      let us denote the right eigenvectors of the non - backtracking matrix by @xmath165 and the left eigenvectors by @xmath208 .",
    "the complex conjugate of any @xmath165 is orthogonal to all @xmath209 ( @xmath210 ) , and the conjugate of any @xmath208 is orthogonal to all @xmath211 ( @xmath210 ) .",
    "[ indeed , let @xmath210 be two different eigenvalues of @xmath13 . then , clearly @xmath212 , giving @xmath213 , and therefore , @xmath214 . ]",
    "recall eq .",
    "( [ eq3 ] ) , @xmath215 and that @xmath216 are components of the right eigenvector of the non - backtracking matrix , corresponding to eigenvalue @xmath175 . multiplying both sides by @xmath217 and summing over @xmath218",
    "we see that the terms of @xmath179 become zero .",
    "this procedure results in a considerably simpler expression for the coefficient @xmath203 : @xmath219 where we used the property of the non - backtracking matrix of undirected graphs @xmath220 , for simplification .",
    "the singularity of the giant component @xmath221 has an amplitude , eq .",
    "( [ eq12 ] ) : @xmath222 equations  ( [ eq15 ] ) and  ( [ eq16 ] ) are equivalent to the expressions , eqs .",
    "( [ eq11 ] ) and  ( [ eq13 ] ) ."
  ],
  "abstract_text": [
    "<S> message passing equations yield a sharp percolation transition in finite graphs , as an artefact of the locally treelike approximation . for an arbitrary finite , connected , undirected graph </S>",
    "<S> we construct an infinite tree having the same local structural properties as this finite graph , when observed by a non - backtracking walker . formally excluding the boundary , </S>",
    "<S> this infinite tree is a generalization of the bethe lattice . </S>",
    "<S> we indicate an infinite , locally treelike , random network whose local structure is exactly given by this infinite tree . </S>",
    "<S> message passing equations for various cooperative models on this construction are the same as for the original finite graph , but here they provide the exact solutions of the corresponding cooperative problems . </S>",
    "<S> these solutions are good approximations to observables for the models on the original graph when it is sufficiently large and not strongly correlated . </S>",
    "<S> we show how to express these solutions in the critical region in terms of the principal eigenvector components of the non - backtracking matrix . as representative examples </S>",
    "<S> we formulate the problems of the random and optimal destruction of a connected graph in terms of our construction , the non - backtracking expansion . </S>",
    "<S> we analyze the limitations and the accuracy of the message passing algorithms for different classes of networks and compare the complexity of the message passing calculations to direct numerical simulations . </S>",
    "<S> notably , in a range of important cases , simulations turn out to be more efficient computationally than the message passing . </S>"
  ]
}