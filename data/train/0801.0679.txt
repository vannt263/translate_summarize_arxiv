{
  "article_text": [
    "peg solitaire ( also called hi - q ) is a very simple board game that appeared in europe most probably at the end of the 17th century .",
    "its prior origin is unknown .",
    "the first evidence is a painting by claude - auguste berey of anne chabot de rohan ( 1663 - 1709 ) playing it .",
    "it seems to have then become popular in some royal courts .",
    "the mathematical study of the game starts in 1710 when leibniz writes a memoir on the subject  @xcite .",
    "we refer the reader to the excellent historical account presented in beasley s book  @xcite .",
    "let us introduce rapidly how this game is being played .",
    "the first data is a board @xmath0 which in first approximation may be thought of as a subset of @xmath1 .",
    "the classical ones are the english board and the french one drawn below , and we present a third one introduced by j.c .",
    "wiegleb in  1779 ( see @xcite ) .",
    "each square of this board can hold at most one peg , and a _ problem _ as we define it here is to go from a given distribution of these pegs ( say @xmath2 ) to another one ( say @xmath3 ) , via a succession of _ legal moves _ that we now define .",
    "given three consecutive squares @xmath4 , @xmath5 and @xmath6 in a row or a column ( but _ not _ on a diagonal ) , of which two consecutive ( say @xmath4 and @xmath5 ) contain a peg while the third one ( @xmath6 ) does not , a _ legal move _ consists in removing the two pegs in @xmath4 and @xmath5 and putting one on the empty square @xmath6 .",
    "we classically say that the closest peg in @xmath4 jumps over the middle one in @xmath5 and lands in @xmath6 , while destroying the peg in @xmath5 . as a trivial consequence ,",
    "the number of pegs on the board decreases when the game proceeds further . for most authors ,",
    "a problem consists in reducing the initial distribution of pegs , what we call thereafter the _ initial position _ , to a single peg via legal moves .",
    "they qualify the position as _ solvable _ if this is possible .",
    "we shall say that the problem in our sense is _ feasible _ if one can go from the initial position to the final one by using legal moves .",
    "note that the number of such moves is known and equals the difference between the number of pegs in the initial position and the number of pegs in the final one ( that is : @xmath7 ) .    given a problem ,",
    "we can try all possible legal moves and repeat this action until the required number ( @xmath7 ) of moves is reached or no further move is possible .",
    "this process usually gets stuck because of the combinatorial explosion .",
    "for instance e. harang @xcite computed that there are @xmath8 paths on the english board from the initial position consisting of the full board on which we leave the central square empty .",
    "of which @xmath9 lead to the final peg being on the central square .",
    "see also @xcite .",
    "in fact , numerous setting tend to show that the problem is np - complete .",
    "for this sentence to have a sense , we are to choose a way of extending the board to infinity , and there is no canonical fashion to achieve that .",
    "the case of an @xmath10 board is studied in @xcite while the @xmath11 board with @xmath12 fixed is shown to be linear in @xcite . of course",
    ", one may wonder whether the english board as a subset of a @xmath13 board is tractable or not and the answer is still no , at least not without huge resources . the number of paths being enormous , we look for tests that will ensure us that it is not possible to solve a given problem .",
    "we would welcome any test that would guarantee the feasibility , but none are yet known .",
    "the first of this test is attributed to reiss in  1857 in @xcite though beasley traces it back to a. suremain de missery , a former officer of the french artillery , around  1842 .",
    "we again refer the reader to  @xcite for more historical details .",
    "it is also described in lucas book @xcite , which contains also more material and in the dedicated chapter of  @xcite .",
    "a seemingly more algebraic approach is proposed in  @xcite , but it turns out to be only a different setting for the same test .",
    "this test is very often reduced by modern authors to the rule - of - three test ( see below ) .",
    "we shall first present these tests in a formalism that will help us clarify the situation ; this formalism will also be adequate to present the advances realised on the subject in 1961/1962 at cambridge university by a group of students ( among which were beasley ) led by j.h",
    ".  conway .",
    "we shall finally present a different test , which we term quadratic , and which is stronger than all previous ones .",
    "it however relies on solving a larger integer linear program and can sometime be resource demanding .",
    "we provide however numerous examples that we have discovered by exploring thousands of problems , and this in itself shows the practicality of the approach .",
    "the theory of this test in its purest form is complete , but we provide in the two last sections several improvements of it , on which we are still working .",
    "all examples have been computed via an intensive use of the lp_solve library  @xcite , a gtk interface and a c - program both due to the author .",
    "let us end this introduction by mentioning that beasley also introduced a very geometrical tool ( the _ in and out theorems _ ) , but it does not fit well in our framework and has not been worked out for an arbitrary problem ( to the best of my knowledge at least ) , even if one remains on an english board .",
    "we shall not discuss it here .",
    "in more recent time , there has been attempts at working out a model of this game via string rewriting as in  @xcite .",
    "this approach remains however fundamentally one dimensional as are string rewriting rules .",
    "it has had applications though in describing the complexity of the game .",
    "given a board @xmath0 , we consider the @xmath14-module @xmath15 of all rational integer valued functions over this board , and define similarly @xmath16 and @xmath17 .",
    "this is one of the main step of the formalization : a position in the game is given by a subset @xmath18 ( the set of squares containing a peg ) , which we model by its characteristic function @xmath19 . if @xmath20 , we note @xmath21 the function that is 1 in @xmath4 and 0 everywhere else .",
    "a move is thus the function @xmath22 and @xmath23 should become another characteristic function ; we have of course assumed that @xmath4 , @xmath5 and @xmath6 where three consecutive points in this order either in a row or in a column of @xmath0 .",
    "we denote the set of these moves by @xmath24 . in the case of the english board",
    ", @xmath24 has cardinality  76 , while @xmath0 has cardinality  33 .",
    "here comes the main remark .",
    "assume we can go from @xmath2 to @xmath3 by the succession of legal moves @xmath25 .",
    "then we have @xmath26 there are three ways to exploit this writing .",
    "we can say that    * @xmath27 is a rational integer linear combination of members of @xmath24 .",
    "this leads to the classical reiss s theory , or to the lattice criterion of  @xcite .",
    "* @xmath27 is a linear combination with non - negative rational coefficients of members of @xmath24 .",
    "this leads to the main part of conway s group theory .",
    "* @xmath27 is a linear combination with non - negative integer coefficients of members of @xmath24 .",
    "this leads to what we call the _ full linear test _ , or also the non - negative integer test .",
    "we introduce some notations @xmath28 and @xmath29",
    "let us first expose rapidly and in modern notations the classical material .",
    "characteristic functions having values  0 or  1 , it is tempting to look at @xmath19 as taking its values in the field with two elements @xmath30 . to avoid confusion",
    ", we note @xmath31 this characteristic function as an element of @xmath16 .",
    "if one can go from the initial position @xmath2 to the final one @xmath3 by the succession of legal moves @xmath25 , one still has @xmath32 where @xmath33 are of course the moves seen with values in @xmath34 .",
    "if @xmath22 , then @xmath35 is the function over @xmath0 that takes the value @xmath36 at all the three points @xmath4 , @xmath5 and @xmath6 , and vanishes otherwise .",
    "however , @xmath34 is now a field and @xmath37 is simply a vector space ! deciding whether @xmath38 belongs to it is a simple matter requiring only linear algebra .",
    "let us investigate this problem further .",
    "one way to characterize @xmath37 as a subspace of @xmath16 is to compute equations of it . by using the canonical scalar product ,",
    "this reduces to computing @xmath39 which means the elements @xmath40 such that @xmath41 since any such @xmath42 verifies @xmath43 we need a name for such elements of @xmath39 , and we propose the name _",
    "witness_. let us start to do so on the english board .",
    "let us determine a function @xmath44 .",
    "we first fix four values on a square , for instance    by using , we can readily extend these values :    as it turns out , there are two ways to compute @xmath45 : either by adding the two values on the column above its square or the two on the line containing it .",
    "the result is here the same @xmath46 .",
    "we can use this process to compute the values of @xmath44 on the full board .",
    "what is the dimension of @xmath37 in this case ?",
    "the values on the initial square determine the values everywhere as we have just now remarked , and there is thus 16 witnesses . but",
    "these values are not linearly independant and there are linearly generated by the four    we can even use this process to extend the values to @xmath1 .",
    "this yields    now that the reader ses the regularity of this tiling , s.he will be convinced that they can be extended to @xmath1 .",
    "the way one drops the english board on it yields for instance this witness :    and once , the witnesses are determined , equations defining @xmath37 are obtained by taking the scalar product with ( a basis ) of them .",
    "a classical problem is to determine whether it is possible to start with the french board filled with pegs , except for the central square that is left empty and to end with only one peg .",
    "this can be shown to be impossible by using the theory above , but we leave this pleasure to the reader .",
    "this theory of witnesses is essentially what is called reiss s theory  @xcite , though it is expressed with other words , and is present in lucas s book  @xcite .",
    "we say `` essentially '' because they do not use any linear algebra and that their way to reach this result is by using direct move together with reversed ones ( to undo a move ) .",
    "they obtain what they call characteristic positions , which is equivalent to the equations defining @xmath37 .",
    "this is however what is presented  @xcite .",
    "there are still a distinction to be made :    1 .",
    "one can start from witnesses of @xmath1 , restrict them to @xmath0 and get witnesses for this board .",
    "this is called the rule - of - three .",
    "of course , we get only a four independant equations that may not define @xmath37 fully .",
    "if the board is thick enough , for instance when there exists a defining square from which all the other values of the witnesses can be deduced , this is enough .",
    "2 .   one can start from @xmath37 and directly compute a basis of witnesses .",
    "this is required when the board is weakly connected ( or even not connected ! ) and @xmath39 has dimension larger than  4 .",
    "several examples like that are given in  @xcite .",
    "thinking bach in terms of @xmath47 , the lattice criterion of @xcite is to say that @xmath27 should belong to @xmath47 . how is this test connected with the previous one ? or , alternatively : we decided to reduce the problem modulo  2 ; why not try to do so modulo  3 ?",
    "let us first note that we may identify @xmath16 with @xmath48 via @xmath49{rcl }        { \\mathfrak{s}}&\\rightarrow&\\mathbb{f}_2\\\\        p&\\mapsto&g(p)\\mod 2      \\end{array }    \\end{array}\\ ] ] during this process , @xmath47 is of course sent on @xmath37 .",
    "let us state formally two questions we want to answer :    1 .",
    "is @xmath47 a lattice of full rank in @xmath15 ?",
    "2 .   how to compute @xmath50 ?    in the sequel , we introduce a hypothesis on the geometry of the board @xmath0 that will enables us to answer fully these questions .",
    "it will turn out that this will also exhibit the very tight link between the integer linear test and the theory of witnesses , as exposed in the previous section .",
    "if the two points @xmath4 and @xmath6 of @xmath0 are extremities of a member of @xmath24 , we say that @xmath4 and @xmath6 are _ neighbors _ and we note @xmath51 .",
    "the reflexive and transitive closure of this relation is an equivalence relation , and if two points @xmath52 and @xmath53 are equivalent according to it , we note @xmath54",
    ". we can now state an important definition :    a board @xmath0 is said to be _ with no isolated point _ if for every point @xmath4 of @xmath0 , there exists a point @xmath55 and which is the middle point of a move .",
    "most boards will verify this hypothesis .",
    "it means that each @xmath56-equivalence class contains a middle point .",
    "however the number of such classes may vary . for a sufficiently thick board",
    ", there will be exactly 4  classes , but there may be more , if the board is not connected for instance , or contains thick chambers very weakly connected by only one square .",
    "the reader will easily construct examples of boards with no isolated point but were the number of classes is larger than  4 .",
    "the following theorem is central in our discussion :    [ th1 ] if @xmath0 is with no isolated point , then @xmath57 .    a final notation before sketching the proof : if @xmath58 , we note @xmath59 the reversed move ( with equal middle point ) .",
    "we show that for every @xmath20 , we have @xmath60 . if @xmath4 is a middle point , say of the move @xmath61 , then @xmath62 belongs to @xmath47 .",
    "otherwise , there exists a chain @xmath63 where @xmath64 is a middle point .",
    "furthermore , by definition , there exists @xmath65 such that @xmath66 for every @xmath67 . finally ,",
    "we can also write @xmath68 for some @xmath69 . summing up all these equations , we reach @xmath70 which is the required conclusion since @xmath71 .",
    "this theorem has several consequences .",
    "first of all , on such boards , the @xmath72-vector spanned by the @xmath61 s ( that would be @xmath73 ) is the whole space : @xmath47 is a sublattice of @xmath15 of full rank .",
    "let us note the following lemma that will be required later :    [ count ] if @xmath0 has no isolated points , we have @xmath74 .",
    "the lower bound comes from the fact that @xmath24 generates @xmath17 . for the upper bound , count horizontal and vertical moves separately . for the horizontal ( resp .",
    "vertical ) ones , count the moves according to their left - hand side ( resp .",
    "lower ) point .",
    "the lemma follows readily .    as a main consequence",
    ", we have the following theorem .    [ struct ]",
    "assume @xmath0 to be with no isolated point and let @xmath75 .",
    "then @xmath76 ( see for the definition of @xmath77 ) .",
    "indeed , the direct implication is obvious , while the reversed one follows from theorem  [ th1 ] : we know that @xmath78 but this last space is nothing but @xmath47 .",
    "this theorem tells us that the lattice criterion is _ not _ stronger than reiss s theory , when properly understood , and provided we restrict our attention to non - pathological boards .",
    "in fact @xcite do not even give a single example when reduction modulo",
    "2 does not solve the problem . here",
    "is one :    the total number of pegs on the squares @xmath52 , @xmath53 , @xmath79 and @xmath80 remains constant .",
    "it is not difficult to see that this example is in fact general and we have :    [ restruct ] a board @xmath0 is with no isolated point if and only if @xmath47 has maximal rank in @xmath15 .",
    "on boards with no isolated points , reducing the situation modulo any odd integer is not going to give any information ; indeed theorem  [ struct ] implies ( after some work ) that @xmath81 notice finally that @xmath50 is simply a product of copies of @xmath82 in this case .",
    "it is not difficult to tackle the case with isolated points by generalising the reasoning used for the board drawn figure  [ patho ] , and get that @xmath50 is always a product of copies of @xmath82 with copies of @xmath14 .",
    "these results have no influence on what we develop hereafter , so we do not provide any formal proof .",
    "the next main step takes place in 1961/1962 at cambridge university when j.h .",
    "conway led a group of students ( among which were beasley ) that studied this game .",
    "they came out with another and different test , also clearly explained in  @xcite and that we now describe .",
    "this test exploits the fact that   has non - negative coefficients , i.e. the test consists in writing that , if we can go from @xmath2 to @xmath3 with legal moves , then @xmath83 as it turns out , @xmath84 is a cone in a vector space , and determining whether a point belongs to it or not is fast .",
    "we know generators of this cone ( the elements of @xmath24 ; they can be shown to be generator of its extreme half - lines ) , and it would be interesting to determine equations for its facets .",
    "the paper  @xcite gives properties of these facets . in  @xcite as well as in  @xcite , so called _ resource counts _ or _ pagoda functions _ are introduced . these are functions @xmath85 on @xmath0 such that @xmath86 as a consequence , for any such function and if @xmath87 belongs to @xmath84 , one has @xmath88 in particular , if one can derive @xmath3 from @xmath2 with legal moves , then @xmath89 is not less than @xmath90 . here are some examples    determining which of these corresponds to equations of facets would be very valuable , but their structure seems too intricate to classify them in a small number of regular families .",
    "for instance , a direct computation in case of the english board stumbles on the fact that there are an enormous quantity of such facets for a human eye to be able to look at them and derive some patterns .",
    "it is not sure that this path is blocked , though i tend to believe it is .",
    "we do not dwell any further in this part of the theory since it is extremely well exposed and detailed in  @xcite ,  @xcite and on a number of web pages",
    ". the reader will most probably better unterstand the strength of this theory by looking at section  [ thickness ] of this paper .",
    "we should stress out here that the approach of this cambridge group is commonly reduced to the use of real - valued `` pagoda '' functions as above .",
    "this is an extremely minimal understanding of their work and for instance does not account for the gnp balance sheet , what beasley in  @xcite calls conway s balance sheet in his chapter  6 ; this one is however one of the main tool of  @xcite .",
    "it mixes _ integer valued _ pagoda functions together with such functions with values in @xmath34 .",
    "beasley s use of pagoda functions which he calls ressource counts ( see chapter  5 of  @xcite ) relies already on the integer character of the values taken : that is how he builds his `` move map '' .",
    "the gnp diagram , or gnp balance sheet , is somewhat off our framework , and is in fact superseded by the next test .",
    "the third test consists in combining both preceding ideas and write that if we can go from @xmath2 to @xmath3 with legal moves , then @xmath91 this time , deciding that an element belongs to the integer points of a cone is np - hard , but in practice , it takes only some fraction of a second on an english board ( this was not the case in 1962 ! ) .",
    "we have of course @xmath92 and this inclusion is strict , even when one restricts our attention to differences of characteristic functions .",
    "for instance this test shows that one can not go from the position of figure  [ ce11 ] to only the central peg while the rational and integer linear tests are passed .",
    "this example is interesting in showing the impact of the board , for it is feasible in legal moves if we add to the english board the grey square on the upper right side .",
    "we present a smaller counterexample in figures  [ ce9 ] and  [ ce10 ] that enables easier direct computations .",
    "when @xmath87 belongs to this intersection ( i.e. the right - hand side of  ) the denominators in a non - negative writing do not seem to be any worse than @xmath93 . here is the conjecture we make :    if @xmath0 has no isolated points , then @xmath94    here is another related conjecture that may be easier to handle ( and maybe easier to disprove ! ) .",
    "let @xmath95 be a basis of @xmath73 .",
    "if @xmath0 has no isolated points , then @xmath96    the condition on @xmath0 can not be removed since it is equivalent to @xmath47 being of full rank .    at this point , we have described the situation and we hope the reader is now able to understand properly what is what .",
    "the theory so far has two drawbacks : it draws only on properties of @xmath27 , and it does not use the order in which the moves are played .",
    "our next criteria , the simple quadratic test , will not go beyond this abelian nature , but will break the first hurdle . it is better to investigate the game a bit further before exposing it .",
    "the cone @xmath97 is determined by the set @xmath24 of generators .",
    "let us introduce the notation @xmath98 for the function over @xmath24 that is 1 in @xmath61 and 0 everywhere else .",
    "we consider the map @xmath99      & \\displaystyle f=\\sum_{{{\\mathfrak{f}}}\\in{\\mathscr{d}}({\\mathfrak{s}})}x({{\\mathfrak{f}}})\\,{\\check{{{\\mathfrak{f } } } } }      & \\mapsto & \\displaystyle\\sum_{{{\\mathfrak{f}}}\\in{\\mathscr{d}}({\\mathfrak{s}})}x({{\\mathfrak{f}}})\\,{{\\mathfrak{f}}}.    \\end{array}\\ ] ] the integer linear program we write is simply to minimize any linear form of the @xmath100 subject to the constraints @xmath101 the linear form we choose is usually @xmath102 since we know what should be its value if a solution exists .",
    "given a problem , say from @xmath2 to @xmath3 , we define the _ thickness _ of the move @xmath61 to be the maximum number of times this move can be used , whatever sequence of legal moves @xmath25 we choose .",
    "this thickness is zero allover if the problem is not feasible . in general ,",
    "given @xmath103 , we shall speak of the _ thickness of @xmath61 at @xmath104_. computing this quantity is naturally difficult , but we can bound it from above and even provide a uniform bound for it .",
    "the main theorem reads as follows    let @xmath103 , @xmath105 and @xmath85 be a resource count on @xmath0 such that @xmath106 .",
    "the move @xmath107 can appear at most @xmath108 in any writing of @xmath104 as a linear combination of elements of @xmath24 with non - negative integer coefficients .",
    "the scalar product @xmath108 is defined in .",
    "we can derive absolute bounds from this theorem by using a variant of a resource count already used by conway .",
    "first note that we are interested only in the case @xmath109 which implies that @xmath110 for all @xmath111 .",
    "now let @xmath112 be a solution of @xmath113 .",
    "to each point @xmath114 , we associate the weight @xmath115 .",
    "next , we drop our board @xmath0 on @xmath1 in such a way that the middle point of @xmath107 be the @xmath116 element",
    ". the reader will check that the restriction of @xmath85 to @xmath0 is a resource count on @xmath0 which we denote again by @xmath85 .",
    "we have @xmath117 , while @xmath118 this short argument show that the thickness of any move on any board is bounded above by @xmath119 .",
    "this is most probably a way too large majorant ( reaching a thickness of @xmath120 is already extremely difficult , and it can be shown on using better resource counts that the maximal thickness on the english board is at most  @xmath121 ) , but it is _ universal _ , i.e. independant of the board we choose .",
    "a similar argument is also the main ingredient of  @xcite ( see theorem  3.1 therein , with most probably a wrong computation at the end .",
    "the  26 of this result is to be replaced by a  34 but this leaves the rest of the argument intact ) , and is the basis on which rely the low complexity results .    given a problem , we can refine this upper bound by selecting a more appropriate resource count .",
    "furthermore , once a majorant is given , say @xmath122 , we can check whether @xmath123 is feasible or not ( this means , whether it passes whichever test we select ) .",
    "if not , we decrement @xmath122 and repeat the process .",
    "let us consider the two following problems : we are to go from the left hand side position with only the black pegs ( or with the grey peg added ) to the right hand side one with a sole black peg ( or with the grey peg added ) .",
    "both problems pass the positive integer test .",
    "the reader will easily check that the larger problem ( with the grey peg ) is in fact doable in _ legal moves _ , which implies that _ no _ test relying only on @xmath27 would be able to show the first problem to be impossible .",
    "the quadratic test we propose now is however able to show this impossibility .",
    "let us start our description of the quadratic test .",
    "to each couple @xmath124 , we associate a symbol @xmath125 , to which we add the property @xmath126 we set @xmath127 we next consider functions on @xmath128 .",
    "we denote by @xmath129 the function that is 1 on @xmath125 and 0 everywhere else . note that @xmath130 .",
    "we go from @xmath131 to @xmath132 by @xmath133 notice that the value of @xmath134 on @xmath129 is @xmath135 if @xmath136 and @xmath137 if @xmath138 .",
    "assume now that we can go from @xmath2 to @xmath3 by the legal move @xmath139 .",
    "we have @xmath140 on using the identity @xmath141 , we reach @xmath142 we note that @xmath143 from which we infer @xmath144 this is the equation we want to exploit ; we do so in pretty much the same way we exploited  .",
    "we set @xmath145 note that if @xmath22 then @xmath146 we define our cone by @xmath147 a problem being given by an initial position @xmath2 and a final one @xmath3 , the _ simple quadratic test _",
    "consists is saying that @xmath148 , which can again be solved with integer linear programming .",
    "however the spaces are much larger , and the resolution becomes more troublesome .",
    "note the following lemma :    @xmath149    indeed , there are @xmath150 moves of type @xmath151 , and , for each @xmath139 , there are @xmath152 moves of type @xmath153 with @xmath154 .",
    "for the english board , the cardinality of @xmath155 is thus @xmath156 for a board of 561 squares .",
    "we have already given an example showing that this test is sometimes better than the linear test with non - negative integer coefficients but we show now that this is always the case .",
    "to do so , let us define @xmath157 then we can easily identify @xmath158 with the space of integer valued functions on @xmath159 , which we can in turn identify with @xmath0 . by these identifications ,",
    "we start with a function @xmath160 , build @xmath161 and is next send to @xmath104 . in particular",
    ", we get @xmath162 the fact that this test is in fact strictly superior on some boards in shown by the problem described by figures  [ cvvd1 ] and  [ cvvf1 ] .",
    "if the simple quadratic test is stronger than the linear one with positive integers , it turns out when used to be lacking in efficiency . the last term in",
    "can be written as @xmath163 where @xmath164 avoids the support of @xmath61 .",
    "this is much better than saying that it is a linear combination of @xmath153 , but it leads to @xmath165 generators ! this is of course way too much and makes this new set of generators impractical .",
    "however , if @xmath166 is a succession of legal moves from @xmath2 to @xmath3 , we can write @xmath167 and we readily see that on this writing that the following inequalities are satisfied @xmath168 we call them the _",
    "flatness constraints_. despite their number , these constraints renders the quadratic test much more efficient .",
    "in fact , the @xmath169 are related to the usual linear moves by @xmath170 ( see the process that enabled us to prove  ) and as such can be controlled in size by the thickness of @xmath61 at @xmath27 , as defined in section  [ thickness ] .    on an english board , the @xmath169 s are seldomly larger than @xmath120 , and on arbitrary board they are anyway bounded .",
    "notice that if @xmath171 passes this test , then actually , it can be written as a linear combination with non - negative integer coefficients of @xmath153 with @xmath154 and diagonal moves @xmath151 .",
    "to realize such a writing , given @xmath61 , simply collect together all @xmath52 s for which @xmath172 has a given value into a set @xmath173 .",
    "note that these sets @xmath173 are _ not _ the same as the sets @xmath174 we used at the very beginning of this section , but are of same use .",
    "the problem described by figures  [ ex7 ] and  [ ex8 ] goes through the quadratic test with no flatness constraints , but is shown impossible as soon as we add these constraints  :    this new test is the main novelty of this paper and is extremely efficient in practice , though it requires a processor to carry out the required computations .",
    "we end this part with three further examples of problems shown to be impossible via the quadratic test with flatness constraints . here",
    "are two problems , with a same starting position but different ending positions .",
    "none of them go through the quadratic test with flatness constraints :    the third example is to go from the initial position to the intermediate ending position .",
    "this is shown to be impossible via the quadratic test with flatness constraints , though it again passes the simple quadratic test .",
    "moreover , the problem to go from the initial position to the final ending position is feasible in legal moves .",
    "now that we have seen that the quadratic test with flatness constraints is so very efficient , it is tempting to try to add some further constraints . this is the topic of these two last sections , but this part is still very much in progress .",
    "the reader may get the impression that it is not so much in progress than more bluntly unfinished .",
    "after some months of efforts , i have not been able to derive a unifying setup for what look like protrusions of a hidden structure , which is why i deliver them in tnhis state .",
    "the idea we follow is to add geometrical information to control as much as possible these new variables @xmath175 in .",
    "let us start with a fundamental inequality .",
    "assume we can go from @xmath2 to @xmath3 in legal moves .",
    "then there exists a writing of @xmath171 ( as in  ) such that for every @xmath111 we have @xmath176    see   and for refinements .",
    "let @xmath166 be a succession of legal moves from @xmath2 to @xmath3 .",
    "we set @xmath177 where the @xmath172 s and the @xmath169 s come from .    given a move @xmath61 ,",
    "let us look at the situation of the board before using this move .",
    "there are four possibilities for @xmath52 :    * @xmath178 , which means that @xmath52 is on the board and participates to the move .",
    "it is counted in @xmath169 and nowhere else .",
    "* @xmath52 is not on the board but is created by the move .",
    "it is counted in @xmath169 and nowhere else .",
    "* @xmath52 is on the board but does not participate to the move .",
    "it is counted in @xmath175 and nowhere else .",
    "* @xmath52 is not on the board and not created by the move .",
    "it is not counted anywhere .",
    "the proof follows by using this remark and an induction on @xmath7 .",
    "we have equality if and only if the last case above never occurs , which means that @xmath52 is never absent from the position for two consecutive moves .",
    "we have seen that we can have equality in  , but we can even show that the right hand side is on average of the correct order of magnitude .",
    "indeed we have @xmath179 since there are @xmath180 points on the first move that are on the board but do not participate to the move , then @xmath181 , and so on . as a consequence @xmath182",
    "this shows that   prevents too wide deviations from the mean , at least if @xmath183 and @xmath184 are of comparable size .",
    "we propose to improve on this double inequality in three ways .",
    "we define the _ depth _ of the point  @xmath52 with respect to the position @xmath185 containing it to be the minimum number @xmath186 of legal moves required to remove the peg in  @xmath52 . if @xmath52 is not in @xmath185 , we set @xmath187 .",
    "let us recall a classical lemma .",
    "[ leibniz ] if the sequence of legal moves @xmath188 goes from @xmath2 to @xmath3 , then the sequence of legal moves @xmath189 goes from @xmath190 to @xmath191 .",
    "it is enough to verify this property when @xmath192 where it is obvious .",
    "leibniz expressed this idea in a different manner : he started from the final position @xmath3 and tried to recover the initial one by playing in reverse ; he discovered it was the same game , provided one considered the empty squares as having a peg , and the ones with a peg as being empty .",
    "this is exactly what we shall consider .",
    "indeed , given a point @xmath52 out of our final position  @xmath3 , there is a minimal number a moves that will `` bring '' its peg inside @xmath3 , or kill it , namely @xmath193 .",
    "let us select a minimal path from @xmath3 to @xmath52 .",
    "its last move puts a peg in @xmath52 , i.e. has @xmath52 as point @xmath6 since we could otherwise shorten this path",
    ". moreover it does not use @xmath52 anymore as point @xmath4 or @xmath5 since we could again shorten the path .",
    "consequently , for any @xmath194 @xmath195 if @xmath52 is in @xmath3 , we have @xmath196 so that   is stronger .",
    "indeed @xmath52 not in @xmath3 implies @xmath197 .",
    "the @xmath198 last moves can not use @xmath52 in any part of a move , hence we can use   with @xmath199 points as a final position instead of @xmath3 if @xmath52 is at some point of time on the board .",
    "else , it is never here and the upper bound 0 is fine .",
    "we do not know of any precise mean of computing this depth , but we provide now a fast way to get an excellent lower bound .",
    "let us consider the oriented graph @xmath200 built on the set @xmath0 and where we put an edge from @xmath52 to @xmath53 if there exists @xmath139 such that @xmath178 and @xmath201 .",
    "a minimal path that realizes @xmath193 is readily transformed in a path from @xmath52 to @xmath3 on @xmath200 .",
    "reciproquely from such a path from @xmath52 to @xmath3 on this graph , we deduce a position @xmath174 by adding the required points @xmath4 and @xmath5 necessary for the @xmath61 s .",
    "the only problem is that this process may require to put several pegs on a same square ( we do not have any example of such a situation ) . denoting by @xmath202 the distance on this graph , we have established",
    "that @xmath203 note that a final position @xmath204 in case of @xmath205 is reduced to a single point . the distance @xmath206 is now readily computed , by using the dijkstra s algorithm for instance .",
    "practically , to find a minorant of this depth , we proceed in two steps ( with @xmath207 ) :    * we try every succession of 5 legal moves from @xmath185 . * concerning the remaining ones",
    ", we first build the set @xmath208 of points with @xmath209 .",
    "if @xmath210 , we find the minimum of @xmath211 for every @xmath212 ; this a first lower bound for @xmath186 , but sometimes the lower bound  6 is simply better .",
    "let us now examine the somewhat reciproqual situation , and try to get the minimum of legal moves from the set @xmath2 that puts a peg in @xmath52 .",
    "we need two pegs to create one , which means that the distance @xmath213 is not a good lower bound anymore .",
    "we define the _ height _ @xmath214 of a with respect to @xmath2 to be his minimal number , and set @xmath215 if @xmath52 can never be reached . computing",
    "this @xmath214 is very difficult .",
    "[ horsconvexe ] let @xmath2 be a subset of @xmath0 and @xmath52 be such that @xmath216 . for any non - negative resource count @xmath85",
    ", we have @xmath217 .",
    "indeed there is a set @xmath3 which contains @xmath52 and that is reachable from @xmath2 .",
    "we thus have @xmath218 which in turn is non less than @xmath219 by the non - negativity assumption on @xmath85 .    using lemma  [ horsconvexe ] and some direct computations",
    ", we get the following height - diagram for the left - hand side position .",
    "we next provide an example on which lemma  [ horsconvexe ] is not strong enough to decide whether some points have finite heights or not .",
    "this problem passes the linear integer test .",
    "we provide the height of each square ( we simply computed all position attainable in 5 moves  ! ) .",
    "the two squares on the left - hand side ( and the symmetric ones on the right - hand side ) are rather clearly not reachable , but the test deduced from lemma  [ horsconvexe ] fails to prove that .",
    "even worse , we found for each of this square a position got from the first one in 5 moves and for which this square is not shown to be unreachable by this test .    practically , to find a minorant of this height , we proceed in three steps :    * we try every succession of 5 legal moves .",
    "* we use the lemma  [ horsconvexe ] to determine those points that are guaranteed to have infinite height .",
    "( we apply this test to all of the derived positions ) . * concerning the remaining ones",
    ", we first build the set @xmath220 of points with @xmath221 .",
    "if @xmath222 , we find the minimum of @xmath223 for every @xmath224 ; this a first lower bound for @xmath214 , but sometimes the lower bound  6 is simply better .",
    "set @xmath225 we have @xmath226      we finally improve on the lower bound in  .",
    "the fact is that some points are so much within the starting position @xmath2 that the peg on them can not be eliminated before so many moves , and this is precisely how we defined @xmath227 .",
    "we have then @xmath228      we end this section with two remarks .",
    "first , both notions of depth and height use only one of the two positions of the problem , and this is a loss . for instance concerning height ,",
    "if we manage to put a peg in a very far away square that is also far from our final position , it is probable that we shall not be able to bring it back to it ; for instance , if the starting position is given by figure  [ ce3 ] , it is likely that we can not put a point in the lower left corner and finish as in figure  [ ce4 ] .",
    "secondly , constraints and only avoid extremal cases , as we noted earlier , and there are only @xmath229 of them for a problem with about @xmath230 variables ; in fact , if @xmath0 has no isolated point , lemma  [ count ] yields @xmath231 this explains why these constraints are somewhat weak .",
    "having in mind the counting argument displayed at the end of last section , we see that finding conditions on couples @xmath232 of points would not increase too much the size of the problem but may yield more stringent constraints .",
    "let us start with some general considerations .",
    "let @xmath233 be the minimum number of legal moves necessary to put a peg in each of @xmath52 and @xmath234 , starting from a board with pegs on all the points of @xmath2 .",
    "we assign it value @xmath235 if no such succession exists .",
    "note that the height - function does not behave like a distance , since we can have @xmath236 .",
    "we formulate a conjecture :            * @xmath52 is on the board and is not moved by @xmath61 . then @xmath234 is not on the board , and may not be created by @xmath61 .",
    "this move is counted in @xmath175 .",
    "* @xmath234 is on the board and is not moved by @xmath61 . then @xmath52 is not on the board , and may not be created by @xmath61 .",
    "this move is counted in @xmath240 .",
    "* @xmath52 is on the board and is moved by @xmath61 . then @xmath234 is not on the board and may be created .",
    "this move is counted in @xmath169 .",
    "* @xmath234 is on the board and is moved by @xmath61 . then @xmath52 is not on the board and may be created .",
    "this move is counted in @xmath169 .",
    "the question arises as to whether this lemma leads or not to improvements , and we provide an example below showing that it indeed does .",
    "the geometrical fact that we have used is that a square can either contain a peg , or be empty , a fairly trivial information that was until now absent from our discussion .",
    "this example is also interesting because of the square with an interrogation dot : it is `` clearly '' of infinite height , but our automatic process is not able to conclude .",
    "here is the list of couples with @xmath242 that we have found : @xmath244    lemma  [ addc ] is of course of fairly limited use : we need the starting position to leave free enough squares on the board .",
    "however , it shows how more geometrical arguments may be used to get improvements !",
    "our journey ends here .",
    "b.  ravikumar , peg - solitaire , string rewriting systems and finite automata , in : springer ( ed . ) , proc .",
    "algorithms and computation , vol .",
    "1350 of lecture notes in computer science , 1997 , pp . 233242 ."
  ],
  "abstract_text": [
    "<S> the main problem addressed here is to decide whether it is or not possible to go from a given position on a peg - solitaire board to another one . </S>",
    "<S> no non - trivial sufficient conditions are known , but tests have been devised to show it is not possible . we expose the way these tests work in a unified formalism and provide a new one which is strictly stronger than all previous ones . </S>"
  ]
}