{
  "article_text": [
    "bethe and naive mean field ( nmf ) are two of the most used variational methods , and can be considered special cases of the cluster variational method ( cvm )  @xcite . fast and provably",
    "convergent methods are known for the minimization of the cvm free energy  @xcite , and systematic expansion methods about minima have been shown  @xcite .",
    "generalizations and convex approximations to cvm have allowed for the development of fast and secure inference methods  @xcite .",
    "linear response ( lr ) is often applied to the variational framework to determine accurately pair correlation estimates  @xcite .    in studying graphical models",
    "one is often interested in the estimation of probability distributions over local variables , and pair correlations ; these can for example form the basis for decimation methods or moment matching algorithms  @xcite . in this paper",
    "we develop an extension of the standard method for estimating marginal probabilities and pair - correlations in cvm , such that the variational parameters ( beliefs ) are self - consistent with the lr estimates .",
    "our model improves over standard implementations on arbitrary graphs if couplings are weak . from the nmf framework we recover the adaptive - tap equations for pairwise spin models  @xcite . from the bethe approximation",
    ", we recover the sessak - monasson expression for correlation estimation from a variational framework  @xcite .",
    "we apply the method to the homogeneous triangular lattice model : bethe and nmf are known to perform poorly on this model due to the presence of short loops and frustration . for brevity",
    "we will focus only on binary variables ( spins ) , pairwise couplings and two simple cvm approximations ; but the principle is more general and might be combined with some of the aforementioned expansions and algorithmic methods .      consider a model defined over @xmath0 spin variables @xmath1 , interacting through a symmetric coupling matrix @xmath2 and with external fields",
    "we can write the hamilonian ( cost function ) ; @xmath4 @xmath5 are subsets , and @xmath6 defines the set of non - zero couplings , for the pairwise model @xmath7 .",
    "the exact free energy ( cumulant generating function ) of this model is @xmath8\\ ] ] @xmath9 $ ] is a sum over the states in the enclosed expression . from the free energy one",
    "can calculate quantities of interest such as the magnetizations and pair connected correlations by linear response .",
    "consider the connected correlation over a subset of variables @xmath5 , it would be calculated as @xmath10 f\\;.\\label{eq : linearresponse}\\ ] ] naturally the application of linear response is not restricted to the exact free energy , using an approximate free energy one obtains pseudo statistics . in either scenario",
    "one can construct the marginal ( pseudo ) probabilities , for example @xmath11 unfortunately the evaluation of the free energy is computationally intractable for many networks of interest , as such we can not construct the marginals ( [ eq : linearresponsemarginals ] ) by method ( [ eq : linearresponse ] ) without approximations to the free energy .",
    "the cvm provides such an approximation , based on a weighted sum of local entropy and energy contributions .",
    "the variational entropy and energy approximations are defined @xmath12 \\label{eq : entropycvm}\\;;\\\\      \\!e(b)\\ ! & = & \\!\\!-",
    "\\sum_{s \\in i } { \\mathrm{tr}}[j_s b_{s}(\\sigma_s ) \\prod_{i \\in s}\\sigma_i ] \\!-\\ !",
    "{ \\mathrm{tr}}[b_i(\\sigma_i)\\sigma_i]\\;;\\label{eq : energycvm}\\end{aligned}\\ ] ] @xmath13 are regions ( subsets of variables ) , @xmath14 are beliefs ( approximate marginal probabilities ) over the set of variables @xmath15 ( we henceforth omit the arguments @xmath16 for brevity ) , and @xmath17 are counting numbers .    the theory of junction trees provides a justification for the selection of regions and counting numbers  @xcite , if one selects regions according to a junction tree then one can recover the exact free energy by a constrained minimization @xmath18 subject to @xmath19 and constraints @xmath20\\ ; , \\qquad \\forall r \\;;\\label{eq : constraint}\\\\ 0&=&{\\mathrm{tr}}_{\\setminus \\sigma_{r ' } } [ b_r ] - b_{r'}\\ ; , \\qquad \\forall r',r : r'\\subset r\\;;\\nonumber\\end{aligned}\\ ] ] where @xmath21 is a trace over all variables excluding those listed in the subscript .",
    "the beliefs recovered for a correct region selection are exactly the marginal probabilities , and are consistent with those determined by linear response @xmath22 .",
    "the regions prescribed by a junction tree have a maximum size that depends on the graph width , if this topological property is small then cvm can be an efficient way to calculate the free energy .",
    "if the graph is uncorrelated ( @xmath23 ) then the nmf approximation is exact , with @xmath24 for single variable regions and @xmath25 for all other regions . for purposes of evaluating the energy ( [ eq : energycvm ] ) we take @xmath26 in nmf .",
    "if the graph is a tree ( or forest ) the bethe approximation is exact , with edge regions for every element in @xmath6 , in addition to all vertex regions . in the bethe case : @xmath27 ; @xmath28 ; and @xmath25 otherwise .",
    "unfortunately , junction trees are also impractical in general .",
    "typically the width of the graph is large , requiring large regions for an exact solution , so that the evaluation of the entropy ( [ eq : entropycvm ] ) is impractical .",
    "one is therefore interested in approximations ; fortunately nmf and bethe are found to be good , or asymptotically exact in many circumstances .",
    "given that we resort to these methods in cases where the method is not exact , how should one construct the marginal probabilities ?",
    "two options exist for the regions exploited in the approximation : one can use the maximum entropy estimate @xmath29 ; or one can use the linear response estimtate @xmath30 about the minima of @xmath31 . in general",
    "these estimates differ ; one measure of the quality of the variational approach is the amount of agreement between these values .",
    "this paper discusses a modification to @xmath31 that allows for exact agreement .",
    "let us parameterize the beliefs over single variables in a manner comparable to ( [ eq : linearresponsemarginals ] ) , using the set of magnetization ( @xmath32 ) , and in the case of bethe symmetric pair correlation parameters ( @xmath33 ) @xmath34 where @xmath35 for nmf . by this method the constraints ( [ eq : constraint ] )",
    "are made redundant and we have an unconstrained minimization problem , subject to a parameter range @xmath36 .",
    "we exclude the possibility of boundary values @xmath37 since to apply linear response we will assume a minima in which all parameters can fluctuate .    in this paper",
    "we consider the following modification to the entropy approximation : we introduce , in the case of nmf the constraint that the self - response and magnetization agree as per the exact free energy @xmath38 we can introduce a lagrange multiplier in the standard form to write the entropy approximation for nmf @xmath39 - \\sum_i \\lambda_i   \\left ( \\left(1 - c_i^2\\right ) - \\chi_{ii}\\right)/2\\;.\\ ] ]    within the bethe approximation agreement between @xmath40 requires the additional constraint @xmath41 the entropy approximation for bethe becomes @xmath42 - \\lambda_{ij }   \\left ( c_{ij } - \\chi_{ij}\\right)\\right\\rbrace\\;,\\ ] ] the entropies presented are a generalization of those discussed in  @xcite , where only the off - diagonal constraints were considered ( @xmath43 ) .",
    "a minima of the free energy requires that the derivatives with respect to the variational parameters are zero .",
    "the derivative with respect to @xmath32 is @xmath44 where @xmath45 for nmf , and for bethe @xmath46\\;.\\ ] ] for the bethe method we must also consider the derivative with respect to @xmath47 @xmath48 - j_{ij } + \\lambda_{ij } \\label{eq : dfdcij}\\;.\\ ] ]    note that both the entropic term @xmath49 and the leading order of @xmath50 , are reaction terms ( proportional to @xmath32 ) ; for fully connected models these reaction terms are well understood in the large system limit  @xcite .",
    "when @xmath51 is taken to be non - zero and fixed by linear response , we find that quite generally we recover the onsager reaction term , as later discussed .",
    "when the constraint ( [ eq : diagonalconstraint ] ) is not enforced @xmath52 , in applying the bethe approximation the onsager reaction term is recovered for the case of independent identically distributed couplings .    when considering variation of the free energy we will treat both @xmath53 and @xmath51 as fixed external parameters , the variation is restricted to @xmath54 .",
    "the hessian , with components @xmath55 is required to be positive definite at the minima .",
    "supposing @xmath56 describes the minimizing arguments for @xmath57 , in response to a small variation in the fields @xmath58 the new minima @xmath59 can be determined from the quadratic order expansion of the free energy @xmath60 for nmf ( @xmath61 ) or bethe ( @xmath62 ) ; this will be the basis for constructing the linear response identities .      in the case of nmf the components of the hessian are @xmath63 \\;.\\ ] ] the argmin for nmf is @xmath64_{iz } \\delta h_z\\;.\\ ] ] now , the linear response identity in the limit @xmath65 allows us to decompose @xmath66 as a sum of perturbations on individual fields at leading order @xmath67 as such @xmath68_{i , j } = [ ( \\phi^n - j)^{-1}]_{i , j}\\;.\\ ] ] we introduce notation @xmath69 to denote the entropic ( approximate ) part of @xmath70 , separated from the energetic ( exact ) part .",
    "this matrix gives us estimates for all pair correlations , as well as those within regions .",
    "the constraint ( [ eq : diagonalconstraint ] ) is @xmath71_{i , i } = \\frac{1}{1-c_i^2 } - \\lambda_i \\label{eq : diagonalidentitynmf}\\;.\\ ] ]    we have a closed set of equations for @xmath72 in ( [ eq : dfdci ] ) and ( [ eq : diagonalidentitynmf ] ) .",
    "interestingly these equations are exactly those that define the adaptive tap .",
    "it was shown by opper and winther that a solution to the above equations does indeed reproduce the onsager reaction term for correlated and uncorrelated distributions of @xmath2 ( and without prior knowledge of the statistics )  @xcite .      to describe the hessian at the bethe level variation of the pair correlation parameters",
    "must be considered @xmath73\\right\\rbrace \\nonumber \\;;\\\\",
    "\\!q^b_{ij , k}\\!\\ ! & = & \\!\\ !",
    "q^{(2,1)}_{ij , k } = c_{ij}\\left\\lbrace\\delta_{i , k } { \\mathrm{tr}}\\left[\\frac{b_{j}\\sigma_j}{8 b_{ij}}\\right ] + \\delta_{j , k}{\\mathrm{tr}}\\left [ \\frac{b_{i}\\sigma_i}{8 b_{ij}}\\right]\\right\\rbrace \\nonumber \\;;\\\\    \\!q^b_{ij , kl}\\!\\ ! & = & \\!\\ !",
    "q^{(2)}_{ij , ik } = c_{ij}\\delta_{ij , kl}{\\mathrm{tr}}\\left [ \\frac{1}{16 b_{ij}}\\right ] \\;.\\end{aligned}\\ ] ] if we break the vector @xmath66 into two parts , one describing single variable variation @xmath74 and one describing pairwise variation @xmath75 we can determine the minimizing arguments of ( [ eq : quadratic ] ) from @xmath76}^t \\delta c^2\\;.\\end{aligned}\\ ] ] eliminating @xmath77 we can proceed as for nmf @xmath78^t { [ q^{(2)}]}^{-1}q^{(2,1)}]^{-1 } = { [ \\phi^b - j ] } ^{-1 } \\;.\\end{aligned}\\ ] ]    calculating the off - diagonal component of @xmath79 where @xmath80 , we find @xmath71_{i , j } \\!=\\ !",
    "\\phi^b_{ij } - j_{ij } \\label{eq : sessakmonasson}\\;.\\ ] ] where the expressions for @xmath81 and @xmath82 are @xmath83 \\!-\\ ! \\frac{c_{ij}}{(1\\!-\\!c_i^2)(1\\!-\\!c_j^2)\\!-\\!c_{ij}^2}\\right],\\\\ \\!\\ !",
    "\\phi^b_{ii } \\!\\!\\!&=&\\!\\!\\!\\!\\ ! \\frac{1}{1 \\!-\\",
    "! c_i^2}\\!\\left[1 \\!+\\ !",
    "\\sum_{j ( \\neq i)}c_{ij}\\frac{c_{ij}^2}{(1 - c_i^2 ) ( 1 - c_j^2 ) - c_{ij}^2 } \\right].\\end{aligned}\\ ] ] applying the constrained method with ( [ eq : offdiagonalconstraint ] ) , we find that for @xmath81 in ( [ eq : sessakmonasson ] ) we recover the sessak - monasson expression for calculation of correlations  @xcite .",
    "when couplings @xmath84 ( and consequently @xmath47 ) are small in absolute value the solution to the free energy can be found as an expansion about the decoupled case . using the exact entropy terms @xmath85 and @xmath86 one can determine as expansions in @xmath87 the corresponding solutions @xmath88,@xmath89 and @xmath90 ( @xmath91 in the exact case ) .",
    "for @xmath23 bethe and nmf are exact .",
    "we can make an expansion of our expressions assuming @xmath59 and @xmath92 , with both @xmath66 and @xmath93 small .",
    "we linearize our equations , all terms are evaluated for the exact solution @xmath94 in the following expressions . from ( [ eq : dfdci ] ) @xmath95 for the bethe method we require , from ( [ eq : dfdcij ] ) , @xmath96 which in the constrained case ( [ eq : offdiagonalconstraint ] ) defines @xmath97 .",
    "since @xmath97 enters no other equations it does not influence the error on @xmath54 .",
    "we can expand @xmath98 about the exact result , distinguishing the on and off - diagonal terms @xmath99 the constraints ( [ eq : diagonalconstraint ] ) and ( [ eq : offdiagonalconstraint ] ) dictate respectively @xmath100_{ii } \\ ; ; \\qquad \\delta \\chi_{ij } = - [ \\chi { \\tilde \\phi}^x \\chi]_{ij}\\ ] ] where @xmath101 in the latter case , otherwise @xmath102 or @xmath103 if the respective constraints are not introduced .",
    "the errors in responses @xmath50 , as well as on and off - diagonal elements of @xmath98 are significant in determining the errors . at leading order ( @xmath104 ) in the weak coupling limit ( @xmath2 small ) @xmath105 where @xmath106 , @xmath107 and we define @xmath108 ; and @xmath109 for the nmf and bethe methods we define respectively @xmath110 in the bethe method where @xmath111 the error on @xmath47 is dominated by @xmath112 in ( [ eq : phinlinearized ] ) and ( [ eq : phiblinearized ] ) we demonstrate also the leading order diagram relevant for high temperature at @xmath113 and @xmath114 respectively .",
    "we calculate errors for both the weak coupling ( small @xmath2 ) and high temperature ( @xmath2 and @xmath3 are @xmath115 ) cases solving the linearized equations .",
    "we summarise the consequences for the error in @xmath32 , @xmath116 and @xmath47 according to constraints introduced ( left label in list ) . for nmf errors",
    "are    * from ( [ eq : linearizeddfdm ] ) and ( [ eq : cons1 ] ) @xmath117 is determined as @xmath118 .",
    "the response error @xmath119 is @xmath118 .",
    "* we find @xmath120 , removing the most significant source of error in @xmath117 , the error on the magnetization improves to @xmath121 , the error on @xmath119 remains limited to @xmath118 by the error ( [ eq : phinlinearized ] ) .",
    "for bethe errors are    * @xmath117 and @xmath119 are @xmath121 .",
    "* we find @xmath117 is improved to @xmath122 , @xmath119 remains @xmath121 .",
    "error sources ( [ eq : cons1 ] ) are improved , but ( [ eq : dc2 ] ) remains a significant constraint on accuracy of @xmath119 .",
    "* @xmath117 remains @xmath121 but @xmath119 is improved to @xmath123 .",
    "the errors on @xmath66 are made independent of ( [ eq : dc2 ] ) , but the error sources ( [ eq : cons1 ] ) are unimproved . *",
    "the combined effect is to remove the most significant sources of error , both @xmath117 and @xmath119 become @xmath122 .",
    "the remaining error on @xmath119 is limited at leading order only by ( [ eq : phiblinearized ] ) .    for bethe introducing the constraint ( [ eq : offdiagonalconstraint ] )",
    "always reduces the error on @xmath124 , which is @xmath125 in the standard method .",
    "the non - convex nature of the constraints we are introducing makes algorithm development a challenge , but we can solve in general these equations for weak - coupling , with a naive iterative scheme @xmath126 if applying the constraint ( [ eq : diagonalconstraint ] ) , we can simultaneously infer @xmath127 otherwise @xmath52 . applying constraint ( [ eq : offdiagonalconstraint ] ) , for the bethe method , @xmath128_{ij}\\;;\\qquad c_{ij}^{t+1}=\\chi_{ij}^{t}\\;.\\label{eq : iteratecijlr}\\ ] ] with @xmath129 fixed by ( [ eq : dfdcij ] ) ; otherwise @xmath130 and we fix @xmath131 : c^t_i , c^t_j \\ } \\;.\\label{eq : iteratecijmaxent}\\ ] ] to fix @xmath132 at fixed @xmath133 and @xmath134 is equivalent to fixing @xmath135 .    the instantaneous mean field is used to update the magnetization in ( [ eq : iteratemag ] ) , a linear expansion of ( [ eq : diagonalconstraint ] ) is used to determine ( [ eq : iteratelambdaondiag ] ) , a naive iteration matching successively the linear responses is used in ( [ eq : iteratecijlr ] ) . at large @xmath136 ( [ eq : iteratemag])-([eq : iteratecijlr ] ) can be unstable individually or in combination , damping and annealing can be effective strategies to arrive at a solution for strong coupling .",
    "the procedure ( [ eq : iteratecijmaxent ] ) is one of convex optimization and does nt contribute to instability .",
    "full correlations estimates on nearest neighbors based on linear response @xmath137 , compared to the exact result ( black think curve ) , and the parameters @xmath138 determined for a standadrd implentation of the bethe approximation ( thin red ) .",
    "curves are labeled in the legend according to the constraints introduced . for negative @xmath2",
    "the new methods perform admirably compared to standard implementations .",
    "all methods perform poorly in the vicinity of the phase transition , the paramagnetic solutions of the new methods can be stable even beyond the true critical point @xmath139 , though performance is poor . ,",
    "width=336 ]    we consider a simple model the triangular lattice model with uniform couplings @xmath140 and zero fields @xmath141 in the large system limit .",
    "this model is problematic for standard bethe and nmf for several reasons : it involves short loops not accounted for by the region selection ; there is a continuous symmetry breaking transition at @xmath142 with associated long range correlations  @xcite ; for @xmath143 there is frustration ; for @xmath143 there are kosterlitz - thouless transitions , but no symmetry breaking transitions  @xcite . for these reasons bethe and nmf estimates for @xmath14 or",
    "@xmath144 can be poor .",
    "the solution can be found for our new methods by fourier analysis .",
    "figure [ figure : energy ] presents a comparison of methods .",
    "we present only the solution found continuously from @xmath23 by the iterative method , and we do not present the symmetry breaking solutions at @xmath143 , where they exist .",
    "for @xmath145 the paramagnetic ( @xmath146 ) solutions are , for small @xmath136 , in close agreement with the exact result . amongst new methods all but the doubly constrained approximation ( bethe with ( [ eq : diagonalconstraint ] ) and ( [ eq : offdiagonalconstraint ] ) ) remain locally stable well beyond the true ferromagnetic transition point .",
    "the large @xmath2 paramagnetic solutions do have some problems : the correlation estimate @xmath147 $ ] becomes poor compared to the standard implementations that undergo symmetry breaking transitions ; negative entropy can be found ( when @xmath148 ) ; and finally the iterative method struggles to converge without strong damping .",
    "the doubly contrained method on the other hand has a hessian that becomes singular ( for the paramagnetic solution ) at @xmath149 , in advance of even the standard nmf instability @xmath150 ; with simple iterative methods we are unable to construct a magnetized solution .    for @xmath143 ,",
    "the frustrated regime , performance of the new methods is a clear improvement over standard implementations .",
    "we find a similar pattern of results with respect to other components of @xmath53 ( longer range correlations ) , and in testing lattices of finite size .",
    "an instability towards symmetry breaking on the tripartite sublattices causes the termination of the line bethe ( [ eq : diagonalconstraint ] ) for @xmath143 ; a similar instability affects the standard nmf implementation .",
    "the fundamental objects of the cluster variational methods are the beliefs , which are determined by maximum entropy .",
    "one would expect that these beliefs would be reproducible by linear response up to some small error , but for the standard method this is not true .",
    "the discrepancy provides information on global graph structure that we have exploited in the new approximation where max entropy and lr are made consistent . in this article",
    "we have required consistency with the quadratic order lr relations , which we expect are of greater importance than those of higher order .    as part of our method",
    "we recover the sessak - monasson equation for pair correlations  @xcite .",
    "furthermore , for the case of spins and working from the nmf framework we derive the adaptive - tap equations  @xcite .",
    "the arguments by which these well known equations were originally derived is very different from our own , offering a point of comparison . in our derivation",
    "we note that we arrive at these results using simple region selection rules in the cluster variational framework , without assuming weak correlations ; in the case of adaptive tap and sessak - monasson we can improve performance by moving to higher order region approximations  @xcite .",
    "our framework is also very flexible with respect to the nature of the hamiltonian ; the result is easily generalized to other pairwise models , or with small modifications to multi - body interactions .",
    "we can also hope that some of the powerful expansion and algorithmic methods mentioned in the introduction will be made compatible .",
    "application to the inverse problem are also promising , and relatively simple compared to standard implementations of the cvm method  @xcite ."
  ],
  "abstract_text": [
    "<S> approximating marginals of a graphical model is one of the fundamental problems in the theory of networks . in a recent paper </S>",
    "<S> a method was shown to construct a variational free energy such that the linear response estimates , and maximum entropy estimates ( for beliefs ) are in agreement , with implications for direct and inverse ising problems  @xcite . in this paper </S>",
    "<S> we demonstrate an extension of that method , incorporating new information from the response matrix , and we recover the adaptive - tap equations as the first order approximation  @xcite . </S>",
    "<S> the method is flexible with respect to applications of the cluster variational method , special cases of this method include naive mean field ( nmf ) and bethe . </S>",
    "<S> we demonstrate that the new framework improves estimation of marginals by orders of magnitude over standard implementations in the weak coupling limit . beyond the weakly coupled regime </S>",
    "<S> we show there is an improvement in a model where the nmf and bethe approximations are known to be poor for reasons of frustration and short loops . </S>"
  ]
}