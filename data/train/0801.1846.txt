{
  "article_text": [
    "in our modern world , the existence of various transportation means has strongly affected the way in which infectious diseases spread among humans . in fact , it has become unavoidable to take into account in the study of the geographical spread of epidemics the various long - range heterogeneous connections typical of modern transportation networks , this naturally gives rise to a very complicated evolution of epidemics characterized by heterogeneous outbreaks patterns @xcite , as recently documented at the world - wide level in the sars case ( http://www.who.int/csr/sars/en ) .",
    "such complex phenomenon can be tackled at different granularity levels , including very detailed agent - based simulations , complicated social and spatial structures , complex contact networks , etc .",
    "in particular , a very important class of models in modern epidemiology describes the propagation between different interconnected subpopulations with the help of the so - called metapopulation models . in these models ,",
    "the disease spreads inside each subpopulation ( often assumed homogeneously mixed ) and is transmitted between different subpopulations by a `` coupling '' depending on the model . in the case of human infectious diseases ,",
    "this coupling is caused by the movements of individuals and depends on the transportation means relevant at the spatial scale chosen for the description of the spread .    in the context of large scale spread",
    ", air - transportation represents a major channel of epidemic propagation , as pointed out in the modeling approach to global epidemic diffusion of rvachev and longini  @xcite and by similar studies on the behavior of specific outbreaks such as pandemic influenza , hiv or sars  @xcite . in this case",
    ", the relevant metapopulation model considers as subpopulations the inhabitants of the various world cities and the air travel of infectious individuals results in the spread of the disease from one city to another .",
    "taking into account the global airline transportation infrastructure in metapopulation models has recently become possible thanks to the availability and analysis of large scale databases @xcite , and to the always increasing computer capacities .",
    "the word wide airport network ( wan ) is described by a complex weighted graph , in which the airports are the vertices and the weighted links represent the presence of direct flight connections among them ( the weights corresponding to the number of available seats on each connection ) .",
    "this network , which consists of more than @xmath0 nodes and @xmath1 links , displays small - world properties as well as strongly heterogeneous topology and traffic properties . for many different dynamical phenomena occurring on complex networks @xcite",
    ", the presence of such emerging properties has been shown to imply the breakdown of the standard results .",
    "this is particularly true for epidemiology  @xcite where classical results about epidemic thresholds do not apply if the heterogeneity of the network is too large .",
    "this therefore calls for a systematic investigation of the epidemic spread in the framework of metapopulation models defined on complex networks such as the world airport network .",
    "such investigations can be carried out in various parallel and complementary directions . on the one hand ,",
    "the availability of large scale datasets has recently allowed for the development of tools for intensive computational epidemiology @xcite , which can be used for example for scenario evaluations  @xcite and risk assessment . on the other hand ,",
    "these computational tools can also be used for the study of fundamental properties of these metapopulation models , and to understand the main mechanisms of the disease spread and the role of the various complex properties of the transport network . in particular , @xcite have investigated how the properties of the global air travel network affect the heterogeneity and the predictability of spreading patterns . very recently moreover , the effect on the epidemic threshold of both the network properties and the endogenous reaction was studied using analytical and numerical tools typical of statistical physics  @xcite .    in this paper , we tackle the problem of determining the arrival time of an epidemics spread in a metapopulation model consisting in subpopulations ( cities ) coupled by a transportation network . we stress that this study is different from the ones of @xcite and @xcite , in which each node of the network is an individual ( and not a full subpopulation ) , and where links represent the possibility of the contamination between individuals .",
    "the main result of the present paper is to exhibit an easily computable quantity depending only on the networks characteristics and which approximates the average arrival time .",
    "this quantity is only an approximation of the exact arrival time but we show on the example of the world - wide disease spread that it allows to rank the cities according to the arrival of the disease .    the paper is organized as follows .",
    "we present in section 2 the rvachev - longini metapopulation model for the epidemics spreading , and in section 3 , we study the arrival time of a disease for simple topologies such as a one - dimensional line of cities .",
    "we then extend these results to the case of complex networks and we propose a quantity which is a good approximation to the average arrival time in the various nodes or subpopulations connected through an arbitrary network of connections .",
    "we finally show in section 4 , using numerical simulations of epidemic spreading on the worldwide airport network , that our approximation is not only valid for the average arrival time , but is also able to give the order of arrival of the disease in the various cities with a good precision for each spreading realization .",
    "a brief account of some of the results presented here can be found in @xcite .",
    "the rvachev - longini model  @xcite was initially introduced to describe the spread of the 1968 - 69 hong - kong flu at the worldwide level .",
    "this metapopulation model uses two different levels of description : the various subpopulations are given by the inhabitants of the @xmath2 large cities corresponding to the @xmath2 largest airports , and homogeneous mixing is assumed at the individual city level . in this model ,",
    "the propagation of the disease from one subpopulation to another is due to individuals traveling on the air - transportation network between these airports  @xcite .",
    "the evolution of the number @xmath3 of infectious individuals in each city @xmath4 can thus be written as the sum of two terms @xmath5 where the first term @xmath6 of the rhs describes the ( epidemic ) reaction process inside each subpopulation ( city ) , due to the interaction of individuals in the various possible states @xmath7 ( @xmath8 depending on the population compartimentalization into susceptible , latent , infected , recovered ... individuals ) .",
    "the second term of the rhs represents the incoming and outgoing fluxes of infectious individuals to and from other cities @xmath9 .",
    "this model therefore considers a simplified mechanistic approach with a markovian assumption in which individuals are not labeled according to their original subpopulation , and where at each time step the same traveling probability applies to all individuals in the subpopulation , without any memory of their previous locations @xcite .",
    "the travel term @xmath10 depends therefore on the air - transportation network : if the weight @xmath11 represents the number of passengers traveling from @xmath4 to @xmath9 per unit of time ( @xmath12 if there is no direct connection between @xmath4 and @xmath9 ) , and @xmath13 the population of the city @xmath4 , it is reasonable to assume that the probability per unit time that an individual in city @xmath4 travels to city @xmath9 is given by @xmath14 . in the case of a simple si model , the time evolution of the number @xmath3 of infectious infividuals in city @xmath4",
    "is therefore given by : @xmath15 where @xmath16 is the transmission rate .",
    "similar equations can be written for the other compartments in the various possible models ( sis , sir ... ) , by modifying the first term @xmath6 of the rhs in eq .",
    "( [ rlcont ] ) accordingly .",
    "this original formulation has an important drawback .",
    "indeed , it is deterministic , since it considers only expectation values , while both epidemic spreading and travel of individuals are inherently stochastic processes . the number of infectious individuals is then treated as a continuous variable and , even if the initial condition ( at @xmath17 ) of the spreading consists in one single infectious individual in a given city @xmath18 , all cities have a non - zero density of infectious at any time @xmath19 . in order to tackle the problem of the arrival time of the spread in the various subpopulations , this pathology has to be accounted for . a first possibility , already presented by @xcite , to avoid this unrealistic situation consists in considering that each travel term @xmath20 is present only when @xmath21 , i.e. in putting a threshold term @xmath22 , corresponding to the fact that the expected number of travelers has to be larger than unity .",
    "in this approach however the `` quantity '' of individuals traveling is still a continuous variable .",
    "another possibility , which consists in treating all quantities as integers and going back to the microscopic stochastic processes , can be necessary for detailed modeling purposes @xcite .",
    "this solution is however computationally quite demanding , so that we will consider in all numerical simulations performed in this paper an intermediate framework : the travel term is treated as in the stochastic generalization described by @xcite ( see also @xcite ) , where the number of individuals traveling on each connection is an integer variable randomly extracted at each time step .",
    "more precisely , each of the @xmath23 $ ] ( the integer part of @xmath3 ) infectious individuals has a probability @xmath24 to go from @xmath4 to @xmath9 in the time interval @xmath25 .",
    "the numbers @xmath26 of infectious individuals traveling on the various connections existing from @xmath4 to other cities @xmath9 are given by a set of stochastic variables which follow then a multinomial distribution @xcite @xmath27!}{\\left ( [ i_i ] - \\sum_j\\xi_{ij}\\right)!\\prod_j\\xi_{ij } ! } \\times\\prod_j",
    "p_{ij}^{\\xi_{ij}}\\left(1-\\sum_j p_{ij}\\right)^{[i_i]-\\sum_j\\xi_{ij } } \\label{multinom}\\ ] ] where the mean and variance of the stochastic variables are @xmath28\\right)\\rangle = w_{ij}\\delta t [ i_i]/n_i$ ] and @xmath29 $ ] . on the other hand , the endogenous growth ( inside each city )",
    "will be treated for simplicity as a deterministic evolution of densities of infectious and susceptible individuals .",
    "we have moreover checked numerically that the inclusion of stochastic effects described by noise terms in the evolution equations @xcite do not change our results .",
    "finally , we will present the results essentially for the simple si model , since arrival times will basically depend on the first stage of the disease development .",
    "we have however carried out numerical simulations as well in the sis and sir case , with consistent results ( see section 4 ) .",
    "it is interesting to note that in realistic cases such as a disease propagation on the wan , most weights are symmetric ( @xmath30 ) @xcite but the probabilities of travel from one city to another are not ( @xmath31 ) .",
    "the travel therefore effectively occurs as a random diffusion on a directed weighted complex network .",
    "moreover , an important difference with the case of random walks on complex networks  @xcite comes from the endogenous evolution inside each subpopulation .",
    "indeed , as soon as an infectious individual reaches a city , a contamination process starts and the number of random infectious walkers is not constant .",
    "such an intricate behavior has also important consequences on the existence of epidemic thresholds , as studied recently by  @xcite .    as a last general remark",
    ", we note that the simple topological distance between nodes should naturally play a role in the context of arrival times , but does not contain all the information needed to characterize such a process , nor does a priori the optimal weighted distance , which takes into account the weights @xcite but not the populations nor the endogenous epidemic evolution .",
    "moreover , since most transportation networks are small - world networks ( even when taking into account weights ) , many cities lie at the same topological distance from a given seed , but will be reached at very different times .",
    "in this section , we study the arrival time of the first infectious individual in the various cities , starting with very simple topologies for the transportation network .",
    "we start with the case of two connected cities ( @xmath32 and @xmath33 ) .",
    "we denote the link weight by @xmath34 , the population of the first city by @xmath35 , the number of infectious individuals in city @xmath32 by @xmath36 .",
    "the probability to jump from @xmath32 to @xmath33 during the time interval @xmath25 is @xmath37 .",
    "the initial condition is given by @xmath38 , @xmath39 , i.e. , infectious individuals are present only in city @xmath32 .",
    "we consider that the travel events occur as instantaneous jumps ( of probability @xmath40 for each individual ) at discretized times .",
    "the probability that the first infectious individual arrives at time @xmath41 in city @xmath33 is then given by @xmath42}}\\right ) \\times \\prod_{i=1}^{n-1}\\left(1-p\\right)^{{[i_0(i\\delta t ) ] } } \\ , \\label{probai}\\ ] ] which expresses the fact that at least one successful `` jump '' from @xmath32 to @xmath33 of an infectious individual occurs at time @xmath43 , and none at previous times . in eq .",
    "( [ probai ] ) , the quantity @xmath44 $ ] denotes the integer part of @xmath45 . in order to obtain the probability density of the arrival time in city @xmath33",
    ", we first note that in real - world systems the number of travelers is usually small with respect to the total population of a city : @xmath46 ( with any reasonable @xmath25 ) . in this limit , eq .",
    "( [ probai ] ) becomes @xmath47 e^{-p\\sum_{0 < i",
    "< n}{[i_0\\left(i\\delta t\\right ) ] } } \\ .\\ ] ] we will also assume that the travel probability is sufficiently small so that the number of infectious individuals @xmath48 in the city @xmath32 grows substantially before the city @xmath33 is contaminated . writing @xmath49 ( the second inequality is due to the fact that in realistic cases only small fractions of the population are contaminated ) , we thus consider the following approximation : @xmath50(t ) \\approx i_0(t ) \\approx i^0e^{\\lambda t}$ ] ( as long as @xmath51 ) . using as well the standard approximation @xmath52= \\int_0^ti_0\\left(\\tau\\right)d\\tau$ ] , we obtain for @xmath53 @xmath54 where @xmath55 is the heavyside function which ensures the positivity of the arrival time .",
    "the distribution ( [ distrfin ] ) is a gumbel distribution with average @xmath56 , where @xmath57 is the euler constant .",
    "the contribution of the negative @xmath58 in the distribution has to be negligible before @xmath33 , which reads @xmath59 .",
    "this range of validity corresponds also to the hypothesis of @xmath60 ( the time to increase @xmath45 by one individual is small with respect to the time scale of the epidemic arrival in city @xmath33 ) .",
    "figure [ gumbel ] displays the results of numerical simulations of the propagation between two cities , using discrete stochastic travel events as described in section 2 .",
    "the whole distribution of arrival times in the second city shows a very good agreement with the form ( [ distrfin ] ) , obtained through the continuous approximations detailed above .",
    "when @xmath61 is not small enough , stronger deviations are obtained ; this is expected since the hypothesis @xmath62 for @xmath51 is less valid . nonetheless , the overall shape of the distribution is still in good agreement ( inset of fig .",
    "[ gumbel ] ) .",
    "in numerical simulations with @xmath63 .",
    "_ inset _ : distribution of @xmath64 with @xmath65 .",
    "the continuous line is the analytical approximation given by eq .",
    "( [ distrfin ] ) . here and in the following , unless specified , @xmath66 and @xmath67 . ,",
    "width=472 ]    [ gumbel ]      we now consider a one - dimensional line of subpopulations @xmath68 , with an initial condition given by one infectious individual in city @xmath32 .",
    "we denote by @xmath69 the travel flux between city @xmath4 and city @xmath70 , @xmath71 the arrival time of the first infectious in city @xmath4 , and @xmath72 ( @xmath73 ) .",
    "the quantity @xmath74 is thus the sum of the random variables @xmath75 for @xmath76 , and the average is given by @xmath77 .",
    "these random variables @xmath75 are a priori correlated and not identically distributed which implies that the central limit theorem can not be used in general .      in the case of a homogeneous line with uniform populations and weights ( @xmath78 , @xmath79 ) ,",
    "one expects that the distributions of @xmath80 becomes independent of @xmath81 at large @xmath81 , with a well - defined average @xmath82 , so that @xmath83 .",
    "the issue then is the computation of @xmath84 .",
    "two time scales only are present : @xmath85 which represents the average time for an individual to travel from one city to the next , and @xmath86 which represents the typical transmission time of the disease .",
    "dimensional analysis thus implies that the adimensional quantity @xmath87 has the form @xmath88    in order to estimate the unknown function @xmath89 , a first possibility is to consider that at large @xmath81 the spread consists in an evolving epidemic front obeying the continuous equation @xmath90 .",
    "looking for a traveling wave solution  @xcite leads to a front speed @xmath91 , and thus to @xmath92    another possibility consists in using the results of the previous subsection , and assume that the average of @xmath80 remains close to the arrival time in the first city @xmath93 which yields @xmath94 \\ .",
    "\\label{deltagumbel}\\ ] ] this approximation neglects the fact that @xmath95 increases between @xmath96 and @xmath74 due both to the endogeneous growth in city @xmath97 and to the arrival of infectious individuals from city @xmath98 , while for the computation of @xmath99 , only the endogeneous growth of @xmath45 has to be considered . it can therefore be expected that @xmath100 will overestimate the real @xmath84 .    finally , we can also consider a deterministic formulation , in which travel between @xmath4 and @xmath70 occurs only if there are enough infectious individuals in @xmath4 , i.e. @xmath101 has reached a certain threshold @xmath102 , and is then treated as continuous . in this framework , each city is considered infected only if the number of infectious individuals is above @xmath102 , and @xmath74 is defined as the first time that @xmath103 reaches the threshold : @xmath104 . between @xmath96 and @xmath105 , no travel can therefore occur out of @xmath81 , and we can write @xmath106 . during @xmath107 $ ] , under the realistic hypothesis that @xmath108 , and that @xmath109 is in a first approximation given by @xmath110 , we obtain the equation @xmath111 . the difference between the arrival times in two successive cities",
    "is therefore given by @xmath112 where @xmath113 is known as the lambert w function .",
    "of @xmath114 vs @xmath81 on a line of length @xmath115 .",
    "the average @xmath114 is taken over @xmath115 realizations of the spreading , and the slope is measured at large @xmath81 ( only the cities with @xmath116 are considered ) .",
    "the error bars represent the variance of @xmath117 .",
    "@xmath118 $ ] and @xmath119 $ ] , @xmath66 .",
    "full line : @xmath120 .",
    "dotted line : @xmath121 . dashed line : @xmath122 .",
    "inset : correlations @xmath123 versus @xmath124 on a line of length @xmath115 , the average is done over @xmath115 realizations .",
    ", width=472 ]    [ grandn ]    in order to test these various analytical approaches , we consider numerical simulations of the stochastic model described in section 2 , for identical cities of population @xmath66 located on a one - dimensional line , with uniform travel fluxes @xmath125 between successive cities .",
    "the measured average arrival times are , as expected , proportional to @xmath81 at large @xmath81 ( not shown ) .",
    "figure [ grandn ] displays the corresponding slope as @xmath126 versus @xmath127 .",
    "various values of @xmath128 , @xmath16 and @xmath125 with the same ratio @xmath129 yield the same @xmath130 , as predicted from the theoretical dimensional analysis ( [ dim_an ] ) .",
    "as shown in fig .",
    "[ grandn ] , @xmath131 is in agreement with the simulations only at small @xmath129 : the slowest the travel , the less a spatial continuous approximation is valid . on the other hand ,",
    "both @xmath132 and @xmath121 display reasonable agreement , and in particular correctly capture the increase with @xmath127 for large @xmath129 .",
    "as expected , @xmath121 slightly overestimates @xmath133 .",
    "we also show in the inset of fig .",
    "[ grandn ] the correlations between the @xmath80 s .",
    "these correlations vanish rapidly with the distance along the line .",
    "negative correlations can however be observed between @xmath134 and @xmath135 .",
    "such phenomenon can be understood as follows .",
    "assume that , in a given spreading realization , @xmath134 is small . in this case",
    ", @xmath136 will be unusually small too .",
    "the `` reservoir '' of infectiousness defined by city @xmath98 will thus transmit less infectious individuals to @xmath97 at times @xmath137 , and therefore the subsequent contamination of city @xmath81 will be slower , leading to a larger @xmath80 .",
    "the numerical simulations allow also to measure the whole distributions of arrival times and of their intervals . in fig .",
    "[ gaussian ] , we show @xmath138 for different values of @xmath81 . the gumbel shape is only valid for @xmath139 , and for large @xmath81 more symmetric ( gaussian - like ) distributions are obtained .",
    "on the other hand , fig .",
    "[ distrtime ] shows that the distribution of the arrival times themselves display asymmetric gumbel - like shapes even at large @xmath81 .     for various values of @xmath81 . for small @xmath81 ,",
    "the distribution is close to a gumbel and for large @xmath81 , it evolves to a gaussian .",
    "@xmath140 , @xmath66 , @xmath67.,width=472 ]    [ gaussian ]     for various values of @xmath81 .",
    "the distribution remains close to gumbel shapes even at large @xmath81 .",
    "the plot on the right is in log - scale on the y - axis and the curves are shifted vertically for clarity .",
    "@xmath140 , @xmath66 , @xmath67.,width=472 ]    [ distrtime ]      we now consider the general case of heterogeneous populations @xmath13 and fluxes @xmath69 .",
    "the application of the same considerations as in the case of a homogeneous line leads to @xmath141 . since",
    "our main goal is to understand the case of complex networks which usually have the small - world property ( i.e. a small diameter varying typically as @xmath142 ) , we will now focus on the properties of @xmath74 at small @xmath81 . assuming that the average of @xmath75 remains close to the formula for the arrival time in the first city ( @xmath143 ) , we obtain @xmath144 \\ . \\label{averaget}\\ ] ] this expression links the expected arrival time in city @xmath81 of a stochastic spreading event to the quantity @xmath145 which depends on the properties of the line on which the spreading propagates .",
    "it is symmetric by permutations of weights and populations , and figure [ sym ] shows in fact that the whole distribution of arrival times , obtained through numerical simulations of the discrete stochastic dynamics , and not only its average , respects this symmetry . in the numerical simulations , heterogeneous populations and travel fluxes are uniformly distributed ( @xmath146 $ ] and @xmath147 $ ] ) .",
    "figure [ sym ] shows that the distribution of arrival times is invariant when one replaces ( i ) all the random weights by their geometrical mean @xmath148 ; ( ii ) all the random populations by their geometrical mean @xmath149 ; ( iii ) all weights by @xmath150 and all populations by @xmath151 .",
    "the ratios of the average arrival times for these different sets @xmath152 , @xmath153 and @xmath154 stay very close to @xmath33 , with deviations at most of the order of @xmath155 .",
    "7 obtained for a fixed random set of populations @xmath156 and weights @xmath157 ( @xmath158 different sets are used in the @xmath158 graphs ) .",
    "red crosses correspond to the same distribution obtained a ) with uniform travel @xmath159 , and populations @xmath156 ; b ) with uniform populations @xmath160 , and weights @xmath157 ; c ) with uniform populations @xmath160 and uniform weights @xmath159 . ,",
    "width=472 ]    [ sym ]     vs @xmath161 for @xmath162 cities connected on a line .",
    "each point correspond to the average arrival time in one of the city of the line , for one realization of the weights @xmath125 , averaged over @xmath163 realizations of the epidemic spread .",
    "results are presented for @xmath164 different random sets @xmath157 . , width=472 ]    [ chi ]    we test in fig .",
    "[ chi ] the relation ( [ averaget ] ) which predicts the average arrival time measured in numerical simulations of the stochastic model .",
    "we use for simplicity uniform populations @xmath66 , and we measure , for each fixed set of weights , the arrival time in each city , averaged over @xmath163 stochastic realizations of the spread .",
    "figure  [ chi ] displays @xmath165 versus @xmath166 for the various cities of a @xmath162 cities line , for @xmath164 different random sets of weights ( each point corresponds to one given set of weights ) .",
    "we first note that @xmath165 is a monotonous function of @xmath166 .",
    "the figure also clearly shows that @xmath161 systematically overestimates the average arrival time .",
    "this is due , as already explained in the discussion of eq .",
    "( [ deltagumbel ] ) , to the fact that the use of @xmath100 neglects correlations , and in particular the travel between cities @xmath98 and @xmath97 for the estimate of the arrival time in @xmath81 . since this travel term increases @xmath109 , it increases the probability that an infectious travels from @xmath97 to @xmath81 , and therefore reduces @xmath74 .",
    "this overestimation effect is not present for the first group of points that lie on the diagonal of the figure and correspond to cities directly connected to the seed .",
    "for this first group of cities , the average arrival time is indeed correctly given by @xmath161 .",
    "on the other hand , the small overestimation can already be observed for cities at distance @xmath167 of the seed .",
    "for example , points @xmath168 and @xmath169 highlighted in fig .",
    "[ chi ] have the same @xmath170 .",
    "point @xmath168 corresponds to a city directly connected to the seed @xmath171 , with a flux of @xmath172 passengers per unit time , such that @xmath173 , while point @xmath169 is obtained for a city which lies at topological distance two from the seed , with a city @xmath174 in between and such that @xmath175 .",
    "the two cases correspond to the same value of @xmath161 , but to different average arrival times : the arrival time in @xmath169 is smaller than in @xmath168 , even if @xmath176 , because relation ( [ averaget ] ) neglects the travel of additional infectious individuals between @xmath171 and @xmath174 to compute @xmath177 . despite this systematic effect , fig .",
    "[ chi ] shows that relation ( [ averaget ] ) allows to define a quantity which depends only of the populations and passenger fluxes , and such that the average arrival time of the spreading is a monotonous function of this quantity . in the following",
    ", we will investigate how to generalize this quantity to more complex topologies .",
    "equation  ( [ averaget ] ) gives an estimate of the average arrival time in a city @xmath81 connected to the seed of the spreading through links with certain fluxes , and corresponds to a sum of the quantity @xmath178 along the links followed by the disease from the seed to city @xmath81 . in a network , the sum can be computed along any of the paths linking the seed @xmath179 to any other city @xmath9 . since these different paths correspond a priori to different fluxes and to different arrival times , a natural approach consists in approximating the average arrival time in @xmath9 , starting from a given seed @xmath179 , by the minimum of ( [ averaget ] ) over all possible paths : @xmath180 \\label{defchi}\\ ] ] where @xmath179 is the seed , @xmath181 is the set of all possible paths connecting @xmath179 to @xmath9 , and the sum is performed over the links @xmath182 along each path . in other terms",
    ", we have introduced a new weight on each oriented link @xmath182 of the network : @xmath183 .",
    "the quantity @xmath184 is then the weighted distance between the seed @xmath179 and the node @xmath9 on this non - symmetric network ( such a quantity can easily be computed for any topology using the dijkstra algorithm @xcite ) .",
    "note that since the weights are real - valued , it is highly improbable that two different paths with the same sum of weights exist , so that equation ( [ defchi ] ) selects a unique path between @xmath179 and @xmath9 .",
    "differences between propagation on a one - dimensional line and on a network can be expected from the two following important topological differences between these structures : ( i ) paths go through nodes with degree larger than @xmath167 and ( ii ) there are usually more than one path between two points .",
    "we first focus on the effect of the intermediate nodes with possibly large degrees through which the disease propagates . to this aim ,",
    "we consider the simple topology consisting of a node @xmath32 connected to @xmath185 neighbors ( as shown in the inset of fig .",
    "[ degree ] ) .",
    "the infectious individuals , when they arrive at the central node , have multiple possible travel destinations . the probability for each destination to become infected is thus decreased ; if the seed is in @xmath32 for instance , the initial infectious individual may even travel to a different peripherical node before creating an endogenous epidemic growth in the hub .",
    "this effect can be quantified by measuring the average arrival time of the disease in a given peripheral city @xmath4 in various situations .",
    "we first consider the case of a spreading phenomenon starting in a randomly chosen peripheral node , @xmath186 , and compare the average arrival time in @xmath4 with the average arrival time in the one - dimensional situation in which only cities @xmath18 , @xmath32 and @xmath4 are present . the ratio of these two times is displayed in fig .",
    "[ degree ] ( ` seed : not hub ' ) as a function of the degree @xmath185 of the central node .",
    "we also show in the same figure the ratio of arrival times when the seed is @xmath32 , i.e. the hub itself ( `` seed : hub '' ) , and the topology is either the one of the inset , or the simple two - cities configuration in which only @xmath32 and @xmath4 are present and connected . in all cases , the arrival time in @xmath4 is increased by the presence of other possible connections from the hub .",
    "the effect is stronger for larger degree when the seed is the hub itself .",
    "the multiplicity of possible destinations therefore not only decreases the predictability of the spread @xcite , but also increases the average disease arrival time in a given city .     of the average arrival time in a fixed peripheral city @xmath4 of the network shown in the inset and the average arrival time in the @xmath187 case , vs the degree of the hub , @xmath185 .",
    "averages are done over @xmath188 realizations of the spreading , with parameter @xmath63 .",
    "circles : the seed is the hub ; squares : the seed is one of the peripheral cities . , width=472 ]    [ degree ]    another important point distinguishes a propagation in a network from a one dimensional line : namely , that multiple paths can often be found between two given nodes .",
    "in fact , it has already been shown by @xcite in the case in which nodes represent individuals and not subpopulations , that the average arrival time is decreased by the presence of multiple paths , and that not only the shortest paths contribute to the spread between the seed and other nodes . to quantify this effect in metapopulation models , we consider the simple topology depicted in fig .  [ carre ] : a node @xmath168 ( population @xmath189 ) is connected to a node @xmath169 by two different paths of length two .",
    "the first path connects @xmath168 with weight @xmath190 to an intermediate city @xmath191 of population @xmath128 , which is in its turn connected to @xmath169 with weight @xmath192 .",
    "the second path has weights @xmath193 and @xmath194 , and the intermediate city @xmath195 has population @xmath196 .",
    "we denote the probability that the disease spread reaches the city @xmath169 at time @xmath58 by @xmath197 if the two paths are present , by @xmath198 if only the first path through @xmath191 ( weights @xmath190 , @xmath192 ) is present , and by @xmath199 if only the second path ( through @xmath195 , weights @xmath193 , @xmath194 ) is present . since the epidemics reaches @xmath169 from @xmath168 through one path or the other , @xmath200 can be expressed as @xmath201 the data shown in fig .",
    "[ distrtime ] suggest that we can assume that @xmath202 and @xmath203 are gumbel distributions , of averages @xmath204 and @xmath205 , respectively .",
    "we introduce the quantities @xmath206 and @xmath207 .",
    "the quantity @xmath208 can be seen as the travel flux which , if @xmath168 and @xmath169 were directly connected , would yield the same arrival time distribution than the real two links @xmath209 and @xmath210 with weights @xmath190 and @xmath192 : @xmath211 .",
    "we then have @xmath212 and finally from eq .",
    "( [ min ] ) ( using the fact that the weights are small with respect to the quantities @xmath213 , @xmath214 , @xmath215 ) @xmath216 we note that @xmath200 is also a gumbel distribution , and the average of the arrival time in @xmath169 , @xmath217 ( mp = multiple paths ) , can be easily calculated : @xmath218 so that the existence of two paths results in the law @xmath219    we have checked this prediction by numerical simulations of stochastic spreading in the small network formed by nodes @xmath168 , @xmath169 , @xmath191 and @xmath195 , in the simple case of @xmath220 and @xmath221 , @xmath222 . figure [ carre ] displays the ratio of the average arrival time in @xmath169 , for a spread seeded in @xmath168 , to the average arrival time in @xmath169 when only one path ( the one with weights @xmath125 ) is present .",
    "we consider only @xmath223 since the situation with @xmath224 is obtained by exchanging the two paths . as @xmath225 , this ratio goes to @xmath33 , while , in the other extreme case @xmath226 , a decrease of the average arrival time close to @xmath227 is obtained .",
    "moreover , the prediction ( [ multp ] ) , shown as continuous line , is in excellent agreement with the numerical data .",
    "interestingly , when more than two paths are present , eq .",
    "( [ multp ] ) can easily be generalized to a sum over all possible paths ( not necessarily of length @xmath167 ) : @xmath228 with @xmath229 where @xmath230 is computed on each path by eq .",
    "( [ averaget ] ) .",
    "figure [ cml2 ] presents a comparison of numerical results with this analytical prediction , for various path multiplicities , showing a very good agreement .",
    "similar results are obtained for paths of larger lengths .",
    "( the seed is @xmath168 ) and the average arrival time in the @xmath187 case ( when only the path @xmath231 is connected ) , versus @xmath232 ( in the simulations @xmath233 , @xmath234 , and @xmath235 ) .",
    "averages are done over @xmath236 realizations of the spreading , with @xmath237 and @xmath63 .",
    "all cities have the same population @xmath66 .",
    "full line : theoretical prediction ( [ tmp1 ] ) .",
    ", width=472 ]     ( the seed is @xmath168 with degree @xmath185 ) to the average arrival time in the @xmath187 case ( when only the path @xmath238 is connected ) , vs @xmath232 .",
    "averages are done over @xmath236 realizations of the spread , with @xmath237 and @xmath63 .",
    "all cities have the same population , @xmath66 .",
    "numerical results ( symbols ) are compared to the theoretical model given by eq .",
    "( [ tmp ] ) ( full lines ) for different values of @xmath185 .",
    ", width=472 ]    [ cml2 ]    we have also investigated numerically , on simple topologies but with random weights , how well the average arrival time in a city is correlated with @xmath239 computed as in ( [ tmp ] ) . in particular , fig .",
    "[ tmod ] displays the average arrival time in city @xmath169 , connected to the seed @xmath168 of the spreading by @xmath185 paths of length @xmath240 and random weights , as a function of both @xmath241 given by eq .",
    "( [ defchi ] ) ( i.e. computed along the path that minimizes @xmath161 ) and @xmath239 which takes into account all paths . while @xmath239 is slightly more strongly correlated with @xmath242 than @xmath241 , and closer to its actual value , the improvement is not striking .",
    "we have also developed an algorithm to compute @xmath239 on a complex network , by taking into account the contributions of all paths of topological lengths @xmath243 and @xmath244 ( where @xmath243 is the length of the shortest path , in terms of topology , between the seed and the considered city ) . while the algorithmic complexity is increased ( we used techniques based on the brandes algorithm @xcite ) with respect to the computation of ( [ defchi ] ) , the obtained improvement was again significative but not striking",
    ".     of arrival in @xmath169 and @xmath245 ( black ) , and between @xmath246 and @xmath247 ( red ) , for the network represented in the inset .",
    "the different points correspond to different values of @xmath185 ( from @xmath167 to @xmath162 ) , different path lengths @xmath240 ( from @xmath167 to @xmath248 ) and different realizations of the disorder of the links ( @xmath164 different sets of @xmath249 for each structure ) .",
    "averages are done over @xmath236 realizations of the spreading .",
    ", width=472 ]    [ tmod ]",
    "we now proceed to numerical simulations of the metapopulation model on the worldwide airport network , which displays various levels of complexity and heterogeneity  @xcite . at the topological level ,",
    "the degree distribution is broad and can be approximated by a power - law ; the links weights ( fluxes ) are also broadly distributed and span several orders of magnitude .",
    "finally , the world city populations are also broadly distributed according to zipf s law @xcite .",
    "all these heterogeneity levels have been shown to play relevant roles in the spread of epidemics at the worldwide level @xcite .",
    "we perform the numerical simulations of the stochastic spreading on the network containing the @xmath250 largest airports , which takes into account @xmath251 of the total traffic ( the wan comprises @xmath252 airports , but we consider here only the links verifying @xmath253 , which amounts to the removal of the smallest airports ; in particular , a certain number of nodes have a larger traffic than inhabitants , which leads to a local breakdown of the relation between @xmath254 and the local population and travel flow ) .      figure [ 4cities ]",
    "displays the average arrival time in the various cities , @xmath255 , as a function of @xmath166 as defined by ( [ defchi ] ) . for each given seed ,",
    "averages are done over @xmath236 stochastic realizations of the disease spread .",
    "the figure clearly shows that the value of @xmath161 determines the average arrival time ( the two quantities are very strongly correlated ) and various cities with the same @xmath161 are reached at the same time by the propagation . as in the case of the simple topologies studied above , @xmath161 in fact systematically overestimates the correct average arrival time , but can still be considered as a very good approximation .",
    "figure [ 4cities ] also highlights the effect of hubs , analyzed in the previous section .",
    "frankfurt is indeed the node with the largest degree in the network , and the arrival times at a given value of @xmath161 is larger than for other seeds with a smaller degree .",
    "this effect remains however quite small and is essentially limited to the first reached cities .",
    "the arrival times seem to be closer to our ansatz .",
    "this stems from the delay introduced by the large degree of the initial seed , as discussed in the previous section , which increases all the arrival times , therefore slightly shifting the data upwards and partially compensating for the fact that @xmath161 overestimates these times .",
    "we finally note how very similar results are obtained for the sir model .",
    "as expected , the important time scale in the sir ( as well as in the sis ) is @xmath256 : this quantity controls the endogenous growth of the epidemic at small times .",
    "we have investigated a wide range of values for @xmath256 , as well as for @xmath16 in the simple si case .",
    "the arrival time is well determined by @xmath161 as long as the condition @xmath257 given in section 3 is satisfied .     versus @xmath161 on the wan for diseases starting in different cities .",
    "each red dot corresponds to a city and averages are done over @xmath236 realizations of the spread .",
    "crosses are an average over cities with the same @xmath161",
    ". the starting seeds are frankfurt ( degree @xmath258 ) , bucharest ( degree @xmath259 ) and hong - kong ( degree @xmath260 ) . when the initial seed is a hub , the average arrival time is larger , especially in the first reached cities , due to the effect of the degree .",
    "we also show @xmath261 versus @xmath161 for a sir model seeded in hong - kong . , width=472 ]    [ 4cities ]    figure [ 4cities ] conveys the result that the average arrival times are not exactly given by @xmath161 , but are at least determined to a large extent , given a seed , by this quantity .",
    "an immediate application of this result is given by a possible prediction of the order of arrival of the disease in different cities . in order to compare the list of cities ranked by the average arrival time and",
    "the same list ordered according to @xmath161 , we compute the indicator known as kendall s @xmath262 .",
    "this indicator allows a quantitative analysis of the correlations between two rankings of @xmath81 objects  @xcite and is given by @xmath263 where @xmath264 is the number of pairs whose order does not change in the two different lists and @xmath265 is the number of pairs whose order is inverted .",
    "this quantity is normalized between @xmath266 and @xmath33 : @xmath267 corresponds to identical rankings while @xmath268 is the average for two uncorrelated rankings , and @xmath269 is a perfect anticorrelation .",
    "we present in the first column of table [ tab ] the values of @xmath262 for the lists of cities ordered according respectively to the average arrival time of the spread and to the values of @xmath161 , for various seeds .",
    "the second column of the table gives the values of @xmath262 when the lists are ordered by average arrival time and by @xmath239 . in both cases the values are extremely high",
    "( two random permutations of a list of size @xmath270 would give an indicator normally distributed with mean @xmath32 and variance @xmath271  @xcite ) . in order to better emphasize this strong correlation between the ordered list",
    ", we also display in table [ tab ] the @xmath262 of kendall between the city list ordered by average arrival time and by different distances from the propagation seed .",
    "as noted in the introduction , the topological distance @xmath243 from the seed is not completely irrelevant , but other weighted distances which take into account the diversity of fluxes and populations could be expected to be more strongly correlated with the arrival time . in particular , a first possibility consists in defining the effective `` length '' of each edge as the inverse of the weight , @xmath272 : the disease will spread more easily on an edge if many passengers travel across it .",
    "the corresponding weighted distance between nodes on the network is noted @xmath273 .",
    "since the ratios @xmath85 moreover appear naturally in the travel probabilities , we also consider that a directed length @xmath274 can be defined on each edge , and the distance between each node and the seed can as well be computed ( @xmath275 ) .",
    "the results indicate significant correlations between the average arrival times and these various distances .",
    "the correlations are however much stronger with @xmath161 and @xmath239 , showing that these quantities can be used with a good confidence as an estimate of the average arrival time order .",
    "very similar results are obtained for sis or sir models , with respectively @xmath276 and @xmath277 , for a spreading process seeded in hong - kong .    .kendall",
    "s @xmath262 for the list of cities ranked by arrival order and the list obtained with different indicators .",
    "each line corresponds to a different seed : frankfurt ( fra , degree @xmath258 ) , hong - kong ( hkg , degree @xmath260 ) .",
    "bucharest ( otp , degree @xmath259 ) and sao jose dos campos ( sjk , brazil , degree @xmath248 ) .",
    "[ cols=\"<,^,^,^,^,^\",options=\"header \" , ]      the previous results are valid for the average arrival times , and it is legitimate to ask about their relevance to the case of a single spreading event .",
    "indeed , in the real - world there is not such a thing as averages over different realizations .",
    "the natural extension of our results therefore consists in checking if the quantity @xmath161 can predict the order in which the disease will reach the various nodes ( cities ) of the network in each stochastic realization of the spread .",
    "more precisely we can compute , for each pair of nodes @xmath278 in the network , and for a given infection seed , the probability that the arrival times in @xmath4 and @xmath9 for the same realization of the spread , @xmath71 and @xmath279 , are correctly ordered by their values of @xmath161 , i.e. that they verify @xmath280 .",
    "we use the notation @xmath281 and fig .",
    "[ proba ] displays the probability @xmath282 that a couple of nodes with a @xmath161-difference @xmath283 are reached by the disease in the order predicted by their values of @xmath161 .",
    "if @xmath284 , no prediction can be made and we obtain indeed @xmath285 . on the other hand ,",
    "if @xmath286 is large ( @xmath287 ) , the two nodes are reached in the correctly predicted order in every realization of the spread .    since not all node pairs have very different values of @xmath161 ( and thus a large value of @xmath288 ) , we also show as in fig .",
    "[ proba ] the cumulative distribution @xmath289 of the number of couples of nodes with a given value of @xmath288 .",
    "for instance , for a spreading process seeded in hong - kong ( degree @xmath260 ) , @xmath290 of the couples have @xmath291 , and these pairs are correctly sorted with a probability larger than @xmath292 , instead of only @xmath293 on average if no information is available .",
    "figure [ proba ] moreover shows that the precision is higher when the seed has a small degree . on the other hand ,",
    "if the seed is frankfurt ( of degree @xmath258 , data not shown ) , the situation is slightly worsened , as can be expected from the smaller global predictability of the spread starting from a hub @xcite , due to the many possible travel destinations available for the infectious individuals . in this case , @xmath292 of the couples have @xmath291 , and these pairs are correctly sorted with a probability larger than @xmath294 ; the probability @xmath282 is larger than @xmath295 for @xmath296 of the pairs .",
    "similar results are obtained when the endogenous growth of the disease is described by sis or sir models .",
    "( circles ) , in each realization of the spread , and cumulative distribution ( squares ) of the values of @xmath288 ( i.e. , fraction of couples of cities @xmath278 with @xmath297 ) .",
    "top : the seed is hong - kong , a node of degree @xmath260 , and the curves of @xmath282 for both si ( circles ) and sir ( crosses ) processes are shown .",
    "bottom : the seed has degree @xmath248 ( sao jose dos campos , brazil ) . , width=472 ]    [ proba ]    we also present in fig .",
    "[ probadis ] the same quantities @xmath282 and @xmath298 for couples of nodes having the same topological distance from the seed .",
    "while this topological distance is indeed too simple a quantity to be really useful in the prediction of arrival times , it can seem reasonable that a node at distance @xmath33 from the seed will anyway be reached before a node at distance @xmath162 . if large values of @xmath288 were obtained only for nodes at very different topological distances from the seed , the prediction shown in fig .",
    "[ proba ] would not be particularly relevant .",
    "we see in fig .",
    "[ probadis ] that nodes at the same topological distance from the seed can have very different values of @xmath161 and be therefore reached by the disease in an order which can be almost certainly predicted by measuring their values of @xmath161 .",
    "for example , fig .",
    "[ probadis ] shows that more than @xmath294 of the couples are well ranked with a probability larger than @xmath294 , even if the two nodes are at the same topological distance ( @xmath299 , @xmath158 , @xmath300 or @xmath162 ) from the seed .",
    "results are presented for a seed with large degree , and slightly better results are obtained for smaller degree seeds .    , but each graph concerns only couples of nodes at the same topological distance from the seed , @xmath243 . from top",
    "left to bottom right : @xmath299 , @xmath301 , @xmath302 and @xmath303 .",
    "the seed is frankfurt ( degree @xmath258 ) . , width=472 ]    [ probadis ]    finally , another quantitative indication of the relevance of the quantity @xmath161 is obtained , similarly to the previous subsection , by comparing the list of cities ordered either by @xmath161 or by the arrival time of the spread _ in a given realization _ ( and not the average arrival time as in the previous section ) .",
    "kendall s @xmath262 is therefore now a quantity which fluctuates from one realization to the other ( for a given seed ) , and the corresponding histograms are shown , for various seeds , in fig .",
    "[ kendall ] .",
    "the values obtained are systematically larger than @xmath304 , denoting a strong correlation between the lists ordered according to the arrival time and @xmath161 .",
    "moreover , the figure highlights how seeds with larger degrees lead to smaller values of @xmath262 .",
    "this is in agreement with the slightly better prediction capacities displayed in fig .",
    "[ proba ] when the seed has small degree .",
    "interestingly , this result can also be related to the issue of predictability studied by @xcite : the predictability of a spreading process , as measured by the similarity between two stochastic realizations with the same initial conditions , has indeed been shown to be larger when the seed has a small degree .",
    "for the list of cities sorted according either to the arrival time in a given realization or to @xmath161 .",
    "different seeds yield different histograms.,width=472 ]    [ kendall ]",
    "in this paper , we have studied a metapopulation model for the spread of epidemics on a large scale in which subpopulations ( cities ) are linked by fluxes of passengers .",
    "such models are particularly useful for the analysis of epidemics which propagate worldwide along the airline connections @xcite .",
    "they couple endogenous evolutions of epidemics inside each subpopulation with diffusion along the network of connections , which opens interesting new perspectives @xcite . in this study , we have focused on the issue of arrival times of epidemics , as a function of the seed and of the network s characteristics .",
    "we have proposed a quantity easily computable on any network which depends only on the links weights and nodes populations , and which accounts for the average arrival time of the spread in each city .",
    "this quantity allows to sort the various subpopulations according to the order of arrival of each single realization of the spread with a very good accuracy .",
    "we note that this quantity is given by a certain weighted distance computed on a directed weighted graph , and in particular that this distance selects a shortest weighted path between the seed and the various nodes .",
    "this result could therefore shed some light on the existence and properties of `` epidemic pathways '' whose relevant role was already suggested by @xcite and which certainly deserve further work . in particular , the role and relative importance of the multiple paths should be investigated .",
    "these predictive tools could play an important role in the set - up of containment measures and policies .",
    "it would also be interesting to adapt the proposed quantity to more refined or sophisticated compartmental models @xcite , or to generalize it to different scales such as the urban scale , where nodes are places like home , work or malls  @xcite .",
    "it is a pleasure to thank vittoria colizza and alessandro vespignani for discussions .",
    "a.g . and m.b",
    "also thank the school of informatics , indiana university where part of this work was performed .",
    "we are particularly grateful to vittoria colizza for sharing with us the data on the city populations and we also thank iata ( http://www.iata.org ) for making their database available to us . a.g . and",
    "are partially supported by the eu under contract 001907 ( delis ) ."
  ],
  "abstract_text": [
    "<S> we study metapopulation models for the spread of epidemics in which different subpopulations ( cities ) are connected by fluxes of individuals ( travelers ) . </S>",
    "<S> this framework allows to describe the spread of a disease on a large scale and we focus here on the computation of the arrival time of a disease as a function of the properties of the seed of the epidemics and of the characteristics of the network connecting the various subpopulations . using analytical and numerical arguments , we introduce an easily computable quantity which approximates this average arrival time . we show on the example of a disease spread on the world - wide airport network that this quantity predicts with a good accuracy the order of arrival of the disease in the various subpopulations in each realization of epidemic scenario , and not only for an average over realizations . </S>",
    "<S> finally , this quantity might be useful in the identification of the dominant paths of the disease spread .    ,    epidemiology , complex networks , world airport network . </S>"
  ]
}