{
  "article_text": [
    "pseudopotential methods , particularly within the framework of total energy plane - wave calculations , are extremely powerful for the _ ab initio _ description of large system of atoms due to their computational efficiency and suitability for structural optimisation@xcite .",
    "however , they do not yield the correct charge density of the system studied , but a ` pseudo ' charge density that does not include core electrons and is incorrect close to atomic nuclei .",
    "this precludes the direct application of these methods to the prediction of any properties of the material that depend directly on the charge density , such as hyperfine couplings or x - ray structure factors . in this paper",
    "we reconstruct the all - electron charge density for bulk silicon from a pseudopotential calculation using the method described by trail and bird@xcite ( hereafter referred to as i ) , and from this we derive the x - ray structure factors .",
    "these are then compared with experimental results and the results of other theoretical approximations and methods to assess the importance of various assumptions often made in the calculation of structure factors , and to evaluate the success of the reconstruction method .",
    "previous methods @xcite for solving this reconstruction problem have relied on the assumption that the potential in the core region is spherically symmetric in order to decouple the differential equations that must be solved , and in many cases the charge density itself is assumed to be spherical .",
    "the method used here does not require this to be the case , and we compare the structure factors resulting from assuming spherical symmetry to justify the extra effort necessary to develop an aspherical reconstruction procedure .",
    "the reconstruction method itself is based around the embedding approach of inglesfield @xcite .",
    "results from this localised calculation are used to replace the pseudo - charge density where this is incorrect , leading to the required structure factors .    in section [",
    "sec : method ] a brief summary of the reconstruction approach is given - a full description can be found in i. we describe how we obtain the structure factors from the reconstruction in section [ sec : factors ] , and compare the reconstruction results with accurate experimental and theoretical structure factors .",
    "rydberg atomic units are used throughout the paper .",
    "the first step in the reconstruction procedure is to obtain an accurate approximation for the real space single particle green function of the substrate system , in this case bulk silicon .",
    "we begin with a total energy pseudopotential calculation performed with a plane - wave basis and using the local density approximation ( lda ) for exchange and correlation . a plane - wave energy cut - off of @xmath0 ev is used and @xmath1 monkhorst - pack @xmath2-points@xcite",
    "are included in the irreducible wedge of the fcc brillouin zone .",
    "these values are more than sufficient to obtain essentially perfect convergence of the self - consistent density and potential , which allows us to attribute any errors in our results to the reconstruction procedure .",
    "a norm - conserving kerker@xcite pseudopotential is used , with a maximum core radius of @xmath3 au .",
    "as explained in i the method requires @xmath4 to be less than half the nearest - neighbour atomic separation in the crystal .",
    "the resulting self - consistent potential is used to obtain a set of eigenstates by direct matrix diagonalisation , at @xmath5-points in the irreducible wedge of the brillouin zone and with a @xmath6 ev plane - wave energy cut - off .",
    "careful tests have been carried out to confirm that these values are sufficient to provide structure factors with a precision of order @xmath7 milli - electrons / atom .",
    "the spectral representation @xcite is used to construct a green function from the set of plane - wave states .",
    "this green function is then used to obtain an embedding potential , which is a term that is added to the kohn - sham hamiltonian for the localised core region of an atom of interest .",
    "the effect of the embedding potential is to take into account the lattice of pseudo - atoms surrounding the chosen atom .",
    "the localised embedded hamiltonian is then solved self - consistently ( again using the lda ) to obtain the green function of the embedded system , from which the charge density in the core region can be obtained ( see paper i ) .",
    "the reconstruction is performed using the same parameters as in i , with the embedding radius chosen as the ` touching spheres ' radius ( in this case @xmath8 au ) .",
    "again , convergence with respect to all parameters has been thoroughly checked .",
    "the final result we arrive at is for the charge density of a single all - electron atom embedded in a lattice of pseudo - atoms .",
    "this information can be used together with the original pseudo - charge density to construct an accurate all - electron charge density and hence the structure factors for the crystal .",
    "extremely accurate experimental structure factors for silicon have been available in the literature for some time @xcite .",
    "these results have been used by a number of workers to assess the accuracy of parameterised models @xcite , flapw and other _ ab initio _",
    "methods @xcite and generalised gradient approximations to the exchange - correlation potential @xcite . in view of the accuracy and range of data available , both experimental and theoretical , the reconstructed silicon charge densities",
    "are here used to construct structure factors for comparison with experimental data and the results of flapw calculations .      to obtain the structure factors we require",
    "the fourier coefficients of the charge density , @xmath9 where @xmath10 denotes the unit cell volume and @xmath11 is the total real space charge density .",
    "@xmath12 consists of the original pseudo - charge density between atoms , and the reconstructed total charge density within the embedding sphere surrounding each atom . since this integral is a linear operation on the charge density it is possible to subtract the contribution to the pseudo - density from the embedding regions around each atom and add on the contributions from a reconstruction calculation",
    "this gives the expression @xmath13 \\label{eq2}\\ ] ] where @xmath14 are the position vectors of the atoms in the unit cell .",
    "the quantities @xmath15 and @xmath16 are the fourier integrals of the reconstructed and pseudo - densities respectively , carried out over the reconstruction sphere surrounding each atom , and are given by @xmath17 where @xmath18 is the radius of the reconstruction sphere and @xmath19 is the appropriate charge density , reconstructed or pseudo .",
    "the original pseudo - charge densities are available in reciprocal space directly from the plane - wave calculation , and the reconstructed charge densities are given as an expansion in spherical harmonics @xcite , which allows eq .",
    "( [ eq2 ] ) and ( [ eq3 ] ) to be evaluated .    for an atom situated at the origin eq .",
    "( [ eq3 ] ) takes the form @xmath20 where the charge density has been explicitly written as an expansion in spherical harmonics , and the identity @xmath21 has been used .",
    "the radial integral in eq .",
    "( [ eq4 ] ) is carried out numerically . in our calculations for silicon",
    "we choose the primitive unit cell , and reconstruct the core region of one atom chosen to be at the origin , hence the integral in eq .",
    "( [ eq4 ] ) is carried out over a sphere centred on this atom .",
    "other atoms within the unit cell must also be taken into account , and in the case of silicon there is another atom at @xmath22 related to the origin by an inversion symmetry at @xmath23 . the contribution to eq .",
    "( [ eq2 ] ) from this atom can be derived from the symmetry of the unit cell .",
    "if the atom at the origin is related to an atom at site @xmath24 by the space group operator @xmath25 ( defined by @xmath26 ) @xcite , where @xmath27 is a unitary transformation , then the integral , @xmath28 is @xmath29 by transforming coordinates this reduces to @xmath30 for silicon the atom at @xmath22 is related to the atom at the origin by the operator @xmath31 , an inversion followed by a translation . in this case",
    "the above expression , together with the expansion around the origin in spherical harmonics , yields @xmath32 where @xmath33 .",
    "the transformation results in the phase factor , and the inversion results in the power of @xmath34 present in the sum .",
    "( [ eq4 ] ) and ( [ eq5 ] ) are applied to both the reconstructed charge density and the pseudo - density ( expanded in spherical harmonics ) and are then substituted into eq .",
    "( [ eq2 ] ) to yield the structure factor as a function of the reciprocal lattice vector , @xmath35 . at first",
    "it seems a roundabout route to calculate the radial expansion of the pseudo - density only to convert this back to a reciprocal space representation , but this is the most straightforward way of replacing the pseudo - charge density with the reconstructed charge density in the sphere around each atom .",
    "one final point is the position of the origin .",
    "the coordinate system used for the reconstruction has the origin on one of the silicon atoms in the unit cell ( at @xmath36 ) , whereas the system normally chosen for crystallographic studies has the origin at the inversion centre , ( @xmath37 ) @xcite .",
    "placing the origin at the inversion centre gives real structure factors , and the origin can easily be shifted to this point by introducing an appropriate phase factor into eq.([eq1 ] ) , or simply by taking the magnitude of the complex structure factors .",
    "before comparison can be made between the theoretical and experimental results two further factors must be considered .",
    "first , the experimentally measured quantity ( normally given in the literature ) is not the fourier coefficient of the charge density , @xmath38 , but the form factor @xmath39 , which takes into account the lattice structure .",
    "this is defined as @xcite @xmath40 where @xmath41 are the indices of the reciprocal lattice vector . for @xmath41 values that satisfy the criteria @xmath42 for @xmath43 integer , the denominator on the right hand side is zero , and the structure factor is given .    the second effect that must be taken into account when correlating the theoretical and experimental results is the thermal motion of the lattice .",
    "the majority of experimental data for structure factors are taken at room temperature , and the thermal energy ` smears out ' the charge density , reducing the amplitude of the higher order structure factors .",
    "this can be described by a convolution integral in real space , which corresponds to a further correction factor in reciprocal space to give the _ dynamic structure factor _",
    "@xmath44 where @xmath45 is the debye - waller parameter @xcite .",
    "structure factors obtained from the core reconstruction are here compared with those obtained from three sources : from the simple addition of free atom core states to the original pseudo - charge density @xcite , structure factors obtained using the flapw method by zuo et al @xcite and structure factors determined experimentally by cumming and hart @xcite and saka and kato @xcite , as given by zuo et al @xcite .",
    "the pseudo+core structure factors are obtained from the charge density of the original pseudopotential calculation together with the core charge densities of the original atomic calculations used to create the pseudopotential . the contribution from the atomic core charge density",
    "is included at the atomic sites in the same manner as described above , ie @xmath46 where @xmath47 is the contribution from the core states at site @xmath14 .",
    "this structure factor is expected to show significant error , since the valence charge density will be incorrect close to the atomic sites .",
    "zuo et al @xcite calculated si structure factors using the flapw method , and they give results using the lda , and two different ggas . since the core reconstruction calculation carried out here employs the lda , the reconstruction results are only compared with the lda flapw results . for a successful reconstruction scheme we would expect to accurately reproduce these results , since the same physical approximations have been made even though the algorithmic implementation of the two methods is entirely different .",
    "we begin by comparing the theoretical form factors , uncorrected for temperature , and only for the @xmath41 values for which experimental data are available ( experimental data are given in table [ tab1 ] ) .",
    "[ fig1 ] shows the difference between the reconstructed and flapw form factors , and the difference between the pseudo+core and flapw form factors .",
    "it is apparent that the reconstruction agrees very well with the flapw results - the average absolute difference for the reconstructed results is only 3 milli - electrons / atom whereas for the pseudo+core result the average absolute difference is over 25 times greater at 76 milli - electrons / atom .      in order to compare the static structure factors given above with experimental data a value for the debye - waller parameter in eq.([eq6 ] )",
    "is required .",
    "this is commonly taken to be a free parameter and varied to minimise the error between the experimental and theoretical results .",
    "the value of @xmath45 used here is that employed by zuo et al@xcite , . in their paper values of @xmath45",
    "are obtained by minimising the error of high @xmath48 values only , for a number of different _ ab initio _ methods .",
    "these high @xmath48 structure factors depend largely on the core states of the atoms that make up the lattice , so the best values should result from methods that accurately describe the core states .",
    "zuo et al found that a calculation of these high order structure factors using the multi configuration dirac - fock ( mcdf ) method @xcite gives the best fit at high @xmath49 , and therefore took the associated @xmath45 parameter to be the best estimate .",
    "it should be noted that a better fit between experiment and theory can be obtained for a different @xmath45 value , but this would effectively use the description of a physical effect , the thermal smearing , to adjust for deficiencies in the theory , such as the lda .",
    "table [ tab1 ] gives the experimental data , with reconstructed , flapw and pseudo+core dynamic form factors .",
    "the quality of the theoretical data is assessed by two statistics - the @xmath50-factor and gof parameter .",
    "the @xmath50-factor is given by @xmath51 and the goodness of fit parameter by @xmath52 where @xmath53 is the sample variance of the @xmath54 form factor .",
    "the variance @xmath53 is taken to be the average of the estimated error for all data points in line with the approach of zuo et al , and takes the value @xmath55 .",
    ".dynamic form factors from experiment , reconstruction , flapw and pseudo+core calculations .",
    "estimated errors of the experimental data are given in parentheses , and the experimental and flapw data are taken from zuo et al @xcite .",
    "a debye - waller parameter of is used , as calculated by zuo et al @xcite .",
    "[ cols=\"^ , > , > , > , > \" , ]         from the data in table [ tab1 ] it can be seen that the reconstruction calculation describes the experimental data as well as the flapw results . for both",
    "sets of data the @xmath50-factor is , and the gof is , with the gof for the reconstruction slightly greater than that for flapw .",
    "the average absolute error @xmath56 is 10 milli - electrons / atom for both the flapw and reconstruction calculations and 70 milli - electrons / atom for the pseudo+core results .",
    "the maximum error is roughly @xmath57 milli - electrons / atom for the flapw and reconstruction results , and @xmath58 milli - electrons / atom for the pseudo+core results .",
    "[ fig2]a shows the residual error ( @xmath59 ) of the flapw results together with the error bars of the experimental data , and fig .",
    "[ fig2]b the residual error for the reconstruction calculation .",
    "the errors are very similar , even to the point of a significant correlation existing between the two .",
    "this suggests that the errors present are largely due to the theory shared by the calculations , specifically the lda .",
    "it should also be noted that the data presented by zuo et al is calculated for a lattice constant of , whereas the reconstruction calculations are carried out for .",
    "finally we give the @xmath50-factor and gof parameter comparing the pseudo+core and reconstructed results with the flapw results .",
    "the pseudo+core form factors give a @xmath50-factor and gof of and @xmath60 respectively , while the reconstruction gives and @xmath61 .",
    "one of the strengths of our reconstruction method is that it does not require spherical symmetry of the charge density in the reconstruction region near the cores of the atom . to assess the importance of the aspherical components of the charge density we replace the original pseudo - density in the reconstruction sphere with the spherical part only of the reconstructed density . fig .",
    "[ fig3 ] gives the residual error of the reconstructed form factors from the experimental data for this case .",
    "the @xmath50-factor is @xmath62 % with a gof of @xmath63 - considerably worse than for the full aspherical reconstruction . from this data",
    "it is apparent that the aspherical components of the charge density are essential for the calculation of accurate form factors .",
    "however , it is interesting to note that if we replace the _ spherical _",
    "part of the pseudo - density with the _ spherical _ part of the reconstructed density ( that is the charge density components @xmath64 for @xmath65 within the embedding sphere are given by the _",
    "pseudo_-charge density ) we obtain form factors that are almost as accurate as the flapw and fully aspherical results . in this case",
    "the @xmath50-factor is @xmath66 % , the gof is @xmath67 and the mean absolute error is @xmath68 milli - electrons / atom ) .    ) of reconstructed dynamic form factors resulting from updating the pseudo - density with",
    "the _ spherical _ part of the reconstructed charge density .",
    "note that for low @xmath48 the results are worse than for the pseudo+core results in fig .",
    "[ fig1 ] . ]",
    "in this paper all - electron states have been reconstructed successfully from a total energy pseudopotential calculation , giving an accurate charge density in the region near atomic sites .",
    "this reconstruction is carried out using the embedding method described in a recent paper @xcite .",
    "the reconstruction calculation itself uses a scalar relativistic description for the valence states , in a fully aspherical potential and using lapw basis functions .",
    "the core states are calculated fully relativistically by direct solution of the dirac equation in a spherical average of the self consistent potential .",
    "it is apparent that the reconstruction method itself has a lot in common with flapw methods .",
    "structure factors have been derived from the reconstructed silicon charge density for comparison with accurate experimental data and flapw calculations .",
    "agreement is excellent with both the flapw and reconstructed form factors agreeing with experimental results with an average absolute error of @xmath69 milli - electrons / atom while the experimental data itself is accurate to @xmath70 milli - electrons / atom .",
    "the flapw and reconstructed form factors agree extremely well with each other , with an average absolute difference of @xmath71 milli - electrons / atom .",
    "in addition to this the residual errors for both methods of calculation show significant correlation , indicating that they arise from the physical approximations common to both methods .",
    "m. c. payne , m. p. teter , d. c. allan , t. a. arias and j. d. joannopoulos , rev .",
    "64 * , 4 1045 ( 1992 ) .",
    "j. r. trail and d. m. bird , phys .",
    "b * 60 * , 7863 ( 1999 ) .",
    "j. r. gardner and n. a. w. holzwarth , phys.rev .",
    "b * 33 * , 10 7139 ( 1986 ) .",
    "j. vack and a. imunek , j.phys.:condens .",
    "matter * 6 * , 3025 ( 1994 ) .",
    "v. kuzmiak , j.zavadil and k. nsk , phys .",
    "sol.(b ) * 168 * , 547 ( 1991 ) .",
    "b. meyer , k. hummler , c. elssser and m. fhnle , j.phys . : condens .",
    "matter * 7 * , 9201 ( 1995 ) .",
    "j. e. inglesfield , j.phys .",
    "c * 14 * , 3795 ( 1981 ) . h. j. monkhorst and j. d. pack , phys .  rev .",
    "b * 13 * , 12 5188 ( 1976 ) .",
    "g. p. kerker , j.phys .",
    "c * 13 * , l189 ( 1980 ) . p.",
    "m. morse and h. feshbach , _ methods of theoretical physics _",
    "( plenum press , new york , 1953 ) .",
    "s. cumming and m. hart , aust",
    ".  j.phys . * 41 * , 423 ( 1988 ) .",
    "p. j. e. aldred and m. hart , proc .",
    "r.  soc .",
    "a * 332 * , 223 ( 1973 ) .",
    "r. teworte and u. bonse , phys .",
    "b * 29 * , 2102 ( 1984 ) .",
    "t. saka and n. kato , acta  crystallogr .",
    "a * 42 * , 469 ( 1986 ) .",
    "m. deutsch , phys .",
    "b * 45 * , 2 646 ( 1992 ) .",
    "a. zunger and m. deutsch , phys .",
    "b * 47 * , 15 9385 ( 1993 ) .",
    "j. m. zuo , p. blaha and k. schwarz , j.phys .",
    ":  condes.matter * 9 * , 7541 ( 1997 ) . s. l. altmann , _ band theory of solids : an introduction from the point of view of symmetry _ ( oxford university press , oxford , 1991 ) .",
    "t. hahn ( ed . ) , _ international tables for crystallography : vol .",
    "a space - group symmetry _ ( kluwer academic publishers , dordrecht , 1995 ) i. p. grant , b. j. mckenzie , p. h. norrington , d. f. mayers and n. c. pyper , comput .",
    ".  commun .",
    "* 21 * , 207 ( 1980 ) ."
  ],
  "abstract_text": [
    "<S> highly accurate experimental structure factors of silicon are available in the literature , and these provide the ideal test for any _ ab initio _ method for the construction of the all - electron charge density . in a recent paper [ j. r. trail and d. m. bird , phys .  </S>",
    "<S> rev .  </S>",
    "<S> b * 60 * , 7863 ( 1999 ) ] a method has been developed for obtaining an accurate all - electron charge density from a first principles pseudopotential calculation by reconstructing the core region of an atom of choice . here </S>",
    "<S> this method is applied to bulk silicon , and structure factors are derived and compared with experimental and full - potential linear augmented plane wave results ( flapw ) . </S>",
    "<S> we also compare with the result of assuming the core region is spherically symmetric , and with the result of constructing a charge density from the pseudo - valence density + frozen core electrons . </S>",
    "<S> neither of these approximations provide accurate charge densities . </S>",
    "<S> the aspherical reconstruction is found to be as accurate as flapw results , and reproduces the residual error between the flapw and experimental results . </S>"
  ]
}