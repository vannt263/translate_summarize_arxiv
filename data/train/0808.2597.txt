{
  "article_text": [
    "numerical simulations of the inspiral and merger of binary black holes ( bbh ) investigate einstein s equations in the nonlinear regime where analytical progress often proves intractable .",
    "the primary goal of these simulations is the computation of gravitational waveforms necessary to analyze output from gravitational wave detectors like the `` laser interferometric gravitational wave observatory '' ( ligo ) .",
    "breakthroughs in 2005 have yielded two ways to simulate bbh evolutions : the _ generalized harmonic system _ ( ghs ) with excision  @xcite and the baumgarte - shapiro - shibata - nakamura ( bssn ) system with _",
    "moving punctures _ @xcite .",
    "over the last few years numerical relativity has seen rapid progress along both fronts .    the evolution of a binary black hole proceeds through three phases . during the _ inspiral _ phase , the two separate black holes orbit about each other , with the orbit gradually tightening due to emission of angular momentum and energy via gravitational radiation . at small separation ,",
    "the black holes encounter a dynamical instability , plunge rapidly toward each other and merge .",
    "this _ merger _",
    "phase results in a single , larger , highly distorted black hole which subsequently relaxes to a stationary black hole during the _ ringdown _ phase . merger and ringdown",
    "happen quickly , together lasting about @xmath0 , where the black hole mass @xmath1 sets both the spatial and temporal scales .",
    "therefore , merger and ringdown are comparatively easy to simulate at modest computational cost .",
    "in contrast , simulation of the inspiral phase is a daunting computational challenge . because the orbital period increases rapidly with separation of the black holes , simulation of even a modest number of orbits requires much longer evolutions .",
    "for example , the last 10 orbits of an equal mass non - spinning binary black hole last about @xmath2 , already an order of magnitude longer than merger and ringdown . beyond necessarily longer time - spans ,",
    "inspiral simulations also require higher accuracy .",
    "indeed , gravitational wave flux decreases with separation , and it must be accurately resolved in order to compute the correct phasing of the gravitational waves .    to date all binary black hole simulations have employed explicit time - stepping , generally the method of lines with an explicit ode scheme like the classical fourth - order runge - kutta method . without question",
    "explicit time - stepping is appropriate for both merger and ringdown .",
    "however , during the inspiral phase , the relevant physical time - scale on which the binary separation changes is much longer than the dynamical time - scale @xmath1 of each black hole .",
    "nevertheless , the courant condition associated with an explicit time - stepper heuristically requires that time - steps are proportional to the smallest grid spacing , and therefore explicit binary evolutions use time - steps that are typically of the order @xmath3 to @xmath4 .",
    "for instance , a recent 16 orbit simulation  @xcite required nearly 200,000 explicit time - steps .",
    "this issue becomes more pronounced when modeling black holes with unequal masses @xmath5 .",
    "the orbital period is proportional to the total mass @xmath6 , whereas the courant limit dictates that the time - step is proportional to the smaller mass @xmath7 . the number of explicit time - steps needed to ensure numerical stability then scales like @xmath8 . due to these reasons ,",
    "only a few binary black hole simulations with mass ratios above 4:1 have been performed  @xcite , and these are quite short and computationally expensive .",
    "courant limitations are likewise more severe for simulations of spinning black holes , which also require higher spatial resolution close to the black holes .",
    "these arguments suggest that some form of implicit time - stepping would more efficiently treat the inspiral phase , and this paper begins the study of alternative ways to carry out temporal integration of orbiting binaries in the early phase of their evolution .",
    "our approach is based on modern implicit - explicit ( imex ) ode solvers  @xcite and classical multidomain spectral methods , and in particular those  @xcite used for solving elliptic problems ( it turns out that our implicit equations correspond to elliptic pde ) .",
    "the generalized harmonic formulation  @xcite rewrites einstein s equations as 10 scalar wave equations for the components of the metric , which are coupled through nonlinear lower order terms . because the principal part is just the scalar wave operator on a curved background spacetime , we consider here the model problem of evolving a scalar field on a single black - hole background .",
    "imex schemes like the ones pursued here are not the only possible approach to circumvent the courant - friedrichs - lewy condition . for instance ,",
    "hennig and ansorg  @xcite explore spacetime spectral methods to solve scalar wave equations .",
    "the organization of the paper is as follows .",
    "the upcoming section [ sec : prelim ] gives a brief overview of imex methods , using the specific example of additive runge - kutta ( ark ) .",
    "it also briefly collects the relevant first - order equations describing the propagation of scalar waves on a generic curved spacetime , and discusses boundary conditions for such equations .",
    "section [ sec : impequations ] contains our main analytical discussion , and it focuses on the novelty of solving the implicit equations which arise in our time - stepping strategy .",
    "much of this theoretical analysis is general , but we eventually settle on the concrete example of a scalar field propagating on the schwarzschild geometry in kerr - schild coordinates .",
    "section [ sec : numtests ] describes the results of several numerical experiments carried out for the schwarzschild scenario .",
    "the conclusion in sec .",
    "[ sec : conclusion ] summarizes our findings and discusses steps necessary for application of imex methods to the ultimate target problem , binary black hole inspiral .",
    "finally , three appendices collect some technical calculations omitted in section [ sec : impequations ] .",
    "from the computational point of view , all imex methods require that we are able to numerically solve an implicit equation . for concreteness , we here consider ark3(2 ) and ark4(3 ) , two imex additive runge - kutta schemes introduced in @xcite .",
    "these schemes share the same algorithmic structure ( only their sets of butcher tableaux differ ) .",
    "ark3(2 ) is a 4-stage third - order scheme with a second - order embedded scheme , while ark4(3 ) is a 6-stage fourth - order scheme with a third - order embedded scheme .",
    "although we will not report on it here , we have also considered various versions of _ semi - implicit spectral deferred corrections _ ( sisdc ) @xcite as an alternative to ark .",
    "the nature of the sisdc algorithm is quite different , but its implementation also requires that we are able to solve ( in this case at each substep ) an implicit equation of the same form .    we will not discuss accuracy and stability properties of ark . our purpose here is simply to describe the algorithm , highlight what is needed for implementation , and focus on the origin and structure of the implicit equation .",
    "when considering first - order systems for scalar wave propagation below , we will adopt what is essentially a reversed semidiscrete picture .",
    "that is to say , we consider time as discrete , but retain the spatial continuum .",
    "when adopting that picture , we will write down a continuum implicit equation ( a spatial differential equation ) that corresponds to the implicit equation appearing in the ark algorithm .",
    "although this should not prove cause for confusion , we have nevertheless raised this issue now , since we adopt a similar notation whether or not the spatial continuum is retained .    mostly adopting the notation of @xcite ,",
    "we begin with a generic initial value problem @xmath9}(t,\\boldsymbol{u } ) , \\qquad \\boldsymbol{u}(t_0 ) = \\boldsymbol{u}_0,\\ ] ] with @xmath10 a vector of unknowns . adopting a @xmath11-additive scheme ,",
    "we have split the right - hand side @xmath12 into explicit ( nonstiff ) @xmath13}$ ] and implicit ( stiff ) @xmath14}$ ] sectors .",
    "the ark schemes specify a rule for advancing the vector @xmath15 at a present time - step @xmath16 ( perhaps @xmath17 ) to the vector @xmath18 at the next time - step @xmath19 , and this rule requires the construction of @xmath20 stage values @xmath21 , @xmath22 , corresponding to intermediate times @xmath23 .",
    "the first stage is given by @xmath24 , and the remaining stage values are determined sequentially by @xmath25 , \\quad 2 \\le",
    "i \\leq s. \\label{eq : uidef}\\end{aligned}\\ ] ] after all the stages have been computed , the updated solution is given by the stage expansion @xmath26 .",
    "\\label{eq : unp1}\\end{aligned}\\ ] ] the parameter matrices @xmath27 and @xmath28 , along with the coefficients @xmath29 and @xmath30 , stem from butcher tableaux collected in @xcite .",
    "erk stands for _ explicit runge - kutta _ , and esdirk for _ explicit singly diagonally implicit runge - kutta_. in the esdirk acronym , the _ explicit _ refers to the trivial first stage , and _ diagonally implicit _ to the fact that the sum in ( [ eq : uidef ] ) stops at @xmath31 rather than @xmath20 .    for the explicit sector ,",
    "@xmath32 for @xmath33 .",
    "therefore , in eq .",
    "( [ eq : uidef ] ) the first term in the sum depends solely on already known stages , @xmath34 .",
    "in contrast , for the implicit sector , @xmath35 for @xmath36 , with @xmath37 unless @xmath38 ( the _ singly _ in esdirk indicates that the diagonal elements @xmath39 all equal the same constant @xmath40 ) .",
    "the term @xmath41 turns eq .",
    "( [ eq : uidef ] ) into an implicit equation for @xmath21 .",
    "implementation of an ark scheme therefore requires that we are able to solve ( at each stage after the first ) an _ implicit equation _ of form @xmath42 where @xmath43 and @xmath44 depends on the previous stage values .",
    "our goal is to solve the scalar wave equation @xmath45 with a given source term @xmath46 .",
    "we consider eq .",
    "( [ eq : scalarwave2ndorder ] ) on a generic curved background with line - element given in the usual 3 + 1 decomposition , @xmath47 here @xmath48 is the induced metric on @xmath49 hypersurfaces , @xmath50 is the lapse function , and @xmath51 is the shift vector .",
    "these quantities are known functions of space @xmath52 and time @xmath53 , where lower - case latin indices @xmath54 denote spatial components running over @xmath55 .    following holst _",
    "et al . _",
    "@xcite , we rewrite eq .",
    "( [ eq : scalarwave2ndorder ] ) as the following first - order system :    [ eq : firstorderscalarwave ] @xmath56    apart from the possible inhomogeneous forcing term @xmath57 in ( [ eq : pidot ] ) , these are eqs .",
    "( 1416 ) of @xcite .",
    "@xmath58 is a new evolved variable representing the time derivative of @xmath59 , and eq .",
    "( [ eq : psidot ] ) is the definition of @xmath58 .",
    "the @xmath60 represent the spatial derivatives of @xmath59 .",
    "the quantities @xmath61 and @xmath62 depend only on the background spacetime , @xmath63 , \\label{eq : k}\\end{aligned}\\ ] ] where @xmath62 is the trace of the extrinsic curvature tensor and @xmath64 .",
    "these formulas for @xmath61 and @xmath62 are respectively eqs .",
    "( 17 ) and ( 18 ) of @xcite .",
    "solutions of the first - order system eqs .",
    "( [ eq : firstorderscalarwave ] ) are equivalent to those of eq .",
    "( [ eq : scalarwave2ndorder ] ) only if the constraint @xmath65 vanishes .",
    "the constraint provides an important link between eq .",
    "( [ eq : psidot ] ) and ( [ eq : phidot ] ) , as the latter equation is derived by taking the time derivative of the constraint : @xmath66 thus , the right - hand side of eq .",
    "( [ eq : phidot ] ) is the gradient of the right - hand side of eq .",
    "( [ eq : psidot ] ) , with @xmath67 replaced by @xmath68 .",
    "boundary conditions relative to a boundary element with outward - pointing unit normal @xmath69 are described in terms of the characteristic fields @xmath70 where @xmath71 indicates projection tangential to the boundary element .",
    "relative to the time axis @xmath72 , the coordinate speeds of these fields are respectively @xmath73 a characteristic field requires a boundary condition whenever its characteristic speed is negative .",
    "the scenario we consider later , that is wave propagation on a schwarzschild black hole , has two boundaries : first , an outer spherical boundary @xmath74 where @xmath75 , @xmath76 and @xmath77 are incoming and require boundary conditions .",
    "second , an inner spherical boundary @xmath78 which is inside the black hole horizon and surrounds the singularity at the center of the black hole .",
    "on the inner boundary all characteristic fields are outgoing ( i.  e.  moving toward the center of the black hole ) , and boundary conditions must not be imposed on it .",
    "this pure outflow boundary results in several interesting features of the present work to be discussed below . if @xmath74 and @xmath78 are adapted to the background symmetry ( i.  e.  round spheres , which they need not be for our numerical work ) , then @xmath79 on @xmath80 and @xmath81 on @xmath82 .",
    "the boundary condition on @xmath77 is physical ; this boundary condition and the choice of initial data determines which solution of the second - order wave equation  ( [ eq : scalarwave2ndorder ] ) is computed . in this paper ,",
    "we typically choose the initial data , the boundary values of @xmath77 , and the external forcing @xmath83 such that the solution follows a prescribed exact solution .",
    "boundary conditions on the fields @xmath75 and @xmath76 , if necessary , are chosen to ensure that the constraint @xmath84 vanishes on the boundary .",
    "solutions to the first - order system ( [ eq : firstorderscalarwave ] ) which violate the constraint @xmath85 are not admitted either by the scalar equation ( [ eq : scalarwave2ndorder ] ) or the reduced system which arises from setting @xmath86 in ( [ eq : firstorderscalarwave ] ) .",
    "the boundary conditions on @xmath75 and @xmath76 rule out these spurious solutions to the extended system ( [ eq : firstorderscalarwave ] ) , provided that the initial data also satisfies the constraint .",
    "such _ constraint preserving boundary conditions _ have been derived by holst et al .",
    "@xcite and refined by lindblom et al .",
    "the implicit equations that we encounter in our use of ark methods require boundary conditions that parallel those of the evolution problem .",
    "we will therefore consider @xmath77 as given boundary data for the implicit problems , as well as the boundary data @xmath87 , whenever necessary .",
    "the ark algorithm described in sec .",
    "[ subsec : imex - ark ] is applicable only to systems of ode , and for the case at hand such an ode system arises upon spatial approximation of eqs .",
    "( [ eq : firstorderscalarwave ] ) via a pseudospectral collocation method ( see , for example , @xcite for details )",
    ". however , as mentioned earlier , we find it convenient to retain the spatial continuum in our discussion , and so write down the continuum implicit equations ( pdes ) which , upon spatial approximation , yield the relevant algebraic implicit equations appearing in our imex algorithms .",
    "equations  ( [ eq : firstorderscalarwave ] ) have the form of eq .",
    "( [ eq : generaleq ] ) for the evolved variables @xmath88 .",
    "we will consider a number of possibilities for splitting the right - hand side of eqs .",
    "( [ eq : firstorderscalarwave ] ) into stiff ( implicit ) @xmath89 and nonstiff ( explicit ) @xmath90 sectors , but always treat the system s principal part ( i.  e.  all spatial derivatives ) implicitly .",
    "each of our possible choices for the imex splitting is specified by writing down the field components of the implicit equation ( [ eq : abstractimpeqn ] ) . treating implicitly the first two terms from each right - hand side in  ( [ eq : firstorderscalarwave ] ) , and possibly the forcing term @xmath57 from ( [ eq : pidot ] ) , we get * case ( i ) * :    [ eq : case1 ] @xmath91    with @xmath92 for implicit treatment of @xmath57 , and @xmath93 otherwise .",
    "therefore , as with the other cases to follow , case ( i ) is actually two cases .",
    "a second , and similar , set of equations stems from also treating implicitly all terms in the right - hand side of ( [ eq : phidot ] ) .",
    "namely , * case ( ii ) * :    [ eq : case2 ] @xmath94    finally , treating all or nearly all terms implicitly , we arrive at * case ( iii ) * :    [ eq : case3 ] @xmath95    for each of our three cases , we note that the inhomogeneity @xmath96 corresponds to the term in ( [ eq : abstractimpeqn ] ) built with ark stage values , cf .",
    "( [ eq : uidef ] ) .",
    "while we have considered only three possible imex splittings ( really six including the @xmath97 choice ) , other variations are of course possible . ignoring the subcases afforded by the choice of @xmath98 , case ( i ) corresponds to the minimal implicit sector for which our methods are applicable , case ( iii ) to the fully implicit scenario , and case ( ii ) to a scenario in the middle .",
    "note that for cases ( ii ) and ( iii ) the gradient of the left - hand side of the @xmath59 equation [ eqs .",
    "( [ eq : psiimp2 ] ) and ( [ eq : psiimp3 ] ) , respectively ] gives the corresponding @xmath68 equation [ eqs .",
    "( [ eq : phiimp2 ] ) and ( [ eq : phiimp3 ] ) , respectively ] , up to the replacement @xmath99 .",
    "this mirrors the structure of the first - order pde , cf .",
    "the remark after eq .",
    "( [ eq : dt_c ] ) .",
    "while we do not solve these first - order systems numerically , we expect that the following theoretical considerations are relevant .",
    "we view each set [ eqs .",
    "( [ eq : case1 ] ) , ( [ eq : case2 ] ) , or ( [ eq : case3 ] ) ] of implicit equations as a _ spatial _",
    "boundary value problem subject to dirichlet boundary conditions on the same characteristic fields ( [ eq : charvars ] ) as those described in the last paragraph of [ subsec : firstorderscalarwave ] .",
    "in other words , the choice of boundary data for these implicit solves corresponds to the same boundary data controlled in the _ evolution _ initial - boundary - value problem .",
    "this physically reasonable viewpoint is analyzed further in an appendix .",
    "on the outer boundary @xmath74 where @xmath100 , we fix @xmath75 , @xmath76 , and @xmath77 as boundary data .",
    "typically , @xmath101 on @xmath78 , so no boundary conditions on @xmath75 and @xmath76 are imposed .",
    "if @xmath102 on @xmath78 , then we would fix @xmath77 as boundary data .",
    "this inequality would hold , for example , in our schwarzschild scenario , provided @xmath78 were chosen as a surface _ outside _ the horizon .",
    "now , each set [ eqs .",
    "( [ eq : case1 ] ) , ( [ eq : case2 ] ) , or ( [ eq : case3 ] ) ] involves the first - order derivatives of 5 fields , whence we expect that 5 boundary conditions are needed to uniquely determine a solution .",
    "indeed , @xmath58 and @xmath68 should be determined by ( [ eq : case1]b , c ) , ( [ eq : case2]b , c ) or ( [ eq : case3]b , c ) and specification of the following 4 boundary conditions : @xmath76 and @xmath77 on @xmath74 , and @xmath77 on @xmath78 ( provided @xmath103 ) . once @xmath58 is known , the remaining equation for @xmath59 could then be integrated subject to a remaining fifth boundary condition for @xmath75 on @xmath74 .",
    "we analyze a simplified system which justifies this counting argument in appendix  [ sec : bcsfirstimpeqns ] .    for the schwarzschild scenario when @xmath78 lies inside the horizon",
    ", the situation is different .",
    "let us view @xmath78 as spherically symmetric , and let us extend the normal @xmath104 to @xmath78 smoothly into the volume such that @xmath104 is normal to @xmath105 spheres , and normalized such that @xmath106 .",
    "combination of the first - order implicit equations for @xmath58 and @xmath68 yields @xmath107 = b_\\pi - n^k   b_{\\phi_k},\\ ] ] where we define @xmath108 even away from @xmath78 . on the horizon @xmath109 , and thus eq .  ( [ eq : u1-implicit ] ) determines @xmath77 algebraically .",
    "integration of eq .",
    "( [ eq : u1-implicit ] ) inward from the horizon to @xmath78 then results in the value of @xmath77 on @xmath78 .",
    "thus @xmath77 on @xmath78 is determined self - consistently by the equations , and we are not free to pick it .    as with the evolution initial - boundary - value problem , in our implicit boundary value problems",
    "we relate some boundary data to the constraint @xmath110 .",
    "first , we identify the tangential components @xmath111 with the boundary data @xmath112 .",
    "in other words , on @xmath74 we set @xmath113 , where @xmath114 is a fixed function ( typically zero ) .",
    "along with the boundary data @xmath77 , these tangential components then allow for recovery of @xmath58 and @xmath68 .",
    "second , writing ( [ eq : psiimp1 ] ) , ( [ eq : psiimp2 ] ) , or ( [ eq : psiimp3 ] ) as @xmath115 we may now view all terms on the right - hand side as a given source . rather than fixing @xmath116 as boundary data on @xmath74 , we equivalently fix @xmath117 , since @xmath118 can then be recovered from the last expression evaluated at @xmath74 .",
    "we may then formally view our outer boundary conditions on @xmath74 as controlling @xmath77 and @xmath110 .    for cases ( ii ) and ( iii ) the listed implicit equations determine an implicit equation for the constraint . indeed , notice that the pairs ( [ eq : psiimp2]),([eq : phiimp2 ] ) and ( [ eq : psiimp3]),([eq : phiimp3 ] ) are the same .",
    "if we subtract , say , ( [ eq : phiimp3 ] ) from the cartesian derivative of ( [ eq : psiimp3 ] ) , then we arrive at @xmath119 an equation we may alternatively express in terms of the lie derivative as @xmath120 contraction of ( [ eq : constraintimp ] ) on @xmath121 yields @xmath122 in principle , eq .",
    "( [ eq : lieconstraintimp ] ) might be integrated along the shift , say inward from the outer boundary @xmath74 where dirichlet boundary conditions on @xmath110 are set .",
    "the ark scheme should preserve the constraint ; i.e.  if @xmath123 initially , it should remain zero .",
    "we investigate this point by combining ( [ eq : uidef ] ) and ( [ eq : abstractimpeqn ] ) into a formula for the @xmath31th stage source , @xmath124 , \\quad 2 \\le",
    "i \\leq s , \\label{eq : bexpression}\\end{aligned}\\ ] ] where we recall that @xmath125 .",
    "for both cases ( ii ) and ( iii ) , the @xmath59 and @xmath68 components of @xmath126 vanish , whereas @xmath127 with @xmath128 indicating an expression irrelevant for the present discussion . therefore",
    ", if the previous stage values @xmath129 , @xmath130 obey the constraint ( [ eq : c ] ) , that is @xmath131 , then the @xmath31th source @xmath132 will satisfy @xmath133 . as a result , ( [ eq : constraintimp ] ) will be a homogeneous equation for the constraint @xmath134 at the @xmath31th stage , with the solution @xmath135 in the interior because @xmath136 has been enforced on the boundary .",
    "we will draw on these observations below .      in principle",
    ", one could solve directly the first - order implicit equations given in eqs .",
    "( [ eq : case1 ] ) , ( [ eq : case2 ] ) , or  ( [ eq : case3 ] ) , and we have done so in spherical symmetry .",
    "however , for the more demanding 3d cases leading toward our ultimate goal of handling binary black holes , we would like to use the multidomain spectral ellipticsolver  @xcite which is part of the spectral einstein code spec used for binary black hole evolutions  @xcite .",
    "the ellipticsolver has been written to handle second - order elliptic equations . moreover , preconditioning strategies for second - order elliptic equations are well understood relative to those for first - order equations . for these reasons , we have chosen not to directly solve first - order equations .",
    "rather , we first solve a single second - order scalar equation for @xmath59 , one stemming from combination of the above equations and subject to appropriate boundary conditions discussed below .",
    "this @xmath59 equation is different for each of the three cases , and it is only for cases ( ii ) and ( iii ) that we can show , at least formally , that our solution process is consistent with solving the original first - order set of equations . once a solution @xmath59 has been determined for each case , we obtain @xmath58 algebraically using ( [ eq : psiimp1 ] ) , ( [ eq : psiimp2 ] ) , or ( [ eq : psiimp3 ] ) , all the same equation .",
    "finally , we recover @xmath68 from @xmath59 via differentiation .",
    "therefore , at each stage in our imex algorithms we perform what amounts to a naive constraint projection .",
    "this is necessary for case ( i ) , but would seem not strictly necessary for cases ( ii ) and ( iii ) .",
    "both ark3 and ark4 have explicit first stages , for which no implicit solve needs to be done . nevertheless , in order to achieve stability in our imex evolutions",
    ", we must perform the naive constraint projection on the first - stage fields , at least when such projection is carried out on the other stages .",
    "the discussion after eq .",
    "( [ eq : bexpression ] ) pertains to exact arithmetic , whereas round off errors in the stage expansion ( [ eq : unp1 ] ) will result in a @xmath18 which violates the constraints .",
    "while this violation is negligible over a single time - step , such violations appear to accumulate .",
    "projection of the first - stage fields guarantees that @xmath137 throughout the evolution .",
    "let us first derive the scalar equation for @xmath59 associated with case ( i ) , eqs .",
    "( [ eq : case1 ] ) . combination of ( [ eq : case1]a , b ) eliminates the term proportional to @xmath58 , @xmath138 whereas from ( [ eq : phiimp1 ] ) we obtain @xmath139 the difference of the last two equations is independent of @xmath58 , @xmath140 next , we use the constraint  ( [ eq : c ] ) to replace @xmath68 by @xmath141 , and find @xmath142 which is our second - order @xmath59 equation for case ( i ) .",
    "derivation of the @xmath59 equation for cases ( ii ) and ( iii ) is more complicated , but nevertheless follows the same steps taken for case ( i ) .",
    "for example , eqs .",
    "( [ eq : case2]a , b ) again lead to ( [ eq : psipicombo ] ) . similar to before , we eliminate the term @xmath143 with the contraction of @xmath144 on the @xmath68 equation ( [ eq : phiimp2 ] ) . however , now this third equation is more complicated and features an extra factor of @xmath58 .",
    "therefore , we first use ( [ eq : psiimp2 ] ) to rewrite ( [ eq : phiimp2 ] ) as @xmath145 where @xmath146 . finally , we contract the last equation on @xmath144 , subtract the result from ( [ eq : psipicombo ] ) , and then use ( [ eq : c ] ) to replace all @xmath68 terms by @xmath147 .",
    "these steps yield the following equation for case ( ii ) : @xmath148\\partial_k\\psi -\\alpha^2 \\big(n^2 g^{jk } - { v}^j { v}^k\\big ) \\partial_j\\partial_k\\psi \\nonumber \\\\ &   = ( 1+\\alpha { v}^k a_k ) b_\\psi - \\alpha n b_\\pi - \\alpha { v}^k   b_{\\phi_k } - \\epsilon\\alpha^2 n^2 s \\nonumber \\\\ & \\quad - \\alpha^2 n^2",
    "g^{jk}\\partial_j \\mathcal{c}_k + \\alpha^2 v^j\\partial_j ( v^k\\mathcal{c}_k ) -\\alpha v^k\\mathcal{c}_k .",
    "\\label{eq : mediumelliptic}\\end{aligned}\\ ] ] even more involved calculations using eqs .",
    "( [ eq : case3 ] ) similarly yield @xmath149\\psi - \\big [ & 2\\alpha{v}^k + \\alpha^2\\big ( a_j { v}^j { v}^k - { v}^j \\partial_j { v}^k - n^2 j^k -{v}^k nk \\big ) \\big]\\partial_k \\psi \\nonumber \\\\ -\\alpha^2\\big(n^2 g^{jk}-{v}^j { v}^k\\big)\\partial_j\\partial_k\\psi & = \\big[1+\\alpha \\big({v}^k a_k - nk\\big)\\big]b_\\psi - \\alpha n b_\\pi - \\alpha { v}^k b_{\\phi_k }   \\nonumber \\\\ & \\quad - \\epsilon\\alpha^2 n^2 s + \\alpha^2 n^2 \\big ( j^k \\mathcal{c}_k -g^{jk}\\partial_j \\mathcal{c}_k\\big ) \\nonumber \\\\ & \\quad + \\alpha^2 v^j\\partial_j ( v^k\\mathcal{c}_k ) -\\alpha v^k\\mathcal{c}_k , \\label{eq : largeelliptic}\\end{aligned}\\ ] ] the second - order @xmath59 equation for case ( iii ) . notice that neither ( [ eq : smallelliptic ] ) , ( [ eq : mediumelliptic ] ) , nor ( [ eq : largeelliptic ] ) features derivatives of @xmath150 .",
    "the absence of @xmath44 derivatives indicates that we have not differentiated any of our original first - order equations .",
    "let us now consider the corresponding boundary conditions for the second - order equations ( [ eq : smallelliptic ] ) , ( [ eq : mediumelliptic ] ) , ( [ eq : largeelliptic ] ) .",
    "combination of ( [ eq : psiimp1 ] ) , the same for all cases , with the formula ( [ eq : charvars ] ) for @xmath77 yields @xmath151 using the constraint @xmath152 , we therefore find @xmath153 as our boundary condition .",
    "if @xmath78 lies inside the horizon , we shall not impose ( [ eq : psibcumc ] ) on @xmath78 , as the initial boundary value problem for eqs .",
    "( [ eq : firstorderscalarwave ] ) does not require an inner boundary condition .",
    "for a schwarzschild spacetime in kerr - schild coordinates , sec .",
    "[ sec : schwarzschild ] shows that an outer boundary condition alone is indeed sufficient . in this setting ,",
    "the inner boundary condition for the second - order @xmath59 equation is replaced by a regularity condition across the horizon .",
    "numerical tests in sec .",
    "[ sec : numtests ] indicate that this viewpoint holds in a more general setting . while we have been careful to retain all constraint terms in deriving eqs .",
    "( [ eq : smallelliptic ] ) ,  ( [ eq : mediumelliptic ] ) ,  ( [ eq : largeelliptic ] ) and ( [ eq : psibcumc ] ) , in practice we have set @xmath123 before solving these equations numerically .    at least for cases ( ii ) and",
    "( iii ) , the following argument formally proves that in lieu of directly solving the full set of first - order implicit equations ( [ eq : case2 ] ) or ( [ eq : case3]) we may instead take the following steps : solve ( [ eq : lieconstraintimp ] ) , solve either ( [ eq : mediumelliptic ] ) or ( [ eq : largeelliptic ] ) ( the single second - order @xmath59 equation ) , and then recover @xmath58 from eq .",
    "( [ eq : psiimp2 ] ) or ( [ eq : psiimp3 ] ) and @xmath68 from eq .",
    "( [ eq : c ] ) . in combining the first - order equations to produce the single second - order @xmath59 equation ,",
    "we have not differentiated the original equations , rather second derivative terms have arisen via substitution with the constraint @xmath154 .",
    "therefore , the @xmath59 equation is truly a second - order equation only if we interpret the constraint terms appearing on the right - hand side as part of the inhomogeneity . to achieve this interpretation",
    ", we assume that we may integrate the system ( [ eq : lieconstraintimp ] ) , inward from the outer boundary @xmath74 , where we fix @xmath155 .",
    "these boundary conditions are consistent , as we have earlier argued that @xmath155 is part of the boundary data for the original first - order set of implicit equations .",
    "we now specialize the above equations to the schwarzschild geometry written in kerr - schild coordinates .",
    "the line - element is @xmath156 where the lapse , radial lapse , and shift are given in terms of the mass parameter @xmath1 by @xmath157 this is the same line - element as given in eq .",
    "( 59 ) of @xcite .",
    "consider the cartesian coordinates @xmath158 stemming from the polar coordinates @xmath159 via the standard formulas : @xmath160 .",
    "we introduce a radial vector @xmath161 which is not normalized with respect to the spatial metric determined by ( [ eq : kerrschild],[eq : geometry ] ) .",
    "the vector @xmath162 is the outward - pointing unit normal to the spherical foliation of a spacelike level-@xmath53 hypersurface . with respect to",
    "the cartesian coordinates @xmath158 , we may express the spatial metric and inverse metric as follows : @xmath163 here @xmath164 is the flat metric , and @xmath165 . to avoid ambiguity as to which",
    "metric ( @xmath48 or @xmath166 ) has been used to lower the index , we will not write @xmath167 . with the above formulas for the cartesian components of the metric and eqs .",
    "( [ eq : jk],[eq : k ] ) , we find that @xmath168\\nu^k , \\qquad k = \\frac{1}{n}\\left[({v}^r)'+ \\frac{2}{r}{v}^r   + \\frac{l'}{l}{v}^r \\right ] .",
    "\\label{jkandkforsch}\\ ] ] to reach these equations , we have used the following identities ( valid in the cartesian coordinate system ) : @xmath169 , @xmath170 , @xmath171 , and @xmath172 .",
    "equations  ( [ eq:3metric ] ) and  ( [ jkandkforsch ] ) hold for any choice of @xmath50 , @xmath173 and @xmath174 .",
    "specializing to the values given in eq .",
    "( [ eq : geometry ] ) , we obtain @xmath175    for the chosen schwarzschild background and coordinates , we now show that our solution procedure involving the second - order @xmath59 equation ( [ eq : mediumelliptic ] ) or ( [ eq : largeelliptic ] ) is equivalent to solving the original set of first - order equations ( [ eq : case2 ] ) or ( [ eq : case3 ] ) . in establishing this claim",
    "we must show that ( [ eq : constraintimp ] ) can be integrated inward from the outer boundary @xmath74 at @xmath176 , and that a _ regular _ solution to the @xmath59 equation is determined by the outer boundary condition alone .",
    "we consider the integration of ( [ eq : constraintimp ] ) in appendix [ sec : impc ] , and turn to the latter issue now . whereas integration of ( [ eq : constraintimp ] ) is only relevant for cases ( ii ) and ( iii ) , the issue of a regular solution to the @xmath59 equation also pertains to ( [ eq : smallelliptic ] ) , and so we include this equation in our analysis . each of the second - order scalar equations [ eq .",
    "( [ eq : smallelliptic ] ) , ( [ eq : mediumelliptic ] ) , or ( [ eq : largeelliptic ] ) ] takes the following form : @xmath177 here we view constraint terms appearing in @xmath178 , if present , as predetermined via integration of ( [ eq : constraintimp ] ) .",
    "we continue by calculating @xmath179 where @xmath180 is the laplace operator associated with @xmath181 , the unit - radius round sphere .",
    "next , we set @xmath182 in ( [ eq : generalelliptic ] ) , thereby obtaining the equation for a generic spherical - harmonic mode , @xmath183 \\psi_{\\ell m } +   \\left[\\alpha\\mathcal{s}(r ) + \\frac{2\\alpha^2 n^2}{r}\\right]\\partial_r\\psi_{\\ell m } + \\alpha^2\\left[\\frac{n^2}{l^{2}}-({v}^r)^2\\right ] \\partial^2_r\\psi_{\\ell m } = \\mathcal{g}_{\\ell m}.\\ ] ] this equation has the form @xmath184 with @xmath185 , \\quad \\mathcal{p}(r ) =   ( r + 2m)\\left[\\mathcal{s}(r)+\\frac{2\\alpha   n^2}{r}\\right].\\ ] ] note that the coefficient of the second - order term @xmath186 passes through zero at the black hole horizon , @xmath187 .",
    "we study eq .",
    "( [ eq : appendixeqn ] ) in appendix [ sec : sbvp ] , where we show that @xmath187 is a regular singular point .",
    "furthermore , in the appendix we compute the indicial exponents associated with the singular point , and argue that , despite the second - order character of ( [ eq : appendixeqn ] ) , an outer boundary condition alone determines a unique solution which is regular up to and even across the horizon .",
    "thus the following picture emerges : if the radius @xmath188 of @xmath78 satisfies @xmath189 , then the scalar wave equation requires a boundary condition for @xmath77 on _ both _ @xmath78 and @xmath74 ; the corresponding second - order implicit equation ( [ eq : generalelliptic ] ) is everywhere regular and requires boundary conditions on _ both _ boundaries as well . for @xmath190 ,",
    "the inner boundary is an outflow boundary for the scalar wave equation , and a boundary condition on @xmath77 is necessary only on @xmath74 ; in this case , a unique solution to eq .  ( [ eq : generalelliptic ] ) is determined by an outer boundary condition alone , along with the assumption that the solution is regular across the horizon .",
    "in this first subsection we demonstrate that our numerical imex algorithm can solve a standard initial value problem . to do so , we consider the evolution of pulse initial data , a problem for which an explicit algorithm would be better suited . here",
    "we are evolving the wave equation @xmath191 without a source term , that is for @xmath192 .",
    "the following experiment has been carried out both with a one - dimensional radial code ( in matlab ) and with a three - dimensional code ( in spec ) .",
    "whereas the 3d code uses the variables @xmath193 , the 1d code uses @xmath194 . on the radial domain",
    "@xmath195 $ ] , initial data @xmath196 , & \\phi\\;\\,&=0 , \\nonumber \\\\ \\label{eq : gaussianpacket } \\qquad\\qquad\\text{3d : } \\quad \\psi&=0 , & \\pi & =    \\exp\\left[-(r-5)^2\\right ] \\text{re}\\big[y_{11}(\\theta,\\phi)\\big ] , &   \\phi_k&=0,\\qquad\\qquad\\end{aligned}\\ ] ] is evolved to time @xmath197 , with the background geometry taken as @xmath198 schwarzschild in kerr - schild coordinates .",
    "initial and final radial mode profiles are depicted in fig .",
    "[ fig : erkrun ] .",
    "the first step of the experiment is to generate a reference solution , using an explicit runge - kutta ( erk ) time - stepper , either ( for 1d ) the classical fourth - order scheme or ( for 3d ) the fifth - order cash - karp scheme @xcite . in both cases",
    "we choose a fixed time - step @xmath199 , and so are not using the potential adaptivity of the cash - karp scheme .",
    "for both the 1d and 3d experiments , we place no boundary condition at the inner radius @xmath200 , and a sommerfeld boundary condition @xmath201 [ cf .",
    "( [ eq : charvars ] ) , either @xmath202 in 1d or @xmath203 in 3d ] at the outer boundary @xmath204 .",
    "we further enforce constraint - preserving outer boundary conditions which are analogous to the boundary conditions applied to the black hole evolutions in  @xcite . for the scalar characteristic field @xmath75 and the 3d code",
    ", we use @xmath205 cf .",
    "( 40 ) ref .",
    "@xcite . for the 1d code",
    "we similarly use @xmath206 as the outer boundary condition . for @xmath207",
    ", we employ the analogue of eq .",
    "( 65 ) in ref.@xcite , @xmath208 here @xmath209 denotes the @xmath210 projection of the right - hand side of eq .",
    "( [ eq : phidot ] ) .",
    "we use one spherical shell , with @xmath211 radial collocation points .",
    "we fix the angular resolution for the 3d evolution with @xmath212 as the top spherical - harmonic index .",
    "the explicit evolution uses the same angular filtering as  @xcite .",
    "when the right - hand sides of eqs .",
    "( [ eq : firstorderscalarwave ] ) are computed , they are transformed to scalar spherical harmonics ( for the @xmath59 and @xmath58 components ) or vector spherical harmonics ( for the @xmath68 component ) , and the top two modes are truncated .",
    "we next carry out the same evolution via imex evolutions taking case ( iii ) ( the @xmath98 value is irrelevant because @xmath192 ) , and check the results against the reference solution . during an evolution , the requisite implicit solves have been carried out with the ellipticsolver in spec , as described in @xcite . for this simple class of problems , we have chosen finite - difference preconditioning .",
    "precisely , we have used an exact lu decomposition of a finite - difference approximation @xmath213 to the operator associated with the second - order @xmath59 equation .",
    "the ellipticsolver interfaces with petsc s iterative solvers , and for the iterative linear solves we have used gmres , choosing all error tolerances close to machine precision . as mentioned , for these experiments @xmath214 , so the inner boundary lies inside of the horizon .",
    "therefore , throughout our evolutions we solve the second - order @xmath59 equation with no boundary condition at the innermost collocation points .",
    "rather in the relevant matrix - vector multiply needed for the iterative solver , only the pde is enforced at these points . the elliptic equation for @xmath59",
    "is solved for @xmath215 modes with @xmath216 to avoid technical issues due to representation of cartesian tensor components with scalar spherical harmonics .",
    "this acts as an angular filter for @xmath59 , obviating the need for further angular filtering as described above for the explicit evolution .    for a number of temporal resolutions and for the ark4 method",
    ", we show the results in fig .",
    "[ fig : ark4 ] .",
    "the errors plotted in the first , second , and third quadrants correspond to the 1d code , and these errors have been computed after interpolation onto a finer uniform grid .",
    "the fourth quadrant plot collects results from both the 1d and 3d experiments .",
    "the black circles correspond to the @xmath217 errors from the 1d code shown in the other plots ( and are taken over all fields ) .",
    "the red squares are @xmath217 errors from the 3d experiment ( and , again , are taken over all fields ) . note that these errors have been computed in 3d . in both cases we see clean fourth - order convergence .",
    "we now consider a problem for which temporal variations occur on time - scales much longer than the courant limit for an explicit time - stepper .",
    "this model mimics the binary black hole configuration , providing a testing ground for our imex methods .",
    "our model problem on a single @xmath218 black hole is set up as follows .",
    "for the solution we adopt the _ ansatz _ @xmath219,\\ ] ] where @xmath220 is a radial profile .",
    "this profile is chosen as a polynomial of degree @xmath221 , @xmath222^q , \\quad r_2 > r_1,\\ ] ] truncated so as to vanish whenever @xmath223 lies outside the interval @xmath224 $ ] .",
    "we typically choose @xmath225 , @xmath226 , and @xmath227 .",
    "the computational domain covers radii @xmath228=[1.9,11.9 ] \\subset [ r_1,r_2]$ ] .",
    "note that @xmath229 is somewhat inside the black hole horizon , @xmath230 ( recall that @xmath218 ) , and we therefore never apply a boundary condition at @xmath231 .",
    "nevertheless , we have chosen the support of @xmath232 such that @xmath232 is non - zero at the inner edge @xmath231 of the computational domain .",
    "however , @xmath232 does vanish at the outer boundary @xmath233 , a necessary requirement for avoiding boundary - driven temporal order reduction @xcite .",
    "we substitute the chosen @xmath234 into eq .",
    "( [ eq : scalarwave2ndorder ] ) to compute the source @xmath83 .",
    "we furthermore initialize the initial conditions for @xmath59 , @xmath58 and @xmath68 with the _ ansatz _ @xmath234 .",
    "the @xmath235 value determines the time - scale of the temporal variations , and we present results for three values , @xmath236 . for @xmath237 ,",
    "temporal and spatial scales are comparable , whereas for @xmath238 , temporal variations are vastly slower , so that explicit time - steppers will be limited by the courant condition .",
    "our radial expansions use chebyshev polynomials @xmath239 as basis functions , where we map @xmath240 $ ] to @xmath241 $ ] via @xmath242 with @xmath243 and parameters @xmath244 and @xmath245 chosen such that @xmath246 , @xmath247 .",
    "the mapping  ( [ eq : expmap ] ) serves two purposes : first , it increases resolution close to the black hole , resulting in a somewhat faster convergence rate for the spectral representation of the schwarzschild background , eq .",
    "( [ eq : kerrschild ] ) .",
    "second , through this mapping the expansion of the radial profile @xmath220 in chebyshev polynomials acquires non - zero power in _ all _ radial modes .",
    "in contrast , the linear map @xmath248 would result in only the first @xmath249 chebyshev polynomials being excited .    with either ark3 or ark4 and one of the considered imex splittings ,",
    "our experiment is to evolve the initial data specifying this solution , assuming that the field equations include the exact forcing function @xmath250 .",
    "we evolve for about 10 oscillation periods , to final time @xmath251 .",
    "we have chosen @xmath252 radial collocation points , and the angular grid is determined by top azimuthal index @xmath212 .        to examine the influence of the imex splitting on both long and short evolutions",
    ", we perform numerical runs with ark3 for each of the aforementioned cases ( i ) , ( ii ) , and ( iii ) .",
    "the results are collected in figs .",
    "[ fig : ark3case_i ] , [ fig : ark3case_ii ] , and [ fig : ark3case_iii ] .",
    "some of the errors in figs .",
    "[ fig : ark3case_i ] and [ fig : ark3case_ii ] correspond to blowup and fall outside of the plot range . comparing these plots",
    ", we notice that for @xmath253 short - time runs the accuracy is insensitive to the choice of splitting .",
    "however , for the small-@xmath235 , longer - time runs , the fully implicit case ( iii ) is advantageous in the following sense .",
    "as @xmath235 is reduced by a factor of @xmath254 ( from @xmath255 to @xmath256 , and then to @xmath257 ) , this splitting allows for a corresponding increase of the time - step @xmath258 by the same factor of @xmath254 _ without _ loss of accuracy .",
    "[ fig : ark4case_iii ] shows results for the same case ( iii ) experiment , but with ark4 rather than ark3 used for time integration .",
    "the fully implicit scenario , that is case ( iii ) and @xmath92 , corresponds to evolving solely with the @xmath173-stable esdirk component of the ark algorithm @xcite .    when this same oscillating multipole problem is evolved by the explicit fifth - order cash - karp scheme @xcite the courant limit is about @xmath259 _ independent _ of @xmath235 .",
    "for all splittings and for all @xmath235 , the imex code allows for time - steps one to two orders of magnitude larger than the explicit code .",
    "for slow temporal variations , @xmath238 , the splitting ( iii ) with @xmath260 allows for a time - step @xmath261 ( i.e.  about 3 time - steps per oscillation period ) while maintaining an accuracy of about @xmath262 .",
    "we now consider the following off - center _ ansatz _ :",
    "@xmath263 , where @xmath264 and relative to the black hole center @xmath265 .",
    "the radial profile is determined as above with @xmath226 and @xmath266 .",
    "the numerical domain is comprised of three nested spherical shells , each with center @xmath267 .",
    "therefore , each shell is neither a level-@xmath223 surface nor a metric sphere with respect to the background kerr - schild geometry .",
    "relative to their common center , the shells are determined by the radial bounds 1.8 , 5.13 , 8.47 , and 11.8 , with coordinate radial separations computed using the background cartesian coordinates described before eq .",
    "( [ eq:3metric ] ) .",
    "each shell has @xmath268 chebyshev - lobatto collocation points , with a top azimuthal index @xmath269 fixing the angular grid .",
    "the numerical code expands variables in spherical harmonics centered on @xmath270 . because @xmath271 all spherical - harmonic modes are excited in this experiment .    for this type of exact solution ( which involves exact control of a nonzero @xmath77 as an inhomogeneous boundary condition ) ,",
    "we expect temporal order - reduction , a well - known pitfall of exact time - dependent boundary conditions @xcite .",
    "therefore , our purpose here is not to consider temporal convergence , rather to demonstrate robustness of our evolution procedure in a setting which mixes several issues at once : an asymmetric solution , absence of an inner boundary condition , and multiple domains .",
    "while the inner boundary lies within the horizon , the coordinate characteristic speeds vary spatially across it .",
    "[ fig : offcenterark4 ] depicts long - time error histories for all fields using the fully implicit ark4 time - stepper , that is case ( iii ) with @xmath92 .",
    "the plot clearly shows the fields response to the external forcing , with the errors continuing to oscillate . at least for linear problems we consider here ,",
    "we believe that our implicit evolutions are robustly stable , even in the absence of an inner boundary condition .       from the _ ansatz _ @xmath234 .",
    "the large deviation at early times is present since the _ ansatz _ is not the exact solution.,width=415 ]    the numerical experiments described in subsections [ subsec : schwarzmodel ] and [ subsec : schwarzmodeloffcen ] deal with scenarios in which our imex integration is simply driven by an external forcing , and as a result no secular errors accumulate . that we are therefore able to achieve reasonable accuracy for large time - steps is perhaps not surprising . in this section ,",
    "we provide one further test which combines transient , rapidly changing behavior at early times with a slowly varying solution at late times .",
    "this test mimics start - up effects encountered in binary blackhole simulations , which typically exhibit rapid transient behavior at early times when the black holes settle down from imperfect initial data into their quasi - stationary configuration .    we still solve the scalar wave equation with the same source term as before , @xmath272 with @xmath273 given in eq .",
    "( [ eq : psi0 ] ) , and here with @xmath264 . however , we now choose initial conditions for generating @xmath274 which are inconsistent with those for generating @xmath273 .",
    "specifically , we choose    @xmath275    where @xmath276\\mathrm{re}[y_{11}(\\theta,\\phi)]$ ] is the angularly modulated gaussian wave packet used in sec .",
    "[ subsec : compare ] , see eq .",
    "( [ eq : gaussianpacket ] ) . because of the presence of @xmath277 , the solution to this evolution problem is not simply @xmath278 , but rather there will be an initial deviation . for long evolutions , the effect of the gaussian perturbation dies away ( due to our dissipative radiation boundary conditions ) , and @xmath279 for large @xmath53 . for this experiment @xmath280 .",
    "we again work with a single , centered , spherical - shell domain and @xmath281 , @xmath212 . rather than the mapping ( [ eq : expmap ] )",
    ", now we choose the identity @xmath248 .",
    "this is necessary to fully resolve the gaussian at early times , or else we would require even more radial points . we will again generate a reference numerical solution using an explicit time - stepper , in this case dormand prince 5 ( dp5 ) @xcite , against which we will compare an imex numerical solution obtained with ark4 , choosing case ( iii ) and @xmath92 so that the evolution is fully implicit .",
    "a key difference between this experiment , and the ones considered in previous subsections , is that we now exploit _ adaptive _ time - stepping with _",
    "dense output_. both dp5 and ark4 allow for error control and dense output .",
    "the adaptive time - stepping , based on a proportional - integral controller described in @xcite , allows the imex method to use small time - steps during the initial transients , and large time - steps once the transients have died away .",
    "dense output allows us to conveniently keep track of the error history between the explicit - reference and implicit numerical solutions .",
    "throughout the course of both the explicit - reference and implicit evolutions , we output the solution component @xmath59 at all times divisible by 15 . for both the explicit - reference and implicit evolutions we choose an initial step size @xmath282 , with the absolute error tolerance @xmath283 .",
    "figure [ fig : adaptiveerrors ] depicts the history of the @xmath217 difference between the explicit - reference and implicit @xmath59 , showing that the implicit @xmath59 maintains uniform accuracy throughout the evolution .",
    "also depicted in fig .",
    "[ fig : adaptiveerrors ] is the deviation of the explicit - reference @xmath59 relative to @xmath273 .",
    "although @xmath273 is not the exact solution , the figure shows that it effectively is for times later than @xmath284 .",
    "figure  [ fig : timestepsize ] depicts the time - step sizes taken throughout the explicit - reference and implicit evolutions . as seen in fig .",
    "[ fig : timestepsize ] , the dp5 evolution essentially runs at a fixed time - step @xmath285 near the courant limit , and in fact this evolution took over @xmath286 time - steps .",
    "by contrast , only 475 time - steps were taken during the implicit evolution .",
    "for the implicit evolution , the time - step size starts off small and remains near @xmath256 while the gaussian pulse propogates off the domain .",
    "however , at later times the step size dynamically relaxes to a time - step of order @xmath287 .",
    "as noted in the introduction , implicit or imex time - stepping is bound to offer a more efficient means of carrying out bbh evolutions , especially evolutions involving black holes with markedly unequal masses . in the context of scalar waves on a single black hole",
    ", this paper has analyzed several issues pertinent to the eventual use of imex methods in actual bbh evolutions based on the generalized harmonic system .",
    "these include the role of constraints , the need for second - order implicit solves , and the nature of the imex splitting .",
    "specifically , we have investigated the role of a pure outflow boundary within the black hole horizon .",
    "consistent with the physics , the initial boundary value problem associated with the hyperbolic system of pdes does not require a boundary condition on the inner boundary .",
    "naively , one would expect that a second - order implicit equation , as used in our work , would require both outer and inner boundary conditions , in disagreement with both the underlying physics and hyperbolic pde .",
    "however , the second - order equation is singular at the horizon , and by requiring that the solution is _ regular _ across the horizon , we have found that the outer boundary condition alone yields uniqueness .",
    "we have examined the impact of different imex splittings on the evolution of a wave equation , finding that the performance of our imex schemes depends sensitively on the precise splitting choice [ cf .",
    "[ fig : ark3case_i ] to  [ fig : ark3case_iii ] ] .",
    "only the fully implicit choice [ case ( iii ) , @xmath260 ] allows for time - steps proportional to the temporal time - scale , i.e.  @xmath289 , while retaining accuracy independent of @xmath235 .",
    "we explain this result as follows . for small @xmath235 , the right - hand sides of the evolution equations  ( [ eq : firstorderscalarwave ] )",
    "are @xmath290 by construction . however , individual terms in the expressions are @xmath291 , because @xmath59 , @xmath58 and @xmath68 are all @xmath291 . only the _ sum _ of all terms",
    "is @xmath290 .",
    "consequently , for cases ( i ) and ( ii ) , and for case ( iii ) with @xmath292 , both the implicit and explicit sectors are large , while their sum is small .",
    "that is , @xmath89 and @xmath90 are @xmath291 , while @xmath293 .",
    "therefore , in the ark scheme , both the implicit and the explicit sectors involve large drivings , which seems to degrade performance . in the general case , we conjecture that the imex splitting should ideally ensure that both @xmath90 and @xmath89 remain small .",
    "these observations suggest that a fully implicit treatment of the ghs equations will afford accurate evolutions with very large time - steps .",
    "however , a corresponding gain in efficiency may well be offset by the complexity of solving complicated nonlinear implicit equations .",
    "a more workable approach might be to linearize the ghs equations about the solution at the current time - step , in order to treat terms with constant or linear time - dependence implicitly , and to treat terms with quadratic ( or higher ) time - dependence explicitly . in this case",
    "@xmath90 would be @xmath294 , and perhaps sufficiently small for rather large @xmath258 .",
    "another possibility for the imex splitting is particularly promising .",
    "namely , splitting by location ( or subdomain ) , as described in ref .",
    "@xcite for fluid flow past a nozzle , a problem for which explicit numerical evolutions are hampered by boundary induced stiffness .",
    "to understand the idea behind this possibility , consider the type of multidomain bbh evolutions now being carried out by the caltech - cornell collaboration .",
    "such evolutions involve a computational domain which is split into about 60 subdomains ( typically spherical shells , cylindrical shells , and full cylinders with axes ) . among these",
    "are several concentric spherical coordinate shells which enclose each of the individual black holes .",
    "for either black hole , the innermost of these shells contains a topologically spherical apparent horizon . as these shells are closest to the black holes where field gradients and nonlinearities are the strongest , they require high resolution . whence these shells determine the courant limit for current bbh evolutions based on the generalized harmonic system with spectral methods .",
    "in those shells nearest the black holes , the splitting we plan to investigate would put the local representation of the ghs system into the implicit sector , while the equations on all other subdomains would be retained in the explicit sector .",
    "the resulting evolution scheme would still be subject to a ( milder ) courant limit arising from the grid spacing in those subdomains treated explicitly",
    ". however , this courant limit would be independent of the resolution close to the black holes , promising efficiency gains as the mass ratio increases .",
    "implicit equations would need to be solved only in a set of concentric spherical shells , rather than in a complicated overlapping domain decomposition , simplifying preconditioning and improving the efficiency of the elliptic solver .",
    "another reason further motivates our interest in an imex splitting by location . for bbh evolutions based on",
    "the ghs system , implementation of outer boundary conditions ( relevant only for the outermost spherical shell enclosing the collection of all inner subdomains ) involves second derivatives of the physical fields @xcite .",
    "the imex splitting we envision would treat the outermost spherical shell explicitly , thereby leaving in place the current implementation of outer boundary conditions .",
    "finally , we point out that for black hole binaries our imex time - stepping strategy will only apply in _ co - rotating coordinates_. only in such coordinates does the binary configuration appear approximately time - independent , as the black holes remain at the same location in the computational grid .",
    "moreover , the pattern of the emitted gravitational radiation will be almost time - independent , varying only on the inspiral time - scale together with the orbital frequency and the gravitational wavelength .",
    "this restriction is not onerous for our approach , as the spec code already uses co - rotating coordinates within the dual - coordinate frame approach developed in ref .",
    "we would like to thank thomas hagstrom , lawrence kidder , lee lindblom , geoffrey lovelace , michael minion , mark scheel and saul teukolsky for useful discussions .",
    "most of the numerical simulations presented here were performed using the spectral einstein code ( spec ) developed at caltech and cornell primarily by larry kidder , h.  p. , and mark scheel .",
    "we also thank the referee for comments which led to the experiment considered in subsection [ subsec : modifiedmodelproblem ] .",
    "revisions were carried out after s.  l.  had moved to unm .",
    "this work was supported by grants from the sherman fairchild foundation and from the brinson foundation to caltech ; by grants dms 0554377 and darpa / afosr fa9550 - 05 - 1 - 0108 to brown university ; and by nsf grants phy-0601459 , phy-0652995 and nasa grant nng05gg52 g to caltech .",
    "this appendix considers a first - order system similar to all three of our first - order implicit systems [ eqs .",
    "( [ eq : case1 ] ) , ( [ eq : case2 ] ) , and ( [ eq : case3 ] ) ] , showing that the system requires 5 boundary conditions .",
    "any of our original systems [ eqs .",
    "( [ eq : case1 ] ) , ( [ eq : case2 ] ) , or ( [ eq : case3 ] ) ] could be analyzed in a similar fashion , although doing so would require a mode decomposition based on vector spherical harmonics .",
    "here we use simple fourier series . consider the system    [ eq : periodicimex ] @xmath295    where the constant shift @xmath296 obeys @xmath297 .",
    "take the rectangular computational domain to be periodic in the @xmath298 and @xmath299 directions , and lying between @xmath300 and @xmath301 .",
    "fourier transformation in @xmath298 and @xmath299 yields the transformed system    @xmath302    where @xmath303 and @xmath304 are the integers dual to @xmath298 and @xmath299 .",
    "all of the hatted variables should also carry these integer indices , e.  g.  @xmath305 , but we suppress this dependence throughout .",
    "we replace equations ( [ eq : periodicftpi ] ) and ( [ eq : periodicftphix ] ) with the lightlike combinations @xmath306 & = \\hat{b}_\\pi + \\hat{b}_{\\phi_1 } \\\\ \\label{eq : periodicuminus } \\hat{u}{}^- - \\alpha \\big[(v^x+1 ) \\partial_x",
    "\\hat{u}{}^-_x - i k_2 \\hat{\\phi}_2 - i k_3\\hat{\\phi}_3\\big ] & = \\hat{b}_\\pi - \\hat{b}_{\\phi_1},\\end{aligned}\\ ] ] thereby arriving at the following inhomogeneous linear system : @xmath307 with @xmath308}$ ] and @xmath309 , the eigenvalues of the coefficient matrix @xmath310 are @xmath311}.\\ ] ] the corresponding eigenvectors are @xmath312 the @xmath313 limits of eqs .",
    "( [ eq : periodicevalues ] ) and ( [ eq : periodicevectors ] ) are easily computed with the result @xmath314 , @xmath315 .",
    "the results agree with those obtained by first setting @xmath316 in ( [ eq : periodicftsystem ] ) , and then performing the eigen - decomposition .",
    "notice that the @xmath317 eigenvalues , which happen to be the diagonal entries of the coefficient matrix @xmath310 in ( [ eq : periodicftsystem ] ) , are such that @xmath318 for @xmath319 are the characteristic speeds of the corresponding hyperbolic system .",
    "the eigenvectors ( [ eq : periodicevectors ] ) are not mutually orthogonal ; however , @xmath320   = -\\frac{4\\alpha \\big[1 - \\alpha^2 |\\mathbf{k}|^2   ( v^x)^2\\big]q}{\\big[1-(v^x)^2\\big]},\\ ] ] and the eigensolutions @xmath321 form a fundamental set of solutions . defining @xmath322\\ ] ] and viewing the system ( [ eq : periodicftsystem ] ) as @xmath323 we can now write down the general solution : @xmath324 where @xmath325 is any point on the interval @xmath326 .",
    "the five components @xmath327 of @xmath328 correspond to five boundary conditions .",
    "the following recipe for fixing these components agrees with the convention for control of incoming fields in the corresponding evolution initial - boundary - value problem .",
    "the exponentials @xmath329 for @xmath330 all blow up as @xmath331 , whereas @xmath332 decays in the same limit .",
    "we want to fix the eigensolutions @xmath333 for @xmath330 ( associated with blowing - up exponentials ) at @xmath301 , and the eigensolution @xmath334 ( associated with the sole decaying exponential ) at @xmath300 .",
    "we assume that @xmath335 is small , so that the eigenvectors @xmath336,@xmath337 , @xmath338 , and @xmath339 are combinations of the fields @xmath340 , @xmath341 , @xmath342 , and @xmath343 .",
    "therefore , we fix these fields at @xmath301 . also for small @xmath335 , @xmath344 is approximately proportional to the fields @xmath340 ( already fixed at @xmath301 ) and @xmath345 which would be the @xmath341 field relative to the outward - pointing unit normal @xmath346 at @xmath300 . finally then",
    ", we fix @xmath345 at @xmath300 .",
    "in this appendix we consider the general solution to the second - order equation ( [ eq : appendixeqn ] ) for the case of the schwarzschild geometry with respect to kerr - schild coordinates .",
    "provided that the radial location @xmath347 of inner boundary satisfies @xmath348 , we show that a regular ( that is , nonsingular ) solution to the equation is uniquely determined by one free constant .",
    "we conclude that a single outer boundary conditions suffices to determine a regular solution to the equation .",
    "our analysis assumes that both @xmath349 and @xmath350 in eq .",
    "( [ eq : appendixeqn ] ) are smooth on the radial domain , which is easily checked for all cases .",
    "we further note that @xmath351 , where @xmath352 .",
    "let us verify that this last inequality holds for the considered cases .",
    "for ( [ eq : smallelliptic ] ) and case ( i ) we have @xmath353 and so @xmath354 by ( [ eq : geometry ] ) . for ( [ eq : mediumelliptic ] ) and case ( ii ) , we find @xmath355.\\ ] ] calculations with ( [ eq : geometry ] ) then show that @xmath356 , whence @xmath357 .",
    "finally , we consider ( [ eq : largeelliptic ] ) and case ( iii ) , with our earlier calculations giving @xmath358.\\ ] ] with the formulas listed in ( [ eq : geometry ] ) and ( [ eq : jkandennkay ] ) , we find @xmath359 , implying as claimed that @xmath360 .",
    "our argument is completed with the following :    lemma : consider the ode @xmath361 here taken on the @xmath223-interval @xmath362 .",
    "assume that @xmath349 , @xmath350 , and @xmath363 are smooth on an open interval larger than @xmath362 .",
    "moreover , assume that @xmath351 , also with @xmath364 .",
    "express the general solution as @xmath365 where @xmath366 and @xmath367 are solutions to the homogeneous equation ( that is , for @xmath368 ) , and @xmath369 is a particular solution .",
    "then we may arrange for @xmath366 and @xmath369 to be regular as @xmath370 , with @xmath367 singular and obeying @xmath371 again as @xmath370 . here",
    "@xmath372 , and @xmath373 by assumption .",
    "the second solution must therefore exhibit a blowing - up ( likely also branch ) singularity at @xmath374 .",
    "we begin the proof of the lemma by examining the homogeneous equation . taken in standard form ,",
    "that equation is @xmath375 where @xmath376 seeking solutions of frobenius type , we then consider the indicial equation @xmath377 whence the indicial exponents are @xmath378 , and we may therefore choose solutions to the homogeneous problem obeying @xmath379 as @xmath370 . at @xmath374 ,",
    "the first solution is analytic , while the second exhibits blow - up , and likely branch behavior depending on the value of @xmath380 .    to complete the proof ,",
    "we follow the method of undetermined coefficients in order to construct a particular solution with the desired regularity . for @xmath381 , an integrating factor for ( [ eq : maineqn ] ) is @xmath382 = ( r-2m)^{-1 + 1/(\\alpha\\kappa)}\\mu(r),\\ ] ] where @xmath383 . using the integrating factor",
    ", we cast ( [ eq : maineqn ] ) into the following form : @xmath384 { } ' + ( r-2m)^{-1 + 1/(\\alpha\\kappa ) } \\mu(r)\\mathcal{q}(r)w = ( r-2m)^{-1 + 1/(\\alpha\\kappa ) } \\mu(r)h(r).\\ ] ]",
    "it then follows on general grounds that @xmath385(r ) = w_1(r ) w_2'(r ) - w_2(r ) w_1'(r ) = \\frac{a}{\\alpha^2\\mu(r)}(r-2m)^{-1/(\\alpha\\kappa)},\\ ] ] where the constant @xmath386 $ ] . with this result for the wronskian @xmath387(r)$ ] in hand",
    ", we look for a solution @xmath388 subject to the variation - of - parameters _ ansatz _ @xmath389 the needed expressions for @xmath390 and @xmath391 are as follows : @xmath392 more compactly , we may write @xmath393 in terms of the green s function @xmath394    finally , to verify that , as constructed , @xmath369 remains regular as @xmath370 , we establish in the same limit that @xmath395 for constants @xmath396 and @xmath397 . the first asymptotic statement follows from the observation that the integrand in ( [ eq : uintegral ] ) is integrable at @xmath374 . to get the result for @xmath391",
    ", we use @xmath398 along with @xmath399 . taken all together",
    ", we have shown that @xmath400 as @xmath370 . whence the lemma has been proved .",
    "for the schwarzschild example with line - element ( [ eq : kerrschild ] ) , this appendix further examines eq .",
    "( [ eq : constraintimp ] ) . to obtain an orthonormal spatial triad , we complete the radial vector @xmath402 defined just before eq .",
    "( [ eq:3metric ] ) with the standard angular directions @xmath403 in terms of the triad , we have @xmath404 where @xmath405 , @xmath406 , and @xmath407 . contraction of ( [ eq : constraintimp ] ) on @xmath408 yields the equation @xmath409 with the prime denoting radial differentiation .",
    "likewise , contraction of ( [ eq : constraintimp ] ) on @xmath410 yields @xmath411 where in reaching this equation we have used @xmath412 and @xmath413 .",
    "similar manipulations establish that @xmath414 since @xmath415 over the whole spherical shell , we may radially integrate ( [ eq : nuconstraintimp],[eq : thetaconstraintimp],[eq : phiconstraintimp ] ) inward from the outer boundary @xmath74 , provided @xmath416 , @xmath417 , and @xmath418 are specified .",
    "we can then recover the cartesian components @xmath110 with ( [ eq : cartesianck ] ) . in principle",
    ", these components could be incorporated into the @xmath178 source in eq .",
    "( [ eq : generalelliptic ] ) .          j.  g.  baker , j.  centrella , d .-",
    "choi , m.  koppitz , and j.  van meter , gravitational - wave extraction from an inspiraling configuration of merging black holes , phys .",
    "lett . , 96 ( 2006 ) , 111102 ( 4 pages ) .",
    "m.  boyle , d.  a.  brown , l.  e.  kidder , a.  h.  mrou , h.  p.  pfeiffer , m.  a.  scheel , g.  b.  cook , and s.  a.  teukolsky , high - accuracy comparison of numerical relativity simulations with post - newtonian expansions , phys .",
    "d , 76 ( 2007 ) , 124038 ( 31 pages ) .",
    "j.  g.  baker , w.  d.  boggs , j.  centrella , b.  j.  kelly , s.  t.  mcwilliams , and j.  r.  van meter , mergers of nonspinning black - hole binaries : gravitational radiation characteristics , phys .",
    "d , 78 ( 2008 ) , 044046 ( 25 pages ) .",
    "a.  kanevsky , m.  h.  carpenter , d.  gottlieb , and j.  s.  hesthaven , application of implicit - explicit high order runge - kutta methods to discontinuous - galerkin schemes , j.  comput .",
    "phys . , 225 ( 2007 ) , 1753 - 1781 .",
    "j.  hennig and m.  ansorg , a fully pseudospectral scheme for solving singular hyperbolic equations on conformally compactified space - times , journal of hyperbolic differential equations 6 , no .  1 ( 2009 ) , 161 - 184 .            s.  abarbanel , d.  gottlieb , and m.  h.  carpenter , on the removal of boundary errors caused by runge - kutta integration of nonlinear partial differential equations , siam j.  sci .",
    "comput . , 17 ( 1996 ) , 777 - 782 ."
  ],
  "abstract_text": [
    "<S> inspiral of binary black holes occurs over a time - scale of many orbits , far longer than the dynamical time - scale of the individual black holes . </S>",
    "<S> explicit evolutions of a binary system therefore require excessively many time - steps to capture interesting dynamics . </S>",
    "<S> we present a strategy to overcome the courant - friedrichs - lewy condition in such evolutions , one relying on modern implicit - explicit ode solvers and multidomain spectral methods for elliptic equations . </S>",
    "<S> our analysis considers the model problem of a forced scalar field propagating on a generic curved background </S>",
    "<S> . nevertheless , we encounter and address a number of issues pertinent to the binary black hole problem in full general relativity . specializing to the schwarzschild geometry in kerr - schild coordinates </S>",
    "<S> , we document the results of several numerical experiments testing our strategy . </S>"
  ]
}