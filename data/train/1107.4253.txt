{
  "article_text": [
    "solar and stellar irradiance records are often plagued by data gaps .",
    "the proper interpolation of these missing data is a longstanding and notoriously delicate problem that requires a good understanding of the data @xcite .",
    "considerable attention has been given to this problem in fields such as climate science @xcite but much less so in solar physics and in astrophysics .",
    "often , the limited attention that is paid to data gaps contrasts with the sophistication of the analysis that is subsequently performed on these data .",
    "while short gaps can easily be filled by linear or by nonlinear interpolation , data gaps whose duration exceeds the characteristic time scales are much more difficult to handle .",
    "a notable exception is when multichannel synoptic observations of the same process are available , with gaps in some or in all of them .",
    "spectral irradiance observations , which we shall concentrate on , precisely belong to that category .",
    "our examples will be taken from the sun , but the results can be easily extended to other types of multichannel observations .",
    "our method applies to any set of observations that are recorded simultaneously ( i.e. the time stamps are the same for all records ) , are correlated with each other , and whose time intervals fully or partly overlap .",
    "our main assumption is their linear correlation , in the sense that each record can be approximated by a linear combination of the other ones .",
    "a strong linear correlation is typically observed between spectral irradiance observations made at different wavelengths or between simultaneous measurements of different proxies .",
    "these synoptic records are frequently used to assess subtle changes in the variability of the sun ; they are often remarkably coherent in time @xmath0 and in wavelength @xmath1 . as a consequence",
    ", their variability can be explained in terms of a few contributions only .",
    "this property is well known for the extreme ultraviolet ( euv ) @xcite but also for the visible range @xcite , when measured from space .",
    "the same coherency is observed among different proxies for solar activity @xcite .",
    "this property is rooted in the structuring effect of the solar magnetic field .",
    "the coherency partly breaks down during the impulsive phase of solar flares because the spectrum then considerably depends on the local conditions of the solar atmosphere . here",
    ", however , as in many applications , we consider daily or hourly averages , so that the effect of short transients can be discarded .",
    "this coherency in both time and wavelength is the key to the reconstruction technique we shall introduce below . by interpolating along two dimensions ( in time and along different records ) ,",
    "we not only improve the quality of the reconstruction , but we also can fill arbitrarily large data gaps without having to rely on the tedious bookkeeping that is required by most interpolation schemes .    the nonparametric and data - adaptive method we advocate is based on the svd or singular value decomposition @xcite , which is to linear algebra what the fourier transform is to spectral analysis .",
    "the svd allows the extraction of the coherent part of the solar spectral irradiance , which is then used to fill the data gaps iteratively .",
    "the method is described in section 2 , and two applications are detailed .",
    "the first one ( sec .",
    "3 ) deals with solar spectral irradiance data in the euv . in the second application ( sec .",
    "4 ) we consider a set of solar proxies with numerous gaps .",
    "let @xmath2 be a multichannel record that represents either the solar spectral irradiance at different wavelengths ( or in different spectral bands ) or a set of solar proxies , or a combination thereof .",
    "all these quantities must be sampled simultaneously ; the sampling rate , however , does not need to be constant .",
    "these data are conveniently stored in a matrix @xmath3 $ ] , in which columns are time series .",
    "each column may have an arbitrarily large number of data gaps , as long as a reasonable fraction of observations are available , say at least 20% .",
    "the method we propose exploits either the coherency in wavelength , or both the coherency in wavelength and in time .",
    "we start with a description of the first option , because the second one can be readily obtained by data embedding .",
    "let us first assume that there are no gaps .",
    "the svd of the data matrix then yields a separable set of functions ( hereafter called _ modes _ )",
    "@xmath4 which are orthonormal @xmath5 the weights @xmath6 are positive by construction .",
    "the number @xmath7 of modes equals the rank of the matrix , which is usually the smallest of the number @xmath8 of samples or the number @xmath9 of records .",
    "this decomposition is unique .",
    "the svd of the data matrix directly yields a set of three matrices @xmath10 that respectively contain @xmath11 , the weights @xmath12 , and @xmath13 .",
    "a key property of the svd is that modes with heavy weights describe salient features of the data .",
    "that is , the truncated expansion @xmath14 will capture the coherent part of the data while deferring incoherent fluctuations to the remaining modes .",
    "this property has made the svd popular in multichannel and array data processing @xcite .",
    "we shall use it here to reconstruct the missing values .",
    "the performance of the reconstruction can be quantified by the mean square error @xmath15 which shows that by taking the few largest modes , the reconstruction error can be made arbitrarily small .",
    "as it turns out with spectral irradiance data , the first few weights are often orders of magnitude heavier than the subsequent ones , so that excellent reconstructions can be achieved with a few modes only .",
    "we implicitly assume here that features departing from the behaviour observed at other wavelengths are unlikely to have a solar origin ( except during the impulsive phase of flares ) , so that they can be readily discarded .",
    "this will be illustrated below in sec .",
    "3 .    let us now assume that some samples are missing .",
    "the data covariance matrix and the svd then can not be computed anymore .",
    "this problem , however , can be circumvented by using the following iterative scheme with two embedded loops :    1 .",
    "fill each gap with some adequate value ( typically the temporal mean of the record ) .",
    "2 .   compute the svd .",
    "3 .   compute the approximation @xmath16 of the data by retaining the @xmath17 largest mode(s ) of the svd .",
    "initially , @xmath18 .",
    "4 .   fill the gaps with @xmath16 , as defined in eq .",
    "3 . as long as these values have not converged , go back to 2 .",
    "( inner loop ) .",
    "increment the number of modes @xmath17 and start again at 2 .",
    "iterate until @xmath19 ( outer loop ) .",
    "this method seems to have emerged independently in different contexts @xcite ; it has mostly been used for spatio - temporal data sets , with some subtle differences @xcite .",
    "we refer to @xcite for discussions on optimality , convergence , etc .",
    "three additional adaptations , however , need to be considered before the method can be applied to irradiance data .      the relative variability and the average value of the solar spectral irradiance vary by orders of magnitude between the soft x - ray and the visible range .",
    "the svd , however , is scaling - dependent and so a renormalisation is required .",
    "we do so by standardising each record : first , the time average is subtracted and then a normalisation with respect to the standard deviation @xmath20 or the noise level ( if known ) is performed .",
    "both operations are affected by the value of the missing samples , so they must be repeated at each iteration .",
    "this is particularly important for the offset subtraction .",
    "the renormalisation may be done only once .",
    "the solar spectral variability contains a mix of scales that are driven by different processes : 27-day variations are due to solar rotation , the 11-year periodicity is caused by the solar cycle , etc .",
    "each of these processes leads to a specific spectral dependence ; different scales should therefore be processed separately when filling gaps .",
    "this feature considerably improves the reconstruction skill and to the best of our knowledge has not yet been used .",
    "the two ranges of scales that are most frequently encountered in solar studies are : below 81 days ( which captures solar rotation and the evolution of active regions ) and above 81 days .",
    "we apply the iterative svd procedure described in sec .",
    "2.1 separately to both scales .",
    "the _  trous _ wavelet transform @xcite is used to decompose the data into two records at each iteration : one with short time - scales and one with long time - scales .",
    "classical bandpass filters may also be used because this has no significant impact on the results .",
    "the wavelet transform , however , is better suited for non - stationary data .",
    "one may also want to extract additional scales , such as the 13-day periodicity associated with centre - to - limb effects of hot coronal lines .",
    "this indeed results in a small but discernible improvement in the reconstruction of the euv , at the expense of a longer computation time .",
    "the methodology so far only exploits the coherency between different wavelengths ( or proxies ) , which is the key property .",
    "one may also want , however , to make use of the temporal coherency .",
    "this is useful when there are specific times at which there is no single observation , or if the number of records is small ( typically @xmath21 ) , or if each record can be considered as a smoothly varying waveform with incoherent noise superimposed on it .",
    "the main asset of the iterative svd reconstruction method is its straightforward extension to such a filtering in time , using the concept of embedding , which has been pioneered in the study of chaotic systems by @xcite .",
    "let us expand the data matrix by appending replicates that are shifted in time , i.e. @xmath22 .\\ ] ] by applying the svd to this embedded matrix we exploit both the coherency in wavelength and in time .",
    "it is important ( but not mandatory ) that the data be regularly sampled since the method essentially computes a weighted average of each sample with its nearest neighbours . the higher the value of the embedding dimension @xmath23 , the more adjacent time steps are used in the reconstruction , thus leading to a stronger smoothing in time .",
    "this is equivalent to using a symmetric finite - impulse filter whose coefficients are obtained data - adaptively .",
    "the particular case wherein one single record is embedded and decomposed by svd is called singular spectrum analysis ( ssa ) . in the ssa ,",
    "only temporal information is used and so it is important for the embedding dimension to exceed the value of the dominant period in the data @xcite .",
    "our reconstruction , however , mostly relies on the strong coherency across wavelengths or proxies to fill the gaps and so the conditions on the value of the embedding dimension are much less stringent . in practice ,",
    "low values ( @xmath24 ) already bring a significant improvement .",
    "the main reason for keeping this dimension as low as possible is to reduce the computational load .",
    "the three tuneable parameters of the method are : a ) the number @xmath25 of significant modes , b ) the number of scales into which the data are decomposed , and c ) the embedding dimension @xmath23 .",
    "only the first one really affects the outcome .",
    "a separation into two scales only ( with a threshold between 50 - 100 days ) is enough to properly capture both short- and long - term evolutions , and embedding dimensions of @xmath24 are usually adequate for reconstructing daily averages .",
    "the determination of the optimum parameters and the validation of the results is made by cross - validation and will be illustrated below .",
    "the only critical question is memory and computational load .",
    "for an irradiance data set with five years of daily values at 100 wavelengths , and an embedding dimension of @xmath26 , the size of the embedded matrix is @xmath27 $ ] .",
    "the computation of the svd at each iteration typically takes several seconds .",
    "for that reason , it may be desirable to process separately those spectral bands that evolve differently , such as the soft x - ray , the euv and the muv bands .",
    "the routine in matlab@xmath28 is available from the author .",
    "the solar euv monitor ( sem ) is a solar extreme ultraviolet ( euv ) spectrometer that has been operating continuously on the soho satellite since january 1996 @xcite . in its first - order mode , sem measures the irradiance within an 8 nm bandpass centred about the bright 30.38 nm he ii line . on june 25 , 1998 , soho suffered a mission interruption , leading to the loss of several months of data .",
    "this long data gap considerably complicates the use of sem data for upper atmosphere model validation .",
    "the sem , however , mostly captures chromospheric emissions , which are highly correlated with other gauges of solar activity .",
    "foremost among these are :    * the @xmath29 or decimetric index , which is the solar radio flux at 10.7 cm .",
    "this index , which is measured from the ground , captures a mix of thermal and electron gyro - resonance emissions , and has been shown to be highly correlated with the euv flux @xcite . * the mg ii index , which is the core - to - wing ratio of the mg ii line at 280 nm .",
    "this index is widely used as a proxy for chromospheric activity @xcite . *",
    "the intensity of the h i lyman @xmath30 line at 121.57 nm , which is the brightest spectral line below 200 nm @xcite .    together with the flux from the sem , we have four quantities that have different physical origins and yet are highly correlated , thereby opening the prospect of filling the large gaps in the sem data .",
    "we consider daily averages made from january 1 , 1996 until april 29 , 2011 .",
    "the linear correlation between the @xmath29 index and the other proxies improves when taking its square root , which we shall systematically do from now on .",
    "the correlation between these four proxies on both long and short time - scales is illustrated in fig .",
    "[ fig_sem_excerpt ] .",
    "our working hypothesis is that each of the missing samples from the sem can be reconstructed from a linear combination of ( possibly non - simultaneous ) observations of the other proxies . as we shall see shortly ,",
    "the best value of the embedding dimension is 4 ; let us therefore select @xmath31 and first determine the optimum number of modes . with four variables and an embedding dimension of 4 , the total number of svd modes is 16 ; their weights are displayed in fig .",
    "[ fig_sem_k ] .",
    "the first weight surpasses all the others because the first mode is an average of all four proxies , which is by far the most conspicuous coherent feature .",
    "the inflexion point between the few heaviest weights and the flat tail provides a convenient but visual criterion for determining the number of significant modes @xcite . according to this criterion , the best interpolation skill is for @xmath32 modes out of 16 .    a better validation test consists in generating a small number of synthetic gaps , reconstructing them , and then checking how the residual error varies with the model parameters .",
    "to do so , we remove 5 - 10 % of the samples from each record and then compute the normalised error @xmath33 where the average is computed for synthetic gaps only .",
    "this procedure is repeated ten times to obtain an estimate of the average value of the normalised error .",
    "a value of 100 % can be interpreted as an error whose standard deviation equals the solar cycle variability of the original data .",
    "this value truly reflects the error made by filling short data gaps .",
    "note that it tends to underestimate the error for larger gaps , unless the length distribution of the synthetic gap matches that of the original data .",
    "the evolution of the normalised error with @xmath25 is illustrated in fig .",
    "[ fig_sem_k ] , which shows a broad minimum around @xmath34 , in agreement with the estimate obtained by visualisation .",
    "note that the four minima occur at different values of @xmath25 .",
    "the normalised error is on average larger for the @xmath35 index , which suggests that this quantity is relatively more difficult to reconstruct than the others .",
    "this is not so surprising , because it is the only emission from the radio band .",
    "the smallest normalised error is obtained for the sem , with @xmath36 .",
    "this value is about half that of the estimated normalised uncertainty @xcite , which shows the excellent quality of the reconstruction . in practice , the optimum value of @xmath25 is frequently found to be one or two units higher than the value obtained by visual inspection . as fig .",
    "[ fig_sem_k ] suggests , an overestimation of @xmath25 is preferable to an underestimation .",
    "the choice of the embedding dimension @xmath23 is mostly based on physical insight . with @xmath37 ( i.e. no embedding ) we assume that the missing samples are reconstructed from simultaneous observations only , whereas @xmath38 implies that the information contained in past and future observations is also used . setting @xmath38",
    "therefore involves a weighted averaging over time , which is appropriate for records whose samples are highly correlated in time .    in fig .",
    "[ fig_sem_d ] we estimate the normalised error for different embedding dimensions , using the optimum number of modes for each of them .",
    "the smallest error is obtained for an embedding dimension of @xmath31 .",
    "larger dimensions hardly reduce the error but do increase the computational load substantially",
    ". as expected , the higher the value of @xmath23 , the smoother the reconstruction and the more likely that fine features may be missed .",
    "this is particularly evident in august 1998 , when a group of rapidly evolving active regions were moving across the solar disc .",
    "an embedding dimension of 4 properly captures their evolution , whereas a dimension of 15 smears out all but the most pronounced peaks .",
    "this example illustrates a relatively simple case because only one record has gaps in it .",
    "let us now , however , consider a more frequent case in which several of the records have large gaps .",
    "filling these gaps by standard interpolation schemes can become very time - consuming because of the amount of bookkeeping that is required to test whether gaps occur simultaneously in several records , etc .",
    "the svd - based interpolation does not require any of these tests .",
    "the ca k index is the normalised intensity of the ca ii k - line at 393.37 nm and has been advocated as a proxy for magnetic activity , including plages , faculae , and the network .",
    "this line is measured from the ground , so it can not be observed continuously .",
    "here we consider a record of daily observations made at the national solar observatory at sacramento peak @xcite , in which about 66% of the samples are missing .",
    "this index is known to be highly correlated with other solar indices , in particular with the mg ii index @xcite , so that the svd method is ideally suited for filling its gaps .    to reconstruct the missing values",
    ", we consider the following set of proxies that are highly correlated with the ca k index : the square root of the @xmath29 index , the intensity of the h i lyman @xmath39 line , the mg ii index and the magnetic plage strength index ( mpsi ) @xcite .",
    "the time interval ranges from nov . 1",
    ", 1980 to july 1 , 2010 ; all proxies have data gaps except for the first two .",
    "these gaps occur erratically and 6% of them exceed 10 days . in this particular example",
    ", the coherency between proxies is crucial and indeed the choice of the embedding dimension @xmath23 does not significantly affect the results .",
    "let us take @xmath40 , which is the value that is recommended by the reconstruction error .",
    "the maximum number of svd modes is 10 because we have five records . out of these ,",
    "three only are found to be significant .",
    "the result of the reconstruction is illustrated in fig .",
    "[ fig_cak1 ] for periods of high and low solar activity .",
    "note that the results obtained with different number of modes lead to similar temporal evolutions .",
    "the reconstruction at solar maximum looks reasonable because it passes through the observations while staying highly correlated with the mg ii index . during solar minimum , however , the observed values of the ca k index continue to fluctuate whereas the reconstructed values and the other proxies stay almost constant .",
    "the difference between the observed ca k index and the smoothly varying reconstruction varies randomly in time , which questions its solar origin .    to further investigate the origin of this difference between the observed and reconstructed index , we filtered the reconstructed data with the _  trous _ wavelet transform , which allows the separation of the sharp peaks from the more regular reconstruction .",
    "the residuals , i.e. the difference between the filtered reconstruction and the original observations , are shown in fig .",
    "[ fig_cak2 ] : they are found to be independent and their gaussian distribution only weakly varies with the solar cycle .",
    "this is a strong indication that the residuals are measurement errors rather than solar fluctuations .",
    "their standard deviation is 0.0008 , which represents 20 % of the solar cycle variability of the ca k index .",
    "our reconstruction thereby provides a means for fitting the numerous data gaps in the ca k index while also evaluating the confidence interval of the observations .",
    "this study shows that svd - interpolation is a powerful technique for filling arbitrarily large gaps in multi - wavelength , multichannel or in synoptic records .",
    "we focused here on solar spectral irradiance observations , which are frequently plagued by missing data .",
    "these gaps may be distributed at random in time or in wavelength .",
    "the main tuneable parameter is the number of svd modes that is needed to reconstruct the data ; this value may be estimated either by visualisation or by cross - validation .",
    "the method works best when each record can be approximated by a linear combination of the others .",
    "since it relies on linear combinations only , it may be desirable to apply a nonlinear static transform beforehand to increase the linear correlation between the records .    for the method to work ,",
    "the observations must be sampled simultaneously but not necessarily evenly .",
    "non - simultaneous observations can be handled by resampling all variables to a common grid , for example by fourier decomposition ( e.g. * ? ? ?",
    "* ) , and then filling the gaps by svd . by alternating between the two ,",
    "both the gaps and the interpolated values can be progressively refined .",
    "this method has several applications in addition to mere interpolation .",
    "the first one is the cross - calibration of measurements of the same quantity by different instruments .",
    "the mg ii index , for example , is at present measured by different instruments that give different amplitudes .",
    "these data sets are incomplete and only partly overlap , which considerably impairs their inter - comparison . the iterative svd method is ideally suited for filling these gaps because the records are by definition strongly correlated .",
    "a second potential application is the stitching together of total solar irradiance ( tsi ) observations . merging tsi records from several instruments",
    "is a delicate and controversial task @xcite because instruments disagree on the absolute value of the tsi and often do not operate simultaneously .",
    "the iterative svd provides a means for estimating the different offsets in a self - consistent way because it allows us to extrapolate each tsi record by assuming that its statistical properties with respect to the other records do not change in time .",
    "this property is particularly useful for checking composites that are built from different records , such as the tsi , the h i lyman @xmath30 intensity , the mg ii index and the sunspot index @xcite .",
    "this will be detailed in a forthcoming publication .",
    "i thank the following institutes for providing the data : the laboratory for atmospheric and space physics ( university of colorado ) for the mg ii and h i lyman @xmath30 composites , the national solar observatory at sacramento peak ( data produced cooperatively by nsf / noao , nasa / gsfc and noaa / sec ) for the ca k index , the mount wilson observatory ( operated by ucla , with funding from nasa , onr and nsf , under agreement with the mt .",
    "wilson institute ) for the mpsi index and the space sciences center ( university of southern california ) for the sem data .",
    "this study received funding from the european community s seventh framework programme ( fp7/2007 - 2013 ) under the grant agreement nr .",
    "218816 ( soteria project , http://www.soteria-space.eu ) .",
    ", s.  l. , henry , t.  w. , and fleck , b. ( 1998 ) . .",
    "in balasubramaniam , k.  s. , harvey , j. , and rabin , d. , editors , _ synoptic solar physics _ , volume 140 of _ astronomical society of the pacific conference series _ , pages 301308 ."
  ],
  "abstract_text": [
    "<S> data gaps are ubiquitous in spectral irradiance data , and yet , little effort has been put into finding robust methods for filling them . </S>",
    "<S> we introduce a data - adaptive and nonparametric method that allows us to fill data gaps in multi - wavelength or in multichannel records . </S>",
    "<S> this method , which is based on the iterative singular value decomposition , uses the coherency between simultaneous measurements at different wavelengths ( or between different proxies ) to fill the missing data in a self - consistent way . </S>",
    "<S> the interpolation is improved by handling different time scales separately .    </S>",
    "<S> two major assets of this method are its simplicity , with few tuneable parameters , and its robustness . </S>",
    "<S> two examples of missing data are given : one from solar euv observations , and one from solar proxy data . </S>",
    "<S> the method is also appropriate for building a composite out of partly overlapping records . </S>"
  ]
}