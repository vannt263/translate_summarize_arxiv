{
  "article_text": [
    "the fermi operator expansion ( foe ) and the kernel polynomial method ( kpm ) achieve linear scaling electronic structure computations by an iterative evaluation of a local hamiltonian .",
    "the two methods appear to follow different strategies for the evaluation of forces and energies .",
    "the foe expands the occupation number of the eigenstates represented by a temperature dependent smearing function .",
    "if the smearing function , which corresponds to the heaviside step function at zero temperature , is represented by a smooth expansion , then the resulting density matrix is short ranged and thus local .",
    "the smoothing of the step function is expected to be efficient in particular for systems with a band gap at the fermi level , thus the foe is often portrayed as being applicable in particular for insulators and semi conductors . in the kernel polynomial method ( kpm ) the density of states is convoluted with a kernel that leads to a smoothed representation of the density of states .",
    "the kernel corresponds to a broadened representation of a dirac delta function , and a broader kernel implies a more local evaluation of the energy .",
    "the kpm obtains energies and forces from the density of states and in this way avoids the explicit computation of the density matrix .",
    "therefore it is often seen as a method that is suitable for simulations in metals with their long - ranged density matrix .",
    "the kpm may be related to recursion based methods that also focus on the density of states.@xcite    we will first compare and contrast the foe and the kpm and then show how the two methods are closely related . from this straightforward analysis the smoothing of the density of states in the kpm may be understood as a temperature broadening , which will then lead us to suggest a new kernel for the kpm .",
    "the new kernel performs practically as well as the standard kernel .    in _ ab - initio _ or",
    "tight - binding electronic structure calculations , the electronic temperature @xmath0 is typically introduced by applying a smearing function at the fermi level . the band energy and electron count",
    "are then obtained as @xmath1 where @xmath2 is the electron chemical potential , @xmath3 the temperature dependent smearing function and @xmath4 the density of states . at @xmath5k",
    "the smearing is zero and @xmath6 corresponds to the heaviside step function @xmath7 which is one below the fermi energy and zero above . in the fermi operator expansion ( foe )",
    "method@xcite the density matrix is locally approximated by writing it as @xmath8 where @xmath9 is the spectrally resolved density matrix .",
    "the diagonal elements @xmath10 of the spectrally resolved density matrix correspond to the local density of states associated with orbital @xmath11 , such that the number of electrons in this orbital is obtained as , @xmath12 the moments of the spectrally resolved density matrix and the local density of states may be related to expectation values that can be computed from hamiltonian matrix elements alone , @xmath13 therefore , by writing a polynomial expansion of the smearing function @xmath14 an expansion of the density matrix may be obtained , @xmath15 this is the basis for the fermi operator expansion , where in practice chebyshev polynomials are used instead of a direct polynomial expansion@xcite .",
    "the band energy is then obtained in intersite representation , @xmath16 which for @xmath5k is equivalent to the onsite representation eq .",
    "( [ eq : onsite ] ) .",
    "clearly the band energy according to eq.([eq : onsite ] ) may also be directly expanded using eq.([eq : poly ] ) , @xmath17 which follows directly from eq.([eq : mom ] ) .    in the kernel polynomial method",
    "@xcite one takes a different approach to the calculation of the number of electrons and the band energy . in a first step an approximate density of states @xmath18",
    "is obtained from @xmath19 where @xmath20 is the local density of states and @xmath21 the kernel .",
    "the kernel is expanded in chebyshev polynomials , making use of the moments theorem eqs.([eq : int],[eq : mom ] ) . a strictly positive representation of @xmath21 guarantees that the resulting density of states @xmath18 is also strictly positive .",
    "the number of electrons and the band energy is then obtained from @xmath22 here we adopt a slightly different approach to relating the foe and kpm formally by introducing @xmath23 and @xmath24    the energy and number of electrons may be obtained from @xmath25 from eq.([eq : mfoe ] ) and ( [ eq : mkpm ] ) it is evident that the fermi operator expansion and the kernel polynomial method converge to the same limit when @xmath6 becomes a step function at @xmath5k and the kernel @xmath26 approaches the delta function as the number of moments in the expansion is increased .",
    "clearly at finite temperature or a finite number of moments foe and kpm will be different ; here we compare the two approaches to lowest order .",
    "we assume that we may identify @xmath27 in expression ( [ eq : mfoe ] ) and ( [ eq : mkpm ] ) , where @xmath28 is the fermi level in the kpm . then , by taking the derivative w.r.t . @xmath2 and integrating over @xmath29 , the following identity has to hold @xmath30 if no further assumptions regarding the local density of states @xmath31 are made . as expected , we may understand the kernel as the width of the smearing function that is indicated by a non - zero first derivative . a systematic study of different smearing functions by liang _",
    "et al._@xcite has indicated that the most rapid convergence for a foe is found by using a complementary error function as the electronic distribution function , i.e. , @xmath32 \\,,\\ ] ] where the width @xmath33 acts as an effective `` temperature '' . in this case , @xmath34 so that the underlying kernel is expected to be shaped like a gaussian . the width of the jackson kernel , for example , is given by @xmath35 @xcite and thus @xmath36 in kpm may be used to set the electron temperature in a simulation .",
    "in the following section we illustrate more closely the connection between the kpm and foe , by comparing numerically the results obtained via the two approaches . we consider first an arbitrary function @xmath37 ( which could be the local density of states ) , for which we have evaluated the first @xmath36 chebyshev moments . a pure chebyshev expansion of this function would be given by @xmath38 here @xmath39 are the chebyshev polynomials of the first kind , and the chebyshev moments @xmath40 at points where @xmath37 has discontinuities , for example , in the region of a band gap , the expansion of eq .",
    "( [ eq : cheb_expansion ] ) exhibits gibbs oscillations , which may lead to regions where the density of states is negative . the use of a kernel in eq .",
    "( [ eq : kpm_definition ] ) acts to `` damp '' higher - moment oscillations .",
    "this leads to the introduction of damping coefficients @xmath41 , so that eq .",
    "( [ eq : cheb_expansion ] ) becomes @xmath42 we now determine an approximate expression for the @xmath43 for the case of the gaussian kernel eq .",
    "( [ eq : gaussian_kernel ] ) . in",
    "what follows , we assume that @xmath44 , and @xmath45 , as this will allow us to simplify a number of expressions . the real moments @xmath46 of this distribution are given by @xmath47 for @xmath48 even . by assuming small @xmath33 ,",
    "we can write the chebyshev moments ( of the first kind ) @xmath49 , by making use of the recurrence relations of the chebyshev polynomials : @xmath50 thus , the first few ( even ) chebyshev moments are given by : @xmath51 if @xmath52 , @xmath53 becomes simply the dirac delta function , @xmath54 , whose ( even ) chebyshev moments are simply @xmath55 for each @xmath48 , the damping factor @xmath56 will be simply the ratio @xmath57 . for small @xmath48 , and since @xmath44 , we can omit ( approximately ) terms of @xmath58 and above , hence the damping factors become @xmath59 these damping coefficients have been derived for a number of existing kernels@xcite , and are illustrated in fig . [",
    "fig : damping_coefficients ] . of particular interest is the jackson kernel , which guarantees a strictly positive density of states , while simultaneously minimising the broadening of the spectral function . in fig .",
    "[ fig : damping_coefficients ] , and throughout the rest of the paper , we choose the parameter @xmath35 .",
    "this choice is motivated by weie et al .",
    "@xcite , who have shown that the reproduction of the delta function via the jackson kernel is a good approximation to a gaussian of this width .",
    "it is noteworthy that , of the kernels considered here , the damping coefficients for the gaussian kernel are the only ones which do not go to zero as @xmath60 .    to demonstrate the effects of the smearing caused by the damping coefficients ,",
    "the various kernels are applied to the problem of reproducing the delta function ; the results are illustrated in fig .",
    "[ fig : delta_function ] for @xmath61 .",
    "the dirichlet kernel , which corresponds to the undamped expansion eq .",
    "( [ eq : cheb_expansion ] ) , demonstrates large gibbs oscillations .",
    "the jackson kernel , although significantly broadening the peak , has no negative values for the reproduced functions .",
    "the lanczos @xmath62 kernel gives similar results to the jackson , without guaranteeing a strictly positive function .",
    "the gaussian kernel , with @xmath63 is extremely similar to the jackson kernel as anticipated .",
    "having established the connection between the kpm and foe approaches , we move on to examine the performance of the two approaches when applied to real electronic structure models . as a test case , we have taken the orthogonal tight - binding ( tb ) model for carbon from xu@xcite , and examined the convergence of the band energy as a function of moments , for the various kernels .",
    "the tight - binding electronic structures for carbon in the diamond and graphite structures are illustrated in fig [ fig : carbon_tb_dos ] .",
    "the diamond structure exhibits a band - gap of @xmath64 ev , while the graphite structure has a semi - metallic dos , with a narrow anti - resonant feature at the fermi level .",
    "due to the narrowness of these features in relation to the bandwidth of the system , we can anticipate that a relatively large number of moments are needed to accurately reproduce the total energy of the system .    in figs .",
    "[ fig : carbon_dos_20moments ] and [ fig : carbon_dos_40moments ] , the densities of states of the diamond and graphite structures are shown for the various kernel approximations for @xmath65 and @xmath66 respectively . in figure",
    "[ fig : carbon_dos_20moments ] , the undamped dirichlet kernel appears to show fast convergence , in particular in the reproduction of the band - gap of diamond . however , large gibbs oscillations mean that the density of states for diamond has negative regions within the gap , which in turn results in the electron count being a multi - valued function of the energy and ambiguity in the determination of the valence band maximum .",
    "the gaussian and jackson kernels produce rather similar results , with differences only apparent toward the edge of the bandwidth .",
    "the lanczos @xmath67 kernel produces reasonable convergence , without producing negative dos in the band - gap . in the case of graphene ,",
    "it is clear that @xmath65 is insufficient to fully reproduce the complexity of the tb dos , with only rather general features of the electronic structures being recovered . in figure",
    "[ fig : carbon_dos_40moments ] , the increased number of moments provides much more realistic reproduction of the tb dos . in the case of diamond ,",
    "all kernels produce a reasonable description of the electronic structure ; however , the undamped case exhibits significant gibbs oscillations in the gap region . in the case of graphene ,",
    "the broadening introduced by the gaussian and jackson kernels removes much of the local structure around the fermi level , while the lanczos @xmath67 kernel reproduces much of the local structure with the only negative regions of the dos appearing at the band edges .    in figure",
    "[ fig : carbon ] , the error in the band energy ( compared to exact diagonalisation ) is shown as a function of the number of moments , for both diamond and graphene .",
    "the dirichlet kernel , although closest at low moments , oscillates significantly around the true energy in both cases .",
    "the gaussian , lanczos @xmath62 and jackson kernels all converge monotonically from above to the exact value . as expected , the convergence for graphite is slower with @xmath36 , with @xmath68 required to have energy convergence @xmath69 mev / atom for the gaussian , lanczos @xmath62 and jackson kernels .",
    "the non - variational behaviour of the dirichlet and lanczos @xmath67 approaches becomes more clear when full energy - volume curves are evaluated . in figure",
    "[ fig : energies_20moments ] , the energies of diamond and graphene as a function of lattice constant are shown for the various approaches ( with @xmath65 ) and compared with well - converged tb results . in the case of diamond ,",
    "the dirichlet and lanczos @xmath67 kernels undershoot the tb energies , with a reasonable prediction of the lattice constant and bulk modulus .",
    "the much smoother gaussian and jackson kernels give significantly higher energies , ostensibly due to an elevated effective electronic temperature . in the case of graphene , both the dirichlet and lanczos @xmath67 kernels have energies above the tb result , thus falsely stabilising the diamond structure over the graphene .",
    "even though the energy error for the jackson kernel is of the order of @xmath70 ev , the energetic ordering between the two crystal structures is in good agreement with the tb result . in fig",
    "[ fig : energies_40moments ] , the results for @xmath66 are shown . in the case of diamond ,",
    "all kernels give a reasonable description of the lattice constant and bulk modulus , with the exception of the dirichlet kernel , which arises from the multivaluedness of the electron number due to the negative dos within the band gap .",
    "for graphene , the slower convergence in energy with @xmath36 is apparent even at @xmath66 , with all damped kernels stabilising the diamond structure over graphene . in order to reliably determine energy differences ,",
    "it is essential that the key features of the density of states are reproduced ; the smearing out of the anti - resonance feature at the fermi level in graphene has a significant effect on the total energy , even if the lattice constant is in fair agreement with the tb reference .",
    "the results here show the ability of the kpm to reproduce , in a smooth and rigorous manner , the total energy of these systems , as well as the challenges of such an approach to reproduce narrow spectral features which drive small energy differences between structures . in a realistic calculation",
    ", the number of moments required to reliably describe the allotropes of carbon would be prohibitively expensive to evaluate exactly , thereby necessitating a means of estimating higher chebyshev moments from lower ones .",
    "one recent approach@xcite is to estimate these from the krylov subspace generated by lanczos recursion approaches to the same problem .",
    "a connection between the kpm and the foe approach to linear - scaling electronic structure calculations has been made .",
    "we have shown that the width of the kernel in the kpm may be related directly to the electronic temperature .",
    "the use of a complementary error function as an electronic smearing function in the foe is consistent with assuming a gaussian kernel within the kpm .",
    "moreover , while in the foe , the expansion coefficients @xmath71 of eq .",
    "( [ eq : poly ] ) must be re - evaluated for each change in chemical potential , this is not necessary within the kpm . therefore , while the direct foe and gaussian kernel kpm method give virtually identical answers , the kpm approach is computationally more efficient .",
    "10                wanzhen liang , chandra saravanan , yihan shao , roi baer , alexis  t. bell , and martin head - gordon .",
    "improved fermi operator expansion methods for fast electronic structure calculations .",
    ", 119(8):4117 , 2003 ."
  ],
  "abstract_text": [
    "<S> linear - scaling electronic structure methods based on the calculation of moments of the underlying electronic hamiltonian offer a computationally efficient and numerically robust scheme to drive large - scale atomistic simulations , in which the quantum - mechanical nature of the electrons is explicitly taken into account . </S>",
    "<S> we compare the kernel polynomial method to the fermi operator expansion method and establish a formal connection between the two approaches . </S>",
    "<S> we show that the convolution of the kernel polynomial method may be understood as an effective electron temperature . </S>",
    "<S> the results of a number of possible kernels are formally examined , and then applied to a representative tight - binding model . </S>"
  ]
}