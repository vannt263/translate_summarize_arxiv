{
  "article_text": [
    "the goal of this paper is to provide a numerical investigation of the so - called _ soliton dynamics _",
    "behaviour for the nonlinear schrdinger equation with an external time independent smooth potential @xmath2 @xmath3 that is the qualitative behaviour of the solution @xmath4 in the semi - classical regime , namely for @xmath5 ( which of course plays the rle of planck s constant ) going to zero , by taking as initial datum a ( bump like ) function of the form @xmath6 we shall assume that @xmath7 , @xmath8 , @xmath9 is the imaginary unit and @xmath10 is the unique  @xcite ( up to translations ) positive and radially symmetric solution of the elliptic problem @xmath11 for some value @xmath12.finally , @xmath13 and @xmath14 are given vectors in @xmath15 that should be conveniently thought ( in the transition from quantum to classical mechanics ) as corresponding to the _ initial position _ and _ initial velocity _ respectively of a point particle .    in this framework , since   has a conservative nature , the typical expected behaviour is that the solution travels with the shape of @xmath16 ( hence its support shrinks , as @xmath5 gets small ) along a suitable concentration line @xmath17 merely depending on the potential @xmath2 and starting at @xmath13 with initial slope @xmath14 .",
    "on the basis of the analytical results currently available in literature ( see the discussion in section [ theoryfacts ] ) , we believe that providing some numerical study is useful to complete the overall picture of this phenomenon and furnish some practical machinery for the computation of the solutions of   and , in turn , of  - .",
    "the authors are not aware of any other contribution in the literature on this issue . for the linear schrdinger",
    ", some results can be found in @xcite .",
    "it is well - known that , given a positive real number @xmath18 , the afore mentioned ( ground state ) solution @xmath0 of   ( where the value of @xmath19 depends on @xmath18 ) can obtained through the following variational characterization on the sphere of @xmath20 @xmath21 where @xmath22 is the @xmath23 energy functional @xmath24 furthermore , there exists a suitable choice of @xmath18 yielding @xmath25 as eigenvalue in equation  .",
    "the restriction to the values of @xmath26 below @xmath27 is strictly related to the global well - posedness of   for any choice of initial data @xmath28 in @xmath29 .",
    "if @xmath26 is larger than or equal to @xmath27 , then the solution can blow - up in finite time ( see e.g.  the monograph by t.  cazenave  @xcite ) . in particular , in the two dimensional case , @xmath26 will be picked in @xmath30 .    from the analytical side ,",
    "it has been rigorously known since 2000 that the solution @xmath4 of   remains close to the ground state @xmath0 , in the sense stated here below , locally uniformly in time , as @xmath5 is pushed to zero .",
    "as we said , this dynamical behaviour is typically known as soliton dynamics ( for a recent general survey on solitons and their stability , see the work of t.  tao  @xcite ) .",
    "for the nonlinear equation  , rigorous results about the soliton dynamics were obtained in various papers by j.c .",
    "bronski , r.l .",
    "jerrard  @xcite and s.  keraani  @xcite .",
    "we also refer to  @xcite for a complete study of the problem with the additional presence of an external time independent magnetic vector potential @xmath31 , and to  @xcite for a study of a system of two coupled nonlinear schrdinger equations , a topic which is rapidly spreading in the last few years . the arguments are mainly based upon the following ingredients : the energy convexity estimates proved by m.  weinstein  @xcite to get the so called modulational stability , the use of conservation laws ( mass and energy ) satisfied by the equation and by the associated hamiltonian system in @xmath15 built upon the guiding external potential @xmath2 , that is the classical _ newton law _ @xmath32 under reasonable assumptions on @xmath2 ( e.g.  uniform boundedness of the second order partial derivatives ) , equation admits a unique global solution @xmath33 which satisfies the following conservation law @xmath34 let us now define a suitable scaling of the standard norm of @xmath35 @xmath36 the precise statement of the soliton dynamics reads as follows    [ anal11 ] let @xmath4 be the solution to problem corresponding to the initial datum  .",
    "then there exists a family of shifts @xmath37 such that , as @xmath5 goes to zero , @xmath38 is equal to the function @xmath39 } , \\qquad x\\in{{\\mathbb r}}^n,\\,\\,t>0,\\ ] ] up to an error function @xmath40 such that @xmath41 , locally uniformly in time .",
    "it is important to stress that , in the particular case of _ standing wave solutions _ of  , namely special solutions of   of the form @xmath42 where @xmath43 is a real - valued function , there is an enormous literature regarding the semi - classical limit for the corresponding elliptic equation @xmath44 see the recent book  @xcite by a.  ambrosetti and a.  malchiodi and the references therein . to this regard notice",
    "that , if @xmath45 ( null initial velocity ) and @xmath13 is a critical point of the potential @xmath2 , as equation   admits the trivial solution @xmath46 and @xmath47 for all @xmath48 , formula   reduces to @xmath49 so that the concentration of @xmath4 is _ static _ and takes place at @xmath13 , instead occurring along a smooth concentration curve in @xmath15 .",
    "this is consistent with the literature for the standing wave solutions mentioned above .",
    "for other achievements about the full dynamics of  , see also  @xcite ( in the framework of orbital stability of standing waves ) as well as  @xcite ( in the framework of non - integrable perturbation of integrable systems ) .",
    "similar results were investigated in geometric optics by a different technique ( wkb method ) , namely writing formally the solution as @xmath50 , with @xmath51 where @xmath52 and @xmath53 are solutions , respectively , of a hamilton - jacobi type equation ( the eikonal equation ) and of a system of transport equations . in presence of a constant external potential , the orbital stability issue for problem",
    "was investigated by t.  cazenave and p.l .",
    "lions  @xcite , and by m.  weinstein in  @xcite .",
    "then , a.  soffer and m.  weinstein proved in  @xcite the asymptotic stability of nonlinear ground states of  .",
    "see also the following important contributions : v.  buslaev and g.  perelman  @xcite , v.  buslaev and c.  sulem  @xcite , j.  frhlich , s.  gustafson , l.  jonsson , i.m .",
    "sigal , t .-",
    "tsai and h .-",
    "yau  @xcite , j.  holmer and zworski  @xcite , a.  soffer and m.  weinstein  @xcite , t .- p .",
    "tsai and h .-",
    "yau  @xcite .",
    "another interesting problem concerns the case where the initial datum is multibump ( for simplicity two bumps ) , say , @xmath54 where @xmath55 are solutions to the problem @xmath56 for some fixed @xmath57 , @xmath58 and @xmath59 are taken as initial data for @xmath60    then we state the following    let @xmath4 be the solution to   corresponding to the initial datum  .",
    "then there exist two families of shifts @xmath61 such that , as @xmath5 goes to zero , @xmath38 is equal to the function @xmath62 } + r_2\\big(\\frac{x - y(t)}{{\\varepsilon}}\\big)e^{\\frac{{\\rm i}}{{\\varepsilon}}\\left[x\\cdot   \\dot y(t)+\\teta_{{\\varepsilon}}^2(t)\\right]},\\ ] ] up to an error function @xmath40 depending both on @xmath5 and on the initial relative velocity @xmath63 ( the larger is @xmath64 the smaller is the error ) , locally uniformly in time .",
    "see figure [ fig:2 ] in the final section for a movie showing this behaviour .",
    "in the numerical simulations included in the last section of the paper , we shall consider the two dimensional case . on the other hand , here we consider the general case .",
    "our purpose is to solve the schrdinger equation @xmath65 where @xmath66 , so that @xmath67 is the solution of @xmath68 being @xmath69 real , positive and minimizing the energy   under the constraint @xmath70 . instead of a direct minimization of the energy ( see , e.g. , @xcite ) ,",
    "here we consider the following parabolic differential equation @xmath71 with vanishing boundary conditions , where the map @xmath72 is defined by @xmath73 this approach is similar to the imaginary time method ( see , e.g. , @xcite ) , based on the propagation of the schrdinger equation along imaginary time @xmath74 and projection to the @xmath75 sphere of radius @xmath76 . in equation",
    ", projection is not necessary and the energy decreases : in fact , if we multiply equation   by @xmath77 and integrate over @xmath78 , we easily get @xmath79 and if we multiply equation   by @xmath80 and integrate over @xmath78 , we get @xmath81 hence , the steady - state solution @xmath82 of   satisfies @xmath83 and has a minimal energy .",
    "in fact , notice that by the results of  @xcite , for any @xmath12 there exists a unique ( up to translations ) positive and radially symmetric solution @xmath84 of  . in turn , given @xmath85 , if @xmath86 denote , respectively , the positive radial solutions of the equations @xmath87 then it is readily verified that @xmath88 which tells us that that , up to a scaling , the solution corresponding to different values of @xmath19 is unique .",
    "notice now that , due to the choice of the bump like initial datum ( gaussian like , see  ) in the iterations to compute @xmath89 ( see the discussion below ) , it turns out that @xmath90 , defined as @xmath91 , is negative and @xmath89 is positive , radially symmetric ( see figure  [ fig:0 ] ) and solves @xmath92 where @xmath93 . if @xmath94 denotes the ground state solution ( with the corresponding positive eigenvalue denoted by @xmath95 ) , then we have @xmath96     of   with @xmath97 and @xmath98 . of course , in the computation of @xmath89 , there is a spurious imaginary part of maximum value around @xmath99 , since the complex fft algorithm is involved .",
    "the corresponding value of @xmath90 is @xmath100 . ]    on the other hand , by construction , we have @xmath101 namely @xmath102 . finally , by the definition of @xmath103 and @xmath104 in  , we get @xmath105 and @xmath106 , yielding from   the desired conclusion , that is @xmath107 moreover , @xmath108 is a solution of",
    ". we will take @xmath109 as our candidate initial condition for the time - dependent nonlinear schrdinger equation  . from a numerical point of view , it is convenient to compute directly @xmath110 instead of @xmath111 and to apply the change of variable @xmath112{\\varepsilon^n}\\phi_\\varepsilon(x , t)$ ] , @xmath113 , to the nonlinear schrdinger equation  , and hence to equation  .",
    "altogether , we need to solve @xmath114 with @xmath115 where @xmath116{\\varepsilon^n}$ ] . since it is not possible to numerically integrate the equation up to an infinite time , we will consider @xmath117 the steady - state as soon as @xmath118 is stabilized within a prescribed tolerance .",
    "the initial condition @xmath119 can be arbitrarily chosen ( in the class of bump like functions ) , but an initial solution with small energy will shorten the `` steady - state '' time @xmath120 . among the family of the gaussian functions parameterized by @xmath121 @xmath122{\\left(\\frac{\\varepsilon}{\\pi}\\right)^n}\\ ] ] with @xmath123 it is possible to choose the one with minimal energy .",
    "in fact @xmath124 if we define @xmath125 the minimum for @xmath126 is attained for @xmath127 the quantities @xmath128 and @xmath129 can be analytically computed and give @xmath130      with the normalization introduced above , the nonlinear schrdinger equation to solve is @xmath131 a well - established numerical method for the cubic schrdinger equation ( focusing or defocusing case ) is the strang splitting @xcite .",
    "it is based on a split of the full equation into two parts , in which the first is spectrally discretized in space and then exactly solved in time and the second has an analytical solution .",
    "we used the strang splitting method as well .",
    "the first part is    @xmath132    thus , the fourier coefficients of @xmath133 restricted to a sufficiently large space domain satisfy a linear and diagonal system of odes , which can be exactly solved .",
    "the second part is @xmath134    it is easy to show that the quantity @xmath135 is constant in time for this equation .",
    "then it has an analytical solution .",
    "given the approximated solution @xmath136 of equation  , a single time step of the strang splitting fourier spectral method can be summarized in    1 .",
    "take @xmath137 as initial solution at time @xmath138 for   and solve for a time step @xmath139 , obtaining @xmath140 ; 2 .",
    "take @xmath140 as initial solution at time @xmath138 for and solve for a time step @xmath141 , obtaining @xmath142;[realspace ] 3 .",
    "take @xmath142 as initial solution for   and solve for a time step @xmath139 , obtaining @xmath143 .",
    "the result @xmath143 is an approximation of @xmath144 .",
    "since the solutions of the first part and the second part are trivial to compute in the spectral space and in the real space , respectively , it is necessary to transform the solution from spectral space to real and from real space to spectral before and after step   above , respectively .",
    "all the transformations can be carried out by the fft algorithm .",
    "the method turns out to be spectrally accurate in space and of the second order in time .",
    "therefore , we used the fourier spectral decomposition for the solution of equation  , too .",
    "together with the galerkin method , it yields a nonlinear system of odes @xmath145 where @xmath146 is the vector of fourier coefficients , @xmath147 the diagonal matrix of the eigenvalues of the laplace operator and @xmath148 the truncated fourier expansion of the whole nonlinear part of equation  .",
    "for the solution of equation   we used an exponential runge ",
    "kutta method of order two ( see , e.g. ,",
    "@xcite ) , with the embedded exponential euler method .",
    "given the approximation @xmath149 , a single time step of the method is    1 .",
    "set @xmath150 and @xmath151 ; 2 .",
    "compute @xmath152 ( exponential euler method ) ; 3 .   compute @xmath153[error ]    where @xmath154 and @xmath155 are the analytic functions @xmath156 the result is an approximation of @xmath157 .",
    "exponential integrators are explicit and do not suffer of time step restrictions .",
    "however , they require the computation of matrix functions . in our case ,",
    "the matrices involved @xmath158 are diagonal and the computation of the matrix functions @xmath159 , @xmath160 and @xmath161 is trivial . in order to compute the terms @xmath162 and @xmath163 , it is necessary to recover the functions in the real space corresponding to the fourier spectral coefficients @xmath164 and @xmath165 , respectively , then compute the nonlinear part of equation   and finally to compute its fourier transform .",
    "all the transformations can be carried out by the fft algorithm .",
    "the term @xmath166 in step  ( [ error ] ) above can be used as an error estimate for @xmath167 and then it is possible to derive a variable time step integrator .",
    "this is particularly useful for our aim of computing the steady - state of the equation : in fact , we expect that the as soon as the solution approaches the steady - state it is possible to enlarge the time step , thus reducing the computational cost .",
    "the method turns out to be spectrally accurate in space and of the second order in time .",
    "in this section , in order to provide some examples , we reduce to the two dimensional setting and focus on the physically relevant case of harmonic potential @xmath168 well - established in the theory of bose - einstein condensates . in the two movies starting from figure  [ fig:1 ]",
    "we show the dynamics of the solitary wave along two lissajous curves , periodic in the left side and ergodic for the right side . in the movie starting from figure  [ fig:2 ]",
    "we report the soliton dynamics in the case of an initial datum exhibiting a double bump behaviour ( with a sufficiently large distance between the centers ) up to the collision time .",
    "it is important to stress that in these figures the paths have an analytic expression and are plotted before the dynamics starts .",
    "the movies will then show that the centers of mass of the solitons follow adherently these curves up to the final computation time .",
    "an analysis of the error ( in the single bump case ) arising when the modulus of the solution @xmath169 is replaced by the modulus of the expression in the representation formula  , namely @xmath16 , is indicated in figure  [ fig:3 ] . as predicted by the analytical property  [ anal11 ]",
    ", the error in the @xmath170 is below the order @xmath171 .",
    "run : movie1bh.avi [ , @xmath172 , @xmath173 , @xmath174 , @xmath175 . in the left movie",
    ", we chose @xmath176 and @xmath177 ( rational ratio ) . in the right movie , we chose @xmath178 and @xmath177 ( irrational ratio ) . notice that , although the ratios @xmath179 are very close in the two examples , the soliton dynamics is ergodic in the right movie .",
    "of course the figures refer to the ( squared modulus of the ) solution at the time @xmath180 and contain the concentration paths ( admitting an analytic expression ) that the soliton is going to travel on.,title=\"fig : \" ] ] run : movie1bhirr.avi [ , @xmath172 , @xmath173 , @xmath174 , @xmath175 . in the left movie",
    ", we chose @xmath176 and @xmath177 ( rational ratio ) . in the right movie , we chose @xmath178 and @xmath177 ( irrational ratio ) . notice that , although the ratios @xmath179 are very close in the two examples , the soliton dynamics is ergodic in the right movie .",
    "of course the figures refer to the ( squared modulus of the ) solution at the time @xmath180 and contain the concentration paths ( admitting an analytic expression ) that the soliton is going to travel on.,title=\"fig : \" ] ]      , @xmath186 , @xmath97 , @xmath187 and a final time @xmath188 . with the change of variable we used , @xmath113 and @xmath189 , we have @xmath190 and @xmath191 .",
    "hence , the numerical error is computed through formula ( written for the 2d case ) @xmath192 . as predicted by the analytical property  [ anal11 ]",
    ", the error in the @xmath170 is below the order @xmath171 . ]"
  ],
  "abstract_text": [
    "<S> we provide some numerical computations for the soliton dynamics of the nonlinear schrdinger equation with an external potential . after computing the ground state solution @xmath0 of a related elliptic equation </S>",
    "<S> we show that , in the semi - classical regime , the center of mass of the solution with initial datum modelled on @xmath0 is driven by the solution of @xmath1 . </S>",
    "<S> finally , we provide some examples and analyze the numerical errors in the two dimensional case when @xmath2 is an harmonic potential . </S>"
  ]
}