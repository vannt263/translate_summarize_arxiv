{
  "article_text": [
    "the simplified toffoli gate realizes the unitary map @xmath0 given by @xmath1 where @xmath2 is an arbitrary state in @xmath3 , @xmath4 denotes the not gate , and @xmath5 a phase gate , @xmath6 the unitary map @xmath7 coincides with the toffoli gate  @xcite on all vectors of the standard basis , except that it maps the state @xmath8 to @xmath9 instead of @xmath8 ; this strong resemblance explains the name .",
    "the simplified toffoli gate has an elegant implementation  @xcite , which is due to margolus  @xcite , see also  @xcite .",
    "it merely requires three controlled - not gates and four single qubit gates :    @xmath10 ) ) ;    qcxcoord : = qcxcoord + qcstepsize ;    qcstepsize : = qcstepsize-4 mm ;       gate(icnd 2 , 1 , gpos 0 , btex $ y$ etex ) ;      gate(icnd 2 , gpos 0 , btex $ z$ etex ) ;    label(btex $ = $ etex,(qcxcoord+1/2qcstepsize , qcycoord[1 ] ) ) ;    qcxcoord : = qcxcoord + qcstepsize ;      wires(2 mm ) ;    gate(gpos 0 , btex $ g$ etex ) ;    cnot(icnd 1 , gpos 0 ) ;    gate(gpos 0 , btex $ g$ etex ) ;    cnot(icnd 2 , gpos 0 ) ;    gate(gpos 0 , btex $ g^\\dagger$ etex ) ;    cnot(icnd 1 , gpos 0 ) ;    gate(gpos 0 , btex $ g^\\dagger$ etex ) ;    wires(2 mm ) ; \\end{emp}\\ ] ]    where @xmath11 the congruence sign indicates equivalence up to a multiplication with a diagonal matrix of phase factors .",
    "there are some alternatives to @xmath7 that differ in some other basis state by a sign , but that is not an essential change .",
    "the simplified toffoli gate can not substitute for the toffoli gate in general , because phase factors are important in true quantum algorithms .",
    "however , if the toffoli gates appear in pairs , then it is possible to adapt the circuit structure to take advantage of the simplified toffoli gate  @xcite .",
    "the saving are quite substantial in this case , because the best implementations of the toffoli gate known to date need _ fourteen _ controlled - not and single qubit gates .",
    "our main result expresses our appreciation of the beautiful structure of the quantum circuit  ( [ circ : margolus ] ) .",
    "we prove that the circuit is optimal in the following sense :    * theorem  m * _ suppose that the simplified toffoli gate @xmath7 is realized by a sequence of controlled - not and single qubit gates .",
    "any such sequence contains at least three controlled - not gates .",
    "if it contains three controlled - not gates , then at least four single qubit gates are needed .",
    "_    our proof reveals that the elegant structure of the circuit  ( [ circ : margolus ] ) is not an arbitrary artifact .",
    "indeed , any optimal quantum circuit realizing @xmath7 is essentially of this form , except that the single qubit gates are possibly different .",
    "we followed the seminal paper  @xcite in our choice of the universal set of gates , because this has been adopted in several textbooks as well .",
    "choosing controlled - not gates and single qubit gates is somewhat arbitrary , but similar arguments can be carried out for other universal sets of quantum gates .",
    "the main reason for our choice is that the number of controlled - not and single qubit gates constitute the prevailing measure of complexity currently used in computer science .",
    "this paper is part of a larger program , where we try to gain a better understanding of basic quantum circuit structures .    _",
    "_ in addition to the gates introduced in ( [ eq : gates ] ) and ( [ eq : gates2 ] ) , we use @xmath12 to denote the hadamard gate .",
    "the state @xmath13 denotes the eigenstate  of  @xmath4 with eigenvalue  @xmath14 .",
    "the most significant qubit is represented by the topmost wire in the quantum circuit notation , and the least significant qubit by the lowest wire .",
    "we denote by @xmath15 the field of complex numbers , and by @xmath16 the field of real numbers .",
    "we review in this section some useful lemmas , all of which are proved in  @xcite",
    ". we will use these results in the proof of theorem  m. recall that it is possible to switch the control and the target qubit of a controlled - not gate by conjugation with hadamard matrices @xmath17 : @xmath18 + 3 mm ) ) ;    qcxcoord : = qcxcoord + qcstepsize ;    qcstepsize : = qcstepsize-4 mm ;    wires(2 mm ) ;    gate(gpos 1 , btex $ h$ etex , 0 , btex $ h$ etex ) ;    cnot(icnd 1 , gpos 0 ) ;    gate(gpos 1 , btex $ h$ etex , 0 , btex $ h$ etex ) ;    wires(2 mm ) ; \\end{emp}\\ ] ] due to this important fact , it suffices to consider controlled - not gates where the control is on a higher significant qubit that the target qubit when we write down the general form of a circuit .",
    "[ lemma : entanglement ] let @xmath19 , @xmath2 be nonzero elements of @xmath3 .",
    "the input @xmath20 to a controlled-@xmath21 gate will produce an entangled output state if and only if @xmath2 is not an eigenvector of @xmath21 and @xmath22 with @xmath23 .",
    "[ lemma : diag ] assume that @xmath2 is an eigenvector of a unitary @xmath24 matrix  @xmath21 with eigenvalue  @xmath25 .",
    "let @xmath19 denote a state in @xmath3 .",
    "if we input @xmath20 to the controlled-@xmath21 gate , then the output is of the form @xmath26 . in particular , the output is not entangled .",
    "a controlled-@xmath21 gate can be realized with two controlled - not gates and several single qubit gates , as follows : @xmath27 + 3 mm ) ) ;    qcxcoord : = qcxcoord + qcstepsize ;    qcstepsize : = qcstepsize-4 mm ;    wires(2 mm ) ;    gate(gpos 1 , btex $ a_1 $ etex , 0 , btex $ b_1 $ etex ) ;    cnot(icnd 1 , gpos 0 ) ;    gate(gpos 1 , btex $ a_2 $ etex , 0 , btex $ b_2 $ etex ) ;    cnot(icnd 1 , gpos 0 ) ;    gate(gpos 1 , btex $ a_3 $ etex , 0 , btex $ b_3 $ etex ) ;                                                                                     wires(2 mm ) ; \\end{emp } } } \\ ] ] the following two lemmas describe some constraints on the gates @xmath28 , and @xmath29 .",
    "we call a single qubit gate sparse if it is realized by a diagonal or antidiagonal @xmath24 matrix .",
    "[ lemma : sparse ] if the matrix @xmath30 is sparse , then @xmath31 are sparse as well .",
    "[ lemma : notsparse ] suppose that @xmath21 is not a multiple of the identity matrix .",
    "if @xmath30 in the circuit ( [ circ : double ] ) is not sparse , then @xmath31 are not sparse either .",
    "we proceed to show that three controlled - not gates are necessary and sufficient in any realization of unitary map @xmath7 by a sequence of controlled - not and single qubit gates .",
    "we first prove that at least two controlled - not operations act on the last qubit :    [ lemma : oneonlast ] suppose there are some interactions between the top two qubits , but only one controlled - not interaction between the two control qubits and the target bit .",
    "the circuit can not realize the margolus map @xmath7 .    _ proof . _",
    "any such circuit can be represented in the form @xmath32 let @xmath33 , and denote by @xmath34 an arbitrary state in @xmath35 .",
    "if we input @xmath36 to the above quantum circuit , then the least significant qubit of the output state is not entangled with the remaining two qubits , regardless of the nature of input state @xmath34 .    however , if we choose the input @xmath37 , then the output of @xmath7 is @xmath38 .",
    "note that the target qubit is entangled with the other two qubits , since @xmath2 can not be an eigenvector of @xmath4 and @xmath5 at the same time . contradiction .",
    "[ corollary ] the target qubit is affected by at least two controlled - not operations .    [",
    "[ two - controlled - not - gates . ] ] two controlled - not gates .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + +    assume there are only two controlled - not gates in the circuit .",
    "taking corollary  [ corollary ] and the identity  ( [ circ : flip ] ) into account , we may assume that both controlled - not gates operate on the target bit .",
    "the control qubits of the two gates have to be different , for otherwise it would not be possible to entangle all input qubits with the outout qubit .    since @xmath39",
    ", we do not need to concern ourselves with the order the two controlled - not gate in such a circuit .",
    "therefore , we may assume that the circuit is of the form @xmath40    [ lemma : twocnot ] the circuit  ( [ circ : twocnot ] ) can not implement the simplified toffoli gate .    _ proof .",
    "_ when the top qubit is @xmath41 , then the circuit  ( [ circ : twocnot ] ) can still entangle the least significant two qubits , contradicting the behavior of @xmath7 .  .",
    "[ corollary2 ] at least three controlled - not gates are necessary in an implementation of the simplified toffoli gate @xmath7 by a sequence of controlled - not and single qubit gates .",
    "[ [ three - controlled - not - gates . ] ] three controlled - not gates .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + +    the remaining argument proceeds by considering all possible configurations of the three controlled - not gates .",
    "initially , we allow an arbitrary number of single qubit operations . thus , we may assume that the target qubit has lesser significance than the control qubit by applying  ( [ circ : flip ] ) , so that we have to consider @xmath42 configurations of controlled - not gates .",
    "we use the pictogram    ( 50,50 ) def cnotconf(expr num ) = begingroup if num=0 : cnot(icnd 1 , gpos 0 ) ; fi ; if num=1 : cnot(icnd 2 , gpos 0 ) ; fi ; if num=2 : cnot(icnd 2 , gpos 1 ) ; fi ; endgroup ; enddef ; def conff(expr a , b , c ) = begingroup cnotconf(a ) ; cnotconf(b ) ; cnotconf(c ) ; qcxcoord : = qcxcoord + 5 mm ; endgroup ; enddef ; setunit 0.5 mm ; qubits(3 ) ; conff(0,2,1 ) ;    as a shorthand for a general quantum circuit of the form  ( [ circ:2diffcontrol ] ) that contains in addition to the specified controlled - not configuration all potential single qubit gates .",
    "we distinguish three different cases that we record here for the orientation of the reader :    ( 50,50 ) def cnotconf(expr num ) = begingroup if num=0 : cnot(icnd 1 , gpos 0 ) ; fi ; if num=1 : cnot(icnd 2 , gpos 0 ) ; fi ; if num=2 : cnot(icnd 2 , gpos 1 ) ; fi ; endgroup ; enddef ; def conff(expr a , b , c ) = begingroup cnotconf(a ) ; cnotconf(b ) ; cnotconf(c ) ; qcxcoord : = qcxcoord + 5 mm ; endgroup ; enddef ; setunit 0.5 mm ; qubits(3 ) ; numeric basex ; numeric basey ; basex : = qcxcoord ; basey : = qcycoord[0 ] ;    label(btex case 1 etex , ( qcxcoord , qcycoord[1 ] ) ) ; qcxcoord : = qcxcoord + 10 mm ; conff(0,2,1 ) ; conff(2,0,1 ) ; conff(2,1,0 ) ; conff(1,2,0 ) ; conff(1,0,2 ) ; conff(0,1,2 ) ;    basey : = basey - 10 mm ; qcxcoord : = basex ; qcyofs : = basey ; initycoord ;    label(btex case 2 etex , ( qcxcoord , qcycoord[1 ] ) ) ; qcxcoord : = qcxcoord + 10 mm ; conff(2,0,0 ) ; conff(0,2,0 ) ; conff(0,0,2 ) ; conff(2,1,1 ) ; conff(1,2,1 ) ; conff(1,1,2 ) ;    basey : = basey - 10 mm ; qcxcoord : = basex ; qcyofs : = basey ; initycoord ;    label(btex case 3 etex , ( qcxcoord , qcycoord[1 ] ) ) ; qcxcoord : = qcxcoord + 10 mm ; conff(1,0,0 ) ; conff(0,1,0 ) ; conff(0,0,1 ) ; conff(0,1,1 ) ; conff(1,0,1 ) ; conff(1,1,0 ) ;    the remaining configurations    ( 50,50 ) setunit 0.5 mm ; qubits(3 ) ; conff(0,0,0 ) ; conff(0,2,2 ) ; conff(1,1,1 ) ; conff(1,2,2 ) ; conff(2,0,2 ) ; conff(2,1,2 ) ; conff(2,2,0 ) ; conff(2,2,1 ) ; conff(2,2,2 ) ;    are excluded because they are ruled out by corollary  [ corollary ] or lack the capability to entangle all three qubits , hence can not implement @xmath7 .",
    "it turns out that only a single configuration allows to realize the simplified toffoli gate  @xmath7 . in most cases , we are able to exclude circuit structures because they exhibit entanglement properties that are inconsistent with the behavior of the simplified toffoli gate  @xmath7 .",
    "we record the following trivial observation :    [ lemma : remainentangled ] suppose that two systems @xmath43 and @xmath44 of qubits are entangled . if the remaining gate operations affect the systems @xmath43 and @xmath44 separately , then @xmath43 and @xmath44 remain entangled .",
    "_ seeking a contradiction , we assume that the resulting output state is not entangled , i.e. , is of the form @xmath45 .",
    "the gate operations leading to this output state can be written in the form @xmath46 , since the operations affect the systems separately .",
    "this would imply that the input state @xmath47 was separable as well , in contradiction to the assumption .",
    "_ case 1 . _",
    "the circuits configuration are in this case characterized by the fact that exactly two controlled - not gates act on the target qubit of  @xmath7 , and they are controlled from different qubits .",
    "the third controlled - not gate is between the two most significant qubits .",
    "it turns out that none of these circuits can implement @xmath7 , even if we allow single qubit gates on all possible positions .",
    "[ lemma:2diffcontrol ] a circuit with one of the configurations    ( 50,50 ) setunit 0.5 mm ; qubits(3 ) ; conff(0,2,1 ) ; conff(2,0,1 ) ; conff(2,1,0 ) ; conff(1,2,0 ) ; conff(1,0,2 ) ; conff(0,1,2 ) ;    can not implement the simplified toffoli gate  @xmath7 .",
    "_ the most general circuit corresponding to the first pictogram is given by @xmath48 seeking a contradiction , we assume that @xmath30 is not sparse . if we provide an input @xmath49 , then the top two quantum bits could possibly get entangled by lemma  [ lemma : entanglement ] , and if so , these two qubits would remain entangled by lemma  [ lemma : remainentangled ] , contradicting the behavior of @xmath7 .",
    "hence , @xmath30 must be sparse .    by the same token",
    ", @xmath50 has to be sparse , because otherwise we can find an input state of the form @xmath51 , such that the most and least significant qubit get entangled , contradicting the behavior of @xmath7 . as a consequence , @xmath29 is sparse as well .",
    "therefore , the behavior of the circuit  ( [ circ:2diffcontrol ] ) on input of @xmath51 , @xmath52 , can be simulated by a circuit of the form @xmath53 where the values of @xmath54 depend on whether @xmath30 and @xmath50 are diagonal or antidiagonal .",
    "it is obvious from this circuit that we can choose a separable state @xmath34 such that the two least significant qubits get entangled , even though the topmost qubit is in the state @xmath41 .",
    "this contradicts the behavior of @xmath7 , thus a circuit of the form ( [ circ:2diffcontrol ] ) can not realize @xmath7 .",
    "in the same way , it is straightforward to see that neither the second nor the third pictogram can realize @xmath7 .    finally , the last three pictograms represent the inverse circuits of the first three , so none of them can realize @xmath7 since @xmath7 is self - inverse .",
    "_ case 2 . _",
    "the circuit configurations of the second case are characterized by the fact that exactly two controlled - not gates act on the target qubit , and both are controlled from the same qubit .",
    "we distinguish in our discussion whether they are controlled by the middle qubit ( _ case 2.1 _ ) , or by the most significant qubit ( _ case 2.2 _ ) .",
    "_ case 2.1 .",
    "_ this case treats the configurations of controlled - not gates that have the pictorial representation    ( 50,50 ) setunit 0.5 mm ; qubits(3 ) ; conff(2,0,0 ) ; conff(0,0,2 ) ; conff(0,2,0 ) ;    [ lemma : a1sparse ] a circuit with one of the controlled - not configurations    ( 50,50 ) setunit 0.5 mm ; qubits(3 ) ; conff(2,0,0 ) ; conff(0,0,2 ) ;    can not implement the simplified toffoli gate  @xmath7 .",
    "_ the most general circuit corresponding to the first pictogram is given by @xmath55 the second pictogram is covered by taking the inverse of the above circuit , hence does not need to be treated separately .",
    "if we input @xmath56 , then the circuit will produce an entangled output state by lemmas  [ lemma : entanglement ] and  [ lemma : remainentangled ] if @xmath30 is not sparse .",
    "hence , @xmath30 has to be sparse , and consequently @xmath50 as well .",
    "if we take the input state @xmath57 with @xmath52 , then the circuit  ( [ circ:2samecntrl1a ] ) has to act identically on @xmath34 .",
    "consequently , we obtain the circuit identity @xmath58 + 3 mm ) ) ;        qcxcoord : = qcxcoord + qcstepsize ;        qcstepsize : = qcstepsize-4 mm ; \\end{emp}\\ ] ] on the other hand , we can derive from the input @xmath59 the circuit identity @xmath60 + 3 mm ) ) ;        qcxcoord : = qcxcoord + qcstepsize ;          cnot(icnd 1 , gpos 0 ) ;                                                   \\end{emp}\\ ] ] combining the previous two circuit identities , we obtain    ( 50,50 )    setunit 2 mm ; qubits(2 ) ;    widegate(2 ) ; gate(gpos 1 , btex @xmath61 etex ) ; normalgate ; wires(1 mm ) ;    label(btex @xmath62 etex,(qcxcoord+1/2qcstepsize , qcycoord[0]+3 mm ) ) ; qcxcoord : = qcxcoord + qcstepsize ;    cnot(icnd 1 , gpos 0 ) ;    which is absurd . therefore",
    ", a circuit of the form  ( [ circ:2samecntrl1a ] ) can not implement  @xmath7 .     a circuit with controlled - not configuration    ( 50,50 ) setunit 0.5 mm ; qubits(3 ) ; conff(0,2,0 ) ;    can not implement the simplified toffoli gate  @xmath7 .    _ proof . _",
    "the most general circuit corresponding to the configuration depicted in the last pictogram is given by @xmath63 once again , we want to show that this circuit structure can not implement  @xmath7 .",
    "we note that @xmath30 and @xmath50 have to be sparse ( for otherwise it would be possible to find a state @xmath52 such that @xmath51 leads to an entangled output state , arguing as in the previous case ) .",
    "the circuit  ( [ circ:2samecntrl1b ] ) has to act as the identity an input state @xmath51 .",
    "thus , we obtain the circuit identity @xmath64 + 3 mm ) ) ;        qcxcoord : = qcxcoord + qcstepsize ;        qcstepsize : = qcstepsize-4 mm ; \\end{emp}\\ ] ] similarly , the input @xmath65 leads to the circuit identity @xmath66 + 3 mm ) ) ;        qcxcoord : = qcxcoord + qcstepsize ;        qcstepsize : = qcstepsize-4 mm ;               wires(2 mm ) ;        gate(icnd 1 , gpos 0 , btex $ y$ etex ) ;        gate(gpos 0 , btex $ z$ etex ) ;              wires(2 mm ) ; \\end{emp}\\ ] ] from circuits  ( [ circ:2samecntrl1b1 ] ) and ( [ circ:2samecntrl1b2 ] ) , we have , @xmath67 + 3 mm ) ) ;        qcxcoord : = qcxcoord + qcstepsize ;        qcstepsize : = qcstepsize-4 mm ;        wires(2 mm ) ;        gate(icnd 1 , gpos 0 , btex $ y$ etex ) ;        gate(gpos 0 , btex $ z$ etex ) ;        wires(2 mm ) ; \\end{emp}\\ ] ] moving @xmath5 to the left - hand side of the equation , we have @xmath68 + 3 mm ) ) ;        qcxcoord : = qcxcoord + qcstepsize ;        qcstepsize : = qcstepsize-4 mm ;        wires(2 mm ) ;              normalgate ;        gate(icnd 1 , gpos 0 , btex $ y$ etex ) ;        wires(2 mm ) ; \\end{emp}\\ ] ] now for any input state @xmath69 , such that @xmath70 is in superposition , @xmath23 , the circuit on the left hand side does not entangle the two qubits .",
    "therefore , by lemma  [ lemma : entanglement ] , we know that @xmath71 has to be an eigenvector of @xmath72 . furthermore , by lemma  [ lemma : diag ] , we have @xmath73 where @xmath74 is one the eigenvalues of @xmath72 , i.e. , @xmath75 or @xmath76 . taking the trace on both sides ,",
    "we get a contradiction .",
    "_ case 2.2 .",
    "_ we now treat the configurations that have the pictorial representation    ( 50,50 ) setunit 0.5 mm ; qubits(3 ) ; conff(2,1,1 ) ; conff(1,2,1 ) ; conff(1,1,2 ) ;    changing the role of the two most significant qubits , we arrive at simplified toffoli gate @xmath77 that is implemented by    ( 50,50 ) setunit 2 mm ; qubits(3 ) ;    gate(icnd 1,2 , gpos 0 , btex @xmath72 etex ) ; gate(icnd 1 , gpos 0 , btex @xmath5 etex ) ;    thus , it is equivalent to use the circuits  ( [ circ:2samecntrl1a ] ) and ( [ circ:2samecntrl1b ] ) of the previous case to implement @xmath77 .    [ lemma : mprime ] circuits with configuration    ( 50,50 ) setunit 0.5 mm ; qubits(3 ) ; conff(2,1,1 ) ; conff(1,1,2 ) ;    can not realize the toffoli gate @xmath7 .",
    "_ we use the above trick and show that circuit  ( [ circ:2samecntrl1a ] ) can not implement  @xmath77 .",
    "we derive from the input state @xmath78 the circuit identity @xmath79 + 3 mm ) ) ;        qcxcoord : = qcxcoord + qcstepsize ;        qcstepsize : = qcstepsize-4 mm ;        wires(2 mm ) ;        gate(icnd 1 , gpos 0 , btex $ z$ etex ) ;        wires(2 mm ) ; \\end{emp}\\ ] ] similarly , the input state @xmath65 yields @xmath80 + 3 mm ) ) ;        qcxcoord : = qcxcoord + qcstepsize ;        qcstepsize : = qcstepsize-4 mm ;        wires(2 mm ) ;        gate(icnd 1 , gpos 0 , btex $ x$ etex ) ;        wires(2 mm ) ; \\end{emp}\\ ] ] we can deduce from circuits  ( [ circ:2samecntrl2a1 ] ) and ( [ circ:2samecntrl2a2 ] ) the relation @xmath81 + 3 mm ) ) ;    qcxcoord : = qcxcoord + qcstepsize ;    qcstepsize : = qcstepsize-4 mm ;    wires(2 mm ) ;    gate(icnd 1 , gpos 0 , btex $ x$ etex ) ;    wires(2 mm ) ; \\end{emp}\\ ] ] which clearly leads to a contradiction",
    ".     circuits with configuration    ( 50,50 ) setunit 0.5 mm ; qubits(3 ) ; conff(1,2,1 ) ;    can not realize the toffoli gate @xmath7 .",
    "_ it suffices to show that circuit  ( [ circ:2samecntrl1b ] ) can not implement @xmath77 .",
    "considering the input state @xmath78 , we obtain the circuit identity @xmath82 + 3 mm ) ) ;        qcxcoord : = qcxcoord + qcstepsize ;        qcstepsize : = qcstepsize-4 mm ;        wires(2 mm ) ;        gate(icnd 1 , gpos 0 , btex $ z$ etex ) ;        wires(2 mm ) ; \\end{emp}\\ ] ] and with input @xmath65 , we get @xmath83 + 3 mm ) ) ;        qcxcoord : = qcxcoord + qcstepsize ;        qcstepsize : = qcstepsize-4 mm ;        wires(2 mm ) ;        gate(icnd 1 , gpos 0 , btex $ x$ etex ) ;        wires(2 mm ) ; \\end{emp}\\ ] ] combining circuits  ( [ circ:2samecntrl2b1 ] ) and  ( [ circ:2samecntrl2b2 ] ) , we have , @xmath84 + 3 mm ) ) ;        qcxcoord : = qcxcoord + qcstepsize ;        qcstepsize : = qcstepsize-4 mm ;        wires(2 mm ) ;        gate(icnd 1 , gpos 0 , btex $ y$ etex ) ;        wires(2 mm ) ; \\end{emp}\\ ] ] similar to the proof for circuit  ( [ circ:2samecntrl1b4 ] ) , we again arrive at a contradiction after considering the trace .     _ case 3 .",
    "_ we now examine five of the remaining six configurations .",
    "circuit configurations of the form    ( 50,50 ) setunit 0.5 mm ; qubits(3 ) ; conff(1,0,0 ) ; conff(0,0,1 ) ; conff(1,1,0 ) ; conff(0,1,1 ) ;    can not implement the simplified toffoli gate  @xmath7 .    _ proof . _",
    "the most general circuit corresponding to the first configuration in the statement of the lemma is of the form @xmath85 following the same steps as in the proofs of lemmas  [ lemma : a1sparse ] and  [ lemma : mprime ] ,",
    "it is straightforward to see that such a circuit can not realize @xmath7 nor @xmath77 . therefore , the first and the third configuration can be ruled out .",
    "the other two configurations can be ruled out by realizing that @xmath7 is self - inverse .",
    "the circuit configuration    ( 50,50 ) setunit 0.5 mm ; qubits(3 ) ; conff(1,0,1 ) ;    can not implement the simplified toffoli gate  @xmath7 .    _ proof . _",
    "it suffices to prove that the circuit @xmath86 can not realize @xmath77 . as in lemma",
    "[ lemma : a1sparse ] , we note that both @xmath30 and @xmath50 have to be sparse .",
    "considering input states of the form @xmath78 , it follows from circuit  ( [ circ:3cntrlb ] ) that the circuit identity @xmath87 + 3 mm ) ) ;        qcxcoord : = qcxcoord + qcstepsize ;        qcstepsize : = qcstepsize-4 mm ;        wires(2 mm ) ;        gate(icnd 1 , gpos 0 , btex $ z$ etex ) ;        wires(2 mm ) ; \\end{emp}\\ ] ] must hold .",
    "we derive from the action on the input @xmath65 the circuit identity @xmath88 + 3 mm ) ) ;        qcxcoord : = qcxcoord + qcstepsize ;        qcstepsize : = qcstepsize-4 mm ;        wires(2 mm ) ;        gate(icnd 1 , gpos 0 , btex $ x$ etex ) ;        wires(2 mm ) ; \\end{emp}\\ ] ] combining circuits  ( [ circ:3cntrlb1 ] ) and  ( [ circ:3cntrlb2 ] ) , we have , @xmath89 + 3 mm ) ) ;        qcxcoord : = qcxcoord + qcstepsize ;        qcstepsize : = qcstepsize-4 mm ;        wires(2 mm ) ;        gate(icnd 1 , gpos 0 , btex $ y$ etex ) ;        wires(2 mm ) ; \\end{emp}\\ ] ] the right hand side of  ( [ circ:3cntrlb3 ] ) can not produce entangled output states when provided with the input states @xmath90 and @xmath91 .",
    "it follows that either @xmath92 or @xmath93 holds .",
    "taking the trace on both side , we arrive at a contradiction in either case .",
    "_ final step .",
    "_ we have now excluded 26 of the 27 possible control - not configurations .",
    "we know that the only viable configuration    ( 50,50 ) setunit 0.5 mm ; qubits(3 ) ; conff(0,1,0 ) ;    actually allows to realize the simplified toffoli gate  @xmath7 . the general circuit associated with the circuit configuration is of the form  ( [ circ:3cntrlb ] )",
    ".    at least four single qubit gates are necessary in any realization of the simplified toffoli gate @xmath7 with three controlled - not gates .",
    "_ proof . _ the only viable general circuit structure with three controlled - not gate is given by the circuit  ( [ circ:3cntrlb ] ) .",
    "we will show that at least four single qubit gates in this circuit differ from multiples of the identity , and that the gate count can not be reduced by flipping the gates using  ( [ circ : flip ] ) .    a circuit  ( [ circ:3cntrlb ] ) realizing @xmath7 is supposed to leave an input state of the form @xmath51 invariant .",
    "this implies the circuit identity @xmath94 + 3 mm ) ) ;        qcxcoord : = qcxcoord + qcstepsize ;        qcstepsize : = qcstepsize-4 mm ; \\end{emp}\\ ] ] and we obtain from the action on @xmath95 the identity @xmath96 + 3 mm ) ) ;        qcxcoord : = qcxcoord + qcstepsize ;        qcstepsize : = qcstepsize-4 mm ;        wires(2 mm ) ;        gate(icnd 1 , gpos 0 , btex $ y$ etex ) ;        gate(gpos 0 , btex $ z$ etex ) ;              wires(2 mm ) ; \\end{emp}\\ ] ] combining circuits ( [ circ:3cntrl4single1 ] ) and ( [ circ:3cntrl4single2 ] ) , we obtain the equality @xmath97 + 3 mm ) ) ;        qcxcoord : = qcxcoord + qcstepsize ;        qcstepsize : = qcstepsize-4 mm ;        wires(2 mm ) ;        gate(icnd 1 , gpos 0 , btex $ y$ etex ) ;        gate(gpos 0 , btex $ z$ etex ) ;              wires(2 mm ) ; \\end{emp}\\ ] ] it follows from lemma  [ lemma : notsparse ] that @xmath98 has to be sparse . by lemma  [ lemma :",
    "sparse ] , this implies that the gates  @xmath99 and @xmath100 in circuit  ( [ circ:3cntrl4single2 ] ) have to be sparse as well . since we know that @xmath30 and @xmath50 are sparse , flipping any number of controlled - not gates in circuit  ( [ circ:3cntrlb ] ) using equality ( [ circ : flip ] ) can not decrease the count of the single - qubit gates .",
    "it remains to show that none of the four gates @xmath101 in circuit  ( [ circ:3cntrlb ] ) can be a multiple of the identity .",
    "since @xmath98 is sparse , let @xmath102 . considering the input state @xmath103 and @xmath104",
    ", we can deduce from circuit  ( [ circ:3cntrl4single3 ] ) the equalities @xmath105 if follows from equations ( [ eqn : cc1 ] ) and ( [ eqn : cc2 ] ) that neither @xmath106 nor @xmath107 can be a multiple of the identity . since @xmath39 , we can apply the same argument to the inverse of the circuit  ( [ circ:3cntrlb ] ) , hence neither @xmath108 nor @xmath109 is a multiple of the identity either .",
    "therefore , at least four single qubit gates are non - trivial , as claimed .",
    "we have demonstrated that the simplified toffoli gate by margolus can not be realized with fewer than three controlled - not gates .",
    "four additional single qubit gates are required when @xmath7 is realized with minimal number of controlled - not gates .",
    "our proof of this lower bound revealed the interesting fact that the solution by margolus is essentially uniquely determined by these constraints .",
    "the tedium of cases in lower bound proofs can be daunting , but one usually gains valuable structural insights , particularly if the bounds are tight .",
    "it would be interesting to know tight lower bounds for other fundamental constructions of quantum circuits , such as the toffoli gate .",
    "it is conjectured that the toffoli gate can not be implemented with less than six controlled - not and eight single qubit gates .",
    "adriano barenco , charles  h. bennett , richard cleve , david  p. divincenzo , norman margolus , peter shor , tycho sleator , john  a. smolin , and harald weinfurter .",
    "elementary gates for quantum computation . , 52:34573467 , 1995 ."
  ],
  "abstract_text": [
    "<S> unitary operations are expressed in the quantum circuit model as a finite sequence of elementary gates , such as controlled - not gates and single qubit gates . </S>",
    "<S> we prove that the simplified toffoli gate by margolus , which coincides with the toffoli gate up to a single change of sign , can not be realized with less than three controlled - not gates . </S>",
    "<S> if the circuit is implemented with three controlled - not gates , then at least four additional single qubit gates are necessary . </S>",
    "<S> this proves that the implementation suggested by margolus is optimal . </S>"
  ]
}