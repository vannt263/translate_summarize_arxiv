{
  "article_text": [
    "there are wide interests in calculating the radiative transfer near the compact objects , such as black hole , neutron star and white dwarf",
    ". the radiation will be affected by various effects , such as , light bending or focusing , time dilation , doppler boosting and gravitational redshift , under the strong gravitational field of the compact objects . the consideration of these effects not only help us to understand the observed results , therefor to study these compact objects , but also even to test the correctness of the general relativity under strong gravity .",
    "a good example is the study of the fluorescent iron line in the x - ray band at 6.4 - 6.9 kev , which is seen in many active galactic nuclei especially for seyfert galaxies @xcite .",
    "the line appears broadened and skewed as a result of the doppler effect and gravitational redshift , thus it is an important diagnostic to study the geometry and other properties of the accretion flow at the vicinity of the central black hole @xcite .",
    "another example is the study of smbh in the center of our galaxy .",
    "it has been comprehensively accepted that in the center of our galaxy a super - massive black hole with @xmath1 4@xmath2 @xmath3 exists @xcite and its shadow may be observed directly in the radio band in the near future .",
    "based on the general relativistic numerical simulations of the accretion flow , @xcite present the first dynamically self - consistent models of millimeter and sub - millimeter emission from sgr @xmath4 .",
    "@xcite calculated the observed images of sgr @xmath4 with a fully general relativistic radiative inefficient accretion flow .",
    "a natural way to include all of the gravitational effects is to track the ray following its null geodesic orbit . which requires the fast and accurate computations of the trajectory of a photon in the kerr spacetime .",
    "@xcite proposed a fast code to calculate the accreting lines and thin disk images .",
    "@xcite translated all integrations into the legendre s standard elliptic integrals and wrote a fast numerical code .",
    "@xcite presented a new fast public code , named geokerr , for the computing of all coordinates of null geodesics in the kerr spacetime by using the carlson s elliptic integrals semi - analytically for the first time .",
    "there are two computational methods often used in these codes , they are : ( 1 ) the elliptic function method , which relies on the integrability of the geodesics @xcite , and ( 2 ) the direct geodesic integration method @xcite . usually people regard the direct geodesic integration method to be a better choice than the elliptic function method , for the direct geodesic integration method can deal with any three - dimensional accretion flow @xcite , especially in radiative transfer problems which require the calculations of many points along each geodesic , the direct integration method is simpler and faster @xcite . while the the elliptic function method is considered to be just efficient for the calculation of the emissions come from an optically thick , geometrical thin and axisymmetric accretion disk system .",
    "but we think that the elliptic function method based on @xcite after some extensions can overcome these shortages and not only handle any three - dimensional accretion flows readily , but also be more efficient , flexible , and accurate , because it can compute arbitrary points on arbitrary sections for any geodesics .",
    "the speed of the code based on this approach is still very fast for many potential applications .",
    "while the direct geodesic integration method must integrate the geodesic from the initial position to the interested points , the waste of computational time is inevitable .",
    "we present a new public code for the computation of null geodesics in the kerr spacetime following the work of @xcite . in our code",
    "all coordinates and the affine parameters are expressed as functions of a parameter @xmath0 , which corresponds to @xmath5 or @xmath6 in @xcite . using parameter @xmath0 as the independent variable , the computations are easier and simpler , thus more convenient , mainly due to the fact that the information about the turning points does not need to be prescribed in advance comparing with @xcite .",
    "meanwhile @xcite have demonstrated that the parameter @xmath0 can replace the affine parameter to be the independent variable in radiative transfer problems .",
    "we not only take this replacing , but also used it to handle more sophisticated applications .",
    "we extend the formulae of computing constants of motion from initial conditions to a more general form , which can readily handle the cases in which the emitter or the observer has arbitrary motion state and distance with respect to the central black hole .",
    "we reduce the elliptic integrals from the motion equations derived from the hamilton - jacobi equation @xcite to the weierstrass elliptic integrals rather than to the legendre s ones , because the former ones are much easier to handle .",
    "then we calculate these integrals by carlson s method .",
    "the paper is organized as follows . in section [ geoequ ]",
    "we give the motion equations for null geodesics . in section [ weifun ]",
    "we express all coordinates and affine parameters as functions of a parameter @xmath0 analytically and numerically . in section [ imppar ]",
    "we give the extended formulae for the computation of constants of motion . a brief introduction and discussion about the code",
    "are given in section [ genmet ] .",
    "in section [ protest ] we demonstrate the testing results of our code for toy problems in the literature .",
    "the conclusions and discussions are finally presented in section [ discconc ] .",
    "the general relativity calculations follow the notational conventions of the text given by @xcite .",
    "the natural unit are used through out this paper , in which constants g = c=1 , and the mass of the central black hole m is also taken to be 1 .",
    "following @xcite , we write the kerr line element in the boyer - lindquist ( b - l ) coordinates @xmath7 as @xmath8 where @xmath9 @xmath10 and @xmath11 is the spin parameter of the black hole .    the geodesic equations for a freely test particle read @xmath12 where @xmath13 is the proper time for particles and an affine parameter for photons , @xmath14 is the four - velocity , @xmath15 is the connection coefficients .",
    "@xcite found these equations are integrable under kerr spacetime and got the differential and integral forms of motion equations for particles by using the hamilton - jacobi equation .",
    "for a photon , whose rest mass @xmath16 is zero , the equations of motion have the following forms : @xmath17 @xmath18 where @xmath19r - a^2q,\\ ] ] @xmath20 @xmath21 q and @xmath22 are constants of motion defined by @xmath23 where @xmath24 is the carter constant , @xmath25 is the angular momentum of the photon about the spin axis of the black hole , @xmath26 is the energy measured by an observer at infinity .",
    "the four momentum of a photon can be expressed as @xmath27 which is often used in the discussion of the motion of a photon .    from the equation ( [ theta ] ) we know that if @xmath28 and @xmath29 , then @xmath30 .",
    "@xmath29 means the motion of the photon is confined in the equatorial plane forever @xcite .",
    "thus the motion equations with integral forms now become invalid for @xmath31 appeared in the denominator .",
    "we need the motion equations with differential forms .    from equation ( [ defr ] )",
    "we have @xmath32 where the subscript @xmath33 means plane motion. dividing equation ( [ defphi ] ) by ( [ defr ] ) and integrating both sides , we obtain @xmath34 similarly from equation ( [ deft ] ) and ( [ defr ] ) , we obtain @xmath35    the spherical motion is an another special case , in which the photon is confined on a sphere and the motion of which can be described by equations : @xmath36 and @xmath37 @xcite . thus the motion equations with integral forms also become invalid due to @xmath38 appears in the denominator . similarly from equation ( [ deftheta ] ) we have @xmath39 where the subscript sm means `` spherical motion '' . dividing equation ( [ defphi ] ) by ( [ deftheta ] ) and integrating both sides , we have @xmath40 from the equations ( [ deftheta ] ) and ( [ deft ] ) we have @xmath41    from equation ( [ pdefine ] ) , we introduce a new parameter @xmath0 with following definition to describe the motion of a photon along its geodesic @xcite @xmath42 because the sign ahead the integral is the same with @xmath43 and @xmath44 , @xmath0 is always nonnegative and increases monotonically as the photon movies along the geodesic . from the above definition , we know that @xmath45 and @xmath46 are functions of @xmath0 . in the next section , we will give the explicit forms of these functions by using weierstrass and jacobi s elliptic functions .",
    "from the equations of motion we know that both @xmath47 and @xmath48 must be nonnegative .",
    "this restriction divides the coordinate space into allowed ( where @xmath49 and @xmath50 ) and forbidden ( where @xmath51 or @xmath52 ) regions for the motion of a photon .",
    "the boundary points of these regions are the so called turning points , their coordinates @xmath53 and @xmath54 satisfy equations @xmath55 and @xmath56 . for a photon emitted at @xmath57 and @xmath58",
    ", its motion will be confined between two turning points @xmath59 and @xmath60 for radial coordinate , @xmath61 and @xmath62 for poloidal coordinate .",
    "if we assume @xmath63 , and @xmath64 , then we have @xmath65 $ ] and @xmath66 $ ] . because @xmath67 and @xmath68 , if @xmath69 ( or @xmath70 ) at the initial position , we have @xmath71 ( or @xmath72 ) , therefore @xmath57 ( or @xmath58 ) must be a turning point and equal to one of @xmath59 and @xmath60 ( or @xmath61 and @xmath62 ) .",
    "the radial motion of a photon can be unbounded , meaning that the photon can go to the infinity or fall into the black hole .",
    "these cases usually correspond to equation @xmath73 has no real roots or @xmath59 is less or equal to the radius of the event horizon .",
    "we regard the infinity and the event horizon of the black hole as two special turning points in the radial motion , a photon will asymptotically approach them but never return from them . thus @xmath60 can be the infinity and @xmath59 can be less or equal to @xmath74 ( @xmath74 is the radius of the event horizon ) .    for the poloidal motion , there is also two special positions , @xmath75 and @xmath76 , i.e. , the spin axis of the black hole .",
    "a photon with @xmath77 will go through the spin axis due to zero angular momentum , and will change the sign of its angular velocity @xmath78 instantaneously , and its azimuthal coordinate will jump from @xmath79 to @xmath80 @xcite , implying that the spin axis is not a turning position . from the equation ( [ theta ] ) we also know that @xmath81 and @xmath82 are not the roots of equation @xmath83 .",
    "firstly , we use a new variable @xmath84 to replace @xmath85 , and the equation ( [ pdefine1 ] ) can be rewritten as : @xmath86 where @xmath87    both @xmath47 and @xmath88 are quartic , but the polynomial of weierstrass standard elliptic integral is cubic .",
    "we need a variable transformation to make @xmath47 and @xmath88 to be cubic .",
    "we define the following constants for poloidal motion : @xmath89 where @xmath90 and introduce a new variable @xmath91 , @xmath92 making transformation from @xmath84 to t , the @xmath84 part of equation ( [ pdefine2 ] ) can be reduced to @xmath93 where @xmath94 , @xmath95 using the definition of weierstrass elliptic function @xmath96 @xcite , from equation ( [ pdef_mu ] ) , we have @xmath97 . solving equation ( [ tofmu ] ) for @xmath84",
    ", we can express @xmath84 as the function of @xmath0 : @xmath98 where @xmath99|.\\ ] ] the sign ahead @xmath100 depends on the initial value of @xmath101 , which is the @xmath46 component of four momentum of a photon , and @xmath102 where @xmath103 is the period of @xmath96 and @xmath104 .",
    "the sign ahead @xmath100 can be `` @xmath105 '' or `` @xmath106 '' when @xmath107 .    from the above discussion , we know that one root of equation @xmath108 is needed in the variable transformation , namely @xmath109 . to avoid the complexity caused by introducing complex , we always use the real one . luckily , equation @xmath110 always has real roots , but which is not true for equation @xmath111 . for cases in which equation @xmath73",
    "has no real roots we will use the jacobi s elliptic functions @xmath112 to express @xmath45 .",
    "if equation @xmath111 has real roots , then @xmath59 exists , we can define the following constants by using @xmath59 : @xmath113,\\\\ & & b_1 =   2r_{tp_1}^2-\\frac{1}{3}(q+\\lambda^2-a^2 ) , \\\\ & & b_2 =   \\frac{4}{3}r_{tp_1},\\\\ & & b_3 =   1,\\end{aligned}\\ ] ] and introduce a new variable @xmath91 , @xmath114 it is similar with @xmath84 , using @xmath91 as the independent variable , we can reduce the @xmath45 part of equation ( [ pdefine2 ] ) into the standard form of weierstrass elliptical integral @xmath115 where @xmath94 , @xmath95 taking the inverse of above equation , we get @xmath116 . solving equation ( [ tofr ] ) for r",
    ", we have @xmath117 where @xmath118|.\\quad\\ ] ] the sign ahead @xmath119 also depends on the initial value of @xmath120 , which is the @xmath45 component of four momentum of a photon , and @xmath121 where @xmath103 is the period of @xmath96 and @xmath104 .",
    "the sign ahead @xmath119 can be `` @xmath105 '' or `` @xmath106 '' when @xmath122 .",
    "if equation @xmath73 has no real roots , we use the jacobi s elliptic functions to express @xmath45 .",
    "since the coefficient of @xmath123 is zero , the roots of equation @xmath73 satisfy @xmath124 .",
    "therefore the roots @xmath125 can be written as @xmath126 introducing two constants @xmath127 and @xmath128 @xmath129,\\ ] ] which satisfy @xmath130 , and a new variable @xmath91 , @xmath131}}\\left(r - u\\frac{\\lambda_1 + 1}{\\lambda_1 - 1}\\right),\\ ] ] we can reduce the @xmath45 part of equation ( [ pdefine2 ] ) to the legendre s standard elliptic integral @xmath132 where @xmath133 using the definition of jacobi s elliptic function @xmath134 @xcite , from equation ( [ plegendre ] ) we obtain @xmath135 . solving the equation ( [ tofr2 ] ) for @xmath45 , we get the expression of @xmath45 as the function of @xmath0 @xmath136 where @xmath137|.\\ ] ] when the initial value of @xmath138 , we have @xmath139 , and when @xmath140 , we have @xmath141 . and @xmath120 can not be zero , otherwise the initial radial coordinate @xmath57 of the photon will be one root of equation @xmath111 , which is the case that has been discussed above .      in this section , we will express the coordinates @xmath91 , @xmath79 and the affine parameter @xmath13 as the numerical functions of the parameter @xmath0 .",
    "all of these variables have been expressed as the integrals of @xmath45 and @xmath46 in the equations ( [ sigmadef])-([phidefine ] ) and ( [ sigmadefpm])-([tdefcm ] ) .",
    "the goal is achieved if we can compute all of these integrals along a geodesic for a specified @xmath0 . * making transformations * from @xmath45 and @xmath84 to a new variable @xmath91 ( defined by equations ( [ tofmu ] ) , ( [ tofr ] ) and ( [ tofr2 ] ) ) , we will compute these integrals under the new variable @xmath91 . for simplicity",
    "we use @xmath142 to denote the complicated integrands ( see below ) for @xmath143 respectively .",
    "firstly , we discuss the integral path , which starts from the initial position and terminates at the photon .",
    "if the photon encounters turning points along the geodesic , then the whole integral path is not monotonic , as shown in figure.[tpmu ] for poloidal motion ( radial motion is similar ) . in this figure",
    "the projected poloidal motion of a photon onto the @xmath45-@xmath46 plane is illustrated .",
    "the motion is confined between two turning points : @xmath109 and @xmath144 .",
    "the photon encounters the turning points for three times .",
    "obviously any sections of the path which contain one or more than one turning points is not monotonic , such as path cde , efp etc .",
    "the path between any two neighboring turning points has the maximum monotonic length and the total integrals should be computed along each of them and summed .",
    "there are four important points involved in the limits of these integrals , i.e. , @xmath109 , @xmath144 , @xmath145 and @xmath146 , they are the @xmath84 coordinates of turning points , initial point and the photon position for a given @xmath0 respectively . and the values of these points corresponding to the new variable @xmath91 are @xmath147 , @xmath148 , @xmath149 , which can be calculated from equation ( [ tofmu ] ) , and @xmath150 , which can be calculated from @xmath97 with a given @xmath0 .",
    "because the function @xmath151 expressed by equation ( [ tofmu ] ) is monotonically increasing , we have @xmath152 and @xmath153 .",
    "if we use @xmath154 and @xmath155 to denote the number of times of a photon meeting the turning points @xmath109 and @xmath144 for a given @xmath0 respectively , and define the following integrals ( cf .",
    "figure [ tpmu ] ) : @xmath156 then the integrals of @xmath46 in @xmath13 , @xmath91 and @xmath79 then can be written as ( cf .",
    "figure [ tpmu ] ) @xmath157i_0 + 2nt_1i_{01}+2nt_2i_{02},\\end{aligned}\\ ] ] where @xmath101 is the @xmath46 component of the initial four momentum of a photon . in order to evaluate the above expression",
    ", we need to know @xmath154 and @xmath155 for a given @xmath0 .",
    "similarly if we define five integrals from the equation ( [ pdef_mu ] ) as follows : @xmath158 where @xmath159 , and we will get the following identity : @xmath160p_0 + 2nt_1p_{01}+2nt_2p_{02}.\\end{aligned}\\ ] ] and notice that @xmath154 and @xmath155 are not arbitrary and related to the initial direction of the photon in poloidal motion . for @xmath161 ( or @xmath70 and @xmath162 ) , they will increase as @xmath163 for @xmath164 ( or @xmath70 and @xmath165 ) , they will increase as @xmath166 for a given @xmath0 , we find that there always exists one pair of @xmath154 and @xmath155 , which satisfy equation ( [ poft1t2 ] ) and they are the number of a photon meeting the turning points . with @xmath154 and @xmath155 , the equation ( [ integralmu ] ) now can be evaluated readily .    for @xmath45 coordinate ,",
    "the process is similar with the above . @xmath154 and",
    "@xmath155 also represent the number of times of a photon meeting the turning points @xmath59 and @xmath60 respectively .",
    "five integrals are defined as : @xmath167 where @xmath168 ( or @xmath169 when equation @xmath73 has no real roots ) , and @xmath170 , @xmath171 and @xmath149 are calculated from equation ( [ tofr ] ) or ( [ tofr2 ] ) .",
    "then the integrals of @xmath45 in @xmath172 can be written as @xmath173i_0 + 2nt_1i_{01}+2nt_2i_{02}.\\end{aligned}\\ ] ] to get @xmath154 and @xmath155 , we define @xmath174 , @xmath175 and @xmath176 from equation ( [ ptr ] ) as : @xmath177 for a given @xmath0 , we have @xmath178p_0 + 2nt_1p_{01}+2nt_2p_{02}.\\end{aligned}\\ ] ] to get @xmath154 and @xmath155 from above equation one just needs to notice that when @xmath138 ( or @xmath69 and @xmath179 ) they will increase as @xmath180 when @xmath140 ( or @xmath69 and @xmath181 ) they will increase as @xmath166 similarly for a given @xmath0 , there is one pair of @xmath154 and @xmath155 satisfies equation ( [ pofr ] ) . with @xmath154 and @xmath155 equation ( [ integralr ] )",
    "now can be evaluated . in many cases",
    "the number of a photon meeting the turning points in @xmath45 is less than 2 , especially when @xmath59 is less or equal to @xmath182 , or @xmath60 is infinity , or equation @xmath73 has no real roots , both @xmath154 and @xmath155 will be zero .",
    "in previous sections , four coordinates @xmath183 and the affine parameter @xmath13 have been expressed as functions of @xmath0 , and in which many elliptic integrals need to be calculated . in this section",
    ", we shall reduce these integrals into standard forms and then evaluate them by carlson s method as @xcite did .",
    "firstly , we introduce two notations @xmath184 and @xmath185 with following definitions : @xmath186 where @xmath187 is an integer . from equation ( [ pdefine ] ) , we get one of the standard forms as @xmath188 after being reduced to @xmath189 , the forms of integrals of @xmath45 and @xmath46 in ( [ pdefine ] ) are exactly same . noticing the definition of parameter @xmath0",
    ", we have @xmath190 . the radial integrals in equation ( [ sigmadef ] )",
    "are reduced to @xmath191 where @xmath189 has been replaced by @xmath0 .",
    "the radial integrals in equation ( [ tdefine ] ) can be reduced to @xmath192 where @xmath193}{(r_+-r_-)(r_{tp_1}-r_{\\pm})},\\\\ \\notag b_{t\\pm}&=&\\frac{[r_\\pm(4-a\\lambda)-2a^2]b_0}{2(r_+-r_-)(r_{tp_1}-r_{\\pm})^2},\\\\ t_\\pm&=&\\frac{b_1}{4}+\\frac{b_0}{4(r_\\pm - r_{tp_1})}.\\end{aligned}\\ ] ] similarly the radial integrals in the equation ( [ phidefine ] ) have the following form @xmath194,\\ ] ] where @xmath195 when equation @xmath73 has no real roots , the integrals of @xmath45 in @xmath13 , @xmath91 and @xmath79 can be written as : @xmath196,\\end{aligned}\\ ] ] where @xmath197}{r_+-r_-},\\quad c_{\\phi\\pm } = \\frac{2r_\\pm - a\\lambda}{r_+-r_-}.\\end{aligned}\\ ] ] the integrals concerning @xmath84 in the equation ( [ sigmadef ] ) are reduced to @xmath198,\\ ] ] and @xmath199 .",
    "the @xmath84 integrals in the equation ( [ phidefine ] ) can be reduced to @xmath200,\\ ] ] where @xmath201 finally we have @xmath202 from equations ( [ 44])-([48 ] ) we know that the integrals need to be calculated are @xmath189 , @xmath203 , @xmath204 , and @xmath205 , @xmath206 , @xmath207 .",
    "now we use the carlson s method to evaluate them . when equation @xmath208=0 has three real roots denoted by @xmath209 , @xmath210 and @xmath211 , @xmath184 can be written as @xcite @xmath212,\\end{aligned}\\ ] ] where @xmath213=sign@xmath214 $ ] .",
    "when equation @xmath215 has one real root @xmath209 and one pair of complex conjugate roots @xmath216 and @xmath217 , @xmath184 can be written as @xcite @xmath218.\\end{aligned}\\ ] ] from the equations ( [ tofmu ] ) and ( [ tofr ] ) , we know that when @xmath219 or @xmath220 , @xmath91 will be @xmath221 , thus one limit of these integrals can be infinity .    the integrals @xmath222 can be reduced to carlson s integrals directly @xcite * @xmath223,\\end{aligned}\\ ] ] * where @xmath224 $ ] is a symbol used by carlson to denote the elliptic integrals and has the following definition : @xmath225 = \\int^x_y \\prod_{i = 1}^{k}(a_i+b_it)^{p_i/2}dt,\\end{aligned}\\ ] ] which can be evaluated by the formulae provided in @xcite .",
    "[ impactpara ]      in previous sections we have expressed all coordinates as functions of a parameter @xmath0 and discussed how to calculate them by carlson s method .",
    "but before the calculation one needs to specify the constants of motion and @xmath226 , which determine the signs ahead @xmath227 and also how the number of turning points increasing .",
    "in this section we shall discuss how to compute @xmath22 and @xmath228 and @xmath226 from @xmath229 , which are the components of the four - momentum measured in the lnrf reference and have been specified by the user .",
    "firstly , following @xcite we introduce the lnrf ( locally nonrotating frame ) observers or the zamo ( zero angular momentum observer ) , the basis vectors of the orthonormal tetrad of them are given by @xmath230 where @xmath231 and the covariant components of the four momentum of a photon in the b - l coordinate can be expressed as @xmath232 where @xmath233 and @xmath234 are signs of r and @xmath46 components .",
    "one can easily show that @xmath235 , namely @xcite @xmath236 from equations ( [ energy_r ] ) and ( [ energy_theta ] ) we have @xmath233=@xmath237 and @xmath234=@xmath238 , which determine the initial direction of the photon in the b - l system ( cf .",
    "equations ( [ sign_theta ] ) and ( [ sign_r ] ) ) , thus determine the way how the number of the turning points increasing .",
    "solving equations ( [ energy_t ] ) and ( [ energy_phi ] ) simultaneously for @xmath22 , one obtains @xmath239 using @xmath22 and equation ( [ energy_t ] ) , one obtains @xmath240 . using @xmath22 and @xmath26 , from equation ( [ energy_theta ] ) one obtains the formula of calculating the motion constant @xmath228 , @xmath241\\cos^2\\theta + \\left[\\frac{\\bar{p}_{(\\theta)}}{\\bar{p}_{(t)}}(1-\\lambda \\omega)\\right]^2\\frac{a}{\\delta}.\\end{aligned}\\ ] ] thus we have obtained the basic equations ( [ lambda ] ) and ( [ q ] ) connecting @xmath22 , @xmath228 and the components of four momentum @xmath229 measured in the lnrf reference . when @xmath229 are given the constants of motion and the initial direction of the photon are both uniquely determined .",
    "to prescribe @xmath229 , one should notice that they satisfy following equation @xmath242 thus there are only three independent components .",
    "obviously the user can specify the four momentum @xmath229 directly in lnrf or equivalently specify @xmath243 in anyother reference frame of his / her own choice and then to transform it to the lnrf reference by a lorentz transformation , i.e. , @xmath244 , where @xmath245 is the transformation matrix . from equations ( [ lambda ] ) and ( [ q ] ) we know that what one needs is just @xmath246 and @xmath247 the @xmath245 should be specified by the user according to his / her needs . has physical velocities @xmath248 with respect to a lnrf , the general lorentz transformation matrix has six independent parameters , i.e. , @xmath249 , where @xmath250 are the angles between the corresponding spacial basis vectors of the two references . if @xmath251 , the matrix can be written as follows @xcite @xmath252 where @xmath253^{-1/2}$ ] , and its inverse form @xmath254 ]    as an example , in figure [ equatorialplane ] , we show a group of null geodesics emitted isotropically from a particle moving around a black hole in a marginally stable circular orbit ( @xmath255 ) with a=0.9375 . and the physical velocities of the particle with respect to the lnrf are @xmath256 .",
    "the four - momentum @xmath243 are specified isotropically in the reference of the particle and then transformed to the lnrf by the lorentz transformation expressed by equation ( [ matrix1 ] ) , i.e. , @xmath244 . with @xmath229",
    "the constants of motion are computed readily .",
    "the light bending and beaming effects are illustrated obviously in this figure .    in the next section",
    ", we shall discuss how to compute @xmath246 from impact parameters , which play a key role in imaging . and for simplicity we shall use the transformation expressed by the equations ( [ matrix1 ] ) and ( [ matrix2 ] ) if the observer has motion .      from the works of @xcite and @xcite , we know that @xmath22 and @xmath228 can be calculated from impact parameters , usually denoted by @xmath257 , @xmath258 , which are the coordinates of the hitting position of a photon on the photographic plate of the observer .",
    "the formulae provided by them read as follows @xcite @xmath259 the above equations are valid only when the distance between the observer and the emitter is infinite and the observer is stationary .",
    "practically the distance is not infinite , otherwise the integrals of coordinate @xmath91 will be divergent .",
    "when the distance is finite , the above formulae should be modified .",
    "we extend those formulae to general situations , in which both the finite distance and the motion state of the observer are considered .    to consider the finite distance is very easy .",
    "one just needs to substitute the coordinates @xmath260 of the observer into equations ( [ lambda ] ) and ( [ q ] ) in the calculation . while to consider the motion state is more complicated .",
    "obviously we can distinguish the motion states of the observer into two kinds .",
    "in the first one the observer is stationary and in the second one the observer has physical velocities @xmath248 with respect to the lnrf reference .    in the first kind ,",
    "the observer is just a lnrf observer and whose orthonormal tetrad is given by equation ( [ simple ] ) , namely @xmath261 . while in the second kind , the tetrad of the observer can be created by a lorentz transformation , i.e. , @xmath262 . here @xmath263 is given by the equation ( [ matrix2 ] ) .    as shown in figure [ lens ] , we plot the image of a photon hitting on the photographic plate .",
    "the plate is located in the plane determined by the basis vectors @xmath264 and @xmath265 , and in which an orthonormal coordinate system @xmath257 , @xmath258 has been established .",
    "the basis vectors @xmath266 and @xmath267 of the system are aligned with @xmath265 and @xmath264 respectively .",
    "all photons will go through the center of the lens before hitting on the plate . from this figure ,",
    "one obtains the relationships between the impact parameters and @xmath243 as follows : @xmath268 and obviously one can read off @xmath269 , @xmath270 and @xmath271 .    two dimensionless factors",
    "@xmath45 and @xmath272 have been multiplied to amplify the size of the image , otherwise which will be infinite small , since the distance @xmath273 between the central compact object and the observer and the size of the target object @xmath274 satisfy @xmath275 .    in the rest frame of the observer ,",
    "the spacetime is locally flat , we still have @xmath276 using equations ( [ alpha ] ) , ( [ beta ] ) and ( [ squaremomentum ] ) and noting the signs of @xmath277 , we obtain @xmath278 substituting equations ( [ prpt])-([pppt ] ) into ( [ pivspt ] ) , we get the functions @xmath279 .",
    "we can then calculate @xmath22 and @xmath228 from impact parameters by using equations ( [ lambda ] ) and ( [ q ] ) .",
    "one can verify directly that when @xmath280 , @xmath281 , and @xmath282 , the equations ( [ lambda ] ) and ( [ q ] ) reduce to ( [ alpha_inf ] ) and ( [ beta_inf ] ) immediately .    if the observer has motion , the image on the plate will have a displacement compare to the image when the observer is stationary .",
    "the displacement is proportional to the observer s velocity and can be described by @xmath283 , @xmath284 , which is the coordinates of image point of the origin of b - l coordinate system on the photographic plate .",
    "obviously @xmath283 and @xmath284 satisfy the following equations : @xmath285 actually , @xmath286 represents the projection of the spin axis of the black hole onto the plate . when @xmath287 , the above equations become @xmath288 and @xmath289 .",
    "the region of the image on the plate therefore is @xmath290 $ ] and @xmath291 $ ] , where @xmath292 is the half length of the image .",
    "the redshift @xmath293 of a photon is defined by @xmath294 . from above discussion , we know that @xmath295 , @xmath296 , where @xmath297 is the four - velocity of the emitter .",
    "if we define @xmath298 from equation ( [ energy_t ] ) , we have @xmath299 . using the equation ( [ fourp ] ) ,",
    "then @xmath293 can be expressed as follows @xmath300_{obs}}{\\left[u^t \\left(1+s_r\\dot{r}\\sqrt{r}/\\delta+s_{\\theta}\\dot{\\theta}\\sqrt{\\theta_\\theta}-\\lambda\\omega\\right)\\right]_{em}},\\ ] ] where @xmath301 are the coordinate velocities .    with @xmath302 , the physical velocities of the emitter with respect to the lnrf @xmath303",
    "can be written as @xcite @xmath304 with which the four - velocity of the emitter can be expressed as @xmath305 then the @xmath293 can be rewritten as @xcite @xmath306_{obs}}{\\left[\\gamma e^{-\\nu}\\left(1+s_r e^{\\nu } \\upsilon_{r}\\sqrt{r}/\\sqrt{\\sigma\\delta}+s_{\\theta}e^{\\nu}\\upsilon_{\\theta}\\sqrt{\\theta_\\theta}/\\sqrt{\\sigma}-\\lambda\\omega\\right)\\right]_{em}}.\\ ] ] for an emitter movies in a keplerian orbit , the formula of @xmath293 reduces to @xmath307_{obs}}{\\left[\\gamma e^{-\\nu}\\left(1-\\lambda\\omega\\right)\\right]_{em}}.\\ ] ]",
    "we have expressed the four coordinates @xmath45 , @xmath84 , @xmath79 , @xmath91 and the affine parameters @xmath13 as functions of @xmath0 . we denote them as follows : @xmath308 in practical applications , we are interested in determining the original position where the photon was emitted or the regions traveled by the photon . to make the calculations",
    "effectively , all photons are traced backward from the observer to the emitter along the geodesics .",
    "but not all photons start from the observer will go through the emission region one interested , and the tracing process will be terminated either these photons go to the infinity or fall into the event horizon of a black hole .",
    "now we discuss how to determine the intersection of a geodesic with the surface of an optically thick emission region , we assuming that the optical depth of which is so large that a sharply emission surface exits . and the surface is smooth and continuous and can be described by an algebra equation : @xmath309 where @xmath310 , @xmath311 , @xmath312 are the pseudo cartesian coordinates and defined by @xmath313 in some special cases the surface one considered may not keep stationary , the surface equation will be a function of time @xmath91 , i.e. , @xmath314 .",
    "we introduce a function @xmath315 defined by @xmath316-f_0.\\ ] ] then the roots of equation @xmath317 correspond to the intersections of the geodesic with the target surface .",
    "therefore if equation @xmath318 has no roots , the geodesic will never intersect with the surface . to solve this equation",
    "effectively , we classify geodesics into four classes denoted by a , b , c and d , according to their relationships with respect to a shell , shown in figure [ abcd ] .",
    "the shell includes the emission region completely , and its inner and outer radius are @xmath319 and @xmath320 . reminding that @xmath59 and @xmath60 are turning points , between which the radial motion of a photon is confined .",
    "geodesics in the four classes satisfy the conditions a : @xmath321 , b : @xmath322 , c : @xmath323 and d : @xmath324 respectively , where @xmath182 is the radius of the event horizon .",
    "the values of parameter @xmath0 corresponding to the intersections of the geodesic with the shell are denoted by @xmath175 , @xmath176 , @xmath325 , @xmath326 , which satisfy @xmath327 .",
    "obviously the roots of equation @xmath317 may exist on intervals @xmath328 $ ] and @xmath329 $ ] .",
    "we use the bisection or the newton - raphson method to search the roots @xcite .    solving the radiative transfer equation in optically thin or thick media",
    ", one needs to evaluate integrations along geodesic with taking the affine parameter @xmath13 as the independent variable .",
    "since we have taken @xmath0 to be the independent variable , we can replace @xmath13 by @xmath0 to evaluate these integrals . from the definition of @xmath0 , i.e. , equation ( [ pdefine1 ] )",
    ", one has @xmath330 and from the equations ( [ defr ] ) and ( [ deftheta ] ) one gets @xmath331 from above equations one immediately obtains @xmath332 which converts the independent variable from @xmath13 to @xmath0 in radiative transfer applications @xcite .",
    "finally we give a brief discussion on the determination of a geodesic connecting the emitter and observer @xcite .",
    "we use @xmath333 , @xmath334 to represent the impact parameters of the geodesic which connecting the observer and emitter and @xmath335 to indicate the position of the emitter on the geodesic , in which the coordinates of the emitter are @xmath336 , @xmath337 and @xmath338 .",
    "obviously we have the following set of equations : @xmath339 in principle if we can solve this set of nonlinear equations simultaneously for @xmath340 , the geodesic is determined uniquely . therefore the observer - emitter problem also becomes a root finding problem . in our code",
    "we use the newton - raphson method @xcite to solve these equations .      in this section",
    "we shall give a brief introduction for the code , and a more detailed introduction is given in the readme file .",
    "the code is named ynogk ( yun - nan observatory geodesics kerr ) and written by fortran 95 , in which the object - oriented method has been used .",
    "the code is composed by a couple of modules . for each module ,",
    "a special function has been implemented and one can use all supporting functions and subroutines in that module by a command `` use module - name '' in his / her own program . by adding corresponding modules into one s own code , one can easily develop new ones to handle special and more sophisticated applications .",
    "two modules named * ell - function * and * blcoordinate * are the most important ones in ynogk , the former one includes supporting functions and subroutines for calculating the carlson s elliptic integrals and the r - functions .",
    "many routines in this module come from geokerr @xcite and numerical recipes @xcite .",
    "the latter module includes routines for computing all coordinates and the affine parameter functions : @xmath341 and @xmath342 . to call these routines , constants of motion and components of four - momentum @xmath343 ,",
    "@xmath344 , @xmath345 measured in a lnrf reference must be prescribed , which can be computed by two subroutines named * lambdaq * and * initialdirection * in ynogk .",
    "the former routine computes the constants of motion from impact parameters , while the latter one computes @xmath22 and @xmath228 from the initial @xmath243 given in a reference @xmath346 , which has physical velocities @xmath303 with respect to the lnrf . of course one can compute them by his / her own subroutines according to their needs .",
    "according to the discussion in section [ fourcoordinates ] , we present a module named * pem - finding * to search the minimum root @xmath335 of equation @xmath317 , and @xmath315 as an external function should be given by the user . in module",
    "* obs - emitter * , we present routines to find the root of equations ( [ obsemit1])-([obsemit3 ] ) by using the newton - raphson algorithm @xcite .",
    "in the testing section of the code , this module has been used to determine the geodesic connecting the observer and the central point of a hot spot , which movies in the inner most stable circular orbit ( isco ) . with the geodesic",
    "the motion of the spot can be described easily .",
    "the results are agree very well with previous works , in which a very different method has been used to determine the motion of the spot , i.e. , by tabulating the motion according to the time of the observer over one period @xcite .",
    "all routines for computing the carlson s elliptic integrals have been extensively checked by nintegrate function of mathematica .",
    "the original code of these routines comes from geokerr @xcite , and has been modified to adapt to our code .",
    "the original code for the computing of r - functions comes from numerical recipes @xcite . the same check also has been done for the functions @xmath347 .",
    "when @xmath348 and @xmath349 @xmath350 , we let them to be zero , since the carlson s integrals can not maintain their accuracy .",
    "the treatment is same for any other parameters if they take offending values .",
    "for some critical cases , special treatments also have been implemented .",
    "our code has many common points with geokerr of @xcite .",
    "we both use the carlson s method to compute the elliptic integrals and use the elliptic functions to express all coordinates as functions of a independent variable .",
    "but the elliptic functions we used are mainly the weierstrass elliptic function @xmath96 , which has a cubic polynomial , leading simpler root distribution and the cases of integral are reduced . in our code",
    "the four b - l coordinates @xmath45 , @xmath46 , @xmath79 , @xmath91 and affine parameter @xmath13 are expressed as analytical or numerical functions of a parameter @xmath0 , which corresponds to @xmath5 or @xmath6 in @xcite . with this treatment",
    "one can compute the geodesics directly without providing any information about the turning points in advance . which also allows one to track emissions from a more sophisticated surface , not only for standard thin accretion disk .",
    "in the code testing section we will show the images of a warped disk , which has a curved surface .",
    "our strategy , i.e. , expressing coordinates as functions of @xmath0 semi - analytically , can be extended to compute the timelike geodesics directly , almost without any modifications . as mentioned in @xcite , the calculations of the timelike geodesics involve many more cases .",
    "the main challenge is to specify the number of radial turning points for bounded orbits in advance .",
    "but our strategy does not require the specification of the number of turning points both in radial and poloidal coordinates in advance , therefore which can be used naturally and effectively in the calculations of timelike geodesics even in a kerr - newmann spacetime .    in our code we give the orthenormal tetrad of the emitter or the observer analytically , provided the physical velocities",
    "of which with respect to the lnrf are specified .",
    "they may be useful in monte - carlo type code of radiative transfer , which needs one to make transformations from the reference of the emitter to the b - l coordinate system frequently @xcite .",
    "as illustrated in figure [ equatorialplane ] , emissions in the reference of the emitter are specified isotropically , but from the perspective of the b - l coordinate system which are anisotropic due to the doppler beaming effect .",
    "our testing results for various toy problems agree well with those of @xcite . in figure [ projections ] we illustrate the projection of a uniform orthonormal grid from the photographic plate of the observer onto the equatorial plane of a black hole , in which the solid and dotted lines represent the results from our code and geokerr respectively .",
    "they agree with each other very well .",
    "the basic strategy used in ynogk to compute the elliptic integrals and functions are very similar to geokerr .",
    "for example we make ynogk to compute the minimum number of r - functions possible and share them between routines .",
    "this strategy improves the speed of our code greatly .",
    "but there is still some differences between the two codes .",
    "firstly , we assemble @xmath351 and @xmath352 into routines for computing @xmath353 , @xmath354 and @xmath342 , thus the repeated calculations for the same integrals among those functions can be avoided .",
    "we provide a routine named * ynogk * to compute the four b - l coordinates and affine parameter simultaneously .",
    "we also provide two independent routines named * radius * and * mucos * to compute @xmath351 and @xmath352 respectively .",
    "secondly , ynogk can save the values of variables used in the calculations for a same geodesic but for different @xmath0 .",
    "these values can be used repeatedly .",
    "ynogk has almost same speed with the geokerr in tracing radiations from an optically and geometrical thin disk , because there is only one point , i.e. , the intersection of the ray with the disk surface , needs to be calculated . for the calculations of radiative transfer , in which many points are needed along each geodesics",
    ", ynogk has a little slower than geokerr .",
    "the speed tests of a code are not only dependent on the applications mostly , but also on the environment of the code running . from the testing results of ynogk",
    ", we expect that the speed of which is almost same with geokerr in many other applications .",
    "for more detailed introductions , one can see the readme file . in the next section , we will show the testing results of our code for toy problems .",
    "in this section , we shall present the testing results of our code for toy problems .",
    "the results not only demonstrate the validation our code , but also give specific examples of its utility .",
    "firstly , we show the image of a black hole shadow , in which the intensity represents the value of the affine parameter @xmath13 . by this example",
    "we want to test the validation of function @xmath342 .",
    "then we show the images of a couple of accretion disks and a rotationally supported torus , all of them are optically thick and have a sharply emission surface .",
    "the disks include the standard thin , thick and warped disks .",
    "next we show the images of a ball orbiting around a kerr black hole in a keplerian orbit to illustrate the gravitational lensing effect .",
    "then we calculate the line profiles of the fe k@xmath257 and the blackbody radiation spectra of a standard thin accretion disk around a kerr black hole . in order to test the accuracy of function @xmath353 , we image a hot spot moving around a kerr black hole in the isco for various black hole spins .",
    "we also calculate the spectrogram and light curves of the spot over one period of the motion with various inclinations for a schwarzschild black hole .",
    "finally we discuss the radiative transfer equation and its solution , whit which the radiative transfer process in a radiation dominated torus around a black hole has been discussed .",
    "we give the images of the torus for optically thin and thick cases .",
    "the resolution of images in this section is taken to be @xmath355 , each pixel corresponds to an unique geodesic .      as the first test of our code",
    "we give the image of a black hole shadow .",
    "we trace all photons backward from the photographic plate to the black hole along geodesics .",
    "the intensities of the image are taken to be the affine parameter @xmath13 evaluated from the observer to terminations on the geodesic  either when it intersects with the event horizon of the black hole or reaches a turning point and returns to the starting radius .",
    "the evaluations of the affine parameter outside the shadow are multiplied a factor 1/2 . in figure [ shadow ] , we show the image from an edge - on view .",
    "we take the spin @xmath11 to be 0.998 , and the distance of the observer to be @xmath356 @xmath357 , where @xmath357 is the gravitational radius .    to evaluate affine parameter @xmath13 from function @xmath342 ,",
    "we need @xmath358 , which is the value of parameter @xmath0 corresponds to the event horizon and also the root of equation @xmath359 . we can get @xmath358 by evaluating the integral of @xmath45 in the definition of @xmath0 , and need not to solve this equation directly .",
    "we provide a routine named * r2p * to complete this evaluation .",
    "next we present the images of the accretion disks around a kerr black hole , including the standard thin , thick and warped disks .",
    "the imaging of the disks is usually taken as the first step to calculate the line profiles of the fe k@xmath257 and the spectrum @xcite .",
    "usually the pseudo colors of the image represent the redshift @xmath293 or the observed flux intensity @xmath360 of emissions come from the disk .    in figure [ thindisk ]",
    ", we show the image of a standard thin disk , the inner and outer radius of which is @xmath255 and 22 @xmath357 repectively .",
    "the black hole spin @xmath11 is 0.998 and the inclination angle @xmath361 is @xmath362 .",
    "the distance of the observer is 40 @xmath357 .",
    "the shape of the image is quite different from the one observed from infinite far away .",
    "we also illustrate the high - order images of the disk in this figure . due to the light bending and focusing",
    ", one can see the part behind the black hole and the bottom side of the disk .",
    "the color intensities represent the redshift @xmath293 of emissions come from the disk .    in order determine the intersections of geodesics with the disk",
    ", we need to know the minimum root of equation @xmath363 .",
    "we provide two routines named * pemdisk * and * pemdisk - all * to compute the root by evaluating the integral of @xmath84 in the definition of @xmath0 . using * pemdisk",
    "* one can draw the direct image , while using * pemdisk - all * one can draw the direct and high - order images .",
    "the surface of the thick disk has a constant inclination angle @xmath364 with respect to the equatorial plane @xcite . to trace the thick disk , we need to solve equation @xmath365 to get @xmath0 for the upper surface and @xmath366 for the bottom surface",
    ", the roots of these two equations can also be computed by * pemdisk * and * pemdisk - all*. since the surface particles of the disk no longer keep in the equatorial plane , they will do the sub - keplerian motion with a angular velocity given by @xcite @xmath367\\omega,\\ ] ] where @xmath368 is the keplerian velocity and parameter @xmath369 is taken to be 3 here . using the equation ( [ redshift2 ] )",
    ", we can calculate the redshift of the emissions come from the disk .",
    "the images are shown in figure [ thickdisk ] , which agrees very well with figure 10 of @xcite .",
    "the warped accretion disk is also a very interesting object in astrophysics @xcite .",
    "here we discuss a very simple model for the warped disk , in which the disk is assumed to be optically thick and its surface can be described by @xcite @xmath370 where parameters @xmath371 and @xmath258 are defined by @xmath372,\\\\ \\beta(p)&=&n_3\\sin\\left[\\frac{\\pi}{2}\\frac{r(p)-r_{in}}{r_{out}-r_{in}}\\right],\\end{aligned}\\ ] ] where @xmath319 and @xmath320 are the inner and outer radius of the disk , and @xmath373 , @xmath374 , @xmath375 are the warping parameters . with above equations",
    ", we get the @xmath315 as follows @xmath376\\cos^2\\beta(p)}\\right)}\\tan\\beta(p ) % \\cos[\\phi(p)-\\gamma(p)]-\\cos\\theta(p ) .",
    "f(p ) = \\tan\\beta(p ) \\cos[\\phi(p)-\\gamma(p)]+\\frac{\\mu(p)}{\\sqrt{1-\\mu^2(p)}}.%\\cot\\theta(p).\\ ] ] with the minimum root of equation @xmath318 , we can image the warped disk .",
    "for the poloidal velocity @xmath377 of the particle is nonzero , the formula ( [ redshift1 ] ) or ( [ redshift ] ) is used to calculate the redshift g ( cf .",
    "the images of the warped disk are shown in figure [ warpeddisk ] , in which the warping parameters @xmath373 and @xmath374 are nonzero , leading the disk warps along azimuthal direction . for comparison one can see figure 3 of @xcite , in which @xmath373 is taken to be zero for simplicity , thus the shape of the disk",
    "is quite different from the one illustrated here .      in this section",
    ", we give the images of a rotationally supported torus .",
    "for simplicity we give a brief introduction for the torus model here , for the more detailed discussions one is recommended to the paper of @xcite or @xcite .",
    "the torus is assumed to be stationary and axisymmetric .",
    "due to the balance of the centrifugal force , gravity and pressure force , the structure of the torus is stratified and the isobaric surfaces can be described by a set of differential equations @xcite @xmath378 where @xmath379 ^ 2+\\frac{\\delta}{2}\\right),\\\\ \\label{torus_omega}\\omega & = & \\frac{\\sqrt{m}}{(r\\sin\\theta)^{3/2}+a\\sqrt{m}}\\left(\\frac{r_k}{r\\sin\\theta}\\right)^{n},\\end{aligned}\\ ] ] and @xmath380 is the angular velocity .",
    "@xmath381 represents the radius at which the the particle orbits with a keplerian velocity .",
    "the index parameter @xmath369 is crucial for regulating the angular velocity profile and adjusting the geometrical aspect ratio of the torus .",
    "@xmath382 is an auxiliary parameter . in order to give the outer surface of the torus",
    ", one needs to specify the most inner radius of the torus , which is usually regarded as the intersection of the isobaric surface with the isco . taking the inner most radius in the equatorial plane to be the initial condition , the differential equations ( [ torus_isobar1 ] ) and ( [ torus_isobar2 ] ) are now readily to be integrated . in figure [ torus ]",
    "we illustrate the images of the torus , which has the same parameters with figure 3 of @xcite , the results agree with each other very well .      due to the strong gravity field ,",
    "when the trajectory of a photon is closed to the vicinity of a compact object , it will be bent or focused , then multiple images will be observed , this is the so called gravitational lensing effect .",
    "here this phenomenon will be illustrated by a simple example , in which a ball moves around a near extremal black hole ( a=0.998 ) in a keplerian orbit .",
    "the radius of the orbit is @xmath383 , then the angular velocity of the ball is @xmath384 .",
    "the coordinates of the center of the ball will be @xmath385,\\\\ & & y_0(p ) = \\sqrt{r_0 ^ 2+a^2}\\sin[\\omega t(p)],\\\\ & & z_0(p ) = 0.\\end{aligned}\\ ] ] then the function of the surface of the ball can be expressed as follows : @xmath386 ^ 2+[y(p)-y_0(p)]^2+z(p)^2}-r_1,\\ ] ] where @xmath387 is the radius of the ball .",
    "the images observed from an edge - on view are illustrated in figure [ weaklense ] .",
    "for different positions of the ball in its orbit , the image changes greatly , which even becomes a ring as the ball movies to the back of the even horizon .",
    "the calculation of line profiles is very easy provided the structure of the disk is specified . for simplicity , we assume that the particles of the accretion flow do the keplerian motion and the disk is geometrical thin and optically thick .",
    "the inner and outer radius of the disk are located at @xmath255 and 15 @xmath357 respectively .",
    "the emission is monochromatic and the profile of which can be described by the dirac s @xmath364 function in the local rest frame of the flow @xmath388 where @xmath369 is the index of emissivity and assumed to be 3 .",
    "since @xmath389 is an invariance along a geodesic @xcite , we get the observed intensity @xmath390 , where @xmath391 is the redshift .",
    "then the observed flux density @xmath392 at frequency @xmath393 can be computed by integrating @xmath394 over the whole plate as following expression @xmath395 the observed intensities have been normalized in the computation .",
    "the results are shown in figure [ kelines ] , which agrees very well with the figure 3 of @xcite . from this figure",
    "one can see that the higher black hole spin leads the broadening in low frequency for the isco is closer to the event horizon , the gravitational redshift effect is remarkable , while the higher inclination angle leads the broadening in high frequency for the doppler beaming effect .      in this section",
    "we will compute the spectrum of a keplerian disk around a kerr black hole to illustrate effects of the black hole spin and the observer s inclination angles on the observed profiles of the spectrum @xcite .",
    "similarly , the disk is assumed to be geometrical thin and optically thick , and the radiation spectrum of the disk in its local rest frame is an isotropic blackbody spectrum .",
    "we denote the effective temperature of the disk by @xmath396",
    ". then radiation intensity at frequency @xmath393 can be written as @xmath397 where @xmath398 and @xmath399 are the plank and boltzmann constants respectively . for a blackbody radiation ,",
    "the effective temperature is simply @xmath400^{1/4},\\end{aligned}\\ ] ] where @xmath401 is the stefan - boltzmann constant .",
    "here we do not consider effect of the returning radiation of the disk on the spectrum , therefore @xmath402 is just the energy flux emitted from the disk s surface measured by a locally corotating observer .",
    "for the keplerian accretion disk around a kerr black hole , @xcite have get the analytical expression for @xmath402 , i.e. , @xmath403 where @xmath404 is mass accretion rate , @xmath405 is a function of @xmath406 , and the seminal expression of which is given by equations ( 15d ) and ( 15n ) of @xcite . with @xmath402 the effective temperature of the disk can be computed readily . using the invariance @xmath389",
    ", one can get the observed intensity @xmath390 .",
    "the total observed flux density at frequency @xmath393 therefore is the integration of @xmath394 over the whole plate @xmath407 then the photon number flux density is @xmath408 .",
    "the results are plotted in figure [ spectrum ] .",
    "compare to the figure 5 of @xcite we find that the basic features of the two figures are in agreement .",
    "for example , as shown in top panel , we see that as the spin of the black hole goes up the spectrum becomes harder .",
    "physically , this is due to the fact that as the spin @xmath11 increases , the system of the accretion disk has a higher radiation efficiency and a higher temperature . in the bottom panel of figure [ spectrum ] , we can see that at the low - energy end , the flux density goes down as @xmath361 goes up .",
    "as explained by @xcite this is caused by the projection effect . while at the high - energy end , the flux density goes up as the @xmath361 increases . as pointed out by @xcite this",
    "is resulted from the joint action of the effects of doppler beaming and gravitational focusing .    in the top panel",
    "there is a noticeable effect : even though we do not consider the returning radiation , the flux density goes up as the spin increases in the low - energy end .",
    "@xcite suggested that this effect is caused by the returning radiation .",
    "we proposal that this explanation may be not correct and the effect is just caused by the simple fact that a higher spin leads to a higher radiation efficiency and temperature .      in order to test the validation of the function @xmath353 and illustrate the time delay effect in the kerr spacetime",
    ", we image a hot spot orbiting around a black hole retrogradely in a marginally stable circular orbit for various spins and compute the observed light curve and spectra .",
    "the radius of the spot is @xmath409=0.5 @xmath357 .",
    "the emissivity of the spot is taken to be gaussian shape in its rest frame @xcite , i.e. , @xmath410.\\ ] ] for the motion of the spot , one must consider the time delay effect and the azimuthal position of the spot when imaging the spot and calculating its spectra . in order to compute the time delay @xmath411 for each geodesic starting from the photographic plate , a reference time @xmath412 , which is taken to be",
    "the time used by a photon traveling from the central point of the spot to the observer , needs to be specified .",
    "meanwhile the position of the spot can be determined by its central coordinates ( @xmath255 , @xmath413 , @xmath414 ) . then with the method discussed in section [ genmet ] , ( i.e. , the method to determine a geodesic connecting the observer and emitter with the given coordinates )",
    ", we can determine the geodesic connecting the central point of the spot and the observer .",
    "with this geodesic the reference time @xmath412 can be calculated readily .",
    "using @xmath412 , we can easily calculate the time delay @xmath411 for each geodesic , and @xmath415 , where @xmath416 is the time used by a photon traveling from the observer to the disk following the geodesic . with @xmath411 and",
    "the position of the spot , we can compute the distance between the intersection of the geodesic with the disk and the center of the spot , i.e. , @xmath417 .",
    "thus the emissivity can be computed readily .    in figure",
    "[ spot ] , we illustrate the images of the spot with different black hole spins . as the spin increases ,",
    "the marginally stable circular orbit is closer to the event horizon of the black hole , and the time delay effect becomes remarkable .",
    "the image of the spot is seriously warped , especially when the spot movies to the back of the event horizon .",
    "when an image is obtained , the redshift and gaussian emissivity of all points on the spot can be computed . repeating this procedure over one period of the motion",
    "gives a time - dependent spectrum .",
    "integrating the spectrum over frequency , or equivalently over the impact parameters , gives the light curve .",
    "the spectrum and light curve are shown in figure [ spectrum_spot ] , which agree well with the results shown in figures 6 and 7 of @xcite .        in this section",
    "we give a brief discussion to the radiative transfer process under the kerr spacetime .",
    "one can find more detailed discussions from @xcite and @xcite .",
    "it is well known that @xmath418 , @xmath419 and @xmath420 are lorentz invariants , where @xmath421 is the specific intensity of the radiation , @xmath422 and @xmath423 are the absorption and emission coefficients at the frequency @xmath393 .",
    "the radiative transfer equation reads @xcite @xmath424 where @xmath425 is the optical depth at the frequency @xmath393 , and defined by @xmath426 and @xmath427 , in which @xmath428 is the differential distance element of a photon traveling in the rest frame of the medium , @xmath13 is the affine parameter , @xmath429 is the four momentum of the photon , and @xmath430 is the four velocity of the medium .",
    "then the radiative transfer equation can be rewritten as @xcite @xmath431 the solution of above equation is @xcite @xmath432 where the optical depth is @xmath433 as discussed in section [ fourcoordinates ] , we can convert the independent variable from affine parameter @xmath13 to parameter @xmath0 . using @xmath434 and @xmath435 ,",
    "we can rewrite the solution as the integration of parameter @xmath0 @xcite @xmath436 where @xmath437 with above formulae one can deal with radiative transfer problems without considering the scattering contributions to the absorption and emission coefficients as did by @xcite and @xcite .",
    "in section [ torus_image ] we have discussed a rotationally supported torus and demonstrated its images . when the torus is optically thick , only the emissions come from the boundary surface are considered .",
    "when the torus is optically thin , all parts of the torus will do contributions to the observed emissions .",
    "we need to consider the radiative transfer procedure along the ray inside the torus . to get the absorption and emission coefficients",
    ", we need to konw the structure model of the tours , which determines the distributions of the temperature , mass density , pressure etc .",
    "firstly we construct the model of the torus , in which the torus is a perfect fluid and its energy - momentum tensor is given by @xcite @xmath438 where @xmath439 is the mass density , @xmath440 is the pressure , and @xmath441 is the internal energy , @xmath442 is the four velocity of the fluid , and @xmath443 are the contravariant components of the kerr metric . from the conservation law , namely @xmath444 , we get the equation of motion of the fluid as follows @xcite : @xmath445 where the semicolon ; represents the covariant derivative , and @xmath446 is the four acceleration of the fluid . for",
    "the torus is stationary and axisymmetric , we have @xmath447 , @xmath448 , and @xmath449 , @xmath450 are given by @xcite @xmath451,\\\\ \\label{at}a_\\theta & = & -\\dot{t}^2\\sin2\\theta\\left(\\frac{mr}{\\sigma^2}[a-(r^2+a^2)\\omega]^2+\\frac{\\delta\\omega^2}{2}\\right),\\end{aligned}\\ ] ] where @xmath452 is the time component of the four - velocity , @xmath380 is the angular velocity and takes the form of equation ( [ torus_omega ] ) .",
    "they satisfy following equation @xmath453 since the torus is assumed to be radiation dominated , the pressure @xmath440 can be regarded as the sum of gas pressure @xmath454 and radiation pressure @xmath455 , and @xmath456 where @xmath457 is the boltzmann constant , @xmath84 is the mean molecular weight , @xmath458 is the mass of a hydrogen , @xmath258 is the ratio of gas pressure to the total pressure , and @xmath459 is the black - body emission constant . from the above equations , one finally obtains @xmath460^{1/3}\\rho^{4/3},\\\\ \\label{t_rho}k t = \\hbar c\\left[\\frac{45(1-\\beta)}{\\pi^2\\mu m_\\mathrm{h}\\beta}\\right]^{1/3}\\rho^{1/3}.\\end{aligned}\\ ] ] thus @xmath461 , which implies that the state equation of the fluid is polytropic , therefore its internal energy is proportional to the pressure @xmath462 , and the equation of motion of the fluid ( [ torus_state_eq ] ) becomes @xmath463 substituting @xmath464 and @xmath461 into above equation , one obtains @xmath465 introducing a new variable @xmath466 defined by @xmath467 , above equation is simplified as @xmath468 which implies that the vector @xmath469 in the @xmath45-@xmath46 plane can be regarded as the normal vector of the contours of the density @xmath439",
    ". thus if we use @xmath470 to denote the tangent vector of the contours , we have @xmath471 , or equivalently @xmath472 if we use @xmath428 to denote the differential proper length of the tangent vector , we have @xmath473 where @xmath474 and @xmath475 are the components of the kerr metric , and @xmath476 , @xmath477 . solving the equations ( [ s11 ] ) and ( [ s22 ] ) simultaneously , we get a set of differential equations to describe the contours of density @xmath439 @xmath478 if we introduce an auxiliary variable @xmath382 defined by @xmath479 , and substitute equations ( [ ar ] ) and ( [ at ] ) into the above equations we get @xmath480 which have the exactly same forms with equations ( [ torus_isobar1 ] ) and ( [ torus_isobar2 ] ) , where @xmath481 and @xmath482 are given by the equations ( [ torus_contour1 ] ) and ( [ torus_contour2 ] ) . with these equations , the distributions of the mass density @xmath439 of the torus now are readily to be computed by evaluating the integral of @xmath466 from the torus center @xmath483 , @xmath484 to the location ( @xmath45 , @xmath46 ) along a path c which is orthogonal to the density contours everywhere . and the integral of @xmath466 is @xmath485 from the equations ( [ p_rho ] ) and ( [ t_rho ] ) one can get the total pressure and temperature distributions immediately with the given density @xmath439 .",
    "knowing the structure model of the torus , the absorption and emission coefficients are now readily to be specified , with which we can discuss the radiative transfer process inside the torus . using the above torus model , we shall give two examples of radiative transfer applications .",
    "firstly we consider a rather simple case , in which the torus is optically thin .",
    "the emissivity is taken to be proportional to the mass density @xmath439 , i.e. , @xmath486 , and is independent on the frequency @xmath393 .",
    "the absorption coefficient @xmath422 is simply assumed to be zero .",
    "the torus parameters are @xmath487 , @xmath488 @xmath357 .",
    "the black hole spin @xmath11 is @xmath489 .",
    "the ratio of gas pressure to total pressure @xmath258 is @xmath490 . in figure [ torusthin ]",
    "we draw the images of the torus , which is optically thin and radiation pressure dominated .",
    "we see that the emissions mainly come from the central region of the torus , where the density is higher . as the inclination angle of observer increases ,",
    "the frequency shift of the emission caused by the doppler boosting becomes larger . in this figure",
    "the false color represents the observed intensities of the emission , showing that the approaching side of the torus is brighter than the receding side especially at higher inclination angles .    secondly , we mimic a more realistic case , namely the thermal free - free emission and absorbtion procedure , in which the torus is semi - opacity .",
    "the emission and absorbtion coefficients of the torus for a photon at energy @xmath491 are given by @xcite @xmath492 where @xmath493 , @xmath494 and @xmath495 are the normalization constants , @xmath496 is the electron number density and @xmath497 , @xmath498 is the thompson cross - section",
    ". the observed intensity images of the optically thick and semi - opacity torus are plotted in figure [ torus_thick ] .",
    "these images are quite different from those of an optically thin torus .",
    "the emissivity now depends on the temperature , which decreases towards to the outer surface of the torus , leading the limb darkening phenomenon .",
    "when the rays are nearly tangential to the layers of the torus , they will travel a longer distance and go through the outer , thus colder layers . while when the rays are perpendicular to the layers of the torus , they will travel a shorter distance and go through the inner therefore hotter layers .",
    "consequently , the observed intensity at lower inclination angles will be much brighter than that at higher inclination angles @xcite .",
    "following @xcite we have presented a new public code named ynogk for the fast calculating of null geodesics in a kerr spacetime .",
    "the code is written by fortran 95 , and composed by a couple of modules .",
    "in which the object - oriented method has been used , which makes the addition of the code to one s own readily .    in ynogk",
    "the b - l coordinates @xmath45 and @xmath84 have been expressed as analytical functions of the parameter @xmath0 . in these expressions ,",
    "the weierstrass and jacobi s elliptic function @xmath96 , @xmath134 and @xmath499 are used , since the reductions to weierstrass s standard integrals are much easier , in which only one real root of the equations @xmath73 and @xmath108 is required .",
    "the b - l coordinates @xmath91 , @xmath79 and the affine parameter @xmath13 have been expressed as numerical functions of @xmath0 . for a given @xmath0 ,",
    "the number of times of a photon reaches the turning points both in radial and poloidal motions is uniquely determined and needs not to be specified by the user",
    ".    actually in addition to @xmath0 , coordinates @xmath45 , @xmath84 ( or @xmath46 ) can also be taken as the independent variables @xcite .",
    "the main reason of using @xmath0 is that one can pay no attention to handle turning points , which has been done by the inner routines of our code .",
    "this virtue is convenient for a person who is not familiar with or has no interesting to the details of the calculation of a geodesics in the kerr spacetime .",
    "another reason is that the value of @xmath0 which corresponds to the termination of the geodesic  either at the infinity or the event horizon  is finite .",
    "thus it is easier to handle @xmath0 than @xmath45 . in our code @xmath45 and @xmath84",
    "can also be taken as the independent variable .",
    "we provide a routine named * geokerr * , which can take @xmath45 or @xmath84 as the independent variable .",
    "but the number of turning points should be prescribed .    with the expressions of all coordinates and affine parameter as functions of @xmath0 , the ray - tracing problem , which determines",
    "the intersection of the ray with a target object , now becomes a root finding problem .",
    "the function @xmath315 that describes the surface of the target object needs to be given by the user and the roots of equation @xmath318 correspond to the intersections .",
    "we provide a module named * pem - finding * to search the minimum root of this equation by the bisection or the newton - raphson method .",
    "in addition , the observer - emitter problem can also be converted to a root finding problem , which requires one to solve a set of nonlinear equations . a module named * obs - emitter * based on the newton - raphson method to solve these equations is provided in our code .",
    "the routines in this module will return the solution , provided the coordinates of the emitter , @xmath500 and @xmath338 , are given .",
    "we present a new set of formulae to compute the constants of motion @xmath22 and @xmath228 from initial conditions .",
    "these formulae can be regarded as the extensions of @xcite .",
    "our formulae are pervasive and can be used to handle more sophisticated cases , in which the motion state and the finite distance of the observer or the emitter with respect to the black hole are considered .",
    "one may find it is convenient when dealing with problems in which the emitter has motion and is closed to the vicinity of a black hole , e.g. , the self - irradiation process in the inner region of a disk",
    ".    the code has been tested extensively with various toy problems in the literature .",
    "the results agree well with previous works . the comparisons with geokerr of @xcite",
    "also have been presented .",
    "finally we point out that the strategy discussed in this paper can be naturally extended to the calculation of the timelike geodesics almost without any modification . especially for",
    "the timelike bounded orbits , in which the number of turning points both in poloidal and radial coordinates can be arbitrary .",
    "the extension of this strategy to calculate the timelike geodesics in a kerr - newmann spacetime has been done and the results are under preparation .",
    "we acknowledge the financial supports from the national basic research program of china ( 973 program 2009cb824800 ) , the national natural science foundation of china 11163006 , 11173054 , and the policy research program of chinese academy of sciences ( kjcx2-yw - t24 ) .",
    "we also thank the anonymous referee for very creative and helpful comments and suggestions , which have improved both our work and the paper much .",
    "this figure illustrates the motion of a photon in the @xmath46 coordinate , which has been projected onto the @xmath501 plane .",
    "the motion is confined between two turning points @xmath502 and @xmath503 .",
    "a , d and f indicate the positions where the photon reaches the turning points and p indicates the position of the photon .",
    "the path between any two neighboring turning points ( such as da , df ) has the maximum monotonic length and the integrals of @xmath46 should be evaluated along each monotonic section and summed .",
    "the doted ( such as ca , ef and pf ) and solid ( such as dc and de ) lines represent the integral paths of @xmath205 and @xmath504 ( see text ) respectively .",
    "obviously the bc section is the integral path of @xmath505 , and one has @xmath506 , @xmath507 , @xmath508 , etc.,scaledwidth=45.0% ]    a set of geodesics emitted isotropically from a particle orbits around a black hole in the marginally stable circular orbit with @xmath11=0.9375 .",
    "x and y are pseudo - cartesian coordinates in the equatorial plane of the black hole .",
    "the figure shows the light bending and beaming effects clearly .",
    "a circle in the center represents the boundary of the event horizon.,scaledwidth=70.0% ]    the figure shows the hitting of a photon on the photographic plate of the observer , from which the relationships between the impact parameters @xmath509 and the components @xmath243 of the four momentum of the photon are derived . before hitting the plate , all photons will go through the center of the lens .",
    "@xmath510 are the contravariant basis vectors of the frame , and the basis vectors of @xmath509 coordinates @xmath266 , @xmath267 are aligned with @xmath265 , @xmath264 respectively.,scaledwidth=70.0% ]     the projection of a uniform grid from the photographic plate of the observer onto the equatorial plane of a black hole is shown .",
    "the inclination angle @xmath511 is @xmath512 and the black hole spin a is 0.95 .",
    "solid lines represent the results from our code and the dotted lines from geokerr .",
    "x and y are pseudo - cartesian coordinates in the equatorial plane of the black hole.,scaledwidth=60.0% ]     the classifications of a set of null geodesics according to their relationships with respect to a shell , the inner and outer radius of which are @xmath319 and @xmath320 respectively .",
    "the geodesics are classified into four classes , marked by a , b , c and d. since the target object or the emission region are assumed to be completely included by the shell , only geodesics in classes b , c and d have probabilities to intersect with the target object or go through emission region .",
    "the trajectories of the geodesics are schematically plotted and have been projected onto the @xmath45-@xmath46 plane .",
    "the central black region represents the black hole shadow.,scaledwidth=50.0% ]    the shadow of a black hole with near extremal spin ( @xmath513 ) from the edge - on view is shown .",
    "the radial coordinate of the observer is @xmath356 @xmath357 .",
    "the greyscale represents the value of the affine parameter @xmath13 evaluated from the observer to the terminated position  either at the black hole or re - emerging to the starting radius .",
    "compare to figure 2 of @xcite .",
    "@xmath257 and @xmath258 are the impact parameters , which describe the size and the position of the image on the photographic plate.,scaledwidth=80.0% ]     this figure shows the image of a standard thin accretion disk , whose inner and outer radius are @xmath514 and 22 @xmath357 respectively .",
    "the black hole spin @xmath11 is 0.998 and the inclination angle @xmath361 is @xmath362 .",
    "the radial coordinate of the observer is 40 @xmath357 .",
    "one can see figure 6 of @xcite or figure 4 of @xcite for comparison . the high - order image is also shown .",
    "@xmath257 and @xmath258 are the impact parameters , and the intensity of the greyscale represents the redshift @xmath293 of emissions come from the surface of the disk . ]",
    "images of a thick disk around a near extremal kerr black hole ( a=0.998 ) for various inclination angles are shown .",
    "the surface of the disk has a constant inclination angle @xmath364 with respect to the equatorial plane and @xmath364 is taken to be @xmath515 .",
    "the inner radius is the marginally stable circular orbit @xmath514 and the outer radius is 20 @xmath357 .",
    "the inclination angles @xmath361 are @xmath516 , @xmath515 , @xmath517 and @xmath518 for panels a , b , c and d respectively . @xmath257 and @xmath258 are the impact parameters , and the intensities of the color represent the redshift @xmath293 of emissions come from the surface of the disk .",
    "compare to figure 10 of @xcite.,scaledwidth=100.0% ]     this figure shows the images of a warped accretion disk around a near extremal black hole ( a=0.998 ) viewed from different azimuthal angles .",
    "the inner and outer radius of the disk are @xmath255 and 50 @xmath357 .",
    "the observer s inclination angle @xmath361 is 50@xmath519 .",
    "the warping parameters are @xmath520 , @xmath521 , and @xmath522 .",
    "the azimuthal angle @xmath523 , which represents the view angle , is @xmath524 , @xmath525 , @xmath526 , @xmath527 , @xmath528 , @xmath529 , @xmath530 and @xmath531 for panels from left to right and top to bottom respectively . for comparison",
    "we show a image observed from a face - on view in the final panel .",
    "the false color also represents the redshift @xmath293 of the emissions come from the surface of the disk .",
    "@xmath257 and @xmath258 are the impact parameters .",
    "we take the parameter @xmath532 , leading the warping of the disk along the azimuthal direction shown clearly in the final panel , which is the main difference compare to figure 3 of @xcite.,scaledwidth=80.0% ]     images of a rotationally supported torus , which is geometrical and optically thick , are shown .",
    "the torus parameters are @xmath533 , @xmath534 @xmath357 .",
    "the black hole spin @xmath11 is 0 , 0.5 and 0.998 for panels from top to bottom .",
    "the inclination angle @xmath361 is @xmath525 for left column and @xmath535 for right column .",
    "the false color represents the redshift @xmath293 of the emissions come from the surface of the torus and the white areas represent the zero - shift regions .",
    "@xmath257 and @xmath258 are the impact parameters .",
    "compare to figure 3 of @xcite.,scaledwidth=80.0% ]     this figure illustrates the gravitational lensing effect by the motion of a ball movies around a near extremal black hole ( a=0.998 ) in a keplerian orbit .",
    "the motion is observed from an edge - on view .",
    "the radius of the ball and the orbit are 5 @xmath357 and 20 @xmath357 respectively .",
    "the central red region represents the black hole shadow .",
    "the azimuthal angles of the ball measured from the line of sight along inverse - clockwise direction are @xmath536 for panels a - h .",
    "the pseudo color shows the redshift of the emissions come from the surface of the ball . @xmath257 and @xmath258 are the impact parameters.,scaledwidth=100.0% ]    the theoretical line profiles of the fe k@xmath257 of a thin accretion disk for various black hole spins and inclination angles are shown .",
    "the inner and outer radius of the disk are @xmath255 and 15 @xmath357 .",
    "top row : @xmath537 ; bottom row ; @xmath513 . left column : @xmath538 ; middle column : @xmath539 ; right column : @xmath540 .",
    "the horizonal and vertical axes represent the frequency and flux of the line respectively and are normalized .",
    "the line profiles are in agreement well with the figure 3 of @xcite.,scaledwidth=70.0% ]    the effects of the black hole spin ( top ) and the inclination angle ( bottom ) on the spectrum of a standard thin accretion disk around a kerr black hole are shown .",
    "the inner and outer radius of the disk are @xmath255 and @xmath541 @xmath357 , where @xmath255 is the radius of marginally stable circular orbit .",
    ", scaledwidth=60.0% ]     the images of a hot spot orbits around a black hole for different black hole spins are shown .",
    "the spot lies in a standard thin accretion disk and its central point is fixed at the isco .",
    "we have extended the inner radius of the disk to the photon orbit @xmath542 , at which the energy per unit rest mass of a particle is infinite .",
    "it is also the innermost boundary of circular orbit for particles @xcite . for the panels from left to right and top to bottom",
    ", the black hole spin a is 0.998 , 0.5 , 0 and -0.998 respectively .",
    "the inclination angle @xmath361 is @xmath535 .",
    "the false color represents the value of @xmath543 , where @xmath293 is the redshift of the emissions come from the surface of the disk , and @xmath544 is the emissivity of the spot.,scaledwidth=80.0% ]     the time - dependent spectrogram ( panel a ) and light curves ( panel b ) of a hot spot orbits around a schwarzschild black hole in the marginally stable circular orbit ( 6 @xmath357 ) over one period are shown .",
    "the inclination angle @xmath511 is @xmath512 for the spectrum .",
    "the greyscale in panel a represents total sum of emissivity @xmath544 of emissions which are observed at the same time and have the same redshift @xmath293 . the greyscale has been normalized and the maximum is taken to be 1 .",
    "compare to figure 6 and 7 of @xcite.,scaledwidth=60.0% ]     this figure shows the images of an optically thin and radiation pressure dominated torus .",
    "the inclination angles of the observer are @xmath545 , @xmath515 , @xmath525 , @xmath512 , @xmath546 and @xmath526 for panels from left to right and top to bottom .",
    "the black hole spin @xmath11 is @xmath489 , and the ratio of gas pressure to total pressure @xmath258 is @xmath490 .",
    "the torus parameters are @xmath487 , @xmath488 @xmath357 .",
    "the brightness of each pixel represents the observed intensity integrated along a geodesic ray at a given frequency and has been normalized , and the maximum for each panel is the same and equals to 100 .",
    "@xmath257 and @xmath258 are the impact parameters.,scaledwidth=80.0% ]     this figure shows the images of an optically thick and semi - opacity torus .",
    "the inclination angles are @xmath545 , @xmath515 , @xmath525 , @xmath512 , @xmath546 and @xmath526 for panels from left to right and top to bottom .",
    "the black hole spin @xmath11 is @xmath489 , and the ratio of gas pressure to total pressure @xmath258 is @xmath490 .",
    "the torus parameters are @xmath487 , @xmath488 @xmath357 .",
    "the brightness of each pixel represents the observed intensity integrated over the entire spectrum .",
    "the intensity has been normalized , and the maximum of each panel is the same and equals to 100 .",
    "@xmath257 and @xmath258 are the impact parameters.,scaledwidth=80.0% ]"
  ],
  "abstract_text": [
    "<S> following @xcite we present a new public code for the fast calculation of null geodesics in the kerr spacetime . using weierstrass and jacobi s elliptic functions , </S>",
    "<S> we express all coordinates and affine parameters as analytical and numerical functions of a parameter @xmath0 , which is an integral value along the geodesic . </S>",
    "<S> this is a main difference of our code compares with previous similar ones . </S>",
    "<S> the advantage of this treatment is that the information about the turning points do not need to be specified in advance by the user , and many applications such as imaging , the calculation of line profiles or the observer - emitter problem , etc become root finding problems . </S>",
    "<S> all elliptic integrations are computed by carlson s elliptic integral method as @xcite did , which guarantees the fast computational speed of our code . </S>",
    "<S> the formulae to compute the constants of motion given by @xcite have been extended , which allow one readily to handle the situations , in which the emitter or the observer has arbitrary distance and motion state with respect to the central compact object . </S>",
    "<S> the validation of the code has been extensively tested by its application to toy problems from the literature . </S>",
    "<S> the source fortran code is freely available for download on the web . </S>"
  ]
}