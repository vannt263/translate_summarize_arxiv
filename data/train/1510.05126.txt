{
  "article_text": [
    "monitoring diffusion in microscopic channels offers a wide range of possibilities for determining the size of particles in solution or the viscosity of fluids @xcite . for flow occurring at low reynolds numbers , where viscous forces dominate over inertial ones ,",
    "the velocity profile can be determined analytically for simple geometries ( see for instance ref .",
    "@xcite ) , a factor which gives a computationally inexpensive way of simulating advective transport .",
    "exact results for advection coupled to diffusion are also known for certain geometries , notably in the case of taylor dispersion @xcite . in general , however , for predicting the steady - state distributions of particles in the presence of diffusion in arbitrary geometries , conventional strategies rely on solving the continuity equation in three dimensions @xcite .    here",
    "we present a method for circumventing the requirement to work with the probability distribution directly , an approach similar to that used for field - flow fractionation @xcite and for obstacles in microchannels at low pclet numbers @xcite , and show that the downstream concentration profile of the analyte emerges from a particle _ flux_. crucially , the computational cost of calculating this particle flux for discrete particles is only weakly dependent on the system geometry and the boundary or initial conditions . in particle - based simulations ,",
    "the task of solving the fokker - planck equation @xcite @xmath0\\rho(\\vec{r},t)\\ ] ] for the probability distribution @xmath1 of the particles is replaced with that of solving the corresponding langevin equation @xcite @xmath2 for the motion of the particles with mass @xmath3 . here , @xmath4 is the particle drift velocity , @xmath5 the diffusion coefficient with boltzman constant @xmath6 and temperature @xmath7 , @xmath8 the friction coefficient of a spherical particle with radius @xmath9 , @xmath10 the fluid viscosity , and @xmath11 the random langevin force field that ensures thermal equilibrium through @xmath12 . from equation [ eq : langevin ]",
    "it can be inferred that the mean - square displacement in each spacial dimension is @xmath13 .",
    "focusing on the langevin equation allows a straightforward implementation of complex initial or boundary conditions as well as of force fields .",
    "furthermore , this method is conceptually very simple as the stability analysis of the langevin equation is much simpler than that of the fokker - planck equations that commonly take the form of complex partial differential equations which have to be iterated to convergence with specific boundary conditions in time and space .",
    "the naive evaluation of the langevin equation by establishing a steady - state flow of particles under continuous flow by creating new particles at every discrete time step is computationally very expensive as an increasingly large number of particles is required . a key realisation that makes",
    "this approach practically useful is that the steady state can in fact be simulated by loading all particles at @xmath14 and @xmath15 and propagating them until they have all left the area of interest , rather than introducing new particles at every step . in applications at low pclet numbers ,",
    "these particles can be loaded randomly @xcite , since diffusion will randomise the distribution in any case . at high pclet numbers ,",
    "however , it is crucial how the particles are initiated . here",
    ", we show that by initiating a ( velocity - weighted ) flux @xmath16 with @xmath17 the initial concentration , @xmath18 the fluid velocity at position @xmath19 and @xmath20 the fluid velocity averaged over the channel cross - section , of a given distribution at time zero , we can simulate the steady - state downstream particle concentration by counting the number of time steps each monte - carlo trajectory spends in a predefined detection region .",
    "it is important to note that this method of initialisation and detection accounts for the velocity profile in microchannels .",
    "furthermore , initialising the particle _ flux _ instead of _ concentration _ circumvents the detection bias that would occur otherwise for particles moving slowly through the detection region - for instance close to a channel wall .    in order to demonstrate the applicability of our approach",
    "we have compared the predicted concentration profiles with experimentally obtained diffusive broadening of a stream of fluorescent colloids flowing continuously in a microfluidic channel at steady state , starting from their measured initial probability distribution .",
    "the readily achievable conditions for laminar flow on micrometer scales thereby enables the accurate calculation of the flow field inside the channel , thus leading to an accurate match between predicted and measured downstream particle distributions .",
    "figure  [ fig : expscheme ] describes schematically the problem that we wish to solve .",
    "a flux of monodisperse particles is subjected to advective motion along a channel ( @xmath21-axis ) and diffusive motion in all directions at high lateral pclet numbers - i.e. , the time scale for advection along the channel is much shorter than the time scale for diffusion across the larger channel dimension . at a predefined distance from the initial point",
    ", the lateral distribution of the particles can be determined experimentally - e.g. , by fluorescence microscopy - and predicted by simulation according to eq .",
    "[ eq : langevin ] .",
    "in our case , the channel dimensions are @xmath22 , @xmath23 , and @xmath24 for width , height , and length , respectively .",
    "the flow rate is @xmath25 , which leads to a reynolds number of @xmath26 where @xmath27 and @xmath28 are the fluid density and viscosity , @xmath29 is the advective velocity along the channel , and @xmath30 is the hydraulic diameter . for the pclet number relating the time scales for diffusive and advective transport @xmath31",
    "we distinguish the cases along the height ( @xmath32 ) and along the width ( @xmath33 ) of the channel . using a diffusion coefficient @xmath34 for a particle with @xmath35",
    "this yields @xmath36 in the vertical direction and @xmath37 in the horizontal direction .",
    "note that these values mean that , due to the channel aspect ratio , during the time scale of the advective transport the particles sample the entire height but do not diffuse completely across the channel .      in principle",
    ", a steady - state distribution of particles can be simulated by creating a new flux of particles at every discrete time step @xmath38 and propagating all of these sets .",
    "this approach , however , requires keeping track of a growing number of particles which is computationally extremely expensive and memory - intensive if a large number of propagation steps is desired .",
    "furthermore , at low pclet numbers , the particles can be initialised in a random distribution since their position will be randomised by diffusive mixing throughout the simulation .",
    "this , however , is not applicable at high pclet numbers , and merely loading an initial concentration profile will fail since that does not take into account the velocity - weight of the particle motion across the channel cross section .",
    "instead , we propose initiating a large flux @xmath39 ( @xmath40 particles ) at @xmath14 and @xmath15 , whereupon these particles are individually subjected to advective flow and diffusion , which enables determination of the steady state simply by counting the number of time steps @xmath41 the @xmath6-th particle spends in each lateral bin @xmath42 in a predefined detection region @xmath43 .",
    "this yields the concentration per bin via @xmath44}\\cdot\\delta_{[x_k(t_n ) \\in x_d]},\\ ] ] where @xmath45}$ ] is the kronecker delta function , equal to 1 if @xmath46 is within the region @xmath42 and 0 otherwise .",
    "figure [ fig : algscheme ] illustrates the creation and propagation of fluxes at discrete time steps under advective flow .",
    "specifically , at every time point @xmath47 , a new flux of particles ( symbolised by a different colour ) is introduced at @xmath14 and the existing particles migrate along a channel according to a given velocity profile . for simplicity ,",
    "diffusion is not considered in this schematic . from this graph",
    "it is clear that the flux @xmath39 of particles depends only on the number of iterations enacted and not on the time step at which it was created .",
    "more formally , @xmath48=\\phi[x=0,\\tau=0,n = l],\\ ] ] where @xmath47 denotes the time point at which the particles were introduced into the device , and @xmath49 is the number of iterations effected on them .",
    "the @xmath50-dependence of @xmath39 in this term is omitted for improved readability .",
    "note that in practice the width of the detection region should be much larger than the distance propagated per step but much smaller than the distance from the start point to the detection region .",
    "other than the effect of averaging the concentration profile over the length of the read area , the results of these simulations are not sensitive to the size of the detection region .    therefore , the steady - state flux , which is given by @xmath51\\ ] ] with @xmath52 sufficiently large , can be written as @xmath53.\\ ] ] from there , the concentration in a detection region @xmath43 can be computed by @xmath54},\\ ] ] where @xmath55 corresponds to an exposure / integration time .",
    "this procedure results in @xmath56\\delta_{\\left[x\\in x_d\\right]},\\ ] ] which can now be simplified to @xmath57\\delta_{\\left[x\\in x_d\\right]},\\ ] ] where @xmath58 equals the number of iteration steps needed for all the initialised particles to reach and exit the detection region .",
    "equation  [ eq : concentration ] is straightforwardly implemented by performing propagation steps individually on a large number of particles , @xmath59 , until @xmath60 for all @xmath61 $ ] ; note that @xmath58 may differ for each particle . specifically ,",
    "numerical assessment of the concentration is effected by :    1 .   initialising @xmath59 particles at @xmath14 in a given distribution multiplied by the longitudinal velocity @xmath62 to obtain a flux @xmath63 $ ] , 2 .   propagating each individual particle until @xmath60 , 3 .",
    "recording the @xmath64-values of each particles while @xmath65 .",
    "this procedure results in a histogram of @xmath64 values that corresponds to the concentration distribution inside the channel . by also acquiring the @xmath66-values in @xmath43",
    ", the vertical profile can be simulated as well and compared , for example , with a confocal image @xcite .",
    "taking into account diffusion and advection , propagation of the @xmath6th particle in all three spatial dimensions in a random walk is given by the discrete version of the integrated langevin equation ( [ eq : langevin ] ) @xmath67 with @xmath68 the advective flow velocity in @xmath21-direction , @xmath69 the time interval of the simulations , @xmath70 the diffusion coefficient of the analyte in question , and random selecting either -1 or + 1 .",
    "note that this formulation of particle brownian motion fulfils the fluctuation - dissipation theorem by construction @xcite .",
    "reflective boundary conditions are implemented at the channel walls .",
    "additionally , any other form of concentration - independent migration such as electrophoresis can be incorporated readily into these steps .    in the present case of laminar poiseuille flow through a rectangular channel with no - slip boundary conditions ,",
    "the velocity can be expressed analytically ( see ref .",
    "@xcite , for instance ) by @xmath71 where @xmath72 and @xmath73 are the channel width and height , respectively , and @xmath74 is a parameter such that integration over the channel cross section yields the predefined flow rate .",
    "depending on the number of particles , the length of the channel , the flow velocity , and the time step length @xmath38 , a simulation takes between less than one minute up to a few hours .",
    "we note that this strategy does not take into account changes in viscosity due to changing particle concentrations - a limitation that is rarely a problem in practise in light of the low analyte concentration requirements afforded by present - day fluorescence microscopy techniques .",
    "the effect of the exact method of initialising the particles is demonstrated in fig .",
    "[ fig : loading ] .",
    "simulations for @xmath75 particles in a channel of width @xmath22 , height @xmath23 and length @xmath76 are performed at pclet numbers of @xmath77 , 4 , and 40 , by varying the flow rate from @xmath78 to @xmath79 and @xmath25 . here",
    ", the time step width was chosen to be 5  ms for @xmath80 and 25  ms for @xmath81 and @xmath77 .",
    "particles were initialised uniformly in the left half of the channel according to their concentration ( red lines ) and their flux ( blue lines ) , and detected by counting their occurrence in each of the 100 lateral bins in the detection region at @xmath82 .    in practise ,",
    "initialisation according to concentration was achieved by placing each particle @xmath6 randomly along the height @xmath73 and half the width @xmath72 of the channel . specifically , @xmath83 where @xmath84 draws a uniformly distributed random number in the range between 0 and 1 .",
    "initialisation according to flux additionally compares a freshly drawn random number @xmath85 to the relative flow rate @xmath86 and only places the particles if @xmath87 .",
    "this process is repeated until all @xmath59 particles could be placed .",
    "the detection algorithm increments a detector bin value @xmath88 for every time step a particle @xmath6 spends inside the detection region , i.e.    * @xmath89 for all @xmath52 ; * if @xmath90 and @xmath91 , the value @xmath88 is increased by 1 ; * repeat until all particles @xmath6 have left the detection region @xmath43 .",
    "the initial profiles are shown as the dash - dotted lines in fig .",
    "[ fig : loading ] . at low pclet numbers ,",
    "both the flux and concentration initialisation produce the correct profiles due to the almost complete randomisation of the particle positions by molecular diffusion . at intermediate , and even more so at high pclet numbers , however , initialising a particle concentration leads to an overestimation of the relative intensity close to the edge of the channel as a consequence of the slower flow velocity yielding increased detection counts .",
    "these simulations demonstrate the necessity of considering an initial distribution that is proportional to a particle flux rather than a concentration .",
    "it should also be noted that the opposite method of initialising a concentration followed by velocity - weighting the detector counts will not lead to correct results .",
    "this is illustrated by the nearly perfect match of the readout profiles at low pclet numbers .",
    "in order to test the quantitative nature of the solution obtained from our simulations , we compared the results of this numerical simulation with experimental measurements of the transport of colloidal particles in microchannels .",
    "microfluidic channels were fabricated at a width of @xmath22 , a height of @xmath23 and a length of @xmath92  mm using standard soft lithography  @xcite .",
    "carbon nanopowder ( 633100 , sigma aldrich , st.louis mo , usa ) was added to the elastomer prior to curing to create black devices that decrease the background from ambient and scattered light .    a suspension of fluorescent polystyrene colloids ( fluoromax g50 , thermo scientific , waltham ma , usa ; nominal particle radius 25  nm with a uniformity better than @xmath93 ; density @xmath94 ) at a volume fraction of around @xmath95 and an auxiliary fluid , here deionised water , were supplied through a pipette tip inserted into the respective inlet .",
    "the analyte and auxiliary fluid were driven through the channel at a flow rate of @xmath25 by a negative pressure on the device outlet , applied by a syringe pump ( nemesys , cetoni gmbh , korbuen , germany ) . in a nozzle area , the colloid suspension is focused in a narrow beam in between two flanking streams of auxiliary fluid .",
    "the flow of the particle suspension and of the auxiliary fluid makes up 10 and @xmath96 of the total flow , respectively , and is determined by the hydrodynamic resistance of the inlet channels .    to ensure full stabilisation of the poiseuille flow profile through diffusion of vorticity , we allowed the analyte to migrate longitudinally over a distance of 8.6  mm before recording what we define as the `` initial '' distribution .",
    "diffusive broadening was then measured at positions downstream of this point by 10 , 20 , 50 , and 80 mm , corresponding to average migration times of 7 , 14 , 34 , and 54  s.    all diffusion profiles were recorded through standard fluorescence microscopy using a cooled ccd camera ( evolve 512 , photometrics , tucson az , usa ) with a pixel size of 16x16  @xmath97 . we note that this detection method does not cover the @xmath66-dependence of the distribution resulting from the slower advective velocity closer to the channel walls @xcite .",
    "however , since our experiments take place in the regime of small pclet numbers in the vertical direction ( diffusive migration distances are larger than the channel height ) it is safe to assume that the analyte will sample the vertical velocity profile well enough to average out such effects .",
    "figure [ fig : data](a ) shows a fluorescence microscopy image of the initial distribution of fluorescent colloids at @xmath14 . after migrating longitudinally over a distance of 80  mm ,",
    "the beam has widened considerably in the lateral direction , as seen in fig .",
    "[ fig : data](b ) .        from fluorescence microscopy images at positions of 10 , 20 , 50 , and 80  mm downstream from the initial point , the distributions of the analyte were extracted and are presented as the dotted lines in fig .  [",
    "fig : data](c)-(f ) .",
    "the simulated profiles for different , uniform particle sizes are shown as blue ( @xmath98 ) , red ( @xmath35 ) , and green lines ( @xmath99 ) .",
    "the excellent agreement between the measured distributions and the simulation using the data - sheet value of the colloids @xmath35 demonstrates the feasibility of using arbitrary ( but measured ) initial probability distributions as starting points to simulate steady - state mass transport and verifies the accuracy of our approach .",
    "we emphasise that the simulated curves are not fits to the data , but are generated from first principles ( using the measured initial profile ) and the only free parameter is the particle size .",
    "nevertheless , we can quantify the deviations of the simulations from the measurement in a way analogous to the reduced @xmath100 value : calculating the sum of square errors per data point and normalising against an estimate of the experimental ( via the standard deviations of the first and last 15 data points in each plot in fig .",
    "[ fig : data ] ) we obtain @xmath101 for the simulations with a radius of 25  nm shown in panels ( c ) , ( d ) , ( e ) , and ( f ) , respectively . in comparison ,",
    "the corresponding numbers for radii of 10 or 40  nm are of the order of a thousand to tens of thousands .",
    "while the above values for @xmath35 are clearly larger than one , our estimate for the variance of the experimental data only takes into account the camera read - out noise at low signal strengths and no deviations due to imperfections in the channels or from additional scatterers . in this sense , these values for the normalised square errors are to be understood as an upper bound . as such ,",
    "these results show that the computed mass distributions approximate the measurements to better than a factor of @xmath102 of the noise level .",
    "we have proposed and validated experimentally a strategy for simulating steady - state mass transport of particles under flow that relies on determining the trajectories of individual particles initialised according to their generating flux rather than solving the fokker - planck equations of the probability distributions .",
    "this approach allows for studies of systems at high pclet numbers and provides a straightforward way of incorporating measured initial profiles as well as facile implementation of force fields , such as electric or gravitational forces .",
    "microfluidics as well as nanofluidics provide particularly well - suited application platforms for this approach since devices are typically operated in the regime of poiseuille flow and diffusion is widely used for controlled mixing , separating and analysing particles in solutions .    financial support from the biotechnology and biological sciences research council ( bbsrc ) , the european research council ( erc ) , the frances and augustus newman foundation as well as the swiss national science foundation is gratefully acknowledged ."
  ],
  "abstract_text": [
    "<S> conventional approaches for simulating steady - state distributions of particles under diffusive and advective transport at high pclet numbers involve solving the diffusion and advection equations in at least two dimensions . here , we present an alternative computational strategy by combining a particle - based rather than a field - based approach with the initialisation of particles in proportion to their flux . </S>",
    "<S> this method allows accurate prediction of the steady state and is applicable even at high pclet numbers where traditional particle - based monte - carlo methods starting from randomly initialised particle distributions fail . </S>",
    "<S> we demonstrate that generating a flux of particles according to a predetermined density and velocity distribution at a single fixed time and initial location allows for accurate simulation of mass transport under flow . </S>",
    "<S> specifically , upon initialisation in proportion to their flux , these particles are propagated individually and detected by summing up their monte - carlo trajectories in predefined detection regions . </S>",
    "<S> we demonstrate quantitative agreement of the predicted concentration profiles with the results of experiments performed with fluorescent particles in microfluidic channels under continuous flow . </S>",
    "<S> this approach is computationally advantageous and readily allows non - trivial initial distributions to be considered . in particular , this method is highly suitable for simulating advective and diffusive transport in microfluidic devices . </S>"
  ]
}