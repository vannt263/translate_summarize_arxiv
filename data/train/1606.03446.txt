{
  "article_text": [
    "the prototype panoramic survey telescope and rapid response system ( pan - starrs1 , hereafter ps1 ) is a wide - field imaging system , with a 1.8 m telescope and 7.7 deg@xmath2 field of view , located on the summit of haleakala in the hawaiian island of maui ( see * ? ? ?",
    "the 1.4 gpixel camera consists of 60 ccds with pixel size of 0.256 arcsec @xcite .",
    "it uses five filters ( g@xmath3 , r@xmath3 , i@xmath3 , z@xmath3 , y@xmath3 ) , similar to the ones used by the sloan digital sky survey ( sdss * ? ? ?",
    "the largest survey ps1 performs is the 3@xmath4 survey , covering the entire sky north of @xmath5 declination .",
    "ps1 uses the 2mass catalog @xcite as reference for astrometry , however this has been shown to introduce biases @xcite and large zonal errors ( large - scale systematic errors on the sky ) . when constraining the motion of asteroids , @xcite found residuals in both right ascension and declination that were both positive with 50 - 100 mas offsets .",
    "@xcite suggested these large biases stemmed from uncorrected proper motions @xmath6 a direct result of using the 2mass catalog as reference .",
    "later , @xcite used proper motions from selected stars in the ppmxl catalog @xcite to make corrections to the ps1 solution ( and other catalogs ) , successfully removing the large - scale zonal residuals from the asteroid astrometric solutions .",
    "classical astrometry methods require the use of stellar - based reference catalogs ( such as the 2mass catalog in this example ) making high - accuracy , bias - free absolute astrometry difficult .",
    "zonal errors are very hard to remove from these stellar - based reference catalog . instead",
    ", post - processing ` corrections ' are made to compensate for obvious biases .",
    "a much cleaner concept of absolute astrometry is the global solution ( gas ) , better known as the block adjustment method ( ba ) . instead of using stars from a reference catalogs to tie each observation ( so - called reference stars )",
    ", this method uses an absolute reference frame , such as the international celestial reference frame ( icrf , see * ? ? ?",
    "the icrf2 is a zero proper - motion , zero parallax , higher - precision absolute reference frame from which to derive all 5 astrometric parameters ( @xmath7 , @xmath8 , @xmath9 , @xmath10 , @xmath4 ) for each observed source in a given survey .",
    "in essence , the 5 astrometric parameters for every observed source are ` adjusted ' simultaneously in a large least squares solution .",
    "the advantage of this block adjustment method is that the observations are tied together into a more - or - less rigid block . in this case",
    "relatively few reference objects can be used to align the block of observations to a reference system and calculate absolute positions .",
    "this approach is clean and rigorous but can be a much more complicated solution computationally ( even prohibitively so for extremely large surveys ) .",
    "in addition , the inputted data have very specific requirements . for instance",
    ", a thorough cleaning of the data has to be done before setting up the block adjustment equations .",
    "introducing bad data to the solution can result in a null - result ; the bad data being difficult to track after the fact .    the first rigorous implementation of block adjustment was developed by @xcite .",
    "the technique was developed further by several other authors @xcite .",
    "these methods use a first order expansion to calculate small shifts from an initial assumed solution . a different method that calculates sky positions",
    "directly was proposed by @xcite , but it does not provide proper motion and parallax . simulations or solutions for a limited amount of data have been performed in the past @xcite and the results were promising . however , this work is the first attempt to use the block adjustment technique to derive an astrometric solution for a large catalog .    for convenience we will use the terms ` frame ' and",
    "` plate ' interchangeably for the full array ( mosaic ) of ps1 ccds .",
    "we use the term ` observation ' to describe the individual data taken for one star on one plate .",
    "for example we can say that one frame has 200 stars on it and that one star has 40 observations ( appears on 40 frames ) .",
    "additionally , we will call our reference catalog the ` quasars catalog ' even if a significant fraction of the reference objects are actually active galactic nuclei ( agn ) and not technically ` quasars ' . because we are using astrometric positions obtained by very long baseline interferometry measured directly on the icrf2 , the quasar positions have accuracies of less than one mas",
    "; for purposes of our analysis , we thus assume the reference position error for these objects to be negligible .",
    "we also assume they have no proper motion or parallax since their distances are so large compared with the stars we are most interested in . finally , `",
    "grid stars ' are the stars to which the block adjustment is being applied .    in section 2",
    "we describe the data filtering , the grid and the quasar reference catalogs . in section 3",
    "we present details of our ba algorithm and the results of simulations . in section 4",
    "we present the results obtained with the ps1 data and validations . finally in section 5",
    "we summarize the analysis and results .",
    "the block adjustment method requires that the input data meet certain density , uniformity and stability requirements .",
    "we provide a brief overview of these requirements in the subsequent paragraphs , but provide many more details on the grid star and quasar catalogs used for this analysis in the following subsections .    for grid stars ,",
    "the first requirement is that the density of the stars be high enough on each plate that the field is solvable for the plate model chosen .",
    "the grid catalog must also be as uniform as possible over the sky .",
    "the actual observations of the grid stars have similar requirements , both in number and uniformity and both in space and time .",
    "these requirements can be quantified by the number of observations per star ( overlap factor ) and by the time span for each star .",
    "if the overlap factor or the time span are too small , the plates will not be rigid enough for a solution and the system will be ill - conditioned .    globally , the catalog of quasars has similar requirements .",
    "first , the link between the vlbi positions and the icrf2 must be much better than the actual measurement error .",
    "this is straightforward if the quasar is an icrf2 source , but for non - icrf2 sources the link can be more challenging .",
    "second , a sufficiently high density of quasars in the observed @xmath11 of the sky must be available to enable astrometric fov calibration in the least - squares adjustment .",
    "third , the catalog must include a rather uniform distribution of reference sources on the sky to prevent local correlated error build@xmath6up .",
    "finally , optical counterparts should be in the magnitude range suitable for pan - starrs  .",
    "the icrf2 catalog for example , is not suitable by itself , because it does not meet all of these conditions ( e.g. it is not dense enough ) . on the other hand ,",
    "if the grid star density is high , then the frames are tied together in a relatively rigid system .",
    "this provides some latitude with quasar density , since the quasar density can then be much smaller compared to the grid stars .",
    "however the density of the grid stars ultimately limits the rigidity of the system and the plate model .",
    "therefore , having a relatively high number of quasars distributed uniformly is crucial for a global solution .",
    "the ps1 data for the grid star and quasar catalogs described in the following subsections were obtained from the pv2 internal release with preliminary calibration statically tied to 2mass .",
    "we used a cone search of one arcsecond from the catalog position .",
    "the data includes @xmath130 million individual observations covering 3@xmath4 of the sky over 5 years with an average overlap factor of 38 .",
    "we also obtained metadata which includes pointing , timing and filter information . the overlap and time span distribution on the 3@xmath4 sky",
    "is shown in figure  [ overtime ] .",
    "the data includes both ` chip ' coordinates ( on each individual ccd ) and ` mosaic ' coordinates ( coordinates calculated with respect to the focal plane , or `` frame '' ; see section 1 for definitions ) .",
    "it also includes sky coordinates for each observation from the preliminary 2mass - tied calibration .",
    "the global solution is a memory - intensive calculation .",
    "the matrix solver , and the number of unknowns that can be solved ( i.e. the star parameters ) are limited by the amount of computer memory available .",
    "we therefore created a grid catalog of 750,000 stars based on the ucac4 catalog @xcite , which does not go as deep as pan - starrs but has enough stars to meet the density and uniformity requirements described above .",
    "we used healpix @xcite to partition the sky in small parts of equal area ( @xmath1  0.8 square degrees for nside=64 ) .",
    "we also made a magnitude cut to the ucac4 catalog , requiring all stars be fainter than 15.5 magnitudes .",
    "we then used an algorithm based on voronoi tesselation to assure uniform sampling of stars in each small partition . in this process",
    ", a voronoi cell is constructed around each star by straight lines equidistant between each pair of neighboring stars and perpendicular to the line that connects them .",
    "the area of this cell is larger if the star is far from its neighbors . to obtain the optimal distribution ,",
    "the stars within the smallest voronoi areas are removed iteratively until a fixed number of stars in each of the small healpix regions are obtained .",
    "one example is shown in figure  [ voronoi ] .",
    "on the left we show the original population of ucac4 stars on one of the healpix regions with the voronoi partitioning while the right image shows the final , uniform selection of our grid stars .",
    "the voronoi partitions are now almost equal in size , which indicates that the star distribution is uniform .",
    "the resultant grid star catalog has an average density of 24 stars per square degree for the region observed by ps1 .",
    "finally we note that once we solve for the grid stars , they can be used as reference stars to obtain a relative solution for the rest of the stars in the ps1 data .",
    "to develop our quasar catalog , we used the ocars ( _ optical characteristics of astrometric radio sources _ ) catalog @xcite .",
    "the ocars catalog is a carefully maintained compilation of extragalactic radio sources with accurate vlbi positions , cross - matched in the optical and nir passbands . at the time of our grid catalog preparation , ocars included 9027 separate sources , now it counts 9392 separate entries .",
    "most of the new additions are coming from the steadily growing radio fundamental catalog ( rfc ) .",
    "in addition to accurate vlbi positions on icrf2 , ocars includes redshifts @xmath12 , when available , morphological classification , photometric data on optical counterparts in an annex , and a useful cross - identification table . with a circular search area of @xmath13",
    ", we find 5034 rfc sources detected at least 10 times by ps1 .",
    "this implies a 74% rate of optical identification for vlbi@xmath6observed radio sources .",
    "the cross@xmath6matched objects represent the preliminary basis of our reference sample .",
    "optical counterparts of radio sources with accurate vlbi positions should be carefully vetted before they obtain the status of radio - optical reference frame objects ( rorfo ) .",
    "this is especially important for our application , because even a small number of strongly perturbed or mismatching sources can bring about local areas of large position error .",
    "constructing a global ( or nearly global in our case ) astrometric grid from small@xmath6field differential observations is inevitably fraught with poorly conditioned large@xmath6scale correlated errors , which can be viewed as a  red \" spectrum of absolute error realization in terms of orthogonal spherical harmonics @xcite .",
    "the ways of stemming this dangerous build@xmath6up of large@xmath6scale distortions include using a wide basic angle between two fields of view @xcite , as in the hipparcos and gaia missions , a rather wide  field of regard \" with internal regularization , as in the _ space interferometry mission _",
    "@xcite , or , as we do it here , an absolute reference grid of extragalactic sources @xcite . having resolved the problem of large - scale error , we are confronted now by the danger of medium@xmath6 and small - scale perturbations of the solution , which may get out of control on the scales corresponding to the typical separation between the reference objects .",
    "if the observed optical position of one quasars is far from the assumed radio position ( 100  mas or more ) , a large local perturbation occurs and propagates into the global solution , pulling the results for all other stars in the surrounding area .",
    "the density of the reference grid is limited by the number of available cross - matched vlbi sources , which can not be drastically improved in the near future . the quality and",
    "the reliability of the sample becomes most important .",
    "the first step of reference sample cleaning was to visually review a large number of digital images available for the brighter part of the sample and reject any sources that do not look compact , symmetric , and point@xmath6like on the sky .",
    "extended , double and perturbed galaxies with dust structures are especially common among the brighter vlbi counterparts .",
    "for example , 23 of the rfc sources have pan - starrs  counterparts with @xmath14 magnitudes brighter than 13 ; 21 of these objects were rejected as rorfo . in the next magnitude interval ,",
    "@xmath15 $ ] , 8 out of 16 objects were filtered out .",
    "the rate of obviously unsuitable sources further drops to 35% for @xmath16 $ ] , 20% for @xmath17 $ ] , and 11% for @xmath18 $ ] .",
    "the main reason for this tendency is the fact that the optically brighter host galaxies of agns are nearby , and therefore better resolved in the available images of a limited seeing .",
    "the remaining sources are considered candidate reference objects , but the distribution of the ps1@xmath6vlbi position offsets reveal the presence of a large number of possible mismatches and problem cases . at the preparatory stage of our astrometric solution , we made use of preliminary positions for our grid objects ( see the begining of this section ) computed by the pipeline at ifa .",
    "the original intention was to filter the most obvious ps1@xmath6vlbi mismatches and to investigate the possible reasons .",
    "the procedure turned out to be more complicated than what had been expected , and additional data processing methods had to be engaged .",
    "the preliminary positions suffered from considerable large - scale sky - correlated errors , which can be best represented by a set of nearly - orthogonal , low - order vector spherical harmonics @xcite .",
    "these large zonal errors are probably related to the uncorrected proper motions from the 2mass reference catalog , as explained in the introduction",
    ".    a spherical harmonic fit to 7th degree on the 4979 vlbi sources from the rfc remaining after the discarded objects elimination ( table [ rej.tab ] ) , revealed a statistically significant vector field dominated by a few low - order dipole harmonics .",
    "the magnitude of the sky - correlated error reached @xmath19 mas in some parts of the ps1 sky .",
    "we remove the sky - correlated perturbation using 96 vector spherical harmonic functions and analyze the post - fit residuals .",
    "the median magnitude of the fitted error is 55  mas , which is an estimate for the ps1 errors if the large biases described in the introduction are removed .",
    "[ std.fig ] , left shows the standard deviation of the offsets binned by the observed r@xmath3 magnitude for the 4979 extragalactic sources .",
    "the residual rms scatter is flat for magnitudes between 16 and 19 at approximately 90 mas , which we consider to be the initial error of positions before our global solution .",
    "the standard deviation begins to turn up for objects fainter than @xmath20 and rapidly rises at @xmath21 mag .",
    "photon - limited astrometric precision is characterized by an exponential rise of random error with magnitude ; here the poisson shot noise becomes visible only at the faint end of the range",
    ". therefore , for the majority of the reference objects , the sources of error are other than photon statistics .",
    "a small rise of offsets seems to be present also for the brightest objects , @xmath22 mag .",
    "this may be interpreted as a higher rate of resolved , extended objects at brighter magnitudes .",
    "generally , the agns in nearby galaxies can be expected to be brighter .",
    "we should see a similar build - up of random offset for objects with smaller redshift . on the other hand , as was speculated in @xcite based on the empirical  fundamental plane \" relations found by @xcite , the qso observed at higher @xmath12 should have higher nucleus to host brightness ratios , and thus , statistically smaller radio - optical position offsets .",
    "[ std.fig ] , right confirms this , as the nearer vlbi sources at @xmath23 have larger radio - optical offsets than the objects at higher redshifts .",
    "ideally , we would like to use only objects with redshifts @xmath24 , but this depletes the number of available reference objects below the critical value .",
    "note a curious difference between the average level of standard deviations in fig .",
    "[ std.fig ] , on the right it is smaller than 80  mas .",
    "only some of the ocars sources have their @xmath12 determined and listed , and those tend to be less offset with respect to the vlbi positions .",
    "@xcite empirically detected an increased scatter in the radio - optical position differences for a sample of brighter qsos above the expected random error level and suggested that _ all _ optical counterparts are astrometrically perturbed at the level of 10  mas .",
    "the astrometric accuracy of the ps1 data does not allow us to test this surmise , but we find a significant number of large offsets , extending up to 1 arcsec ( limited by our search radius ) , even after the visual culling described in  [ rorfo.sec ] .",
    "are these differences real , or just evidence of a strongly non - gaussian distribution of random error in ps1 ?",
    "first , using the morphological classification of optical counterparts in ocars , we can compare the typical scatter of offsets for different types of objects .",
    "[ hist.fig ] represents the median magnitude of offsets for the major types : quasars , galaxies , seyferts , and bl lac - type objects based on preliminary ps1 data and the usno robotic astrometric telescope ( urat)-1 catalog @xcite .",
    "quasar and bl lac counterparts provide more consistent optical positions than seyferts and especially , galaxies .",
    "the reason for this segregation is fairly obvious : optically bright host galaxies are often asymmetric in shape due to merger events , duplicity , or prominent dust structures .",
    "for example , the galaxy ngc 5675 has a compact radio - loud agn @xcite , which is an icrf source j143239.8 + 361807 , but the available hst wfpc images reveal a large inclined galaxy with a powerful dust lane . since the dust structure is tilted with respect to the line of sight , the obscuration on the two sides of the image is asymmetric . as a result ,",
    "the ps1 detections are shifted by almost 400 mas at position angle @xmath25 , which is very close to the axis of the dust lane .",
    "this galaxy is well resolved because it is nearby , whereas a more distant analog would look small and fairly compact in the optical images , still producing a measurable astrometric displacement .",
    "another interesting example is the high - quality vlbi source vcs3 j2137 + 3455 @xcite , whose ps1 detections are strongly perturbed and lined up in almost exactly north - south direction , extending to 1 arcsec off the vlbi position .",
    "the digital pan - starrs  image ( fig . [ double ] ) reveals a double galaxy with two components of nearly equal brightness separated by @xmath26 .",
    "the double galaxy is seen as the two brighter sources at the center of the image ( the third fainter source is an unrelated foreground star ) .",
    "the radio - loud source corresponds to the northern component . at a much smaller scale on the radio images ,",
    "the source was identified as a compact symmetric object ( cso , * ? ? ?",
    "second , we can verify the large offsets of preliminary ps1 positions using the urat catalog for brighter northern objects , which is a completely independent astrometric catalog of comparable or superior accuracy .",
    "[ ps1vsurat.fig ] shows a clear correlation between the ps1@xmath6vlbi and urat@xmath6vlbi offsets for common objects with ps1@xmath6vlbi offsets greater than 200 mas .",
    "the majority of such large offsets is real and physical . in some cases",
    ", we could trace the cause of the large offset using available high - resolution images , pan - starrs  images , multi - band epoch photometry , and the distribution of astrometric detections .",
    "the most frequent causes are 1 ) asymmetries in the resolved host galaxies ; 2 ) double sources and image blending , including double galaxies , mergers and optical stellar companions ; 3 ) microlensed systems .",
    "the object pks b2114 + 022 is an example of the latter category , being a compact bona fide vlbi source , for which the available hst nicmos images show two compact galaxies beside the radio position , possibly related to the microlensing but not to the agn .",
    "the optical counterpart of the radio core is not visible at all in this case .",
    "based on results in  [ origin ] , we decided to keep only sources classified as ` bl lac ' and ` quasars ' .",
    "this removes 2670 objects classified as ` radio sources ' mostly located in the galactic plane and 1327 ` galaxies ' . as shown above in ",
    "[ offsets ] , many of these sources have large offets from the radio positions due to asymmetric shapes .",
    "we remove the sources with large offsets based on urat (  [ origin ] ) .",
    "a total of 57 sources were removed based on visual inspection and urat comparison .",
    "the removal of all these sources produced big gaps along the galactic plane . in order to mitigate this problem",
    "we re - inserted sources with redshift larger than 0.1 in ocars , the reasoning being that galaxies at large distances have a smaller angular size and therefore the offests between the radio and optical are likely to be smaller .",
    "their positional accuracy is probably not as good as the other sources but they provide important constraints close to the galactic plane , without which a global solution would not be possible .",
    "the final quasars catalog is shown in figure  [ ocars ] and contains 3076 sources .      as discussed at the beginning of this section ,",
    "the gas method has certain requirements for well - behaved data in terms of density , uniformity and stability .",
    "therefore a rigorous filtering is necessary to remove data which could yield an ill - conditioned system .",
    "if the solution fails after the input data are choosen it is very hard to trace these ` bad data ' after the solution has failed .",
    "therefore the filtering has to be as rigorous as possible before performing the global solution .",
    "several types of filtering were performed , including removal of binaries , positional outliers and objects with insufficient observations .",
    "we describe the filtering procedures in detail below .",
    "first we removed duplicate detections produced by the 1 arcsec cone search ( see the beginning of this section ) . some of these duplicates are probably binaries and we attempted to remove binaries to avoid the astrometric complications associated with these sources for the initial solution .",
    "next we removed positional outliers , which are those sources that do not match the sky positions provided with the ps1 data ( based on 2mass ) .",
    "in other words , most observations are located in a cluster with more or less random positional errors but a few observations are ` positional outliers ' .",
    "these outliers are likely caused by source confusion or some unknown error in the ps1 reduction pipeline . to remove positional outliers we used an algorithm based on a gaussian kernel density with automatic bandwidth determination to remove observations outside a two - dimensional probability density of 2  @xmath27  10@xmath28 .",
    "we note that such filtering has the potential to affect proper motion results , but this was not the case here according to our tests ( see the next section ) .",
    "one example of the outlier filtering is shown in figure  [ outliers ] .    in order to obtain a system of equations that are well - conditioned we require that each frame contain at least 20 stars , and that each star be observed at least 10 times .",
    "it is also important that the stars are distributed uniformly on the plate , so in addition we require that each quadrant of each frame contains at least 5 stars .",
    "it is still possible that the stars are concentrated around the center of the frame but this probability is low given the method we used to construct a uniform grid catalog ( see  [ gridcat ] ) .",
    "we chose this simple requirement for speed ; otherwise a more complicated algorithm would have been required . in order to constrain the proper motion",
    "we also impose a time span limit of at least 1.5 years of observation for each star .",
    "the filtering process has to be done iteratively .",
    "for example if a star is removed because it only has 9 observations or because the time span is only one year , then we have to go back and count the stars again on all the frames where the star was observed .",
    "similarly , if one frame is removed because it has only 15 stars then for each of these stars we have to count again the number of observations and calculate the time span .",
    "the imposed conditions for this filtering process are adjusted based on the quality of the data , such as the overlap factor and the time span ( see figure  [ overtime ] ) .",
    "the conditions must be chosen so that the iterative process converges and that no gaps in the data are introduced .",
    "the equations that relate the sky coordinates of a star and its position on the detector ( x , y ) are not linear . the eichhorn approach ( see the introduction and references therein ) is to linearize the equations in a taylor expansion , keeping only first order terms . in so doing , * small shifts from the assumed values of the unknowns * are calculated .",
    "we assume that the zero values are known to a reasonable accuracy ( better than 1 arcsec ) so that only one step is required to calculate the shifts . in this approach , the equations coefficients are the jacobian of the detector positions with respect to the unknowns .",
    "we present the exact details of this approach in appendix a.    once the coefficients are calculated for each star and each frame , they are assembled into a so - called ` design matrix ' which has billions of nonzero elements . solving such a matrix is challenging for even the best available matrix solvers running on extremely powerful computers .",
    "it is typically useful to eliminate one set of parameters to facilitate the solution .",
    "there are two different ways to accomplish this : via qr elimination and/or via block elimination . in our code",
    "we use the qr factorization to eliminate the plate parameters plate by plate @xcite .",
    "the block elimination method removes the star parameters after the design matrix has been constructed , using matrix operations and exploiting the shape of the design matrix @xcite . in appendices b and",
    "c we present the two elimination methods in detail .    after removing the plate parameters the matrix is normalized and then solved with the mkl ( math kernel library ) pardiso ( parallel direct sparse solver interface ) solver @xcite .",
    "this is a very robust and fast multiprocessing parallel direct sparse solver .",
    "it supports out - of - core ( ooc ) option to store the matrix on disk instead of memory .",
    "this allows larger matrices to be solved , though at the expense of processing speed .",
    "all the code was run on a blade server with two intel xeon x7560 8-core processors having hyper - threading and 512  gb of memory .",
    "the blade allows 32 processes to run concurrently .",
    "our gas code is python - based and uses numpy for high efficiency and speed .",
    "most of the code modules are run in parallel , including the qr elimination .",
    "the data are split beforehand using healpix with an ` nside ' parameter of 8 .",
    "this is useful for parallelism and to speed up simulations ( see the next section ) .",
    "the first part of the code is sequential : the data and metadata are read for each frame and converted to a format required by the ba equations .",
    "these are stored as memory maps which are later read by separate running processes to construct the design matrix . in this initial step",
    "we also create data structures for the grid stars and quasars and for the frames .",
    "additionally we perform the filtering as described in  [ filters ] . as mentioned previously , some filters ( for binaries , outliers , etc . )",
    "are performed in one step .",
    "the filters required for a well - conditioned system ( removing stars with few observations and frames with few stars ) are then run iteratively until all the ` bad data ' are removed .",
    "it usually takes only a few steps for all filters to converge and eliminate all the bad data .",
    "if the convergence is slow the adjustment parameters can be tightened , but care must be taken that no field gaps are introduced by removing too much data",
    ".    now the data are ready for parallel ba .",
    "each process reads its assigned data memory maps , calculates the equation coefficients frame by frame , performs the qr elimination and constructs the design matrix . to save memory each process splits the design matrix into a number of slices which are later combined after the small matrices are normalized .",
    "finally the normalized matrix is solved with pardiso and the solution ( the adjustments to the star parameters ) is converted to sky positions and proper motions .",
    "our gas code includes a simulator , which can create realistic simulated data .",
    "it can simulate star catalogs and metadata ( such as pointing , time stamp , orientation on sky ) .",
    "observations are simulated by projecting the stars on the focal plane , given the instrument properties ( telescope , camera , observing strategy ) .",
    "it can simulate measurement errors and field distortions on each frame .",
    "the simulator is very useful for debugging and testing purposes because actual data can be compared with simulated inputs .",
    "it also provides useful information about filtering ` bad data ' , and provides a good estimate for the random and systematic errors we can expect .    in order to make the simulations as accurate as possible",
    "we based the simulated data on the actual ps1 metadata , quasars and grid catalogs ( ucac4 positions and proper motions ) .",
    "this ensures that we include any systematic errors , such as those caused by a non - uniformity of the stars on the sky , or by the observation strategy ( overlap factor or time span ) .",
    "in fact the only difference from the real data are the measurement errors , possible plate distortions and other unknown systematic effects in the real data .",
    "the stars in our grid catalog are relatively bright ( ucac4 magnitudes in the narrow range 15.5 - 16.0 ) .",
    "random errors with single measurement of 50  mas or better for the over - sampled psf ( 1.1 arcsec fwhm ) of ps1 are expected for the ps1 data @xcite .",
    "therefore we added random errors with a standard deviation of 50  mas to all the simulated measurements as well .",
    "given such large expected measurements errors compared to the average parallax ( few mas ) , we can solve for positions and proper motions ( @xmath7 , @xmath8 , @xmath9 , @xmath10 ) but not for parallaxes .",
    "the attitude parameters for the observations and the calibration parameters ( such as scale ) , are treated as nuisance parameters and eliminated ( see the beginning of this section and the appendix ) .",
    "the simulation results indicate that the errors should be @xmath110  mas for position and @xmath19  mas yr@xmath29 for proper motion in each direction .",
    "we discuss these results in more detail in section 4 below .",
    "the ps1 ccds are not absolutely fixed with respect to the focal plane array ( fpa ) and their position can shift slightly . therefore ideally we would use the chip coordinates for this analysis so that we do not introduce errors related to the chip positions , which in principle could be significant .",
    "unfortunately this would require a very large number of grid stars ( 2.3 million for a minimum of 10 stars per chip ) , which in turn requires a huge increase in computing capacity ( memory ) .",
    "we therefore used the mosaic coordinates to set up the equations .",
    "we emphasize that using mosaic coordinates instead of ccd coordinates can introduce potentially large errors related to the chip movement and other systematic effects as we will see later .",
    "our definition of a frame is the full fpa , and the average number of stars per frame is then @xmath1  190 .",
    "first we filter the data as explained in section [ filters ] .",
    "we use a simple first order plate model with only 6 parameters ( see appendix a for a description of the model ) .",
    "we use the ucac4 positions as starting positions for convenience ( any starting positions which are close enough for our first order approximation can be used ) .",
    "this choice was preferred over using average ps1 starting positions because it provides better validation methods as we will see below .",
    "our solution calculates shifts from these starting positions . to get sky positions at the epoch 2012.6 ( median epoch for the ps1 data )",
    "the calculated shifts are added to the ucac4 positions .",
    "simultaneously we calculate absolute proper motions ( the assumed initial values are in this case zero ) .",
    "the plate parameters are eliminated as explained at the beginning of section  3 .",
    "validating the solution and estimating errors for real data is more complicated than when using simulated data .",
    "it requires the inversion of the design matrix , which is much harder to achieve computationally than a least square solution .",
    "the mkl pardiso solver does not have such capabilities .",
    "other options can be used to validate our solution and these are explored next .",
    "quasars provide a good method to estimate absolute errors in star catalogs ( e.g. * ? ? ?",
    "however the quasars are used in gas function as hard constraints ( we do not solve for them ) and therefore these can not be used to estimate absolute errors . however",
    ", one method of validation is to remove a small fraction of the quasars in the quasar catalog ( 758 , a quarter of the total ) and incorporate these into the grid catalog @xmath6 thereby allowing us to solve for this quasar subset as though they were grid stars . these so called ` validation ' quasars",
    "were chosen randomly over the sky except in the galactic plane where quasars are already inadequate . using a smaller number of quasars in our solution ( 3/4 of the total ) may overestimate the errors since the solution has fewer hard constraints , but this methodology provides a good upper limit .",
    "we ran the solution with this reduced quasar catalog and solved for the ` validation ' quasars along with the grid stars .",
    "we show the histograms of the position residuals in figure  [ gsimshift ] .",
    "we estimate both systematic errors ( mean and error of the mean ) , and random errors ( standard deviation and we also show the normal quantiles in parentheses ) : the systematic errors are -0.75@xmath302.25  mas for ra and 3.04@xmath302.17  mas for dec , while the random errors are 62.1  mas ( -56.0 , 57.2 ) for ra and 59.8  mas ( -60.3 , 57.1 ) for dec . in all the validation measurements that follow",
    "we calculate the errors in the same format .",
    "the normal quantiles are equal to the standard deviation if the distribution is normal , and therefore provides aditional information about the error distribution . while the systematic errors are not significant , the random errors are almost six times larger than expected from simulations ( see  [ sim ] ) .",
    "we compared these results with the original sky position results in the ps1 pipeline . in this case , we use all the quasars in the catalog to calculate offsets from the catalog positions . in figure  [ ocarsshift ]",
    "we show histograms for the positional offsets in the original ps1 pipeline solution .",
    "the systematic errors are : 15.3@xmath301.36  mas for ra and 56.8@xmath301.05  mas in dec .",
    "the random errors are 75.3  mas ( -61.2 , 90.1 ) for ra and 58.3  mas ( 0.9 , 114.3 ) in dec .",
    "there is a significant systematic shift in ra and a very large shift in dec , which was explained in the introduction and  [ icrfcat ] as systematic offsets inherited from 2mass . in those sections we investigated both the systematic and random offsets between the ps1 position and the radio position of the quasars in our catalog",
    "( see also fig .",
    "[ hist.fig ] ) .",
    "we have used different methods to filter out the objects which do not qualify as rorfo .",
    "however large offsets still exist both in the original ps1 positions and in our solution .",
    "these results suggest that our solution removes the systematic errors correctly but does not improve significantly the coordinates on small scales . for comparison , in figure  [ 758pos ]",
    "we show the position shifts on the sky for the subsample for 758 ` validation ' quasars , for our solution ( left ) and the original ps1 solution ( right ) .",
    "the large - scale zonal errors are clearly seen on the right plot .      to further investigate why the positional errors are so large we compare our results with the urat1 catalog @xcite .",
    "urat1 covers almost the same amount of sky as ps1 ( north of -15 deg , the southern hemisphere observations started in the late 2015 ) and the data are practically simultaneous with ps1 and therefore not affected by errors in proper motion .",
    "the position errors of urat1 are 10 - 20 mas and are therefore sufficiently accurate to test our ps1 results .",
    "we cross - match the grid catalog with urat using a 1@xmath31 cone search , and we obtain matches for 82% of the stars .",
    "first we compare the original ps1 pipeline solution ( median of the original sky positions in the ps1 data ) with the urat1 positions .",
    "the differences are plotted in figure  [ ps1-urat ] .",
    "we notice large zonal differences in both plots : 16.1@xmath300.10  mas in right ascension and 58.2@xmath300.08  mas in declination .",
    "the random errors are 76.0  mas ( -51.3 , 84.2 ) in right ascension , and 64.4  mas ( -0.2 , 116.0 ) in declination .",
    "we note that these values are very similar to the offsets found above using the validation quasars @xmath6 confirming again that the systematic errors in ps1 are real .",
    "next we compare our results with urat1 , the offsets are 4.1@xmath300.08  mas and 1.0@xmath300.08  mas ( see figure  [ gsim - urat ] ) .",
    "the random errors are 64.3  mas ( -55.1 , 63.0 ) and 62.7  mas ( -56.2 , 58.4 ) . just as we found before , the large systematic offsets ( zonal errors )",
    "are now gone , but the small - scale errors did not improve significantly from the original positions in the ps1 data .",
    "figure  [ gsim - ps1 ] shows the differences between our solution and the original ps1 pipeline positions . by comparing these plots further with figure  [ ps1-urat ]",
    "we see that our algorithm successfully corrects for the large - scale zonal errors but it does not improve the ps1 solution much at smaller scales .      in figure  [ tile ] right ,",
    "we show the same offsets as in figure  [ ps1-urat ] , ( the offsets between urat positions and the median positions in the original ps1 data ) for a small region on the sky .",
    "this time we plot the absolute differences with arrows and we also show color coded contours .",
    "we clearly see the large scale systematic offsets ; the arrows have a general direction to the left - upper corner .",
    "however , there are also significant small - scale patterns , shown by the colored contours ; these are at scales of a fraction of a degree .",
    "four individual frames are shown in the left panel and their sky positions are shown in the right panel .",
    "we notice that the patterns of individual frames on the left match the patterns seen on the sky on the right .",
    "this can only happen if this small - scale pattern exists in the entire ps1 data set .",
    "if the small scale errors were caused by distortions , or other frame - related errors ( such as small shifts of the individual chips ) we would expect each frame to have different error patterns . while the large zonal errors were explained by the lack of proper motion correction , the small scale errors can not have the same explanation .",
    "all these comparisons suggest that sky correlated errors in the ps1 data exist on both large and small scales .",
    "while the former are removed by our method , the latter are not .",
    "this implies that the small - scale errors are also present in the mosaic coordinates used for the analysis .",
    "we tested this hypothesis by comparing the mosaic coordinates with the sky coordinates from a single frame .",
    "we found that they are related by a simple projection using a first order plate model .",
    "after correction , the differences between these coordinates are usually a fraction of a mas ( see figure  [ frame ] ) . in other words",
    ", we believe the sky - correlated errors in the ps1 data propagate into our solution through the mosaic coordinates and strongly reduce our ability to improve the astrometry at smaller scales .      to validate the proper motions we are using the same methods we used for positions , namely comparisons with the subsample of 758 quasars and then with the 82% of the stars that are common with urat1 .",
    "we remind our reader that our data do not include high proper motion stars ( @xmath32 100 mas  yr@xmath29 ) .",
    "this is because we used a cone search radius of 1 arcsec from the ucac4 position to get ps1 data , and the time difference between ucac4 and ps1 observations is @xmath110 years .",
    "the quasars have zero proper motion so the offsets we calculate for them represent the errors in our solution .",
    "we obtain much better results compared to position ( see figure  [ gsimpm ] ) .",
    "the systematic errors are 0.55@xmath300.49  mas  yr@xmath29 in ra and -0.07@xmath300.41  mas  yr@xmath29 in dec .",
    "the random errors are 13.6 mas  yr@xmath29 ( -9.5 , 10.4 ) in ra and 11.3  mas  yr@xmath29 ( -9.0 , 9.7 ) in dec .",
    "these values are consistent with what we expected from simulations . in figure  [ 758pm ]",
    "we show the distribution of these errors on the sky .",
    "there are no large - scale zonal errors .    in figure  [ gsim - urat - pm ]",
    "we show the comparison with urat1 proper motions .",
    "the systematic differences are 1.2@xmath300.014  mas  yr@xmath29 for ra and 1.1@xmath300.016  mas  yr@xmath29 ( -10.0 , 12.1 ) for dec .",
    "the random errors are 11.1 mas  yr@xmath29 ( -8.0 , 10.3 ) for ra and 12.7 mas  yr@xmath29 ( -10.0 , 12.1 ) for dec",
    ". these errors are consistent with those obtained using the quasars and also with the simulations .",
    "the large - scale sky correlated errors we found in the mosaic coordinates did not affect the proper motions .",
    "there are however some sky areas in figure  [ gsim - urat - pm ] which show larger errors , in particular on the right side and especially close to the galactic plane .",
    "they seem to be correlated with areas with poor time coverage ( see figure  [ overtime ] , right ) and low density of quasars ( figure  [ ocars ] ) , and are probably caused by weak constraints in specific sky areas .",
    "we presented a rigorous method for calculating absolute astrometry for full sky ( or large coverage ) missions .",
    "the gas approach provides absolute astrometry because it does not rely on previous measurements . instead",
    ", the solution is tied directly to a relatively small number of qsos or distant agns and the solution is solved simultaneously for all the grid stars in a very large , least - squares solution .",
    "however , ba is computationally intensive and requires a very careful filtering of the data both for the reference sources and the grid stars .",
    "we applied this method to ps1 data , which covers 3@xmath4 of the northern sky and relies on the 2mass catalog for astrometry .",
    "we created a reference sample of 3076 qsos and agns based on the ocars catalog , and a grid catalog of 750,000 stars based on the ucac4 catalog .",
    "both were carefully selected to obtain uniform coverage on the sky . in particular for",
    "the reference stars a strict selection process was applied to ensure a sample of rorfo with high accuracy optical positions based on vlbi radio positions .",
    "when available we used images to investigate large offsets observed between the optical and radio positions , especially for brighter optical sources .",
    "these are most likely real offsets , and include extended , double and perturbed galaxies .",
    "we used the urat1 catalog to remove an additional number of rorfo candidates with large radio - optical offsets in both ps1 and urat1 .",
    "we applied several filters to remove data which can introduce systematic errors or produce an ill - conditioned system . in our solution",
    "we used the so - called mosaic coordinates which are reconstructed from the individual chip coordinates .",
    "we validate our results using simulations , quasars , and the urat1 catalog .",
    "we show that the systematic errors in the original ps1 astrometric solution ( mainly caused by using the 2mass catalog as reference ) are easily removed using our approach . however , the absolute positional errors are of the order of 60  mas , almost 6 times larger than expected from simulations , while the proper motion errors are consistent with the simulations ( @xmath110 mas yr@xmath29 ) .",
    "a comparison with the urat1 catalog reveals that there are systematic errors on the sky in the mosaic coordinates on small scales ( a fraction of the full detector ) .",
    "such errors can not be corrected using the gas method and must be removed through calibration .",
    "the proper motion solution is not affected by these errors and shows a good correlation with the urat1 solution .",
    "_ gaia _ mission will soon provide high accuracy positions for aproximately one billion stars .",
    "these can be used to perform relative astrometry and correct both the large and small - scale errors in ps1 data .",
    "since ps1 goes deeper than _ gaia _ by at least a magnitude this could be of interest in cases when fainter objects are observed or higher density of sources is required .",
    "the first release of _ gaia _ will only contain limited proper motions @xcite and therefore using _ gaia _ stars as reference might introduce some zonal errors similar to the existing biases described in the introduction ( the average epoch difference between _ gaia _ and ps1 is about 4 years ) .",
    "however these can be corrected using the proper motions we calculated .",
    "we thank the anonymous referee for carefully reading the manuscript .",
    "we also acknowledge help with the software and ideas from several coworkers not listed as authors . the panstarrs1 surveys ( ps1 )",
    "have been made possible through contributions of the institute for astronomy , the university of hawaii , the panstarrs project office , the maxplanck society and its participating institutes , the max planck institute for astronomy , heidelberg and the max planck institute for extraterrestrial physics , garching , the johns hopkins university , durham university , the university of edinburgh , queen s university belfast , the harvard smithsonian center for astrophysics , the las cumbres observatory global telescope network incorporated , the national central university of taiwan , the space telescope science institute , the national aeronautics and space administration under grant no .",
    "nnx08ar22 g issued through the planetary science division of the nasa science mission directorate , the national science foundation under grant no .",
    "ast1238877 , the university of maryland , and eotvos lorand university ( elte ) and the los alamos national laboratory .",
    "general eichhorn equations are linearized by taking the first order derivatives of a taylor expansion and calculating the jacobian coefficients . for each star",
    "the observed minus calculated positions on a frame are written in terms of the sky coordinate ( @xmath7 , @xmath8 , @xmath9 , @xmath10 , @xmath4 ) shifts and plate coordinate ( a , b , c , etc ) shifts :    @xmath33    where f@xmath34 and f@xmath35 are the parallax factors .",
    "the jacobians are calculated at the assumed zero values of the parameters .",
    "the time difference @xmath36 is calculated between the observation time and the catalog time ( in our case 2012.6 the median epoch for the ps1 data ) .",
    "the normal coordinates ( @xmath37 , @xmath38 in units of the focal length , f@xmath39 ) will be used as intermediate between the sky and plate coordinates .",
    "they are also called tangential coordinates because they represent coordinates in the tangential plane of the gnomonic projection .",
    "the normal coordinates do not enter the equations except as auxiliary parameters .",
    "they also help define the plate model and calibration parameters .",
    "the most general * first order * plate model has six parameters :    @xmath40    the 4-parameters model includes shifts ( a and b ) , rotation angle ( c ) and the scale ( d ) :    @xmath41    if the scale is constant at the nominal value of the focal length ( f@xmath39 ) :    @xmath42    let s calculate the coefficients for these simple 3 and 4-parameter models .",
    "the eichhorn method calculates small shifts from the assumed values ( @xmath43 ) . for each star",
    "we should have a reasonable estimate for the sky position , and the same for the plate positions . using these",
    ", we calculate first the assumed normal coordinates , @xmath44 , @xmath45 using the gnomonic projection ( equation ) .",
    "then we use the plate model and the assumed plate parameters ( @xmath46 ) to calculate the assumed position on the plate , x@xmath47 , y@xmath47 .",
    "the first jacobian coefficients can be calculated in two steps :    @xmath48    the first part has a simple form depending on the plate model , which in our simple case is just the rotation matrix ( for both 3 and 4-parameters models ) :    @xmath49    the second part is not so simple , since the normal coordinates are given by :    @xmath50    where @xmath51 and @xmath52 are the plate coordinates ( center ) , not the assumed star coordinates",
    "! we will not calculate the factors here , but they are straightforward .    finally , the last jacobian coefficient in the equation is ( for the 3-parameter model ) :",
    "@xmath53    in this 3-parameter case this can be written in the simplified form :    @xmath54    for the 4-parameter model we get a similar result :    @xmath55",
    "this section presents the method of @xcite to eliminate plate parameters .",
    "let s assume for simplicity we have the simplest plate model with only 3 parameters ( the attitude parameters ) .",
    "these are eliminated plate by plate .",
    "only then are the small matrices for each plate assembled into a large matrix .",
    "the columns must match for each individual star that falls on different plates .    for a given plate",
    ", the system of equations can be written as :    @xmath56    where x are the star parameters ( 5 per star ) , y the 3 plate parameters , and r the plate residuals . since on a particular plate",
    "each star produces 2 equations , the size of the matrices a and b is very easy to calculate .",
    "if there are n stars on the plate , a is a 2n @xmath27 5n matrix , while b is 2n @xmath27 3 .    to eliminate the 3 plate parameters , their coefficient matrix is factorized : b = qr .",
    "q is a 2n @xmath27 2n orthogonal matrix and r is 2n @xmath27 3 upper - triangular , so that we can also write :    @xmath57    where r@xmath58 is a small 3 @xmath27 3 upper - triangular invertible matrix .    among other applications ,",
    "the qr factorization is used to solve least - square problems . unfortunately , for huge problems such as this",
    ", it is not easy to perform .",
    "however , it can be used on the small plate matrices above to eliminate the plate parameters , following @xcite .",
    "we multiply the equation above with q@xmath59 and at the same time we split the equations so that the bottom 2n-3 equations have only star unknowns :    @xmath60    where a@xmath61 and a@xmath62 are the top 3 rows and bottom 2n-3 rows of q@xmath59a , r@xmath61 and r@xmath62 being similarly defined .",
    "the small matrices a@xmath62 are then assembled into a large sparse matrix containing only the star parameters .",
    "similarly , the collected r@xmath62 arrays form the right hand side of the equation .",
    "if we only solve for position and proper motion the resulting matrix will have approximately 3 million columns and 60 million rows but it will be very sparse .",
    "we actually solve the normalized matrix , which is 3 by 3 million symmetric positive definite , and also has @xmath120 times fewer non - zero elements ( nnz ) .",
    "if computer memory is an issue , the non - normalized matrix can be split into an arbitrary number of parts ( rows - wise ) , each normalized separately and then added together .",
    "this approach is also very easy to parallelize for faster processing ( embarrassingly parallel ) .",
    "once the star matrix is solved , the plate parameters can be recovered using the top equation above , because r@xmath61 are small invertible matrices :    @xmath63    note that the process of elimination uses only orthogonal transformations and therefore the least square problem is not altered in any way .",
    "moreover , this procedure can be used for any number of plate parameters .",
    "this scheme follows @xcite to eliminate the star parameters after the design matrix is generated . as in appendix b",
    ", the system of equations can be simply written as :        we also show how the errors are used to construct weighted equations .",
    "let @xmath65 be the error vector for both star and plate parameters , and g the covariance matrix formed from @xmath66 .",
    "the normal equations are then :                            makarov , v.v .",
    "1997 , in proc .",
    "esa symp .  hipparcos@xmath6venice97 \" , esa sp@xmath6402 , 823 makarov , v.  v. , & milman , m.  2005 , , 117 , 757 makarov , v.v . ,",
    "murphy , d.w .",
    "2007 , , 134 , 367 makarov , v.v . , berghea , c. , boboltz , d. , et al .",
    "2012 , mem .",
    "s.a.it . , 83 , 952 makarov , v.v . ,",
    "dorland , b.n . ,",
    "gaume , r.a . , et al .",
    "2012 , , 144 , 22 malkin z. , titov o. 2008 , optical characteristics of astrometric radio sources . in : _ measuring the future _ , proc .",
    "fifth ivs general meeting , a. finkelstein , d. behrend ( eds . ) , st .",
    "petersburg , 183              schenk , o. , gartner , k.  2004 , j. of future generation computer systems , 20(3 ) , 475 sokolovsky , k.v . ,",
    "kovalev , y.y . ,",
    "pushkarev , a.b . ,",
    "mimica , p , perucho , m. 2011 , , 535 , 24 skrutskie , m.  f. , cutri , r.  m. , stiening , r. , et al .",
    "2006 , , 131 , 1163 stock , j.  1981 , , 6 , 115      tholen , d.  j. , micheli , m. , & elliott , g.  t.  2013 , , 223 , 625 tonry j. , onaka p.  2009 , in ryan s. , ed . , proceedings of the advanced maui optical and space surveillance technologies conference .",
    "the maui economic development board , kihei , hi , p. e40 unwin , s.c . , shao , m. , tanner , a.m. , et al . 2008 , , 120 , 38 york , d.  g. , adelman , j. , anderson , j.  e. , jr . , et al .",
    "2000 , , 120 , 1579 yu , y. , tang , z .- h . , li , j .- l . ,",
    "wang , g .-",
    "l . , & zhao , m.  2004 , , 128 , 911    zacharias , n.  1992 , , 264 , 296 zacharias , n. , finch , c.  t. , girard , t.  m. , et al .",
    "2013 , , 145 , 44 zacharias , n. , zacharias , m.i .",
    "2014 , , 147 , 95 zacharias , n. , finch , c. , subasavage , j. , et al .",
    "2015 , , 150 , 101"
  ],
  "abstract_text": [
    "<S> we describe development and application of a _ global astrometric solution _ ( gas ) to the problem of pan - starrs1 ( ps1 ) astrometry . </S>",
    "<S> current ps1 astrometry is based on differential astrometric measurements using 2mass reference stars , thus ps1 astrometry inherits the errors of the 2mass catalog . </S>",
    "<S> the gas , based on a single , least squares adjustment to approximately 750k `` grid stars '' using over 3000 extragalactic objects as reference objects , avoids this catalog - to - catalog propagation of errors to a great extent . </S>",
    "<S> the gas uses a relatively small number of quasi - stellar objects ( qsos , or distant agn ) with very accurate ( @xmath01 mas ) radio positions , referenced to the icrf2 . </S>",
    "<S> these qsos provide a hard constraint in the global least squares adjustment . </S>",
    "<S> solving such a system provides _ </S>",
    "<S> absolute astrometry _ for all the stars simultaneously . </S>",
    "<S> the concept is much cleaner than conventional astrometry but is not easy to perform for large catalogs . in this paper </S>",
    "<S> we describe our method and its application to pan - starrs1 data . </S>",
    "<S> we show that large - scale systematic errors are easily corrected but our solution residuals for position ( @xmath160  mas ) are still larger than expected based on simulations ( @xmath110  mas ) . </S>",
    "<S> we provide a likely explanation for the reason the small - scale residual errors are not corrected in our solution as would be expected . </S>"
  ]
}