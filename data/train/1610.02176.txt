{
  "article_text": [
    "for studies of formation and evolution of early galaxies , multiplexed observations of several objects need to be carried out at once using integral field spectrographs over a large field - of - view ( fov ) .",
    "the need to correct only a limited number of discrete directions over the field led to the concept of multi - object adaptive optics ( moao ) which uses separate narrow field wavefront correctors for each of several objects . to solve optical issues encountered on both wide fov and large dimension systems ,",
    "the moao concept consists in putting wave - front sensors  ( wfs ) ahead of the deformable mirror  ( dm ) in the optical path .",
    "we adopt thus an _ open - loop configuration _ since there is no feedback between dm and wfs .",
    "such a design has been proposed for eagle  ( @xcite ) , the first multi - object integral field units  ( ifu ) for the european - extremely large telescope  ( e - elt )  ( @xcite ) , with a large fov of 5 to 10 arc - minutes required for science observations  ( @xcite ) .    today , mosaic is considered the new moao - assisted multi - object ifu for the e - elt  ( @xcite ) .",
    "the development of mosaic will include a high - multiplex mode  ( hmm ) , seeing - limited or coarsely - sampled using the ground layer adaptive optics  ( glao ) available on the e - elt using the m4  ( @xcite ) pre - focal adaptive mirror , for observing from 100 to 250 objects .",
    "in addition , it will also include a high - definition mode  ( hdm ) for observing from 10 to 20 faint galaxies with moao - corrected ifus .",
    "the feasibility of designing such a multi - channel instrument has to be demonstrated on - sky mainly for two reasons .",
    "the first relates to the reliability and high - fidelity control of dms in open - loop configuration . whereas the recursive nature of a closed - loop hides potential inaccuracies in the linear relationship between wfs and dm  the interaction matrix  in open - loop the absence of feedback puts to light ever - present deviations , dm creeping , variable gains , hysteresis to cite only a few .",
    "we build on the past experiments which have demonstrated operational open - loop dm control , e.g. volts  @xcite , villages  @xcite , canary  @xcite and raven  @xcite .",
    "the second point relates to prove the reliability of the atmospheric open - loop tomography using both ngss and lgss , blending signals of different nature into a single estimation step .    in order to progress on these topics canary",
    "has been designed by an international consortium , involving the lesia and the durham university starting in 2007 .",
    "the demonstrator was installed in 2010 at the william herschel telescope  ( wht ) at la palma , in the canary islands .",
    "it has provided proof of our capability to handle the open - loop configuration and specify the on - sky performance , either using ngss only  ( @xcite ) , or mixed ngs / lgs  ( @xcite ) .    in sect .",
    "[ s : moao ] we provide the analytic expression of the residual phase in the science directions . with it",
    "we outline an error breakdown of the main residual contributors , as tomography or system bandwidth .",
    "we stress the fact that a successful attempt to reconstructing the psf is a direct consequence of a comprehensive understanding of the ao error budget .    in sect .",
    "[ s : psfr ] , we layout two methods to reconstruct the psf : + _ i ) _ defining the analytic expression of the optical transfer function  ( otf ) , computed from off - science guide - star telemetry .",
    "it relies on the tomographic reconstructor and on calibration matrices  the same that are used during real - time operation  leading us to dub the method _ rtc - based _ psf - r .",
    "ii ) _ a reference method that uses _ truth sensor _  ( ts ) telemetry looking at bright science objects and thus directly measuring the residual phase .",
    "the implementation is very similar to the one proposed by vran  ( @xcite ) , with slight modifications required for moao systems . in normal operational conditions",
    "such sensor wo nt be usable since moao systems will generally observe very faint targets .",
    "several approaches have been proposed to deal with the angular and focal anisoplanatism in lgs ao  ( @xcite ) based either on analytical anisoplanatism transfer functions  ( @xcite ) or , in mcao  ( @xcite ) , using very accurate simulation tools . in the case of canary both lgs and ngs are blended together in the tomography step  a type we call integrated tomography  using an mmse reconstructor calibrated on - sky with the learn  &  apply algorithm  ( @xcite ) .",
    "this yields a somewhat simpler formulation of the residuals in that we do not have to explicitly specify corrective terms for focal , angular or tilt anisoplanatism .",
    "results are shown using over 450 on - sky data sets , acquired in september 2013 .",
    "we report in sect .",
    "[ s : results ] , strehl ratio  ( sr ) and full width at half maximum  ( fwhm ) evaluated on reconstructed psf as function of sky quantities using focal plane data .",
    "we provide a statistical analysis to evaluate biases and variances using the rtc - based and ts - based method .",
    "we conclude in sect .",
    "[ s : conclusions ] .",
    "we now provide the analytic expressions for the tomographically reconstructed on - axis residual phase using off - axis measurements and later the same on - axis residual phase from the truth sensor data .",
    "c l + @xmath1 & atmospheric parallel phase on which the system is acting .",
    "defined by the 36 first zernike modes for canary .",
    "+ & appears in eq .",
    "[ e : eps_para_bi ] .",
    "+ @xmath2 & atmospheric high spatial frequencies not corrected",
    ". appears in eq .",
    "[ e : eps_bi ] .",
    "+ @xmath3 & residual modes of the dm correction .",
    "appears in eqs .",
    "[ e : eps_bi ] ,  [ e : eps_para_bi ]  [ e : sbeta ] ,  [ e : varparabeta_hat ] and  [ e : epspara ] .",
    "+ @xmath4 & modes produced by the dm . appears in eq .",
    "[ e : v_bi ] and  [ e : eps_para_bi ] .",
    "+ @xmath5 & concatenation of all wfs measurements in science directions , refer to the ts slopes for canary .",
    "+ & appears in eqs .",
    "[ e : sbeta ] ,  [ e : varparabeta_hat ] and  [ e : qsa ] .",
    "+ @xmath6 & additive noise contribution into wfs measurements  ( ts for canary ) . appears in eqs .",
    "[ e : sbeta ] and  [ e : varparabeta_hat ] .",
    "+ @xmath7 & additive aliasing contribution into wfs measurements  ( ts for canary ) . appears in eqs .",
    "[ e : sbeta ] ,  [ e : varparabeta_hat ] ,  [ e : dphiavg ] and  [ e : rbeng ] .",
    "+ @xmath8 & aliasing truly measured by on science directions wfs  ( ts for canary ) . + & defined in eq .",
    "[ e : rbeng ] as the difference between @xmath7 and @xmath9 .",
    "+   + @xmath10 & concatenation of all wfs measurements in sensing directions , here from off - axis wfs for the canary case . + & appears in eqs .",
    "[ e : salpha ] and  [ e : aparabeta ] .",
    "+ @xmath11 & measured modes by wfs in sensing directions .",
    "appears in eqs .",
    "[ e : salpha ] and  [ e : aparabeta ] .",
    "+ @xmath12 & noise contribution into wfs measurements . appears in eqs .",
    "[ e : salpha ] ,  [ e : aparabeta ] and  [ e : epspara ] .",
    "+ @xmath13 & aliasing contribution into wfs measurements",
    ". appears in eqs .",
    "[ e : salpha ] ,  [ e : aparabeta ] ,  [ e : rbeng ] ,  [ e : epsrts ] and  [ e : covepsrbe ] .",
    "+   + @xmath14 & zernike reconstruction matrix  ( slopes to zernike ) : calibrated on the bench .",
    "+ @xmath15 & zernike interaction matrix  ( zernike to slopes ) : calibrated on the bench .",
    "+ @xmath16 & tomographic reconstructor  ( slopes @xmath17 to slopes @xmath18 ) : calibrated on - sky using the learn & apply approach .",
    "+ @xmath19 & @xmath20 zernike polynomials .",
    "+   + @xmath21 & loop gain .",
    "+ @xmath22 & latency of the system in frames calibrated on the bench at 0.45 frame .",
    "+ @xmath23 & sampling frequency of the rtc , 150 hz +   + @xmath24 & average of @xmath25 .",
    "+ @xmath26 & cross - covariance matrix of @xmath25 and @xmath27 .",
    "+ @xmath28 & estimation of @xmath25 .",
    "+ @xmath29 & z - transform of @xmath30 .",
    "+    [ t : notation ]    x=1cm , y=1cm,->=stealth ( 0,1 ) rectangle ( 2,2 ) ; ( 1,1.5 ) nodewfs1 ; ( 0,-1 ) rectangle ( 2,-2 ) ; ( 1,-1.5 ) nodewfs2 ; ( -.5,1.5 ) node[left]@xmath31  ( 0,1.5 ) ; ( -.5,-1.5 ) node[left]@xmath32  ( 0,-1.5 ) ; ( -1,0 ) node[left]@xmath33  ( 2.5,0 ) ; ( 2.5,0 )  ( 5,0 ) ; ( 6.5,0 )  ( 9,0 ) node[right]@xmath34 ; ( 7.5,0 ) circle(0.25)node[above left]+;(8.5,0 ) circle(0.25)node[above left]+ ; ( 7.5,0.75 ) node[above]@xmath35  ( 7.5,0.25 ) ; ( 7.5,.25 )  ( 7.5,0 ) ; ( 8.5,0.75 ) node[above]@xmath36  ( 8.5,0.25 ) ; ( 8.5,.25 )  ( 8.5,0 ) ;    ( 3,-2.5 ) circle(0.25)node[below left]+;(4,-2.5 ) circle(0.25)node[below left]+ ;    ( 1,-2 )  ( 1,-2.5 )  ( 6.75,-2.5 ) node[right]@xmath37  ( 6.75,-1.75 )  ( 6.5,-1.75 ) ; ( 2,1.5 )  ( 6.75,1.5 ) node[right]@xmath38  ( 6.75,.15 ) ; ( 6.75,0.15 ) arc [ radius=0.15 , start angle=90 , end angle= -90 ] ; ( 6.75,-.15 ) ",
    "( 6.75,-1.25 ) ",
    "( 6.5,-1.25 ) ; ( 3,-3.25 ) node[below]@xmath39 ",
    "( 3,-2.75 ) ; ( 3,-2.75 ) ",
    "( 3,-2.5 ) ; ( 3,2.25 ) node[above]@xmath40  ( 3,1.75 ) ; ( 3,1.75 ) ",
    "( 3,1.5 ) ; ( 4,-3.25 ) node[below]@xmath41 ",
    "( 4,-2.75 ) ; ( 4,-2.75 ) ",
    "( 4,-2.5 ) ; ( 4,2.25 ) node[above]@xmath42  ( 4,1.75 ) ; ( 4,1.75 )  ( 4,1.5 ) ; ( 3,1.5 ) circle(0.25 ) node[above left]+;(4,1.5 ) circle(0.25)node[above left]+ ; ( 3,0 ) circle(0.5)node[above left]- ; ( 5,-0.5 ) rectangle node[above]ts ( 6.5,0.5 ) ; ( 4.5,-1 ) rectangle ( 6.5,-2 ) ; ( 5.25,-1.5 ) nodertc ; ( 4.5,-1.5 ) ",
    "( 3,-1.5 ) ",
    "( 3,-.5 ) ; ( 3,-.5 )  ( 3,0 ) ; ( 4.5,0 ) node[above , text width=1cm]@xmath43 ; ( 3,-1 ) node[right]@xmath44 ; ( 2.3,-0.7 ) rectangle ( 3.7,0.7 ) ; ( 3,0.7 ) node[above]dm 1 ;    we illustrate in fig .",
    "[ f : moao ] a schematic diagram of a single science channel moao system with two gs . each of these sensing channels has a wfs , assumed to be a shack - hartman ; it measures the uncompensated phase @xmath45 in the direction @xmath46 .",
    "this wfs delivers noisy slopes assumed to be a linear function of the input phase through @xmath15  the zernike interaction matrix , calibrated on the bench , which gives the wfs slopes from the zernike modal coefficients according to @xmath47 with @xmath10 the concatenation of wfs measurements , @xmath11 the zernike modes corresponding to the parallel phase , @xmath12 and @xmath13 the additive measurement noise and aliasing respectively .",
    "the parallel phase here is defined as the zernike modes the dm is able to correct for . from the calibration proposed by vidal  ( @xcite ) ,",
    "the parallel phase is composed up by the 36 first zernike modes . on top of that",
    ", we assume the dm actuator pitch and the wfs sub - aperture pitch are identical and the fitting caused by modes higher than 36 is not sensed by the wfs  unless in its aliased form .",
    "the wfs slopes @xmath10 are used to estimate the slopes @xmath48 in direction @xmath49 through the tomographic reconstructor @xmath16 defined in slopes space  ( @xcite ) .",
    "the latter is calibrated on - sky .",
    "the estimation of the on - axis phase @xmath50 is then given by  : @xmath51 where we use @xmath14  the pseudo - inverse of @xmath15  to reconstruct the pupil - plane phase out of slopes .",
    "we further assume @xmath52 , the identity matrix .",
    "the dm produces a corrective phase @xmath4 , updated recursively from @xmath50 . to reproduce the total system fractional delay @xmath53 , with @xmath22 calibrated on the bench to be @xmath54 of a frame , we combine values of @xmath50 acquired at time @xmath55 and @xmath56 .",
    "mathematically , we have  : @xmath57 in moao systems there is no `` closed - loop '' since there is no wfs / dm feedback . to avoid confusion using the `` closed - loop '' and `` open - loop '' terminology we adopted in the remainder of this paper the term _ engaged loop",
    "_ when @xmath58 meaning the loop is running and _ disengaged loop _ when the dm is flat @xmath59 .    applying the z - transform to eq .",
    "[ e : v_bi ] gives @xmath60 where @xmath61 , @xmath23 the temporal sampling frequency and @xmath62 the controller transfer function defined as @xmath63    we can now ascribe the phase residual as  : @xmath64 where @xmath3 is the in - band residual leftover after dm compensation : @xmath65 whereas @xmath2 is the dm fitting error .",
    "combining eqs .",
    "[ e : aparabeta ] ,  [ e : tmi ] ,  [ e : eps_bi ] and [ e : eps_para_bi ] , the z - transform of @xmath66 , denoted @xmath67 , becomes : @xmath68 where @xmath69 is the _ aniso - servo _ error that combines both tomographic reconstruction and system temporal lag errors . for on - sky performance diagnostic purposes , we have split this aniso - servo error into a sum of two components : a pure tomographic error plus a pure temporal error .",
    "we define the _ tomographic error _ as follows : @xmath70 which allows us to rewrite eq .",
    "[ e : tvbi1 ] as @xmath71 where the controller s rejection transfer function @xmath72 is @xmath73    in fig .",
    "[ f : hrej ] , we display bode magnitude curves for both @xmath72 and @xmath74 for three different gain values . according to eq .",
    "[ e : tvbi2 ] , @xmath74 is the temporal transfer function operating on the off - axis aliasing and noise .",
    "we thus filter out the high temporal frequencies of noise and aliasing , while the servo - lag error results essentially from the high temporal frequencies of the tomographic estimation since @xmath72 does behave as a high - pass filter .",
    "we use the high - pass / low - pass features of the transfer functions to compute the residual phase wave - front  ( wf ) error variance @xmath75  : @xmath76 where the wf error is given by summing over the variance of individual modes . to obtain eq .",
    "[ e : var_eps ] from eq .",
    "[ e : tvbi2 ] the following approximations have been done  :    * all terms are considered statistically independent .",
    "more specifically the tomographic error have been separated from the servo - lag error .",
    "mathematically , it means we neglect the correlation between @xmath77 and @xmath78 . as shown in fig .",
    "[ f : hrej ] , the signal filtered out by the transfer function @xmath72 is depleted from its low temporal frequencies .",
    "on the other hand the tomographic error term follows a negative slope temporal spectrum : the bulk of the error is concentrated on the low temporal frequencies .",
    "these observations have led us to split both and disregard any cross term .",
    "* for the same reasons , we neglect the correlation between the aliasing @xmath79 , mostly composed of low temporal frequencies , and the servo - lag error @xmath78 . * the correlation between the off - axis aliasing @xmath79 and the tomographic error @xmath77 is neglected as well .",
    "the former is spatially filtered by the mmse reconstructor and later temporally filtered by the loop transfer @xmath74 .",
    "we thus expect the correlation of these two residual terms to be very weak prompting us to set it to null .",
    "* we further neglect the correlation between the high order modes @xmath80 above the dm cut - off frequency and the parallel ones included in the tomographic and servo - lag errors .",
    "* we assume the dm is well represented by zernike modes , using the zernike interaction matrix calibrated on the bench .",
    "canary uses a _",
    "truth sensor _ ,",
    "i.e. an extra wfs measuring the residual phase on - axis here @xmath18 .",
    "in practice , observing faint targets precludes the use of such sensor to probe the residual turbulence in the science directions of interest . as a technical demonstrator",
    ", canary observes star asterisms composed of a bright central star , surrounded by up to two or three off - axis stars , usually separated by less than one arc - minute from the center  ( @xcite ) .",
    "the ts is required for calibration and diagnostic purposes .",
    "its vector of slopes @xmath5  see fig .",
    "[ f : moao ]  provides a measurement of the residual phase with additional noise and aliasing terms  : @xmath81 using the zernike reconstruction matrix @xmath14 , we get  : @xmath82 pursuing as before we get  : @xmath83 equation  [ e : varparabeta_hat2 ] shows that the ts measures a residual aliasing term , i.e. the difference between the pure ts aliasing @xmath84 and the post - tomographic term @xmath85 .",
    "we define @xmath86 as this _ aliasing residual _ measured by the ts during observation as  : @xmath87 in eq .",
    "[ e : rbeng ] , we do not consider the temporal filtering of the off - axis aliasing as it appears in eq .",
    "[ e : varparabeta_hat2 ] , which leads to an over - estimation of the wavefront error , thus an under - estimation of the sr .",
    "in tomographic systems the challenge is to be able to estimate the ao residuals without actual measurements of the residual phase in the directions of interest . for convenience",
    "we use optical transfer functions  ( otf ) .",
    "psfs are readily computed from otfs by fourier transforms .    in the following ,",
    "we propose to compare two different techniques :    * * rtc - based method : * this is the adaptation of the vran s method  ( @xcite ) to moao systems employing atmospheric tomography .",
    "it consists in estimating the on - axis residual phase that would be otherwise measured by the ts when the loop is engaged . to than end",
    ", we generalize calculations presented in sect .  [ s : moao ] to estimate the covariance matrix of the residual in - band ao modes . *",
    "* ts - based method : * here we use a slightly modified classical psf - r algorithm to account for specifics of propagated error terms using the truth sensor telemetry . on the canary demonstrator ,",
    "the ts is used on - axis with a bright star for demonstrating operational moao plus diagnosing performance .",
    "it is used here as a reference method but will not be available in normal moao operations .",
    "the otf of an ao system is commonly modelled as a multiplication of the telescope otf including static aberrations , and an ao otf of the residuals  ( @xcite ) .",
    "the latter is then split into an in - band _ parallel part _ ,",
    "otf@xmath88 over spatial frequencies the ao systems has acted upon and an _ orthogonal part _ , otf@xmath89 that gathers all the spatial frequencies above the dm cut - off frequency .",
    "the final otf@xmath90 , can be written as follows : @xmath91 where @xmath92 is the non common path aberrations  ( ncpa ) including the telescope otf in directions @xmath18 . since we include the telescope otf with the ncpa term the remaining terms must be free from it to avoid incorporating it more than once .",
    "the long - exposure otf is given by @xcite : @xmath93 where @xmath94 is the residual phase structure function  ( sf ) which when averaged over the telescope pupil becomes  : @xmath95 where @xmath96 the pupil function .",
    "using the 36 first zernike polynomials we get  : @xmath97 the residual phase structure function then becomes  : @xmath98 where  : @xmath99 from eq .",
    "[ e : dphiavg ] , the estimation of the psf boils down to estimating the covariance matrix of the residual phase expressed on the zernike modal basis @xmath100 .",
    "the rtc - based method consists in determining @xmath3 from the off - axis wfs telemetry .",
    "[ e : tvbi2 ] gives an analytic expression of the z - transform of the residual modes @xmath66 . in subtracting off the orthogonal part @xmath2 ( i.e. the fitting ) and in transforming back to the real space",
    ", we get : @xmath101 where @xmath102 the impulse response of the moao system , @xmath103 the convolution product and @xmath104 is the output of a first order low - pass filter defined by : @xmath105 where @xmath72 is given by eq .  [",
    "e : hol ] and eq .",
    "[ e : hrej ] , and @xmath106 is our best estimates of the off - axis parallel noise - free modes . from eq .",
    "[ e : epspara ] and eq .",
    "[ e : ebe ] , assuming all the terms involved in eq .",
    "[ e : epspara ] are independent processes , we get the following expression for the spatial covariance of the residual phase in the direction @xmath49  : @xmath107 where  :    * @xmath108 is the tomographic error covariance matrix . without ts ,",
    "the tomographic error as defined in eq .",
    "[ e : ebe ] can not be evaluated empirically from the telemetry .",
    "nevertheless , a model of this covariance matrix is described in @xcite based on the tomographic reconstructor @xmath16 and relevant parameters which are  : * * @xmath109 : number of considered discrete layers , set to five for canary * * @xmath110 : altitude of turbulent layers * * @xmath111 profile : the @xmath112 value and the fractional @xmath112 per layers * * @xmath113 : @xmath114 value for each layer * * ngs / lgs wfs angular positions : they are sufficiently well known using encoders information from the target acquisition system  ( @xcite ) * * lgs focus distance and depth : calibrated on - sky to respectively 21  km and 1.5  km  ( regardless of the airmass )  ( @xcite ) * * off - axis wfs / ts mis - registration  ( pupil shifts , rotation and magnification ) : calibrated on the bench * * telescope tracking error and vibrations : modeled by an isoplanatic tip - tilt over all ngs wfs * * noise slope variance for each wfs , separately identified on the @xmath10 time series by using a parabolic fitting on the temporal auto - correlation function .",
    "+ using the learn  &  apply approach  ( @xcite ) , we retrieve this list of parameters in fitting our model over the covariance matrix of measured slopes .",
    "we then extrapolate the ts / off - axis wfs covariance matrix of slopes to retrieve the covariance matrix of the tomographic error @xmath115  ( @xcite ) .",
    "* @xmath116 is the covariance matrix of the temporally filtered atmospheric parallel modes by the moao system .",
    "it is readily derived from the time - series of the off - axis wfs measurements and parameters from the loop during the observation .",
    "* @xmath117 is the noise covariance matrix of off - axis wfs telemetry , identified by a parabolic interpolation , near to a zero - delay , of temporal auto - covariance of @xmath10 , and @xmath118 the noise propagation factor computed by  @xcite .",
    "* @xmath119 is the covariance matrix of the off - axis aliasing derived from the model described in  @xcite depending on the same list of parameters as described before for the computation of @xmath115 .",
    "contrary to approaches proposed by  ( @xcite ) , using separate tilt measurements , we do not compute specific otfs for either tip - tilt or high order modes .",
    "this is the role of the integrated tomography mmse reconstructor blending measurements from both ngs and lgs to estimate the on - axis phase in the minimal mean square error sense  ( ) .",
    "the sf in eq .",
    "[ e : dphiavg ] requires the covariance matrix of parallel modes @xmath120 estimated from @xmath121 . using eq .",
    "[ e : varparabeta_hat ] , we get  : @xmath122 from eq .",
    "[ e : rbeng ] , the covariance matrix @xmath123 can be derived as follows : @xmath124 where the matrix @xmath125 is the concatenation of the covariance matrices of off / on axis aliasing in loop disengaged  @xmath59 . assuming the independence of terms given in eq .",
    "[ e : tvbi2 ] , the ts aliasing @xmath8 is only correlated with @xmath3 .",
    "we thus have : @xmath126 combining eq .",
    "[ e : epsrts ] with eq .",
    "[ e : rbeng ] leads to : @xmath127    finally , in combining eq .",
    "[ e : sigvareps_hat ] , eq .",
    "[ e : covrbe ] and eq .",
    "[ e : covepsrbe ] , one gets the final expression of @xmath128 : @xmath129 where :    * @xmath130 is the covariance matrix estimated from the times series of @xmath131  ( ts slopes ) acquired on - sky .",
    "* @xmath132 is the noise covariance matrix estimated from the temporal auto - correlation function of @xmath5 , using the same approach developed for @xmath117 .",
    "* @xmath133 is the covariance matrix of the ts aliasing in loop disengaged . as for @xmath119 , we do not need to consider any time - filtering of the aliasing , meaning we readily estimate this covariance matrix using the model proposed in  @xcite depending on the list of parameters described before .",
    "* @xmath119 is the same off - axis aliasing covariance matrix required for the rtc - based method .",
    "note the ts - based method does not include angular / focal anisoplanatism since the science object is also the reference star observed by the ts . in passing , note that",
    "unlike in vran s approach  ( @xcite ) for closed - loop systems , the ts is here only an observer of the residual phase .",
    "the ts slopes are never used to update the dm commands .",
    "this is a noticeable difference in how the aliasing is handled : the ts aliasing is no longer anti - correlated to the low order modes produced by the dm to null out the wfs measurements , since there is no ts / dm feedback . using the large bandwidth approximation , we would have @xmath134 in eq .",
    "[ e : covepsrbe ] , which is not the case here .",
    "the ncpa are calibrated on the bench , without turbulence and in closed loop on the ts , using the phase diversity algorithm proposed by gratadour  ( @xcite ) .",
    "the residual phase is retrieved from a set of in / out focus images in the focal plane .",
    "the calibration leads to non - compensated high order modes and a fitting residual on the low order modes , reaching 105  nm rms of wavefront error .",
    "we consider these ncpa as static during each observation runs  ( three nights to six consecutive nights ) .",
    "in addition to ncpa , we have to deal with common static aberrations @xmath136 in the science directions .",
    "these are not strongly mitigated by the loop as it is done for closed - loop systems . in moao",
    ", they must be calibrated on - sky and compensated by a dm offset .",
    "unfortunately , these static aberrations are drifting slowly in time because the field rotation and the dm creeping effect  ( @xcite ) and range 100  nm rms of wavefront error  ( ) .",
    "they are calibrated in loop - engaged using the on - going test tomographic reconstructor by averaging the ts telemetry with time  ( see eq .",
    "[ e : qsa ] ) and applying a dm offset using the command matrix .",
    "this procedure is repeated several times over the night to tackle the dm creeping in the best way possible .",
    "even if the science objects are too faint for wf sensing , the canary experiment has demonstrated it is feasible to offset the telescope towards a bright star  ( r @xmath137 12 ) to get the required calibration  ( @xcite ) .",
    "for moao psf - r purposes we determine @xmath136 from the ts measurements using the zernike reconstruction matrix @xmath14 , considering noise and aliasing as zero - mean processes , as follows : @xmath138    equation  [ e : otf_res ] involves a static otf@xmath139 term . to avoid including multiple times the telescope otf which is factored in every term as well as in eq .",
    "[ e : qsa ] , precaution must be taken by dividing the otfs by that of the telescope @xcite as follows : @xmath140 where : @xmath141 and applying a threshold for values of @xmath142 nearing the telescope pupil to avoid division by zero for larger spatial frequencies than @xmath143 .",
    "the dm fitting @xmath144 is computed analytically from the von - krmn power spectrum density  ( psd ) of the atmosphere , which scales with @xmath145 , set to zero in the band of frequencies lower than @xmath146 .",
    "the proportionality has been calibrated using end - to - end simulations  ( @xcite ) .",
    "we get @xmath147 for the canary dm .",
    "figure  [ f : stat ] depicts results on reconstructed strehl - ratio  ( sr ) and full width at half maximum  ( fwhm ) as function of the corresponding sky values estimated on focal plane images .",
    "each point is a result of the psf - r performed on a single data set acquired in september 13 , 15 , 17 and 18 2013 , where canary was operating is phase b configuration , observing a four stars asterism , with a central bright star and with four rayleigh lgs focused at 21  km  ( see .",
    "@xcite for observation details ) .",
    "we report in table  [ t : stat ] statistics of the reconstruction in terms of sr and fwhm .    .",
    "[ cols=\"^,^,^,^,^\",options=\"header \" , ]     h - band sky images were generally 1  s exposure time and averaged over 15 realizations . after subtracting the background calibrates on - sky ,",
    "all spatial frequencies in the otf higher than @xmath143 are set to zero .",
    "we then evaluate @xmath148 and @xmath149 , respectively the median and variance of the residual background noise , from the outer region part of inscribed circle of the image , then the flux @xmath150 from the inside part .",
    "the sr is then estimated using the method proposed by gendron  @xcite : @xmath151 where @xmath152 , with @xmath153 and @xmath154 respectively the telescope and central obscuration diameter , and @xmath155 the camera pixel scale . according to eq .",
    "[ e : srest ] , the standard - deviation of the sr estimates can be derived as follows : @xmath156}^2\\\\      & + { \\left(\\dfrac{{\\overline{n}_\\text{cam}}}{a\\times { f_\\text{cam}}}\\right)}^2{\\left [ \\dfrac{\\delta { \\overline{n}_\\text{cam}}}{{\\overline{n}_\\text{cam } } } + \\dfrac{\\sqrt{{f_\\text{cam}}+ n_\\text{pix}^2{\\sigma^2_\\text{e}}}}{{f_\\text{cam}}}\\right]}^2 , \\end{aligned}\\ ] ] where @xmath157 is the number of pixels on which the flux is measured and @xmath158 the standard - deviation on the noise median @xmath148 estimation .",
    "we get , in nominal conditions , about 1500 photons per pixel and 4.5 electro - photons of read - out noise , the sr estimates is completely limited by the photon noise . at three sigma",
    ", we get @xmath159 1.3 of error on the sr estimation . sr on the reconstructed psf are directly estimated from the reconstructed otf , integrated over the spatial frequencies .",
    "the fwhm is determined from fitting five - parameters of the following moffat function : @xmath160 where @xmath161 is the psf amplitude , @xmath162 and @xmath163 coefficients of spreading along @xmath164 and @xmath165 directions , @xmath49 the skewness coefficient and @xmath166 the rotation coefficient .",
    "the fwhm is then given by : @xmath167    we obtained 95  % of correlation on the sr over 450 data sets using the ts - based method .",
    "the reconstruction is affected by a bias of 0.41 , which is under the error bars of 1.3 on the h - band images sr .",
    "in addition , we get a 1-@xmath0 standard deviation of 3.52 of sr , over a large swath of observation conditions . in terms of fwhm",
    ", we get 92.5% of correlation , a bias of 2.71 mas and a 1-@xmath0 standard deviation of 14.9 mas which is 19% of the diffraction on the wht . the high correlation obtained on sr and fwhm with the reconstructed psfs",
    "confirm the accurateness of the profiling estimation routines and system calibration .    from table",
    "[ t : stat ] , the rtc - based method achieves very similar results from the ts - based method . on the sr",
    ", we get 92.3% of correlation , a bias of 1.29% and a 1-@xmath0 standard - deviation of 4.82% . on the fwhm",
    ", we get 88.3% of correlation , a bias of 2.94 mas and a 1-@xmath0 standard deviation of 19.9 mas . as noticed on fig .  [",
    "f : stat ] , we get a larger scattering than using the ts - based method .",
    "bias on the estimates have several sources due to model approximations , as the independence assumption in eq .",
    "[ e : sigepsbertc ] and particularly the dm representation using the 36 first zernike .",
    "an important point to notice is the fwhm is similarly well reconstructed with both methods .",
    "it means each contributor that spread out the psf core and contributes significantly to the fwhm , as the static aberrations , are well taken into account .",
    "we focus now on a particular data set acquired at 00h15m36s on september 13th 2013 .",
    "canary was operating in moao mode with four lgs and three ngs .",
    "during 2048 temporal frames , sampled at 150 hz , the rtc has provided synchronized wfs telemetry and h - band imaging camera .",
    "we report in fig .",
    "[ f : psf ] both sky and reconstructed psfs . on - sky psf , we measure a h - band sr of 24.0 and a fwhm of 107.5 mas . with the ts - based method , with a sr of 24.05 and a fwhm of 111.4 mas .",
    "then , with the rtc - based method , we reach 24.5 of sr and 118.8 mas of fwhm .",
    "in addition , fig .",
    "[ f : psf ] illustrates the psf core elongation is well reconstructed whatever the method .    in fig .",
    "[ f : res ] we report the relative error on the ensquared energy  ( ee ) , the radial average of the psfs and the otfs . one can notice the quality of the reconstruction is not only a matter of sr and fwhm .",
    "we stay below 6% of relative error on the ee . in median value",
    ", we get 7.0% of maximal error on the ee over the 450 processed data for both methods . the signed ee error",
    "we get is generally following the curve presented in fig .",
    "[ f : res ] : a maximum located in the psf core and a quick decreasing towards 0 . on the otf ,",
    "we reconstruct more energy from the low spatial frequencies that translates to a faster decreasing of the reconstructed psf core than the sky , as we noticed on the radial psf curves between 0.2 and 0.5 arcsec .",
    "we believe these mis - matches between reconstructed and sky psf are first related to assumptions on the dm : the phase is represented by zernike modes and not by dm influence functions .",
    "this effect is minimized when using a reconstruction matrix calibrated on the bench .",
    "we have laid out a psf - r algorithm tailored to open - loop , tomographic moao systems and compared it to a reference method using the truth - sensor and to on - sky metrics ( sr , fwhm , ee ) obtained directly from the science detector .",
    "we have processed over 450 data sets of telemetry from the canary moao demonstrator . in terms of reconstructed sr , using the rtc - based method , we report a bias and a 1-@xmath0 standard - deviation of respectively 1.3 and 4.8 of strehl points , with 92.3% of correlation between the reconstructed and sky sr . in terms of reconstructed fhwm",
    ", we get respectively 2.94 mas and 19.9 mas for the bias and the 1-@xmath0 standard - deviation , with 88.3% of correlation using the rtc / ts - based method .",
    "bias on reconstructed values are lower than errors bars on sky values for both methods on both sr and fwhm .",
    "we get also very similar standard - deviation on reconstructed values as well for both methods .",
    "this work shows that fine - detailed system calibration and modeling can be operated to achieve such high levels of correlation on sr and fwhm .",
    "we emphasis particularly the reliability and efficiency of tools implemented for turbulence characterization based on the learn & apply approach  ( @xcite ) , and static aberrations calibration , since we are able to reproduce the asymmetric shape of the psf caused by these static aberrations .",
    "we now plan to improve the reconstruction method by reviewing the approximations and assumptions by evaluating cross - terms using end - to - end simulations and by integrating measurable matrices from the bench on the reconstruction process .",
    "we will then extend results to elt - sized systems .    the research leading to these results received the support of the a*midex project ( no .",
    "anr-11-idex-0001 - 02 ) funded by the  investissements davenir  french government program , managed by the french national research agency ( anr ) .",
    "this work is also supported cnrs , insu , observatoire de paris , universit paris diderot - paris 7 and european commission ( fp7 infrastructures 2012 - 1 , opticon grant 312430 , wp1 ) .      , d.  r. , fischer , m.,conan , r.,fletcher , m. and vran , j .- p . , _ volt : the victoria open loop testbed _",
    "spie , 2008 .",
    ", m.  c. , _ the anisoplanatic point - spread function in adaptive optics _ , publications of the astronomical society of the pacific , 2006 .    , c.  j. , lehnert , m.  d.,cuby , j .- g . ,",
    "morris , s.  l. , swinbank , a.  m. , taylor , w.  d. , alexander , d.  m. , lorente , n.  p.  f. , clnet , y. and paumard , t. , _ science requirements for eagle for the e - elt _ , proc .",
    "spie , 2008 .",
    ", r.  c. , rigaut , f.  j. and ellerbroek , b.  l. , _ tilt anisoplanatism in laser - guide - star - based multiconjugate adaptive optics .",
    "reconstruction of the long exposure point spread function from control loop data _ , astron .",
    "& astrophys . , 2003 .    ,",
    "t. , conan , j .- m .",
    ", mugnier , l.  m. , michau , v. and rousset , g. , _ characterization of adaptive optics point spread function for anisoplanatic imaging .",
    "application to stellar field deconvolution _",
    ", astron . & astrophys . , 2000 , , d. , severson , s. , bauman , b. , dillon , d. , reinig , m. , lockwood , c. , palmer , d. , morzinski , k. , ammons , m. , gates , e. and grigsby , b. ,",
    "_ villages : an on - sky visible wavelength astronomy ao experiment using a mems deformable mirror _ , proc .",
    "spie , 2008 . ,",
    "e. , clnet , y. , fusco , t. and rousset , g. , _ new algorithms for adaptive optics point - spread function reconstruction _ ,",
    "astron . & astrophys . , 2006 . ,",
    "e. , morel , c. , osborn , j. , martin , o. , gratadour , d. , vidal , f. , le louarn , m. and rousset , g. , _ robustness of tomographic reconstructors versus real atmospheric profiles in the elt perspective _ , proc .",
    "spie , 2014 . ,",
    "e. , vidal , f. , brangier , m. , nd morris , t. , hubert , z. , basden , a. , rousset , g. , myers , r. , chemla , f. , longmore , a. , butterley , t. , dipper , n. , dunlop , c. , geng , d. , gratadour , d. , henry , d. , laporte , p. , looker , n. , perret , d. , sevin , a. , talbot , g. and younger , e. , _ moao first on - sky demonstration with canary _ , astron . & astrophys . , 2011 , , l. and ellerbroek , b.  l. , _ split atmospheric tomography using laser and natural guide stars _ , journal of the optical society of america a , 2008 .",
    ", d , gendron , e , grosset , l , morris , t , osborn , j , basden , a , martin , o , rouan , d , myers , r and rousset , g , _ first demo science with moao : observations of distant merging galaxies with canary _ , proceedings of the third ao4elt conference . , 2013 . ,",
    "d. , gendron , e. and rousset , g. , _ practical issues with phase diversity for ncpa compensation resolved on the canary demonstrator _ , proceedings of the third ao4elt conference . , 2013 .",
    ", _ mosaic at the e - elt : a multi - object spectrograph for astrophysics , igm and cosmology _ , proc .",
    "spie , 2014 . ,",
    "l. , _ synthetic modeling of astronomical closed loop adaptive optics _ , journal of the european optical society , 2010 .",
    "a. kellerer , f. vidal , e. gendron , z. hubert , d. perret and g. rousset , _",
    "deformable mirrors for open - loop adaptive optics _ , proc .",
    "spie , 2012 .",
    ", _ design and test results of the calibration unit for the moao demonstrator raven _ , proc .",
    "spie , 2012 . , _",
    "william herschel telescope site characterization using the moao pathfinder canary on - sky data _ , proc .",
    "spie , 2016 .",
    ", _ wave - front error breakdown in lgs moao validated on - sky by canary _ , astron . & astrophys .",
    "( in revision ) , 2016 . ,",
    "_ e - elt update of project and effect of change to 39 m design _ , proc .",
    "spie , 2012 .",
    ", _ canary phase b : on - sky open - loop tomographic lgs ao results _ , proc .",
    "spie , 2014 .",
    ", _ estimation of the adaptive optics long - exposure point - spread function using control loop data .",
    "_ , journal of the optical society of america a , 1997 . , _ specifications and design of the e - elt m4 adaptive unit _ , proc",
    "spie , 2012 .",
    ", _ detailed analysis of the first moao results obtained by canary at the wht .",
    "_ , 2nd ao4elt conference , 2011 , , _ tomography approach for multi - object adaptive optics _ , josa a , 2010 . , _ analysis of on - sky moao performance of canary using natural guide stars _ , astron . & astrophys . , 2014 ."
  ],
  "abstract_text": [
    "<S> in preparation of future multi - object spectrographs ( mos ) whose one of the major role is to provide an extensive statistical studies of high redshifted galaxies surveyed , the demonstrator canary has been designed to tackle technical challenges related to open - loop adaptive - optics ( ao ) control with jointed natural guide star  ( ngs ) and laser guide star  ( lgs ) tomography .    we have developed a point spread function  ( psf)-reconstruction algorithm dedicated to moao systems using system telemetry to estimate the psf potentially anywhere in the observed field , a prerequisite to post - process ao - corrected observations in integral field spectroscopy  ( ifs ) .    in this paper we show how to handle off - axis data to estimate the psf using atmospheric tomography and compare it to a classical approach that uses on - axis residual phase from a truth sensor observing a natural bright source .    </S>",
    "<S> we have reconstructed over 450 on - sky canary psfs and we get bias/1-@xmath0 standard - deviation  ( std ) of 1.3/4.8 on the h - band strehl ratio  ( sr ) with 92.3% of correlation between reconstructed and sky sr . on the full width at half maximum  ( fwhm ) , we get respectively 2.94 mas , 19.9 mas and 88.3% for the bias , std and correlation . </S>",
    "<S> the reference method achieves 0.4/3.5/95% on the sr and 2.71 mas/14.9 mas/92.5% on the fwhm for the bias / std / correlation . </S>"
  ]
}