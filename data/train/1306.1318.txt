{
  "article_text": [
    "the problem that motivated our study is the analysis of benchtop and computer experiments that produce dynamical data associated with the structural fluctuations of a protein in water .",
    "frequently , the physical laws that govern these dynamics are time - reversible .",
    "therefore , a stochastic model for the experiment should also be reversible .",
    "reversible markov models in particular have become widespread in the field of molecular dynamics  @xcite .",
    "modeling with reversible markov chains is also natural in a number of other disciplines .",
    "we consider the setting in which a scientist has a sequence of states @xmath4 sampled from a reversible markov chain .",
    "we propose a bayesian model for a reversible markov chain driven by an unknown transition kernel .",
    "problems one can deal with using our model include ( i ) predicting how soon the process will return to a specific state of interest and ( ii ) predicting the number of states not yet explored by @xmath4 that appear in the next @xmath5 transitions @xmath6 .",
    "more generally , the model can be used to predict any characteristic of the future trajectory of the process .",
    "problems ( i ) and ( ii ) are of great interest in the analysis of computer experiments on protein dynamics .",
    "diaconis and rolles  @xcite introduced a conjugate prior for bayesian analysis of reversible markov chains .",
    "this prior is defined via de finetti s theorem for markov chains @xcite .",
    "the predictive distribution is that of a linearly edge - reinforced random walk ( errw ) on an undirected graph @xcite .",
    "much is known about the asymptotic properties of this process  @xcite , its uniqueness  @xcite and its recurrence on infinite graphs ( @xcite , and references therein ) .",
    "fortini , petrone and bacallado recently discussed other examples of markov chain priors constructed through representation theorems  @xcite .    our construction can be viewed as an extension of the errw defined on an infinite space .",
    "the prediction for the next state visited by the process is not solely a function of the number of transitions observed in and out of the last state . in effect",
    ", transition probabilities out of different states share statistical strength .",
    "this will become relevant in applications where many states are observed , especially for those states that occur rarely .",
    "a major goal in our application is the prediction of the number of states that the markov chain has not yet visited that will appear in the next @xmath5 transitions .",
    "more generally , scientists are interested in predicting aspects of the protein dynamics that may be strongly correlated with the rate of discovery of unobserved states , for instance , the variability of the time needed to reach a conformation of interest @xmath7 , starting from a specific state @xmath8 .",
    "predictive distributions for such attributes are useful in deciding whether one should continue a costly experiment to obtain substantial additional information on a kinetic property of interest .    estimating the probability of discovering new species is a long - standing problem in statistics  @xcite .",
    "most contributions in the literature assume that observations , for example , species of fish captured in a lake , can be modeled as independent and identically distributed random variables with an unknown discrete distribution . in this",
    "setting , several bayesian nonparametric models have been studied .",
    "here we assume that species , in our case protein conformational states , are sampled from a reversible markov chain .",
    "to the best of our knowledge , this is the first bayesian analysis of species sampling in this setting .",
    "scheme and special cases . ]    we can now outline the article .",
    "section  [ tabschemesection ] introduces the species sampling model , which we call the @xmath0 scheme .",
    "the process specializes to the errw , a  markov exchangeable scheme , and to the two - parameter hoppe urn , a classical exchangeable scheme which gives rise to the pitman  yor process and the two - parameter poisson ",
    "dirichlet distribution @xcite .",
    "as illustrated in figure  [ diagram ] , the parameter @xmath1 smoothly tunes the model between these two special cases .",
    "section  [ representationssection ] shows that the @xmath0 scheme can be represented as a mixture of reversible markov chains .",
    "this allows us to use its de finetti measure as a prior for bayesian analysis .",
    "section  [ largesupportsection ] shows that our scheme is a projection of a conjugate prior for a random walk on a multigraph .",
    "this representation is then used to prove that our model has full weak support .",
    "section  [ sufficientnesssection ] provides a sufficientness characterization of the proposed scheme .",
    "this result is strictly related to the characterizations of the errw and the two - parameter hoppe urn discussed in  @xcite and @xcite , respectively . in section  [ lawsection ] , an expression for the law of the @xmath0 scheme",
    "is derived , and this result is used in section [ bayesianinferencesection ] to define algorithms for posterior simulation .",
    "section  [ applications ] applies our model to the analysis of two molecular dynamics datasets .",
    "we evaluate the predictive performance of the model by splitting the data into training and validating datasets .",
    "section [ discussionsection ] concludes with a discussion of remaining challenges .",
    "the @xmath0 scheme is a stochastic process @xmath9 on a polish measurable space @xmath10 equipped with a diffuse ( i.e. , without point masses ) probability measure @xmath11 .",
    "we construct the law of the process using an auxiliary random walk with reinforcement on the extended space @xmath12 .",
    "the auxiliary process classifies each transition @xmath13 into three categories listed in figure  [ mechanism ] and defines latent variables @xmath14 , taking values in @xmath15 , that capture each transitions category . in this section",
    "we first provide a formal definition of the @xmath0 scheme and then briefly describe the latent process .",
    "the blue arrow represents the transition between two states in @xmath16 , while the red arrows represent the path of an auxiliary random walk with reinforcement .",
    "the edges that have positive weight @xmath17 before the transition are drawn in black , and in each case , we mark the reinforcements of @xmath17 produced by the transition .",
    "self - transitions follow a slightly different reinforcement scheme formalized in definition [ tabscheme ] . ]",
    "the law of the @xmath0 scheme is specified by a weighted undirected graph @xmath17 with vertices in @xmath18 .",
    "this graph can be formalized as a symmetric function @xmath19 , where @xmath20 is the weight of an undirected edge with vertices @xmath8 and @xmath7 .",
    "we require that the set @xmath21 is countable , @xmath22 and that the set of edges @xmath23 is a finite subset of @xmath24 .",
    "the graph will be sequentially reinforced after each transition of the @xmath0 scheme . in the following definition , we assume the initial state @xmath25 is deterministic and contained in @xmath26 .",
    "[ tabscheme ] the _ @xmath0 scheme _ , @xmath27 , has parameters @xmath28 , @xmath29 and @xmath30 $ ] .",
    "the parameter @xmath3 is equal to the initial weight @xmath31 .",
    "suppose we have sampled @xmath32 , where @xmath33 .",
    "then , given @xmath34 and the reinforced graph @xmath17 , we sample the following :    _ an errw - like transition _ to @xmath35 with probability @xmath36 and make the following reinforcement : @xmath37    _ a mediated transition without discovery _ to @xmath35 with probability @xmath38 and make the following reinforcements : @xmath39    _ a mediated transition with discovery _ to a new state @xmath40 with probability @xmath41 and make the following reinforcements : @xmath42    in several applications one may prefer to set the initial @xmath17 to zero everywhere except for @xmath43 and @xmath44 , which can be made infinitesimally small .",
    "this reduces difficulties associated with the model specification and does not affect the main properties of the model discussed in this article . in some cases",
    ", we will relax the assumption that @xmath25 is deterministic , by specifying a distribution , say @xmath11 , for @xmath25 and choosing a positive value for @xmath44 . in any case , the conditional distributions @xmath45 are dictated by the reinforced scheme in definition  [ tabscheme ] .",
    "we can now describe the latent reinforced process in order to simplify the interpretation of the @xmath0 scheme . to sample a transition @xmath46",
    ", we first take one step in the auxiliary random walk from @xmath34 . if we land on a state @xmath47 [ panel  ( a ) in figure [ mechanism ] ] , we set @xmath48 and @xmath49 .",
    "if we land on @xmath50 , we sample another step of the random walk from @xmath50 .",
    "once more , if we land on some @xmath51 [ panel ( b ) in figure [ mechanism ] ] , we set @xmath52 and @xmath53 . otherwise [ panel ( c ) in figure  [ mechanism ] ] , we sample a new state @xmath35 from @xmath11 and set @xmath54 .    [ hoppeurns2 ] assume the initial graph @xmath17 is null everywhere except for @xmath43 and @xmath55 . if @xmath56 , @xmath57 and @xmath58 , then the process @xmath9 is a blackwell  macqueen urn  @xcite with base distribution @xmath11 and concentration parameter @xmath59 . in different words , the process is exchangeable and its directing random measure is the dirichlet process  @xcite .",
    "[ hoppeurns3 ] under the assumptions in remark  [ hoppeurns2 ] , by setting @xmath60 and @xmath61 , the process @xmath62 is equal to an urn scheme introduced by engen  @xcite , known in the species sampling context as the two - parameter hoppe urn ; see appendix b  @xcite .",
    "this exchangeable process has been studied extensively by pitman and yor  @xcite .",
    "its directing random measure is the pitman ",
    "yor process @xcite with base distribution @xmath11 , concentration parameter @xmath63 , and discount parameter @xmath64 ; the sorted masses of this random measure have the two - parameter poisson  dirichlet distribution .",
    "note that the discount parameter of the pitman ",
    "yor process can be chosen from the unit interval @xmath65 , while in our construction @xmath66 .",
    "[ edgereinforcedrandomwalk ] when @xmath67 , edges connected to @xmath50 can not be reinforced , and the @xmath0 scheme specializes to the errw on @xmath26 ; see  @xcite .",
    "definition  [ tabscheme ] brings to mind the two - parameter hierarchical dirichlet process hidden markov model ( hdp - hmm )  @xcite and its associated species sampling scheme , the two - parameter chinese restaurant franchise .",
    "this process has been used for bayesian modeling of markov chains on infinite spaces .",
    "the predictive distribution can be viewed as a @xmath68 scheme in which the underlying infinite graph has directed edges . however , the @xmath0 scheme is not a special case of this model and has no equivalent hierarchical construction .",
    "this connection is explained in more detail in appendix b  @xcite .",
    "the influence of each parameter in the @xmath0 scheme can be described as follows .",
    "the parameter @xmath1 determines the markov character of the model ; as it approaches 1 , the process becomes exchangeable .",
    "the parameter @xmath3 is related to the concentration parameter of the two - parameter hoppe urn , which controls the mode of the number of states visited in a given number of steps .",
    "the parameter @xmath2 is related to the discount factor in the two - parameter hoppe urn , which controls the distribution of frequencies of different states .",
    "it is worth noting that @xmath1 also controls the number of states visited , which increases markedly as @xmath1 is made larger .",
    "the recurrence of the errw on infinite graphs is far from trivial , especially for locally connected graphs ( @xcite , and references therein ) .",
    "however , it is not difficult to prove that the @xmath0 scheme a.s .",
    "returns infinitely often to all visited states , the state @xmath50 is visited infinitely often a.s . and , if @xmath69 , the edge @xmath31 is crossed infinitely often .",
    "this notion of recurrence is stated in the next proposition .",
    "[ recurrence ] the @xmath0 scheme is recurrent , that is , the event @xmath70 has probability 1 for every integer @xmath71 .",
    "when @xmath69 or when the set @xmath26 is infinite , the number of states visited is infinite almost surely .",
    "diaconis and freedman defined a special notion of partial exchangeability to prove a version of de finetti s theorem for markov chains  @xcite .    [ markovexchangeability ] a stochastic process on a countable space @xmath16 is _ markov exchangeable _ if the probability of observing a path @xmath72 is only a function of @xmath73 and the transition counts @xmath74 for all @xmath75 .    [ definettistheoremformarkovchains ]",
    "a process is markov exchangeable and returns to every state visited infinitely often , if and only if it is a mixture of recurrent markov chains .",
    "the @xmath0 scheme takes values in an uncountable space @xmath16 , which precludes a direct application of theorem [ definettistheoremformarkovchains ] .",
    "we will state a more general notion of markov exchangeability and use it to prove a de finetti style representation for @xmath9 .",
    "we use the notion of _ @xmath8-block _ defined in diaconis and freedman @xcite ; given a recurrent trajectory @xmath76 , the @xmath71th @xmath8-block , for any state @xmath8 appearing in @xmath76 , is the finite subsequence that starts with the @xmath71th occurrence of @xmath8 and ends before the @xmath77th occurrence .    the process @xmath9 visits every state in @xmath78 infinitely often ; in addition , it will discover new species in @xmath16 in steps of the third kind in figure  [ mechanism ] .",
    "but the new species are sampled independently from @xmath11 , which motivates expressing @xmath9 as a function of two independent processes on the same probability space : @xmath79 which represents the sequence where new species are labeled in order of appearance , and @xmath80 which represents the @xmath16-valued locations of each species .",
    "these are formally defined in the sequel .",
    "let @xmath81 , and let @xmath82 be a function that maps a sequence in @xmath83 to a sequence in the disjoint union @xmath84 .",
    "each element of the sequence in @xmath26 is mapped to itself , and those not in @xmath26 are mapped to the order in which they appear in the sequence . hence , the range of @xmath82 consists of sequences where every state @xmath85 may only appear after all states @xmath86 have appeared at least once .",
    "for example , if @xmath87 is the unit interval and @xmath88 , then @xmath89 define @xmath90 , and let @xmath80 be a sequence of independent random variables from @xmath11 , with @xmath80 independent from @xmath91 .",
    "then , @xmath92    [ partialexchangeability ] take two sequences @xmath72 and @xmath93 in @xmath94 that are fixed points of @xmath82 .",
    "suppose one can map @xmath72 to @xmath93 by a transposition of two blocks in @xmath72 which both begin in @xmath95 and end in @xmath96 , followed by an application of the mapping @xmath82 .",
    "then , @xmath97    assume again @xmath88 .",
    "if we set @xmath98 and @xmath99 then , by transposing two blocks in @xmath100 that start from @xmath101 and finish in @xmath102 , we obtain the vector @xmath103 .",
    "moreover , @xmath104 proposition  [ partialexchangeability ] then implies that the two probabilities , @xmath105 and @xmath106 , are identical .    note that if the process only visits states in @xmath26 , as is the case when @xmath107 , the statement of proposition [ partialexchangeability ] is equivalent to markov exchangeability ; cf .",
    "proposition 27 in  @xcite .",
    "this fact , together with proposition  [ recurrence ] is enough to show by a straightforward application of theorem  [ definettistheoremformarkovchains ] that the @xmath0 scheme with @xmath107 is a mixture of recurrent markov chains on @xmath26 .",
    "equipped with this notion of markov exchangeability for the species sampling sequence @xmath91 , we show that @xmath108 can be represented as a mixture of markov chains .",
    "[ representationtheorem ] there exists a mixture of markov chains @xmath109 , taking values in @xmath84 , such that , if we define @xmath110 where @xmath109 and @xmath111 are independent , then @xmath112 .",
    "that is , for some measure @xmath113 on @xmath114 , where @xmath115 is the space of stochastic matrices on @xmath84 , the distribution of @xmath116 , can be represented as @xmath117    let @xmath118 be the set of transition probability matrices for recurrent reversible markov chains .",
    "we can show that this set has probability 1 under the de finetti measure .",
    "[ reversibility ] @xmath119 .",
    "this section shows that the @xmath0 scheme can be interpreted as a bayesian conjugate model for a random walk on a multigraph .",
    "this representation is used for showing that the @xmath0 scheme has large support in a sense that will be made precise in the sequel .",
    "we also make a connection between the de finetti measure of the errw on a finite graph and our model .",
    "we start by defining a colored random walk on a weighted multigraph @xmath120 .",
    "the vertices of the graph take values in @xmath16 , and we now allow there to be more than one edge between every pair of vertices .",
    "every edge is associated to a distinct color in a set @xmath121 .",
    "we assign a weight @xmath122 to the edge connecting @xmath8 and @xmath7 with color  @xmath123 , requiring that @xmath124 for all @xmath47 . a random walk on this graph",
    "is a process that starts from @xmath125 , and after arriving at some state @xmath8 , traverses the edge @xmath126 with probability @xmath127 .",
    "let @xmath128 be the law of this process .",
    "a bayesian statistician observes a finite sequence of traversed colored edges and wants to predict the future trajectory of the colored random walk .",
    "we suggest how to use the @xmath0 scheme in this context .",
    "informally , in a errw - like transition , we reinforce a single edge of a specific color , while in a mediated transition , we draw a new edge with a novel color .    the bayesian model is a random sequence of colored edges @xmath129 .",
    "we use @xmath130 and @xmath131 to denote the color and vertices of @xmath132 .",
    "let @xmath11 and @xmath133 be nonatomic distributions over @xmath87 and @xmath121 , respectively , and specify @xmath3 , @xmath2 and @xmath1 as in the previous sections .",
    "let @xmath134 , @xmath135 and @xmath136 the distribution of @xmath137 corresponds to an initial graph with only 2 edges , with endpoints @xmath138 and @xmath139 , weighted by @xmath140 and @xmath141 , respectively . if the initial weighted graph @xmath17 in a @xmath0 scheme is chosen as above , the reinforcement rules in definition [ tabscheme ] produce a well - defined process even if the initial value of @xmath142 is negative . after the first transition all edges will have nonnegative weights .",
    "this choice for the initial weighted graph will be used in the present section and section  [ sufficientnesssection ] . after a path @xmath143",
    ", the probability of recrossing an edge @xmath144 , with @xmath145 and @xmath146 , is @xmath147 where @xmath148 in words , the probability of recrossing an edge is linear in the number of crossings .",
    "let @xmath149 be the set of distinct colors in @xmath150 .",
    "the conditional probability that @xmath151 , @xmath152 where @xmath153 is linear in the number of distinct colored edges adjacent to @xmath154 .",
    "the probability that @xmath155 , for any vertex @xmath156 , conditional on @xmath157 , is @xmath158 which depends linearly on the number of distinct colored edges adjacent to  @xmath7 . finally , @xmath159 and @xmath160",
    "the following property is a direct consequence of this definition .",
    "[ eqd ] the sequence @xmath9 of @xmath16-valued states visited by @xmath161 is identical in distribution to a @xmath0 scheme initiated at @xmath73 , with @xmath17 everywhere null except at @xmath162 and @xmath163 .",
    "furthermore , given a @xmath0 scheme with an arbitrary initial graph @xmath17 , it is possible to construct a colored @xmath0 scheme with a closed - form predictive distribution such that the equality stated in proposition  [ eqd ] holds",
    ". this would require changing the definition of @xmath164 in a way that preserves the reinforcement scheme .",
    "[ exc ] let @xmath165 be a colored path , with @xmath166 , and let @xmath167 be the probability of the event @xmath168 suppose @xmath169 , for some permutation @xmath170 , is also a colored path starting at @xmath73 .",
    "then , @xmath171    this result , related to proposition  [ markovexchangeability ] , establishes a probabilistic symmetry between paths that can be mapped to each other by permuting the order of edges crossed , and applying certain automorphisms to @xmath16 and @xmath121 .",
    "proposition [ exc ] gives rise to the following de finetti representation .",
    "[ definetticolor ] there exists a mixture of colored random walks on weighted multigraphs @xmath172 , with @xmath173 and @xmath174 , and independent processes @xmath175 and @xmath176 , such that the sequence of colored edges @xmath177 , defined by @xmath178 is identical in distribution to @xmath161 .",
    "the proof of proposition  [ definetticolor ] constructs the discrete process @xmath179 , which will now be used to show that the @xmath0 scheme has large support .",
    "the law of @xmath179 can be mapped bijectively to the exchangeable law of the sequence of @xmath73-blocks in the process , which in the present section and the next are defined as sequences of labeled edges .",
    "therefore , the de finetti measure of @xmath179 uniquely identifies the de finetti measure of the @xmath73-blocks , and vice versa .",
    "we denote the random distribution of the @xmath73-blocks @xmath180 .",
    "note that the space of @xmath73-blocks is discrete because @xmath181 and @xmath182 are integer - valued .",
    "we show that the law of @xmath180 has full weak support . on the basis of proposition  [ eqd ]",
    ", we then conclude that the @xmath73-block de finetti measure induced by the @xmath68 scheme also has full weak support .",
    "the next proposition is proven for @xmath161 as defined in this section ; the result can be extended to any analogous reinforced process corresponding to a specific @xmath68 scheme .",
    "[ largesupportprop ] let @xmath183 be the @xmath73-block distribution induced by a colored random walk on an arbitrary weighted multigraph with vertices and colors in @xmath184 , in which the sum of weights is finite , @xmath185 . for every @xmath186 , @xmath187 and any collection of bounded real functions @xmath188 on the space of @xmath73-blocks , @xmath189 where @xmath190    the process @xmath161 also reveals a connection between the @xmath0 scheme and the errw .",
    "recall that the colored @xmath73-blocks @xmath191 in the bayesian model are exchangeable and , by de finetti s theorem , conditionally independent .",
    "consider their posterior distribution given the subsequence @xmath192 , and assume it has @xmath193 and includes @xmath194 colored @xmath73-blocks .",
    "these assumptions are only made to simplify the exposition .",
    "the limits @xmath195 for every edge @xmath196 are functions of the directing random measure for the sequence of @xmath73-blocks . from these limits , one can obtain the probability in the directing random measure of any @xmath73-block formed with edges in @xmath197 . namely , given @xmath198 and the tail @xmath170-field of @xmath161 , the probability of an @xmath73-block @xmath199 is the product @xmath200 .",
    "we can now state the connection with the errw .",
    "[ ide ] there exists an errw on a multigraph with a finite number of edges , such that the joint posterior distribution of the random variables in  ( [ natk ] ) , given @xmath198 , is identical to the distribution of the same limits in the errw .",
    "appendix c  @xcite contains a constructive proof of this proposition , in which one such errw , whose parameters depend on @xmath198 , is defined .",
    "this section provides a characterization of the colored @xmath0 scheme in terms of certain predictive sufficiencies or _",
    "sufficientness _ conditions . the first characterization of this type , for the plya urn , was proven in an influential paper by johnson  @xcite and has since been extended to other predictive schemes for discrete sequences such as the two - parameter hoppe urn  @xcite and the edge - reinforced random walk  @xcite .",
    "our result is closely related to the work of these authors and uses similar proof techniques .",
    "in addition to its clear subjective motivation , the characterization elucidates connections between the @xmath0 scheme and other popular nonparametric markov models @xcite .",
    "consider a random sequence of colored edges @xmath201 , where @xmath202 .",
    "each color in @xmath203 identifies an edge .",
    "we assume @xmath203 is a mixture of random walks on weighted and colored multigraphs , in the sense of proposition [ definetticolor ] , which visits more than 2 vertices with probability 1 .",
    "it will be shown that , if the predictive distribution of @xmath204 satisfies certain conditions , then the process is a @xmath0 scheme .",
    "consider a path @xmath205 and define : @xmath206 these variables describe : ( i ) how many times @xmath207 has been visited and whether it coincides with @xmath208 , ( ii ) how many times an edge @xmath209 has been traversed , ( iii ) the number of observed colors and ( iv ) the degree of @xmath210 in the multigraph constructed by all distinct colored edges in @xmath211 . in summary",
    ", they are easily interpretable",
    ". we also use @xmath212 to denote the number of distinct @xmath16-valued states in @xmath213 , and the indicator @xmath214 , which is equal to 1 if @xmath209 is a loop and @xmath215 otherwise",
    ".    we can now define sufficientness conditions for @xmath201 .",
    "the process satisfies condition 1 if there exist functions @xmath216 and @xmath217 such that for every @xmath218 incident on @xmath207 , @xmath219 in words , the probability of making a transition through an edge @xmath220 in @xmath211 depends on the number of times the edge has been crossed and the number of visits to @xmath207 .",
    "the process satisfies condition 2 if there is a function @xmath17 such that @xmath221 that is , the probability of a transition through a new edge is a function of the number of observed edges @xmath222 incident on @xmath207 , and the number of visits to @xmath207 .",
    "condition 3 requires that some function @xmath223 satisfies , for every @xmath224 , @xmath225\\\\[-8pt ] & & \\qquad= h \\bigl(\\tau(z_n),\\eta(v , z_n ) + \\mathbf{1}_{x_n = v } \\bigr)\\in(0,1).\\nonumber\\end{aligned}\\ ] ] if a new edge will be traversed , then the conditional probability that the path will go to an already seen vertex depends solely on the number of edges out of said vertex and the overall number of observed edges .",
    "finally , the process satisfies condition  4 if there is a function @xmath226 , such that @xmath227\\\\[-8pt ] & & \\qquad = q \\bigl(\\tau(z_n),\\rho(z_n ) \\bigr)\\in(0,1);\\nonumber\\end{aligned}\\ ] ] that is , the conditional probability that the path will go to an unseen vertex is a function of the total number of edges and vertices .",
    "the main result of this section can be divided into two lemmas , the first of which depends only on 3 of the conditions above .",
    "[ suff1 ] if the process @xmath203 satisfies conditions 1 , 2 and 3 , there exist @xmath228 and @xmath229 such that @xmath230    [ suff2 ] if the process @xmath203 satisfies conditions 1 , 2 , 3 and 4 , there exist @xmath29 and @xmath231 such that @xmath232 for @xmath233 , @xmath234 and @xmath235 .",
    "the characterization of the @xmath0 scheme with colors follows from the two previous lemmas .",
    "[ sufficientness ] if the process @xmath203 satisfies conditions 1 , 2 , 3 and 4 , then there exist @xmath29 , @xmath228 and @xmath236 , such that the conditional transition probabilities of the process @xmath203 , given any path that visits more than 2 vertices , are equal to those in the @xmath0 scheme with colors @xmath161 .",
    "we provide an expression for the law of the species sampling sequence @xmath91 , defined in section [ representationssection ] .",
    "recall that the process takes values on @xmath237 , and consider a fixed path @xmath238 .",
    "let @xmath239 be the number of transitions in @xmath238 between @xmath8 and @xmath7 in either direction and @xmath240 .",
    "for each pair @xmath241 , we introduce @xmath242 for the number of errw - like transitions [ panel ( a ) , figure  [ mechanism ] ] between @xmath8 and @xmath7 in either direction .",
    "let @xmath243 be the number of times that the latent path traverses the edge @xmath244 in either direction , let @xmath245 be the number of mediated transitions , and let @xmath246 be the number of times that @xmath247 is traversed .",
    "note that @xmath248 , @xmath249 and @xmath246 are functions of @xmath238 and @xmath250 .",
    "we will also need @xmath251 , where @xmath17 is the initial weighted graph .",
    "given @xmath252 and @xmath238 , we know the number of transitions out of @xmath50 and out of @xmath253 in the latent path .",
    "each transition adds a factor to the denominator of the probability of a latent path , which increase by a fixed amount , @xmath254 or  @xmath101 , between occurrences .",
    "similarly , given @xmath252 , we know the number of times that @xmath244 is traversed ; each transition adds a factor in the numerator , and these factors are sequentially reinforced by a fixed amount @xmath1 .",
    "finally , @xmath247 is traversed @xmath246 times , and this contributes a factor @xmath255\\alpha\\beta)$ ] to the numerator of the probability of the latent path .",
    "we can write @xmath256 , where @xmath257 is the total probability of all latent paths consistent with @xmath258 .",
    "taking into account that the factors listed in the previous paragraph are common to all latent paths with a given @xmath259 , we obtain @xmath260 where we use pitman s notation for factorial powers @xmath261 the function @xmath262 is a sum with as many terms as the possible latent paths consistent with @xmath263 .",
    "the term corresponding to a specific latent path is the product of those factors that appear in the numerator of the latent path probability and correspond to errw - like transitions . for every pair of states @xmath264",
    ", there are @xmath265 factors , but their sequential reinforcement depends on the order in which @xmath265 errw - like and @xmath266 mediated transitions appear in a specific latent path . summing these factors over all possible orders , one pair of states at a time , we can factorize @xmath267 , @xmath268 where @xmath269 and @xmath270    [ recursion ] the function @xmath271 satisfies the following recursion for all @xmath272 , @xmath273\\\\[-8pt ] & & { } + f_{e,\\beta}(n-1,k-1 ) \\bigl[e-1+\\beta k+(1-\\beta)n\\bigr],\\nonumber\\end{aligned}\\ ] ] where we set , for all @xmath274 , @xmath275    the recursive representation allows one to compute @xmath276 quickly . in order to obtain the values of @xmath277 for every @xmath278 , where @xmath279 is an arbitrarily selected integer and @xmath280 , it is sufficient to solve ( [ soleq ] ) fewer than @xmath281 times .    in the next proposition",
    ", we provide a closed - form solution for @xmath271 in terms of the generalized lah numbers , a well - known triangular array  @xcite .",
    "[ generalizedlah ] let @xmath282 be the generalized factorial of @xmath283 of order @xmath284 and increments @xmath285 , namely @xmath286 with @xmath287 .",
    "the _ generalized lah numbers _ @xmath288 ( sometimes referred to as generalized stirling numbers ) , are defined by @xmath289 where @xmath290 .",
    "[ recursionsolution ] for any @xmath291 and @xmath292 the function @xmath271 coincides with @xmath293 where @xmath294 and @xmath295",
    "in this section we introduce a gibbs algorithm for performing bayesian inference with the @xmath0 scheme given the trajectory of a reversible markov chain @xmath4 . on the basis of the almost conjugate structure of the prior model described in the previous sections we only need to sample the latent variables @xmath252 conditionally on the data .",
    "recall that the latent variables @xmath252 express what fraction of the transitions in @xmath4 are errw - like transitions ; cf . figure  [ mechanism ] .",
    "we want to sample from @xmath296 or equivalently from @xmath297 recall that @xmath248 and @xmath249 are functions of @xmath298 and that @xmath299 . for simplicity , and without loss of generality , we consider the case where initially @xmath44 is infinitesimal , @xmath43 , and @xmath300 otherwise .",
    "the count @xmath246 is a function of @xmath238 and therefore @xmath301 if @xmath302 and @xmath303 then we can write @xmath304 $ ] , where @xmath305 in other words , if we consider the joint distribution of three variables , @xmath306 , @xmath307 and @xmath308 , @xmath309 where @xmath310 and @xmath311 are the distributions of @xmath312 and @xmath313 , then the marginal law of @xmath314 coincides with @xmath315 .",
    "we note that sampling from @xmath316 is simple , because the variables @xmath317 are conditionally independent , and that sampling from @xmath318 is straightforward . the random variables @xmath319 and @xmath308 conditionally on @xmath314 are independent with dirichlet and gamma distributions .",
    "finally , we use these conditional distributions to construct a gibbs sampler for @xmath320 . in any markov chain monte carlo algorithm",
    ", it is important to ensure mixing . in appendix d",
    ", we derive an exact sampler for @xmath321 which uses a coupling of the gibbs markov chain just defined .",
    "the method is related to coupling from the past  @xcite .",
    "we performed simulations with the exact sampler to check the convergence of the proposed gibbs algorithm .",
    "species sampling problems have a long history in ecological and biological studies .",
    "the aim is to determine the species composition of a population containing an unknown number of species when only a sample drawn from it is available .",
    "a common statistical issue is how to estimate species richness , which can be quantified in different ways .",
    "for example , given an initial sample of size @xmath284 , species richness might be quantified by the number of new species we expect to observe in an additional sample of size @xmath5 . it can be alternatively evaluated in terms of the probability of discovering at the @xmath322th draw a new species that does not appear across the previous @xmath323 observations ; this yields the discovery rate as a function of the size of an hypothetical additional sample .",
    "these estimates allow one to infer the coverage of a sample of size @xmath324 , in other words , the relative abundance of distinct species observed in a sample of size @xmath324 .    a review of the literature on this problem can be found in bunge and fitzpatrick  @xcite .",
    "lijoi et al .",
    "proposed a bayesian nonparametric approach for evaluating species richness , considering a large class of exchangeable models , which include as special case the two - parameter hoppe urn  @xcite .",
    "see also lijoi et al .",
    "@xcite and favaro et al .",
    "@xcite for a practitioner - oriented illustration using expressed sequence tag ( est ) data obtained by sequencing cdna libraries .",
    "we illustrate the use of the @xmath0 scheme in species sampling problems .",
    "in particular , we evaluate species richness in molecular dynamics simulations",
    ".      the data we analyze come from a series of recent studies applying markov models to protein molecular dynamics simulations ( @xcite , and references therein ) .",
    "these computer experiments produce time series of protein structures .",
    "the space of structures is discretized , such that two structures in a given state are geometrically similar ; this yields a sequence of species which correspond to conformational states that the molecule adopts in water .",
    "we apply the @xmath0 scheme to perform predictive inference of this discrete time series .",
    "we analyze two datasets .",
    "the first is a simulation of the alanine dipeptide , a  very simple molecule .",
    "the dataset consists of 25,000 transitions , sampled every 2 picoseconds , in which 104 distinct states are observed . in this case",
    "the 50 most frequently observed states constitute 85% of the chain and each of the 104 observed states appears at least 12 times .",
    "the second dataset is a simulation of a more complex protein , the ww domain , performed in the supercomputer anton @xcite .",
    "this example illustrates the complexity of the technology and the large amount of resources required for simulating protein dynamics _ in silico_. it also motivates the need for suitable statistical tools for the design and analysis of these experiments . in this dataset",
    "1410 distinct states are observed in 10,000 transitions , sampled every 20 nanoseconds .",
    "many of the states are observed only a few times ; in particular we have 991 states that have been observed fewer than 4 times and 547 states that appear only once .      to apply the @xmath0 scheme it is necessary to tune the three parameters .",
    "we consider the initial weights @xmath17 everywhere null except for @xmath43 and @xmath44 infinitesimal .",
    "the parameters @xmath3 and @xmath2 affect the probability of finding a novel state when the latent process reaches @xmath50 , while the parameter @xmath1 tunes the degree of dependence between the random transition probabilities .",
    "we recall that in the extreme case of @xmath56 the sequence @xmath325 is exchangeable and the random transition probabilities out of the observed states become identical .",
    "we proceed by approximating the marginal likelihood of the data for the set of parameters @xmath0 , where @xmath326 , @xmath327 and @xmath328 .",
    "we iteratively drew samples , under specific @xmath0 values , from the conditional distribution @xmath329 using the gibbs algorithm defined in the previous section .",
    "note that @xmath330 where the last equality is obtained counting the possible values of @xmath252 .",
    "we compare the models on the basis of approximations @xmath331 of the marginal probabilities @xmath332 across prior parameterizations .",
    "the samples we drew from @xmath329 are used to compute monte carlo estimates @xmath333 of @xmath334 . recall that the probability @xmath335 can be computed using the analytic expressions derived in section [ lawsection ] . using @xmath336",
    "we compute the estimates @xmath337 and obtain standard errors by bootstrapping .    in table",
    "[ modelcomparisons ] , we report the logarithm of these estimates for each model , shifted by a constant such that the largest entry for each dataset is 0 .",
    "we only show , due to limits of space , these results for the @xmath3 values associated with the maxima of @xmath338 across the considered parameterizations .",
    "the difference between two entries corresponds to a logarithmic bayes factor between two models .",
    "the values in table  [ modelcomparisons ] indicate that in each dataset there is one model for which there is strong evidence against all others .",
    "this also holds when several values of @xmath3 are considered . for each dataset , we have highlighted the optimal parameters .",
    "the degenerate cases @xmath57 and @xmath56 were also included in the comparisons but are not shown in table [ modelcomparisons ] . the difference in the marginal log - likelihood between models with @xmath57 and @xmath339 is negligible . on the other hand , shifting the parameter @xmath1 from 0.97 to 1 in the optimal model for dataset 2 decreased the log - likelihood by 7565 , as this model is exchangeable and does not capture the markovian nature of the data .",
    "these observations suggest that a fully bayesian treatment with a hyper - prior over a grid of possible @xmath0 combinations would produce similar results .",
    "@llrcrl@ & + & + @xmath340 & & & & & +   + [ 4pt ] 0.03 & @xmath341 & & & @xmath342 & @xmath343 + 0.2 & @xmath344 & @xmath345 & @xmath346 & @xmath347 & @xmath348 + 0.5 & @xmath349 & @xmath350 & @xmath351 & @xmath352 & @xmath353 + 0.8 & @xmath354 & @xmath355 & @xmath356 & @xmath357 & @xmath358 + 0.97 & @xmath359 & @xmath360 & @xmath361 & @xmath362 & @xmath363 + [ 4pt ] + [ 4pt ] 0.03 & @xmath364 & @xmath365 & @xmath366 & @xmath367 & @xmath368 + 0.2 & @xmath369 & @xmath370 & @xmath371 & @xmath372 & @xmath373 + 0.5 & @xmath374 & @xmath375 & @xmath376 & @xmath377 & + 0.8 & @xmath378 & @xmath379 & @xmath380 & @xmath381 & @xmath382 + 0.97 & @xmath383 & @xmath384 & @xmath385 & @xmath386 & @xmath387 +    summarizing , the use of a three - dimensional grid and the computation of monte carlo estimates allows one to effectively obtain a parsimonious approximation of the likelihood function that , in our case , supported selection of single parameterizations .",
    "the main results of our analysis are summarized in figure [ posteriorplots ] .",
    "conditional on each sample @xmath388 , generated under the selected @xmath0 parametrization , we simulated 20,000 future transitions using our predictive scheme .",
    "once @xmath252 is    , given the data @xmath4 .",
    "bottom : box plot of the fraction of time spent at each state in these simulations .",
    "only the twenty most populated states are shown ; below the dashed line , we show the fraction of time spent at states not observed in the dataset . ]",
    "conditionally sampled , the predictive simulations become straightforward with the reinforcement scheme . to provide a measure of species richness and the associated uncertainty ,",
    "we histogram the number of new states discovered in our simulations in figure [ posteriorplots ] .",
    "only a few states are predicted to be found for dataset 1 , while a large number of new states are predicted for dataset  2 .",
    "this result is not surprising because the alanine dipeptide dataset has a limited number of rarely observed states , while in the ww domain data a significant number of states are observed once .",
    "this result also seems consistent with the selected values of @xmath3 and @xmath1 in these two experiments .    as previously mentioned",
    "the @xmath0 scheme is a bayesian tool for predicting any characteristic of the future trajectories @xmath389 .",
    "the bottom panels in figure [ posteriorplots ] show confidence bands for the predicted fractions of time that will be spent at the most frequently observed states in the next 20,000 transitions .",
    "each box in the plots refers to a single state and shows the quartiles and the 10th and 90th percentiles of the predictive distribution ; states are ordered according to their mean observed frequency .",
    "we only show these occupancies for the 20 most populated states , and below the dashed line , we show the total occupancy for states that do not appear in the original data . in the ww domain example , the simulation is expected to spend between 2.5% and 5% of the time at new states .    , where @xmath5 is the length of the validation set and @xmath4 is the training set .",
    "the blue line shows the mean of these samples .",
    "the red line shows the actual number of new species found in the validation set .",
    "note that in the right panel , the lines overlap due to the small separation between them . ]    to assess the predictive performance of the model we split each dataset into a training set and a validation set .",
    "the rationale of this procedure is identical to routinely performed cross validations for i.i.d",
    ". data . in our setting ,",
    "the training and validation sets are independent portions of a homogeneous markov chain .",
    "the first part of the procedure , which uses only the training set , includes selection of the @xmath0 parameters and posterior computations .",
    "then , we contrast bayesian predictions to statistics of the validation set .",
    "overall , this approach suggests that our model generates reliable predictions .",
    "figure  [ posteriorcrossvalidation ] shows histograms for the number of new species found in predictive simulations of equal length as the validation set . in each panel ,",
    "the blue line is the bayes estimate and the red line corresponds to the number of species that was actually discovered in the validation set .",
    "this approach also supports the inference reported with box plots in figure  [ posteriorplots ] .",
    "we repeated the computations for deriving the results in figure [ posteriorplots ] using only the training data , and considering a future trajectory equal in length to the validation data . in this case , 37 out of 42 of the true state occupancies in the validation set were contained in the 90% posterior confidence bands .",
    "we introduced a reinforced random walk with a simple predictive structure that can be represented as a mixture of reversible markov chains .",
    "the model generalizes exchangeable and partially exchangeable sequences that have been extensively studied in the literature .",
    "our nonparametric prior , the de finetti measure of the @xmath0 scheme , can be viewed as a distribution over weighted graphs with a countable number of vertices in a possibly uncountable space @xmath16 . as is the case for other well - known bayesian nonparametric models such as the dirichlet process  @xcite , the hierarchical dirichlet process  @xcite and the infinite hidden markov model  @xcite ,",
    "it is possible to represent our model as a function of two independent components , a species sampling sequence @xmath390 and a process @xmath391 which determines the species locations .",
    "this property is fundamental in applications including dirichlet process mixture models and the infinite hidden markov model .",
    "a natural extension of our model , not tackled here , is the definition of hidden reversible markov models .",
    "a simple construction would consist of convolving our vertices with suitable density functions .",
    "we hope reversibility can be an advantageous assumption in relevant applications ; in particular we think reversibility can be explored as a tool for the analysis of genomic data and time series from single - molecule biophysics experiments .",
    "proof of proposition  [ recurrence ] consider the latent process on @xmath18 .",
    "the transition probability from @xmath392 to @xmath393 with @xmath394 is of the form @xmath395 . between successive visits to @xmath73 ,",
    "the denominator @xmath396 is increased by at most @xmath101 , and the numerator may only increase .",
    "assume that almost surely , the process visits @xmath73 infinitely often .",
    "there exist @xmath397 , such that if @xmath398 is the event that we do not traverse @xmath399 between the @xmath284th and @xmath5th visits to @xmath73 , @xmath400,\\ ] ] which goes to 0 as @xmath401 .",
    "therefore the edge @xmath399 is a.s .",
    "traversed infinitely often .",
    "thus , if @xmath402 is a.s .",
    "visited infinitely often , by induction the process a.s .",
    "returns infinitely often to all visited states .",
    "suppose a state in @xmath16 is visited infinitely often a.s .",
    ", then the process visits @xmath50 infinitely often by the previous argument .",
    "otherwise , the process must visit an infinite number of states in @xmath16 , and since the set of pairs @xmath403 with a positive initial weight @xmath20 is a finite subset of @xmath24 , we must go through @xmath50 an infinite number of times .",
    "we conclude that @xmath50 is visited infinitely often a.s .",
    "and therefore the process returns to every state visited infinitely often .",
    "if @xmath69 , then the edge @xmath247 is crossed infinitely often , and we see an infinite number of distinct states .",
    "proof of proposition  [ partialexchangeability ] for @xmath404 there is a latent variable @xmath405 that determines in which of the three ways outlined in figure [ mechanism ] the transition @xmath13 proceeded .",
    "the probability of @xmath406 is the sum of its joint probability with every latent sequence @xmath407 .",
    "we will show that there is a one - to - one map @xmath408 of the latent sequences such that , letting @xmath409 , one has @xmath410\\\\[-8pt ] & & \\qquad = p\\bigl(z_{1}=x'_1,\\ldots , z_{n}=x'_n;u_{1}=u_{1}',\\ldots , u_{n-1}=u_{n-1}'\\bigr ) .",
    "\\nonumber\\end{aligned}\\ ] ] the proposition follows from this claim .",
    "let @xmath283 denote the transposition such that @xmath411 .",
    "define @xmath412 .",
    "the map @xmath408 is defined so that for any @xmath413 and @xmath414 , satisfying @xmath415 for some @xmath8 and @xmath7 , if @xmath416 then @xmath417 . note that we can define the joint probability of @xmath418 and @xmath419 through a reinforcement scheme identical the one defined in section  [ tabschemesection ] . precisely , the probability of each transition and associated category is of the form @xmath420 where @xmath421 .",
    "the factors @xmath422 , which appear in the denominator when @xmath423 , are reinforced by @xmath254 between successive visits to @xmath424 .",
    "therefore , their product only depends on the number of mediated transitions , which is invariant under  @xmath408 .",
    "similarly , factors @xmath31 increase by @xmath425 between successive occurrences ; their product is identical when we compute the two sides of ( [ ad ] ) because the number of mediated transitions with discovery remains identical .",
    "also , the factors @xmath426 in the denominators increase by @xmath101 between successive occurrences of the same @xmath16 state ; their product is identical when we compute the two sides of ( [ ad ] ) because the number of transitions out of any state @xmath8 ( or toward @xmath8 ) remains identical .",
    "finally , we need to prove the identity between @xmath427 and @xmath428 the identity between ( [ ads1 ] ) and ( [ ads2 ] ) follows by combining the definitions of @xmath82 and @xmath408 with the reinforcement mechanism .",
    "specifically , the factors @xmath429 and @xmath430 are increased by @xmath1 between successive occurrences . since @xmath429 appears as many times in the left - hand side of ( [ ad ] ) as @xmath430 does in the right - hand side of ( [ ad ] ) , the product of these factors is identical in each case .",
    "the remaining factors @xmath20 may increase by different amounts between successive occurrences .",
    "their product is a function of the subsequence of @xmath431 with indices @xmath432 . by the definition of @xmath408 ,",
    "this subsequence is the same in the left and right - hand sides of ( [ ad ] ) , which completes the proof of our claim .",
    "proof of proposition  [ representationtheorem ] let @xmath433 be a @xmath0 scheme .",
    "the process @xmath434 returns to @xmath435 infinitely often a.s .",
    "let @xmath436 be the @xmath71th @xmath435-block .",
    "define @xmath437 and @xmath438 .",
    "proposi - tion  [ partialexchangeability ] implies @xmath439 .",
    "let @xmath440 be the last element of a vector @xmath8 .",
    "define @xmath441 this limit exists a.s . because @xmath34 is recurrent in @xmath442 ; therefore , the sequence of blocks that form @xmath443 is conditionally i.i.d . from a distribution which a.s .",
    "assigns positive probability to blocks containing @xmath34 , which implies @xmath443 visits @xmath34 after a finite time a.s .",
    ", at which point the limit settles .    in lemma  [ markovexchangeabilityofw ]",
    "we show that @xmath116 is markov exchangeable and recurrent .",
    "therefore , by de finetti s theorem for markov chains ( [ definettistheoremformarkovchains ] ) , it is a mixture of markov chains . finally , by lemma [ iidorderdoesntmatter ]",
    ", we obtain the representation claimed in the proposition .",
    "[ markovexchangeabilityofw ] without loss of generality , let @xmath444 .",
    "the process @xmath109 is markov exchangeable and returns to every state in @xmath84 infinitely often a.s .",
    "the recurrence of @xmath91 , which is a consequence of proposition  [ recurrence ] , implies the recurrence of @xmath116 .",
    "thus , we have left to show markov exchangeability .",
    "the sequence @xmath445 can be mapped through @xmath82 to @xmath446 , which is a species sampling sequence for the @xmath0 scheme .",
    "take any sequence @xmath447 and let @xmath448 .",
    "we have latexmath:[\\[\\begin{aligned } \\label{probw } & & p(w_1=w_1,\\ldots , w_n = w_n)\\nonumber\\\\ & & \\qquad= p(z_1=z_1,\\ldots , z_n = z_n ) \\\\ & & \\qquad\\quad{}\\times p(w_1=w_1,\\ldots , w_n = w_n     consider any pair of sequences @xmath447 and @xmath450 related by a transposition of two blocks with identical initial and final states .",
    "proposition  [ partialexchangeability ] implies @xmath451 we have left to show that the second factor on the right - hand side of ( [ probw ] ) is identical for @xmath447 and @xmath450 .",
    "the identity of the conditional distribution of @xmath452 given @xmath453 equal to @xmath454 or equal to @xmath455 proves the lemma .",
    "[ iidorderdoesntmatter ] the process @xmath456 has the same distribution as @xmath9 .    by definition @xmath457 .",
    "note that@xmath458 is an i.i.d .",
    "sequence , independent from @xmath459 , and @xmath460 .",
    "these facts imply that @xmath461 .",
    "proof of proposition  [ reversibility ] let @xmath462 be the @xmath25-blocks of the @xmath0 scheme . consider a map @xmath463 on the @xmath25-blocks space ; if @xmath464 , then @xmath465",
    ". we can observe , following the same arguments used for proving proposition [ partialexchangeability ] , that for any @xmath25-block @xmath466 and any integer @xmath284 , @xmath467    let @xmath468 be a random measure distributed according to the de finetti measure of the @xmath25-blocks .",
    "the above expression and the equality @xmath469 where @xmath470 is a generic measurable set , imply that a.s .",
    "the distance in total variation between @xmath468 and @xmath471 is null .",
    "we are grateful to an associate editor and three referees for their constructive comments and suggestions .",
    "we would like to thank de shaw research  @xcite for providing the molecular dynamics simulations of the ww domain .",
    "the markov models analyzed in section [ applications ] were generated by kyle beauchamp , using the methodology described in  @xcite .",
    "we would also like to thank persi diaconis and vijay pande for helpful suggestions ."
  ],
  "abstract_text": [
    "<S> we introduce a three - parameter random walk with reinforcement , called the @xmath0 scheme , which generalizes the linearly edge reinforced random walk to uncountable spaces . </S>",
    "<S> the parameter @xmath1 smoothly tunes the @xmath0 scheme between this edge reinforced random walk and the classical exchangeable two - parameter hoppe urn scheme , while the parameters @xmath2 and @xmath3 modulate how many states are typically visited . resorting to de finetti s theorem for markov chains </S>",
    "<S> , we use the @xmath0 scheme to define a nonparametric prior for bayesian analysis of reversible markov chains . </S>",
    "<S> the prior is applied in bayesian nonparametric inference for species sampling problems with data generated from a reversible markov chain with an unknown transition kernel . as a real example </S>",
    "<S> , we analyze data from molecular dynamics simulations of protein folding .    , </S>"
  ]
}