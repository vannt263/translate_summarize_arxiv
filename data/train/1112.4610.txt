{
  "article_text": [
    "historically , the development of combinatorics for rna secondary structures @xcite has been intimately related to the development of _ algorithms _ for rna minimum free energy ( mfe ) secondary structure @xcite . in particular , _ counting _ the number of secondary structures for sequence of length @xmath3 is essentially equivalent to computing the boltzmann partition function , defined by @xmath4 , where the sum is taken over all secondary structures @xmath5 , the energy of @xmath5 is denoted by @xmath6 , @xmath7 cal / mol is the universal gas constant , and @xmath8 absolute temperature . or if the temperature @xmath9 , then the partition function is exactly equal to the number of secondary structures . ]",
    "complex analysis is used to obtain the asymptotic enumeration results described in this article and related articles mentioned in the introduction . in particular , given a complex generating function @xmath10 , it is well - known from introductory complex analysis that @xmath11 converges in a circular region about the point of expansion out to the dominant , or nearest , singularity @xmath12 , and thus the asymptotic order of magnitude of @xmath13 is approximately @xmath14 .",
    "theorem @xcite states that if @xmath15 , where @xmath16 , @xmath17 is not a positive integer , and @xmath18 is analytic in a disk of radius greater than @xmath12 , then @xmath19 .",
    "this result was generalized by bender @xcite , corrected by meir and moon @xcite , and further extended by flajolet and odlyzko @xcite and by drmota , lalley and woods ( each of the latter worked independently )  see the exposition in @xcite for discussion and references .",
    "in @xcite , stein and waterman proved that the asymptotic number of secondary structures is @xmath0 .",
    "since that time , a number of additional results on the combinatorics of rna structures have been obtained . in @xcite , hofacker",
    "derived a number of asymptotic results on the number of structures , expected number of base pairs , etc . for rna secondary structures . observing a correspondence with involutions , haslinger and",
    "stadler @xcite provided an upper bound on the number of _ bi - secondary _ structures , i.e. structures having non - nested pseudoknots that can be presented as a union @xmath20 of disjoint secondary structures , and rodland @xcite studied the asymptotic number of a number of classes of pseudoknotted structures . building on a remarkable and pioneering paper of harer and zagier @xcite , vernizzi et al .",
    "@xcite classified pseudoknotted rna structures according to topological genus @xmath21 , and then applied the work of harer and zagier to obtain recurrence relations for the number of pseudoknotted structures of genus @xmath21 . in @xcite ,",
    "saule et al . provided a summary table of the asymptotic number of pseudoknotted structures structures , with respect to various allowed pseudoknots , and established the asymptotic number of pseudoknotted structures , with no restriction . in @xcite ,",
    "li and reidys determined the asymptotic number of hybridizations of two interacting rna structures . moving away from counting the number of structures , yoffe et al .",
    "@xcite and clote et al .",
    "@xcite determined the asymptotic expected distance between the @xmath22 and @xmath23 ends of rna sequence , where the @xmath22 to @xmath23 distance of a given structure @xmath5 on sequence @xmath24 is defined as the minimum number of backbone or base - pairing edges in a minimum length path from @xmath25 to @xmath26 .    in @xcite",
    ", clote computed the asymptotic number @xmath2 of _ saturated _ structures , defined by zuker @xcite as those for which no base pair can be added without violating the definition of secondary structure . in @xcite , clote et al .",
    "provided another proof for the asymptotic number of saturated structures , which additionally yielded the asymptotic expected number of base pairs @xmath27 for saturated structures .",
    "an overview of methods for rna enumerative combinatorics is given in lorenz et al .",
    "@xcite , where additionally it is shown that the asymptotic number of _ shapes _ of secondary structures for a length @xmath3 sequence is @xmath28.}}\\,}{\\,\\mbox{\\bf\\texttt{[}}\\,}{\\,\\mbox{\\bf\\texttt{]}}\\,}{\\,\\mbox{\\bf\\texttt{[}}\\,}{\\,\\mbox{\\bf\\texttt{]}}\\,}{\\,\\mbox{\\bf\\texttt{]}}\\,}$ ] .",
    "the asymptotic number of shapes for a length @xmath3 sequence yields the run time for the giegerich lab software rnashapes on length @xmath3 sequences , since steffen et al .",
    "@xcite report that rnashapes runs in time @xmath29 for @xmath30 sequences , each of length at most @xmath3 and @xmath31 shapes . ] in @xcite hofacker et al",
    ". showed that the asymptotic number of _ canonical _ secondary structures ( those having no isolated base pair ) is @xmath32 , a result that was confirmed by a different method in clote et al .",
    "@xcite , where additionally the expected number of base pairs was shown to be @xmath33 .",
    "a _ locally optimal _ , or _ kinetically trapped _",
    ", secondary structure @xmath5 is one for which no secondary structure @xmath8 , obtained from @xmath5 by the removal or addition of a single base pair , has lower energy .",
    "it follows that saturated structures are exactly the kinetically trapped structures with respect to the _ nussinov energy model _",
    "@xcite , in which each base pair receives a stabilizing energy contribution of @xmath1 . in this paper",
    ", we consider the _ base stacking energy _ model , in which each stacked base pair receives a stabilizing energy contribution of @xmath1 . here , the base pair @xmath34 in secondary structure @xmath5 is defined to be a stacked base pair , provided that @xmath35 is also a base pair in @xmath5 ",
    "i.e. provided that there is an outer base pair that provides a stabilizing stacking energy . in @xcite ,",
    "evers and giegerich describe a dynamic programming algorithm to enumerate all structures that are locally optimal with respect to the base stacking energy model ; i.e. those structures in which no stem can be extended .",
    "the authors called such structures `` saturated '' . when a strictly positive minimal value is specified for the length of every stem , a structure",
    "is saturated in the sense of zuker @xcite if and only if it is saturated in the sense of evers and giegerich @xcite . however , as mentioned in @xcite , when the lengths of stems are not constrained , there are structures that are saturated in the sense of evers and giegerich @xcite , but which are not saturated in the sense of zuker @xcite . for clarity of exposition , we will call a secondary structure g - saturated if no stem can be extended . in this paper , we give an enumerative framework based on weighted plane trees that allows us to enumerate g - saturated structures ( as well as recover the enumeration of secondary structures and of saturated structures ) .",
    "we also consider analogous problems for structures with annotated single - stranded , stacked nucleotides ( also called dangles ) .",
    "the plan of this paper is as follows . in section",
    "[ section : definitions ] , we define the notions of secondary structure and context free grammar , and provide context free grammars for various classes of secondary structures considered in the paper . in that section , we show that the asymptotic number of secondary structures with annotated dangles , as computed in the partition function of the markham - zuker software unafold @xcite , is @xmath36 , exponentially larger than the number of all secondary structures @xmath0 , previously established by stein and waterman @xcite .",
    "this new result provides a partial explanation for m. zuker s observation ( personal communication ) that unafold requires substantially more computation time when dangles are included . in section  [ section : computationalresults ] , we describe the computation of secondary structure melting curves with respect to the nussinov energy model and the base stacking energy model .",
    "figure  [ fig : meltingcurve ] shows that folding is more cooperative in the base stacking energy model . in section  [ section : eric1 ] , we describe the correspondence between rna secondary structures and plane trees , and then give generating functions for the number of secondary structures and locally optimal secondary structures , with respect to the nussinov model and the base stacking energy model . in section  [ section : eric2 ] , we give asymptotic results on the number of secondary structures and locally optimal secondary structures , as well as their expected number of base pairs . in section  [ section :",
    "eric3 ] , we give similar asymptotic results when annotations for external dangles are included for each type of structure .",
    "finally section  [ section : discussion ] summarizes our main contributions .",
    "[ def : secstr ] an rna secondary structure for a given rna sequence @xmath37 of length @xmath3 is defined to be a set @xmath5 of ordered pairs @xmath34 , with @xmath38 , such that the following conditions are satisfied .",
    ": :    \\1 .",
    "_ watson - crick and wobble pairs : _ if @xmath39 ,    then    @xmath40 .",
    ": :    \\2 .",
    "_ no base triples : _ if @xmath34 and @xmath41    belong to @xmath5 , then @xmath42 ; if    @xmath34 and @xmath43 belong to @xmath5 ,    then @xmath44 . : :    \\3 . _",
    "nonexistence of pseudoknots : _",
    "if @xmath34 and    @xmath45 belong to @xmath5 , then it is not the    case that @xmath46 .",
    ": :    \\4 .",
    "_ threshold requirement for hairpins : _",
    "if @xmath34    belongs to @xmath5 , then @xmath47 , for a    fixed value @xmath48 ; i.e. there must be at least    @xmath49 unpaired bases in a hairpin loop .",
    "for software , such as @xcite and @xcite , to predict rna secondary structure , @xmath49 is taken to be @xmath50 ; i.e. , for reasons related to steric constraints , every hairpin is required to contain at least three unpaired bases .",
    "a base pair @xmath51 is called a _",
    "link_. an element @xmath52 is said to be _ linked _ if it is involved in a link and _ free _ otherwise .",
    "a link @xmath34 is said to be _ stacked _ onto another link @xmath53 if @xmath54 and @xmath55 .",
    "a _ stem _ is a maximal sequence @xmath56 of links such that @xmath57 is stacked onto @xmath58 for @xmath59 ; the value @xmath31 is called the _ length _ of the stem . in some applications a threshold condition on stems is required :    : :    \\5 .",
    "_ threshold requirement for stems : _ each stem has length at least    @xmath60 , for a fixed value @xmath61 .    note that condition  ( 5 ) is of no effect for @xmath62 .    in this paper",
    ", we are concerned with the asymptotic number of locally optimal structures . in order to employ generating functions",
    ", we will need to assume the homopolymer model ( following a convention established by stein and waterman @xcite ) , meaning that any position can pair with any other position ( arbitrary base pairs , not only watson - crick and wobble pairs ) .",
    "we thus define a secondary structure of a _ homopolymer _ of length @xmath3 to be a set @xmath5 of base pairs @xmath34 , where @xmath63 , such that the previous conditions ( 2,3,4,5 ) are satisfied .",
    "the following notion of context free grammar is used for two reasons : _ ( 1 ) _ to provide a clean and succinct definition for rna secondary structure , with respect to a particular energy model , and _ ( 2 ) _ for certain enumeration results .",
    "see lorenz et al .",
    "@xcite for more on context free grammars and their application to combinatorics .",
    "in particular , we refer the reader to @xcite for an explanation of the dsv method used in this article , which allows us to go directly from a context free grammar to a functional equation for generating functions .",
    "[ chomskynormalform ] a context free grammar is given by @xmath64 , where @xmath65 is a finite set of nonterminal symbols ( also called variables ) , @xmath66 is a disjoint finite set of terminal symbols , @xmath67 is the _",
    "start _ nonterminal , and @xmath68 is a finite set of production rules . elements of @xmath69 are usually denoted by @xmath70 , rather than @xmath71 .    if @xmath72 and @xmath70 is a rule , then by replacing the occurrence of @xmath73 in @xmath74 we obtain @xmath75 .",
    "such a derivation in one step is denoted by @xmath76 , while the reflexive , transitive closure of @xmath77 is denoted @xmath78 .",
    "the language generated by context free grammar @xmath79 is denoted by @xmath80 , and defined by @xmath81    now , in the following sections , we give context free grammars for rna secondary structures , including structures with explicitly annotated dangles . using the correspondence between grammar and recursions for dynamic programming , each grammar corresponds to an algorithm for the partition function for secondary structures with respect to a different energy model  the nussinov model , the base stacking energy model , the turner model , the turner model with a rigorous treatment of dangles , the turner model with external dangles . for notational simplicity",
    ", we take @xmath49 , the minimum number of unpaired bases in a hairpin loop to be @xmath82 ( see condition 4 of definition [ def : secstr ] ) .",
    "it is not difficult to extend the grammar for any fixed value of @xmath49 . by replacing the rule @xmath83 by @xmath84 , where @xmath85 consists of @xmath49 occurrences of @xmath86 . ]      in @xcite , nussinov and jacobson describe a dynamic programming algorithm to compute the minimum energy structure for a simple energy model , in which each base pair constitutes an energy term of @xmath1 .",
    "it is well - known @xcite that the following unambiguous grammar @xmath87 generates all secondary structures of the homopolymer model with @xmath88 . here",
    "@xmath87 has start non - terminal symbol @xmath5 , and terminal symbols @xmath89 .",
    "the non - terminal symbol @xmath5 generates all non - empty secondary structures by using the following grammar ( or production ) rules .",
    "is equivalent to the `` tree grammar nussinov78 '' from @xcite . ]",
    "@xmath90 let @xmath91 denote the complex generating function @xmath92 , where taylor coefficient @xmath93s(z)$ ] is the number @xmath26 of secondary structures for a homopolymer of size @xmath3 . by the dsv methodology @xcite , we have @xmath94 introducing the auxilliary variable @xmath95 to count number of base pairs , we have @xmath96 where @xmath97 denotes the number of secondary structures on a length @xmath3 homopolymer , having exactly @xmath31 base pairs .",
    "it follows that @xmath98 hence @xmath99 \\frac{\\partial s(z , u)}{\\partial u } ( z,1 ) = \\sum_{k \\leq n } k s_{k , n}. \\end{aligned}\\ ] ] since @xmath100 s(z,1 ) = \\sum_{k \\leq n } s_{k , n } \\\\\\end{aligned}\\ ] ] is the number of secondary structures on a homopolymer of length @xmath3 , it follows that the asymptotic expected energy over all secondary structures of a homopolymer of length @xmath3 , with respect to the nussinov energy model , is equal to @xmath1 times the asymptotic expected number of base pairs @xmath101 \\frac { \\partial s(z , u)}{\\partial u } ( z,1 ) } { [ z^n ] s(z,1)}. \\end{aligned}\\ ] ]      in the base stacking energy model , an energy term of @xmath1 is assigned to each base pair @xmath34 of structure @xmath5 , provided that @xmath34 has an outer stacking pair ",
    "i.e. provided that @xmath102 .",
    "the set of all secondary structures is generated by the context free grammar @xmath103 with non - terminals @xmath104 , start symbol @xmath5 , and terminals @xmath89 with the following rules : @xmath105 here , the non - terminal @xmath5 generates all secondary structures , while the non - terminal @xmath8 generates all secondary structures , such that the first and last positions are base - paired together . by introducing auxilliary non - terminal @xmath8 , we can count the number of _ stacked base pairs _ , as well as the number of _ base pairs_. it is not difficult to show by induction that @xmath103 is an unambiguous grammar that generates all secondary structures , hence is equivalent to the previous grammar @xmath87 .    by the dsv methodology @xcite , the generating function @xmath106 satifies the following equations @xmath107 introducing the auxilliary variables @xmath108 responsible for counting the number of base pairs resp .",
    "number of stacked base pairs , we have @xmath109 letting @xmath110 denote the number of secondary structures on a length @xmath3 homopolymer , having @xmath31 stacked base pairs and @xmath111 base pairs , we have @xmath112 hence @xmath113   \\frac{\\partial s(z , u , v)}{\\partial u } ( z,1,1 )   & = & \\sum_{k , m",
    "\\leq n } k   s_{k , m , n}. \\end{aligned}\\ ] ] since @xmath114 is is the number of secondary structures on a homopolymer of length @xmath3 , it follows that the asymptotic expected energy over all secondary structures of a homopolymer of length @xmath3 , with respect to the base stacking energy model , is equal to @xmath1 times the asymptotic expected number of stacked base pairs , @xmath115 s(z,1,1)}.\\end{aligned}\\ ] ]      all thermodynamics - based rna secondary structure prediction algorithms use the turner nearest neighbor energy model @xcite , which contains free energy parameters for base stacking , single nucleotide dangles , hairpins , bulges , internal loops and multiloops .",
    "these parameters are obtained by a least squares fit of uv absorption data in optical melting experiments .",
    "for instance , at @xmath116 c the rna - rna stacking free energy of @xmath117 is @xmath118 kcal / mol and that of @xmath119 is @xmath120 kcal / mol @xcite .",
    "software such as mfold of zuker @xcite and rnafold from vienna rna package @xcite use the turner energy model , while alternative approaches , such as pfold @xcite use stochastic context free grammars .",
    "in @xcite , mccaskill describes a cubic time , dynamic programming algorithm to compute the partition function @xmath121 over all secondary structures @xmath5 of a given rna sequence . here",
    "@xmath69 is the universal gas constant , @xmath8 is absolute temperature , and @xmath6 is the energy of structure @xmath5 with respect to the turner energy model @xcite . by analyzing mccaskill s recursions ,",
    "we obtain the following grammar @xmath122 , which generates the same set of secondary structures as that generated by @xmath123 ; however , by permitting the classification of various types of loops , the grammar @xmath122 will permit us later to incorporate energy terms for _ dangles _ , also known as single - stranded , stacked nucleotides , into our considerations .",
    "a _ stacked base pair _ in secondary structure @xmath5 is given by base pair @xmath51 , such that @xmath124 .",
    "hairpin loop _ in secondary structure @xmath5 is given by base pair @xmath51 , such that @xmath125 are unpaired in @xmath5 .",
    "a _ left bulge _ of @xmath5 is given by base pairs @xmath126 , such that @xmath127 and @xmath128 .",
    "a _ right bulge _ of @xmath5 is given by base pairs @xmath126 , such that @xmath129 and @xmath130 .",
    "an _ internal loop _ of @xmath5 is given by base pairs @xmath126 , such that @xmath131 ; i.e. an internal loop is comprised of both a left and right bulge .",
    "a _ multiloop _",
    "@xmath132 of @xmath5 is given by base pairs @xmath133 , such that @xmath134 , where @xmath135 , and positions @xmath136 are all unpaired in @xmath5 .",
    "for any positions @xmath137 , where we do not require @xmath138 or @xmath139 to be base - paired , we say that the multiloop restricted to @xmath140 $ ] has @xmath141 components , if exactly @xmath141 of the base pairs @xmath142 are found in the interval @xmath140 $ ] .",
    "see figure  [ fig : rnasecstr2 ] for an illustration of various loops , and see @xcite for more on loop classification and the turner energy model .",
    "let grammar @xmath122 contain non - terminal symbols @xmath5 ( start ) , @xmath143 ( unpaired portion ) , @xmath144 ( base - paired portion ) , @xmath145 ( multiloop with exactly one component ) , @xmath132 ( multiloop with at least one component ) , with the following production rules @xmath146 it is not difficult to show that @xmath122 is an unambiguous context free grammar equivalent to @xmath123 , thus generates all secondary structures .",
    "the grammar @xmath122 is equivalent to the `` tree grammar wuchty98 '' as defined in @xcite , though notation is vastly different .      to the best of our knowledge ,",
    "the markham - zuker software unafold @xcite is the only current thermodynamics - based algorithm that computes the partition function for rna secondary structures in a mathematically rigorous manner , including correct treatment of energy contributions from single - stranded , stacked nucleotides  also called",
    "_ dangles_. by enlarging the set of terminal symbols , we describe here an unambiguous context free grammar @xmath147 , which generates all secondary structures with dangle explicitly given .",
    "m. zuker ( personal communication ) has mentioned that the algorithm unafold may take approximately twice as long to run when the user chooses to include treatment of dangles . as we will later see , an explanation for this phenomenon is that the asymptotic number of secondary structures , where the dangle state is explicitly annotated , is much larger than the number of secondary structures .",
    "the context free grammar @xmath147 has start symbol @xmath5 , terminal alphabet @xmath148 and non - terminal alphabet @xmath149 and rule set @xmath150 note that @xmath151 are meta - symbols , used to express the rules more succinctly .",
    "for instance , @xmath152 is an abbreviation of the rules @xmath153 and @xmath154 .",
    "the previous rules provide for an unambiguous context free grammar that generates all non - empty secondary structures , where all dangles are explicitly annotated .",
    "for instance , @xmath155 indicates that in the secondary structure @xmath156 , the first position is single - stranded nucleotide which is @xmath22 to the position @xmath157 , and stacks on the base pair @xmath158 .",
    "similarly , @xmath159 indicates that in the secondary structure @xmath160 , the last position is single - stranded nucleotide which is @xmath23 to the position @xmath161 and stacks on the base pair @xmath162 .",
    "since the turner energy parameters for hairpins , bulges and internal loops already include contributions for single - stranded positions within the loop which may dangle on the outer , closing base pair , it follows that in thermodynamics - based structure prediction , we do _ not _ consider _ internal _ dangles in hairpins , bulges or internal loops of the form @xmath163 , @xmath164 , @xmath165 , though such internal dangles are considered in multiloops .",
    "of course , _ external _ dangles of the form @xmath166 , @xmath167 and @xmath168 are considered for all types of loops .    in the grammar",
    "@xmath147 , non - terminals represent the following : @xmath5 denotes the start symbol to generate all structures , @xmath144 indicates that the leftmost and rightmost positions are paired together , @xmath132 denotes a substructure located within a multiloop , having at least one component ( the base pair closing the multiloop has been generated before non - terminal @xmath132 ) , @xmath145 denotes a substructure located within a multiloop , having exactly one component , where additionally the leftmost position is paired with a position in the substructure to the right ( though not necessarily the rightmost position ) .",
    "note that the markham - zuker approach allows dangle annotations of the rightmost unpaired nucleotide in @xmath169 of the form @xmath170 or @xmath171 ; i.e. where a single - stranded position occurring between two closing parentheses can be annotated as either a @xmath22-dangle , @xmath23-dangle , or no dangle .",
    "indeed , @xmath172 and @xmath173 and @xmath174    in the homopolymer model , where the minimum number of unpaired bases in a hairpin loop is @xmath82 , the asymptotic number of secondary structures with annotated dangles , following the markham - zuker recursions in @xcite is @xmath175    proof sketch : it is not difficult to prove by recursion on @xmath3 that the set of dangle - annotated secondary structures of length @xmath3 generated by grammar @xmath147 , is equal to the value of the markham - zuker partition function described in pages 14 - 16 of @xcite , provided that all energies are set to @xmath176 . provided that @xmath177 . ]",
    "now apply dsv methodology and analyze the dominant singularity using the flajolet - odlyzko theorem , as fully described in @xcite .",
    "( at http://bioinformatics.bc.edu/clotelab/ , we provide a detailed computation using mathematica . )",
    "@xmath178      define _ external dangle _ to mean a @xmath22-dangle , which occurs to the immediate left of an opening parenthesis , or a @xmath23-dangle , which occurs to the right of a closing parenthesis . since our work is theoretical in nature , in the construction using plane trees in section  [ section : eric3 ]",
    ", we choose to consider the case that all dangles are external ; i.e. no internal dangles , such as the earlier examples of @xmath170 and @xmath171 , are allowed .",
    "we now give a context free grammar for secondary structures having possible @xmath22-dangles and @xmath23-dangles in bulges , internal loops , multiloops and external loops .",
    "let @xmath179 be a context free grammar with start symbol @xmath5 , terminal alphabet @xmath148 and non - terminal alphabet @xmath149 and rule set @xmath180 as in grammar @xmath147 , the symbols @xmath151 are meta - symbols , to permit a concise representation of grammar rules ; moreover , the meaning of non - terminals @xmath181 is the same in @xmath179 as in @xmath147 .",
    "it can be proved by induction that grammar @xmath179 is an unambiguous context free grammar , that generates all non - empty secondary structures with explicitly annotated @xmath22-dangles and @xmath23-dangles , i.e. those dangles that are external to any type of loop , whether the loop is a hairpin , bulge , internal loop , multiloop or external loop .    in the homopolymer model , where the minimum number of unpaired bases in a hairpin loop is @xmath82 ,",
    "the asymptotic number of secondary structures with annotated external dangles , generated by grammar @xmath179 is @xmath182    proof sketch : using the dsv methodology , we analyze the dominant singularity using the flajolet - odlyzko theorem , as fully described in @xcite . at http://bioinformatics.bc.edu/clotelab/ ,",
    "we provide a detailed computation using mathematica .",
    "moreover , in the latter part of this paper , in a self - contained manner , we give an alternate proof using plane trees .",
    "@xmath178      in @xcite , we presented the following grammar which generates all saturated secondary structures in the sense of zuker @xcite ; i.e. locally optimal with respect to the nussinov energy model .",
    "let @xmath183 be the context - free grammar with nonterminal symbols @xmath184 , terminal symbols @xmath185 , start symbol @xmath5 and production rules @xmath186 it can be shown by induction on expression length that @xmath187 is the set of saturated structures , and @xmath188 is the set of saturated structures with no _ visible _ position ; i.e. external to every base pair . here ,",
    "position @xmath52 is said to be visible in a secondary structure @xmath8 if it is external to every base pair of @xmath8 ; i.e. for all @xmath189 , @xmath190 or @xmath191",
    ".    it is possible to describe context free grammars that generate ( 1 ) all secondary structures , ( 2 ) all saturated secondary structures , ( 3 ) all g - saturated secondary structures , optionally with annotated external dangles .",
    "however , the subsequent analysis of dominant singularity becomes increasingly arduous .",
    "for this reason , beginning in section  [ section : eric1 ] , we present a new , unified method using duality , marked plane trees , substitution of generating functions , and the drmota - lalley - woods theorem ( see theorem  [ thm : drmotalalleywoods ] ) .",
    "in this section , we present computational results to highlight differences between the nussinov model and the base stacking energy model , and additionally to determine the relation between folding time and number of saturated structures .",
    "figure  [ fig : meltingcurve ] displays a _ melting curve _ with respect to the nussinov energy model and the base stacking energy model . by extending ideas we first described in @xcite , we developed two algorithms ( one for the nussinov model and one for the base stacking energy model ) , each running in time @xmath192 and space @xmath193 , to compute the _ expected number _ of base pairs as a function of temperature . ) and ( [ eqn:2 ] ) , after first solving for @xmath194 [ resp .",
    "@xmath195 in equation  ( [ eqn : waterman ] ) [ resp .",
    "( [ eqn : watermanbis ] ) ] . ]",
    "figure  [ fig : meltingcurve ] clearly shows that the _ melting temperature _ @xmath196 , depends on the energy model , where @xmath196 is defined as the temperature at which , on average , half the base pairs of the high temperature structure are no longer present .",
    "moreover , as the figure shows , the base stacking energy model leads to more _ cooperative _ folding , as signified by the sigmoidal nature of the curve ( see dill and bromberg @xcite for a discussion of cooperative folding ) .",
    "additionally , the nussinov energy model and the base stacking energy model are remarkably different with respect to pseudoknotted structures , defined by dropping requirement ( 3 ) in our definition of secondary structure ; i.e. a pseudoknotted structure @xmath5 allows base pair crossings of the form @xmath197 , where @xmath46 . while tabaska et al .",
    "@xcite showed that the minimum energy pseudoknotted structure can be computed in cubic time @xmath193 by using the maximum weighted matching algorithm , provided one considers the nussinov energy model , in the preprint @xcite , sheikh et al .",
    "show that determination of the minimum energy pseudoknotted structure for the base stacking energy model is @xmath198-complete , a refinement of a result of lyngs and pedersen @xcite .",
    "it is well known that secondary structures have a tree shape , and there are several ways to formulate it . here",
    "we find convenient to associate in a bijective way to a secondary structure ( in the homopolymer formulation ) a rooted plane tree with nonnegative integers ( weights ) at the corners and at the edges .",
    "the transformation is shown in figure  [ fig : rna_tree ] .",
    "start with a secondary structure @xmath5 of length @xmath3 , the elements in the sequence being ranked from @xmath82 to @xmath3 . call _",
    "segment _ of @xmath5 a sequence @xmath200 such that @xmath201 and : ( i )  either @xmath202 , or @xmath203 and the element @xmath52 is linked , ( ii )  either @xmath204 , or @xmath205 and the element @xmath206 is linked , ( iii )  all elements in @xmath125 are free .",
    "note that there are @xmath207 free elements in the segment . then perform two reduction operations on  @xmath5 :    stem - reduction",
    ": :    replace each stem @xmath208 by a single link .",
    "segment - reduction : :    replace each segment by a unit segment ( with no free element on it ) .",
    "call @xmath69 the reduced structure ( which has no free element ) .",
    "given the standard plane representation of @xmath69 , draw a vertex , called a _",
    "dual vertex _ in each region , and for each link of @xmath69 , draw a _ dual edge _ connecting the vertices in the regions on each side of the link .",
    "the obtained figure ( keeping the dual vertices and dual edges only ) is a rooted plane tree @xmath8 .",
    "note that each edge of @xmath8 corresponds to a link of @xmath69 ( hence corresponds to a stem of @xmath5 ) , and each corner of @xmath8 corresponds to a segment of @xmath5 . we _",
    "weight _ @xmath8 by giving to each of its corners a weight corresponding to the number of free elements in the corresponding segment , and giving to each of its edges a weight corresponding to the length of the corresponding stem .",
    "several parameters are in correspondence through the bijection ( we use the standard terminology for parameters of secondary structures , a node of a tree is called a _ leaf _ if its arity is @xmath176 and an _ inner node _ if it has positive arity ) : see table  [ table : correspondencestrtree ] for a summary of the correspondences between secondary structure loops and nodes of a weighted tree .",
    ".correspondence between types of loop in secondary structure @xmath5 and types of node in the plane tree @xmath8 obtained by duality . [ cols=\">,^,<\",options=\"header \" , ]     note also that the number of links of @xmath5 is the number @xmath209 of edges plus the total weight @xmath210 over all edges , and that the number of free elements of @xmath5 is the total weight @xmath211 over all corners , hence the length @xmath3 of @xmath5 satisfies @xmath212 .",
    "a weighted rooted plane tree with at least one edge is called _ admissible _ if it corresponds to a valid secondary structure ( which has at least one link ) , i.e. , if the weights satisfy the following conditions :    : :    \\1 .",
    "each non - root node with one child has at least one of its two    incident corners of positive weight ( otherwise the stem - reduction    would not have been complete ) .",
    ": :    \\2 .",
    "each corner at a leaf has weight at least @xmath49 ( to    satisfy the @xmath49-threshold condition ) .",
    ": :    \\3 .",
    "each edge has weight at least @xmath60 ( to satisfy the    @xmath60-threshold condition ) .      for @xmath213 , a _ weighted combinatorial class indexed by @xmath12 parameters _",
    "is a set @xmath214 together with a _ weight - function _",
    "@xmath215 from @xmath214 to @xmath216 and @xmath12 _ parameter - functions _ @xmath217 ( one for each parameter ) from @xmath214 to @xmath218 such that for any fixed integers @xmath219 , the set of structures @xmath220 such that @xmath221 is finite .",
    "this set is denoted @xmath222 $ ] .",
    "the corresponding multivariate generating function is @xmath223 we say that variable @xmath224 _ marks _ the parameter @xmath225 , for @xmath226 .",
    "we also use the notation @xmath227a(x_1,\\ldots , x_r):=\\sum_{\\gamma\\in\\ca[n_1,\\ldots , n_r]}w(\\gamma).\\ ] ] in general we consider _ enumerative _ generating functions , where @xmath228 assigns weight @xmath82 to each structure .",
    "however we allow ourselves to weight these structures , e.g. , to weight each secondary structure by @xmath229 , with @xmath230 a so - called _ stickiness parameter_. the variables @xmath224 are a priori considered as formal , but one can also evaluate a generating function at given values , provided the sum converges .",
    "the _ convergence domain _ of @xmath231 is the set of @xmath12-tuples @xmath232 of nonnegative real values",
    "such that @xmath231 converges .    as a first example , we briefly recall here how to enumerate ( homopolymer ) secondary structures , via the dual representation by weighted rooted plane trees and using generating functions .",
    "let @xmath233 be the family of rooted plane trees , possibly reduced to a single vertex , with some marked corners ( to be occupied by positive weights later on ) incident to inner nodes such that each node with one child has at least one marked corner .",
    "let @xmath234 be the generating function of @xmath233 where @xmath95 marks the number of leaves , @xmath235 marks the number of marked corners , and @xmath138 marks the number of edges .",
    "when the root - node @xmath235 has arity @xmath82 , exactly one of its two corners is marked , hence the generating function for trees in @xmath233 whose root - node has arity @xmath82 is @xmath236 .",
    "when the root - node @xmath235 has arity @xmath237 , there are @xmath238 corners incident to @xmath235 , and each of these can be marked ( independently ) . hence the generating function for trees in @xmath233 where the root - node has arity @xmath31 is @xmath239 . consequently , @xmath240 satisfies @xmath241 let @xmath242 be the family of rooted plane trees with at least one edge and with some marked corners ( to be occupied by positive weights later on ) incident to inner nodes such that each non - root node with one child has at least one marked corner .",
    "let @xmath243 be the generating function of @xmath242 where @xmath95 marks the number of leaves , @xmath235 marks the number of marked corners , and @xmath138 marks the number of edges .",
    "again by decomposing at the root , we get @xmath244 let @xmath245 be the series counting secondary structures with at least one link , where @xmath246 marks the number of free elements , and @xmath30 marks the number of links . note that @xmath245 is also the generating function of admissible rooted weighted plane trees where @xmath246 marks the total weight over corners , and @xmath30 marks the number of edges plus the total weight over edges .",
    "such a tree is uniquely obtained from a tree in @xmath242 where each corner at a leaf is assigned a weight of value at least @xmath49 , each non - marked corner at an inner node is assigned weight @xmath176 , each marked corner is assigned a positive weight , and each edge is assigned a weight of value at least @xmath60 .",
    "hence we have @xmath247 , where @xmath248 to summarize , we have an expression ( written as a system of two equations ) for the generating function @xmath245 enumerating secondary structures with at least one link , where @xmath246 marks the number of free elements and @xmath30 marks the number of links ( the generating function of all secondary structures , including the ones with no link , is clearly @xmath249 ) . indeed ,",
    "if we define @xmath250 , then we easily see ( since the substitutions of variables are rational expressions whose series - expansion have nonnegative coefficients ) that there is a one - line equation specifying @xmath251 , of the form @xmath252 , with @xmath253 a rational expression whose series - expansion ( in @xmath30 , @xmath246 , @xmath139 ) has nonnegative coefficients .",
    "and there is a rational expression @xmath254 whose series - expansion has nonnegative coefficients and such that @xmath255 .",
    "precisely @xmath256 @xmath257 this allows us to extract the counting coefficients .",
    "let @xmath258 be the weighted generating function of secondary structures where @xmath246 marks the length , and where each structure has weight @xmath229 : @xmath259 ( the term @xmath260 gathers secondary structures with no link ) ; for instance for @xmath88 and @xmath62 we find @xmath261      the nussinov energy @xmath6 of a secondary structure @xmath5 is defined as @xmath262 , with @xmath187 the number of links in @xmath5 .",
    "a secondary structure @xmath5 is called _ saturated _ ( or _ locally optimal _ for the nussinov energy ) if it is not possible to add a link to @xmath5 ( i.e. , decrease the energy by @xmath82 ) while keeping a valid secondary structure .",
    "[ lem : charact_sat ] assume @xmath62 ( no restriction on the lengths of stems ) .",
    "saturated secondary structures with at least one link correspond to admissible weighted rooted plane trees such that :    * all corners have weight at most @xmath263 , * at each node there is at most one corner of strictly positive weight .",
    "as shown in figure  [ fig : sat ] , if there are two positive corners at the same inner node , then it is possible to add a link . also , if there is a corner with weight at least @xmath264 then one can link the first and last free elements in the corresponding segment .",
    "hence the weight of each corner is at most @xmath263 . and these are the only two situations where it is possible to add a link without breaking planarity nor breaking the @xmath49-threshold condition .",
    "@xmath178        call @xmath233 the family of rooted plane trees with some marked corners incident to inner nodes ( these marked corners are to be occupied by positive weights later on ) such that : ( i )  each node with one child has exactly one marked corner , ( ii )  each node with several children has at most one marked corner .",
    "let @xmath234 be the generating function of @xmath233 where @xmath95 marks the number of leaves , @xmath235 marks the number of marked corners , and @xmath138 marks the number of edges .",
    "when the root - node @xmath235 has arity @xmath82 , exactly one of its two corners is marked , hence the generating function for trees in @xmath233 whose root - node has arity @xmath82 is @xmath236 .",
    "when the root - vertex @xmath235 has arity @xmath237 , there are @xmath238 corners incident to @xmath235 , and at most one of these corners has positive weight .",
    "hence the generating function for trees in @xmath233 where the root - vertex has arity @xmath31 is @xmath265 .",
    "consequently , @xmath240 satisfies @xmath266 hence , using the identity @xmath267 , @xmath240 satisfies @xmath268    now let @xmath242 be the family of rooted plane trees with at least one edge , and with marked corners incident to inner nodes such that : ( i )  each node @xmath235 with one child has exactly one marked corner if @xmath235 is different from the root - node , and has _ at most _ one marked corner if @xmath235 is the root - node , ( ii )  each node with several children has at most one marked corner .",
    "let @xmath243 be the generating function of @xmath242 where @xmath95 , @xmath235 , @xmath138 mark respectively the numbers of leaves , marked corners , and edges .",
    "decomposing again at the root , we get @xmath269    we take here @xmath62 ( no restriction on the lengths of stems ) .",
    "let @xmath245 be the generating function of saturated secondary structures with at least one link , where @xmath246 marks the number of free elements and @xmath30 marks the number of links .",
    "then lemma  [ lem : charact_sat ] ensures that @xmath247 , where @xmath270 to summarize ( in a similar way as for general structures ) , we have an expression ( written as a system of two equations ) for the generating function @xmath245 enumerating _ saturated _ secondary structures with at least one link , where @xmath246 marks the number of free elements and @xmath30 marks the number of links ( the generating function of all saturated secondary structures , including the ones with no link , is @xmath271 ) . indeed ,",
    "if we define @xmath250 , then there is a one - line equation specifying @xmath251 , of the form @xmath252 , with @xmath272 a rational expression whose series - expansion ( in @xmath30 , @xmath246 , @xmath139 ) has nonnegative coefficients .",
    "and there is a rational expression @xmath273 whose series - expansion has nonnegative coefficients and such that @xmath255 .",
    "precisely @xmath274 @xmath275 again this allows us to extract the counting coefficients .",
    "let @xmath258 be the weighted generating function of saturated secondary structures where @xmath246 marks the length , and where each structure has weight @xmath229 : @xmath276 ; for @xmath88 and @xmath62 we find @xmath277      the _ base stacking energy _",
    "@xmath6 of a secondary structure @xmath5 is defined as @xmath278 , with @xmath279 the sum of sizes of all stems of @xmath5 .",
    "a ( homopolymer ) secondary structure is called _",
    "g - saturated _ ( locally optimal for the base stacking energy ) if it is not possible to add a link so as to extend a stem ( i.e. , decrease by @xmath82 the base stacking energy ) .",
    "in general , the addition of a link to a secondary structure either creates a new stem of length @xmath176 or extends an already existing stem .",
    "hence , in a g - saturated structure a valid link addition always creates a new stem of length @xmath176 . in case @xmath280 , creating a stem of length @xmath176 is not a valid link addition ( since the stems must have positive length ) , hence no valid link addition to a g - saturated is possible for @xmath280 . in other words , the concepts of saturated and of g - saturated structures",
    "coincide when @xmath280 ( whereas for @xmath62 the class of saturated structures is strictly contained in the class of g - saturated structures ) . in this section",
    "we enumerate g - saturated structures according to the number of free elements and the number of links , for any given values of the threshold parameters @xmath60 and @xmath49 .",
    "again we formulate the conditions on the dual representation .",
    "for this purpose we define adjacency of corners . two corners @xmath141 and @xmath281 of a rooted plane tree @xmath8",
    "are called _ adjacent _ if they are incident to the same vertex @xmath235 of @xmath8 and there is an edge @xmath282 incident to @xmath235 such that @xmath141 and @xmath281 are the corners incident to @xmath235 on each side of @xmath282 .",
    "note that the two corners on each side of the root ( the root is represented as an ingoing arrow in figure  [ fig : rna_tree ] ) are considered as adjacent only when the root - node @xmath235 has arity @xmath82 ( in which case they are adjacent through the unique edge incident to @xmath235 ) .",
    "[ lem : dualg - sat ] the g - saturated secondary structures with at least one link correspond to admissible weighted rooted plane trees such that :    * the corners at leaves have weight at most @xmath263 , * any two adjacent corners can not both have strictly positive weight .",
    "as shown in figure  [ fig : gsat ] , if there are two adjacent positive corners , then it is possible to add a link so as to extend an existing stem . also , if there is a corner of weight at least @xmath264 at a leaf @xmath283 , then one can link the first and last free elements in the corresponding segment and thus extend the stem associated to the edge leading to @xmath283 .",
    "hence the weight of a corner at a leaf is at most @xmath263 .",
    "and these are the only two situations where it is possible to extend a stem without breaking planarity nor breaking the @xmath49-threshold and @xmath60-threshold condition .",
    "@xmath178    call @xmath233 the family of rooted plane trees with some marked corners incident to inner nodes ( again these marked corners are to be occupied by positive weights later on ) such that : ( i )  each inner node with one child has exactly one marked corner , ( ii )  two corners can not both be marked if they are adjacent or if they are the two corners on each side of the root ( the root is indicated by an ingoing arrow in figure  [ fig : rna_tree ] ) .",
    "let @xmath234 be the generating function of @xmath233 where @xmath95 marks the number of leaves , @xmath235 marks the number of marked corners , and @xmath138 marks the number of edges .",
    "finding an equation satisfied by @xmath240 is a little more involved than for saturated structures .",
    "at first we need a preliminary study on independent sets ( i.e. , sets containing only pairwise non - adjacent elements ) on a @xmath31-sequence or on a @xmath31-cycle . for @xmath284 and @xmath285 , let @xmath286 ( resp .",
    "@xmath287 ) be the number of ways of choosing @xmath111 _ marked _ elements on the oriented cycle @xmath288 ( resp .",
    "sequence @xmath289 ) of @xmath31 elements such that no two consecutive elements are marked , and let @xmath290 ( resp .",
    "@xmath291 ) be the corresponding ( polynomial ) generating function .",
    "the polynomials @xmath292 are well - known to be the _",
    "fibonacci polynomials _ and satisfy an easy recurrence which we briefly recompute here .",
    "we take the convention @xmath293 .",
    "let @xmath237 .",
    "if an independent set on the @xmath31-sequence starts with a marked element , then the next element is forbidden and the remaining @xmath294-sequence might be occupied by any independent set ; this gives a contribution @xmath295 in @xmath292 , where the factor @xmath235 takes account of the first element being marked .",
    "if an independent set on the @xmath31-sequence starts with a non - marked element , then the remaining @xmath296-sequence might be occupied by any independent set ; this gives a contribution @xmath297 in @xmath292 .",
    "therefore @xmath298 now define @xmath299 .",
    "the recurrence on @xmath292 above multiplied by @xmath300 and summed over @xmath237 yields @xmath301 . with @xmath293 and @xmath302",
    "we obtain @xmath303 let us go back to independent sets on the @xmath31-cycle @xmath304 , for @xmath305 .",
    "in such a set , either @xmath82 is occupied , in which case the adjacent elements @xmath157 and @xmath31 are unoccupied and the remaining segment @xmath306 might be occupied by any independent set .",
    "this gives contribution @xmath307 to @xmath308 .",
    "if @xmath82 is unoccupied , then the remaining segment @xmath309 might be occupied by any independent set ; this gives contribution @xmath297 to @xmath308 .",
    "consequently @xmath310 if the root - node @xmath235 of a tree in @xmath233 has arity @xmath82 then exactly one of its two incident corners is marked ( by definition of @xmath233 ) , thus the generating function of trees in @xmath233 whose root - node has arity @xmath82 is @xmath236 ; if @xmath235 has arity @xmath237 then the marked corners around @xmath235 form an independent set ( no two consecutive corners are marked ) . thus , for @xmath237 , the generating function of trees in @xmath233 whose root - node has arity @xmath31 is @xmath311 ( since there are @xmath312 corners incident to the root - node ) .",
    "consequently @xmath240 satisfies @xmath313x^kf^k\\\\ & = & u+2vxf+vx^2f^2s(v , xf)+\\big(s(v , xf)-1-(1+v)xf\\big).\\end{aligned}\\ ] ] using the rational expression of @xmath5 above and rearranging , we obtain @xmath314 now let @xmath242 be the family of rooted plane trees with at least one edge and where some corners at inner nodes are marked such that ( i ) each non - root inner node of arity @xmath82 has exactly one marked corner , ( ii )  two adjacent corners can not both be marked . and let @xmath243 be the generating function of @xmath242 where @xmath95 marks the number of leaves , @xmath235 marks the number of marked corners , and @xmath138 marks the number of edges .",
    "the difference between @xmath242 and @xmath233 is at the root - vertex : in @xmath242 the two corners on each side of the root are allowed to be both marked when the root - vertex has more than one child , and are allowed to be both unmarked when the root - vertex has one child .",
    "so we have @xmath315 using the rational expression of @xmath5 above and rearranging , we obtain the following expression for @xmath79 in terms of @xmath240 : @xmath316    now let @xmath245 be the generating function of g - saturated structures with at least one link , where @xmath246 marks the number of free elements and @xmath30 marks the number of links .",
    "by lemma  [ lem : dualg - sat ] , @xmath317 where @xmath318    the conclusion is similar to the other two cases ( general structures , saturated structures ) : we have an expression ( written as a system of two equations ) for the generating function @xmath245 enumerating _ g - saturated _ secondary structures with at least one link , where @xmath246 marks the number of free elements and @xmath30 marks the number of links ( the generating function of all g - saturated secondary structures , including the ones with no link , is @xmath249 ) . indeed ,",
    "if we define @xmath250 , then there is a one - line equation specifying @xmath251 , of the form @xmath252 , with @xmath272 a rational expression whose series - expansion ( in @xmath30 , @xmath246 , @xmath139 ) has nonnegative coefficients .",
    "and there is a rational expression @xmath273 whose series - expansion has nonnegative coefficients and such that @xmath255 .",
    "precisely @xmath319 @xmath320 again this allows us to extract the counting coefficients .",
    "let @xmath258 be the weighted generating function of g - saturated secondary structures where @xmath246 marks the length , and where each structure has weight @xmath229 : @xmath259 ; for @xmath88 and @xmath62 we find @xmath321",
    "we show here that the number of structures of length @xmath3 follows a universal asymptotic behaviour in @xmath322 ( with @xmath141 and @xmath323 explicit positive constants ) , which is typical of tree - structures .",
    "the proof classically relies on the drmota - lalley - woods theorem  ( * ? ? ?",
    "* vii.6 ) , which we recall at first .",
    "consider an equation of the form @xmath324 where @xmath325 is a rational expression in @xmath246 and @xmath139 .",
    "such an equation is called _ admissible _ if the following conditions are satisfied :    * the rational expression @xmath325 has a series - expansion in @xmath246 and @xmath139 with nonnegative coefficients , is nonaffine in @xmath139 , and satisfies   @xmath326 and @xmath327 , * the unique generating function @xmath328 solution of   is aperiodic , i.e. , can not be written as @xmath329 for some integers @xmath330 with @xmath331 .",
    "there is an easy criterion to check the aperiodicity condition : it suffices to prove that there is some @xmath332 such that @xmath333a(t)>0 $ ] for @xmath334 .",
    "[ theo : dll ] [ thm : drmotalalleywoods ] let @xmath328 be the generating function that is the unique solution of an admissible equation @xmath335",
    ". then @xmath336a(t)\\sim c\\ \\!\\gamma^n\\ \\!\\!n^{-3/2},\\ ] ] where @xmath337 , with @xmath338 the unique pair in the convergence domain of @xmath325 that is solution of the _ singularity system _ : @xmath339 and where @xmath340 moreover , if @xmath341 is a rational expression not constant in @xmath139 , that has a series - expansion with nonnegative coefficients , and such that the convergence domain of @xmath341 is contained in the convergence domain of @xmath325 , then the coefficients of the generating function @xmath342 behave as @xmath336b(t)\\sim d\\ \\!\\gamma^n\\ \\!\\!n^{-3/2},\\ ] ] where @xmath343 .",
    "the drmota - lalley - wood theorem is classically proved ( e.g. in  ( * ? ? ?",
    "* vii.6 ) ) for polynomial systems ( i.e. , for @xmath325 a polynomial ) .",
    "but one easily checks that , more generally , if @xmath325 is a bivariate series that diverges at all its singularities , then the conclusions remain the same .    from the drmota - lalley - wood theorem",
    "we obtain    [ prop : asympt1 ] let @xmath230 be a fixed positive real value ( stickiness parameter ) .",
    "let @xmath258 be the univariate generating function of general ( resp .",
    "saturated , resp .",
    "g - saturated ) homopolymer secondary structures , where @xmath246 marks the length of the sequence and where each structure has weight @xmath229 .    then , for any values of the threshold - parameters @xmath49 and @xmath60 ( @xmath62 if one considers saturated structures ) , there are computable positive constants @xmath141 and @xmath323 ( depending on @xmath60 , @xmath49 , @xmath230 , and in which setting : general , saturated , or g - saturated ) such that @xmath336g_p(t)\\sim c\\ \\!\\gamma^n\\ \\!\\!n^{-3/2}.\\ ] ]    recall that , in each of the three settings ( general , saturated , g - saturated ) , @xmath245 denotes the generating function of secondary structures with at least one link , where @xmath246 marks the number of free elements and @xmath30 marks the number of links .",
    "we have seen that , in each of the three settings , there are two rational expressions @xmath272 and @xmath273 that have nonnegative coefficients ( in the series - expansion ) , and there is an adjoint generating function @xmath251 such that @xmath252 and @xmath255 .",
    "in addition , the convergence domain of @xmath272 is clearly the same as the convergence domain of @xmath273 ; for instance , for g - saturated structures , the convergence domain is the set of nonnegative triples @xmath344 such that @xmath345 , @xmath346 , and @xmath347 , where @xmath348 and @xmath349 .",
    "note that in all three settings , @xmath350 for @xmath351 and @xmath352 for @xmath353 . if we set @xmath354 ( with @xmath49 the threshold parameter ) and @xmath355 , then we are in the conditions of the drmota - lalley - wood theorem , with @xmath356 and @xmath357 .",
    "the conditions for @xmath358 and @xmath359 are readily checked , we show now the aperiodicity of @xmath360 ( proving that the @xmath3th coefficient is strictly positive for @xmath3 large enough ) . note that it is enough to consider @xmath361 ( the strict positivity of @xmath333f(t)$ ] does not depend on @xmath362 ) . in each of the three settings ( general , saturated , g - saturated ) , @xmath363 is the enumerative generating function of some explicit class of rooted weighted plane trees .",
    "for instance , for saturated structures , @xmath363 counts admissible rooted weighted plane trees with all corners of weight at most @xmath263 , with at most one positive corner per node , and where each node of arity @xmath82 has exactly one positive corner . for @xmath364 ,",
    "consider the weighted rooted plane tree @xmath365 made of one edge @xmath282 leading to a leaf @xmath283 , with weight @xmath82 ( resp .",
    "@xmath176 ) at the corner to the left ( resp .",
    "right ) of the root , with weight @xmath52 on @xmath282 and weight @xmath49 on @xmath283 . and consider the tree @xmath366 defined exactly as @xmath365 except that @xmath283 has weight @xmath263 .",
    "note that @xmath365 contributes to @xmath367a(t)$ ] and @xmath368 contributes to @xmath369a(t)$ ] . hence @xmath333a(t)>0 $ ] for all @xmath370 , so @xmath363 is aperiodic . in exactly the same way ,",
    "@xmath363 is aperiodic in the general setting and in the g - saturated setting .",
    "theorem  [ theo : dll ] ensures that there are @xmath371 and @xmath372 such that @xmath333g(t , pt^2)\\sim c\\gamma^n\\ \\!n^{-3/2}$ ] .",
    "actually , in the case of general and g - saturated structures , we have @xmath373 since ( according to theorem  [ theo : dll ] ) there is some @xmath374 such that @xmath375 is in the convergence domain of @xmath325 , and since clearly any @xmath338 in the convergence domain of @xmath325 satisfies @xmath376 ( indeed @xmath272 involves the quantity @xmath377 , in each of the general and in the g - saturated case ) .",
    "the generating function @xmath258 ( which includes also secondary structures with no link , as opposed to @xmath245 ) satisfies @xmath259 for secondary and for g - saturated structures , and satisfies @xmath378 for saturated structures .",
    "so the additional term gathering saturated structures with no link has negligible asymptotic contribution in all cases .",
    "@xmath178    for @xmath361 , @xmath258 is the enumerative generating function of homopolymer structures .",
    "another value of interest is @xmath379 . indeed ,",
    "if we want to count rna secondary structures ( each base is labelled by a letter in @xmath380 ) instead of homopolymers , this corresponds to giving weight @xmath381 to each free element ( because there are @xmath381 possible labels ) and giving weight @xmath382 to each pair of linked elements ( because there are @xmath382 allowed labellings out of @xmath383 , due to the watson - crick and wobble pairs ) .",
    "therefore the corresponding enumerative generating function is @xmath384 .",
    "we have @xmath336g(4t,6t^2)=4^n[t^n]g(t,3t^2/8)=4^n[t^n]g_{3/8}(t).\\ ] ] in other words , @xmath333g_{3/8}$ ] is the _ expected number _ of rna secondary structures with the desired properties ( general , saturated , or g - saturated ) on a random sequence of size @xmath3 ( i.e. , for a random word in @xmath385 ) .    table  [ fig : table_asympt ] shows the asymptotic behaviour of @xmath333g_p(t)$ ] for @xmath361 and @xmath379 in the three settings .",
    "( the methodology to compute @xmath323 for saturated structures using computer algebra tools is detailed in  @xcite . )          using a theorem of drmota  @xcite ( closely related to the drmota - lalley - wood theorem ) we show that the number of links in a random secondary structure ( general , saturated , or g - saturated ) of length @xmath3 is asymptotically a gaussian law with @xmath386 expectation and @xmath387 standard deviation .",
    "consider an equation of the form @xmath388 where @xmath389 is a rational expression in @xmath246 , @xmath95 and @xmath139 .",
    "such an equation is called _ admissible _ if @xmath389 is nonconstant in @xmath95 , has a series - expansion ( in @xmath246 , @xmath95 , @xmath139 ) with nonnegative coefficients , the equation @xmath390 is admissible ( in the sense of section  [ sec : asympt_enum ] ) , and there is a @xmath391-matrix @xmath392 $ ] with integer coefficients and nonzero determinant such that @xmath393}u^{m[i,2]}y^{m[i,3]}]\\phi(t , u , y)>0 $ ] for all @xmath394 .",
    "[ theo : drmota ] let @xmath395 be a generating function that is the unique solution of an admissible equation @xmath396 .",
    "assume that the generating function @xmath397 of a weighted combinatorial class @xmath242 is given by @xmath398 , with @xmath399 a rational expression with nonnegative coefficients ( in the series - expansion ) , nonconstant in @xmath139 , and such that the convergence domain of @xmath400 is included in the one of @xmath401 . for @xmath402 let @xmath403 , and define the random variable @xmath404 as @xmath405 , with @xmath323 a random structure in @xmath406 under the distribution @xmath407 for @xmath408 in a neighbourhood of @xmath82 , denote by @xmath409 the radius of convergence of @xmath410 , and",
    "let @xmath411 then @xmath412 and @xmath413 are strictly positive and @xmath414 converges as a random variable to a normal ( gaussian ) law .",
    "again the theorem was originally proved for polynomial systems , but the arguments of the proof hold more generally when @xmath358 is rational .",
    "the role of the condition involving the existence of a nonsingular @xmath391 matrix is to grant the strict positivity of @xmath413 , as recently proved in  @xcite .",
    "[ prop : asympt2 ] let @xmath362 . for @xmath415 ,",
    "let @xmath404 be the number of links in a general ( resp .",
    "saturated , resp .",
    "g - saturated ) secondary structure of length @xmath3 taken at random with weight proportional to @xmath229 ( uniformly at random when @xmath361 ) . then there are computable strictly positive constants @xmath412 and @xmath413 ( depending on @xmath230 , @xmath49 , @xmath60 , and on which setting : general , saturated , or g - saturated ) such that @xmath416 converges as a random variable to a normal ( gaussian ) law .    in each of the three settings ( general , saturated , g - saturated ) , we have called @xmath245 the enumerative generating function of secondary structures with at least one link .",
    "we have seen that there are two rational expressions @xmath272 and @xmath273 that have nonnegative coefficients ( in the series - expansion ) , and there is an adjoint generating function @xmath251 such that @xmath252 and @xmath255 ; and the convergence domain of @xmath272 is the same as the convergence domain of @xmath273 .",
    "note that the bivariate series @xmath417 ( with variables @xmath246 and @xmath95 ) is the weighted generating function of secondary structures ( with at least one link ) where @xmath246 marks the length , @xmath95 marks the number of links , and where each structure has weight @xmath229 .",
    "it is easily checked that , if we set @xmath418 ( with @xmath49 the threshold parameter ) and @xmath419 , then we are in the conditions of theorem  [ theo : drmota ] , with @xmath420 and @xmath421 . indeed the @xmath391 matrix condition is readily checked , and for @xmath422 we get the equation of proposition  [ prop : asympt1 ] , where we have already checked that the conditions are satisfied .",
    "@xmath178    table",
    "[ fig : table_asympt2 ] shows the asymptotic behaviour for some standard parameter values .",
    "( the methodology to compute @xmath412 for saturated structures using computer algebra tools is detailed in  @xcite . )",
    "the case @xmath361 corresponds to a homopolymer of length @xmath3 taken uniformly at random , while the case @xmath379 corresponds to a ( uniformly ) random secondary structure where the underlying sequence is ( any word ) in @xmath385 .",
    "as expected , saturated structures tend to have more links than g - saturated structures , which tend to have more links than general structures .",
    "-dangles and three @xmath23-dangles ) .",
    "top - left : the secondary structure with the dual plane tree .",
    "top - right : each dangle yields a marked edge - side in the dual plane tree ( corners at inner nodes are simply marked if they have weight @xmath82 , are doubly marked if they have weight greater than @xmath82).,width=566 ]    we show here that the counting approach developed so far ( based on duality with plane trees , generating functions , and substitution operations ) can be easily adapted to take the presence of so - called dangling bases into account . in the parenthesis representation of the secondary structure ( see figure  [ fig : dangles ] , bottom ) a _ dangling base _",
    "( shortly dangle ) is a distinguished free base of two possible kinds : a _",
    "@xmath161-dangle _ has to be just before an opening parenthesis , a _",
    "@xmath23-dangle _ has to be just after of a closing parenthesis .",
    "note that a dangling base that is just before an opening parenthesis and just after a closing parenthesis is either a @xmath22-dangle or a @xmath23-dangle but not both .",
    "for a structure with dangling bases , the _ underlying _ secondary structure is the structure where dangling bases are considered as usual free bases ( i.e. , are not distinguished )",
    ".    -dangle yields a marked left - side of edge in the dual tree .",
    "( c ) a @xmath23-dangle yields a marked right - side of edge in the dual tree .",
    "( d ) situation of an extremal corner of weight 1 , in which case the two depending edge - sides can not both be marked.,width=566 ]    in the dual plane tree , a @xmath22-dangle ( resp .",
    "a @xmath23-dangle ) is indicated by a marked edge - side to the left ( resp . to the right ) of the edge , see figure  [ fig : dangle_small](b)-(c ) . to take dangles into account in our counting method",
    ", we need to distinguish two types of corners in the dual plane tree @xmath8 : a corner @xmath141 at vertex @xmath235 is called _ lateral _ if @xmath141 is incident to the edge going to the parent of @xmath235 in @xmath8 ( when @xmath235 is not the root - vertex ) or @xmath141 is incident to the root ( when @xmath235 is the root - node ) ; note that every inner node has two incident lateral corners ( one on the left side , one on the right side ) .",
    "the other corners at inner nodes in the tree are called _ extremal _ , see figure  [ fig : dangle_small](a ) . given a corner @xmath141 of @xmath8 ( at an inner node ) , an edge - side @xmath30 incident to @xmath141",
    "is said to _ depend _ on @xmath141 if @xmath141 is incident to @xmath30 at the extremity of @xmath30 closest to the root ; note that a lateral corner has one depending edge - side while an extremal corner has two depending edge - sides , see figure  [ fig : dangle_small](a ) .",
    "we now make important observations to determine when the edge - sides depending on a corner @xmath141 can be marked .",
    "if @xmath141 has weight @xmath176 then none of the depending edge - sides can be marked , because there is no free base in the sector of @xmath141 ( hence no candidate to become a dangle ) .",
    "if @xmath141 is lateral and has positive weight ( i.e. , is a marked corner ) then the depending edge - side is allowed to be marked . if @xmath141 is extremal of weight @xmath82 then at most one of the two edge - sides depending on @xmath141 is allowed to be marked ( because the unique free base in the sector of @xmath141 can not be both a @xmath22-dangle and a @xmath23-dangle ) . if @xmath141 is extremal of weight at least @xmath157 then the two depending edge - sides are allowed to be marked ( and are allowed to be both marked ) .",
    "given these observations we can easily include a variable for dangles in our generating function expressions ( recall we have treated @xmath50 cases : general , saturated , g - saturated ) .    *",
    "general structures , inclusion of dangles in the results of section  [ sec : gf ] . * denote by @xmath423 the generating function of @xmath424 ( the one defined in section  [ sec : gf ] ) where @xmath95 marks the number of leaves , @xmath425 ( resp .",
    "@xmath426 ) marks the number of marked corners that are lateral ( resp .",
    "extremal ) , and @xmath138 marks the number of edges . since a tree - vertex with @xmath427 children has two incident corners that are lateral ( the @xmath428 other ones are extremal ) , we get the following equation ( which specifies @xmath240 uniquely ) : @xmath429 similarly , denoting by @xmath430 the generating function of @xmath431 ( where the variables have the same meaning as for @xmath240 ) , we have @xmath432 let @xmath433 be the generating function counting secondary structures with at least one link , where @xmath246 marks the number of free elements ( including dangles ) , @xmath30 marks the number of edges , and @xmath12 marks the number of dangles",
    ". then @xmath434 , where @xmath435 for @xmath436 , let @xmath437 be the weighted generating function of secondary structures where each structure has weight @xmath438 . then @xmath439 .",
    "for instance , for @xmath88 and @xmath62 we find @xmath440    * saturated structures , inclusion of dangles in the results of section  [ sec : sat ] .",
    "* the equation for @xmath240 obtained in section  [ sec : sat ] becomes ( when splitting @xmath235 into two variables @xmath441 respectively for lateral and extremal marked corners ) : @xmath442 and the expression of @xmath79 becomes @xmath443 a structure with dangles is called _ saturated _ if the underlying secondary structure is saturated .",
    "let @xmath433 be the generating function counting saturated structures with at least one link , where @xmath246 marks the number of free elements ( including dangles ) , @xmath30 marks the number of edges , and @xmath12 marks the number of dangles",
    ". then @xmath434 , where @xmath444 for @xmath436 , let @xmath437 be the weighted generating function of saturated structures where each structure has weight @xmath438 . then @xmath445 . for @xmath88 and @xmath62",
    "we find @xmath446    * g - saturated structures , inclusion of dangles in the results of section  [ sec : gsat ] .",
    "* let @xmath447 be the polynomial generating function for independent sets of the cycle @xmath304 , where @xmath425 ( resp .",
    "@xmath426 ) marks the number of elements of the independent set that belong to @xmath448 ( resp . to @xmath449 ) .",
    "let @xmath450 be the polynomial generating function for independent sets of the chain @xmath451 , where @xmath235 marks the number of elements in the independent set . recall that @xmath452 is given by @xmath453",
    "then one easily sees that for @xmath305 , @xmath454 and the equation for @xmath240 obtained in section  [ sec : gsat ] becomes ( when splitting @xmath235 into two variables @xmath441 respectively for lateral and extremal marked corners ) : @xmath455 which yields the simplified equation @xmath456 and the expression of @xmath79 becomes at first @xmath457 with the conventions @xmath458 , @xmath459 .",
    "hence we have @xmath460 a structure with dangles is called _",
    "g - saturated _ if the underlying secondary structure is g - saturated .",
    "let @xmath433 be the generating function counting g - saturated structures with at least one link , where @xmath246 marks the number of free elements ( including dangles ) , @xmath30 marks the number of edges , and @xmath12 marks the number of dangles",
    ". then @xmath434 , where @xmath461 for @xmath436 , let @xmath437 be the weighted generating function of g - saturated structures where each structure has weight @xmath438 . then @xmath439 .",
    "for @xmath88 and @xmath62 we find @xmath462            * asymptotic results .",
    "* propositions  [ prop : asympt1 ] and  [ prop : asympt2 ] directly extend to the case of any weight @xmath463 for dangles ( the case without dangles is @xmath464 ) .",
    "we give the numeric values corresponding to @xmath465 ( asymptotic enumeration of structures with dangles ) in tables  [ fig : table_asympt_dangles ] and  [ fig : table_asympt2_dangles ] , which are the counterparts of tables  [ fig : table_asympt ] and  [ fig : table_asympt2 ] .",
    "in this paper , we presented various context free grammars that generate the set of secondary structures , according to different energy models : nussinov energy , base stacking energy , turner energy , turner with dangles ( where dangles are rigorously treated by the method of markham and zuker @xcite ) , turner ( with external dangles ) , as well as saturated and g - saturated structures . using dsv , dominant singularity analysis and the flajolet - odlyzko theorem",
    ", we proved that the asymptotic number of secondary structures with annotated dangles , as computed in the partition function of the markham - zuker software unafold @xcite , is @xmath36 , exponentially larger than the number of all secondary structures @xmath0 , previously established by stein and waterman @xcite .",
    "this result provides a partial explanation for m. zuker s observation ( personal communication ) that unafold requires substantially more computation time when dangles are included .",
    "since the nussinov energy model and the base stacking energy model superficially appear to be almost equivalent , we presented a computational result that displays their marked differences .",
    "in particular , the base stacking energy model leads to more cooperative folding and a higher melting temperature for homopolymers than does the nussinov energy model .    finally , in the main part of the paper",
    ", we give generating functions for the number of secondary structures and locally optimal secondary structures , with respect to the nussinov model and the base stacking energy models , permitting the determination of the asymptotic number of ( all resp .",
    "saturated resp .",
    "g - saturated ) structures and the expected number of their base pairs , optionally requiring a minimum stem length and stickiness parameter . with stickiness parameter @xmath466 , we obtain combinatorial results for rna sequences using a reasonable theoretical model .",
    "the principal advantage of our uniform treatment , using duality , substitution of generating functions and the drmota - lalley - woods theorem is that with little additional effort , we can determine the asymptotic number of ( all resp .",
    "saturated resp .",
    "g - saturated ) structures with external dangles , and their expected number of base pairs .",
    "such computations would have been more difficult using grammars , dsv and singularity analysis .",
    "figure  [ fig : rnasecstr2 ] was created by w.a .",
    "lorenz and h. jabbari .",
    "we would like to thank the anonymous referees for their helpful comments .",
    "fusy is supported by the european project exploremaps erc stg 208471 .",
    "p. clote is supported by the national science foundation under grants dbi-0543506 and dms-0817971 , and by digiteo foundation project _",
    "rnaomics_. any opinions , findings , and conclusions or recommendations expressed in this material are those of the authors and do not necessarily reflect the views of the national science foundation .",
    "s.  sheikh , r.  backofen , and y.  ponty .",
    "impact of the energy model on the complexity of rna folding with pseudoknots . in _",
    "lecture notes in computer science _ , volume 7354 , pages 321333 , 2012 .",
    "combinatorial pattern matching , 23rd annual symposium , cpm 2012 , helsinki , finland .",
    "t.  xia , jr .",
    "j.  santalucia , m.e .",
    "burkard , r.  kierzek , s.j .",
    "schroeder , x.  jiao , c.  cox , and d.h .",
    "thermodynamic parameters for an expanded nearest - neighbor model for formation of rna duplexes with watson - crick base pairs . , 37:1471935 , 1999 .",
    "m.  zuker , d.  h. mathews , and d.  h. turner .",
    "algorithms and thermodynamics for rna secondary structure prediction : a practical guide . in j.",
    "barciszewski and b.f.c .",
    "clark , editors , _ rna biochemistry and biotechnology _ , nato asi series , pages 1143 .",
    "kluwer academic publishers , 1999 ."
  ],
  "abstract_text": [
    "<S> it is a classical result of stein and waterman that the asymptotic number of rna secondary structures is @xmath0 . motivated by the kinetics of rna secondary structure formation , we are interested in determining the asymptotic number of secondary structures that are _ locally optimal _ , with respect to a particular energy model . in the nussinov energy model , where each base pair contributes @xmath1 towards the energy of the structure , </S>",
    "<S> locally optimal structures are exactly the _ saturated _ structures , for which we have previously shown that asymptotically , there are @xmath2 many saturated structures for a sequence of length @xmath3 . in this paper , we consider the _ base stacking energy model _ , a mild variant of the nussinov model , where each stacked base pair contributes @xmath1 toward the energy of the structure . locally optimal structures with respect to the base stacking energy model are exactly those secondary structures , whose stems can not be extended . </S>",
    "<S> such structures were first considered by evers and giegerich , who described a dynamic programming algorithm to enumerate all locally optimal structures . in this paper , we apply methods from enumerative combinatorics to compute the asymptotic number of such structures . additionally , we consider analogous combinatorial problems for secondary structures with annotated single - stranded , stacking nucleotides ( dangles ) . </S>"
  ]
}