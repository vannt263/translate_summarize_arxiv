{
  "article_text": [
    "entanglement is one of the fundamental concepts of quantum mechanics that describes how quantum mechanical objects  e.g. photons , electrons , or spins  are interwoven into a collective state  @xcite .",
    "if such a state can no longer be described as a simple product state of single - particle wave functions , one says that the quantum mechanical objects are entangled . beyond its conceptual relevance quantum mechanical entanglement",
    "has turned into a key resource in various fields of modern physics  @xcite . in quantum information theory",
    "it is exploited in storing and manipulating information in so - called qubits @xcite . in condensed matter physics entanglement",
    "has become increasingly appreciated as a measure to classify different states of quantum matter which can not be distinguished by any local observable such as topologically ordered states @xcite .",
    "the probably stunning realization that oftentimes ground states of quantum many - body systems are far from being highly entangled states has led to the development of a novel class of ( tensor network ) algorithms to simulate quantum many - body systems in a variational low - entanglement approach @xcite .",
    "while the notion of entanglement was originally associated with typically a handful of qubits its application to quantum many - body systems requires entanglement measures that allow to deal with an almost arbitrarily large number of interwoven quantum mechanical degrees of freedom .",
    "one such powerful measure is the so - called entanglement entropy  @xcite , which can be calculated from a bipartition of a quantum many - body system into two complimentary parts @xmath0 and @xmath1 as illustrated in fig .",
    "[ fig : bipartition ] .",
    "tracing out the degrees of freedom in one subsystem one can calculate a reduced density matrix for the other , e.g. @xmath2 .",
    "the information in the density matrix is then condensed into a single number , e.g. the von neumann entropy  @xcite @xmath3 \\ , .",
    "\\label{eq : entanglemententropy}\\ ] ] the von neumann entropy is the most prominent member of a more general family of entanglement entropies , the so - called rnyi  entropies @xcite which are calculated from the density matrix as @xmath4 where the limit @xmath5 recovers the above von - neumann entropy .     and its complement @xmath1 .",
    "[ fig : bipartition ] ]    the strength of these entropic entanglement measures becomes apparent when considering the scaling of the entanglement entropy for varying sizes of the subsystem @xmath0 .",
    "in contrast to conventional thermodynamic entropies the entanglement entropy is not extensive , but rather scales with the length of the boundary between the two partitions ",
    "the so - called boundary law  @xcite ( which is often also referred to as area - law ) .",
    "corrections to this prevalent boundary law have received widespread attention for their ability to classify different states of quantum matter  @xcite .",
    "for instance , it has been shown that the topological character of non - local order present in a quantum ground - state wavefunction can be revealed by a universal @xmath6 correction @xcite to the boundary law .",
    "numerical simulations of quantum spin systems have subsequently shown that such an identification is indeed feasible and unambiguously revealed the long conjectured topological order present in ground states of certain frustrated quantum magnets @xcite .",
    "systems of interacting _ fermionic _ degrees of freedom are the conceptually most interesting class of interacting quantum many - body systems due to the even more complex variety of possible ground states and corresponding entropic signatures arising from the intricate nodal structure of fermionic wave functions .",
    "while a generalization of the numerical schemes to calculate entanglement entropies also for these many - fermion systems is highly desirable , progress so far has been limited to variational monte carlo techniques  @xcite .",
    "the first step to develop an approach based on determinantal monte carlo  an unbiased , auxiliary field technique that has become the method of choice for large - scale simulations of interacting fermion systems  has recently been reported by grover  @xcite , whose approach is based on a decomposition of the entanglement entropy in terms of free - fermion green s functions .    the purpose of this manuscript is to describe an efficient numerical method to calculate the entanglement entropy for systems of interacting fermions in any spatial dimension .",
    "our approach generalizes a replica scheme used to calculate rnyi  entropies in world line quantum monte carlo approaches for interacting spin or bosonic systems to the framework of determinantal monte carlo simulations as detailed in the following section .",
    "we demonstrate the applicability of this approach by simulating one - dimensional hubbard systems and discuss the strength of our technique in a detailed comparison with grover s recent alternative proposal to decompose the entanglement entropy in terms of free - fermion green s functions  @xcite in section [ sec : hubbard ] .",
    "we close with an outlook in sec .",
    "[ sec : outlook ] .",
    "we consider a setup where the interactions between spinful fermionic degrees of freedom are captured by a lattice hamiltonian such as the hubbard model @xmath7 whose physics thrives from the competition of the on - site interaction @xmath8 and the hopping @xmath9 for fixed chemical potential @xmath10 .",
    "our method is , however , not limited to the specifics of hubbard model but can in fact be applied to any fermionic hamiltonian amenable to a quantum monte carlo simulation .",
    "the quantum mechanical state of such an interacting many - fermion system can be described via its density matrix @xmath11 . when considering the ground state of the system at zero temperature this density matrix is given by @xmath12",
    "while at finite temperatures it takes the form @xmath13 in both cases , we have introduced an explicit normalization constant @xmath14 in the denominator , which not only ensures that the trace of the so - defined density matrix is @xmath15 , but will play an important conceptual role in the following . to be even more explicit , we can rewrite both expressions as @xmath16 which is the form we will be using in the following .       where all world lines have to be @xmath17-periodic .",
    "the right side shows a configuration of allowed world lines in the @xmath18 $ ] partition sum , where @xmath19-periodicity is enforced in part @xmath0 of the system but part @xmath1 remains @xmath17-periodic .",
    "[ fig : ensembleswitching ] ]    the first step in calculating the rnyi  entropy is to determine the reduced density matrix @xmath20 by tracing out the degrees of freedom in subsystem @xmath1 @xmath21 in our numerical calculations we will concentrate on the second rnyi  entropy , i.e. the case of @xmath22 , which can be calculated from the reduced density matrix @xmath20 as @xmath23 note that @xmath20 is squared before the remaining degrees of freedom of subsystem @xmath0 are traced out . using the notation of eq .  , we thus find the following general expression for the rnyi  entropy@xmath24 which is valid for both finite temperature and ground state considerations . in the following",
    "we will closely examine how this definition of the rnyi  entropy   can be translated into an algorithm for its numerical computation .",
    "for concreteness we will initially focus on the finite - temperature scenario and expand our discussion to ground - state calculations in a later step .",
    "considering first the denominator in eq .  , we note that @xmath25 i.e. the normalization @xmath26 is equal to the square of the usual partition sum considered in thermodynamics .",
    "the numerator of definition is a bit more involved @xmath27 \\,,\\end{aligned}\\ ] ] where we have defined the partition function @xmath18 $ ] .",
    "we are now left with the question of how to numerically calculate these two partition functions . to this end",
    ", we will first consider their calculation in the framework of world line quantum monte carlo techniques , as they are typically used for systems of interacting spin or bosonic degrees of freedom .",
    "we will then turn to the framework of determinantal quantum monte carlo ( dqmc ) techniques , typically used to simulate many - fermion systems .    turning first to the case of world line qmc techniques , it is helpful to translate the two partition sums @xmath28 and @xmath18 $ ] into their respective world line representations as illustrated in fig .",
    "[ fig : ensembleswitching ] . on the left side , the world line representation of @xmath28 from the denominator in eq .",
    "is depicted with two sets of @xmath17-periodic world lines extending from @xmath29 to @xmath17 and from @xmath17 to @xmath19 , respectively . on the right hand site a world line representation is depicted for the partition function @xmath30 $ ] of the numerator of eq .  , where we consider two replicas of the system connected in imaginary time . carefully implementing the imaginary time boundary conditions defined in eq .",
    "results in a @xmath17 periodicity for part @xmath1 and a @xmath19 periodicity for part @xmath0  a scheme often referred to as the replica trick @xcite . to sample world line configurations according to these two partition sums",
    ", one simply needs to implement their respective imaginary time boundary conditions  a task , which is relatively straightforward for any existing world line monte carlo implementation @xcite .    ]",
    "let us now turn to the framework of dqmc simulations and try to adapt the evaluation of the two partition functions @xmath28 and @xmath18 $ ] needed to calculate the rnyi  entropy of eq .   for a fermionic system .",
    "describing the dqmc framework in a nutshell , one first decouples quartic terms in the hamiltonian by a hubbard - stratonovich transformation introducing an auxiliary field , which then allows to integrate out the fermions analytically .",
    "a monte carlo scheme is then used to sample configurations of the auxiliary field .",
    "one of the key differences to world line techniques described above is that we do not sample world lines directly .",
    "in fact , by integrating out the fermionic degrees of freedom , we sample _ all _ possible world line configurations simultaneously for a given configuration of the auxiliary field .",
    "this raises the question of how to properly implement the replica scheme in this framework .",
    "we will concentrate our discussion on the key conceptual steps in the following and refer the inclined reader interested in a more concise technical description to appendix [ app : dqmc ] .",
    "considering at first an arbitrary pair of a fermion state @xmath31 and an auxiliary field state @xmath32 its statistical weight @xmath33 is given by a slater determinant @xmath34 a crucial step is to realize that the grand - canonical trace over these slater determinants can be recast as a _ single _",
    "determinant @xmath35 which implies that one can integrate out the fermionic degrees of freedom and instead consider only configurations of the auxiliary field .",
    "however , it should be noted that this identity works only if the weights of the partition sum can be written in terms of single slater determinants . when considering the replica scheme for the calculation of rnyi  entropies",
    ", however , one typically encounters statistical weights in the expression for the partition function @xmath18 $ ] that are the product of _ two _",
    "determinants@xmath36 =     \\sum\\limits_{\\{\\sigma\\ } } \\sum\\limits_{\\mathcal{a } , \\mathcal{a}^\\prime , \\mathcal{b } , \\mathcal{b}^\\prime }     { \\left < \\mathcal{a}{\\mathcal{b}^\\prime } \\right| }     \\rho^\\prime     { \\left| \\mathcal{a}^\\prime{\\mathcal{b}^\\prime } \\right > }     { \\left < \\mathcal{a}^\\prime{\\mathcal{b } } \\right| }     \\rho^\\prime     { \\left| \\mathcal{a}\\mathcal{b } \\right>}\\nonumber\\\\     & =   \\sum\\limits_{\\{\\sigma\\ } } \\sum\\limits_{\\mathcal{a } , \\mathcal{a}^\\prime , \\mathcal{b } , \\mathcal{b}^\\prime }     \\det{}{\\left(\\sigma,{\\ensuremath{\\mathcal{a}}}{\\ensuremath{\\mathcal{b}}}^\\prime\\vert{\\ensuremath{\\mathcal{a}}}^\\prime{\\ensuremath{\\mathcal{b}}}^\\prime\\right ) }     \\det{}{\\left(\\sigma , { \\ensuremath{\\mathcal{a}}}^\\prime{\\ensuremath{\\mathcal{b}}}\\vert{\\ensuremath{\\mathcal{a}}}{\\ensuremath{\\mathcal{b}}}\\right ) } \\,,\\label{eq : weight_as_prod_of_dets}\\end{aligned}\\ ] ] where the two determinants are denoted as @xmath37 and @xmath38 .",
    "they again depend on the auxiliary field configuration @xmath32 and the arguments @xmath39 indicate the imaginary time boundary conditions for a particular pair of auxiliary field and fermionic configuration .",
    "this structure seems to suggest that one can no longer integrate out the fermions by taking a grand - canonical trace as in eq .",
    " the essential step at the heart of the dqmc framework , which if missing does not allow numerical simulations of the fermionic system at feasible numerical cost .",
    "the key idea in our approach is to represent the replica scheme in a setting where the statistical weights can again be simplified to a form relying on a single slater determinant thus allowing to take a grand - canonical trace of the form  .",
    "this is achieved by artificially enlarging the system by considering an additional copy @xmath40 of subsystem @xmath1 , which we will use to selectively evolve subsystem @xmath1 in imaginary time .",
    "in particular we will show that an imaginary - time hamiltonian of the form @xmath41 will give direct access to the partition sum @xmath18 $ ] . a world line representation of this hamiltonian is given in fig .",
    "[ fig : ensembleswitchingunfolded ] . to see this ,",
    "suppose that we are given as a model hamiltonian and our task is to determine its physics at an arbitrary temperature , suggestively written as @xmath19 .",
    "we denote a given basis state by @xmath42 , which leads to a partition sum of @xmath43 although there are two propagation operators , the weight of the system would still be given as a _ single _",
    "slater determinant because only one expectation value has to be evaluated .",
    "we proceed to insert a resolution of unity in between the two exponential operators to obtain    @xmath44    notice that in the right term , states of @xmath45 do not appear in the hamiltonian .",
    "thus , independent of the specific form of @xmath46 and @xmath47 , we need to have @xmath48 for any non - vanishing term contributing to this partition function .",
    "similarly , one obtains @xmath49 from inspecting the left term .",
    "further , if subsystems @xmath47 and @xmath45 do not appear in the hamiltonian for a given imaginary time interval they not only do not evolve , but also remain completely decoupled from the rest of the system over this interval .",
    "as a result , they will also not affect the statistical weight @xmath50 and thus can safely be ignored . finally , renaming @xmath51 to @xmath52 to match our earlier notation we obtain the following simplified expression    @xmath53 \\,,\\end{aligned}\\ ] ]    which is precisely the expression for the sought - after partition function @xmath30 $ ] .",
    "we have thus shown that one can indeed recast the partition function @xmath30 $ ] in a way that relies only on single determinants thus allowing to take the grand - canonical trace .",
    "when considering the ground - state dqmc algorithm ( see appendix [ app : gsalgorithm ] ) only minor modifications to the above scheme have to be implemented .",
    "the normalization constant @xmath54 introduced in is now given as @xmath55 the ground - state wave function @xmath56 is obtained by a projective scheme @xmath57 applied to a test wave function @xmath58 . if the test wave function has a non - zero overlap with the actual ground - state wavefunction , this projective scheme should eliminate all contributions from excited states and converge to the ground - state wavefunction . inserting this projection into the definition of the rnyi  entropy in eq .",
    ", we find an expression for the canonical @xmath59 very similar to the finite temperature expression of the grand - canonical trace for @xmath60 in eq .",
    "discussed above    @xmath61    where the only difference is the appearance of the density matrices @xmath62 , which however come in handily when taking the grand - canonical trace to make use of eq .  .",
    "precisely because of the occurrence of these density matrices only states with an occupation number identical to the one of the test wave function will contribute .",
    "while we have concentrated our discussion on rnyi  entropies of order @xmath63 , it should be noted that our algorithm can be extended in a straightforward way to also compute higher rnyi  entropies . for the calculation of the @xmath64-th rnyi  entropy via the replica trick , imaginary time has to be split into @xmath64 segments which would contribute one determinant each in eq .  .",
    "it would thus be necessary to introduce @xmath64 replicas of the subsystem @xmath1 and work in an overall system of size @xmath65 .",
    "we have not implemented this more general case and therefore can not comment on limiting system sizes or potential numerical instabilities arising in such an extended scheme .    )",
    "$ ] and @xmath66 , respectively .",
    "whenever we encounter a configuration that is admissible in both ensembles , we compare their relative weights and decide in which ensemble we continue to sample configurations based on a metropolis scheme .",
    "[ fig : ensembleswitchingcloud ] ]      the replica scheme outlined above allows to directly sample partition functions of the form @xmath30 $ ] .    for the calculation of the rnyi  entropy ,",
    "however , we are really interested in determining the _ ratio _ of the partition functions @xmath30 $ ] and @xmath28 as given in eq .  .",
    "this ratio can be directly accessed  @xcite without explicitly calculating the individual partition functions but by cleverly switching between the two ensembles .",
    "imagine a two state simulation , where the weight of two states is given by @xmath67 and @xmath68 . for any simulation fulfilling detailed balance the random walk would spend @xmath69 steps in state 1 and @xmath70 steps in state 2 .",
    "thus , the ratio of the weights @xmath71 corresponds precisely to the relative time spent in the two respective states .",
    "we can readily generalize  @xcite this statement to a situation where we sample a random walk switching back and forth between two ensembles whose partition functions equal the weights @xmath72 $ ] and @xmath73 , respectively .",
    "thus the ratio of relative time spent sampling each of the two ensembles can then be used to calculate the entanglement entropy @xmath74}{{\\ensuremath{\\mathcal{z}}}^2 } \\right ) } =   -\\log{\\left ( \\dfrac{n_1}{n_2 } \\right ) } \\,.\\ ] ] in practical terms , we start our simulation in one of the two ensembles and after a fixed number of monte carlo steps , we calculate the weight of the current configuration in both ensembles and switch ensembles according to metropolis rules .    when implementing this ensemble switching method , one benefits from an additional advantage of the determinantal qmc framework .",
    "the configuration space of @xmath30 $ ] and @xmath28 is exactly equal , and the transition probabilities @xmath75 and @xmath76 are typically spread over the entire range @xmath77 $ ] . in appendix",
    "[ app : ensemble_switching ] we show that the monte carlo estimate for the rnyi  entropy is actually given as the ratio @xmath78 which can be obtained by two separate simulations .",
    "this allows for much quicker convergence than we would obtain by explicitely switching between ensembles and counting how much time we spent in each one of the two ensembles .",
    "it should further be noted that our approach does not necessarily require to iteratively build up the subsystem @xmath0 from smaller blocks to achieve convergence  @xcite , as it has been observed in the context of world line monte carlo approaches where the overlap between the ensembles might become rather small .",
    "we note that such an iterative build - up is also possible in the context of our dqmc approach if needed .",
    "to demonstrate the applicability and numerical efficiency of our replica switching method to calculate rnyi  entropies within the dqmc framework we study the entanglement of a one - dimensional hubbard chain , which at half - filling does not suffer from the infamous sign problem .",
    "we first concentrate on zero - temperature properties of the entanglement entropy .",
    "we compare our numerical results to the quasi - exact analytical form derived from the conformal field theory description of the gapless theory governing the zero - temperature physics of the hubbard chain in the presence of a finite on - site interaction @xmath8 .",
    "we then turn to finite - temperature properties and show how the rnyi  entropy crosses over from a low - temperature entanglement entropy to a high - temperature thermal entropy .",
    "finally , we discuss the strength of our approach in comparison to a recent proposal to calculate rnyi  entropies for interacting fermion systems from a decomposition in free fermion green s functions @xcite .",
    "we demonstrate that our approach is significantly more efficient in capturing the entanglement properties in the interaction dominated regime of the hubbard model .      in the presence of a repulsive on - site interaction @xmath79 the ground state of the half - filled hubbard chain",
    "is well known to be a mott insulator exhibiting quasi - long range antiferromagnetic order .",
    "this means that at zero temperature charge fluctuations are frozen out entirely for any @xmath79 , while the localized spin degrees of freedom interact via an effective heisenberg exchange of order @xmath80 thereby building up quasi - long range antiferromagnetic order .",
    "the system thus remains gapless and can be described in terms of a conformal field theory with a central charge @xmath81 corresponding to the number of gapless modes .",
    "[ fig : gs_oscillations ]   of a periodic , half - filled hubbard chain with @xmath82 sites in the presence of a repulsive on - site interaction @xmath83 .",
    "shown is the entanglement entropy versus the length of the subsystem @xmath84 .",
    "the numerical data obtained with the zero - temperature dqmc algorithm @xmath85 is in good agreement with dmrg reference data for the same system ( open circles ) .",
    "the inset shows @xmath86 , i.e. the entanglement entropy for a subsystem equal to the whole chain .",
    "a value of @xmath29 corresponds to a perfect purity @xmath87 of the sampled ground state and thus signifies that the projection parameter @xmath88 in the zero - temperature dqmc approach was chosen sufficiently large .",
    "[ fig : central_charge],title=\"fig : \" ]    the entanglement entropy of such a gapless one - dimensional system is known @xcite to exhibit a logarithmic correction to the boundary law , which for a one - dimensional system simply states that the entanglement entropy is a constant for any bipartition . the logarithmic correction , however",
    ", does reflect the relative size of the two subsystems in the bipartition and for all rnyi  entropies follows the general form @xcite @xmath89 } + o(1 )   \\ , ,    \\label{eq : cft_of_l}\\ ] ] where @xmath90 is the central charge of the conformal field theory , @xmath91 is the overall system length and @xmath92 is the length of subsystem @xmath0 .",
    "open and periodic boundary conditions correspond to @xmath93 and @xmath94 , respectively , and further subleading corrections of order @xmath6 in the system size are neglected .",
    "numerical results obtained with the zero - temperature dqmc algorithm ( for details see the appendix ) for an open chain of length @xmath95 are shown in fig .",
    "[ fig : central_charge ] .",
    "we find that the dqmc data is generally in good agreement with quasi - exact results obtained using density matrix renormalization group ( dmrg ) simulations .",
    "we do observe , however , a slight trend of the dqmc data to underestimate ( within the statistical error bars ) the entanglement entropy for some of the intermediate block sizes  an effect which we find to be absent for smaller system sizes ( not shown ) and which previously has also been observed in conceptually similar simulations for spin systems  @xcite using the replica trick in combination with a stochastic series expansion ( sse ) @xcite .",
    "we thus conclude this section with the observation that our replica switching dqmc method is indeed well equipped to efficiently determine the zero - temperature entanglement properties of the half - filled hubbard chain .",
    "site half - filled hubbard chain with @xmath96 .",
    "while at high temperatures the entanglement entropy exhibits a volume law @xmath97 ( indicated by the dashed line ) , it crosses over to a boundary law at low temperatures with a characteristic arc - like structure .",
    "[ fig : oscillations_crossover ] ]    when considering a quantum system at _ finite _ temperatures , both quantum and thermal fluctuations contribute to all entropies including the rnyi  entropy of interest here . increasing the temperature the relative contributions of these two types of fluctuations of course change . as a result",
    "the rnyi  entropy shows a crossover from a boundary law ( with logarithmic corrections ) at zero temperature to a more conventional extensive behavior ( i.e. a volume law ) at high temperature of the form @xmath98 simply counting the number of possible states in the subsystem .",
    "this thermal crossover of the rnyi  entropy from a zero - temperature entanglement entropy to a thermal entropy at high temperatures can easily be observed in our numerical dqmc simulations .",
    "this is illustrated in fig .",
    "[ fig : oscillations_crossover ] for a half - filled hubbard chain of length @xmath99 with intermediate on - site interaction @xmath83 in a temperature range @xmath100 ( for @xmath101 ) . with increasing temperature",
    "the arc - like structure of the low - temperature entanglement entropy disappears and gives way to the simple linear form of an extensive thermal entropy .",
    "this thermal crossover is also reflected in fig .",
    "[ fig : s2_half_chain ] where we plot the rnyi  entropy @xmath102 of an equal - size bipartition of the chain for different system sizes versus temperature .",
    "in particular , we observe the expected data collapse at high temperatures when rescaling the calculated rnyi  entropies by the respective system size , see the right panel of fig .",
    "[ fig : s2_half_chain ] .    .",
    "shown is @xmath103 ( left panel ) and a rescaled @xmath104 ( right panel ) , which at high temperatures converges to @xmath105 for different system sizes .",
    "[ fig : s2_half_chain ] ]     for a grand - canonical dmqc simulation of a half - filled hubbard chain versus temperature for varying on - site interactions @xmath106 and chains of varying length @xmath91 . ]    to quantitatively determine the crossover temperature @xmath107 , below which a finite - sized system is effectively in its ground state , we turn to the so - called _ purity _ @xmath108 which becomes @xmath15 for a quantum mechanical ground state , since the entropy @xmath86 needs to equal its complement @xmath109 and thus must vanish for any quantum mechanical ground state  an observation which is ultimately also responsible for the arc - like structure of the entanglement entropy in eq .  .",
    "indeed we find that the purity sharply rises towards @xmath15 as the temperature is lowered in our simulations , see fig .",
    "[ fig : purity ] where we plot the purity as a function of temperature for different system sizes and a sequence of on - site interactions . on the one hand",
    ", we find that for a fixed value of the on - site interaction the crossover temperature decreases with system size in accordance with the fact that the finite - size gap of the system also decreases with increasing system size . on the other hand",
    ", we observe that for fixed system size the transition temperature @xmath107 decreases as the on - site interactions @xmath8 is reduced reflecting the enhancement of charge fluctuations in this weakly coupled regime .",
    "finally , we note that we generally find somewhat smaller transition temperatures than recent stochastic series expansion ( sse ) simulations  @xcite of the half - filled hubbard chain , which can be tracked back to the fact that our dqmc simulations employ a _ grand - canonical _ ensemble , while the sse simulation in ref .",
    "employed a canonical ensemble .       at temperature @xmath110",
    "@xmath111 . for comparison exact diagonalization data ( for @xmath112 )",
    "is indicated by the open circles . with both codes allocating the exact same amount of cpu time , a much faster convergence of the replica switching method is found . ]",
    "we round off our discussion of our replica switching dqmc method by comparing it to a recent proposal  @xcite to calculate rnyi  entropies from a decomposition in free fermion green s functions .",
    "such a decomposition might seem natural within the dqmc approach , since the hubbard - stratonovich transformation at its heart results in an effective description of free fermions moving in an external potential .    in the spirit of a fair comparison we have implemented the free fermion decomposition method  @xcite using the same algorithmic optimizations as for our replica switching technique whenever possible .",
    "we then ran both codes on identical parameter sets logging the exact same cpu time for both codes .",
    "results from this comparison are summarized in fig .",
    "[ fig : comparison ] where we show results of both approaches for the entanglement entropy of a half - filled 10-site hubbard chain at fixed temperature @xmath113 @xmath111 for different values of the on - site interaction @xmath114 .",
    "while the free fermion decomposition method reproduces the arc - like structure of the entanglement entropy for small on - site interaction @xmath115 , it shows deviations from this behavior already for moderate values of the on - site interaction @xmath83 .",
    "in contrast , our replica switching method nicely reproduces the exact diagonalization data up to strong on - site interaction @xmath116 .",
    "we thus conclude that our approach is significantly more efficient in capturing the entanglement properties in the interaction dominated regime of the hubbard model .",
    "in summary , we have introduced a novel replica switching scheme to efficiently calculate rnyi  entropies for interacting fermionic systems in determinantal quantum monte carlo simulations .",
    "our approach is capable of efficiently determine not only finite - temperature thermal entropies but also zero - temperature entanglement entropies as demonstrated for the half - filled hubbard chain over a range of interactions . in comparison to a recent proposal to calculate rnyi  entropies from a decomposition in terms of free fermion green s functions @xcite , our approach yields much faster convergence and significantly higher numerical efficiency in the regime of strong correlations @xmath117 .",
    "while we have concentrated our discussion on the second rnyi  entropy @xmath118 , it should be noted that the replica technique described here can be expanded in a straight - forward way to also access higher rnyi  entropies .",
    "calculating rnyi  entropies with higher indices @xmath119 , however , requires to simulate a system of size @xmath65 at temperature @xmath120 ( where @xmath121 and @xmath122 correspond to the size of subsystems @xmath0 and @xmath1 , respectively ) .",
    "thus , the computational cost to access these higher rnyi  entropies in our approach sharply increases as the dqmc simulations generally scale as @xmath123 ( where @xmath124 is the total number of sites ) . this should be contrasted to the free - fermion decomposition method of grover @xcite , where the rnyi  entropy can readily be accessed by simply simulating @xmath64 replicas of the system at temperature @xmath17  a much more moderate increase in computational expense .",
    "indeed recent numerical simulations @xcite for the kane - mele model have demonstrated that with the free fermion decomposition method it is feasible to calculate a partial entanglement spectrum , i.e. the spectrum of ( lowest ) eigenvalues of the density matrix , from a sequence of rnyi  entropies .",
    "likely , such a calculation of the entanglement spectrum is out of reach for our technique .",
    "although we have focused our discussion on one - dimensional fermion systems in this manuscript , two dimensional systems can be treated equally well . in particular , we point out that the numerical overhead of our method arising from the simulations of the two copies @xmath1 and @xmath125 ( see fig .  [ fig : ensembleswitchingunfolded ] ) for the second rnyi  entropy reduces with increasing spatial dimensionality : in one dimension an equal - size bipartition results in an overhead of @xmath126 additional sites simulated at temperature @xmath127 . in two spatial dimensions , where we might consider a subsystem @xmath0 of size @xmath128 and its somewhat larger complement , we can choose to simulate the smaller subsystem ( in this case @xmath0 ) twice .",
    "such a simulation would thus only need an overhead of @xmath129 of the sites in comparison to a conventional simulation and thus make it possible to calculate rnyi  entropies for systems of nearly the same size as conventionally investigated in dqmc simulations .",
    "we thank f. assaad , t. grover , and l. bonnes for discussions .",
    "we also thank m. becker for providing the dmrg reference data of fig .",
    "[ fig : central_charge ] and t. grover for providing the exact diagonalization data of fig .",
    "[ fig : comparison ] .",
    "we acknowledge support from sfb tr 12 and the bonn - cologne graduate school of physics and astronomy .",
    "the numerical simulations were performed on the cheops cluster at rrzk cologne .",
    "[ sec : supplemental ]",
    "we will give a short introduction to the basics of determinantal quantum monte carlo that should suffice to understand the modififications to it presented in the main text .",
    "there are many more extensive , excellent reviews on the dqmc method available , such as refs .   among others , on which our exposition is based .",
    "we will start with the finite temperature algorithm and later mention what modifications are necessary to perform ground state simulations .",
    "for concreteness , we will stay within the context of the hubbard model .",
    "the first step in setting up the algorithm is to trotter decompose imaginary time : @xmath130 the occupation number operator @xmath54 , needed for the chemical potential , is from now on included in the potential operator @xmath131 .",
    "the exponential is now separated and the appearing commutator ignored which in turn results in a systematic error of the order @xmath132 .",
    "@xmath133 the kinetic part @xmath134 has only two operators and can be evaluated directly .",
    "the potential part @xmath135 on the other hand is made up of four operators and can therefore not be integrated out analytically .",
    "we thus apply the hubbard - stratonovich transformation to decouple the interaction .",
    "it is based on an identity for gaussian integrals @xmath136 with @xmath0 being the original operator , in our case the on - site interaction @xmath137 .",
    "the price we have to pay is the introduction of the eponymous auxiliary field @xmath138 that couples to the fermions .",
    "the decoupling itself is not unique : we can decouple with respect to the local charge or to the local magnetization .",
    "for the repulsive case , we usually couple to the local magnetization to avoid a complex transformation which is nevertheless possible and can be advantageous  @xcite .",
    "we do , however , break @xmath139 symmetry which is only restored when performing enough updates .",
    "it turns out that in the case of the hubbard model , it is not necessary to work with a continuous auxiliary field , but that we can choose to work with discrete ising spins @xmath138 taking values @xmath140  @xcite .",
    "the decoupling has to be performed for each site and at each time slice .",
    "doing so , we obtain @xmath141 the parameter @xmath142 can be determined by inserting all possible values for the auxiliary field @xmath143 and the spins @xmath144 .",
    "we find @xmath145 inserting this into and switching to an explicit vector notation for the operators , we obtain the following form for the partition function : @xmath146 where @xmath147 and @xmath148 are the matrix representations of the @xmath149 and @xmath131 operator , respectively .",
    "the partition function now consists of one trace over all auxiliary field configurations and another one over the fermionic states which act on a product over all time slices and spins of the discretized and separated exponential .",
    "we continue to rewrite the operators in matrix form @xmath147 and @xmath150 where the index @xmath138 reminds us that the potential part depends on the auxiliary field .",
    "a product @xmath151 will be denoted by @xmath152 and an ordered sequence of all @xmath91 @xmath153-matrices with arbitrary starting point @xmath154 by @xmath155 the time @xmath154 is a multiple of the discretization @xmath156 .",
    "the weight of one configuration of fermions and auxiliary field is then given by @xmath157 we could use this weight to set up the monte carlo simulation , sampling both fermion and auxiliary field configurations .",
    "but this would be very inefficient because the calculation of determinants is numerically very expensive .",
    "instead , we will integrate out the fermions analytically and sample only auxiliary field configurations .",
    "one can prove that the _ grand - canonical _ trace over all fermionic states of the @xmath153-matrix is given by @xmath158 allowing us to explicitly perform the trace over all fermionic states .",
    "one can hardly underestimate the importance of this identity for determinantal qmc simulations . by applying the identity  ,",
    "we are left only with the problem of sampling the auxiliary field where the weight of each configuration is given by one determinant .",
    "the connection to the field is made by the @xmath47 matrices via the potential . using these notations , we can rewrite the partition function as @xmath159 in principle , we are now able to set up our monte carlo simulations . we know the form of the weights and we can sample configurations of auxiliary fields using , for example , the metropolis scheme mentioned before . for the calculation of green s functions and more practical aspects we refer the interested reader to the aforementioned references .      to access ground state properties , we start with a carefully chosen trial wavefunction @xmath58 and project out the excited states by applying a large power of the hamiltonian : @xmath160 the trial wavefunction must be non - orthogonal to the true ground state wavefunction @xmath56 for the procedure to work . for the hubbard model at half filling we chose a spin singlet as trial wave function @xmath58 . setting up the simulation is very similar to the finite temperature algorithm . the projection parameter @xmath88 plays the role of the temperature @xmath17 .",
    "the exponential in   is then decomposed and the interaction term decoupled by a hubbard - stratonovich transformation .",
    "we will not go into further detail because the calculation of the rnyi  entropies for ground state problems was shown to reduce to a modified finite temperature problem .      in dqmc simulations",
    "we are limited by the @xmath161 scaling and have to pay special attention to numerical instabilities .",
    "simulating an artificially enlarged system may thus appear to be very inefficient .",
    "however , enlarging the system and implementing the hamiltonian   goes along with a special matrix structure that we can make use of to lower the numerical cost . in the matrix representation ,",
    "the hopping terms are of the following form : @xmath162 where @xmath147 is the matrix representation of the hopping operator and the index signifies the part of the lattice it connects .",
    "one of the parts @xmath1 and @xmath40 , respecticely , remains unchanged and thus has a @xmath163 on the diagonal and zeros for the off - diagonal terms .",
    "interaction terms will be of the same form .",
    "one can now readily convince oneself that multiplying two matrices in the same imaginary time interval @xmath164 or @xmath165 will not alter this structure because they are block - diagonal .",
    "mixing matrices of different time intervals , on the other hand , will typically result in a dense matrices .",
    "this is inevitably the case when calculating the sequence of @xmath153 matrices  , except for @xmath166 .",
    "even when multiplying a dense matrix with one of the slice matrices , it is not necessary to perform a full matrix multiplication , because of the blocks of zeros present in the slice matrix .",
    "we will show that to estimate the ratio   it suffices to measure the expectation values of @xmath167 and @xmath168 , which are the probabilities to switch ensembles from ensemble @xmath15 to @xmath63 and from ensemble @xmath63 to @xmath15 , respectively . using a metropolis scheme , the probability to switch ensembles for a given configuration @xmath90 is given as @xmath169 where @xmath170 and @xmath171 are the weights in the respective ensembles .",
    "the configurations @xmath90 are configurations of the auxiliary field and both ensembles share the same configuration space @xmath51 .",
    "writing out the ratio of the expectation values for the switching operation gives @xmath172",
    "in this appendix we provide further details on our analysis of the comparison between the replica switching and free fermion decomposition dqmc algorithms as presented in fig .  [",
    "fig : comparison ] of the main text",
    ".    our c++ simulation codes of the two algorithms employ a common code base implementing the same optimizations for many underlying core features ( such as linear algebra subroutines , sampling improvements or parallelization schemes ) for both approaches and further build on the alps libraries  @xcite .",
    "we separately ran 16 independent simulations per data point in fig .",
    "[ fig : comparison ] of the main text each with a different random seed and later merged the results via a jackknife analysis using the alps tools .",
    "the spread of the raw results of all 16 runs before merging are shown in fig .",
    "[ fig : unmerged_comparison ] .    for an allocated computing time of 105 minutes ( per data point and seed )",
    "the number of measurements in the free fermion case was around 3500 per data point and seed ( after initial thermalization ) .",
    "for the replica switching method , we obtained a considerably smaller number of measurements for the switching probabilities in   in the same allocated computing time .",
    "for the largest cut , i.e. @xmath173 , we recorded some 1300 measurements , while for the smallest cut , i.e. @xmath174 we recorded only some 100 measurements .",
    "the lower number of measurements for the ensemble switching method in a given time frame is due to two effects : first , for the replica switching method we have to perform one simulation for an ensemble of two separate systems and one simulation in the connected ensemble .",
    "both of these simulations have to be thermalized in contrast to only one simulation in the free fermion case .",
    "second , the simulation cell of the connected system in the replica switching method is enlarged . for the case of @xmath174 for example",
    ", we effectively simulate a system of size @xmath175 which in combination with the @xmath161 scaling of the algorithm further reduces the number of possible sweeps in a given time .    comparing the results obtained with the two algorithms",
    "the spread of the raw data shows two overall trends .",
    "first , looking at the dependence of the spread of data points with subsystem size @xmath84 , the free fermion decomposition method shows a considerable increase of this spread with increasing subsystem size , while for the replica switching method there is no measurable dependence .",
    "second , with increasing onsite interaction @xmath8 the data spread clearly increases much stronger for the free fermion decomposition method in comparison with the replica switching technique ( which becomes most poignant for large subsystem sizes @xmath84 ) .                                                            in the context of dqmc simulations",
    ", one additional potential origin for the systematic bias might be the discretization of imaginary time .",
    "in our simulations it was generally set to a value of @xmath176 , which for the studied onsite interaction of @xmath177 is smaller than typically needed  @xcite ."
  ],
  "abstract_text": [
    "<S> entanglement measures such as the entanglement entropy have become an indispensable tool to identify the fundamental character of ground states of interacting quantum many - body systems . for systems of interacting spin or bosonic degrees of freedom </S>",
    "<S> much recent progress has been made not only in the analytical description of their respective entanglement entropies but also in their numerical classification . </S>",
    "<S> systems of interacting fermionic degrees of freedom , however , have proved to be more difficult to control , in particular with regard to the numerical understanding of their entanglement properties . here </S>",
    "<S> we report a generalization of the replica technique for the calculation of rnyi  entropies to the framework of determinantal quantum monte carlo simulations  the numerical method of choice for unbiased , large - scale simulations of interacting fermionic systems . </S>",
    "<S> we demonstrate the strength of this approach over a recent alternative proposal based on a decomposition in free fermion green s functions by studying the entanglement entropy of one - dimensional hubbard systems both at zero and finite temperatures . </S>"
  ]
}