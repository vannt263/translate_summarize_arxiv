{
  "article_text": [
    "consider a quantity distributed on @xmath0 .",
    "suppose that the distribution evolves along a controlled vector field @xmath1 according to the law of mass conservation ; the control parameter @xmath2 can be chosen at every time @xmath3 from a compact set @xmath4 .",
    "given a time moment @xmath5 and a target set @xmath6 , we aim at finding a control @xmath7 that maximizes the total mass within @xmath8 at the time moment @xmath9 . more formally the problem can be written as follows @xmath10 where @xmath11 is the density function of an initial distribution and @xmath12\\right\\}\\ ] ] is the set of admissible controls .",
    "first , let us give several motivating examples .    [",
    "[ dynamical - system - with - uncertain - initial - state . ] ] dynamical system with uncertain initial state .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    let @xmath13 be an initial state of the following dynamical system@xmath14 assume that one wants to find a control @xmath7 that brings the state of the system to a target set @xmath8 at a given time @xmath9 .",
    "now let the precise initial state @xmath13 be unknown .",
    "instead , assume that a _ probability distribution _ of @xmath13 on the state space is given .",
    "in this case , one naturally looks for a control that maximizes the _ probability _ of finding the state of the system within the target set at time @xmath9 .",
    "this leads to problem @xmath15 .",
    "[ [ flock - control . ] ] flock control .",
    "+ + + + + + + + + + + + + +    let @xmath16 characterize an initial distribution of sheep in a given area .",
    "assume that the herd drifts along a vector field @xmath17 .",
    "assume , in addition , that there is a dog located at @xmath2 .",
    "in this case , a sheep located at @xmath18 obtains an additional velocity @xmath19 when @xmath20 is positive this means that the sheep tries to escape the dog .",
    "if the interaction between the sheep are not relevant , the motion of the whole herd is described by the equation @xmath21\\rho\\right)=0.\\ ] ] typically , the dog wants to steer the herd to a target set @xmath8 at a given time . in this case",
    "an optimal strategy of the dog is determined by @xmath15 .",
    "[ [ beam - control . ] ] beam control .",
    "+ + + + + + + + + + + + +    the motion of a charged particle in an electromagnetic field is described by the system @xmath22 the particle is characterised by its charge @xmath23 , rest mass @xmath24 , and the relativistic mass @xmath25 . above , @xmath26 are the particle s coordinates , @xmath27 are the velocities , @xmath28 and @xmath29 are the electric and magnetic fields , @xmath30 is the speed of light , and @xmath31 represents additional forces due to the interaction between the particle and the environment .",
    "assume that the electromagnetic field depends on a parameter @xmath2 , which can be chosen at every time moment @xmath3 , i.e. , @xmath32 then   can be rewritten in the form   with @xmath33 .    producing a single particle ( for example , in a particle accelerator )",
    "is extremely difficult . instead , a _ beam of particles _ is produced . at the initial time moment",
    "every beam is characterized by its density function @xmath16 defined on the state space of  .",
    "usually , one wants to focus the beams to ensure that the particles traveling in the accelerator collide . clearly , one can formulate this problem as @xmath15 with the target set @xmath34 where @xmath35 is a desired radius of the beam .",
    "the connection between dynamical systems with uncertain initial states and continuity equations is well - known . in the context of control theory",
    "it was mentioned in  @xcite . a basic mathematical model for flocks controlled by a leader",
    "is presented in  @xcite .",
    "in contrast to these papers we neglect the interactions between flock s members .",
    "formally , a nonlocal term describing the internal dynamics of the flock is omitted . for models of the beam control",
    "we refer to  @xcite .",
    "existence results for optimal control problems governed by continuity equations seem to be missing in the current literature ( at least for nonlinear vector fields @xmath36 ) .",
    "necessary optimality conditions were derived by d.a .",
    "ovsyannikov in  @xcite and by a.i .",
    "propo with his collaborators in  @xcite .",
    "we remark that all the papers mentioned above consider the terminal cost functional @xmath37 with _ smooth _",
    "@xmath20 and/or an integral cost functional .",
    "moreover , the initial density @xmath16 is always assumed to be smooth . finally , let us mention the paper  @xcite of s.s .",
    "mazurenko , where the dynamical programming method was developed , and the papers  @xcite of r. brockett , who discussed controllability and some connections with stochastic equations .",
    "in this paper we first study the existence of optimal controls .",
    "next , assuming that the initial density @xmath16 is smooth and the target set @xmath8 is sufficiently regular , we derive a necessary optimality condition . finally , we discuss the case of integrable @xmath16 and arbitrary @xmath8 .",
    "more precisely , we replace @xmath15 by a perturbed problem @xmath38 which satisfies all the assumptions of our necessary optimality condition .",
    "then we show that every control that is optimal for @xmath38 is `` nearly optimal '' for @xmath15 .",
    "we believe that our choice of the cost functional is not relevant in the sense that the methods developed here should work in other cases as well . at the same time , in many situations it seems natural to maximize the total mass within a target set at a given time moment .",
    "moreover , our choice of the cost functional allows to derive a rather simple necessary optimality condition ( see section  [ sec : pmp ] ) .    as we shall see later , dealing with the continuity equation for measures",
    "is more natural than dealing with that of for functions .",
    "for this reason , the main subject of our study is the following optimal control problem @xmath39 now , @xmath15 is just a particular case of @xmath40 , where the initial probability measure @xmath41 is absolutely continuous with density @xmath16 .",
    "the paper is organized as follows . in section  [ sec : prlim ] we introduce basic notations , discuss the continuity equation and generalized controls . in the next section we study the existence of optimal controls .",
    "then , in section  [ sec : pmp ] , we prove a necessary optimality condition for a special case of @xmath40 , where the initial distribution is absolutely continuous with smooth density and the target set has certain regularity properties . in the last section",
    "we show that the general problem @xmath40 can be replaced by a perturbed problem @xmath38 such that @xmath38 satisfies all the assumptions of our necessary optimality condition and every optimal control for @xmath38 is `` nearly optimal '' for @xmath40 . for the reader",
    "s convenience , we place in appendix a brief introduction to young measures .",
    "in what follows , @xmath42 is the euclidean norm of @xmath43 and @xmath44 is the scalar product of @xmath45 . by @xmath46 and @xmath47 we mean the closed and the open @xmath35-neighbourhoods of @xmath6 , i.e. , @xmath48    let @xmath49 denote the set of all probability measures on @xmath0 .",
    "we equip @xmath49 with the prohorov distance : @xmath50 the convergence in the resulting metric space is exactly the narrow convergence of measures ( see  @xcite ) .    given a borel map @xmath51 and a probability measure @xmath41 , define the _ pushforward ( or image ) measure _ @xmath52 by @xmath53 recall the change of variables formula @xmath54 which holds for all bounded borel functions @xmath55 .",
    "below , @xmath56 is the @xmath57-dimensional lebesgue measure , @xmath58 is the @xmath59-dimensional hausdorff measure , @xmath60 is a probability measure which is absolutely continuous with respect to @xmath56 and whose density is @xmath61 .",
    "consider a vector field @xmath62\\times{{\\mathbb{r}}}^n\\to{{\\mathbb{r}}}^n$ ] satisfying the assumption @xmath63 $ and $ x , x'\\in{{\\mathbb{r}}}^n$,}\\\\ { { \\left|v(t , x)-v(t , x')\\right|}}\\leq l|x - x'| \\quad\\mbox { and } \\quad { { \\left|v(t , x)\\right|}}\\leq c\\left(1+|x|\\right ) .",
    "\\end{cases}\\ ] ] then there exists a unique solution @xmath64 to the cauchy problem @xmath65 the map @xmath66 is called _ the flow of the vector field _",
    "recall that the function @xmath67 is a diffeomorphism and @xmath68 for any @xmath69 $ ] .",
    "for details see , e.g. ,  @xcite .",
    "let @xmath41 be a probability measure on @xmath0 and @xmath36 be a vector field satisfying assumption * ( a0)*. consider the cauchy problem @xmath70    we say that a map @xmath71 ; \\mathcal{p}({{\\mathbb{r}}}^n)\\right)$ ] is a _ distributional solution _ to   if for any bounded lipschitz continuous test function @xmath72\\times{{\\mathbb{r}}}^n\\to { { \\mathbb{r}}}$ ] , we have @xmath73 and @xmath74 .    as is known  @xcite , under assumption * ( a0 ) * there exists a unique distributional solution to  . moreover",
    ", this solution can be written in the form @xmath75,\\ ] ] so that @xmath76 is the pushforward of @xmath41 by @xmath77 .",
    "if @xmath41 is absolutely continuous , i.e. , @xmath78 , then   implies that @xmath76 is absolutely continuous for each @xmath3 .",
    "more precisely , we have @xmath79 , where @xmath80      recall that by ( usual ) controls we mean the maps belonging to @xmath81 .",
    "we shall see later that in some cases it is more convenient to deal with _ generalized controls_. we define such controls via young measures",
    ". a brief discussion of young measures is given in appendix ; for a more solid introduction to the subject see , for instance ,  @xcite .",
    "a _ generalized control _ is a young measure @xmath82;{{\\mathbb{r}}}^m\\right)$ ] whose support is contained in @xmath83\\times u$ ] .",
    "the set of all generalized controls is denoted by @xmath84;u\\right)$ ] .",
    "it is evident that a young measure @xmath85 _ associated with _",
    "a usual control @xmath86 belongs to @xmath84;u\\right)$ ] .",
    "[ prop : compact ] the set of generalized controls @xmath84;u\\right)$ ] is compact in the space of young measures @xmath84;{{\\mathbb{r}}}^m\\right)$ ] .",
    "the set @xmath84;u\\right)$ ] is relatively narrowly compact by theorem  [ thm : prokhorov ] .",
    "it remains to verify that it is closed . to this end , consider a converging sequence @xmath87;u\\right)$ ] with the narrow limit @xmath85 .",
    "we only have to show that the support of @xmath85 is contained in @xmath83\\times u$ ] . for each @xmath88 , we have @xmath890,t[\\times u^c\\,\\right)=0 $ ] , where @xmath90 is the complement of @xmath91 .",
    "since the set @xmath920,t[\\times u^c$ ] is open , it follows from basic properties of the narrow convergence that @xmath930,t[\\times u^c\\,\\right ) \\geq \\nu\\left(\\,]0,t [ \\times u^c\\,\\right)=\\nu\\left([0,t]\\times u^c\\right).\\ ] ]    we say that @xmath94 is a _ trajectory corresponding to a generalized control _ @xmath85 if @xmath94 is a distributional solution to the cauchy problem @xmath95 where @xmath96 with @xmath97}$ ] being the _ disintegration _ of @xmath85 .",
    "here we gather several useful lemmas about sequences of pushforward measures and their limits .",
    "[ lem : mu_j ] suppose that @xmath98 for @xmath99 , and @xmath51 is a continuous function . if @xmath100 narrowly , then @xmath101 narrowly .    by the change of variables formula",
    ", we have @xmath102 for each bounded continuous test function @xmath20 .",
    "it remains to notice that @xmath103 is also bounded and continuous .",
    "[ lem : f_j ] let @xmath104 , @xmath105 , be continuous functions , and @xmath106 . if @xmath107 pointwise , then @xmath108 narrowly .",
    "for every bounded continuous test function @xmath20 , we can write @xmath109 clearly , @xmath110 pointwise . now to complete the proof , we apply the lebesgue dominated convergence theorem to the right - hand side of the latter identity .",
    "[ lem : weakf ] let @xmath111\\times{{\\mathbb{r}}}^n\\to{{\\mathbb{r}}}^n$ ] , @xmath105 , be vector fields satisfying * ( a0 ) * with common constants @xmath112 and @xmath113 , and let @xmath114 denote a solution to the cauchy problem @xmath115 if @xmath116 weakly in @xmath117;{{\\mathbb{r}}}^n\\right)$ ] for all @xmath18 , then @xmath118 for all @xmath119 $ ] .    for",
    "a fixed @xmath3 consider the obvious identity @xmath120{\\mathinner{\\mathrm{d}{s } } } \\\\ & + \\int_0^t \\left[v_j(s , x_0(s))-v_0(s , x_0(s))\\right]{\\mathinner{\\mathrm{d}{s}}}.\\end{aligned}\\ ] ] observing that @xmath121 we obtain , by gronwall s inequality , the following estimate : @xmath122 where @xmath123{\\mathinner{\\mathrm{d}{s}}}.\\ ] ]    to complete the proof it remains to show that @xmath124 .",
    "for this purpose , take a sequence @xmath125 such that @xmath126 and consider the identity @xmath127{\\mathinner{\\mathrm{d}{s } } } \\\\ & + \\sum_{i=1}^{n}\\int_{\\tau_{i-1}}^{\\tau_i}\\left[v_j(s , x_0(\\tau_{i-1}))-v_0(s , x_0(\\tau_{i-1}))\\right]{\\mathinner{\\mathrm{d}{s } } } \\\\ & + \\sum_{i=1}^{n}\\int_{\\tau_{i-1}}^{\\tau_i}\\left[v_0(s , x_0(\\tau_{i-1}))-v_0(s , x_0(s))\\right]{\\mathinner{\\mathrm{d}{s}}}.\\end{aligned}\\ ] ] by assumption * ( a0 ) * , we have @xmath128 for all @xmath129 , @xmath88 , and @xmath130 .",
    "moreover , by applying the standard ode s technique , we can easily verify that @xmath131,\\ ] ] where @xmath132 depends only on @xmath3 , @xmath133 , and @xmath113 .",
    "therefore , @xmath134{\\mathinner{\\mathrm{d}{s}}}\\big|.\\ ] ] passing to the limit as @xmath135 and then as @xmath136 , we get @xmath124 .",
    "[ lem : weakmu ] let @xmath106 and @xmath137\\to \\mathcal{p}({{\\mathbb{r}}}^n)$ ] denote a solution to the cauchy problem @xmath138 where the vector fields @xmath139 satisfy the assumptions of lemma  [ lem : weakf ] .",
    "if @xmath116 weakly in @xmath117;{{\\mathbb{r}}}^n\\right)$ ] for all @xmath18 , then @xmath140.\\ ] ]    let @xmath141 denote the flow of @xmath139 .",
    "in view of lemma  [ lem : weakf ] , the sequence @xmath142 converges pointwise to @xmath143 .",
    "since @xmath144 , the statement follows from lemma  [ lem : f_j ] .",
    "[ lem : convex ] let @xmath145 and @xmath146 .",
    "if the support of @xmath41 is contained in a compact set @xmath147 , then @xmath148 where @xmath149 is the convex hull of @xmath150 .",
    "choose a sequence of probability measures of the form @xmath151 and such that @xmath152 narrowly .",
    "this can be done as in  ( * ? ? ?",
    "* example 8.1.6 ) .",
    "clearly , @xmath153 at the same time , we have @xmath154 since @xmath149 is closed , the proof is complete .",
    "in this section we study the existence of optimal controls for @xmath40 . throughout the section , we make the following assumption @xmath155\\times { { \\mathbb{r}}}^n\\times u\\to{{\\mathbb{r}}}^n$ is continuous ; there are positive}\\\\ \\mbox{constants $ l$ , $ c$ such that , for all $ t\\in [ 0,t]$ , $ u\\in u$ , and $ x , x'\\in{{\\mathbb{r}}}^n$,}\\\\ { { \\left|v(t , x , u)-v(t , x',u)\\right|}}\\leq l|x - x'| \\quad\\mbox { and } \\quad { { \\left|v(t , x , u)\\right|}}\\leq c\\left(1+|x|\\right ) .",
    "\\end{cases}\\ ] ]    first , we prove that @xmath40 has solutions within the space of generalized controls .",
    "then , under additional assumptions , we show that every trajectory corresponding to a generalized control can be produced by a usual one .",
    "[ thm : exitence ] if the target set @xmath8 is closed , then @xmath40 has a solution within the space @xmath84;u\\right)$ ] of generalized controls .",
    "let @xmath156 be a maximizing sequence of generalized controls .",
    "in view of proposition  [ prop : compact ] , we may assume , without loss of generality , that @xmath157 converges to some @xmath158 .    consider the averaged vector fields @xmath139 defined by @xmath159 it is easy to see that each @xmath139 satisfies assumption * ( a0 ) * with constants @xmath112 and @xmath113 as in assumption * ( a1)*. hence , for each @xmath88 , there exists a unique trajectory @xmath160 corresponding to @xmath161 .    for a given @xmath162 ,",
    "we denote by @xmath163 a continuous extension of @xmath164 to @xmath83\\times { { \\mathbb{r}}}^m$ ] with the property that @xmath165\\;\\mbox { and } \\ ; u\\in{{\\mathbb{r}}}^m.\\ ] ] such an extension exists by the tietze theorem .",
    "it is clear that @xmath166    by using proposition  [ prop : ymlimit ] , we get @xmath167;{{\\mathbb{r}}}^m\\right)\\ ] ] for every @xmath18 .",
    "now lemma  [ lem : weakmu ] asserts that @xmath168 therefore , @xmath169 so that @xmath158 is optimal for @xmath40 .",
    "this completes the proof .",
    "[ cor : existence ] let @xmath36 have the form @xmath170 for some real - valued functions @xmath171 .",
    "let the set @xmath172 be convex , and the target set @xmath8 be closed .",
    "then @xmath40 has a solution within the space @xmath81 of usual controls .",
    "let @xmath85 be an optimal generalized control .",
    "the corresponding averaged vector field is given by @xmath173 thus to complete the proof , it suffice to show that there exists a measurable function @xmath174\\to u$ ] such that @xmath175 for almost every @xmath119 $ ] .",
    "the latter follows from filippov s lemma  @xcite , since @xmath176,\\ ] ] according to lemma  [ lem : convex ] .",
    "throughout this section , in addition to * ( a1 ) * , we make the assumption +    [ cols=\"^ , < \" , ]     [ thm : pmp ] let @xmath8 be a compact set with the interior ball property is the union of closed balls of a certain positive radius @xmath35 . ] and @xmath177 with @xmath178 .",
    "let @xmath179 be an optimal control for @xmath40 and @xmath180 be the corresponding trajectory .",
    "then for almost every @xmath181 $ ] , we have @xmath182 here @xmath183 with @xmath184 being the flow of the vector field @xmath185 , @xmath186 is the measure theoretic outer unit normal to @xmath187 at @xmath18 , @xmath58 is the @xmath59-dimensional hausdorff measure , @xmath188 is the density of @xmath189 .",
    "\\1 . if @xmath190 is an @xmath59-dimensional @xmath191 surface , then @xmath8 automatically has the interior ball property .",
    "moreover , each @xmath192 is also an @xmath59-dimensional @xmath191 surface .",
    "consequently , in this case @xmath193 is the usual outer unit normal to @xmath187 at @xmath18 , and @xmath58 is the usual @xmath59-dimensional volume form .",
    "the necessary optimality condition has a visual geometrical meaning .",
    "let @xmath194 be optimal .",
    "shift the target set @xmath8 along the vector field @xmath195 backwards .",
    "denote the resulting image of @xmath8 at the time moment @xmath196 by @xmath187 .",
    "then @xmath197 minimizes the outflow through @xmath192 at almost every time moment @xmath196 .",
    "the proof of theorem  [ thm : pmp ] is based on ideas of the pontryagin maximum principle ( see , e.g. ,  @xcite ) .",
    "in addition , it relies on notions of the _ interior ball property _ of a set and the _ directional derivative _ of a real - valued function on @xmath49 .",
    "we discuss these notions below , but first let us briefly outline the proof .",
    "[ [ sketch - of - the - proof ] ] sketch of the proof : + + + + + + + + + + + + + + + + + + + +    let @xmath198 be an optimal control , @xmath199 be the corresponding trajectory , and @xmath184 be the flow of @xmath195 . fix some @xmath181 $ ] and consider the map @xmath200 defined for all absolutely continuous @xmath41 with smooth density .",
    "first , we show that @xmath201 is _ directionally differentiable _ with respect to any vector field @xmath202 and compute its derivative @xmath203 .",
    "then , we construct a needle variation @xmath204 of @xmath179 and show that @xmath205 where @xmath206 is the trajectory corresponding to @xmath207 and @xmath208 is a certain vector field depending on @xmath196 .",
    "now , the necessary optimality condition is as follows : @xmath209      recall that a compact set @xmath8 has _ the interior ball property of radius @xmath210 _ if it is the union of closed balls of radius @xmath35 .",
    "such sets have nice regularity properties ; in particular , @xmath190 is @xmath59-rectifiable  @xcite and @xmath211 where @xmath212 is the volume of the @xmath57-dimensional unit ball  @xcite . as a consequence ,",
    "the measure theoretic outer unit normal @xmath213 to @xmath8 at @xmath18 exists for @xmath58-a.e .",
    "@xmath214 .",
    "[ lem : preballs ] let @xmath215 be a diffeomorphism such that @xmath216 . then for any @xmath217 , we have @xmath218    we prove only the first inclusion , for the second one is entirely similar .",
    "fix some @xmath219 . since @xmath20 is a diffeomorphism ,",
    "it is enough to show that @xmath220_{b{\\varepsilon}}.\\ ] ] indeed , for any @xmath221 , there exists @xmath222 such that @xmath223 . by the lipschitz condition : @xmath224 hence , for any @xmath221 , we have @xmath225 .    [",
    "prop : mainbound ] let @xmath41 be an absolutely continuous probability measure with a continuous density @xmath61 .",
    "let @xmath6 be a compact set with the interior ball property of radius @xmath35 .",
    "let @xmath226 be diffeomorphisms such that @xmath227 are bounded from above by a positive constant @xmath228 .",
    "then , @xmath229 where @xmath230 .",
    "first , notice that @xmath231 and @xmath232 set @xmath233 , where @xmath234 is the _",
    "hausdorff distance _ between compact sets , i.e. , @xmath235 we get @xmath236_l \\quad\\mbox{and}\\quad { \\varphi}_1(a)\\subseteq [ { \\varphi}_2(a)]_l.\\ ] ] lemma  [ lem : preballs ] yields @xmath237_l\\subseteq { \\varphi}_1(a_{lb}),\\ ] ] so that @xmath238 the lipschitz condition for @xmath239 implies that @xmath240 while the reynolds transport theorem  @xcite yields @xmath241 recalling  , we get @xmath242 combining all the previous inequalities , we obtain the following estimate : @xmath243 the similar estimate holds for @xmath244 . in order to complete the proof , it remains to observe that @xmath245      the basic idea employed here is to determine directions in @xmath49 by @xmath246 vector fields .",
    "hence the usual concept of directional derivative will be modified as follows .",
    "[ def : dirderiv ] we say that a map @xmath247 is _ directionally differentiable with respect to a vector field _",
    "@xmath202 at a point @xmath106 if there exists the limit @xmath248 where @xmath249 is the flow of @xmath250 . in this case",
    "@xmath251 is called the _ directional derivative _ of @xmath201 with respect to @xmath250 at @xmath41 .",
    "[ prop : dirderive ] let @xmath6 be a compact set with the interior ball property of radius @xmath35 .",
    "the map @xmath247 defined by @xmath252 is directionally differentiable with respect to any vector field @xmath250 at every point @xmath253 , with @xmath254 , and its directional derivative is given by @xmath255 where @xmath213 is the measure theoretic outer unit normal to @xmath8 at @xmath18 .",
    "it follows from the reynolds transport theorem that@xmath256 now , by applying the gauss - green theorem , we complete the proof .",
    "let @xmath179 be an optimal control and @xmath257 be the corresponding trajectory .",
    "given @xmath2580,t]$ ] and @xmath259 , we define the perturbed control @xmath204 by the formula @xmath260,\\\\ \\bar u(t ) & \\mbox{otherwise } , \\end{cases}\\ ] ] and denote the corresponding trajectory by @xmath261 .",
    "let @xmath262 and @xmath184 be the flows of the vector fields @xmath263 and @xmath195 .",
    "notice that @xmath264 finally , let @xmath249 denote the flow of the vector field @xmath265    [ lem : needle ] under the assumptions of theorem  [ thm : pmp ] , we have @xmath266,\\ ] ] where @xmath201 is defined by  .",
    "* in view of  , we have to verify that @xmath267.\\ ] ]    * 2 . * it follows from   that the map @xmath268 is lipschitz continuous .",
    "now , by proposition  [ prop : mainbound ] and by the lipschitz property of @xmath269 , we obtain @xmath270 for some positive @xmath271 .",
    "* 3 . * for each @xmath43 , we have @xmath272{\\mathinner{\\mathrm{d}{s } } } \\notag \\\\ \\label{eq : first } & \\;= -w\\left(x\\right ) { \\varepsilon}- \\int_{0}^{{\\varepsilon}}\\int_0 ^ 1 dw\\left(\\alpha w_s^0(x ) + ( 1-\\alpha)x\\right){\\mathinner{\\mathrm{d}{\\alpha}}}\\cdot \\left(w_s^0(x)-x\\right){\\mathinner{\\mathrm{d}{s}}}.\\end{aligned}\\ ] ] on the other hand , it follows from * ( a1 ) * that @xmath273 for all @xmath274 $ ] and @xmath43 , where @xmath275    * 4 .",
    "* fix some @xmath276 .",
    "let @xmath277 and @xmath278 denote the solutions to the cauchy problems @xmath279 correspondingly .",
    "in particular , we have @xmath280.\\ ] ] notice that @xmath281 - \\left[\\chi_{{\\varepsilon}}(\\tau - { \\varepsilon } ) - x\\right ] \\\\ & =   \\int_{\\tau- { \\varepsilon}}^{\\tau }   \\left [ v\\left(s,\\chi_{{\\varepsilon}}(s),\\omega\\right ) - v\\left(s,\\bar\\chi(s),\\bar u(s)\\right ) \\right ] { \\mathinner{\\mathrm{d}{s } } } \\\\ & = \\int_{\\tau- { \\varepsilon}}^{\\tau }   \\left [ v\\left(s,\\chi_{{\\varepsilon}}(s),\\omega\\right ) - v\\left(s,\\bar\\chi(s),\\omega\\right ) \\right ] { \\mathinner{\\mathrm{d}{s } } } \\\\ & \\;\\;\\;+ \\int_{\\tau- { \\varepsilon}}^{\\tau }   \\left [ v\\left(s,\\bar\\chi(s),\\omega\\right ) - v\\left(s,\\bar\\chi(s),\\bar u(s)\\right ) \\right ] { \\mathinner{\\mathrm{d}{s } } } \\\\   & = \\int_{\\tau- { \\varepsilon}}^{\\tau }   \\int_0 ^ 1 d_xv\\left(s,\\alpha\\chi_{{\\varepsilon}}(s)+(1-\\alpha)\\bar\\chi(s),\\omega\\right){\\mathinner{\\mathrm{d}{\\alpha}}}\\cdot \\left(\\chi_{{\\varepsilon}}(s ) - \\bar\\chi(s ) \\right ) { \\mathinner{\\mathrm{d}{s } } } \\\\ & \\;\\;\\;+ \\int_{\\tau- { \\varepsilon}}^{\\tau }   \\left [ v\\left(s,\\bar\\chi(s),\\omega\\right ) - v\\left(s,\\bar\\chi(s),\\bar u(s)\\right ) \\right ] { \\mathinner{\\mathrm{d}{s}}}.\\end{aligned}\\ ] ] in other words , for every @xmath276 , we get @xmath282 { \\mathinner{\\mathrm{d}{s } } } \\\\",
    "\\hspace{-6pt}+ \\int_{\\tau- { \\varepsilon}}^{\\tau }   \\int_0 ^ 1 d_xv\\left(s,\\alpha\\hat v_{\\tau}^{s}(x ) + ( 1-\\alpha)\\bar v_{\\tau}^{s}(y),\\omega\\right ) { \\mathinner{\\mathrm{d}{\\alpha } } } \\\\ \\cdot \\left",
    "( \\hat v_{\\tau}^{s}(x ) - \\bar v_{\\tau}^{s}(y ) \\right ) { \\mathinner{\\mathrm{d}{s}}}.\\end{gathered}\\ ] ] finally , it follows from * ( a1 ) * that @xmath283 $ ] and @xmath276 , where @xmath284 * 5 .",
    "* set @xmath285 .",
    "now we combine   , and then recall   together with * ( a1 ) * in order to estimate the derivatives of the vector fields . in this way we find that @xmath286 for every @xmath287 , where @xmath288 as a consequence , we get @xmath289 notice that the map @xmath290 is integrable .",
    "hence , applying the lebesgue differentiation theorem and then looking at the definition of @xmath250 , we conclude that   holds for almost every @xmath181 $ ] .",
    "this completes the proof of lemma  [ lem : needle ] .",
    "now in view of proposition  [ prop : dirderive ] and lemma  [ lem : needle ] , we see that @xmath291 for almost every @xmath181 $ ] , where @xmath292 is the density of @xmath293 .",
    "since @xmath180 is an optimal trajectory , it follows that @xmath294 for every @xmath295 . therefore , @xmath296 where @xmath183 . by the definition of @xmath250",
    ", we obtain @xmath297 for all @xmath259 and almost every @xmath181 $ ] .",
    "the latter inequality is clearly equivalent to  .",
    "the proof of theorem  [ thm : pmp ] is complete .",
    "our necessary optimality condition has two major drawbacks : the initial measure @xmath41 must be absolutely continuous with smooth density and the target set @xmath8 must have the interior ball property . in this section",
    "we show how to deal with control problems that do not satisfy the above assumptions . in what follows",
    ", we suppose that @xmath8 is a compact set and @xmath41 is an arbitrary probability measure ; assumptions * ( a1 ) * and * ( a2 ) * are still valid .",
    "let @xmath298 be the standard mollifier and @xmath299 for any positive @xmath295 .",
    "define the _ convolution _ of a probability measure @xmath41 and the map @xmath300 by @xmath301 the function @xmath302 is known to be smooth  @xcite . by using the fubini theorem , we easily obtain the identity @xmath303 so that @xmath304 is a well defined probability measure .",
    "let us perturb the initial problem @xmath40 in the following way : @xmath305 where @xmath306 .",
    "[ thm : vs ] let @xmath307 be optimal for @xmath38 . then every accumulation point @xmath308 of the family @xmath309 is optimal for @xmath40 and @xmath310 as @xmath311 .",
    "moreover , if @xmath41 is absolutely continuous and @xmath312 , then @xmath313 where @xmath314 denotes the trajectory corresponding to the initial distribution @xmath41 and the generalized control @xmath307 .",
    "notice that @xmath38 satisfies all the assumptions of theorem  [ thm : pmp ] .",
    "hence , instead of dealing directly with @xmath40 , we may consider the perturbed problem @xmath38 and try to find its solution with the aid of theorem  [ thm : pmp ] .",
    "suppose that we are managed to obtain such a solution .",
    "let us denote it by @xmath307 .",
    "then theorem  [ thm : vs ] states that @xmath307 approximates ( in the narrow topology ) a certain solution of the initial problem @xmath40 .",
    "moreover , if @xmath41 is absolutely continuous and @xmath312 , then @xmath307 is nearly optimal for @xmath40 in the sense of equation  .",
    "\\2 . in general",
    "one must perturb both the initial distribution @xmath41 and the target set @xmath8 even if @xmath8 has already the interior ball property . indeed , consider the following control system in @xmath315 : @xmath316 assume that the target set @xmath8 is the unit ball centered at @xmath317 and @xmath318 .",
    "our aim is to bring the state of the system to @xmath8 at the time moment @xmath319 .",
    "clearly , this can be done by means of the control @xmath320 .",
    "hence @xmath179 is a solution to the maximization problem : @xmath321 and @xmath322 . perturbing only the initial distribution",
    ", we get the following problem : @xmath323 it is easy to see that @xmath324 tends to @xmath325 , which is strictly less then @xmath326 .",
    "[ lem : convolution ] let @xmath106 and @xmath327 .",
    "then , @xmath328 .    by",
    "@xcite it is enough to show that @xmath329 for any borel set @xmath8 . but",
    "this follows from the computations : @xmath330    [ lem : convergence ] let @xmath106 , @xmath331 , @xmath332 , @xmath210 , and @xmath8 be a closed set .    1 .   if @xmath333 for all @xmath295 , then @xmath334 .",
    "2 .   if @xmath335 narrowly as @xmath311 , then @xmath336 .",
    "the inequality @xmath337 implies that @xmath338 therefore , @xmath339 and @xmath340 is established .    since @xmath341 narrowly as @xmath311 , there exists a subsequence @xmath342 with @xmath343 as a consequence , we have @xmath344 passing to the limit as @xmath135 yields @xmath345 which proves @xmath346 .",
    "[ lem : equicont ] let @xmath347 , @xmath348 be probability measures on @xmath0 and @xmath85 be a generalized control .",
    "then , @xmath349 where @xmath350 is the trajectory corresponding to the initial distribution @xmath41 and the generalized control @xmath85 and @xmath351 .",
    "let @xmath352 , where @xmath353 is the flow of the vector field @xmath354 clearly , @xmath20 is a diffeomorphism , @xmath355 , and @xmath356 the inequality @xmath357 means that @xmath358 for any @xmath359 and any borel set @xmath360 .",
    "it follows from lemma  [ lem : preballs ] that @xmath361 therefore , for any @xmath359 and any borel set @xmath360 , we have @xmath362 that is , @xmath363 as desired .      * 1 .",
    "* let us show that @xmath364 it follows from lemma  [ lem : convolution ] that @xmath365 .",
    "now lemma  [ lem : equicont ] yields @xmath366 hence we can write @xmath367 passing to the limit as @xmath311 and taking into account lemma  [ lem : weakmu ] , we obtain  .",
    "* 2 . * since @xmath307 is optimal for ( @xmath368 ) , we have @xmath369 on the other hand , lemma  [ lem : convergence]@xmath340 , together with  , implies that @xmath370 hence passing to the limit in   yields @xmath371 so that @xmath372",
    "assume that a subsequence @xmath373 converges narrowly to some @xmath374 .",
    "then , by  , we have @xmath375 now lemma  [ lem : convergence]@xmath346 implies that @xmath376 comparing this inequality with  , we conclude that @xmath308 is optimal for ( @xmath377 ) .",
    "* 4 . * to complete the first part of the proof , it remains to show that @xmath378 or , equivalently , @xmath379 where @xmath308 is an accumulation point of @xmath380 . to this end , take any converging sequence @xmath381 ( we may always find one , since every @xmath382 belongs to the compact segment @xmath383 $ ] ) .",
    "extract from it a subsequence @xmath384 such that @xmath385 converges narrowly to some @xmath308 .",
    "then , by  , we obtain @xmath386 now it follows from lemma  [ lem : convergence]@xmath346 that @xmath387 thus , every converging subsequence of @xmath388 satisfies  .",
    "this proves  .",
    "let us prove the second part of the theorem .",
    "again , take any converging sequence @xmath389 .",
    "extract a subsequence @xmath390 such that @xmath391 converges narrowly to some @xmath308 as @xmath392 . in this case , by lemma  [ lem : weakmu ] , we have @xmath393 since @xmath41 is absolutely continuous , we conclude that @xmath394 is absolutely continuous as well . now the identity @xmath312 imlies that @xmath8 is a _",
    "continuty set _ of @xmath394 .",
    "thus , it follows from   that @xmath395 in other words , every converging subsequence of @xmath396 has @xmath397 as its limit .",
    "this proves   and completes the proof of theorem  [ thm : vs ] .",
    "below , @xmath56 is the lebesgue measure on @xmath398 , @xmath399 is a borel set with @xmath400 , and @xmath401 is the @xmath58-algebra of all borel measurable subsets of @xmath402 .",
    "the _ narrow topology _ on @xmath406 is the weakest topology for which the maps @xmath407 are continuous , where @xmath20 runs through the set of all bounded charatodory integrands - measurable map which is continuous w.r.t . the second variable . ]",
    "@xmath20 on @xmath403 .",
    "\\1 . in the above definition one",
    "may replace charathodory integrands by continuous ones .",
    "this fact follows easily from the scorza - dragoni theorem . as a consequence",
    ", the narrow convergence of young measures enjoys all the properties of the narrow convergence of probability measures .",
    "\\2 . in the definition one",
    "may also take test functions of the form @xmath408 where @xmath8 is a borel subset of @xmath402 and @xmath201 is a bounded continuous function on @xmath409 .",
    "bearing that in mind , one may easily show that the narrow limit of a sequence of young measures is a young measure . indeed , taking @xmath410 , we get @xmath411        every young measure @xmath85 can be described by its _ disintegration _ , which is a family @xmath414 of probability measures on @xmath409 characterized by @xmath415 where @xmath416 .",
    "one may show that for any @xmath85-integrable @xmath417 @xmath418{\\mathinner{\\mathrm{d}{x}}}.\\ ] ] consider , for instance , the young measure @xmath85 associated with a measurable function @xmath419 .",
    "its disintegration is @xmath420 .",
    "the notion of disintegration explains why we think of young measures as generalized controls .",
    "indeed , a map @xmath412 is a usual control : at every @xmath18 the value of the control parameter is prescribed and equal to @xmath421 .",
    "a young measure @xmath85 is a generalized control : at every @xmath18 the control parameter is taken randomly according to the probability distribution @xmath422",
    ". therefore young measures are analogous to mixed strategies in game theory , where players choose their strategies randomly according to a probability distribution .",
    "[ prop : ymlimit ] let @xmath156 be a sequence of young measures .",
    "let @xmath423 be a bounded continuous map .",
    "if @xmath156 converges narrowly to a young measure @xmath85 , then the sequence of maps @xmath424 converges to the map @xmath425 weakly in @xmath426 .    take a bounded measurable function @xmath427 .",
    "the map @xmath428 is a bounded carathodory integrand .",
    "therefore , @xmath429 we may equivalently write @xmath430 changing @xmath20 on a @xmath56-negligible set does not affect both sides of the equality . therefore , it holds for any @xmath431 ."
  ],
  "abstract_text": [
    "<S> an optimal control problem for the continuity equation is considered . </S>",
    "<S> the aim of a `` controller '' is to maximize the total mass within a target set at a given time moment . </S>",
    "<S> the existence of optimal controls is established . for a particular case of the problem , where an initial distribution is absolutely continuous with smooth density and the target set </S>",
    "<S> has certain regularity properties , a necessary optimality condition is derived . </S>",
    "<S> it is shown that for the general problem one may construct a perturbed problem that satisfies all the assumptions of the necessary optimality condition , and any optimal control for the perturbed problem , is nearly optimal for the original one .    _ </S>",
    "<S> 2000  mathematics subject classification : _ </S>",
    "<S> 49k20 , 49j15    _ keywords : _ continuity equation , liouville equation , optimal control , beam control , flock control , necessary optimality condition , variational stability </S>"
  ]
}