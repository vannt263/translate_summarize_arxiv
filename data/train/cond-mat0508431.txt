{
  "article_text": [
    "quantum monte carlo ( qmc ) simulation is a powerful and versatile method for the investigation of thermodynamic properties of many - body systems . when generating a markov - chain of configurations using a metropolis scheme  @xcite , it is known that updates based on local changes are inefficient , particularly near critical points . at transitional points",
    "this type of algorithm gives very large autocorrelation times , a phenomenon one refers to as critical slowing down  @xcite . by developing non - local update schemes ,",
    "this problem has been overcome for second order phase transitions .",
    "the wolff single cluster algorithm  @xcite and the swendsen - wang multiple cluster algorithm  @xcite , both used to solve classical physics problems , were successful applications of this idea .",
    "in the same spirit , loop algorithms  @xcite were developed for the study of discrete quantum systems .",
    "new configurations are obtained by flipping clusters in the form of loops . the systematic error caused by the the suzuki - trotter approximation  @xcite",
    "was eliminated by formulating the world - line algorithms directly in continuous imaginary time  @xcite . in the worm algorithm",
    "@xcite , the partition function is embedded in an extended configuration space , allowing a direct and exact evaluation of the one - body green s function .",
    "the concept of non - local loop updates has also been implemented in the stochastic series expansion ( sse ) representation  @xcite , leading to operator loop update algorithms  @xcite and directed loop algorithms  @xcite , which are a further optimization of the loop construction .",
    "the general idea behind this is to construct moves in a locally optimal way  @xcite .",
    "all the non - local update world - line algorithms which are mentioned above sample the grand - canonical ensemble . in this way",
    "one can generate configurations with e.g. varying magnetization or occupation number .",
    "results for the canonical ensemble are obtained by using only the configurations with the right particle number @xcite or by rejecting loop updates which change this number @xcite .",
    "it is clear that this is an inefficient way of working . sampling the canonical ensemble",
    "directly would be advantageous when studying systems where particle - conservation is important .",
    "one example is the transition between the superfluid and the mott phase in the bose - hubbard model at constant filling .",
    "this transition belongs to the ( d+1)-dimensional xy universality class @xcite .",
    "when entering the superfluid phase , it becomes difficult to keep the number of bosons constant and tuning the chemical potential can become a very time - consuming task . when simulating mesoscopic systems like superconducting grains @xcite or atomic nuclei @xcite , it is primordial to keep the number of particles constant . a world - line algorithm satisfying these conditions",
    "is presented @xcite and discussed in detail in this paper .",
    "besides particle - number conservation , the algorithm allows to include other symmetry - projections .",
    "it is constructed in such a way that all moves are accepted , which makes it efficient to run and easier to code .",
    "though working in the canonical ensemble , our algorithm is still able to generate configurations with different winding numbers , in contrast to the local world - line method by hirsch _ et al .",
    "we will demonstrate the versatility of the method by applying it to bosons and to paired fermions .",
    "practically all qmc methods are based on a decomposition of the evolution operator @xmath0 .",
    "the trick is to break up this operator into pieces which can be handled exactly @xcite .",
    "generally one can write the hamiltonian as consisting of an easy part @xmath1 and a residual interaction @xmath2 , @xmath3 the minus sign has been included to ease notations further on .",
    "for such a hamiltonian , one can make an exact perturbative expansion in @xmath2 of the evolution operator , using the following integral expression  @xcite : @xmath4 with @xmath5exp@xmath6exp@xmath7 and @xmath8 the inverse temperature ( also called imaginary time ) .",
    "the basic idea of the continuous - time loop algorithm @xcite and the worm algorithm @xcite is to insert two adjoint world - line discontinuities . by propagating one of these discontinuities ( which are called the mobile worm head and stationary worm tail ) through lattice space and imaginary time , the configuration changes in such a way that detailed balance is fulfilled . at that point one",
    "is not sampling according to the partition function tr@xmath9 , but according to an extension hereof , @xmath10 with @xmath11 the imaginary time interval between the worm head operator @xmath12 and tail operator @xmath13 . the worm head can be creating or annihilating , depending on the choice of @xmath13 .",
    "after some markov steps , the worm head bites its tail and the discontinuities are removed .",
    "only configurations with continuous world - lines can contribute to the statistics according to tr@xmath9 .",
    "in contrast to these algorithms , we will work with a worm which is local in imaginary time .",
    "the evolution operator extended by such a local worm ( an imaginary time - independent operator @xmath14 to be defined below ) reads @xmath15 where @xmath11 can be regarded as the imaginary time at which the worm operator is inserted .",
    "we will show that by working with a local worm operator one can construct a very efficient sampling method , provided that the worm operator commutes with the residual interaction ( @xmath16 ) .",
    "if @xmath14 furthermore commutes with the generators of a symmetry of @xmath1 and @xmath2 , one can restrict the sampling to configurations with those specific symmetries , leading to symmetry - projected results .",
    "in particular one can sample the canonical ensemble with a worm operator that conserves particle number .",
    "we would like to emphasize at this point that the algorithm stated below does not depend on the specific structure of @xmath14 .",
    "the operator @xmath14 has to be chosen in such a way that an ergodic markov chain can be constructed , and therefore it will depend on the specific form of the interaction @xmath2 .",
    "if one decomposes the trace ( restricted to the wanted particle number and symmetry ) of @xmath17 using eq .",
    "( [ eq : decompos ] ) and inserts complete sets of eigenstates of @xmath1 at all imaginary times , one obtains a set of integrals which can be evaluated using monte carlo sampling .",
    "the markov process will sample the configurations proportional to the weights @xmath18 each configuration is specified by an order @xmath19 ( the number of interactions ) , a set @xmath20 of eigenstates of @xmath1 ( with @xmath20 a shorthand notation for all the intermediate states @xmath21 ) , interaction times @xmath22 , and the worm insertion time @xmath11 .",
    "we use the notation @xmath23 .",
    "the configuration @xmath24 to the left of the worm is changed by the worm operator into the configuration @xmath25 .",
    "we use the subscript @xmath26 ( @xmath27 ) to indicate the eigenstate @xmath28 ( @xmath29 ) and interaction time @xmath30 ( @xmath31 ) just before ( after ) the worm operator in imaginary time .",
    "we will call the configurations for which @xmath32 diagonal configurations . by choosing the worm operator such that its diagonal elements are constant ( i.e. @xmath33 for all basis states @xmath34 )",
    ", the sum of the weights of all diagonal configurations is proportional to the particle - number projected trace of the evolution operator @xmath35 .",
    "this is nothing else than the canonical partition function tr@xmath36 , with tr@xmath37 the particle - number projected trace .",
    "hence , sampling the configurations proportional to their weights @xmath38 leads to a sampling of the canonical ensemble .",
    "the markov process is set up using the metropolis - hastings algorithm @xcite , hereby sampling in an extended space according to tr@xmath39 $ ] . at each markov step only a few of the factors of eq .",
    "( [ eq : wormdeco ] ) are altered by the worm operator which moves to a new point in imaginary time .",
    "these worm operator moves will be constructed in a such a way that detailed balance is fulfilled locally at each markov step . therefore it is also fulfilled when going from one diagonal configuration to another .",
    "it takes a number of markov steps before diagonal observables ( i.e. observables which commute with @xmath1 ) can be measured again .",
    "while each markov step contains only local changes , the chain of steps between two diagonal configurations corresponds to a global update .",
    "non - diagonal operators can be measured using the fact that one samples in an extended space . by keeping track of the worm moves between two diagonal configurations , statistics for the expectation values of non",
    "- diagonal operators can be collected , similar to the way one evaluates the one - body green s function in the worm algorithm @xcite .",
    "our method however will lead to much better statistics for equal - time non - diagonal operators , because the worm operator is always local in imaginary time .    before shifting the worm operator over some imaginary time interval @xmath40 , a direction @xmath41 has to be chosen .",
    "one can choose between the directions @xmath42 ( higher values of @xmath11 ) and @xmath43 ( lower values of @xmath11 ) with some probability @xmath44 , to be specified later .",
    "the presence of the exponentials in eq .",
    "( [ eq : wormdeco ] ) inspires us to choose the time shift @xmath45 proportional to an exponential distribution , @xmath46 with @xmath47 an optimization parameter . in shifting the worm operator from @xmath11 to a new imaginary time @xmath48 , the worm operator can encounter an interaction operator @xmath2 at some time in between . assume the direction @xmath49 is chosen and the worm operator meets an interaction at time @xmath31 .",
    "let us first consider the situation where the worm operator moves through this interaction , without annihilating it , @xmath50 when passing the interaction , the intermediate state can change .",
    "a convenient way to pick one of these possible changes is to choose the new configuration proportional to its weight @xmath51 part ( a ) of figure [ fig : diagram ] shows a diagrammatic representation of the different ways in which a general one - body worm operator @xmath52 ( for some constants @xmath53 ) can pass a similar interaction @xmath2 .",
    "the worm operator is represented by a curly line and the interaction by a vertical straight line . for this type of worm and interaction operator",
    "there are always at most four ways in which the intermediate state can change . it should be noted that our choice eq .",
    "( [ eq : transv ] ) is not unique and possibly more optimal choices can be found @xcite . because of this choice however , there appears a factor @xmath54 in the acceptance factor of the metropolis - hastings algorithm .",
    "every time the worm operator passes an interaction an analogous factor appears , depending on the direction @xmath41 of propagation .",
    "therefore it s advantageous to impose on @xmath14 the condition , @xmath55 because then @xmath56 in all cases , and we do not have to worry about this normalization factor anymore .",
    "furthermore , eq . ( [ eq : commutator ] ) ensures that the worm operator can always pass the interaction it encounters .",
    "if one would choose a worm operator @xmath14 that does not satisfy this condition , as in grand - canonical algorithms , it is possible the worm operator can not pass the interaction and the direction of propagation has to change , in that way undoing changes previously made .",
    "it is intuitively clear that these bounces give rise to a slow decorrelation and should be avoided @xcite . in the directed loop algorithm one increases the efficiency of the loop update by minimizing the appearance of bounces , but they can not be eliminated completely because of the reversibility condition . in what follows",
    "we will assume the condition eq .",
    "( [ eq : commutator ] ) is fulfilled , making the algorithm bounce - free .",
    "we will drop the factors @xmath57 to ease the equations . after passing through the interaction at time @xmath58 ,",
    "one has to choose a new imaginary - time shift @xmath40 .",
    "however , one can avoid generating a new random number by taking the new shift as follows : @xmath59 where the parameter @xmath47 has been updated after passing the interaction .    the choice of the parameters @xmath47 follows from detailed balance .",
    "because the time shifts @xmath45 of the worm operator are chosen by eqs .",
    "( [ eq : poisson ] ) and ( [ eq : deltatau2 ] ) , adding the constraint @xmath60 ensures that all the exponentials which appear in the acceptance factor of the metropolis - hastings algorithm cancel , leading to an efficient sampling method .",
    "so in practice one can choose any positive value for @xmath61 and @xmath62 , as long as eq .",
    "( [ eq : condeps ] ) is fulfilled at each step of the worm movement . to conclude",
    ", we write down the acceptance factor for the above procedure when the worm operator does not change the number of interactions , @xmath63 where @xmath64 ( @xmath65 ) is the value of @xmath47 ( @xmath66 ) at the end ( beginning ) of the worm operator move into direction @xmath41 , and @xmath67 denotes the opposite direction of @xmath41 .",
    "the actual acceptance probability is given by @xmath68 , according to the metropolis - hastings algorithm .",
    "let us now introduce a number of steps , which allow to change the number of interactions in a reversible way .",
    "we want the acceptance factor of such updates to be local , i.e. the probability to pass , create or annihilate an interaction should only depend on the properties of the state at that point in imaginary space - time .",
    "we consider three extensions of the procedure outlined above where no interactions are created or deleted :    * at the beginning of the markov step , we introduce the possibility that the worm operator creates a new interaction with probability @xmath69 , which depends on the direction @xmath41 of propagation .",
    "this creation will also change the intermediate state : @xmath70 assuming again the worm operator is moving in the @xmath42 direction . the new intermediate state @xmath71 will be chosen with probabilities @xmath72 for a worm operator move in the @xmath43 direction , probabilities @xmath73 can be defined in an analogous way .",
    "figure [ fig : diagram ] ( parts ( b ) and ( c ) ) shows a diagrammatic representation of the insertion of a one - body interaction at the beginning of the worm move . for",
    "a diagonal configuration only the diagonal part of @xmath14 contributes to the matrix element @xmath74 . in this situation",
    "the worm operator is represented by little circles and all world - lines are continuous",
    ". we will call this the diagonal worm. * when the worm operator arrives at an interaction , one also has to consider the possibility of annihilating that interaction .",
    "suppose the interaction can be deleted .",
    "let @xmath75 be the probability to annihilate the interaction while continuing the worm update , and @xmath76 the probability to annihilate the interaction and stop the worm update .",
    "then @xmath77 is the probability to pass through that interaction and continue the worm operator . * to maintain reversibility",
    ", one also has to include the possibility that the construction of the markov step does not halt at the moment the worm operator has finished a shift @xmath45 without encountering an interaction . at that point",
    "one has to choose between stopping the worm operator , or to continue , with the possibility of inserting a new interaction at that point .",
    "let @xmath78 be the probability to continue the worm operator without inserting an interaction , @xmath79 the probability to insert an interaction and to continue the worm operator , then @xmath80 will be the probability to stop the worm operator , without inserting an interaction .    after creating , annihilating or passing an interaction , a new time shift @xmath40",
    "should again be chosen according to eqs .",
    "( [ eq : poisson ] ) or ( [ eq : deltatau2 ] ) .",
    "note that the parameter @xmath81 is redundant : jumping with a parameter @xmath47 and continuing the worm operator unaltered with probability @xmath81 is statistically equivalent to making a jump with parameter @xmath82 , and then choosing between either stopping the worm operator or inserting an interaction and move on .",
    "therefore , one can set @xmath83 without loss of generality .",
    "we now determine how the other parameters should be chosen in order to satisfy detailed balance .",
    "assume a direction @xmath41 is chosen .",
    "when no interaction is inserted at the beginning of the worm move , a factor @xmath84 appears in the acceptance factor .",
    "if on the other hand an interaction is created at the initial time @xmath11 of the worm operator , this will lead to a factor @xmath85 with @xmath86 a new intermediate state is chosen with probabilities eq .",
    "( [ eq : insertprob ] ) . at the end of the markov step",
    ", the worm operator will annihilate an interaction or not , leading to extra factors in the global acceptance factor which have the inverse form of eqs .",
    "( [ eq : q^c ] ) and ( [ eq : q^0 ] ) , because of the inverse symmetry between beginning and end of the move . at intermediate points",
    ", we can encounter the following situations .",
    "the worm operator can stop after a shift @xmath45 between two interactions , insert an interaction and move on .",
    "the inverse situation of this can also occur , when an interaction is annihilated and the worm operator moves on . or",
    "the worm operator can simply pass an interaction without annihilating it . in order to have a good total acceptance factor",
    ", we will require that these intermediate steps do not contribute to the acceptance factor .",
    "this condition leads to the constraints @xmath87 apart from that , we want the sampling to be as uniform as possible , which suggests the condition @xmath88 . putting all this together ,",
    "the total acceptance factor is given by @xmath89 where @xmath90 the factor @xmath91 has to be evaluated at the beginning and the end of the markov step in direction @xmath41 ( with @xmath67 the opposite of @xmath41 ) .",
    "the creation probability is given by eq .",
    "( [ eq : q^c ] ) , @xmath92 we still have to determine how to choose the direction @xmath41 .",
    "the acceptance ratio of eq .",
    "( [ eq : totalaccep ] ) inspires us to choose the direction of the move with probabilities @xmath93 with @xmath94 . by accepting all worm operator",
    "moves a distribution given by @xmath95 will be sampled , instead of the distribution @xmath38 .",
    "because the factors @xmath96 fluctuate only mildly in practice , accepting all moves still leads to a a very useful sampling method .",
    "it speeds up the algorithm and reduces the complexity of the code .",
    "finite temperature observables can still be evaluated by taking the extra weighting factor into account : @xmath97}{tr[e^{-\\beta(h_0-v ) } ] } \\nonumber \\\\ & = & \\frac{\\sum_{s \\in \\mathcal{s } } ( q_s/(r_{lr})_s)}{\\sum_{s \\in \\mathcal{s } } ( 1/(r_{lr})_s)}.\\end{aligned}\\ ] ]     by a solid vertical line .",
    "we distinguish between the following updates .",
    "( a ) when the worm operator moves in the @xmath42 direction , it can encounter some interaction .",
    "the worm operator can pass the interaction , in that way changing the intermediate state .",
    "for general one - body worm and interaction operators , there are at most four possible ways in doing this .",
    "( b)-(c ) at the beginning of the worm move , we introduce the possibility of inserting an interaction .",
    "when the initial worm is diagonal ( represented by circles ) , a number of interaction insertions of the type shown in ( b ) are possible . in part ( c )",
    "the initial worm operator is not diagonal , and an interaction insertion can make the worm diagonal or not .",
    "[ fig : diagram],width=283 ]    each time the worm operator creates , annihilates or passes an interaction , the parameters @xmath47 , @xmath69 , @xmath75 , @xmath76 , @xmath79 are determined by eqs .",
    "( [ eq : condeps ] ) , ( [ eq : as ] ) , ( [ eq : q_d ] ) and ( [ eq : c_d ] ) .",
    "this still leaves a lot of freedom .",
    "we will focus here on two limiting cases .",
    "first we will consider the case where one of the two parameters @xmath62 and @xmath61 is always zero . in that way",
    "it can occur the time shift @xmath40 becomes infinite .",
    "this amounts to the worm operator directly jumping to the next interaction , which speeds up decorrelation in imaginary time direction . in order to obtain a worm move that changes the configurations as much as possible ,",
    "the parameters @xmath98 , @xmath99 , @xmath100 and @xmath101 are maximized .",
    "the set of parameters obtained in this way is shown in table [ table : sola ] for the case @xmath102 .",
    "we will call this solution a. the solution for the case @xmath103 can be found by interchanging the subscripts @xmath26 and @xmath49 . note that in this solution the worm operator always starts to move into the direction of the highest diagonal energy .",
    "it is clear that whenever the worm operator is moving in the direction of the highest diagonal energy or whenever @xmath104 , the time shift @xmath45 becomes infinite .",
    "there are a number of extra conditions one should keep in mind . assume the worm operator starts to move in the direction @xmath42 ( because @xmath105 ) .",
    "when the worm operator arrives at an interaction that can be annihilated , one has to determine @xmath106 , @xmath107 and @xmath108 after the annihilation",
    ". if @xmath105 is still satisfied then , @xmath109 and @xmath101 from table [ table : sola ] are the correct probabilities to stop or continue the worm operator .",
    "if now @xmath103 on the other hand , one has to use the solution @xmath110 and @xmath111 , but the worm operator keeps moving in the same direction .",
    "the time shift of the worm operator is only finite when it moves in the direction @xmath41 and @xmath112 .",
    "note also that only @xmath98 is mentioned in table [ table : sola ] , because the parameter @xmath79 has only meaning when the time shift is finite . in the present solution however , a problem arises whenever @xmath113 . in this case @xmath114 and the time shift @xmath40 is always infinite . because @xmath115 in addition , the worm operator never halts . as a consequence configurations with a diagonal worm",
    "will never be sampled .",
    "this can be solved by proposing a small but finite stopping probability .",
    "this alternative solution for the case @xmath116 is also given in table [ table : sola ] .",
    "the global parameter @xmath117 should be taken small ( such that @xmath118 for all diagonal configurations ) but not zero , and can be chosen in order to optimize the decorrelation between successive evaluations of observables .",
    "note @xmath96 of eq .",
    "( [ eq : qw ] ) takes the constant value @xmath119 .",
    ".[table : sola ] a set of algorithm parameters satisfying eqs .",
    "( [ eq : condeps ] ) , ( [ eq : as ] ) , ( [ eq : q_d ] ) and ( [ eq : c_d ] ) for the cases @xmath113 and @xmath120 ( otherwise interchange the subscripts @xmath26 and @xmath49 ) .",
    "we call this solution a , for which one of the parameters @xmath121 is always zero .",
    "[ cols=\"^,^,^ \" , ]     in short , the algorithm is based on a time - dependent perturbation in the interaction @xmath2 ( see eq .",
    "( [ eq : decompos ] ) ) , so there is no systematic error arising from time discretization . because we choose time shifts of a worm operator according to eq .",
    "( [ eq : poisson ] ) the diagonal part of the hamiltonian is handled exactly .",
    "there are a number of algorithm parameters , which have to satisfy eqs .",
    "( [ eq : condeps ] ) , ( [ eq : as ] ) , ( [ eq : q_d ] ) and ( [ eq : c_d ] ) .",
    "we have derived two sets of algorithm parameters , satisfying these equations . in the first set ( solution a ) one of the parameters @xmath47 is always zero and in the second ( solution b ) it is equal to @xmath108 . therefore the main difference between these two solutions",
    "will be the size of the imaginary time shift @xmath40 .",
    "other algorithms where @xmath62 or @xmath61 take values between @xmath122 and @xmath108 can be constructed in a similar way , taking for now only these limiting cases . in the next section",
    "our qmc algorithm will be applied to the bose - hubbard model .",
    "the efficiency of the two different solutions leading to different algorithms will be compared in this context .",
    "ultracold bosonic atoms in an optical lattice are described by the bose - hubbard model @xcite , @xmath123 with @xmath124 ( @xmath125 ) the boson creation ( annihilation ) operator on site @xmath20 , @xmath126 the number operator on site @xmath20 and @xmath127 denoting nearest neighbors .",
    "the lattice has @xmath128 sites , occupied by @xmath129 bosons .",
    "the parameter @xmath130 is the tunneling amplitude and @xmath131 is the on - site repulsion strength .",
    "we will restrict the discussion here to the one - dimensional homogeneous case without trap . at low values of @xmath132",
    "the system forms a compressible superfluid .",
    "this phase is characterized by a gapless excitation spectrum and long - range phase coherence . by increasing @xmath132 , a quantum phase transition from a superfluid state to a mott insulating state",
    "is achieved at integer densities . in the pure mott phase",
    "the bosons are localized at individual lattice sites and all phase coherence is lost due to quantum fluctuations . in addition ,",
    "density fluctuations disappear when entering the mott phase and a gap appears in the excitation spectrum .",
    "this phase driven transition belongs to the berezinskii - kosterlitz - thouless ( bkt )  @xcite universality class in one dimension .",
    "the bose - hubbard hamiltonian can be rewritten in the form eq .",
    "( [ eq : hamiltonian ] ) , @xmath133 as argued above , it is advantageous to take the worm operator @xmath14 such that it commutes with @xmath2 .",
    "an operator that satisfies this condition is given by @xmath134 with @xmath135 a c - number to be optimized . in our calculations",
    "this parameter is always set equal to the total number of particles .",
    "we have checked our code by comparing with exact diagonalization results for small lattices .",
    "ergodicity was tested numerically .",
    "power law behavior of correlation functions coincides with predictions from bosonization theory for large lattices .",
    "the one - body green s function @xmath136 is calculated by updating the entry @xmath137 in a histogram for @xmath138 at every markov step .",
    "the function @xmath138 can be normalized directly from the diagonal / non - diagonal worm fraction .",
    "the non - diagonal worm components @xmath139 of eq .",
    "( [ eq : bhworm ] ) can be given a different weight , leading to a worm matrix representation of the symmetric toeplitz type ( i.e. a symmetric matrix with constant values along negative - sloping diagonals ) .",
    "such a worm operator still commutes with the interaction part @xmath2 of the hamiltonian . by giving some worm components a bigger weight ,",
    "the corresponding components @xmath138 will be updated more often , leading to a higher accuracy and mimicking flat histograms @xcite .",
    "the condensed fraction @xmath140 can be determined via @xmath141 the superfluid fraction can be determined using the winding number @xcite , @xmath142 where @xmath143 is the mean square of the winding number operator in one dimension .",
    "figure [ fig : rho ] shows the condensed and superfluid fraction for a uniform one - dimensional system of 128 sites at a density of exactly one particle per site .",
    "calculations were performed at an inverse temperature @xmath144 , using the algorithm based on solution a. we have used the algorithm to study the quantum critical behavior of the one - dimensional bose - hubbard model with constant filling , using renormalization group flow equations .",
    "studying the bkt transition is notoriously difficult because of the logarithmic finite - size corrections .",
    "the present algorithm has the big advantage of keeping the density constant , in contrast to the grand - canonical approaches .",
    "the results of this study will be presented elsewhere @xcite .    ) and condensed fraction ( @xmath140 ) for the one - dimensional homogeneous bose - hubbard model as a function of @xmath132 .",
    "the fractions have been calculated for a uniform lattice with @xmath145 at an inverse temperature @xmath146 , using eqs .",
    "( [ eq : cf ] ) and ( [ eq : sf ] ) .",
    "the condensed fraction was calculated from the correlation function @xmath147 , for which we have high statistics .",
    "[ fig : rho],width=321 ]    we compare the efficiencies of solutions a and b. to this purpose , we simulate a one - dimensional lattice with @xmath148 sites at an inverse temperature @xmath149 and a filling factor of one boson per site .",
    "the simulations consisted of @xmath150 markov chains that each ran @xmath151 seconds after thermalization on a pentium iii processor .",
    "the same code was used , with only minor changes to go from algorithm a to b. we discuss the efficiency by looking at the standard deviations on the expectation value of @xmath2 of eq .",
    "( [ eq : bhham ] ) and on the average squared density .",
    "we calculated the squared density @xmath152 by averaging over all sites , @xmath153 the expectation value of the interaction term @xmath2 was not calculated via the correlation function @xmath154 , but by counting the number of interaction vertices in the configuration whenever the worm operator was diagonal @xcite .",
    "when looking at the standard deviation on the squared density ( figure [ fig : errornn2 ] ) , one can conclude solution a is the most efficient one .",
    "we found a similar picture when looking at the standard deviations on the expectation value of @xmath1 of eq .",
    "( [ eq : bhham ] ) .",
    "the errors on the standard deviations lie within ten percent . from the standard deviation on the expectation value of the interaction term @xmath2 ( figure [ fig : errorsen2 ] ) , it follows that solution b is better in the superfluid phase .",
    "the same conclusion follows from the total energy . for the condensed fraction",
    "the deviations are smallest for solution a for all values of @xmath132 .",
    "those on the superfluid fraction lie very close for solution a and b ( see figure [ fig : errorsf ] ) . we found that varying the parameter @xmath117 of tables [ table : sola ] and [ table : solb ] does not change the efficiency in a significant way , as long as @xmath117 is not too small . for further simulations we will always choose the parameter @xmath117 as big as possible , under the constraint @xmath155 .",
    "figures [ fig : errornn2 ] , [ fig : errorsen2 ] and [ fig : errorsf ] show also standard deviations resulting from the directed loop sse algorithm @xcite .",
    "one has to be very careful when comparing efficiencies of different algorithms .",
    "first , the sse code works in the grand - canonical ensemble . in the sse simulations ,",
    "the chemical potential was changed in such a way that @xmath129 remained constant .",
    "second , the efficiency does not only depend on the algorithm , but also on the used data structures . in a sse approach",
    ", the decomposition of the evolution operator corresponds to a perturbation expansion in all terms of the hamiltonian , while the decomposition eq .",
    "( [ eq : decompos ] ) perturbs only in the off - diagonal terms @xmath2 . for the bose - hubbard model , where the contribution of the diagonal terms is large , the last approach is preferable . for all",
    "calculated observables the standard deviations resulting from the sse code were the largest .",
    "figures [ fig : errornn2 ] and [ fig : errorsen2 ] show the sse deviations increase rather rapidly with increasing @xmath132 , whereas the deviations resulting from our method remain of the same order .",
    "we also calculated autocorrelation times for different observables . here",
    "each bin ended after a constant number of measurements .",
    "we noticed that for solution b the autocorrelation times became very big for high values of @xmath132 . for small @xmath132 , the autocorrelation time for solution a is of the order of the number of markov steps needed for @xmath156 diagonal updates , and increases only slowly with increasing @xmath132 .",
    "of course it should be noted the algorithm based on solution a had to run much longer in order to get the same number of diagonal measurements .",
    "for all measured observables we found similar autocorrelation times .",
    "we conclude that solution a , derived in the previous section , is more efficient than solution b , except in the superfluid phase when looking at the interaction energy @xmath2 .",
    "this can be understood by remarking that the time shifts of the worm operator are much larger for solution a. in the algorithm based on solution b , the time shifts are of the order of the mean imaginary time between two interaction vertices in the configurations .",
    "this explains why the standard deviations on the interaction energy are smallest for this solution in the superfluid phase .",
    "we also conclude that our algorithm is more efficient than the directed loop sse algorithm when simulating the one - dimensional bose - hubbard model . in the next section",
    ", we will apply the algorithm to a pairing model . in",
    "what follows , all calculations are performed using the algorithm based on solution b.    ) ) resulting from the directed loop sse algorithm and the algorithms based on solutions a and b. the homogeneous bose - hubbard model is simulated for a lattice with @xmath148 sites and @xmath148 bosons at an inverse temperature @xmath149 .",
    "the deviations resulted after a qmc calculation with @xmath150 independent markov chains that each ran @xmath151 seconds on a pentium iii processor .",
    "[ fig : errornn2],width=321 ]     ( see eq .",
    "[ eq : bhham ] ) for the homogeneous bose - hubbard model as a function of @xmath132 .",
    "here solution a is the most efficient one in the mott phase . in the superfluid phase , solution b becomes more efficient .",
    "[ fig : errorsen2],width=321 ]    .",
    "the deviations result from solutions a and b , and the directed loop sse method .",
    "each simulation consisted of @xmath150 independent markov chains that each ran @xmath151 seconds .",
    "[ fig : errorsf],width=321 ]",
    "in the nuclear shell model , quantum monte carlo methods are valuable because they offer the possibility of doing calculations in much larger model spaces than conventional diagonalization techniques .",
    "finite temperature shell model studies have been done with the aid of auxiliary - field qmc methods @xcite , and ground - state properties of light nuclei have been calculated using variational and diffusion qmc techniques @xcite .",
    "furthermore , being able to calculate thermal properties of nuclei makes it in principle possible to calculate nuclear level densities @xcite .",
    "these densities are extremely important for making good theoretical estimates of nuclear reaction rates .",
    "the basic assumption in the shell model is the presence of a mean field in which the nucleons move . to improve on this",
    ", a residual interaction between the nucleons is introduced .",
    "pairing between nucleons is the main short - range correlation induced by the residual interaction . adding",
    "a simple pairing hamiltonian to the mean - field hamiltonian @xmath157 can account for this @xcite .",
    "the operators @xmath158 create a particle in the single - particle eigenstate @xmath159 of the mean - field hamiltonian in the valence shell .",
    "the index @xmath130 indicates proton or neutron states and @xmath160 denotes the time - reversed state of @xmath159 .",
    "the operator @xmath161 is the corresponding number - operator and @xmath162 the single particle energy - eigenvalue .",
    "@xmath163 is the pairing strength for protons or neutrons .",
    "proton - neutron pairing is not included , but this coupling contributes only in an important way for @xmath164 nuclei @xcite . as a consequence ,",
    "the problem decouples for protons and neutrons . in the sequel",
    "only the neutron part of the model is considered , and the isospin index @xmath130 is dropped to ease the notations .    based on algebraic techniques developed by richardson @xcite , the pairing model can be solved exactly for an arbitrary set of single particle levels at zero temperature @xcite . in practice",
    "it remains difficult to use these exact results to study the thermodynamics of the model , because the number of states needed in the ensemble increases very rapidly with increasing temperature .",
    "thermodynamical properties have been studied using auxiliary - field qmc , which is free of sign problems for the pairing hamiltonian of eq .",
    "( [ eq : pairingham ] ) when dealing with an even number of particles @xcite .",
    "however , the present algorithm can consider nuclei with even and odd nucleon numbers .",
    "note the auxiliary - field method scales as o@xmath165 with @xmath128 the number considered single particle states , while a world - line algorithm scales linear with @xmath128 .",
    "when a nucleon occupies a single particle state @xmath159 and its time - reversed state @xmath160 is unoccupied , the nucleon is said to be unaccompanied. these states do not participate in the pair scattering by @xmath166 .",
    "the mean - field plus pairing hamiltonian can be rewritten as eq .",
    "( [ eq : hamiltonian ] ) , @xmath167 the operators @xmath168 create a pair of nucleons in two time - reversed states and satisfy hard - core boson commutation relations .",
    "in order to get the correct finite temperature properties , the possibility of changing the number of unaccompanied nucleons during the simulation should be incorporated .",
    "a path integral monte carlo method for the pairing hamiltonian has been developed by cerf and martin @xcite , but there the number of pairs remained fixed @xcite .",
    "this problem can now be overcome elegantly by adding an extra pair breaking term @xmath169 to the interaction part @xmath2 of eq .",
    "( [ eq : vpairing ] ) .",
    "we define the worm operator as @xmath170 with two extra parameters @xmath135 and @xmath171 to be optimized . a term proportional to @xmath172 is included in the worm operator , in order to satisfy condition eq .",
    "( [ eq : commutator ] ) .",
    "this term will generate configurations with pair breaking interactions .",
    "however , it can occur that too many of these interactions are generated , though we are only interested in generating configurations with a different number of unaccompanied particles , but without interactions of the type eq .",
    "( [ eq : vpert ] ) . this can be prevented by imposing the constraint that a configuration can contain at most two pair breaking interactions of this type .",
    "observables are only updated if there are no pair - breaking interactions in the configuration .",
    "this means that a number of markov steps are needed in order to reach a new allowed configuration with a different number of unaccompanied particles . when @xmath171 of eq .",
    "( [ eq : wormbcs ] ) is put equal to one , the percentage of diagonal configurations which contain no @xmath172 interactions ( see eq . ( [ eq : vpert ] ) ) is about @xmath173 .",
    "this is still efficient enough to sample the pairing hamiltonian .",
    "there are a number of ways to increase the efficiency .",
    "first of all one can change the parameter @xmath171 , hereby influencing the appearance of pair breaking interactions .",
    "one can also restrict the number of times the worm tries to insert a @xmath172 interaction by allowing this only after a certain markov time in which good ( i.e. without pair breaking interactions ) configurations are sampled .",
    "one should also keep in mind that while a configuration contains pair breaking interactions , the worm itself is not necessarily of the pair breaking type .",
    "so a lot of markov time is spend to change the configuration in a global way without removing the pair breaking interactions , leading to strong decorrelation .",
    "the main physical properties of nuclei in the iron region are modeled by a schematic mean - field plus pairing hamiltonian .",
    "for the mean - field potential , we use a woods - saxon potential .",
    "single particle energies are taken from ref .",
    "@xcite . a full @xmath174 valence space is chosen .",
    "these single - particle states and energies are shown in table [ table : spe ] .",
    "a pairing strength @xmath175 mev is used . due to the size of the model space a strength smaller than the suggested value of @xmath176 mev per nucleon",
    "is used @xcite .",
    "we have tested our code by comparing finite temperature results in a @xmath177 valence space with the ones obtained via an exact diagonalization technique @xcite .",
    "we show results of calculations with the valence shell given in table [ table : spe ] occupied by @xmath156 and @xmath178 valence neutrons .",
    "figure [ fig : pairingn ] shows the expectation value of the neutron pairing - interaction operator @xmath179 as a function of temperature . at low temperature ,",
    "the pairing energies are much lower for the even number of neutrons .",
    "this can be understood by remarking that for an odd number of neutrons there is always at least one unpaired nucleon . at temperatures higher than @xmath180 mev ,",
    "the pairing energies differ only slightly , because there is an increasing number of unpaired nucleons due to thermal excitation .",
    "this is also reflected in the specific heat ( see figure [ fig : shn ] ) .",
    "a peak appears around @xmath181 mev due to the development of pair correlations .",
    "0.4@ |r|r|r| + orbital & protons & neutrons + @xmath182 & -4.1205 & -10.4576 + @xmath183 & -2.0360 & -8.4804 + @xmath184 & -1.2334 & -7.6512 + @xmath185 & -1.2159 & -7.7025 + @xmath186 & 4.7316 & -0.3861 + @xmath187 & 5.6562 & 0.2225 + @xmath188 & 6.1324 & 0.9907 + @xmath189 & 6.6572 &",
    "0.5631 +     is equal to @xmath190 mev .",
    "we consider @xmath156 and @xmath178 neutrons in the @xmath174 valence space ( see tabel [ table : spe ] ) . at temperatures below @xmath191 mev",
    "the pairing energy is much lower for the even neutron number .",
    "[ fig : pairingn],width=321 ]     as a function of temperature for @xmath156 and @xmath178 neutrons in the full @xmath192 valence space ( see table [ table : spe ] ) .",
    "calculations were performed at a constant neutron pairing strength @xmath193 mev .",
    "[ fig : shn],width=321 ]    because the worm operator conserves angular momentum , one can restrict the intermediate states to a specific value of the quantum numbers @xmath194 and @xmath195 .",
    "this is not possible with the auxiliary - field qmc method . in our current implementation of the algorithm",
    "however , the occupation of each couple of time - reversed single - particle states @xmath196 is exactly known at all times .",
    "because the unaccompanied particle number operator @xmath197 commutes with the angular momentum projection operator @xmath195 ( but not with @xmath198 ) , our current code allows restricting the simulation to configurations with a fixed @xmath195 .",
    "work on extending this technique to full j - projection is in progress .",
    "when the projection on @xmath195 was turned on , we included an extra global step in order to get a good convergence at the lowest temperatures .",
    "this extra global change allows for one or two unaccompanied nucleons ( which block the state they occupy ) to move to other states , and can occur whenever the worm is diagonal .",
    "first an unaccompanied nucleon at a blocked state @xmath199 is chosen at random .",
    "a non - blocked pair of states @xmath200 is then chosen with probability @xmath201 with @xmath202 the occupation number of state @xmath159 at imaginary time @xmath130 , and @xmath203 a normalization factor .",
    "the subscript @xmath199 indicates that the norm is determined for a configuration containing a blocked state @xmath199 . the idea behind eq .",
    "( [ eq : probunac ] ) is to get a probability distribution @xmath204 which is peaked around the fermi level , but other distributions can be chosen as well . the interchange of the occupations of the blocked pair of states @xmath205 and the non - blocked pair @xmath200 over the whole imaginary time interval @xmath8 , is accepted with probability @xmath206 the acceptance factor for the case when the occupations of two pairs of non - blocked and blocked states are interchanged , can be constructed in a similar way . the extra step has a high acceptance rate , but is only necessary to enhance decorrelation at very low temperature when a @xmath195-projection is included . at higher temperatures the unaccompanied nucleons move efficiently from state to state via the last worm piece in eq .",
    "( [ eq : wormbcs ] ) .",
    "figure [ fig : jzproj ] shows total energies after @xmath195-projection at low temperature .",
    "calculations were performed for ten neutrons moving in the model space listed in table [ table : spe ] .",
    "the neutron pairing strength is again @xmath193 mev .",
    "the figure also shows exact energy eigenvalues for @xmath207 to @xmath208 .",
    "these were calculated via a technique explained in ref .",
    "the lowest @xmath209 and the lowest @xmath210 states are degenerate . for low enough values of @xmath211",
    "the finite temperature results clearly converge to the ground states within the considered ensembles .",
    "projected internal energies as a function of temperature .",
    "the values of @xmath195 from @xmath122 to @xmath212 are indicated on the left .",
    "a clear convergence to exact zero temperature results calculated via techniques explained in ref .",
    "@xcite can be seen .",
    "[ fig : jzproj],width=321 ]    note that we can compare with exact solutions because the pairing strength was taken constant for all levels .",
    "our qmc method allows to solve pairing models with a single particle state dependent pairing strength @xmath213 , for which no algebraic solutions are available . taking in mind the method",
    "is applicable for even and odd nucleon systems and allows angular momentum symmetry projections , this could greatly extend the applicability of the pairing model .",
    "we have set up a quantum monte carlo method with a non - local loop updating scheme starting from a local worm operator in the path integral approach .",
    "this method allows to sample configurations with specific symmetries and , in particular , to sample the canonical ensemble .",
    "it leads to a very efficient sampling scheme with all moves accepted and without bounces or critical slowing down near second order phase transitions .",
    "we have proven detailed balance and tested ergodicity .",
    "our method opens new perspectives for the study of quantum many - body systems where particle number and other symmetries play an important role .",
    "it can be applied to bosons , to fermions in absence of a sign problem and to non - frustrated spin systems at fixed magnetization .",
    "we have demonstrated this by simulating the bose - hubbard model and a nuclear pairing model .",
    "the equal - time one - body green s function can be evaluated with high efficiency .",
    "when non - equal time observables are required , the current method can in principle still be combined with conventional non - local worm steps .",
    "there is still a lot of freedom in choosing the algorithm parameters , which can be used to optimize the algorithm . for the bose - hubbard model",
    "we compared the efficiency of our algorithm ( with different parameter sets ) with a directed loop sse code .",
    "though one should always be careful when comparing different algorithms , we have strong indications that our method is very efficient .",
    "we have simulated a pairing model for even and odd particle numbers .",
    "our finite temperature results clearly supplement algebraic methods and other qmc methods .",
    "furthermore , a projection on angular momentum symmetries can be included .",
    "we have demonstrated this by showing @xmath195-projected results . a work on full @xmath194-projection is in progress .",
    "the authors wish to thank k.heyde , j. dukelsky , s. wessel , m. troyer and s. trebst for interesting discussions and the fund for scientific research - flanders ( belgium ) , the research board of the university of ghent and n.a.t.o . for financial support .",
    "99 n. metropolis , a.r .",
    "rosenbluth , m.n .",
    "rosenbluth , a.h .",
    "teller and e. teller , j. of chem .",
    "* 21 * , 1087 ( 1953 ) . w. von der linden ,",
    "phys . rep . *",
    "220 * , 53 ( 1992 ) .",
    "u. wolff , phys .",
    "lett . * 62 * , 361 ( 1989 ) .",
    "swendsen and j .- s .",
    "wang , phys .",
    "lett . * 58 * , 86 ( 1987 ) .",
    "evertz , g. lana and m. marcu , phys .",
    "lett . * 70 * , 875 ( 1993 ) .",
    "evertz , adv . phys .",
    "* 52 * , 1 ( 2003 ) .",
    "n. kawashima and k. harada , j. phys .",
    ". jpn . * 73 * , 1379 ( 2004 ) .",
    "m. suzuki , prog . of theor",
    ". phys . * 56 * , 1454 ( 1976 ) .",
    "trotter , proc .",
    "* 10 * , 545 ( 1959 ) .",
    "beard and u .- j .",
    "wiese , phys .",
    "* 77 * , 5130 ( 1996 ) .",
    "prokofev , b.v .",
    "svistunov and i.s .",
    "tupitsyn , phys .",
    "a , * 238 * , 253 ( 1998);pisma v zh . eks .",
    "fiz . * 64 * , 853 ( 1996 ) .",
    "prokofev , b.v .",
    "svistunov and i.s .",
    "tupitsyn , sov .",
    "- jetp * 87 * , 310 ( 1998 ) .",
    "a.w . sandvik and j. kurkij \" arvi , phys .",
    "b * 43 * , 5950 ( 1991 ) .",
    "sandvik , phys . rev .",
    "b * 59 * , r14157 ( 1999 ) . a. dorneich and m. troyer , phys .",
    "e * 64 * , 066701 ( 2001 ) .",
    "o.f . syljusen and a.w .",
    "sandvik , phys .",
    "e * 66 * , 046701 ( 2002 ) .",
    "syljusen , phys .",
    "e * 67 * , 046701 ( 2003 ) .",
    "l. pollet , s.m.a .",
    "rombouts , k. van houcke and k. heyde , phys .",
    "e * 70 * , 056705 ( 2004 ) .",
    "p. roos and s. miyashita , phys .",
    "rev b * 59 * , 13782 ( 1999 ) .",
    "s. sachdev , _ quantum phase transitions _ , cambridge university press , cambridge ( 2000 ) .",
    "j. dukelsky and g. sierra , phys .",
    "lett . * 83 * , 172 ( 1999 ) .",
    "j. von delft and d.c .",
    "ralph , phys . rep . * 345 * , 61 ( 2001 ) .",
    "koonin , d.j .",
    "dean and k. langanke , phys .",
    "* 278 * , 1 ( 1997 ) .",
    "s. rombouts , k. heyde and n. jachowicz , phys .",
    "c * 58 * , 3295 ( 1998 ) .",
    "s.m.a . rombouts , k. van houcke and l. pollet , _",
    "unpublished_. j.e .",
    "hirsch , d.j .",
    "scalapino , r.l .",
    "sugar and r. blankenbecler , phys .",
    "lett . * 47 * , 1628 ( 1981 ) .",
    "s. rombouts and k. heyde , phys .",
    "b * 237 * , 99 ( 2003 ) .",
    "hastings , biometrika * 57 * , 97 ( 1970 ) .",
    "d. jaksch , c. bruder , j.i .",
    "cirac , c.w .",
    "gardiner , and p. zoller , phys .",
    "lett . * 81 * , 3108 ( 1998 ) .",
    "m. greiner , o. mandel , t. esslinger , t.w .",
    "hnsch and i. bloch , nature * 415 * , 39 ( 2002 ) .",
    "fisher , p.b .",
    "weichman , g. grinstein and d.s .",
    "fisher , phys .",
    "b * 40 * , 546 ( 1989 ) .",
    "berezinskii , sov .",
    "- jetp * 32 * , 493 ( 1970 ) .",
    "kosterlitz and d.j .",
    "thouless , j. phys .",
    "c * 6 * , 1181 ( 1973 ) .",
    "f. wang and d.p .",
    "landau , phys .",
    "lett . * 86 * , 2050 ( 2001 ) ; phys .",
    "e * 64 * , 056101 ( 2001 ) .",
    "pollock and d.m .",
    "ceperley , phys .",
    "b * 36 * , 8343 ( 1987 ) . l. pollet , phd thesis , ghent university , _ unpublished_. a.w .",
    "sandvik , r.r.p . singh and d.k .",
    "campbell , phys .",
    "b * 56 * , 14510 ( 1997 )",
    "pudliner , v.r .",
    "pandharipande , j. carlson and r.b .",
    "wiringa , phys .",
    "lett . * 74 * , 4396 ( 1995 ) .",
    "ormand , phys .",
    "c * 56 * , r1678 ( 1997 ) ; h. nakada and y. alhassid , phys .",
    "lett . * 79 * , 2939 ( 1997 ) . p. ring and p. schuck , _ the nuclear many - body problem _",
    "( springer , new york , 1980 ) , p. 217 . d.j . dean and m. hjorth - jensen , rev .",
    "phys . * 75 * , 607 ( 2003 ) .",
    "k. langanke , d.j .",
    "dean , s.e .",
    "koonin and p.b .",
    "radha , nucl .",
    "a * 613 * , 253 ( 1997 ) .",
    "r. richardson and n. sherman , nucl .",
    "phys . * 52 * , 221 ( 1964 ) ; r.w .",
    "richardson , phys .",
    "141 * , 949 ( 1966 ) .",
    "s. rombouts , d. van neck and j. dukelsky , phys.rev .",
    "c * 69 * , 061303(r ) ( 2004 ) .",
    "n. cerf and o. martin , phys .",
    "c * 47 * , 2610 ( 1993 ) . n.j .",
    "cerf , phys .",
    "lett . * 76 * , 2420 ( 1996 ) .",
    "s. rombouts and k. heyde , phys .",
    "lett . * 80 * , 885 ( 1998 ) .",
    "r. rossignoli , phys .",
    "c * 54 * , 1230 ( 1996 ) ."
  ],
  "abstract_text": [
    "<S> a quantum monte carlo method with a non - local update scheme is presented . </S>",
    "<S> the method is based on a path - integral decomposition and a worm operator which is local in imaginary time . </S>",
    "<S> it generates states with a fixed number of particles and respects other exact symmetries . </S>",
    "<S> observables like the equal - time green s function can be evaluated in an efficient way . to demonstrate the versatility of the method , results for the one - dimensional bose - hubbard model and a nuclear pairing model are presented . within the context of the bose - hubbard model the efficiency of the algorithm </S>",
    "<S> is discussed . </S>"
  ]
}