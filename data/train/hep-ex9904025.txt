{
  "article_text": [
    "searches for rare signals often fail to detect a signal of sufficient statistical significance and thus face the need to set an upper limit on the signal rate .",
    "unfortunately , there is no standard prescription for setting such limits , and a number of techniques have been employed in the past to meet this challenge .",
    "this problem is particularly important for the particle physics community .",
    "upper limits on rare and forbidden decays can provide valuable constraints on physics beyond the standard model of electroweak interactions .",
    "this paper is stimulated by the observation that often authors do not pay enough attention to the choice of a procedure for upper limit estimation .",
    "furthermore , many experimentalists do not provide a sufficient description of the procedure used in their analysis technique , assuming that the reader is smart enough to figure out the details .",
    "an example given in section  [ sec : class ] shows that , in some situations , the choice of a procedure can change the value of an upper limit _ by an order of magnitude _ , which suggests that this problem should not be taken lightly .    in section  [ sec :",
    "survey ] the most popular approaches to upper limit estimation are surveyed and criticism is provided , where applicable . in section  [ sec : ss ] definitions of the statistical significance of a signal are discussed and a new technique , which estimates upper limits using these definitions , is proposed .",
    "unlike commonly used procedures , this approach does not just count the number of events in the signal region , but takes into account statistical fluctuations of the background as well . in section  [ sec : toy_model ] various techniques are compared using a toy model . in section  [ sec : cleo ] an example of a recent search for the lepton number violating decay @xmath0",
    "@xcite , performed by the cleo collaboration , is given .",
    "the emphasis is made on estimation of upper limits , though the discussion can be easily generalized to include construction of confidence intervals whose lower bound is not constrained to zero .",
    "there is no discussion of systematic effects in this paper . throughout the paper",
    "the number of observed events , the expected background rate and , if applicable , the coordinates of observed events are assumed to be measured with perfect accuracy .",
    "in a bayesian approach one has to assume a _ prior _ probability density function ( pdf ) of an unknown parameter and then perform an experiment to update the prior distribution .",
    "a prior pdf reflects knowledge that is available to an experimentalist _ before _ an experiment is performed .",
    "the updated prior is called the _",
    "posterior _ pdf and is used to draw inference on the unknown parameter .",
    "this updating is done with the use of bayes rule . for the moment",
    "let us ignore the issue of background , i.e. , let us assume that the background rate is measured very accurately and thus can be treated as a known constant .",
    "then the only unknown parameter is the signal rate @xmath1 .",
    "bayes rule gives : @xmath2 where @xmath3 represents the number of observed events , @xmath4 is the conditional probability to observe @xmath3 events , given the signal rate @xmath1 , @xmath5 is the prior pdf , and @xmath6 is the conditional posterior pdf . now ,",
    "for any given confidence level , one can compute a bayesian confidence interval for the signal rate @xmath1 . for upper limit estimation",
    "the natural choice of the bayesian confidence interval is of the form @xmath7 .",
    "here , @xmath8 denotes an upper limit and can be found from the equation : @xmath9 the confidence level is denoted by @xmath10 following the conventional statistical notation .",
    "a nice feature of the bayesian approach is that the zero value of an upper limit @xmath8 always corresponds to the zero value for the confidence level @xmath10 . as you will see below ,",
    "this is not necessarily true for the classical approach .",
    "the most important step here is to define a prior distribution of the parameter .",
    "naturally , this is the step which brings most of controversy ( and sometimes confusion ) into bayesian methods .",
    "many statistical textbooks treat a prior pdf as a purely subjective assumption which is based on experimenter s belief . at the same time",
    "there are authors  @xcite who advocate the objectivity of prior assumptions .",
    "in particular , jaynes  @xcite stated the `` basic desideratum '' of the objective approach as follows : _ in two problems where we have the same prior information , we should assign the same prior probabilities_. these authors have offered a number of mathematical procedures that can be used to convert prior knowledge into an exact formula for the prior distribution .",
    "another important question is whether one should assume an _ informative _ prior , i.e. , a prior which incorporates results of previous experiments , or a _ non - informative _ prior , i.e. , a prior which claims total ignorance .",
    "naively , it would seem unnatural to use non - informative priors since the power of the bayesian approach comes from the fact that we update our prior knowledge rather than start every analysis from scratch . in particle physics",
    "the major objection against informative priors is based on the following argument : if we assume a prior which incorporates results of earlier experiments , then our experiment will not be independent of those and thus we will not be able to combine our results with the results of previous experiments just by taking a weighted average .",
    "so far , particle physicists have been largely ignoring informative priors .",
    "thus , the discussion below covers only those bayesian methods that assume a non - informative prior pdf for the positive parameter of a poisson distribution .    in the absence of background",
    "the conditional pdf @xmath4 is given by : @xmath11 bayes and laplace  @xcite , who pioneered statistical research employing bayesian methods , stated that the non - informative prior for any parameter must be flat .",
    "this conclusion was not based on any strict mathematical argument , it was merely a product of their intuition .",
    "modern advocates  @xcite of this approach do not offer any mathematical explanation either , they just consider a flat prior pdf as the most natural choice one can make . as natural as this assumption may seem , there are several objections .",
    "the most obvious argument is that if one can assume a flat distribution of an unknown parameter , then one can also assume a flat distribution for any function of this parameter , and these two assumptions are clearly not identical . if an experiment is measuring the mean of the poisson statistic  ( [ eq : poiss ] ) , then one can argue that the most natural candidate for the unknown parameter is the signal rate @xmath1 , and we have no physical reasons to consider any functions of this parameter except the parameter itself .",
    "in other experiments the situation may be not so simple .",
    "for example , if an experiment is measuring a neutrino mass , then typically the measured quantity is not the neutrino mass itself , but the neutrino mass squared .",
    "in this situation it s not clear whether one should choose mass or mass squared as a candidate for the flat distribution .",
    "jeffreys  @xcite resolved this problem by introducing an _ invariate _",
    "prior pdf @xmath12 which , he stated , was a valid non - informative prior for all problems where the unknown parameter @xmath13 could vary from @xmath14 to @xmath15 .",
    "his choice was mostly motivated by the fact that @xmath16 , i.e. , the pdf of @xmath13 stays invariant under any power transformation .",
    "all non - power functions of @xmath13 were rejected by jeffreys as non - physical under the assumption that the parameter @xmath13 is a dimensional quantity .",
    "this argument was put on a more rigorous mathematical basis by jaynes  @xcite who stipulated that a prior pdf has to stay invariant under any symmetry transformation ) with a non - dimensional mean rate @xmath1 .",
    "originally jaynes non - informative prior was derived for the poisson pdf @xmath17 , where @xmath3 is the number of counts , @xmath18 is the counting time , and @xmath1 is the signal rate per unit time .",
    "however , the requirement of dimensionality seems to be somewhat arbitrary .",
    "for example , in the above formula @xmath18 can be the amount of statistics accumulated in the experiment and @xmath1 can be the signal rate normalized to this amount of statistics .",
    "a prior pdf has to stay invariant under the transformation @xmath19 , @xmath20 , i.e. , jaynes argument is applied .",
    "] that does not change the physics of an experiment .",
    "his conclusion was similar to that of jeffreys , namely that the non - informative prior for a poisson statistic  ( [ eq : poiss ] ) has to be proportional to @xmath21 .",
    "an alternative approach was developed by box and tiao  @xcite who introduced the notion of a _ data - translated _ likelihood . in their approach",
    "a prior pdf is non - informative if the location , but not the shape , of the corresponding posterior likelihood is determined by the unknown parameter .",
    "thus , the location of the posterior likelihood is completely defined by data , while its shape had been determined before the data were seen ( hence the name `` data - translated '' likelihood ) .",
    "it may not be possible to construct a data - translated likelihood for every distribution . in this case one can use taylor expansion to construct an approximate data - translated likelihood .",
    "in particular , a non - informative prior which produces an approximate data - translated likelihood for the poisson statistic  ( [ eq : poiss ] ) is given by @xmath22 .",
    "in the presence of background , the poisson pdf  ( [ eq : poiss ] ) has to be modified to account for the non - zero background rate @xmath23 : @xmath24 if the background rate is accurately measured , it can be treated as a known constant . in this case an argument similar to that of ref .",
    "@xcite gives @xmath25 and an argument similar to that of ref .",
    "@xcite gives @xmath26 for the non - informative prior .",
    "in general , for the prior pdf @xmath27 the posterior distribution is given by @xmath28 where @xmath29 is an incomplete gamma - function . substituting the posterior pdf  ( [ eq : poster_1sm ] ) into eqn .",
    "( [ eq : bayes_cl ] ) , we obtain : @xmath30 a gamma - function is not well - defined if its first argument is equal to zero or a negative integer .",
    "thus , at @xmath31 ( no events observed ) and @xmath32 ( the @xmath25 prior ) eqn .",
    "( [ eq : bayes_ul ] ) fails to find an upper limit . under the flat prior @xmath33 , eqn .",
    "( [ eq : bayes_ul ] ) turns into the formula @xmath34 which was adopted by particle data group  @xcite . here and below , @xmath35 is by definition equal to one .    if the background rate is measured with large uncertainty , then the situation is more complicated .",
    "the usual approach is to modify the poisson statistic  ( [ eq : poiss_b ] ) as : @xmath36 where @xmath37 is the measured or predicted pdf of the background rate @xmath23 .",
    "the argument of the previous paragraph , leading to the @xmath25 and @xmath26 expressions for the non - informative prior , is not necessarily valid in this case .",
    "a more consistent bayesian approach would be to derive a joint non - informative prior @xmath38 , thus treating both the signal and background rates as unknown parameters .",
    "an example of such derivation is given in ref .",
    "a discussion of intricacies , that might arise from inclusion of background uncertainty into the upper limit calculation , is beyond the material covered in this paper .",
    "the classical ( or frequentist ) approach is traditionally interpreted in the following way : if a @xmath10 classical confidence set is constructed for the unknown parameter , then the probability for this confidence set to cover the true value of the parameter equals @xmath10 , that is , if an infinite number of identical independent experiments is performed and for each of these a @xmath10 confidence set is constructed , then @xmath39 of these confidence sets will and @xmath40 of these confidence sets will not contain the true value of the parameter .",
    "rules for construction of classical intervals were outlined in a famous work  @xcite by neyman . here",
    "i treat the terms `` classical '' and `` frequentist '' as equivalent .",
    "the implication is that the classical approach is inevitably connected to the concept of an identical independent experiment .",
    "sometimes this concept is misunderstood , and are curious attempts to treat certain problems in the `` classical '' vein while , in fact , this treatment has nothing to do with the frequentist approach .",
    "an example of such misunderstanding is shown in this section .    a confidence set for the unknown signal rate @xmath1",
    "is typically constructed  @xcite as a confidence interval @xmath41 satisfying : @xmath42 for upper limit estimation it is natural to consider intervals @xmath43 , where @xmath8 is the value of an upper limit .",
    "( [ eq : neyman ] ) is thus reduced to : @xmath44 where @xmath45 was replaced by its definition  ( [ eq : poiss_b ] ) .",
    "( [ eq : class_ul ] ) looks similar to the bayesian formula  ( [ eq : pdg96 ] ) , except that the denominator is now absent .",
    "the denominator in eqn .",
    "( [ eq : pdg96 ] ) represents the probability of observing @xmath3 or less background events in the signal region , and thus , it is always less than 1 except at @xmath46 .",
    "therefore , for the non - zero background rate , i.e. , @xmath47 , the classical approach  ( [ eq : class_ul ] ) always provides a smaller value of an upper limit than the bayesian approach  ( [ eq : pdg96 ] ) with a flat prior .",
    "the difference becomes significant when the denominator in eqn .",
    "( [ eq : pdg96 ] ) is small , i.e. , when the number @xmath3 of events observed in the signal region is small as compared to the expected background rate @xmath23 . for example , for the observed number of events in the signal region @xmath48 and the expected background rate @xmath49 the classical approach  ( [ eq : class_ul ] ) gives an upper limit @xmath50 at 90% confidence level , while the bayesian approach  ( [ eq : pdg96 ] ) with a flat prior gives @xmath51 , i.e. , a difference of more than an order of magnitude .",
    "another feature of eqn .",
    "( [ eq : class_ul ] ) is that now a zero upper limit : @xmath52 , does not give you a zero confidence level .",
    "when the expected background rate @xmath23 is large , one can achieve a situation when @xmath53 , i.e. , formula  ( [ eq : class_ul ] ) gives an unphysical negative value of an upper limit .",
    "advocates of the bayesian method consider this as an undesirable feature of the classical approach .",
    "but the failure to set an upper limit is not necessarily a bad feature .",
    "it just implies that the observed outcome of an experiment is highly improbable , and one should question the experimental technique that was used to measure the signal and the background .",
    "zech  @xcite made an attempt to derive the bayesian formula  ( [ eq : pdg96 ] ) using the classical approach .",
    "to arrive at eqn .",
    "( [ eq : pdg96 ] ) , ref .",
    "@xcite postulates that the number of background events can not exceed the number @xmath3 of observed events and therefore one has to renormalize the probability  ( [ eq : class_ul ] ) according to this constraint .",
    "this approach misunderstands the concept of frequentist coverage .",
    "( [ eq : class_ul ] ) answers the question : what is the probability of observing @xmath3 or more events in an _ identical independent _ experiment ?",
    "this implies that the number @xmath3 of events can not be fixed at any particular value .",
    "if you fix @xmath3 , then you confine yourself to this particular drawing ; the concept of an identical independent experiment is therefore inapplicable . in this case a binomial distribution should be used instead of a poisson pdf .",
    "confidence intervals are not uniquely defined by eqn .",
    "( [ eq : neyman ] ) unless one imposes specific criteria on their construction .",
    "in the situation discussed above , the uniqueness was introduced by requiring that the confidence set must be an interval @xmath7 .",
    "one can choose another requirement and obtain a different confidence set .",
    "in general , if the problem is reduced to one variable and one unknown parameter , then confidence intervals are obtained via construction of confidence belts  @xcite .",
    "the idea behind this technique is the following .",
    "for every assumed value of the signal rate @xmath1 , one finds an acceptance interval @xmath54 which satisfies : @xmath55 due to the discrete nature of the poisson distribution , it is usually impossible to find values of @xmath56 and @xmath57 that satisfy eqn .",
    "( [ eq : c_belt ] ) .",
    "the standard solution is to stay on the conservative side and to search for an acceptance interval that gives at least the required coverage : @xmath58 the obtained functions @xmath59 and @xmath60 define two curves on the @xmath1-vs-@xmath3 plane .",
    "then , for every value of @xmath3 , one obtains an interval @xmath61 which lies between these two curves .",
    "the obtained interval is a @xmath10 confidence interval for the specific value of @xmath3 .",
    "the order in which values of @xmath3 are added to the acceptance region @xmath62 for a specific value of @xmath1 is called an _ ordering principle_. thus , every ordering principle corresponds to a specific set of confidence intervals @xmath63 indexed by the observation variable @xmath3 .",
    "the well - known examples are an old paper  @xcite by crow and gardner and a recent paper  @xcite by feldman and cousins . ref .",
    "@xcite minimizes the length of the acceptance interval @xmath62 defined by eqn .",
    "( [ eq : c_belt_2 ] ) . ref .",
    "@xcite employs an ordering principle based on likelihood ratios .",
    "the latter was adopted by the last release of the particle data group review  @xcite . in both approaches",
    "an experimentalist does not have to decide whether she / he wants to quote an upper limit or a confidence interval : she / he simply applies the chosen procedure to construct a confidence interval @xmath63 .",
    "if the lower bound turns out to be strictly equal to zero : @xmath64 , then an upper limit is quoted , and if the lower bound is positive : @xmath65 , then a confidence interval is quoted .",
    "this versatile procedure , however , has one subtle problem .",
    "the fact that the constructed 90% confidence interval has a non - zero lower bound does not guarantee that a signal of high statistical significance is observed .",
    "there is nothing surprising about that .",
    "a measured signal rate is usually quoted if the statistical significance of the signal exceeds 3 which corresponds to 99.87% of the area under a gaussian peak . at the same time ,",
    "typical confidence levels used to quote upper limits are 90% and 95% . for example , at @xmath66 and @xmath48 the 90% confidence interval obtained by the procedure of ref .",
    "@xcite equals @xmath67 . at the same time , the statistical significance @xmath68 calculated as @xmath69 is only 1.4 .",
    "thus , the non - zero lower bound has no clear interpretation : it is a vague indication that a clear signal might be observed in a future experiment . on the contrary ,",
    "if one chooses to construct a one - sided interval and thus quote an upper limit , this clearly expresses the fact that a signal of sufficient statistical significance was not observed and therefore the signal rate is believed to be consistent with zero .",
    "unbinned extended maximum likelihood fits  @xcite have become popular in the past few years .",
    "this is an excellent analysis tool for rare signal searches since , unlike a standard maximum likelihood , an extended maximum likelihood correctly incorporates the poisson error on the number of observed events .",
    "thus , when one observes contributions from two processes ( e.g. , signal and background ) , one should use an extended unbinned likelihood : @xmath70 instead of a standard likelihood : @xmath71 here @xmath72 and @xmath73 represent the signal and background spatial pdf s , respectively .",
    "@xmath74 is the total number of events observed in the signal region and in the vicinity , and @xmath1 and @xmath23 are the signal and background rates , respectively .",
    "it has also become a common practice to extract an upper limit value by integrating a likelihood function : @xmath75 where @xmath8 , as usually , denotes the value of an upper limit . the likelihood @xmath76 is typically obtained by integrating the two - dimensional likelihood @xmath77 over the parameter space @xmath23 : @xmath78 this technique is applied , for instance , to estimate upper limits in rare @xmath79 decay studies  @xcite .",
    "it is important to realize that the integration of the likelihood implicitly uses the bayesian approach . as it was pointed out by cousins  @xcite , _ in particle physics ,",
    "the prior is almost always taken uniform ( where non - zero ) , although this assumption goes unemphasized by those who merely report that they `` integrated the likelihood function''_.    to understand this comment , one should recall the definition of a likelihood function : @xmath80 where @xmath81 is a set of observables , the quantity @xmath82 ( @xmath83 ) is the coordinate of the @xmath84th event , the symbol @xmath85 denotes the corresponding pdf , and a vertical line @xmath86 always implies conditional distribution .",
    "applying bayes theorem , one obtains : @xmath87 if signal and background are assumed independent , where the signal and background contributions are non - factorizable . in fact , this assumption is not as obvious as it may seem . ]",
    ", their joint pdf must factorize : @xmath88 . multiplying both sides of the above equation by @xmath37 and integrating over @xmath23 ,",
    "one obtains : @xmath89 the quantity on the right side of the equation can be recognized as @xmath76 .",
    "therefore , @xmath90 in the small signal limit @xmath91 , the likelihood  ( [ eq : lkh ] ) is expressed as : @xmath92 due to the fact that the contributions from the signal and background rates @xmath1 and @xmath23 decouple , the background pdf @xmath37 in eqn .",
    "( [ eq : lkh_b ] ) can not change the ratio @xmath93 .",
    "but when the approximation @xmath91 is no longer valid , this is not so .",
    "thus , eqn .",
    "( [ eq : lkh_int ] ) treats the pdf @xmath37 as prior knowledge and assumes that it is flat in the interval @xmath94 .",
    "furthermore , the posterior distribution @xmath95 can be represented as : @xmath96 which is similar to the bayesian formula  ( [ eq : poster ] ) .",
    "thus , eqn .",
    "( [ eq : int_s ] ) implicitly assumes a flat prior @xmath97 and integrates @xmath98 to extract an upper limit . when the experiment is dominated by background , i.e. , @xmath91 , the likelihood  ( [ eq : lkh_int ] ) is proportional to @xmath99 and the extracted value of an upper limit is equal to 2.3 at 90% confidence level .",
    "the approximation @xmath91 is equivalent to the situation when no events are observed in the signal region ( @xmath31 ) , but the expected number of background events is non - zero ( @xmath47 ) . under these conditions ,",
    "the bayesian method  ( [ eq : pdg96 ] ) with a flat prior gives the @xmath99 behavior as well .",
    "neither the classical approach , nor the bayesian methods with alternative priors give the @xmath99 behavior for @xmath31 and @xmath47 ; all these techniques give smaller upper limit values .",
    "thus , the integration of the likelihood and the bayesian method with a flat prior give the most conservative estimates in background - dominated analyses .",
    "one can easily avoid the implicit use of the bayesian method and set an upper limit using the frequentist definition .",
    "it is straightforward to implement this approach by running a monte carlo job .",
    "first , the observed data @xmath100 is fitted to the likelihood function  ( [ eq : lkh ] ) to extract estimates @xmath101 and @xmath102 of the true signal and background rates .",
    "then , for every assumed value of an upper limit @xmath8 , a monte carlo sample , consisting of a large number of experiments , is generated .",
    "for each experiment the number of signal and background events are generated assuming poisson distributions : @xmath103 and the coordinates of events are generated , based on the spatial pdf s @xmath72 and @xmath73 .",
    "then the outcome of every experiment is fitted to the same likelihood function  ( [ eq : lkh ] ) and the distribution of measured signal rates @xmath104 is plotted .",
    "the confidence level corresponding to this value of @xmath8 is estimated as : @xmath105 thus , a value of @xmath8 is chosen that gives the required confidence level @xmath10 .",
    "this agrees with the frequentist approach when an experimentalist draws inference about an unknown parameter on the basis of observed data only , without making any subjective assumption .",
    "the bayesian and classical approaches described in sections  [ sec : bayes ] and [ sec : class ] are based on the conditional probability @xmath4 , i.e. , the probability to observe @xmath3 events in the signal region , given the signal rate @xmath1 .",
    "however , the number of events observed in the signal region by itself is not so important , since the usual goal of an experiment is not to count events in the signal region , but to observe a signal of high statistical significance .",
    "these approaches do not take into account the fact that the number of background events fluctuates too .",
    "for example , the classical method  ( [ eq : class_ul ] ) estimates the confidence level as a probability to observe a larger number of events in the signal region than the number observed in the experiment , given the assumed value @xmath1 of the signal rate .",
    "but , at the same time , the number of background events in the sideband can fluctuate up to high values or down to zero .",
    "the former implies that no signal is observed , and the latter implies that a very clean signal is observed .",
    "the methods based on the pdf @xmath4 take into account both these possibilities and thus do not distinguish between signals of high and low statistical significance .",
    "therefore , one should replace the conditional pdf @xmath4 with the conditional pdf @xmath106 , where @xmath68 represents the statistical significance of a signal . before we proceed to derivation of the related mathematical formalism",
    ", we need to discuss various definitions of statistical significance .      if @xmath3 events are observed in the signal region and @xmath23 is the estimated background rate , then the statistical significance @xmath68 of a signal is defined by @xmath107 that is , it represents the probability of observing @xmath3 or a larger number of background events in an identical independent experiment .",
    "the background rate @xmath23 can be estimated in a number of ways .",
    "if the background rate is estimated _ independently _ of the data seen , e.g. , from a monte carlo analysis or from another data sample that is known to contain no signal events , then it is common to assume that the estimated background rate is proportional to the rate observed in the independent experiment : @xmath108 where @xmath109 is the number of events observed in the independent experiment , @xmath110 is the corresponding scale factor and the subscript @xmath111 implies that the background rate is estimated independently of the data seen . if the background rate is estimated _ from data _ , then the situation is more complicated . in this case",
    ", the background rate is usually estimated from sideband , i.e. , a region which is located near the signal region and which contains no signal events : @xmath112 here @xmath113 is the number of events observed in the sideband , and @xmath114 is the sideband - to - signal scale factor . under the assumption of flat background ,",
    "the scale factor is given by : @xmath115 where @xmath116 is the area of the signal region , and @xmath117 is the area of the sideband .",
    "the definition  ( [ eq : b_stand ] ) of the background rate is , in my opinion , incorrect .",
    "it works only if the sideband is much larger than the signal region , and thus the estimate of the expected background rate @xmath23 is accurate enough .",
    "however , in a situation when the areas of signal and sideband regions are comparable , eqn .",
    "( [ eq : b_stand ] ) , combined with eqn .",
    "( [ eq : ss_prob ] ) , overestimates the significance of a signal for large numbers of observed events @xmath118 , increasing the probability of a `` discovery '' .",
    "this is caused by the fact that the formulas  ( [ eq : ss_prob ] ) and ( [ eq : b_stand ] ) answer the wrong question .",
    "the correct question is : what is the probability of observing @xmath3 or a larger number of events in the signal region _ if the true signal rate is zero _ ? to answer this question , one has to assume that _ all _ events , that were observed in the experiment , came from background , and therefore one has to redefine : @xmath119 where @xmath74 is the number of events observed in the entire region , which includes the signal region , sideband and , perhaps , an intermediate region between the signal and sideband regions , and @xmath120 is the corresponding scale factor . under the assumption of flat background ,",
    "the scale factor is given by : @xmath121 where @xmath122 is the area of the entire region .",
    "in the same spirit , statistical significance , as defined via likelihood , is given by : @xmath123 i.e. , it gives a number of standard deviations from the observed signal rate , which maximizes @xmath76 , to the zero signal rate , under the assumption that @xmath124 is distributed as @xmath125 .",
    "formula  ( [ eq : b_my ] ) should be used only to estimate statistical significance of a signal ; for upper limit calculation one is not allowed to assume that all observed events come from background and one has to apply the standard definition([eq : b_stand ] ) of an expected background rate .    a numerical discrepancy between the definitions  ( [ eq : b_stand ] ) and ( [ eq : b_my ] )",
    "can be illustrated on the following hypothetical example .",
    "let us assume that the background spatial pdf is flat in the vicinity of the signal region , that the area of the sideband is equal to that of the signal region , and that one event is observed in the signal region and no events are observed in the sideband .",
    "then an experimentalist , who uses the definition  ( [ eq : b_stand ] ) of the statistical significance , would claim that she / he observes a very clean signal ( @xmath126 ) , while an experimentalist , who uses the definition  ( [ eq : b_my ] ) , will estimate the statistical significance of the observed signal as @xmath127 .",
    "the latter reflects the fact that , due to the specific choice of the sideband and signal regions , the observed statistic ( one event ) is insufficient for positive identification of the signal .",
    "this example is purely hypothetical . of course , in the situation",
    "when only one event is observed and the area of the sideband is comparable to that of the signal region , most of experimentalists would choose to quote an upper limit instead of a measurement . a more realistic situation occurs when the sideband is somewhat larger than the signal region , there are some events both in the signal region and in the sideband and the calculated statistical significance is close to three . then one has to make a binary decision : if the statistical significance is larger than three , then a measurement is quoted , otherwise an upper limit is quoted .",
    "in this situation the choice of a specific procedure becomes fairly important , and the example above shows that the numerical discrepancy between the two approaches can be significant .",
    "the conclusion that i would like to reach in this section is that there are two situations that should be treated differently .",
    "the first situation occurs when the background rate is estimated independently of the data seen . in this case one",
    "has to adopt the definition  ( [ eq : b_ind ] ) of the background rate and therefore define statistical significance as : @xmath128 the second situation takes place when the background rate is estimated from the same data sample which is used to draw inference about the unknown signal rate . as shown above , in this case one",
    "has to adopt the definition  ( [ eq : b_my ] ) .",
    "statistical significance is then defined as : @xmath129 these two formulas will be used to estimate upper limits , based on the statistical significance of a signal .      as shown in section  [ sec : comment ] , the statistical significance @xmath68 of a signal is defined either by eqn .",
    "( [ eq : ss_ind ] ) or by eqn .",
    "( [ eq : ss_my ] ) .",
    "i will take eqn .",
    "( [ eq : ss_my ] ) as an example and proceed to derive a _ cumulative density function _ ( cdf ) @xmath130 .",
    "( [ eq : ss_ind ] ) is chosen , the derivation goes through similar steps ; thus , only the final result will be quoted .",
    "when the background and signal rates are estimated from the same data sample , one can rewrite eqn .",
    "( [ eq : ss_my ] ) as : @xmath131^k}{k!}\\ , \\ ] ] where @xmath3 is the number of events observed in the signal region , @xmath132 is the number of events observed in the outer region , which covers the sideband and , perhaps , an intermediate region between the signal region and the sideband , and @xmath120 is the corresponding scale factor . under the assumption of flat background ,",
    "the scale factor is given by : @xmath133 where @xmath116 and @xmath134 are the areas of the signal and outer regions respectively .",
    "the random variables @xmath3 and @xmath132 are drawn from independent poisson distributions : @xmath135 where @xmath136 is the mean of the poisson distribution that controls the number of events in the outer region @xmath134 .",
    "the best unbiased estimator of @xmath136 is the number of events actually observed outside the signal region : @xmath137 and thus the equality @xmath138 is implied in the further discussion . in eqn .",
    "( [ eq : dists ] ) the expected number of background events @xmath23 in the signal region is estimated in the traditional way : @xmath139 , and its value is not used to determine the statistical significance of the signal .    the cdf @xmath130 can not be expressed in a convenient analytical form .",
    "however , the problem can be simplified by introducing a new variable : @xmath140^k}{k!}\\ .\\ ] ] hence , @xmath141 the variable @xmath142 is a monotone function of @xmath68 .",
    "therefore , its cdf can be obtained by a one - to - one transformation : @xmath143 and one can use the variable @xmath142 instead of @xmath68 to set an upper limit .",
    "the cdf of @xmath142 is given by : @xmath144 where @xmath145 is the smallest non - negative integer which satisfies the inequality : @xmath146^k}{k ! }",
    "\\leq p'\\ ] ] for the given value of @xmath3 .    the infinite sum over @xmath3 in eqn .",
    "( [ eq:1-p ] ) converges quickly and can be easily calculated numerically . in a simulation ,",
    "described in section  [ sec : toy_model ] , the summation over @xmath3 from 1 to 1000 was enough to achieve an accuracy of @xmath147 or better for @xmath148 .",
    "now one can choose the approach one would like to use .",
    "all the techniques described in sections  [ sec : bayes ] and [ sec : class ] are applicable , but now instead of a conditional pdf @xmath4 one would have to use the conditional cdf @xmath149 . the easiest thing to try",
    "is to employ the classical approach and define the confidence interval as @xmath7 . in this case , through the reasoning described in section  [ sec : class ] , one arrives at the formula similar to eqn .",
    "( [ eq : class_ul ] ) : @xmath150 where @xmath151^k}{k!}\\ ] ] is the observed value of the variable @xmath142 .",
    "when no events are observed in the signal region ( @xmath152 ) , one obtains @xmath153 , therefore @xmath154 for any @xmath155 , and eqn .",
    "( [ eq : ul_p ] ) is reduced to : @xmath156 which coincides with the classical expression  ( [ eq : class_ul ] ) .",
    "this reflects the fact that in this case background fluctuations are irrelevant as the statistical significance @xmath68 is always equal to @xmath157 , no matter how many background events we observe in the sideband .    when no events are observed outside of the signal region ( @xmath158 and therefore @xmath46 ) , one obtains @xmath159 for any @xmath160 and @xmath161 , therefore the sum over @xmath132 in eqn .",
    "( [ eq:1-p ] ) is always equal to 1 , and the formula  ( [ eq : ul_p ] ) is reduced to : @xmath162 which again is identical to the classical expression  ( [ eq : class_ul ] ) .",
    "this reflects the fact that no background fluctuations are expected in this case , and hence , the statistical significance @xmath68 is a function of the signal rate @xmath1 only .",
    "if the background rate is estimated independently of the data seen , then one should start from the definition  ( [ eq : ss_ind ] ) of statistical significance and repeat the same logical steps to arrive at an equation similar to eqn .",
    "( [ eq:1-p ] ) .",
    "the random variables @xmath3 and @xmath109 are drawn from independent poisson distributions : @xmath163 where @xmath164 is the mean of the poisson distribution that controls the number of events in an independent sample which is used to estimate the background rate .",
    "the best unbiased estimator of @xmath164 is the number of events actually observed in the independent data sample : @xmath165 and thus the equality @xmath166 is implied . now",
    "the background rate used in the definition of statistical significance and the background rate used to calculate an upper limit are estimated similarly . without losing generality , one can stipulate that : @xmath167 the cdf of @xmath142 is now given by : @xmath168 where @xmath169 is the smallest non - negative integer which satisfies the inequality @xmath170 for the given value of @xmath3 .",
    "the performance of all approaches discussed in this paper is compared using the following toy model .",
    "the total observation region is defined as an interval @xmath171 .",
    "the signal spatial pdf is taken to be a gaussian with zero mean and unit variance , and the background spatial pdf is taken to be flat . under these conditions , the signal region is defined as @xmath172 , and the sidebands are defined as @xmath173 and @xmath174 .    the value of the expected background rate is taken to be @xmath175 consecutively , which corresponds to the number of events observed in the sidebands @xmath176 .",
    "the number of events in the intermediate region @xmath177 and @xmath178 is set equal to the expected number @xmath23 of background events in the signal region , since the area of the signal region is equal to that of the intermediate region .",
    "positions of events in the sideband and intermediate regions are generated under the assumption of a uniform spatial pdf @xmath73 .",
    "for every value of the expected background rate @xmath23 , upper limits obtained with various approaches are estimated for the number @xmath3 of events in the signal region varying in integer steps from 0 to 6 .",
    "the results are plotted in fig .",
    "[ fig : all ] . inside the signal region",
    "all events are positioned precisely at zero .",
    "it is assumed that the background rate in this experiment is estimated from sidebands ; thus , to implement the classical method of section  [ sec : ss ] , formulas  ( [ eq : ul_p ] ) and ( [ eq : p_obs ] ) are used . to estimate a 90% cl upper limit by the monte carlo technique of section  [ sec : lkh ]",
    ", i find the value @xmath8 of an upper limit by using the method of binary division .",
    "for every assumed value of @xmath8 , i generate a monte carlo sample consisting of 50,000 experiments and use the formula  ( [ eq : ul_mc ] ) to estimate the corresponding confidence level .",
    "this procedure is repeated until the value of @xmath8 that gives a 90% confidence level is obtained .",
    "the required accuracy for the computation of @xmath8 is taken @xmath179 . for comparison ,",
    "lower and upper bounds of 90% confidence intervals obtained by the procedure  @xcite are shown with crosses .",
    "one cross for a specific value of @xmath3 corresponds to the situation when the lower bound is strictly zero .    as shown in fig .",
    "[ fig : all ] , at @xmath31 the bayesian method  ( [ eq : pdg96 ] ) with a flat prior pdf and the integration of the likelihood , described in section  [ sec : lkh ] , always give 2.30 , while all the other approaches give somewhat smaller values .",
    "for this particular model , the likelihood integration technique of section  [ sec : lkh ] turns out to be the most conservative approach , except for @xmath46 .",
    "the bayesian method with a flat prior pdf always gives larger upper limit values than the bayesian methods with the @xmath26 and @xmath25 priors and both classical approaches discussed in sections  [ sec : class ] and [ sec : ss ] .",
    "the results produced by the bayesian method with the @xmath25 prior can be obtained by shifting the corresponding results obtained with a flat prior one step to the right , e.g. , @xmath180 and @xmath181 obviously produce the same result when substituted into the gamma - function @xmath182",
    ". the classical approaches of sections  [ sec : class ] and [ sec : ss ] fail to set an upper limit at @xmath183 , i.e. , when background dominates over signal .",
    "the classical procedure , based on the statistical significance of a signal , always gives a smaller upper limit value , compared to the standard classical approach of section  [ sec : class ] , except at @xmath31 . in the specific situation ,",
    "when the expected background is zero , the bayesian method with a flat prior pdf , both classical approaches and both likelihood techniques of section  [ sec : lkh ] give identical results .",
    "in 1996 the cleo collaboration searched  @xcite for the neutrinoless decay @xmath0 and set an upper limit , which is , so far , the most stringent limit on the @xmath0 branching fraction . in this analysis 3",
    "events were observed in the signal region and the expected number of background events was estimated to be 5.5 .",
    "the signal monte carlo and data energy - vs - mass distributions are shown in fig .",
    "[ fig : mugamma ] . the bayesian approach with a flat prior pdf was used and the upper limit value was estimated as 3.6 at 90% confidence level .",
    "this value was divided by the integrated luminosity and efficiency factor and thus an upper limit of @xmath184 at 90% confidence level was obtained for the @xmath0 branching fraction . in table  1 are shown the values of upper limits for this analysis calculated with the alternative techniques .",
    "* upper limits at 90% cl for the @xmath0 analysis of ref .",
    "@xcite . *    [ cols=\"^,^\",options=\"header \" , ]     the value given by the procedure  @xcite of feldman and cousins is a rough estimate only , since the combination of input parameters @xmath185 is not shown in their tables .    to implement the maximum likelihood approach of section  [ sec : lkh ] , the signal monte carlo two - dimensional distribution on the energy - vs - mass plane was fitted to a bivariate gaussian plus a non - gaussian tail produced by initial and final state radiation and other effects : @xmath186 \\right\\ } \\right .",
    "+ \\nonumber \\\\ & & \\left .",
    "+ b\\epsilon(m , e ) \\right\\}\\ ; \\\\ & & \\nonumber \\\\ \\epsilon(m , e ) & = & \\left\\ { \\begin{array}{cl } \\frac{1}{\\sqrt{2\\pi}\\sigma_m } exp\\left [ -\\frac{1}{2 } \\left ( \\frac{m - m_0}{\\sigma_m } \\right)^2 \\right ] \\frac{1}{\\sigma_e\\gamma(\\alpha)\\beta^\\alpha } \\left ( \\frac{e_0-e}{\\sigma_e } \\right)^{\\alpha-1 } exp\\left [ -\\frac{e_0-e}{\\beta\\sigma_e } \\right ] & \\mbox{if $ e < e_0 $ } \\\\ 0 & \\mbox{otherwise } \\end{array } \\right . \\nonumber\\end{aligned}\\ ] ] where @xmath122 , @xmath79 , @xmath187 , @xmath188 , @xmath189 , @xmath190 , @xmath191 , @xmath192 and @xmath193 are the fit parameters .",
    "the background spatial pdf @xmath73 was obtained by fitting data events observed in the vicinity of the signal region to a linear function : @xmath194\\ , \\ ] ] where @xmath195 , @xmath196 and @xmath197 are the fit parameters , and @xmath198 and @xmath199 are the limits defining the fit region .",
    "the three events observed in the signal region are located far from the peak of the signal monte carlo distribution .",
    "thus , the maximum likelihood fit treats these events as background , and the extracted signal rate is consistent with zero .",
    "this explains why the likelihood integration technique gives the value of 2.30 .",
    "there is no such thing as the `` best '' procedure for upper limit estimation .",
    "an experimentalist is free to choose any procedure she / he likes , based on her / his belief and experience .",
    "the only requirement is that the chosen procedure must have a strict mathematical foundation .",
    "the bayesian method with a flat prior and the likelihood integration technique of section  [ sec : lkh ] seem to have been the two most popular choices in the past few years .",
    "typically , these two approaches give the most conservative values of upper limits .",
    "the purpose of this note is to show that there are other approaches , equally justified by mathematical formalism , which produce less conservative estimates .",
    "the author thanks prof .  w.t .",
    "ford , prof .",
    "r.  stroynowski , prof .",
    "gray and dr .  i.  volobouev for useful comments and suggestions .",
    "999 t.  bayes , _ facsimiles of two papers by bayes _ ( hafner publ .",
    "co. , 1963 ) .",
    "laplace , _ philosophical essay on probabilities _",
    "( dover publications , 1951 ) .",
    "h.  jeffreys , _ theory of probability _",
    ", oxford at clarendon , 1961 ) .",
    "h.  jeffreys , _ proc . of the royal soc . of london",
    "_ * a 196 * ( 1946 ) 453 .",
    "jaynes , _ ieee trans . on systems",
    "sci . and cyber .",
    "_ * ssc-4 , 3 * ( 1968 ) 227 .",
    "prosper , _ phys .",
    "_ * d 37 , n 5 * ( 1988 ) 1153 .",
    "g.e.p .  box and g.c .",
    "tiao , _ bayesian inference in statistical analysis _ ( wiley classics , 1992 ) .",
    "o.  helene , _ nucl .",
    "instr . and meth .",
    "_ * 212 * ( 1983 ) 319 .",
    "o.  helene , _ nucl .",
    "and meth . in phys .",
    "* 228 * ( 1984 ) 120 .",
    "b.  escoubes , s.  de  unamuno and o.  helene , _ nucl . instr . and meth . in phys .",
    "res . _ * a 257 * ( 1987 ) 346 .",
    "o.  helene , _ nucl .",
    "instr . and meth .",
    "res . _ * a 300 * ( 1991 ) 132 .",
    "g.  zech , _ nucl .",
    "instr . and meth .",
    "res . _ * a 277 * ( 1989 ) 608 .",
    "barnett et al .",
    "( particle data group ) , _ phys .",
    "_ * d 54 * ( 1996 ) 166 . c.  caso et al .",
    "( particle data group ) , _ the european physical journal _ * c 3 * ( 1998 ) 176",
    ". j.  neyman , _ philos .",
    "trans . of the royal soc . of london",
    "_ * a 236 * ( 1937 ) 333 .",
    "f.  garwood , _ biometrika _ * 28 * ( 1936 ) 437 .",
    "feldman and r.d .",
    "cousins , _ phys .",
    "* d 57 * ( 1998 ) 3873 .",
    "e.l .  crow and r.s .",
    "gardner , _ biometrika _ * 46 * ( 1959 ) 441 .",
    "cousins , _ am .",
    "j. of phys .",
    "_ * 63 ( 5 ) * ( 1995 ) 398 .",
    "eadie et al . , _ statistical methods in experimental physics _ ( north - holland , amsterdam , 1971 ) .",
    "l.  lyons , w.  allison and j.  panella  comellas , _ nucl . instr . and meth .",
    "_ * a 245 * ( 1986 ) 530 .",
    "r.  barlow , _ nucl .",
    "instr . and meth .",
    "_ * a 297 * ( 1990 ) 496 .",
    "b.  behrens et al .",
    "( cleo ) , _ phys .",
    "_ * 80 * ( 1998 ) 3710 .",
    "t.  bergfeld et al .",
    "( cleo ) , _ phys .",
    "lett . _ * 81 * ( 1998 ) 272 .",
    "edwards et al .",
    "( cleo ) , _ phys .",
    "* d 55 * , ( 1997 ) 3919 ."
  ],
  "abstract_text": [
    "<S> bayesian , classical , and extended maximum likelihood approaches to estimation of upper limits in experiments with small numbers of signal events are surveyed . </S>",
    "<S> the discussion covers only experiments whose outcomes are well described by a poisson statistic . </S>",
    "<S> a new approach , based on the statistical significance of a signal rather than on the number of events in the signal region , is proposed . </S>",
    "<S> a toy model and an example of a recent search for the lepton number violating decay @xmath0 are used to illustrate application of the discussed techniques .    </S>",
    "<S> pacs : 02.50.-r , 02.50.cw , 02.50.ng . </S>"
  ]
}