{
  "article_text": [
    "sph is the most widely used numerical method for cosmological simulations with gas dynamics . with our collaborators ,",
    "we have developed a new version of sph , called adaptive sph ( asph ) , which addresses some specific limitations of standard sph ( shapiro et al .",
    "1996 ; owen et al .",
    "1998 ; martel & shapiro 2002 ) . for a given number of particles , asph resolves much better than standard sph whenever anisotropic collapse or expansion occurs .",
    "asph also has a shock - tracking algorithm that can be used to restrict spurious heating by artificial viscosity .",
    "asph simulations in 3d of explosions during galaxy formation are described elsewhere ( martel & shapiro 2000 , 2001a , b ) .",
    "for kernel smoothing in standard sph to be accurate , the smoothing length @xmath0 must be a few times the mean particle spacing @xmath1 .",
    "if @xmath2 , spatial variations in the fluid quantities are oversmoothed , leading to a loss of resolution ; if @xmath3 , particles lose contact with their nearest neighbors , resulting in a loss of accuracy . since the mean particle spacing varies with time and space , each particle must carry its own smoothing length , which varies with time to reflect the expansion or contraction of the fluid .",
    "this is illustrated in figure  1 .",
    "the top row shows a 2d distribution of particles contracting isotropically .",
    "we focus on one particle , shown by a large dot .",
    "the smoothing length @xmath0 of that particle defines a _ zone of influence _",
    ", indicated by a circle . as the fluid contracts , @xmath0 is reduced in proportion to the mean particle spacing .",
    "the second row illustrates the case of an anisotropic contraction , the planar collapse of a sinusoidal density perturbation , leading to the formation of a caustic . in the direction of collapse",
    ", the smoothing length does not shrink fast enough to keep up with the contraction of the fluid , and eventually greatly exceeds the mean particle spacing , leading to poor resolution . in the transverse direction , the smoothing length shrinks but the fluid does not contract , and horizontal rows of particles progressively lose contact with one another .",
    "the third row illustrates the asph approach .",
    "the smoothing is anisotropic .",
    "the smoothing length is replaced by an _",
    "h - tensor _ which defines an elliptical zone of influence ( ellipsoidal in 3d ) .",
    "this zone of influence deforms and rotates to follow the deformation of the fluid .",
    "the smoothing length is now direction dependent , and remains proportional to the mean particle spacing _ in any direction_.    artificial viscosity is necessary to allow the formation of shocks , but can lead to spurious preheating of gas contracting supersonically far from any shock . in asph , the evolution of the h - tensors can be used to track the location of shocks and apply artificial viscosity selectively .",
    "this is illustrated in the third row of figure  1 . in asph",
    ", viscous heating is initially turned off .",
    "as the system evolves , the smoothing ellipsoid flattens , with one axis approaching zero length .",
    "asph uses this to determine when a particle is about to be shocked and turns viscous heating on for that particle .",
    "this restricts viscous heating to particles encountering shocks , as needed .    to illustrate how asph achieves higher resolution than standard sph , we focus on a stringent test , the planar collapse of a sinusoidal plane - wave density perturbation , the cosmological pancake problem .",
    "the fluctuation grows from linear to nonlinear amplitude and forms a caustic in the dark matter distribution in the plane of symmetry at scale factor @xmath4 , with strong accretion shocks located on each side of the central plane .",
    "we use equal - mass dark matter and gas particles , in a universe with @xmath5 and @xmath6 , with 64 particles per pancake wavelength @xmath7 , to evolve the system to @xmath8 .",
    "figure 2 shows gas density , temperature , velocity , and pressure profiles ( in computational units ) at the final time .",
    "the shock is located at @xmath9 ( from midplane ) .",
    "the asph results are significantly better than the sph results , which is especially noticeable in the postshock density and temperature profiles .",
    "the asph profiles follow the exact postshock solution over nearly 3 orders of magnitude in length , while the sph profiles level off because of limited spatial resolution .",
    "a serious numerical problem emerges for both algorithms when radiative cooling is added . in figure  3 , we plot a typical cooling function commonly used in cosmological simulations .",
    "let us assume that the rectangle in the top panel of figure  3 represents the physically relevant region .",
    "the cooling rate drops sharply at low and high temperatures . to approximate this behavior",
    ", we consider a simplified cooling window function illustrated in the bottom panel of figure  3 .",
    "the cooling rate is constant inside a fixed temperature window ( region ii ) , and zero outside that window ( regions i and iii ) .    in principle , when a fluid element is shock - heated from region  i to region  iii , it should cross the shock too fast to cool radiatively as it passes thru region  ii .",
    "the numerical shock has a finite thickness which is unphysically large , however , so the shock transit time , @xmath10 , can artificially exceed the physical cooling time in region  ii , @xmath11 , causing spurious radiative cooling . since @xmath10 scales like the shock thickness divided by the preshock velocity , it depends on resolution , as the number of particles across the shock tends to be constant . if the cooling rate is so large or the resolution so poor that @xmath12 , particles will be unable to cross region ii , as cooling forces them back to region  i , and the shock does not form .",
    "we call this the _ false cooling problem_.    to illustrate this problem , we introduce a window cooling function to the cosmological pancake problem",
    ". figure  4 shows the temperature and pressure profiles at @xmath8 .",
    "the shaded area indicates the cooling window",
    ". if cooling is slow ( left panels ) , the shocked gas particles are able to cross the cooling window and accumulate correctly in the postshock region .",
    "the particles located at the bottom of the cooling window are those whose postshock temperature was inside the cooling window",
    ". they cooled _",
    "after _ having been shocked .",
    "when cooling is fast ( right panels ) , however , particles are incapable of reaching their correct postshock temperature , and the shock does not even form .",
    "the false cooling problem only affects particles that are going through a shock transition .",
    "if the algorithm could track the location of shocks , then false cooling could be eliminated , simply by not allowing particles undergoing shock transitions to cool .",
    "there is already a shock - tracking algorithm in asph , which is used to restrict viscous heating .",
    "the algorithm identifies particles located in shock transitions and turns viscous heating on for them .",
    "we can attempt to solve the false cooling problem by turning cooling off for the same particles , with results as shown in the left panels of figure  5 .",
    "particles are now able to reach the postshock temperature and pressure ( compare with the right panels of fig .  4 ) , and the asph solution is close to the exact one .",
    "there are some oscillations near the contact discontinuity between hot and cooled gas , but since it involves only a few particles , these oscillations are underresolved and do not feed back into the evolution of the system .",
    "the right panel shows an attempt to improve the solution by introducing a small amount of artificial conduction .",
    "the oscillations are gone , but the postshock profile is not as well reproduced .",
    "anisotropic smoothing kernels enable the asph algorithm to simulate problems involving strongly anisotropic collapse or expansion more accurately than isotropic sph , with better length resolution for the same number of particles .",
    "additional improvement results because asph tracks the location of shocks and restricts viscous heating to particles overtaken by shocks .",
    "we have identified a major problem , called _ false cooling _ , which can affect cosmological simulations whenever the cooling rate has temperature peaks .",
    "false cooling prevents shocked gas from reaching regions of high temperature where the cooling is low . solving this problem may require a shock - tracking capability like that of asph .",
    "our preliminary results are encouraging ."
  ],
  "abstract_text": [
    "<S> we summarize the ideas that led to the adaptive smoothed particle hydrodynamics ( asph ) algorithm , with anisotropic smoothing and shock - tracking . </S>",
    "<S> we then identify a serious new problem for sph simulations with shocks and radiative cooling  _ false cooling _  and discuss a possible solution based on the shock - tracking ability of asph .    </S>",
    "<S> # 1_#1 _ # 1_#1 _ =    # 1 1.25 in .125 in .25 in </S>"
  ]
}