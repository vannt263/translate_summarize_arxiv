{
  "article_text": [
    "there is an ever increasing wealth of observational evidence indicating the non - sphericity of almost every type of astronomical object ( e.g. , extended circumstellar environments , novae shells , planetary nebulae , galaxies , and agns ) . to accurately interpret this data",
    ", detailed two- and three - dimensional radiation transfer techniques are required . with the availability of fast workstations , many researchers are turning to monte carlo techniques to produce model images and spectra for the asymmetric objects they are investigating . in monte carlo radiation transfer simulations , packets of energy or `` photons '' are followed as they are scattered and absorbed within a prescribed medium .",
    "one of the features of this technique is that the locations of the packets are known when they are absorbed , so we can determine where their energy is deposited .",
    "this energy heats the medium , and to conserve radiative equilibrium , the absorbed energy must be reradiated at other wavelengths , depending on the opacity sources present . tracking these photon packets , while enforcing radiative equilibrium , permits the calculation of both the temperature structure and emergent spectral energy distribution ( sed ) of the envelope .",
    "the ability of monte carlo techniques to easily follow the transfer of radiation through complex geometries makes them very attractive methods for determining the temperature structure within non - spherical environments  a task which is very difficult with traditional ray tracing techniques .",
    "previous work on this problem for spherical geometries includes the approximate solutions by scoville & kwan ( 1976 ) , who ignored scattering , leung ( 1976 ) , and diffusion approximations by yorke ( 1980 ) .",
    "the spherically symmetric problem has been solved exactly by rowan - robinson ( 1980 ) , wolfire & cassinelli ( 1986 ) , and ivezi & elitzur ( 1997 ) , who used a scaling technique .",
    "extensions of the exact solution to two dimensions have been performed by efstathiou & rowan - robinson ( 1990 , 1991 ) , while approximate two - dimensional models have been presented by sonnhalter , preibisch , & yorke ( 1995 ) and menshchikov & henning ( 1997 ) .",
    "radiative equilibrium calculations using the monte carlo technique have been presented by lefevre , bergeat , & daniel ( 1982 ) ; lefevre , daniel , & bergeat ( 1983 ) ; wolf , henning , & secklum ( 1999 ) ; and lucy ( 1999 ) .",
    "most of these authors ( lucy being exceptional ) use a technique in which stellar and envelope photon packets are emitted separately .",
    "the number of envelope packets to be emitted is determined by the envelope temperature , while the envelope temperature is determined by the number of absorbed packets .",
    "consequently these techniques require iteration , usually using the absorbed stellar photons to provide an initial guess for the envelope temperature .",
    "the iteration proceeds until the envelope temperatures converge .",
    "note that the stellar luminosity is not automatically conserved during the simulation ; only after the temperatures converge is the luminosity approximately conserved .",
    "in contrast , lucy adopts a strategy in which absorbed photon packets are immediately re - emitted , using a frequency distribution set by the current envelope temperature .",
    "although the frequency distribution of the reprocessed photons is incorrect ( until the temperatures have converged ) , his method automatically enforces local radiative equilibrium and implicitly conserves the stellar luminosity .",
    "the insight of lucy s method is that conservation of the stellar luminosity is more important than the spectral energy distribution when calculating the radiative equilibrium temperatures .",
    "nonetheless , this method requires iteration .",
    "the primary problem faced by lucy s method is the incorrect frequency distribution of the re - emitted photons . in this paper",
    "we develop an adaptive monte carlo technique that corrects the frequency distribution of the re - emitted photons .",
    "essentially , our method relaxes to the correct frequency and temperature distribution .",
    "furthermore it requires no iteration as long as the opacity is independent of temperature .",
    "such is the case for astrophysical dust . in section  2",
    ", we describe the temperature correction algorithm .",
    "we compare the results of our code with a spherically symmetric code in section  3 , and in section  4 we present results for two dimensional axisymmetric density structures .",
    "we wish to develop a method to calculate the temperature distribution throughout an extended dusty environment for use with monte carlo simulations of the radiation transfer .",
    "the radiation transfer technique we employ has been described in detail in other papers : code & whitney ( 1995 ) ; whitney & hartmann ( 1992 , 1993 ) ; wood et al .",
    "( 1996 ) , so we only summarize it here .",
    "the basic idea is to divide the luminosity of the radiation source into equal - energy , monochromatic `` photon packets '' that are emitted stochastically by the source .",
    "these packets are followed to random interaction locations , determined by the optical depth , where they are either scattered or absorbed with a probability given by the albedo .",
    "if the packet is scattered , a random scattering angle is obtained from the scattering phase function ( differential cross section ) .",
    "if instead the packet is absorbed , its energy is added to the envelope , raising the local temperature . to conserve energy and enforce radiative equilibrium ,",
    "the packet is re - emitted immediately at a new frequency determined by the envelope temperature .",
    "these re - emitted photons comprise the diffuse radiation field . after either scattering or absorption plus reemission",
    ", the photon packet continues to a new interaction location .",
    "this process is repeated until all the packets escape the dusty environment , whereupon they are placed into frequency and direction - of - observation bins that provide the emergent spectral energy distribution . since all the injected packets eventually escape ( either by scattering or absorption followed by reemission ) , this method implicitly conserves total energy .",
    "furthermore it automatically includes the diffuse radiation field when calculating both the temperature structure and the emergent spectral energy distribution .",
    "we now describe in detail how we calculate the temperature structure and seds of dusty environments illuminated by a radiation source .",
    "this radiation can come from any astrophysical source , either internal or external , point - like or extended .",
    "initially we divide the source luminosity , @xmath1 , into @xmath2 photon packets emitted over a time interval @xmath3 .",
    "each photon packet has the same energy , @xmath4 , so @xmath5 note that the number of physical photons in each packet is frequency - dependent .",
    "when the monochromatic photon packet is injected into the envelope , it will be assigned a random frequency chosen from the spectral energy distribution of the source .",
    "this frequency determines the dust absorptive opacity , @xmath6 , and scattering opacity , @xmath7 ( both per mass ) , as well as the scattering parameters for the ensuing random walk of the packet through the envelope .",
    "the envelope is divided into spatial grid cells with volume @xmath8 , where @xmath9 is the cell index .",
    "as we inject source photon packets , we maintain a running total , @xmath10 , of how many packets are absorbed in each grid cell .",
    "whenever a packet is absorbed in a grid cell , we deposit its energy in the cell and recalculate the cell s temperature . the total energy absorbed in the cell",
    "@xmath11    we assume that the dust particles are in local thermodynamic equilibrium ( lte ) , and for simplicity we adopt a single temperature for the dust grains . note that although we use dust for the continuous opacity source , we could replace the dust by any continuous lte opacity source that is independent of temperature . in radiative equilibrium , the absorbed energy , @xmath12 ,",
    "must be reradiated .",
    "the thermal emissivity of the dust @xmath13 , where @xmath14 is the planck function at temperature @xmath15 , so the emitted energy is @xmath16 where @xmath17 is the planck mean opacity , and @xmath18 is the frequency integrated planck function .",
    "if we adopt a temperature that is constant throughout the grid cell , @xmath19 , then @xmath20 where @xmath21 is the mass of the cell .    equating the absorbed ( [ eq : eabs ] ) and emitted ( [ eq : eem ] ) energies , we find that after absorbing @xmath10 packets , the dust temperature is given by @xmath22 note that the planck mean opacity , @xmath23 , is a function of temperature , so equation  ( [ eq : retemp ] ) is actually an implicit equation for the temperature , which must be solved _ every time a packet is absorbed_. since this equation is solved so many times , an efficient algorithm is desirable . fortunately @xmath23 is a slowly varying function of temperature , which implies a simple iterative algorithm may be used to solve equation  ( [ eq : retemp ] ) .",
    "to do so efficiently , we pre - tabulate the planck mean opacities for a large range of temperatures and evaluate @xmath24 by interpolation , using the temperature from the previous guess .",
    "after a few steps , we have the solution for @xmath19 .",
    "note that because the dust opacity is temperature - independent , the product @xmath25 , which is proportional to @xmath26 , increases monotonically with temperature .",
    "consequently @xmath19 always increases when the cell absorbs an additional packet .      now that we know the temperature after absorbing an additional packet within the cell , we must reradiate this energy so that the heating always balances the cooling . prior to absorbing this packet ,",
    "the cell previously has emitted packets that carried away an energy corresponding to the cell s previous emissivity @xmath27 , where @xmath28 is the temperature increase arising from the packet absorption .",
    "note that these previous packets were emitted with an incorrect frequency distribution corresponding to the previous temperature , @xmath29 .",
    "the total energy that should be radiated now corresponds to @xmath30 at the new temperature , @xmath19 .",
    "thus the additional energy to be carried away is given by @xmath31 \\ ; , \\label{eq : deltakappab}\\ ] ] which is the shaded area shown in figure  [ fig : tempcorrect ] . as long as the packet energy @xmath4 is not too large ( this may be assured by choosing a large enough number of photon packets , @xmath2 , to use for the simulation ) , the temperature change @xmath28 is small , so the temperature correction spectrum @xmath32 note that @xmath33 is everywhere positive because @xmath34 , and the planck function is a monotonically increasing function of temperature . therefore to correct the previously emitted spectrum",
    ", we immediately re - emit the packet ( to conserve energy ) , and we choose its frequency using the shape of @xmath33 .",
    "this procedure statistically reproduces @xmath33 for the distribution of the re - emitted packets .",
    "normalizing this distribution , we find the temperature correction probability distribution @xmath35 where @xmath36 is the probability of re - emitting the packet between frequencies @xmath37 and @xmath38 , and the normalization constant @xmath39 .    now that the packet s frequency has changed , we change the opacity and scattering parameters accordingly and continue with scattering , absorption , temperature correction , and re - emission until all the photon packets finally escape from the system . in principle",
    "we could also account for back - warming of the source .",
    "whenever a packet hits the source , the source must reradiate this new energy .",
    "this will change the temperature of the source , and the new source photons can be emitted using a difference spectrum similar to equation ( [ eq : tcorrect ] ) .",
    "when we begin our calculation , no packets have been absorbed , so the initial temperature is zero throughout the envelope .",
    "this means that the initial temperature change is not small as is required by equation  ( [ eq : deltajnu ] ) .",
    "one could use equation  ( [ eq : deltakappab ] ) to re - emit the first packet that is absorbed ; however , this is not necessary .",
    "the number of packets producing this initial temperature change is small ; it is of order the number of spatial grid cells .",
    "furthermore , these packets generally are re - emitted at such long wavelengths that they are not observable .",
    "consequently the error arising from using equation  ( [ eq : deltajnu ] ) to re - emit every packet is too small to be of importance .",
    "as the simulation runs , the envelope starts at zero temperature .",
    "it then heats up , and the radiation field `` relaxes '' to its final spectral shape .",
    "the temperature correction procedure is simply a way of re - ordering the calculation ( which frequencies are being used at a given moment ) so that in the end , all the frequencies have been properly sampled .",
    "consequently , after all the stellar photon packets have been transported , the final envelope temperature is the correct radiative equilibrium temperature , and the emergent spectral energy distribution has the correct frequency shape .",
    "furthermore , the photon re - emission automatically accounts for the diffuse envelope emission .",
    "note that energy is necessarily conserved , and there is no time - consuming iteration in our scheme ; calculating the radiative equilibrium temperature requires no more computational time than an equivalent pure scattering calculation in which the temperature structure is held fixed .",
    "similarly , there is no issue of convergence in our method . unlike @xmath0-iteration",
    ", the photon packets carry energy over large distances throughout the envelope because they are never destroyed , and of course there is no iteration at all . after running @xmath2 packets",
    ", we have the final answer .",
    "the simulation does not continue running until some convergence criterion is met , and the only source of error in the calculation is the statistical sampling error inherent in monte carlo simulations .",
    "to validate our method for determining the radiative equilibrium temperatures and emergent fluxes , we compared our results against a set of benchmark calculations recently developed by ivezi ' c et al .",
    "( 1997 ) for testing spherically symmetric dust radiative equilibrium codes .",
    "the parameters listed by ivezi ' c et al . enable us to exactly reproduce the same set of physical conditions ( i.e , input spectrum , dust destruction radius , optical depth , opacity frequency distribution , and radial density structure ) .    for all benchmark tests , ivezi ' c et al .",
    "used a point source star , radiating with a black body spectrum whose temperature @xmath40k .",
    "the dust density distribution was a power law with radius , @xmath41 where @xmath42 the inner radius of the envelope is the dust destruction radius , @xmath43 , the outer radius is @xmath44 , and the total radial optical depth is @xmath45 , specified at @xmath46 .",
    "the dust absorptive opacity , @xmath6 , and scattering opacity , @xmath7 , were taken to be @xmath47 since the total optical depth at @xmath48 is independently specified , these opacities have been normalized to that at @xmath49 for convenience .",
    "the wavelength - dependent scattering albedo is given by @xmath50 , and the scattering was assumed to be isotropic ( note that in dust simulations , we would normally use a non - isotropic phase function for the scattering ) .    in principle , the inner radius of the dust shell , @xmath43 , is determined by the dust condensation temperature , chosen by ivezi ' c et al . to be @xmath51 .",
    "however , we are only testing the temperature correction procedure , so we have not implemented a scheme to solve self consistently for the dust destruction radius .",
    "the values for @xmath43 were calculated instead using ivezi ' c et al.s eq .",
    "( 4 ) and data from their table  1 . finally",
    ", the outer radius of the dust shell was set to be @xmath52 .",
    "the parameters describing the various test simulations are summarized in table  [ table : benchmarkparms ] .",
    "lcccc 0 & 1 & 8.44 0 & 10 & 8.46 0 & 100 & 8.60 2 & 1 & 9.11 2 & 10 & 11.37 2 & 100 & 17.67 [ table : benchmarkparms ]    lcccc 1000 & 10 & 200 & 0.2 1000 & 10 & 20 & 0.02 10 & 10 & 200 & 20 10 & 10 & 20 & 2 [ table : ellipsoidparms ]    to begin the simulation , we release stellar photon packets with a black body frequency distribution , given by the normalized planck function @xmath53 where @xmath54 . a particularly simple method for sampling the black body distribution is given by carter & cashwell ( 1975 ) .",
    "since this reference is somewhat obscure and difficult to obtain , we summarize the method here .",
    "first , generate a uniform random number , @xmath55 , in the range 0 to 1 , and determine the minimum value of @xmath56 , @xmath57 , that satisfies the condition @xmath58 next obtain four additional uniform random numbers ( in the range 0 to 1 ) , @xmath59 , @xmath60 , @xmath61 , and @xmath62 .",
    "finally , the packet frequency is given by @xmath63 after emitting these packets from the star , we track them through the envelope . to determine the envelope temperature , we must count how many packets are absorbed in each grid cell . since the envelope is spherically symmetric , we employ a set of spherical shells for our grid . to obtain the best poisson error statistics , we should ideally construct the grid positions so that equal numbers of packets are absorbed in each cell . since the probability of absorbing a photon packet is proportional to the optical depth ,",
    "we choose equal radial optical depth grid locations , @xmath64 where @xmath65 is the total number of cells we used , @xmath66 , and @xmath67 . integrating the density , eq .",
    "( [ eq : rho ] ) , over the cell volume to obtain the mass , we find from eq .",
    "( [ eq : retemp ] ) that the temperature in each grid cell is given by @xmath68 } \\over                   { 4 n_\\gamma \\tau_{1\\mu{\\rm m } }             [ ( i^2-i+1/3)\\delta r^2+(2i-1)\\delta r+1 ] } } & ( $ p=0$),\\cr                  { { n_i(n_f - i)(n_f - i+1)(r_\\star / r_{\\rm dust})^2                   ( 1-r_{\\rm dust}/r_{\\rm max } ) } \\over          { 4 n_\\gamma \\tau_{1\\mu{\\rm m } } n_f [ \\kappa_p(t_i ) /           ( \\kappa_{1\\mu{\\rm m}}+\\sigma_{1\\mu{\\rm m } } ) ] } } & ( $ p=2$),\\cr}\\ ] ] where we have used @xmath69 for the stellar luminosity .",
    "we then proceed with the radiation transfer , temperature calculation , and reemission as described in section  2 until all packets exit the envelope .",
    "when the packets escape , they are placed into @xmath70 uniform frequency bins , @xmath71 where @xmath72 . the width of each bin @xmath73 . since the envelope is spherically symmetric , the observed flux @xmath74 , where @xmath75 is the number of packets in the @xmath76 frequency bin , and @xmath77 is the observer s distance from the star",
    "normalizing to the total flux , @xmath78 , the sed is given by @xmath79 the factor @xmath80 arises from using the frequency at the center of the bin .    in figures  [ fig : benchmarksed ] and [ fig : benchmarktemp ] we show the results of our simulation compared with the output of one of the codes tested by ivezi et al .",
    "this code , called dusty , is publicly available and is described in ivezi & elitzur ( 1997 ) .",
    "we see that our monte carlo calculations reproduce both the correct temperature structure and sed .",
    "note the large errors at the longest and shortest wavelengths in the monte carlo calculations . at these wavelengths , the number of emerging packets is small , resulting in large errors ( the relative error in each flux bin equals @xmath81 , owing to the poisson sampling statistics inherent in monte carlo simulations ) .",
    "the excellent agreement of the comparisons shown in figures  2a and 2b ( the differences are smaller than the numerical error of the dusty calculations ) demonstrates the validity of our temperature correction procedure described in section  2 .",
    "now that we have verified our our basic radiative equilibrium algorithm , we can proceed to investigate the temperature structure and seds of other geometries . owing to the inherently three - dimension nature of monte carlo simulations ( even our 1-d spherically symmetric code internally tracks the photon packets in three dimensions ) ,",
    "our code is readily modified for arbitrary geometries .",
    "we now show the results of an application to axisymmetric circumstellar environments .",
    "for the purpose of this illustrative simulation , we adopt a stellar blackbody with @xmath82 , envelope inner radius @xmath83 , and a simple ellipsoidal parameterization for the circumstellar density .",
    "the isodensity contours are elliptical with @xmath84 being the ratio of the semi - major to semi - minor axis .",
    "the density is given by @xmath85 where @xmath86 is given by eq .",
    "( [ eq : rho0 ] ; @xmath87 case ) , @xmath88 is the polar angle , and the `` flattening factor '' @xmath89 note that the equatorial to polar density ratio at a given radius is @xmath90 .    as before ,",
    "we divide the circumstellar environment into cells with @xmath91 radial and @xmath92 latitudinal grid points .",
    "note that the envelope is symmetric about the equator , so we combine the cells below the equator with their counterparts above the equator .",
    "this is automatically accomplished by using @xmath93 for the latitudinal grid point coordinate .",
    "spacing the grid so that the radial and latitudinal optical depths are the same for each cell , we find @xmath94 with these cell coordinates , equation  ( [ eq : retemp ] ) for the temperature in cell @xmath95 becomes @xmath96                [ \\tan^{-1}(f\\mu_{j-1})-\\tan^{-1}(f\\mu_{j } ) ] } } \\ ; , \\ ] ] where @xmath97 is the number of packets absorbed in the cell , and we have chosen @xmath98  ( @xmath99-band ) for our equatorial radial optical depth parameter , @xmath100 .    for the dust opacity , we adopt a standard mrn interstellar grain mixture ( mathis , rumpl , & nordsieck 1977 ) , using optical constants from draine & lee ( 1984 ) .",
    "figure  [ fig : dustopac ] shows the opacity and albedo in graphical form . the data for this figure is available in tabular form from the dusty web site , http://www.pa.uky.edu/@xmath101moshe/dusty .",
    "note the prominent silicate absorption features at @xmath102 m and @xmath103 m .",
    "for the current demonstration , we assume that the scattering is isotropic , but we can easily accommodate any phase function , analytic or tabulated when calculating the emergent sed .    unlike the spherically symmetric benchmarks , the sed now depends on viewing angle ,",
    "so we must bin the escaping packets both in direction and frequency .",
    "since the envelope is axisymmetric , the observed flux only depends on the inclination angle , @xmath9 , of the envelope symmetry axis ( i.e. , the stellar rotation axis ) . to obtain approximately equal numbers of escaping packets",
    ", we choose @xmath104 direction bins , with equal solid angles , @xmath105 .",
    "the escaping directions ( inclination angles ) , @xmath106 , for these bins are given by @xmath107 where @xmath108 .",
    "in addition to the direction bins , we use the frequency bins given by eq .",
    "( [ eq : freqbins ] ) .",
    "now that we have specified both the direction and frequency bins , the observed flux is @xmath109 , where @xmath110 is the number of escaping packets in the @xmath111 bin .",
    "normalizing to the bolometric flux f gives the emergent sed , @xmath112    we now choose to investigate the seds produced by two density structures with different degrees of flattening .",
    "the first has a density ratio @xmath113 to represent a disk - like structure .",
    "the second has a density ratio @xmath114 , which is mildly oblate , representative of an infalling protostellar envelope . for each density structure , we perform optically thick ( in the mid - ir ) and optically thin calculations .",
    "the optically thick calculations have an equatorial @xmath99-band optical depth @xmath115 , while the optically thin calculations have @xmath116 . table  [ table : ellipsoidparms ] summarizes these density structures . for comparison , we also have performed calculations for @xmath87 spherically symmetric models containing the same total mass as our disk and envelope densities . keeping the same inner and outer radii ,",
    "the optical depth for the equivalent spherical model is @xmath117      figure  [ fig : disksed ] shows the incident stellar spectrum and the emergent sed as a function of viewing angle for the disk - like model , as well as the result of the equivalent spherically symmetric calculation . for both disk simulations ,",
    "when viewing the system pole - on , we are looking through optically thin circumstellar dust ( see table  [ table : ellipsoidparms ] ) and can see the star at optical wavelengths . in the ir , there is an excess arising from the circumstellar disk , which reprocesses the stellar radiation .",
    "note that , for pole - on viewing , we see the silicate features in emission , since the disk is optically thin in the vertical direction . as we go to higher viewing angles , the optical depth to the central star increases , and as a result",
    ", the star becomes more extincted in the optical region .",
    "note that at almost edge - on viewing , a `` shoulder '' appears around @xmath118 m for the optically thick case .",
    "this arises due to the dominant effects of scattering the stellar radiation at these wavelengths .",
    "these scattering shoulders are also present in the axisymmetric calculations presented by efstathiou & rowan - robinson ( 1991 ) , sonnhalter et al .",
    "( 1995 ) , menschikov & henning ( 1997 ) , and dalessio et al .",
    "( 1999 ) . at wavelengths",
    "longer than about @xmath118 m , the albedo begins to drop rapidly ( see fig .  [",
    "fig : dustopac ] ) , and the disk thermal emission begins to dominate , so the shoulder terminates . beyond @xmath119 m ,",
    "the envelope becomes optically thin , so the spectrum is independent of inclination and is dominated by the dust emission .",
    "the two dimensional temperature structure for the disk - like models is displayed in figure  4b .",
    "we see that at the inner edge of the envelope ( @xmath43 ) there is little variation of the temperature with latitude , while at large radii there is a clear latitudinal temperature gradient , with the dust in the denser equatorial regions being cooler than dust at high latitudes .    in the polar region ,",
    "the material is optically thin to the stellar radiation , so it heats up to the optically thin radiative equilibrium temperature .",
    "this temperature has a power law behavior , @xmath120 for dust opacity ( @xmath121 ) .",
    "as can be seen in figure  [ fig : disktemp ] , the polar temperature does indeed have a power law decrease with a slope of approximately @xmath122 .",
    "in contrast , the disk only displays this power law behavior at large radii . at the inner edge of the disk ,",
    "the disk sees the same mean ( stellar ) intensity as is present in the polar region ( @xmath123 , where @xmath124^{1/2}\\}$ ] is the dilution factor ) .",
    "consequently , the inner edge of the disk heats up to the optically thin radiative equilibrium temperature  the same as the polar temperature .",
    "however at larger radii , the opaque material in the inner regions of the disk shields the outer regions from direct heating by the stellar radiation .",
    "this shielding reduces the mean intensity ( @xmath125 ) . as a result ,",
    "the outer disk is only heated to a fraction of the optically thin radiative equilibrium temperature .",
    "thus the equatorial region is cooler than the polar region . eventually at large enough radii ,",
    "the disk becomes optically thin to the heating radiation . at that point",
    ", it sees a radially streaming radiation field from an effective photosphere that has a much lower temperature than the star . from that point",
    "outward , the disk temperature displays an optically thin power law decrease with a slope that parallels the polar temperature .",
    "the spherically symmetric calculation overestimates both the emergent flux and the disk temperature . in the optically thin limit ,",
    "the ir continuum is proportional to the mass of the circumstellar material , so one would expect that a spherically equivalent mass would reproduce the long wavelength spectrum .",
    "recall however that we can see the star at pole - on viewing angles .",
    "this implies that the disk does not reprocess the entire bolometric luminosity of the star .",
    "consequently , the ir excess is less than that in the spherical model .",
    "note that one can nonetheless reproduce the edge - on sed using a spherical model if we allow the density power law to depart from @xmath126 and change the size of the spherical envelope .",
    "this also was noted by sonnhalter et al .",
    "( 1997 ) , who found that they could fit the ir continuum of their disk models by changing the radial dependence of the circumstellar density and the outer radius for the same total envelope mass .",
    "the spectral energy distribution and temperature structure for the oblate envelope are shown in figures  [ fig : envelopesed ] and [ fig : envelopetemp ] . the optically thin envelope displays significant extinction of the star at all viewing angles .",
    "close to edge - on , scattering shoulders appear around @xmath118 m that are similar to those seen in the disk model ( fig .",
    "[ fig : disksed ] ) . finally , because the model is optically thin in the mid - ir , the silicate feature is always in emission , and the sed is independent of viewing angle for wavelengths longer than a few microns .    for the denser envelope ,",
    "the star is extremely faint at optical wavelengths . along with",
    "the increased extinction in the optical , the scattering shoulders are less prominent , due to the thermal emission by the envelope . in the mid - ir ,",
    "the envelope is optically thick edge - on and optically thin pole - on .",
    "consequently , the silicate features go from absorption to emission as the viewing angle changes from edge - on to pole - on .",
    "the general shape of the seds , which now peak in the mid - ir for all inclinations , are reminiscent of spectra from embedded ( class  i ) t  tauri stars , which are commonly modeled using flattened axisymmetric dusty envelopes ( e.g. , adams , lada , & shu 1987 ; kenyon , calvet , & hartmann 1993 ; menshchikov & henning 1997 ; dalessio , calvet , & hartmann 1997 ) . of these t  tauri simulations ,",
    "only efstathiou & rowan - robinson ( 1991 ) have performed an exact calculation for the sed and circumstellar temperature for the terebey , shu , & cassen ( 1984 ) collapse model .    the temperature structure for our envelope models ( fig .  [ fig : envelopetemp ] )",
    "is qualitatively similar to the temperature structure of the disk models ( fig .",
    "[ fig : disktemp ] ) .",
    "the temperature at the inner edge of the envelope is independent of latitude , while at larger radii the equatorial regions are cooler than the polar regions .",
    "the primary difference is that the latitudinal temperature gradient is not as extreme .",
    "finally , we note that the equivalent spherically symmetric model better reproduces the far ir spectrum of the envelope models than the disk models .",
    "this is because the envelope models reprocess the entire bolometric luminosity , while in disk models , some of the stellar luminosity escapes through the polar region .",
    "we have developed a temperature correction procedure for use in monte carlo radiation transfer codes .",
    "we have tested our method against other spherically symmetric benchmark codes and successfully matched their results . after verifying our method",
    ", we applied it to obtain sample temperature distributions and seds for 2-d axisymmetric disk - like models and mildly oblate envelopes .",
    "these simulations illustrate the important role envelope geometry can play when interpreting the seds of embedded sources .",
    "the primary limitation of our temperature correction procedure is that it only applies if the opacity is independent of temperature .",
    "this is not true for free - free opacity or hydrogen bound - free opacity , but it is true for dust opacity , which is the dominant opacity source in many astrophysical situations .",
    "the reason our method is limited to temperature - independent opacities is that two associated problems occur if the opacity varies when the cell s temperature changes .",
    "the first is that the cell will have absorbed either too many or too few of the previous packets passing through the cell .",
    "the second is the associated change in the interaction locations of the previous packets , which implies that the paths of the previous photon packets should have been different .",
    "these problems do not occur if the opacity is independent of temperature .",
    "lucy ( 1999 ) has proposed a slightly different method to calculate the equilibrium temperature . instead of sampling photon absorption",
    ", he directly samples the photon density ( equivalent to the mean intensity ) by summing the path length of all packets that pass through a cell .",
    "typically more packets pass through a cell than are absorbed in the cell , so this method potentially produces a more accurate measurement of the temperature for a given total number of packets , especially when the envelope is very optically thin .",
    "the disadvantage of his method is that it requires iteration to determine the envelope temperature . in principle",
    "one could partially combine both methods .",
    "first , run our simulation , adding pathlength counters to each cell . after running all packets , use the pathlength information to calculate a final temperature .",
    "this will provide a more accurate temperature that can be used to calculate the source function .",
    "after obtaining the source function for each cell , it is a simple matter to integrate the transfer equation to obtain the sed .",
    "another limitation of the monte carlo method is that it is not well suited to envelopes with very high optical depths ( @xmath127  1000 ) , unless there is an escape channel for the photons .",
    "for example , geometrically thin disks can be extremely optically thick in the radial direction but optically thin in the polar direction , providing an escape channel for the photons .",
    "similarly , dense envelopes can be very optically thick to the illumination source , but optically thin to the reprocessed radiation , which is a another escape channel . in the event no such escape channels exist",
    ", one must turn to other methods .",
    "we are currently investigating how to couple monte carlo simulation in the optically thinner regions with other methods in the optically thick interior .",
    "the focus of the present paper has been on the development and implementation of the temperature correction procedure . for this reason",
    ", we have made several simplifying assumptions regarding the circumstellar opacity and geometry .",
    "for example , we have assumed a single temperature for all dust grains regardless of their size and composition .",
    "this differs from other investigations where different types of grains can have different temperatures at the same spatial location ( e.g. , the spherically symmetric radiation transfer code developed by wolfire & cassinelli 1986 ) .",
    "similarly , we have not implemented a procedure to solve for the location of the dust destruction radius , which will be different for grains of differing size and composition .",
    "these issues are currently under investigation .    with the speed of today",
    "s computers , monte carlo radiation transfer simulations can be performed in a reasonably short time .",
    "the 2-d simulations presented in this paper employed @xmath128 packets , requiring about two hours of cpu time ; the spherically symmetric cases used @xmath129 packets , requiring about one minute .",
    "so for continuum transfer , monte carlo simulation is proving to be a very powerful technique for investigating arbitrary density structures and illuminations .",
    "we would like to thank barbara whitney and mrio magalhes for many discussions relating to this work .",
    "an anonymous referee also provided thoughtful comments which helped improved the clarity of our presentation .",
    "this work has been funded by nasa grants nag5 - 3248 , nag5 - 6039 , and nsf grant ast-9819928 ."
  ],
  "abstract_text": [
    "<S> we describe a general radiative equilibrium and temperature correction procedure for use in monte carlo radiation transfer codes with sources of temperature - independent opacity , such as astrophysical dust . </S>",
    "<S> the technique utilizes the fact that monte carlo simulations track individual photon packets , so we may easily determine where their energy is absorbed . </S>",
    "<S> when a packet is absorbed , it heats a particular cell within the envelope , raising its temperature . to enforce radiative equilibrium , </S>",
    "<S> the absorbed packet is immediately re - emitted . </S>",
    "<S> to correct the cell temperature , the frequency of the re - emitted packet is chosen so that it corrects the temperature of the spectrum previously emitted by the cell . </S>",
    "<S> the re - emitted packet then continues being scattered , absorbed , and re - emitted until it finally escapes from the envelope . </S>",
    "<S> as the simulation runs , the envelope heats up , and the emergent spectral energy distribution ( sed ) relaxes to its equilibrium value , _ without iteration_. this implies that the equilibrium temperature calculation requires no more computation time than the sed calculation of an equivalent pure scattering model with fixed temperature . </S>",
    "<S> in addition to avoiding iteration , our method conserves energy exactly , because all injected photon packets eventually escape . </S>",
    "<S> furthermore , individual packets transport energy across the entire system because they are never destroyed . </S>",
    "<S> this long - range communication , coupled with the lack of iteration , implies that our method does not suffer the convergence problems commonly associated with @xmath0-iteration . to verify our temperature correction procedure </S>",
    "<S> , we compare our results to standard benchmark tests , and finally we present the results of simulations for two - dimensional axisymmetric density structures . </S>"
  ]
}