{
  "article_text": [
    "the precise meaning of velocity excitations has recently received renewed interest @xcite .",
    "this interest came out of comparative use of digital waveguide synthesis @xcite and finite differencing methods @xcite .",
    "this comparison has revealed a number of related subtle difficulties that were nt overtly taken into account in these comparisons .",
    "for details see @xcite .",
    "the current paper addresses excitation mechanisms for the purpose of velocity excitations directly and by example . while basic notions have long been established @xcite defined algorithms and functional properties havent been discussed yet .    specifically comparisons and notions of equivalence",
    "usually do nt discuss excitations and their specific implementations .",
    "here we discuss three basic methods which relate to prior published non - algorithmic suggestions and unpublished common wisdom in the field .",
    "overall , published discussions of integration algorithms in practice are rather rare . within the field",
    "the two sources which are most explicit about velocity excitations to waveguides are smith ( * ? ? ?",
    "* or comparable sources by the same author ) and bank s thesis @xcite",
    ".    we will in turn discuss the cases of the infinite string , the string with fixed boundary conditions , the string with open boundary conditions , behavior with respect to loop filters , and computational cost for all three models .",
    "we will always use the continuous case as comparative reference .",
    "then we will discuss interpretive issues with localized interpretation@xcite .",
    "physically correct behaviors have been discussed by the author@xcite .",
    "related examples have been derived , some rederived , recently by smith@xcite using a novel state - space transformation .",
    "there are two related ways to derive the following algorithm . on",
    "is to consider a discretization of the fundamental solution ( equation ( 9 ) of the fundamental solution@xcite ) . the other is to find a discrete implementation of the continuous situation as described by smith , citing morse@xcite .",
    "the latter will assume an arbitrary excitation distribution over which one can integrate .",
    "the first assumes impulsive excitations .",
    "however any arbitrary excitation distribution can be seen as the sum of time - shifted impulses , hence these two are closely related .",
    "the first variant of the algorithm reads as follows : rescale the impulse@xcite . add the impulse to all taps left of the excitation point to the right - going rail of the waveguide .",
    "subtract ( or add with an inverted sign ) to all the taps left of the excitation point to the left - going rail of the waveguide .",
    "repeat for all excitation positions and impulses at the current time - step .",
    "the second variant of the algorithm reads : rescale the distribution@xcite .",
    "starting at the right - most position of the string @xmath0 , integrate rescaled excitation distribution to position @xmath1 and add the result to the right - going rail and subtract the result from the left - going rail .",
    "using either of these algorithms we get for a center excitation ( compare with @xcite , using smith s notation @xcite ) :    @xmath2    @xmath3    @xmath4    the upper two rows are right- and left - going traveling - wave components . by convention , and following smith@xcite , the upper rail will move right and the lower rail will move left .",
    "the bottom row is their sum which is the total displacement .",
    "the lines marks the excitation point .    if we observe that we get the correct picture@xcite .",
    "we can even revert the direction of propagation and get the correct time - asymmetric case of a spreading square pulse with negative sign ( compare ( * ? ? ? * eq .",
    "( 47 ) ) ) .",
    "as this solution comes about as the difference of two heaviside step - functions , i ll call it the _ heaviside integration _ method for waveguides for the unbounded string .",
    "we shall see that it readily extends to the bounded case .",
    "hence this is one way of loading a waveguide that is physically accurate ( throughout this paper `` physical '' or `` physically accurate '' will mean , `` comparable results to the continuous solution of the wave equation '' ) .",
    "very few papers discuss velocity excitations explicitly .",
    "bank @xcite is an exception .",
    "he employs what i will call `` input - side integration '' .",
    "the idea is to integrate a velocity input before feeding it into a waveguide to arrive at a velocity excitation . a procedure that is suggested by the integral relationship of the two @xcite .",
    "if we interpret the waveguide to be a spatial discretization of the string with both rails sharing the same spatial position and we excite at this spatial point , we get the following result to an impulsive excitation :    @xmath5    @xmath6    @xmath7    we see a peak at the excitation point that does nt exist in the correct simulation discussed earlier and the continuous simulation .",
    "it s called _",
    "bank s anomaly _",
    "after balazs bank who was the first to point it out@xcite .",
    "this anomaly specifically appears at the point of excitation , which is exactly how bank found it .",
    "one can show that it also appears at the center - symmetric position on the string due to constructive interference .",
    "a non - linear hammer coupling needs to know the local displacement .",
    "a question remains to answered , which is whether the anomaly disappears when the excitation is completed .",
    "but we see an immediate way to resolve it .",
    "if the excitation point is between spatial sampling points , the anomaly disappears .",
    "hence we can not naively chose excitations on the spatial sampling point without taking the anomaly into account .",
    "see bank for a number of possible resolutions @xcite .",
    "these yet lack a clear physical interpretation . _",
    "bank anomaly _ points at the difficulty of spatial representation of excitation points , a topic yet to be explored in detail .",
    "i will not attempt to address it here .    to get the correct time - asymmetric pattern upon inverting the direction of the reals , we need to invert the signs of the excitation .",
    "finally one can consider `` output - side integration '' .",
    "here we integrate the sum of rails carrying velocity waves to get one accumulated displacement representation .",
    "the following diagram contains a fourth row , which contains the integration of the sum above it .",
    "@xmath8    @xmath9    @xmath10    hence we see that input - side and output - side integrations behave comparably .",
    "input - side integration requires only one integrator whereas the output - side case requires one for each spatial point .",
    "if a read - out point is local , then this can however also reduced to one integrator .",
    "we too see that bank s anomaly persists for excitations on a spatial point .",
    "it can be resolved by subtracting half the excitation from the integrator at the excitation point at the moment of excitation .",
    "the output - side integration also suffers from the numerical weaknesses of non - leaky integrators [ draft note : need discussion of leaky versus non - leaky integrators .",
    "see@xcite . ] . in the input - side case",
    "this problem is contained .",
    "this we will discuss when introducing boundary conditions .",
    "these two approaches have , however a crucial difference .",
    "the _ content of the traveling waves differ _ and hence in general the _ filters in the loop differ _ if they wants to achieve the same final result .",
    "after all in one case the filter will see impulses as input whereas in the other case it will be step functions .",
    "a number of hybrid approaches have been proposed .",
    "i will not attempt to discuss them here , as the goal is the understand velocity excitations in a purely waveguide setting .",
    "see for example @xcite .",
    "next we will introduce boundary conditions .",
    "this raises another question .",
    "how do the respective approaches to integration compare with respect to boundary conditions .",
    "first we refer to @xcite for the ground truth .",
    "the solution is periodically extended at boundaries which create mirror images of the solution ( hence the name `` method of images '' in the theory of partial differential equations @xcite ) . the image is so chosen as to satisfy the boundary condition .    in the case of a string with fixed ends ( dirichlet boundary conditions )",
    "it is well - known that for displacement waves the boundary inverts the sign , hence the image is sign - inverted with respect to the original .",
    "see figure 3 in @xcite for a center excitation .",
    "if the excitation is off - center we get a parallelogram with maximum width less than the length of the string . in either case",
    "there are three possible states : unit positive , unit negative and zero extension .",
    "the three states alternate with a zero extension state always between different sign unit extension ones .",
    "[ draft note : add figure for off - center case , comparable to figure 3 in @xcite to illustrate this . ]    also we observe that the transition between the vanishing of negative to positive extension looks like the discrete case illustrated in eq .",
    "( 47 ) of @xcite and hence corresponds to the case also observed under time - reversal for the heaviside integration method .    in the case of a string with open ends ( neumann boundary conditions )",
    "the displacement waves do not invert sign at the boundary . here",
    "we get a linear accumulation with every reflection .",
    "the geometric picture is the same as the dirichlet case , except that former zero extension states have even increasing accumulation , and the other states for odd increasing accumulation .",
    "see also @xcite for a formal derivation of this property .",
    "inverting boundary conditions should create the right image of traveling waves .",
    "we will thus use these conditions and observe the various methods .      these are the respective results of the heaviside integrator for time steps equivalent to half a string length .",
    "the diagram is as before except that vertical lines at each side denote the boundary .",
    "the excitation is at the midpoint :    @xmath11    @xmath12    @xmath13    @xmath14    observe that the pattern repeats and matches the continuous case .",
    "the off - center case can readily be plugged in for similar results .",
    "the excitation is placed in the middle of the string and constitutes loading the result of a non - leaky integrator fed by an impulse to equal parts left and right of the excitation - point into the respective traveling waves .",
    "@xmath15    @xmath16    @xmath17    @xmath18    @xmath19    observe that integration never stopped going through the full period .",
    "however if integration is stopped at any point the pattern will be inconsistent with the continuous case .",
    "also we see that after a full period the integration still needs to continue , as we have returned to the original state .",
    "hence there is no finite - length loading using the input - side excitation method .",
    "again , off - center excitation follow the same pattern without major differences",
    ".      same excitation as before .",
    "@xmath20    @xmath21    @xmath22    @xmath23    @xmath24    hence we see that the output - side integration yields the correct pattern .",
    "the integration continues indefinitely by definition .",
    "however compared to the input - side integrator we observe , that non - trivial addition ( adding zero ) in the integrator happen twice per period for one impulsive excitation , whereas the integrator on the input side only needs to store the impulse and hence has no further non - trivial additions after its initial loading .",
    "this means that under sparse input conditions , _ input - side integration is numerically favorable_. more precisely , in the worst case an output - side integrator will see indefinite non - trivial additions at every time - step even for excitations of a maximum length of twice the string .",
    "input - side integrators will see non - trivial additions only at every time - step when the excitation changes .",
    "if the excitation is indefinitely non - trivial , the two methods are comparable with respect to addition inaccuracies .",
    "output - side integration for lossless strings is impractical because any numerical error in the addition will accumulate , though only linearly , as the error is not fed back into the waveguide iteration .",
    "input - side integrators will feed numerical errors into the string , yet again only linearly , as the content of the waveguide is not feed back into the integrator .",
    "this changes in case of non - linear coupling mechanisms and additional care must be taken .",
    "next we discuss integration methods for strings with loose ends .",
    "it is well known that this corresponds to reflections without sign inversion at the boundary for displacement waves@xcite .",
    "these are the respective results of the heaviside integrator for time steps equivalent to half a string length .",
    "the excitation is at the midpoint :    @xmath11    @xmath25    @xmath26    @xmath27    hence we see that the heaviside integration does not yield the correct accumulation of displacement as is seen in the continuous case @xcite .",
    "why this simulation breaks down , remains to be explored .",
    "the excitation is placed in the middle of the string and constitutes loading the result of a non - leaky integrator fed by an impulse to equal parts left and right of the excitation - point into the respective traveling waves .",
    "@xmath15    @xmath16    @xmath28    @xmath29    @xmath30    observe that integration never stopped going through the full period and again needs to continue .",
    "we observe the correct accumulation of linear displacement @xcite .",
    "same excitation as before .",
    "@xmath20    @xmath21    @xmath31    @xmath32    @xmath33    hence we see that the output - side integration yields the correct pattern@xcite .",
    "the integration continues indefinitely by definition .",
    "finally i want to discuss the impact of filters , in particular the most basic case of linear damping filters , corresponding to a gain multiplication in the loop , on the schemes discussed .",
    "it is easy to see that the heaviside integration method is well - behaved with respect to such loop filter .",
    "all the data is present and at least linear damping will dissipate all information without trouble . the impact of phase delay and its relationship to physically observable effects on the waveform on the string is more complicated and should be investigated separately .",
    "the same in fact holds for non - integrating simulation , where the exact relationship between phase delay and physically correct wave form is usually phenomenologically treated .",
    "the output - side integration case is troubled by a linear gain loop filter .",
    "amplitude in the waveguide is dissipated , but prior states in the output integrator may still have older higher amplitudes . hence subtracting",
    "them will leave an incorrect remainder in the integrator proportional to @xmath34 where @xmath35 is a positive gain factor less than 1 .",
    "a potential solution is to introduce a matched leak to the integrator .",
    "however , a precise match is critical to avoid numerical inaccuracies .",
    "the input - side integration case is difficult to damp with loop filters , as the integrator will indefinitely feed input into the loop .",
    "hence the filters needs to be matched at the input to avoid this problem .",
    "overall , of all the integration methods studied , only the heaviside integration method is numerically well - behaved , and easily adaptable to loop filters as customary in waveguide synthesis .",
    "however it can not be used for a neumann simulation in its current form .",
    "the other methods have to be handled with care for they use non - leaky integrators , which are numerically unstable .",
    "the computational cost of the heaviside integration method is dependent on the excitation position .",
    "if the excitation position is at the far end of the string the maximum integration length of twice the string length @xmath36 ( once for the each rail ) is reached . if a choice of rail direction is permissible in the particular implementation , this can be reduced to one string length as the positive rail is chosen to correspond to the shorter side of the string .",
    "this integration has to be performed per impulsive velocity excitation @xmath37 .",
    "hence we get an overall computational complexity @xmath38 and if @xmath36 is treated as a constant @xmath39 .",
    "this is independent and in addition to the complexity of the waveguide iteration .",
    "we denote by @xmath40 the complexity of the waveguide computation accumulated over time steps .",
    "hence we get the total complexity of @xmath41 .",
    "the computational cost of input - side integration is one non - trivial loading per time step of the waveguide iteration .",
    "additionally a constant amount of operations are necessary for changes in the integrator on non - trivial input .",
    "hence the complexity is @xmath42 .",
    "the computational cost of output - side integration depends on the spatial distribution of the integration .",
    "typically only one observation point is of interest .",
    "then one integration per time step is necessary , independent of the output .",
    "the complexity is thus @xmath40 .",
    "if the full length of the string is required this becomes @xmath43 .",
    "we observe that the local , output - side integration is computationally most efficient , while numerically least desirable .",
    "the heaviside integrator is never cheaper than the input - side integrator , the extra cost depending on the length of the string and the position of the excitation .",
    "yet this is bought at desirable numerical properties and easy of use .",
    "it is a repeated belief that traveling velocity waves can be calculated from displacement waves by calculating their difference instead of their sum @xcite .",
    "it is considered a form of localized velocity excitation .",
    "difficulties with this belief has in essence already been addressed by the author elsewhere@xcite . here",
    "i would like to discuss this difficulty based on the given examples .",
    "assume that one wants to simulate a local velocity impulse and it s effect on displacement .",
    "using the above prescription , one might implement the following algorithm : [ draft note : needs introduction to notation .",
    "this relates to @xcite ] @xmath44 and @xmath45 , which is the difference of the standard displacement impulse @xmath44 and @xmath46 , ignoring potential needs for rescaling .",
    "initially there is no displacement in accordance with expectations for a velocity excitation .",
    "however , as time evolves on sees an isolated negative impulse traveling left and an isolated positive impulse traveling right ( see also eq .",
    "( 45 ) @xcite ) .",
    "however if we excite the lossless wave equation with a velocity impulse , we get a different picture .",
    "we get a spreading square pulse @xcite",
    ".    clearly the simple use of the relationship between displacement and velocity waves in waveguides gives an incorrect result .",
    "the interpretation of difference of displacement waves can also be seen in the simulations provided here .",
    "observe equations ( [ eq : h1]-[eq : h3 ] ) .",
    "we see that these pictures do not violate the naive interpretation of the relation of velocity to displacement waves .",
    "indeed we have zero displacement everywhere and the data present make the displacement zero by using the difference .",
    "however , it does give us a clue as to the difficulty in using the interpretation that lead us to the naive approach in the first place .",
    "if we accept that the difference between rails gives velocity , and we observe that a step function has been loaded into the waveguide , we have to conclude that the waveguide contains an semi - infinitely extended velocity . rather than the string moving upward on the whole of the semi - infinite half - line , it starts to spread only from the initial excitation point .",
    "clearly there is a difficulty in using the naive interpretation .",
    "clearly the difference between the two traveling wave rails can not be velocity .",
    "there is another reason for this , which is dimensionality .",
    "the sum and the difference of two variable of the same dimensionality will stay of that dimensionality .",
    "the sum and difference of displacement stays a displacement .",
    "so one has to not only take the difference to get displacement waves , one has to also integrate inertial velocities to make sure they have the correct dimensionality .",
    "this integration creates the step functions that we observe above .",
    "this is indeed peculiar , as step functions are non - zero out into infinity , hence are non - local .",
    "it has in fact been pointed out that variables in waveguides in some constellations have this non - local property@xcite .",
    "the string , like any mechanical system , requires displacement and velocity for full specification @xcite so we observe that one of them has a non - local property when compared to the other .    hence `` localized velocity excitations '' should be considered a displacement excitation in terms of dimensionality of the quantities involved .",
    "it also shares the time - symmetric properties of displacement excitations ( see eq . ( 49 ) in @xcite ) .",
    "this indicates that one can in fact not so readily go from displacement to velocity .",
    "one is non - local to the other and the conversion is not only difference but also integration or differentiation , see @xcite .",
    "we discussed three integration method for velocity excitations in displacement waveguide simulations .",
    "they differ in terms of numerical properties , relation to loop filters , computational cost and generality . for most situations",
    "the heaviside integration algorithm is most desirable , except for strings with loose ends , when this methods is incorrect . of the remaining methods ,",
    "input - side integration is generally more desirable , than output side integration , for numerical reasons and for the impact on loop filters .",
    "localized velocity excitations will generally yields results different from the wave equation .",
    "loop filters not designed with the integrating behavior of displacement waves in mind , may inaccurately model the desired behavior .",
    "hence sufficient care must be taken .",
    "it is worthwhile to note , that the excitation algorithms presented here do nt constitute a complete excitation description with respect to the wave equation . in general",
    "both displacement and velocity waves are present at the same time and hence excitations of the both types can occur in any linear mixture@xcite .",
    "i am grateful for discussions with matti karjalainen , cumhur erkut and for comments of two anonymous referees of an earlier manuscript in review@xcite which all contributed to my thinking on the subject of this manuscript .",
    "g. essl , unpublished manuscript .",
    "preprint http://arxiv.org/abs/physics/0401065 .",
    "revised version of this manuscript currently under review for publication .",
    "( unpublished ) .",
    "j.  o. smith , unpublished manuscript .",
    "preprint http://arxiv.org/abs/physics/0407032 ( unpublished )",
    ". j.  o. smith , `` acoustic modeling using digital waveguides , '' in _ musical signal processing _ , edited by c. roads , s.  t. pope , a. piccialli , and g. de  poli ( swets , lisse , netherlands , 1997 ) , chap .  7 , pp .",
    "221263 . w.  f. ames , _ numerical methods for partial differential equations _ , 3 ed .",
    "( academic press , san diego , 1992 ) . b. bank , `` physics - based sound synthesis of the piano , '' master s thesis , budapest university of technology and economics , 2000 , also available at helsinki university of technology , laboratory of acoustics and audio signal processing , report 54 . b. bank , `` nonlinear interaction in the digital waveguide with the application to piano sound synthesis , '' in _ proceedings of the international computer music conference ( icmc-2000 ) _ ( icma , berlin , germany , 2000 ) , pp .",
    ". m. karjalainen , `` mixed physical modeling : dwg + fdtd + wdf , '' in _ proceedings of the 2003 ieee workshop on applications of signal processing to audio and acoustics _ ( ieee , new paltz , new york , 2003 ) , pp .",
    ". m. karjalainen and c. erkut , `` digital waveguides vs. finite difference structures : equivalence and mixed modeling , '' manuscript , accepted for publication in eurasip j. appl . signal process .",
    "( unpublished ) .",
    "a. krishnaswamy and j.  o. smith , `` methods for simulating string collisions with rigid spatial obstacles , '' in _ proceedings of the 2003 ieee workshop on applications of signal processing to audio and acoustics _",
    "( ieee , new paltz , new york , 2003 ) , pp .",
    "m.  e. taylor , _ partial differential equations i : basic theory _ ( springer , new york , 1996 ) . k.  f. graff , _ wave motion in elastic solids _ ( dover , new york , 1991 )",
    ". j.  o. smith , `` digital waveguide modeling of musical instruments , '' draft of online manuscript , available at http://ccrma-www.stanford.edu/~jos/waveguide/ ( unpublished ) ."
  ],
  "abstract_text": [
    "<S> elementary integration methods for waveguides are compared . </S>",
    "<S> one using non - local loading rules based on heaviside step functions , one using input side integration and one using integration of the output of traveling velocity waves . </S>",
    "<S> we show that most approaches can be made consistent with the wave equation in principle , under proper circumstances . of all methods </S>",
    "<S> studied the heaviside method is the only method shown to not suffer from undesirable numerical difficulties and amendable to standard waveguide loop filtering practices , yet it gives incorrect results for neumann boundary conditions . </S>",
    "<S> we also discuss localized velocity excitations , time - limited input - side excitations and the relation of loop filters to wave variable type . </S>"
  ]
}