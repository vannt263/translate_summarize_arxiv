{
  "article_text": [
    "graph coloring problem is of fundamental importance in computer science . in the undirected setting",
    "the task is to color all the vertices of the graph to use as few colors as possible and in such a way that every color class induces an independent set .",
    "the _ chromatic number @xmath8 of the undirected graph @xmath9 _ is the minimum number of colors that can be used under these constraints . in",
    "the directed setting ( @xcite ) the coloring needs to be done in such a way that every color class induces an acyclic digraph .",
    "such a coloring is called an _",
    "acyclic coloring_. in particular , when a graph to color is a tournament then each color class is a transitive subset ( transitive subsets correspond in the tournament setting to the independent sets in the undirected one ) .",
    "the number of colors in the optimal acyclic coloring of a digraph @xmath10 is called the _ dichromatic number @xmath11 of the digraph @xmath10_. digraph colorings arise in several applications and are thoroughly used in kernel theory and tournament theory thus they attracted attention of many researchers .",
    "the coloring problem is np - hard but even the stronger statement is true : for every @xmath12 finding a @xmath13-approximation of the optimal coloring is np - hard . due to its hardness , many research efforts focused on finding good - quality colorings for several special classes of graphs .",
    "for instance , a scenario when a graph @xmath9 under consideration is @xmath3-colorable for some @xmath14 was analyzed .",
    "the best known coloring algorithms for that case give @xmath15-approximation , where @xmath16 .",
    "the best constants @xmath17 are obtained with the use of semidefinite programming ( @xcite ) .",
    "another important special class of graphs to consider in the coloring context are graphs defined by forbidden patterns .",
    "these appear in many places in graph theory .",
    "for instance , every graph with the topological ordering of vertices can be equivalently described as not having directed cycles and every transitive tournament - as not having directed triangles .",
    "a finite graph is planar if and only if it does not contain @xmath18 ( the complete graph on five vertices ) or @xmath19 ( complete bipartite graph on six vertices with two equal - length color classes ) as a minor .",
    "one of the deepest results in graph theory , the robertson - seymour theorem ( @xcite ) , states that every family of graphs ( not necessarily planar graphs ) that is closed under minors can be defined by a finite set of forbidden minors .",
    "these classes include : forests , pseudoforests , linear forests ( disjoint unions of path graphs ) , planar and outerplanar graphs , apex graphs , toroidal graphs , graphs that can be embedded on the two - dimensional manifold , graphs with bounded treewidth , pathwidth or branchwidth and many more .",
    "we should notice that not having a certain graph as a minor is a much more restrictive assumption than not having a certain graph @xmath20 as an induced subgraph .",
    "other examples include classes of graphs that can be colored with significantly fewer than @xmath21 colors .",
    "for instance , @xmath3-colorable graphs mentioned before do not have as induced subgraphs these graphs @xmath20 that have largest independent sets of size smaller than @xmath22 .",
    "thus all those classes can be described as not having some forbidden structures ( either induced subgraphs in the undirected scenario or subdigraphs in the directed setting ) .",
    "one of these classes of graphs is of particular interest .",
    "those are @xmath1-free graphs , where @xmath1 is an undirected path of @xmath3 vertices .",
    "not much is known for structural properties of @xmath1-free graphs for @xmath23 . in particular",
    ", it is an open question whether finding the largest independent set is np - hard if the class is defined by a forbidden path @xmath1 and @xmath24 .",
    "coloring @xmath1-free graphs for @xmath23 is known to be np - hard .",
    "similarly , no nontrivial approximation algorithms for coloring @xmath1-free graphs are known for @xmath24 .",
    "thus the question whether there exists a @xmath15-approximation algorithm ( as it is the case for @xmath3-colorable graphs ) is open . the completely analogous problem can be considered in the directed setting .",
    "in other words , one can ask for an optimal acyclic coloring of @xmath1-free tournaments , where this time @xmath1 stands for the directed path tournament , i.e. a tournament with the ordering of vertices @xmath25 under which the backward edges are exactly of the form @xmath26 . like in the undirected case , the structural theorem of @xmath1-free directed graphs is not known . in particular , the question whether the acyclic coloring problem is np - hard for this class of graphs is open .",
    "it is striking though that the @xmath5-approximation algorithm exists and this is one of our main results in this paper .",
    "in fact we show a stronger result .",
    "we give an algorithm that constructs in the @xmath1-free tournament a transitive set of order @xmath4 .",
    "we show that our results are tight up to the @xmath6-factor in the following sense : there exist infinite families of @xmath1-free tournaments with largest transitive subsets of order at most @xmath7 . as a corollary",
    ", we give tight asymptotic results regarding the so - called _ erds - hajnal coefficients _ for directed paths .",
    "the coefficients come from the celebrated erds - hajnal conjecture - one of the most fundamental unsolved problems in modern ramsey graph theory .",
    "our algorithm for finding big transitive subsets is quadratic in the size of the input thus optimal ( since the input as a tournament is of size @xmath27 ) and easy to implement .",
    "it leads straightforwardly to the subcubic coloring algorithm .",
    "let us discuss briefly some known results regarding @xmath1-free graphs .",
    "graph coloring problem is known to be solvable in the polynomial time for @xmath1-free graphs , where @xmath28 ( @xcite ) .",
    "we already mentioned that it was proven to be np - hard for @xmath23 ( @xcite ) . a related problem whether a given @xmath29-free graph is @xmath3-colorable ( and finding the coloring if the @xmath3-coloring exists )",
    "was considered in several papers . in @xcite",
    "it was proven that the @xmath30-colorability question for @xmath31-free graphs can be answered in the polynomial time .",
    "in fact @xmath30-coloring question can be answered in the polynomial time for a more general class of @xmath32-free graphs ( @xcite ) . a polynomial algorithm answering a question whether a @xmath31-free graph can be @xmath3-colored ( and constructing the coloring if this is the case ) for arbitrary @xmath14 was given in @xcite . very recently a polynomial algorithm for constructing maximum independent set in @xmath31-free graphs was proposed ( @xcite ) .",
    "no nontrivial approximation algorithms for the coloring problem of @xmath1-free graphs for general @xmath3 were proposed .    in the directed setting it was recently proven ( @xcite ) that for every @xmath14 all @xmath1-free tournaments have polynomial - size transitive subsets , i.e transitive subsets of size @xmath33 for some @xmath12 .",
    "coefficients @xmath34 were however obtained with the use of the regularity lemma , an inherent ingredient of the entire approach , thus applied methods did not lead to any practically interesting algorithmic results . for paths and in fact",
    "all prime tournaments those coefficients were proven to be of order at most @xmath35 ( @xcite ) in the worst - case scenarios . that led to the substantial gap between best known upper and lower bounds ( the latter being only inversely proportional to the tower function from the regularity lemma ) .",
    "we practically get rid of that gap in this paper .",
    "other results regarding ( pseudo)transitive subtournaments of polynomial sizes in @xmath20-free directed graphs can be found in : @xcite , @xcite , @xcite , @xcite , @xcite , @xcite , @xcite , @xcite and @xcite .",
    "before stating formally our results , we will introduce a few important definitions used throughout this article .",
    "all graphs in this paper are finite and simple .",
    "let @xmath9 be a graph .",
    "the vertex set of @xmath9 is denoted by @xmath36 , and the edge set by @xmath37 .",
    "we write @xmath38 to mean @xmath39 .",
    "we refer to @xmath38 as the _ order _ of @xmath9 .",
    "clique _ in an undirected graph @xmath9 is a subset of @xmath36 all of whose elements are pairwise adjacent , and an _ independent set _ in @xmath9 is a subset of @xmath36 all of whose elements are pairwise non - adjacent .",
    "we say that a graph @xmath9 is @xmath20-free if it does not have @xmath20 as an induced subgraph .",
    "a _ tournament _ is a directed graph @xmath2 , where for every two vertices @xmath40 exactly one of @xmath41 , @xmath42 is an edge of @xmath2 ( that is , a directed edge ) . if @xmath43 , we say that @xmath44 is _ adjacent to _ @xmath45 , and that @xmath45 is _ adjacent from _ @xmath44 .",
    "equivalently , @xmath45 is an _",
    "outneighbor _ of @xmath44 and @xmath44 is an _",
    "inneighbor _ of @xmath45 . for a given @xmath46",
    "we denote by @xmath47 a subtournament of @xmath2 induced by a vertex set @xmath48 . for a graph @xmath9 and a subset @xmath49",
    "we denote by @xmath50 a graph obtained from @xmath9 by deleting @xmath51 and all edges of @xmath9 that are : adjacent to a vertex @xmath52 in the undirected setting and : adjacent to or from a vertex @xmath52 in the directed setting .",
    "a tournament is _ transitive _ if it contains no directed cycle ( equivalently , no directed cycle of length three ) .",
    "a set is _ transitive _ if it induces a transitive subtournament .",
    "a _ homogeneous set _ in a graph @xmath9 is a subset @xmath53 such that if a vertex @xmath54 is adjacent to a vertex of @xmath51 then it is adjacent to all the vertices of @xmath51 .",
    "a graph @xmath9 is _ prime _ if all its homogeneous sets other than @xmath36 are singletons . for two disjoint subsets of the vertices @xmath55 of a graph @xmath9",
    "we say that @xmath56 if every vertex of @xmath48 is adjacent to every vertex of @xmath57 .",
    "( last three definitions are valid in both undirected and directed setting ) .    a _ directed path @xmath1 _ ( or simply _ a path @xmath1",
    "_ if it is clear from the context that a graph under consideration is a tournament ) is a tournament with vertex set @xmath58 and an ordering of vertices @xmath25 under which the backward edges are exactly of the form : @xmath26 for @xmath59 .",
    "we call this ordering a _ path ordering_. if @xmath25 is a path ordering of @xmath1 , then we call an ordering @xmath60 a _ matching ordering _ since under this ordering a graph of backward edges is a matching .",
    "let @xmath61 be a sequence of backward edges of this ordering , where the backward edges are ordered in @xmath62 according to the location of their left ends in the matching ordering of @xmath1 . for the @xmath63 backward edge @xmath64 we denote by @xmath65 the location in the matching ordering of @xmath1 of the left end of @xmath64 and by @xmath66 the location in the matching ordering of @xmath1 of the right end of @xmath64 ( @xmath67 ) .",
    "notice that if @xmath68 then a directed path @xmath1 is prime .",
    "we are ready to state our results .",
    "our main result is as follows .",
    "[ alg - theorem1 ] there exists a universal constant @xmath69 such that for any @xmath14 there is an algorithm finding a transitive set of order @xmath4 in the @xmath1-free @xmath0-vertex tournament in @xmath70 time .    as a simple corollary we obtain :    [ alg - theorem2 ] there exists a universal constant @xmath69 such that for any @xmath14 there is an algorithm constructing acyclic coloring of the @xmath1-free @xmath0-vertex tournament using only @xmath71 colors",
    "furthermore , the algorithm has running time @xmath72 .",
    "this result immediately implies the following :    [ thm - dichromatic ] there exists a universal constant @xmath69 such that the dichromatic number of the @xmath1-free @xmath0-vertex tournament satisfies : @xmath73    it also serves as the @xmath5-approximation algorithm for the optimal acyclic coloring of the @xmath1-free @xmath0-vertex graph .",
    "let us switch now to the conjecture of erds and hajnal .",
    "the conjecture ( @xcite ) says that :    [ erdos - hajnal - conjecture - undirected ] for every undirected graph @xmath20 there exists a constant @xmath74 such that the following holds : every @xmath20-free graph @xmath9 contains a clique or a stable set of size at least @xmath75 .    in its directed equivalent version ( @xcite ) undirected graphs",
    "are replaced by tournaments and cliques / stable sets by transitive subtournaments :    [ erdos - hajnal - conjecture - directed ] for every tournament @xmath20 there exists a constant @xmath74 such that the following holds : every @xmath20-free tournament @xmath2 contains a transitive subtournament of order at least @xmath76 .",
    "the coefficient @xmath77 from the statement of the conjecture is called _ the erds - hajnal coefficient_. the conjecture was proven so far only for some very special forbidden patterns .",
    "those of them that are prime are particularly important since if the conjecture is true for all prime graphs then it is true in general ( @xcite ) .",
    "there are no prime undirected graphs of order at least six for which the conjecture is known to be true and for a long time that was the case also in the directed setting .",
    "very recently an infinite family of prime tournaments satisfying the conjecture was constructed ( @xcite ) . among them",
    "were directed paths @xmath1 .",
    "the proof of the conjecture for them provided only purely theoretical guarantees since all lower bounds for @xmath77 were obtained by the regularity lemma .",
    "our algorithm gives lower bounds on the erds - hajnal coefficient that are very close to the best upper bounds since we have the following ( @xcite ) :    [ uppertheorem ] there exists a constant @xmath69 such that every prime tournament @xmath20 satisfies : @xmath78    combining this result with the lower bounds produced by our algorithm , we obtain the following result regarding the asymptotic behaviour of the erds - hajnal coefficients of directed paths @xmath1 :    [ simple - theorem ] the erds - hajnal coefficient of the directed path @xmath1 satisfies : @xmath79    so far such precise asymptotics were known only for one infinite family of prime tournaments , so - called _ stars _",
    "( see : @xcite for a definition of a star ) .",
    "our results make the family of directed paths the second class of prime tournaments for which these asymptotics are known .    in the next section",
    "we present algorithms mentioned in theorem [ alg - theorem1 ] and theorem [ alg - theorem2 ] . in the following section",
    "we prove that both algorithms have properties described in these theorems . in the last section",
    "we summarize our results and briefly discuss possible extensions of the presented techniques .",
    "all considered logarithms are of base two from now on . without loss of generality",
    "we will assume that @xmath80 for some @xmath81 .",
    "first we will present an algorithm _ findtrans _ that finds in the @xmath1-free @xmath0-vertex tournament a transitive subset of size @xmath4 for some universal constant @xmath69 ( an exact value of this constant may be calculated , but we will not focus on it in the paper ) . the acyclic coloring algorithm _ acycliccoloring _ is a simple application of the former .",
    "it runs _ findtrans _ to find the first color class , removes it from the tournament , runs _",
    "findtrans _ on the remaining tournament to find the second color class , etc .      before giving a description of the algorithm _ findtrans _ , we need to introduce a few more definition . for a tournament @xmath2 and two disjoint nonempty subsets @xmath82 we denote @xmath83 , where @xmath84 is the number of directed edges of @xmath2 going from @xmath48 to @xmath57 .",
    "the expression @xmath85 basically encodes directed density of edges from @xmath48 to @xmath57 .",
    "* input : * @xmath86 and @xmath87-sequence @xmath88 of length @xmath3 * output : * @xmath87-sequence @xmath89    we say that a sequence @xmath90 of pairwise disjoint subsets of @xmath91 is a _",
    "@xmath92-@xmath87-sequence of length @xmath93 _ if the following holds :    * @xmath94 for @xmath95 and * @xmath96 for @xmath97 .",
    "if the parameters @xmath17 , @xmath98 of the _ @xmath92-@xmath87-sequence _ are not important , we simply refer to it as an @xmath87-sequence .",
    "we say that a @xmath92-@xmath87-sequence @xmath90 of length @xmath93 is _ smooth _ if the following strenghtening of the second condition from the definition above holds :    * @xmath99 for @xmath100 , @xmath97 and , * @xmath101 for @xmath102 , @xmath97 .",
    "given an @xmath87-sequence @xmath103 , a vertex @xmath104 and @xmath105 we denote by @xmath106 :    * a set of all outneighbors of @xmath45 from @xmath107 if @xmath108 and , * a set of all inneighbors of @xmath45 from @xmath107 if @xmath109 .",
    "for an @xmath87-sequence @xmath110 we denote : @xmath111 .",
    "let @xmath112 and @xmath113 be two disjoint @xmath87-sequences .",
    "we denote by @xmath114 the @xmath87-sequence @xmath115 . for a set @xmath116 and @xmath117",
    "we denote by @xmath118 the truncated version of @xmath116 obtained by taking arbitrarily its @xmath119 elements . for an @xmath87-sequence @xmath103",
    "we denote : @xmath120 .",
    "if the order of the given @xmath1-free tournament is too small , the algorithm _ findtrans _ ( algorithm [ findtrans ] ) returns a trivial answer ( and it is easy to see that this gives good asymptotics on the coefficient @xmath34 ) .",
    "* input : * @xmath14 and @xmath1-free tournament @xmath2 * output : * transitive subset in @xmath91 of order @xmath121    otherwise , the algorithm uses two subprocedures : _ createsequence _ that constructs in the @xmath1-free tournament @xmath2 an @xmath87-sequence of length @xmath3 and _ makesmooth _ that uses that sequence to construct a smooth @xmath87-sequence of the same length .",
    "the @xmath122 procedure does not rely on the structural properties of the @xmath1-free tournaments , but just uses the fact that a tournament it operates on is @xmath20-free for some @xmath3-vertex forbidden pattern @xmath20 .",
    "we will discuss it in much detail later .",
    "the _ makesmooth _ procedure ( algorithm [ makesmooth ] ) is a standard method for getting rid of these vertices from the given @xmath87-sequence that have many less in / out - neighbors in some element of the @xmath87-sequence than the density condition would suggest .",
    "* input : * @xmath123 and @xmath1-free @xmath0-vertex tournament @xmath2 * output : * an @xmath87-sequence of length @xmath124 in @xmath2    let us assume now that a smooth @xmath87-sequence of length @xmath3 is given .",
    "the algorithm _ findtrans _ tries to reconstruct a directed path @xmath1 by looking for its @xmath63 vertex in the matching ordering of @xmath1 in the @xmath63 element of the @xmath87-sequence @xmath89 .",
    "this is conducted backward edge by backward edge in the matching ordering of @xmath1 .",
    "if the backward edge is not found then two linear - size subsets @xmath125 of two distinct elements from the original @xmath87-sequence such that @xmath126 is complete to @xmath127 are detected .",
    "otherwise an @xmath87-sequence is updated .",
    "the update is done in such a way that if in the new @xmath87-sequence the other backward edges of the matching ordering of @xmath1 are found then they can be combined with the edges that were already found to reconstruct a copy of @xmath1 . since a tournament @xmath2",
    "the algorithm is working on is @xmath1-free , at some point of its execution two subsets @xmath125 mentioned above with @xmath128 will be detected .",
    "when that happens , the algorithm is run recursively on the tournaments : @xmath47 and @xmath129 and later two transitive subsets found in these two recursive runs are merged .",
    "let us discuss now subprocedure _ createsequence _",
    "( algorithm [ createsequence ] ) that constructs an @xmath87-sequence of a specified length @xmath124 ( without loss of generality we will assume that @xmath130 for some @xmath81 ) .",
    "as mentioned before , the procedure can be applied for any forbidden pattern , not only @xmath1 .",
    "its main ingredient is called _ makedensepair _ and is responsible for constructing two disjoint linear sets @xmath131 in the @xmath1-free tournament such that the directed density @xmath85 is very close to one .",
    "* input : * a set @xmath132 such that @xmath133 induces a @xmath1-free tournament , a @xmath134-vertex tournament @xmath20 with @xmath135 and parameter @xmath0 * output : * a pair of disjoint sets @xmath136    the procedure _ createsequence _ acts as follows .",
    "first two linear sets @xmath131 of the @xmath1-free tournament and with @xmath137 for some @xmath138 are found with the use of the procedure _",
    "makedensepair_. if @xmath139 then @xmath136 is output and the procedure is ends .",
    "otherwise , in both @xmath48 and @xmath57 the @xmath87-sequences of length @xmath140 are constructed recursively .",
    "when the sequence is constructed , it is deleted from @xmath48 or @xmath57 and a new sequence is being constructed in the remaining set .",
    "this is repeated as long there are at least half of the vertices left in @xmath48 or @xmath57 .",
    "let @xmath141 denote the sets of the vertices of the @xmath87-sequences constructed in @xmath48 and let @xmath142 denote the sets of the vertices of the @xmath87-sequences constructed in @xmath57 .",
    "the algorithm is looking for sets @xmath143,@xmath144 such that @xmath145 .",
    "the way sets @xmath131 were constructed by _ makedensepair _ as well as simple density arguments ( see : the analysis of the algorithm ) imply that such sets do exist .",
    "thus even though in the formal description of _ createsequence _ we assume that the sets may not be found ( and then two arbitrary sets @xmath143 , @xmath144 ) are taken , this in fact will never happen .",
    "the @xmath87-sequence of length @xmath124 is output simply by combining two @xmath87-sequences of length @xmath140 corresponding to @xmath143 and @xmath144 .",
    "it remains to explain how the procedure _ makedensepair _ works ( algorithm [ makedensepair ] ) .",
    "the procedure is given a set of sets @xmath146 of linear size each , for some @xmath147 , a @xmath134-vertex tournament @xmath148 , and a parameter @xmath0 .",
    "parameter @xmath0 is the remembered size of the tournament which is an input of the _ createsequence _ procedure initializing the recursive runs of _",
    "notice that @xmath149 is @xmath20-free .",
    "the procedure tries to reconstruct @xmath20 in @xmath149 in such a way that @xmath150 is found in @xmath151 .",
    "it first verifies whether a good candidate for @xmath152 exists in @xmath153 .",
    "a good candidate should have substantial number of outneighbors in each @xmath151 such that @xmath154 is an edge in @xmath20 and a substantial number of inneighbors in each @xmath151 such that @xmath155 is an edge in @xmath20 .",
    "if such a vertex @xmath45 in @xmath153 is found then the remaining sets are modified accordingly and the algorithm tries to reconstruct @xmath156 in their modified versions .",
    "this is done by a recursive run of the procedure on the set of modified sets @xmath157 . since a tournament that the procedure operates on is @xmath20-free , at some recursive run no good candidate will be found .",
    "as we will see in the theoretical analysis , it will imply ( by pigeonhole principle ) the existence of two linear - size sets @xmath131 with density @xmath85 close to one .",
    "these sets will be output by the procedure .",
    "* input : * @xmath14 and @xmath1-free tournament @xmath2 * output : * an acyclic coloring of @xmath2 using @xmath158 colors    the use of parameter @xmath0 enables us to output two sets of the same desired size .",
    "this balanceness will play important role in the theoretical analysis of the procedure _ createsequence _ that uses _",
    "the acyclic coloring algorithm ( algorithm [ alg - color ] ) is a simple wrapper for the _ findtrans _ procedure .",
    "it runs this procedure several times to obtain the partitioning of the @xmath1- free tournament @xmath2 into transitive sets .",
    "each transitive set gets its own color and this coloring is as an acyclic coloring that is being output .",
    "to show that presented algorithms are correct we need to prove theorem [ alg - theorem1 ] and theorem [ alg - theorem2 ] .",
    "let us assume first that theorem [ alg - theorem1 ] is true . under this assumption",
    "it is easy to prove theorem [ alg - theorem2 ] .",
    "*  let @xmath159 , where @xmath3 is as in theorem [ alg - theorem1 ] .",
    "the algorithm [ alg - color ] keeps finding transitive subtournaments of order at least @xmath160 as long there are at least @xmath161 vertices left in the tournament . by the time the algorithm reaches the state with less than @xmath161 vertices remaining , at most @xmath162",
    "transitive subtournaments are found .",
    "then the algorithm is run on the remaining graph of less than @xmath161 vertices .",
    "the algorithm stops when there are no vertices left .",
    "when it happens all the vertices of the tournament are partitioned into transitive subsets .",
    "if we denote by @xmath163 the total number of the transitive subtournaments found then we have the following simple recurrence formula : @xmath164 , which immediately gives us : @xmath165 .",
    "thus we obtain desired approximation of the acyclic coloring problem .",
    "since finding each transitive subset takes quadratic time and at most @xmath162 transitive subsets are constructed , the total running time of the coloring algorithm is as stated in theorem [ alg - theorem2 ] .",
    "theorem [ alg - theorem1 ] is a result of the series of lemmas :    [ lemma1 ] let @xmath166",
    ". a run of algorithm _ makedensepair _ from _ createsequence _ outputs two disjoint subsets @xmath131 of the given @xmath0-vertex tournament such that @xmath137 and @xmath167 where : @xmath168 , provided that @xmath169 .",
    "the next lemma gives us the parameters of the @xmath87-sequence constructed by procedure _",
    "createsequence_.    [ lemma2 ]",
    "let @xmath166 .",
    "if @xmath170 then algorithm _ createsequence _ constructs a @xmath171-@xmath87-sequence of length @xmath124 in the given @xmath0-vertex tournament , where : @xmath172 , @xmath173 , @xmath174 for @xmath175 and @xmath176 . furthermore , each element of the constructed @xmath87-sequence is of the same size @xmath177 .",
    "the parameters of the smooth @xmath87-sequence produced by _ makesmooth _ from the input @xmath87-sequence are given in the next lemma :    [ lemma3 ] let @xmath166 .",
    "assume that the input to the algorithm @xmath178 is a @xmath179-@xmath87-sequence of length @xmath3 for some @xmath180 and @xmath181 .",
    "then algorithm @xmath178 from @xmath182 procedure constructs a smooth @xmath183-@xmath87-sequence , where : @xmath184 .",
    "the proof of theorem [ alg - theorem1 ] as well as the proofs of the above lemmas are given in the next subsection .",
    "we start with the following simple lemma .",
    "[ densitylemma ] let @xmath2 be a tournament .",
    "assume that for two disjoint subsets @xmath82 the following holds : @xmath137 for some @xmath185 .",
    "assume that @xmath186 , @xmath187 , @xmath188 , @xmath189 for some @xmath190 .",
    "then @xmath191 .    *",
    "*  let @xmath192 be the number of directed edges from @xmath57 to @xmath48 and let @xmath193 be the number of directed edges from @xmath194 to @xmath195 .",
    "we have : @xmath196 since @xmath137 .",
    "similarly : @xmath197 .",
    "assume by contradiction that @xmath198 .",
    "then , since @xmath188 , @xmath189 , we have : @xmath199 . since @xmath200 , we get : @xmath201 , contradiction .",
    "let us assume that lemmas : [ lemma2 ] and [ lemma3 ] from the main body of the paper are correct .",
    "we will first show how theorem [ alg - theorem1 ] is implied by them .",
    "then we will prove all three lemmas ( lemma [ lemma1 ] will be used to prove lemma [ lemma2 ] ) .",
    "the proof of theorem [ alg - theorem1 ] is given below .",
    "+ * proof .",
    "*   we will proceed by induction on the size of the @xmath1-free tournament @xmath2 .",
    "let @xmath202 , where @xmath203 is a small enough universal constant .",
    "let us consider first the case when @xmath204 , where @xmath205 is as in algorithm _",
    "findtrans_. in this setting @xmath206 is of the order @xmath207 for some universal constant @xmath208 so the output of the algorithm trivially satisfies conditions of theorem [ alg - theorem1 ] . now let us consider more interesting case when @xmath209 .",
    "notice then that the requirement from lemma [ lemma2 ] regarding the size of the input @xmath0-vertex @xmath1-free tournament is trivially satisfied .",
    "assuming that lemmas : [ lemma2 ] and [ lemma3 ] are true , we conclude that initially the @xmath87-sequence @xmath89 from _ findtrans _ is a smooth @xmath210-@xmath87-sequence , where : @xmath211 , @xmath184 , @xmath212 , @xmath173 and @xmath166 .",
    "now consider the for - loop in the algorithm .",
    "notice that it can not be the case that in each run of the loop an edge @xmath213 is found",
    ". indeed , assume otherwise and denote the set of edges found in all @xmath214 runs by @xmath215 .",
    "denote by @xmath216 this @xmath217 that satisfies : @xmath218 .",
    "similarly , denote by @xmath219 this @xmath217 that satisfies : @xmath220 .",
    "notice that the vertices @xmath221 induce a copy of @xmath1 and besides the ordering of @xmath222 induced by @xmath223 is a matching ordering under which the set of backward edges is exactly : @xmath215 .",
    "this is a straightforward conclusion from the way the @xmath87-sequence @xmath89 is updated . that however contradicts the fact that the tournament the algorithm operates on is @xmath1-free .",
    "thus we can assume that in some run of the main for - loop the algorithm recursively runs itself on @xmath224 and @xmath225 for some @xmath125 from the given @xmath87-sequence . notice that whenever a backward edge @xmath226 is found the size of each @xmath227 in the updated @xmath87-sequence decreases by at most @xmath228 .",
    "thus at every stage of the execution of the algorithm each @xmath227 is of order at least @xmath229 which is at least @xmath230 ( since @xmath231 ) .",
    "therefore when two recursive runs of the procedure _",
    "findtrans _ are conducted , each run operates on the tournament of size at least @xmath230 . by induction , a transitive tournament of order at least @xmath232 is produced .",
    "it remains to prove that under our choice of @xmath34 ( for @xmath203 small enough ) we have : @xmath233 , i.e @xmath234 . we leave it to the reader .",
    "let us comment now on the running time of the algorithm .",
    "first notice that procedure _",
    "makedensepair _ runs in quadratic time . throughout its execution",
    "it is calling itself at most @xmath3 times and the time it takes between any two recursive calls is clearly at most quadratic .",
    "this in particular implies that procedure _ createsequence _ also runs in quadratic time . indeed , throughout its execution at most @xmath235 calls of the procedure _",
    "makedensepair _ are conducted and its other operations take altogether at most quadratic time . furthermore ,",
    "algorithm _ makesmooth _ is clearly quadratic and besides a naive implementation of each run of the for - loop in the procedure _",
    "findtrans _ takes at most quadratic time . thus algorithm _ findtrans _",
    "has quadratic running time .",
    "it remains to prove lemmas : [ lemma1 ] , [ lemma2 ] , [ lemma3 ] .",
    "we start with lemma [ lemma3 ] .    * proof . *",
    "let @xmath88 be the input @xmath87-sequence .",
    "by lemma [ densitylemma ] we get : @xmath236 .",
    "thus for any @xmath237 we have : @xmath238 .",
    "this implies in particular that each updated @xmath227 is of size at least half the size of the original one .",
    "now take some @xmath239 and a vertex @xmath240 , where @xmath241 is the new version of @xmath227 after the update . by the definition of @xmath241",
    "we know that @xmath45 has at most @xmath242 inneighbors from @xmath107 .",
    "denote by @xmath243 the new version of @xmath107 after the update .",
    "then we can conclude that @xmath45 has at most @xmath244 inneighbors from @xmath243 .",
    "similar analysis can be conducted for @xmath245 . that completes the proof .",
    "now we prove lemma [ lemma2 ] assuming that lemma 1 is true .",
    "* proof . *  we proceed by induction on @xmath124 . for @xmath139 algorithm",
    "_ createsequence _ is reduced to procedure _ makedensepair _ thus the result follows by lemma [ lemma1 ] .",
    "let us assume now that @xmath175 .",
    "then , by induction and lemma [ lemma1 ] , each element of each @xmath87-sequence @xmath246 is of size at least @xmath247 and at most @xmath248 .",
    "similarly , each element of each @xmath87-sequence @xmath249 is of size at least @xmath247 and at most @xmath248 .",
    "in particular , the size of each element of an arbitrary @xmath250 is at most twice the size of each element of an arbitrary @xmath251 and vice versa : the size of each element of an arbitrary @xmath251 is at most twice the size of each element of an arbitrary @xmath251 . by lemma [ lemma1 ] , the directed density between initial sets @xmath48 and @xmath57 is at least @xmath252 .",
    "denote @xmath253 and @xmath254 , where : @xmath255 and @xmath256 are taken when both while - loops in the algorithm are completed .",
    "we trivially have : @xmath257 and @xmath258 .",
    "thus by lemma [ densitylemma ] , we obtain : @xmath259 . notice that @xmath260 .",
    "let us assume first that there do not exist @xmath261 such that @xmath262 .",
    "but then , by the above observation , we have : @xmath263 .",
    "thus @xmath264 , contradiction .",
    "therefore @xmath87-sequences @xmath265 such that @xmath266 will be found .",
    "notice that , by induction and lemma [ lemma1 ] all elements of @xmath267 are of the same size .",
    "similarly , all elements of @xmath268 are of the same size .",
    "thus , by our previous observations and lemma [ densitylemma ] , we can conclude that in the truncated version of the @xmath268-part of the output @xmath87-sequence the density between an element appearing earlier in the sequence and an element appearing later is at least @xmath269 .",
    "similarly , the directed density between an element of the final output that is from the @xmath267-part of the sequence and the one that is from the @xmath268-part of the sequence is at least @xmath270 .",
    "this leads us to the following recursive formula : @xmath271 for @xmath175 and @xmath176 .",
    "one can easily check that this recursion has a solution which is exactly of the form given in the statement of lemma [ lemma2 ] .",
    "furthermore , trivially each element of the output @xmath87-sequence is forced to be of order @xmath272 , which leads to the recursive formula on @xmath273 from the statement of lemma [ lemma2 ] .",
    "it remains to prove lemma [ lemma1 ] .",
    "* proof . *  notice first that output sets @xmath48 and @xmath57 are forced to be of the size given in the statement of lemma [ lemma1 ] .",
    "indeed , sets : @xmath274 and @xmath275 are of size @xmath119 each which is exactly @xmath276 for @xmath173 .",
    "the crucial observation is that the longest path in the tree of recursive calls of the procedure _ makedensepair _ is of length at most @xmath3 .",
    "assume otherwise and choose @xmath3 consecutive vertices @xmath277 constructed in @xmath3 consecutive recursive calls .",
    "denote these vertices as : @xmath278 .",
    "notice that from the way each @xmath279 is constructed we can immediately deduce that @xmath280 induce a copy of @xmath1 , contradiction .",
    "so after the procedure _ makedensepair _ is called first time by _ createsequence _ , it executes at most @xmath3 its recursive calls .",
    "now notice that the size of the set @xmath151 from the input of the procedure decreases between its two consecutive recursive calls exactly by a factor of @xmath281 .",
    "thus when a set @xmath282 is found the size of @xmath283 is @xmath284 , where @xmath285 is the number of recursive calls that were run . by the definition of @xmath282 we have one of two possible options :    * every vertex of @xmath282 is adjacent to at least @xmath286 vertices of @xmath283 or * every vertex of @xmath282 is adjacent from at least @xmath286 vertices of @xmath283 .",
    "in particular we have : @xmath287 or @xmath288 .",
    "assume without loss of generality that the former holds .",
    "then by the same density argument as in the proof of lemma [ lemma2 ] we can conclude that @xmath289 .",
    "finally , notice that , as we have already mentioned at the very beginning of the proof , both @xmath274 and @xmath290 are of the desired length @xmath119 . that completes the proof .      in this subsection",
    "we show that our results from the main body of the paper are tight up to the @xmath6-factor in the following sense : there exists an infinite family of @xmath1-free tournaments with largest transitive subsets of order @xmath291 .",
    "presented construction is based on @xcite .",
    "we need one more definition .",
    "let @xmath292 be two tournaments and denote @xmath293 .",
    "we denote by @xmath294 a tournament @xmath2 with the vertex set @xmath295 , where each @xmath296 induces a copy of @xmath297 and for any @xmath298 we have the following : @xmath299 is adjacent to @xmath300 iff @xmath301 is adjacent to @xmath302 in @xmath303 .",
    "fix @xmath14 . without loss of generality",
    "we can assume that @xmath304 .",
    "notice first that there exists a universal constant @xmath69 and a tournament @xmath305 on @xmath306 vertices with largest transitive subtournaments of order @xmath3 and that is @xmath1-free .",
    "such a tournament may be easily constructed randomly by fixing @xmath306 vertices and choosing the direction of each edge independently at random with probability @xmath307 ( standard probabilistic argument shows that most of tournaments constructed according to this procedure satisfy the condition regarding sizes of their transitive subsets and @xmath1-freeness ) .",
    "now we define the following infinite family @xmath308 of tournaments :    * @xmath309 is a one - vertex tournament , * @xmath310 for @xmath311 .",
    "each tournament @xmath312 is @xmath1-free .",
    "the proof is by induction on @xmath313 .",
    "induction base is trivial .",
    "now let us assume that all @xmath314s for @xmath315 are @xmath1-free and let us take tournament @xmath316 .",
    "denote the copies of @xmath317 that build @xmath316 as : @xmath318 .",
    "assume by contradiction that @xmath319 is a subtournament of @xmath316 that is isomorphic to @xmath1 .",
    "notice first that @xmath320 for @xmath321 .",
    "indeed , that follows from the fact that clearly every @xmath322 is @xmath1-free .",
    "now observe that if @xmath323 then in fact @xmath324 .",
    "otherwise , by the definition of @xmath308 and from the previous observation we would conclude that @xmath325 is a nontrivial homogeneous subset of @xmath326 but this contradicts the fact that @xmath319 is prime .",
    "but then we conclude that @xmath319 is a subtournament of @xmath305 which obviously contradicts the definition of @xmath305 . that completes the proof .",
    "now notice that the size of @xmath327 is exactly @xmath328 times the size of @xmath314 and the size of the largest transitive subtournament of @xmath327 is exactly @xmath329 times the size of the largest transitive subtournament of @xmath314 for @xmath311 , where @xmath329 stands for the size of the largest transitive subset of @xmath305 .",
    "that immediately leads to the conclusion that the size of the largest transitive subtournament of @xmath314 is of order @xmath330 .",
    "the last expression , by the definition of @xmath305 , is of order @xmath331 .",
    "therefore @xmath308 is the family we were looking for .",
    "one can easily notice that our methods can be extended for larger classes of forbidden tournaments , for instance tournaments with the ordering of vertices under which the graph of backward edges is a matching",
    ". it would be interesting to characterize all classes of tournaments for which presented method ( or its minor modifications ) works .",
    "the approximation ratio of the proposed algorithm may be in practice much better .",
    "this is another interesting direction that could be explored .",
    "i would like to thank dr .",
    "marcin pilipczuk for useful conversation about this work and very helpful suggestions regarding the manuscript .    5 alon n. , pach j. , solymosi j. : ramsey - type theorems with forbidden subgraphs .",
    "* 21 * ( 2001 ) 155170 .",
    "arora s. , chlamtac e. : new approximation guarantee for chromatic number .",
    "proceedings of the 38th annual acm symposium on theory of computing .",
    "( 2006 ) 215224 berge c. , chvtal v. ( eds . ) : topics on perfect graphs .",
    "north - holland , amsterdam , ( 1984 ) berger e. , choromanski k. , chudnovsky m. : forcing large transitive subtournaments . j. comb . theory ,",
    "b. ( 2014 ) blum a. , karger d. : an @xmath332-coloring algorithm for 3-colorable graphs . inf . process .",
    "lett . * 61 * ( 1997 ) 4953 choromanski k. : eh - suprema of tournaments with no nontrivial homogeneous sets .",
    "( 2015 ) erds p. , hajnal a. : ramsey - type theorems .",
    "discrete applied mathematics .",
    "* 25 * ( 2001 ) 3752 .",
    "kaminski m. , lozin v. , sawada j. , shu x. : a note on @xmath3-colorability of @xmath31-free graphs .",
    "mathematical foundations of computer science 2008 , 33rd international symposium , mfcs 2008 , torun , poland , august 25 - 29 , 2008 , proceedings .",
    "( 2008 ) 387394 karger d. , motwani r. , sudan m. : approximate graph coloring by semidefinite programming",
    "* 45 * ( 1998 ) 246265 krl d. , kratochvl j. , tuza z. , woeginger g. : complexity of coloring graphs without forbidden induced subgraphs .",
    "graph - theoretic concepts in computer science , 27th international workshop , wg 2001 , boltenhagen , germany , june 14 - 16 , 2001 , proceedings .",
    "( 2001 ) 254262    lokshtanov d. , vatshelle m. , villanger y. : independent set in @xmath31-free graphs in polynomial time submitted for publication .",
    "( 2013 ) neumann - lara v. : the dichromatic number of a digraph .",
    "theory , ser .",
    "b * 33 * ( 1982 ) 265270    randerath b. , schiermeyer i. : 3-colorability in p for p@xmath333-free graphs",
    ". discrete applied mathematics .",
    "* 136 * ( 2004 ) 299313 robertson n. , seymour p. : graph minors .",
    "wagner s conjecture .",
    ". theory , ser .",
    "b. * 92 * ( 2004 ) 325357 woeginger g. , sgall j. : the complexity of coloring graphs without long induced paths .",
    "acta cybern .",
    "* 15 * ( 2001 ) 107117 choromanski k. : the strong eh - property and the erds - hajnal conjecture , _ submitted for publication_."
  ],
  "abstract_text": [
    "<S> we propose a purely combinatorial quadratic time algorithm that for any @xmath0-vertex @xmath1-free tournament @xmath2 , where @xmath1 is a directed path of length @xmath3 , finds in @xmath2 a transitive subset of order @xmath4 . as a byproduct of our method </S>",
    "<S> , we obtain subcubic @xmath5-approximation algorithm for the optimal acyclic coloring problem on @xmath1-free tournaments . </S>",
    "<S> our results are tight up to the @xmath6-factor in the following sense : there exist infinite families of @xmath1-free tournaments with largest transitive subsets of order at most @xmath7 . as a corollary </S>",
    "<S> , we give tight asymptotic results regarding the so - called _ erds - hajnal coefficients _ of directed paths . </S>",
    "<S> these are some of the first asymptotic results on these coefficients for infinite families of prime graphs .    </S>",
    "<S> @xmath1-free tournaments , acyclic colorings , transitive subsets , the erds - hajnal conjecture </S>"
  ]
}