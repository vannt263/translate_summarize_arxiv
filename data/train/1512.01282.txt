{
  "article_text": [
    "on a particle accelerator the longitudinal profiles of a particle bunch can not easily be measured .",
    "several indirect measurement techniques have been established relying on the measurement of the spectrum of radiation emitted by the bunch either when it crosses a different material  @xcite or when it passes near a different material  @xcite .",
    "this emitted spectrum encode the longitudinal profile through the relation :    @xmath0    where @xmath1 is the emitted intensity as a function of the wavelength @xmath2 .",
    "@xmath3 is the intensity of the signal emitted by a single particle and @xmath4 is a form factor that encodes the longitudinal and transverse shape of the particle bunch .",
    "recovering the longitudinal profile requires to invert this equation however this is not straightforward as the information about the phase of the form factor can not be measured and therefore is not available .",
    "a phase reconstruction algorithm must therefore be used to recover this phase .",
    "several methods exist ( see for example  @xcite ) . in this article",
    "we describe how we implemented two of these methods and compared their performances .",
    "when it is only possible to measure the amplitude of the complex signal , it is necessary to recover the phase of the available data .",
    "we assume that the function of the longitudinal beam density is analytical .",
    "for an analytic function this is easier because the real and imaginary part are not completely independent .",
    "the kramers - kronig relations  @xcite helps restore the imaginary part of an analytic function @xmath5 from its real part and vice versa .    to recover the phase from the amplitude , the function should be written as : @xmath6 with @xmath7 its amplitude and @xmath8 its phase .",
    "the kramers - kronig relations can then be applied as follows : @xmath9 the basis of this relationship are the cauchy - riemann conditions ( analyticity of function ) .    in some cases",
    "this phase can also be obtained simply by using the hilbert transform of the spectrum : @xmath10 as the hilbert transform ( @xmath11 ) is related to the fourier transform ( @xmath12 ) : @xmath13 the calculation of phase can use an optimised fft code and is therefore much faster than calculating the kramers - kronig s integral .",
    "we implemented in matlab these two different phase reconstruction methods .",
    "the hilbert transform method has the advantage of being directly implemented in matlab , allowing a much faster computing .",
    "to test the performance of these methods we created a small monte - carlo program that randomly simulates profiles ( @xmath14 ) made of the combination of 5 gaussians according to the formula @xmath15 where @xmath16 and @xmath17 , @xmath18 and @xmath19 are random numbers with @xmath20 $ ] , @xmath21 $ ] , @xmath22 \\times 10^{-9 } $ ] and @xmath23 \\times 10^{-9}$ ] .",
    "the values of these ranges have been chosen to generate profiles that are not disconnected ( that is profiles whose intensity drops to almost zero between two peaks ) without being perfect gaussian .",
    "we checked that our conclusions are valid across this range .    using this formula we generated 1000 profiles , then took the absolute value of their fourier",
    "transform @xmath24 and sampled at a limited number of frequency points ( @xmath25 ) as would be done with a real experiment in which the number of measurement points is limited ( limited number of detectors or limited number of scanning steps ) .    to estimate the performance of the reconstruction",
    "several estimators are available .",
    "we choose to use the @xmath26 , defined as follow : @xmath27 where @xmath28 is the observed value , @xmath29 is the expected ( simulated ) value , @xmath30 is the weight of the point , n is the number of points .    however",
    "two very similar profiles but with a slight offset , will give a worse @xmath26 than a profile with oscillations ( see figure [ offsine ] ) .",
    "this can be partly mitigated ( in the case of horizontal offset ) by offsetting one profile with respect to the other until the @xmath26 is minimized .",
    "also we decided to look at the fwhm which was generalized as fwxm where @xmath31 $ ] is the fraction of the maximum value at which the full width of the reconstructed profile was calculated ( with this definition the standard fwhm is noted fw0.5 m ) .",
    "we created an estimator @xmath32 defined as follow :    @xmath33    where @xmath34 and @xmath35 are the fwxm of the original and reconstructed profiles respectively .    here two profiles that are similar but slightly offset ( in position or amplitude ) will nevertheless return good values of this estimator despite returning a rather large @xmath26 .     despite being relatively similar .",
    "+ @xmath36 ; for profile with sine noise : fw0.1m=0.0241 , fw0.2m=0.044",
    "fwhm=0.0621 fw0.8m=0.1849 fw0.9m=0.3619 . as fwxm calculated from top of profile , for all profiles",
    ", width=264 ]    to ensure that the choice of the parameters @xmath19 and @xmath18 for the simulations does not bias significantly the results , their value has been varied and this is shown in figure  [ sigma_chi2 ] .",
    "( top ) and @xmath18 ( bottom ) due to effect of scaling in terms of the @xmath26 and @xmath37fwhm ratio . for each point",
    "1000 simulations were made.,title=\"fig:\",width=264 ] +   ( top ) and @xmath18 ( bottom ) due to effect of scaling in terms of the @xmath26 and @xmath37fwhm ratio .",
    "for each point 1000 simulations were made.,title=\"fig:\",width=264 ] +   ( top ) and @xmath18 ( bottom ) due to effect of scaling in terms of the @xmath26 and @xmath37fwhm ratio .",
    "for each point 1000 simulations were made.,title=\"fig:\",width=264 ] +   ( top ) and @xmath18 ( bottom ) due to effect of scaling in terms of the @xmath26 and @xmath37fwhm ratio .",
    "for each point 1000 simulations were made.,title=\"fig:\",width=264 ] +    different distributions have been used for the frequencies @xmath38 : linear , logarithmic , triple - sine . in most sampling schemes we used 33 frequencies to make it comparable with the triple - sine distribution used in  @xcite .",
    "these sampling schemes are defined as follow :    * _ triple - sine _ this sampling matches that of the e-203 experiment at facet  @xcite .",
    "eleven detectors are located every @xmath39 around the interaction point and 3 different sets of wavelengths are used , giving the following distribution : @xmath40 with @xmath41 and @xmath42 varying between @xmath43 and @xmath44 by steps of @xmath39 . * _ linear sampling _ here sampling points are distributed uniformly .",
    "the first and last points of sampling are the first ( @xmath45 ) and last ( @xmath46 ) points used in the triple - sine sampling .",
    "the following formula gives the sampling frequencies : @xmath47.\\ ] ] * _ logarithmic sampling_. here sampling points are distributed logarithmically : @xmath48/32).\\ ] ] for this sampling also the first and last points are the same as in triple - sine sampling .",
    "the study of the sampling is important , as it shows the best position of the detectors and also how to optimize the system .",
    "linearly sampled spectrum gives the best result as shown in figure  [ samp ] .",
    "criterium ( top ) and @xmath49 ( bottom).,title=\"fig:\",width=264 ] +   criterium ( top ) and @xmath49 ( bottom).,title=\"fig:\",width=264 ]    however , the linear sampling may not be practical to realize in a the real world .",
    "one needs to take into account the spatial size of the detectors ( about 10 degrees in the case of e-203 ) and there is also a limit on the start and end points of detectors location ( 35 - 145 degrees for e-203 ) .",
    "so linear sampling at a wide range of frequencies is impossible with this number of points .",
    "an investigation of how many linear sampling points can be used for a given angle difference between detectors shows that such physical constraints reduce strongly the number of detectors that can be used .",
    "figure  [ lin12 ] shows examples of detector positions .",
    "the position of the red points is calculated using formula  [ eq : lamb ] and blue are possible detector positions which do nt break the minimum detector distance ( mdd ) given on top of each plot .",
    "( top ) and @xmath39 ( bottom ) .,title=\"fig:\",width=264 ] +   ( top ) and @xmath39 ( bottom ) .,title=\"fig:\",width=264 ]",
    "figure  [ biglin ] shows a comparison of the performances achieved with such positioning for different mdd . in each case",
    "the triple sine sampling ( ts ) is better than the linear sampling ( ls ) and close from the maximum number of detectors with linear sampling ( lsmx ) . so the ts configuration is favored and will be used in the rest of this paper .",
    "the comparison between ts1 , ts5 and ts10 shows that reconstruction performances are limited by the mdd .",
    "criterium ( top ) and @xmath49 ( bottom ) .",
    "ls is linear sampling with @xmath50 mdd and ts is triple sine sampling ; mx mean the reconstruction use the maximum number of detectors ( blue and red dots in figure [ lin12]).,title=\"fig:\",width=340 ] +   criterium ( top ) and @xmath49 ( bottom ) .",
    "ls is linear sampling with @xmath50 mdd and ts is triple sine sampling ; mx mean the reconstruction use the maximum number of detectors ( blue and red dots in figure [ lin12]).,title=\"fig:\",width=340 ]    the choice of 33 frequencies for the sampling of the spectrum was made to match the current layout used on e-203 .",
    "however it is important to check if there is an optimum value . to perform this check we used the same simulations and the same simulated spectrum but sampled with 3 to 140 points .",
    "the effect of changing the sampling frequencies on the @xmath26 is shown in figure  [ sampling_chi2 ] .",
    "this study uses triple sine sampling with 1000 profiles for each point and both reconstruction method .",
    "( top ) and @xmath49 ( bottom ) .",
    ", title=\"fig:\",width=264 ] +   ( top ) and @xmath49 ( bottom ) .",
    ", title=\"fig:\",width=264 ]    it can be seen at figure [ sampling_chi2 ] that beyond about 33 sampling points the gain on the reconstructed @xmath26 is marginal .    after applying the sampling procedure",
    "the data need to be interpolated and extrapolated to have a larger number of points in the spectrum .",
    "interpolation is done using piecewise cubic hermite interpolating polynomial ( pchip )  @xcite , as suggested in  @xcite .",
    "the interpolation function must satisfy the following criteria : it must conserve the slope at the two endpoints ( to have a continuous derivative ) and respects monotonicity .",
    "pchip interpolation has been chosen as it matches these requirements .",
    "for low frequency extrapolation two methods have been investigated : gaussian or taylorian .    in the gaussian method , we defined the extrapolation as follow : @xmath51 where @xmath52 is the extrapolated spectrum at low frequency and the constants a , b , and c were chosen from the following conditions :    * @xmath53 * @xmath54 * @xmath55    the extrapolation relies in the fact that according to the central limit theorem in the time space the expected profile is gaussian - like and in the frequency space it will also be gaussian .",
    "the other extrapolation method is based on taylor expansion with the following definition : @xmath56    approximation to the 4th order gives the following low frequency ( lf ) extrapolation :    @xmath57    conditions for the constants a , b and c are the same .",
    "comparison of different lf extrapolation can be found in figure  [ lf ] and the performances of these methods in figure  [ lf2 ] .     for each method ( bottom ) .",
    "gaussian and taylorian methods are described in the text .",
    "`` real lf spectrum '' means that the real lf spectrum is used . for this simulation",
    "the hilbert method of phase recovery and @xmath58 high frequency extrapolation were used.,title=\"fig:\",width=245 ] +   for each method ( bottom ) .",
    "gaussian and taylorian methods are described in the text .",
    "`` real lf spectrum '' means that the real lf spectrum is used .",
    "for this simulation the hilbert method of phase recovery and @xmath58 high frequency extrapolation were used.,title=\"fig:\",width=245 ] +     for each method ( top ) and @xmath49 ( bottom ) .",
    ", title=\"fig:\",width=245 ]   for each method ( top ) and @xmath49 ( bottom ) .",
    ", title=\"fig:\",width=245 ]    in the rest of this paper we used the gaussian method .",
    "several high frequency ( hf ) extrapolation methods were also tested .",
    "the most common  @xcite is : @xmath59 where @xmath52 is the extrapolated spectrum at high frequency and @xmath60 , where @xmath61 is spectrum value of final point @xmath46 .",
    "the second method uses the same consideration as in lai and sievers  @xcite : assuming that the bunch size is finite with two end points at @xmath62 and at @xmath63 then the longitudinal charge distribution ( @xmath64 ) must follow @xmath65 .",
    "an integration by parts gives  : @xmath66 the first term vanishes because of the boundary conditions , so for large @xmath67 , @xmath68 is proportional to @xmath69 and two conditions have to be matched  :    * @xmath70 * @xmath71    where @xmath72 is the last sampled point of the spectrum . to satisfy the boundary condition two constants",
    "are needed , giving a two - terms extrapolation  : @xmath73 or extrapolation with degree of frequency as free parameter : @xmath74    where the a and b  coefficients which are calculated from the last data samples and the boundary conditions as follow :    * @xmath75 * @xmath76    the requirement of finite bunch size requires @xmath77 , so in the case where the fit gives @xmath78 we use @xmath79 .",
    "two other extrapolation methods also have been investigated :    * @xmath80 for @xmath81 * @xmath82 for @xmath83 where @xmath84 is the real spectrum .",
    "these hf extrapolation methods are compared in figure  [ hf ] and  [ hf2 ] .",
    "thus , by virtue of the above arguments and simulations , it s naturally to choose the high - frequency extrapolation by power function .",
    "+   +     ( top ) and @xmath49 ( bottom).,title=\"fig:\",width=245 ] +   ( top ) and @xmath49 ( bottom).,title=\"fig:\",width=245 ] +",
    "after applying extrapolation and interpolation , the spectrum recovery is completed .",
    "then we used different reconstruction techniques to reconstruct the original profile . for each reconstruction method",
    "some profiles are very well reconstructed whereas some other are not so well reconstructed .",
    "examples of well reconstructed profiles are shown in figure  [ good_profiles ] and examples of poorly reconstructed profile are shown in figure  [ bad_profiles ] .",
    "+   +      +   +   +    the @xmath32 and @xmath26 distribution of the 1000 simulations which were made and then reconstructed using the hilbert transform method and kramers - kornig reconstruction are shown in figure  [ profiles_stats_hilbert ] .",
    "there is a good concordance in fwhm between two methods indicating that they are both good at finding the bunch length .",
    "however , the hilbert method gives lower @xmath26 indicating that this method is better at reconstruction of the bunch profile .",
    "( top ) and @xmath26 ( bottom ) distribution of 1000 simulations reconstructed using the hilbert transform method ( black line ) and kramers - kronig reconstruction method ( red line ) .",
    ", title=\"fig:\",width=264 ] +   ( top ) and @xmath26 ( bottom ) distribution of 1000 simulations reconstructed using the hilbert transform method ( black line ) and kramers - kronig reconstruction method ( red line ) .",
    ", title=\"fig:\",width=264 ]    the fact that the phase recovery method based on the kramers - kronig relation gives a worst @xmath26 than the method based on hilbert relation has been investigated .",
    "it is caused by the presence of negative components in the tails of the profiles .",
    "figure  [ expkk ] highlights this issue for one of the profiles .     and explains why the @xmath26 obtained by this method is higher as shown in figure  [ profiles_stats_hilbert].,width=377 ]    figure  [ fwxm ] shows the different fwxh values for different values of x. this shows that at different height of the profiles the quality of reconstruction varies : there is a better agreement in the tails ( x=10% ) than at the top of the profile ( x=90% ) .",
    "figure  [ mod ] shows the modulus of the difference between the original and reconstructed profiles .",
    "one can see oscillations in the difference between the original and reconstructed profile .     for 1000 profiles with both methods.,width=264 ]     +     while doing this work we also became aware of the discussion in  @xcite where it is argued that these reconstruction method have more difficulties with lorentzian profiles than gaussian profiles .",
    "therefore we simulated 1000 lorenzian profiles and performed a similar study .",
    "this is shown in figure  [ lorenz ] .",
    "although the @xmath26 is slightly worse in that case than in the case of gaussian profiles there still a good agreement between the original and reconstructed profiles .     in the case of a lorenzian distribution .",
    ", title=\"fig:\",width=264 ] +   in the case of a lorenzian distribution .",
    ", title=\"fig:\",width=264 ] +    in our discussion so far we considered only the ideal case where no noise is added to the measured spectrum .",
    "however in a real experiment a noise component has to be added to the measured spectrum .",
    "this noise was added as follow : @xmath85\\ ] ] where @xmath28 is the observed value , @xmath86 is the observed value with noise , @xmath87 is a random number between 0 and 1 ( all numbers between 0 and 1 being equiprobable ) , and @xmath88 is the maximum noise for that simulation ( depending on the case this can be 5% , 10% , 20% , 30% , 40% or 50% ) .",
    "this study was done using linear sampling with 33 samples and 1000 simulated profiles for each noise value .",
    "figure  [ noise ] shows how the @xmath26 is modified when this noise component is added .     and @xmath32 as function of noise amplitude.,title=\"fig:\",width=264 ] +   and @xmath32 as function of noise amplitude.,title=\"fig:\",width=264 ] +",
    "we performed extensive simulation to estimate the performance of two phase recovery methods in the case of multi - gaussian and lorenzian profiles . in both cases we found that when the sampling frequencies are chosen correctly we obtained a good agreement between the original and reconstructed profiles ( in most cases @xmath89 ; @xmath90 ) .",
    "this confirms that such methods are suitable to reconstruct the longitudinal profiles measured at particle accelerators using radiative methods .",
    "the authors are grateful for the funding received from the french anr ( contract anr-12-js05 - 0003 - 01 ) , the pics ( cnrs ) `` development of the instrumentation for accelerator experiments , beam monitoring and other applications '' and research grant # f58/380 - 2013 ( project f58/04 ) from the state fund for fundamental researches of ukraine in the frame of the state key laboratory of high energy physics and the ideate international associated laboratory ( lia ) ."
  ],
  "abstract_text": [
    "<S> measurements of coherent radiation at accelerators typically give the absolute value of the beam profile fourier transform but not its phase . </S>",
    "<S> phase reconstruction techniques such as hilbert transform or kramers kronig reconstruction are used to recover such phase . </S>",
    "<S> we report a study of the performances of these methods and how to optimize the reconstructed profiles . </S>"
  ]
}