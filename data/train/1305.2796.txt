{
  "article_text": [
    "the study of _ finite tilings _ is a classical subject of interest in both theoretical and recreational literature  @xcite . in the _ tileability problem",
    "_ , a finite set of tiles  @xmath1  is fixed , and a region is an input .",
    "this problem is known to be polynomial in some cases , and -complete in others ( see  @xcite ) . over the years",
    ", the hardness results were successively simplified ( in statement , not in proof ) , with both sets of tiles and the regions becoming more restrictive .",
    "this paper is a new step in this direction .    in  @xcite",
    ", it was shown that tiling of general regions with two bars is np - complete , except for the case of dominoes . in a different direction ,",
    "rmila  @xcite ( building on the ideas in  @xcite ) , showed that for _ simply connected regions _ and two rectangles , the tileability can be solved in quadratic time ( in the area ) .",
    "the following theorem closes the gap between these polynomial and -complete results .",
    "[ thm - rect ] there exists a finite set @xmath2 of at most @xmath0 rectangular tiles , such that the tileability problem of simply connected regions with  @xmath2 is -complete .",
    "our proof of the main theorem is split into two parts . in the first part",
    ", we use the language of _",
    "wang tiles _ to reduce the cubic monotone @xmath3-in-@xmath4 sat problem , known to be -complete , to the @xmath1-tileability of simply connected regions with wang tiles . in the second part ,",
    "we reduce wang tileability to tileability with rectangular tiles .",
    "both our reductions are _ parsimonious _ and are used to prove that counting the number of tilings of simply connected regions is also hard , via reduction from  2sat .",
    "[ thm - sharp ] there exists a finite set @xmath2 of at most @xmath0 rectangular tiles , such that counting the number of tilings of simply connected regions with  @xmath2 is -complete .",
    "although -completeness is known for tilings of general regions with right tromino and square tetromino  @xcite , nothing was known for tilings with rectangles .",
    "we refer to section  [ s : fin ] for the history of the problem , references , and further remarks .",
    "consider the integer lattice @xmath5 as a union of closed unit squares with pairwise disjoint interiors .",
    "a _ region _ is a finite union of such unit squares such that the interior is connected .",
    "an ( _ ordinary _ ) _ tile _ is a finite simply connected region .",
    "a _ tileset _ @xmath1 is a collection of tiles . given a region @xmath6 and a tileset @xmath1 , a _ @xmath1-tiling _ of @xmath6 is a union of translated copies of tiles from @xmath1 with pairwise disjoint interiors covering @xmath6 .",
    "if a region admits a @xmath1-tiling then it is _",
    "@xmath1-tileable_. we may simply say _ tiling _ and _ tileable _ when @xmath1 is understood . consider the following decision problems regarding tileability :    ll + * instance : * & simply connected region @xmath6 , finite tileset @xmath1 . + * decide : * & whether @xmath6 is @xmath1-tileable ?",
    "ll + * instance : * & simply connected region @xmath6 . + * decide : * & whether @xmath6 is @xmath1-tileable ?",
    "an input region can be given by the ( finite ) union of the squares it contain .",
    "the following is one of the early -completeness results  @xcite .",
    "[ thm-2-dim ] if both region @xmath6 and tileset @xmath1 are part of the input , simply connected tileability is -complete in the plane .    for the rest of the paper",
    ", we will focus on finding a fixed @xmath1 such that simply connected @xmath1-tileability is -complete .",
    "the following result is an extension of theorem  [ thm-2-dim ] .",
    "[ thm - ordinary ] there exists a set @xmath1  of  @xmath7 tiles , such that simply connected @xmath1-tileability is -complete .",
    "the proof follows an explicit construction of wang tiles ( see below ) . while we do not use theorem  [ thm - ordinary ]",
    ", it is of independent interest , and the intermediate results in its proof provide a key step towards the proof of the main theorem .",
    "the history behind this theorem and its potential generalizations is outlined in subsection  [ ss : fin - levin ] .",
    "the _ edges _ of an ordinary tile are the unit - length edges on the boundary . given a set of colors and an ordinary tile @xmath8 , a _",
    "generalized wang tile _ is an assignment of colors to the edges of @xmath8 .",
    "note that an ( _ ordinary _ ) _ wang tile _ is a generalized wang tile of a unit square .",
    "the region @xmath6 we are trying to tile will also have specified colors on its boundary .",
    "a region is ( _ wang _ ) _ tileable _ if there is a tiling where incident edges have the same color , including on the boundary of the region ( see figure  [ wang - tiling ] ) .",
    "if a tileset consists of ( generalized ) wang tiles , tileability always mean wang tileability .          let us consider a more general setting . a set of _ relational wang tiles _ is a collection @xmath9 of squares and the following data . the vertical ( respectively horizontal ) _",
    "wang relation _",
    "@xmath10 ( respectively @xmath11 ) specify that @xmath12 is allowed to be placed immediately below ( respectively to the right of ) @xmath13 .",
    "we suppress the subscripts when it can be understood from context .",
    "the _ boundary tiles _ of a region @xmath6 is a map from the exterior edges of @xmath6 to the tiles  @xmath9 . by abuse of language , we define the notion of tiling in this context : a _ @xmath9-tiling _ of a region @xmath6 is a map @xmath14 such that tiles placed next to each other satisfy the wang relations .",
    "whenever a tile is adjacent to an exterior edge , we check the wang relations as if the boundary tile corresponding to the edge is on the other side of the edge .      throughout the paper",
    "we consider many tiling problems that are -complete .",
    "all these problems are trivially in  . indeed , given a description of a tiling , one could simply check if it is in fact a tiling . to prove -hardness , we reduce a known -complete problem to the problem in question .",
    "we refer to  @xcite for definitions and details .",
    "we will embed cubic monotone @xmath3-in-@xmath4 sat as a tiling problem .",
    "let @xmath15 be a set of boolean variables .",
    "a ( _ monotone @xmath3-in-@xmath4 _ ) _ clause _",
    "@xmath16 is a set of three variables .",
    "a ( _ cubic monotone @xmath3-in-@xmath4 _ ) _ expression _",
    "@xmath17 is a finite collection @xmath18 of monotone @xmath3-in-@xmath4 clauses , where each variable @xmath19 occurs three times .",
    "we say such @xmath17 is ( _ @xmath3-in-@xmath4 _ ) _ satisfiable _ if there is an assignment of boolean values @xmath20 to the variables @xmath19 such that each clause in @xmath17 contains precisely one variable receiving  @xmath3 ( and thus two variables receiving  @xmath21 ) .",
    "ll + * instance : * & set @xmath22 of variables , cubic monotone expression @xmath17 .",
    "+ * decide : * & whether @xmath17 is @xmath3-in-@xmath4 satisfiable ?",
    "the following result was shown by gonzalez in the language of exact covers :    [ thm - mr ] cubic monotone @xmath3-in-@xmath4 sat is -complete . , we can associate a bipartite graph @xmath23 with vertex set @xmath24 , where a variable @xmath25 is adjacent to a clause @xmath26 if @xmath27 .",
    "moore and robson showed something stronger in @xcite , that this problem is -complete even if we require the associated graph to be planar .",
    "they did this by reducing from planar @xmath3-in-@xmath4 sat , which is -complete @xcite .",
    "however , we do not need to use the planar version . ]",
    "we will reduce cubic monotone @xmath3-in-@xmath4 sat to a tiling problem simply connected @xmath1-tileability for some fixed @xmath1 .      throughout the paper we consider natural counting problems corresponding to the decision problems .",
    "for example , instead of asking whether satisfying assignments exist , we ask _ how many _ satisfying assignments there are .",
    "similarly , for tileability , we count the number of tilings . if in the proof of -completeness , the corresponding reductions give a bijection between the sets of solutions , we call such reduction _",
    "parsimonious_.    parsimonious reductions have the additional benefit of proving counting results using the same reduction .",
    "the class consists of the counting problems associated with decisions problems in  .",
    "a counting problem is -complete if it is in and every question can be reduced to it .",
    "thus , if there is a parsimonious reduction from problem  @xmath28 to  @xmath29 , then if @xmath28 is -complete , then so is  @xmath29 .",
    "we refer to  @xcite ( see also  @xcite ) for definitions and details on   complexity class .",
    "one main goal is to reduce cubic monotone @xmath3-in-@xmath4 sat to a tiling problem simply connected @xmath1-tileability for some fixed @xmath1 .",
    "this reduction will turn out to be parsimonious , hence the number of satisfying assignments of a given instance of the satisfiability problem can be calculated by counting the number of tilings of the transformed instance .",
    "however , it is not known whether the associated counting problem # cubic monotone @xmath3-in-@xmath4 sat is -complete . to get the -completeness result in theorem  [ thm - sharp ]",
    ", we will modify the reduction to use 2sat instead , whose associated counting problem # 2sat is -complete .",
    "in this section we consider five classes of tileability problems .",
    "let @xmath30 be a collection of tiles and @xmath31 be a collection of regions .",
    "a decision problem in _ @xmath32-tileability _ consists of a _ fixed _",
    "tileset @xmath33 , receives some @xmath34 as input , and outputs whether @xmath6 is @xmath1-tileable .",
    "we say @xmath32-tileability is _ linear time reducible _ to @xmath35-tileability if for any finite tileset @xmath33 , there exists a finite tileset @xmath36 and a _ reduction map _ @xmath37 that is computable in linear time ( in the complexity of @xmath34 ) , such that @xmath34 is @xmath1-tileable if and only if @xmath38 is @xmath39-tileable .",
    "if , moreover , that @xmath35-tileability is linear time reducible to @xmath32-tileability , then they are _ linear time equivalent_. note that the transformation of the tilesets need not be efficient nor bijective .    for instance , if @xmath30 is the collection of all rectangular tiles and @xmath31 consists of simply connected regions , then @xmath32-tileability is a class of problems regarding tiling simply connected regions with rectangular tiles . to simplify the notation",
    ", we drop the prefix in @xmath32-tileability when the sets  @xmath30 and  @xmath31 are understood .",
    "[ lem - reduction ] the following five classes of simply connected tileability problems are linear time equivalent :    1 .",
    "tileability with a fixed set of rectangular tiles .",
    "2 .   tileability with a fixed set of ordinary tiles .",
    "3 .   tileability with a fixed set of generalized wang tiles .",
    "4 .   tileability with a fixed set of ordinary wang tiles .",
    "tileability with a fixed set of relational wang tiles .",
    "moreover , the size of the tileset can be preserved in the reductions between and .",
    "the reductions ( i)@xmath40(ii)@xmath41(iii)@xmath40(iv)@xmath40(v ) are elementary and given below .",
    "the reduction ( v)@xmath40(i ) is stated separately as lemma  [ lem - rect ] and proved in the next section .",
    "we may consider a rectangular tile as an ordinary tile , which in turn is a monochromatic generalized wang tile .",
    "therefore the reductions ( i)@xmath40(ii)@xmath40(iii ) are immediate , where each reduction map is simply the identity .",
    "( iii)@xmath40(iv ) . given a set of generalized wang tiles , color each interior edge with a new color not used anywhere else , and consider each square as a separate ordinary wang tile",
    "( see figure  [ iii - iv ] ) .",
    "these tiles are forced to reassemble themselves as the original generalized wang tiles .",
    "the reduction map is again the identity .",
    "( iv)@xmath40(v ) .",
    "it is obvious how to define the wang relations to mimic the colored wang tiles without increasing the number of tiles . to encode the boundary conditions",
    ", we may need to introduce less than @xmath42 tiles , where @xmath43 is the number of colors permitted on the boundary . indeed , to specify a color @xmath44 on the top boundary , we need to choose an ( arbitrary ) tile whose bottom color is  @xmath44 .",
    "if no such tile exists , we must add a new tile to do so .",
    "if we do not involve the new tile in any wang relations in the other directions , then it will never be used in the actual tiling , and thus will not affect tileability .",
    "we do the same for the other three directions .",
    "the final reduction ( v)@xmath40(i ) is more difficult and is the content of lemma  [ lem - rect ] and proved in a later section .    to preserve the number of tiles in ( iii)@xmath40(ii ) , scale the generalized wang tile and replace each colored edge by an appropriate rectilinear zig - zag curve to encode the matching rules ( see figure  [ iii - ii ] and @xcite ) .",
    "[ lem - wang ] there exists a set @xmath1 of at most @xmath45 generalized wang tiles with total area @xmath46 and using @xmath47 colors such that simply connected @xmath1-tileability is -complete .",
    "moreover , this will be achieved by a parsimonious reduction from cubic monotone @xmath3-in-@xmath4 sat .",
    "[ lem - rect ] for a set @xmath9 of at most @xmath48 ( ordinary ) wang tiles with  @xmath44 ( boundary ) colors , there exists a set @xmath2 of at most @xmath49 rectangular tiles with the following property .",
    "given a simply connected colored region @xmath6 , there is a simply connected region @xmath50 such that @xmath6 is @xmath9-tileable if and only if @xmath50 is @xmath2-tileable .",
    "moreover , this reduction is parsimonious and can be computed in linear time .",
    "we may transform the set of @xmath45 generalized wang tiles afforded by lemma  [ lem - wang ] , according to the procedure outlined in ( iii)@xmath40(ii ) of lemma  [ lem - reduction ] , in order to obtain theorem  [ thm - ordinary ] using @xmath45 ordinary tiles .",
    "similarly , using the transformation of lemma  [ lem - rect ] , we conclude the result for rectangular tiles in theorem  [ thm - rect ] ( see subsection  [ ss : proof - thm - rect ] ) .",
    "theorem  [ thm - sharp ] can be shown by modifying the proof of lemma  [ lem - wang ] to achieve a parsimonious reduction from , say , 2sat , whose associated counting problem is -complete ( see subsection  [ ss : proof - thm - sharp ] ) .",
    "the goal of this section is to construct a set of generalized wang tiles that could be used to solve cubic monotone @xmath3-in-@xmath4 sat .",
    "each expression will be encoded as a colored rectangular boundary .",
    "tiles corresponding to variables and clauses will appear on the left and right sides of the region , respectively .",
    "the variable tiles will `` transmit '' its state ( @xmath21 or  @xmath3 ) through `` wires '' to the clause tiles ; each clause tile will `` check '' if precisely one out of three signals it receives is  @xmath3 .",
    "the path of the transmissions will be regulated by placing `` crossover tiles '' that allow signals to crossover at specific locations .",
    "the positioning of such tiles will be enforced by using a combination of `` control tiles '' that follow instructions encoded on the boundary .",
    "empty spaces will be filled by `` filler tiles . ''",
    "let @xmath1 be a tileset with the @xmath51 small tiles shown in figure  [ tiles-0 ] and the @xmath4 big tiles in figure  [ tiles-1 ] .",
    "some horizontal edges are colored by their labels ; all unlabeled edges are colored by  @xmath21 , which is omitted in the figures for clarity , but acts as any other ordinary color .",
    "+      recall that the vertical edges of our tiles in @xmath1 are all colored with  @xmath21 .",
    "form @xmath39 by recoloring the vertical edges of tiles in @xmath1 as follows .",
    "given each small tile @xmath52 in figure  [ tiles-0 ] , we introduce a variant by coloring all its vertical edges with  @xmath3 .",
    "the color of the vertical edges is called the _",
    "parity _ of  @xmath8 . include both this variant and the original in  @xmath39 .    given a rectangular array of these tiles , the parities are consistent across each row and are independent across the columns .",
    "intuitively , these tiles act as wires that can transmit data ( parity of the tile ) horizontally across the region .",
    "we continue defining @xmath39 .",
    "we add three new versions of the crossover tile  @xmath22 as in figure  [ tile - xd ] .",
    "intuitively , this allows the data transmissions to _ crossover_. we also add a variant of the variable tile  @xmath53 , as in figure  [ tile - vd ] , where all the right vertical edges are colored with  @xmath3 .",
    "the parity of the variable tile corresponds to the truth value assigned to that variable .",
    "finally , we _ replace _ the clause tile  @xmath16 by the three shown in figure  [ tile - cd ] , where each tile has one out of three pairs of left vertical edges colored with  @xmath3 .",
    "thus @xmath39 consists of @xmath45 tiles .",
    "+    we will place the variable tiles on the left and the clause tiles on the right .",
    "it remains to send the data from the variables to the correct clauses .",
    "we achieve this by specifying boundary colors to force crossover tiles to appear at the desired locations .",
    "our goal is to embed the decision problem cubic monotone @xmath3-in-@xmath4 sat as a tiling problem . given a cubic monotone @xmath3-in-@xmath4 sat expression  @xmath17 with variables @xmath15 and clauses @xmath54 , consider it as a permutation @xmath55 in the symmetric group on @xmath56 letters as follows .",
    "think of @xmath57 as a bijection from the ordered multiset @xmath58 to the ordered multiset @xmath59 , where each variable and each clause is listed three times . for each @xmath60",
    ", we have @xmath61 once .",
    "now identify each multiset with @xmath62=\\{1,2,\\ldots,3n\\}$ ] to get @xmath57 as a permutation in  @xmath63 .",
    "let @xmath64 be an adjacent transposition for @xmath65 $ ] .",
    "write @xmath66 as a product of adjacent transpositions , with @xmath67 .",
    "and  [ wiring-2 ] . ]",
    "let @xmath68 be the color sequence @xmath69 .",
    "define a rectangular region @xmath70 as follows .",
    "the height of @xmath6 is @xmath71 and the vertical edges are colored with  @xmath21 .",
    "the width is the length of the color sequence @xmath72 , which is used as the top boundary .",
    "the bottom boundary is @xmath73 with the same length as the top boundary .",
    "the following result demonstrates the ability to place the crossover tile  @xmath22 at arbitrary depth of a large rectangular region .",
    "[ sl : unique - wang ] the region @xmath6 admits a unique @xmath1-tiling .    the left and right sides are forced to be filled with variable and clause tiles , respectively .",
    "now consider the section in between .    for @xmath74 and @xmath75 ,",
    "consider a row of tiles @xmath76 ( meaning an @xmath77 tile followed by a @xmath78 tiles @xmath48 times , an @xmath79 tile @xmath80 times , and ending with an @xmath81 tile ) .",
    "the bottom color sequence is @xmath82 .",
    "one easily checks that the unique way to tile the next row is with @xmath83 .    if @xmath84 , we get the case where we have a row @xmath85 with bottom color sequence @xmath86 .",
    "the unique way to tile the next row is with @xmath87 .",
    "the section below will be filled by filler tiles  @xmath88 .",
    "thus every section below @xmath89 is filled uniquely , with the crossover tile  @xmath22 occupying rows @xmath90 and @xmath91 in the first column .",
    "the above proof is illustrated with two examples in the next subsection .",
    "the expression @xmath17 is satisfiable if and only if @xmath92 is @xmath39-tileable .",
    "moreover , the reduction is parsimonious , that is , the number of tilings of @xmath92 is the number of satisfying assignments for @xmath17 .",
    "the corollary follows immediately from the construction given above , and concludes the proof of lemma  [ lem - wang ] .      in figure  [ diagram-1 ]",
    "we show how to place a crossover tile in a special case , corresponding to expression @xmath93 .",
    "we illustrate the crossings with a _ wiring diagram _ and then give a complete wang tiling . in figure  [ diagram-2 ] below",
    "we give a bigger example of the wiring diagram and the unique wang tiling , corresponding to expression @xmath94 .",
    "in this section , we provide a further connection between wang tiles and ordinary rectangular tiles ( by making a reduction from the latter to the former ) . recall that by lemma  [ lem - reduction ]",
    ", we can replace generalized wang tiles with relational wang tiles .    without loss of generality",
    ", we may assume that the wang relations are irreflexive , that is , there is no tile @xmath8 such that @xmath95 or @xmath96 . indeed , suppose @xmath9 is a set of wang tiles .",
    "let @xmath97 be a doubled set of tiles .",
    "define its horizontal wang relation as follows . for @xmath98 and @xmath99 , let @xmath100 if and only if @xmath101 and @xmath102 .",
    "its vertical wang relation is defined analogously .",
    "it is clear that the wang relations of @xmath103 are irreflexive .",
    "moreover , a @xmath9-tiling can be made into a @xmath103-tiling by adding subscripts to the tiles in a checkerboard fashion , while the reverse can be done by ignoring the subscripts .",
    "of course , the same transformation is done on the boundary tiles as well .",
    "clearly this does not affect tileability nor the number of such tilings .",
    "from now on , assume we are given a fixed set @xmath9 of relational wang tiles whose relations @xmath104 and @xmath53 are irreflexive . our goal is to produce a fixed set @xmath2 of rectangular tiles with the following property : given any simply connected region @xmath6 with specified boundary tiles , we can produce ( in linear time ) a simply connected region @xmath50 such that @xmath6 is @xmath9-tileable if and only if @xmath50 is @xmath2-tileable .",
    "moreover , the number of @xmath9-tilings of @xmath6 will be the same as the number of @xmath2-tilings of  @xmath50 .    for simplicity",
    ", we first consider the case where we are given an @xmath105 rectangular region @xmath6 with specified boundary tiles .      from this point on ,",
    "we only consider tiling using rectangular tiles .",
    "fix @xmath106 and @xmath107 to be positive integers . given a region @xmath108",
    ", we obtain an _ @xmath109-expansion _ @xmath6 by scaling @xmath108 by a factor of @xmath106 and then _ perturb _ it by moving each corner vertex of the boundary curve of the region  @xmath6 , at most @xmath107 in each direction , such that @xmath6 is still a region ( with rectilinear edges ) .",
    "recall that a ( rectangular ) tile is just a simply connected region , thus the notion of @xmath109-expansion of a tile is defined .",
    "a tileset @xmath1 is an _",
    "@xmath109-expansion _ of a tileset @xmath110 if each @xmath52 is an @xmath109-expansion of some @xmath111 .",
    "a tiling @xmath112 of a region @xmath6 is an _",
    "@xmath109-expansion _ of a tiling @xmath113 of some region @xmath108 if it can be obtained by dilating by a factor of @xmath106 , and then perturbing the tiles and the region by at most @xmath107 as above .",
    "note that after scaling , each tile may grow or shrink in each dimension by at most @xmath114 , and can _ shift _ around from its starting point by at most  @xmath107 .",
    "given a tileset @xmath110 and an @xmath109-expansion @xmath1 , a region @xmath6 _ respects the expansion _ if there is a unique region @xmath108 such that any @xmath1-tiling of @xmath6 is an @xmath109-expansion of a @xmath110-tiling of  @xmath108 .    intuitively , we will choose @xmath115 , say , and carefully perturb only a few tiles , so that when consider tilings of regions respecting the expansion , we can essentially predict what the new tiling can be based on the original tiling .",
    "consider the following tileset : @xmath118 where @xmath119 denotes a rectangle of height @xmath120 and width @xmath121 ( see figure  [ rect - tiles ] ) .",
    "for a rectangle @xmath122 , write @xmath123 and @xmath124 for its height and width , respectively .    .,title=\"fig : \" ] .,title=\"fig : \" ] .,title=\"fig : \" ] .,title=\"fig : \" ] .,title=\"fig : \" ]    now consider the region @xmath117 defined as follows ( see figure  [ fig : boundary ] ) .",
    "on each vertical side , there are @xmath125 _ protrusions _ of height @xmath126 and width @xmath127 , separated by height @xmath128 . on each horizontal side , there are @xmath44 _ cavities _ of width @xmath129 and height @xmath130 , separated by width @xmath131 .    . ]    [ sl : unique - rect ] the unique @xmath116-tiling of @xmath117 consists of @xmath125 rows and @xmath44 columns of the @xmath132 tile .",
    "fix natural numbers @xmath133 and @xmath134 . the tiles introduced above can now be written as @xmath135 , @xmath136 , @xmath137 , @xmath138 , and @xmath139 .",
    "we begin with a few definitions .",
    "a horizontal ( vertical ) segment of a region is called _ bounded _ if the region extends downward ( to the right ) on both sides of the segment . for @xmath140 ,",
    "a _ pair @xmath141 _ is the configuration of placing the tile @xmath142 above or below @xmath122 , aligned on the left",
    ". the _ orientation _ of the pair is positive ( negative ) if @xmath142 is placed below ( above ) .",
    "similarly , for @xmath143 , a pair @xmath141 is obtained by placing @xmath142 to the left or right of @xmath122 , aligned on top .",
    "the orientation is positive ( negative ) if @xmath142 is placed to the right ( left ) .",
    "a bounded segment is _ tiled by a tile _ ( _ pair _ ) if in all tilings , the tile ( pair ) is adjacent to the segment .",
    "we will tile the region @xmath117 in steps , as indicated by the numbers labeled on figure  [ order ] .",
    "note that since @xmath144 , each bounded horizontal segment of width @xmath131 on the top border must be tiled by @xmath145 tiles , labeled  1 . similarly on the left , the bounded vertical segments of height @xmath126 must be tiled by @xmath146 tiles , labeled  2 .",
    "this creates a bounded vertical segment of height @xmath147 on the top left corner ; since @xmath148 , it is tiled by the pair @xmath149 , labeled  3 . since @xmath150 , it is obvious that it needs to be positively oriented , to avoid a hole of width @xmath151 and height @xmath130 , which can not be filled .",
    "note that since @xmath148 , this creates a new bounded horizontal segment of width @xmath152 , which is tiled by the pair @xmath153 , labeled  4 .",
    "if  @xmath132 is on the left , it will create a bounded horizontal segment of width @xmath154 to its left . otherwise ,",
    "if @xmath132 is on the right , several @xmath142 will be forced to appear on the left and still create the same bounded segment .",
    "therefore , the @xmath153 pair creates the bounded segment , regardless of how it is oriented .",
    "since @xmath148 , this bounded horizontal segment of width @xmath154 is again tiled by an @xmath155 pair , labeled  5 .",
    "like the @xmath149 pair above , since @xmath150 , this needs to be positively oriented .",
    "this creates the bounded vertical segment of height @xmath147 , tiled by a pair @xmath149 , labeled  6 , as above . in either orientation",
    ", it bounds the vertical segment of height @xmath156 above , concluding that the @xmath153 pair ( labeled 4 ) we placed above needs to be positively oriented .",
    "furthermore , this bounds the vertical segment of height @xmath157 , again tiled by the pair @xmath158 , labeled  7 . as before ,",
    "in either orientation , we have a bounded vertical segment of height @xmath147 , which necessarily needs to be tiled by the positively oriented pair @xmath149 , labeled  8 .",
    "this creates a bounded horizontal segment of width @xmath152 .",
    "we continue in like manner , working our way on the anti - diagonal from top right to bottom left . each time we place the pair @xmath153 , forcing the adjacent pair @xmath158 placed in the previous stage to be positively oriented",
    ". then we place @xmath155 , forcing the adjacent @xmath149 to be positively oriented as well .",
    "this procedure repeats with @xmath153 and @xmath155 in an alternating fashion .",
    "the last @xmath155 will be placed in positive orientation and creates a bounded vertical segment of height @xmath147 .",
    "similarly , we work from bottom left to top right on the next anti - diagonal .",
    "we alternate between placing @xmath149 and @xmath158 pairs , positively orienting the @xmath153 and @xmath155 pairs in the previous stage , respectively .",
    "this continues until the entire region is filled .",
    "we will now define a clever set of perturbed expansion tiles that will correspond to the relational wang tiles . only the tiles @xmath142 , @xmath146 , and @xmath159 will have perturbations .",
    "let @xmath160 be the fixed set of relational wang tiles with irreflexive horizontal and vertical wang relations @xmath104 and @xmath53 , respectively .",
    "fix @xmath161 and @xmath162 for the remainder of the section .",
    "let @xmath2 be an @xmath109-expansion of @xmath116 as follows :    for @xmath163 , let @xmath164 be the scaled version of @xmath122 with height and width increased by @xmath120 and @xmath121 , respectively .",
    "imagine that the @xmath146 and @xmath159 tiles can stretch horizontally and vertically , respectively , and the @xmath142 tiles can stretch in both directions .",
    "then the @xmath132 tiles , having no perturbations , will only shift around a little ( by at most @xmath107 ) .",
    "the @xmath145 tiles will stay fixed , enforcing the global structure .",
    "see figure  [ fig : shifting ] .",
    "a @xmath132 tile will be shifted to the right and down by @xmath165 to _ represent _ the wang tile @xmath166 . to restrict the shifts to only those sizes , we replace @xmath142 with the appropriate perturbed versions .",
    "namely , for each @xmath90 , introduce four tiles with perturbations @xmath167 , where all four combinations of signs are included . to enforce the wang relations , for each @xmath168 such that @xmath169 or @xmath170 , we introduce the perturbation @xmath171 or @xmath172 , respectively .",
    "this is the set @xmath2 we will use .",
    "obtain an @xmath109-expansion @xmath173 of @xmath117 by scaling with a factor of @xmath106 and then perturbing it as follows .",
    "recall that there are @xmath125 protrusions on each vertical side and @xmath44 cavities on each horizontal side .",
    "each protrusion or cavity corresponds to a boundary tile of @xmath6 in a natural way .",
    "perturb the protrusion or cavity to the right or down , respectively , by @xmath165 units if it corresponds to @xmath166 .",
    "the @xmath109-expansion @xmath173 of @xmath117 respects the expansion @xmath2 of  @xmath116 .",
    "recall the argument in the proof of sublemma  [ sl : unique - rect ] .",
    "as the inequalities are all satisfied , the @xmath145 tiles are fixed and force the perturbations to stay local .",
    "the @xmath132 tiles have two degrees of freedom .",
    "they can move @xmath174 in each direction , as regulated by the @xmath142 tiles .",
    "now note that the inequalities in the proof of sublemma  [ sl : unique - rect ] are preserved .",
    "we leave the ( easy ) details to the reader .",
    "we now return to the proof of lemma  [ lem - rect ] .",
    "it is clear that given a wang @xmath9-tiling of the rectangle @xmath6 with boundary , we will get an @xmath2-tiling of @xmath173 .",
    "indeed , simply take the unique tiling of @xmath117 as afforded by sublemma  [ sl : unique - rect ] , scale by a factor of @xmath106 , and then shift each @xmath132 tile to the right and down by @xmath165 if it represents @xmath166 , and adjust the other tiles in the obvious way .",
    "conversely , if we are given an @xmath2-tiling of @xmath173 , we wish to recover the @xmath9-tiling of @xmath6 .",
    "this is achieved using the following two sublemmas , both of which are clear when all numbers are considered in base @xmath175 ; we omit the ( easy ) details .",
    "the equation @xmath176 does not admit a solution in @xmath177 .",
    "therefore each @xmath132 tile will shift to the right and down ( as opposed to shifting left or up ) , and hence indeed represents a wang tile @xmath166 for some @xmath90 .",
    "the equation @xmath178 does not admit solutions in @xmath177 except if @xmath179 or @xmath180 .",
    "if a @xmath132 tile representing @xmath181 is to the right of a @xmath132 tile representing @xmath166 , then @xmath172 must be in @xmath2 . by the sublemma above , the differences @xmath182 are all distinct ( recall that the wang relations are irreflexive , so @xmath179 does not happen ) , therefore we must have had @xmath170 as part of the wang relation .",
    "similarly for the vertical wang relation @xmath53 .",
    "so by reading off the associated tile @xmath166 from the shifts of each @xmath132 tile , we get a wang @xmath9-tiling of  @xmath6 .",
    "this completes the construction of  @xmath117 for the case when @xmath6 is a rectangle . for the general case , when @xmath6 is a simply connected region",
    ", the proof follows verbatim after replacing @xmath173 and @xmath117 by appropriate regions .",
    "it remains to get the upper bound estimates on the number of rectangles involved in the construction .",
    "suppose we are given a set of @xmath48 ordinary wang tiles using @xmath44 colors ( on the boundary ) .",
    "by lemma  [ lem - reduction ] we can equivalently consider a set of less than @xmath183 relational wang tiles . to satisfy irreflexivity",
    ", we might need to double the set of tiles , resulting in @xmath184 tiles .",
    "when making @xmath2 , we will have one each of @xmath145 and @xmath132 tiles .",
    "there will be @xmath185 perturbed @xmath142 tiles and at most @xmath186 perturbed @xmath146 and @xmath159 tiles each . in total , @xmath187 this concludes the proof of lemma  [ lem - rect ] .",
    "in the proof of lemma  [ lem - wang ] in section  [ s : first - reduction ] , we constructed the set @xmath9 of @xmath45 generalized wang tiles using  @xmath47 colors , such that simply connected @xmath9-tileability is -complete .",
    "it remains to count the total number of rectangles we obtain from the series of reduction constructions .",
    "first , we compute the number of ordinary wang tiles given by the transformation in lemma  [ lem - reduction ] . observe that the total area of tiles in  @xmath9 is @xmath188 .",
    "therefore we can break them into @xmath46 ordinary wang tiles by adding @xmath189 more colors .",
    "but as these colors do not appear on the boundary , they need not be counted .",
    "hence , in lemma  [ lem - rect ] , we can take @xmath190 and @xmath191 , thus giving us at most @xmath0 rectangles .",
    "first , note that the reduction in the proof of theorem  [ thm - rect ] is parsimonious .",
    "however , there seems to be no -completeness result for the # cubic monotone @xmath3-in-@xmath4 sat problem .",
    "this is easy to fix by making a similar reduction from the 2sat problem , whose associated counting problem is -complete ( see @xcite ) .",
    "an instance of 2sat is a set of variables and a collection of clauses .",
    "each clause is a disjunction of two literals , where each literal is either a variable or a negated variable .",
    "the problem is to decide whether there is a satisfying assignment such that each clause has at least one true literal .",
    "we modify the proof of lemma  [ lem - wang ] to obtain a parsimonious reduction from 2sat . by replacing the two variations of the variable tile by the ones shown in figure  [ fig:2sat - v ]",
    ", we may set up unnegated and negated copies of a single variable .",
    "indeed , with a sequence of @xmath192 as colors on the left vertical edge , we create a list of @xmath193 variables , where the last @xmath142 are negated . by replacing the three variants of the clause tile by the three obvious candidates in figure  [ fig:2sat - c ]",
    ", we force each clause to be satisfied .",
    "note that the modified tileset has a smaller total area , and has the same number of colors used on the boundary .",
    "therefore as in the proof of theorem  [ thm - rect ] , we apply lemma  [ lem - rect ] to conclude that @xmath0 rectangles suffice .",
    "[ [ ss : fin - levin ] ]      a version of lemma  [ lem - wang ] was first announced in levin s original 1973 short note regarding -completeness  @xcite , but the proof has never been published .",
    "although we were unable to find in the literature an explicit construction for either lemma  [ lem - wang ] or , equivalently , of theorem  [ thm - ordinary ] , we do not claim this result as ours , since it became a folklore decades ago .",
    "we include the proof for completeness , and since we need an explicit construction .",
    "an alternative proof is outlined in subsection  [ ss : fin - moore ] below .",
    "let us mention that using  @xcite , the number of tiles in theorem  [ thm - ordinary ] can be reduced to  @xmath194 , but this reduction has no effect on the number of tiles in the main theorems .",
    "indeed , theorem  [ thm - ordinary ] is an immediate corollary of lemma  [ lem - wang ] , which is the one needed in the proof of main theorems  [ thm - rect ] and  [ thm - sharp ] .",
    "our proof of lemma  [ lem - wang ] is completely elementary and yields explicit bounds ( see also subsection  [ ss : fin - levin ] ) .",
    "let us sketch an alternate proof of the lemma , using a non - deterministic _ universal turing machine _ ( utm ) .",
    "it was suggested to us by cris moore .",
    "fix some non - deterministic universal turing machine  @xmath195 . given two finite tape configurations and a natural number  @xmath122 ( in unary ) , it is -complete to decide whether  @xmath195 transforms the first tape configuration to the second with  @xmath122 steps of computation . fix a finite set @xmath9 of wang tiles that simulate the space - time computation diagram of  @xmath195 ( see _ e.g. _",
    "@xcite ) . encode the given tape configurations as the top and bottom boundaries of a rectangular region with height  @xmath122 .",
    "this region is tileable by @xmath9 if and only if  @xmath195 transforms the first tape configuration to the second in precisely  @xmath122 steps .",
    "the details are straightforward .",
    "note that this method also proves the counting result .",
    "indeed , one can devise a utm so that there is a bijective correspondence between the accepting paths of the utm and of the turing machine it is simulating .",
    "the proof of lemma  [ lem - wang ] constructs a set of @xmath45 generalized wang tiles ( @xmath46 ordinary wang tiles ) .",
    "however , it is possible to decrease these numbers by elementary means .",
    "after this paper was written , a modified construction by gnter rote and the second author improves the number of generalized wang tiles in lemma  [ lem - wang ] to  @xmath196 , which amounts to @xmath197 ordinary wang tiles . with other technical improvements",
    "this does reduce the @xmath0 bound in theorem  [ thm - rect ] to a much friendlier  @xmath198 .",
    "the details are given in  @xcite .",
    "we do not know if this approach leads to improvements in the number of wang tiles in the lemma , as this would depend on the smallest utm .",
    "given an @xmath199-state @xmath200-symbol turing machine with @xmath48 instructions , the standard construction of wang tiles to simulate such a turing machine yields more than @xmath201 tiles . as a perspective , among the smallest known utms , this minimum is achieved by rogozhin s @xmath202-state @xmath203-symbol machine with @xmath204 instructions , which already yields more than @xmath205 tiles  @xcite ( see also  @xcite ) .",
    "unless a substantial progress is made in finding small utms , our elementary proof still gives better bounds .      in the tiling literature ,",
    "the original theoretical emphasis was on tileability of the plane , the decidability and aperiodicity .",
    "the problem was often stated in the equivalent language of wang tiles  @xcite .",
    "unfortunately , there does not seem to be any standard treatment of the _ finite wang tiling _ problems .",
    "although some equivalences in the lemma  [ lem - reduction ] are routine , such as the reduction in figure  [ iii - iv ] , others seem to be new .",
    "we present full proofs for completeness .",
    "historically , finite tilings were a backwater of the tiling theory , with coloring arguments being the only real tool  @xcite . on a negative ( complexity ) side , originally , the tileability problem was studied for general regions , where the tiles were part of the input .",
    "the -completeness of this most general problem is given in  ( * ? ? ?",
    "* @xmath206gp13 ) .",
    "when the set of tiles is fixed , -completeness was shown for general regions and various fixed small sets of tiles ( see  @xcite and  @xcite building on the earlier unpublished work by robson ) .    on the positive side , papers of thurston  @xcite and conway & lagarias",
    "@xcite introduced the _",
    "height function _ and the _ tiling group _ interrelated approaches . the key underlying idea is the use of combinatorial group theory applied to the boundary word of the _ simply connected regions _ , so the tilings become _ van kampen diagrams _ of the corresponding tiling group .",
    "this approach allowed numerous applications to perfect matchings  @xcite , tile invariants  @xcite , tileability  @xcite , various local move connectivity results  @xcite , classical geometric problems  @xcite , applications to colorings and mixing time  @xcite , _",
    "etc_. more relevant to this paper , the breakthrough result by c.  and r.  kenyon  @xcite proved that tileability with bars of simply connected ( s.c . )",
    "regions can be decided in polynomial time .",
    "this result was further extended to all pairs of rectangles by rmila in  @xcite , and by korn  @xcite to an infinite family of _ generalized dominoes_. our main theorem puts an end to the hopes that these results can be extended to larger sets of rectangles .",
    "note also that having s.c .",
    "regions gives a speed - up for polynomial problems .",
    "for example , domino tileability is a special case of perfect matching , solvable in quadratic time on all planar bipartite graphs  @xcite .",
    "however , thurston s algorithm is linear time ( in the area ) , for all s.c .",
    "regions ( see  @xcite ) .",
    "we conjecture that in the main theorem ( theorem  [ thm - rect ] ) , the number of rectangles can be reduced down to  3 , thus matching the lower bound ( rmila s tileability algorithm for the case of two rectangles ) . as a minor supporting evidence in favor of this conjecture ,",
    "let us mention that the proofs in  @xcite are crucially based on _ local move connectivity _ , which fails for three general rectangles . in the absence of algebraic methods , there seem to be no other ( positive ) approach to tileability .",
    "note that theorem  [ thm - lmp ] has linear time complexity for the rectangular regions written _ in binary_. this result is based on the pioneer results by barnes  @xcite applying commutative algebra , the _ finite basis theorem _  @xcite ( see also  @xcite ) , and the _ transfer matrix method _ ( see _ e.g. _  ( * ? ? ?",
    "* ch .  4 ) ) .",
    "it seems , tilings of rectangles have additional structure , which general regions do not have .",
    "see _ e.g. _",
    "@xcite for assorted results on the subject . on the other hand ,",
    "when the tiles are part of the input , deciding tileability can be -hard , and the proof can be used to show that counting tilings is -hard . note that the results in  @xcite only discuss tileability , not counting",
    ". it would be interesting to obtain general results on the local move connectivity and hardness of counting results for tilings of rectangular regions with rectangles .",
    "although counting perfect matchings in general graphs is -complete , for the grid graphs a _ pfaffian formula _ gives a count for the number of domino tilings for any ( not necessarily simply connected ) region ; this formula can be applied in polynomial time  @xcite ( see also  @xcite ) . in a different direction , moore and robson  @xcite conjecture that already for two bars , the problem is -complete for general regions .",
    "they note that the corresponding reductions in  @xcite are not parsimonious .",
    "thus , until now , the -completeness was open for any finite set of rectangular tiles , even for general regions .",
    "we make a stronger conjecture that for every tileset @xmath1 of two bars @xmath209 $ ] and @xmath210 $ ] , where @xmath211 , @xmath212 , the counting of tilings by  @xmath1 of simply connected regions is -complete . in particular , the number  @xmath0 in theorem  [ thm - sharp ] can be decreased to  2 .",
    "there is no direct evidence in favor of this , except that the general combinatorial counting problems tend to be -complete unless there is a special algebraic formula counting them .",
    "furthermore , when it comes to tile counting , there seem to be no direct benefit of simple connectivity of the regions , so such result is likely to be equally hard as for general regions .",
    "we refer to  @xcite for the introduction and references .      by a simple modification of the wang tiles ,",
    "we can also get a parsimonious reduction from  sat .",
    "for that , first , we can introduce wire splitters and the not gate . by doing so ,",
    "we remove the `` cubic '' and `` monotone '' constraints , respectively .",
    "these would play the same role as crossover tiles , and require a separate color on the boundary for each .",
    "this would also increase the set of tiles by introducing new variants for the  @xmath53 and  @xmath77 tiles as well .",
    "we omit the details .",
    "we can then introduce the and gate in a similar fashion , again with a new control color on the top and new versions of the  @xmath53 ,  @xmath16 and  @xmath77 tiles .",
    "this gives the embedding of sat .",
    "this reduction is parsimonious in the same way as the reduction in theorem  [ thm - sharp ] , which implies that the associated counting problem is also -complete .",
    "let us compute the total number of rectangles necessary for this construction .",
    "first , this would increase the number of wang tiles from @xmath45 to no more than @xmath213 .",
    "then , the same argument as above gives the @xmath214 bound in the number of rectangular tiles .",
    "we omit the ( easy ) calculation and details .",
    "the reductions in this paper can be used to prove _ uniqueness _ results on tileability with rectangles , i.e.  whether there exists a unique tiling of a region with a given set of rectangular tiles . in  @xcite",
    ", the problem was completely resolved in the case of two bars .",
    "an even simpler solution follows from  @xcite in this case .",
    "since all tilings are local move connected , taking the `` minimal tiling '' constructed by the algorithm in  @xcite and trying all potential moves gives an easy polynomial time test .",
    "more generally , rmila  @xcite showed that for two general rectangles one can go from one to another with certain non - local moves which are easy to describe .",
    "again , since he produces the `` minimal tiling , '' his algorithm can be used to decide unique tileability with two rectangles .    now , our approach , via reduction from the general sat problem ( see above ) shows that for a certain finite set of rectangles , uniqueness of tilings of a simply connected region is as hard as unique sat , which is -np - hard and has been extensively studied  @xcite .",
    "this seems to be the first result of this type .",
    "although theorem  [ thm - lmp ] extends directly to bricks in higher dimensions  @xcite , this is an exception rather than the rule .",
    "in fact , we recently showed that almost no other positive tileability results extend to higher dimensions , even thurston s algorithm mentioned above ( see  @xcite ) .",
    "* acknowledgements .",
    "* we are grateful to alex fink , jeff lagarias , leonid levin , cris moore , gnter rote , and damien woods for helpful conversations at various stages of this project .",
    "we also thank the anonymous referees for attentive reading and useful comments on previous versions of this paper .",
    "the first author is partially supported by the nsf and bsf grants .",
    "the second author is supported by the nsf under grant no ."
  ],
  "abstract_text": [
    "<S> in  @xcite , it was shown that tiling of general regions with two rectangles is np - complete , except for a few trivial special cases . in a different direction , rmila  @xcite showed that for simply connected regions by two rectangles , the tileability can be solved in quadratic time ( in the area ) . </S>",
    "<S> we prove that there is a finite set of at most @xmath0 rectangles for which the tileability problem of simply connected regions is -complete , closing the gap between positive and negative results in the field . </S>",
    "<S> we also prove that counting such rectangular tilings is -complete , a first result of this kind . </S>"
  ]
}