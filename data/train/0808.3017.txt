{
  "article_text": [
    "computations in the field of molecular dynamics typically require a large computational effort due to two factors :    1 .",
    "small time steps are required to resolve the fast atomic oscillations .",
    "large systems are obtained due to the large amount of atoms which have to be computed .",
    "a wide variety of methods has been developed to remedy these problems .",
    "larger time steps are admitted e.g.  by smoothing algorithms , which average in time over the fast oscillations .",
    "various other methods reduce the degrees of freedom , e.g.  multipole methods @xcite in the context of long range particle interactions . in this paper",
    "we investigate whether the method of optimal prediction , as presented and analyzed in @xcite , can in principle be applied to problems in molecular dynamics in order to reduce the number of atoms to be computed . as a first step in this investigation we confine to a one dimensional model problem which inherits particular properties from a real molecular dynamics problem .",
    "in section  [ sec : problem_description ] we present the real problem as it arises in applications , and derive the simplified model problem .",
    "the considered problem is hamiltonian , hence in section  [ sec : optimal_prediction ] we present the method of optimal prediction in the special case of hamiltonian systems . in section  [ sec : op_applied ] we apply the method of optimal prediction to the model problem .",
    "this yields expressions involving high dimensional integrals .",
    "we evaluate these integrals by asymptotic methods , employing the fact that the process is running at a low temperature , which yields a new and smaller system . section  [ sec : speedup ] deals with the numerical speed - up . in section  [ sec : comparing_systems ] we define criteria , how to investigate whether the new system is a valid approximation to the original system .",
    "we show how important statistical quantities , such as diffusion constants and energy fluctuations , can be obtained by numerical experiments .",
    "these are presented in section  [ sec : numerical_experiments ] , and we investigate under which conditions optimal prediction preserves the relevant statistical quantities .",
    "in the production of semiconductors a thin layer ( a few atomic monolayers ) of copper has to be coated ( sputtered ) onto a silicon crystal .",
    "a technical description of the process can be found in @xcite .",
    "important for the quality of the product is that copper atoms must not penetrate too deeply into the silicon crystal .",
    "the copper atoms penetrate firstly by their kinetic energy when hitting the crystal surface , secondly by the process of _ atomic hopping _ , which will be described in the following . in order to obtain specific knowledge about these processes , molecular dynamics simulations have to be carried out , as described in @xcite .",
    "one important aspect of the coating process is that the system is out of its thermodynamical equilibrium only for very short times , namely for about @xmath0 seconds after one copper atom has hit the surface of the silicon crystal . during this time the copper atom penetrates into the crystal and sonic waves",
    "transport the impact energy away to the bottom of the crystal , which is constantly being cooled . hence , after @xmath0 seconds the whole crystal is in equilibrium again . on the other hand ,",
    "the time between two copper atoms hitting the crystal surface is on a time scale of @xmath1 seconds , i.e.  the system is in equilibrium nearly all the time , in particular the temperature is constant with respect to space and time .",
    "however , even in the state of thermodynamical equilibrium single copper atoms can change their position in the silicon crystal by hopping events , i.e.  a copper atom gains by accident enough energy to overcome the potential barrier between two layers in the silicon crystal and thus hops to a neighboring cell . by atomic hopping copper atoms can penetrate much deeper into the silicon crystal as their impact energy would allow , hence the process in equilibrium can not be omitted from the computation .",
    "the average time between two hopping events is on a time scale of @xmath2 seconds , while the fast atomic oscillations happen on a time scale of @xmath3 seconds .    in this paper",
    "we show how the method of optimal prediction can be applied to the system in equilibrium .",
    "only the atoms at the top layers of the crystal , where copper atoms can be found , are computed exactly , while the silicon atoms in the lower layers are kept track of only in an average sense . in order to keep the technical difficulties at a minimum",
    ", we set up a one dimensional model problem which simulates atomic hopping .      in the model problem , we assume two major simplifications :    * focus on a one dimensional problem , i.e.  we consider @xmath4 atoms lined up like beads on a cord . a single copper atom is inserted into a line of @xmath5 silicon atoms .",
    "* the potential @xmath6 depends only on the pairwise distances of the atoms , i.e. @xmath7 here @xmath8 , where @xmath9 is the potential between two silicon atoms and @xmath10 is the potential between the copper atom and a silicon atom .     between copper and silicon ]     between copper and silicon",
    "]    figures  [ plot_graph_pot_sisi.eps ] and [ plot_graph_pot_cosi.eps ] show the pair potentials @xmath9 and @xmath10 .",
    "the distance is given in  ( @xmath11 m ) and the energy in ev ( @xmath12j ) .",
    "the potentials are chosen to be close to the corresponding lennard - jones potentials @xcite in three space dimensions , in particular for @xmath9 the position of the minimum ( @xmath13 ) and the energy at the minimum ( @xmath14 , where @xmath15 ) are chosen to fit the correct values given in @xcite . in reality , hopping between two silicon atoms happens many times less likely than a copper hopping event .",
    "hence , we neglect silicon hopping in the model problem and choose @xmath9 to be infinite at the origin .    on the other hand , the pair potential @xmath10 between copper and silicon",
    "is set to be finite at distance @xmath16 , in order to allow copper hopping .",
    "while in a three dimensional crystal a copper atom hops through one face of a crystal cell , in one space dimension the copper atom can only hop directly over a silicon atom in order to change its position in the crystal .",
    "additionally , the value at distance @xmath16 is significantly lowered compared to the potential barrier set up by a face of a three dimensional silicon crystal .",
    "this makes hopping events much more frequent and thus reduces the simulation time required for observing hopping events .    in order to further increase the hopping rate",
    ", we increase the temperature significantly .",
    "the real process is taking place at temperatures around @xmath17 .",
    "we run the simulations at a temperature of @xmath18 , which is the maximum temperature that we can still call `` low '' . in this context",
    "a temperature being `` low '' means that the the dimensionless quantity @xmath19 is a small number . for real temperatures one obtains @xmath20 , for the increased temperature @xmath21 .",
    "consequently , any result obtained for increased temperatures can be expected to work even better at real temperatures .    in the following",
    ", we will always assume our system to behave as an ergodic system .",
    "in particular this means that we assume space averages over a number of atoms to be equal to time averages over a given time span .",
    "optimal prediction was introduced by chorin , kast and kupferman @xcite as a method to apply to _ underresolved computation _ , i.e.  to problems which are computationally too expensive or where not enough data is at hand , but prior statistical information is available .",
    "sought is the mean solution of a system , where only part of the initial data is known , and the rest is sampled from an underlying measure . while the method is in principle not restricted to a particular measure , in equilibrium statistical mechanics one typically chooses the grand canonical distribution .",
    "optimal prediction approximates the mean solution by a new system which is smaller , and thus cheaper to compute , than the original system . in this paper",
    "we will use a simple optimal prediction system to consider only a smaller number of atoms and `` averaging '' the other ones away . note that optimal prediction is by no means restricted to hamiltonian systems , but for such systems",
    "it has some particularly nice properties .",
    "consider a @xmath22-dimensional hamiltonian system of ordinary differential equations @xmath23 with the hamiltonian function @xmath24 representing an @xmath4-particle system in one space dimension . in the following",
    ", we will consider the model problem in equilibrium , hence we assume the position in state space to be distributed according to the grand canonical distribution @xmath25 here @xmath26 is a constant with @xmath27 being the boltzmann constant , @xmath28 the ( constant ) temperature of the process , and @xmath29 is a normalization constant .",
    "we write the solution of ( [ hamiltonian_system ] ) as a phase flow , where @xmath30 denotes the solution to the initial condition @xmath31 .",
    "consequently , system ( [ hamiltonian_system ] ) can be rewritten as @xmath32 assume that only @xmath33 of the @xmath4 atoms are of interest , which yields a separation of the degrees of freedom into two groups @xmath34 , where @xmath35 represents the atoms of interest , and @xmath36 corresponds to the @xmath37 atoms which should be considered only in an averaged sense .",
    "let in the following @xmath38 denote the number of averaged atoms .",
    "typically , @xmath33 is significantly smaller than @xmath4 .",
    "note that in our model problem silicon atoms can not hop , hence this separation stays valid over time , given the copper atom stays among the silicon atoms of interest .",
    "now only part of the initial conditions @xmath39 , namely the ones corresponding to the variables which are of interest @xmath40 , are known , while the other components @xmath41 are not known exactly .",
    "instead , for each choice of @xmath42 they are sampled from the conditioned measure @xmath43 where @xmath44 is the appropriate normalization constant . as in @xcite",
    "we use the conditional expectation projection of a function @xmath45 @xmath46     = \\frac{\\int u({\\hat{x}},{\\tilde{x}})e^{-\\beta h({\\hat{x}},{\\tilde{x}})}d{\\tilde{x}}}{\\int e^{-\\beta h({\\hat{x}},{\\tilde{x}})}d{\\tilde{x}}}. \\label{def_cond_exp}\\ ] ] optimal prediction as presented in @xcite is interested in the first @xmath47 components of the mean solution of ( [ equations_of_motion ] ) , where the initial conditions @xmath42 are fixed and @xmath48 are sampled from ( [ conditioned_measure ] ) @xmath49 = \\frac{\\int{\\varphi}(({\\hat{x}},{\\tilde{x}}),t)e^{-\\beta h({\\hat{x}},{\\tilde{x}})}d{\\tilde{x}}}{\\int e^{-\\beta h({\\hat{x}},{\\tilde{x}})}d{\\tilde{x}}}. \\label{mean_solution}\\ ] ] for linear systems , expression ( [ mean_solution ] ) can be computed exactly , and it does not decay . in molecular dynamics , however , the hamiltonian system is in general nonlinear . as observed in @xcite , for nonlinear systems , the mean solution decays , which is interpreted as a loss of information as the first @xmath47 variables tend to the thermodynamical equilibrium . in @xcite",
    "the authors give a deeper physical reasoning for the decay .",
    "an application of the mori - zwanzig formalism as in @xcite yields the formal explanation .    for each choice of @xmath42 the mean solution ( [ mean_solution ] )",
    "can be approximated by monte - carlo sampling , i.e.  sampling @xmath50 times @xmath48 from the conditioned measure ( [ conditioned_measure ] ) , solving @xmath50 times the system ( [ equations_of_motion ] ) with initial values @xmath51 , and averaging over all solutions .",
    "obviously , this is more expensive than solving the original system itself .    in @xcite the term",
    "_ first order optimal prediction _ has been assigned to idea of applying the conditional expectation projection @xmath52 to the right hand side @xmath53 @xmath54 , \\label{pr}\\ ] ] which yields a function of just @xmath47 variables .",
    "hence , @xmath55 is a function from @xmath56 to @xmath56 .",
    "the first order optimal prediction system is defined as @xmath57 an important result , which allows to restrict to considering the hamiltonian function only , is the following    [ thm_op_hamiltonian ] if a system is hamiltonian , then its optimal prediction system is also hamiltonian with the hamiltonian function @xmath58 here @xmath59 is a constant with unit @xmath60=[{\\tilde{q}}]\\cdot[{\\tilde{p}}]={\\left(kg\\frac{m^2}{s}\\right)}^l$ ] .",
    "the exact value of @xmath59 is of no importance for the dynamics .",
    "this theorem implies that for nonlinear problems first order optimal prediction is never a good approximation for long times , since the mean solution decays , i.e.  loses energy , while the first order optimal prediction system is hamiltonian , and thus energy preserving . in @xcite _ higher order optimal prediction _ methods have been derived , which reproduce the desired decay of the mean solution .",
    "however , in our case , we are not interested in the mean solution , but in a @xmath47-dimensional system , which yields the same behavior of the first @xmath33 atoms as the full @xmath22-dimensional system would have yielded .",
    "this does not necessarily require a good approximation in the sense of trajectories ( which the mean solution focuses on ) , but the relevant statistical quantities should be the recovered . in particular , the @xmath47-dimensional system should be hamiltonian again . hence , we choose the first order optimal prediction system as the sought @xmath47-dimensional system .",
    "of course this choice can only be reasoned , if it turns out that the relevant statistical quantities are indeed preserved .",
    "we will focus on this question in sections  [ sec : comparing_systems ]  and  [ sec : numerical_experiments ] .",
    "as the pair potentials @xmath9 , @xmath10 vanish at infinity , the expression @xmath61 is not finite .",
    "hence , the canonical measure @xmath62 does not make sense as a probability distribution if the particle positions are not restricted in some way . in many text books on statistical mechanics",
    "the whole system is put into a box of finite volume , i.e.  @xmath63^n$ ] , where @xmath64 is suitably large .",
    "this essentially means that all atoms are trapped , but no ordering is specified . in our model problem , however , the silicon atoms are ordered , and since silicon atoms can not hop over each other , this order stays valid over time .",
    "this is an information which we do not wish to average out .",
    "hence , we restrict the position vector @xmath65 to the domain @xmath66^n | q_2<\\dots < q_n\\}. \\label{domain_ml}\\ ] ] here @xmath67 is the position of the copper atom , which can be anywhere in @xmath68 $ ] , as it can hop freely .",
    "the positions of the silicon atoms @xmath69 , however , are restricted to be ordered from left to right . with respect to optimal prediction ,",
    "the domain @xmath70^l | q_m < q_{m+1}<\\dots < q_n\\}\\ ] ] has to be introduced . for each fixed position vector @xmath71 the other @xmath72 silicon atoms @xmath73",
    "are restricted to be positioned right of the first @xmath33 atoms , and ordered .",
    "this setup assumes that the copper always stays among the first @xmath33 atoms .",
    "when considering the optimal prediction hamiltonian ( [ op_hamiltonian ] ) as given by theorem  [ thm_op_hamiltonian ] , one can easily check that the kinetic and potential energy separate @xmath74 here @xmath75 and @xmath76 are constants with units @xmath77 = \\textrm{kg}\\frac{\\textrm{m}}{\\textrm{s}}$ ] and @xmath78 = \\textrm{m}$ ] . since",
    "@xmath79 , the first term of ( [ op_hamiltonian_splitted ] ) can be computed directly as @xmath80 where the constant @xmath81 is of no relevance for the dynamics .",
    "hence , with respect to the momenta applying first order optimal prediction means omitting the momenta @xmath82 . for the potential @xmath83 , however , life is far from being as easy as for the kinetic energy @xmath28 , as the @xmath84-variables do not separate and are no quadratic functions .",
    "thus , an analytic evaluation of the first order optimal prediction potential @xmath85 is in general impossible , or at least too complicated to be of any use .",
    "hence , we employ an asymptotic expansion of @xmath85 .",
    "the dimensionless quantity @xmath86 is small for low temperatures .",
    "the optimal prediction potential expressed in terms of the quantity @xmath87 is @xmath88 where @xmath89 is the potential normalized in such a way , that the potential of two atoms at equilibrium distance has the value -1 .    using _",
    "laplace s method for integrals of real variables _",
    "@xcite , one can find an asymptotic approximation to ( [ op_v_normalized ] ) for @xmath87 small . in some textbooks",
    "this method is also referred to as _",
    "watson lemma_. assume for the moment that for a fixed choice of @xmath90 the function @xmath91 has a unique global minimizer @xmath92 with respect to @xmath73 , and that the hessian at this point @xmath93 is regular .",
    "in the following derivation we use the abbreviatory notations @xmath94 and @xmath95 .",
    "laplace s method approximates @xmath91 by a quadratic function located at the minimum , yielding the following asymptotic approximation for @xmath96 @xmath97 extending the set of integration to the whole @xmath98 is valid , since the minimum is always in the interior of @xmath99 , provided @xmath64 is large enough ( see @xcite ) .",
    "since @xmath100 is assumed to be regular , the transformation rule yields @xmath101 given @xmath102 is of class @xmath103 ( which is the case in our model problem ) , the complete asymptotic expansion including the error term is @xmath104 which follows directly from the one dimensional case as shown in @xcite . substituting ( [ asymptotic_expansion_inside ] ) into ( [ op_v_normalized ] ) , and employing that @xmath105 as @xmath106 yields @xmath107 where the constant @xmath108 is of no relevance for the dynamics .",
    "hence , we found a zeroth and a first order asymptotic expansion in @xmath87 for @xmath109 , which  returning to long notation ",
    "are @xmath110 note that @xmath111 and @xmath112 approximate @xmath109 only up to constants , which are irrelevant for the acting forces .",
    "whenever in the following we speak of @xmath113 approximating @xmath109 , we always mean : `` up to constants '' .    the above assumptions , that @xmath91 has a unique global minimizer @xmath114 with respect to @xmath73 , and that the hessian at this point @xmath93 is regular , can be observed to be guaranteed for our model problem , given one restricts to the domain @xmath99 .",
    "both assumptions can be relaxed for the zeroth order expansion , i.e.  also in the case of multiple minimizers or a singular hessian the zeroth order expansion stays valid .",
    "the zeroth order approximation @xmath111 ( [ asymptotic_expansion_zeroth_order ] ) is the limit of @xmath109 ( [ op_v_normalized ] ) as @xmath96 , i.e.  @xmath115 .",
    "hence , we call @xmath111 the _ zero temperature limit potential_. since the dynamics takes place at low temperatures , one can expect the correct optimal prediction potential function @xmath109 to be close to the zero temperature limit potential @xmath111 .",
    "hence , we run the low temperature optimal prediction dynamics , which would be correctly described by @xmath109 , with the zero temperature limit dynamics given by @xmath111 .",
    "we do not consider the first order approximation ( [ asymptotic_expansion_first_order ] ) here , since the hessian @xmath93 can not be included in a straightforward manner into the following derivation .",
    "the results in subsection  [ subsec : energy_fluctuations ] , however , will show that further investigation on the first order expansion could be worthwhile .    by going over from @xmath109 to @xmath111",
    "we have formally replaced an @xmath72-dimensional integration by an @xmath72-dimensional minimization problem . at first glance",
    "this is no real improvement , since high dimensional global minimization is also computationally expensive ( see @xcite ) .",
    "however , the @xmath72-dimensional minimization means nothing else than placing @xmath72 further atoms , such that the total potential energy is minimized .",
    "since @xmath111 is formally @xmath33-dimensional , we call the @xmath72 new atoms _ virtual atoms_. the restriction to the domain @xmath99 in subsection  [ subsec : domains_of_integration ] guarantees that the @xmath72 virtual atoms are separated from the @xmath33 `` real '' atoms",
    ".      the zero temperature limit hamiltonian is @xmath116 where @xmath117 is a diagonal matrix containing the masses @xmath118 of the atoms @xmath119 . in the following we assume @xmath120 and @xmath114 to be of class @xmath121 .",
    "this allows to compute @xmath122 note that @xmath123 is zero , since @xmath114 is the minimizer of @xmath124 .",
    "still , expression ( [ equations_of_motion_q ] ) involves a minimization problem , in order to place the virtual atoms .",
    "we circumvent the minimization by deriving equations of motion for the virtual atoms , too . in order to obtain the expression @xmath125",
    ", we define @xmath126 since @xmath114 is always chosen to minimize @xmath83 , we have that @xmath127 . thus @xmath128 solving ( [ minimize_v ] ) for @xmath125 yields an expression which can be substituted into the time evolution @xmath129 .",
    "this yields a closed system for the zero temperature limit optimal prediction dynamics @xmath130 where initially @xmath131 and @xmath132 and @xmath133 is chosen such that @xmath134 is minimal , which can be resolved by a few newton steps .",
    "since the virtual atoms always follow the minimum of the potential energy , no momenta are required to describe their movement .",
    "hence , system ( [ complete_equations_of_motion ] ) is just @xmath135-dimensional , instead of @xmath22-dimensional .",
    "it is a closed system of ordinary differential equations , and the right hand side requires no integration or minimization .",
    "still , there is an @xmath72-dimensional linear system of equations to be solved . at this point",
    ", we can employ the special structure of the potential energy ( [ potential_energy ] ) in our problem .",
    "assume that the pair potentials @xmath9 , @xmath10 reach over only @xmath136 ( in our model problem @xmath137 ) equilibrium distances @xmath138 . in the following derivation , we assume the potentials to really vanish at greater distances .",
    "the derived results hold approximately also for potentials which are negligibly small at greater distances .",
    "consequently , only the first @xmath136 virtual atoms @xmath139 actually have to be computed .",
    "the others will align equidistantly right to the first @xmath136 ones . since one atom has no influence on atoms more than @xmath136 equilibrium distances away , only @xmath140 virtual atoms need to be considered , where the last @xmath136 ones are aligned equidistantly .",
    "as we are interested in the case @xmath141 , enough virtual atoms are present , such that boundary effects can be neglected .",
    "let the positions of the @xmath142 virtual atoms be denoted by @xmath143 where @xmath144 and @xmath145 with @xmath146 .",
    "the time derivative is @xmath147 in this setup the matrices in ( [ complete_equations_of_motion ] ) take a special structure :    * the hessian @xmath148 is a diagonal band matrix with band width @xmath136 . in block form , where each block is of size @xmath149 , it is @xmath150 where @xmath151 is lower triangular and @xmath152 upper triangular . *",
    "the matrix @xmath153 is upper triangular with width @xmath136 , i.e. @xmath154 in block form it can be written as @xmath155 where @xmath156 is an upper triangular @xmath149 matrix .",
    "substituting these special vectors and matrices into the equation for the virtual atoms in ( [ complete_equations_of_motion ] ) yields the following equation of motion in block form @xmath157 which implies the @xmath136-dimensional system for @xmath158 @xmath159 here @xmath160 , where @xmath161 .",
    "the momenta of the last @xmath136 real atoms are denoted by @xmath162 , and @xmath163 is the diagonal matrix containing the corresponding masses .",
    "this relation can be interpreted as a boundary layer condition which acts as if the crystal of silicon atoms was continued to infinity , although it is actually cut off after the @xmath33-th atom .    with the above modifications the zero temperature limit optimal prediction system ( [ complete_equations_of_motion ] ) becomes an explicit @xmath164-dimensional system of equations .",
    "hence , one can expect this system to yield a computational speed - up , depending on the values of @xmath4 , @xmath33 and @xmath136 .",
    "the question of speed - up will be considered in section  [ sec : speedup ] . due to the various approximations in achieving the smaller system it is not at all clear whether the smaller system yields the same dynamics as the original system . in section  [ sec : comparing_systems ] we will compare the new system to the original system and investigate under which conditions the new system reflects the `` correct '' dynamics , and under which conditions it does not .",
    "besides the above physical interpretations , the actual intention was to use optimal prediction as a method to reduce the computational effort . in this section ,",
    "we consider both the version with @xmath72 virtual atoms and the boundary layer version .",
    "we compare the cpu times for computations of the two optimal prediction systems with the cpu time for the corresponding computations of the original system .",
    "the comparison is carried out in dependence of the sizes @xmath4 and @xmath33 . since the original version of optimal prediction",
    "does only replace real atoms by virtual ones , while on the other hand the boundary layer condition version allows to really omit atoms , a significant speed - up can only be expected from the boundary layer condition version .",
    ", title=\"fig : \" ] , title=\"fig : \" ]    ]    the computations were performed on a network of amd athlon-6 1.4 ghz computers .",
    "the boundary layer condition version was computed with @xmath165 virtual atoms .",
    "figure  [ speedup_factors.eps ] shows the speed - up factors with respect to the original system for the two versions of optimal prediction .",
    "the original version of optimal prediction does not yield any acceleration ( the speed - up factors are less than 1 ) . apparently , for our model problem setting up and solving the linear system in ( [ complete_equations_of_motion ] ) is more expensive than computing the full system of equations .",
    "the boundary layer condition version , on the other hand , yields significant speed - up factors for small @xmath33 . in principle",
    ", one can achieve arbitrarily high speed - up factors by keeping @xmath33 and @xmath136 fixed and increasing @xmath4 . in most cases , however , the original crystal size @xmath4 is given a priori , and suitable values for @xmath33 are given by the requirement that the new system must have the same dynamics as the original one , as discussed in section  [ sec : comparing_systems ] .",
    "a choice of @xmath33 which is reasonable in many cases , is cutting the whole crystal of @xmath4 atoms into two halves , i.e.  @xmath166 .",
    "the speed - up factors for the two optimal prediction systems are shown in figure  [ speedup_factors_half.eps ] . while the original version does not reduce the computational effort , the boundary layer condition version yields a good speed - up for larger @xmath4 .",
    "care should be taken when generalizing these results . in our model problem",
    "the potential functions are fairly cheap to evaluate . in more complicated systems",
    "it could very well pay off to solve the linear system in ( [ complete_equations_of_motion ] ) instead , or to solve the minimization problem directly . on the other hand ,",
    "the boundary layer condition version of optimal prediction could possibly fail to work in other applications , e.g.  in three space dimensions .",
    "such questions will have to be investigated when applying optimal prediction to a new problem .",
    "in molecular dynamics trajectories in high dimensional phase space are no appropriate means for comparing two systems , since initial positions and momenta can never be known exactly , and molecular dynamics is typically chaotic .",
    "instead , `` comparing '' means to test whether both systems have similar dynamics .",
    "this is represented by statistical quantities such as time correlation functions , diffusion constants , fluctuations of energy , etc .",
    "we consider the following statistical processes in order to compare the two systems :    * * the distribution of the position the copper atom . *",
    "a copper atom , which is initially located always at the same position , is in the ensemble of many experiments described by a diffusion process , whose distribution can be approximated by monte - carlo sampling .",
    "* * the number of hopping events up to a fixed time . * * * the fluctuation of energy of the first @xmath167 atoms . *",
    "the energy of the first @xmath33 atoms fluctuates around some fixed average .",
    "we consider the variance of the energy over a fixed time interval .",
    "the first two quantities are related to the diffusion of a single copper atom in the silicon crystal due to hopping events .",
    "since copper hopping has been the effect of interest in the first place , it is a natural criterion for comparison .    in molecular dynamics , statistical quantities of ergodic systems",
    "can be computed by long time averaging or monte - carlo sampling . ``",
    "long time averaging '' means running a single computation and using limiting processes to approximate statistical quantities .",
    "important examples , e.g.  for approximating self - diffusion constants @xcite , are the _ green - kubo formula _ @xcite or the _ einstein relation _ , which both approximate ensemble averages for ergodic systems by long time averaging . in our application , however , long - time computations are problematic , since firstly the copper atom may travel to the boundaries of the silicon crystal and secondly sonic waves will come in effect , as shown in section  [ sec : numerical_experiments ] .",
    "hence , we obtain the diffusion constant by monte - carlo sampling instead , i.e.  we solve the same system over and over again with short computation times , where the initial conditions are sampled from the canonical measure .",
    "in other words : we obtain the averaged quantities not by long - time averaging , but by averaging over many samples .",
    "sampling both the initial positions @xmath168 and momenta @xmath169 from the canonical measure @xmath170 would require expensive methods like _ acceptance - rejection methods _ or _ metropolis sampling _",
    "@xcite due to the structure of the potential @xmath6 .",
    "we circumvent such problems by setting the initial positions @xmath168 into the potential minimum and sampling the initial momenta @xmath169 from @xmath171 , which is just sampling independently from gaussian distributions . in our simulations",
    "after about @xmath172 the hamiltonian dynamics has driven the system into equilibrium . additionally , keeping the initial positions fixed automatically guarantees to remain in the correct domain @xmath173 as given by ( [ domain_ml ] ) .",
    "the considered copper diffusion is due to hopping events , while displacements due to short oscillations between the same two silicon atoms are not taken into account .",
    "hence , the corresponding diffusion process is discrete in space on the spatial grid @xmath174 .",
    "let us assume for the moment , that the diffusion process is linear and hence described by a @xmath175-dimensional _ compartment model _",
    "@xmath176 where @xmath177 has column sums equal to zero to ensure mass conservation , i.e.  @xmath178 .",
    "the analytical solution to ( [ cm ] ) is @xmath179 one example for such a process is given by the tridiagonal toeplitz ( up to the boundary entries ) matrix with the stencil @xmath180 , which is a finite difference approximation to the heat equation .",
    "hence , the compartment model ( [ cm ] ) with this matrix converges to the heat equation as @xmath181 .",
    "still , there are many other matrices @xmath182 , whose discrete diffusion processes all converge to the heat equation as @xmath181 .",
    "the hopping behavior of the copper atom can be modeled as a specific random walk .",
    "one important aspect of the copper hopping is that hopping events are _ correlated _ , in the sense that given the copper atom has just hopped , it is much more likely than normally that a second hopping event to the same direction follows , since the kinetic energy is not completely lost in one single jump .",
    "hence , the copper diffusion is formally non - markovian .",
    "still , the hopping can be described as a markovian random walk by assuming hopping events to be uncorrelated , but to allow the copper atom to hop over more than one silicon atom in one single hopping event .",
    "these assumptions lead to a model which is typical in the context of stochastic processes , see  @xcite .",
    "let @xmath183 denote the position of the copper atom at time @xmath184 .",
    "for the @xmath185 hopping event let @xmath186 be the hopping time , @xmath187 the time since the previous hopping event , and @xmath188 the number of silicon atoms which the copper atoms hops over to the right .",
    "here @xmath189 means hopping to the left .",
    "assume now that both the @xmath190 and the @xmath191 are independent and distributed according to @xmath192 here @xmath193 is a parameter controlling the hopping rate ( see @xcite for a derivation ) , and @xmath194 is a non - negative sequence satisfying @xmath195 and the constant @xmath196 is finite . for our model problem",
    "we simply assume @xmath197 . additionally , we restrict to symmetric random walks , which is reasonable as long as the copper atom does not approach the crystal boundaries .",
    "an analysis of the described random walk , following the analysis in @xcite , yields that the variance of the process at time @xmath184 equals @xmath198 .",
    "a comparison with the variance given by the heat equation yields the relation @xmath199 which allows us to speak consistently of a diffusion constant @xmath200 also for the discrete diffusion process ( [ cm ] ) .",
    "as derived in @xcite the probability distribution of the random walk @xmath183 is described by ( [ cm ] ) , where the so called _ infinitesimal generator _",
    "@xmath182 is a band matrix with the stencil @xmath201 .",
    "define @xmath202 as a corresponding band matrix with the stencil @xmath203 , hence @xmath204 .",
    "both matrices have to be changed in the upper and lower rows according to the appropriate boundary conditions .",
    "assume now , that the values @xmath205 are known .",
    "hence , the matrix @xmath202 is completely determined .",
    "let @xmath206 denote the numerically obtained distribution vectors for the position of the copper atom for all times @xmath184 .",
    "initially @xmath207 , as in ( [ cm ] ) .",
    "since it is unclear , whether the diffusion parameter @xmath200 is constant in time , we let it be a time dependent parameter @xmath208 , which we compute at times @xmath209 . for obtaining the value @xmath210 we consider the diffusion on the time interval @xmath211 $ ] , where @xmath212 and @xmath213 .",
    "given @xmath214 is not too large , we can approximately assume the diffusion parameter to be constant on the given interval : @xmath215 .",
    "on @xmath216 we use the data provided by the real evolution @xmath217 to compute an @xmath218-fit of the diffusion parameter @xmath219 with respect to error functional @xmath220 which is particularly stable with respect to errors in @xmath221 due to the monte - carlo sampling .",
    "the time @xmath214 must on the one hand be small enough to justify the approximation that the diffusion parameter is constant on the intervals @xmath216 , on the other hand it must be large enough to have already some diffusion taken place . in subsection",
    "[ subsec : diffusion_parameters ] we compute diffusion parameters for the numerical data obtained for our model problem .",
    "we simulate a crystal of @xmath222 atoms with @xmath223 silicon atoms and @xmath224 copper atom , which starts at the @xmath225 position . for the optimal prediction system ,",
    "we choose @xmath226 .",
    "these are enough atoms such that averaged quantities make sense and one can speak of a thermodynamical equilibrium . additionally , the crystal has a reasonable interior region which is not affected by any boundary effects .",
    "the integration is performed by the classical explicit fourth order runge - kutta method , which we prefer over energy preserving methods in this context , as it allows significantly larger time steps , while still resolving the hopping events accurately .",
    "the integration time step is @xmath227 , and the computation time is @xmath228 , which is short enough , such that the change in total energy due to the integrator is insignificant .",
    "we solve the system @xmath229 times at a temperature @xmath230 , with the initial data sampled as described in section  [ sec : comparing_systems ] . for our experiments ,",
    "monte - carlo estimates yield an expected error in the distribution of about @xmath231 , which is significantly smaller than the difference of any two quantities in comparison .",
    "note that the short computation time @xmath232 allows to exclude any effects caused by sonic waves traveling through the crystal .",
    "the velocity of sound can be estimated as derived in @xcite : the equilibrium distance inside the silicon crystal is approximately @xmath233 . using the _ young modulus _",
    "@xmath234 we obtain a velocity of sound of @xmath235 .",
    "the shortest distance of the copper atom to any boundary in the crystal is @xmath236 in the original system and @xmath237 in the optimal prediction system .",
    "hence , the minimum time a sonic wave takes to travel from a boundary to the copper atom is approximately @xmath238 , which is longer than the computation time @xmath228 . in subsection  [ subsec : sonic_waves ]",
    "we will deal with the case when sonic waves are present .",
    "figure  [ plot_distr_70_orig.eps ] shows the distribution of the position of the copper atom in the silicon crystal when solving the original system .",
    "the analogous distribution for the optimal prediction system looks indistinguishably similar in this kind of plot .",
    "the process is apparently of a diffusive nature , but the diffusion parameter changes with time , as already the evolution of the maximum indicates .",
    "the following analysis will confirm this observation .",
    "the time - dependent relative error between the distributions for the original and the optimal prediction system @xmath239 is less than 3% up to the time @xmath240 and still less than 9% over the complete time interval , which is not overwhelmingly small , but does indicate definite similarities between the two distributions .",
    "we compute the diffusion parameters @xmath208 for the original and the optimal prediction system , using the method described in subsection  [ subsec : model_copper_diffusion ] .",
    "the parameters @xmath241 of the corresponding random walk model are obtained by monte - carlo sampling .",
    "we use the experiments for the original system , which already yielded the distribution shown in figure  [ plot_distr_70_orig.eps ] . in each monte - carlo experiment",
    "we follow the path of the copper atom and cluster consecutive hopping events which happen in an interval of @xmath242 to a single one . prior to this clustering ,",
    "fast double hopping events into opposing directions ,  i.e. those happening inside of @xmath243 , which are solely due to oscillations of silicon atoms , must be excluded .",
    "the times @xmath244 and @xmath245 are suitably chosen for our model problem .    the results of the above described monte - carlo experiments are shown in figure  [ plot_hist_hop.eps ] .",
    "the hopping probabilities are given by the box histogram .",
    "note that due to monte - carlo errors and boundary effects the resulting values are not exactly symmetric . since we wish to consider a symmetric random walk , we choose as @xmath205 the average values of the obtained results .",
    "here , only @xmath246 are greater than zero .",
    "hence , we choose @xmath247 for the computation of the diffusion parameters .",
    "the curve denotes the values @xmath248 ( scaled to fit into the same plot ) , which are relevant , since the variance @xmath249 is proportional to @xmath200 ( see relation ( [ relation_kappa_alpha ] ) ) .",
    "figure  [ plot_graph_kappa.eps ] shows the time - dependent diffusion parameter @xmath208 for the original system and the optimal prediction approximation , computed as described in subsection  [ subsec : model_copper_diffusion ] . in both cases",
    "we choose @xmath250 .",
    "important observations and estimates are :    * the diffusion parameters start with a strong peak , and after @xmath251 they fluctuate around a fixed value of @xmath252 .",
    "this behavior is too pronounced to be only due to monte - carlo and approximation errors .",
    "the initial behavior is most likely due to the fact that the system does not exactly start in its thermodynamical equilibrium .",
    "* considering that @xmath208 shows such pronounced behavior , the two functions @xmath208 for the original system , and @xmath253 for the optimal prediction approximation are remarkably close to each other . up to the time @xmath254 the the distance between the two curves is quite small .",
    "after that time the curves differ more , but show the same features .",
    "after @xmath255 the error takes its maximum , which coincides with the errors observed in the distributions shown in figure  [ plot_distr_70_orig.eps ] .",
    "* in order to roughly estimate whether the obtained diffusion parameter is reasonable , we compare it with a diffusion coefficient measured in a real material . in @xcite the diffusion constant of copper in a silicon crystal at a temperature of @xmath256 is given as @xmath257 . assuming that the diffusion constant depends linearly both on temperature and the potential barrier , as e.g.  with the einstein formula @xcite",
    ", we obtain an estimate @xmath258 for @xmath259 , using the values @xmath260 and @xmath261 . a look at figure  [ plot_graph_kappa.eps ]",
    "indicates that our experimentally obtained diffusion parameters are indeed in this region .      besides diffusion parameters , also the pure number of hopping events which happen up to a given time @xmath232 should be preserved by optimal prediction .",
    "figure  [ plot_graph_histhopp_70.eps ] shows the number of hopping events for the above computation plotted as histograms .",
    "the solid line represents the original system , and the dashed line stands for the optimal prediction system .",
    "the two graphs differ only for the probabilities of zero and one hopping event . apart from that",
    ", one can speak of the same hopping behavior .              while the total energy is constant for the original system as well as for the optimal prediction approximation ,",
    "the energy of the first @xmath33 atoms @xmath262 fluctuates over time .",
    "this expression fluctuates also for the optimal prediction system , since the influence of the virtual atoms is neglected in the potential energy .",
    "the fluctuations in ( [ energy_of_real_atoms_time ] ) represent the exchange of energy between atoms , which is a quantity that should be preserved . since for optimal prediction we consider the energy of exactly the real atoms , this test enlightens the exchange of energy between real and virtual atoms . for each monte - carlo experiment",
    "we consider the variance of ( [ energy_of_real_atoms_time ] ) over time @xmath263 which measures the impact of fluctuation .",
    "hence , we obtain @xmath50 values @xmath264 for both the original system and the optimal prediction approximation .",
    "figure  [ plot_graph_energyfluct.eps ] shows the histogram for the variances @xmath265 for the two systems .",
    "the solid line stands for the original system , and the dashed line corresponds to optimal prediction .",
    "the average energy fluctuations for both systems are denoted by the corresponding vertical lines .",
    "while the average fluctuations are very close for the two systems and the two distributions look similar in principle , they obviously do not coincide . for optimal prediction",
    "most energy fluctuations are stronger than for the original system . on the other hand ,",
    "particularly high energy fluctuations happen more frequently in the original system .",
    "possible physical reasons for this behavior could be :    * the fact , that in optimal prediction most fluctuations are stronger than in the original system might be due to the additional fluctuative _ langevin _ terms , which appear in higher order optimal prediction @xcite . * the high fluctuations in the original system can happen , since around the @xmath266 atom energy can be exchanged freely among a whole cluster of atoms . in the zeroth order approximation to optimal prediction ( [ asymptotic_expansion_zeroth_order ] ) ,",
    "on the other hand , there is no free energy exchange between the virtual atoms , since they have no momentum , but instead always follow the potential minimum . using the first order asymptotic expansion ( [ asymptotic_expansion_first_order ] ) might remedy this problem .",
    "additionally , at correct temperatures ( @xmath267 instead of @xmath230 ) the energy fluctuations in optimal prediction might be much closer to the truth , even for the zeroth order approximation .      in the above experiments care",
    "was taken to exclude sonic waves , which was done by keeping the computation time shorter than a wave would take to travel through half the crystal .",
    "if the computation time is quadrupled and the diffusion distribution analogous to the one shown in figure  [ plot_distr_70_orig.eps ] is computed , one can indeed observe a small antidiffusive peak every @xmath268 , i.e.  in many experiments the copper atom is systematically pushed back to its starting position .",
    "the fact that the above time equals approximately the time a sonic waves takes for traveling from the crystal boundaries to the copper atom gives rise to the assumption that the observed behavior is indeed due to sonic waves .",
    "the relevance of sonic waves for optimal prediction can be seen if one lets a sonic wave run into the boundary between real and virtual atoms .",
    "the wave does not penetrate into the block of virtual atoms , but is being _ reflected _ by them .",
    "hence , optimal prediction simulates a crystal continued to infinity only as long as the system is in thermodynamical equilibrium .",
    "non - equilibrium effects , in particular sonic waves , are not reproduced correctly by the optimal prediction system in the presented form .",
    "indeed , in the presence of sonic waves optimal prediction yields a very different copper diffusion , unlike the experiments where sonic waves were excluded .",
    "thus the influence of non - equilibrium effects has to be considered carefully when optimal prediction is applied to other problems .",
    "in this paper , we applied the method of optimal prediction to a model problem in the context of molecular dynamics , focusing on diffusion due to atomic hopping . employing the fact that the temperature of the process is low , asymptotic methods were applied to evaluate the conditional expectations which arise in optimal prediction .",
    "the zeroth order asymptotic expansion was used to derive a new system of equations , which is formally smaller . since in molecular dynamics potentials",
    "typically range only over short distances , the new system could be cut off after a boundary layer of virtual atoms .",
    "this _ boundary layer condition _ acts as if the crystal was continued to infinity , and yields an obvious computational speed - up for our model problem .",
    "the asymptotic method itself should apply to much more general cases than the specific model problem here .    in order to investigate whether the thus derived system preserves the statistical behavior of the original system , various criteria were introduced and checked by monte - carlo experiments . in particular , the diffusion of a copper atom in the crystal as well as the number of hopping events turned out to be preserved well .",
    "the exchange of energy at the boundary layer was not preserved that well , but this discrepancy could be explained . on the other hand ,",
    "the new system yielded significantly worse results in the presence of non - equilibrium effects , in particular sonic waves , since optimal prediction assumes the system to be in equilibrium .",
    "a natural next step in research on this topic would be to apply the method to a more complex problem , possibly in three space dimensions and with focus on further effects than atomic hopping .",
    "the basic ideas presented in this paper should also apply in three space dimensions , but various aspects will become more problematic . on the other hand , in three space dimensions sonic waves should dissipate faster , and the fraction of atoms which can be averaged out would be larger .",
    "additionally , the relevant statistical quantities should be approximated much better at physically correct temperatures .",
    "an obvious step for deriving a more accurate system is to employ the first order asymptotic expansion , which was derived in section  [ sec : op_applied ] .",
    "of particular interest in this context is the question , how to generalize the method of optimal prediction to problems not in equilibrium .",
    "we have shown that optimal prediction can in principle be applied to problems in molecular dynamics which take place at comparably low temperatures and are in equilibrium .",
    "the boundary condition version yielded an obvious speed - up .",
    "while the pure speed - up is not overwhelming by itself , the physical interpretation of the optimal prediction equations should allow to apply the method in combination with other methods .",
    "further investigation may improve the derived results .",
    "we would like to thank helmut neunzert , thomas gtz and peter klein for useful advice and encouragement and alexandre j. chorin , michael junk and jochen vo for helpful discussions and comments .",
    "j. bell , a.j .",
    "chorin and w. crutchfield , _ stochastic optimal prediction with application to averaged euler equations _ , proc .",
    "fluid mech .",
    "lin ( ed ) , pingtung , taiwan , pp . 1 - 13 , 2000 .",
    "chen , s.l .",
    "cheng , h.h .",
    "lin , _ the failure mechanisms and phase formation for ni , co and cu contacts on ion implanted ( 001)si under high current stress _ , nucl .",
    "instr . and meth.in phys",
    "b 169 , pp .",
    "161 - 165 , 2000 ."
  ],
  "abstract_text": [
    "<S> optimal prediction approximates the average solution of a large system of ordinary differential equations by a smaller system . </S>",
    "<S> we present how optimal prediction can be applied to a typical problem in the field of molecular dynamics , in order to reduce the number of particles to be tracked in the computations . </S>",
    "<S> we consider a model problem , which describes a surface coating process , and show how asymptotic methods can be employed to approximate the high dimensional conditional expectations , which arise in optimal prediction . </S>",
    "<S> the thus derived smaller system is compared to the original system in terms of statistical quantities , such as diffusion constants . </S>",
    "<S> the comparison is carried out by monte - carlo simulations , and it is shown under which conditions optimal prediction yields a valid approximation to the original system .     </S>",
    "<S> optimal prediction , molecular dynamics , surface coating , hopping , laplace s method , low temperature asymptotics , monte - carlo </S>"
  ]
}