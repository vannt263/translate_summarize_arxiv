{
  "article_text": [
    "with the rapid development of wireless communication system , there has been a new surge of interest in energy efficient systems , due to the contradiction between the ever - increasing energy demand and the societal and economical concerns . as one of key technologies of 5 g mobile communication systems ,",
    "massive mimo has been put forward to significantly improve the system capacity with extra degrees of freedom which facilitate transmit diversity and spatial multiplexing gains @xcite .",
    "recently , there has been an increasing research interest in energy efficiency ( ee ) for massive mimo systems . as discussed in @xcite , it is of primary importance to set up an accurate power consumption model for reliable guidelines of ee optimization . by using a refined power consumption model ,",
    "closed - form ee - optimal value of transmit power was derived in @xcite by means of some properties of lambert _ w _ function .",
    "however , the optimization problem there without any constraints on quality of service ( qos ) failed to model the real scenario in communication systems . in the uplink of massive mimo systems , the maximum transmit power and the minimum data rate for each user terminal ( ut )",
    "should be included into basic qos requirements . in @xcite ,",
    "the problem of maximizing the ee as a function of the numbers of uts and antennas in bs was analyzed , for a given spectral efficiency and fixed transceiver power consumption parameters .",
    "similarly , the impact of system parameters ( the average channel gain to the uts and the power consumption parameters ) on the optimal ee was studied in @xcite for maximizing the ee with a fixed sum spectral efficiency . besides the theoretical analysis on the relationships between system parameters and the optimal ee , it is of great importance to develop optimization methods for maximizing ee under the multi - cell scenario .",
    "more recently , the markov decision process ( mdp ) method has been utilized to deal with the resource allocation problems for communication systems . in @xcite , by using the semi - mdp method , a resource allocation scheme was proposed to achieve the optimal power efficiency for qos - guaranteed services in ofdma multi - cell cooperation networks .",
    "however , the technicalities and complexities associated with semi - mdp seldom lead to practical algorithms @xcite . on the other hand , in order to meet the qos requirements , only a few works on the constrained markov decision process ( cmdp ) method for resource allocation in mimo systems @xcite and ofdm systems @xcite have been reported .",
    "the problem of power and rate allocation in mimo systems was modeled as a cmdp in @xcite with the goal of minimizing the transmit power subject to delay constraints , while the problem of power and subcarrier allocation for downlink ofdma systems was formulated as a cmdp in @xcite with the goal of maximizing the ee under average delay constraints . by introducing a middle state called  post - decision state \" ,",
    "an online solution was proposed in @xcite .    motivated by the aforementioned results , we propose a novel offline power allocation scheme to achieve the global optimum ee under qos constraints in the uplink of multi - cell massive mimo systems , which exploits the powerful optimization tool , constrained markov decision process ( cmdp ) .",
    "the power allocation policy is determined via the use of value iteration and q - learning algorithms .",
    "the appeal of the value iteration algorithm is attributed to its ease in implementation and simplicity in the convergence condition to the global optimum solution .",
    "more importantly , the value iteration algorithm can be used for further studies to analyze the structure of the optimal policy obtained in this paper .",
    "the global convergence of the q - learning algorithm guarantees the proposed offline solution to obtain the global optimum power allocation policy .",
    "specifically , the proposed offline solution can exploit the obtained decision rule to build an offline look - up table , which can avoid the frequent and continuous computations and provide flexibility by adjusting the corresponding parameters of the value iteration and q - learning algorithms .",
    "the rest of this paper is organized as follows . in section",
    "ii , the system model is briefly described .",
    "the problem formulation and solution algorithm are presented in section iii .",
    "simulation results are shown in section iv .",
    "final conclusions are drawn in section v.",
    "consider a multi - cell massive mimo system consisting of @xmath0 cells where each bs is equipped with an array of @xmath1 antennas , and each cell is filled with @xmath2 single - antenna uts uniformly as illustrated in fig .",
    "[ scenario ] .",
    "assume @xmath3 .",
    "the focus of this paper is on the uplink without any form of bs cooperation .",
    "let @xmath4 denote the complex propagation coefficient between the @xmath5-th bs antenna in the @xmath6-th cell and the @xmath7-th ut in the @xmath8-th cell .",
    "then , it can be expressed as , @xmath9 where the small - scale fading coefficient @xmath10 is always assumed to be i.i.d .",
    "random variable with distribution @xmath11 , and the large - scale fading coefficient @xmath12 models the geometric attenuation and shadow fading , which is assumed to be independent over @xmath5 , constant over many coherence time intervals and known a priori @xcite .",
    "the component @xmath13 consists of path loss and shadow fading , where @xmath14 is a constant related to carrier frequency and antenna gain , @xmath15 is the distance between the bs in the @xmath6-th cell and the @xmath7-th ut in the @xmath8-th cell , @xmath16 is the path loss exponent , and @xmath17 represents the shadow fading with the distribution @xmath18 . then , we have propagation matrix @xmath19 , where @xmath20 denotes the @xmath21 matrix of fast fading coefficients between the bs in the @xmath6-th cell and the @xmath2 uts in the @xmath8-th cell , i.e. , @xmath22_{mk } } = { h_{limk}}$ ] , and @xmath23 is the @xmath24 diagonal matrix with @xmath25_{kk } } = { \\beta_{lik}}$ ] .    in the uplink ,",
    "let @xmath26 denote the @xmath27 received signal vector of the bs in the @xmath6-th cell .",
    "then , it can be expressed as : @xmath28 where @xmath29 denotes the transmit symbol vector in the @xmath8-th cell with @xmath30 , @xmath31 denotes the transmit power matrix allocated to the uts in the @xmath8-th cell , and @xmath32 denotes the additive white gaussian noise ( awgn ) with @xmath33 .",
    "we consider the case where the bss have the perfect channel state information ( csi ) , i.e. , they know @xmath34 .",
    "assume that the zero - forcing ( zf ) receiver is utilized to detect the streams of the @xmath2 uts .",
    "let @xmath35 be the receiver matrix , @xmath36 the @xmath7-th column of @xmath35 , @xmath37 the @xmath7-th column of the propagation matrix @xmath38 , and @xmath39 the transmit power allocated to the @xmath7-th ut in the @xmath6-th cell .",
    "then , the detected signal of the @xmath7-th ut in the @xmath6-th cell can be expressed as : @xmath40 where only the first term is the desired information , while the other terms represent the intra - cell interference , inter - cell interference and noise , respectively . as a result ,",
    "the uplink signal to interference plus noise ratio ( sinr ) of the @xmath7-th ut in the @xmath6-th cell can be expressed as follows : @xmath41    the ee of a communication system is measured in bits / joule and defined as the total average number of bits / joule successfully delivered from the uts . as for the detailed power consumption model , for a specific ut , apart from the power consumed at the ut which can be modeled as the sum of transmit power and circuit power consumed by inevitable electronic operations , the average circuit power consumption within the bs is of great importance such as receiver antenna units , decoding , multiuser detection and fixed power consumption . for readers not interested in the receiver circuit power , the average circuit power consumption in bs",
    "can be assumed to be zero @xcite . in this paper , our focus lies in the power allocation scheme , without consideration of other parameters such as @xmath1 or @xmath2 , so there is no need to formulate such a trivial power consumption model as @xcite .",
    "hence , we integrate all of the power consumed above but the transmit power into a specific term , @xmath42 , denoted as the average circuit power consumption for each ut in the @xmath6-th cell , to simplify the power consumption model .",
    "therefore , the uplink ee of the multi - cell massive mimo system is given by @xmath43",
    "using the system model presented in section ii , we formulate the power allocation optimization problem by applying the cmdp , and then propose an offline solution containing the value iteration and q - learning algorithms to solve it .",
    "we first extract the main characters from the above system model to build a cmdp - based model .",
    "a cmdp - based model can be characterized by five elements : decision epochs , states , actions , transition probabilities and rewards @xcite .",
    "@xmath44 before modeling , the time dimension is partitioned into decision slots represented by @xmath45 , where the time slot @xmath46 is defined as the time interval @xmath47 $ ] , and @xmath48 denotes the channel coherence time .",
    "then , the decision epochs can be indexed with @xmath46 .",
    "we assume that the wireless channel fluctuates slowly and the csi remains quasi - static and i.i.d . between decision slots .",
    "@xmath49 to model the fluctuation in the physical layer , a finite - state markov channel ( fsmc ) model can be built to characterize the time - varying behavior of the channel @xcite . in our model , the system state space @xmath50 is the cartesian product of cell state space @xmath51 accounting for the channel gains in each cell , whose component is also a composite state of link state @xmath52 , denoted by @xmath53 , and each link state is quantized using a finite number of thresholds @xmath54 , where @xmath55 .",
    "the composite system state of all the cells is denoted by @xmath56 , where @xmath57 .",
    "based on the above assumptions , the sequence of composite system states forms a markov chain with transition probabilities @xmath58 that is independent of actions , which is similar as that in @xcite , and @xmath59 , @xmath60 denote the system states in current and next decision epoch , respectively .",
    "@xmath61 let @xmath62 denote the system action space , and @xmath63 denote the action space of each cell , whose cardinality is @xmath64 .",
    "specially , let @xmath65 denote the set of the transmit powers allocated to the uts in the @xmath6-th cell .",
    "then , the composite system action can be denoted by @xmath66 .",
    "note that the proper choice of the set of action space can incorporate the qos requirement with respect to the maximum transmit power for each ut without additional operations .",
    "@xmath67 based on the modeling of fsmc , the link state transition occurs only from the current state to its neighboring states . without loss of generality",
    ", we simplify each link state @xmath53 as @xmath68 for convenience .",
    "then , the steady probability for the @xmath69-th link state can be expressed as @xmath70 where @xmath71 is the average link gain . according to @xcite ,",
    "the level - crossing rate of the link gain is given by @xmath72 , where @xmath73 is the maximum doppler frequency normalized by the decision rate @xmath74 .",
    "the link state transition probabilities are determined by @xmath75 \\\\   = \\left\\ { { \\begin{array}{*{20}{l } } { \\frac{{h({\\gamma _ { b + 1}})}}{{{p_b } } } ,   b ' = b + 1 ,   b \\in [ 0,{q_s } - 2 ]   , } \\\\[0.5pt ] \\\\ { \\frac{{h({\\gamma _ b})}}{{{p_b } } } ,   b ' = b - 1 ,   b \\in [ 1,{q_s } - 1 ]   , } \\\\[0.5pt ] \\\\ { 1 - \\frac{{h({\\gamma _ { b + 1}})}}{{{p_b } } } - \\frac{{h({\\gamma _ b})}}{{{p_b } } } ,   b ' = b ,   b \\in [ 1,{q_s } - 2 ] , } \\end{array } } \\right . \\end{array}\\end{gathered}\\ ] ] where @xmath76 and @xmath77 denote the link states in current and next decision epoch , respectively .",
    "the transition probabilities of @xmath78 for the boundaries are given by @xmath79 and @xmath80 .",
    "the composite system state transition probabilities can be computed by @xmath81    @xmath82 we adopt the overall ee as system reward function , which is defined as @xmath83 for the action @xmath84 at the state @xmath59 . and the corresponding qos requirement with respect to the minimum data rate for each ut can be expressed as a series of constraints : @xmath85 , for @xmath86 and @xmath87 , where @xmath88 and @xmath89 denote the instantaneous data rate and the required minimum data rate for each ut in the uplink , respectively .    by exploiting the above cmdp framework",
    ", the transmit power can be adjusted according to a stationary policy @xmath90 , where each decision rule @xmath91 specifies a mapping function @xmath92 to maximize the objective function .",
    "let @xmath93 denote the discount factor , @xmath94 denote the expected discounted total reward , and @xmath95 denote the expected discounted total cost associated with the required date rate constraint , given that the policy @xmath96 is used with initial state @xmath97 .",
    "then , we can formulate the cmdp - based optimization problem as follows @xmath98      to solve the constrained optimization problem in ( [ op ] ) , we first utilize the lagrangian approach @xcite , @xcite to transform the cmdp optimization problem into an equivalent unconstrained mdp optimization problem .",
    "for any non - negative vector of lagrange multipliers ( lm ) @xmath99^t}$ ] , we define the lagrangian as @xmath100 then , the bellman s equations are given by @xmath101    now we propose an offline scheme to derive the optimal power allocation policy . the stationary optimal policy and the corresponding maximum expected discounted total reward function can be obtained by the well - known value iteration algorithm @xcite , for a fixed lm vector @xmath102 . then , we utilize the q - learning algorithm @xcite to determine the proper @xmath102 for the feasible constraint @xmath103 . specifically , the iteration algorithm is described as follows @xmath104 where @xmath105 is the index of the iteration steps .",
    "the convergence to the global optimum @xmath106 of the q - learning algorithm can be ensured , because the functions @xmath107 are piece - wise linear concave@xcite . taking into consideration of the convergence to the global optimum policy @xmath108 ensured by the value iteration algorithm @xcite , the proposed offline algorithm can attain the global optimum power allocation scheme .",
    "the offline iterative algorithm is summarized in algorithm 1 , where @xmath109 denotes an infinitesimal gap , and @xmath110 is the index of the iteration steps for the value iteration algorithm .",
    "we remark here that the inner iteration between step 2 and step 5 in algorithm 1 performs the value iteration computation to solve the bellman s equations in ( [ bellman ] ) to obtain the stationary optimal policy for the given lm vector @xmath111 , where we denote the @xmath110-th approximation to @xmath112 by @xmath113 .",
    "we also remark here that the outer iteration between step 2 and step 5 in algorithm 1 performs the q - learning computation to solve the equations in ( [ q ] ) to obtain the optimal lm vector @xmath106 , where we replace @xmath114 by @xmath115 in the @xmath105-th iteration .",
    "we point out here that the value of the components of the initial lm vector @xmath116 should be set to be very large to converge to the optimal lm vector in consideration of the minimum data rate constraint .",
    "the obtained optimal decision policy @xmath117 in algorithm 1 contains a series of optimal decision rule @xmath118 , which specifies a mapping function @xmath119 to get the maximum reward .",
    "the mapping function @xmath118 can be exploited to construct an offline look - up table to avoid the frequent and continuous computations . by using the table ,",
    "the corresponding transmit power can be allocated to the uts to maximize the reward once the channel states are known .",
    "note here that tradeoff between the performance gain and the size of the offline table can be balanced by changing @xmath120 and @xmath64",
    ".    * step 1 :  set @xmath121 for each @xmath59 .",
    "specify @xmath122 , @xmath123 , and initialize @xmath124 , @xmath125 .",
    "* step 2 :  for a given @xmath111 , compute @xmath126 for each @xmath59 as follows @xmath127 * step 3 :  if @xmath128 , then @xmath129 and continue .",
    "otherwise , increase @xmath110 by 1 and goto step 2",
    ". * step 4 :  for each @xmath6 and @xmath7 , compute @xmath130 as follows + @xmath131 .",
    "* step 5 :  if @xmath132 , then @xmath133 and continue .",
    "otherwise , increase @xmath105 by 1 and goto step 2 . * step 6 :  compute the optimal policy @xmath117 according to step 2 and step 3 , with the optimal lm factor @xmath134 .",
    "[ algorithm ]",
    "in this section , we compare the performances of our proposed cmdp - based power allocation policy with the ergodic optimal policy .",
    "the ergodic optimal policy is achieved by maximizing the reward functions from the set of feasible actions at each system state by using the exhaustive - search method .",
    "note that the focus of the comparison between our proposed policy and the ergodic optimal policy does not lie in the uniformity , i.e. , specific action chosen at each system state , but the long - term performance with respect to the expected discounted total reward . in our simulations , unless otherwise stated , the system parameters are set as follows : the number of cells is @xmath135 , the number of uts in each cell is @xmath136 , the path loss factor @xmath14 is 1 , the path loss exponent @xmath16 is 3.7 , the variance of log - normal shadow fading @xmath137 is 10db , the number of antennas to each bs is @xmath138 , the average circuit power consumption is @xmath139 for each @xmath140 @xcite , the link states are equiprobable , quantized with @xmath141 states , the action at each system state is chosen from @xmath142 to @xmath143 with @xmath144 intervals , and the discount factor @xmath93 is assumed to be @xmath145 .",
    "[ simulation_comparison ] shows the performances of our proposed policy in comparison with the ergodic optimal policy .",
    "it is clear that the performance gap between them can be negligible . and the expected discounted total reward under different discount factors increases as @xmath146 becomes larger .",
    "this is because larger discount factor means longer - term reward taken into consideration .",
    "[ simulation_max_snr_qs ] and fig .",
    "[ simulation_max_snr_qa ] show how the maximum transmit signal - to - noise ratio ( snr ) allocated to the uts affects the expected discounted total reward of policies with @xmath147 .",
    "it can be observed that the performances of the two policies stop to increase and tend to be constant when the maximum transmit snr is larger than certain threshold snr .",
    "the reason is that there is no longer any need to consume more power , when the maximum expected total reward has already been achieved . in fig .",
    "[ simulation_max_snr_qs ] , it can be observed that the performances of both policies improve as @xmath120 gets larger , which is due to the more refined quantification of the channel states .",
    "it can also be observed that there is a performance gap between the two policies when the maximum transmit snr is large enough .",
    "this results from that the iteration process of the value iteration algorithm makes our proposed policy sensitive to the channel state quantized by @xmath120 , which will be aggravated by the larger maximum transmit snr . in fig .",
    "[ simulation_max_snr_qa ] , it can be observed that the performances of the two policies improve as @xmath64 gets larger when the maximum transmit snr is large enough .",
    "the reason is that the larger @xmath64 , the higher - precision transmit power can be allocated to the uts . in addition , we can see that the performance gain by increasing @xmath64 is no longer significant when @xmath64 gets large enough .",
    "this reveals that the proposed policy can achieve good performance with a small @xmath64 , i.e. , a low - precision transmit power quantization is enough for our proposed policy .     under @xmath148.,scaledwidth=45.0% ]     under @xmath149.,scaledwidth=45.0% ]    in fig .",
    "[ simulation_m ] , the impact of the number of antennas in bs on the performance of the policies is shown .",
    "we can see that the performance growth tends to slow down with the increase of @xmath1 .",
    "the performance of our proposed policy is very close to the ergodic optimal policy when @xmath1 is large enough , but not for the case of small @xmath1 .",
    "recall that the value iteration algorithm is sensitive to the channel state based on @xmath52 which contains the parameter @xmath1 , and that the large - scale fading coefficient @xmath4 is independent of @xmath1 .",
    "correspondingly , for a smaller @xmath1 , the impact of the small - scale fading coefficient of the channel will be increased sharply which results in the worse modeling of the channel state .",
    "this leads to the performance gap of the two policies for the case of smaller @xmath1 .",
    "in this paper , we have proposed a cmdp - based power allocation algorithm for the uplink of multi - cell massive mimo system to maximize ee under two qos requirements .",
    "the policy performance of our cmdp - based offline algorithm is very close to the ergodic optimal policy , and some further analysis results have been given to determine the impact of system parameters on the long - term ee .",
    "this work was supported in part by the national basic research program of china ( 973 program 2012cb316004 ) , the national 863 project ( 2015aa01a709 ) , and the natural science foundation of china ( 61221002 ) .",
    "e.  bjrnson , l.  sanguinetti , j.  hoydis , and et  al .",
    ", `` optimal design of energy - efficient multi - user mimo systems : is massive mimo the answer ? '' _ ieee trans .",
    "wireless commun .",
    "_ , vol .  14 , no .  6 , pp .",
    "30593075 , june 2015 .",
    "p.  wang , x.  zhang , and m.  song , `` optimal stochastic subcarrier and power allocations for qos - guaranteed services in ofdma multicell cooperation networks , '' _ in proc .",
    "ieee icc _ , pp .",
    "64496453 , june 2013 .",
    "d.  v. djonin and v.  krishnamurthy , `` mimo transmission control in fading channels  a constrained markov decision process formulation with monotone randomized policies , '' _ ieee trans .",
    "signal process .",
    "_ , vol .",
    "55 , no .",
    "10 , pp . 50695083 , oct .",
    "2007 .",
    "d.  v. djonin and v.  krishnamurthy , `` q - learning algorithms for constrained markov decision processes with randomized monotone policies : application to mimo transmission control , '' _ ieee trans . signal process .",
    "_ , vol .",
    "55 , no .  5 , pp .",
    "21702181 , may 2007 ."
  ],
  "abstract_text": [
    "<S> in this paper , energy efficient power allocation for the uplink of a multi - cell massive mimo system is investigated . with the simplified power consumption model , </S>",
    "<S> the problem of power allocation is formulated as a constrained markov decision process ( cmdp ) framework with infinite - horizon expected discounted total reward , which takes into account different quality of service ( qos ) requirements for each user terminal ( ut ) . </S>",
    "<S> we propose an offline solution containing the value iteration and q - learning algorithms , which can obtain the global optimum power allocation policy . </S>",
    "<S> simulation results show that our proposed policy performs very close to the ergodic optimal policy . </S>"
  ]
}