{
  "article_text": [
    "in the standard cosmological framework , the seeds of cosmic structures like quasars , galaxies and galaxy systems are constituted by dark matter ( dm ) perturbations of the cosmic density field , originated by quantum effects during the early inflationary universe .",
    "the perturbations are amplified by gravitational instabilities and , as the local gravity prevails over the cosmic expansion , are enforced to collapse and virialize into bound ` halos ' . in turn , these tend to grow hierarchically in mass and sequentially in time , with small clumps forming first and then stochastically merging together into larger and more massive objects .",
    "the halos provide the gravitational potential wells where baryonic matter can settle in virial equilibrium , and via a number of complex astrophysical processes ( cooling , star formation , feedback , etc . )",
    "originates the luminous structures that populate the visible universe .    to accurately describe and deeply understand the statistics of dm halos constitute fundamental steps toward formulating a sensible theory of galaxy formation and evolution . a milestone is constituted by the pioneering work of press & schechter ( 1974 ) , who first provided an analytic expression for the halo mass function , i.e. , the halo abundance as a function of mass and redshift",
    "; their theory envisages that a halo can collapse if it resided within a sufficiently overdense region of an initial , gaussian perturbation field .",
    "however , the overdensity around a given spatial location depends on the scale under consideration ; thus the halo abundance can be computed from the mass fraction in the density field which is above a critical threshold for collapse when conveniently smoothed on different scales .",
    "however , a relevant issue is to consider only those perturbations that overcome the threshold on a given smoothing scale , but not on a larger one ; in fact , overdense regions embedded within a larger collapsing perturbation are squeezed to smaller and smaller sizes , and care must be payed not to double - count them . to cure this ` cloud - in - cloud ' problem , bond et al .",
    "( 1991 ) developed the excursion set approach .",
    "this recognizes that the overdensity around a given spatial location executes a random walk when considered as a function of the smoothing scale ( see fig .  1 ) ; moreover , if the smoothing is performed with a sharp filter in fourier space , the steps of the random walk are uncorrelated , i.e. , the walk is markovian . in this framework",
    "the threshold for collapse plays the role of a barrier the random walk can hit ; the distribution of first crossing , i.e. , the probability that a walk crosses the barrier for the first time on a specific scale , can be closely related to the halo mass function , and allows to avoid any double - counting .",
    "the excursion sets approach has soon been exploited to derive the ` conditional ' halo mass function ( see lacey & cole 1993 ) , describing the mass and redshift distribution of progenitors given they belong to a descendant halo at a later time .",
    "this statistics has then been used to generate merger trees , i.e. , montecarlo realizations of the halo merging process ( see kauffmann & white 1993 ; somerville & kolatt 1999 ; cole et al .",
    "2000 ; zhang et al .",
    "2008a ) . with some additional assumptions ,",
    "the excursion set has been also helpful in developing models for the halo spatial clustering and bias ( see mo & white 1996 ; sheth & lemson 1999 ) .",
    "subsequent developments focused on the shape of the moving barrier ; originally , a simple model of halo spherical collapse ( gunn & gott 1972 ) was adopted , yielding a constant barrier , independent of halo size . however ,",
    "gaussian perturbations naturally possess a triaxial nature ( doroshkevich 1970 ) , and the halo collapse is likely to be ellipsoidal rather than spherical ; as a result , the threshold for collapse becomes a ` moving ' , mass dependent barrier ( sheth et al .",
    "2001 , sheth & tormen 2002 ) .",
    "the excursion set approach with moving barriers has proven to be rather successful in reproducing reasonably well the outcomes of cosmological @xmath0-body simulations ( sheth & tormen 1999 , jenkins et al .",
    "2001 , springel et al .",
    "2005 , warren et al .",
    "2006 , reed et al .",
    "2007 , tinker et al .",
    "2008 ; also crocce et al .",
    "2010 , angulo et al .",
    "2012 , watson et al .",
    "more recent developments concerns extension of the excursion set approach to non - markovian walks with correlated steps ( maggiore & riotto 2010a ; paranjape et al .",
    "2012 ; musso & sheth 2012 ) , stochastic barriers ( maggiore & riotto 2010b ; corasaniti & achitouv 2011 ) , non gaussian initial conditions ( maggiore & riotto 2010c ; de simone et al .",
    "2011a , b ; musso & paranjape 2012 ) , and application to the distribution of voids ( sheth & van de weygaert 2004 ) .",
    "despite these efforts , exact solutions to the first crossing distribution are known only for simple barriers , like the constant or linear ones , but not for the nonlinear shapes describing a realistic , ellipsoidal halo collapse . in such cases ,",
    "empirical formulae have been proposed to _ fit _ the outcomes of cosmological @xmath0-body simulations ( see sheth & tormen 2002 ; parkinson et al .",
    "2008 ; neistein & dekel 2008 ; lam & sheth 2009 ; de simone et al .",
    "although such fitting formulae are inspired by the known solutions , being not derived directly from the excursion set formalism may suffer of various problems : inconsistencies with the excursion set approach in given mass and redshift ranges ; difficulties in the physical interpretation of the results ; dependence on the simulation setup ; poor flexibility in describing comparably well different barrier shapes ; complex expressions , that make difficult to derive analytically other statistical quantities of interest , like halo merger rates and bias .",
    "one of the main goal of this paper is to provide analytic approximations of the first crossing distribution ( both unconditional and conditional ) for quite general shapes of the barrier , that are derived directly from , and so are fully consistent with , the excursion set formalism .    a related important issue we address concerns the halo creation rate , i.e. , the change in abundance per unit time of newly created halos as a function of mass and redshift .",
    "the seemingly simple task of deriving this quantity hides delicate conceptual problems , and is to some extent still unresolved .",
    "naively , one can think of just taking the derivative of the halo mass function ; this is plainly not correct , because such a derivative is actually the balance between the rate of halo creation by the merging of smaller ones , and the rate of halo destruction by merging into larger ones ( as stressed and discussed by cavaliere et al .",
    "1991 ; see also blain & longair 1993 ) .",
    "indeed , the total derivative can be positive or negative , as a consequence of the fact that small masses are dominated by the destruction and high masses by the creation term .",
    "some authors considered the possibility of taking the ` positive ' term in the cosmic time derivative of the press & schechter mass function ( e.g. , haehnelt et al .",
    "1998 ) ; a partial justification for such an approach was provided by sasaki ( 1994 ) , who obtained the same outcome by requiring the destruction term to be scale - invariant .",
    "as a matter of fact , @xmath0-body simulations show this assumption not to hold in general , and to break down especially at small masses ; in addition , sasaki s procedure does not provide consistent result for nonlinear barriers ( see mitra et al .",
    "2011 ) .",
    "another approach has been proposed by sheth & pitman ( 1997 ) ; they described the merging between halos in terms of the classic smoluchowski s ( 1916 ) binary coagulation equation ( see also silk & white 1978 ) , whose structure naturally separates between the creation and destruction terms .",
    "in fact , as already noted by epstein ( 1983 ) , there exists a strict analogy between the excursion set approach with a white - noise power spectrum and a discrete poisson model of binary coagulation with additive kernel .",
    "however , in the continuum limit relevant to the cosmological context , the creation and destruction terms diverge , and replacing them with the finite , discrete poisson expressions lacks a mathematical justification .",
    "in addition , when more realistic spectra are considered , like power - law or cold dm ones , the merger kernel from the excursion set is no longer symmetric , and the average number of progenitors per merger event is greater than two ; thus the analogy with the binary coagulation equation does no longer hold ( see benson et al . 2005 ; benson 2008 ; neistein & dekel 2008 ; zhang et al .",
    "2008a ) .",
    "lacey & cole ( 1993 ) and kitayama & suto ( 1996 ) attempted to derive an expression for the creation rate directly from the excursion set framework ; taken at face value the result is divergent and calls for some form of regularization .",
    "they sidestepped the problem by introducing the concept of ` formation ' or major merger rate , according to which a halo is formed during a merger if it acquires more than half its original mass .",
    "percival & miller ( 1999 ) , basing on bayes theorem and assuming a flat prior on the distribution of the threshold for collapse at fixed smoothing scale , obtained an expression for the creation time distribution , which represents the creation rate normalized in time ( the normalization being again formally infinite ) .",
    "all in all , these analysis failed to derive a sensible , finite results for the creation rates ; even the expressions provided for formation rates and creation time distribution hold only for constant barriers , and their extension to general moving barriers is nontrivial ( see mahmood & rajesh 2005 ; also moreno et al .",
    "2009 for discussion ) .",
    "another goal of this paper is to provide finite , analytic expressions for the rates of halo creation and formation with general moving barriers .",
    "the plan of the paper is straightforward : in   2 we recall the basics of the excursion set formalism ; in   3 and 4 we derive our main results , i.e. , approximated expression of the unconditional and conditional first crossing distributions ( and related mass functions ) for general moving barriers ; in ",
    "5 we apply our main results to derive other quantities of interest in halo statistics , including the rates of halo formation and creation , the average halo growth history , and the halo bias for general moving barriers ; in   6",
    "we summarize our main findings .",
    "appendix a provides a brief primer on the @xmath1-regularization technique for divergent integrals , while in appendix b and c we discuss how the excursion set approach and our main results change when considering random walks with correlated instead of uncorrelated steps , and with warm instead of cold dark matter power spectra .    throughout this work",
    "we adopt a standard , flat cosmology ( see komatsu et al . 2011 ; hinshaw et al . 2013 ; _ planck _ collaboration 2013 ) with matter density parameter @xmath2 , baryon density parameter @xmath3 , and hubble constant @xmath4 km s@xmath5 mpc@xmath5 with @xmath6 .",
    "in this section we recall the basics of the excursion set approach , highlight some delicate points useful in the sequel , and set the notation .",
    "the expert reader may jump directly to   3 .",
    "we start by considering a spatial location in the universe with comoving coordinate @xmath7 and local density contrast @xmath8 over the background value @xmath9 .",
    "the density contrast smoothed on a scale @xmath10 is given by @xmath11 in terms of some filter function @xmath12 . since the behavior of @xmath13 as a function of @xmath10 is the interesting quantity , without loss of generality we can pose @xmath14 and denote @xmath15 just as @xmath16 . passing to fourier space and indicating with a hat fourier - transformed quantities , we can write @xmath17    we consider a gaussian fluctuation field , whose statistical properties",
    "can be completely encased into its power spectrum @xmath18 defined as @xmath19 with @xmath20 being the dirac delta function , and @xmath21 indicating the statistical average over the stochastic variables @xmath22 . in terms of the power spectrum ,",
    "the variance of the smoothed density field simply writes @xmath23 for @xmath18 we adopt the standard cold dm shape by bardeen et al .",
    "( 1986 ; see their eq .",
    "g3 ) with the correction for baryons by sugiyama ( 1995 ; see his eq .",
    "3.9 ) , normalized in such a way that the r.m.s .",
    "@xmath24 takes on the value @xmath25 on a scale @xmath26 mpc ( consistent with the results by wmap7/wmap9 from hinshaw et al .",
    "2013 and by the _ planck _ collaboration 2013 ) .    as to the filter function , a common and convenient choice is a simple sharp filter in fourier space @xmath27 , where @xmath28 is the heaviside step function and @xmath29 is a cutoff wavenumber , to be related to the scale @xmath10 .",
    "in such a case , indicating with @xmath30 the polar - average in momentum space of @xmath22 , one has @xmath31 and @xmath32 , hence @xmath33 and @xmath34 hold . using these relations @xmath35 follows ; moreover , polar - averaging eq .",
    "( 3 ) yields @xmath36 .    all in all , @xmath16 is seen to satisfies a langevin equation with a dirac delta noise , in the form @xmath37 this means that @xmath16 executes a markovian random walk as a function of the smoothing scale @xmath10 , with @xmath38 playing the role of a time variable . in more detail ,",
    "the walk starts at @xmath39 when @xmath40 corresponding to large values of @xmath10 , and then as @xmath10 decreases and the pseudo - time @xmath38 increases , @xmath16 performs a stochastic motion under the influence of a gaussian noise with variance @xmath38 .",
    "an example is illustrated in fig .",
    "a delicate point with the sharp filter in fourier space is to associate a mass @xmath41 to the smoothing scale @xmath10 ( see also discussion in appendix b ) .",
    "the standard procedure , admittedly ambiguous to some extent , is to normalize the expression of the filter in real space @xmath42/2\\pi^2 r^3 $ ] to its maximum value @xmath43 , then to compute the volume @xmath44 enclosed in the filter , and finally to set @xmath45 .",
    "this yields @xmath46={6\\pi^2\\bar\\rho\\over k_s^3}~;\\ ] ] in deriving the final expression we have used that @xmath47 , and we have computed the borel - regularized value of the otherwise ill - defined , oscillating integral @xmath48 ; this amounts to introduce a regulator @xmath49 and to compute , in place of the original integral , the well - defined quantity ( see hardy 1949 for details ) @xmath50_0^\\infty= \\lim_{\\lambda\\rightarrow 0^+}{\\lambda\\over 1+\\lambda^2}=0~.\\ ] ] all in all , posing @xmath51 one obtains the relation @xmath52 between the smoothing scale and the cutoff wavenumber .    in the excursion set formulation",
    "a halo is formed when the walk first crosses a barrier @xmath53 with general shape @xmath54^{-\\gamma}\\right\\ } = \\sqrt{s}\\,(q\\nu)^{1/2}\\,\\left[1+{\\beta\\over ( q\\nu)^{\\gamma}}\\right]~,\\ ] ] with @xmath55 and @xmath56 .",
    "here @xmath57 is the critical threshold for collapse extrapolated from linear perturbation theory . at the current epoch",
    "@xmath58 holds , although the precise value weakly depends on cosmological parameters ( see eke et al .",
    "1996 ) ; then it evolves like @xmath59 with the cosmological time @xmath60 , in terms of the linear growth function @xmath61 , see weinberg ( 2008 ) for detailed expressions .",
    "in addition , the dependence of the barrier on the scale @xmath62 is specified by the parameters @xmath63 , that are commonly set basing on theory of halo collapse or by comparison with @xmath0-body simulations .",
    "the triple of values @xmath64 corresponds to a constant barrier that describes spherical collapse ( press & schechter 1974 ; bond et al .",
    "1991 ) ; the triple @xmath65 corresponds to a nonlinear barrier that represents ellipsoidal collapse ( actually a collapse with the most probable values of ellipticity and prolateness , see sheth & tormen 2002 for details ) ; finally , the triple @xmath66 corresponds to a square - root barrier often considered in the literature as a simpler description of ellipsoidal collapse ( mahmood & rajesh 2005 ) .",
    "in fact , note that for @xmath67 not all walks are guaranteed to cross the barrier ( the r.m.s .",
    "@xmath68 of the walk scales as @xmath69 ) , and barriers corresponding to different times can intersect ( an occurrence thought to represent fragmentation ) ; thus one often adopt the square - root barrier in place of the sheth & tormen one , given that the two are known to reproduce comparably well the outcomes of cosmological @xmath0-body simulations .    the last equality in eq .",
    "( 8) highlights that these barriers can be recast in self - similar terms with the use of the variable @xmath70 ; this is useful to treat at the same time the first crossing distribution for different epochs and/or masses . in fig .  2 we represent the shape @xmath71 of these barriers ( color - coded ) as a function of @xmath72 .",
    "in the following we will use these three barriers as prototypical examples to illustrate our results , for simplicity referring to them as ` constant ' , ` square - root ' , and ` ellipsoidal ' .    then according to the excursion set prescription ,",
    "the ( unconditional ) halo mass function is given by @xmath73 here @xmath74 is the first crossing distribution , i.e. , @xmath75 represents the probability that a trajectory crosses the barrier for the first time between @xmath62 and @xmath76 .",
    "this quantity may be determined as described next .",
    "it is convenient to formulate the problem in terms of the integral equation ( see zhang & hui 2006 ) @xmath77 here @xmath71 is the moving barrier , @xmath74 is the first crossing distribution , and @xmath78 is the probability for the trajectory to lie between @xmath68 and @xmath79 at @xmath62 .",
    "the above equation plainly states that at a given @xmath62 a trajectory must either have crossed the barrier at some smaller @xmath62 or still be below the barrier .",
    "if no barrier were present , @xmath78 would simply be a normal gaussian distribution with null mean and variance @xmath62 , to read @xmath80 in presence of the barrier , to find @xmath78 one has to subtract from @xmath81 the fraction of trajectories now at @xmath82 which have crossed the barrier at some @xmath83 ; this writes @xmath84~.\\ ] ] inserting eqs .",
    "( 11 ) and ( 12 ) into eq .",
    "( 10 ) and performing the integration over @xmath68 yields @xmath85=\\int_0^s{\\rm d}s'~f(s')\\,{\\rm erfc}\\left[{b(s)-b(s')\\over \\sqrt{2 ( s - s')}}\\right]~,\\ ] ] where @xmath86 is the complementary error function .",
    "this constitute a volterra integral equation of the second kind for the unknown function @xmath74 given the barrier shape @xmath71 .",
    "note that the integral formulation of the excursion set approach expressed by eq .",
    "( 13 ) holds for markovian random walks with uncorrelated steps ; in appendix b we will discuss how the approach can be modified when some degree of correlation between the steps is considered .",
    "for a linear barrier @xmath87 the solution of eq .",
    "( 13 ) is easily derived by applying a laplace transformation , to obtain @xmath88 anti - transforming via the standard bromwich integral ( along a vertical contour @xmath89 in the complex plane having all the singularities of @xmath90 to the left ; e.g. , arfken et al .",
    "2013 , p. 1038 ) leads to the ` inverse gaussian ' distribution @xmath91 note that the solution for a constant barrier @xmath92 is simply recovered by placing @xmath93 .",
    "however , the barriers relevant to the collapse of dm halos are nonlinear , featuring the typical shapes @xmath94 with @xmath95 like in eq .",
    "( 8) ; in these cases it is not possible to solve exactly eq .",
    "( 13 ) for the first crossing distribution , and one generally recurs to numerical techniques ( e.g. , zhang & hui 2006 , benson et al .",
    "in fact , it is sufficient to discretize eq .",
    "( 13 ) on a grid of values @xmath96 with spacing @xmath97 to obtain the solution by the recursive formula @xmath98-\\sum_{j=0}^{i-1 } f(s_j)\\,{\\rm erfc}\\left[{b(s_i)-b(s_j)\\over \\sqrt{2 ( s_i - s_j)}}\\right]\\ , { \\delta s_{j-1}+\\delta s_j\\over 2}\\right\\}~,\\ ] ] where @xmath99 by definition .",
    "in this section we focus on the unconditional first crossing distribution .",
    "we numerically solve eq .",
    "( 16 ) and illustrate by the solid lines in fig .",
    "3 the outcomes for constant , square - root and ellipsoidal barriers ( color - coded ) . in addition",
    ", the crosses show the outcome of state - of - the - art cosmological @xmath0-body simulations ( fit to tinker et al .",
    "2008 ; see   1 for other references ) .",
    "this is in close agreement to both the square - root and the ellipsoidal distribution , actually striking an intermediate course between the two ; the constant barrier result is instead substantially different .",
    "here our aim is to derive useful approximate expressions to the unconditional first crossing distribution in the limit @xmath100 , i.e. , large masses and/or early times ; in self - similar terms this corresponds to the limit @xmath101 .",
    "we start by considering in eq .",
    "( 13 ) the limit for small @xmath62 : on the lhs the quantity @xmath102 tends to infinity so that we can exploit the asymptotic expansion of the function @xmath103 for large argument ; meanwhile inside the integral on the rhs the quantity @xmath104/\\sqrt{2 ( s - s')}\\simeq \\gamma b_\\gamma s^{\\gamma-1/2 } \\sqrt{(s - s')/2 s}$ ] tends to zero for @xmath105 so that we can expand the function @xmath106 for small values of its argument .",
    "differentiating both sides of eq .",
    "( 13 ) with respect to @xmath62 yields , to the lowest order , @xmath107\\simeq f(s)-{b_\\gamma\\ , \\gamma\\ , s^{\\gamma-1}\\over \\sqrt{2\\pi}}\\ , \\int_0^s{\\rm d}s'\\ , { f(s')\\over \\sqrt{s - s'}}\\ , \\left[1 + 2\\ , ( \\gamma-1)\\,{s - s'\\over s}\\right]~.\\ ] ] the structure of this equation suggest to consider the following ansatz for the small @xmath62 expansion of the first crossing distribution @xmath108~,\\ ] ] where @xmath109 is a constant , dependent on @xmath110 , to be determined . using it in eq .  (",
    "17 ) , and approximating the integral by the laplace method ( major contribution is from a small interval around @xmath111 ) , we obtain to the lowest order @xmath107\\simeq { b_0\\ , e^{-b^2(s)/2 s}\\over \\sqrt{2\\pi s^3}}\\ , \\left[1+(k_\\gamma-\\gamma)\\,{b_\\gamma\\over b_0}\\,s^\\gamma\\right]~.\\ ] ] this implies @xmath112 and thus the approximate first crossing distribution writes @xmath113~;\\ ] ] note that for the linear ( @xmath114 ) and constant ( @xmath115 ) barriers one recovers the exact solution eq .",
    ".    specializing to the barrier shape given by eq .",
    "( 8) and passing to the self - similar variable @xmath72 we have @xmath116 ^ 2/2}\\ , \\left[1+{(1-\\gamma)\\,\\beta\\over ( q\\nu)^{\\gamma}}\\right]~;\\ ] ] this approximate expression valid for @xmath101 and for a generic @xmath110 constitutes a novel result . in fig .",
    "3 we compare these approximations ( dashed lines ) of the unconditional first crossing distribution to the exact results ( solid lines ) for the constant , square - root , and ellipsoidal barriers .",
    "remarkably , the approximations perform very well over a wide range in @xmath72 , and specifically better than @xmath117 for @xmath118 ( and better than @xmath119 for @xmath120 ) . in terms of the characteristic mass @xmath121 defined by @xmath122 $ ]",
    ", for a standard cold dm spectrum the range translates into @xmath123 at @xmath124 , extends to @xmath125 at @xmath126 and to @xmath127 at @xmath128 , practically encompassing all masses of cosmological interest for @xmath129 .    in fig .",
    "4 we illustrate the corresponding mass function at different redshifts ( coded with linestyles ) , computed by inserting in eq .",
    "( 9 ) our approximated expressions eq .  ( 20 ) for the first crossing distribution . when compared to the outcomes of cosmological @xmath0-body simulations ( crosses ; fit to tinker et al .",
    "2008 ) for cold dark matter , the constant barrier mass function considerably underestimate the abundance of simulated halos , especially at high @xmath130 ; the square - root and above all the ellipsoidal barrier mass functions perform instead substantially better .",
    "we note that our approximation to the halo mass function based on eq .",
    "( 20 ) and ( 9 ) is extremely flexible with respect to changes of the power spectrum .",
    "for example , in appendix c we will exploit it for warm dark matter , and show its good agreement with recent @xmath0-body simulations .",
    "in this section we focus on the conditional first crossing distribution , i.e. , the probability of an object to feature a mass in the range between @xmath131 and @xmath132 at time @xmath133 provided that it becomes incorporated into a larger object of mass @xmath134 at a later time @xmath135 . as can be easily understood on the basis of fig .  1",
    ", in the excursion set approach this two barrier problem is equivalent to determine the first crossing distribution of a random walk with a single barrier of the form @xmath136 and pseudo - time variable @xmath137 .",
    "note that if the barrier @xmath138 were constant , then @xmath139 would apply , and the result would obtain just rescaling the unconditional distribution from the self - similar variable @xmath140 to @xmath141 .    in fig .",
    "5 we illustrate as solid lines the exact solutions by solving numerically eq .",
    "( 16 ) , as a function of @xmath142 , for a descendent mass @xmath143 and redshift interval @xmath144 .",
    "in fact , note that the conditional distributions , except for constant barrier case , do not depend solely on @xmath142 but also slightly on the descendant halo mass and redshift ; the rescaled unconditional mass functions are plotted for reference in fig .  5 as dotted lines .",
    "here our aim is to derive useful approximated expressions for the conditional first crossing distributions . since @xmath145 is a weakly nonlinear barrier , we can approximate it as @xmath146 , and the corresponding first crossing distribution as @xmath147 , where @xmath148 is the inverse gaussian distribution of eq .  (",
    "the unknown quantity @xmath149 may be derived along the following steps .",
    "first , we apply the operator @xmath150 to eq .",
    "( 13 ) and obtain @xmath151    then we perform a laplace transformation term by term . to this purpose , we use the following laplace rules ( see , e.g. , abramowitz & stegun 1972 , p. 1020 ) : @xmath152 , @xmath153 , @xmath154 , holding for generic functions @xmath155 and their transforms @xmath156 , for any real number @xmath157 and for any integer @xmath158 .",
    "we also use the following laplace transforms of elementary functions : @xmath159 , @xmath160 , @xmath161 , @xmath162 , holding for any real number @xmath163 .",
    "then we anti - transform term by term . to this purpose",
    ", we use the following inverse laplace transforms of elementary functions : @xmath166 , @xmath167 , @xmath168 , holding for any real number @xmath163 .",
    "this leads to @xmath169 finally , we find @xmath170\\right\\}~.\\ ] ]    we now specialize our computation to the popular family of barrier shapes of eq .",
    "( 8) , in terms of the normalized coefficients @xmath171^{1/2}-\\left[q{\\delta_c^2(t)\\over s}\\right]^{1/2}+\\beta\\left\\{\\left[q{\\delta_c^2(t')\\over s}\\right]^{-\\gamma+1/2}-\\left[q{\\delta_c^2(t)\\over s}\\right]^{-\\gamma+1/2}\\right\\}~,\\\\ & & \\nonumber\\\\ & & \\tilde c_1\\equiv c_1\\ , s^{1/2}=\\beta\\gamma\\,\\left[{q\\delta_c^2(t')\\over s}\\right]^{-\\gamma+1/2}~,\\\\ & & \\nonumber\\\\ & & \\nonumber \\tilde c_2\\equiv c_2\\ , s^{3/2}=-{\\beta\\gamma\\,(1-\\gamma)\\over 2}\\,\\left[{q\\delta_c^2(t')\\over s}\\right]^{-\\gamma+1/2}~;\\end{aligned}\\ ] ] using these expressions , the ( approximate ) conditional first crossing distribution takes the form @xmath172 ^ 2/2 \\delta",
    "s / s}\\over\\delta s\\sqrt{2 \\pi \\delta s / s}}\\ , \\left\\{1-\\tilde c_2\\,\\left({\\delta s\\over s}\\right)^{3/2}\\times\\right.\\\\ & & \\\\ \\nonumber & \\times&\\left .",
    "\\left[\\sqrt{\\pi\\over 2}\\,e^{\\tilde c_0 ^ 2/2 \\delta s / s } { \\rm erfc}\\left(\\tilde c_0\\over \\sqrt{2 \\delta s / s}\\right)+\\tilde c_0\\ , \\sqrt{s\\over \\delta s}+\\tilde",
    "c_1\\sqrt{\\delta s\\over s}\\right]\\right\\}~.\\end{aligned}\\ ] ] this is a novel result , that generalize to finite time difference the expression of zhang et al .",
    "( 2008b ) .    in fig .",
    "5 we compare this approximation ( dashed lines ) for the conditional first crossing distribution to the exact results ( solid line ) for the constant , square - root , and ellipsoidal barriers .",
    "remarkably , the approximation perform very well over a wide range in @xmath142 , and specifically better than @xmath117 for @xmath173 ; in terms of halo masses , for a standard cold dm spectrum the range translates into @xmath174 with @xmath144 .",
    "note that the mass range where the approximation works to this accuracy level becomes larger for higher descendant mass and smaller redshift difference ; actually , for @xmath175 , the approximation works very well for all the masses of cosmological interest .",
    "once the conditional first crossing distribution is known , the conditional mass function can be computed as @xmath176 in fig .",
    "6 we illustrate the outcomes at different redshifts ( linestyle - coded ) , computed by inserting our approximation eq .",
    "( 28 ) into eq .",
    "note that for small redshift difference @xmath175 our result concurs with that by zhang et al .",
    "( 2008b ) .",
    "in this section we apply our main results given by eq .",
    "( 20 ) and ( 28 ) to study various quantities of interest in halo statistics , and compare them with the outcomes of @xmath0-body simulations .",
    "the rates at which dm halos of given mass are created by merging of smaller ones is an essential ingredient in galaxy formation and evolution models . to recall some examples ,",
    "these rates have been used to investigate agn / quasar activity ( e.g. , wyithe & loeb 2003 ; mahmood et al .",
    "2005 ; lapi et al . 2006 ) , fir / submm - selected galaxies ( e.g. , lapi et al . 2011 ; cai et al .",
    "2013 ) , lyman break galaxies and cosmic reionization ( e.g. , kolatt et al . 1999 ; mao et al .",
    "2007 ) , abundances of binary supermassive black holes and related coalescence rates ( e.g. , milosavljevic & merritt 2001 ; volonteri et al .",
    "2002 ) , astrophysics of first stars ( e.g. , santos et al . 2002 ; scannapieco et al . 2003 ) , galaxy clustering ( e.g. , percival et al .",
    "2003 ; xia et al .",
    "2012 ) , statistics of galaxy - galaxy gravitational lensing ( e.g. , lapi et al . 2012 ) .    as discussed in the references above",
    "( see also cavaliere et al .",
    "1991 , blain & longair 1993 , sasaki 1994 , haehnelt et al .",
    "1998 ) , to address these issues one can not rely on the total derivative @xmath177 of the halo mass function , because it includes a balance between the rate of halo creation by merging of smaller ones , and the rate of halo destruction by merging into larger ones . indeed",
    ", the total derivative can be positive or negative , as a consequence of the fact that small masses are dominated by the destruction and high masses by the creation term .",
    "extracting from @xmath177 the rates of halo creation is actually a non - trivial task .",
    "such a delicate issue can be attacked with the excursion set approach ( see lacey & cole 1993 , kitayama & suto 1996 , mahmood & rajesh 2005 , moreno et al . 2009 ) .",
    "the problem is that in such a framework all halos continuously merge with other ones , and therefore are newly - born to some extent ; as shown below , pursuing this viewpoint leads to divergent expressions for the creation rates , that need to be regularized . on the other hand , to obtain a finite answer without the need for a regularization , some of the aforementioned authors have envisaged that a new halo is born only when its change in mass during a merger has been substantial , i.e. , the halo has undergone a major merger . in the above literature such major merger rates",
    "are usually dubbed ` formation rates ' , to distinguish them from the ` creation rates ' that instead are computed irrespective of the mass change during the merger event .",
    "given that both these quantities are widely used in the literature and extremely relevant for galaxy formation models , our purpose here is to provide novel analytic expressions of the creation and formation rates for general moving barriers .",
    "we start by computing the rate @xmath178 at which a halo of mass @xmath41 originates from a progenitor halo with mass in the range between @xmath131 and @xmath132 over an infinitesimal timestep @xmath179 ( e.g. , kitayama & suto 1996 , their eq .  8) ; in other words , this quantity represents the progenitor distribution for infinitesimal look - back times .",
    "it can be derived from the above expression eq .",
    "( 28 ) on taking the limit @xmath180 and changing variable from @xmath181 to @xmath131 , i.e. , @xmath182 .",
    "in such a limit @xmath183 , and the result reads appearing for @xmath180 in the exponential and in the square bracket of eq .  ( 28 ) are subdominant since @xmath184 , for any finite value of @xmath181 . on the other hand ,",
    "if @xmath181 would also tend to zero ( corresponding to @xmath185 ) , then the limit would become ill - defined and some form of regularization would be needed .",
    "we will come back to the issue below in this section when dealing with the creation rates . ]",
    "@xmath186\\right\\}~,\\ ] ] in terms of the quantities @xmath187~,\\\\ & & \\nonumber\\\\ & & \\bar c_1\\equiv \\beta\\,\\gamma\\,(q\\nu)^{-\\gamma+1/2}~,\\\\ & & \\nonumber\\\\ & & \\nonumber \\bar c_2\\equiv -{\\beta\\gamma\\,(1-\\gamma)\\over 2}\\,(q\\nu)^{-\\gamma+1/2}~\\end{aligned}\\ ] ] that depend only on the self - similar variable @xmath188 .",
    "the above expression coincides with that obtained by zhang et al .",
    ".    then the halo formation rates are given by ( see , e.g. , kitayama & suto 1996 , their eqs .  8 and 13 )",
    "@xmath189 where @xmath190 is a suitable fraction of the final mass @xmath41 , typically @xmath191 ; as mentioned at the beginning of this section , the rationale of the above expression is that a new halo is formed if more than half of its final mass is acquired during the merger , i.e. , if the merger has been a ` major ' one .",
    "note that to simplify the notation we have indicated the unconditional mass function with @xmath0 in place of @xmath192 .",
    "using eq .",
    "( 30 ) and changing variable from @xmath131 to @xmath193 yields @xmath194~.\\ ] ] remarkably , the integrals can be carried out analytically and we obtain @xmath195~,\\end{aligned}\\ ] ] with @xmath196 .",
    "this expression for a general moving barrier constitutes a novel result . in fig .",
    "7 we illustrate the formation rates as a function of halo mass at different redshifts , for the constant , square - root and ellipsoidal barriers .",
    "on the other hand , the halo ` creation ' rates are given by ( see , e.g. , kitayama & suto 1996 , their eqs .  8 and 10 ) @xmath197 this constitutes the limit for @xmath198 in the expression for the formation rates ; as mentioned at the beginning of this section , the rationale of the above expression is that a new halo is continuously created by merging of smaller ones , irrespective of the mass change during the merger .",
    "plainly , the integral in eq .",
    "( 35 ) does not converge , because the term proportional to @xmath199 in eq .",
    "( 34 ) blows up when @xmath200 ( and since we are considering infinitesimal time - steps @xmath179 , even the expression of the integrand in eq .",
    "35 would be ill - defined around @xmath185 , cf .",
    "the footnote concerning eq .",
    "however , this divergence ( or ill - definiteness ) is easily recognized to be unphysical , being related to the continuum nature of this treatment where infinitesimal mass changes can take place .",
    "in fact , one is actually counting the transition of an object into itself ; this has been pointed out for a constant barrier by kitayama & suto ( 1996 ) , by showing that the same divergence is present in the destruction rate ( that can be obtained from the creation rate and the unconditional distribution using bayes theorem ) , and that the two exactly cancels out in the difference of the rates to yield the total derivative of the mass function .    here",
    "we derive a finite result for the creation rate on exploiting the @xmath201regularization technique for divergent integrals ; a brief primer on the latter is provided in appendix a. first of all , we introduce in eq .",
    "( 35 ) a cutoff @xmath49 , and rewrite conveniently the upper integration limit as @xmath202",
    ". then we change variable from @xmath131 to @xmath193 ; this turns the upper limit of integration into @xmath203^{-1/2}\\simeq \\lambda |{\\rm d}\\log m/{\\rm d}\\log s|^{1/2}$ ] , and we obtain @xmath204~.\\ ] ] only the first integral diverges , and according to the procedure outlined in appendix a , we find the @xmath1-regularized value @xmath205 finally , we obtain for the creation rates @xmath206 here we have highlighted for compactness the factor @xmath207 , which depends only on the self - similar variable @xmath208 at given power spectrum . the expression of eq .  ( 38 ) constitutes a novel result . in fig .",
    "8 we illustrate the creation rates as a function of halo mass at different redshifts , for the constant , square - root and ellipsoidal barriers .    now to compare our results with @xmath0-body simulations ( see moreno et al .",
    "2009 ) , we compute the creation time distributions @xmath209 ; this is defined as the time normalized creation rate @xmath210 using our expressions eq .  ( 21 ) and ( 38 ) we can write @xmath211 this shows that the creation time distribution can be put in self - similar form . in fig .",
    "9 we illustrate the outcomes for different barriers with the solid lines .",
    "note that our result for non - constant barriers is somewhat different from that obtained by percival & miller ( 1999 ) on using bayes theorem and assuming a uniform @xmath212 distribution at given @xmath62 ; their outcome is still given by eq .",
    "( 40 ) but with @xmath213 , and is illustrated by the dotted lines in fig .",
    "9 ; the crosses refer to the results of cosmological @xmath0-body simulations ( see moreno et al .",
    "we find a very good agreement between the @xmath0-body data and our result for the ellipsoidal barrier .",
    "finally , for the sake of completeness , we also compare the formation and creation rates with two their proxies often adopted in the literature ; it is beyond the scope of the present paper to discuss their underlying theoretical background ( but see   1 for a quick overview ) .",
    "the first is obtained by taking the ` positive ' term in the cosmic time derivatives of the mass function ( see haehnelt et al .",
    "1998 , blain & longair 1993 , sasaki 1994 ) ; using our approximated expression in eq .",
    "( 21 ) one obtains @xmath214 ^ 2+{2\\beta\\gamma(1-\\gamma)\\over \\beta ( 1-\\gamma)+(q\\nu)^\\gamma}\\right\\}~.\\ ] ] for brevity we will refer to this prescription as ` positive ' rate .",
    "the second has been proposed by sheth & pitman ( 1997 ) , based on the analogy between the excursion set approach with a white - noise power spectrum and a discrete poisson model of binary coagulation with additive kernel .",
    "their prescription writes @xmath215 an expression strictly holding in the limit @xmath101 , i.e. , large masses . for brevity",
    "we will refer to this prescription as ` coagulation ' rate . in fig .",
    "10 we illustrate the creation , positive , formation , and coagulation rates ( color code ) as a function of halo mass at different redshift , for an ellipsoidal barrier ; the former three rates are very similar for masses @xmath216 and redshift @xmath217 , with somewhat larger differences at lower redshift and smaller masses .",
    "the coagulation rate is substantially lower at small masses , although converges to the other prescriptions at large masses ( where actually eq .  42 is supposed to hold ) .",
    "the halo conditional mass function can be exploited to construct a merger tree , i.e. , a numerical realization of the halo merger process .",
    "this procedure with its delicate issues has been extensively discussed in the literature ( see kauffmann & white 1993 ; somerville & kolatt 1999 ; cole et al .",
    "2000 ; parkinson et al .",
    "2008 ; neistein & dekel 2008 ; zhang et al .",
    "2008a ) , and is beyond the scope of the present paper ; however , from eq .",
    "( 30 ) we can derive the average growth history of dm halos , that would obtain after averaging over many realization of a full merger tree . to this purpose",
    ", we first compute the rate of accretion onto a mass @xmath41 at time @xmath60 as @xmath218 and then integrate backward in time for @xmath219 the first - order differential equation provided by the relation @xmath220,t)$ ] .    to derive the ` mean ' evolutionary track of an individual halo we set the lower integration limit @xmath221 in eq .",
    "( 43 ) to @xmath222 ( see miller et al . 2006 , their eq .",
    "4 ) ; practically , a lower limit is provided by the ` mass resolution ' of the tree . note that , as shown by neistein & dekel ( 2008 ) , there is no double - counting issue associated to the range of integration since in the excursion set framework the typical merger event is not binary but involves multiple progenitors or substantial mass accretion , even for infinitesimal time - steps ; this is mirrored in the integrand of eq .",
    "( 43 ) , which is not symmetric with respect to @xmath131 and @xmath223 .    following neistein et al .",
    "( 2006 , see their appendix and eqs .",
    "31 and 33 ) we can also compute a first - order , analytical estimate of the ` main progenitor ' evolutionary track by setting @xmath224 ; this corresponds to consider at each branch of a merger tree only the most massive progenitor .",
    "the ` mean ' and the ` main progenitor ' growth histories for different final masses at @xmath225 are illustrated by the blue and red lines in the top panel of fig .",
    "we stress that for the first time these outcomes have been obtained on adopting the ellipsoidal barrier , and as such extend previous analysis based on the constant barrier ( e.g. , miller et al .",
    "2006 ; neistein et al .",
    "2006 ) and constitute novel results .",
    "the main progenitor history is plainly biased toward early - times relative to the mean one , and can be considered the typical history of halos residing in rich environments or onto peaks of the initial density perturbation fields .    it is worth nociting that we recover the typical two - stage evolution of a halo concurrently found in many state - of - the - art @xmath0-body simulations and semi - analytic studies ( see zhao et al .",
    "2003 ; fakhouri et al .",
    "2010 ; wang et al . 2011",
    "; lapi & cavaliere 2011 ) ; such evolution comprises an early fast collapse and a late slow accretion , roughly separated by the epoch when the halo accretion timescale becomes comparable to the hubble time .",
    "this separation epoch is highlighted by the dots on each evolutionary track .    in fig .",
    "12 we compare our results with the growth histories extracted from @xmath0-body simulations by mcbride et al .",
    "( 2009 ; see also earlier works by wechsler et al .",
    "2002 , van den bosch 2002 ) .",
    "these authors have shown that the halo mass growth from simulations can be parameterized as @xmath226 in terms of two shape parameters @xmath227 and @xmath110 ; for galactic halos with current mass @xmath228 the average values @xmath229 and @xmath230 apply .",
    "the corresponding evolution is illustrated in the figure by crosses .",
    "our reference result for the growth history of a halo with mass @xmath231 is reported as a cyan line . however , for fair comparison with mcbride et al .",
    "( 2009 ) , we must redo the computation after applying two changes : first , we include in the minimum mass @xmath221 entering eq .",
    "( 43 ) their mass resolution of @xmath232 ( green line ) ; second , we modify our normalization of the mass variance @xmath25 to match their value @xmath233 ( orange line ) .",
    "our overall outcome is in striking agreement with the @xmath0-body result .    the bottom panel of fig .",
    "11 is focused on evolutionary tracks starting at @xmath234 instead of @xmath225 . comparing the two panels ,",
    "it is evident that the histories ending at @xmath234 feature a more rapid evolution ; for example , halos of @xmath235 at @xmath234 are still in , or very close to , their fast collapse stage , while the same halos at @xmath225 are well within the slow accretion regime .",
    "this implies that the modeling of the baryonic processes occurring inside a given halo should be quite different , depending on whether its formation occurred at low or high redshift .    in the vein of a link to observations",
    ", we remark that such massive halos at @xmath236 are the host of bright submillimeter ( submm ) selected galaxies , as demonstrated by studies of the clustering properties and of the cosmic infrared background autocorrelation function ( see cooray et al .",
    "2010 ; xia et al .",
    "specifically , lapi et al . (",
    "2011 ) have shown that these galaxies selected with limiting flux @xmath237 mjy at @xmath238 m exhibit star formation rates in the range @xmath239 yr@xmath5 .",
    "this implies that the fast collapse of massive halos at these substantial redshift @xmath240 originates physical conditions in the associated baryons leading to rapid cooling and condensation into stars . as expected from basic physical arguments and shown by numerical simulations ( e.g. , zhao et al .",
    "2003 , wang et al .",
    "2011 ) , the halo fast collapse includes the rapid merging of large clumps , losing most of their angular momentum by relaxation processes over a few dynamical times ( see lapi & cavaliere 2011 ) .",
    "this concurs with high resolution photometric and spectroscopic observations of @xmath236 galaxies , showing that the star formation occurs in clumps located within the central kpc - sized regions , and that any residual rotational motion is unstable and expected to be dissipated over a few hundred million years ( e.g. , genzel et al .",
    "2011 ) . on the other hand , during the slow accretion stage at low redshift , a quite different baryonic evolution is expected .",
    "the excursion set approach may be exploited to evaluate the correlation between halo abundances and their environment .",
    "this is usually done by computing the ( eulerian ) halo bias ( see mo & white 1996 ; sheth & tormen 1999 ) @xmath241~;\\ ] ] in the expression above what matters is the ratio between the number of halos at redshift @xmath130 with density contrast @xmath212 that will end up in an environment with volume @xmath44 , mass @xmath242 , and density contrast @xmath243 ; we have denoted @xmath192 with @xmath0 to simplify the notation .    since conditions where @xmath244 are relevant in this context , we can not exploit our approximate expression for the conditional mass function derived in   4 ; however , it is rather easy to single out that , when written in terms of the appropriate scaling variable @xmath245 its shape should be close to the unconditional distribution ; this is because the barrier of the conditional problem @xmath246 tend to the unconditional one as @xmath247 . using eqs .",
    "( 21 ) and ( 44 ) one obtains @xmath248\\simeq 1-{2\\over \\delta_c}\\,\\left[1+\\,{{\\rm d}\\log f\\over { \\rm d}\\log\\nu}\\right]~.\\ ] ] where @xmath249 is the unconditional distribution ; the second equality follows from considering that @xmath250 and @xmath251 in the relevant limits @xmath247 and @xmath252 .",
    "note that in this way we obtain the bias function for halos observed at redshift @xmath253 but formed at redshift @xmath254 ; on the other hand , the bias for halos observed as soon they are formed at @xmath255 can be obtained by replacing @xmath256 in eq .",
    "( 45 ) .",
    "our results of using the explicit expression of @xmath257 from eq .",
    "( 21 ) into eq .",
    "( 45 ) are illustrated in fig .",
    "13 as a function of halo mass at different redshifts , for the constant , square - root and ellipsoidal barriers ( color - coded ) ; top panel is for @xmath255 and bottom panel is for @xmath258 .",
    "our results for the ellipsoidal barrier compare well to the outcomes of cosmological @xmath0-body simulations ( crosses ; fit to tinker et al .",
    "2005 ) , although tend to overpredict the asymptotic bias of low - mass halos and slightly underpredict that of high - mass halos ( see also discussion by tinker et al .",
    "we stress that , as explicitly shown by ma et al .",
    "( 2011 , see their table  1 and fig .",
    "1 ) for the case of a constant barrier , the inclusion of non - markovian effects and of stochasticity in the barrier can be relevant in obtaining a better agreement between the bias function computed from the excursion set approach with that measured from @xmath0-body simulations .",
    "the formation and evolution of dark matter halos constitutes a highly complex problem , whose attack ultimately requires cosmological @xmath0-body simulations on supercomputers .",
    "however , some analytic grasp is most welcome to better interpret their outcomes , to provide approximated yet flexible analytic representations of the results , to develop strategies for future simulation setups , and to quickly explore the effects of modifying the excursion set assumptions or the cosmological framework (   1 ) .    to this purpose",
    ", we have exploited the excursion set approach in integral formulation (   2 ) to derive novel , accurate approximated expressions of the unconditional (   3 ) and conditional (   4 ) first crossing distributions , for random walks with uncorrelated steps and general shapes of the barrier .",
    "we find the corresponding approximation of the halo mass functions for cold dark matter power spectra to represent very well the outcomes of state - of - the - art cosmological @xmath0-body simulations .",
    "in addition , we have apllied these results to derive and confront with simulations (   5 ) various quantities of interest in halo statistics , including the rates of halo formation and creation , the average halo growth history , and the halo bias for general moving barriers .    in table  1",
    "we list our main results , recall their location in the paper , and cross - reference to the corresponding equations and figures .",
    "a library of idl - based routines to easily compute the quantities derived in this paper is available at the url ` http://people.sissa.it/\\sim lapi / rates ` ( currently under construction ) .",
    "finally , we have discussed how our results are affected when considering random walks with correlated instead of uncorrelated steps ( appendix b ) , and warm instead of cold dark matter power spectra ( appendix c ) .",
    "we stress that above and around the warm dark matter free - streaming mass scale , our approximations to the halo mass function agree very well with the outcomes of current @xmath259body simulations .",
    "work supported in part by asi , inaf and miur .",
    "we thank the referee for constructive comments and helpful suggestions .",
    "we acknowledge stimulating discussions with a. cavaliere , p.s .",
    "corasaniti , g. de zotti , s. liberati , j. moreno , m. musso , f. shankar , and g. pradisi .",
    "al thanks sissa for warm hospitality .",
    "here we provide a brief primer on the @xmath1-regularization technique for divergent series and integrals , helpful in   5.1 ; the interested reader can find more mathematical details and physical applications in classic textbooks like hardy ( 1949 ) , birrell & davies ( 1984 ) , and elizalde et al .",
    "( 1994 ) .",
    "the @xmath1-function was originally defined by euler as @xmath260 this series is convergent for any complex number @xmath261 with @xmath262 , i.e. , real part exceeding @xmath263 .",
    "riemann suggested to extend the definition of @xmath264 to the whole complex plane by analytic continuation .",
    "for example , one can use the expression involving the dirichlet alternating series @xmath265 which coincides with the standard definition above for @xmath262 but is well defined for any @xmath261 with @xmath266 except the point @xmath267 which is a single pole . for @xmath268 it can be shown that @xmath264 features the approximate behavior @xmath269 where @xmath270 is the euler - mascheroni constant .",
    "in addition , riemann discovered that the @xmath1-function satisfies the functional equation @xmath271 where @xmath272 is the euler @xmath273-function .",
    "this can be used to extend the definition of @xmath264 even to values of @xmath261 with @xmath274 . in particular , for @xmath275 the functional equation yields @xmath276 this is the origin of the weird - looking expression @xmath277 in fact , the reader should keep in mind that @xmath264 for @xmath278 is only _ formally _ related to the infinite sum at the second and third member .",
    "the value @xmath279 derived above can be effectively used to regularize the divergent improper integral @xmath280 this can be done by replacing the integral with a series , that turns out to be closely related to @xmath279 , in the form @xmath281    integrals involving more general integrands but with the same diverging behavior can also be easily regularized by adding and subtracting convenient quantities and using the result of eq .",
    "for example , we show below how to regularize the divergent integral appearing in   5.2 ( @xmath282 is a positive constant ) : @xmath283_0^{\\eta\\lambda}-\\eta\\lambda\\right\\}+{\\eta\\over 2}=\\\\ & & \\nonumber\\\\ \\nonumber & = & \\eta\\lambda-\\sqrt{\\pi\\over 2}\\ , k-\\eta\\lambda+{\\eta\\over 2}=-\\sqrt{\\pi\\over 2}\\ , k+{\\eta\\over 2}~.\\end{aligned}\\ ] ]",
    "in the main text we have been concerned with the first crossing problem when the steps of the random walk are uncorrelated . in this appendix",
    "we discuss how the integral formulation of the excursion set approach introduced in   2 can be modified to account for some degree of correlation between the steps .",
    "recently , correlated random walks have received considerable interest ( see paranjape et al .",
    "2012 ; musso & sheth 2012 ) ; in fact , it may well be that such models are more realistic .",
    "this is because the random walk @xmath284 is truly brownian , i.e. , with uncorrelated steps , only if a sharp filter function in fourier - space is adopted .",
    "however , as pointed out in   2 in this case there is an ambiguity of a sort in associating a mass to the filtering scale . on the other hand ,",
    "using a real - space top - hat window function gives a well - defined relation between mass and smoothing scale , but necessarily introduces some degree of correlations among the steps of the random walk .",
    "note that for the slowly - varying cold dm power spectra , this problem is somewhat academic , since the shape of @xmath285 depends very weakly on the choice of the filter function ; however , it is not so for , e.g. , warm dm spectra ( see discussion by benson et al .",
    "in addition , correlations between the steps of the walk can also be introduced by non - gaussian features in the initial spectrum of perturbations ( see maggiore & riotto 2010c ) .    for the sake of definiteness , here we mainly consider the extreme instance according to which the steps of the random walk are _ completely _ correlated .",
    "then one expects that the walk @xmath284 does not proceed through stochastic zigzags , but instead grows almost monotonically with @xmath62 .",
    "this means that if @xmath68 first exceeded the barrier @xmath71 at @xmath62 , it was certainly below that at all @xmath83 .",
    "then the constraints imposed by eq .",
    "( 12 ) is superfluous and @xmath286 holds for @xmath287 to a very good approximation . simple algebra yields @xmath288~,\\ ] ] which constitutes the counterpart of eq .",
    "( 13 ) for completely correlated steps .",
    "differentiating with respect to @xmath62 leads to the first crossing distribution @xmath289~.\\ ] ] specializing to the barrier shape @xmath94 yields @xmath290~.\\ ] ] note that in the constant barrier case ( @xmath115 ) , this is exactly half of the result for uncorrelated steps , and actually coincides with the expression found by press & schechter ( 1974 ) .    in fig .",
    "14 we compare the unconditional first crossing distribution for uncorrelated ( solid lines ) and completely - correlated ( dashed lines ) steps .",
    "it is apparent that the outcome of cosmological @xmath0-body simulations ( crosses ) lies much closer to the excursion set result for uncorrelated steps .",
    "this is also the case if one consider strongly but not completely correlated steps like in the framework developed by musso & sheth ( 2012 ) , whose results are illustrated in fig .",
    "14 by the dotted lines .",
    "all in all , models with correlated steps need much of an improvement before reproducing the halo mass function at a level comparable to models with uncorrelated steps ; this improvement , although only on an effective / empirical basis , may come from considering a stochastic in place of a deterministic barrier possibly including some drift ( see robertson et al . 2009 ; maggiore & riotto 2010b ; corasaniti & achitouv 2011 ) .",
    "in the main text we have performed computations for cold dark matter as a reference . in this appendix",
    "we show that our formulation of the excursion set approach is extremely flexible with respect to changes of the power spectrum .",
    "specifically , here we focus on warm dark matter ( e.g. , dodelson & widrow 1994 ) , and test our approximation to the halo mass function against recent @xmath0-body simulations .    to this purpose , we follow bode et al .",
    "( 2001 ) and barkana et al .",
    "( 2001 ) in modifying the cold dm power spectrum to impose a cutoff below the warm dm free - streaming length scale , and in including the mass - dependent behavior of the linear threshold for collapse @xmath291 enforced by the warm dm particle s residual thermal velocities .",
    "specifically , for the resulting power spectrum we take eqs .  ( 3 ) and ( 4 ) in barkana et al .",
    "( 2001 ) , while for the threshold we take eqs .  ( 7 ) to ( 10 ) in benson et al .",
    "( 2013 ) .    practically , in computing the mass function after eq .  ( 9 ) we exploit our results on the first crossing distribution for an ellipsoidal barrier eq .",
    "( 20 ) , then connect variance @xmath62 and mass @xmath41 with the warm dm power spectrum , and finally introduce the mass - dependent @xmath292 in the result a posteriori .",
    "this procedure provides reasonable results above the free - streaming mass scale .",
    "in fact , in fig .",
    "15 we compare our result on the mass function at @xmath225 for @xmath293 kev with the outcomes from the recent @xmath259body simulation by schneider et al .",
    "( 2012 ) , finding an excellent agreement . however , below the free - streaming mass scale the computations based on the ellipsoidal barrier are quite uncertain , because the barrier @xmath53 itself is poorly understood .",
    "in fact , there is some debate as to whether halos with such small masses can form at all ( see bode et al .",
    "2001 ; wang & white 2007 ) .",
    "if this is the case , the overall result would be a more pronounced cutoff of the mass function just below the free - streaming scale ( see discussion by smith & markovic 2011 ; menci et al .",
    "2012 ; benson et al .",
    "2013 ; also the recent simulations by schneider et al .",
    "2013 ) . to highlight this uncertainty , in fig .",
    "15 we have indicated with a thick line our results above , and with a thin line below , the free - streaming scale .    in fig .",
    "15 we also present the outcomes of the unconditional mass function at different redshifts for values of the warm dm particle mass ( color - coded ) @xmath294 , @xmath295 and @xmath296 kevs , compared with the standard cold dm outcome . as customary",
    "we quote here the fermi - dirac mass @xmath297 , i.e. , the mass that the particles would have if they were thermal relics ( decoupled in thermal equilibrium ) ; this is convenient because the masses of warm dm particles produced in different microscopic scenarios can be easily related to @xmath297 , see de vega & sanchez ( 2012 ) .",
    "all in all , the warm dm results are practically indistinguishable from the cold dm ones at the high mass end , then on approach the free - streaming mass progressively deviate downward ( and then are practically cut - off ) .",
    "the masses where the deviation sets in are smaller for lower fermi - dirac mass , and higher redshift . in particular , we stress that for @xmath298 kev , at redshift @xmath299 and masses @xmath300 the strongly flattening behavior of the halo mass function should be mirrored by the faint end in the luminosity function of lyman break galaxies up to @xmath301 ( e.g. , bouwens et al . 2011 ) ; there dust obscuration should not constitute a relevant issue , and the flattening could be so prominent not to be easily ascribed to supernova feedback ( see mao et al . 2007 ; cai et al .",
    "2013 , in preparation ) .",
    "lcccccccc unconditional first crossing distribution@xmath302 & & 3 & & 20,21 & & 3 + unconditional halo mass function@xmath303 & & 2,3 & & 9,20 & & 4 + conditional first crossing distribution & & 4 & & 28 & & 5 + conditional halo mass function & & 4 & & 28,29 & & 6 + halo formation rates & & 5.1 & & 32,34 & & 7 + halo creation rates & & 5.1 & & 35,38 & & 8,10 + halo creation time distribution & & 5.1 & & 39,40 & & 9 + halo growth history & & 5.2 & & 43 & & 11,12 + halo bias & & 5.3 & & 44,45 & & 13 +"
  ],
  "abstract_text": [
    "<S> we exploit the excursion set approach in integral formulation to derive novel , accurate analytic approximations of the unconditional and conditional first crossing distributions , for random walks with uncorrelated steps and general shapes of the moving barrier ; we find the corresponding approximations of the unconditional and conditional halo mass functions for cold dark matter power spectra to represent very well the outcomes of state - of - the - art cosmological @xmath0-body simulations . </S>",
    "<S> in addition , we apply these results to derive , and confront with simulations , other quantities of interest in halo statistics , including the rates of halo formation and creation , the average halo growth history , and the halo bias . </S>",
    "<S> finally , we discuss how our approach and main results change when considering random walks with correlated instead of uncorrelated steps , and warm instead of cold dark matter power spectra . </S>"
  ]
}