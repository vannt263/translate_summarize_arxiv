{
  "article_text": [
    "in this paper we mainly consider one of the frequently studied models for random geometric graphs , namely the gilbert model .",
    "suppose that @xmath2 is a @xmath3 box and that @xmath4 is a poisson process in it with density 1 .",
    "the points of the process form the vertex set of our graph .",
    "there is a parameter @xmath5 governing the edges : two points are joined if their ( euclidean ) distance is at most @xmath5 .",
    "having formed this graph we can ask whether it has any of the standard graph properties , such as connectedness . as usual",
    ", we shall only consider these for large values of @xmath6 .",
    "more formally , we say that @xmath7 has a property _ with high probability _",
    "( abbreviated to whp ) if the probability that @xmath8 has this property tends to one as @xmath6 tends to infinity .",
    "penrose  @xcite proved that the threshold for connectivity is @xmath9 .",
    "in fact he proved the following very sharp result : suppose @xmath10 for some constant @xmath11 .",
    "then the probability that @xmath12 is connected tends to @xmath13 .",
    "he also generalised this result to find the threshold for @xmath1-connectivity : namely @xmath14 .",
    "moreover , he found the `` obstruction '' to @xmath1-connectivity .",
    "suppose we fix the vertex set ( i.e. , the point set in @xmath2 ) and `` grow '' @xmath5 .",
    "this gradually adds edges to the graph . for a monotone graph property @xmath15",
    "let @xmath16 denote the smallest @xmath5 for which the graph on this point set has the property @xmath15 .",
    "penrose showed that @xmath17 whp : that is , as soon as the graph has minimum degree @xmath1 it is @xmath1-connected whp .",
    "he also considered the threshold for @xmath8 to have a hamilton cycle .",
    "obviously a necessary condition is that the graph is 2-connected . in the normal ( erds - rnyi )",
    "random graph this is also a sufficient condition in the following strong sense .",
    "if we add edges to the graph one at a time then the graph becomes hamiltonian exactly when it becomes 2-connected ( see @xcite,@xcite,@xcite and @xcite ) .",
    "penrose , conjectured that the same is true for a random geometric graph . in this paper",
    "we prove the following theorem proving the conjecture .",
    "[ t:2d - gilbert ] suppose that @xmath7 the two - dimensional gilbert model .",
    "then @xmath18 whp .    combining this with the earlier result of penrose",
    "we see that , if @xmath19 then the probability that @xmath8 has a hamilton cycle tends to @xmath13 .",
    "some partial progress has been made on this conjecture previously .",
    "petit  @xcite showed that if @xmath20 tends to infinity then @xmath8 is , whp , hamiltonian , and daz , mitsche and prez  @xcite proved that if @xmath21 for some @xmath22 then @xmath8 is hamiltonian whp .",
    "( obviously , @xmath8 is not hamiltonian if @xmath23 since whp  @xmath8 is not connected ! ) finally in @xcite balogh , kaul and martin proved penrose s conjecture for the special case of the @xmath24 norm in two dimensions .",
    "our proof generalises to higher dimensions , and to other norms .",
    "the gilbert model makes sense with any norm and in number of dimensions : we let @xmath25 be the @xmath26-dimensional hypercube with volume @xmath6 .",
    "we prove the analogue of theorem  [ t:2d - gilbert ] in this setting .",
    "[ t : multi - dim - gilbert ] suppose that the dimension @xmath26 and @xmath27 , a @xmath28-norm for some @xmath29 , are fixed .",
    "let @xmath7 be the resulting gilbert model",
    ". then @xmath18 whp .",
    "the proof is very similar to that of theorem  [ t:2d - gilbert ] .",
    "however , there are some significant extra technicalities .",
    "to give an idea why these occur consider connectivity in the gilbert model in the cube @xmath30 ( with the euclidean norm ) .",
    "let @xmath31 be the volume of a sphere of radius @xmath5 .",
    "we count the expected number of isolated points in the process which are away from the boundary of the cube .",
    "the probability a point is isolated is @xmath32 so the expected number of such points is @xmath33 , so the threshold for the existence of a central isolated point is about @xmath34 .",
    "however , consider the probability that a point near a face of the cube is isolated : there are approximately @xmath35 such points and the probability that they are isolated is about @xmath36 ( since about half of the sphere about the point is outside the cube  @xmath30 ) .",
    "hence , the expected number of such points is @xmath37 , so the threshold for the existence of an isolated point near a face is about @xmath38 . in other words isolated points are much more likely near the boundary .",
    "these boundary effects are the reason for many of the extra technicalities .",
    "we also consider a second model for random geometric graphs : namely the @xmath0-nearest neighbour graph . in this model",
    "the initial setup is the same as in the gilbert model : the vertices are given by a poisson process of density one in the square @xmath2 , but this time each vertex is joined to its @xmath0 nearest neighbours ( in the euclidean metric ) in the box .",
    "this naturally gives rise to a @xmath0-regular directed graph , but we form a simple graph @xmath39 by ignoring the direction of all the edges .",
    "it is easily checked that this gives us a graph with degree between @xmath0 and @xmath40 .    xue and",
    "kumar @xcite showed that there are constants @xmath41 such that if @xmath42 then the graph @xmath43 is , whp , not connected , and that if @xmath44 then @xmath43 is , whp , connected .",
    "balister , bollobs , sarkar and walters @xcite proved reasonably good bounds on the constants : namely @xmath45 and @xmath46 , and later @xcite proved that there is some critical constant @xmath47 such that if @xmath48 for @xmath49 then the graph is disconnected whp , and if @xmath48 for @xmath50 then it is connected whp .",
    "moreover , in  @xcite , they showed that in the latter case the graph is @xmath51-connected whp  for any fixed @xmath52 .",
    "we would like to prove a sharp result like the above : i.e. , that as soon as the graph is 2-connected it has a hamilton cycle .",
    "however , we prove only the weaker statement that some ( finite ) amount of connectivity is sufficient .",
    "explicitly , we show the following .",
    "[ t : knear ] suppose that @xmath53 , that @xmath39 is the @xmath0-nearest neighbour graph , and that @xmath8 is @xmath1-connected for @xmath54 whp .",
    "then @xmath8 has a hamilton cycle whp .",
    "we divide the proof into five parts : first we tile the square @xmath2 with small squares in a standard tessellation argument .",
    "secondly we identify `` difficult '' subsquares .",
    "roughly , these will be squares containing only a few points , or squares surrounded by squares containing only a few points .",
    "thirdly we prove some lemmas about the structure of the difficult subsquares . in stage  4",
    "we deal with the difficult subsquares .",
    "finally we use the remaining easy subsquares to join everything together .",
    "let @xmath55 ( so @xmath56 ) , and let @xmath5 be the random variable @xmath57 is 2-connected@xmath58 .",
    "let @xmath59 where @xmath47 is a large constant to be chosen later ( 1000 will do ) .",
    "we tessellate the box @xmath2 with small squares of side length @xmath51 .",
    "whenever we talk about distances between squares we will always be referring to the distance between their centres .",
    "moreover , we will divide all distances between squares by @xmath51 , so , for example , a square s four nearest neighbours all have distance one .    by the result of penrose  @xcite mentioned in the introduction",
    "we may assume that @xmath60 : formally the collection of point sets which do not satisfy this has measure tending to zero as @xmath6 tends to infinity , and we ignore this set .",
    "hence points in squares at distance @xmath61 are always joined and points in squares at distance @xmath62 are never joined .",
    "we call a square _ full _ if it contains at least @xmath63 points for some @xmath63 to be determined later ( @xmath64 will do ) , and _ non - full _ otherwise .",
    "let @xmath65 be the set of non - full squares .",
    "we say two non - full squares are joined if their @xmath24 distance is at most @xmath66 and define @xmath67 to be the collection of non - full components .",
    "first we bound the size of the largest component of non - full squares .",
    "[ l : non - full - size ] for any @xmath63 , the largest component of non - full squares in the above tesselation has size at most @xmath68 whp .",
    "also , the largest component of non - full squares including a square within @xmath47 of the boundary of @xmath2 has size at most @xmath69 whp . finally , there is no non - full square within distance @xmath70 of a corner whp .",
    "we shall make use of the following simple result : suppose that @xmath8 is any graph with maximal degree @xmath71 and @xmath72 is a vertex in @xmath8",
    ". then the number of connected subsets of size @xmath6 of @xmath8 containing @xmath72 is at most @xmath73 ( see e.g. , problem 45 of @xcite ) .",
    "hence , the number of potential components of size @xmath74 containing a particular square is at most @xmath75 so , since there are less than @xmath6 squares , the total number of such potential components is at most @xmath76 .",
    "the probability that a square is non - full is at most @xmath77 .",
    "hence , the expected number of components of size at least @xmath74 is at most @xmath78 which tends to zero as @xmath6 tends to infinity : i.e. , whp , no such component exists .    for the second part",
    "there are at most @xmath79 squares within distance @xmath47 of the boundary of @xmath2 and the result follows as above .",
    "finally , there are only @xmath80 squares within distance @xmath47 of a corner .",
    "since the probability that a square is non - full tends to zero we see that there is no such square whp .    note that this is true independently of @xmath63 which is important since we will want to choose @xmath63 depending on @xmath74 .",
    "in the rest of the argument we shall assume that there is no non - full component of size greater than @xmath74 , no non - full component of size @xmath69 within @xmath47 of an edge and no non - full square within @xmath70 of a corner .    between these components of non - full squares",
    "there are numerous full squares . to define this more precisely let @xmath81 be the graph with vertex set the small squares , and where each square is joined to all others within @xmath82 of this square ( in the euclidean norm ) .",
    "the graph @xmath83 has one very large component @xmath84 which we call the _ sea_. we call the squares in this sea the _ easy _ squares and the remaining squares the _ difficult _ squares .",
    "the idea is that it is trivial to find a cycle visiting every point of the process in a square in the sea @xmath84 , and that we can extend this cycle to a hamilton cycle by adding each non - full component ( and any full squares cut off by it ) one at a time .",
    "however , it is easier to phrase the argument by starting with the difficult parts and then using the sea of full squares .",
    "_ stage 3 : the structure of the difficult subsquares .",
    "_    consider one component @xmath85 of the non - full squares , and suppose that it has size @xmath86 . by lemma  [ l : non - full - size ]",
    "we know @xmath87 .",
    "we will also consider @xmath88 : the @xmath89-blow - up of @xmath90 : that is the set of all squares with @xmath24 distance at most @xmath89 from a square in @xmath90 .",
    "now some full squares may be cut off from the rest of the full squares by non - full squares in @xmath90 .",
    "more precisely the graph @xmath91 has one giant component @xmath92 ; we call @xmath93 the _ cutoff _ squares . note that @xmath31 is a superset of the sea @xmath94 , since we have only removed one component of the non - full squares",
    ". we shall see later ( corollary  [ c : sea ] ) that the sea is @xmath95 .",
    "we split the cutoff squares into two classes : those with a neighbour in @xmath31 ( in @xmath81 ) which we think of as being `` close '' to @xmath31 , and the rest , which we shall call _ far _ squares .",
    "all the close squares must be in @xmath90 ( since otherwise they would be part of @xmath31 ) .",
    "however , we do not know anything about the far squares : they may be full or non - full .",
    "see figure  [ fig : far - close ] for a picture .",
    "[ l : far ] no two far squares are more than @xmath24 distance @xmath96 apart .",
    "remark : this does not say whp   since we are assuming this non - full component has size at most @xmath74 .",
    "suppose not .",
    "suppose , first , that no point of @xmath90 is within @xmath47 of the edge of @xmath2 , and that the two far squares are at horizontal distance at least @xmath96 .",
    "then consider the left most far square .",
    "all squares which are to the left of this and with distance to this square less than @xmath82 must be close and thus in @xmath90 . similarly with the right most far square .",
    "also at least @xmath82 squares ( in fact nearly @xmath97 ) in each of at least @xmath96 columns between the orginal two far squares must be in @xmath90 .",
    "this is a total of about @xmath98 which is a contradiction ( provided we chose @xmath47 reasonably large ) .",
    "if there is a point of @xmath90 within @xmath47 of the boundary then the above argument gives more than @xmath69 non - full squares .",
    "indeed , either it gives half of each part of the above construction , or it gives all of one end and all the side parts .",
    "this contradicts the second part of our assumption about the size of non - full components .",
    "we do not need to consider a component near two sides : it can not be large enough to be near two sides .",
    "it also can not go across a corner , since no square within distance @xmath70 of a corner is non - full .",
    "this result can also be deduced from a result of penrose as we do in the next section .",
    "we have the following instant corollary .",
    "[ c : far ] the graph @xmath81 restricted to the far squares is complete .    [",
    "c : cutoff ] the set @xmath99 of neighbours in @xmath81 of the cutoff squares @xmath93 is contained in @xmath88 .",
    "we prove that @xmath100 the @xmath47-blow - up of @xmath90 . indeed ,",
    "suppose not .",
    "let @xmath101 be a square in @xmath102 .",
    "first , @xmath101 can not be a neighbour of any square in @xmath31 or @xmath101 would also be in @xmath31 ; i.e. , @xmath101 is a far square .",
    "now , let @xmath103 be any square with @xmath24 distance @xmath104 from @xmath101 .",
    "the square @xmath103 can not be in @xmath90 since then @xmath101 would be in @xmath105 .",
    "therefore , @xmath103 can not be a neighbour of any square in @xmath31 since then it would be in @xmath31 and , since @xmath101 and @xmath103 are joined in @xmath106 , @xmath101 would be in @xmath31 ; i.e. , @xmath103 is also a far square .",
    "hence , @xmath101 and @xmath103 are both far squares with @xmath24 distance @xmath104 which contradicts lemma  [ l : far ] .",
    "in particular , corollary  [ c : cutoff ] tells us that the sets of squares cutoff by different non - full components and all their neighbours are disjoint ( obviously the @xmath89-blow - ups are disjoint ) .",
    "the final preparation we need is the following lemma .",
    "[ l : connected - boundary ] the set @xmath107 is connected in @xmath81 .",
    "since the proof will be using a standard graph theoretic result , it is convenient to define one more graph @xmath108 : again the vertex set is the set of small squares , but this time each square is joined only to its four nearest neighbours : i.e. , @xmath108 is the ordinary square lattice . we need two quick definitions .",
    "first , for a set @xmath109 we define the _ boundary _ @xmath110 of @xmath111 to be set of vertices in @xmath112 that are neighbours ( in @xmath113 ) of a vertex in @xmath111 .",
    "secondly , we say a set @xmath111 in @xmath113 is _ diagonally connected _ if it is connected when we add the edges between squares which are diagonally adjacent ( i.e.  at distance @xmath114 ) to @xmath81 .",
    "the lemma we need is the following ; since its proof is short we include it here for completeness .",
    "[ l:1-boundary ] suppose that @xmath111 is any subset of @xmath108 with @xmath111 and @xmath112 connected .",
    "then @xmath115 is diagonally connected : in particular , it is connected in @xmath81 .",
    "let @xmath116 be the set of edges of @xmath108 from @xmath111 to @xmath112 , and let @xmath117 be the corresponding set of edges in the dual lattice .",
    "consider the set @xmath117 as a subgraph of the dual lattice .",
    "it is easy to check that every vertex has even degree except vertices on the boundary of @xmath108 .",
    "thus we can decompose @xmath117 into pieces each of which is either a cycle or a path starting and finishing at the edge of @xmath108 .",
    "any such cycle splits @xmath108 into two components , and we see that one of these must be exactly @xmath111 and the other @xmath112 . thus @xmath117 is a single component in the dual lattice , and it is easy to check that implies that @xmath110 is diagonally connected .",
    "consider @xmath118 .",
    "this splits into components @xmath119 . by definition",
    "each @xmath120 is connected .",
    "moreover , each @xmath121 is also connected . indeed , suppose @xmath122 .",
    "then there is an @xmath123 path in @xmath108 .",
    "if this is contained in @xmath121 we are done .",
    "if not then it must meet @xmath88 , but @xmath88 is connected .",
    "hence we can take this path until it first meets @xmath88 go through @xmath88 to the point where the path last leaves @xmath88 and follow the path on to @xmath103 .",
    "this gives a path in @xmath121 .",
    "hence , by lemma  [ l:1-boundary ] , we see that each @xmath124 is connected in @xmath81 for each @xmath125 ( where @xmath126 denotes the boundary in @xmath108 ) .",
    "obviously @xmath127 .",
    "as usual , for a set of vertices @xmath128 let @xmath129 $ ] denote the graph @xmath81 restricted to the vertices in @xmath128 .",
    "any two vertices in @xmath130 are connected in @xmath131 $ ] .",
    "suppose not .",
    "without loss of generality assume that , for some @xmath132 , @xmath133 $ ] is connected and that no other @xmath134 is connected via a path to it .",
    "pick @xmath135 and @xmath136 .",
    "both @xmath101 and @xmath103 are in @xmath31 ( since they are not in @xmath88 and @xmath137 by corollary  [ c : cutoff ] ) .",
    "hence there is a path from @xmath101 to @xmath103 in @xmath31 .",
    "consider the last time it leaves @xmath138 .",
    "the path then moves around in @xmath88 before entering some @xmath139 with @xmath140 .",
    "this gives rise to a path in @xmath141 from a point in @xmath142 to a point in @xmath143 , contradicting the choice of @xmath0 .",
    "we now complete the proof of lemma  [ l : connected - boundary ] . to avoid clutter",
    "we shall say that two points are _ joined _ if they are connected by a path .",
    "suppose that @xmath144 .",
    "since @xmath31 is connected there is a path in @xmath31 from @xmath101 to @xmath103 .",
    "if the path is contained in @xmath88 we are done . if not , consider the first time the path leaves @xmath88 .",
    "it must enter one of the @xmath120 , crossing the boundary @xmath134 .",
    "hence @xmath101 is joined to some @xmath145 in @xmath141 .",
    "similarly , by considering the last time the path is not in @xmath88 we see that @xmath103 is joined to some @xmath146 for some @xmath147 .",
    "however , since the claim showed that @xmath148 and @xmath149 are joined in @xmath141 , we see that @xmath101 and @xmath103 are joined in @xmath141 .",
    "[ c : sea ] the set of sea squares @xmath150 .",
    "in particular , for any @xmath85 we have @xmath151 .",
    "we prove that the set @xmath152 is connected in @xmath81 .    given two squares @xmath153 in @xmath154",
    "pick a path in @xmath81 from @xmath101 to @xmath103 .",
    "now for each non - full component @xmath90 in turn do the following .",
    "if the path misses @xmath88 do nothing .",
    "otherwise let @xmath148 be the first point on the path in @xmath88 and @xmath149 be the last point in @xmath88 .",
    "replace the @xmath123 path by the path @xmath155 , any path @xmath156 in @xmath157 and then the path @xmath158 .    at each stage",
    "the modification ensured that the path now lies in @xmath159 . also , the only vertices added to the path are in @xmath88 which is disjoint from all the previous @xmath160 , and thus from all previous sets @xmath161 . hence , when we have done this for all non - full components the path lies in every @xmath161 , i.e. , in @xmath154 .",
    "hence , @xmath154 is connected .",
    "since it contains @xmath84 we must have @xmath162 .",
    "finally , by corollary  [ c : cutoff ] , @xmath163 for all @xmath164 , so @xmath165 .    _ stage 4 : dealing with the difficult subsquares .",
    "_    we deal with each non - full component @xmath85 in turn .",
    "fix one such component  @xmath90 .",
    "let us deal with the far squares first .",
    "there are three possibilities : the far squares contain no points at all , they contain one point in total , or they contain more than one point .",
    "in the first case , do nothing and proceed to the next part of the argument .    in the second case , by the 2-connectivity of @xmath8 , we can find two vertex disjoint paths from this single vertex to points in squares in @xmath31 .",
    "in the third case pick two points in the far squares . again by 2-connectivity we can find vertex disjoint paths from these two vertices to points in squares in @xmath31 .",
    "suppose that one of these paths meets @xmath31 in square @xmath166 and the other in square @xmath167 .",
    "let @xmath168 be the squares containing the previous points on these paths .",
    "no two points in squares at ( euclidean ) distance @xmath169 are joined we see that @xmath170 is within @xmath169 of @xmath166 .",
    "since @xmath171 we have that some square on a shortest @xmath172 path in @xmath108 is in @xmath90 and thus that @xmath173 .",
    "similarly @xmath174 . combining we see that both @xmath166 and @xmath167 are in @xmath107 . by lemma  [ l : connected - boundary ] , we know that @xmath107 is connected in @xmath81 so we can find a path from @xmath166 to @xmath167 in @xmath107 in @xmath81 .",
    "this `` lifts '' to a path in @xmath8 going from the point in @xmath167 to a point in @xmath166 using at most one vertex in each subsquare on the way and never leaving @xmath88 .",
    "place the path from the point in @xmath166 to the far vertex ; round all points in the far region finishing back at the second chosen vertex and then to @xmath167 and then through the sea as above back to @xmath166 .",
    "since @xmath175 , by corollary  [ c : sea ] we have that @xmath176 .",
    "combining , we have a path starting and finishing in the same subsquare of the sea ( i.e. , @xmath166 ) containing all the vertices in the far region .",
    "next we deal with the close squares : we deal with each close square @xmath15 in turn .",
    "since @xmath15 is a close square we can pick @xmath177 with @xmath178 joined in @xmath81 .    if the square @xmath15 has no point in it we ignore it .",
    "if it has one point in it then join that point to two points in @xmath179 .",
    "if it has two or more points in it then pick two of them @xmath153 : and pick two points @xmath180 in @xmath179 .",
    "place the path formed by the edge @xmath181 round all the remaining unused vertices in the cutoff square finishing at @xmath103 and back to the square @xmath179 with the edge @xmath182 in the cycle we are constructing .",
    "the square @xmath179 is a neighbour of @xmath183 so , by corollary  [ c : cutoff ] is in @xmath88 .",
    "since @xmath179 is also in @xmath31 we see , by corollary  [ c : sea ] as above , that @xmath184 .    when we have completed this construction",
    "we have placed every vertex in a cutoff square on one of a collection of paths each of which starts and finishes at the same square in the sea ( although different paths may start and finish in different squares in the sea ) .",
    "we use at most @xmath185 vertices from any square in @xmath92 when doing this so , provided that @xmath186 , there are at least @xmath187 unused vertices in each square of @xmath31 when we finish this .",
    "moreover , obviously the only squares touched by this construction are in @xmath88 and for distinct non - full components these are all disjoint . hence , when we have done this for every non - full component @xmath85 there are at least @xmath187 unused vertices in each square of the sea @xmath84 .",
    "_ stage 5 : using the subsquares in the sea to join everything together .",
    "_    it just remains to string everything together .",
    "this is easy .",
    "take a spanning tree for @xmath84 , the sea of squares . by doubling each edge",
    "we can think of this as a cycle , as in figure  [ fig : tree - gilbert ] .",
    "this cycle visits each square at most @xmath187 times .",
    "( in fact , by choosing a spanning tree such that the sum of the edge lengths is minimal we could assume that it visits each vertex at most six times but we do not need this . )",
    "convert this into a hamilton cycle as follows .",
    "start at an unused vertex in a square of the sea .",
    "move to any ( unused ) vertex in the next square in the tree cycle . then , if this is the last time the tree cycle visits this square visit all remaining vertices and join in all the paths constructed in the first part of the argument , then leave to the next square in the tree cycle . if it is not the last time the tree cycle visits this square then move to any unused vertex in the next square in the tree cycle .",
    "repeat until we complete the tree cycle .",
    "then join in any unused vertices and paths to this square constructed earlier before closing the cycle .",
    "we generalise the proof in the previous section to higher dimensions .",
    "much of the argument is the same , in particular , essentially all of stages four and five .",
    "we include details of all differences but refer the reader to the previous section where the proof is identical .    _ stage 1 : tessellation . _",
    "we work in the @xmath26-dimensional hypercube @xmath25 of volume @xmath6 ( for simplicity we will abbreviate hypercube to cube in the following ) .",
    "as mentioned in the introduction , we no longer have a nice formula for the critical radius : the boundary effects dominate .    instead , we consider the expected number of isolated vertices @xmath188 . we need a little notation : let @xmath189 denote the set @xmath190 and @xmath191 denote lebesgue measure .",
    "we have @xmath192 .",
    "let @xmath193 be such that @xmath194 .",
    "as before fix @xmath47 a large constant to be determined later , and let @xmath195 .",
    "it is easy to see that @xmath196 and @xmath197 .",
    "we tile the cube @xmath25 with small cubes of side length @xmath51 .    as before , let",
    "@xmath198 is 2-connected@xmath58 . by penrose @xcite,@xcite the probability that @xmath199 $ ] tends to zero and we ignore all these points sets .",
    "this time any two points in cubes at distance @xmath200 are joined , and no points in cubes at distance @xmath201 are joined .    _ stage 2 : the `` difficult '' subcubes . _",
    "exactly as before we define non - full cubes to be those containing at most @xmath63 points , and we say two are joined if they have @xmath24 distance at most @xmath66 .",
    "we wish to prove a version of lemma  [ l : non - full - size ] .",
    "however , we have several possible boundaries : for example , in three dimensions we have the centre , the faces , the edges and the corners .",
    "we call a non - full component containing a cube @xmath179 _ bad _ if it consists of at least @xmath202 cubes .",
    "( note a component can be bad for some cubes and not others ) .",
    "the expected number of bad components tends to zero as @xmath6 tends to infinity .",
    "in particular there are no bad components whp .",
    "the number of components of size @xmath74 containing a particular cube is at most @xmath203 .",
    "the probability that a cube is non - full is at most @xmath204 .    since @xmath205 and @xmath197",
    ", the expected number of bad components is at most @xmath206    ( again , note that this is true independently of @xmath63 . )    from now on we assume that there is no bad component .    _ stage 3 : the structure of the difficult subcubes . _    in this stage we will need one extra geometric result of penrose , a case of proposition 2.1 of @xcite or proposition  5.15 of @xcite .    [",
    "p : penrose ] suppose @xmath26 is fixed and that @xmath207 is a @xmath28-norm for some @xmath208",
    ". then there exists @xmath209 such that if @xmath210 ( the positive octant in @xmath211 ) with @xmath24 diameter at least @xmath212 and @xmath101 is the point of @xmath116 with the smallest @xmath213 norm ; then @xmath214    we begin this stage by proving lemma  [ l : far ] for this model .",
    "[ l : far - high - dim ] no two far cubes are more than @xmath24 distance @xmath96 apart .",
    "suppose not .",
    "then let @xmath116 be the set of far cubes , let @xmath101 be the point of @xmath116 closest to a corner in the @xmath213 norm and let @xmath179 be the cube containing @xmath101 .",
    "we know that all the cubes within @xmath215 of a far cube are not in @xmath31",
    ". hence all such cubes which are not far must be close , and thus non - full .",
    "the number of close cubes is at least @xmath216 this shows that the component is bad which is a contradiction .",
    "corollaries  [ c : far ] and  [ c : cutoff ] hold exactly as before .",
    "lemma  [ l : connected - boundary ] also holds , we just need to replace lemma  [ l:1-boundary ] by the following higher dimensional analogue .",
    "note that , even in higher dimensions we say two squares are diagonally connected if their centres have distance @xmath217 .",
    "[ l:1-boundary - hd ] suppose that @xmath111 is any subset of @xmath108 with @xmath111 and @xmath112 connected .",
    "then @xmath115 is diagonally connected : in particular , it is connected in @xmath81 .",
    "let @xmath218 be a ( diagonally connected ) component of @xmath115 .",
    "we aim to show the @xmath219 and , thus , that @xmath115 is diagonally connected .",
    "suppose that @xmath220 is any circuit in @xmath108 .",
    "then the number of edges of @xmath220 with one end in @xmath111 and the other end in @xmath218 is even .",
    "we say that a circuit is contractible to a single point using the following operations .",
    "first , we can remove an out and back edge .",
    "secondly , we can do the following two dimensional move .",
    "suppose that two consecutive edges of the circuit form two sides of a square ; then we can replace them by the other two sides of the square keeping the rest of the circuit the same .",
    "for example , we can replace @xmath221 in the circuit by @xmath222 .",
    "next we show that @xmath220 is contractible .",
    "let @xmath223 denote the weight of the circuit : that is the sum of all the coordinates of all the vertices in @xmath220 . we show that , if @xmath220 is non - trivial , we can apply one of the above operations and reduce @xmath148 .",
    "indeed , let @xmath72 be a vertex on @xmath220 with maximal coordinate sum , and suppose that @xmath224 and @xmath225 are the vertices before and after @xmath72 on the circuit .",
    "if @xmath226 then we can apply the first operation removing @xmath72 and @xmath225 from the circuit which obviously reduces @xmath148 . if not , then both @xmath224 and @xmath225 have strictly smaller coordinate sums than @xmath72 and we can apply the second operation reducing @xmath148 by two .",
    "we repeat the above until we reach the trivial circuit .",
    "now , let @xmath227 be the number of edges of @xmath220 with an end in each of @xmath111 and @xmath218 . the first operation obviously does not change the parity of @xmath227",
    "a simple finite check yields the same for the second operation .",
    "indeed , assume that we are changing the path from @xmath228 to @xmath229 .",
    "let @xmath116 be the set of these four vertices .",
    "if no vertex of @xmath218 is in @xmath116 then obviously @xmath227 does not change .",
    "if there is a vertex of @xmath218 in @xmath116 then , by the definition of diagonally connected , @xmath230 .",
    "hence the parity of @xmath227 does not change .",
    "( it is even if @xmath231 and @xmath232 are both in @xmath111 or both in @xmath112 and odd otherwise . )",
    "suppose that there is some vertex @xmath233 and that @xmath234 is a neighbour of @xmath72 .",
    "let @xmath235 and @xmath236 be neighbours . since @xmath111 and @xmath112 are connected we can find paths @xmath237 and @xmath238 in @xmath111 and @xmath112 respectively . the circuit @xmath239 contains a single edge from @xmath111 to @xmath218 which contradicts the claim .    to complete this stage",
    "observe that corollary  [ c : sea ] holds as before .",
    "_ stage 4 : dealing with the difficult subcubes , and stage 5 : using the subcubes in the sea to join everything together .",
    "_    these two stages go through exactly as before ( with one trivial change : replace @xmath187 by @xmath240 ) .",
    "this completes the proof of theorem  [ t : multi - dim - gilbert ] .",
    "in this section we prove theorem  [ t : knear ] . once again , the proof is very similar to that in section  [ s : gilbert-2d ] .",
    "we shall outline the key differences , and emphasise why we are only able to prove the weaker version of the result .",
    "_ stage 1 : tessellation .",
    "_    the tessellation is similar to before , but this time some edges may be much longer than some non - edges .",
    "let @xmath241  is @xmath1-connected ) be the smallest @xmath0 that @xmath242 is @xmath1-connected .",
    "since @xmath8 is connected we may assume that @xmath243 ( see @xcite ) .",
    "let @xmath244 be such that any two points at distance @xmath244 are joined whp : e.g. , lemma  8 of  @xcite implies that this is true provided @xmath245 , so we can take @xmath246 .",
    "let @xmath247 be such that no edge in the graph has length more than @xmath247 .",
    "then , again by @xcite , we have @xmath248 whp , so we can take @xmath249 .    from here on , we ignore all point sets with an edge longer than @xmath247 or a non - edge shorter than @xmath244 .",
    "let @xmath250 .",
    "we tessellate the box @xmath2 with small squares of side length @xmath51 .",
    "( since we are proving only this weaker result our tesselation does not need to be very fine . ) by the choice of @xmath51 and the bound on @xmath244 any two points in neighbouring or diagonally neighbouring squares are joined in @xmath8 .",
    "also , by the bound on @xmath247 no two points in squares with centres at distance more than @xmath251 are joined .",
    "let @xmath252 ; we have that no two points in squares with centres distance @xmath253 apart are joined .    _ stage 2 : the `` difficult '' subsquares .",
    "_    we call a square _ full _ if it contains at least @xmath254 points and _ non - full _ otherwise .",
    "we say two non - full squares are joined if they are at @xmath24 distance at most @xmath255 .",
    "first we bound the size of the largest component of non - full squares .",
    "[ l : non - full - knear ] the largest component of non - full squares has size less than 7000 whp .",
    "the number of components of size @xmath256 containing a particular square is at most @xmath257 so , since there are less than @xmath6 squares , the total number of such components is at most @xmath258 .",
    "the probability that a square is non - full is at most @xmath77 .",
    "hence , the expected number of components of size at least 7000 is at most @xmath259 which tends to zero as @xmath6 tends to infinity ( since @xmath260 ) : i.e. , whp , no such component exists .    in the rest of the argument we shall assume that there is no non - full component of size greater than 7000 .",
    "_ stage 3 : the structure of the difficult subsquares . _    as usual we fix one component @xmath90 of the non - full squares , and suppose that it has size @xmath86 ( so we know @xmath261 ) .",
    "this time we define @xmath106 to be the graph on the small squares where each square is joined to its eight nearest neighbours ( i.e. , adjacent and diagonal ) .",
    "let @xmath31 be the giant component of @xmath262 , and again split the cutoff squares into close and far depending whether they have a neighbour ( in @xmath81 ) in @xmath31 .    by the vertex isoperimetric inequality in the square",
    "there are at most @xmath263 squares in @xmath264 so @xmath265 .",
    "next we prove a result similar to corollary  [ c : cutoff ] .",
    "the set of cutoff squares @xmath93 is in @xmath266 ( where @xmath252 as above ) .",
    "suppose not , and that @xmath179 is a square in @xmath93 not in @xmath266 .",
    "then all squares within @xmath24 distance of @xmath179 at most @xmath267 are not in @xmath90",
    ". hence they must be in @xmath93 ( since otherwise there would be a path from @xmath179 to a square in @xmath31 not going through any square in @xmath90 ) .",
    "hence @xmath268 which contradicts lemma  [ l : non - full - knear ] .    finally , we need the analogue of lemma  [ l : connected - boundary ] whose proof is exactly the same .",
    "[ l : connected - boundary - knear ] the set @xmath269 is connected in @xmath81 .    _ stage 4 : dealing with the difficult subsquares .",
    "_    let us deal with these cutoff squares now",
    ". from each cutoff square that contains at least two vertices pick any @xmath270 vertices and from each cutoff square that contains a single vertex pick that vertex with multiplicity two .",
    "we have picked at most @xmath271 vertices , so since @xmath8 is @xmath54 connected we can simultaneously find vertex disjoint paths from each of our picked vertices to vertices in squares in @xmath31 ( two paths from those vertices that are repeated ) .",
    "we remark that these are not just single edges : these paths may go through other cutoff squares .",
    "call the first point of such a path which is in the sea a _ meeting point _ , and",
    "the square containing it a _ meeting _ or _ terminating _ square .    each cutoff square has two meeting points say in subsquares @xmath272 .",
    "since the longest edge is at most @xmath247 both @xmath166 and @xmath167 are in @xmath273 .",
    "since @xmath274 is connected in @xmath81 we construct a path in the squares in @xmath274 from the meeting point in @xmath167 to a vertex in @xmath166 using at most one vertex in each subsquare on the way , and missing all the other meeting points .",
    "this is possible since each full square contains at least @xmath254 vertices .",
    "place the path from the terminating point in @xmath166 to the cutoff square , round all the vertices in the cutoff square not used in the rest of the construction , followed by the path back to the meeting point in @xmath167 and then through the sea as above back to @xmath166 .",
    "we have a path starting and finishing in the same subsquare ( @xmath166 ) containing all the ( unused ) vertices in the cutoff square .",
    "do this for every cutoff square . when doing this , in each square in the sea we use at most two vertices for each cutoff square .",
    "moreover , obviously only squares in @xmath273 are touched by this construction .",
    "since non - full squares in distinct components are at distance at least @xmath275 the squares touched by different non - full components are distinct . thus in total we have used at most @xmath276 vertices in any square in the sea , and since @xmath254 there are many ( we shall only need 8) unused vertices left in each full square in the sea .    _",
    "stage 5 : using the subsquares in the sea to join everything together . _",
    "this is exactly the same as before .",
    "we start by giving some reasons why the proof in the @xmath0-nearest neighbour model only yields the weaker theorem  [ t : knear ] .",
    "the first superficial problem is that we use squares in the tesselation which are of `` large '' size rather than relatively small as in the proof of theorem  [ t:2d - gilbert ] , ( in other words we did not introduce the constant @xmath47 when setting @xmath51 depending on @xmath5 ) .",
    "obviously we could have introduced this constant .",
    "the difficulty when trying to mimic the proof of theorem  [ t:2d - gilbert ] is the large difference between @xmath244 and @xmath247 , which corresponds to having a very large number of squares ( many times @xmath277 ) in our non - full component @xmath90 .",
    "this means that we can not easily prove anything similar to lemma  [ l : far ] .",
    "indeed , a priori , we could have two far squares with @xmath277 non - full squares around each of them .",
    "a different way of viewing this difficulty is that , in the @xmath0-nearest neighbour model , the graph @xmath81 on the small squares does not approximate the real graph @xmath8 very well , whereas in the gilbert model it is a good approximation .",
    "thus , it is not surprising that we only prove a weaker result .",
    "this is typical of results about the @xmath0-nearest neighbour model : the results tend to be weaker than for the gilbert model .",
    "this is primarily because the obstructions tend to be more complex : for example , the obstruction for connectivity in the gilbert model is the existence of an isolated vertex .",
    "obviously in the @xmath0-nearest neighbour model we never have an isolated vertex ; the obstruction must have at least @xmath278 vertices .",
    "when proving theorem  [ t : knear ] we only used two facts about the random geometric graph .",
    "first , that any two points at distance @xmath279 are joined whp . secondly , that the ratio of @xmath247 ( the longest edge ) to @xmath244 ( the shortest non - edge ) was at most 60 whp .",
    "obviously , we could prove the theorem ( with different constants ) in any graph with @xmath280 and @xmath281 bounded .",
    "this includes higher dimensions and different norms and to different shaped regions instead of @xmath2 ( e.g.  to disks or toruses ) .",
    "indeed , the only place we used the norm was in obtaining the bounds on @xmath247 and @xmath244 in stage 1 of the proof .",
    "indeed , it also generalises to irregular distributions of vertices provided that the above bounds on @xmath244 and @xmath247 hold .",
    "for example , it holds in the square @xmath2 where the density of points in the poisson process decrease linearly from 10 to 1 across the square .",
    "a related model where the result does not seem to follow easily from our methods is the directed version of the @xmath0-nearest neighbour graph .",
    "as mentioned above , the @xmath0-nearest neighbour model naturally gives rise to a directed graph and we can ask whether this has a directed hamilton cycle . note that this directed model is significantly different from the undirected : for example it is likely ( see @xcite ) that the obstruction to directed connectivity ( i.e. , the existence of a directed path between any two vertices ) is a single vertex with in - degree zero ; obviously this can not occur in the undirected case where every vertex has degree at least @xmath0 . in some other random graph models",
    "a sufficient condition for the existence of a hamilton cycle ( whp ) is that there are no vertices of in - degree or out - degree zero . of course , in the directed @xmath0-nearest neighbour model every vertex has out - degree @xmath0 so we ask the following question .",
    "let @xmath282 be the directed @xmath0-nearest neighbour model .",
    "is @xmath283whp ?",
    "it is obvious that the bound on connectivity in the @xmath0-nearest neighbour model can be improved , but the key question is `` should it be two ? ''",
    "we make the following natural conjecture :    suppose that @xmath53 such that the @xmath0-nearest neighbour graph @xmath284 is a @xmath270-connected whp .",
    "then , whp , @xmath8 has a hamilton cycle .",
    "some of the results published in this paper were obtained in june 2006 at the institute of mathematics of the national university of singapore during the program ` random graphs and real - world networks ' .",
    "we are grateful to the institute for its hospitality .",
    "a.  d.  korshunov , _ a solution of a problem of p.  erds and a.  rnyi about hamilton cycles in non - oriented graphs .",
    "_ metody diskr .",
    "teoriy upr .",
    "syst . , sb . trudov novosibirsk * 31 * ( 1977 ) 1756 ( in russian )"
  ],
  "abstract_text": [
    "<S> we prove that , in the gilbert model for a random geometric graph , almost every graph becomes hamiltonian exactly when it first becomes 2-connected . </S>",
    "<S> this proves a conjecture of penrose .    </S>",
    "<S> we also show that in the @xmath0-nearest neighbour model , there is a constant @xmath1 such that almost every @xmath1-connected graph has a hamilton cycle . </S>"
  ]
}