{
  "article_text": [
    "our magnetic resonance force microscope operated at a pressure of @xmath123 mbar and at a temperature of @xmath124k in a liquid helium cryostat .",
    "all components shown in fig . 1 were mounted on a spring - suspended sample plate to attenuate mechanical vibrations .",
    "the cantilever and laser interferometer were mechanically fixed , while the chip carrying the feco nanomagnet and the radio - frequency ( rf ) stripline could be mechanically scanned in three dimensions using remote controlled nanopositioners .",
    "the laser for cantilever position readout had a wavelength of @xmath125 nm and an intensity of @xmath126nw , and was operated in a fiber - optic interferometer configuration formed between the end of a coated optical fiber and the cantilever .",
    "the cantilever had a spring constant of @xmath58n / m and a resonance frequency around @xmath0khz .",
    "the mechanical quality was around @xmath127 at @xmath55 , and dropped to about @xmath128 when brought close to the nanomagnet due to non - contact friction .",
    "the cantilever was actively damped in a negative feedback loop using an fpga controller in order to increase the measurement bandwidth .",
    "the damped quality factor was on the order of @xmath129 , but would vary from @xmath130 depending on position as the magnetic tip was scanned over the cantilever .",
    "nuclear spins were inverted using adiabatic rapid passages based on frequency - modulated rf pulses .",
    "two inversions were carried out within a cantilever period ( @xmath131ms ) so that the nuclear magnetization became modulated at the resonance frequency @xmath132 of the cantilever .",
    "two different frequency modulation schemes were used , including linear sweeps and sech / tanh - type sweeps .    for linear sweeps ,",
    "the rf frequency was linearly increased from @xmath133 to @xmath134 over the duration of the pulse @xmath135 , which was equal to @xmath136 , where @xmath137 was the number of phase slots ( see [ sec : transfermatrix ] ) .",
    "the amplitude was modulated with a trapezoidal shape to ensure phase continuity at the beginning and end of each pulse .",
    "linear sweeps were used for the measurements shown in fig .",
    "2 .    for sech",
    "/ tanh - type sweeps , the frequency modulation followed a hyperbolic secant ( _ sech _ ) and amplitude modulation used a hyperbolic tangent ( _ tanh _ ) profile , which can improve adiabaticity  @xcite .",
    "in addition , consecutive pulses were allowed to have overlapping tails such that the pulse was effectively longer than @xmath135 , further aiding adiabaticity .",
    "sech / tanh sweeps ( with @xmath138 ) were used for the measurements shown in fig 3 .",
    "the maximum rf amplitude that could be employed in our apparatus was limited by undesired electrostatic driving ( of the cantilever ) that set in above @xmath139 , corresponding to a @xmath140 rabi frequency for nuclei .",
    "this allowed for about @xmath141 phase slots before the adiabatic condition became violated .",
    "schematic of signal acquisition protocol .",
    "@xmath142 denotes the position of the cantilever as a function of time .",
    "@xmath143 , @xmath144 , @xmath145 , and @xmath146 denote the cantilever motion amplitudes with different phases , which are then filtered with @xmath147 different time constants between @xmath148ms and @xmath149s .",
    "@xmath150 , @xmath151 , @xmath152 , and @xmath153 are amplitudes filtered by the @xmath154 filter .",
    "finally , @xmath155 , @xmath156 , @xmath157 , and @xmath158 stand for the variance of those amplitudes over the averaging time of the experiment ( converted into units of squared force).,width=472 ]",
    "nuclear spin noise is characterized by slow fluctuations of net magnetization , with time constants ranging between @xmath159 .",
    "however , the cantilever motion is influenced by both undesired thermal noise ( @xmath160 ) , and a much smaller force generated by the desired nuclear spin noise ( @xmath161 ) .",
    "these forces collectively influence the cantilever motion , which is then measured by the laser interferometer .    in order to detect the weak spin noise over the large thermal noise background , the cantilever motion can be measured using lock - in amplification and directing the spin signal into the in - phase channel .",
    "the in - phase channel then receives both spin signal and thermal noise , while the quadrature channel only receives thermal noise .",
    "if the variances of both channels are calculated and subtracted , one obtains a differential variance that now only contains the spin signal .",
    "the signal - to - noise ratio can be optimized by choosing a lock - in filter time constant that is close to the intrinsic correlation time @xmath162 .",
    "we achieved this by calculating variances for a bank of filters and post - picking of the desired filter .",
    "since calculating the variance requires squaring the input signals , information concerning the sign ( and hence the phase ) of the signal is lost . however , we note that the full phase of the spin signal can be retrieved by using a four - channel lock - in detection , where the interferometer signal is demodulated at the phases @xmath9 , @xmath11 , @xmath10 and @xmath12 .",
    "( a conventional lock - in amplifier would only demodulate at @xmath9 and @xmath10 ) . to understand this ,",
    "consider measuring a spin signal with variance @xmath163 and phase @xmath164 in the presence of thermal noise with variance @xmath165 .",
    "if we denote the four demodulated signals by @xmath155 , @xmath156 , @xmath157 , and @xmath158 , @xmath166 note that the thermal noise , being incoherent , is equally distributed over the phase space .",
    "we can subtract the thermal noise signal contributions by forming the differences @xmath167 these two terms correspond to the real and imaginary parts of a signal @xmath20 , @xmath168 we implemented the four - channel lock - in detection technique by first demodulating by a conventional two - channel lock - in amplifier ( sr830 , stanford research ) , and then rotating lock - in outputs by @xmath169 on an fpga controller .",
    "the same fpga then also performed the filtering and variance estimation to produce @xmath155 , @xmath156 , @xmath157 , and @xmath158 .",
    "for all imaging scans , two additional corrections were applied in order to account for position - dependent changes in cantilever gain ( represented by the damped quality factor ) and phase .",
    "both parameters were measured at each location prior to data collection . for",
    "typical one dimensional scans , we found @xmath170 to vary between @xmath130 while changes in phase were only within a few percent .",
    "since these changes vary slowly with position , roughly with a length scale similar to the tip - sample spacing , they can be easily corrected for by low - order polynomial fit or heavy low - pass filtering .",
    "note that these corrections apply to all imaging scans , including both single signal measurements and multiplexed measurements .",
    "transfer matrices @xmath171 were chosen such that the element - wise 2-norm of the inverse matrix was @xmath172 .",
    "these matrices minimize the propagation of thermal noise , which is the dominant noise in our measurements ( see [ sec : errorprop ] ) . to form the matrix , we first divided the cantilever half - period into @xmath137 equally spaced phase slots ( , @xmath173 for @xmath174 ) .",
    "we additionally required all phases within an experiment @xmath20 to be different in order to evenly distribute rf power over the cantilever period , thus minimizing peak power and spurious mechanical excitation .",
    "this constraint precludes the use of digital fourier transform matrices , which would otherwise be the obvious choice .    in the case of multiplexing @xmath70 signals ( fig .",
    "2 ) , we used @xmath175 phase slots with matrix @xmath176 this matrix has @xmath177 .    in the case of multiplexing @xmath82 signals , we performed a heuristic search to find an optimal matrix . the matrix used for fig . 3 had @xmath178 with phases @xmath179 this matrix has @xmath180 .",
    "this means that the snr improvement is reduced from @xmath82 to @xmath181 .",
    "the reconstruction of phase multiplexed signals can sometimes lead to enhanced noise compared to single sweeps , which in turn deteriorates multiplexing performance .",
    "we have analyzed the effect of detector noise , spin noise , detector gain , and phase fluctuations on the reconstructed signal . in our experiments ,",
    "detector noise was typically the dominating noise .      in mrfm ,",
    "detector noise arises from thermal force noise acting on the micromechanical cantilever .",
    "it leads to thermomechanical noise with a lorentzian distribution as shown in fig .",
    "[ figure s2 ] ( b ) , and is added equally to all measurements .",
    "if the thermal noise leads to a standard error @xmath182 in each experiment @xmath41 ( on both the real and imaginary channel ) , error propagation predicts a standard error on reconstructed signals @xmath183 as @xmath184 where @xmath46 are the matrix elements of the inverse transfer matrix @xmath185 .",
    "a `` good '' transfer matrix will have little amplification of @xmath186 . as a measure for the total propagated error we use the sum of all individual errors @xmath187 @xmath188 here",
    "@xmath189 denotes the element - wise 2-norm of the matrix .",
    "as shown above , one can often find transfer matrix phases such that @xmath190 or @xmath191 .",
    "thus , amplification of thermal noise can be avoided by a suitable choice of @xmath192 .",
    "spin noise reflects the uncertainty in the variance measurement of spin fluctuations .",
    "if the spin signal has variance @xmath163 , the standard error of this variance estimate is @xmath193 , where @xmath194 is the number of independent samples that can be performed during measurement time @xmath195 and @xmath196 is the correlation time of nuclear spin fluctuations  @xcite .    in a multiplexed experiment , each spin signal @xmath197 carries a spin noise error @xmath198 .",
    "this error is propagated to the measurements @xmath41 as @xmath199 ^ 2 \\epsilon_{{\\mathrm{spin}},j}^2 + i \\im[a_{jk}]^2 \\epsilon_{{\\mathrm{spin}},j}^2 \\right\\}\\ ] ] and to the reconstructed signals @xmath200 as @xmath201 ^ 2 \\re[a_{jk}]^2 \\epsilon_{{\\mathrm{spin}},j}^2 + \\im[\\tilde{a}_{jk}]^2 \\im[a_{jk}]^2 \\epsilon_{{\\mathrm{spin}},j}^2 \\right\\ } \\\\                   & = & \\sum_{j=1}^{n } \\epsilon_{{\\mathrm{spin}},j}^2 \\sum_{k=1}^{n } \\left\\ { \\re[\\tilde{a}_{jk}]^2 \\re[a_{jk}]^2 + \\im[\\tilde{a}_{jk}]^2 \\im[a_{jk}]^2 \\right\\}\\end{aligned}\\ ] ] @xmath202 $ ] and @xmath203 $ ] denote real and imaginary parts .",
    "the expression above allows one to compute explicitly the error introduced by spin noise for a specific choice of transfer matrix * a*.    if one does not want to calculate errors explicitly , as an approximation , one finds that @xmath204 ^ 2 \\re[a_{jk}]^2 + \\im[\\tilde{a}_{jk}]^2 \\im[a_{jk}]^2 \\right\\ } \\approx \\frac{1}{2n}\\ ] ] this follows from @xmath205 and @xmath206 and assuming that , approximately , all entries have real and imaginary parts of similar magnitudes .",
    "the error added to each reconstructed signal is therefore approximately @xmath207 that is , the strongest spin noise will transmit to all reconstructed signals @xmath200 , and all reconstructed signals will now carry a similar error . this may be an issue if one tries to detect a weak signal in the presence of a strong signal .",
    "if there are variations in the detector reference phase between experiments @xmath41 , reconstruction will lead to cross - talk between the @xmath200 that appears as additional noise . in mrfm ,",
    "detector phase fluctuations are due to changes in the cantilever resonance frequency that alter the phase response .",
    "since phase fluctuations affect all signals equally , no relative phase errors are expected between different signals within an experiment @xmath41 .    in a multiplexed experiment",
    ", phase variations will mainly occur between different experiments @xmath41 .",
    "if we assume that there is a small phase uncertainty @xmath208 between different experiments @xmath30 , the matrix elements @xmath209 become @xmath210 if @xmath211 denotes the standard deviation of @xmath212 , then the error propagates to the measurements @xmath41 as @xmath213 ^ 2   + i \\re[a_{jk}]^2 \\right\\ }   \\label{eq : phase_noise1}\\ ] ] and to the reconstructed signals @xmath200 as @xmath214 ^ 2 \\im[a_{jk}]^2 + \\im[\\tilde{a}_{jk}]^2 \\re[a_{jk}]^2 \\right\\ } \\\\                   & = & \\sum_{j=1}^{n } ( \\sigma^2_{\\mathrm{f , j}})^2 \\epsilon_{\\phi}^2 \\sum_{k=1}^{n } \\left\\ { \\re[\\tilde{a}_{jk}]^2 \\im[a_{jk}]^2 + \\im[\\tilde{a}_{jk}]^2 \\re[a_{jk}]^2 \\right\\}\\end{aligned}\\ ] ] from the above expression one finds again that , approximately , the error added to each reconstructed signal is @xmath215 that is , phase noise again transmits to all reconstructed signals and the dominating effect will come from the strongest signal . as with spin noise , this may be an issue if one tries to detect a weak signal in the presence of a strong signal .",
    "fast fluctuations in the cantilever resonance frequency ( jitter ) will change both the phase and amplitude response of the detector .",
    "since the amplitude is only affected to second order in frequency , the dominant influence is through the phase response .",
    "if we consider a small frequency jump @xmath216 during an experiment , with @xmath217 the cantilever resonance frequency and @xmath170 the feedback - damped quality factor , the corresponding phase jump will be @xmath218 .",
    "if @xmath219 is the standard deviation of frequency jumps during an experiment , then the associated standard deviation of phase is @xmath220 and it will affect the reconstructed signal @xmath200 in the same way as given in equations [ eq : phase_noise1 ] through [ eq : phase_noise4 ] .      if there are variations in the detector gain between experiments @xmath41 , reconstruction will likewise lead to cross - talk between the @xmath200 . in mrfm ,",
    "detector gain fluctuations are due to changes in the cantilever resonance frequency that alter the amplitude response , or due to variations in the damped quality factor @xmath221 .",
    "as with phase variations , gain variations will occur between different experiments @xmath41 , but no relative gain errors are expected between different signals within an experiment @xmath41 . if we assume that there is relative gain uncertainty @xmath222 between different experiments @xmath30 , the matrix elements @xmath209 become @xmath223 if @xmath224 denotes the standard deviation of @xmath225 , then the error propagates to the measurements @xmath41 as @xmath226 ^ 2   + i \\im[a_{jk}]^2 \\right\\}\\ ] ] and to the reconstructed signals @xmath200 as @xmath227 ^ 2 \\re[a_{jk}]^2 + \\im[\\tilde{a}_{jk}]^2 \\im[a_{jk}]^2 \\right\\ } \\\\                   & = & \\sum_{j=1}^{n } ( \\sigma^2_{\\mathrm{f , j}})^2 \\epsilon_{g}^2 \\sum_{k=1}^{n } \\left\\ { \\re[\\tilde{a}_{jk}]^2 \\re[a_{jk}]^2 + \\im[\\tilde{a}_{jk}]^2 \\im[a_{jk}]^2 \\right\\}\\end{aligned}\\ ] ] from the above expression one finds again that , approximately , the error added to each reconstructed signal is @xmath228",
    "we used three methods to analyze the noise affecting our signal .",
    "first , the * point - to - point fluctuations * of a data set can be quantified by the standard deviation @xmath229 of the data points , or , equivalently , by the standard deviation of the _ differences _ of consecutive points @xmath230 . according to error propagation , @xmath231 . in practice",
    ", we found that @xmath230 is a more reliable measure of the noise than @xmath229 because it is less susceptible to a signal bias that will artificially increase @xmath229 .",
    "we therefore calculated @xmath232 for all sweeps and used it as an upper bound for the real signal fluctuations @xmath233 or @xmath234 .",
    "second , for each data point , we calculated the * statistical uncertainty * @xmath235 of the signal ( which should be equal to @xmath229 ) . for a statistical quantity with mean @xmath236 that is sampled @xmath237 times ,",
    "this amounts to @xmath238  @xcite . in our case",
    ", @xmath236 corresponds to the signal @xmath183 while @xmath237 is the number of statistically independent samples during an averaging period .",
    "third , we use a * noise model * to compute the signal fluctuations as @xmath239 .",
    "the model includes thermal vibrations of the cantilever , amplifier noise , and laser shot noise . from this model",
    ", we can estimate the contributions of the different noise sources .",
    "we take into account the effective temperature of the mechanical mode , which is lower than the cryostat temperature since the cantilever is actively cooled by a feedback loop .",
    "however , @xmath239 will slightly underestimate the total signal fluctuations because it does not include the spin noise , i.e. it neglects the fact that our signal is itself the variance of a fluctuating quantity .",
    "we compared the values obtained with all three methods .",
    "for this comparison , we measured a signal @xmath104 times at the same location to avoid calibration uncertainties arising from varying surface interaction as a function of @xmath75",
    ". figure  [ figure s2 ] ( a ) shows the absolute value of the measured signal .",
    "we obtained @xmath240an@xmath110 , @xmath241an@xmath110 , @xmath242an@xmath110 , and @xmath243an@xmath110 .",
    "the modeled noise spectral density @xmath244 is shown in fig .",
    "[ figure s2 ] ( b ) . as mentioned above , @xmath239 is slightly smaller than the other two values because it neglects the influence of spin noise .",
    "the contribution of the thermomechanical noise amounted to @xmath245an@xmath110 and that of the electrical amplifier noise to @xmath246an@xmath110 .",
    "the laser shot noise was negligible with a contribution of @xmath247an@xmath110 .",
    "based on the good agreement between different noise calculations , we relied on @xmath248 to quantify the noise because it allowed a direct measure of signal fluctuations .",
    "as a measure for the overall fidelity of multiplexed signals relative to separately measured signals , we subtracted the two data curves for in fig .",
    "2e from each other and evaluated the standard deviation of the point - to - point fluctuations @xmath249 of the result ( and likewise for the two data curves for in fig .",
    "2f ) . from error propagation",
    ", the difference of two data sets is expected to have larger noise than an individual data set by @xmath250 .",
    "we found @xmath251an@xmath110 for and @xmath111an@xmath110 for , which is close to the values we obtained for all four individual curves ( see main text ) .     * ( a ) * data points measured as a function of time at a fixed position .",
    "averaging was performed over @xmath252s with a slice center frequency of @xmath100mhz and @xmath253khz . *",
    "( b ) * power spectral density of the apparent cantilever displacement noise calculated with a model that simulates the parameters used in * ( a)*. the noise stems from thermal vibrations , amplifier noise , and laser shot noise .",
    "the number of statistically independent samples at each point is @xmath254 , and the effective filter width of our @xmath255 order butterworth filter is @xmath256hz ( marked by a shaded region ) .",
    "the damped mode temperature is estimated to be @xmath257mk.,width=472 ]",
    "the point - to - point fluctuations that arise mainly from thermomechanical noise and amplifier noise ( see previous section ) are not only a measure of the signal quality , but also set the resolvable scanning step size . a step in @xmath75 with magnitude",
    "@xmath258 is resolvable when the signal change exceeds the signal noise , i.e. when @xmath259 is at least as large as the standard deviation of the point - to - point fluctuations . the filtered data in fig .",
    "2b of the main text have fluctuations with standard deviations of @xmath260an@xmath110 and @xmath261an@xmath110 for multiplexed and single sweep data , respectively . compared with the maximum signal slope of @xmath262an@xmath263 nm around @xmath252 nm , this gives a best positional accuracy of close to @xmath264 nm . the data in fig .",
    "3a with center frequencies @xmath265mhz and @xmath266mhz have fluctuations with standard deviations equal to @xmath267an@xmath110 and @xmath268an@xmath110 , maximum signal slopes of @xmath269an@xmath263 nm and @xmath270an@xmath263 nm around @xmath271 and @xmath272 nm , and thus best positional accuracies corresponding to @xmath116 nm and @xmath273 nm , respectively . the data in fig .",
    "3d with center frequency @xmath100mhz have fluctuations with a standard deviation of @xmath274an@xmath110 , a maximum signal slope of @xmath275an@xmath263 nm around @xmath271 nm , and thus a best positional accuracy of @xmath276 nm . the fluctuation standard deviations vary between different data sets because of different averaging times , different low - pass filtering , and because the effective temperature of the cantilever mechanical mode depends on the undamped and damped mechanical quality factors .",
    "linear fits to multiplexed and separately measured data for .",
    "the plot is a zoom of fig .",
    "2e of the main text .",
    "the two linear fits were performed using a common slope .",
    "the resulting x - offset is @xmath277nm.,width=302 ]    an alternative estimation of the positional accuracy can be obtained by comparing the signal onset for the multiplexed and separately measured signals in fig .",
    "2e of the main text .",
    "figure  [ figure s3 ] shows a zoom of the two data sets .",
    "we first performed a linear fit to both data sets to determine a common slope ( @xmath278an@xmath263 nm ) .",
    "we then performed linear fits to the two sets individually where we kept the slope fixed .",
    "the resulting offset in @xmath75 between the fitted lines is @xmath277 nm .",
    "x - position scans presented in this work contain data points with hollow squares that correspond to spin signals with higher uncertainty . at these positions",
    ", we observed that the cantilever was driven to a large amplitude in spite of the damping feedback .",
    "this made a ringdown measurement , and therefore a precise determination of the quality factor , impossible .",
    "this problem arose whenever the resonance frequency of the measured cantilever matched that of a second cantilever mounted on the same chip ( @xmath279hz ) .",
    "we believe that the feedback loop is then responsible for a coupling that drove the measured cantilever .",
    "interpolated values were used to approximate the spin signals at these locations ."
  ],
  "abstract_text": [
    "<S> we report a method for accelerated nanoscale nuclear magnetic resonance imaging by detecting several signals in parallel . </S>",
    "<S> our technique relies on phase multiplexing , where the signals from different nuclear spin ensembles are encoded in the phase of an ultrasensitive magnetic detector . </S>",
    "<S> we demonstrate this technique by simultaneously acquiring statistically polarized spin signals from two different nuclear species ( , ) and from up to six spatial locations in a nanowire test sample using a magnetic resonance force microscope . </S>",
    "<S> we obtain one - dimensional imaging resolution better than @xmath0 nm , and subnanometer positional accuracy .    </S>",
    "<S> h @xmath1h @xmath1h    nanoscale magnetic resonance imaging ( nanomri ) is a promising , yet challenging microscopy technique for three - dimensional imaging of single objects with nanometer spatial resolution @xcite . among the advantages of nanomri </S>",
    "<S> are the possibility of site - specific image contrast , the absence of radiation damage , and the fact that only a single copy of an object is required . </S>",
    "<S> these qualities are particularly well - suited to provide structural information of large biomolecular complexes that are known to overwhelm nuclear magnetic resonance ( nmr ) spectroscopy and that evade crystallization for x - ray analysis . </S>",
    "<S> recent proof - of - concept experiments showed that nanomri is capable of imaging individual virus particles in three dimensions with @xmath2 spatial resolution @xcite , as well as isotope - specific image contrast  @xcite . </S>",
    "<S> the best detection sensitivities achieved to date are in the range of @xmath3 statistically polarized nuclear spins @xcite . </S>",
    "<S> nanomri has been demonstrated using several ultrasensitive signal detection techniques , especially magnetic resonance force microscopy ( mrfm ) @xcite and diamond - based magnetometry @xcite .    </S>",
    "<S> although @xmath4 nm spatial resolution has been reached in several experiments @xcite , realizing this resolution in three - dimensional images required long averaging times . </S>",
    "<S> for instance , imaging the proton density ( ) in a single tobacco mosaic virus required two weeks of data acquisition  @xcite , even for coarsely sampled data . </S>",
    "<S> the long averaging times are prohibitive if one intends to refine voxel sizes or to image multiple nuclear spin species ( e.g. h and @xmath5c ) . </S>",
    "<S> the slow data acquisition is in part due to the point - by - point measurement procedure where only a small subset of nuclei in a sample is detected at a given time .    </S>",
    "<S> an interesting avenue for speeding up the image acquisition process is to measure multiple signals in parallel and to use post processing to calculate the contributions from each individual signal . </S>",
    "<S> signal encoding is especially well - suited for mri since nuclear spins can be separately addressed by radio - frequency ( rf ) pulses based on their differing larmor frequencies . in micron - to - millimeter scale mri , </S>",
    "<S> fourier - transform @xcite and hadamard @xcite encoding provide efficient means for detecting the thermal ( boltzmann ) polarization of nuclear spins .    </S>",
    "<S> when imaging voxels are less than @xmath6 the thermal polarization becomes exceedingly small and is dominated by statistical polarization fluctuations @xcite . </S>",
    "<S> it is the variance of these statistical fluctuations that then serves as the imaging signal @xcite . </S>",
    "<S> since variance measurements can not be coherently averaged , traditional encoding techniques fail and parallel signal detection is considerably more challenging . </S>",
    "<S> one effort for parallel detection of statistical spin polarization included the use of multiple detector frequencies @xcite . </S>",
    "<S> unfortunately this approach is limited by detector bandwidth , and often only a single short - lived spin signal ( which is the case for most biological samples ) can be accommodated . </S>",
    "<S> an exciting prospect is to fourier encode statistically polarized nuclei by a correlation measurement @xcite , however these methods require pulsed gradients or mechanical shuttling and have yet to be applied to 3d imaging .    in this work </S>",
    "<S> we introduce a simple multiplexing technique capable of reducing data acquisition times for statistically polarized spins , irrespective of detector bandwidth or availability of pulsed gradients . </S>",
    "<S> our technique relies on phase multiplexing , whereby spin signals are encoded into the in - phase and quadrature channels of a phase - sensitive nuclear spin detector . </S>",
    "<S> we demonstrate the technique by simultaneously acquiring spin signals from different nuclear species , and from multiple spatial locations in a nanowire test sample using mrfm . </S>",
    "<S> additionally , we show that the imaging resolution can be improved by subdividing voxels at undiminished signal - to - noise ratio ( snr ) .    in nanoscale mri , the number of spins in an imaging voxel </S>",
    "<S> is measured as the variance @xmath7 of the fluctuating nuclear magnetization @xmath8 @xcite . </S>",
    "<S> phase - sensitive detection can be obtained by periodically reversing the sign of @xmath8 to create an oscillating magnetic signal , and by synchronizing this ac signal with the detector reference clock @xcite . </S>",
    "<S> the signal is usually evaluated at @xmath9 and @xmath10 with a lock - in amplifier . however , when squaring the signal to calculate its variance , the signs of the two lock - in quadratures are lost and the phase can not be evaluated . </S>",
    "<S> we overcome this problem by demodulating the signal at @xmath9 , @xmath11 , @xmath10 , and @xmath12 . </S>",
    "<S> this four - channel lock - in technique allows retrieving the signal phase from the variances of the four channels @xcite . </S>",
    "<S> it thus reconciles nanomri with phase - sensitive detection in the regime of small , statistically polarized spin ensembles .    in mrfm , </S>",
    "<S> the detector consists of a micromechanical cantilever that is coupled to the nuclear magnetization by the sharp magnetic gradient @xmath13 of a nanoscale ferromagnetic tip ( see fig . [ </S>",
    "<S> fig : model](a ) ) . </S>",
    "<S> the cantilever then converts the variance of the magnetic force @xmath14 into a measurable oscillating motion .    </S>",
    "<S> phase multiplexing is achieved by exciting several nuclear spin ensembles simultaneously , while introducing a time delay between magnetization reversals . since signal detection is phase - sensitive </S>",
    "<S> , a time delay @xmath15 corresponds to a phase shift @xmath16 , where @xmath17 is the duration of one clock cycle and @xmath18 is the detector frequency . </S>",
    "<S> when measuring @xmath19 statistically independent spin ensembles , the total ( complex ) signal @xmath20 is    @xmath21    where @xmath22 is the variance of the @xmath23th ensemble s magnetization @xmath24 and @xmath25 denotes the phase shift of the periodic reversal of @xmath24 relative to the detector clock @xcite . in order to separate the different signal components </S>",
    "<S> , one may carry out @xmath19 measurements , each with a different combination of phases , yielding @xmath26 . </S>",
    "<S> the reconstruction of the original spin signals @xmath27 then follows by linear recombination as @xmath28 where the transfer matrix @xmath29 contains the phase of each spin inversion during the cantilever period , as depicted in fig . </S>",
    "<S> [ fig : model](d ) . </S>",
    "<S> the phase at which the spin signal due to the @xmath23th ensemble appears changes between different experiments @xmath30 . although any linearly independent set of phases @xmath31 will allow for the reconstruction of @xmath32 , only a suitable choice of @xmath31 will evade amplification of detector noise @xcite .     nuclear spin ensembles . </S>",
    "<S> ( a ) schematic representation of the mrfm apparatus showing a micromechanical cantilever and ferromagnetic tip . </S>",
    "<S> inset : scanning electron micrograph of an inas nanowire test sample attached to the cantilever end . </S>",
    "<S> the nanowire is possibly terminated by a au catalyst particle . </S>",
    "<S> ( b ) cantilever detector clock . </S>",
    "<S> ( c ) for sequential measurements , only a single nuclear spin ensemble is flipped at a time . </S>",
    "<S> arrows depict the orientation of nuclear magnetization @xmath24 and trapezoids symbolize adiabatic rf pulses @xcite . </S>",
    "<S> ( d ) for phase multiplexed measurements , both nuclear spin ensembles are flipped , but the flipping is partially out of phase . </S>",
    "<S> two different flipping sequences are applied to generate two different measurements @xmath33 and @xmath34 , which are subsequently reconstructed to yield @xmath35 and @xmath36 . </S>",
    "<S> encoding phases in this example are @xmath37 , @xmath38 ( for @xmath33 ) and @xmath39 , @xmath40 ( for @xmath34 ) . ]    </S>",
    "<S> since each measurement @xmath41 simultaneously detects the magnetization of all nuclear ensembles , the signal collected after a complete sequence @xmath42 is @xmath19 times larger compared to a sequential collection of @xmath43 without multiplexing . by contrast , the same amount of detector noise is added to each measurement @xmath41 regardless of whether multiplexing is applied . </S>",
    "<S> phase multiplexing can therefore improve the snr by @xmath44 for a fixed acquisition time . </S>",
    "<S> alternatively , the acquisition time can be reduced by @xmath19 without any loss in snr .    </S>",
    "<S> whether the improvement by @xmath19 is realized depends on the choice of phases @xmath31 . </S>",
    "<S> poorly selected phases will amplify detector noise when reconstructing @xmath32 from @xmath42 . </S>",
    "<S> we find that for white detector noise ( such as thermal noise ) , the noise amplification factor is given by the matrix 2-norm : @xmath45 , where @xmath46 are the matrix elements of @xmath47 @xcite . </S>",
    "<S> for an optimum set of phases @xmath48 . </S>",
    "<S> although such an optimum set can be constructed ( e.g. , using the digital fourier transform matrix @xmath49 ) , we used a heuristic search in order to satisfy additional constraints , especially peak rf pulse power . </S>",
    "<S> other potential noise sources include spin noise @xcite , correlations between spin ensembles , and instabilities in detector phase , gain or frequency @xcite .    </S>",
    "<S> we demonstrated phase multiplexing by measuring the statistical polarization of @xmath50 h and spins on an inas nanowire test sample . </S>",
    "<S> the nanowire had a diameter of @xmath51 , and was coated with @xmath52 of caf@xmath53 by thermal evaporation ( see fig . </S>",
    "<S> [ fig : chemical](a ) ) . </S>",
    "<S> h spins were present in a @xmath54 layer of surface adsorbates that naturally formed in ambient air @xcite . for nanoscale mri measurements , </S>",
    "<S> the nanowire was attached to the end of an ultrasensitive silicon cantilever and mounted in an mrfm apparatus operating at @xmath55 temperature and @xmath56 magnetic bias field . under measurement conditions , </S>",
    "<S> the cantilever had a resonant frequency @xmath57 , a spring constant of @xmath58n / m , and a mechanical @xmath59 , equivalent to a thermal force noise of about @xmath60 . </S>",
    "<S> for the imaging , the nanowire was approached to within @xmath61 of a @xmath62-nm - diameter feco magnetic tip @xcite .    </S>",
    "<S> nuclear magnetization reversals were performed using periodic application of adiabatic rf pulses . </S>",
    "<S> these pulses had a center frequency @xmath63 and bandwidth of @xmath64 . </S>",
    "<S> they inverted nuclear spins only in a thin `` resonance slice '' ( rs ) in space whose larmor frequencies @xmath65 lay within @xmath66 , where @xmath67 is the magnetic field at a spin s location ( see fig . </S>",
    "<S> [ fig : chemical](a ) ) , and @xmath68 is the nuclear gyromagnetic ratio . for the multiplexing , several adiabatic pulses with different center frequencies </S>",
    "<S> @xmath63 were co - added @xcite . </S>",
    "<S> signal detection used a fiber - optic interferometer to read out the cantilever oscillation , and four - phase lock - in demodulation to extract the complex signal variance @xmath20 @xcite .    in a first experiment we performed multiplexing of two different nuclear isotopes ( h and ) . in order to identify the nuclear species </S>",
    "<S> , we parked the nanowire @xmath69 above the nanomagnetic tip and measured the nuclear magnetization as a function of rf center frequency ( fig . </S>",
    "<S> [ fig : chemical](b ) ) . two peaks at 111 mhz and </S>",
    "<S> 118 mhz confirmed the presence of both h and nuclear species . to demonstrate multiplexing </S>",
    "<S> , we performed a one - dimensional spatial scan over the magnetic tip while exciting both h and . at each location , </S>",
    "<S> @xmath70 signals were acquired with different phase sequences , resulting in the two scans @xmath33 and @xmath34 shown in fig . </S>",
    "<S> [ fig : chemical](c)-(d ) . application of eq . </S>",
    "<S> ( [ eq : reconstruction ] ) then directly reproduced the reconstructed signals ( fig . </S>",
    "<S> [ fig : chemical](e)-(f ) ) . </S>",
    "<S> we found excellent agreement between reconstructed signals and sequential control measurements of h and .     </S>",
    "<S> the volume in space where nuclear spins contribute to the signal . </S>",
    "<S> ( b ) nmr spectrum of the sample measured by incrementing the rf center frequency @xmath71 while the nanowire was at a fixed position . in a magnetic field of @xmath56 , </S>",
    "<S> the larmor frequency of h is @xmath72 and of is @xmath73 . </S>",
    "<S> each data point was averaged for @xmath74 . </S>",
    "<S> ( c , d ) one - dimensional @xmath75 scans ( @xmath76 steps ) at a fixed height using the multiplexing sequences of fig . </S>",
    "<S> [ fig : model](d ) . </S>",
    "<S> gray and black symbols represent the real and imaginary parts of @xmath33 and @xmath34 , respectively . </S>",
    "<S> rf center frequencies were @xmath72 and @xmath73 with @xmath77 . </S>",
    "<S> ( e , f ) reconstructed signal ( colored squares ) providing separate images for ( e ) h and ( f ) . </S>",
    "<S> a sequential single isotope scan is shown for comparison ( black squares ) . </S>",
    "<S> total averaging time per point was @xmath78 for multiplexed acquisition and @xmath79 for sequential acquisition . for reasons explained in @xcite , the mechanical detector was unstable between @xmath80 nm and @xmath81 nm . data in this range was replaced by interpolated data , represented by hollow symbols in ( c - f ) . </S>",
    "<S> data has been spatially low pass filtered by @xmath0 points . ]    </S>",
    "<S> in addition to chemical contrast imaging , multiplexing can also be applied to detect signals of the same isotope in different spatial regions of a sample . </S>",
    "<S> such multi - slice imaging provides depth information with a single lateral scan , and may be useful to improve the fidelity of 3d image reconstruction . </S>",
    "<S> fig . </S>",
    "<S> [ fig : space](a ) shows an example of spatial multiplexing by detecting @xmath82 resonant slices of @xmath1h . </S>",
    "<S> a shifting peak is seen as the nanowire moves across the different slices , and the six signal traces clearly reflect the geometry of imaging slice and nanowire .    </S>",
    "<S> we have tested multiplexing down to very low values of @xmath83 to estimate the limits towards high spatial resolution . </S>",
    "<S> figure [ fig : space](c ) shows such a high resolution scan acquired with frequency increments of @xmath84 . by comparing the signal onset as a function of @xmath75 position </S>",
    "<S> , we find that the lateral distance between slices @xmath85 is about @xmath86 . </S>",
    "<S> this corresponds to a lateral magnetic gradient of @xmath87 . a comparison with similar nanomagnetic tips , where @xmath88 @xcite , indicates that our tip had a lower - than - expected gradient , probably due to partial oxidation . </S>",
    "<S> note that the imaging resolution is not limited by the step size @xmath85 , but by the bandwidth of the frequency modulation @xmath89 . </S>",
    "<S> as the full width at half maximum of the resonant slice is approximately @xmath90 @xcite , the imaging resolution is about @xmath91 . with an improved nanomagnetic tip , an imaging resolution of @xmath54 </S>",
    "<S> can therefore be expected .     </S>",
    "<S> different @xmath1h ensembles measured during a single @xmath75 scan with phase multiplexing . </S>",
    "<S> @xmath75 increment was @xmath92 , @xmath93 , and center frequencies of resonant slices ranged from @xmath94 to @xmath95 as indicated . </S>",
    "<S> the averaging time was @xmath74 at each position for all @xmath96 measurements together . </S>",
    "<S> as in fig . </S>",
    "<S> [ fig : chemical ] , hollow points represent </S>",
    "<S> data that was interpolated due to instability of the mechanical oscillator @xcite . </S>",
    "<S> data was low pass filtered by @xmath0 points . </S>",
    "<S> ( b ) schematic of the spatial shape of resonant slices associated with larmor frequencies @xmath97 . as the nanowire </S>",
    "<S> is scanned from left to right , spins intersect slices with progressively higher larmor frequencies , reflected in a shifting peak in ( a ) . </S>",
    "<S> the schematic corresponds to the @xmath75 location of the vertical dotted line . </S>",
    "<S> ( c ) high resolution @xmath75 scan with increments of @xmath98 , @xmath99 , and slice center frequencies ranging from @xmath100 to @xmath101 in steps of @xmath102 ( from left to right ) . </S>",
    "<S> averaging time was @xmath103 at each position for all @xmath96 measurements together . </S>",
    "<S> data was low pass filtered by @xmath104 points . ]    to compare the quality of multiplexed data to that of sequential measurements , we have quantified the signal error by analyzing the standard deviation of point - to - point fluctuations in the data sets . for the multiplexed scans in fig . </S>",
    "<S> [ fig : chemical](e)-(f ) we find @xmath105 and @xmath106 , while the separate measurements have @xmath107 and @xmath108 . </S>",
    "<S> the differences in amplitude between multiplexed and separately measured signals have standard deviations of @xmath109an@xmath110 for h and @xmath111an@xmath110 for @xcite . </S>",
    "<S> these results confirm that phase multiplexing produces the same signal amplitude and snr as sequential acquisition within half the averaging time .    </S>",
    "<S> while imaging step sizes and resolution for our experiments were on the order of a few nanometers , we found that the imaging precision was below one nanometer . </S>",
    "<S> for example , in the leftmost trace of fig . </S>",
    "<S> [ fig : space](c ) ( @xmath100mhz center frequency ) , we observed that the signal rose with @xmath112 around @xmath113 . comparing this slope with the measurement error </S>",
    "<S> @xmath114 we derive a position uncertainty of @xmath115 . </S>",
    "<S> although this precision is probably overestimated , we note that the signal onsets of the two scans in fig . [ </S>",
    "<S> fig : chemical](e ) coincide within @xmath116 nm @xcite . </S>",
    "<S> such good positional accuracy is an important prerequisite for extending nanomri to subnanometer resolution .    finally , we briefly comment on the limits of phase - multiplexed detection . when applying @xmath19 rf frequencies simultaneously , both average and peak power increase by at least @xmath19 regardless of the finer details of rf pulses . </S>",
    "<S> phase multiplexing therefore puts progressive demands on rf excitation , which in our experiments limited @xmath117 . </S>",
    "<S> moreover , error analysis shows that strong signals tend to transmit noise to weak signals and eventually deteriorate the snr of the latter @xcite , which we found to become noticeable as @xmath118 .    in summary , </S>",
    "<S> we have introduced a simple phase multiplexing method for accelerated detection of nanoscale nmr signals . </S>",
    "<S> the method is applicable even if spin ensembles are randomly polarized . </S>",
    "<S> it can in principle be used with any phase - sensitive excitation / detection scheme , including those used in recent diamond - based magnetometry experiments @xcite . using an mrfm apparatus , we have demonstrated simultaneous acquisition of nuclear spin signals from two different nuclear species and from up to six different sections within a sample . </S>",
    "<S> one - dimensional imaging scans reached a nominal spatial resolution @xmath119 with subnanometer positional accuracy . </S>",
    "<S> the reduction in measurement time offered by our technique will be especially useful for 3d images of biomolecular complexes with isotope contrast .    </S>",
    "<S> we thank cecil barengo , urs grob , christoph keck , heike riel and the physics machine shop for providing samples and experimental assistance . </S>",
    "<S> we also appreciate the insightful discussions with martino poggio , fei xue , and benedikt herzog . </S>",
    "<S> this work has been supported by the erc through starting grant 309301 , and by the swiss nsf through the nccr qsit . b.a.m . </S>",
    "<S> acknowledges an nserc fellowship </S>",
    "<S> .    99    j. a. sidles , _ appl . </S>",
    "<S> phys . </S>",
    "<S> lett . _ * 58 * , 2854 ( 1991 ) .    c. l. degen , _ appl . </S>",
    "<S> phys . </S>",
    "<S> lett . </S>",
    "<S> _ * 92 * , 243111 ( 2008 ) .    c. l. degen , m. poggio , h. j. mamin , c. t. rettner , and d. rugar , _ pnas _ * 106 * , 1313 ( 2009 ) .    </S>",
    "<S> h. j. mamin , t. h. oosterkamp , m. poggio , c. l. degen , c. t. rettner , and d. rugar , _ nano lett . </S>",
    "<S> _ * 9 * , 3020 ( 2009 ) .    </S>",
    "<S> h. j. mamin , m. kim , m. h. sherwood , c. t. rettner , k. ohno , d. d. awschalom , and d. rugar , _ science _ * 339 * , 557 ( 2013 ) .    </S>",
    "<S> t. staudacher , f. shi , s. pezzagna , j. meijer , j. du , c. a. meriles , f. reinhard , and j. wrachtrup , _ science _ * 339 * , 561 ( 2013 ) .    </S>",
    "<S> m. loretz , s. pezzagna , j. meijer , and c. l. degen , _ appl . </S>",
    "<S> phys . </S>",
    "<S> lett . _ * 104 * , 033102 ( 2014 ) .    c. mller , x. kong , j. m. cai , k. melentijevi@xmath120 , a. stacey , m. markham , d. twitchen , j. isoya , s. pezzagna , j. meijer , et al . , _ nature comm . _ * 5 * , 4703 ( 2014 ) .    </S>",
    "<S> j. sidles , j. garbini , k. bruland , d. rugar , o. zger , s. hoen , and c. yannoni , _ rev . </S>",
    "<S> mod . </S>",
    "<S> phys . _ </S>",
    "<S> * 67 * , 249 ( 1995 ) .    </S>",
    "<S> m. poggio and c. l. degen , _ nanotechnology _ * 21 * , 342001 ( 2010 ) .    </S>",
    "<S> r. schirhagl , k. chang , m. loretz , and c. l. degen , _ ann . </S>",
    "<S> rev . </S>",
    "<S> phys . </S>",
    "<S> chem . _ * 65 * , 83 ( 2014 ) .    </S>",
    "<S> j. m. nichol , t. r. naibert , e. r. hemesath , l. j. lauhon , and r. budakian , _ phys . </S>",
    "<S> rev . </S>",
    "<S> x _ * 3 * , 049901 ( 2013 ) .    </S>",
    "<S> a. kumar , d. welti , and r. r. ernst , _ j. magn </S>",
    "<S> . reson . _ * 18 * , 69 ( 1975 ) .    </S>",
    "<S> l. bolinger and j. s. leigh , _ j. magn </S>",
    "<S> . reson . _ * 80 * , 162 ( 1988 ) .    </S>",
    "<S> k. eberhardt , c. degen , and b. meier , _ phys . </S>",
    "<S> rev . </S>",
    "<S> b _ * 76 * ( 2007 ) .    </S>",
    "<S> b. e. herzog , d. cadeddu , f. xue , p. peddibhotla , and m. poggio , _ appl . </S>",
    "<S> phys . </S>",
    "<S> lett . _ * 105 * , 043112 ( 2014 ) .    c. degen , m. poggio , h. mamin , and d. rugar , _ phys . </S>",
    "<S> rev . </S>",
    "<S> lett . _ * 99 * , 250601 ( 2007 ) .    </S>",
    "<S> t. h. oosterkamp , m. poggio , c. l. degen , h. j. mamin , and d. rugar , _ appl . </S>",
    "<S> phys . </S>",
    "<S> lett . _ * 96 * , 083107 ( 2010 ) .    j. kempf and j. marohn , _ phys . </S>",
    "<S> rev . </S>",
    "<S> lett . _ * 90 * , 087601 ( 2003 ) .    </S>",
    "<S> see supplemental material for details concerning the measurement technique , error propagation , and noise analysis .    </S>",
    "<S> m. poggio , c. l. degen , c. t. rettner , h. j. mamin , and d. rugar , _ appl . </S>",
    "<S> phys . </S>",
    "<S> lett . _ * 90 * , 263111 ( 2007 ) .    </S>",
    "<S> h. j. mamin , c. t. rettner , m. h. sherwood , l. gao , and d. rugar , _ appl . </S>",
    "<S> phys . </S>",
    "<S> lett . _ * 100 * , 013102 ( 2012 ) .    </S>",
    "<S> s. kotler , n. akerman , y. glickman , a. keselman , and r. ozeri , _ nature _ * 473 * , 61 ( 2011 ) .    * supplementary material for : accelerated nanoscale magnetic resonance imaging through phase multiplexing *    bradley a. moores@xmath121 , alexander eichler@xmath121 , ye tao@xmath122 , hiroki takahashi@xmath121 , paolo navaretti@xmath121 , and christian l. degen@xmath121    _ @xmath1department of physics , eth zurich , otto - stern - weg 1 , 8093 zurich , switzerland , and _    _ @xmath110department of chemistry , massachusetts institute of technology , 77 massachusetts avenue , cambridge , massachusetts 02139 , usa _ </S>"
  ]
}