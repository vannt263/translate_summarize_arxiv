{
  "article_text": [
    "galaxy clusters store up to several @xmath4 ergs in the form of hot baryonic matter , with typical temperatures of several kev .",
    "this thermal energy is mostly the by - product of shock - heating processes occurred during the formation of cosmic structures .",
    "however detecting shocks in large scale structures ( lss ) is still observationally challenging since they usually develop in the external regions of galaxy clusters , where the x  ray emission is faint . in a few cases ,",
    "however , internal shocks driven by the merging events have been discovered with typical mach numbers @xmath5 ( e.g. markevitch et al .",
    "1999 ; markevitch et al .",
    "2002 ; belsole et al.2004 ; markevitch & vikhlinin 2007 ) .",
    "studies concerning the convolution of simulated cosmological shocks into simulated x  ray images ( e.g. gardini et al .",
    "2004 ; rasia et al .",
    "2006 ) have clearly shown that the apparent lack of shocks in the icm may be due to the concourse of projections and mass  weighting effects along the line of sight , which tend to bias towards lower values of the overall temperature of the icm and to smooth temperature gradients .",
    "shocks are important not only to understand the heating of the icm but also because they may be efficient accelerators of supra  thermal particles ( e.g. sarazin 1999 ; takizawa & naito 2000 ; blasi 2001 ) . non thermal activity in galaxy clusters is proved by radio observations which show synchrotron emission in a fraction of merging clusters : radio halos , at the cluster center , and radio relics , elongated sources at the cluster periphery ( e.g. , feretti 2005 ) . several mechanisms related to cluster mergers and to the accretion of matter",
    "can act as sources of non thermal components in galaxy clusters .",
    "large scale radio emission in the form of giant radio halos may be powered by particle re - acceleration by mhd turbulence injected in the icm during energetic merging events ( brunetti et al .",
    "2001 ; petrosian 2001 ; brunetti et al . 2004,08 ) .",
    "strong shocks may accelerate supra thermal electrons from the thermal pool and explain the origin of radio relics ( ensslin et al.1998 ) , while high energy electrons accelerated at these shocks can produce x - rays and gamma - rays via inverse compton scattering off cmb photons ( e.g. sarazin 1999 ; loeb & waxmann 2000 ; blasi 2001 ; miniati 2003 ) .",
    "relativistic hadrons accelerated at shocks can be advected in galaxy clusters and efficiently accumulated ( vlk , aharonian , & breitschwerdt 1996 ; berezinsky , blasi , & ptuskin 1997 ) producing an important non - thermal component which could be directly sampled by future gamma ray observations ( e.g. , blasi , gabici & brunetti 2007 ) .",
    "secondary particles injected in the icm via proton  proton collisions may also produce detectable synchrotron radiation ( e.g. blasi & colafrancesco 1999 ; dolag & enssil 2000 ) and may be eventually re - accelerated by mhd turbulence yielding an efficient picture to explain radio haloes ( brunetti & blasi 2005 ) .",
    "the energetics associated with the population of cosmic ray particles ( cr ) accelerated at shocks depends on the mach number of these shocks ( e.g. kang & jones 2002 ) .",
    "the mach number distribution of cosmological shocks is thus important to understand cr in galaxy clusters",
    "analytical studies pointed out that shocks that form during cluster mergers are weak , @xmath6 , being driven by sub - clumps crossing the main clusters at the free - fall velocity ( gabici & blasi 2003 , berrington & dermer 2003 ) .",
    "these approaches however are limited as they treat cluster mergers as binary encounters between ideally virialised spherical systems .",
    "therefore cosmological numerical simulations represent a necessary avenue to address this issue in more detail .",
    "first attempts to characterize shock waves in cosmological numerical simulations were produced by miniati et al.(2000 ) , by employing a set of eulerian simulations and a shock detecting scheme based on jumps in the temperature variable .",
    "later works adopted more refined shock - detecting schemes and were more focused onto the distribution of energy dissipated at shocks ( keshet et al.2003 ; ryu et al.2003 , hallman et al.2003 , pfrommer et al.2006 ) .",
    "ryu et al . and pfrommer et al",
    ". basically found that the bulk of shocks in the universe is made of relatively weak shocks , but also allow to constrain the population of stronger shocks forming in the external regions of galaxy clusters , were structures are not completely virialised . in these environments ,",
    "strong shocks are frequent and may provide the bulk of the acceleration of cr in large scale structures ( ryu et al . 2003 ; pfrommer et al .",
    "for this reason numerical simulations are important to study the non - thermal components in galaxy clusters ( e.g. miniati et al.2001 , miniati 2003 ; keshet et al.2003 ; pfrommer 2008 ) .",
    "however , the identification and characterization of shocks , as well as the calculation of the energy injected in the form of cr at these shocks , is difficult because of the complex dynamics of large scale structures and because of the severe limitations in terms of physics and numerical resolution that affect present cosmological simulations .    in this paper",
    "we follow the approach of the seminal paper by ryu et al .",
    "( 2003 ) , studying the shock wave patterns in lss and characterizing them in a post  processing phase .",
    "this allows us to briefly discuss the effect of different shock detection techniques and their dependence on the variation of underlying physical processes ( e.g. re - ionization ) in the simulation .",
    "we use the cosmological code enzo ( bryan & norman 1997 ) , which treats gas dynamics with an eulerian scheme and allows us to follow the assembly of lss with sufficiently good spatial resolution .",
    "the outline of the paper is the following . in sect.[sec :",
    "enzo ] we provide a brief introduction to the enzo code , in sect.[sec : sim ] we present our cluster sample and the main properties of cosmological structures in our simulations , and in sect.[sec : reionization ] we discuss the effect of re - ionization on the thermal properties of simulated cosmic structures . in sect.[sec : algo ] we provide the different methods to characterize shocks in post processing and in sect.[sec : comparison ] we discuss their main source of uncertainties in the cosmological framework . in sect.[sec : results ] we present our results about the main shocks properties and about the injection of cr .",
    "the main conclusions of this work are given in sect.[sec : conclusions ] .",
    "in the appendix we the effect of the resolution and of @xmath7 on our results .    [ tab : tab0 ]    .main characteristics of the simulations . [ cols=\"^,^,^,^\",options=\"header \" , ]     [ fig : distrib_ev ]",
    "shocks and compressions driven by the gravitational force are the only sources that increase the thermal energy of cosmic baryons in our adiabatic simulations .",
    "baryons far away from collapsing regions have the lowest temperature that can be potentially affected by the process of re - ionization which occurred between @xmath8 and @xmath9 ( e.g. fan , carilli & keating 2006 ) .",
    "this process heats up the medium , increasing the speed of sound in the lowest temperature regions and this affects our estimate of the mach number of shocks .",
    "therefore a study of cosmological shock waves must deal with the influence of a re  ionizing background ( haiman & holder 2003 ; loeb & barkana 2005 ; mellema et al.2006 ) .",
    "the re - ionization scheme available in enzo is linked with a treatment of radiative cooling , which is computed by assuming an optically thin gas of primordial composition , in collisional ionization equilibrium , following katz , weinberg & hernquist ( 1996 ) . the time ",
    "dependent uv background is introduced according to haardt & madau ( 1996 ) and it models the effect of a population of quasars that re - ionizes the universe at @xmath10 .",
    "the implementation of run  time re - ionization is more expensive in terms of memory usage compared to non  radiative simulations , and we thus applied it only in two re  simulated data  sets ( _ co125 , co250 _ ) .",
    "the effect of a re  ionizing background can also be modeled in the post  processing phase by increasing the temperature of each cell in the simulation .",
    "this has been done in ryu et al.(2003 ) , where a constant value of @xmath11 was imposed to the simulated volume at @xmath12 .",
    "this may correctly reflect the complete re  ionization inside halos at present epoch ( haiman & holder 2003 ) , however it may overestimate the mean temperature of baryons far away of the most massive cosmic structures .",
    "figure [ fig : phase_col ] shows the phase diagram in one @xmath13 simulation from the _ ad125 _ data set , and in its re - simulation with cooling and re - ionization , _ co125_. re ",
    "ionization efficiently removes the coldest phase of the baryons and a forbidden region in the @xmath14 space forms ( where @xmath15 and @xmath16 are gas temperature and density , respectively ) , which actually traces the lower bounds of the warm hot intergalactic medium ( katz , weinberg & hernquist 1996 ; cen & ostriker 1999 ; valageas , schaeffer & silk 2002 ; regan , haehnelt & viel 2007 ) .",
    "this lower bound is evolving with time , as shown if fig.[fig : min_t ] where we report the fit to the value of the 15 per cent percentile in the distribution of temperature in the cells for different density bins .",
    "we also checked that variations in the percentile ( up to @xmath17 per cent ) does not significantly affect the results . by restricting to baryon densities in the range",
    "@xmath18 we obtain best fits with a second order polynomial :    @xmath19    where @xmath20gr @xmath21 . the best fit parameters for each redshift are reported in table 2 . at moderate redshift ( @xmath22 )",
    "all curves can also be approximated with a simple power law , @xmath23 ( consistent with valageas et al.2002 ) , and with a normalization decreasing with time .",
    "in particular , at @xmath12 the minimum temperature of baryons is given by :    @xmath24    which is indeed consistent with eq.21 in valageas et al .",
    "( 2002 ) . by using the _ co250 _ data set we also verified that these fits do not change with spatial resolution .",
    "we use the fitting formulas in tab.2 to increase the temperature of baryons in our adiabatic simulations in the post - processing analysis . in fig.[fig : madau - vs - post ] we show the evolution with time of the temperature distribution function , in case of adiabatic sub ",
    "sample of the _ ad125 _ simulation with post  processing treatment and in the case of _",
    "co125 _ simulation with run ",
    "time re - ionization .",
    "the agreement between the two distributions demonstrates the validity of our post  processing approach that will be applied in the following to the full set of our adiabatic simulations ( _ ad125 , ad250 , ad500 _ and _ ad800 _ ) .     per side ,",
    "the width along the line of sight is @xmath25.,scaledwidth=45.0% ]     of our @xmath26 run.,scaledwidth=48.0% ]",
    "the passage of a shock in a simulated volume leaves its imprint as a jump in all the thermodynamical variables . under the simple assumption that the pre  shocked medium is at rest and in thermal and pressure equilibrium , the pre  shock and post  shock values for any of the hydrodynamical variables ( density , temperature and entropy ) is uniquely related to the mach number , @xmath27 , @xmath28 being the shock speed in the region and @xmath29 the sound speed ahead of the shock itself . the rankine ",
    "hugoniot jump conditions contain all the information needed to evaluate @xmath30 ; if the adiabatic index is set to @xmath31 one has the well known relations ( e.g. landau & lifshitz 1966 ) :    @xmath32    @xmath33    and    @xmath34    with indices @xmath35 referring to pre and post  shock quantities , respectively , and where the entropy @xmath36 is @xmath37",
    ".    the mach number can be obtained from the jumps in one of the hydro dynamical variables ( eqs.[eq : dens][eq : entropy ] ) or from a combination of them .",
    "it is well known that the value of the density jump saturates at @xmath38 in the case of relatively large mach numbers ( eq.[eq : dens ] ) and thus strong shocks can not be constrained from density jumps .",
    "for this reason temperature and entropy jumps provide the most effective tools to measure @xmath30 .",
    "eqs.[eq : dens][eq : entropy ] describe shock discontinuity in the case of an ideal shock . in practice measuring",
    "the mach number of the shocks in simulations is more problematic .",
    "matter falling in the potential wells may have chaotic motions and the temperature distribution is usually patchy due to the continuous accretion and mixing of cold clumps and filaments into hot halos .",
    "all these complex behaviors establish velocity , temperature and density discontinuities across the cells in the simulated box . in a post - processing analysis",
    "this is expected to modify irreparably the strength of the jumps in the thermodynamical variables in the shocked cells with respect to that expected in the ideal case ( eqs.[eq : dens][eq : entropy ] ) .",
    "consequently the estimate of the mach number from these equations is subject to unavoidable uncertainties ( see sec.6.2 ) .",
    "the analysis of jumps in temperature is commonly adopted to measure the strength of shocks in eulerian cosmological simulations ( e.g. , miniati et al .",
    "2001 ; ryu et al .",
    "2003 ) .",
    "cells hosting a possible shock pattern are preliminary tagged by means of two conditions :    * @xmath39 ; * @xmath40 ;    an additional condition on the strength of the temperature gradient across cells is also customary requested , e.g.    * @xmath41 ;    ( specifically @xmath41 filters out shocks with a mach number @xmath42 , ryu et al.2003 ) ; however in the following we neglect this third condition , in order to have a better comparison with the results obtained with the vj method ( see below ) .    the shock discontinuity in the simulation",
    "is typically spread over a few cells , thus following hallman et al.(2004 ) for each patch of candidate shocked cells we define the shock center with the position of the cell in the shocked region where @xmath43 is minimum and calculate the mach number of the shock from eq.[eq : temp ] , where @xmath44 and @xmath45 are the post and pre  shock temperature across the shock region .",
    "the mach numbers measured along the three coordinate axes are finally combined to compute the mach number of the shocked cell : @xmath46 .",
    "more specifically , in the case the shock - jump is assumed to happen in 1 cell , @xmath44 is the temperature of the shock center , while in the case that the jump is spread over 2 , 4 , 6 , ",
    "2_n _ cells @xmath44 and @xmath45 are the temperatures of the two cells at distance of _ n _ cells ( in opposite direction ) from the center of the shock .    in the following",
    "we will refer to this method as the _ tj _ method .",
    "conservation of momentum in the reference frame of the shock yields :    @xmath47    with the same notation used in eqs.[eq : dens][eq : entropy ] . in the ideal case",
    "in which the pre - shocked medium is at rest and in thermal and pressure equilibrium , the passage of a shock with velocity @xmath48 leaves a clear imprint as a velocity difference , @xmath49 , between the shocked and pre  shocked cells .",
    "the relationship between @xmath49 and mach number in the case of hydrodynamical shocks can be obtained by combining eq.[eq : momentum ] with eq.[eq : dens ] and by transforming the velocities from the shock frame to the lab frame :    @xmath50    where @xmath51 and @xmath29 is the sound velocity computed in the pre  shocked cell .",
    "the procedure we adopt to identify shocks and reconstruct their mach numbers is the following :    * we consider candidate shocked cells those with @xmath40 ( calculated as 3dimensional velocity divergence to avoid confusion with spurious 1dimensional compressions that may happen in very rarefied environments ) ; * since shocks in the simulation are typically spread over a few cells , as in the case of the tj method , we define the shock center with the position of the cell in the shocked region with the minimum divergence ; * we scan the three cartesian axes with a one  dimensional procedure measuring the velocity jump , @xmath52 , between a few cells across the shock center . in the case",
    "the shock - jump is assumed to happen in 1 cell @xmath52 is calculated between the shock center and the pre - shocked cell , while in the case that the jump is spread over 2 , 4 , 6 , ",
    "2_n _ cells @xmath52 is calculated between two cells at distance of _ n _ cells ( in opposite direction ) from the center of the shock ; * the mach number of the shock is given by eq.[eq : mach_v ] , where the sound speed is that of the pre - shock region ( the cell with the minimum temperature ) ; * we finally assign to shocked cells a mach number @xmath46 , that minimizes projection effects in the case of diagonal shocks , and restrict to shocks with @xmath53 .    in the following we refer to this procedure as the velocity jump ( vj ) method .",
    "in this section we discuss the uncertainties of the methods presented in the previous section , discuss the effect of the re - ionization on the characterization of cosmological shocks and briefly compare results from the vj and tj approaches .      although the shock discontinuity in enzo is found to be well reconstructed within 2 - 4 cells ( e.g. , tasker et al .",
    "2008 ) , the risk that comes from the application of procedures based on cell - to - cell jumps ( or jumps between a few cells ) is to underestimate the value of the mach number of the shock .",
    "we performed several shock  tube tests with enzo with the same numerical setup used in the cosmological simulations , in order to evaluate the convergence of the value of the shock mach number with the number of cells used to calculate jumps .",
    "we find that a reasonable convergence , within 10 - 30% for @xmath54 , is already obtained with the vj method in the case that the velocity jump is evaluated across three cells ( @xmath55 , where @xmath56 is the distance , in term of cells , between the shock center and the pre or post - shock cells , sects .",
    "5.2 - 5.3 ) , and that convergence is reached for @xmath57 . on the other hand ,",
    "the velocity pattern in cosmological simulations is complex and the risk of procedures based on jumps evaluated with large @xmath56 in our simulations is to mix together signals produced by different shocks , and also to be affected by gradients in thermodynamical variables due to clumps of baryonic matter produced by the process of structure formation . in fig ,  [ fig : lags ] we show a map of the mach numbers obtained with the vj method for a galaxy cluster in the @xmath26 run , by assuming a cell - to - cell ( two cells ) velocity jump , and @xmath55 , @xmath58 and @xmath59 jumps .",
    "it is clear that for @xmath60 ( jumps based on @xmath615 cells , @xmath61625 kpc ) different shock - patterns and clumps of gas matter start to be mixed together and shocks become poorly characterized .",
    "similar results are found in the case of the tj method , thus we conclude that reconstructing the shock discontinuities in our numerical simulations with @xmath55 ( jumps based on 3 cells ) provides the best compromise .      as already pointed out in sect.[sec : algo ]",
    ", a major limitation of the analysis of shocks in post processing comes from the fact that the dynamics and thermodynamics of the gas in the simulations is more complex than in the ideal case in which eqs.[eq : dens][eq : entropy ] and [ eq : mach_v ] are derived . in this sub - section",
    "we discuss the uncertainties that come out without including the modeling of re - ionization in our procedure .",
    "the temperature distribution in simulations is very complex and temperature gradients across non  shocked cells are common by  products of the structure formation process .",
    "the passage of a shock in a medium with a complex temperature distribution partially smooths out pre - existing gradients in the thermodynamical variables and creates new shock  induced discontinuities .",
    "one possibility to estimate the level of uncertainties in the application of the tj method is to introduce a passive modification of the post  shock temperature in eq.[eq : temp ] according to the value of a typical cell to cell temperature jumps across non shocked cells , and compare the resulting mach number with that from eq.[eq : temp ] in its original form .",
    "obviously this procedure assumes that these jumps are representative of pre - existing temperature gradients , where shocks are presently found , still there is no clear argument for which this unavoidable assumption is not statistically reasonable .",
    "we consider as non  shocked cells those that do not satisfy , at the same time , the tj and vj criteria for shocked cells , and extract the values of their cell to cell temperature jumps , @xmath62 , in different cosmic environments from the _ ad125 _ simulation at @xmath12 . to follow a very conservative procedure we consider only temperature jumps across a sub  sample of non shocked cells that are at least three cells far away from any shocked cell .    we characterize the cosmic environment by means of the total matter density in cells :    * * @xmath63 * : voids and under - dense regions , * * @xmath64 * : filaments and sheets , * * @xmath65 * : cluster outskirts , * * @xmath66 * : galaxy clusters .    where @xmath67 is the total matter density and @xmath68 is the critical density of the universe . these are expected to mark the different kind of structures of the cosmic web ( e.g. dolag et al.2006 ; shen et al.2006 ) .    in fig.[fig :",
    "deltat_histo ] we plot the differential distribution of ( the module of ) temperature jumps across the considered sub - sample of non  shocked cells , @xmath62 , normalized to a reference value of the local temperature , @xmath69 , for the different density regimes .",
    "the peak of the distribution is found at @xmath70 . in the case of filaments and voids the distributions extend at larger values , although large temperature scatters , @xmath71 , are only found in voids , where they represent less then 1 percent of all cells .    extremely rare in the case of filaments and are found for only a few percent of the cells in the voids .    for the values of @xmath72 representative of clusters , outskirts and filaments in our simulation",
    ", we allow @xmath73 to vary and run monte carlo extractions of @xmath62 extracted across non  shocked cells with temperature @xmath73 in the same environment . we then compared the estimate of the shock mach number by eq.[eq : temp ] with the one obtained by using :    @xmath74    figure 7 shows the typical scatter introduced in the @xmath75 vs @xmath30 plane by the presence of realistic ( i.e. measured in non  shocked cells in our simulations ) pre  shock fluctuations in the temperature , for different cosmic environments .",
    "the red line shows the ideal case : given a ratio @xmath75 the degree of uncertainty on @xmath30 due to the presence of pre  shock fluctuations in the simulation can be grossly evaluated by an horizontal cut across the distribution of the data points .",
    "this scatter increases as the mach number decreases and , at a given mach number , it is typically smaller in environments with larger over - density .     and resolution @xmath25 .",
    "curves are drawn for the case without re - ionization ( _ black solid _ ) , for the haardt & madau ( 1999 ) re - ionization scheme applied in post - processing ( _ blue dashed _ ) and for different choices of a fixed @xmath76 temperature floor ( color coding is labeled in the panel).,scaledwidth=48.0% ]          complex velocity fields arise naturally during the formation of virialised structures in simulations ( bryan & norman 1998 , sunyaev ; norman & bryan 2003 ; dolag et al .",
    "2005 ; vazza et al . 2006 ; iapichino & niemeyer 2008 ) that however are expected to be smaller than the velocity jumps driven by the passage of a shock across the same regions .",
    "a more complex situation is that of non virialised structures where laminar flows may produce relatively strong velocity gradients across the cells .",
    "an example is given in fig .",
    "[ fig : deltat_histo ] , where we report the differential distributions of the velocity gradients , @xmath77 , normalized to the maximum value of the sound speed in each pair of cells , obtained for the same sub - sample of non - shocked cells considered in the previous sub - section .",
    "the distributions peak at @xmath78 , although tails extending towards larger values are found in the distributions of voids and filaments .",
    "these tails are mostly due to velocity gradients measured across accelerated laminar flows ( where the kinetic energy of the gas may become even larger than the thermal energy ) that move from low to higher density regions and are present in a small fraction of the volume of filaments and voids .    in order to grossly estimate the strength of the uncertainties in the case of clusters , outskirts and filaments , we follow a procedure similar to that in sect.[subsec : tjun ] . for these different environments",
    "we fixed a value of @xmath79 , run a monte carlo extraction of @xmath80 from non shocked cells in the simulations ( fig.[fig : deltat_histo ] ) and for each trial calculated the mach number from :    @xmath81    this equation accounts for both pre - shock gradients in the velocity and in the sound speed across non shocked cells .",
    "gradients in @xmath29 are driven by gradients in the temperature distribution of the cells and are evaluated by a montecarlo extraction of the temperature variations in fig .",
    "[ fig : deltat_histo ] .    in fig.[fig",
    ": error_vj ] we report @xmath82 vs @xmath30 from our monte carlo extraction compared to the calculations in the _ ideal case _ ( eq.[eq : mach_v ] ) .",
    "this result should be compared with that in fig.[fig : error_tj ] obtained for the tj method and the degree of uncertainty on @xmath30 can be grossly evaluated by an horizontal cut across the distribution of the data points . as expected , in the case of clusters and outskirts",
    "the scatter in the two cases is quite similar , although in the case of weak  moderate shocks crossing filaments and outskirts the scatter is less pronounced than that of the tj method ( fig.[fig : error_tj ] ) .",
    "the role of re - ionization is of primary importance to study the properties of shocks outside galaxy clusters . in adiabatic simulations ,",
    "regions far away from intense structure formation are very cold due to the lack of intense shock heating and due to cosmic expansion . in these environments ,",
    "any additional source of heating ( such as re - ionizing radiation from agn and/or massive stars feedback ) causes a dramatic increase of the local temperature and sound speed .",
    "thus the temperature distribution across cells in these regions is strongly affected by the modeling of the re - ionization in the simulations , and this implies an additional uncertainty in the characterization of shocks .",
    "this is expected to be particularly relevant in all shock detecting schemes where temperature plays a role .",
    "therefore in this section we highlight the main effect of cosmic re - ionization on shocks fig.[fig : fix_reion ] shows the maps of the detected shocks in a @xmath83 cubic region extracted from the _ ad125 _ simulation and centered on a @xmath84 cluster .",
    "results are reported , by calculating shock - jumps across three cells ( n=1 , sect .",
    "5.2 , 5.3 ) , in the case of no re - ionization and of a haardt & madau ( 1996 ) re - ionization scheme .",
    "as expected the mach number of shocks decreases in simulations with re - ionization due to the increase of the sound speed produced by the re - ionization background .",
    "this effect is stronger in the cold outermost regions , while the properties of cosmological shocks in galaxy clusters are not affected by the re - ionization background .",
    "re - ionization also allows to better describe shocks around filamentary structures in low density regions that are not seen in the case of simulations without re - ionization ( fig.[fig : fix_reion ] ) .",
    "this is because without re - ionization these regions have temperature so small that the temperature floor ( 1 k ) adopted ( in the outputs ) by enzo artificially affects their temperature distribution .    in fig.[fig :",
    "rhov_cfr ] we report the kinetic energy flux through shocked cells as calculated by means of the vj method .",
    "the kinetic energy flux , @xmath85 , is reported for different numerical modeling of the re - ionization : three different temperature floors ( @xmath86 , @xmath87 and @xmath88 ) , haardt & madau ( 1999 ) model , and no re - ionization .",
    "we find that a fixed temperature floors , which is customary used in several papers to mimic the effect of re - ionization ( e.g. ryu et al . 2003 ) , produces some _ artificial _ piling up or flattening in the distributions of the energy flux through shocks at large mach numbers .",
    "this is because the temperature background , @xmath76 , changes artificially the speed of the sound in environments with lower temperature and the mach number of shocks in these environments is affected by @xmath76 , decreasing artificially with increasing @xmath76 .",
    "this further supports the requirement of a physically meaningful treatment of re - ionization in a post processing procedure .",
    "as already discussed , the post processing fitting procedure described in sect.[sec : reionization ] closely resembles the effect of the physically based haardt & madau ( 1999 ) re - ionization scheme .          in this section",
    "we briefly compare the results obtained from the vj and tj approaches . here",
    "we focus on results obtained with our fiducial numerical treatment of the re - ionization as this treatment will be used in the following of the paper ; a more detailed comparison is ongoing and will be presented in a forthcoming paper ( vazza et al . in prep ) .",
    "in the ideal case the two approaches must select the same population of shocked cells . in reality",
    "we find that , when shock - jumps are calculated across 3 cells , about 85 per cent of the shocked cells in our simulations are selected at the same time by the conditions in the vj and tj approaches . in the case of clusters and cluster",
    "outskirts the two approaches select the same population of shocked cells , while these differences typically arise from shocks in low temperature regions .    in the case of clusters and outskirts",
    "the velocity and temperature variations across non shocked cells are relatively small ( fig .",
    "[ fig : deltat_histo ] ) and this allows constraining the mach number of shocks by means of both the tj and vj approach .",
    "still the statistical uncertainties for weak shocks with the tj method are expected to be slightly larger than those with the vj ( figs.[fig : error_tj ] & [ fig : error_vj ] ) .",
    "a comparison between the statistical description of the properties of the shocks with vj and tj approaches is shown in fig.[fig : histo_vjtj ] where we report the mach number distribution of shocks extracted from the _",
    "ad125 _ run with our post - processing treatment of re - ionization and from the corresponding _",
    "co125 _ with run - time treatment of re - ionization .",
    "basically the results from the two methods are fairly similar in the case of clusters and cluster outskirts , and no remarkable differences are found also in the case of filaments and voids .",
    "this suggests the important point that the characterization of shocks in these environments is statistically solid , as two independent approaches lead to basically similar results .",
    "we also note that the mach number distributions extracted from simulations with post processing re - ionization are similar to those produced with run time re - ionization , and this further suggests that our treatment of re - ionization in post processing allows statistically valid studies of shocks . in the next sections we shall use the vj method to study shocks properties .",
    "this is because we believe that in the case of weak  moderate shocks , especially in lower density regions , the vj is less affected by uncertainties ( e.g. , figs .",
    "in this section we present the main results obtained for the full set of simulations by making use of the vj method and by calculating shock - jumps across three cells , i.e. @xmath55 ( unless specified ) .     with post - processing re - ionization , for different cosmic environments .",
    "dashed lines show the distributions obtained with velocity jumps evaluated across three cells ( @xmath55 ) , while dashed lines shows distributions obtained with cell  to  cell velocity jumps ( @xmath89).,scaledwidth=47.0% ]     run , from @xmath90 to @xmath91 .",
    "only a sub sample of redshifts is shown for clarity.,scaledwidth=48.0% ]      shocks fill the simulated volume in a very complex way ( e.g. miniati et al.2001 , ryu et al.2003 ) . in fig.[fig : mappe ] we show a 125 kpc cut of a cubic region of side @xmath92 from the _",
    "ad125 _ run at @xmath12 with post - processing re - ionization , reporting gas temperature and detected shocks with mach numbers reported in color code .",
    "we find that @xmath93 per cent of the cells in the simulated volume host shocks at present epoch , with the percentage of shocked cells increasing in denser environments .",
    "filamentary and sheet  like shocks pattern are usually hosted in low density regions and at the interface of filaments , following the shape of the cosmic web .",
    "this kind of shocks follows the first infall of baryonic matter onto accreting structures , and generates an abrupt increase in temperature due to the jump from a re - ionization dominated temperature to the gravitationally dominated one .",
    "these shocks are commonly defined as",
    "_ `` external shocks '' _ ( miniati et al.2001 ) , and they are the strongest within the simulation , having @xmath94",
    ". shocks surrounding galaxy clusters form spherically shaped boundaries at a typical distance of about @xmath95 from the cluster center , while shocks moving inwards the virializing region are found more irregular and weak , with @xmath96 .",
    "this kind of shock waves is commonly defined as _",
    "`` internal shocks '' _ ( miniati et al.2001 ) .",
    "slightly stronger shocks ( i.e. @xmath97 ) inside @xmath98 are episodically found in our simulations in case of merger events . in this case",
    "the violent relaxation due to the fluctuation of the gravitational potential may cause infall of the pre  shocked gas onto the shock discontinuity increasing the mach number ( springel & farrar 2007 ) , while other kind of strong shocks are reverse shocks propagating trough the innermost regions of accreting and cold sub clumps , which keep themselves at the pre  shock virial temperature for several gyrs during their orbiting around the center of the main cluster ( tormen , moscardini & yoshida 2004 ) .",
    "an issue which is poorly addressed in the literature is the distribution function of shocks with their mach number .",
    "fig.[fig : histo ] shows the mach number distribution of the shocks detected in our total @xmath99 cubic volume at present cosmic epoch .",
    "this figure also shows the effect of using cell - to - cell velocity jumps to reconstruct the mach number of shocks with the vj scheme .",
    "the number of stronger shocks , that are well reconstructed within 34 cells , increases with @xmath55 and this produces a flattening of the differential distribution of shocks inside the simulated volume . as shown in section  6.1 , using a larger number of cells to reconstruct the mach number does not improve the characterization of shocks , yet the risk becomes to mix different shock patterns and sub - structures in the simulations .",
    "the overall differential distribution of shocks with their mach number in the cosmic volume is very steep , with @xmath100 ( with @xmath101 ) , and the bulk of the detected shocks at any mach number is found in the low density regions , which fill the majority of the volume in the simulations .",
    "the mach number distribution of detected shocks becomes increasingly steeper moving towards dense environments : @xmath102 to @xmath103 is found in clusters and their outskirts .    the evolution with time of the differential mach number distribution is given in fig.[fig : evolution1 ] , for the case of a 80 mpc cubic region extracted from the @xmath104 simulation , which was designed to have a suitable time  sampling in the analysis of outputs .",
    "we find that before the epoch of re - ionization , @xmath105 , roughly 30% of the simulated volume is shocked . then as soon as re - ionization plays a role , the temperature of the simulated volume increases and the mach number distribution of shocks at redshift @xmath106 undergoes a dramatic change becoming very steep and dominated by weak shocks .",
    "with decreasing redshifts , temperature in low density regions gradually decreases and the mach number distribution becomes gradually flatter with the fraction of shocked cells reaching @xmath107 per cent at present epoch .         .",
    "[ fig : flux0 ]         .",
    "the shadowed regions show the cosmic variance within our 6 simulations , the dot - dashed line shows the global average within the sample.,scaledwidth=48.0% ]      the energy flux converted into thermal energy of the gas at a shock is given by the rankine ",
    "hugoniot jumps conditions , which relate the flux of the kinetic energy crossing the shock , @xmath108 , and the resulting thermal flux in the post  shock region , @xmath109 .",
    "this relation can be expressed by means of a simple @xmath110 parameter ( e.g. ryu et al.2003 ) :    @xmath111 \\label{eq : eq_flux}\\ ] ]    where @xmath112 and @xmath113 are the thermal energies in the pre and post  shock regions , @xmath114 is the kinetic energy of the shock , and @xmath115 is the adiabatic exponent ( @xmath116 ) .",
    "it is useful to express @xmath110 by means of the mach number ( e.g. kang et al.2007 ) :    @xmath117            \\label{eq : eq_delta}\\ ] ]    where @xmath118 is the density compression factor :    @xmath119    we notice that eq.[eq : eq_flux ] strictly holds only in case of a negligible cr energy density , otherwise the feedback of these cr on the shock itself is expected to severely decrease the efficiency of thermalisation of the kinetic energy flux ( see next section ) .",
    "fig.[fig : flux0 ] ( right panel ) shows a 2dimensional cut , with depth=125 kpc , of the measured thermal energy flux in shocked cells , at the present epoch and for a region centered around two massive ( @xmath120 and @xmath121 ) galaxy clusters .",
    "these clusters belong to a large scale filament ( see left panel of fig.[fig : flux0 ] ) , for which we provide also a 3dimensional rendering of the thermal energy flux through shocks ( left panel of fig.[fig : flux1 ] ) .",
    "the differential distribution of the thermalised flux as a function of the mach number of the shocks is reported in fig.[fig : histo_flux ] .",
    "this shows the differential distribution calculated for the total volume at the present epoch and normalized to the comoving volume of @xmath122 .",
    "solid lines give average values , while dashed shadows give the variance spanned by the six different @xmath92 cubic sub samples of the ad125 simulation .",
    "the variance in the distribution is fairly small , @xmath123 per cent at the peak , although this increases for the stronger shocks that are rare .",
    "we find that the total processed thermal energy across cosmological shocks in our simulations is @xmath124 at the present epoch .",
    "this is of the same order of magnitude of the value of the total processed thermal energy found by ryu et al.(2003 ) and by pfrommer et al.(2006 ) , for the same @xmath125145 mpc cubic volume .",
    "however , as discussed in sect.[subsec : gc ] the deficit in massive halos in our clusters sample may induce a slightly smaller level of thermalised energy flux in the volume .    for mach numbers @xmath126 ( which provide about the 99 percent of the total thermal flux in the simulated volume ) the distribution in fig.[fig : histo_flux ] has @xmath127 ( with @xmath128 ) , and is steeper than that in ryu et al.(2003 ) , @xmath129 , while is consistent with that in pfrommer et al",
    "( 2006 ) , @xmath130 .",
    "we find that @xmath131 per cent of the total thermal energy flux dissipated at shocks comes from the virial region of galaxy clusters ( because of their large matter density ) and that the bulk of the thermalisation happens at shocks with @xmath1 ( fig.[fig : histo_flux ] ) .",
    "these relatively weak shocks are also responsible for the bulk of the thermalisation in lower density environments , although stronger shocks may provide a sizable contribution in these regions .",
    "the time evolution of the distribution of the thermal energy dissipated at shocks as a function of the shock - mach number is an important issue .",
    "a relevant example is reported in fig.[fig : flux_evolution ] that is obtained for the same volume of fig .",
    "[ fig : evolution1 ] ( @xmath104 ) .",
    "the evolution of the overall distribution follows a similar behavior with cosmic time found for the number distribution of shocks , with strong shocks becoming more frequent at evolved times when the energy density of the background becomes lower ( see also pfrommer et al .",
    "the integrated ( over cosmic time ) thermal energy dissipated at shocks in our @xmath132 volume is @xmath133 , which is consistent with the values reported in pfrommer et al .",
    "( 2006 ) and ryu et al.(2003 ) , also by taking into account the deficit in the halos mass in our simulations ( sect.[subsec : gc ] ) .    , from @xmath134 to @xmath91 .",
    "only a sub sample of redshifts is shown for clarity.,scaledwidth=48.0% ]      the injection and acceleration of cosmic rays at shocks is a complex process .",
    "it is customary to describe the acceleration according to the diffusive shock acceleration ( dsa ) theory ( e.g. drury & voelk 1981 ; blandford & ostriker 1978 ) .",
    "this theory applies when particles can be described by a diffusion  convection equation across the shock .",
    "there is some general agreement on the fact that strong shocks may channel a substantial fraction of their energy flux into the acceleration of cr which in turn should back react modifying the structure of shocks themselves .",
    "recent advances rely on the theory of non linear shock acceleration , which describes the acceleration of cr in shocks whose structure is modified by the back  reaction of cr energy ( e.g. , ellison , baring , jones 1995 ; malkov 1997 ; kang , jones & gieseler 2002 ; blasi 2002 , 2004a ; kang & jones 2005 ; amato & blasi 2006 ) .",
    "the most relevant uncertainty in the description of the particle acceleration at these shocks is the injection model , i.e. the probability that supra - thermal particles at a given velocity can leak upstream across the sub shock and get injected in the cr population .",
    "this is because even a small variation of the injection momentum , @xmath135 , of supra - thermal particles produces a large difference in the estimate of the injection efficiency at shocks ( e.g. blasi 2004b ) .",
    "an other major hidden ingredient is the amplification of the magnetic field ( perpendicular component ) downstream due to cr driven instabilities and adiabatic compression , as this magnetic field self  regulates the diffusion process of cr and supra  thermal particles ( i.e. the larmor radius ) and considerably affects the value of @xmath135 .",
    "an additional difficulty which comes out is that a post  processing approach , as that followed in our paper , does not allow us to account for the dynamical contribution of cr accelerated at cosmological shocks .    with all these caveats in mind ,",
    "we follow the approach adopted by ryu et al.(2003 ) in which the thermalisation is calculated by means of the standard eqs.[eq : eq_flux][eq : eq_delta ] and the cr acceleration at shocks is calculated by making use of numerical results of non linear shock acceleration which adopt a numerical description of the _ thermal leakage _ to model the injection of particles in the population of cr upstream ( kang & jones 2002 , kj02 ) .",
    "these numerical results provide an estimate of the ratio between the energy flux trough a shock and the energy flux which is channeled into cr acceleration at the shock by means of a simple parameter , @xmath136 , which depends on the mach number of that shock .",
    "fig.[fig : flux1 ] ( right panel ) maps the ratio between cr and thermal energy flux for the same region reported in right panel of fig.[fig : flux0 ] .",
    "this clearly shows the role played by the mach number in setting the level of the injection of cr in the various environments . since",
    "the ratio @xmath137 @xmath138 increases with the mach number of the shocks , the highest values of @xmath139 are found in low density regions , at the interface layers of filaments or in the outermost regions of galaxy clusters , where a substantial population of relatively strong shocks is present . on the other hand the lower values",
    "are typically found in galaxy clusters , where the mach number distribution is steep and strong shocks are rare .",
    "the distribution of the energy flux injected in cr as a function of mach number is reported in fig.[fig : histo_cr ] ( _ left _ panel ) ; this refers to the total simulated volume at the present epoch .",
    "we find that the bulk of the cr acceleration at present epoch takes place in galaxy clusters , however also filaments are expected to contribute significantly to the overall acceleration process .",
    "the overall distribution has a well defined peak which is anchored at @xmath1 and has a slope ( between @xmath140 ) @xmath141 ( with @xmath142 ) .",
    "the value of the mach number at the peak is close to ( even if slightly smaller than ) that found by ryu et al.(2003 ) ( @xmath97 ) , while the distribution is steeper than that reported in ryu et al.(2003 ) ( where @xmath143 ) .",
    "since we use an approach equivalent to that in ryu et al.(2003 ) to evaluate the cr acceleration , this difference is likely related to our different shock detecting scheme , to our different modeling of the re - ionization process and also to the slightly different value of the @xmath7 parameter ( @xmath144 in ryu et al.2003 ; we discuss in the appendix the influence of @xmath7 in the shock statistics ) .",
    "a comparison with the results in pfrommer et al.(2006 ) is more difficult since these authors use a lagrangian smoothed particles hydrodynamics code which also include cr dynamics and a completely different approach in the calculation of the cr injection at shocks .",
    "the overall distribution of the energy flux injected in cr reported in pfrommer et al.(2006 ) has a slope @xmath145 and is actually in between our results and those of ryu et al .",
    "( 2003 ) .    for seek of completeness , in fig.[fig :",
    "histo_cr ] ( right panel ) we also report the overall distribution of the energy flux injected in cr by adopting the injection efficiency of cr at modified shocks by kang & jones 2007 ( kj07 ) .",
    "these recent calculations account for the alfvn wave drift and dissipation in the shock precursor and this yields a value of @xmath146 which is smaller than that adopted by ryu et al.(2003 ) ( at least for @xmath147 ) . as a consequence the resulting distribution of the energy flux dissipated at shocks into cr acceleration as a function of the shock",
    " mach number is flatter than that obtained by adopting kj02 and @xmath125 50 per cent less energy is expected to be channeled into cr acceleration .",
    "fig.[fig : cr_int ] shows the evolution with time of the ratio @xmath139 for the same volume ( co125 ) considered in figs .",
    "[ fig : evolution1 ] and [ fig : flux_evolution ] .",
    "the value of @xmath139 as measured at the present epoch , @xmath148 , is a factor @xmath1252 smaller than that found in ryu et al.(2003 ) . by adopting the injection efficiency of cr of kj07",
    "the ratio @xmath139 is even smaller , about 0.1 , as the injection efficiency of cr in kj07 is smaller than in kj02 ( at least for shocks with @xmath147 ) .",
    "although fig .",
    "[ fig : cr_int ] shows that cr in dense regions do not provide a relevant back - reaction on the thermal pool during their acceleration ( this justifies the use of eqs .",
    "1012 in these environments ) , the larger values of @xmath139 in low density regions and at early cosmic times suggest that following ( run - time ) the dynamics of cr and the ( self consistent ) non  linear shock thermalisation and cr acceleration is mandatory in future studies with eulerian  cosmological simulations .          for the same sub sample as in fig.15 and [ fig : flux_evolution ] , shown for different environments .",
    "the upper panel is for the acceleration model outlined in kang & jones ( 2002 ) , while the lower panel is for the acceleration model of kang & jones ( 2007).,scaledwidth=48.0% ]      in this section we focus on the shock statistics and cr injection in galaxy clusters and briefly discuss their dependence on the cluster dynamics .",
    "we study shocks in four representative massive galaxy clusters extracted from the _ ad125 _",
    "simulation , at @xmath12 :    * * c1 * : a @xmath149 cluster in a relaxed state ; * * c2 * : a @xmath149 cluster subject to an ongoing minor merger with a sub clump with mass @xmath150 ; * * c3 * : a @xmath151 cluster approaching a major merger with zero impact parameter , with a companion cluster ( with @xmath152 ) that is at a distance of @xmath153 from the main cluster center ; * * c4 * : a @xmath154 cluster in a post  merging phase ( the merger occurs in the simulation @xmath155 gyr in look back time ) .             , scaledwidth=46.0%,scaledwidth=45.0% ]    these clusters are reported in fig.[fig : map_clusters ] , that shows maps of projected baryon density in a @xmath156 regions centered on clusters , and maps of the mach number measured in slices crossing the same regions .    in the case of _",
    "( minor merger ) and _ c3 _ ( major merger ) relatively weak , @xmath157 , shocks are found inside @xmath98 , while in the case of _",
    "( post - merger ) merger shocks have already moved outside the internal region of the cluster , and their strength is increased as the ambient temperature in cluster outskirts decreases .",
    "the volume averaged mach number of shocks in the four galaxy clusters is reported as a function of distance from cluster centers in fig.[fig : prof_clusters ] . within the virial radius shocks are weak in line with expectations from semi  analytical models that indeed found shocks with @xmath158 extremely rare in galaxy clusters ( gabici & blasi 2003 ) .",
    "this is also highlighted in fig.[fig : clust_distrib ] , where we show the distribution of the thermal flux dissipated at shocks with shock - mach number ; distributions in different clusters are reported normalized to the volume of the most massive cluster .",
    "all distributions are steep , with differences from cluster to cluster due to the effect of the dynamical state of the clusters . inside @xmath98",
    "_ c1 _ , _ c2 _ and _ c3 _ have similar distributions , while _",
    "c4 _ shows some excess of rare shocked cells with @xmath159 . on the other hand ,",
    "an excess of shocked cells with @xmath160 is found in the external regions of _",
    "c4_.    also in the case of clusters our distributions of the thermalised energy flux are steeper than those reported in other similar works : we find @xmath161 to @xmath162 , while @xmath163 to @xmath103 is obtained by pfrommer et al.(2007 ) , where the lagrangian sph code gadget2 was employed .",
    "the radial profile of the ratio @xmath139 in our clusters is reported in fig.[fig : prof_cr_clusters ] . here",
    "we show the results in the case of both the kj02 ( _ left _ panel ) and kj07 ( _ right _ panel ) models . inside the virial radius",
    "we do not find any relevant difference between our clusters .",
    "this is because , independently of the dynamical status of the clusters , the bulk of the energy is dissipated in the cr acceleration and in the thermal component at relatively weak shocks .",
    "the maximum value of @xmath139 is found at distance @xmath164 from the cluster center , @xmath165 and 0.3 using the kj02 and kj07 model , respectively .",
    "in this paper we have investigated the properties of shocks in cosmological numerical simulations .",
    "this subject is particularly intriguing as shock waves propagating trough lss are the responsible for the heating of the icm and may be important sources of cr in the universe .",
    "this subject has been already investigated in several papers under different numerical approaches ( miniati et al.2000 ; miniati et al.2001 ; keshet et al.2003 ; ryu et al.2003 ; pfrommer et al.2006 ; kang et al.2007 ; pfrommer et al.2007 ) .",
    "we study shock waves by means of a post processing procedure .",
    "although this is similar to ryu et al.(2003 ) and kang et al.(2007 ) , our approach differs from previous ones in several points .",
    "first we use a different numerical codes , the public version of enzo ( e.g. bryan & norman 1997 ) , to simulate lss ( sec.[sec : enzo ] ) .",
    "second we adopt a more appropriate treatment of the re - ionization in our simulations ( sec.[sec : reionization ] ) and third we use a different approach to catch shocks in our simulations and to measure their strength ( vj method , sect.[subsec : vj ] ) .",
    "we simulated a large cosmic volume , @xmath166 , with a fixed grid resolution of 125 kpc .",
    "additional simulations were designed and used to investigate the effect of spatial resolutions and of the @xmath7 parameter ( see appendix ) .    in the following",
    "we summarize the main results obtained :    * _ re - ionization _ : in sect.[subsec : reion ] we have shown that a correct treatment of the re - ionization is crucial to have a viable description of shocks with a post processing procedure . in particular using a constant temperature floor in the simulated data at a fixed redshift may cause a somewhat artificial flattening ( or pile up ) of the differential distribution of the shocks with mach number .",
    "this is because the velocity of the sound is artificially boosted up in low density and cold regions . to overcome this point",
    "we derive formulas giving the typical temperature of the gas as a function of the local density by fitting data obtained from simulations which include a specific modeling of the re - ionization in run  time .",
    "these formulas are found to be consistent with katz et al.(1996 ) and valageas et al.(2002 ) and can be used to model the temperature background of adiabatic simulations in a post processing procedure . in section 4",
    "( fig.[fig : madau - vs - post ] ) we have shown that our post processing procedure is indeed consistent with the results from simulations with run  time re - ionization . * _ methods to derive the mach number of shocks _ : in sect.[subsec : ryu0 ] and [ subsec : vj ] we have discussed in some detail two different methods to catch shocks in simulated data and to estimate their mach number .",
    "these methods are the temperature jump ( tj ) and the velocity jump ( vj ) and rely with the jumps in temperature and velocity across shocked cells , respectively . + the shock discontinuity is typically spread over a few cells and the risk in measuring the mach number of shocks trough cell - to - cell velocity or temperature jumps ( or jumps across a few cells ) is to underestimate the mach number of shocks . to study this point in the context of our numerical simulations we perform several shock  tube tests with enzo and calculate maps of shocks in our simulations under different approaches ( sect .",
    "we conclude that shocks in our simulations are best characterized from velocity ( vj ) or temperature ( tj ) jumps measured across three cells . + both the vj and tj schemes use ideal conditions across non shocked cells ( i.e. no velocity and no temperature gradients ) and this may cause major uncertainties in the characterization of the shocks in a post processing procedure ( sect.[subsec : tjun][subsec : vjun ] ) .",
    "this is because the velocity field and temperature distributions in the cosmological data sets are very complex and the passage of a shock establishes thermodynamical gradients which are superimposed to already existing ones .",
    "we discuss the strength of the uncertainties on the value of the mach number from the two schemes by means of monte carlo extractions of temperature and velocity variations across non shocked cells in our data sets , and show that the vj method may be more reliable , at least in the case of weak shocks and especially in low density environments ( figs.89 ) .",
    "+ besides these uncertainties we find that the two methods yield statistically similar mach number distributions of shocked cells in our simulations ( fig .  12 ) suggesting that the characterization of shocks in our simulations is fairly solid ; in sect.7 we adopt here the vj method . * _ morphology of ls shocks _ : in sect.[subsec : machs ] we discuss the morphology of the shock  patterns detected in our simulated data sets .",
    "about @xmath167 per cent of the cells in our simulations are found to host shocks at the present epoch , and this fraction slightly decreases with look back time for post  reionization epochs . in qualitative agreement with previous studies ( ryu et al .",
    "2003 ; pfrommer et al .",
    "2006 ) we find that these shocked cells form spectacular and complex patterns associated with the cosmic web .",
    "filamentary or sheet  like shocks are found outside the virial regions of clusters and around filaments , while more regular spherical structures surround galaxy clusters . * _ number distributions of ls shocks _ : we study the number distribution of shocked cells as a function of the mach number of the shocks . an important point here",
    "is that thanks to the eulerian scheme of the enzo code we were able to follow the hydrodynamics of the ls shocks also in very low density regions , whose exploration is challenging for present lagrangian schemes .",
    "+ we find that the bulk of cosmological shocks is essentially made by weak @xmath168 shocks and that the number distribution of shocks can be grossly described by a steep power law @xmath101 .",
    "when considering the mach number distribution of shocked cells in the total simulated volume we find an overall steep distribution @xmath169 which is dominated by the contribution from voids and filaments .",
    "this distribution steepens with increasing the cosmic over - density and becomes very steep ( @xmath170 to @xmath103 ) in the case of galaxy clusters demonstrating the increasing rarity of strong shocks in these denser ( and hotter ) regions , where basically @xmath171 . *",
    "_ energy dissipated at ls shocks _ : the energy dissipation at ls shocks is the main focus of the previous studies on this topic ( e.g. , miniati et al.2001 ; keshet et al.2003 ; ryu et al.2003 ; pfrommer et al .",
    "2006 ; kang et al.2007 ; pfrommer et al.2007 ) . following ryu et al.(2003 ) we calculate the energy rate dissipated in the form of thermal energy at shocks by means of hydrodynamical jump conditions ( eq.[eq : eq_delta ] ) . in agreement with these previous studies",
    "we find that about @xmath172 are dissipated at shocks in a @xmath173 volume in the simulations at the present epoch .",
    "the bulk of the energy in our simulations is dissipated in galaxy clusters which indeed contribute to about @xmath174 per cent of the total energy dissipation ( about @xmath175 per cent if we also include the contribute from cluster outskirts ) , while filaments contribute to a @xmath167 per cent of the total energy dissipation .",
    "we calculate the distribution of the energy flux dissipated at ls shocks with shock - mach number . when considering shocked cells in the total volume we find that the distribution is steep , @xmath176 ( @xmath128 ) and peaks at @xmath1 .",
    "although in qualitative agreement with previous studies , our distribution is steeper than that obtained by ryu et al.(2003 ) that also used cosmological simulations based on a eulerian scheme .",
    "this difference is mostly due to our more complex treatment of the re - ionization background and to the use of the vj scheme to measure the mach number of shocks .",
    "+ following ryu et al.(2003 ) we calculate the efficiency of the injection of cr at ls shocks according to kang & jones ( 2002 ) .",
    "we obtained mach number distributions of the energy flux dissipated into cr acceleration in our simulated data sets .",
    "our results are in line with previous findings , although our distributions are steeper than those in ryu et al .",
    "and slightly steeper than those in pfrommer et al.(2006 & 2007 ) .",
    "+ in agreement with pfrommer et al .",
    "we find that the bulk of the energy dissipated in the form of cr at shocks is shared between clusters and filaments so that cr ",
    "acceleration happens in regions broader than those where thermal energy is dissipated at shocks and the ratio between cr energy and thermal energy increases in lower density regions ( fig.[fig : flux1 ] ) .",
    "when considering all the shocked cells in our simulations we find that the ratio between the energy dissipated in the form of cr - acceleration and of thermal energy at present epoch is @xmath177 and this ratio becomes smaller in galaxy clusters .",
    "these fractions are a factor @xmath1252 smaller than those found by ryu et al . and",
    "this is likely due to the steeper distributions that we obtained in our analysis . *",
    "_ galaxy clusters _",
    ": in sect.[subsec : clusters ] we briefly discuss the case of shocks propagating in galaxy clusters .",
    "we find very steep distributions of the number of shocks and of the energy dissipated at shocks as a function of the shock - mach number .",
    "the typical mach number within the virial radius is @xmath178 , in nice agreement with semi  analytical studies which are indeed appropriate for virialised systems ( gabici & blasi 2003 ) . at larger distance from the cluster center stronger shocks",
    "are found and their presence is strongly correlated with the dynamical status of the clusters .",
    "remarkably the rarity of moderate ",
    "strong shocks in the cluster central regions ( within @xmath125 mpc distance from cluster center ) makes the ratio @xmath139 very small , expecially when the kang & jones ( 2007 ) model for the injection of cr at shocks is adopted ( fig .",
    "25 ) .",
    "the use of numerical simulations is mandatory to understand the properties of ls shocks and to investigate their role in the injection of cr in lss .",
    "although we use a different approach with respect to other studies , our findings for the energy dissipated in the form of cr at these shocks are grossly consistent with previous studies ( ryu et al . 2003 ; pfrommer et al .",
    "2006 ) .    however , the astrophysical problem is extremely complex and several _ hidden _ ingredients in the adopted procedures are potentially sources of large uncertainties . as discussed in sect.[subsec : cr ] the efficiency of cr acceleration at shocks is investigated following several approaches . in the present paper we have used the acceleration efficiency resulting from numerical calculations of modified shocks ( following ryu et al .",
    "2003 and references therein ) . on the other hand pfrommer et al.(2006 )",
    "use a linear theory with the efficiency modified to account for saturation effects at large values of the mach numbers ( actually to limit the cr efficiency at @xmath179 per cent ) .",
    "these two approaches are formally _ radically _ different , but nevertheless they provide an overall estimate of the cr injection efficiency which is not dramatically different in the case of typical shocks with @xmath180 .",
    "the main _ hidden _ ingredient in the efficiency of cr acceleration comes from the commonly adopted _",
    "thermal leakage injection _ scenario which essentially adopts as minimum momentum of the particles that take part in the acceleration process , @xmath135 , a multiple of the momentum of the thermal particles , @xmath181 .",
    "the choice of @xmath182 is a _ guess _ , since this depends on physical details which are still poorly known ( e.g. , blasi 2004 ) . in ryu et al.(2003 )",
    "( and thus in our paper ) the fraction of protons injected into the cr population at shocks is taken of the order of @xmath183 which is not far from ( even if larger than ) the resulting efficiency from the assumption of @xmath184 adopted in pfrommer et al.(2006 ) .",
    "although this parameter is somewhat constrained by the theory ( e.g. , malkov 1998 ) , it should be stressed that having a slightly different value of @xmath182 ( e.g. @xmath182=3.8 instead of 3.5 ) would have the net effect to reduce the acceleration efficiency by nearly one order of magnitude .",
    "theoretical arguments suggest that the bulk of cr in galaxy clusters should be in the form of supra  thermal protons ( e.g. blasi , gabici , brunetti 2007 for a recent review ) .",
    "gamma ray observations of a few nearby galaxy clusters limit the energy density of cr protons in these clusters to @xmath125 20 per cent of the thermal energy ( pfrommer & ensslin 2004 ; reimer 2004 ) . although a detailed comparison with these limits would require to follow the advection and accumulation process of cr in clusters during the simulations ( e.g. miniati 2003 ; pfrommer et al .",
    "2006 ) , the level of injection rate of cr that we found in clusters and cluster outskirts ( sect.[subsec : clusters ] ) allows us to reasonably conclude that our results are barely consistent with these limits .    on the other hand",
    "more stringent upper limits can be obtained from present radio observations .",
    "the bulk of galaxy clusters does not show evidence of extended mpc ",
    "scale synchrotron radio emission and this can be used to constrain the population of secondary electrons and thus that of the primary cr protons from which these secondaries would be injected ( brunetti et al .",
    "these limits are very stringent and actually represent a challenge for simulations : in the case that the icm is magnetized at @xmath185 g level ( consistent with rotation measures , e.g. govoni & feretti 2004 ) the energy of cr should be at @xmath186 few percent of the thermal energy ( when the spectrum of cr is fixed at that expected from simulations , i.e. @xmath187 , @xmath188 for @xmath189 ) .",
    "a comparison between our simulations and present limits clearly requires a more detailed study .",
    "however , a simple estimate of the spectral shape of cr injected in our simulations ( fig.[fig : elec_distrib ] ) suggests that the bulk of the cr energy in clusters and cluster outskirts is associated with cr populations with relatively steep spectra , in which case the limits from radio observations become less stringent ( brunetti et al .",
    "obviously , an alternative possibility to reconcile radio data and simulations would be that relatively flat components of cr store a non negligible fraction of the energy of the icm , and that the magnetic field strengths in the icm are much smaller than that claimed from the analysis of present rm data ; future gamma ray observations with the fermi gamma ray telescope and with cherenkov arrays will clarify this possibility .",
    "we thanks k. dolag , d. ryu , h. kang , g. tormen , l. moscardini , b.oshea , m.norman , r.wagner , d.collins , s. skory , s. giacintucci , r. brunino and a.bonadede for useful discussions and helps .",
    "we acknowledge partial support through grants asi - inaf i/088/06/0 and prin - inaf 2007 , and the usage of computational resources under the cineca - inaf agreement .    199    amato e. , blasi p. , 2006 ,",
    "mnras , 371 , 1251    bagla j.  s. , prasad j. , 2006 , mnras , 370 , 993    bagla j.  s. , ray s. , 2005 , mnras , 358 , 1076    belsole e. , pratt g.  w. , sauvageot j .-",
    ", bourdin h. , 2004 , a&a , 415 , 821    berezinsky v.  s. , blasi p. , ptuskin v.  s. , 1997 , apj , 487 , 529    berger m.  j. , colella p. , 1989 ,",
    "jcoph , 82 , 64    berrington r.  c. , dermer c.  d. , 2003 , apj , 594 , 709    blandford r.  d. , ostriker j.  p. , 1978",
    ", apj , 221 , l29    blasi p. , colafrancesco s. , 1999 , aph , 12 , 169    blasi p. , 2001",
    ", aph , 15 , 223    blasi p. , 2002 ,",
    "aph , 16 , 429    blasi p. , 2004",
    ", aph , 21 , 45    blasi p. , 2004 ,",
    "nuphs , 136 , 208    blasi p. , gabici s. , brunetti g. , 2007 , ijmpa , 22 , 681    borgani s. , et al . , 2004 , mnras , 348 , 1078    brunetti g. , setti g. , feretti l. , giovannini g. , 2001 , mnras , 320 , 365    brunetti g. , blasi p. , cassano r. , gabici s. , 2004 , mnras , 350 , 1174    brunetti g. , blasi p. , 2005 ,",
    "mnras , 363 , 1173    brunetti g. , venturi t. , dallacasa d. , cassano r. , dolag k. , giacintucci s. , setti g. , 2007 , apj , 670 , l5    brunetti g. , et al . , 2008 , natur , 455 , 944    bryan g.  l. , norman m.  l. , 1998 , apj , 495 , 80    bryan g.  l. , norman m.  l. , 1997 , aspc , 123 , 363    bryan g.  l. , abel t. , norman m.  l. , 2001 , astro , arxiv : astro - ph/0112089    cassano r. , brunetti g. , 2005 , mnras , 357 , 1313 cen r. , ostriker j.  p. , 1999 ,",
    "apj , 514 , 1    comparato m. , becciani u. , costa a. , larsson b. , garilli b. , gheller c. , taylor j. , 2007 , pasp , 119 , 898    dolag k. , enlin t.  a. , 2000 , a&a , 362 , 151    dolag k. , vazza f. , brunetti g. , tormen g. , 2005 , mnras , 364 , 753    dolag k. , meneghetti m. , moscardini l. , rasia e. , bonaldi a. , 2006 , mnras , 370 , 656    drury l.  o. , voelk j.  h. , 1981 , apj , 248 , 344    eisenstein d.  j. , hu w. , 1999 , apj , 511 , 5    ellison d.  c. , baring m.  g. , jones f.  c. , 1995 , apj , 453 , 873    ensslin t.  a. , biermann p.  l. , klein u. , kohle s. , 1998 , a&a , 332 , 395    enlin t.  a. , pfrommer c. , springel v. , jubelgas m. , 2007 , a&a , 473 , 41    evrard a.  e. , et al . , 2007 , astro , arxiv : astro - ph/0702241    fan x. , carilli c.  l. , keating b. , 2006 , ara&a , 44 , 415    feretti l. , 2005 , adspr , 36 , 729    gabici s. , blasi p. , 2003",
    ", apj , 583 , 695    gardini a. , rasia e. , mazzotta p. , tormen g. , de grandi s. , moscardini l. , 2004 , mnras , 351 , 505    gheller c. , pantano o. , moscardini l. , 1998 , mnras , 296 , 85    godunov , s. k. 1959 , mat .",
    "sbornik , 47 , 271    govoni f. , feretti l. , 2004 , ijmpd , 13 , 1549    hallman e.  j. , ryu d. , kang h. , jones t.  w. , 2003 , aas , 35 , 1348    haardt f. , madau p. , 1996",
    ", apj , 461 , 20    haiman z. , holder g.  p. , 2003",
    ", apj , 595 , 1    iapichino l. , niemeyer j.  c. , 2008 , mnras , 388 , 1089    kang h. , jones t.  w. , gieseler u.  d.  j. , 2002 , apj , 579 , 337    kang h. , jones t.  w. , 2002 , jkas , 35 , 159    kang h. , jones t.  w. , 2005 , apj , 620 , 44    kang h. , ryu d. , cen r. , ostriker j.  p. , 2007",
    ", apj , 669 , 729    katz n. , weinberg d.  h. , hernquist l. , 1996 , apjs , 105 , 19    keshet u. , waxman e. , loeb a. , springel v. , hernquist l. , 2003 , apj , 585 , 128    landau l.  d. , lifshitz e.  m. , 1966 , hydr.book ,    loeb a. , barkana r. , 2001 , ara&a , 39 , 19    loeb a. , waxman e. , 2000 , natur , 405 , 156    malkov m.  a. , 1997 , apj , 485 , 638    markevitch m. , sarazin c.  l. , vikhlinin a. , 1999 , apj , 521 , 526    markevitch m. , gonzalez a.  h. , david l. , vikhlinin a. , murray s. , forman w. , jones c. , tucker w. , 2002 , apj , 567 , l27    markevitch m. , vikhlinin a. , 2007 , phr , 443 , 1    mellema g. , iliev i.  t. , pen u .-",
    "l . , shapiro p.  r. , 2006 , mnras , 372 , 679    miniati f. , ryu d. , kang h. , jones t.  w. , cen r. , ostriker j.  p. , 2000",
    ", apj , 542 , 608    miniati f. , jones t.  w. , kang h. , ryu d. , 2001 , apj , 562 , 233    miniati f. , 2003 , mnras , 342 , 1009    norman m.  l. , bryan g.  l. , 1999 , lnp , 530 , 106    norman m.  l. , bryan g.  l. , harkness r. , bordner j. , reynolds d. , oshea b. , wagner r. , 2007 , arxiv , 705 , arxiv:0705.1556    oshea b.  w. , bryan g. , bordner j. , norman m.  l. , abel t. , harkness r. , kritsuk a. , 2004 , astro , arxiv : astro - ph/0403044    oshea b.  w. , nagamine k. , springel v. , hernquist l. , norman m.  l. , 2005 , apjs , 160 , 1    petrosian v. , 2001 , apj , 557 , 560    pfrommer c. , enlin t.  a. , 2004 , jkas , 37 , 455    pfrommer c. , springel v. , enlin t.  a. , jubelgas m. , 2006 , mnras , 367 , 113    pfrommer c. , enlin t.  a. , springel v. , jubelgas m. , dolag k. , 2007 , mnras , 378 , 385    pfrommer c. , 2008 , mnras , 385 , 1242    rasia e. , et al . , 2006 , mnras , 369 , 2013    regan j.  a. , haehnelt m.  g. , viel m. , 2007 , mnras , 374 , 196    reimer o. , 2004 , jkas , 37 , 307    ryu d. , kang h. , hallman e. , jones t.  w. , 2003 , apj , 593 , 599    sarazin c.  l. , 1999 , apj , 520 , 529    shen j. , abel t. , mo h.  j. , sheth r.  k. , 2006 , apj , 645 , 783    sheth r.  k. , tormen g. , 1999 , mnras , 308 , 119    skillman s.  w. , oshea b.  w. , hallman e.  j. , burns j.  o. , norman m.  l. , 2008 , arxiv , 806 , arxiv:0806.1522    spergel d.  n. , et al .",
    ", 2003 , apjs , 148 , 175    spergel d.  n. , et al . , 2007 , apjs , 170 , 377    springel v. , farrar g.  r. , 2007 , mnras , 380 , 911    stone j.  m. , norman m.  l. , 1992 , apj , 389 , 297    sunyaev r.  a. , norman m.  l. , bryan g.  l. , 2003 , astl , 29 , 783    takizawa m. , naito t. , 2000 , apj , 535 , 586    tasker e.  j. , brunino r. , mitchell n.  l. , michielsen d. , hopton s. , pearce f.  r. , bryan g.  l. , theuns t. , 2008 , mnras , 390 , 1267    tormen g. , moscardini l. , yoshida n. , 2004 , mnras , 350 , 1397    valageas p. , schaeffer r. , silk j. , 2002 , a&a , 388 , 741    vazza f. , tormen g. , cassano r. , brunetti g. , dolag k. , 2006 , mnras , 369 , l14    vlk h.  j. , aharonian f.  a. , breitschwerdt d. , 1996 , ssrv , 75 , 279    woodward p. , colella p. , 1984 ,",
    "jcoph , 54 , 115    * appendix *",
    "box at 4 different numerical resolutions ( i.e. @xmath26 , @xmath190 , @xmath191 and @xmath192).,scaledwidth=45.0% ]    we investigated the effect of resolution on the properties of detected shocks by re  simulating the same initial conditions and cosmic volume of the @xmath26 simulations at resolutions of @xmath193 , @xmath194 and @xmath195 .    even if most of the graphs and statistics presented in the paper are done by using @xmath55 for the shock detecting scheme ( see sec.5.3 ) and thus assuming that the best reconstruction of the shock discontinuity is achieved by considering a jump of 2 cells between pre - shock and post - shock , here we prefer to keep this jump smaller ( i.e. @xmath89 ) .",
    "this is in order minimize any confusion coming from the fact that in poorly resolved runs shocks have sizes of typical cluster halos ( i.e. for @xmath55 in the @xmath192 one would reconstruct shocks across @xmath196 ) .",
    "this is fair enough to reconstruct the trend with resolution within our simulations , and the comparison to the @xmath55 case can be recovered in fig.14 .",
    "first we find that at all these resolutions eq .",
    "[ eq : fit2 ] provides a good fit to the density  temperature distributions obtained with run time re  ionization and thus we use this relation to model the re - ionization in our post processing approach at all these resolutions .",
    "we then analyze the outputs at @xmath12 and derive statistical properties of shocks in the simulated volumes , following the procedures given in the previous sections .",
    "the number distributions of shocked cells as a function of their mach number are given in fig .",
    "[ fig : mach_no_res ] for the different resolutions .",
    "we find that the results converge at higher resolutions , in particular the shape of the distribution and integral number of shocked cells obtained with @xmath25 and with @xmath195 resolution are consistent within @xmath197 percent .",
    "a relevant point here is that the excess of shocks with high mach number found at low resolution is progressively reduced with increasing resolution .",
    "the case of the energy flux dissipated at shocks is reported in figures [ fig : flux_dist_res ] .",
    "this case is somewhat more problematic as it depends on the combination of the properties of shocks with the local baryon over - density . despite the properties of shocks",
    "statistically converge with resolution , the over - density in the simulated volume increases with resolution and this causes the increase of the dissipated energy in the data simulated at higher resolutions .",
    "anyhow also in this case some level of convergence is obtained in line with previous studies ( ryu et al .",
    "2003 ; pfrommer et al .",
    "the most problematic case is that of galaxy clusters were indeed the dissipation of the energy at shocks increases by one order of magnitude between lower and higher resolution data sets ( this still increases by @xmath3 times between the @xmath198 and @xmath199 kpc data sets ) .    despite this slow convergence with resolution",
    ", the value of the ratio @xmath139 is found to not significantly change with resolution since the resolution affects the two quantities in a similar way .",
    "the value of the @xmath7 parameter ( the normalization in the power spectrum of primordial over - density fluctuations ) crucially affects the abundance of collapsed objects in the universe at a given epoch .",
    "this value is presently not fully constrained : very recent cmb analysis give a relatively small value , @xmath200 ( spergel et al.2007 ) , with respect to that derived from previous cmb data  analysis ( spergel et al.2003 ) and to the constraints from the observed abundance of galaxy clusters ( e.g. evrard et al.2007 ) . in this appendix",
    "we briefly discuss the effect of the @xmath7 parameter on the statistical properties of the shocks as measured in our simulated data - sets ( adopting as in the previous section @xmath89 for the reconstruction of shocks ) .",
    "we thus re simulated the _",
    "co250 _ run with @xmath201 ( _ s8250 _ ) and applied all the procedures discussed in the previous sections to derive the properties of the shocks ( note that the co250 and s8250 simulations have run  time re - ionization ) .",
    "theoretically the population of shocks in a universe with larger @xmath7 is expected to evolve faster as more power is associated with the primordial over - density fluctuations .",
    "thus , at a fixed redshift , universes with larger @xmath7 host more evolved structures , which are characterized by typically higher internal sound speeds at higher densities , and low temperatures in low density regions .",
    "the distribution of thermalised energy at shocks in the two simulations is given in fig.b1 .",
    "although clearly modifying the value of @xmath7 has some effect on the properties of the shocks in the simulations , the net result is that , within the presently allowed region of the values of the @xmath7 parameter , no strong difference in the properties of the shocks is found in simulations with different @xmath7 . indeed",
    ", globally we find that the energy dissipated at the present time in the _ s8250 _",
    "simulation is @xmath202 times smaller than that in the _ co250 _ simulation , and the distribution with mach number of the dissipated energy in under - dense regions is found to become somewhat slightly flatter with decreasing @xmath7 ."
  ],
  "abstract_text": [
    "<S> large scale shocks are responsible for the heating of the icm and can be important sources of cosmic rays ( cr ) in the universe . </S>",
    "<S> however the occurrence and properties of these shocks are still poorly constrained from both a theoretical and an observational side .    in this work </S>",
    "<S> we analyze the properties of large scale shocks in a @xmath0 cosmological volume simulated with the public 1.0.1 release of the enzo code . </S>",
    "<S> different methods to identify and characterize shocks in post processing are discussed together with their uncertainties . </S>",
    "<S> re - ionization affects the properties of shocks in simulations , and we propose a fitting procedure to model accurately the effect of re - ionization in non  radiative simulations , with a post  processing procedure . </S>",
    "<S> we investigate the properties of shocks in our simulations by means of a procedure which uses jumps in the velocity variables across the cells in the simulations and this allows us to have a viable description of shocks also in relatively under - dense cosmic regions . </S>",
    "<S> in particular we derive the distributions of the number of shocks and of the energy dissipated at these shocks as a function of their mach number , and discuss the evolution of these distributions with cosmological time and across different cosmic environments ( clusters , outskirts , filaments , voids ) .    in line with previous numerical studies ( e.g. ryu et al.2003 , pfrommer et al.2006 ) </S>",
    "<S> relatively weak shocks are found to dominate the process of energy dissipation in the simulated cosmic volume , although we find a larger ratio between weak and strong shocks with respect to previous studies . </S>",
    "<S> the bulk of energy is dissipated at shocks with mach number @xmath1 and the fraction of strong shocks decreases with increasing the density of the cosmic environments , in agreement with semi - analytical studies in the case of galaxy clusters .    </S>",
    "<S> we estimate the rate of injection of cr at large scale shocks by adopting injection efficiencies taken from previous numerical calculations . the bulk of the energy is dissipated in galaxy clusters and in filaments and the flux dissipated in the form of cr within the whole simulated volume at the present epoch </S>",
    "<S> is @xmath2 of the thermal energy dissipated at shocks ; this fraction is smaller within galaxy clusters .    </S>",
    "<S> finally we discuss the properties of shocks in galaxy clusters in relation with their dynamical state . in these regions the bulk of the energy is dissipated at weak shocks , with mach number @xmath3 , although slightly stronger shocks are found in the external regions of merging clusters .    </S>",
    "<S> [ firstpage ]    galaxy : clusters , general  methods : numerical  intergalactic medium  large - scale structure of universe    0.4 cm </S>"
  ]
}