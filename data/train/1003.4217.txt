{
  "article_text": [
    "a large of neurons is involved in any computation , and the presence of non - trivial correlations makes understanding the mechanisms of computation in brain a difficult challenge @xcite . the simplest model for describing multi - neuron spike statistics is the pairwise ising model @xcite .",
    "the inference of the couplings of an ising model from data , the _ inverse ising problem _ , has recently attracted attention , see @xcite where data from a simulated cortical network were considered ; the general idea is to find an ising model with the same means and pairwise correlations as the data .",
    "several approximate methods can be used , like that by sessak and monasson @xcite or the inversion of tap equations @xcite : equal - time correlations from data are used in those methods @xcite .",
    "the flow of information between spins is related , instead , to correlations at different times between variables : it can be expected that measuring the information flow between spins one may improve the estimate of couplings from data .",
    "two major approaches are commonly used to estimate the information flow between variables , transfer entropy @xcite and granger causality @xcite .",
    "recently it has been shown that for gaussian variables granger causality and transfer entropy are entirely equivalent as the following relation holds : _ granger causality = 2 transfer entropy_. this result provides a bridge between autoregressive and information - theoretic approaches to causal inference from data @xcite .    the purpose of this work is to explore the use of granger causality to learn ising models from data .",
    "the _ inverse ising problem _ is here seen as belonging to the more general frame of the inference of dynamical networks from data , a topic which has been studied in recent papers @xcite : its relevance is due to the fact that dynamical networks @xcite model physical and biological behavior in many applications @xcite .",
    "we show that for weak couplings , the linear granger causality of each link is two times the corresponding transfer entropy , also for ising models : this occurrence justifies the use of autoregressive approaches to the inverse ising problem . in the same limit , for each link , the following relation exists between the coupling ( @xmath1 ) and the causality ( @xmath2 ) : @xmath3 . in the case of limited samples ,",
    "granger causality gives poor results : almost all the connections are not assessed as significative for low number of samples . in these cases ,",
    "we propose the use of @xmath0 least squares method @xcite , a penalized autoregressive approach tailored to embody the sparsity assumption , to recover the non -vanishing connections of a sparse ising model ; as expected the @xmath0 approach outperforms granger causality in this case .",
    "finally we show that nonlinear granger causality is related to multi - spin interactions .",
    "the paper is organized as follows . in the next section",
    "we briefly recall the notions of granger causality and transfer entropy , and we also describe the ising models that we use for simulations . in section iii",
    "we describe our results on fully connected models , sparse ising models and models with higher order spin interactions .",
    "some conclusions are drawn in section iv .",
    "in this section we review the notions of granger causality analysis and transfer entropy .",
    "we also discuss the application of these methods to binary time series arising from ising models .",
    "granger causality has become the method of choice to determine whether and how two time series exert causal influences on each other @xcite .",
    "it is based on prediction : if the prediction error of the first time series is reduced by including measurements from the second one in the linear regression model , then the second time series is said to have a causal influence on the first one @xcite .",
    "the estimation of linear granger causality from fourier and wavelet transforms of time series data has been recently addressed @xcite .",
    "the nonlinear generalization of granger causality has been developed by a kernel algorithm which embeds data into a hilbert space , and searches for linear granger causality in that space @xcite ; the embedding is performed implicitly , by specifying the inner product between pairs of points @xcite , and a statistical procedure is used to avoid over - fitting .",
    "quantitatively , let us consider @xmath4 time series @xmath5 @xcite ; the lagged state vectors are denoted @xmath6 @xmath7 being the window length .",
    "let @xmath8 be the mean squared error prediction of @xmath9 on the basis of all the vectors @xmath10 ( corresponding to the kernel approach described in @xcite ) : @xmath11 is equal to @xmath12 , where @xmath13 , the predicted values of @xmath9 using @xmath10 , is the projection of @xmath9 on a suitable space @xmath14 .",
    "the prediction of @xmath9 on the basis of all the variables but @xmath15 , @xmath16 , corresponds instead to the projection on a space @xmath17 with @xmath18 .",
    "@xmath19 represents the information that one gains from the knowledge of @xmath15 .",
    "the multivariate granger causality index @xmath20 is defined as the ( normalized ) variation of the error in the two conditions , i.e. @xmath21 note that the numerator , in the equation above , coincides with the projection of @xmath9 on @xmath19 : as described in @xcite , one may write @xmath22 where @xmath23 are suitable pearson s correlations . by summing , in equation ( [ somma ] ) , only over significative correlations ,",
    "a _ filtered _ linear granger causality index is obtained which measures the causality without further statistical test .    in @xcite it has been shown that not all the kernels are suitable to estimate causality .",
    "two important classes of kernels which can be used to construct nonlinear causality measures are the _ inhomogeneous polynomial kernel _ ( whose features are all the monomials , in the input variables , up to the @xmath24 degree ; @xmath25 corresponds to linear granger causality ) and the _ gaussian kernel_. note that in @xcite a different index of causality is adopted : @xmath26};\\ ] ] @xmath27 and @xmath2 coincide at small @xmath2 .",
    "the choice of the window length @xmath7 is usually done using the standard cross - validation scheme @xcite ; as in this work we know how data are generated , here we use @xmath28 .",
    "the formalism of granger causality is constructed under the hypothesis that time series assume continuous values @xmath29 . in recent papers",
    "the application of granger causality to data in the form of phases has been considered @xcite .",
    "even though there is not theoretical justification in the case of binary variables , here we apply the formalism of granger casuality to @xmath4 binary time series @xmath30 , by substituting @xmath31 and @xmath32 in this work we justify the application of granger causality to binary time series in terms of its relation with transfer entropy .      using the same notation as in the previous subsection , the transfer entropy index @xmath33 is given by @xcite @xmath34 and measures the flow of information from @xmath35 to @xmath36 . for gaussian variables",
    "it has been shown @xcite that causality is determined by the transfer entropy and @xmath37 ; hence @xmath38 for gaussian variables .",
    "the probabilities @xmath39 s , in ( [ tau ] ) , must be estimated from data using techniques of nonlinear time series analysis @xcite . in the case of binary variables @xmath40 , the number of configurations is finite and the integrals in ( [ tau ] ) become sums over configurations ; the probabilities can be estimated as frequencies in the data - set at hand .",
    "therefore @xmath41 where @xmath42 is the fraction of times that the configuration @xmath43 is observed in the data set , and similar definitions hold for the other probabilities .",
    "we remark that the number of configurations increases exponentially as the number of spins grows , hence the direct evaluation of ( [ te ] ) is feasible only for systems of small size .",
    "the binary time series analyzed in this work are generated by parallel updating of ising variables @xmath44 : @xmath45 where the local fields are given by @xmath46 with couplings @xmath47 .",
    "starting from a random initial configuration of the spin , equations ( [ update ] ) are iterated and , after discarding the initial transient regime , @xmath48 consecutive samples of the system are stored for further analysis .",
    "in order to generalize granger causality to discrete variables , we consider the regression function of ( [ update ] ) . for weak couplings the conditional expectation ( which coincides with the regression function @xcite ) can be written @xmath49 and is a linear function of the couplings .",
    "therefore the linear causality is @xmath50 at the lowest order in @xmath1 s .",
    "analogously , expanding eq.([te ] ) at the lowest order , the transfer entropy reads @xmath51 .",
    "this means that , for low couplings , the value of @xmath1 , for any given link , determines both the transfer entropy and the linear granger causality for that link , and the two quantities differ only by the factor @xmath52 .",
    "the same relation , proved in the gaussian case , holds also for ising models at weak couplings .",
    "being related to the transfer entropy , granger causality thus measures the information flow for these systems , and this justifies the use of granger causality methods for ising systems .",
    "synaptic couplings are directed , so @xmath47 is not in general equal to @xmath53 ( the equilibrium ising model requires symmetric couplings @xcite ) .",
    "therefore we consider an asymmetric system of spins with couplings @xmath47 chosen at random from a normal distribution with zero mean and standard deviation @xmath54 ; no self interactions are assumed ( @xmath55 ) . in figure ( [ f1 ] )",
    "we report the plot of the numerical estimates of linear causality and transfer entropy , as a function of @xmath1 , for several realizations of the couplings and for some values of @xmath54 ; the simulations confirm that for low couplings a one - one correspondence exists between causality and transfer entropy .    in figure ( [ f2 ] )",
    "we depict , as a function of the coupling @xmath1 , both the linear causality and the transfer entropy in a typical asymmetric model of six spins with @xmath56 and @xmath57 samples , and @xmath58 . in figure ( [ f3 ] )",
    "we depict , as a function of the number of samples @xmath48 , the difference between the values of transfer entropy and causality ( as estimated on @xmath59 samples ) and their estimates based on @xmath48 samples ( the difference is averaged over 1000 runs of the ising system ) : at low @xmath48 the estimates of causalities are more reliable than those of transfer entropy .",
    "moreover , the computational complexity of the estimation of transfer entropy is much higher than those corresponding to the evaluation of granger causality .",
    "another interesting situation is all the couplings being equal to a positive quantity @xmath1 ( still , without self - interactions ) . in figure ( [ f4 ] )",
    "we depict the granger causality and the transfer entropy as a function of @xmath1 ( these quantities are the same for all the links , due to symmetry ) . for small values of @xmath1",
    "both quantities coincide with the values that correspond to @xmath1 in the asymmetric model , and the relation @xmath60 holds . on the other hand ,",
    "as @xmath1 increases , this relation is more and more violated .",
    "the departure of the ratio @xmath61 from 2 is connected to the emergence of feedback effects in the system , see e.g. the dependency , on @xmath1 , of the auto - correlation time of the magnetization @xmath62 in fig.([f5 ] ) .      in many applications one may hypothesize that the connections among variables are sparse .",
    "the main goal , in those cases , is to infer the couplings which are not vanishing , independently of their strengths , in particular when the number of samples is low .",
    "moreover , in the case of limited data , granger causality gives poor results ; indeed almost all connections would not be assessed as significative ( for a given amount a data , only couplings stronger than a critical value can be recognized by granger causality @xcite ) .",
    "a major approach to sparse signal reconstruction is the @xmath0 regularized least squares method @xcite .",
    "although it has been developed to handle continuous variables , we will apply this method to the configurations of ising models . for each target",
    "spin @xmath63 , the vector of couplings @xmath64 , with @xmath65 , is sought for as the minimizer of @xmath66 where @xmath67 is a regularization parameter and @xmath68 is the @xmath0 norm of the vector of couplings .",
    "as @xmath69 is increased , the number of vanishing couplings in the minimizers increases : @xmath69 controls the sparsity of the solution @xcite .",
    "the strategy to fix the value of @xmath69 we use here is 10-fold cross - validation @xcite : the original sample is randomly partitioned into 10 subsamples and , out of the 10 subsamples , a single subsample is retained as the validation data .",
    "the remaining 9 subsamples are used in ( [ elleuno ] ) to determine the couplings @xmath70 ; the quality of this solution is evaluated as the average number of errors on the validation data .",
    "the cross - validation process is then repeated 10 times ( the folds ) , with each of the 10 subsamples used exactly once as the validation data , and the error on the validation data is averaged over the 10 folds .",
    "the whole procedure is then repeated as @xmath69 is varied .",
    "the optimal value of @xmath69 is chosen as the one leading to the smallest average error on the validation data .",
    "as an example , we simulate a system made of 30 spins constituted by ten modules of three spins each . the non - vanishing couplings of the ising model are given by :    @xmath71    for @xmath72 . after evaluating the couplings @xmath73 , using the algorithm described in @xcite",
    ", we calculate the sensitivity ( fraction of non - vanishing connections @xmath1 leading to non - vanishing couplings @xmath70 ) and the specificity ( fraction of vanishing connections @xmath1 leading to vanishing couplings @xmath70 ) as a function of @xmath69 . the roc curves ( as @xmath69 is varied , the roc curve is sensitivity as a function of 1-specificity @xcite ) we obtain , in correspondence to three values of the number of samples n ( 100 , 250 and 500 ) , are depicted in fig .",
    "( [ f6 ] ) .",
    "the stars on the curves represent the points corresponding to the value of @xmath69 found by ten - fold cross validation ; these points correspond to a good compromise between specificity and sensitivity .",
    "the empty symbols , instead , represent the values of sensitivity and specificity obtained using granger causality in the three cases ; the specificity by granger causality is nearly one in all cases , while the sensitivity is strongly dependent on the number of samples and goes to zero as @xmath48 decreases . to conclude this subsection ,",
    "we have shown that in the case of low number of samples and sparse connections the @xmath0 regularized least squares method can be used to infer the connections in ising models and outperforms granger causality in these situations .",
    "we remark that direct evaluation of the transfer entropy in these cases is unfeasible .",
    "the case of higher order spin interactions requires use of nonlinear granger causality : in the presence of @xmath74spins interactions , the kernel approach @xcite with the polynomial kernel of at least @xmath75 degree is needed . as an example",
    ", we consider a system of three spins with local fields given by : @xmath76 in figure ( [ f7 ] ) we depict the causalities @xmath77 and @xmath78 , as a function of @xmath1 , using the linear kernel and for the approach with the @xmath79 polynomial kernel .",
    "note that , due to symmetry , @xmath80 and @xmath81 ; all the other causalities are vanishing . the linear approach is not able to detect the three spins interaction , while using the nonlinear approach the interaction is correctly inferred .",
    "we stress that the presence of multispin interactions is connected to the presence of synergetic variables , see @xcite for a discussion about the notions of redundancy and synergy in the frame of causality .",
    "it is interesting to show the performance by transfer entropy on the same problem , see fig.([f8 ] ) : it correctly detects all the interactions , and the value of the transfer entropy is again very close to be half of those from nonlinear granger causality .",
    "we stress that transfer entropy can be applied without prior assumptions about the order of the spins interactions .",
    "a major problem in the inference of dynamical networks is the selection of an appropriate model ; in the case of transfer entropy this issue does not arise , although this advantage may be offset by problems associated with reliable estimation of entropies in sample .",
    "we have proposed the use of autoregressive methods to learn ising models from data .",
    "commonly , the formulation of the inverse ising problem assumes symmetric interactions and is solved by exploiting the relations that exist , at equilibrium , between the pairwise correlations ( at equal times ) and the matrix of couplings . in the general case of asymmetric couplings , no equilibrium is reached and also time delayed correlations among spins should be used to infer the connections .",
    "we have shown that autoregressive approaches can solve the inverse ising problem for weak couplings : for each link @xmath82 , whilst the sign of @xmath1 coincides with the sign of the linear correlation between @xmath63 and @xmath83 .",
    "for weak couplings , granger causality is proportional to the transfer entropy and requires less samples , than transfer entropy , to provide a reliable estimate of the information flow . for sparse connections and low number of samples ,",
    "the @xmath0 regularized least squares method is preferable to granger causality ; nonlinear granger causality is related to multispin interactions .",
    "99 f. rieke , d. warland , r.r .",
    "de ruyter van steveninck , and w. bialek , _ spikes : exploring the neural code _",
    "( mit press , cambrige , ma , 1997 ) .",
    "e. schneidman , m.j .",
    "berry , r. segev , w. bialek , nature * 440 * , 1007 ( 2006 ) .",
    "j. shlens , g.d .",
    "field , j.l .",
    "gauthier , m.i .",
    "grivich , d. petrusca , a. sher , a.m. litke , e.j .",
    "chichilnisky , j. neurosci .",
    "* 28 * 505 ( 2008 ) .",
    "y. roudi , j. tyrcha , j. hertz , physical review e * 79 * , 051915 ( 2009 ) .",
    "v. sessak and r. monasson , j. phys .",
    "a * 42 * , 055001 ( 2009 )",
    "kappen and f.b .",
    "rodriguez , neural computation * 10 * , 1137 ( 1998 ) .",
    "y. roudi , e. aurell and j.a .",
    "hertz , front .",
    ". neurosci . * 3 * , 22 ( 2009 ) .",
    "t. schreiber , phys .",
    "lett . * 85 * , 461 ( 2000 ) c.w.j .",
    "granger , econometrica * 37 * , 424 ( 1969 ) .",
    "l. barnett , a.b .",
    "barrett , and a.k .",
    "seth , phys .",
    "* 103 * , 238701 ( 2009 ) .",
    "d. yu , m. righero , l. kocarev , phys.rev.lett . * 97 * , 188701 ( 2006 ) .",
    "d. napoletani , t. sauer , phys . rev . * e 77 * , 26103 ( 2008 ) . d. marinazzo , m. pellicoro and s. stramaglia , phys . rev .",
    "e * 77 * , 056215 ( 2008 ) .",
    "d. materassi , g. innocenti , physica a * 388 * , 3866 ( 2009 ) .",
    "barabasi , _ linked : the new science of networks_. ( perseus publishing , cambridge mass . , 2002 ) .",
    "s. boccaletti , v. latora , y. moreno , m. chavez and d .- u .",
    "hwang , phys .",
    "rep . * 424 * , 175 ( 2006 ) .",
    "r. tibshirani , j. roy .",
    "* b 58 * , 267 ( 1996 ) . k. hlavackova - schindler , m. palus , m. vejmelka , j. bhattacharya , physics reports * 441 * , 1 ( 2007 ) . y. chen , g. rangarajan , j. feng , and m. ding , phys . lett . * a 324 * , 26 ( 2004 ) . m. dhamala , g. rangarajan , m. ding , phys.rev.lett . * 100 * , 18701 ( 2008 ) .",
    "d. marinazzo , m. pellicoro , s. stramaglia , phys .",
    "lett . * 100 * , 144103 ( 2008 ) .",
    "j. shawe - taylor and n. cristianini , _ kernel methods for pattern analysis_. ( cambridge university press , london , 2004 ) . after a linear transformation",
    ", we may assume all the time series to have zero mean and unit variance .",
    "m. stone , j. roy .",
    "* b 36 * , 111 ( 1974 ) .",
    "n. ancona and s. stramaglia , neural comput . * 18 * , 749 ( 2006 ) .",
    "l. angelini , m. pellicoro and s. stramaglia , phys . lett . * a 373 * , 2467 ( 2009 ) .",
    "d. smirnov and b. bezruchko , phys .",
    "e 79 * , 046204 ( 2009 ) h. kantz , t. schreiber , _ nonlinear time series analysis _",
    "( cambridge university press , cambridge , 1997 ) .",
    "kadanoff , _ statistical physics _ ( world scientific , singapore , 2000 ) .",
    "a. papoulis , _ probability , random variables and stochastic processes mcgraw hill , new york , 1965_. s.j .",
    "kim , k. koh , m. lustig , s. boyd , d. gorinevsky , ieee j. sel .",
    "top . in sig",
    ". process .",
    "* 1 * , 606 ( 2007 ) .",
    "m.h . zweig and g. campbell ,",
    "clin . chem .",
    "* 39 * , 561 ( 1993 )",
    ". l. angelini et al . , phys .",
    "e 81 * , 037201 ( 2010 ) .    .",
    "the points , corresponding to 15 realizations of the couplings of six - spins ising systems with @xmath54 ranging in @xmath84 $ ] , are displayed ( the two quantities are estimated over samples of @xmath85 length ) .",
    "the curves are the quadratic expansions at weak coupling : @xmath86 ( dashed - dotted line ) and @xmath87 ( continuous line ) .",
    "( bottom ) the same points are displayed in the @xmath88 plane , showing that @xmath89 at weak coupling .",
    "[ f1],width=377 ]    , the linear granger causality ( right ) and the transfer entropy ( left ) are depicted for each link , as a function of its coupling @xmath1 , for @xmath90 ( top ) , @xmath91 ( middle ) and @xmath57 ( bottom ) samples .",
    "the continuous curves represent the _ true _ values ( obtained by fitting the points in fig .",
    "1).[f2],width=377 ]     the true value of the transfer entropy and @xmath92 its estimate based on @xmath48 samples , averaged over 1000 runs of the ising system , we define @xmath93 .",
    "the quantity e , thus obtained , is here plotted versus n ( empty circles ) .",
    "a similar quantity e , concerning granger causality , is also plotted ( stars).[f3],width=377 ]     and uniform couplings @xmath94 , is considered . as a function of @xmath1 , the linear granger causality",
    "( stars ) and the transfer entropy ( empty circles ) are depicted versus @xmath1 .",
    "both quantities are the same for all links , due to symmetry .",
    "the two curves are the relations between the coupling and transfer entropy ( and between coupling and causality ) which hold for the asymmetric ising model ( obtained by fitting the points of fig .",
    "1 ) . [ f4],width=377 ]      , 100 ( dashed line ) , 250 ( dotted line ) and 500 ( continuous line ) .",
    "the stars on these curves represent the points found by ten - fold cross validation .",
    "the other three symbols are the performances by granger causality on @xmath90 ( empty diamond ) , @xmath95 ( empty circle ) , @xmath96 ( empty square ) .",
    "[ f6],width=377 ]     and @xmath97 are depicted as a function of @xmath1 for the three spins system described in the text .",
    "causalities are estimated using the linear kernel ( top ) and the @xmath79 polynomial kernel ( bottom ) .",
    "[ f7],width=377 ]"
  ],
  "abstract_text": [
    "<S> the inference of the couplings of an ising model with given means and correlations is called _ inverse ising problem_. this approach has received a lot of attention as a tool to analyze neural data . we show that autoregressive methods may be used to learn the couplings of an ising model , also in the case of asymmetric connections and for multi - spin interactions . </S>",
    "<S> we find that , for each link , the linear granger causality is two times the corresponding transfer entropy ( i.e. the information flow on that link ) in the weak coupling limit . for sparse connections and a low number of samples , </S>",
    "<S> the @xmath0 regularized least squares method is used to detect the interacting pairs of spins . </S>",
    "<S> nonlinear granger causality is related to multispin interactions . </S>"
  ]
}