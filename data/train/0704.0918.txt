{
  "article_text": [
    "a bayesian network or directed graphical model is a statistical model that uses a directed acyclic graph ( dag ) to represent the conditional independence structures between collections of random variables .",
    "the word bayesian is used to describe these models because the nodes in the graph can be used to represent random variables that correspond to parameters or hyperparameters , though the basic models themselves are not a priori bayesian .",
    "these models are used throughout computational statistics to model complex interactions between collections of random variables .",
    "for instance , tree models are used in computational biology for sequence alignment @xcite and in phylogenetics @xcite .",
    "special cases of bayesian networks include familiar models from statistics like factor analysis @xcite and the hidden markov model @xcite .",
    "the dag that specifies the bayesian network specifies the model in two ways .",
    "the first is through a recursive factorization of the parametrization , via restricted conditional distributions .",
    "the second method is via the conditional independence statements implied by the graph .",
    "the recursive factorization theorem ( * ? ? ?",
    "* thm 3.27 ) says that these two methods for specifying a bayesian network yield the same family of probability density functions .",
    "when the underlying random variables are gaussian or discrete , conditional independence statements can be interpreted as algebraic constraints on the parameter space of the global model . in the gaussian case , this means that conditional independence corresponds to algebraic constraints on the cone of positive definite matrices .",
    "one of our main goals in this paper is to explore the recursive factorization theorem using algebraic techniques in the case of gaussian random variables , with a view towards the case of hidden random variables . in this sense ,",
    "the current paper is a generalization of the work began in @xcite which concerned the special case of factor analysis .",
    "some past work has been done on the algebraic geometry of bayesian networks in the discrete case in @xcite , but there are many open questions that remain in both the gaussian and the discrete case .    in the next section ,",
    "we describe a combinatorial parametrization of a bayesian network in the gaussian case . in statistics , this parametrization in known as the _ trek rule _ @xcite .",
    "we also describe the algebraic interpretation of conditional independence in the gaussian case which leads us to our main problem : comparing the vanishing ideal of the model @xmath0 to the conditional independence ideal @xmath1 .",
    "section [ sec : comp ] describes the results of computations regarding the ideals of bayesian networks , and some algebraic conjectures that these computations suggest .",
    "in particular , we conjecture that the coordinate ring of a bayesian network is always normal and cohen - macaulay .    as a first application of our algebraic perspective on gaussian bayesian networks , we provide a new and greatly simplified proof of the tetrad representation theorem ( * ? ? ?",
    "* thm 6.10 ) in section [ sec : tetrad ] .",
    "then in section [ sec : tree ] we provide an extensive study of trees in the fully observed case .",
    "in particular , we prove that for any tree @xmath2 , the ideal @xmath3 is a toric ideal generated by linear forms and quadrics that correspond to conditional independence statements implied by @xmath2 .",
    "techniques from polyhedral geometry are used to show that @xmath4/i_t$ ] is always normal and cohen - macaulay .",
    "sections [ sec : hidtree ] and [ sec : alggeom ] are concerned with the study of hidden variable models . in section [ sec : hidtree ] we prove the upstream variables theorem ( theorem [ thm : upstream ] ) which shows that @xmath0 is homogeneous with respect to a two dimensional multigrading induced by upstream random variables . as a corollary ,",
    "we deduce that hidden tree models are generated by tetrad constraints . finally in section [ sec : alggeom ] we show that models with hidden variables include , as special cases , a number of classical constructions from algebraic geometry .",
    "these include toric degenerations of the grassmannian , matrix schubert varieties , and secant varieties .",
    "i would like to thank mathias drton , thomas richardson , mike stillman , and bernd sturmfels for helpful comments and discussions about the results in this paper .",
    "the i m a provided funding and computer equipment while i worked on parts of this project .",
    "let @xmath5 be a directed acyclic graph ( dag ) with vertex set @xmath6 and edge set @xmath7 .",
    "often , we will assume that @xmath8 : = \\{1,2 , \\ldots , n \\}$ ] . to guarantee the acyclic assumption ,",
    "we assume that the vertices are _ numerically ordered _ ; that is , @xmath9 only if @xmath10 . the bayesian network associated to this graph can be specified by either a recursive factorization formula or by conditional independence statements .",
    "we focus first on the recursive factorization representation , and use it to derive an algebraic description of the parametrization .",
    "then we introduce the conditional independence constraints that vanish on the model and the ideal that these constraints generate .",
    "let @xmath11 be a random vector , and let @xmath12 denote the probability density function of this random vector .",
    "bayes theorem says that this joint density can be factorized as a product @xmath13 where @xmath14 denotes the conditional density of @xmath15 given @xmath16 .",
    "the recursive factorization property of the graphical model is that each of the conditional densities @xmath14 only depends on the parents @xmath17 \\,\\ , |\\ , \\ , j \\to i \\in e(g ) \\}$ ] .",
    "we can rewrite this representation as @xmath18 thus , a density function @xmath19 belongs to the bayesian network if it factorizes as @xmath20    to explore the consequences of this parametrization in the gaussian case , we first need to recall some basic facts about gaussian random variables .",
    "each @xmath21-dimensional gaussian random variable @xmath22 is completely specified by its mean vector @xmath23 and its positive definite covariance matrix @xmath24 .",
    "given these data , the joint density function of @xmath22 is given by @xmath25 where @xmath26 is the determinant of @xmath24 .",
    "rather than writing out the density every time , the shorthand @xmath27 is used to indicate that @xmath22 is a gaussian random variable with mean @xmath23 and covariance matrix @xmath24 .",
    "the multivariate gaussian generalizes the familiar `` bell curve '' of a univariate gaussian and is an important distribution in probability theory and multivariate statistics because of the central limit theorem @xcite .",
    "given an @xmath21-dimensional random variable @xmath22 and @xmath28 $ ] , let @xmath29 .",
    "similarly , if @xmath30 is a vector , then @xmath31 is the subvector indexed by @xmath32 . for a matrix @xmath24 , @xmath33 is the submatrix of @xmath24 with row index set @xmath32 and column index set @xmath34 .",
    "among the nice properties of gaussian random variables are the fact that marginalization and conditioning both preserve the gaussian property ; see @xcite .",
    "suppose that @xmath35 and let @xmath36 $ ] be disjoint",
    ". then    1 .",
    "@xmath37 and 2 .",
    "@xmath38    to build the gaussian bayesian network associated to the dag @xmath5 , we allow any gaussian conditional distribution for the distribution @xmath39 . this conditional distribution is recovered by saying that @xmath40 where @xmath41 and is independent of the @xmath15 with @xmath10 , and the @xmath42 are the regression parameters .",
    "linear transformations of gaussian random variables are gaussian , and thus @xmath22 is also a gaussian random variable . since @xmath22 is completely specified by its mean @xmath23 and covariance matrix @xmath24 , we must calculate these from the conditional distribution .",
    "the recursive expression for the distribution of @xmath43 given the variables preceding it yields a straightforward and recursive expression for the mean and covariance .",
    "namely @xmath44 and if @xmath45 the covariance is : @xmath46 and the variance satisfies : @xmath47    if there are no constraints on the vector @xmath48 , there will be no constraints on @xmath23 either .",
    "thus , we will focus attention on the constraints on the covariance matrix @xmath24 .",
    "if we further assume that the @xmath49 are completely unconstrained , this will imply that we can replace the messy expression for the covariance @xmath50 by a simple new parameter @xmath51 .",
    "this leads us to the algebraic representation of our model , called the _ trek rule _ @xcite .    for each edge",
    "@xmath52 let @xmath42 be an indeterminate and for each vertex @xmath53 let @xmath54 be an indeterminate .",
    "assume that the vertices are numerically ordered , that is @xmath55 only if @xmath10 .",
    "a _ collider _ is a pair of edges @xmath56 , @xmath57 with the same head .",
    "for each pair of vertices @xmath58 , let @xmath59 be the collection of simple paths @xmath60 in @xmath5 from @xmath61 to @xmath62 such that there is no collider in @xmath60 .",
    "such a colliderless path is called a _ trek_. the name trek come from the fact that every colliderless path from @xmath61 to @xmath62 consists of a path from @xmath61 up to some topmost element @xmath63 and then from @xmath63 back down to @xmath62 .",
    "we think of each trek as a sequence of edges @xmath64 . if @xmath65 , @xmath66 consists of a single empty trek from @xmath61 to itself .",
    "let @xmath67 be the ring homomorphism @xmath68 \\rightarrow   { \\mathbb{c}}[a_i , \\lambda_{ij } \\ , \\ , | \\ , \\",
    ", i , j \\in [ n ] i \\to j    \\in e(g ) ] \\ ] ] @xmath69 when @xmath65 , we get @xmath70 . if there is no trek in @xmath59 , then @xmath71 .",
    "let @xmath72 .",
    "since @xmath0 is the kernel of a ring homomorphism , it is a prime ideal .",
    "[ ex:4cycle ] let @xmath5 be the directed graph on four vertices with edges @xmath73 , @xmath74 , @xmath75 , and @xmath76 .",
    "the ring homomorphism @xmath67 is given by @xmath77 the ideal @xmath0 is the complete intersection of a quadric and a cubic : @xmath78    dual to the ring homomorphism is the rational parametrization @xmath79 @xmath80 we will often write @xmath81 to denote the coordinate polynomial that represents this function",
    ".    let @xmath82 be the subset of parameter space satisfying the constraints : @xmath83 for all @xmath61 , where in the case that @xmath84 the sum is zero .",
    "[ prop : goodfac][trek rule ] the set of covariance matrices in the gaussian bayesian network associated to @xmath5 is the image @xmath85 . in particular , @xmath0 is the vanishing ideal of the model .",
    "the proof of the trek rule parametrization can also be found in @xcite .",
    "the proof goes by induction .",
    "first , we make the substitution @xmath86 which is valid because , given the @xmath42 s , @xmath49 can be recovered from @xmath51 and vice versa .",
    "clearly @xmath87 .",
    "by induction , suppose that the desired formula holds for all @xmath88 with @xmath89 .",
    "we want to show that @xmath90 has the same formula . now from above ,",
    "we have @xmath91 this last expression is a factorization of @xmath92 since every trek from @xmath61 to @xmath21 is the union of a trek @xmath93 and an edge @xmath94 where @xmath95 is some parent of @xmath21 .",
    "the parameters used in the trek rule parametrization are a little unusual because they involve a mix of the natural parameters ( regression coefficients @xmath42 ) and coordinates on the image space ( variance parameters @xmath54 ) . while this mix might seem unusual from a statistical standpoint , we find that this parametrization is rather useful for exploring the algebraic structure of the covariance matrices that come from the model .",
    "for instance :    if @xmath2 is a tree , then @xmath3 is a toric ideal .    for any pair of vertices @xmath96 in @xmath2",
    ", there is at most one trek between @xmath61 and @xmath62 .",
    "thus @xmath97 is a monomial and @xmath3 is a toric ideal .",
    "in fact , as we will show in section [ sec : tree ] , when @xmath2 is a tree , @xmath3 is generated by linear forms and quadratic binomials that correspond to conditional independence statements implied by the graph . before getting to properties of conditional independence",
    ", we first note that these models are identifiable .",
    "that is , it is possible to recover the @xmath42 and @xmath54 parameters directly from @xmath24 .",
    "this also allows us to determine the most basic invariant of @xmath0 , namely its dimension .",
    "[ prop : dim ] the parametrization @xmath98 is birational . in other words , the model parameters @xmath42 and @xmath54 are identifiable and @xmath99 .",
    "it suffices to prove that the parameters are identifiable via rational functions of the entries of @xmath24 , as all the other statements follow from this .",
    "we have @xmath100 so the @xmath54 parameters are identifiable .",
    "we also know that for @xmath10 @xmath101 thus , we have the matrix equation @xmath102 where @xmath103 is the vector @xmath104 .",
    "since @xmath105 is invertible in the positive definite cone , we have the rational formula @xmath106 and the @xmath42 parameters are identifiable .",
    "one of the problems we want to explore is the connection between the prime ideal defining the graphical model ( and thus the image of the parametrization ) and the relationship to the ideal determined by the independence statements induced by the model . to explain this connection , we need to recall some information about the algebraic nature of conditional independence .",
    "recall the definition of conditional independence .",
    "let @xmath32 , @xmath34 , and @xmath107 be disjoint subsets of @xmath108 $ ] , indexing subsets of the random vector @xmath22 .",
    "the conditional independence statement @xmath109 (  @xmath32 is independent of @xmath34 given @xmath107 ) holds if and only if @xmath110 for all @xmath111 such that @xmath112 .",
    "we refer to @xcite for a more extensive introduction to conditional independence . in the gaussian case ,",
    "a conditional independence statement is equivalent to an algebraic restriction on the covariance matrix .",
    "let @xmath113 be disjoint subsets of @xmath108 $ ] .",
    "then @xmath114 satisfies the conditional independence constraint @xmath109 if and only if the submatrix @xmath115 has rank less than or equal to @xmath116 .    if @xmath117 , then @xmath118 the ci statement @xmath109 holds if and only if @xmath119 . the @xmath120 submatrix of @xmath121 is easily seen to be @xmath122 which is the schur complement of the matrix @xmath123 since @xmath124 is always invertible ( it is positive definite ) , the schur complement is zero if and only if the matrix @xmath125 has rank less than or equal to @xmath116 .    given a dag @xmath5 ,",
    "a collection of conditional independence statements are forced on the joint distribution by the nature of the graph .",
    "these independence statements are usually described via the notion of @xmath126-separation ( the @xmath126 stands for `` directed '' ) .",
    "let @xmath32 , @xmath34 , and @xmath107 be disjoint subsets of @xmath108 $ ] .",
    "the set @xmath107 _ d - separates _",
    "@xmath32 and @xmath34 if every path in @xmath5 connecting a vertex @xmath127 and @xmath128 contains a vertex @xmath95 that is either    1 .   a non - collider that belongs to @xmath107 or 2 .   a collider that does not belong to @xmath107 and has no descendants that belong to @xmath107 .",
    "note that @xmath107 might be empty in the definition of @xmath126-separation .",
    "the conditional independence statement @xmath129 holds for the bayesian network associated to @xmath5 if and only if @xmath107 @xmath126-separates @xmath32 from @xmath34 in @xmath5 .",
    "a joint probability distribution that satisfies all the conditional independence statements implied by the graph @xmath5 is said to satisfy the global markov property of @xmath5 .",
    "the following theorem is a staple of the literature of graphical models , that holds with respect to any @xmath130-algebra .",
    "* thm 3.27 ) a probability density has the recursive factorization property with respect to @xmath5 if and only if it satisfies the global markov property .",
    "let @xmath131 $ ] be the ideal generated by the minors of @xmath24 corresponding to the conditional independence statements implied by @xmath5 ; that is , @xmath132 the ideal @xmath1 is called the _",
    "conditional independence ideal _ of @xmath5 .",
    "a direct geometric consequence of the recursive factorization theorem is the following    for any dag @xmath5 , @xmath133    in the corollary @xmath134 is the cone of @xmath135 positive definite symmetric matrices .",
    "it seems natural to ask whether or not @xmath136 for all dags @xmath5 .",
    "for instance , this was true for the dag in example [ ex:4cycle ] .",
    "the verma graph provides a natural counterexample .",
    "[ ex : verma ] let @xmath5 be the dag on five vertices with edges @xmath74 , @xmath137 , @xmath138 , @xmath75 , @xmath76 , and @xmath139 .",
    "this graph is often called the verma graph .",
    "the conditional independence statements implied by the model are all implied by the three statements @xmath140 , @xmath141 , and @xmath142 .",
    "thus , the conditional independence ideal @xmath1 is generated by one linear form and five determinantal cubics . in this case , we find that @xmath143 where @xmath19 is the degree four polynomial : @xmath144 we found that the primary decomposition of @xmath1 is @xmath145 so that @xmath19 is not even in the radical of @xmath1 .",
    "thus , the zero set of @xmath1 inside the positive _ _",
    "semi__definite cone contains singular covariance matrices that are not limits of distributions that belong to the model . note",
    "that since none of the indices of the @xmath88 appearing in @xmath19 contain @xmath146 , @xmath19 vanishes on the marginal distribution for the random vector @xmath147 .",
    "this is the gaussian version of what is often called the verma constraint .",
    "note that this computation shows that the verma constraint is still needed as a generator of the unmarginalized verma model .",
    "the rest of this paper is concerned with studying the ideals @xmath0 and investigating the circumstances that guarantee that @xmath148 .",
    "we report on results of a computational study in the next section . towards the end of the paper ,",
    "we study the ideals @xmath149 that arise when some of the random variables are hidden .",
    "whenever approaching a new family of ideals , our first instinct is to compute as many examples as possible to gain some intuition about the structure of the ideals .",
    "this section summarizes the results of our computational explorations .",
    "we used macaulay2 @xcite to compute the generating sets of all ideals @xmath0 for all dags @xmath5 on @xmath150 vertices .",
    "our computational results concerning the problem of when @xmath148 are summarized in the following proposition .",
    "all dags on @xmath151 vertices satisfy @xmath148 . of the @xmath152 dags on @xmath153 vertices ,",
    "exactly @xmath154 satisfy @xmath148 . of the @xmath155 dags on @xmath156 vertices",
    "exactly @xmath157 satisfy @xmath148 .",
    "on @xmath158 vertices , there were precisely nine graphs that fail to satisfy @xmath148 .",
    "these nine exceptional graphs are listed below .",
    "the numberings of the dags come from the atlas of graphs @xcite .",
    "note that the verma graph from example [ ex : verma ] appears as @xmath159 after relabeling vertices .",
    "1 .   @xmath160 : @xmath161 , @xmath137 , @xmath75 , @xmath76 , @xmath162 .",
    "@xmath163 : @xmath74 , @xmath138 , @xmath164 , @xmath76 , @xmath139 .",
    "@xmath165 : @xmath73 , @xmath74 , @xmath137 , @xmath75 , @xmath76 , @xmath139 .",
    "@xmath166 : @xmath167 , @xmath161 , @xmath138 , @xmath164 , @xmath76 , @xmath139 .",
    "@xmath168 : @xmath74 , @xmath161 , @xmath75 , @xmath164 , @xmath169 , @xmath139",
    "@xmath159 : @xmath74 , @xmath161 , @xmath138 , @xmath164 , @xmath76 , @xmath139",
    "@xmath170 : @xmath73 , @xmath161 , @xmath137 , @xmath138 , @xmath164 , @xmath76 , @xmath139",
    "@xmath171 : @xmath73 , @xmath74 , @xmath137 , @xmath75 , @xmath76 , @xmath172 , @xmath139 .",
    "@xmath173 : @xmath73 , @xmath174 , @xmath138 , @xmath164 , @xmath76 , @xmath172 , @xmath139 .",
    "the table below displays the numbers of minimal generators of different degrees for each of the ideals @xmath0 where @xmath5 is one of the nine graphs on five vertices such that @xmath175 .",
    "the coincidences among rows in this table arise because sometimes two different graphs yield the same family of probability distributions .",
    "this phenomenon is known as markov equivalence @xcite .    [",
    "cols=\"^,^,^,^,^,^\",options=\"header \" , ]     let @xmath176 denote the polyhedron defined as the solution space to the given constraints .",
    "first of all , @xmath176 is bounded . to see this , first note that because of the positive constraints and the equation @xmath177 , we have that @xmath178 is implied by the given constraints .",
    "then , starting from the sources of the tree and working our way down the edges repeatedly using the inequalities @xmath179 , we see that the @xmath180 are also bounded .",
    "now , we have @xmath181 , since every trek will satisfy any of the indicated constraints .",
    "thus , we must show that @xmath182 . to do this",
    ", it suffices to show that for any vector @xmath183 , there exists @xmath184 , @xmath185 and @xmath186 such that @xmath187 where @xmath185 is one of the @xmath188 vectors @xmath189 and @xmath190 . because @xmath176 is bounded",
    ", this will imply that the extreme points of @xmath176 are a subset of the extreme points of @xmath191 , and hence @xmath182 . without loss of generality",
    "we may suppose that all of the coordinates @xmath192 are positive , otherwise the problem reduces to a smaller tree or forest because the resulting inequalities that arise when @xmath193 are precisely those that are necessary for the smaller tree .",
    "note that for a forest @xmath194 , the polytope @xmath195 is the direct join of polytopes @xmath191 as @xmath2 ranges over the connected components of @xmath194 , by proposition [ prop : disconnect ] .",
    "for any fixed @xmath62 , there can not exist distinct values @xmath196 , @xmath197 , and @xmath198 such that all of @xmath199 @xmath200 @xmath201 hold .",
    "if there were , we could add these three equations together to deduce that @xmath202 this in turn implies that @xmath203 with equality if and only if @xmath204 and @xmath205 .",
    "this in turn implies that , for instance , @xmath206 contradicting our assumption that @xmath207 for all @xmath61 and @xmath62 . by a similar argument , if exactly two of these facet defining inequalities hold sharply , we see that @xmath208 which implies that @xmath62 has exactly two descendants and no parents .",
    "now mark each edge @xmath57 in the tree @xmath2 such that @xmath209 by the preceding paragraph , we can find a trek @xmath60 from a sink in the tree to a source in the tree and ( possibly ) back to a different sink that has the property that for no @xmath61 in the trek there exists @xmath95 not in the path such that @xmath56 is a marked edge .",
    "that is , the preceding paragraph shows that there can be at most @xmath210 marked edges incident to any given vertex .",
    "given @xmath60 , let @xmath185 denote the corresponding @xmath188 vector .",
    "we claim that there is a @xmath184 such that @xmath211 holds with @xmath212 .",
    "take @xmath213 to be any very small number and define @xmath186 by the given equation .",
    "note that by construction the inequalities @xmath214 and @xmath215 will be satisfied since for all the nonzero entries in @xmath185 , the corresponding inequality for @xmath216 must have been nonstrict and @xmath217 is small .",
    "furthermore , the constraint @xmath218 is also automatically satisfied .",
    "it is also easy to see that the last set of inequalities will also be satisfied since through each vertex the path will either have no edges , an incoming edge and an outgoing edge , or two outgoing edges and the top vertex , all of which do not change the value of the linear functional .    finally to see that the inequalities of the form @xmath219 are still satisfied by @xmath220 , note that marked edges of @xmath2",
    "are either contained in the path @xmath60 or not incident to the path @xmath60 .",
    "thus , the strict inequalities remain strict ( since they will involve modifying by an incoming edge and an outgoing edge or an outgoing edge and the top vertex ) , and the nonstrict inequalities remain nonstrict since @xmath217 is small .",
    "thus , we conclude that @xmath182 , which completes the proof .",
    "[ cor : pull ] let @xmath221 be any reverse lexicographic term order such that @xmath222 for all @xmath61 and @xmath223",
    ". then @xmath224 is squarefree .",
    "in other words , the associated pulling triangulation of @xmath191 is unimodular .",
    "the proof is purely polyhedral , and relies on the geometric connections between triangulations and initial ideals of toric ideals .",
    "see chapter 8 in @xcite for background on this material including pulling triangulations .",
    "let @xmath189 denote the vertex of @xmath191 corresponding to the monomial @xmath225 . for @xmath226 ,",
    "each of the vertices @xmath189 has lattice distance at most one from any of the facets described by theorem [ thm : facets ] .",
    "this is seen by evaluating each of the linear functionals at the @xmath188 vector corresponding to the trek between @xmath61 and @xmath62 .",
    "if we pull from one of these vertices we get a unimodular triangulation provided that the induced pulling triangulation on each of the facets of @xmath191 not containing @xmath189 is unimodular .",
    "this is because the normalized volume of a simplex is the volume of the base times the lattice distance from the base to the vertex not on the base .",
    "the facet defining inequalities of any face of @xmath191 are obtained by taking an appropriate subset of the facet defining inequalities of @xmath191 .",
    "thus , as we continue the pulling triangulation , if the current face contains a vertex @xmath189 with @xmath227 , we will pull from this vertex first and get a unimodular pulling triangulation provided the induced pulling triangulation of every face is unimodular .",
    "thus , by induction , it suffices to show that the faces of @xmath191 that are the convex hull of vertices @xmath228 have unimodular pulling triangulations .",
    "however , these faces are always unimodular simplices .",
    "the ring @xmath229/i_t$ ] is normal and cohen - macaulay when @xmath2 is a tree .",
    "since @xmath191 has a unimodular triangulation , it is a normal polytope and hence the semigroup ring @xmath229/i_t$ ] is normal .",
    "theorem @xcite then implies that @xmath229/i_t$ ] is cohen - macaulay .    while we know that @xmath229/i_t$ ] is always cohen - macaulay , it remains to determine how the cohen - macaulay type of @xmath3 depends on the underlying tree @xmath2 .",
    "here is a concrete conjecture concerning the special case of gorenstein trees .",
    "suppose that @xmath2 is a directed tree .",
    "then @xmath229/i_t$ ] is gorenstein if and only if the degree of every vertex in @xmath2 is less than or equal to three .    a _ downward directed tree _",
    "is a tree all of whose edges point to the unique sink in the tree .",
    "a leaf of such a downward directed tree is then a source of the tree . with a little more refined information about which inequalities defining @xmath191 are facet defining",
    ", we can deduce results about the degrees of the ideals @xmath3 in some cases .",
    "[ cor : treedegree ] let @xmath2 be a downward directed tree and let @xmath61 be any leaf of @xmath2 , @xmath230 the sink of @xmath2 , and @xmath60 the unique trek in @xmath231 .",
    "then @xmath232 where @xmath233 denotes the forest obtained from @xmath2 by removing the edge @xmath64 .",
    "first of all , note that in the case of a downward directed tree the inequalities of the form @xmath234 are redundant : since each vertex has at most one descendant , it is implied by the the other constraints . also , for any source @xmath235 , the inequality @xmath236 is redundant , because it is implied by the inequalities @xmath237 and @xmath238 where @xmath62 is the unique child of @xmath235 .",
    "now we will compute the normalized volume of the polytope @xmath191 ( which is equal to the degree of the toric ideal @xmath3 ) by computing the pulling triangulation from corollary [ cor : pull ] and relating the volumes of the pieces to the associated subforests .",
    "since the pulling triangulation of @xmath191 with @xmath239 pulled first is unimodular , the volume of @xmath191 is the sum of the volumes of the facets of @xmath191 that do not contain @xmath239 .",
    "note that @xmath239 lies on all the facets of the form @xmath219 since through every vertex besides the source and sink , the trek has either zero or two edges incident to it .",
    "thus , the only facets that @xmath239 does not lie on are of the form @xmath240 such that @xmath64 is an edge in the trek @xmath60 . however , the facet of @xmath191 obtained by setting @xmath241 is precisely the polytope @xmath242 , which follows from theorem [ thm : facets ] .",
    "note that upon removing an edge in a tree we obtain a forest .",
    "proposition [ prop : disconnect ] implies that the degree of such a forest is the product of the degrees of the associated trees . since the degree of the tree consisting of a single point is one , the formula from corollary [ cor : treedegree ] yields a recursive expression for the degree of a downward directed forest .",
    "let @xmath243 be the directed chain with @xmath21 vertices .",
    "then @xmath244 , the @xmath245st catalan number .    in corollary",
    "[ cor : treedegree ] we take the unique path from @xmath146 to @xmath21 .",
    "the resulting forests obtained by removing an edge are the disjoint unions of two paths . by the product formula implied by proposition [ prop : disconnect ] we deduce that the degree of @xmath246 satisfies the recurrence : @xmath247 with initial condition @xmath248 .",
    "this is precisely the recurrence and initial conditions for the catalan numbers @xcite .",
    "now we want to prove the main result of this section , that the determinantal conditional independence statements actually generate the ideal @xmath3 when @xmath2 is a tree . to do this , we will exploit the underlying toric structure , introduce a tableau notation for working with monomials , and introduce an appropriate ordering of the variables .",
    "each variable @xmath88 that is not zero can be identified with the unique trek in @xmath2 from @xmath61 to @xmath62 .",
    "we associate to @xmath88 the tableau which records the elements of @xmath2 in this unique trek , which is represented like this : @xmath249\\ ] ] where @xmath34 and @xmath107 are ( possibly empty ) strings . if , say , @xmath61 were at the top of the path , we would write the tableau as @xmath250.\\ ] ] the tableau is in its standard form if @xmath251 is lexicographically earlier than @xmath252 .",
    "we introduce a lexicographic total order on standard form tableau variables by declaring @xmath253 \\prec [ \\underline{c}c|\\underline{c}d]$ ] if @xmath254 is lexicographically smaller that @xmath255 , or if @xmath256 and @xmath257 is lexicographically smaller than @xmath258 .",
    "given a monomial , its tableau representation is the row - wise concatenation of the tableau forms of each of the variables appearing in the monomial .",
    "let @xmath2 be the tree with edges @xmath74 , @xmath161 , @xmath75 , @xmath259 , @xmath260 , @xmath261 , and @xmath262 .",
    "then the monomial @xmath263 has the standard form lexicographically ordered tableau : @xmath264.\\ ] ] note that if a variable appears to the @xmath126-th power in a monomial , the representation for this variable is repeated as @xmath126 rows in the tableau .",
    "when we write out general tableau , lower - case letters will always correspond to single characters ( possibly empty ) and upper case letters will always correspond to strings of characters ( also , possibly empty ) .    for any tree @xmath2 ,",
    "the conditional independence statements implied by @xmath2 generate @xmath3 .",
    "in particular , @xmath3 is generated by linear polynomials @xmath88 and quadratic tetrad constraints .",
    "first of all , we can ignore the linear polynomials as they always correspond to independence constraints and work modulo these linear constraints when working with the toric ideal @xmath3 .",
    "in addition , every quadratic binomial of the form @xmath265 that belongs to @xmath3 is implied by a conditional independence statement .",
    "this follows from proposition [ prop : treeind ] .",
    "note that this holds even if the set @xmath266 does not have four elements .",
    "thus , it suffices to show that @xmath3 modulo the linear constraints is generated by quadratic binomials .    to show that @xmath3 is generated by quadratic binomials",
    ", it suffices to show that any binomial in @xmath3 can be written as a polynomial linear combination of the quadratic binomials in @xmath3 .",
    "this , in turn , will be achieved by showing that we can `` move '' from the tableau representation of one of the monomials to the other by making local changes that correspond to quadratic binomials . to show this last part",
    ", we will define a sort of distance between two monomials and show that it is always possible to decrease this distance using these quadratic binomials/ moves .",
    "this is a typical trick for dealing with toric ideals , illustrated , for instance , in @xcite .    to this end",
    "let @xmath19 be a binomial in @xmath3 . without loss of generality",
    ", we may suppose the terms of @xmath19 have no common factors , because if @xmath267 then @xmath268 as well .",
    "we will write @xmath19 as the difference of two tableaux , which are in standard form with their rows lexicographically ordered .",
    "the first row in the two tableaux are different and they have a left - most place where they disagree",
    ". we will show that we can always move this position further to the right .",
    "eventually the top rows of the tableaux will agree and we can delete this row ( corresponding to the same variable ) and arrive at a polynomial of smaller degree .    since @xmath268 , the treks associated to the top rows of the two tableaux must have the same top .",
    "there are two cases to consider .",
    "either the first disagreement is immediately after the top or not . in the first case",
    ", this means that the binomial @xmath19 must have the form : @xmath269 - \\left [ \\begin{array}{l|l } \\underline{a}bb   &   \\underline{a}dd \\\\ &   \\end{array } \\right].\\ ] ] without loss of generality we may suppose that @xmath270 . since @xmath271 the string @xmath272 must appear somewhere on the right - hand monomial .",
    "thus , @xmath19 must have the form : @xmath273 - \\left [ \\begin{array}{l|l } \\underline{a}bb   &   \\underline{a}dd \\\\",
    "\\underline{a}ee   &   \\underline{a}cc ' \\\\",
    "&   \\end{array } \\right].\\ ] ] if @xmath274 , we can apply the quadratic binomial @xmath275 - \\left [ \\begin{array}{l|l } \\underline{a}bb   &   \\underline{a}cc ' \\\\ \\underline{a}ee   &   \\underline{a}dd \\\\ \\end{array } \\right]\\ ] ] to the second monomial to arrive at a monomial which has fewer disagreements with the left - hand tableau in the first row . on the other hand ,",
    "if @xmath276 , we can not apply this move ( its application results in `` variables '' that do not belong to @xmath229 $ ] ) . keeping track of all the @xmath277 patterns that appear on the right - hand side , and the consequent @xmath277 patterns that appear on the left - hand side , we see that our binomial @xmath19 has the form    @xmath278 - \\left [ \\begin{array}{l|l } \\underline{a}bb   &   \\underline{a}dd \\\\ \\underline{a}dd '   &   \\underline{a}cc ' \\\\ \\underline{a}d *    &    *    \\\\ \\vdots   &   \\vdots   \\\\ \\underline{a}d *   &   *     \\end{array } \\right].\\ ] ] since there are the same number of @xmath277 s on both sides we see that there is at least one more @xmath279 on the right - hand side which has no @xmath126 s attached to it .",
    "thus , omitting the excess @xmath277 s on both sides , our binomial @xmath19 contains : @xmath280 - \\left [ \\begin{array}{l|l } \\underline{a}bb   &   \\underline{a}dd \\\\",
    "\\underline{a}dd '   &   \\underline{a}cc ' \\\\ \\underline{a}ee &    \\underline{a}gg    \\\\ \\end{array } \\right].\\ ] ] with @xmath274 or @xmath281 .",
    "we can also assume that @xmath282 otherwise , we could apply a quadratic move as above .",
    "thus we apply the quadratic binomials @xmath283 - \\left [ \\begin{array}{l|l } \\underline{a}dd '   &   \\underline{a}gg\\\\ \\underline{a}ee   &   \\underline{a}cc'\\\\ \\end{array } \\right]\\ ] ] and @xmath275 - \\left [ \\begin{array}{l|l } \\underline{a}bb   &   \\underline{a}cc ' \\\\ \\underline{a}ee   &   \\underline{a}dd \\\\",
    "\\end{array } \\right]\\ ] ] to reduce the number of disagreements in the first row .",
    "this concludes the proof of the first case .",
    "now suppose that the first disagreement does not occur immediately after the @xmath279 .",
    "thus we may suppose that @xmath19 has the form :    @xmath284   -   \\left [   \\begin{array}{l|l }   \\underline{a}axdd &   \\underline{a}e   \\\\    &      \\end{array }   \\right].\\ ] ] note that it does not matter whether or not this disagreement appears on the left - hand or right - hand side of the tableaux .",
    "since the string @xmath285 appears on right - hand monomial it must also appear somewhere on the left - hand monomial as well .",
    "if @xmath30 is not the top in this occurrence , we can immediately apply a quadratic binomial to reduce the discrepancies in the first row .",
    "so we may assume the @xmath19 has the form : @xmath286   -   \\left [   \\begin{array}{l|l }   \\underline{a}axdd &   \\underline{a}e   \\\\    &     \\\\    &    \\\\",
    "\\end{array }   \\right].\\ ] ] if @xmath287 we can apply the quadratic binomial @xmath288   - \\left [ \\begin{array}{l|l } \\underline{a}axdd ' &   \\underline{a}c   \\\\",
    "\\underline{x}bb   & \\underline{x}gg   \\\\ \\end{array }   \\right]\\ ] ] to the left - hand monomial to reduce the discrepancies in the first row .",
    "so suppose that @xmath289 .",
    "enumerating the @xmath290 pairs that can arise on the left and right hand monomials , we deduce , akin to our argument in the first case above , that @xmath19 has the form : @xmath291   -   \\left [   \\begin{array}{l|l }   \\underline{a}axdd &   \\underline{a}e   \\\\    &     \\\\    &    \\\\    &   \\\\",
    "\\end{array }   \\right]\\ ] ] where @xmath292 and @xmath95 are not equal to @xmath293 or @xmath126 .",
    "then we can apply the two quadratic binomials : @xmath294   -   \\left [   \\begin{array}{l|l } \\underline{x}hh    & \\underline{x}bg     \\\\",
    "\\underline{x}dd ' & \\underline{x}kk    \\\\    \\end{array }   \\right]\\ ] ] and @xmath295   -   \\left [   \\begin{array}{l|l }   \\underline{a}axdd ' &   \\underline{a}c   \\\\",
    "\\underline{x}bb   & \\underline{x}kk     \\\\",
    "\\end{array }   \\right]\\ ] ] to the left - hand monomial to produce a monomial with fewer discrepancies in the first row .",
    "we have shown that no matter what type of discrepancy that can occur in the first row , we can always apply quadratic moves to produce fewer discrepancies .",
    "this implies that @xmath3 is generated by quadrics .    among the results in this section",
    "were our proofs that @xmath3 has a squarefree initial ideal ( and hence @xmath229/i_t$ ] is normal and cohen - macaulay ) and that @xmath3 is generated by linear forms and quadrics .",
    "it seems natural to wonder if there is a term order that realizes these two features simultaneously .",
    "there exists a term order @xmath221 such that @xmath224 is generated by squarefree monomials of degree one and two .",
    "this section and the next concern bayesian networks with hidden variables . a hidden or latent random",
    "variable is one which we do not have direct access to .",
    "these hidden variables might represent theoretical quantities that are directly unmeasurable ( e.g. a random variable representing intelligence ) , variables we can not have access to ( e.g. information about extinct species ) , or variables that have been censored ( e.g. for sensitive random variables in census data ) . if we are given a model over all the observed and hidden random variables , the partially observed model is the one obtained by marginalizing over the hidden random variables .",
    "a number of interesting varieties arise in this hidden variable setting .    for gaussian random variables ,",
    "the marginalization is again gaussian , and the mean and covariance matrix are obtained by extracting the subvector and submatrix of the mean and covariance matrix corresponding to the observed random variables .",
    "this immediately yields the following proposition .",
    "[ prop : elim ] let @xmath296 $ ] be the vanishing ideal for a gaussian model .",
    "let @xmath297 $ ] be a partition of the random variables into hidden and observed variables @xmath298 and @xmath299",
    ". then @xmath300\\ ] ] is the vanishing ideal for the partially observed model .",
    "marginalization in the gaussian case corresponds to projection onto the subspace of pairs @xmath301 .",
    "coordinate projection is equivalent to elimination @xcite .",
    "in the case of a gaussian bayesian network , proposition [ prop : elim ] has a number of useful corollaries , of both a computational and theoretical nature .",
    "first of all , it allows for the computation of the ideals defining a hidden variable model as an easy elimination step .",
    "secondly , it can be used to explain the phenomenon we observed in example [ ex : verma ] , that the constraints defining a hidden variable model appeared as generators of the ideal of the fully observed model .",
    "let @xmath302 be a partition of the nodes of the dag @xmath5 .",
    "the hidden nodes @xmath298 are said to be _ upstream _ from the observed nodes @xmath299 in @xmath5 if there are no edges @xmath303 in @xmath5 with @xmath304 and @xmath305 .",
    "if @xmath302 is an upstream partition of the nodes of @xmath5 , we introduce a grading on the ring @xmath306 $ ] which will , in turn , induce a grading on @xmath229 $ ] .",
    "let @xmath307 for all @xmath308 , @xmath309 for all @xmath304 , @xmath310 if @xmath308 and @xmath304 , and @xmath311 otherwise .",
    "suppose that @xmath312 $ ] is an upstream partition of the vertices of @xmath5 .",
    "then each of the polynomials @xmath225 is homogeneous with respect to the upstream grading and @xmath313 thus , @xmath0 is homogeneous with respect to the induced grading on @xmath229 $ ] .",
    "there are three cases to consider . if both @xmath314 , then every trek in @xmath59 has a top element in @xmath298 and no edges of the form @xmath315 . in this case",
    ", the degree of each path is the vector @xmath316 . if @xmath317 and @xmath318 , every trek from @xmath61 to @xmath62 has a top in @xmath298 and exactly one edge of the form @xmath319 . thus , the degree of every monomial in @xmath320 is @xmath321 .",
    "if both @xmath322 , then either each trek @xmath60 from @xmath61 to @xmath62 has a top in @xmath299 , or has a top in @xmath298 . in the first case there can be no edges in @xmath60 of the form @xmath319 , and in the second case there must be exactly two edges in @xmath60 of the form @xmath319 . in either case , the degree of the monomial corresponding to @xmath60 is @xmath323 .",
    "note that the two dimensional grading we have described can be extended to an @xmath21 dimensional grading on the ring @xmath229 $ ] by considering all collections of upstream variables in @xmath5 simultaneously .",
    "[ thm : upstream ] let @xmath302 be an upstream partition of the vertices of @xmath5 .",
    "then every minimal generating set of @xmath0 that is homogeneous with respect to the upstream grading contains a minimal generating set of @xmath149 .",
    "the set of indeterminates @xmath88 corresponding to the observed variables are precisely the variables whose degrees lie on the facet of the degree semigroup generated by the vector @xmath323 .",
    "this implies that the subring generated by these indeterminates is a facial subring .",
    "the upstream variables theorem is significant because any natural generating set of an ideal @xmath324 is homogeneous with respect to its largest homogeneous grading group .",
    "for instance , every reduced grbner basis if @xmath0 will be homogeneous with respect to the upstream grading . for trees",
    ", the upstream variables theorem immediately implies :    [ thm : hidtree ] let @xmath2 be a rooted directed tree and @xmath299 consist of the leaves of @xmath2 .",
    "then @xmath325 is generated by the quadratic tetrad constraints @xmath326 such that @xmath327 , and there is a choke point @xmath328 between @xmath329 and @xmath330 .",
    "corollary [ thm : hidtree ] says that the ideal of a hidden tree model is generated by the tetrad constraints induced by the choke points in the tree .",
    "sprites et al @xcite use these tetrad constraints as a tool for inferring dag models with hidden variables . given a sample covariance matrix ,",
    "they test whether a collection of tetrad constraints is equal to zero . from the given tetrad constraints that are satisfied , together with the tetrad representation theorem",
    ", they construct a dag that is consistent with these vanishing tetrads .",
    "however , it is not clear from that work whether or not it is enough to consider only these tetrad constraints . indeed , as shown in @xcite , there are pairs of graphs with hidden nodes that have precisely the same set of tetrad constraints that do not yield the same family of covariance matrices .",
    "theorem [ thm : hidtree ] can be seen as a mathematical justification of the tetrad procedure of spirtes , et al , in the case of hidden tree models , because it shows that the tetrad constraints are enough to distinguish between the covariance matrices coming from different trees .",
    "in this section , we give families of examples to show how classical varieties from algebraic geometry arise in the study of gaussian bayesian networks .",
    "in particular , we show how toric degenerations of the grassmannian , matrix schubert varieties , and secant varieties all arise as special cases of gaussian bayesian networks with hidden variables .",
    "let @xmath331 be the grassmannian of @xmath210-planes in @xmath332 .",
    "the grassmannian has the natural structure of an algebraic variety under the plcker embedding .",
    "the ideal of the grassmannian is generated by the quadratic plcker relations : @xmath333.\\ ] ]      [ thm : grin ] let @xmath2 be a rooted directed binary tree with @xmath108 $ ] leaves and let @xmath299 be the set of leaves of @xmath2 . then there is a weight vector @xmath335 and a sign vector @xmath336 such that @xmath337      the proof idea is to show that the toric ideals @xmath325 have the same generators as the toric initial ideals of the grassmannian that have already been characterized in @xcite . without loss of generality",
    ", we may suppose that the leaves of @xmath2 are labeled by @xmath108 $ ] , that the tree is drawn without edge crossings , and the leaves are labeled in increasing order from left to right .",
    "these assumptions will allow us to ignore the sign vector @xmath338 in the proof .",
    "the sign vector results from straightening the tree and permuting the columns in the steifel coordinates .",
    "this results in sign changes in the plcker coordinates .    in corollary",
    "[ thm : hidtree ] , we saw that @xmath325 was generated by the quadratic relations @xmath326 such that there is a choke point in @xmath2 between @xmath329 and @xmath330 .",
    "this is the same as saying that the induced subtree of @xmath2 on @xmath266 has the split @xmath340 .",
    "these are precisely the generators of the toric initial ideals of the grassmannian @xmath341 identified in @xcite .    in the preceding theorem , any weight vector @xmath342 that belongs to the relative interior of the cone of the tropical grassmannian corresponding to the tree @xmath2 will serve as the desired partial term order .",
    "we refer to @xcite for background on the tropical grassmannian and toric degenerations of the grassmannian .",
    "since and ideal and its initial ideals have the same hilbert function , we see catalan numbers emerging as degrees of bayesian networks yet again .",
    "the fact that binary hidden tree models are toric degenerations of the grassmannian has potential use in phylogenetics .",
    "namely , it suggests a family of new models , of the same dimension as the binary tree models , that could be used to interpolate between the various tree models .",
    "that is , rather than choosing a weight vector in a full dimensional cone of the tropical grassmannian , we could choose a weight vector @xmath342 that sits inside of lower dimensional cone .",
    "the varieties of the initial ideals @xmath345 then correspond to models that sit somewhere `` between '' models corresponding of the full dimensional trees of the maximal dimensional cones containing @xmath342 .",
    "phylogenetic recovery algorithms could reference these in - between models to indicate some uncertainty about the relationships between a given collection of species or on a given branch of the tree .",
    "these new models have the advantage that they have the same dimension as the tree models and so there is no need for dimension penalization in model selection .      in this section",
    ", we will describe how certain varieties called matrix schubert varieties arise as special cases of the varieties of hidden variable models for gaussian bayesian networks .",
    "more precisely , the variety for the gaussian bayesian network will be the cone over one of these matrix schubert varieties . to do this",
    ", we first need to recall some equivalent definitions of matrix schubert varieties .",
    "let @xmath346 be a partial permutation matrix , which is an @xmath135 @xmath188 matrix with at most one @xmath146 in each row and column .",
    "the matrix @xmath346 is in the affine space @xmath347 .",
    "the borel group @xmath34 of upper triangular matrices acts on @xmath347 on the right by multiplication and on the left by multiplication by the transpose .",
    "the matrix schubert variety @xmath351 , so we can identify its coordinate ring with a quotient of @xmath352 , j \\in [ n']]$ ] . throughout this",
    "section @xmath353 = \\{1 ' , 2 ' , \\ldots , n'\\}$ ] , is a set of @xmath21 symbols that we use to distinguish from @xmath108 = \\{1,2 , \\ldots , n\\}$ ] .",
    "an equivalent definition of a matrix schubert variety comes as follows .",
    "let @xmath354 be the index set of the ones in @xmath346 .",
    "for each @xmath355 let @xmath356 be the variety of rank one matrices : @xmath357 then @xmath358 where the sum denotes the pointwise minkowski sum of the varieties . since @xmath356 are cones over projective varieties , this is the same as taking the join , defined in the next section .",
    "let @xmath346 be the partial permutation matrix @xmath359 then @xmath348 consists of all @xmath360 matrices of rank @xmath361 and @xmath362 , [ 3']}| \\right>$ ] . more generally , if @xmath346 is a partial permutation matrix of the form @xmath363 where @xmath364 is a @xmath365 identity matrix , then @xmath350 is the ideal of @xmath366 minors of a generic matrix .",
    "the particular bayesian networks which yield the desired varieties come from taking certain partitions of the variables .",
    "in particular , we assume that the observed variables come in two types labeled by @xmath108 = \\{1,2 , \\ldots , n\\}$ ] and @xmath353 = \\{1',2 ' , \\ldots , n ' \\}$ ] .",
    "the hidden variables will be labeled by the set @xmath367 .",
    "define the graph @xmath368 with vertex set @xmath369 \\cup [ n ' ] \\cup s(w)$ ] and edge set consisting of edges @xmath64 for all @xmath370 $ ] , @xmath371 for all @xmath372 $ ] , @xmath373 for all @xmath374 and @xmath375 and @xmath376 for all @xmath377 and @xmath378 .",
    "[ thm : schubert ] the generators of the ideal @xmath350 defining the matrix schubert variety @xmath348 are the same as the generators of the ideal @xmath379 \\cup    [ n']}$ ] of the hidden variable bayesian network for the dag @xmath368 with observed variables @xmath108 \\cup [ n']$ ] .",
    "that is , @xmath380 \\cup [ n ' ] ]   = i_{g(w ) , [ n ] \\cup [ n']}.\\ ] ]    the proof proceeds in a few steps .",
    "first , we give a parametrization of a cone over the matrix schubert variety , whose ideal is naturally seen to be @xmath381 \\cup    [ n ' ] ] .$ ] then we describe a rational transformation @xmath382 on @xmath383 \\cup [ n ' ] ] $ ] such that @xmath384    \\cup [ n']}$ ] .",
    "we then exploit that fact that this transformation is invertible and the elimination ideal @xmath379 \\cup [ n ' ] } \\cap { \\mathbb{c}}[\\sigma_{ij } \\,\\ , | \\ , \\ ,",
    "i \\in [ n ] , j \\in [ n ' ] ] $ ] is fixed to deduce the desired equality .",
    "first of all , we give our parametrization of the ideal @xmath350 . to do this",
    ", we need to carefully identify all parameters involved in the representation .",
    "first of all , we split the indeterminates in the ring @xmath385 \\cup [ n']]$ ] into three classes of indeterminates : those with @xmath386 $ ] , those with @xmath387 $ ] , and those with @xmath388 $ ] and @xmath389 $ ] .",
    "then we define a parametrization @xmath390 which is determined as follows :    @xmath391 \\rightarrow { \\mathbb{c}}[\\sigma_{ij } \\ ,    \\ , | \\ , \\ , i , j \\in [ n ] \\cup [ n']\\ ] ] @xmath392 \\\\ \\gamma_{ij } &   \\mbox { if } i , j \\in [ n ' ] \\\\",
    "{ ( k , l ) \\in s(w ) : k \\leq",
    "i , l \\leq j }   a_{(k , l ) } \\lambda_{(k , l),i } \\lambda_{(k , l),j } &   \\mbox { if }   i \\in [ n ] , j \\in [ n ' ] \\end{array }   \\right.\\ ] ]    let @xmath393 .",
    "since the @xmath338 , @xmath394 , @xmath217 , and @xmath279 parameters are all algebraically independent , we deduce that in @xmath395 , there will be no generators that involve combinations of the three types of indeterminates in @xmath396 \\cup [ n']]$ ] .",
    "furthermore , restricting to the first two types of indeterminates , there will not be any nontrivial relations involving these types of indeterminates .",
    "thus , to determine @xmath395 , it suffices to restrict to the ideal among the indeterminates of the form @xmath88 such that @xmath388 $ ] and @xmath389 $ ] .",
    "however , considering the parametrization in this case , we see that this is precisely the parametrization of the ideal @xmath350 , given as the minkowski sum of rank one matrices . thus , @xmath397 .",
    "now we will define a map from @xmath398 \\rightarrow { \\mathbb{c}}[\\sigma_{ij}]$ ] which sends @xmath395 to another ideal , closely related to @xmath379 \\cup [ n ' ] } $ ] . to define this map ,",
    "first , we use the fact that from the submatrix @xmath399 , [ n]}$ ] we can recover the @xmath42 and @xmath54 parameters associated to @xmath108 $ ] , when only considering the complete subgraph associated to graph @xmath400}$ ] ( and ignoring the treks that involve the vertices @xmath401 ) .",
    "this follows because these parameters are identifiable by proposition [ prop : dim ] .",
    "a similar fact holds when restricting to the subgraph @xmath402}$ ] .",
    "the ideal @xmath395 we have defined thus far can be considered as the vanishing ideal of a parametrization which gives the complete graph parametrization for @xmath400}$ ] and @xmath402}$ ] and a parameterization of the matrix schubert variety @xmath348 on the @xmath88 with @xmath388 $ ] and @xmath403 $ ] .",
    "so we can rationally recover the @xmath217 and @xmath279 parameters associated to the subgraphs @xmath400}$ ] and @xmath402}$ ] .    for each @xmath404 pair in",
    "@xmath108 $ ] or in @xmath353 $ ] , define the partial trek polynomial @xmath405 we fit these into two upper triangular matrices @xmath406 and @xmath407 where @xmath408 if @xmath409 with @xmath410 $ ] , @xmath411 and @xmath412 otherwise , with a similar definition for @xmath407 with @xmath108 $ ] replaced by @xmath353 $ ] .",
    "now we are ready to define our map .",
    "let @xmath382 be the rational map @xmath413",
    "\\to { \\mathbb{c}}[\\sigma]$ ] which leaves @xmath88 fixed if @xmath386 $ ] or @xmath387 $ ] , and maps @xmath88 with @xmath388 $ ] and @xmath389 $ ] by sending      this is actually a rational map , because the @xmath42 that appear in the formula for @xmath415 are expressed as rational functions in terms of the @xmath88 by the rational parameter recovery formula of proposition [ prop : dim ] . since this map transforms @xmath399 , [ n']}$ ] by multiplying on the left and right but lower and upper triangular matrices , this leaves the ideal @xmath416 , j \\in [ n']]$ ] fixed .",
    "thus @xmath417 . on the other hand @xmath382",
    "is invertible on @xmath395 so @xmath418 .",
    "if we think about the formulas for the image @xmath419 , we see that the formulas for @xmath88 with @xmath388 $ ] and @xmath389 $ ] in terms of parameters are the correct formulas which we would see coming from the parametrization @xmath420 . on the other hand , the formulas for @xmath88 with",
    "@xmath386 $ ] or @xmath387 $ ] are the formulas for the restricted graph @xmath421}$ ] and @xmath422}$ ] , respectively .",
    "since every trek contained in @xmath421}$ ] or @xmath422}$ ] is a trek in @xmath368 , we see that the current parametrization of @xmath395 is only `` almost correct '' , in that it is only missing terms corresponding to treks that go outside of @xmath400}$ ] or @xmath402}$ ] .",
    "denote this map by @xmath423 , and let @xmath420 be the actual parametrizing map of the model .",
    "thus , we have , for each @xmath88 with @xmath386 $ ] or @xmath387 $ ] , @xmath424 , where @xmath425 is a polynomial remainder term that does not contain any @xmath54 with @xmath388 \\cup [ n']$ ] , when @xmath426 $ ] or @xmath387 $ ] , and @xmath427 otherwise . on the other hand , every term of @xmath428 will involve exactly one @xmath54 with @xmath388 \\cup [ n']$ ] , when @xmath386 $ ] or @xmath429 $ ] .",
    "now we define a weight ordering @xmath221 on the ring @xmath430 $ ] that gives @xmath431 if @xmath432 \\cup [ n']$ ] and @xmath433 otherwise and @xmath434 for all @xmath96 .",
    "then , the largest degree term of @xmath435 with respect to this weight ordering is @xmath436 .",
    "since highest weight terms must all cancel with each other , we see that @xmath437 \\cup [ n']}$ ] , implies that @xmath438 .",
    "thus , we deduce that @xmath379 \\cup [ n ' ] }   \\subseteq j_w$ ] . on the other hand , @xmath439 \\cup [ n ] ' }   \\cap { \\mathbb{c}}[\\sigma_{ij } \\ , \\ , | \\ , \\ , i \\in    [ n ] , j \\in [ n ' ]   ]   = j_w \\cap { \\mathbb{c}}[\\sigma_{ij } \\ , \\,| \\ , \\ ,",
    "i \\in    [ n ] , j \\in [ n ' ]   ] \\ ] ] and since the generators of @xmath440 , j \\in [ n ' ]   ] $ ] generate @xmath395 , we deduce that @xmath441 \\cup [ n']}$ ] which completes the proof .",
    "the significance of theorem [ thm : schubert ] comes from the work of knutson and miller @xcite .",
    "they gave a complete description of antidiagonal grbner bases for the ideals @xmath350 .",
    "indeed , these ideals are generated by certain subdeterminants of the matrix @xmath399,[n']}.$ ] these determinants can be interpretted combinatorially in terms of the graph @xmath368 .",
    "@xcite the ideal @xmath350 defining the matrix schubert variety is generated by the conditional independence statements implied by the dag @xmath368 .",
    "in particular , @xmath442 , b \\subset [ n ' ] , c \\subset s(w ) , \\mbox { and }   c \\mbox {    $ d$-separates } a \\mbox { from } b \\right>.\\ ] ]      in this section , we will show how joins and secant varieties arise as special cases of gaussian bayesian networks in the hidden variable case .",
    "this , in turn , implies that techniques that have been developed for studying defining equations of joins and secant varieties ( e.g. @xcite ) might be useful for studying the equations defining these hidden variable models .",
    "given two ideals @xmath324 and @xmath443 in a polynomial ring @xmath444 = { \\mathbb{k}}[x_1 , \\ldots , x_m]$ ] , their _ join _ is the new ideal @xmath445 \\right >   \\right )   \\bigcap   { \\mathbb{c}}[{\\mathbf{x}}]\\ ] ] where @xmath446 is the ideal obtained from @xmath324 by plugging in the variables @xmath447 for @xmath448 .",
    "the secant ideal is the iterated join : @xmath449 with @xmath450 copies of @xmath324 .",
    "if @xmath324 and @xmath443 are homogeneous radical ideals over an algebraically closed field , the join ideal @xmath451 is the vanishing ideal of the join variety which is defined geometrically by the rule @xmath452 where @xmath453 denotes the line spanned by @xmath279 and @xmath293 and the bar denotes the zariski closure .",
    "suppose further that @xmath324 and @xmath443 are the vanishing ideals of parametrizations ; that is there are @xmath382 and @xmath454 such that @xmath455 \\rightarrow   { \\mathbb{c}}[\\theta ]   \\mbox { and }   \\psi : { \\mathbb{c}}[{\\mathbf{x } } ]   \\rightarrow   { \\mathbb{c}}[\\eta]\\ ] ] and @xmath456 and @xmath457 .",
    "then @xmath451 is the kernel of the map @xmath458   \\rightarrow   { \\mathbb{c}}[\\theta , \\eta]\\ ] ] @xmath459      let @xmath5 be a dag and suppose that the vertices of @xmath5 are partitioned into @xmath463 where both @xmath464 and @xmath465 are hidden sets of variables .",
    "suppose further that there are no edges of the form @xmath466 such that @xmath467 or edges of the form @xmath468 or @xmath469 with @xmath470 and @xmath471",
    ". then @xmath472      the parametrization of the hidden variable model only involves the @xmath88 such that @xmath322 .",
    "first , we restrict to the case where @xmath227 . since there are no edges between observed variables and no edges between @xmath464 and @xmath465 , every trek from @xmath61 to @xmath62 involves only edges in @xmath473 or only edges in @xmath474 .",
    "this means that @xmath475 and these summands are in non - overlapping sets of indeterminates .",
    "thus , by the comments preceding the proposition , the ideal only in the @xmath88 with @xmath476 is clearly a join .",
    "however , the structure of this hidden variable model implies that there are no nontrivial relations that involve the diagonal elements @xmath477 with @xmath478 .",
    "this implies that @xmath149 is a join .",
    "let @xmath479 be the directed complete bipartite graph with bipartition @xmath480 $ ] and @xmath481 $ ] such that @xmath482 for all @xmath483 $ ] and @xmath484 $ ] .",
    "then @xmath479 satisfies the conditions of the theorem recursively up to @xmath485 copies , and we see that : @xmath486 this particular hidden variable gaussian bayesian network is known as the factor analysis model .",
    "this realization of the factor analysis model as a secant variety was studied extensively in @xcite .      since in each case ,",
    "the two subgraphs @xmath473 and @xmath487 are isomorphic , the ideals are secant ideals of the hidden tree models @xmath325 for the appropriate underlying trees . in both cases , the ideal @xmath488 is a principal ideal , generated by a single cubic . in the first case , the ideal is the determinantal ideal @xmath489 . in the second case ,",
    "the ideal is generated by an eight term cubic      in both of the cubic cases in the previous example , the ideals under questions were secant ideals of toric ideals that were initial ideals of the grassmann - plcker ideal , as we saw in theorem [ thm : grin ] .",
    "note also that the secant ideals @xmath491 are , in fact , the initial terms of the @xmath492 pfaffian with respect to appropriate weight vectors .",
    "we conjecture that this pattern holds in general .",
    "let @xmath2 be a binary tree with @xmath21 leaves and @xmath299 the set of leaves of @xmath2 .",
    "let @xmath334 be the grassmann - plucker ideal , let @xmath342 be a weight vector and @xmath338 a sign vector so that @xmath493 as in theorem [ thm : grin ] . then for each @xmath450 @xmath494"
  ],
  "abstract_text": [
    "<S> conditional independence models in the gaussian case are algebraic varieties in the cone of positive definite covariance matrices . </S>",
    "<S> we study these varieties in the case of bayesian networks , with a view towards generalizing the recursive factorization theorem to situations with hidden variables . in the case when the underlying graph is a tree , we show that the vanishing ideal of the model is generated by the conditional independence statements implied by graph . we also show that the ideal of any bayesian network is homogeneous with respect to a multigrading induced by a collection of upstream random variables . </S>",
    "<S> this has a number of important consequences for hidden variable models . </S>",
    "<S> finally , we relate the ideals of bayesian networks to a number of classical constructions in algebraic geometry including toric degenerations of the grassmannian , matrix schubert varieties , and secant varieties . </S>"
  ]
}