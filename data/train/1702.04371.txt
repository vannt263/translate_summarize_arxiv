{
  "article_text": [
    "the integrated light of a galaxy offers a vast amount of information .",
    "when measured with sufficient precision and suitably analysed , the spectral energy distribution ( sed ) offers insights about a galaxy s composition from its birth to its time of observation @xcite . this can be used to estimate the galaxy s star formation rate as a function of time , which traces its evolution and merger history @xcite . combined with other observations ,",
    "this provides valuable knowledge of cosmic structure formation .",
    "existing methods of sed fitting use a variety of sophisticated techniques .",
    "these include inversion methods @xcite , bayesian codes for estimating uncertainties and covariances @xcite , machine learning methods with training sets @xcite , and template - based models @xcite . to search the large parameter spaces of the variables in consideration , markov chain monte carlo ( mcmc ) methods have become increasingly popular .",
    "these advances have been necessitated by the increasing detail provided by theory , and the expanding size of galaxy catalogues available through surveys .",
    "a large amount of ( spectro)photometric data of unprecedented quality will be generated in upcoming surveys , like lsst @xcite , hetdex @xcite and j - pas @xcite .",
    "sdss @xcite has already measured spectrophotometry for @xmath6 objects .",
    "the hetdex / shela field will cover roughly 600,000 objects with multi - band photometry and fiber spectroscopy .",
    "j - pas will cover 9,000 square degrees with 59 filters ( @xmath7 + 54 narrow - band filters across optical ) for @xmath8 galaxies .",
    "large regions covered in the nir with euclid @xcite and wfirst @xcite will overlap with lsst , which leads to seds for @xmath9 objects by 2022 , many of which will have panchromatic photometry . in keeping with the large amounts of reduced data generated by these collaborations , it is imperative that advanced methods of analysis are developed in order to gain useful information from the integrated light of the galaxies under consideration .",
    "the star formation history ( sfh ) of a galaxy can sometimes be poorly constrained through different approaches to sed fitting .",
    "typical methods assume a predetermined parametrization like constant star formation or exponentially declining star formation to estimate physical quantities of interest like the stellar mass , star formation rate ( sfr ) , or the time at which the galaxy started forming stars .",
    "a few approaches instead seek to reconstruct the sfh from the data , using methods that include reducing the dimensionality of the parameter space using data compression methods @xcite , fine - binning the interval that makes the maximum contribution to flux @xcite , mapping the discretized - time photometric fitting to a linear inversion problem @xcite , or comparing against a large basis of realistic model seds using a bayesian method @xcite . in the current work ,",
    "we aim to show that using a well - motivated basis allows us to reconstruct robust star formation histories from galaxy seds .",
    "the paper is organized as follows : in  [ sec:2 ] , we introduce the dense basis formalism of sed fitting , and how it can be applied to the specific problem of reconstructing sfhs , including the motivation for a particular choice of basis and the fitting procedure with a particular basis set .",
    "we describe the training of the atlas using different sources of realistic sfhs : sams , hydrodynamic simulations , and stochastic sfhs in  [ sec : traingofgor ] . in  [ sec : valsec ] we validate the method on both synthetic seds from the sams as well as real seds from the candels goods - s field",
    ". we then present results in  [ sec : results ] including the number of episodes of star formation in the galaxy s past and constraints on the timing and duration of star formation activity , quantities that were previously inaccessible through sed fitting . in  [ sec : discussion ] , we discuss biases introduced by adopting single parametrizations of sfhs , compare with other sfh reconstruction methods , and mention the application of the dense basis method to larger datasets .",
    "the dense basis sed fitting method reconstructs star formation histories ( sfhs ) of individual galaxies using an atlas comprised of seds corresponding to well motivated families of sfhs that effectively cover the space of all physical sfhs .",
    "it does so by training the atlas on mock catalogs prior to fitting the full dataset .",
    "this allows us to use the reconstructed sfhs to perform novel analyses and to tackle problems that were previously intractable with sed fitting , such as estimating the number and duration of star formation episodes in a galaxy s past . to avoid any bias due to choice of prior",
    ", the method is currently implemented in a frequentist manner . in this section ,",
    "we briefly describe the dense basis methodology and training of the basis set .",
    "an overview of the process is described in figure@xmath10[fig:2 ] .",
    "the collection of multiple families of well motivated sfhs and their corresponding seds with which we fit galaxies ; henceforth atlas of seds and sfhs , should be designed to utilise the dense basis method to its full potential .",
    "the choice of appropriate families of functions to best describe the formation of stars in the galaxy in sfh space ( @xmath11 ) determines how the sed - fitting procedure encodes realistic star formation .",
    "we employ seven major considerations in the choice of basis that should be satisfied for every functional family under consideration :    * * physically or empirically motivated : * the functional form of the sfh needs to be realistic , arising either from statistical analysis of star formation in model galaxies , or deduced from observed galaxies . for the latter , as in @xcite ,",
    "skewed distributions such as linear rise followed by exponential decline and lognormal arise in physical processes restricted to non - negative domains . in this case",
    ", sfhs should also satisfy @xmath12 at the big bang . * * robustness of reconstruction : * the family of basis sfhs should be chosen such that a good fit in an sed space ( @xmath13 $ ] ) should correspond to a good reconstruction in sfh space ( @xmath14 $ ] ) .",
    "this correspondence can be tested in various ways and could potentially be different for different datasets since the representative form of the sfh could differ across epochs .",
    "it is a useful metric for eliminating sfh families that fit seds well but yield biased sfh results , such as exponentially declining sfh parametrizations , which describe star formation reasonably well at recent times , but bias quantities such as age and @xmath15 , the lookback time at which the galaxy accumulates 50% of its observed mass , @xcite .",
    "analogous to isochrone synthesis and matrix inversion methods , this is possible since the seds are piecewise linear in their dependence on the sfh and can be decomposed into multiple representations using different functional families . *",
    "* dense in sfh space : * to avoid degeneracies and biases , ( i.e. , to better reveal the local minima of the likelihood surface in parameter space ) , we need to ensure the basis is sufficiently dense in the space of n - parameter curves spanning @xmath16 in the interval @xmath17 $ ] .",
    "* * minimal number of parameters : * the number of parameters used to describe the functional form of the sfh basis functions will determine the amount of data compression possible in reconstructing the spectrum of the galaxy from its best - fit coordinates in parameter space : @xmath18 . for the present application , we model the star formation history as a sum of star formation basis functions , each needing three parameters to describe each reconstructed episode of star formation , the timing of the peak , the timescale , and the stellar mass formed .. * * temporally consistent : * the families",
    "should be chosen such that they produce consistent results for an sfh , independent of when the galaxy is observed , within uncertainties . *",
    "* positive definite : * any functional used to describe the sfh should be positive definite , since @xmath19 $ ] , which allows us to extract physical information from multicomponent solutions to the reconstructed sfh , as opposed to methods like pca @xcite or piecewise - linear matrix inversion @xcite , which need regularization to yield physical solutions .",
    "* * robust to noise : * the atlas spans the space of physically motivated sfhs , but not the space of all possible seds .",
    "this makes it robust to noise in the sense that distortions due to noise that are not accessible through the physically motivated families of sfhs under consideration do not bias the fits , as described in appendix.[sec : noise_robust ] .",
    "we describe a few of the 2-parameter families of curves for the current analysis .",
    "an overall normalization corresponding to the stellar mass acts as a third parameter .",
    "a visual representation of these families is shown in figure [ fig : thedensebasissfhs ] .    1 .",
    "* top - hat : * historically , simple stellar populations ( ssps ) assumed that a galaxy s stellar population formed in a single instantaneous burst @xcite .",
    "an improvement over that was the extension to constant star formation ( csf ) from a start time through the time of observation at a fixed rate .",
    "here we use a two - parameter version of this parametrization , with a start time and a width .",
    "this is also useful for comparison with quantities in the literature computed using csf histories , which correspond to setting @xmath20 .",
    "@xmath21 where @xmath22 denotes the heaviside function with @xmath23 for @xmath24 and @xmath25 for @xmath26 , @xmath27 is the time at which star formation starts , and @xmath28 is the width of the top - hat .",
    "* esf : * exponentially declining star formation rates , a parametrization that performs well for local ellipiticals and for comparison with older literature with @xmath27 the time at which star formation starts and @xmath28 the rate constant of the exponential decline .",
    "@xmath29 3 .",
    "* linexp : * the delayed exponential @xcite with an additional parametrised start - time @xmath27 ( henceforth @xmath30 ) giving the time at which star formation starts and @xmath28 setting the width of the episode of star formation .",
    "@xmath31 4 .",
    "* gaussian : * a parametrization that is useful for describing symmetric episodes of star formation , where @xmath32 is the time at which star formation peaks and @xmath28 is the standard deviation , which sets the width of the episode of star formation .",
    "@xmath33 5 .",
    "* lognormal : * @xcite . a two - parameter statistical distribution that appears in many physical processes , @xmath27 is the time at which star formation starts and @xmath28 sets the width of the episode of star formation .",
    "@xmath34 6 .",
    "* besselexp : * bessel - function rise , followed by exponential decline ( henceforth @xmath35 ) .",
    "the order of the bessel function of the first kind , @xmath36 determines when the sfr peaks and to linear approximation is @xmath37 yr ] , and @xmath28 sets the width of the episode of star formation . @xmath38 we add a linear piece such that @xmath39 ) , to ensure that the set of functions described by this family remains positive definite , while also satisfying @xmath40 at the big bang .",
    "these functions offer the advantages of being able to model short episodes of star formation at specific times ( small t ) or long periods of star formation where the rate rises and then falls ( e.g. , @xcite ; @xcite ) .",
    "figure [ fig:1 ] shows a typical star formation history drawn from simulations and fits using the six families of sfhs described above .",
    "it can be seen that the standard parametrisations of constant star formation and exponentially declining star formation under and overestimate the stellar mass of the galaxy , while the other families show an improved estimation of the general trend of star formation .",
    "additionally , the expansion of the basis to include all physically motivated combinations of single - component sfhs will allow us to describe sfhs with multiple episodes of star formation separated by periods of relative quiescence in a galaxy s sfh .    .",
    "red datapoints show the noisified sed obtained by multiplying with filter transmission curves and adding photometric noise realized from a quadrature sum of candels photometric and zeropoint uncertainties ( 10% for the u_ctio , ks and irac ch1,2 bands , and 3% for the remaining photometric bands : f435w , f606w , f775w , f850lp , f105w , f125w , f160w ) .",
    "colored circles show the best fit seds corresponding to each reconstructed star formation history . _",
    "right panel : _ black dashed curve shows the sam star formation history .",
    "colored curves indicate sfr at a given lookback time at @xmath41 for sfhs from each family that are best fits to the noisified sed .",
    "the top - hat parametrisation underestimates the stellar mass of the galaxy by @xmath42 , while the exponentially declining sfh overestimates the stellar mass by @xmath43.,width=500 ]      for a simple stellar population , which assumes that all of its stars form at a single lookback time ( t ) and with the same metallicity ( z ) , the luminosity at a given wavelength ( @xmath44 ) is simply @xmath45 where @xmath46 is the time since the big bang , @xmath47 is the age of the galaxy at @xmath48 , and @xmath49 is the spectrum giving the luminosity of an ssp of metallicity z at age t since formation .",
    "the ssp spectrum contains assumptions for the imf , stellar tracks , and metallicity , which we hold constant in the current study .",
    "some of the effects of relaxing this assumption are noted in  [ sec : val_sams_realz ] , and are discussed further in ",
    "[ sec : compareparam ] .",
    "generalising from simple stellar populations ( ssps ) to composite stellar populations ( csps ) , we can then represent the sed for a galaxy with a given star formation history ( sfh @xmath50 ) as an integral over all of the star formation events that occurred at different times from the birth of the universe to the time of observation .",
    "composite stellar populations are written as a sum over a non - orthogonal set of star formation histories that satisfy the constraints outlined in  [ sec : sfhcondns ] , such that @xmath51 with @xmath52 denoting an overall normalization corresponding to the stellar mass formed by the sfh @xmath53 . given a basis of sfhs that spans this space",
    ", we can expand this instead as a sum over the parameter space , akin to a fourier expansion , as , @xmath54 where the contribution to the luminosity from an episode of star formation @xmath55 described by a family of curves from eq.(1 - 6 ) with the parameters @xmath56 is given by , @xmath57    dust reddening and nebular emission lines are then applied to the spectrum as described in ",
    "[ sec : atlasgen ] , denoted by the notation @xmath58 .",
    "the photometry in passband @xmath59 from the @xmath60 basis sfh @xmath53 parametrised by @xmath61 , is then given by , @xmath62    using this as a mapping from the basis of sfhs to the space of all physically motivated seds , we can then define a @xmath63 surface , which denotes the metric distance in the vector space of photometry between the observed sed and its closest match in the atlas . finding the reconstructed sfh in the basis",
    "is then reduced to an optimization problem on the likelihood surface .",
    "for example , with a surface defined using a @xmath63 metric , we get      in the following sections , we train the basis set using different mock datasets for which we can quantify both the goodness - of - fit in sed space , given by @xmath63 as well as the goodness - of - reconstruction in sfh space , given by @xmath65 , defined in  [ sec : traingofgor ] .",
    "we choose basis functions that show sufficient correspondence between the optima of these two quantities , which lets us reconstruct sfhs in the presence of model degeneracies , systematics and instrumental noise .      in order to implement the dense - basis algorithm ,",
    "it is necessary to first generate an atlas of template spectral energy distributions ( seds ) and then to use it to fit the observed seds .",
    "this is done as follows :        \\3 .",
    "* nebular emission * is added according to the prescription in @xcite using mappings iii , a one dimensional shock and photoionization code for modelling nebular line and continuum emission .",
    "we use in this work the precomputed hii region model grid described in @xcite , with the incident ionization spectra computed using staburst99 @xcite , at @xmath66 , from which we compute the ionization parameter using , @xmath67 this prescription does not add effective degrees of freedom to the atlas and could be expanded to accommodate more realistic emission in future work with higher s / n seds .",
    "* calzetti dust attenuation * @xcite is applied to atlas sed spectra with discrete values of @xmath68 to extend parameter space in dust for procedures where dusty seds are fit , using @xmath69 where @xmath70 \\\\ & = 2.659(-1.857 + \\frac{1.04}{\\lambda } ) + r_v~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\\lambda \\in [ 0.63,2.2]\\end{aligned}\\ ] ] with @xmath71 and the coefficients adjusted for @xmath44 in microns .",
    "since attenuation inferred from nebular emission lines differs from that inferred from the continuum ( uv spectral slope ) , we use @xmath72 @xcite , where @xmath73 is applied to both uv nebular continuum and nebular emission lines .    \\5 .",
    "after nebular emission lines are added to the spectrum , and dust attenuation is applied , the photometry for the basis seds @xmath74 , where @xmath59 denotes the photometric bands , or spectroscopic bins , at a redshift z is given by , @xmath75 where @xmath76 is the transmission curve of passband @xmath59 ( the spectroscopic equivalent would be the resolution element @xmath77 and throughput at that @xmath44 ) , and @xmath78 is the luminosity distance ( a @xmath78 of 10 parsecs is assumed when @xmath79 , as in bc03 ) . for convenience ,",
    "the flux densities are obtained as the ratio of the number of photons corresponding to the fluxes ( @xmath80 ) to the number of photons produced by a @xmath81 flat spectrum in passband @xmath59 .",
    "this yields the observations , predictions and uncertainties in identical units .",
    "the notation @xmath58 indicates that nebular emission and dust reddening have been applied to the spectrum .      in practice ,",
    "galaxies rarely have sufficiently smooth star - formation histories to be perfectly fit by a functional form , as inferred from our mock datasets as well as @xcite .",
    "in addition , considering the errors in the photometry , incomplete empirical knowledge of the mapping from sfh to sed spaces , and degeneracies between the sfh and other factors like dust and metallicity , we need to assess methods of reconstruction using multiple basis sfhs to reconstruct as close to the true sfh as possible given the quality of available data . considering a solution to the minimization problem in eq.[eqn : minchi2prob ]",
    ", we can express the best - fit sed as @xmath82 where @xmath83 is the number of components determined using the f - test , given by , @xmath84 this is used to determine the number of components in the sfh space that the sed should be fit with .",
    "the f - test assesses the null hypothesis that the fit with a larger number of parameters is not a statistical improvement over a fit with a smaller number of parameters as our bounding value , it helps to think of the case with an equal number of degrees of freedom ( @xmath85 ) , where a better statistical model has @xmath86 , which corresponds to @xmath87 . for the general case of @xmath88 , the @xmath89 cutoff provides a metric where statistical improvement is sufficient to justify the extra degrees of freedom .",
    "] , where @xmath90 are degrees of freedom corresponding to the number of components ( @xmath91 ) being fit with , with @xmath92 denoting the number of photometric bands .",
    "we estimate uncertainties for the reconstructed sfhs via a fully forward modeled frequentist approach using the likelihood surface of the fit , after rescaling the best - fit @xmath63 to correct for artificially low @xmath63 obtained for very noisy galaxies and artificially high @xmath63 values for the brightest galaxies .",
    "a subsurface of the complete likelihood surface is then obtained by imposing a cutoff using a procedure similar to @xcite .",
    "we compare the sfh corresponding to each point in the subsurface to the median sfh and exclude outlier sfhs that have an excursion greater than 1.5 times the maximum value , yielding robust confidence intervals as in @xcite .",
    "the uncertainties in sfr at each point in time are then found using a distribution of the remaining acceptable sfhs .",
    "our tests using the sample of 1200 mock sfhs show that this method robustly estimates the confidence bounds , such that for a formal @xmath94 confidence interval , the true sfh lies within the confidence interval @xmath95 of the time .",
    "we show the @xmath63 surface computed using this procedure for a single family in figure [ fig : chi2surf ] showing the best - fit sfh and threshold for uncertainties . in figure",
    "[ fig : uncertsfh ] we show some representative examples of the uncertainties with the top panel demonstrating the method s ability to constrain an older episode of star formation and the bottom panel showing the case of uncertainties with multiple episodes of star formation .      for the initial implementation of the method in this work , we have used the bruzual and charlot ( 2003 ) library of stellar tracks , with the parameter space as described by table [ table : saminit ] .",
    "the dense basis formalism can be applied equivalently with any set of free parameters , including the set of ssp models , to use the training and validation steps to help constrain the variable parameters , as discussed in  [ sec : compareparam ] .",
    "all three datasets are standardized to contain a sample of 400 galaxies with the same realistic distribution of stellar mass .       for sub - optimal @xmath96 bias",
    ", we find the distance @xmath97 for each galaxy with each sfh family .",
    "this distance denotes the difference between the best @xmath96 possible in the basis and the @xmath96 corresponding to the best - fit sed in the basis .",
    "if the latter quantity is much worse than the former , we say that a galaxy has a bias due to sub - optimal @xmath96 .",
    "we find that this is best quantified by the condition @xmath98 .",
    "we show the number of these biases for each family in table [ table : gofgor ] , finding much lower rates of occurrence and that the top - hat family shows the highest occurrence of this behaviour ."
  ],
  "abstract_text": [
    "<S> we introduce the dense basis method for spectral energy distribution ( sed ) fitting . </S>",
    "<S> it accurately recovers traditional sed parameters , including m@xmath0 , sfr and dust attenuation , and reveals previously inaccessible information about the number and duration of star formation episodes and the timing of stellar mass assembly , as well as uncertainties in these quantities . </S>",
    "<S> this is done using basis star formation histories ( sfhs ) chosen by comparing the goodness - of - fit of mock galaxy seds to the goodness - of - reconstruction of their sfhs . </S>",
    "<S> we train and validate the method using a sample of realistic sfhs at @xmath1 drawn from stochastic realisations , semi - analytic models , and a cosmological hydrodynamical galaxy formation simulation . </S>",
    "<S> the method is then applied to a sample of 1100 candels goods - s galaxies at @xmath2 to illustrate its capabilities at moderate s / n with 15 photometric bands . </S>",
    "<S> of the six parametrizations of sfhs considered , we adopt linear - exponential , bessel - exponential , lognormal and gaussian sfhs and reject the traditional parametrizations of constant ( top - hat ) and exponential sfhs . </S>",
    "<S> we quantify the bias and scatter of each parametrization . </S>",
    "<S> @xmath3 of galaxies in our candels sample exhibit multiple episodes of star formation , with this fraction decreasing above @xmath4 . about @xmath5 of </S>",
    "<S> the candels galaxies have sfhs whose maximum occurs at or near the epoch of observation . </S>",
    "<S> the dense basis method is scalable and offers a general approach to a broad class of data - science problems . </S>"
  ]
}