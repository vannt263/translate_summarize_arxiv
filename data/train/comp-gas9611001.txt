{
  "article_text": [
    "the lattice boltzmann equation ( lbe ) method has achieved great success for simulation of transport phenomena in recent years . among different lbe methods ,",
    "the lattice boltzmann bgk model is considered more robust @xcite . some recent theoretical discussions on lbgk @xcite",
    "have enhanced our understanding of the method and the effect of boundary conditions .",
    "they explains why the velocity boundary condition for the 2-d triangular lbgk model proposed in @xcite generates results of machine accuracy for plane poiseuille flow with forcing , and the bounceback or equilibrium scheme generate an first - order error to the velocity .",
    "moreover , the bounceback scheme with the wall located half - way between a flow node and a bounceback node ( it will be called `` half - way wall bounceback '' thereafter ) is shown theoretically to produce results of second - order accuracy for the simple flows considered .",
    "the above mentioned results with poiseuille flows are obtained with external forcing to drive the flow . in practice , however , a flow is often driven by pressure difference , and the pressure gradient in many cases can not be replaced by an external force in lbgk computations . in this situation",
    ", boundary conditions usually need be implemented by giving prescribed pressure or velocity on some `` flow boundaries '' , which are not solid walls or interfaces of two distinct fluids . instead , they are imaginary boundaries inside a flow domain ( e.g. inlet and outlet in a pipe flow ) .",
    "their existence is purely for the convenience of study .",
    "the implementation of these boundary conditions in lbgk is very important but it has not yet been well studied .    in lattice",
    "boltzmann method , a specification of pressure difference amounts to a specification of density difference .",
    "early works ( see , for example , @xcite ) to implement pressure ( density ) flow boundary condition is simply to assign the equilibrium distribution computed with the specified density and some velocity ( maybe zero ) to the distribution function .",
    "this method introduces significant errors .",
    "skordos @xcite proposed to add a term to the equilibrium distribution to improve it , the scheme requires the gradient of density and velocities at boundaries .",
    "_ @xcite and maier _ et al . _",
    "@xcite proposed new boundary conditions for lattice boltzmann simulations . in their simulation of poiseuille flow with pressure ( density ) gradient , the pressure boundary condition was treated in different way compared to their wall boundary condition .",
    "_ @xcite also proposed a way to specify general boundary conditions including flow boundary conditions .    in this paper",
    ", we propose a way to specify pressure or velocity on flow boundaries .",
    "they are treated as one type of general boundary conditions , which are based on an idea of bounceback of non - equilibrium part with modifications . when applied to the modified lbgk model",
    ", these boundary conditions produce results of machine accuracy for 2-d poiseuille flow with pressure ( density ) or velocity inlet / outlet conditions .",
    "it is also noticed that although all the proposed new boundary conditions ( @xcite ) including the boundary conditions in this paper yield improved accuracy compared to the bounceback boundary condition , they are difficult to implement for general geometries , because there is a need to distinguish distribution functions according to their orientation to the wall .",
    "besides , there are additional works or different treatments at corner nodes . on the other hand ,",
    "the complete bounceback scheme does not distinguish distribution functions and is very easy to implement in a parallel way , which was considered as one of the advantages of lga or lbe method . in this paper ,",
    "the half - way wall bounceback boundary condition with two flow boundary conditions are applied to the 2-d poiseuille flow and a 3-d square duct flow using the d2q9i and d3q15i lattice boltzmann models respectively .",
    "the results are approximately second - order accurate .",
    "the error is comparable with that using some published boundary conditions .",
    "moreover , the half - way wall bounceback boundary condition for stationary walls is much more stable than the boundary conditions in @xcite and in this paper .",
    "thus , we recommend to use the half - way wall bounceback boundary condition for stationary walls and use the boundary conditions proposed in this paper or in @xcite only for flow boundary conditions .",
    "the square lattice lbgk model ( d2q9 ) is expressed as ( @xcite,@xcite,@xcite ) : @xmath0 , \\ \\",
    ",8 , \\label{eq : lbgk}\\ ] ] where the equation is written in physical units . both the time step and the lattice spacing have the value of @xmath1 in physical units .",
    "@xmath2 is the density distribution function along the direction @xmath3 at ( @xmath4 ) .",
    "the particle speed @xmath3 s are given by @xmath5 , and @xmath6 .",
    "rest particles of type 0 with @xmath7 is also allowed ( see fig .  1 ) .",
    "the right hand side represents the collision term and @xmath8 is the single relaxation time which controls the rate of approach to equilibrium . the density per node , @xmath9 , and the macroscopic flow velocity , @xmath10 ,",
    "are defined in terms of the particle distribution function by @xmath11 the equilibrium distribution functions @xmath12 depend only on local density and velocity and they can be chosen in the following form ( the model d2q9 @xcite ) : @xmath13,\\;\\ ; \\ ; t_0=\\frac49 , \\ ; t_i = \\frac19 ,",
    "i =   1:4 ;   \\ ; t_i = \\frac{1}{36 } , i=5:8 .",
    "\\label{eq : equil}\\ ] ]    a chapman - enskog procedure can be applied to eq .",
    "( [ eq : lbgk ] ) to derive the macroscopic equations of the model .",
    "they are given by : the continuity equation ( with an error term @xmath14 being omitted ) : @xmath15 and the momentum equation ( with terms of @xmath14 and @xmath16 being omitted ) : @xmath17 where the einstein summation convention is used .",
    "@xmath18 is the strain - rate tensor .",
    "the pressure is given by @xmath19 , where @xmath20 is the speed of sound with @xmath21 and @xmath22 , with @xmath23 being the the kinematic viscosity .",
    "the form of the error terms and the derivation of these equations can be found in @xcite .    for 2-d case",
    ", we will take the poiseuille flow as an example to study the pressure ( density ) or velocity inlet / outlet condition .",
    "the analytical solution of poiseuille flow in a channel with width @xmath24 for the navier - stokes equation is given by : @xmath25 where the pressure gradient @xmath26 is a constant related to the centerline velocity @xmath27 by @xmath28 and the flow density @xmath29 is a constant .",
    "the reynolds number is defined as re = @xmath30 .",
    "the poiseuille flow is an exact solution of the steady - state incompressible navier - stokes equations with constant density @xmath31 : @xmath32 @xmath33 on the other hand , the steady - state macroscopic equations of the lbgk model are different from the incompressible navier - stokes equations eqs .",
    "( [ eq : a64],[eq : a65 ] ) by terms containing the spatial derivative of @xmath29 .",
    "these discrepancies are called compressibility error in lbe model .",
    "thus , when pressure ( density ) gradient drives the flow , @xmath34 in a lbgk simulation increases in the @xmath35direction , the velocity profile from the simulation is no loger a parabolic profile . for a fixed mach number ( @xmath27 fixed ) , as @xmath36 , the velocity of the lbgk simulation will not converge to the velocity in eq .",
    "( [ eq : pois ] ) because the compressibility error becomes dominant .",
    "this makes the comparison of @xmath34 with the analytical velocity of poiseuille flow somehow ambiguous .",
    "to make a more accurate study for poiseuille flow with pressure ( density ) or velocity flow boundary condition , it is better to use the improved incompressible lbgk model proposed in @xcite .",
    "the model ( called d2q9i ) is given by eq .",
    "( [ eq : lbgk ] ) with the same @xmath3 and the following equilibrium distributions : @xmath37 , \\ ;   \\ ; t_0=\\frac49 , \\ ; t_i = \\frac19 , i =   1:4 ; \\ ; t_i = \\frac{1}{36 } , i=5:8 .",
    "\\label{eq : eqi}\\ ] ] and @xmath38 where @xmath39 ( like the momentum in the ordinary lbgk model ) is used to represent the flow velocity .",
    "the macroscopic equations of d2q9i in the steady - state case ( apart from error terms of @xmath14 : @xmath40 @xmath41 are exactly the steady - state incompressible navier - stokes equation with constant density @xmath31 . in this model d2q9i , pressure is related to the calculated density by @xmath42 ( @xmath43 ) , and @xmath44 . the quantity @xmath45 will be called the effective pressure .",
    "although the macroscopic equations of d2q9i in the steady - state case has an error of @xmath14 to the steady - state navier - stokes equation , for some special flows like the poiseuille flow , it is possible that this error disappears with suitable boundary conditions .",
    "in this section a new boundary condition is proposed based on an idea of bounceback on non - equilibrium part as follows : take the case of a bottom node in fig .  1 ,",
    "the boundary is aligned with @xmath35direction with @xmath46 pointing into the wall . after streaming , @xmath47",
    "are known .",
    "suppose that @xmath48 are specified on the wall , we want to use eqs .",
    "( [ eq : dens ] ) to determine @xmath49 and @xmath29 ( originated in @xcite ) , which can be put into the form : @xmath50 @xmath51 @xmath52 consistency of eqs .",
    "( [ eq : rho],[eq : v0 ] ) gives @xmath53 .",
    "\\label{eq : rhod}\\ ] ]    we assume the bounceback rule is still correct for the non - equilibrium part of the particle distribution normal to the boundary ( in this case , @xmath54 ) . with @xmath55 known , @xmath56 can be found , thus @xmath57 the collision step is applied to the boundary nodes also . for non - slip boundaries ,",
    "this boundary condition is reduced to that in @xcite .",
    "a detailed discussion of implementation of boundary conditions on stationary walls in 3d case was given in @xcite .",
    "now let us turn to the pressure ( density ) flow boundary condition . in @xcite ,",
    "the pressure ( density ) boundary condition was treated in different way compared to the wall boundary condition .",
    "@xcite use an extrapolation scheme on an additional layer beyond a boundary to determine the incoming @xmath58 s before the streaming step , their treatment of pressure boundary condition is consistent with the wall boundary condition . in this paper , we treat pressure ( density ) flow boundary condition the same way as the velocity wall boundary condition .",
    "its derivation is based on eq .",
    "( [ eq : dens ] ) as for velocity wall boundary condition .",
    "suppose a flow boundary ( take the inlet in fig .  1 as example ) is along the @xmath59direction , and the pressure ( density ) is to be specified on it .",
    "suppose that @xmath60 is also specified ( e.g. @xmath61 at the inlet in a channel flow ) .",
    "after streaming , @xmath62 are known , @xmath63 are specified at inlet . we need to determine @xmath34 and @xmath64 from eq .",
    "( [ eq : dens ] ) as following : @xmath65 @xmath66 @xmath67 consistency of eqs .",
    "( [ eq : rhoi],[eq : u0i ] ) gives @xmath68}{\\rho_{in } } .",
    "\\label{eq : u0d}\\ ] ]    we use bounceback rule for the non - equilibrium part of the particle distribution normal to the inlet to find @xmath69 . with @xmath70 known , @xmath71 are obtained by the remaining two equations : @xmath72    the corner node at inlet needs some special treatment .",
    "take the bottom node at inlet as an example , after streaming , @xmath73 are known ; @xmath29 is specified , and @xmath74 .",
    "we need to determine @xmath75 .",
    "we use bounceback rule for the non - equilibrium part of the particle distribution normal to the inlet and the boundary to find : @xmath76 using these @xmath77 in eqs .",
    "( [ eq : u0i],[eq : v0i ] ) , we find : @xmath78 .",
    "\\label{eq : f5678}\\ ] ] similar procedure can be applied to top inlet node and outlet nodes including outlet corner nodes .      in some calculations , velocities @xmath48",
    "are specified at a flow boundary ( take the inlet in fig",
    ".  1 as example ) . in the flow region of the inlet or outlet , this is actually equivalent to a velocity wall boundary condition and can be handled in the same way as given at the beginning of the section .",
    "the effect of specifying velocity at inlet is similar to specifying pressure ( density ) at inlet .",
    "density difference in the flow can be automatically generated by the velocity inlet condition .    at the inlet bottom ( non - slip boundary ) ,",
    "special treatment is needed . after streaming , @xmath79",
    "need to be determined . using bounceback on normal distributions",
    "gives : @xmath80 expressions of @xmath81 momenta give : @xmath82 or @xmath83 ,      \\label{eq : veli1}\\end{aligned}\\ ] ] but there is no more equation available to determine @xmath29 .",
    "the situation is similar to a corner wall node ( the intersection of two perpendicular walls ) . in this situation ,",
    "since @xmath29 is expected to be constant at the inlet , @xmath29 at the inlet bottom node can be taken as the @xmath29 of its neighboring flow node , thus the velocity inlet condition is specified .",
    "it is noted that this treatment is only for a special study to produce the analytical solution with model d2q9i . in practice , however , the half - way wall bounceback is recommeded as boundary conditions for stationary walls and there is no need for special treatment at corner nodes .",
    "this will be discussed in section 4 .    from the discussion given above ,",
    "we can unify boundary conditions ( on a wall boundary or in a flow boundary ) in 2-d simulation on a straight boundary as :    * given @xmath48 , find @xmath29 and unknown @xmath58 s .",
    "* given @xmath29 and the velocity along the boundary , find the velocity normal to the boundary and unknown @xmath58 s .",
    "the above discussion is for flat flow boundaries aligned with a plane spanned by two particle velocities of type i. it is not the purpose of this paper to derive a flow boundary condition in a general geometry .",
    "if a flow boundary has a complicated geometry or if it is not aligned with lattice directions , schemes based on extrapolations like the ones in @xcite can be used .",
    "however , as pointed out in @xcite , on a convex edge or at a convex corner , there are too few unknown @xmath58 s , if the available @xmath58 s are used , then any choice of the unknown @xmath58 s may not make the velocity correct . there have not been analytical or numerical studies on the order of accuracy for these situations .",
    "thus the order of accuracy is not clear for these cases .",
    "hence , the equilibrium scheme can be considered as well .",
    "the equilibrium scheme at boundaries gives second - order accuracy if @xmath84 but only first - order when @xmath85 @xcite .",
    "the velocity wall boundary condition and flow boundary conditions for d2q9i are similar to that of d2q9 .",
    "the derivation is based on equations @xmath86 and @xmath87 and hence some modifications are needed as follows :    * in wall boundary condition , eq .",
    "( [ eq : rhod ] ) is replaced by @xmath88 .",
    "\\label{eq : rhodi}\\ ] ] + and in eq .",
    "( [ eq : f256 ] ) , @xmath89 are replaced by @xmath90 respectively . * in pressure flow boundary condition , eq .",
    "( [ eq : u0d ] ) is replaced by @xmath91 , \\label{eq : u0di}\\ ] ] and in eq .",
    "( [ eq : f158 ] ) , @xmath92 is replaced by @xmath93 .",
    "we report and discuss the numerical results for poiseuille flow with our wall and flow boundary conditions .",
    "the simulation is performed on the model d2q9i .",
    "the main result in the simulation is the achievement of machine accuracy .",
    "the width of the channel is assumed to be @xmath94 .",
    "we use @xmath95 lattice nodes on the @xmath35 and @xmath59directions , thus , @xmath96 .",
    "the initial condition is to assign @xmath97 computed using a constant density @xmath31 , and zero velocities .",
    "the steady - state is reached if @xmath98 @xmath99 is a tolerance set to @xmath100 in this section .",
    "we also define a maximum relative error of velocity @xmath101 as in @xcite : @xmath102 where @xmath103 is the analytical velocity , and @xmath27 is the peak velocity , the maximum is throughout the flow .    for model d2q9i",
    ", we carried out simulations with a variety of re , @xmath104 using the pressure or velocity flow boundary condition .",
    "all simulations in this paper use double - precision .",
    "the range of re is from 0.0001 to 30.0 ; the range of @xmath8 is from 0.56 to 20.0 and the range of @xmath105 is from 0.001 to 0.4 ; the largest density difference simulated ( not the limit ) is @xmath106 with @xmath107 corresponding to an effective pressure gradient of @xmath108 , where @xmath109 is defined as @xmath110 .",
    "the magnitude of average density @xmath31 is 5 , but it is irrelevant for the simulation @xcite .    for all cases where the simulation is stable , the steady - state velocity and density show :    * the velocity field @xmath111 is uniform in the @xmath112-direction , it is accurate up to machine accuracy compared to the analytical solution in eq .",
    "( [ eq : pois ] ) , @xmath113 is very small with maximum of @xmath114 in the whole region being in the order of @xmath115 . for example , for @xmath116 re = 10 , the maximum relative error of velocity is @xmath117 , while the maximum relative error of density is @xmath118 , and the maximum magnitude of @xmath113 is @xmath119 .",
    "the results for other cases are similar to this example . *",
    "the density is uniform in the cross channel direction , and linear in the flow direction .",
    "the computed value and the analytical value of the density gradient differ only at the 14th digit .    it is also noticed that with pressure ( density )",
    "gradient to drive poiseuille flow , the maximum reynolds number which makes the simulation stable is far less than that with external forcing , which is also reported in @xcite .",
    "similar results with machine accuracy are obtained by specifying the analytical velocity profile given in eq .",
    "( [ eq : pois ] ) at inlet and pressure ( density ) at outlet by using the flow boundary conditions in this paper . in the case",
    ", there is a uniform pressure ( density ) difference in the region .",
    "the value of the density difference depends on @xmath27 and the outlet density .    the accurate results in the model d2q9i",
    "give us confidence about the flow boundary conditions proposed .",
    "the bounceback rule with wall placed at the bounceback nodes gives an first - order error to velocity , both at the boundary and throughout the flow .",
    "this has been showed analytically @xcite for some simple flows and computationally @xcite for 2d cavity flows .",
    "the same can be said for the flows studied in this paper based on numerical results .",
    "there have been efforts to replace the bounceback boundary condition with new boundary conditions for lbe simulation .",
    "various boundary conditions @xcite including the one in this paper are proposed .",
    "while these boundary conditions indeed improve the accuracy for some simple flows over the bounceback scheme , extra works are still needed to apply them to a general situation .",
    "first , for example , at a concave edge @xcite , the boundary conditions in @xcite and in this paper do not give a natural way to determine the density , and since there are more unknowns at a node than in a plane wall node , some additional assumptions are needed to apply the boundary condition .",
    "second , all the boundary conditions in @xcite including the one in this paper require different treatments on @xmath58 s depending on their orientation to the wall , the implementation of these boundary conditions is formidable for complicated geometry like that in a porous media or for a situation where a wall is not aligned with any of the @xmath58 s direction . on the other hand , the `` complete '' bounceback scheme which assigns each @xmath58",
    "the value of the @xmath120 of its opposite direction with no relaxation on the bounceback nodes is very easy and convenient to apply , the treatment is independent on the direction of @xmath58 s , which is one of the major advantages of lga or lbe method .",
    "several theoretical studies have shown that if the wall is placed at the half way between the bounceback row and the first flow row ( `` half - way wall bounceback '' ) , the scheme gives a second - order accuracy @xcite for some simple flows including an inclined channel flow and a plane stagnation flow .",
    "for example , if the d2q9 model with the half - way wall bounceback is used to simulate the 2-d poiseuille flow with forcing , the error of the velocity ( it is the same for any node ) is given by @xcite @xmath121}{3 } \\delta^2   \\label{eq : errp}\\ ] ] where @xmath122 is the analytical and computed @xmath112-velocity respectively , @xmath27 is the center velocity . for a fixed @xmath123 ,",
    "the error is second - order in the lattice spacing @xmath1 .",
    "of course , large value of @xmath123 will give large errors , which are reported in some papers @xcite , giving an impressed vision how bad the bounceback boundary condition was .",
    "however , for practical purposes , there is no need to take large value of @xmath123 in a simulation . besides",
    ", the chapman - enskog procedure does not work right when @xmath123 is large . for @xmath123 between 0.5 and 1.25 , the magnitude of the error given in ( [ eq : errp ] ) is less than or equal to 1.1 @xmath124 . thus , it is worthwhile to consider this boundary condition in more general situations especially in 3-d flows and some results are reported in section 4.2 , 4.3 and section 5 .      to reduce the effect of compressibility error ,",
    "the model d2q9i is used .",
    "simulations with model d2q9 were also carried out , the results have very similar behavior for order of convergence but the magnitude of error in d2q9 is greater .",
    "we use d2q9i to simulate poiseuille flow with pressure or velocity flow boundary condition . for the half - way wall bounceback ,",
    "if there are @xmath125 nodes on the @xmath59direction , then the first and last nodes are the bounceback nodes with the wall being located half - way between the bounceback node and the first flow node , there are @xmath126 lattice steps across the channel and the lattice spacing is @xmath127 ( in the case of the boundary condition in @xcite @xmath128 ) .",
    "the length of the channel is set to twice as the width . at the inlet / outlet",
    ", the bounceback is also used at the nodes on the bounceback rows , thus , there is no additional treatment for the corner nodes at the inlet / outlet .",
    "two inlet / outlet ( i / o ) conditions with the half - way wall bounceback were tested :    1 .",
    "1 : the flow boundary condition given in this paper .",
    "2 : the flow boundary condition proposed in @xcite . it assumes an additional layer of nodes beyond the boundary flow nodes and uses an extrapolation formula to derive the incoming @xmath58 s of the additional layer before streaming .",
    "the i / o and boundary condition in @xcite were also used to compare result with the the half - way wall bounceback .",
    "for the study of accuracy , we fix @xmath123 and the reynolds number ( which affects stability ) and halve @xmath1 each time and calculated the error in the result .",
    "simulations with different re and @xmath129 are performed .",
    "three examples with pressure specified at inlet and outlet are reported on table i , the example uses three sets of parameters : ( 1 ) @xmath130 , re = 10 , ( 2 ) @xmath131 re = 10 , and ( 3 ) @xmath132 re = 1 ( re is restricted so that @xmath27 for the smallest number of lattice nodes is still small ) , and @xmath133 . the quantity @xmath99 in eq .",
    "( [ eq : stea ] ) is set to @xmath134 .",
    "as @xmath1 halves , @xmath27 also halves , so does the mach number , the same way as in the study of duct flow in @xcite . as @xmath1 changes , @xmath135 and the effective pressure gradient @xmath109 and then pressure ( density ) at inlet / outlet also changes .",
    "@xmath136 are used to represent the number of lattice steps in @xmath35 and @xmath59directions , we use @xmath137 respectively to do the simulation",
    ".    the convergence result is summerized in table  i. the ratio of two consecutive maximum relative errors is also shown .",
    "the order of convergence from a least - square fitting ( a linear least - squares fitting to logarithms of error and @xmath1 ) is shown in the last column .",
    "for the cases of i / o nos . 1 , 2 with the half - way wall bounceback , the maximum relative velocity errors are very close",
    ", the ratio is approximately equal to 4 , indicating a second - order accuracy .",
    "the magnitude of errors in the half - way wall bounceback is close to ( sometimes smaller than ) the result using i / o and boundary condition in @xcite . for the cases of the half - way wall bounceback",
    ", it is also observed that    * velocity @xmath111 is generally uniform in the @xmath35direction .",
    "* @xmath113 is small compared to @xmath27 , with maximum of @xmath114 being less than @xmath138 in all cases . as @xmath139 increases , the maximum of @xmath140 decreases .",
    "2 gives much smaller @xmath141 than i / o no .",
    "the density is approximately uniform in the cross channel direction , and linear in the flow direction .",
    "the maximum relative density error is much less than the maximum relative velocity error and it decreases much faster than the maximum relative velocity error as @xmath139 increases .",
    "the density gradient @xmath142 is approximately equal to the analytical value .",
    "2 gives almost the exact density distribution .",
    "of course , the achievement of second - order accuracy for poiseuille flow does not necessarily mean a second - order accuracy for any flow , in next section , a 3-d duct flow will be studied .",
    "another important issue is the stability related to boundary conditions .",
    "it is found that the combination of bounceback without collision on stationary walls with equilibrium distribution at flow boundaries gives the best behavior on stability .",
    "once any boundary condition or flow boundary condition in any of the schemes in @xcite or in this paper is used , the maximum re number is reduced dramatically . for example , in the simulation of poiseuille flow with bounceback at the wall and equilibrium scheme with velocity inlet and density outlet conditions ( in the case , if density are prescribed at both inlet and outlet , the velocity is significantly smaller than the intended value for high re flows ) and with @xmath143 , @xmath144 , the maximum re is 500 . the maximum re reduces to 63 , 56",
    "respectively for density inlet / outlet condition no .",
    "2 with bounceback boundary condition on the walls .",
    "the maximum re further reduces to 42 , 12 respectively for density inlet / outlet condition and boundary conditions in this paper and in @xcite .",
    "it is also noted that when the parameter are close to the region of instability , the simulation may have unusual large errors . on this account ,",
    "the half - way wall bounceback is safer .",
    "since 3-d model is needed in practical problems , this section will discuss the pressure or velocity flow boundary condition for the 3-d 15-velocity lbgk model d3q15 and an incompressible model d3q15i similar to d2q9i and present some simulation results .",
    "the model d3q15 is based on the lbgk equation eq .",
    "( [ eq : lbgk ] ) with @xmath145 , where @xmath146 are the column vectors of the following matrix : @xmath147\\ ] ] and @xmath148 are classified as type i , @xmath149 are classified as type ii .",
    "the density per node , @xmath9 , and the macroscopic flow velocity , @xmath150 , are defined in terms of the particle distribution function by @xmath151 the equilibrium can be chosen as : @xmath152 the model d3q15i is constructed from these formulas in a similar way as in d2q9i .",
    "the flow to be studied in the 3-d case is the square duct flow with @xmath35 direction being the flow direction .",
    "it is clear to give a projection of the velocities in the @xmath153 plane as shown in fig .",
    "1 . the macroscopic equations of the model is the same as eqs .",
    "( [ eq : cont],[eq : momen ] ) with @xmath154 , and @xmath155 .",
    "the pressure flow boundary condition proposed in 3.1 has the following version for the model d3q15 : take the case of an inlet node as shown in fig .  1 , the inlet is on @xmath156 plane . after streaming , @xmath157",
    "are known , suppose that @xmath158 are specified on the inlet , we need to determine @xmath159 and @xmath34 from eqs .",
    "( [ eq:3ddens ] ) .",
    "similar to the derivation in d2q9 , @xmath34 is determined by a consistency condition as : @xmath160 , \\label{eq:3din1}\\ ] ] the expression of @xmath35 momentum gives : @xmath161 if we use bounceback rule for the non - equilibrium part of the particle distribution @xmath162 to set @xmath163 then eq .",
    "( [ eq:3dux ] ) is satisfied , and all @xmath58 are defined . in order to get the correct @xmath164momenta , we further fix this @xmath70 ( bounceback of non - equilibrium @xmath58 in the normal direction ) and modify @xmath165 as in @xcite : @xmath166 this modification leaves @xmath35momentum unchanged but adds @xmath167 to the @xmath164momenta respectively",
    ". a suitable choice of @xmath168 and @xmath169 then gives the correct @xmath164momenta .",
    "finally , we find : @xmath170 , \\;\\ ; i = 7,9,11,13 \\label{eq:3din2}\\end{aligned}\\ ] ] there is no special treatment at the wall of the inlet / outlet if bounceback is used there .",
    "modification of the flow boundary condition for d3q15i is similar to d2q9i .",
    "the velocity flow boundary condition can be derived similarly .",
    "simulations on 3-d square duct flow are performed on d3q15i and on d3q15 using the pressure flow boundary condition .",
    "only the result of d3q15i is reported , the result of d3q15 is similar but the errors are greater .",
    "the analytical solution of a flow in an infinitely long rectangular duct @xmath171 with @xmath112 being the flow direction is given by @xcite @xmath172    \\frac{\\cos(i\\pi y/2a)}{i^3 } . \\ \\",
    "\\label{eq : duct}\\ ] ] we use @xmath173 in the simulations",
    ". results of the following boundary conditions are reported : ( 1 ) i / o no .",
    "1 ( the i / o condition discussed above ) with the half - way wall bounceback at walls ; + ( 2 ) i / o no . 2 ( the i / o condition in @xcite ) with the half - way wall bounceback at walls ; + ( 3 ) i / o and boundary conditions in @xcite .",
    "+ ( 4 ) i / o and boundary conditions in @xcite .",
    "+ ( 5 ) i / o no .",
    "2 with the original bounceback , which is the bounceback at wall nodes without collision ( only for the middle example ) . + the i / o no .",
    "1 with solid boundary condition in [ 10 ] is also tried , the result on velocity is very close to that in case ( 4 ) and is not reported .",
    "again , we fix @xmath123 and the reynolds number , halve @xmath1 each time .",
    "simulations with different re and @xmath129 are performed .",
    "three examples are reported on table ii : ( 1 ) @xmath130 , re = 10 , ( 2 ) @xmath174 , re = 5 , ( 3 ) @xmath175 , re = 0.2 , and all use @xmath133 . the quantity @xmath99 in the 3-d version of eq .",
    "( [ eq : stea ] ) is set as @xmath134 .",
    "define @xmath176 to represent the number of lattice steps in @xmath35 and @xmath177directions respectively , we use @xmath178 respectively to do the simulation . the maximum relative error is defined similar to eq .",
    "( [ eq : err1 ] ) . from table",
    "ii , we can see that the results of the half - way wall bounceback give an accuracy close to second - order , so do the boundary conditions in @xcite .",
    "besides , the errors with the half - way wall bounceback are comparable with that using the i / o and boundary conditions in @xcite . on the other hand , the original bounceback introduces an error of first - order throughout the flow ( l1 error has a similar first - order behavior ) .",
    "thus , the half - way wall bounceback has an essentially different behavior than the original bounceback .",
    "the calculated density has smaller errors than that of the velocity , and the density is less uniform across a section in the duct than in 2-d case .    it is noted that the orders of convergence in the case of 3-d duct flow with all boundary conditions considered are not as good as in 2-d poiseuille flows .",
    "for example , the ratios of errors at the highest resolution are not very close to 4 in some cases ( the order of convergence may be close to 2 in the cases because of an irregular large error ratio at a coarser resolution ) .",
    "it looks that in 3-d duct flow , the four edges pose additional difficulties to boundary conditions .",
    "even with forcing , the density is not uniform in a cross section for the half - way wall bounceback or for boundary conditions in @xcite . nevertheless , the order of convergence for 3-d duct flow is still close to 2 .",
    "the half - way wall bounceback has a weaker convergence when @xmath179 while the boundary condition in @xcite performs better as @xmath180 but worse as @xmath181 . on the consideration of simplicity in implementation and superior stability behavior of the half - way wall bounceback",
    ", we think that it deserves a serious consideration in a lbgk simulation .",
    "we would like to point out that a second - order accuracy of the half - way wall bounceback in the flows considered does not imply a second - order accuracy for any flows .",
    "the statement can be applied to other boundary conditions as well .",
    "one is encouraged to do some tests on a simplified flow of the type of flows to be simulated .",
    "the major results in this paper are : first , flow boundary conditions can be treated in a similar way as wall boundary conditions , and a new way to specify flow boundary conditions based on bounceback of non - equilibrium part is proposed . for the test problem of poiseuille flow with pressure or velocity inlet / outlet conditions ,",
    "the new method recovers the analytic solution within machine accuracy .",
    "second , we reconsider the the half - way wall bounceback boundary condition for stationary walls .",
    "it is very easy to implement .",
    "if being applied with flow boundary condition in this paper or in @xcite , it is approximately of second - order accuracy for the 2-d and 3-d channel flows with @xmath8 being less than or close to one .",
    "the magnitude of the error is comparable with that using some published boundary conditions .",
    "hence , the the half - way wall bounceback is recommended for stationary walls . for flow boundary conditions in simulations of small to moderate re numbers ,",
    "one may consider the schemes in this paper or in @xcite .",
    "for the cases considered , these flow boundary conditions give very close results in velocity .",
    "the scheme in @xcite gives a better density distribution but a weaker stability behavior .",
    "one can also use the equilibrium distribution scheme if @xmath182 can be used .",
    "however , for simulations of large re flows , one may have to use the equilibrium flow boundary condition with velocity inlet condition and with @xmath8 close to 0.5 .",
    "in that situation , the accuracy is only first - order .",
    "discussions with r. maier , r. bernard are appreciated . q.z .",
    "would like to thank the associated western universities inc . for providing a fellowship and to thank g. doolen and s. chen for helping to arrange his visit to the los alamos national lab .",
    "some computations are performed on the convex exempler spp-1000 of kansas state university .",
    "q.z . would like to thank nsf grant number dmr-9413513 which provided fund for the acquisition of the machine .",
    "99    q. zou , s. hou , s. chen and g.d .",
    "doolen , `` an improved incompressible lattice boltzmann model for time - independent flows , '' _ j. stat .",
    "_ , * 81 * , 35 ( 1995 ) .    s. chen , d.o .",
    "martinez and renwei mei , `` on boundary conditions in lattice boltzmann methods '' , _ phys .",
    "fluids _ * 8 * , 2527 ( 1996 ) .",
    "s. succi , d. dhumires , y. qian and s.a .",
    "orszag , `` on the small - scale dynamical behavior of lattice bgk and lattice boltzmann schemes , '' _ j. of sci .. comput . _",
    "* 8 * , 219 ( 1993 ) .",
    "q. zou , s. hou and g.d .",
    "doolen , `` analytical solutions of the lattice boltzmann bgk model , '' _ j. stat .",
    "_ , * 81 * , 319 ( 1995 ) .",
    "x. he , q. zou , l.s .",
    "luo and m. dembo , `` analytic solutions of simple flows and non - slip boundary condition for the lattice boltzmann bgk model , '' to appear in j. stat .",
    "phys .    d.r .",
    "noble , s. chen , j.g .",
    "georgiadis , r.o .",
    "buckius , `` a consistent hydrodynamic boundary condition for the lattice boltzmann method , '' _ phys .",
    "fluids _ * 7 * , 203 ( 1995 ) .",
    "grunau phd thesis , colorado state university , 1993 .",
    "skordos , `` initial and boundary conditions for the lattice boltzmann method '' , phys .",
    "e * 48 * , 4823 ( 1993 ) .",
    "t. inamuro , m. yoshino , and f. ogino , `` a non - slip boundary condition for lattice boltzmann simulations , '' _ phys .",
    "fluids _ * 7 * , 2928 ( 1996 ) .",
    "r. s. maier , r. s. bernard and d. w. grunau , `` boundary conditions for the lattice boltzmann method '' , _ phys .",
    "fluids _ * 8 * , 1788 ( 1996 ) .",
    "s. chen , h. chen , d.o .",
    "martinez and w.h .",
    "matthaeus , `` lattice boltzmann model for simulation of magnetohydrodynamics , '' _ phys .",
    "_ , * 67 * , 3776 ( 1991 ) .",
    "y. qian , d. dhumires and p. lallemand , `` recovery of navier - stokes equations using a lattice - gas boltzmann method , '' _ europhys .",
    "_ * 17 * ( 6 ) , 479 ( 1992 ) .",
    "h. chen , s , chen , and w. h. matthaeus , `` recovery of navier - stokes equations using a lattice - gas boltzmann method , '' _ phys .",
    "a _ * 45 * , 5771 ( 1992 ) .    y. h. qian and s. a. orszag , `` lattice bgk models for navier - stokes equation , '' _ europhys",
    "* 21 * ( 3 ) , 255 ( 1993 ) .",
    "s. hou , q. zou , s. chen , g. d. doolen , and a. c. cogley , `` simulation of cavity flow by the lattice boltzmann method , '' j. comp . phys . * 118 * , 329 ( 1995 ) .",
    "noble , j.g .",
    "georgiadis , r.o .",
    "buckius , `` direct assessment of lattice boltzmann hydrodynamics and boundary conditions for recirculating flows , ''",
    "_ j. stat .",
    "_ , * 81 * , 17 ( 1995 ) .",
    "r. cornubert , d. dhumires and d. levermore , `` a knudsen layer theory for lattice gases '' , physica d , * 47 * ( 6 ) , 241 ( 1991 ) .",
    "i. ginzbourg and p. m. adler , `` boundary flow condition analysis for the three - dimensional lattice boltzmann model , '' j. phys .",
    "ii france * 4 * , 191 ( 1994 ) .",
    "white , _ viscous fluid flow _ , p123 , mcgraw - hill , 1974 .",
    "table i. maximum relative errors for the 2-d poiseuille flow with pressure being specified at inlet and outlet for three cases : ( 1 ) re=10 , @xmath130 , ( 2 ) re=10 , @xmath174 , ( 3 ) re=1 , @xmath175 .",
    "the results of two pressure flow boundary conditions i / o nos .",
    "1,2 with the half - way wall bounceback ( hwwbb ) and the result of the i / o and boundary conditions in [ 2 ] are given . in each box , the upper figure is the error , and the lower figure is the ratio of two consecutive errors .",
    "the last column shows the order of convergence using the least - squares fitting .",
    "the symbol ( -2 ) represents @xmath183 .",
    "+    [ cols=\"<,^ , < , < , < , < , < , < \" , ]",
    "1 , schematic plot of velocity directions of the 2-d ( d2q9 ) model and projection of 3-d ( d3q15 ) model in a channel . in the 3-d model , the @xmath59axis is pointing into the paper , so are velocity directions 3,7,9,12,14 ( they are in parentheses if shown ) , while the velocity directions 4,8,10,11,13 are pointing out .",
    "velocity directions 3,4 have a projection at the center and are not shown in the figure ."
  ],
  "abstract_text": [
    "<S> pressure ( density ) and velocity boundary conditions inside a flow domain are studied for 2-d and 3-d lattice boltzmann bgk models ( lbgk ) and a new method to specify these conditions are proposed . </S>",
    "<S> these conditions are constructed in consistency of the wall boundary condition based on an idea of bounceback of non - equilibrium distribution . when these conditions are used together with the improved incompressible lbgk model @xcite </S>",
    "<S> , the simulation results recover the analytical solution of the plane poiseuille flow driven by pressure ( density ) difference with machine accuracy . since the half - way wall bounceback boundary condition is very easy to implement and was shown theoretically to give second - order accuracy for 2-d poiseuille flow with forcing , it is used with pressure ( density ) inlet / outlet conditions proposed in this paper and in @xcite to study the 2-d poiseuille flow and the 3-d square duct flow . </S>",
    "<S> the numerical results are approximately second - order accurate . </S>",
    "<S> the magnitude of the error of the half - way wall bounceback is comparable with that using some other published boundary conditions . besides , the bounceback condition has a much better stability behavior than that of other boundary conditions .    </S>",
    "<S> # 1by # 1 # 1by # 1    6.4 in 8.6 in    key words : lattice boltzmann method ; boundary condition ; pressure boundary condition ; velocity inlet condition ; poiseuille flow .    </S>",
    "<S> pacs numbers : 47.1.45.-x ; 47.60.+l </S>"
  ]
}