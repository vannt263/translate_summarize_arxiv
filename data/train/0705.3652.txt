{
  "article_text": [
    "in this paper , we consider second- and third - harmonic generation in doubly resonant cavities .",
    "we generalize previous experimental and theoretical work on this subject , which had focused only on @xmath0 nonlinearities in large fabry - perot etalons or two - dimensional ring resonators where a scalar approximation applied  @xcite , to incorporate both @xmath0 and @xmath1 nonlinearities and handle the inhomogenous fully vectorial case .",
    "we then develop several results from this generalization : whereas it is well known that 100% harmonic conversion is possible , at least in @xmath0 media , in this work we further explore and identify the conditions under which this can be achieved .",
    "first , we demonstrate the existence of a critical input power at which harmonic generation is maximized , in contrast to previous work that focused largely on the low - power limit in which generation efficiency increased monotonically with input power  @xcite .",
    "second , while it is well known that harmonic conversion can be achieved at arbitarily low powers given sufficiently long cavity lifetimes , this implies a narrow bandwidth  we show that , by combining moderate lifetimes ( 0.1% bandwidth ) with tight spatial confinement , 100% second- and third - harmonic conversion can theoretically be achieved with sub - milliwatt power levels",
    ". such low - power conversion could find applications such as high - frequency sources  @xcite , ultracompact - coherent optical sources  @xcite , imaging  @xcite , and spectroscopy  @xcite .",
    "nonlinear frequency conversion has been commonly realized in the context of waveguides  @xcite , or even for free propagation in the nonlinear materials , in which light at one frequency co - propagates with the generated light at the harmonic frequency  @xcite .",
    "a phase - matching condition between the two frequencies must be satisfied in this case in order to obtain efficient conversion  @xcite .",
    "moreover , as the input power is increased , the frequency conversion eventually saturates due to competition between up and down conversion .",
    "frequency conversion in a doubly resonant cavity has three fundamental differences from this familiar case of propagating modes .",
    "first , light in a cavity can be much more intense for the same input power , because of the spatial ( modal volume @xmath2 ) and temporal ( lifetime @xmath3 ) confinement .",
    "we show that this enhances second - harmonic ( @xmath0 ) conversion by a factor of @xmath4 and enhances third - harmonic ( @xmath1 ) conversion by a factor of @xmath5 .",
    "second , there is no phase - matching condition per se for 100% conversion ; the only absolute requirement is that the cavity support two modes of the requisite frequencies .",
    "however , there is a constant factor in the power that is determined by an overlap integral between the mode field patterns ; in the limit of a very large cavity , this overlap integral recovers the phase - matching condition for @xmath0 processes .",
    "third , the frequency conversion no longer saturates ",
    "instead , it peaks ( at 100% , with proper design ) for a certain critical input power satisfying a resonant condition , and goes to _ zero _ if the power is _ either _ too small or too large .    second - harmonic generation in cavities with a single resonant mode at the pump frequency  @xcite or the harmonic frequency",
    "@xcite requires much higher power than a doubly resonant cavity , approaching one watt  @xcite and/or requiring amplification within the cavity .",
    "( a closely related case is that of sum - frequency generation in a cavity resonant at the two frequencies being summed  @xcite . )",
    "second - harmonic generation in a doubly resonant cavity , with a resonance at both the pump and harmonic frequencies , has most commonly been analyzed in the low - efficiency limit where nonlinear down - conversion can be neglected  @xcite , but down - conversion has also been included by some authors  @xcite . here",
    ", we show that not only is down - conversion impossible to neglect at high conversion efficiencies ( and is , in fact , necessary to conserve energy ) , but also that it leads to a critical power where harmonic conversion is maximized . this critical power was demonstrated numerically by ref .   in a sub - optimal geometry where 100% efficiency is impossible , but does not seem to have been clearly explained theoretically ; the phenomenon ( for @xmath0 ) was also implicit in the equations of ref .   but was not identified , probably because it occurred just beyond the range of power considered in that work .    )",
    "is coupled to a cavity mode ( amplitude @xmath6 ) , converted to a cavity mode at another frequency ( amplitude @xmath7 ) by a nonlinear process , and radiated back into the waveguide ( amplitude @xmath8 ) .",
    "reflections at the first frequency ( @xmath9 ) may also occur .",
    "_ bottom : _",
    "1d example , formed by quarter - wave defect in a quarter - wave dielectric stack .",
    "dielectric material is yellow , and electric field @xmath10 of third - harmonic mode is shown as blue / white / red for positive / zero / negative amplitude.,width=264 ]    previous work on third - harmonic generation in cavities considered only singly resonant cavities ; moreover , past work focused on the case of @xmath0 materials where @xmath11 is generated by cascading two nonlinear processes ( harmonic generation and frequency summing ) @xcite . here",
    ", we examine third - harmonic generation using @xmath1 materials so that only a single resonant process need be designed and a different set of materials becomes available .",
    "( @xmath1 third - harmonic generation in a bulk periodic structure , with no cavity , was considered in ref .  . ) in a @xmath1 medium , there are also self / cross - phase modulation phenomena ( nonlinear frequency shifts ) that , unchecked , will prevent 100% conversion by making the frequency ratio @xmath12 . to address this mismatch , we describe how one can use two materials with opposite - sign @xmath1 to cancel the frequency - shifting effect ; it may also be possible to pre - shift the cavity resonant frequency to correct for the nonlinear shift .",
    "on the other hand , a @xmath0 medium has no self - phase modulation , and so in this case it is sufficient to increase the input power until 100% frequency conversion is reached .",
    "( an `` effective '' self - phase modulation occurs in @xmath0 media due to cascaded up- and down - conversion processes  @xcite , but these processes are fully taken into account by our model .",
    "we also consider media with simultaneous @xmath0 and @xmath1 nonlinearities , and show that the latter can be made negligible . )",
    "if the critical field were too intense , then material breakdown might also be an obstacle , but we show that it is sufficient to use modes with a large lifetime @xmath3 and small volume @xmath2 so that a slow conversion due to a weak nonlinear effect has enough time to occur .",
    "in particular , we consider the general situation depicted schematically in fig .",
    "[ fig1 ] : a two - mode nonlinear cavity coupled to an input / output channel .",
    "for example , a one - dimensional realization of this is shown in fig .",
    "[ fig1 ] : a fabry - perot cavity between two quarter - wave stacks  @xcite , where the stack has fewer layers on one side so that light can enter / escape . for a nonlinear effect ,",
    "we consider specifically a @xmath13 nonlinearity , corresponding essentially to a shift in the refractive index proportional to the nonlinear susceptibility @xmath13 multiplied by electric field @xmath14 to the @xmath15 power .",
    "most commonly , one would have either a @xmath0 ( pockels ) or @xmath1 ( kerr ) effect .",
    "such a nonlinearity results in harmonic generation  @xcite : light with frequency @xmath16 is coupled to light with frequency @xmath17 .",
    "therefore , if we design the cavity so that it supports two modes , one at @xmath16 and one at @xmath17 , then input power at @xmath16 can be converted , at least partially , to output power at @xmath17 .    in the following ,",
    "we derive a semi - analytical description of harmonic generation using the framework of coupled - mode theory  @xcite , and then check it via direct numerical simulation of the nonlinear maxwell equations  @xcite . for maximum generality , we derive the coupled - mode equations using two complementary approaches",
    ". first , we use `` temporal '' coupled - mode theory  @xcite , in which the general form of the equations is determined only from principles such as conservation of energy and reciprocity , independent of the specific physical problem ( for example , electromagnetic or acoustic waves ) .",
    "second , we apply perturbation theory directly to maxwell s equations in order to obtain the same equations but with specific formulas for the coupling coefficients in terms of the linear eigenmodes . unlike most previous treatments of this problem  @xcite , we do not make a one - dimensional or scalar approximation for the electromagnetic fields ( invalid for wavelength - scale cavities ) , and we consider both @xmath0 and @xmath1 media .",
    "( the optimization of these coupling coefficients is then the generalization of the phase - matching criteria used in one - dimensional geometries  @xcite . )",
    "we derive coupled - mode equations describing the interaction of light in a multi - mode cavity filled with nonlinear material and coupled to input / output ports , from which light can couple in ( @xmath18 ) and out ( @xmath19 ) of the cavity . a schematic illustration of the system is shown in fig .  [ fig1 ] .",
    "specifically , we follow the formalism described in ref .  , adapted to handle nonlinearly coupled modes with frequencies @xmath20 .",
    "although similar equations for the case of @xmath0 media were derived in the past  @xcite , they do not seem to have been derived for @xmath1 harmonic generation in cavities .",
    "moreover , a derivation via the temporal coupled - mode formalism of ref .",
    "is arguably more general than earlier developments based on a particular scalar nonlinear wave equation , because this formalism ( for a given - order nonlinearity ) depends only on general considerations such as weak coupling and energy conservation ( the resulting equations hold for vector or scalar waves in electromagnetism , acoustics , or any other weakly - coupled problem with a few simple properties ) . in the next section , we will then specialize the equations to electromagnetism by deriving explicit equations for the coupling coefficients from maxwell s equations .",
    "we let @xmath21 denote the time - dependent complex amplitude of the @xmath22th mode , normalized so that @xmath23 is the electromagnetic energy stored in this mode .",
    "we let @xmath24 denote the time - dependent amplitude of the incoming ( @xmath25 ) or outgoing ( @xmath26 ) wave , normalized so that @xmath27 is the power .",
    "( more precisely , @xmath28 is normalized so that its fourier transform @xmath29 is the power at @xmath16 .",
    "later , we will let @xmath30 denote the input / output power at @xmath20 . )",
    "[ in 1d , the units of @xmath23 and @xmath27 are those of energy and power per unit area , respectively .",
    "more generally , in @xmath31 dimensions , the units of @xmath23 and @xmath27 are those of energy and power per @xmath32 . ] by itself , a linear cavity mode decaying with a lifetime @xmath33 would be described by @xmath34 .",
    "[ technically , such a decaying mode is not a true eigenmode , but is rather a `` leaky mode ''  @xcite , corresponding to a `` quasi - bound state '' in the breit - wigner scattering theory  @xcite . ]",
    "the decay rate @xmath35 can be decomposed into @xmath36 where @xmath37 is the `` external '' loss rate ( absorption etc . ) and @xmath38 is the decay rate into @xmath39 .",
    "when the weak coupling ( @xmath40 ) to @xmath41 is included , energy conservation and similar fundamental constraints lead to equations of the form  @xcite :    @xmath42    this can be generalized to incorporate multiple input / output ports , direct coupling between the ports , and so on  @xcite .",
    "the only unknown parameters in this model are then the frequencies @xmath20 and the decay rates @xmath35 , which can be determined by any numerical method to solve for the cavity modes ( e.g. fdtd , below )",
    ". instead of @xmath33 , one commonly uses the quality factor @xmath43 .",
    "nonlinearity modifies this picture with two new amplitude - dependent effects : a shift in the frequency ( and decay rate ) of the cavity , and a coupling of one cavity mode to another .",
    "we neglect nonlinear effects on the input / output ports , under the assumption that intense fields are only present in the cavity ( due to spatial and temporal confinement ) .",
    "we will also make two standard assumptions of nonlinear systems .",
    "first , that the nonlinearities are weak , in the sense that we can neglect terms of order @xmath44 or higher ; this is true in practice because nonlinear index shifts are always under 1% lest material breakdown occur .",
    "second , we make the rotating wave approximation : since the coupling is weak , we only include terms for @xmath21 that have frequency near @xmath20 .",
    "in particular , we suppose that @xmath45 , so that @xmath20 is the @xmath22th harmonic .",
    "the result is that , for a given order nonlinearity , there are only a few possible new terms that can appear in the coupled - mode equations . in particular , for a @xmath0 nonlinearity with two modes @xmath46 and its second harmonic @xmath47 , the coupled - mode equations must take the form : @xmath48 similarly , for a @xmath1 nonlinearity with two modes @xmath46 and its third harmonic @xmath49 , the coupled - mode equations must take the form :    @xmath50    in equations  [ chi3a][chi3b ] , one sees two kinds of terms .",
    "the first are _ frequency - shifting _ terms , with coefficients @xmath51 , dependent on one of the field amplitudes . for @xmath1 , this effect",
    "is known as self - phase and cross - phase modulation , which is absent for @xmath0 ( under the first - order rotating - wave approximation ) . the second kind of term _ transfers energy _ between the modes , with coupling coefficients @xmath52 , corresponding to four - wave mixing for @xmath1 .",
    "furthermore , we can constrain the coupling terms @xmath52 by energy conservation : @xmath53 . for @xmath0 ,",
    "the constraint that follows is : @xmath54 ; for @xmath1 , the constraint is @xmath55 .",
    "( this constraint holds even in cavities with external loss as discussed in sec .",
    "[ sec : loss ] : energy is still conserved in the sense that the input power must equal the output power plus the loss power , and so the harmonic conversion term must lead to an equal energy loss and gain at @xmath46 and @xmath56 , respectively . )    the general process for construction of these coupled - mode equations is as follows .",
    "the underlying nonlinearity must depend on the physical , real part of the fields , corresponding to @xmath57 .",
    "it then follows that the @xmath13 term will have @xmath58 powers of this real part , giving various product terms like @xmath59 ( for @xmath0 ) and @xmath60 ( for @xmath1 ) .",
    "most of these terms , however , can be eliminated by the rotating - wave approximation .",
    "in particular , we assume that each @xmath21 term is proportional to @xmath61 multiplied by a slowly varying envelope , and we discard any product term whose total frequency differs from @xmath62 for the @xmath63 equation .",
    "thus , a term like @xmath64 would be proportional to @xmath65 , and would only appear in a @xmath66 equation .",
    "( we focus on the simpler case of doubly resonant cavities in this paper . )    at this point , the equations are already useful in order to reason about what types of qualitative behaviors are possible in general . in fact , they are not even specific to electromagnetism and would also apply to other situations such as acoustic resonators .",
    "however , in order to make quantitative predictions , one needs to know the nonlinear coefficients @xmath51 and @xmath52 ( as well as the linear frequencies and decay rates ) .",
    "the evaluation of these coefficients requires a more detailed analysis of maxwell s equations as described below .",
    "in this section , we derive explicit formulas for the nonlinear coupling coefficients in the coupled - mode theory of the previous section , applied to the case of electromagnetism .",
    "unlike previous work , our expressions apply to the fully vectorial equations , valid for high index - contrast materials , and we derive the @xmath1 case as well as @xmath0 .",
    "our derivation is closely related to that of ref .  , which only considered the frequency shifting ( self - phase modulation ) and not harmonic generation .",
    "when a dielectric structure is perturbed by a small @xmath67 , a well - known result of perturbation theory states that the corresponding change @xmath68 in an eigenfrequency @xmath16 is , to first order  @xcite : @xmath69 where @xmath14 is the unperturbed electric field and @xmath70 is the change in polarization density due to @xmath67 .",
    "in fact , eq .  [ genpert ] is general enough to be used with any @xmath71 , including the polarization that arises from a nonlinear susceptibility . in particular",
    ", we can use it to obtain the coupling coefficients of the cmt .    to do so",
    ", we first compute the nonlinear first - order frequency perturbation due to the total field @xmath14 present from all of the modes .",
    "once the frequency perturbations @xmath72 are known , we can re - introduce these into the coupled - mode theory by simply setting @xmath73 in eq .",
    "[ eq1 ] . by comparison with eqs .",
    "[ chi2a][chi3b ] , we can then identify the @xmath74 and @xmath75 coefficients .",
    "we consider first a @xmath0 nonlinearity , with the nonlinear polarization @xmath76 given by @xmath77 , in a cavity with two modes @xmath78 and @xmath79 .",
    "as before , we require that the modes oscillate with frequency @xmath46 and @xmath80 , respectively .",
    "taking @xmath81 $ ] and using the rotating - wave approximation , we can separate the contribution of @xmath76 to each @xmath72 , to obtain the following frequency perturbations : @xmath82}{\\int d^3{\\mathbf{x } } \\varepsilon      \\left|{\\mathbf{e}}_1\\right|^2 } \\\\",
    "\\frac{\\delta\\omega_2}{\\omega_2 } & = -      \\frac{1}{4}\\frac{\\int d^3{\\mathbf{x } } \\hspace{0.02 in } \\sum_{ijk }      \\varepsilon { { \\chi^{(2)}}}_{ijk } \\hspace{0.02 in }      { e_{2 i}}^*{e_{1 j}}{e_{1 k}}}{\\int d^3{\\mathbf{x } } \\hspace{0.02 in }      \\varepsilon \\left|{\\mathbf{e}}_2\\right|^2 }",
    "\\\\ \\nonumber\\end{aligned}\\ ] ] similarly , for a centro - symmetric @xmath1 medium , @xmath76 is given by @xmath83 , with @xmath84 $ ] .",
    "we obtain the following frequency perturbations :    @xmath85\\end{aligned}\\ ] ]    @xmath86\\end{aligned}\\ ] ]    there is a subtlety in the application of perturbation theory to decaying modes , such as those of a cavity coupled to output ports . in this case , the modes are not truly eigenmodes , but are rather `` leaky modes ''  @xcite , and are not normalizable .",
    "perturbative methods in this context are discussed in more detail by  @xcite , but for a tightly confined cavity mode it is sufficient to simply ignore the small radiating field far away from the cavity .",
    "the field in the cavity is very nearly that of a true eigenmode of an isolated cavity .",
    "as stated above , we can arrive at the coupling coefficients by setting @xmath73 in eq .",
    "however , the frequency perturbations @xmath72 are time - independent quantities , and we need to connect them to the time - dependent @xmath21 amplitudes . therefore , to re - introduce the time dependence , one can use the slowly varying envelope approximation : a slowly varying , time - dependent amplitude @xmath87 is introduced into the unperturbed fields @xmath88 .",
    "the eigenmode must be normalized so that @xmath23 is the energy , as assumed for the coupled - mode theory .",
    "thus , we divide each @xmath89 by @xmath90 .",
    "first , we consider the @xmath0 medium .",
    "carrying out the above substitutions in eq .",
    "[ eq1 ] and grouping terms proportional @xmath21 yields eqs .",
    "[ chi2a][chi2b ] with @xmath51 and @xmath52 given by :    @xmath91}{\\left[\\int d^3{\\mathbf{x } } \\hspace{0.05 in } \\varepsilon      \\left|{\\mathbf{e}}_1\\right|^2\\right ] \\left[\\int d^3{\\mathbf{x } } \\hspace{0.05 in } \\varepsilon \\left|{\\mathbf{e}}_2\\right|^2\\right]^{1/2 } } \\\\",
    "\\beta_2 & = \\frac{1}{4}\\frac{\\int d^3{\\mathbf{x } }      \\hspace{0.05 in } \\sum_{ijk } \\varepsilon { { \\chi^{(2)}}}_{ijk } \\hspace{0.02 in }      { e_{2 i}}^*{e_{1 j}}{e_{1 k}}}{\\left[\\int d^3{\\mathbf{x } } \\hspace{0.05 in } \\varepsilon      \\left|{\\mathbf{e}}_1\\right|^2\\right ] \\left[\\int d^3{\\mathbf{x } } \\hspace{0.05 in } \\varepsilon \\left|{\\mathbf{e}}_2\\right|^2\\right]^{1/2 } } \\end{aligned}\\ ] ]    a similar calculation yields the @xmath1 coupled - mode equations with coefficients given by :    @xmath92 ^ 2 } \\\\",
    "\\alpha_{31 } & =      \\frac{1}{4 } \\frac{\\int d^3{\\mathbf{x } } \\hspace{0.05 in } \\varepsilon { { \\chi^{(3)}}}\\left|{\\mathbf{e}}_1\\right|^2\\left|{\\mathbf{e}}_3\\right|^2 +      \\left|{\\mathbf{e}}_1\\cdot{\\mathbf{e}}_3\\right|^2 +      \\left|{\\mathbf{e}}_1\\cdot{\\mathbf{e}}^*_3\\right|^2}{\\left[\\int d^3{\\mathbf{x } }      \\hspace{0.05 in } \\varepsilon \\left|{\\mathbf{e}}_1\\right|^2 \\right ]      \\left[\\int d^3{\\mathbf{x } } \\hspace{0.05 in } \\varepsilon      \\left|{\\mathbf{e}}_3\\right|^2 \\right ] } \\\\ \\alpha_{13 } & =      \\alpha_{31 } \\nonumber \\\\ \\beta_1 & = \\frac{3}{8 } \\frac{\\int      d^3{\\mathbf{x } }        \\hspace{0.05 in } \\varepsilon { { \\chi^{(3)}}}({\\mathbf{e}}^*_1\\cdot{\\mathbf{e}}^*_1)({\\mathbf{e}}^*_1\\cdot{\\mathbf{e}}_3)}{\\left[\\int      d^3{\\mathbf{x } } \\hspace{0.05 in } \\varepsilon      \\left|{\\mathbf{e}}_1\\right|^2\\right]^{3/2 } \\left[\\int d^3{\\mathbf{x } }      \\hspace{0.05 in } \\varepsilon      \\left|{\\mathbf{e}}_3\\right|^2\\right]^{1/2 } } \\\\",
    "\\beta_3 & =      \\frac{1}{8 } \\frac{\\int d^3{\\mathbf{x } } \\hspace{0.05 in } \\varepsilon { { \\chi^{(3)}}}({\\mathbf{e}}_1\\cdot{\\mathbf{e}}_1)({\\mathbf{e}}_1\\cdot{\\mathbf{e}}^*_3)}{\\left[\\int      d^3{\\mathbf{x } } \\hspace{0.05 in } \\varepsilon      \\left|{\\mathbf{e}}_1\\right|^2\\right]^{3/2 } \\left[\\int d^3{\\mathbf{x } }      \\hspace{0.05 in } \\varepsilon      \\left|{\\mathbf{e}}_3\\right|^2\\right]^{1/2 } }      \\label{coeff3}\\end{aligned}\\ ] ]    note that eqs .",
    "[ alpha2][coeff3 ] verify the conditions @xmath93 and @xmath94 , previously derived from conservation of energy  for @xmath0 , this requires that one apply the symmetries of the @xmath95 tensor , which is invariant under permutations of @xmath96 for a frequency - independent @xmath0  @xcite .",
    "furthermore , we can relate the coefficients @xmath74 and @xmath75 to an effective modal volume @xmath2 , similar to ref .  .",
    "in particular , the strongest possible nonlinear coupling will occur if the eigenfields are a constant in the nonlinear material and zero elsewhere . in this case , any integral over the fields will simply yield the geometric volume @xmath2 of the nonlinear material .",
    "thus , for the @xmath0 effect we would obtain @xmath97 ; similarly , for the @xmath1 effect we would obtain @xmath98 .",
    "this proportionality to @xmath99 and @xmath100 carries over to more realistic field profiles ( and in fact could be used to _ define _ a modal volume for these effects ) .",
    "to check the predictions of the @xmath1 coupled - mode equations , we performed an fdtd simulation of the one - dimensional waveguide - cavity system shown in fig  [ fig1 ] , whose analytical properties are uniquely suited to third - harmonic generation .",
    "( the fdtd method , including techniques to simulate nonlinear media , is described in ref .  .",
    ") this geometry consists of a semi - infinite photonic - crystal structure made of alternating layers of dielectric ( @xmath101 and @xmath102 ) with period @xmath103 and thicknesses given by the quarter - wave condition ( @xmath104 and @xmath105 , respectively ) .",
    "such a quarter - wave stack possesses a periodic sequence of photonic band gaps centered on frequencies @xmath106 ( in units of @xmath107 ) for the lowest gap , and higher - order gaps centered on odd multiples of @xmath46 .",
    "moreover , a defect formed by doubling the thickness of a @xmath108 layer creates cavity modes at exactly the middle of every one of these gaps .",
    "therefore , it automatically satisfies the frequency - matching condition for third - harmonic generation .",
    "in fact , it is too good : there will also be `` ninth harmonic '' generation from @xmath49 to @xmath109 .",
    "this unwanted process is removed , however , by the discretization error of the fdtd simulation , which introduces numerical dispersion that shifts the higher - frequency modes . to ensure the @xmath110 condition in the face of this dispersion",
    ", we slightly perturbed the structure ( increasing the dielectric constant slightly at the nodes of the third - harmonic eigenfield ) to tune the frequencies .",
    "the simulated crystal was effectively semi - infinite , with many more layers on the right than on the left of the cavity .",
    "on the left of the cavity , after two period of the crystal the material is simply air ( @xmath111 ) , terminated by a perfectly matched layer ( pml ) absorbing boundary region .",
    "we excite the cavity with an incident plane wave of frequency @xmath46 , and compute the resulting reflection spectrum . the reflected power at @xmath49 , the third - harmonic generation ,",
    "was then compared with the prediction of the coupled - mode theory .",
    "the frequencies , decay rates , and @xmath74 and @xmath75 coefficients in the coupled - mode theory were computed from a linear fdtd simulation in which the eigenmodes were excited by narrow - band pulses .",
    "the freely available fdtd code of  @xcite was employed .     vs. @xmath112 for the coupled - mode theory ( grey ) and fdtd ( black squares ) , where @xmath113 is being varied .",
    "also shown are the corresponding @xmath114 ( dashed blue ) and @xmath115 ( solid red ) curves.,width=302 ]    the results are shown in fig .",
    "[ fig2a ] , in which the output power at @xmath46 and @xmath116 is denoted by @xmath117 and @xmath118 , respectively , while the input power at @xmath46 is denoted by @xmath119 . in particular , we plot convenient dimensionless quantities : the third - harmonic conversion efficiency @xmath120 as a function of the dimensionless product @xmath121 in terms of the standard kerr coefficient @xmath122 .",
    "there is clear agreement between the fdtd and cmt for small values of @xmath123 ( in which limit the conversion goes quadratically with @xmath123 ) .",
    "however , as the input power increases , they eventually begin to disagree , marking the point where second - order corrections are required .",
    "this disagreement is not a practical concern , however , because the onset of second - order effects coincides with the limits of typical materials , which usually break down for @xmath124 .",
    "this is why we also plot the maximum index shift @xmath114 in the same figure .",
    "also shown in fig .",
    "[ fig2a ] is a plot of @xmath125 $ ] .",
    "as expected , when @xmath126 is of the order of @xmath127 , the frequency shift begins to destroy the frequency matching condition , substantially degrading the third - harmonic conversion .",
    "( it might seem that @xmath128 and @xmath129 should be comparable , but this is not the case because @xmath128 is the maximum index shift while @xmath129 is due to an average index shift . )    more specifically , the details of our simulation are as follows . to simulate a continuous wave ( cw ) source spectrum in fdtd",
    ", we employ a narrow - bandwidth gaussian pulse incident from the air region , which approximates a cw source in the limit of narrow bandwidth .",
    "this pulse is carefully normalized so that the peak _ intensity _ is unity , to match the cmt .",
    "the field in the air region is fourier transformed and subtracted from the incident field to yield the reflected flux . using only two periods of quarter - wave stack on the left of the cavity we obtained two cavity modes with real frequencies @xmath130 ( 2@xmath131c / a ) , @xmath132 ( 2@xmath131c / a ) and quality factors @xmath133 and @xmath134 , respectively . given these field patterns , we computed the @xmath51 and @xmath52 coefficients .",
    "we obtained the following coupling coefficients , in units of @xmath135 : @xmath136 .",
    "we now consider the conditions under which one may achieve _ complete _ frequency conversion : 100% of the incident power converted to output at the second or third harmonic frequency . as we shall see , this is easiest to achieve in the @xmath0 case , and requires additional design criteria in the @xmath1 case .",
    "the key fact in a @xmath0 medium is that there are no frequency - shifting terms ( @xmath137 ) , so the resonance condition @xmath138 is not spoiled as one increases the power .",
    "the only requirement that we must impose is that external losses such as absorption are negligible ( @xmath139 ) . in this case",
    ", 100% conversion corresponds to setting @xmath140 in the steady - state . using this fact , eqs .",
    "[ chi2a]-[chi2b ] for an input source @xmath141 yields the following condition on the input power for 100% conversion : @xmath142 ( a similar dependence of efficiency on @xmath143 was previously observed  @xcite , although a critical power was not identified . )",
    "thus , we can always choose an input power to obtain 100% conversion .",
    "if @xmath144 , then this critical power scales as @xmath145 where @xmath2 is the modal volume ( recall that @xmath146 )",
    ".    this is limited , however , by our first - order approximation in perturbation theory : if the input power becomes so large that second - order effects ( or material breakdown ) become significant , then this prediction of 100% conversion is no longer valid .",
    "the key condition is that the fractional change in the refractive index be small : @xmath147 .",
    "this can always be satisfied , in principle : if one chooses @xmath148 and/or @xmath149 to be sufficiently large , then the critical power can be made arbitrarily small in principle .",
    "not only does the critical power decrease with @xmath150 , but the field intensity in the cavity ( @xmath151 ) decreases as @xmath152 , and thus one can avoid large @xmath153 as well as lowering the power .",
    "( note that the field intensity goes as @xmath154 while the power goes as @xmath155 simply because the energy and power are related by a time scale of @xmath3 . )",
    "( black ) and @xmath156 ( red ) , vs. @xmath157 .",
    "@xmath158 power transfer from @xmath46 to @xmath159 is achieved at @xmath160.,width=264 ]    to illustrate second - harmonic conversion for a @xmath0 medium , we plot the solution to the coupled - mode equations as a function of input power in fig .",
    "the 100% conversion at the predicted critical power is clearly visible . for this calculation , we chose modal parameters similar to the ones from the fdtd computation before : @xmath161 , @xmath162 , @xmath163 , @xmath164 , with dimensionless @xmath165 .    a @xmath1 medium , on the other hand",
    ", does suffer from nonlinear frequency shifts .",
    "for example , fig .",
    "[ fig2a ] , which is by no means the optimal geometry , exhibits a maximal efficiency of @xmath166 , almost three orders of magnitude away from complete frequency conversion . on the other hand",
    ", we can again achieve 100% conversion if we can force @xmath167 , which can be done in two ways .",
    "first , one could employ _ two _ @xmath1 materials with opposite - sign @xmath1 values ( e.g. , as in ref .  ) .",
    "for example , if the @xmath1 is an _",
    "function around the cavity center , then the integrals for @xmath51 will vanish while the @xmath75 integrals will not .",
    "( in practice , @xmath168 should suffice . )",
    "second , one could pre - compensate for the nonlinear frequency shifts : design the cavity so that the shifted frequencies , at the critical power below , satisfy the resonant condition @xmath169 .",
    "equivalently , design the device for @xmath170 and then adjust the linear cavity frequencies _ a posteriori _ to compensate for the frequency shift at the critical power .",
    "( this is closely analogous to the cavity detuning used for optical bistability  @xcite , in which one operates off - resonance in the linear regime so that resonance occurs from the nonlinear shift . )",
    "if @xmath51 is thereby forced to be zero , and we can also neglect external losses ( absorption , etc . ) as above , then 100% third - harmonic conversion ( @xmath171 ) is obtained when : @xmath172^{1/2 } = \\left [    \\frac{\\omega_1 \\omega_3}{4\\left|\\beta_1\\right|^2 q_1 ^ 3 q_3 }    \\right]^{1/2 } \\label{effconv3}\\ ] ] if @xmath173 , then this critical power scales as @xmath174 where @xmath2 is the modal volume ( recall that @xmath175 ) .",
    "this is precisely the scaling that was predicted for the power to obtain nonlinear bistability in a single - mode cavity  @xcite .",
    "similarly , one finds that the energy density in the cavity ( @xmath151 ) decreases proportional to @xmath176 .",
    "( black ) and @xmath177 ( red ) , vs. @xmath112 .",
    "@xmath158 power transfer from @xmath46 to @xmath116 is achieved at @xmath178.,width=264 ]    we demonstrate the third - harmonic conversion for @xmath170 by plotting the solution to the coupled - mode equations as a function of input power in fig .",
    "[ fig4 ] . again , 100% conversion is only obtained at a single critical power . here",
    ", we used the same parameters as in the fdtd calculation , but with @xmath137 . in this case , comparing with fig .",
    "[ fig2a ] , we observe that complete frequency conversion occurs at a power corresponding to @xmath179 .",
    "this is close to the maximum power before coupled - mode / perturbation theory becomes invalid ( either because of second - order effects or material breakdown ) , but we could easily decrease the critical power by increasing @xmath3 .    for both the @xmath0 and the @xmath1 effects , in figs .",
    "[ fig3][fig4 ] , we see that the harmonic conversion efficiency goes to zero if the input power ( or @xmath180 ) is either too small or too large .",
    "it is not surprising that frequency conversion decreases for low powers , but the decrease in efficiency for high powers is less intuitive .",
    "it corresponds to a well - known phenomenon in coupled - mode systems : in order to get 100% transmission from an input port to an output port , the coupling rates to the two ports must be matched in order to cancel the back - reflected wave  @xcite . in the present case ,",
    "the coupling rate to the input port is @xmath181 , and the coupling rate to the output `` port '' ( the harmonic frequency ) is determined by the strength of the nonlinear coupling . if the nonlinear coupling is either too small or too large , then the rates are not matched and the light is reflected instead of converted .",
    "( on the other hand , we find that for large input powers , while the conversion _ efficiency _ as a fraction of input power goes to zero , the _ absolute _ converted power ( @xmath182 or @xmath118 ) goes to a constant . )    finally , let us consider one other potential problem .",
    "any physical @xmath0 medium will generally also have @xmath183 , so if the power is large enough this could conceivably cause a frequency shift that would spoil the second - harmonic resonance even in the @xmath0 device . here",
    ", we perform a simple scaling analysis to determine when this will occur .",
    "( although the frequency shifting could potentially be compensated for as described above , one prefers that it be negligible to begin with . ) in order to preserve the resonance condition , any fractional frequency shift @xmath184 must be much smaller than the bandwidth @xmath185 , or equivalently we must have @xmath186 . from above , @xmath187 , and",
    "suppose that we are operating at the critical input power @xmath189 for second - harmonic conversion , from eq .",
    "[ effconv2 ] .",
    "it then follows that we desire @xmath190 .",
    "it is convenient to re - express this relationship in terms of @xmath191 , the third - harmonic critical power from eq .",
    "[ effconv2 ] , by assuming @xmath192 as discussed in the previous section .",
    "we therefore find that @xmath1 self - phase modulation can be ignored for @xmath0 second - harmonic generation as long as @xmath193 . as discussed in the concluding remarks , this is indeed the case for common materials such as gallium arsenide , where @xmath194 for @xmath195 and for typical values of the cavity lifetime and volume .",
    "moreover , since @xmath196 , one can make the ratio arbitrarily smaller if necessary ( at the expense of bandwidth ) by increasing @xmath3 .",
    "in practice , a real device will have some additional losses , such as linear or nonlinear absorption and radiative scattering .",
    "such losses will lower the peak conversion efficiency below 100% . as we show in this section ,",
    "their quantitative effect depends on the ratio of the loss rate to the total loss rate @xmath185 .",
    "we also solve for the critical input power to achieve maximal conversion efficiency in the presence of losses .",
    "for a @xmath0 medium with a linear loss rate @xmath37 , we solve eqs  [ chi2a][chi2b ] for @xmath182 and enforce the condition for maximal conversion efficiency : @xmath197 .",
    "we thus obtain the following optimal input power and conversion efficiency : @xmath198 it immediately follows that for zero external losses , i.e. @xmath199 , eq .",
    "[ abs2 ] gives 100% conversion and eq .",
    "[ abs1 ] reduces to eq .",
    "[ effconv2 ] . for small external losses @xmath200 ,",
    "the optimal efficiency is reduced by the ratio of the loss rates , to first order : @xmath201 ( a similar transmission reduction occurs in coupled - mode theory when any sort of loss is introduced into a resonant coupling process  @xcite . )    the same analysis for @xmath1 yields the following critical input power and optimal efficiency :    @xmath202^{1/2 }   \\label{abs1chi3 } \\\\",
    "\\frac{\\left|s_{3-}\\right|^2}{\\left|s_{1+}\\right|^2 }   & = \\frac{\\tau_1\\tau_3}{{\\tau_{s,1}}{\\tau_{s,3 } } }   \\label{abs2chi3}\\end{aligned}\\ ] ]    where by comparison with eq .",
    "[ abs2 ] , a first - order expansion for low - loss yields an expression of the same form as eq .",
    "[ effabs ] : the efficiency is reduced by the ratio of the loss rates , with @xmath203 replaced by @xmath204 .    a @xmath1 medium may also have a nonlinear `` two - photon '' absorption , corresponding to a complex - valued @xmath1 , which gives an absorption coefficient proportional to the field intensity .",
    "this enters the coupled - mode equations as a small imaginary part added to @xmath74 , even if we have set the real part of @xmath74 to zero .",
    "( the corresponding effect on @xmath75 is just a phase shift . )",
    "that yields a nonlinear ( nl ) @xmath205 of the following form , to lowest order in the loss : @xmath206 \\\\ \\frac{1}{{\\tau_{e,3}}^\\textrm{nl } } & \\approx   \\omega_3 { \\operatorname{im}}\\left [ \\alpha_{31 } \\frac{{\\tau_{s,1}}}{2 } |s_{1+}|^2                     + \\alpha_{33 } \\frac{{\\tau_{s,3}}^2 { \\tau_{s,1}}^3}{8 } \\omega_3 ^ 2 |\\beta_3|^2 |s_{1+}|^6 \\right ] .\\end{aligned}\\ ] ] where we have simply substituted the values for the critical fields @xmath207 and @xmath208 given by eq .",
    "[ chi3b ] , and grouped terms that correspond to imaginary frequency shifts .",
    "these loss rates can then be substituted in the expression for the losses above , i.e. eq .  [ abs2chi3 ] , in which case one obtains the following optimal efficiency of third - harmonic generation , to lowest - order in the loss , not including linear losses : @xmath209 \\label{effabsnl}\\ ] ] ( the linear and nonlinear losses can be combined by simply multiplying eq .  [ abs2chi3 ] and eq .  [ effabsnl ] . )",
    "thus , the nonlinear loss is proportional to the ratio @xmath210 , which is proportional to @xmath211 .",
    "we have presented a rigorous coupled - mode theory for second- and third - harmonic generation in doubly resonant nonlinear cavities , accurate to first order in the nonlinear susceptibility and validated against a direct fdtd simulation .",
    "our theory , which generalizes previous work on this subject , predicts several interesting consequences .",
    "first , it is possible to design the cavity to yield 100% frequency conversion in a passive ( gain - free ) device , even when nonlinear down - conversion processes are included , limited only by fabrication imperfections and losses .",
    "second , this 100% conversion requires a certain critical input power ",
    "powers either too large or too small lead to lower efficiency .",
    "third , we describe how to compensate for the self - phase modulation in a @xmath1 cavity .",
    "the motivation for this work was the hope that a doubly resonant cavity would lead to 100% conversion at very low input powers , and so we conclude our paper by estimating the critical power for reasonable material and geometry assumptions .    a typical nonlinear material is gallium arsenide ( gaas ) , with @xmath212 @xmath213 and @xmath214 @xmath215 at @xmath216 .",
    "( al doping is usually employed to decrease nonlinear losses near resonance  @xcite . )",
    "although this has both @xmath0 and @xmath1 effects , we can selectively enhance one or the other by choosing the cavity to have resonances at either the second or third harmonic .",
    "many well confined optical cavity geometries are available at these wavelengths and have been used for nonlinear devices , such as ring resonators  @xcite or photonic - crystal slabs  @xcite .",
    "we will assume conservative parameters for the cavity : a lifetime @xmath217 , @xmath218 , @xmath219 , and a modal volume of 10 cubic half - wavelengths ( @xmath220 ) with roughly constant field amplitude in the nonlinear material ( worse than a realistic case of strongly peaked fields ) .",
    "in this case , the critical input power , from eqs",
    ".  [ effconv2][effconv3 ] , becomes approximately 70  @xmath221w for second - harmonic generation and 2  mw for third - harmonic generation ( with a moderate peak index shift @xmath222 , justifying our first - order approximation )    future work will involve designing specific doubly resonant cavity geometries and more precise power predictions . using our expressions for @xmath74 and @xmath75 , optimized cavities for harmonic generation can be designed using standard methods to compute the linear eigenmodes . in practice",
    ", experimentally achieving cavity modes with `` exactly '' harmonic frequencies , matched to within the fractional bandwidth @xmath185 , is a challenge and may require some external tuning mechanism .",
    "for example , one could use the nonlinearity itself for tuning , via external illumination of the cavity with an intense `` tuning '' beam at some other frequency .",
    "also , although we can directly integrate the coupled - mode equations in time , we intend to supplement this with a linearized stability analysis at the critical power .",
    "this is particularly important for the @xmath1 case , where pre - correcting the frequency to compensate the nonlinear frequency shift ( self - phase modulation ) may require some care to ensure a stable solution .",
    "we would like to thank zheng wang and karl koch for useful discussions , as well as the anonymous referees for many helpful suggestions .",
    "this work was supported in part by the materials research science and engineering center program of the national science foundation under award dmr-9400334 , by a department of energy ( doe ) computational science fellowship under grant de  fg02 - 97er25308 , and also by the paul e. gray undergraduate research opportunities program fund at mit .",
    "l.  fan , h.  ta - chen , m.  fallahi , j.  t. murray , r.  bedford , y.  kaneda , j.  hader , a.  r. xzakharian , j.  moloney , s.  w. koch , and w.  stolz , `` tunable watt - level blue - green vertical - external - cavity surface - emitting lasers by intracavity frequency doubling , '' appl .",
    ". lett . * 88 * , 2251,117 ( 2006 ) .",
    "g.  d. aguanno , m.  centini , m.  scalora , c.  sibilia , m.  bertolotti , m.  j. bloemer , and c.  m. bowden , `` generalized coupled - mode theory for @xmath223 interactions in finite multi - layered structures , '' j.  opt .",
    "b * 19 * , 21112122 ( 2002 ) .",
    "a.  m. malvezzi , g.  vecchi , m.  patrini , g.  guizzeti , l.  c. andreani , f.  romanato , l.  businaro , e.  d. fabrizio , a.  passaseo , and m.  d. vittorio , `` resonant second - harmonic generation in a gaas photonic crystal waveguide , '' phys . rev .",
    "b * 68 * , 161,306 ( 2003 ) .",
    "a.  v. balakin , v.  a. bushuev , b.  i. mantsyzov , i.  a. ozheredov , e.  v. petrov , and a.  p. shkurinov , `` enhancement of sum frequency generation near the photonic band edge under the quasiphase matching condition , '' phys .",
    "e * 63 * , 046,609 ( 2001 ) .",
    "g.  d. aguanno , m.  centini , m.  scalora , c.  sibilia , y.  dumeige , p.  vidavovic , j.  a. levenson , m.  j. bloemer , c.  m. bowden , j.  w. haus , and m.  bertolotti , `` photonic band edge effects in finite structures and applications to @xmath223 interactions , '' phys .",
    "e * 64 * , 016,609 ( 2001 ) .",
    "w.  j. kozlovsky , w.  p. risk , w.  lenth , b.  g. kim , g.  l. bona , h.  jaeckel , and d.  j. webb , `` blue light generation by resonator - enhanced frequency doubling of an extended - cavity diode laser , '' appl .",
    ". lett . * 65 * , 525527 ( 1994 ) .",
    "g.  j. dixon , c.  e. tanner , and c.  e. wieman , `` 432-nm source based on efficient second - harmonic generation of gaalas diode - laser radiation in a self - locking external resonant cavity , '' opt . lett .",
    "* 14 * , 731733 ( 1989 ) .",
    "x.  mu , y.  j. ding , h.  yang , and g.  j. salamo , `` cavity - enhanced and quasiphase - matched mutli - order reflection - second - harmonic generation from gaas / alas and gaas / algaas multilayers , '' appl . phys .",
    "lett . * 79 * , 569 ( 2001 ) .",
    "t.  v. dolgova , a.  i. maidykovski , m.  g. martemyanov , a.  a. fedyanin , o.  a. aktsipetrov , g.  marowsky , v.  a. yakovlev , g.  mattei , n.  ohta , and s.  nakabayashi , `` giant optical second - harmonic generation in single and coupled microcavities formed from one - dimensional photonic crystals , '' j.  opt .",
    "b * 19 * , 2129 ( 2002 ) .",
    "l.  scaccabarozzi , m.  m. fejer , y.  huo , s.  fan , x.  yu , and j.  s. harris , `` enchanced second - harmonic generation in algaas / al@xmath224o@xmath225 tightly confining waveguides and resonant cavities , '' ol * 31*(24 ) , 36263630 ( 2006 ) .",
    "h.  schnitzler , u.  frhlich , t.  k.  w. boley , a.  e.  m. clemen , j.  mlynek , a.  peters , and s.  schiller , `` all - solid - state tunable continuous - wave ultraviolet source with high spectral purity and frequency stability , '' appl .",
    "opt . * 41 * , 70007005 ( 2002 ) .",
    "p. markowicz , h.  tiryaki , h.  pudavar , p.  n. prasad , n.  n. lepeshkin , and r.  w. boyd , `` dramatic enhancement of third - harmonic generation in three - dimensional photonic crystals , '' phys .",
    "* 92*(083903 ) ( 2004 ) .",
    "a.  farjadpour , d.  roundy , a.  rodriguez , m.  ibanescu , p.  bermel , j.  burr , j.  d. joannopoulos , and s.  g. johnson , `` improving accuracy by subpixel smoothing in the finite - difference time domain , '' opt . lett . * 31 * , 29722974 ( 2006 ) .",
    "d.  d. smith , g.  fischer , r.  w. boyd , and d.  a. gregory , `` cancellation of photoinduced absorption in metal nanoparticle composites through a counterintuitive consequence of local field effects , '' j.  opt .",
    "b * 14 * , 1625 ( 1997 ) .",
    "m.  f. yanik , s.  fan , m.  soljai , , j.  d. joannopoulos , and yanik , `` all - optical transistor action with bistable switching in a photonic crystal cross - waveguide geometry , '' opt . lett .",
    "* 68 * , 2506 ( 2004 ) ."
  ],
  "abstract_text": [
    "<S> we derive general conditions for 100% frequency conversion in any doubly resonant nonlinear cavity , for both second- and third - harmonic generation via @xmath0 and @xmath1 nonlinearities . </S>",
    "<S> we find that conversion efficiency is optimized for a certain `` critical '' power depending on the cavity parameters , and assuming reasonable parameters we predict 100% conversion using milliwatts of power or less . </S>",
    "<S> these results follow from a semi - analytical coupled - mode theory framework which is generalized from previous work to include both @xmath0 and @xmath1 media as well as inhomogeneous ( fully vectorial ) cavities , analyzed in the high - efficiency limit where down - conversion processes lead to a maximum efficiency at the critical power , and which is verified by direct finite - difference time - domain ( fdtd ) simulations of the nonlinear maxwell equations . </S>",
    "<S> explicit formulas for the nonlinear coupling coefficients are derived in terms of the linear cavity eigenmodes , which can be used to design and evaluate cavities in arbitrary geometries . </S>"
  ]
}