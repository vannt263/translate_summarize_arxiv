{
  "article_text": [
    "linear smoothing filters , such as the classical gaussian filter , typically work well in applications where the amount of smoothing required is small .",
    "for example , they are very quite effective in removing small dosages of additive noise from images . however",
    ", when the noise floor is large and one is required to average more pixels to improve the signal - to - noise ratio , linear filters tend to to over - smooth sharp image features such as edges and corners .",
    "this over - smoothing can be alleviated using some form of data - driven ( non - linear ) diffusion , where the quantum of smoothing is controlled using the image features .",
    "a classical example in this regard is the anisotropic diffusion of perona and malik @xcite .",
    "the insight of the authors was to take the standard diffusion equation and turn it into a non - linear differential equation by controlling its diffusivity using the gradient information .",
    "this automatically attenuated the blurring in the vicinity of edges . in practice",
    ", the associated differential equation is numerically solved using an iterative solver .",
    "while the perona - malik diffusion is known to be mathematically ill - posed @xcite , it is known to be numerical stable in practice and performs reasonably well on real data .",
    "a delicate aspect of this scheme is the choice of the stopping criteria which often critically determines the final result .",
    "the bilateral filter was proposed by tomasi and maduchi @xcite as a simple , non - iterative alternative to the perona - malik diffusion .",
    "the origins of the filter can be traced back to the work of lee @xcite and yaroslavsky @xcite",
    ". the susan framework of smith and brady @xcite is also based on a similar idea .    for a discrete image @xmath1 ,",
    "the bilateral filter is given by @xmath2 in this formula , @xmath3 is the _ spatial _ filter defined on some neighbourhood @xmath4 and @xmath5 is the _ range _ filter .",
    "typically , @xmath4 is a square neighbourhood , @xmath6 \\times [ -w , w]$ ] , and both the spatial and range filters are gaussian : @xmath7 the support @xmath8 of the spatial filter is usually set to be @xmath9 .    the spatial filter puts larger weights on pixels that are close to the pixel of interest compared to distant pixels . on the other hand , the range filter operates on the intensity differences between the pixel of interest and its neighbors ( which makes the overall filter non - linear ) .",
    "the role of the range filter is to restrict the averaging to neighbouring pixels whose intensities are similar to that of the pixel of interest . in particular , @xmath10 in is close to zero when both @xmath11 and its neighbors @xmath12 belong to a homogenous region . in this case ,",
    "@xmath13 , and effectively acts as a standard gaussian filter . on the other hand , consider the situation in which the pixel of interest @xmath11 is in the vicinity of an edge . if @xmath14 and @xmath11 are on the opposite sides of the edge , then @xmath15 is relatively small compared to what it is when @xmath14 and @xmath11 are on the same side of the edge .",
    "this effectively prohibits the mixing of pixels from different sides of the edge during the averaging , and hence avoids the blurring that is otherwise induced by linear filters .",
    "the bilateral filter has found widespread applications in image processing , computer vision , and computational photography .",
    "we refer the interested reader to @xcite and the references therein for an exhaustive account of various applications .",
    "our present interest is in the image denoising applications of the filter @xcite .",
    "the bilateral filter has received renewed attention in the image processing community in the context of image denoising @xcite .",
    "it is well - known that , while the filter is quite effective in removing modest amounts of additive noise , its denoising performance is severely impaired at large noise levels @xcite . to overcome this drawback",
    ", different iterative forms of the filter were proposed in @xcite , for example . in a different direction , it was shown by buades et al .",
    "@xcite that a patch - based extension of the filter can be used to bring the denoising performance of the filter at par with state - of - the - art methods . however , this and other advanced patch - based methods @xcite are much more computation - intensive than the bilateral filter .    in this paper , we demonstrate how the denoising performance of the bilateral filter can be improved at almost no additional cost by incorporating a simple pre - processing step into the framework . to the best of our knowledge",
    ", this improvement has not been reported in the literature on bilateral filtering - based denoising .",
    "although the present improvement is not of the order of the improvement provided by k - svd and bm3d , we will demonstrate that the improved bilateral filter is often competitive with the non - local means ( nlm ) filter @xcite , while being significantly cheaper .",
    "moreover , we also describe a fast algorithm for the modified filter which should be of interest in real - time denoising .",
    "the rest of the paper is organized as follows . in section [ sec : ibf ] , we briefly describe the denoising problem and the standard metrics that are used to quantify the denoising performance .",
    "we then introduce the proposed improvement of the bilateral filter in the context of denoising . in this section ,",
    "we also report a fast algorithm for the proposed filtering .",
    "experimental results on synthetic and natural images are provided in section [ sec : experiments ] , and we conclude the paper in section [ sec : conclusion ] .",
    "we consider the problem of denoising grayscale images that are corrupted with additive white gaussian noise . in this setup",
    ", we are given the _ corrupted _ ( or _ noisy _ ) image @xmath16 where    * @xmath17 is some finite rectangular domain of @xmath18 , * @xmath19 is the unknown _ clean _ image , and * @xmath20 are independent and distributed as @xmath21 .",
    "the goal is find a _ denoised _",
    "estimate @xmath22 of the clean image from the corrupted samples .",
    "the denoised image should visually resemble the clean image . to quantify the resemblance , two standard metrics",
    "are widely used in the image processing literature , namely the peak signal - to - noise ratio ( psnr ) and the structural similarity index ( ssim ) @xcite .",
    "the psnr is defined to be @xmath23 , where @xmath24      in linear diffusion , the clean image is estimated by linearly averaging the noisy samples .",
    "the averaging process successfully brings down the noise floor in homogenous regions by a factor of @xmath25 , where @xmath26 is the length of the filter @xcite .",
    "however , the filter also implicitly acts on the underlying clean image in the process . as a result , it introduces blurring in the image features besides reducing the noise floor .",
    "this can precisely be overcome by applying the bilateral filter on the corrupted image @xcite . in this",
    "regard , note that the range filter operates on the noisy samples . in other words ,",
    "the corrupted image is used not just for the averaging but also to control the blurring via the range filter .",
    "what if the range filter could directly operate on the clean image ?",
    "that is , instead of , suppose we consider the formula @xmath27 the denoising result obtained using this `` oracle '' filter is compared with that obtained using in figure [ oraclebf ] .",
    "it is not surprising that the result obtained using the oracle filter is visibly better and has higher psnr .",
    "of course , the problem is that we do not have access to the clean image in practice , and thus the oracle bilateral filter can not be realized .",
    "nevertheless , one could consider some form of proxy for the clean image .",
    "for example , one could use an `` iterated '' bilateral filter @xcite where the output of the bilateral filter is used as a proxy .",
    "however , this requires us to compute twice , which doubles the run time of the filter .",
    "our present proposal is simply to use the box - filtered version of the noisy image as a proxy . in other words ,",
    "the proposed improved bilateral filter ( in short , ibf ) is given by @xmath28 where @xmath29 ^ 2 } \\!\\!\\ !",
    "f(\\i-\\j).\\ ] ] clearly , the amount of smoothing induced by the box - filter is controlled by @xmath26 . when @xmath26 is very small , @xmath30 , and behaves as . at the other other end ,",
    "the image structures are over - smoothed when @xmath26 is large and this makes @xmath31 a bad proxy for the original image .",
    "thus , @xmath26 should not be too small and neither too large",
    ". we will report the appropriate choice of @xmath26 in the sequel .",
    "the cost of computing is almost identical to that of computing , since the additional cost of computing is negligible in comparison .",
    "more precisely , the cost of computing is @xmath32 per pixel , since the support @xmath4 of the spatial filter is proportional to @xmath33 . on the other hand ,",
    "it is well - known that the box - filter in can be computed using @xmath34 operations per pixel @xcite .",
    "we now explain how we can implement using @xmath34 operations ( with respect to @xmath35 ) as a straightforward extension of the algorithm proposed in @xcite .    for completeness",
    ", we present the main ideas behind the fast algorithm in @xcite .",
    "note that the effective domain of the range filter in is the interval @xmath36 $ ] , where @xmath37 is the maximum value of @xmath38 over all @xmath39 and @xmath40 ^ 2 $ ] .",
    "in other words , @xmath37 is the maximum `` local '' dynamic range of @xmath31 over square boxes of length @xmath41 .",
    "note that the complexity of computing @xmath37 is comparable to that computing the filter , namely @xmath42 operations per pixel .",
    "a fast algorithm for computing @xmath37 was however later proposed in @xcite , which we will use in this paper .",
    "it was observed in @xcite that @xmath43^n.\\ ] ] the functions on the right are called _ raised cosines _ , and we refer to @xmath44 as its order",
    ". note that while holds for every @xmath45 , we only require a good approximation for @xmath46 $ ] .",
    "moreover , the raised cosine should ideally be positive and monotonic on this interval .",
    "in particular , one can verify that if @xmath44 is larger than @xmath47 , then the raised - cosine is positive and monotonic on @xmath36 $ ] .",
    "in other words , any raised - cosine of order @xmath48 is an acceptable approximation of the gaussian range filter .",
    "the approximation process in demonstrated in figure [ approximation ] .",
    "now , using the identity @xmath49 ( where @xmath50 denotes the imaginary unit @xmath51 ) and the binomial expansion , we can write @xmath52^n= \\sum_{n=0}^n c_n",
    "\\exp \\left(\\imath \\omega_n t \\right ) , \\end{aligned}\\end{aligned}\\ ] ] where @xmath53 plugging into , using the multiplication - addition property @xmath54 , and exchanging the summations , we can express the numerator of as @xmath55 where @xmath56 and @xmath57 denotes the gaussian filtering of @xmath58 .",
    "similarly , we have the following approximation for the denominator of : @xmath59 where @xmath60    to summarize then , by using the raised - cosine approximation of the gaussian range filter , we can express the numerator and denominator of as a linear combinations of gaussian filters applied on the images @xmath58 and @xmath61 .",
    "it is well - known that gaussian filtering can be computed using @xmath34 operations per pixel ( i.e. , independent of @xmath35 ) using recursions @xcite . as a result",
    ", we can compute and , and hence the overall filter , using @xmath34 operations per pixel .",
    "in fact , it is further possible to cut down the run time without appreciably sacrificing the approximation using truncation @xcite .",
    "in particular , it can be verified that the contribution of the central terms in to the overall approximation is less compared to the other terms .",
    "indeed , the distribution of the normalized binomial coefficients @xmath62 is bell - shaped with a peak around @xmath63 . as a result",
    ", one can truncate the sum away from the central peak and tradeoff speed versus accuracy .",
    "in particular , given some tolerance @xmath64 , we incrementally find the largest @xmath65 such that @xmath66 we can then further approximate using the truncated sum @xmath67 note that the error between and is @xmath68 whose magnitude is , by construction , at most as large as @xmath69 . using , we can further cut down the run time of by a factor of about @xmath70 , without any appreciable change in denoising performance . for large @xmath44 , one can test for the condition @xmath71 without having to compute all the @xmath72 . in particular",
    ", the chernoff - inequality for the binomial distribution gives us the estimate @xmath73 which is quite accurate when @xmath74 @xcite .",
    "the complete algorithm is summarized in algorithm [ algoibf ] .",
    "here , we have used @xmath75 $ ] to denote the set of numbers @xmath76 , and @xmath77 $ ] to denote the set of numbers @xmath78 and @xmath79 . in step @xmath80 ( c ) , we have used @xmath81 to denote the complex conjugate of @xmath61 .",
    "* initialize * : images @xmath82 and @xmath83 for all @xmath11 compute box - filtered image @xmath31 using compute local dynamic range @xmath37 of @xmath31 @xmath84 @xmath85 for all @xmath11",
    "the complexity of the direct implementation of the proposed filter is identical to that of the standard bilateral filter , namely @xmath86 . on the other hand , for an image with maximum local dynamic range @xmath37 ,",
    "the complexity of the fast implementation proposed in section [ sec : fast ] is @xmath87 .",
    "the final run time is however determined by the constants that are implicit in the above complexity estimates . in practice , the main speed - up is due to the fact that gaussian filtering can be implemented very efficiently using standard packages .",
    "for example , the image filtering in step @xmath80 ( d ) and ( e ) can be done using the optimized `` imfilter '' routine in matlab . in table",
    "[ table1 ] , we compare the run times of the fast implementation and the direct implementation ( for typical filter parameters ) on the _ barbara _ image .",
    "l*6cr & @xmath88 & ( 4,20 ) & @xmath89 & @xmath90 & @xmath91 & @xmath92 + direct & 16.5s & 60.5s & 35.3s & 93.8s & 35.5s & 60.5s + fast & 0.52s & 0.61s & 0.52s & 0.47s & 0.43s & 0.47s +    [ table1 ]    all computations were performed using matlab on a quad - core 2.70 ghz intel machine with 16 gb memory .",
    "it is clear from the table that a significant acceleration is achieved using the fast algorithm .",
    "in particular , notice that the fast implementation takes about @xmath93 seconds for different parameter settings .",
    "on the other hand , notice the run time of the direct implementation scales up quickly with the increase in the width of the spatial filter .",
    "we note that the run time of the fast implementation can be further cut down using a parallel ( multithreaded ) implementation of step @xmath80 in algorithm [ algoibf ] .",
    "we now come to question about the choice of the optimal length @xmath26 for the box - filter in .",
    "we performed exhaustive some simulations in this direction , the results of some of which are reported in figure [ psnrvsl ] . for these simulations , we conclude that a box - filter with @xmath94 ( @xmath95 blur ) is optimal for most settings . a possible way to explain",
    "this is that this small filter is able to suppress the noise without excessively blurring the image features .",
    "we now present some denoising results to demonstrate the superior denoising performance of the proposed filter . in figure",
    "[ ckb ] , we compare the proposed filter with the standard and the oracle filter on a synthetic test image . notice that the improvement in psnr over the standard filter is more than @xmath96 db .",
    "this does not come as a surprise since this particular test image has a lot of sharp intensity transitions . while the bilateral filter is already known to work well for such images ,",
    "what this result demonstrates is that we can further improve its performance using the proposed modification .",
    "moreover , note the psnr of the proposed filter is close to that of the oracle bilateral filter ( which uses the clean image to compute the range filter ) . in figure [ house ]",
    ", we compare the proposed filter with the iterated bilateral filter . notice",
    "that while the psnr from the iterated filter is within a db of that obtained using the proposed filter , the denoised image from the latter looks visibly better .",
    "this is also confirmed by the ssim indices reported in the figure .",
    "we next compare the denoising performance of the proposed modification with the standard bilateral filter on certain standard test images @xcite .",
    "the psnr and ssim indices of the proposed modification and the standard bilateral filter are reported in table [ table2 ] .",
    "we independently optimize the standard and the improved bilateral filter with respect to @xmath35 and @xmath97 .",
    "also , we use @xmath94 for the improved bilateral filter .",
    "notice that the proposed filter starts to perform better beyond a certain noise level ( @xmath98 ) . on the other hand ,",
    "the ssim improvement is already evident for all the images beyond @xmath99 .",
    "this is because , at low noise levels , the proposed box - filtering does more blurring than noise suppression , which brings down the overall signal - to - noise ratio . indeed ,",
    "when the noise floor is small , the corrupted image is already a good proxy for the clean image . however ,",
    "notice that the improvement in ssim is quite significant for all the images at large noise levels , and the psnr improvement is often as large as @xmath0 db .",
    "for a visual comparison , some of the results of the denoising experiments are shown in figures [ visualcomp1 ] , [ visualcomp2 ] , and [ visualcomp3 ] . in table",
    "[ table2 ] , we compare the proposed filter with some sophisticated image denoising methods cited in the introduction , namely , nlm @xcite , k - svd @xcite , and bm3d @xcite .",
    "nlm is essentially a patch - based extension of the bilateral filter , in which image patches ( groups of neighbouring pixels ) are used for comparing neighbouring pixels .",
    "the latter methods are based on sparse - coding and collaborative filtering and are significantly more sophisticated .",
    "what we find quite interesting is that , beyond a certain noise level , the proposed filter is competitive with nlm for most of the test images in table [ table2 ] , except for _ barbara _ and _ cameraman_. the denoising performance is in general inferior to k - svd and bm3d .",
    "we do not find this surprising since ( among other things ) they heavily rely on the sparsity of natural images ( in appropriate bases ) to improve the psnr by few extra dbs .",
    "however , we believe that the present work is relevant in the context of the recent results in @xcite and @xcite , where the bilateral filter is used to obtain state - of - the - art denoising results .",
    "we demonstrated that by using a box - filtered image in the range filter , one can substantially improve the denoising performance of the bilateral filter , at almost no additional cost .",
    "while the basic idea is quite simple , it is nevertheless quite effective in improving the denoising performance of the filter .",
    "exhaustive denoising results on test images were provided in this direction . this address a well - known pathology of the bilateral filter , namely , that its denoising performance begins to degrade quickly with the increase in noise level .",
    "an interesting finding was that the proposed filter is often competitive with the computation - intensive non - local means filter .",
    "we also presented a fast algorithm for the proposed filter that can dramatically cut down the run time .",
    "as future work , we plan to investigate how one can combine the standard and the proposed filter so as to consistently obtain the best denoising performance at all noise levels .",
    "z. wang , a. c. bovik , h. r. sheikh , e. p. simoncelli , `` image quality assessment : from error visibility to structural similarity , '' _ ieee transactions in image processing _",
    "600 - 612 , 2004 ."
  ],
  "abstract_text": [
    "<S> the bilateral filter has diverse applications in image processing , computer vision , and computational photography . in particular , this non - linear filter is quite effective in denoising images corrupted with additive gaussian noise . </S>",
    "<S> the filter , however , is known to perform poorly at large noise levels . </S>",
    "<S> several adaptations of the filter have been proposed in the literature to address this shortcoming , but often at an added computational cost . in this paper </S>",
    "<S> , we report a simple yet effective modification that improves the denoising performance of the bilateral filter at almost no additional cost . </S>",
    "<S> we provide visual and quantitative results on standard test images which show that this improvement is significant both visually and in terms of psnr and ssim ( often as large as @xmath0 db ) . </S>",
    "<S> we also demonstrate how the proposed filtering can be implemented at reduced complexity by adapting a recent idea for fast bilateral filtering .    </S>",
    "<S> image denoising , bilateral filter , box - filter , improvement , fast algorithm . </S>"
  ]
}