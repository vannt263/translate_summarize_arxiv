{
  "article_text": [
    "in ref.@xcite , szegedy proposed a quantum walk operator for each classical markov chain . in ref.@xcite , somma et al .",
    "proposed a method for doing simulated annealing on a quantum computer . in ref.@xcite ,",
    "wocjan et al . showed how to improve the somma et al .",
    "algorithm . the algorithms of somma et al . and wocjan et al .",
    "both use szegedy operators . in ref.@xcite ,",
    "i presented computer programs called qusann and multiplexor expander that implement ideas of refs.@xcite and @xcite , and also some of my own ideas about quantum multiplexors .    in ref.@xcite",
    ", i described one particular algorithm for doing gibbs and metropolis - hastings sampling of a classical bayesian network ( i.e. , a probability distribution ) on a quantum computer . in this paper ,",
    "i describe a different algorithm for doing gibbs sampling on a quantum computer .",
    "unlike my first algorithm , this one uses szegedy operators . for any @xmath0 , this new algorithm will sample a bayesian network in @xmath1 steps with precision @xmath2 . here",
    "@xmath3 is the distance between the two largest eigenvalue magnitudes of the transition matrix of the gibbs markov chain used in the algorithm .",
    "it takes @xmath4 steps to achieve the same precision if one does gibbs sampling on a classical computer .",
    "this paper assumes that its reader has read the section entitled  notation and preliminaries \" in ref.@xcite .",
    "the reader should refer to refs.@xcite for clarification when any notation of this paper eludes him .",
    "in this section , we will discuss dual  gibbs \" markov chains with transition matrices @xmath5 and @xmath6 , respectively .",
    "these two transition matrices are both defined in terms of a single classical bayesian network @xmath7 .",
    "consider a classical bayesian net with @xmath8 nodes , labeled @xmath9 where @xmath10 for each @xmath11 .",
    "( as usual in my papers , i indicate random variables by underlining them . )",
    "let @xmath12 .",
    "let @xmath7 assume values in a set @xmath13 which has @xmath14 elements .",
    "let    \\(x ) = p(=x ) for all @xmath15 .    for @xmath16 and @xmath17 ,",
    "let    m_1(y|x)= p__1|_2_3(y_1|x_2,x_3 ) p__2|_3_1(y_2|x_3,y_1 ) p__3|_1_2(y_3|y_1,y_2 ) , and    m_2(y|x)= p__1|_2_3(y_1|y_2,y_3 ) p__2|_3_1(y_2|y_3,x_1 ) p__3|_1_2(y_3|x_1,x_2 ) .",
    "( @xmath18 can be obtained by swapping @xmath19 and @xmath20 in the _ conditioned _ arguments of @xmath21 . ) note that @xmath22 and @xmath23 .",
    "define @xmath5 and @xmath6 for arbitrary @xmath8 using the same pattern . @xmath5 and @xmath6 are transition matrices of the type typical for gibbs sampling .",
    "( see ref.@xcite for an introduction to gibbs sampling and the more general metropolis - hastings sampling ) .",
    "you can check that @xmath24 is not a detailed balance of either @xmath5 nor @xmath6 separately .",
    "however , the following property is true",
    ". we will refer to this property by saying that @xmath24 is a detailed balance of the pair @xmath25 .",
    "m_1(y|x)(x)=m_2(x|y)(y ) [ eq - pair - detbal ] for all @xmath17 .",
    "let @xmath26 stand for @xmath27 .",
    "assume @xmath16 to begin with .",
    "one has    & = & + & = & + & = & + & = & .",
    "a proof for an arbitrary number @xmath8 of nodes follows the same pattern .",
    "j(y|x)= , for @xmath29 and @xmath17 .",
    "it s convenient to define a hybrid function of @xmath5 and @xmath6 , as follows :    m_hyb(y|x ) = _ 2(x|y)_1(y|x ) for @xmath17 .",
    "( note that unlike @xmath21 and @xmath18 , @xmath30 is not a probability function in @xmath31 , its first argument . )",
    "define the quantum states    = _ x [ ( x)]^ for @xmath32 .",
    "( note that only the @xmath33 state is normalized in the sense of quantum mechanics . )",
    "m_j= j=1,2 , and    m_hyb= .",
    "also , @xmath5 , @xmath6 and @xmath28 have the same eigenvalues .",
    "taking the square root of both sides of the pair detailed balance statement eq.([eq - pair - detbal ] ) , we get    _ 1(y|x)= _ 2(x|y ) . therefore ,    m_hyb(y|x)=_2(x|y )",
    "_ 2(x|y ) & = & m_2(x|y ) .",
    "hence ,    _ x m_1(y|x)(x)= _ x m_2(x|y)(y)=(y ) ,    _ y m_2(x|y)(y)= _ y m_1(y|x)(x)=(x ) , and    _ x m_hyb(y|x ) = _ x m_2(x|y ) = .",
    "order the elements of the finite set @xmath13 in some preferred way .",
    "use this preferred order to represent @xmath5 , @xmath6 and @xmath28 as matrices .",
    "define a diagonal matrix @xmath34 whose diagonal entries are the numbers @xmath35 for each @xmath15 , with the @xmath36 ordered in the preferred order :    d= diag[((x))_x ] . since    m_2^t = d^-1m_1 d , m_hyb^t = d^-m_2 d^ , it follows that    ( m_1 - ) = ( m_2 - ) = ( m_hyb - ) for any @xmath37 .",
    "let the eigenvalues of @xmath28 ( and also of @xmath5 and @xmath6 ) be @xmath38 with latexmath:[$m_0=1 > |m_1|\\geq    corresponding eigenvectors of @xmath28 ( but not necessarily of @xmath5 and @xmath6 ) . thus    m_hyb = m_j , for @xmath40 .",
    "in particular , @xmath41 .",
    "for each @xmath11 , define @xmath42 $ ] and @xmath43 so that @xmath44 .",
    "( thus , @xmath45 ) . note that @xmath46 so @xmath47 .",
    "the @xmath5 eigenvalue gap @xmath3 is defined as @xmath48 .",
    "@xmath49 when @xmath50 is small .",
    "in this section , we will define a  q - embedding \" @xmath53 of @xmath54 , for @xmath29 .",
    "( for more information about q - embeddings , see ref.@xcite . )    for simplicity , we begin this section by considering a bayesian net with only 3 nodes @xmath55 , and such that each of these nodes is binary ( i.e. , @xmath56 for @xmath57 ) . at the end of this section",
    ", we will show how to remove these restrictions and make our treatment valid for general bayesian networks .    using the same language as ref.@xcite ,",
    "consider a unitary matrix @xmath51 of the form shown in fig.[fig - u1 ] , with its multiplexor gates defined as follows .",
    "let @xmath58 and @xmath59 for any @xmath60 .",
    "@xmath51 has 3 analogous gates ( a.k.a .",
    "nodes ) labeled @xmath61 , @xmath62 , and @xmath63 .",
    "consider the first of these for definiteness .",
    "let the probability amplitude @xmath64 of node @xmath65 satisfy the constraint     + & = & _ x_2^x_2 _ x_3^x_3 .",
    "[ eq - a - constraint ] if we indicate non - zero entries by a plus sign ,    a & = &    [ cols=\">,>,>,>,>,>\",options=\"header \" , ]      + & & _ bool^2 e^i_p_=    c @c=1em @r=1em @!r & & + & & + & &    , [ eq - reduced - a ] for some @xmath66 . here",
    "the right pointing arrow means that the expression at the origin of the arrow can be extended to the expression at the target of the arrow .    from the above definition of @xmath51",
    ", it follows that , for @xmath67 ,    c +    u_1",
    "l + ^3    & = & \\ {    c @c=1em @r=1em @!r & & & & + & & & & + & & & & + & & & & + & & & & + & & & &    .",
    "+ & = & _ 1(y|x)(y , x ) . hence ,    c @c=1em @r=2em @!r & & & + & & & ^3    =    c @c=1em @r=1em @!r & & & + & & &    u_1 ^ 3= ( _ 1 ) .",
    "besides @xmath51 , it is convenient to consider another unitary matrix called @xmath52 .",
    "we define @xmath52 to be of the form of fig.[fig - u2 ] , where the multiplexors are defined in such a way that @xmath52 satisfies , for all @xmath67 ,    c +    u_2    l ^3 +    & = & \\ {    c @c=1em @r=1em @!r & & & & + & & & & + & & & & + & & & & + & & & & + & & & &    .",
    "+ & = & _ 2(y|x)(y,x ) .",
    "hence    c @c=1em @r=2em @!r & & & ^3 + & & &    =    c @c=1em @r=1em @!r & & & + & & &    u_2 ^ 3= ( _ 2 ) .",
    "@xmath53 is called the q - embedding of @xmath54 for @xmath29 .",
    "so far we have considered the q - embeddings @xmath51 and @xmath52 for the case of a classical bayesian network @xmath7 with 3 binary nodes .",
    "what if @xmath7 has @xmath8 nodes and some of those nodes have more than 2 states ? in that case , we must use several qubits ( horizontal lines ) for each node @xmath68 ( and an equal number of qubits for the dual node @xmath69 ) in figs.[fig - u1 ] and [ fig - u2 ] .",
    "more specifically , suppose @xmath70 equals @xmath71 where @xmath72 and @xmath73 .",
    "for the number of bits @xmath74 , define the number of states @xmath75 .",
    "likewise , let @xmath76 .",
    "the constraint eq.([eq - a - constraint ] ) generalizes to    a(b,| = 0 , a)= _",
    "a^ , [ eq - amp - tensor - form ] where @xmath77 and @xmath78 . eq.([eq - amp - tensor - form ] ) can be expressed in matrix form as follows :    =    c|c & ( = 0,a ) + ( b,)&d^0,0 + & d^1,0 + & + & d^-1,0    , [ eq - amp - mat - form - one - col ] where , for all @xmath73 , @xmath79 are diagonal matrices with entries    ( d^b,0)_a,=_a^ . by adding more columns to the matrix of eq.([eq - amp - mat - form - one - col ] )",
    ", one can extended it ( see section entitled  q - embeddings \" in ref.@xcite ) to a square matrix which can be expressed in terms of multiplexors as in fig.[fig - multi - qubit - nodes ] .",
    "the markov blanket @xmath80 for a node @xmath68 of the classical bayesian network @xmath7 satisfies ( see section entitled  notation and preliminaries \" in ref.@xcite )    p(x_i|x_)=p(x_i|x_mb(i ) ) .",
    "if the set @xmath80 is strictly smaller than the set @xmath81 , this property can be used to reduce the number of controls for the multiplexor in @xmath51 and @xmath52 corresponding to @xmath82 .",
    "given the two q - embeddings @xmath51 and @xmath52 for a bayesian network @xmath7 , we can define a unitary matrix @xmath83 as follows    u= u_2^u_1 .",
    "matrix @xmath83 has the following highly desirable property :    for any @xmath84 ,    r +    u    l +    = m_j _ j^k .",
    "r +    u^_2 u_1    l +    & = & _ y , x",
    "r +    l +     + & = & _ y , x _ 2^t(y|x)_1(y|x ) + & = & = m_j _ j^k .",
    "in this section , we will define a special type of szegedy quantum walk operator @xmath85 corresponding to a bayesian net @xmath7 .",
    "we will then find the eigenvalues of @xmath85 .      as in ref.@xcite ,",
    "define the projection operator @xmath86 and its dual projection operator @xmath87 by    =    c +    , = =    c +    .",
    "then the szegedy quantum walk operator @xmath85 for the bayesian net @xmath7 is defined by    w = u(-1)^u^(-1)^ .      to find the eigenvalues of @xmath85",
    ", we will use the following identities .",
    "[ cl - proj - ids ]    = ,    \\(u ) = m_j , [ eq - pi - u - swap ]    ( u^ ) = m^*_j , [ eq - pi - swap - u ]    for all @xmath88 .    from the definition of @xmath86",
    ", we see that    l +    =    l +    . also ,    ( u )    l +    = _ k    r +    u    l +    = m_j    l +    , and    ( u^ )    l +    = _ k",
    "r +    u^    l +    = m^*_j    l +    .",
    "an immediate consequence of claim [ cl - proj - ids ] is that    u = u = m_j_j^k , [ eq - u - swap - mat - elem ] for @xmath89 .    note that since @xmath46 , eq.([eq - u - swap - mat - elem ] ) implies that    = u .",
    "[ eq - u - swap - equals-1 ]    another consequence of claim [ cl - proj - ids ] is that @xmath90 is a stationary state of @xmath85 .",
    "indeed , one has    w&= & u ( -1)^ u^(-1)^ + & = & u ( 1 - 2 ) u^(-1 ) + & = & ( 1 - 2m_0u)(-1 ) + & = & ( 1 - 2)(-1 ) + & = & .",
    "busy^j = span\\ { , u } for @xmath91 .",
    "( by  span \" we mean all linear combinations of these vectors with _ complex _ coefficients . )",
    "[ cl - v - busy - j ] @xmath92 for all @xmath91 . for @xmath93 , let    = .",
    "@xmath94 is an orthonormal basis for @xmath95 and @xmath96 . for @xmath97 ,",
    "let    = ( e^-i_ju- e^i2_j ) .",
    "[ eq - psi - j - original - basis ] @xmath98 is an orthonormal basis for @xmath99 and @xmath100 .    using the identities of claim [ cl - proj - ids ]",
    ", one finds after some algebra that    [ eq - w - invariant - plane ] w= ( -1 ) + ( 2m^*_j)u , and    w(u)= ( -2m_j ) + ( -1 + 4|m_j|^2)u    for all @xmath11 .    according to eqs.([eq - w - invariant - plane ] ) , @xmath101 is invariant under the action of @xmath85 for each @xmath11 . by virtue of eq.([eq - u - swap - mat - elem ] ) , @xmath101 is 1-dim for @xmath93 and 2-dim if @xmath97 .",
    "we ve already proven that @xmath90 is a stationary state of @xmath85 .",
    "now consider a fixed @xmath102 .",
    "both @xmath103 and @xmath104 are reflections , and reflections are a special type of orthogonal matrix , so the product of these 2 orthogonal matrices is also an orthogonal matrix . in fact , it s a rotation about the axis perpendicular to the planar subspace @xmath101 .",
    "the vectors @xmath105 , and @xmath106 are independent but not orthogonal .",
    "however , we can express them in terms of orthogonal vectors ( see fig.[fig - e1-e2-def ] ) as follows :    = , and    e^-i_ju = ( _ j)+ ( _ j ) .    in the @xmath107 , @xmath108 basis",
    ", we find after substituting @xmath109 into eqs.([eq - w - invariant - plane ] ) that    w= .",
    "the eigenvalues of this matrix are @xmath110 , with corresponding eigenvectors :    = ( ) .",
    "[ eq - psi - j - e - basis ] these eigenvectors satisfy    = 0 , = = 1 . by expressing @xmath107 and @xmath108 in eq.([eq - psi - j - e - basis ] ) in the original basis , we get eq.([eq - psi - j - original - basis ] ) .    define the following vector spaces :    = span\\ { : x , ys _ } ,    _",
    "a= span\\ { : xs _ } ,    _ b = u_a , and    _ busy = _ a + _ b .",
    "@xmath111 can be expressed as a direct sum of @xmath112 and its orthogonal complement @xmath113 :    = _ busy_busy^. from claim [ cl - v - busy - j ] , it follows that @xmath112 is a direct sum of the subspaces @xmath101 :    _ busy = _ j=0^n_s-1 _ busy^j .",
    "[ eq - v - busy - direct - sum ] recall that matrices @xmath114 and @xmath28 are @xmath115 dimensional whereas @xmath85 is @xmath116 dimensional . since the size of @xmath13 is @xmath115 , @xmath117 . from eq.([eq - v - busy - direct - sum ] ) and claim [ cl - v - busy - j ] , @xmath118 .",
    "furthermore , @xmath119 is an orthonormal basis for @xmath112 .    at this point",
    "we ve explained the action of @xmath85 on @xmath112 , but we havent said anything about the action of @xmath85 on @xmath120 .",
    "next we show that @xmath85 acts simply as the identity on @xmath120 .",
    "( this is what one would expect since the vectors in @xmath120 are parallel to the axis of the @xmath85 rotation . )",
    "recall that if @xmath121 and @xmath122 are subspaces of a vector space @xmath111 , then @xmath123 .",
    "therefore ,    ^_busy = _ a^_b^. from the definitions of @xmath124 and @xmath125 , it s easy to see that    _",
    "a^=span\\ { : xs _ , ys_-\\{0 } } , and    _ b^=u(_a^ ) .",
    "w = for all @xmath126 .",
    "let @xmath127 . hence @xmath128 and @xmath129 for some @xmath130 .",
    "u ( -1)^ u^(-1)^ & = & u ( -1)^ u^(-1)^0 + & = & u ( 1 - 2 ) u^u + & = & u ( 1 - 2 ) + & = & .",
    "it s interesting to compare the present paper with ref.@xcite . for ref.@xcite , @xmath131 and @xmath24",
    "is a standard detailed balance for @xmath132 instead of a detailed balance for the pair @xmath25 .",
    "for ref.@xcite , @xmath133 , @xmath134 , @xmath135 , @xmath136 , @xmath137 , @xmath138 .",
    "when @xmath138 as in ref.@xcite , eq.([eq - pi - u - swap ] ) and eq.([eq - pi - swap - u ] ) are essentially identical , whereas in the @xmath139 case , it s less obvious that these two equations are true simultaneously .",
    "in this section , we will describe an algorithm for doing gibbs sampling on a quantum computer , utilizing the szegedy operator @xmath85 that we have so painstakingly discussed in previous sections .",
    "we begin by choosing will suggest some @xmath7 value that has non - zero probability .",
    "alternatively , one can proceed as follows . for definiteness , consider a bayesian net @xmath140 with 3 nodes .",
    "suppose @xmath141 and the functions @xmath142 @xmath143 and @xmath144 are known .",
    "choose @xmath145 such that @xmath146 . then choose @xmath147 such that @xmath148 .",
    "finally , choose @xmath149 such that @xmath150 .",
    "set @xmath151 . ]",
    "some @xmath152 for which @xmath153 . now define      = = .",
    "@xmath155 can be easily evaluated at a single point @xmath156 .",
    "our quantum gibbs algorithm consists of performing the original grover algorithm with beginning state @xmath157 and target state @xmath158 .",
    "define the following 2 reflection operators        l= ( ) . if @xmath162 , then @xmath163 iterations of @xmath159 will take the beginning state to the target state .",
    "is much larger than @xmath164 . ] to implement this use of grover s algorithm , we need to compile ( with polynomial efficiency ) the operator @xmath159 .",
    "@xmath165 is easy to compile ; it s just a single multiply - controlled phase . next",
    ", we will explain how to compile @xmath166 .",
    "fig.[fig - v - beta ] , which is identical to fig.18 in ref.@xcite , defines an operator @xmath167 in terms of multiple ( modified ) phase estimation steps .",
    "the @xmath167 of ref.@xcite depends on a parameter @xmath168 ( inverse temperature ) because the operator @xmath132 in that paper depends on this parameter .",
    "@xmath167 in the present paper does not depend on @xmath168 ( because the bayesian net @xmath7 does nt ) so we will drop the @xmath168 subscript from it henceforth , and refer to it simply as @xmath169 .",
    "@xmath169 does not depend on @xmath168 but it still depends on the positive integers @xmath170 and @xmath171 .",
    "( in the language of ref.@xcite , @xmath170=number of probe bits for each pe ( phase estimation ) step , and @xmath171=number of pe steps ) .",
    "note that operator @xmath85 is applied @xmath172 times by @xmath169 .",
    "+ ( ) , [ eq - v - approx ] where the @xmath178 are states of @xmath179 qubits such that @xmath180 . in eq.([eq - v - approx ] ) and for the remainder of this section , the top row represents the @xmath179 ancilla qubits shown in fig.[fig - v - beta ] , and the bottom row represents the @xmath181 qubits on which @xmath85 operates .                                    + ( ) .",
    "[ eq - r - tilde - tar - and - r - tar ] eq.([eq - r - tilde - tar - and - r - tar ] ) is the essence of corollary 2 in ref.@xcite .",
    "it means that @xmath166 acting on @xmath112 can be approximated by @xmath183 acting on @xmath177 . since we already know how to compile @xmath183 , we have accomplished our goal of compiling @xmath166 , at least approximately .",
    "if we define one step as one @xmath85 application , then the total number of steps for the whole algorithm is @xmath186 .",
    "thus , our algorithm will yield a sample of the classical bayesian net @xmath7 with precision @xmath187 , in @xmath188 steps .",
    "achieving the same precision with a classical gibbs sampling algorithm would require @xmath4 steps .",
    "the szegedy operator @xmath85 of this paper can also be used to do quantum simulated annealing and metropolis - hastings if the marginals @xmath189 can be calculated for each @xmath190 from the transition matrix @xmath191 .",
    "( in the case of simulated annealing , @xmath191 is different for each @xmath192 of the annealing schedule ) ."
  ],
  "abstract_text": [
    "<S> we present an algorithm for doing gibbs sampling on a quantum computer . </S>",
    "<S> the algorithm combines phase estimation for a szegedy operator , and grover s algorithm . for any @xmath0 </S>",
    "<S> , the algorithm will sample a probability distribution in @xmath1 steps with precision @xmath2 . here </S>",
    "<S> @xmath3 is the distance between the two largest eigenvalue magnitudes of the transition matrix of the gibbs markov chain used in the algorithm . </S>",
    "<S> it takes @xmath4 steps to achieve the same precision if one does gibbs sampling on a classical computer . </S>"
  ]
}