{
  "article_text": [
    "solar active phenomena such as solar flares , coronal mass ejections ( cmes ) , and filament eruptions are widely attributed to the release of magnetic energy in the solar corona ( and @xcite ) .",
    "many theoretical and numerical models have been proposed for understanding their dynamics and triggering mechanisms ( the details are summarized in @xcite ; @xcite ; @xcite . ) .",
    "however , a number of issues remain unanswered .",
    "for instance , we still do not have a proper view of the three - dimensional ( 3d ) coronal magnetic field related to an active region .",
    "earlier studies based on analytical or numerical models were categorized in terms of the loss of stability or loss of equilibrium , however , there are also a few cases that strongly depend on the magnetic configurations because the coronal magnetic field deduced from observational images is very complicated , and one can not extract its physical essence in term of the simplified analytical models .",
    "therefore , it becomes important to construct the coronal magnetic field on the basis of a numerical model by using the observational data and to investigate the physical condition of the equilibrium state before the flare .",
    "unfortunately , the 3d coronal magnetic field can not be directly observed even with the state - of - art solar physics satellite , whose observations can currently provide only the vector field on the photosphere .",
    "for these reasons , force - free extrapolation has been performed based on a vector field .",
    "the force - free field is expressed as follows ; @xmath1 or @xmath2 and it has been widely accepted as an approximation of the coronal magnetic field because the value of the plasma @xmath3 is very low ( @xmath4 ) in the solar corona . the force - free state is classified into three energy levels .",
    "one of them , called the potential field is the current free state _",
    "i.e. _ @xmath5 , hence , this corresponds to the minimum energy state .",
    "the linear force - free field ( lfff ) has a uniform distribution of @xmath6 , and this energy level is higher than the potential field . however the observed @xmath7 is generally a function of space on the photosphere .",
    "observations at various wavelengths often reveal a localized strong shear field close to the neutral line in the active regions before a flare ( _ e.g. , _",
    "@xcite;@xcite ) . from these observational images and results , we know that the potential and lfff can not adequately explain the coronal magnetic field before the flare ; thus , the nonlinear force - free field ( nlfff ) has been considered to model the active region s magnetic field . because the force - free equation is essentially nonlinear , it is not straightforward to solve it for the coronal magnetic field .",
    "the solution is obtained only numerically through an iteration process for a fixed vector field on the bottom boundary , whereas the potential field and lfff are calculated easily from the normal component of the magnetic field on the solar surface ( @xcite ) .",
    "various methods of obtaining nlfff solutions have been proposed and developed . for the sake of brevity ,",
    "we do not review them thoroughly here ; interested readers are urged to see the comprehensive reviews on this topic by @xcite , @xcite or @xcite .",
    "representative methods for extrapolating the force - free coronal magnetic field include time - evolutionary methods as well as iterative methods ( _ e.g. , _ the boundary integral method of @xcite ; @xcite and the grad - rubin methods of @xcite ; @xcite ; @xcite ; ) , which iterate an equation to find a solution([ff_eq_1 ] ) . @xcite and @xcite developed the magnetohydrodynamic ( mhd ) relaxation method , which directly solves the mhd equations under the zero @xmath3 approximation ( @xcite ) .",
    "these equations include the resistivity which allows the field lines to change their topology rapidly toward a force - free state .",
    "the calculation begins with the construction of a potential field from the normal component of the magnetic field on the photosphere and a force - free state is obtained by controlling the transverse electric field and keeping the magnetic flux @xmath8 according to an induction equation toward the normal component of the current density deduced from the vector field . @xcite and @xcite recently developed a force - free extrapolation code based on the mhd relaxation method that includes the gas pressure , viscous and resistive terms .",
    "that code is implemented into the space - time conservation - element and solution - element method constructed using full mhd system and a modern high - performance numerical method ( @xcite ; @xcite ) .",
    "@xcite developed a force - free extrapolation code that included an induction equation with a hypothetical velocity against the lorentz force , which is a simplified formation from @xcite and @xcite .",
    "this formula was originally introduced by @xcite to obtain a magneto - frictional method .",
    "in addition , this calculation is classified into two phases , stress and relaxation after a potential field is constructed as an initial state from the normal component of the magnetic field on the photosphere . in the stress",
    "phase a lorentz force is injected from the bottom boundary so that the transverse components of the vector potential approach the observed transverse field . in the relaxation phase ,",
    "the upper coronal field relaxes toward a force - free state under the fixed bottom boundary . because of these two combined effects in this method",
    ", it is called stress and relaxation method .",
    "some authors have already implemented this method into their own code (;",
    "the resistivity included in the induction equation permits the magnetic reconnection to accelerate the process of the force - free state ; thus it plays the same role as in @xcite and @xcite",
    ". introduced the magnetic induction field vector to replace the vector potential .",
    "this make it easier to implement the boundary condition than in the original stress and relaxation method of @xcite .",
    "they applied their extrapolation method to the twisted loops obtained from and found that the nlfff performs reasonably well for reconstructing of the twisted loops in the localized area close to the neutral line .",
    "the improved code of the @xcite and is applied to the ideal force - free field introduced by @xcite and also to a more complex situation by .",
    "@xcite inserts a twisted magnetic flux tube into a potential field and the magnetofriction ( @xcite ) drives as system toward a force - free state without the transverse component on the photosphere ; its magnetic configuration is then compared with observational images .",
    "another method is an optimization method originally proposed and developed by @xcite and an improved version of it presented by @xcite , which minimizes a function consisting of divergence - free and force - free fields .",
    "although the basic equation in the optimization method also includes a higher - oder differential equation , which is difficult to solve even numerically , highly accurate reconstruction is recorded in some papers ( _ e.g , _",
    "@xcite )    recently the solar optical telescope(sot ) on board _ hinode _",
    "( @xcite and @xcite ) can provide images of the vector field with a high spatial resolution ( more than 1k pixels ) .",
    "moreover , the helioseismic and magnetic imager ( hmi ) on board the _ solar dynamics observatory ( sdo ) _ can provide vector field data with a high temporal resolution ( every 12s ) , which enables analysis of the nlfff in unprecedented temporal resolution .",
    "thus it would be interesting to see the performance of the nlfff with these high - resolution data .",
    "the purpose of this study is to develop an extrapolation code for the nlfff that accelerates the calculation time even when these high - resolution data are used .",
    "we extended the original mhd relaxation method of @xcite and @xcite in two important ways .",
    "first , we implemented an algorithm to prevent the deviation from @xmath9 introduced by @xcite , in which the time dependent term corresponding to @xmath10 ( see equation [ div_eq ] ) is used to remove the numerical error of @xmath11 .",
    "second , we implemented a multi - grid - type method ( @xcite ) to more rapidly propagate information on the boundary condition at a larger scale inside the domain than in the smaller component , which accelerates the speed towards a force - free state .",
    "the accuracy and reliability are investigated by using the ideal force - free solution introduced by @xcite .",
    "we further apply our extrapolation code to the mhd solution obtained from the flux emergence simulation by @xcite to investigate the reliability of the nlfff extrapolation in a real physical situation .",
    "this paper is constructed as follows .",
    "the extrapolation and numerical methods are described in section2 .",
    "the result of the reconstruction using the low @xmath12 lou solution is presented in section 3 and whereas the mhd solution from @xcite is shown in section 4 .",
    "finally , some important discussions and conclusions are summarized in section 5 .",
    "we developed an nlfff extrapolation code based on mhd relaxation by implementing the multi - grid - type procedure and an algorithm for cleaning the errors related to @xmath13 .",
    "we demonstrated the performance of this method in our previous studies , _",
    "e.g. _ , @xcite , @xcite , @xcite and @xcite .",
    "nevertheless , several issues were not covered extensively in the previous works and require more detailed explanations .",
    "this method is formulated using the zero - beta mhd equations where the gas pressure and gravity are neglected ( @xcite ) to achieve a force - free state . in this study , we numerically solve the following equations @xmath14",
    "@xmath15    @xmath16    @xmath17    where @xmath18 is the magnetic flux density , @xmath19 is the velocity , @xmath20 is the electric current density , @xmath21 is the pseudo density , and @xmath10 is the convenient potential .",
    "the pseudo density is assumed to be proportional to @xmath22 in order to ease the relaxation by equalizing the alfven speed in space .",
    "the last equation ( [ div_eq ] ) introduced by @xcite plays a crucial role in avoiding deviation from @xmath23 . from equations ( [ induc_eq ] ) and ( [ div_eq ] ) , we can obtain the following equation : @xmath24 which illustrates the propagating and diffusing nature of the numerical errors related to @xmath25 , where @xmath26 and @xmath27 correspond to the advection and diffusion coefficients , respectively .",
    "the main advantages of this method are that ( i ) it can be very easily implemented in our numerical code without the need for many improvements and ( ii ) it accelerates the process of removing errors and does not take as much time as that required to remove errors by solving the poisson equation ( see @xcite or @xcite ) .",
    "the length , magnetic field , velocity , time and electric current density are normalized by @xmath28 , @xmath29 , @xmath30 , @xmath31 , and @xmath32 , respectively .",
    "the non - dimensional viscosity @xmath33 is set to a constant , @xmath34 , and the non - dimensional resistivity @xmath35 is given by the functional    @xmath36    where , @xmath37 depends on each case , as shown in table [ tbl-1 ] , and @xmath38 is fixed at @xmath39 in non - dimensional units .",
    "the second term is introduced to accelerate the relaxation to the force - free state particularly in the weak field region .",
    "the parameters @xmath40 are fixed at constants 0.1 , whereas @xmath41 varies according to table [ tbl-1 ] .",
    "the velocity field is adjusted in such a way that it does not correspond to a large value ; otherwise , it would affect the courant - friedrichs - lewy condition .",
    "we define @xmath42 and if the value of @xmath43 becomes larger than the value of @xmath44 as given in table [ tbl-1 ] , the velocity is modified as follows : @xmath45    two different types of boundary conditions are applied in this study to extrapolate the 3d coronal magnetic field .",
    "the first is that all six boundaries are set to the exact solutions obtained from low @xmath12 lou .",
    "we denote this boundary condition as ex . in the second ,",
    "only the bottom boundary is set to the exact solution from low @xmath12 lou or @xcite and the other boundaries are assumed to act like rigid walls ; _ i.e. , _ the normal component of the magnetic field is fixed at the original solutions , and the tangential component is determined by the induction equation as described in equation ( [ induc_eq ] ) .",
    "we denote this boundary condition as rw , which is less information than it in ex . in all cases , the velocity field ( @xmath19 )",
    "is set to zero on all the boundaries . a neumann - type boundary condition ( @xmath46 )",
    "is applied for the potential @xmath10 at all the boundaries , where @xmath47 represents the derivative for the normal direction on the surface .",
    "the initial condition is given by a potential field calculated from the normal component on all the boundaries for all cases .",
    "in the ideal force - free cases ( the low @xmath12 lou solution ) , we apply the exact solutions directly on each boundary surface . on the other hand , in the mhd solution obtained from @xcite ,",
    "the handling of the bottom boundaries differs from that in the ideal force - free case except for the normal component . in this case",
    ", we introduce a procedure analogous to the stress and relaxation method .",
    "the transverse component @xmath48 is defined as a linear combination of @xmath49 and @xmath50 on the bottom surface as follows : @xmath51 where @xmath49 and @xmath50 are the transverse components of the observational ( mhd solution in this study ) and the potential field , respectively .",
    "@xmath52 is a coefficient ranging from rage of 0 to 1 .",
    "when @xmath53 , which is introduced as an indication for the force - free state , drops below a critical value denoted by @xmath54 during an iteration , then @xmath52 grows according to @xmath55 , where d@xmath52 is also given as a parameter .",
    "@xmath52 becomes equal to 1 ; then @xmath48 can be completely consistent with the observational data .",
    "as for the numerical method , the spatial derivative is approximated by the second - order finite difference and a time integration is conducted , using the runge - kutta - gill method to fourth - order accuracy .",
    "furthermore , we adapt the multi - grid - type method to accelerate the procedure for achieving a force - free state .",
    "this method contains the several distinct numerical grids with different resolutions ; the first calculation starts using the coarsest one to obtain a force - free field , and then we use this as an initial condition for the second high - resolution grid . consequently by repeating these procedures , the high - resolution force - free state can be obtained in a short time .    the simulation domain in the ideal force - free case is set to @xmath56 defined as non - dimensional values , and this is divided into @xmath57grids , @xmath58 grids , @xmath59grids , or @xmath60 grids , case3m1 , case3m2 , case1m1 and case1m2 shown in table [ tbl-1 ] are applied for the multi - grid - type method , whereas direct calculation is applied for case0-case5 , without it . on the other hand , for the mhd solution , the entire numerical domain is set to @xmath61(mm@xmath62 ) following @xcite , and extracted from the original data ; then the total grid number is assigned as @xmath63 .",
    "all the parameters in each case are given in table [ tbl-1 ] .",
    "all of the physical values are normalized using @xmath64(mm ) and @xmath65(g)(see @xcite for details ) ; consequently , the numerical domain is set to @xmath66 in non - dimensional space .",
    "we first check the accuracy of the numerical code for the ideal force - free solution introduced by @xcite . a 3d view of this solution is shown in figure [ f1 ] ( a ) . the lines and background color indicate the magnetic field lines and distribution of the normal component of the magnetic field , respectively .",
    "figure [ f1](b ) shows the potential field extrapolated from the normal component of the magnetic field on all the boundaries , which is used as an initial condition in the nlfff calculation.we calculated the three cases denoted as case @xmath67 where @xmath67 = 0@xmath682 .",
    "case0 corresponds to the boundary condition ex , where we also do not use equation([div_eq ] ) .",
    "case1 and case2 correspond to the boundary conditions ex and rw , respectively .",
    "more detailed informations on case1 and case2 are given in table [ tbl-1 ] .",
    "figures [ f2 ] ( a ) and ( b ) show iteration profiles of @xmath69 and @xmath70 for different cases .",
    "we clearly found that case1 and case2 tends toward a force - free state , because the r and d profiles decrease with each iteration .",
    "iteration was stopped when r reached a minimum value .",
    "case0 shows a much different profile from those of case1 and case2 .",
    "this result indicates that an iteration profile approaching a force - free state is very sensitive to numerical errors in the deviation from @xmath71 . the difference between case1 and case2",
    "is determined by the differences in the lateral and top boundary conditions between them .",
    "even though incomplete lateral and top boundaries in rw are given in case2 , the values of r and d are found to be equal order of magnitude of that in case1",
    ". however , case2 takes about twice as long as case1 to search for the force - free solution .",
    "the three - dimensional nlfff structures for case1 and case2 are shown in figures [ f3](a ) and ( b ) , respectively .",
    "the color contours represent a connectivity error that is defined as @xmath72 @xmath73 ( @xmath74 ) is the distance from one magnetic field line footpoint to another measured on the bottom surface in the exact(nlfff ) solution .",
    "the nlfff solutions in case1 and case2 seem to have almost the same configuration as that of the exact low @xmath12 lou solution shown in figure [ f1](a ) .",
    "the connectivity errors between these cases also have the same distributions , a random distribution in the entire domain .",
    "we investigate the magnetic topology to clarify the cause of the connectivity error .",
    "we used the photospheric cross - section of the quasi - separatrix layers ( qsls ) introduced by .",
    "we calculated the following quantity at each pixel on the vector field maps : @xmath75                                } ,     \\label{qsl}\\ ] ] where @xmath76 is the relative distance corresponding to @xmath77 .",
    "@xmath78 and @xmath79 are the positions of the end points of the field lines whose starting points are two adjacent grid points located at ( @xmath80 , @xmath81 ) and ( @xmath82 , @xmath83 ) on the photospheric surface .",
    "this means that the locations of the end points of these field lines , which are traced from these start points across a large n(x , y ) value , may differ greatly .",
    "figures [ f3](c ) and ( d ) show the connectivity error in white contours whose magnitude corresponding to 0.05 over the distribution log(n ) mapped on the bottom surface .",
    "we clearly see that the connectivity errors are almost on the enhancement layers at considerable distance from a polarity inversion line . from this analysis",
    ", we found that , remarkably , the error in the nlfff appears in particular regions where the magnetic topology is changing dramatically .",
    "we show these particular regions in detail .",
    "figures [ f3](e ) and ( f ) show the connectivity errors in the same format as figures [ f3](c ) and ( d ) over a map of the open - closed field lines in case1 and case3 , respectively . closed means that both footpoints of each field line are anchored in the bottom surface ; for the open field , one footpoint goes through the side or top boundaries .",
    "these results clearly show that the connectivity errors appear along the boundaries between open and closed field lines . on the other hand ,",
    "the values obtained from this study are @xmath84 , but most of regions are occupied by values less than 0.25 , which is much smaller than the entire length of the numerical domain .",
    "consequently , this is not due to a change in the topology from open to closed lines or vice versa ; rather , each outer loop of the open or closed field lines deviates slightly from the reference field .",
    "furthermore , figure [ f3](f ) shows a plot in the same format with a higher resolution than that of figure [ f3](e ) , which can reduce the error distribution .",
    "we further performed a detailed quantitative analysis as introduced by @xcite .",
    "when @xmath18 and @xmath85 represent the semi - analytical low @xmath12 lou solution and the extrapolated solution , respectively , the accuracy of the nlfff is estimated by the following sequential relations ; @xmath86    @xmath87    @xmath88    @xmath89    @xmath90    where @xmath91 is the vector correlation , @xmath92 is the cauchy - schwarz inequality , @xmath93 is the mean vector error , @xmath94 is the normalized vector error , @xmath95 is the energy ratio , and n is the number of vectors in the field .",
    "these results are summarized in table.[tbl-2 ] .",
    "figure [ f4](a ) shows the iteration profiles of 1@xmath96 for case1 and case2 .",
    "the final values reach 0.95 in both cases .",
    "we clearly see that both case1 and case2 can reconstruct the original low @xmath12 lou solution with good accuracy and no significant difference is found between them even though case2 takes a longer calculation time than case1 .",
    "finally , we performed another quantitative analysis by evaluating the force - free @xmath7 in both footpoints of each field line . because the value of the force - free @xmath7 should be constant along the field line ( cf . , equation ( [ ff_eq_2 ] ) ) their values at the both footpoints of each field line should be equal in order to satisfy the force - free condition .",
    "the force - free @xmath7 in both footpoints for case1 and case2 , measured on the surface above first grid above the bottom one , are mapped in figures [ f4](b ) and ( c ) , respectively .",
    "the horizontal and vertical axes represent the values of the force - free @xmath7 at each footpoint where the diagonal green line corresponds to @xmath97 .",
    "if an extrapolated field completely satisfies the force - free state , the force - free @xmath7 will be distributed along this line .",
    "because most points in case1 and case2 are along the green line , this result clearly shows that these cases almost satisfy the force - free state well .        we present a procedure for a multi - grid - type method , which is needed to accelerate the calculation time for high - resolution magnetogram data obtained from",
    "e.g. , _ sot/_hinode_. some algorithms have already implemented it , and an accelerated calculation speed was reported ( _ e.g. , _",
    "@xcite and @xcite ) .",
    "first , we extrapolate an nlfff with the coarsest grid @xmath98 , to rapidly propagate large - scale information from a boundary into an interior domain .",
    "when the value of r ( @xmath99 ) reaches a minimum the grid number is changed to @xmath100 by using a linear interpolation ; the exact boundary conditions are maintained , and its location and other parameters are fixed as those in the previous calculation except that @xmath37 set to zero .",
    "this process is repeated until a force - free field is achieved under given grid points with the highest resolution ; therefore , this method is not a full multi - grid method .",
    "the detailed information is given in the table.[tbl-1 ] .",
    "we performed our calculations using two different patterns , _",
    "run1 and run2 , using a multi - grid - type method whose final results are obtained in three steps .",
    "first , we examined the performance related to run1 with an initially assignment of the coarsest grid number @xmath58 grid points denoted as case3 .",
    "after attaining a force - free state with this number of grid points , a higher resolution of ( @xmath59 ) was obtained by using the force - free field realized in the previous step as an initial condition , which is referred to case3m1 . in the same way , the highest resolution of ( @xmath60 )",
    "was achieved in case3m2 . for comparison with case3m1 , we also calculated case4 , in which @xmath59 grid points are assigned , but without an implementation of the multi - grid - type method .",
    "figures [ f5](a ) and ( b ) show the results related to iteration profiles of @xmath101 and @xmath102 corresponding to run1 .",
    "the coarsest grid level @xmath58 gradually decreases by @xmath103 at about @xmath104 iterations ; the calculation takes 12h in real time and @xmath105 reaches about 0.98 , as shown in table.[tbl-2 ] .",
    "although r and d suddenly increase as the grid number changes from @xmath58 to @xmath59 , they immediately decrease by about @xmath103 again .",
    "this sudden increment in r and d due to the change in the grid is clearly the result of a numerical error arising from an interpolation .",
    "however , this error rapidly decreases within @xmath106 iterations , as this scale is small compared to the previous grid , so the diffusion may be effective in decreasing the numerical error associated with a higher mode .",
    "the green line corresponding to @xmath59 grids can reach @xmath103 at about @xmath107 iterations , which is marked by the green circle ; the total calculation time takes about 45 h in real time . on the other hand , in case4 , which is also assigned to the @xmath59 grids but without the multi - grid - type method , the value of r marked after a total calculation time of 100 h , by a black circle , is found to be one order larger than that for case3m1 .",
    "the multi - grid - type method significantly reduces the calculation time .",
    "hence , we clearly see that it is an effective method for analyzing high resolution data .",
    "the final state , plotted by the purple lines , can achieve a high - resolution force - free field given by @xmath60 grids .",
    "figures [ f5](c ) shows a distribution map of the force - free @xmath7 for case3m1 at the green solid circle in figure [ f5](a ) ; the map is in the same format as figures [ f4](b ) or ( c ) .",
    "we see that many red points appear along the green lines although a slight deviation appears in the range of 0@xmath1082.0 .",
    "however , the overall pattern of the extrapolated field satisfies a state close to the force - free state . on the other hand ,",
    "figure [ f5](d ) shows the results for the case4 , marked by the dotted black circle in figure [ f5](a ) , where the calculation time is the same as that for @xmath109 iterations at the end of the calculation in case3m1 .",
    "as expected , many points deviate from the force - free state .",
    "thus , an implementation of the multi - grid - type method yields a force - free state in a dramatically short time .",
    "the procedure for run2 is basically the same as that of run1 except for the assigned grid numbers . in run2",
    "@xmath57 grids points are initially assigned , corresponding to the coarsest grid and initial condition in case1 . eventually ,",
    "following the same procedure in run1 , we obtain a force - free state with @xmath58 and @xmath59 grid points , which are called case1m1 and case1m2 , respectively .",
    "figures [ f6](a ) and ( b ) show the results on the r and d profiles , respectively , for each case ( case1 , case1m1 , and case1m2 ) .",
    "the black line corresponds to case4 , which is the same as in run1 .",
    "the green and black solid circles represent 2.0@xmath110 iterations , corresponding to the end of the calculation with @xmath111 grid points , for case1m2 and case4 , respectively .",
    "the total calculation times were approximately 30 h and 67h , respectively .",
    "further , the black dotted circle represents 8625 iterations for case4 , corresponding to the same calculation time as that required for 2.0@xmath110 iterations of the multi - grid - type case .",
    "although the r and d profiles in multi - grid cases reach to values of less than @xmath103 , as with the previous multi - grid - type case , run1 , the quantitative value @xmath105 shown in table [ tbl-2 ] does not increase from its initial value of 0.95 ( obtained from the initial coarsest grid ) with increasing grid numbers .",
    "we further checked the distribution map of the force - free @xmath7 .",
    "figures [ f6](c ) and ( d ) show a distribution map of the force - free @xmath7 for case1m2 and case4 , marked by the solid green and dotted black circles , respectively , in figure [ f6](a);the format is the same as in figures [ f5](c ) or ( d ) .",
    "case1m2 in the region @xmath112 is found to yield a better reconstruction in a short time than case4 .",
    "however , for 0 @xmath108 3.0 , this case , as well as case3m1 , seems to deviate slightly from the force - free state . in comparison ,",
    "figure [ f4](b ) , which shows a distribution map of the force - free @xmath7 in the initial state , shows a better force - free state than case1m2 even for @xmath113 .",
    "hence , this error is clearly derived from an interpolation through a change in the grid that critically affects the value of @xmath105 , as reported by @xcite .",
    "figure [ f7](a ) plots contours of the force - free @xmath7 to clarify why the reconstructed field in the region of weak force - free @xmath7 ( 0@xmath1143.0 ) deviated from the force - free state when the multi - grid - type method is used , as such as shown in figures [ f5 ] and [ f6 ] .",
    "the red , green , and blue contours indicate strengths of the force - free @xmath7 corresponding to 2.0 , @xmath682.0 , and @xmath684.0 , respectively . from figure [ f7](a ) , a region of strong force - free @xmath7 appears in the central region , where the extrapolated field satisfies the force - free state well , as shown in the previous results . on the other hand regions of weak negative and positive force - free @xmath7 , r1 and r2 lie at considerable distances from the central region in the numerical domain where the force - free @xmath7 is distributed in a range of 2.0@xmath108 4.0 and @xmath682.0 @xmath108 0 , respectively .",
    "figure [ f7](b ) also shows the magnetic field lines , most of which in r1 and r2 are rooted in a region near the boundaries of the domain ; _",
    "i.e. , _ the numerical errors remarkably appear near the boundaries through an interpolation accompanying a change in the grid number .",
    "however , as in figure [ f6 ] , the extrapolated field in the strong force - free @xmath7 regions exhibits a better force - free state even when the multi - grid process is used .",
    "thus , the core region in particular can be reconstructed with good accuracy in a dramatically short time by using it .",
    "we found that our nlfff extrapolation method performed remarkably well in reproducing an ideal force - free state .",
    "next , we applied it to a flux - emergence region obtained from an mhd simulation ( @xcite ) .",
    "the idea was to check its performance for a region that is quite close to the real corona .",
    "the simulation results of the @xcite provided a hypothetical state of the solar corona affected by the pressure , gravity field , and non - equilibrium state that differs greatly from the ideal force - free field introduced by low @xmath12 lou . in this study , we focus on how well the sheared and twisted field lines in the lower corona are reconstructed by our nlfff method ; most of the free energy is accumulated in these lines , and they are treated as the most important parts for solar active phenomena such as solar flares and cmes . in the following section ,",
    "we quantitatively compare the differences in the 3d configurations yielded by the mhd solution and nlfff extrapolation and finally estimate the degree of twist in them .",
    "@xcite surveyed the dynamics of flux emergence with respect to a wide range of parameters set at the initial time of the twisted magnetic flux tube . in this study , we select one snapshot at the last moment of the mt case ( see table 1 in their paper ) , in which a flux tube embedded in the convection zone has emerged into the solar corona and formed coronal magnetic loops .",
    "first , we introduce the basic components of the magnetic field obtained from the mhd simulation , which is used as the boundary condition in our nlfff extrapolation method .",
    "figure [ f8](a ) shows a height profile of the integrated plasma @xmath3 defined as @xmath115 ) , where @xmath116 and @xmath117 represent the average plasma and magnetic pressure , respectively , in a horizontal plane ; @xmath118 and @xmath119 . near the bottom surface ,",
    "a high-@xmath3 ( @xmath120 ) regime is formed , which is suddenly converted into a low-@xmath3 regime ( @xmath121 ) around an intermediate height and finally again reaches a value similar to that at the bottom boundary as the height increases .",
    "we select the boundary condition at @xmath122 which corresponds to case5 ( marked by solid circles ) .",
    "the distribution of the normal component of the magnetic field in case5 is shown in figure [ f8](b ) .",
    "it is formed by the emerging flux tube at 2700(km ) above photosphere in the mhd simulation .",
    "the value of the magnetic field is normalized by its maximum value at this height .",
    "hereafter , this height is regarded as the bottom surface .",
    "figure [ f8](c ) shows height profiles of the integrated force - free @xmath7 ( @xmath123 ) and the non - force - free component ( @xmath124 ) , denoted as @xmath125    @xmath126    the value of @xmath123 is larger than that of @xmath124 in those regimes where the condition of low @xmath127 is satisfied well .",
    "the solid circle indicates the result for the case5 , where @xmath123 is competing with @xmath128 .",
    "however , this mhd solution does not satisfy the equilibrium state completely ; therefore , we have to estimate the degree to which the lorentz force is accumulated in the selected boundary condition , as shown in figure [ f8](b ) .",
    "we estimate it using the following values : @xmath129    @xmath130 where s represents a surface on the bottom boundary , and @xmath131 and @xmath132 correspond to the force balance and torque balance parameters , respectively .",
    "when @xmath133 and @xmath134 , the boundary surface approximately satisfies the force - free condition ( @xcite ) . as a result , in this case(@xmath1350.275 and @xmath1360.382 ) , they are deviate from the force - free state ; nevertheless these values are close to the sp/_hinode _ data for dec.12 , 2006 according to @xcite .",
    "figure [ f8](d ) shows profiles of the integrated velocity with respect to the @xmath137 direction ( @xmath138 ) with a map of the current density in the same format as ( @xmath139 ) .",
    "we clearly see that the color is strongly enhanced in the lower central area in which the core field is formed .",
    "the large velocity fields , plotted by the white contours , are concentrated on the area around the half - height of the entire box , marked by the red dashed line .",
    "consequently , we infer that extrapolation of this region is difficult ; however , one of our interests is to address how well the core field is reconstructed under this condition .",
    "first , we show the one - dimensional result from the nlfff and compare them with the mhd solution .",
    "figure [ f9](a ) shows iteration profiles of the total lorentz force r ( solid line ) and magnetic energy e ( dashed line ) corresponding to case5 .",
    "@xmath52 as defined in the equation ( [ step_eq ] ) is equal to 1 , and the other parameters used in this nlfff calculation are shown in table [ tbl-1](see case5 ) .",
    "the nlfff is selected at @xmath140 iterations , at approximately which r and e begin to saturate .",
    "figure [ f9](b ) shows the height profiles of @xmath123 in the mhd solution ( dashed line ) and @xmath141 in nlfff ( solid line ) for case5 .",
    "the values of @xmath141 and its pattern deviates slightly from those of @xmath123 corresponding to those regimes where the value of @xmath123 is dominant over @xmath124 , as shown in figure [ f8](b ) . on the other hand , these values and profiles of @xmath141 are found to deviate greatly from those of @xmath123 in the upper area , above the half - height of the entire domain .",
    "next , we show a 3d view of the mhd simulation and nlfff and present a detailed comparison in terms of the magnetic topology",
    ". figures [ f10](a ) shows a top view of the selected field lines obtained from the mhd solutions for case5 .",
    "these are traced from the surface , which is 2700(km ) above the photosphere , as shown in figure [ f8](a ) .",
    "figure [ f10](b ) also shows the selected 3d field lines in the nlfff , which are also extrapolated from the same surface as those described above . from these results",
    ", we infer that although they are not exactly the same , the nlfff seems to reproduce an inverse s shaped structure lying above the polarity inversion line and is qualitatively similar to the mhd solution .",
    "it is important to capture these s or inverse s shaped structures because they are considered to be precursors for huge flares ( @xcite ) observed in solar active regions .",
    "we further investigate the magnetic topology in more detail to clarify the differences in between the nlfff and mhd solutions .",
    "figures [ f10](c ) and ( d ) show the distribution of the field line length mapped on the bottom surface for the mhd solution and the nlfff , respectively .",
    "one footpoint of the field lines rooted in the white areas is not at the bottom surface ; that is , their other footpoints is rooted in the lateral boundary surfaces , whereas the other field lines traced from colored areas are closed .",
    "therefore , the boundaries between the colored and white areas represent the separatrix separating the closed and open field lines , in which the qsl values are enhanced .",
    "the inverse s shaped structure can be formed by the nlfff as well as by the mhd solution , and this structure is better captured in the nlfff except in the regions marked by the dashed circle in which the closed loops are anchored .    to provide more clarification , we also show the field line structure within the dashed circle in figure [ f10](d ) in more detail .",
    "figures [ f11](a ) and ( b ) show the field lines ( red ) in the mhd and nlfff , respectively , traced from the area marked by the dashed circle in figure [ f10](d ) .",
    "the field line profiles in mhd and nlfff are remarkably different .",
    "one footpoint of the field line in the mhd solution touches the lateral surface : i.e. , the line crosses the boundary surface , whereas both footpoints in the nlfff touch the bottom surface .",
    "figures [ f11](c ) and ( d ) show the distribution of the height of one footpoint of the field line measured from bottom surface in the mhd and nlfff .",
    "all of the field lines are traced from the bottom surface , and most of their footpoints appear in the lower areas plotted in red . on the other hand , we see strong enhancement areas , which are marked by dashed circles , in the mhd solution , whereas these regions are not seen in the nlfff .",
    "these enhanced areas indicate that the height of one footpoint of the field lines is above the half - height of the numerical domain ; therefore , it might be difficult for the nlfff to capture these field lines in this case .",
    "finally we compare the magnetic twist obtained using the nlfff with that in the mhd solution .",
    "this value represents the degree of twist of a magnetic field line as determined by the measurement of the magnetic helicity generated due to the current parallel to a field line ( @xcite ; @xcite ; ; @xcite ; @xcite ; @xcite ) . because a large amount of magnetic twist can lead to an unstable condition ( @xcite ; @xcite ; ; @xcite ; @xcite ; @xcite ; @xcite ) , an estimation of the magnetic twist is important for analyzing the stability of the solar coronal magnetic field .",
    "we are interested in addressing the extent to which the magnetic twist can be reconstructed .",
    "the magnetic twist is defined as , @xmath142 where the line integral @xmath143 is taken along a magnetic field line , and the force - free @xmath7 is calculated from @xmath144 .",
    "figure [ f12 ] shows the distributions of the magnetic twist in each field line from the mhd solution , where the nlfff is also mapped on the surfaces at the same height .",
    "positive and negative values indicate right - handed and left - handed twists , respectively , depending on the value of the magnetic helicity accumulated in an initial flux tube embedded in the subsurface .",
    "the black contours show the normal component of the magnetic field .",
    "we clearly see that the strongly twisted regions in the mhd solution are localized at positive and negative polarities , in which the strong twist values over one turn ( @xmath145 ) are found near the vicinity of the tip .",
    "in contrast , although the strongly twisted regions in the nlfff are also localized in the same areas at the both polarities , their distributions and values are not the same as those of the mhd solution .",
    "the areas marked by the red circles are remarkably different in both cases ; in the nlfff , closed field lines exist in these areas , whereas that type of field line is not seen in the mhd solution . although the reconstructed twisted lines in other areas tend to capture those in the mhd solution , their values are relatively weak in most regions near the tip at both polarities , whereas a high twist value , @xmath145 , is also observed in some areas .",
    "these results show that the shape of the sheared field lines is reconstructed well qualitatively ; on the other hand , the value of the magnetic twist tends to be weaker than that of the reference field .",
    "in this study , we developed an nlfff extrapolation code based on the mhd relaxation method and applied it to the ideal force - free field introduced by @xcite .",
    "our nlfff extrapolation code generally produces the original ideal force - free state , even though incomplete lateral and top boundary conditions are imposed .",
    "moreover , although errors related to the connectivity of the field lines clearly appeared along the separatrix layers ( qsl ) , their topology is not changed dramatically .",
    "we further implemented the multi - grid - type method in our nlfff extrapolation code , which increased calculation speed toward a force - free state compared to the code without it .",
    "we see that the inner region of the numerical domain in particular can be reconstructed with high accuracy .",
    "thus , our code can be used as a possible method for extrapolating the nlfff in a shorter time using a high - resolution vector field obtained from sot/_hinode _ or hmi/_sdo_.    next , we also applied our extrapolation method to the mhd solutions obtained from @xcite , which are influenced by the gas pressure , gravity , and non - equilibrium state . in principle , it does not seem appropriate to apply the nlfff to mhd solutions ; nevertheless , in the interest of readers , we also checked the effectiveness of the nlfff extrapolation for a more realistic situation of the solar corona . as a result",
    ", we found that the s - shaped sheared structure formed in the lower corona can be captured well by our nlfff despite the difference in the value of the twist and the profile compared to the original mhd solutions .",
    "thus , we conclude that our nlfff extrapolation can work in the lower coronal region , in which a strong current is stored",
    ".    our nlfff extrapolation may be less effective for reproducing the upper region of the entire numerical domain .",
    "note , however , that the numerical solutions of @xcite describe an extreme situation compared to the real solar corona . for example , a pre - existing coronal field is not assumed in this mhd simulation , and in such a situation the magnetic loops fulling the upper area can expand continuously in all directions , as pointed out by @xcite and @xcite ( see figure 8) .",
    "therefore , it might be difficult for the nlfff to reconstruct this type of field line , as shown in our results ( figures [ f11 ] and [ f12 ] ) .",
    "we believe that a consideration of the pre - existing coronal magnetic field may be important in suppressing the expanded loops during the process of flux emergence and achieving a steady state under which an s or inverse s - shaped field may be formed .",
    "we expect that our nlfff extrapolation might be able to reproduce these regions with better accuracy than that in the results presented here .",
    "these results are derived from one of the results of @xcite , and our interests are in further addressing the extrapolation of the coronal magnetic field using boundary conditions formed by stronger or weaker twisted flux tubes , or with various plasma @xmath3 values .",
    "however , these remain as future works .    on the other hand ,",
    "a non - force - free extrapolation method has been developed recently by other authors ( _ e.g. _ , ; @xcite ; @xcite ; @xcite ) .",
    "these methods are still being improved and are expected to be a solid tool for capturing the mhd solution more accurately in the near future .    from this study",
    ", we conclude that the extrapolated field can robustly reproduce an ideal force - free state , _",
    "e.g. , _ the low @xmath12 lou solution .",
    "in contrast for the mhd solutions obtained from the flux - emergence simulation , this method captures the sheared field , such as elbow - like structures lying in the lower corona , in which the strongest energy is accumulated .",
    "therefore , the extrapolated field may provide a better understanding of active phenomena in the solar corona .",
    "because the sp/_hinode _ and hmi/_sdo _ can observe the vector field with high spatial and temporal resolution , we will consider a comprehensive view of the flare dynamics and onset mechanism by using the 3d extrapolated magnetic field obtained from this data set in a future work .",
    "we extend special thanks to drs .",
    "t.  miyoshi , and k.  hayashi for many helpful discussions and anonymous referee for constructive comments .",
    "s.  i.  was supported by the international scholarship of kyung hee university .",
    "g.  s.  c.  was supported by the national research foundation of korea ( nrf-2010 - 0025403 ) , and he thanks kyung hee university for granting him a sabbatical in the 2012 - 2013 school year , during which his part of this research was performed .",
    "this research was supported by the bk21 plus program through the national research foundation ( nrf ) funded by the ministry of education of korea , and by the meteorological administration of korea through the national meteorological satellite center .",
    "the computational work was carried out within the computational joint research program at the solar - terrestrial environment laboratory , nagoya university .",
    "part of computer simulation was performed on the fujitsu primergy cx250 system of the information technology center , nagoya university .",
    "part of computations , data analysis and visualization are performed using resource of the onespacenet in the nict science cloud .",
    "crrrrrrr parameters & bc & @xmath54 & @xmath44 & @xmath26 & @xmath37 & d@xmath52 & gn + case1 & ex & @xmath146 & 1.0 & 5.0 & @xmath147 & - & @xmath57 + case1m1 & ex & @xmath146 & 1.0 & 5.0 & 0 & - & @xmath58 + case1m2 & ex & @xmath146 & 1.0 & 5.0 & 0 & - & @xmath59 + case2 & rw & @xmath146 & 1.0 & 5.0 & @xmath147 & - & @xmath57 + case3 & ex & @xmath146 & 1.0 & 5.0 & @xmath147 & - & @xmath58 + case3m1 & ex & @xmath146 & 1.0 & 5.0 & 0 & - & @xmath59 + case3m2 & ex & @xmath146 & 1.0 & 5.0 & 0 & - & @xmath60 + case4 & ex & @xmath146 & 1.0 & 5.0 & @xmath147 & - & @xmath59 + case5 & rw & @xmath148 & @xmath149 & 0.2 & @xmath150 & 0.02 & @xmath63 +    crrrrrrr star & method & @xmath91 & @xmath92 & @xmath151 & @xmath152 & @xmath95 & grid number + low & lou & - & 1.00 & 1.00 & 1.00 & 1.00 & 1.00 & @xmath57 + wiegelmann & optimization & 1.00 & 1.00 & 0.98 & 0.98 & 1.02 & @xmath57 + case1 & mhd relaxation & 1.00 & 1.00 & 0.97 & 0.95 & 1.02 & @xmath57 + case2 & mhd relaxation & 1.00 & 1.00 & 0.97 & 0.95 & 1.04 & @xmath57 + case3 & mhd relaxation & 1.00 & 1.00 & 0.99 & 0.98 & 1.00 & @xmath58 + case4 & mhd relaxation & 1.00 & 1.00 & 0.98 & 0.96 & 0.99 & @xmath59 + case1m1 & mhd relaxation & 1.00 & 1.00 & 0.97 & 0.94 & 1.02 & @xmath58 + case1m2 & mhd relaxation & 1.00 & 1.00 & 0.97 & 0.93 & 1.02 & @xmath59 +"
  ],
  "abstract_text": [
    "<S> we develop a nonlinear force - free field ( nlfff ) extrapolation code based on the magnetohydrodynamic ( mhd ) relaxation method . we extend the classical mhd relaxation method in two important ways . </S>",
    "<S> first , we introduce an algorithm initially proposed by @xcite to effectively clean the numerical errors associated with @xmath0 . </S>",
    "<S> second , the multi - grid type method is implemented in our nlfff to perform direct analysis of the high - resolution magnetogram data . as a result of these two implementations </S>",
    "<S> , we successfully extrapolated the high resolution force - free field introduced by @xcite with better accuracy in a drastically shorter time . </S>",
    "<S> we also applied our extrapolation method to the mhd solution obtained from the flux - emergence simulation by @xcite . </S>",
    "<S> we found that nlfff extrapolation may be less effective for reproducing areas higher than a half - domain , where some magnetic loops are found in a state of continuous upward expansion . </S>",
    "<S> however , an inverse s shaped structure consisting of the sheared and twisted loops formed in the lower region can be captured well through our nlfff extrapolation method . </S>",
    "<S> we further discuss how well these sheared and twisted fields are reconstructed by estimating the magnetic topology and twist quantitatively . </S>"
  ]
}