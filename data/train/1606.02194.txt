{
  "article_text": [
    "a transportation ( traffic ) network is a system with non - cooperative agents ( drivers ) in which each driver seeks to minimize her own cost by choosing the best route ( resources ) to reach her destination without taking into account the overall system performance . in these systems ,",
    "the cost for each agent depends on the resources it chooses as well as the number of agents choosing the same resources @xcite .",
    "in such a non - cooperative setting , one often observes convergence to a nash equilibrium , a point where no agent can benefit by altering its actions assuming that the actions of all the other agents remain fixed @xcite .",
    "however , it is known that the nash equilibrium is not always the best strategy from the system s point of view and results in a suboptimal behavior compared to the _ socially optimal _ policy . in a transportation network with selfish drivers , each agent ( driver ) follows the path ( we will use `` path '' and `` route '' interchangeably ) derived from a _ user optimal _ policy . in order to quantify the social suboptimality of selfish driving",
    ", we use the price of anarchy ( poa ) as a measure to compare system performance under a user - optimal policy vs. a system - optimal policy .",
    "the equilibrium flow in traffic networks , known as `` wardrop equilibrium , '' is the solution of the _ traffic assignment problem ( tap ) _ @xcite . in the transportation science literature ,",
    "the tap , which will be termed `` forward problem '' in what follows , has been extensively explored ; see , e.g. , @xcite and the references therein . to solve the tap",
    ", we need to know _ a priori _ the specific cost function , as well as the origin - destination ( o - d ) demand matrix .",
    "recent developments in data - driven inverse optimization techniques @xcite enable the estimation of the cost ( usually , the travel time ) functions given the observations of the equilibrium flows from a large - scale transportation network .",
    "this facilitates a better understanding of the underlying dynamics of the transportation system itself .",
    "in addition , with cost function estimates at our disposal , we can address the issue of improving a traffic network s performance by controlling traffic flows , hence , hopefully contributing to the design of better transportation systems that serve smart cities . more specifically , the techniques we develop enable sensitivity analysis with respect to several key parameters of the road network , which , in turn , could help prioritize specific interventions that can alleviate congestion at key parts of the network .    in this paper ,",
    "we leverage actual traffic data provided to us by the boston region metropolitan planning organization ( mpo ) . applying a traffic flow model ,",
    "we first infer equilibrium flows on each segment from the spatial average speed data . then , by adopting the estimated traffic flows we obtain o - d demand matrices which pave the way to the derivation of cost function estimators by solving a set of inverse variational inequality problems . in an effort to prioritize roads for congestion mitigating interventions",
    ", we perform sensitivity analysis of the total users cost with respect to parameters of interest .",
    "finally , we formulate a system - centric problem in which agents , here drivers , cooperate to optimize the overall system performance .",
    "this allows us to estimate the poa for a sub - network so as to determine the difference in network performance between selfish routing ( non - cooperative ) and system - optimal routing ( cooperative ) .",
    "the rest of the paper is organized as follows . in sec .",
    "[ sec : mod ] we present the models and methods we apply to the traffic data . in sec .",
    "[ sec : data ] we provide descriptions of the datasets we use .",
    "we elaborate on data processing tasks in sec .",
    "[ sec : proc ] and show our findings for the cost function estimators and sensitivity analysis in sec .",
    "[ sec : num ] .",
    "we quantify the poa for the transportation network in sec .",
    "[ sec : poa ] , where numerical results for a subnetwork are included to illustrate our approaches .",
    "we conclude in sec .",
    "[ sec : con ] .",
    "* notational conventions : * all vectors are column vectors . for economy of space , we write @xmath0 to denote the column vector @xmath1 .",
    "we use `` prime '' to denote the transpose of a matrix or vector .",
    "unless otherwise specified , @xmath2 denotes the @xmath3 norm .",
    "@xmath4 denotes the cardinality of a set @xmath5 .",
    "@xmath6 indicates @xmath7 is defined using @xmath8 .",
    "@xmath9 denotes the set of all nonnegative real numbers .",
    "we first describe the model for single - class transportation networks , which we adopt throughout the paper .",
    "we then provide two equivalent formulations for the forward problem and , based on the latter formulation , we derive sensitivity analysis results . finally we provide a formulation for the inverse problem which will play a key role in estimating the cost functions .",
    "consider a directed graph , denoted by @xmath10 , where @xmath11 denotes the set of nodes and @xmath12 the set of links .",
    "assume it is strongly connected .",
    "let @xmath13 be the node - link incidence matrix , and @xmath14 the vector with an entry equal to 1 corresponding to link @xmath15 and all the other entries equal to 0 .",
    "let @xmath16 denote an origin - destination ( o - d ) pair and @xmath17 the set of all o - d pairs .",
    "denote by @xmath18 the amount of the flow demand from @xmath19 to @xmath20 .",
    "let @xmath21 be the vector which is all zeros , except for a @xmath22 in the coordinate corresponding to node @xmath19 and a @xmath23 in the coordinate corresponding to node @xmath20 .",
    "let @xmath24 be the total link flow on link @xmath25 and @xmath26 the vector of these flows .",
    "let @xmath27 be the cost function for link @xmath28 ; in particular , when @xmath29 only depends on @xmath24 , we also write @xmath29 as @xmath30 . in addition , denote by @xmath31 the vector - valued function whose @xmath15th component is @xmath32 .",
    "let @xmath33 be the index set of simple routes ( a _ simple route _ is a route without cycles ) connecting the o - d pair @xmath34 . for all @xmath25 , @xmath35 , and @xmath36 , define the link - route incidence by @xmath37 let @xmath38 be the set of feasible flow vectors defined by @xmath39 where @xmath40 is the flow vector attributed to o - d pair @xmath41 . as a stepping stone for formulating the problems of interest , we present next the definition of wardrop equilibrium .    * definition 1 * [ def1 ] _",
    "( @xcite)_. a feasible flow @xmath42 is a _ wardrop equilibrium _",
    "if for every o - d pair @xmath43 , and any route connecting @xmath44 with positive flow in @xmath45 , the cost of traveling along that route is less than or equal to the cost of traveling along any other route that connects @xmath44 . here , the cost of traveling along a route is the sum of the costs of each of its constituent links .      in this work , the forward problem ( i.e. , the tap ) refers to finding the wardrop equilibrium for a given single - class transportation network with a given o - d demand matrix .",
    "we first formulate the tap as a variational inequalities ( vi ) problem ( see def .",
    "2 below ) , and then present an optimization problem as an alternative .    *",
    "definition 2 * [ def2 ] _",
    "( @xcite)_. the vi problem , denoted @xmath46 , is to find an @xmath47 s.t .",
    "@xmath48    we need the following assumption for the theorem that follows .    * assumption 1 * _ ( @xcite)_. [ assumption1 ] @xmath49 is strongly monotone ( see @xcite or @xcite for the definition of strong monotonicity ) and continuously differentiable on @xmath50 .",
    "@xmath38 is nonempty and contains an interior point ( slater s condition ) .",
    "[ th1 ] ( @xcite ) .",
    "suppose assump .",
    "then , there exists a wardrop equilibrium of the single - class transportation network , which is the unique solution to @xmath51 .",
    "5 pt * proof : * this can be established by applying ( * ? ? ?",
    "* thms . 3.14 , 3.17 , and 3.19 ) .",
    "recall that , in the single - class transportation network model , we assume the network to be strongly connected and the demand for each o - d pair to be fixed ( given ) and nonnegative .",
    "in addition , having assumed the additivity for the route costs in the definition of the wardrop equilibrium ( def .",
    "1 ) , we see that , under assump . 1 , ( * ? ? ?",
    "3.a ) , which yields ( * ? ? ?",
    "* thm . 3.14 ) , ( * ? ? ?",
    "3.c ) , which in turn yields ( * ? ? ?",
    "* thm . 3.17 ) , and ( * ? ? ?",
    "3.d ) , which implies ( * ? ? ?",
    "* thm . 3.19 ) ,",
    "are all satisfied .    ' '' ''",
    "now we present an equivalent formulation of the forward problem .",
    "it is a well - known fact that the tap can also be formulated as the following optimization problem @xcite : @xmath52 note that here the objective function is different from the one we will use in the formulation for finding the social optimum ( see sec .",
    "[ sec : poa ] ) ; for a detailed explanation , see @xcite .",
    "throughout the paper , we assume that the cost functions have the following form @xcite : @xmath53 where @xmath54 is the free - flow travel time of @xmath55 , @xmath56 is strictly increasing and continuously differentiable on @xmath57 , and @xmath58 is the effective flow capacity of @xmath25 .",
    "write @xmath59 , @xmath60 , and @xmath61    let @xmath62 denote the solution to . using ( * ? ? ?",
    "19.5 ) , we obtain @xmath63 where @xmath64 denotes the derivative of @xmath56 .      now , given @xmath65",
    ", we present the definition of an _ @xmath66-approximate solution _ to @xmath67 by replacing the right - hand side of with @xmath68 :    * definition 3 * [ def3 ] _ ( @xcite)_. let @xmath65 .",
    "then , @xmath69 is said to be an _ @xmath66-approximate solution _ to @xmath67 if @xmath70    assume we are given observations @xmath71",
    ", @xmath72 , with @xmath73 and each @xmath74 being a set of feasible flow vectors satisfying slater s condition accordingly .",
    "the inverse vi problem amounts to seeking a function @xmath75 such that @xmath76 is an @xmath77-approximate solution to @xmath78 for each @xmath79 .",
    "therefore , we can formulate the inverse vi problem as @xcite @xmath80    we now apply the nonparametric estimation approach of @xcite which expresses the congestion function in a reproducing kernel hilbert space ( rkhs ) @xcite . in particular , we use the polynomial kernel , i.e. , @xmath81 for some choice of @xmath82 and @xmath83 . take the costs as in .",
    "assume we are given networks @xmath84 , and the link flow data @xmath85 are available .",
    "let @xmath86 and @xmath87 .",
    "define the kernel matrix as @xmath88_{i , j = 1}^{m}$ ] .",
    "then , using conic duality , by ( * ? ? ?",
    "2 ) , we reformulate the inverse vi problem as the following quadratic programming ( qp ) problem @xcite : @xmath89 where @xmath90 is a decision vector , @xmath91 is a regularization parameter , @xmath92 , and @xmath93 is some ( arbitrary ) link chosen for normalization purposes . the second constraint in forces the function @xmath56 to be non - decreasing on the links in @xmath94 .",
    "we can derive an estimator of the cost function @xmath56 by solving the qp , thereby , obtaining an optimal @xmath95 .",
    "in particular , if writing @xmath96 , then , by ( * ? ? ?",
    "4 ) , we obtain @xmath97",
    "the actual traffic data provided by the mpo is a dataset of 51.2 gb consisting of 861 csv files , each with more than 1 million lines of data .",
    "the dataset includes the spatial average speeds for major roadways and arterial streets in eastern massachusetts for the year 2012 .",
    "the average speed within a given unit of spatial reference is calculated by aggregating observed speeds from billions of data points .",
    "specifically , it is derived by combining data from physical traffic sensors ( e.g. , induction loop sensors , toll tag readers , etc ) , as well as all available data from probe vehicles ( equipped with on - board gps devices returning speed and location back to a central system ) that fall within a specific segment of a road for a particular time window .",
    "the dataset includes traffic data for more than 13,000 road segments ( with the average distance of 0.7 miles ; see fig .",
    "[ eastma ] ) of eastern massachusetts , covering the average speed for every minute of the year 2012 .        for each road segment , identified with a unique _ tmc ( traffic message channel ) _ code ,",
    "the dataset provides information such as speed data ( instantaneous , average and free - flow speed ) in mph , date and time , and traveling time ( minute ) through that segment .",
    "note that a road typically consists of many segments .",
    "the flow capacity ( vehicles / hour ) dataset , provided by the mpo , includes capacity data  vehicle counts for each road segment  for more than 100,000 road segments ( average distance of 0.13 miles ) in eastern massachusetts . in particular , the capacity data is given for four different time periods ( am : 6 am  9 am , md : 9 am  3 pm , pm : 3 pm  6 pm , and nt : 6 pm  6 am ) in a day . for each time period",
    ", the total roadway capacity for all available lanes for that time period is given .",
    "these values are calculated based on the share of daily traffic counts in each hour of that time period . for each time period",
    "there exists a period capacity factor applied to represent peak hour conditions within that period .",
    "these factors are as follows : 2.5 for am , 4.75 for md , 2.5 for pm , and 7 for nt .",
    "then , the total roadway capacity for a time period is the product of the capacity / lane / hour , the number of lanes , and the capacity factor . in our experiments ,",
    "we need flow capacity on each segment in vehicle counts per hour .",
    "thus , for each time period we scale the given vehicle counts by the inverse of the corresponding capacity factor .",
    "note that , in the capacity dataset , the i d for a road segment is named _ road inventory i d _ , and the segments are not absolutely identical with those in the speed dataset .",
    "based on the geographic longitude and latitude , we have built up a dictionary mapping segments with _",
    "code to capacity dataset _",
    "road inventory i d _ , through which we can read the capacity data for each road segment in the speed dataset .",
    "first , we select the time instances set @xmath98 consisting of each minute of am ( 7 am  9 am ) , md ( 11 am  1 pm ) , pm ( 5 pm  7 pm ) , and nt ( 9 pm  11 pm ) for each day of january , april , july , and october , all in 2012 . note that the selected am ( resp . , md , pm , nt ) period is a subinterval of the am ( resp . ,",
    "md , pm , nt ) period in the capacity dataset .",
    "then , we calculate the average speed for each segment separately for the four time periods , each of which lasts 120 minutes . finally , for each segment , we compute a reliable proxy of the free - flow speed by using the 85th - percentile point of the observed speeds on that segment for all the time instances belonging to @xmath98 .      to reduce the computational burden while capturing the key elements of the eastern massachusetts road network , we only consider a representative interstate highway sub - network as shown in fig .",
    "[ sub - net - a ] , where there are 701 road segments , composing a road network with 8 nodes and 24 links .",
    "we depict the topology of this sub - network in fig .",
    "[ sub - net - b ] .",
    "let @xmath99 denote the available observations ( @xmath100 , @xmath101 ) , and parameters ( @xmath102 , @xmath103 , @xmath104 ) of the segments composing link @xmath55 , where , for each segment @xmath105 , @xmath106 ( resp . , @xmath102 )",
    "is the speed ( resp .",
    ", free - flow speed ; miles / hour ) , @xmath107 ( resp . , @xmath103 ) is the travel time ( resp .",
    ", free - flow travel time ; hour ) , and @xmath104 is the flow capacity ( vehicles / hour ) .",
    "then , using greenshield s model @xcite , we calculate the flow on segment @xmath105 by @xmath108 in our analysis , we enforce @xmath109 to make sure that the flow given by is nonnegative . in particular ,",
    "if for some time instance @xmath110 ( this rarely happens ) , we set @xmath111 in , thus leading to a zero flow estimation for this time instance .",
    "aggregating over all segments composing link @xmath15 we compute : @xmath112 where @xmath113 is given by and @xmath114 , @xmath115 .      for @xmath25 ,",
    "let @xmath116 denote the original estimate of the flow on link @xmath15 , and @xmath24 its adjustment .",
    "solve the following _ least squares problem ( lsp ) _ : @xmath117 where the first constraint enforces flow conservation for each node @xmath118 , where @xmath119 ( resp .",
    ", @xmath120 ) denotes the set of links entering ( resp . ,",
    "outgoing ) to ( resp . , from ) node @xmath121 .",
    "_ remark : _ [ rk2 ] strictly speaking , we should replace the non - negativity constraint in with @xmath122 where @xmath58 denotes the flow capacity of link @xmath15 .",
    "however , we know that the latter is not a `` hard '' constraint @xcite , and the solution to the lsp is actually very close to the initial estimates of the link flows , which satisfy the flow capacity constraint , so we only consider @xmath123 in .      note that we need to know the o - d demand information ( compiled into a matrix ) in both the forward problem formulation and the inverse problem formulation . based on the parameters and flows of the road network ,",
    "we borrow the general least squares ( gls ) method @xcite to estimate the desired o - d demand matrix , using the following steps :      we assume that each node could be an origin and a destination ; for the subnetwork shown in fig . [",
    "sub - net - a ] , there are @xmath124 o - d pairs in total .",
    "we then identify feasible routes for each o - d pair , thereby obtaining a @xmath125 link - route incidence matrix ( recall the definition of link - route incidence in sec .",
    "[ sec : mod ] ; 140 routes identified in total ) ; for details , see @xcite .",
    "we estimate the route choice probability matrix using a logit choice model @xcite , so that @xmath126 where @xmath127 is the probability that a traveler between o - d pair @xmath121 uses feasible route @xmath128 , @xmath129 is the logit choice parameter , @xmath130 denotes the length of route @xmath128 , and @xmath131 is the set of feasible routes between o - d pair @xmath121 .",
    "we implement the gls method @xcite to estimate the o - d demand matrix ( vectorized as a 56-dimensional vector denoted by @xmath132 ) , which reduces to a least - squares estimation problem .",
    "let @xmath133 be the link - route incidence matrix obtained in sec .",
    "[ sec : route - link ] and @xmath134 $ ] the route choice probability matrix derived in sec .",
    "[ sec : route - choice ] .",
    "let @xmath135 denote the @xmath136 observations of the flow vector and @xmath137 the average .",
    "then , the o - d demand matrix estimation is equivalent to the following qp @xcite : @xmath138 where @xmath139 is the sample covariance matrix .    by expanding the right - hand side of the objective",
    ", we see that the qp reduces to @xmath140 where @xmath141 and @xmath142 .",
    "[ cols= \" < , < , < , < , < , < , < , < \" , ]     we then look at the poa for a specific time period in a whole month . fig .",
    "[ poa_pm_apr ] shows the poa for the pm period during april 2012 .",
    "it is observed that @xmath143 in several days in april during the pm period . in the worst case , on april 22 , @xmath144 , which means that the system is considerably inefficient under selfish driving .",
    "however , for a few days we also observe that @xmath145 .",
    "this may happen since we use the _ average _ o - d demand matrix for all weekdays ( weekend / holidays ) , find social optimum flows by solving the optimization problem ( [ obj_soc ] ) , and force route flows to meet the average o - d demand .",
    "however , for a specific day in a month the _ exact _ o - d demand matrix may not be equal to the average one , thus , the user - optimum flows do not need to meet the flow conservation constraints in ( [ obj_soc ] ) and may result in a smaller objective value .",
    "we note that our poa estimation ignores the ( potentially critical ) distinction between a link being `` congested '' vs. `` un - congested ''  @xcite .",
    "thus , our future research will focus on including this aspect along with analyzing a larger subnetwork and applying o - d demand matrices and cost functions on a daily basis .",
    "as an alternative way of quantifying the poa , we also assume a scenario in which all drivers use socially optimum routing and a single driver acts selfishly . in this scenario",
    ", we assume the user has prior knowledge about the total delay on each path of the desired o - d pair .",
    "the selfish driver deviates from the social optimum flow by traveling through the _ shortest path _",
    ", thus , enjoying less traveling time . in our example , under the social optimum policy , the latency a driver experiences over each link is shown in tab .",
    "[ latency ] .",
    "now , a driver joining the flow of o - d pair 1 - 6 , can choose one of the four paths from node 1 to node 6 ( refer to fig .",
    "[ sub - net - b ] ) : @xmath146 ; @xmath147 ; @xmath148 and @xmath149 with traveling times 0.654 , 0.651 , 0.872 , and 0.869 hr respectively .",
    "if the driver acts selfishly and joins the shortest path , @xmath150 , instead of her assigned path , @xmath151 , she will gain @xmath152 in traveling time .",
    "in this paper , we study a large - scale transportation network ( eastern massachusetts ) using vehicle probe data obtained from the boston region metropolitan planning organization ( mpo ) for the year 2012 , and obtain estimates for the cost functions determining users route choices .",
    "we derive sensitivity analysis results and quantify the price of anarchy ( poa ) .",
    "our findings could help elucidate the underlying operation of a large transportation system and provide useful suggestions to the efforts of building a smarter city .",
    "the authors would like to thank the boston region mpo , and scott peterson in particular , for supplying the data and providing us invaluable clarifications throughout our work .",
    "we also thank vishal gupta for helpful discussions in using the code @xcite .",
    "x.  wang , n.  xiao , l.  xie , e.  frazzoli , and d.  rus , `` analysis of price of anarchy in traffic networks with heterogeneous price - sensitivity populations , '' _ ieee transactions on control systems technology _ , vol .",
    "23 , no .  6 , pp .",
    "2227  2237 , 2015 .",
    "j.  zhang , `` o - d pair labels , '' _",
    "https://github.com / jingzbu / inversevistraffic / blob / master / temp_fil% es / o - d_pair_labels.txt[https://github.com / jingzbu / inversevistraffic / blob / master / temp_fil% es / o - d_pair_labels.txt ] _ , 2015 .",
    " , `` route - link incidence matrix , '' _",
    "https://github.com / jingzbu",
    "/ inversevistraffic / blob / master / temp_fil% es / path - link_incidence.txt[https://github.com / jingzbu / inversevistraffic / blob / master / temp_fil% es / path - link_incidence.txt ] _ , 2015 .",
    " , `` 3-fold cross - validation , '' _ https://github.com / jingzbu / inversevistraffic / tree / master / cross_va% lidation_uni - class[https://github.com / jingzbu / inversevistraffic / tree / master / cross_va% lidation_uni - class ] _ , 2015 .",
    "s.  pourazarm , c.  g. cassandras , and t.  wang , `` optimal routing and charging of energy - limited vehicles in traffic networks , '' _ international journal of robust and nonlinear control _ , vol .",
    "26 , no .  6 , pp .",
    "13251350 , 2016 ."
  ],
  "abstract_text": [
    "<S> we have considered a large - scale road network in eastern massachusetts . using real traffic data in the form of spatial average speeds and the flow capacity for each road segment of the network , we converted the speed data to flow data and estimated the origin - destination flow demand matrices for the network . </S>",
    "<S> assuming that the observed traffic data correspond to user ( wardrop ) equilibria for different times - of - the - day and days - of - the - week , we formulated appropriate inverse problems to recover the per - road cost ( congestion ) functions determining user route selection for each month and time - of - day period . </S>",
    "<S> in addition , we analyzed the sensitivity of the total user latency cost to important parameters such as road capacities and minimum travel times . </S>",
    "<S> finally , we formulated a system - optimum problem in order to find socially optimal flows for the network . </S>",
    "<S> we investigated the network performance , in terms of the total latency , under a user - optimal policy versus a system - optimal policy . </S>",
    "<S> the ratio of these two quantities is defined as the price of anarchy ( poa ) and quantifies the efficiency loss of selfish actions compared to socially optimal ones . </S>",
    "<S> our findings contribute to efforts for a smarter and more efficient city . </S>"
  ]
}