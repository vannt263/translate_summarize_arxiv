{
  "article_text": [
    "let @xmath0 be an @xmath1 by @xmath2 matrix with integer entries , and let @xmath3 be an @xmath1-vector in @xmath4 .",
    "many combinatorial problems turn out to be equivalent to finding all nonnegative integral ( column ) vectors @xmath5 satisfying @xmath6 especially in the homogeneous case when @xmath3 equals @xmath7 , of which the solution space is a rational cone .",
    "such problems are also known as solving a linear diophantine system .",
    "there are two closely related generating functions associated to : @xmath8 where the first sum ranges over all @xmath9 such that @xmath10 , and the second sum ranges over all positive integral @xmath11 such that @xmath12 .",
    "we omit @xmath3 in the homogeneous case . the following well - known reciprocity theorem for homogeneous linear diophantine equations",
    "was given by stanley as ( * ? ? ?",
    "* theorem 4.1 ) .",
    "[ t-3-recip ] let @xmath0 be an @xmath1 by @xmath2 integral matrix of full rank @xmath1 . if there is at least one @xmath13 such that @xmath14 , then we have as rational functions @xmath15    previous proofs of this theorem used decompositions into simplicial cones or lattice cones , or complicated algebraic technique .",
    "see @xcite and @xcite for further information",
    ". we will give a short proof using a signed cone decomposition and induction .",
    "in the general situation , the best known result ( up to now ) is the monster reciprocity theorem , which was given by stanley @xcite in 1974 .",
    "the theorem will be stated later after new notation is introduced .",
    "it includes as special cases many combinatorial reciprocity theorems , such as the reciprocity theorem for homogeneous linear diophantine system , that for ehrhart polynomials , and that for p - partitions , etc",
    ". we will give a simple approach to this theorem .",
    "as applications , we give detailed , and short , implication of the reciprocal domain theorem ( * ? ?",
    "* proposition  8.3 ) .",
    "the new approach uses the idea of malcev - neumann series @xcite , which defines a total ordering on the group of monomials to clarify the series expansion of rational functions .",
    "we study the reciprocity property of an object that is more general , but less combinatorial , than that was studied in @xcite .",
    "the new objects we are going to study are _ elliott - rational functions _ , while the previous objects are elliott - rational functions with a monomial numerator . by an elliott - rational function , we mean the one that can be written as @xmath16 where @xmath17 is a polynomial and @xmath18 and @xmath19 are monomials .    in this larger set of objects ,",
    "it is much easier to build up the reduction steps .",
    "theorem [ t - rec - erroterm ] , a general result that gives a reciprocity formula for elliott - rational functions , turns out to be easy to prove .",
    "we shall use this result to formulate the monster reciprocity theorem ( theorem [ t - monster ] ) .    in section 2",
    ", we introduce the basic idea of malcev - neumann series and reformulate the reciprocity of linear diophantine system in terms of constant terms . in section 3",
    ", we develop the reciprocity theorem for elliott - rational functions .",
    "we apply our result in section 4 to give the generalized monster reciprocity theorem . in section 5",
    ", we illustrate the monster reciprocity theorem by examples , and as an application , we give a simple derivation of theorem [ t-3-recip ] .",
    "section 6 includes an inductive ( combinatorial ) proof of theorem [ t-3-recip ] .",
    "solving a linear diophantine system ( ld - system for short ) means finding all vectors @xmath5 that satisfy @xmath20 , where @xmath0 is an @xmath1 by @xmath2 matrix with integral entries .",
    "more precisely , we want to solve the following system of equations : @xmath21 we assume the rank of @xmath22 equals the rank of @xmath0 , for otherwise , the ld - system has no solution even in @xmath23 .",
    "let @xmath24 be the @xmath25th column vector of @xmath0 .",
    "then the above system is the same as @xmath26    now let @xmath27 and @xmath28 be the sets of all such solutions in @xmath29 and @xmath30 respectively .",
    "it is interesting to study the following two associated generating functions of : @xmath31 where @xmath32 and if @xmath9 , then @xmath33    the above equation defines two rational functions in @xmath34 . if as rational functions @xmath35 , then we say that the system has the @xmath36-_property _ ( short for _ reciprocity property _ ) .",
    "we can compute @xmath37 by replacing the @xmath1 linear constraints with @xmath1 new variables @xmath38 and then take the constant terms .",
    "let @xmath39 be @xmath40 , and let @xmath41 be the constant term of @xmath42 in @xmath39 .",
    "we have @xmath43 with the working ring @xmath44[[\\mb{x}]]$ ] , where @xmath45 means @xmath46",
    ". the above conversion can be trait back to macmahon @xcite .",
    "similarly we get @xmath47    we define @xmath48 and @xmath49 to be the crude generating functions of @xmath50 and @xmath51 as @xmath52 and observe that as rational functions @xmath53 however , the series expansion of the two sides of the above equation are different .",
    "the change of variables by @xmath54 , which corresponds to multiplying each row of by @xmath55 , will not make a difference when taking constant terms .",
    "therefore , the system has the r - property if and only if as rational functions @xmath56 where we expand @xmath57 on the lhs at @xmath58 , while on the rhs at @xmath59 .    as we shall see later , the different expansions appearing in the above equation is easily explained in the context of malcev - neumann series .",
    "the group of monomials in @xmath39 and @xmath34 can be given a total ordering ",
    "@xmath60 \" that is compatible with its group structure ; i.e. , for any monomials @xmath61 and @xmath62 , @xmath63 implies @xmath64 .",
    "this is equivalent to a total ordering @xmath65 on the additive group @xmath66 .",
    "an important such ordering @xmath67 is the reverse lexicographical ordering on @xmath66 .",
    "then a _ malcev - neumann series _ ( or _ mn - series _ for short ) with respect to @xmath68 is a formal series on @xmath39 and @xmath34 with a well - ordered _ support _ : the set of monomials corresponds to the nonzero terms . recall that a _ well - ordered set _ is a totally ordered set such that every nonempty subset has a minimum .    for our purpose",
    ", @xmath69 will denote an injective endomorphism of @xmath66 ( a nonsingular integral matrix ) , and @xmath70 will be the induced total ordering defined by @xmath71 if and only if @xmath72 .",
    "we denote by @xmath73 the corresponding field of mn - series with respect to @xmath69 . the field of iterated laurent series @xmath74 , where @xmath69 is the identity map and is omitted , has been studied in @xcite . for a more general setting of mn - series , the readers are referred to @xcite or ( * ? ? ?",
    "* chapter  13 ) .    the series expansion of mn - series will be explained in more details in the next section .",
    "let us review some properties of mn - series @xcite to see that such fields are suitable for dealing with different kinds of series expansions of rational functions .    for any total ordering @xmath65",
    ", @xmath75 is a field . in particular",
    ", @xmath76 is the field of iterated laurent series @xcite .    the field @xmath77 of rational functions is naturally embedded into @xmath78 for any @xmath69 .",
    "this follows from the field structure of @xmath79 and the fact that every polynomial has a finite support .",
    "every rational function @xmath80 has a unique expansion in @xmath81 .",
    "the expansions of @xmath42 for different @xmath69 are usually different .",
    "for instance , the expansion of @xmath82 in @xmath83 is @xmath84 but the expansion in @xmath85 is @xmath86 note that we can write @xmath87 as @xmath88 where @xmath69 is defined by the matrix @xmath89 , or by abuse of notation , @xmath90 and @xmath91 .",
    "recall also that every subset of a well - ordered set is well - ordered .",
    "thus the following operators @xmath92 , @xmath93 , and @xmath94 are well - defined for mn - series .",
    "@xmath95 obviously , for an mn - series @xmath96 , @xmath97 .",
    "the constant term operators are commutative so that taking the constant term in a set of variables is defined by iteration .",
    "now it is easy to see that theorem [ t-3-recip ] is a consequence of the following proposition .",
    "[ p-3-recip ] suppose that @xmath98 is nonempty .",
    "then @xmath99 where @xmath69 is the endomorphism defined by @xmath100 and @xmath101 .",
    "on the other hand , it is easy to deal with the case of @xmath102 .",
    "so theorem [ t-3-recip ] is equivalent to proposition [ p-3-recip ] , whose proof will be given in section 6 .",
    "the following lemma asserts that elementary row operation will not change the solution space of an ld - system .",
    "we give it here to show that all the work can be done algebraically .",
    "[ l-3-monomial ] suppose @xmath103 is another set of variables .",
    "if @xmath104{\\langle\\!\\langle}\\mb{y}{\\rangle\\!\\rangle}$ ] , then for @xmath105 with @xmath106 , @xmath107",
    "it is convenient for our purpose to denote by @xmath108 the field @xmath109 .",
    "the field of rational functions @xmath77 can be identified with @xmath110 .",
    "usually we are taking constant terms in the ring @xmath44[[\\mb{x}]]$ ] .",
    "this ring can be embedded into @xmath78 , as long as @xmath111 is compatible with the relation @xmath112 for all @xmath25 and @xmath113 , where @xmath114 means that @xmath115 for any positive integer @xmath116 .    the case @xmath117 is illustrative for our understanding of the series expansion for mn - series , and in this particular case , we need not restrict ourselves to elliott - rational functions .",
    "let us consider the following problem .",
    "_ problem : _ given a rational function @xmath118 ( short for @xmath119 ) of @xmath120 and @xmath34 , compute @xmath121 , where the notation @xmath122 indicates that @xmath118 is treated as an element of @xmath123 , and we use similar notations for the @xmath124 and @xmath125 operators .    to deal with this problem",
    ", we shall understand that @xmath118 is not only an element of @xmath126 , but also an element of @xmath127 . as an element of @xmath126",
    ", @xmath118 can be written as @xmath128 , where @xmath129 and @xmath130 are both in @xmath131 $ ] .",
    "as an element of @xmath127 , the denominator @xmath130 plays an important role .",
    "recall that @xmath127 is equipped with a total ordering @xmath68 on its group of monomials and that its elements have well - ordered supports .",
    "thus for a nonzero element @xmath132 , we can define its _ order _ @xmath133 to be @xmath134 , and its _ initial term _ to be the term with the least order .",
    "the order of @xmath135 is treated as @xmath136 .",
    "let us write @xmath137 , with @xmath138 and @xmath139 . to expand @xmath118 into a series in @xmath123 , we need to find the @xmath120-_initial term _ @xmath140 , i.e. , the @xmath113 such that @xmath141 for all @xmath142 .",
    "this can be achieved because of the different powers in @xmath120 .",
    "then @xmath143 this expansion is justified by the composition law ( * ? ? ?",
    "* theorem  2.2 ) .",
    "it is now clear that we have the following three situations .    1 .",
    "if @xmath113 equals @xmath135 , then for any polynomial @xmath129 , @xmath128 contains only nonnegative powers in @xmath120 . in this case",
    ", we say that @xmath144 is @xmath145 in @xmath120 .",
    "if @xmath113 equals @xmath146 , then for any polynomial @xmath129 of degree in @xmath120 less than @xmath146 , @xmath128 contains only negative powers in @xmath120 . in this case",
    ", we say that @xmath144 is @xmath147 in @xmath120 .",
    "if @xmath113 equals neither @xmath135 , nor @xmath146 , then @xmath144 contains both positive and negative powers in @xmath120 .",
    "thus @xmath144 is neither @xmath145 nor @xmath147 in @xmath120 .",
    "[ l-3-property ] let @xmath148 and @xmath149 be polynomials in @xmath120 .",
    "then for any total ordering @xmath65    * both @xmath150 and @xmath151 are @xmath152 in @xmath120 if and only if @xmath153 is . *",
    "both @xmath150 and @xmath151 are @xmath154 in @xmath120 if and only if @xmath153 is . * for all the other cases , @xmath155 is neither @xmath156 in @xmath120 nor @xmath154 in @xmath120 .",
    "we prove the first case for @xmath157 as follows .",
    "the other cases are similar .",
    "write @xmath158 suppose that @xmath159 and @xmath160 are the @xmath120-initial term of @xmath148 and @xmath149 respectively .",
    "now if we expand the product @xmath161 but do not collect terms , then @xmath162 is the unique term with the least order .",
    "so the order of @xmath163 has to equal the order of @xmath162 .",
    "this implies that the @xmath120-initial term of @xmath161 is @xmath163 .",
    "the assertion for @xmath157 in the lemma hence follows from the fact that @xmath164 .",
    "( remember that @xmath165 ) .",
    "a direct consequence of the above lemma is the following corollary .",
    "[ c - relprime ] if @xmath150 is @xmath145 in @xmath120 and @xmath151 is @xmath147 in @xmath120 , then @xmath166 and @xmath167 can not have a nontrivial common divisor in @xmath131 $ ] , i.e. , they are relatively prime .",
    "if @xmath130 can be factored as @xmath168 such that @xmath150 is @xmath145 in @xmath120 and @xmath151 is @xmath147 in @xmath120 , then we say that @xmath130 is @xmath69-_factorable _ , and @xmath169 is a @xmath69-factorization .",
    "such factorization is unique ( if it exists ) up to a constant in @xmath108 .",
    "let @xmath170 $ ] .",
    "if @xmath130 is @xmath69-factorable , then @xmath171 is in @xmath108 , i.e. , is rational .",
    "suppose @xmath169 is such a @xmath69-factorization .",
    "since @xmath150 is @xmath172 in @xmath120 and @xmath151 is @xmath147 in @xmath120 , @xmath166 and @xmath167 are relatively prime in @xmath131 $ ] by corollary [ c - relprime ] .",
    "thus we have the unique partial fraction expansion in @xmath126 : @xmath173 where @xmath174 are polynomials in @xmath120 for @xmath175 and @xmath176 for @xmath177 . since when expanded as series in @xmath127 , @xmath178 and @xmath179 contains only nonnegative powers in @xmath120 , and @xmath180 contains only negative powers in @xmath120 , we have @xmath181 thus @xmath182 is in @xmath109 .",
    "this theorem generalizes a result of hadamard ( * ? ? ?",
    "* proposition 4.2.5 ) , which says that the hadamard product of two rational power series is rational .",
    "this statement can be easily seen from the following observation : let @xmath183 and @xmath184 . then the hadamard product of @xmath185 and @xmath186 is @xmath187 where we are taking the constant term in @xmath188 for the rhs of the above equation .    for any total ordering @xmath68 on the monomials of @xmath126 , we let @xmath189 be the total ordering such that @xmath190 if and only if @xmath191 for all monomials @xmath192 and @xmath193 .    then we have a sort of reciprocity invariant , for which we need three more notations .",
    "we use the notation @xmath194 to indicate that @xmath96 is treated as an element in @xmath195 and @xmath196 to indicate that @xmath96 is treated as an element in @xmath197 .",
    "we define @xmath198    [ t - stan - inv ] suppose that @xmath199 $ ] , with @xmath130 being @xmath69-factorable .",
    "then the following is always true as rational functions in @xmath108 : @xmath200    theorem [ t - stan - inv ] gives an invariant of a rational function when taking the constant term in @xmath120 .",
    "this invariant is independent of the choice of the total ordering @xmath65 when applicable .",
    "this fact is the key in our new approach to the monster reciprocity theorem in section 4 .",
    "write @xmath130 as @xmath201 , such that @xmath150 is @xmath145 in @xmath120 , @xmath151 is @xmath147 , and @xmath202 .",
    "clearly @xmath203 and the partial fraction decomposition of @xmath128 can be written as @xmath204 where @xmath205 , @xmath206 , @xmath207 , and @xmath208 is a polynomial .",
    "now we are going to apply different operators on this partial fraction decomposition . applying @xmath209 to @xmath128 gives us @xmath210 , and applying @xmath211 to @xmath128 gives us @xmath212 .",
    "therefore @xmath213    applying @xmath214 to @xmath128 gives us @xmath215 , and applying @xmath216 to @xmath128 gives us @xmath217 .",
    "thus the theorem follows .    in the proof of theorem",
    "[ t - stan - inv ] , we see that @xmath218 can be replaced with @xmath219 if @xmath219 switches the @xmath157 and @xmath125 properties of @xmath150 and @xmath151 with respect to @xmath69 .    as an element of @xmath131 $ ] , @xmath130 can be factored into the product of irreducible polynomials .",
    "let @xmath220 be such a factorization .",
    "by lemma [ l-3-property ] @xmath130 is @xmath69-factorable if and only if every @xmath221 is either @xmath145 or @xmath147 .",
    "when this is the case , the @xmath69-factorization can be obtained by collecting similar terms .",
    "elliott - rational functions are @xmath69-factorable for any @xmath69 . such a function @xmath42 can be written as follows : @xmath222 where @xmath129 is a polynomial in @xmath120 , @xmath223 and @xmath224 are positive integers , @xmath225 and @xmath2 are nonnegative integers , and @xmath226 and @xmath227 are monomials independent of @xmath120 . for a particular @xmath69 , we require that @xmath228 is @xmath147 in @xmath120 , and @xmath229 is @xmath152 in @xmath120 . note that @xmath230 can be @xmath135 . ",
    "the method of elliott \" @xcite shows that @xmath231 is always elliott - rational .",
    "a rational function of @xmath120 is _ proper _ in @xmath120 if the degree in @xmath120 of its numerator is less than that of its denominator .",
    "[ c - macrec ] let @xmath96 be of the form .",
    "if @xmath232 , and @xmath96 is proper in @xmath120 , then for any @xmath69 , we have a reciprocity formula @xmath233 where both sides are regarded as elements in @xmath108 .",
    "more generally , a rational function @xmath42 is said to have the @xmath36-_property _ with respect to @xmath69 if @xmath234 for some integer @xmath146 . here",
    "we restrict our interest to the case when @xmath146 equals @xmath1 , the number of @xmath120 s .",
    "we have the following reciprocity formula for elliott - rational functions .",
    "[ t - rec - erroterm ]",
    "let @xmath235 be an elliott - rational function and let @xmath70 be a total ordering on @xmath66 that is compatible with its additive group structure .",
    "then @xmath236 where @xmath237 is the identity operator for @xmath238 and similar for @xmath239 when @xmath240 .",
    "since we are always taking constant terms in @xmath241 , we omit the @xmath120 for convenience .",
    "we compute the following in two different ways . @xmath242    using theorem [ t - stan - inv ] , we can rewrite as @xmath243    on the other hand , most of the terms in cancel with each other .",
    "the only terms left are given by @xmath244 the proposition then follows .",
    "theorem [ t - rec - erroterm ] gives the error term of the reciprocity formula .",
    "a different error term representation was given in @xcite in terms of cohomology .",
    "however , the computation of this error term saved only a little work for general @xmath1 .",
    "our formula for the error term is true for any fixed order of @xmath245 , and any fixed order of @xmath246 .",
    "this suggests that some simplifications might exist and a better formula is possible .",
    "we have not succeeded in finding a such formula .    since simple equivalent condition for @xmath42 to have the r - property is unlikely , we search for a sufficient condition . corollary [ c - iproperty ] and proposition [ p - rproperty1 ] below play important roles in our formulating the monster theorem .",
    "a rational function @xmath42 is said to have the @xmath247-_property _ with respect to @xmath69 if for @xmath248 , we have @xmath249    [ c - iproperty ] if an elliott - rational function has the i - property , then it has the r - property .",
    "this result is a direct consequence of theorem [ t - rec - erroterm ] .",
    "the special case of this corollary when the elliott - rational function has a monomial numerator was shown by a complicated computation in ( * ? ? ?",
    "* lemma 9.2 ) .    in the case @xmath117 , theorem [ t - rec - erroterm ] gives the equivalence between the i - property and the r - property .",
    "moreover , we have , as shown below , a nice equivalent condition ( * ? ? ?",
    "* proposition 10.3 ) for the r - property that contains no algebraic expression .",
    "[ p - rproperty1 ] let @xmath250 be the crude generating function associated to an ld - system consisting of a single equation @xmath251 : @xmath252 then the following four conditions are equivalent for any @xmath69 :    1 .",
    "@xmath253 has the r - property .",
    "@xmath253 has the i - property .",
    "3 .   @xmath254 and @xmath255 .",
    "the following two conditions are both satisfied : 1",
    ".   there does not exist a @xmath256 with @xmath257 such that @xmath258 if @xmath259 and @xmath260 if @xmath261 .",
    "2 .   there does not exist a @xmath262 with @xmath263 such that @xmath264 if @xmath259 and @xmath265 if @xmath261 .",
    "the proof of this proposition , which is not given in full detail here , proceeds by showing that @xmath266 and @xmath267 have no common terms when expanded as laurent series .",
    "the reader is referred to ( * ? ? ?",
    "* proposition 10.3 ) for details .",
    "consider an ld - system @xmath268 as in .",
    "the crude generating function @xmath48 is an elliott - rational function with a monomial numerator .",
    "we say such a function has the _ matrix form _ since we are going to represent it by a matrix .",
    "the problem is to find a simple sufficient condition for @xmath48 to have the r - property .",
    "a homology version solution can be found in @xcite .",
    "the best known result was stanley s monster reciprocity theorem ( * ? ? ? * theorem 10.2 ) , which says that the ld - system has the r - property if certain linear combinations of its equations have the r - property .",
    "we present here a simple approach to this problem .    the central idea of our approach to this problem , as in @xcite , is to apply corollary [ c - iproperty ] and proposition [ p - rproperty1 ] .",
    "if the following checking procedure returns a true , then @xmath48 has the i - property and hence the r - property with respect to @xmath69 .",
    "note that the converse of this statement is false .",
    "the checking procedure for @xmath48 :    1 .",
    "let @xmath269 .",
    "if @xmath270 then return false .",
    "2 .   write @xmath271 as a sum of matrix forms in an efficient way .",
    "for every matrix form @xmath272 , if @xmath273 , then return false .",
    "3 .   repeat the above step for every matrix form @xmath272 with respect to @xmath274 and then for every @xmath275 with respect to @xmath276 , @xmath277 until we have checked if @xmath278 .",
    "if no false is returned , then return true .",
    "the basic tool in finding these @xmath279 s is partial fraction decomposition of rational functions . using the constant term operators seems neater than using residue operators as in @xcite .",
    "our task is to find a simple equivalent condition for the checking procedure to return a true .",
    "such a condition will be our monster reciprocity theorem . in order to do so",
    ", we represent a matrix form @xmath280 as an augmented matrix .",
    "in fact , we can keep track everything by adding a row of monomials in the @xmath281 s on the top and a column of monomials in the @xmath120 s to the left of an ld - system .",
    "therefore , the checking procedure will be done by matrix operations .",
    "note that using matrix operations is one important aspect of the monster reciprocity theorem .",
    "we use the following identification : @xmath282,\\ ] ] where @xmath18 are monomials in @xmath34 , and @xmath24 are column vectors",
    ". it would be clearer if we add @xmath241 to the left of the @xmath25th row , but this is unnecessary after applying lemma [ l-3-monomial ] and requiring that the @xmath25th row ( with @xmath283 ) of @xmath284 is indexed by @xmath285 .",
    "the row operations we are going to perform will never involve the top row .",
    "the column operations , when acting on the first row , are treated as multiplications instead of additions for the obvious reason .",
    "we alow fractional entries and fractional powers .",
    "roots of unity might appear , but will not be a trouble .",
    "three special matrix operations will be useful .",
    "we define @xmath286 to be the matrix obtained from @xmath280 by adding @xmath287 times the @xmath25th column to the @xmath113th column for all @xmath288 .",
    "this operation is exactly gaussian column elimination by taking the @xmath289th entry of @xmath280 as the pivot .",
    "similarly we define the gaussian row elimination @xmath290 . the third operation @xmath291 is defined to be the matrix obtained from @xmath280 by deleting the second row and the @xmath25-th column .",
    "combination of the operations will also be used from left to right .",
    "for instance , @xmath292 . since row operations commute with column operations , we have @xmath293 .",
    "it is easy to verify the following .",
    "@xmath294    for example , if @xmath280 is given by @xmath295,\\end{aligned}\\ ] ] then @xmath296 , \\quad t\\leftarrow r\\langle 1\\rangle    \\left[\\begin{array}{ccc|c } x_1 & x_2 & x_3 & 1 \\\\ 3 & -1 & -2 & b \\\\ 0 & \\frac{2}{3 } & -\\frac{5}{3 } & c+\\frac{b}{3 } \\end{array}\\right],\\ ] ] and @xmath297.\\ ] ]    the above three operations are generalized to sequences of integers . for instance , @xmath298 is the matrix obtained from @xmath280 by applying gaussian row elimination by first taking the @xmath299th entry of @xmath280 as the pivot , then taking the @xmath300th entry as the pivot , and so on .",
    "however , the elimination can not go backwards .",
    "for instance , we are not allowed to eliminate the nonzero entries in the second row when taking the @xmath300th entry as the pivot .",
    "more precisely , pick out the @xmath301th columns of @xmath302 , and rearrange them as follows : @xmath303.\\ ] ] if all the pivots encountering are nonzero , then when ignoring the top row @xmath304\\end{aligned}\\ ] ] will be an upper triangular square matrix followed by a zero matrix , and @xmath305\\end{aligned}\\ ] ] will be a diagonal square matrix followed by a zero matrix . since the matrix operations we have performed do not change the determinants , the @xmath306 can be inductively computed by the formulas @xmath307 , and @xmath308 .",
    "we denote by @xmath309 is a generic monomial in @xmath310 whose exact expression is not needed .",
    "though we can formulate the monster reciprocity theorem for any @xmath69 , the result seems nicer if we assume that @xmath69 satisfies the following condition : @xmath311 for example , condition @xmath312 holds for any injective @xmath69 such that @xmath313 is a monomial in @xmath281 and @xmath314 is a monomial in @xmath39 .",
    "we will explain two such @xmath69 in detail in the next section .",
    "[ def - contrib ] with notation as in , we define @xmath315 of distinct entries ranging from @xmath316 to @xmath2 to be a _ contribution sequence _ of length @xmath17 with respect to @xmath69 if @xmath317 for all @xmath318 .",
    "the empty sequence is a contribution sequence of length @xmath135 .",
    "the name contribution sequence is in correspondence with the  pole sequence \" in @xcite .",
    "the condition in this definition will be replaced with simple ones for two special @xmath69 in the next section .",
    "[ t - monster ] let @xmath280 be a matrix form corresponding to an @xmath1 by @xmath2 matrix of full rank , and let @xmath68 be a total ordering on the group of monomials in @xmath319 and @xmath34 satisfying condition @xmath312 . if for every contribution sequence @xmath320 of @xmath280 with @xmath321 , the second row of @xmath322 has the r - property , then @xmath280 has the r - property with respect to @xmath69 .    for given @xmath280 and @xmath68 .",
    "the checking procedure will return a true if and only if every @xmath323 encountered has the property that @xmath324 , which is the same as the condition that the second row of @xmath323 has the r - property by proposition [ p - rproperty1 ] .",
    "we claim that @xmath323 must be _ similar _ to the following form for some contribution sequence @xmath325 : @xmath326 the term similar will be explained later .",
    "assuming @xmath323 be given by , we can complete the proof of the theorem as follows .",
    "we observe that the @xmath62 operations after the @xmath36 operations do not affect the @xmath327st row ( and below ) of @xmath302 .",
    "therefore the second row of @xmath323 is the same as the second row of @xmath328 .",
    "we prove the claim by induction on @xmath17 .",
    "the claim is trivial for @xmath329 .",
    "now assume the claim is true for @xmath330 and we need to show that the claim is true for @xmath331 .    by choosing appropriate positive integer @xmath332 and letting @xmath333 , ( note that @xmath334 will be independt of the choice of @xmath332 ) , we can assume that @xmath335,\\ ] ] where @xmath336 and @xmath337 are integers , @xmath338 , and the @xmath339 s are column of integers that we do not care .",
    "dividing the second row of @xmath340 by @xmath332 will give us the the second row of @xmath284 .",
    "since we have deleted @xmath341 columns , @xmath225 equals @xmath342 .",
    "we observe that @xmath343 for @xmath344 , where @xmath345 equals the number of @xmath113 s such that @xmath346 .",
    "therefore @xmath347 are independent of each other .",
    "it is now straightforward to check that the partial fraction decomposition of @xmath348 with respect to @xmath120 is : @xmath349 where @xmath350 is a laurent polynomial in @xmath120 , and @xmath351 ranges over all @xmath352th roots of unity .    by proposition [ p - rproperty1 ]",
    ", @xmath353 implies that @xmath354 and hence @xmath355 .",
    "together with the fact that for any @xmath356 independent of @xmath120 , @xmath357 we have @xmath358 where the sum ranges over all @xmath116 such that @xmath359 , which , by condition @xmath312 , is equivalent to @xmath360 . for such @xmath116 , we can check that @xmath361 is a contribution sequence .",
    "let @xmath362 where we emphasize @xmath363 as a function of @xmath364 . by delaying the deletion procedure",
    ", we can check that @xmath365 then @xmath366 is a sum of @xmath334 s , each have the form @xmath367 for some @xmath113 with @xmath368 and @xmath116 with @xmath369 being a contribution sequence .",
    "we say that @xmath370 is similar to @xmath363 and it is clear that @xmath370 has the i - property if and only if @xmath363 has .",
    "this completes the proof of the claim .",
    "[ rem - monster ] if @xmath280 satisfies the condition in theorem [ t - monster ] , then for @xmath371 , it follows from the proof that @xmath372 can be expressed as a sum of group terms indexed by contribution sequences @xmath315 of @xmath280 , with the corresponding group being a sum of terms similar to @xmath373 .",
    "in particular , @xmath374 can be expressed as at most a sum of @xmath375 groups , since there are at most @xmath375 contribution sequences . a fast way to compute the sum for each group and an effective way to reduce the number of contribution sequences will result in an efficient algorithm for computing @xmath376 .",
    "to apply theorem [ t - monster ] to a particular @xmath377-system , we need to choose a working field @xmath378 to work with .",
    "the choice of @xmath69 is not unique , but we will concentrate on two special cases that always work .",
    "one is the case that @xmath379 is the identity ; the other is equivalent to that in @xcite . in both cases , we can simplify the condition in finding the contribution sequence .",
    "case 1 : let @xmath76 be the working field . the condition @xmath380 in definition [ def - contrib ] can be replaced with @xmath381 , where if we write @xmath382 , then @xmath383 is the largest such that @xmath384 . in practice , we put the sign of @xmath385 at the upper front of @xmath386 .",
    "let @xmath387 the following ld - system : @xmath388    then the crude generating function @xmath389 of this ld - system is given by . using maple , we find that @xmath387 has the r - property for all @xmath390 plotted by @xmath391 , and has i - property for all @xmath390 plotted by @xmath392 in the following figure [ f - rec1 ] , where we tested all @xmath393 . thus the r - property does not implies the i - property .",
    "[ f - rec1 ] @xmath394{monster.eps}\\ ] ]    let @xmath76 be the working field .",
    "we want to apply theorem [ t - monster ] to find such pairs .",
    "since the second row of @xmath302 has only one positive entries , only @xmath395 is a contribution sequence of length @xmath316 .",
    "so after eliminating @xmath396 , we get a sum of three terms similar to @xmath272 given by @xmath397,\\ ] ] where we kept the first column to keep track the original column numbers .",
    "now it is easy to see that the only contribution sequence of length @xmath398 is @xmath399 , though we do not need it .",
    "therefore , theorem [ t - monster ] tells us that the ld - system has the r - property if the following two equations have the r - property : @xmath400 using maple , we find all such @xmath390 as plotted by @xmath392 in figure [ f - rec1 ] :    consider the equivalent ld - system @xmath401 : @xmath402 where we multiplied both sides of the second equation by @xmath55 and switched the two equations .",
    "we need to find @xmath390 for @xmath403 to have the r - property , where @xmath404.\\ ] ] this time we have two contribution sequences of length @xmath316 : @xmath395 and @xmath405 .",
    "therefore , theorem [ t - monster ] tells us that the ld - system has the r - property if the following three equations have the r - property , where the second and third equation are from @xmath406 and @xmath407 : @xmath408 using maple , we obtain the same pairs @xmath390 as in the previous one , i.e. , those plotted by @xmath392 in figure [ f - rec1 ] .",
    "all these three equations are needed to apply theorem [ t - monster ] .",
    "the following coincidence is worth mentioning : if we only consider the second and the third equation , we will get all @xmath390 plotted by @xmath391 in figure [ f - rec1 ] , i.e. , those @xmath390 such that @xmath409 has the r - property .",
    "since the first equation comes from the empty contribution sequence , we come back to check the previous example , which is obviously not the case .",
    "case 2 : let @xmath69 be the injective homomorphism into @xmath410 by @xmath411 and @xmath412 then the condition in definition [ def - contrib ] can be replaced with @xmath413 , where @xmath146 is the total degree of @xmath414 in the @xmath281 s . since we only need to keep track of the total degree of the @xmath281 s , the @xmath415 in the top row of @xmath280 can be replaced with @xmath316 .",
    "the monster reciprocity theorem obtained this way is similar to that of @xcite , in which the computation used integration along the circles @xmath416 with @xmath417 , where @xmath418 means  much greater \" , and the @xmath415 is taken to satisfy @xmath419 for some positive real number @xmath420 .",
    "in fact , the condition as in definition [ def - contrib ] was completely written in terms of determinants .",
    "detailed example for this case , which will not be given here , can be found in @xcite .",
    "now let us consider linear homogeneous diophantine system ( lhd - system for short ) .",
    "we shall use theorem [ t - monster ] to derive the following theorem , which implies the reciprocal domain theorem ( * ? ? ?",
    "* proposition  8.3 ) including theorem [ t-3-recip ] .",
    "[ t - rec - dom ] suppose @xmath280 is a matrix form corresponding to an lhd - system of full rank",
    ". then for any @xmath69 satisfying @xmath312 , @xmath280 has the r - property if and only if either @xmath421 or @xmath422 and @xmath423 .",
    "if we let @xmath69 be the identity map , then we get theorem [ t-3-recip ] .",
    "if we let @xmath424 for @xmath425 and @xmath100 for @xmath426 for @xmath17 with @xmath427 , and @xmath101 for all @xmath25 , then we will get the reciprocal domain theorem ( * ? ? ?",
    "* proposition  8.3 ) .    if @xmath280 has the r - property , then @xmath428 the implication thus follows .",
    "now we show the converse is true .",
    "obviously we can suppose @xmath429 , @xmath422 and @xmath423 .",
    "we first show that the second row of @xmath280 has the r - property .",
    "since @xmath280 corresponds to an lhd - system , we can write @xmath430 where @xmath431 is a monomial independent of @xmath396 . if some of the @xmath226 are positive and some of the @xmath226 are negative , then corollary [ c - macrec ] applies and the second row of @xmath280 has the r - property .",
    "otherwise , one of @xmath432 and @xmath433 will be @xmath135 and the other will be nonzero .",
    "( note that since the lhd - system has full rank , the case that @xmath434 for all @xmath25 will not happen . )",
    "the statement then follows by proposition [ p - rproperty1 ] .",
    "now by lemma [ l-3-monomial ] , if @xmath435 is obtained from @xmath280 by elementary row operations , then @xmath436 and @xmath437 .",
    "therefore , the second row of @xmath435 has the r - property .",
    "this means every linear combination of the equations of @xmath280 has the r - property .",
    "thus the theorem follows from theorem [ t - monster ] .",
    "the proof of the theorem , together with remark [ rem - monster ] , in fact shows the following statement : if @xmath438 and @xmath423 , then @xmath439 is proper in all @xmath241 for @xmath440 . on the other hand , a simple proof of the statement will lead to a simple proof of theorem [ t-3-recip ] .",
    "if we restrict ourself in @xmath44[[\\mb{x}]]$ ] , the best known proof of theorem [ t-3-recip ] should be that given by the author in @xcite , which is included in the next section .",
    "the above remark suggest a way to reduce the number of contribution sequences of an lhd - system : following the notation as in remark [ rem - monster ] , since every @xmath323 has the r - property for @xmath441 , we have a choice to choose all those terms with contribution or all those terms ( with a minus sign ) without contribution .",
    "the author is managing to develop a computer program implementing these techniques .",
    "we are concentrating on linear homogeneous diophantine systems ( lhd - systems for short ) , i.e. , @xmath442 . recall that @xmath24 is the @xmath25th column vector of @xmath0 .",
    "we omit the @xmath7 so that @xmath443 and @xmath98 are the sets of all solutions of @xmath442 in @xmath29 and @xmath30 respectively , and similar for other notations .",
    "since the proof closely related the linear system and its associate generating functions , we restate them as follows .",
    "we shall see that all of the work is done algebraically .",
    "first , let us see some facts .",
    "exchanging column @xmath25 and @xmath113 corresponds to exchanging @xmath415 and @xmath446 .",
    "row operations , which will not change the solutions of @xmath447 , are equivalent to multiplying @xmath0 on the left by an invertible matrix .",
    "this fact can be obtained by applying lemma [ l-3-monomial ] .",
    "let us see the simple case of @xmath117 . in this case , @xmath448 has the form : @xmath449 the condition that @xmath450 is nonempty is equivalent to saying that some of @xmath226 have to be positive and some of @xmath226 have to be negative .",
    "thus when written in the normal form of a rational function in @xmath120 , @xmath451 is proper and its numerator divides @xmath120 .",
    "so proposition [ p-3-recip ] follows from corollary [ c - macrec ]",
    ".    the general case does not seem to work along this line because of two problems .",
    "one is how to use the conditions that @xmath98 is nonempty , and the other is how to connect to the rank of @xmath0 .",
    "the proof we are going to give uses induction and elliott s reduction identity @xcite , which is easy to check and is not given here .    clearly if @xmath452 are all positive or are all negative , then @xmath98 is empty .",
    "so we can assume that @xmath453 and @xmath454 .",
    "applying elliott s reduction identity on @xmath396 , we get : @xmath455 now expand @xmath451 according to the middle term , and denote the resulting three summans by @xmath456 , @xmath457 , and @xmath458 respectively .",
    "we have @xmath459 then these @xmath460 are very similar to @xmath461 .",
    "correspondingly , they are associated to matrices , and hence solution spaces that lie in @xmath29 and @xmath30 .",
    "more precisely , @xmath460 , @xmath462 , are associated to @xmath463 , @xmath464 , and @xmath465 respectively .",
    "thus @xmath466 and @xmath467 are defined correspondingly .    now the matrix @xmath468 is obtained from @xmath0 by adding the second column to the first ; the matrix @xmath469 is obtained from @xmath0 by adding the first column to the second .",
    "they are obtained from @xmath0 through a column operation .",
    "so the rank of @xmath468 and @xmath469 are both equal to that of @xmath0 .",
    "the rank of @xmath470 might not equal the rank of @xmath0 .",
    "looking more closely at these @xmath474 , we can see that up to isomorphism , @xmath475 , @xmath476 , and @xmath477 are obtained from @xmath443 by intersecting the half spaces @xmath478 , @xmath479 , and the hyperplane @xmath480 respectively . for instance , @xmath481 belongs to @xmath443 with @xmath478 if and only if @xmath482 belongs to @xmath475 .",
    "thus elliott s reduction identity in fact corresponds to a signed decomposition of @xmath443 .",
    "equation and could be explained directly from geometry .",
    "if @xmath98 is nonempty , then @xmath483 .",
    "clearly , the dimension of the solution space of @xmath447 is @xmath484 .",
    "let @xmath485 , and let @xmath486 be a @xmath487-basis of the solution space in @xmath488 with @xmath489 .",
    "then for sufficiently large @xmath225 , @xmath490 will be a linearly independent set in @xmath98 .",
    "suppose that @xmath492 and @xmath493 are nonempty .",
    "then we have elements @xmath494 and @xmath495 in @xmath98 such that @xmath496 with @xmath497 and @xmath498 with @xmath499 .",
    "then @xmath500 is in @xmath98 with the first two entries being equal .",
    "this means @xmath501 is nonempty .",
    "suppose that @xmath502 and @xmath501 are nonempty .",
    "then we have elements @xmath494 and @xmath503 in @xmath98 such that @xmath496 with @xmath497 and @xmath504 with @xmath505 .",
    "then for sufficiently large @xmath225 , @xmath506 is in @xmath98 with the first entry being smaller than the second .",
    "this means @xmath493 is nonempty .        by hypothesis ,",
    "it is clear that @xmath443 is not contained in the hyperplane @xmath480 .",
    "thus the intersection of @xmath443 with the hyperplane has dimension @xmath510 .",
    "so @xmath511 is also @xmath512 and the rank of @xmath470 equals @xmath513 .      by exchanging rows",
    ", we can assume that not all of the entries in the first row of @xmath0 are zero .",
    "moreover , since the entries can not be all positive or negative , we can assume the first entry is positive and the second is negative by exchanging columns .",
    "we use induction on @xmath514 , which is defined to be the sum of the absolute values of all the entries in the first row . now the above argument applies , and it is easy to see that @xmath515 for @xmath462 . applying lemma [ l-3-empty-23 ]",
    ", we can reduce the seven cases of @xmath474 being nonempty or not into the following four cases :    case 1 : only @xmath492 is nonempty .",
    "let @xmath494 in @xmath98 be such that @xmath497 .",
    "we claim that all @xmath11 with @xmath447 satisfy the condition @xmath516 , so that @xmath517 equals @xmath518 , and hence by induction we have @xmath519          case 4 : all of @xmath491 are nonempty . by induction",
    ", we see that @xmath525 for @xmath177 , and that @xmath526 from lemma [ l-3-rankall ] , @xmath527 . thus together with our key induction equations and ,",
    "we get @xmath528"
  ],
  "abstract_text": [
    "<S> by studying the reciprocity property of linear diophantine systems in light of malcev - neumann series , we present in this paper a new approach to and a generalization of stanley s monster reciprocity theorem . </S>",
    "<S> a formula for the  error term \" is given in the case when the system does not have the reciprocity property . </S>",
    "<S> we also give a short proof of stanley s reciprocity theorem for linear homogeneous diophantine systems .     </S>",
    "<S> reciprocity property , linear diophantine system , laurent series , malcev - neumann series </S>"
  ]
}