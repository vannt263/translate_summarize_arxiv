{
  "article_text": [
    "the development of specialized numerical methods and the increase in available computing resources have helped making substantial progress in understanding many nonlinear problems as dynamical systems .",
    "the most basic tool available to that end is time integration which simulates the temporal evolution of an initial condition , thereby emulating an experimental or natural realization .",
    "time integration provides access to the preferred transient and end state , however , it does not ( necessarily ) provide access to information regarding the origin of these end states .",
    "one way to understand how these states are formed is to compute unstable solutions . these states can not be obtained , or in some rare cases very hardly , using time integration but help provide a complete picture of the dynamical system : these can gain stability or lead to the creation of new solutions or new transients under parametrical changes .",
    "numerical continuation has been developed to complement time - integration in that respect and has become an essential part of the toolkit of the nonlinear dynamicist .",
    "pionnered by keller @xcite , these methods compute steady solutions of a system of ordinary differential equations ( ode ) and their evolution as the values of the parameter of the problem are changed .",
    "their aim is to _ continue _ a fixed point in parameter space in order to draw its _ branch _ and unfold the _ bifurcation diagram _ explaining its formation .",
    "continuation methods consist in a two - step algorithm comprising a prediction phase using previous iterates along the branch and a correction phase involving a fixed point method @xcite . due to their nature",
    ", these methods are capable of computing exact solutions regardless of their stability and provide information on the effect of parametric changes on a solution .",
    "numerical continuation became a very popular tool , broadly used in many different fields @xcite and a myriad of packages have been developped and released in the open domain @xcite .",
    "the area of fluid dynamics has seen much progress with the help of continuation methods .",
    "intricate pattern formation problems have been elucidated such as that of rayleigh  bnard convection rolls in cartesian @xcite , cylindrical @xcite and spherical shell geometries @xcite .",
    "more complicated physics has been tackled , such as doubly diffusive convection @xcite and free surface binary fluid convection @xcite with similar success .",
    "spatially localized pattern formation , involving large aspect - ratio domains , has also been investigated : a collection of spatially localized convective states have been found in two - dimensional large aspect - ratio binary fluid convection @xcite , rotating convection @xcite and magnetoconvection @xcite . despite the successful and reliable use of continuation methods in two - dimensional and small three - dimensional domains , the extention to more complex geometries constitutes a major challenge .",
    "the most noticeable attempts concern doubly diffusive convection in a three - dimensional domain of square cross section and large transverse direction @xcite and porous medium convection in domains extended in two directions @xcite , each of these problems involving @xmath0 degrees of freedom .",
    "these studies involved unreasonably long simulation campaigns and require a certain level of experience in the use of numerical continuation to provide results in an efficient way , if at all .",
    "another area of fluid dynamics that has benefited from the developments of numerical continuation is that of transition to turbulence .",
    "shear flows such as plane couette flow or pipe flow are subcritical flows , i.e. , the trivial laminar solution is stable and coexists with turbulence , a state in which the flow displays spatial and temporal complexity , above a threshold value of the parameters .",
    "meticulous studies of the unstable exact solutions living between both states have provided crucial understanding of transition .",
    "the pioneering discovery of unstable nonlinear solutions in plane couette flow @xcite drew a lot of attention and started a new research area .",
    "the simplest of these solutions has been thoroughly studied @xcite and new solutions discovered @xcite that all together provide a comprehensive picture of transitional phenomena .",
    "similar studies took place in other shear flows and hinted at a common mechanism for transition to turbulence in subcritical shear flows @xcite .",
    "lastly , recent tours de force involving numerical continuation on large domains revealed families of spatially localized states of different kinds @xcite .",
    "the aim of this paper is to describe an efficient and adaptive way to precondition the navier  stokes equation governing steady incompressible flows .",
    "some basic principles of numerical continuation are summarized in section [ secnumcont ] . in section [ precon ] , i describe the preconditioning method , followed in section [ secex ] by two examples : three - dimensional coupled convection and shear flows .",
    "a short conclusion terminates the paper .",
    "we consider the simple dynamical system : @xmath1 where @xmath2 represents time , @xmath3 is the solution vector of dimension @xmath4 , @xmath5 is a nonlinear operator and @xmath6 the continuation or free parameter .",
    "we seek solutions that satisfy @xmath7 or equivalently @xmath8 .",
    "note that in case there is more than one parameter , all the parameters but one ( @xmath6 ) are kept fixed and are included in the operator @xmath9 .",
    "a continuation method consists in parameterizing and continuing the branch of solutions of equation ( [ fu0 ] ) : @xmath10 , where @xmath11 is the arclength along the branch .",
    "this is done in two steps : a prediction step based on extrapolation of previous results along the branch is created and then converged with fixed point method based on equation ( [ fu0 ] ) . in the following , i detail simple , programmer - friendly , choices for the prediction step and then describe two different ways of converging them : fixed parameter and pseudo - arclength continuation . the former is the simplest to implement and is the one used in the exemples in section [ secex ] .",
    "it provides an easy guide to get started with continuation .",
    "the first step of a continuation method is prediction .",
    "the simplest way to predict consists in a polynomial extrapolation along the branch at a parametric distance @xmath12 . if only one solution along the branch @xmath13 is known , it is used as a predictor @xmath14 of a second solution @xmath15 : @xmath16 upon successful computation of the second solution , a linear extrapolation is used to provide an initial condition @xmath17 for the third point @xmath18 : @xmath19 from the moment three or more solutions are known , there is typically little to gain in increasing the polynomial degree of the approximation and quadratic extrapolation remains standard : @xmath20 for the prediction @xmath21 for the @xmath22-th solution @xmath23 .",
    "the method above , although simple to derive and program , fails in the presence of a saddle - node as @xmath24 changes sign .",
    "this can easily be fixed by monitoring the approach of a saddle - node and changing the sign of @xmath12 when the corrector fails at the approach of a saddle - node .",
    "it is also usual to replace equation ( [ straightpredic ] ) by a condition on the arclength @xmath25 , such as : @xmath26 to predict at a distance @xmath25 from solution @xmath27 .",
    "other methods , more sophisticated or tailored to the specific needs or preferences of the user can be generated but are out of the scope of the present article .      to converge the prediction",
    ", one condition has to be added so that equation ( [ fu0 ] ) yields a well - posed problem .",
    "this first possibility consists in fixing the value of the parameter @xmath6 and changing the continuation mode at the approach of a saddle - node .",
    "it is called _ fixed parameter continuation _ is explained in the following section .",
    "another very popular continuation method consists in adding a condition ensuring that the correction is done along a vector orthogonal to the prediction vector .",
    "this method is known under the name of _ pseudo arc - length continuation _ and is described in the subsequent section .",
    "we use a newton  raphson ( hereafter newton ) method to converge the prediction obtained in the previous section to the solution of system ( [ fu0 ] ) .",
    "fixed parameter continuation consists in freezing one quantity , typically @xmath6 , and correct the other ones .",
    "we then set @xmath28 and solve the resulting @xmath29 system : @xmath30 where @xmath31 is the frchet derivative of @xmath9 with respect to @xmath32 and the superscript @xmath33 denotes quantities evaluated at the @xmath33-th newton iteration .",
    "the computation of @xmath34 is then followed by the correction @xmath35 . provided the prediction @xmath36 is close enough to a solution , the newton method ( [ newton1 ] ) converges quadratically .",
    "issues arise at saddle - nodes , as no solution might exist at @xmath37 . to anticipate this ,",
    "an alternate continuation mode is used in which @xmath6 is free to vary while one element of @xmath32 is kept constant , resulting in an @xmath29 system again .",
    "if @xmath38 is part of the solution : @xmath39 , where @xmath38 and @xmath40 denote respectively the @xmath41-th element of @xmath32 and @xmath9 .",
    "we introduce @xmath42 the vector constituted of all elements of @xmath32 but @xmath38 and @xmath43 similarly . under this rearrangement , continuation of saddle - nodes",
    "can be achieved by solving the following system at the @xmath33-th newton iteration : @xmath44 where the right - hand - side of the last equation is @xmath45 .",
    "the correction reads @xmath46 and @xmath47 .    to pass saddle - nodes ,",
    "a criterion has to be set up to determine when to switch from fixed @xmath6 to fixed @xmath38 continuation .",
    "this criterion can involve the slope of the branch , for instance : @xmath48 where @xmath49 represents a norm of @xmath32 and @xmath50 an arbitrary real constant whose optimal value is problem - dependent .",
    "when criterion ( [ criterion ] ) is true , the slope of the branch is gentle and the continuation is done for a fixed @xmath6 . on the contrary , when criterion ( [ criterion ] ) is false , the slope of the branch is significant and might indicate the presence of a saddle - node . in that case , switching to a fixed @xmath38 continuation provides better results .",
    "figure [ continuation](a ) provides a sketch of this type of continuation for a scalar solution @xmath51 , highlighting both the fixed parameter correction from @xmath52 and the fixed @xmath51 correction for @xmath53 .     against parameter @xmath6 :",
    "fixed parameter continuation ( a ) and pseudo - arclength continuation ( b ) .",
    "the former consists in correcting either at a fixed parameter value ( see correction from @xmath52 ) or at a fixed value of the solution ( or one of its components , see correction from @xmath52 ) .",
    "the latter consists in correcting on a direction orthogonal to the prediction direction.,scaledwidth=80.0% ]",
    "the prediction / correction loop just described is usually optimized through variable prediction distances .",
    "when the prediction distance ( either @xmath12 or @xmath25 ) is too small , the correction is very simple .",
    "it takes one or two newton iteration to converge to the desired accuracy and many small trivial steps are made along the branch , wasting time in the process .",
    "when the prediction distance is too large , the correction is tedious and can take many difficult newton iterations , jump over to another branch or simply fail . in that case ,",
    "a fallback is necessary .",
    "a safe strategy here is to start continuation with a relatively small prediction distance and increase it by a factor typically smaller than @xmath54 until the number of newton iterations necessary for correction increases to a target number past which the algorithm is thought inefficient .",
    "this number is usually @xmath55 or @xmath56 .",
    "if the number of newton iterations becomes larger , the prediction distance is multiplied by a factor around @xmath57 to make sure that the simulation always runs simple incremental but non trivial calculations .",
    "pseudo arc - length continuation does not work with fixed parameter values but rather adds a scalar equation to system ( [ fu0 ] ) , making it an @xmath58 problem .",
    "the basic idea is to allow @xmath6 to vary while imposing a condition on the arclength parameter @xmath25 @xcite .",
    "again , several types of such conditions can be chosen , among which the orthogonal correction : @xmath59 where @xmath23 is the last known solution along the branch and @xmath60 a normalized expression of the tangent to the branch at this point .",
    "this condition imposes that the correction be orthogonal to the tangent to the branch at a distance @xmath25 from @xmath23 .",
    "one way to approximate @xmath60 is to solve the linear system : @xmath61 where the derivatives are evaluated at the point @xmath23 and where @xmath62 .",
    "this implies an additional step of linear algebra and might yield significant additional computing time for large scale systems . instead",
    ", the tangent can be approximated by interpolation from previously calculated points along the branch @xcite .",
    "this accuracy sacrifice does not hinder continuation .",
    "it represents a less elegant but more efficient choice .",
    "once the tangential vector is evaluated , the @xmath58 system of the @xmath33-th newton iteration reads : @xmath63 where @xmath64 is the condition residual .",
    "lastly , the correction is applied : @xmath35 and @xmath47 .",
    "a sketch of the way pseudo - arclength continuation works is shown in figure [ continuation](b ) alongside fixed parameter continuation to highlight the differences .",
    "the advantage of pseudo - arclength continuation over fixed parameter continuation is that it parametrizes directly an approximation of @xmath65 so does not fail at special points . on the other hand , to retain the whole essence of the method , the prediction has to involve a condition on the arclenth like equation ( [ arcpredic2 ] ) or the application of equation ( [ withtang ] ) to the prediction @xmath66 instead of the running newton iteration .",
    "the drawback of this is the creation of additional linear systems to be solved and thus to a substantial increase in computing time , especially in high dimension algebra .",
    "note that the increase in the dimension of the pseudo - arclength algorithm compared to the fixed parameter one from @xmath29 to @xmath58 has a negligible impact in terms of performance on such systems .",
    "in general , incompressible fluid flows are modeled using the navier  stokes equation together with the continuity equation : @xmath67 where @xmath2 represents time , @xmath32 the velocity field , @xmath68 the pressure and @xmath69 the dimensionless reynolds number .",
    "the choice of nondimensionalization is here purely informative and does not impact the method .",
    "the discretized version of these equations yields large dynamical systems , often exceeding @xmath70 degrees of freedom which are typically solved using the newton iteration .",
    "it follows that iterative methods are preferred for the inversion of the jacobian .",
    "in fact , evaluating the jacobian itself would require memory space that is hardly affordable double precision matrix takes about @xmath71 gb . ] and alternative methods that do not necessitate the evaluation of the jacobian can be used .",
    "these methods are called _ matrix free methods _ and revolve around the ability to express the product between the jacobian and an arbitrary vector without ever evaluating the jacobian itself .",
    "another issue arises when dealing with incompressible flows : the jacobian is often ill - conditioned .",
    "this feature is in fact common to flows that are highly diffusive , i.e. , for which the reynolds number @xmath69 is small and the laplacian term is dominant .",
    "an efficient preconditioner for such systems is the stokes preconditioner @xcite .",
    "this preconditioner is naturally implementable within a matrix free method which makes it a method of choice for continuation of diffusion - dominated incompressible flows . for problems that are not dominated by diffusion",
    ", however , another preconditioner has to be used .",
    "we consider the following dynamical system : @xmath72 where @xmath2 is time , @xmath32 is the solution field , @xmath73 represents a nonlinear term and @xmath74 a linear term .",
    "we use the first order implicit euler scheme : @xmath75 where @xmath76 is the timestep and @xmath77 is the evaluation of @xmath32 at time @xmath2 .",
    "on expressing @xmath78 , we get : @xmath79.\\ ] ] the preconditioner is obtained by substracting @xmath77 from @xmath78 : @xmath80 - { \\bf u}^{t}\\\\ & & = \\left ( i - \\triangle t \\ , l \\right)^{-1 } \\left [ { \\bf u}^{t } + \\triangle t \\ ,",
    "n({\\bf u}^{t } ) - { \\bf u}^{t } + \\triangle t \\ ,",
    "l { \\bf u}^{t } \\right]\\\\ \\label{sto1 } & & = \\triangle t \\left ( i - \\triangle t \\ , l \\right)^{-1 } \\left [ n({\\bf u}^{t } ) + l { \\bf u}^{t } \\right],\\end{aligned}\\ ] ] where the right - hand - side is the evaluation at time @xmath2 of the right - hand - side of equation ( [ stoeq ] ) .",
    "the general form for the preconditioned equation is thus : @xmath81,\\ ] ] where @xmath50 is a constant and @xmath82 the preconditioner .",
    "the values taken by these quantities are summarized in table [ tabprecon ] as @xmath76 is changed .",
    "@xmath83 & @xmath84 & @xmath85 + @xmath86 & @xmath86 & @xmath87 + @xmath88 & @xmath89 & @xmath90 +    [ tabprecon ]    there are two asymptotic regimes .",
    "first , for sufficiently small @xmath76 , @xmath82 approaches the identity operator and the equation is solved without effective preconditioning .",
    "second , assuming @xmath85 , it follows @xmath91 and expression ( [ sto1 ] ) becomes : @xmath92,\\ ] ] thus providing a laplacian preconditioner .",
    "this limit is known as stokes preconditioner @xcite and was first used by mamun & tuckerman to study symmetry breaking instabilities in spherical couette flow and proved efficient even at relatively large reynolds numbers . ]",
    "despite the development of such a method for shear flows , rare are the subsequent uses of the stokes preconditioner in this field .",
    "some studies have however emerged , like the investigation of the three - dimensional instability of a flow passed a step @xcite .",
    "the stokes preconditioner has on the other hand been used extensively to study pattern formation in convection where the reynolds number is often unity , due to other choices of dimensionalization @xcite .",
    "previous work on weakly diffusive shear flows have not necessitated preconditioning @xcite . in intermediate regimes , however , difficulties may arise : diffusion may not be weak enough for the system to be solved successfully without preconditioner , but the stokes preconditioner overcompensates and yields an ill - conditioned system again . to address this issue , we extend the stokes preconditioner to non - asymptotic values of @xmath76 .",
    "the resulting preconditioner is @xmath93 , with @xmath86 and proves efficient for a wide range of systems , from coupled convection to shear flows , as we shall see .",
    "similarly , the linearization of equation ( [ stoeq ] ) , @xmath94 where @xmath95 is the linearization of the nonlinear term evaluated at @xmath32 and @xmath96 an elementary displacement in @xmath32 , can be treated the same way to yield @xmath97\\\\ \\label{jacobsto } & & \\approx c \\",
    ", p^{-1 } j({\\bf u}^{t } ) \\ , \\delta{\\bf u}^{t},\\end{aligned}\\ ] ] where @xmath98 is the jacobian of system ( [ stoeq ] ) .",
    "we can then compute the preconditioned jacobian of equation ( [ stoeq ] ) by computing one step forward in time of the linearized equation ( [ stoeqlin ] ) using an implicit euler scheme and then substracting the initial condition .",
    "the preconditioner used for the base and linearized equations is the same for the same value of @xmath76 .    to search for stationary flow solutions , we consider the following newton method : @xmath99 with correction @xmath100 . by multiplying this equation by @xmath101",
    ", we obtain : @xmath102 the left - hand - side of equation ( [ stofinal ] ) is evaluated using the implicit euler scheme given by equation ( [ jacobsto ] ) and the right - hand - side of equation ( [ stofinal ] ) is computed using equation ( [ adaptprecond ] ) .",
    "the inversion of the jacobian can be performed using iterative methods @xcite such as the biconjugate gradient stabilized method @xcite .",
    "in this section , two examples of continuation of incompressible fluid flows are considered .",
    "numerical continuation is performed using the preconditioner presented in section [ precon ] .",
    "the first flow considered is doubly diffusive convection , in which the preconditioner is tested in a three - dimensional configuration .",
    "the second test flow is a two - dimensional model of shear flow in which a parameter dependent use of the preconditioner is prescribed and for which the system of equations is split into two sets preconditioned in different manners but solved simultaneously .",
    "we consider a boussinesq fluid constituted of two components , the heaviest of which is referred to as a salt .",
    "the fluid is placed within a three - dimensional enclosure of square horizontal cross - section and aspect ratio @xmath103 in the vertical direction .",
    "the flow is driven by buoyancy through the imposition of large scale horizontal gradients of temperature and concentration : one wall is maintained at a larger temperature and salinity than the opposite one .",
    "the other walls are modelled using no flux conditions .",
    "no - slip boundary conditions are imposed at all walls .",
    "the nondimensional equations governing the dynamics of this flow are : @xmath104 = -\\nabla p + ra ( t - c ) { \\bf \\hat{x } } + \\nabla^2 { \\bf u},\\\\ & \\nabla \\cdot { \\bf u } = 0,\\\\ & \\partial_t t + ( { \\bf u } \\cdot \\nabla)t = \\nabla^2 t,\\\\ & \\partial_t c + ( { \\bf u } \\cdot \\nabla)c = \\tau \\nabla^2 c,\\end{aligned}\\ ] ] where @xmath2 is time , @xmath105 is the velocity field in the cartesian frame @xmath106 , @xmath68 is the pressure , and @xmath107 and @xmath108 are linear rescaling of the fluid temperature and salt concentration in the boussinesq approximation . here , @xmath109 represents the vertical unit vector in the ascending direction .",
    "in addition to these quantities , three nondimensional parameters are introduced .",
    "the prandtl number @xmath110 is the ratio of the kinematic viscosity over the thermal diffusivity , the inverse lewis number @xmath111 is the ratio of the salt diffusivity over the thermal diffusivity and the rayleigh number @xmath112 quantifies the buoyancy strength and will be used as the continuation parameter in what follows .",
    "these equations are complemented with boundary conditions : @xmath113 where the operator @xmath114 represents the spatial derivative in the direction normal to the wall .",
    "more details on the physical setup are available in @xcite .",
    "the physical domain is meshed using @xmath115 identical spectral elements of size @xmath116 , @xmath117 .",
    "each element is meshed using gauss  lobato ",
    "legendre points in all three direction : @xmath118 in @xmath119 , @xmath120 in @xmath121 and @xmath122 .",
    "the discretization strategy is illustrated in figure [ mesh ] and yields @xmath123 degrees of freedom ( counting in the pressure ) .     out of the @xmath115 elements",
    "are shown with only the first ( bottom left ) element displaying its surface mesh .",
    "the inner grid is hidden to avoid overloading the figure.,scaledwidth=80.0% ]    time is discretized using a straightforward first order euler scheme for temperature and concentration : @xmath124^{(n-1 ) } \\right),\\\\ & c^{(n ) } = \\left ( i - \\triangle t \\ , \\tau \\ , \\nabla^2 \\right)^{-1 } \\left(c^{(n-1 ) } - \\triangle t \\ , [ ( { \\bf u } \\cdot \\nabla ) c]^{(n-1 ) } \\right),\\end{aligned}\\ ] ] where @xmath125 stands for the evaluation of the temperature at the @xmath4-th timestep , @xmath126 is the identity operator and @xmath76 is the timestep .",
    "the incompressible navier  stokes equation is discretized using a first order splitting method described by karniadakis , israeli and orszag @xcite .",
    "an intermediate velocity is predicted which takes into account buoyancy and advection : @xmath127^{(n-1 ) } + \\triangle t \\ , ra \\ , ( t - c)^{(n-1 ) } { \\bf \\hat{x}},\\ ] ] which is corrected using the incompressibility condition by introducing the velocity @xmath128 : @xmath129 where the pressure is defined by the poisson problem obtained by taking the divergence of equation ( [ kio2 ] ) : @xmath130 complemented with the boundary condition : @xmath131^{(n-1 ) } - \\nabla \\times \\nabla \\times { \\bf u}^{(n-1 ) } \\right ) \\cdot { \\bf \\hat{n}},\\ ] ] where , @xmath132 represents the vector normal to the boundary and the last term is the reduction of the laplacian term using the divergence condition .",
    "the time - step is completed via the following operation : @xmath133 where the original boundary conditions ( [ ddbc1])([ddbc3 ] ) are used .",
    "time - stepping then only requires the inversion of helmholtz operators coming from the spatial discretization . as a consequence of the choice of spectral elements , the helmholtz operators are sparse tensors and",
    "a schur decomposition has been performed to invert them efficiently .",
    "continuation is performed on the solution vector @xmath134 using the temporal schemes above and the same @xmath76 for all equations .",
    "this flow configuration exhibits localized pattern formation at onset through a subcritical bifurcation .",
    "the branches emerging from this bifurcation produce well - bounded back and forth oscillations in parameter space in a behavior known as _",
    "snaking_. more detailed information is available in @xcite .",
    "we focus here on one branch of spatially localized states .",
    "the branch is shown in figure [ locabranch ] .     of the trivial motionless fluid branch ( horizontal line ) and of one of the localized state branches as a function of the rayleigh number @xmath112 .",
    "( b ) zoom in the first region of interest : the test of the preconditioner is run through leftward continuation along the red portion of the branch delimited by the dots . ( c )",
    "zoom in the second region of interest where the tests is run rightwards .",
    "the solutions denoted by a dot are shown in figure [ locasols ] . ]    to design a test for the preconditioner , we select two segments along the branch and impose fixed parameter continuation to the algorithm to avoid intricacies related to continuation with a variable parameter . one of this segment consists in solutions that are very localized and where most of the domain is filled with `` zeros '' while the other segment consists in domain - fillin solutions .",
    "the saddle - nodes occur at @xmath135 and @xmath136 so we restrict continuation to @xmath137 .",
    "the solution at @xmath138 and at @xmath139 for both segments are shown in figure [ locasols ] .",
    "-velocity @xmath140 ( a , c ) and of the @xmath122-velocity @xmath141 ( b , d ) . in both cases ,",
    "the solutions represent the extrema of the test segments shown in figure [ locabranch](b ) and ( c ) with the left solution being taken at @xmath139 and the right solution at @xmath138 .",
    "panels ( a ) and ( b ) represent the end points of the test along the lower segment ( figure [ locabranch](b ) ) , while panels ( c ) and ( d ) represent those along the upper segment ( figure [ locabranch](c ) ) . the light ( resp .",
    "dark ) color indicates the positive ( resp .",
    "negative ) contour . ]",
    "these solutions display a number of similar convection rolls centered in the domain . in each of these rolls ,",
    "the fluid goes up along the hot and saltier wall at @xmath142 and down on the opposite wall .",
    "the flow is not purely two - dimensional : due to the presence of walls at @xmath143 and @xmath144 , a weak flow in the @xmath121 direction is generated .",
    "this flow is typically an order of magnitude lower than in the two other direction and is therefore not shown here . as the branch is continued along the lower segment ,",
    "the rayleigh number is decreased and the left the solution changes from the right panels to the left panels of figure [ locasols ] , thereby adding rolls on either side of the central roll . along the upper segment",
    ", the solution is continued in the direction of increasing rayleigh numbers ( from the left to the right panel in figure [ locasols ] ) and the rolls grow in size and amplitude .",
    "the algorithmic parameters are kept at the values used during the original study @xcite and which were determined using a combination of intuition and parametric benchmark : the tolerance of the bcgstab is fixed at @xmath145 , the continuation step is initialized at @xmath146 and can go up to @xmath147 .",
    "the convergence of the solution is assessed by calculating the following quantity : @xmath148\\right|_{l_2},\\ ] ] computed by stepping forward once in time ( see equation ( [ adaptprecond ] ) ) and multiplying by @xmath149 and then taking the @xmath150-norm of the resulting vector .",
    "the multiplying step is taken so that the relative convergence of @xmath151 does not depend strongly on the value of @xmath76 .",
    "the continuation is accelerated by a factor of @xmath152 after each successful step .",
    "if more than @xmath56 newton iterations were necessary to obtain @xmath153 , the continuation step remains untouched .",
    "if the newton iteration fails to converge or if the number of gradient iteration needed to invert the jacobian is greater than @xmath154 , the current step is cancelled and another attempt with a continuation step @xmath155 smaller is made .",
    "a number of attempts were made for both continuation segments , with @xmath76 ranging from @xmath156 to @xmath157 .",
    "the smallest values of @xmath76 did not allow the algorithm to converge , implying that this problem does indeed need preconditioning .",
    "i report here the successful simulations , for @xmath158 .",
    "the basic algorithmic behavior is illustrated in figure [ dddinitmax1 ] on simulations carried out on the lower segment in figure [ locabranch](b ) .     as a function of the continuation point @xmath22 for @xmath159 .",
    "it is exponential with slope @xmath152 until @xmath160 is reached where the growth is algorithmically frozen .",
    "most of the other simulations yielded the same results .",
    "( b ) number of gradient iterations @xmath161 needed to converge as a function of the continuation point @xmath22 for @xmath162 and for @xmath163 ( upper curve displaying large variations ) , @xmath159 ( lower curve ) and @xmath164 ( upper curve with small variations ) .",
    "these results have been obtained during continuation of the lower segment from figure [ locabranch](b ) . ]",
    "panel ( a ) shows the continuation step as a function of the iteration number @xmath22 and indicates an exponential acceleration until @xmath165 .",
    "nearly all the simulations run provided the same results here , which indicates that the continuation neither fails nor become marginally successful in these conditions .",
    "the few exceptions were generally obtained for @xmath166 for which the preconditioner is not strong .",
    "these cases display a few continuation points at which more than @xmath56 newton iterations are needed and where therefore @xmath167 remains fixed before continuing its progression to @xmath147 .",
    "figure [ dddinitmax1](b ) shows for three cases the typical values taken by @xmath161 , the total number of gradient iterations needed to converge a continuation point ( summed up on all the newton steps required at this continuation point ) . for @xmath163 , @xmath168 continuation points are necessary to reach @xmath165 .",
    "the convergence speed displays large variations , with @xmath161 varying between @xmath169 and @xmath170 and averaging @xmath171 with a standard deviation of @xmath172 over the last @xmath173 continuation points",
    ". results at @xmath164 do not suffer from such large oscillations , @xmath174 , and their average number of iteration is significantly lower : @xmath175 .",
    "the best results were obtained for @xmath159 ( lower curve in figure [ dddinitmax1](b ) ) : @xmath176 with @xmath177 .",
    "the results of all the simulations are compiled in figure [ dddresmax1 ] and presented through the average number of gradient iterations needed to converge one continuation point @xmath178 and the normalized standard deviation from this result @xmath179 for the last @xmath173 continuation points , i.e. , when the continuation step is constant : @xmath165 .",
    "continuation points @xmath178 as a function of @xmath76 ( a ) .",
    "the right panel ( b ) shows the standard deviation @xmath180 associated with these simulations normalized by @xmath178 as a function of @xmath76 . in both panels ,",
    "the red dashed curve corresponds to the upper continuation segment results while the blue dashed curve corresponds to the lower continuation segment results .",
    "the thick black curve indicates the average between both segments . ]",
    "figure [ dddresmax1](a ) clearly indicates the presence of three distinct regions where the preconditioner behaves differently .",
    "the first and most obvious is obtained for @xmath181 : for such low values of @xmath76 , there is effectively little preconditioning in place and on such a diffusive system , the continuation struggles as shown by the large increase of @xmath182 as @xmath76 decreases . for @xmath183 ,",
    "continuation becomes impossible , confirming the need for a preconditioner .",
    "a second region of interest is obtained at large @xmath76 for which the preconditioner takes the form of a laplacian .",
    "in fact , little difference is observed for simulations run with @xmath184 , indicating that the asymptotic regime of the laplacian preconditioner is reached . in this regime , converging a continuation point costs around @xmath185 gradient iterations for the lower segment and @xmath186 for the upper one . between these two regions lies a sweet spot located around @xmath159 .",
    "this sweet spot consists in an interval where the preconditioner is at its performance peak .",
    "the most efficient continuation of the lower segment was performed at @xmath159 with an average of @xmath187 gradient iterations per continuation point .",
    "similarly , the most efficient continuation of the upper segment corresponded to @xmath188 and @xmath189 .    furthermore , figure [ dddresmax1](b ) shows the standard deviation associated to the number of gradient iterations normalized by the average to quantify the variation significance .",
    "the laplacian preconditionner is very robust with a relative standard deviation of about @xmath155 of @xmath182 for @xmath184 .",
    "as @xmath76 decreases , @xmath190 increases to reach values above @xmath147 for the smallest successful @xmath76 .",
    "this highlights one particular characteristic : although the preconditioner is at its best in shear performance for values of @xmath76 around @xmath191 , it is less robust there than it is for large @xmath76 .",
    "this accounts for the fact that the results presented in figure [ dddresmax1](a ) are smooth at large @xmath76 but display some anomalies at lower @xmath76 .",
    "notice that the anomaly reported at @xmath192 along the upper segment is due to the algorithm failing to converge at one point .",
    "it is reported here for complete transparency on the results .",
    "best results on a given continuation segment are obtained without bounding the continuation step .",
    "although this is true in principle , in practice one needs to bound it to ensure efficient continuation of saddle - nodes and to avoid jumping onto another branch in case of imperfect bifurcation .",
    "figure [ dddinfinite ] shows the total number of gradient iterations undergone from the startpoint until the endpoint of the continuation segments with @xmath76 unbounded .",
    "needed to complete the lower ( upper ) continuation segment in dashed blue ( red ) lines versus the algorithmic parameter @xmath76 .",
    "the solid black line represents the average between the two data sets.,scaledwidth=50.0% ]    these results are very similar to those shown in figure [ dddresmax1](a ) and confirm the previous observations .",
    "we now consider a three - dimensional fluid confined between two parallel plates of infinite extent .",
    "the flow is driven by the imposition of a sinusoidal volume force creating shear across the fluid layer in a configuration known as _ plane waleffe flow_. the navier  stokes equation together with the incompressibility constraint for this configuration read : @xmath193 where @xmath2 is time , @xmath194 the velocity field in the @xmath195 coordinate frame where @xmath119 is the streamwise direction , @xmath121 the wall - normal direction and @xmath122 the spanwise direction , @xmath68 is the pressure and @xmath69 is the reynolds number which quantifies the imposed shear across the fluid .",
    "these equations are accompanied with periodic boundary conditions in @xmath119 and @xmath122 and no - slip boundary conditions in @xmath121 : @xmath196    this flow configuration is a close cousin of plane couette flow and is studied to investigate transition to turbulence .",
    "a number of studies have revealed the influence of exact coherent states in the transition process @xcite .",
    "these states are exact solutions of the associated system of equations and some of them follow an asymptotic behavior as the reynolds number is increased @xcite .",
    "when the corresponding asymptotic expansions are applied , the three - dimensional system ( [ shearns1 ] ) , ( [ shearns2 ] ) reduces down to the following two - dimensional system : @xmath197 where @xmath198 with @xmath199 , @xmath200 , @xmath201 , @xmath202 , @xmath203 indicates the real part of @xmath204 , @xmath205 is the complex conjugate of @xmath204 and @xmath22 is the unit imaginary number",
    ". the fields @xmath206 , @xmath207 and @xmath208 are real while @xmath209 and @xmath210 are complex . to write system ( [ shearred1])([shearred4 ] )",
    ", the solution has been approximated using the following asymptotics at small @xmath211 : @xmath212 where @xmath206 , @xmath213 , @xmath214 and @xmath215 are real , @xmath216 , @xmath217 and @xmath218 are complex , @xmath219 is a chosen wavelength in the streamwise direction and @xmath220 represents the complex conjugate .",
    "the pressure has been expanded accordingly and a streamfunction @xmath207 and a vorticity @xmath208 have been introduced such that : @xmath221 , @xmath222 and @xmath223 . using this asymptotic approach , the boundary conditions read : @xmath224 together with periodic boundary conditions in @xmath122 . for more details on the derivation ,",
    "see beaume _ et al .",
    "_ @xcite .",
    "the physical domain is two - dimensional and has size @xmath225 and @xmath226 .",
    "it is meshed with @xmath227 equidistributed points in each direction and the linear operators treated using the fast fourier transform in @xmath122 and either the fast cosine transform i or the fast sine transform i in @xmath121 depending on the boundary condition @xcite .",
    "the usual 2/3 dealiasing rule is applied to prevent frequency folding .",
    "this resulting number of unfiltered degrees of freedom is then : @xmath228 .    the fluctuating pressure @xmath210 is solved for as a preliminary step : @xmath229 where the nonlinear right - hand - side is evaluated in physical space and the linear operator inverted in frequency space .",
    "the same first order euler scheme as for the doubly diffusive convection problem is used to treat time dependence in the remaining equations : @xmath230,\\\\ & \\omega_1^{(n ) } = \\left ( i - \\epsilon \\triangle t \\nabla_{\\perp}^2 \\right)^{-1 } \\biggl [ \\omega_1^{(n-1 ) } + \\epsilon \\triangle t \\biggl ( - j\\left(\\phi_1^{(n-1)},\\omega_1^{(n-1)}\\right ) \\dots\\nonumber\\\\ & + 2 ( \\partial_z^2 - \\partial_y^2 ) ( \\mathcal{r}(v_1'^{(n-1 ) } w_1'^{(n-1 ) * } ) ) + 2 \\partial_y \\partial_z ( v_1'^{(n-1 ) } v_1'^{(n-1 ) * } - w_1'^{(n-1 ) } w_1'^{(n-1 ) * } ) \\biggr ) \\biggr],\\\\ & { \\bf v_{1\\perp}'}^{(n ) } = \\left ( i - \\epsilon \\triangle t \\nabla_{\\perp}^2 \\right)^{-1 } \\left ( { \\bf v_{1\\perp}'}^{(n-1 ) } + \\triangle t \\left ( - i \\alpha u_0^{(n-1 ) } { \\bf v_{1\\perp}'}^{(n-1 ) } - \\nabla_{\\perp } p_1'^{(n-1 ) } \\right ) \\right).\\end{aligned}\\ ] ]    continuation is carried out on the vector @xmath231 but the different balance between the mean equations ( [ shearred1 ] ) , ( [ shearred2 ] ) and the fluctuation equations ( [ shearred3 ] ) , ( [ shearred4 ] ) implies that different preconditioners , hence different @xmath76 for each set of equations , were required .",
    "note that the use of different @xmath76 for different equations of the same system is mathematically correct for as long as it is solved for steady - states .",
    "we introduce @xmath232 which is used in the preconditioning of equations ( [ shearred1 ] ) , ( [ shearred2 ] ) , and @xmath233 which plays a similar role for equations ( [ shearred3 ] ) , ( [ shearred4 ] ) but stress out once again that continuation is done on the whole solution vector at once .      the trivial solution of plane waleffe flow @xmath234 is linearly stable for all values of the reynolds number but does not prevent other nonlinear solutions to exist .",
    "these solutions are formed at saddle - node bifurcations at finite @xmath69 and take the form of upper and lower branches , the former being energetically farther from the trivial solution than the latter .",
    "we focus here on the most basic of these solutions obtained for a domain size of @xmath235 ( implying here @xmath236 ) , @xmath225 and @xmath226 .",
    "the bifurcation diagram is shown in figure [ shearbif ] .    :",
    "@xmath237 versus the reynolds number @xmath69 .",
    "the quantity @xmath237 is defined as follows : @xmath238 with @xmath239 and @xmath240 \\times [ 0;l_z]$ ] represents the domain of integration .",
    "the trivial solution of plane waleffe flow has @xmath241 ( not shown ) . the lower ( resp .",
    "upper ) branch solution is labeled @xmath242 ( resp .",
    "@xmath243).,scaledwidth=50.0% ]    the solution is formed at a saddle - node at @xmath244 and splits into a lower branch state , shown in figure [ initsol ] and an upper branch state , shown in figure [ shearupper ] , both for @xmath245 .     in figure [ shearbif ] taken at @xmath245",
    "it is represented through equidistributed streamfunction @xmath207 contours ( with increments of @xmath246 ) ( a ) and fluctuation amplitude @xmath247 contours ( with increments of @xmath248 ) ( b ) in the @xmath249-plane .",
    "positive ( negative ) quantities are represented in red ( blue ) and are plotted on top of the equidistributed contours of streamwise - invariant streamwise velocity @xmath206 ( with increments of @xmath250 ) in black , with the thick solid black line representing the critical layer where @xmath251 . ]     but for a solution taken along the upper branch @xmath243 at @xmath245 .",
    "the contours are equidistributed with increments of @xmath57 for the streamfunction ( a ) and @xmath252 for the fluctuation amplitude ( b ) . ]    as the reynolds number is increased along these branches , the pattern remains similar but the fluctuations become sharper .",
    "the continuation code from @xcite is modified to output relevant data for algorithmic comparison but no changes to the computational part of the code is made .",
    "in particular , the algorithmic constants are kept the same : the tolerance for the bcgstab iterations is @xmath145 with a maximum number of iteration of @xmath253 before failure is declared and the convergence of the newton method is considered reached when @xmath254 where @xmath255 is defined below . due to the fundamental differences between the mean equations ( [ shearred1 ] ) , ( [ shearred2 ] ) and the fluctuation equations ( [ shearred3 ] ) , ( [ shearred4 ] ) , different preconditioners are needed for each set .",
    "we thus set @xmath232 and @xmath233 the respective preconditioning parameters associated to the mean and fluctuation equations .",
    "the preconditioning method then writes : @xmath256,\\\\ \\label{shearprec2 } & \\omega_1^{(n ) } - \\omega_1^{(n-1 ) } = \\epsilon \\ , \\triangle t_1 \\ , ( i - \\epsilon \\ , \\triangle t_1 \\",
    ", l_{12})^{-1 } \\dots \\hspace{4 cm } \\nonumber\\\\ & \\hspace{4 cm } \\left[l_{12 } \\omega_1^{(n-1 ) } + n_{12 } \\left(\\omega_1^{(n-1)},\\phi_1^{(n-1)},{\\bf v_{1\\perp}'}^{(n-1)}\\right)\\right],\\\\ \\label{shearprec3 } & { \\bf v_{1\\perp}'}^{(n ) } - { \\bf v_{1\\perp}'}^{(n-1 ) } = \\triangle t_2 ( i - \\epsilon \\ , \\triangle t_2 \\ , l_2)^{-1 } \\dots\\hspace{4cm}\\nonumber\\\\ & \\hspace{4 cm } \\left[\\epsilon \\ , l_2 { \\bf v_{1\\perp}'}^{(n-1 ) } + n_2 \\left({\\bf v_{1\\perp}'}^{(n-1)},u_0^{(n-1)},p_1'^{(n-1)}\\right)\\right],\\end{aligned}\\ ] ] for which @xmath257 and for which @xmath258 and @xmath259 have already been evaluated in a preliminary step : @xmath260 the convergence criterion @xmath255 is obtained on the @xmath150-norm of the right hand side of equations ( [ shearprec1])([shearprec3 ] ) multiplied by @xmath261 where @xmath262 for equations ( [ shearprec1 ] ) , ( [ shearprec2 ] ) and @xmath263 for equation ( [ shearprec3 ] ) .",
    "we assume that the mean equations ( [ shearred1 ] ) , ( [ shearred2 ] ) are of the same time as the doubly diffusive convection equations : their diffusion term is comparable in amplitude to the advective term .",
    "we therefore assume that a good preconditioner for them is the mixed one and set @xmath264 , such that the term @xmath265 , with @xmath266 in equations ( [ shearprec1 ] ) , ( [ shearprec2 ] ) becomes @xmath267 .",
    "to investigate the optimal preconditioner , we set up a number of simulations consisting in computing one continuation step with @xmath268 .",
    "these simulations are carried out for a range of @xmath233 with all other parameters unmodified .",
    "the number of gradient iterations needed to converge is then recorded and reported in figure [ wallylowerbranch1 ] for some representative simulations .     of gradient iterations needed to converge to a solution along the lower branch state ( see figure [ initsol ] ) for @xmath269 as a function of @xmath233 with @xmath268 .",
    "( b ) subset of ( a ) for @xmath270 ( thick line ) , @xmath271 ( thin line ) and @xmath272 ( dashed line ) .",
    "( c ) subset of ( a ) for @xmath272 ( thick line ) , @xmath273 ( thin line ) and @xmath274 ( dashed line ) .",
    "( d ) subset of ( a ) for @xmath274 ( thick line ) , @xmath275 ( thin line ) and @xmath276 ( dashed line ) . ]    as for the doubly diffusive problem , we observe that the algorithm fails at converging for small values of @xmath233 .",
    "this result is , in a sense , surprising : the fluctuation equations ( [ shearred3 ] ) , ( [ shearred4 ] ) are weakly diffusive but still need preconditioning . for large @xmath233 , the method also fails , unlike for doubly diffusive convection .",
    "more precisely , no simulation converged for @xmath277 and only a few successful events have been recorded for @xmath278 and @xmath270 .",
    "stokes preconditioning is hence not applicable here , as expected from the nature of the equations .",
    "for relatively low values of @xmath69 , the continuation is rather permissive and a wide range of @xmath233 is allowed . increasing the reynolds number has several effects on the continuation results .",
    "first , the curves in figure [ wallylowerbranch1 ] move sensitively upwards , indicating that even for the optimal @xmath233 , continuation requires more iterations from the conjugate gradient .",
    "the boundaries between which the continuation method works also change dramatically .",
    "the upper bound is @xmath279 at @xmath270 and decreases abruptly until @xmath280 at @xmath273 before continuing to decrease , although less strongly .",
    "the lower bound displays more irregularities , with values around @xmath281 for @xmath270 and @xmath272 .",
    "nonetheless , a trend is clearly observed from figure [ wallylowerbranch1](a)(d ) : the lower bound increases slowly until @xmath282 for @xmath283 . as a result of the trend of both boundaries , the @xmath233 interval for which the continuation method works becomes narrower as @xmath69 increases .",
    "these tendencies are confirmed in figure [ figmarginslower ] .    ,",
    "@xmath69 ) plane .",
    "the outer lines indicate the working interval within which continuation works .",
    "the shaded region indicates the efficiency interval where continuation takes less than 200@xmath284 of the number of gradient iterations needed at the optimal @xmath233 for the same value of @xmath69.,scaledwidth=50.0% ]    in addition to the parameter interval in which the continuation method works , it is important to know where it is efficient .",
    "indeed , a factor of @xmath285 can be observed between results at the optimum @xmath233 and those on the edge of the working interval ( see figure [ wallylowerbranch1 ] ) .",
    "figure [ figmarginslower ] reports the interval in which continuation is at least half as efficient as for the optimal @xmath233 .",
    "this interval is calculated at each @xmath69 in the following way : the optimal parameter @xmath286 for which the lowest number of gradient iterations is needed @xmath287 is recorded and the interval is defined as the closest intersections from @xmath286 between the @xmath288 curve and @xmath289 . despite the fact that the working interval shrinks as @xmath69 increases , the efficiency interval appears steady and spans approximately @xmath290 .",
    "note that the working interval shrinks principally from above with the reynolds number due to the solution losing progressively its dissipative character .",
    "the above observations are compared to results along the upper branch at representative values of the reynolds number in figure [ figupper ] .    ) and the upper branch solution ( thick line ) .",
    "results are shown for @xmath291 ( a ) , @xmath272 ( b ) and @xmath273 ( c ) . ]",
    "the continuation along the upper branch is substantially more complicated than along the lower branch . for @xmath291 and @xmath292",
    ", one can see that for an optimal preconditioner at @xmath286 , the upper branch is slightly more computationally demanding that the lower branch , however , away from the optimum , the upper branch solution is much harder to compute .",
    "in addition to the number of gradient iterations @xmath161 that increases more abruptly for the upper branch away from @xmath287 , figure [ figupper ] also indicates that the working interval of the preconditioner is narrower for the upper branch than for the lower branch .",
    "these observations are confirmed and enhanced as the reynolds number increases , as shown for @xmath273 in figure [ figupper](c ) .",
    "in this paper , i have presented a preconditioner for numerical continuation of viscous incompressible stationary flows based on the stokes preconditioner @xcite .",
    "this preconditioner is easily constructed based on a time - stepper and has one parameter , @xmath76 , corresponding to the time - step of the time - stepper . in the small @xmath76 case ,",
    "the preconditioner is weak and the limit @xmath293 corresponds to no preconditioning .",
    "the case of large @xmath76 leads to stokes preconditioning where the preconditioner approximates a laplacian . in the intermediate case ,",
    "the preconditioner takes the form : @xmath294 , where @xmath126 is the identity , @xmath76 the parameter and @xmath242 the linear ( laplacian ) operator .",
    "the preconditioner is applied to two cases : three - dimensional doubly diffusive convection and a reduced model of shear flow . in both cases",
    ", it is shown that the optimum preconditioner is mixed .    in the problem of doubly diffusive convection ,",
    "the use of a preconditioner was necessary to carry out continuation successfully .",
    "the stokes preconditioner provides a good solution as it allows for continuation at a relatively constant and predictable speed but it is possible to improve it by using a mixed preconditioner . the number of gradient iterations is then reduced by up to @xmath295 on the lower segment case ( @xmath296 on average versus @xmath185 for stokes preconditioning ) .",
    "the reduced model of shear flow is more complex to deal with .",
    "the set of equations comprising the reduced model is treated ( simultaneously ) using two different preconditioners .",
    "a first subset of the model is highly diffusive and the mixed preconditioner @xmath297 has been successfully used .",
    "the other subset requires preconditioning but unlike doubly diffusive convection , stokes preconditioning does not work owing to the fact that the solutions studied are only weakly diffusive .",
    "the optimum preconditioner is not only sensitive to the solution but also to the parameter @xmath69 : @xmath298 with @xmath299 .",
    "there exists only few numerical continuation methods in fluid systems @xcite and the method presented here possesses some assets .",
    "it is easy to implement as it is based on a first order impicit euler time - scheme and it is adaptive through fine - tuning of the parameter @xmath76 .",
    "when searching for stationary solutions , the system of equations can be split into several sub - systems , each of which can then be treated with a different @xmath76 and parameter - dependent preconditioning is also easily implementable and proved efficient in one test case studied here .",
    "this author is grateful to l. s. tuckerman for discussions and encouragements and thanks a. bergeon for providing some of the routines used .                                                                                                        , _",
    "steady - state solving via stokes preconditioning ; recursion relations for elliptic operators _ , in 11th international conference on numerical methods in fluid dynamics , d.l .",
    "dwoyer , m.y .",
    "hussaini , and r.g .",
    "voigt , eds .",
    "323 of lecture notes in physics , springer berlin heidelberg , 1989 , pp ."
  ],
  "abstract_text": [
    "<S> this paper describes an adaptive preconditioner for numerical continuation of incompressible navier  stokes flows . </S>",
    "<S> the preconditioner maps the identity ( no preconditioner ) to the stokes preconditioner ( preconditioning by laplacian ) through a continuous parameter and is built on a first order euler time - discretization scheme . </S>",
    "<S> the preconditioner is tested onto two fluid configurations : three - dimensional doubly diffusive convection and a reduced model of shear flows . in the former case , </S>",
    "<S> stokes preconditioning works but a mixed preconditioner is preferred . in the latter case , </S>",
    "<S> the system of equation is split and solved simultaneously using two different preconditioners , one of which is parameter dependent . due to the nature of these applications , </S>",
    "<S> this preconditioner is expected to help a wide range of studies .    </S>",
    "<S> keywords    ams numbers </S>"
  ]
}