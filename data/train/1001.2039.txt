{
  "article_text": [
    "one important application of molecular simulation is the estimation of the landau free energy @xmath1 of a given multi - particle system with respect to an order parameter @xmath2 @xmath3 where @xmath4 , @xmath5 and @xmath6 denote temperature , boltzmann s constant and the probability to observe the system with value @xmath2 for the order parameter , respectively . calculating landau free energies",
    "thus amounts to measuring occurrence probabilities , a task that molecular simulation fails to achieve as soon as relevant portions of the phase space are rarely explored .",
    "so as to restore numerical ergodicity , many simulation techniques have been devised , based on umbrella sampling  @xcite .",
    "the generic idea of this technique consists in resorting to a judicious steering or restraining potential that enhances exploration of regions of phase space that would be poorly sampled otherwise . in its usual implementation , a series of umbrella sampling simulations  @xcite are first performed so as to cover the various regions of interest , and then the collected averages are combined using one of the various reweighing procedures  @xcite related to bennett s acceptance ratio method  @xcite and based on likelihood maximization  @xcite .    in this context , hummer and szabo  @xcite proposed to reconstruct the free energy profiles by applying the histogram reweighing procedure to nonequilibrium simulations  @xcite instead of equilibrium simulations . to achieve this",
    ", they introduce an additional variable @xmath7 and connect it to the relevant order parameter @xmath8 via the potential of umbrella sampling .",
    "then , they mechanically steer the additional variable so as to push the particle system along the direction of the order parameter .",
    "they finally reconstruct the equilibrium properties by means of a two - step procedure .",
    "the first step provides the contribution to equilibrium at a given time - slice in trajectory space ( after the collected nonequilibrium data have been reweighted using the probability ratios of the reverse - to - forward dynamics  @xcite within a path - average  @xcite ) . in a second step , contributions arising from the entire range of times are finally combined using the weighted histogram analysis method  @xcite , as in conventional umbrella sampling .",
    "we herein propose an estimator enabling one to retrieve equilibrium information from nonequilibrium trajectories . like the aforementioned approaches based on bennett s acceptance ratio method ,",
    "our estimator resorts to reverse - to - forward probability ratios and retrieves information included in all time - slices .",
    "the estimator will have two advantages : ( i ) it does not involve any post - processing ; ( ii ) it can be used with more general steering schedules than the one considered by hummer and szabo .",
    "we will illustrate these two points on the reconstruction of free energy landscapes .",
    "concerning point ( ii ) , we will consider langevin dynamics in which steering arises from additional restraining variables evolving stochastically and autonomously out of equilibrium into otherwise unexplored regions of phase space , enabling enhanced sampling along the steering directions .",
    "this way of proceeding can possibly be achieved by coupling the additional variables to high - temperature thermostats  @xcite , as in multi - temperature sampling techniques  @xcite , or by means of an adaptive biasing potential  @xcite .",
    "the former approach has been called temperature - accelerated molecular dynamics ( tamd ) and the latter one metadynamics .",
    "the article is organized as follows .",
    "section  [ nonequilibrium ] establishes the general theoretical framework for the steered dynamics : the particle system and its additional variables are defined in subsection  [ definition ] , the equations of the dynamics themselves are introduced in subsection  [ steered ] , while the reverse - to - forward probability ratios associated with the dynamics , derived in subsection  [ derivation ] , are used to discuss the two steering schedules for the dynamics in subsection  [ autonomous ] . in this framework",
    ", both the autonomous steering schedule of tamd and the usual schedules that let a single steering variable evolve non - autonomously at constant speed  @xcite appear as two particular limiting regimes .",
    "the reverse - to - forward probability ratios of subsection  [ derivation ] are used to construct the two - state estimators  @xcite reviewed in section  [ retrieval ] and developed for calculating free energy differences with non - autonomous steering .",
    "building on the approaches of section  [ retrieval ] , we propose in section  [ multistate ] an extended sampler and estimator enabling free energy reconstruction .",
    "the derivation that is given works both for autonomous and non - autonomous steering schedules . for completeness ,",
    "we eventually show how the residence weight algorithm that is proposed relates to the waste - recycling algorithm  @xcite .",
    "section  [ application1d ] illustrates the performance of the proposed estimator with non - autonomous steering for a one - dimensional reconstruction problem .",
    "we compute the migration free energy of a vacancy in iron ( @xmath0-fe ) .",
    "the second application given in section  [ application2d ] uses autonomous steering and reconstructs a two - dimensional free - energy landscape of the lennard - jones cluster with 38 atoms ( lj@xmath9 ) .",
    "this benchmark system presents a rugged energy landscape , with two energy funnels separated by a high free energy barrier .",
    "it has been extensively studied using various methods , which eventually permits one to assess the relative numerical performance of our method with respect to existing methods .",
    "concluding remarks are finally given in section  [ concluding ] .",
    "denote by @xmath10 the particle position vector of dimension @xmath11 and by @xmath12 an auxiliary vector of dimension @xmath13 .",
    "the potential energy of the particle is @xmath14 , while the steering potential is  @xcite @xmath15 where the order parameter @xmath16 of dimension @xmath13 is represented by a collective variable that is function of the particle positions .",
    "we denote the vector positions and vector momenta in the extended system by @xmath17 and @xmath18 , respectively .",
    "we have @xmath19 .",
    "the @xmath20-th components of these vectors are respectively denoted by @xmath21 and @xmath22 , with @xmath23 .",
    "let @xmath24 be the mass associated to the @xmath20-th component , and denote its momentum by @xmath25 where dots above coordinates designate time derivation . denoting @xmath26 the ( total ) potential energy of the extended system and",
    "@xmath27 its hamiltonian , the normalized canonical probability density at temperature @xmath28 is @xmath29 where the normalizing factor @xmath30 is the helmholtz free energy of the extended system .",
    "it is related to the partition function logarithm @xmath31 .   \\nonumber \\end{aligned}\\ ] ] here , the infinitesimal volume with respect to coordinates reads @xmath32 canonical averages of any quantity @xmath33 defined with respect to particle positions can be taken in the extended ensemble ( @xmath34 denoting its phase space ) as follows @xmath35 { \\rm d}{\\mathbf{r } } } { \\int \\exp\\left[-\\beta e ( { \\mathbf{r } } ) \\right ] { \\rm d}{\\mathbf{r } } } \\label{numedeno}\\\\   & = & \\frac{\\int_\\omega a({\\mathbf{r } } ) \\exp\\left[-\\beta { { \\cal h}}({\\mathbf{p}},{\\mathbf{q } } ) \\right ] { \\rm d}{\\mathbf{p}}{\\rm d}{\\mathbf{q } } } { \\int_\\omega \\exp\\left[-\\beta { { \\cal h}}({\\mathbf{p}},{\\mathbf{q } } ) \\right ] { \\rm d } { \\mathbf{p}}{\\rm d } { \\mathbf{q } } }   \\nonumber   \\\\   & = & \\int_\\omega a({\\mathbf{r}})\\rho({\\mathbf{p}},{\\mathbf{q}}){\\rm d}{\\mathbf{p}}{\\rm d}{\\mathbf{q}}\\label{canonical}\\end{aligned}\\ ] ] because contributions arising from the additional variables @xmath12 can be inserted inside both integrals in eq .",
    "[ numedeno ] .",
    "hence , the additional variables and potentials do not affect the thermodynamic expectations of the particle system .",
    "we consider that any coordinate @xmath21 with @xmath23 is coupled to an independent thermal reservoir at temperature @xmath4 . the traditional langevin dynamics amount to propagating the system by solving the equations of motion ( @xmath36 ) @xmath37 where @xmath38 represents a white noise of amplitude 1 and zero mean , while @xmath39 denotes the friction characterizing the coupling intensity with the @xmath20-th thermal bath . here",
    "the amplitude of the fluctuations @xmath40 determines the temperature @xmath4 .",
    "let us assume that we have prepared the system in thermodynamic equilibrium at time @xmath41 [ e.g. by propagating the langevin dynamics   long enough and then setting the time to zero ] . at @xmath41 , we switch on the external forces @xmath42 to act mechanically upon on the additional variables @xmath43 .",
    "the rescaling factors @xmath44 are such that @xmath45 for @xmath46 .",
    "we also define @xmath47 for @xmath48 by extension and we have @xmath49 .",
    "the frictional forces and the square of the fluctuations acting upon the additional variables are rescaled in the same way using the @xmath44 s .",
    "the extended system is then propagated for a duration @xmath50 using the steered langevin dynamics below ( using the convention on the indices , @xmath51 and @xmath52 ) : @xmath53 the rescaling of the dynamics amounts to unbalancing the interactions between particles and additional variables and to decreasing the coupling intensity with the @xmath54-th thermal bath while maintaining constant its temperature @xmath4 . the effect of the external forces is to make the system depart from thermodynamic equilibrium , by reducing the restraining forces acting upon the additional variables , which enhances exploration of phase space along the variables @xmath12 .",
    "additional commentaries about the dynamics   have been deffered to subsection  [ autonomous ] because they are based on the reverse - to - forward probability ratio derived in section  [ derivation ] .",
    "this ratio will indeed quantify the deviation of the dynamics with respect to equilibrium and will enable one to construct the estimators of sections  [ retrieval ] and  [ multistate ] .      the probability to generate the dynamics along a path @xmath55_{0 \\leq t \\leq \\tau}$ ] given that the system is at @xmath56 at time @xmath41 is denoted @xmath57 , while the probability to generate the same path using the reverse dynamics starting from system @xmath58 at time @xmath59 down to @xmath41 is denoted @xmath60 .",
    "then , the reverse - to - forward probability ratio and the work @xmath61 done by the external forces @xmath62 upon the extended system are related by the following expression ( eq . 2 in  @xcite ) @xmath63 \\label{bd1}. \\end{aligned}\\ ] ]    the identity above and the expression of the work will be derived explicitly for the discretized langevin dynamics in this subsection . before , we point out that identity   is similar to the more well - known identity involving the reverse - to - forward probability ratio due to crooks  @xcite , except that a difference of free energy between a target system and a reference system appears in the latter form .",
    "no free energy difference appears here because the target and reference systems are the extended system itself with the extended hamiltonian .",
    "the thermodynamic implications involving the two mentioned identities are compared in ref .",
    "@xcite . besides , from a mathematical perspective , eq .",
    "[ bd1 ] can be interpreted as a generalized detailed balance equation involving the forward and backward kolmogorov operators associated to our langevin dynamics ( see eq . 4.43 in ref .",
    "this interpretation allows both to define time reversibility rigorously and to extend the original derivations  @xcite , which considered discrete - time markov processes , to general continuous - time langevin dynamics such as the one considered here .    since in practical applications we have to discretize the dynamics ,",
    "we are authorized to expand the reverse and forward conditional probabilities , so as to include these quantities in the estimators directly .",
    "this is the approach that we follow in the sequel .",
    "let @xmath64 denote the discretization time step and @xmath65 denote a state @xmath66 at time @xmath67 .",
    "the discretized trajectory of a path @xmath68 is characterized by the successive states @xmath69 obtained at times @xmath70 by propagating the langevin dynamics _",
    "forward _ starting from a given state @xmath71 .",
    "this is achieved by updating the following discretization scheme  @xcite from time @xmath72 to time @xmath73 ( @xmath74 )    @xmath75    where index @xmath76 denotes time @xmath77 while @xmath78 and @xmath79 ( @xmath80 if @xmath81 ) .",
    "besides , the noises @xmath82 in eqn .   and   are normal and have mean zero and variance @xmath83 . updates   and   correspond to the momentum variations due to two consecutive ornstein - uhlenbeck processes of duration @xmath84 .",
    "these processes consist of propagating the momentum @xmath22 using @xmath85 from @xmath86 to @xmath87 and from @xmath88 to @xmath89 , where @xmath90 is an uncorrelated white noise of unit amplitude .",
    "because the scheme corresponds to a double strang - trotter decomposition  @xcite with the position update in the center and then half momentum updates with respect to the force and the stochastic processes , it is symmetric and can thus be updated or downdated depending on whether the dynamics is considered to be forward or reverse . for the reverse dynamics , we must iterate    @xmath91    where the reverse noises @xmath92 have the same variance . besides , the time reversal of the ornstein - uhlenbeck process in   and   is the process itself .",
    "we then denote the probabilities of the discretized dynamics by @xmath93 and @xmath94 .",
    "they will approximate the quantities @xmath60 and @xmath57 in  . as a result of the discretization",
    ", the forward path probability can be factorized into the following product @xmath95 \\right\\rbrace . \\end{aligned}\\ ] ] where @xmath96 stands for the normal probability of variance @xmath97 and @xmath98 denotes its normalizing factor .",
    "the normal laws @xmath96 are used to generate the stochastic noises @xmath99 and @xmath100 of the @xmath20-th thermostat along trajectory @xmath68 ( @xmath101 ) . the conditional probability to generate @xmath68 backward can be decomposed into a similar product of normal probabilities @xmath102 \\right\\rbrace . \\end{aligned}\\ ] ]    let @xmath103 denote the temperature - scaled logarithm of the reverse - to - forward probability ratio associated with the ornstein - uhlenbeck processes for the @xmath20-th thermostat at step @xmath76 .",
    "we have @xmath104 - \\ln \\left [ { \\phi}_{\\sigma_i}(\\eta^+_{i , k+1/{4 } } ) { \\phi}_{\\sigma_i}(\\eta^+_{i , k+3/{4 } } ) \\right ] \\right\\rbrace   \\label{chaleur1 } \\\\ & = & \\frac{(2m_i)^{-1}}{1-e^{-\\tilde{\\gamma}_i \\delta t } }   \\left\\lbrace \\left [ ( \\eta^+_{i , k+1/{4}})^2 + ( \\eta^+_{i , k+3/{4}})^2 \\right ] -\\left [ ( \\eta^-_{i , k+1/{4}})^2 + ( \\eta^-_{i , k+3/{4}})^2 \\right ] \\right \\rbrace \\label{chaleur2 } \\\\   & = & \\frac{1}{2m_i }   \\left\\lbrace p^2_{i , k+1 } - p^2_{i , k+3/{4 } } +   p^2_{i , k+1/{4 } } -p^2_{i , k } \\right\\rbrace \\label{chaleur3 } \\\\   & = & \\frac{1}{2m_i } \\left [ p^2_{i , k+1}-p^2_{i , k }   \\right ] + \\frac{\\delta t^2}{8m_i } \\left [ \\tilde{f}^2_{i , k+1}-\\tilde{f}^2_{i , k }   \\right ] -\\frac{1}{2 } ( q_{i , k+1}-q_{i , k})\\cdot(\\tilde{f}_{i , k+1}+\\tilde{f}_{i , k } ) \\label{chaleur4}. \\end{aligned}\\ ] ] the transformation from   to   involves expressing the noises as a function of the momenta after and before the ornstein - uhlenbeck processes and yields a form of detailed balance . in the transformation from   to",
    ", the intermediate momenta @xmath105 and @xmath106 have been expressed as a function of the forces and positions at integer steps .",
    "the effective work done along the path from @xmath107 to @xmath108 defined by  @xcite @xmath109 \\nonumber \\\\     & = & { { \\cal h}}(\\chi_n)-{{\\cal h}}(\\chi_{0 } ) - \\sum_{i=1}^{3i+j}\\sum_{k=0}^{n-1 } q_{i , k }   \\label{effectivework2}.   \\end{aligned}\\ ] ] can be evaluated from the knowledge of the trajectory via the @xmath103 s .",
    "the effective works will be used to retrieve equilibrium information in section  [ multistate ] . nevertheless , from a thermodynamical point of view , it is instructive to formulate the work @xmath110 in the continuum limit , achieved here when @xmath111 goes to infinity and with @xmath112 .",
    "we thus define @xmath113 as @xmath114 with @xmath112 and all states @xmath115 inside the continuous path @xmath68 when defining the limit . from the relation  @xcite",
    "@xmath116 + \\frac{\\delta t^2}{8m_i } \\left [ \\tilde{f}^2_{i , n}-\\tilde{f}^2_{i,0 }   \\right ] -\\frac{1}{2 } \\sum_{k=0}^{n-1 } ( q_{i , k+1}-q_{i , k})\\cdot(\\tilde{f}_{i , k+1}+\\tilde{f}_{i , k } ) \\nonumber ,    \\end{aligned}\\ ] ] we deduce @xmath117 - \\int_0^\\tau \\frac{{{\\rm d}}q_i}{{{\\rm d}}t } \\mu_i f_i { \\rm d}t \\label{travail } ,   \\end{aligned}\\ ] ] recalling that @xmath118 . neglecting the constant ito term arising from the integration of @xmath119 , the quantity @xmath113 can be interpreted as the work done along the trajectory @xmath68 by the force @xmath120 that is exerted by the @xmath20-th thermostat upon the @xmath20-th coordinate ( @xmath121 ) .",
    "this quantity thus represents the heat exchanged with the @xmath20-th thermostat .",
    "we recover an additional result in the continuum limit : the total heat exchanged with the thermostats during the forward dynamics , defined by @xmath122 relates to the ratio of the reverse - to - forward conditional probability via the well - known expression  @xcite @xmath123 . \\label{heat}\\end{aligned}\\ ] ] the heat also relates to the quantity @xmath110 defined in   via a conservation equation  , obtained by inserting   into   and then resorting to the relations @xmath124 $ ] both at @xmath41 and @xmath59 .",
    "we have @xmath125 besides , resorting to @xmath126 in eq .",
    "[ travail ] and then summing yields an additional relation for the total heat exchanged with the thermostats @xmath127 + \\int_{0}^{\\tau } \\left[\\nabla_{{\\mathbf{q}}}{{{\\cal h } } }   \\cdot \\frac{{{\\rm d}}{\\mathbf{q}}}{{{\\rm d}}t } -\\sum_{i=1}^{3i+j } ( 1-\\mu_i ) \\partial_{q_i } { \\cal h}\\frac{{{\\rm d}}q_i}{{{\\rm d}}t } \\right ] { { \\rm d}}t \\nonumber \\\\ & = & \\left\\lbrace { { { \\cal h}}}\\left[{\\mathbf{p}}(\\tau),{\\mathbf{q}}(\\tau)\\right]-{{\\cal h}}\\left [ { \\mathbf{p}}(0),{\\mathbf{q}}(0)\\right ] \\right\\rbrace-\\sum_{i=3i+1}^{3i+j } \\int_{q_i(0)}^{q_i(\\tau ) } ( 1-\\mu_i ) \\partial_{q_i } { { \\cal h}}{\\rm d }   q_i(t ) .",
    "~\\label{nonconservation } \\end{aligned}\\ ] ] note that the last summation runs from @xmath128 since @xmath80 for @xmath129 .",
    "then , substracting  [ conservation ] to  [ nonconservation ] enables one to identify @xmath61 explicitly @xmath130 this quantity indeed corresponds to the work done by the external forces @xmath131 upon the extended system , as stated in  @xcite .    the limiting case consisting of setting @xmath132 for all @xmath133 cancels the work in eq .",
    "[ work ] [ @xmath134 .",
    "this in turn implies a specific form of detailed balance @xmath135\\varrho_r(z)=\\rho\\left[\\chi(0)\\right]\\varrho_f(z)$ ] ensuring that the dynamics sample the equilibrium distribution @xmath136 $ ] . aside from this limiting case , two particular schedules are possible for the steered dynamics depending on the @xmath44-values in eq .",
    "[ work ] , which we discuss below .",
    "a first steering regime appears when the values of the scaling factors @xmath44 s are set to zero for all @xmath133 .",
    "the noise amplitude and the friction @xmath137 vanish ( see eq .",
    "any coordinate @xmath43 then evolves at a constant imposed velocity as in the schedule established by hummer and szabo  @xcite .",
    "the forces are conservative and time - dependent with respect to the real particles ( once the additional variables have been eliminated by solving for them ) .",
    "the dynamics is said to be non - autonomous  @xcite and we refer to this regime as non - autonomous steering .",
    "non - autonomous dynamics with @xmath138 guided by ( time - dependent ) conservative forces are well suited for computing free - energy profiles in one dimension or differences of free energy .",
    "note that the fast switching schedule introduced by jarzynski  @xcite amounts to non - autonomous scheduling with a single external parameter @xmath139 and @xmath140 in eq .",
    "furthermore , the integral form in eq .",
    "[ work ] with @xmath138 corresponds to jarzynski s definition of the work provided we consider the additional variable as a coupling parameter acting upon the hamiltonian of the particle subsystem .",
    "the second steering regime consists of choosing @xmath141 for @xmath133 . in this regime ,",
    "the extended langevin dynamics of section  [ steered ] is autonomous : the additional variables evolve stochastically by means of a force field @xmath142 that is time - independent and non - conservative  @xcite , i.e. that does not derive from a potential function except for particular conditions on the forces and the @xmath44 s .",
    "we refer to this regime as autonomous steering . as will be shown in section  [ application2d ] , autonomous steering is well adapted to the use of more than one additional variable .    in the second regime ,",
    "the dynamics of the additional variables may be given to a different thermodynamic interpretation .",
    "indeed , the additional variables   also evolve according to the equation ( @xmath143 , @xmath133 ) @xmath144 where @xmath145 denotes the effective temperature of the thermostat that is actually coupled to @xmath43 and @xmath146 denotes an effective mass for the additional variable .",
    "this dynamics is a particular implementation of the general dynamics given in  ( * ? ? ?",
    "dynamics coupled to thermostats at different temperatures reach a nonequilibrium steady - state with no well - defined temperature and satisfy a generalized detailed balance equation  @xcite .",
    "fluctuation theorems as well as reverse - to - forward probability ratios considered with respect to multi - temperature dynamics then relate to the heat transfers between the system and the various thermostats around the nonequilibrium steady state  @xcite .",
    "the rescaling of the forces in the dynamics ( subsection  [ steered ] ) actually ensures that the reverse - to - forward path probability ratios relate to a transient mechanical work rigorously defined with respect to the equilibrium distribution of interest , as in the steering protocol of hummer - szabo .",
    "in particular , the work   depends on the potential energy of the extended hamiltonian and not on its kinetic energy .",
    "note that the stationary distribution reached by a multi - temperature dynamics exhibits a known analytical form  @xcite when a separation of frequencies occurs between a slow variable @xmath43 subject to a thermostat at high temperature @xmath147 and the remaining fast variables at normal temperature @xmath4 . from this analytical form , the equilibrium probability profile @xmath148 of @xmath43 at temperature @xmath4 can be extracted from the established relation @xmath149^{t_j / t}$ ] where @xmath150 is the stationary probability profile measured during a simulation .",
    "no separation of frequencies needs to be imposed in the approach of the present paper where the rescaling factor @xmath151 acts upon the dynamics directly  .    in order to retrieve equilibrium information from transient nonequilibrium dynamics",
    ", jarzynski derived its remarkable identity that involves the exponential average of the work ( refer to  @xcite for original and review papers on fluctuation theorems ) .",
    "we now briefly review the computational extensions that have been made to this approach for non - autonomous steering with a single additional variable .",
    "we assume here that trajectories are generated using a single steering variable @xmath152 and with non - autonomous scheduling ( @xmath140 ) .",
    "the phase space of non - autonomous paths is defined as follows @xmath153    a simple estimator associated to a biased sampler can give access to the ratio of normalizing constants related to the two thermodynamic states defined by @xmath154 and @xmath155  @xcite .",
    "this ratio can indeed be cast in the following form @xmath156 \\rho(\\chi){{\\rm d}}\\chi}{\\int \\delta [ q_{3i+1}-\\lambda_0 ] \\rho(\\chi){{\\rm d}}\\chi } & = & \\frac{\\int_{\\omega_{\\rm na } } { \\rm p}_{\\rm cond}(z |\\chi_n , n)\\rho(\\chi_n ) { \\cal d } z}{\\int_{\\omega_{\\rm na}}{\\rm p}_{\\rm cond } ( z|\\chi_0,0)\\rho(\\chi_0 ) { \\cal d } z } \\label{transformation1}\\\\ & = & \\frac{\\int_{\\omega_{\\rm na } } \\left [ { { \\rm p}_{\\rm cond}(z|\\chi_n , n)\\rho(\\chi_n ) } / { { \\rm p_b}^\\varphi(z ) } \\right ] { \\rm p_b}^\\varphi(z ) { \\cal d } z }   { \\int_{\\omega_{\\rm na } } \\left[{{\\rm p}_{\\rm cond}(z|\\chi_0,0)\\rho(\\chi_0 ) } /{{\\rm",
    "p_b}^\\varphi(z ) } \\right]{\\rm p}_{\\rm",
    "b}^\\varphi(z ) { \\cal d}z } \\label{pathave}. \\end{aligned}\\ ] ] the first transformation   merely exploits the normalization of conditional probabilities with respect to path space @xmath157 .",
    "the second transformation   formally inserts the biased probability distribution @xmath158 with respect to which sampling is performed ( note that jarzynski s identity is recovered by replacing @xmath159 with @xmath160 where @xmath161 is the equilibrium density conditioned on @xmath162 ) . in applications",
    "@xcite of identity  , the biasing potential @xmath163 is a function of the work function @xmath164",
    "/ \\left [ { \\rm p}(z|\\chi_0,0)\\rho(\\chi_0 ) \\right ] \\right\\}$ ] . in practice ,",
    "the residence weight algorithm  @xcite was observed to achieve good performance  @xcite ( see appendix  [ workbiased ] ) .",
    "the purpose of the paper is to extend the residence weight algorithm so that its sampler and associated estimator can handle the multiple thermodynamic states that can be defined owing to the extended system , irrespective of whether the scheduling of the steered dynamics is non - autonomous or autonomous .",
    "residence weight algorithms can be formulated from two opposite points of view  @xcite . here ,",
    "we first build both the sampler and the estimator of the algorithm upon bayes theorem by adopting the viewpoint of statistical inference .",
    "then , we reinterpret the estimator as a conditional expectation ( second viewpoint ) in order to show the connection with the waste - recycling algorithm .      here , a marginal probability will be the importance function with respect to which path sampling is achieved , while a posterior likelihood function will be used on - the - fly to infer the equilibrium contribution of each generated state within the estimator .",
    "the marginal probability is defined in the path ensemble as the _ a priori _ probability of witnessing a path @xmath68 under all possible hypotheses , i.e. as the sum of the product of all probabilities of hypotheses @xmath158 and corresponding conditional probabilities @xmath165 : @xmath166 an hypothesis @xmath167 is the knowledge of a state belonging to the path and of its index .",
    "the conditional probabilities in eq .",
    "[ marginal ] are given by  @xcite @xmath168 where the normal distribution @xmath96 are detailed in subsection  [ derivation ] . here , @xmath169 is the probability to generate the states @xmath170 starting from any @xmath171 by updating eqn .",
    "[ forward0]-[forward4 ] and then to generate the states @xmath172 starting from @xmath171 by downdating eqn .",
    "[ reverse4]-[reverse0 ] .",
    "the two particular cases @xmath173 and @xmath174 were considered previously in biased path sampling schemes  @xcite to denote the probability to generate the forward and reverse trajectories , respectively .    additionally , the prior probability of hypothesis @xmath175 in eq .  [ marginal ] is @xmath176 for non - autonomous scheduling , @xmath177 denotes the prior probability of index @xmath178 and is such that @xmath179 if @xmath180 pertains to the sliced phase space @xmath181 that corresponds to index @xmath178 , otherwise @xmath182 .",
    "whatever @xmath180 , we also assume that @xmath183 for @xmath184 and @xmath185 : the steering amplitude captures once all important regions of phase space . with autonomous scheduling , @xmath177 reduces to @xmath186 whatever @xmath180 , involving the independence of the slice index from @xmath180 . besides , @xmath187 denotes a biased prior distribution of states @xmath188\\ ] ] where the biasing potential @xmath189 is here a state function ( rather than a work function as in previous implementations ) and the normalizing constant @xmath190 is the @xmath163-dependent free energy .",
    "irrespective of the scheduling , we have the useful equality @xmath191 where @xmath34 denotes the unrestricted phase space ( we previously assumed @xmath192 for non - autonomous scheduling )",
    ". this equality will enable us to express the biased density @xmath187 as a path integral of marginal and posterior probabilities , irrespective of whether the scheduling is _ autonomous _ or _ non - autonomous_. for this purpose , we introduce @xmath193 to denote the subspace of all paths going through @xmath65 ( at slice index @xmath178 ) and exploit the property that the sum over the path probabilities conditioned on @xmath65 is normalized to one in @xmath193 @xmath194   \\delta(\\chi-\\chi_n ) { \\rm p}^\\varphi(\\chi_{n},n ) { \\rm d } \\chi_n \\nonumber \\\\ & = & \\sum_{n=0}^n \\int_\\omega \\delta(\\chi-\\chi_n ) { \\rm p}_{\\rm cond}(z|\\chi_n , n ) { \\rm p}^\\varphi(\\chi_n , n ) { \\cal d}z \\label{sumdirac } \\\\   & = & \\int_\\omega \\left [ \\sum_{n=0}^n \\delta(\\chi-\\chi_n ) { \\rm p}_{\\rm sel}(\\chi_{n},n|z ) \\right ] { \\rm p}^\\varphi_{\\rm m}(z ) { \\cal d}z   \\label{sumdirac2}\\end{aligned}\\ ] ] where @xmath195   { \\rm d}\\chi_n$ ] simplifies to @xmath196 in eq .  [ sumdirac ] , with integration running over the space of either autonomous or non - autonomous paths ( @xmath197 or @xmath157 ) .",
    "after permuting summation and integration in eq .",
    "[ sumdirac ] , we introduced in eq .",
    "[ sumdirac2 ] the posterior likelihood @xmath198 by resorting to bayes relation @xmath199 the posterior probabilities can be evaluated and simulated like the conditional probabilities . indeed , plugging the various reverse - to - forward probability ratios given by @xmath200 \\label{pselect } \\label{posterior}\\end{aligned}\\ ] ] into  ,",
    "yields the evaluable ratio @xmath201}{\\sum_{k=0}^n\\exp\\left[\\varphi_0-\\varphi_k - \\beta w_k \\right ] } \\label{pseleval}\\end{aligned}\\ ] ] where @xmath202 is given in   and @xmath203 stands for @xmath204 for simplifying .",
    "the aforementioned feature of the posterior and conditional probabilities makes it possible to generate a path distribution according to the marginal probability @xmath205 . to explain how this can be done ,",
    "let us consider a monte carlo move from @xmath65 to @xmath206 and whose associated transition probability @xmath207 obeys a detailed balance with respect to @xmath158 given by   @xmath208 then , considering a path @xmath209 containing @xmath210 and plugging bayes relation   into   for paths @xmath68 and @xmath209 implies the detailed balance condition @xmath211 in which @xmath212 and @xmath213 have to be read as the probabilities to transit from path @xmath68 to @xmath209 and from @xmath209 to @xmath68 , respectively .",
    "the path distribution generated by any sampler satisfying the detailed balance condition  [ webdb ] is ensured to converge toward the probability distribution @xmath214 .",
    "still , the canonical average   of quantity @xmath33 must be extended in order to be evaluable from a sample of paths distributed according to @xmath214 .",
    "to achieve this task , we first write the canonical average with respect to the biased probability measure . from the relation",
    "@xmath215 , \\nonumber\\ ] ] we obtain @xmath216 { \\bigg/ }   \\left [ \\int_\\omega \\frac{\\rho(\\chi)}{\\rho^\\varphi(\\chi)}\\rho^\\varphi(\\chi ) { \\rm d}\\chi \\right ]   \\nonumber \\\\   & = & \\left [ \\int_\\omega a({\\mathbf{r } } ) { \\rm e}^{\\varphi(\\chi ) } \\rho^\\varphi(\\chi ) { \\rm   d}\\chi \\right ] \\bigg/\\left [ \\int_\\omega { \\rm e}^{\\varphi(\\chi ) } \\rho^\\varphi(\\chi )   { \\rm d}\\chi \\right ] \\label{biasaverage}. \\end{aligned}\\ ] ] then , the path - integral expression of @xmath187 ( eq .  [ sumdirac2 ] ) is inserted into the biased average ( eq .",
    "[ biasaverage ] ) and the dirac functions are evaluated when integrating @xmath180 over @xmath34 , which yields @xmath217 { \\rm p}^\\varphi_{\\rm m}(z ) { \\cal d}z \\bigg ] \\bigg/ \\bigg [ \\int_\\omega \\bigg [ \\left .",
    "\\sum_{n=0}^n \\right.{\\rm e}^{\\varphi(\\chi_n ) } { \\rm p}_{\\rm sel } ( \\chi_n , n|z ) \\bigg ] { \\rm p}^\\varphi_{\\rm m}(z ) { \\cal d}z \\bigg ]   \\label{webaverage}. \\end{aligned}\\ ] ] we are now in the position of evaluating the canonical ensemble average   by following the traditional recipe  @xcite : i ) we construct a markov chain distributed according to the probability density @xmath214 and ii ) resort to the appropriate estimator to correct for the bias introduced by the importance function @xmath214 .",
    "\\(i ) repeat @xmath218 times the following steps :    \\(a ) move to the shooting index @xmath178 and state @xmath65 of current path @xmath68 which have been selected both with posterior likelihood @xmath198 in the previous steps ( d ) and ( e ) ;    \\(b ) generate the new shooting state @xmath206 from @xmath65 from probability @xmath207 ;    \\(c ) set @xmath219 to @xmath220 , initialize the ( provisional ) next shooting index @xmath221 to @xmath178 and store @xmath206 into @xmath222 ;    \\(d ) shoot a new trajectory from state @xmath206 and index @xmath178 ( perform @xmath223 updates from @xmath210 followed by @xmath178 downdates from @xmath210 again ) ; concomitantly , at each langevin iteration @xmath76 , compute @xmath224 $ ] where index @xmath225 runs from @xmath220 to @xmath111 after re indexing using @xmath0 ; with probability @xmath226 , change @xmath221 to @xmath227 and store @xmath228 into @xmath222 , otherwise leave @xmath221 and @xmath222 unchanged ;    \\(e ) set the next shooting index @xmath229 to @xmath221 and store @xmath222 into @xmath230 to denote the selected state of the new completed path @xmath209 ;    \\(f ) go to ( a ) until the chain has been completed .",
    "\\(ii ) evaluate the estimator @xmath231 where @xmath232 denotes the paths of the markov chain constructed using the sampler and the simplified notations @xmath233 , @xmath234 stand for @xmath235 , @xmath236 of path @xmath237 .",
    "@xmath238 represents the work done upon the extended system along the trajectory @xmath237 between @xmath239 and @xmath171 ( i.e. from times @xmath107 to @xmath240 ) via the mechanical coupling .",
    "the reindexing function is @xmath241 some details of the algorithm above such as the move from @xmath65 to @xmath206 in step ( i)-(b ) depends on the specific implementation : we choose @xmath242 in sections  [ application1d ] implying that @xmath65 is left unchanged ; in section  [ application2d ] , @xmath206 is constructed from @xmath65 by drawing new momenta @xmath243 from the maxwell - boltzmann distribution . besides , the estimator   is obtained by plugging   into the usual metropolis estimator @xmath244 related to ensemble average  . additionally , the shooting move  @xcite of step ( i - d ) generates the new path @xmath209 with probability @xmath245 given in eq .",
    "[ shooting ] by construction .",
    "the next shooting state @xmath230 and next shooting index @xmath229 obtained from @xmath222 and @xmath221 are eventually selected with the compound probability ( @xmath246 ) @xmath247 \\right\\ } \\left[1-\\frac{c_{h'-1}}{c_{h ' } } \\right ] \\left\\ { \\prod_{h = h'+1}^{n } \\frac{c_{h-1}}{c_h }   \\right\\ } = \\frac{c_{h'}-c_{h'-1}}{c_n }   \\nonumber\\end{aligned}\\ ] ] where @xmath248 and @xmath249 .",
    "this compound probability is equal to ( @xmath250 ) @xmath251}{\\sum_{k=0}^n\\exp\\left[-\\varphi'_k - \\beta w'_k \\right ] } = { \\rm p_{sel}}(\\chi'_{n'},n'|z ' ) .",
    "\\nonumber\\end{aligned}\\ ] ] as a result , the algorithm satisfies the detailed balance equation  .",
    "note that the decomposition of the selecting procedure in ( c - e ) of ( i ) avoids storing all the configurations when a new path is constructed .      in the residence weight algorithm ,",
    "the shooting index @xmath229 related to path @xmath209 subsequent to @xmath68 is constructed concomitantly with @xmath209 as outlined by steps ( i)-(c ) to ( i)-(e ) of subsection [ rwa ] . as a result",
    ", the algorithm satisfies the following detailed balance condition @xmath252 for moves between @xmath253 and @xmath254 , and also obeys detailed balance equation   for moves between @xmath255 and @xmath253 .",
    "the algorithm thus leaves invariant the prior probability density @xmath158 : the markov chain of states @xmath167 constructed with the rw algorithm is thus distributed according to the probability density @xmath158 .",
    "it follows from this theoretical description that the residence weight algorithm is a particular implementation of the waste recycling algorithm introduced by frenkel  @xcite .",
    "indeed , assuming there is no biasing potential in eq .  [ retrieving ]",
    ", one can subsequently normalize the selection probabilities to one ( @xmath218 times ) and write @xmath256 which corresponds to the waste - recycling estimator given in eq .",
    "2.2 of ref .",
    "our symmetric selection procedure @xmath257 corresponds to a barker acceptance rule ( ( * ? ? ?",
    "* eq . 2.1 ) ) that considers states linked by the trajectories , while the wasted information included in the rejected monte carlo moves is recycled in the estimator of eq .",
    "[ waste - recycling ] .",
    "interestingly , delmas and jourdain  @xcite showed that the estimator can be interpreted as the conditional expectation of @xmath258 with respect to @xmath257 and that it behaves normally asymptotically .",
    "additionally , these authors proved that the statistical variance of the estimator is smaller than the one of the metropolis - hasting estimator when the acceptance rule is symmetric  @xcite , as in the present situation .",
    "the first property implies that the conditional estimator is unbiased whatever the sample size @xmath218 , at variance with maximum - likelihood estimators that are only unbiased in the limit of large samples  @xcite .",
    "the last property involving the variance reduction justifies the present strategy : when possible , one should systematically include the information contained in the states of the paths in statistical path - averages .",
    "we now turn to the applications of our method . in section  [ application1d ] , we implement non - autonomous steering along a one - dimensional order parameter with no biasing potential ( @xmath259 ) and will resort to eq .",
    "[ waste - recycling ] to reconstruct the free energy profile .",
    "then , in section  [ application2d ] , the method will be tested on a more difficult benchmark model involving the direct reconstruction of a two - dimensional free - energy landscape .",
    "this task will be achieved by resorting to autonomous steering with respect to two additional collective variables .",
    "in addition , the biasing potential @xmath163 will be constructed iteratively .",
    "the one - dimensional reconstruction problem involves calculating the migration free - energy of the vacancy in the @xmath0-fe system .",
    "atomic interactions of the model system are described by the ( embedded atom method ) potentials developed by ackland and coworkers  @xcite and are computed using the minimum image convention .",
    "the crystal structure is body - centered cubic and the initial unrelaxed cell contains 1023 atoms displayed on 1024 lattice sites : the vacant site ( vacancy ) is at a corner of the cell .",
    "let @xmath260 denote a nearest neigbour atom of the vacancy along a [ 111 ] direction and define the one - dimensional collective variable @xmath261 as the distance between @xmath262 and the system s center of mass @xmath263 .",
    "a single additional variable @xmath264 is associated to @xmath261 via the potential energy @xmath265 .",
    "the time - step is @xmath266 and the friction of the langevin dynamics is @xmath267 whatever @xmath20 .    furthermore , protective spheres have been added upon the 7 nearest atoms of atom @xmath262 and upon the 7 nearest atoms of the vacancy ( @xmath262 being obviously unprotected ) .",
    "each sphere is centred on the corresponding site of the underlying rigid lattice and is of radius @xmath268 ( where @xmath269 is the nearest neigbour distance ) .",
    "displacements moving a neigbouring atom out of its protective sphere are discarded , which can be done because the dynamics have been metropolized ( see appendix  [ langevin ] ) .",
    "the exit frequency of neighbouring atoms remains negligible even at high temperature .",
    "this procedure prevents spontaneous vacancy atom exchanges that may occur at temperatures above @xmath270 by the nonequilibrium steering without altering the statistics .",
    "the reaction coordinate @xmath271 is the projection of vector @xmath272 along [ 111 ] direction . measuring the quantity of interest , @xmath273 , via a histogram",
    "amounts to monitoring the occupation probability of atom @xmath262 along [ 111 ] direction .",
    "we implement non - autonomous steering with its additional variable ( @xmath274 ) evolving at constant velocity according to @xmath275 .",
    "\\end{aligned}\\ ] ] the values @xmath276 and @xmath277 in the steering schedule have been chosen such that the atom @xmath262 performs a single jump into the vacant site .",
    "the phase space is thus restricted to 2 possible vacancy sites .",
    "time is given by @xmath67 .",
    "as noticed in related studies  @xcite implementing jarzynski s work identity , we found it advantageous to use few long nonequilibrium trajectories rather than many short ones .",
    "hence , for each temperature , we have generated @xmath278 hybrid trajectories with @xmath279 time - steps ( implying a total of @xmath280 force evaluations per simulation ) . from the 100 trajectories , we calculated the histograms @xmath281 with @xmath8 spanning the interval @xmath282 $ ] in 121 bins .",
    "temperature ranges from 20k to 1000k .",
    "figure  [ various_estimates ] displays various outputs of the simulation carried out at @xmath283 .",
    "panel ( a ) displays the reaction coordinates @xmath8 of the states successively selected by @xmath257 ( eq .  [ pselect ] ) . the high crossing probability discussed in the figure caption",
    "is related to the small value of the work performed on the system once the system has transited over the barrier at the present low - velocity steering . to illustrate the unavoidable lag effect caused by steering ,",
    "let us consider the cologarithm of a @xmath284 estimate ( i.e. of an estimate obtained from a single trajectory ) .",
    "the variation of @xmath285 with respect to @xmath8 is related to the work done along the trajectory .",
    "we have represented in panel ( b ) the cologarithm of several @xmath284 estimates for forward or backward trajectories .",
    "the asymmetry of the colog - probability profiles is controlled by the steering direction and the amount of dissipation .",
    "the asymmetry is removed because the estimator combines trajectories generated forward and backward along @xmath8 , i.e. starting from both free energy minima .",
    "the cologarithm of the @xmath281 histogram , represented in panel ( b ) by the thick symmetric curve , illustrates this feature .",
    "a similar compensation has been observed previously  @xcite with a bidirectional variant of the hummer - szabo method . in panel ( c ) , we have plotted the divergence defined by @xmath286 where @xmath287 is estimated here using @xmath288 and",
    "the overbar denotes averaging the 100 available @xmath289 values .",
    "mathematically , the divergence @xmath290 is a relative entropy betwen two distributions  @xcite .",
    "thermodynamically , it is an excess entropy that is stored into the system and that would be irreversibly dissipated toward the thermostat if the system was allowed to relax back to equilibrium at constant @xmath8 .",
    "this quantity gives information on the convergence of exponential averages  @xcite .",
    "the smaller the divergence is and the more accurate the estimation is .",
    "we observe from fig.[various_estimates ] that accuracy is smaller at the edges of the barrier , where the gradient of the steering potential is larger .",
    "besides , @xmath290 decreases again to a minimum around @xmath291 that corresponds to the intermediate free energy minimum of panel ( b ) .",
    "this trend suggests that the excess energy transiently stored in the steering potential is not entirely dissipated but is released to the extended system when @xmath8 reaches the intermediate energy minimum .",
    "the method was found to yield reproducible @xmath292-estimates down to the temperature of @xmath293 .",
    "two series of simulations were carried out . from @xmath293 to @xmath294 , we used @xmath295 ( ir1 ) and from @xmath296 to @xmath297 we used @xmath298 ( ir2 ) .",
    "results are represented by the free energy landscape of fig .",
    "[ free_energy_landscape ] .",
    "we observe that the intermediate free - energy minimum is more pronounced at the lower temperatures and completely disappears at temperatures higher than @xmath299 .",
    "the migration free energies are deduced from the relative barrier heights along @xmath8-axis of fig .",
    "[ free_energy_landscape ] .",
    "they are plotted as a function of temperature in fig .",
    "[ comparison_vacancy ] together with the prediction of classical harmonic approximation ( cha ) .",
    "cha calculations have been performed using the procedure described in ref .",
    "@xcite and considering one of the two symmetric energy minima and saddle configurations .",
    "as expected , monte carlo simulations and cha calculations agree at low temperatures ( @xmath300 ) where anharmonic effects are negligible , confirming the exactness of our simulation method . at temperatures higher than @xmath296 , we observe a substantial deviation between simulation and cha , attesting to strong an anharmonicity .",
    "note that the extent of anharmonicity is in quantitative agreement with the one previously reported in the literature  @xcite for the vacancy migration free energy .",
    "in our first application , a single collective variable was used and simulations were performed successively with varying the temperatures so as to complete the landscape . in the second application , we show how to achieve two - dimensional reconstruction directly by resorting to autonomous steering with two additional variables .",
    "we consider the 38-atom lennard - jones cluster .",
    "lj@xmath9 is computationally troublesome to study because its potential energy landscape has two main funnels  @xcite , whose respective lowest energy structures are the icosahedron and the octahedron displayed in fig .  [ lj38 ] .",
    "it undergoes a two - stage phase change with increasing temperature starting from the octahedral structure .",
    "a solid - solid transition temperature between the octahedral funnel and the icosahedral funnel occurs near @xmath301 , melting follows near @xmath302 .",
    "lj reduced units of length , energy and mass ( @xmath303 , @xmath304 , @xmath305 ) will be used in the following .    as first collective variable",
    ", we use the bond - orientational order parameter @xmath306 of steinhardt et al .",
    "@xcite that is able to distinguish between the cubic structures favoured at low temperatures and the icosahedral isomers above @xmath307 .",
    "the second collective variable is the potential energy @xmath308 .",
    "the associated additional variables , @xmath264 and @xmath309 , act upon the particles via harmonic potentials whose stiffnesses are @xmath310 and @xmath311 , respectively .",
    "their respective masses are @xmath312 and @xmath313 .",
    "the respective coupling parameters are @xmath314 and @xmath315 , and the frictions are @xmath316 ( @xmath317 ) and @xmath318 ( @xmath133 ) .",
    "they have been chosen using the simple recipe that follows ( @xmath319 ) : ( i ) the @xmath44 s are tuned to enable the additional variables @xmath43 to oscillate with an amplitude large enough in the direction of the corresponding order parameter ; ( ii ) the masses @xmath320 are then tuned to set the velocity slow enough ( but not too slow ) and ( iii ) the coupling parameter @xmath321 is chosen small enough to ensure a smooth and regular evolution of the @xmath43 s . procedures ( ii ) and ( iii ) prevent the dynamics from producing entropy , i.e. from dissipating the work done on the system into heat when the @xmath43 s evolve too fast .",
    "the values given above were found satisfactory and are certainly sub - optimal .",
    "finding the optimal computational set - up is a non trivial task .",
    "a series of iterative simulations have been carried out at the temperature @xmath322 , using the procedure introduced by coluzza and frenkel  @xcite in a similar context .",
    "let @xmath323 denote the histogram constructed by the @xmath324-th simulation .",
    "the biasing potential @xmath325 of the next simulation is then constructed using the iterative procedure @xmath326 the @xmath327 parameter determines the maximum value of the biasing potential and thus avoids possible singularities arising from unexplored histogram bins . as the successive simulations",
    "explore larger portions of the phase space more and more accurately , the control parameter is decreased iteratively using the relation @xmath328 .",
    "each simulation generates approximately @xmath329 trajectories of @xmath330 time - steps .",
    "panel ( a ) of figure  [ contour ] represents the final @xmath331 contour plot obtained at the temperature of the simulation @xmath332 .",
    "the color scale is such that the improbable regions of the landscape are displayed in black .",
    "the free energy at any temperature @xmath333 is related to the microcanonical density of states @xmath334 via the relation  @xcite @xmath335 de . \\end{aligned}\\ ] ] since this relation is also valid for the reference temperature @xmath336 , it gives access to the difference of landau free energies between any target temperature @xmath333 and the reference temperature @xmath336 of the simulation @xmath337 de .",
    "\\label{intovere}\\end{aligned}\\ ] ] the integral over energy in   acts as a normalizing factor and is the partition - function ratio involving the reference ( @xmath336 ) and target ( @xmath333 ) systems .",
    "the free energy landscape at temperature @xmath338 is finally displayed in panel ( b ) of fig .",
    "[ contour ] and reveals the low energy structures previously reported in ref .",
    "@xcite . to make a quantitative comparison between the present method [ information retrieval with autonomous - steering , ( ir ) ] and the three simulation methods used in ref .",
    "@xcite [ nonequilibrium path - sampling ( ps ) , parallel - tempering ( pt ) and wang - landau ( wl ) ] , we plot in fig .",
    "[ comparison ] all the estimated free energy profiles , @xmath339 as a function of @xmath306 , for temperatures @xmath340 , @xmath341 and @xmath342 .    for the present method and the wang - landau method  @xcite , we used the standard relation @xmath343 de\\end{aligned}\\ ] ] to obtain the free energy profile .",
    "in the reported path - sampling simulations , the temperature along the trajectories were slowly cooled down starting from @xmath322 , which , using the present terminology , amounts to non - autonomous steering with respect to temperature . however , in contrast with the present study , the estimator that was implemented was based on crook s nonequilibrium average and could only exploit the information from the time - slice of the corresponding temperature .",
    "we observe that , at the temperature @xmath340 , the lowest that could be simulated correctly using standard umbrella sampling and histogram reweighting  @xcite , our ir estimates for the free energies are in excellent agreement with the ps , pt and wl estimates  @xcite .",
    "however , at lower temperatures , we observe a disagreement for low free - energy structures in the range @xmath344 , in particular for the one appearing around @xmath345 , compared to estimates obtained using the three other methods ( ps , pt and wl ) .",
    "this limitation of the method is con commitant to the slow convergence of the two - dimensional biasing potential @xmath346 in this region of phase space .",
    "we did not perform another iteration as the total number of force evaluations was already @xmath347 , i.e. equal to the one in the corresponding ps simulations  @xcite .",
    "nevertheless , at temperature @xmath348 [ fig.[comparison ] , panel ( c ) ] , the estimates ( ir ) of @xmath339 revealed numerous low energy structures in the range @xmath349 , which are explored with path - sampling , but missed with parallel tempering and wang - landau sampling . in particular , the low energy structure at @xmath350 is correctly predicted .",
    "interestingly , the bassins of attraction of these minima are larger with ir than with ps .",
    "this is due to the enhanced statistics made possible by the multi - state estimator that exploits information from all time - slices at any temperature , unlike the ps estimator .",
    "finally , we plot the two - dimensional free - energy landcape @xmath351 as a function of @xmath352 and @xmath4 obtained from the simulation using a multi - state estimator in fig .",
    "[ contour_q6 ] .",
    "the @xmath352 order parameter is used because it better distinguishes the liquid phase @xmath353 and the icosahedral phase @xmath354 , as seen from this figure .",
    "results are in qualitative agreement with previous simulation ( ps ) except for the defected structures @xmath355 around @xmath356 whose free energy is overestimated .",
    "to conclude this test study on lj@xmath9 system , the reconstruction of a two - dimensional free - energy was achieved owing to the iterative construction of the two - dimensional biasing potential @xmath357 with autonomous steering . in term of numerical efficiency , the approach was found advantageous because its estimator retrieves the information contained in all the time - slices of the generated trajectories , unlike the nonequilibrium average previously implemented with non - autonomous steering  @xcite . further comparing the numerical efficiency of the methods from ref .",
    "@xcite and the present one is difficult , as estimators and steering schedules of distinct types were used . the non - autonomous steering schedule of ref .",
    "@xcite should be tested with the more efficient multi - state estimator proposed in this study .",
    "in addition , given that the reported wang - landau sampling simulations achieved greater performance in the range @xmath358 but smaller performance in the range @xmath359 , it may be worth implementing the multi - state estimator described in the present paper in combination with adaptive sampling methods such as wang - landau sampling  @xcite or metadynamics  @xcite so as to check whether the construction of the biasing potential would be facilitated .",
    "in this article , we developed a unifying framework and a simple algorithm for retrieving the equilibrium information contained in all the time - slices from a sample of nonequilibrium trajectories .",
    "the algorithm , which shares several features with maximum - likelihood methods for nonequilibrium dynamics , is built upon bayes theorem : a sampler generates a markov chain of linked trajectories distributed according to a marginal probability , while an estimator operates over the markov chain so as to infer the contribution to equilibrium of the sampled data using a likelihood function .",
    "contrary to maximum - likelihood estimators , the proposed estimator does not involve post - processing , can possibly be implemented with dynamics based on either non - autonomous or autonomous scheduling and is unbiased but not optimal .    concerning the overall efficiency of the method",
    ", we observe that , in agreement with theoretical prediction  @xcite and maximum - likelihood simulations  @xcite , the most accurate estimations of free energies are obtained when trajectories can be initiated from the various regions of interest .",
    "this computational requirement can be fulfilled by tuning an auxiliary biasing potential so as to flaten the prior probability distribution along the desired reaction coordinate . using autonomous steering dynamics and resorting to a simple iterative procedure for constructing a two - dimensional biasing potential",
    ", the multi - state estimator could indeed reconstruct the free - energy landscape of the troublesome lj@xmath9 system quite accurately .",
    "the presented simulations clearly outlined the advantages of steering autonomously rather than non - autonomously : the former strategy can be implemented in complex systems that require more than one steering variable and enables one to reconstruct multi - dimensional free energy landscapes directly .",
    "this feature in fact extends the possibilities of the hummer - szabo methodology  @xcite .",
    "eventually , the multi - state estimator should be implemented with an adaptive sampler  @xcite to check whether the combination of both techniques facilitates or not the construction of the biasing potential , compared to simulations resorting to one of the two techniques exclusively .",
    "this issue is to be considered in the wider perspective of waste - recycling  @xcite , which similarly advocates to retrieve all the information generated during the simulations within on - line statistical averages .",
    "a recent numerical investigation  @xcite shows that a significant reduction of the statistical variances can be achieved in replica - exchange simulations that implement a multi - state estimator and a multi - proposal sampler  @xcite similar to the ones used in the present study .",
    "we are much indebted to eric vanden - eijnden for suggesting the use of autonomous steering  @xcite and for advising us .",
    "we warmly thank gabriel stoltz for relevant comments on early versions of the manuscript , florent calvo for providing us with the @xmath306-gradient subroutine , giovanni ciccotti , john chodera and david minh for valuable advice .",
    "this work was mainly financed by commissariat  lenergie atomique ( dsoe program ) , partly carried out at lawrence livermore national laboratory ( under a vsp agreement ) and performed using hpc resources from genci - cines ( grant 2009-x2009096020 ) .",
    "in other implementations of the residence weight algorithm , the biasing function @xmath357 is a work quantity rather than an auxiliary potential as in the present study .",
    "the equivalent form of our detailed balance equation   corresponds to the detailed balance condition  ( * ? ? ?",
    "* eq .  61 ) which itself formalizes the weighted balance condition given in earlier works ( refer to  ( * ? ? ?",
    "* eq .  5 ) and",
    "* eq .  21 ) ) .",
    "the weighted balance equation was induced by analogy with the residence time algorithm .",
    "the latter algorithm  @xcite and its extensions  @xcite are used extensively in kinetic monte carlo simulations and also achieve importance sampling in ensembles of linked trajectories ( more precisely , of kinetic pathways ) , owing to a similar selecting procedure .",
    "the selecting probability satisfies a detailed balance condition weighted by residence times ( mean first passage times of exit ) .",
    "eventually , the residence time algorithm also involves information retrieval  @xcite .",
    "the kinetic pathways that can possibly be constructed from the master equation and that are eventually discarded by the algorithm  @xcite do contribute to the residence times .",
    "these analogies are more obvious for the residence weight algorithms used in ref .",
    "@xcite , which unlike the present case , generate and select trajectories pertaining to ramified paths called webs  @xcite .",
    "the relatively high numerical efficiency of the residence algorithms for estimating differences of free energies can be qualitatively explained by the study of oberhofer and dellago  @xcite .",
    "assuming that the biasing potential is an adjustable functional depending on the work @xmath110 , these authors derived the optimal work dependent bias that leads to minimal statistical variance .",
    "the statistical variance was found to be minimal when the work - bias distribution contains typical forward and typical backward trajectories with similar weights , which is precisely an essential feature of the residence weight algorithms previously proposed .",
    "these algorithms generated paths using alternately the forward and reverse distribution in the extended ensemble of trajectories .",
    "in the present study , the biasing potential @xmath360 is state dependent .",
    "the appropriate potential ensuring equipartition of trajectories would be such that @xmath361 , which amounts to artificially flattening the probability density along the order parameter @xmath2 .",
    "optimizing the biasing potential @xmath163 requires knowledge of the quantities to compute , implying that the optimal bias can only be constructed iteratively , or adaptively , as outlined by oberhofer and dellago  @xcite .",
    "the unavoidable discretization errors are corrected in the ensemble average because the multi - state estimators uses the ratio of actual generating probabilities  @xcite .",
    "nevertheless , numerical efficiency depends on the choice of the time step @xmath64 .",
    "too small a time step decreases the sampling efficiency because states along the generated trajectories appear to be strongly correlated .",
    "conversely , too large a time step produces numerical entropy ( dissipated work  @xcite ) and one would observe that the selected states of the successive paths are also separated by small numbers of steps on average . both situations results in increased statistical covariances in the path ensemble . hence , in practice",
    ", the time step is tuned to achieve the best trade - off between decorrelation and entropy production .",
    "unfortunately , for systems with many particles , discretization errors are important which imposes to choose a very small time step .",
    "this situation is encountered with our tabulated eam potential of iron .",
    "we have therefore metropolized the langevin dynamics , i.e. we accept an iteration with probability  @xcite @xmath362)\\ ] ] with the metropolis rule .",
    "if the move is accepted , the new state is @xmath363 , otherwise we set @xmath364 .",
    "the change of sign for momenta preserves the reversibility of the markov chain and we take @xmath365",
    ". a rejection rate of a few percent  @xcite makes it possible to use a much larger time step , thus saving computational time .",
    "note that when a rejection occurs with probability @xmath366 at iteration @xmath76 , this quantity must be included in the conditional probabilities @xmath367 whatever @xmath368 .",
    "because the selecting probability @xmath257 considers ratios of conditional probabilities , the metropolis rejections in the trajectories does not affect the work quantities @xmath202 and the algorithm given in subsection  [ rwa ] ( see  ( * ? ? ?",
    "* appendix b.3 ) for the detailed proof ) .",
    "finally , note that the two ornstein - uhlenbeck ( ou ) processes   and   of duration @xmath369 in the discretization scheme can possibly be merged into a single one of duration @xmath64 . as a result ,",
    "the discretization ( eqn .  [ forward0]-[forward3 ] ) , simplifies into a leap - frog scheme  @xcite that generates a single noise per iteration @xmath370 the quantity @xmath371 describes the momentum variation during the ou process twice longer @xmath372 where @xmath373 is a normal noise of variance @xmath374 while @xmath375 and @xmath376 denote the momentum variations during the ou processes in   and  .",
    "the leap - frog scheme could have been used in combination with the multi - state estimator since here the work does not depend on momenta at integer steps .",
    "g. torrie and j. valleau , non - physical sampling distributions in monte carlo free - energy estimation : umbrella sampling , j. comp .",
    "( 1977 ) 187 - 199 .",
    "a. m. ferrenberg and r. h. swendsen , optimized monte - carlo data analysis , phys .",
    "63 ( 1989 ) 1195 - 1198",
    ". s. kumar , d. bouzida , r .",
    "swendsen et al . , the weighted histogram analysis method for free - energy calculations on biomolecules 1 .",
    "the method , j. comp .",
    "( 1992 ) 1011 - 1021 .",
    "m. shirts and j. chodera , statistically optimal analysis of samples from multiple equilibrium states , j. chem .",
    "( 2008 ) 124105 ( 10pp . ) . c.  h. bennett , efficient estimation of free - energy differences from monte - carlo data , j. comp .",
    "( 1976 ) 245 - 268 .",
    "m. shirts , e. bair , g. hooker and v. pande , equilibrium free energies from nonequilibrium measurements using maximum - likelihood methods , phys .",
    "91 , ( 2003 ) , 140601 .",
    "g. hummer and a szabo , free energy reconstruction from nonequilibrium single - molecule pulling experiments , proc .",
    "98 ( 2001 ) 3658 - 2010 . c. jarzynski , nonequilibrium equality for free energy differences , phys .",
    "lett . , 78 ( 1997 ) , 2690 - 2693 .",
    "j. kurchan , fluctuation theorem for stochastic dynamics , j. phys .",
    "a math . gen . 31 ( 1998 ) 3719 - 3729 .",
    "g. crooks , nonequilibrium measurements of free energy differences for microscopically reversible markovian systems , j. stat .",
    "( 1998 ) 1481 - 1487 .",
    "g. crooks , path - ensemble averages in systems driven far from equilibrium , phys .",
    "e , 61 , 2361 ( 2000 ) 2361 - 2366 .",
    "m athnes , computation of a chemical potential using a residence weight algorithm , phys .",
    "e , 66 ( 2002 ) 046705 .",
    "m. athnes , a path - sampling scheme for computing thermodynamic properties of a many - body system in a generalized ensemble , eur .",
    "j. b , 38 ( 2004 ) 651 - 663 .",
    "g. adjanor and m. athnes , gibbs free - energy estimates from direct path - sampling computations , j. chem .",
    "phys . , 123 ( 2005 ) 234104 .",
    "h. oberhofer , c. dellago and p. l. geissler , biased sampling of nonequilibrium trajectories : can fast switching simulations outperform conventional free energy calculation methods ?",
    "b , 109 ( 2005 ) 6902 - 6915 .",
    "m. athnes , web ensemble averages for retrieving relevant information from rejected monte carlo moves , eur .",
    ". j. b , * 58 * , 83 , ( 2007 ) .",
    "t. lelivre , m. rousset and g. stoltz , free - energy computations : a mathematical perspective , imperial college press , 2010 .",
    "d. ceperley , g. ghester and m. kalos , monte carlo simulation of a many - fermion system , phys .",
    "b 16 ( 1977 ) 3081 - 3099",
    ". g. adjanor and m. athnes and f. calvo , free energy landscape from path - sampling : application to the structural transition in lj(38 ) , eur .",
    "j. b , 53 ( 2006 ) 47 - 60 .",
    "g. bussi , t. zykova - timan and m. parrinello , isothermal - isobaric molecular dynamics using stochastic velocity rescaling , j. chem .",
    "130 , ( 2009 ) 074101 .",
    "v. chernyak and m. chertkov and c. jarzynski , path - integral analysis of fluctuation theorems for general langevin processes , j. stat .",
    "mech . , ( 2006 )",
    "e. vanden - eijnden , some recent techniques for free energy calculations , j. comp . chem . 30 ( 2009 ) 1737 .",
    "t. bodineau , b. derrida , cumulants and large deviations of the current through non - equilibrium steady states , cr physique , 8 ( 2007 ) 540 - 555 .",
    "g. crooks , excursions in statistical physics , phd thesis , http://threeplusone.com/pubs/gecthesis .",
    "g n bochkov and yu .",
    "e. kuzovlev , contribution to general theory of thermal fluctuations in nonlinear - systems , j. exp .",
    "phys . , 72 ( 1977 ) 238 - 247 .",
    "g n bochkov and yu .",
    "e kuzovlev , non - linear fluctuation - dissipation relations and stochastic - models in non - equilibrium thermodynamics 1 generalized fluctuation - dissipation theorem , physica a 106 ( 1981 ) 443 - 479 . c. jarzynski",
    ", nonequilibrium work theorem for a system strongly coupled to a thermal environment j. stat .",
    ": theory exp .",
    "( 2004 ) p09005 .",
    "j. horowitz and c. jarzynski , comparison of work fluctuation relations , j. stat .",
    "mech . : theory exp .",
    "p11002 , ( 2007 ) . c. jarzynski ,",
    "nonequilibrium work relations : foundations and applications , eur .",
    "j. b 59 ( 2008 ) 331 - 340 .",
    "f. bruneval , d. donadio and m. parrinello , molecular dynamics study of the solvation of calcium carbonate in water , j. phys .",
    "b 111 ( 2007 ) 12219 - 12227 .",
    "g. adjanor and m. athnes , thermodynamic modelling of glasses at atomistic scale , aip conference proceedings , 999 ( 2008 ) 186 - 201 .",
    "d. minh and a. adib , optimized free energies from bidirectional single - molecule force spectroscopy , phys .",
    "100 , ( 2008 ) 180602 .",
    "m. marchese , g. de lorenzi , g. jaccuci and c. flynn , jump dynamics and the isotope effect in solid - state diffusion , phys .",
    "57 ( 1986 ) 3280 - 3283 .",
    "j. doye and m. miller and d. wales , the double - funnel energy landscape of the 38-atom lennard - jones cluster , j. chem .",
    "( 1999 ) 6896 - 6906 .",
    "p. steinhard , d. nelson and m. ronchetti , bond orientational order in liquids and glasses , phys .",
    "b , 28 ( 1983 ) 784 - 805 .",
    "d. wales , energy landscapes , cambridge university press ( 2003 ) .",
    "f. wang and d. p. landau , efficient multiple - range random walk algorithm to calculate density of states , phys .",
    "86 ( 2001 ) 2050 - 2053 .",
    "t. lelivre , m. rousset and g. stoltz , computation of free energy profiles with parallel adaptive dynamics , j. chem .",
    "( 2007 ) 134111 .",
    "a. barducci , g. bussi and m. parrinello phys .",
    "lett . , well - tempered metadynamics : a smoothly converging and tunable free - energy method , 100 ( 2008 ) 020603 .",
    "lanore , simulation of the evolution of defects in a lattice by the monte carlo method , radiation effects ,  22 ( 1974 ) 153 - 162 .",
    "new algorithm for monte - carlo simulation of ising spin systems , a.  b. bortz , m.  h. kalos , and j.  l. lebowitz , j. comp .",
    "phys .  17",
    "( 1975 ) 10 - 18 .",
    "m.  athnes , p.  bellon , and g.  martin , identification of novel diffusion cycles in b2 ordered phases by monte carlo simulation , phil . mag .",
    "a , 76 ( 1997 ) 565 - 585 .",
    "d.  r. mason , r.  e. rudd , and a.  p. sutton , stochastic kinetic monte carlo algorithms for long - range hamiltonians , comput .",
    "phys.commun . 160",
    "( 2004 ) 140 - 157 .",
    "t. oppelstrup , v. bulatov , g. gilmer , m. kalos , and b. sadigh , first - passage monte carlo algorithm : diffusion without all the hops .",
    "97 ( 2006 ) 230602 ."
  ],
  "abstract_text": [
    "<S> various methods achieving importance sampling in ensembles of nonequilibrium trajectories enable one to estimate free energy differences and , by maximum - likelihood post - processing , to reconstruct free energy landscapes . here , based on bayes theorem , we propose a more direct method in which a posterior likelihood function is used both to construct the steered dynamics and to infer the contribution to equilibrium of all the sampled states . </S>",
    "<S> the method is implemented with two steering schedules . </S>",
    "<S> first , using non - autonomous steering , we calculate the migration barrier of the vacancy in fe-@xmath0 . </S>",
    "<S> second , using an autonomous scheduling related to metadynamics and equivalent to temperature - accelerated molecular dynamics , we accurately reconstruct the two - dimensional free energy landscape of the 38-atom lennard - jones cluster as a function of an orientational bond - order parameter and energy , down to the solid - solid structural transition temperature of the cluster and without maximum - likelihood post - processing .    </S>",
    "<S> free - energy calculations , statistical thermodynamics , computer chemistry , molecular simulation </S>"
  ]
}