{
  "article_text": [
    "self - assembly of monomer units into structures with a characteristic finite size is one of the central themes of soft matter physics , examples including the formation of dna duplexes , protein complexes , virus capsids and spherical micelles .",
    "of course , an important aspect of such systems is their thermodynamics , particularly in how it affects the assembly dynamics .",
    "however , how to best obtain the equilibrium thermodynamics from simulations of assembling systems is an important open question and one that has become more pressing , as increased computer power and the availability of coarse - grained models has made such simulations more feasible .",
    "if self - assembly occurs relatively readily , the best approach is probably to directly simulate a sufficiently large system where a number of the assembled structures can simultaneously form .",
    "after equilibration has taken place , statistics can then be extracted for the frequency with which clusters of various sizes are observed .",
    "for example , such an approach has been used to characterize the thermodynamics of micellization @xcite .    however , it is not uncommon that such direct approaches are problematic , because the presence of significant free energy barriers to assembly makes equilibrium hard to achieve .",
    "these difficult cases typically involve either the association of a relatively large number of simple monomers or a small number of complicated monomers .",
    "examples of the former include the assembly of coarse - grained models of proteins and patchy colloids into virus capsid - like objects @xcite , while examples of the latter include the formation of dna duplexes @xcite , or the assembly of larger dna nanostructures @xcite .    in these cases ,",
    "an obvious way to facilitate assembly would be to use rare - event techniques , such as umbrella sampling @xcite , and which usually require an order parameter that can characterize the transition to the assembled state .",
    "usually it is relatively straightforward to conceive of order parameters that can be used to describe the formation of a single target structure , e.g.  the number of correct base pairs for assembly of a dna duplex @xcite , or the number of particles in the largest cluster for the assembly of capsid - like objects @xcite or micelles @xcite .",
    "however , it is less clear how to develop an order parameter that can be used to drive the formation of multiple target structures , and we are not aware of any such studies in the literature that achieve this .    therefore , an appealing approach to obtain the equilibrium thermodynamics would be to simulate the formation of a single assembled structure , using say umbrella sampling , and if the self - assembly is monodisperse , i.e.  the assembled structure has a specific size , to perform the simulation in the canonical ensemble with exactly the right number of particles to form one complete structure .",
    "but what would be the errors with such an approach ?",
    "firstly , interactions between the assembled structures are neglected .",
    "however , this is often likely to be a relatively good approximation , because the interactions between assembled structures are likely to be mainly associated with excluded volume  any attractions are likely to be weak compared to the forces associated with the assembly itself  and assembly often occurs at relatively low concentrations .",
    "the second potential source of error is finite - size effects , and these are the focus of the present paper . in particular , we will show that these finite - size errors in canonical ensemble simulations can be significant , but also how they can be corrected under the assumption that species behave ideally , which as we mentioned above is often a good approximation .",
    "we will also examine how the assembly yields converge towards the bulk values as the system size is increased , as well as suggesting an extension to the umbrella sampling scheme which facilitates the study of multiple targets of self - assembly .",
    "we should note that specific methods have been developed to calculate the equilibrium thermodynamics of heterodimer formation in the protein - ligand binding literature @xcite .",
    "these aim to estimate the partition function of bound and separated molecules directly , and typical methods include calculating a potential of mean force for a certain pathway between bound and unbound structures , incorporating the effects of overall translational degrees of freedom separately .",
    "these techniques , which are optimized for problems of great computational difficulty , lack the flexibility and simplicity of the approach analysed here , in which nothing need be approximated or assumed about the nature of bonding , and no pathway need be imposed .",
    "furthermore , they do not generalize well to multicomponent assembly .",
    "we illustrate the physical cause of finite size statistical corrections by considering heterodimer formation  such a system may correspond to protein binding or dna hybridization @xcite .",
    "we consider a simulation in a periodic cell of volume @xmath0 , containing one monomer of type ` a ' and one of type ` b ' .",
    "assuming we have a criterion for defining a subset of states as ` bound ' , our simulation will estimate the relative probability with which bound ( ab ) and unbound ( a , b ) states are observed in such a system : @xmath1 with the fraction of bound pairs given by : @xmath2 naively , we might hope that @xmath3 , the bulk equilibrium bonding fraction at the same temperature and concentration .",
    "unfortunately , this is not the case , as although we match the average concentration of a bulk system we do not match concentration fluctuations ( as shown in figure [ fluctuations ] ) in a small volume of that system .",
    "we can apply corrections using simple thermodynamic arguments , if we assume that interactions between all particles which are not in a dimer state are negligible .",
    "we consider a system of volume @xmath4 , with @xmath5 an integer , with the same average concentration as the system with @xmath6 .",
    "we define :    * @xmath7 and @xmath8 as the partial partition functions of the @xmath6 system when confined to the relevant subset of states . for future convenience , we define these quantities using _ distinguishable statistics _ , although it does not matter at this stage .",
    "we note that @xmath9 . *",
    "@xmath10 as the total number of particles of type a or b ( here @xmath11 ) .",
    "* @xmath12 as the number of molecules of species @xmath13 ( in this case @xmath13 is a , b or ab ) . * @xmath14 as the single particle partition function for species @xmath13 , in the volume @xmath4 , with the internal degrees of freedom treated using _",
    "indistinguishable statistics_. * @xmath15 as the chemical potential of species @xmath13 .",
    "the @xmath15 are given by a standard result of statistical mechanics : @xmath16 where the approximation becomes an equality in the thermodynamic limit .",
    "in this limit , we can use the standard equilibrium result @xmath17 , where @xmath18 are the stoichiometric coefficients of the species in the reaction , finding : @xmath19 as each @xmath20 scales with the volume of the system , we have : @xmath21 @xmath22 which gives ( using @xmath23 ) : @xmath24}{{[\\rm a}][{\\rm b } ] } = \\frac{v z_{\\rm ab } } { z_{\\rm a , b } } = v \\phi = k^{\\rm eq}_{\\rm a , b}. \\label{conc eqn}\\ ] ] we note that the quantity @xmath25 is that which is generally directly estimated in protein / ligand binding studies @xcite ; this is then multiplied by a reference concentration to give the equilibrium constant .    substituting ( [ relative partition function ] ) , ( [ association of q with phi 1 ] ) and ( [ association of q with phi 2 ] ) into ( [ thermodynamics prediction ] ) yields : @xmath26 @xmath27 in this case , @xmath28 for all values of @xmath29 , as is illustrated for a model dimer - forming system in figure [ transition ] .",
    "it is also noticeable that the transition is wider for the bulk system .",
    "the physical causes of these two effects will be discussed at the end of section [ homodimer formation ] .",
    "it is useful to consider how the bonding fraction converges to the bulk result as the system size is increased from one cluster to the thermodynamic limit .",
    "we consider a system of volume @xmath4 , calculating the fraction of dimers ( @xmath30 ) as a function of @xmath29 , again neglecting interactions except dimer formation .",
    "consider the macrostate with @xmath31 dimers formed ( out of a possible @xmath5 ) .",
    "the partition functions of individual monomers and dimers scale with the size of the system ( @xmath4 ) , and the partition function of the system is the product of the individual partition functions together with combinatorial factors . using @xmath32 and @xmath33 as defined before , the partition function of a macrostate with b dimers ( using distinguishable statistics )",
    "is given by : @xmath34 in which the combinatorial factor is obtained from the total number of permutations of a and b ( @xmath35 ) divided by the permutations which exchange monomers for monomers ( @xmath36 ) or dimers for dimers ( @xmath37 ) .",
    "we divide by @xmath35 to make our statistics indistinguishable .",
    "we find @xmath30 in the usual way , using equation ( [ relative partition function ] ) to simplify :    @xmath38    plotting @xmath30 against @xmath5 for @xmath39 ( figure [ f_d_dna](a ) ) we find that the bonding fraction falls from 0.652 to a large @xmath5 limit of 0.489 , and behaves similarly for other values of @xmath29 .",
    "we can formally find this limit by noting that for any value of @xmath29 , @xmath40 is sharply peaked about its maximum @xmath41 for large @xmath5 .",
    "this allows us to make the saddle point approximation , whereby we assume that @xmath40 is gaussian and therefore that @xmath42 by symmetry . maximizing @xmath43 , and employing stirling s approximation yields : @xmath44 @xmath45 using @xmath46",
    ", we can see that equations ( [ dz/db=0 ] ) and ( [ phi equation ] ) are identical , as they should be .",
    ", with average concentration fixed .",
    "the ` x ' symbols indicate results from simulations of our dna model that were capable of forming @xmath5 dna duplexes 5 base pairs long , and the ` + ' are the predictions of equation ( [ fn ] ) with @xmath29 chosen to reproduce the @xmath6 dna result .",
    "the solid line indicates @xmath47 .",
    "the image in the bottom right shows a duplex of 10 bases as represented by our coarse - grained dna model .",
    "the simulations of the model were performed in the canonical ensemble using the monte carlo algorithm of whitelam and geissler @xcite .",
    ", width=272 ]    the microscopic approach provides a simple mechanism for evaluating the accuracy of the correction scheme in certain cases .",
    "if it is possible to simulate the simultaneous formation of two or more targets , one can compare the change in dimer yield to the predictions of the microscopic approach , and then extend to the thermodynamic limit if the agreement is good .",
    "this is particularly useful if it is possible to consider an example with the relevant model where the self - assembly process is relatively simple .",
    "for example , we have recently developed a coarse - grained model of dna @xcite in which bases are represented by rigid nucleotides ( inset in figure [ f_d_dna ] ) .",
    "all interactions between strands , such as base pairing and excluded volume , are truncated within distances much shorter than the typical separation of unbound strands , making the assumptions in deriving the corrections of the previous sections reasonable .",
    "simulating duplex formation for short strands of about five bases in length is simple , and simulations forming several targets can be performed .",
    "the results are plotted in figure [ f_d_dna ] , showing perfect agreement with equation ( [ fn ] ) .",
    "longer duplexes and complicated branched structures are much more challenging to simulate , meaning that only single target simulations are feasible .",
    "from the fact that the correction is successful for shorter duplexes , however , we can be confident that it will apply to longer strands when the concentration of dna bases is similar .",
    "it is instructive to consider the differences between homodimer and heterodimer corrections . for homodimers formed from two particles of type ` a ' , we obtain the following expressions for the partition function of each particle species : @xmath48 @xmath49 where the factor of two compensates for the overcounting of indistinguishable states in @xmath50 .",
    "proceeding as in section [ heterodimer thermo ] , we obtain : @xmath51}{[a]^2}= \\frac{vz_{\\rm 2a}}{2 z_{\\rm a , a } } = \\frac{v \\phi}{2 } = k_{\\rm 2a}^{\\rm eq}. \\label{thermodynamic result homo}\\ ] ] the bound fraction in the thermodynamic limit follows as : @xmath52 the behaviour of the correction is significantly different from that of heterodimers , as shown in figure [ transition ] . in this case ,",
    "the midpoint of the transition is unchanged , but the width is noticeably larger in bulk than for the two - particle system , i.e.  @xmath53 for @xmath54 , and @xmath55 for @xmath56 .    the physical mechanism for the broadening of the transition can be understood by considering the effect of concentration fluctuations .",
    "figure [ homodimer neglected states](c ) shows the states of a four - particle system which can not be sampled in a two - particle simulation . of these , the most probable is c(i ) , in which three of the particles occupy half the volume and the remainder contains only one . in this case",
    ", it is impossible to have a binding fraction of unity .",
    "a binding fraction of zero is also less likely than in the two - particle case as the three monomers occupying the ` right ' half of the system have a higher probability of forming one dimer than the two particles did in the original system . as a consequence , the fraction of dimers is pushed towards a half as the system grows in size , because larger concentration fluctuations are allowed which in turn favour the less probable configuration ( whether dimer or monomer ) , leading to a broader transition in bulk .",
    "the same argument can be applied to heterodimers , but with an important distinction . in this case",
    ", concentrations of individual species a and b can fluctuate in addition to the total concentration .",
    "unlike total concentration fluctuations , fluctuations in the relative concentrations of a and b will always reduce the probability of forming dimers , because of configurations like that in [ fluctuations]c(iv ) where no dimers can be formed . as a consequence the heterodimer yield is lower in bulk than for a two particle system , as well as having a broader transition .",
    "we now consider the formation of clusters of a specific size , a case relevant to the assembly of virus capsid - like objects @xcite , and homomeric protein complexes @xcite .",
    "if the formation of a single cluster is simulated in the canonical ensemble , once again , the statistics of the various cluster sizes do not directly correspond to bulk properties , but under the assumption that interactions which do not constitute bonding are negligible it is possible to extrapolate to large system sizes .",
    "for simplicity we consider clusters of identical monomers , although the analysis can be extended beyond this .",
    "firstly , we add some definitions :    * @xmath57 is the number of monomers needed to form the target , equal to the number of monomers simulated .",
    "* @xmath58 is the partition function for species @xmath13 , in the simulation volume @xmath0 , with the internal degrees of freedom treated _ distinguishably_.",
    "* @xmath59 is the partition function of a system of volume @xmath0 when in a state which contains one molecule of species @xmath13 , one of species @xmath60 etc .",
    "this partition function is calculated using _",
    "distinguishable statistics_. * @xmath61 is the total partition function of the @xmath57-particle system in a volume @xmath0 , calculated using _",
    "distinguishable statistics_. * as all monomers are identical , the ` a ' index will be omitted for clarity .",
    "the thermodynamically relevant quantities are the @xmath14 , because given these it is a simple task to calculate the bulk concentrations of each species using : @xmath62 and @xmath63    the quantities which are directly accessible from simulation are @xmath64 .",
    "exactly how these can be accessed depends on how the system is sampled .",
    "a sensible choice , however , is to sample states by the largest cluster size  this neatly divides the partition function @xmath65 into @xmath57 parts , and we label these subdivisions @xmath66 .",
    "we now have @xmath57 equations , one for each @xmath66 : @xmath67 where the summation over @xmath68 is the sum over all sets of indices such that @xmath69 and the indices sum to @xmath57 .",
    "we can now begin substituting for @xmath59 : @xmath70 in which @xmath71 is the number of indices in the set @xmath72 with the same value as m.    we now have @xmath57 simultaneous equations for @xmath73 in terms of our measured quantities @xmath74 .",
    "in addition , these simultaneous equations have already been decoupled as each @xmath74 expression contains only @xmath75 with @xmath76 , and thus finding @xmath73 amounts to solving a polynomial of order @xmath13 .",
    "all that remains is to find @xmath14 in terms of @xmath58 .",
    "this is reasonably simple : @xmath77 where in dividing by @xmath78 we account for the reduction in states imposed by indistinguishability .",
    "we can then obtain the right hand side of ( [ mass action ] ) by : @xmath79 in which the right hand side is expressed in terms of the known quantities @xmath73 .",
    "we can now eliminate our arbitrary large factor @xmath5 by converting to concentrations ( which equates to multiplying both sides by @xmath80 ) , giving : @xmath81}{[n_1]^i } = v^{i-1}\\frac{z_i / z^{i / n}}{i !",
    "( z_1/z^{1/n})^i}.      \\label{mass action 2}\\ ] ] once again , the system of equations can be closed by conserving total monomer number : @xmath82 = n / v.\\ ] ]    to illustrate the form of finite size corrections , we consider the artificial example of completely cooperative hexamer formation ( in which we approximate clusters of intermediate size as having zero probability ) .",
    "the complicating effects of additional states will be discussed in section [ homocluster microscopic ] . for comparison with section [ homodimer formation ]",
    ", we will assume the small system can be described by an equivalent two - state model , so that the yields of hexamers and homodimers are identical in the small simulation volume : @xmath83 with @xmath84 and @xmath85 in reduced units .",
    "the result , plotted in figure [ hexamer_transition ] , indicates once again a much broader transition in the bulk case , this time with a slightly adjusted midpoint .",
    "furthermore , this broadening is much more pronounced for hexamers than dimers .",
    "this trend is a general one , with larger clusters experiencing greater broadening due to finite - size corrections , because smaller relative concentration fluctuations are required to push the system towards a yield of approximately 50% for a clustering transition involving many monomers as opposed to dimers , as illustrated in figure [ large cluster broadening ] .",
    "many canonical simulations of self - assembly are performed using systems large enough to form several or many clusters @xcite .",
    "we apply the formalism of the previous sections to explore the convergence of cluster statistics on bulk values as system size is increased . for simplicity",
    "we restrict ourselves to a single monomer species , although the method could be extended to multiple particle types . as in the previous section ,",
    "we consider a reference system of @xmath57 particles in a volume @xmath0 , where @xmath57 is the size of the largest cluster , and proceed using the partition functions @xmath58 defined in this volume .",
    "let @xmath86 be a set of cluster sizes containing a total of @xmath87 particles .",
    "the statistical weight of a state with such a set of clusters is given by : @xmath88 in which @xmath89 is the number of clusters of size @xmath13 in the set @xmath86 . defining @xmath90",
    ", we obtain an expression for the fractional yield of a cluster of size @xmath91 in a system of size @xmath5 : @xmath92 in all cases that we have been able to study to high @xmath5 ( the meaning of ` high ' will be clarified later ) , @xmath93 is observed to scale as @xmath94 in the large @xmath5 limit ( see figure [ 1/d scaling ] ) .",
    "the question of convergence speed then reduces to how large @xmath5 must be for this scaling to hold , and the the value of @xmath93 at this point .",
    "in general there are two distinct regimes of convergence , determined by the yield of target structures .",
    "we shall illustrate these regimes by considering completely cooperative transitions ( in which only the target cluster and monomer concentrations are non - negligible ) , before commenting on the effects of other cluster sizes .",
    "section [ homocluster formation ] indicates that simulations of a single cluster underestimate the transition width and hence underestimate the yield of clusters at low yield . in effect , in order to have a high isolated monomer fraction in bulk despite the effects of volume fluctuations , the fraction of monomers in a single target simulation must be even higher .",
    "as the system size is increased , concentration fluctuations tend to transfer statistical weight from the extreme state favoured at @xmath6 towards a more balanced cluster size distribution .     in a system with a maximum cluster size of six .",
    "all clusters show convergence with @xmath94 scaling in the large @xmath5 regime ( as highlighted in ( b)).,width=272 ]    at low yield this effect produces a steady increase in the proportion of clusters with @xmath5 , with the deviation from the bulk fraction scaling as approximately @xmath94 from low @xmath5 ( see figure [ hexamers](a ) ) . at very low yield ,",
    "initial convergence becomes noticeably slower than @xmath94this effect increases with target size . as a consequence ,",
    "relative errors remain significant at increasingly large values of @xmath5 as the yield is decreased or the target size increased .     for ( a ) low yield ( 5% hexamers ) and ( b ) high yield ( 95% hexamers ) .",
    "the ` + ' symbols are the calculated points and the flat line the bulk value .",
    "the curve in ( a ) is a fit to a @xmath94 convergence.,width=272 ]      at high yield , single target simulations overestimate the monomer fraction , for reasons similar to the underestimate at low yield . convergence , however ,",
    "does not initially show a @xmath94 behaviour , as illustrated in figure [ hexamers](b ) . instead",
    ", a period of slow convergence is followed by a rapid drop to a target yield just below the bulk value , leading eventually to an oscillation in the vicinity of the bulk yield .",
    "these oscillations persist for approximately @xmath95 half - cycles , before settling in to a @xmath94 convergence ( @xmath57 being the target cluster size ) .",
    "these oscillations result from certain configurations disproportionately biasing the ensemble , due to the inherently discrete nature of a small system . at @xmath6 ,",
    "the system is restricted to the two states of one cluster or @xmath57 monomers . at high cluster yield ,",
    "@xmath57 monomers are extremely unfavourable and hence the single cluster state is overwhelmingly observed , causing @xmath96 to exceed @xmath97 .",
    "as the system size is increased , the zero monomer state continues to exert a disproportionate influence on the ensemble , keeping @xmath98 well above @xmath97 .",
    "eventually , however , the system becomes sufficiently large that the state with @xmath99 clusters is most favourable .",
    "due to the discreteness of the system , this occurs before @xmath100 . as a consequence ,",
    "@xmath98 is then underestimated ( or equivalently the number of monomers is overestimated ) , resulting in the observed drop of @xmath98 . at still larger values of @xmath5 ,",
    "the state with @xmath99 clusters remains most favourable but now constitutes an over estimate of @xmath98 , resulting in the observed rise in @xmath98 .",
    "this process is repeated for increasing number of monomers , leading to oscillations which are eventually overwhelmed by the @xmath94 convergence at large system size .",
    "the question is then why oscillations are observed at high but not low yield , where the discreteness of the system is still present . to answer this ,",
    "it is illuminating to allow @xmath5 to take non - integer values so that the system size @xmath101 can take any integer value . at high yield ,",
    "figure [ hexamers_2](b ) , we see that the system is extremely sensitive to the exact number of particles , because if @xmath5 is not an integer there are necessarily excess monomers .",
    "this results in the rapid oscillation of @xmath102 with a period of approximately @xmath57 .",
    "closer inspection , however , reveals that the period is longer than @xmath57 , due to the fact that states with no monomers present become increasingly unfavourable as @xmath5 gets larger .",
    "the region in which the @xmath102 peaks transfer from @xmath103 to @xmath104 corresponds to the region in which @xmath98 drops off rapidly .",
    "by contrast , @xmath102 increases monotonically with @xmath105 at low yield ( figure [ hexamers_2](a ) ) . in this regime ,",
    "the fraction of clusters is not high enough for the value of @xmath106 to be significant , and so the general tendency to transfer statistical weight to states with a greater mix of cluster sizes is dominant , and smooth convergence is observed .     for ( a ) low yield ( 5% hexamers ) and ( b ) high yield ( 95% hexamers ) .",
    "the ` + ' symbols are the calculated points and the flat line the bulk value .",
    "` x ' symbols indicate system sizes for which @xmath107 is integral .",
    "the dashed line in ( b ) is added as a guide to the eye.,width=272 ]    as a consequence of this behaviour , convergence at high cluster yield is extremely poor until @xmath5 is sufficiently large that the state with @xmath99 clusters has approximately the same weight as the state with @xmath5 clusters : @xmath108 substituting using the definition of @xmath109 gives : @xmath110 the quantity @xmath111 corresponds to the ratio of cluster to monomers at @xmath6 , and consequentially increases with @xmath57 at fixed bulk yield .",
    "this increase is offset by the @xmath112 exponent , meaning that the value of @xmath113 is relatively independent of target size , but increases with the target yield .",
    "it should also be noted that the oscillations persist until a system size of approximately @xmath114 , although they are generally reasonably small .",
    "it is this value , @xmath115 , that defines the large @xmath5 limit .    in the intermediate yield regime near to the midpoint of the transition , the initial error is small and @xmath111 is not large , hence convergence is fast ( whether it proceeds by the first or second method ) .",
    "away from the midpoint , however , significant relative discrepancies can persist to surprisingly large system sizes .",
    "an additional complication for @xmath116 is the fact that intermediate cluster sizes may be relevant to the system , which can complicate convergence .",
    "we shall analyze the effects of the presence of intermediate cluster sizes under the assumption that the majority of particles are found either as isolated monomers or in the target cluster size : for the purposes of this section , the term ` majority species ' applies to the most prevalent of either the target cluster or monomers , and ` minority species ' to the less common of these two . note that our discussions will compare the effects of intermediate cluster sizes in systems with a certain yield of the majority species , as it is the tendency of one species to dominate in bulk despite concentration fluctuations that causes the large discrepancies at @xmath6 .",
    "firstly , we shall consider the low yield case . here , the presence of clusters of intermediate sizes with bulk yields comparable to the target cluster has little effect on the relative error of the target yield at @xmath6 , which is largely determined by the bulk fraction of monomers .",
    "by contrast , if the relevant intermediate cluster size is small ( for instance a dimer in a system forming a dodecahedron ) , the relative error between dimer and isolated monomers is comparatively small , meaning that @xmath117 , because from the perspective of the monomer / dimer equilibrium the system has an effective size of @xmath118 . as a consequence , states including dimers are common and",
    "so the entropic penalty associated with having no target clusters is reduced , meaning that statistical weight is transferred to larger clusters more slowly as the system size is increased .",
    "the effect manifests itself as a poor convergence in the first few steps , as shown in figure [ dodecamer](a ) .",
    "also shown is the effect of having a significant presence of large intermediate clusters , which is smaller as they do not relieve the entropic penalty of having many monomers as swiftly as dimers do ( the relative error is seen to behave similarly to a completely cooperative system with the same monomer yield ) .",
    "we now consider the effect of significant presence of intermediate clusters on the convergence of the yield of _ isolated monomers _ at high cluster fraction .",
    "if the relevant intermediate clusters are large , the initial error is significantly reduced as the relative error between two large clusters of similar size is much smaller than for a large cluster and a monomer , and in forming intermediate clusters some monomers are ` spare ' .",
    "convergence , however , is not improved as instead of the state with @xmath99 target clusters and @xmath5 monomers coming to dominate the ensemble , as in the completely cooperative case , states containing intermediate clusters become most prevalent ( in effect , they reduce the ` entropy cost ' associated with having few monomers in the system ) . if the intermediate clusters are large , there will be few monomers in these states and as a consequence , statistical weight is transferred to isolated monomers more slowly .",
    "this effect is illustrated in figure [ dodecamer](b ) : also plotted is a case with a significant presence of small intermediate clusters . in this case convergence",
    "is not dramatically slowed ( relative to a completely cooperative system with the same target cluster yield ) , as the states which become prevalent contain @xmath99 target clusters and a mix of smaller species , including several monomers .    in summary , for monodisperse clusters ,",
    "the significant presence of intermediate cluster sizes tends to reduce the rate of convergence of the fractional yield of the minority species relative to a completely cooperative system ( at a fixed yield of the majority species ) , particularly if the relevant intermediate clusters are closer in size to the majority species , by reducing the entropic penalty associated with having few of the minority species in the system . in several cases",
    ", authors have studied systems capable of forming approximately 1020 clusters @xcite .",
    "it is probable that the finite - size effects illustrated here are relevant to these systems in the regimes dominated by one cluster size .      in previous sections we have focused on monodisperse clusters , in which we have assumed that the majority of particles are either isolated monomers or in clusters of a certain size .",
    "we now consider self - assembly of structures which , although characteristically finite , have a much larger range of sizes . in particular , many simulations have studied the formation of spherical micelles from surfactants @xcite .",
    "we apply the theory developed earlier to estimate finite size statistical corrections for a model system whose bulk distribution is reasonably reflective of models in the literature . for the purposes of this investigation",
    ", we specify a cluster size distribution ( in the bulk limit ) at the critical micelle concentration ( cmc ) , as shown in figure [ micelle distribution ] , from which we infer @xmath119 . assuming all other factors are held constant",
    ", we then adjust the total concentration , adjusting @xmath58 accordingly , and observe the convergence of cluster yields on bulk values .",
    "figure [ micelle](a ) shows the convergence of a typical micellar cluster ( 20-mers ) to its bulk yield , at a concentration at which approximately 10% of particles are in micelles . in this case",
    "there is no single target structure size , so we plot the yield as a function of @xmath105 . in this regime ,",
    "low target yield , the behaviour is very similar to that of monodisperse structures , with the fraction of 20-mers eventually converging toward the bulk value ( with a limiting form of @xmath120 ) . at this concentration ,",
    "the second most populated cluster is a dimer , and hence the initial convergence of the 20-mers is slowed as discussed in the previous section  even at a system size capable of forming four micelles , the fraction is less than half of its bulk value .",
    "figure [ micelle](b ) displays the convergence of isolated monomer fraction at a concentration when approximately 90% of particles are in micellar structures .",
    "although a large majority of the particles in the polydisperse system are in micellar structures , the polydispersity reduces the strength of the oscillations ( note : these are oscillations in @xmath121 , the equivalent of those shown in figure [ hexamers_2](b ) , not the gentler oscillations in @xmath122 as exemplified in figure [ hexamers](b ) ) as each different micelle size tends to oscillate out of phase .",
    "in addition , the large variety of micellar sizes means that no single cluster has a large fractional yield , meaning that the initial corrections are considerably smaller than in the monodisperse case . as a result , convergence is more successful for polydisperse than monodisperse clusters at high yield .    for micelles ,",
    "therefore , errors are most likely to be significant at concentrations slightly below the critical micelle concentration , particularly when dimers are the second most common aggregate .",
    "our model suggests that these errors may persist for systems containing several times the typical aggregation number of monomers , as large as some simulated systems @xcite , possibly affecting the details of cluster size distributions .",
    "given the complexity of corrections to simulations of small systems in the canonical ensemble , it would be beneficial to avoid the necessity of using them , particularly in systems where the ideality assumption is questionable , for example , if the interactions are long ranged with respect to the typical separation of unbound monomers",
    ". it would therefore be useful to have methods that can force the reversible formation of multiple targets .",
    "conventional umbrella sampling enhances sampling by incorporating a biasing potential into the simulation which encourages the system to pass through transition states that would otherwise be improbable .",
    "the biasing potential is a function of a fixed number of ` reaction coordinates ' : generally collective coordinates which describe the pathway of a transition .",
    "we propose extending the umbrella sampling technique to a variable number of dimensions to allow formation of several targets .",
    "let us assume that we have an unambiguous way of defining which monomers in our system constitute a cluster . in this case",
    ", we can define a biasing potential @xmath123 , which is a function of the number of monomers in the cluster , @xmath57 , and the coordinates of those monomers , @xmath124 .",
    "we then introduce the total biasing potential , @xmath125 where the sum is over all clusters and which is used to bias sampling according to the factor @xmath126 .",
    "@xmath123 can be chosen by iteration analogously to conventional umbrella sampling , in order to favour transition states for each cluster .",
    "as the number of clusters in a given simulation is variable , the dimension of the effective ` reaction coordinate ' is variable .",
    "for this reason it is not appropriate to record states in a histogram according to their reaction coordinate , and so unbiasing must be performed on - the - fly .    to demonstrate the utility of the variable dimensional umbrella sampling scheme , we apply it to the simulation of the dna model used in section [ heterodimer microscopic ] . for a system of eight strands , each of eight bases ( four strands of one type and four of its complement )",
    ", we compare the convergence of the estimated bonding fraction in unbiased canonical simulations to that using variable dimensional umbrella sampling with a @xmath123 optimized by hand ( in this case @xmath127 was simply a function of the number of base pair contacts ) .",
    "the results , shown in figure [ variable dimensional umbrella ] , indicate a significant improvement in convergence over unbiased sampling , and this advantage is likely to increase significantly for longer dna strands",
    ".     convergence of ( a ) the average ratio of dimers to monomers and ( b ) the error in the logarithm of this ratio in simulations of dna self - assembly .",
    "each simulation was performed on a system of eight strands each eight bases long and the results are averaged over 10 independent simulations . the results from simulations using the variable dimensional umbrella sampling scheme ( biased ) are compared to standard unbiased simulations . the flat line in ( a ) indicates the true equilibrium value ( calculated through additional independent simulations ) . , width=272 ]    umbrella sampling , by its nature , increases the sampling of states which are not strongly represented in the ensemble  in the case of our dna model , this corresponds to partially bound double strands . in conventional umbrella sampling ,",
    "biasing potentials are often chosen to sample all points along the reaction coordinate with equal probability .",
    "if @xmath128 is chosen the same way , applying the scheme to a large system will result in the vast majority of states sampled involving several intermediate states : physically relevant states will be sampled rarely . to sample the physical states",
    ", one must reduce the biasing of the intermediate states , which seems to contradict somewhat the original purpose of the umbrella potential .    for a small system",
    ", however , a compromise is possible .",
    "@xmath128 can be chosen to favour intermediate states , but not so strongly that they are as likely as the physically relevant states .",
    "if this is done , transitions between the physically important states will be accelerated and they will also be sampled with reasonable frequency . as such , an appropriate use of the technique would be on a small system in the grand canonical ensemble , similar to the study of pool and bolhuis @xcite , but in this case encouraging the formation of multiple clusters .",
    "if the simulation volume contains approximately one cluster on average , the total number of clusters simulated will remain small enough that the physically relevant states can be sampled frequently and efficiently , whilst also providing statistics which are directly applicable to bulk .",
    "we should note that , although this variable dimensional umbrella sampling scheme can accelerate the sampling of systems with multiple targets , it is not practical to use it with umbrella potentials which require several simulation windows .",
    "this restriction thus limits the complexity of the system to which it can be applied .",
    "we have demonstrated the cause of deviations from bulk statistics in finite size simulations in the canonical ensemble , and devised a method for estimating and correcting them under the assumption that species behave ideally . as simulation size is increased , fractional yields are found to converge in qualitatively different ways depending on the type of cluster which is most prevalent in the system : in general converging in a smoother fashion at low target structure yield , and oscillating at high yield .",
    "we also find that the discrepancies increase with distance from the midpoint of the transition .",
    "this study has highlighted a particular reason to be wary of statistical finite size effects . as the convergence of abundances to their bulk values is strongly dependent on the yield of clusters ,",
    "it is not sufficient to estimate finite size effects at one set of conditions and assume they apply at another  all regimes of interest must be checked .    in answer to our original question of how best to compute the thermodynamics of systems that self - assemble into finite - sized objects , where possible , we recommend performing simulations in the grand canonical ensemble ( where the correct concentration fluctuations are naturally generated ) or using a system large enough for the errors associated with the canonical ensemble ( as estimated by our prescription ) to be negligible .",
    "however , such an approach requires that the reversible formation of multiple assembled structures is feasible on the available computational time scales . for instances where this is not the case due to the large free energy barriers associated with assembly ,",
    "an efficient alternative is to utilize a rare - event method such as umbrella sampling to simulate the assembly of a single target in the canonical ensemble , and then to apply the corrections outlined in the current paper to obtain the bulk yield .",
    "for example , this is the approach we have taken for the numerous melting point calculations that were required in the development and testing of our recent coarse - grained model for dna @xcite .",
    "finally , the proposed extension to the umbrella sampling scheme which individually weights each cluster as it appears in the simulation has been shown to aid the reversible formation of multiple target structures .",
    "this scheme could be used to test the approximations of ideality inherent in the finite - size corrections by performing canonical simulations where increasing numbers of target structures can be formed .",
    "it could also be particularly useful to aid sampling in grand canonical simulations in cases where free energy barriers make equilibrium otherwise difficult to achieve ."
  ],
  "abstract_text": [
    "<S> for systems that self assemble into finite - sized objects , it is sometimes convenient to compute the thermodynamics for a small system where a single assembly can form . </S>",
    "<S> however , we show that in the canonical ensemble the use of small systems can lead to significant finite - size effects due to the suppression of concentration fluctuations . </S>",
    "<S> we introduce methods to estimate the bulk - yields from simulations of small systems and to follow the convergence of yields with system size , under the assumptions that the various species behave ideally . </S>",
    "<S> we also propose an extension to the umbrella sampling technique that allows the formation of multiple finite - sized objects . </S>"
  ]
}