{
  "article_text": [
    "metascope is able to accurately analyze millions of sequencing reads in minutes .",
    "the metascope pipeline takes a file of sequencing reads in fastq or fasta format as input and produces a report file in xml format as output .",
    "the input file represents an host - associated metagenome sample and the aim of metascope is to determine the taxonomic and functional content of the non - host portion of the sample . for each organism detected in the input file",
    ", the report file contains an estimation of its relative amount , the list of all reads assigned to the organism and the list of all genes identified for the organism .",
    "the metascope pipeline ( see figure  [ pipeline - fig ] ) is invoked using the command metascope _",
    "platform reads work output_. the four arguments specify the sequencing platform ( one of illumina , 454 , iontorrent or pacbio ) , an input file containing all reads in fastq format , a sample - specific working directory where intermediate files are to be placed , and the name of the output file .",
    "in addition , any part of the pipeline can be run individually with more control over programming parameters .",
    "first , the program sass is used to compare all reads in the input file against the host genome .",
    "all detected alignments between reads and the host genome are written to a file called host.m8 .",
    "second , a script called triage uses the alignments in host.m8 to count the host reads and to write all non - host reads to a file called non-host.fq .",
    "third , sass compares the set of all non - host reads against genbank .",
    "all found alignments are written to a file called metagenome.m8 .",
    "the number of reads and host reads , and the file of all metagenome alignments are provided as input to the metascope analyzer , which produces the final metascope report output.xml in xml format .",
    "the main computational bottleneck in metagenome analysis is the comparison of the reads against a host database , in the case of a host - associated sample , and then against a comprehensive collection of bacterial and viral sequences , such as genbank@xcite . to address this problem in an efficient manner",
    ", metascope introduces a new sequence alignment tool called sass ( an acronym for `` sequence alignment using spaced seeds '' ) .",
    "sass is written in c++ and uses seqan@xcite and boost@xcite .",
    "designed to target significant alignments with a bit score of at least 50 , sass aligns dna sequencing reads at about 50 - 100 times the speed of discontiguous megablast@xcite . like blast , sass attempts to exhaustively determine all significant alignments , which is crucial for accurate taxonomic analysis .",
    "fast pairwise alignment programs usually follow the seed - and - extend paradigm@xcite . in this two - phase approach ,",
    "first one searches for exact matches of small parts of the query sequence in the reference database , such seed matches are evaluated and those deemed promising are then followed up in an extend phase that aims at computing a full alignment .",
    "existing approaches typically employ an index data structure for the reference database in order to quickly compute all seed matches between the query sequence and the reference .",
    "for example , bowtie2@xcite and bwa@xcite use a compressed fm - index , which is very memory efficient , but at the expense of a slower access time .",
    "in contrast , sass uses a hash table , which requires more memory , but is much faster .",
    "the high speed of the index allows sass to achieve high speed and good sensitivity even when aligning low quality reads such as produced by pacbio and ion torrent sequencers .",
    "most aligners employ a simple seed shape that consists of a short word of consecutive positions .",
    "the choice of seed length is based on a trade - off between sensitivity and speed .",
    "a hash table index permits the use of spaced seeds .",
    "these are longer seeds in which only a subset of positions are used ( see , as figure  [ seed - figure ] ) .",
    "the number and exact layout of the utilized positions are called the weight and shape of the spaced seed , respectively .",
    "spaced seeds are known to perform better than simple seeds in terms of the speed / sensitivity trade - off@xcite . by default",
    ", sass uses a single spaced seed , 111110111011110110111111@xcite .        to sustain the high throughput achieved in the seeding phase",
    ", we attempt to avoid unnecessary smith - waterman computations in the extension phase . to this end",
    ", we evaluate seed matches using a modified version of myers bit vector algorithm for approximate string matching@xcite , which computes the edit distance between two short patterns encoded in machine words using fast bit - parallel operations . starting from the location of a seed match",
    ", an alignment is extended in both directions by block - wise invocation of myers algorithm in conjunction with a termination criterion based on the score gain .",
    "tentative scores are calculated that approximate the full blast score .",
    "a full banded smith - waterman alignment@xcite is only performed on the 100 ( by default ) best tentative alignments for a read , thus producing accurate standardized blast alignment scores for them .    in the case of a host - associated sample , the first step is to identify all reads that come from the host organism . to address this ,",
    "sass is used to compare all reads against the host genome . for human",
    ", we used assembly release crch37 downloaded from ncbi in june 2013 .",
    "the output of sass is written to a file called host.m8 . to reduce the running time of this calculation , here we compute",
    "only the approximated score for any alignment and do not perform a full smith - waterman calculation . based on the host alignments detected in the previous step ,",
    "a simple perl script called triage is then used to determine all reads that do not have a significant alignment to the host genome and only these reads are considered in the downstream analysis . here , an alignment is considered significant if it has an expected score of less than @xmath3 .",
    "these reads are placed in a file called non-host.fq .",
    "an additional file , counts.txt is generated that contain the total number of reads and the number of reads that have a significant alignment to the host genome .",
    "then sass is used to compare all non - host reads reads ( contained in non-host.fq ) against a large portion of genbank ( consisting of all bacterial , viral , phage and synthetic sequences ) , downloaded from ncbi in june 2013 .",
    "the resulting alignments are placed in a file called metagenome.m8 .",
    "sass uses two different indices for genbank , depending on the quality and quantity of the sequencing reads . for high quality and high quantity input samples sass uses an index that is optimized for speed ( using longer seeds ) whereas for samples of lesser sequencing quality and smaller size",
    ", sass uses an index that is optimized for sensitivity ( using shorter seeds ) .    the files counts.txt and metagenome.m8 form the basis of metascope s taxonomy and gene content analysis , as described in the following sections .",
    "the number of reads and host reads , and the file of all metagenome alignments obtained using sass are provided as input to the metascope analyzer , a perl script that produces the final metascope report output.xml in xml format .",
    "the analyzer uses three criteria to decide which alignments are deemed significant and all non - significant alignments are ignored in all subsequent analysis steps .",
    "the first criterion is a minimum alignment bit score ( option minscore , default is 50 ) .",
    "second , for each read we only consider alignments that have maximal bit score , or that are within @xmath4 of the top score , where @xmath5 is set by a user option called @xmath6 .",
    "the third criterion , which is only applied to illumina reads , aims at ensuring that a significant alignment covers a large proportion of the corresponding read .",
    "because the quality of an illumina read tends to degrade toward the end of the read , we calculate the proportion of read covered as alignment length divided by `` covered prefix length '' , where the latter is the length of the prefix of the read up to the last base that is covered by the alignment . in more detail ,",
    "an alignment must fulfill @xmath7 to be deemed significant , where @xmath8 and @xmath9 are the alignment start and end position on the read and minover is a user - specified parameter ( default is @xmath10 ) .    [ [ weighted - lca ] ] weighted lca + + + + + + + + + + + +    the assignment of reads to taxa based on a set of alignments to a reference database is often performed using the naive lca algorithm@xcite in which a read is placed on the lowest - common ancestor of all taxa in the ncbi taxonomy for which the read has a high - scoring alignment to a corresponding sequence in the reference database .",
    "this approach is quite conservative and does not work well when there are multiple closely related references in the database , as these will move the assignment to higher level on the phylogenetic tree .    to overcome this , metascope uses a new weighted lca algorithm that proceeds in two rounds . in the first round",
    ", the naive lca is applied to all reads . during this process , each reference sequence",
    "is assigned a weight that is the number of reads that have a significant alignment to that reference sequence and for which the naive lca assigns the read to the same species that the reference sequence has .",
    "reference sequences that are not assigned a weight in this way are assigned weight  @xmath11 .    in the second round ,",
    "each read is then assigned to the lowest taxonomic node that lies above a fixed proportion ( user parameter lca default value @xmath10 ) of the sum of weights of reference sequences to which the read has a significant alignment .",
    "the lowest rank that we consider here is that of species .",
    "reads that are assigned to a sub - species or strain are moved up to the species level .    to address the problem of over - aggressive taxa assignment , for each assigned taxa node , we calculate and report the average alignment identity between the reads assigned to this node and the reference sequences . if the average identity is below 90% for a species level taxa node , a low_identity tag is reported in the xml output to indicate that a species - level assignment might be too aggressive .",
    "[ [ strain - level - assignment ] ] strain level assignment + + + + + + + + + + + + + + + + + + + + + + +    our implementation of the weighted lca assigns reads down to the level of species , but not further .",
    "if the user requests strain - level analysis ( option strain ) then the analyzer proceeds as follows . for each read that is assigned to a species node",
    ", we consider all alignments whose bit score are within @xmath5 percent of the best score for the read , where @xmath5 is determined by a user parameter strain_top ( default value 10% ) .",
    "if a significant proportion ( controlled by a user parameter strain_lca , default 80% ) of the best alignments agree on a strain and these alignments have high sequence identity ( controlled by parameter strain_iden , default 95% ) , then the read is tentatively assigned to that strain .",
    "a strain is reported , if a significant proportion ( controlled by parameter strain_report , default 80% ) of the reads previously assigned to the species are tentatively assigned to the strain .",
    "[ [ gene - prediction ] ] gene prediction + + + + + + + + + + + + + + +    to decide which genes to report for a given read , metascope produces two separate lists of all genes that are partially covered by an alignment of the read .",
    "the first list is ranked by descending weight of reference sequence ( as described above ) and the second is ranked by descending coverage of genes ( that is , by the number of bases of the gene covered by any significant alignment of any read ) . by default , metascope reports the top five genes ( user parameter maxgene ) from each of the two ranked lists .",
    "[ [ data - source ] ] data source + + + + + + + + + + +    all supporting data for metascope were downloaded from ncbi .",
    "the urls for the data source are as follows :    * human genome data : ftp://ftp.ncbi.nlm.nih.gov/genomes/h_sapiens/ * genbank data in asn.1 format : ftp://ftp.ncbi.nih.gov/ncbi-asn1/ * genbank data in genbank format : ftp://ftp.ncbi.nih.gov/genbank/ * taxonomy data : ftp://ftp.ncbi.nlm.nih.gov/pub/taxonomy/    [ [ masking - human - like - reference - sequences ] ] masking human - like reference sequences + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    because virus and synthetic constructs often contain human sequences , we decided to mask all human - like regions in those sequences in our working version of the genbank microbial database . to do this , we built a sass index for the human genome reference in sensitive mode ( sass option index - mode 2 ) .",
    "all virus and synthetic construct sequences were then shredded into 100bp fragments with 50bp overlap .",
    "we used sass to align the shredded sequences against the human reference . if a shredded sequence aligned to the human genome with an alignment of 50 bases or more , and at least 80% identity , then the source region of the shredded sequence covered by the alignment was masked by replacing all nucleotides by n s .",
    "[ [ data - preprocessing ] ] data preprocessing + + + + + + + + + + + + + + + + + +    dna sequences were first extracted from genbank asn.1 data .",
    "only sequences under genbank bct , vrl , phg , and syn sections were included .",
    "the four sections cover all genbank sequences from bacteria , archaea , virus , phage , and synthetic constructs .",
    "a mapping of gi numbers to ncbi taxon identifiers was extracted from the genbank asn.1 files .",
    "we also extracted taxonomic lineage information for each reference sequence from these files , rather than from the ncbi taxonomy dump file because only the asn.1 files contain the correctly labeled strain description of reference sequences .",
    "the ncbi taxonomy file was used to complement the asn.1-derived taxonomy data .",
    "information on protein coding regions , such as location , protein accession number , locus tag , description , was extracted from the genbank flat files .",
    "the set of scripts used to download process all reference data is distributed in the ` aux ` folder of the metascope package .",
    "the output of different sequencing platforms varies in three main aspects , namely the number of reads produced , the average read length and the sequence quality .",
    "individual illumina datasets usually consist of millions of reads with a read length of hundreds of base pairs .",
    "roche-454 datasets usually have less than one million reads , with a read length approaching 1000 bp .",
    "ion torrent datasets contain hundreds of thousands of reads , hundreds of base pairs long , with a lower level of quality than the afore mentioned datasets .",
    "finally , pacbio datasets are usually smaller yet , with read lengths of thousands of base pairs , with a very high level of errors .    .default platform - specific settings used by metascope",
    ". [ cols=\"^,^,^,^\",options=\"header \" , ]     to address these differences , metascope uses slightly different parameter settings depending on which sequencing platform was used to generate the input ( see supplement table  [ settings - table ] ) . for datasets with higher error rates and smaller size , the pipeline uses sass sensitive genbank index so as to improve the detection of significant alignments in the presence of sequencing errors .",
    "moreover , in the taxonomic analysis of such data , the pipeline employs a relaxed lca with a top setting of 10% so as to help avoid unreliable placement of reads for pacbio data , but 5% for other platforms .",
    "because illumina datasets usually contain millions of reads , here a even small sequence error rate can lead to a large number of wrongly assigned reads .",
    "hence , for illumina we use a minover setting of 0.9 to ensure that significant alignments cover at least 90% of the high quality end of a read .",
    "the metascope parameters employed in the dtra challenge differ slightly from the default settings recommended in table  [ settings - table ] due to the specific nature of the dtra testing datasets .",
    "their metagenomic reads appeared to have originated from organisms whose genome sequences are well represented in genbank and thus they usually have a top - scoring alignment to the correct species ( but also to many others ) .",
    "in this situation , we were able to set top to @xmath12 for all sequencing technologies except for pacbio , were @xmath13 was used to accommodate for the high rate of sequencing errors in pacbio data .",
    "the default value for the maxgene parameter ( that controls the number of genes reported per read ) is @xmath14 , as this value works well on all dtra challenge datasets .",
    "however , for the dtra challenge roche-454 datasets we used a value of @xmath11 so has to achieve a particularly high gene score so as to compensate for low organisms scores on the roche-454 test datasets .",
    "this research is partially supported by the national research foundation and ministry of education singapore under its research centre of excellence programme .",
    "all authors contributed equally to the development and implementation of the described software ."
  ],
  "abstract_text": [
    "<S> metascope is a fast and accurate tool for analyzing ( host - associated ) metagenome datasets . </S>",
    "<S> sequence alignment of reads against the host genome ( if requested ) and against microbial genbank is performed using a new dna aligner called sass . </S>",
    "<S> the output of sass is processed so as to assign all microbial reads to taxa and genes , using a new weighted version of the lca algorithm . </S>",
    "<S> metascope is the winner of the 2013 dtra software challenge entitled `` identify organisms from a stream of dna sequences '' .    </S>",
    "<S> department of computer science and center for bioinformatics , university of tbingen , sand 14 , 72076 tbingen , germany    life sciences institute , national university of singapore , # 05 - 02 28 , medical drive singapore 117456 singapore    human longevity incorp . </S>",
    "<S> , singapore    metagenomics is the study of microbes using dna sequencing@xcite . </S>",
    "<S> one major area of application is the human microbiome@xcite with the aim of understanding the interplay between human - associated microbes and disease </S>",
    "<S> . other areas of metagenomic research include water@xcite , waste - water treatment@xcite , soil@xcite and ancient pathogens@xcite . </S>",
    "<S> another envisioned area of application metagenomics is in bio - threat detection , for example , when a group of individuals becomes infected by an unknown agent and the goal is to quickly and reliably determine the identity of the pathogens involved .    in 2013 the defense threat reduction agency ( dtra ) </S>",
    "<S> sponsored an algorithms competition entitled `` identify organisms from a stream of dna sequences '' with a one million dollar prize . </S>",
    "<S> proposed solutions `` must generate equivalent identification and characterization performance regardless of the sequencing technology used '' and ``  must achieve this in a timeline that is substantively shorter than possible with currently available techniques . '' </S>",
    "<S> the challenge provided nine test datasets for analysis and proposed results were scored based on the correctness of organisms identified ( organisms score ) , reads assigned ( reads score ) and genes identified ( genes score ) . </S>",
    "<S> this paper describes the winning entry .    </S>",
    "<S> such analysis requires the comparison of a large number of sequencing reads ( typically millions of reads ) against a large reference database ( typically many billions of nucleotides or amino acids ) . </S>",
    "<S> hence , tools that address this type of problem must be very fast . </S>",
    "<S> because current reference databases only represent a small fraction of the sequence diversity that exists in the environment@xcite , such tools must also be very sensitive .    </S>",
    "<S> metascope performs very fast and very accurate analysis of metagenome datasets , including the removal of host reads , if required . </S>",
    "<S> metascope employs a new fast and sensitive dna aligner called sass . </S>",
    "<S> the aligner is first used to compare a given set of metagenomic sequencing reads against a host genome , if available , so as to discard reads that probably come from the host genome . </S>",
    "<S> the remaining reads are then compared against microbial genbank@xcite using sass . </S>",
    "<S> a second program called analyzer processes the output of sass and maps the reads to taxa and genes using a novel variant of the lca algorithm@xcite . </S>",
    "<S> the output is written in xml and can , for example , be loaded into the metagenome analysis program megan@xcite for further processing .    like blast@xcite , sass uses a seed - and - extend approach to alignment . to achieve both high speed and high accuracy , sass uses spaced seeds@xcite , a hash - table for seed lookup and is implemented as a parallel algorithm in c++@xcite . </S>",
    "<S> a crucial heuristic decision is when to extend a given seed match so as to compute a full alignment . </S>",
    "<S> sass uses myers bit vector algorithm@xcite and a gain - based termination criterion to decide this . in the context of host - genome filtering , </S>",
    "<S> the score obtained in this way is used as a proxy for the full local alignment score and the extension phase is not used .    </S>",
    "<S> removal of all reads that align to the host genome does not completely resolve the problem of false positive taxon assignments because many viruses and vector sequences in genbank contain human sequences . </S>",
    "<S> hence , in a preprocessing step , we use sass to compare the viral and vector portion of genbank against the human genome and then mask every region of the reference sequences that has a significant alignment to some host sequence .    the assignment of reads is often performed using the naive lca algorithm@xcite in which a read is placed on the lowest - common ancestor of all taxa in the ncbi taxonomy for which the read has a high - scoring alignment to a corresponding sequence in the reference database . </S>",
    "<S> as the naive lca algorithm analyses each read in isolation , in the presence of many similar reference sequences from different species , the result is often very unspecific placement of reads . to overcome this , </S>",
    "<S> metascope uses a new weighted lca algorithm that proceeds in two steps . </S>",
    "<S> first , the naive lca algorithm is used to assign a weight to each reference sequence , reflecting the number of reads that are assigned to the corresponding species and have a significant alignment to that reference sequence . </S>",
    "<S> then each read is placed on the taxon node that covers 75% ( by default ) of the total weight of all reference sequences that have a significant alignment with the read .    </S>",
    "<S> metascope predicts genes based on which annotated genes the alignments of a read overlap with . </S>",
    "<S> a read will often align to many different reference sequences and so the potential number of genes to report for a single read can be quite large , containing many false positives . to address this , </S>",
    "<S> all genes that are partially overlapped by some alignment of a read are ranked by the weight of the corresponding reference sequence and by the proportion of the gene sequence covered by any reads , and a small number of top ranked genes are reported .    </S>",
    "<S> the results obtained by metascope on the nine dtra datasets are listed in table  [ results - table ] . </S>",
    "<S> slightly different algorithmic parameters are used based on the different sequencing platforms , as described in the materials section . </S>",
    "<S> the accuracy score ranges from @xmath0 and the run time ranges from @xmath1 to @xmath2 minutes per dataset .    </S>",
    "<S> ll*8c ( 1 ) & ( 2 ) & ( 3 ) & ( 4 ) & ( 5 ) & ( 6 ) & ( 7 ) & ( 8) & ( 9 ) & ( 10 ) + name & sequencing & number & average & seq . & </S>",
    "<S> total & org . </S>",
    "<S> & reads & genes & time + & platform & of reads & length & acc . & score & score & score & score & ( mins ) +    testing1 & pacbio & 92948 & 1883 & 83 & 90.074 & 100 & 85 & 85 & 7:48 + testing2 & pacbio & 98323 & 1837 & 83 & 98.747 & 100 & 98 & 98 & 8:24 + testing3 & ion - torrent & 379028 & 160 & 98 & 91.949 & 85 & 93 & 96 & 6:28 + testing4 & roche-454 & 399671 & 363 & 99 & 91.595 & 75 & 99 & 99 & 6:47 + testing5 & illumina & 5550655 & 150 & 100 & 91.538 & 93 & 99 & 82 & 6:14 + testing6 & illumina & 6038557 & 150 & 100 & 95.357 & 100 & 100 & 86 & 7:27 + testing7 & ion - torrent & 323028 & 159 & 98 & 92.258 & 83 & 99 & 94 & 4:20 + testing8 & roche-454 & 351799 & 263 & 99 & 96.843 & 100 & 100 & 90 & 4:49 + testing10 & illumina & 6164558 & 151 & 100 & 97.803 & 100 & 100 & 93 & 12:10 +    we have also investigated the use of an intermediate assembly step ( except for pacbio reads ) . in more detail , all reads that did not align to the host genome ( human ) were presented to the newbler assembler@xcite as input . </S>",
    "<S> the obtained contigs and all unassembled reads were aligned against microbial genbank using sass . </S>",
    "<S> the output of this was then processed as described above and all assembled reads inherited the taxon assignment of their containing contigs . </S>",
    "<S> the results produced by this approach scored equally high as those reported in table  [ results - table ] , but not better , so we did not pursue this further .    </S>",
    "<S> we plan to make metascope freely available from http://www.metascope.net . </S>"
  ]
}