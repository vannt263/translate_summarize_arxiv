{
  "article_text": [
    "recent galaxy surveys like 2df ( colless & al.2003 ) or sdss ( gott & al . 2005 ) emphasized the complexity of the matter distribution in the universe which presents large scale structures such as filaments , clusters or walls on the boundaries of low density bubbles ( voids ) . on the theoretical side , the currently favoured scenario suggests that the universe evolved from gaussian initial conditions to form the structures that are observed nowadays .",
    "numerical simulations have successfully both statistically and visually , captured the main features of the observed filamentary distribution .",
    "novikov , colombi & dore 2005 ( ncd ) introduced the skeleton formalism in 2d , which aims at extracting and analysing the filamentary structure of a given density field .",
    "this paper extends it to three dimensions in order to describe the universe s large scale matter distribution and its dynamical environment . in the literature ,",
    "various steps towards a quantitative description of the large structures have been suggested .",
    "statistical tools such as correlation functions ( e.g. , peebles 1980 ) and power spectra ( e.g. peacock 1998 ) have been widely used and have been successful in describing matter distribution and constraining cosmological parameter . recently",
    ", fast algorithms have been designed for first and second order ( szapudi & al . 2005 ) , as well as higher order statistics ( counts in cells etc .. ) as in ( croton & al .",
    "2004 ) or ( kulkarni & al . 2007 ) .",
    "minkowski functionals ( see , e.g. , kerscher 2000 for a review ) are so - called `` shape finders '' ( sahni & al .",
    "1998 ) attempt instead to describe the topology of a distribution ( see ( sheth & sahni 2005 ) for application to large scale structure ) and can discriminate between gaussian and non gaussian fields as shown in ( doroshkevich & al . 1970 ) , ( gott & al . 1986 ) or more recently ( hikage & al . 2006 ) ) .",
    "these topological and statistical estimators analyse the distribution of observed galaxies globally and uniformly , and make little attempt at recovering the precise geometry of the matter distribution , i.e. they do not focus on specific regions ( such as clumps , voids and filaments ) .    focusing on the identifiable regions of the universe , the peak patches theory ( bond & myers 1996 ) attempts to describe cosmic structures formation through the identification of the collapse of the dense regions near the density peak and surrounding patches . in this framework",
    ", the evolution of patches hierarchy can be understood from the measurement of only a few characteristics of the patches , while assuming that their flow does not depend on their internal non - linear dynamics .",
    "this line of thought has been extended in the cosmic web paradigm ( bond , kofman , pogosyan , 1996 ) , which has emphasized that the large scale spatial distribution of galaxy clusters and the filaments between them can be understood as mildly non - linear enhancement of high density peaks and filamentary ridges present in the initial gaussian density field .",
    "recently , hanami ( 2001 ) presented the so - called skeleton tree formalism : it analyses the process of hierarchical merging and extends the language of the peak patch through the analysis of the ridges of the density field in an abstract space corresponding to the usual three dimensions augmented by the smoothing length .",
    "the structure of voids in the large scale dark matter distribution also has an extended history of theoretical modeling ( see e.g. hoffman & shaham 1982 , icke 1984 or bertschinger 1985 ) while various void identifiers have been designed ( see e.g. platen 2007 and references therein ) .",
    "one of the first attempts to develop an algorithm to detect and trace the filaments in the particle distribution has been the minimal spanning tree ( mst ) technique proposed by doroshkevich in ( doroshkevich & al 1970 , barrow & al 1985 ) .",
    "starting from a point distribution ( a galaxy survey or a dark matter simulation ) , this method constructs the graph that connects all the dots with the property of never forming closed paths and being of minimal total lengths .",
    "interesting statistical features can be extracted from it like the shape of the clusters or the length of the trunk ( the longest path ) and branches which are characteristic of the filamentarity of the distribution .",
    "+ the three - dimensional skeleton described in this paper focuses on the critical lines of a distribution , i.e. the set of lines joining the critical points in order to be able to compute the characteristic features of the underlying field ( such as the total length of the filaments in a cosmological dark matter distribution ) .",
    "the skeleton provides a simple mathematical definition of the filaments of a density field based on morse theory ( see , e.g. , milnor 1963 ; colombi , pogosyan & souradeep 2000 ; jost 2002 , novikov et al .",
    "2006 ) and thus allows their extraction as well as their characterisation .",
    "section 2 defines the local skeleton of large scale structures .",
    "section  3 introduces the numerical algorithm for constructing the local skeleton , and discusses its properties near the critical points ( appendix a gives a more detailed description of the algorithm ) .",
    "section  4 investigates the evolution of its differential and total length as a function of the properties of the underlying field .",
    "appendix c sketches the derivation of this differential length .",
    "possible applications to cosmology and galaxy formation are discussed in section  5 , where two illustrations regarding the nature of the dark matter flow near the skeleton are given .",
    "a comprehensive definition of the skeleton and how its local approximation in two dimensions is derived can be found in novikov , colombi & dore 2006 . to sum up , the so - called `` real '' skeleton is by definition the subset of critical lines joining the saddle points of a field to its maxima while following the gradient s direction ( while critical lines link _ all _ kinds of critical points together ) . it is easy to picture that applying this definition to a 2d field ( an altitude map in a mountainous region for instance ) allows the extraction of the ridges of that distribution .",
    "although simple in appearance , this definition presents the drawback that it is in essence non - local : the presence of the skeleton in a given sub - region may depend on the presence of a saddle point in a different sub - region . in order to enforce locality ,",
    "an approximation can in fact be derived using taylor expansion in the vicinity of the critical points ( i.e. local maxima and saddle points ) , leading to a second order approximation of the skeleton : the local skeleton .",
    "defining the _ local critical lines _ as the set of points where the gradient of the field is an extremum along an isodensity contour , it can be shown ( novikov , colombi & dore 2006 ) that this set of points obeys the equation : @xmath7 ^ 2 - \\left[\\frac{\\partial        \\rho}{\\partial r_1 } \\right]^2    \\right)=0 ,    \\label{eq:2dsdef}\\end{aligned}\\ ] ] where @xmath8 and @xmath9 denote space coordinates and @xmath10 is the density field .",
    "equation  ( [ eq:2dsdef ] ) can be rewritten @xmath11 where @xmath12 is the hessian ( second derivatives matrix ) of the field .",
    "this can be interpreted mathematically as the set of points where the gradient of the field is an eigenvector of the hessian ( that is , gradient and main curvature axis are aligned ) , which is clearly a local property of the field .",
    "+ however , in order to correspond to the `` real '' skeleton that traces the ridges and clumps of the field ( its structure ) , another condition has to be enforced . for its local approximation ,",
    "it is equivalent to stating that the gradient should be _ minimal _ ( every point of the local skeleton of coordinates @xmath13 should also be a local minimum of the isodensity contour at density @xmath14 ) .",
    "that is , one has to enforce the condition that the second eigenvalue of the hessian should be negative : @xmath15{./iscontour_final }    \\caption{definition of the coordinate system on an isocontour . }",
    "\\label{fig : conecut } \\end{figure }    let us now derive the generalization of the notion of   the local skeleton to a three - dimensional space .",
    "the philosophy is essentially the same but minor differences arise which are addressed here .",
    "starting from the same definition as in 2d , the   skeleton should be the set of points where the density is an extremum along an isodensity contour .",
    "let $ ( u , v)$ be a coordinate system along an isocontour $ \\left(r_1\\left(u , v\\right),r_2\\left(u , v\\right),r_3\\left(u , v\\right)\\right)$ where $ r_i , i\\in\\lbrace1 .. 3\\rbrace$ are the three space coordinates .",
    "the   definition of an isocontour implies that : \\begin{equation }    \\left\\lbrace    \\displaystyle\\begin{array}{l }    \\displaystyle\\frac{\\partial \\rho}{\\partial r_1 } \\frac{d r_1}{d u } +     \\frac{\\partial \\rho}{\\partial r_2 } \\frac{d r_2}{d u } +     \\frac{\\partial \\rho}{\\partial r_3 } \\frac{d r_3}{d u } = 0\\ , \\\\ \\",
    "\\displaystyle\\\\    \\displaystyle\\frac{\\partial \\rho}{\\partial r_1 } \\frac{d r_1}{d v } +    \\frac{\\partial \\rho}{\\partial r_2 } \\frac{d r_2}{d v } +     \\frac{\\partial \\rho}{\\partial r_3 } \\frac{d r_3}{d v } = 0.\\ ,    \\end{array }    \\right .",
    "\\label{eq:3disocontour } \\ee    moreover , as the gradient of the field $ \\rho$ has to be an extremum : \\begin{equation }    \\begin{array}{l }       \\displaystyle\\frac{d}{du}(|\\nabla \\rho|^2)=0\\ , , \\quad { \\rm and}\\quad            \\displaystyle\\frac{d}{dv}(|\\nabla \\rho|^2)=0    \\end{array}.    \\label{eq:3dgradnull}\\ ] ] using equations  ( [ eq:3disocontour ] ) and ( [ eq:3dgradnull ] ) , let us derive the equation of the local critical lines , which should only depend on the field and its first and second order spatial derivatives , similarly to equation  ( [ eq:2dsdef ] ) .",
    "to do so , a coordinate system along the isocontour is needed but , as opposed to the 2d case , any coordinate system defined on an isocontour will be singular in some place as the isocontour is a closed surface . in order to avoid this problem , we choose to define three coordinates systems and swap from one to another when it becomes singular .",
    "+ defining @xmath16 three one - dimensional coordinates systems so that for different values of @xmath16 , one remains in the plane @xmath17 where @xmath18 and @xmath19 .",
    "the coordinates system @xmath16 is singular wherever @xmath20 .",
    "the constrain is to satisfy equations .",
    "( [ eq:3disocontour ] ) and ( [ eq:3dgradnull ] ) for @xmath21 and @xmath22 with @xmath23 . for any @xmath16 ,",
    "these read : @xmath24 choosing @xmath25 , this system becomes after some algebra : @xmath26 indeed , equation ( [ eq:3dsi ] ) reduces equation ( [ eq:2dsdef ] ) in the 2d case , when assuming that the field is constant in the direction orthogonal to that 2d plane ( the first two terms of equation ( [ eq:3dsi ] ) are the same as in equation  ( [ eq:2dsdef ] ) ) .",
    "the local critical lines are thus the set of points that satisfies : @xmath27 it is interesting to note that , as in the 2d case , equation ( [ eq:3ds_0 ] ) defines the local critical line as the set of points where the gradient of the density is an eigenvector of its hessian matrix ( the gradient and the principal curvature axis are collinear ) : @xmath28 once again , in order to require that the skeleton traces only the ridges of the distribution ( i.e. the filaments in 3d ) , retrieving the subset of local critical lines that define the local skeleton can be achieved by enforcing a negativity condition on the weakest eigenvalues of the hessian : @xmath29 that is , the local skeleton is the subset of the local critical where the norm of the 3d gradient is minimal along the 2d isodensity contours ( as opposed to simply extremal ) .",
    "note that from equation  ( [ eq:3ds_0 ] ) it is straightforward to show that any monotonic function of the field will have exactly the same skeleton as the field itself .",
    "equation  ( [ eq:3ds_0 ] ) is at the basis of the numerical implementation of the local skeleton determination developed here .",
    "the details of the algorithm are described in appendix a , while the optimal choice of resolution and smoothing is presented in appendix b. all the computations were performed using a specially developed ` c ` package : * ` skelex ` * ( * skel*eton * ex*tractor ) .",
    "this package also includes a flexible opengl visualization tool that was used for making the figures in this paper .",
    "+ figure [ fig : skl3d ] presents the skeleton obtained for a density field sampled from a numerical simulation of dark matter distribution on a @xmath30mpc box with @xmath31 particles using gadget-2 ( springel 2005 ) .",
    "the lighter colors represent denser regions and the blue skeleton appears to match quite well what one could identify as the filaments by eye .",
    "note that the skeleton is both a tracer of the topology ( it links a sub - set of the critical points ) and the geometry of its underlying density .",
    "hence it can be used to compare the geometrical and topological properties of various fields , e.g. the temperature and the dark matter distribution in hydro - dynamical simulations .",
    "see also figure  a3 for a graphical description of how the local skeleton is drawn .",
    "+    [ fig_courbure3d ]    let us now describe some global branching properties of the critical lines and the local skeleton .",
    "important ingredients of the skeleton are the extrema of the field .",
    "indeed , the `` real skeleton '' is defined as a set of critical lines that connect maxima to saddle points .",
    "much of the topological behaviour of the skeleton is related to the distribution of such extremal points .",
    "for the _ local _ skeleton described this paper , the role of the extrema is similar but the whole set of critical lines encompass aditionnal branches linking all kind of field extrema together .",
    "+ since the local skeleton is based on a local second order approximation of the density field , @xmath32 , its properties can be understood through the properties of the gradient @xmath1 and hessian matrix @xmath33 only .",
    "the eigenvalues of @xmath2 define the local curvature at any point , thus separating space into distinct regions depending on the sign of these eigenvalues @xmath34 . within a 3d space , as by definition @xmath35 if @xmath36 , there exist four of these regions",
    ". let @xmath37 be the number of negative eigenvalues , then the regions where @xmath37 is equal to 0 , 1 , 2 and 3 .",
    "this classification applies to critical points of the field in particular , where @xmath38 , the maxima ( @xmath39 ) and minima ( @xmath40 ) existing within local clumps and voids respectively , while two types of saddle points can be distinguished : the filaments type saddle points ( for @xmath41 ) and the pancake type ones ( for @xmath42 ) .",
    "+ figure [ fig_courbure3d ] illustrates a second order approximation of the density field in the vicinity of the field extrema .",
    "the total set of critical lines form a fully connected path linking all the critical points together and exactly six branches pass through each of them in the direction of the three eigenvectors of the hessian . empirically",
    ", it is possible to picture the typical behavior of the whole set of critical lines . defining @xmath43 and considering a given critical point where @xmath44 , if @xmath45 , this critical point @xmath46 is usually linked to three other pairs of critical points @xmath47 , @xmath48 and @xmath49 ( where @xmath50 , @xmath51 and @xmath52 respectively ) by critical lines aligned with eigenvectors associated to eigenvalues @xmath53 , @xmath54 and @xmath55 respectively at point @xmath46 .",
    "most of the time , each of these branches connect to critical point @xmath47 , @xmath48 and @xmath49 along the eigenvector associated with eigenvalue @xmath53 , @xmath54 and @xmath55 respectively , evaluated at points @xmath47 , @xmath48 and @xmath49 respectively . in this picture , the critical lines can be seen as a fully connected path linking all the different regions defined by the sign of the eigenvalues of @xmath2 . + the overdense filamentary structure correspond to the subset of the critical lines that constitute an approximation of the `` real '' skeleton ( i.e. the `` ridges '' of the distribution ) .",
    "this part is the one which links maxima ( @xmath39 ) and filamentary saddle points ( @xmath41 ) .",
    "the typical behaviour of such lines is the following : in the immediate vicinity of a non - degenerate maximum , two branches of the skeleton exist , stretching in the eigendirection that corresponds to @xmath53 .",
    "following one of the branches , denoting as @xmath56 an eigenvalue whose eigenvector is parallel to the skeleton and @xmath57 as two eigenvalues associated to eigenvectors in the perpendicular directions .",
    "near the maximum , @xmath58 .",
    "as one follows a branch one probable outcome is the change of sign of @xmath56 , in which case the branch will typically end in a saddle point of a filamentary type along its @xmath53 direction .",
    "there is always another branch that starts from this saddle point on the other side , thus this type of branches have a fully connected structure .",
    "however , another possible outcome is that one of the orthogonal eigenvalues changes faster than @xmath56 as one moves away from the maximum and becomes positive before the saddle point is reached . in this case",
    "the branch of the local skeleton formally terminates , which however in reality often means that the skeleton splits at this point in two new branches .",
    "+ such branching of the skeleton is especially frequent near the maxima of the field , where it accounts for how multiple filamentary sections can end up in a single dark matter halo .",
    "studiing how skeleton segments merge is relevant for questions such as the multipole structure of matter inflow onto dark halos ( aubert , pichon & colombi 2004 , pichon & aubert 2006 ) .",
    "this property of skeleton segments to end outside of the critical points is specific to the local definition of the skeleton , in contrast to the `` real '' skeleton whose segments are always connected on both ends .",
    "before considering general cosmological density fields , the local skeleton of scale free gaussian random fields @xmath32 with null average value @xmath59 will be investigated . for convenience , it is useful to define some spectral parameters that depend on the spectral index @xmath4 and on the smoothing length . in the statistical description of the skeleton of a random density field ( appendix c ) ,",
    "the following spectral parameters appear to play a role : @xmath60 this introduces three linear scales into the skeleton theory @xmath61 where the first two have a well - known meaning of typical separation between zero - crossing of the field @xmath62 and mean distance between extrema , @xmath63 ( bardeen & al .",
    "1986 ) , while the third one , @xmath64 is , by analogy , the typical distance between the inflection points .",
    "out of three scales two dimensionless ratios may be constructed that are intrinsic parameters of the theory @xmath65 where @xmath66 says how frequent encountering a maximum between two zero crossings of the field is , while @xmath67 describes , on average , how many inflection points are between two extrema . for gaussian fields",
    ", these parameters can be easily calculated from the power spectrum .",
    "both @xmath66 and @xmath67 range from zero up to one . for reference ,",
    "for the power - law spectra with index @xmath68 , smoothed at small scales with a gaussian window , @xmath69 note that cosmologically relevant density power spectra have @xmath68 and thus , while @xmath66 can attain low values , @xmath70 are always close to unity .",
    "appendix  c introduces a statistical description of the skeleton for the gaussian and non gaussian random field .",
    "this section presents the numerical measurements of the properties of the skeleton for scale free gaussian fields .",
    "the first quantity of interest is the total length of the skeleton , @xmath71 . in the context of cosmology",
    ", @xmath71 can be linked to the total length of the filaments linking clusters together and in that sense reflects the history of matter accretion as well as the initial distribution of matter ( which is supposed to be similar to a gaussian random field with a scale - dependent effective spectral index similar to the ones considered here ) .",
    "figure [ fig : len ] presents the result of the measurement of the total length @xmath71 of the skeleton per unit box size as a function of the spectral index and for different smoothing lengths @xmath72 ( within the range of validity of the algorithm as described in appendix b ) .",
    "these measurements are carried over @xmath73 realisations of scale free @xmath74 gaussian random fields as a function of the spectral index @xmath4 .",
    "the sensitivity of the skeleton to the value of the spectral index is clear on this plot and , if @xmath71 appears to be a linear function of the spectral index , it is also clear that it grows as a power law of the smoothing length .",
    "the dotted lines on figure [ fig : len ] shows the result of such a fit of the data and seems to work very well . a very good approximation of @xmath71 per unit box size is thus given by the function : @xmath75    as expected , the exponent of @xmath72 is measured to be exactly @xmath76 .",
    "it can be proved with a simple argument that this should be the case for scale free gaussian fields .",
    "in fact , for such fields , computing the skeleton over a grid of volume @xmath77 and smoothed on a scale @xmath72 is equivalent to computing the skeleton on a grid of volume @xmath78 while smoothing on a scale @xmath79 and rescaling the result by a factor @xmath80 . because of the scale invariance , we also have @xmath81 and so @xmath82 .     of the skeleton per unit box size for different smoothing lengths",
    "@xmath83 ; measured over @xmath73 realisations of gaussian random fields as a function of the spectral index @xmath4 . while @xmath84 depends linearly on the spectral index @xmath4 , it grows as a power of @xmath72 .",
    "the dotted lines represent the fits obtained using the function : @xmath85 . [",
    "fig : len],width=302 ]    interestingly , the dependence on the spectral index @xmath4 is close to @xmath86 which argues for filaments being relatively straight between extrema , see appendix  c. a visual examination of the filaments confirms this picture .",
    "now consider the differential length of the skeleton , @xmath87 where @xmath88 is the normalized density contrast .",
    "this quantity represents the expected length of skeleton that can be measured in a given distribution between density contrasts @xmath89 and @xmath90 .",
    "figure [ fig : diflen ] shows the normalized function @xmath87 as a function of the normalized density contrast @xmath89 from which was subtracted the probability distribution function ( pdf ) of the field ( which , within the range of sampling and finite volume effects approximations , is a gaussian function ) .",
    "these values were also averaged over @xmath73 realisations of gaussian fields with spectral index @xmath91 sampled on @xmath92 pixel grids and for a smoothing length @xmath93 .",
    "this value was chosen as a compromise between finite volume effect and differentiability of the field on a grid discussed in appendix  [ chap : slen ] .",
    "considering the error bars , it is clear that the value of @xmath87 is directly linked to the spectral index @xmath4 .",
    "it is shown in appendix  c that @xmath87 can be written using an edgeworth expansion ( see also novikov , colombi & dore 2005 for the corresponding proof and fit in 2d ) : @xmath94 where @xmath71 is the total length of the skeleton , @xmath95 and @xmath96 are hermitte polynomials .",
    "figure  4 demonstrates that this expansion also works very well in the 3d case .",
    "remarkably , equation  ( [ eq : fitdldn ] ) does not depend on @xmath67 which again argues for the picture of a stiff behaviour of the skeleton for cosmological scale invariant density fields ( see appendix  c ) .",
    "table [ tab1 ] presents the values of the first three coefficients @xmath97 obtained by fitting the measurements presented in figure [ fig : diflen ] ( the dotted line of figure [ fig : diflen ] are the result of these fits ) .",
    "not only does equation  ( [ eq : fitdldn ] ) allows a very good fit of the measured data , but it also appears that only the first order term is non - null and the differential length of the skeleton of a gaussian random field with spectral parameter @xmath66 is thus given by :    @xmath98    the only non - null coefficients in the expansion are thus @xmath95 and @xmath99 , to be contrasted to @xmath100 in the 2d case .",
    "equation  ( [ eq : fitdldn_val ] ) can be used as a test of non gaussianity like any other topological estimator , such as the genus , the pdf etc ... as discussed in novikov et al.(2006 ) , since departure from the shape of equation  ( [ eq : fitdldn_val ] ) must appear when the skeleton s differential length is computed while the underlying field is not gaussian .     as a function of the density contrast @xmath101 .",
    "each curve represents the average value and variance of the measured value of @xmath102 over @xmath73 different realisations of scale - free gaussian fields , for different values of the spectral index @xmath91 .",
    "the dotted curves represent the estimation obtained by fitting data using equation  ( [ eq : fitdldn ] ) ( see table [ tab1 ] for values of the parameters ) .",
    "[ fig : diflen],width=321 ]    .measured values of the first three non - null terms in the edgeworth expansion , equation  ( [ eq : fitdldn ] ) , for three different values of the spectral index @xmath91 .",
    "these results are obtained by fitting equation  ( [ eq : fitdldn ] ) on the data presented in figure [ fig : diflen ] on which the dotted lines represent the fitted function .",
    "the measurements show very good agreement , whatever the value of @xmath4.[tab1 ] [ cols=\"^,^,^,^\",options=\"header \" , ]     for the matter distribution in the universe , the filaments are overdense regions along which matter flows . in that sense , they are less subject to numerical or observational noise and contain most of the information about the underlying matter distribution .",
    "the skeleton length can thus be seen as a method for measuring the power spectrum which naturally weights information in different regions according to their importance .",
    "drawing the skeleton allows us to pin down the nature of the flow around the filaments .",
    "indeed one may roughtly define three dynamically distinct regions in large - scale structures : voids , clusters and filaments .",
    "the first two have been investigated in some detail .",
    "the filaments represent a fairly unexplored venue . beyond the kinematics ( velocity distribution , spin , etc . ) , the photometric and spectroscopic properties of galaxies ( colour , age , metallicity etc .. ) , their morphology ( ellipticals versus spirals , gini number , asymmetry ) or the igm ( gas temperature , whim detection , fraction of gas / metals in the filaments etc .. ) , could also be investigated as a function of the distance to , and along the filaments . in this section , two examples simply illustrate how the skeleton can be used to explore the environment of filaments in cosmological simulations .",
    "+    figure [ fig : pdf ] displays probability distribution functions ( pdf ) of different characteristics of the dark matter flow along the skeleton . in order to understand the correlations between the filaments and the velocity field , we computed the pdf of its angle relative to the skeleton as a function of its intensity ( top panels ) , and the pdf of the angle between its largest eigenvector and the skeleton as a function of the norm of the corresponding eigenvalue ( bottom panels ) .",
    "these measurements were achieved by first sampling the field characteristics on a grid , averaging particles velocities @xmath103 and dispersion tensor , @xmath104 over each cell , and then computing for each segment the distance - weighted average of their pdf . left and right panels yield the resulting pdf computed in a @xmath105 and @xmath106 mpc dark matter standard @xmath107cdm model simulation respectively , at redshift @xmath108 and using @xmath31 particles . in both cases ,",
    "the density and velocity fields where sampled on a @xmath31 pixels grid and smoothed over @xmath109 pixels ( i.e. @xmath110 mpc and @xmath111 mpc respectively ) .",
    "the skeleton segments being oriented in the direction of increasing density , an angle of @xmath112 means that dark matter is flowing along the filament in the direction of higher density regions .",
    "+ the flows appears to be laminar and its amplitude increases with scale : this is expected since on larger scales the clusters are more massive , the potential difference is larger , hence the flow towards them is faster .",
    "most dark matter particles have a mean velocity of about @xmath113 ( resp .",
    "400 ) km / s along the filament and a dispersion of about 100 ( resp .",
    "150 ) km / s orthogonal to the filaments for the two scales considered here .",
    "the angular spread ( panels  [ fig : vel1p2]-[fig : vel12 ] ) also increases with scale , from about @xmath114 to about @xmath115 , reflecting the larger internal heat of the filament , also seen in ( panels  [ fig : disp1p2]-[fig : disp12 ] ) .",
    "+ the qualitative shape of this pdf may be explained by the advection of new halos onto the `` highways '' corresponding to the mean flow .",
    "the first eigenvector of the dispersion tensor is on average clearly orthogonal to the filament , reflecting the velocity of dark matter falling onto the filaments .",
    "note that the distribution is decreasing monotonously with @xmath116 in panel  [ fig : vel1p2 ] : some dark matter particles statistically even move downhill , and their relative fraction decreases with scale . the filaments",
    "are collecting matter away from the underdense regions .",
    "smaller filaments empty smaller voids , which tend to get depleted earlier than larger ones ; hence this may explain why the flow becomes more orderly at smaller scale as accretion diminishes .",
    "+ note that the redshift evolution ( not shown here ) of this distribution follows closely its scale evolution , the @xmath117 pdf over @xmath118 mpc resembling the @xmath108 pdf over @xmath119 mpc @xcite .",
    "+ the detailed nature of the flow should eventually be investigated in a smoothing scale independent manner , in order to derive universal features which would only depend on the cosmology and the initial power spectrum .",
    "its evolution with redshift or with the cosmology should also be systematically analysed .",
    "the geometric orientation of the spin of dark matter halos corresponds to another feature of the large scale structure which can be characterized using the skeleton .",
    "the spin of dark halos was computed using the classical friend - of - friend ( fof ) algorithm with 0.2 times the interparticular distance as linking length and retaining only halos containing more than 100 particles .",
    "figure  [ fig : spin ] displays the excess probability of alignment of the halos spins with the closest skeleton segment for different distances @xmath120 $ ] , @xmath121 $ ] , @xmath122 $ ] and @xmath123 h^{-1}$ ] mpc .",
    "this probability reaches 25 % for an angle @xmath124 between the spin and the skeleton : the spin of dark matter halos is preferentially orthogonal to the filament they belong to .",
    "this trend accounts for the fact that the filaments are the locus of laminar flow where halos coalesce along the direction of the filaments parallel to the mean flow , hence acquiring momentum orthogonal to the flow , as observed in ( aubert , pichon & colombi 2004 ) .",
    "@xmath125 mpc @xmath107cdm simulations at different distances : @xmath126 ,   [ 500,1500],[1500,2500]$ ] and @xmath127 h^{-1}$ ] kpc from the closest skeleton segments .",
    "this figure demonstrates that on average the spin of dark matter halos tends to be orthogonal to the local filaments at a level of 25 % for distances shorter than 500 kpc .",
    "the simulation is analysed at redshift zero .",
    "[ fig : spin ] , width=302 ]",
    "the 3d skeleton formalism is a well - defined framework for studying the filamentary structure of a distribution .",
    "the``real '' skeleton is defined as the set of critical lines joining saddle points to maxima of the field along the gradient .",
    "a local approximation of it was introduced in section [ sec:3dskl ] along with a numerical method allowing a fast retrieval of the locus of the filaments from a sampled field ( see also appendix [ imple ] ) .",
    "this method involves computing the null isodensity surfaces of each component of a function @xmath128 of the gradient , @xmath1 , and hessian matrix , @xmath2 of this field .",
    "+ the ability to localize and characterize the filamentary structure of matter distribution in the universe opens the prospect of many applications for the skeleton as discussed in section  4 and 5 .",
    "it has been shown in section [ sec : gauss ] that for a gaussian random field , the total length of the skeleton per unit volume depended only of the chosen smoothing length @xmath72 and spectral index @xmath4 , with a specific functional from which was both fitted from simulations and motivated in appendix  c. in this sense , the local skeleton provides a direct measurement of the local shape of the power spectrum , @xmath129 , on various scales depending on the smoothing applied to the underlying field .",
    "though there exist other ways to measure the power spectrum of a given distribution , the skeleton length is promising as it relies only on the filamentary structure of the distribution .",
    "the analysis of the length of the skeleton of the galaxy distribution in the sdss as a measurement of cosmological parameter @xmath130 can be found in @xcite .",
    "+ the skeleton may also be used as an isotropy probe .",
    "it corresponds in fact to a good candidate for the alcock - paczynski @xcite test , since the apparent longitudinal to transverse length of skeleton segments should directly constrain the curvature of space in a manner which is bias - independent .",
    "this test will be presented in a forthcoming letter @xcite .",
    "+ it was demonstrated in section  4 that the dark matter flow in the vicinity of filaments was dominantly laminar along the filaments and shows signs of orthogonal accretion corresponding to the infall of dark matter collected from the voids .",
    "it also showed that the spin of dark matter halos were preferentially orthogonal to the filament s direction , a feature which can be understood as a consequence of merger events taking place along these filaments . a clear virtue of the local skeleton is that since it relies on a local expansion of the field , it can deal with truncated / masked fields , segmented or vanishing ridges or isolated structures .",
    "note finally that the fit , equation [ eq : fitdldn_val ] , opens the prospect of using the local skeleton to estimate the bias in observed surveys .",
    "the idea is to compute the pdf of galaxies on the one hand , which depends on the mass to light ratio of the sample , and the differential length ( equation  ( [ eq : fitdldn_val ] ) ) on the other hand .",
    "since the former depends on the bias , whereas the later does not , comparing the two should give an estimate of the bias . on the other hand",
    ", the local formulation of the skeleton presents some limitations .",
    "mainly , it is not fully connected : it has by construction ( since it is drawn from a second order taylor expansion of the field ) only 2 segments per maxima whereas full connection would require 3 or more .",
    "a consequence is that it can not represent merging filaments .",
    "+ one could also use the curvature and torsion of filaments as cosmological probes , since the acceleration of the universe induced by the cosmological constant is likely to straighten the filaments , though the fact that the local skeleton has only two segments near its maxima ( the other segments must branch out ) is likely to introduce some artifacts .",
    "the topology and geometry of the skeleton near the density peaks and the redshift evolution of the skeleton of the large scale structures may prove of interest , for instance to study the frequency of reconnection , though again the local skeleton is not ideal in this respect . it would also be interesting to construct the skeleton in higher dimensions , for instance in space - time , to trace the events lines , but",
    "again connection is critical . in a forthcoming paper , an alternative algorithm for the indentification of the skeleton , loosely based on a least action formulation ,",
    "will be presented .",
    "it is complementary to the solution presented in this paper and will allow us to tackle those points for which the local skeleton is less efficient .",
    "finally , the 3d skeleton algorithm could possibly be applied to other fields of research , such as neurology , in order to trace the neural network .",
    "we thank hlne courtois , d.  aubert and simon prunet for comments and d.  munro for freely distributing his yorick programming language and opengl interface ( available at _ http://yorick.sourceforge.net/_ ) .",
    "this work was carried within the framework of the horizon project , ` www.projet-horizon.fr ` .",
    "alcock c. , paczynski b. , 1979 , natur , 281 , 358 aubert , d. , & pichon , c.  2007 , , 374 , 877 aubert , d. , pichon , c. & colombi , s.  2004 , , 352 , 376a bardeen , j. m. , bond , j. r. , kaiser , n. , szalay , a. s. , 1986 , apj 304 , 15 ( bbks ) barrow , j. d. , bhavsar , s. p. , sonoda , d. h. , mnras 216 , 17 bertschinger e. , 1985 , apjs , 58 , 1 bond , j. r. , kofman , l. a. , pogosyan , d , 1996 , nature , 380 , 63 .",
    "bond , j. r. , myers , s. t. , 1996a , apjs 103 , 1 bond , j. r. , myers , s. t. , 1996b , apjs 103 , 41 colless , m. , et al .",
    "2003 , arxiv astrophysics e - prints , arxiv : astro - ph/0306581 colombi , s. , pogosyan , d. , souradeep , t. , 2000 , phys .",
    "85 , 5515 croton , d.  j. , et al .",
    "2004 , , 352 , 1232 doroshkevich , a. g. , 1970 , astrofizica , 6 , 581 [ astrophysics 6 , 320 ] doroshkevich , a. g. , tucker , d. l. , lin , h. , turchaninov , v. , fong , r. , 2001 , mnras 322 , 369 gott , j. r. iii , melott , a. l. , dickinson , m. , 1986 , apj 306 , 341 gott , j.r.i . ,",
    "juri , m. , schlegel , d. , hoyle , f. , vogeley , m. , tegmark , m. , bahcall , n. , brinkmann , j. , 2005 , , 624 , 463 hanami , h , 2001 , mnras , v 327 , pp 721 - 738 hikage , c. , komatsu , e. , & matsubara , t.  2006 , , 653 , 11 hoffman , y. , & shaham , j.  1982 , , 262 , l23 icke , v. , 1984 , mnras , 206 , 1 jost , j. , 2002 , riemannian geometry and geometric analysis ( springer , third edition ) kerscher , m. , 2000 , lecture notes in physics 554 , 36 kulkarni , g.  v. , nichol , r.  c. , sheth , r.  k. , seo , h .- j . , eisenstein , d.  j. , & gray , a.   2007 , , 378 , 1196 lorensen , william and harvey e. cline .",
    "marching cubes : a high resolution 3d surface construction algorithm .",
    "computer graphics ( siggraph 87 proceedings ) 21(4 ) july 1987 , p. 163",
    "- 170 ) milnor , j. , 1963 , morse theory ( princeton university , princeton , nj ) novikov , d. , colombi , s. , & dor , o.  2006 , , 366 , 1201 peacock john .",
    "cosmological physics cambridge astrophysics .",
    "peebles , p. j. e. , 1980 , the large - scale structure of the universe ( princeton univ . press , 1980 )",
    "pichon , c. , sousbie , t. prunet , s. , courtois , h. , colombi , s. , devrient , j. _ in preparation _ pichon , c. , & aubert , d.  2006 , , 368 , 1657 platen , e. , van de weygaert , r. , & jones , b.  j.  t.  2007 , arxiv e - prints , 706 , arxiv:0706.2788 sahni , v. , sathyaprakash , b. s. , shandarin , s. f. , 1998 , apj 495 , sheth , j.  v. , & sahni , v.  2005 , arxiv astrophysics e - prints , arxiv : astro - ph/0502105 springel , v.  2005 , , 364 , 1105 szapudi , i. , pan , j. , prunet , s. , & budavri , t.  2005 , , 631 , l1 sousbie , t. , phd thesis , 2006 .",
    "sousbie , t. , pichon , c. , courtois , h. , colombi , s. novikov , d. submitted to apjlett .",
    "( arxiv : astro - ph/0602628 )",
    "all the computations were performed using a specially developed ` c ` package : * ` skelex ` * ( * skel*eton * ex*tractor ) .",
    "this package also includes a flexible opengl visualization tool that was used for making the figures in this paper .",
    "+ the first step before computing the skeleton requires obtaining a density field from a discrete point - like distribution .",
    "this is achieved by smoothing appropriately the density field on a grid so that it is not singular ( i.e. is sufficiently differentiable ) but still contains all the topological information .",
    "the density field is computed using cloud - in - cell ( cic ) interpolation ( e.g. , r.w .",
    "hockney 1988 ) and convolving the result with gaussian windows of different widths .",
    "as was shown in section [ chap : slen ] , the grid size and smoothing length are decisive parameters .",
    "it is then necessary to compute first and second derivatives of the field on the grid , which can be done using finite difference or fourier transform method , giving very similar results .",
    "in fact choosing one method or the other does not seem to have any influence on the resulting skeleton if the field is smooth enough ( which is anyway a necessary condition ) .",
    "+ the next step involves solving the system of equations  ( [ eq:3ds_0 ] ) ; the solution of this system corresponding to the intersection of two of the three solutions of equations  ( [ eq:3dsi ] ) .",
    "this is done by computing the 3d meshes of the two - dimensional surfaces that are solution to these equations : the skeleton is at the intersection of two of them , depending on the value of the gradient at the point considered . solving equation  ( [ eq:3dsi ] ) is equivalent to finding the null isocontour of field @xmath131 , which can be done using the marching cube algorithm @xcite .",
    "the basic idea is to consider every cell of the grid as an individual cube .",
    "one can then compute the value of every @xmath131 for the eight vertices and it is easy to check whether the isosurface intersects the cube or not .",
    "in fact , every vertex is above or below a threshold value ( in this case @xmath132 ) , which gives a total of @xmath133 types of intersections ( only 15 of them being instrinsically different ) that can be precomputed as illustrated in figure [ fig : mc_config ] .",
    "the exact positions of the intersections are computed using quadratic interpolation .",
    "this yields the position of the intersections of the grid and the isocontour , and defines triangles that smartly link those intersection vertices : one can then reconstruct a very good approximation of what the isocontour is .",
    "+     and isocontour @xmath134 , a blue ball represents a vertex where @xmath135 .",
    "it is then easy to build the isocontour by linearly interpolating the value of @xmath136 along the edges .",
    "this picture was borrowed from james sharman s website , http://www.exaflop.org/docs/marchcubes/ind.html , width=302 ]    which surfaces should be used for each cell is decided by computing @xmath137 and selecting only the two @xmath138 for which @xmath139 is maximal .",
    "this gives two surfaces defined by triangles whose intersection can be efficiently computed : it amounts to computing the intersection of triangle pairs only .",
    "it is then straightforward to compute the eigenvalue of the hessian for every segment and keep or reject them depending on the previously defined criteria ( equation  ( [ eq : eigselect3d ] ) ) in order to draw the _ local _ skeleton .",
    "the exact same method was used for efficiently and consistently finding the extrema and saddle points of the field .",
    "in fact , if one defines three fields @xmath140 , those critical points are the intersections of the three isocontour surfaces @xmath141 .",
    "one can then decide if a critical point is a maximum , minimum or saddle point by checking the value of eigenvalues of the hessian ( i.e. curvature ) .",
    "although marching cubes algorithm are very efficient for computing isodensity contour , they present some drawbacks for ambiguous configurations . indeed , as illustrated on figure [ fig : singular ] , some configurations are degenerate and one can not decide where the isosurface should pass .",
    "this problem happens most of the time around critical points where the value of the field can go above and below the threshold within one cell .",
    "it induces the loss a small skeleton segments .    ) and the light blue line is the resulting skeleton .",
    "the red diamond represent a field maximum .",
    "it is clear on this picture that the algorithm misses the part close to that maximum , thus creating a spurious hole in the skeleton.,width=302 ]    in order to obtain a smooth skeleton that does not present holes and to retrieve connectivity information ( i.e. to be able to follow the skeleton from one point to another ) , a three steps post - processing is applied .",
    "there is of course some arbitrariness in this process : here the algorithm is based on a weighted marking system to achieve this result ( where the weights are assigned depending on the relative importance of the selection criteria ) : ( i ) the branches that were missed around the extrema are regenerated using the fact that the skeleton around an extremum is along the main curvature axis ( i.e. along the first eigenvector of the hessian ) .",
    "so for each extremum , marks are given to all skeleton segment , favoring those at small distances and with similar orientation as the main eigenvector of @xmath2 .",
    "each extremum is eventually connected to the segment with the highest mark .",
    "( ii ) the gaps between segments in the sequence of skeleton branches are filled .",
    "starting from segments connected to extrema , all segments are visited iteratively : for the running segment , a mark is now assigned to all other unprocessed segments , based upon their relative distance , their relative angle , and relative orientation .",
    "note that the corresponding cost functions are non linear : for instance segments with too large a relative angle are given an exponentially negative mark .",
    "( iii ) finally , all segments which have not been considered during step ( ii ) are dropped .",
    "the resulting skeleton is shown on figure [ fig : skl3d ] . a detailed accounting of all stages of the skeleton extraction , including the post treatment is given in @xcite ( which gives the exact marking scheme described above ) , while the code is available upon request from the authors .",
    "+ from a performance point of view , this method presents the advantage of being both fast and robust .",
    "the computational cost in fact mainly scales as the number of pixels in grid @xmath142 ; the cost of computing the iso surfaces intersections is neglectible given the possibility of computing only the intersections of faces belonging to the same pixel .",
    "it is moreover memory - efficient and can be trivially parallelized : the computation can be done on sub grid regions and then merged . on a modern computer , the memory requirement corresponds to the requirement to store one sub - grid and its three isosurface , which can be arbitrarily small , and the computational time for a @xmath143 pixels grid is of the order of a few seconds on a modern desktop computer while only a few tens of minutes is necessary for a grid of @xmath144 pixels .     +",
    "( see eq . [ eq : gammadef ] ) for @xmath73 realisations of gaussian random fields with spectral index @xmath145 ( red crosses ) , @xmath146 ( green triangles ) and @xmath146 ( blue discs ) as a function of the smoothing scale @xmath72 expressed in box size units .",
    "the three continuous lines represent the expected theoretical values , measured by integrating the power spectrum truncated to grid limit frequencies .",
    "the dotted lines are the theoretical expectations ( equation  ( [ eq : thegamm ] ) ) without accounting for finite volume effects . for higher values of @xmath72 ,",
    "the finite box size effects have more influence and the measured value of @xmath66 tends to differ from the correct one , thus limiting the maximal smoothing scale _ bottom _ : evolution of the measured length of the total skeleton in box size units as a function of the smoothing length in pixels @xmath147 , for different values of the spectral index @xmath4 and while keeping the smoothing scale to a constant fraction of the box size @xmath148 .",
    "the measurements are obtained by resampling one initial realisation of a gaussian random field ( genrerated over a @xmath92 pixels grid ) on smaller resolution grids and smoothing the resulting fields over the appropriate number of pixels .",
    "the measured length of the total skeleton appears to become stable for values of @xmath147 above a limit of @xmath149 to @xmath150 pixels at least , which corresponds to @xmath151 for a field sampled on a @xmath92 pixels grid.[fig : smoothtest ] [ fig : gamma],title=\"fig:\",width=264 ]   ( see eq .",
    "[ eq : gammadef ] ) for @xmath73 realisations of gaussian random fields with spectral index @xmath145 ( red crosses ) , @xmath146 ( green triangles ) and @xmath146 ( blue discs ) as a function of the smoothing scale @xmath72 expressed in box size units .",
    "the three continuous lines represent the expected theoretical values , measured by integrating the power spectrum truncated to grid limit frequencies .",
    "the dotted lines are the theoretical expectations ( equation  ( [ eq : thegamm ] ) ) without accounting for finite volume effects . for higher values of @xmath72 ,",
    "the finite box size effects have more influence and the measured value of @xmath66 tends to differ from the correct one , thus limiting the maximal smoothing scale _ bottom _ : evolution of the measured length of the total skeleton in box size units as a function of the smoothing length in pixels @xmath147 , for different values of the spectral index @xmath4 and while keeping the smoothing scale to a constant fraction of the box size @xmath148 .",
    "the measurements are obtained by resampling one initial realisation of a gaussian random field ( genrerated over a @xmath92 pixels grid ) on smaller resolution grids and smoothing the resulting fields over the appropriate number of pixels .",
    "the measured length of the total skeleton appears to become stable for values of @xmath147 above a limit of @xmath149 to @xmath150 pixels at least , which corresponds to @xmath151 for a field sampled on a @xmath92 pixels grid.[fig : smoothtest ] [ fig : gamma],title=\"fig:\",width=264 ]    one aspect of the numerical implementation that deserves special attention is the issue of smoothing . in the main text",
    ", we consider the total skeleton of gaussian random fields , focusing mainly on two of its properties : its length @xmath84 and differential length @xmath102 .",
    "the algorithm presented in this paper deals with the numerical computation of the skeleton of a discretized realization of a given field .",
    "it is thus important in the first instance to be able to deal with the influence of this discretization on the measured skeleton properties ( see e.g. colombi & al .",
    "+ the statistical properties of a scale - free gaussian random field can be described using only two numbers : its spectral index @xmath4 and the amplitude @xmath152 of its power spectrum @xmath153 , where @xmath154 is the wave number .",
    "the skeleton formalism is totally independent of the amplitude of the field , so only the value of @xmath4 is of interest to us . consider a realization of a 3d scale - free gaussian random field with spectral index @xmath4 on a @xmath142 pixel grid . in order to ensure sufficient differentiability ,",
    "this field is convolved to a gaussian kernel whose scale @xmath72 is expressed per unit box size .",
    "the value of @xmath72 limits the size of the smallest scale that can be considered , while the finite size of the grid imposes an upper limit .",
    "figure [ fig : gamma ] presents the measured value of the spectral parameter @xmath155 as a function of @xmath72 , for @xmath73 realizations of gaussian random fields with spectral index @xmath156 , together with the theoretical value , measured by integrating the power spectrum truncated to grid limit frequencies .",
    "as expected , a departure from theory is observed for higher values of @xmath72 , especially for fields with lower spectral index where most of the power is concentrated on small values of @xmath154 ( i.e. on large scales ) .",
    "this sets an upper limit on the value of the smoothing scale and so we will only be considering fields smoothed on scales @xmath157 .",
    "+ the other constraint on the value of @xmath72 arises from the fact that the skeleton computation algorithm requires a field that is continuously differentiable two times in the finite difference scheme sense .",
    "this means that the smoothing length should be large enough for the computational errors on field derivatives to be neglectible .",
    "these considerations imply a lower limit on the smoothing length value expressed in number of pixels @xmath158 . in order to estimate this limit",
    ", we again generated gaussian random fields with different spectral indices over a @xmath92 ( @xmath159 ) pixels grid and downsampled them on grids with eight different values of @xmath160 ranging from @xmath161 up to @xmath162 .",
    "figure [ fig : smoothtest ] presents the evolution of the measured skeleton length for these realisations , each of them being computed for a smoothing scale corresponding to a constant fraction of the box size @xmath148 but to different values of @xmath147 ranging from @xmath163 up to @xmath164 .",
    "one would clearly expect the length of the skeleton to depend only on the value of @xmath72 as long as the numerical approximations are neglectible , which seems to be the case only for values of @xmath147 at least of order @xmath150 pixels . for a given sampling @xmath160",
    ", this limits the possible smoothing scale to @xmath165 .",
    "as was noted previously , this exact value depends on the considered spectral index , so we chose to consider the worst case , @xmath166 , where the fluctuations of the field do not dampen on small scales thus making the field naturally not smooth on any scale .",
    "+ in this paper , all fields considered are sampled over @xmath159 cubic grids , so in order to respect the constraints described above , the fields are smoothed on scales in the range @xmath167 .",
    "to estimate the length , @xmath168 , of the local skeleton per unit volume , in this section and the estimator , @xmath84 in the main text . ]",
    "consider the vicinity of the points through which the local critical line passes , @xmath169 .",
    "( since the sets of conditions @xmath170 , @xmath171 is degenerate , without loss of generality one can assume a particular choice for @xmath172 and @xmath173 ) .",
    "define the set of points , @xmath174 , in the excursion @xmath175 near the critical line solutions that satisfy @xmath176 and @xmath177 where @xmath178 and @xmath179 are sufficiently small so that the linear expansion @xmath180 , @xmath181 holds breaks near the extrema of the field , where @xmath182 , which allows several critical lines to intersect at such points .",
    "however , extremal points are of measure zero as far as the computation of the length of the skeleton is concerned . ] .",
    "the fraction of the total volume the set @xmath183 occupies ( the filling factor ) is @xmath184 where @xmath185 is the joint probability distribution function of the quantities @xmath186 . here",
    "the seemingly redundant distribution of the gradients @xmath187 and @xmath188 was introduced to have the expression for the fraction of the total volume occupied by a differential subset of @xmath174 that has specific values of the gradients @xmath189 ( within @xmath190 and @xmath191 ) @xmath192 since the area , @xmath193 , of a section locally orthogonal to the such subset , is simply ( modulo some trigonometry ) given by @xmath194 dividing @xmath195 by @xmath193 , integrating over all possible gradients @xmath196 and then taking the limit @xmath197 yields for the skeleton length per unit volume : @xmath198 this generalizes the calculation of ncd to 3 dimensions : the length of the local skeleton is defined by the knowledge of the density field and its partial derivatives up to third order , as expected . in order to understand the scaling involved in the computation of @xmath199 , let us rewrite this equation in terms of dimensionless quantities : @xmath200 with , following @xcite , @xmath201 where @xmath202 is the power - spectrum of @xmath32 . equation  ( [ eq : defs2 ] ) and its gradient can be written more conveniently , using the totally antisymmetric tensor , @xmath203 , as @xmath204\\right)\\ , .",
    "\\label{eq : defsi}\\ ] ] indeed , expressions for @xmath205 and @xmath206 involve up to third derivatives of the field @xmath207 .",
    "all the quantities defined by eq .",
    "( [ eq : scalefr ] ) are dimensionless and their variance do not depend on spectral parameters ( they are pure numbers ) except @xmath208 .",
    "keeping that in mind , with these new notations , equation  ( [ eq : defl0 ] ) becomes @xmath209 equation  ( [ eq : myeq ] ) is the formal expression for the length per unit volume of the total set of critical lines .",
    "let us express the joint distribution function @xmath210 in terms of the joint distribution function of the underlying field and its derivatives @xmath211 . introducing the 20 components vector composed of @xmath207 and its successive partial derivatives up to third order ( see equation  [ eq : scalefr ] ) , or in dimensionless units , @xmath212",
    "( symmetries in the derivative tensors of second and third order are assumed to be exploited to reduce the effective number of variables ) , we can find @xmath213 as a marginalization over the distribution of the field values : @xmath214 which yields the appropriate 9d probability distribution .",
    "putting equation  ( [ eq : p2p ] ) into equation  ( [ eq : myeq ] ) and differentiating with respect to @xmath215 , and accounting for the two delta functions in @xmath206 and @xmath216 yields , using equation  ( [ eq : gammadef ] ) to rewrite @xmath217 in terms of @xmath64 : @xmath218 equation  ( [ eq : myeq2 ] ) is the formal expression for the differential length per unit volume of the total set of critical lines , described in the main text . given its dimensionality , it remains a daunting task to compute the 19d integral in equation   ( [ eq : myeq2 ] ) .",
    "note that @xmath219 and @xmath220 are now functions of @xmath221 and @xmath222 and @xmath223 are function of @xmath224 given by equation  ( [ eq : defsi ] ) . in equation  ( [ eq : myeq2 ] ) ,",
    "the two delta functions couple the differents @xmath225 while accounting for the fact that the integral should be restricted to the intersection of the two iso surfaces , i.e. along the critical lines .",
    "the modulus in @xmath226 reflects the fact that the summation of skeleton segments is not algebraic , which complicates also the reduction of equation  ( [ eq : myeq2 ] ) .",
    "for the set of local critical lines , there are no restriction to the region of integration .",
    "if one is interested in the local skeleton , the integration should be restricted to regions where the condition given by equation ( [ eq : eigen ] ) holds .        since a gaussian field",
    "does not correlate with its derivatives of odd orders ( this is easy to understand using symmetries in fourier space ) , the joint distribution function @xmath228 can be written as @xmath229 in @xmath230 , the only dependence on the power spectrum of the underlying field is in the parameter @xmath66 ( c.f .",
    "equation  ( [ eq : gammadef ] ) ) that describes the correlation between the field and its second derivatives .",
    "similarly @xmath231 only involves @xmath67 which describes the correlation between the gradient of the field and its third derivatives .",
    "therefore @xmath232 depends only on @xmath89 , @xmath64 @xmath66 and @xmath67 , as argued in the main text .",
    "note that by symmetry , @xmath232 should then be an even function of @xmath89 for the total set of critical lines .",
    "the total length of the skeleton , @xmath233 , which follows from marginalization of the equation  ( [ eq : myeq2 ] ) over @xmath89 may depend only on @xmath67 and @xmath64 since the integration of @xmath234 over @xmath89 cancels the dependancy over @xmath66 .",
    "the @xmath235 scaling in equation  ( [ eq : myeq2 ] ) reflects the basic fact that by definition the local skeleton is almost straight within a volume that has one inflection point @xmath236 .",
    "a straight segment through such volume has length @xmath237 , thus the expected length per unit volume is @xmath238 .",
    "the dependence on the spectral index is then @xmath239 , recalling that @xmath72 is the smoothing length in units of the total boxsize .",
    "is this the behaviour with @xmath4 that one should expect in simulations ? + let us write formally @xmath240 suppose the last term dominates statistically .",
    "then , since @xmath241 , and given that @xmath242 does not depend on the third derivative of the field ( which can then be integrated out ) , equation  ( [ eq : simple ] ) becomes @xmath243 it is easy to foresee when this regime is valid . the same argument as before implies that the @xmath244 scaling arises when the skeleton is almost straight within a volume that contains one extremum , @xmath245 .",
    "this is supported by the fact that the integral term does not depend on the third derivatives , thus inflection points play no role , and any dependence on @xmath70 drops out .",
    "this picture corresponds to a skeleton connecting extrema with relatively straight segments .",
    "the scaling is then @xmath246 .",
    "for the total length of the critical lines , integration over @xmath89 gives @xmath247 since the integral is just a pure number .",
    "this is very close to the scaling with @xmath4 that was found in the numerical fit , equation  ( [ eq : defll ] ) .",
    "the differential length in the stiff regime is then only the function of @xmath66 times @xmath248 .",
    "the upshot of this paragraph is to demonstrate the theoretical consistency between the scaling in @xmath249 of @xmath250 and the fact that @xmath251 does not depend on @xmath67 for scale free gaussian random fields .",
    "[ [ joint - distribution - of - the - field - and - its - derivatives - for - a - gaussian - random - field ] ] joint distribution of the field and its derivatives for a gaussian random field ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^    the full expression @xmath252 is given in @xcite .",
    "introducing variables @xmath253 in place of diagonal elements of the hessian @xmath254 one finds that @xmath255 are uncorrelated .",
    "importantly , the field , @xmath207 is only correlated with @xmath256 and @xmath257 where @xmath66 is the same quantity as in equation  ( [ eq : gammadef ] ) .",
    "the full expression of @xmath252 is then @xmath258 \\exp\\left[-\\frac{15}{2}({v^{2}+w^{2}+x_{12}^{2}+x_{13}^{2}+x_{23}^{2}})\\right ] dx du   dv dw dx_{12 }   dx_{13 }   dx_{23 } , \\nonumber\\end{aligned}\\ ] ] and is described by only one correlation parameter @xmath66 .",
    "a similar procedure can be performed for the joint probability of the first and third derivatives of the fields , @xmath231 by defining the following nine parameters ( see also hanami 99 ) : @xmath259 and replacing the variables @xmath260 with @xmath261 . in that case , the only cross - correlations in the vector @xmath262 which do not vanish are between the same components of the gradient and the gradient of the laplacian of the field : @xmath263 where @xmath67 is the same quantity as in equation  ( [ eq : gammadef ] ) .",
    "this allows us to write : @xmath264 \\prod_{i=1}^3 du_i dx_i   \\exp\\left[-\\frac{3(u_i -{\\tilde \\gamma } x_i)^2}{2(1-{\\tilde \\gamma}^2 ) } -\\frac{3 x_i^2}{2}\\right ]   .",
    "\\nonumber\\end{aligned}\\ ] ]      what is the dependence of the skeleton differential length on the parameter @xmath66 and the threshold @xmath89 ?",
    "let us look at the structure of the integrals involved with respect to the variable @xmath265 .",
    "importantly , the arguments of the delta functions @xmath266 and @xmath267 , given by equation  ( [ eq : simple ] ) , is @xmath268 where @xmath269 is a positive quartic in @xmath265 . puting the expressions for @xmath270 and @xmath271 into equation  ( [ eq : myeq2 ] ) imply that the @xmath265-component of the integral in @xmath232 involves @xmath272 d u\\ , , \\label{eq : core}\\ ] ] where @xmath273 , of course , also depends on @xmath274 with @xmath275 and possibly @xmath67 , but not on @xmath66 .    in the trivial limit @xmath276 the coupling between @xmath265 and the field value @xmath89 vanishes and the differential length is reduced to the pdf of @xmath89 @xmath277 = \\frac { { \\cal l}_{tot}}{(2\\pi)^{1/2 } } \\exp\\left[-\\frac{\\eta^2}{2}\\right]\\ ] ]    for nonvanishing @xmath66 , following ncd , the differentiation of equation  ( [ eq : core ] ) shows that @xmath278 obeys the equation @xmath279\\ , , \\label{eq : eqdiff}\\ ] ] whose solution involve even hermitte polynomials ( retaining only the convergent solution at large @xmath89 ) : @xmath280 \\ , .",
    "\\label{eq : core3}\\ ] ] note that @xmath281 is non null since asymptotically , the differential length should converge towards the pdf of @xmath89 , within a multiplicative constant .",
    "thanks to the orthogonality condition on the hermitte polynomial , @xmath282 is given by @xmath283 the integration of equation  ( [ eq : core3 ] ) over @xmath284 for @xmath275 ( while accounting for the rest of the integrant corresponding to @xmath271 and @xmath270 together with the two delta functions ) yields the functional form of @xmath285 , equation  ( [ eq : fitdldn ] ) , where @xmath97 is a pure number in the stiff approximation , but may depend on @xmath67 in general .",
    "this section falls short of demonstrating why only @xmath286 is non null , though the oscillatory behaviour of @xmath96 in equation  ( [ eq : defcn ] ) suggests that @xmath97 should decrease with @xmath4",
    ".    making use of the expression of @xmath271 and @xmath270 in the stiff regime ( @xmath287 ) , equation  ( [ eq : dldetastiff ] ) becomes @xmath288 du \\exp\\left[-\\frac{15}{2}({{\\hat v}^{2}[x_{kl}]+{\\hat w}^{2}[x_{kl}]+\\sum_{k <",
    "l } x_{kl}^{2})-\\frac{3}{2}\\sum_{k } x_{k}^{2}}\\right ]   \\left|\\frac{\\partial ( v , w ) } { \\partial ( { s}_{i } , { s}_{j } ) } \\right|   \\prod_{k",
    "< l }   dx_{kl }   \\prod_{k } dx_{k},\\ ] ] where @xmath289 $ ] and @xmath290 $ ] are function of @xmath291 , @xmath292 and @xmath205 and @xmath293 ( evaluated at zero to account for the two delta functions ) .",
    "the quadratic function @xmath294 corresponds to the square root of @xmath269 when @xmath295 and @xmath296 are reexpressed in terms of @xmath205 ( which are in turn evaluated at zero ) . now writing formally again @xmath297 , if the region where @xmath294 is positive dominates the above integral , the integration over @xmath265 yields @xmath298 \\exp(-\\eta^{2}/2)\\ ] ] which suggests that @xmath299 for @xmath300 .",
    "given that @xmath251 is even in @xmath89 , here @xmath301 should eventually cancel out when integrated over the other variables ."
  ],
  "abstract_text": [
    "<S> the skeleton formalism aims at extracting and quantifying the filamentary structure of the universe is generalized to 3d density fields ; a numerical method for computating a local approximation of the skeleton is presented and validated here on gaussian random fields . </S>",
    "<S> it involves solving equation @xmath0 where @xmath1 and @xmath2 are the gradient and hessian matrix of the field . </S>",
    "<S> this method manages to trace well the filamentary structure in 3d fields such as given by numerical simulations of the dark matter distribution on large scales and is insensitive to monotonic biasing . + </S>",
    "<S> two of its characteristics , namely its length and differential length , are analyzed for gaussian random fields . </S>",
    "<S> its differential length per unit normalized density contrast scales like the pdf of the underlying density contrast times the total length times a quadratic edgeworth correction involving the square of the spectral parameter . </S>",
    "<S> the total length scales like the inverse square smoothing length , with a scaling factor given by @xmath3 where @xmath4 is the power index of the underlying field . </S>",
    "<S> this dependency implies that the total length can be used to constrain the shape of the underlying power spectrum , hence the cosmology . </S>",
    "<S> + possible applications of the skeleton to galaxy formation and cosmology are discussed . as an illustration , </S>",
    "<S> the orientation of the spin of dark halos and the orientation of the flow near the skeleton is computed for dark matter simulations . </S>",
    "<S> the flow is laminar along the filaments , while spins of dark halos within @xmath5 kpc of the skeleton are preferentially orthogonal to the direction of the flow at a level of @xmath6 . </S>"
  ]
}