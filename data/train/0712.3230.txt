{
  "article_text": [
    "in phylogenetics , tree models have been introduced to describe the evolution of a number of species from a distant common ancestor . given suitably aligned strings of nucleotides of @xmath0 species alive today",
    ", one assumes that the individual positions in these strings have evolved independently and according to the same statistical process .",
    "counting and averaging thus yields an empirical probability distribution on the set @xmath1 . on the other hand ,",
    "any hypothetical evolutionary tree whose leaves correspond to the @xmath0 species gives rise to a parameterised family of probability distributions on @xmath1 ; see section [ sec : statistics ] for details . here the parameters consist of an initial distribution and transition matrices along the edges of the tree .",
    "the challenge is to test whether the tree fits the data , that is , whether the empirical distribution lies in the family .",
    "one way to do this is the use of _ phylogenetic identities _ , equations that vanish identically on the family .",
    "this paper is concerned with constructing such identities for general trees from identities for smaller trees . the set - up below unifies and generalises existing tree models in algebraic statistics , while allowing for a clean and elegant treatment with methods from classical invariant theory . for more information on algebraic statistics and its applications",
    "see @xcite and the many references there .",
    "the term _ phylogenetic invariants _ is commonly used for phylogenetic identities . to avoid confusion with the invariants in classical invariant theory , we do not use this term .",
    "first , recall that a tree @xmath2 is a connected , undirected graph without circuits ; all our trees are finite and have at least two vertices .",
    "the _ valency _ of a vertex of @xmath2 is the number of edges containing it .",
    "a vertex of @xmath2 is called a leaf if it has valency @xmath3 , and an internal vertex otherwise ; if @xmath4 are vertices , we write @xmath5 if there is an edge connecting them .",
    "we write @xmath6 for the sets of vertices , leaves , and internal vertices of @xmath2 , respectively .",
    "stars are trees of diameter at most @xmath7 , and a centre of a star is a vertex at distance @xmath3 to all other vertices ",
    "so if the star has more than @xmath7 vertices , then its centre is unique .",
    "a _ subtree _ of a tree is a connected induced subgraph , and a _",
    "substar _ is a subtree which itself is a star .",
    "so the map that sends a vertex @xmath8 of @xmath2 to the induced subgraph on @xmath8 together with its neighbours is a bijection between @xmath9 and the set of substars of @xmath2 , except when @xmath2 consists of a single edge . in all that follows",
    ", we work over a ground field @xmath10 that is algebraically closed and of characteristic zero .    a _ spaced tree _",
    "@xmath2 is given by the following data : first , a finite undirected tree , also denoted @xmath2 ; second , for every @xmath11 a finite - dimensional vector space @xmath12 ; third , a non - degenerate symmetric bilinear form @xmath13 on each @xmath12 ; and fourth , for every @xmath14 a distinguished basis @xmath15 of @xmath12 which is orthonormal with respect to @xmath13 .",
    "the space @xmath12 at a leaf @xmath8 may also be given a distinguished basis @xmath15 , orthonormal with respect to @xmath13 , in which case @xmath8 is called a _ based leaf_. an internal vertex of @xmath2 will also be called based .",
    "any subtree of the underlying tree of @xmath2 is regarded as a spaced tree with the data that it inherits from @xmath2 .",
    "note that there is some redundancy in this definition : given the distinguished basis @xmath15 at a based vertex @xmath8 one could _ define _ @xmath13 by the requirement that @xmath15 be orthonormal .",
    "we will leave out the subscript @xmath8 from the bilinear form when it is obvious from the context .",
    "in many applications in algebraic statistics , symmetry is imposed on the algebraic model .",
    "this notion is captured well by the following notion of a @xmath16-spaced tree .",
    "fix , once and for all , a finite group @xmath16 .",
    "a _ @xmath16-spaced tree _ ( or @xmath16-tree , for short ) is a spaced tree @xmath2 in which the space @xmath12 at every vertex @xmath8 is a @xmath16-module , on which @xmath13 is @xmath16-invariant , and in which @xmath15 is @xmath16-stable whenever @xmath8 is a based vertex .",
    "any subtree of the underlying tree of @xmath2 is regarded as a @xmath16-spaced tree with the data that it inherits from @xmath2 .",
    "the objects that parameterise probability distributions in the algebraic model are what we propose to call representations of spaced trees .",
    "let @xmath2 be a spaced tree .",
    "a _ representation _ of @xmath2 is a collection of tensors @xmath17 along the edges of @xmath2 with @xmath18 , where @xmath19 is the natural isomorphism @xmath20 .",
    "the space of all representations of @xmath2 is denoted @xmath21 .",
    "a representation of @xmath2 gives rise to a representation of any subtree of @xmath2 .",
    "for a @xmath16-spaced tree @xmath2 , a _",
    "@xmath16-representation _ or _ equivariant representation _ of @xmath2 is a representation @xmath22 where each @xmath23 is a @xmath16-invariant element in the @xmath16-module @xmath24 .",
    "the space of such representations is denoted @xmath25 .",
    "a @xmath16-representation of @xmath2 gives rise to a @xmath16-representation of any subtree of @xmath2 .",
    "using the bilinear form @xmath26 we may identify @xmath12 with its dual @xmath27 , and hence @xmath28 with @xmath29 . thus viewing @xmath23",
    "as a linear map @xmath30 and , similarly , @xmath31 as a linear map @xmath32 , the condition @xmath18 translates into @xmath33 for all @xmath34 and @xmath35 . put yet differently , if @xmath8 and @xmath36 are both based , then this says that the matrix of @xmath31 relative to the bases @xmath15 and @xmath37 is the transpose of the matrix of @xmath23 . in the applications to statistics , the spaces @xmath38 or the space of @xmath39-matrices are perhaps more natural to work with than @xmath28 , as the elements of a representation correspond to _ transition matrices _ ; see section [ sec : statistics ] .",
    "however , there are good reasons to work with @xmath28 ; for instance , the correct action of @xmath40 on the edge parameters turns out to be the natural action on @xmath28 rather than that on @xmath41 ; see lemma  [ lm : gtaction ] and the proof of proposition [ prop : dense1 ] .",
    "finally we note that if @xmath2 is a @xmath16-tree , then by the invariance of the bilinear form @xmath26 the identifications above still make sense when passing to @xmath16-invariant elements : @xmath42 , etc .",
    "notice the slight discrepancy between our notion of representations and the notion in quiver representation theory , where  apart from the fact that the underlying graph is directed  the spaces @xmath12 form part of the data comprising a representation .",
    "@xmath2-tensor _ is any element of @xmath43 , which space we will denote by @xmath44 throughout the text .",
    "@xmath2-tensors correspond to marginal probability distributions in statistics ; see section [ sec : statistics ] .",
    "an important operation on spaced trees , representations , and @xmath2-tensors is @xmath45 , defined as follows .",
    "given @xmath46 spaced trees @xmath47 whose vertex sets share a common based leaf @xmath36 with common space @xmath48 and common basis @xmath37 but which trees are otherwise disjoint , we construct a new spaced tree @xmath49 obtained by gluing the @xmath50 along @xmath36 , while the space at a vertex @xmath8 of @xmath49 coming from @xmath50 is just the space attached to it in @xmath50 , with the same distinguished bilinear form , and the same basis if @xmath8 is based .",
    "given representations @xmath51 for @xmath52 , we write @xmath53 for the representation of @xmath49 built up from the @xmath54 .",
    "now let @xmath55 be a @xmath50-tensor , for all @xmath56 .",
    "then we obtain a @xmath2-tensor by tensoring as follows : @xmath57 where we abuse the notation @xmath58 for the natural contraction @xmath59 determined by the bilinear form @xmath60 . notice that this @xmath45 operator is _",
    "not _ a binary operator extended to several factors ; nevertheless , when convenient , we will write @xmath61 for @xmath49 and @xmath62 for @xmath63 .",
    "now we come to a fundamental procedure that associates to any representation of a spaced tree @xmath2 a @xmath2-tensor .",
    "let @xmath64 .",
    "we proceed inductively .",
    "first , if @xmath2 has a single edge @xmath65 , then @xmath66 , regarded as an element of @xmath67 .",
    "if @xmath2 has more than one edge , then let @xmath36 be any internal vertex of @xmath2 .",
    "we can then write @xmath68 , where @xmath69 is the _ branch of @xmath2 around @xmath36 containing @xmath8 _ , constructed by taking the connected component of @xmath70 ( the graph obtained from @xmath2 by removing @xmath36 and all edges attached to @xmath36 ) containing @xmath8 , and reattaching @xmath36 to @xmath8 .",
    "the representation @xmath71 induces representations @xmath72 of the @xmath69 , and by induction @xmath73 has been defined .",
    "we now set @xmath74 a straightforward proof by induction shows that this is independent of the choice of @xmath36 and that this formula is also valid if @xmath36 is actually a leaf .",
    "now we can define the key objects of this paper .",
    "let @xmath2 be a spaced tree .",
    "the _ general markov model _ associated to @xmath2 is the algebraic variety @xmath75 where the closure is taking in the zariski topology .",
    "similarly , for a @xmath16-spaced tree @xmath2 , the _ equivariant model _ associated to @xmath2 is the algebraic variety @xmath76    notice that _ a priori _ both the individual tensors @xmath77 and the varieties @xmath78 , @xmath79 depend on the bases @xmath37 at internal vertices @xmath36 .",
    "this is only natural , as in applications these bases have an intrinsic meaning ; see section [ sec : statistics ] .",
    "however , more can be said about this dependency ; see lemma [ lm : gtaction ] .",
    "to streamline our discussion , we will consider @xmath80 as the special case of @xmath81 where @xmath16 is trivial .",
    "an important goal in algebraic statistics is finding the ideal of all polynomials on the space @xmath44 that vanish on @xmath79 .",
    "our first result is a procedure for constructing these ideals from the ideals for substars of @xmath2 .",
    "[ thm : procedure ] for any @xmath16-spaced tree @xmath2 , the ideal @xmath82 can be expressed in the ideals @xmath83 where @xmath84 runs over the @xmath16-spaced substars of @xmath2 with at least three leaves . in particular , for any spaced tree , the ideal of @xmath85 can be expressed in the ideals @xmath86 where @xmath84 runs over the spaced substars of @xmath2 with at least three leaves .",
    "this theorem is admittedly formulated somewhat vaguely .",
    "however , its proof in section [ sec : proofs ] gives rise to the explicit , recursive algorithm [ alg : procedure ] for determining @xmath82 from the ideals @xmath83 ; this justifies the present formulation .",
    "we now present a variant of theorem [ thm : procedure ] which is perhaps less useful for actual computations , but which is of fundamental theoretical interest .",
    "this variant uses a second important operation on spaced trees and leaf tensors , namely , _",
    "flattening_. fix any vertex @xmath36 in a spaced tree @xmath2 , and define an equivalence relation on @xmath87 by @xmath88 if and only if either @xmath89 or @xmath90 lie in the same connected component of @xmath91 . construct a spaced star @xmath92 as follows :",
    "first , the vertex set is the set @xmath93 of equivalence classes , and the class of @xmath36 is attached to all other classes by an edge . to the class @xmath94",
    "we attach the space @xmath95 equipped with the bilinear form inherited from the @xmath12 , and if all @xmath96 are based , then @xmath94 is based with the tensor product of the bases @xmath15 .",
    "this new spaced tree @xmath92 is called the _ flattening _ of @xmath2 at @xmath36 .",
    "note that we allow @xmath36 to be a leaf of @xmath2 , in which case @xmath92 has a single edge .",
    "the space @xmath44 of @xmath2-tensors is naturally identified with the space @xmath97 of @xmath92-tensors , and expanding the definition of @xmath98 at @xmath36 one readily finds that @xmath99 our second main result shows that this characterises @xmath79 .",
    "[ thm : flattening ] for any @xmath16-spaced tree @xmath2 we have @xmath100    1 .",
    "if @xmath2 has more than one edge , then it suffices to let @xmath36 run over @xmath101 .",
    "2 .   to avoid confusion we stress that @xmath92 is _ not _ a substar of @xmath2 , unless @xmath2 itself is a star with centre @xmath36 , in which case @xmath102 .",
    "many special cases of our main results are known in the literature . in particular @xcite",
    "contains set - theoretic versions of our theorems for the general markov model , and poses theorem [ thm : flattening ] for the general markov model as conjecture 5 . in @xcite the ideals of equivariant models with @xmath16 abelian and",
    "all @xmath12 equal to the regular representation @xmath103 are determined , following ideas from @xcite .",
    "an important observation that makes this feasible is that these varieties are toric ; see also section [ sec : toric ] .",
    "some more specific references to the literature may be found in the section  [ sec : statistics ] , which explains the relevance of spaced trees and their representations to statistics .",
    "after that , in section [ sec : multiplying ] we prove a key tool on multiplying varieties of matrices , which we then use in section [ sec : proofs ] to prove our main results .",
    "finally , section [ sec : toric ] contains a result on toricness of certain abelian equivariant models .",
    "the first author thanks seth sullivant for his great eidma / diamant course on algebraic statistics in eindhoven .",
    "it was seth who pointed out that a result like the one in section [ sec : multiplying ] could be used to treat various existing tree models in a unified manner .",
    "in the applications of our results to algebraic statistics , the spaced tree @xmath2 that we start with only has based vertices . indeed , the bases @xmath15 have some physical meaning . in phylogenetics , for instance , they are usually all equal to @xmath104 , the building bricks for dna . furthermore , an internal vertex @xmath105 is singled out as root , and the base field is @xmath106 .",
    "an element of @xmath12 which on the basis @xmath15 has non - negative real coefficients that add up to @xmath3 is regarded as a probability distribution on @xmath15 ; together they form the _ probability simplex _ @xmath107 . a representation of @xmath2 is called _ stochastic _",
    "if all maps @xmath108 directed away from @xmath105 satisfy @xmath109 , which amounts to saying that the entries of @xmath23 , regarded as a matrix relative to the bases @xmath37 and @xmath15 , are real and non - negative and that @xmath23 has all column sums equal to @xmath3 . a root distribution @xmath110 and a stochastic representation @xmath71 of @xmath2 determine a probability distribution on @xmath111 and , by taking marginals , a distribution on @xmath112 , which can be thought of as an element @xmath113 of @xmath114 .",
    "write @xmath115 at @xmath105 and let @xmath116 be the induced representations on the @xmath50",
    ". then the distribution is @xmath117 which equals @xmath118 , where @xmath119 is the ( non - stochastic ) representation obtained from @xmath71 by composing a single @xmath120 leading away from the root with the diagonal linear map @xmath121 determined by @xmath122 .",
    "we define the set @xmath123 a natural equivariant analogue of this for a @xmath16-tree @xmath2 is @xmath124 but as the following examples from phylogenetics show it also makes sense to allow for arbitrary root distributions rather than @xmath16-invariant ones ; see below how to handle these .",
    "[ ex : models ] in all models below , the @xmath15 are all equal to @xmath104 and are all equipped with the same permutation action of some @xmath16 .",
    "recall that the nucleotides fall into two classes of bases , according to their chemical structure : the purines adenine and guanine and the pyrimidines cytosine and thymine .",
    "this explains some of the choices in the following models .",
    "all of them are equivariant models in our sense .",
    "the labels of these models are those used in @xcite .    1 .   in the _ jukes - cantor model jc69 _ @xmath125 ( or the alternating group , which has exactly the same equivariant maps @xmath126 ) .",
    "one assumes a @xmath16-invariant root distribution  which in this case means that it is uniform .",
    "2 .   in the _",
    "kimura model k80 _ @xmath16 is the dihedral group generated by @xmath127 and @xmath128 .",
    "it is the group of symmetries of the following square .",
    "@xmath129 again , the root distribution is taken @xmath16-invariant , which means uniform .",
    "3 .   in the _",
    "kimura model k81 _ @xmath16 is the klein @xmath130-group and the root distribution is @xmath16-invariant ( uniform ) .",
    "4 .   in the _",
    "strand - symmetric model cs05 _ @xmath16 generated by the transpositions @xmath128 and @xmath131 and the root distribution is @xmath16-invariant .",
    "5 .   in the _ hky85 model _",
    "@xmath16 is as in the strand - symmetric model , but one allows for non-@xmath16-invariant root distributions .",
    "6 .   in the _",
    "felsenstein model f81 _ @xmath16 is the full symmetric ( or alternating ) group , and the root distribution arbitrary .",
    "the ideals of all these models were determined in @xcite .",
    "moreover , @xcite gives local equations at biologically meaningful points .",
    "a similar construction of tree models appears in @xcite .",
    "there the spaces at all vertices are required to be the same space @xmath132 , and the tensors at the edges are allowed to vary in some fixed subspace @xmath133 of @xmath134 consisting of _ symmetric _ tensors .",
    "otherwise the construction of the model is the same .",
    "we should mention that not all models obtained in this manner fit within our framework .",
    "for instance , the model where @xmath133 is the entire space of symmetric tensors can not be characterised as the set of @xmath16-invariant tensors in @xmath134 for some group @xmath16 acting on @xmath132 .",
    "our present approach does not apply to this setting .",
    "similar to the observations in @xcite , as a consequence of the construction of @xmath79 , it is a closed cone ( i.e.  invariant under scalar multiplication in @xmath44 ) and therefore uniquely defines a projective variety in @xmath135 , denoted @xmath136 , and defined by the same ideal as @xmath79 . notice that because the elements of @xmath137 have coordinate sum equal to @xmath3 , @xmath137 actually maps injectively into @xmath135 .",
    "the following proposition justifies our quest for the ideal @xmath82 : it contains all homogeneous polynomials vanishing on the statistically meaningful set @xmath137 .",
    "[ prop : dense1 ] provided that all @xmath12 are non - zero , the image of the set @xmath137 in @xmath135 is zariski dense in the variety @xmath136 .",
    "first , the set of root distributions on @xmath138 is clearly zariski - dense in the set of all ( complex ) @xmath139 with @xmath140 .",
    "similarly , for a single edge @xmath141 pointing away from @xmath105 , the stochastic matrices in @xmath142 are zariski dense in the complex matrices in @xmath142 with column sums @xmath3 .",
    "this follows from an explicit parameterisations of such equivariant stochastic matrices",
    "@xmath71 : for every @xmath143 the @xmath144-th column of @xmath71 varies in a certain ( scaled probability ) simplex of dimension @xmath145 , where @xmath146 is the stabiliser of @xmath144 in @xmath16 .",
    "this simplex is dense in the subset of @xmath147 where the sum of the coordinates is @xmath3 .",
    "next we claim that for @xmath71 in an open dense subset of @xmath25 we can write @xmath77 as @xmath148 for some @xmath149 having column sums @xmath3 and some @xmath150 with @xmath151 . to see this , first fix a vertex @xmath36 and",
    "take for every vertex @xmath5 a copy of the torus @xmath152 , considered as the diagonal subgroup of @xmath153 acting by multiplication by a scalar on the span of each @xmath16-orbit on @xmath37 and hence centralising @xmath16 on @xmath48 .",
    "the copy for @xmath8 acts on @xmath38 by @xmath154 and on @xmath41 by @xmath155 .",
    "note that this latter action is _ not _ the natural one on @xmath41 , in which @xmath156 would be replaced by its inverse , but that this action _ is _ the natural one on @xmath28 ; see also lemma [ lm : gtaction ] and the remarks preceding it .",
    "in particular , this action maps representations to representations .",
    "a straightforward computation shows that the subtorus @xmath157 leaves @xmath98 invariant .",
    "now let @xmath71 be any @xmath16-representation of @xmath2 such that all column sums of all @xmath23 directed away from @xmath105 are non - zero ; this is an open dense condition on @xmath71 . given any non - root vertex @xmath36 , by acting with @xmath158 we can achieve that the @xmath23 leading away from @xmath105 have column sums @xmath3 , while the map @xmath23 , where @xmath8 is the parent of @xmath36 relative to @xmath105 , may not . if we do this for all non - root vertices in a bottom - up manner , and finally also for @xmath159 , then we achieve that all @xmath23 leading away from @xmath105 have column sums @xmath3 , except for a single @xmath120 ; note that we have not altered @xmath77 in this process . denote the column sums of @xmath120 by @xmath160 .",
    "dividing column @xmath144 of @xmath120 by @xmath161 gives a representation @xmath162 all of whose matrices leading away from @xmath105 have column sums @xmath3 .",
    "also , for @xmath71 in an open dense subset , @xmath163 is non - zero , and dividing @xmath164 by @xmath165 gives a @xmath150 adding up to @xmath3 such that @xmath166 .",
    "this proves the claim , and hence the proposition .",
    "as we saw in the examples above , one may want to allow arbitrary root distributions , which are not necessarily @xmath16-invariant .",
    "more generally , one might want to allow the root distribution to vary in a certain self - dual submodule of @xmath167 , and this would require only minor changes in the discussion that follows  but here we concentrate on the situation where all elements of ( the probability simplex in ) @xmath167 are allowed .",
    "we define the set @xmath168 one can elegantly describe @xmath169 as follows .",
    "let @xmath170 be the spaced tree obtained from @xmath2 by connecting a new vertex @xmath171 to the root @xmath105 of @xmath2 and attaching to @xmath171 the @xmath16-module @xmath172 , endowed with the same bilinear form .",
    "then @xmath173 , and since @xmath174 we may think of @xmath175 as a subset of @xmath176 . since it also consists of @xmath16-fixed points , and since this identification is @xmath16-equivariant , it is a subset of @xmath177 .",
    "[ prop : dense2 ] the image of @xmath169 in @xmath135 is a zariski dense subset in the projective variety associated to the cone @xmath178 where we regard @xmath175 as a subset of @xmath177 . the ideal of this cone can be determined from the ideal of @xmath175 .",
    "we have @xmath179 where @xmath162 is obtained from @xmath71 by putting the identity @xmath180 along the edge @xmath181 .",
    "this shows that @xmath113 is contained in @xmath182 . for the converse we reason as before : for @xmath162 in an open dense subset of @xmath183 we can write @xmath184 as @xmath185 where all @xmath23 directed away from @xmath105 have column sums equal to @xmath3 except possibly for @xmath186 .",
    "we have @xmath187 where @xmath165 is taken such that @xmath188 has @xmath189 .",
    "the proof of the last statement is deferred to the end of section  [ sec : proofs ] .",
    "in this section we derive a key tool that will be used in the proofs of our results . as before let @xmath10 be an algebraically closed field of characteristic @xmath190 , and let @xmath191 be a natural number",
    ". for @xmath192 let @xmath193 denote the space @xmath194 , where @xmath195 is the space of @xmath196-matrices over @xmath10 . to formulate and prove our results in their full strength , it is convenient to use some notions from the language of schemes , for which we refer to @xcite .",
    "the main point here is that we do not require ideals to be radical .",
    "recall that if @xmath197 is an affine variety , then a closed subscheme @xmath84 of @xmath197 is given by an ideal @xmath198 of the ring @xmath199 $ ] of regular functions on @xmath197 : the underlying closed subset of @xmath197 is the set of zeros of @xmath198 , and the @xmath10-algebra associated to @xmath84 is @xmath199/i$ ] .",
    "we write @xmath200 for the ideal of the subscheme @xmath84 .",
    "if @xmath197 is a variety on which some group @xmath201 acts , then @xmath84 is called a @xmath201-subscheme if and only if @xmath202 $ ] is @xmath201-stable . finally , if @xmath203 is a map between varieties , inducing the pull back homomorphism @xmath204 \\to k[x]$ ] , and if @xmath205 is a subscheme , then the _ image scheme _ of @xmath84",
    "is defined as the scheme theoretic closure of @xmath206 , i.e.  the subscheme of @xmath207 defined by the ideal @xmath208 . by slight abuse of notation",
    "it is usually denoted as @xmath206 .",
    "it is clear that if @xmath209 is @xmath201-equivariant for some group @xmath201 acting on @xmath197 and @xmath207 , then the image of a @xmath201-subscheme is again a @xmath201-subscheme .",
    "also notice that if @xmath84 is a subvariety , i.e. , if @xmath200 is radical , then so is @xmath206it is precisely the zariski closure of the set - theoretic image of @xmath84 under @xmath209 .",
    "we now specialise to multiplying schemes of matrices .",
    "we write @xmath210 for the multiplication and @xmath211 for the co - multiplication , @xmath212 . given two subschemes @xmath213 and @xmath214 , put @xmath215 if @xmath216 are subvarieties",
    "this is just @xmath217 where @xmath218 . in general , the underlying topological space is still the closure of the set @xmath219 , but the ideal is @xmath220 .    the operation @xmath221 is associative in the sense that , given a third subscheme @xmath222 , one has @xmath223 we therefore simply write @xmath224 .",
    "let @xmath225 .",
    "frequently the subschemes we are interested in will be invariant by left- or right - multiplication by @xmath226 . in this context",
    "it is worth mentioning that a subscheme @xmath227 is a @xmath226-subscheme , i.e. , stable by right - multiplication , if and only if @xmath228 .",
    "this follows from the fact that for any @xmath10-algebra @xmath71 and any nonconstant @xmath229 $ ] , @xmath230_f$ ] is dense in @xmath230 $ ] , and thus @xmath231 is ( scheme theoretically ) dense in @xmath232 .",
    "[ thm : vw ] let @xmath233 and let @xmath234 and @xmath132 be subschemes of @xmath193 and @xmath235 , respectively .",
    "then we have @xmath236    in the following proof we will use the first fundamental theorem in invariant theory , which describes the invariant polynomials of @xmath237 on a direct sum of copies of @xmath238 and the dual space @xmath239 . this theorem is due to weyl @xcite .",
    "another tool from representation theory is the reynolds operator : when a reductive group acts rationally on a vector space , then the reynolds operator @xmath240 is the projection onto the invariant vectors with kernel the direct sum of all non - trivial irreducible submodules .",
    "modern treatments on invariant theory are @xcite .",
    "the inclusion @xmath241 is obvious . to prove the opposite inclusion we first replace @xmath234 by @xmath242 and @xmath132 by @xmath243this clearly keeps invariant both sides of , and moreover turns @xmath234 and @xmath132 into @xmath244-subschemes , where @xmath245 , which acts on @xmath246 by @xmath247 let @xmath248 , which now equals the left - hand side of .",
    "define @xmath249 $ ] by @xmath250 , so that @xmath251",
    ". then @xmath252 is invariant with respect to the action of @xmath244 , and moreover @xmath252 is in the ideal of @xmath253 .",
    "this latter fact implies that @xmath254 split @xmath255 accordingly .",
    "applying the reynolds operator @xmath256 \\to k[m_{\\bk,\\bl } \\times m_{\\bl,\\bm}]^{\\lieg{gl}_\\bl}$ ] yields @xmath257 . by @xmath258-invariance of @xmath234 and @xmath132 , @xmath259 and @xmath260 still are elements of @xmath261 and @xmath262 , respectively .",
    "furthermore , @xmath259 and @xmath260 lie in @xmath263^{\\lieg{gl}_\\bl } = k[m_{k_1,l_1 } \\times m_{l_1,m_1}]^{\\lieg{gl}_{l_1 } } \\otimes \\cdots \\otimes k[m_{k_t , l_t } \\times m_{l_t , m_t}]^{\\lieg{gl}_{l_t}}.\\ ] ] by the first fundamental theorem for @xmath264 applied to @xmath265 covectors and @xmath266 vectors the pullback of multiplication @xmath267 is a surjective homomorphism @xmath268 \\to k[m_{k_i , l_i } \\times m_{l_i , m_i}]^{\\lieg{gl}_{l_i}}\\ ] ] for all @xmath269 .",
    "hence the pullback of multiplication @xmath270 is a surjective homomorphism @xmath271 \\to k[m_{\\bk,\\bl } \\times m_{\\bl,\\bm}]^{\\lieg{gl}_{\\bl}};\\ ] ] let @xmath272 lift under this surjection to @xmath273 $ ] , respectively .",
    "note that @xmath274 are not unique if @xmath275 for some @xmath56 , but this is irrelevant here .",
    "we now have @xmath276 .",
    "moreover , restricted to the image @xmath277 we have @xmath278 , since @xmath279 for all @xmath280 .",
    "hence @xmath281 vanishes on @xmath277 , which contains both @xmath282 and @xmath283 .",
    "but then @xmath284 lies in both @xmath285 and @xmath286 , and hence @xmath287 as claimed .",
    "we will use theorem  [ thm : vw ] to describe the ideal of @xmath288 explicitly from the ideals of @xmath234 and @xmath132 .",
    "before we can do this we need one more tool .",
    "suppose @xmath289 is a morphism where @xmath197 and @xmath207 are affine varieties over @xmath10 , and suppose @xmath84 is a closed subscheme of @xmath207 defined by an ideal @xmath198 . then there exists a uniquely determined subscheme @xmath290 of @xmath197 such that @xmath291 and such that @xmath290 is maximal with this property .",
    "scheme - theoretically , @xmath290 is equal to @xmath292 where for @xmath293 , @xmath294 is the inclusion @xmath295 .",
    "the ideal of @xmath290 is determined as follows : let @xmath296 be the ideal in @xmath199 $ ] generated by all functions of the form @xmath297 where @xmath298 and @xmath299 is an arbitrary ( closed ) point .",
    "in other words , @xmath300 for @xmath301 .    since @xmath302 = k[x]\\otimes_k k[x_1,x_2,\\dots , x_n]$ ] , for any @xmath303 $ ] , we may write @xmath304 uniquely as @xmath305 where the @xmath266 are some linearly independent monomials in @xmath306 $ ] , and @xmath307 $ ] .",
    "it is now elementary to check that @xmath296 is generated by all @xmath308 $ ] that appear in such an expression as @xmath209 runs through @xmath198 .",
    "indeed , the ideal generated by @xmath309 where @xmath310 ranges over @xmath238 is precisely the ideal generated by all @xmath311 .",
    "this is easily seen by picking @xmath165 points @xmath312 in @xmath238 such that @xmath313 \\neq 0 $ ] , which is possible as @xmath10 is infinite and the @xmath266 are supposed to be linearly independent .",
    "this observation is important because it shows how to compute a finite list of generators for @xmath296 out of finitely many generators for @xmath198 : if @xmath314 generate @xmath198 , then the ( finite ) collection of all @xmath315s appearing in one of the @xmath316s generates @xmath296 .",
    "we will apply this construction to the case where @xmath317 and @xmath318 equal to matrix multiplication .",
    "then for @xmath319 , the ideal @xmath320 is generated by all functions on @xmath193 of the form @xmath321 where @xmath322 is arbitrary , and @xmath323 .",
    "in fact , thinking of the entries of @xmath324 as variables , we may expand @xmath321 as a polynomial in the entries of @xmath324 ; the coefficients are then the required elements of the ideal of @xmath325 .",
    "see also example [ ex : toric ] .",
    "the following corollary is crucial for explicit computations ; it is a slight generalisation of ( * ? ? ?",
    "* lemma  12 ) , which gives the same equations for @xmath282 .",
    "although there the result is stated only for subvarieties , their proof should also go through essentially unchanged .",
    "[ cor : vm ] let @xmath233 and let @xmath234 be a subscheme of @xmath193 with @xmath326 . define the scheme @xmath327 by the ideal generated by all @xmath328-minors of the @xmath56-th component , for all @xmath269 .",
    "then we have @xmath329 where @xmath325 is defined as in the preceding paragraph as the unique maximal subscheme of @xmath330 such that @xmath331 .",
    "it is well known that @xmath332 as schemes , and in particular that the ideal of @xmath333 is radical .",
    "the inclusion @xmath241 follows from @xmath334 : first , @xmath335 is clear .",
    "second , @xmath336 implies that @xmath337 , i.e.@xmath338 .    for the opposite inclusion ,",
    "set @xmath339 , and apply theorem [ thm : vw ] with @xmath340 replaced by @xmath341 .",
    "indeed , @xmath342 by definition of @xmath325 , so that the left - hand side of is contained in @xmath343 , which is the left - hand side of with @xmath344 replaced by @xmath345 . with this substitution the right - hand side of reads @xmath346",
    "which , as @xmath347 , equals the right - hand side of @xmath348 .",
    "the corollary is the reason why we had to use subschemes instead of subvarieties : in general , @xmath325 is not a variety even if @xmath234 is , so the ideal @xmath349 of functions vanishing on the closed points of @xmath325 may be larger than @xmath320 , and hard to compute .",
    "however , the corollary shows that to compute @xmath285 only the ideal @xmath320 is needed , and for this ideal generators can be found as described above",
    ".    we will apply theorem [ thm : vw ] and its corollary in the following setting : let @xmath234 be a representation of @xmath16 , @xmath350 the set of all irreducible characters , and for @xmath351 denote by @xmath352 a fixed irreducible representation of type @xmath353 . then @xmath354 $ ] , where @xmath355 $ ] is the sum of all submodules of @xmath234 isomorphic to @xmath356 .",
    "moreover , @xmath355",
    "\\cong m_{\\omega } \\otimes \\hom_g(m_\\omega , v ) \\cong m_{\\omega } \\otimes k^{m(\\omega , v)}$ ] with @xmath357 the multiplicity of @xmath352 in @xmath234 . in particular ,",
    "if @xmath132 is another representation of @xmath16 , then the space of equivariant maps @xmath358 is @xmath359    the varieties we are interested in are subvarieties of @xmath360 stable by multiplication with @xmath361 or @xmath362 where @xmath216 are some representations of @xmath16 .",
    "so let @xmath363 be three representations of @xmath16 , and suppose @xmath364 and @xmath365 are subvarieties or subschemes . to apply theorem  [ thm : vw ] , we may identify @xmath360 with @xmath193 , @xmath366 with @xmath235 , and @xmath361 with @xmath367 , by putting @xmath368,@xmath369 , and @xmath370 , respectively , where @xmath371 .    with these identifications in place ,",
    "the ideal of @xmath372 is equal to @xmath373 .",
    "similarly , if @xmath2 is stable by right - multiplication with @xmath374 , then the ideal of @xmath375 may be computed using corollary  [ cor : vm ] .",
    "we will see several applications of this in the next section .",
    "before proving our main results , we investigate how @xmath98 and @xmath79 behave under base changes .",
    "thus let @xmath2 be a @xmath16-tree and write @xmath376 for the product @xmath377 .",
    "on the one hand , this group acts on @xmath25 by the action of @xmath378 on @xmath379 .",
    "we already encountered a special case of this action in the proof of proposition [ prop : dense1 ] . on the other hand , given @xmath380 one can define a new @xmath16-spaced tree @xmath381 as follows : the underlying tree of @xmath381 is the same as that of @xmath2 and the space @xmath12 at each vertex is also the same as that of @xmath2 , but the bilinear form @xmath382 is determined by @xmath383 where the latter bilinear form is the one assigned to @xmath8 in @xmath2 .",
    "finally , a vertex @xmath8 is based in @xmath381 if and only if it is based in @xmath2 , and then the basis associated to it in @xmath381 is @xmath384 , where @xmath15 is the distinguished basis of @xmath12 in @xmath2 .",
    "a representation @xmath71 of @xmath2 gives a representation of @xmath381 , also denoted @xmath71 , by simply taking the same tensors @xmath385 along the edges .",
    "[ lm : gtaction ] in the setting above we have @xmath386 .",
    "if @xmath2 has only two vertices @xmath5 , then this just the obvious equality @xmath387 .",
    "if @xmath2 has more than two vertices , we pick any internal vertex @xmath36 of @xmath2 and split @xmath388 and @xmath389 at @xmath36 . assuming the result for all @xmath50 we find @xmath390    in particular , this lemma implies that @xmath391 .",
    "for @xmath392 we note that if @xmath170 is any spaced tree with the same underlying tree as @xmath2 and the same @xmath16-modules @xmath12 at the vertices , but different bilinear forms and different ( orthonormal ) bases , then there exists an @xmath380 with @xmath393 . in this sense",
    "the variety @xmath78 does not depend on the chosen bases and forms , as long as they are compatible .",
    "[ re : valencytwo ] a stronger basis - independency holds at vertices of valency two .",
    "there the operation @xmath45 boils down to matrix multiplication , or composition of linear maps , and this will enable us to apply theorem [ thm : vw ] . indeed , let @xmath363 be vector spaces equipped with non - degenerate symmetric bilinear forms and let @xmath394 and @xmath395 be arbitrary .",
    "let @xmath324 be any orthonormal basis of @xmath234 .",
    "we claim that the element @xmath396 does not depend on @xmath324 , and under the identification @xmath397 coincides with the linear map @xmath398 which is the composition of @xmath399 and @xmath400 , considered as linear maps under the identifications @xmath401 and @xmath402 .",
    "it suffices to verify this for rank - one tensors @xmath403 and @xmath404 .",
    "the expression above is then @xmath405 w \\otimes u.\\ ] ] by the orthonormality of @xmath324 this reduces to @xmath406 , as claimed .",
    "thus , in hindsight , we could have left out the orthonormal bases at vertices of valency @xmath7 in the definition of ( @xmath16-)spaced trees , and defined the operation @xmath45 as composition of linear maps .",
    "we have not done so to keep the treatment of internal vertices uniform .",
    "next we observe that the map @xmath98 defined in section [ sec : setup ] behaves well with respect to the group action .",
    "let @xmath2 be a @xmath16-spaced tree .",
    "note that @xmath16 acts naturally on @xmath21 by its action on each tensor product @xmath407 with @xmath5 .",
    "the map @xmath408 is @xmath16-equivariant .",
    "if @xmath2 has exactly two vertices the assertion is immediate .",
    "otherwise , let @xmath36 be an inner vertex of @xmath2 and split @xmath2 around @xmath36 into @xmath47 .",
    "the @xmath50 are @xmath16-trees in a natural way . by induction",
    ", we may assume that @xmath409 is an equivariant map .",
    "then @xmath410 where the second equality follows from the @xmath16-invariance of @xmath411 and the last equality follows from the fact that @xmath412 permutes @xmath37 .",
    "this lemma implies that @xmath413 . in what follows",
    "we focus on the ideal of @xmath79 inside @xmath414 $ ] . to obtain the ideal inside",
    "@xmath415 $ ] , one just adds linear equations cutting out @xmath416 from @xmath44 .    [",
    "re : valencytwob ] for @xmath417 the computation in the proof of the lemma can be replaced by the following argument , using the notation of remark [ re : valencytwo ] . if @xmath363 are @xmath16-modules and @xmath234 carries a @xmath16-invariant symmetric bilinear form , then the unique bilinear map @xmath418 sending @xmath419 to @xmath420 is @xmath16-equivariant .",
    "so at vertices of valency @xmath7 it is not crucial that @xmath16 permutes the basis .    with these preparations , we are now ready to prove our first main result .",
    "let @xmath2 be a @xmath16-spaced tree .",
    "we recursively express the ideal of @xmath79 into the ideals of @xmath421 for substars",
    "@xmath84 of @xmath2 with at least three leaves , as follows",
    ". first , if @xmath2 has only two vertices @xmath5 , then @xmath422 and we are done .",
    "second , if @xmath2 is itself a star with at least three leaves , then we are also done .",
    "third , suppose that @xmath2 contains a vertex @xmath36 of valency @xmath7 , and split @xmath2 accordingly as @xmath423 , so that @xmath424 let @xmath425 be the space @xmath426 and @xmath427 .",
    "of course @xmath428 are naturally @xmath16-representations .",
    "now the map @xmath429 from @xmath430 to @xmath416 is just matrix multiplication if we identify @xmath431 with @xmath432 and @xmath433 with @xmath434 ; see remark [ re : valencytwo ] .",
    "we want to apply theorem [ thm : vw ] .",
    "recall the definition of @xmath435 and @xmath436 from section  [ sec : multiplying ] . now define @xmath437 by @xmath438 , @xmath439 and @xmath440 .",
    "then @xmath441 , @xmath442 and @xmath443 .",
    "notice that @xmath444 ( resp .",
    "@xmath445 ) are stable under right- ( resp .",
    "left- ) multiplication with @xmath367 , and @xmath446 .",
    "thus theorem  [ thm : vw ] applies and we deduce that @xmath447 where @xmath448 because @xmath16 acts preserving the form .",
    "recursively , we may assume that the ideals of @xmath449 and @xmath450 have been computed .",
    "finally , the two terms on the right - hand side can be expressed into @xmath451 and @xmath452 using corollary [ cor : vm ] : following the recipe at the end of section  [ sec : multiplying ] , we may compute e.g.  @xmath453 .",
    "this concludes the case where @xmath2 contains a vertex of valency @xmath7 .",
    "finally , if @xmath2 is neither a star nor contains a vertex of valency two , then it contains an edge @xmath454 where both @xmath8 and @xmath105 are internal vertices of valency at least three .",
    "let @xmath170 be the @xmath16-tree obtained from @xmath2 by inserting two vertices @xmath455 and @xmath456 between @xmath8 and @xmath105 so that @xmath457 , setting @xmath458 with the same bilinear form and basis , and @xmath459 with the same bilinear form and basis .",
    "note that every @xmath16-spaced substar of @xmath170 with at least three leaves is also a @xmath16-spaced substar of @xmath2 .",
    "this is why we inserted two vertices rather than one : what space should we attach to a single vertex between @xmath8 and @xmath36 ? see below for a comment on this . by the previous construction",
    ", we can express the ideal of @xmath175 in the ideals of @xmath421 of all substars @xmath84 of @xmath170 , hence of @xmath2 , with at least three leaves .",
    "so we are done if can show that @xmath460 . but any @xmath461 gives rise to an @xmath462 by setting @xmath463 .",
    "using remark [ re : valencytwo ] one finds that @xmath464 .",
    "conversely , for any @xmath465 we can factorise @xmath120 into @xmath466 with @xmath16-invariant factors .",
    "this gives a representation @xmath162 of @xmath170 with @xmath467 .",
    "this concludes the proof of the theorem",
    ".    note that for @xmath468 , i.e. , for the general markov model , the proof above can be simplified slightly : one does not need the decomposition into isotypic components , and may apply theorem [ thm : vw ] with @xmath469 directly .    the proof above yields to the following algorithm for computing @xmath82 from the ideals of substars .",
    "[ alg : procedure ]    input : :    a @xmath16-spaced tree @xmath2 and finite generating    sets of the ideals    @xmath470 $ ] for    all substars @xmath84 in @xmath2 with at least three    leaves .",
    "output : :    a finite generating set of the ideal    @xmath471 $ ] .",
    "procedure : :    1 .",
    "if @xmath2 contains only two vertices    @xmath5 , then return the empty set and quit .",
    "if @xmath2 is a star with at least three leaves , then a    finite generating set of @xmath82    is part of the input ; return this set and quit .",
    "if @xmath2 has a vertex of valency @xmath7 , then    choose such a vertex @xmath36 and split    @xmath472 at @xmath36 .",
    "apply this algorithm to    @xmath473 and to @xmath474 ( with the ideals of their    substars ) to find finite generating sets @xmath475 of the    ideals of @xmath476 and    @xmath477 , respectively .",
    "let    @xmath428 be as in the proof of theorem [ thm : procedure ] ,    identify @xmath478 with    @xmath330 as in that proof , and write    @xmath479 for the tuple of multiplicities    @xmath480 .",
    "identify @xmath481 with    @xmath193 and @xmath482 with    @xmath235 , so that @xmath483 $ ] and    @xmath484 $ ] .",
    "write @xmath485    for an element in @xmath330",
    "whose coordinates are    variables .    1",
    ".   let @xmath486 denote the collection of all    @xmath487-minors of the @xmath56-th component of    @xmath485 for all @xmath269 .    2 .   for an element @xmath488 with new    variables",
    "as coordinates , expand @xmath489    for each @xmath490 , and take all coefficients of    monomials in @xmath491 , which are polynomials in    @xmath485 .",
    "collect these polynomials in @xmath492 .",
    "3 .   for an element @xmath493 with new    variables",
    "as coordinates , expand @xmath494    for each",
    "@xmath495 , and take all coefficients of    monomials in @xmath491 , which are polynomials in    @xmath485 . collect these polynomials in @xmath496 .",
    "+    return @xmath497 and quit .",
    "take an edge @xmath454 in @xmath2 connecting    two vertices of valency at least three .",
    "construct a    @xmath16-tree @xmath170 by inserting two new vertices    @xmath498 such that @xmath499 and setting @xmath458 with the    same basis and bilinear form and @xmath459 with the    same basis and bilinear form .",
    "run this algorithm on @xmath170 ,    return the same output as for @xmath170 , and quit .",
    "although the tree grows in the last step , it is easy to see that this algorithm terminates : after inserting vertices , in the call with @xmath170 the tree is broken into two trees , each of which have strictly less substars with at least three vertices .",
    "this algorithm is partly carried out in example [ ex : toric ] .",
    "[ re : valencytwoc ] in the last step of both the proof and the algorithm we could also have inserted a single vertex @xmath36 between @xmath8 and @xmath105 , with @xmath48 equal to the @xmath16-module having multiplicities @xmath500 for all @xmath56 , so that all @xmath16-equivariant maps @xmath501 factorise through @xmath48 .",
    "one can show that this @xmath48 carries a @xmath16-invariant , non - degenerate symmetric bilinear form since @xmath12 and @xmath167 do .",
    "this set - up would have raised two minor problems .",
    "first , the object @xmath170 thus constructed is strictly speaking not a @xmath16-tree , as @xmath48 may not have an orthogonal basis permuted by @xmath16 .",
    "but as we saw in remarks [ re : valencytwo ] and [ re : valencytwob ] this is not really a problem : we can still apply theorem [ thm : vw ] at @xmath36 to split @xmath170 into smaller trees .",
    "second , the @xmath16-spaced stars @xmath502 with centres @xmath8 and @xmath105 in @xmath170 are not equal to the @xmath16-spaced stars @xmath503 around @xmath8 and @xmath105 in @xmath2 .",
    "hence after expressing @xmath504 in the ideals @xmath83 for all stars @xmath84 with at least three leaves in @xmath170 , we still need to express the ideals of @xmath505 and @xmath506 in @xmath507 and @xmath508 , respectively , to prove the theorem .",
    "the following lemma does just that .",
    "this would give a slight variant of the algorithm above .",
    "[ le : pushfwd ] let @xmath509 be @xmath16-spaced stars with the same underlying star having @xmath36 as centre and @xmath510 as leaves .",
    "suppose that both stars have the same space @xmath48 with the same basis @xmath37 and that we are given @xmath16-equivariant injections @xmath511 for @xmath52 , where @xmath512 and @xmath513 are attached to @xmath514 in @xmath290 and @xmath84 , respectively .",
    "denote by @xmath515 the induced injection @xmath516 .",
    "then @xmath517 in particular , a finite generating set for @xmath83 gives a finite generating set for @xmath518 under pull - back by @xmath515 .",
    "for the inclusion @xmath241 note that any @xmath16-representation @xmath519 of @xmath84 gives rise to a representation @xmath520 of @xmath290 satisfying @xmath521 . hence @xmath515 maps @xmath421 into @xmath522 .    for the inclusion @xmath523 note that ,",
    "as @xmath513 is a completely reducible @xmath16-module , there exist @xmath16-equivariant surjections @xmath524 with @xmath525 . now",
    "the induced projection @xmath526 maps @xmath522 into @xmath421 , and if @xmath527 , then @xmath528 , where @xmath529 lies in @xmath518 .",
    "now we prove our second main result .",
    "recall the statement of the theorem : for any @xmath16-tree @xmath2 we have @xmath530 we proceed by induction .",
    "first , the statement is a tautology for a star @xmath2 .",
    "next , suppose that @xmath2 has an inner vertex @xmath36 of valency @xmath7 and split @xmath531 at @xmath36 .",
    "by induction we may assume that the theorem holds for @xmath50 .",
    "the proof of theorem [ thm : procedure ] shows that @xmath532 so it suffices to prove that each of these terms is contained in the right - hand side of ; we do so for the first term .",
    "we use the notation @xmath533 from the proof of theorem [ thm : procedure ] . by corollary",
    "[ cor : vm ] the ideal of @xmath534 is spanned by polynomials in @xmath535 of the following two forms :    1 .   for all @xmath269",
    "the @xmath328-minors of the @xmath56-th component of @xmath485 , regarded as an element of @xmath330 ; and 2 .",
    "all polynomials of the form @xmath536 , where @xmath537 and @xmath491 is some element of @xmath538 .    the first type of elements are clearly equations for @xmath539 , so we need only worry about the second type of equations . by induction",
    "we may assume that @xmath209 is an equation for @xmath540 for some vertex @xmath105 of @xmath473 .",
    "but then @xmath536 vanishes on @xmath541 , and we are done .",
    "finally , if @xmath2 is not a star and does not contain a vertex of valency @xmath7 , then we proceed as in the proof of theorem  [ thm : procedure ] .",
    "we choose an edge @xmath454 in @xmath2 where both @xmath8 and @xmath105 have valency at least three , and insert vertices @xmath498 with @xmath542 and @xmath458 and @xmath459 to obtain a new @xmath16-spaced tree @xmath170 .",
    "we claim that both sides of remain unchanged in replacing @xmath2 by @xmath170 . for the left - hand side",
    "this was proved in the proof of theorem  [ thm : procedure ] .",
    "the right - hand side gains two terms , namely , @xmath543 and @xmath544 .",
    "however , the definition of flattening readily implies that @xmath545 , so that @xmath546 .",
    "similarly , we find @xmath547 , and hence the two extra terms on the right - hand side of are redundant . now",
    "the theorem for @xmath2 follows from that for @xmath170 , which in turn follows by induction as in the previous case .    finally , we prove the last statement of proposition [ prop : dense2 ] which says that @xmath548 can be computed from the ideal of @xmath175",
    ".    we will apply corollary [ cor : vm ] where @xmath175 will play the role of @xmath234 and @xmath549 will play the role of @xmath235 . to this end",
    "we proceed as in the proof of theorem [ thm : procedure ] .",
    "first set @xmath550 and let @xmath551 be the characters of @xmath16 .",
    "next define @xmath437 as follows : @xmath552 , @xmath553 , and @xmath554 with @xmath103 the left regular representation of @xmath16 .",
    "view @xmath175 as a subvariety of @xmath555 , which can be thought of as @xmath193 , and view @xmath549 as the space @xmath556 under the isomorphism @xmath557 , which can be thought of as @xmath235 .",
    "it is easy to see that @xmath175 is closed under composition with @xmath558 , which is @xmath367 , so that corollary [ cor : vm ] applies .",
    "we conclude that @xmath559 , regarded as a subset of @xmath330 is generated by the rank-@xmath328-minors of the @xmath56-th block for @xmath269 and the polynomials @xmath560 of the form @xmath561 , where @xmath485 is regarded as a @xmath16-homomorphism @xmath562 , @xmath209 runs over @xmath504 and @xmath491 over all elements of @xmath563 , which is @xmath235 .    of course , like in algorithm [ alg : procedure ] , this can be made into a finite set of generators by taking the entries of @xmath491 to be variables , taking @xmath209 in a finite generating set of @xmath504 , expanding , and taking the coefficients of the monomials in @xmath491 .",
    "we have now reduced the ideals of our equivariant models to those for stars , and argued their relevance for statistical applications .",
    "the main missing ingredients for successful applications are equations for star models .",
    "these are very hard to come by : @xcite posed several conjectures concerning these for the general markov model , and special cases of these conjectures were proved in @xcite . for certain important equivariant models equations were found in @xcite . roughly speaking , the less symmetry one imposes on the model , the harder it is to find equations .",
    "the following proposition offers some explanation for this .",
    "[ prop : generalstar ] suppose that @xmath2 is a star with ( based ) centre @xmath105 .",
    "let @xmath564 be representatives of the @xmath16-orbits on @xmath138 and denote by @xmath565 the stabiliser of @xmath566 in @xmath16 .",
    "let @xmath567 denote the cone of pure tensors in @xmath568 , and denote by @xmath240 the reynolds operator for @xmath16 .",
    "then @xmath569 where the addition corresponds to taking the join of these varieties .",
    "elements in an open dense subset of @xmath79 look like @xmath570 where @xmath571 ; the latter element clearly lies in the join @xmath572 .",
    "this argument can be reversed to show the opposite inclusion .",
    "this is particularly interesting in the case when for all internal vertices @xmath36 , @xmath37 is a single @xmath16-orbit . as usual",
    ", we may assume that @xmath2 is a star , and then @xmath79 is simply @xmath573 where @xmath94 is the set of pure tensors in @xmath574 with @xmath575 the stabiliser of some element @xmath576 .",
    "@xmath240 being a linear projection now means that the ideal may be computed by elimination theory , at least in principle .",
    "this applies to ( 1 ) , ( 2 ) , and ( 6 ) in example  [ ex : models ] .    in the following section we record some further observations for abelian groups @xmath16",
    "in this section we collect some results on the equivariant model for an abelian group @xmath16 .",
    "the fact that all irreducible representations of @xmath16 are one - dimensional makes @xmath16-equivariant models somewhat easier to analyse than general equivariant models . recall that an element @xmath310 in a @xmath16-representation is called a weight vector if it is a common eigenvector of all elements of @xmath16 ; in that case the function @xmath577 determined by @xmath578 is a character of @xmath16 .",
    "we also say that @xmath16 scales @xmath310 by @xmath579 .",
    "the following results are a slight generalisation of results in @xcite .",
    "[ prop : star ] suppose that @xmath2 is a star with ( based ) centre @xmath105 , that @xmath16 is abelian and that @xmath138 is a single @xmath16-orbit .",
    "then @xmath79 is a toric variety .",
    "more specifically , there exist tori @xmath580 in @xmath581 for @xmath582 , diagonalised by certain bases of @xmath16-weight vectors such that @xmath583 stabilises @xmath79 with a dense orbit .",
    "fix @xmath584 .",
    "a typical element of @xmath79 looks like @xmath585 with @xmath586 .",
    "as @xmath16 is abelian , @xmath587 is a @xmath16-module .",
    "choose any basis of @xmath587 that diagonalises @xmath16 and let @xmath580 be the associated torus in @xmath588 , regarded as a torus in @xmath581 acting trivially on a @xmath16-stable complement of @xmath587 in @xmath12 .",
    "set @xmath589 .",
    "then @xmath590 sends the element above to @xmath591 which again lies in @xmath79 .",
    "moreover , as each @xmath580 has a dense orbit on @xmath587 , @xmath84 has a dense orbit on @xmath79 .    if @xmath16 is abelian and has @xmath46 orbits on @xmath12 , then @xmath79 for a star @xmath2 is a join of @xmath46 toric varieties .",
    "this fact is exploited in @xcite for the strand - symmetric model , where @xmath417 .",
    "[ thm : toric ] suppose that @xmath16 is an abelian group and that @xmath2 is a @xmath16-tree in which @xmath16 has a single orbit on all @xmath15 with @xmath592 .",
    "then @xmath79 is a toric variety .",
    "more precisely , there exists a torus @xmath84 acting linearly on @xmath44 , stabilising @xmath79 with a dense orbit , and diagonalised by a tensor product of @xmath16-weight bases of the @xmath593 .",
    "we proceed by induction .",
    "first , if @xmath2 is the single edge @xmath141 , then @xmath595 \\otimes v_q[\\mu]$ ] where @xmath596 ranges over pairs of characters of @xmath16 .",
    "let @xmath84 be a maximal torus in @xmath597 which is diagonal with respect to a basis of pure tensors @xmath598 with @xmath599 and @xmath600 weight vectors of weights @xmath601 .",
    "view @xmath84 as a torus in @xmath602 acting trivially on all @xmath603 \\otimes v_q[\\mu]$ ] with @xmath604 .",
    "this @xmath84 has the properties claimed in the theorem .",
    "second , if @xmath2 is a star , then the proposition above does the trick .",
    "third , if @xmath2 is neither a star nor an edge , then let @xmath605 be any internal vertex of valency two .",
    "as in the proof of theorem [ thm : procedure ] we may add such a vertex , if necessary , without changing @xmath79and in fact , if @xmath36 is inserted between the internal vertices @xmath606 , then , as @xmath607 are @xmath16-orbits , @xmath608 is sufficiently large .",
    "write @xmath472 at @xmath36 , let @xmath609 , and let @xmath610 be the tori whose existence is claimed by the theorem for the @xmath16-trees @xmath50 . in particular",
    ", @xmath611 is diagonalised by the tensor product of a @xmath16-weight basis @xmath567 of @xmath612 and a @xmath16-weight basis @xmath613 of @xmath48 ( such a basis is always orthogonal and may be chosen orthonormal ) .",
    "but since @xmath48 is a permutation module with a single orbit , every weight occurs at most once in @xmath48 , so that ( after scaling ) @xmath614 .",
    "now we let @xmath611 act on @xmath612 as follows : let @xmath615 have @xmath16-weight @xmath579 . if @xmath616 is not a weight in @xmath48 , then @xmath617 . if , on the other hand , @xmath616 is a weight in @xmath48 , then it is the weight of a unique @xmath618 , and we let @xmath611 scale @xmath619 by the character with which it scales @xmath620 . now",
    "@xmath621 acts on @xmath622 , and is diagonalised by the tensor product of @xmath623 and @xmath624 .    finally we verify that @xmath84 stabilises @xmath79 with a dense orbit . to see this , observe that the map @xmath625 given by @xmath626 is @xmath627-equivariant : it sends @xmath628 , where @xmath629 and @xmath619 have opposite weight , to @xmath630 , which scales with the same @xmath84-characters by definition of the action of @xmath84 . since @xmath611 has a dense orbit on @xmath631 , @xmath84 has a dense orbit on @xmath79 .",
    "theorem [ thm : toric ] reduces the computation of the ideals of certain equivariant models to the combinatorics of toric varieties ( where we do not require toric varieties to be normal ) .",
    "however , this combinatorics can be very intricate , and it requires great ingenuity to find explicit generators as in @xcite .",
    "we conclude with an example .",
    "[ ex : toric ] first let @xmath2 be a star with centre @xmath36 and four leaves @xmath632 .",
    "let @xmath633 and @xmath634 for all vertices @xmath635 , with basis @xmath16 and induced form . for this @xmath16 and @xmath12 , a star with four leaves is the smallest @xmath16-star for which @xmath636 .",
    "we are free to choose any basis on @xmath44 , so we pick the orthonormal product basis of the basis of @xmath103 diagonalising @xmath16 .",
    "let us denote this basis by @xmath637 where @xmath638 spans the trivial , and @xmath639 the sign representation in @xmath103 .",
    "we will label the basis of @xmath44 given by the pure tensors @xmath640 ( @xmath641 ) as follows : for a subset @xmath642 let @xmath643 where @xmath644 if @xmath645 , and @xmath646 otherwise .",
    "then @xmath416 is spanned by all @xmath647 such that @xmath648 is even .",
    "as @xmath649 , an equivariant representation of @xmath2 is specified by @xmath650 parameters @xmath651 ( @xmath652 ) where @xmath653 is dual to @xmath165 and @xmath654 is dual to @xmath191 in @xmath103 , and @xmath655 ( where @xmath656 are the leaves ) . by proposition  [ prop :",
    "generalstar ] , @xmath657 where @xmath658 is the variety of pure tensors in @xmath44 . specifically ,",
    "if @xmath659 is a representation , then @xmath660 let the variables dual to the basis @xmath661 be denoted by @xmath662 .",
    "then @xmath663 if @xmath648 is odd , and @xmath664 if @xmath648 is even .",
    "thinking of @xmath665 as a subvariety of @xmath416 , for determining the ideal we need to consider only functions in the @xmath662 with @xmath648 even .",
    "there are some obvious relations , namely , if @xmath666 are two subsets of @xmath667 with even number of elements and with complements @xmath668 , @xmath669 , respectively , then @xmath670 is in the ideal of @xmath665 .",
    "note that it is enough to consider @xmath671 where every subset appears once as @xmath198 or @xmath672 , because @xmath673 , and if @xmath674 , then @xmath671 is nonzero only if @xmath675 contains one element .",
    "altogether it follows that the ideal generated by the @xmath671 s is already generated by @xmath676 one can show that @xmath677 is generated by the @xmath671 s . indeed , by (",
    "* theorem 3.1 ) this boils down to showing that these @xmath671 s correspond to a markov basis for the module of @xmath678-linear relations among the @xmath650 vectors @xmath679 where @xmath680 is even and @xmath681 with @xmath682 .",
    "we omit the combinatorial details here .      to illustrate theorem  [ thm : procedure ] , we now consider a @xmath16-tree @xmath2 obtained by gluing together two stars as above at one common leaf ( see figure  [ fig : tree ] ) .",
    "notice that by remark  [ re : valencytwoc ] and lemma  [ le : pushfwd ] @xmath684 where @xmath170 is the tree @xmath2 with vertex @xmath130 removed and the centres of the two stars in @xmath2 joined by an edge .",
    "algorithm [ alg : procedure ] first identifies a vertex of valency @xmath7 ; here vertex @xmath130",
    ". we then write @xmath685 , with @xmath473 the left and @xmath474 the right star with four leaves each . by the above we know the ideals of @xmath686 .",
    "the content of theorem  [ thm : procedure ] in this situation is that @xmath687 because of the symmetry of the problem , we only consider the first summand .",
    "we keep the notation introduced above with respect to @xmath50 : the variables on @xmath431 will be @xmath662 ( @xmath688 , @xmath689 even ) and those on @xmath433 will be @xmath690 ( @xmath691 , @xmath648 even ) .",
    "finally the variables on @xmath416 will be @xmath692 where @xmath693 has an even number of elements ; @xmath672 corresponds to the basis vector @xmath694 where @xmath695 if @xmath696 and @xmath646 otherwise .",
    "we also adopt the convention that @xmath697 if @xmath648 is odd .",
    "the ideal of @xmath698 is generated by @xmath699 and certain @xmath700-minors , since both representations of @xmath701 occur with multiplicity one in @xmath702 .",
    "these minors are of the form @xmath703 where @xmath704 are all distinct and either all even or all odd .",
    "next we show how to find generators of @xmath296 .",
    "the space @xmath433 is isomorphic to @xmath705 with @xmath706 and @xmath707 .",
    "similarly , @xmath708 with @xmath709 and @xmath710 as above .",
    "let @xmath711 be arbitrary and let @xmath712 .",
    "then @xmath713 and a straightforward computation shows that @xmath714 to avoid clumsy notation , let us write @xmath715 for the function @xmath716 in the arguments @xmath717 .",
    "then for example @xmath718 @xmath296 is then generated by all @xmath719 where @xmath209 is in the ideal of @xmath449 .",
    "as observed before , this is the same as the ideal generated by all coefficients of monomials in the @xmath690 s . as an example",
    "let us consider @xmath720 . using the relations  , we get an expression in the @xmath721 s and @xmath690 s . as a function on @xmath722 it is equal to @xmath723 every single coefficient of a monomial in the @xmath690 s then gives a generator for @xmath296 .",
    "it should be clear how to proceed in principle with the other @xmath671 s .",
    "so algorithm  [ alg : procedure ] calls itself twice , once for @xmath473 and once for @xmath474 .",
    "nicholas eriksson , kristian ranestad , bernd sturmfels , and seth sullivant .",
    "phylogenetic algebraic geometry . in _ projective varieties with unexpected properties _ ,",
    "pages 237255 .",
    "walter de gruyter gmbh & co. kg , 2005 ."
  ],
  "abstract_text": [
    "<S> we introduce equivariant tree models in algebraic statistics , which unify and generalise existing tree models such as the general markov model , the strand symmetric model , and group - based models such as the jukes - cantor and kimura models . </S>",
    "<S> we focus on the ideals of such models . </S>",
    "<S> we show how the ideals for general trees can be determined from the ideals for stars . </S>",
    "<S> a corollary of theoretical importance is that the ideal for a general tree is generated by the ideals of its flattenings at vertices . </S>",
    "<S> the main novelty is that our results yield generators of the full ideal rather than an ideal which only defines the model set - theoretically . </S>"
  ]
}