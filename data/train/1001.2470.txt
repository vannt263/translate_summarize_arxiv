{
  "article_text": [
    "massive stars influence the surrounding universe far out of proportion to their numbers through ionizing radiation , supernova explosions , and heavy element production .",
    "their formation requires the collapse of massive interstellar gas clouds with accretion rates exceeding @xmath0  m@xmath1  yr@xmath2 @xcite to reach their final masses before exhausting their nuclear fuel @xcite .",
    "massive stars can ionize the gas around them , forming h  ii  regions , that traditionally have been modelled as spherical bubbles expanding in a uniform medium @xcite .",
    "this approach , however , fails to explain their observed numbers and morphologies @xcite .",
    "a more recent alternative picture models h  ii  regions as the ionized section of the accretion flow that feeds the young massive star @xcite .",
    "the rich diversity of observed h  ii  regions thus bears witness to the complexity of high - mass star formation .",
    "h  ii  regions form around accreting protostars once they exceed @xmath3m@xmath4 , equivalent to a spectral type of early b. thus , accretion and ionization must occur together in the formation of massive stars .",
    "the pressure of the 10@xmath5  k ionized gas far exceeds that in the 10@xmath6  k accreting molecular gas , producing feedback in the form of ionized outflows @xcite .",
    "high - mass stars form in denser and more massive cloud cores @xcite than their low - mass counterparts @xcite .",
    "high densities also result in local gravitational instabilities in the accretion flow , resulting in the formation of multiple additional stars @xcite .",
    "young massive stars are almost always observed to have companions @xcite , and",
    "the number of their companions significantly exceeds those of low - mass stars @xcite .",
    "such companions influence subsequent accretion onto the initial star @xcite .",
    "observations show an upper mass limit of about @xmath7m@xmath1 .",
    "it remains unclear whether limits on internal stability or termination of accretion by stellar feedback determines the value of the upper mass limit @xcite .    around the most luminous stars ,",
    "the outward radiation pressure can counterbalance the inward gravitational attraction . a spherically symmetric calculation of radiation pressure on dust yields equality at just under 10 m@xmath4 @xcite .",
    "however , the dust opacity is wavelength dependent , the accretion is non - spherical , the mass - luminosity ratio is different for multiple companions than for a single star , and the momentum of the accretion flow must be reversed , rather than just achieving static force balance @xcite .",
    "observations @xcite provide evidence for the presence of all these mitigating factors , and numerical experiments combining some of these effects @xcite confirm their effectiveness , showing that radiation pressure is not dynamically significant below the eddington limit .",
    "the most significant differences between massive star formation and low - mass star formation seem to be the clustered nature of star formation in dense accretion flows and the ionization of these flows .",
    "we present the first three - dimensional simulations of the collapse of a molecular cloud to form a cluster of massive stars that include ionization feedback , allowing us to study these effects simultaneously . during recent years",
    "the problem of massive star formation was tackled in a number of three - dimensional numerical studies ( see e.g. * ? ? ? * for a recent review ) .",
    "however , none of these simulations included the self - consistent ionization feedback from massive protostars that dynamically condense out of gravitationally unstable regions .",
    "@xcite performed the first hydrodynamic calculation of a star cluster forming region to include a simplified treatment of ionization feeback , but only from a single source that was inserted into a pre - existing simulation and whose ionizing flux did not depend on the mass of the growing ( proto-)star . also , heating by the accretion luminosity and from the stellar photosphere is neglected in these calculations , but is included in ours .",
    "other calculations that incorporate ionizing radiation focus on triggered star formation and turbulence by external sources  @xcite . using a flux - limited diffusion approximation , @xcite incorporated radiation feedback in their calculations of massive star formation .",
    "these calculations showed that radiation pressure from non - ionizing radiation can not halt accretion onto the massive protostar and therefore is not able to set an upper mass limit of such stars ( see also * ? ? ?",
    "nevertheless , these simulations lack the important feedback from ionizing radiation distinctive of massive star formation .    in the following , we present our numerical method (   [ s : numerics ] ) and give a detailed analysis of the simulation results .",
    "we discuss the accretion history of the stellar cluster (   [ accretion ] ) , the fragmentation of the rotationally flattened structure , and the generation of ionization - driven bipolar outflows (   [ bipolar ] ) , and compare synthetic radio continuum and line observations with observed data (   [ comparison ] ) .",
    "finally , we discuss the relation of our numerical model to previous work (   [ discussion ] ) , and the relevance of our findings for massive star formation (   [ conclusions ] ) .",
    "we use a modified version of the flash code @xcite , an adaptive - mesh code that integrates the compressible gas dynamic equations with self - gravity and radiation feedback .",
    "our modifications include the propagation of both ionizing and non - ionizing radiation to follow heating , though not radiation pressure , a refinement criterion to resolve the jeans length @xcite , various cooling processes of relevance for protostellar collapse @xcite ; and lagrangian sink particles @xcite . here",
    "we report on our new modifications to the code .",
    "to propagate radiation , we use the hybrid characteristics raytracing module originally developed by @xcite .",
    "parallel raytracing on a block - structured adaptive mesh requires the solution of an inverse problem : given the position in the domain , the corresponding block identifier is needed .",
    "this problem was originally approached by storing the block identifier in one single large array corresponding to a fully refined domain .",
    "each entry in this array could be mapped to a ( potential ) cell in the domain and vice versa , so that the block identifier could be obtained by looking up the stored value .",
    "this solution is straightforward and fast , but it violates the principles of adaptive mesh refinement and becomes extremely memory consuming at high resolution .",
    "collapse simulations are impossible using this method .    instead of creating one large array , we use the fact that flash stores hierarchical information about its block structure .",
    "every block in the adaptive - mesh hierarchy has information about its parent and child blocks as well as on its neighbors at the same level of refinement .",
    "valid data is stored for blocks of highest refinement only , which are called leaf blocks .",
    "neighboring leaf blocks can differ only by one level of refinement .",
    "this hierarchical information makes it possible to perform a tree walk in the adaptive - mesh hierarchy .    starting from a block",
    "whose identifier is known , we determine the direction in which the ray leaves the block . if there is a neighboring block on the same level of refinement , it can either still be a leaf block or have one level of children . in the former case the new block",
    "is already found , in the latter case the child blocks must be checked .",
    "if there is no neighboring block at the same refinement level , the new block must be the neighbor of the parent of the current block in this direction .",
    "although the method is more complicated than the original one , it is equally fast since the hierarchical data can be effectively stored and communicated among processors .    the radiation module has been tested for its capability of accurately casting shadows @xcite and tracing r - type ionization fronts in a cosmological setting @xcite . for simulations of massive star formation",
    ", the expansion of d - type ionization fronts should be adequately modeled .",
    "we have tested the ionization physics in our model against an approximate solution found by @xcite for the expansion of a d - type ionization front into a homogeneous medium . given the strmgren radius @xmath8 and the sound speed of the ionized gas @xmath9 ,",
    "the radius @xmath10 of the ionization front at time @xmath11 is given by @xmath12    a comparison of our numerical simulation with this analytic solution is plotted in fig .",
    "[ spitzercomp ] .",
    "we show the data from two different simulations , both of which had initial density @xmath13  g  @xmath14 , ionizing luminosity @xmath15  s@xmath2 , and were run with a maximum resolution of @xmath16  pc . in the first run",
    ", we used an isothermal equation of state ( @xmath17 ) and included no cooling processes . in the second",
    ", we set @xmath18 and used the cooling curve from @xcite . in both simulations ,",
    "the ionization fraction and temperature of the ionized gas was determined self - consistently by solving a rate equation for the ionization fraction as discussed in @xcite .",
    "we compare the numerical result in each case with the result from equation  ( [ stromgren ] ) using the appropriate sound speed in the ionized gas @xmath19 , where @xmath20 is boltzmann s constant and @xmath21 is the mean mass per particle .",
    "the agreement of each run with the analytical solution and with each other is acceptable .",
    "the decent agreement even in the presence of cooling demonstrates that numerical diffusion from the cold , dense , neutral shell into the hot , ionized interior does not lead to significant unphysical cooling of the hot interior .     of the ionization front as function of time @xmath11 .",
    "the analytical data is dashed , the numerical data is solid .",
    "the plot shows a run with an isothermal equation of state ( @xmath17 ) without cooling and a run with @xmath18 and a cooling curve .",
    "the results agree well , both with the analytic solution , and with each other . ]",
    "we show a slice of the expanding h  ii  region in figure  [ spitzerslice ] .",
    "the whole box shown has an effective numerical resolution of @xmath22 grid points .",
    "small deviations from a perfectly spherical shape are visible .",
    "this is because the sphere is initially not very well resolved , so that dynamical processes inside the h  ii  region can lead to an amplification of grid effects .",
    "resolution studies in two dimensions that we have performed show that this effect diminishes with increasing resolution .          to trace the collapse of individual fragments",
    ", we use a sink particle technique that we developed for the flash code   @xcite ( see also @xcite ) . here , sink particles are created if the local density exceeds a critical value @xmath23 and the region within the sink particle radius @xmath24 is gravitationally bound and collapsing . for the high resolution simulations ( run a and run b ) , we use @xmath25g@xmath14 and @xmath26au , for the lower resolution simulations ( run ca and run cb ) , we take @xmath27g@xmath14 and @xmath28au . the sink particles gain mass through accretion of overdense gas within the accretion radius that is gravitationally bound to it .",
    "the particles interact gravitationally with the gas and with themselves and are free to move within the simulation box , independent of the underlying grid structure , i.e. they are treated fully lagrangian .",
    "we use the properties of these lagrangian sink particles as sources for the radiation module .",
    "a prestellar model is used to determine luminosity and effective temperature of the source as function of protostellar mass and accretion rate .",
    "we set the stellar luminosity by a zero - age main sequence @xcite and the accretion luminosity by interpolation from a more detailed model @xcite .",
    "the photoionization rate and the photoionization heating rate are set by the specific mean intensity along a ray @xmath29 .\\ ] ] here , @xmath30 is the distance from the source , @xmath31 the radius of the star , @xmath32 the effective temperature of the star , @xmath33 the frequency , @xmath34 the speed of light , @xmath35 planck s constant , @xmath36 boltzmann s constant and @xmath37 the optical depth for the ionizing radiation , which is calculated using the absorption coefficient of atomic hydrogen @xcite .",
    "hence , the strength of the ionizing radiation is totally determined by @xmath31 and @xmath32 .",
    "we use a zero - age main sequence ( zams ) model derived from the freely available stellar evolution code ez @xcite to calculate these quantities .    to also include heating by non - ionizing radiation ,",
    "we have extended the raytracing module to calculate planck mean opacities following the @xcite interpolation of data from @xcite .",
    "we use the non - relativistic approximation for the dust heating term ( see e.g. , * ? ? ?",
    "* ) @xmath38 with the planck mean opacity @xmath39 , the gas density @xmath40 and the total radiation energy @xmath41 . in the raytracing approximation ,",
    "the heating due to stellar radiation is thus given by @xmath42 \\rho(r ) \\exp[-{\\tau_\\mathrm{pm}}(r ) ] { t_\\mathrm{star}}^4\\ ] ] with the stefan - boltzmann constant @xmath43 and the planck mean opacity @xmath44 .",
    "in addition to the stellar heating , we also include a model for accretion heating . to this end",
    ", we assume that the potential energy of the gas which is released during accretion is fully converted into radiation at the accretion radius @xmath45 , so that the accretion luminosity is given by @xmath46 with newton s constant @xmath47 , the protostellar mass @xmath48 and the accretion rate @xmath49 .",
    "since we do not account for diffuse radiation , the accretion heating also originates from the sink particles and leads to another heating term of the form @xmath50 \\rho(r ) \\exp[-{\\tau_\\mathrm{pm}}(r ) ] { t_\\mathrm{acc}}^4 .\\ ] ] to determine the accretion radius @xmath45 and the effective temperature @xmath51 of the accretion luminosity , we interpolate the results of the prestellar evolution model of @xcite from the current accretion rate and protostellar mass .",
    "we start our calculations with a molecular cloud with a mass of @xmath52m@xmath1 and an initial temperature of @xmath53k .",
    "the cloud has a flat inner region with @xmath54pc radius , surrounded by a region in which the density drops as @xmath55 .",
    "the core density is @xmath56 g@xmath14 .",
    "the whole simulation box has an edge length of @xmath57pc .",
    "the core is in solid body rotation with a ratio of rotational to gravitational energy @xmath58 .",
    "we then run the simulation allowing sink particles to continue forming for @xmath59kyr after the formation of the first one .",
    "note that the total simulation time is @xmath60myr .",
    "these initial conditions represent an extrapolation from lower mass prestellar cores , which are well described by density profiles similar to bonnor - ebert spheres ( see e.g. , * ? ? ?",
    "* ) , towards higher masses and larger scales .",
    "after a simulation runtime of @xmath61kyr , the flat inner part has totally disappeared , and a centrally condensed structure with a peak density of @xmath62  g  @xmath14 and a radius of @xmath63pc has emerged .",
    "this is the stage at which infrared dark clouds are typically observed ( see e.g. , * ? ? ?",
    "* ) .    in some runs ,",
    "we choose to suppress secondary sink formation and instead use a density - dependent temperature floor to prevent runaway collapse of dense blobs of gas .",
    "we need to resolve the local jeans length with @xmath64 cells @xcite .",
    "to do so , we introduce a dynamical temperature floor @xmath65 where @xmath21 is the mean molecular weight , @xmath66 the proton mass , and @xmath67 the cell size .",
    "we consider two full resolution simulations with a cell size at the highest refinement level of 98  au ( 11 refinement levels ) .",
    "in one , run a , we artificially suppress disk fragmentation using the dynamical temperature floor , while in the other , run b , we permit it and dynamically form secondary sink particles .",
    "in addition , we ran two half resolution simulations with maximum resolution of 196  au ( 10 refinement levels ) and suppressed secondary sink formation .",
    "one of these runs , run ca , starts with identical initial conditions to runs a and  b , while run cb has an additional @xmath68-perturbation of @xmath69 of the gas density  @xcite .",
    "the high - resolution stellar cluster simulation run  b reaches @xmath70 grid cells by the end of the simulation , and required @xmath71 cpu hours to complete .",
    "an overview of the runs with their different model parameters is given in tab .",
    "[ tab : colsim ] .",
    ".overview of collapse simulations . [ cols=\"^,^,^\",options=\"header \" , ]",
    "we first examine the accretion histories of our different models .",
    "figure  [ accretion - rate ] shows that in run  a , with only one sink particle allowed to form , nothing halts accretion onto the central protostar .",
    "it continues to grow at an average rate of @xmath72m@xmath73yr@xmath2 until we stop the calculation when the star has reached @xmath74m@xmath1 .",
    "the increasingly massive star ionizes the surrounding gas , raising it to high pressure .",
    "this gas breaks out above and below the disk plane , but it can not halt mass growth through the disk mid - plane .",
    "[ accretion - rate ]    we ran our lower resolution simulations with a single sink particle , runs ca and cb , until the sink particles reached masses of @xmath75m@xmath1 and @xmath7m@xmath1 without any reduction in the mass accretion rate .",
    "figure  [ lowsim ] shows the accretion history for these simulations .",
    "one can clearly see that neither the additional perturbation nor the change in resolution has any significant influence on the overall accretion behavior",
    ". runs  ca and  cb accrete at mean rates of @xmath76m@xmath73yr@xmath2 and @xmath77m@xmath73yr@xmath2 , almost identical to the value for run a , showing that this quantity is well converged .",
    "these simulations with a single sink particle strongly suggest that ionization feedback alone does not limit massive star accretion .",
    "m@xmath1 , run ca at @xmath7m@xmath1 and run cb at @xmath75m@xmath1 .",
    "the mean accretion rates of @xmath78m@xmath73yr@xmath2 , @xmath79m@xmath73yr@xmath2 and @xmath80m@xmath73yr@xmath2 , respectively , are also very similar .",
    "there is no indication that ionization may stop accretion.,title=\"fig : \" ] m@xmath1 , run ca at @xmath7m@xmath1 and run cb at @xmath75m@xmath1 .",
    "the mean accretion rates of @xmath78m@xmath73yr@xmath2 , @xmath79m@xmath73yr@xmath2 and @xmath80m@xmath73yr@xmath2 , respectively , are also very similar .",
    "there is no indication that ionization may stop accretion.,title=\"fig : \" ]    in contrast , in run b , where multiple sink particles are allowed to form , two subsequent sink particles form and begin accreting soon after the first one , and many more follow within the next @xmath81yr ( see fig .",
    "[ accretion - rate ] ) . by that time",
    "the first sink has accreted @xmath82m@xmath1",
    ". within another @xmath83yr seven further fragments have formed , with masses ranging from @xmath84m@xmath1 to @xmath85m@xmath1 while the first three sink particles have masses between @xmath86m@xmath1 and @xmath87m@xmath1 , all within a radius of @xmath88pc from the most massive object .",
    "accretion by the secondary sinks terminates the mass growth of the central massive sinks .",
    "material that moves inwards through the disk driven by gravitational torques accretes preferentially onto the sinks at larger radii @xcite .",
    "eventually , hardly any gas makes it all the way to the center to fall onto the most massive objects .",
    "this fragmentation - induced starvation prevents any star from reaching a mass @xmath89m@xmath1 in this case .",
    "the accretion behavior in run  b contrasts sharply with competitive accretion models @xcite , which have no mechanism to turn off accretion onto the most massive stars . in these models",
    ", material falls all the way down to the massive stars sitting in the center of the gravitational potential which thereby take away the gas from the surrounding low - mass stars . in our fragmentation - induced starvation scenario ,",
    "exactly the opposite happens .",
    "the different behaviour of the multiple sink simulation ( run b ) and the single sink simulation ( run a ) can be understood by looking at slices of density in the disk plane , as shown in figures  [ diskfragmulti ] and  [ diskfragsingle ] . in run",
    "b , secondary sink particles form in the disk filaments , which remove gas from the common reservoir .",
    "consequently , the most massive stars can not maintain their high accretion rates .",
    "it is this halting of the accretion flow that allows the ionizing radiation to create a bubble around the massive protostars .",
    "in contrast , the sink particle in run a is embedded in an accretion flow at all times .",
    "the ionizing radiation does blow away a significant fraction of gas from the sink particle , but it is not able to do so in all directions .",
    "there is always a region in the disk midplane around the sink particle where the gas is dense enough that evaporation by the ionizing radiation remains insufficient to stop the accretion flow .        .",
    "this time the filaments do not form protostars but blobs of gas which are puffed up by the dynamical temperature floor .",
    "the ionizing radiation is unable to create a bubble in the strong accretion flow large enough to stop accretion . ]",
    "in all runs , the h  ii  regions are trapped in the disk plane but drive a bipolar outflow perpendicular to the disk .",
    "the highly variable rate of accretion onto protostars as they pass through dense filaments causes fast ionization and recombination of large parts of the interior of the perpendicular outflow .",
    "the h  ii  regions around the massive protostars do not uniformly expand , but instead fluctuate rapidly in size , shape and flux .",
    "the differences between the single and multiple fragment runs a and run b are also evident from the characteristics of the bipolar outflows .",
    "figures  [ outflowfragmulti ] and  [ outflowfragsingle ] show density slices perpendicular to the disk plane for both simulations .",
    "figure  [ outflowfragmulti ] shows the outflows driven by the most massive sink particle in run b. the efficient shielding by the filaments and the motion of the sink particle hinder the thermal pressure of the ionized gas from driving a symmetric bipolar outflow at early times .",
    "the shielding of the ionizing radiation leads to a drop in the thermal pressure which drives and supports the outflow , and thus the outflow can be quenched again . at later times , the strong accretion flow onto the sink particle stops , and this allows the sink particle to drive a much larger outflow , which in the end has the form of a bubble .",
    "the situation for the sink particle in run a is presented in figure  [ outflowfragsingle ] .",
    "the general properties of the outflow are very similar , but the big difference is that here the accretion flow never stops . on the contrary , figure  [ accretion - rate ] shows that the accretion rate increases towards the end of the simulation .",
    "this strong accretion flow fully absorbs the ionizing radiation , so the sink particle is unable to build up a bubble , even though it has more than three times the mass of the most massive star in run b.    observed outflows @xcite from o - type protostars with ages @xmath90 yr tend to be much wider than those from low- or even intermediate - mass protostars . when resolved , these outflows show a disordered appearance that may be the outcome of multiple powering sources ( including h  ii  regions ) and non - steady driving .",
    "the pressure - driven outflows produced by h  iiregions in our simulations reproduce these broad , disordered outflows well .",
    "collimated outflows from less massive protostars without h  ii  regions are likely magnetically driven , though ( see e.g. , * ? ? ?",
    "a more detailed model linking these two types of outflows is out of the scope of this paper .    .",
    "the slice plane is chosen such that it includes the sink particle of interest and is centered around it . ]    .",
    "the slice plane is chosen such that it includes the sink particle of interest and is centered around it . ]",
    "we can directly compare our models with radio observations of free - free continuum , hydrogen recombination lines , and nh@xmath91 inversion lines by generating synthetic maps .",
    "we generate radio continuum maps from our numerical data by integrating the radiative transfer equation in the rayleigh - jeans limit while neglecting scattering @xcite . to this end",
    ", we calculate for every cell in the domain the free - free absorption coefficient for atomic hydrogen @xmath92 where @xmath93 is the number density of free electrons , @xmath94 the gas temperature and @xmath33 the frequency .",
    "the optical depth at distance @xmath30 is then @xmath95 without scattering , the radiative transfer equation for the brightness temperature can be directly integrated and yields @xmath96 if @xmath97 is the solid angle subtended by the beam , the resulting flux density is @xmath98 following the algorithm described in @xcite , we convolve the resulting image with the beam width and add some noise according to the telescope parameters .    for a time - series comparison at high temporal resolution , we select a few time intervals in the multi - sink run ( run b ) during which the continuum emission from a particular , well - isolated , h  ii  region varies strongly .",
    "we then produced 2  cm continuum maps every @xmath99 yr from the simulation output and measured the properties of the region , including the observational scale length @xmath100 , the flux @xmath101 , and the accretion rate of the protostar @xmath102 that powers the h  ii  region .",
    "@xmath100 is defined as the equivalent diameter of a circle with the same area as the emission .",
    "@xmath101 is obtained by integrating the intensity of the maps over solid angle .",
    "@xmath102 is the accretion rate of the sink particle .",
    "we generate synthetic observations of line emission using our radiative transfer code mollie @xcite .",
    "this code generally uses the accelerated lambda iteration algorithm @xcite although in this investigation we compute the level populations of nh@xmath103 assuming local thermodynamic equilibrium ( lte ) and assume optically thin conditions for the h53@xmath104 recombination line .",
    "the computation is done on 4 nested grids with spatial scales ranging from 80 to 640 au and covering 0.2 pc .",
    "the maps of the nh@xmath103 and h53@xmath104 velocities show the first moment , in the case of nh@xmath103 integrating over the main hyperfine line of the ( 3,3 ) transition .      our simulated observations of radio continuum emission reproduce the morphologies reported in surveys of ultracompact h  iiregions @xcite",
    ". figure  [ radio - morphology ] shows typical images from run  b , and the online material contains a movie of the entire run .",
    "the h  ii  regions in our model fluctuate rapidly between different shapes while accretion onto the protostar continues .",
    "when the gas reservoir around the two most massive stars is exhausted , their h  ii  regions merge into a compact h  ii  region similar to the extended envelopes often observed around ultracompact h  iiregions @xcite .",
    "our results suggest that the lifetime problem of ultracompact h  ii  regions @xcite is only apparent . since h  ii  regions embedded in accretion flows are continuously fed , and since they flicker with variations in the flow rate , their size does not depend on their age until late in their lifetimes .    the same mechanisms that cause the different accretion behavior (   [ accretion ] ) and bipolar outflows (   [ bipolar ] ) for run  a and run  b also lead to differences in the h  ii  region morphologies",
    "one the one hand , the permanent accretion flow in run  a quenches the h  ii  region in the disk plane . on the other hand , the higher stellar mass in run  a leads to larger h  ii  regions perpendicular to the disk plane .",
    "since the second effect dominates , the bottom line is that the h  ii  regions in run  a are generally larger than in run  b. hence , multiple sink formation is not only necessary to model the gas fragmentation correctly , it is also crucial to reproduce the large relative fraction of spherical h  ii  regions observed in surveys @xcite . a detailed investigation of the h  ii  region morpholgies , including a comprehensive statistical analysis for both simulations , will be presented in a follow - up paper .    to compare more directly to observations of the time variability of h  ii  regions",
    ", we analyzed a few time intervals of interest at a time resolution of @xmath99 yr .",
    "we find that when the accretion rate to the star powering the h  ii  region has a large , sudden increase , the ionized region shrinks , and then slowly re - expands .",
    "this agrees with the contraction , changes in shape , or anisotropic expansion observed in radio continuum observations of ultracompact h  ii  regions over intervals of @xmath105 10@xmath106yr @xcite .",
    "figure  [ timeseries ] shows that the sudden accretion of large amounts of material is accompanied by a fast decrease in the observed size and flux of the h  ii  region . in the left panel ,",
    "the h  ii  region is initially relatively large , and accretion is almost shut off .",
    "a large ( from 0 to @xmath107 yr@xmath2 ) , sudden accretion event causes the h  ii  region to shrink and decrease in flux .",
    "the star at this moment has a mass of @xmath108m@xmath4 . in the right panel ,",
    "the star has a larger mass ( @xmath109m@xmath4 ) , the h  ii  region is initially smaller , and the star is constantly accreting gas . the ionizing - photon flux appears to be able to ionize the infalling gas stably , until a peak in the accretion rate by a factor of three and the subsequent continuous accretion of gas makes the h  ii  region shrink and decrease in flux .",
    "the h  ii  region does not shrink immediately after the accretion peak because the increase is relatively mild and the geometry of the infalling gas permitted ionizing photons to escape in one direction .",
    "our results show that observations of large , fast changes in ultracompact h  iiregions @xcite are controlled by the accretion process . both the scale length and flux decrease at rates of 57 % per year in our model , agreeing well with observed fluctuations of 29 % per year @xcite .",
    "shortly after the minimum values are reached , the h  ii  regions re - expand , on timescales @xmath110  yr .",
    "we can compare our models to a well - studied example of an ultracompact h  ii  region , w51e2 @xcite .",
    "although we did not choose parameters specifically to model this region , the comparison is nevertheless revealing . in figure  [ w51 ]",
    "we show simulated and observed maps of nh@xmath91 emission , 1.3  cm thermal continuum emission , and the h53@xmath104 radio recombination line .",
    "the simulated maps were made at a time when a 20 m@xmath4 star has formed in run b.    in the simulated observations , the origin of the coordinates is referenced to the location of the 20 m@xmath4 protostar at the center of the accretion flow as marked .",
    "the accretion flow and disk are viewed edge - on .",
    "the spatial scale in the observations ( lower panels ) is 5100 au per arc sec assuming w51e2 is at a distance of 5.1  kpc @xcite .",
    "the color bar on the right of each figure shows the molecular velocities in km s@xmath2 .",
    "the velocities of the observations include the lsr velocity of w51e2 , approximately 57 kms@xmath2 .",
    "the white contour levels are 50% through 90% of the peak brightness temperature of 71 k ( upper left ) and 0.1 , 0.2 and 0.3 jy beam@xmath2 kms@xmath2 ( lower left ) .",
    "the red contour levels are 30% , 70% , and 95% of the peak 1.3 cm continuum brightness temperature of 8902 k ( upper left ) and 0.07 , 0.14 , and 0.22 jy / beam ( lower left ) .",
    "the white contours on the h53@xmath104 observations ( lower - right ) show the 7 mm continuum emission at 2 , 4 , 10 , 30 , 50 , 70 , and 90% of the peak emission of 0.15 jy beam@xmath2 .",
    "the molecular line observations are from @xcite .",
    "the h53@xmath104 observations are from @xcite .",
    "both observations have a beamsize of about 1@xmath111 .",
    "coordinates are in the b1950 epoch .",
    "the brightest nh@xmath91 emission indicates the dense accretion disk surrounding the most massive star in the model , one of several within the larger - scale rotationally flattened flow .",
    "the disk shows the signature of rotation , a gradient from redshifted to blueshifted velocities across the star .",
    "a rotating accretion flow is identifiable in the observations , oriented from the se ( red velocities ) to the nw ( blue velocities ) at a projection angle of 135@xmath112 east of north ( counterclockwise ) .",
    "the 1.3 cm radio continuum traces the ionized gas , which in the model expands downward perpendicularly to the accretion disk , down the steepest density gradient . as a result ,",
    "the simulated map shows the brightest radio continuum emission just off the mid - plane of the accretion disk , separated from the central star , rather than surrounding it spherically .",
    "in the observations of w51e2 , continuum emission is indeed offset from the accretion disk traced in ammonia .",
    "the nh@xmath103(3,3 ) in front of the h  ii  region is seen in absorption and red - shifted by its inward flow toward the protostar .",
    "the density gradient in the ionized flow determines the apparent size of the h  ii  region .",
    "therefore the accretion time scale determines the age of the h  ii  region rather than the much shorter sound - crossing time of the h  ii  region .",
    "photoevaporation of the rotationally flattened molecular accretion flow supplies the ionized outflow .",
    "therefore , the ionized gas rotates as it flows outward , tracing a spiral .",
    "an observation that only partially resolves the spatial structure of the ionized flow sees a velocity gradient oriented in a direction between that of rotation and of outflow , as shown in the simulated observation .",
    "the observed h53@xmath104 recombination line @xcite in figure  [ w51 ] indeed shows a velocity gradient oriented between the directions of rotation and the outflow .",
    "in this work , we focus on the impact of feedback from radiative heating by both ionizing and non - ionizing radiation during massive star formation .",
    "our work is complementary to recent simulations that neglect ionizing radiation but include other effects .",
    "for example , we use a ray - tracing algorithm to describe ionizing and non - ionizing radiation while @xcite rely on flux - limited diffusion to follow the radiation field . like us , these models include heating from accretion luminosity . they neglect heating by ionizing radiation , but do include radiation pressure and scattering effects .",
    "radiation pressure in particular becomes important at the 10  au scale .",
    "these models therefore simulate rather smaller scales than we do , starting from a @xmath113 core of only @xmath114pc radius , as opposed to our more massive clump with @xmath115 and a @xmath116pc radius . as a result ,",
    "our calculations are better geared towards describing the cluster - forming scale as opposed to modeling in detail the mass growth of individual protostars through their inner accretion disks .",
    "@xcite show that radiation pressure can not stop accretion onto the massive protostar and is dynamically unimportant except for massive star clusters near the galactic center or in starburst galaxies  @xcite .",
    "@xcite initialized a microturbulent flow within their dense core , but @xcite found that it made little difference by the time material had collapsed to the size of the disk .",
    "in addition , @xcite include magnetic fields and find that they provide some support for low - density gas , thus reducing the amount of matter available for accretion .",
    "@xcite , @xcite , @xcite , @xcite and @xcite furthermore show that the presence of magnetic fields can dramatically alter the shape and size of accretion disks and strongly suppress the formation of close binary systems .",
    "these last results , may , however , be an artifact of the neglect of turbulent and ambipolar diffusion within the disks in these models . @xcite and @xcite , on the other hand , focused on mechanical feedback through winds and bipolar outflows , without and with magnetic fields respectively , but neglect radiative heating entirely .",
    "they find that outflows further limit accretion , but do not fundamentally change the picture of cluster formation in a gravitationally unstable accretion flow .",
    "ultimately , the quantitative characterization of the star formation efficiency will require treating the effects of radiation , magnetic fields , and outflows simultaneously .",
    "as noted above , we have neglected a number of physical processes , including radiation pressure , scattering , magnetic fields , winds and bipolar outflows , and turbulent initial conditions .",
    "in addition , we here discuss other approximations that we have made .",
    "our prestellar model is designed such that the number of uv photons emitted by the protostar is overestimated for three reasons .",
    "first , we use a zams model to set the ionizing luminosity , while the models of @xcite suggest that the protostellar radii of massive stars can be larger than the zams value , leading to a smaller ionizing luminosity compared to the zams value .",
    "second , we neglect the aborption of uv photons by dust inside the h  ii  region .",
    "thus , the sizes of our h  ii  regions represent upper limits to the real values .",
    "third , the dense inner disk around each protostar is subsumed in the sink particle , allowing radiation to propagate along the disk midplane to the edge of the sink particle , where densities will be lower .",
    "however , as discussed in   [ accretion ] , we find that , although we overestimate the strength of the ionizing radiation , it is unable to stop accretion onto a single massive star . similarly , in   [ comparison ]",
    "we showed that the strength of the accretion flow restricts the expansion of the h  ii  region , which solves the lifetime problem of ultracompact h  ii  regions @xcite .",
    "both results are robust in the sense that the impact of the ionizing radiation on the accretion flow and the sizes of the h  ii  regions would even be smaller if we used a more detailed modeling of the protostellar evolution and environment , and included dust absorption .",
    "we also note that , although we nominally use a simplified treatment of radiative losses in the optically thick regime , this will not have an impact on the dynamics of the simulated system , as we expect that the gas will become optically thick at densities of @xmath117g@xmath14  ( e.g. * ? ? ?",
    "* ) , which is two orders of magnitude above the threshold density for sink creation .",
    "our results suggest that the accretion flow onto massive stars can not be stopped by ionizing radiation (   [ accretion ] ) . instead",
    ", the growth of massive stars is halted by competition from lower - mass companions that form by gravitational fragmentation in the dense , rotationally flattened , accretion flow .",
    "this process , which we call fragmentation - induced starvation , limits the maximum stellar mass of the highest - mass star in our simulations .",
    "our models lead to a self - consistent picture of massive star formation where massive stars form through ( unsteady ) mass growth within a gravitationally unstable accretion flow .",
    "radiation feedback from the accretion luminosity and the protostellar surface heats up the environment in which the first massive protostar forms @xcite .",
    "this increases the local jeans mass , so that subsequent fragments in the neigborhood of this star are relatively massive , naturally resulting in a cluster of massive stars .",
    "unlike in the competitive accretion model  @xcite where the most massive protostar continues to accrete from the common gas reservoir , in our model accretion is shut off by the subsequent fragmentation of the gas because the lower - mass companions intercept material that would otherwise accrete onto the central star , starving it of material .",
    "fragmentation - induced starvation will only occur in regions with high enough density for many massive fragments to form despite accretion heating . in our models ,",
    "the most massive star starts to form early and completes accretion while the whole cluster is still growing , contrary to standard competitive accretion models in which the most massive star grows over the whole cluster evolution timescale . on the other hand ,",
    "competition for a common reservoir continues to define the top end of the initial mass function , unlike in models that rely on the clump mass spectrum to define the stellar initial mass function .",
    "our models show (   [ comparison ] ) that the h  ii  regions formed around massive young stars flicker but do not grow systematically while heavy accretion from the protostellar core continues .",
    "this behavior seems able to explain the many puzzles raised by observations of ultracompact h  ii  regions .",
    "the chaotic interaction between gravitationally unstable gas filaments in the accretion disk and ionizing radiation from the young stars creates a great variety of different ultracompact h  ii  region morphologies .",
    "we find shell - like , core - halo , cometary , spherical and irregular morphologies in a single simulation , depending on the current flow field and viewing angle .",
    "our models show behavior consistent with observations of shrinking h  iiregions with changes in size or flux of a few percent per year , as a consequence of denser material being accreted the star and shielding the ionizing radiation . shielding by",
    "the disk also produces uncollimated bipolar outflows in our models ( see   [ bipolar ] ) . these results lead to an evolution scenario for h  ii  regions that is substantially different from the classical picture of monotonically expanding hot bubbles .",
    "the surprising dynamics of h  ii  region flickering resolves the lifetime problem for ultracompact h  iiregions , since the size of the h  ii  region remains unrelated to the age of the protostar , as long as fast accretion continues . a detailed comparison of simulated observations of our model with the ultracompact h  ii  region w51e2 demonstrates that our model reproduces distinctive features of massive star forming regions such as h  iiregions expanding asymmetrically away from the protostar down the steepest density gradient , and outward - twisting , spiraling , ionized flows .",
    "all these observations can be understood as consequences of ionization within a gravitationally unstable accretion flow .",
    "t.p . is a fellow of the international max planck research school for astronomy and cosmic physics at the university of heidelberg and the heidelberg graduate school of fundamental physics .",
    "he also acknowledges support from an annette kade fellowship for his visit to the american museum of natural history .",
    "we also thank the _ deutsche forschungsgemeinschaft _ ( dfg ) for support via the emmy noether grant ba 3607/1 , via the priority program sfb 439 `` galaxies in the early universe '' as well as via grants kl1358/1 , kl1358/4 and kl1358/5 .",
    "in addition , we also acknowledge partial support from a frontier grant of heidelberg university funded by the german excellence initiative , from the german _ bundesministerium fr bildung und forschung _ via the astronet project star format ( grant 05a09vha ) and from the _ landesstiftung baden - wrttemberg _ via their program international collaboration ii .",
    "thanks the max - planck - institut fr astronomie and the institut fr theoretische astrophysik der universitt heidelberg for hospitality , and the u.s . national science foundation for funding under grant ast08 - 35734 .",
    "we acknowledge computing time at the leibniz - rechenzentrum in garching ( germany ) , the nsf - supported texas advanced computing center ( usa ) , and at jlich supercomputing centre ( germany ) .",
    "the flash code was in part developed by the doe - supported alliances center for astrophysical thermonuclear flashes ( asci ) at the university of chicago .",
    "we thank c. federrath for important improvements to the sink particle module .",
    "arce , h.  g. , shepherd , d. , gueth , f. , lee , c .- f .",
    ", bachiller , r. , rosen , a. , & beuther , h. 2007 , in protostars and planets v , ed . b.  reipurth , d.  jewitt , & k.  keil ( the university of arizona press ) , 245260                                                                iliev , i.  t. , ciardi , b. , alvarez , m.  a. , maselli , a. , ferrara , a. , gnedin , n.  y. , mellema , g. , nakamoto , t. , norman , m.  l. , razoumov , a.  o. , rijkhorst , e .-",
    "j . , ritzerveld , j. , shapiro , p.  r. , susa , h. , umemura , m. , & whalen , d.  j. 2006 , mon . not .",
    "r. astron .",
    "soc . , 371 , 1057                                                  motte , f. , bontemps , s. , schneider , n. , schilke , p. , & menten , k.  m. 2008 , in astronomical society of the pacific conference series , vol . 387 , massive star formation : observations confront theory , ed",
    ". h.  beuther , h.  linz , & t.  henning , 2229"
  ],
  "abstract_text": [
    "<S> we describe the first three - dimensional simulation of the gravitational collapse of a massive , rotating molecular cloud that includes heating by both non - ionizing and ionizing radiation . </S>",
    "<S> these models were performed with the flash code , incorporating a hybrid , long characteristic , ray tracing technique . </S>",
    "<S> we find that as the first protostars gain sufficient mass to ionize the accretion flow , their h  ii  regions are initially gravitationally trapped , but soon begin to rapidly fluctuate between trapped and extended states , in agreement with observations . over time </S>",
    "<S> , the same ultracompact h  ii region can expand anisotropically , contract again , and take on any of the observed morphological classes . in their extended phases , expanding h  ii  regions drive bipolar neutral outflows characteristic of high - mass star formation . </S>",
    "<S> the total lifetime of h  ii  regions is given by the global accretion timescale , rather than their short internal sound - crossing time . </S>",
    "<S> this explains the observed number statistics . </S>",
    "<S> the pressure of the hot , ionized gas does not terminate accretion </S>",
    "<S> . instead the final stellar mass is set by fragmentation - induced starvation . local gravitational instabilities in the accretion flow lead to the build - up of a small cluster of stars , all with relatively high masses due to heating from accretion radiation . </S>",
    "<S> these companions subsequently compete with the initial high - mass star for the same common gas reservoir and limit its mass growth . </S>",
    "<S> this is contrary to the classical competitive accretion model , where the massive stars are never hindered in growth by the low - mass stars in the cluster . </S>",
    "<S> our findings show that the most significant differences between the formation of low - mass and high - mass stars are all explained as the result of rapid accretion within a dense , gravitationally unstable , ionized flow . </S>"
  ]
}