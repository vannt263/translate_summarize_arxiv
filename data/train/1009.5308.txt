{
  "article_text": [
    "in the recent years the theory of consecutive pattern avoidance for permutations has experienced a rapid development since the publication of the important paper @xcite . among the latest publications one should mention e.g. @xcite , @xcite , @xcite , @xcite where a number of special cases was treated and the corresponding exponential generating function was explicitly found .",
    "the present text is devoted to the same topic and is an extension of the application of homological methods to this theory initiated in @xcite .",
    "we investigate a natural analog of the notion of wilf equivalence for consecutive pattern avoidance and obtain a rather general sufficient condition guaranteeing that this natural analog of wilf equivalence holds .",
    "most of the definitions below are borrowed from @xcite and are ( hopefully ) standard in this area .",
    "a _ permutation of length @xmath0 _ is a sequence containing each of the numbers @xmath1 exactly once . to every sequence @xmath2 consisting of @xmath0 distinct positive integers , we associate its _ standardization @xmath3 $ ] _ which is the permutation of length @xmath0 uniquely determined by the condition that @xmath4 if and only if @xmath3(i)<\\operatorname{st}[s](j)$ ] . in other words ,",
    "@xmath3 $ ] is the unique permutation of length @xmath0 whose relative order of entries is the same as that of  @xmath2 .",
    "for example , @xmath5=(231).$ ] in what follows we will refer to separate integers forming a permutation as its _",
    "entries_.    we say that a permutation @xmath6 of length @xmath0 _ contains a permutation @xmath7 of length @xmath8 as a consecutive pattern _ if for some @xmath9 the standardization @xmath10 $ ] coincide with @xmath7 .",
    "if @xmath6 contains @xmath7 as a consecutive pattern we say that _ @xmath7 divides @xmath6 _ and use the notation @xmath11 . if @xmath11 and @xmath12 ( resp",
    "@xmath13 ) we say that _",
    "@xmath7 is a left ( resp .",
    "right ) divisor of @xmath6_. the main notion in the theory of pattern avoidance for permutations is as follows .",
    "we say that _ a permutation @xmath6 avoids a given permutation @xmath7 as a consecutive pattern _ if @xmath6 is not divisible by @xmath7 .",
    "( throughout this paper we only deal with consecutive patterns , so the word `` consecutive '' will be omitted . )",
    "the central problem of the theory of pattern avoidance is to count the number of permutations of a given length avoiding a given collection  @xmath14 of forbidden patterns or , more generally , containing a given number of occurrences of patterns from  @xmath14 .",
    "this problem naturally leads to the following equivalence relation on collections of patterns defined in the simplest case by h.  wilf ,  @xcite .",
    "two collections of patterns @xmath15 and @xmath16 are said to be _ wilf equivalent _ if for every positive integer @xmath0 , the number of @xmath15-avoiding permutations of length  @xmath0 is equal to the number of @xmath16-avoiding permutations of length  @xmath0 .",
    "the next notion although very natural seems to be new .",
    "we say that two collections of patterns @xmath15 and @xmath16 are _ strongly wilf equivalent _ if for every positive integer @xmath0 and every nonnegative integer @xmath17 , the number of permutations of length  @xmath0 with  @xmath18 occurrences of patterns from @xmath15 equals the number of permutations of length  @xmath0 with @xmath18 occurrences of patterns from  @xmath16",
    ". however , standard wilf equivalence deals with all pattern occurrences ( and not just consecutive ones ) . in the set - up of consecutive pattern avoidance we will speak about _",
    "c - wilf equivalent_ ( resp . _",
    "strongly c - wilf equivalent _ ) collections where `` c '' stands for consecutive .",
    "( we use the notation : @xmath19 for strongly c - wilf equivalent collections . )    throughout this paper we assume that every collection of patterns @xmath14 is _ reduced _ , i.e. no two permutations @xmath20 are divisible by one another .",
    "( notice that if @xmath21 then @xmath22 is strongly c - wilf equivalent to @xmath14 . )    following @xcite consider two natural exponential generating functions in one and two variables respectively : @xmath23 associated to a given collection of patterns @xmath14 . here",
    "@xmath24 ( resp .",
    "@xmath25 ) is the number of permutations of length  @xmath0 avoiding all patterns from @xmath14 ( resp .",
    "the number of permutations of length @xmath0 with exactly  @xmath18 occurrences of patterns from @xmath14 ) . obviously , @xmath26 .",
    "( recall that we only count consecutive occurrences . )",
    " hilbert series very similar to @xmath27 and @xmath28 are often considered in the theory of associative algebras .",
    "the well - known method of their study is based on the so - called bar - cobar duality which roughly means that a graded associative algebra @xmath29 and the @xmath30-coalgebra @xmath31 are dual with respect to the functor @xmath32 . as a corollary of this duality",
    "one gets that the hilbert series of @xmath29 and of @xmath31 are the inverses of each other , i.e. their product equals @xmath33 .",
    "( see @xcite for the details on different computational methods for the hilbert series of associative algebras and their homology . )",
    "it seems highly plausible that for an associative algebra with few relations a combinatorial description of its homology is simpler than that of the algebra itself .",
    "however , for algebras with many relations the situation is the opposite one .",
    "recall that the set of permutations avoiding an arbitrary fixed collection @xmath14 has an important additional structure , see appendix in @xcite .",
    "namely , in monoidal category it can be considered as the monomial basis of an algebra with monomial relations .",
    "( we refer an interested reader to the above appendix in @xcite and references therein for the details . in particular , one can find the definition of the homology functor in the latter appendix . )",
    "therefore , it seems natural to use the above mentioned homological duality in the theory of pattern avoidance .",
    "combinatorial data appearing in this context is based on a generalization of the so - called cluster method of i.  goulden and d.  jackson , @xcite .",
    "we explain below how one can get combinatorial information ( for example , about the coefficients of the generating functions ) of the corresponding graded homological vectorspaces for collections of patterns with few entries .    to describe our results we need to recall the definition of a combinatorial gadget called _ clusters _ in @xcite .",
    "they generalize the notion of a linkage given below .",
    "a permutation @xmath6 of length @xmath0 is called a _ linkage _ of an ordered pair of ( not necessarily distinct ) patterns @xmath34 of lengths @xmath35 and @xmath36 if ( i ) @xmath37 ; and ( ii ) the standardizations @xmath38 $ ] and @xmath39 $ ] are equal to @xmath7 and @xmath40 resp .",
    "since the length of @xmath6 is less than the sum of the lengths of @xmath7 and @xmath40 one has that the standardizations of the right truncation of @xmath7 and left truncations of @xmath40 should be the same . setting @xmath41",
    "we say that a pair @xmath42 has a _ @xmath43-overlapping _ or _",
    "@xmath43-overlaps_. in other words , a pair @xmath34 @xmath43-overlaps whenever the standardization @xmath44 $ ] is equal to the standardization @xmath45 $ ] .",
    "( notice that there might be several different linkages of two given patterns @xmath7 and @xmath40 of the same length . )",
    "a cluster is a way to link together several patterns from a given set .",
    "more precisely , a @xmath18-cluster w.r.t .",
    "a given collection of patterns @xmath14 is a triple @xmath46 where @xmath6 is a permutation , @xmath47 is a list of ( not necessarily distinct ) patterns from @xmath14 , and @xmath48 is a list of positive integers such that    * for every @xmath49 , @xmath50=\\pi_j\\in \\varpi$ ] , where @xmath51 is the length of  @xmath52 ( here @xmath53 labels the beginning of the pattern @xmath52 in @xmath6 ) ; * @xmath54 ( patterns are listed from left to right ) and @xmath55 ( adjacent patterns are linked ) ; * @xmath56 , and the length of @xmath6 is equal to @xmath57 ( i.e. @xmath6 is completely covered by the patterns @xmath58 ) .",
    "denote by @xmath59 the number of @xmath18-clusters of length  @xmath0 in a collection @xmath14 and introduce the exponential generating function @xmath60 ( here we use a natural convention that there always exists exactly one ( fictitious ) @xmath61-cluster and , therefore , the above generating function starts with @xmath62 . )",
    "the next result is an immediate consequence of the general cluster method of i.  goulden and d.  jackson , @xcite and its homological proof for the case of permutations can be found in @xcite .",
    "[ th : gj ] in the above notation one has : @xmath63    the exponential generating function @xmath64 of the numbers of permutations avoiding patterns from a given collection @xmath14 satisfies the relation : @xmath65    in general , the problem of counting the number of @xmath18-clusters in a given collection of patterns @xmath14 does not seem to be easier than counting the number of permutations of a given length avoiding @xmath14 .",
    "on the other hand , there exist natural classes of collections for which counting @xmath18-clusters is an easier task , see   3 .",
    "one can guess that since clusters can be described in terms of linkages of pairs of patterns the number of clusters can also be determined in terms of the combinatorics of these linkages .",
    "exploiting the latter idea we were able to prove the following ( main ) result of this note .",
    "[ th : main ] two collection of patterns @xmath15 and @xmath16 are strongly c - wilf equivalent if there exists a bijection @xmath66 preserving the following three properties :    * ( lengths ) : for any @xmath67 its length equals to that of @xmath68 ; * ( linkages ) : a pair of patterns @xmath34 from @xmath15 has a linkage of length @xmath0 if and only if the pair of its images @xmath69 from @xmath16 has a linkage of the same length  @xmath0 . *",
    "( overlapping sets ) : for each overlapping of any pair of patterns from @xmath15 the bijection @xmath70 preserves the subsets of entries that overlaps .",
    "more precisely , for any pair @xmath42 of patterns @xmath71 of lengths @xmath35 and @xmath36 resp . and",
    "an arbitrary positive integer @xmath72 the coincidence of the standardizations @xmath73 = \\operatorname{st}[(\\pi'(1)\\ldots\\pi'(k))]$ ] implies the coincidence of sets : @xmath74    [ theorem_wilf_overaping ]    the simplest case where theorem  [ th : main ] applies is to collections with a single pattern having no nontrivial self - overlappings . the following result implied by theorem  [ th : main ]",
    "was first conjectured by s.  elisalde in @xcite and later proved in @xcite by homological methods and , simultaneously , by j.  remmel whose methods were based on @xcite .",
    "namely ,    two collections of patterns each containing a single permutation without nontrivial self - overlappings are strongly c - wilf equivalent if    * the lengths of the permutations coincide ; * the first entry and resp . the last entry of the permutations coincide .",
    "a series of particular examples covered by theorem  [ th : main ] can be found in   5 of @xcite .",
    "namely , the following definitions are borrowed from the latter paper .",
    "we say that a pair of permutations @xmath75 and @xmath76 _ has a separation property _",
    "if @xmath77 avoids the permutation @xmath78 and @xmath79 avoids @xmath80 .    with each pair of permutations @xmath75 , @xmath81 and a natural number @xmath35",
    "one can associate the subset @xmath82 of permutations defined by two following properties .",
    "we say that @xmath83 iff    * the standardizations of the @xmath43 first and @xmath84 last entries coincide with @xmath79 , and @xmath77 resp . *",
    "the @xmath43 first entries are strictly smaller than the @xmath84 last entries ; the @xmath84 last entries are strictly smaller than the remaining entries of @xmath7 in the middle . in other words , @xmath85 for any triple of indices @xmath86 such that @xmath87 .",
    "fix a pair of permutations @xmath79 and @xmath77 having a separation property and a @xmath88-tuple of natural numbers @xmath89 .",
    "then all collections of @xmath88 distinct patterns @xmath90 such that @xmath91 are strongly wilf equivalent .    for all @xmath92 the @xmath93 entries in the middle of each pattern",
    "@xmath94 never appear in the overlapping sets .",
    "let us present a few more examples illustrating how our theorem works in practice .",
    "the following patterns @xmath95 are pairwise c - wilf equivalent .",
    "they have self - overlappings of lengths @xmath33 and @xmath96 and coinciding pairs of the first two and the last two entries .",
    "the next pair of c - wilf equivalent patterns @xmath97 have self - overlappings of lengths @xmath33 and @xmath98 and the corresponding subsets of their initial and final entries of lengths 1 and 4 coinciding while their initial and final subwords are different .    finally , here is an example @xmath99 of c - wilf equivalent collections with 2 patterns in each .    in ",
    "2 we prove theorem  [ th : main ] and in   3 we apply our main construction to a class of collections of patterns and obtain a system of linear ordinary differential equations satisfied by @xmath100 together with a set of similar generating functions defined below . in the follow - up @xcite of the present paper we plan to study different asymptotic properties of @xmath101 using the suggested approach .",
    "_ acknowledgements .",
    "_ the authors are sincerely grateful to s.  kitaev for the e - mail correspondence concerning this subject .",
    "research of the first author is supported by rfbr 10 - 01 - 00836 , rfbr - cnrs-10 - 01 - 93111 , rfbr - cnrs-10 - 01 - 93113 , and by the federal programm under the contract 14.740.11.0081 .",
    "our proof of theorem  [ theorem_wilf_overaping ] consists of an algorithm computing the cluster generating function @xmath102 of a given collection of patterns @xmath14 .",
    "it will then be relatively easy to see that this algorithm uses only the lengths and the overlapping subwords for pairs of patterns from @xmath14 considered as sets . to start with ,",
    "we define for an arbitrary collection of patterns @xmath14 a certain directed graph with labelled vertices and edges .",
    "the important circumstance is that the number of @xmath18-clusters with fixed initial and final subwords will be equal to the number of properly weighted paths of length @xmath18 in this graph with fixed initial and final vertices .",
    "the required weights can be computed using the edge labels . as a consequence",
    "we get that this graph uniquely defines the generating functions @xmath102 and , therefore , @xmath28 , see theorem  [ th : gj ] .",
    "namely , given an arbitrary collection of patterns @xmath14 define its directed graph @xmath103 with labelled vertices and edges as follows .",
    "the vertices of @xmath103 will be labelled by permutations ( of , in general , different lengths ) and the labels of the edges are defined below .    * to define",
    "the vertices assume that some permutation @xmath104 is a left divisor of a pattern @xmath105 and , at the same time , a right divisor of a ( not necessarily different ) pattern @xmath106 .",
    "then we assign to @xmath104 a vertex @xmath107 of @xmath103 and , naturally , label this vertex by @xmath108 .",
    "( notice that the same @xmath108 can arise from different pairs @xmath109 .",
    "in particular , the trivial @xmath33-element permutation @xmath110 comes from an arbitrary pair of not necessarily distinct patterns .",
    "@xmath111 is called the _",
    "distinguished vertex _ of @xmath103 and the set of all vertices of @xmath103 is denoted by @xmath112 . )",
    "* to define the edges take a pattern @xmath113 of some length @xmath35 and a pair @xmath114 of its initial and final subwords of lengths @xmath43 and @xmath84 ( i.e. @xmath115 and @xmath116 ) such that standardizations @xmath117,\\operatorname{st}[\\pi_f]$ ] are the vertices of @xmath103 .",
    "let @xmath118 and @xmath119 be the subsets of entries that appears in @xmath120 and @xmath121 resp .",
    "( i.e. @xmath122 and @xmath123 ) .",
    "the triple @xmath124 then defines the directed edge from the vertex @xmath117 $ ] to the vertex @xmath125 $ ] which we label by the triple @xmath126 .",
    "notice that @xmath118 and @xmath119 are considered as _",
    "unordered sets_.    _ notation .",
    "_ in the present text we show all vertices of @xmath103 as encircled permutations to distinguish them from their labeling permutations",
    ". we will try to keep our notation straight throughout the whole text by denoting similar quantities by the same letter and adding extra indices if required .",
    "for example , @xmath35 will typically mean the length of a pattern @xmath7 from a collection , @xmath43 should denote the length of a permutation @xmath108 which labels a vertex of @xmath103 originating from a @xmath43-overlapping , @xmath0 will stand for the length of a cluster .",
    "four examples of @xmath103 are given below .",
    "the upper left example is constructed from the collection @xmath127 of two patterns with no nontrivial overlappings .",
    "the upper right example comes from the single pattern @xmath128 having self - overlappings of lengths @xmath33 and @xmath129 .",
    "the meaning of two other examples should be clear now .    .",
    "]    our main technical result is as follows .",
    "[ th : graph ] the graph @xmath103 uniquely determines the generating function @xmath102 .",
    "the next corollary immediately implies theorem  [ theorem_wilf_overaping ] .    two collections of patterns @xmath15 and @xmath16 having isomorphic graphs @xmath130 and @xmath131 are strongly c - wilf - equivalent .",
    "( here by an isomorphism we mean a graph isomorphism preserving the labels of edges . the labels of vertices can change . )    [ algorithm ] to prove theorem  [ th : graph ] we present a natural algorithm calculating the number of @xmath18-clusters in a given collection @xmath14 in terms of its graph @xmath103 .",
    "namely , each vertex @xmath107 and a positive integer @xmath0 uniquely determine the subset @xmath132 consisting of all @xmath18-clusters @xmath46 , such that the length of @xmath6 is equal to @xmath0 and the standardization of the initial subword of @xmath6 is equal to @xmath108 .",
    "moreover , with each word @xmath133 of length @xmath43 ( where @xmath43 is the length of @xmath108 ) one can associate the subset @xmath134\\subset cl_{v , n , q}$ ] consisting of those clusters in @xmath132 which have @xmath135 as their initial subword .",
    "we will explain how one should compute the cardinalities of @xmath134 $ ] by induction on @xmath18 using the edge labels in @xmath103 .",
    "therefore , the cardinalities of @xmath132 can also be computed inductively as the sums over different @xmath135 . since the standardization of any word of length @xmath33 equals @xmath110 the set @xmath136 coincides with the set of all @xmath18-clusters of length @xmath0 .",
    "( the cardinality of the latter set is one of required coefficients in the cluster generating function @xmath102 . )",
    "let us now return to the induction step .",
    "take an arbitrary vertex @xmath137 and let @xmath138 ",
    ", @xmath139 be the list of all edges in @xmath103 starting at the vertex @xmath107 .",
    "denote by @xmath140 the length of permutation @xmath141 labeling the vertex @xmath142 and denote by @xmath51 the length of the pattern @xmath52 .",
    "we present below a recurrence relation expressing the cardinality @xmath143 $ ] of the set @xmath134 $ ] in terms of the cardinalities @xmath144 $ ] of @xmath145 $ ] with the summation taken over a certain subset of words @xmath146 . using this relation",
    "we can calculate inductively each @xmath143 $ ] and then obtain the required @xmath147 by summation over different @xmath135 .",
    "it will be convenient to subdivide the sets @xmath132 and @xmath134 $ ] into the subsets indexed by the edges starting at the vertex @xmath107 .",
    "for example , @xmath148 is the subset of @xmath18-clusters formed by linkages of length @xmath0 between the pattern @xmath52 and a @xmath149-cluster from @xmath150 .",
    "one has @xmath151=v \\end{smallmatrix } } cl_{v , n , q}[p_1\\ldots p_k ] = \\sum _ { \\begin{smallmatrix }   { 1\\leq p_1,\\ldots , p_k \\leq n , } \\\\",
    "st[(p_1\\ldots p_k)]=v \\end{smallmatrix } }    \\sum_{j=1}^d cl_{v\\stackrel{\\pi_j}{\\mapsto } v_j , n , q}[p_1\\ldots p_k ] .",
    "\\label{add_statistics}\\ ] ]    therefore , it is sufficient to find recurrence relations expressing the terms @xmath152 $ ] in the right - hand side of using @xmath153 $ ] . to avoid very cumbersome notation",
    "let us take the case of a single edge starting at @xmath107 which is equivalent to fixing @xmath141 in the above formulas .",
    "let @xmath154 be an edge in a graph @xmath103 coming from a pattern @xmath7 of length @xmath35 and let @xmath43 and @xmath84 be the lengths of the permutations labeling @xmath107 and @xmath155 resp . to explain our recurrence we need to introduce the following extra notation associated to @xmath7 .",
    "if @xmath156 let @xmath157 be the permutation which is the inverse of the standardization of the @xmath43 first and the @xmath84 last entries of @xmath7 , and let @xmath158 be the composition of @xmath159 with the shifting map @xmath160 defined by the formula : @xmath161 in other words , @xmath158 prescribes the rule how to write down the @xmath43 first and the @xmath84 last entries of the pattern @xmath7 in the increasing order : @xmath162    the next statement gives the required recurrence .",
    "[ lm:1 ] the following relations hold :    * for @xmath156 set @xmath163 $ ] . then @xmath164=   \\\\ \\sum _ { \\begin{smallmatrix }   p_{k+1},\\ldots , p_{k+k'}\\ : \\\\",
    "st[(p_1\\ldots p_{k+k'})]= \\tilde{\\pi } \\end{smallmatrix } } \\binom{p_{\\psi(1)}-1}{\\pi(\\overline{\\psi}(1))-1}\\times   \\left [ \\prod_{j=1}^{k+k'-1 } \\binom{p_{\\psi(j+1)}-p_{\\psi(j)}-1}{\\pi(\\overline{\\psi}(j+1))-\\pi(\\overline{\\psi}(j))-1 } \\right ] \\times \\binom{n - p_{\\psi(k+k')}}{l-\\pi(\\overline{\\psi}(k+k'))}\\times \\\\ \\times cl_{v',n - l+k',q-1}[p_{k+1}-\\pi(l - k'+1 ) + v'(1),\\ldots , p_{k+k'}-\\pi(l)+v'(k ' ) ] .",
    "\\label{one_edge}\\end{gathered}\\ ] ] * for @xmath165 one has : @xmath166= }   \\\\   { = \\sum_{p_{k+1},\\ldots , p_{l } : \\operatorname{st}[(p_1\\ldots p_l)]= \\pi }   cl_{v',n - l+k',q-1}[p_{l - k'+1}-\\pi(l - k'+1 ) + v'(1),\\ldots , p_{l}-\\pi(l)+v'(k ' ) ] . }",
    "\\label{one_edge_1}\\end{gathered}\\ ] ]    the range of summation in can be easily derived from our convention on the binomial coefficients claiming that @xmath167 if either @xmath168 or @xmath169 .",
    "moreover , we assume that @xmath170 s are pairwise different positive integers not exceeding @xmath0 . for the induction base we use the following initial data : @xmath171    we show how to prove . in formula one has the summation over all patterns @xmath172 such that the word @xmath173 is fixed and coincides with @xmath174 .",
    "indeed , the numbers @xmath170 are ordered by the permutation @xmath159 as follows : @xmath175 .",
    "therefore , there are @xmath176 choices of entries less than @xmath177 among the first @xmath35 entries of @xmath6 ; there are @xmath178 choices of entries greater than @xmath177 and less than @xmath179 , @xmath180 ; there are @xmath181 choices of entries greater than @xmath182 among the first @xmath35 entries of @xmath6 ; and @xmath183 $ ] ways to choose the remaining standardization of the last @xmath184 entries of @xmath6 .    in the union of the @xmath43 initial entries and the @xmath84 final entries of @xmath7",
    "covers the whole list of entries of @xmath7 , i.e. the set @xmath185 .",
    "therefore , all binomial coefficients appearing in should be equal to @xmath33 which leads to .",
    "as an immediate consequence of lemma  [ lm:1 ] one can see that the numbers @xmath186 $ ] of @xmath187-clusters depend only on the length , the @xmath43 first and the @xmath84 last entries of @xmath7 considered as sets .",
    "this justifies the information we use as the edge labels of the graph @xmath103 .",
    "the formulas expressing @xmath188 $ ] in terms of @xmath189 $ ] depend only on the labeling of the edges starting at @xmath107 .",
    "therefore , these cardinalities can be computed by induction on @xmath18 using the edge labels of the graph @xmath103 .",
    "finally , as we mentioned before , the set of all @xmath18-clusters of length @xmath0 of the whole collection @xmath14 is equal to the set @xmath136 .",
    "let us consider separately the situation when @xmath14 contains just a single pattern since in this case some substantial simplifications of our construction can be done .",
    "first of all the following observation explains why the graph @xmath190 is not required .",
    "let @xmath7 be a pattern of length @xmath35 and let @xmath191  ,@xmath192 be the list of all distinct lengths of possible self - linkages of @xmath7 , i.e. @xmath193 , ",
    ", @xmath194 is the list of distinct lengths of self - overlappings of @xmath7 .",
    "then @xmath190 is a complete directed graph on @xmath88 vertices with loops and with lengths of the underlying permutations being equal to @xmath195 .",
    "each ordered pair of ( not necessary distinct ) vertices of @xmath190 are connected by exactly one directed edge labeled by the corresponding initial and final subwords of @xmath7 .",
    "[ one_pattern ]    it is obvious that @xmath196 and denote by @xmath43 ( @xmath197 ) the length of the largest overlapping .",
    "let @xmath198 be the standardization of the @xmath199 first entries of @xmath7 ( i.e. @xmath198 is the labeling permutation of the @xmath2-th vertex in @xmath190 ) .",
    "since all patterns involved in any cluster coincide with @xmath7 the standardization of the initial subword of any cluster should always be the same .",
    "hence for different @xmath198 and fixed @xmath0 and @xmath18 all the sets @xmath200 coincide .",
    "therefore , it makes sense to denote by @xmath201 and @xmath202 $ ] the cardinalities of the set of @xmath18-clusters of length @xmath0 and those having @xmath203 as their initial subword resp .",
    "we introduce the same set of notation for the self - overlappings of @xmath7 similar to what have been using in lemma  [ lm:1 ] for the case @xmath204 .",
    "namely , for @xmath205 let @xmath206 be the permutation which is the inverse of the standardization of the @xmath43 first and the @xmath199 last entries of @xmath7 ; for @xmath207 let @xmath159 be the inverse of @xmath7 .",
    "let @xmath208 be the composition @xmath209 using which one gets the following rearrangement of the first @xmath43 and last @xmath199 elements of @xmath7 in the increasing order : @xmath210 additionally ,",
    "let @xmath211 be the standardization of the @xmath43 first and @xmath199 last entries of @xmath7",
    ".    in the case of a single pattern lemma  [ lm:1 ] implies the next result .",
    "[ lm:2 ] for a single pattern the recurrence formula for the numbers of @xmath18-clusters is as follows : @xmath212 = \\\\ \\sum _ { \\begin{smallmatrix }          s \\ : \\\\",
    "k_s < l - k         \\end{smallmatrix }   } \\sum _ { \\begin{smallmatrix }   1\\leq p_{k+1},\\ldots , p_{2k}\\leq n , \\\\",
    "st[(p_1\\ldots p_{k+k_s})]= \\tilde{\\pi}_s \\end{smallmatrix } } \\binom{p_{\\psi_s(1)}-1}{\\pi(\\overline{\\psi_s}(1))-1}\\times \\left [ \\prod_{j=1}^{k+k_s-1 }     \\binom{p_{\\psi_s(j+1)}-p_{\\psi_s(j)}-1}{\\pi(\\overline{\\psi_s}(j+1))-\\pi(\\overline{\\psi_s}(j))-1 } \\right ]    \\times \\binom{n - p_{\\psi_s(k+k_s)}}{l-\\pi(\\overline{\\psi_s}({k+k_s}))}\\times   \\\\",
    "\\times   cl_{n - l+k_s , q-1}[p_{k+1}-\\pi(l - k_s+1 ) + v_s(1),\\ldots , p_s({k+k_s})-\\pi(l)+v_s(k_s),p_{k+k_s+1},\\ldots , p_{2k } ]    + \\\\ + \\sum _ { \\begin{smallmatrix }          s \\ :",
    "\\\\         k_s \\geq l - k         \\end{smallmatrix }   }    \\sum _ { \\begin{smallmatrix }   1\\leq p_{k+1},\\ldots , p_{l+k - k_s}\\leq n , \\\\ st[(p_1\\ldots p_{l})]= \\pi \\end{smallmatrix } } cl_{n - l+k_s , q-1}[p_{l - k_s+1}-\\pi(l - k_s+1 ) + v_s(1),\\ldots , p_{l}-\\pi(l)+v_s(k_s),p_{l+1},\\ldots , p_{l+k - k_s } ] .",
    "\\label{recurent - one - pattern } \\end{gathered}\\ ] ]    ( as above we assume that the set of @xmath61-clusters contains the unique fictitious element of length @xmath33 while the set of @xmath33-clusters contains the single pattern @xmath7 . )",
    "in this section we discuss a specific class of collection of patterns .",
    "our method from ",
    "[ sec : proofs ] allows us to construct a system of linear ordinary differential equations in the variable @xmath62 for the cluster generating functions @xmath102 together with a set of similar generating functions associated to a given collection of patterns @xmath14 .",
    "the main definition is as follows .",
    "a collection of patterns @xmath14 is called _ monotone _ if for all @xmath213 and for each pair ( not necessarily distinct ) patterns @xmath42 from @xmath14 the existence of their @xmath43-overlapping implies that the initial subword of the pattern @xmath40 does not contain entries greater than @xmath43 .",
    "[ lm : monot_link ] let @xmath6 be a linkage of a pair of patterns @xmath42 .",
    "suppose that the initial subword of @xmath7 of length @xmath43 does not contain entries greater than @xmath43 and that the initial subword of @xmath40 of length @xmath84 does not contain entries greater than @xmath84 ( where @xmath84 is the length of the overlapping of the pair @xmath42 in @xmath6 ) .",
    "then the initial subword of length @xmath43 of @xmath6 should be equal to the initial subword of @xmath7 , i.e. @xmath214 for @xmath215 .",
    "let @xmath35 and @xmath36 be the lengths of @xmath7 and @xmath40 resp . then the length of @xmath6 should be equal to @xmath216 .",
    "set @xmath217 and @xmath218 respectively .",
    "the number @xmath219 is the minimal entry of @xmath7 and should be less than or equal to @xmath43 ( @xmath220 respectively ) .",
    "therefore , @xmath221 should be the smallest entry among the @xmath35 first entries of the linkage @xmath6 and @xmath222 should be the smallest entry among the @xmath36 last entries of @xmath6 .",
    "in particular , @xmath223 .",
    "this implies that @xmath221 is the smallest entry in the whole @xmath6 and hence @xmath224 .",
    "similar arguments based on simple properties of standardizations imply that @xmath225 is the only entry in @xmath6 greater than @xmath33 etc .",
    "lemma [ lm : monot_link ] implies that for an arbitrary vertex @xmath226 all clusters in the subset @xmath132 should always have @xmath108 as their initial subword .",
    "this means that the number @xmath227 $ ] is non - vanishing if and only if @xmath228 , where @xmath43 is the length of @xmath108 .",
    "consider two vertices @xmath107 and @xmath229 of lengths @xmath43 and @xmath84 connected by an edge @xmath230 in @xmath103 .",
    "we can simplify the formula using our assumption on the intersections of clusters .",
    "at first consider the case when the length @xmath35 of the pattern @xmath7 is greater than @xmath231 .",
    "one observes that in this case there is no summation in since the summands in the left - hand and the right - hand sides of are non - vanishing if and only if for @xmath215 one has that @xmath232 and for @xmath233 one has that @xmath234 therefore , only the last binomial coefficient in the product in the right - hand side of is different from @xmath33 .",
    "denote by @xmath235 the maximal entry of the final subword of @xmath7 .",
    "( in notation of lemma  [ lm:1 ] we have @xmath236 . )",
    "since we do not have to specify the arguments of the functions @xmath188 $ ] the resulting recurrence relation for the cardinalities of the set of clusters is : @xmath237 the case @xmath165 is also covered by since in this case the maximal entry @xmath235 should be equal to the length @xmath35 of the permutation @xmath7 and the corresponding binomial coefficient is equal to @xmath33 .",
    "introduce the next family of generating functions : @xmath238 one for each vertex @xmath107 of @xmath103 .",
    "let @xmath138  , @xmath139 be the list of all edges in @xmath239 starting at @xmath107 . denote by @xmath51 the length of the pattern @xmath52 ; denote by @xmath140 the length of @xmath141 , and , finally , denote by @xmath240 the maximal entry among the @xmath140 last entries of @xmath52 .",
    "formula implies the following reccurence relation : @xmath241    [ th : monotone_patterns ] given a monotone collection of patterns @xmath14 one has that the cluster generating function @xmath242 together with all @xmath243 solve the following system of linear ordinary differential equations in @xmath62 : @xmath244 here @xmath245 and @xmath107 runs over the set @xmath239 of all vertices of @xmath103 .",
    "( boundary conditions for each @xmath246 can be easily determined in each particular case using the initial terms in . )      as an immediate consequence of theorem  [ th : monotone_patterns ] one gets that @xmath242 satisfies a certain high order linear ordinary differential equation with polynomial coefficients ( which can be obtained from the above system after the elimination of all @xmath247 . )",
    "two monotone collections of patterns @xmath15 and @xmath16 are strongly c - wilf equivalent if there exists a bijection @xmath248 preserving the first two properties as in theorem  [ th : main ] ( i.e. preserving lengths and linkages ) and , additionally , preserving the maxima of the overlapping sets . more precisely , for any pair @xmath42 of patterns @xmath71 of lengths @xmath35 and @xmath36 resp . and an arbitrary positive integer @xmath72 the coincidence of the standardizations @xmath73 = \\operatorname{st}[(\\pi'(1)\\ldots\\pi'(k))]$ ] implies the coincidence of the maxima of the sets : @xmath249 ( two other sets @xmath250 and @xmath251 should coincide with the standard set @xmath252 because of the monotonicity property . )",
    "let us present further simplifications for monotone collections with a single pattern . as it was shown in   [ section - one - pattern ]",
    "we do not really need the graph @xmath103 for collections with one pattern . take a monotone pattern @xmath7 of length @xmath0 and let @xmath254 be the list of all different lengths of self - overlappings of @xmath7 .",
    "let @xmath255 be the list of maxima among the corresponding number of the last entries of @xmath7 , i.e. @xmath256 .",
    "given a monotone pattern @xmath7 one has the following recurrence formula for the set of its @xmath18-clusters of length @xmath0 : @xmath257 and its cluster generating function @xmath258 solves the linear ordinary differential equation : @xmath259 with the boundary conditions : @xmath260 .",
    "[ lm : one - pat - dif - eq ]      finally , using these considerations we can completely describe which permutations of length @xmath263 ( @xmath264 ) are c - wilf equivalent .",
    "our main theorem  [ th : main ] gives necessary and sufficient condition for c - wilf equivalence of two patterns of length @xmath263 .",
    "notice that there are two natural transformations of patterns preserving the cluster generating functions .",
    "the first one is the reversion that rewrites a pattern backwards , i.e. it sends ( @xmath265 to @xmath266 ) .",
    "the second one takes the complement of a pattern , i.e. it sends @xmath267 to @xmath268 .",
    "they generate the group @xmath269 acting on @xmath270 .",
    "one can easily check that this action has @xmath271 orbits of which @xmath98 orbits with representatives @xmath272 have length @xmath96 and the remaining @xmath273 have length @xmath98 .",
    "additionally , there are 14 orbits whose permutations have no nontrivial selp - overlappings ; 15 orbits with the only nontrivial self - overlapping of length @xmath96 ; 2 orbits with the only nontrivial self - overlapping of length @xmath129 , and a single orbit with self - overlappings of length 2 , 3 and 4 , see the lists of representatives in proposition  [ pr : s5 ] .    [",
    "pr : s5 ] subdividing the representatives of the orbits of the latter group action on @xmath270 into the subsets according to the lengths of their maximal possible self - overlappings one gets the following :    * c - wilf equivalent orbits having no nontrivial overlappings are enumerated by their first and last elements : @xmath274 @xmath275 * among all @xmath276 orbits with only 2-overlappings having the representatives @xmath277 no two are strongly c - wilf equivalent to each other ; * @xmath96 orbits with representatives @xmath278 having @xmath129-overlappings are not c - wilf equivalent ; * the unique orbit with overlappings of lengths @xmath279 is represented by the monotone pattern @xmath280 .    besides the application of theorem  [ th : main ] one has to check by hand that the number of @xmath129-clusters is distinguishing all the 15 orbits with only 2-overlappings and already the number of @xmath96-clusters distinguishes between the two orbits having only @xmath129-overlappings .",
    "let us finish the paper by presenting the ( system of ) linear differential equations for our examples in fig.[graph - example ] .",
    "one can easily check that all the collections @xmath281 shown there are monotone .",
    "set @xmath282 and @xmath283 for @xmath15 and notice that its graph contains a single vertex .",
    "then in the above notation one has @xmath284 .",
    "equation for the cluster generating function @xmath285 then takes the form : @xmath286 for the collection @xmath287 that has self - overlappings of lengths @xmath33 and @xmath129 one has @xmath288 . with this data equation",
    "takes the form : @xmath289 for the collection @xmath290 denote its edges by @xmath291 , @xmath292 , @xmath293 and @xmath294 .",
    "then one has @xmath295 ; @xmath296 ; @xmath297 ; @xmath298 .",
    "thus , one gets the following system of equations : @xmath299    in this case it is easy to get a linear ordinary differential equation satisfied by @xmath300 by dividing both sides of the first equation by @xmath301 , differentiating the result with respect to @xmath62 and equating the expressions for @xmath302 from the first and second equations .",
    "the resulting equation has the form @xmath303    finally , for the collection @xmath304 denote its edges by @xmath305 ; @xmath306 ; @xmath307 ; @xmath308 ; @xmath309 , and @xmath310 .",
    "then one has @xmath311 ; @xmath312 ; @xmath313 ; @xmath314 ; @xmath315 ; @xmath316 .",
    "thus , one gets the following system of equations : @xmath317    let us extract from this system a linear ordinary differential equation satisfied by @xmath300 . to simplify our notation set @xmath318",
    "then we get the system : @xmath319 since the coefficients in the left - hand sides are both equal to @xmath33 we can eliminate @xmath108 by differentiating the first equation a number of times and substituting @xmath320 from the second equation till we can solve both equations for the remaining @xmath108 and its derivative of appropriate order . in our concrete case , differentiating the first equation twice and substituting @xmath320 from the second equation we get @xmath321 differentiating the first equation in the latter system once and substituting @xmath320 again we get @xmath322 finally , equating the expressions for @xmath323 from the first equation in the latter system and from the original equation for @xmath324 we get the following equation @xmath325 containing @xmath326 and its derivatives only . substituting @xmath327",
    "we obtain the required equation @xmath328 for the cluster generating function .",
    "notice that since the leading terms in the left - hand sides of the system are always equal to @xmath33 the elimination process similar to the one just described will always lead to an equation satisfied by the cluster generating function @xmath28 . on the other hand",
    ", there is no guarantee that the obtained linear ordinary equation with polynomial coefficients will have the minimal possible order among such equations satisfied by @xmath28 .",
    "s.  kitaev , a survey on partially ordered patterns . in permutation patterns ( 2010 ) , s. linton , n. ruskuc , and v. vatter , eds . ,",
    "376 of london mathematical society lecture note series , cambridge university press , pp .",
    "115 - 135 ."
  ],
  "abstract_text": [
    "<S> using the approach suggested in @xcite we present below a sufficient condition guaranteeing that two collections of patterns of permutations have the same exponential generating functions for the number of permutations avoiding elements of these collections as consecutive patterns . in short , </S>",
    "<S> the coincidence of the latter generating functions is guaranteed by a length - preserving bijection of patterns in these collections which is identical on the overlappings of pairs of patterns where the overlappings are considered as unordered sets . </S>",
    "<S> our proof is based on a direct algorithm for the computation of the inverse generating functions . as an application we present a large class of patterns where this algorithm is fast and , </S>",
    "<S> in particular , allows to obtain a linear ordinary differential equation with polynomial coefficients satisfied by the inverse generating function . </S>"
  ]
}