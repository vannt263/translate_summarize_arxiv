{
  "article_text": [
    "spatially resolved astronomical observations commonly span orders of magnitude variations in the signal - to - noise ( s / n ) across the detector elements . for this reason",
    "data are often grouped together in the spatial direction ( binned ) and averaged before analyzing them .",
    "more spatial resolution is retained in the high - s / n regions compared to the low - s / n ones .",
    "a well known example is galaxy photometry , where logarithmically spaced radial bins are often adopted .",
    "many more pixels are used to compute the value of a galaxy profile at large radii than in the center .",
    "binning is essential in the case of spectroscopic observations of the stellar kinematics .",
    "in fact a minimum s / n is _ required _ for a reliable and unbiased extraction of kinematical information from the spectra ( e.g. , rix & white 1992 ; van der marel & franx 1993 ; kuijken & merrifield 1993 ) .",
    "for this reason binning is invariably used to analyze one - dimensional ( 1d , e.g. , long slit ) spectroscopic observations .",
    "new developments with integral field spectroscopy ( ifs ; e.g. , ` oasis ` on cfht , ` sauron `  on wht , ` vimos ` on vlt , ` gmos ` on gemini ) require methods to perform spatial binning of spectra in two dimensions ( 2d ) too .    the related process of adaptively smoothing is not acceptable for our purposes since it correlates the information of different bins which complicates the quantitative interpretation of spectroscopic measurements . for the same reason smoothing is never used for the quantitative analysis of 1d spectra .",
    "little work has been done on the subject of adaptive 2d - binning .",
    "sanders & fabian ( 2001 ) developed an algorithm to be used with x - ray imaging data .",
    "the bins that their method produces however can contain other bins and are not compact . in the case of spectroscopic data",
    "it makes little sense to bin together spectra coming from pixels that are not close to each other and whose properties may differ considerably .",
    "other schemes have to be developed .",
    "we tackle here the problem of binning in the spatial direction(s ) . in",
    "what follows the term ` pixel ' refers to a given spatial element of the dataset : it can be an actual pixel of a ccd image , or a spectrum position along the slit of a long - slit spectrograph or in the field of view of an ifs .",
    "each pixel @xmath0 has an associated signal @xmath1 and its corresponding noise @xmath2 .",
    "the pixel signal - to - noise ratio is therefore @xmath3 .",
    "our considerations do not depend on the details used to estimate these quantities , which we assume to be known beforehand for every pixel @xmath0 . in the case of spectrography for instance , the quantity @xmath1 associated to a given spectrum @xmath4 can be the average signal over a given spectral range @xmath5 : @xmath6 ; while the corresponding average noise can be defined as @xmath7 .",
    "it is important to note that , in our case , the term ` binning ' will only refer here to the averaging of observations taken at different positions on the sky ( i.e. , different pixels ) , and _ not _ along the spectral direction .    to bin in 1d",
    "one only has to make sure that the spatially binned data satisfy a minimum  requirement ( or better a minimum scatter around the target ) . in 2d",
    "( and higher dimensions ) the situation is more complex and a good binning scheme has to satisfy the following requirements :    topological requirement : : :    the bins should at least properly tessellate the region    @xmath8 of the plane under consideration , i.e. , create a    partition of @xmath8 , without overlapping or holes . while    this requirement is trivial to enforce in 1d , it is tricky to    implement in higher dimensions , as the bin shapes",
    "must then be taken    into consideration ; morphological requirement : : :    the bin shape has to be as ` compact ' ( or ` round ' ) as possible , so that    they are associated with a well - defined position , and correspond to    the overall best spatial resolution ; uniformity requirement : : :    the bin  should be as uniform as possible around a target value . while    a minimum  is generally required , one does not want to sacrifice    spatial resolution to increase the  even further .    in what follows",
    "we consider different methods and we apply each one to observations of the barred sa galaxy ngc  2273 ( fig .  [",
    "fig : n2273-snmap ] ) taken with the panoramic ifs ` sauron `  ( bacon et al .",
    "these observations , based on 8 single 1800  s exposures , have been selected for having high contrast between the inner and the outer parts , and a complex -distribution , caused by the presence of spiral arms , -jumps and irregular outer boundaries due to the merging of multiple exposures .",
    "it is useful to first consider the quadtree algorithm ( samet 1984 ) , which we believe is close to the best ` regular ' image processing method available for the present application .",
    "we show that the quadtree method can not produce an _ optimal _ binning and more complex schemes are required .",
    "these we discuss in section  4 .",
    "the quadtree method consists of a recursive partition of a region of the plane into axis - aligned squares .",
    "one square , the _ root _ , covers the entire region .",
    "a square is divided into four _ child _ squares , by splitting with horizontal and vertical segments through its center .",
    "the collection of squares then form a tree , with smaller squares at lower levels of the tree .",
    "the splitting of squares terminates when all squares meet some convergence criterion .    in fig .",
    "[ fig : quadtree_scatter ] the quadtree method was used to rebin the  map of fig .",
    "[ fig : n2273-snmap ] into squares satisfying a minimum s / n requirement .",
    "the nice feature of this binning method is that the resulting bins are squares of various sizes ( except at the border ) . in this way bins are easy to handle , and require little information to be described completely .",
    "there are however two major problems with this method :    * a s / n spread of a factor @xmath9 is unavoidable due to the fact that bin area varies by construction in steps of a factor of 4 ; * unless the original image has a size which is a power of two , some bins at the border will not be square and generally will not meet the minimum s / n criterion , becoming unusable for later analysis .",
    "given the inability of methods employing ` regular ' bins to produce optimal 2d tessellations , we now consider schemes which do not have square or rectangular bins .",
    "accordingly we consider the _ voronoi tessellation _ ( vt ) , that can be used to generate binnings satisfying all the three requirements of section  2 .    given a region @xmath8 and a set of points @xmath10 , called _",
    "generators _ , in @xmath8 , a vt is a partition of @xmath8 into regions @xmath11 enclosing the points closer to @xmath12 than to any other generator .",
    "each @xmath13 is referred to as the _ voronoi region _ or _ bin _ associated to @xmath12 ( see okabe , boots , & sugihara 1992 , for a comprehensive treatment ) .",
    "the vt presents many interesting features for the binning problem :    * it naturally enforces the topological requirement ; * it is efficiently described by the coordinates of its generators ; * it is very easy to implement in the discrete case : given the generator positions , it is sufficient to locate the closest generator to any given pixel to determine the bin to which it belongs .    on the other hand , the fact that a vt is adopted for binning does not enforce by itself the morphological requirement : the bins are convex by construction , but can have very sharp angles .",
    "furthermore , the uniformity requirement is not addressed in any way by the use of a vt .",
    "these two requirements have to be tackled through a properly tailored distribution of the voronoi generators .",
    "we present now a way to produce such a distribution .",
    "the _ centroidal voronoi tessellation _ ( cvt ) is a technique which can be used to generate an optimally uniform _ and _ regular vt in the continuous case , or in the limit of a large number of pixels .",
    "we initially assume that the observed signal @xmath14 can be described by a continuous function @xmath15 in the sky - plane",
    ". moreover we assume the noise @xmath16 to be a monotonic function of @xmath14 ( e.g. , poissonian noise @xmath17 ) . with these assumptions",
    "the problem of generating equal-  bins reduces to that of producing a tessellation enclosing equal - mass , according to the density distribution @xmath15 .    given a density function @xmath15 defined in a region @xmath8 ,",
    "a cvt of @xmath8 is a special class of vt where the generators @xmath12 happen to coincide with the mass centroids @xmath18 of the corresponding voronoi regions @xmath13 . as illustrated in the review by du , faber , & gunzburger ( 1999 ) ,",
    "the cvts are useful to solve a variety of mathematical problems , but can also be observed in many real - life natural examples ( living cells , territories of animals , etc . ) .",
    "one of the most striking characteristics of cvt in the 2d case is its ability to partition a region into bins whose size varies as a function of the underlying density distribution , but whose shape tends asymptotically to a hexagonal - like lattice for a large number of bins . another nice feature of cvt is that a simple algorithm exists for its practical computation : the lloyd ( 1982 ) method , for which the cvt is a fixed point .",
    "although cvt bins are naturally smaller where the density is higher , the area-@xmath19 relation of the bins is not such that the mass enclosed in every bin is the same : the cvt can not be used directly to produce equal mass bins ( equal in the case of photon noise ) .",
    "however , it can be shown that if a cvt is constructed for the density @xmath20 , the tessellation obtained will enclose equal mass according to the original density @xmath19 ( see cappellari & copin in prep .  for details ) .",
    "[ fig : n2273-cvt ] presents a cvt produced by applying the lloyd s algorithm to the density @xmath20 , where @xmath19 was obtained by linearly interpolating the surface brightness of fig .",
    "[ fig : n2273-snmap ] onto a grid with pixel size @xmath21 smaller than the original size .",
    "this interpolation is used here to ` simulate ' an observation with a much higher spatial resolution , but is not an accurate way of dealing with lower resolution data . in this case of a large number of pixels the cells of the vt tend to the theoretical hexagonal shape and adapt nicely to density variations and to the irregular boundary of the region .",
    "the scatter of the is also close to optimal with rms scatter of @xmath22 .",
    "this cvt method illustrates the goals towards which an optimal 2d - binning algorithm should tend , but it has still some practical limitations :    * it generates equal - mass bins and _ not _ necessary equal- bins , unless the noise is a monotonic function of the signal .",
    "it is e.g. , useful to produce equal bins when all the noise in the pixel can be attributed to photon noise .",
    "this is often the case , but not always ; * more importantly the method does not work well when the bins are constituted of just a few pixels . in fig .",
    "[ fig : n2273-cvt - bad ] the same generators as in fig .",
    "[ fig : n2273-cvt ] where used to construct a vt for the coarser ` sauron `  pixel grid of fig .",
    "[ fig : n2273-snmap ] .",
    "the obtained vt is similar to that of fig .",
    "[ fig : n2273-cvt ] , but the  scatter increases considerably , due to discretization effects .    in practice",
    "an optimal 2d - binning method has to preserve the good characteristics of the cvt , in the limit of many pixels , but has to be able to take the discrete nature of pixels into account , when dealing with bins constituted by just a few pixels .",
    "this algorithm is the subject of the next section .",
    "we describe a method we developed to find the generators for the optimal vt of an image or ifs observation taking the discrete nature of pixels into account from the beginning .",
    "the algorithm described here constructs an initial binning trying to generalize to 2d the standard pixel - by - pixel binning algorithm used in 1d .",
    "the centroids of the bins found in this way are then used as starting generators for a cvt .",
    "the method reduces to the previous cvt in the limit of many pixels , but works on a pixel basis with bins made by just a few pixels .",
    "a natural 1d - binning algorithm starts a bin from the highest unbinned pixel and accretes pixels until a given target is reached . to extend this idea to 2d",
    ", we need to make a choice for the direction toward which new pixels are accreted to a 2d - bin .",
    "the adopted method always tries to add to the current bin the pixel that is closest to the bin centroid . furthermore , when a new bin is started , the first pixel is also selected as the one closest to the centroid of all the previously binned pixels .",
    "this simple scheme automatically _ tends to _ generate bins that are compact , and the bin can be carefully monitored on a pixel - by - pixel basis during the accretion phase .",
    "some small imperfections remain at the end of the accretion phase : these are corrected by performing a cvt , using as starting generators the centroids of the previous bins .",
    "an example of the application of the bin - accretion algorithm to the binning of the actual ` sauron `  data of ngc  2273 is shown in the left panel of fig .",
    "[ fig : bubbles - final ] , while the resulting scatter is shown in the right panel : the rms value is @xmath23 .",
    "the values , symmetrically clustered around the target @xmath24 , essentially represent the lowest scatter obtainable from a binning of these data : all the scatter is due to discretization noise , which increases towards to the galaxy center , where the bin are made of a smaller number of pixels . the velocity field extracted from the binned data",
    "is shown in fig .",
    "[ fig : n2273_velfield ] .",
    "the binning resulting from this algorithm is qualitatively similar to the one obtained using the cvt ( see fig .  [",
    "fig : n2273-cvt ] ) .",
    "but , by contrast to the cvt alone , this method is able to produce bins that are essentially optimal also in the ` small - bins ' regime , with bins of only 24  pixels .",
    "[ sec : concl ]    we presented a method to adaptively perform spatial binning of 2d data ( e.g. , ifs or imaging data ) . as an example of its application we have extracted the stellar mean velocity field from the 2d - binned ` sauron `  data of the barred spiral galaxy ngc  2273 .",
    "adaptive 2d - binning should become common practice for the analysis of 2d data ( in particular spectral data ) , as it is for 1d observations ."
  ],
  "abstract_text": [
    "<S> we present new techniques to perform adaptive spatial binning of two - dimensional ( 2d ) data to reach a chosen constant signal - to - noise ratio per bin . </S>",
    "<S> these methods are required particularly for the proper analysis of integral field spectrograph ( ifs ) observations , but can also be used for standard photometric imagery . </S>",
    "<S> various schemes are tested and compared using data obtained with the panoramic ifs ` sauron ` . </S>"
  ]
}