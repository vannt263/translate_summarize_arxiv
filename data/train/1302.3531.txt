{
  "article_text": [
    "extremal graph theory @xcite deals with graphs in which conflicting graph invariants are on the verge of contradiction .",
    "a classic example due to mantel from 1907 shows that , among graphs of order @xmath0 , as the edge number increases beyond @xmath1 a graph can no longer be bipartite and must contain a triangle . generalizing slightly , the mantel problem is to determine those graphs with fixed edge density @xmath2 which minimize , and those which maximize , the possible values @xmath3 of triangle density . in this vein extremal graph theory",
    "is concerned with qualitative features of graphs with invariants on the boundary @xmath4 of the space @xmath5 of possible values of some particular set of invariants which , for the mantel problem , are the edge and triangle densities , @xmath2 and @xmath3 .",
    "( the set @xmath5 for the mantel problem was finally determined in @xcite , and the optimizing graphs in @xcite . ) in this paper we are concerned with a natural generalization of extremal graph theory to the interior of @xmath5 .",
    "borrowing an idea from physics , it is possible that qualitative graph features which are forced in an absolute sense on a subset @xmath6 of the boundary of @xmath5 are still retained for typical graphs in some phase , a region of @xmath5 abutting @xmath6 .",
    "( we define ` phase ' below and ` typical ' in the next section . ) for instance for the mantel problem there is evidence in @xcite that for edge density less than 1/2 there is a region of @xmath5 abutting the interval @xmath7\\times\\{0\\}$ ] of @xmath4 , in which now a typical graph is nearly bipartite .",
    "( the vertices are divided into two clusters of nearly equal size , with nearly all edges connecting vertices in one cluster to vertices in the other . )",
    "one objective in such a study is ` phase transitions ' , boundaries between phases in which the competition between invariants which has traditionally been studied on @xmath8 is extended into the interior of @xmath5 , and now concerns typical graphs .",
    "we study typical graphs using entropy and the graph limit formalism , which we sketch after the following summary of results .",
    "consider the set @xmath9 of simple graphs @xmath10 with set @xmath11 of ( labeled ) vertices , edge set @xmath12 and triangle set @xmath13 , where the cardinality @xmath14 .",
    "( ` simple ' means the edges are undirected and there are no multiple edges or loops . )",
    "we will be concerned with the asymptotics of @xmath9 as @xmath0 diverges , specifically in the relative number of graphs as a function of the cardinalities @xmath15 and @xmath16 .",
    "let @xmath17 be the number of graphs in @xmath9 such that the edge and triangle densities , @xmath18 and @xmath19 , satisfy : @xmath20 graphs @xmath21 in @xmath22 are known to have edge and triangle densities , @xmath23 , whose accumulation points form a compact subset @xmath24 of the @xmath25-plane bounded by three curves , @xmath26 , the line segment @xmath27 , and a certain scalloped curve @xmath28 , lying above the curve @xmath29 , and meeting it when @xmath30 ; see @xcite and references therein , and figure 1 .",
    "( note the minor shift in emphasis from @xmath5 , as discussed earlier , to the accumulation points @xmath24 of @xmath5 . )",
    ".3truein , outlined in solid lines , title=\"fig:\",width=288 ]    we are interested in the relative number of graphs with given numbers of edges and triangles , asymptotically in the number of vertices .",
    "more precisely we will analyze the entropy density , the exponential rate of growth of @xmath31 as a function of @xmath0 .",
    "first consider @xmath32 the limits defining the entropy density @xmath33 are proven to exist in @xcite .",
    "the objects of interest for us are the qualitative features of @xmath33 in the interior of @xmath24 .",
    "in particular , a phase is commonly defined as a maximal connected open subset in which the entropy density is analytic @xcite .",
    "our main result is :    [ thm0 ] in the interior of its domain @xmath24 the entropy density @xmath33 satisfies : @xmath34 for some @xmath35 .",
    "therefore for fixed @xmath2 , @xmath33 attains its maximum at @xmath36 but is not differentiable there .",
    "for @xmath37 we have the stronger inequality @xmath38 for some @xmath39 .",
    "so the graph of @xmath33 has its maxima , varying @xmath3 for fixed @xmath2 , on a sharp crease at the curve @xmath40 , and is not concave for @xmath3 just below @xmath41 .",
    "the importance of the result lies in the implication from ( [ diff ] ) of the lack of differentiability of @xmath33 on the crease , and thus the existence of a phase transition , and the implication from ( [ strong ] ) of a lack of concavity of @xmath33 , discussed below .",
    "we begin with a quick review of the formalism of graph limits , as recently developed in @xcite ; see also the recent book @xcite .",
    "the main value of this formalism here is that one can use large deviations on graphs with independent edges @xcite to give an optimization formula for @xmath33 @xcite .",
    "consider the set @xmath42 of all symmetric , measurable functions @xmath43 ^ 2\\to g(x , y)\\in [ 0,1].\\ ] ] think of each axis as a continuous set of vertices of a graph .",
    "for a graph @xmath44 one associates @xmath45 where @xmath46 denotes the smallest integer greater than or equal to @xmath47 . for @xmath48 and simple graph @xmath49",
    "we define @xmath50^\\ell } \\prod_{(i , j)\\in e(h)}g(x_i , x_j)\\,dx_1\\cdots     dx_\\ell,\\ ] ] where @xmath51 , and note that for a graph @xmath10 , @xmath52 is the density of graph homomorphisms @xmath53 : @xmath54 we define an equivalence relation on @xmath42 as follows : @xmath55 if and only if @xmath56 for every simple graph @xmath49 . elements of @xmath42 are called `` graphons '' , elements of the quotient space @xmath57 are called `` reduced graphons '' , and the class containing @xmath48 is denoted @xmath58 .",
    "equivalent functions in @xmath42 differ by a change of variables in the following sense .",
    "let @xmath59 be the space of measure - preserving maps @xmath60\\to [ 0,1]$ ] , and for @xmath61 in @xmath42 and @xmath62 , let @xmath63 .",
    "then @xmath64 if and only if there exist @xmath65 in @xmath59 such that @xmath66 almost everywhere ; see cor . 2.2 in @xcite .",
    "the space @xmath42 is compact with respect to the ` cut metric ' defined as follows .",
    "first , on @xmath67 define : @xmath68}\\big| \\int_{s\\times    t}[f(x , y)-g(x , y)]\\ , dxdy\\big|.\\ ] ] then on @xmath57 define the cut metric by :    @xmath69    we will use the fact , which follows easily from lemma 4.1 in @xcite , that the cut metric is equivalent to the metric @xmath70 where @xmath71 is a countable set of simple graphs , one from each graph - equivalence class . also note that if each vertex of a finite graph is split into the same number of ` twins ' , each connected to the same vertices , the result stays in the same equivalence class , so for a convergent sequence @xmath72 one may assume @xmath73 .",
    "the following was proven in @xcite .",
    "[ thm1 ] ( @xcite ) for any possible pair @xmath25 , @xmath74 $ ] , where the maximum is over all graphons @xmath21 with @xmath75 and @xmath76 , where @xmath77 ^ 2 }   g(x , y ) \\ , dxdy , \\qquad t(g ) =    \\int_{[0,1]^3 } g(x , y ) g(y , z ) g(z , x ) \\ , dxdydz\\ ] ] and the rate function is @xmath78 ^ 2 } i_0(g(x , y ) ) \\,dxdy , \\hbox {      \\rm where } i_0(u)= \\frac{1}{2 } \\left [ u \\ln(u ) +      ( 1-u)\\ln(1-u)\\right ] .\\ ] ]",
    "fix a graphon @xmath21 with edge density @xmath2 .",
    "we can always write such a graphon as @xmath79 where @xmath80 is the constant function on @xmath81 ^ 2 $ ] with value @xmath82 .",
    "we then compute    @xmath83 ^ 2 } { { \\delta g}}(x , y)\\,dxdy +   3e\\int_{[0,1]^3 } { { \\delta g}}(x , y ) { { \\delta g}}(y , z)\\,dxdydz\\cr & & + \\int_{[0,1]^3 } { { \\delta g}}(x , y ) { { \\delta g}}(y , z ) { { \\delta g}}(z , x)\\ , dxdydz.\\end{aligned}\\ ] ]    the first term on the right hand side is zero , since @xmath84 ^ 2 } \\delta g(x , y)\\ , dxdy = \\delta e = 0 $ ] .",
    "if we think of @xmath85 as the integral kernel of the hermitian trace class operator @xmath86 on @xmath87)$ ] , then using the inner product @xmath88 and trace @xmath89 we can rewrite the remaining terms as @xmath90 where @xmath91 is the constant function on @xmath81 $ ] . note that the first term is non - negative . using again the fact that @xmath84 ^ 2 } { { \\delta g}}(x , y)\\,dxdy=0 $ ] , @xmath92 ^ 2 } [ i_0(e+{{\\delta g}}(x , y))-{{\\delta g}}(x , y ) i_0'(e ) -i_0(e)]\\,dxdy \\cr   & = &   \\int_{[0,1]^2 } \\frac{i_0(e+{{\\delta g}}(x , y))-{{\\delta g}}(x , y ) i_0'(e ) -i_0(e)}{{{\\delta g}}(x , y)^2 } { { \\delta g}}(x , y)^2\\,dxdy \\cr & \\ge & f_-(e ) \\int_{[0,1]^2 } { { \\delta g}}(x , y)^2\\,dxdy , \\end{aligned}\\ ] ] where @xmath93 and @xmath94 is a positive number less than or equal to @xmath95 .",
    "[ lem ] @xmath96 , with equality if and only if @xmath86 is a rank 1 operator .    since @xmath86 is an hermitian trace class operator it has pure discrete spectrum . if @xmath97 are the eigenvalues of @xmath86 , then @xmath98^{3/2}.\\ ] ] if @xmath86 has rank one , then @xmath99^{3/2}$ ] .",
    "if @xmath86 has rank bigger than 1 , then @xmath100 is strictly smaller than @xmath101 .",
    "we next give an estimate for @xmath102 when @xmath37 .",
    "if @xmath103 , then @xmath104^{3/2 } \\le \\left ( \\frac{\\delta i}{f_-(e)}\\right ) ^{3/2}.\\ ] ] this implies that @xmath105 using @xmath106 this also implies a linear estimate @xmath107 for @xmath108 .    finally , we estimate @xmath102 when @xmath109 . since @xmath110 , and since @xmath111 , we have @xmath112 so @xmath113",
    "we now generalize theorem [ thm0 ] to graph models where we keep track of the number of graph homomorphisms @xmath114 for some fixed graph @xmath49 , not necessarily triangles .",
    "we can compute the entropy of graphs with @xmath115 within @xmath116 of @xmath2 and @xmath117 within @xmath116 of @xmath3 , and define the entropies @xmath118 and @xmath33 exactly as in equation ( [ entropydef ] ) .",
    "the proof of theorem [ thm1 ] carries over almost word - for - word to show the following .",
    "[ thm3 ] for any possible pair @xmath25 , @xmath119 $ ] , where the maximum is over all graphons @xmath21 with @xmath75 and @xmath120 .",
    "note that if @xmath49 has @xmath121 edges the constant graphon @xmath122 satisfies @xmath123 .",
    "[ thm4 ] for fixed @xmath124 the entropy density @xmath33 achieves its maximum at @xmath125 and is not differentiable with respect to @xmath3 at that point .",
    "following the proof of theorem [ thm0 ] , we write @xmath126 and expand both @xmath102 and @xmath127 in terms of @xmath128 .",
    "the estimate ( [ ibelow ] ) still applies .",
    "the only difference is the expansion of @xmath127 .",
    "since @xmath127 is the integral of a polynomial expression in @xmath21 , we can expand @xmath129 as a polynomial in @xmath128 .",
    "this must take the form @xmath130 ^ 2 } h_1(x , y ) \\delta g(x , y)\\ , dx dy +   \\int_{[0,1]^4 } h_2(w , x , y , z ) \\delta g(w , x ) \\delta g(y , z)\\ , dw dx dy dz \\cr & & + \\int_{[0,1]^3 } h_3(x , y , z ) \\delta g(x , y ) \\delta g(y , z)\\ , dxdydz + \\cdots,\\end{aligned}\\ ] ] where the non - negative functions @xmath131 , @xmath132 , @xmath133 , etc .",
    ", are computed from the graphon from which we are perturbing . however , that graphon is a constant @xmath122 , so each function @xmath134 is also a constant .",
    "thus there are non - negative constants @xmath135 , @xmath136 , @xmath137 , such that @xmath138 ^ 2 } \\delta g(x , y ) \\ , dxdy\\ & + & c_2 \\int_{[0,1]^4 } \\delta g(w , x)\\delta g(y , z)\\ , dw dx dy dz \\cr   & + & c_3 \\int_{[0,1]^3 } \\delta g(x , y ) \\delta g(y , z)\\ , dx dy dz + \\cdots\\end{aligned}\\ ] ] the first two terms integrate to zero , while any subsequent terms are bounded by a multiple of @xmath139 .",
    "since there are only a finite number of terms , @xmath140 is bounded above by a constant multiple of @xmath139 while @xmath141 is bounded below by a constant multiple of @xmath139 . combining these observations yields the analog of theorem [ thm0 ] , and",
    "we conclude that @xmath33 can not have a 2-sided derivative with respect to @xmath3 at @xmath125 .    a more careful analysis of the terms in the sum ( [ bigsum ] )",
    "shows that each term is either positive - definite , is dominated by a positive - definite term , or scales as @xmath142 or higher , implying that the concavity of @xmath33 just below the curve @xmath125 is the same as for the triangle model .",
    "however , this analysis is not needed for the proof of theorem [ thm4 ] and has been omitted .    there",
    "do exist some graphs @xmath49 , such as `` @xmath121-stars '' with @xmath121 edges and one vertex on all of them , such that the lowest value of @xmath3 for fixed @xmath2 is on the ` erds - rnyi curve ' , @xmath143 .",
    "for such graphs the analysis of what happens for @xmath103 is moot and @xmath33 may have a 1-sided derivative at @xmath144 .",
    "we return temporarily to the special case in which @xmath49 is a triangle .",
    "note that it has been fundamental to our analysis to use the optimization characterization of @xmath33 of theorem [ thm1 ] ( theorem 3.1 in @xcite ) . treating this as an optimization with constraints",
    ", one might naturally introduce lagrange multipliers @xmath145 and consider the following optimization system , @xmath146;\\ e(g)=e;\\ t(g)=t,\\ ] ] namely maximize @xmath147 for fixed @xmath148 and then adjust @xmath148 to achieve the desired values of @xmath18 and @xmath19 .",
    "the ` free energy density ' @xmath149 is directly related to the normalization in exponential random graph models and basic information in such models is simply obtainable from it @xcite .",
    "it can be considered the legendre transform of @xmath33 , but since the domain of @xmath33 is not convex , the relationship between @xmath33 and @xmath150 must be more complicated than is common for legendre transforms . in particular , although it has been proven ( @xcite ) that @xmath150 has singularities as a function of @xmath148 ( see figure 2 ) it does not seem straightforward to use this to prove singularities in @xmath33 .",
    "this is what necessitated the different approach we have taken here .",
    "we will try to clarify the relationship between @xmath150 and @xmath33 through differences in the optimization characterizations of these quantities .",
    ".4truein , for @xmath151,title=\"fig:\",width=288 ]    as one crosses the curve in figure 2 by increasing @xmath152 at fixed @xmath153 , the unique graphon maximizing @xmath154 jumps from lower to higher value of @xmath18 , but still @xmath155 @xcite .",
    "we emphasize that whenever @xmath151 , one is on the erds - rnyi curve @xmath36 indicated in figure 1 @xcite .",
    "this is significant in interpreting the singularities of @xmath33 and @xmath150 .",
    "the singularities or ` transition ' characterized in theorem [ thm0 ] and associated with _",
    "crossing _ the erds - rnyi curve is presumably between graphs of different character but similar densities ; we expect that graphons maximizing @xmath33 , for @xmath156 , are related to those ( discussed below ) for the upper boundary of its domain @xmath24 , while for @xmath157 they are related to those for the lower boundary of @xmath24 .",
    "( the latter are the subject of @xcite . ) on the other hand , the transition in figure 2 , associated with varying @xmath148 , is between graphs of similar character ( independent edges ) but different densities .",
    "this phenomenon is unrelated to the transition of theorem [ thm0 ] , although still associated with the erds - rnyi curve , and which we understand as follows .",
    "assume one optimizes @xmath154 for fixed @xmath148 , where @xmath148 is adjusted so that maximizing graphons @xmath21",
    "satisfy @xmath75 and @xmath76 to match the desired values of @xmath25 in which we are interested for @xmath33 .",
    "it may happen that for special @xmath148 there are also optimizing @xmath21 with other densities , @xmath158 .",
    "this degeneracy is what is occurring precisely for the @xmath148 on the singularity curve of figure 2 .",
    "all such @xmath21 clearly solve the maximization problem for @xmath159 $ ] ; they are appearing together when we fix @xmath148 because the value of @xmath154 happens to be the same for all these @xmath21 , a phenomenon of no particular relevance to the original optimization problem of @xmath33 .",
    "so in this sense degenerate solutions in the lagrange multiplier method can be misleading ; they point to a ` transition ' which is foreign to the maximization problem for @xmath33 .",
    "we next consider other features of the lagrange multiplier method .",
    "one issue of importance to those who study exponential random graph models is that for no @xmath152 is there a maximizer @xmath21 of the free energy density @xmath160 satisfying @xmath161 , though there clearly are such optimizers of the entropy density @xmath162 as we see for instance from figure 1 .",
    "[ thm5 ] for every @xmath152 and every maximizer @xmath21 of @xmath163 , @xmath164 .",
    "suppose the graphon @xmath165 satisfies @xmath166 ^ 3 $ ] and maximizes the free energy    @xmath167    for some @xmath153 and @xmath152 .",
    "it follows from theorem 4.2 in @xcite that @xmath168 .",
    "let @xmath122 be the constant graphon with the same edge density as @xmath169 .",
    "since @xmath109 , @xmath170 .",
    "also , @xmath171 , since for given edge density @xmath172 is maximized at @xmath122 .",
    "but then @xmath173 , and @xmath165 is not a maximizer , which is a contradition .",
    "having established in theorem [ thm0 ] a phase transition on the erds - rnyi curve , we consider the forms of the graphons that maximize @xmath33 on each side of the curve .",
    "we previously @xcite determined the optimizing graphons on the lower boundary of the region @xmath24 , including the scalloped curve .",
    "we now compute the optimizing graphons on the upper boundary and on the curve @xmath174 below the erds - rnyi line .",
    "let @xmath177 be the operator on @xmath178 $ ] with integral kernel @xmath21 .",
    "we already know that @xmath179 , with equality if and only if @xmath177 is rank 1 . however , @xmath180 with equality if and only if @xmath181 almost everywhere , i.e. @xmath182 or 1 almost everywhere .    combining the two results",
    ", we have that @xmath183 , with equality if and only if two conditions are met : @xmath184 for some positive function @xmath116 , ( i.e. @xmath177 has rank one ) , and @xmath185 is a 01 function , implying that @xmath186 is a 0 - 1 function .    by applying a measure - preserving transformation to @xmath81 $ ] we can assume that @xmath116 is the characteristic function of an interval @xmath187 $ ] .",
    "we then compute @xmath188 and @xmath36 . in short ,",
    "each point on the upper boundary for the allowed region in the @xmath2@xmath3 plane is achieved by a unique reduced graphon , namely the equivalence class of the graphon ( [ top ] ) .",
    "when @xmath174 and @xmath189 , the graphon @xmath190 where @xmath191 , maximizes @xmath33 .",
    "furthermore , every maximizing graphon is of the form @xmath192 for some mearsure - preserving transformation @xmath193 .",
    "we use perturbation theory , writing @xmath194 .",
    "when @xmath174 , the @xmath195 derivative @xmath196 is positive for @xmath0 even and zero for @xmath0 odd .",
    "this means that @xmath197/{x^2}$ ] is a convex function of @xmath198 ( since it is a power series in @xmath198 with positive coefficients ) .",
    "this allows us to find a formula for @xmath128 that simultaneously maximizes @xmath199 for fixed @xmath200 , minimizes the positive - definite quadratic term in @xmath129 ( to be zero ) , and minimizes @xmath141 for fixed @xmath200 .",
    "this must therefore be a minimizer of the rate function and a maximizer of the entropy .",
    "we assume throughout that @xmath201 .",
    "now we try to minimize @xmath84 } i[e+c\\alpha(x)\\alpha(y)]\\ , dxdy$ ] . by convexity ,",
    "this is minimized when @xmath210 ^ 2 $ ] is constant , which means that @xmath211 is constant .",
    "since the integral of @xmath116 is zero , we must have @xmath212 on a set of measure 1/2 and @xmath213 on a set of measure 1/2 .",
    "up to measure - preserving automorphism , we can assume that @xmath214 this means that any graphon that minimizes @xmath102 for fixed @xmath174 and fixed @xmath215 must be @xmath58 , up to a measure - preserving transformation .",
    "we proved in theorem [ thm5 ] that maximizing graphons for @xmath33 for @xmath216 can not be found using lagrange multipliers .",
    "we now show that this also applies to certain values of @xmath37 , starting with @xmath174 and @xmath3 close to @xmath217 .",
    "now consider the optimization using lagrange multipliers .",
    "the euler - lagrange equations are : @xmath221   + \\beta_1 + \\beta_2 h(x , y)=0,\\ ] ] where @xmath222 } g(x , z ) g(y , z)\\ , dz\\ ] ] is the first variation of @xmath19 with respect to @xmath185 . for our @xmath223 ,",
    "this becomes : @xmath224 \\cr \\beta_1 + 3 \\beta_2\\left ( \\frac{1}{4}+\\epsilon^2\\right ) & = & i_0'\\left ( \\frac{1}{2}-\\epsilon\\right )   = \\frac{1}{2}\\ln\\left[\\frac{\\frac{1}{2}-\\epsilon}{\\frac{1}{2}+\\epsilon}\\right],\\end{aligned}\\ ] ] which are satisfied if and only if @xmath225.\\ ] ] notice that @xmath153 and @xmath152 diverge as @xmath226 ( equivalently , as @xmath227 ) .",
    "however , solutions to the euler - lagrange equations are not necessarily local maxima of @xmath160 .",
    "it is easy to check by differentiation of ( [ halfentropy ] ) that there are @xmath228 such that @xmath229 is strictly concave on @xmath230 but strictly convex on @xmath231 $ ] .",
    "convexity implies that @xmath58 is not a maximizer for @xmath232 for @xmath233 , but is rather a local _ minimizer with respect to variation of @xmath3 , and so there are no @xmath148 which can lead to the maximizers of @xmath234 for @xmath3 just below @xmath217 .",
    "while the precise calculation was done for @xmath174 using equation ( [ halfentropy ] ) , this phenomenon is simply due to inequality ( [ strong ] ) , and actually occurs for all @xmath2 , not just for @xmath174 .",
    "in fact from the proof of theorem [ thm4 ] this phenomenon can be extended to subgraphs @xmath49 other than triangles .",
    "[ however , as noted above , for some @xmath49 the erds - rnyi curve is actually the lower boundary of the domain of the entropy , in which case there are no ` missing ' points below it . ] .2truein * acknowledgements : * we gratefully acknowledge useful discussions with mei yin . .2truein _"
  ],
  "abstract_text": [
    "<S> we prove that the asymptotic entropy of large simple graphs , as a function of fixed edge and triangle densities , is nondifferentiable along a certain curve . </S>"
  ]
}