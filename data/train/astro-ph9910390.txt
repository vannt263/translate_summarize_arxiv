{
  "article_text": [
    "we want hereafter to model the hydrodynamical ( hd ) evolution of a disk described on a fixed polar eulerian grid . for the sake of simplicity we are only going to deal with a two dimensional keplerian disk , but",
    "the algorithm can be extended with little additional effort to any gaseous thin or thick disk in differential rotation . usually in this kind of numerical simulations",
    "the timestep is limited by the courant friedrich levy ( cfl ) condition at the inner boundary , where the motion is fast and the cells are narrow .",
    "indeed , the ratio of the distance swept by the material in one timestep to the cell width must be lower than unity over the whole grid , otherwise a numerical instability occurs ( i.e. non physical short - wavelength oscillations appear , grow exponentially and spoil the model ) . in a keplerian disk this ratio ( which we call hereafter the cfl ratio ) decreases as @xmath0 .",
    "since in most cases the `` interesting region '' of the grid is located much further than the grid inner boundary , the cfl ratio in the region of interest is much smaller than unity , which corresponds to a waste of computing time , and , as we are going to see below , to an enhanced undesirable numerical viscosity . the most obvious solution to get rid of such a limitation is to work in the comoving frame .",
    "unfortunately , most finite - difference hd eulerian codes require an orthogonal system of coordinates ( stone & norman , 1992 ) , which makes them unsuitable if one wants to work in the comoving frame in a differentially rotating disk , and even a non - orthogonal grid eulerian code would be unable to track accurately the fluid motion after a few orbits , due to the strong winding of the coordinate system . on the other hand , one can adopt a lagrangian description of the disk ( whitehurst , 1995 ) , but the implementation is much more tricky and difficult .",
    "furthermore , the geometry of an accretion disk provides a polar mesh as a natural grid .",
    "we describe hereafter a simple method which enables one to work on a fixed polar grid and to get rid of the cfl condition on the average azimuthal velocity at each radius .",
    "we consider a polar grid composed of @xmath1 sectors , each one @xmath2 wide , and @xmath3 rings , with separations at radii @xmath4 .",
    "the inner boundary is then located at the radius @xmath5 , and the outer one at the radius @xmath6 . the density ( and the internal energy if needed by the equation of state ) is centered in the cells , and is denoted @xmath7\\times[0,n_s-1]}$ ] .",
    "the radial velocity is denoted @xmath8 , and is considered centered in azimuth and half - centered in radius ( applied at radius @xmath9 , i.e. at the interface between the cells @xmath10 $ ] and @xmath11 $ ] ) . in a similar way , the azimuthal velocity is denoted @xmath12 , and is considered centered in radius and half - centered in azimuth ( i.e. at the interface between the cells @xmath10 $ ] and @xmath13 $ ]  ; throughout this paper the algebra on the @xmath14 coordinate is meant in @xmath15 to account for the periodicity in azimuth ) . usually in a finite difference code",
    "the timestep is split in two main parts ( stone & norman 1992 ) .",
    "the first part is composed of eulerian substeps which consist in updating the hd quantities through the source terms in the evolution equations , and which include all the physical processes at work : pressure , gravity , viscosity , etc . , and which can formally be described by the transformation @xmath16 , @xmath17 being any hd field on the grid . the second part is the transport substep , in which the quantities are conservatively moved through the grid according to the flow @xmath18 $ ] , and which can be formally represented as @xmath19 , where @xmath20 denotes any hd field after a whole timestep is completed , and @xmath21 and @xmath22 denote respectively the radial and azimuthal transport operators , which can be alternated every other timestep .",
    "the cfl condition comes both from the source part and the transport part , and the most stringent restriction is given by the @xmath22-substep , due to the unperturbed azimuthal flow .",
    "classically , the azimuthal transport can be written as : @xmath23 where @xmath24 is the `` mean azimuthal width '' of a cell .",
    "( [ eqn : clastrans ] ) expresses the balance of the arbitrary conservative quantity @xmath17 in the cell @xmath10 $ ] by computing the difference of its inflow at the @xmath13/[i , j]$ ] interface with the velocity @xmath25 and its outflow at the @xmath26/[i , j]$ ] interface with the velocity @xmath27 .",
    "actually we consider the flux of the upwinded interfacial quantity @xmath28 , where the `` @xmath29 '' operator depends on the numerical method ( donor cell , van leer , ppa , see e.g. stone & norman 1992 ) and on the velocity field @xmath30 .",
    "let us take as an example the angular momentum conservation equation : @xmath31 where @xmath32 .",
    "the transport equation of any hd quantity @xmath17 will look the same as the l.h.s . of eq .",
    "( [ eq : angmom1 ] ) .    now without loss of generality",
    "we can rewrite eq .",
    "( [ eq : angmom1 ] ) as : @xmath33}{\\partial\\theta } + \\frac{u}{r}\\frac{\\partial j}{\\partial \\theta } + \\frac{1}{r}\\frac{\\partial(rv^r j)}{\\partial r } = \\mbox { source terms } \\ ] ] where @xmath34 can be any quantity which does not depend on @xmath35 .",
    "no assumption has been made on the behavior of @xmath36 up to this point , and eq .",
    "( [ eq : angmom1 ] ) and  ( [ eq : angmom2 ] ) are strictly equivalent . if we take @xmath34 to be the average azimuthal velocity @xmath37 , then eq .",
    "( [ eq : angmom2 ] ) can be described as a composition of different steps , and each of them can be worked out independently with the well - known operator splitting technique :    * a source step , * a radial transport step , * an azimuthal transport step with the velocity @xmath38 , which we are going to call the azimuthal _ residual _ velocity , * and an additional step which corresponds to the following pde : + @xmath39 + it is an easy matter to check that the solution of this last equation can be written in a general way as : @xmath40 which means that the solution of this equation at any time @xmath41 looks like the initial profile ( @xmath42 ) , except for a shift @xmath43 in azimuth .",
    "it should be noted that this is true _ whatever the profile of @xmath36 _ , which can even contain discontinuities ( shocks ) .",
    "in particular _ no assumption has to be made _ on the linearity of the flow ( on the relative amplitude of the perturbed quantities ) .",
    "a qualitative reason of why such a decomposition is valid is that the time evolution of the hd quantities can be described either by an observer sitting on a ring of radius @xmath44 which rotates at any instant in time with the average azimuthal velocity , or by an observer at rest in an inertial frame . now",
    "the time evolution of the system is of course observer - independent , which is why their observations are reconciled through the simple shift described by eq .",
    "( [ eq : shiftsol ] ) .",
    "the idea on which the fargo algorithm is based on is precisely to evolve the hd quantities through operators which mimic in a discrete way the different terms of eq .",
    "( [ eq : angmom2 ] ) .",
    "the source step , the radial transport step and the residual azimuthal velocity transport step are performed in a standard way ( see stone & norman , 1992 ) .",
    "now the last step in the operator - splitting described above , which corresponds to a simple shift which amounts to be @xmath45 in one timestep , can be implemented in such a way that the matter can sweep an arbitrary number of cell widths in one timestep .    in order to lay down the basic mechanism by which fargo works ,",
    "let us take the following concrete example .",
    "we assume that , after the classical substeps ( which are the source step , the radial transport and the residual azimuthal velocity transport ) , the material at a given radius @xmath44 has to be shifted by @xmath46  cells in one timestep ( which means that @xmath47 ) .",
    "what is actually done is that @xmath46 is decomposed as @xmath48 , the nearest integer and a remainder which by construction is lower or equal to @xmath49 in absolute value . in the first substep of this shift",
    "step the material is shifted by this remainder ( here @xmath50 ) , which can be achieved through a classical transport method since the remainder is lower or equal to @xmath49 in absolute value ( it has to be @xmath51 in order for the standard transport method to be possible ) , with the additional simplicity that the corresponding velocity field is uniform ( which is actually why shift and transport happen to coincide in this special case , since there is no compression in the corresponding flow ) .",
    "the second substep just corresponds to an integer number of cells shift , which is done in our example simply by copying the content of cell @xmath14 into cell @xmath52 , for any @xmath14 .",
    "a more formal and detailed description of the fargo algorithm is given in the next section .",
    "in the modified algorithm , the azimuthal transport substep is split in several parts .",
    "we assume that the timestep @xmath53 has already be chosen , and defer discussion of the timestep constraints until section  [ subsec : ts ] .",
    "we first compute the average azimuthal velocity at each radius : @xmath54 we then introduce the residual velocity : @xmath55 , and the `` shift number '' at each radius  : @xmath56\\ ] ] where @xmath57 $ ] denotes the nearest integer to the real @xmath58 .",
    "we define the constant residual velocity to be : @xmath59 hence the total velocity can be expressed as : @xmath60 where the `` shift velocity '' @xmath61 corresponds to a uniform shift of @xmath62 cells over one timestep .",
    "we first transport the hd quantities according to the flow @xmath63  : @xmath64 then to the uniform flow @xmath65  : @xmath66 we split the first part of the transport into two parts ( @xmath63 and @xmath65 ) instead of using a single transport step with the velocity @xmath67 , in order to ensure ( as can be checked below given the timestep constraints ) that in each of these transport substeps the material sweeps at most half a cell ( it could sweep up to one cell , but for reasons which will become clear in section  [ sec:1d ] , we prefer to take a half cell limitation ) , and in order for the continuity considerations of section  [ sec : cont ] to apply . finally , the quantities are transported along the @xmath68 uniform flow  : @xmath69 only the first two parts of this transport step introduce some numerical diffusion .",
    "the last one , given by eq .",
    "( [ new : step7 ] ) , which in many cases corresponds to the largest part of the motion , does not introduce any numerical error , since it just corresponds to a circular permutation of the grid cells , or in other words it is just an integer discrete version of the shift given by eq .",
    "( [ eq : shiftsol ] ) .",
    "a precise quantification of the lower numerical diffusivity of fargo is beyond the scope of this paper though .",
    "an extremely rough estimation can be done in the case of the comparison of a standard method ( in which the effective cfl ratio is a sizable fraction of one ) and a fargo method for which @xmath70 .",
    "if we assume that numerical effects will behave in azimuth as a physical viscosity would do , then the effective numerical viscosity in fargo is about @xmath71 times lower than the standard method s one , where @xmath72 is the cfl standard dimensionless limitation factor , which is detailed in the next section .",
    "nevertheless a variety of numerical experiments can be found below which all show that fargo s numerical diffusivity is smaller than the standard method s .      in the standard transport method ,",
    "the timestep limitation arises from the combination of four different constraints ( see e.g. stone & norman 1992 ) , namely the fact that a flow advected test particle in cell @xmath10 $ ] should not sweep a distance longer than @xmath73 in azimuth nor longer than @xmath74 in radius over one timestep ( which introduces the limit timestep @xmath75 and @xmath76 in stone & norman s paper ) , and that the wavefront of any wave present in the system should not travel across a whole cell over one timestep ( richtmyer & morton , 1957 ) , which corresponds to the limit timestep @xmath77 in stone & norman s paper .",
    "the last constraint comes from a stability limit arising from the viscosity ( numerical or physical ) . with the modified azimuthal transport algorithm",
    ", the constraint on the azimuthal motion has to be modified slightly .",
    "following stone & norman s notation , instead of writing @xmath78 , we write  : @xmath79 which means that the timestep limitation comes now from the perturbed azimuthal velocity , which results in a much higher absolute value of @xmath76 .",
    "another limitation arises from the shear .",
    "indeed we do not want the shear to disconnect the two neighboring cells @xmath10 $ ] and @xmath80 $ ] after one timestep .",
    "we write this condition as  : @xmath81 following stone & norman s notations , we finally adopt  : @xmath82    @xmath83^{1/2}\\}\\ ] ]      at each timestep , @xmath3 values of @xmath62 ( with @xmath84 $ ] ) , used in eq .",
    "( [ new : step7 ] ) , are computed using eq .",
    "( [ new : step2 ] ) .",
    "these integer values scale roughly as @xmath85 .",
    "the shift on the central parts generally amounts to several cells over one timestep , while in the outer parts @xmath62 is small , and possibly zero .",
    "one can wonder whether or not problems may arise at the radii @xmath9 where @xmath86 ( i.e. at radii where the azimuthal shift corresponding to the third substep of the transport step is discontinuous ) .",
    "more generally we want to examine the question of the continuity of @xmath87 with respect to @xmath88 . in order to check for this continuity ,",
    "we assume @xmath89 , where @xmath90 is an integer , and we work out the behavior of @xmath91 in the vicinity of @xmath92 . since we have to use the explicit form of the `` @xmath29 '' operator , we adopt the van leer algorithm ( van leer , 1977 ) , which is widely used .",
    "some straightforward algebra leads to  :    @xmath93    @xmath94    both for @xmath95 and @xmath96 provided @xmath97 and where the operator `` @xmath98 '' is the van leer slope .",
    "( [ eqn : conti ] ) shows that the field @xmath99 is a continuous function of @xmath100 and hence of @xmath101 . in particular",
    "no special problem is to be expected from the discontinuities of @xmath62 across the disk .      as we said in section",
    "[ sec : clas ] , it is a common practice to alternate the radial @xmath21 and azimuthal @xmath22 transport operators every other timestep . in this modified algorithm , @xmath21 should usually be applied first , unless the velocity field is updated just after applying the @xmath22 operator from the new momenta and new density fields , or unless special care is devoted to the @xmath14 indices .",
    "indeed swapping blindly the @xmath21 and @xmath22 operators would result in moving radially the matter with the radial velocity it actually has @xmath102 cells upwards , and would quickly end in a non - physical staggering everywhere @xmath103 .",
    "in order to validate this modified transport algorithm , we present some 1d tests , and we compare the results of the standard method and of the fargo method on a realistic test problem . we solve simultaneously the continuity and navier stokes equation for an isothermal gas ( which has a non - vanishing but small kinematic viscosity ) :    @xmath104    @xmath105    we assume that at rest the system has a uniform density @xmath106 and sound speed @xmath107 . the waves which can propagate in this system have the following dispersion relationship :    @xmath108    @xmath109    which reduces to the standard dispersion relation for an undamped acoustic wave @xmath110 provided the system is evolved for a time small compared to the damping timescale @xmath111",
    ". this will be the case for the results we are going to present below , so that any apparent damping of the waves has a numerical origin .",
    "we do the following :    1 .",
    "we first analyze the propagation of a sound wave in the matter frame , we take as initial conditions : @xmath112 where @xmath113 is the wave relative amplitude .",
    "the polarization adopted corresponds to a rightwards propagating wave . according to eq .",
    "( [ eq : rd1 ] ) , it propagates with a phase velocity which is @xmath114 .",
    "we study this propagation with the standard transport algorithm ( we are in the matter frame so there is no systematic average @xmath115-velocity , hence no need for a fargo algorithm ) .",
    "we check that in this case the solution we get is accurate by varying the timestep and checking that the solution has converged .",
    "2 .   we then turn to a case where the setup is slightly modified .",
    "we take : @xmath116 where @xmath117 is a constant , which we choose much bigger than @xmath107 ( which would correspond to the conditions of a thin keplerian disk , for example ) .",
    "the evolution of the system from this setup ought to be the same as before , since it merely corresponds to the same physical situation , but described from a frame moving at a constant speed @xmath118 w.r.t the first one , so one can invoke galilean invariance to conclude that the wave profile evolution has to be the same .",
    "so any `` good '' algorithm should approach as closely as possible the results of the matter frame simulations .",
    "we show that this is not quite the case with the standard transport method , which suffers from quite a high numerical dissipation , whereas fargo behaves much better ( not to mention its much faster execution ) . as a side result",
    "we also show that in this problem taking a cfl effective ratio ( for the standard transport method ) bigger than @xmath119 leads to an artificial and non - linear increase of the wave profile , and hence has to be avoided .",
    "we deal with a 1d grid composed of @xmath120 cells , with periodic boundary conditions .",
    "the cell width is @xmath121 , the isothermal sound speed is @xmath122 .",
    "the equilibrium density is @xmath123 .",
    "these parameters correspond roughly to the ones used in the numerical study of a protoplanet on a circular orbit at 5  a.u . embedded in a minimum mass protoplanetary disk ( hayashi 1985 or bryden 1998 ) , that are described in section  [ sec:2d ] ) , when the central star mass and the protoplanet orbit radius are taken to be respectively the units of mass and distance .",
    "we present the results of different test runs in fig .  [",
    "fig : res ] .",
    "the thick solid line represents the initial profile , which corresponds to a rightward propagating acoustic wave , with wavelength @xmath124 .",
    "the relative amplitude of this sound wave is @xmath125 .",
    "the thick dashed line represents the density profile at time @xmath126 , i.e. after the wave has traveled @xmath127 times its own wavelength , when studied in the matter frame , i.e. when the velocity at @xmath42 is set to be only the perturbed velocity associated to the sound wave .",
    "the thick dashed profile is obtained with the standard transport algorithm ( there is no need for the modified one in this case since we work in the matter frame ) , with a timestep @xmath128 .",
    "the curves obtained by choosing a much smaller timestep appear to coincide exactly with this one , hence we can consider this thick dashed line as the actual state the system must have at the date @xmath129 . this profile does not exactly coincide with the initial one because @xmath129 is @xmath130 of the profile steepening time @xmath131 .    now if we just change the initial velocity by uniformly adding @xmath132 to them at @xmath42 , which means that we are no more in the matter frame , and we still work with the standard transport algorithm , then we get the dotted profile , which has @xmath133 the amplitude obtained from the computation in the matter frame . in this",
    "run the cfl ratio is @xmath134 . in order to check the timestep dependency of this result ,",
    "we redo this test with twice as smaller a timestep ( @xmath135 ) and we get the dash - dotted profile , which has about twice as smaller a density contrast than the previous curve .",
    "note that if this effect were to be due to a physical kinematic viscosity @xmath136 , then its value should be  : @xmath137 , much higher than the expected viscosity in a minimum mass protoplanetary disk ( @xmath138 in our dimensionless units ) .",
    "now , instead of decreasing the timestep , we increase it and set @xmath139 ( hence the cfl ratio is about @xmath140 ) .",
    "we then get at time @xmath129 the dot - dot - dot - dashed profile , which is not numerically damped but slightly amplified . with such a large timestep , we can use the modified transport algorithm , which in that case corresponds to a rightwards one cell shift and a leftwards normal transport with a remaining cfl ratio of @xmath141 . in that case",
    "we get the thin long - dashed profile .",
    "if we use the modified fargo transport algorithm , we can still increase the timestep . the thin solid profile and the thin short - dashed profile",
    "have been obtained respectively with @xmath142 ( effective cfl ratio @xmath143 ) and @xmath144 ( effective cfl ratio @xmath145 ) .",
    "we clearly see from these results that the fargo transport algorithm leads to less numerical dissipation than the standard transport . from the first two tests in the non - comoving frame",
    ", one can conclude that increasing the _ number _ of timesteps over a given time interval with the standard transport algorithm increases the numerical dissipation ( if the grid is moving w.r.t the matter frame with a velocity @xmath146 and if the main part of the velocity comes from @xmath117 ) .",
    "a simple explanation for the lower numerical dissipation of the fargo algorithm is that it requires less iterations as the timestep increases , and since most of the distance swept is achieved through an exact shift ( a circular permutation ) , the numerical dissipation has to decrease as the timestep increases .",
    "we show in this section the validity of the modified transport algorithm when applied to the interaction of a jupiter sized protoplanet with a minimum mass protoplanetary disk in which it is embedded .",
    "the perturbed potential associated with the planet excites spiral density waves in the disk , which propagate away both inwards and outwards , with a pattern frequency equal to the planet orbital frequency .",
    "the spiral waves interact with the disk and give it the angular momentum they removed from the planet , and eventually open a gap centered on the planet orbit , provided the planet mass is high enough ( papaloizou & lin , 1984 ) .",
    "we present a run with a one solar mass primary , one jupiter mass protoplanet initially on a fixed circular orbit at @xmath147  a.u . embedded in a standard protoplanetary nebula whose",
    "parameters have been mentioned above .",
    "the grid has an inner radius at @xmath148  a.u . and an outer radius at @xmath149  a.u .",
    "the sequence @xmath150}$ ] is equally spaced , with @xmath151  ; the grid has @xmath152 sectors , it is fixed in a non - galilean non - rotating frame centered on the primary .",
    "its outer boundary is rigid and its inner boundary allows outflow but no inflow .",
    "the disk aspect ratio is set to @xmath153 everywhere .",
    "the planet perturbed potential is smoothed on a length scale which amounts to 40  % of the roche radius . in eq .",
    "( [ eqn : shearlimit ] ) we choose @xmath154 .",
    "we plot on fig .",
    "[ fig : eij ] the quantity @xmath155 after @xmath156 orbits .",
    "this quantity represents the effective cfl ratio . with the standard transport algorithm",
    "this ratio is bounded by @xmath72 .",
    "we see that the innermost ring sweeps almost four cells on one timestep , hence the use of the fargo transport algorithm in this case results in a speed - up by a factor @xmath157 of the computation .",
    "one can note that the difference in @xmath158 between the innermost ring and its immediate neighbor is @xmath49 , which is the maximum allowed by eq .",
    "( [ eqn : shearlimit ] ) .",
    "indeed the timestep in this run is shear - limited , and the constraint on the residual velocities only would lead to an even bigger timestep , since as one can see the residuals of the distance swept over one timestep amounts to far less than @xmath159 , even in the vicinity of the planet .",
    "indeed , runs performed with a logarithmic polar grid ( with @xmath160 constant ) , which have a smaller value of @xmath74 in the inner part , have shown to allow a speed - up by a factor @xmath161 w.r.t . the standard method .    in order to see how numerical viscosity affects the disk response in both cases , we plot on the fig .",
    "[ fig : diskdens ] the disk density after @xmath162 orbits , obtained from different algorithms .",
    "the left plot corresponds to a non - rotating frame standard transport run , while the middle plot represents a non - rotating frame fargo transport run , and the right plot represents a standard transport run in a frame corotating with the planet ( hence the planet is fixed with respect to the grid , so we expect from the results of section  [ sec:1d ] the density response in the vicinity of the planet to be given with a high accuracy ) .",
    "note that special care has to be devoted to the treatment of the coriolis force in that case in order to conserve exactly the angular momentum and then to avoid a spurious outwards transport in the disk ( kley , 1998 ) .",
    "we clearly see that the global spiral pattern excited by the protoplanet in the disk is identical in the three cases , though the response in the immediate vicinity of the planet is much more spread out in the non - rotating frame standard accretion case ( left plot ) , and that the most sharply peaked response is achieved through the use of a corotating frame ( right plot ) , as expected . indeed , we plot on fig .",
    "[ fig : denspeak ] a cut of the disk density at the planet radius in the three cases .",
    "the solid line represents the fargo transport result , and the dot - dashed line the corotating frame result .",
    "they both have the same width , though the maximum of the density in the corotating case is higher .",
    "the dashed curve represents the result of the standard transport in a non - rotating frame .",
    "its width is about twice as large as the other curves width , and we also see that numerical effects in that case lead to additional leading and trailing material ( near cells number  @xmath163 and @xmath164 ) , and to a smaller density peak value .",
    "the fargo plot on figure  [ fig : diskdens ] exhibits at its inner boundary an oscillatory behavior which originates from three combined effects .",
    "first , this is a shear - limited run   see eq .",
    "( [ eqn : shearlimit ] ) and fig .",
    "[ fig : eij ]   ; if we change the @xmath49 factor in eq .",
    "( [ eqn : shearlimit ] ) to @xmath165 , this oscillatory behavior disappears ( hence in any high resolution run , where the algorithm is most likely to be residual velocity limited rather than shear - limited , it never turns up ) .",
    "second , the inner grid has strongly radially elongated cells .",
    "if we take a log - grid ( see e.g. nelson , 1999 , or the example below ) , where the cells are almost `` square '' everywhere , this behavior is not observed , even if the run remains shear - limited . and finally , we have a steep density gradient close to the inner boundary . if the inner boundary was closed and hence if we had no density gradient , this oscillatory behavior would never appear .",
    "in all the cases where it was observed this behavior always disappeared after a few tens of dynamical times .",
    "it should be noted that the numerical damping observed in the non - stationery frame in section  [ sec:1d ] occurs both in the non - rotating frame _ and corotating frame ( far from the coorbital region ) _ standard method runs .",
    "hence the amplitude of the protoplanet triggered density wave is marginally higher in a fargo run at the inner boundary .",
    "both this reason and the effect we noticed in the previous paragraph lead to a marginally higher mass loss through the inner boundary , at least during the first stages of the evolution of the system , which results in the darker band at the inner boundary in the middle panel of figure  [ fig : diskdens ] .",
    "we present in figure  [ fig : loggrid ] the results of three runs ( non - rotating standard and fargo , and corotating standard ) , which describe the same physical system as before after the same amount of time , but with a grid for which @xmath166 , @xmath167 , @xmath168 and @xmath169 , and with a geometric sequence for @xmath170}$ ] ( hence it is a log - grid , and everywhere its cells are almost `` square '' ) .",
    "one can check on these plots that there is no oscillatory behavior in the fargo results ( this time the cells are no radially elongated near the inner boundary ) , whereas the run is still shear - limited .",
    "furthermore , as stated above , a careful look at the inner spiral structure shows that it has a slightly higher amplitude in the fargo case .    from the results depicted in figures  [ fig : diskdens ] , [ fig : loggrid ] and  [ fig : denspeak ]",
    ", one can deduce that the fargo transport algorithm on this particular problem is much closer than the usual standard transport algorithm to the exact solution ( which must closely resemble the results given by the corotating frame run , at least in the coorbital region , since in section  [ sec:1d ] we have seen that one needs to be in the comoving frame in order to get accurate results even in the limit of a vanishing timestep ) .",
    "another quantitative evaluation of the fargo algorithm consists in monitoring the accretion rate onto the planet as a function of time .",
    "we present on figure  [ fig : monitoracc ] the accretion rate onto a one jupiter mass protoplanet embedded in a minimum mass protostellar disk with no initial gap .",
    "the disk parameters are the same as before , as well as the grid resolution ( arithmetic radial spacing with @xmath151 and @xmath152 ) .",
    "three runs are presented with three different schemes : the standard method in the rotating frame , which gives , according to section  [ sec:1d ] , the most accurate results , the standard method in the non - rotating frame , and the fargo method in the non - rotating frame .",
    "we use a slightly different accretion procedure than the one described by kley ( 1999 ) .",
    "we see from the curve obtained in the corotating frame that the accretion rate is about @xmath171  @xmath172 after @xmath173 orbits .",
    "this is in relatively good agreement with kley s results , who gets slightly more than @xmath174  @xmath172 after @xmath173 orbits in a similar run , but with a different grid resolution and a slightly different accretion protocol .",
    "we see from figure  [ fig : monitoracc ] that the accretion rate in the non - rotating frame , with a standard method , is smaller than in the rotating frame run , by a factor @xmath175 .",
    "the fact that the accretion rate is slower in this case was to be expected from the curves of fig .",
    "[ fig : denspeak ] .",
    "now the run with the fargo algorithm leads to an accretion rate which is between the rotating frame results and the non - rotating frame standard transport results , and which are closer to the rotating frame results .",
    "from these considerations again we see that the fargo transport leads to a smaller error w.r.t . the rotating frame results .",
    "the point here is that the fargo transport algorithm is about one order of magnitude or more faster than the corotating frame standard transport run , and that the corotating frame is suitable only to the study of a protoplanet on a fixed circular orbit . from these remarks",
    "it clearly appears that the fargo transport algorithm is particularly well suited to the study of the protoplanet orbit long - term evolution .",
    "fargo has already been used to study the migration and mass accretion of a jupiter sized protoplanet in a protoplanetary disk .",
    "it has been extensively tested against existing independent codes , which use the standard transport algorithm .",
    "it has proven to give very similar results , and the slight differences which remain between these codes and fargo can all be understood in terms of fargo s lower numerical diffusivity ( nelson 1999 ) .",
    "the fargo algorithm for the azimuthal transport turns out to be able to speed up by about an order of magnitude the numerical simulation of a differentially rotating disk , with a smaller numerical viscosity than the usual transport algorithm .",
    "it has been validated by many tests on the embedded protoplanet problem .",
    "it is worth mentioning that the fargo transport algorithm must be used with a good understanding of the physical processes at work in the system . in particular , the timestep given by eq .",
    "( [ eqn : timestep ] ) must be short compared to all the physical time scales relevant for the system . in the case we have presented in this paper this is automatically ensured by the set of eq .",
    "( [ eqn : timelimit ] ) to  ( [ eqn : timestep ] ) , but if additional physics is to be added ( magnetic field , radiative transfer , etc . ) , the timestep limit needs to be carefully worked out . furthermore , no advantage is gained in using fargo in problems where the perturbed velocity is comparable to the rest velocity .",
    "it is the case for instance of the gas flow in a galactic bar .",
    "this does not mean that the fargo algorithm leads to wrong results in that case , but simply that it will not be better than a standard method , both in terms of numerical diffusivity and execution time .",
    "on the other hand , the fargo algorithm appears to be very well suited to all the cases where the perturbed velocities in any differentially rotating disk are small compared to the unperturbed velocities , which does not mean that the problem under consideration has to be linear ; indeed the relative perturbed amplitude can be arbitrarily high ( see section  [ sec:2d ] in which the protoplanet wake generates shocks in the disk ) .",
    "more generally the fargo algorithm can be used to describe the hd evolution of any sheared fluid on a fixed orthogonal eulerian grid .",
    "i am indebted to richard p. nelson for many valuable discussions and suggestions in the course of this work , as well as for a careful reading of the successive drafts of this paper , to jim m. stone for advice on eulerian numerical simulations , to john c. b. papaloizou for many discussions on the protoplanet migration problem , to willy kley for advice on the corotating frame runs , and to an anonymous referee whose comments led to an improvement of the paper .",
    "this work was done in the research network `` accretion onto black holes , compact stars and protostars '' funded by the european commission under contract number erbfmrx - ct98 - 0195 ."
  ],
  "abstract_text": [
    "<S> we present an efficient and simple modification of the standard transport algorithm used in explicit eulerian fixed polar grid codes , aimed at getting rid of the average azimuthal velocity when applying the courant condition . </S>",
    "<S> this results in a much larger timestep then the usual procedure , and it is particularly well - suited to the description of a keplerian disk where one is traditionally limited by the very demanding courant condition on the fast orbital motion at the inner boundary . in this modified algorithm , the timestep is limited by the perturbed velocity and by the shear arising from the differential rotation . </S>",
    "<S> fargo stands for `` fast advection in rotating gaseous objects '' . </S>",
    "<S> the speed - up resulting from the use of the fargo algorithm is problem dependent . in the example presented here , which shows the evolution of a jupiter sized protoplanet embedded in a minimum mass protoplanetary nebula , the fargo algorithm is about an order of magnitude faster than a traditional transport scheme , with a much smaller numerical diffusivity . </S>"
  ]
}