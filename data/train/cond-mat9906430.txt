{
  "article_text": [
    "simulating traffic flow is not only of practical importance for developing traffic optimization measures @xcite .",
    "it is also interesting because of the various self - organization phenomena resulting from non - linear vehicle interactions @xcite .",
    "this includes the formation of traffic jams or stop - and - go waves @xcite , and of synchronized congested traffic @xcite .",
    "many of these phenomena can be simulated by one - dimensional models like cellular automata @xcite and macroscopic traffic models @xcite .",
    "it is , however , questionable if traffic dynamics at on- and off - ramps or intersections can be correctly described without consideration of lane changes @xcite . the same holds close to changes in the number of lanes , accidents , or construction sites .",
    "it is , therefore , desireable to have multi - lane models that explicitly take into account overtaking maneuvers and lane changes .",
    "in contrast to existing cellular automata models for multi - lane traffic @xcite , we will focus on macroscopic models , here , since they allow analytical investigations and a simple calibration to empirical data .",
    "apart from lane - changing maneuvers , traffic dynamics is considerably influenced by the composition of traffic into various types of vehicles with different desired velocities and acceleration capabilities .",
    "this can even cause new kinds of phase transitions in mixed traffic , e.g. to a coherent , solid - like state of motion @xcite .",
    "thus , it is also favourable to have a macroscopic model that allows to distinguish several vehicle types .",
    "we will obtain such a model from a generalized version of a gas - kinetic traffic model , from which we managed to derive a one - dimensional model that is consistent with all presently known properties of traffic flow @xcite , including synchronized congested flow @xcite .",
    "although lane - changes and several vehicle types make the model quite complex , it is still possible to evaluate the boltzmann - like interaction terms .",
    "moreover , whereas previous approaches have neglected correlations between successive vehicles , we will also show how these can be taken into account .",
    "our calculations take care of the fact that vehicles do not interact locally , but with the next vehicle in front , so that the interaction point is advanced by about the safe vehicle distance .",
    "nevertheless , we were able to evaluate the interaction integral without the gradient expansion used in previous publications @xcite .",
    "this resulted in characteristic non - local and anisotropic interation terms , which have very favourable numerical properties @xcite .",
    "like diffusion or viscosity terms , they cause a smoothing of shock fronts .",
    "however , they do not change the character of the set of partial differential equations from a hyperbolic to a parabolic one .",
    "finally , the non - local terms allow to write the macroscopic traffic equations in flux form with source / sink terms , so that numerical standard procedures can be used for their robust and efficient numerical integration @xcite . as a consequence",
    ", it is now possible to solve the multi - lane traffic equations without elimination of the dynamic velocity equations , i.e. without averaging over self - organized velocity variations like stop - and - go traffic .",
    "this had to be done in previous approaches because of numerical stability @xcite , with the consequence that the investigation of unstable multi - lane traffic was not possible .",
    "now , we are able to study how the vehicle dynamics on one lane influences the others .    our paper is organized as follows : in section  ii we will introduce the kinetic model , which allows the derivation of the macroscopic multi - lane model of heterogeneous traffic presented in section  iii .",
    "the decisive steps of this derivation are given in the appendix .",
    "section  iv will discuss the calibration of the model to real traffic data for the case of one effective vehicle type , and it will display various simulation results for difficult test scenarios like lane closures . a comparison with results of an effective single - lane model will be the topic of section v , while section  vi summarizes the results of this paper .",
    "prigogine and coauthors @xcite were the first who proposed a kinetic equation for the phase - space density of vehicles on a highway .",
    "later , paveri - fontana @xcite made important improvements , formulating an equation for the `` extended '' phase - space density @xmath0 , where @xmath1 is the location , @xmath2 the _ actual _ velocity , and @xmath3 the _ desired _ velocity of a vehicle at time @xmath4 .",
    "nagatani and helbing have suggested extensions to multi - lane traffic @xcite .",
    "however , the validity of all theses equations was restricted to the regime of small densities .    here , we present the general kinetic model for multi - lane traffic composed of different types of spatially extended vehicles , and derive the corresponding macroscopic model from it",
    ". the main features of the model are    * the correct description of dense traffic by taking into account the finite space requirements of vehicles , * the `` non - locality of the interactions '' , which means that drivers look ahead and adopt their behavior to the traffic situation at some position in front of them , * the replacement of the `` vehicular chaos '' assumption used by most previous kinetic traffic models @xcite ( with a few exceptions @xcite ) by much less restrictive assumptions , which account for possible velocity correlations of interacting vehicles .    for simplicity , we assume that all vehicles of the same type @xmath5 have the same desired velocity @xmath6 that may depend on the lane @xmath7",
    ". then , we can represent the `` extended '' phase - space density @xmath8 of all vehicles in each lane through a sum of phase - space densities @xmath9 of vehicles of different types @xmath10 : @xmath11 the phase - space densities obey the following continuity equation @xcite : @xmath12 the terms on the left - hand side represent the continuous change of the phase - space density due to the movement of a point in phase space .",
    "the third term represents the tendency of drivers to accelerate to their desired velocity @xmath6 with a relaxation time @xmath13 .",
    "the terms on the right - hand side represent ( quasi-)discontinuous changes of the phase - space densities due to lane - changing maneuvers and braking interactions between vehicles .",
    "we consider three different types of lane - changing behaviour :    * lane - changing maneuvers due to interactions between vehicles , which correspond to overtaking maneuvers or lane changes in order to avoid intensive interactions with slower vehicles in a lane , * `` spontaneous '' lane - changing maneuvers , which reflect effects of traffic regulations and the internal tendency of drivers to use a particular lane , * `` mandatory '' lane changes due to lane mergings , on- or off - ramps , accidents etc .",
    "accordingly , we have : @xmath14    following prigogine , we speak of `` interaction '' , when a faster vehicle approaches a slower one , which forces the faster vehicle to change lane or brake . for simplicity",
    ", we will assume that vehicles do not change their velocities during lane - changing maneuvers and that braking vehicles decelerate exactly to the velocity of the vehicle in front .",
    "the key quantities , which determine the rhs of the kinetic equations , are the `` interaction rates '' , or the effective number of interactions between vehicles per unit of time .",
    "let us denote by @xmath15 the interaction rate of vehicles of type @xmath10 and velocity @xmath2 at place @xmath1 in lane @xmath16 with slower vehicles of type @xmath17 and velocity @xmath18 in front ; by @xmath19 the number of interactions in lane @xmath16 between vehicles of type @xmath10 with velocity @xmath20 and vehicles of type @xmath17 in front with velocity @xmath2 .",
    "the interaction rates @xmath15 with @xmath21 contribute to the decrease of the phase - space density @xmath9 due to lane changing or braking , whereas @xmath19 contribute to the increase of the phase - space density due to braking of vehicles of type @xmath10 to velocity @xmath2 .",
    "they are given by the following formulas : @xmath22 that is , the interaction rates are proportional    * to the `` effective cross section '' @xmath23 , reflecting the increased number of interactions in dense traffic due to the vehicular space requirements ( see below ) , * to the relative velocities @xmath24 of interacting vehicles , and * to the pair distribution function @xmath25 , describing the phase space density of having in lane @xmath16 two vehicles of types @xmath10 and @xmath17 at places @xmath1 and @xmath26 with velocities @xmath2 and @xmath27 , respectively .",
    "note that the classical `` vehicular chaos '' assumption would correspond to the factorization @xmath28 of the pair distribution function into the phase space densities of single vehicles .",
    "with @xmath29 we assume an anticipative driver behavior , i.e. a reaction to the traffic situation at the advanced `` interaction point '' @xmath30 .",
    "a reasonable formula is @xmath31 , where @xmath32 is the maximum vehicle density in lane @xmath16 , @xmath33 is the safe time headway of vehicles of type @xmath10 , and @xmath34 is the safety distance at an average velocity of @xmath35 in lane @xmath16 . for @xmath36 ,",
    "the vehicles react to the traffic situation at the safe vehicle distance , for @xmath37 , they look further ahead .",
    "the anticipation factor @xmath38 is typically between 1.0 and 3.0 @xcite .",
    "now , let us denote by @xmath39 the probability that a vehicle of type @xmath10 in lane @xmath16 can change lane without any delay .",
    "evidently , this probability equals the sum of probabilities of changing to the right lane @xmath40 or to the left lane @xmath41 : @xmath42 .",
    "we assume these probabilities to be functions of the macroscopic variables such as vehicle densities . in terms of the interaction rates",
    ", we can now specify the rate of braking interactions by @xmath43 \\;,\\ ] ] and the lane - changing term due to interactions by @xmath44 \\ , .\\end{aligned}\\ ] ]    the rates of spontaneous lane - changes are simply proportional to the phase - space densities of vehicles .",
    "the proportionality factors are determined by the transition rates @xmath45 of this process , where @xmath46 are the characteristic times between lane changes .",
    "we will assume that they are functions of the macroscopic variables like the densities .",
    "thus , the spontaneous lane - changing terms have the form : @xmath47 an appropriate specification of the transition rates is the following : @xmath48 this form is rather simple and , at the same time , it is in accordance with empirical data @xcite .",
    "the results displayed in this paper are for @xmath49 and @xmath50 .",
    "the form of the mandatory lane - changing term depends on many different factors including visibility or the location of traffic signs indicating the end of a lane .",
    "an explicit example will be given in section iv .",
    "one advantage of the kinetic equation is , that it allows the systematic derivation of equations for _ macroscopic _ variables .",
    "the macroscopic variables of interest are the densities @xmath51 , average velocities @xmath52 , and velocity variances @xmath53 of vehicles of type @xmath10 in lane @xmath16 at place @xmath1 and time @xmath4 .",
    "they can be defined as moments of the phase - space densities : @xmath54    one can obtain the macroscopic equations from the kinetic equation , using an iterative procedure , called chapman - enskog expansion @xcite .",
    "the first step of this procedure gives the so - called euler - like traffic equations , which are in good agreement with empirical findings @xcite . to obtain these",
    ", one assumes the velocity distribution in every point @xmath1 to be in a local equilibrium . although the exact equilibrium solution of the kinetic traffic equations is not known , the gaussian distribution of velocities is a good approximation @xcite .",
    "next , recall that we need to specify the form of the pair distribution function of interacting vehicles .",
    "previous models @xcite assumed the pair distribution function to be a product of gaussian one - vehicle distribution functions , which corresponds to the `` vehicular chaos '' assumption that interacting vehicles are uncorrelated . here",
    ", we only presuppose that the pair distribution function can be approximated by a general bivariate gaussian distribution function : @xmath55 where @xmath56 is a general positive definite quadratic form and @xmath57 the determinant of the corresponding symmetrical matrix .",
    "thus , we take into account possible correlations between the velocities of interacting vehicles",
    ". one can express the coefficients of @xmath56 in terms of the moments of the distribution , namely the variances @xmath58 and the correlation coefficient @xmath59 : @xmath60 the associated determinant equals @xmath61    \\right\\}^{-1 } \\ , .\\ ] ] a prime indicates that the respective quantity is evaluated at the advanced interaction point @xmath62 rather than the actual position @xmath1 .    in order to evaluate the macroscopic equations , one needs to multiply the kinetic equation by @xmath63 , integrate over the velocity @xmath2 , and close the system of equations by a suitable approximation for the moments of higher order @xcite .",
    "we will derive the euler - like equations for the vehicle densities and average velocities , and close the system by approximations for the variances and correlation coefficients .",
    "the details of the calculation are given in the appendix , here we present only the final results .",
    "the density equations are @xmath64 \\nonumber \\\\    & & + \\sum_{j\\in\\{i-1,i+1\\ } } \\left (      \\frac{\\rho_j^a}{t_{j , i}^a }   - \\frac{\\rho_i^a}{t_{i , j}^a }     \\right ) \\",
    ", , \\label{eq_den } \\end{aligned}\\ ] ] and the equations for the traffic flows read : @xmath65 \\nonumber \\\\    & = &    \\frac{\\rho_i^a}{\\tau_i^a}(v_{0i}^a - v_i^a )    - ( 1-p_i^a ) \\sum_{b=1}^a b_i^{ab}(\\delta v_i^{ab } ) \\nonumber \\\\    & & + \\sum_{j\\in\\{i-1,i+1\\}}\\sum_{b=1}^a    \\big [      p_{j , i}^a c_j^{ab}(\\delta v_j^{ab } ) -       p_{i , j}^a c_i^{ab}(\\delta v_i^{ab } )    \\big ] \\nonumber \\\\    & & + \\sum_{j\\in\\{i-1,i+1\\ } } \\left (      \\frac{\\rho_j^a v_j^a}{t_{j , i}^a }   - \\frac{\\rho_i^a v_i^a}{t_{i , j}^a }     \\right ) .",
    "\\label{eq_flux } \\end{aligned}\\ ] ] one can obtain the corresponding velocity equations by inserting ( [ eq_den ] ) into  ( [ eq_flux ] ) .",
    "however , we will use the flux equations  ( [ eq_flux ] ) instead , because they are more suitable for numerical integration methods .",
    "the functions @xmath66 , @xmath67 , and @xmath68 in the above equations are denoted as _ boltzmann factors _ , since they originate from the boltzmann - like interaction integrals  ( [ eq_intrate1 ] ) and ( [ eq_intrate2 ] ) .",
    "thus they describe the influence of interactions on traffic dynamics . the boltzmann factors @xmath66 determine the lane - changing flows due to interactions in the density equations , @xmath67 the braking term , and @xmath68 the lane - changing terms due to interactions in the flow equations .",
    "the exact form of these terms is as follows ( for brevity we omit indices of lanes and vehicle types ) : @xmath69 \\ , , \\label{eq - boltz1}\\\\    b(\\delta v ) & = & \\chi(\\rho)\\rho\\rho 's     \\left [      \\delta v { n}(\\delta v ) + ( 1+\\delta v^2 ) { e}(\\delta v )     \\right ] \\ , , \\label{eq - boltz2}\\\\    c(\\delta v ) & = & \\chi(\\rho)\\rho\\rho 's \\left [      \\frac{v}{\\sqrt{s } } { n}(\\delta v ) +      \\left (        \\frac{\\theta - k\\sqrt{\\theta\\theta'}}{s}+\\frac{v}{\\sqrt{s } } \\ , \\delta v      \\right )      { e}(\\delta v ) \\right ] \\ , .",
    "\\label{eq - boltz3 } \\end{aligned}\\ ] ] here , @xmath70 is the standard gaussian distribution , and @xmath71 denotes the error function : @xmath72 the values @xmath73 are dimensionless velocity differences between interacting vehicles , which are defined by @xmath74 where @xmath75 the boltzmann factors are negligible for negative velocity differences , and they grow rapidly with increasing positive differences .",
    "the reason for this is rather intuitive : faster vehicles in front do not influence vehicles at the given place @xmath1 , while slower vehicles force them to brake or change lane .",
    "the dimensionless values  ( [ eq - veldiff ] ) have the meaning of `` effective '' velocity differences .",
    "according to their definition , they increase with    * the increase of the absolute velocity difference , * the decrease of the variance , and * the increase of the correlation coefficient .",
    "the last two properties require some explanation .",
    "the increase of the variance as well as the decrease of the correlation coefficient both lead to an increase of the factor @xmath76 .",
    "this results in the decrease of the effective velocity difference and , consequently , of the dimensionless parts of the boltzmann terms ( standing in square brackets ) .",
    "nevertheless , the boltzmann factors themselves increase ( see fig .",
    "[ fig - bfactor ] , which shows the dependence of boltzmann factor @xmath77 on the absolute velocity difference for different values of @xmath76 ) .",
    "this effect has a clear interpretation : the dimensionless parts of the boltzmann factors describe the influence of the _ difference in the average velocities _ at location @xmath1 and the advanced interaction point @xmath78 on the number of interactions .",
    "an increase of @xmath76 reduces the effect of this difference in comparison with the high _ variation of individual velocities _ in the vehicle flow .",
    "thus , the increase of @xmath76 diminishes the value of the effective velocity difference @xmath79 , although it enlarges the interaction rates .",
    "one could also say : an increase of @xmath76 causes higher interaction rates , but also a wider transition region between the limiting cases @xmath80 and @xmath81 .    for the variances @xmath58",
    ", we use constitutive relations of the form @xmath82 according to which the variance of vehicle velocities is a certain proportion @xmath83 of the squared average velocity , which depends on the total vehicle density @xmath84 in the respective lane @xmath16 .",
    "this is well justified by empirical findings .",
    "the appropriate expression of the functions @xmath85 is given below .",
    "the correlation coefficients could be approximated as functions of the densities at the points @xmath1 and @xmath26 , as well as the distance @xmath86 : @xmath87 .",
    "however , an empirical determination of this function is very difficult , as it requires a thorough analysis of a huge amount of single - vehicle data .",
    "therefore , we will apply the common approximation @xmath88 for the time being .",
    "another important function to be estimated is the `` effective cross section '' @xmath23 .",
    "this value reflects the increase of the effective number of interactions in dense traffic .",
    "in a previous publication on the single - lane variant of the above model  @xcite , it was shown that the following expression for the effective cross section is consistent with the limiting cases at high and low vehicle densities and well justified by the resulting properties of the model : @xmath89\\chi(\\rho ) = \\frac{v_0 t^2}{\\tau\\alpha(\\rho_{max } ) } \\frac{\\rho}{(1-\\rho/\\rho_{max})^2 } \\ , .\\ ] ] note that , without further assumptions , @xmath90 is determined in the single - lane model only together with the overtaking probability @xmath91 .",
    "in our multi - lane model , we suggest the following decomposition of the above expression : @xmath92 @xmath93 here , variables without an index for the specific vehicle type @xmath10 represent weighted averages of the variables belonging to the different vehicle types in lane @xmath16 , for example , @xmath94",
    "next , we present the results of calibration and simulation for a special case of the general model discussed above .",
    "we consider the two - lane variant of the model for a single vehicle type , where @xmath95 represents the right ( `` slow '' ) lane and @xmath96 the left ( `` fast '' ) lane .",
    "the calibration was done on the basis of empirical data for the dutch two - lane highway a9 .",
    "the variance prefactor or `` structure factor '' @xmath97 can be estimated on the basis of direct observation .",
    "the empirical data show a `` step - like '' but smooth dependence of this prefactor on density , with an increase at about 40 vehicles per kilometer .",
    "it can be well fitted by the following function ( see fig .",
    "[ fig - fitvar ] ) : @xmath98^{-1 } \\ , .",
    "\\label{eq - step}\\ ] ] this step - like form plays an important role , as it determines the specific shape of the equilibrium velocity - density relation @xmath99 ( see fig .",
    "[ fig - fitvel ] ) and the fundamental diagram @xmath100 .",
    "other parameters that influence the fundamental diagram are the safe time headway @xmath101 , the desired velocity @xmath102 , and the maximum density @xmath32 .",
    "the desired velocity fits the maximum velocity in free traffic , whereas the safe time headway and the maximum density determine the slope of the fundamental diagram at high densities and its intersection point with the density axis .",
    "the acceleration relaxation times @xmath103 and the anticipation factors @xmath104 do not influence the fundamental diagram . instead , they allow to fit the stability behavior and dynamics of traffic flow  @xcite .",
    "the parameters that affect lane - changing processes are the coefficients @xmath105 , @xmath106 , and @xmath107 for the spontaneous lane - changing rates , and the coefficients @xmath108 for the overtaking probabilities .",
    "the main sources for estimating these parameters are empirical data on lane occupancies and lane - changing rates as a function of density .",
    "one can easily obtain the data on lane occupancies from the usual measurements made by induction loops .",
    "in contrast , the direct measurement of lane - changing events is much more difficult , which results in a lack of reliable data in the literature @xcite .",
    "luckily , this kind of data is only necessary for the estimation of the order of magnitude of the model coefficients , while the ratios of the coefficients for different lanes , which essentially define the multi - lane dynamics , can be well estimated by the available lane occupancy data .",
    "figures  [ fig - dendiff ] through [ fig - lcrate ] show the corresponding fits . following ref .",
    "@xcite , we assume that the maximum lane changing rate of about 500 to 550 events per hour , kilometer and lane is achieved at densities of about 20 to 25 vehicles per kilometer .",
    "the higher occupancy of the left lane at middle and high densities yields higher estimated values of the coefficients @xmath105 , @xmath108 for the left lane relative to those for the right lane .",
    "the primary use of the right lane at small densities ( see fig .  [ fig - dendiff ] ) reflects the european traffic regulations .",
    "one can take this into account by a `` european - rules '' correction prefactor of the spontaneous coefficients : @xmath109 , where @xmath110 is a smooth step - like function similar to  ( [ eq - step ] ) .",
    "the calibration results show that the spontaneous lane - changing terms influence mainly the low - density regime , while the lane changes due to interactions , which are negligible at small densities , determine the difference in lane occupancy at high densities . for the typical fit of the lane occupancy curves ( see fig .",
    "[ fig - fitoccup ] ) it turned out that the overall contributions of spontaneous and interactive lane - changing terms to the total lane - changing rate were approximately the same ( fig .  [ fig - lcrate ] ) .",
    "note that , at low densities , lane changes correspond mainly to interactive lane changes from the right to the left lane and to spontaneous lane changes from the left to the right lane , which is plausible for european traffic .",
    "the results of the parameter estimation are summarized in table  [ tab - fit ] .",
    "one important property of the above model is the ability to describe the development of different congested traffic states @xcite .",
    "figure  [ fig - sng ] shows the development of stop - and - go traffic , which arises from a small density perturbation in the right lane .",
    "due to lane changes , the perturbation spreads to the other lane , and the traffic dynamics on the neighboring lanes becomes synchronized @xcite .",
    "in particular , this holds for the propagation of large density clusters .",
    "nevertheless , the traffic flow in the left lane behaves more unstable in the range of moderate densities .",
    "this fact is in agreement with observations and can be theoretically explained by the different velocity - density relations ( decreasing more rapidly for the left lane , see fig .  [ fig - fitvel ] ) .",
    "next , we present multi - lane simulations of the interesting case of a bottleneck , corresponding to an on - ramp , a lane closure , or an accident . assume , for example , that the right lane ends at certain place @xmath111 .",
    "we expect that the resulting traffic situation will depend on the volume of the incoming flow .    in order to model the behavior of traffic close to a bottleneck",
    ", we must specify the mandatory lane changes . in the framework of the above multi - lane model ,",
    "this can be done by introduction of additional lane - changing terms describing a sufficient increase of lane changes to the left lane , whereas lane changes to the right lane will be surpressed by setting the corresponding coefficients close to the bottleneck to zero .",
    "however , the following difficulty arises : while the density on the right lane decreases to zero at the bottleneck , the velocity ( which depends on the density and velocity on the neighboring lane ) can stay large up to the very end of the lane .",
    "this causes numerical problems in keeping the density and flow positive everywere . to avoid this",
    ", we apply the following calculation procedure to the last section of the right lane in front of the bottleneck , where we have assumed that this section is of length @xmath112 m throughout this paper .    close to the bottleneck",
    ", all drivers in the right lane ( producing a traffic flow of volume @xmath113 ) must merge into the adjacent lane .",
    "this implies that the drivers in the right lane will adopt their velocity @xmath114 to the velocity @xmath115 in the left lane .",
    "in addition , we will assume that the lane - changing rate grows inversely proportional to the remaining distance @xmath116 , in order to guarantee that all vehicles have changed lane at the place @xmath111 where the right lane ends .",
    "hence , for @xmath117 $ ] , our model for the right lane reads : @xmath118 @xmath119 for the left lane , we have : @xmath120 in order to describe a smooth transition from the `` normal '' to this `` adaptive '' behaviour in the merging zone , we evaluate the rhs of the equation according to @xmath121 { \\rm rhs}_{\\rm norm } + k(x ) { \\rm rhs}_{\\rm adapt } \\",
    ", , \\ ] ] where @xmath122 is a smooth step - like function similar to  ( [ eq - step ] ) with @xmath123 and @xmath124 .",
    "the results of our simulations are presented in figures  [ fig - lc10 ] through [ fig - lc15 ] .",
    "the traffic dynamics is essentially characterized by the volume of approaching traffic and the capacity of the bottleneck ( which is given by the outflow from traffic jams in the left lane ) . at low upstream densities ( see fig .",
    "[ fig - lc10 ] ) , the capacity of the left lane is sufficient to transport the vehicle flow from both lanes .",
    "in contrast , we have an immediate formation of congested traffic upstream of the bottleneck , if the total traffic volume in both lanes exceeds the capacity of the left lane ( cf . fig .  [ fig - lc25 ] ) .",
    "surprisingly , for a certain range of moderate densities , the resulting traffic situation turns out to depend on the initial condition . while a perfectly homogenous flow will lead to an increased but free traffic flow downstream of the bottleneck , as for small traffic volumes",
    ", a small perturbation can trigger the breakdown of traffic flow , although the left lane could carry the total vehicle flow in both lanes ( cf .",
    "[ fig - lc15 ] ) .",
    "this can happen , when the traffic flow downstream of the bottleneck is unstable .",
    "as long as the perturbation is small , it moves downstream .",
    "however , when its amplitude becomes larger , it eventually changes its propagation speed and finally travels upstream , until it reaches the bottleneck .",
    "then , traffic breaks down , and a steadily growing region of congested traffic develops upstream of the bottleneck , whereas traffic downstream of the bottleneck flows freely ( fig .",
    "[ fig - lc15 ] ) .",
    "a similar phase transition from free to congested traffic is known to occur close to on - ramps @xcite .",
    "the traffic situations discussed above can be also simulated with an `` effective '' single - lane model that implicitly averages over the dynamics of all lanes .",
    "the corresponding model was proposed in @xcite and basically corresponds to our multi - lane model , applied to one lane only , so that the lane changing terms drop out . for our simulations , we use the following `` effective '' model parameters : @xmath125 km/h , @xmath126vehicles / km , @xmath127s , @xmath128s , @xmath129 , @xmath130 , @xmath131 , @xmath132 , and @xmath133 . in figure",
    "[ added ] , we compare the average of the densities in the left and the right lane according to the multi - lane model ( see fig .",
    "[ fig - sng ] ) with the effective single - lane model .",
    "it turns out that , despite of the sensitive dynamics in the unstable traffic regime , both models produce similar spatio - temporal traffic patterns , but there are some differences in detail .",
    "this shows that the effective single - lane model gives already a reasonable representation of the traffic dynamics , although it produces small deviations from the dynamics predicted by the multi - lane model .",
    "let us make a similar investigation for the example of a bottleneck . in this case",
    ", we can treat the merging lanes in the effective single - lane model by a reduction of the effective lane number @xmath134 from 2 to 1 within the merging section , i.e. for @xmath135 $ ] .",
    "for example , we may use the linear relation @xmath136 $ ] .",
    "the conservation of the number of vehicles implies the virtual ramp flow @xmath137 , which gives the following continuity equation for the effective vehicle density per available lane : @xmath138 the result of the corresponding simulation is presented in figure  [ fig - single ] in comparison with the plot of the average density per lane obtained with the multi - lane model .",
    "the pictures show a good correspondence between the multi - lane and the effective single - lane models . however , there are slight differences in the form and propagation velocity of the upstream front of the congested traffic region .",
    "these originate from the fact that the average dynamics of two nonlinearly behaving systems with different parameters can not simply be represented by one system of the same type with suitably averaged parameters , as it can be done for linear systems .",
    "we have proposed a gas - kinetic traffic model for heterogeneous multi - lane traffic and systematically derived the corresponding macroscopic traffic model .",
    "thus , effects of different vehicle types and lane changes are explicitly taken into account .",
    "whereas previous multi - lane models have usually assumed spontaneous lane changes only , we managed to calculate the lane - changing rates due to vehicle interactions and found that these are of the same order of magnitude .",
    "note that both , spontaneous and interactive lane changes are necessary to describe the empirically observed density - dependence of the total lane changing rates , the lane occupancies , and the density difference among lanes correctly .",
    "moreover , the multi - lane traffic model formulated above treats vehicular space requirements and high vehicle densities in the right way , and we have even discussed possible effects of velocity correlations of interacting cars , which basically reduce the interaction rates .",
    "the corresponding computer simulations are robust also in the unstable traffic regime , so that we did not need to eliminate the dynamic velocity equation , as was done in a previous study .",
    "we have successfully calibrated our model to empirical traffic data .",
    "the resulting model is in good agreement with the observed variance - density relations , the velocity - density relations , and the occupancies of the different lanes , as well as with the density - dependence of the lane - changing rates and the density difference among lanes .",
    "we were able to show the synchronization effect among lanes due to lane changes and could describe the traffic dynamics at bottlenecks .",
    "a comparison of the average dynamics in the different lanes with corresponding simulation results of an effective single - lane model showed a qualitative , but not fully quantitative agreement .",
    "our present investigations focus on the empirical evaluation of velocity correlations between interacting vehicles and on the calibration of the model to a mixture of vehicle types like cars and trucks , both of which are difficult tasks .",
    "we expect that this will allow us to describe the effects of heterogeneous traffic which were found in microscopic models @xcite and other approaches @xcite .",
    "the authors want to thank for financial support by the bmbf ( research project sandy , grant no .",
    "13n7092 ) and by the dfg ( heisenberg scholarship he 2789/1 - 1 ) .",
    "they are also grateful to henk taale and the dutch _ ministry of transport , public works and water management _ for supplying the freeway data .      in order to evaluate the macroscopic equations",
    ", one needs to calculate the first two moments of the kinetic equation in velocity space .",
    "this procedure was described in details in  @xcite .",
    "the new contribution of this paper consists in evaluating the general boltzmann factors  ( [ eq - boltz1 ] ) through ( [ eq - boltz3 ] ) including vehicular space requirements and possible velocity correlations of successive vehicles .",
    "the boltzmann factors are defined by the following integrals of interaction rates : @xmath139    here , we present the evaluation of the integrals of @xmath140 only , but the integration of @xmath141 is analogous . for brevity , we will omit the indices of lane and vehicle types in the following .",
    "this means that the pair distribution function @xmath142 actually denotes the pair distribution function @xmath25 for particular types of vehicles @xmath10 at point @xmath1 and @xmath17 at @xmath143 in a particular lane @xmath16 .",
    "consequently , @xmath144 , @xmath145 stand for @xmath146 , @xmath147 , and @xmath148 , @xmath149 stand for @xmath150 , @xmath151 .",
    "also , we drop the multipliers @xmath152 . according to the definition of interaction rates  ( [ eq_intrate1 ] )",
    ", one must evaluate the integrals @xmath153 for @xmath154 .    from the mathematical perspective",
    ", the task is to integrate a bivariate gaussian distribution , multiplied by polynomials in @xmath2 and @xmath27 , over the half - plane @xmath155 .",
    "this can be done by linear transformations in the @xmath156-plane in three steps :    * transform the bivariate distribution to the canonical rotation - symmetric form , * rotate the plane to make the boundary of the integration area parallel to one of the coordinate axes , and * separate variables .",
    "the bivariate gaussian distribution @xmath157 is defined by  ( [ eq - bivar1 ] ) and ( [ eq - bivar2 ] ) .",
    "one can transform the quadratic function  ( [ eq - bivar2 ] ) to the simplest symmetric form @xmath158 by linear transformation : @xmath159 here , @xmath160 are ( positive ) eigenvalues of the quadratic form  ( [ eq - bivar2 ] ) : @xmath161 and the angle @xmath162 is defined by @xmath163 after this transformation , we obtain @xmath164 for the pair distribution function , and the boundary of the integration area becomes @xmath165 next , we apply additional rotation , which does not change the symmetric form of the distribution , and make the boundary of integration area parallel to one of the axes , say @xmath166 .",
    "this is done by @xmath167 where @xmath168 @xmath169 finally , we consider the composition of two linear transformations : @xmath170 .",
    "this transformation brings the integral  ( [ eq - integral ] ) into the form with separating variables : @xmath171 the integration over @xmath166 becomes trivial , now , as it corresponds to evaluating the moments of a normal distribution .",
    "the evaluation for @xmath154 involves only the first two moments , which equal to @xmath172 and @xmath173 , hence the integration over @xmath166 in those cases results just in the elimination of the integral over @xmath166 and @xmath166-containing terms from the expression above .",
    "the remaining task is to evaluate the `` incomplete moments '' of the normal distribution , which can be expressed through the normal distributions @xmath179 and error functions @xmath180 ( see notations  ( [ eq - norm ] ) and ( [ eq - error ] ) ) . applying the formulas @xmath181 to the integral above , one obtains the desired expressions  ( [ eq - boltz1 ] ) through ( [ eq - boltz3 ] ) for the boltzmann factors .",
    "y. makigami , t. nakanishi , m. toyama , and r. mizote ( 1983 ) in : v. f. hurdle , e. hauer and g. n. stewart , eds .",
    "_ proceedings of the 8th international symposium on transportation and traffic theory _ ( university of toronto press , toronto , ontario ) .",
    "u. sparmann , ed .",
    "spurwechselvorgnge auf zweispurigen bab - richtungsfahrbahnen _ vol .",
    "263 of _ forschung straenbau und straenverkehrstechnik_. ( bundesministerium fr verkehr , abt .",
    "straenbau , bonn - bad godesberg , 1978 ) .",
    "fit of the density - depenent variance prefactor or `` structure factor '' @xmath182 specified in eq .",
    "( [ eq - step ] ) (  ) to the empirical data of the relative velocity variance @xmath183 ( + , @xmath184 ) .",
    "the corresponding parameter values are listed in table  [ tab - fit ] .",
    "note that the deviation of the fit curve for the right lane from the empirical data at small densities is probably a consequence of assuming one vehicle type only instead of heterogeneous traffic .",
    "however , this deviation is of minor importance for the dynamic properties of the model , since it is limited to the stable density regime of free traffic flow.,scaledwidth=50.0% ]     equilibrium velocity - density relations of the multi - lane model (  ) for the parameter values specified in table  [ tab - fit ] in comparison with empirical data from the dutch highway a9 ( + , @xmath184 ) .",
    "the symbols represent the ( vertical ) averages of one - minute data that were evaluated for 14 successive days.,scaledwidth=50.0% ]       fit of the lane occupancy , i.e. of the percentage of the vehicle density in a lane compared to the total density in all lanes .",
    "symbols correspond to empirical data , lines to the results of our multi - lane model .",
    "the preference for the right lane at small densities comes from the european traffic regulations . , scaledwidth=50.0% ]     equilibrium lane - changing rates according to our multi - lane model as a function of the average density . note that , at small densities , we have more interactive lane changes from the right to the left lane ( `` overtaking maneuvers '' ) and more spontaneous lane changes from the left to the right lane , as expected for europe.,scaledwidth=50.0% ]     ( a)+(b ) : simulation of stop - and - go traffic on a circular road in the regime of unstable traffic flow , arising from an initial density perturbation in the right lane , which eventually spreads to the left lane . ( c)+(d ) : the lane - changing rates have temporary peaks at the locations , where the traffic situation in the neighboring lanes evolves differently .",
    "this tends to reduce the differences among lanes , so that similar spatio - temporal traffic patterns form in both lanes .",
    "consequently , we have a synchronization of lanes at medium and high vehicle densities.,title=\"fig:\",width=294 ]   ( a)+(b ) : simulation of stop - and - go traffic on a circular road in the regime of unstable traffic flow , arising from an initial density perturbation in the right lane , which eventually spreads to the left lane .",
    "( c)+(d ) : the lane - changing rates have temporary peaks at the locations , where the traffic situation in the neighboring lanes evolves differently .",
    "this tends to reduce the differences among lanes , so that similar spatio - temporal traffic patterns form in both lanes .",
    "consequently , we have a synchronization of lanes at medium and high vehicle densities.,title=\"fig:\",width=294 ]   ( a)+(b ) : simulation of stop - and - go traffic on a circular road in the regime of unstable traffic flow , arising from an initial density perturbation in the right lane , which eventually spreads to the left lane .",
    "( c)+(d ) : the lane - changing rates have temporary peaks at the locations , where the traffic situation in the neighboring lanes evolves differently .",
    "this tends to reduce the differences among lanes , so that similar spatio - temporal traffic patterns form in both lanes .",
    "consequently , we have a synchronization of lanes at medium and high vehicle densities.,title=\"fig:\",width=294 ]   ( a)+(b ) : simulation of stop - and - go traffic on a circular road in the regime of unstable traffic flow , arising from an initial density perturbation in the right lane , which eventually spreads to the left lane .",
    "( c)+(d ) : the lane - changing rates have temporary peaks at the locations , where the traffic situation in the neighboring lanes evolves differently .",
    "this tends to reduce the differences among lanes , so that similar spatio - temporal traffic patterns form in both lanes .",
    "consequently , we have a synchronization of lanes at medium and high vehicle densities.,title=\"fig:\",width=294 ]     simulation of a closure of the right lane for @xmath185 km at time @xmath186min . at a density of @xmath187 vehicles per kilometer and lane or lower ( here :",
    "@xmath188vehicles / km ) , the capacity of the left lane is large enough to transport the vehicle flow from both lanes , resulting in a higher vehicle density in the left lane downstream of the bottleneck , whereas the right lane is empty behind the lane closure.,title=\"fig:\",width=294 ]   simulation of a closure of the right lane for @xmath185 km at time @xmath186min . at a density of @xmath187 vehicles per kilometer and lane or lower ( here :",
    "@xmath188vehicles / km ) , the capacity of the left lane is large enough to transport the vehicle flow from both lanes , resulting in a higher vehicle density in the left lane downstream of the bottleneck , whereas the right lane is empty behind the lane closure.,title=\"fig:\",width=294 ]     ( a)+(b ) : closure of the right lane as in figure  [ fig - lc10 ] , but for an average initial density of @xmath189 vehicles per kilometer and lane . behind the bottleneck , a growing region of congested traffic forms immediately , since the capacity of the left lane is exceeded by the traffic volume in both lanes .",
    "( c ) note that the effective capacity of the left lane ( i.e. of the bottleneck ) is considerably less than the maximum flow and the flow in the left lane upstream of the jam .",
    "this is , because the outflow from congested traffic is a self - organized quantity @xcite , which is of the order of 2000 vehicles per hour , here .",
    "the flow per lane in the jammed region is half of this characteristic outflow .",
    "( d ) the step - like structure of congested traffic corresponding to regions of two different densities in ( a ) and ( b ) is related to a deceleration in two steps ( rough braking and fine braking ) , when approaching a traffic jam from free traffic .",
    "this behavior has been also observed in a microscopic traffic model @xcite . according to an explanation by ansgar hennecke",
    ", it relates to the pronounced hump of the fundamental diagram in the density region between 20 and 50 vehicles per kilometer . where the traffic flow is stable ( at densities around 60 vehicles per kilometer and higher ) , the flow - density relation tends to stay close to the fundamental diagram ( i.e. the _ equilibrium _ flow - density relation ) .",
    "in contrast , the dynamic flow - density relation is a self - organized relation in the density regime of unstable traffic flow ( at densities between about 25 and 55 vehicles per kilometer ) , connecting the stable flow with the self - organized outflow from traffic jams .",
    "hence , we will usually have different slopes in the resulting dynamic flow - density relation , corresponding to the propagation of congested regimes of different densities with different speeds .",
    "this behavior disappears for smoother fundamental diagrams , in which the congested part decreases more or less linearly.,title=\"fig:\",width=294 ]   ( a)+(b ) : closure of the right lane as in figure  [ fig - lc10 ] , but for an average initial density of @xmath189 vehicles per kilometer and lane . behind the bottleneck , a growing region of congested traffic forms immediately , since the capacity of the left lane",
    "is exceeded by the traffic volume in both lanes .",
    "( c ) note that the effective capacity of the left lane ( i.e. of the bottleneck ) is considerably less than the maximum flow and the flow in the left lane upstream of the jam .",
    "this is , because the outflow from congested traffic is a self - organized quantity @xcite , which is of the order of 2000 vehicles per hour , here .",
    "the flow per lane in the jammed region is half of this characteristic outflow .",
    "( d ) the step - like structure of congested traffic corresponding to regions of two different densities in ( a ) and ( b ) is related to a deceleration in two steps ( rough braking and fine braking ) , when approaching a traffic jam from free traffic .",
    "this behavior has been also observed in a microscopic traffic model @xcite . according to an explanation by ansgar hennecke",
    ", it relates to the pronounced hump of the fundamental diagram in the density region between 20 and 50 vehicles per kilometer . where the traffic flow is stable ( at densities around 60 vehicles per kilometer and higher ) , the flow - density relation tends to stay close to the fundamental diagram ( i.e. the _ equilibrium _ flow - density relation ) .",
    "in contrast , the dynamic flow - density relation is a self - organized relation in the density regime of unstable traffic flow ( at densities between about 25 and 55 vehicles per kilometer ) , connecting the stable flow with the self - organized outflow from traffic jams .",
    "hence , we will usually have different slopes in the resulting dynamic flow - density relation , corresponding to the propagation of congested regimes of different densities with different speeds .",
    "this behavior disappears for smoother fundamental diagrams , in which the congested part decreases more or less linearly.,title=\"fig:\",width=294 ]   ( a)+(b ) : closure of the right lane as in figure  [ fig - lc10 ] , but for an average initial density of @xmath189 vehicles per kilometer and lane . behind the bottleneck , a growing region of congested traffic forms immediately , since the capacity of the left lane is exceeded by the traffic volume in both lanes .",
    "( c ) note that the effective capacity of the left lane ( i.e. of the bottleneck ) is considerably less than the maximum flow and the flow in the left lane upstream of the jam .",
    "this is , because the outflow from congested traffic is a self - organized quantity @xcite , which is of the order of 2000 vehicles per hour , here .",
    "the flow per lane in the jammed region is half of this characteristic outflow .",
    "( d ) the step - like structure of congested traffic corresponding to regions of two different densities in ( a ) and ( b ) is related to a deceleration in two steps ( rough braking and fine braking ) , when approaching a traffic jam from free traffic .",
    "this behavior has been also observed in a microscopic traffic model @xcite . according to an explanation by ansgar hennecke",
    ", it relates to the pronounced hump of the fundamental diagram in the density region between 20 and 50 vehicles per kilometer .",
    "where the traffic flow is stable ( at densities around 60 vehicles per kilometer and higher ) , the flow - density relation tends to stay close to the fundamental diagram ( i.e. the _ equilibrium _ flow - density relation ) .",
    "in contrast , the dynamic flow - density relation is a self - organized relation in the density regime of unstable traffic flow ( at densities between about 25 and 55 vehicles per kilometer ) , connecting the stable flow with the self - organized outflow from traffic jams .",
    "hence , we will usually have different slopes in the resulting dynamic flow - density relation , corresponding to the propagation of congested regimes of different densities with different speeds .",
    "this behavior disappears for smoother fundamental diagrams , in which the congested part decreases more or less linearly.,title=\"fig:\",width=279 ]   ( a)+(b ) : closure of the right lane as in figure  [ fig - lc10 ] , but for an average initial density of @xmath189 vehicles per kilometer and lane . behind the bottleneck , a growing region of congested traffic forms immediately , since the capacity of the left lane",
    "is exceeded by the traffic volume in both lanes .",
    "( c ) note that the effective capacity of the left lane ( i.e. of the bottleneck ) is considerably less than the maximum flow and the flow in the left lane upstream of the jam .",
    "this is , because the outflow from congested traffic is a self - organized quantity @xcite , which is of the order of 2000 vehicles per hour , here .",
    "the flow per lane in the jammed region is half of this characteristic outflow .",
    "( d ) the step - like structure of congested traffic corresponding to regions of two different densities in ( a ) and ( b ) is related to a deceleration in two steps ( rough braking and fine braking ) , when approaching a traffic jam from free traffic .",
    "this behavior has been also observed in a microscopic traffic model @xcite . according to an explanation by ansgar hennecke",
    ", it relates to the pronounced hump of the fundamental diagram in the density region between 20 and 50 vehicles per kilometer . where the traffic flow is stable ( at densities around 60 vehicles per kilometer and higher ) , the flow - density relation tends to stay close to the fundamental diagram ( i.e. the _ equilibrium _ flow - density relation ) .",
    "in contrast , the dynamic flow - density relation is a self - organized relation in the density regime of unstable traffic flow ( at densities between about 25 and 55 vehicles per kilometer ) , connecting the stable flow with the self - organized outflow from traffic jams .",
    "hence , we will usually have different slopes in the resulting dynamic flow - density relation , corresponding to the propagation of congested regimes of different densities with different speeds .",
    "this behavior disappears for smoother fundamental diagrams , in which the congested part decreases more or less linearly.,title=\"fig:\",width=279 ]     simulation of a closure of the right lane as in figure  [ fig - lc10 ] , with the same initial density of @xmath188 vehicles per kilometer and lane , but with a small perturbation of the traffic flow in the left lane .",
    "altough the total flow of 2590 vehicles per hour in both lanes is below the maximum possible flow in the left lane of 2630 vehicles per hour , traffic flow eventually breaks down .",
    "in other words : if all vehicles would use only the left lane , there would be no traffic congestion upstream of @xmath111 !",
    "the breakdown of traffic is initialized by a perturbation of traffic flow that eventually gives rise to a growing region of congested traffic @xcite , from which the self - organized outflow is only about 2000 vehicles per hour @xcite.,title=\"fig:\",width=294 ]   simulation of a closure of the right lane as in figure  [ fig - lc10 ] , with the same initial density of @xmath188 vehicles per kilometer and lane , but with a small perturbation of the traffic flow in the left lane .",
    "altough the total flow of 2590 vehicles per hour in both lanes is below the maximum possible flow in the left lane of 2630 vehicles per hour , traffic flow eventually breaks down .",
    "in other words : if all vehicles would use only the left lane , there would be no traffic congestion upstream of @xmath111 !",
    "the breakdown of traffic is initialized by a perturbation of traffic flow that eventually gives rise to a growing region of congested traffic @xcite , from which the self - organized outflow is only about 2000 vehicles per hour @xcite.,title=\"fig:\",width=294 ]     comparison of ( a ) the average density according to the multi - lane model and ( b ) the density resulting from an effective single - lane model for the formation of stop - and - go traffic presented in figure  [ fig - sng].,title=\"fig:\",width=294 ]   comparison of ( a ) the average density according to the multi - lane model and ( b ) the density resulting from an effective single - lane model for the formation of stop - and - go traffic presented in figure  [ fig - sng].,title=\"fig:\",width=294 ]     comparison of ( a ) the average density according to the multi - lane model and ( b ) the density resulting from an effective single - lane model for the case of a lane closure displayed in figure  [ fig - lc25].,title=\"fig:\",width=294 ]   comparison of ( a ) the average density according to the multi - lane model and ( b ) the density resulting from an effective single - lane model for the case of a lane closure displayed in figure  [ fig - lc25].,title=\"fig:\",width=294 ]"
  ],
  "abstract_text": [
    "<S> we present a macroscopic model of mixed multi - lane freeway traffic that can be easily calibrated to empirical traffic data , as is shown for dutch highway data . </S>",
    "<S> the model is derived from a gas - kinetic level of description , including effects of vehicular space requirements and velocity correlations between successive vehicles . </S>",
    "<S> we also give a derivation of the lane - changing rates . </S>",
    "<S> the resulting dynamic velocity equations contain non - local and anisotropic interaction terms which allow a robust and efficient numerical simulation of multi - lane traffic . as demonstrated by various examples , this facilitates the investigation of synchronization patterns among lanes and effects of on - ramps , off - ramps , lane closures , or accidents . </S>"
  ]
}