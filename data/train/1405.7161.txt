{
  "article_text": [
    "security is a vital issue in wireless networks due to the broadcast nature of the medium .",
    "traditionally , security has been achieved through cryptographic encryption implemented at the application layer .",
    "this approach is based on certain assumptions regarding computational complexity , and is thereby potentially vulnerable @xcite . as a complement to cryptographic methods",
    ", physical layer security has drawn significant research and industrial interest recently .",
    "the pioneering work on physical layer security in @xcite considered the classical three - terminal network consisting of a transmitter ( alice ) , an intended receiver ( bob ) , and an eavesdropper ( eve ) .",
    "it was shown in @xcite that a source - destination pair can exchange perfectly secure messages with a positive rate as long as the desired receiver enjoys better channel conditions than the eavesdropper(s ) .",
    "more recent studies have considered physical layer security provisioning in multi - antenna multiuser networks @xcite-@xcite .",
    "although the secrecy capacity region for multiuser networks remains an open problem , it is interesting to investigate the achievable secrecy rates of such networks for certain practical transmission strategies .",
    "eavesdroppers are typically passive so as to hide their existence , and thus their channel state information ( csi ) can not be obtained by alice @xcite . in this case",
    ", multiple transmit antennas can be exploited to enhance secrecy by simultaneously transmitting both the information - bearing signal and artificial noise ( an ) @xcite .",
    "specifically , precoding is used to make the an invisible to bob while degrading the decoding performance of possibly present eves @xcite-@xcite . for the case of imperfect channel estimation ,",
    "robust beamforming designs were reported in @xcite .",
    "recently , a new promising design approach for cellular networks , known as massive or large - scale multiple - input multiple - output ( mimo ) , has been proposed @xcite , where base station ( bs ) antenna arrays are equipped with an order of magnitude more elements than what is used in current systems , i.e. , a hundred antennas or more .",
    "massive mimo enjoys all the benefits of conventional multiuser mimo , such as improved data rate , reliability and reduced interference , but at a much larger scale and with simple linear precoding / detection schemes .",
    "in fact , massive mimo employing simple matched - filter precoding / combining enables large gains in bandwidth and/or power efficiency compared to conventional mimo systems @xcite as the effects of noise and interference vanish completely in the limit of an infinite number of antennas . furthermore , in time - division duplex ( tdd ) systems , channel reciprocity can be exploited to estimate the downlink channels via uplink training such that the resulting overhead scales linearly with the number of users but is independent of the number of bs antennas @xcite .",
    "however , if the pilot sequences employed in different cells are not orthogonal , so - called pilot contamination impairs the channel estimates and limits the achievable information rates in massive mimo systems @xcite .",
    "massive mimo systems offer an abundance of bs antennas , while multiple transmit antennas can be exploited for secrecy enhancement .",
    "therefore , the combination of both concepts seems natural and promising , which is the main motivation for the present work .",
    "however , several new issues arise for physical layer security provisioning in multi - cell massive mimo systems that are not present for conventional mimo systems @xcite-@xcite .",
    "for example , pilot contamination is unique to massive mimo systems and we study its effect on the ergodic secrecy rate and the secrecy outage probability .",
    "furthermore , for the user data , matched - filter precoding is usually adopted in massive mimo systems @xcite , since the matrix inversion needed for the schemes used in conventional mimo , such as regularized zero - forcing ( zf ) and minimum mean squared error ( mmse ) precoding , is considered to be computationally too expensive for the large matrices typical for massive mimo . similarly , whereas in conventional mimo systems the an is transmitted in the null space of the channel matrix @xcite , the complexity associated with computing the null space may not be affordable in case of massive mimo and simpler an shaping methods may be needed .",
    "finally , unlike most of the related work @xcite-@xcite , we consider a multi - cell setting where not only the data signals cause inter - cell interference but also the an , which has to be carefully taken into account for system design .    in this paper",
    ", we study secure downlink transmission in multi - cell massive mimo systems in the presence of a multi - antenna eavesdropper , which attempts to intercept the signal intended for one of the users .",
    "to arrive at an achievable secrecy rate for this user , we assume that the eavesdropper can acquire perfect knowledge of the channel state information ( csi ) of all user data channels and is able to cancel all interfering user signals . under this assumption , we derive tight lower bounds for the ergodic secrecy rate and tight upper bounds for the secrecy outage probability for the cases of perfect training and pilot contamination .",
    "the derived bounds are in closed form and provide significant insight for system design . in particular , the obtained results allow us to predict under what conditions ( i.e. , for what number of bs antennas , eavesdropper antennas , users , path - loss , number of cells , and pilot powers ) a positive secrecy rate is possible .",
    "furthermore , we show that employing random an shaping matrices is an attractive low - complexity option for massive mimo systems .",
    "we also derive a closed - form expression for the fraction of transmit power that should be optimally allocated to an and show that , for a given number of bs antennas , this fraction increases with the number of eavesdropper antennas and decreases with the number of users in the system .",
    "_ notations : _",
    "subscripts @xmath0 and @xmath1 stand for the transpose and the conjugate transpose , respectively .",
    "@xmath2 and @xmath3 denote the @xmath4-dimensional identity matrix and the all - zero column vector of length @xmath4 , respectively . the expectation operation , variance operation , and euclidean norm are denoted by @xmath5 $ ] , @xmath6 $ ] , and @xmath7 , respectively .",
    "@xmath8 represents the space of all @xmath9 matrices with complex - valued elements .",
    "furthermore , @xmath10 and @xmath11 denote an upper bound and a lower bound for @xmath12 , respectively , i.e. , @xmath13 .",
    "finally , we use @xmath14 to denote a circularly symmetric complex gaussian vector @xmath15 with zero mean and covariance matrix @xmath16 , and @xmath17 means that @xmath18 is a chi - square random variable with @xmath19 degrees of freedom .",
    "in this section , we introduce the channel model , the channel estimation scheme , the transmission format , and two an shaping matrix designs for the considered secure multi - cell massive mimo system . for convenience , the most important variables used in this paper are defined in table [ table1 ] .",
    "+    in this paper , we consider a flat - fading multi - cell system consisting of @xmath20 cells , as depicted in fig .",
    "[ figsys ] .",
    "each cell comprises an @xmath21-antenna bs and @xmath22 single - antenna mobile terminals ( mts ) .",
    "the @xmath23 cell , @xmath24 , is the local cell ( the shaded area in fig .",
    "[ figsys ] ) . an eavesdropper equipped with @xmath25 antennas ( equivalent to @xmath25 cooperative single - antenna eavesdroppers )",
    "is located in the local cell of the considered multi - cell region .",
    "the eavesdropper is passive and seeks to recover the information transmitted to the @xmath26 mt in the local cell .",
    "let @xmath27 and @xmath28 denote the channel between the @xmath29 bs , @xmath30 , and the @xmath26 mt in the local cell and the channel between the @xmath29 bs and the eavesdropper , respectively .",
    "@xmath31 comprises the path - loss , @xmath32 , and the small - scale fading vector , @xmath33 .",
    "similarly , we model the eavesdropper channel as @xmath34 , where @xmath35 and @xmath36 denote the path - loss and small - scale fading components , respectively .",
    "the elements of @xmath36 are modeled as independent and identically distributed ( i.i.d . )",
    "gaussian random variables ( r.v.s ) with zero mean and unit variance .",
    ".summary of most important variables used in this paper . [ cols= \" < , < \" , ]      in this paper , we assume that the bss are perfectly synchronized and operate in the tdd mode with universal frequency reuse .",
    "furthermore , we assume that the path - losses between all users in the system and the local bs , @xmath32 , @xmath30 , @xmath37 , are known at the local bs , whereas the small - scale fading vectors @xmath38 , @xmath30 , @xmath37 , are not known and the local bs estimates only the small - scale fading vectors of the mts within the local cell .",
    "these assumptions are motivated by the fact that the path - losses change on a much slower time scale than the small - scale fading vectors , and thus , their estimation creates a comparatively low overhead .",
    "the local bs estimates the downlink csi of all mts , @xmath39 , @xmath40 , by exploiting reverse training and channel reciprocity @xcite-@xcite .",
    "we consider two scenarios : perfect training and imperfect training which results in pilot contamination @xcite . in the former case ,",
    "all @xmath41 mts in the system emit orthogonal pilot sequences in the training phase having a sufficiently large pilot power @xmath42 such that @xmath43 , @xmath44 , can be assumed , where @xmath45 denotes the estimated channel in the local cell . in the latter case ,",
    "the @xmath22 pilot sequences used in a cell are still orthogonal but all cells use the same pilot sequences .",
    "let @xmath46 denote the pilot sequence of length @xmath47 transmitted by the @xmath26 mt in each cell in the training phase , where @xmath48 and @xmath49 , @xmath50 , @xmath51 .",
    "assuming perfect synchronization , the training signal received at the local bs , @xmath52 , can be expressed as @xmath53 where @xmath54 is a gaussian noise matrix having zero mean , unit variance elements .",
    "assuming mmse channel estimation @xcite , @xcite , the estimate of @xmath39 given @xmath55 is obtained as @xmath56 for mmse estimation , we can express the channel as @xmath57 , where the estimate @xmath58 and the estimation error @xmath59 are mutually independent .",
    "hence , considering ( [ est ] ) we can statistically characterize @xmath58 and @xmath60 as @xmath61 and @xmath62 , respectively .",
    "we note that in order to be able to find the required numbers of orthogonal pilot sequences , pilot sequence lengths of @xmath63 and @xmath64 are required for the cases of perfect training and pilot contamination , respectively .",
    "furthermore , we note that the eavesdropper could emit his own pilot symbols to impair the channel estimates obtained at the bs to improve his ability to decode the mts signals during downlink transmission @xcite",
    ". however , this would also increase the chance that the presence of the eavesdropper is detected by the bs @xcite .",
    "therefore , in this paper , we assume the eavesdropper is purely passive and leave the study of active eavesdroppers in massive mimo systems for future work .      in the local cell , the bs intends to transmit a confidential signal @xmath65 to the @xmath26 mt .",
    "the signal vector for the @xmath22 mts is denoted by @xmath66^t \\in \\mathbb{c}^{k \\times 1}$ ] with @xmath67={\\bf i}_k$ ] .",
    "each signal vector @xmath68 is multiplied by a transmit beamforming matrix , @xmath69\\in \\mathbb{c}^{n_t \\times k}$ ] , before transmission .",
    "as typical for massive mimo systems , we adopt simple matched - filter precoding , i.e. , @xmath70 @xcite,@xcite , since the matrix inversion required for zf and mmse precoding is computationally too expensive for the large number of users and antenna elements that are typical for massive mimo systems . furthermore , we assume that the eavesdropper s csi is not available at the local bs .",
    "hence , assuming that there are @xmath71 mts , the bs may use the remaining @xmath72 degrees of freedom offered by the @xmath21 transmit antennas for emission of an to degrade the eavesdropper s ability to decode the data intended for the mts @xcite .",
    "the an vector , @xmath73^t\\sim \\mathbb{cn}({\\bf 0}_{n_t - k},{\\bf i}_{n_t - k})$ ] , is multiplied by an an shaping matrix @xmath74\\in \\mathbb{c}^{n_t \\times ( n_t - k)}$ ] with @xmath75 , @xmath76 .",
    "the considered choices for the an shaping matrix will be discussed in the next subsection .",
    "the signal vector transmitted by the local bs is given by @xmath77 where @xmath78 and @xmath79 denote the transmit power allocated to each mt and each an signal , respectively , i.e. , for simplicity , we assume uniform power allocation across users and an signals , respectively . let the total transmit power be denoted by @xmath80 .",
    "then , @xmath78 and @xmath79 can be represented as @xmath81 and @xmath82 , respectively , where the power allocation factor @xmath83 , @xmath84 , strikes a power balance between the information - bearing signal and the an .",
    "the @xmath85 cells adjacent to the local cell transmit their own signals and an . in this work , in order to be able to gain some fundamental insights , we assume that all cells employ identical values for @xmath78 and @xmath79 as well as @xmath83 . accordingly , the received signals at the @xmath26 mt in the local cell , @xmath86 , and at the eavesdropper , @xmath87 , are given by @xmath88 where @xmath89 and @xmath90 are the gaussian noises at the @xmath26 mt and at the eavesdropper , respectively .",
    "the first term on the right hand side of ( [ x1 ] ) is the signal intended for the @xmath26 mt in the local cell with effective channel gain @xmath91 , which is assumed to be perfectly known at the @xmath26 mt in the local cell .",
    "the second and the third terms on the right hand side of ( [ x1 ] ) represent intra - cell / inter - cell interference and an leakage , respectively . on the other hand",
    ", the eavesdropper observes an @xmath92 mimo channel comprising @xmath22 local user signals , @xmath93 out - of - cell user signals , @xmath72 local cell an signals , and @xmath94 out - of - cell an signals . in order to obtain a lower bound on the achievable secrecy rate , we assume that the eavesdropper can acquire perfect knowledge of the effective channels of all mts , i.e. , @xmath95 .",
    "we note however that this is a quite pessimistic assumption because the uplink training performed in massive mimo @xcite makes it difficult for the eavesdropper to perform accurate channel estimation .      in this paper , we consider two different designs for the an shaping matrix @xmath96 .",
    "* null - space method : * for conventional ( non - massive ) mimo , @xmath96 is usually chosen to lie in the null space of the estimated channel , @xmath45 , i.e. , @xmath97 , @xmath98 , which is possible as long as @xmath99 holds @xcite . we refer to this method as @xmath100 in the following .",
    "if perfect csi is available , i.e. , @xmath101 the @xmath100-method prevents impairment of the users in the local cell by an generated by the local bs .",
    "however , in case of pilot contamination , an leakage to the users in the local cell is unavoidable .",
    "more importantly , for the large values of @xmath21 and @xmath22 typical for massive mimo systems , computation of the null space of @xmath45 , @xmath98 , is computationally expensive .",
    "this motivates the introduction of a simpler method for generation of the an shaping matrix .    *",
    "random method : * in this case , the columns of @xmath96 are mutually independent random vectors .",
    "we refer to this method as @xmath102 in the following . here",
    ", we construct the columns of @xmath96 as @xmath103 , where the @xmath104 , @xmath76 , are mutually independent gaussian random vectors .",
    "note that the @xmath102-method does not even attempt to avoid an leakage to the users in the local cell .",
    "however , it may still improve the ergodic secrecy rate as the precoding vector for the desired user signal , @xmath105 , is correlated with the user channel , @xmath39 , whereas the columns of the an shaping matrix are not correlated with the user channel .    our results in sections iv - vi",
    "reveal that although the @xmath100-method always achieves a better performance than the @xmath102-method , if pilot contamination and inter - cell interference are significant , the performance differences between both schemes are small .",
    "this makes the @xmath102-method an attractive alternative for massive mimo systems due to its simplicity .",
    "in this section , we first show that the achievable ergodic secrecy rate of the @xmath26 mt in the local cell can be expressed as the difference between the achievable ergodic rate of the mt and the ergodic capacity of the eavesdropper .",
    "subsequently , we provide a simple lower bound on the achievable ergodic rate of the mt , a closed - form expression for the ergodic capacity of the eavesdropper , and a simple and tight upper bound for the ergodic capacity of the eavesdropper .",
    "the results derived in this section are valid for both perfect training and pilot contamination as well as for both an shaping matrix designs . for convenience ,",
    "we define the ratio of the number of eavesdropper antennas and the number of bs antennas as @xmath106 , and the ratio of the number of users and the number of bs antennas as @xmath107 . in the following , we are interested in the asymptotic regime where @xmath108 but @xmath109 and @xmath110 are constant .",
    "the ergodic secrecy rate is an appropriate performance measure if delays can be afforded and coding over many independent channel realizations ( i.e. , over many coherence intervals ) is possible @xcite . considering the @xmath26 mt in the local cell",
    ", the considered channel is an instance of a multiple - input , single - output , multiple eavesdropper ( misome ) wiretap channel @xcite . in the following lemma",
    ", we provide an expression for an achievable ergodic secrecy rate of the @xmath26 mt in the local cell .",
    "_ lemma 1 : _ an achievable ergodic secrecy rate of the @xmath26 mt in the local cell is given by @xmath111^+,\\ ] ] where @xmath112^+=\\max\\{0 , x\\}$ ] , @xmath113 is an achievable ergodic rate of the @xmath26 mt in the local cell , and @xmath114 is the ergodic capacity between the local bs and the eavesdropper seeking to decode the information of the @xmath26 mt in the local cell .",
    "thereby , it is assumed that the eavesdropper is able to cancel the received signals of all in - cell and out - of - cell mts except the signal intended for the mt of interest , i.e. , @xmath115,\\ ] ] where @xmath116 denotes the noise correlation matrix at the eavesdropper under the worst - case assumption that the receiver noise is negligible , i.e. , @xmath117 .",
    "please refer to appendix a.    eq .",
    "( [ eq8 ] ) reveals that the achievable ergodic secrecy rate of the @xmath26 mt in the local cell has the subtractive form typical for many wiretap channels @xcite-@xcite , i.e. , it is the difference of an achievable ergodic rate of the user of interest and the capacity of the eavesdropper .",
    "before we analyze ( [ eq8 ] ) for perfect training and pilot contamination in sections iv and v , respectively , we derive general expressions for @xmath113 and @xmath114 , which apply to both cases .",
    "based on ( [ x1 ] ) an achievable ergodic rate of the @xmath26 mt in the local cell is given by @xmath118.\\ ] ] unfortunately , evaluating the expected value in ( [ rate ] ) analytically is cumbersome .",
    "therefore , we derive a lower bound on the achievable ergodic rate of the @xmath26 mt in the local cell by following the same approach as in @xcite . in particular , we rewrite the received signal at the @xmath26 mt in the local cell as @xmath119s_{nk}+n'_{nk},\\ ] ] where @xmath120 represents an effective noise , which is given by @xmath121\\right)s_{nk}+\\sum_{m=1}^m { \\bf h}_{mk } \\sqrt{q } { \\bf v}_m{\\bf z}_m+\\sum_{\\{m , l\\ } \\neq \\{n , k\\ } }   \\sqrt{p}{\\bf h}_{mk}{\\bf w}_{ml } s_{ml}+n_{nk}.\\ ] ] eq .",
    "( [ eq7 ] ) can be interpreted as an equivalent single - input single - output channel with constant gain @xmath122 $ ] and awgn @xmath120 .",
    "hence , we can apply _ theorem 1 _ in @xcite to obtain a computable lower bound for the achievable rate of the @xmath26 mt in the local cell as @xmath123 , where @xmath124 denotes the received signal - to - interference - plus - noise ratio ( sinr ) @xmath125|^2}}}{\\underset{\\mbox{signal leakage}}{\\underbrace{{\\rm var}[\\sqrt{p } { \\bf h}_{nk } { \\bf w}_{nk}]}}+\\underset{\\mbox{an leakage}}{\\underbrace{\\sum_{m=1}^m \\sum_{i=1}^{n_t - k } \\mathbb{e}[|\\sqrt{q}{\\bf h}_{mk } { \\bf v}_{mi}|^2]}}+\\underset{\\mbox{intra- and inter - cell interference}}{\\underbrace{\\sum_{\\{m , l\\ } \\neq \\{n , k\\ } } \\mathbb{e}[|\\sqrt{p } { \\bf h}_{mk } { \\bf w}_{ml}|^2 ] } } + \\sigma_{nk}^2}\\ ] ] with @xmath126=\\mathbb{e}[|\\sqrt{p } { \\bf h}_{nk } { \\bf w}_{nk}-\\mathbb{e}[\\sqrt{p } { \\bf h}_{nk } { \\bf w}_{nk}]|^2]$ ] .",
    "we note that the derived lower bound on the achievable rate is applicable to both an shaping matrix designs and the cases of perfect training and pilot contamination , respectively , cf .",
    "sections iv and v. the tightness of the lower bound will be confirmed by our results in section vi .      in this section ,",
    "we provide a closed - form expression for the ergodic capacity of the eavesdropper valid for both perfect training and pilot contamination . to gain more insight",
    ", we adopt a simplified path - loss model for the eavesdropper , i.e. , the path - losses between the bss and the eavesdropper are given by @xmath127 if @xmath128 and @xmath129 if @xmath130 , i.e. , the path - loss between the local bs and the eavesdropper is @xmath131 and the path - loss between the bss of the other cells and the eavesdropper is @xmath132 $ ] .",
    "a similar simplified path - loss model was used in @xcite for the user channels .",
    "the resulting ergodic secrecy capacity is summarized in the following theorem .",
    "_ theorem 1 : _ for @xmath108 and both the @xmath100 and the @xmath102 an shaping matrix designs , the ergodic capacity of the eavesdropper in ( [ ceve ] ) can be written as @xmath133 where @xmath134 , @xmath135 , @xmath136 @xmath137 , @xmath138 and @xmath139 . a closed - form expression for @xmath140",
    "is given in ( * ? ? ?",
    "* _ lemma 3 _ )",
    ".    please refer to appendix b.    a lower bound on the achievable ergodic secrecy rate of the @xmath26 mt in the local cell for the @xmath100/@xmath102 methods is obtained by combining ( [ eq8 ] ) , ( [ gammadl ] ) , and ( [ cint ] ) .",
    "however , the expression for the ergodic capacity of the eavesdropper in ( [ cint ] ) is somewhat cumbersome and offers little insight into the impact of the various system parameters .",
    "hence , in the next subsection , we derive a simple and tight upper bound for @xmath141 .      in the following theorem",
    ", we provide a tight upper bound for the ergodic capacity of the eavesdropper .",
    "_ theorem 2 _ : for @xmath142 and both the @xmath100 and the @xmath102 an shaping matrix generation methods , the ergodic capacity of the eavesdropper in ( [ ceve ] ) is upper bounded by ) is a bound since we used an approximation for its derivation , see appendix c. however , this approximation is known to be very accurate @xcite and comparisons of ( [ cup ] ) with simulation results for various system parameters suggest that ( [ cup ] ) is indeed an upper bound . ]",
    "@xmath143 if @xmath144 , where we introduce the definitions @xmath145 , @xmath146 , and @xmath147 .    please refer to appendix c.    _ remark 1 : _ we note that a finite eavesdropper capacity results only if matrix @xmath148 in ( [ ceve ] ) is invertible .",
    "since @xmath149 , @xmath150 , are independent matrices with i.i.d .",
    "entries , @xmath148 is invertible if @xmath151 or equivalently @xmath152 .",
    "regardless of the values of @xmath20 and @xmath153 , we have @xmath154\\leq 1-c \\alpha / a^2 \\leq 1-\\alpha / m.\\ ] ] for @xmath155 or @xmath156 , equality holds in ( [ cond ] ) . for @xmath157 and @xmath158 ,",
    "the condition for @xmath110 in theorem 2 is in general stricter than the invertibility condition for @xmath148 . nevertheless , the typical operating region for a massive mimo system is @xmath159 @xcite , where the upper bound in theorem 2 is applicable .",
    "( [ cup ] ) reveals that @xmath160 is monotonically increasing in @xmath109 , i.e. , as expected , the eavesdropper can enhance his eavesdropping capability by deploying more antennas .",
    "furthermore , in the relevant parameter range , @xmath161 , @xmath160 is not monotonic in @xmath110 but a decreasing function for @xmath162 and an increasing function for @xmath163 .",
    "hence , @xmath160 has a minimum at @xmath164 .",
    "assuming @xmath21 and @xmath25 are fixed , this behaviour can be explained as follows . for small @xmath22 ( corresponding to small @xmath110 ) ,",
    "the capacity of the eavesdropper is large because the amount of power allocated to the intercepted mt , @xmath165 , is large .",
    "as @xmath22 increases , the power allocated to the mt decreases which leads to a decrease in the capacity .",
    "however , if @xmath22 is increased beyond a certain point , @xmath148 becomes increasingly ill - conditioned which leads to an increase in the eavesdropper capacity .",
    "combining now ( [ eq8 ] ) , ( [ gammadl ] ) , and ( [ cup ] ) gives a tight lower bound on the ergodic secrecy rate of the @xmath26 mt in the local cell for both the @xmath100 and the @xmath102 methods .",
    "to gain more insight , in the next two sections , we specialize the tight lower bound on the ergodic secrecy rate to the cases of perfect training and pilot contamination , respectively .",
    "this will allow us to further simplify the sinr expression of the @xmath26 mt in the local cell and the resulting ergodic secrecy rate expression .",
    "in this section , we analyze the secrecy performance of the considered downlink multi - cell massive mimo system under the assumption of perfect csi , i.e. , @xmath166 , @xmath98 . to this end , for both considered an generation methods , we first simplify the lower bound on the achievable ergodic rate expression derived in section [ s2d ] by taking into account the perfect csi assumption .",
    "subsequently , exploiting this result , we derive simple and insightful lower bounds on the achievable ergodic secrecy rate .",
    "finally , we obtain an upper bound on the secrecy outage probability .",
    "we first characterize some of the terms in ( [ gammadl ] ) for the case of perfect training in the following lemma .    _",
    "lemma 2 : _ the received signal and interference powers at the @xmath26 mt in the local cell can be expressed as @xmath167 ^ 2=\\mathbb{e}^2[x ] \\quad { \\rm and}\\quad \\mathbb{e}[|\\tilde{\\bf h}_{nk } { \\bf w}_{mk}|^2]=\\mathbb{e}[|\\tilde{\\bf h}_{nk } { \\bf v}_{mi}|^2]=\\mathbb{e}[y^2],\\,\\forall n\\ne m\\ ] ] respectively , where @xmath168 , @xmath169 , @xmath170 are i.i.d .",
    "complex gaussian r.v.s with zero mean and unit variance , and @xmath171=1 $ ] .",
    "since each element of @xmath39 follows a gaussian distribution with zero mean and unit variance and @xmath172 , @xmath173 is a ( scaled ) chi - square r.v .  with @xmath174 degrees of freedom and statistically equivalent to @xmath175 .",
    "on the other hand , since @xmath176 , @xmath177 , and @xmath178 are unit - norm vectors and independent of the small - scale fading vector @xmath39 , the normalized interference terms , @xmath179 and @xmath180 , are ( scaled ) chi - square r.v.s with @xmath181 degrees of freedom and statistically equivalent to @xmath182 .    introducing @xmath183 and @xmath184 in ( [ gammadl ] ) and dividing both numerator and denominator by @xmath78",
    ", we obtain the sinrs for the @xmath100 and @xmath102 an shaping matrices as @xmath185}{l_{nk}{\\rm var}[x]+\\eta \\sum_{m \\neq n}^m l_{mk } \\sum_{i=1}^{n_t - k } \\mathbb{e}[y^2]+\\sum_{\\{m , l\\ } \\neq \\{n , k\\ } } l_{mk } \\mathbb{e}[y^2]+\\frac{k}{\\phi p}}\\ ] ] and @xmath186}{l_{nk}{\\rm var}[x]+\\eta \\sum_{m=1}^m l_{mk } \\sum_{i=1}^{n_t - k } \\mathbb{e}[y^2]+\\sum_{\\{m , l\\ } \\neq \\{n , k\\ } } l_{mk } \\mathbb{e}[y^2]+\\frac{k}{\\phi p}},\\ ] ] respectively .",
    "the right hand sides of ( [ gnk ] ) and ( [ gnk3 ] ) differ only in the second term of the denominator , where @xmath187 contains an additional term @xmath188 $ ] , which is due to the an leakage caused in the local cell .",
    "this term is absent in @xmath189 as , for perfect csi , the @xmath100-method avoids an leakage in the local cell .",
    "hence , @xmath190 always holds .",
    "since for large @xmath21 we have @xcite @xmath191}{n_t}=1~{\\rm and}~\\lim_{n_t \\rightarrow \\infty } \\frac{{\\rm var}[x]}{n_t}=0 , \\label{eq11}\\ ] ] we obtain from ( [ gnk ] ) and ( [ gnk3 ] ) @xmath192 and @xmath193 respectively . in order to obtain simple yet insightful results ,",
    "we adopt in the following a simplified path - loss model @xcite , similar to the simplified model introduced for the eavesdropper in section [ s2e ] .",
    "in particular , we model the path - losses as @xmath194 if @xmath128 and @xmath195 if @xmath130 , i.e. , the path - loss between the local bs and the mts in the local cell is @xmath131 and the path - loss between the bss of the other cells and the mts in the local cell is @xmath153 .",
    "hence , ( [ gnk2 ] ) and ( [ gnk4 ] ) simplify to @xmath196 and @xmath197 respectively .",
    "the ergodic rate for the two considered an shaping matrix generation methods is lower bounded by @xmath198 , where @xmath199 .",
    "we note that for systems with few users , i.e. , @xmath200 , and @xmath108 , the lower bounds on the ergodic rate reduce to @xmath201 i.e. , performance is limited by an leakage .",
    "this is in contrast to massive mimo systems without an generation , whose performance in the considered regime ( @xmath202 ) is only limited by pilot contamination @xcite , which is not considered in this section but will be addressed in section v. moreover , ( [ mtrate ] ) suggests that the performance difference between the @xmath100-method and the @xmath102-method diminishes if the an leakage from adjacent cells , which is proportional to @xmath203 for both methods , dominates the an leakage for the @xmath102-method in the local cell , which is proportional to @xmath204 .",
    "closed - form expressions for the lower bound on the achievable ergodic secrecy rate of the @xmath26 mt in the local cell for the @xmath100/@xmath102 methods are obtained by combining ( [ eq8 ] ) , ( [ cint ] ) , and ( [ bbb1])/([bbb2 ] ) .",
    "the tightness of the proposed lower bounds will be confirmed in section vi via simulations .      in this subsection , we provide insight into the influence of the various system parameters on the ergodic secrecy rate . combining ( [ eq8 ] ) , ( [ bbb1])/([bbb2 ] ) , and the upper bound on the ergodic secrecy capacity in ( [ cup ] ) , simple lower bounds for the ergodic secrecy rate valid for @xmath108",
    "are obtained as @xmath205\\phi+\\beta ( 1-\\zeta)\\phi^2}\\right)\\right]^+,\\\\ \\label{low2 } \\underline{r}_{nk}^{{\\rm sec},\\mathcal{r } } & = & \\left [ \\log_2\\left(\\frac{(b+1)\\beta \\zeta+[1-(b+1)\\beta]\\zeta \\phi-\\zeta \\phi^2}{(b+1)\\beta \\zeta+(b+1)\\beta ( 1-\\zeta)\\phi}\\right)\\right]^+,\\end{aligned}\\ ] ] where @xmath206 and @xmath207 was used . in the following ,",
    "we first investigate for what values of @xmath109 a non - zero ergodic secrecy rate can be achieved .",
    "* impact of @xmath109 : * let us denote the upper limit for @xmath109 such that a positive secrecy rate can be achieved as @xmath208 . for the @xmath100-method and the @xmath102-method , we obtain from ( [ low1 ] ) and ( [ low2 ] ) , respectively , positive secrecy rates if @xmath209 , @xmath210 , with @xmath211 and @xmath212+c / a^2}.\\ ] ] in both cases , @xmath213 is obtained for @xmath214 , i.e. , almost the entire transmit power is allocated to an generation . for both methods , @xmath208 is monotonically decreasing in @xmath110 .",
    "furthermore , we always have @xmath215 , i.e. , the @xmath216-method can tolerate a larger number of eavesdropper antennas than the @xmath217-method at the expense of a higher complexity in calculating the an shaping matrix .",
    "the robustness of both an shaping matrix designs can be improved by increasing the transmit power @xmath80 . however , based on ( [ alpha3 ] ) and ( [ alpha1 ] ) it can be shown that even for @xmath218 , the maximum values of @xmath109 that yield a non - zero ergodic secrecy rate are limited as @xmath219 and @xmath220 regardless of the choice of @xmath20 and @xmath153 .",
    "we note that for a single - cell system with a single user , it was shown in @xcite that the @xmath216-method can achieve non - zero secrecy rate for @xmath221 .",
    "the smaller number of tolerable eavesdropper antennas in the considered massive mimo system are caused by the suboptimal matched - filter precoding at the base station , which was chosen for complexity reasons .    * impact of @xmath83 * : eqs .",
    "( [ low1 ] ) and ( [ low2 ] ) reveal that zero secrecy rate results for @xmath222 and for a second value @xmath223 , @xmath224 , where @xmath210 .",
    "specifically , @xmath225 is given by @xmath226 where @xmath227 follows from the condition @xmath228 which is required for the validity of the upper bound on the ergodic secrecy capacity in ( [ cup ] ) .",
    "for @xmath229 , all power is allocated to an generation and no power is left for information transmission . on the other hand , for @xmath223 ,",
    "the amount of an generated is not sufficient to prevent the eavesdropper from decoding the transmitted signal .",
    "this suggests that for @xmath209 , @xmath210 , there exists an optimal @xmath83 , @xmath230 , which maximizes the achievable ergodic secrecy rate .",
    "the values of the optimal @xmath83 can be obtained from ( [ low1 ] ) and ( [ low2 ] ) as @xmath231    * impact of @xmath110 : * it can be shown from ( [ phistar ] ) and ( [ phistarr ] ) that for both the @xmath100 and @xmath102 methods the optimal @xmath83 is a monotonically increasing function of @xmath232 .",
    "thus , as the number of mts in the cell increase , the amount of power allocated to an generation decreases . this can be explained by the fact that as @xmath110 increases , the transmit power per mt used for information transmission , @xmath165 , decreases . to compensate for this effect , a larger @xmath83 is necessary . on the other hand , the ergodic secrecy rates for both the @xmath233 and @xmath102 methods are decreasing functions of @xmath232 , cf .",
    "( [ low1 ] ) , ( [ low2 ] ) , i.e. , as expected , for a given number of users the ergodic secrecy rates increase with increasing number of bs antennas .",
    "surprisingly , this property does not necessarily hold in case of pilot contamination , cf .",
    "section v.      in delay limited scenarios , where one codeword spans only one channel realization , outages are unavoidable since alice does not have the csi of the eavesdropper channel and the secrecy outage probability has to be used to characterize the performance of the system instead of the ergodic rate .",
    "for the considered multi - cell massive mimo system , the rate of the desired user , @xmath113 , becomes deterministic as @xmath108 , but the instantaneous capacity of the eavesdropper channel remains a random variable .",
    "a secrecy outage occurs whenever the target secrecy rate @xmath234 exceeds the actual instantaneous secrecy rate .",
    "thus , the secrecy outage probability of the @xmath26 mt in the local cell is given by @xmath235 where @xmath236 and @xmath237 is given in appendix b. a closed - form upper bound on the secrecy outage probability is obtained by replacing @xmath113 with @xmath198 with @xmath238 given in ( [ bbb1])/([bbb2 ] ) .",
    "in this section , we analyze the performance of the considered multi - cell massive mimo system for the case of pilot contamination . to this end , we simplify the lower bound on the achievable ergodic rate expression derived in section [ s2d ] for the case of pilot contamination , derive insightful and tight lower bounds on the ergodic secrecy rate , and provide a closed - form expression for the secrecy outage probability .",
    "the lower bound on the achievable ergodic rate of the users derived in section [ s2d ] is also applicable in case of pilot contamination .",
    "thus , in a first step , we characterize the four expectations / variances in the sinr expression in ( [ gammadl ] ) .    expressing the small - scale fading vector as @xmath57 , cf .",
    "section [ s2 ] , the denominator of ( [ gammadl ] ) can be rewritten as ( we omit the path - loss for the moment ) @xmath239=\\mathbb{e}\\bigg[\\|\\hat{{\\bf h}}_{nk}\\|+{\\bf e}_{nk}\\frac{\\hat{{\\bf h}}_{nk}}{\\|\\hat{{\\bf h}}_{nk}\\|}\\bigg]=\\mathbb{e}[\\|\\hat{{\\bf h}}_{nk}\\|]=\\sqrt{\\frac{p_\\tau \\tau l_{nk}}{1+p_\\tau \\tau \\sum_{m=1}^m l_{mk}}}\\mathbb{e}[x],\\ ] ] where @xmath240 , cf .",
    "furthermore , we observe from ( [ est ] ) that , at the local bs , the channel estimate for the @xmath26 mt in the local cell involves the sum of all channel vectors between the local bs and the @xmath26 mts in all cells weighted with scaling factors @xmath241 .",
    "thus , the transmit beamforming vector for the @xmath26 mt in the local cell is also affected by the channel vectors between the local bs and the @xmath26 mts in all other cells .",
    "this is the fundamental problem introduced by pilot contamination . using this observation , the interference caused by the @xmath26 mt in the @xmath29 cell to the local cell ( i.e. , the component of the third term of the denominator in ( [ gammadl ] ) with @xmath242 )",
    "is given by @xmath243=\\mathbb{e}\\big[\\|\\hat{{\\bf h}}_{mk}\\|^2\\big]+\\mathbb{e}\\bigg[\\frac{\\hat{{\\bf h}}_{mk}^h}{\\|\\hat{{\\bf h}}_{mk}\\| } { \\bf e}_{mk}^h{\\bf e}_{mk}\\frac{\\hat{{\\bf h}}_{mk}}{\\|\\hat{{\\bf h}}_{mk}\\|}\\bigg]\\\\ & \\hspace{0 cm}\\qquad = \\frac{p_\\tau \\tau l_{mk}}{1+p_\\tau \\tau \\sum_{p=1}^m l_{pk}}\\mathbb{e}[x^2]+\\frac{1+p_\\tau \\tau \\sum_{p \\neq m}l_{pk}}{1+p_\\tau \\tau \\sum_{m=1}^m l_{mk}}\\mathbb{e}[y^2],\\end{aligned}\\ ] ] where @xmath244 , cf .",
    "lemma @xmath131 .",
    "exploiting now ( [ eq33 ] ) and ( [ eq34 ] ) and the definition of variance , i.e. , @xmath245=\\mathbb{e}[x^2]-\\mathbb{e}^2[x]$ ] , we obtain for the signal leakage term in ( [ gammadl ] ) @xmath246 = \\frac{p_\\tau \\tau l_{nk}}{1+p_\\tau \\tau \\sum_{m=1}^m l_{mk}}{\\rm var}[x]+\\frac{1+p_\\tau \\tau \\sum_{m \\neq n}l_{mk}}{1+p_\\tau \\tau \\sum_{m=1}^m l_{mk}}\\mathbb{e}[y^2].\\ ] ] furthermore , the interference from the @xmath247 mt , where @xmath248 , in the adjacent ( i.e. , non - local ) cells is given by @xmath249=\\mathbb{e}[y^2],\\ ] ] as each @xmath176 , @xmath250 , has unit norm and is independent of @xmath251 . the inter - cell an leakage",
    "is obtained as @xmath252=\\mathbb{e}[y^2]$ ] , @xmath253 , as @xmath178 has unit norm and is independent of @xmath38 . while the inter - cell an leakage and the terms calculated in ( [ eq33])-([eq36 ] ) are identical for the @xmath100 and @xmath102 methods , the intra - cell an leakage within the local cell depends on the an shaping matrix design . in particular , for the @xmath100-method , the an is designed to lie in the null space of the estimated channels of all @xmath22 mts in the local cell .",
    "thus , the intra - cell an leakage is obtained as @xmath254=\\mathbb{e}[{\\bf v}_{ni}^h { \\bf e}_{nk}^h { \\bf e}_{nk } { \\bf v}_{ni}]=\\frac{1+p_\\tau \\tau \\sum_{m \\neq n}l_{mk}}{1+p_\\tau \\tau \\sum_{m=1}^m l_{mk } } \\mathbb{e}[y^2],\\ ] ] due to the independence of @xmath255 , @xmath256 , and @xmath60 . on the other hand , for the @xmath102-method ,",
    "the an is generated randomly , such that @xmath257=\\mathbb{e}[y^2]$ ] , since the @xmath255 , @xmath256 , have unit norm and are independent of @xmath39 .    plugging all intermediate results derived in this section so far into ( [ gammadl ] ) , we obtain @xmath258}{\\lambda_{nk}{\\rm var}[x]+\\sum_{m=1}^m\\left(\\mu_{mk}+\\eta",
    "\\sum_{i=1}^{n_t - k } \\hat{\\mu}_{mk}+\\sum_{l \\neq k } l_{mk}\\right)\\mathbb{e}[y^2]+\\sum_{m \\neq n}\\lambda_{mk}\\mathbb{e}[x^2]+\\frac{k}{\\phi p}}\\ ] ] and @xmath259}{\\lambda_{nk}{\\rm var}[x]+\\sum_{m=1}^m\\left(\\mu_{mk}+\\eta \\sum_{i=1}^{n_t - k } l_{mk}+\\sum_{l \\neq k } l_{mk}\\right)\\mathbb{e}[y^2]+\\sum_{m \\neq n}\\lambda_{mk}\\mathbb{e}[x^2]+\\frac{k}{\\phi p}},\\ ] ] where @xmath260 , @xmath261 , and @xmath262 . adopting now the same simplified interference model as in section [ s3 ] , ( [ eq38 ] ) and ( [ eq39 ] ) can be further simplified , and for large @xmath21 , the corresponding lower bound on the achievable ergodic rates are given by @xmath263 and @xmath264 where @xmath265 . from ( [ rnull ] ) and ( [ rrnd ] ) we observe that @xmath266 always holds but the performance difference diminishes if @xmath267 .",
    "we note that for both an shaping matrix designs the powers of the an leakage originating from other cells and the inter - cell interference are proportional to @xmath268 .",
    "furthermore , for the @xmath216-method and the @xmath217-method , the an leakage originating in the local cell is proportional to @xmath269 and @xmath204 , respectively .",
    "therefore , @xmath267 implies that the an leakage originating from other cells and the inter - cell interference are much stronger than the an leakage in the local cell and/or the pilot power @xmath42 is not sufficiently large to prevent an leakage for the @xmath216-method in the local cell . furthermore , for @xmath202 , we obtain @xmath270)$ ] and @xmath271)$ ] , i.e. , in the asymptotic regime where the number of users is constant but the number of bs antennas increases without bound , the performance for both an shaping matrix designs is limited by both an leakage and pilot contamination .",
    "since the ergodic capacity of the eavesdropper is not affected by the imperfect csi at the local bs , a lower bound on the ergodic secrecy rate for pilot contamination can be calculated from ( [ eq8 ] ) , ( [ ceve ] ) , and ( [ rnull])/([rrnd ] ) .      to gain more insight ,",
    "we employ again the upper bound on the ergodic capacity of the eavesdropper provided in theorem 2 . combining ( [ eq8 ] ) , ( [ cup ] ) , ( [ rnull ] ) , and ( [ rrnd ] )",
    ", we obtain simple lower bounds for the ergodic secrecy rate for the @xmath100 and @xmath102 methods as @xmath272 @xmath273\\zeta \\phi-\\zeta(\\beta+c)\\lambda \\phi^2}{(b+1-\\lambda)\\beta \\zeta + [ ( \\beta+c-1)\\lambda \\zeta+(b+1-\\lambda)(1-\\zeta)]\\phi+(1-\\zeta)(\\beta+c-1)\\lambda \\phi^2}\\right)\\right]^+,\\ ] ] and @xmath274\\zeta \\phi-\\zeta c \\lambda \\phi^2}{(b+1)\\beta",
    "\\zeta + [ ( c-1)\\lambda \\zeta+(b+1)(1-\\zeta)]\\phi+(1-\\zeta)(c-1)\\lambda \\phi^2}\\right)\\right]^+,\\ ] ] respectively .    in the following ,",
    "we investigate the impact of the system parameters on the ergodic secrecy rate in detail .",
    "* impact of @xmath109 : * similar to the perfect training case we investigate in the following the upper limit for @xmath109 such that a positive secrecy rate can be achieved .",
    "we observe from ( [ secnull1 ] ) and ( [ secrnd1 ] ) that a non - zero secrecy rate can be achieved as long as @xmath275 holds where @xmath276 eqs .",
    "( [ eq46 ] ) and ( [ eq46a ] ) reveal that the robustness of the considered multi - cell mimo system to eavesdropping is monotonically decreasing with increasing number of mts in the system . on the other hand ,",
    "allocating more resources to training , i.e. , increasing @xmath277 by increasing the pilot power , @xmath42 , or the pilot sequence duration , @xmath47 , leads to a higher robustness against eavesdropping , i.e. , a larger number of eavesdropper antennas can be tolerated .",
    "furthermore , as expected , @xmath278 , i.e. , the more complex @xmath100-method is more robust to eavesdropping than the simple @xmath102 method .",
    "@xmath279 approaches @xmath280 if @xmath277 is small , i.e. , both methods have a similar robustness to eavesdropping in case of strong pilot contamination since , in this case , the @xmath100-method can no longer avoid an leakage within the local cell .",
    "we also note that , as expected , since @xmath281 always holds , for a given an shaping matrix design , the maximum tolerable number of eavesdropper antennas in case of pilot contamination is always smaller than that in case of perfect training , cf .",
    "( [ alpha1 ] ) , ( [ alpha3 ] ) , and ( [ eq46 ] ) , ( [ eq46a ] ) .    * impact of @xmath83 : * similar to the case of perfect training , the ergodic secrecy rate for both an shaping matrix designs becomes zero for @xmath282 also for the case of pilot contamination , cf .",
    "( [ secnull1 ] ) and ( [ secrnd1 ] ) , since zero power is allocated to information transmission in this case .",
    "a second zero of the ergodic secrecy rate occurs for @xmath223 , @xmath224 , where @xmath210 .",
    "@xmath225 is obtained from ( [ secnull1 ] ) and ( [ secrnd1 ] ) as @xmath283 furthermore , assuming @xmath209 and taking the derivatives of ( [ secnull1 ] ) and ( [ secrnd1 ] ) with respect to @xmath83 and setting them to zero , we obtain the optimal power allocation factors for the @xmath100 and @xmath102 methods as @xmath284 and @xmath285    * impact of @xmath110 : * based on ( [ eq43 ] ) and ( [ eq44 ] ) it can be shown that , similar to the case for perfect training , for pilot contamination , the optimal @xmath286 and @xmath287 are monotonically increasing in @xmath110 . furthermore , in section [ s3 ] , we found that , for perfect training , the ergodic secrecy rate is monotonically increasing for decreasing @xmath110 .",
    "however , for a given @xmath83 , it can be shown based on ( [ secnull1 ] ) and ( [ secrnd1 ] ) that this is no longer true in case of pilot contamination .",
    "in other words , if @xmath83 and the number of users @xmath22 are fixed , in case of pilot contamination , the ergodic secrecy rate is not maximized by making the number of bs antennas , @xmath21 , exceedingly large ( i.e. , @xmath288 such that @xmath289 ) . instead , there is an optimal finite number of bs antennas .",
    "we will investigate this issue numerically in section vi .",
    "* impact of @xmath277 : * pilot contamination impacts the ergodic secrecy rate via @xmath277 , where smaller values of @xmath277 imply that the mts expend less resources for uplink training ( i.e. , they employ a smaller pilot power @xmath42 and/or a shorter pilot sequence length , @xmath47 ) .",
    "first , we observe from ( [ secnull1 ] ) and ( [ secrnd1 ] ) that both @xmath290 and @xmath291 are increasing functions of @xmath277 , i.e. , as expected , if the mts employ a higher pilot power and/or a longer pilot sequence for channel estimation , the ergodic secrecy rate improves .",
    "furthermore , @xmath208 is an increasing function of @xmath277 , i.e. , a higher uplink training power and/or longer pilot sequence lengths increase the operating region of the system where a non - zero secrecy rate can be achieved .",
    "on the other hand , for a given coherence interval @xmath0 , fixed transmit power @xmath80 , and fixed pilot power @xmath42 , the fraction of time allocated for training @xmath292 ( and as a consequence @xmath277 ) can be optimized for maximization of the net ergodic secrecy rate given by @xmath293 , @xmath210 .",
    "we assume that the channels are constant within one coherence interval but change from one coherence interval to the next .",
    "we also emphasize that by using the ( net ) ergodic secrecy rate as a performance measure , we implicitly assume coding over many coherence intervals . for small @xmath47 ,",
    "the factor @xmath294 is large but the ergodic secrecy rate , @xmath295 , is small because of the unreliable channel estimation . on the other hand , for large @xmath47",
    ", the factor @xmath294 is small but the ergodic secrecy rate , @xmath295 , is large because of the more accurate channel estimation .",
    "hence , @xmath47 can be optimized for optimal performance @xcite .",
    "the optimization of @xmath47 will be studied numerically in fig .",
    "[ fig8 ] in section [ s5 ] .      plugging ( [ rnull ] ) and ( [ rrnd ] ) into the secrecy outage probability expression derived in ( [ prob ] )",
    ", we obtain an upper bound for the secrecy outage probability for the case of pilot contamination as @xmath296 where @xmath297 .",
    "in this section , we evaluate the secrecy performance of the considered multi - cell massive mimo systems based on the analytical expressions derived in sections iii - v and via monte - carlo simulation .",
    "we consider a system with @xmath298 hexagonal cells and adopt the simplified path - loss model , i.e. , the severeness of the inter - cell interference is characterized by parameter @xmath153 only .",
    "the monte - carlo simulation results for the ergodic secrecy rate of the @xmath26 mt in the local cell are based on ( [ eq8 ] ) where the achievable ergodic rate @xmath113 is obtained from ( [ rate ] ) and the ergodic secrecy capacity of the eavesdropper is obtained from ( [ ceve ] ) .",
    "thereby , the expected values in ( [ rate ] ) and ( [ ceve ] ) were evaluated by averaging over @xmath299 random channel realizations .",
    "the monte - carlo simulation results for the outage probability are obtained from @xmath300 , which was evaluated again based on @xmath299 random channel realizations .",
    "the values of all relevant system parameters are provided in the captions of the figures .      for the results shown in this section , we adopt a fixed power allocation factor of @xmath301 .",
    "the optimization of @xmath83 will be addressed in the next subsection .    in fig .",
    "[ fig0 ] , we verify the derived analytical expressions for the ergodic capacity of the eavesdropper which seeks to decode the information intended for the @xmath26 mt in the local cell .",
    "the analytical results were generated with ( [ cint ] ) while the upper bound results were computed with ( [ cup ] ) .",
    "the vertical dashed lines denote @xmath302 . fig .",
    "[ fig0 ] reveals that for @xmath303 , the upper bound is very tight . for @xmath304 ,",
    "the upper bound is not applicable , although the ergodic capacity of the eavesdropper is still finite , cf .",
    "theorem 2 and remark 1 . for @xmath305 , the ergodic capacity of the eavesdropper tends to infinity since @xmath148 becomes singular .",
    "furthermore , we observe from fig .",
    "[ fig0 ] that increasing inter - cell interference ( i.e. , larger inter - cell interference factors , @xmath153 ) has a negative effect on the ergodic capacity of the eavesdropper , whereas as expected , the eavesdropper can improve his performance by adding more antennas , @xmath25 ( i.e. , by increasing @xmath109 )",
    ". moreover , fig .",
    "[ fig0 ] confirms that the ergodic capacity of the eavesdropper is monotonically decreasing in @xmath110 in the interval @xmath306 and monotonically increasing in @xmath110 in the interval @xmath307 .",
    "the resulting minimum of the ergodic capacity of the eavesdropper at @xmath308 is denoted by a black circle in fig .",
    "[ fig0 ] .",
    "mt in the local cell vs. the normalized number of mts in the cell , @xmath110 , for a system with total transmit power @xmath309 db , @xmath298 , @xmath301 , and @xmath310.,title=\"fig:\",width=384 ] +    in fig .",
    "[ fig2 ] , for the case of perfect training , we show the ergodic secrecy rate vs.  the number of bs antennas ( subfigure ( a ) ) and the secrecy outage probability vs.  the target secrecy rate @xmath311 ( subfigure ( b ) ) for the @xmath26 mt in the local cell .",
    "results for both considered an shaping matrix designs are shown .",
    "in subfigure ( a ) , lower bound i was obtained based on ( [ eq8 ] ) , ( [ cint ] ) , ( [ bbb1 ] ) , and ( [ bbb2 ] ) and lower bound ii was obtained with ( [ low1 ] ) and ( [ low2 ] ) . in subfigure",
    "( b ) , the upper bound was obtained with ( [ prob ] ) .",
    "[ fig2 ] reveals that the derived bounds for the ergodic secrecy rate and the secrecy outage probability are accurate .",
    "as expected , for the ergodic secrecy rate , lower bound i is somewhat tighter than lower bound ii .",
    "furthermore , increasing the number of bs antennas @xmath21 improves both the ergodic secrecy rate as well as the secrecy outage probability .",
    "moreover , as expected , the @xmath100-method for generation of the an shaping matrix always outperforms the @xmath102-method as the @xmath100-method avoids intra - cell an leakage .",
    ", @xmath312 db , @xmath313 , @xmath314 , @xmath315 , and @xmath301.,title=\"fig:\",width=384 ] +    in fig .",
    "[ fig3 ] , we show the same performance metrics as in fig .  [ fig2 ] , however , now for the case of pilot contamination . in subfigure ( a ) , lower bound i was obtained based on ( [ eq8 ] ) , ( [ cint ] ) , ( [ rnull ] ) , and ( [ rrnd ] ) , whereas lower bound ii was obtained with ( [ secnull1 ] ) and ( [ secrnd1 ] ) . in subfigure",
    "( b ) , the upper bound was obtained with ( [ outagepc ] ) .",
    "similar to the case of perfect training , the derived bounds on the ergodic secrecy rate and the secrecy outage probability are very tight .",
    "a comparison of figs .",
    "[ fig2 ] and [ fig3 ] reveals that pilot contamination causes a significant performance degradation in terms of both ergodic secrecy rate and secrecy outage probability .",
    "furthermore , unlike for the case of perfect training , for pilot contamination , the ergodic secrecy rate is not monotonically increasing in @xmath21 but has a unique maximum for both an shaping matrix designs .    , @xmath312 db , @xmath313 mts , @xmath316 , @xmath315 , @xmath301 , @xmath317 , and @xmath318 . , title=\"fig:\",width=384 ] +      in this subsection , we investigate the optimization of power allocation factor @xmath83 and illustrate its impact on the ergodic secrecy rate .    figs .",
    "[ fig4 ] and [ fig5 ] show the ergodic secrecy rates of the @xmath26 mt in the local cell as functions of @xmath83 for the cases of perfect training and pilot contamination , respectively .",
    "the ergodic secrecy rate curves were obtained via monte carlo simulation and various values of @xmath109 and @xmath110 are considered .",
    "the optimal values for @xmath83 obtained with ( [ phistar])/([phistarr ] ) ( for perfect training ) and ( [ eq43])/([eq44 ] ) ( for pilot contamination ) are denoted by black circles . as expected from our discussions in sections [ s3 ] and [ s4 ] , figs .",
    "[ fig4 ] and [ fig5 ] show that , for both the @xmath216 and the @xmath217 an shaping matrix desigs , the optimal @xmath319 is decreasing in @xmath109 , i.e. , the system should allocate more power to an if the eavesdropper is becoming stronger , and increasing in @xmath110 , i.e. , less power should be allocated to an if the number of users increases . for @xmath320 ,",
    "no results are shown for the case of pilot contamination in fig .",
    "[ fig5 ] since the corresponding ergodic secrecy rates are zero for all choices of @xmath83 , i.e. , @xmath321 holds in this case .     assuming perfect training , @xmath310 , @xmath298 , @xmath312 db , and @xmath316 .",
    "black circles denote the optimal power allocation factor , @xmath322 , obtained with ( [ phistar ] ) and ( [ phistarr]).,title=\"fig:\",width=384 ] +     assuming pilot contamination , @xmath298 , @xmath310 , @xmath323 db , @xmath317 , @xmath318 , and @xmath316 .",
    "black circles denote the optimal power allocation factor , @xmath322 , obtained with ( [ eq43 ] ) and ( [ eq44]).,title=\"fig:\",width=384 ] +    in fig .",
    "[ fig6 ] , we depict the ergodic secrecy rate and the optimal power allocation factor , @xmath319 , as functions of the normalized number of mts in each cell , @xmath110 . thereby , the ergodic secrecy rate is calculated using the optimal @xmath319 , which was obtained based on the analytical results in sections iv and v for the case of perfect training and pilot contamination , respectively .",
    "we observe that , unlike the case when @xmath83 is fixed , if @xmath83 is optimized , the ergodic secrecy rate is a non - increasing function of @xmath110 also in case of pilot contamination , i.e. , for a given number of users , increasing the number of bs antennas is always beneficial . on the other hand , for all considered cases ,",
    "the optimal value of @xmath83 is a monotonically increasing function of @xmath110 , i.e. , as the number of users in the system increases relative to the number of bs antennas , less power is allocated to an .",
    "also , the performance gap between both an shaping matrix design methods decreases with increasing @xmath110 .    ,",
    "vs.  @xmath110 for @xmath298 , @xmath312 db , @xmath310 , @xmath324 , and @xmath316 . in case of pilot contamination , @xmath317 and @xmath318 .",
    "the ergodic secrecy rates were obtained with ( [ low1 ] ) , ( [ low2 ] ) , ( [ secnull1 ] ) , and ( [ secrnd1 ] ) . the optimal power allocation factor was obtained with ( [ phistar ] ) , ( [ phistarr ] ) , [ eq43 ] ) , and ( [ eq44]).,title=\"fig:\",width=384 ] +      in fig",
    ".  [ fig7 ] , we illustrate for both an shaping matrix designs under what conditions a non - zero ergodic secrecy rate is possible . to this end , we plot @xmath208 as defined in ( [ alpha3 ] ) , ( [ alpha1 ] ) , ( [ eq46 ] ) , and ( [ eq46a ] ) as functions of @xmath110 for @xmath318 ( subfigure on left hand side ) and the amount of power , @xmath42 , spent by the mts for training for @xmath325 ( subfigure on right hand side ) . for @xmath326 ,",
    "the ergodic secrecy rate is zero regardless of the amount of power allocated to an . on the other hand , for @xmath327",
    ", a positive ergodic secrecy rate can be achieved .",
    "we observe from fig .",
    "[ fig7 ] that for both an shaping matrix designs @xmath208 is a decreasing function of @xmath110 , whereas it is an increasing function of @xmath42 , i.e. , the more reliable the channel estimates , the more eavesdropper antennas can be tolerated before the ergodic secrecy rate drops to zero .",
    "however , @xmath208 saturates for large values of @xmath42 .",
    "we note that the values of @xmath328 are smaller for the @xmath217-method than for the @xmath216-method because of the larger intra - cell an leakage caused by the @xmath217-method .     vs.  @xmath110 and @xmath329 for pilot contamination , total transmit power @xmath323 db , @xmath298 , @xmath310 , @xmath316 , and @xmath317.,title=\"fig:\",width=384 ] +      fig .",
    "[ fig8 ] depicts the net ergodic secrecy rate , @xmath330 , as a function of @xmath277 , where the lower bounds in ( [ secnull1 ] ) and ( [ secrnd1 ] ) were used to approximate @xmath331 .",
    "the cases of @xmath332 and @xmath333 are considered for @xmath334 and @xmath335 mts .",
    "we assume that @xmath336 db and @xmath277 is varied by changing @xmath47 and the optimal power allocation factor @xmath319 is employed .",
    "thereby , the range of possible @xmath47 is @xmath337 , which directly translates into the range of possible @xmath277 as @xmath265 .",
    "[ fig8 ] reveals that the optimal @xmath277 is ( slightly ) increasing in @xmath0 since for larger values of @xmath0 , more time for allocation to uplink training is available , i.e. , @xmath47 can be increased resulting in a larger value for the optimal @xmath277 . for @xmath335 , the lower limit of the permissible interval for @xmath47 given by @xmath317 yields the maximum net secrecy rate . in this case , increasing @xmath47 beyond @xmath317 does not improve @xmath331 sufficiently to compensate for the decrease of the term @xmath338 .     for a system with optimal @xmath319 , @xmath310 , @xmath298 , @xmath315 , @xmath312 db , @xmath339 db , and @xmath316 .",
    "black circles denote the maximum net ergodic secrecy rate.,title=\"fig:\",width=384 ] +",
    "in this paper , we considered a multi - cell massive mimo system with matched - filter precoding and an generation at the bs for secure downlink transmission in the presence of a multi - antenna passive eavesdropper . for an generation , we considered both the conventional null space based an shaping matrix design and a novel random an shaping matrix design . for both perfect training and pilot contamination , we derived two tight lower bounds on the ergodic secrecy rate and a tight upper bound on the secrecy outage probability .",
    "the analytical expressions allowed us to optimize the amount of power allocated to an generation and to gain significant insight into the impact of the system parameters on performance .",
    "in particular , our results reveal that for the considered multi - cell massive mimo system with matched - filter precoding ( 1 ) an generation is necessary to achieve a non - zero ergodic secrecy rate if the user and the eavesdropper experience the same path - loss , ( 2 ) secrecy can not be guaranteed if the eavesdropper has too many antennas , ( 3 ) for the case of pilot contamination , the ergodic secrecy rate is only an increasing function of the number of bs antennas if the amount of power allocated to an generation is optimized , and ( 4 ) the proposed random an shaping matrix design is a promising low - complexity alternative to the conventional null space based an shaping matrix design .",
    "the proof closely follows @xcite .",
    "we first derive an expression for the secrecy rate for given realizations of @xmath251 and @xmath340 , @xmath40 , @xmath30 .",
    "since the misome channel in ( [ x1 ] ) and ( [ x2 ] ) is a non - degraded broadcast channel @xcite , the secrecy capacity is given by @xcite , @xcite @xmath341 where vector @xmath342 contains the csi of all user and eavesdropper channels and @xmath343 is the mutual information between two r.v.s @xmath183 and @xmath184 conditioned on the csi vector .",
    "@xmath344 is achieved by maximizing over all joint distributions such that a markov chain @xmath345 results , where @xmath65 is an arbitrary input variable @xcite .",
    "specifically , for @xmath346 an achievable secrecy rate for the @xmath26 mt in the local cell , @xmath347 , is given by @xmath348^+\\stackrel{(a)}{=}\\bigg[i\\left({\\bf w}_{nk}s_{nk};y_{nk}|{\\bf h}\\right)-i\\left({\\bf w}_{nk}s_{nk};{\\bf y}_{\\rm eve}|{\\bf h}\\right)\\bigg]^+\\nonumber \\\\ & \\stackrel{(b)}{\\ge } & \\bigg[r_{nk}\\left({\\bf h}\\right)-c_{nk}^{\\rm eve}\\left({\\bf h}\\right)\\bigg]^+\\end{aligned}\\ ] ] where ( a ) follows since @xmath349 is a deterministic function of @xmath65 .",
    "furthermore , @xmath350 is an achievable rate of the @xmath26 mt in the local cell and @xmath351 is an upper bound on the mutual information @xmath352 .",
    "thus , follows ( b ) .",
    "we note that for computation of @xmath353 we made the worst - case assumption that the eavesdropper can decode and cancel the signals of all mts except the signal intended for the mt of interest ( * ? ? ?",
    "* chapter 10.2 ) .    finally , to arrive at the ergodic secrecy rate , we average @xmath354 over all channel realizations , which results in @xcite @xmath355&=&\\mathbb{e}\\left [ \\bigg[r_{nk}\\left({\\bf h}\\right)-c_{nk}^{\\rm eve}\\left({\\bf h}\\right)\\bigg]^+\\right]\\nonumber \\\\ & \\ge & \\bigg[\\mathbb{e}\\left[r_{nk}\\left({\\bf h}\\right)\\right]-\\mathbb{e}\\left [ c_{nk}^{\\rm eve}\\left({\\bf h}\\right)\\right]\\bigg]^+=r_{nk}^{\\rm sec}.\\end{aligned}\\ ] ] introducing the definitions of the achievable ergodic secrecy rate , @xmath356 $ ] , and the ergodic eavesdropper capacity , @xmath357 $ ] , completes the proof .",
    "we first recall that the entries of @xmath358 , @xmath150 , are mutually independent complex gaussian r.v.s . on the other hand , for @xmath359 and both an shaping matrix designs , the vectors @xmath360 , form an orthonormal basis .",
    "hence , @xmath361 , @xmath150 , also has independent complex gaussian entries , which are independent from the complex gaussian entries of @xmath362 .",
    "thus , the term @xmath236 in ( [ ceve ] ) is equivalent to the sinr of an @xmath25-branch mmse diversity combiner with @xmath363 interferers @xcite . as a result , for the considered simplified path - loss model",
    ", the cumulative density function ( cdf ) of the received sinr , @xmath364 , at the eavesdropper is given by @xcite @xmath365 where @xmath366 , @xmath367 , and @xmath368 are defined in theorem 1 .",
    "exploiting ( [ fxx ] ) , we can rewrite ( [ ceve ] ) as @xmath369 where @xmath370 , @xmath371 , and @xmath140 are defined in theorem 1 .",
    "here , ( a ) is obtained using integration by parts , ( b ) holds if the order of @xmath183 in the denominator of ( [ fxx ] ) is not smaller than that in the numerator , i.e. , @xmath372 or equivalently @xmath373 , which is also the condition to ensure invertibility of @xmath148 in ( [ ceve ] ) , and ( c ) is obtained using the definition of @xmath140 given in theorem 1 .",
    "this completes the proof .      using jensen s inequality and the mutual independence of @xmath374 and @xmath361 , @xmath30 ( cf .",
    "appendix b ) , @xmath114 in ( [ ceve ] ) is upper bounded by @xmath375\\tilde{\\bf w}_{nk}\\right]\\right).\\ ] ] let us first focus on the term @xmath376 $ ] in ( [ cup2 ] ) and note that @xmath148 is statistically equivalent to a weighted sum of two scaled wishart matrices @xcite .",
    "specifically , we have @xmath377 with @xmath378 and @xmath379 , where @xmath380 denotes an @xmath381 wishart matrix with @xmath382 degrees of freedom . strictly speaking",
    ", @xmath148 is not a wishart matrix , and the exact distribution of @xmath148 seems intractable .",
    "however , @xmath148 may be accurately approximated as a single scaled wishart matrix , @xmath383 , where parameters @xmath384 and @xmath385 are chosen such that the first two moments of @xmath148 and @xmath386 are identical @xcite . equating the first two moments of the traces of these matrices yields @xcite @xmath387 and @xmath388 by exploiting the expectation of an inverse wishart matrix given in ( * ? ? ?",
    "* eq .  ( 12 ) ) , we obtain @xmath389=\\frac { 1}{\\xi(\\varphi - n_e-1 ) } { \\bf i}_{n_e}$ ] with @xmath390 if @xmath391 or equivalently if @xmath303 for @xmath142 . plugging this result and @xmath392=n_e$ ] into ( [ cup2 ] ) , we finally obtain the result in ( [ cup ] ) .",
    "this completes the proof .",
    "20 a. mukherjee , s. a. a. fakoorian , j. huang , and a. l. swindlehurst , `` principles of physical - layer security in multiuser wireless networks : a survey , '' submitted to _",
    "ieee commun .",
    "surveys and tutorials _ , 2013 .",
    "arxiv:1011.3754 [ cs.it ]              g. geraci , m. egan , j. yuan , a. razi , and i. collings , `` secrecy sum - rates for multi - user mimo regularized channel inversion precoding , '' _ ieee trans . commun .",
    "3472 - 3482 , nov .",
    "2012 .",
    "x. zhou and m. r. mckay , `` secure transmission with artificial noise over fading channels : achievable rate and optimal power allocation , '' _ ieee trans .",
    "3831 - 3842 , july 2010 .",
    "f. rusek , d. persson , b. k. lau , e. g. larsson , t. l. marzetta , o. edfors , and f. tufvesson , `` scaling up mimo : opportunities and challenges with very large arrays , '' _ ieee sig .",
    "proc . mag .",
    "40 - 46 , jan . 2013 .",
    "d. kapetanovic , g. zheng , k .- k .",
    "wong , and b. ottersten , `` detection of pilot contamination attack using random training in massive mimo , '' in _ proc .",
    "ieee intern .",
    "personal , indoor and mobile radio commun .",
    "( pimrc ) _ , pp .",
    "13 - 18 , london , uk , sept . 2013 .",
    "j. zhang , r. w. heath jr . ,",
    "m. koutouris , and j. g. andrews , `` mode switching for mimo broadcast channel based on delay and channel quantization , '' _ eurasip journal on advances in signal processing _",
    "2009 , doi:10.1155/2009/802548 .",
    "h. gao , p. j. smith , and m. v. clark , `` theoretical reliability of mmse linear diversity combining in rayleigh - fading additive interference channels , '' _ ieee trans .",
    "666 - 672 , may 1998 ."
  ],
  "abstract_text": [
    "<S> in this paper , we consider physical layer security provisioning in multi - cell massive multiple - input multiple - output ( mimo ) systems . </S>",
    "<S> specifically , we consider secure downlink transmission in a multi - cell massive mimo system with matched - filter precoding and artificial noise ( an ) generation at the base station ( bs ) in the presence of a passive multi - antenna eavesdropper . we investigate the resulting achievable ergodic secrecy rate and the secrecy outage probability for the cases of perfect training and pilot contamination . </S>",
    "<S> thereby , we consider two different an shaping matrices , namely , the conventional an shaping matrix , where the an is transmitted in the null space of the matrix formed by all user channels , and a random an shaping matrix , which avoids the complexity associated with finding the null space of a large matrix . </S>",
    "<S> our analytical and numerical results reveal that in multi - cell massive mimo systems employing matched - filter precoding ( 1 ) an generation is required to achieve a positive ergodic secrecy rate if the user and the eavesdropper experience the same path - loss , ( 2 ) even with an generation secure transmission may not be possible if the number of eavesdropper antennas is too large and not enough power is allocated to channel estimation , ( 3 ) for a given fraction of power allocated to an and a given number of users , in case of pilot contamination , the ergodic secrecy rate is not a monotonically increasing function of the number of bs antennas , and ( 4 ) random an shaping matrices provide a favourable performance / complexity tradeoff and are an attractive alternative to conventional an shaping matrices .    physical layer security , massive mimo , multi - cell systems , ergodic secrecy rate , and pilot contamination . </S>"
  ]
}