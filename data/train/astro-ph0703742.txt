{
  "article_text": [
    "relativistic flow problems are important in many astrophysical phenomena including gamma - ray burst ( grb ) , active galactic nuclei ( agn ) , as well as microquasar and pulsar wind nebulae , among others .",
    "apparent superluminal motion is observed in many jets of extragalactic radio sources associated with agn . according to the currently accepted standard model ,",
    "this implies the jet flow velocities as large as @xmath0 of the speed of light @xcite .",
    "similar phenomena are also seen in microquasars such as grs 1915 + 105 @xcite and gro j1655 - 40 @xcite thus by similar arguments relativistic flows are thought to play a role . in the case of grb ,",
    "the observed non - thermal spectrum implies that the source must be optically thin , which can be used to put a limit on the minimum lorentz factor within those bursts @xcite .",
    "this argument shows that the source of grb must be in highly relativistic motion .",
    "this conclusion is further confirmed by the rapidly increasing number of grb afterglow observations by the swift satellite @xcite . to understand physical processes in those phenomena quantitatively , high resolution multi - dimensional simulations are crucial .",
    "jim wilson and collaborators pioneered the numerical solution of relativistic hydrodynamics equations @xcite .",
    "starting with these earliest papers this has typically been done in the context of general relativistic problems such as accretion onto black holes and supernovae explosions .",
    "the problem was recognized to be difficult to solve when the lorentz factor becomes large @xcite and a solution with an implicit adaptive scheme was demonstrated in one dimension .",
    "unfortunately , this approach is not generalizable to multi - dimensions .",
    "however , in the past two decades accurate solvers based on godunov s scheme have been designed that have adopted shock - capturing schemes for newtonian fluid to the relativistic fluid equations in conservation form ( for a review see * ? ? ?",
    "such schemes , called high - resolution shock - capturing ( hrsc ) methods , have been proven to be very useful in capturing strong discontinuities with a few numerical zones without serious numerical oscillations .",
    "we will discuss a number of them in section 3 .",
    "studies involving astrophysical fluid dynamics in general are benefiting tremendously from using spatial and temporal adaptive techniques",
    ". smoothed particle hydrodynamics @xcite is a classic example by being a lagrangian method .",
    "increasingly also variants of @xcite s structured adaptive mesh technique are being implemented .",
    "this is also true in relativistic hydrodynamics @xcite where certainly the work of @xcite showed that a serial amr code could solve problems even highly efficient parallel fixed grid codes would have difficulty with . in this paper",
    "we discuss our implementation of different hydrodynamics solvers with various reconstruction schemes as well as different time integrators on top of the _ enzo _ framework previously developed for cosmology @xcite .",
    "this new code we call _ r_enzo _ _ is adaptive in time and space and is a dynamically load balanced parallel using the standard message passing interface .    in the following we",
    "briefly summarize the equations being solved before we give details on the different solvers we have implemented .",
    "section  4 discusses the adaptive mesh refinement strategy and implementation .",
    "we then move on to describe various test problems for relevant combinations of solvers , reconstruction schemes in one , two and three dimensions , with and without amr .",
    "section  6 presents an application of our code to three - dimensional relativistic and supersonic jet propagation problem .",
    "section  7 discusses 3d grb jet simulation .",
    "we summarize our main conclusions in section  8 .",
    "the basic equations of special relativistic hydrodynamics ( srhd ) are conservation of rest mass and energy - momentum : @xmath1 and @xmath2 where @xmath3 is the rest mass density measured in the fluid frame , @xmath4 is the fluid four - velocity ( assuming the speed of light @xmath5 ) , @xmath6 is the lorentz factor , @xmath7 is the coordinate three - velocity , @xmath8 is the energy - momentum tensor of the fluid and semicolon denotes covariant derivative .    for a perfect fluid",
    "the energy - momentum tensor is @xmath9 where @xmath10 is the relativistic specific enthalpy , @xmath11 is the specific internal energy , @xmath12 is the pressure and @xmath13 is the spacetime metric .",
    "srhd equations can be written in the form of conservation laws @xmath14 where the conserved variable @xmath15 is given by @xmath16 and the fluxes are given by @xmath17    @xcite has shown that system ( [ 2.4 ] ) is hyperbolic for causal eos , i.e. , those satisfying @xmath18 where the local sound speed @xmath19 is defined as @xmath20.\\label{cs}\\ ] ]    the eigenvalues and left and right eigenvectors of the characteristic matrix @xmath21 , which are used in some of our numerical schemes , are given by @xcite .",
    "the conserved variables @xmath15 are related to the primitive variables by @xmath22 where @xmath23 .",
    "the system ( [ 2.4 ] ) are closed by an equation of state ( eos ) given by @xmath24 . for an ideal gas ,",
    "the eos is , @xmath25 where @xmath26 is the adiabatic index .",
    "we use method of lines to discretize the system ( [ 2.4 ] ) spatially , @xmath27 where @xmath28 refers to the discrete cell index in @xmath29 directions , respectively .",
    "@xmath30 , @xmath31 and @xmath32 are the fluxes at the cell interface .    as discussed by @xcite ,",
    "if using a high order scheme to reconstruct flux spatially , one must also use the appropriate multi - level total variation diminishing ( tvd ) runge - kutta schemes to integrate the ode system ( [ ode ] ) .",
    "thus we implemented the second and third order tvd runge - kutta schemes coupled with amr .",
    "the second order tvd runge - kutta scheme reads , @xmath33 and the third order tvd runge - kutta scheme reads , @xmath34 where @xmath35 is the final value after advancing one time step from @xmath36 .    for an explicit time",
    "integration scheme , the time step is constrained by the courant - friedrichs - lewy ( cfl ) condition .",
    "the time step is determined as @xmath37 where @xmath38 is a parameter called cfl number and @xmath39 is the local largest speed of propagation of characteristics in the direction @xmath40 whose explicit expression can be found in @xcite .      generally speaking , there are two classes of spatially reconstruction schemes ( see e.g. leveque 2002 ) .",
    "one is reconstructing the unknown variables at the cell interfaces and then use exact or approximate riemann solver to compute the fluxes .",
    "another is direct flux reconstruction , in which we reconstruct the flux directly from fluxes at the cell centers . to explore the coupling of different schemes with amr as well as exploring",
    "which method is most suitable for a specific astrophysical problem , we implement several different schemes in both classes .    to reconstruct unknown variables , we have implemented piecewise linear method ( plm , van leer 1979 ) , piecewise parabolic method ( ppm , colella & woodward 1984 , mart & mller 1996 ) , the third - order convex essentially non - oscillatory scheme ( ceno , liu & osher 1998 ) .",
    "these are used to reconstruct the primitive variables since reconstructing the conserved variables can produce unphysical values in srhd . furthermore , unphysical values of three - velocities may arise during the reconstruction especially for ultrarelativistic flows .",
    "so we either use @xmath41 to do the reconstruction or we also reconstruct the lorentz factor and use it to renormalize the reconstructed three - velocity when they are unphysical .    for direct flux reconstruction ,",
    "we have implemented plm and the third and fifth order weno scheme of @xcite .",
    "direct flux reconstruction using weno was first used to solve srhd problems by @xcite .",
    "they showed that the fifth order weno scheme works well with the third order runge - kutta time integration . in our implementation",
    ", we followed their description closely . for the plm and ceno schemes",
    ", we used a generalized minmod slope limiter @xcite . for given @xmath42 , @xmath43 , where @xmath44 . for @xmath45",
    "it reduces to the monotonized central - difference limiter of @xcite .",
    "we found that this generalized minmod slope limiter behaves much better than a traditional minmod limiter @xcite especially for strong shear flows . in our calculation , @xmath46 is used by default .",
    "for the ppm scheme , we used the parameters proposed by @xcite for all the test problems .",
    "for weno , we used the parameters suggested in the original paper of @xcite .      in the first class of reconstruction methods ,",
    "given the reconstructed left and right primitive variables at interfaces , the flux across each interface is calculated by solving the riemann problem defined by those two states .",
    "an exact riemann solver is quite expensive in srhd @xcite .",
    "thus we have implemented several approximate riemann solvers including hll @xcite , hllc @xcite , local lax - friedrichs ( llf , kurganov & tadmor 2000 ) and the modified marquina flux @xcite .",
    "the hllc scheme is an extension of the hll solver developed by @xcite for newtonian flow which was extended to two - dimensional relativistic flows by @xcite .",
    "the improvement of hllc over hll is restoring the full wave structure by constructing the two approximate states inside the riemann fan .",
    "the two states can be found by the rankine - hugoniot conditions between those two states and the reconstructed states . with this modification , hllc indeed behaves better than other riemann solvers in some 1d (   5.1.7 ) and 2d (   5.2 ) test problems .",
    "but when we apply hllc to three dimensional jet simulation , we found that hllc suffers from the so called  carbuncle \" artifact well - known in the computational fluid dynamics literature @xcite .",
    "we have used hllc to run many other two - dimensional test problems designed to detect the carbuncle artifact and confirmed this shortcoming .",
    "we found that the hllc solver is unsuitable for many multi - dimensional problems .",
    "the discussion of these problems will be presented elsewhere . in this work",
    ", we will only apply hllc to two test problems showing that the hllc solver has less smearing at contact discontinuities than other schemes .",
    "has compared the hll scheme , the llf scheme and the modified marquina flux formula using 1d and 2d test problems .",
    "they found those three schemes give similar results for all their test problems . in our tests , we found similar results .",
    "however , the modified marquina flux formula is not as stable as hll in problems with strong transverse flows and llf is more diffusive than hll .",
    "so in the following discussion we will only show the results using hll in most of the tests if there is no difference among those three schemes .    in the following discussion",
    ", we will denote a specific hydro algorithm by x - y where x is the flux formula and y is the reconstruction scheme .",
    "for example , f - weno5 denotes direct flux reconstruction using fifth order weno .",
    "we used the third order runge - kutta method for all the tests in this work .",
    "since primitive variables are needed in the reconstruction process , after every rk time step , we need to convert conserved variables to primitive variables . while conserved variables can be computed directly from primitive variables using eqs .",
    "( [ d ] ) , ( [ sj ] ) and ( [ tau ] ) , the inverse operation is not straightforward .",
    "one needs to solve a quartic equation for the ideal gas eos and a nonlinear equation for more complicated eos .",
    "iteration methods are used even for ideal gas eos , because computing the solution of a quartic is expensive .",
    "following @xcite , we have used a newton - raphson ( nr ) iteration to solve a nonlinear equation for pressure to recover primitive variables from conserved variables .",
    "typically , the nr iteration needs only @xmath47 to @xmath48 steps to converge .",
    "we have also implemented cylindrical and spherical coordinates following the description of zhang & macfadyen ( 2006 ) .",
    "this affects three parts of the code .",
    "firstly , the geometric factors are incorporated into the flux when updating the conserved variables .",
    "secondly , there will be geometric source terms .",
    "thirdly , the flux correction in amr (   4.4 ) is modified by geometric factors .",
    "structured adaptive mesh refinement ( amr ) was developed by @xcite and @xcite to achieve high spatial and temporal resolution in regions where fixed grid resolution is insufficient . in structured amr , a subgrid will be created in regions of its parent grid needing higher resolution .",
    "the hierarchy of grids is a tree structure .",
    "each grid is evolved as a separate initial boundary value problem , while the whole grid hierarchy is evolved recursively .    _",
    "r_enzo _ _ is built on top of the amr framework of _ enzo _ @xcite .",
    "_ enzo _ s implementation of amr follows closely the berger & colella paper and has been shown to be very efficient for very high dynamic range cosmological simulations ( see e.g. abel et al .",
    "the pseudocode of the main loop for the second order runge - kutta method reads , @xmath49    the rebuildhierarchy function called at the end of every time step is at the heart of amr .",
    "its pseudocode as implemented originally in _ enzo _ reads , @xmath50      when a new subgrid is created , the initial values on that grid are obtained by interpolating spatially from its parent grid . in this case , we apply the conservative second order order interpolation routine provided by _ enzo _ to conserved variables . but in this process sometimes the interpolated values can violate the constraint @xmath51 . if this happens , we will then use first order method for that subgrid .    before the first runge - kutta step for a grid at level @xmath52 ( in the following discussion",
    ", we use the convention that top grid has level @xmath53 ) , we will need the boundary condition at time @xmath54 , which is derived by interpolating from its parent grid .",
    "then at the later steps of runge - kutta scheme , one needs the boundary condition at time @xmath55 . since the variables of its parent grid has already been evolved to time @xmath56 , which is greater than time @xmath55",
    ", we can obtain the boundary conditions at time @xmath55 for a grid at level @xmath52 by interpolating both temporally and spatially from its parent grid .",
    "there are two exceptions to this procedure .",
    "first , if a cell of fine grid abuts the box boundary , then we just use the specified boundary condition for that cell .",
    "second , if a cell abuts another grid at the same level , we copy the value from that grid . because of the above mentioned problem for interpolating conserved variables , when interpolating boundary values , we apply the second order interpolation to primitive variables .",
    "since for ultrarelativistic flows spatially interpolating three - velocity can lead to unphysical values , we also interpolate the lorentz factor and then use it to renormalize the interpolated three - velocity .      in the test problems discussed in section [ sec : test ] , we mainly used two general purpose refinement criteria that have been widely used in amr code @xcite .",
    "in the first one , we compute the slope @xmath57 where @xmath58 is typically density , pressure and velocities , @xmath11 is a small number typically taken to be @xmath59 .",
    "when @xmath60 is larger than a minimum slope , typically @xmath61 , a cell will be flagged for refinement .    in the second one ,",
    "for every cell we compute @xmath62 which is the ratio of the second and first derivatives with a safety factor in the denominator .",
    "unless otherwise stated , we use @xmath63 .",
    "when @xmath64 is larger than a critical value @xmath65 , a cell will be flagged for refinement .",
    "typically we use @xmath66 .    to fully exploit amr ,",
    "it is desirable to design more specific refinement criterions that are most efficient for a specific astrophysical problems .",
    "when a cell is overlayed by a finer level grid , then the coarse grid value is just the conservative average of the fine grid values .",
    "on the other hand , when a cell abuts a fine grid interface but is not itself covered by any fine grid , we will do flux correction for that cell , i.e. we will use the fine grid flux to replace the coarser grid flux in the interface abutting the fine grid.(see berger & colella 1989 for more detailed description of flux correction ) . for this purpose , note that the second order runge - kutta method can be rewritten as @xmath67 and the third order runge - kutta method can be rewritten as @xmath68 thus for example , when we do flux correction in the @xmath69-direction for interface @xmath70 , we will use @xmath71 and @xmath72 to correct the coarser grid conserved variables for the second and third order runge - kutta method , respectively .      _",
    "r_enzo _ _ uses the _ enzo _ parallel framework which uses dynamically load balancing using the message passing interface ( mpi ) library . at run time",
    ", the code will move grids among processors according to the current load of every processor to achieve a balanced distribution of computational load among processors .",
    "the computational load of a processor is defined as the total number of active cells on that processor and level .",
    "relativistic riemann problems have analytical solutions @xcite , thus they are ideal for tesing srhd codes . in the following discussion , subscript @xmath73 and @xmath74 refer to the left and right initial states , respectively .",
    "the initial discontinuity is always at @xmath75 . we will report the error between numerical solutions and analytical solutions using @xmath76 norm defined as @xmath77 where @xmath58 is the numerical solution",
    ", @xmath78 is the analytical solution and @xmath79 is the cell width .      this test and the following one are fairly standard and all modern srhd codes can match the analytical solution quite well ( see martt & mller 2003 for a summary of different codes performance on those two tests ) .",
    "the initial left and right states for this problem are @xmath80 and @xmath81 , @xmath82 , @xmath83 .",
    "the gas is assumed to be ideal with an adiabatic index @xmath84 .",
    "the initial discontinuity gives rise to a transonic rarefaction wave propagating left , a shock wave propagating right and a contact discontinuity in between .",
    "this problem is only mildly relativistic with a post - shock velocity @xmath85 and shock velocity 0.83 .",
    "the results using four hydro solvers are shown in fig .",
    "[ fig : riemann1 ]",
    ". the cfl number used is @xmath86 .",
    "the @xmath76 errors are shown in fig .",
    "[ fig : l1_riemann1 ] , from which we can see the four schemes behave essentially identical for this problem .",
    "the order of global convergence rate is about 1 for all four schemes , which is consistent with the fact that there are discontinuities in the problem .",
    "the initial left and right states for this problem are @xmath87 and @xmath88 , @xmath89 , @xmath83 .",
    "the gas is assumed to be ideal with an adiabatic index @xmath84 .",
    "this test is more relativistic than the previous one . while the wave structure is the same , the thermodynamically relativistic initial left state gives rise to a relativistic shock propagating at a lorentz factor @xmath90 and a very thin dense shell behind the shock with width @xmath91 at @xmath92 .",
    "the cfl number used is @xmath86 .",
    "the results using four hydro algorithms are shown in fig .",
    "[ fig : riemann2 ] .",
    "the @xmath76 errors are shown in fig .",
    "[ fig : l1_riemann2 ] .",
    "we can see that for this problem ppm and weno have smaller @xmath76 errors than plm and ceno .",
    "this is due to their ability to better resolve the thin shell .",
    "the initial left and right states for this test are @xmath93 and @xmath94 , @xmath95 , @xmath96 .",
    "the gas is assumed to be ideal with an adiabatic index @xmath97 .",
    "this test mimics the interaction of a planar jet head with the ambient medium .",
    "the decay of the initial discontinuity gives rise to a strong reverse shock propagating to the left , a forward shock propagating to the right and a contact discontinuity in between .",
    "the results are shown in fig .",
    "[ fig : riemann3 ] .",
    "the cfl number is @xmath86 .",
    "the @xmath76 errors are shown in fig .",
    "[ fig : l1_riemann3 ] . as can be seen in figs .",
    "[ fig : riemann3 ] & [ fig : l1_riemann3 ] , for this problem ppm and weno behave better than plm and ceno : there is almost no oscillation behind the reverse shock and they capture the contact discontinuity with fewer cells .",
    "especially ppm captures the contact discontinuity with only @xmath98 cells and has the smallest @xmath76 error .      for this and the following two problems",
    ", we will consider non - zero transverse velocities in the initial states .",
    "the initial state is identical to blast wave problem ii except the presence of transverse velocities .",
    "those problems were first discussed analytically by @xcite . since",
    "then various groups have shown that when transverse velocities are non - zero , in some cases those problems become very difficult to solve numerically unless very high spatial resolution is used @xcite .",
    "in realistic astrophysical phenomena transverse velocities are usually very important ( see e.g. aloy & rezzolla 2006 ) , thus solving those problems accurately is of great importance .    as an easy first case",
    ", we will consider non - zero transverse velocity only in the low pressure region .",
    "the initial left and right states are @xmath99 and @xmath100 .",
    "the gas is assumed to be ideal with an adiabatic index @xmath101 .",
    "the results are shown in fig . [",
    "fig : transverse_c ] .",
    "the cfl number is @xmath86 .",
    "the @xmath76 errors are shown in fig .",
    "[ fig : l1_bt1 ] .",
    "we can see that all four hydro algorithms behaves similarly well , except that plm and ceno shows some small oscillations around the contact discontinuity .",
    "next , we consider non - zero transverse velocity in the high pressure region . in this case , the problem becomes more difficult to solve numerically @xcite .",
    "the initial left and right states for this problem are @xmath102 and @xmath103 .",
    "the gas is assumed to be ideal with an adiabatic index @xmath84 .",
    "the high pressure region is connected to the intermediate state by a rarefaction wave .",
    "since the initial normal velocity in the high pressure region is zero , the slope of the adiabat increases rapidly with transverse velocity , thus a large initial transverse velocity will lead to a small intermediate pressure and a small mass flux .",
    "the results using a uniform grid and two amr runs are shown in fig .",
    "[ fig : transverse_d ] .",
    "the hydro solver used for this figure is hll - plm .",
    "the cfl number is @xmath104 .",
    "the @xmath76 error are shown in fig .",
    "[ fig : l1_transverse_d ] .",
    "it can be seen that for the run with 400 uniform grid cells , the numerical solution is inadequate , as previously found by @xcite .",
    "this is mainly due to the poor capture of the contact discontinuity .",
    "we have tried to run this problem with various algorithms but only obtained accurate solutions by dramatically increasing the resolution .",
    "cccc 400 & 400 & 400 + 800 & 448 & 421 + 1600 & 455 & 442 + 3200 & 470 & 468 + 6400 & 501 & 473 + 12800 & 518 & 476 + 25600 & 562 & 520      now we introduce transverse velocity in both region .",
    "the initial left and right states for this problem are @xmath105 and @xmath106 .",
    "the gas is assumed to be ideal with an adiabatic index @xmath101 .",
    "this problem is more difficult than the previous one due to the formation of an extremely thin shell between the rarefaction wave tail and the contact discontinuity @xcite .",
    "the results with a uniform grid and two amr runs are shown in fig .",
    "[ fig : transverse_e ] .",
    "the hydro solver used for this run is hll - plm .",
    "the cfl number used is @xmath86 .",
    "the @xmath76 errors are shown in fig .",
    "[ fig : l1_transverse_e ] .    table 1 shows the equivalent resolution and the actual number of cells used for this and the previous tests .",
    "it can be seen for the highest resolution calculation our code uses about four hundred times less grid cells than the corresponding uniform grid calculation .",
    "thus amr allows us to achieve very high resolution while significantly reducing the computational cost .      for this test",
    "we set up a one - dimensional riemann problem that mimics the interaction of jet with an overpressured cocoon .",
    "the initial left and right states for this problem are @xmath107 and @xmath108 .",
    "the gas is assumed to be ideal with @xmath109 .",
    "those values mimic the conditions of the jet - cocoon boundary in model c2 of @xcite .",
    "the result using four different riemann solver with plm on uniform grid are shown in fig .",
    "[ fig : jetcocoon400 ] .",
    "it can be seen that solutions use hll , llf and direct flux reconstruction have large positive fluctuations in the normal velocity at the rarefaction wave .",
    "it is interesting to note that only hllc does not suffer from this shortcoming which is probably due to the ability of hllc to resolve the contact discontinuity compared to the other riemann solvers in the code .",
    "if those fluctuations also happen in higher dimensional jet simulation , then one would expect that the normal velocity fluctuation seen in this test would lead to an artificially extended cocoon .    in fig .",
    "[ fig : jet1d_amr ] the result of using hll - plm and hllc - plm with amr is shown .",
    "it can been seen that the fluctuation in the hll scheme becomes smaller with higher resolution .",
    "[ fig : l1_jet1d ] shows the @xmath76 error for those two schemes with different levels of refinement .      to test the code in higher dimension ,",
    "we first study the two - dimensional shock tube problem suggested by @xcite and latter also used by various groups ( see e.g. zhang & macfadyen 2006 , mignone & bodo 2005a , lucas - serrano et al .",
    "this test is done in a two - dimensional cartesian box divided into four equal - area - constant states : @xmath110 where ne means northeast corner and so on .",
    "the grid is uniform @xmath111 .",
    "the gas is assumed to be ideal with an adiabatic index @xmath109 .",
    "we use outflow boundary conditions in all four directions and the cfl number is @xmath86 .    the results are shown in fig .",
    "[ fig : shocktube ] for four schemes .",
    "this problem does not have analytical solutions to compare with , but comparing our result with other groups result shows good agreement .",
    "the cross in the lower left corners of ( a ) hll - plm and ( d ) f - weno is a numerical artifact due to the inability to maintain a contact discontinuity perfectly , which are absent in the results using the hllc solver ( c ) .",
    "this agreed with the result of @xcite that the hllc solver behaves better in this problem than other riemann solvers because of its ability of resolve contact discontinuities .",
    "we first study a test problem with uniform grid in cartesian coordinate that has been used by several groups to test the symmetric properties of a three - dimensional srhd code @xcite .",
    "the initial setup of this test consists of a cold spherical inflow with initially constant density @xmath112 and constant velocity @xmath113 colliding at the box center .",
    "this problem is run using three - dimensional cartesian coordinates so it allows one to evaluate the symmetry properties of the code @xcite . when gas collides at the center , a reflection shock forms . behind the shock",
    ", the kinetic energy will be converted completely into internal energy .",
    "thus the downstream velocity @xmath114 is zero and the specific internal energy is given by the upstream specific kinetic energy @xmath115 using the shock jump condition , the compression ratio @xmath116 and the shock velocity can be found to be @xmath117    in the unshocked region ( @xmath118 ) , the gas flow will develop a self - similar density distribution , @xmath119    the initial state are @xmath120 .",
    "we chose a small value for pressure because a grid - based code can not handle zero pressure .",
    "a cfl number @xmath121 is used for this problem , as other groups @xcite .",
    "we chose to use llf - plm for this problem because this turns out to be the most stable solver for this problem .",
    "[ fig : rssr_1d ] shows the one - dimensional cut though axis and diagonal direction and fig . [",
    "fig : rssr_2d ] shows a contour through @xmath122 plane , both at @xmath92 .",
    "it can be seen from those plots that our code keeps the original spherical symmetry quite well . since in a cartesian box the simple outflow boundary condition is inconsistent with the initial spherical inflow setup , we evolve this problem only to @xmath92 , at which point all the mass in the original box has just entered the shocked region ( see fig . [",
    "fig : rssr_1d ] ) . after that time",
    ", the evolution would be affected by the unphysical boundary condition .      in this test",
    ", we study a spherical blast wave in three - dimensional cartesian coordinates .",
    "there is no analytical solution for this problem .",
    "thus for the sake of comparison , we set up the same problem as other groups @xcite .",
    "the center of the blast wave source is located at the corner @xmath123 of the box .",
    "the initial conditions are @xmath124 where @xmath125 is the distance to the center @xmath126 .",
    "an ideal gas with an adiabatic index of @xmath109 is assumed .",
    "the left boundaries at x , y , z directions are reflecting while others are outflow . we use a top grid of @xmath127 zones with two more levels of refinement and a refinement factor of 2 for this calculation ( equivalent resolution @xmath128 ) .",
    "f - plm is used for the result shown and the cfl number is @xmath121 .    the results are given in fig .",
    "[ fig : blast3dcorner_1 ] which shows the cut along x - axis and diagonal direction . for comparison",
    ", we run a high resolution one - dimensional simulation using spherical coordinates .",
    "the three - dimensional run in cartesian coordinates agrees with the one - dimensional high resolution run .",
    "furthermore , it can be seen that the spherical symmetry of the initial condition is preserved rather well in the three - dimensional cartesian case .",
    "finally we study another blast wave problem for which the center of the blast wave source is located at the box center .",
    "this problem also does not have analytical solution but it has been studied by @xcite so our result can be compared to theirs .",
    "the initial conditions are @xmath129 an ideal gas eos with an adiabatic index of @xmath130 is used .",
    "we stop the run at @xmath131 , roughly the same ending time of @xcite .",
    "a top grid of @xmath132 zones with four levels of refinement and a refinement factor of two is used ( equivalent resolution @xmath133 ) .",
    "thus our resolution is roughly @xmath134 times of @xcite .",
    "we used hll - plm and a cfl number of @xmath86 for this calculation .",
    "[ fig : blast3d_1 ] plots the numerical solution for all cells centered on the highest level in the two dimensional slice at @xmath135 at @xmath136 as a function of radius from the center ( 0.5,0.5,0.5 ) .",
    "the position and amplitude of the high density shell agrees with the calculation of @xcite . and",
    "it can be seen that the spherical symmetry is preserved rather well in our code .",
    "having validated our code using various test problems , we can apply it to astrophysical problems .",
    "we will study two typical astrophysical relativistic flow problems in this work , agn jets and grb jets .",
    "both topics have been studied extensively with 2d simulations before , but very few 3d calculations have been done in both cases . consequently we will focus on 3d simulations here .    in this section ,",
    "we study a relativistic supersonic jet in three dimensions .",
    "we set up the problem using the same parameters as model c2 of @xcite .",
    "this model has also been studied in two dimensions by @xcite and in three dimensions by @xcite .",
    "the jet parameters are @xmath137 , @xmath138 and @xmath139 .",
    "the jet has a classical mach number @xmath140",
    "so the pressure is @xmath141 .",
    "the parameters for the medium are @xmath142 , @xmath143 and @xmath144 .",
    "the eos is assumed to be ideal with @xmath109 .",
    "the jet is injected from the low - z boundary centered at @xmath145 with radius @xmath146 .",
    "outflow boundary conditions are used at other part of the boundary .",
    "figure [ fig : jet ] shows the result at @xmath147 for the three runs : hll - ppm with three levels of refinement ( hll - ppm - l3 ) , hll - plm with three levels of refinement ( hll - plm - l3 ) and hll - plm with four levels of refinement ( hll - plm - l4 ) .",
    "the top grid resolution is @xmath132 zones .",
    "thus the first two runs have an equivalent resolution of @xmath128 zones while the last one has @xmath133 zones .",
    "for the first two , turbulence in cocoon is not fully developed so the cocoon is still symmetric even in 3d .",
    "the hll - ppm - l3 run has slightly more turbulent cocoon due to the higher spatial reconstruction order of ppm .",
    "thus the hll - ppm - l3 jet propagates slightly slower than the hll - plm - l3 jet . on the other hand , for the hll - plm - l4 jet ,",
    "the resolution is @xmath148 cells per beam radius , comparable to the resolution used in the two - dimensional study by @xcite .",
    "the cocoon turbulence is much more developed in this case , as in the 2d case @xcite .",
    "consequently , the hll - plm - l4 jet propagates slower than the two lower resolution ones .",
    "furthermore , the hll - plm - l4 case does not show axisymmetry because instability quickly develops in the lateral motion and consequently lateral motion also becomes turbulent .    since we found the jet - cocoon structure differs significantly at higher resolution run and consequently the jet propagation speed decreases ,",
    "we conclude that even at @xmath133 effective resolution of our three dimensional jet simulations the correct solution remains elusive .",
    "moreover , different solvers give disparate answers .",
    "the idea that  long - soft \" gamma - ray bursts are associated with the deaths of massive stars has been supported by various observations recently ( see e.g. woosley & bloom ( 2006 ) for a recent review ) .",
    "so it is of great interest to calculate how a relativistic jet propagate through and break out of a massive star .",
    "there has been extensive calculations in 2d recently @xcite .",
    "but very few 3d calculation have been reported in the literature so far .",
    "since there are significant turbulent motion and mixing in the jet - cocoon system in 2d calculation , it is important to model this process in 3d .",
    "we use the projenitor he16a of @xcite , which is a stripped - down helium core with initial mass @xmath149 m@xmath150 .",
    "[ star ] shows the density and pressure profiles for the progenitor model .",
    "the radius of the star at onset of collapse is @xmath151 cm . in our simulation , the mass inside @xmath152 cm",
    "is removed and replaced by a point mass of @xmath153 m@xmath150 .",
    "the jet has power @xmath154 erg s@xmath155 , initial lorentz factor @xmath156 , the ratio of its total energy ( excluding rest mass energy ) to its kinetic energy @xmath157 .",
    "this corresponds to a a jet with initial density @xmath158 g @xmath159 and pressure @xmath160 erg @xmath159 .",
    "the jet is injected parallel to the @xmath161 axis with an initial radius @xmath162 cm .",
    "those model parameters are similar to previous 2d calculations @xcite .",
    "we use a simulation box of @xmath163 cm in order to follow the propagation of the jet after break out .",
    "we use hll - plm as this should be the most stable and reliable scheme to carry out resolution study .",
    "the top grid resolution is @xmath127 .",
    "we run the simulation using both 4 and 5 refinement levels , which correspond to resolution of 5.6 and 11 cells per jet beam radius , respectively . in order to always have high resolution for the jet material , we designed a color field refinement strategy in addition to the standard refinement criterion designed for discontinuities .",
    "more specifically , we use two color fields to keep track of the injected jet material and the stellar material . those two color fields give us a fraction of jet material at every cell .",
    "then whenever a cell contains more than 0.1 percent of jet material , we flag that cell for refinement .",
    "this ensures that we also have high resolution when mixing between jet material and star material happens .",
    "the results for those two runs are show in fig .",
    "[ grbjet ] .",
    "it can been seen that the high resolution run gives qualitatively different jet dynamics .",
    "while in the low resolution run the jet break out of the star successfully , in the high resolution run the jet head bifurcate at the stellar edge .",
    "interestingly , this behavior has also been seen in 2d calculation @xcite .",
    "but since we did not get convergent behavior so far , we can not conclude at this stage whether this behavior is physical or purely numerical .",
    "however , it is safe to conclude that much higher resolution will be needed to model the jet break out in 3d .",
    "in this paper , we have described a new code that solves the special relativistic hydrodynamics equations with both spatially and temporally adaptive mesh refinement .",
    "it includes direct flux reconstruction and four approximate riemann solvers including hllc , hll , llf and modified marquina flux formula .",
    "it contains several reconstruction routines : plm , ppm , third order ceno , and third and fifth order weno schemes .",
    "a modular code structure makes it easy to include more physics modules and new algorithms .    from our test problems and two astrophysical applications ,",
    "it is clear that relativistic flow problems are more difficult than the newtonian case .",
    "one key reason is that in the presence of utrarelativistic speed , nonlinear structures such as shocked shells are typically much thinner and thus requires the use of very high spatial resolution .",
    "srhd problems also become difficult to solve accurately when significant transverse velocities are present in the problem as we have shown using several one dimensional problems .",
    "one reason for this difficulty is that in srhd velocity components are coupled nonlinearly via the lorentz factor . in studying astrophysical jet problems ,",
    "we have demonstrated the need of both high resolution achievable only through amr and careful choice of hydrodynamic algorithms .",
    "in addition to validate our amr code , the most important implications of the calculations we have done is that _ in relativisitic flow simulations , resolution studies are crucial_.    we thank greg bryan and michael norman for sharing _ enzo _ with the astrophysical community",
    "without which this study could have not been carried out .",
    "we would also like to thank miguel aloy for very helpful comment on the draft , roger blandford and lukasz stawarz for helpful discussions .",
    "furthermore , we also thank ralf kehler for help with optimizing the code and slac s computing servers for maintaining an sgi altix super computer on which the reported calculations were carried out .",
    "this work was partially supported by nsf career award ast-0239709 and grant no . phy05 - 51164 from the national science foundation .",
    "w. acknowledges support by the stanford graduate fellowship and kitp graduate fellowship .",
    "w. z. has been supported by nasa through chandra postdoctoral fellowship pf4 - 50036 awarded by the _ chandra x - ray observatory _ center , and the doe program for scientific discovery through advanced computing ( scidac ) .",
    "oshea , b.  w. , bryan , g. , bordner , j. , norman , m.  l. , abel , t. , harkness , r. , & kritsuk , a.2004 , in `` adaptive mesh refinement - theory and applications '' , eds .",
    "t. plewa , t. linde & v. g. weirs , springer lecture notes in computational science and engineering , 2004"
  ],
  "abstract_text": [
    "<S> astrophysical relativistic flow problems require high resolution three - dimensional numerical simulations . in this paper </S>",
    "<S> , we describe a new parallel three - dimensional code for simulations of special relativistic hydrodynamics ( srhd ) using both spatially and temporally structured adaptive mesh refinement ( amr ) . </S>",
    "<S> we used the method of lines to discretize the srhd equations spatially and a total variation diminishing ( tvd ) runge - kutta scheme for time integration . for spatial reconstruction </S>",
    "<S> , we have implemented piecewise linear method ( plm ) , piecewise parabolic method ( ppm ) , third order convex essentially non - oscillatory ( ceno ) and third and fifth order weighted essentially non - oscillatory ( weno ) schemes . </S>",
    "<S> flux is computed using either direct flux reconstruction or approximate riemann solvers including hll , modified marquina flux , local lax - friedrichs flux formulas and hllc . </S>",
    "<S> the amr part of the code is built on top of the cosmological eulerian amr code _ enzo_. </S>",
    "<S> we discuss the coupling of the amr framework with the relativistic solvers . via various test problems , </S>",
    "<S> we emphasize the importance of resolution studies in relativistic flow simulations because extremely high resolution is required especially when shear flows are present in the problem . </S>",
    "<S> we also present the results of two 3d simulations of astrophysical jets : agn jets and grb jets . </S>",
    "<S> resolution study of those two cases further highlights the need of high resolutions to calculate accurately relativistic flow problems . </S>"
  ]
}