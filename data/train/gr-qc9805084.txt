{
  "article_text": [
    "spherically symmetric systems have deserved a lot of interest since the early stages of numerical relativity . in the pioneering work of may and white@xcite",
    ", the evolution of a self - gravitating spherical star was modelled by coupling the hydrodynamical equations with two first integrals of einstein field equations : the energy and momentum constraints .",
    "these are two ordinary differential equations , which in spherical symmetry are enough to determine the evolution of the whole metric .",
    "the validity of this approach , however , is restricted to the spherical case , because in more general situations these first integrals are not enough to determine the solution of einstein field equations .",
    "furthermore , even in the spherical case , the treatment of boundary conditions with this system is known to be rather difficult .",
    "the latter is especially dangerous in systems with outgoing matter or radiation , which need to be carefully dealt with .",
    "the alternative approach is to couple the hydrodynamical equations with the full set of einstein partial differential equations . in that way one must evolve both the hydrodynamical quantities and the spacetime metric on the same footing .",
    "the resulting formalism can then be extended in principle to axially symmetric ( 2d ) or even completely general situations . in the spherically symmetric case , however , the major drawback of this approach is not just the higher number of metric quantities to compute .",
    "it is rather the fact that the spherical coordinate system is singular at the origin , even when the spacetime itself is regular .",
    "the region close to the center of symmetry poses serious problems to numerical codes , which are to be overcome by using special techniques like artificial viscosity or algorithm matching . in most cases ,",
    "this is usually done by trial and error and , together with the treatment of the outer boundary , becomes the main limiting factor when constructing finite difference codes .",
    "the purpose of this paper is to present a new way of writing the full set of einstein equations in spherical symmetry ( with a matter content ) , which takes advantage of some redundant quantities that appear in recent hyperbolic formulations of numerical relativity  @xcite , in order to solve this problem . in that way",
    ", one will be able to treat the center region with exactly the same numerical algorithms as any other region of the numerical grid , with a significative reduction of the time devoted to code development .",
    "the same formalism also allows us to impose more accurate external boundary conditions , related to the physics of the problem .",
    "the combination of these two improvements ( center and boundary treatment ) helps in increasing the algorithm stability and maintaining the required accuracy .",
    "as far as tested , the resultant code does not show any stability problem , even after very long runs .",
    "we will work out the description of the method through the case of a complex massive scalar field describing a radiating boson star , where we easily reproduce previous results from other authors@xcite .",
    "the object of numerical relativity is to solve the einstein equations @xmath0 in an approximate way .",
    "this is necessary when we deal with some of the most interesting systems in astrophysics : black holes , neutron stars , close binaries , supernovae , etc .",
    "+ @xmath1 is the einstein tensor associated to a certain spacetime ( represented by a metric @xmath2 ) , @xmath3 is the gravity constant and @xmath4 is the momentum - energy tensor describing matter in this spacetime .",
    "+ the metric element can be written , in normal coordinates , as @xmath5 where @xmath6 is the space metric and @xmath7 is the lapse , a gauge degree of freedom .",
    "+ the einstein system ( [ eq.einstein ] ) is constituted by 10 coupled second order partial differential equations , when written in terms of the 4-dimensional metric @xmath2 .",
    "six of them are evolution equations and the four remaining are constraint equations  @xcite .",
    "+ we deal with spherical symmetry problems , so the system reduces to a one - dimensional ( 1d ) problem . in spherical coordinates , ( [ metrica ] )",
    "is written @xmath8 where @xmath9 .",
    "+ the einstein system can be written in first order form by introducing new variables . for simplicity , we will use the vacuum equations to illustrate our procedures . following  @xcite",
    ", we will express it as it follows : @xmath10 @xmath11 @xmath12      \\right ) \\;,\\\\",
    "\\label{old_c}\\ ] ] @xmath13\\right )   =   0 \\;,\\\\         \\label{old_lr}\\ ] ] @xmath14 @xmath15 @xmath16 \\;,\\\\       \\label{old_vr}\\ ] ] @xmath17\\right ) = \\nonumber\\\\         & -&c \\biggl(1/2\\;q^\\theta{}_\\theta(q^r{}_r - q^\\theta{}_\\theta )               -\\frac{g_{rr } } { g_{\\theta\\theta}}\\nonumber\\\\         & + & l_r\\;d_{r\\theta}{}^\\theta             + 1/4[(q^\\theta{}_\\theta)^2-(d_{r\\theta}{}^\\theta)^2 ] \\biggr ) \\ ; ,         \\label{old_qrr}\\end{aligned}\\ ] ] @xmath18\\right ) = \\nonumber\\\\       & - & c \\biggl(1/2\\;q^\\theta{}_\\theta(q^\\theta{}_\\theta - q^r{}_r )            + \\frac{g_{rr } } { g_{\\theta\\theta } } \\nonumber\\\\      & - & l_r\\;d_{r\\theta}{}^\\theta          + 1/4[(q^\\theta{}_\\theta)^2-(d_{r\\theta}{}^\\theta)^2 ] \\biggr ) \\ ;       \\label{old_qzz}\\end{aligned}\\ ] ] where we have defined @xmath19 , @xmath20 , @xmath21 , @xmath22 , @xmath23 ( speed of light ) , @xmath24 and @xmath25 . also , allowing for the momentum constraint , @xmath26 .",
    "+ note that we have written the einstein system as a first order balance law system .",
    "the variable @xmath27 is redundant : it was introduced with the purpose of making the system hyperbolic , which allows us to directly deal with diagonalized variables with a well - defined speed and sense of propagation ( very useful when imposing boundary conditions , as we will see later ) .",
    "the function @xmath28 determines the gauge .",
    "we have chosen the gauge degree of freedom @xmath7 to follow the harmonic slicing  @xcite , which is the simplest choice ( @xmath29 ) and good enough for singularity - free spacetimes .",
    "due to spherical symmetry @xmath30 has a strong geometrical factor : it is proportional to @xmath31 when @xmath32 .",
    "it follows that both @xmath33 and @xmath27 are proportional to @xmath34 , a singular behaviour at the origin .",
    "+ simulations dealing directly with these equations , or equivalent ones , are extremely unstable .",
    "this is well - known and some alternatives are usually taken . in previous works dealing with black holes ,",
    "the problem was avoided by putting internal boundary conditions at the apparent horizon . in this way the grid was cut at the apparent horizon , far enough from both the physical and coordinative singularity at @xmath35 .",
    "the problem is completely different when we deal with singularity - free systems ( stars ) .",
    "there , there is no way of cutting the solution before @xmath35 without loosing physically relevant information .",
    "the coordinative singularity at @xmath35 turns up as a big danger for accuracy and stability near the origin when using the standard system ( [ old_gzz]-[old_qzz ] ) .",
    "+ the first step for dealing with this is to analytically extract the geometrical factors , as far as possible , from the equations , so they only deal with the regular part .",
    "this is done by writing the line element as @xmath36 so that the system , in our particular case , is rewritten with @xmath37 , @xmath38 , @xmath39 .",
    "the new equations read @xmath40 @xmath41 @xmath42    this is yet an improvement because the evolved quantities @xmath43 and @xmath44 are now regular at the center . but further improvement should be achieved , provided we want to deal with a stable code , because rewriting ( [ old_gzz]-[old_qzz ] ) with ( [ new_metrik ] ) introduces explicit @xmath34 factors in the terms containing space derivatives ( flux terms ) and @xmath45 factors show up in the right hand side ( source terms ) of equations ( [ old_qrr ] ) and ( [ old_qzz ] ) .",
    "we have somehow explicitly segregated the geometrical term , but it is still not out of the system .",
    "now we can appreciate the kind of error that is introduced : both fluxes and sources are singular due to @xmath34 and @xmath45 terms and exact cross - cancellation is needed between them to keep the system regular .",
    "however , this is not achieved by the finite difference algorithm due to the truncation error when calculating the space derivatives of the fluxes .",
    "the truncation error when computing a given variable with a second order code is proportional to @xmath46 , where @xmath47 is the distance between neighbouring points in the grid .",
    "the terms @xmath34 in the fluxes give errors like @xmath48 .",
    "where @xmath32 ( @xmath49 ) the code does not converge .",
    "+ as a particular instance we tried to solve the boson star 1d problem @xcite by using these modified quantities .",
    "the numerical truncation error caused an instability that prevented us from obtaining any meaningful result before the code crash .",
    "+ these are well - known regularization techniques to handle this problem . in the next section",
    ", however , we present a new approach which regularizes the equations in a deeper way . +",
    "our proposal goes beyond the standard regularization procedures and succeeds in removing the most dangerous remaining @xmath34 factors .",
    "we take advantage from the way in which the momentum constraint was used to build the system ( [ old_gzz]-[old_qzz ] ) .",
    "remember that the variable @xmath27 is redundant and it was introduced with the objective of making the system hyperbolic  @xcite . as said , in ( [ old_gzz]-[old_qzz ] ) the momentum constraint is satisfied if and only if @xmath50 .",
    "we can monitorize the level of violation of the momentum constraint by testing this algebraic identity through the evolution .",
    "+ from the considerations of the preceding section , it will be natural to evolve instead of @xmath27 the regular quantity @xmath51 .",
    "but it turns out to be more convenient to define instead @xmath52 which is also regular ( provided that @xmath53 as @xmath31 , which demands smooth initial data near the origin ) and removes both the @xmath34 terms in the fluxes and the @xmath45 terms in the sources .",
    "the singularities have now disappeared from all the evolved variables as well as the numerical error caused by the incomplete cross - cancellation between fluxes and sources .",
    "+ the modified equations are @xmath54 @xmath55 @xmath56 there is still a point to be taken into account . in eqs .",
    "( [ mod_qrr]-[mod_qzz ] ) the sources contain terms like @xmath34 times @xmath57 , @xmath58 or other variables that are radial derivatives of the metric coefficients .",
    "these terms do not pose any problem as @xmath32 , as radial derivatives of any differentiable function vanish at the origin .",
    "however , in the finite difference approach , we can not put a grid point at @xmath35 due to the explicit @xmath34 factors .",
    "we will therefore place the first grid point at @xmath59 . with this new way for writing the einstein equations in spherical symmetry we are able to evolve the whole grid , without needing to apply special techniques or different algorithms to the center region .",
    "the equations are now intrinsically stable and can be directly coded .",
    "we have applied this idea ( [ vrtilde ] ) to a boson star model  @xcite .",
    "mathematically , the system is constituted by the einstein equations plus the klein - gordon ones .",
    "it has stable configurations known as boson stars , which determine a mass - radius curve , as in the neutron star case , with a local maximum for the star masses .",
    "+ the stars located at the left ( s - branch ) from this maximum ( small radius ) are known to be stable against small perturbations .",
    "the stars at the right ( u - branch ) are , on the other hand , unstable .",
    "an u - branch star , when perturbed can migrate towards a stable configuration in the s - branch .",
    "the migration produces strong periodical oscillations in the star radius around the final position , as well as scalar field radiation .",
    "+ we tested our equations against this phenomenon",
    ". we could not evolve the system with ( [ old_gzz]-[old_qzz ] ) far enough to measure any relevant physical quantity . with ( [ old_grr]-[old_lr ] , [ mod_gzz]-[mod_trd ] , [ mod_vr]-[mod_qzz ] ) , we have been able to reproduce the migration and the complex behaviour of its stationary states , with run time just limited by the required accuracy and not by algorithm stability , which is not easily achieved with the alternative formulation .",
    "we have to point out that part of the success comes from the hyperbolic balance law formulation itself , by allowing more physically consistent external boundary conditions . in the next section",
    "we go further in that point . in figure 1",
    "we show the migration from an unstable configuration to a stable one  @xcite . with the original form of ( [ old_gzz]-[old_qzz ] )",
    "we were unable to see nor half an oscillation .",
    "we illustrate the method for boundary conditions by describing the treatment of the klein - gordon equations in our example system .",
    "+ let s take a look at the equation for the real part , @xmath60 , of the klein - gordon field ( @xmath61 , in tensor form ) : @xmath62\\end{aligned}\\ ] ] where @xmath63 , @xmath64 .",
    "these equations , like the rest of the system , are written in balance law form .",
    "the flux terms are those that would appear in a flat space wave equation ( transport terms ) .",
    "the @xmath65 term in the right hand side is an oscillatory term which comes from the @xmath66 in the klein - gordon equation .",
    "the rest of the source terms are due to spherical coordinates and the coupling between the klein - gordon field and the spacetime metric .",
    "+ to put a condition over the transport terms would be quite easy , but the combination with the source terms makes the problem more difficult .",
    "what one would like to do is to treat separately each term of the equation .",
    "fortunately , this is possible in a numerical code , by using the operator splitting approach . with",
    "the strang splitting ( second order operator splitting ) each step in the numerical evolution can be decomposed in the following way : @xmath67 the whole step , @xmath68 , is split into three sequential processes .",
    "the first one is @xmath69 .",
    "there we evolve during half a step only the source terms in the equations .",
    "if we restrict to the klein - gordon part , we have : @xmath70\\end{aligned}\\ ] ] this is an ordinary differential equation system for each point in the net . in this part",
    "there is no connection between points .",
    "each point evolves by itself .",
    "so we do not have to state any boundary condition in this substep .",
    "+ in the second substep , @xmath71 , we only evolve the transport part ( during a whole time step ) , so we have @xmath72 the remaining terms here are the wave equation - like ones . we know that the solution is formed by two components ( @xmath73 and @xmath74 ) , which propagate in opposite senses at speed @xmath75 ( in general we need the matter part to be written in hyperbolic form , so it can be diagonalized ) .",
    "+ now here is where we need to put a boundary condition .",
    "what we want is : first , the outgoing component not to be touched ; any condition over it would be superfluous or contradictory .",
    "simply let it go out .",
    "second , as we suppose that there is no scalar field outside the net , nothing is coming in ( we disregard nonlinear effects between outgoing radiation and external metric ) , so the boundary condition to impose is simply @xmath76 the third step is again @xmath69 . + this is all .",
    "the only boundary condition we need to put is ( [ bound ] ) , which is very simple indeed .",
    "remember that there is not gravitational radiation in spherical symmetry .",
    "the momentum constraint plus the coordinate gauge condition fully determine the remaining ( metrical ) part of the boundary conditions .",
    "note that the relation of @xmath77 with @xmath27 holds when the momentum constraint is satisfied , so we can use the computed values of @xmath27 at the boundary to obtain the value of the incoming non - gauge field there .",
    "the stability and accuracy near the origin of spherically symmetric dynamical systems in numerical relativity is strongly improved by a new formalism which provides an automatic care - free treatment of the geometrical factors arising from spherical symmetry .",
    "these treatment involves making use of the redundant variable @xmath27 , previously introduced for other purposes ( to ensure the hyperbolicity of the system ) .",
    "the same formalism also allows boundary treatment based on physical considerations and helps in increasing accuracy and stability .",
    "that is , the same characteristic of our system , i.e. the introduction of the new quantity @xmath27 , allows us to simultaneously improve the treatment of the two main problems in spherically symmetric star - like systems : the center ( through a redefinition of @xmath27 , which brings the system to a regular form ) and the boundary ( through hyperbolicity achieved thanks to @xmath27 , which lets us distinguish between incoming and outcoming fields and treating them according to physical criteria ) .",
    "we have started from equations ( [ old_gzz]-[old_qzz ] ) , which are just the 1d version of a general 3d system  @xcite which is actually being applied in multidimensional numerical relativity .",
    "our point is that this system , when rearranged to deal with the geometrical factors , works fine in the 1d case .",
    "+ we are presently considering the axially symmetric case ( 2d ) , where again the redundant quantities @xmath78 could be helpful to get rid of the geometrical factors that arise from the coordinate singularity at the symmetry axis .",
    "but this is still an open question . +",
    "this work is supported by the direccin general para investigacin cientfica y tcnica of spain under project pb94 - 1177 and the conselleria deducaci , cultura i esports of the govern balear under grant of kind a7 .",
    "may and r.h .",
    "white , phys . rev .",
    "* 141 * , 1232 ( 1966 ) . c.  bona and j.  mass , phys .",
    "68*,1097 ( 1992 ) c.  bona , j.  mass , e.  seidel and j.  stela , phys .",
    "lett . * 68*,1097 ( 1992 ) e.  seidel and w.m .",
    "suen , phys .",
    "42*,384 , ( 1990 ) a.  lichnerowicz , ( 1944 ) : j. math .",
    "pures appl . *",
    "23 * , 37 .",
    "y.  choquet - bruhat , ( 1962 ) : in _ gravitation : an introduction to current research _ ,",
    "l.  witten ( wiley , new york ) .",
    "r.  arnowitt , s.  deser and c.  w.  misner , ( 1962 ) : in _ gravitation : an introduction to current research _ , ed .",
    "l.  witten ( wiley , new york ) . c.  bona and j.  mass , phys .",
    "d * 38*,2419(1988 ) see , for instance , numerical recipes in c , press , flannery , teukolsky and vetterling ( cambridge u.p . , 1988 )"
  ],
  "abstract_text": [
    "<S> instabilities in finite difference codes due to the singularity of spherical coordinates at the center are studied . in typical numerical relativity applications , standard regularization techniques by themselves </S>",
    "<S> do not ensure long term stability . a proposal to remedy that problem </S>",
    "<S> is presented , which takes advantage of redundant quantities introduced in recent hyperbolic formulations of einstein s evolution equations . </S>",
    "<S> the results are discussed through the example case of a boson star , where a significant improvement in the implementation of boundary conditions is also presented . </S>"
  ]
}