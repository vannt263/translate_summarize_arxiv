{
  "article_text": [
    "when modeling photonic crystals ( pcs ) , it is important to consider all the relevant bloch modes .",
    "light at a fixed frequency , polarization , and incident angle exists in a pc as a superposition of a set of propagating and evanescent bloch modes , the pc s eigenstates . at low frequencies ,",
    "only one mode generally needs to be considered . for light at frequencies above the first wood anomaly @xcite , each row of holes in the pc diffracts light into several propagating orders , so the pc may support multiple propagating bloch modes . at the pc s front and back interfaces , some of its modes couple via reflection , affecting the overall reflection and transmission through the pc , so it is important to model all relevant modes .",
    "it is often important to include evanescent modes @xcite .",
    "if the pc is not long  for example , if it is a layer in a thin antireflection coating  then evanescent modes can play a role in energy transport @xcite .",
    "evanescent modes can also play a role in field matching across an interface between pcs @xcite or pc waveguides @xcite .",
    "the propagative qualities of an evanescent mode are well - represented by its complex band structure @xcite , which augments the traditional band structure , conveying information about the rate at which the mode accumulates phase together with information about the mode s decay rate .",
    "there have been a number of studies seeking to derive impedance - like quantities to characterize reflection at pc interfaces by a scalar @xcite .",
    "furthermore , a number of studies have adapted metamaterial parameter extraction techniques @xcite to photonic crystals , and used them to design antireflection coatings @xcite . however , since these techniques characterize reflection and transmission by a single complex number each , they can not handle problems involving multiple modes , where every mode reflects into every other mode .",
    "scalar - based methods generally give manifestly incorrect results for light at frequencies above the first wood anomaly , which ranges from @xmath0 for normally incident light to @xmath1 for light at the brillouin - zone edge , where @xmath2 is the length of the lattice vector parallel to the interface , @xmath3 is the free space wavelength and @xmath4 is the pc s background index . above this frequency ,",
    "generally several bloch modes must be simultaneously considered in each pc , regardless of whether these modes are propagating or evanescent .",
    "reflection at a pc / pc interface is well - described by a matrix that maps incident modes to reflected modes , as we have shown previously @xcite . in our experience , the minimum acceptable dimension of this reflection matrix , as argued in sec .",
    "[ sub : background_theory ] , is usually @xmath5 where @xmath6 is the incident angle from a uniform dielectric with the pc s background index , and @xmath7 denotes the _ floor _ of @xmath8 .",
    "we have previously achieved accurate results modeling pc stacks using impedance matrices of this dimension and higher @xcite .    a number of methods for finding multiple bloch modes and complex band structures have been demonstrated .",
    "transfer - matrix @xcite and scattering - matrix @xcite based methods were developed to derive a pc s bloch modes from the properties of a single grating layer .",
    "the plane wave expansion method has also been extended to include evanescent modes @xcite . finally , ha _ et al .",
    "_ presented a method for extracting bloch modes from the output of an em solver @xcite , or even near - field measurements @xcite .",
    "we improve the accuracy , stability and efficiency of ha _ et al . _",
    "s method and extend it to calculate pc impedances for two - dimensional ( 2d ) pcs , which can be used to calculate reflection and transmission at interfaces @xcite .",
    "these pc impedances and the reflection and transmission operators are represented by matrices ; our method supports the presence and interaction of multiple bloch modes and so it can work well both above and below the first wood anomaly .",
    "we have made software available that uses the method described in this paper to calculate pcs bloch modes , complex band structures , and impedances .",
    "the software , called blochcode , can then use these complex band structures and impedances to calculate reflection and transmission matrices and coefficients for arbitrary stacks of pcs .",
    "blochcode is open - source and is available on the internet @xcite .    in sec .",
    "[ sec : theory ] , we present our method for finding bloch modes from the electric field @xmath9 and the magnetic field @xmath10 in a pc structure . sec .",
    "[ sub : background_theory ] recaps some useful results from our previous work @xcite and provides some background theory . sec .",
    "[ sub : finding_modes ] details our improvements to ha _ et al .",
    "_ s method @xcite of finding bloch factors and modal fields , and sec .",
    "[ sec : numerical_procedure ] outlines our procedure for successfully applying this method to minimize the residual derived in sec .",
    "[ sub : finding_modes ] . sec .",
    "[ sub : calculating_impedance ] explains how we calculate pc impedance matrices from the modal fields . in sec .",
    "[ sec : application ] we apply our method to demonstrate its utility . in sec .",
    "[ sub : complex_band_structure ] we calculate the complex band structure for light normally incident on a triangular lattice pc . in sec .",
    "[ sub : oldcoating ] we reproduce the design process of a known antireflection coating for a pc , at a frequency and incident angle for which it is critical to include at least two bloch modes in the calculations . finally , in sec .",
    "[ sub : park_coating ] we use our method to design an all - polarization antireflection coating for a square lattice self - collimating pc , at a high frequency where a scalar method can not find a coating for the pc @xcite .",
    "our method uses a two - step process to extract a pc s modes and impedance from the field in a finite length of the pc .",
    "the pc is assumed to be two - dimensional , lossless , and to have relative permeability @xmath11 .",
    "like ha _ et al . _",
    "s method @xcite , we could use data generated by fem or fdtd simulations , or even experimentally measured by a near - field probe such as a snom @xcite , although the impedance part of our method is not valid for snom data , which is derived from a 3d object .",
    "first , the bloch factors and the bloch modal fields are found ( sec .",
    "[ sub : finding_modes ] ) , then these modes are analyzed to calculate the pc s impedance ( sec .",
    "[ sub : calculating_impedance ] ) .",
    "two - dimensional pcs in the @xmath12 plane may be described as a stack of gratings parallel to the @xmath8 axis @xcite , each of which diffracts incident light into an infinite set of grating orders . at the edge of each unit cell",
    ", the pc s bloch modes may be written as a superposition of the underlying grating orders @xcite .",
    "their directions are given by the grating equation @xmath13 where @xmath14 is the @xmath8 component of the incident plane wave s wavevector , @xmath15 is that of the @xmath16th diffraction order , and @xmath2 is the length of the lattice vector parallel to the @xmath8-axis .",
    "the wavevector component in the direction perpendicular to the grating is @xmath17 where @xmath18 is the wavenumber in the medium .",
    "evanescent grating orders have imaginary @xmath19 , so for a given @xmath18 and @xmath15 , the number of propagating grating orders is the number of solutions to eq .   with real @xmath19 , or @xmath20 in eq .  .",
    "in our experience , @xmath20 also provides an upper bound on the number of propagating bloch modes , and at non - normal incidence is a lower bound on the number of bloch modes required to model a pc accurately . at normal incidence , symmetry allows odd modes to be ignored , so in this case good results may be obtained with fewer than @xmath21 modes  see sec .",
    "[ sub : park_coating ] . using bloch modes found from accurate multipole and fem transfer matrix methods @xcite , we have consistently had success modeling pcs with no more than @xmath22 bloch modes .",
    "bloch s theorem relates the electric and magnetic fields associated with each mode at equivalent points in different unit cells of a pc .",
    "the ratio of each mode s field at points separated by the lattice vector @xmath23 is @xmath24 . for the pc s other lattice vector @xmath25",
    ", this ratio is different for each mode and is the mode s bloch factor , denoted by @xmath26 .",
    "calculating @xmath26 for each mode is the goal of sec .",
    "[ sub : finding_modes ] . for square and rectangular lattices , @xmath27 and @xmath28 , where @xmath29 is the @xmath30 component of the mode s wavevector . for triangular lattices ,",
    "the lattice vector @xmath25 is @xmath31 and so the bloch factor may be written @xmath32 .",
    "bloch modes come in forward / backward pairs .",
    "_ provide a useful discussion of symmetry properties @xcite .",
    "we assume mirror symmetry in each unit cell , which means that each backward mode s field profile in a unit cell is the reflection on the @xmath8-axis of its forward partner s .",
    "the bloch factors of a pair are related because of this : for square and rectangular lattices , @xmath33 , where @xmath34 and @xmath35 are respectively the bloch factors of the forward and backward modes . for triangular - like lattices ,",
    "the symmetry is more complicated since the reflection of @xmath25 is not @xmath36 , the translation corresponding to the field ratio @xmath37 , but @xmath38 ; these vectors differ by @xmath39 . accounting for this discrepancy , we find @xmath40 for triangular lattices .    a pc s impedance is defined in terms of two matrices , @xmath41 and @xmath42 @xcite . for @xmath43",
    "polarized light , each matrix maps a vector of forward bloch mode amplitudes @xmath44 to a vector of the @xmath45 or @xmath46 fields associated with each grating diffraction order .",
    "specifically , @xmath47 , the @xmath48th element of @xmath41 , is the @xmath45 field of normalized mode @xmath49 due to forward and backward plane waves in grating order @xmath16 , at the centre ( @xmath50 ) of a unit cell s edge .",
    "thus , for a set of forward propagating / decaying bloch modes @xmath44 , the field components along the edge of the unit cell , i.e. , the quantities that are continuous across an interface between pcs or dielectrics , are @xmath51 where @xmath52 and @xmath53 are the rows of @xmath41 and @xmath42 corresponding to grating order @xmath16 . in the @xmath54 polarization ,",
    "@xmath41 and @xmath42 map to @xmath55 and @xmath56 fields , and these quantities replace @xmath45 and @xmath46 in eq .  .",
    "previously @xcite , we defined pc impedances in terms of these matrices . for @xmath45 polarized light ,",
    "the impedance of a pc is @xmath57 and for @xmath56 polarized light it is @xmath58 where @xmath41 and @xmath42 are calculated for the pc , and @xmath59 and @xmath60 are calculated for a reference material , usually free space .",
    "@xmath61 is a diagonal matrix that takes into account the half - period shift of gratings in triangular lattice pcs : for square lattices @xmath62 , and for triangular lattices @xmath63 , where @xmath16 is the grating order",
    ".    given impedances @xmath64 and @xmath65 for two pcs , it is simple to calculate the reflection and transmission matrices across their interface @xcite :    [ eq : r_t_of_z ] @xmath66    where @xmath67 .",
    "our method of finding the bloch modes and bloch factors is based on the method presented by ha _",
    "@xcite , although our method offers some significant improvements in accuracy and efficiency .",
    "we take field data for several unit cells of a pc , and try to write it as a superposition of bloch modes , thus finding the modal fields and bloch factors .",
    "the final steps of our mode - finding method impose symmetry relationships between forward and backward modal fields , increasing accuracy by almost halving the number of unknowns in the problem .",
    "we now outline our method .     pc structures for a square and a triangular pc lattice .",
    "the squares with solid edges are the unit cells used by our method . for the triangular lattice pc , the field in the solid - edge unit cells",
    "are calculated from the unit cells of the simulated structure ( dashed edges ) using bloch s theorem , with the ratio @xmath24 between adjacent cells fields . ]    in an em solver , we simulate a section of 2d pc with bloch - floquet periodic boundary conditions on two boundaries , and uniform dielectric on the others ( fig .",
    "[ fig : simmoschem ] ) .",
    "we sample the @xmath45 or @xmath55 ( depending on polarization ) field component at many ( @xmath68 ) points in unit cell @xmath69 , and then at the equivalent points in each of the other unit cells .",
    "if desired , @xmath70 , @xmath46 , @xmath71 , or @xmath56 may be used in place of or in addition to @xmath45 and @xmath55 . for triangular lattice",
    "pcs , we use the field in the simulated unit cells ( dashed edges in fig .",
    "[ fig : simmoschem ] ) to calculate the field in the unit cells separated by a lattice vector ( solid edges ) ; we apply bloch s theorem with integer multiples of the lattice vector @xmath72 .",
    "we seek to write these electric field components as a superposition of forward and backward bloch modes .",
    "so we want to express every @xmath73 , i.e. , the @xmath45 or @xmath55 field component for sampled point @xmath74 in unit cell @xmath75 , as @xmath76 where @xmath77 and @xmath78 are respectively the modal field and the bloch factor of forward mode @xmath49 ; @xmath79 denotes backward modes , and @xmath80 is the residual error . more specifically , for forward modes , @xmath77 is the field component of mode @xmath49 at point @xmath74 of the first unit cell , @xmath69 .",
    "the bloch factor @xmath78 is the ratio of the field in cells @xmath81 and @xmath75 , so @xmath82 is the field component of forward mode @xmath49 at point @xmath74 of unit cell @xmath75 . to avoid ill - conditioning , the field @xmath83 at point @xmath74 of each backward mode @xmath79",
    "is defined in the last unit cell , @xmath84 .",
    "this means that the coefficients of @xmath77 and @xmath85 in eq .",
    "have moduli no greater than 1 . as noted in sec .",
    "[ sub : background_theory ] , the bloch factor @xmath86 of each backward mode is related to that of its forward partner ; we enforce this relationship in practice , thereby halving the number of bloch factors that must be found .",
    "equation for all @xmath75 and all sampled @xmath74 may be written in matrix form as : @xmath87 where @xmath88 contains the @xmath45 or @xmath55 field components from the em solver , @xmath89 is a matrix of modal fields , @xmath90 is a matrix constructed from bloch factors , and @xmath91 is a matrix of residuals @xmath80 that must be minimized .",
    "@xmath88 is a @xmath92 matrix : the field in its @xmath75th row and @xmath93th column is @xmath94 , the field component at point @xmath74 in unit cell @xmath75 .",
    "similarly , @xmath89 is a @xmath95 matrix ; the field in its @xmath49th row and @xmath93th column is @xmath96 , the field of mode @xmath49 at point @xmath74 in cell @xmath69 for forward modes , or cell @xmath84 for backward modes .",
    "@xmath90 is a @xmath97 matrix .",
    "for a forward mode @xmath49 , the @xmath98th element of @xmath90 is @xmath99 , and for a backward mode @xmath79 , the @xmath100th element is @xmath101 . if multiple field components ( e.g. @xmath45 , @xmath46 and @xmath71 ) are to be used to find the modes , then the additional data can be added as extra columns in @xmath88 .",
    "we start the optimization process knowing @xmath88 , and with information about the structure of @xmath90 , and no direct information about @xmath89 . in our method , we first find the bloch factors that determine @xmath90 , a relatively difficult problem .",
    "once @xmath90 is known , solving eq .   for the modal fields @xmath89 becomes a pure least - squares problem that can be solved accurately and efficiently using standard techniques .    to find the modes , we seek to minimize the difference between the observed field @xmath88 and the superposition of bloch mode fields @xmath102",
    "that is , we seek to minimize @xmath103 in eq .  , the sum of squared moduli of the elements of @xmath91 . constraining the problem by dividing by the squared frobenius norm @xmath104 of @xmath88 , the quantity we minimize is @xmath105 where @xmath106 .",
    "first we eliminate @xmath89 from eq .   in order to find @xmath90 with a numerical minimizer .",
    "we use an alternative representation of the frobenius norm , @xmath107 , to write @xmath108 finding @xmath89 for arbitrary @xmath90 is a standard least - squares problem ; the optimal @xmath89 satisfies @xmath109 .",
    "we expand eq .  , twice apply this relation , and rearrange to get @xmath110 where @xmath111 is the moore - penrose pseudoinverse of @xmath90 .",
    "using eq .   and",
    "a numerical minimizer , the bloch factors that determine @xmath90 may often be found to a useful level of accuracy ( see sec .  [",
    "sec : numerical_procedure ] for implementation details ) . in order to improve the accuracy and reliability of the results , we impose further physical constraints .",
    "the pc impedance method @xcite assumes the unit cell to be up - down symmetric , which causes the forward and backward modes to be related .",
    "so far , we have only imposed a relationship between the forward and backward bloch factors , not the modal fields within each unit cell .",
    "we can halve the number of unknowns in @xmath89 and strongly improve the quality of our results by enforcing this relationship in the minimization process .",
    "we commence by partitioning the forward ( @xmath112 ) and backward ( @xmath113 ) modes , and the points in the left ( @xmath114 ; @xmath115 ) and right ( @xmath116 ; @xmath117 ) halves of the unit cell :    @xmath118    @xmath119    after normalization , the field of a backward mode is the field of its forward partner reflected about the @xmath8-axis , thus @xmath120 where @xmath121 is the permutation matrix that maps points @xmath122 to @xmath123 , and @xmath124 is a normalizing diagonal matrix whose elements are the ratio of backward and forward mode amplitudes .",
    "the columns of @xmath125 and @xmath126 , corresponding to points in the right half of the unit cell , can easily be ordered so that @xmath127 ; from now on we assume this ordering .",
    ".   can now be written with roughly half as many unknowns , @xmath128 @xmath129 represents each backward mode s amplitude in each cell , relative to that of the corresponding forward mode in cell 0 .",
    "the constraints on @xmath89 ( eq .  ) mean that eq .   does not have a least - squares form , so may not be immediately simplified in the way that eq .   led to eq .  .",
    "to transform eq .   into a more useful form , we block - diagonalize @xmath89 and right - multiply by the matrix @xmath130 , to show @xmath131 here we have introduced the symmetric and antisymmetric forms",
    "@xmath132 , @xmath133 , and @xmath134 .",
    "eq .   takes the form of two independent least - squares equations , each with half the dimension of eq .  .",
    "the two equations must be satisfied simultaneously , so to find the bloch factors we can minimize @xmath135 or equivalently @xmath136 again , this quantity may be minimized by a numerical optimizer . the residual @xmath137 for any solution to eq .",
    "is equal to the residual obtained by inserting the solution into eq .  :",
    "the two equations differ only in the symmetry constraint on backward modal fields ( eq .  ) . compared to eq .  , we have removed @xmath138 unknowns from @xmath89 ( where @xmath139 is the number of sampled points in each unit cell ) , halving its dimension at the cost of adding @xmath140 unknowns to @xmath141 as @xmath124 .",
    "these new unknowns must be found simultaneously with the bloch factors using a numerical minimizer , so it is important to supply a good starting estimate ; our method for doing so is detailed in sec .",
    "[ sec : numerical_procedure ] .",
    "once the bloch factors and @xmath124 are known , the modal fields can be reconstructed and analyzed to determine the pc s impedance .",
    "the essential quantities for this calculation are the @xmath9 and @xmath10 field components in the plane of the pc interface ( i.e. , @xmath45 and @xmath46 , or @xmath55 and @xmath56 , depending on polarization ) of each bloch mode @xmath49 along the left edge ( @xmath142 ) of a unit cell ( see fig .  [",
    "fig : simmoschem ] ) .",
    "these quantities , @xmath143 and @xmath144 , may be found from eq .",
    "using the known values for @xmath145 and @xmath146 and inserting the appropriate @xmath9 or @xmath10 fields into @xmath147 and @xmath148 .    to calculate the impedance",
    ", we find the @xmath41 and @xmath42 matrices for the pc , as defined in sec .",
    "[ sub : background_theory ] . inserting multiples of unit vectors",
    "@xmath44 into eq .",
    ", we can show that    @xmath149    @xmath150    where @xmath151 is the amplitude of the normalized mode @xmath49 , and @xmath47 and @xmath152 are the elements of @xmath41 and @xmath42 .",
    "it is straightforward to exploit the orthogonality of the plane wave grating diffraction orders to show that    [ eq : eh_elements ] @xmath153 @xmath154    eqs .",
    "let us calculate each element of the @xmath41 and @xmath42 matrices , up to a normalization constant @xmath151 per column .",
    "we remove the constants by calculating the pc s impedance ( eq . or ) with the pc itself as the reference material : by reciprocity - derived bloch mode orthogonality relations @xcite , this quantity should be the identity matrix .",
    "the diagonal entries of this matrix are the @xmath155 ; the off - diagonal terms , which should be zero , provide an error estimate . after normalizing the @xmath41 and @xmath42 matrices for the pc , we calculate its impedance matrix @xmath156 from eq . or using a reference medium such as free space .",
    "having outlined the theoretical basis of our method for finding the bloch factors and impedance of a pc at a given frequency , incident angle , and polarization , we now provide some practical detail about our implementation of the method .",
    "we outline the procedure for @xmath157 pairs of bloch modes .    in comsol multiphysics 4.2",
    ", we simulate a @xmath158 unit cell sample of pc , embedded in its background dielectric , with bloch - floquet periodic boundary conditions along the two long boundaries ( fig .",
    "[ fig : simmoschem ] shows a @xmath159 structure ) .",
    "eq . is a set of @xmath160 equations , with @xmath161 and @xmath162 unknowns in @xmath141 and @xmath163 respectively .",
    "to be overspecified , the method requires @xmath164 ; thus @xmath165 periods and a large @xmath68 is sufficient to find @xmath166 modes .",
    "a deeper structure with more unit cells does not necessarily provide useful information about additional evanescent modes , as their amplitude deep inside the structure may be negligible .",
    "from comsol we export the relevant @xmath9 and @xmath10 field components in the @xmath165 unit cells , sampled over a @xmath167 grid .    in order to compute a mode , it must be present in the structure with sufficient amplitude to be detected .",
    "light at normal incidence often fails to excite odd bloch modes ; these _ uncoupled modes _",
    "@xcite consequently can not be found by an optimization , which loses accuracy in searching for modes that are not present . at frequencies above the first wood anomaly ,",
    "the frequencies at which the higher order modes are most important , this problem may be avoided by exciting the pc slab not with a normally incident plane wave , but with the first grating diffraction order .",
    "this technique is used in sec .",
    "[ sub : complex_band_structure ] and sec .",
    "[ sub : park_coating ] . if the uncoupled mode is not relevant to a particular problem , it may instead be ignored .",
    "if we seek to find @xmath166 bloch modes , then finding a global minimum of eq .",
    "involves searching for @xmath168 complex numbers .",
    "this is a hard problem if attacked directly , but we use an algorithm that gives more consistent success by providing a good starting estimate .",
    "we start by minimizing the residual @xmath137 in eq .  , which forces a relationship between forward and backward bloch factors but not the modal fields .",
    "this involves finding only @xmath140 complex numbers . as a starting estimate for the forward bloch factors",
    ", we either take the result of a neighboring simulation , or the analytically calculated bloch factors for the dielectric background of the pc . at every step of the minimization ,",
    "evanescent modes are sorted into forward and backward decaying modes , based on the moduli of their bloch factors .",
    "the minimization can be done by any standard numerical minimizer , such as scipy s @xcite ` fmin ` , which is a modified nelder - mead optimization @xcite . at this point ,",
    "the results are equivalent to those from the method of ha _ et al . _",
    "@xcite , except that we have lessened the likelihood of @xmath90 being ill - conditioned by renormalizing the backward bloch factors @xmath86 in eq . and setting their phase origin to the end of the pc .",
    "occasionally , we encounter an instability in which a pair of modes have very large equal and opposite field amplitudes and very small bloch factors . when this occurs , we follow a gram - schmidt - like process : we subtract the field of non - problematic modes ( i.e. , modes with @xmath169 ) from @xmath170 and repeatedly minimize eq .   to find each of the remaining modes individually .",
    "using the solution to eq .   as our estimate for the bloch factors ,",
    "the modal fields may be found with a least - squares optimization .",
    "the average field ratio of each pair of backward and forward modes gives us an estimate for @xmath124 .",
    "we now have a plausible estimate for @xmath124 and the bloch factors , which we can use as a starting estimate to minimize eq .  .",
    "to further refine the estimates , we repeatedly iterate through the modes , fixing all but one @xmath26 and the corresponding element of @xmath124 , minimizing eq .   to find the two variables .",
    "after this process , we finally minimize eq .   across all 6 complex dimensions simultaneously to obtain the correct bloch factors and modal fields from which we calculate impedances .",
    "forward and backward propagating modes are sorted based on their flux @xcite , before impedances are calculated as outlined in sec .",
    "[ sub : calculating_impedance ] .",
    "we now apply our method to a range of typical problems .",
    "each of these problems involves frequencies above the first or second wood anomaly  frequencies at which scalar methods fail and multiple modes are required to describe the system .",
    "blochcode , software that implements our method in python , using scipy @xcite and sage @xcite , is freely available on the internet @xcite ; we use it here .",
    "the first application of our method is to calculate the complex band structure of a pc .",
    "the pc is a triangular lattice of circular air holes with radius @xmath171 and lattice constant @xmath172 in a dielectric background with @xmath173 .",
    "we calculate the band structure for light polarized with the @xmath42 field out of the pc plane ( @xmath56 polarization ) at frequencies @xmath174 in the @xmath175 direction , i.e. , at normal incidence . using comsol",
    ", we calculate the field in an 8 period slab of the pc , and we apply our method to find the largest three bloch factors . @xmath137 varies : it is less than @xmath176 at low frequencies and less than @xmath177 at high frequencies .    )",
    "is marked .",
    "the modes are sorted into colors by @xmath178 ; where two modes are propagating ( i.e. , have @xmath179 ) , they are sorted by @xmath180 .",
    "( a ) magnitude of bloch factors @xmath178 , with three bloch modes found at all frequencies .",
    "( b ) @xmath178 with two bloch modes found below the wood anomaly , three above .",
    "( c ) argument of bloch factors .",
    "( d ) complex band structure in 3d . ]",
    "[ fig : bandstructure ] summarizes the propagation properties of the two / three most dominant modes .",
    "the moduli of the bloch factors @xmath178 , which quantify how the modes amplitudes vary with propagation , are shown in figs .",
    "2(a ) and 2(b ) . below the wood anomaly , an inspection of @xmath89 and @xmath124 shows that the third mode is barely excited by the normally incident plane wave , and this reduces the accuracy of the results ( fig .",
    "ignoring the uncoupled mode at low frequencies ( where the @xmath181 grating order is evanescent and so may not be used to excite the structure , as mentioned in sec .",
    "[ sec : numerical_procedure ] ) increases the accuracy of the other two modes ( fig .",
    "the complex arguments of the bloch factors , which quantify how phase is acquired through propagation , are shown in fig .",
    "2(c ) , and the information about amplitude and phase is summarized in a single plot in fig .",
    "aside from slight errors in the phase of strongly evanescent modes in fig .",
    "2(c ) , there is good agreement between fig .",
    "[ fig : bandstructure ] and bloch factors calculated by highly accurate multipole techniques .",
    "figure  [ fig : bandstructure ] shows that at frequencies below the wood anomaly there is at most one propagating bloch mode , which becomes evanescent in the first bandgap with a decay factor @xmath178 of no less than 0.5 ; it still decays far more slowly than the other evanescent bloch modes at that frequency .",
    "2(c ) shows that for the evanescent modes , either 0 or @xmath182 phase is acquired across each unit cell .",
    "our next application is to reproduce the design of an antireflection coating we presented previously @xcite , found using pc impedances calculated with a specialized transfer - matrix method @xcite . as in this previous paper ,",
    "our design strategy is to try out a very large number of potential coatings , and choose the coating that gives the lowest reflectance off the coated structure .",
    "the use of pc impedances makes this a feasible problem , as the evaluation of each coating is quick , involving a few operations on @xmath183 ( here @xmath184 ) matrices .",
    "the target pc is a triangular lattice with lattice constant @xmath172 , consisting of air holes in a dielectric background with @xmath185 .",
    "the holes are cylinders with radius @xmath186 .",
    "we seek to coat the pc to minimize reflection for light with frequency @xmath187 , incident from air at an angle of @xmath188 in the @xmath45 polarization . at this frequency and incident angle , @xmath189 ; we consider a total of 3 modes to ensure accuracy . as in our previous work @xcite",
    ", we seek a two - layer coating , where the degree of freedom is @xmath190 , the lattice vector component perpendicular to the air / pc interface . for a regular triangular lattice , @xmath191 .",
    "we choose 121 candidate pcs with @xmath192~\\frac{\\sqrt{3}}{2 } a$ ] and simulate 8 periods of each in comsol .",
    "we apply our method to the resulting data , using the bloch factors of the previous pc as the starting estimate for the next .",
    "blochcode processes the 121 pcs in approximately 13 minutes on a 3.06  ghz intel core  2  duo desktop computer .",
    "an equivalent approach that only requires one pc to be evaluated is detailed in sec .",
    "[ sub : park_coating ] ; we do not use it here since the purpose of this section is to demonstrate the reliability and consistency of the optimization procedure .",
    "we then calculate the reflectances off the @xmath193 coated stacks ( fig .",
    "[ fig : pracoat ] ) , which takes 34 seconds on a single core of the desktop computer .",
    "the optimal coating is found to have thicknesses @xmath194 and @xmath195 , and reduces the reflectance of the structure from @xmath196 to @xmath197 .",
    "the results in fig .",
    "[ fig : pracoat ] agree well with data calculated by a highly accurate multipole scattering matrix method : the rms difference is @xmath198 , and the only noticeable differences occur on the two sharp resonant features near the lower edge of the figure .",
    "specifically , the multipole - based calculations show that the coating reduces the pc s reflectance from @xmath199 to @xmath200 .     and",
    "@xmath201 , the relative thicknesses of the two coating layers , calculated using pc impedances from blochcode .",
    "the minimum reflectance is marked . ]",
    "finally , we apply our methods to find an all - polarization antireflection coating for a silicon - based self - collimating square - lattice photonic crystal presented by park _",
    "they investigated this class of structures using a scalar treatment of reflections , and were able to design an all - polarization coating at @xmath202 , below the first wood anomaly .",
    "since their scalar treatment does not support multiple propagating or evanescent bloch modes , it generally does not work above the wood anomaly .",
    "our method does not have this limitation and we demonstrate this by designing an antireflection coating for both polarizations at a frequency well above the wood anomaly , using more than one bloch mode .    park _ et al . _",
    "@xcite showed that at @xmath203 , a 2d silicon ( @xmath204 ) pc with @xmath205 is self - collimating for both polarizations at normal incidence .",
    "the large radius is an extreme case that is challenging to simulate accurately . at this frequency @xmath206 , so for @xmath45 polarized light we include @xmath157 modes in our calculations , with light incident from the @xmath181 grating order so that the otherwise uncoupled mode is excited . for @xmath56 light , this procedure does not yield accurate results ",
    "bloch factors are calculated accurately , but the calculated reflection coefficients differ from those calculated directly in comsol .",
    "the calculated impedances prove sufficiently accurate to design an effective antireflection coating , but the inaccuracies mean that the coating is not optimal .",
    "to avoid these inaccuracies in @xmath56 polarization , we exploit the symmetry that causes the uncoupled mode .",
    "the physical structure and normally incident field are both symmetric about the @xmath30-axis , and so modes without even symmetry are not coupled to .",
    "therefore we formally ignore the uncoupled odd mode , in each pc and in the reference medium , setting @xmath207 . in our @xmath56 comsol simulations for this structure ,",
    "light is normally incident .    in fig .  2 of park _ et al",
    "_ s paper @xcite , they state that @xmath208 for @xmath45 polarized light , and @xmath209 for @xmath56 light .",
    "we calculate with blochcode that a semi - infinite slab of the pc has @xmath210 for @xmath45 , and @xmath211 for @xmath56 polarized light at this frequency , when incident from silicon .",
    "specialized fem - based transfer - matrix calculations agree , showing @xmath212 for @xmath45 polarization , and @xmath213 for @xmath56 polarization .    at @xmath203 ,",
    "normally incident light is reflected by the pc into three propagating diffraction orders . due to the symmetries of the problem ,",
    "the @xmath214 orders are only excited in an even superposition , so light is reflected into two modes . a successful coating needs to suppress reflection into both these modes simultaneously , and so must balance two modes amplitudes and two modes phases simultaneously for each polarization .",
    "thus the design of a perfect all - polarization coating requires 8 continuous degrees of freedom . rather than trying to search an 8-dimensional parameter space , which is computationally expensive",
    "even when the evaluation of each point is efficient , we consider coatings with four degrees of freedom and accept that we are unlikely to find an all - polarization coating with zero reflectance .",
    "nevertheless , this is a particularly difficult problem : not only do we need many degrees of freedom to find a satisfactory coating , but if either of the bloch factors in a pc is incorrect or any element of the pc s impedance matrix is wrong , then the calculated net reflection off the structure is incorrect as well .",
    "to limit the coating s thickness , we embed the four degrees of freedom into two rows of holes by varying both the hole radii , @xmath215 and @xmath216 , and the space after the layers , @xmath217 and @xmath218 ( fig .",
    "[ fig : dualpolschem ] ) .",
    "increasing @xmath217 and @xmath218 is similar to increasing @xmath190 , as in sec .",
    "[ sub : oldcoating ] , but because the candidate pcs are independent of @xmath219 , only one pc per radius needs to be simulated in comsol .",
    "furthermore , the properties of the layers of silicon with thickness @xmath220 may be calculated analytically .",
    "we consider 36 possible hole radii in the range @xmath221~a$ ] and 99 values of @xmath222 . to allow a thin coating , we set @xmath223 for each pc . if necessary , additional degrees of freedom could be added to find a coating with even lower reflectances .     and @xmath216 are the radii of the holes in the first two layers , and @xmath217 and @xmath218 are the thicknesses of the extra silicon background layers between the first few rows of holes . for this coating , @xmath224 , @xmath225 , @xmath226 , and @xmath227 . ]    on a single core of a @xmath228  ghz intel xeon - quad workstation",
    ", it took a total of 15 minutes to find the modes of the 36 pcs in the two polarizations . for @xmath45 polarization , @xmath229 for most radii , and for @xmath56 polarization @xmath137 ranged roughly from @xmath230 for thin unit cells to @xmath231 for the thicker cells with larger radius . due to the large number of candidate coatings ( @xmath232 ) ,",
    "the embarrassingly parallel problem was split over 16 cores of the workstation , taking approximately 80 minutes per polarization .",
    "the best @xmath45 coating reduces @xmath116 from 0.284 to @xmath233 , and the best @xmath56 coating reduces @xmath116 from 0.354 to @xmath234 .",
    "the best all - round coating is taken to be the one with the lowest total reflection in the two polarizations . this coating has @xmath224 , @xmath225 , @xmath226 , and @xmath235 ( fig .",
    "[ fig : dualpolschem ] ) . in @xmath45",
    "it reduces @xmath116 to 0.0141 , and in @xmath56 it reduces @xmath116 to 0.0197 .",
    "calculations from a specialized transfer matrix method @xcite agree with these results , giving @xmath236 in @xmath45 polarization and @xmath237 in @xmath56 .    to verify these results without the aid of our specialized methods , implementations of which are not publicly available",
    ", we simulate the structure using comsol multiphysics .",
    "since comsol can not directly calculate reflection coefficients off semi - infinite pcs , we simulate a 20-period section of the uncoated pc surrounded by the background dielectric , and compare the results to a simulation with the antireflection coating on both sides of the pc section .",
    "blochcode calculates the reflectance of the uncoated and coated structures to be 0.407 and 0.0124 respectively in the @xmath45 polarization , and 0.574 and 0.0074 in the @xmath56 polarization .",
    "the comsol simulations agree with these results , showing that the coating reduces @xmath116 from 0.407 to 0.0129 in the @xmath45 polarization , and from 0.585 to 0.0055 in the @xmath56 polarization .",
    "we have detailed a method for calculating the complex band structure and impedance of pcs .",
    "the method takes into account structural symmetries in the pc , and enforces relationships between the fields of forward and backward modes , thus improving the method s accuracy by eliminating ill - conditioning and constraining modal fields .",
    "we have applied the method to three cases , and have demonstrated that it works for a variety of square and triangular lattice 2d photonic crystals , for light in both polarizations and at different incident angles .",
    "we have demonstrated that our method works at frequencies both above and below the first wood anomaly , the frequency above which scalar methods can not adequately describe light propagation and reflection in pcs .",
    "the stronger the excitation of a bloch mode , the more accurately our method calculates its properties . thus the method is well - suited to calculating reflection and transmission through arbitrary pc stacks , where the most important modes are those that are strongly excited .",
    "since pc impedances make it so easy to calculate the reflection and transmission properties of many combinations of pcs in a stack , it is feasible to search large parameter spaces of pc stacks for particular reflective properties over a range of frequencies , incident angles and polarizations .",
    "the method can be used to design not only all - polarization antireflection coatings , but also broadband antireflection coatings @xcite , polarization filters , angular filters , and other devices .",
    "ha _ et al .",
    "_ have applied their method to slab pc waveguides @xcite .",
    "we have not yet applied our method to any 3d structure .",
    "as long as the @xmath238 plane mirror symmetry is present , our method for finding the complex band structure remains valid .",
    "the field of a slab waveguide might be sampled only over the pc s surface ( as in a snom experiment @xcite ) or throughout the entire volume of the structure ( as in a simulation ) ; either case provides sufficient information to determine the modal fields within the sampled region and the associated complex band structure .",
    "however , the impedance formalism is yet to be developed for 3d structures .",
    "our method is also valid for finding modes of pc waveguides , using supercells .",
    "calculation of reflection and transmission matrices between pc waveguides is yet to be demonstrated using impedances , but they have previously been calculated directly from the supercell s @xmath41 and @xmath42 matrices @xcite .    bloch mode analysis is a valuable tool in understanding light s interactions with pcs . using an em solver and our method , for which source code is available @xcite , it is straightforward to find a pc s complex band structure and its impedance .",
    "respectively , these quantities dictate how the bloch modes travel through the pc , and which modes they couple with at a pc interface . if these quantities are known for a set of pcs , then it is fast and efficient to calculate how light travels through arbitrary stacks of the pcs ."
  ],
  "abstract_text": [
    "<S> we present a flexible method that can calculate bloch modes , complex band structures , and impedances of two - dimensional photonic crystals from scattering data produced by widely available numerical tools . </S>",
    "<S> the method generalizes previous work which relied on specialized multipole and fem techniques underpinning transfer matrix methods . </S>",
    "<S> we describe the numerical technique for mode extraction , and apply it to calculate a complex band structure and to design two photonic crystal antireflection coatings . </S>",
    "<S> we do this for frequencies at which other methods fail , but which nevertheless are of significant practical interest . </S>"
  ]
}