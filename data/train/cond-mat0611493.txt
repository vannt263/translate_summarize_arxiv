{
  "article_text": [
    "traditional electronic structure algorithms calculate all eigenstates associated with discrete energy levels .",
    "the disadvantage of this approach is that it leads to a diagonalization problem that has an unfavorable cubic scaling in the computational effort .",
    "linear scaling density functional or hartree - fock methods are an essential tool for the calculation of the electronic structure of large systems containing many atoms.@xcite the key point of the success of most linear scaling methods is that only the density matrix or localized wannier functions which span the occupied manifold is calculated . in these o(n ) methods , no canonical wavefunctions or eigenvalues are available .",
    "however , in many cases , one may be interested in some eigenstates , especially the states near the fermi level , i.e. , band edge states .",
    "for instance , from the theory of frontier orbitals , many molecular properties are determined by the highest occupied molecular orbital ( homo ) and lowest unoccupied molecular orbital ( lumo ) , and frontier orbitals play an important role in chemical reactions . on the other hand ,",
    "there are some linear scaling algorithms such as the kim - mauri - galli ( kmg)@xcite method need the fermi level which can be estimated from the homo and lumo energy .    there are some methods which can be used to obtain band edge states .",
    "the most popular method for calculating states near a reference energy @xmath0 is the folded spectrum method.@xcite however , in this method , by squaring the hamiltonian , the condition number is also squared and thus the difficulty of solving the equation is also increased . to solve this problem , tackett _",
    "et al._@xcite presented the jacobi - davidson method in which the condition number and difficulty in solving for the selected eigensolutions is the same as the original eigenvalue equation .",
    "unfortunately , the implementation of the jacobi - davidson method is rather involved and its application is not widespread . in the field of computational mathematics , the shift - and - invert lanczos algorithm is a well - known method for calculating a pair of eigenvalue and eigenvector near a reference energy .",
    "this method was used by liang _",
    "et al._@xcite to obtain the fermi level in the context of linear scaling fermi operator expansion method . in this method ,",
    "the lanczos method is applied to the so - called shift - and - invert matrix , @xmath1 , where @xmath2 and @xmath3 are the hamiltonian and identity matrices , respectively , and @xmath0 is the reference energy . these matrices are not , of course , formed explicitly . instead , each time the lanczos method requires a multiplication of a vector @xmath4 by matrix @xmath1 , a linear solver subroutine is called to solve the corresponding linear systems .",
    "if these linear systems are solved sufficiently accurately , the convergence of the lanczos method is typically much faster compared to that when the matrix @xmath2 is used in the lanczos method .",
    "the difficulty now is that accurate numerical solution of linear systems , needed on each iteration of the lanczos method , can be costly . besides the difficulties of these methods mentioned above , when they are applied to get the frontier orbitals",
    ", another inconvenience is that a reference energy @xmath0 must be selected .    here in this work",
    ", we present an alternative simple method to get states near gap based on linear scaling density matrix methods . in our method",
    ", we do not need the reference energy .",
    "the new o(n ) method is particularly useful for calculating frontier orbitals in the framework of self - consistent field ( scf ) electronic structure theory . using this method",
    ", we also propose a promising linear scaling method which can be utilized to explore the energetics , defective levels , and gemoetry of doped semiconductors .",
    "this paper is organized as follows : in sec .",
    "[ theory ] , we present our new o(n ) methods for calculating band edge states and dealing with doped semiconductors . in sec .  [ impl ] , we describe the details of the implementation and perform some test calculations to illustrate the rightness , robustness , and linear - scaling behavior of our methods . in sec .",
    "[ appl ] , we use our new methods to calculate the band gap of boron nitride ( bn ) nanotubes and the acceptor level of a single h adsorbed bn nanotubes .",
    "finally , our concluding remarks are given in sec .",
    "within our method , we must first obtain density matrix @xmath5 corresponding a given hamiltonian @xmath2 before we proceed to calculate band edge states .",
    "however , it is not an inconvenience in the framework of linear scaling scf electronic structure theory . in principles ,",
    "any linear scaling density matrix methods can be used to obtain the density matrix.@xcite moreover , o(n ) localized orbital based methods can also be used to construct the density matrix.@xcite    in the representation of molecular canonical orbitals , density matrix @xmath5 and hamiltonian @xmath2 are diagonal matrices of the following forms : @xmath6 where @xmath7 is the number of electrons of a closed - shell system , and @xmath8 is the number of basis functions . without loss of generality , we assume that @xmath9 then @xmath10 and @xmath11 will be the homo and lumo energies respectively . it can be easily seen that : @xmath12 if @xmath13 , then @xmath10 will be the largest eigenvalue of @xmath14 .",
    "otherwise , we can shift the hamiltonian h to @xmath15 ( @xmath16 ) so that @xmath17 .",
    "clearly , @xmath18 is the largest eigenvalue of @xmath19 . using the similar argument",
    ", we can prove that if @xmath20 , @xmath21 will be the smallest eigenvalue of @xmath22 .",
    "we should note that the parameter @xmath23 can be set to be a large positive value without degrading the efficiency of the method . in practice",
    ", we find that it is usually reliable by setting @xmath23 to be @xmath24 ry .",
    "the largest ( smallest ) eigenvalue and its corresponding eigenvector of @xmath25 ( @xmath22 ) can be computed easily using the well - known o(n ) lanczos method . up to now",
    ", we discuss the problem in the representation of molecular canonical orbitals @xmath26 . in the representation of orthogonal basis orbitals @xmath27 ,",
    "molecular canonical orbitals @xmath26 can be expressed as @xmath28 where the coefficient matrix @xmath29 is a unitary matrix .",
    "thus in the representation of orthogonal basis orbitals , density matrix @xmath30 and hamiltonian @xmath31 can be calculated as : @xmath32 moreover , @xmath33 can also be obtained through a unitary transformation of @xmath14 .",
    "since the unitary transformation of a matrix does not change its eigenvalues , we can see that the above results deduced using the representation of molecular canonical orbitals also hold in the representation of orthogonal basis orbitals .",
    "the procedure for obtaining homo and lumo states are illustrated in fig .",
    "[ fig1](a ) .",
    "since many first principles codes use non - orthogonal atomic orbitals , here we discuss the case of non - orthogonal basis .",
    "a general method is transforming the non - orthogonal basis to orthogonal basis .",
    "we achieve this by transforming the atomic orbital ( ao ) hamiltonian matrix @xmath34 to an orthonormal basis using @xmath35 and obtaining the ao density matrix @xmath36 using @xmath37 , where the inverse factor @xmath38 , and @xmath39 is the cholesky factor for which @xmath40 .",
    "the cholesky transformation has been used in severval linear scaling densit matrix programs.we next show how to get wavefunction in the non - orthogonal basis . in non - orthogonal basis",
    ", a generalized eigenvalue problem should be solved : @xmath41 where @xmath42 is the wavefunction in the non - orthogonal basis .",
    "given the wavefunction in the orthogonal basis @xmath43 , which satisfies @xmath44 we have @xmath45    we also present another method to calculate band edge states in non - orthogonal basis without transforming to orthogonal basis .",
    "this method is particularly useful when localized orbitals based o(n ) algorithms are employed . from @xmath46 , one can easily see that @xmath47 is equivalent to @xmath48 .",
    "thus @xmath49 has the same eigenvalues as @xmath33 .",
    "we can also prove that @xmath50 has the same eigenvalues as @xmath51 .",
    "thus the largest eigenvalue of @xmath50 will be @xmath52 .",
    "we should point out that @xmath51 is hermitian , but @xmath50 is not .",
    "however , this does nt pose any problem since the lanczos algorithm can also be used to get the extreme eigenvalues of a non - hermitian matrix .",
    "we can see that the calculation of homo state is simple since only @xmath36 , @xmath34 , and @xmath53 are needed .",
    "however , the calculation of the lumo state is a different story .",
    "we can easily prove that @xmath54 has the same eigenvalues as @xmath55 and @xmath56 is the smallest eigenvalue of @xmath57 .",
    "as can be seen , to calculate the lumo state , besides @xmath36 , @xmath34 , and @xmath53 , we must also have @xmath58 or @xmath59 .",
    "the inverse of @xmath53 is usually a formidable task .",
    "fortunately , gibson _",
    "et al . _ introduced an o(n ) method to calculate @xmath59.@xcite      to our best knowledge , most linear scaling methods are mainly applied to semiconductors or insulators with an energy gap . when the system is metallic or gapless , these o(n ) methods fail or lose of effectiveness since these methods rely on the sparsity of the density matrix and the convergence of many of these methods is determined by the magnitude of band gap .",
    "partial occupation is another obstacle for many popular linear scaling methods due to the non - idempotence of the density matrix . here",
    "we propose an o(n ) method to deal with doped semiconductors where dopants or defects exist .",
    "our method has the similar spirit as that proposed by raczkowski and fong in that a subspace larger than the occupied space is used.@xcite in their seminal work , the subspace optimization method formulated in terms of localized nonorthogonal orbitals was employed .",
    "however , besides two o(n@xmath60 ) steps in the grassmann conjugate gradient ( gcg ) algorithm , an additional o(n@xmath60 ) step of diagonalization is needed .",
    "another problem is that when the orbital localization is used to acheive linear scaling , local minima might occur in the subspace optimization method , resulting in a stalling of gcg algorithm during the last several scf steps.@xcite    in our method , we treat the valence bands using the density matrix method , and other defective bands are calculated using our o(n ) method for band edge states . for simplicity",
    ", we consider the cases where only an electron or hole is present in a semiconductor , as shown in fig .",
    "[ fig2 ] . in case of _ n_-type doping ( fig .",
    "[ fig2](a ) ) , the total density matrix @xmath5 can be calculated as @xmath61 where @xmath62 is density matrix corresponding to the valence band . in case of _ p_-type doping ( fig .",
    "[ fig2](b ) ) , the total density matrix @xmath5 can be calculated as @xmath63 both @xmath64 and @xmath65 are computed through the newly developed o(n ) method for band edge states . using the block lanczos algorithm ,",
    "our method can also be used when several doped levels are present . in this case , the fermi distribution can be used to get the occupation of doped levels .",
    "since the valence band are well separated from the conduction band , @xmath62 is sparse , and the calculation of @xmath62 can be carried out using traditional o(n ) methods , such as the trace - correcting density matrix purification ( tc2 ) method.@xcite since canonical orbitals @xmath64 and @xmath65 are usually delocalized , the total density matrix @xmath5 is much denser than @xmath62 .",
    "it is difficult to deal with the full density matrix .",
    "however , we notice that in fact only a small part of the full density matrix is used in the construction of the new hamiltonian . thus in practice , we only construct a small part of the full density matrix . to make our o(n )",
    "method for the treatment of doped semiconductors more clear , we show the flow - chart of a typical calculation in fig .",
    "[ fig1](b ) .",
    "our method is very simple and applicable to many doped systems . we should mention that our method is not a black - box method since some knowledge of the studied system must be known prior . for instance",
    ", we should know the doping type and number of doping levels .",
    "typically , we can get this information from intuition or deduction from other smaller systems with similar characters .",
    "our newly developed method has been implemented in siesta,@xcite a standard kohn - sham density - functional program using norm - conserving pseudopotentials and numerical atomic orbitals as basis sets . in siesta ,",
    "periodic boundary conditions are employed to simulate both isolated and periodic systems .",
    "here we use the o(n ) tc2 method@xcite to get the density matrix since it is very simple , robust , and efficient .",
    "the details about the implementation of the tc2 method can be found in ref . 13 . in our o(n ) method for doped semiconductors , to obtain atomic forces , it is necessary to get the energy weighted density matrix @xmath66 when using atomic basis sets .",
    "take the case as shown in fig .",
    "[ fig2](a ) as an example , @xmath67 where @xmath68 is calculated from @xmath62 . for energy weighted density matrix @xmath66 , we also compute and save only a part of the full matrix . to speed up the calculation",
    ", we adopt the block lanczos method to calculate the defect levels , since the vectors produced by the previous scf step can be reused in the subsequent step . usually , in the last several scf steps , we do nt need any matrix - vector multiplications in the calculation of band edge states .",
    "thus , when a geometry optimization is performed , the extra amount for computing defect levels using our o(n ) method is almost negligible .",
    "this contrasts to the method proposed by raczkowski and fong.@xcite      all our calculations reported in this work are done in the local density approximation ( lda).@xcite unless otherwise stated , the double-@xmath69 plus polarization functions ( dzp ) basis set is used in the calculations .",
    "we first validate our method by computing the homo and lumo of h@xmath70o molecule .",
    "the energies of homo and lumo are @xmath71 ( @xmath72 ) and @xmath73 ( @xmath74 ) ev , respectively ( values in parenthesis are results from the diagonalization method ) .",
    "we also compare the homo and lumo wavefunctions with those from the diagonalization method , and find that the agreement is remarkable .",
    "to check the performance of our method , we calculate the homo and lumo of bn(5,5 ) nanotubes with different number of atoms in the supercells . the cpu time used",
    "is shown in fig .",
    "we can clearly see the linear scaling behavior of our new method for both single-@xmath69 ( sz ) and dzp basis sets .    for the purpose of comparison",
    ", we also calculate the lumo of bn(5,5 ) nanotube with 400 atoms using the folded spectrum method . the sz basis is adopted .",
    "since the performance of the folded spectrum method is very sensitive to the choice of the reference energy , several different reference energies varying from the midgap position to the lumo energy are chosen .",
    "the precision of the calculation is within 3 mev with respect to the value from the diagonalization . as shown in fig .",
    "[ fig4 ] , the cpu time used is very large , especially when the reference energy is close to the lumo energy ( the homo and lumo energies are -7.075 and -2.577 ev respectively in the current computing parameters setting ) .",
    "even when the the reference energy is chosen to be optimal , the folded spectrum method is still slower by seventeen times than our new o(n ) method ( 387 s v.s .",
    ".      we will take bn(8,0 ) zig - zag nanotubes with an adsorbed h atom as an example to illustrate the correctness and efficiency of our new method . as shown by wu _",
    ", a h atom prefers to adsorb on a b atom , and the system is a @xmath75-type semiconductor.@xcite for a bn(8,0 ) nanotube ( 128 atoms in the supercell ) with an adsorbed h atom , the energy difference between our result and that from the diagonalization method is only 6 mev . and the force differences between our result and that from the diagonalization method do not exceed 0.6 mev /  . both the energy and forces agreement validates our new o(n ) method for doped semiconductors .",
    "we also deal successfully with a bn(8,0 ) nanotube with two adsorbed h atoms on two b sites , indicating that our method also works in case of systems with multi defect levels .    here",
    "we show in fig .",
    "[ fig5 ] the cpu time used in an ion step for supercells with different number of atoms .",
    "clearly , our new method for doped semiconductors displays a linear scaling behavior .",
    "previous study showed that for small zigzag ( chiral angle @xmath76 ) nanotubes the energy gap decreases rapidly with the decrease of radius , while armchair nanotubes ( chiral angle @xmath77 ) almost have a constant energy gap .",
    "@xcite although previous experiments@xcite indicated a preference for zig - zag and near zig - zag bn tubes and a plausible explanation @xcite was proposed , a very recent high - resolution electron diffraction study on bn nanotubes grown in a carbon - free chemical vapor deposition process revealed a dispersion of the chiral angles.@xcite thus a thorough knowledge of the dependence of the band gap upon the chirality of bn nanotubes is desirable .",
    "chiral bn nanotubes usually contain large number of atoms in a unit cell , e.g. , a bn(14,1 ) nanotube has 844 atoms in the unit cell .",
    "these nanotubes are difficult to be treated using traditional methods . here",
    "we calculate systematicly the band gap of bn nanotubes including chiral bn nanotubes . whenever the system is large enough to be sampled using @xmath78-point",
    ", we use the new o(n ) method for calculating band edge states .",
    "the results are shown in fig .",
    "two general trends are observed : first for bn nanotubes with similar radius , bn nanotubes with larger chiral angles have larger band gaps , secondly , for bn nanotubes with chiral angles close to zero , bn nanotubes with larger radius have larger band gaps .",
    "in addition , we can see that for bn(@xmath79,@xmath80 ) nanotubes with @xmath81 , the band gap of bn(@xmath79,@xmath82 ) does not depend monotonously on the @xmath79 value due to the competition of the two trends mentioned above , however , the band gap of bn(@xmath83$],@xmath84 $ ] ) ( here @xmath84 $ ] denotes the maximal integer no larger than @xmath85 ) nanotube is the largest , and bn(@xmath86,0 ) nanotube usually has the smallest band gap except that the band gap of bn(8,2 ) nanotube is small than that of bn(10,0 ) nanotube .",
    "the band gaps of some bn nanotubes were reported previously and the results are in accord with ours,@xcite and a more complete picture for the trend of the band gap of bn nanotubes is presented here .",
    "et al._@xcite investigated the adsorption of a hydrogen atom on zigzag bn(8,0 ) nanotube using a supercell containing 32 boron and 32 nitrogen atoms and found h prefers to adsorb on the boron atom which introduces an acceptor state in the gap .",
    "they also showed that the dispersion of the defect band is as large as 0.2 ev .",
    "our test calculations in the @xmath78-only approximation also show that the acceptor levels of a single h adsorbed bn(8,0 ) nanotube using a 64-atoms or 128-atoms supercell are 1.064 ev and 1.180 ev , respectively ( here , the acceptor level is defined as the energy difference between the acceptor state and the top of the valence band ) .",
    "in addition , the adsorption energy of the h atom also depends on the chosen supercell : for instance , the adsorption energy is @xmath87 ( @xmath88 ) ev when using a 64-atoms ( 320-atoms ) bn(8,0 ) supercell and the diagonalization ( our linear scaling ) method .",
    "all these facts suggest that larger supercells should be used to predict the properties of bn nanotubes with an isolated adsorbed h atom . here with the o(n ) method for doped semiconductors developed in this paper , we can treat much larger radius bn nanotubes with truely isolated adsorbed h atom through using huge supercells .",
    "three bn nanotubes are considered : bn(8,0 ) nanotube simulated using a supercell with 320 atoms , bn(15,0 ) nanotube simulated using a supercell with 720 atoms , and bn(13,2 ) nanotube with 796 atoms in the unit cell . here",
    "we show the distribution of the acceptor state and the highest orbital of the valence band in fig .",
    "[ fig7 ] . clearly , the acceptor state is a relatively localized state around the adsorbed h atom , which agrees with the result reported by wu _",
    "et al._@xcite . however , the highest orbital of the valence band is delocalized and mainly contributed by n 2p@xmath89 orbitals . as can be seen from fig .",
    "[ fig6 ] , bn(15,0 ) nanotube and bn(13,2 ) nanotube have similar radius but different chirality , and the radius of bn(8,0 ) nanotube is smaller .",
    "the calculated acceptor levels introduced by an isolated h atom are 1.184 ev , 1.557 ev and 1.563 ev for bn(8,0 ) , bn(15,0 ) and bn(13,2 ) nanotubes , respectively .",
    "thus the position of the defect level is closer to the top of valence bands for smaller radius bn nanotubes , but does not depend significantly on the chirality .",
    "we present a simple o(n ) method for calculating band edge states using the density matrix obtained from o(n ) electronic structure methods . based on the o(n ) method for calculating band edge states",
    ", we further develop an o(n ) algorithm to deal with doped semiconductors . in our methods ,",
    "no reference energy is needed to obtain the band edge states , and they are especially suited for the application in scf electronic structure theory .",
    "the o(n ) behavior of the new methods is demonstrated by applying it to bare and h adsorbed bn nanotubes .",
    "the band gap of various bn nanotubes are investigated systematicly and the acceptor levels of bn nanotubes with an isolated adsorbed h atom are calculated .",
    "our algorithms could be generalized straightforwardly to spin - unrestricted systems,@xcite such as magnetic semiconductors and diluted magnetic semiconductors.@xcite                                              s. a. wolf , d. d. awschalom , r. a. buhrman , j. m. daughton , s. von molnr , m. l. roukes , a. y. chtchelkanova , and d. m. treger , science * 294 * , 1488 ( 2001 ) ; i. uti , j. fabian , and s. d. sarma , rev .",
    "phys . * 76 * , 323 ( 2004 ) ."
  ],
  "abstract_text": [
    "<S> linear scaling methods provide total energy , but no energy levels and canonical wavefuctions . from the density matrix computed through the density matrix purification methods , </S>",
    "<S> we propose an order - n ( o(n ) ) method for calculating both the energies and wavefuctions of band edge states , which are important for optical properties and chemical reactions . </S>",
    "<S> in addition , we also develop an o(n ) algorithm to deal with doped semiconductors based on the o(n ) method for band edge states calculation . </S>",
    "<S> we illustrate the o(n ) behavior of the new method by applying it to boron nitride ( bn ) nanotubes and bn nanotubes with an adsorbed hydrogen atom . </S>",
    "<S> the band gap of various bn nanotubes are investigated systematicly and the acceptor levels of bn nanotubes with an isolated adsorbed h atom are computed . </S>",
    "<S> our methods are simple , robust , and especially suited for the application in self - consistent field electronic structure theory . </S>"
  ]
}