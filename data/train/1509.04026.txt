{
  "article_text": [
    "we propose a feature allocation model [ broderick , jordan and pitman ( @xcite ) ] to describe tumor heterogeneity using next - generation sequencing ( ngs ) data .",
    "we use a variation of the indian buffet process ( ibp ) [ @xcite ] .",
    "the feature allocation in our model is latent .",
    "that is , the features are not directly observed .",
    "we record point mutations as single nucleotide variants ( snvs ) , each of which is defined as a dna locus that possesses a variant sequence from that on the reference human genome .",
    "we use the feature allocation model to describe unobserved haplotypes , defined as a collection of single nucleotide variants ( snvs ) scaffolded on a homologous genome . in a tumor sample",
    ", having more than two haplotypes is evidence of heterogeneous cell subpopulations with a distinct genome .",
    "this is the case because humans are diploid and we would therefore only observe up to two haplotypes if all cells in a tumor sample were genetically homogeneous . in the proposed application of feature allocation models to inference for tumor heterogeneity ,",
    "the haplotypes are the features and the snvs are the experimental units that select the features .",
    "the number of features is unknown .",
    "each tumor sample is composed of an unknown proportion of each of these haplotypes .",
    "the top level sampling model for the observed snv counts is then defined as binomial sampling with a proportion for each snv that is implied by this composition . in summary , we solve a deconvolution problem to explain the observed snv frequencies for each sample by compositions of latent haplotypes .",
    "heterogeneity in cancer tissue has been hypothesized over the past few decades [ @xcite ] and has been demonstrated elegantly using ngs technology over the past few years [ @xcite ] .",
    "genetic variation in a tumor occurs due to evolutionary processes that drive tumor progression .",
    "specifically , tumors include distinct clonal subpopulations of cells that arise stochastically by a sequence of randomly acquired mutations .",
    "substantial genetic heterogeneity between tumors ( inter - tumor ) or within a tumor ( intra - tumor ) can be explained by differences in clonal subpopulations and varying proportions of those subpopulations [ @xcite ] .",
    "for example , @xcite reported clonal genomic heterogeneity in breast cancers .",
    "data derived from ngs experiments include snvs , small indels and copy number variations [ @xcite ] .",
    "many researchers use snv data to investigate genes and genomic regions related to cancer phenotypes [ @xcite ] . in this paper",
    ", we utilize whole - genome sequencing data measuring variant allele fractions ( vafs ) at snvs to understand tumor heterogeneity by proposing inference on how haplotypes may be distributed within a tumor . in an ngs experiment ,",
    "millions of short dna reads are generated and are then aligned to the reference genome . at certain positions of the genome ,",
    "some or all of the mapped reads will show a sequence different from what is in the reference genome . at each genomic locus , the proportion of short reads bearing a variant sequence is called the vaf . if the vaf at a locus is nonzero , an snv may be `` called '' at that locus , based on statistical inference [ @xcite ] .",
    "the raw experimental data comprises the total number of reads ( @xmath0 ) that are mapped to the locus and the number of those reads ( @xmath1 ) indicating a variation from the reference sequence .",
    "then vaf @xmath2 . if a tumor sample is homogeneous , that is , having a single clone , the vaf values of all the snvs should be close to 0 , 0.5 or 1 , reflecting the three possible homozygous and heterozygous alleles ( i.e. , aa , ab , bb ) at any snv . different vaf values imply heterogeneity of the cellular genome in the tumor sample ( see figure  [ fig : data_1 ] for an example ) . we propose to study inference to deconvolute the vafs from multiple snvs and back out the latent haplotypes .",
    "@c@     +   +   +    we propose a bayesian feature allocation model to characterize such cellular heterogeneity in a way that explains the observed ngs data .",
    "we construct a matrix of binary features ( equivalently , haplotypes ) as shown in figure  [ fig : demo_z ] . in the figure",
    ", columns correspond to haplotypes and rows correspond to snvs .",
    "we define haplotype @xmath3 by a binary vector @xmath4 of indicators of whether ( @xmath5 ) or not ( @xmath6 ) a variant sequence is observed at the snv @xmath7 . here",
    "we view snv as a genetic locus on which either a variant or reference dna sequence could be observed .",
    "figure  [ fig : demo_z ] illustrates the definition of five haplotypes ( @xmath8 , columns ) with @xmath9 snvs ( rows ) . in the figure , black ( white ) indicates @xmath5 ( @xmath6 ) .",
    "for example , snv 1 in figure  [ fig : demo_z ] possesses a variant sequence in the two haplotypes @xmath10 and @xmath11 .",
    "on the other hand , snv 9 possesses variant sequences in four haplotypes : @xmath12 and @xmath13 .",
    "a prior probability model on such a binary matrix @xmath14 $ ] is known as a feature allocation model . here , we assume that @xmath15 is unknown and place a prior on @xmath15 .        assuming that samples are composed of different proportions of @xmath15 haplotypes , we aim to fit the observed vafs of the snvs to infer these proportions .",
    "for example , we may observe that one sample is dominated by haplotypes @xmath16 and @xmath13 , while another is dominated by haplotypes @xmath17 and @xmath18 . if the samples are from the same tumor , the differences in haplotypic compositions are evidence of _ intra - tumor _ heterogeneity ; on the other hand , differences in samples from different tumors imply _",
    "inter - tumor _ heterogeneity .",
    "therefore , the proposed inference provides a unified framework to address inference for both biological concepts .",
    "importantly , the characterization of haplotypes is based on selected snvs only .",
    "otherwise inference for heterogeneity between tumors in different patients would not be biologically meaningful , as cellular genomes and haplotypes are not expected to be shared across patients .",
    "however , for tumors in the same class of disease , snvs in local disease - related genomic regions may be common to all or some of the tumors , thereby allowing for the proposed inference .",
    "there are currently few approaches that address the problem of tumor heterogeneity . @xcite and @xcite recognized that a tumor sample is a mixture of normal cells and tumor cells , and developed a method to estimate tumor purity levels for paired tumor - normal tissue samples using dna sequencing data",
    ". none of the two methods considers more than two samples or unpaired samples .",
    "purbayes [ @xcite ] accounts for intra - tumor heterogeneity , but it does not provide inference on the subpopulation configurations as inference on the latent matrix @xmath19 under the proposed model .",
    "pyclone [ @xcite ] , a recently published method , proposes inference to cluster snvs with different vafs .",
    "an underlying assumption of pyclone is that snvs can be arranged in clusters that inform about subclones .",
    "a key component of pyclone is the use of clustering models such as the dirichlet process for inference on these clusters .",
    "while such clusters are informative about heterogeneity , inference that is provided by pyclone is not meant to identify subclones or haplotypes .",
    "the primary aim of pyclone is inference on mutation clusters , defined as a group of snvs with similar variant allele fractions .",
    "in contrast , our proposed feature allocation model explicitly models the haplotypic genomes of subclones , allowing overlapping snvs shared between different subclones .",
    "we do not use nonoverlapping snv clusters as the building block for subclones .",
    "that is , instead of first estimating the snv clusters and then constructing subclones based on clusters , we directly infer the subclonal structure based on haplotypes .",
    "we show in later examples the distinction between pyclone and our proposed method .",
    "the remainder of the paper is organized as follows : section  [ sec : model_sel ] describes the proposed bayesian feature allocation model and a model selection criterion to select the number of subclones .",
    "section  [ sec : simulation ] describes simulation studies .",
    "sections  [ sec : example ] and  [ sec : lung_cancer ] report data analyses of in - house data sets to illustrate inter - tumor heterogeneity and intra - tumor heterogeneity , respectively .",
    "the last section concludes with a final discussion .     and @xmath20 .",
    "let @xmath21 denote an @xmath22 matrix of count data from an ngs genome sequencing experiment , with @xmath23 denoting the number of reads that bear a variant sequence at the location of snv @xmath7 for tissue sample @xmath24 , @xmath25 and @xmath26 .",
    "we assume a binomial sampling model .",
    "let @xmath27 denote the total number of reads in sample @xmath24 that are mapped to the genomic location of snv @xmath7 .",
    "we assume @xmath28 in figure  [ fig : demo_bin ] , @xmath20 and @xmath29 .",
    "we do not model @xmath27 , that is , we treat @xmath27 as fixed , and only consider a sampling model for @xmath23 conditional on @xmath27 ( modeling @xmath27 would not contribute any information on tumor heterogeneity based on snvs ) .",
    "conditional on @xmath27 , the observed counts @xmath23 are independent across @xmath7 and @xmath24 . the model in ( [ eq : like ] )",
    "is illustrated in figure  [ fig : demo_bin ] .",
    "we build a prior probability model for @xmath30 in two steps , using the notion that each sample is composed of a mixture of different haplotypes . and",
    "each haplotype , in turn , is characterized by the haplotypes consisting of the snvs .",
    "let @xmath31 denote the proportion of haplotype @xmath3 in sample @xmath24 and let @xmath32 denote a latent indicator of the event that snv @xmath7 bears a variant sequence for haplotype @xmath3 .",
    "note that @xmath33 corresponds to a black block in figure  [ fig : demo_z ] . then @xmath30 is written as a sum over @xmath15 latent haplotypes @xmath34 the construction of the haplotypes , including the number of haplotypes , @xmath15 , and the indicators @xmath35",
    "are latent . the key term , @xmath36 , indirectly infers haplotypes by explaining @xmath30 as arising from sample @xmath24 being composed of a mix of hypothetical haplotypes which do ( @xmath5 ) or do not ( @xmath6 ) include a mutation for snv  @xmath7 .",
    "the indicators @xmath35 are collected in a @xmath37 binary matrix @xmath38 .",
    "the number of latent haplotypes , @xmath15 , is unknown .",
    "conditional on @xmath15 , the binary matrix @xmath38 describes @xmath15 latent tumor haplotypes present in the observed samples .",
    "joint inference on @xmath15 , @xmath39 and @xmath40 explains tumor heterogeneity .",
    "in addition , we introduce a background haplotype , labeled as haplotype @xmath10 , which includes all snvs .",
    "the background haplotype accounts for experimental noise and haplotypes that appear with negligible abundance .",
    "specifically , @xmath41 in ( [ eq : model_p ] ) relates to this background haplotype , with @xmath42 being the relative frequency of observing a mutation at an snv due to noise and artifact ( we assume equal frequency for all snvs ) and @xmath43 being the proportion in sample @xmath24 .",
    "the prior on @xmath43 is defined later . for @xmath42",
    ", we assume @xmath44 with @xmath45 to inform a small @xmath42 value a priori .",
    "we start the prior construction with a prior for the number of haplotypes , @xmath15 .",
    "we consider a geometric distribution , @xmath46 where @xmath47 .",
    "conditional on @xmath15 , we use a feature allocation model for a binary matrix @xmath19 .",
    "we first define the model for any given @xmath15 and start with feature - specific selection probabilities , @xmath48 let @xmath49 .",
    "the selection probabilities are used to define @xmath50 as @xmath51 where @xmath52 is the number of snvs bearing variant sequences for haplotype @xmath3 .",
    "a limit of the model , as @xmath53 , becomes a constructive definition of the indian buffet process ( ibp ) [ @xcite ] .",
    "the model is symmetric with respect to arbitrary indexing of the snvs , simply because of the symmetry in ( [ eq : cond_z ] ) and ( [ eq : p_mu ] ) .",
    "note that @xmath54 is possible with positive prior probability .",
    "next , we consider a prior distribution for abundances associated with the haplotypes defined by @xmath19 . the haplotypes are common for all tumor samples , but the relative weights in the composition ( [ eq : model_p ] ) are different across tissue samples .",
    "we assume dirichlet priors for the relative weights @xmath31 , defined as follows .",
    "let @xmath55 denote an ( unscaled ) abundance level of haplotype @xmath3 in tissue sample @xmath24 .",
    "we assume @xmath56 for @xmath57 and @xmath58 .",
    "we then define @xmath59 as the relative weight of haplotype @xmath3 in sample @xmath24 .",
    "this is equivalent to @xmath60 for @xmath61 , where @xmath62 .",
    "recall the binomial sampling likelihood ( [ eq : like ] ) with success probability , @xmath30 . given @xmath15 , @xmath19 and @xmath63 ,",
    "we define @xmath30 in ( [ eq : model_p ] ) . in words , @xmath30 is determined by @xmath15 , @xmath19 and @xmath40 with the earlier describing the latent haplotypes and the latter specifying the relative abundance of each haplotype in sample @xmath24 .",
    "let @xmath64 , where @xmath65 .",
    "markov chain monte carlo ( mcmc ) posterior simulation proceeds by sequentially drawing random numbers for the parameters in @xmath66 .",
    "given @xmath15 , such mcmc simulation is straightforward .",
    "specifically , gibbs sampling transition probabilities are used to update @xmath35 , and metropolis  hastings transition probabilities are used to update @xmath67 and @xmath42 .",
    "it is possible to improve the mixing of the markov chain by updating all columns in row @xmath7 of the matrix @xmath19 jointly by means of a metropolis ",
    "hastings transition probability that proposes changes in the entire row vector @xmath68 .",
    "the construction of transition probabilities that involve a change of @xmath15 is more challenging , since the dimension of @xmath19 and @xmath69 changes as @xmath15 varies .",
    "we use a reversible jump ( rj ) mcmc algorithm for posterior simulation [ @xcite ] .",
    "we first define a proposal distribution @xmath70 for @xmath15 , and then introduce a proposal distribution @xmath71 for @xmath66 conditional on the proposed @xmath72 .",
    "the latter potentially involves a change in dimension of the parameter vector .",
    "we found that high posterior correlation of @xmath19 and @xmath63 conditional on @xmath15 greatly complicated the construction of a practicable rj scheme . to overcome this",
    ", we use an approach similar to @xcite .",
    "we split the data into a minimal training set @xmath73 with @xmath74 , @xmath75 , and a test data set , @xmath76 with @xmath77 etc . in the implementation we use",
    "@xmath78 generated from @xmath79 .",
    "let @xmath80 denote the posterior distribution under @xmath15 using the training sample .",
    "we use @xmath81 in two instances .",
    "first , we replace the original prior @xmath82 by @xmath83 and , second , we also use it as proposal distribution @xmath84 .",
    "the test data is then used to evaluate the acceptance probability .",
    "the strategy can be characterized as model comparison by fractional bayes factors [ @xcite ] and is related to a similar approach proposed in @xcite for model comparison with intrinsic bayes factors .",
    "both are originally proposed for model comparison with noninformative priors , but can be modified to facilitate mcmc across models as we need it here .    [ cols=\"^,^ \" , ]",
    "tumors are heterogeneous tissues .",
    "the traditional way to identify this heterogeneity has been to sequence multiple samples from the tumor .",
    "using such data to study the coexistence of genetically different subpopulations across tumors and within a tumor can shed light on cancer development .",
    "identifying subpopulations within a tumor can lead to clinically important insights .",
    "for example , @xcite found that a chemotherapy affects subclonal heterogeneity in chronic lymphocytic leukemia .",
    "they also observed that the presence of a certain subpopulation may adversely affect clinical outcome .",
    "we have proposed a model - based approach based on a feature allocation model .",
    "the feature allocation model allows us to impute inference about different components of tumor tissues based on ngs data .",
    "the identified components are not necessarily unique because there might be other possible solutions which can lead to the same hypothetical mutation frequencies . instead of reporting a single solution",
    ", the proposed approach provides a full probabilistic description of all possible solutions as a coherent posterior probability model over @xmath15 , @xmath19 and @xmath63 .",
    "a number of extensions are possible for the present model .",
    "first , the number of snvs examined in this paper was relatively limited ( about 100 ) , although the total number of snvs that were found in the whole exome of a tissue is on the order of about 50,000 .",
    "other than computational complexity , there is no bar in principle on expanding the model to analyze the whole snv complement of the exome",
    ". it could also be instructive to quantify the cellular diversity of the tumor based on findings from various regions of the exome .",
    "another important extension of the model is in the basic representation of subclones and haplotypes .",
    "the current model uses a binary matrix to record whether a variant sequence for an snv is present or absent in a haplotype .",
    "a variation of the model could instead record for each subclone whether an snv is absent ( @xmath6 ) , heterozygous ( @xmath5 ) or homozygous ( @xmath85 ) .",
    "that is , @xmath19 would become a trinary matrix .",
    "other extensions of the model are to consider each snv position to have four possible bases , @xmath86 , to introduce dependence among mutations or to formally model the noise in variant calling .",
    "each of these extensions is currently in development .",
    "for example , incorporating explicit error probabilities in variant calls is possible .",
    "similar to our previous work [ @xcite ] , we could replace the binomial likelihood ( [ eq : like ] ) in the proposed model with a bernoulli likelihood , for each read , where the probability associated with a read depends on quality scores of base calling and read mapping .",
    "we will consider this extension as future work .",
    "tumor genome sequencing projects have typically looked for specific genes to be mutated or not .",
    "the inherent assumption here , so far unproven , is that the overall effect of carcinogenesis could be explained by a handful of changes in a small number of genes .",
    "our model takes the opposite approach and allows us to examine the whole genome ( or exome ) and , by considering vaf patterns , to construct reasonable models for the tissue .",
    "we believe this holistic approach to the analysis might provide more robust conclusions and biomarkers than the gene - by - gene approach .",
    "church , d.  m. , schneider , v.  a. , graves , t. , auger , k. , cunningham , f. , bouk , n. , chen , h .- c . ,",
    "agarwala , r. , mclaren , w.  m. , ritchie , g.  r. , _ et  al . _",
    "( 2011 ) . modernizing reference genome assemblies .",
    "_ plos biology _ * 9 * , 7 , e1001091",
    ".              gerlinger , m. , rowan , a. , horswell , s. , larkin , j. , endesfelder , d. , gronroos , e. , martinez , p. , matthews , n. , stewart , a. , tarpey , p. , varela , i. , phillimore , b. , begum , s. , mcdonald , n. , butler , a. , jones , d. , raine , k. , latimer , c. , santos , c. , nohadani , m. , eklund , a. , spencer - dene , b. , clark , g. , pickering , l. , stamp , g. , gore , m. , szallasi , z. , downward , j. , futreal , p. , and swanton , c. ( 2012 ) .",
    "intratumor heterogeneity and branched evolution revealed by multiregion sequencing . _",
    "n engl j med .",
    "_ * 366 * , 10 , 883892 .",
    "ji , y. , xu , y. , zhang , q. , tsui , k .- w . , yuan , y. , norris  jr , c. , liang , s. , and liang , h. ( 2011 ) .",
    "bm - map : bayesian mapping of multireads for next - generation sequencing data .",
    "_ biometrics _ * 67 * , 4 , 12151224 .",
    "kanehisa , m. , goto , s. , furumichi , m. , tanabe , m. , and hirakawa , m. ( 2010 ) . for representation and analysis of molecular networks involving diseases and drugs .",
    "_ nucleic acids research _ * 38 * , suppl 1 , d355d360 .",
    "landau , d. , carter , s. , stojanov , p. , mckenna , a. , stevenson , k. , lawrence , m. , sougnez , c. , stewart , c. , sivachenko , a. , wang , l. , wan , y. , zhang , w. , shukla , s. , vartanov , a. , fernandes , s. , saksena , g. , cibulskis , k. , tesar , b. , gabriel , s. , hacohen , n. , meyerson , m. , lander , e. , neuberg , d. , brown , j. , getz , g. , and wu , c. ( 2013 ) . evolution and impact of subclonal mutations in chronic lymphocytic leukemia",
    ". _ cell _ * 152 * , 4 , 714726 .",
    "li , h. , handsaker , b. , wysoker , a. , fennell , t. , ruan , j. , homer , n. , marth , g. , abecasis , g. , durbin , r. , _ et  al . _",
    "the sequence alignment / map format and samtools .",
    "_ bioinformatics _ * 25 * , 16 , 20782079 .",
    "mckenna , a. , hanna , m. , banks , e. , sivachenko , a. , cibulskis , k. , kernytsky , a. , garimella , k. , altshuler , d. , gabriel , s. , daly , m. , _",
    "et  al . _",
    "the genome analysis toolkit : a mapreduce framework for analyzing next - generation dna sequencing data .",
    "_ genome research _ * 20 * , 9 , 12971303 .",
    "navin , n. , krasnitz , a. , rodgers , l. , cook , k. , meth , j. , kendall , j. , riggs , m. , eberling , y. , troge , j. , grubor , v. , _",
    "et  al . _",
    "( 2010 ) . inferring tumor progression from genomic heterogeneity .",
    "_ genome research _ * 20 * , 1 , 6880 .",
    "roth , a. , khattra , j. , yap , d. , wan , a. , laks , e. , biele , j. , ha , g. , aparicio , s. , bouchard - ct , a. , and shah , s.  p. ( 2014 ) .",
    "pyclone : statistical inference of clonal population structure in cancer .",
    "_ nature methods _ .",
    "russnes , h.  g. , navin , n. , hicks , j. , and borresen - dale , a .-",
    "insight into the heterogeneity of breast cancer through next - generation sequencing . _ the journal of clinical investigation _ * 121 * , 10 , 38103818 .",
    "su , x. , zhang , l. , zhang , j. , meric - bernstam , f. , and weinstein , j.  n. ( 2012 ) .",
    "purityest : estimating purity of human tumor samples using next - generation sequencing data .",
    "_ bioinformatics _ * 28 * , 17 , 22652266 .",
    "teh , y.  w. , grr , d. , and ghahramani , z. ( 2007 ) . stick - breaking construction for the indian buffet process . in _ proceedings of the international conference on artificial intelligence and statistics",
    "11 .",
    "wheeler , d.  a. , srinivasan , m. , egholm , m. , shen , y. , chen , l. , mcguire , a. , he , w. , chen , y .- j . ,",
    "makhijani , v. , roth , g.  t. , _",
    "et  al . _",
    ". the complete genome of an individual by massively parallel dna sequencing .",
    "_ nature _ * 452 * , 7189 , 872876 ."
  ],
  "abstract_text": [
    "<S> we develop a feature allocation model for inference on genetic tumor variation using next - generation sequencing data . specifically , we record single nucleotide variants ( snvs ) based on short reads mapped to human reference genome and characterize tumor heterogeneity by latent haplotypes defined as a scaffold of snvs on the same homologous genome . for multiple samples from a single tumor , assuming that each sample is composed of some sample - specific proportions of these haplotypes , we then fit the observed variant allele fractions of snvs for each sample and estimate the proportions of haplotypes . varying proportions of haplotypes across samples is evidence of tumor heterogeneity since it implies varying composition of cell subpopulations . </S>",
    "<S> taking a bayesian perspective , we proceed with a prior probability model for all relevant unknown quantities , including , in particular , a prior probability model on the binary indicators that characterize the latent haplotypes . </S>",
    "<S> such prior models are known as feature allocation models . </S>",
    "<S> specifically , we define a simplified version of the indian buffet process , one of the most traditional feature allocation models . </S>",
    "<S> the proposed model allows overlapping clustering of snvs in defining latent haplotypes , which reflects the evolutionary process of subclonal expansion in tumor samples .    </S>",
    "<S> ./style / arxiv - general.cfg    ,    , </S>"
  ]
}