{
  "article_text": [
    "neutron stars are believed to form a crystalline outer crust as they age and cool , but retain a fluid ( probably superfluid ) core @xcite .",
    "a mathematical framework for weak solutions of general relativistic elasticity is likely to be indispensable for the modelling of neutron star crusts in at least two scenarios : starquakes and binary mergers .",
    "pulsars are observed to spin down at a regular rate , losing angular momentum through gravitational and/or electromagnetic radiation .",
    "occasionally the rotation spins up suddenly .",
    "one model suggests that such a `` glitch '' occurs when the elastic crust breaks and the inertial moment of the star decreases suddenly as a consequence ( e.g.  @xcite ) .",
    "it has also been suggested @xcite that starquakes are the cause of soft gamma repeaters ( sgrs ) .",
    "quasi - periodic oscillations in the tails of giant flares in sgrs have been suggested @xcite to provide direct observational evidence for crust oscillation modes , although the modelling of neutron star oscillations even in perturbation theory is complicated by the coupling between the crust , the fluid core and a strong magnetic field ( see e.g.  @xcite ) .",
    "a correct model would of course have to be nonlinear .",
    "finally we note that strong shocks also arise when two old neutron stars in a binary system merge . the detailed dynamics and features , such as the breaking strain ( see @xcite ) , of the crust , will determine when and where the crust melts and breaks",
    ". this will in turn impact on the post - merger dynamics , such as the time taken by the remnant to collapse to a black hole ( see e.g.  @xcite ) .",
    "for all these scenarios , models must therefore comprise an elastic crust , a fluid core , and a magnetic field permeating both . as a step towards such models ,",
    "we present here a formulation of ( hyper)elastic matter in general relativity in the form of conservation laws amenable to solution by high - resolution shock - capturing ( hrsc ) numerical methods .",
    "these conservation laws are the union of the usual stress - energy conservation ( dynamics ) , and a set of conservation laws for a deformation tensor ( kinematics ) .",
    "the kinematic equations are essentially the same in newtonian and relativistic physics , but the literature on weak solutions of newtonian elasticity uses cartesian tensor notation , which obscures the geometric nature of the theory . in sec .",
    "[ section : kinematics ] , we derive these equations carefully , using the language of differential geometry . following carter and quintana @xcite , we begin with a map from spacetime to a 3-dimensional matter space .",
    "the main object we calculate with is its derivative @xmath0 . as a partial derivative ,",
    "this is subject to integrability conditions . under",
    "a 3 + 1 split these become evolution equations and constraints , of a purely kinematic nature , both of which can be written as conservation laws .",
    "we show that their physical significance is to allow discontinuities in the density and kinks but forbid discontinuities in the crystal axes and particle world lines .",
    "the other , dynamical , half of the problem consists in finding the stress - energy tensor from @xmath0 and an equation of state .",
    "we do this in sec .",
    "[ section : dynamics ] , following karlovini and samuelsson @xcite .",
    "in particular , demanding covariance on both spacetime and matter space restricts the possible dynamics . for isotropic matter",
    ", the equation of state can relate only two deformation scalars , besides the number density , internal energy , and entropy .",
    "similarly , the stress - energy tensor depends on the equation of state through two generalised forces .    in sec .",
    "[ section : hyperbolicity ] , we prove that our kinematic and dynamical equations together form a first - order system of evolution equations that , by constraint addition , can be made hyperbolic _ if the constraints ( [ caij ] ) are obeyed or not .",
    "_ this property is crucial for the stability of numerical solutions in which the constraints are left to evolve freely , and hence finite difference error generically generates constraint violations .",
    "we use the methods of beig and schmidt @xcite , who proved symmetric hyperbolicity of an inequivalent first - order system ( one which would not be appropriate for modelling weak solutions ) .    in order to make contact with existing work on ideal fluid dynamics and magnetohydrodynamics in general relativity , in sec .",
    "[ section : valencia ] we present our dynamical equations as a generalisation of the valencia @xcite formulation of hydrodynamics .",
    "we give an algorithm for the conversion between conserved and primitive variables .    as a first test of our formalism , we present numerical time evolutions of riemann problems in sec  [ section : numerics ] .",
    "the variables are three - dimensional , and the grid is either one - dimensional , or two - dimensional with the riemann problem at an angle to the grid .",
    "we compare the relativistic code in the newtonian limit with an explicitly newtonian code , and both with published newtonian riemann problems @xcite .",
    "we also compare against exact riemann solutions in the relativistic regime in minkowski spacetime .",
    "we compare the eulerian and mixed formalisms , and evolutions where the number density is either read off from the deformation tensor , or evolved separately .    in sec .",
    "[ section : conclusions ] we summarize the results of the paper , and discuss the work remaining to apply these methods to full 3 + 1 nonlinear simulations .",
    "we collect relevant formulas from the standard 3 + 1 split of spacetime in appendix  [ appendix:3 + 1 ] , and relevant definitions of hyperbolicity in appendix  [ appendix : hyperbolicity ] .",
    "one of two existing newtonian formalisms @xcite is essentially the newtonian limit of our formalism .",
    "we derive the newtonian limit in appendix  [ appendix : newtonianlimit ] . in appendix",
    "[ appendix : mixed ] we derive the equations of an alternative newtonian formalism @xcite , and prove that the two have the same weak solutions .",
    "the remaining appendixes contain auxiliary material on our numerical method and our numerical tests : appendix  [ section : discreteconstraints ] proposes a general framework for discrete constraint preservation ( similar to `` constrained transport '' for mhd ) , and appendix  [ appendix:2d ] presents our implementation of riemann tests on a 2-dimensional grid .",
    "appendix  [ appendix : eos ] describes the equations of state we use .",
    "appendix  [ sec : exactsolns ] summarizes how we construct exact solutions for specific riemann problems and appendix  [ appendix : initialdata ] the initial data for our riemann tests used here .",
    "we have attempted as far as possible compatibility with the notation of @xcite , @xcite and @xcite . throughout this paper , tensor indices",
    "are assumed to be in a generic local coordinate basis .",
    "partial derivatives in this basis are indicated by commas .",
    "indices @xmath1 are spacetime indices , @xmath2 are spatial indices on @xmath3 hypersurfaces , and @xmath4 are matter space indices on a 3-dimensional matter space @xmath5 . in appendix",
    "[ appendix : mixed ] , the indices @xmath6 are matter space indices on an extended matter space @xmath7 . in secs .",
    "[ section : dynamics ] and [ section : hyperbolicity ] , @xmath8 are used to label elastic forces . in appendix",
    "[ appendix : hyperbolicity ] , @xmath9 label the variables of a generic hyperbolic system .",
    "for all these indices a summation convention applies .",
    "in order to take determinants of 2-index objects which are not ( 1,1 ) tensors , we introduce the non - tensorial totally antisymmetric symbol @xmath10 , which is defined to be @xmath11 , etc . with the exception of the objects @xmath10 , throughout this paper ,",
    "all objects transform as tensors of the type indicated by their free indices , unless we indicate otherwise by a suffix : for example , the determinant of the spacetime metric in coordinates @xmath12 will be denoted by @xmath13 .",
    "in the relativistic framework of @xcite , the matter configuration is encoded in a map from 4-dimensional spacetime to 3-dimensional matter space @xmath14 or in local coordinates @xmath12 on spacetime and @xmath15 on matter space , @xmath16 for simplicity of notation we denote the derivative @xmath17 of @xmath18 by a new symbol @xmath19 , @xmath20 @xmath21    for time evolutions , we introduce a time - foliation of the spacetime , so that we have @xmath22 with derivatives @xmath23 following @xcite , we shall call @xmath24 the _ configuration _ and both @xmath25 and @xmath0 the _ configuration gradient_.    the matter space coordinates @xmath15 label particles and must therefore be constant along particle world lines , so that @xmath26 where the 4-velocity @xmath27 is tangential to the matter world lines . parameterising the 4-velocity in the standard way as @xmath28 ( see appendix  [ appendix:3 + 1 ] for more details )",
    ", we have @xmath29    the configuration gradient @xmath0 is also used as the primary variable in the newtonian framework of @xcite ( denoted there by @xmath30 ) .",
    "this framework is the newtonian limit of our relativistic one . in appendix  [",
    "appendix : newtonianlimit ] we derive the newtonian limit of our framework .",
    "other newtonian papers @xcite use the the @xmath31 matrix inverse of @xmath0 , which we shall denote by @xmath32 , as the primary variable ( denoted there by @xmath33 ) .",
    "we review this alternative framework in appendix  [ appendix : mixed ] . in the newtonian literature , @xmath32 is commonly called the ( lagrangian ) deformation gradient , and @xmath0 the inverse deformation gradient . from a geometric point of view , however , these objects on their own carry no information about what one might intuitively call a deformation .      from the definition of @xmath25 as a partial derivative , we have the integrability conditions @xmath34}=0.\\ ] ] in a 3 + 1 split , these become @xmath35 } = 0 , \\\\ \\label{eai } { e^a}_i & : = & 2c^a{}_{it } = { \\psi^a}_{i , t}+ \\left(\\hat v^j{\\psi^a}_j\\right)_{,i}=0.\\end{aligned}\\ ] ] the constraints ( [ caij ] ) are conserved by the evolution equations ( [ eai ] ) .",
    "note that these equations are already in conservation law form : more explicitly , @xmath36}\\right)_{,l } = 0 , \\\\",
    "\\label{eaibis } { e^a}_i & = & { \\psi^a}_{i , t}+ \\left(\\hat v^j{\\psi^a}_j\\delta^k_i\\right)_{,k}=0.\\end{aligned}\\ ] ]    instead of @xmath37 as an evolution equation for @xmath0 , we shall in fact use @xmath38}+2\\hat v^j\\psi^a{}_{[i , j]}=0.\\ ] ] this can be written as a balance law obtained from the conservation law ( [ eai ] ) by adding a source term that is proportional to the constraint ( [ caij ] ) , namely @xmath39}.\\ ] ] note that this can not be written in pure conservation law form .    in handwaving anticipation of the hyperbolicity analysis presented in sec .",
    "[ section : hyperbolicity ] , we point out in passing that ( [ eaitres ] ) can be written as an advection equation for @xmath0 with a source term that is of lower order in @xmath0 , namely @xmath40 for _ given _",
    "@xmath41 , this is strongly hyperbolic in @xmath0 , whereas ( [ eai ] ) is only weakly hyperbolic .",
    "the geometric meaning of the integrability conditions ( [ caab ] ) is that the particle world lines and the instantaneous crystal lines ( i.e.  lines of constant @xmath15 ) all mesh up into a four - dimensional grid . in particular , the world lines and crystal lines are continuous . the weak form of these equations must therefore keep them continuous while allowing them to kink , thus forbidding dislocations and fractures . to stress their purely kinematic nature , we shall discuss them without invoking a metric on spacetime or matter space .",
    "we ignore the source term in the evolution equations ( [ eaitres ] ) in deriving the rankine - hugoniot conditions , because it has no effect on physical solutions , which obey the constraints .",
    "consider a surface of discontinuity in space ( from now on called a shock for briefness ) .",
    "let @xmath42 be a covector normal to the shock ( uniquely defined up to an overall factor ) .",
    "let @xmath43 be the shock velocity vector ( defined , in the absence of a metric , only up to the addition of a vector tangential to the shock ) , and let @xmath44 ( which inherits the arbitrary factor in @xmath42 but not the arbitary vector in @xmath43 ) be the normal shock speed .",
    "the jump ( rankine - hugoniot ) conditions arising from ( [ caijbis ] ) and ( [ eaibis ] ) are then @xmath45}\\right]n_l = 0 ,",
    "\\\\ \\label{eaijump } -s\\left[{\\psi^a}_i\\right]+ \\left[\\hat v^j{\\psi^a}_j\\delta^k_i\\right]n_k=0.\\end{aligned}\\ ] ]    we want to decompose these conditions into parts normal and parallel to the shock .",
    "let @xmath46 be a vector that obeys @xmath47 .",
    "@xmath46 is therefore uniquely defined up to the factor in @xmath42 , and the addition of an arbitrary vector tangent to the shock .",
    "define the tensor @xmath48 it is the projection operator into the tangent plane of the shock in the sense that @xmath49 split into normal and tangential components defined by @xmath50 and @xmath51 , the jump conditions can now be compactly written as @xmath52&=&0 , \\\\",
    "\\label{psijump2 } { [ \\psi^a{}_n(\\hat v^n - s)]}+\\psi^a{}_{\\parallel i } [ \\hat v^{\\parallel i}]&=&0.\\end{aligned}\\ ] ] the first of these guarantees the continuity of crystal lines ( @xmath15 lines ) across the shock , or the absence of `` surgery across the shock '' , as illustrated in figs .",
    "[ fig : nosurgery1 ] and [ fig : nosurgery2 ] .",
    "the second guarantees the conservation of particles as they cross the shock .",
    "consider the special case where @xmath53 is continuous .",
    "then , in the rest frame of the shock , @xmath54=0 $ ] .",
    "this is a pure `` density '' shock of the type familiar from fluid dynamics , and is illustrated in fig .",
    "[ fig : pressureshock ] .",
    "conversely , consider the case where @xmath55 is continuous . then , again in the rest frame of the shock , @xmath56 + \\psi^a{}_{\\parallel i}[\\hat v^{\\parallel    i}]=0 $ ] .",
    "this is a pure travelling kink , set up by a discontinuity in the tangential velocity , as illustrated in fig .",
    "[ fig : shearshock ] .",
    "fluids allow for a contact discontinuity where the tangential velocity jumps .",
    "this is replaced by the travelling kink in elastic matter .",
    "( the only contact discontinuity that survives is the one where the entropy jumps . )",
    "this holds even in the limit where the dynamics goes to the fluid limit ( the stiffness goes to zero and the stress - energy tensor becomes that of a fluid ) , and so the fluid limit is singular .     a discontinuity of the type illustrated here is not allowed by the jump conditions ( it would require `` surgery '' on the material )",
    ". for simplicity and without loss of generality , we choose space and matter space coordinates in this and the next three figures so that the shock is along the @xmath57 axis and @xmath58 in the left state .",
    "this type of surgery is then forbidden by @xmath59=0$].,width=226 ]     this type of surgery is forbidden by @xmath60=0 $ ] .",
    "the coordinate choices are as in fig .",
    "[ fig : nosurgery1].,width=226 ]     a pure density shock , with @xmath61 continuous , shown in the rest frame of the shock .",
    "this is essentially a one - dimensional phenomenon .",
    "`` density '' and velocity on the left and right ( shown as arrows ) are related ( in these coordinates ) by @xmath62=0 $ ] .",
    ", width=226 ]     a pure travelling kink , shown in the rest frame of the left state . for simplicity ,",
    "we have assumed @xmath63 to be continuous , which implies that @xmath64 is continuous and the `` volume density '' is continous .",
    "however , the `` line density '' along the @xmath65 crystal axis is discontinuous .",
    "the shock speed and shear speed ( shown as arrows ) in these coordinates are related by @xmath66.,width=226 ]      the minimal geometric structure on matter space is a volume form @xmath67 whose integration over a volume in matter space gives the number of particles in that part of matter space .",
    "in addition , at least a conformal metric is required to define angles on matter space , which can then be compared with angles on spacetime to define deformations .",
    "but together these two structures define a full riemannian metric @xmath68 .",
    "( `` distances '' are measured in particles , not meters ) .",
    "therefore we now assume that @xmath68 is defined and @xmath67 is compatible with it",
    ". in matter coordinates @xmath15 this means that @xmath69 where @xmath70 is the usual determinant .",
    "the suffix @xmath71 is a reminder that it is not a scalar on matter space but depends on the @xmath15 coordinates .",
    "we use @xmath68 as an example to discuss the `` evolution '' of tensors on matter space .",
    "matter space itself has no time , but as we are using a eulerian framework , we effectively consider @xmath72 as a function on spacetime .",
    "the push - forward of @xmath68 to a tensor @xmath73 on spacetime obeys @xmath74 formally , tensor fields on matter space could be defined as tensors on spacetime whose lie derivative along @xmath27 and contractions with @xmath27 all vanish , and this is indeed the approach of @xcite , and partly of @xcite .",
    "however , equivalently the components @xmath72 can be considered as scalars on spacetime that are constant along particle world lines , so that @xmath75 or in coordinates @xmath76 numerically , we prefer to work with @xmath68 , which has fewer components and a simpler evolution equation than @xmath73 .",
    "following @xcite , we consider the push - forward of @xmath67 to a 3-form @xmath77 on spacetime @xmath78 spacetime also has a volume form @xmath79 , compatible with a lorentzian metric @xmath80 . in arbitrary coordinates , @xmath81 ( we have defined @xmath82 as positive for ease of notation ) .",
    "we then define the particle number current @xmath83 this is timelike , and conserved , @xmath84 where @xmath85 is the covariant derivative compatible with @xmath80 .",
    "the right - hand side vanishes because it is the push - forward of @xmath86}$ ] , which must vanish as it is a 4-form on a 3-dimensional space .",
    "we split @xmath87 into a matter 4-velocity and a particle density @xmath88 where @xmath27 is normalised as @xmath89 ( and hence @xmath90 ) . in coordinates , using ( [ gtogamma ] ) and ( [ valenciau ] ) , @xmath91 becomes @xmath92    conversely , we can relate the particle density and current via @xmath93 , and substituting ( [ valenciaudown ] ) into this and using ( [ 3eps4eps ] ) , we obtain @xmath94 here @xmath95 are the space components of the 4-dimensional 3-form @xmath77 in the adapted coordinates @xmath96 , and @xmath97 is the determinant @xmath98    we now show explicitly that @xmath99 is a linear combination of the evolution equations ( [ eai4 ] ) for @xmath0 , that is , the kinematic evolution equations _ with _ the hyperbolicity fix . contracting ( [ eai4 ] ) with @xmath32 , the matrix inverse of @xmath0 , and using the matrix identity @xmath100 , we obtain @xmath101 working from the other end , we insert ( [ rhogr ] ) and ( [ uaup ] ) into ( [ ufromj ] ) and use ( [ gtogamma ] ) to obtain @xmath102 hence @xmath91 is equivalent to @xmath103 but with the advection equation @xmath104 which follows from ( [ kadvection ] ) , this is equivalent to ( [ detpsihyperbolic ] ) .",
    "we begin with the matter action @xmath105 where the dots stand for any other tensors on matter space and @xmath106 is the entropy per rest mass ( a scalar on matter space ) . varying for now only the metric , the standard definition of the stress - energy tensor @xmath107 , @xmath108 evaluates to @xmath109    we define a projector into the tangent space normal to the 4-velocity , @xmath110 @xmath111 should not be confused with the projector @xmath112 into the @xmath113 hypersurfaces defined in ( [ gammaab ] ) .",
    "we can now write @xmath114 where @xmath115 which is by definition symmetric .",
    "we define the pull - back of the spacetime metric to matter space , @xmath116 we define @xmath117 as its matrix inverse .",
    "we therefore now have two riemannian metrics on matter space , namely @xmath117 and @xmath68 . as a matter of convention and terminology",
    ", we will refer to @xmath68 ( only ) as _ the _ matter space metric , but we will later implicitly move matter space indices ( only ) with @xmath117 and @xmath118 .",
    "note that in this convention @xmath119 , and that this is not the matrix inverse of @xmath68 .",
    "( we note in passing that the newtonian limit @xmath120 of @xmath118 is commonly called the finger tensor in the newtonian literature .",
    "the newtonian literature implicitly assumes that @xmath68 and @xmath121 are flat and given in cartesian coordinates and moves indices implicitly .",
    "moreover , some expressions can only be made sense of if @xmath32 and @xmath0 are also used implicitly to convert between space and matter space indices . )    as a further illustration of these conventions , the quantity @xmath122 is the inverse of @xmath25 ( which is not a square matrix , and so has no matrix inverse ) in the sense that @xmath123 ( the first of these follows directly from the definition of @xmath117 as the matrix inverse of @xmath118 .",
    "the second can be shown by verifying that the right - hand side is normal to @xmath27 and @xmath124 , and obeys @xmath125 . )    from covariance in both spacetime and matter space , we must have @xmath126 as this is the only way the spacetime indices on @xmath25 and @xmath127 can be contracted .",
    "( a more formal proof is given in @xcite . ) hence @xmath128 hence @xmath129 , and so @xmath130 .",
    "this means that there is no energy flux relative to the matter . in this sense",
    "we are dealing with ideal ( non - dissipative ) elastic matter .",
    "@xmath131 is called the pressure tensor ( for a perfect fluid , @xmath132 , where @xmath133 is the pressure ) , and we now see that the lagrangian @xmath134 in the action ( [ action ] ) evaluates ( for solutions to the euler - lagrange equations ) to the total energy density ( in the rest frame of the matter ) .",
    "we next note that @xmath135 from its relation to the matter space volume form ( [ nabcdef ] ) , @xmath77 is independent of @xmath127 in the sense that it is constructed only from @xmath67 and @xmath136 .",
    "hence , taking a derivative of ( [ n2fromnabc ] ) , @xmath137 where in the partial derivative @xmath138 is considered as a function of @xmath127 , @xmath136 and the matter tensors , as well as @xmath106 .",
    "then , defining @xmath139 by @xmath140 we have @xmath141 with the same definition of the partial derivative .",
    "( @xcite and @xcite define @xmath142 . here",
    "we take the rest mass out of the energy density to agree with the usual definition of @xmath139 in relativistic hydrodynamics as the _ internal _ energy per rest mass . ) similarly to ( [ dedgab ] ) , we can write ( [ pabfromepsilon ] ) as @xmath143 where we have defined @xmath144 ( the newtonian limit of @xmath145 is commonly called the second piaola - kirchhoff tensor in the newtonian literature , modulo the implicit assumptions mentioned above . )      we now specialise to the case that the specific internal energy @xmath139 depends on @xmath127 , @xmath136 , @xmath106 and a single matter tensor , the metric @xmath68 .",
    "( modelling matter with an anisotropic crystal structure would require @xmath134 to depend on additional tensor fields on matter space , such as a preferred frame . )",
    "@xmath134 and hence @xmath139 should transform as a scalar both on spacetime and on matter space .",
    "we therefore need to find all double scalars that can be made from @xmath118 and @xmath68 .    from ( [ gabdef ] ) , we see that @xmath118 transforms as a ( 2,0)-tensor on matter space and as a scalar on spacetime . with this in mind",
    "we define @xmath146 this transforms as a scalar on spacetime and as a @xmath147 tensor on matter space .",
    "hence its eigenvalues transform as scalars on matter space .",
    "they are the required double scalars .",
    "( we note that @xcite work with the ( 1,1)-tensor on spacetime @xmath148 instead .",
    "this has the same eigenvalues as @xmath149 plus one zero eigenvalue . )",
    "we split the matrix @xmath150 into its determinant @xmath151 and a unit determinant matrix @xmath152 , @xmath153 and note that the determinant is related to the particle density by @xmath154}^f{k^a}_d\\,{k^b}_e\\,{k^c}_f \\",
    ",   \\nonumber \\\\ & = & g^{[a|d } k_{ad } \\",
    "g^{|b|e } k_{be } \\",
    "g^{|c]f } k_{cf } \\nonumber \\\\ & = & { 1\\over 3 ! } g^{ad } g^{be } g^{cf } n_{abc } n_{def } \\nonumber \\\\ & = & n^2,\\end{aligned}\\ ] ] where the first equality is the usual definition of the determinant of a matrix , the second reminds us that for a ( 1,1)-tensor this is actually a scalar , the third is the definition of @xmath150 , the fourth follows from the fact that @xmath67 is the volume form of @xmath68 , and the last one is ( [ n2fromnabc ] ) pulled back to matter space .",
    "we can now consider the specific internal energy @xmath139 as a function of @xmath138 , @xmath155 and @xmath106 .",
    "in fact , it can depend on @xmath155 only through its scalar invariants , of which there are precisely two independent ones .",
    "hence @xmath156 where @xmath157 as just shown and we have defined @xmath158 with @xmath117 defined as the matrix inverse of @xmath118 we have @xmath159 and hence @xmath160 we find @xmath161 where @xmath162    substituting ( [ tauabexpression ] ) into ( [ pabfromtauab ] ) , we see that @xmath163 with the first term the stress tensor of a perfect fluid and the second term representing the anisotropic stress , @xmath164 where @xmath165 hence @xmath166 is a tracefree spatial tensor in the sense that @xmath167 moreover , @xmath166 vanishes if @xmath139 depends only on @xmath138 and @xmath106 , which is the fluid limit .",
    "we also note that with the temperature defined by @xmath168 the first law of thermodynamics on a per particle basis can be written as @xmath169 so @xmath170 are `` generalised forces '' in the thermodynamical sense .",
    "elastic matter at a given density @xmath138 has an _ unsheared _ state that minimises @xmath139 at fixed @xmath138 , but one can not assume that there exists a _",
    "relaxed _ state that minimises @xmath139 absolutely , including under variation of @xmath138 .",
    "this is because at sufficiently low pressure , and hence @xmath138 , the matter may be in a fluid rather than solid state @xcite .",
    "it is intuitively clear that the unsheared state corresponds to @xmath171 .",
    "in fact , we see from ( [ pi1def],[pi2def ] ) that @xmath166 vanishes for all values of @xmath25 if and only if @xmath171 .",
    "this means that @xmath172 is the matrix inverse of @xmath118 , or @xmath173 hence @xmath174 in the unsheared state .",
    "it is natural to assume that matter freezes in the unsheared state .",
    "hence we set @xmath68 to ( [ unsheared ] ) at the moment of freezing , and advect it via ( [ kadvection ] ) afterwards .",
    "note that @xmath117 is the pull - back of @xmath111 , which even in special relativity is not flat , so in general @xmath68 will not be flat , except in the newtonian limit where @xmath175 is flat and even then only if @xmath138 takes a constant value at freezing .",
    "for smooth solutions , it is natural to consider the relativistic elasticity equations as a system of second - order pdes in the variables @xmath176 . in order to show existence and uniqueness of solutions , beig and",
    "schmidt @xcite have introduced an explicit reduction to first order of these equations , and have shown that the reduction is a first - order symmetric hyperbolic system , at least in the unsheared state .",
    "the reduction of any second - order system to first - order hyperbolic form is complicated by the fact that the reduction creates definition constraints on the auxiliary variables ( here , @xmath177}=0 $ ] ) , which can be added to the evolution equations to change their principal part and hence their hyperbolicity properties .",
    "( we note in this context that in @xcite a definition of symmetric hyperbolicity for a second - order system has been given as the _ existence _ of a symmetric hyperbolic reduction to first , together with a _ necessary and sufficient _",
    "criterion for this reduction to exist , which is purely algebraic in terms of the principal symbol of the second - order system .",
    "hence if well - posedness of the second - order system is the only concern , constructing an explicit first - order reduction is unnecessary . )",
    "we have a different reason for constructing an explicit first - order reduction : we want to construct a numerical scheme that can accurately reproduce weak solutions of the relativistic elasticity equations . as for weak solutions of fluid mechanics ,",
    "the standard way of doing this is to construct hrsc numerical schemes for the equations in an appropriate first - order balance law form .    in this section",
    "we will show that the kinematic evolution equations ( [ eaitres ] ) , together with the dynamical evolution equations @xmath178 , form a symmetric hyperbolic system of evolution equations for @xmath25 , or equivalently @xmath0 and @xmath41 , if the constraints ( [ caij ] ) are obeyed or not .",
    "we also show that ( [ eaitres ] ) , together with just @xmath179 , as used in the newtonian formalisms @xcite , is strongly hyperbolic but not symmetric hyperbolic .    for completeness ,",
    "relevant standard definitions of hyperbolicity are summarised in appendix  [ appendix : hyperbolicity ] .      roughly speaking",
    ", the first - order equations for @xmath25 must be the second - order equations for @xmath24 , replacing @xmath180 by @xmath181 and adding multiples of the constraint @xmath182}$ ] to the right - hand sides .",
    "we therefore derive the second - order equations first , following @xcite .",
    "in particular , this will allow us to establish the standard connection between the matter evolution equations and stress - energy conservation .",
    "hence , in this subsection we consider @xmath127 and @xmath24 as the independent variables .",
    "we consider @xmath183 as a derived object , and we consider @xmath68 , any other matter space tensors , and @xmath106 , as fixed tensor fields on matter space that are not varied in the following .",
    "the action is @xmath184 after integration by parts , and neglecting the boundary terms , its variation is @xmath185 where the stress - energy tensor is given as before by ( [ tabfrome ] ) , and the euler - lagrange equations are @xmath186 note that these are second - order differential equations for @xmath24 .",
    "variations generated by an infinitesimal change of coordinates @xmath187 on the spacetime take the form @xmath188 the action must be invariant under such changes , and hence after another integration by parts @xmath189 hence stress - energy conservation holds if and only if the elastic matter field equations hold .",
    "@xmath190 has only three independent components , while @xmath191 has four .",
    "however , @xmath192 is equivalent to @xmath193 where a dot denotes @xmath194 .",
    "but this is just the first law ( [ firstlaw ] ) , evaluated along a particle worldline , for smooth solutions , so that @xmath195 .",
    "hence it is an identity if the stress - energy tensor is thermodynamically consistent with the equation of state .",
    "the matter equations in their second - order form can be written as @xmath196 where @xmath197 are the coefficients of the principal part and @xmath198 comprises all lower - order terms . from its definition ,",
    "@xmath199 we shall see that @xmath200 as defined by ( [ mdef ] ) is not symmetric in @xmath201 alone , even though @xmath202}{}_{ab}$ ] does not contribute to ( [ caleadef ] ) .      we shall write the principal symbol more explicitly in terms of the shear and the equation of state . from ( [ gabonly ] ) , @xmath203 where we have defined @xmath204 with @xmath205 this can be split into parts parallel and normal to the 4-velocity as @xmath206 where @xmath207 note that there are no cross terms , that is @xmath208 .",
    "we now evaluate the symbols @xmath209 and @xmath210 further . with ( [ epsilondef ] ) , using ( [ dndgab ] ) , we can rewrite @xmath211b } , \\end{aligned}\\ ] ] where @xmath145 was defined above in ( [ tauabdef ] ) , and analogously we have defined @xmath212    using the chain rule , we now express @xmath145 and @xmath213 as a sum of terms , each of which is a product of a matter scalar ( such as @xmath134 , @xmath133 , @xmath214 etc . ) and a tensor that depends only on the deformation .",
    "we can rewite the expression ( [ tauabexpression ] ) for @xmath145 more compactly as @xmath215 where @xmath216 labels the shear scalars , and we use a summation convention over @xmath217 . with the same notation , we can write @xmath218 where @xmath219 and @xmath220      the principal symbol simplifies considerably in the unsheared state , denoted by a circle , where @xmath221 and therefore @xmath222 where @xmath223 note that in the unsheared state only the combination @xmath224 appears .",
    "we finally obtain @xmath225 ( this reduces to eq .",
    "( 4.16 ) of @xcite in the special case @xmath226 . )",
    "any first - order reduction of the second - order system must have the form @xmath227 with @xmath228 where @xmath229}{}_{ab}\\ ] ] governs constraint addition .",
    "in particular , @xmath179 should give us the dynamical part of the equations , but as we shall see , in order to achieve symmetric hyperbolicity of the entire system , we will have to add constraints to these equations .",
    "it turns out that adding constraints only to the `` spatial '' part of @xmath200 is sufficient .",
    "hence , we consider the evolution equations @xmath230}=0,\\ ] ] where @xmath231 parameterises a family of constraint additions .",
    "to write @xmath232 in terms of @xmath25 , we start from @xmath233 keeping only the principal part in the matter variables , that is terms of the form @xmath234 , we find after some calculation that @xmath235a}\\right)\\psi^b{}_{b , c}+\\hbox{l.o.}\\ ] ]    substituting ( [ gupsi ] ) into ( [ intermediate ] ) , we find that @xmath236}\\bigr)\\psi^b{}_{b , c}+\\hbox{l.o.},\\ ] ] where @xmath237b})\\psi^{ca}\\psi^{db}.\\ ] ] the modification of @xmath200 can be pulled back to a modification of @xmath210 , namely @xmath238b}\\ ] ]    splitting @xmath239 into its parts parallel and normal to the 4-velocity , we have @xmath240 } , \\\\ \\label{psiebar } \\psi^a{}_a\\bar e^a&= & \\bar m^{cb}{}_{ab}\\psi^b{}_{b , c } -g^a.\\end{aligned}\\ ] ] but if @xmath209 is invertible , @xmath241 is equivalent to the kinematic evolution equations _ with _ hyperbolicity fix ( [ eaitres ] ) .      the definition of symmetric hyperbolicity for a general system of first - order evolution equations is reviewed in appendix  [ appendix : hyperbolicity ] . roughly speaking , the principal symbol must be symmetric , and its time component must be positive definite .",
    "we begin with the first condition .",
    "[ [ symmetry ] ] symmetry + + + + + + + +    the principal symbol of neither ( [ barcaleadef ] ) nor of ( [ ebar ] ) has the correct index structure @xmath242 in the composite index defined by @xmath243 .",
    "we follow the approach of beig and schmidt @xcite .",
    "define @xmath244a}{}_{ba}\\end{aligned}\\ ] ] and consider the system of first - order equations @xmath245 where @xmath24 and @xmath25 are now considered as independent variables , and @xmath246 is defined by the @xmath25 through ( [ nabcdef],[jdef],[ufromj ] ) .",
    "it is clear that each solution @xmath24 of the second - order system generates a solution @xmath183 of this first - order system .",
    "beig and schmidt @xcite prove the converse , that a solution @xmath0 of the first - order system obeying @xmath177}=0 $ ] gives rise to a second - order solution @xmath24 .",
    "the principal symbol of this system has now the correct index structure .",
    "it is easy to see that it is symmetric , in the sense that @xmath247 if and only if @xmath248 has the symmetry ( [ msymmetry ] ) . to achieve this ,",
    "we set @xmath249b},\\ ] ] where @xmath250 has the symmetries @xmath251 and will be determined when we consider positivity of the principal symbol below .",
    "we now verify that the system ( [ weqn],[uchi ] ) is equivalent to our evolution equations . from ( [ mdef3 ] ) and ( [ mbardef ] ) , we find @xmath252 and hence @xmath253 } u_{acbd}.\\end{aligned}\\ ] ] if @xmath210 is invertible as a matrix with composite indices @xmath254 and @xmath255 , we finally have the decomposition @xmath256}=0,\\\\ \\label{chiaadvection } { \\cal a}_a=0 \\quad & \\leftrightarrow & \\quad u^a \\chi^c{}_{,a}=0 , \\end{aligned}\\ ] ] we see that ( [ ue ] ) and ( [ psie ] ) are the same as ( [ uebar ] ) , ( [ psiebar ] ) in our formalism . finally , ( [ chiaadvection ] ) is equivalent to ( [ matteradvection ] ) ( plus similar equations for any other matter tensors ) , as @xmath257 by the chain rule .",
    "[ [ positive - definiteness ] ] positive definiteness + + + + + + + + + + + + + + + + + + + + +    the second condition for symmetric hyperbolicity is the existence of a timelike covector @xmath258 which makes the quadratic form ( energy norm ) @xmath259 positive definite , called a subcharacteristic vector .",
    "( the formal arguments @xmath260 and",
    "@xmath261 of this quadratic form are in the tangent bundle of the phase space , and can be thought of as perturbations of @xmath25 and @xmath24 about a background solution . ) decomposing @xmath260 uniquely as @xmath262 and choosing @xmath263 , we have @xmath264 hence @xmath265 is a subcharacteristic vector if @xmath209 and @xmath210 are positive definite .",
    "( note that then they are also invertible , as we assumed earlier . ) from ( [ muabunsheared ] ) , @xmath209 is positive definite in the unsheared state if @xmath266 .",
    "it remains to look at the positive definiteness of @xmath267 .",
    "we choose @xmath268b},\\ ] ] or equivalently @xmath269b}+2dg_{a[c}g_{d]b}\\ ] ] for the total constraint addition , where @xmath270 is a parameter to be determined now .",
    "for simplicity , we look again at the unstrained case .",
    "uniquely decomposing @xmath271 as @xmath272 where the first term is antisymmetric and the second symmetric and tracefree , we find @xmath273\\kappa^{ab}\\kappa_{ab}. \\nonumber \\\\\\end{aligned}\\ ] ] we now see that this quadratic form is positive definite , and hence our evolution equations are symmetric hyperbolic , for @xmath274 ( assuming that @xmath275 ) . hence , adding some constraints to @xmath276 is necessary for symmetric hyperbolicity , for example with the mid - range value of @xmath277 .    tracing all the definitions back , we can write this particular constraint addition as @xmath278 \\psi^b_{[b , c]}.\\ ] ] looking back , the first term in the square brackets makes the principal part of the second - order system symmetric , and the second makes it positive definite .",
    "as reviewed in appendix  [ appendix : hyperbolicity ] , @xmath279 is a characteristic covector of the first - order equations with characteristic variable @xmath280 if @xmath281 once again we decompose @xmath282 in the form ( [ mdef ] ) . fixing an irrelevant overall factor ,",
    "we parameterise the wave number @xmath279 as @xmath283 where @xmath284 is a unit covector on spacetime normal to @xmath27 and @xmath285 the corresponding unit ( with respect to @xmath118 ) covector on matterspace .",
    "as reviewed in appendix  [ appendix : hyperbolicity ] , @xmath286 is then the physical velocity of the mode relative to the matter .",
    "using the decomposition ( [ uw],[psiw ] ) , ( [ firstchar ] ) is equivalent to the pair @xmath287 moreover , symmetric hyperbolicity implies that @xmath267 is invertible and so ( [ firstchar1 ] ) is equivalent to @xmath288    eq .  ( [ firstchar1bis ] ) has two classes of solutions .",
    "one class obeys @xmath289 with @xmath290 restricted by ( [ firstchar2 ] ) to obey @xmath291 these modes travel at zero speed relative to the matter . as ( [ class1 ] ) represents 3 equations for 9 components of @xmath290 , there are 6 such modes .",
    "they can be parameterised explicitly as @xmath292    the other class obeys @xmath293 or equivalently @xmath294 hence these modes are physical , obeying the constraints .",
    "furthermore , all physical modes are of this form , which indicates that the modes in the class ( [ unphysicalmodes ] ) are all unphysical . substituting ( [ charfirstorder1 ] ) into ( [ firstchar2 ] )",
    ", we find @xmath295 or equivalently @xmath296 ( constraint addition drops out ) .",
    "this can be written as @xmath297 but , as reviewed in appendix  [ appendix : hyperbolicity ] , this is precisely the condition for @xmath279 to be a characteristic covector of the second - order system with characteristic variable @xmath298 .",
    "hence the physical modes of the first - order system correspond one - to - one to the modes of the second - order system .",
    "there are 6 of these , forming 3 pairs with speeds @xmath299 relative to the matter .",
    "we now look at the solutions of ( [ charvar ] ) in more detail .",
    "the general expression for @xmath300 is quite long , and so we begin our analysis with the unsheared state .",
    "we find @xmath301 where @xmath302 we can now read off the characteristic covectors and characteristic variables by inspection .",
    "transversal waves have eigenvectors obeying @xmath303 ( and so have two polarisations travelling with the same velocity ) , and @xmath304 then gives @xmath305 longitudinal waves have eigenvectors @xmath306 and @xmath304 gives @xmath307    taking the newtonian limit of these characteristic speeds , we can identify the shear modulus @xmath308 and the bulk modulus @xmath309 as @xmath310 ( these expressions hold in units where the speed of light @xmath311 is one , and where @xmath138 is the rest mass density , rather than the particle number density .",
    "otherwise they have to be multiplied by @xmath312 and the particle mass . )    in the general , sheared , case the matter space tensor @xmath300 is constructed from @xmath117 , @xmath118 , @xmath313 and @xmath285 .",
    "it would therefore be natural to decompose @xmath285 ( and @xmath314 ) into eigenvectors of @xmath313 , which are automatically also eigenvectors of @xmath315 .",
    "this can be done trivially by assuming that the index @xmath316 labels that basis , so that @xmath313 is diagonal .",
    "the result is of the form @xmath317 ( dropping the indices on @xmath300 ) .",
    "we have solved the resulting cubic equation for @xmath318 by computer algebra but the result is too complicated to be illuminating .",
    "furthermore , for numerical purposes we are interested in the _ coordinate _ speeds @xmath319 in the @xmath320 , @xmath321 direction of some eulerian coordinate system , that is , in characteristic covectors of the form @xmath322 this gives a characteristic equation of the form @xmath323 the resulting @xmath286 are not related to the characteristic speeds relative to the matter 4-velocity in a simple way , because of the appearance of the lorentz factor @xmath324 in the relativistic velocity addition . to solve ( [ coordinate_delta ] ) numerically",
    ", we use a standard linear algebra package to find the right eigenvectors @xmath325 and eigenvalues @xmath286 of the matrix @xmath326      in the newtonian literature , the evolution equations for @xmath0 are taken to be ( [ eaitres ] ) ( with constraint addition ) , but no constraints are added to @xmath179 .",
    "our results above show that the first - order system is then definitely not symmetric hyperbolic , as the term @xmath267 in the principal symbol is then not positive definite even in the unsheared state , and is not symmetric in general ( although it is symmetric in the unsheared state ) . however , the first - order system is still strongly hyperbolic if it admits a complete set of characteristic variables .",
    "we have just done the calculation in sec .",
    "[ section : characteristics_1 ] , and need to see only what changes if we can not assume that @xmath267 is symmetric and positive definite .",
    "( [ firstchar1 ] ) is no longer equivalent to ( [ firstchar1bis ] ) because @xmath267 may not have an inverse , but solutions of ( [ firstchar1bis ] ) are solutions of ( [ firstchar1 ] ) .",
    "furthermore , ( [ class1 ] ) only admits a larger solution space if @xmath267 does not have maximal rank , so it will still have 6 solutions , even if they can no longer be explicitly parameterised by ( [ class1parameterised ] ) .",
    "hence the 6 unphysical modes still exist .",
    "the 3 physical modes are completely unaffected by constraint addition ( as one would expect ) because we solve ( [ charfirstorder2bis ] ) to find them .",
    "hence we have proved that the first - order system consisting of ( [ eaitres ] ) and @xmath327 is strongly hyperbolic ( but not symmetric hyperbolic ) as long as the second - order system is strongly hyperbolic .",
    "the energy and momentum conservation laws in general relativity are the spacelike and timelike components of stress - energy conservation @xmath328 in @xcite , this is decomposed into four balance laws as @xmath329 & = &    t^{ab}\\nabla_{(a}(\\partial_j)_{b ) } , \\\\",
    "\\label{taudot } \\nabla_a\\left(-t^{ab } n_b\\right ) & = &    -t^{ab}\\nabla_{(a } n_{b)},\\end{aligned}\\ ] ] where @xmath330 is the unit normal on the @xmath113 surfaces .",
    "the right - hand sides can be seen as a failure of stress - energy conservation to split into separate proper conservation laws for the energy and each momentum component , due to the failure of the thee spatial coordinate basis vectors @xmath331 and the timelike unit normal vector @xmath330 to be killing .",
    "( the choice of the four basis vectors is merely conventional ) . in a 3 + 1 split ,",
    "( [ sjdot ] ) and ( [ taudot ] ) become @xmath332    we now restrict to the elastic matter stress - energy tensor @xmath333 to insert this into ( [ cons1 ] ) and ( [ cons2 ] ) , we need certain components of @xmath334 . from ( [ piab ] ) and ( [ psiat ] ) we have @xmath335 using the 3 + 1 decomposition of the metric , the components that we need in ( [ cons1],[cons2 ] )",
    "are @xmath336 from @xmath337 , we have @xmath338    in numerical hydrodynamics , the conservation laws for the stress - energy are closed by the equation of state together with the explicit particle number conservation law @xmath339 as we have shown in sec .",
    "[ section : particlecurrent ] , this evolution equation for @xmath138 is equivalent to that for @xmath0 ( with the hyperbolicity fix ) even when the constraints are not obeyed .",
    "therefore , where we write @xmath138 below , either value could be used without changing the hyperbolicity .",
    "however , we shall test this numerically by obtaining a value @xmath340 from @xmath0 and a value @xmath341 from @xmath342 , and using either the one or the other .    the conservation laws ( [ sjdot],[taudot],[rhoconservation ] ) can be written in the form @xmath343 ( note the explicit insertion of @xmath344 and @xmath217 , which is only a convention  we follow @xcite ) .",
    "the conserved variables @xmath345 are related to the primitive variables via @xmath346 where we have defined the standard specific enthalpy @xmath347 the corresponding fluxes are @xmath348 following @xcite , we have subtracted the rest energy from the total energy density in order to obtain the usual newtonian energy conservation law in the newtonian limit .      in any numerical scheme ,",
    "we frequently need to calculate the primitive variables @xmath138 , @xmath349 and @xmath139 from the related conserved variables @xmath342 , @xmath350 and @xmath351 , and hence further variables such as @xmath133 and @xmath352 that appear in the fluxes .",
    "we assume that we have an equation of state that relates @xmath139 , @xmath138 , @xmath106 and @xmath353 , and that we can use this to find the generalised forces @xmath133 and @xmath354 .",
    "we also assume that @xmath80 is evolved using the einstein equations , that @xmath68 is advected using ( [ kadvection ] ) and that @xmath0 is evolved using the balance law ( [ eaitres ] ) .",
    "( note that for our purposes @xmath355 is both a conserved and a primitive variable . )",
    "the obvious difficulty is that to calculate @xmath352 from @xmath356 , we need @xmath349 while @xmath352 is needed to extract @xmath349 from @xmath357 .",
    "we therefore need to proceed iteratively .",
    "we _ guess _ the primitive variables @xmath358 from @xmath359 we obtain @xmath360 and @xmath361 and hence @xmath324 from ( [ wdef ] ) , followed by @xmath341 from ( [ ddef ] ) and @xmath340 from ( [ rhogr ] ) ( we compute both , but choose one value to use as @xmath138 in the remainder of the calculation ) , @xmath349 from ( [ sidef ] ) and @xmath362 from ( [ taudef ] ) .",
    "we now have a complete set of primitive matter variables , but these will not be consistent with the equation of state .",
    "we therefore now recompute @xmath133 from the equation of state , compute @xmath118 from ( [ gabdef ] ) , and @xmath155 from @xmath68 and @xmath118 , and hence obtain @xmath363 and @xmath364 .",
    "we then compute @xmath166 from ( [ piab],[piab ] ) , using @xmath349 and the equation of state .",
    "hence we finally recompute @xmath365 and @xmath366 .",
    "we then have four residuals giving the discrepancy ( four numbers ) between our original guesses   and the recomputed values , as a function of the four initial guesses .",
    "we can now use any standard root - finding method , such as a newton solver , to find the solution ( and hence the correct primitive values ) to desired accuracy .",
    "( note : this will converge only with a good initial guess , and a solution may not exist or be unique in general . )    note that in the fluid limit we only need to guess @xmath133 , and our scheme then reduces to the standard conserved - to - primitive conversion , requiring a root find in one variable @xcite .",
    "the computer code used to produce the following results uses planar symmetry ; all of the variables in the code are 3-dimensional , but the system is only evolved in one or two dimensions .",
    "the numerical methods employed are those in  @xcite .",
    "briefly , the code uses a hrsc method with a third - order runge - kutta time evolution . in the reconstruction , standard slope limiting techniques , applied to the primitive variables are used  all results shown used van leer s mc limiter ( @xcite ) .",
    "the hll approximate riemann solver ( @xcite ) is used to calculate the fluxes .",
    "the code can be run using either the relativistic or newtonian set of governing equations .",
    "the hll flux is @xmath367 where @xmath368 and @xmath369 are the right and left reconstructed vectors of conserved variables for the @xmath370 and @xmath371 cells , respectively , and @xmath372 is an estimate of the absolute value of the largest coordinate characteristic speed .",
    "we set this either to @xmath373 at one point ( using the numerical calculation outlined in sec .",
    "[ section : characteristics_2 ] ) , to @xmath373 over the whole grid , or to a constant ( for example , @xmath374 in highly relativistic situations and assuming the matter evolution is causal ) .    in two dimensions",
    "standard directional splitting techniques are used .",
    "specifically , on our ( logically ) cartesian grid we compute the appropriate one dimensional fluxes @xmath375 required by equation   by sweeping through the grid lines one dimension at a time .",
    "the update terms are accumulated and applied simultaneously to minimize symmetry errors caused by the splitting .",
    "we briefly note that the performance of the code has been compared to a relativistic hydrodynamics code by reducing the elasticity code explicitly to the hydrodynamic limit . as none of our codes",
    "have been optimized for performance , any comparisons will be approximate .",
    "nevertheless , as the elasticity code is approximately 8 times slower than the hydrodynamic code on the same problem ( equivalently , the run - time of the hydrodynamic code is approximately 12% of the run - time of the elastic code ) we see that performance will likely be an issue in realistic simulations .      as discussed in sec .",
    "[ section : conversion ] , the particle number density @xmath138 can either be obtained from the conserved variable @xmath0 ( or its inverse @xmath32 in the mixed framework ) , or from the conserved variable @xmath342 .",
    "if we evolve @xmath342 as a dynamical variable and use @xmath341 to represent the primitive variable , we have one more variable than if we use @xmath340 .",
    "however , we have shown in sec .  [",
    "section : particlecurrent ] the evolution equations for @xmath341 and @xmath340 are equivalent even if the constraints are not obeyed , and so we expect that both formulations have identical stability properties .    in fact , when these two evolutions are compared , the rms relative error in the resulting data is small ; we expect that this is finite - differencing error , as it converges away between first and second order .",
    "hoewever , when @xmath340 and @xmath341 are compared for a single evolution where @xmath341 is dynamical , the difference is of the order of round - off error rather than finite - differencing error ; we suspect that this is an artifact of planar symmetry .",
    "a mixed framework using the inverse @xmath376 of the configuration gradient @xmath377 is outlined in appendix  [ appendix : mixed ] . for constraint satisfying initial data the results of the two frameworks",
    "should be the same .",
    "we have implemented both frameworks numerically and compared them .",
    "we find that the difference is on the order of the finite differencing error for constraint satisfying initial data , as expected .",
    "some of the tests given in @xcite and @xcite do not satisfy the constraints  namely the second test in @xcite and the fifth test in @xcite . as the evolution of such data depends on the choice of constraint addition to the equations",
    ", we would expect it to depend on the framework used .",
    "our numerical results obtained in the `` mixed '' framework ( presented in appendix  [ appendix : mixed ] ) , which is that used in @xcite , matches their numerical results for all tests . our results using the eulerian framework ( presented in sec .",
    "[ section : kinematics ] and also used by @xcite ) match only for the physical tests , where the initial data obey all constraints .",
    "to validate our newtonian code , and the newtonian limit of our relativistic code , we have compared our results to two previously published studies ( @xcite and @xcite ) .",
    "these results use the newtonian theory and the mixed framework outlined in appendix  [ appendix : mixed ] .    broadly the results obtained from our codes matched those shown in @xcite and @xcite . as an example , we show the results for the first test of @xcite in figs .  [",
    "fig : bdrt_scalars_200][fig : bdrt_psi_1000 ] , using the results of the newtonian code .",
    "the precise initial data used is outlined in appendix  [ appendix : initialdata ] .",
    "we see the seven waves expected for this solution ; three left travelling rarefactions ( the second is very small ) , a contact , two right travelling rarefactions ( again the second is very small ) , and a fast shock . for clarity , the wave structure of the exact solution is shown in fig .",
    "[ fig : bdrt1_structure ] .",
    "all waves are captured with only minor under / over shoots , and the numerical solutions converge to the exact solution @xcite with resolution , as seen by comparing figs .",
    "[ fig : bdrt_scalars_200 ] and [ fig : bdrt_psi_200 ] with figs .",
    "[ fig : bdrt_scalars_1000 ] and [ fig : bdrt_psi_1000 ] .",
    "similar results are seen for all comparison tests .",
    "however , not all of the tests run robustly for all numerical methods possible within our code .",
    "an example is the sonic point test problem outlined in @xcite ( see in particular figs .",
    "5 - 7 there ) . at the contact discontinuity",
    "there is an unphysical `` dip '' in the density and a corresponding `` jump '' in the internal energy .",
    "this is the classical `` wall - heating '' effect seen by most numerical methods when strong rarefactions separate ( e.g. , on reflections from walls or the origin in spherical symmetry  see @xcite for the classical case and @xcite for a brief discussion of the relativistic case ) . in our case",
    "these artefacts lead , for certain choices of numerical parameters , to numerical results that are unphysical .",
    "this typically manifests itself by an imaginary characteristic speed , usually as the squared sound speed becomes negative .",
    "variants of the code which rely on calculations of the characteristic information immediately fail .",
    "this problem will only affect some numerical methods at low accuracy in certain , somewhat artificial , situations , so is unlikely to cause problems in realistic situations .",
    "finally , we note that a direct and comprehensive comparison to the results of @xcite is complicated by two issues .",
    "firstly the units for the entropy appear inconsistent there , as detailed in appendix  [ appendix : initialdata ] .",
    "secondly we do not find agreement in the comparison of the pressure tensor @xmath378 ( denoted @xmath379 there ) . as all other values and wave speeds",
    "match up well , and we have comprehensive quantitative agreement with the results of @xcite , we believe our results to be correct .",
    "we see convergence to the correct weak solution.,scaledwidth=49.0% ]     we see convergence to the correct weak solution.,scaledwidth=49.0% ]    , and compared against the newtonian results .",
    "the results for @xmath380 ( appropriately scaled by @xmath381 ) are representative of the behaviour of all quantities .",
    "we see that as @xmath381 increases the newtonian limit is approached .",
    "10000 points were used in each case and only 100 plotted for clarity.,scaledwidth=49.0% ]      the code ( both relativistic and newtonian ) uses geometric units where the speed of light is one . in particular , all velocities are of the form @xmath382 where @xmath383 is a dimensionless velocity , @xmath384 its value in conventional units and @xmath385 the value of the speed of light in the same units . all parameters in the equation of state , such as @xmath139 and @xmath214 , are treated analogously .",
    "there is no need to rescale rest mass and length , as long as units are used consistently .    changing @xmath385 while keeping @xmath384 etc .",
    "fixed is a trivial scale invariance of the newtonian equations and their solution , but in the relativistic equations decreasing @xmath385 with @xmath384 etc .",
    "fixed makes the same test problem more relativistic .",
    "we can use this to obtain an insight into the effects of ( special ) relativity , and to verify that our relativistic code has the correct newtonian limit as @xmath386 .    in fig .",
    "[ fig : bdrt_newtonianlimit ] we show the results from the relativistic code run with a small range of values for @xmath381 . only relatively small values of @xmath381 are shown ",
    "@xmath387 and @xmath388 , compared to a typical velocity in the ( newtonian ) riemann problem of @xmath389  as for sufficiently large values of @xmath381 the results are visually indistinguishable .",
    "we see that the results from the relativistic code are qualitatively similar , in terms of wave structure and accuracy , and approach the newtonian results in the limit @xmath390 .",
    "in the genuinely relativistic limit we have tested our code against exact solutions constructed by solving a pre - determined wave structure .",
    "the explicit procedure is detailed in appendix  [ sec : exactsolns ] and follows the method used in the newtonian case outlined in @xcite , without constructing a full riemann problem solver .",
    "we have verified that the code behaves correctly for single shocks and rarefactions in the relativistic limit , and for some invented initial data sets that test a range of wave structures . as an example , we show in figs .",
    "[ fig : sr_4wave_scalars_200][fig : sr_4wave_psi_1000 ] the results for a four wave problem . for clarity ,",
    "the wave structure of the exact solution is shown in fig .",
    "[ fig : sr_4wave_structure ] .",
    "there are two left - going rarefactions ( 1 and 2-waves ) , one right - going rarefaction ( a 6-wave ) and a right going shock ( 7-wave ) .",
    "the central three waves  the nonlinear 3 and 5-waves and the contact  are all trivial .",
    "we note that some of the quantities change so rapidly across some rarefaction waves that they are only visually distinguishable from shocks at high magnification .",
    ".,scaledwidth=49.0% ]    .",
    "the solution is computed using 200 points but only 100 are plotted for clarity .",
    "we see that all waves are captured well and with only minor under / over shoots.,scaledwidth=49.0% ]     we see the expected convergence.,scaledwidth=49.0% ]     we see the expected convergence.,scaledwidth=49.0% ]    even with the violent behaviour displayed across some waves in this four wave test , we find our code matching the exact solution well , with no unphysical oscillations and only minor under and overshoots that converge away with resolution .",
    "there are the expected minor oscillations near the trivial waves , most noticeable near the contact , but again these converge with resolution .",
    "results for the bdrt1 riemann test , calculated on a two - dimensional grid for three different angles between the initial discontinuity and the grid , each at two resolutions .",
    "the initial discontinuity was placed on the line given above each plot . in order to compare the results to the exact riemann solver presented in @xcite ,",
    "a slice through the two - dimensional grid is taken along the @xmath391 axis ( as an approximation to a line normal to the waves ) , and @xmath391 is scaled to correspond to distance perpendicular to the initial discontinuity .",
    "the spatial resolution is independent of the angle of the initial discontinuity , and the snapshot is always taken at the same time , for all angles .",
    "the relativistic code is used in the newtonian limit ( as the exact solution is newtonian ) .",
    "the high - resolution results were produced using @xmath392 .",
    "the low - resolution version was produced using @xmath393 .",
    "( for clarity , only 1 in 2 or 1 in 20 points are plotted for the @xmath394 and @xmath395 cases , while 1 in 3 or 1 in 28 points are plotted for @xmath396 . )",
    "all three evolutions look similar , with the results approaching the exact solution as the resolution is increased ; the only notable feature is that the left - most rarefaction wave does not appear to be well captured by the evolution with a slope of @xmath397 .",
    ", scaledwidth=49.0% ]    the constraints are trivial if all variables depend only on one coordinate , for example when a riemann problem is aligned with the numerical grid . as a first test of the behaviour in three dimensions and the role of the constraints , we have solved riemann problems also at an arbitrary angle to a two - dimensional cartesian grid .",
    "a method for carrying out such 2d simulations efficiently is described in appendix  [ appendix:2d ] .",
    "we put the initial discontinuity along lines @xmath398 ( our 1d tests ) , @xmath397 , @xmath399 and @xmath400 , and use a cut along the @xmath391 axis as an approximation to a line normal to the initial discontinuity .",
    "we compare this cut , suitably foreshortened , against the exact solution .",
    "we have not implemented the `` hyperbolicity fix '' constraint additions for either the kinematic or dynamical evolution equations . in 1d",
    "the equations are symmetric hyperbolic anyway , as there are no constraints then , but in 2d our equations are not even strongly hyperbolic .",
    "the error at the same time is somewhat larger in 2d than in 1d , see fig .",
    "[ fig:2dwithexact ] , but there is no sign of numerical instability in 2d .",
    "we have no explanation for this , but expect that constraint addition will be necessary in other tests .      to study a genuinely two - dimensional problem we consider a test suggested by  @xcite .",
    "the initial data , detailed in appendix  [ appendix : initialdata ] , represents an elastic rotor problem , where an inner rotating bearing is instantaneously welded to the non - rotating exterior , causing the rotor to slow and propagating elastic waves through the material . in all cases",
    "the rotor has coordinate radius @xmath401 , whilst the exterior is at rest . in all numerical experiments shown here @xmath402 points",
    "were used .     at coordinate times @xmath403 and @xmath404 .",
    "the results qualitatively match those in figure 24 of  @xcite.,scaledwidth=49.0% ]     at coordinate times @xmath403 and @xmath404 .",
    "the results qualitatively match those in figure 25 of  @xcite.,scaledwidth=49.0% ]    results for the newtonian case are shown are representative coordinate times are shown in figures  [ fig : rotornewtonian_v ] and  [ fig : rotornewtonian_f ] .",
    "these should be compared to the results shown by dumbser et al .  in @xcite .",
    "the results in the literature use a considerably more accurate numerical method , which is both higher order and uses finite elements better adapted to the symmetry of the problem . despite this , we see qualitative agreement in the waves emitted during the evolution of the problem .    .",
    "an initially rotating central cylinder is slowed by the interaction with the exterior , which is initially at rest .",
    "these figures show @xmath405 at coordinate times @xmath403 and @xmath406 .",
    "the emitted waves are qualitatively similar to the newtonian results.,scaledwidth=49.0% ]    .",
    "an initially rotating central cylinder is slowed by the interaction with the exterior , which is initially at rest .",
    "these figures show @xmath407 at coordinate times @xmath403 and @xmath406 .",
    "the emitted waves are qualitatively similar to the newtonian results.,scaledwidth=49.0% ]    results for the relativistic case are shown are representative coordinate times are shown in figures  [ fig : rotorrelativistic_v ] and  [ fig : rotorrelativistic_f ] . again we see qualitative agreement in the emitted wave structure , despite the differences in the models .",
    "we have presented a framework that can be used for simulating nonlinear elasticity in numerical relativity , and checked its viability in riemann tests .",
    "the framework can be directly related to existing approaches and is a first step towards the simulation of neutron star crusts .",
    "our numerical simulations show that the results from the newtonian limit of the equations match those in the literature , and that the newtonian limit of the _ relativistic _ code also match the results from the newtonian literature .",
    "the equations in first order form consist of three groups : evolution equations for a _ configuration gradient _ @xmath0 , auxiliary constraints @xmath177}=0 $ ] for this variable due to the fact that @xmath408 for an implicit underlying _ configuration _",
    "@xmath24 , and energy - momentum conservation laws .",
    "the first two groups are purely kinematical in the sense that they are independent of the geometry of both spacetime and matter space , and hence are the same in newtonian and relativistic elasticity .",
    "however , from a spacetime point both the evolution equations and constraints naturally arise as components of a single spacetime constraint @xmath182}=0 $ ] .",
    "( in fact , without the benefit of this point of view , some of the constraints seem to have been systematically overlooked in the newtonian literature , giving rise to the numerical solution of unphysical riemann problems in @xcite . )",
    "energy - momentum conservation is due to time and space translation invariance , and this fixes their correct weak form @xcite .",
    "the weak form of the kinematical equations appears to have been assumed _ ad hoc _ in the newtonian literature .",
    "here we have rigorously derived it from the absence of dislocations in the elastic matter .",
    "there are two rather different frameworks in the newtonian literature .",
    "one of these @xcite is fully eulerian and arises naturally as the newtonian limit of our relativistic framework .",
    "the other @xcite mixes eulerian and lagrangian points of view and gives rise to more complicated evolution equations . for completeness",
    ", we have proved that the two frameworks are equivalent in their _ weak _ form , and hence that the weak form of the second framework is also correct .",
    "this is borne out by our numerical tests , which agree for both frameworks ( if the initial data obey the constraints ) .",
    "the _ dynamical _ equations of our framework can be related to the standard valencia formalism for relativistic hydrodynamics .",
    "although , as noted in section  [ section : kinematics ] , the fluid limit is singular , the system presented takes the form of the valencia equations with additional terms .",
    "we also note that steps within the numerical code , such as the conversion to primitive variables outlined in sec .",
    "[ section : conversion ] , tend towards standard algorithms in the fluid limit .    using the methods of @xcite",
    ", we have shown that our framework can be made symmetric hyperbolic , at least in a neighbourhood of the unsheared state of the matter , if certain linear combinations of the auxiliary constraints are added as source terms to the conservation laws .",
    "we have also shown that if constraints are added only to the kinematic evolution equations , bringing them into the form ( [ eaitres ] ) ( the `` hyperbolicity fix '' ) , but not to @xmath327 , the resulting first - order system is strongly hyperbolic but not symmetric hyperbolic .",
    "the latter is precisely the situation in the newtonian literature , and so the newtonian limit of our result shows that the equations given there @xcite are only strongly hyperbolic but could be made symmetric hyperbolic by a simple constraint addition .",
    "there remain two outstanding issues before this framework can be used in a fully nonlinear gr simulation of a neutron star .",
    "the first is the issue of the integrability constraints in higher dimensional simulations . in the newtonian literature",
    "it is clear that the hyperbolicity fix included here is required to obtain stable evolutions .",
    "however , there is no agreement as to the impact of constraint violations on the _ accuracy _ of the simulations . in analogy with mhd simulations where the @xmath409 constraint is crucial for accuracy",
    ", we might expect that methods for reducing constraint violations ( such as the parabolic damping term used by @xcite  similar to the powell method for mhd ) , or alternatively a discretisation that maintains a discrete version of the constraints along the lines of appendix  [ section : discreteconstraints ] , will be important .    secondly , to be useful for simulating a neutron star",
    ", we must couple the elastic crust to the fluid interior . a framework for the nonlinear simulation of multiple matter models separated by sharp interfaces in gr",
    "was studied in @xcite , but only for fluid - fluid interactions .",
    "this model built on standard newtonian methods which have themselves been extended to deal with solid - fluid interactions ; we expect that these methods will extend to relativity as well .",
    "we are grateful to philip barton for discussions and for the numerical data corresponding to the exact solutions of the problems in @xcite .",
    "we are also grateful to lars samuelsson , bobby beig , lars andersson and members of the southampton general relativity group for discussions relating to this work .",
    "for reference , we assemble some standard formulas . in 3 + 1",
    "numerical relativity , the spacetime metric @xmath80 is split into a spatial metric @xmath121 with inverse @xmath410 , a lapse @xmath217 and shift @xmath411 , as @xmath412 where we define indices on @xmath411 to be moved implicitly with @xmath121 .",
    "the ( absolute value of the ) determinant of the 4-metric is given by @xmath413 and hence the volume forms on @xmath414 and @xmath415 are related by @xmath416    the inverse 4-metric is @xmath417 the covector normal to the surfaces of constant @xmath418 has components @xmath419 and hence @xmath420 hence the projector into the surfaces of constant @xmath418 @xmath421 has components @xmath422 and @xmath423    we define the convective derivative to be the derivative along the 4-velocity , @xmath424 the factor of proportionality is given by the normalisation condition @xmath425 we find @xmath426 where @xmath427 and where we define the indices on @xmath349 to be moved implicitly with @xmath121 .",
    "the scalar @xmath428 gives the lorentz factor of the relative velocity between the matter and the time slices .",
    "we summarise some standard definitions @xcite in our notation .",
    "let @xmath429 be a vector of variables obeying the system of first - order partial differential equations @xmath430 where l.o",
    ". stands for lower order terms .",
    "obviously the index @xmath217 labelling the equations needs to take as many values as the index @xmath431 labelling the variables .",
    "assume , however , that @xmath217 is an index of the same type as @xmath431 and that @xmath432 .",
    "then we have a conserved current ( up to lower order terms ) in the sense that @xmath433 if furthermore there exists a covector @xmath434 with the property that @xmath435 is positive definite , called a subcharacterisic vector , then the system is called symmetric hyperbolic . ( in a relativistic context we expect @xmath434 to be timelike . ) @xmath436 allows us to estimate an @xmath437 norm called an energy norm of the solution in terms of the initial data and boundary data .",
    "a characteristic direction is a covector @xmath438 such that @xmath439 and the corresponding characteristic variable @xmath429 is the non - zero vector obeying @xmath440 this means that a plane wave with amplitude @xmath441 and wave number @xmath438 is a solution of the principal part . for a causal system in relativity , influence can not travel faster than light , and so @xmath438 must be spacelike or null .    for a second - order system",
    "@xmath442 the equivalent definition of a characteristic direction and variable is @xmath443 and it has the same interpretation as a plane wave solution of the principal part .",
    "it is often useful to decompose the characteristic equation with respect to a preferred hypersurface .",
    "let @xmath444 where @xmath445 is a unit timelike covector and @xmath446 a unit spacelike covector normal to @xmath445 .",
    "@xmath286 is called the characteristic velocity ( relative to @xmath445 ) of the characteristic variable @xmath429 .",
    "@xmath279 is normal to the characteristic plane spanned by the vectors @xmath447 where @xmath448 is any vector normal to both @xmath445 and @xmath446 ( so that @xmath449 ) .",
    "the relative speed between @xmath330 and @xmath450 ( calculated from @xmath451 ) is @xmath452 .",
    "the disturbance itself moves along @xmath453 , that is in the direction @xmath454 with speed @xmath286 as measured by @xmath330 observers .",
    "one natural choice of @xmath445 is the unit normal to the surfaces of constant time @xmath418 , and the resulting values of @xmath286 are used in the numerical scheme .",
    "by contrast , choosing @xmath455 gives the speed of the disturbances relative to the matter , which are simpler to compute .    to make contact with non - relativistic concepts of hyperbolicity , we rewrite the first order characteristic equation ( [ charvarfirstorder ] ) as @xmath456 where we have not written the greek indices for simplicity .",
    "( if @xmath445 is subcharacteristic , @xmath457 is positive definite and so has an inverse . )",
    "the system is then called weakly hyperbolic with respect to the time direction @xmath445 if @xmath458 has real eigenvalues @xmath286 for all unit vectors @xmath446 normal to @xmath445 .",
    "it is called strongly hyperbolic if furthermore @xmath458 has a basis of real eigenvectors that depends continuously on @xmath446 .",
    "it is called symmetric hyperbolic if @xmath458 is symmetric .",
    "as a real symmetric matrix is always diagonalisable with real eigenvalues , symmetric hyperbolicity implies strong hyperbolicity . more generally , the system is called symmetric hyperbolic , or symmetrisable , if there exists a symmetriser , a positive definite symmetric matrix @xmath459 independent of @xmath454 such that @xmath460 is symmetric . in this case @xmath461",
    "we obtain the limit of newtonian motion in the absence of gravity in two steps . in the first step",
    ", we let the spacetime go to minkowski spacetime in adapted coordinates , @xmath462 where @xmath121 is flat and independent of @xmath418 , but @xmath320 could still be curvilinear coordinates .",
    "hence @xmath463 and the advection equation   becomes @xmath464    in the second step , we use dimensional analysis of the special relativistic equations of motion to insert a parameter @xmath311 representing the speed of light , as follows : @xmath465 for the primitive variables , and @xmath466 for the conserved variables .",
    "we then take the limit @xmath467 of the relevant equations for minkowski spacetime . in this limit , @xmath468 where @xmath349 and @xmath352 are now the newtonian velocity and stress tensor , and their indices",
    "are moved implicitly with the metric @xmath121 of euclidean space . instead of requiring @xmath133 , @xmath469 and @xmath470 as functions of @xmath362 ( the relativistic enthalphy , which includes the rest mass energy ) and @xmath138 , we need them as functions of @xmath139 and @xmath138 .",
    "the reconstruction of @xmath138 , @xmath471 and @xmath139 from @xmath342 , @xmath350 and @xmath351 becomes explicit for the equations of state we consider .",
    "[ [ variables ] ] variables + + + + + + + + +    in the alternative newtonian framework of @xcite , the deformation is given by a map from a 3-dimensional matter space and time to 3-dimensional space @xmath472 with derivatives @xmath473 where @xmath32 is the @xmath31 matrix inverse of @xmath0 .",
    "we shall call this the mixed framework , as the dependent variables are lagrangian , but the independent ones are still eulerian .",
    "( a purely lagrangian framework also exists , but is not relevant for us because we are interested in finite volume methods for weak solutions . )    for the purpose of a systematic derivation of the kinematic equations , and a comparison with the eulerian framework , we add a time coordinate @xmath351 to matter space , which now has coordinates @xmath474 . to make this extension trivial , we then fix @xmath475 .",
    "note that @xmath476 is then the usual convective derivative .",
    "this extension gives us the extended derivatives @xmath477 which are now @xmath478 matrix inverses of one another , assuming ( [ psiat ] ) .",
    "[ [ kinematic - equations ] ] kinematic equations + + + + + + + + + + + + + + + + + + +    we derive the evolution equations and constraints in the mixed framework by working in the 4-dimensional notation at first .",
    "the integrability condition @xmath479}=0\\ ] ] can be written as the commutator of the vector fields @xmath480 and @xmath481 pushed forward to spacetime , @xmath482,a}=0.\\ ] ]    we define the determinant @xmath483 where the suffixes indicate that this depends explicitly on the coordinates @xmath12 and @xmath484 .",
    "with @xmath485 the inverse of @xmath486 , we have the variation - of - determinant rule @xmath487    as @xmath488 and @xmath489 are constant , we therefore have @xmath490    from ( [ detderiv ] ) and ( [ calcaalphabeta1 ] ) , we find that @xmath491 while combining ( [ calcaalphabeta2 ] ) and ( [ calcalpha ] ) we obtain @xmath492}\\right)_{,a}=0.\\ ] ]    developing ( [ tildefdef ] ) into its first row , we find @xmath493 hence we obtain the 3 + 1 split of the 4-dimensional constraints into evolution equations and constraints : @xmath494}\\right)_{,j } = : { \\cal c}^i{}_{ab}=0 , \\\\",
    "\\label{caleia } -{}^{(3)}\\tilde { \\cal c}^i{}_{a\\tau}&=&\\left({f}_{x\\xi}^{-1}{f^i}_a\\right)_{,t } + \\left[{f}_{x\\xi}^{-1}\\left ( \\hat v^j{f^i}_a-\\hat v^i{f^j}_a\\right)\\right]_{,j}\\nonumber \\\\   & = : & { \\cal e}^i{}_a=0.\\end{aligned}\\ ] ] the remaining components @xmath495 are redundant .",
    "note that everything is now expressed in terms of @xmath32 and @xmath41 , and we no longer need @xmath496 .",
    "the corresponding jump conditions are @xmath497 & = & 0 , \\\\",
    "\\label{calejump } \\left[\\hat f_{x\\xi}^{-1}(\\hat v^{n}-s)\\right ] & = & 0 , \\\\",
    "\\label{calciabjump } \\left[{f}_{x\\xi}^{-1}f^{n}{}_{[a}f^{\\parallel i}{}_{b]}\\right ] & = & 0 , \\\\",
    "\\label{caleiajump } \\left[f_{x\\xi}^{-1}f^{\\parallel i}{}_a(\\hat v^{n}-s)\\right]-\\left[{f}_{x\\xi}^{-1}f^{n}{}_a\\hat v^{\\parallel i}\\right ] & = & 0,\\end{aligned}\\ ] ] where the @xmath138 , @xmath498 notation is as in sec .",
    "[ section : kinematicjump ] .",
    "note that these jump conditions are both more numerous and more complicated than the jump conditions ( [ psijump1],[psijump2 ] ) of the eulerian framework .",
    "[ [ equivalence - with - the - eulerian - framework ] ] equivalence with the eulerian framework + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    note that we have used @xmath499 and @xmath500 to denote the evolution equations and constraints in the mixed framework , and @xmath436 and @xmath501 for the eulerian framework .",
    "we have the following relations between the full and contracted equations for @xmath32 , @xmath502 and the following relations between these equations and those for @xmath0 : @xmath503    as these relations between differential equations involve multiplication by one or more factors of @xmath355 , which in general is not continuous , the corresponding jump conditions may be inequivalent . in particular , it is not clear if ( [ calejump ] ) follows from ( [ caleiajump ] ) , if ( [ calcajump ] ) follows from ( [ calciabjump ] ) , if ( [ calciabjump ] ) is equivalent to ( [ psijump1 ] ) or if ( [ caleiajump ] ) is equivalent to ( [ psijump2 ] ) .",
    "however , a detailed calculation shows that all these relations hold .    as an example of these calculations ,",
    "consider @xmath504&= & \\left[\\delta^{njk}\\delta_{abc } \\psi^b{}_j \\psi^c{}_k\\right ] \\nonumber \\\\ \\label{calcajumpbis } & = & 2\\delta^{nij}\\delta_{abc } \\left[\\psi^b{}_{\\parallel i } \\psi^c{}_{\\parallel j}\\right],\\end{aligned}\\ ] ] where in the first equality we have used the cofactor rule and the assumption that @xmath33 is the inverse of @xmath19 , and in the second equality we have used that @xmath505 and @xmath506 are continuous . from ( [ calcajumpbis ] ) we see that ( [ psijump1 ] ) implies ( [ calcajump ] ) ( as claimed above ) , but the reverse is not true .",
    "in fact , the right - hand side of ( [ calcajumpbis ] ) vanishes if and only if @xmath507=\\alpha^ak_{\\parallel i}\\ ] ] for some matter space vector @xmath298 and spatial covector @xmath508 .",
    "that is why the jump condition ( [ calciabjump ] ) also needs to be imposed .    in the papers @xcite only ( [ calejump ] ) , ( [ caleiajump ] ) and ( [ calcajump ] )",
    "are explicitly given , but ( [ calciabjump ] ) appear to have been overlooked .",
    "in particular , the initial data for the second riemann numerical test of @xcite ( bdrt2 ) and the initial data for the fifth riemann numerical test of @xcite ( trt5 ) explicitly violate ( [ calciabjump ] ) .",
    "as noted in @xcite , not imposing the constraints ( [ caijjump ] ) , or equivalently ( [ calciabjump ] ) , in full corresponds to performing surgery ( of the type illustrated in fig .",
    "[ fig : nosurgery2 ] ) at the discontinuity .",
    "moreover , once the initial data violate the constraints , the subsequent evolution depends on how constraints have been added to the evolution equations .",
    "[ [ equations - written - in - terms - of - the - density ] ] equations written in terms of the density + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    we have already noted that with ( [ kadvection ] ) and ( [ rhogr ] ) , ( [ cale ] ) is just particle number conservation ( [ restmassconservationgr ] ) .",
    "note that in weak solutions , we must demand that @xmath509 is everywhere continuous , a property that is conserved under advection .",
    "@xmath510 can also be replaced by @xmath138 in the other equations of the mixed framework . defining @xmath511 we can write ( [ calca ] ) and ( [ caleia ] ) as @xmath512_{,j } & = & 0 .",
    "\\nonumber \\\\ \\label{finduction}\\end{aligned}\\ ] ] for fixed matter space index @xmath513 , these happen to be identical with the divergence constraint and the induction equation for the magnetic field in the formulation @xcite of ideal magnetohydrodyamics ( mhd ) in general relativity .",
    "taking the newtonian limit @xmath514 , @xmath121 flat and assuming cartesian coordinates so that @xmath515 , ( [ restmassconservationgr ] ) , ( [ fdiv ] ) and ( [ finduction ] ) reduce to eqs .",
    "( 3.12 ) , ( 3.26 ) and ( 3.22 ) of @xcite , where @xmath509 is called @xmath516 . further assuming @xmath517 , they reduce to eqs .  ( 6 ) , ( 9 ) and ( 1b ) of @xcite and eqs .",
    "( 3 ) , ( 1 ) and ( 2 ) of @xcite .    in terms of @xmath518 , the remaining equation , eq .",
    "( [ calciab ] ) can be written as @xmath519}\\right)_{,j}=0,\\ ] ] where @xmath509 reappears .",
    "as we have already noted , this constraint is not mentioned in @xcite .",
    "it also does not have an equivalent in mhd .",
    "the following class of conservative numerical schemes preserves a discrete version of the integrability constraints . with all other numerical variables defined as cell averages with , by convention , integer grid index values ,",
    "define @xmath0 on relevant cell faces . to initialise them consistently , assign values to @xmath24 at cell centres at the initial time ( in liquid as well as solid regions ) .",
    "then initialize @xmath520 the @xmath521 are used only for initialisation , and are not required afterwards .",
    "we then evolve using the conservative equations @xmath522 and similarly for @xmath523 and @xmath524 , where the numerical flux @xmath525 is some approximation to @xmath526 at cell centres , suitably limited to enforce the tvd property",
    ". then a discrete version of @xmath527 , evaluated at relevant cell edges : @xmath528 and similarly for the other two commutators , is obeyed at all times if it is obeyed initially .",
    "the fundamental idea is that the numerical fluxes @xmath529 are the time derivatives of the underlying @xmath24 , and hence are the same for the @xmath530 , @xmath523 and @xmath524 .",
    "the discrete constraints act as discrete integrability conditions that allow us to reconstruct the @xmath521 by summation if desired .",
    "example of a two - dimensional grid with shifted periodic boundary conditions , with @xmath531 , @xmath532 and @xmath533 .",
    "the physical grid is surrounded by one ghost cell on each side . in reality",
    ", @xmath534 would be much larger , while @xmath535 ranges from 1 to a few , and @xmath536 from 0 to a few , with no common factor .",
    "the placement of the left and right state of a riemann problem is shown by the letters l and r and shading .",
    "cells are initialised with the left or right state depending on the position of the cell _",
    "center_. the numbers 1 , 2 , 3 , 4 identify four physical cells and the ghost cells they donate values to .",
    "the initial discontinuity is at an angle @xmath217 from the @xmath57 axis , with @xmath537 ( @xmath538 in this example ) , and goes through the point @xmath539.,width=340 ]    as a first test of the role of the constraints in hyperbolicity , we numerically solve riemann problems on a 2-dimensional grid , with the initial discontinuity at an angle to the grid .",
    "assume the grid consists of @xmath540 cells , surrounded by the necessary number of ghost cells .",
    "after each time update , the ghost points are filled using periodic boundary conditions , identifying cell @xmath541 with @xmath542 in the @xmath391 direction , but @xmath541 with @xmath543 in the @xmath57 direction , where @xmath536 is an offset . consistently with these boundary conditions , the initial discontinuity",
    "is then placed on a line of @xmath544 ( assuming that the grid spacing is the same in the @xmath391 and @xmath57 directions ) .",
    "this is illustrated in fig .",
    "[ fig : twodimgrid ] .",
    "as the @xmath391 and @xmath57 directions are interchangeable , the slope @xmath545 and its inverse pose the same riemann test .",
    "( less obviously , in our implementation those two tests also have roughly equal computational cost . )",
    "we choose @xmath546 ( and typically @xmath547 ) so that the initial discontinuity is always closer to the @xmath57 axis ( where it is in the 1d tests ) , and use the @xmath391 axis as an approximation to a line normal to the initial discontinuity when taking a cut through the solution .",
    "the three eigenvalues of @xmath155 can be parameterised as @xmath548 .",
    "we then find that in the unsheared state @xmath549 , @xmath550 hence @xmath551 and @xmath552 are the same function of the shear up to quadratic order .",
    "this is not a bad choice of @xmath353 but a property of any shear invariant .",
    "it is related to the fact that the characteristic speeds in the unsheared state depend on @xmath469 and @xmath470 only through the one combination @xmath224 that appears in the shear modulus ( [ shearmodulus ] ) .    therefore , to model linear elasticity correctly , it is sufficiently general to make the ansatz @xmath553 where the _ shear scalar _",
    "@xmath554 obeys @xmath555 in the unsheared state @xmath556 , but is otherwise arbitrary .",
    "for any such choice of @xmath557 , @xmath558 evaluates to the usual shear modulus ( [ shearmodulus ] ) in the newtonian limit , and the equations of motion are the same when linearised about the unsheared state .",
    "clearly there are many possibilities of defining a shear scalar that obeys these conditions , but we are not aware of any physical reason given in the literature for why a specific choice should be preferred , or of values given for @xmath469 and @xmath470 independently .",
    "an equation of state for copper in @xcite uses the shear scalar @xmath559 which is homogenously quadratic in the eigenvalues of @xmath155 . in @xcite the shear scalar @xmath560 which is cubic ,",
    "is suggested for what seem to be aesthetic reasons .",
    "yet another shear scalar is @xmath561 where @xmath562 is the `` constant volume shear tensor '' defined in @xcite . in the newtonian limit , near the unsheared state , @xmath563",
    "is related to the von mises stress scalar ( assuming stress and strain are related linearly ) .",
    "it gives the same values of @xmath469 and @xmath470 as @xmath564 .",
    "we now consider examples of equations of state of the form ( [ eosclass ] ) .",
    "the following general expressions will be useful : @xmath565 in principle we can eliminate @xmath106 from these two equations to obtain @xmath133 , @xmath469 and @xmath470 , as functions of @xmath566 , which we need in the recovery of the primitive from the conserved variables .",
    "[ [ a - toy - relativistic - eos ] ] a toy relativistic eos + + + + + + + + + + + + + + + + + + + + + +    as a toy model for a relativistic equation of state , we take @xmath567 from the commonly used `` gamma - law '' hot equation of state , and make the shear modulus @xmath568 a power of the density only , namely @xmath569 where @xmath570 , @xmath571 and @xmath286 are constants .",
    "this is motivated by the fact that in neutron star crusts @xmath572 , with the factor of proportionality only weakly temperature - dependent .",
    "the bulk modulus in neutron stars is given by the nuclear interactions , while the shear modulus is provided by coulomb interactions , which makes it independent and much smaller .",
    "following @xcite , we choose @xmath554 as @xmath573 given by ( [ sks ] ) .",
    "the expressions we need for the conserved to primitive variables conversion are then @xmath574 the characteristic speeds in the unsheared state are @xmath575    [ [ cranfield - eos ] ] cranfield eos + + + + + + + + + + + + +    the equation of state for copper used in @xcite for newtonian shock tube problems , translated into our notation , is @xmath576 ^ 2 , \\\\",
    "b&:=&c_vt_0\\left({{n}\\over{n}_0}\\right)^\\gamma , \\\\   k&:= & e^{s\\over c_v}-1 ,",
    "\\\\ c&:=&b_0\\left({{n}\\over{n}_0}\\right)^{\\beta+4/3},\\end{aligned}\\ ] ] where @xmath554 is @xmath577 given by ( [ scran ] ) .",
    "we need the following forms of the equation of state : @xmath578 , \\\\",
    "p(h,{n},i^\\alpha)&=&{{n}\\over\\gamma+1}\\bigl[\\gamma(h-1 ) -\\gamma a+{n } a ' \\nonumber \\\\ & & + ( \\beta+4/3-\\gamma)c{\\cal s}\\bigr ] , \\\\",
    "p(\\epsilon,{n},i^\\alpha)&=&{n}\\bigl[\\gamma\\epsilon-\\gamma a+{n } a '   \\nonumber \\\\ & & + ( \\beta+4/3-\\gamma)c{\\cal s}\\bigr ] , \\\\ h(p,{n},i^\\alpha)&=&1+{\\gamma+1\\over\\gamma}{p\\over{n}}+a-{1\\over\\gamma}{n } a ' \\nonumber \\\\ & & -{1\\over\\gamma}(\\beta+4/3-\\gamma)c{\\cal s } , \\\\ f_1 & = & -{ci^1\\over 6 } , \\\\ f_2 & = & { c\\over 4 } \\end{aligned}\\ ] ]",
    "the exact solution of the riemann problem is a standard test for hrsc methods . for newtonian elasticity exact solvers",
    "have been constructed both by miller  @xcite and by barton et al .",
    "@xcite . in the relativistic case here",
    "we have not constructed a generic solver to compute the full riemann problem solution . as noted by  @xcite",
    ", this can be extremely sensitive to initial guesses used .",
    "instead we construct exact solutions by specifying the wave structure explicitly in advance and solving across each wave .    as summarized in  @xcite , with piecewise constant initial data the generic solution will contain seven self - similar waves .",
    "the central wave will be a contact discontinuity , and the other waves will be genuinely nonlinear .",
    "we assume that the solutions are simple shocks or rarefactions .",
    "we then solve across each wave in the following manner .",
    "[ [ shock - wave ] ] shock wave + + + + + + + + + +    we assume that the primitive variables to the left of the wave , @xmath579 , are given .",
    "we then impose the value _ either _ of the shock speed @xmath580 or of one component of the variables to the right of the wave , @xmath581 .",
    "the rankine - hugoniot conditions @xmath582\\ ] ] then form a system of nonlinear equations for the remaining components of @xmath581 and , where necessary , for the shock speed @xmath580 . here",
    "@xmath583 denotes the wave number counting from the left .",
    "this problem is solved explicitly using the matlab solver fsolve .",
    "it is usually necessary to experiment with the imposed value and initial guesses in order to construct a solution satisfying the lax entropy condition @xmath584 the construction of the eigenvalues @xmath585 is discussed below .    [ [ contact - discontinuity ] ] contact discontinuity + + + + + + + + + + + + + + + + + + + + +    a contact must satisfy the rankine - hugoniot conditions   combined with the restriction that the wave speed @xmath106 matches the normal velocity on either side of the wave .",
    "hence we can use the same techniques as for the shock with the value of the velocity imposed .",
    "[ [ rarefaction - wave ] ] rarefaction wave + + + + + + + + + + + + + + + +    as noted by  @xcite the solution across a rarefaction wave is given by @xmath586 here @xmath587 is the self - similarity variable .",
    "we have that @xmath588 where @xmath583 labels the wave number and @xmath589 is given , as above .",
    "we impose that @xmath590 to stop the integration .",
    "in addition @xmath591 are the right eigenvectors associated with the @xmath592 eigenvalue @xmath585 , and @xmath593 denotes the gradient operator with respect to the vector of primitive variables .",
    "all characteristic information ( @xmath594 ) is constructed from the jacobian matrix @xmath595 as in the newtonian case discussed in @xcite we need to explicitly modify the calculated jacobian to build in the hyperbolicity corrections as in equation  .",
    "given an explicit left state @xmath589 the numerical solution is found by solving the ode   for @xmath596 with initial data @xmath589 in @xmath597 .",
    "explicitly we use the ode45 routine with matlab .",
    "the jacobian @xmath598 is constructed using explicit finite differencing by varying each component of @xmath596 by a small value @xmath362 .",
    "standard matlab routines were used to construct and sort the characteristic information .",
    "the gradient @xmath599 was also constructed using explicit finite differencing . in all cases",
    "@xmath600 order finite differencing combined with richardson extrapolation was used to ensure sufficient accuracy .",
    "there are two potential problems with this construction .",
    "first , as noted by  @xcite , we have no guarantee that equation   has a unique solution .",
    "this would imply that the true solution is a compound wave , and breaks the assumptions made here .",
    "second , the numerical construction of the characteristic information is extremely sensitive when the eigenvalues are close to each other .",
    "this appears to be the case for the problems and equations of state considered below , and means that for the slower 3 and 5 waves next to the contact we are forced to construct very small rarefaction fans .    in principle",
    "there is no reason why the procedure above could not be extended to construct a full riemann solver .",
    "however , such a solver would have little practical utility , even if it could be made generic and robust .",
    "numerical experiments have shown that it is faster to compute an approximate solution using 800 grid cells than it is to construct _",
    "one _ exact solution with a pre - specified wave structure .",
    "even allowing for the massive speed improvements possible within our current exact solver , it is clearly impractical for use within an evolution code .",
    "we used several sets of initial data that were defined in published papers ; this was done to ensure that our code agreed with newtonian results produced previously @xcite @xcite . because both papers chose entropy , @xmath106 , as a primitive variable , instead of the pressure , @xmath133 , we list the initial entropy value here , and calculate the pressure from the entropy when the system is initialized .    for the following sets of initial data ,",
    "the spacetime metric is the minkowski metric , and the matter - space metric is the euclidean metric in euclidean coordinates normalized with the initial density of the elastic medium , @xmath601 ; we note that while we must convert units of velocity to geometrized units , we do not need to convert units of density or of length , as long as we are consistent throughout the code . for this paper the value @xmath602",
    "g/@xmath603 was used for the bdrt tests ( from @xcite ) and @xmath604  g/@xmath603 was used for the trt tests ( from @xcite ) .",
    "in addition to this , for each of these situations , the cranfield equation of state , described in appendix  [ appendix : eos ] , was used . for comparison purposes , the velocities in this section",
    "are taken to be in km s@xmath605 , while the entropy is in kj g@xmath605k@xmath605 .",
    "this is the same as _ testcase 1 _ in @xcite .",
    "it allows us to examine the entire seven - wave structure of the solution . using the cranfield eos above",
    ", the solution consists of three left - travelling rarefaction waves , a right - travelling contact , two right - travelling rarefactions , and a right - travelling shock wave .",
    "the initial data is presented for the state vector @xmath606 in the mixed framework given in appendix  [ appendix : mixed ] , and all other quantities are derived from them : @xmath607 results are shown at coordinate time @xmath608 .",
    "we constructed a range of relativistic solutions , mostly consisting of a single shock or rarefaction , using the technique outlined in appendix  [ sec : exactsolns ] .",
    "the toy relativistic equation of state given above is used , with parameters @xmath609 , @xmath610 , and @xmath611 . in particular",
    ", we present a solution with four nonlinear waves .",
    "the two left - going waves ( 1- and 2-waves ) are rarefactions .",
    "the contact is trivial , as are the central ( 3- and 5-waves ) nonlinear waves .",
    "the slower right - going wave ( a 6-wave ) is a rarefaction , and the fast right - going 7-wave is a shock .",
    "the initial data is presented for the state vector @xmath612 , truncated to 6 significant figures , and all other quantities are derived from them : @xmath613 results are shown at coordinate time @xmath614 .",
    "in addition to riemann problem style tests we consider a genuinely two - dimensional rotor test .",
    "the newtonian rotor test was suggested by  @xcite , where the evolution was shown using a high - order finite element technique .",
    "the domain is cylindrical , of total radius @xmath615 .",
    "the material is initially at rest except in the rotor , represented by a cylinder of radius @xmath401 , within which it rotates with angular velocity @xmath616 .",
    "the material is not deformed ( i.e. , @xmath32 is the unit matrix ) nor hot ( i.e. , @xmath617 ) . all other matter properties follow the riemann tests above .",
    "that is , the initial density is given by @xmath602  g/@xmath603 and the cranfield equation of state , described in appendix  [ appendix : eos ] , was used . here ,",
    "as we have used a cartesian grid , we have simulated the full domain @xmath618 $ ] .",
    "we suggest a relativistic rotor test as a direct comparison with the newtonian version .",
    "the domain remains the same as the newtonian case .",
    "the angular velocity is reduced to @xmath619 .",
    "the material is initially set so that @xmath0 is the unit matrix and @xmath620 . as the shear also depends on the velocity through @xmath621 , the material is sheared within the rotor initially , in contrast to the newtonian case , but this is small . as in the riemann tests",
    "above we use the toy relativistic equation of state given in appendix  [ appendix : eos ] , with parameters @xmath609 , @xmath622 , and @xmath611 ."
  ],
  "abstract_text": [
    "<S> we present a practical framework for ideal hyperelasticity in numerical relativity . for this purpose </S>",
    "<S> , we recast the formalism of carter and quintana as a set of eulerian conservation laws in an arbitrary 3 + 1 split of spacetime . </S>",
    "<S> the resulting equations are presented as an extension of the standard valencia formalism for a perfect fluid , with additional terms in the stress - energy tensor , plus a set of kinematic conservation laws that evolve a configuration gradient @xmath0 . </S>",
    "<S> we prove that the equations can be made symmetric hyperbolic by suitable constraint additions , at least in a neighbourhood of the unsheared state . </S>",
    "<S> we discuss the newtonian limit of our formalism and its relation to a second formalism also used in newtonian elasticity . </S>",
    "<S> we validate our framework by numerically solving a set of riemann problems in minkowski spacetime , as well as newtonian ones from the literature . </S>"
  ]
}