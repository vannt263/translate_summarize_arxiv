{
  "article_text": [
    "in recent years there has been increasing activity in the prediction of high - temperature magnetic properties of solids , especially regarding critical magnetic transition temperatures .",
    "the theoretical approach is founded in many cases on two assumptions : ( i ) that the magnetic excitations of a system can be phenomenologically described within a classical or quantum heisenberg model , and ( ii ) that the exchange parameters entering the model ( i.e. , the excitation energies ) can be microscopically derived from total energy results of e.g. density - functional theory calculations .",
    "this `` magnetic multi - scale modelling '' has proven succesful in many cases , including itinerant elemental ferromagnets such as fe and co,@xcite localized - moment systems such as gd,@xcite magnetic alloys as nimnsb or co@xmath0mnsi,@xcite or diluted magnetic semiconductors as ( ga , mn)as.@xcite in these systems , the estimated curie temperatures @xmath1  are within 10 - 15% of the experimental values , showing that the approach is reliable for practical purposes .",
    "the derivation of magnetic excitation energies from density - functional calculations requires additional assumptions , since density - functional theory is , in principle , valid only for the description of the ground state of many - electron systems .",
    "mainly , one relies on an adiabatic hypothesis , which conjectures that the slow motion of low - energy magnetic excitations can be decoupled from the fast motion of intersite electron hopping , so that the local electronic structure has time to relax under the constraint that a magnon traverses the system .",
    "then the magnons are regarded as practically static or `` frozen '' objects , and constrained density functional theory@xcite is employed .",
    "this adiabatic approximation , together with the realization that the local moments persist until above the curie temperature , constitutes a paradigm which has proven fruitful .",
    "quite a few theories and methods have been based on it , aimed at the calculation of thermodynamic quantities , including @xmath1 , by harvesting the model parameters from first principles calculations and working out the thermodynamics within monte carlo methods or other suitable approaches .    among the first to discuss the adiabatic approximation in connection to dft calculations were gyorffy and co - workers in the development of a mean - field theory of magnetic fluctuations,@xcite even though the concept was applied earlier on the level of solutions to many - body model hamiltonians ( see e.g. small and heine@xcite ) .",
    "later antropov et al.@xcite and halilov et al.@xcite derived equations for adiabatic _ ab - initio _ spin dynamics .",
    "further elaboration came from niu and collaborators@xcite and gebauer and baroni,@xcite who showed that the berry curvature enters the adiabatic dynamics equations ; they also demonstrated mathematically how the born - oppenheimer method can be generalized for adiabatic spin dynamics without the requirement that there should be a large mass difference defining the time - scale difference .",
    "based on the adiabatic approximation , a proper parametrization of the excitation spectrum is called for . in many , but not all , ferromagnetic systems",
    "the magnitude of the local atomic moments is relatively robust under modest rotations , so that mainly the pair exchange constants entering a heisenberg model are required . from the point of view of methodology ,",
    "two approaches are commonly used for the determination of the pair exchange constants .",
    "the first is based on multiple - scattering theory and green function methods , frequently in the approximation of infinitesimal rotations.@xcite it is widely used in methods where the green function is available.@xcite a variant of this approach is the use of the disorder - local - moment ( dlm ) reference state@xcite as an approximation to the magnetic disorder at the curie temperature , from which one obtains exchange parameters@xcite in a manner analogous to the method of infinitesimal rotations.@xcite higher - order interactions ( e.g. the biquadratic , 4-th order , or anisotropic exchange ) can be also obtained in a systematic way either from the ferromagnetic ground state@xcite or from the dlm state.@xcite    the second approach , which we follow in this work , is based on reciprocal - space calculation of spin - wave excitation energies by constraining the system to spin spirals of given wavevectors @xmath2 .",
    "this requires non - collinear calculations , restricted to the primitive chemical unit cell ( in the absence of spin - orbit coupling ) by virtue of a generalized bloch theorem.@xcite a subsequent integration in @xmath2-space ( in form of a back - fourier transformation ) yields the pair exchange constants .",
    "although the force theorem@xcite is in principle not necessary here , practically it is often used in order to avoid the numerical load of a self - consistent calculation for each vector @xmath2 .",
    "this second approach is well - suited for electronic structure methods which are based on hamiltonian diagonalization rather than green functions , and has been developed , for example , for the augmented spherical wave ( asw ) method@xcite or the lmto method.@xcite concerning the second approach , we should also mention that a proper energy fit to a large number of constrained - moment - directions has been used to extract model parameters , inspired by alloy - theory methods , for example by applying the connolly - williams theory@xcite to fit a number of antiferromagnetic states@xcite or in a more refined way by applying a systematic spin - cluster expansion including higher - order interactions@xcite for a fit to non - collinear states .",
    "the results of the two approaches ( infinitesimal rotations and spin - wave spectra ) on the values of exchange interactions agree well , at least as long as the density - functional calculations are done within the same electronic structure method.@xcite there is also good agreement in the spin - wave spectra of the two approaches if these are calculated in the first approach from a fourier - transformation of the real space coupling parameters , as long as a sufficiently large number of atomic shells is taken in the fourier series.@xcite    the present paper contains two major parts . in the first part , sections [ sec : jij ] and [ sec : jijcalc ] , we start by presenting the formalism for the calculation of pair exchange constants which we have implemented in the full - potential augmented linearized plane wave ( flapw ) method.@xcite the approach of spin spirals and inverse fourier transformations@xcite is used to arrive at formulae for the pair exchange constants in the case of one or more magnetic atoms per unit cell .",
    "symmetry relations are derived that reduce the selection of spin - spirals to the irreducible part of the brillouin zone .",
    "then , we focus on accuracy tests concerning the use of the force theorem at finite rotations ; we also address the problem of subtracting the contribution of the magnetization in the interstitial . as a test",
    ", we calculate the curie temperature of certain compounds by a monte carlo method . in the second part , section [ sec : longitudinal ]",
    ", we discuss a way to parametrize the energetic contribution of longitudinal changes in the atomic spin moment so as to include them in a monte carlo method in the case that we are faced with a compound containing strong - moment and induced - moment sublattices .",
    "we obtain a scheme for the study of temperature - dependent magnetic properties and derive equations that allow a simplification of the computational method and a reduction of the computational cost under certain frequently - met physical conditions ; importantly , we show the hitherto unnoticed result that the fluctuating weak - moment degrees of freedom can be analytically eliminated in favour of renormalized , temperature - independent strong - moment interactions , and that the thermodynamics of the full system ( strong plus weak moments with bare interactions ) can be derived from the thermodynamics of the strong - moment system only with renormalized interactions ( a general derivation is given in the appendix ) .",
    "a numerical demonstration of this rigorous result is presented in the case of the half - heusler alloy nimnsb . finally , in sec .",
    "[ sec : remarks ] we place our work in a wider context comparing with the treatment of the weak moments or the concept of renormalized exchange interactions presented by other authors and we state the basic physical assumptions underlying our result .",
    "we then conclude with a summary .",
    "adopting the adiabatic approximation , the magnetic interactions are modelled by a classical heisenberg hamiltonian .",
    "the part of the total energy due to these interactions is then obtained from the expression @xmath3 where @xmath4 . here",
    ", @xmath5 are the lattice vectors and @xmath6 are the basis vectors specifying the positions of the atoms within the unit cell . @xmath7 are the atomic magnetic moments at the sites @xmath8 , while @xmath9 is the exchange coupling constant for the pair of atoms situated at these sites , and is the quantity to be calculated .",
    "the summations over the indices @xmath10 are carried out over all lattice vectors , and the ones using indices @xmath11 , over all the atoms in the unit cell .",
    "the factor 1/2 takes care of the double counting and the on - site term ( @xmath12 ) is left out .",
    "the constants @xmath9 contain the information about the inter - site interaction due to the exchange coupling .",
    "the knowledge of these exchange interactions is essential for the description of thermal excitations in magnetic solids and their deriving from _ ab - initio _ calculations is the core problem in the attempt to describe the system with the heisenberg hamiltonian .",
    "the correspondence between the _ ab - initio _ theory and the heisenberg model is established by using the ansatz @xmath13 which follows from eq .",
    "( [ eq : heisenberg1 ] ) , as a defining relation of @xmath9 within density - functional theory . here , @xmath14 and @xmath15 are to be understood as small differences with respect to the direction only , not the magnitude .",
    "i.e. , an appropriate energy functional ( usually within the local density or generalized gradient approximation ( lda or gga ) ) @xmath16 $ ] of charge density @xmath17 and magnetization density @xmath18 is used in the place of @xmath19 in eq .",
    "( [ eq : jdef ] ) .",
    "when evaluating ( [ eq : jdef ] ) , it is assumed that the exchange - correlation field is collinear within each atom , so that the derivative with respect to atom - cell integrated moments @xmath20 is meaningful .",
    "the intra - atomic collinearity is an approximation , justified by the energetic dominance of the moment formation ( usually of the order of ev ) compared to the formation of ferromagnetic order ( usually of the order of less than 0.1 ev ) . from these comments",
    "it is also evident that we do not require that the local moments are quantized either in the form @xmath21 or @xmath22 with @xmath23 integer or half - integer , as , e.g. , would be the case in ferromagnetic semiconductors.@xcite rather , eq .  ( [ eq : heisenberg1 ] ) represents the lowest term in an expansion of the total energy in terms of the magnetization direction , neglecting longitudinal enhancement or suppression of the moments , and eq .",
    "( [ eq : heisenberg1 ] ) represents a classical heisenberg model , valid after local quantum spin fluctuations have been averaged out ( see , e.g. , the discussion in [ ] ) .",
    "there are known cases when these approximations are insufficient , and we discuss such a case in section [ sec : longitudinal ] .    next",
    ", the collective transverse magnetic excitations are approximated by static spin spirals , the energy of which is calculated within the non - collinear flapw method.@xcite for the fourier and back - fourier transformations that are needed we follow the formalism of halilov _ et al._.@xcite in the case of a spin spiral with wave vector @xmath2 , the azimuthal angle of the magnetic moment of an atom at the position @xmath24 is given by @xmath25 .",
    "the magnetic moment of an atom at the position @xmath24 is @xmath26 where @xmath27 is the so - called _ cone angle _ , a relative angle between the final and initial direction of the local magnetic moment ( here chosen along the @xmath28 axis ; this choice does not limit the generality in absence of spin - orbit coupling ) , and @xmath29 an eventual phase factor , also called _",
    "phase angle_. taking advantage of the translational invariance we define @xmath30 and @xmath31 , whence eq .",
    "( [ eq : heisenberg1 ] ) becomes    @xmath32 + \\cos\\theta_{\\alpha}\\cos\\theta_{\\beta}\\right\\}.\\end{aligned}\\ ] ]    here , the energy @xmath19 is a function of the spin - spiral vector @xmath33 , as well as of the cone and phase angles of the magnetic moments on all the atoms of the unit cell .",
    "the dependence on these angles is collectively expressed by @xmath34 for the set of all cone angles @xmath35 and by @xmath36 for the set of all phase angles @xmath37 in the argument of @xmath19 . to account for the condition @xmath38 under which the sum in eq .",
    "( [ eq : heisenberg2 ] ) is conducted ( and is indicated by a prime ) , from now on we set @xmath39 , for all the atoms @xmath40 in the unit cell .    with the aim to obtain the exchange interaction constants @xmath41 at the minimum of computational expense , we define in the following a set of expressions which are evaluated computationally .",
    "we first define the fourier transform @xmath42 it is straightforward to show that with the use of this fourier transform , eq .",
    "( [ eq : heisenberg2 ] ) becomes @xmath43 + \\cos\\theta_{\\alpha}\\cos\\theta_{\\beta}j_{\\alpha\\beta}({\\ensuremath{\\boldsymbol{0}}})\\right\\}.\\end{aligned}\\ ] ]      starting from the condition that @xmath44 are real and symmetric and from the definition of the fourier transform @xmath45 ( eq .  [ eq : fourier ] ) , several useful symmetry relations of @xmath45 can be derived ( valid for each @xmath2 vector ) :    1 .",
    "@xmath46 2 .",
    "@xmath47= { \\mathcal re}\\left[j_{\\alpha\\beta}(-{\\ensuremath{\\boldsymbol{q}}})\\right]$ ] 3 .",
    "@xmath48= -{\\mathcal im}\\left[j_{\\alpha\\beta}(-{\\ensuremath{\\boldsymbol{q}}})\\right]$ ] * @xmath49=0 $ ] * @xmath50=0 $ ] 4 .",
    "@xmath51 , where @xmath52 is a crystal point group symmetry element and @xmath53 are the equivalent sites in the unit cell to @xmath54 via the action of the symmetry element @xmath55 , i.e. , @xmath56 for some lattice vector @xmath57 ( and analogously for @xmath58 ) .",
    "symmetry relations 1 - 3 have been given previously in ref .  .",
    "symmetry relation 4 has the important consequence that the @xmath2 vectors can be sampled from the irreducible wedge of the brillouin zone while @xmath45 in the rest of the brillouin zone can be obtained by the symmetry transformations . in case that the crystal possesses the inversion symmetry @xmath59 and if @xmath60 and @xmath61 are both lattice vectors , then from symmetry relations 3 and 4 it follows that all @xmath45 are real .",
    "moreover , due to symmetry relation 1 , even if the system does not possess the inversion symmetry it is not necessary to make two separate calculations for @xmath2 and @xmath62 .      to develop a scheme for the calculation of the fourier transforms @xmath45 , we distinguish two different cases in the calculational setup .",
    "@xmath63**case 1 : * * all the atoms in the unit cell are ordered in the collinear ground state , except for atom @xmath64 .",
    "its magnetic moment is tilted by the cone angle @xmath65 and the spin spiral running through the system will affect only the magnetic moments situated on the atoms of the same kind as @xmath64 . in short :",
    "@xmath66 +   + with the use of the symmetry relations for the coefficients @xmath45 , from the total energy expression ( [ eq : heisenberg3 ] ) one obtains @xmath67 @xmath63**case 2 : * *    this case will appear only if there are two or more magnetic atoms in the unit cell .",
    "keeping the rest of the magnetic moments parallel , the magnetic moments on atoms @xmath64 and @xmath68 are tilted by cone angles @xmath65 and @xmath69 , respectively , so the spin spiral running through the system changes the orientation of magnetic moments on both of these atoms : @xmath70 +   + as we have seen , if the system does not possess inversion symmetry , the coefficients @xmath71 are complex for @xmath72 . their real and imaginary part can be obtained as    @xmath73 & = & \\frac{1}{m_{\\mu}m_{\\nu}\\sin\\theta_{\\mu}\\sin\\theta_{\\nu } } \\left\\ { e^{\\mu\\nu}({\\ensuremath{\\boldsymbol{0}}},\\frac{\\pi}{2 } ) -e^{\\mu\\nu}({\\ensuremath{\\boldsymbol{q}}},0 ) + e^{\\mu}({\\ensuremath{\\boldsymbol{q } } } ) - e^{\\mu}({\\ensuremath{\\boldsymbol{0}}})+   e^{\\nu}({\\ensuremath{\\boldsymbol{q}}})-e^{\\nu}({\\ensuremath{\\boldsymbol{0 } } } ) \\right\\ } \\label{eq : realj } \\\\",
    "{ \\mathcal im}\\left[j_{\\mu\\nu}({\\ensuremath{\\boldsymbol{q}}})\\right ] & = & \\frac{e^{\\mu\\nu}({\\ensuremath{\\boldsymbol{q}}},\\frac{\\pi}{2 } ) -e^{\\mu\\nu}({\\ensuremath{\\boldsymbol{q}}},0 ) } { m_{\\mu}m_{\\nu}\\sin\\theta_{\\mu}\\sin\\theta_{\\nu}}-{\\mathcal    re}\\left[j_{\\mu\\nu}({\\ensuremath{\\boldsymbol{q}}})\\right ] .",
    "\\label{eq : imaginaryj}\\end{aligned}\\ ] ]    where @xmath74 and @xmath75 denote the total energies in the presence of a spin spiral defined with the wave vector @xmath2 and the difference of the phase factors @xmath76 and @xmath77 respectively .",
    "we have established that the fourier transforms @xmath71 can be obtained from the differences in total energy between the states having specified magnetic configurations .",
    "armed with eqs .",
    "( [ eq : jmm ] ,  [ eq : realj ] ) and  ( [ eq : imaginaryj ] ) we are now ready to calculate the heisenberg exchange coupling constants , @xmath78 .",
    "first , however , one has to take into account that from the eq .",
    "( [ eq : jmm ] ) it is only possible to calculate the difference @xmath79 , but not the coefficient @xmath80 alone .",
    "this problem can be easily circumvented by introducing the coefficients @xmath81 , defined as @xmath82 also , for simplicity , the non - zero cone angles can in all calculations be taken to have the same value @xmath83 .",
    "( [ eq : jmm ] ,  [ eq : realj ] ) and  ( [ eq : imaginaryj ] ) can now be re - written as @xmath84 & = & \\frac{e^{\\mu\\nu}({\\ensuremath{\\boldsymbol{0}}},\\frac{\\pi}{2 } ) -e^{\\mu\\nu}({\\ensuremath{\\boldsymbol{q}}},0 ) } { m_{\\mu}m_{\\nu}\\sin^2\\theta } -\\frac{1}{2}\\frac{m_{\\mu}}{m_{\\nu}}\\tilde{j}_{\\mu\\mu}- \\frac{1}{2}\\frac{m_{\\nu}}{m_{\\mu}}\\tilde{j}_{\\nu\\nu}\\label{eq : rejtilde}\\nonumber\\\\ { \\mathcal im}\\left[\\tilde{j}_{\\mu\\nu}({\\ensuremath{\\boldsymbol{q}}})\\right]&=&\\frac{e^{\\mu\\nu}({\\ensuremath{\\boldsymbol{q}}},\\frac{\\pi}{2 } ) -e^{\\mu\\nu}({\\ensuremath{\\boldsymbol{q}}},0 ) } { m_{\\mu}m_{\\nu}\\sin^2\\theta}-{\\mathcal re}\\left[\\tilde{j}_{\\mu\\nu}({\\ensuremath{\\boldsymbol{q}}})\\right].\\label{eq : imjtilde}\\end{aligned}\\ ] ]    the final step will be a simple back - fourier transform . using eqs .",
    "( [ eq : fourier ] ) and ( [ eq : jtilde ] ) it is easy to see that @xmath85 finally , we note that from the definition  ( [ eq : jtilde ] ) it is clear that @xmath81 satisfies the same symmetry relations as the coefficients @xmath71 .",
    "the described calculations can be time consuming , since they involve the determination of small energy differences ( typically of the order of a few mryd ) . due to the oscillatory phase in eq .  (",
    "[ eq : integration ] ) , the appropriate size of the @xmath2 point set increases with the distance between the two atoms for which the interaction constant is being calculated , the grid fineness being basically determined by the inverse of the quantity @xmath86 that enters the exponential in eq .",
    "( [ eq : integration ] ) . in the spirit of the nyquist - shannon sampling theorem,@xcite and for @xmath87 , the @xmath2-grid fine spacing in the direction of @xmath57 should be at most half the value @xmath88 .",
    "additionally , sufficient accuracy requires larger plane - wave basis sets and a finer @xmath89-point grid compared to a simple ground - state calculation .",
    "a rule of thumb for increased accuracy is that , given a @xmath2-grid the @xmath89-grid should be twice as fine per spatial dimension of the lattice in order to avoid spurious oscillatory behaviour of period of the grid - spacing @xmath90 in @xmath81 .",
    "a self - consistent calculation of all energies needed here is computationally very demanding .",
    "fortunately , in many cases the spin spiral can be considered a small enough perturbation that the force theorem @xcite can be used to calculate the energy differences .",
    "we discuss this in the following subsection .",
    "the magnon energy is calculated as the difference between the total energy of the system with a spin spiral ( this is an excited state ) , and the ground state , which is ferromagnetic in the systems under study here .",
    "a self - consistent calculation of the spin spiral requires use of a constraint , in the form of an external spiraling magnetic field , which forces the magnetization to take the form given in eq .",
    "( [ eq : magnm ] ) . on the other hand",
    ", an application of the force theorem requires a position dependent rotation of the exchange - correlation field @xmath91 so that its direction acquires the form ( [ eq : magnm ] ) , i.e. , @xmath92 where @xmath93 is the self - consistent exchange - correlation field of the collinear calculation at atom type @xmath40 ( @xmath94 is the exchange - correlation potential dependent on spin @xmath95 ) . in the flapw method",
    ", this rotation is applied in the muffin - tin spheres , i.e. , non - overlapping spheres around the atomic nuclei where the potential is expanded in radial functions and spherical harmonics , as well as in the interstitial space between these spheres .",
    "using the field of eq .",
    "( [ eq : bnoco ] ) in the kohn - sham equations yields a ( non - self - consistent ) sum of eigenvalues of the occupied levels ; according to the force theorem , the magnon energy is approximated by the difference of this sum to the sum of eigenvalues of occupied levels in the self - consistent ferromagnetic ground state .",
    "direction for a cone angle @xmath96 .",
    "right : spin spiral energy vs. @xmath97 for a short - wavelength spiral along the [ 001 ] direction.[fig : force],width=264 ]    the approximation is expected to be better for smaller perturbations , i.e. , for smaller cone angles and/or smaller magnon wavevectors @xmath98 . as a test , in the left panel of figure  [ fig : force ]",
    "the dispersion curve is shown for a spin spiral in nimnsb , defined by a cone angle @xmath96 , and a spin - wave vector along [ 001 ] direction . the force - theorem and self - consistent calculations",
    "agree rather well .",
    "the right panel of fig .",
    "[ fig : force ] shows the dependence of the magnon energy on the squared sinus of the cone angle ( @xmath97 ) for a fixed spin - spiral vector @xmath99 .",
    "we see a a maximal deviation of the order of 7 - 8% for the unfavourable case of @xmath100 and @xmath101 , while the deviation starts becoming visible at cone angles larger than @xmath102 .",
    "a general conclusion is that if one wants to use the force theorem to obtain the spin - spiral dispersion within the whole first brillouin zone of the crystal , a cone angle @xmath96 seems to be a reasonable choice , since the energy differences are not too large for the magnon to stop being a small perturbation , but are also not too small so that one would have to employ a very large basis , or @xmath103-point set .",
    "this cone angle was used in the calculation of the heisenberg interaction constants @xmath104 presented in section  [ sec : jijcalc ] .",
    "we close this section with a comment on a spurious effect of the exchange - correlation field in the interstitial region when the force theorem is used .",
    "( the interstitial region is covered by empty spheres or empty cells in some ab - initio methods , e.g. in the asw@xcite or lmto method,@xcite if the structures are relatively open , as are for instance the half - heusler or the zinc - blende structure . ) in a force - theorem application , the trial exchange - correlation potential in the interstitial is a smooth periodic function . however , in a self - consistent spin - spiral calculation , the resulting exchange - correlation potential is in many cases a much less smooth , although still periodic , function.@xcite then the interstitial magnetization in the force - theorem calculation can cause a serious overestimation of the spin - spiral energy .",
    "this spurious energy contribution can be circumvented by setting the magnetic part of the exchange - correlation potential in the interstitial to zero .",
    "depending on the volume filling of the touching `` muffin - tin '' atomic spheres of the system , the spurious energy can be considerable , becoming larger for open systems . in fig .",
    "[ fig : interstitial]a we show a calculated example for nimnsb .",
    "the self - consistent spiral energy and the force - theorem energy ( here normalized to @xmath97 ) are practically identical , if we set @xmath105 in the interstitial in the force theorem calculation ( in the self - consistent calculation , @xmath91 is non - zero also in the interstitial ) ; if this correction is not used , then the spiral energy is strongly overestimated .",
    "[ fig : interstitial]b - d show the same for fe@xmath0mnsi in the full - heusler structure , femnsi in the half - heusler structure , and fesi in the zincblende structure .",
    "all three structures are based on an fcc lattice and were calculated here with the same lattice parameter @xmath106   , but differ in the number of atoms in the unit cell and therefore in the volume of the interstitial region .",
    "fe@xmath0mnsi has the smallest interstitial region , and evidently the interstitial magnetization has almost no effect ; both force theorem calculations practically coincide with the self - consistent result . for femnsi , however , the interstitial volume is larger and the spiral energy is strongly overestimated in the force theorem calculation , if the interstital magnetization is not set to zero .",
    "the effect is even stronger for fesi , where the interstitial volume is largest .",
    "following the prescription of sec .  [",
    "sec : jij ] we calculated heisenberg exchange interaction parameters ( @xmath107 ; @xmath108 are abbreviations of @xmath109 ) of co@xmath0mnsi and nimnsb , shown in fig .",
    "[ fig : exchange ] and used a monte carlo method to obtain an estimate of the curie temperatures for these compounds .",
    "the calculations for both compounds were performed within the generalized gradient approximation@xcite on a 4096 @xmath89-point mesh with 2744 @xmath2-points in the full brillouin zone .",
    "the planewave cutoff was @xmath110 .",
    "the convergence was checked with respect to the above parameters .",
    "mnsi ( a ) and nimnsb ( b ) as a function of the distance r between the atoms ( in units of the lattice constant  @xmath111 ) .",
    "the lines are guides to the eye.[fig : exchange],title=\"fig:\",width=226 ] mnsi ( a ) and nimnsb ( b ) as a function of the distance r between the atoms ( in units of the lattice constant  @xmath111 ) .",
    "the lines are guides to the eye.[fig : exchange],title=\"fig:\",width=226 ]    , width=226 ]     per unit cell ( blue full line ) , partial moment of the mn and co sublattices ( green dashed lines ) , and susceptibility @xmath112 ( red full line ) as functions of the temperature @xmath113 , for co@xmath0mnsi .",
    "the peak of the susceptibility at 980  k indicates the curie temperature ( experimentally found to be 985 k ) .",
    "note that the susceptibilities are shown in an arbritary scale .",
    "[ fig : mcclassic],width=264 ]    in co@xmath0mnsi , both co and mn atoms have strong and stable magnetic moments , whose interaction is described with @xmath104 parameters depicted in fig .",
    "[ fig : exchange]a . in nimnsb , though the magnetic moment of ni is small and actually induced by the mn surrounding atoms , both ni and mn were treated as magnetic atoms and the parameters of mn - mn , ni - ni , and mn - ni interaction were calculated ( fig .",
    "[ fig : exchange]b ) . as will be discussed in sec .",
    "[ sec : longitudinal ] , this treatment gives an insight into the thermal behaviour of the ni sublattice and with the use of an extended heisenberg model more useful information can be obtained .",
    "co@xmath0mnsi and nimnsb are half - metallic ferromagnets , i.e. , the density of states ( dos ) in one spin direction ( here majority spin ) is metallic , while in the other spin direction the dos shows a band gap around the fermi level .     for a non - half - metallic ferromagnet , the interaction constants @xmath107 as a function of distance follow a decaying oscillating behavior that in the simplest case is of the ruderman - kittel - kasuya - yoshida ( rkky ) type , decaying with @xmath114 , but in general can have many superimposed periods and a different decay power law depending on the details of the fermi surface.@xcite on the other hand , for half - metallic ferromagnets the gap at one spin direction leads to an imaginary wave vector and an exponential decay with distance.@xcite in both cases shown in fig .",
    "[ fig : exchange ] , we notice this very fast decay of the interaction parameters with the distance between the atoms . for a comparison , in fig .",
    "[ fig : co ] , the exchange interaction parameters of fcc  co ( which is not half - metallic ) are shown .",
    "the decay here is much slower .     in a short digression , we compare the results of the spin - spiral approach within the flapw method to the approach of infinitesimal rotations@xcite calculated with the full - potential korringa - kohn - rostoker green function method ( kkr).@xcite in kkr we use both the ferromagnetic state and the disordered local moment ( dlm ) state as reference points ( see also the discussion in sec .  [",
    "sec : remarksii ] ) .",
    "we see in fig .",
    "[ fig : co ] that the agreement is good for fcc co , with a deviation of 3   nearest - neighbor coupling , if the ferromagnetic state is used as a reference , while the deviation is large if the dlm state is used as reference ( also the atomic moment decreases from 1.65  @xmath115  in the ground state to 1.08  @xmath115  in the dlm state ) . for co@xmath0mnsi ( not shown here ) we find that the difference between kkr and flapw is larger , with the mn - co nearest - neighbor coupling being approximately 10   state is used as reference , the co moment vanishes altogether .",
    "once the exchange interactions are known , the effective heisenberg model can be solved for the curie temperature .",
    "while the mean field approximation is computationally the simplest method to this task , it is known ( and has been shown in practice ) that the resulting @xmath1  is overestimated . the random phase approximation ( also known as tyablikov approximation ) , on the other hand , is rather accurate.@xcite the most accurate , but numerically more expensive , way to calculate @xmath1  of a classical heisenberg model is the monte carlo method , in particular when taking advantage of the cumulant expansion to account for the finite size of the simulation supercells . in this work we applied the monte carlo method , locating @xmath1  by the peak in the temperature - dependent , static susceptibility . as the simulation supercells are rather large , finite - size corrections to @xmath1  are small .",
    "we also show monte carlo magnetization curves for co@xmath0mnsi in fig .",
    "[ fig : mcclassic].@xcite the classical heisenberg hamiltonian , eq .",
    "( [ eq : heisenberg1 ] ) was used to model the systems , assuming that the magnetic moments can change their orientation , but not their length .",
    "nimnsb is discussed in more detail in sec .",
    "[ sec : longitudinal ] . in the calculations",
    "the metropolis method was employed .",
    "a supercell of 2048 unit cells ( 4096 magnetic atoms ) was used for nimnsb and one of 2197 unit cells ( 6591 magnetic atoms ) for co@xmath0mnsi ; interactions to neighbors up to a distance of four lattice constants were included .",
    "for each temperature the number of monte carlo sampling events was 5000 , after allowing an initial relaxation time of 1000 steps and taking one sampling event every 10 sweeps of the lattice .",
    "the magnetization curves ( fig .  [",
    "fig : mcclassic ] ) do not go to a sharp zero at @xmath1 , but rather have a tail , as a result of the finite supercell .",
    "the peak of the susceptibility is , on the other hand , rather sharp and its position can be used to determine the curie temperature . from the positions of these peaks , we estimated for co@xmath0mnsi ( fig .",
    "[ fig : mcclassic ] , left ) @xmath1=980  k ( experimental@xcite 985  k ) , and for nimnsb ( see sec .  [",
    "sec : longitudinal ] ) @xmath1=870  k ( experimental@xcite value being 730  k ) .",
    "note that here , for nimnsb , the ni moment was also taken into account within the heisenberg model ( but see also the discussion in sec .",
    "[ sec : longitudinal ] , in particular [ sec : nimnsb ] ) .",
    "for fcc co we find a curie temperature of 1200  k , while the experimental result is 1403  k ( the high - temperature stable phase of co is fcc ) .",
    "so far we have discussed a formalism and examples of calculation of exchange parameters for a heisenberg model , assuming that the magnitude of the local magnetic moments is rigid . however , as is long known , certain systems are weakly magnetic and the moment formation takes place at a relatively low energy scale , comparable to the magnon energies .",
    "moriya s quantum mechanical spin fluctuation theory@xcite already factors in these effects .",
    "an introduction of a classical hamiltonian including longitudinal and transverse degrees of freedom has been done by uhl and kbler@xcite by parametrizing _",
    "ab - initio _ total energy results ; thermodynamic quantities were then obtained within a mean - field approach which coupled longitudinal and transverse degrees of freedom.@xcite more elaborate approaches by a classical fit of the energy to density - functional results , including transversal and longitudinal degrees of freedom , together with monte - carlo or classical spin - dynamics calculations , were presented e.g. by rosengaard and johansson,@xcite ruban _ et al._,@xcite ma and dudarev,@xcite or derlet.@xcite    particularly interesting are compounds of a strongly magnetic and a weakly magnetic subsystem , where the weak moments can not be treated as having rigid - magnitude , but on the other hand are large enough that they can not be neglected .",
    "examples are fept , fepd , or nimnsb , where the strongly magnetic atoms are fe and mn , while the weakly magnetic atoms are pt , pd and ni .",
    "then the assumption of rigid heisenberg spins does no longer seem plausible .",
    "one way to circumvent this is to use only the strong magnetic moments as independent variables , but with their pair exchange parameters renormalized by the exchange among the weakly magnetic atoms and by the enhanced susceptibility .",
    "such an approach was , for example , used by mryasov _",
    "et al._@xcite to model the temperature dependence of the magnetic anisotropy in fept .",
    "et al._@xcite also find improvement in the theoretical results if the weak moments are not treated as independent , rigid heisenberg spins , but rather fully adjust to the magnetization of the strong - moment sublattice .",
    "there is , however , the point of view of treating the weak moments not as fully enslaved to their strong - moment environment , but as independent degrees of freedom whose fluctuation can affect the thermodynamics .",
    "this point of view has been pushed for example in order to understand the antiferromagnetic - to - ferromagnetic transition of ferh.@xcite    in this section we develop a method of treating such systems , emphasizing the choise of the energetically relevant magnetic degrees of freedom at temperatures up to the critical temperature , as well as the practical implementation of these degrees of freedom to models that can be solved via monte carlo simulations .",
    "the additional challenge , compared to the theory developed in the previous sections , stems from two facts .",
    "first , a treatment of the weak moments as independent degrees of freedom must include the energy scale of the moments magnitude as well as their direction .",
    "second , if the interactions of the strong moments are calculated as described earlier , by considering non - collinear magnetic configurations , then the calculated energies include a spurious contribution because the magnitude of the weak moments changes during the application of the non - collinear constraint .",
    "this spurious contribution must be accounted for .",
    "however , at the end we see that , in certain commonly occuring situations , the degrees of freedom of the weak - moment atoms can be eliminated in the statistical - mechanical calculations by using renormalized exchange parameters , while the statistical averages of the weak moments follow directly from the averages of the strong moments .",
    "we show that this is an exact result if the weak degrees of freedom give only quadratic contributions to the energy . here",
    "we make a step - by - step approach for the special case where the weak moments do not interact with each other , while we present the more general case when they interact in the appendix .",
    "the magnetically strong atoms are the main carriers of spin moment that also acts as an effective field @xmath116 polarizing the magnetically weak atoms .",
    "the polarization of the latter is strengthened by an enhanced local susceptibility , which ( neglecting complications from the band - structure ) is @xmath117 ( with @xmath118 the pauli paramagnetic susceptibility and @xmath119 the exchange integral ) .",
    "let us denote by @xmath120 the rigid - magnitude local moment of the magnetically strong atoms and by @xmath121 the supple local moment of the magnetically weak atoms .",
    "a simple expression that parametrizes the energy in terms of the local moment @xmath121 and the polarizing field @xmath116 is @xmath122 = -{\\ensuremath{\\boldsymbol{h}}}^{\\rm eff}\\cdot{\\ensuremath{\\boldsymbol{\\mu } } } + a\\mu^2 + b\\mu^4 \\label{eq : l1}\\ ] ] it is implied that @xmath123 , where @xmath124 is the summed moment of the neighboring atoms inducing a polarization , @xmath125 is a phenomenological parameter which encapsulates all microscopic processes ( in particular electron hoppings ) that couple @xmath121 to @xmath124 , while @xmath126 is an external magnetic field that we henceforth set to zero.@xcite in the absence of a field @xmath116 eq .",
    "( [ eq : l1 ] ) contains only even powers of @xmath121 , because symmetry requires @xmath127={\\ensuremath{e_{\\rm loc}}}[0,-{\\ensuremath{\\boldsymbol{\\mu}}}]$ ] .    in eq .",
    "( [ eq : l1 ] ) we always must have @xmath128 . the case of spontaneous polarization is described by @xmath129 and @xmath130 , while the case of induced magnetic moments is described by @xmath131 . in this case , the on - site susceptibility is @xmath132 thus the enhancement of the susceptibility is contained in the parameter @xmath133 .",
    "( [ eq : l1 ] ) , if the fourth - order term is negligible , can be written as @xmath122= a\\biggl({\\ensuremath{\\boldsymbol{\\mu}}}-\\frac{1}{2a}{\\ensuremath{\\boldsymbol{h}}}^{\\rm eff}\\biggr)^2-\\frac{1}{4a}(h^{\\rm eff})^2,\\   \\text{if $ b=0$. }   \\label{eq : l1b}\\ ] ]    to elaborate on these ideas we use nimnsb as a concrete example . in this case",
    "the mn subsystem is magnetically strong and the ni subsystem magnetically weak .",
    "we have also found that in this case it is a good approximation to set @xmath134 ( as we show below ) , which we adopt .",
    "combining eq .",
    "( [ eq : l1 ] ) at @xmath134 with the heisenberg - model energy expression for the mn subsystem results in the extended model hamiltonian @xmath135 \\label{eq : l2}\\end{aligned}\\ ] ] where @xmath136 is the sum of the moments of the mn nearest neighbors of the @xmath137-th ni atom , @xmath138 , and @xmath139 and @xmath140 refer to the mn and ni moment respectively .",
    "the superscript `` @xmath141 '' in the mn - mn exchange interaction is placed in anticipation that it does not coincide with the quantity calculated within the method presented in sec .",
    "[ sec : jij ] , but with a `` bare '' quantity , as will be discussed below .",
    "it has been also assumed that the ni - ni interaction can be neglected , as there are no ni - ni nearest neighbor pairs , while from the calculations it becomes evident that more distant ni - ni interactions are negligible ( the case where the interactions among the weak - sublattice moments are non - negligible is discussed in the appendix ) .",
    "the above equation can be rewritten in a somewhat more convenient form , if we define ( with an obvious notation ) @xmath142 then eq .  ( [ eq : l2 ] ) takes the form",
    "@xmath143 + \\sum_{l \\in { \\ensuremath{\\rm ni } } } a\\mu_l^2\\nonumber\\\\ \\label{eq : l3}\\end{aligned}\\ ] ] this form is appealing , as it contains a heisenberg - like expression among all magnetic atoms plus a local correction term that accounts for the longitudinal degree of freedom of the ni moments . however , it is important to remember that the ni moments included in the scalar products of the rhs can change in size as well as angle , deviating from the traditional heisenberg model .",
    "we can derive the parameters @xmath125 and @xmath133 from dft calculations as follows . from eq .",
    "( [ eq : l1b ] ) it follows that the equilibrium value of the ni moment at @xmath144 and for zero external field is linearly dependent to the polarizing neigboring mn moments : @xmath145 where @xmath146 is the coordination number of a ni atom with respect to mn neighbors . from this expression",
    "one can deduce the ratio @xmath147 once @xmath148 and @xmath149 have been calculated in the ferromagnetic state by an _ ab - initio _ method . on the other hand ,",
    "@xmath133 can be determined by introducing into the dft calculation a constraint on the ni moment , either in the form of a longitudinal magnetic field constraining the magnitude or in the form of a transverse magnetic field constraining the angle @xmath83 of @xmath121 with respect to the moment directions at the mn neighbors , but allowing the magnitude to relax to @xmath150 .",
    "the former method results in a parabolic ( for @xmath134 ) moment - dependence of the total energy , as suggested by eqs .",
    "( [ eq : l1],[eq : l1b ] ) .",
    "the latter method results in the following dependence , as can be easily found by an energy minimization of eq .",
    "( [ eq : l1b ] ) at a given @xmath83 : @xmath151 if the extended heisenberg model provides a good approximation to the energetics of the system , then eqs .",
    "( [ eq : l1b ] ) and ( [ eq : l5b ] ) should both yield a good approximation to the calculated dft energy difference , when a constraint is applied on the ni moment , and the extracted parameter @xmath133 for the two cases should be approximately the same .",
    "we find that this is the case in nimnsb ( see fig  [ fig : energy_moment_angle]).@xcite this allows us to extract the value of @xmath133 from the dft calculation and from this the value of @xmath125 ( equivalent to @xmath152 ) via eq .",
    "( [ eq : l4 ] ) .",
    "thus the ingredients of formula  ( [ eq : l3 ] ) are accessible .    ) with @xmath153 .",
    "bottom : dependence of the ni moment and the total energy on the constraining angle @xmath83 tilting the ni moment away from the mn moment in nimnsb .",
    "blue squares : @xmath150 ( scale displayed on the left - side ordinate ) .",
    "red circles : @xmath154 ( scale displayed on the right - side ordinate ) .",
    "the broken lines correspond to fits to eqs .",
    "( [ eq : l5a ] ) and ( [ eq : l5b ] ) . in the energy fit , the last part of eq .",
    "( [ eq : l5b ] ) was used with the prefactor @xmath155 fitted to the low - angle contributions ( @xmath156 and @xmath157 ) .",
    "[ fig : energy_moment_angle],title=\"fig:\",width=226 ] ) with @xmath153 .",
    "bottom : dependence of the ni moment and the total energy on the constraining angle @xmath83 tilting the ni moment away from the mn moment in nimnsb .",
    "blue squares : @xmath150 ( scale displayed on the left - side ordinate ) .",
    "red circles : @xmath154 ( scale displayed on the right - side ordinate ) .",
    "the broken lines correspond to fits to eqs .",
    "( [ eq : l5a ] ) and ( [ eq : l5b ] ) . in the energy fit , the last part of eq .",
    "( [ eq : l5b ] ) was used with the prefactor @xmath155 fitted to the low - angle contributions ( @xmath156 and @xmath157 ) . [",
    "fig : energy_moment_angle],title=\"fig:\",width=264 ]    there remains , however , a correction to be made , connected to a `` renormalization '' of the mn - mn exchange constants which have been calculated within the spin - spiral method described in section  [ sec : jij ] . to clarify the problem",
    "we remind the reader that , when calculating spin spirals , one normally constrains the direction of the moments but not their magnitude . for the ni atoms , where the rigid - moment approximation is not valid ,",
    "the magnitude @xmath64 is reduced by the spin - spiral formation due to the canting of the neighboring mn moments in different directions .",
    "this effect provides an additional , indirect energy contribution to the spin spiral and to the mn - mn interaction , compared to the case that the ni - moments magnitude would have been kept constant .",
    "it is the spurious contribution that we mentioned in the introduction to sec .",
    "[ sec : longitudinal ] .",
    "let us call this contribution @xmath158 .",
    "the calculated mn - mn interaction consists thus of two parts : @xmath159 with @xmath160 the sought - after bare interaction entering eqs .",
    "( [ eq : l2.5 ] ) and ( [ eq : l3 ] ) , while @xmath161 is a renormalized interaction that is probed by the spin - spiral dft calculation . for more distant mn atoms , which have no common ni neighbor , @xmath160 coincides with @xmath161 .    for the derivation of an expression ,",
    "e.g. in the case of nimnsb , giving @xmath158 , consider @xmath162 mn atoms as nearest neighbors of a ni atom .",
    "then the local - energy expression ( [ eq : l1b ] ) becomes @xmath163 here , @xmath164 and @xmath165 run through the mn moments .",
    "the second step follows under the condition that , in the dft calculation , the ni moment relaxes to the particular equilibrium value that is dictated by the neighboring mn - moment directions , i.e. , @xmath166 . from eq .",
    "( [ eq : l6 ] ) we obtain the indirect interaction : @xmath167    at this point it is important to note that , whether one chooses to work with @xmath161 or @xmath160 , depends on the choice of the degrees of freedom .",
    "if only the mn moments are chosen as degrees of freedom , then @xmath161 has to be used .",
    "if , however , the ni moments are also chosen as independent degrees of freedom , then @xmath160 has to be used together with @xmath168 . in the latter case , according to the prescription leading to eqs .",
    "( [ eq : l2.5 ] ) and ( [ eq : l7 ] ) , we arrive at the extended heisenberg hamiltonian ( [ eq : l3 ] ) with the appropriate bare parameters in the nearest - neighbor coupling .      in the previous subsection we discussed the bare and renormalized parameters of the model arising from total - energy calculations of the constrained ground state . in this section",
    "we examine the case of thermodynamic quantities at @xmath169 , where it is not _ a priori _ obvious that the same renormalization is still valid if the weak moments are allowed to fluctuate .",
    "we find that , in the absence of fourth order terms in @xmath170  [ @xmath134 in eq .",
    "( [ eq : l1 ] ) ] , also at @xmath169 the weak moments can be eliminated in favour of the same renormalized parameters as the ones appearing at @xmath144 .",
    "our conclusion is based on an exact analytical integration of the weak - moment part of the partition function in the case @xmath134 .",
    "first we observe that the energy functional ( [ eq : l1b ] ) under the action of @xmath116 has the same quadratic form as the one with @xmath171 , only with the minimum shifted to @xmath172 .",
    "this simplifies the integration of the partition function . to see this",
    ", we first transform the hamiltonian ( [ eq : l2 ] ) in such a way that the renormalized interactions @xmath107 appear explicitly .",
    "we start by rewriting eq .",
    "( [ eq : l2 ] ) as : @xmath173 the indices @xmath108 run over the mn atoms , the index @xmath137 over the ni atoms , and @xmath138 over the mn neighbours of the @xmath137-th ni atom .",
    "the last term is now split in an interatomic contribution and an on - site contribution : @xmath174 in the last step we have converted the sum @xmath175 to a sum over @xmath108 , by introducing a combinatorial factor @xmath176 that counts how many common ni neighbors the @xmath177-th and @xmath178-th mn atoms have . from the structure of nimnsb it follows that @xmath179 , if @xmath108 are nearest - neighbors in the mn fcc sublattice ( i.e. if the distance between @xmath177 and @xmath178 is @xmath180 ) and @xmath181 otherwise .",
    "actually we have recovered the quantity @xmath182 of eqs .",
    "( [ eq : l6 ] ) and ( [ eq : l7 ] ) . finally , the last term of eq .",
    "( [ eq : l9 ] ) is just a constant which can be omitted . using the definition ( [ eq : l5.5 ] ) and eq .",
    "( [ eq : l7 ] ) , we combine the first term of the rhs of eq .",
    "( [ eq : l8 ] ) with the first term of the rhs of eq .",
    "( [ eq : l9 ] ) to obtain the renormailized @xmath107 .",
    "then the hamiltonian to be used in the partition function takes the form :    @xmath183    where the heisenberg hamiltonian involving only the mn sublattice with the renormalized interactions , @xmath184 , has been introduced for convenience as part of the full hamiltonian .",
    "note that there is no renormalization for the ni - mn interactions : either they should be completely omitted within @xmath185 that includes only the mn moments , or they should be given by eq .",
    "( [ eq : l2.5 ] ) in the generalized model .",
    "the spin - spiral result for @xmath186 does not enter in our theory .    the partition function is : @xmath187 where @xmath188 denotes an integration over the mn - moment solid angles .",
    "the integration over the ni - moments @xmath189 contains only the exponential of a complete square and has been analytically integrated to @xmath190 , i.e. , it corresponds to the partition function of @xmath191 uncoupled harmonic degrees of freedom and is independent of the value of @xmath124 .",
    "@xmath192 is the partition function corresponding to the hamiltonian @xmath185 .",
    "the magnetization @xmath193 of the mn sublattice also turns out to depend only on the renormalized partition function ( and hamiltonian ) .",
    "the same is true for any moment - moment correlation function of the mn sublattice , @xmath194 , @xmath195 , where the @xmath196 are integer exponents defining the order of the correlation function . to see this we consider explicitly @xmath197    where the hamiltonian in the exponential has again been split in two terms according to eq .",
    "( [ eq : l10 ] ) and the integration over @xmath198 has again been carried out analytically , cancelling out the factor @xmath190 in the full partition function . but expression ( [ eq : l12 ] ) is just the expression for the correlation function of only the mn sublattice with the renormalized heisenberg interactions .",
    "thus we see that , as far as the mn - sublattice magnetization is concerned , one can use the exchange interactions calculated by the spin - spiral method that are renormalized by construction , while neglecting the ni moments and the mn - ni interaction",
    ". if the ni moments are to be included , then the bare interactions have to be used in an extended model , however , the mn - sublattice properties in the two cases will be the same .",
    "note , finally , that this exact result is based on the fact that the exponent in the integration over @xmath198 contains a complete square , i.e. , that the `` harmonic '' approximation , @xmath134 , is valid ; if @xmath199 and one proceeds to an elimination of the weak degrees of freedom , then the resulting renormalized strong - moment hamiltonian can have higher - order terms ( biquadratic , four - spin , etc . ) with temperature - dependent parameters .",
    "a semi - analytical result follows in an analogous way also for the average ni moment and fluctuation amplitude per atom : @xmath200\\rangle^2\\label{eq : l14 } \\\\ &",
    "= & \\frac{1}{a}\\frac{3}{2}k_bt + \\left(\\frac{\\kappa}{2a}n_c\\right)^2 \\frac{1}{n } \\langle [ \\sum_{i=1}^n { \\ensuremath{\\boldsymbol{m}}}_i]^2\\rangle \\nonumber\\\\   & = & \\frac{1}{a}\\frac{3}{2}k_bt + \\left(\\frac{\\kappa}{2a}n_c\\right)^2 \\langle m^2 \\rangle \\label{eq : l15}\\end{aligned}\\ ] ] i.e. , there is a `` harmonic '' part and a part induced by the fluctuation of the mn sublattice .",
    "the former is independent of the number of atoms , while the latter , @xmath201 ^ 2\\rangle / n$ ] , increases proportionally to the number of magnetic atoms in the system for @xmath202 , as in normal heisenberg systems.@xcite the longitudinal susceptibility @xmath203 of the ni sublattice can be found in a completely analogous way : @xmath204 \\label{eq : l16}\\end{aligned}\\ ] ] i.e. , there is again a harmonic part and a part proportional to the mn sublattice susceptibility .",
    "( in eq .",
    "( [ eq : l16a ] ) , @xmath28 is implied to be the direction of magnetization . )    according to these results , as long as the approximation @xmath134 holds , one can deduce the thermodynamic properties of the weak sublattice by merely a calculation on the strong sublattice , avoiding the extra numetical cost that a full monte carlo simulation entails .",
    "actually this procedure can be carried out for higher - order correlation functions of the ni moments , @xmath205 ( @xmath195 ) , where once again the @xmath206 are integer exponents defining the order of the correlation function . in the resulting formula the integration over @xmath207",
    "can be carried out analytically , yielding a sum of correlation functions of the @xmath139 of the form :    @xmath208    where a change of variables @xmath209 has been performed , the binomial expansion of @xmath210 has been used and we have taken into account that integrals of the type @xmath211 for even @xmath212 and vanish for odd @xmath212 [ for the @xmath213 term we accept the convention @xmath214 . due to the presence of products of @xmath215 in eq .",
    "( [ eq : l18 ] ) it is clear that this expression reduces to a sum of correlation functions of the @xmath139 within the hamiltonian @xmath185 .",
    "the summations in this expression are too involved to arrive at a general closed form , however , eqs .",
    "( [ eq : l13 ] ) , ( [ eq : l15 ] ) and ( [ eq : l16 ] ) are special cases of application of this formula .",
    "obviously , mixed correlation functions between strong and weak moments can also be reduced to strong - moment correlation functions of the renormalized hamiltonian by first eliminating the weak moments following the same prescription .",
    "we should stress that choosing to eliminate the weak moments in favour of renormalized interactions does not mean that the weak moments are physically less valid as degrees of freedom ; to do so is merely a matter of mathematical or computational convenience , especially since efficient methods exist for the calculation of thermodynamic quantities within the classical heisenberg model .",
    "we exemplify the above results with calculations in nimnsb .",
    "first we establish which interactions can be neglected .",
    "to this end we performed calculations of the exchange coupling parameters by the spin - spiral method . as it turns out ,",
    "the ni - ni interactions are negligible . about the mn - mn interactions , fig .",
    "[ fig : exchange]b suggests that it should be enough to include up to 2nd neigbors , but this is misleading ; we find by monte carlo calculations a 2nd neighbor approximation leads to an overestimation of approximately 100  k in @xmath1  compared to the value including also more distant neighbors , therefore we include mn - mn interactions up to a distance of three lattice parameters . among the mn - ni interactions ( fig .",
    "[ fig : exchange]b ) only the nearest - neighbor coupling has some small influence , changing @xmath1  by a modest 20  k. given the conclusions of the previous subsection , the mn - ni interaction should be excluded for an estimation of @xmath1 , since the mn - mn interactions are already renormalized ( in the corresponding spin - spiral calculations the magnitude of the ni moment was allowed to relax ) .",
    "the mn - ni interaction must be included if one wishes to extract information on the behavior of the ni magnetization ; then , however , the interaction type and strength has to be corrected , since the ni atoms belong to a soft - magnetic sublattice .    after deriving the exchange parameters @xmath107 by the spin - spiral method , utilizing the force theorem which according to fig .",
    "[ fig : interstitial]a is accurate enough for this purpose , we performed constrained - angle calculations for the ni moments with full self - consistency . from the total - energy results shown in fig .",
    "[ fig : energy_moment_angle ] , together with eq .",
    "( [ eq : l5b ] ) , we deduce a value of @xmath216 .",
    "given this , together with the ground - state magnetic moments of mn @xmath217 and of ni @xmath218 , eqs .",
    "( [ eq : l2.5 ] ) and ( [ eq : l4 ] ) yield a value of @xmath219 .",
    "this bare value @xmath152 is significantly different than the value of @xmath220 for the mn - ni interaction , which was derived from the spin - spiral calculation ( fig .",
    "[ fig : exchange]b ) . finally , from eqs .",
    "( [ eq : l5.5 ] ) and ( [ eq : l7 ] ) we can extract the bare value of the nearest - neighbor mn - mn interaction : @xmath221 , which shows a reduction of about @xmath222 compared to the corresponding renormalized value . note that the equilibrium moments have to be multiplied to these values if comparison is to be made with the energies shown in fig .",
    "[ fig : exchange]b . then one obtains @xmath223 and @xmath224 ; i.e. , the mn - mn bare interaction is weaker than the mn - ni , which is not surprising , since the ni polarization stems from a direct , nearest - neighbor exchange interaction with mn .",
    "( eq .  [ eq : l2 ] ) .",
    "( c ) same as ( b ) , but additionally with bare mn - mn interactions @xmath160 ( given by eqs .",
    "( [ eq : l5.5],[eq : l7 ] ) ) .",
    "( d - e ) : also longitudinal fluctuations of the ni - moment are allowed .",
    "( d ) bare mn - ni interactions . ( e )",
    "bare mn - ni and mn - mn interactions .",
    "evidently , taking the mn - ni bare interaction alone leads to an overestimation of the excitation energies and @xmath1 , which is corrected when the bare mn - mn interaction is also taken .",
    "bottom : magnetization curve and susceptibility of the mn sublattice in nimnsb calculated within different models .",
    "squares ( magnetization ) and circles ( susceptibility ) : only transverse fluctuations with renormalized mn - mn interactions , neglecting completely the ni moments . full line :",
    "transverse and longitudinal fluctuations are allowed for the ni atoms , only transverse for mn , with bare mn - mn and mn - ni parameters ; only the mn sublattice magnetization and susceptibility is shown ( i.e. , corresponding to the mn part of curve ( e ) in the top panel ) .",
    "note on the susceptibility units that @xmath225 .",
    "the temperature dependence of the magnetization and susceptibility is identical in the two cases for reasons that are explained in the text .",
    "[ fig : renorm1],width=283 ]     and @xmath226 stand for the temperature - dependent magnetization of the mn and ni sublattices , respectively ; @xmath227 stands for the thermal average of the absolute value of the ni local moment ; @xmath228 for the sublattice susceptibilities of mn and ni ; and @xmath229 for the ground - state local moments .",
    "( a ) traditional model ( only transverse fluctuations of the moment ) with the interactions derived by force - theorem from spin - spiral calculations .",
    "the mn magnetization shows a typical ferromagnetic behavior with a susceptibility peak at @xmath1 .",
    "on the other hand the ni magnetization drops rather fast , with an atypical susceptibility showing a plateau over a wide region .",
    "( b ) extended model ( longitudinal fluctuations of the ni moment are allowed ) with bare mn - ni and mn - mn interactions .",
    "the mn magnetization hardly changes compared to ( a ) , and the @xmath1  is very similar , but the behavior of the ni magnetization and susceptibility are completely different , following the critical behavior of the mn sublattice . at @xmath144 ,",
    "the ni susceptibility does not vanish , behaving as it is expected for a system with non - rigid moments , reaching the value @xmath230 at @xmath144 .",
    "the average of the magnitude of the local ni moment increases with temperature .",
    "the monte carlo simulations included 2048 unit cells ( 4096 atoms ) .",
    "the ni - related quantities have been scaled up by the annotated factors in order to demonstrate the agreement with eqs .",
    "( [ eq : l13 ] ) and ( [ eq : l16 ] ) : @xmath226 and @xmath227 by a factor @xmath231 and @xmath232 by @xmath233 .",
    "in particular the blue squares show the validity of eq .",
    "( [ eq : l16 ] ) , i.e. , the derivation of the ni from the mn susceptibility . the latter coincides with the @xmath234 of the traditional renormalized model , as is demonstrated in fig .",
    "[ fig : renorm1 ] ( bottom panel ) .",
    "[ fig : renorm2],width=283 ]    next we present a series of monte - carlo - simulation results , examining the effect and importance of the bare interactions .",
    "we performed simulations in the framework of the traditional model ( only transverse fluctuations allowed ) as well as the extended model ( longitudinal fluctuations also allowed ) , with the renormalized and bare parameters .",
    "putting it all together , we must substitute the above - found parameters @xmath235 , @xmath236 , and @xmath133 , into the extended hamiltonian ( [ eq : l3 ] ) which is to be treated with a monte carlo method where the ( weak ) ni moments @xmath140 should be allowed to vary in length and direction while the ( strong ) mn moments should be allowed to vary in direction only . in this particular example , a distinction between bare and renormalized interactions was made only for the nearest - neighbour mn - mn and mn - ni coupling .",
    "the longer - range mn - ni coupling was assumed to vanish thus there can be no renormalization in the longer - range mn - mn coupling [ as the distant mn atoms have no common ni neighbor , i.e. , @xmath237 for distant atoms in eq .",
    "[ eq : l5.5 ] ] .",
    "the ni - ni coupling was also assumed to vanish .",
    "the results are to be compared with calculations employing the traditional hamiltonian @xmath238 containing only the mn moments that vary in direction , where now @xmath107 are the mn - mn renormalized parameters , i.e. , obtained from the spin - spiral method presented in sec .",
    "[ sec : jij ] and shown ( multiplied by the moments ) in fig .",
    "[ fig : exchange]b . in both cases",
    "the mn - mn interaction was included up to a distance of three lattice parameters .",
    "the first set of results is contained in fig .",
    "[ fig : renorm1 ] , where magnetization curves are shown , calculated within different assumptions . here",
    "we omit showing the susceptibiliy , but the curie temperature can be recognized by the characteristic inflection point of the magnetization curve .",
    "the central results are included in curves ( a ) and ( e ) of the top panel , as well as in the bottom panel , while curves ( b ) , ( c ) and ( d ) merely show that neglecting some of the degrees of freedom or some of the bare constants leads to almost arbitrary results . in the simulations including longitudinal moment fluctuations ,",
    "more monte carlo steps were necessary , typically by an order of magnitude , in order to arrive at the same quality as in the simulations including only transverse fluctuations .",
    "curve ( a ) shows the result of the traditional model with spin - spiral - derived ( i.e. , renormalized ) mn - mn exchange parameters , including spin - spiral - derived mn - ni interactions .",
    "this results in @xmath239 . curve ( b ) includes the bare mn - ni parameters , but stays within the traditional model .",
    "@xmath1  increases by a modest amount of 60  k , since the bare mn - ni parameters are stronger than the spin - spiral - calculated ones",
    ". curve ( c ) also stays within the traditional model , but includes the bare mn - mn interaction , which is weaker by a factor @xmath222 compared to the renormalized value ; @xmath1drops significantly to 730  k. this coincides with the experimental value , but the coincidence is probably fortuitous : the longitudinal fluctuations at ni , that are essential to the derivation of the bare parameters , are yet unaccounted for in the simulation ( see , however , the discussion on the phase space measure in subsection [ sec : remarks ] ) .",
    "next comes curve ( d ) , where the longitudinal fluctuations are allowed for in the simulation , but taking the bare mn - ni and the renormalized mn - mn exchange .",
    "the increase in @xmath1  ( 1090  k ) with respect to curve ( b ) ( same parameters but rigid ni moment ) is striking .",
    "the difference stems from the fact that the ni local moment becomes larger at high temperatures ( see discussion on fig .  [",
    "fig : renorm2 ] below ) , thus the ferromagnetic contribution @xmath240 to the hamiltonian is effectively strengthened . finally , if we account also for the ( weaker ) bare mn - mn coupling in the extended model , we obtain curve ( e ) , which is very close to the original curve ( a ) , also with a very similar @xmath241  k. this value , however , is the same that one obtains if the traditional model is used , but with the ni moments completely neglected .",
    "in fact , the corresponding magnetization curve falls exactly on top of the mn - contribution to curve ( e ) , and the same is true for the mn - sublattice susceptibility .",
    "this striking agreement is also demonstrated in the bottom panel of fig .",
    "[ fig : renorm1 ] , and is expected on the basis of eq .",
    "( [ eq : l12 ] ) and the discussion thereafter .",
    "let us consider now the contrast between the traditional model with spin - spiral calculated interactions and the extended model with bare interactions .",
    "monte - carlo results on these are shown in fig .",
    "[ fig : renorm2]a and b , representing the traditional and extended model respectively .",
    "the main difference lies in the behavior of the ni - sublattice magnetization @xmath242 and susceptibility @xmath203 . for better comparison",
    "we have scaled up these quantities . in fig .",
    "[ fig : renorm2]a we see that the traditional model results in a ni magnetization that drops rather fast with temperature , much faster than the mn magnetization .",
    "this is due to the relatively weak coupling between the mn and ni sublattices . although the difference in energy scale is not directly obvious from fig .",
    "[ fig : exchange ] , recall that a mn atom is surrounded by 4 only ni atoms but by 12 mn atoms at distance @xmath180 and 6 mn atoms at distance @xmath243 , where the exchange coupling is still appreciable . the ni susceptibility",
    ", @xmath203 shows a large plateau below @xmath1  and follows the critical peak of mn at @xmath1  rather weakly .",
    "the behavior of the mn magnetization and susceptibility , on the other hand , is characteristic of a ferromagnetic phase transition .    in fig .",
    "[ fig : renorm2]b we see results within the extended model . here",
    ", the ni magnetization follows the behavior of mn .",
    "the susceptibility @xmath203 starts off at a finite value at @xmath144 , which coincides with the value given by eq .",
    "[ eq : l1c ] , in contrast to the vanishing susceptibility at @xmath144 for rigid - moment systems . at @xmath1",
    "the ni susceptibility shows a peak following the critical behavior .",
    "the ni magnetization and susceptibility have been scaled up by appropriate factors to show that eqs.([eq : l13 ] ) and ( [ eq : l16 ] ) are reproduced by the monte carlo simulation . a technical point to be mentioned for accuracy",
    "is that , in calculating @xmath242 and @xmath244 in the simulation one should take the projection of @xmath245 in the direction of the total moment at each monte carlo step , instead of making the approximation to calculate the average and variance of @xmath246 .",
    "it is also interesting to see that the average magnitude of the local ni moment ( dotted line ) increases monotonically with temperature .",
    "this effect , pointed out by sandratskii@xcite in an analytical low - temperature approximation for nimnsb , is connected to the fact that even above @xmath1  there is some short - range order in the system , so that the equilibrium value of @xmath247 is non - vanishing . on top of this ,",
    "the fluctuations of @xmath121 shift the value of @xmath248 to higher values .",
    "the increase is expected to cease when @xmath64 reaches such high values that the approximation @xmath134 is no more valid ( so that the fluctuations are moderated by the fourth - order term ) ; this correction does not apply for nimnsb , however , at least at temperatures as high as @xmath1 , since the constrained - dft calculation shown in fig .",
    "[ fig : energy_moment_angle ] ( top panel ) yields a quadratic energy dependence at values of @xmath64 comparable to the ones close to @xmath1  in fig .",
    "[ fig : renorm2]b .",
    "experimentally , the temperature dependent magnetization of nimnsb follows bloch s @xmath249 law up to about 70 - 100  k,@xcite which can not be reproduced within classical heisenberg models .",
    "element ( or sublattice ) specific experiments were done using neutron scattering@xcite and x - ray magnetic circular dichroism ( xmcd).@xcite neutron scattering @xcite at 15  k and 260  k shows a thermally stable ni moment @xmath250 , but a decreasing mn moment ( dropping from @xmath251 at 15  k to @xmath252 at 260  k ) .",
    "contrary to this , according to the xmcd results of ref .",
    "[ ] _ both _ the ni and mn moments drop rapidly at 80  k to half their ground - state values , and then level off up to at least 250  k. such behavior would be counter - intuitive ; the authors in [ ] write that surface effects possibly complicate the interpretation of mcd data .",
    "recently , wysocki , glasbrenner and belashchenko@xcite ( wgb ) presented a study of a classical spin - fluctuation model .",
    "their model hamiltonian is similar to the one that we use here , with the difference that in the wgb paper all atoms can change the magnitude of their moments , the 4th - order term is not neglected , and in practice only one atomic species is considered in their calculations .",
    "wgb point out that the magnetic moments are not canonical variables , therefore there is no obvious way how to choose the phase space measure , which should therefore be given as part of the model together with the hamiltonian . in the present work we have chosen what they call uniform phase space measure , which basically amounts to dividing the @xmath121-space in equal - volume infinitesimal cells with equal integration weight , and which is the most common choice in the literature.@xcite it also amounts to taking a simple @xmath253 integration with no further weight in eqs .",
    "( [ eq : l11a],[eq : l12a],[eq : l18 ] ) .",
    "different choices of measure can lead to qualitatively different results , e.g. a fast drop of magnetization in the weakly - magnetic sublattice , as also shown by sandratskii,@xcite or even a first - order transition , as wgb find.@xcite the correct measure can only be certified by the best classical approximation to the full quantum - mechanical solution , which , however , remains an open problem . however",
    ", if it is assumed that the correct measure is not uniform but e.g. proportional to @xmath254 ( this was one alternative choise by wgb ) , then the weak - sublattice magnetization will drop fast at low temperatures , so that close to @xmath1  only the bare parameters of the strong sublattice would be relevant .",
    "mryasov et al.@xcite have discussed the idea of renormalized interactions in the case of fept alloys .",
    "related is also the work by polesya _",
    "et al._@xcite who adopt a model for fepd and copt alloys . in these works ,",
    "the weak moments of pd or pt are determined from the strong moments of their neighbors via the susceptibility . however , even at higher temperatures the weak moments are not treated as independent variables that can fluctuate ( either in direction or in length ) but rather as enslaved quantities to their immediate neighbourhood i.e. , their role in the thermodynamics is only to mediate an additional interaction between the strong moments .",
    "our idea of renormalization has an analogous starting point but goes along a different path , since we consider the weak moments in the spin hamiltonian as independent fluctuating variables .",
    "in addition , the main novelty of the present study in this respect is the formal and numerical proof of the equivalence of two approaches : all thermodynamic quantities can be derived by using either the extended model with bare interactions or the traditional model with renormalized interactions . furthermore it is shown in the present study that the renormalized intercations are actually the ones that are harvested by the spin - spiral approach within density - functional calculations with no further manipulations ; however , manipulations are necessary if one wishes to extract the bare parameters .",
    "the present result holds    under the assumption of a uniform phase space measure and of a quadratic on - site energy .",
    "the latter seems to hold true e.g. for nimnsb and for fept,@xcite but not , for example , in the case of ferh@xcite where higher - order corrections are necessary . in case",
    "that either of these two requirements is not met , most probably a hypothesis of temperature - independent renormalized interactions can not be justified on the grounds of fluctuating weak moments , but should instead be conjectured as an ad - hoc hypothesis within the model .",
    "bruno@xcite also introduces a concept of renormalized exchange parameters",
    ". however , his approach encapsulates different physics than our present approach .",
    "bruno s renormalization corrects for a systematic error , mainly due to the difference of the constraining - field direction to the resulting moment direction when the force theorem is applied .",
    "our renormalization on the other hand concerns the error due to the reduction of the weak - moment magnitude when the strong moments are tilted .",
    "yet another concept of renormalization is described by lounis and dederichs.@xcite using a multiple - scattering approach , they consider the energy expansion as a function of the angles between moments . as they find , at high angles corrections are necessary to the phenomenological hamiltonian ( e.g. , biquadratic or four - spin terms ) . however , at low angles these corrections can be partly included in the heisenberg model via a renormalization of the exchange parameters , recovering correct energy scales and curie temperatures .",
    "the curie temperatures calculated within the mainstream approach to the adiabatic spin - dynamics are in many cases in agreement with experiment to within 10 - 15% , but with no obvious systematics toward over- or underestimation .",
    "the main source of error is not clear . considering the most serious approximations made , error can stem from    * \\(i ) the use of local density functional theory ( lda or gga ) for total energy calculations without further corrections for electron exchange and correlation . *",
    "\\(ii ) the use of the adiabatic approximation , * \\(iii ) the assumption of a classical , rather than quantum , heisenberg model , * \\(iv ) the assumption that the exchange constants do not change as a function of temperature , * \\(v ) the assumption of rigid spins of the strong moments in the heisenberg model .    in general , these factors have possibly different weight for different materials . concerning point ( i ) , theories that provide a better treatment of correlations exist , e.g. , the lsda+@xmath255 or lsda combined with dynamical mean field theory at zero or finite temperatures . also within such theories",
    "exchange parameters can be derived ( see , e.g. , ref .  ) .",
    "however , parameters are required ( as is the coulomb repulsion @xmath255 ) , and it is usually not obvious how to determine these uniquely .    as for point ( ii )",
    ", there are promising developments in the calculation of magnon spectra ( including magnon lifetime effects ) within time - dependent density functional theory  @xcite or many - body perturbation theory  @xcite .",
    "these can prove very useful in the future ( they can also be extended to finite temperatures ) , however at this point they are computationally too demanding for systematic calculations of the curie temperature .",
    "point ( iii ) ( the classical assumption ) , can be improved upon by using the random phase approximation to solve the quantum heisenberg model . however , for itinerant electron systems the local moment @xmath148 does not corespond to some integer or half - integer value of the spin @xmath23 either in the form @xmath256 or in the form @xmath22 .",
    "in fact , calculations of heusler compounds in ref .",
    "[ ] have shown that for a reasonable choice of @xmath23 the curie temperature is strongly overestimated , while the classical limit of the random phase approximation , with a choice of large @xmath23 ( with appropriate normalization of the exchange parameters so that the product @xmath257 remains constant ) , results in reasonable values of @xmath1 .",
    "therefore , a quantum heisenberg model is perhaps a better for a correct description of the shape of the magnetization curve @xmath258 , but a poor choice for a correct @xmath1 , at least in itinerant electron systems , if the exchange constants are calculated within the adiabatic approximation .",
    "this conclusion is in accordance to the spirit of adiabatic spin dynamcics,@xcite where the effective interactions @xmath259 correspond to the equation of motion of the expectation value of the local moments , i.e. , to classical quantities , not operators .",
    "corrections to point ( iv ) can be treated within local density functional theory if the exchange constants are calculated starting from a disordered local moment state .",
    "this requires use of the coherent - potential approximation ( cpa ) , and has been proposed for example in ref .",
    "the use of the cpa for the description of the disordered local moment state at @xmath1underestimates the existence of magnetic short range order ( which is known to be present ) ; however , it constitutes a promissing approach , since it can be systematically improved e.g. by the use of a non - local cpa.@xcite    finally , point ( v ) becomes a serious approximation in systems of weak magnetic moments , such as ferromagnetic ni , and has been widely discussed in the literature as we noted in sec .",
    "[ sec : longitudinal ] .",
    "corresponding corrections for multiple - scattering based methods have been recently proposed , e.g. , by bruno@xcite and shallcross and co - workers.@xcite in a more recent work by ruban _",
    "et al._,@xcite based on an expansion of the energy within the disordered local moment state , promising results were obtained showing the fundamental importance of longitudinal corrections to the local moment for @xmath1  in ferromagnetic ni .",
    "in the first part of this work we have investigated the calculation of interatomic exchange constants that we implemented in the flapw method based on the concept of adiabatic spin dynamics .",
    "the exchange constants are harvested by an inverse fourier transformation involving static spin - spiral energies .",
    "@xcite symmetry relations obeyed by the spin spiral energies have been found to greatly reduce the numerical effort , in particular regarding confinement of the inverse fourier transformation in the irreducible wedge of the brillouin zone .",
    "furthermore , the force - theorem approximation has been tested and found to be adequate for small cone angles of the spin spirals .",
    "however , we have shown that application of the force theorem requires special treatment of the intersitial region , namely setting there the magnetic part of the exchange - correlation field to zero .    in the second part of the present work we have proposed a way to explore multicomponent systems where a magnetically strong sublattice coexists with a magnetically weak sublattice , necessiating a consideration of longitudinal and transverse changes of the weak local magnetic moments while they are still treated as independent variables .",
    "we find the rigorous result that , under the frequently met condition of a parabolic dependence of the energy on the weak - moment magnitude , the weak moments and their interactions can be eliminated via an analytical integration of the partition function in favour of the strong moments with renormalized , temperature - independent exchange constants , with the renormalization accounting for the weak - moment fluctuations at non - zero temperatures .",
    "we also show that the renormalized constants are actually the ones probed by constrained spin - spiral calculations of the strong - moment subsystem , thus simplifying calculations .",
    "finally we show that the thermodynamic correlation functions of the full system including the strong and weak moments can be derived as polynomials of the correlation functions of the system of strong moments only but with renormalized interactions .",
    "this renormalization will affect various quantities such as temperature - dependent magnetization , susceptibility , or spin - stiffness constant .",
    "the method can prove useful for systems comprising @xmath260 atoms with strong moments together with @xmath261 or @xmath262 atoms with weak moments , such as transition - metal alloys , heusler alloys or @xmath260 overlayers deposited on @xmath261 or @xmath262 metal surfaces .",
    "the authors would like to thank leonid sandratskii and kyrill belashchenko for enlightening discussions .",
    "this work was supported from funds by the ec sixth framework programme as part of the european science foundation eurocores programme sons under contract n. eras - ct-2003 - 980409 , and by the young investigators group programme of the helmholtz association , contract vh - ng-409 .",
    "we gratefully acknowledge sypport by the jlich supercomputing centre .",
    "we provide a derivation of a formula concerning the renormalization of interactions @xmath263 of the strong - moment subsystem , @xmath264 when it is in contact with a weak - moment subsystem , @xmath265 , in the presence of interactions @xmath266 among the moments of the weak subsystem .",
    "the main complication in the presence of @xmath267 for @xmath268 is that the strong moments are interacting with a system of coupled harmonic terms , instead of independent harmonic terms which were treated in sec .",
    "[ sec : longitudinal ] .",
    "in particular we adopt the following conventions .",
    "the hamiltonian reads @xmath269 where the strong - system , weak - system and interacting parts are respectively : @xmath270 in eq .",
    "( [ eq : a2b ] ) , the diagonal part @xmath271 is the quadratic on - site energy term while the off - diagonal terms @xmath266 describe intersite interactions between the weak moments.@xcite in case of ferromagnetic coupling it is expected that @xmath272 for @xmath268 ( but with the determinant @xmath273 ) .",
    "the strategy is to eliminate the weak moments by integrating analytically the weak plus intercting part of the partition function , ending up with renormalized interactions of the strong moments . to this end",
    "we take advantage of the identity @xmath274 \\\\",
    "= \\frac{\\pi^{n/2}}{\\sqrt{\\det c } } \\exp\\left[\\sum_{\\lambda\\lambda'}(c^{-1})_{\\lambda\\lambda'}b_{\\lambda } b_{\\lambda'}\\right ] \\end{split } \\label{eq : a3}\\ ] ] where @xmath275 is the determinant of the positive - definite matrix @xmath276 .",
    "it is convenient to use a combined index @xmath277 with @xmath278 and define @xmath279 and @xmath280",
    ". then @xmath281 .",
    "applying this to the partition function @xmath282 yields    @xmath283 \\exp\\left[-\\frac{1}{k_bt}\\left(\\frac{\\kappa}{2a}\\right)^2\\sum_{ll'}(a^{-1})_{ll ' }    \\sum_{n(l)}\\sum_{n(l')}{\\ensuremath{\\boldsymbol{m}}}_n\\cdot{\\ensuremath{\\boldsymbol{m}}}_{n'}\\right ] \\\\ \\label{eq : a4.2 } & = & \\frac{(\\pi k_bt)^{3n_{\\rm w}/2}}{(\\det a)^{3/2 } } \\int d\\omega_1\\cdots d\\omega_{n_{\\rm s } } \\exp\\left[-\\frac{1}{k_bt}\\mathcal{h}_r\\right ] \\label{eq : a5}\\end{aligned}\\ ] ]      this reduces to @xmath185 of eq .",
    "( [ eq : l10 ] ) if @xmath285 . expression ( [ eq : a6 ] ) is obviously of the traditional heisenberg type , but a further reduction to a form with renormalized parameters , @xmath286 requires knowledge of the specific geometry of each problem taking into account the sums over neighbours of @xmath137 and @xmath287 , @xmath288 and @xmath289 .    thermal averages @xmath290 can be calculated by @xmath291 \\end{split } \\label{eq : a7}\\ ] ] thus the factor @xmath292 cancels and the determinant @xmath293 need not be calculated .",
    "thus one ends up with a usual heisenberg - model treatment . to gain some more insight",
    ", one can recognize that in the presence of non - diagonal @xmath266 we have , formally , a system of coupled harmonic oscillators interacting with the strong moments . the normal modes of the coupled oscillators are itinerant , and therefore the renormalized interactions are also long - ranged . even if @xmath266 are short ranged , making the matrix @xmath294 sparse , eq .",
    "( [ eq : a6 ] ) shows that the renormalized interactions involve the matrix @xmath295 , which is normally not sparse .    to complete the circle , it has to be shown for practical applications that the renormalized interactions appearing in eq .",
    "( [ eq : a6 ] ) are the quantities that are probed by a dft calculation where the directions of the strong moments are constrained .",
    "in other words , in such a dft calculation the weak moments are allowed to relax to their equilibrium values under the directional constraint on the strong moments .",
    "the question is , if then the energy dependence ( [ eq : a6 ] ) is recovered , assuming that eqs .",
    "( [ eq : a2a]-[eq : a2c ] ) are a good approximation to the dft energy landscape .",
    "the answer is straightforward if we calculate the total energy of the constrained heisenberg hamiltonian , i.e. , without an integration over the @xmath139 .",
    "the constrained partition function is just the last term of eq .",
    "( [ eq : a4.1 ] ) , @xmath296 .",
    "the total energy at @xmath297 is @xmath298 _ q.e.d .",
    "_ this means that constrained ( spin spiral ) dft calculations on the strong sublattice are already corresponding to the renormalized hamiltonian and are therefore by virtue of eqs .",
    "( [ eq : a4.1],[eq : a5 ] ) sufficient for the calculation of the strong - sublattice thermal averages , without the need to calculate the bare parameters or @xmath266 .",
    "however , if the weak - sublattice thermal averages are to be calculated , one must additionally gain knowledge on the matrix @xmath266 of eq .",
    "( [ eq : a2b ] ) as well as of the bare parameters @xmath299 of eq .",
    "( [ eq : a2b ] ) and of @xmath125 in eq .",
    "( [ eq : a2c ] ) . the scheme presented in sec .",
    "[ subsec : general ] shows how this can be done in the rather simple case of nimnsb ( where @xmath285 is diagonal ) , but in general this problem must be solved according to the geometry and other factors in each case . in particular for the calculation of the off - diagonal @xmath266 , probably it is easiest to calculate directly the susceptibility matrix @xmath300 by applying in the dft calculation a longitudinal external field on one atom and probing the response in the moment of the neighboring atoms , or to make a transformation to the normal modes in fourier space and calculate @xmath301 .",
    "if all the ingredients are available , then one can calculate thermal averages and correlation functions of the weak moments either by a direct monte - carlo calculation , or by reducing these correlation functions to correlations of the strong moments in the presence of only the renormalized hamiltonian , in an analogous way to the case of eq .",
    "( [ eq : l18 ] ) , where the parameters @xmath266 and @xmath125 must be inevitably contained in the expansion coefficients .",
    "we present an outline of how this is achieved in practice .",
    "the complication here compared to eq .",
    "( [ eq : l18 ] ) is that the matrix @xmath266 is not diagonal .",
    "it is , however , real and symmetric , therefore one proceeds by bringing it to a diagonal form @xmath302 with elements @xmath303 . if @xmath304 is the diagonalization matrix , then @xmath305 , and we define the transformation of the moment - coordinates @xmath306 and @xmath307 .",
    "also since @xmath266 is real and symmetric the phase - space element is unchanged : @xmath308 .",
    "( this transformation is analogous to one bringing a system of coupled harmonic oscillators in a normal - mode representation . )",
    "then one has , for the arbitrary correlation function among the @xmath309-components of the @xmath310 weak moments , @xmath311 , the following integral :    @xmath312\\right\\ } \\\\ = \\int d^3\\tilde{\\mu}_1 \\cdots d^3\\tilde{\\mu}_{n_{\\rm w } } ( \\sum_k r^{t}_{1k}\\tilde{\\mu}_{kx})^{m_{1x}}\\cdots(\\sum_k r^{t}_{n_{\\rm w}k}\\tilde{\\mu}_{k_wz})^{m_{n_{\\rm w}z } }   \\exp\\left\\{\\frac{1}{k_bt}\\left[-\\sum_{l\\alpha}d_{l}\\tilde{\\mu}_{l\\alpha}^2 +    \\frac{\\kappa}{2a}\\sum_{l\\alpha}\\sum_{n(l ) }    \\tilde{m}_{n\\alpha}\\tilde{\\mu}_{l\\alpha}\\right]\\right\\ }   \\\\",
    "= \\prod_{l\\alpha}\\int d^3\\tilde{\\mu}_{l\\alpha } ( \\sum_k r^{t}_{lk}\\tilde{\\mu}_{k\\alpha})^{m_{l\\alpha } } \\exp\\left\\{\\frac{1}{k_bt}\\left[- d_{l}(\\tilde{\\mu}_{l\\alpha } -      \\frac{1}{d_l }   \\frac{\\kappa}{2a }   \\sum_{n(l ) } \\tilde{m}_{n\\alpha }      ) ^2 - \\frac{1}{4d_l } ( \\frac{\\kappa}{2a }   \\sum_{n(l ) } \\tilde{m}_{n\\alpha})^2 \\right]\\right\\}.\\end{aligned}\\ ] ]    the last expression can be handled by expanding the term @xmath313 and proceeding to an analytic integration of powers of @xmath314 times the exponential just as in eq .",
    "( [ eq : l18 ] ) .",
    "mixed correlation functions between strong and weak moments can also be reduced to strong - moment correlation functions in the renormalized model via this prescribed route .",
    "e. aiolu , l.m .",
    "sandratskii , p. bruno , and i. galanakis , phys .",
    "b * 72 * , 184415 ( 2005 ) .",
    "k. sato , w. schweika , p. h. dederichs , h. katayama - yoshida , phys .",
    "b * 70 * , 201202(r ) ( 2004 ) .",
    "l. bergqvist , o. eriksson , j. kudrnovsk , v. drchal , p. korzhavyi , and i. turek , phys .",
    "93 * , 137202 ( 2004 ) .",
    "p. h. dederichs , s. blgel , r. zeller , and h. akai , phys .",
    "lett . * 53 * , 2512 ( 1984 ) . b. l. gyorffy , a. j. pindor , j. staunton , g. m. stocks , and h. winter , j. phys .",
    "* 15 * , 1337 ( 1985 ) .",
    "l. m. small and v. heine , j. phys .",
    "* 14 * , 3041 ( 1984 ) .",
    "v. p. antropov , m. i. katsnelson , b. n. harmon , m. van schilfgaarde , and d. kusnezov , phys .",
    "b * 54 * , 1019 ( 1996 ) .",
    "s. v. halilov , h. eschrig , a. y. perlov , and p. m. oppeneer , phys .",
    "b * 58 * , 293 ( 1998 ) .",
    "sandratskii and p. bruno , phys . rev .",
    "b * 66 * , 134435 ( 2002 ) .",
    "j. kbler , j. phys . : condens .",
    "matter * 18 * , 9795 ( 2006 ) .",
    "e. wimmer , h. krakauer , m. weinert , and a. j. freeman phys .",
    "b * 24 * , 864 ( 1981 ) .",
    "the implementation was done in the fleur code , see http://www.flapw.de .",
    "w. nolting , phys .",
    "( b ) * 96 * , 11 ( 1979 ) .",
    "kurz , f. frster , l. nordstrm , g. bihlmayer , and s. blgel phys .",
    "b * 69 * , 024415 ( 2004 ) . c. e. shannon , proc . inst .",
    "radio engineers * 37 * , 10 ( 1949 ) .",
    "d. m. bylander and l. kleinman , phys .",
    "b * 58 * , 9207 ( 1998 ) .",
    "we used the parametrization by j. p. perdew , k. burke , and m. ernzerhof , phys .",
    "77 * , 3865 ( 1996 ) .",
    "we used the spr - tb - kkr package , h. ebert and r. zeller , [ http://olymp.cup.uni-muenchen.de/ak/ebert/spr-tb-kkr ] , within the gga .",
    "we took an angular momentum cutoff at @xmath315 for co but @xmath316 for co@xmath0mnsi for an accurate reproduction of the half - metallic gap .",
    "p. j. webster and k. r. a. ziebeck , in _ alloys and compounds of d - elements with main group elements .",
    "_ , edited by h. p.",
    "j. wijn , landolt - brnstein , new series , group iii , vol .",
    "c ( springer - verlag , berlin , 1988 ) , pp .",
    "75 - 184 .",
    "l. m. sandratskii , r. singer , and e. aiolu , phys .",
    "b 76 , 184406 ( 2007 ) .",
    "m. e. gruner , e. hoffmann , and p. entel , phys .",
    "b * 67 * , 064415 ( 2003 ) .",
    "l. sandratskii and p. mavropoulos , phys .",
    "b * 83 * , 174408 ( 2011 ) .",
    "it is known that in the thermodynamic limit and below @xmath1  the static longitudinal susceptibility of the classical heisenberg ferromagnet at small applied fields @xmath317 behaves as @xmath318 , diverging at @xmath319 . in monte carlo simulations",
    "this divergence is masked by the finite size of the simulation supercell .",
    "see , e.g. , eq .  26 in h. mller - krumbhaar , z. physik * 267 * , 261 ( 1974 ) .    c. hordequin , j. pierre , and r. currat , j. magn .",
    "162 , 75 ( 1996 ) .",
    "l. ritchie , g. xiao , y. ji , t. y. chen , c. l. chien , m. zhang , j. chen , z. liu , g. wu , and x. x. zhang , phys .",
    "b * 68 * , 104430 ( 2003 ) . ch .",
    "hordequin , e. lelievre - berna , and j. pierre , physica ( amsterdam ) * 234 - 236 * , 602 ( 1997 ) .",
    "wysocki , j.k .",
    "glasbrenner , and k.d .",
    "belashchenko , phys .",
    "b * 78 * , 184419 ( 2008 ) .",
    "unfortunately , this was not taken correctly in ref .  , resulting in a strong drop of the calculated ni moment and a peak of the ni sublattice susceptibility at 50  k.                  d. a. rowlands , j. b. staunton , and b. l. gyrffy , phys .",
    "b * 67 * , 115109 ( 2003 ) . eq .",
    "( [ eq : a2b ] ) is a special case of the hamiltonian used by wgb@xcite who additionally considered fourth - order terms for the study of longitudinal fluctuations .",
    "the wgb hamiltonian is similar to the one used by murata and doniach,@xcite but with the difference that murata and doniach consider a continuum model instead of a lattice model and a scalar instead of vector magnetization .",
    "contrary to the continuum version of murata and doniach that shows ultraviolet divergencies,@xcite lattice hamiltonians used by wgb and in eq .",
    "( [ eq : a2b ] ) have a natural wavelength cutoff , thus the thermal sums contain no divergencies ."
  ],
  "abstract_text": [
    "<S> we explore the derivation of interatomic exchange interactions in ferromagnets within density - functional theory ( dft ) and the mapping of dft results onto a spin hamiltonian . </S>",
    "<S> we delve into the problem of systems comprising atoms with strong spontaneous moments together with atoms with weak induced moments . </S>",
    "<S> all moments are considered as degrees of freedom , with the strong moments thermally fluctuating only in angle and the weak moments thermally fluctuating in angle and magnitude . </S>",
    "<S> we argue that a quadratic dependence of the energy on the weak local moments magnitude , which is a good approximation in many cases , allows for an elimination of the weak - moment degrees of freedom from the thermodynamic expressions in favor of a renormalization of the heisenberg interactions among the strong moments . </S>",
    "<S> we show that the renormalization is valid at all temperatures accounting for the thermal fluctuations and resulting in temperature - independent renormalized interactions . </S>",
    "<S> these are shown to be the ones directly derived from total - energy dft calculations by constraining the strong - moment directions , as is done e.g.  in spin - spiral methods . </S>",
    "<S> we furthermore prove that within this framework the thermodynamics of the weak - moment subsystem , and in particular all correlation functions , can be derived as polynomials of the correlation functions of the strong - moment subsystem with coefficients that depend on the spin susceptibility and that can be calculated within dft . </S>",
    "<S> these conclusions are rigorous under certain physical assumptions on the measure in the magnetic phase space . </S>",
    "<S> we implement the scheme in the full - potential linearized augmented plane wave ( flapw ) method using the concept of spin - spiral states , considering applicable symmetry relations and the use of the magnetic force theorem . </S>",
    "<S> our analytical results are corroborated by numerical calculations employing dft and a monte carlo method . </S>"
  ]
}