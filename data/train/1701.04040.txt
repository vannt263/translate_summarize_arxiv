{
  "article_text": [
    "in the statistical physics literature of the last decades a growing attention has been devoted to the study of the inverse problem@xcite .",
    "this amounts to study how to infer the parameters of a model starting from the observation of real data .",
    "in particular , the application of the inverse ising model , although known for a long time as boltzmann machine learning@xcite , has aroused interest in recent years in many different fields ( physics@xcite , neuroscience@xcite , biology@xcite , social and health sciences@xcite ) , especially since the advent of the big - data age . in these applications , stemming from the assumption that the real world system of interest is described by an ising model with hamiltonian @xmath0 ,",
    "the inverse problem amounts to fit @xmath0 to the system , i.e. to calculate the parameters of the underlying @xmath0 from experimentally measured expectation values .",
    "in this paper we consider the inverse problem for the curie - weiss model and for its multi - species version@xcite .",
    "these models , among all the possible choices , have the advantage of being very simple and thus of allowing for analytical computations , but still sufficiently general to represent a wide range of interesting phenomena .",
    "in fact , recent studies has shown that such models provide surprisingly accurate descriptions of real world phenomena@xcite .",
    "the curie - weiss hamiltonian depends on the coupling parameter and the external magnetic field that can be efficiently inferred , in the uniqueness region of the model , from the estimates of the magnetization and the susceptibility obtained by a sample of spin configurations , as shown in ref .",
    "@xcite . here",
    "we take a step forward by considering how to solve the inverse problem when the consistency equation has more than one solution .",
    "the presence of many states in the phase space can occur , for example , when the system undergoes a phase transition .",
    "in this case , the clustered structure of the sampled input configurations may produce bad coupling parameter inference .",
    "in fact , in ferromagnetic systems below the ferromagnetic transition the configurations are grouped in two clusters of positive and negative magnetization .",
    "we show that coupling parameters can be well inferred also in the low temperature phase in two ways : either globally by applying the inverse problem procedure to the whole set of the input configurations after changing the sign of the magnetizations from positive to negative ( or viceversa ) or locally , by clustering the configurations and then applying the algorithm separately to data in each cluster . while this last method , known in literature as clustering algorithm@xcite , is general and",
    "can be used with different models that exhibits multiple states , the sign flip is suitable only for models with couples of symmetric solutions . in a recent study@xcite",
    ", the clustering algorithm has been used to solve the inverse problem for the model of interacting monomer - dimers on the complete graph , whose solutions are not symmetric in the coexistence phase .",
    "the parameter estimates are very accurate and in good agreement in both ways , although the clustering algorithm has higher computational cost .    following the methods used in ref .",
    "@xcite , we validate the inversion procedure that we propose here , by sampling a set of spin configurations from the equilibrium distribution of the model , and by reconstructing the underlying parameters from a large number of such samples .",
    "when dealing with real phenomenological data the solution of the inverse problem requires first to provide the explicit expression of the model free parameters with respect to the macroscopic thermodynamic variables and then to evaluate these macroscopic variables starting from the the data .",
    "the first step is obtained considering the consistence equation of the model@xcite , the second one with the maximum likelihood estimation procedure@xcite .",
    "finally , we show that if the system is critical , the analytical inversion formulas do not apply and the parameter estimation fails .",
    "the curie - weiss model for a system of @xmath1 spin particles is defined by the hamiltonian : @xmath2 where @xmath3 is the spin of the @xmath4-th particle , @xmath5 is the coupling constant and @xmath6 is the magnetic field .",
    "the probability of a configuration of spins @xmath7 is given by the boltzmann - gibbs measure : @xmath8 where @xmath9 is the inverse temperature .",
    "the main observable of the model is the total magnetization , obtained by computing the arithmetic mean of the spins : @xmath10 the behavior of @xmath11 in the limit of an infinite number of particles is fully described by the stable solutions of the consistence equation@xcite : @xmath12 in particular , the average value of @xmath11 with respect to the boltzmann - gibbs measure , @xmath13 , is equal , in the thermodynamical limit , to the mean of such stable solutions . when the magnetic field is absent the number of stable solutions depends on the product between the coupling constant and the inverse temperature . for @xmath14",
    "the consistence equation admits a unique solution , stable , in the origin ; for @xmath15 the origin becomes unstable while other two stable solutions @xmath16 arise . in both cases",
    "@xmath13 is equal to zero in the limit @xmath17 .",
    "when the field is different from zero the consistence equation admits always a unique stable solution with the same sign of the field .",
    "such a solution is not always the only possible one ; in fact , eq .  ( [ eqcons ] ) allows also the presence of a metastable solution and of an unstable solution . with the exception of the case of @xmath18 and @xmath19 ,",
    "we can write the model parameters as follows : @xmath20 where @xmath21 is a stable solution of ( [ eqcons ] ) and @xmath22 is the susceptibility of the system . when @xmath18 and @xmath19 , eq .",
    "( [ jterm ] ) and ( [ hterm ] ) become meaningless because the susceptibility grows to infinity .",
    "this critical case is analyzed in detail in section [ cwcriticosec ] . in the following , for the sake of simplicity ,",
    "we consider the inversion temperature @xmath9 absorbed within the model parameters .",
    "this is analogous to fix its value equal to @xmath23 .",
    "we mentioned above that as @xmath21 is a unique stable solution of the consistence equation , @xmath13 tends to such a value as @xmath1 grows to infinite . in this case , @xmath24 represents the infinite volume limit of the product between the variance of the total magnetization , @xmath25 , and the number of spins @xmath1 .",
    "therefore , by estimating these macroscopic quantities from the data and using identities ( [ jterm ] ) and ( [ hterm ] ) , we can infer the values of the model parameters . in the following ,",
    "we call finite size magnetization @xmath26 and finite size susceptibility @xmath27 when there are two stable solutions of ( [ eqcons ] ) , @xmath28 is equal to zero by symmetry . as a consequence ,",
    "its estimation from the data does not allow us to compute the true model parameters . in section [ 2stablesol ]",
    "we show how it is possible to solve the inverse problem also in this case .    in the case of a unique stable solution of ( [ eqcons ] ) , in order to estimate the parameters , we need a sample of @xmath29 independent spin configurations , @xmath30 , distributed according to ( [ bg.curie ] ) . starting from the total magnetization @xmath31 of each spin configuration",
    ", we use the maximum likelihood procedure to compute the estimators of @xmath28 and @xmath32 , as follows : @xmath33 this method determines the free parameters of the distribution , by imposing that their values maximize the probability to obtain the given sample of spin configurations .",
    "eventually , by combining ( [ mexpchiexp ] ) with ( [ jterm ] ) and ( [ hterm ] ) we obtain the free parameter estimators : @xmath34    as a general remark , note that the parameter estimation involves two kinds of approximations : one in the inverse problem formulas ( [ jterm ] ) and ( [ hterm ] ) , that require @xmath21 and @xmath24 , i.e. the infinite volume limit of @xmath28 and @xmath32 , the other in the statistical evaluation of @xmath28 and @xmath32 through @xmath35 and @xmath36 with the maximum likelihood estimation procedure given in ( [ mexpchiexp ] ) . the accuracy of the first approximation increases with @xmath1 , that of the second one with @xmath29 .",
    "the evidence of these two facts together with the numerical thresholds for the choices of @xmath1 and @xmath29 for the curie - weiss model were deeply investigated in ref .",
    "@xcite with some numerical tests .",
    "when the solution of ( [ eqcons ] ) is no more unique , the inversion procedure presented above is no longer suitable , as it will be clear in what follows .",
    "therefore , we need to consider alternative algorithms to address and solve the problem . in the next sections , we present numerical tests in order to validate the inversion procedure both for the case when the phase space presents only one state and when the system undergoes a phase transition .",
    "the aim of this work is to show the robustness of the inverse problem for experiments with real world datasets ; thus we fix @xmath37 and consider @xmath38 $ ] .",
    "this choice for the sizes of the sample @xmath29 and of the system @xmath1 is an acceptable compromise between the requirement of stabilizing the estimators and the simulation of a realistic experimental dataset .    from the numerical point of view ,",
    "fixed the values of the system size @xmath1 and of the parameters @xmath39 and @xmath6 , we extract each configuration from a virtually exact simulation of the equilibrium distribution ( [ bg.curie ] ) .",
    "in fact , due to the mean field nature of the model , the boltzmann - gibbs distribution of the total magnetization @xmath40 can be computed by evaluating the combinatorial weights @xmath41 of its possible values @xmath42 as : @xmath43 where @xmath44 gives the number of spin configurations that share the same value @xmath21 of the total magnetization .",
    "we use the probability distribution obtained in this way to extract large samples of magnetizations that will be used in ( [ mexpchiexp ] ) to compute @xmath35 and @xmath36 .    moreover , in order to assess the statistical dependence of the estimators on the sample @xmath45 we consider @xmath46 independent instances of such a sample , we apply the maximum likelihood estimation to each of them independently and then we average over the @xmath46 inferred values . in what follows we use the subscript @xmath47 to denote the estimators ( i.e. @xmath35 , @xmath36 , @xmath48 and @xmath49 ) and the bar symbol ( @xmath50 , @xmath51 , @xmath52 and @xmath53 ) for their statistical mean over the @xmath46 @xmath29-samples .",
    "we find numerical evidence@xcite that it suffices @xmath54 in order to obtain acceptable parameter estimations .",
    "taking into account the description of the number of solutions of eq .",
    "( [ eqcons ] ) given in section [ cwsec ] , in what follows we test numerically the inverse problem for all the different possible cases .",
    "let us start considering a couple of parameters @xmath55 for which there is only one solution @xmath56 $ ] of eq .",
    "( [ eqcons ] ) . in this case",
    "the boltzmann - gibbs distribution of the total magnetization @xmath40 presents a unique peak centered around the solution @xmath57 , as shown in fig .",
    "[ fig1 ] for the case @xmath58 and @xmath59 , where @xmath60 .",
    "as @xmath1 increases , the peak shrinks towards the value of the solution , meaning that its estimation through the finite size magnetization @xmath28 becomes more and more accurate .",
    "boltzmann - gibbs distribution of the total magnetization @xmath40 for @xmath58 , @xmath59 and different values of the number of spins @xmath1 .",
    "the distribution is given by the blue dashed line for @xmath61 , by the red dot - dashed line for @xmath62 and by the green continuous line for @xmath63 .",
    "the peak of the distribution is centered around the solution @xmath60 of the consistency equation ( [ eqcons]).,scaledwidth=70.0% ]    for this case , the estimations of @xmath48 and @xmath49 are plotted in fig .",
    "[ fig2 ] as functions of @xmath64 $ ] .",
    "note that the inferred values of @xmath52 and @xmath53 are in optimal agreement with the exact values of the parameters ( continuous lines in fig .",
    "[ fig2 ] ) , even when the size @xmath1 of the system is very small . moreover , the error bars obtained with the standard deviation on the @xmath46 different @xmath29-samples of configurations of the same system are comparable for all the considered values of @xmath1 .",
    "@xmath52 ( upper panel ) and @xmath53 ( lower panel ) as a function of @xmath1 for @xmath58 , @xmath59 and @xmath37 .",
    "error bars are standard deviations on @xmath46 different @xmath29-samples of configurations of the same system ( see text for the details of the simulation ) .",
    "the horizontal lines correspond to the exact values of @xmath58 ( upper panel ) and @xmath59 ( lower panel).,scaledwidth=70.0% ]    fig .",
    "[ figerrcrej ] shows the parameter estimation as a function of the interacting parameter @xmath39 for a fixed nonzero value of the magnetic field .",
    "observe that the reconstruction is good also for @xmath65 , but the error bars increase greatly because the interaction between particles is growing .",
    "@xmath52 ( left panel ) and @xmath53 ( right panel ) as a function of @xmath39 for @xmath59 and @xmath62 .",
    "error bars are standard deviations on @xmath46 different @xmath29-samples of configurations of the same system ( see text for the details of the simulation ) .",
    "the red continuous line in the left panel represents @xmath66 , the red horizontal line in the right panel corresponds to the exact value of the magnetic field @xmath59.,scaledwidth=70.0% ]      let us consider now the case in which the consistency equation admits two stable solutions @xmath16 , that happens as the magnetic field is equal to zero and @xmath39 is bigger than @xmath23 . in this case",
    "the boltzmann - gibbs distribution of the total magnetization presents two peaks , both for the finite size systems and in the thermodynamic limit : one peak is in correspondence with the negative solution @xmath67 of ( [ eqcons ] ) and one in correspondence with the positive solution @xmath68 ( see fig .",
    "[ fig4a ] as an example for finite size systems ) . as a consequence , the finite size magnetization @xmath28 , as defined in ( [ bram ] ) ,",
    "is equal to zero by symmetry and does not tend to one of the two stable solutions of ( [ eqcons ] ) when @xmath1 grows to infinity .",
    "boltzmann - gibbs distribution of the total magnetization for @xmath58 , @xmath19 and different values of the number of spins @xmath1 .",
    "the distribution is given by the red dot - dashed line for @xmath62 and by the green continuous line for @xmath63 .",
    "the peaks of the distribution are centered around the two symmetric solutions @xmath69 of the consistency equation ( [ eqcons ] ) , with @xmath70.,scaledwidth=70.0% ]    therefore , the inverse problem approach shown in section [ cwsec ] can not be used to reconstruct the model parameters .",
    "nevertheless , since the inversion formulas [ jterm ] and [ hterm ] hold true both for @xmath71 and for @xmath72 we need only to estimate properly at least one of such values from the data .",
    "this can be achieved by changing the sign of the negative ( positive ) experimental magnetizations and then by applying the inversion procedure to the obtained @xmath29-sample with all positive ( negative ) magnetizations .",
    "the result of the sign - flip is shown in the left panels of fig .",
    "[ fig13 ] for @xmath58 .",
    "values of @xmath52 ( upper panels ) and @xmath53 ( lower panels ) as a function of @xmath1 for @xmath58 and @xmath19 obtained by changing the sign of the negative magnetizations before to apply the inversion procedure ( left panels ) and with the clustering algorithm ( right panels ) .",
    "error bars are standard deviations on @xmath46 different independent @xmath29-samples of the same system ( @xmath37 - see text for the details of the simulation ) .",
    "the horizontal lines correspond to the exact values of @xmath58 ( upper panels ) and @xmath19 ( lower panels).,scaledwidth=80.0% ]    the simple trick of inverting the sign of the magnetizations in the sampled input configurations of the inverse problem is possible only if the system has symmetric solutions .",
    "for this reason , in scientific literature , the procedure used to handle the case of more than one stable solution of eq .",
    "( [ eqcons ] ) , is the clustering algorithm@xcite .",
    "this procedure has the advantage of being of general application and not only suitable for symmetric models as shown in ref .",
    "@xcite . without going into detail and referring to refs .",
    "@xcite for a depth study on this topic , we only mention that the clustering algorithm divides the configurations in groups ( clusters ) based on the measure of their mutual distance : configurations belong to the same cluster if their distance is below an appropriate fixed threshold .",
    "in particular , the algorithm defines the density around each configuration as the number of configurations in the given range and put each of them in the cluster with higher density among the closest ones .",
    "this procedure depends obviously on the arbitrary choice of the threshold . in our case , the algorithm allows the identification of two clusters @xmath73 and @xmath74 . by computing the values of @xmath35 and @xmath36 for each of them and then applying ( [ jterm ] ) separately to each cluster ,",
    "we obtain two different estimators @xmath75 , @xmath76 .",
    "finally , their average weighted with the number @xmath77 of configurations in each cluster ( @xmath78 ) , gives the estimate of the interaction parameter :    @xmath79    then , to estimate the magnetic field , we use ( [ hterm ] ) within each cluster , obtaining @xmath80 , @xmath81 and then we compute their weighted average over the clusters to get the estimator :    @xmath82    the results obtained with the clustering algorithm are shown in the right panels of fig .",
    "[ fig13 ] for @xmath58 .",
    "it is interesting to observe that in both cases ( right and left panels of fig .",
    "[ fig13 ] ) the results are qualitatively similar and in good agreement with the exact values of the parameters , though using the clustering there is a higher computational cost than with the sign - flip .",
    "eventually , let us consider the case in which eq .",
    "( [ eqcons ] ) admits a metastable solution in addition to the stable one , that happens for @xmath83 and @xmath6 close to zero . in the thermodynamic limit",
    ", the boltzmann - gibbs distribution of the total magnetization presents a unique peak in correspondence with the stable solution .",
    "however , the presence of the metastable solution in the infinite volume limit is reflected at finite @xmath1 by the existence of an extra peak in the distribution , as evidenced in fig .",
    "[ fig4 ] and in fig .",
    "[ fig14 ] , because of the finite size effects .",
    "boltzmann - gibbs distribution of the total magnetization for @xmath58 , @xmath84 and different values of the number of spins @xmath1 .",
    "the distribution is given by the red dot - dashed line for @xmath62 and by the green continuous line for @xmath63 . note that the peaks of the distribution are centered around the two solutions of the consistency equation ( [ eqcons ] ) , @xmath85 the stable one and @xmath86 the metastable one , whose probability vanishes as @xmath1 goes to infinity ( green continuous curve).,scaledwidth=70.0% ]     boltzmann - gibbs distribution of the total magnetization for @xmath87 , @xmath84 and different values of the number of spins @xmath1 .",
    "the distribution is given by the red dot - dashed line for @xmath62 , by the blue dashed line for @xmath88 and by the green continuous line for @xmath89 .",
    "note that the peaks of the distribution are centered around the two solutions of the consistency equation ( [ eqcons ] ) , @xmath90 the stable one and @xmath91 the metastable one , whose probability vanishes as @xmath1 goes to infinity ( green continuous curve).,scaledwidth=70.0% ]    since for small @xmath1 the boltzmann - gibbs distribution has a second peak in correspondence with the metastable solution , the application of the standard inversion procedure does not allow the proper reconstruction of the model parameters .",
    "in fact , when @xmath39 becomes greater than @xmath23 , fig .",
    "[ figerrric ] shows that the inverse problem formulas lead to very poor results . in particular ,",
    "note that as @xmath39 grows from @xmath23 , the values of @xmath52 deviate from the exact value of @xmath39 ( red line in fig .",
    "[ figerrric ] ) and that the true magnetic field @xmath6 is more and more badly estimated . as a last remark , observe that the error bar growth is due to the increase of the interaction ( as previously shown in fig .",
    "[ figerrcrej ] for the case of two stable solutions ) .",
    "values of @xmath52 ( left panel ) and @xmath53 ( right panel ) as a function of @xmath39 for @xmath84 and @xmath62 .",
    "error bars are standard deviations on @xmath46 different @xmath29-samples of configurations of the same system ( see text for the details of the simulation ) .",
    "the red continuous line in the left panel represents @xmath66 , the red horizontal line in the right panel corresponds to the exact value of the magnetic field @xmath84.,scaledwidth=70.0% ]    in particular , we can distinguish two different situations depending on the shape of the boltzmann - gibbs distribution of @xmath40 : a first one in which the supports of the two peaks are disjoint sets ( see fig .",
    "[ fig4 ] ) and a second one in which they are not ( see fig .  [ fig14 ] ) . in the first case ,",
    "the correct estimation of the model parameters is possible by applying one of the two techniques shown in section [ 2stablesol ] for the case of two stable solutions of eq .",
    "( [ eqcons ] ) . in the second one ,",
    "also the application of such procedures does not allow a proper reconstruction of the parameters , as we can see from fig .",
    "[ fig16 ] . nevertheless , the reconstruction errors both for sign - flip ( left panels ) and clustering ( right panels ) are smaller than @xmath92% also in the worst case ( @xmath93 ) . obviously , when there are stable and metastable solutions with not disjoint supports , the only way to compute efficiently the values of the model parameters is to have a large number @xmath1 of spins in the sample configuration in order to obtain a better approximation of the thermodynamic limit .",
    "values of @xmath52 ( upper panels ) and @xmath53 ( lower panels ) as a function of @xmath1 for @xmath87 and @xmath84 obtained by changing the sign of the negative magnetizations before to apply the inversion procedure ( left panels ) and with clustering algorithm ( right panels ) .",
    "error bars are standard deviations on @xmath46 different @xmath29-samples of the same system ( @xmath37 - see text for the details of the simulation ) .",
    "the horizontal lines correspond to the exact values of @xmath87 ( upper panels ) and @xmath84 ( lower panels).,scaledwidth=80.0% ]    we conclude this section observing that starting with real world experimental dataset , we could be in the case of a metastable solution ( or two stable solutions ) also when all the magnetizations computed from experimental configurations have the same sign .",
    "this could be due to the fact that the data come from a boltzmann - gibbs distribution like that of fig .",
    "[ fig4 ] ( or fig .",
    "[ fig4a ] ) conditioned to its positive or negative magnetization peak .",
    "in particular , observe that the experimental magnetization can have the same sign of the peak with smaller probability .",
    "these are rare events , but still possible if either system size @xmath1 or the sample size @xmath29 is too small .",
    "in this situation , the parameter estimation is performed with the standard inversion procedure shown in section [ cwsec ] , but the obtained values are those of a bimodal distribution with one of the two peaks in correspondence to the experimental magnetization @xmath35 .",
    "note that if this is the case the sign of the reconstructed value for the magnetic field ( when different from zero ) could not be in accordance with that of @xmath35 used in the inversion formulas .",
    "when @xmath94 and @xmath19 the inversion formulas ( [ stimatori ] ) and ( [ stimatorih ] ) do not hold true because the susceptibility @xmath24 grows to infinity .",
    "nevertheless , it is still possible to write an expression of the model s parameters in terms of experimental data that do not involve the susceptibility ( see the appendix for details ) . in particular , the expression for the interacting parameter , analogous to eq .",
    "( [ stimatori ] ) , is @xmath95 where @xmath96 denotes the gamma function and @xmath97 while the corresponding of eq .",
    "( [ stimatorih ] ) for @xmath98 is obtained by inverting eq .",
    "( [ eqcons ] ) with @xmath99 : @xmath100 in fig .",
    "[ fig18 ] , we compare the parameters values obtained using formulas ( [ jcrit ] ) and ( [ hcrit ] ) - right panels - with those computed with the inversion formulas ( [ stimatori ] ) and ( [ stimatorih ] ) - left panels . note the performance of the expression ( [ jcrit ] ) , that predicts the correct value @xmath101 also with a small number of particles , while the standard estimator ( [ stimatori ] ) underestimates the exact value of @xmath39 for all the considered values of @xmath1 . despite these good results , it is worth to mention that such critical formulas are not really useful to solve the inverse problem starting from real empirical data because they hold true only in the critical case @xmath101 and @xmath19 .",
    "this means that when @xmath102 and @xmath103 they fail in reconstructing the parameters values , as shown in fig .",
    "[ fig19 ] for the case @xmath104 and @xmath105 .",
    "in fact , while the standard inversion equation underestimates the exact value of @xmath39 as in the previous example ( fig .  [ fig18 ] ) , eq .",
    "( [ jcrit ] ) overestimates it with an error that grows as the number of particles @xmath1 increases . as a consequence of this bad estimation of the couplings , the error in the reconstruction of the magnetic field with eq .",
    "( [ hcrit ] ) is big too .",
    "therefore , expressions ( [ jcrit ] ) and ( [ hcrit ] ) can not be apply with real data outside criticality , but they can be used as a tool to measure if the data come from a system that is really critical or only near to criticality .",
    "@xmath101 , @xmath19 .",
    "left panels : values of @xmath52 ( upper panel ) and @xmath53 ( lower panel ) as a function of @xmath1 obtained with the standard inversion equations ( [ stimatori ] ) and ( [ stimatorih ] ) .",
    "rigth panels : values of @xmath106 ( upper panel ) and @xmath107 ( lower panel ) as a function of @xmath1 obtained with the eq .",
    "( [ jcrit ] ) for @xmath108 and ( [ hcrit ] ) for @xmath98 . for all panels : error bars are standard deviations on @xmath46 different @xmath29-samples of the same system ( @xmath37 - see text for the details of the simulation ) ; the horizontal lines correspond to the exact values of @xmath101 ( upper panels ) and @xmath19 ( lower panels).,scaledwidth=80.0% ]    @xmath104 , @xmath105 .",
    "left panels : values of @xmath52 ( upper panel ) and @xmath53 ( lower panel ) as a function of @xmath1 obtained with the standard inversion equations ( [ stimatori ] ) and ( [ stimatorih ] ) . rigth panels : values of @xmath106 ( upper panel ) and @xmath107 ( lower panel ) as a function of @xmath1 obtained with the eq .",
    "( [ jcrit ] ) for @xmath108 and ( [ hcrit ] ) for @xmath98 . for all panels : error bars are standard deviations on @xmath46 different @xmath29-samples of the same system ( @xmath37 - see text for the details of the simulation ) ; the horizontal lines correspond to the exact values of @xmath104 ( upper panels ) and @xmath105 ( lower panels).,scaledwidth=80.0% ]",
    "in many real - world studies ( e.g. in socio - economic , biological or neuro - physical sciences ) , there are situations in which the problem is to model a mean field interacting system partitioned into different sets where the elements ( individuals , agents or neurons ) belonging to the same set share very similar features or attributes .",
    "formally , such a model can be thought of as an extension of the curie - weiss model to systems composed of many interacting groups in the following way@xcite : let us consider a system of @xmath1 particles that can be divided into @xmath109 subsets @xmath110 with @xmath111 , for @xmath112 and sizes @xmath113 , where @xmath114 .",
    "particles interact with each other and with an external field according to the mean field hamiltonian : @xmath115 where @xmath116 represents the spin of the particle @xmath4 , @xmath117 is the parameter that tunes the mutual interaction between the particle @xmath4 and the particle @xmath118 and @xmath119 is the @xmath4-th external magnetic field . @xmath117 and @xmath119 take values according to the following symmetric matrix and vector , respectively :    @xmath120     + where each block @xmath121 has constant elements @xmath122 and each @xmath123 is a vector of constant elements @xmath124 . for @xmath125 , @xmath126 is a square matrix , whereas the matrix @xmath127 is rectangular .",
    "we assume @xmath128 to be positive , whereas @xmath122 with @xmath112 can be either positive or negative allowing for both ferromagnetic and antiferromagnetic interactions .",
    "the different values of the vector field depend on the subset the particles belong to .    indicating with @xmath129 the total magnetization of the group @xmath130 , and with @xmath131 the relative size of the set @xmath130",
    ", we may easily express the hamiltonian ( [ hami.multi ] ) as : @xmath132 where @xmath133 , @xmath134 , @xmath135 and @xmath136 is the reduced interaction matrix @xmath137 the joint distribution of a spin configuration @xmath138 is given by the boltzmann - gibbs measure @xmath139 related to the hamiltonian ( [ hami.multi ] ) , where again we consider the inverse temperature parameter @xmath9 absorbed within the model parameters @xmath136 and @xmath140 .",
    "the model is well - posed , as it has been shown in ref .  @xcite . in the thermodynamic",
    "limit the model is described by the following system of mean - field equations : @xmath141 in particular , the solutions of this system are the critical points of the pressure function of the model ( see ref .",
    "when the system admits a unique thermodynamically stable solution @xmath142 , the inversion problem procedure is the natural extension of the case we have studied for the curie weiss model when the boltzmann - gibbs distribution of the total magnetization is unimodal . following the study of ref .",
    "@xcite where this case has been analyzed , we denote by @xmath143 the average magnetization of each specie calculated from the data @xmath144 and we define the matrices @xmath145 and @xmath146 , whose elements are @xmath147 the model estimators are @xmath148 the parameter reconstruction for this case has been deeply investigated in ref .  @xcite . in the following section we consider cases in which the system of mean - field equations ( [ campomedio.multi ] ) has more stable ( or metastable ) solutions ; in these situations eq .",
    "( [ stimatoribipj ] ) and ( [ stimatoribiph ] ) fail to provide a good parameter reconstruction . nevertheless ,",
    "since the previous equations are locally fulfilled around each solution , the inverse problem can be globally solved by applying the analogous procedures to those described for the curie - weiss model as the consistence equation admits more solutions .    without loss of generality",
    ", we will present the results only for the two - species case ( @xmath149 ) .",
    "this choice is motivated by the fact that a big number of species would cause a loss of statistical robustness working with real world datasets and an excessive increase of computational complexity in the case of numerical simulations .      as a test problem for the multi - species mean - field model",
    "we consider systems of @xmath150 $ ] particles divided into @xmath149 equally populated subsets ( @xmath151 ) and a sample of @xmath37 independent spin configurations . starting from couples of given values for the reduced interaction matrix and for the external vector field    @xmath152    we consider @xmath46 @xmath29-samples for each couple @xmath153 and we apply the maximum likelihood estimation to each one of them independently",
    "; then we average the inferred values @xmath154 and @xmath155 of the model parameters , given by ( [ stimatoribipj ] ) and ( [ stimatoribiph ] ) , over the @xmath46 @xmath29-samples ( as in the curie - weiss model ) obtaining @xmath156 and @xmath157 .",
    "let us consider the case in which the system ( [ campomedio.multi ] ) admits three solutions @xmath158 , corresponding to two maxima and a minimum of the pressure function .",
    "consider as an example : @xmath159     boltzmann - gibbs distribution of the total magnetization for @xmath160 , @xmath161 , @xmath162 , @xmath163 and @xmath164 spins .",
    "the system ( [ campomedio.multi ] ) admits three solutions @xmath158 , corresponding to two maxima and a minimum of the pressure function.,scaledwidth=80.0% ]    in this case the boltzmann - gibbs distribution of the total magnetization presents two peaks , one in correspondence to the local maximum @xmath165 and one in correspondence to the global maximum @xmath166 , as shown in fig .",
    "[ fig21 ] .    figs .",
    "[ fig21a ] and [ fig21b ] represent the reconstruction of the model parameters using both the sign - flip trick ( left panels ) and clustering algorithm ( right panels ) .",
    "elements of the matrix @xmath156 as a function of @xmath1 for @xmath160 , @xmath161 , @xmath162 and @xmath163 .",
    "the values of @xmath167 ( crosses ) , @xmath168 ( dots ) and @xmath169 ( squares ) in the left panels are obtained with the sign - flip , those of right panels with the clustering algorithm .",
    "the horizontal lines correspond to the exact values of the elements of the matrix @xmath136.,scaledwidth=80.0% ]     elements of @xmath157 as a function of @xmath1 for @xmath160 , @xmath161 , @xmath162 and @xmath163 .",
    "the values of @xmath170 ( crosses ) and @xmath171 ( dots ) in the left panels are obtained with the sign - flip , those of right panels with the clustering algorithm .",
    "the horizontal lines correspond to the exact values of the elements of @xmath140.,scaledwidth=80.0% ]    the results obtained in both cases fully satisfy the expectation also for groups with few elements ( @xmath172 ) .",
    "the advantage of the sign - flip with respect to the clustering algorithm is of computational type .",
    "the clustering algorithm becomes essential when the maxima of the pressure function are more than two because in these cases the boltzmann - gibbs distribution of the total magnetization can not be reduced to a unimodal one through a simple change of sign .",
    "[ fig22 ] is an example of this situation for @xmath173     boltzmann - gibbs distribution of the total magnetization for @xmath174 , @xmath175 and @xmath176 and @xmath164 spins .",
    "the system ( [ campomedio.multi ] ) admits five solutions @xmath158 , three of wich are maxima of the pressure function.,scaledwidth=80.0% ]    the parameter reconstruction with the clustering algorithm is shown in fig .",
    "[ fig22a ] and [ fig22b ] .",
    "the figures show that @xmath1 greater the @xmath177 suffices to obtain a good parameter estimation .",
    "elements of the matrix @xmath156 as a function of @xmath1 for @xmath174 , @xmath175 and @xmath176 obtained with clustering algorithm .",
    "the horizontal lines correspond to the exact values of the elements of the matrix @xmath136.,scaledwidth=80.0% ]     elements of @xmath157 as a function of @xmath1 for @xmath174 , @xmath175 and @xmath178 obtained with clustering algorithm .",
    "the horizontal lines correspond to the exact values of the elements of @xmath140.,scaledwidth=80.0% ]",
    "in this paper we studied the inverse problem for the curie - weiss model and for its multi - species version in the low temperature phase , where more than one state is present . in order to infer the parameters of the underlying model starting from input data with two or more coexisting states , we used the well known clustering algorithm and/or the sign - flip of the experimental magnetizations .",
    "the predictions of the model parameters produced in these two ways are comparable and very accurate even when the size of the system is small , but when the symmetry of the states in the phase space allows the application , the sign - flip is preferable because is simpler and has a lower computational cost . given a set of input configurations with magnetizations either positive and negative , it is necessary before applying the inversion procedure to change the sign of the magnetizations from positive to negative ( or viceversa ) , in order to have in the input only concordant magnetizations .",
    "this work shows results that are particularly useful in applications to real world dataset .",
    "it explains , for example , that the sign of the reconstructed magnetic field , contrarily to a common expectation , could not be in accordance with that of the sampled magnetization .",
    "this happens when the distribution of the magnetization of the underlying model is multimodal and the input configurations come from the set with smaller probability .",
    "moreover , the expressions of the parameters given for the curie - weiss model at the criticality are useful for determining whether a system is in a critical regime or not .",
    "here we describe how to obtain the critical expressions ( [ jcrit ] ) and ( [ hcrit ] ) shown in section [ cwcriticosec ] . to this purpose",
    "it is worth to mention that the reconstruction of the model parameters from data is based on the possibility to find a suitable normalization of the total magnetization @xmath11 that remains a well defined random variable also in the thermodynamic limit . outside of the critical point",
    ", the answer of this problem is given by the random variable @xmath179 whose distribution in the thermodynamic limit is a gaussian with mean equal to the stable solution @xmath21 of the consistence equation [ eqcons ] and variance equal to the susceptibility @xmath24 of the model@xcite .",
    "since @xmath180 by inverting this limit identity and remembering that @xmath21 is also the limit value of @xmath181 , we get the inversion formula for the interaction parameter : @xmath182    when @xmath101 and @xmath19 , @xmath183 is no more a well define random variable in the limit because @xmath24 grows to infinity . in this case",
    "the correct normalization of @xmath11 is given by @xmath184 distributed in the thermodynamic limit as follows : @xmath185 where @xmath21 is the unique stable solution of the consistence equation and @xmath186 is the pressure function of the model@xcite .",
    "it is straightforward to show that @xmath21 is the global maximum point of @xmath187 and is equal to zero . in the limit",
    "the variance of @xmath188 is @xmath189 where @xmath190 this means that as @xmath191 the following identity holds true @xmath192 it follows : @xmath193",
    "the authors thank p. contucci for inspiring this work and c. giberti for interesting discussions and for a careful reading of the manuscript .",
    "m. fedele thanks the indam - cofund marie curie fellowships for financial support .",
    "this work was partially supported by firb grant rbfr10n90w .",
    "w. bialek , a. cavagna , i. giardina , t. mora , e. silvestri , m. viale and a.m. walczak , statistical mechanics for natural flocks of birds , proceedings of the national academy of sciences , * 109 * , 4786 - 4791 , ( 2012 )      a. barra , p. contucci , r. sandell and c. vernia , an analysis of a large dataset on immigrant integration in spain .",
    "the statistical mechanics perspective on social action , _ sci .",
    "* 4 * ( 2014 ) , 1 - 37 ."
  ],
  "abstract_text": [
    "<S> in this paper we solve the inverse problem for a class of mean field models ( curie - weiss model and its multi - species version ) when multiple thermodynamic states are present , as in the low temperature phase where the phase space is clustered . </S>",
    "<S> the inverse problem consists in reconstructing the model parameters starting from configuration data generated according to the distribution of the model . </S>",
    "<S> we show that the application of the inversion procedure without taking into account the presence of many states produces very poor inference results . </S>",
    "<S> this problem is overcomed using the clustering algorithm . </S>",
    "<S> when the system has two symmetric states of positive and negative magnetization , the parameter reconstruction can be also obtained with smaller computational effort simply by flipping the sign of the magnetizations from positive to negative ( or viceversa ) . </S>",
    "<S> the parameter reconstruction fails when the system is critical : in this case we give the correct inversion formulas for the curie - weiss model and we show that they can be used to measuring how much the system is close to criticality .    </S>",
    "<S> keywords : _ statistical mechanics ; inverse problem ; curie - weiss models ; multi - species mean field model ; finite size effects . </S>"
  ]
}