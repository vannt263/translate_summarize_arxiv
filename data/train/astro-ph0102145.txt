{
  "article_text": [
    "in many astrophysical systems , radiation is the dominant energy transport mechanism . in some circumstances , including winds from wolf - rayet stars ( lucy & abbott 1993 ) and asymptotic giant branch stars ( habing 1996 ) , interiors of massive stars ( kippenhahn & weigert 1990 ) , supernova blast waves ( arnett et al .",
    "1989 ) , and compact object accretion flows ( klein et al .",
    "1996 ) and disks ( shakura & sunyaev 1973 ) , radiation comprises a substantial fraction of the total energy density , momentum density , or pressure .",
    "the dynamics of such flows must be modeled using a radiation hydrodynamical ( rhd ) approach , in which energy and momentum conservation laws for the radiation field are solved along with those for the gas .",
    "the outcomes of these calculations depend on the exchange of internal energy and momentum between material and radiation .",
    "the length and time scales associated with the exchanges are determined by atomic processes , and may be orders of magnitude shorter or faster than dynamical scales , so that implicit time differencing is usually necessary .",
    "an accurate description of the angular dependence of the radiation field may be important when parts of the gas are optically thin , localized sources of radiation are present , or shadows are cast within the flow .",
    "it is possible to compute the angular dependence by solving the transfer equation along rays through the points of interest .",
    "however , the number of rays needed to adequately specify the angular dependence at every point is often large .",
    "such a method has been implemented in two spatial dimensions in the zeus-2d magnetohydrodynamics ( mhd ) code ( stone & norman 1992b ) by stone , mihalas , & norman ( 1992 ) , but is complex and computationally intensive . despite the promise of this full - transport method ,",
    "it must be considered still under development . in this paper",
    "we describe a method for calculations using zeus-2d , in which the angular dependence of the radiation field is assumed to be given by the flux - limited diffusion ( fld ) approximation .",
    "this method is simple , robust , and relatively cheap in computer time .",
    "we assume the gas is in local thermodynamic equilibrium ( lte ) at a temperature which need not correspond to that of the radiation field .",
    "frequency dependence of the opacities is neglected , though it may be included in a straightforward fashion .",
    "the rhd equations solved are discussed in  [ sec : eqns ] , the fld approximation in  [ sec : fld ] , and the numerical algorithm in  [ sec : method ] .",
    "results of test calculations are presented in ",
    "[ sec : tests ] , and the advantages and limitations of the method are summarized in  [ sec : summary ] .",
    "much as the gas dynamical equations are derived by taking velocity moments of the material particle kinetic equation , or boltzmann equation , the conservation laws for the radiation field are generated by taking angular moments of the photon kinetic equation , or radiation transport equation . in a frame comoving with the radiating fluid , assuming lte , and to order unity in @xmath0 , the coupled equations of rhd are ( mihalas & mihalas 1984 ) @xmath2 @xmath3 @xmath4 @xmath5 and @xmath6 here the convective derivative @xmath7 .",
    "the dependent quantities @xmath8 , @xmath9 , @xmath10 , and @xmath11 are the material mass density , energy density , velocity , and scalar isotropic pressure respectively , while @xmath12 , @xmath13 , and @xmath14 are the total frequency - integrated radiation energy density , momentum density or flux , and pressure tensor , respectively .",
    "the latter are the zeroth , first , and second angular moments of the radiation specific intensity .",
    "the specific intensity , @xmath15 , in general varies with spatial position @xmath16 , viewing direction @xmath17 , frequency @xmath18 , and time @xmath19 .",
    "complete description of @xmath20 in a three - dimensional space therefore requires seven scalar coordinates .",
    "the angular moments of @xmath20 appearing in the rhd equations above may be written @xmath21 @xmath22 and @xmath23    the assumption of lte allows the source function specifying the rate of emission of radiation from the gas in equations  ( [ eqn : radenergy ] ) and  ( [ eqn : gasenergy ] ) to be written as the planck function @xmath24 .",
    "equations  ( [ eqn : gasmomentum ] ) through  ( [ eqn : radmomentum ] ) have been integrated over frequency , leading to the flux mean total opacity @xmath25 , and the planck mean and energy mean absorption opacities , @xmath26 and @xmath27 . in the present paper",
    "the opacities are assumed to be independent of frequency , so that @xmath28 and the subscripts may be omitted .",
    "the total opacity @xmath29 is the sum of components due to absorption , @xmath30 , and scattering , @xmath31 , all having dimensions of inverse length . in a pure hydrogen gas above @xmath32",
    "k , simple forms for @xmath30 and @xmath31 are kramers law and the thomson scattering coefficient .",
    "equations  ( [ eqn : cty ] ) to  ( [ eqn : radmomentum ] ) correctly describe the flow only in the comoving frame , where material properties are isotropic and the form of the material - radiation interaction terms is greatly simplified . in writing the equations , effects of self - gravity and magnetic fields",
    "have been ignored .",
    "the treatment of these effects in zeus-2d is independent of the algorithms for rhd described here .",
    "the equations of rhd may be closed by the addition of constitutive relations for the planck function and opacities , an equation of state specifying the gas pressure , and an assumption about the relationship between the angular moments of the radiation field . since @xmath33 when the field is isotropic , one might choose to assume this relation holds everywhere .",
    "this is referred to as the eddington approximation , and is analogous to assuming isotropy of the material particle distribution function in deriving the gas equation of state .",
    "the eddington approximation implies that in steady - state , equation  ( [ eqn : radmomentum ] ) becomes @xmath34 this expression gives the correct flux in optically thick regions , where @xmath29 is large , and tends to infinity in optically thin regions where @xmath35 .",
    "however the rate at which radiation transports energy is finite and , from equations  ( [ eqn : emoment ] ) and  ( [ eqn : fmoment ] ) , is limited to @xmath36 .",
    "this causality problem with equation  ( [ eqn : eddflux ] ) occurs because in optically thin regions photons travel freely , their mean free paths may exceed characteristic lengths in the system , and the radiation field may be anisotropic . in this paper",
    "we implement an extension of the eddington approximation in which causality is preserved by assuming a particular form for the angular dependence of the radiation field in optically - thin regions .",
    "this extension is described in the next section .",
    "fld techniques were first used in astrophysics to solve the radiation transport equation , in calculations of accretion onto a neutron star ( alme & wilson 1974 ) .",
    "subsequently , levermore & pomraning ( 1981 ; hereafter lp ) generalized the method to approximately handle transport phenomena while preserving causality in regions where spatial variations occur over distances smaller than a mean free path . pomraning ( 1983 ) included relativistic terms of order @xmath0 in a moving fluid .",
    "fld methods have since been used in pure scattering media ( melia & zylstra 1991 ) , and for fully general - relativistic calculations ( anile & romano 1992 ) . the key ingredient in all cases is the assumption that the specific intensity is a slowly - varying function of space and time . in one space dimension ,",
    "this assumption is valid in both the optically - thick diffusion limit and the optically - thin free - streaming limit .",
    "one hopes it holds approximately in the intermediate regime and in multi - dimensions , and this may be tested by comparison with results of full - transport calculations .",
    "given slow spatial and time variation , analytic relations may be obtained between the angular moments of the radiation field .",
    "lp showed that the radiation flux may be written in the form of fick s law of diffusion , as @xmath37 with a diffusion coefficient @xmath38 given by @xmath39 the dimensionless function @xmath40 is called the flux limiter . in this framework , the radiation pressure tensor may be expressed in terms of the radiation energy density via @xmath41 where the components of the eddington tensor @xmath1 are given by @xmath42 @xmath43 is the unit vector in the direction of the radiation energy density gradient , and the dimensionless scalar function @xmath44 is called the eddington factor .",
    "the flux limiter @xmath45 and eddington factor @xmath46 are related through implicit constraints between the moments @xmath13 and @xmath14 , so that @xmath47 where @xmath48 is the dimensionless quantity @xmath49 .",
    "equations  ( [ eqn : fick ] ) through  ( [ eqn : flambda ] ) close the equations of rhd , eliminating the need to solve the radiation momentum equation  ( [ eqn : radmomentum ] ) , and greatly simplifying the computation . since the angular distribution of the radiation field is not explicitly computed , no formal solution of the transfer equation is needed .",
    "an important choice which must be made to achieve this simplification is the expression to be used for the flux limiter @xmath45 .",
    "many expressions are possible which preserve causality , and are consistent with the assumption of smoothness in the radiation field .",
    "these are distinguished by different assumptions regarding the details of the angular dependence of the specific intensity .",
    "in one example , lp chose to constrain the normalized specific intensity @xmath50 by @xmath51 resulting in the flux limiter @xmath52 physically , the derivation of this result follows an analysis similar to the chapman - enskog approach for developing solutions to the boltzmann equation in the kinetic theory of gases . in a second example of a choice of constraint on the anisotropy of the radiation field , minerbo ( 1978 ) assumed a piecewise linear variation of the specific intensity with angle , and found the flux limiter @xmath53 in the optically thin limit @xmath54 , both the lp and minerbo flux limiters give to first order in @xmath55 @xmath56",
    "so the magnitude of the flux approaches @xmath57 , which obeys the causality constraint . in the optically thick or diffusion limit @xmath58 ,",
    "both examples give to first order in @xmath48 @xmath59 so the flux takes the value given by equation  ( [ eqn : eddflux ] ) . for intermediate values of @xmath48 , these two forms for the flux limiter differ substantially , as shown in figure  [ fig : limiters ] . thus a major uncertainty in fld calculations is the appropriate choice for the form of the flux limiter .",
    "some alternatives are described by levermore  ( 1984 ) .",
    "the lp form has been used in studies of accretion onto black holes ( eggum , coroniti , & katz 1988 ) and protostellar collapse ( bodenheimer et al . 1990 ) .",
    "dynamics of radiation - dominated accretion disks computed using the lp and minerbo forms were compared by turner & stone  ( 2001 ) .",
    "kley  ( 1989 ) derived a flux limiter appropriate for accretion disk boundary layers , using exact solutions of the transfer equation for spherically - symmetric stellar atmospheres .",
    "this limiter is quite similar to the minerbo form over the whole range of @xmath48 .",
    "a flux limiter appropriate for a scattering medium was derived and used in accretion disk corona models by melia & zylstra ( 1991 ) .",
    "the lp and minerbo flux limiters have been widely used , and bracket the range of values of most other flux limiters .",
    "both are available in the zeus-2d implementation of fld described here .",
    "since the appropriate form of the flux limiter is not always clear beforehand , in some applications new limiters may have to be derived in order to achieve accurate results .",
    "comparisons between fld and full transport results remain important .    in summary",
    ", applying the fld approximation involves computing the flux limiter from the value of @xmath48 in each zone , and then using equations  ( [ eqn : fick ] ) to  ( [ eqn : flambda ] ) to obtain the radiation flux and radiation pressure from the radiation energy density .",
    "as with the mhd equations in zeus-2d , the dynamical equations for the radiation are operator - split into source and transport terms . in the source step ,",
    "the radiation and material energy densities are updated using finite difference approximations to @xmath60 and separately , @xmath61 and @xmath62 in the transport step , an integral formulation is used to generate a conservative differencing scheme for the advection terms , @xmath63 where @xmath64 is an arbitrary coordinate velocity which allows grid motion .",
    "equations  ( [ eqn : erdivflux ] ) to  ( [ eqn : ertransport ] ) are evolved in the radiation module , as is the source term due to radiative acceleration in the gas momentum equation  ( [ eqn : gasmomentum ] ) .",
    "the rest of the set of coupled equations is solved using the existing hydrodynamic algorithms .",
    "centering of the radiation variables on the hydrodynamic grid is described in  [ sec : centering ] , update of the radiation flux term in  [ sec : delflux ] and the remaining source terms in  [ sec : eerint ] , treatment of the compression terms in the case of strictly scattering opacity in  [ sec : eerdv ] , and the transport step in  [ sec : transport ] .",
    "stability of the method and the choice of timestep are discussed in  [ sec : dt ] .",
    "the dependent variables for the radiation are discretized onto the computational mesh as in zeus-2d ( stone & norman 1992a , hereafter sn ) .",
    "scalars , and tensors of even rank , are zone - centered , while tensors of odd rank are face - centered .",
    "the mesh is labeled by coordinate vectors @xmath65 and @xmath66 , with the 3-direction taken to be orthogonal to the computational plane .",
    "the mesh whose grid lines mark zone edges is labeled by coordinates @xmath67 and @xmath68 , while the mesh whose lines intersect at zone centers is labeled by coordinates @xmath69 and @xmath70 , as shown in figure  [ fig : mesh ] . on this mesh",
    ", the radiation variables are discretized according to @xmath71 the components of the eddington tensor @xmath72 are centered identically to the components of @xmath14 .",
    "the opacity , absorption and scattering coefficients , and planck function are all zone - centered .",
    "the radiation diffusion coefficient @xmath38 is computed on zone 1-faces ( @xmath73 ) and 2-faces ( @xmath74 ) along with the components of the flux .      under the fld approximation ,",
    "the flux divergence term in the radiation energy equation  ( [ eqn : erdivflux ] ) is a function of the gradient in radiation energy density .",
    "when implicitly differenced , it therefore depends on the time - advanced values of @xmath12 in adjacent grid zones , and may be updated by a matrix inversion . to simplify the form of the matrix , we operator - split this from the remaining source terms , and integrate @xmath75 with @xmath38 given by equation  ( [ eqn : dc ] )",
    "the solution method is described here for a uniformly - spaced square cartesian grid .",
    "extension to the curvilinear coordinates used in zeus-2d is straightforward .",
    "the implicit difference equations to be solved are of the form @xmath76 where @xmath77 is the grid spacing , and the spatial indices span ranges @xmath78 and @xmath79 .",
    "radiation energy densities are to be determined at timestep @xmath80 .",
    "the difference equations are kept linear by using diffusion coefficients from step @xmath81 .",
    "this is a good approximation when @xmath82 changes little each timestep , but may be less appropriate when the radiation field varies rapidly with time in regions of intermediate or low optical depth .",
    "in section  [ sec : front ] it is shown that a propagating radiation front can be more accurately evolved in this situation when the diffusion coefficients are recalculated every diffusion substep .",
    "considering @xmath83 as a single vector of length @xmath84 , the updated values may be determined by solving an equation with a matrix of @xmath85 elements , using a sparse - matrix technique such as incomplete cholesky  conjugate gradient ( press et al .",
    "these methods have proven useful for particular problems with fixed boundary conditions , but the form of the matrix and the sparse - matrix method required vary with the boundary conditions .",
    "solutions of equation  ( [ eqn : delfluxdifferencing ] ) may also be obtained by combining simple solvers with multi - grid acceleration techniques ( hackbusch 1985 ) . however ,",
    "here we choose an alternating - direction - implicit ( adi ) method on a single grid .",
    "this may be less efficient than the best sparse - matrix and multi - grid algorithms , though the number of operations required is proportional to @xmath84 . in adi ,",
    "successive approximations to @xmath86 are computed by advancing towards a @xmath87-stationary state the equation @xmath88^{n+1}_{i , j}.\\ ] ] the new variable @xmath87 may be thought of as the pseudo - time .",
    "each @xmath87-step is split into two parts . in the first , the update is @xmath87-implicit along the 1-direction , and explicit along the 2-direction . in the second , the differencing schemes for the two axes are exchanged .",
    "labeling the approximate value of @xmath83 at pseudo - timestep @xmath89 by @xmath90 , the difference equations solved are @xmath91 on sweeps which are implicit along the 1-direction , and @xmath92 on sweeps which are implicit along the 2-direction .",
    "each sweep involves solving a tridiagonal matrix equation .",
    "for example , for boundary condition @xmath93 , the matrix equation solved on the @xmath94th sweep implicit along the 1-direction is @xmath95 \\left [ \\begin{array}{c } e_{1,j } \\\\ \\vdots \\\\ e_{n , j } \\end{array } \\right]^{m+{\\frac{1}{2 } } } = { \\bf b},\\end{aligned}\\ ] ] where @xmath96 , @xmath97 , and the elements of vector @xmath98 are @xmath99 e^m_{i , j } + h d2_{i ,",
    "j+1 } e^m_{i , j+1 } + h d2_{i , j } e^m_{i , j-1 } + { \\delta w\\over 2\\delta t } e^n_{i , j}.\\ ] ] advancing a pseudo - timestep involves solving @xmath100 such equations in @xmath101 matrices for the 1-implicit sweeps , and @xmath102 similar @xmath103 matrix equations for the 2-implicit sweeps . a standard method involving @xmath104 decomposition and forward- and back - substitution is used . in the case of periodic boundaries ,",
    "the lower left and upper right corner elements of the matrices are non - zero , and this condition is dealt with using the sherman - morrison formula ( press et al .",
    "1992 ) to compute a correction to the solution of the tridiagonal part .",
    "the diffusion coefficients are held fixed during the entire real timestep .",
    "numerical accuracy of the solution is improved by scaling the lengths , times , and diffusion coefficients in equation  ( [ eqn : tridiagonal ] ) by a common factor chosen so the diagonal matrix elements are near unity .    to bring the solution into pseudo - time steady - state rapidly on different size scales , the length of the pseudo - timestep @xmath105 is increased exponentially with iteration number @xmath106 , so that @xmath107 where the initial pseudo - timestep @xmath108 is one - quarter of the square of the grid spacing , and the final pseudo - timestep @xmath109 is one - quarter of the square of the total grid size ( black & bodenheimer 1975 ) . in cases where the number of zones is large , the rescaling of lengths and times applied to equation  ( [ eqn : tridiagonal ] ) may not be sufficient to keep the condition numbers of the matrices near unity for all pseudo - timesteps , and the reduced accuracy of solutions obtained using @xmath104 decomposition may lead to slow convergence . under these conditions",
    "it might be helpful to iteratively improve the initial solution , or to use an alternative decomposition such as @xmath110 or householder ( press et al .",
    "1992 ) . for the test problems discussed in section  [ sec : tests ] , reducing the condition numbers of the matrices by adjusting the rescaling factor did not speed convergence .    the error in the time - advanced solution @xmath86 obtained from the series of @xmath87-steps is checked by substituting in the original difference equation  ( [ eqn : delfluxdifferencing ] ) .",
    "the residual is normalized against the ratio of the time - centered @xmath12 to the hydrodynamical timestep .",
    "if the biggest error on the grid is too large , the method is applied again with larger @xmath111 and more closely - spaced pseudo - timesteps . if a sufficiently small error is not reached after many pseudo - timesteps , then the real timestep for the flux divergence term is halved , and the term is applied twice per hydrodynamical timestep . if a sufficiently small error is not obtained with the real timestep finely divided , the calculation is terminated . on the other hand , if the error obtained is very small , then fewer pseudo - timesteps are tried initially in the following diffusion substep .      the absorption , emission , and compressive heating source terms are approximated by implicit difference equations , to obtain numerical stability for timesteps which may be long compared with the matter - radiation interaction timescale .",
    "the solution is advanced in these terms from step @xmath81 to step @xmath80 by solving simultaneously @xmath112 and @xmath113 these depend on the values of @xmath9 and @xmath12 in zone @xmath114 only , so the spatial coordinate subscripts are dropped in subsequent equations .",
    "the gas is assumed to be ideal , with ratio of specific heats @xmath115 , and equation of state @xmath116 .",
    "the planck function @xmath117 is computed from the temperature @xmath118 using the density @xmath119 at the preceding time .",
    "here @xmath120 is the dimensionless mean particle mass , @xmath121 the gas constant , and @xmath122 the boltzmann constant . the rate @xmath123 at which work is done on the radiation by the flow is @xmath124 the eddington tensor components @xmath125 , @xmath126 , and @xmath127 , the fluid velocity @xmath10 , and the absorption opacity @xmath30 are evaluated at timestep @xmath81 , and the components of the velocity gradient tensor are as in stone , mihalas , & norman ( 1992 ) appendix  a. with these choices , the only unknowns in equations  ( [ eqn : erdifference ] ) and  ( [ eqn : edifference ] ) are @xmath128 and @xmath86 . eliminating @xmath86 between the two equations",
    "yields a quartic polynomial with @xmath128 as one root . with @xmath129 in place of @xmath128 ,",
    "the quartic is @xmath130 where @xmath131 @xmath132 @xmath133 and @xmath134 the quartic typically has a single positive real root when the timestep satisfies the courant condition of  [ sec : dt ] .",
    "writing the coefficient of @xmath129 in equation  ( [ eqn : interactionquartic ] ) as @xmath135 and the constant coefficient as @xmath136 , this single root lies between zero , and the smaller of @xmath137 and @xmath138 .",
    "the updated gas energy density is obtained by finding the root using newton - raphson iteration on this interval , with bisection when the newton - raphson method fails .",
    "the updated radiation energy density is determined by substituting the updated gas energy density in equation  ( [ eqn : erdifference ] ) .",
    "when the absorption opacity @xmath30 is zero and the material - radiation interaction terms vanish , equations  ( [ eqn : erdifference ] ) and  ( [ eqn : edifference ] ) are no longer coupled . in this instance , numerical energy conservation may be improved by using time - centered values for the gas and radiation pressures . in this differencing scheme , the time - advanced gas energy density @xmath9 is @xmath139,\\ ] ] with @xmath140 . for the radiation energy density update ,",
    "@xmath141 is replaced by the quantity multiplying @xmath86 in equation  ( [ eqn : gradvprad ] ) .",
    "advection of the radiation energy proceeds exactly as described by sn for the hydrodynamic variables .",
    "having expressed the advection terms in integral form in equation  ( [ eqn : ertransport ] ) , we apply the conservative differencing scheme used for the hydrodynamic variables . in this scheme ,",
    "the flux of advected radiation energy is computed from the mass flux in order to reduce the relative numerical diffusion of radiation with respect to the gas .",
    "the flux across every zone interface is computed using an interpolation method which may be selected as either donor cell , van leer , or piecewise parabolic .",
    "these fluxes are then used to update the radiation energy density in a directionally split fashion .",
    "thus , the flux of radiation energy density along the 1-direction is constructed using @xmath142 where the mass fluxes in the 1-direction , @xmath143 , are defined by equation [ 55 ] in sn .",
    "these fluxes are used to update the radiation energy under 1-transport via @xmath144 advection fluxes of radiation energy density in the 2-direction are computed by @xmath145 where the mass fluxes in the 2-direction , @xmath146 , are defined by equation [ 56 ] in sn .",
    "these fluxes are then used to update the radiation energy due to advection in the 2-direction via @xmath147 to reduce the systematic effects of the directional splitting discussed in section  [ sec : testtransport ] , the order in which the two advection substeps are applied is reversed each timestep .",
    "since the advection terms in the rhd equations are treated time - explicitly , the calculations may be numerically unstable unless the timestep is less than the time for waves or advection to carry energy across a grid zone ( richtmyer & morton 1957 ) .",
    "the wave family with the largest group speed may be either adiabatic sound waves or radiation acoustic waves , depending on the ratio of gas and radiation energy densities .",
    "the sound speed for purposes of computing the timestep is therefore chosen to be @xmath148^{1/2},\\ ] ] where @xmath149 is the sum of the gas pressure and the largest component of the radiation pressure tensor .",
    "the remainder of the calculation of the timestep proceeds as in the hydrodynamic portion of zeus-2d ( sn ) .",
    "though resulting steps may be longer than the time for radiation to diffuse across a zone @xmath150 , the implicit differencing of the radiation diffusion term (  [ sec : delflux ] ) ensures stability of the method .",
    "the problems used to test the radiation module fall into three categories .",
    "calculations outlined in the first three sections below test in isolation the heating and cooling terms (  [ sec : testheatcool ] ) , the radiation flux divergence term (  [ sec : testdelflux ] ) , and the transport terms (  [ sec : testtransport ] ) .",
    "linear rhd wave tests involving all the radiation terms are described in  [ sec : linear ] .",
    "calculations which exercise radiation terms in the non - linear regime are propagation of optically - thin radiation fronts (  [ sec : front ] ) , structure of radiating gas pressure dominated shocks of moderate optical depth (  [ sec : critical ] ) , and formation of a steady optically - thick shock in which radiation pressure dominates downstream (  [ sec : raddomshock ] ) .      in a static uniform absorbing fluid initially out of thermal balance , an analytic solution for the time evolution of the gas energy may be obtained for the case where radiation energy dominates the total .",
    "the radiation energy emitted or absorbed in reaching equilibrium is a small fraction of the initial value , so radiation energy density @xmath12 is assumed constant .",
    "the time evolution of the gas energy density @xmath9 is obtained by solving the ordinary differential equation @xmath151 solutions are plotted together with the numerical results in figure  [ fig : testheatcool ] , for a density of @xmath152  g  @xmath153 , opacity @xmath154  @xmath155 , mean dimensionless mass per particle 0.6 , and index in the equation of state @xmath156 .",
    "two cases are shown . in the first",
    ", the initial thermal energy density is less than the equilibrium value .",
    "the agreement of the computed result with the analytic solution in this case is excellent . in the second case",
    ", @xmath9 is initially larger than the equilibrium value , lags the expected decline for the first few steps , and reaches equilibrium in the correct time .",
    "these results are consistent with the use of a fully - implicit method and a timestep of a few times @xmath157  seconds , much longer than the cooling time .",
    "when the timestep is held to less than the cooling time , the agreement between the calculation and the analytic solution is improved , as shown by the dotted line in figure  [ fig : testheatcool ] .",
    "the sum of thermal and radiation energies is conserved in these three cases to about the floating - point precision .",
    "an analytic solution of the diffusion equation  ( [ eqn : raddiffusion ] ) on the unit square , with periodic boundaries and unit diffusion coefficient , is ( lamb  1995 ) @xmath158 this function at @xmath159 is discretized onto a grid with 100 zones along each side , and the evolution followed using the radiation diffusion term alone .",
    "the timestep chosen is a factor of a hundred longer than the time @xmath150 for radiation to diffuse across a zone .",
    "the largest zone - by - zone difference between the numerical and analytic solutions during the evolution towards equilibrium is 5.3% , and the largest root - mean - square difference is 2.5% . when the timestep is shortened by a factor ten , the corresponding residuals are 0.7% and 0.3% .",
    "the implicit numerical solution relaxes towards equilibrium more slowly than the analytic solution in each case .",
    "when the directionally - split advection substeps described in section  [ sec : transport ] are applied in the same order each timestep , the splitting leads to a systematic delay in transport along the first axis , and an advance in transport along the second axis . as a test of this effect ,",
    "the source terms were switched off , and a circular region of increased radiation energy density initially at the center of the domain was carried twice diagonally across a grid of @xmath160 zones with periodic boundaries .",
    "about 2000 timesteps were taken , and the advection substeps were applied always in the order 1 , 2 . at the end of this calculation ,",
    "the centroid of the region lay off the grid diagonal by 0.02 zones along each axis .",
    "when the calculation was repeated with the order of the substeps reversed each timestep , the centroid remained within @xmath161  zones of the diagonal .",
    "we have chosen to reverse the order of advection each timestep in all further calculations discussed in this article , in order to minimize the effects of the directional splitting of the transport terms .",
    "waves in a radiating fluid may be damped by escape of photons .",
    "damping is often rapid for oscillations with frequency near the rate at which material cools by radiating , and also for oscillations with wavelength near the distance radiation diffuses in a wave period .",
    "mihalas & mihalas ( 1983 ) obtained a linear dispersion relation for radiation and acoustic plane waves , driven by a boundary into a uniform medium with opacity due to absorption .",
    "they made the eddington approximation , and assumed a uniform background in thermal equilibrium .",
    "the coefficients of the dispersion relation may be specified by two dimensionless parameters .",
    "the boltzmann number @xmath162 is a ratio of typical rates of energy transport due to material advection and radiation in the background state , and @xmath163 fixes the ratio of the energy densities . in these definitions",
    ", @xmath115 is the index in the equation of state and @xmath164 is the adiabatic sound speed . for the tests discussed below , @xmath165 and @xmath166 .",
    "three frequencies are considered , selected for optical depth per wavelength @xmath167 , unity , and 1000 .",
    "the first of these frequencies is near the radiative cooling rate , and the last mode has wavelength near the radiative diffusion distance . in the test calculations , absorption opacity is set to 0.4  @xmath168  g@xmath169 times the density .",
    "the domain is initially stationary and uniform , and the chosen @xmath170 and @xmath171 correspond to density @xmath172  g  @xmath153 , gas energy density 26020  erg  @xmath153 , and radiation energy density 17340  erg  @xmath153 .",
    "a region one wavelength long at the left of the domain is updated each timestep with the time and space variation found from the linear analysis .",
    "a wave propagates to the right from this driving region .",
    "late - time results for waves of the three optical depths are shown in figures  [ fig : taum3 ] to  [ fig : taup3 ] .",
    "there are ten zones per wavelength in each case .",
    "timesteps were chosen according to the courant condition of  [ sec : dt ] for the calculations in the left - hand panel of each figure . the resulting steps , though having courant numbers of 0.5 , are longer than the time @xmath173 for radiation to diffuse across a zone .",
    "the fully - implicit method used remains stable for these long timesteps , but loses accuracy , and the waves are damped more strongly than expected .",
    "similar damping occurs when the eddington approximation is made , indicating the effect is not due to the explicit differencing of the radiation diffusion coefficient in equation  ( [ eqn : delfluxdifferencing ] ) . in the right - hand panels of figures  [ fig : taum3 ] to  [ fig : taup3 ] are results from calculations in which the timesteps were reduced so the method adequately reproduced the linear analytic results .",
    "the wavelengths obtained are one to two percent shorter than the predicted wavelengths .",
    "similar agreement with the linear predictions was observed for @xmath174 and @xmath175 .      in optically - thin regions , changes in",
    "radiation energy density propagate at the speed of light . to examine",
    "how well the method follows such changes , a domain 1  cm long is placed in thermal equilibrium with a radiation energy density of @xmath176  erg  @xmath153 .",
    "the mass density is set to 0.025  g  @xmath153 and the opacity to 0.4  @xmath168  g@xmath169 , so optical depth across the domain is 0.01 .",
    "one hundred grid zones are used . at time @xmath159",
    ", the radiation energy density in zones to the left of @xmath177 is raised to unity , and the increase is allowed to propagate to the right .",
    "the left - hand boundary condition is inflow , the right - hand outflow .",
    "results using the lp flux limiter and scattering opacity are shown in figure  [ fig : front ] .",
    "the front moves at approximately the speed of light .",
    "it is spread over a large number of zones , indicating the method is quite diffusive in this situation . for problems in which details of such fronts are important",
    ", it may be better to solve the time - dependent transfer equation using steps set by the radiation flow time .",
    "with timesteps longer than @xmath178 , the front is wider still , however the method remains stable .",
    "the width is less when the diffusion coefficients are recalculated every diffusion substep , rather than once per hydrodynamic timestep . where the leading edge of the front reaches the end of the grid , a region of uniform lower radiation energy density is seen .",
    "the effect is greatest when the timestep is long and the front is broad , as in the curve shown by dots on the bottom panel of figure  [ fig : front ] .",
    "radiation energy accumulates in this region because the boundary condition @xmath93 forces the radiative flux to zero at the boundary .",
    "other conditions on radiation energy density which may be appropriate across outflow boundaries are fixed values of @xmath12 , and @xmath179 .",
    "the off - diagonal components of the eddington tensor ( equation  ( [ eqn : eddfactor ] ) ) may be non - zero in radiation fronts inclined with respect to the coordinate axes . as a test of the method in such a situation , the domain used in the one - dimensional radiation front calculation",
    "is expanded to a 1  cm square of @xmath180  zones .",
    "the high radiation energy density is placed initially in zones within 0.1  cm of grid center .",
    "the boundaries are made periodic in both directions , and the timestep is fixed at @xmath181 .",
    "the distribution of radiation after @xmath157 seconds is shown in figure  [ fig : front2d ] .",
    "the lowest contours on the figure are non - circular .",
    "after the leading edge of the front reaches the midpoints of the grid boundaries , the gradient in radiation energy density there is directed along the boundaries , rather than away from grid center . since in the fld approximation the flux is assumed parallel to @xmath182 , an incorrect result is obtained in these regions .",
    "a similar error will result in fld calculations whenever inclined radiation fronts meet .",
    "after the front has passed the corners of the grid , at @xmath183  sec , total energy differs from that at the start of the calculation by about one part in @xmath184 , indicating that energy is conserved to high precision in this instance .",
    "the structure of a shock in radiating fluid is sometimes altered by photons propagating upstream to preheat approaching material .",
    "if material reaching the shock front remains cooler than the shocked gas , the shock is termed subcritical , and the main effect is a slightly raised post - shock temperature , which declines downstream as radiation is emitted upstream . in stronger , supercritical shocks , upstream material",
    "is heated almost to the temperature of the post - shock gas , and material immediately upstream is in thermal equilibrium with the radiation emitted through the front .",
    "gas reaching the front then overshoots the final temperature significantly , and cools to the post - shock temperature by radiating from a layer with optical depth less than unity . in this section",
    "we compare structures calculated for subcritical and supercritical shocks against analytic estimates by zeldovich & raizer ( 1967 ) , and numerical results obtained by sincell , gehmeyr , & mihalas ( 1999 ) using a radiation hydrodynamics code with adaptive refinement of a one - dimensional grid .",
    "the problem is set up as by sincell et al .",
    "the gas is given absorption opacity 0.4  @xmath168  g@xmath169 , mean molecular weight 0.5 , and uniform density @xmath185  g  @xmath153 .",
    "gas temperature @xmath186  @xmath187  k increases linearly with distance @xmath129 from the origin , and the radiation energy density is chosen for equilibrium .",
    "grid spacing is set to @xmath188  cm , so initially the optical depth per zone is 0.044 . a piston moves into the gas from the origin at uniform speed , and shocked material accumulates in front of the piston .",
    "results for a subcritical shock , with piston speed 6  km  s@xmath169 , are shown in figure  [ fig : subcritical ] .",
    "the time is @xmath32 seconds .",
    "temperature declines from the post - shock maximum more rapidly than expected , and the flux is too large in several zones downstream from the front .",
    "these effects may be due to an incorrect angular distribution of specific intensity .",
    "they are similar when the numerical resolution is doubled , suggesting they are not due to the finite optical depth of the front imposed by the artificial hydrodynamic viscosity .",
    "sincell et al .",
    "( 1999 ) found , by directly solving the transfer equation , that the eddington factor near the shock front is slightly less than @xmath189 because the emitting layer has greatest line - of - sight optical depth when seen at grazing angles . in the fld approximation ,",
    "angular variation is assumed to be either smooth ( lp , eq .",
    "[ [ eqn : lpangular ] ] ) or stepwise ( minerbo ) , and this feature is missed .",
    "upstream , flux is higher with the lp than with the minerbo flux limiter . as may be seen from figure  [ fig : limiters ] , the flux is reduced below the eddington value at larger optical depths with the minerbo limiter .",
    "the structure calculated for a supercritical shock with piston speed 16  km  s@xmath169 is shown in figure  [ fig : supercritical ] .",
    "the time is again @xmath32 seconds .",
    "the temperature spike at @xmath190 is about one - fifth as tall as found by sincell et al .",
    "( 1999 ) , and about five times as wide , due to the limited spatial resolution .",
    "the peak temperature in the spike is 314  k above the downstream temperature @xmath191 , whereas zeldovich & raizer estimate that the spike amplitude is @xmath192  k. with spatial resolution doubled , the spike is narrower and its height is larger at 506  k. the feature has approximately the expected degree of asymmetry , extending to a larger optical depth downstream than upstream . the flux in the equilibrium preheated region is slightly overestimated , but away from the front varies with optical depth in a manner close to that predicted by zeldovich & raizer ( 1967 ) .",
    "the flux upstream from the equilibrium region depends on the choice of limiter , with the minerbo limiter producing smaller flux and lower eddington factor , as in the subcritical case .    in both subcritical and supercritical shock calculations ,",
    "the outcome is independent of the timestep for steps smaller than about ten zone radiation diffusion times @xmath150 .",
    "we conclude from these results that on a uniformly spaced grid , the fld approximation is a poor choice for determining detailed structure of shocks of intermediate optical depth",
    ". it may be sufficiently accurate for multi - dimensional calculations in which such shocks must be followed approximately as part of a more complex flow .",
    "if material upstream and downstream from a radiating shock have sufficient optical depth , radiation is trapped near the interface , diffusing a limited distance upstream . in this section",
    "we examine whether the code adequately matches the jump conditions and thickness of such a shock .",
    "parameters are chosen so the energy density is mostly in the gas upstream and in the radiation downstream .",
    "opacity is assumed to be due to absorption as in  [ sec : critical ] , and material and radiation are assumed to be in thermal equilibrium far from the shock .",
    "initially , the left of the grid is set to density 0.01  g  @xmath153 , temperature @xmath32  k , and speed @xmath193  cm  s@xmath169 , yielding a mach number of 658 .",
    "the right is set to density 0.0685847  g  @xmath153 , temperature @xmath194  k , and speed @xmath195  cm  s@xmath169 , as computed from the jump conditions .",
    "the boundary conditions are inflow on the left , and outflow on the right . after a brief transient ,",
    "a steady shock is established .",
    "the situation after 50 flow crossing times is shown in figure  [ fig : raddomshock ] .",
    "the approximate expected thickness of the shock is the distance @xmath196 for which the time to diffuse upstream , @xmath197 , matches the time to sweep downstream , @xmath198 ( mihalas & mihalas 1984 ) . here",
    "@xmath38 is the radiation diffusion coefficient and @xmath199 the upstream gas speed .",
    "the shock thickness obtained in the calculation is consistent with the resulting estimate of 7500  cm .",
    "the values downstream in the calculation differ by a maximum of 1.0% from those predicted using the jump conditions .",
    "when zone spacing is decreased a factor four , the discrepancies are reduced to 0.2% , indicating that mass , momentum , and energy are adequately conserved in material passing through the shock .",
    "we have described a set of subroutines which may be used with the zeus-2d magnetohydrodynamics code for radiation mhd calculations in the flux - limited diffusion approximation .",
    "results were obtained typically in three to ten times more floating - point operations per timestep than required for similar calculations without radiation , with the greater number needed in the optically - thin tests .",
    "the primary limitation of flux - limited diffusion is that the flux is not evolved as an independent variable , but is assumed anti - parallel to the gradient in radiation energy density .",
    "this is incorrect in flows where shadows are cast or inclined radiation fronts cross .",
    "the incorporation in the flux limiter of a specified angular dependence for the radiation field has greatest effect in regions of intermediate to low optical depth , and may contribute to the broadening of radiation fronts .",
    "flux limiters derived for angular dependences occurring in particular applications may be useful in obtaining more accurate solutions",
    ".    the limitations of fld revealed in the tests mean that care must be taken in applying the module to problems with highly anisotropic radiation fields in optically thin regions . in such cases , full transport methods",
    "may be more appropriate .",
    "however , in optically thick flows , fld is more efficient .",
    "the module has proven useful in studies of the internal dynamics of optically thick , radiation - dominated accretion disks ( agol et al . 2001 ; turner & stone 2001 ) .",
    "although the method remains stable for long timesteps , it shares with other implicit schemes the property that fluctuations with periods less than the timestep may be rapidly and unphysically damped , as seen in the linear wave and sub- and supercritical shock tests . when the diffusion timestep constraint of  [ sec : dt ] is violated , it is advisable to check that results are independent of the timestep .",
    "the radiation terms included in the equations solved are those of order unity in @xmath0 in at least one of the free - streaming , static diffusion , and dynamic diffusion regimes ( mihalas & mihalas 1984 ; stone , mihalas , & norman 1992 ) . adding higher - order terms would allow study of special relativistic effects such as radiation drag and photon viscosity . in the implementation described here , the radiation source terms",
    "are operator - split , with the flux divergence term evolved separately from the remainder .",
    "linear waves and shocks to which both groups of terms contribute were evolved adequately , but situations may be encountered where the operator splitting leads to inaccuracies .",
    "we have assumed the gas is in local thermodynamic equilibrium , and relaxing this assumption may in the future allow a great variety of additional problems to be addressed .    financial support of this work from the united states department of energy is gratefully acknowledged .",
    "we thank eric agol and julian krolik for their contributions to the tests of the module , and the anonymous referee for helpful comments on the presentation and the importance of the matrix condition numbers ."
  ],
  "abstract_text": [
    "<S> a module for the zeus-2d code is described which may be used to solve the equations of radiation hydrodynamics to order unity in @xmath0 , in the flux - limited diffusion ( fld ) approximation . in this approximation , </S>",
    "<S> the tensor eddington factor @xmath1 which closes the radiation moment equations is chosen to be an empirical function of the radiation energy density . </S>",
    "<S> this is easier to implement and faster than full - transport techniques , in which @xmath1 is computed by solving the transfer equation . </S>",
    "<S> however , fld is less accurate when the flux has a component perpendicular to the gradient in radiation energy density , and in optically thin regions when the radiation field depends strongly on angle .    </S>",
    "<S> the material component of the fluid is here assumed to be in local thermodynamic equilibrium . </S>",
    "<S> the energy equations are operator - split , with transport terms , radiation diffusion term , and other source terms evolved separately . </S>",
    "<S> transport terms are applied using the same consistent transport algorithm as in zeus-2d . </S>",
    "<S> the radiation diffusion term is updated using an alternating - direction implicit method with convergence checking . </S>",
    "<S> remaining source terms are advanced together implicitly using numerical root - finding . </S>",
    "<S> however when absorption opacity is zero , accuracy is improved by instead treating the compression and expansion source terms using a time - centered differencing scheme .    </S>",
    "<S> results are discussed for test problems including radiation - damped linear waves , radiation fronts propagating in optically - thin media , subcritical and supercritical radiating shocks , and an optically - thick shock in which radiation dominates downstream pressure . </S>"
  ]
}