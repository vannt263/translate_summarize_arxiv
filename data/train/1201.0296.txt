{
  "article_text": [
    "mathematical modelling has proven a valuable tool when addressing public health issues .",
    "the increase in availability of powerful computer resources has facilitated the use of agent - based models and other complex modelling approaches , all accounting for numerous parameters and assumptions @xcite .",
    "our confidence in these models may increase when they are shown to agree with empirical observations and/or with previously accepted models .",
    "however , when discrepancies appear , the complexity of these computer programs may obfuscate the effect of underlying assumptions , making it difficult to isolate the source of disagreement .",
    "while analytical approaches offer more insights on the underlying assumptions , their use is often restricted to simpler interaction structures and/or dynamics .",
    "the purpose of this paper is to systematically model the global behaviour of stochastic systems composed of numerous elements interacting in a complex way .",
    "`` complex '' here implies that interactions among the elements follow some nontrivial patterns that are neither perfectly regular nor completely random , as often seen in real - world systems .",
    "`` stochastic '' implies that the system may not be completely predictable to us and that a probabilistic solution is sought .    to this end",
    ", we present ( sec .",
    "[ section : generalmodelingscheme ] ) a general modelling scheme where network theory @xcite accounts for the interactions between the elements of the system and where a birth - death markov process @xcite models the stochastic dynamics . since a tremendous amount of information may be required to store the state of the whole system , we seek the part of this information that is important for the problem at hand and then approximate the dynamics by tracking only this limited subset .",
    "part of the discarded data may still affect , albeit weakly , the behaviour of the system .",
    "we fill this knowledge gap by inferring the missing information such that it is consistent both with the information we follow and any other prior information that is available to us .    an important part of this paper ( sec",
    ".  [ section : application ] ) provides explicit examples to these general ideas . for simplicity ,",
    "each case either corresponds to a susceptible - infectious - susceptible ( sis ) or to a susceptible - infectious - removed ( sir ) spreading processes , both standards in the study of infectious diseases propagation .",
    "while our first examples study simpler cases , facilitating the understanding of our systematic method , the later models show how the same approach applies to more complex interaction structures .",
    "we then compare and analyse the results of these examples ( sec .",
    "[ section : discussion ] ) .",
    "this reveals some general considerations for both the accuracy and the complexity of our modelling approach .",
    "we find that treating the inferences of missing information explicitly helps systematize the model development and highlights numerous possibilities for future developments .",
    "an important simplification occurs for sir spreading processes and related dynamics , leading to an _ exact _ model with a small number of dynamical variables .",
    "we conclude ( sec .",
    "[ conclusion ] ) on how our general approach may be applied beyond spreading processes , for example , population dynamics . returning to the problem of understanding the source of discrepancies in complex models , we explain how _ modelling these models _ with our method could help identifying important assumptions and isolating the source of disagreement . mathematical details and further generalizations",
    "are also presented in an electronic supplementary material ( esm ) @xcite .",
    "we assume that the real - world system to be modelled is sufficiently well understood to implement a monte carlo computer simulation that approximately reproduces its behaviour .",
    "we refer to this hypothetical computer simulation as the _ full system _ : @xmath0 denotes the _ state _ of the full system ( _ i.e. _ , all the data that would be stored by the computer program ) while @xmath1 denotes the _ rules _ governing the evolution of @xmath0 in time ( _ i.e. _ , the program itself ) .    however , there are many situations where a direct implementation of the full system is impractical due to storage and/or computation considerations .",
    "we thus design a _ simplified system _ that aims at reproducing the behaviour of the full one , while requiring less resources .",
    "the state @xmath2 of this simplified system ( _ much _ smaller than @xmath0 ) evolves in time according to the rules @xmath3 .",
    "moreover , we note @xmath4 any known _ prior information _ that is relevant in a bayesian inference of @xmath0 @xmath5 this last point is crucial : @xmath4 often makes the difference between an accurate model and a useless one .",
    "it bridges the gap between the simplified representation of the state of the system ( _ i.e. _ , @xmath2 ) and the full one ( _ i.e. _ , @xmath0 ) .",
    "since we are interested in systems composed of many elements interacting through complex patterns , we express the previous quantities in terms of networks .",
    "a _ network _ ( graph ) is a collection of _ nodes _ ( vertices ) and _ links _ ( edges ) .",
    "nodes model the elements of a system ; links join nodes pairwise to represent interactions between the corresponding elements . two nodes sharing a link",
    "are said to be _ neighbours _ and the _ degree _ of a node is its number of neighbours . the part of a link that is attached to a node is called a _ stub _ : there are two stubs per link and each node is attached to a number of stubs equal to its degree . a link with both ends leading to the same node",
    "is called a _ self - loop _ and _ repeated links _ occur when more than one link join the same two nodes",
    ".    there may be systems such that specifying its state @xmath0 exactly amounts to specifying the network structure .",
    "however , most systems are not purely structural : they are composed of elements that , by themselves , require additional information to be properly characterized .",
    "hence , we assign to each node a _ node state _ that specifies the intrinsic properties of the corresponding element in the system . both the structure and these intrinsic node states",
    "are specified by @xmath0 ; see esm @xcite",
    "i  for further examples of information that may be contained in @xmath0 , including the important case of directed networks .      specifying the complete structure of a complex network requires a tremendous amount of information .",
    "since we want the state @xmath2 of a simplified system to be of manageable size , approximations have to be made . a convenient way to do so , and one that has proven to give good results in the past @xcite , is to specify the network structure through its building blocks .",
    "a network _ motif _ is a pattern that may appear a number of times in the network .",
    "for example , two linked nodes form a _ pair motif _ while three nodes all neighbours of one another form a _ triangle motif_. motifs may encode intrinsic node states or other relevant information ; further details and examples are provided throughout section  [ section : application ] as well as in esm @xcite ii .",
    "we define the _ state vector _ @xmath6 of a system as a vector of integers specifying how many times different motifs appear in the network . these motifs may be attached together to form a network structure : the state vector @xmath7 enumerates the available building blocks while the prior information @xmath4 specifies how such blocks may be attached .",
    "there will usually be numerous valid ways to attach the blocks , some more probable than others .",
    "given the available information , the resulting distribution is our best estimate for @xmath8 .    by judiciously choosing the motifs enumerated in @xmath6 and by specifying informative prior information @xmath4 , one may hope for this probability distribution to be densely localized around the `` real '' value of @xmath0 in the full system .",
    "this mapping can then be used to convert the rules @xmath1 of the full system to the rules @xmath3 of the new simplified one .",
    "we approach this problem from the perspective of birth - death markov processes .      in a _ birth - death _ process",
    ", the elements composing a system may be destroyed ( death ) while new ones may be created ( birth ) .",
    "it is therefore natural to state the rules @xmath3 of our simplified system in those terms : any change in the state vector @xmath6 may be perceived as an event where motifs are created and/or destroyed .",
    "quantitatively , a _",
    "forward transition event of type @xmath9 _ takes the system from state @xmath6 to state @xmath10 and has probability @xmath11 to occur during the time interval @xmath12 .",
    "similarly , a _ backward transition event of type @xmath9 _ takes the system from state @xmath6 to state @xmath13 and has probability @xmath14 to occur during the same time interval .",
    "specifying for each @xmath9 the elements @xmath15 of the _ shift vector _",
    "@xmath16 together with the _ rate functions _ @xmath17 and",
    "@xmath18 thus completely define the rules @xmath3 governing the simplified system .",
    "this markov process is summarized in the master equation @xmath19 \\nonumber\\end{aligned}\\ ] ] specifying the evolution of the probability @xmath20 to observe state @xmath6 at time @xmath21 ( notation compatible with @xcite 7.5 ) .",
    "we now consider two approximations that are often justified for large systems : the elements of @xmath6 may be treated as varying continuously and the probability distribution is strongly concentrated around its mean value . in such cases , the evolution of the mean value @xmath22 for the vector @xmath6 at time",
    "@xmath21 is approximately given by    @xmath23 \\label{eq : approxmean : a}\\end{gathered}\\ ] ]    [ eq : approxmean ]    where we defined the _ drift vector _ @xmath24 of elements @xmath25 ( see @xcite 7.5.3 and 4.4.9 ) .    in order to further refine our knowledge of @xmath20 in the vicinity of this deterministic solution",
    ", we define the _ evolution matrix _ @xmath26 , the _ diffusion matrix _",
    "@xmath28of elements @xmath29@xmath30and the _ covariance matrix",
    "_ @xmath31    [ eq : gaussianapprox ] @xmath32 \\\\    b_{ii'}({\\mathbf{x } } ) & = \\sum_j r_i^j r_{i'}^j \\bigl [ { q_{j}^+\\!\\left({{\\mathbf{x}}},{y}\\right ) } + { q_{j}^-\\!\\left({{\\mathbf{x}}},{y}\\right ) } \\bigr ] \\\\    { c}(t ) & = \\int_0^t { a}(t , t ' ) \\cdot { b}\\bigl ( { \\boldsymbol{\\mu}}(t ' ) \\bigr ) \\cdot { a}(t , t')^t dt'\\end{aligned}\\ ] ]    where @xmath33 is the jacobian matrix of @xmath34 evaluated at @xmath6 .",
    "noting @xmath35 the size of the vector @xmath6 , the probability distribution may be approximated by a @xmath35-dimensional gaussian @xmath36^t \\ ! \\ ! \\",
    "! \\cdot \\ ! { c}(t)^{-1 } \\",
    "! \\cdot \\ !",
    "\\bigl[{\\mathbf{x}}(t ) - { \\boldsymbol{\\mu}}(t ) \\bigr ] \\ !",
    "\\right\\ } } { \\sqrt{(2\\pi)^d \\bigl\\lvert { c}(t ) \\bigr\\rvert } } \\label{eq : dgaussian}\\ ] ] where @xmath37 is the determinant of @xmath31 .",
    "note that ",
    "are all textbook relationships .",
    "although many other tools are available for the analysis of stochastic systems , the simplicity , the generality and the straightforwardness of the gaussian approximation make it an instrument of choice that will be used extensively in this article .",
    "without prejudice to the generality of section  [ section : generalmodelingscheme ] , we now focus our study to spreading processes @xcite .",
    "an epidemiological terminology is used : whatever propagates among neighbouring nodes , be it desirable or not , is called an _ infection_.",
    "we find that the basic sis and sir epidemiological models , both to be defined shortly , require little prior knowledge from the part of the reader while being sufficiently complex for the needs of the present study .    at a given time",
    ", the intrinsic state of each node of an _ sis model _ may either be _ susceptible _ ( not carrying the infection ) or _ infectious _",
    "( carrying the infection ) .",
    "the full system state @xmath0 hence specifies each node s intrinsic state together with the complete structure of the network .",
    "the rules @xmath1 are simple : during any time interval @xmath12 , each infectious node may recover ( _ i.e. _ , it becomes susceptible ) with probability @xmath38 and , for each of its susceptible neighbours , has probability @xmath39 to transmit the infection ( _ i.e. _ , the neighbour becomes infectious ) .",
    "in addition to the susceptible and infectious intrinsic states , the nodes of an _ sir model _ may also be _ removed _ ( once had the infection and can neither acquire nor transmit it ever again ) .",
    "the rules @xmath1 are the same than for the sis model with respect to infection ( _ i.e. _ , infectious nodes transmit to their susceptible neighbour with probability @xmath39 ) , but recovery is replaced by removal ( _ i.e. _ , infectious nodes become removed with probability @xmath38 ) .",
    "the remainder of this section studies how different choices of state vector @xmath6 and prior information @xmath4 translate in the rules @xmath3 of the simplified system . in each case",
    ", @xmath3 is defined through a set of equations whose tags all share the same numeral , _",
    "e.g. _ , . although figures present results concomitantly with the specification of the corresponding models , all discussions are delayed to section  [ section : discussion ] .",
    "section  [ subsection : motifs ] defined a pair motif as two linked nodes . since the nodes of a sis model are either susceptible or infectious , there are three possibilities for pair motifs : two linked susceptible nodes ( noted @xmath40 ) , two linked infectious nodes ( noted @xmath41 ) and a susceptible node linked to an infectious one ( noted @xmath42 ) .",
    "two nodes involved in a pair motif may have other neighbours .",
    "pair motifs are often used in conjunction with _ node motifs _ : the trivial structure that is one node . in the sis model",
    ", there are two possibilities for a node motif : susceptible nodes ( noted @xmath43 ) and infectious nodes ( noted @xmath44 ) . a state vector @xmath6 based on both node and pair motifs",
    "would thus be composed of five elements enumerating the amount of times each motif appears in the network : @xmath45 , @xmath46 , @xmath47 , @xmath48 and @xmath49 . however",
    ", additional assumptions about the structure of the network may cause some of these quantities to be redundant .",
    "we first consider the simple case where the network is known to be a _ @xmath50-regular network _ of size @xmath51 : there are @xmath51 nodes in the network which all have @xmath50 neighbours ( degree @xmath50 ) . such a network must respect the structural constraints @xmath52 , @xmath53 and @xmath54 .",
    "hence , with the prior information @xmath4 specifying @xmath51 and @xmath50 , the state vector    [ eq : sispairregular ] @xmath55 suffices to obtain all the five node and pair motifs .    in those terms , the rules @xmath1 specify that an infection has probability @xmath56 to occur during the time interval @xmath12 while a recovery has probability @xmath57 to occur .",
    "clearly , an infection translates to the destruction of a @xmath43 motif and the creation of a new @xmath44 one , and a recovery corresponds to the inverse process . however , pair motifs are also affected by such transitions since the affected node had neighbours .",
    "hence , the effect on @xmath6 of the infection or recovery of a node depends on some information that is not directly tracked by @xmath6  _ i.e. _ , what is the state of the infected or recovered node s neighbours  and we thus have to _ infer _ this information from the available data .    in order to facilitate this inference , we define the _ first neighbourhood motif _ @xmath58 as a susceptible node that has @xmath59 susceptible neighbours and @xmath60 infectious neighbours .",
    "similarly , the motif @xmath61 corresponds to an infectious node with @xmath59 susceptible neighbours and @xmath60 infectious ones . in both cases",
    ", we qualify as _ central _ the node whose neighbours are explicitly stated .",
    "the other nodes of the first neighbourhood motif , _ i.e. _ , the neighbours of the central node , may have other neighbours of their own .",
    "we can now define a forward transition event of type @xmath62 as the infection of the central node of a @xmath63 motif . in terms of node and pair motifs , this implies the destruction of one of the @xmath43 motifs , of @xmath64 of the @xmath47 motifs and of @xmath9 of the @xmath48 motifs together with the creation of one new @xmath44 motif , of @xmath64 new @xmath48 motifs and of @xmath9 new @xmath49 motifs . since only @xmath46 and @xmath48 are tracked , the shift vectors are @xmath65 this same vector also defines the backward transition events @xmath62 which correspond to the recovery of the central node of a @xmath66 motif .    looking back at the rules @xmath1 , the corresponding forward and backward transition rate functions are @xmath67 where two inference terms have been defined .",
    "the inference term of gives the probability for a motif to be a @xmath66 knowing that it has an infectious node at its center and that the current state vector is @xmath6 with prior information @xmath4 . for a sufficiently large network",
    ", this approximately corresponds to randomly drawing the @xmath50 neighbours of the central infectious node among the pair motifs @xmath42 and @xmath41 @xmath68 the inference term of is very similar except that the central susceptible node is known to have at least one infectious neighbours since it acquired the infection through a @xmath42 motif @xmath69    which complete the rules @xmath3 for the pair - based sis model on a @xmath50-regular network of size @xmath51 .    ) outcomes as predicted by the sis model on regular network using the approximations . the axes ( proportion of @xmath44 among node motifs _ vs _ proportion of @xmath42 among pair motifs ) ,",
    "network structure ( @xmath70 nodes , each of degree @xmath71 ) and parameters ( @xmath72 in @xcite ( noted @xmath73 ) is a typo . ] and @xmath74 ) are the same as for fig .",
    "2(c ) from @xcite .",
    "frequencies ( in percent ) are used to facilitate comparison with @xcite ; they are simply obtained from the probability densities of multiplied by @xmath75 .",
    "[ fig : sispairregular : dist ] ]     for sis dynamics ( @xmath76 and @xmath77 ) on a regular network of @xmath78 nodes ( @xmath79 initially infectious ) of degree @xmath71 .",
    "curves : results for the simplified system approximated with . the continuous curve shows the mean value while the dashed curves delimit the range of one standard deviation above and below the mean .",
    "symbols : averaged results of @xmath80 numerical simulations of the full system .",
    "the parameters @xmath81 and @xmath82 correspond to those of fig .",
    "[ fig : sispairregular : dist ] after rescaling the time unit .",
    "[ fig : sispairregular : time ] ]    .",
    "all parameters are the same as in fig .",
    "[ fig : sispairregular : time ] .",
    "curves : gaussian approximation for the simplified system .",
    "symbols : binned results of @xmath80 numerical simulations of the full system .",
    "[ fig : sispairregular : timeslices ] ]    figure  [ fig : sispairregular : time ] compares the results produced by this simplified model ( defined by @xmath3 , @xmath6 and @xmath4 ) to the corresponding full one ( defined by @xmath1 and @xmath0 ) .",
    "figure  [ fig : sispairregular : timeslices ] shows the probability distribution for the same data .",
    "note that , although presented differently , this model corresponds to the one presented in @xcite ; fig .",
    "[ fig : sispairregular : dist ] is provided for comparison with fig .",
    "2(c ) of @xcite .",
    "we now consider the case where the network is an erds - rnyi network : there are @xmath51 nodes in the networks and @xmath83 links are randomly assigned .",
    "this knowledge constrains two of the five node and pair motifs ( _ i.e. _ , @xmath52 and @xmath84 ) and a state vector of three elements suffices    [ eq : sispairer ] @xmath85    the method used in section  [ subsubsection : degreeregular ] has to be adapted since the degree of each node is not constrained to a single value .",
    "indeed , a susceptible node that gets infected may _ a priori _ be the center of any of the @xmath58 motifs .",
    "still , we could design a bijective mapping between the vector of integers @xmath86 and an event type @xmath9 .",
    "the details of the chosen mapping do not matter : we simply define the forward transition event of type @xmath87 as the infection of the central node of a @xmath58 motif , which may conveniently be noted @xmath88 instead .",
    "similarly , the backward transition event of type @xmath87 is defined as the recovery of the central node to a @xmath89 motif .",
    "the corresponding shift vector and rate functions are @xmath90 where the inference terms bear the same meaning as their previous counterpart . again assuming large network size , these inference terms are obtained by evaluating the probability for each pair motif to include the considered node .",
    "hence , the products of binomial distributions @xmath91    complete the rules @xmath3 for the pair - based sis model on a erds - rnyi network of size @xmath51 with @xmath83 links .     for sis dynamics ( @xmath76 and @xmath77 ) on an erds - rnyi network of @xmath78 nodes ( @xmath79 initially infectious ) and @xmath92 links .",
    "the mean and range of one standard deviation above and bellow the mean are shown .",
    "curves : simplified system .",
    "symbols : full system ( @xmath80 simulations ) .",
    "[ fig : sispairer : time ] ]    figure  [ fig : sispairer : time ] compares the results produced by this simplified model to the corresponding full one . section  [ subsection : discussion : pair ] discusses these results and provides further details concerning pair - based models .",
    "we consider a full model ( @xmath1 and @xmath0 ) for sis dynamics on a _ configuration model _",
    "( cm ) network : given a sequence @xmath93 , links are randomly assigned between nodes such that , for each degree @xmath94 , there are @xmath95 nodes of degree @xmath94 . in a computer simulation , we create @xmath95 nodes with @xmath94 stubs for each possible @xmath94 and then randomly pair stubs to form links .",
    "no particular mechanism is used to prevent the formation of repeated links and self - loops : this simplifies the analytical treatment and has little effect when the network size is sufficiently large .",
    "our simplified model handles the heterogeneity in node degree by enumerating every possible first neighbourhood motifs in its state vector    [ eq : sisfirst ] @xmath96 although this vector should be infinite in the general case , it is not the case when , _",
    "e.g. _ , the prior information @xmath4 states that no node has a degree superior to @xmath97 .",
    "for the same reasons that models tracking node and pair motifs ( section  [ subsection : pairsis ] ) had their transition events defined in terms of first neighbourhood motifs , the transition events are here defined in terms of _ second neighbourhood motifs _ : a central node , its neighbours and the neighbours of those neighbours . in the same way that we note @xmath98 the first neighbourhood motif formed by a state @xmath99 central node with neighbourhood specified by @xmath87",
    ", we note @xmath100 the second neighbourhood motif formed by a state @xmath99 central node with neighbourhood specified by @xmath101 .    the elements of @xmath101 may be indexed with first neighbourhood motifs : the central node has @xmath102 state @xmath103 neighbours whose other neighbours ( _ i.e. _ , excluding the central node ) are specified by @xmath104 .",
    "hence , the second neighbourhood motif        is noted @xmath105 with all elements of @xmath101 zero except for @xmath106 , @xmath107 and @xmath108 . note that the central node of this second neighbourhood motif is also the central node of the first neighbourhood motif @xmath109 . in general , we note @xmath110 the first neighbourhood motif that shares the same central node as the second neighbourhood motif @xmath100 .    we digress",
    "further to introduce the _ unit vector _",
    "notation @xmath111 where @xmath112 represents a motif ; all the elements of this vector are zero except for the @xmath112-th , which is one",
    ". the total number of elements in @xmath111 should be clear from the context . as a concrete example , the right hand side of could be noted @xmath113 .    similarly to section  [ subsubsection : sispairer ] , we define the forward transition event of type @xmath101 to be the infection of the central node of a @xmath105 motif and the backward transition event of type @xmath101 as the recovery of the central node of a @xmath114 motif .",
    "the corresponding shift vector is @xmath115 the first line shows the direct effect of a change of state in the central node while the second one handles the `` collateral effect '' on its immediate neighbours . here",
    "the unit vector @xmath116 has the same dimension as @xmath87 ( _ i.e. _ , two ) while @xmath117 has the same dimension as @xmath6 .",
    "sums are taken over all the accessible values of @xmath99 and @xmath87 .",
    "the corresponding rate functions are @xmath118 note that , unlike  and  , the inference terms in  have the same form : the probability for a motif to be a @xmath100 knowing ( in addition to @xmath6 and @xmath4 ) that its central node is also the central node of a @xmath110 motif . again assuming a large network size , they are provided by a product of multinomial distributions @xmath119    which complete the rules @xmath3 for the first neighbourhood sis model .     and",
    "@xmath77 ) on a cm network for which the number of nodes of each degree is prescribed by the sequence @xmath120 ( total @xmath78 nodes ) with @xmath121 of the nodes of each degree initially infectious . the mean and range of one standard deviation above and bellow the mean are shown .",
    "curves : simplified system .",
    "symbols : full system ( @xmath80 simulations ) .",
    "[ fig : sisfirst : time ] ]    figure  [ fig : sisfirst : time ] compares the results produced by this simplified model and the full one .",
    "note that this is a stochastic version of the model presented in @xcite , except that the network structure is here static .      as in sec .",
    "[ subsection : sisfirst ] , we consider a full network model where the network structure is specified solely by the degree of its nodes .",
    "however , this time we consider sir epidemiological dynamics : the accessible node states are @xmath122 , infection is the same as in sis but recovery is replaced by removal ( see the introduction of sec .  [ section : application ] for details ) .",
    "we define the forward transition event of type @xmath123 to be the @xmath124nfection of the central node of a @xmath105 motif while a forward transition event of type @xmath125 is the @xmath126emoval of the central node of a @xmath114 motif .",
    "there is no backward transition events .",
    "the model is specified by    [ eq : sirfirst ] @xmath127 @xmath128    where the inference terms are the same as in .      we take a different perspective to the problem considered in sec .  [",
    "subsection : sirfirst ] which requires to track much less elements in the state vector . instead of considering `` complete '' first neighbourhood motifs , such as @xmath98 , that specify the state of each of the central node s neighbours",
    ", we define the @xmath129 motif as a central node of state @xmath99 for which we know that it has @xmath94 neighbours _ unknown to us_. this last statement is important : were we to learn the state of one of these neighbours , this would cease to be a @xmath129 motif and instead become a @xmath130 one .",
    "as usual , the state vector tracks the number of such motifs    [ eq : sirotf ] @xmath131    we recall from sec .  [",
    "subsection : sisfirst ] how a cm network is built in a computer simulation : for each @xmath94 , @xmath95 nodes with @xmath94 stubs are created and the stubs are then randomly paired to form links .",
    "from this perspective , @xmath129 may be reinterpreted as a @xmath99 state node with @xmath94 unpaired stubs : as stubs are removed once they are paired in the computer simulation , neighbours that were unknown are removed from these motifs once they become known to us . hence , @xmath132 _ exactly _ gives the probability for an unknown neighbours of the central node of @xmath133 to be the central node of @xmath129 .",
    "note that the kronecker deltas @xmath28@xmath134 \\scriptstyle 0 & \\scriptstyle i \\neq i ' \\end{matrix } \\bigr.}$ ] @xmath30  in the numerator and the @xmath135 in the denominator both account for the stub of @xmath133 that we are pairing with a random stub .",
    "a typical computer simulation would first build the network and then perform the sir propagation dynamics on this network .",
    "however , we do not want to have to store the network structure for later consultation , which would require additional space in @xmath6 .",
    "instead , we delay the network construction , leaving the stubs unpaired , and start the propagation dynamics right away .",
    "just when the state of an unknown neighbour is required do we pair the corresponding stub with a randomly selected one , hence building the network _ on - the - fly_. since the knowledge of stubs being matched will be lost in the future , this information must only be required at the very moment it is obtained if we want the resulting dynamics to _ exactly _ reproduce the behaviour of the full system .",
    "we thus take a different , although equivalent , perspective on the infection dynamics where each link is `` probed '' at most once . instead of considering a probability @xmath39 of infection for each",
    "_ susceptible _ neighbours of infectious nodes , we consider the same probability for each of their _ unknown _ neighbours .",
    "only when this probability returns true do we wonder about the state of the neighbour , whose state changes to infectious if and only if it was previously susceptible . in any case , we learned who were the neighbours of two nodes ( _ i.e. _ , the infectious and its neighbour ) and we must update the state vector accordingly .",
    "hence , we define the @xmath124nfection transition event @xmath136 such that an infectious at the center of a @xmath137 motif attempts to infect the @xmath99-state node at the center of a @xmath129 motif .",
    "of course , only @xmath138 transition events result in real infections . the more traditional transition event @xmath139 corresponds to the @xmath126emoval of the infectious node at the center of a @xmath140 motif , thus becoming @xmath141 .",
    "the model is specified by @xmath142 @xmath143     and @xmath77 ) on a cm network for which the number of nodes of each degree is prescribed by the sequence @xmath120 ( total @xmath78 nodes ) with @xmath121 of the nodes of each degree initially infectious ( all others are susceptible ) .",
    "the mean and range of one standard deviation above and bellow the mean are shown .",
    "curves : simplified system .",
    "symbols : full system ( @xmath80 simulations ) .",
    "[ fig : sirotf : time ] ]    .",
    "curves : simplified system .",
    "symbols : full system ( @xmath80 simulations ) .",
    "[ fig : sirotf : timeslices ] ]    the system _ exactly _ reproduces the behaviour of the full system through the solution of . since  are only approximations of , results obtained through these relationships are only approximative ( fig .  [ fig : sirotf : time ] and fig .",
    "[ fig : sirotf : timeslices ] ) .",
    "this model may be solved analytically for the mean value ( see esm @xcite iii ) and the results are in agreement with @xcite . moreover , esm @xcite iv  shows how may be rewritten with a state vector two thirds the size of .",
    "this is a generalization to the case @xmath144 of the model presented in @xcite .",
    "further details are discussed in section  [ subsection : discussion : otf ] .",
    "we note that a conceptually similar approach has recently been developed independently @xcite as a tool for a mathematically rigorous proof that a specific heterogeneous mean field model @xcite holds in the limit of large network size .",
    "we now take a retrospective look at the results presented in sec .",
    "[ section : application ] and obtain from these special examples general considerations concerning our modelling approach .",
    "one of the aims of this paper is to obtain simplified models that accurately reproduce the behaviour of complex systems . since approximations are usually involved , it is to be expected that the results of the simplified model only agree with those of the full system over some range of parameters , where the approximations were valid .",
    "the parameters used in fig .",
    "[ fig : sispairregular : time][fig : sirotf : timeslices ] were chosen in order to investigate the limits of our approximations : while there is no perfect correspondence between the results of the full and simplified systems , their agreement is probably sufficient for both qualitative and quantitative applications .",
    "we distinguish between two categories of approximations : those inherent to the use of  and those due to the imperfect representation of @xmath0 through @xmath6 and @xmath4 .      since and define a system that _ exactly _ reproduces the behaviour of the corresponding full system , any discrepancy in fig .",
    "[ fig : sirotf : time ] must originate from the use of the gaussian approximation . an important requirement for this approximation to be valid is that the size @xmath51 of the system must be large .",
    "figures  [ fig : sispairregular : time][fig : sirotf : timeslices ] all use networks of size @xmath145 . as a rule of thumb",
    ", we found that ",
    "perform better for networks of at least a few hundred nodes , which is the case of many relevant real - world systems .",
    "note that , for very small systems ( tens of nodes ) , one could also directly and completely solve .    while a large network size @xmath51 is required to justify treating the elements of @xmath6 as real numbers",
    ", other phenomena may affect the validity of this approximation .",
    "for example , when the initial conditions are such that there is a single infectious node , the continuous approximation fails at considering the probability for that node to recover ( or to be removed ) before transmitting the infection to one of its neighbours .",
    "figures  [ fig : sispairregular : time][fig : sirotf : timeslices ] circumvent this problem by using an initial condition with @xmath79 infectious nodes : the probability for all of them to recover ( or to be removed ) before transmitting the infection is very low .",
    "it is worth noting that the plateaux seen on fig .",
    "[ fig : sispairregular : time ] and [ fig : sispairer : time][fig : sirotf : time ] reflect different dynamical behaviours for the sis and sir systems . indeed , while the total number of removed nodes reaches a maximum in the sir system because there are no infectious left to recover , the steady state observed at the later times for our sis models corresponds to a constant flow of recovery and new infections . in the former case ,",
    "the approximation errors performed at earlier times accumulate .",
    "in the later , the exact path taken to attain equilibrium is of lesser importance and errors do not accumulate the same way .      in general , the simplified system will not exactly reproduce the behaviour of the full system , even when using instead of . this is the case of all our sis models ; while some of the discrepancy seen in fig .",
    "[ fig : sispairregular : time][fig : sisfirst : time ] is explained by the gaussian approximation , the imperfect representation of @xmath0 also contributes to the error .",
    "part of the problem can be understood as our failure to consider the correlation between the neighbours of a node and the time elapsed since this node has been in its present intrinsic state . for example , the neighbours of a susceptible node that has just recovered ( _ i.e. _ , it was infectious a moment ago ) may be much different than those of a susceptible node that has recovered a long time ago , while being similar to those of a node that is still infectious .",
    "hence , one could hope to improve these sis models through changes in @xmath4 alone ( _ i.e. _ , with the same @xmath6 ) : first estimate the probability distribution for the time since when each node has last changed state and then infer the neighbourhoods accordingly .",
    "an alternative that could be simpler to implement , at the cost of increasing the size of @xmath6 , would consist in tracking more exhaustive motifs ( _ e.g. _ , second neighbourhoods instead of first ones in sec .",
    "[ subsection : sisfirst ] ) .",
    "however , there are more intricate consequences to the recovery of infectious nodes on a structure that is fixed in time : if at some point all the nodes of the same component ( _ i.e. _ , a connected subnetwork that is disconnected from the rest of the network ) are susceptible at the same time , then none of them may ever become infectious again",
    ". the connectivity of a network is strongly affected by the average degree of its nodes : our parameters correspond to an average degree of @xmath146 for fig .",
    "[ fig : sispairregular : time][fig : sispairer : time ] ( average degree of a neighbour also @xmath146 ) and of @xmath147 for fig .",
    "[ fig : sisfirst : time ] ( average degree of a neighbour @xmath148 ) . when using smaller parameter values , this components - induced discrepancy becomes much larger since the simplified model then overestimates the number of infectious nodes .",
    "one could take the components into account by solving independent systems for each component ( and merge the results afterwards ) or by a clever adaptation of the inference process ( see sec .",
    "[ subsection : discussion : otherinference ] for possible directions ) .",
    "note that these effects are usually much less important when the network structure changes over time .",
    "compared to the other models presented in sec .",
    "[ section : application ] , the two pair - based models of sec .",
    "[ subsection : pairsis ] use very small state vectors ( _ i.e. _ , two or three elements ) .",
    "this is an important advantage of pair - based models in general : there are usually much less pair and node motifs than , _",
    "e.g. _ , first neighbourhood ones , and tracking them thus requires much smaller @xmath6 .",
    "although we limited our study of pair - based models to regular and erds - rnyi networks , more complex network structures could also be considered . in the same way that and differ mostly by their inference terms , obtaining good inference from the little information stored in @xmath6 is probably the principal challenge behind general and accurate pair - based stochastic models",
    ".    however , non - stochastic pair - based models are already possible on nontrivial network structures for sir dynamics or , more generally , for processes such that a change in the state of one neighbour of a node can be treated as independent of that of another neighbour ( sis fails this assumption ) @xcite . knowing ( in @xmath4 ) that a system behaves in this manner",
    "greatly simplifies the inference process , and this is the main reason for the success of the sir pair - based model for the evolution of mean values on cm networks that is presented in @xcite . whether or not the same approach may be used to obtain stochastic results is an open question .      by opposition ,",
    "sufficiently accurate inference terms for first neighbourhood models are often straightforward to obtain .",
    "although may be difficult to appreciate at first sight , it is the only inference term used in both sec .",
    "[ subsection : sisfirst ] and sec .",
    "[ subsection : sirfirst ] .",
    "in fact , may well be the only inference term needed for generic first neighbourhood models for cm network structures .",
    "although first neighbourhood motifs are a `` natural language '' for expressing dynamics taking place on cm networks , they could also be used in the presence of other complex structures .",
    "this may be done through changes in @xmath6 and/or @xmath4 ; see esm @xcite ii  for details .",
    "the generality and ease of design of first - neighbourhood models comes at a cost : the state vector @xmath6 is typically much larger than it would be in an equivalent pair - model .",
    "how large is @xmath6 strongly depends on the maximal node degree present in the network and on the total number of accessible intrinsic node states ( see esm @xcite ii  for details ) . for typical values of these quantities",
    ", this does not cause major problems for the evaluation of the mean : numerically solving requires an acceptable amount of resources even for an @xmath6 of dimension @xmath149 and may often be simplified ( _ i.e. _ , summed analytically ) .",
    "however , evaluating the covariance matrix using may cause problems : unless analytical simplifications are possible , solving this system scales as the square of the number of elements in @xmath6 .",
    "future developments may decrease this bottleneck effect of the covariance matrix ; see sec .",
    "[ subsection : discussion : statevsassumptions ] for details . in any case",
    ", the size of @xmath6 may be decreased by `` coarse graining '' the number of links between the central node and its neighbours ; see esm @xcite ii g  for details .      the on - the - fly model presented in sec .",
    "[ subsection : sirotf ] for sir dynamics on cm networks _ exactly _ reproduces the behaviour of the full system .",
    "this is even more remarkable when one considers that the size of the state vector in the on - the - fly model is much smaller than in the alternative first neighbourhood model of sec .",
    "[ subsection : sirfirst ] .",
    "the reasons behind the success of the on - the - fly approach are similar to those discussed in sec .",
    "[ subsection : discussion : pair ] for the pair models presented in @xcite : it is encoded in @xmath4 that , for each link , we _ at most once _ need to simultaneously know the state of the two nodes joined by that link @xcite .",
    "the inference term is of `` general purpose '' in the sense that its @xmath4 does not provide information on the dynamical properties of the system , but only on how the motifs in @xmath6 may be interconnected .",
    "this is why both and rely on .",
    "however , the inference terms of have a specific character : @xmath4 contains information about itself .",
    "any change to the dynamics implies changes in the inference terms , with no guarantee that an acceptable solution exists .",
    "in fact , was _ designed _ with this problem in mind .",
    "in other words , we obtained a simple and reliable model at the cost of `` pre - computations '' in the design process .",
    "of all the possibilities in model - space , the information acquired by pointing at this specific one is what replaces the reduced size of the state vector .",
    "the same could be said of the deterministic sir pair - based model on cm networks presented in @xcite .",
    "by contrast with the case discussed in sec .",
    "[ subsection : discussion : first ] , the small size of the state vector here allows for evaluations of the covariance matrix through , even when relatively high degree nodes are present .",
    "alternatively , one may take advantage of the fact that , even for more complicated dynamics , the state vector of on - the - fly models can remain of manageable size for mean values calculations ; see the introduction to esm @xcite ii  for the concrete example of @xcite .",
    "section  [ subsection : discussion : otf ] revealed an unexpected depth to @xmath4 : one may achieve models of similar levels of accuracy by trading off complexity in the assumptions for a reduction in the size of the state vector @xmath6 . as an extreme example , if @xmath4 already gives the full behaviour of the system , then there is no need for tracking any information in @xmath6 . without reaching such extremes ,",
    "our on - the - fly model and the deterministic sir pair - based model presented in @xcite both demonstrate the benefits of investing some time in the assumptions of our models .    while these examples required case - by - case analysis , one may benefit from the same realization in a general context : a first simplified model ( @xmath3 , @xmath6 and @xmath4 ) may generate the assumptions @xmath150 to a different simplified model ( @xmath151 , @xmath152 and @xmath150 ) .",
    "for example , when some dynamical process ( _ e.g. _ , sis or sir ) occurs on a network whose structure changes in time independently from this dynamics , one could obtain a first model for the structure alone and then feed the results to the second model , handling the remaining dynamics .",
    "even more generally , one could compensate for the higher computational requirements of by first solving on an elaborate model then feeding the resulting mean values to a simpler model for the sole purpose of estimating the covariance matrix .",
    "while we introduced @xmath4 as a direct application of bayes rule , we have now seen that useful assumptions may be obtained by other means , including the solution of another system of the form .",
    "the next step in this direction would be to improve our inference process using alternative tools and models available to network science .",
    "for example , branching processes @xcite may be used to infer information concerning the connectivity and the components of the network structure . as discussed in sec .",
    "[ subsection : discussion : representation ] , this point was a major shortfall of sis models .",
    "this approach is even more interesting for the recently developed tools @xcite that are particularly compatible with the motifs and intrinsic node state approach presented in this paper .",
    "another tool of considerable interest are exponential random networks @xcite .",
    "indeed , these maximum entropy methods can simplify inferences that would have otherwise been prohibitively complex . once again",
    ", this approach may be generalized to different kind of motifs and intrinsic node states .",
    "although the examples of sec .  [",
    "section : application ] focus on sis and sir dynamics , any specificity that could be modelled through a standard epidemiological compartmental model may _ a priori _ be considered by our approach : genders , age groups , vaccination , incubation period , disease phases , _",
    "etc_. each compartment simply becomes an accessible node state in our formalism ; see esm @xcite",
    "i  for details .",
    "furthermore , population dynamics considerations may be accounted for in a straightforward manner .",
    "assuming first neighbourhood motifs , births and deaths of individuals correspond to events adding and removing motifs , respectively .",
    "similarly , changes in interaction patterns amount to events replacing the affected motifs by new ones .",
    "in fact , from the model s perspective , there is no important distinction between a change in the interaction structure of the population and a change in the node states : both are events affecting motifs .    the generality of our systematic approach and the fact that its assumptions are explicitly stated suggests that it could be used as a common ground for comparing existing models too complex for direct comparison . indeed , by considering such an existing model as the full system ( specified by @xmath153 and @xmath154 )",
    ", one may seek a simplified system ( specified by @xmath155 , @xmath156 and @xmath157 ) approximately reproducing the original model ( over a sufficient range of parameters ) .",
    "if some transition event ( in @xmath155 ) appears essential , this may reveal an important feature of the original model ; the same holds true for motifs ( in @xmath156 ) and prior knowledge ( in @xmath157 ) . moreover , assuming that this procedure has been done for a second existing model ( specified by @xmath158 and @xmath159 ) , one may directly compare their simplified version in a common framework , which will help identify the assumptions required for their description .",
    "note that this perspective is similar to a commutation diagram @xmath160 \\mathllap{\\scriptstyle\\text{equivalent behaviour\\ } } \\updownarrow & & \\updownarrow \\mathrlap{\\scriptstyle\\text{\\ equivalent behaviour } } \\\\ ( w_1,x_1,y_1 ) & \\overset{\\text{comparable}}{\\mathclap{\\longleftrightarrow}\\mathclap{\\phantom{/ } } } & ( w_2,x_2,y_2 ) \\mathrlap{\\qquad . } \\end{matrix}\\ ] ] for example , if @xmath161 and @xmath162 , we know that the discrepancies between the two original models is imputable to the difference in the transition events . finding a minimal set of changes to @xmath155 and/or @xmath163 causing both models to agree may then help identify the very cause of the discrepancies .",
    "the research team is grateful to the canadian institutes of health research ( cihr ) , the natural sciences and engineering research council of canada ( nserc ) and the fonds de recherche du qubec  nature et technologies ( frq  nt ) for financial support .",
    "broeck w , gioannini c , goncalves b , quaggiotto m , colizza v , vespignani a. the gleamviz computational tool , a publicly available software to explore realistic epidemic spreading scenarios at the global scale .",
    "bmc infectious diseases .",
    "2011;11(1):37 .",
    "lee by , brown st , cooley p , grefenstette jj , zimmerman rk , zimmer sm , et  al .",
    "vaccination deep into a pandemic wave : potential mechanisms for a `` third wave '' and the impact of vaccination .",
    "american journal of preventive medicine .",
    "2010;39(5):e21  e29 ."
  ],
  "abstract_text": [
    "<S> dynamics on networks is considered from the perspective of markov stochastic processes . </S>",
    "<S> we partially describe the state of the system through network motifs and infer any missing data using the available information . </S>",
    "<S> this versatile approach is especially well adapted for modelling spreading processes and/or population dynamics . in particular , the generality of our systematic framework and the fact that its assumptions are explicitly stated suggests that it could be used as a common ground for comparing existing epidemics models too complex for direct comparison , such as agent - based computer simulations . </S>",
    "<S> we provide many examples for the special cases of susceptible - infectious - susceptible ( sis ) and susceptible - infectious - removed ( sir ) dynamics ( _ e.g. _ , epidemics propagation ) and we observe multiple situations where accurate results may be obtained at low computational cost . </S>",
    "<S> our perspective reveals a subtle balance between the complex requirements of a realistic model and its basic assumptions . </S>",
    "<S> keywords : contact networks , epidemics , stochastic processes , complex networks , spreading dynamics , markov processes    = 1 </S>"
  ]
}