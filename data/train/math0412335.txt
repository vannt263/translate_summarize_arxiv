{
  "article_text": [
    "the following situation frequently occurs in geometric dynamics .",
    "there is a phase space @xmath0 , a transformation @xmath1 ; and there is a finite decomposition @xmath2 . let @xmath3 be the corresponding alphabet .",
    "a phase point @xmath4 is regular if every element of the orbit @xmath5 belongs to a unique atom of @xmath6 .",
    "suppose that @xmath7 , etc .",
    "the corresponding word @xmath8 is the _ code _ of @xmath9 .",
    "let @xmath10 be the set of words in @xmath11 of length @xmath12 obtained by coding points in @xmath0 .",
    "the positive function @xmath13 is the associated _",
    "complexity_. its behavior as @xmath14 can be bounded , or grow polynomially , or grow exponentially , etc . ]",
    "is an important characteristic of the dynamical system in question .",
    "the following examples have motivated our study .",
    "* example a*. let @xmath15 be a polygon with sides @xmath16 , and let @xmath0 be the phase space of the _ billiard map _",
    "@xmath17 in @xmath18 .",
    "the coding generated by the corresponding decomposition @xmath2 is the traditional coding of billiard orbits by the sides they hit @xcite .",
    "basic questions about its complexity are open @xcite .",
    "* example b*. let @xmath19 be a convex polygon with vertices @xmath16 .",
    "the complement @xmath20 is the phase space of the _ outer billiard _",
    "@xmath21 about @xmath18 .",
    "( it is also called the _ dual billiard_. see @xcite ) .",
    "the conical regions bounded the singular lines of @xmath21 form the natural decomposition @xmath2 . in @xmath22 the mapping @xmath21 is the symmetry about @xmath16 .",
    "the decomposition @xmath6 yields the coding of outer billiard orbits by the vertices they hit .",
    "we will study the complexity of ( @xmath23-dimensional ) _ piecewise convex transformations_. this is a wide class of geometric dynamical systems ; it contains the examples above .",
    "our setting is as follows .",
    "( for simplicity of exposition , we restrict our attention to two dimensions . )",
    "let @xmath0 be a _",
    "geodesic surface _ , and let @xmath24 be a finite _ geodesic graph_. a subset @xmath25 is _ convex _ if for any @xmath26 there is a unique geodesic in @xmath27 with endpoints @xmath26 .",
    "suppose that the closed faces @xmath28 of @xmath29 are convex , and let @xmath2 be the corresponding decomposition .",
    "we say that @xmath6 is a _ convex partition _ of @xmath0 .",
    "a differentiable mapping @xmath30 is convex if it sends geodesics to geodesics .",
    "suppose that @xmath1 is a convex diffeomorphism on @xmath28 , and that @xmath31 also form a convex partition of @xmath0 .",
    "we say that the triple @xmath32 is a _ piecewise convex transformation _ with the _ defining partition _",
    "@xmath6 .",
    "making further assumptions on @xmath32 , we obtain more specialized classes of transformations , e.g. , piecewise isometries , piecewise affine mappings , etc .",
    "the case when the faces of @xmath29 are convex euclidean polyhedra , and @xmath33 is isometric on them arises in task scheduling problems @xcite .",
    "in section  [ basic ] we develop geometric and combinatorial techniques to study the complexity of piecewise convex transformations .",
    "in the rest of the paper we apply these results to the inner and outer polygonal billiards on ( simply connected ) surfaces of constant curvature @xmath34 .",
    "one of the goals of this work is to develop a uniform approach to these dynamical systems . while there is a vast literature on the parabolic case ( @xmath35 ) , the elliptic ( @xmath36 ) and the hyperbolic ( @xmath37 ) cases",
    "have been studied only sporadically .",
    "let @xmath38 be a surface of constant curvature , and let @xmath39 be a polygon .",
    "in section  [ innerbill ] we cast the ( inner ) billiard map in @xmath18 as a piecewise convex transformation @xmath32 .",
    "see theorem  [ bil_piece_prop ] .",
    "we do it simultaneously for all curvatures , and without making additional assumptions on @xmath18 .",
    "thus , we do nt assume that @xmath18 is convex or simple , and have to pay a price for this .",
    "the partition @xmath6 is finer than the  natural \" one ; the coding it generates is more refined than the standard coding by sides @xcite .",
    "we develop a dictionary between the language of piecewise convex transformations and that of billiard orbits . in the remaining part of the paper",
    "we come back to examples a , b and study the complexity of natural coding .    in section  [ cases ]",
    "we investigate the complexity of inner billiard orbits in a polygon @xmath18 on a surface of constant curvature @xmath40 . in section  [ arbit_sub ] @xmath41 are arbitrary ; later on we specialize to convex @xmath18 but arbitrary @xmath40 , to @xmath35 , and to @xmath42 respectively .",
    "below we formulate the main results .",
    "the side complexity of billiard orbits in any rational euclidean polygon grows at most cubically ; see theorem  [ rat_complex_thm ] .",
    "the side complexity of billiard orbits in any spherical polygon grows subexponentially ; see theorem  [ spheresubexp ] .",
    "the side complexity of billiard orbits in any hyperbolic ( i.e. , @xmath37 ) polygon grows exponentially ; the exponent in question is the topological entropy of the billiard map ; see theorem  [ hyperb_exp ] .",
    "section  [ outerbill ] is the outer billiard counterpart of section  [ cases ] . here",
    "are some of its results .    for @xmath35 and arbitrary polygon ( resp .",
    "rational polygon ) we obtain polynomial bounds from above and below ( resp .",
    "quadratic asymptotics ) for the complexity ; see theorem  [ upperbound ] and theorem  [ rational ] respectively .",
    "for @xmath36 complexity grows subexponentially ; see theorem  [ spheresubexp1 ] .    for @xmath37 and arbitrary polygon",
    ", we obtain linear lower bound for complexity , which is sharp : for the so - called large polygons complexity grows linearly ; see theorem  [ hyplowbd ] .    * notes and references .",
    "* we are grateful to the research in pairs program in oberwolfach and to the shapiro visiting program at penn state for their support .",
    "the second author was partially supported by an nsf grant .",
    "the work @xcite is the predecessor of our section 3 . for additional results on polygonal billiards see @xcite .",
    "we will introduce a class of maps of _ geodesic spaces_. in order to simplify our exposition , we will restrict it to two dimensions , i.e. , to _",
    "geodesic surfaces_. let @xmath38 be one .",
    "then @xmath38 is a topological surface .",
    "it may have a boundary , @xmath43 , and a finite number of _ cone points_. the surface @xmath38 is endowed with a collection of _ geodesics _",
    ", satisfying the standard properties .",
    "in particular , @xmath43 is a finite union of geodesics .",
    "let @xmath44 be any pair of points .",
    "then @xmath38 is _ geodesically convex _ if there is a _",
    "unique shortest geodesic _ @xmath45 joining them . below . ]",
    "* examples . *",
    "i ) the set @xmath46 endowed with a projectively flat ( e.g. , minkowski ) metric is a geodesic surface .",
    "its geodesics are straight lines .",
    "let @xmath47 be a closed , bounded convex region .",
    "then it is a geodesic surface iff @xmath38 is a polygon .",
    "the geodesic @xmath48 is the segment with endpoints @xmath49 .",
    "+ ii ) let @xmath50 be the round sphere , and let @xmath51 be a convex spherical polygon .",
    "then @xmath38 is a geodesic surface iff it does not contain antipodal points .",
    "this holds iff @xmath38 is contained in an open hemisphere .    in what follows",
    "we will often say  convex geodesic surface \" instead of  geodesically convex geodesic surface \" .",
    "let @xmath0 be a geodesic surface .",
    "a finite graph @xmath29 drawn on @xmath0 is a _ geodesic graph _ if the edges of @xmath29 are geodesics .",
    "we will assume that the cone points of @xmath0 are contained in the set of vertices of @xmath29 , and that the latter are nondegenerate .",
    "( a vertex is degenerate if it has two adjacent edges , and they are colinear . )    let @xmath22 be the ( open ) faces of @xmath29 , and let @xmath52 be their closures .",
    "we will say that @xmath29 is a _",
    "convex geodesic graph _ if the surfaces @xmath52 are geodesically convex",
    ". we will refer to the data @xmath53 as a _ piecewise ( geodesically ) convex geodesic surface_. we will also say that @xmath54 is a _ convex geodesic partition _ of the geodesic surface @xmath0 .",
    "the boundary @xmath55 is spanned by the edges and vertices of @xmath29",
    ". we will also refer to it as the _ support _ of @xmath29 and denote by @xmath56 .",
    "there is a @xmath57 correspondence between convex geodesic graphs drawn on @xmath0 and convex geodesic partitions of @xmath0 .",
    "the latter concept provides an alternative approach to the material below @xcite .",
    "however , the language of convex geodesic graphs is more suitable for our purposes , and we will use it in what follows .    let @xmath0 be a convex geodesic surface , and let @xmath27 be an arbitrary geodesic surface . a diffeomorphism ( not necessarily surjective )",
    "@xmath58 is a _ geodesically convex transformation _ if it sends geodesics to geodesics .",
    "then @xmath59 is a convex geodesic surface as well , and the inverse map @xmath60 is a geodesically convex transformation",
    ".      we will now introduce a class of dynamical systems which , on one hand , is sufficiently general to include several interesting examples , and on the other , is special enough to allow a common geometric framework .",
    "let @xmath61 be as above .",
    "let @xmath62 be the number of atoms of @xmath6 and write @xmath63 .",
    "suppose that for @xmath64 there is a convex transformation @xmath65 .",
    "set @xmath66 .",
    "suppose that @xmath67 and that the open sets @xmath68 are pairwise disjoint .",
    "then @xmath69 is a convex geodesic partition , and @xmath70 is the support of a convex geodesic graph , @xmath71 , drawn on @xmath0 .    these data determine a _ piecewise convex transformation _",
    "@xmath1 with the _ defining partition _ @xmath6 , and we will use the notation @xmath72 for it .",
    "the inverse of @xmath72 is also a piecewise convex transformation .",
    "its defining partition is @xmath73 .",
    "thus in our notation , @xmath74 .",
    "invertible piecewise isometric ( as well as affine , or projective ) maps are examples of piecewise convex transformations .",
    "let @xmath38 be a simply connected surface of constant curvature , and let @xmath39 be a geodesic polygon . in sections  [ cases ] and  [ outerbill ] we will put the inner and the outer billiard about @xmath18 into the framework of piecewise convex transformations .",
    "denote by @xmath75 the _ full shift space _ on the _ alphabet _ @xmath76 of the faces of @xmath29 .",
    "a point @xmath4 is _ regular _ if @xmath77 belong to open faces of @xmath29 .",
    "let @xmath78 be the set of regular points .",
    "assigning to @xmath79 the sequence of faces of @xmath29 containing the consecutive elements @xmath77 we obtain the _ coding map _",
    "set @xmath81 , and let @xmath10 be the set of words of length @xmath12 that occur in @xmath82 .",
    "the function @xmath13 is the _ complexity _ of @xmath32 _ with respect to the defining partition_.    let @xmath83 be two geodesic graphs on @xmath0 .",
    "their _ join _",
    "@xmath84 is the ( unique ) geodesic graph such that @xmath85 we write @xmath86 if @xmath87 .",
    "recall that @xmath88 denotes the join of partitions , and that @xmath89 holds if @xmath90 .",
    "let @xmath91 . if @xmath83 are convex geodesic graphs , then so is @xmath84 , and @xmath92 moreover , @xmath86 iff @xmath89 .",
    "set @xmath93 .",
    "the convex geodesic graphs @xmath94 form an increasing tower with respect to the relation @xmath95 , and we set @xmath96 , @xmath97 . the _ singular set _",
    "@xmath98 is a countable ( at most ) union of geodesics .",
    "note that @xmath99 is a piecewise convex transformation for @xmath100 .",
    "let @xmath101 be a _",
    "finite orbit _ such that the points @xmath102 belong to open faces of @xmath29 .",
    "we say that @xmath102 is a _ regular orbit of length @xmath12 _ and denote by @xmath103 the corresponding word on the alphabet @xmath11 ; it is the _ code of @xmath102_. then @xmath10 is the set of codes of regular orbits of length @xmath12 ; the orbit @xmath101 is regular iff @xmath9 belongs to an open face of the graph @xmath104 .",
    "the proposition below summarizes the discussion .",
    "[ sing_strat_prop ] let @xmath72 be a piecewise convex transformation , and let @xmath105 .",
    "then : + 1 . there is a sequence @xmath106 of convex geodesic graphs in @xmath0 such that @xmath107 2 .",
    "set @xmath108 .",
    "then @xmath109 is a convex geodesic partition , and the @xmath12th iteration of @xmath32 is a piecewise convex transformation with the defining partition @xmath109 , i. e. , @xmath110 .",
    "there is a natural bijection between the set @xmath10 and the set of atoms of the partition @xmath109 .",
    "thus , the complexity @xmath111 is the number of faces of the graph @xmath104 .",
    "we will need a general proposition that concerns the combinatorics of graphs .",
    "let @xmath0 be a piecewise geodesic surface .",
    "let @xmath83 be geodesic graphs drawn on @xmath0 and set @xmath112 .",
    "( we do not assume that the faces of @xmath83 are convex . )",
    "denote by @xmath113 the respective sets of faces , edges and vertices .",
    "let @xmath114 be the sets of faces , edges and vertices of @xmath29 . if @xmath115 intersect non - transversally , then they ( partially ) overlap .",
    "there are @xmath116 ways in which this can happen",
    ". see figure  [ fig1 ]",
    ". denote by @xmath117 the number of the overlapping pairs of edges .",
    "[ comb - top_lem ] let @xmath83 be geodesic graphs drawn on a piecewise geodesic surface @xmath0 .",
    "denote by @xmath40 the euler characteristic of @xmath0 .",
    "let @xmath118 be the sets of vertices of @xmath83 that are disjoint from the other graph , and set @xmath119 .",
    "then @xmath120 drawn on @xmath0 satisfies @xmath121 applying ( [ euler_eq ] ) to graphs",
    "@xmath122 , we obtain for the left hand side of ( [ comb - top_eq ] ) @xmath123 the edges of @xmath83 respectively .",
    "let @xmath124 be the number of vertices of @xmath125 that are located in the interior of @xmath126 respectively .",
    "let @xmath127 be the number of times that the interior of @xmath128 transversally intersects the interior of an edge of @xmath125 respectively .",
    "then @xmath126 contribute @xmath129 edges to @xmath130 respectively .",
    "taking the overlapping into account , we obtain @xmath131 let @xmath132 be the set of common vertices of @xmath83 .",
    "let @xmath133 be the sets of vertices of @xmath83 that are in the interior of edges of the other graph . then @xmath134 let @xmath135 be the set of  new \" vertices of @xmath29 .",
    "then @xmath136 we also have @xmath137),([vertices_eq1]),([vertices_eq2 ] ) and ( [ vertices_eq3 ] ) , we obtain @xmath138 ) , @xmath139),([vertices_eq5 ] ) into ( [ euler_eq1 ] ) , and using ( [ vertices_eq4 ] ) again , we obtain the claim .",
    "the expression for @xmath140 in lemma  [ comb - top_lem ] involves information about vertices of @xmath83 which is sometimes not available .",
    "the following corollary of lemma  [ comb - top_lem ] is useful .",
    "[ comb_bounds_prop ] let @xmath83 be geodesic graphs drawn on a piecewise geodesic surface @xmath0 of euler characteristic @xmath40 .",
    "let @xmath112 , and let the notation be as above .",
    "then @xmath141 and equation ( [ vertices_eq4 ] ) , the quantity to estimate in ( [ ineq_eq ] ) is equal to @xmath142 .",
    "the following special cases of lemma  [ comb - top_lem ] and proposition  [ comb_bounds_prop ] will be especially useful .",
    "[ comb_bounds_cor ] let @xmath0 be a geodesic surface homeomorphic to the open disc .",
    "let @xmath83 be geodesic graphs drawn on @xmath0 such that their edges intersect only transversally .",
    "let @xmath112 and let the sets @xmath143 be as above",
    ". then @xmath144 then @xmath145 and @xmath36 .",
    "hence lemma  [ comb - top_lem ] and proposition  [ comb_bounds_prop ] yield ( [ transv_eq ] ) and ( [ transv_ineq ] ) respectively . if @xmath146 then @xmath147 and ( [ transv_eq ] ) becomes ( [ transv_eq1 ] ) .",
    "let @xmath82 be a language on a finite alphabet @xmath11 , and let @xmath10 be the set of words of length @xmath12 in @xmath82 .",
    "the _ complexity _ of @xmath82 is the function @xmath13 .",
    "set @xmath148 and @xmath149 .",
    "we will refer to the functions @xmath150 as the _ first , second differences of complexity _ , respectively .",
    "our approach is based on cassaigne s formula for @xmath151 @xcite .",
    "denote by @xmath152 the number of left , right one - letter extensions of the word @xmath153 respectively .",
    "we will assume , following @xcite , that @xmath154 for any @xmath155 .",
    "a word is _ bispecial _",
    "if @xmath156 .",
    "let @xmath157 be the number of extensions of the type @xmath158 where @xmath159 .",
    "let @xmath160 be the set of bispecial words , and set @xmath161 .",
    "the _ cassaigne index _ is defined by @xmath162 note that if @xmath153 is not bispecial then @xmath163 .",
    "the cassaigne formula says @xmath164 we define the cumulative index by @xmath165 for @xmath100 , and @xmath166",
    ". set @xmath167    [ complviacass ] the complexity of a piecewise convex transformation satisfies @xmath168    * proof . *",
    "denote by @xmath169 the right hand side of ( [ count_eq1 ] ) . since , by ( [ casform_eq],[casind_eq ] ) , the second differences of @xmath170 are equal , @xmath171 is linear in @xmath12 .",
    "but @xmath172 .",
    "let @xmath32 be a piecewise convex transformation , and let @xmath82 be its coding language .",
    "for @xmath173 let @xmath174 be the corresponding open face of the graph @xmath104 .",
    "we denote by @xmath175 the restriction of @xmath176 to @xmath177 .",
    "let @xmath178 ( resp .",
    "@xmath179 ) be the set of essential vertices ( resp .",
    "pairs of overlappings edges ) for @xmath175 .",
    "[ indexint ] for any @xmath155 we have @xmath180    * proof . *",
    "denote by @xmath83 the restrictions of @xmath181 to @xmath177 respectively .",
    "then in the notation of lemma  [ comb - top_lem ] , @xmath182 .",
    "since @xmath177 is contractible , @xmath36 in equation ( [ comb - top_eq ] ) . thus , the left hand side of equation  ( [ comb - top_eq ] ) is @xmath183 .",
    "but its right hand side is @xmath184 .",
    "we will use the notation @xmath185 . for @xmath100 set @xmath186 and @xmath187 thus , @xmath188 ( resp .",
    "@xmath189 ) is the number of  new \" essential vertices ( resp .",
    " new \" edge overlappings ) of the graph @xmath176 , while @xmath190 ( resp .",
    "@xmath191 ) is the total number of essential vertices ( resp .",
    "edge overlappings ) of @xmath176 .",
    "note that only bispecial words contribute to these numbers .",
    "[ geomcassform ] let @xmath32 be a piecewise convex transformation and let @xmath192 be the corresponding sequence of convex partitions .",
    "then the complexity of @xmath32 satisfies @xmath193    * proof .",
    "* we have @xmath194 . by lemma  [ indexint ] , @xmath195 , hence @xmath196 .",
    "the claim now follows from equation  ( [ count_eq1 ] ) .",
    "let @xmath38 be a complete simply connected surface of constant curvature , or @xmath197 or @xmath198 .",
    "thus @xmath38 is either the euclidean plane or the hyperbolic plane or the unit sphere .",
    "we will refer to these geometries as parabolic , hyperbolic and elliptic respectively . ] and let @xmath39 be a geodesic polygon . in order to cast the billiard map in @xmath18 as a piecewise convex transformation simultaneously for all three cases at hand",
    ", we will use the models of the hyperbolic and elliptic geometries where the geodesics are straight lines in the euclidean plane .",
    "( we will refer to them as the _ projective models_. )    for @xmath37 , this is the klein - beltrami model of hyperbolic geometry .",
    "the hyperbolic plane is represented by the open unit disc , the unit circle @xmath199 is the  circle at infinity \" , and geodesics are the chords of this disc .",
    "let @xmath49 be distinct points in the disc , and let @xmath200 be the intersection points of the line @xmath201 with @xmath199 .",
    "we identify the oriented line @xmath201 with @xmath202 , and hence @xmath203 with real numbers .",
    "the cross - ratio of the four points is given by @xmath204={{(y - a)(b - x)}\\over{(x - a)(b - y)}}.\\ ] ] the distance between points satisfies @xmath205.$ ] in this model , isometries of the hyperbolic geometry are the projective transformations of the euclidean plane , preserving the unit disc .",
    "projective model of the elliptic geometry ( i.e. , @xmath206 ) is as follows .",
    "we restrict our attention to an open hemisphere ; consider for concreteness the northern hemisphere .",
    "its central projection to the tangent plane at @xmath207 is a surjective diffeomorphism that takes spherical geodesics to euclidean straight lines .    in order to endow the _ billiard map phase space _ @xmath208 with the structure of a geodesic surface in a uniform fashion , we will impose a slight restriction on @xmath18 .",
    "let @xmath39 be a geodesic polygon , and let @xmath209 be a side of @xmath18 .",
    "we denote by @xmath210 the geodesic reflection in @xmath38 about @xmath209 , and set @xmath211 .",
    "[ admis_def ] let @xmath39 be a spherical polygon .",
    "then @xmath18 is _ admissible _ if for any side @xmath209 the polygon @xmath212 is contained in an open hemisphere .",
    "note that the admissibility is a restriction only in the elliptic case .",
    "unless we state otherwise , we will consider only admissible polygons , suppressing the qualifier .",
    "the space @xmath208 consists of directed geodesic segments inside @xmath18 both of whose endpoints belong to @xmath213 . since we are using projective models , @xmath15 is a euclidean polygon in any of the three cases at hand .",
    "geodesic segments in @xmath18 are straight ; we refer to their endpoints as the _ beginning _ @xmath214 and the _ end _",
    "the mapping @xmath216 is an embedding @xmath217 ; it induces a topology on @xmath0 .",
    "let @xmath218 be the space of oriented straight lines ( rays ) in the euclidean plane .",
    "endowed with the natural topology , it is a cylinder . besides",
    ", @xmath218 is a geodesic surface : geodesics in @xmath218 are the pencils of rays passing through a point or the pencils of parallel rays .",
    "equivalently , we define this structure via the canonical embedding @xmath219 .",
    "lines in @xmath46 become points of the dual projective plane @xmath220 .",
    "the geodesic surface structure of @xmath218 is thus induced by that of the real projective plane .",
    "denote by @xmath221 the ray containing the chord @xmath9 .",
    "the mapping @xmath222 given by @xmath223 is finite - to - one ; if @xmath18 is convex then it is one - to - one .",
    "it induces the structure of a geodesic surface on @xmath0 .",
    "let @xmath224 ( resp .",
    "@xmath225 ) be given by the condition that @xmath215 ( resp .",
    "@xmath214 ) is a corner of @xmath18 .",
    "let @xmath226 be the set of chords that contain a corner of @xmath18 in the interior .",
    "set @xmath227 by definition , @xmath228 is a geodesic graph in @xmath0 .",
    "the following lemma is crucial .",
    "[ convex_lem ] the faces of the graph @xmath228 are geodesically convex .",
    "* proof*. let @xmath229 , and let @xmath230,$ ] be a path in @xmath231 connecting them .",
    "then the points @xmath232 $ ] ( resp . @xmath233 $ ] ) belong to the interior of a side , @xmath234 ( resp .",
    "@xmath235 ) .    up to relabeling and orientation reversal ,",
    "the points in question may form four apriori possible configurations ; the four cases are shown in figure  [ figconv1 ] .",
    "cases @xmath236 contradict to our assumptions . indeed , in case @xmath116 the sides @xmath200 intersect at their interior points . in case @xmath237",
    "let @xmath238 be the endpoints of the side @xmath239 .",
    "the two frames @xmath240 and @xmath241 have opposite orientations , thus for some @xmath242 the vectors @xmath243 are colinear , in contradiction to the assumption that @xmath244 .    in cases",
    "@xmath245 let @xmath246 be the intersection point of the straight lines @xmath247 .",
    "the two lines may be parallel , but the same argument works .",
    "] let @xmath248 be the curve in @xmath0 obtained by rotating the oriented line @xmath249 about @xmath250 towards @xmath251 by an angle less than @xmath252 .",
    "it is a geodesic . to show that @xmath248 does not intersect @xmath228 , it suffices to prove that the quadrilateral @xmath253 contains no vertices of @xmath18 .",
    "assume that it does , and let @xmath254 be such a vertex .",
    "the frames @xmath255 and @xmath256 have opposite orientations .",
    "hence , for some @xmath257 the vectors @xmath258 are colinear , and thus the segment @xmath259 contains a corner of @xmath18 , in contradiction to the assumptions .",
    "we denote by @xmath260 the billiard map and by @xmath261 its inverse .",
    "they are not defined on all of @xmath0 , and there are choices in defining them on @xmath228 . to avoid the ambiguities , we will now precisely define @xmath262 on their respective domains of definition .",
    "let @xmath263 $ ] be a phase point .",
    "then @xmath264 ( resp .",
    "@xmath265 ) is not defined iff @xmath215 ( resp .",
    "@xmath214 ) is a corner of @xmath18 .",
    "thus , the natural domain of definition for @xmath17 ( resp .",
    "@xmath266 ) is @xmath267 ( resp .",
    "@xmath268 ) .",
    "suppose now that @xmath215 is not a corner , and let @xmath209 be the unique side of @xmath18 that contains @xmath215 .",
    "let @xmath269 be the reflection of @xmath270 about @xmath209 .",
    "let @xmath271\\subset l_1(x)$ ] be the longest chord such that @xmath272\\in x$ ] .",
    "this defines @xmath17 on @xmath267 .",
    "the definition of @xmath266 on @xmath268 is analogous , and we leave it to the reader .",
    "set @xmath273    [ discont_prop ] the following holds : + 1 .",
    "the subset @xmath274 is the set of discontinuities of the billiard map .",
    "the faces of @xmath29 are geodesically convex .",
    "* proof*. it is elementary to see that @xmath275 belongs to the set of discontinuities .",
    "( the billiard map is not even defined on @xmath275 . )",
    "let @xmath276 .",
    "then arbitrarily close to @xmath9 there are phase points @xmath277 such that @xmath278 belong to distinct , and non - adjacent , sides of @xmath18 .",
    "hence @xmath279 and @xmath280 are not close to each other , and @xmath17 is discontinuous at @xmath9 .",
    ". then @xmath264 is defined .",
    "if however @xmath282 , then arguing as above , we conclude that @xmath283 and @xmath284 are not close to each other , and @xmath17 is discontinuous at @xmath9 .",
    "see figure  [ figdiscon ] . on the other hand ,",
    "if @xmath285 , then @xmath9 is a point of continuity of @xmath17 .",
    "this proves the first claim .",
    "let @xmath277 belong to a face of @xmath29 .",
    "arguing as in the proof of lemma  [ convex_lem ] , we see that @xmath278 belong to the same side , @xmath209 , of @xmath18",
    ". set @xmath286 , and let @xmath287 .",
    "the  reflection \" trick associates with any phase point @xmath4 such that @xmath288 a phase point @xmath289 @xcite .",
    "the correspondence @xmath290 maps a curve @xmath291 connecting @xmath277 in @xmath0 into a curve @xmath292 connecting @xmath293 in @xmath27 .",
    "let @xmath294 be the corresponding set of phase points containing corners .",
    "the condition @xmath295 implies that @xmath296 by lemma  [ convex_lem ] , phase points @xmath293 are connected by a geodesic , @xmath297 , in @xmath298 .",
    "folding @xmath297 back into @xmath0 by the geodesic reflection @xmath210 , we obtain the geodesic @xmath299 connecting @xmath277 in @xmath300 .",
    "this establishes the second claim .    we will now cast the billiard mapping as a piecewise convex transformation .",
    "[ bil_piece_prop ] let @xmath38 be a simply connected surface of constant curvature , and let @xmath39 be a geodesic polygon .",
    "let @xmath208 be the phase space of the billiard map endowed with the structure of a geodesic surface .",
    "let @xmath260 be the billiard map .",
    "let @xmath29 be the graph defined by ( [ graph_eq1 ] ) , and let @xmath301 be the corresponding convex geodesic partition .",
    "then @xmath29 is a convex geodesic graph , and @xmath17 is continuous on the faces of @xmath29 .",
    "let @xmath33 be the map that coincides with @xmath17 on the open faces of @xmath29 and extends to their closures by continuity .",
    "then @xmath32 is a piecewise convex transformation ; the billiard map @xmath17 and the transformation @xmath32 coincide on @xmath300 .    * proof*. most of the statements have been established in the course of the preceding discussion .",
    "for instance , proposition  [ discont_prop ] asserts that @xmath29 is a convex geodesic graph .",
    "it remains to show that the restriction of @xmath17 to any open face of @xmath29 is a geodesically convex transformation .",
    "the geodesic structure on @xmath0 has been defined via ray focusing .",
    "geodesic reflections send focusing beams into focusing beams .",
    "let @xmath25 be a face of @xmath29 .",
    "as we have seen in the proof of proposition  [ discont_prop ] , the endpoints @xmath214 of all phase points @xmath302 belong to the same side , @xmath209 , of @xmath18 .",
    "hence , for all @xmath302 the new phase point @xmath264 is obtained via the geodesic reflection @xmath210 .",
    "hence @xmath17 sends geodesic segments of @xmath27 into geodesic segments .",
    "it has been traditional to study the complexity of billiard orbits in a polygon @xmath18 using the coding by sides of @xmath18 @xcite .",
    "let @xmath32 be as in theorem  [ bil_piece_prop ] .",
    "the complexity of billiard orbits with respect to the coding by atoms of @xmath6 coincides with the complexity of @xmath32 . we will study it , and then apply our results to the traditional billiard complexity .    first",
    ", we will establish a dictionary between the language of billiard orbits @xcite and that of piecewise convex transformations .",
    "a billiard orbit of ( combinatorial ) length @xmath12 is a sequence @xmath303 of phase points such that @xmath304 .",
    "geometrically , @xmath248 is a sequence of @xmath12 consecutive chords of @xmath18 , where each chord is the reflection of the preceding one . in particular",
    ", the points @xmath305 are not corners .",
    "we will also say that @xmath248 is a _",
    "@xmath12-segment orbit_. if @xmath306 is not a corner , then the _ @xmath198-step forward extention _ is @xmath307 , where @xmath308 . if @xmath309 is not a corner , then the _ @xmath198-step backward extention _ is @xmath310 , where @xmath311 .",
    "we can iterate these extentions in obvious ways .",
    "a billiard orbit is _ regular _ if it does not contain corners .",
    "otherwise , @xmath248 is _",
    "singular_. if @xmath248 does not contain corners of @xmath18 in its interior , but the endpoints @xmath312 are corners , we say , following @xcite , that @xmath248 is a _ generalized diagonal _ of length @xmath12 .",
    "the notion of generalized diagonals works well for the billiard in a convex polygon .",
    "we introduce an extension of this notion which works for arbitrary polygons .",
    "[ sing_def ] an @xmath12-segment billiard orbit @xmath303 is _ strongly singular _ if @xmath313 do not contain corners but @xmath314 and @xmath315 do .    a _ family of billiard orbits _ is a one - parameter family @xmath316 where the mapping @xmath317 is injective and continuously differentiable . in particular",
    ", we will consider families of strongly singular billiard orbits .",
    "any such is contained in a unique maximal family , and we will consider only them , suppressing the qualifier _",
    "maximal_. a strongly singular billiard orbit is _ isolated _ if it is not contained in a family of such orbits .",
    "[ transition_prop ] let @xmath39 be a geodesic polygon , and let @xmath32 be the corresponding piecewise convex transformation .",
    "let @xmath318 . then :    \\1 .",
    "there is a bijection between the set @xmath319 and the union of the sets of isolated @xmath320-segment and @xmath321-segment strongly singular billiard orbits ;    \\2 .",
    "there is a bijection between the set @xmath322 and the union of the sets of families of @xmath320-segment and @xmath321-segment strongly singular billiard orbits .",
    "* proof*. let @xmath323 . iterating the billiard map , we obtain an @xmath324-segment billiard orbit @xmath325 , where @xmath326 .",
    "let @xmath327 . then @xmath328 iff either @xmath329 or @xmath330 but @xmath331 .",
    ". then @xmath332 iff @xmath333 .",
    "thus , we have obtained a surjective map from @xmath334 to the union of set of @xmath320-segment and @xmath321-segment strongly singular billiard orbits .",
    "( the orbit corresponding to @xmath9 is @xmath335 in the former case , and @xmath336 in the latter . )",
    "the map above is a bijection .",
    "moreover , isolated orbits correspond to the essential vertices of @xmath337 , and families of orbits correspond to overlapping edges of @xmath338 and @xmath339 .",
    "we will now apply the preceding material to the complexity of billiards in geodesic polygons on surfaces of constant curvature . in the beginning of this section",
    "we consider the three cases at hand simultaneously , emphasizing their similarities .",
    "let @xmath38 be a surface of constant curvature @xmath340 , and let @xmath39 be a geodesic polygon .",
    "the operation of _ unfolding _ sends billiard orbits in @xmath18 into geodesics in @xmath38 @xcite , see figure [ fig105 ] .",
    "if @xmath341 is a billiard orbit , then its unfolding is the geodesic @xmath342 where the segments @xmath343 differ by an isometry of @xmath38 .",
    "let @xmath344 be the group generated by the geodesic reflections in the sides of @xmath18 .",
    "denote by @xmath345 the set of elements obtained from products of at most @xmath12 reflections .",
    "( these are the elements of length at most @xmath12 . )",
    "then @xmath346 is an increasing tower of finite sets ; their union is @xmath347 .",
    "[ conj_lem ] 1 .",
    "let @xmath348 .",
    "then all strongly singular billiard orbits in @xmath18 are isolated .",
    "let @xmath349 .",
    "let @xmath341 be a strongly singular billiard orbit in @xmath18 and let @xmath342 be its unfolding .",
    "suppose that @xmath248 extends to a family of strongly singular billiard orbits .",
    "then there are corner points @xmath350 and an isometry @xmath351 of @xmath38 such that @xmath352 and the points @xmath353 either coincide or are antipodal .",
    "* proof*. let @xmath354 be a family of strongly singular billiard orbits . the segments @xmath355 ( resp .",
    "@xmath356 ) pass through the same corner point @xmath357 ( resp .",
    "@xmath358 ) .",
    "we view @xmath359 as a beam of trajectories that emanate from the focusing point @xmath357 and refocus at @xmath358 .",
    "the unfolding @xmath360 transforms directed billiard orbits into directed geodesics in @xmath38 , preserving the length and sending focusing beams of billiard orbits into focusing beams of geodesics@xcite . , the argument applies to arbitrary @xmath40 . ]",
    "the beam @xmath361 emanates from @xmath362 and refocuses at @xmath363 where @xmath364 .",
    "the distance between @xmath353 along any geodesic @xmath361 is the same as the distance between @xmath365 along the orbit @xmath359 , hence positive .",
    "if @xmath348 , this implies @xmath366 ; thus the geodesic beam @xmath361 has two different focusing points .",
    "this is impossible , which proves the first claim . if @xmath349 , i.e. , @xmath38 is the sphere , the focusing points in question are either antipodal or they coincide .",
    "we denote by @xmath367 ( resp .",
    "@xmath368 ) the number of isolated ( resp .",
    "families of ) strongly singular @xmath369-segment billiard orbits in @xmath18 . set @xmath370    [ str_sing_prop ] let @xmath18 be a geodesic polygon on a surface @xmath38 of constant curvature @xmath40 .",
    "let @xmath32 be the associated piecewise convex transformation , and let @xmath371 be the billiard complexity corresponding to the partition @xmath6 .",
    "then there are positive integers @xmath372 depending on @xmath18 , so that :    \\1 . if @xmath36 , then @xmath373 2 . if @xmath348 , then @xmath374    * proof .",
    "* we use proposition  [ transition_prop ] to express the right hand side of ( [ complex_eq ] ) via the numbers of ( families of ) strongly singular billiard orbits .",
    "this yields the first claim . taking into account lemma  [ conj_lem ]",
    ", we obtain the second claim .",
    "the factor of @xmath23 in ( [ compl_polyg_eq ] ,  [ compl_curv_eq ] ) is due to the fact that the contribution of @xmath369-segment strongly singular orbits with @xmath375 is counted twice .",
    "see proposition  [ transition_prop ] .    there is a correspondence between strongly singular billiard orbits and generalized diagonals .",
    "let @xmath376 @xmath377 be a strongly singular orbit .",
    "let @xmath378 ( resp .",
    "@xmath379 ) be the last ( resp . the first ) corner point .",
    "note that @xmath380 .",
    "set @xmath381,\\tilde{x}_n=[b(x_n),q]$ ] .",
    "then @xmath382 is a generalized diagonal .",
    "the mapping @xmath360 is a bijection , and it preserves the combinatorial length",
    ".    let @xmath383 ( resp .",
    "@xmath384 ) be the number of @xmath12-segment isolated ( resp .",
    "families of ) generalized diagonals , @xmath385 . set @xmath386    [ gen_diag_thm ] let @xmath18 be a geodesic polygon on a surface @xmath38 of constant nonpositive curvature .",
    "let @xmath32 be the associated piecewise convex transformation , and let @xmath371 be the billiard complexity corresponding to the partition @xmath6 . then there are integers @xmath387 depending on @xmath18 , so that : @xmath388    * proof*. by lemma  [ conj_lem ] , strongly singular billiard orbits are isolated .",
    "the same argument shows that generalized diagonals are isolated , as well .",
    "the claim now follows from ( [ compl_curv_eq ] ) and the correspondence between strongly singular billiard orbits and generalized diagonals .",
    "we will now apply the preceding material to the complexity , @xmath389 , of the coding billiard orbits by the sides of @xmath18 . to avoid ambiguities",
    ", we will define this coding now .",
    "let @xmath18 have @xmath62 sides @xmath390 and denote by @xmath391 the set of phase points @xmath9 such that @xmath392 .",
    "as @xmath393 run through the pairs of sides such that @xmath394 has a nonempty interior , the sets @xmath394 form the partition @xmath395 of the phase space .",
    "then the _ side complexity _ , @xmath389 , is the complexity of the billiard map with respect to @xmath395",
    ".    it will be useful to have a direct definition of the side complexity .",
    "we denote by @xmath396 the full language on the alphabet of sides of @xmath18 .",
    "let now @xmath397 be a regular @xmath12-segment billiard orbit .",
    "then @xmath398 are interior points of sides @xmath399 , and we set @xmath400 the language @xmath401 is the range of the mapping , and we set @xmath402",
    ". then the _ side complexity _ satisfies @xmath403 to compare complexities , we will use an elementary lemma .",
    "[ compar_lem ] let @xmath32 be a piecewise convex transformation , and let @xmath371 be the corresponding complexity .",
    "let @xmath404 be a partition , such that @xmath405 , and let @xmath406 be the complexity of @xmath32 with respect to @xmath404 .",
    "then @xmath407 .",
    "[ side_cor ] let @xmath18 be a geodesic polygon on a surface @xmath38 of constant curvature @xmath40 , and let @xmath389 be the complexity of coding billiard orbits by the sides of @xmath18 . then the following inequalities hold :    \\1 . if @xmath36 , then there are constants @xmath372 such that @xmath408 2 .",
    "if @xmath348 , then there are constants @xmath387 such that @xmath409    * proof*. let @xmath6 be the defining partition of the associated piecewise convex transformation . by proposition  [ discont_prop ] , the partitions",
    "@xmath410 satisfy @xmath411 .",
    "now the first ( resp .",
    "second ) claim is immediate from proposition  [ str_sing_prop ] ( resp .",
    "theorem  [ gen_diag_thm ] ) and lemma  [ compar_lem ] .",
    "the preceding considerations drastically simplify for convex polygonal billiard tables .",
    "[ convex_prop ] let @xmath39 be a convex geodesic polygon on a surface of constant curvature @xmath40 .",
    "let @xmath389 be the traditional complexity of billiard orbits in @xmath18 coming from the coding of billiard orbits in @xmath18 by the sides they hit .",
    "then there exist constants @xmath387 depending only on @xmath18 such that the following holds :    \\1 .",
    "let @xmath36 .",
    "then @xmath412 2 .",
    "let @xmath348 .",
    "then @xmath413    * proof*. in the notation of section  [ innerbill ] , we have @xmath414 the standard defining partition is @xmath415 , and we have @xmath416 . in view of the above , @xmath417 , and",
    "hence the two complexities coincide : @xmath418 .    for a convex polygon ,",
    "the notion of strongly singular billiard orbits and the notion of generalized diagonals coincide .",
    "the argument of proposition  [ transition_prop ] works . due to the coincidences we just pointed out",
    ", it establishes a bijection between @xmath419 ( resp .",
    "@xmath322 ) and the set of isolated ( resp .",
    "families of ) @xmath12-segment generalized diagonals in the convex polygon @xmath18 .    from this bijection and ( [ complex_eq ] )",
    ", we obtain the first claim .",
    "now the first statement of lemma  [ conj_lem ] yields the second claim .",
    "[ low - order_rem ] the preceding proof yields expressions for the constants @xmath387 . from ( [ complex_eq ] )",
    ", we have @xmath420 let the polygon @xmath18 have @xmath62 sides .",
    "the integer @xmath421 ( resp .",
    "@xmath422 ) is the number of types of @xmath198-segment ( resp .",
    "@xmath23-segment ) billiard orbits in @xmath18 . by convexity , @xmath423 .",
    "however , @xmath422 is not determined by @xmath62 alone .",
    "we will now apply the preceding material to the complexity of polygonal billiards .",
    "we will consider the three cases separately .",
    "there is a considerable literature on the billiard dynamics in euclidean polygons .",
    "see @xcite for references .",
    "many basic questions remain open @xcite .",
    "one of them is whether the complexity ( of the coding by sides ) of billiard orbits grows ( at most ) polynomially .",
    "it is known that the growth is subexponential @xcite , implying that the billiard in a euclidean polygon has zero topological entropy . by corollary  [ side_cor ] ,",
    "the complexity is bounded from above by the counting function for generalized diagonals .",
    "the latter also grows subexponentially @xcite , and is believed to grow at most polynomially @xcite .",
    "a euclidean polygon is _ rational _ if all of its angles are rational multiples of @xmath252 .",
    "rational polygons play an important role in the subject @xcite .",
    "[ rat_complex_thm ] let @xmath18 be a rational euclidean polygon , and let @xmath389 be the side complexity of billiard orbits in @xmath18",
    ". then there exists @xmath424 such that @xmath425 if @xmath18 is convex , then there exist positive constants @xmath387 such that @xmath426    * proof .",
    "* by a theorem of h. masur @xcite , @xmath427 grows quadratically for rational polygons .",
    "more precisely , there exist positive constants @xmath428 such that @xmath429 the first claim follows from this and the bound ( [ side_eq3 ] ) .",
    "the second claim follows the same way from the formula above and the identity ( [ convex_eq2 ] ) .",
    "[ convex_rem ] we believe that the cubic lower bound on complexity ( [ cub_eq1 ] ) is valid for arbitrary rational polygons .",
    "however , the geometry of the billiard map is much simpler in the convex case , as we saw in section  [ convex_sub ] .",
    "figure  [ fig2 ] shows that the singular graph of the billiard map in a quadrilateral is much more complicated in the nonconvex case .",
    "the bounds ( [ cub_eq1 ] ) were obtained in @xcite .",
    "the billiard in a spherical polygon has two salient features .",
    "first , the billiard map is a piecewise isometry .",
    "second , a spherical polygon may have non - isolated strongly singular orbits , in particular , non - isolated generalised diagonals .",
    "we will use the notation @xmath430 for the space of oriented geodesics on @xmath38 . let @xmath431 be the standard diffeomorphism .",
    "( see section  [ neg_curv_sub ] for a discussion of spherical duality . ) pulling back by @xmath432 the round metric on @xmath433 , we obtain an invariant metric ; the distance between two great circles is the angle between them .",
    "metric geodesics and geodesics of the projective structure coincide .",
    "let now @xmath434 be a polygon .",
    "let @xmath208 be the billiard map phase space , and let @xmath435 be the map introduced in section  [ innerbill ] .",
    "pulling back by @xmath436 induces not only the structure of a piecewise convex surface on @xmath0 but also a metric on convex pieces of the phase space .",
    "locally , the billiard map @xmath260 is a geodesic reflection , i.e. , an isometry .",
    "we summarize this discussion as a proposition .",
    "[ piec_isom_prop ] let @xmath18 be an arbitrary spherical polygon .",
    "then the billiard map phase space is a piecewise metrically convex riemannian surface .",
    "the billiard map is a piecewise isometry .",
    "this observation has consequences for complexity of billiard orbits .",
    "[ spheresubexp ] let @xmath18 be any spherical polygon .",
    "is an admissible polygon . ]",
    "then the complexity of the coding of billiard orbits by sides of @xmath18 grows subexponentially .",
    "* let @xmath32 be the associated piecewise convex transformation .",
    "denote by @xmath371 its complexity , and let @xmath389 be the standard complexity of billiard orbits . by the proof of corollary  [ side_cor ] , @xmath437 .",
    "hence , it suffices to show that @xmath111 grows subexponentially . by proposition  [ piec_isom_prop ]",
    ", @xmath32 is a piecewise isometry on a convex partition . by theorem 4.2 of @xcite ,",
    "its complexity has subexponential growth .",
    "the examples below illustrate peculiarities of spherical polygonal billiards .",
    "* example 1*. let @xmath434 be a polygon such that @xmath347 is a finite group . for instance , @xmath18 may be the fundamental domain of a finite , generated by reflections group of isometries .",
    "then every billiard orbit in @xmath18 is periodic .",
    "moreover , there is a finite number of symbolic codes corresponding to prime periodic orbits , hence complexity is bounded .",
    "* example 2*. let @xmath18 be a",
    " bigon \" ; it is bounded by two geodesics , @xmath200 connecting the north and the south poles .",
    "let @xmath299 be the angle between them .",
    "is not an admissible polygon . ]",
    "if @xmath299 is @xmath252-rational , then we are in the situation of example 1 . we will now discuss the case when @xmath299 is @xmath252-irrational .",
    "first , we point out that in any case the set @xmath438 consists of @xmath23 elements : @xmath439 and @xmath440 .",
    "thus , @xmath441 .",
    "there is an obvious periodic orbit .",
    "it corresponds to the intersection of @xmath18 with the equator , and it has @xmath23 segments , perpendicular to @xmath200 .",
    "we will denote this orbit by @xmath442 .",
    "* claim . *",
    "let @xmath299 be @xmath252-irrational .",
    "then @xmath442 is the only prime periodic orbit in @xmath18 .",
    "we will show that any periodic orbit @xmath248 is a multiple of @xmath442 .",
    "we can assume that @xmath248 has an even number , @xmath443 , segments , and that its symbolic code is @xmath444 .",
    "then the element , @xmath445 , of the group @xmath347 that we obtain by tracing @xmath248 is @xmath446 where @xmath447 is the rotation about the vertical axis by the angle @xmath448 .",
    "let @xmath449 be the spherical geodesic corresponding to @xmath248 .",
    "( note that @xmath449 differs , in general , from the unfolding @xmath450 , which is a geodesic segment along @xmath449 . )",
    "the periodicity of @xmath248 implies that @xmath449 is invariant under @xmath445 , which rotates the sphere about the vertical axis by @xmath451 .",
    "the only geodesic invariant under this ( nontrivial ! ) rotation is the equator , which implies the claim .    by convention , a periodic billiard orbit in @xmath18",
    "does not pass through its corners .",
    "in particular , it can not trace the boundary of @xmath18 .",
    "it is not known if every euclidean polygon has a periodic orbit @xcite .",
    "below we present a spherical polygon without periodic orbits .",
    "* example 3*. for @xmath452 let @xmath453 be the isosceles spherical triangle with two right angles , and whose third angle is @xmath299 .",
    "if @xmath299 is @xmath252-rational then every billiard orbit in @xmath454 is periodic . if @xmath299 is @xmath252-irrational",
    ", then @xmath454 has no periodic billiard orbits .",
    "we outline a proof below .    the triangle @xmath454 is obtained from the bigon @xmath18 of example 2 by folding it about the equator .",
    "in this situation , every billiard orbit , @xmath248 , in @xmath454 uniquely lifts to a billiard orbit @xmath450 in @xmath18 ; the orbit @xmath248 is periodic iff so is @xmath450 .",
    "if @xmath299 is @xmath252-rational , then @xmath454 satisfies the conditions of example 1 .",
    "let @xmath299 be @xmath252-irrational , and let @xmath248 be a periodic orbit in @xmath454 . by preceding remark and example 2 , @xmath450 runs along the equator .",
    "thus , @xmath248 traces the boundary of @xmath454 .",
    "we will now discuss the hyperbolic case .",
    "a positive function , @xmath455 , of natural argument is _ subexponential _ if @xmath456 for any @xmath457 and all sufficiently great @xmath12 .",
    "[ hyperb_exp ] let @xmath458 be a geodesic polygon , and let @xmath371 be the complexity of the coding of billiard orbits by sides of @xmath18 .",
    "denote by @xmath459 the _ topological entropy _ of the billiard map in @xmath18 .",
    "+ then @xmath460 ; there exists a subexponential function @xmath455 such that @xmath461 .",
    "* proof . *",
    "the billiard flow of @xmath18 is ( uniformly ) hyperbolic @xcite .",
    "thus , the metric entropy of the billiard flow with respect to the liouville measure is positive . by abramov s formula ,",
    "the metric entropy of the billiard map in @xmath18 is positive , as well .",
    "the metric entropy is a lower bound on the topological entropy , hence our first claim .",
    "let @xmath410 be our defining partition and the partition by sides of the phase space of the billiard map .",
    "let @xmath462 be infinite billiard orbits that bounce of the same sides of @xmath18 as @xmath463 .",
    "let @xmath464 be their unfoldings",
    ". then @xmath464 are infinite geodesics in @xmath465 such that the distance between them is bounded for @xmath463 . hence @xmath466 and @xmath467 implying @xmath468 .",
    "thus , @xmath469 , and hence @xmath395 is a generating partition .    since @xmath411 ,",
    "the convex partition @xmath6 is generating as well .",
    "by @xcite , the complexity of @xmath32 has the form @xmath470 , where @xmath471 is a subexponential function .",
    "the relation @xmath411 implies @xmath472 .",
    "the cardinality of the number of atoms of @xmath473 that partition an atom of @xmath474 grows at most polynomially ; thus @xmath475 for some positive integer @xmath476 .",
    "[ lorenz_rem ]    unlike @xmath477 , the spaces @xmath478 and @xmath479 do not have riemannian metrics , invariant under the natural actions of the groups of isometries of @xmath480 and @xmath481 , respectively .",
    "however , there exists an invariant lorentz metric on @xmath478 .",
    "we describe it below .",
    "let @xmath482 be the upper sheet of the hyperboloid @xmath483 in @xmath484 equipped with the pseudo - riemannian metric @xmath485 .",
    "the induced metric on @xmath482 is the metric of constant negative curvature .",
    "isometries of @xmath482 are the restrictions of @xmath351-orthogonal transformations of the ambient space .",
    "geodesics in @xmath482 are its intersections with planes through the origin .    given such a plane ,",
    "its @xmath351-orthogonal complement is a line that intersects the hyperboloid of one sheet @xmath486 at two antipodal points ; if the plane is oriented then so is the line , and one can canonically choose one of these intersection points .",
    "this construction identifies @xmath478 with @xmath487 .",
    "the metric @xmath351 induces a pseudo - riemannian metric of signature @xmath488 on @xmath487 .",
    "the identification above yields a lorentz metric on @xmath478 .",
    "let now @xmath489 be a geodesic polygon , and let @xmath0 be the phase space of the billiard map in @xmath18 .",
    "the canonical geodesic space structure in @xmath0 is induced by the natural mapping @xmath490 . pulling back the lorenz metric on @xmath478",
    ", we obtain a metric @xmath491 on @xmath0 . by construction , @xmath491 is locally invariant under the billiard map .",
    "is a lorentz metric with singularities . if @xmath18 is a convex polygon , then @xmath491 is regular . ]",
    "thus , the billiard map in a hyperbolic polygon is a piecewise lorentz isometry .",
    "we do not know of any applications of this observation .",
    "let @xmath32 be a piecewise convex transformation . if the mappings @xmath65 are isometries , then @xmath32 is a _ piecewise convex isometry_. piecewise isometries in one dimension are the interval exchange maps .",
    "they arise , in particular , from the billiard in rational polygons @xcite , and have been much studied .",
    "we will investigate the complexity of a particular class of piecewise convex isometries  the outer billiard transformations .",
    "let @xmath38 be a simply connected surface of constant curvature @xmath340 .",
    "for @xmath492 let @xmath493 be the geodesic symmetry about @xmath9 .",
    "let @xmath39 be a convex polygon with @xmath62 vertices @xmath494 listed counterclockwise .",
    "if @xmath495 , set @xmath496 . if @xmath36 , i. e. , @xmath38 is the sphere , we assume that @xmath18 is contained in a hemisphere .",
    "let @xmath497 be the antipodal polygon , and set @xmath498",
    ".    for a vertex , say @xmath209 , of @xmath18 , let @xmath499 be the geodesic ray extending the side @xmath500 in the direction of @xmath209 .",
    "the rays @xmath501 partition @xmath0 into convex polygons @xmath502 .",
    "see figure [ fig3 ] .",
    "we denote this partition by @xmath6 .",
    "the statement below defines the protagonist of this section .",
    "let @xmath506 be the partition of @xmath0 defined above .",
    "then @xmath6 is a convex geodesic partition .",
    "the piecewise convex isometry @xmath32 defined by the geodesic symmetries @xmath507 is the _",
    "outer billiard _ about @xmath18 , and the geodesic surface @xmath508 ( it is a topological annulus ) is the _ phase space of the outer billiard_.    we will use the notation @xmath509 for the outer billiard , suppressing the subscript if no confusion arises . by _ complexity of the outer billiard _ we mean the complexity of @xmath32 with respect to the partition @xmath6 .",
    "now we introduce notation and terminology that will be used throughout this section . if @xmath510 are two positive sequences then we write @xmath511 if there is a constant @xmath512 such that for all @xmath12 sufficiently large @xmath513 .",
    "if @xmath511 and @xmath514 , then we write @xmath515 ; we will say that the sequences _ have the same growth _ or are in the _ same ( growth ) class_. if @xmath516 then we say that @xmath351 grows at most polynomially with degree @xmath476 , or that @xmath351 is bounded by @xmath517 .",
    "if @xmath518 is a group with a finite set @xmath519 of generators , we denote by @xmath520 the set of elements that can be represented by products of at most @xmath12 elements of @xmath199 and their inverses .",
    "the growth class of the sequence @xmath521 does not depend on the choice of @xmath199 @xcite .",
    "if @xmath522 , then we say that the group @xmath518 _ grows polynomially , with degree @xmath476_.    let @xmath523 be the group generated by the geodesic reflections in the vertices of the polygon @xmath18 .",
    "we will relate the growth of @xmath518 and the complexity of the outer billiard about @xmath18 .",
    "we proceed to study separately the three cases at hand .",
    "* proof . * the edges of the graph @xmath104 are parallel to the sides of @xmath18 ; each edge is a segment or a half - line .",
    "assume , for simplicity of exposition , that @xmath18 has no parallel sides .",
    "then there are @xmath62 directions . for each direction",
    "there are @xmath12 parallel half - lines , hence their total number is @xmath525 . since they partition @xmath0 into @xmath525 components ,",
    "the number of faces of @xmath104 is at least @xmath525 .",
    "this yields the linear lower bound on complexity .",
    "now , for the upper bound .        * proof . *",
    "the subgroup @xmath529 generated by @xmath530 is a quotient group of @xmath531 ; hence its growth is bounded by @xmath528 . since @xmath482 is a normal subgroup of @xmath518 of index @xmath23 , the two groups have the same growth .        * proof . *",
    "the edges of @xmath537 are obtained from the edges of @xmath534 by applying the inverse map @xmath538 .",
    "each time a singularity half - line of @xmath538 intersects an edge of @xmath534 , this edge splits into two , and thus contributes @xmath198 to @xmath539 .",
    "let @xmath540 be the set of straight lines obtained by reflecting at most @xmath12 times in the vertices of @xmath18 the extentions of the sides of @xmath18 .",
    "by lemma [ growthgroup ] , @xmath541 .",
    "each of these lines intersects a singularity half - line of @xmath538 at most once , therefore the total number of intersections of the lines in @xmath540 with the singularity half - lines of @xmath538 is bounded above by @xmath528 .",
    "the edges of @xmath534 belong to the lines from @xmath540 , therefore the total number of intersections of these edges with the singularity half - lines of @xmath538 is bounded above by @xmath528 .",
    "( note that the number of the edges of @xmath534 could be bigger . )",
    "we will now obtain the desired bound on complexity , i.e. , we will estimate the number of faces of @xmath104 .",
    "denote by @xmath542 the number of faces , edges , vertices of the graph @xmath104 respectively . by lemma",
    "[ growthygraph ] , growth of the second difference of the sequence @xmath543 is at most polynomial of degree @xmath544 , hence @xmath545 .",
    "the edges of @xmath104 are parallel to the sides of @xmath18 , thus may have at most @xmath62 possible directions .",
    "therefore , each face of @xmath104 is at most a @xmath546-gon , and the valence of each vertex of @xmath104 is at most @xmath546 .",
    "thus , @xmath547 .",
    "formula @xmath548 implies @xmath549 , hence @xmath550 .",
    "we have obtained our bound , assuming that the rank of the abelian group generated by the sides of @xmath18 is @xmath544 , i.e. , maximal possible .",
    "although generically this is the case , the rank may drop .",
    "our argument proves , in fact , the statement below .",
    "[ bound_cor ] let @xmath18 be a convex euclidean @xmath62-gon , and let @xmath551 be the rank of the abelian group generated by translations in the sides of @xmath18",
    ". then the complexity of the outer billiard about @xmath18 is bounded by @xmath552 .",
    "a polygon is _ rational _ if the rank above is @xmath23 .",
    "rational polygons are dense in the space of all polygons .",
    "we will study complexity of the outer billiard about a rational polygon .",
    "first , we recall preliminaries .",
    "we regard the plane as a vector space , with the center in the interior of the convex @xmath62-gon @xmath18 .",
    "a well known construction @xcite associates with @xmath18 a homothetic family of centrally symmetric convex polygons with at most ( resp .",
    "exactly ) @xmath546 sides ( resp . if @xmath18 is a generic @xmath62-gon ) .",
    "let @xmath454 be a particular polygon in this family .",
    "each of its sides is parallel to a diagonal of @xmath18 .",
    "see figure [ figa ] .",
    "we endow the plane with a minkowski norm such that @xmath454 is the unit disc .",
    "the vector norm @xmath553 , radius , etc , will be understood with respect to it .",
    "we set @xmath554 .",
    "the polygon @xmath454 determines the geometry of orbits of @xmath555  at infinity \" @xcite",
    ". we will elaborate .",
    "let @xmath9 be a point in the plane which is sufficiently far from the origin .",
    "let @xmath556 be the circle centered at the origin and passing through @xmath9 .",
    "let @xmath557 be the side containing @xmath9 , and let @xmath476 be the corresponding diagonal of @xmath18 ( parallel to @xmath209 ) .",
    "then @xmath555 translates @xmath9 along @xmath209 by @xmath558 ; this continues until the orbit of @xmath9 overshoots @xmath209 .",
    "let @xmath559 be the corresponding point .",
    "then the recipe above is applied to @xmath560 , etc .",
    "see figure [ figb ] .",
    "let @xmath209 be an arbitrary side of @xmath454 , and let @xmath476 be the corresponding diagonal of @xmath18 .",
    "the polygon @xmath18 is _ quasirational _ if , up to a common factor , the @xmath62 numbers @xmath561 are rational .",
    "* proof . *",
    "every rational polygon is quasirational . by a construction of r. kolodziej @xcite",
    ", there is a nested sequence of @xmath33-invariant polygonal simply connected domains @xmath563 exhausting the plane .-",
    "gons remains an open question for @xmath564 @xcite .",
    "] by @xcite , there exists a constant @xmath565 such that the _ kolodziej domains _ satisfy @xmath566 .",
    "we will need a general lemma .",
    "[ infinity ] let @xmath18 be an arbitrary convex polygon , and let @xmath371 be the complexity of the outer billiard about @xmath18 .",
    "there exists @xmath567 such that the contribution to @xmath111 of the exterior of the disc of radius @xmath568 grows linearly .",
    "consider the @xmath555-orbit of length @xmath12 of an arbitrary point @xmath9 outside of @xmath571 .",
    "it follows a side , @xmath209 , of @xmath454 for @xmath375 iterations , then it  jumps \" to the adjacent side , @xmath572 , and follows it for @xmath573 iterations . counting the possibilities ( and assuming that @xmath454 is a @xmath546-gon , i.e. , that we are in the generic sitiation ) we obtain @xmath574 types of @xmath555-orbits of length @xmath12 .",
    "but different types mean different contributions to @xmath575 , and vice versa .",
    "since @xmath18 is a rational polygon , the group @xmath576 is discrete .",
    "the graphs @xmath104 are obtained from a finite collection of half - lines by @xmath518-action , hence @xmath577 belongs to a discrete collection of lines .",
    "therefore @xmath578 is a graph , and the sequence @xmath579 stabilizes on compacta .",
    "moreover , there is a finite collection of convex polygons , such that every face of @xmath578 is congruent to a polygon in this collection .",
    "hence the areas of the faces of @xmath578 are bounded away from zero and infinity .",
    "note that the constant @xmath580 in lemma  [ infinity ] can be chosen arbitrarily large .",
    "we choose it so that @xmath581",
    ". then for all @xmath12 sufficiently large @xmath582 by lemma  [ infinity ] , up to a linear term , @xmath111 is the number of faces of @xmath104 intersecting @xmath583 . by the left inclusion in ( [ inclu_eq ] ) , this is less than or equal to the number of faces of @xmath578 in @xmath584 . by preceding remarks ,",
    "there is @xmath585 such that that number is bounded by @xmath586 . by the right inclusion in ( [ inclu_eq ] ) , @xmath587 is quadratic in @xmath12 .",
    "we have obtained the upper bound @xmath588 .",
    "now for the lower bound .",
    "all regular points in @xmath0 are periodic @xcite .",
    "a face @xmath589 of @xmath590 is _ stable _ if @xmath591 is a face of @xmath578 .",
    "let @xmath592 be the set of points with period at most @xmath12 .",
    "each connected component of @xmath593 is an open , stable face of @xmath104 . by remarks above",
    ", the number of connected components of @xmath593 has the same growth as the area of @xmath593 , thus @xmath594 . by proposition  [ period_lem ] below , @xmath595 .",
    "the following proposition is used in the proof of theorem  [ rational ] .",
    "it is also of independent interest .",
    "if @xmath596 are positive functions on @xmath597 , the notation @xmath598 means that @xmath599 is bounded as @xmath600 .",
    "the notation @xmath601 means that @xmath602 .",
    "* we assume without loss of generality that @xmath609 . let @xmath556 be the circle through point @xmath9",
    ". the sequence @xmath610 roughly follows @xmath556 . to come back to @xmath9 ,",
    "the sequence has to go around @xmath556 at least once .",
    "let @xmath611 be the  largest step \" of @xmath555 .",
    "then we need at least @xmath612 steps to return .",
    "since @xmath613 , the first claim follows .",
    "let now @xmath18 be rational , and hence quasirational polygon , and let @xmath614 be the kolodziej domains .",
    "let @xmath615 be such that @xmath616 .",
    "the relations @xmath617 imply that the function @xmath618 satisfies @xmath619 . by inclusion @xmath620",
    ", we have @xmath621 . the point @xmath9 belongs to a unique face , @xmath622 , of @xmath578 , hence @xmath623 . by preceding remarks , @xmath624 , implying @xmath625 , and hence the equivalence @xmath626",
    ".            * proof . * for @xmath629 let @xmath630 be the appropriately oriented great circle centered at @xmath9 .",
    "this diffeomorphism @xmath631 is the _ spherical duality _ , and we denote by @xmath632 the inverse diffeomorphism .",
    "let @xmath633 be the vertices of @xmath18 .",
    "the geodesics @xmath634 bound the convex polygon @xmath635 .",
    "the correspondence @xmath636 is an automorphism of the space of convex spherical polygons .",
    "the proof of the following lemma is contained in @xcite .",
    "( see also @xcite . )",
    "[ duality ] let @xmath637 be as above .",
    "let @xmath638 be the phase spaces of the outer billiard about @xmath18 , inner billiard about @xmath635 , and let @xmath639 be the outer billiard , inner billiard maps respectively .",
    "the spherical duality induces a diffeomorphism @xmath640 ; it conjugates @xmath641 and @xmath642 ; it induces an isomorphism of the coding of @xmath21-orbits by corners of @xmath18 and the coding of @xmath17-orbits by sides of @xmath635 .",
    "figure  [ figh ] illustrates lemma  [ duality ] .",
    "let @xmath643 ( resp .",
    "@xmath644 ) be the corner complexity of the outer billiard about @xmath18 ( resp .",
    "billiard in @xmath635 ) . by lemma  [ duality ] , @xmath645 .",
    "the claim now follows from theorem  [ spheresubexp ] .",
    "we refer to @xcite for the background on polygonal outer billiards in the hyperbolic plane .",
    "let @xmath458 be a @xmath62-gon , let @xmath646 , and let @xmath1 be the outer billiard map .",
    "it extends to a homeomorphism of the circle at infinity , @xmath647 .",
    "its rotation number satisfies @xmath648 @xcite .",
    "the polygon @xmath18 is _ large _ if @xmath649 and @xmath650 has a hyperbolic @xmath62-periodic orbit .",
    "see figure [ figc ] .",
    "the set of large polygons is open in the natural topology @xcite .",
    "* proof . *",
    "the bound @xmath651 fails iff the sequence @xmath653 stabilizes .",
    "assume this to be the case , and let @xmath654 .",
    "the outer billiard map @xmath1 preserves @xmath578 ; the restriction of @xmath33 to a closed face of @xmath578 is a diffeomorphism onto another one .",
    "since @xmath578 is a finite graph , we find @xmath655 such that every face of @xmath578 is invariant under @xmath656 .",
    "let @xmath591 be a closed face of @xmath578 .",
    "then @xmath657 is either empty , or a vertex , or an edge of @xmath591 .",
    "we will study the latter .",
    "let @xmath658 be the consecutive endpoints of these edges , let @xmath659 ( resp .",
    "@xmath660 ) be the circular arc ( resp .",
    "the geodesic ) with endpoints @xmath661 ( we set @xmath662 ) , and let @xmath663 be the corresponding face of @xmath578 .",
    "the restriction @xmath664 is induced by an isometry , @xmath665 .",
    "the elements @xmath666 are all equal to the identity iff @xmath667 .",
    "* let @xmath669 be a vertex of @xmath18 .",
    "for close points @xmath670 let @xmath671 be their reflections about @xmath669 .",
    "let @xmath672 and let @xmath673 be the angular measure of the arc @xmath674 ; see figure [ fige ] . the triangles @xmath675 and @xmath676 are similar , therefore @xmath677    let @xmath678 be a periodic trajectory of the map @xmath650 consisting of smooth points , and let @xmath679 be the respective ratios . set @xmath680 .",
    "let @xmath681 be a point sufficiently close to @xmath314 , and let @xmath682 be its @xmath650-orbit ; we assume that for both orbits the reflections occur in the same vertices of @xmath18 .",
    "it follows from equation  [ cyclicorb ] that @xmath682 is a periodic trajectory iff @xmath683 in particular , if @xmath650 has a periodic interval , then @xmath684 there .",
    "let now @xmath314 cross counter - clockwise a singularity half - line of @xmath33 . in the notation of figure [ figf ] , @xmath685 ( resp .",
    "@xmath686 ) right before ( resp .",
    "after ) this . by @xmath687 , the equality @xmath684",
    "before a singularity half - line implies that @xmath688 immediately after it .    by lemma  [ nonperiod ] , we can assume without loss of generality that @xmath689 .",
    "then @xmath690 is a ( hyperbolic ) parallel translation with the axis @xmath691 , and @xmath692 is the domain bounded by @xmath691 and @xmath693 .",
    "we will say that @xmath692 is a _ lunar face _ of @xmath578 .",
    "the union of lunar faces of @xmath578 is invariant under @xmath33 .",
    "therefore for any @xmath694 there is @xmath695 such that @xmath696 .",
    "a geodesic @xmath697 can not contain a side of @xmath18 .",
    "if it does , then @xmath663 contains a singular line of @xmath33 in its interior , contrary to the definition of @xmath663 .",
    "see figure [ figf ] where @xmath698 represents now the geodesic @xmath691 .",
    "thus , @xmath691 is not an edge of @xmath699 for any @xmath700 .",
    "this contradiction proves our first claim .",
    "[ degen_rem ] note that the function @xmath371 is bounded below by the complexity of the induced map @xmath647 with respect to the natural partition .",
    "however , the latter may be finite .",
    "see figure  [ figg ] ."
  ],
  "abstract_text": [
    "<S> abstract we introduce the class of piecewise convex transformations , and study their complexity . </S>",
    "<S> we apply the results to the complexity of polygonal billiards on surfaces of constant curvature . </S>"
  ]
}