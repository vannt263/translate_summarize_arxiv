{
  "article_text": [
    "it is well - known that wang - landau sampling ( wls ) @xcite faces difficulties for continuous systems such as atomic clusters @xcite , polymers and proteins @xcite , liquid crystals @xcite , and spin models @xcite . in continuous systems ,",
    "the volume of phase space near the ordered ( low entropic ) states is infinitesimally small compared to that of the disordered ( high entropic ) regions . nevertheless , the traditional wls uses the same random trial moves for the whole range of energies , even though the phase space volume between the ordered and disordered states can differ by many orders of magnitude in different energy domains .",
    "this makes it very hard for the random walker of wls to perform statistically significant visits to the low entropic states .",
    "an energy - independent random trial move naturally favors diffusion into the voluminous and disordered regions of phase space , whereas visits to the ordered regions are  forced \" upon the random walker solely by the acceptance - rejection criterion . as a result",
    ", one needs to perform long simulations to properly sample the rare ordered states .",
    "such difficulties are indeed well - documented in the literature . on the theoretical side",
    ", the classic paper by zhou and bhatt@xcite showed that the statistical error of wls progresses as @xmath0 , where @xmath1 is the modification factor used in wls , and is @xmath2 is a constant .",
    "this constant was later shown by morozov and lin @xcite in a careful analysis of discrete systems to be proportional to the rate of change of entropy with energy @xmath3 .",
    "if we apply their result to continuous systems where the entropy gradient at the ground state diverges , it means that the statistical error of wls diverges . in numerical simulations ,",
    "such problems have been reported in many complex and challenging continuous systems such as protein molecules @xcite and liquid crystals @xcite .",
    "perhaps the most telling example is that even for a simple and well - understood system such as the ferromagnetic @xmath4 model , traditional wls faces difficulties sampling the ordered states @xcite .",
    "there have been previous studies addressing the sampling of low entropic states in wls .",
    "xu and ma @xcite studied the two dimensional @xmath4 model where the density of states ( dos ) is known to change very steeply near the ground state energy .",
    "they first analytically derived the low temperature approximation of the partition function and then made a laplace transform to obtain the approximate dos near the ground state energy . using this as the initial approximation , they performed wls in a narrow region of low energy space to refine their dos .",
    "however , their approach can not be applied to more general systems such as spin glasses where the ground state is not known _ _ a priori__@xcite .",
    "furthermore , restricting the random walker to only a limited energy range makes it non - ergodic in frustrated systems .",
    "al . proposed updating and smoothing the dos with a continuous kernel @xcite .",
    "although the effects of smoothing does indeed help in the sampling of the dos at low entropic regions , this method is heuristic , and the width of the kernel might affect the outcome .    actually , the difficulty of sampling the low entropic regions of phase space is not restricted just to wls , and has indeed been studied previously within the general context of monte carlo simulations by bouzida , kumar , and swendsen @xcite . the main idea is to strike a balance between choosing a good step size for the trial move and rapid exploration of the entire phase space . using smaller step sizes for the trial move can improve the sampling of ordered states",
    "this is because small moves allow the system to make minor adjustments to fine - tune itself into a highly specific ordered configuration .",
    "however , the problem with making small steps is that it leads to slow exploration of phase space .",
    "the acceptance ratio method of bouzida , kumar , and swendsen is a systematic way of achieving high computational efficiency by balancing a good step - size with fast exploration of phase space . in this method ,",
    "one updates the step size @xmath5 as @xmath6 where @xmath7 and @xmath8 are the current and optimum ( i.e. desired ) acceptance rate , @xmath9 and @xmath10 are the current and new ( i.e. improved ) step sizes , and @xmath11 are constants to protect against singularities when @xmath12 or 1 . given @xmath7 , eq .",
    "( [ eq : bks intro ] ) iteratively adjusts the step size to achieve @xmath8 .",
    "@xcite a systematic study by the original authors has found the best @xmath8 for systems in various dimensions @xcite .    in this paper",
    ", we propose two ideas to circumvent the difficulties faced by the wls in sampling the low entropic regions .",
    "the first is to generalize the acceptance ratio method by bouzida et .",
    "such that the step size @xmath5 and the acceptance rate @xmath7 in eq .",
    "( [ eq : bks intro ] ) become energy - dependent .",
    "more precisely , we would like @xmath5 to be small in the ordered regions of phase space , but large in the disordered regions .",
    "this will enable the random walker to make small moves at the low entropic regions to sample rare states , but also make larges moves to quickly diffuse through the easily sampled disordered ones . by making the acceptance rate @xmath7 energy - dependent as well",
    ", we can use eq .",
    "( [ eq : bks intro ] ) to adjust @xmath5 at a particular energy based on the acceptance rate of that energy .",
    "our second contribution is to generalize the updating the dos . in the original wls ,",
    "the dos is updated with the same modification factor @xmath1 for the entire energy range .",
    "we propose multiplying @xmath1 by an energy - dependent factor .",
    "as discussed above , generalizing the acceptance ratio method will provide us with an optimized trial move step size that reflects the entropic structure of phase space at that energy .",
    "a large step size means that at that energy , the phase space is large , whereas a small step size will imply that the phase space at that energy is small .",
    "hence , we propose multiplying the modification factor by the optimized trial move step size .",
    "our physical motivation is that the modification factor should be large at high entropic states to quickly accumulate the estimated dos , whereas for small entropic states , the accumulation should be more gradual to avoid sudden increments that usually leads to overestimation of visits to these small regions of phase space .",
    "ideally , we want more frequent visits to the low entropic region but a slower and careful accumulation of dos through the use of smaller modification factors .",
    "we shall refer to our proposed method as the adaptive wang - landau sampling ( adawl ) .",
    "actually , our proposed strategy constitutes a significant departure from the original wls .",
    "it might be questioned if biasing the wls in an energy - dependent fashion might lead to an erroneous dos .",
    "we shall show numerically by comparing with benchmark calculations that our generalization of wls does lead to the correct dos , and indeed , it improves dramatically upon the original wls .",
    "the rest of the paper is organized as follows . in section",
    "[ sec : adawl ] , we describe our algorithm in detail . section [ sec : model ] introduces our test model , the two - dimensional square lattice @xmath4 model , as a testbed for our method .",
    "section [ sec : numerical ] presents results of numerical simulations . in particular , we look at three different measures to assess the performance of adawl compared to wls : the specific heat , the first visit time , and the saturation error of the dos .",
    "details about these measures will be described in the respective subsections .",
    "we discuss and conclude in section [ sec : discussion ] .",
    "wang - landau sampling performs a random walk in energy space and seeks to provide an accurate estimate of the microcanonical density of states . in the traditional wls , a trial move with a fixed step size is used to sample a new configuration @xmath13 from the current configuration @xmath14 , i.e. @xmath15=q_{0}(x ) , \\label{eq : ver025:original trial move}\\ ] ] where @xmath16 $ ] is the probability of making the trial move from @xmath14 to @xmath13 , the random variable @xmath17 gives the change from @xmath14 to @xmath13 , and @xmath18 is a probability distribution for generating @xmath17 using a constant step size which remains fixed during simulation .",
    "for instance , @xmath18 can be a gaussian distribution with the standard deviation being the step size",
    ". then @xmath19 can be how much to move the position of a particle , where @xmath20 and @xmath21 are the positions of the particle before and after the trial move .",
    "note that apart from having a fixed step size , @xmath18 is also independent of the configuration of the system . in other words , @xmath22 is the same for every point in the entire phase space .",
    "trial moves can in general depend on the system configuration , an example being the swendsen - wang @xcite and other cluster algorithms @xcite where the flipping of a cluster of spins depends on the current existing spin clusters .",
    "the traditional wls , however , usually employs configuration - independent trial moves . using a trial move like eq .",
    "( [ eq : ver025:original trial move ] ) , wls accepts the new state @xmath13 with probability @xmath23 where @xmath24 and @xmath25 are respectively the energies of the current and proposed configurations , and @xmath26 is the estimated dos at energy @xmath24 .",
    "note that as the trial move does not depend on system configuration , @xmath18 does not appear in eq .",
    "( [ eq : wl ] ) . after each move ,",
    "wls modifies the dos as @xmath27 by means of a modification factor @xmath28 .",
    "the subscript @xmath29 indicates the @xmath29th @xmath1 stage of the wang - landau algorithm . in their original formulation ,",
    "wang and landau proposed reducing this factor as @xmath30 based on the flatness of the accumulated histogram .",
    "however , detailed investigations by various authors have found that histogram flatness is not a satisfactory criterion @xcite .",
    "here we shall adopt a different criterion based on the saturation of the dos error , which will be described in section [ sec : ver024 : saturation ] . for continuous system ,",
    "the energies are discretized , and the estimated @xmath26 is a piecewise constant function , i.e. @xmath31 within each energy bin @xmath32 .    in adawl , to generate the proposed new configuration @xmath33 , our trial moves will be more general and depend on the current configuration @xmath14 .",
    "let us first define the adjustable probability distribution @xmath34 whose width can be tuned using @xmath35 .",
    "the actual form of @xmath34 will depend on the system and the kinds of moves one wishes to make .",
    "we can choose to make the distribution narrow or wide using @xmath35 .",
    "in practice , @xmath35 will be substituted by the step size of the trial move . in this paper",
    ", we use an energy - dependent step size @xmath36 and set @xmath37 .",
    "if we consider just single - site update so that @xmath14 and @xmath33 differ by one site , our trial move is given by @xmath38 = \\frac{1}{n } q(x ; \\delta(e ) ) ,   \\label{eq : trial}\\ ] ] where @xmath39 $ ] is the probability of making the trial move from @xmath14 to @xmath13 with step size @xmath36 .",
    "the step size @xmath36 is the size of the move at the energy @xmath24 .",
    "note that since the energy in @xmath36 is a function of the configuration @xmath14 , the trial move eq .",
    "( [ eq : trial ] ) is now dependent on system configuration , unlike eq .",
    "( [ eq : ver025:original trial move ] ) which is not .",
    "the factor @xmath40 is to account for the probability of selecting one site out of @xmath41 ( e.g. the total number of spins ) . in numerical calculation , @xmath36 is represented as a piecewise constant function of energy , i.e. @xmath42 for @xmath32 .",
    "the challenge now is to optimize the step sizes @xmath43 for the most efficient simulation .",
    "we extend the acceptance ratio method of bouzida et .",
    "al . @xcite and update @xmath43 at the energy bin @xmath44 according to @xmath45 where @xmath46 is the optimal acceptance rate , and @xmath2 , @xmath47 are constants to protect against singularities .",
    "the choice of @xmath46 depends on the dimension of the system , and we shall use the value recommended by bouzida et .",
    "al .. the parameters @xmath46 , @xmath2 , and @xmath47 we used in this paper for our simulations are given in the caption of table [ table : simulation_parameters ] .    during simulations , we first initialize @xmath43 to a constant value for all energy bins .",
    "in addition to the usual histogram , we also accumulate the counts of accepted and rejected moves at bin @xmath44 , @xmath48 and @xmath49 . after a certain number of monte carlo moves ,",
    "we compute the acceptance rate at @xmath44 as @xmath50 and use eq .",
    "( [ eq : arm ] ) to update the step sizes .",
    "we now describe the transition probability from the old configuration @xmath14 to the new one @xmath13 .",
    "unlike eq .",
    "( [ eq : wl ] ) for the wls , our trial moves depend on the system configuration .",
    "hence , the transition probability has to be modified to obtain an unbiased sampling : @xmath51}{t[\\sigma^{\\prime}|\\sigma;\\delta(e)]\\ , } \\cdot \\frac{\\tilde{g}(e)}{\\tilde{g}(e^{\\prime } ) } \\right ) , \\label{eq : db}\\ ] ] where @xmath39 $ ] is the probability of making the forward move , @xmath52 $ ] that of making the backward one , and both are given by eq .",
    "( [ eq : trial ] ) .",
    "@xmath53 is a linearly - interpolated estimate of the dos .",
    "the ratio @xmath54 is used to account for the energy - dependent accumulation of the dos which we will now describe . as mentioned in the introduction",
    ", adawl adopts an energy - dependent modification factor , @xmath55 where @xmath28 is as defined in wls , and @xmath56 is our new modification factor . to accommodate the possibility of using non - uniform intervals between energy levels",
    ", the updating of @xmath57 and histogram @xmath58 at each step has to take into account the actual size of the bins , @xmath59 where @xmath60 is the size of the bin width at @xmath44.@xcite    this completes the description of adawl .",
    "a summary of the algorithm is given in appendix [ sec : summary adawl ] .",
    "to test our new algorithm , we consider the two - dimensional @xmath61 square lattice @xmath4 model , @xmath62 where @xmath14 is now a vector of @xmath41 spins @xmath63 , @xmath64 , @xmath65 denotes summation over nearest - neighbor pairs , and periodic boundary condition is used for both lattice dimensions .",
    "@xmath66 is the total number of spins . the @xmath4 model ,",
    "although simple , has been shown to contain the essential difficulties encountered in many continuous systems , and hence is a good testbed for our method @xcite .",
    "we first specify the adjustable distribution @xmath34 , @xmath67 @xmath68 is symmetric and piecewise linear in @xmath17 .",
    "@xmath69 is the adjustable width . from the normalization condition ,",
    "we get the height of the distribution @xmath70 . fig .",
    "[ fig : q ] shows plots of @xmath34 for some values of @xmath35 . for",
    "the trial move , first pick at random a lattice site @xmath71 , then draw a random variable @xmath17 from the distribution @xmath34 , and then update the spin as @xmath72 the width of the distribution @xmath35 is specified by the step size @xmath36 .",
    "when step size is small , i.e. @xmath73 , @xmath74 is a delta function sharply centered at @xmath75 , and the new configuration @xmath76 is close to the current one @xmath77 .",
    "when the step size is large , i.e. @xmath78 , @xmath74 approximates the uniform distribution , and the new configuration is uncorrelated with the current one .",
    "@xmath34 satisfies our requirements for an adjustable distribution and is simple enough to allow us to sample @xmath17 efficiently @xcite .",
    "we also bin the energy levels non - uniformly .",
    "the top panel of fig .",
    "[ fig : logg ] shows the dos of the @xmath4 model for @xmath79 .",
    "the dos is symmetric , is relatively flat around @xmath80 , and drops abruptly near the minimum and maximum energies @xmath81 and @xmath82 .",
    "hence , in both our wls and adawl simulations , we assign smaller energy bins near @xmath81 and @xmath82 in order to represent the dos near the edges more accurately .",
    "this is accomplished by using the following formula to assign the negative energies , @xmath83 the initial energy level is given by @xmath84 .",
    "the gaussian - like exponential term in eq .",
    "( [ eq : bin_width ] ) is to make neighboring energies close near @xmath81 where the dos drops abruptly , but far apart near @xmath80 .",
    "the constants @xmath85 , @xmath86 , and width of the initial bin @xmath87 are set manually .",
    "@xmath85 is a positive even integer that controls the rate of increase of the exponential term .",
    "@xmath86 is the width at @xmath80 .",
    "@xmath88 is determined once @xmath85 , @xmath86 , and @xmath89 have been specified .",
    "the binning parameters we used are listed in table [ table : simulation_parameters ] .",
    "the negative energies are reflected about @xmath80 to obtain the positive energies . the bottom graph in fig .",
    "[ fig : binwidth ] shows the bin widths we used for @xmath90 in the simulations of this paper .",
    "the procedure for our numerical simulation of wls and adawl is as follows .",
    "the binning of energies are set using eq .",
    "( [ eq : bin_width ] ) . at the start of the simulation , @xmath91 .",
    "the modification factor is reduced in stages as @xmath92 , where in the final stage @xmath93 we have @xmath94 . for each stage , we perform simulation until the error of the dos saturates for that stage before reducing the modification factor . the error of the dos will be discussed in detail in section [ sec : ver024 : saturation ] . for each system size @xmath95 , we computed a total of @xmath96 independent trajectories where each trajectory is started using a different random seed .",
    "the details of the simulation parameters are summarized in table [ table : simulation_parameters ] .    for wls ,",
    "our trial moves are also given by eq .",
    "( [ eq : q ] ) with @xmath35 being a constant @xmath97 .",
    "we have experimented with several constant step sizes and found @xmath98 to perform the best .",
    "the numerical results supporting this claim are presented in subsections [ sec : ver024 : ergordicity ] and [ sec : ver024 : saturation ] and the insets of figs .",
    "[ fig : fvt ] and [ fig : dh ] . in the rest of the paper ,",
    "unless otherwise stated , we shall be comparing adawl with wls of step size 0.05 .    for adawl ,",
    "the step sizes are @xmath99 for all @xmath44 at the start of the simulation . during simulation",
    ", we also accumulate @xmath100 and @xmath101 .",
    "once every @xmath102 single site updates per spin , we use eqs .",
    "( [ eq : arm ] ) and ( [ eq : ver023:a_r_p ] ) to update the step sizes . @xmath100 and @xmath101 are then reset to zero , and their accumulation restarted for the next iteration of step size update . during simulations , the curves for @xmath103 and @xmath36 converged very quickly ( i.e. after a few iterations of eqs .",
    "( [ eq : arm ] ) and ( [ eq : ver023:a_r_p ] ) ) . fig .",
    "[ fig : logg ] shows the dos , @xmath103 , and @xmath36 of our adawl simulation for @xmath79 .",
    "as can be seen , eq .",
    "( [ eq : arm ] ) adjusts the step sizes such that the acceptance rate is @xmath104 . in the high dos energy range between -50 and 50 ,",
    "the acceptance rate did not reach @xmath104 because the step size has already saturated to the maximum of 1 and the acceptance rate can not be further optimized .",
    "the dos is updated quickly with the maximal modification factor in this energy range . near the edges of the dos , the step size and modification factors are both small , and the dos is updated gradually .    in the following ,",
    "we compare the performance between wls and adawl using three different measures : ( 1 ) the specific heat capacity , ( 2 ) the first visit time , and ( 3 ) the saturation of dos error .",
    "we first demonstrate that adawl computes the correct dos , and that it is more accurate than wls . to do that , we compute the specific heat capacity .",
    "we first divide @xmath96 into four equal portions . for each portion , we compute the mean of the dos ( i.e. we average over the final dos s of the @xmath105 trajectories ) .",
    "this average dos is used to compute the specific heat capacity per spin @xmath106 at temperature @xmath107 using @xmath108 where the thermal average of @xmath109 is given by @xmath110 the @xmath106 is then further averaged over the four portions .",
    "we denote this specific heat averaged over the four portions as @xmath111 .",
    "[ fig : cvall ] shows the results of @xmath111 for @xmath90 and @xmath112 .",
    "the left ( right ) panels are for adawl ( wls ) .",
    "@xmath111 is given by the solid curve .",
    "the standard error at some temperatures is also indicated using error bars .",
    "the size of the error bars show that the precision of the specific heat calculated by adawl is better than that of wls . for @xmath113",
    ", it is apparent that wls produces a grossly incorrect curve for @xmath111 . to check the accuracy of the adawl results , we performed metropolis simulations to generate accurate specific heat capacity values at selected temperatures , and these are also plotted for comparison in fig . [",
    "fig : cvall ] using solid circles .",
    "the @xmath111 curves from adawl agree very well with the results of metropolis calculations .",
    "the actual @xmath111 values from all three methods are also listed in tables [ table : cv_l16 ] ( @xmath90 ) and [ table : cv_l32 ] ( @xmath113 ) .",
    "we see that adawl is consistently closer to the benchmarked metropolis numbers compared to wls",
    ".    the simulation parameters of our metropolis calculations are listed in table [ table : simulation_parameters ] .",
    "one way to measure the performance of a random sampler is its ergodicity . the more ergodic the sampler , the more efficient it is in exploring representative parts of phase space . for the wang - landau algorithm ,",
    "some authors have used the so - called tunneling time as a measure of ergodicity @xcite .",
    "this is the time it takes for the random walker to go from one energy minimum configuration to another .",
    "the shorter the tunneling time , the more ergordic is the random walker .    here",
    ", we adopt a related measure of ergodicity which is much easier to compute  the first visit time . at the start of each @xmath1 stage of the wls or adawl simulation when the modification factor has just been decreased ,",
    "the histogram is zero for all energy bins .",
    "the first visit time is defined as the time it takes for all the bins of the histogram to be visited at least once by the random walker . for each trajectory , we compute one first visit time for each @xmath1 stage of the simulation .",
    "we then average over @xmath96 trajectories .",
    "[ fig : fvt ] shows the results .",
    "the average first visit times is plotted against @xmath114 for adawl and wls for various system size .",
    "generally , adawl ( filled symbols ) visits all energy levels much faster than wls ( empty symbols ) at all stages and for all system sizes , implying better ergodicity .",
    "the insert is a similar plot comparing the results for wls with different constant step sizes ; a constant step size of @xmath115 performs the best for wls .",
    "the first visit time at small @xmath1 for @xmath90 is similar for adawl and wls .",
    "we attribute this to binning effects which will be discussed in section [ sec : ver026:discuss nonuniform binning ] .    in their study of the @xmath4 model , sinha and roy@xcite",
    "reported that the random walker of wls frequently does not visit energy bins near @xmath81 and @xmath82 . here , we mention that our bins near the edges are much smaller and also nearer to @xmath81 and @xmath82 compared to what sinha and roy had used . that adawl has",
    "no difficulty sampling all energy bins is indicative that it performs better than wls .",
    "we now consider the error in the dos . in wang and",
    "landau s original formulation , the ` flatness of histogram ' criterion was used as a measure of convergence of the wls .",
    "each stage of the sampling was performed until the accumulated histogram becomes sufficiently flat before the modification factor is reduced .",
    "however , it is now known that this is not a good measure of convergence because the height of the histogram increases linearly with time and will ultimately reach flatness regardless of whether the simulation for that stage has converged or not .",
    "detailed studies by various authors on the dos error of wls have revealed that the error is related to the modification factor instead of histogram flatness @xcite . also , the use of arbitrary histogram flatness as a criterion has been shown to lead to non - convergence of wls by @xcite .",
    "the correct convergence of wls has also been proposed by morozov and lin @xcite .    in a separate investigation , lee et .",
    "@xcite formulated a more precise measure of the convergence of wls which is shown to agree with the @xmath116 analysis by zhou and bhatt .",
    "details will be presented in appendix [ sec : ver024:dh ] . here",
    "we shall present the main idea .",
    "denote the histogram for the @xmath29th stage of the simulation as @xmath117 .",
    "we define a new histogram @xmath118 obtained by subtracting away the minimum value of @xmath117 , i.e. @xmath119 hence , @xmath118 is not plagued by the problem of linear growth .",
    "the area under @xmath118 @xmath120 is conjectured by lee , okabe , and landau to be a measure of the error in the dos @xcite .",
    "( the @xmath121 in eq .",
    "( [ eq : ver024:dhk ] ) is to account for the non - uniform energy bin widths . ) during each stage of the simulation , @xmath122 first increases and then saturates to around some mean value .",
    "this means that further sampling will not help to reduce the error in the dos , and therefore the modification factor should be reduced .",
    "note that an increasing @xmath122 does not mean increasing error in the dos , because the actual error has to take into account the smallness of the modification factor ( c.f .",
    "( [ eq : error01 ] ) ) .",
    "the key observation is the saturation of @xmath122 during each stage of the simulation .",
    "@xcite applied @xmath122 to study the dos error of wls in the two - dimension ising model where the exact numerical solution for the dos is available , and found that it is a good measure of the dos convergence .",
    "it has also been applied by sinha and roy to study wls of the @xmath4 model @xcite .",
    "[ fig : dh_compare ] shows an example of the saturation of @xmath122 for the @xmath4 model .",
    "it compares the saturation curves for adawl and wls at the modification factor @xmath123 for @xmath79 .",
    "each curve @xmath124 is obtained by averaging over @xmath96 trajectories .",
    "it can be seen that both wls and adawl curves saturate to some constant value after a certain number of monte carlo steps .",
    "however , the saturation value of adawl is much smaller than wls , implying a smaller error for adawl .    for the simulations in this paper , we ran the simulation at each stage long enough to obtain accurate saturation values of @xmath124 .",
    "although in practice @xmath28 should be decreased as soon as saturation is reached , as our purpose here is to compare the performance of adawl and wls , we ran each stage much longer than is necessary to obtain reliable measurements of @xmath125 .    we now describe how we compare the dos saturation error of adawl and wls . the @xmath96 trajectories are first divided into four equal portions . for each portion , at each stage @xmath29 , we compute @xmath124 curves similar to that of fig .",
    "[ fig : dh_compare ] by averaging @xmath126 over @xmath105 trajectories . using this",
    "averaged curve @xmath124 , we estimate its saturation value by averaging over the time steps in the flat part ( say last 10 percent ) of the curve .",
    "this gives us the saturation value of @xmath124 of that stage for that one portion .",
    "we then average the saturation value over all four portions .",
    "the results are shown in fig .",
    "[ fig : dh ] .",
    "the average saturation value of @xmath127 is plotted against @xmath28 for adawl and wls for various system size .",
    "adawl ( filled symbols ) has significantly smaller saturation values than wls ( empty symbols ) , implying a smaller error in the dos .",
    "the insert is a similar plot comparing the results for wls with different constant step sizes ; a constant step size of 0.05 gives the smallest saturation value for wls .",
    "lastly , we briefly comment on the use of non - uniform energy bin widths .",
    "when using non - uniform bin widths in wang - landau simulations , there is the freedom to choose large energy spacings at certain energies .",
    "however , to compute thermodynamic quantities such as the specific heat capacity accurately , the spacings between energy levels has to be small enough to enable a good representation of the distribution @xmath128 at the temperatures of interests .",
    "hence , it is recommended that one first check by making a rough plot of @xmath128 to ensure that it is represented with a sufficient number of energy levels at the temperatures concerned .",
    "this is especially important for large system size because the appearances of singularities or cusps usually require finer energy spacings to resolve .",
    "of course , the spacings also can not be too small otherwise each bin will not accumulate enough visits by the random walker .    in this paper ,",
    "we have used eq .",
    "( [ eq : bin_width ] ) to set our energy levels .",
    "it might be tempting to choose @xmath85 and @xmath86 to be quite large , thereby greatly reducing the number of energy levels used , especially near @xmath80 .",
    "however , we found that this will lead to an insufficient number of energy levels representing @xmath128 at lower temperatures .",
    "our choice of binning parameters in table [ table : simulation_parameters ] ensures a good representation of @xmath128 .",
    "we have also studied the effects of different bin widths on adawl and wls , and found that there might be rare instances where wls appears to give similar performances as adawl .",
    "but these rare cases are usually due to effects of bin widths .",
    "if one uses coarse bins , wls can reach all bins easily , whereas if a finer set of bin widths near the ground state is used , wls will have difficulty visiting those small bins .",
    "adawl , however , will not show such dependence because its step size is designed to be adaptively adjusted according to the energies . in fig .",
    "[ fig : fvt ] , wls shows signs of smaller first visit time than adawl towards the smaller @xmath1 for @xmath90 .",
    "we have found that using even finer bin widths will increase the first visit time for wls , but not for adawl . however ,",
    "since we have already obtained a more accurate specific heat capacity for adawl at that bin width , we did not pursue to further accentuate the performance between the two methods . as another example , fig .",
    "[ fig : binwidthl16 ] compares the saturated dos error of adawl and wls for the coarse and fine bin widths shown in fig .",
    "[ fig : binwidth ] .",
    "adawl gives the same results for both sets of bin widths , whereas the error for wls increases for the fine bin widths .",
    "to summarize , we proposed an adaptive variant of the wang - landau sampling , which is effective for sampling dos that ranges many orders of magnitude .",
    "the main contributing factors to this increase in efficiency are adaptive step sizes and adaptive modification factors .",
    "adaptive step sizes sample the configuration space well , while adaptive modification factors accumulate the dos effectively and accurately .",
    "we have tested the effectiveness of adawl for system sizes up to @xmath95=32 . for larger sizes",
    ", we may break into several energy regions @xcite , where the method to avoid  boundary effect \" should be taken into account @xcite . in such a case ,",
    "the present adaptive method is still effective for treating dos that has many orders of magnitude . for future work",
    ", adawl should be tested on different continuous systems , especially frustrated ones .    in fig .",
    "[ fig : logg ] , we see that adawl is not yet fully optimized because the acceptance rate in the middle energy range has not been adjusted to 0.5 due to the saturation of @xmath129 to the maximum value of 1 . at larger lattice sizes , where the energy range is larger",
    ", one might consider going beyond single site updates ( e.g. global moves ) to enable even larger step sizes to be used .",
    "this might make the sampling of adawl even more efficient .",
    "recently , there have been many works on improving wls both for discrete @xcite and continuous @xcite systems . to obtain better convergence ,",
    "the @xmath130 algorithm @xcite was proposed . moreover , _ tomographic _",
    "entropic sampling scheme @xcite was proposed as an algorithm to calculate dos .",
    "the convergence of wls was discussed with paying attention to the difference of density of states by komura and okabe @xcite",
    ". it will be interesting to combine the present work with the recent progress .",
    "finally , we make a note that our idea of using an adaptive modification factor could potentially be used for simulating discrete systems as well as continuous systems",
    ". this will also be part of our future work .",
    "this work was supported ( in part ) by the biomedical research council of a*star ( agency for science , technology and research ) , singapore .",
    "our adawl algorithm is as follows .    1 .",
    "initialize the bin sizes @xmath131 according to eq .",
    "( [ eq : bin_width ] ) . initialize the system configuration @xmath14 , the dos @xmath132 , the histogram @xmath133 , modification factor @xmath134 , and step sizes @xmath43=constant . [",
    "it : init ] 2 .   sample a new configuration @xmath13 from @xmath135 and accept the move as given by eq .",
    "( [ eq : db ] ) . [",
    "it : accept ] 3 .",
    "update the dos and histogram according to eq .",
    "( [ eq : update ] ) . update the acceptance and rejection counts @xmath48 and @xmath49 . [",
    "it : update ] 4 .",
    "repeat steps [ it : accept ] and [ it : update ] for some predefined number of monte carlo steps and update the step size according to eq .",
    "( [ eq : arm ] ) . set @xmath136 . [",
    "it : arm ] 5 .",
    "reduce @xmath28 ( e.g. , @xmath137 , after the dos error saturates ) and set @xmath138 ; else , repeat steps [ it : accept ] to [ it : arm ] .",
    "[ it : flat ] 6 .",
    "repeat steps [ it : accept ] to [ it : flat ] until the modification factor @xmath28 is smaller than some tolerance threshold .",
    "the contents of this appendix was first given in lee et .",
    "al . @xcite .",
    "the reader is referred there for a more complete presentation . here ,",
    "for completeness , we outline the main idea presented there , and also update the analysis to take into account the use of non - uniform energy bin widths .",
    "the dos @xmath139 accumulated after the @xmath140th stage can be written as @xmath141 where @xmath117 is the accumulated histogram and @xmath28 is the modification factor for the @xmath29th stage of simulation .",
    "( [ eq : logg_n ] ) holds for both wls and adawl .",
    "calculation of thermodynamics quantities are not affected if we subtract a constant from @xmath117 , hence we subtract the minimum of @xmath117 , @xmath142 and define a new but equally valid density of states , @xmath143 to introduce our histogram measure , we observe that it is reasonable to estimate the error between the computed density of states @xmath144 and the true one @xmath145 as @xmath146 = \\sum_{e } \\sum_{k = n+1}^{\\infty } w(e ) \\tilde{h}_k(e ) \\ln(f_k ) \\label{eq : error01}\\ ] ] an intuitive view of eq .",
    "( [ eq : error01 ] ) is that if an infinite number of stages were performed ( i.e. @xmath147 ) , then the exact dos will be obtained .",
    "this statement was made formal by the conjecture of lee , okabe and landau @xcite .",
    "if just @xmath140 stages were done instead , the error of @xmath144 will be the sum of all the rest of the stages that were not carried out explicitly .",
    "we denote the fluctuation of @xmath118 as @xmath148 note that the summation over @xmath24 in eq .",
    "( [ eq : error02 ] ) includes the binwidth @xmath121 .",
    "this is a slight modification from the original formulation . swapping the order of summation , the rhs of eq .",
    "( [ eq : error01 ] ) becomes @xmath149 hence , the error depends only on @xmath122 and the sequence of modification factors @xmath28 .",
    "if @xmath28 are predetermined , then @xmath122 becomes the only determining factor of the error .",
    "hence , when we see that it saturates ( for a certain @xmath29 ) , it is an indication that enough statistics has been accumulated for this @xmath28 value and simulation for the next value @xmath150 should begin . finally , it is important to note that smaller @xmath122 values indicates that the accumulated histogram is flatter .",
    "swetnam and m.p .",
    "allen , j. comput . chem . * 32 * , 816 ( 2010 ) ; d.t .",
    "seaton , t. wst , and d.p .",
    "landau , phys .",
    "e * 81 * , 011802 ( 2010 ) ; s. .",
    "jnsson , s. mohanty , and a. irbck , j. chem . phys . * 135 * , 125102 ( 2011 ) .",
    "we choose eq .",
    "( [ eq : q ] ) for the trial move transition probability because its cumulative and inverse cumulative distributions can easily be derived analytically , facilitating the numerical calculation of the random variable @xmath17 .",
    ".summary of parameters used in adawl , wls , and metropolis simulations .",
    "@xmath97 : constant step size used for wls ( @xmath35 in eq .",
    "( [ eq : q ] ) ) .",
    "@xmath94 : smallest ( i.e. final ) modification factor used in simulation .",
    "@xmath157 : no .",
    "of single site updates per spin used for @xmath94 ( the final stage ) .",
    "@xmath158 : no .",
    "of single site updates per spin used for metropolis simulation .",
    "parameter values for eq .",
    "( [ eq : arm ] ) : @xmath159 , @xmath160 , and @xmath161 @xcite . [ cols=\"^,^,^,^,^,^,^,^,^,^,^\",options=\"header \" , ]        & + @xmath107 & @xmath162 & @xmath163 & @xmath162 adawl & @xmath162 wls + 0.1 & 0.5112 & 8 & 0.3 & 5 + 0.2 & 0.5266 & 8 & 0.3 & 4 + 0.3 & 0.5446 & 6 & -1 & 0.2 + 0.4 & 0.5664 & 5 & 0.8 & 5 + 0.5 & 0.5948 & 7 & 0.03 & -5 + 0.75 & 0.7358 & 7 & -1 & -0.7 + 1.0 & 1.2200 & 20 & 0.05 & 3 + 1.075 & 1.4467 & 20 & 2 & -8 + 1.1 & 1.4796 & 30 & 1 & -6 + 1.13 & 1.4690 & 10 & 3 & -11 + 1.75 & 0.4483 & 4 & 0.5 & -8 +     & + @xmath107 & @xmath162 & @xmath163 & @xmath162 adawl & @xmath162 wls + 0.1 & 0.5132 & 9 & 10 & -20 + 0.2 & 0.5283 & 6 & 10 & -30 + 0.3 & 0.5459 & 5 & -4 & -100 + 0.4 & 0.5683 & 7 & 5 & 10 + 0.5 & 0.5966 & 7 & -8 & 20 + 0.8 & 0.7966 & 5 & -10 & 20 + 1.0 & 1.336 & 30 & -2 & 20 + 1.025 & 1.448 & 30 & -7 & -10 + 1.05 & 1.519 & 30 & -8 & -90 + 1.075 & 1.521 & 20 & -1 & -200 + 1.1 & 1.465 & 30 & 4 & -100 + 1.15 & 1.314 & 10 & 6 & -70 + 1.2 & 1.182 & 20 & 3 & 30 + 1.8 & 0.4174 & 2 & 2 & -30 +       model ( @xmath95=8 ) obtained using adawl .",
    "step sizes are adjusted to keep an optimum acceptance ratio of @xmath104 . between energies",
    "@xmath167 to @xmath168 , step sizes saturate to a maximum value of @xmath166 .",
    "some representative error bars are shown for the acceptance rate .",
    ", width=453 ]     model for @xmath90 .",
    "the widths are larger near @xmath80 and smaller near @xmath169 .",
    "the lower graph ( fine bins ) is the binning scheme given in table [ table : simulation_parameters ] and used throughout this paper ( for @xmath90 ) .",
    "the upper graph ( coarse bins ) is discussed in the text . ]     for adawl and wls ( constant step size 0.05 ) .",
    "errorbar when not shown is smaller than the size of the symbol .",
    "insert : first visit times of wls for different step sizes .",
    "the most efficient step size for wls is 0.05 , with the smallest first visit time .",
    "symbols for insert are as follows . for @xmath95=4 :",
    "@xmath170 for step size=0.01 , @xmath171 for 0.05 , @xmath172 for 0.1 , and @xmath173 for 0.5 . for @xmath95=8",
    ": @xmath174 for step size=0.01 , @xmath175 for 0.05 , @xmath176 for 0.1 , and @xmath177 for 0.5 .",
    ", width=453 ]     versus @xmath28 for adawl and wls ( constant step size=0.05 ) .",
    "insert : for wls with different step sizes .",
    "symbols have the same meaning as fig .",
    "[ fig : fvt ] .",
    "the most efficient step size for wls is 0.05 , which has the lowest saturation values .",
    ", width=453 ]"
  ],
  "abstract_text": [
    "<S> the density of states of continuous models is known to span many orders of magnitudes at different energies due to the small volume of phase space near the ground state . </S>",
    "<S> consequently , the traditional wang - landau sampling which uses the same trial move for all energies faces difficulties sampling the low entropic states . </S>",
    "<S> we developed an adaptive variant of the wang - landau algorithm that very effectively samples the density of states of continuous models across the entire energy range . by extending the acceptance ratio method of bouzida , kumar , and </S>",
    "<S> swendsen such that the step size of the trial move and acceptance rate are adapted in an energy - dependent fashion , the random walker efficiently adapts its sampling according to the local phase space structure . </S>",
    "<S> the wang - landau modification factor is also made energy - dependent in accordance with the step size , enhancing the accumulation of the density of states . </S>",
    "<S> numerical simulations show that our proposed method performs much better than the traditional wang - landau sampling . </S>"
  ]
}