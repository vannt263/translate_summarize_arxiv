{
  "article_text": [
    "the concept of frchet means of random variables on a metric space is a generalisation of the least mean - square characterisation of euclidean means : a point is a frchet mean of a probability measure @xmath3 on a metric space @xmath4 if it minimises the frchet function for @xmath3 defined by @xmath5 provided the integral on the right side is finite for at least one point @xmath6 .",
    "note that the factor @xmath7 will simplify some later computations .",
    "the concept of frchet means has recently been used in the statistical analysis of data of a non - euclidean nature .",
    "we refer readers to @xcite , @xcite , @xcite , @xcite and @xcite , as well as the references therein , for the relevance of , and recent developments in , the study of various aspects of frchet means in riemannian manifolds .",
    "the frchet mean has also been studied in the space of phylogenetic trees , as motivated by @xcite and @xcite .",
    "it was first introduced to this space independently by @xcite and @xcite , which both gave methods for computing it . limiting distributions of sample frchet",
    "means in the space of phylogenetic trees with four leaves were studied in @xcite , and it was used to analyse tree - shaped medical imaging data in @xcite , while principal geodesic analysis on the space of phylogenetic trees , a related statistical issue , was studied in @xcite , @xcite , and @xcite .",
    "a phylogenetic tree represents the evolutionary history of a set of organisms and is an important concept in evolutionary biology .",
    "such a tree is a contractible graph , that is , a connected graph with no circuits , where one of its vertices of degree 1 is distinguished as the root of the tree and the other such vertices are ( labelled ) leaves . the space @xmath1 of phylogenetic trees with @xmath8 leaves was first introduced in @xcite",
    ". the important feature of the space is that each point represents a tree with a particular structure and specified lengths of its edges in such a way that both the structure and the edge lengths vary continuously in a natural way throughout the space .",
    "the space is constructed by identifying faces of a disjoint union of euclidean orthants , each corresponding to a different tree structure . in particular , it is a topologically stratified space and also a @xmath9 , or globally non - positively curved , space ( cf .",
    "@xcite ) . a detailed account of the underlying geometry of tree spaces can be found in @xcite and a brief summary can be found in the appendix to @xcite .    as demonstrated in @xcite and @xcite for @xmath10 and in @xcite for @xmath0 ,",
    "the global , as well as the local , topological structure of the space of phylogenetic trees plays an important role in the limiting behaviour of sample frchet means .",
    "these results imply that the known results ( cf .",
    "@xcite ) on the limiting behaviour of sample frchet means in riemannian manifolds can not be applied directly .",
    "moreover , due to the increasing complexity of the structure of @xmath1 as @xmath8 increases , the techniques used in @xcite for @xmath0 could not be adapted to derive the limiting behaviour of sample frchet means in @xmath1 for general @xmath8 .",
    "for example , although the natural isometric embedding of @xmath0 is in 10-dimensional euclidean space @xmath11 , it is intrinsically 2-dimensional , being constructed from 15 quadrants identified three at a time along their common axes .",
    "this made it possible in @xcite , following @xcite , to represent @xmath0 as a union of certain quadrants embedded in @xmath12 in such a way that it was possible to visualise the geodesics explicitly .",
    "that is , naturally , not possible for @xmath13 .",
    "the need to describe geodesics explicitly arises as follows . in a complete manifold of non - positive curvature , the global minimum of a frchet function",
    "would be characterised by the vanishing of its derivative . in tree space , as in general stratified spaces , such derivatives do not exist at non - manifold points .",
    "however directional derivatives for a frchet function , which serve our purpose , do exist at all points and for all tangential directions .",
    "they are defined via the log map , which is a generalisation of the inverse of the exponential map of riemannian manifolds , and is expressed in terms of the lengths and initial tangent vectors of unit speed geodesics . in this paper , we derive these data using the geometric structure of geodesics in @xmath1 obtained in @xcite and @xcite . as a result , we are able to establish a central limit theorem for _ iid _ random variables having probability measure @xmath3 that has its frchet mean lying in a top - dimensional stratum .",
    "we are also able to take advantage of the special structure of tree space in the neighbourhood of a stratum of co - dimension one to obtain the analogous results when the frchet mean of @xmath3 lies in such a stratum . for the latter case ,",
    "we show that the limiting distribution can take one of three possible forms , distinguished by the nature of its support .",
    "unlike the euclidean case , the limiting distributions in both cases here are expressed in terms of the log map at the frchet mean of @xmath3 .",
    "this is similar to the central limit theorem for sample frchet means on riemannian manifolds ( cf .",
    "although it may appear non - intuitive , it allows us to use the standard results on euclidean space .",
    "for example , in the top - dimensional case , the limiting distribution is a gaussian distribution and so some classical hypothesis tests can be carried out in a similar fashion to hypothesis tests for data lying in a riemannian manifold as demonstrated in @xcite for the statistical analysis of shape . however , in the case of co - dimension one , the limiting distribution is non - standard and so the classical hypothesis tests can not easily be modified to apply .",
    "further investigation is required and we aim to pursue this , as well as the applications of the results to phylogenetic trees , in future papers .",
    "the remainder of the paper is organised as follows .",
    "in order to obtain the directional derivatives of a frchet function , we need an explicit expression for the log map that is amenable to calculation . this in turn requires a detailed analysis of the geodesics which we carry out in the next section using results from @xcite and @xcite .",
    "the resulting expression for the log map in theorem [ thm1 ] and its modification are then used in the following two sections which study the limiting distributions for sample frchet means in @xmath1 ; section 3 concentrates on the case when the frchet means lie in the top - dimensional strata , while section 4 deals with the case when they lie in the strata of co - dimension one . in the final section ,",
    "we discuss some of the problems involved in generalising our results to the case that the frchet means lie in strata of arbitrary co - dimension .",
    "the log map is the generalisation of @xmath14 , the inverse of the exponential map on a riemannian manifold . for a tree @xmath15 in @xmath1 the log map ,",
    "@xmath16 , at @xmath15 takes the form @xmath17 as @xmath18 varies , where @xmath19 is a unit vector at @xmath15 along the geodesic from @xmath15 to @xmath18 and @xmath20 is the distance between @xmath15 and @xmath18 along that geodesic .",
    "this is well - defined since @xmath1 is a globally non - positively curved space , or @xmath9-space ( cf .",
    "@xcite ) , and so this geodesic is unique .    in order to analyse this log map further , we first recall some relevant aspects of the structure of trees and tree spaces . apart from the roots and leaves of a tree , which are the vertices of degree 1 mentioned above , there are no vertices of degree two and the remaining vertices , of degree at least 3 , are called internal .",
    "an edge is called internal if both its vertices are .",
    "a tree with @xmath8 labelled leaves and unspecified internal edge lengths determines a combinatorial type .",
    "then @xmath1 is a stratified space with a stratum for each such type : a given type with @xmath21 internal edges determines a stratum with @xmath22 positive parameters ranging over the points of an open @xmath22-dimensional euclidean orthant , each point representing the tree with those specific parameters as the lengths of its internal edges .",
    "note that , for this paper , we shall only consider the internal edges of a tree .",
    "so by ` edge ' we always mean ` internal edge ' and , to simplify the notation , we consider @xmath23 , rather than @xmath1 .",
    "the metric on @xmath23 is induced by regarding the identification of a stratum @xmath24 with a euclidean orthant @xmath25 as an isometry .",
    "then each face , or boundary orthant of co - dimension one , of @xmath25 is identified with a boundary stratum @xmath26 of @xmath24 .",
    "a tree of type @xmath26 is obtained from a tree of type @xmath24 by coalescing the vertices @xmath27 and @xmath28 of degree @xmath29 and @xmath30 of the edge whose parameter has become zero , to form a new vertex @xmath31 of degree @xmath32 .",
    "see figure [ fig1 ] .",
    "( -5,0.5 )  ( -5,-0.5 ) ; ( -5,0.5 ) circle ( 1.5pt ) ; at ( -5,0.5 ) [ left ] @xmath27 ; ( -5,-0.5 ) circle ( 1.5pt ) ; at ( -5,-0.5 ) [ left ] @xmath28 ; ( -6,1.5 )  ( -5,0.5 ) ; ( -5.3,1.5 )  ( -5,0.5 ) ; ( -4.7,1.5 )  ( -5,0.5 ) ; ( -4,1.5 )  ( -5,0.5 ) ; at ( -5,2 ) @xmath33 edges ; ( -5.7,-1.5 )  ( -5,-0.5 ) ; ( -5,-1.5 )  ( -5,-0.5 ) ; ( -4.3,-1.5 )  ( -5,-0.5 ) ; at ( -5,-2 ) @xmath34 edges ; ( 0,0 ) circle ( 1.5pt ) ; at ( 0,0 ) [ left ] @xmath31 ; ( -1,1 )  ( 0,0 ) ; ( -0.3,1 )  ( 0,0 ) ; ( 0.3,1 )  ( 0,0 ) ; ( 1,1 )  ( 0,0 ) ; ( -0.7,-1 )  ( 0,0 ) ; ( -0,-1 )  ( 0,0 ) ; ( 0.7,-1 )  ( 0,0 ) ; at ( 2.5,0 ) @xmath35 edges ;    we are particularly interested in the top - dimensional strata .",
    "these are formed by binary trees , in which all internal vertices have degree 3 .",
    "a binary tree with @xmath36 leaves has @xmath37 internal vertices and @xmath8 internal edges so that the corresponding stratum has dimension @xmath8 .",
    "there are @xmath38 such strata in @xmath23 ( cf .",
    "@xcite ) . for these strata",
    "the boundary relation results in two adjacent vertices of degree 3 coalescing to form a vertex of degree 4 .",
    "since each vertex of degree 4 can be formed 3 different ways , each stratum of co - dimension one is a component of the boundary of three different top - dimensional strata .",
    "figure  [ fig:3_quadrants ] shows an example of these strata in @xmath39 .     and their shared co - dimension one stratum .",
    "a sample tree is shown for each stratum , and the axes are labelled by the corresponding edge - type.,width=288 ]    if a tree @xmath15 lies in a top - dimensional stratum of @xmath23 , since such a stratum can be identified with an orthant @xmath25 in @xmath40 , we may identify the tangent space to @xmath23 at @xmath15 with @xmath40 . then , for each point @xmath41 , the geodesic from @xmath15 to @xmath18 in @xmath23 will start with a linear segment in @xmath25 , which determines an initial _ unit _ tangent vector @xmath42 at @xmath15 .",
    "thus , we may identify the image of the log map defined in as the vector @xmath43 in @xmath40 .",
    "for example , the space @xmath44 of trees with three leaves is the ` spider ' : three half euclidean lines joined at their origins . denoting the length of the edge @xmath45 of @xmath18 by @xmath46 , then @xmath47 , if @xmath15 and @xmath18 lie in the same orthant of @xmath44 , and @xmath48 , otherwise .",
    "thus , the log map for @xmath44 can be expressed explicitly as @xmath49 where @xmath50 is the canonical unit vector determining the orthant in which @xmath15 lies .",
    "note that we abuse notation by calling the ( single ) internal edge @xmath45 in all 3 trees , despite these edges dividing the leaves in different ways .",
    "the explicit expression for the log map for the space @xmath0 of trees with four leaves is already much more complicated than this and was derived in @xcite .    to obtain the expression for the log map at @xmath15 for the space @xmath23 of trees with @xmath36 ( @xmath51 ) leaves ,",
    "we first summarise without proofs the description , given in @xcite , @xcite , @xcite and @xcite , of the geodesic between two given trees in @xmath23 .",
    "when an ( internal ) edge is removed from a tree it splits the set of the leaves plus the root into two disjoint subsets , each having at least two members , and we identify the edges from different trees that induce the same split .",
    "each edge has a ` type ' that is specified by the subset of the corresponding split that does not contain the root .",
    "for example , in the tree in figure [ fig : logmap_tstar ] , the edge labelled @xmath52 has the edge - type @xmath53 , while the edge labelled @xmath54 has the edge - type @xmath55 .",
    "there are @xmath56 possible edge - types .",
    "two edge - types are called _ compatible _ if they can occur in the same tree , and @xmath23 may be identified with a certain subset of @xmath57 , each possible edge - type being identified with a positive semi - axis in @xmath57 . to make this identification explicit , we choose a canonical order of the edges by first ordering the leaves and then taking the induced lexicographic ordering of the sets of ( ordered ) leaves that determine the edges . then , if @xmath58 is a set of mutually compatible edge - types and @xmath59 is the orthant spanned by the corresponding semi - axes in @xmath57 , each point of @xmath59 represents a tree with the combinatorial type determined by @xmath58 and @xmath23 is the union of all such orthants .    for a set of edges @xmath60 in a tree @xmath18 ,",
    "define @xmath61 and write @xmath62 for the number of edges in @xmath60 . for two given trees @xmath15 and @xmath18 , let @xmath63 and @xmath64 be their respective edge sets , or sets of non - trivial splits",
    ". assume first that @xmath15 and @xmath18 have no common edge , i.e. @xmath65 .",
    "then , the geodesic from @xmath15 to @xmath18 can be determined as follows .",
    "let @xmath15 and @xmath18 be two trees with no common edges , lying in top - dimensional strata of @xmath23 .",
    "then there is an integer @xmath22 , @xmath66 , and a pair @xmath67 of partitions @xmath68 of @xmath63 and @xmath69 of @xmath64 , all subsets @xmath70 and @xmath71 being non - empty , such that    1 .   for each @xmath72 ,",
    "the union @xmath73 is a set of mutually compatible edges ; 2 .",
    "@xmath74 ; 3 .   for all @xmath75 , there are no non - trivial partitions @xmath76 of @xmath70 and @xmath77 of @xmath78 such that @xmath79 is a set of mutually compatible edges and @xmath80 .",
    "the geodesic is the shortest path through the sequence of orthants @xmath81 where @xmath82 and has length @xmath83 .",
    "[ lem0 ]    note that implies that @xmath84 is the orthant in which @xmath15 lies and that @xmath18 is in @xmath85 .",
    "these results , developed from @xcite , are given in this form , though not in a single lemma , in @xcite section 2.3 , where the properties ( p1 ) , ( p2 ) and ( p3 ) are stated in identical terms .",
    "the edge set for @xmath86 is denoted by @xmath87 in the statement of theorem 2.4 there and the formula for the length of the geodesic is equation ( 1 ) in that statement .",
    "following @xcite and @xcite respectively , we call the orthant sequence @xmath88 the _ carrier _ of the geodesic , and the pair of partitions @xmath67 the _ support _ of the geodesic . in general , the integer @xmath22 and the support @xmath67 need not be unique .",
    "however , they are unique if all the inequalities in ( p2 ) are strict ( * ? ? ?",
    "* remark , p.7 ) and , in this case , we shall refer to the carrier and support as the _ minimal _ ones .    under the above assumption ,",
    "the integer @xmath22 appearing in lemma [ lem0 ] is the number of times that the geodesic includes a segment in the interior of one orthant followed by a segment in the interior of a neighbouring orthant .",
    "hence , the constraints @xmath89 : @xmath90 implies that the geodesic goes through the cone point and @xmath91 that it passes through a sequence of top - dimensional orthants .",
    "we can now give an isometric embedding @xmath92 in @xmath40 of @xmath93 with @xmath15 mapped to @xmath94 in the positive orthant , where the @xmath95 represent the lengths of the edges of @xmath15 , and with @xmath18 mapped to @xmath96 in the negative orthant , where the @xmath97 are the lengths of the edges of @xmath18 .",
    "let @xmath98 be the coordinates of @xmath15 ordered by the canonical ordering given just before lemma  [ lem0 ] that embeds @xmath23 in @xmath57 .",
    "then we can reorder the coordinates @xmath99 such that the edges in @xmath100 correspond to the first @xmath101 positive semi - axes in @xmath40 , the edges in @xmath102 correspond to the next @xmath103 positive semi - axes in @xmath40 , etc , while the edges in @xmath104 correspond to the first @xmath105 negative semi - axes in @xmath40 , the edges in @xmath106 correspond to the next @xmath107 negative semi - axes in @xmath40 , etc . by ( p1 ) , the edge sets @xmath108 are mutually compatible for all @xmath109 , implying that the images of these edges in @xmath40 are mutually orthogonal , and so they determine an isometric embedding of @xmath110 , defined by , and hence the required isometric embedding @xmath111 of @xmath88 .",
    "let @xmath112 be the inverse of the permutation of the coordinates described above , so that @xmath113    [ ex : logmap ] figure  [ fig : logmap_1 ] shows the embedded geodesic and minimal carrier between the trees @xmath15 and @xmath18 ( see figures  [ fig : logmap_tstar ] and  [ fig : logmap_t ] ) , which correspond to the points @xmath114 and @xmath115 , respectively .",
    "the minimal support consists of @xmath116 , @xmath117 , @xmath118 , and @xmath119 . for convenience , @xmath112 is the identity permutation in this case .",
    "the minimal carrier consists of the all positive octant determined by @xmath120 , @xmath121 and @xmath122 ; the 2-dimensional quadrant formed by the positive @xmath52 and negative @xmath123 axes ; and the all negative octant .",
    ".5     .5     1     1     for any @xmath124 , let @xmath125 be the subspace of @xmath126 that is the union of the ( closed ) orthants @xmath127 , @xmath128 , where @xmath129 for the given @xmath15 , @xmath18 , and corresponding @xmath22 from lemma [ lem0 ] , there are @xmath130 orthants in the carrier of the geodesic between @xmath15 and @xmath18 .",
    "if @xmath131 ( the intrinsic dimension of @xmath23 ) , then the carrier @xmath88 is isometric to @xmath132 , with @xmath110 coinciding with @xmath127 and with the geodesic from @xmath114 to @xmath115 being a straight line contained in @xmath92 . otherwise if @xmath133 , the space @xmath92 is strictly contained in @xmath134 , and some of the top - dimensional orthants of @xmath134 may not correspond to orthants in tree space",
    "additionally , the geodesic between @xmath114 and @xmath115 in @xmath92 will bend at certain orthant boundaries within the ambient space @xmath134 .",
    "we now give an isometric embedding onto @xmath135 of a subspace of @xmath136 containing the geodesic in @xmath134 such that the image geodesic is a straight line .",
    "the geodesic between @xmath114 and @xmath115 passes through @xmath22 orthant boundaries . at the @xmath137-th orthant boundary ,",
    "the edges in @xmath70 , which have been shrinking in length since the geodesic started at @xmath114 , simultaneously reach length 0 , and the edges in @xmath78 simultaneously appear in the tree with length 0 and start to grow in length .",
    "the length of each edge in @xmath70 changes linearly as we move along the geodesic , and thus since these lengths all reach 0 at the same point , the ratios of these lengths to each other remain the same along the geodesic .",
    "an analogous statement can be made for the lengths of the edges in @xmath78 ( cf .",
    "@xcite corollary 4.3 ) .",
    "the basic idea behind the embedding into @xmath135 is that because the lengths of the edges in @xmath70 , for any @xmath137 , are all linearly dependent on each other , we can represent those edges in @xmath135 using only one dimension , and analogously for the edges in @xmath78 .",
    "more specifically , for @xmath138 , let @xmath139 be the projection of @xmath114 on the orthant @xmath140 .",
    "that is , the coordinates of @xmath141 are the lengths of the edges in @xmath70 , ordered as chosen above .",
    "similarly , let @xmath142 so that the coordinates of @xmath143 are the lengths of the edges in @xmath78 , in that order .",
    "then , the geodesic between @xmath15 and @xmath18 in @xmath88 is piece - wise linearly isometric with the euclidean geodesic between the vectors @xmath144 and @xmath145 in @xmath135 , and hence in @xmath146 . in particular ,",
    "the euclidean distance between these two euclidean points is the same as the distance between @xmath15 and @xmath18 in @xmath88 .",
    "thus we have the following result , the essence of which appears in @xcite , theorem 4.10 , to which we refer readers for more detailed proof .    for any given @xmath15 and @xmath18 in @xmath23 with no common edge and with @xmath15 lying in a top - dimensional stratum , there is an integer @xmath22 , @xmath89 , for which there are two vectors @xmath147 , depending on both @xmath15 and @xmath18 , such that the geodesic between @xmath15 and @xmath18 is homeomorphic and piece - wise linearly isometric , with the @xmath148straight@xmath149 euclidean geodesic between @xmath150 and @xmath151 , where @xmath150 lies in the positive orthant of @xmath146 and @xmath151 in the closure of the negative orthant .",
    "[ lem1 ]    for example  [ ex : logmap ] , @xmath152 , and thus the grey area shown in figure  [ fig : logmap_1 ] is isometrically mapped to @xmath153 , as shown in figure  [ fig : logmap_2 ] .    in the general case where @xmath15 and @xmath18 have a common edge , say @xmath45 , this common edge determines , for each of the two trees , two quotient trees @xmath154 and @xmath155 , @xmath156 , described as follows ( cf .",
    "@xcite & @xcite ) .",
    "the trees @xmath157 and @xmath158 are obtained by replacing the subtree ` below ' @xmath45 with a single new leaf , so that @xmath45 becomes an external edge .",
    "these two replaced subtrees form the trees @xmath159 and @xmath160 , with the ` upper ' vertex of the edge @xmath45 becoming the new root . then , the geodesic @xmath161 between @xmath15 and @xmath18 is isometric with @xmath162 , where @xmath163 is the linear path from @xmath164 to @xmath46 and @xmath165 is the geodesic from @xmath154 to @xmath155 in the corresponding tree space .",
    "for this , we treat @xmath166 and @xmath167 , the spaces of trees with no internal edges , as single points , so that any geodesic in them is a constant path . assuming that @xmath154 and @xmath155 have no common edge for @xmath168 or 2 , we may obtain , as above , a straightened image of each geodesic @xmath165 in @xmath169 with @xmath154 represented in the positive orthant and @xmath155 in the negative one . combining these with the geodesic @xmath163 , which is already a straight linear segment",
    ", we have an isometric representation of @xmath170 as a straight linear segment in @xmath171 . in this case , the sequence of strata containing the tree space geodesic between @xmath15 and @xmath18 is contained in the product of the carriers for the relevant quotient trees , together with an additional factor for the common edge .",
    "for example , if @xmath172 and the geodesic @xmath173 spends @xmath174 $ ] in orthant @xmath175 , @xmath176 $ ] in orthant @xmath177 , @xmath178 $ ] in orthant @xmath179 , while the geodesic @xmath180 spends @xmath181 $ ] in orthant @xmath182 , @xmath183 $ ] in orthant @xmath184 , @xmath185 $ ] in orthant @xmath186 , then the carrier for the product geodesic would be the sub - sequence @xmath187 of the full lexicographically ordered sequence of nine products .",
    "if @xmath15 and @xmath18 have more than one common edge , then either @xmath188 and @xmath158 , or @xmath189 and @xmath160 , will have a common edge and we may repeat the process .",
    "having done so as often as necessary , we arrive at a sequence of orthants determined by the non - common edges of @xmath15 and @xmath18 .",
    "these we relabel @xmath190 to @xmath85 as in lemma [ lem0 ] .",
    "if @xmath191 is the orthant determined by the axes corresponding to the common edges of @xmath15 and @xmath18 , then the sequence @xmath192 is the carrier of the geodesic from @xmath15 to @xmath18 .",
    "similarly , the support for the tree space geodesic between @xmath15 and @xmath18 is found by interleaving the partitions in the supports of the relevant quotient trees so that property ( p2 ) is satisfied in the combined support .",
    "the resulting partitions @xmath193 and @xmath194 are then preceded by the set @xmath195 of axes corresponding to the common edges so that @xmath196 , with the convention that the corresponding ratio is @xmath197 , and is modified to @xmath198 in this generalised context , the value @xmath199 is now possible , implying that all edges are common to @xmath15 and @xmath18 . in other words",
    ", they lie in the same orthant .",
    "note that this presentation differs slightly from that in section 1.2 of @xcite in that , by collecting all the common edges in a single member @xmath195 of the support , we are implicitly suppressing the axiom ( p3 ) for that set .",
    "note that the maximum value of the number @xmath22 , which is determined by the non - common edges of @xmath15 and @xmath18 , is @xmath200 in the general case .",
    "we call @xmath22 , the number of changes of orthant in the unique minimal carrier of the geodesic from @xmath15 to @xmath18 , the carrier number @xmath201 of @xmath15 and @xmath18 .",
    "[ def0 ]    clearly , @xmath202 .",
    "the minimal carrier and support determine the corresponding @xmath114 , @xmath203 , @xmath150 and @xmath151 in a similar manner to the special case where there is no common edge between @xmath15 and @xmath18 given in lemma [ lem1 ] , modified to account for the common edges .",
    "for this , the first @xmath204 coordinates of @xmath114 will be the @xmath205 and those of @xmath115 will be @xmath206 ; for @xmath207 and @xmath208 , @xmath209 and @xmath143 is modified similarly ; and @xmath150 and @xmath151 have additional first coordinates @xmath210 and @xmath211 respectively .",
    "then , with this modification , the geodesic between @xmath15 and @xmath18 is homeomorphic and piece - wise linearly isometric , with the ( straight ) euclidean geodesic between @xmath150 and @xmath151 , where @xmath150 lies in the positive orthant of @xmath212 .",
    "this generalisation of lemma [ lem1 ] to the general case was obtained , with different notation , in @xcite , @xcite and @xcite .",
    "then , the log map as defined by can be expressed using these vectors as follows .",
    "fix @xmath15 in a top - dimensional stratum of @xmath23 with coordinates @xmath213 , where the ordering of the coordinates is that induced by the canonical ordering for @xmath57 . for @xmath41 , there are vectors @xmath150 and @xmath151 in @xmath212 , where @xmath204 is the number of common edges of @xmath15 and @xmath18 , @xmath22 is the carrier number @xmath201 and @xmath150 lies in the positive orthant of the corresponding space , and a linear map @xmath214 such that @xmath215 [ thm1 ]    let @xmath150 have @xmath216th coordinate @xmath217 , @xmath218 , with the additional initial coordinates @xmath219 when @xmath15 and @xmath18 have common edges , where @xmath141 are as defined by , and @xmath151 be determined similarly .",
    "the piece - wise linear isometry that straightens the geodesic from @xmath15 to @xmath18 , given in lemma [ lem1 ] for the special case as well as the above for the general case , has an inverse on the positive orthant in @xmath212 .",
    "this inverse is given by @xmath220 and the identity on the @xmath204 initial coordinates , where @xmath221 is the @xmath216th standard basis vector in @xmath212 .",
    "note that , being a linear map , when @xmath222 , @xmath223 , where @xmath224 .",
    "although it is not expressed precisely as it is here , the idea for a more detailed derivation of this in this case is captured in theorem  4.4 in @xcite , where @xmath225 is denoted by @xmath226 .    since @xmath227",
    ", we have that @xmath228 and that @xmath225 maps the initial segment of the straight geodesic in @xmath212 , together with its initial tangent vector @xmath229 , onto those of the geodesic in @xmath134 .",
    "the permutation @xmath112 , which maps the positive orthant in @xmath134 into @xmath230 where @xmath231 is defined by , is also an isometry preserving the initial segments of the geodesics .",
    "it follows that @xmath232 noting that the maps @xmath112 and @xmath225 are linear and @xmath233 , the required result follows by taking @xmath234 .",
    "figure  [ fig : logmap_3 ] shows the log map for the tree @xmath15 for example  [ ex : logmap ] .",
    "in example  [ ex : logmap ] .",
    "the vector between @xmath114 and @xmath235 is shown as a dashed line .",
    "it coincides with the geodesic between @xmath15 and @xmath18 in the starting orthant , but then continues into the ambient space , while the geodesic must bend to remain in the tree space.,width=288 ]    although @xmath23 is @xmath9 , @xmath16 is not a one - to - one map . in particular ,",
    "if @xmath158 and @xmath160 are two different trees such that @xmath236 is not maximal , then it is possible that @xmath237 , as observed in the case of @xmath0 in @xcite . as another example , consider two trees @xmath238 with no common edges such that the geodesic between them passes through the cone point with a given length @xmath239 .",
    "then for any other tree @xmath240 with a geodesic to @xmath15 of length @xmath239 , passing through the cone point , we also have that @xmath241 .    recalling that each component of @xmath203 and @xmath143 is respectively",
    "the length of an edge in @xmath70 and @xmath78 then , with some ambiguity in the ordering of the edges of @xmath15 , another equivalent way to express @xmath16 is @xmath242 where @xmath243 . to derive the limiting distribution of sample frchet means",
    ", the ordering must be kept explicit and independent of @xmath18 . hence",
    ", we have to use the expression for the log map given by , even though it is not as transparent as this one .",
    "note also that , although the definitions for both @xmath112 and @xmath225 implicitly depend on the ordering we chose for the coordinates of @xmath114 , the composition @xmath244 is independent of that choice , and so the log map is well - defined , as long as we chose the same ordering for @xmath114 for both @xmath112 and @xmath225 .",
    "the minimal carrier that determines the maps @xmath112 and @xmath225 as well as the vectors @xmath150 and @xmath151 depends on both @xmath15 and @xmath18 , although we have suppressed that dependence in the notation . however , there are only finitely many choices for the carrier number @xmath201 and the minimal support when @xmath15 is fixed and @xmath18 varies within a given stratum of @xmath23 .",
    "in particular , if @xmath201 remains constant in a neighbourhood of @xmath245 , then @xmath112 and @xmath225 do not change for small enough changes in @xmath15 and @xmath18 .",
    "it follows that there are only finitely many possibilities for the form that @xmath244 takes when @xmath18 varies in @xmath23 . here , by form , we mean the algebraic expression of @xmath16 as a map .",
    "that is , by ` @xmath246 and @xmath247 taking the same form ' , we mean that they can be obtained using a single algebraic expression for @xmath16 . since the permutation @xmath112 returns all the axes to their canonical order ,",
    "this expression is determined by the partition @xmath193 of the edges of @xmath15 , with the subsets of non - common edges possibly permuted .",
    "for example , in the case of @xmath0 , @xmath16 only takes two possible forms , depending on whether the geodesic from @xmath15 to @xmath18 passes through the cone point or not where the cone point , the origin in @xmath57 , represents the tree whose two edges have zero length .",
    "the two corresponding subsets of @xmath0 are respectively indicated by the unions of light and dark grey regions in figure 3 of @xcite when @xmath15 is the tree corresponding to @xmath248 .",
    "the different possibilities for the form give rise to a _ polyhedral subdivision _ of tree space @xmath23 , defined as follows .    for a fixed @xmath15 lying in a top - dimensional stratum of @xmath23 , the polyhedral subdivision of tree space @xmath23 , with respect to @xmath15 ,",
    "is determined by the possible forms that @xmath16 can take : each polyhedron of the subdivision is the closure of the set of trees @xmath18 that have a particular form for @xmath249 .",
    "we shall call each such top - dimensional polyhedron a maximal cell of the polyhedral subdivision and let @xmath250 be the subset of @xmath23 consisting of all trees that lie on the boundaries of maximal cells determined by the polyhedral subdivision with respect to @xmath15 .",
    "[ def1 ]    note that , if the geodesics to @xmath158 and @xmath160 from @xmath15 pass through the same sequence of strata , then @xmath246 and @xmath247 take the same form . however , the converse is not always true .",
    "for example , it is possible that @xmath158 and @xmath160 lie in different strata , but in the same maximal cell .",
    "hence , the definition of polyhedral subdivision of @xmath23 defined here is similar to , but coarser than , the concept of ` vistal polyhedral subdivision ' given in section 3 of @xcite .",
    "this is due to the fact that , while @xmath251 and @xmath252 in the minimal support play a symmetric role for the geodesic between @xmath15 and @xmath18 , their roles in the log map @xmath16 are asymmetric .",
    "when @xmath18 varies , as long as the corresponding partition @xmath251 either is unchanged or , at most , its subsets corresponding to the non - common edges are permuted , the algebraic expression for @xmath16 remains the same .",
    "this polyhedral subdivision varies continuously with respect to @xmath15 .",
    "if @xmath18 lies in the interior of a maximal cell of the subdivision and @xmath15 , itself in a top - dimensional ( open ) stratum , varies in a small enough neighbourhood , then the support for @xmath15 and @xmath18 is unique .",
    "then , the derivative of the log map will be well - defined .",
    "when @xmath18 lies on the boundary of a maximal cell of the subdivision , but not on a stratum boundary , the possible supports for @xmath15 and @xmath18 are those determined by the polyhedra to which that boundary belongs .",
    "however , all of these supports give rise to the same geodesic between @xmath15 and @xmath18 , as they must since @xmath23 is a @xmath9-space , and among them will be the minimal support that we are assuming for our analysis .",
    "moreover , in this case , there is at least one non - minimal support for @xmath15 and @xmath18 with the property that , for the corresponding @xmath150 and @xmath151 , @xmath253 for some @xmath254 .    recall that from definition [ def0 ] that the carrier number counts the number of orthants that the geodesic from @xmath15 to @xmath18 meets in a linear segment of positive length .",
    "it will become clear later that the set of trees @xmath18 for which , for a given @xmath15 , the carrier number @xmath201 is less than its possible maximum @xmath200 , where @xmath204 is the number of common edges of @xmath15 and @xmath18 , plays a role that distinguishes the limiting distributions of sample frchet means in the tree spaces from those in euclidean space .",
    "hence , we introduce the following definition .    a point @xmath41 is called singular , with respect to a tree @xmath15 lying in a top - dimensional stratum , if the carrier number @xmath201 of @xmath15 and @xmath18 is less than @xmath200 .",
    "the set of such singular points will be denoted by @xmath255 .",
    "[ def2 ]    the following result describes the image , under @xmath16 , in the tangent space at @xmath15 of the set @xmath255 : although @xmath255 may be rather complex , its image is relatively simple .",
    "if @xmath256 lies in a top - dimensional stratum , then the image , under @xmath16 , of the set @xmath255 of the singular points with respect to @xmath15 is contained in the union of the hyperplanes @xmath257 , @xmath258 , in @xmath40 .",
    "[ cor1 ]    the number of orthants in the minimal carrier of the geodesic from @xmath15 to @xmath18 is less than @xmath200 if and only if the dimension @xmath259 of some vector @xmath203 is greater than one for @xmath254 .",
    "then , @xmath225 maps the line determined by @xmath221 in @xmath260 into the subspace of @xmath40 that is the intersection of the co - dimension one hyperplanes @xmath261 in @xmath40 , where @xmath262 and where the ordering of the coordinates @xmath263 , and hence of the @xmath264 , is as in the minimal carrier .",
    "then , applying the permutation @xmath112 and using the same notation for the permuted @xmath265-coordinates , the result follows .    , which contains some of the singular points for the log map @xmath266 for example  [ ex : logmap].,width=288 ]    for example , see figure  [ fig : logmap_4 ] for an illustration of one of the hyperplanes for example  [ ex : logmap ] .",
    "to describe the limiting behaviour of sample frchet means , it will be more convenient to have a modified version of the log map , @xmath267 , at @xmath15 defined by @xmath268 in the present context , where @xmath15 lies in a top - dimensional stratum , @xmath269 .",
    "note that , when @xmath15 lies in a top - dimensional stratum , the map corresponding to @xmath267 here obtained in @xcite in the case of @xmath0 was expressed as the composition of a similarly defined map on @xmath270 , a simpler auxiliary stratified space , with a map from @xmath270 to @xmath0 . instead of the log map ,",
    "that map on @xmath270 was expressed in terms of the gradient of the squared distance function .",
    "the relationship between the latter and the log map shows that the resulting expression in @xcite is equivalent to the one defined here .",
    "the derivation of @xmath267 from @xmath16 implicitly requires that the tangent space to @xmath23 at @xmath15 , in which the image of @xmath16 lies , be translated to the parallel copy @xmath40 at the origin , in which it makes sense to add the coordinate vector @xmath271 . as a result , for all @xmath272 in the same stratum as @xmath15 , the image of @xmath273 will lie in this same subspace @xmath40 .",
    "let @xmath3 be a probability measure on @xmath23 and assume that the frchet function for @xmath3 is finite .",
    "the space @xmath23 being @xmath9 implies that the frchet function for @xmath3 is strictly convex so that , in particular , the frchet mean of @xmath3 is unique when it exists . in this section",
    ", we consider the case when this mean , denoted by @xmath15 , lies in a top - dimensional stratum .",
    "for this , as in the previous section , we identify any tree @xmath272 in the stratum of @xmath23 in which @xmath15 lies with the point in the positive orthant of @xmath40 having the lengths of the internal edges of @xmath272 as coordinates in the canonical order .",
    "in particular @xmath274 .",
    "first , we use the log map to give a necessary and sufficient condition for @xmath15 to be the frchet mean of @xmath3 as follows , generalising the characterisation of frchet means on complete and connected riemannian manifolds of non - negative curvature . in particular",
    ", it shows that , when @xmath18 is a random variable on @xmath23 with distribution @xmath3 and @xmath15 is in a top - dimensional stratum , then @xmath15 is the frchet mean of @xmath3 if and only if @xmath15 is the euclidean mean of the euclidean random variable @xmath275 .",
    "assume that the frchet mean @xmath15 of @xmath3 lies in a top - dimensional stratum .",
    "then , @xmath15 is characterised by the following condition @xmath276 [ lem1a ]    it can be checked that , since @xmath15 lies in a top - dimensional stratum , the squared distance @xmath277 is differentiable at @xmath15 and its gradient at @xmath15 is @xmath278 .",
    "thus , as discussed in @xcite @xmath15 , lying in a top - dimensional stratum , is the frchet mean of a given probability measure @xmath3 on @xmath23 if and only if @xmath279 then , the required result follows by re - expressing the above condition for @xmath15 to be the frchet mean of @xmath3 in terms of @xmath267 given by .",
    "the derivation of the central limit theorem for frchet means in @xmath23 requires the study of the change of @xmath267 as @xmath15 changes with @xmath18 remaining fixed . for this",
    "we recall that , for a fixed @xmath18 , the minimal support for the geodesic between @xmath15 and @xmath18 determines a particular maximal cell , in which @xmath18 lies , of the polyhedral subdivision with respect to @xmath15 .",
    "when the minimal support for the geodesic between @xmath272 and @xmath18 is the same as that for @xmath15 and @xmath18 , we shall say that the two resulting maximal cells _ correspond to each other_. we have the following result on the derivative of @xmath267 with respect to @xmath15 , noting that the derivative of the map @xmath280 is @xmath281 where in particular , when @xmath282 , @xmath283 .",
    "assume that @xmath256 lies in a top - dimensional stratum .",
    "then , for any fixed @xmath41 lying in the interior of a maximal cell of the polyhedral subdivision with respect to @xmath15 , @xmath275 is differentiable with respect to @xmath15 .",
    "moreover , for such @xmath18 , if @xmath203 is as defined in prior to theorem @xmath284 and @xmath143 defined analogously for @xmath218 , where @xmath207 , then the derivative of @xmath275 at @xmath15 , with respect to @xmath15 , is given by @xmath285 where @xmath286 and @xmath287 denotes the matrix representing the permutation @xmath112 defined by .",
    "[ lem2 ]    note that , for the sub - matrix @xmath288 to be non - zero , @xmath203 must be at least 2-dimensional and , by definition , @xmath289 is non - positive so that @xmath18 must lie in @xmath255 . in particular , if @xmath290 , in other words , if the geodesic between @xmath15 and @xmath18 is ` straight ' , then the derivative of @xmath275 at @xmath15 is zero .",
    "this could be seen directly : since , in that case , the tree space geodesic between @xmath15 and @xmath18 would be a euclidean geodesic between them .",
    "then , @xmath291 so that @xmath292 independent of @xmath271 .    by the discussion preceding the lemma , the edges common to @xmath15 and @xmath18 will make no contribution to the derivative . since the polyhedral subdivision is continuous with respect to @xmath15 , it is sufficient to show that , when @xmath293 is sufficiently close to @xmath15 , so that in particular @xmath15 and @xmath293 lie in the same top stratum and @xmath18 lies in the interior of the corresponding maximal cells of the polyhedral subdivisions with respect to @xmath15 and @xmath272 , we have @xmath294 to show , it is sufficient to assume that @xmath15 and @xmath18 have no common edge .",
    "moreover , since @xmath295 , and so @xmath287 , is a linear map , its derivative is identical with itself .",
    "hence , by applying the appropriate permutation to re - order the @xmath296 and @xmath115 corresponding to @xmath272 and @xmath18 when necessary , it is sufficient to show that @xmath297 since @xmath18 lies in the interior of a maximal cell of the polyhedral subdivision of @xmath23 with respect to @xmath15 , then @xmath298 for all @xmath137 , where all @xmath289 are negative . by continuity ,",
    "all these strict inequalities hold when @xmath299 is replaced by @xmath300 if @xmath272 is sufficiently close to @xmath15 .",
    "hence , @xmath18 lies in the interior of a maximal cell of the polyhedral subdivision of @xmath23 with respect to @xmath272 .",
    "thus , the only difference between the expressions for @xmath275 and @xmath301 is that @xmath150 and @xmath203 in the former are replaced by @xmath302 and @xmath303 respectively in the latter .",
    "it follows that , in this case , the difference @xmath304 can be expressed as @xmath305 the required result follows by applying the first order taylor expansion to each sub - vector component and using the formula preceding the statement of the lemma .",
    "if @xmath18 lies on the boundary of a maximal cell of the polyhedral subdivision of @xmath23 with respect to @xmath15 , each choice of maximal cell of the polyhedral subdivision with respect to @xmath15 will determine a support for the geodesic from @xmath15 to @xmath18 .",
    "if we restrict the neighbouring @xmath272 to move from @xmath15 in a direction such that @xmath18 lies in the corresponding maximal cell of the polyhedral subdivision with respect to @xmath272 , then the argument in the proof for lemma [ lem2 ] still holds . thus , @xmath275 will have all directional derivatives , at @xmath15 , with respect to @xmath15 having similar forms to that given in lemma [ lem2 ]",
    ". however , some different directions will require different choices of maximal cell of the polyhedral subdivision with respect to @xmath15 in which @xmath18 lies .",
    "thus , the directional derivative will have different forms and @xmath275 will not be differentiable .",
    "lemma [ lem2 ] enables us to obtain the limiting distribution of the sample frchet means of a sequence of _ iid _ random variables on @xmath23 when the frchet mean of the underlying probability measure lies in a top - dimensional stratum as follows , recalling that @xmath250 , defined in definition @xmath306 , is the subset of @xmath23 consisting of all trees that lie on the boundaries of maximal cells determined by the polyhedral subdivision with respect to @xmath15 . on one hand",
    ", the result shows that , in this case , the limiting distribution , being a gaussian distribution , bears a certain similarity to that of the sample means of euclidean random variables . on the other hand , recalling that the derivative of @xmath275 at @xmath15 is zero if @xmath307 , it also shows that the role played by @xmath255 in the limiting behaviour of the sample frchet means is reflected in the covariance structure of the gaussian distribution , departing from the limiting distribution of the sample means of euclidean random variables .",
    "let @xmath3 be a probability measure on @xmath23 with finite frchet function and with frchet mean @xmath15 lying in a top - dimensional stratum .",
    "assume that @xmath308 .",
    "suppose that @xmath309 is a sequence of iid random variables in @xmath23 with probability measure @xmath3 and denote by @xmath310 the sample frchet mean of @xmath311 .",
    "then , @xmath312 where @xmath313 is the covariance matrix of the random variable @xmath246 , or equivalently that of @xmath314 , and @xmath315\\right\\}^{-1 } , \\label{eqn5a}\\end{aligned}\\ ] ] assuming that this inverse exists , and where @xmath316 is the @xmath317 matrix defined by .",
    "[ thm2 ]    the main argument underlying the proof is similar to that of the proof in @xcite for @xmath0 , i.e. , to express the difference between the frchet mean of the underlying probability measure and the sample frchet means in terms of the difference @xmath318 .",
    "however , the proof in @xcite relies on an explicit embedding that is only valid for @xmath0 . as a consequence of lemma [ lem2 ]",
    ", we can now achieve this for any tree space .    since @xmath310 is the frchet sample mean of @xmath311 , then for sufficiently large @xmath319 , @xmath310 will be close to @xmath15 a.s .",
    "@xcite ) and , in particular , lie in the same stratum as @xmath15 .",
    "thus , the above results and give @xmath320 hence , @xmath321 since @xmath322 is a sequence of _ iid _ random variables in @xmath40 with mean @xmath15 and @xmath323 is a sequence of _ iid _ random matrices , the following theorem follows from the standard euclidean result as in @xcite .",
    "recalling that @xmath324 for @xmath158 not lying in the singularity set of @xmath16 , we see that the contribution to @xmath325 $ ] consists of all singular points of @xmath16 . for @xmath326 , i.e. the case for @xmath327 , the only possible choice for @xmath22 is @xmath328 which implies that @xmath329 , so that the above result for this special case is the same as that obtained in @xcite . for @xmath330 ,",
    "i.e. the case for @xmath0 , the only possible case for @xmath18 lying in the singularity set of @xmath16 is when @xmath90 , which corresponds to the geodesic between @xmath15 and @xmath18 passing through the origin and @xmath331 .",
    "then , the corresponding @xmath316 has the expression @xmath332 so that the above result for this case recovers that in @xcite .",
    "note that @xmath3 induces , by @xmath16 , a probability distribution @xmath333 on the tangent space of @xmath23 at @xmath15 .",
    "then , the sample frchet means of @xmath333 are the standard euclidean means @xmath334 so that the rescaled sample frchet means have the limiting distribution @xmath335 .",
    "however , the sample frchet means of @xmath333 are generally different from @xmath336 , the log images of the sample frchet means of @xmath3 , and there is no closed expression for the relationship between the two .",
    "it is also interesting to compare the result of theorem [ thm2 ] with the limiting distributions for the sample frchet means on riemannian manifolds obtained in @xcite . both limiting distributions",
    "take a similar form , with the role played by curvature in the case of manifolds being replaced here by the global topological structure of the tree space .",
    "a stratum @xmath59 of co - dimension one corresponding to the set @xmath58 of mutually compatible edge - types arises as a boundary face of a top - dimensional stratum when one , and only one , internal edge of the latter is given length zero so that its two vertices are coalesced to form a new vertex of valency four .",
    "the four incident edges determine disjoint subsets @xmath337 of leaves and root , where @xmath338 contains the root .",
    "then an additional internal edge may be introduced to @xmath58 , namely @xmath339 , @xmath340 or @xmath170 that correspond respectively to the sets of leaves @xmath341 , @xmath342 or @xmath343 .",
    "this gives top - dimensional strata @xmath344 , @xmath345 or @xmath346 , all of whose boundaries contain the stratum @xmath59 .",
    "moreover , these are the only such top - dimensional strata . for example , in figure  [ fig:3_quadrants ] , the leaves and root subsets are @xmath347 , @xmath348 , @xmath349 , and @xmath350 , while the sets of edge - types are @xmath351 , @xmath352 , @xmath353 and @xmath354 .    if @xmath355 is the canonical order of the sets of leaves , then @xmath356 is the induced order of the edges and corresponding semi - axes and , if we write the coordinates of a tree @xmath15 in @xmath59 as @xmath357 , we can write the coordinates of trees in the neighbouring orthants as @xmath358 where precisely two of @xmath359 and @xmath360 are zero , since the remaining @xmath361 edge - types are common to all the trees involved in these three orthants and their common boundary component .",
    "note however that , although the coordinates @xmath362 and @xmath357 can be chosen in canonical order , that will not in general be the case for the full set of coordinates .",
    "it is clear now that the tree space @xmath23 is not locally a manifold at any tree in the strata of co - dimension one .",
    "however , the stratification enables us to define , at a tree in a stratum of positive co - dimension , its tangent cone ( cf .",
    "@xcite ) to consist of all initial tangent vectors of smooth curves _ starting _ from that tree .",
    "then , the tangent cone to @xmath23 at a tree in a stratum of co - dimension one is an open book ( cf .",
    "@xcite ) with three pages extending each of the three strata and with the stratum of co - dimension one in which the tree lies being extended to form its spine .",
    "the definition of the log map applies equally to a tree @xmath15 in a stratum @xmath26 of co - dimension one : if the geodesic from @xmath15 to @xmath18 passes through one of the three strata whose boundary includes @xmath26 , the unit vector component of @xmath249 is taken in the same direction in the page of the tangent book that corresponds to that stratum .",
    "the scalar component of the log map is still the distance between the trees .",
    "similarly , the definition for @xmath267 remains valid in this case .    from now on",
    ", we assume that @xmath15 lies in a stratum @xmath59 of co - dimension one .",
    "although the squared distance @xmath277 is no longer differentiable at @xmath15 , it has directional derivatives along all possible directions .",
    "hence , the condition for @xmath15 to be the frchet mean of a probability measure @xmath3 on @xmath23 , i.e. the condition for @xmath15 to satisfy @xmath363 becomes that the frchet function for @xmath3 has , at @xmath15 , non - negative directional derivatives along all possible directions . to investigate the latter condition , we label the three strata joined at the stratum @xmath59 , of co - dimension one , in which @xmath15 lies as the @xmath339- , @xmath340- and @xmath170-strata and denote by @xmath364 , @xmath365 and @xmath366 respectively the modifications of the map @xmath16 that agree with @xmath16 on the domains for which the image lies in the pages of the tangent book tangent to the @xmath339- , @xmath340- and @xmath170-strata respectively and are zero elsewhere .",
    "that is , for example , @xmath367 write @xmath368 , @xmath369 and @xmath370 for the outward unit vectors in the tangent book at @xmath15 lying in the page tangent to the @xmath339- , @xmath340- and @xmath170-strata respectively and orthogonal to its spine , and define @xmath371 we also define @xmath372 to be the modification of @xmath16 with respect to the spine of the tangent book , the tangent space to @xmath59 , analogous to the above @xmath373 .",
    "then , we have the following characterisation of @xmath15 in a stratum of co - dimension one to be the frchet mean of @xmath3 , in terms of the derivatives of the frchet function along the three directions orthogonal to the tangent space to @xmath59 , as well as the euclidean mean of @xmath374 , where @xmath18 is a random variable on @xmath23 with distribution @xmath3 .    with the notation and definition above ,",
    "a given tree @xmath15 in a stratum @xmath59 of co - dimension one is the frchet mean of a given probability measure @xmath3 on @xmath23 if and only if @xmath375 and @xmath376 [ lem3 ]    recall that since @xmath377 , the condition for @xmath15 to be the frchet mean of a probability measure @xmath3 on @xmath23 is that the frchet function for @xmath3 has , at @xmath15 , non - negative directional derivatives along all possible directions .    for any vector @xmath378 at @xmath15 which is tangent to @xmath59 ,",
    "the non - negativity of the directional derivative along @xmath378 can be expressed as @xmath379 .",
    "since @xmath380 also tangent to @xmath59 at @xmath15 , this inequality must be an equality for all such @xmath378 , which gives .",
    "hence , by linearity , the non - negativity of directional derivatives , of the frchet function for @xmath3 , at @xmath15 along all possible directions may be characterised by requiring the non - negativity of the directional derivatives along the @xmath368 , @xmath369 and @xmath370 directions , together with .",
    "however , analogously to the deduction in @xcite , it can be checked that the requirement for the directional derivative along each of the @xmath368 , @xmath369 and @xmath370 directions to be non - negative is respectively equivalent to each of the inequalities .    to see the relation between the inequalities and the asymptotic behaviour of sample frchet means , we will use a folding map @xmath381 ( cf .",
    "@xcite ) that operates on the tangent book at @xmath15 .",
    "the map @xmath381 folds the two pages that are tangent to the @xmath340- and @xmath170-strata onto each other , so that they form the complement in @xmath40 of the closure of the page tangent to the @xmath339-stratum .",
    "define @xmath382 and @xmath383 similarly .",
    "then , @xmath384 maps @xmath23 to @xmath40 and , in fact , is the limit of @xmath385 when @xmath272 tends to @xmath15 from the @xmath339-stratum . in addition",
    ", we modify the definition of @xmath386 to be @xmath387 when , and only when , the @xmath203 in contains @xmath388 and is 1-dimensional . with this modification and by noting that the argument leading to lemma [ lem1 ] , as well as its result , still hold when @xmath15 lies in a stratum of co - dimension one , the results of theorem [ thm1 ] and lemma [ lem2 ] can be extended to obtain the expression for @xmath384 and its derivative , and the analogues with @xmath340 or @xmath170 replacing @xmath339 , when the necessary care is taken of which stratum is to contain the initial geodesic . moreover , @xmath389 these observations lead to the following lemma which extends the results obtained in @xcite for open books and in @xcite for @xmath0 and relates the frchet means of large samples avoiding a stratum to the strict - positivity of the derivative of the frchet function along the corresponding orthogonal direction to the tangent space to @xmath59 .",
    "let @xmath15 be the frchet mean of a given probability measure @xmath3 on @xmath23 , and lie in a stratum @xmath59 of co - dimension one .",
    "assume that @xmath308 , where @xmath250 is defined in definition @xmath306 , and that , at @xmath15 , @xmath390 .",
    "if @xmath309 is a sequence of iid random variables in @xmath23 with probability measure @xmath3 then , for all sufficiently random large @xmath319 , the sample frchet mean @xmath310 of @xmath311 can not lie in the @xmath339-stratum .",
    "[ lem4 ]    since @xmath310 converges to @xmath15 a.s .",
    "as @xmath319 tends to infinity ( cf.@xcite ) we only need to show that , for all sufficiently large @xmath319 , @xmath310 can not lie in the neighbourhood of @xmath15 , restricted to the @xmath339-stratum .",
    "consider the probability measure @xmath391 induced from @xmath3 by @xmath384 on the euclidean space . then , under the given conditions , it follows from that the euclidean mean of @xmath391 lies on the open half of the euclidean space complement to the page tangent to the @xmath339-stratum ( cf . also @xcite ) .",
    "thus , for all sufficiently large @xmath319 , the euclidean mean of the induced random variables @xmath392 , @xmath393 does not lie in the closed half of this euclidean space where the page tangent to the @xmath339-stratum lies .",
    "this implies that , for all sufficiently large @xmath319 , @xmath394 if it were possible that , for arbitrarily large @xmath319 , @xmath310 lies in the @xmath339-stratum , we could obtain a contradiction .",
    "firstly , noting the observations prior to the lemma and following the arguments of the proof for lemma [ lem2 ] , for all sufficiently large @xmath319 , we have @xmath395 where @xmath316 is given by and @xmath396 .",
    "however , on the one hand , since @xmath397 @xmath398 and since @xmath310 lies in the @xmath339-stratum , @xmath399 , so that @xmath400 while on the other hand , it follows from @xmath401 and from that @xmath402 it can also be checked that @xmath403 where @xmath404 , if @xmath405 corresponds to a coordinate of @xmath406 and if the dimension of @xmath406 is greater than one , and @xmath407 otherwise . then , since @xmath408 , for each @xmath137 @xmath409 equations and together imply that , for all sufficiently large @xmath319 , the @xmath410-component of the right hand side of is negative , which contradicts .    with the result of lemma [ lem4 ]",
    ", we now have the limiting distribution of the sample frchet means on @xmath23 given by the next theorem , which is the generalisation of the result for @xmath0 given in theorem 2 in @xcite . in particular , it shows that the limiting distribution can take any of four possible forms , all related to a gaussian distribution , depending on the number of the strictly positive derivatives of the frchet function along the three directions orthogonal to the tangent space to @xmath59 . for clarity ,",
    "we have assumed in the following that the coordinates @xmath411 , @xmath412 , discussed at the beginning of the section are all in the canonical order , so that they give the coordinates for trees in each of the three strata .",
    "otherwise , a further permutation of the coordinates , which we have suppressed , will be necessary to bring them into canonical order and so to validate the result .",
    "let @xmath15 in a stratum @xmath59 of co - dimension one be the frchet mean of a given probability measure @xmath3 on @xmath23 .",
    "assume that @xmath308 , where @xmath250 is defined in definition @xmath306 .",
    "let further @xmath309 be a sequence of iid random variables in @xmath23 with probability measure @xmath3 and write @xmath310 for the sample frchet mean of @xmath311 .    1 .",
    "if all three inequalities in are strict then , for all sufficiently large @xmath319 , @xmath310 will lie in the stratum @xmath59 and the sequence @xmath413 of the coordinates of @xmath414 on the spine will converge in distribution to @xmath415 as @xmath416 , where @xmath417 is the covariance matrix of the random variable @xmath418 , @xmath419 , @xmath420 is the projection matrix to the subspace of @xmath40 with the first coordinate removed and @xmath60 is as given in @xmath421 .",
    "2 .   if the first inequality in is an equality and the other two are strict then , for all sufficiently large @xmath319 , @xmath310 will lie in the @xmath339-stratum and @xmath422 where @xmath423 , @xmath313 is the covariance matrix of @xmath424 and @xmath60 is as in with @xmath425 .",
    "3 .   if the first two inequalities in are equalities and the third is strict then , for all sufficiently large @xmath319 , @xmath310 will lie either in the @xmath339-stratum or in the @xmath340-stratum and the limiting distribution of @xmath414 , as @xmath416 , will take the same form as that of @xmath426 above , where the coordinates of @xmath310 are taken as @xmath427 , respectively @xmath428 , if @xmath310 is in the @xmath339-stratum , respectively the @xmath340-stratum .",
    "if all the equalities in are actually equalities , then we have the same result as in @xmath429 .    [ thm3 ]    @xmath429 by lemma [ lem4 ] ,",
    "when @xmath319 is sufficiently large , @xmath310 must lie in the stratum @xmath59 of co - dimension one so that it has zero first coordinate , i.e. @xmath430 . noting that @xmath431 , the result of lemma [ lem3 ] shows that @xmath432 , @xmath433 , are the respective coordinates of @xmath434 , the sample euclidean mean of @xmath435 . then a modification of the proof of theorem [ thm2 ] to restrict it to the relevant coordinates of @xmath436 gives the required limiting distribution of @xmath413 .",
    "@xmath437 we deduce from the assumed strict inequalities , from and and from lemma [ lem4 ] that @xmath15 is the euclidean mean of @xmath438 and that , when @xmath319 is sufficiently large , @xmath310 can only lie in the closure of the @xmath339-stratum , so that it has coordinates @xmath439 .",
    "write @xmath440 then , @xmath441 lies in @xmath40 and , by , @xmath442 , @xmath443 , are the respective coordinates of @xmath444 . to see relationship between @xmath444 and @xmath445",
    ", we note that , if @xmath446 , @xmath447 where the first equality follows from the definition of @xmath441 and the second follows from lemma [ lem1a ] as @xmath310 lies in a top - dimensional stratum .",
    "hence , @xmath448 on the other hand , if @xmath449 , then @xmath310 lies in @xmath59 and @xmath450 applying lemma [ lem3 ] and to the empirical distribution centred on @xmath311 with equal weights @xmath451 , we also have @xmath452 thus , @xmath453 now , similarly to the proofs of theorem [ thm2 ] and lemma [ lem4 ] , the observations prior to lemma [ lem4 ] imply that @xmath454 where @xmath316 is given by . since the first coordinate of @xmath15 is zero , so too are the entries , except for the diagonal one , in the first row and column of @xmath316 and so also are the corresponding entries in the matrix @xmath60 .",
    "moreover , noting the comments following lemma [ lem2 ] and the definition of @xmath455 prior to that lemma , we see that the first diagonal entry of @xmath316 is always non - positive .",
    "thus , the first diagonal entry of @xmath60 must be positive , so that this is also the case for @xmath456 , when @xmath319 is sufficiently large .",
    "thus , when @xmath457 , it follows from and that @xmath458 in particular , for all sufficiently large @xmath319 , the first coordinate of the random vector given by the first term on the right is positive .",
    "when @xmath459 the above approximation still holds except for the first coordinate . in that case ,",
    "@xmath460 , following from the form of @xmath316 noted above , and by , for sufficiently large @xmath319 , @xmath461 up to higher order terms , which is equivalent to @xmath462 up to higher order terms .",
    "hence , for sufficiently large @xmath319 , we have @xmath463 where @xmath464 so that the required result follows from a similar argument to that of the proof for theorem [ thm2 ] .",
    "@xmath465 in this case , it follows from lemma [ lem3 ] that @xmath15 is the euclidean mean both of @xmath438 and of @xmath466 .",
    "moreover , the integral @xmath467 becomes zero and so , since the integrand is non - negative , the support of the measure on the tangent book at @xmath15 induced by @xmath3 is contained in the union of the leaves tangent to the @xmath339- and @xmath340-strata together with the spine .",
    "it is now more convenient to represent the union of the @xmath339- and @xmath340-strata by coordinates in the two orthants @xmath468 of @xmath40 . for this , we map : @xmath469 where @xmath470 . similarly , we define maps @xmath471 to accord with this by @xmath472 , while @xmath473 . since @xmath474 , the map",
    "@xmath475 is indeed a.s .",
    "well defined for points @xmath476 .",
    "clearly , @xmath477 where @xmath478 , similarly @xmath479 , is defined by . under this new coordinate system ,",
    "since @xmath480 a.s . , we have in particular that @xmath481 by lemma [ lem4 ] , the given assumption also implies that , for sufficiently large @xmath319 , @xmath310 will a.s .",
    "lie either in the @xmath339-stratum or in the @xmath340-stratum .",
    "if @xmath310 lies in the @xmath339-stratum , then @xmath457 and @xmath482 and , if @xmath310 lies in the @xmath340-stratum with ( original ) coordinates @xmath483 , then @xmath484 if @xmath310 lies on the stratum @xmath59 of co - dimension one then , by applying the argument in @xmath437 to both @xmath449 and @xmath485 , we also have @xmath486 recalling that , under the new coordinate system , @xmath487 we have by , , and that , in terms of the new coordinates , @xmath488 hence , since still holds under this new coordinate system when @xmath489 and @xmath490 there are replaced by @xmath491 and @xmath492 respectively , a similar argument to that of the proof for theorem [ thm2 ] shows the central limit theorem now takes the required form .",
    "@xmath493 noting that all integrands in are non - negative , the three equalities will together imply that @xmath494 a.s .",
    ", so that for @xmath412 @xmath495 on the other hand , if it were possible that , for arbitrarily large @xmath319 , @xmath310 lies in one of the @xmath339- @xmath340- or @xmath170-strata , say the @xmath339-stratum , then @xmath496 . on the other hand , since @xmath497 and since , as noted in @xmath437 , the first diagonal element of @xmath498 is non - positive and the remaining entries in the first row and column of @xmath498 are all zero , we have by that @xmath499 this contradiction implies that , for all sufficiently large @xmath319 , @xmath310 must lie in the stratum @xmath59 of co - dimension one .",
    "thus , the argument for ( _ a _ ) implies that , when the inequalities in are all equalities , the central limit theorem for the sample frchet means takes the same form as that when the three inequalities are all strict .",
    "similar to the note at the end of the previous section , one can also consider the distribution @xmath333 , induced by @xmath16 from @xmath3 on the tangent book of @xmath23 at @xmath15 .",
    "then , one can apply the result of @xcite to obtain the limiting distribution of the sample frchet means of @xmath333 . again , although the limiting distribution obtained in this way retains the local topological feature of the space , the influence of the global topological structure is lost . more importantly ,",
    "since there is no clear relationship between the sample frchet means of @xmath3 and @xmath333 , the limiting distribution for the former can not be easily deduced from that for the latter .",
    "the structure of tree space in the neighbourhood of a stratum of higher co - dimension is basically similar to , but in detail rather more complex than , that of a stratum of co - dimension one .",
    "for example , a stratum @xmath26 of co - dimension @xmath239 , where @xmath500 , corresponds to a set of @xmath501 mutually compatible edge - types .",
    "it arises as a boundary @xmath502-dimensional face of a stratum @xmath24 of co - dimension @xmath503 , where @xmath504 and when the internal edges of the trees in @xmath26 are a particular subset of @xmath501 of the internal edges of the trees in @xmath24 .",
    "for this situation , we say that @xmath26 bounds @xmath24 and @xmath24 co - bounds @xmath26 .",
    "recall from the previous section that the tangent cone to @xmath23 at a tree @xmath18 in @xmath26 consists of all initial tangent vectors to smooth curves starting from @xmath18 , the smoothness only being one - sided at @xmath18 . for simplicity assume , without loss of generality , that under the isometric embedding of @xmath23 in @xmath57 all trees in @xmath26 have zero for their first @xmath239 coordinates .",
    "then the tangent cone at @xmath18 has a stratification analogous to that of @xmath23 itself in the neighbourhood of @xmath18 : for each stratum @xmath24 of co - dimension @xmath503 that co - bounds @xmath26 in @xmath23 there is a stratum @xmath505 in the tangent cone at @xmath18 , which may be identified with a subset of the full tangent space of @xmath57 at @xmath18 , where @xmath506 is the ( full ) tangent subspace to @xmath26 at @xmath18 and @xmath507 is the orthant determined by the edge - types that have positive length in @xmath24 but zero length in @xmath26 .",
    "for example , the cone point in @xmath0 is a stratum of co - dimension two .",
    "its tangent cone can be identified with @xmath0 itself .",
    "this rather involved structure of the tangent cone results in a much more complicated description of the log map and , consequently , of its behaviour . nevertheless , with the above conventions , it is possible to generalise our expression for the log map to this wider context and hence to obtain analogues of theorem [ thm1 ] as well as lemma [ lem2 ] .",
    "these results can then be used to describe , in a fashion similar to those of lemmas [ lem3 ] and [ lem4 ] , certain limiting behaviour of sample frchet means when their limit lies in a stratum of higher co - dimension .",
    "for example , the limiting behaviour of sample frchet means in @xmath0 when the true frchet mean lies at the cone point has been studied in @xcite . the picture given there is incomplete and , although those results can be further refined and improved , it is clear that a complete description of the limiting behaviour of sample frchet means in the wider context is still a challenge and the global topological structure of the space will play a crucial role .",
    "99 m. bacak ( 2014 ) computing medians and means in hadamard spaces , _ siam j. optimiz .",
    "_ * 24 * , 1542 - 1566 .",
    "barden , h. le and m. owen ( 2013 ) central limit theorems for frchet means in the space of phylogenetic trees , _ electron .",
    "j. probab . _",
    "* 18 * no . 25 .",
    "b. basrak ( 2010 ) limit theorems for the inductive mean on metric trees , _ j. appl",
    ". prob . _ * 47 * , 1136 - 1149 .",
    "r. bhattacharya and v. patrangenaru ( 2005 ) large sample theory of intrinsic and extrinsic sample means on manifolds - ii , _ ann .",
    "statist . _",
    "* 33 * , 1225 - 1259 .",
    "r. bhattacharya and v. patrangenaru ( 2014 ) statistics on manifolds and landmarks based image analysis : a nonparametric theory with applications , _ journal of statistical planning and inference _ ( 2014 ) * 145 * , 1 - 22 .",
    "billera , s.p .",
    "holmes and k. vogtmann ( 2001 ) geometry of the space of phylogenetic trees , _ adv .",
    "_ * 27 * , 733 - 767 . m.r .",
    "bridson and a. haefliger ( 1999 ) _ metric spaces of non - positive curvature_. grundlehren der mathematischen wissenschaften , 319 .",
    "wissspringer - verlag , berlin / new york .",
    "dryden , h. le , s. preston and a.t.a .",
    "wood ( 2014 ) mean shapes , projections and intrinsic limiting distributions , _ journal of statistical planning and inference _ * 145 * , 25 - 32 . i.l .",
    "dryden and k.v .",
    "mardia ( 1998 ) _ statistical shape analysis_. wiley , chichester .",
    "a. feragen , m. owen , j. petersen , m.m.w .",
    "wille , l.h .",
    "thomsen , a. dirksen , m. de bruijne ( 2013 ) tree - space statistics and approximations for large - scale analysis of anatomical trees , ipmi 2013 : 74 - 85 .",
    "s. holmes ( 2003 ) statistics for phylogenetic trees ,",
    "_ theoretical population biology _ * 63 * , 17 - 32 .",
    "t. hotz , s. huckemann , h. le , j.s .",
    "marron , j.c .",
    "mattingly , e. miller , j. nolen , m. owen , v. patrangenaru , and s. skwerer ( 2013 ) sticky central limit theorems on open books , _ ann . appl .",
    "* 23 * , 2238 - 2258 .",
    "kendall and h. le ( 2011 ) limit theorems for empirical frchet means of independent and non - identically distributed manifold - valued random variables , _ brazilian journal of probability and statistics _ * 25 * , 323 - 352 .",
    "e. miller , m. owen and s. provan ( 2015 ) polyhedral computational geometry for averaging metric phylogenetic trees , _ adv .",
    "_ * 68 * , 51 - 91 .",
    "nye ( 2011 ) principal components analysis in the space of phylogenetic trees , _ ann .",
    "_ * 39 * , 2716 - 2739 .",
    "nye ( 2014 ) an algorithm for constructing principal geodesics in phylogenetic treespace , _ ieee / acm trans .",
    "computational biology and bioinformatics _ * 11 * , 304 - 315 .",
    "m. owen ( 2011 ) computing geodesic distances in tree space , _ siam j. discrete math .",
    "_ * 25 * , 1506 - 1529 . m. owen and j.s . provan ( 2011 )",
    "a fast algorithm for computing geodesic distances in tree space , _ ieee / acm trans . computational biology and bioinformatics _",
    "* 8 * , 2 - 13 .",
    "e. schrder ( 1870 ) vier combinatorische probleme , _ zeit .",
    "* 15 * , 361 - 376 .",
    "k. vogtmann ( 2007 ) geodesics in the space of trees , available at www.math.cornell.edu/@xmath508vogtmann/papers/treegeodesicss/index.html . h. ziezold ( 1977 ) . on expected figures and a strong law of large numbers for random elements in quasi - metric spaces ,",
    "_ trans . @xmath509th",
    "prague conf .",
    "theory , stat .",
    "functions , rand .",
    "proc . _ * a * , 591602 ."
  ],
  "abstract_text": [
    "<S> as demonstrated in our previous work on @xmath0 , the space of phylogenetic trees with four leaves , the global , as well as the local , topological structure of the space plays an important role in the non - classical limiting behaviour of the sample frchet means of a probability distribution on @xmath0 . </S>",
    "<S> nevertheless , the techniques used in that paper were specific to @xmath0 and can not be adapted to analyse frchet means in the space @xmath1 of phylogenetic trees with @xmath2 leaves . to investigate the latter , this paper first studies the log map of @xmath1 , a generalisation of the inverse of the exponential map on a riemannian manifold . </S>",
    "<S> then , in terms of a modified version of the log map , we characterise frchet means in @xmath1 that lie in top - dimensional or co - dimension one strata . </S>",
    "<S> we derive the limiting distributions for the corresponding sample frchet means , generalising our previous results . </S>",
    "<S> in particular , the results show that , although they are related to the gaussian distribution , the forms taken by the limiting distributions depend on the co - dimensions of the strata in which the frchet means lie .    </S>",
    "<S> * keywords : * central limit theorem ; frchet mean ; log map ; phylogenetic trees ; stratified manifold .    * ams msc 2010 : * 60d05 ; 60f05 . </S>"
  ]
}