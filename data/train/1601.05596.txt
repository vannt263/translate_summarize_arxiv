{
  "article_text": [
    "layer network coding generated much interest and excitement , especially during the past few years where research towards a fifth generation of wireless systems has been the center of well deserved attention .",
    "a particularly promising protocol , known as _ compute - and - forward _ , and proposed by nazer and gastpar in their award - winning paper @xcite , exploits the natural effects of interference by decoding linear combinations of the transmitted messages at the intermediate relays to achieve high computation rates . while the information theoretic aspects of this protocol have been extensively studied , not much work exists related to code design and decoding methods .",
    "originally , a relay operating under the compute - and - forward protocol would first scale the received signal before applying a minimum - distance decoder to obtain an estimate of the desired linear combination of the codewords .",
    "the decoding error probability in this scenario was studied in @xcite , where _ lattice network coding _ is further introduced as an extension of compute - and - forward to modules over principal ideal domains .",
    "it was later in @xcite where maximum - likelihood ( ml ) decoding at the relay was first studied .",
    "an approach to lattice code design for compute - and - forward was simultaneously derived therein , as well as in @xcite .",
    "the fundamental work carried out in these two articles is essential for the present manuscript , as it introduces the notion of the _ flatness factor _",
    "defintion  [ def : ff_lattice ] ) of a lattice and utilizes it to derive an implicit lattice code design criterion .",
    "this criterion is indirect in the sense that it relates to a sum of random lattices over which the relay sums various gaussian measures , and not to the lattice codes themselves .",
    "the relay can not control this random sum , and the criterion has hence not been further investigated until now .",
    "it is also noteworthy that following the work @xcite , the common belief has been that the structure over which the relay needs to sum is a lattice for any number @xmath4 of transmitters .",
    "this is , as shown later ( cf .",
    "remark  [ rmk : lattice_sum ] ) not the case if @xmath1 .",
    "connecting the flatness factor to the ml decoding metric in compute - and - forward involves a careful manipulation of the latter , and has been carried out in @xcite ; yet a major restriction needed to be imposed , and only integer lattices are allowed at the transmitters .",
    "it is this manipulation that allowed for the derivation of the first efficient decoding algorithms assuming a fading channel model , which were developed first in @xcite and , more recently , in @xcite . to date , however , the algorithms only work in dimension @xmath5 and for integer lattices .",
    "while the ml decoding framework has only been scarcely studied and , as mentioned above , only integer lattices can be employed in the present state of research , other interesting lattices have been proposed for codebook design in the general context of compute - and - forward .",
    "the authors in @xcite construct lattice codes over the eisenstein integers and prove the existence of nested lattices which are simultaneously good for quantization and additive white gaussian noise channel coding .",
    "they further show that their proposed scheme can achieve higher rates than in the original work @xcite .",
    "more recently , an adaptive scheme was introduced in @xcite which , depending on the channel , selects the quadratic number field extension @xmath6 which achieves the highest rate for that specific channel realization .",
    "the lattices used at the transmitters are carved out from a lattice associated to the ring of integers @xmath7 of the chosen number field , and the decoded lattice point is hence an algebraic integer linear combination with coefficients in @xmath7 .",
    "although the proposed scheme exhibits a high complexity , it it still shown that codes from algebraic lattices often provide an improvement in performance , and the the result from @xcite that the eisenstein integers on average achieve the highest rate are reproduced .",
    "it is thus of interest to extend the ml decoding framework to allow for further families of lattices other than integer lattices , such as algebraic lattices .",
    "our main interest lies in analyzing the flatness behavior of the ml decoding metric in compute - and - forward when varying the lattices at the transmitters .",
    "the main contributions are :    * proposition  [ prop : theta_approx ] approximates the theta series of a real lattice given its generator matrix .",
    "this approximation is the main tool that allows us to analyze the behavior of the ml decoding metric in the latter sections of the article . *",
    "an extension of the ml decoding framework from integer lattices to any real lattice in arbitrary dimension .",
    "* for @xmath2 transmitters , after a simplification of the ml decoding metric , we analyze the flatness behavior of the resulting function employing various real lattices at the transmitters .",
    "in particular , we employ algebraic lattices from quadratic and biquadratic number fields .",
    "this is , to the best of the authors knowledge , the first analysis of the actual resulting decoding metric that has been carried out to date . *",
    "we show that , for @xmath1 , the sum of gaussian measures involved in the decoding process is not , as stated in related literature and commonly believed , performed over a lattice , but rather over a sum of @xmath8 random lattices .",
    "this prevents a straightforward generalization of the flatness factor of the decoding metric .",
    "we propose a generalization to @xmath1 transmitters and , for the case @xmath3 , we prove in proposition  [ prop : ff_lattice_sum ] an equivalent statement to the basic case and provide numerical results .    the article is organized as follows : we give an introduction to the essential aspects of lattice theory in section  [ sec : lattices ] , and review the original compute - and - forward strategy in section  [ sec : caf ] .",
    "the ml decoding metric related to compute - and - forward is introduced in section  [ sec : decoding ] , where it is then further manipulated and simplified to ease its analysis , which is carried out in the subsequent section  [ sec : ml_behavior ] . therein , we differentiate the cases of @xmath2 and @xmath1 transmitters and discuss the obtained results .",
    "section  [ sec : conclusions ] concludes the paper .",
    "this section is dedicated to acquainting the reader with basic concepts in lattice theory .",
    "in addition to presenting basic properties of lattices , we derive an approximation of the theta series of a real lattice ( cf . definition  [ def : theta ] ) in proposition  [ prop : theta_approx ] , a result that will allow us to carry out an extensive analysis of the behavior of the decoding metric in the subsequent sections .    in this article ,",
    "a vector is labeled in bold , @xmath9 , and is always represented as a column vector .      a _ lattice _",
    "@xmath10 is a discrete defines the discrete topology on @xmath11 . ]",
    "subgroup of @xmath12 with the property that there exists a basis @xmath13 of @xmath12 such that @xmath14 we say that @xmath13 is a @xmath15-basis of @xmath11 , thus @xmath16 as abelian groups .",
    "we call @xmath17 the _ rank _ , and @xmath18 the _ dimension _ of @xmath11",
    ".    a lattice @xmath19 such that @xmath20 is called a _ _ sublattice _ _ , then the index @xmath21 is finite . ] of @xmath11 .",
    "more conveniently , we can define a _ generator matrix _ @xmath22 for a lattice @xmath11 , so that every point @xmath23 can be expressed as @xmath24 for some coefficient vector @xmath25 .",
    "henceforth we will only consider _ full _ lattices , that is where @xmath26 .    for two vectors",
    "@xmath27 , let @xmath28 denote the euclidean scalar product , which is a non - degenerate , positive definite , symmetric bilinear form .",
    "we can identify the space @xmath12 with its dual vector space @xmath29 via the map @xmath30 where @xmath31 . given a lattice @xmath10 , we equivalently have the notion of its dual lattice .",
    "let @xmath10 be a lattice .",
    "the _ dual lattice _",
    "@xmath32 of @xmath11 is the lattice @xmath33    let us briefly go back and consider a lattice @xmath11 with generator matrix @xmath34_{1 \\le i \\le n}$ ] .",
    "the compact quotient @xmath35 is an @xmath18-dimensional torus , and is obtained by identifying the faces of the _ fundamental parallelotope _ of @xmath11 , defined as @xmath36    the _ volume _ of a lattice @xmath11 is @xmath37 and it is independent of the choice of the generator matrix @xmath38 .    with the above expression , we can easily compute the volume of a sublattice @xmath20 and of the dual lattice @xmath32 as @xmath39    a further useful function related to a lattice @xmath11 is a _ lattice quantizer _ @xmath40 , a function that maps every point in @xmath41 to its closest point in the lattice .",
    "this function allows for a _ modulo - lattice _ operation @xmath42 , as well as for the following definition .",
    "let @xmath11 be a lattice and @xmath40 a lattice quantizer .",
    "the _ voronoi cell _ associated with a lattice point @xmath23 is the set @xmath43 the _ basic voronoi cell _ of @xmath11 is @xmath44 .",
    "let @xmath10 be a lattice , and @xmath45 an arbitrary function for which its _ fourier transform",
    "_ @xmath46 exists , defined by the formula @xmath47    ( * ? ? ?",
    "2.3 ) [ lem : poisson ] let @xmath45 be a function as above . then @xmath48    we finally introduce the most important object , here , related to a lattice : its theta series .",
    "[ def : theta ] let @xmath10 be a full lattice . for each @xmath49 , define @xmath50 the _ theta series _ of @xmath11 is the generating function @xmath51    the theta series converges absolutely if @xmath52 .",
    "although of great importance , the theta series is unfortunately only known in closed form for a handful of lattices , and is usually given in terms of the _ jacobi theta functions _ @xmath53    for our purposes in the subsequent parts of this article , the lattices that we will need to analyze are by no means given in any nice way , but rather arise from random sums . in order to be able to deal with such lattices we propose the following result , which allows to approximate the theta series of a lattice given only its generator matrix . before stating the proposition , we need the following technical definition .",
    "let @xmath54 be a bounded convex set .",
    "we define the set @xmath55 to be the collection of such sets @xmath56 for which there are @xmath57 maps @xmath58^{n-1 } \\to { \\mathbb{r}}^n$ ] satisfying for all @xmath59 a lipschitz condition @xmath60    for a lattice @xmath11 , we henceforth denote by @xmath61 the minimum norm of @xmath11 , which exists since @xmath11 is discrete .",
    "[ prop : theta_approx ] let @xmath10 be a full lattice with fundamental volume @xmath62 , and write for convenience @xmath63 .",
    "the theta series @xmath64 , interpreted as a function of @xmath65 , can be expressed as @xmath66 where the error term is given by @xmath67 the involved constant @xmath68 depends on @xmath18 , @xmath11 , and the liptschitz constant @xmath69 , but is independent of the variable of interest , @xmath65 .",
    "let @xmath70 .",
    "we can express @xmath64 as    @xmath71    the substitution @xmath72 yields @xmath73    let @xmath74 be an @xmath18-dimensional sphere around the origin with radius @xmath75 , @xmath76 .",
    "then it is well known that @xmath77 and @xmath78 .",
    "further , let @xmath54 be such that @xmath79 . then , if @xmath80 , we have @xmath81 where the constant in @xmath82 depends on the lattice @xmath11 , @xmath18 , and the liptschitz constant @xmath69 .",
    "for our situation , let @xmath83 so that @xmath84",
    ". then , @xmath85 and @xmath86    we can thus write @xmath87    although the approximation of @xmath88 given in proposition  [ prop : theta_approx ] involves an integral , the expression can be explicitly computed for a fixed dimension @xmath18 , without the need of further approximations . for the cases treated later in the paper , that is where @xmath89 , the approximation is explicitly given by @xmath90      we conclude this section by introducing various lattices that will be used in latter parts of the paper .",
    "most of the following examples can be found in more detail in @xcite , and as a reference for the basic notions in algebraic number theory , we refer to @xcite .",
    "we start with the most standard example of a lattice , namely @xmath92 .",
    "the identity matrix @xmath93 serves as a generator matrix for @xmath91 , and consequently @xmath94 .",
    "it is clear that @xmath95 , and we have @xmath96 .",
    "for @xmath98 , we define the lattice @xmath99 for which a generator matrix can be given as @xmath100 we have @xmath101 , and @xmath102 .",
    "the @xmath18-dimensional lattice @xmath103 , @xmath104 , is defined as @xmath105    if @xmath106 , the lattice @xmath107 is known as the _ hexagonal lattice _ , and gets its name from the shape of its voronoi cells , which are hexagons .",
    "a generator matrix can be taken to be @xmath108 so that @xmath109 .",
    "we have @xmath95 , and further @xmath110 .    in dimension",
    "@xmath111 , besides @xmath112 , one of the most interesting lattices is the lattice dual to @xmath113 , which can be represented by the generator matrix @xmath114    we can compute @xmath115 and @xmath116 .",
    "let @xmath6 be a number field of degree @xmath18 and signature @xmath117 , corresponding to the number of real and pairs of complex monomorphisms @xmath118 , respectively .",
    "let further @xmath119 be a @xmath15-basis is a free @xmath15-module of rank @xmath18 and , as such , has a @xmath15-basis .",
    "] of the ring of integers @xmath7 of @xmath6 . we can construct a lattice from @xmath7 via the following @xmath120-linear injective map , known as the _ canonical embedding _ :",
    "@xmath121    we have that @xmath122 is a lattice in @xmath12 , and refer to it as an _ algebraic lattice_. a generator matrix for an algebraic lattice is given as @xmath123    in this article , we will restrict to real quadratic and biquadratic number fields @xmath6 , having signature @xmath124 for @xmath89 .",
    "it is well - known that these fields are of the form @xmath125 in the former , and @xmath126 in the latter case , where @xmath127 are square - free , positive integers .",
    "we will shortly denote an algebraic lattice constructed from @xmath6 by @xmath128 .",
    "we refer to ( * ? ? ?",
    "* cor .  2 ) and ( * ? ? ?",
    "42 ( pp .  51 ) ) for obtaining an explicit @xmath15-basis for the ring of integers @xmath7 for @xmath106 and @xmath111 , respectively .",
    "we briefly review the original compute - and - forward framework . assume that @xmath129 transmitters want to communicate to a single destination , aided by @xmath130 intermediate relays which , operating under the original compute - and - forward strategy and assuming a real - valued channel model , attempt to decode an integer linear combination of the transmitted messages .",
    "the model is depicted in figure  [ fig : caf_system_total ] .",
    "( r1 ) relay 1 ; ( vert2 ) @xmath131 ; ( rn ) relay m ; ( vert1 ) @xmath131 ; ( u1 ) tx 1 edge[pil ] node[pos=0.3,above]@xmath132 ( r1.west ) edge[pil ] node[pos=0.3,above , yshift=1mm]@xmath133 ( rn.west ) ; ( uk ) tx k edge[pil ] node[pos=0.3,below , yshift=-1mm]@xmath134 ( r1.west ) edge[pil ] node[pos=0.3,below]@xmath135 ( rn.west ) ; ( dest ) dest",
    ". edge[pil_rev ] ( r1.east ) edge[pil_rev ] ( rn.east ) ; ( dummy1 ) ; ( 1hop ) first hop ; ( 2hop ) second hop ;    the first hop from the transmitters to the relays is modeled as a gaussian fading channel , while it is usually assumed that the relays are connected to a destination with error - free bit pipes with unlimited capacities .",
    "the destination can , upon reception of enough linearly independent equations , attempt to solve for the original codewords . in this article , we are solely interested in the decoding procedure applied by the relays , and hence our focus will be on the first hop .",
    "the transmitters want to communicate messages @xmath136 , where @xmath137 is prime , to the destination . before transmission",
    ", these messages are encoded into @xmath18-dimensional codewords @xmath138 , where @xmath139 is a full rank lattice employed by transmitter @xmath140 , acting as the _ fine _ lattice in the nested code @xmath141 \\in \\lambda_{k , f } \\left(\\bmod\\ \\lambda_{k , c } \\right ) \\mid { \\mathbf{x } } \\in \\lambda_{k , f } \\right\\}$ ] .",
    "we impose a symmetric power constraint @xmath142 \\leq p$ ] for all @xmath140 . the signal - to - noise ratio ( @xmath143 ) is denoted by @xmath144 , where @xmath145 denotes the noise variance , and the fading variance is normalized , @xmath146 .",
    "we can interpret the coarse lattice @xmath147 as the structure imposing the power constraint on the codewords , that is we restrict to codewords @xmath148 inside the fundamental voronoi cell @xmath149 of @xmath147 .",
    "this allows us to ignore its specific definition in the upcoming analysis .    throughout the paper we will only consider real valued channels , which are also studied in the original article @xcite and additionally assumed in @xcite",
    "consequently , we will present the compute - and - forward strategy in its real version and refer to @xcite for the complex alternative . for the received signal at relay @xmath150",
    ", we use the channel model @xmath151 where @xmath152 is additive gaussian noise with variance @xmath145 , and the channel coefficients are i.i.d . with normalized unit variance .",
    "channel state information is only available at the relays ; more specifically , each relay only knows the channel @xmath153 $ ] to itself .",
    "a fixed relay selects a scalar @xmath154 , as well as an integer vector @xmath155^t$ ] , and attempts to decode a linear combination of the received codewords with coefficients @xmath156 .",
    "the channel model is modified to read @xmath157 and the _ effective noise _",
    "@xmath158 is no longer gaussian .",
    "as every relay proceeds in the same fashion , we can focus on a single relay and , for ease of notation , drop the subscript @xmath150 henceforth . the focused system model , now resembling a @xmath4-user multiple - access channel , is illustrated in figure  [ fig : caf_system_onerelay ] .",
    "\\(r ) relay ; ( vert ) @xmath131 ; ( u1 ) tx 1 edge[pil ] node[pos=0.3,above]@xmath159 ( r.west ) ; ( uk ) tx k edge[pil ] node[pos=0.3,below]@xmath160 ( r.west ) ;",
    "an important performance metric of compute - and - forward is the so - called _ computation rate _ explained in the following .",
    "let @xmath161 denote the _ message rate _ at transmitter @xmath140 .",
    "the relay is able to decode a linear combination involving the codewords whose corresponding message rates are smaller than the computation rate @xmath162 achieved by the relay , that is which satisfy @xmath163 .",
    "the main results on the computation rate are shortly summarized below .",
    "@xcite in the above setup , a computation rate region of @xmath164 is achievable .",
    "this expression is further maximized by choosing @xmath165 to be @xmath166 resulting in a computation rate region of @xmath167 moreover , the optimal coefficient vector is the solution to the minimization problem @xmath168 where @xmath169 .",
    "hence , @xmath170 corresponds to the coefficient vector of the shortest vector in the lattice whose gram matrix is @xmath171 .    solving for the optimal vector @xmath170 is in general a hard problem , but it has been shown recently that in certain instances it can be solved in polynomial time @xcite .    a low - complexity approach for the case @xmath172 assuming no cooperation between the relays has also been proposed in @xcite .",
    "in the original compute - and - forward framework , nested lattices have been proposed for encoding data . consider for each transmitter a nested code @xmath173 consisting of a fine lattice @xmath139 and a coarse lattice @xmath174 .",
    "let the fine lattices be such that , after possibly reordering the indices , we have @xmath175 .",
    "further , due to the symmetric power constraint , we fix the same coarse lattice @xmath176 for each of the transmitters .",
    "since the codebook is finite for each transmitter , the codewords can be assumed to be equiprobable in @xmath173 .    a relay attempts to decode @xmath177 to a lattice point @xmath178 = \\sum_{k=1}^k{a_k { \\mathbf{x}}_k}\\ ( \\bmod\\ \\lambda_c)$ ] in two steps :    * after scaling the received signal ( cf . ) , compute an equation coefficient vector @xmath179^t$ ] by solving the shortest vector problem , and decode ( cf . )",
    "an estimate @xmath180 of the lattice point @xmath181 * apply the modulo - lattice operation to shift the received signal back into the basic voronoi cell @xmath182 of @xmath176 , that is , compute @xmath183 = \\lambda\\ ( \\bmod\\ \\lambda_c ) .      \\end{aligned}\\ ] ]    the requirement @xmath184 guarantees that @xmath185 is a lattice .",
    "we are interested in the first step , that is , estimating @xmath186 , and will thus simply be interested in the role of the fine lattice in the decoding process .",
    "let @xmath187 be the lattice in .",
    "since the codewords satisfy the imposed norm constraint , the desired lattice point @xmath188 is contained in a finite subset @xmath189 determined by the norm - restriction of the original codewords as well as the coefficient vector @xmath190 .",
    "thus , @xmath191 ( indirectly ) depends on the @xmath143 . in this",
    "setting , ml decoding amounts to maximizing the conditional probability @xmath192 } \\\\      &",
    "= \\operatorname*{arg\\,max}\\limits_{\\lambda \\in l_f}{\\sum\\limits_{\\substack{({\\mathbf{x}}_1,\\ldots,{\\mathbf{x}}_k ) \\in ( { \\mathcal{c}}_1,\\ldots,{\\mathcal{c}}_k ) \\\\",
    "\\sum\\limits_{k=1}^k{a_k{\\mathbf{x}}_k } = \\lambda}}}{p\\left[\\alpha{\\mathbf{y}}\\mid({\\mathbf{x}}_1,\\ldots,{\\mathbf{x}}_k)\\right]p\\left[({\\mathbf{x}}_1,\\ldots,{\\mathbf{x}}_k)\\right ] } \\end{split}\\ ] ]    the former factor in the above expression behaves as @xmath193 \\propto \\exp\\left\\{-\\frac{1}{2\\sigma^2\\alpha^2}\\left|\\left|\\alpha{\\mathbf{y}}-\\sum\\limits_{k=1}^k{\\alpha h_k{\\mathbf{x}}_k}\\right|\\right|^2\\right\\}\\end{aligned}\\ ] ] and , since the codewords are equiprobable in @xmath194 , we conclude that the estimate @xmath180 of @xmath188 can be computed by solving @xmath195 where we have defined @xmath196      the goal of the rest of this article is to study the behavior of @xmath197 .",
    "as shown in @xcite , the function @xmath197 can be _ flat _ for certain parameters , that is is maximized for multiple values of @xmath188 , and this ambiguity can lead to decoding errors .",
    "we first need to express the function in terms of @xmath188 itself . to this end , will rewrite the codewords in terms of the desired lattice point @xmath188 .    for each transmitter @xmath198 ,",
    "let @xmath199 be the generator matrix of @xmath139 , so that we can write @xmath200 for some @xmath201 .",
    "define @xmath202 \\in \\operatorname{mat}(n\\times nk,{\\mathbb{r}})$ ] , where @xmath203^t$ ] is the solution to , and express the lattice point @xmath188 as @xmath204\\left[\\begin{smallmatrix } { \\mathbf{z}}_1^t & \\cdots & { \\mathbf{z}}_k^t\\end{smallmatrix}\\right]^t = m{\\mathbf{z}}.\\end{aligned}\\ ] ]    the next step is to decompose the matrix @xmath130 in the following way .",
    "assume there exists an orthogonal matrix @xmath205 such that we can write @xmath206 where @xmath207 is invertible .",
    "decompose the matrix @xmath208 into blocks @xmath209 and @xmath210 as follows @xmath211 and define @xmath212 , so that we can express the lattice point @xmath188 as @xmath213^t = b{\\mathbf{r}}_n , \\end{aligned}\\ ] ] where @xmath214 consists of the _ first _ @xmath18 components of @xmath215 .",
    "we have precisely @xmath216 , and write @xmath217    using the decomposition of @xmath208 in , we can write @xmath218 and thus express the components of @xmath219 as @xmath220 . consequently , we can rewrite the codewords @xmath221 in terms of @xmath188 as @xmath222    note that we have @xmath223 , where @xmath224 . depending on the decomposition used on @xmath130 in , the vector @xmath225 might not necessarily be an integer vector , thus neither is @xmath226 .",
    "write @xmath227 where @xmath228 is @xmath226 rounded component - wise to the nearest integer , and @xmath229^{n(k-1)}$ ] . for @xmath230 , explicitly given in terms of @xmath188 , we can thus write @xmath231 where @xmath232 is a point in a finite subset defined by the matrix @xmath233 .",
    "note that @xmath234 is a flat matrix , and due to its dimensions defines a sum of @xmath8 lattices , which is itself not a lattice for @xmath1 .",
    "we further have @xmath235 , and this allows us to write @xmath236    to further simplify the expression , define the matrix @xmath237 which acts as a generator matrix for the sum of @xmath8 lattices @xmath238 and write @xmath239    an estimate @xmath180 of @xmath188 at the relay can thus be computed by solving the maximization problem , which can be rewritten as @xmath240 where @xmath241 is finite , and more conveniently as @xmath242 where @xmath243 , and @xmath244 is a point in a finite subset @xmath245 of the sum of @xmath8 lattices @xmath238 , that is if we write @xmath246 , then @xmath247 where @xmath248 is a point in a finite subset of the lattice @xmath249 generated by @xmath250 .",
    "[ rmk : lattice_sum ] we need to point out that the authors in @xcite , probably because they are not aiming at analyzing the behavior of @xmath197 for actual resulting lattice sums @xmath238 , state that @xmath238 is a lattice for any number @xmath129 of transmitters .",
    "this misapprehension is understandable , as it is still the sum of @xmath8 lattices , thus a lattice for the case @xmath2 , which is the standard case to consider .",
    "it is , however , certainly not a lattice when @xmath1 .",
    "although it still is an additive subgroup of @xmath12 , it is no longer discrete , and an important consequence is that the function @xmath197 does not converge when summing over all of @xmath238 .",
    "the main problem is the effect of the random channel coefficients @xmath251 , which can not be controled and inhibit @xmath238 from exhibiting a lattice structure .",
    "this fact has dramatic consequences , since it implies that the tools developed in @xcite for analyzing the behavior of @xmath238 can only be applied in the basic case @xmath2 .",
    "hence , a modification is needed for @xmath1 , and we will later propose an alternative quantity for the purpose of analysis for the case @xmath3 .",
    "the previous manipulation assumed a decomposition of the matrix m in .",
    "for the subsequent analysis of the function @xmath197 we will specifically use the @xmath252-decomposition of @xmath130 , that is decompose the matrix as @xmath253 with @xmath254 of the form @xmath255 , where @xmath207 is lower triangular .",
    "it is well known that the matrix @xmath69 is unique if its diagonal is forced to be positive .",
    "we further choose @xmath256 and have thus found an unitary matrix such that @xmath257 , as desired .    in @xcite , the use of the _ hermite normal form _",
    "is proposed as the decomposition , since it is a classical tool for solving diophantine equations .",
    "the use of this specific decomposition , however , would only allow us to use integer lattices .",
    "this has obvious disadvantages , especially since this not only restricts the lattices that we can use , but even when using integer lattices we have only access to very restrictive rotations and scalings .",
    "also , normalizing an integer lattice to unit volume might result in a non - integer lattice ( _ e.g. _ @xmath112 ) , making a meaningful comparison between lattices impossible .    an advantage of using the hermite normal form , though , is that the matrix @xmath258 is unimodular , so that @xmath259 and , hence , @xmath260 for all @xmath261 .",
    "nonetheless , note that in order to be able to solve the problem , no additional knowledge about the codewords @xmath221 is required by the relay , as it only needs to compute the matrix @xmath208 and a coefficient vector @xmath190 .",
    "in the previous section and following the work in @xcite , the ml decoding metric was manipulated in such a way that it can be presented in terms of the desired lattice point .",
    "the obtained expression provides an explicit decoding problem at the relay , which attempts to decode an integer liner combination of the original codewords by maximizing the modified decoding metric . in this section",
    ", we analyze the behavior of the function @xmath262 which , as indicated in @xcite , can be flat for certain parameters leading to ambiguous decoding decisions and ultimately resulting in decoding errors . in the following ,",
    "we illustrate the behavior of @xmath197 in figure  [ fig : n1_flatness ] and [ fig : n2_flatness ] for dimensions @xmath263 , respectively .",
    "0.48   in dimension @xmath5 for @xmath2 transmitters.,title=\"fig:\",scaledwidth=90.0% ]    0.48   in dimension @xmath5 for @xmath2 transmitters.,title=\"fig:\",scaledwidth=90.0% ]    0.48   in dimension @xmath106 for @xmath2 transmitters.,title=\"fig:\",scaledwidth=90.0% ]    0.48   in dimension @xmath106 for @xmath2 transmitters.,title=\"fig:\",scaledwidth=90.0% ]    for the ease of analysis , we start by making two simplifications .    * for attempting to decode to an estimate @xmath180",
    ", a relay is able compute the pairs @xmath264 over which to take the sum .",
    "these pairs correspond to all vectors of the form @xmath265 , where @xmath266 .",
    "the perturbations @xmath267 complicate any analysis of the function @xmath197 , so that we are forced to slightly simplify the expression .",
    "+ for the subsequent analysis of the function @xmath197 , we can estimate @xmath197 by disregarding these tiny perturbations and set @xmath260 for all @xmath268 , without altering the behavior of @xmath197 , as affirmed in figure  [ fig : epsandzero ] .",
    "+   for @xmath260 versus @xmath269.,scaledwidth=60.0% ] * since the points @xmath244 involved in the sum are the result of rounding @xmath270 pointwise to the nearest integer , by setting @xmath260 we end up summing repeatedly over the same set @xmath245 . + for our analysis , we restrict to a sum over distinct points in @xmath245 , as multiple summations over @xmath245 only affects the magnitude of @xmath197 , not its behavior ( see figure  [ fig : n12_eps ] ) .    in summary",
    ", we can analyze the behavior of the function @xmath197 by considering an approximation @xmath271    0.45   when summing multiple times over points in @xmath238 ( left ) and summing only over unique points ( right).,title=\"fig : \" ]    0.45   when summing multiple times over points in @xmath238 ( left ) and summing only over unique points ( right).,title=\"fig : \" ]    as previously mentioned , we notice that @xmath238 is a sum of @xmath8 lattices , hence itself a lattice for @xmath2 . as soon as @xmath1 ,",
    "however , while @xmath238 is still an additive subgroup of @xmath12 , it lacks a discrete structure and thus is not a lattice .",
    "an example of @xmath238 for @xmath106 and @xmath3 is depicted in figure  [ fig : lattice_sum ] .",
    "0.45   lattices @xmath238 in dimension @xmath106 .",
    "the depicted points correspond to coefficient vectors @xmath272 ^ 4 $ ] , and the density increases rapidly .",
    "the above are only two examples ; the same lattices at the transmitters can yield very differently looking lattice sums for varying parameters.,title=\"fig : \" ]    0.45   lattices @xmath238 in dimension @xmath106 .",
    "the depicted points correspond to coefficient vectors @xmath272 ^ 4 $ ] , and the density increases rapidly .",
    "the above are only two examples ; the same lattices at the transmitters can yield very differently looking lattice sums for varying parameters.,title=\"fig : \" ]    in the following , we will differentiate the cases @xmath2 and @xmath1 due to the above remark .",
    "if the intermediate relay aims to decode a linear combination of @xmath2 codewords , the ml decoding metric is a sum over lattice points , as remarked above .    in order to characterize the flatness behavior of the function @xmath197 , we first define the _ flatness factor _ of a general lattice @xmath11 .",
    "@xcite [ def : ff_lattice ] let @xmath11 be a full lattice of dimension @xmath18 , and for @xmath274 define the function @xmath275 the _ flatness factor _ of the lattice @xmath11 is defined as the ratio @xmath276}{\\max\\limits_{{\\mathbf{y } } \\in { \\mathbb{r}}^n}{\\phi_{\\lambda}({\\mathbf{y } } ) } } ,      \\end{aligned}\\ ] ] where the expected value of @xmath277 is defined as @xmath278 : = \\frac{1}{\\nu_\\lambda}\\int_{{\\mathcal{v}}(\\lambda)}{\\phi_{\\lambda}({\\mathbf{y } } ) d{\\mathbf{y}}}.      \\end{aligned}\\ ] ]    the expected value @xmath279 $ ] as defined above exists for lattice - periodic functions , such as @xmath280 . that the maximum also exists follows from the continuity of @xmath280 , so that the definition of the flatness factor as above is justified .",
    "we illustrate the flatness factor of a lattice with the help of an example . for our analysis later on , and in order to achieve a meaningful comparison , the lattices at the transmitters will be normalized to unit volume .",
    "the meaningfulness of such normalization is illustrated in figure  [ fig : ff_scaled ] .     and",
    "although the lattice @xmath112 seems to behave better , after normalization to unit volume it loses against @xmath281.,scaledwidth=75.0% ]    since @xmath238 is a lattice in this particular case , we can define a function characterizing the flatness behavior of @xmath273 by considering all of @xmath238 as follows :    [ def : ff_ml ] the _ flatness factor _ of @xmath273 ( cf . ) for @xmath2 is defined as @xmath282    [ rmk : limit_ff ] the restriction @xmath2 is crucial , since then @xmath238 is a lattice , and both the expected value and maximum on the right hand side of exist .",
    "[ prop : flatness_factor ] let @xmath283 .",
    "then , the flatness factor @xmath284 characterizing the function @xmath273 can be expressed as @xmath285 where @xmath286 is the theta series of the lattice @xmath238 .",
    "we begin by computing @xmath287 $ ] along the lines of @xcite . for @xmath288 the fundamental voronoi cell of @xmath238",
    ", we have @xmath289 & = \\frac{1}{\\nu_{\\mathcal{l}}}\\int_{{\\mathcal{v}}({\\mathcal{l}})}{\\sum\\limits_{{\\mathbf{q}}\\in{\\mathcal{l}}}{\\exp\\left\\{-\\frac{1}{2\\sigma^2}\\left|\\left|\\omega(\\lambda)-{\\mathbf{q}}\\right|\\right|^2\\right\\ } } d\\omega(\\lambda ) } \\\\          & = \\frac{(\\sqrt{2\\pi}\\sigma)^n}{\\nu_{{\\mathcal{l}}}}\\sum\\limits_{{\\mathbf{q } } \\in { \\mathcal{l}}}{\\int_{{\\mathcal{v}}({\\mathcal{l}})}{\\frac{1}{(\\sqrt{2\\pi}\\sigma)^n}\\exp\\left\\{-\\frac{1}{2\\sigma^2}\\left|\\left|\\omega(\\lambda ) - { \\mathbf{q } } \\right|\\right|^2\\right\\}d\\omega(\\lambda ) } } \\\\          & = \\frac{(\\sqrt{2\\pi}\\sigma)^n}{\\nu_{{\\mathcal{l}}}}\\sum\\limits_{{\\mathbf{q } } \\in { \\mathcal{l}}}{\\int_{{\\mathcal{v}}({\\mathcal{l } } ) + { \\mathbf{q}}}{\\frac{1}{(\\sqrt{2\\pi}\\sigma)^n}\\exp\\left\\{-\\frac{1}{2\\sigma^2}\\left|\\left|{\\mathbf{t } } \\right|\\right|^2\\right\\}d{\\mathbf{t } } } } \\\\          & = \\frac{(\\sqrt{2\\pi}\\sigma)^n}{\\nu_{{\\mathcal{l}}}}\\int_{{\\mathbb{r}}^n}{\\frac{1}{(\\sqrt{2\\pi}\\sigma)^n } \\exp\\left\\{-\\frac{1}{2\\sigma^2}\\left|\\left|{\\mathbf{t } } \\right|\\right|^2\\right\\}d{\\mathbf{t}}}.      \\end{aligned}\\ ] ]    since the integrand is a probability density function , and by defining @xmath290 , we conclude @xmath291 = \\frac{1}{\\nu_{{\\mathcal{l}}}\\tau^{\\frac{n}{2}}}.      \\end{aligned}\\ ] ]    next , for @xmath292 , a lattice @xmath293 , and @xmath294 , define the functions @xmath295    let @xmath296 denote the dual lattice of @xmath238 . using lemma  [ lem : poisson ] and , write @xmath297    note that @xmath298 , so that @xmath299 and consequently @xmath300 the last inequality holds since @xmath301 and @xmath302 .",
    "we conclude that @xmath303 which completes the proof .",
    "the description of @xmath304 in proposition  [ prop : flatness_factor ] allows to study the flatness factor as a function of the noise variance @xmath145 , and hence of the @xmath143 .",
    "further , note that @xmath305 ( cf . , and we want to be as close to 0 as possible , as by the definition of @xmath306 smaller values imply a distinctive maximum , which inhibits a flat behavior .    in the following , we will consider various lattices in dimensions @xmath106 and @xmath111 , all of which have been introduced in section  [ sec : lattices ] .",
    "the flatness factors of the considered lattices are depicted in figure  [ fig : ff_lattices ] . by proposition  [ prop :",
    "flatness_factor ] , the flatness factor depends on the volume and the theta series of the lattice , which itself depends indirectly on the volume . hence , to achieve a meaningful comparison , we normalize the considered lattices to have unit volume .    0.48 .,title=\"fig : \" ]    0.48 .,title=\"fig : \" ]    in order to verify the correct prediction of @xmath307 for the lattices depicted in figure  [ fig : ff_lattices ] , we computed this quantity in addition by calculating the corresponding theta series as a truncated sum over the lattice points .    for the numerical results displayed in figure  [ fig : ff_lattices_avg ] ,",
    "however , the approximation derived in proposition  [ prop : theta_approx ] was used for reduced complexity .",
    "our goal is to analyze the flatness of the function @xmath273 which , as we have seen , corresponds to studying the flatness factor of the lattice @xmath238 .",
    "the generator matrix @xmath308 depends on the channel , and clearly the theta series of @xmath238 is not known in closed form . here is where the approximation of @xmath309 derived in proposition  [ prop : theta_approx ] proves useful .    for the following results , we let @xmath2 transmitters employ the same lattice @xmath11 , which is normalized to unit volume .",
    "we fix a finite subset of @xmath11 to serve as the codebook by choosing a set of coefficient vectors @xmath310 to generate the codewords . with this convention ,",
    "the size of the codebooks is the same for each of the employed lattices , and the corresponding power constraints are presented in table  [ tab : power ] below .    .power constraint for the employed finite codebook for the considered lattices in dimension @xmath106 and @xmath111 .",
    "the size of the codebooks is the same for each of the lattices . [",
    "cols=\"<,^,^,^,^,^\",options=\"header \" , ]     [ rmk : power ] for fair comparison , since the flatness factor depends on the volume of the lattice , we normalized the volume of the considered lattices to one .",
    "it is hence not possible to simultaneously normalize the power .",
    "instead , we fix a set of coefficient vectors @xmath310 which generate all possible codewords , so that the resulting codebooks are of the same size for each of the lattices , and use the lattice - dependent power constraints computed in table  [ tab : power ] .",
    "the quantity in which we are interested is the _ expected flatness factor _ @xmath311 $ ] , which we estimate over @xmath312 random channels for varying @xmath313 .",
    "note that @xmath65 depends on the power @xmath314 , so that by the unequal power for different lattices , the same value @xmath65 corresponds to slightly different values of @xmath315 .",
    "thus , for a readable plot , we account for this shift by plotting the results with respect to the actual @xmath143 .",
    "0.48   for lattices of dimensions @xmath106 ( left ) and @xmath111 ( right).,title=\"fig : \" ]    0.48   for lattices of dimensions @xmath106 ( left ) and @xmath111 ( right).,title=\"fig : \" ]    the results depicted in figure  [ fig : ff_lattices_avg ] suggest that , independently of the dimension , decoding errors due to ambiguous decisions can be reduced by allowing the transmitters to use for instance algebraic lattices .",
    "the algebraic lattices considered in dimension @xmath106 are very comparable in shape , and consequently perform very similarly ; however they all yield better results than the lattices @xmath316 and @xmath107 .",
    "the results in dimension @xmath111 are of a similar nature .",
    "the lattices arising from biquadratic number fields outperform the classical lattices @xmath112 and @xmath317 , and only @xmath281 exhibits similar performance .",
    "overall , the numerical results clearly show that it is beneficial to allow real , in particular algebraic lattices at the transmitters , instead of restricting to integer lattices .",
    "given the small difference in performance between the algebraic lattices , it is difficult to propose an optimal candidate .",
    "hence , for the purpose of code design , the above results should not be considered alone , but rather as a support criterion together with further design criteria that will arise by analyzing the probability of incorrect decoding in the context of compute - and - forward relaying .",
    "note , however , that the usual criteria do not seem to be relevant for the expected flatness factor of the resulting object @xmath238 .",
    "the best sphere packing , @xmath107 , as well as the densest lattice @xmath318 are not the best performing lattices .",
    "also other standard quantities , such as the discriminant , do not seem to be the determining factor in the observed hierarchy .",
    "nonetheless , multiple randomly generated lattices were tested , all of which performed significantly worse than the lattices depicted above .",
    "it is clear that , although not straightforward to see , there is a structural reason behind the order shown in the plots .",
    "as we have mentioned previously , @xmath238 is no longer a lattice if @xmath1 .",
    "while it is still an additive subgroup of @xmath12 , it does not exhibit a discrete structure .",
    "thus , the function @xmath273 can not be extended to a sum over all of @xmath238 as in the case @xmath2 , since it would not converge .",
    "this also implies that we can not define @xmath319 similar to definition  [ def : ff_ml ] , as the maximum on the right hand side of does not exist .",
    "we fix @xmath3 , so that @xmath238 is a sum of @xmath320 lattices , @xmath321 . due to the above observation",
    ", we can only consider the function @xmath273 by fixing a finite subset @xmath322 and @xmath323 .",
    "even with this restriction , @xmath324 is often attained for @xmath325 , as shown exemplarily in figure  [ fig : lattice_sum_max ] .     of the function @xmath326 for @xmath3 transmitters .",
    "the maxima of the function are attained outside the points in @xmath327.,scaledwidth=60.0% ]    this fact makes the analysis difficult .",
    "even if we could compute the maximum , there is no straightforward way of determining @xmath328 $ ] , since @xmath238 is dense in @xmath12 .",
    "this motivates the definition of the _ average flatness factor _ of a sum of lattices , and consequently of @xmath273 , for the case @xmath1 .",
    "the flatness factor of a lattice measures how the maximum of the considered function @xmath277 deviates from the norm .",
    "since @xmath11 is a lattice , we can measure this deviation centered at the origin . for @xmath3 transmitters and",
    "@xmath329 a sum of two lattices , we need to deal with two lattices simultaneously .",
    "considering one lattice , say @xmath330 , we can interpret @xmath331 as points which shift the fixed lattice around .",
    "to account for these shifts , we propose to consider the _",
    "average flatness factor _ , that is , to measure the ratio for one of the lattices @xmath332 centered at a finite number of points of the second lattice , and symmetrically swap the roles of the first and second lattice .",
    "a more formal definition is given below .",
    "[ def : ff_lattice_sum ] let @xmath333 be a sum of two lattices , and consider finite subsets @xmath334 and @xmath335 such that @xmath336 . for @xmath337 , @xmath338 , define the function @xmath339 where @xmath340 .",
    "the _ average flatness factor _ of the lattice sum @xmath333 is defined as @xmath341}{\\max\\limits_{{\\mathbf{y } } \\in { \\mathbb{r}}^n}{\\phi_{\\lambda_1}({\\mathbf{y}},{\\mathbf{x } } ) } } } + \\sum\\limits_{{\\mathbf{x } } \\in \\overline{\\lambda}_1}{\\frac{e_{{\\mathbf{y}}}\\left[\\phi_{\\lambda_2}({\\mathbf{y}},{\\mathbf{x}})\\right]}{\\max\\limits_{{\\mathbf{y } } \\in { \\mathbb{r}}^n}{\\phi_{\\lambda_2}({\\mathbf{y}},{\\mathbf{x}})}}}\\right).\\end{aligned}\\ ] ]    [ prop : ff_lattice_sum ] let @xmath321 be the sum of two lattices generated by the matrix @xmath308 , and fix finite subsets @xmath342 and @xmath343 such that @xmath344 .",
    "define @xmath283 .",
    "then , the average flatness factor @xmath284 characterizing the function @xmath273 can be expressed as @xmath345    the proof is very similar to that of proposition  [ prop : flatness_factor ] . for @xmath346 , @xmath347 , and @xmath340",
    ", we have @xmath348 & = \\frac{(\\sqrt{2\\pi}\\sigma)^n}{\\nu_{{\\mathcal{l}}_i}}\\sum\\limits_{{\\mathbf{q } } \\in { \\mathcal{l}}_i}\\int_{{\\mathcal{v}}({\\mathcal{l}}_i)}{\\frac{1}{(\\sqrt{2\\pi}\\sigma)^n}\\exp\\left\\{-\\frac{1}{2\\sigma^2}\\left|\\left|(\\omega(\\lambda)-\\tilde{{\\mathbf{x}}})-{\\mathbf{q}}\\right|\\right|^2\\right\\ } d\\omega(\\lambda ) } \\\\          & = \\frac{(\\sqrt{2\\pi}\\sigma)^n}{\\nu_{{\\mathcal{l}}_i}}\\sum\\limits_{{\\mathbf{q } } \\in { \\mathcal{l}}_i}\\int_{{\\mathcal{v}}({\\mathcal{l}}_i)+({\\mathbf{q}}+\\tilde{{\\mathbf{x}}})}{\\frac{1}{(\\sqrt{2\\pi}\\sigma)^n}\\exp\\left\\{-\\frac{1}{2\\sigma^2}\\left|\\left|{\\mathbf{t}}\\right|\\right|^2\\right\\}d{\\mathbf{t } } } \\\\          & = \\frac{(\\sqrt{2\\pi}\\sigma)^n}{\\nu_{{\\mathcal{l}}_i}}\\sum\\limits_{{\\mathbf{q } } \\in { \\mathcal{l}}_i}\\int_{{\\mathbb{r}}^n}{\\frac{1}{(\\sqrt{2\\pi}\\sigma)^n}\\exp\\left\\{-\\frac{1}{2\\sigma^2}\\left|\\left|{\\mathbf{t}}\\right|\\right|^2\\right\\}d{\\mathbf{t } } } \\\\          & = \\frac{1}{\\nu_{{\\mathcal{l}}_i}\\tau^{\\frac{n}{2}}}.      \\end{aligned}\\ ] ]    from the proof of proposition  [ prop : flatness_factor ] , we know that @xmath349 is attained for @xmath350 , that is , @xmath351 .",
    "hence , @xmath352    note that @xmath353}{\\max\\limits_{\\omega(\\lambda ) \\in { \\mathbb{r}}^n}{\\psi_{{\\mathcal{l}}_i}(\\omega(\\lambda),{\\mathbf{x } } ) } } } & = \\sum\\limits_{{\\mathbf{x } } \\in { \\mathcal{l}}_j}{\\frac{1}{\\nu_{{\\mathcal{l}}_i}\\tau^{\\frac{n}{2}}\\theta_{{\\mathcal{l}}_i}\\left(e^{-\\pi\\tau}\\right ) } } \\\\          & = c\\varepsilon_{{\\mathcal{l}}_i}(\\tau ) ,      \\end{aligned}\\ ] ] and hence the result follows .",
    "we conclude by illustrating , in analogy to the results obtained in the case @xmath354 , the expected average flatness factor of @xmath273 in figure  [ fig : k3_ff_n2_avg ] for various lattices at the transmitters .",
    "the encoding lattices are normalized to have unit volume , and the same power constraints from table  [ tab : power ] are also used for this analysis . as in the previous case for @xmath2 , by fixing the set of coefficient vectors",
    "@xmath310 we obtain codebooks of the same size for each of the considered lattices .",
    "the different power constraints , however , results in a different @xmath143 for equal values of @xmath65 ( cf .",
    "remark  [ rmk : power ] ) .",
    "hence , we illustrate the results with respect to the actual @xmath143 .     for @xmath3 transmitters employing various lattices of dimension @xmath106.,scaledwidth=60.0% ]    as in the previous case where @xmath2 , the algebraic lattices still outperform the other lattices , and in contrast to the case @xmath2 , the gap between them has widened slightly .",
    "their performance is however still very similar .",
    "the results suggest that the number of transmitters , although inhibiting @xmath238 from exhibiting a lattice structure , does not affect the hierarchy of the lattices in terms of flatness behavior .",
    "in this article , the maximum - likelihood framework in the context of compute - and - forward relaying , derived in @xcite for integer lattices , was extended to allow for any real lattice at the transmitters .",
    "the resulting decoding metric was further analyzed for the first time for the actual resulting lattice sums @xmath238 over which a sum of gaussian measures needs to be performed at a relay . to enable such analysis ,",
    "an approximation of the theta series of a lattice was derived , which can be computed given merely the generator matrix of the lattice .",
    "it was further noted that a straightforward extension of the analysis to @xmath1 transmitters is not possible , and an alternative quantity to consider was defined for the case @xmath3 and employed for an analysis of the decoding metric in this case .",
    "the flatness criterion in code design for compute - and - forward should , however , not be considered alone , but rather as a supportive criterion .",
    "it is hence important and immediate future work to analyze the probability of incorrect decoding at the relay , an expression from which it will be possible to derive explicit code design criteria . equally important",
    "is the derivation of efficient decoding algorithms to solve the maximization problem , which maximum - likelihood decoding in this setting amounts to , a problem that has only been solved in the smallest case @xmath5 , but remaining open for @xmath355 .",
    "n.  e.  tunali , k.  r.  narayanan , j.  j.  boutros and yu - chih huang , `` lattices over eisenstein integers for compute - and - forward '' , _",
    "50th annual allerton conference on communication , control , and computing _ , 2012 ."
  ],
  "abstract_text": [
    "<S> in a distributed communications scenario , a relay applying the compute - and - forward strategy for the real - valued channel model aims to decode an integer linear combination of transmitted messages , a task of very complex nature for which general efficient algorithms for dimension @xmath0 have not yet been developed . nonetheless , the maximum - likelihood decoding metric related to solving for the desired lattice point exhibits interesting properties which lead to partial design criteria for lattice codes in compute - and - forward .    </S>",
    "<S> this article generalizes maximum - likelihood decoding at the relay to allow for arbitrary real lattice codes at the transmitters , and studies the behavior of the resulting decoding metric using an approximation of the theta series of a lattice , which is itself derived in this article . for the first time , the resulting random sums of lattices over whose points the relay needs to perform a sum are analyzed and furthermore , previous related work is extended to the case of @xmath1 transmitters . </S>",
    "<S> the specific cases @xmath2 and @xmath3 are studied empirically .    </S>",
    "<S> physical layer network coding , compute - and - forward , relaying , lattice , theta series , maximum likelihood decoding . </S>"
  ]
}