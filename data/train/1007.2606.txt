{
  "article_text": [
    "the ideal magnetohydrodynamic ( mhd ) equations are a common model for the macroscopic behavior of collisionless plasma @xcite .",
    "these equations model the fluid dynamics of an interacting mixture of positively and negatively charged particles , where each species is assumed to behave as a charged ideal gas . under the mhd assumption , this mixture is taken to be quasi - neutral , meaning that as one species moves , the other reacts instantaneously .",
    "this assumption allows one to collapse what should be two sets of evolution equation into a single set of equations for the total mass , momentum , and energy of the mixture .",
    "furthermore , the resulting dynamics are assumed to happen on slow time scales compared to the propagation time of light waves , which yields a simplified set of maxwell equations .",
    "finally , the term _ ideal _ refers to the fact that we assume the ideal ohm s law : @xmath0 , which removes any explicit resistivity and the hall term is the electric field , @xmath1 is the magnetic field , and @xmath2 is the macroscopic velocity of the plasma fluid . ] .",
    "all of the above described simplifications conspire to turn the original two - fluid plasma model into a system that can be viewed as a modified version of the compressible euler equations from gas dynamics .",
    "in particular , the ideal mhd system can be written as a system of hyperbolic conservation laws , where the conserved quantities are mass , momentum , energy , and magnetic field .",
    "furthermore , this system is equipped , just as the compressible euler equations are , with an entropy inequality that features a convex scalar entropy and a corresponding entropy flux .",
    "indeed , the scalar entropy , with some help from the fact that the magnetic field is divergence - free , can be used to define entropy variables in which the mhd system is in symmetric hyperbolic form @xcite .",
    "as has been noted many times in the literature ( e.g. , brackbill and barnes @xcite , evans and hawley @xcite , and tth @xcite ) , numerical methods for ideal mhd must in general satisfy ( or at least control ) some discrete version of the divergence - free condition on the magnetic field : @xmath3 failure to accomplish this generically leads to a nonlinear numerical instability , which often leads to negative pressures and/or densities . starting with the paper of brackbill and barnes @xcite in 1980 , several approaches for controlling errors in @xmath4 have been proposed .",
    "an in - depth review of many of these methods can be found in tth @xcite .",
    "we very briefly summarize the main points below .",
    "* projection methods . * : :    projection methods for ideal mhd are based on a predictor - corrector    approach for the magnetic field . some standard finite volume or finite    difference method",
    "is used to solve the ideal mhd equations from time    @xmath5 to @xmath6 .",
    "the approximate magnetic    field that is predicted at time @xmath6 is denoted by    @xmath7 . in general",
    ", @xmath7    contains both a nontrivial divergence - free subspace and a divergent    subspace ; one would like to extract only the divergence - free part and    discard the divergent part .",
    "this can be accomplished by setting    [ eqn : project_new ] ^n+1 : = ^ - , and forcing    @xmath8 , which results in a poisson    equation for the scalar potential @xmath9 : ^2 = ^. once    @xmath9 is computed , the divergence - free magnetic field at    time @xmath6 is taken to be ( see tth @xcite and    balsara and kim @xcite for further discussion ) .    +    this method is attractive for it allows a variety of methods to be    used in the prediction step , and then only requires one poisson solve    per time - step to correct it .",
    "the clear disadvantage of this approach    is that it requires a global elliptic solve on a problem , ideal mhd ,    that is purely hyperbolic",
    ". this could be especially computationally    inefficient in the case of adaptively refined grids . * the 8-wave formulation . * : :    the linearized ideal mhd equations support seven propagating    plane - wave solutionsn , two    slow magnetosonic , and an entropy wave . ] and a stationary plane - wave    solution .",
    "the    stationary plane - wave solution comes directly from the fact that the    ( nonlinear ) mhd equations preserve the divergence constraint :    @xmath10 where    @xmath11 denotes the partial derivative with respect to time .",
    "a seemingly unrelated fact was proved by godunov @xcite : the ideal    mhd can only be put in symmetric hyperbolic form if one adds to the    ideal mhd equations a term that is proportional to    @xmath4 ( in effect adding a term that , at least    on the continuous level , is zero ) . as it turns out , this additional    `` source term '' not only allows the equations to be put in symmetric    hyperbolic form , but it also restores galilean invariance . with the    additional term",
    "the divergence wave is no longer stationary , and    instead , it propagates with the fluid velocity :    @xmath12    from the point of view of numerical methods , the difference between a    stationary and a propagating divergence wave turns out to be very    significant .",
    "powell @xcite and powell et al .",
    "@xcite showed that    numerical methods applied to the mhd equations with the symmetrizing    `` source term '' were much more stable than the same methods applied to    the original mhd equations .",
    "the modified form of the mhd equations has    come be called the _",
    "8-wave formulation _ , since this form of the    equations supports eight propagating plane wave solutions .",
    "although    this approach has been used with some success ( see powell et al .",
    "@xcite ) , it does have a significant drawback : the 8-wave formulation    is non - conservative and difficulties with obtaining the correct weak    solution have been documented in the literature ( see for example tth    @xcite ) .",
    "* hyperbolic divergence cleaning methods . * : :    this method was introduced by dedner et al .",
    "@xcite , and is a close    cousin to the above described projection method .",
    "the basic idea is to    again solve for the divergence error in the magnetic field . instead of    solving an elliptic equation , however ,",
    "a damped hyperbolic equation is    prescribed for the divergence error .",
    "this does not produce an exact    divergence - free magnetic field ; however , it allows for the divergence    error to be propagated and damped away from where it originated .",
    "the    main advantage of this method is that it is easy to implement and    requires no elliptic solve .",
    "the main disadvantage is that this    approach has two tunable parameters : the speed of propagation of the    error and the rate at which the divergence error is damped . * constrained transport methods . *",
    ": :    the constrained transport ( ct ) approach for ideal mhd was introduced    by evans and hawley @xcite .",
    "the method is a modification of yee s    method @xcite for electromagnetic wave propagation , and , at least in    its original formulation , introduced staggered magnetic and electric    fields . since the introduction of the ct framework ,",
    "several variants    and modifications have been introduced , including the work of balsara    @xcite , balsara and spicer @xcite , dai and woodward @xcite , fey and    torrilhon @xcite , londrillo and del zanna @xcite , rossmanith    @xcite , ryu et al .",
    "@xcite , and de sterck @xcite .",
    "an overview of    many of these approaches , as well as the introduction of a few more    variants , can be found in tth @xcite . in particular",
    ", tth @xcite    showed that a staggered magnetic field is not necessary .",
    "+    the ct framework , at least several versions of it , can also be viewed    as a kind of predictor - corrector approach for the magnetic field .    roughly speaking",
    ", the idea is to again compute all of the conserved    quantities with a standard finite volume method . from these computed    quantities",
    "one then constructs an approximation to the electric field    through the ideal ohm s law .",
    "this electric field can then be used to    update the magnetic vector potential , which in turn , can be used to    compute a divergence - free magnetic field ( see  [ sec : framework ] for    more details ) .",
    "+    the main advantages of this approach are that ( 1 ) there is no elliptic    solve and ( 2 ) there are no free parameters to choose such as in the    hyperbolic divergence - cleaning technique .",
    "we focus in this work on developing a constrained transport method for the 3d ideal mhd equations based on the high - resolution _ wave propagation scheme _ of leveque @xcite and its 3d extension developed by langseth and leveque @xcite .",
    "our proposed scheme is the 3d extension of the 2d constrained transport scheme developed by rossmanith @xcite .",
    "the wave propagation scheme is an unsplit finite volume method that achieves second - order accuracy and optimal stability in higher - dimensions through the use of so - called _ transverse _ riemann solvers .",
    "these transverse riemann solvers are based partly on the work of colella @xcite on _ corner transport upwind _ ( ctu ) methods .",
    "it is worth noting that there has been recent work on ctu methods in the context of mhd by gardiner and stone @xcite and mignone and tzeferacos @xcite .",
    "gardiner and stone @xcite developed a constrained transport approach , while mignone and tzeferacos @xcite considered the hyperbolic divergence cleaning method of @xcite in the context of the ctu scheme .",
    "the method we propose in this work is therefore in the same class of methods as that of gardiner and stone @xcite ( i.e. , unsplit finite volume methods with constrained transport ) , and to a lesser extent mignone and tzeferacos @xcite ( i.e. , unsplit methods for mhd ) , although the details of our base scheme and especially the details of how the magnetic field is updated differ greatly from these approaches .",
    "in particular , the approach for updating the magnetic field that we propose in this work is based on a generalization of the 2d constrained transport scheme of @xcite , which is equipped with all of the following features :    1 .",
    "all quantities , including all components of the magnetic field and magnetic potential , are treated as cell - centered ; 2 .",
    "the magnetic potential is evolved alongside the eight conserved mhd variables via a modified non - conservative high - resolution wave propagation scheme ; and 3 .",
    "special limiters are applied in the evolution of the magnetic potential , which control unphysical oscillations in the magnetic field .",
    "the scheme developed in this work extends all three of the above features to the 3d case .",
    "the new challenge that arises in 3d is that the magnetic potential is a vector potential ( instead of a scalar as in the 2d case ) .",
    "furthermore , this vector potential obeys , at least under gauge condition we advocate in this work , a non - conservative _ weakly hyperbolic _ evolution equation .",
    "we are thus faced with two important challenges :    1 .   developing a wave propagation scheme for this non - conservative weakly hyperbolic evolution equation ; and 2 .",
    "constructing appropriate limiters that again have the effect of limiting the magnetic potential in such a way as to produce a non - oscillatory magnetic field .",
    "after briefly reviewing the mhd equations in  [ sec : equations ] , we describe an overview of our proposed method in  [ sec : framework ] .",
    "one important issue that arises from this approach is the gauge choice ; we discuss several possible choices in  [ sec : vecpotential ] . under the gauge condition that we choose , the 3d transport equation that must be solved for the magnetic potential",
    "is only weakly hyperbolic .",
    "we describe in detail in  [ sec : numerics ] how to numerically handle this difficulty .",
    "the resulting scheme is applied to several numerical test cases in  [ sec : numex ] .",
    "the ideal magnetohydrodynamic ( mhd ) equations are a classical model from plasma physics that describe the macroscopic evolution of a quasi - neutral two - fluid plasma system . under the quasi - neutral assumption ,",
    "the two - fluid equations can be collapsed into a single set of fluid equations for the total mass , momentum , and energy of the system .",
    "the resulting equations can be written in the following form ) , and @xmath13 to denote the euclidean norm of vector in the physical space .",
    "vectors in solution space , such as @xmath14 , where @xmath15 is the vector of conserved variables for the ideal mhd equations : @xmath16 , are not denoted using boldface letters . ] : @xmath17 where @xmath18 , @xmath19 , and @xmath20 are the total mass , momentum , and energy densities of the plasma system , and @xmath1 is the magnetic field . the thermal pressure , @xmath21 , is related to the conserved quantities through the ideal gas law : @xmath22 where @xmath23 is the ideal gas constant .",
    "the equation for the magnetic field comes from faraday s law : @xmath24 where the electric field , @xmath25 , is approximated by ohm s law for a perfect conductor : @xmath26 note that we have used in the above expression a comma followed by a subscript as short - hand notation for partial differentiation .",
    "this notation is standard in many areas of mathematics , most notably in relativity theory ( e.g. , @xcite ) .",
    "we will continue to use this notation throughout this paper .    under the ohm s law assumption",
    ", we can rewrite faraday s law in the following divergence form : @xmath27 since the electric field is determined entirely from ohm s law , we do not require an evolution equation for it ; and thus , the only other piece that we need from maxwell s equations is the divergence - free condition on the magnetic field . a complete derivation and discussion of mhd system -",
    "can be found in several standard plasma physics textbooks ( e.g. , @xcite ) .",
    "we first note that system , along with the equation of state , provides a full set of equations for the time evolution of all eight state variables : @xmath29 .",
    "these evolution equations form a hyperbolic system .",
    "in particular , the eigenvalues of the flux jacobian in some arbitrary direction @xmath30 ( @xmath31 ) can be written as follows : @xmath32 where @xmath33 \\right\\}^{1/2 } , \\\\    c_s & \\equiv \\left\\ { \\frac{1}{2 } \\left [ a^2 +        \\frac{\\|\\b\\|^{2}}{\\rho } - \\sqrt{\\left(a^2 +        \\frac{\\|\\b\\|^{2}}{\\rho } \\right)^{2 } - 4 a^2        \\frac{\\left(\\b \\cdot \\n \\right)^2}{\\rho } } \\right ] \\right\\}^{1/2 } \\ , .\\end{aligned}\\ ] ] the eigenvalues are well - ordered in the sense that @xmath34 the fast and slow magnetosonic waves are genuinely nonlinear , while the remaining waves are linearly degenerate .",
    "note that the so - called _ divergence - wave _ has been made to travel at the speed @xmath35 via the 8-wave formulation described in ",
    "[ sec : intro ] , thus restoring galilean invariance @xcite .",
    "note that despite the fact that we use the eigenvalues and eigenvectors of the 8-wave formulation of the mhd equations , we will still solve the mhd equations in conservative form ( i.e. , without the godunov - powell `` source term '' ) .",
    "the additional equation is not needed in the time evolution of the conserved variables in the following sense :    _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ if is true at some time @xmath36 , then evolution equation guarantees that is true for all time . _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _    this result follows from taking the divergence of faraday s law , which yields : @xmath37 for this reason , should not be regarded as _ constraint _",
    "( such as the @xmath38 constraint for the incompressible navier - stokes equations ) , but rather an _ involution _ @xcite .",
    "although @xmath28 is an involution , and therefore has no dynamic impact on the evolution of the exact mhd system , the story is more complicated for numerical discretizations of ideal mhd .",
    "brackbill and barnes @xcite gave a physical explanation as to why @xmath28 should be satisfied in some appropriate discrete sense :    _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ if @xmath40 , then the magnetic force , = \\ { - ^2 i } , in the direction of the magnetic field , will not in general vanish : = ^2 ( ) 0 .",
    "if this spurious forcing becomes too large , it can lead to numerical instabilities ( see for example @xcite ) . _",
    "_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _    tth @xcite analyzed the magnetic force for central finite difference methods and develop an approach with the property that @xmath41 on the discrete level .",
    "this analysis makes it clear that simply having @xmath28 on the discrete level is not sufficient to guarantee that @xmath41 is satisfied .",
    "londrillo and del zanna @xcite came to the same conclusion and proposed a modified approach for computing numerical fluxes .",
    "however , in @xcite it is argued that by satisfying an appropriate discrete form of @xmath39 the error in @xmath42 is sufficiently controlled ; and therefore , the additional modifications that are proposed in @xcite and @xcite are not found to be necessary .",
    "we omit the details here ; and instead , refer the reader to @xcite .",
    "another explanation as to why @xmath39 should not be ignored in numerical discretizations of mhd from a slightly different point - of - view , was offered by barth @xcite .",
    "barth s explanation is based on the well - known result of godunov @xcite that the mhd entropy density , u(q ) = - ( p ^- ) , produces a set of _ entropy variables _ , @xmath43 , that do not immediately symmetrize the ideal mhd equations .",
    "instead , a symmetric hyperbolic form of ideal mhd can only be obtained if an additional term that is proportional to the divergence of the magnetic field is included in the mhd equations : + = 0 , ( q ) = ( -1 ) . by looking at how the entropy behaves on the discrete level",
    ", barth @xcite was able to prove that certain discontinuous galerkin discretizations of the ideal mhd equtions could be made to be _ entropy stable _ ( see tadmor @xcite ) if the discrete magnetic field where made globally divergence - free .",
    "the implication of this result is that schemes that do not control errors in the divergence of the magnetic field run the risk of becoming entropy unstable .",
    "the constrained transport framework advocated in this work is based on using the _ magnetic vector potential _",
    ", @xmath44 , whose curl yields the magnetic field : = .",
    "a key feature of the proposed method is that the magnetic vector potential is updated alongside the conserved variables : @xmath45 .",
    "the use of the magnetic potential in computing solutions to the mhd equations goes all the way back to wilson @xcite in 1975 , who considered relativistic 2d axisymmetric problems , and dorfi @xcite in 1986 , who considered fully three - dimensional flow .",
    "these approaches did not use modern shock - capturing techniques ; and therefore , the computed solutions exhibited strong numerical diffusion .",
    "the first direct use of the magnetic potential in the context of modern shock - capturing schemes was due to londrillo and del zanna @xcite .",
    "subsequent work on using a magnetic potential with shock - capturing schemes includes de sterck @xcite , londrillo and del zanna @xcite , and rossmanith @xcite .",
    "the main focus of this work is to extend the 2d constrained transport method introduced by rossmanith @xcite to three - dimensions .",
    "we begin with an outline of our method that lists all of the key steps necessary to completely advance the solution from its current state at time @xmath46 to its new state at time @xmath47 :    : :    start with the current state :    @xmath48 .",
    ": :    update mhd variables via a standard finite volume scheme :    @xmath49    where the energy and magnetic field values ,    @xmath50 and @xmath7 , are    given a @xmath51 superscript instead of @xmath52    to emphasize that these values will be modified by the constrained    transport algorithm before the end of the time step .",
    ": :    define the time - averaged velocity :    @xmath53 .",
    ": :    using the above calculated velocity , @xmath54 , solve    the magnetic potential version of the induction equation for an explanation of this equation . ] :    @xmath55 this updates the vector    potential : @xmath56 . : :    compute the new magnetic field from the curl of the vector potential    ( @xmath57 ) : @xmath58^{n+1}_{ijk } & =                 \\frac{\\left[\\a^3\\right]^{n+1}_{i\\,j+1\\,k } - \\left[\\a^3 \\right]^{n+1}_{i\\,j-1\\,k}}{2 \\delta y }                 -   \\frac{\\left [ \\a^2 \\right]^{n+1}_{i\\,j\\,k+1 } - \\left [ \\a^2 \\right]^{n+1}_{i\\,j\\,k-1}}{2 \\delta z } , \\\\            \\left [ b^2 \\right]^{n+1}_{ijk } &",
    "= \\label{eqn : b2 }                \\frac{\\left [ \\a^1 \\right]^{n+1}_{i\\,j\\,k+1 } - \\left [ \\a^1 \\right]^{n+1}_{i\\,j\\,k-1}}{2 \\delta z }                 -   \\frac{\\left [ \\a^3 \\right]^{n+1}_{i+1\\,j\\,k } - \\left [ \\a^3 \\right]^{n+1}_{i-1\\,j\\,k}}{2 \\delta x } , \\\\            \\left [ b^3 \\right]^{n+1}_{ijk } & = \\label{eqn : b3 }                \\frac{\\left [ \\a^2 \\right]^{n+1}_{i+1\\,j\\,k } - \\left [ \\a^2 \\right]^{n+1}_{i-1\\,j\\,k}}{2 \\delta x }                 -   \\frac{\\left [ \\a^1 \\right]^{n+1}_{i\\,j+1\\,k } - \\left [ \\a^1 \\right]^{n+1}_{i\\,j-1\\,k}}{2 \\delta y } ,        \\end{aligned}\\ ] ] where the bracket notation ,    @xmath59^n_{ijk}$ ] , is used to clearly    distinguish between vector component superscripts and grid and time    point superscripts and subscripts .",
    ": :    set the new total energy density value based on one of the following    options :    +    ; ;      conserve total energy : @xmath60    ; ;      keep the pressure the same before and after the constrained      transport step ( this sometimes helps in preventing the pressure from      becoming negative , although it sacrifices energy conservation ) :",
    "@xmath61    the above described algorithm guarantees that at each time step , the following discrete divergence is identically zero : @xmath62^{n+1}_{ijk }   & =       \\frac{\\left[b^1 \\right]^{n+1}_{i+1 \\ , j \\",
    ", k } - \\left[b^1 \\right]^{n+1}_{i-1 \\ , j \\ ,",
    "k}}{2 \\delta x } +       \\frac{\\left[b^2 \\right]^{n+1}_{i \\",
    ", j+1 \\ , k } - \\left[b^2 \\right]^{n+1}_{i \\ , j-1 \\ , k}}{2 \\delta y }   \\\\      & + \\ , \\frac{\\left[b^3 \\right]^{n+1}_{i \\ , j \\ ,",
    "k+1 } - \\left[b^3 \\right]^{n+1}_{i \\ , j \\ , k-1}}{2 \\delta z } = 0 .",
    "\\end{split}\\ ] ]",
    "the key step in the constrained transport framework as outlined in the previous section is * step 3 * , which requires one to solve an evolution equation for the magnetic vector potential .",
    "one question that immediately arises : what should be chosen for the gauge condition ? in this section",
    "we briefly discuss several gauge conditions and their consequences on the evolution of the magnetic vector potential .    the starting point for",
    "this discussion is the induction equation : [ eqn : induction ] _ , t + ( u ) = 0 , where , for the purposes of the algorithm outlined in  [ sec : framework ] , we take the velocity , @xmath2 , as a given function .",
    "we set @xmath57 and rewrite as @xmath63 where @xmath9 is an arbitrary scalar function .",
    "different choices of @xmath9 represent different _ gauge condition _ choices .    before we explore various gauge conditions",
    ", however , it is worth pointing out that the situation in the pure two - dimensional case ( e.g. , in the @xmath64-plane ) is much simpler .",
    "the only component of the magnetic vector potential that influences the evolution in this case is @xmath65 ( i.e. , the component of the potential that is perpendicular to the evolution plane ) ; and furthermore , all gauge choices lead to the same equation : ^3_,t + u^1 ^3_,x + u^2 ^3_,y = 0 , where @xmath65 is uniquely defined up to an additive constant .      an obvious choice for the gauge is to take the vector magnetic potential to be solenoidal : @xmath66 resulting in the _",
    "coulomb gauge_. we are now able to add @xmath67 to the left - hand side of and obtain an equation for the potential that is in symmetric hyperbolic form : @xmath68 the main difficulty with this approach , however , is that at each time step one must solve a poisson equation to determine the lagrange multiplier @xmath9 : @xmath69.\\ ] ] having to solve an elliptic equation in each time step makes this approach have the same efficiency problems as the projection method .      in the ideal mhd setting ,",
    "since the speed of light is taken to be infinite , the lorentz and coulomb gauges are equivalent .",
    "however , one possibility is to introduce a fictitious wave speed , @xmath70 , that is larger than all other wave speeds in the mhd system",
    ". we can then take @xmath71 which results in the following evolution equation for @xmath72 : @xmath73 the flux jacobian of this system in some direction @xmath74 ( where @xmath75 ) can be written as @xmath76 the eigenvalues of this matrix are = \\ { - , , u , u}. if @xmath77 , the right - eigenvectors of @xmath78 are complete , and thus , the system is hyperbolic .",
    "although this seems like a potentially useful gauge choice , we found in practice that numerical solutions to system did not produce accurate magnetic fields .",
    "in particular , we observed errors in the location of strong shocks , which is presumably due to the fact that on the discrete level 0 , thus resulting in errors in @xmath1 .      another gauge possibility is to directly set the scalar function , @xmath9 , to something useful .",
    "one such choice is @xmath79 which is inspired by the magnetic helicity : @xmath80 .",
    "this yields the system : @xmath81 where @xmath82 one obvious approach for solving this equation is via operator splitting , whereby equation is split into three decoupled advection equations : @xmath83 and a ` linear ' ordinary differential equation , is taken to be frozen in time at @xmath84 . ] : @xmath85 the main difficulty with this approach is that the matrix @xmath86 in equation could ( and often does ) have eigenvalues that have a positive real part ; thereby , causing this system to be inherently unstable . for this reason ,",
    "numerical tests using this gauge condition were generally not successful .",
    "the choice that we finally settled on was the weyl gauge : @xmath87 in this approach , the resulting evolution equation is simply with a zero right - hand side .",
    "this gauge is the most commonly used one in the description of constrained transport methods ( see for example @xcite ) .",
    "as we will describe in detail in the next section ,  [ sec : numerics ] , the resulting system is only _ weakly _ hyperbolic .",
    "this is due to the fact that there are certain directions in which the matrix of right - eigenvectors of the flux jacobian does not have full rank .",
    "this degeneracy causes some numerical difficulties , which we were able to overcome through the creation of a modified wave propagation scheme .",
    "the details of this approach are described in the next section .",
    "the numerical methods developed in this paper are based on the high - resolution wave propagation scheme of leveque @xcite and its 3d extension developed by langseth and leveque @xcite . in  [ subsec : langlev ]",
    "we briefly review the 3d wave propagation approach . in  [ sec : method_potential ] we show in detail how this approach can be modified to solve the non - conservative and only weakly hyperbolic magnetic vector potential equation . in  [ subsec : mp_limiters ] we develop a limiting strategy that is applied during the magnetic potential update , but designed to control unphysical oscillations in the magnetic field . finally , in  [ subsec : mp_25d ] we briefly mention how our approach simplifies in the special case of 2.5-dimensional problems .",
    "in * step 1 * of the constrained transport method described in  [ sec : framework ] we apply a numerical method for the three - dimensional mhd equations . here",
    "we use a version of the three - dimensional wave propagation algorithm of langseth and leveque @xcite , see also @xcite , which is based on a decomposition of flux differences at grid cell interfaces as outlined in @xcite .",
    "this is a multidimensional high - resolution finite volume method that is second order accurate for smooth solutions and that leads to an accurate capturing of shock waves .    to outline the main steps of this algorithm",
    ", we consider a three - dimensional hyperbolic system of the general form @xmath88 with @xmath89 and @xmath90 . in quasilinear form",
    "the system reads @xmath91 where @xmath92 , @xmath93 , and @xmath94 are the flux - jacobians in each of the three coordinate directions : @xmath95 we construct a 3d cartesian mesh with grid spacing @xmath96 , @xmath97 , and @xmath98 in each of the coordinate directions .",
    "we represent the solution at each discrete time level @xmath46 as piecewise constant , such that in each grid cell @xmath99 the solution is given by @xmath100 .",
    "@xmath100 denotes the cell average of the conserved quantity @xmath101 in the grid cell centered at @xmath102 : q^n_ijk _ x_i-^x_i+ _ y_j-^y_j+ _ z_k-^z_k+ q(t^n , , , ) d d d. the numerical method can be written in the form @xmath103 the first three lines in ( [ eqn : update3d ] ) describe a first order accurate update and the last two lines represent higher order correction terms .",
    "the wave propagation method is a so - called _ truly multidimensional scheme _ in the sense that no dimensional splitting is used to approximate the mixed derivative terms that are required in a second order accurate update .    at each grid cell interface in the @xmath104-direction , we decompose the flux differences @xmath105 into waves @xmath106 \\ , \\r_{i-\\frac{1}{2 } \\ , j \\ , k}^p,\\ ] ] which are moving with speeds @xmath107 , @xmath108 . for this decomposition",
    "we use the left and right eigenvectors proposed by roe and balsara @xcite ( see also powell @xcite for a discussion of these eigenvectors ) for a linearized flux jacobian matrix of the mhd equations .",
    "the fluctuations used in the first order update have the form : @xmath109 analogously , we compute fluctuations in the @xmath110 and @xmath111directions .",
    "an advantage of the decomposition of the flux differences compared to the standard wave propagation method from @xcite , which is based on an eigenvector decomposition of the jumps of the conserved quantities at each grid cell interface , is that the local linearization of the flux jacobian matrix does not require roe averages , which are quite difficult to compute for the mhd equations @xcite .",
    "here we use simple arithmetic averaging instead .",
    "see wesenberg @xcite for a discussion of how the use of arithmetic averages is equivalent to an mhd riemann solver based on van leer flux - vector splitting @xcite .",
    "the waves and speeds are also used to compute high - resolution correction terms . for the waves in the @xmath104-direction",
    ", the correction fluxes have the form @xmath112 where [ eqn : limiter2 ] ^p_i- j k : = , i =    i-1 & s^p_i- j k > 0 , + i+1 & s^p_i- j k < 0 ,    is a measure of the location smoothness in the @xmath21-th wave family and @xmath113 is a total variation diminishing ( tvd ) limiter function @xcite .    the wave propagation method is a 1-step , unsplit , second - order accurate method in both space and time ( for smooth solutions ) ; and therefore , is based on a taylor series expansions in time :    q ( t+t , * x * ) = q + t q_,t + t^2 q_,tt + o ( t^3 ) + = q - t + t^2 \\ { ( f_,x ) _ , x + ( g_,y ) _ , y + ( h_,z ) _ , z + + } + o ( t^3 ) ,    where time derivatives have been replaced by spatial derivations through the conservation law . the wave propagation method as described so far , approximates each of the terms in the above taylor series to second order accuracy , except those terms marked as _ transverse terms_. the transverse terms",
    "are approximated via additional riemann solvers known as _ transverse riemann solvers_. additionally , langseth and leveque @xcite found that in order to achieve optimal stability bounds , additional so - called _",
    "double transverse riemann solvers _ are required to approximate certain mixed third - derivative terms .",
    "we omit a full discussion of the transverse and double transverse terms in this work , and instead , refer the reader to the paper of langseth and leveque @xcite .",
    "we now describe a numerical method for the evolution equation of the magnetic potential using the weyl gauge , i.e. , for the discretization of ( [ eqn : vecpot_general ] ) with zero right hand side . the equation can be written in the form @xmath114 with @xmath115      we recall the following definitions regarding hyperbolicity .",
    "* definition . *",
    "( * strict hyperbolicity * ) _ the quasilinear system , @xmath116 is strictly hyperbolic if the matrix @xmath117 is diagonalizable with distinct real eigenvalues for all @xmath31 . in other words ,",
    "the @xmath118 eigenvalue of @xmath119 is real and has geometric and algebraic multiplicities of exactly one .",
    "_    * definition . * ( * non - strict hyperbolicity * ) _ the quasilinear system is non - strictly hyperbolic if the matrix is diagonalizable with real but not necessarily distinct eigenvalues for all @xmath31 .",
    "in other words , the @xmath118 eigenvalue of @xmath119 is real and has the same geometric and algebraic multiplicity , but that multiplicity may be greater than one . _    * definition . *",
    "( * weak hyperbolicity * ) _ the quasilinear system is weakly hyperbolic if the matrix has real eigenvalues for all @xmath31 , but is not necessarily diagonalizable . in other words ,",
    "the @xmath118 eigenvalue of @xmath119 is real but may have an algebraic multiplicity larger than its geometric multiplicity .",
    "_    the flux jacobian of system ( [ eqn : system_compact ] ) in an arbitrary direction @xmath120 is @xmath121 the eigenvalues of this system are = \\{0 , , u } ; and therefore , we always have real eigenvalues . the eigenvectors can be written in the following form : @xmath122 =   \\begin{bmatrix } n^1 & \\quad   n^2 u^3 - n^3 u^2 & \\quad u^1 \\left ( \\u \\cdot \\n \\right ) - n^1 \\| \\u \\|^2 \\\\ n^2 & \\quad n^3 u^1 - n^1 u^3 & \\quad u^2 \\left ( \\u \\cdot \\n \\right ) - n^2 \\| \\u \\|^2 \\\\ n^3 & \\quad n^1 u^2 - n^2 u^1 & \\quad u^3 \\left ( \\u \\cdot \\n \\right ) - n^3",
    "\\| \\u \\|^2 \\end{bmatrix}.\\ ] ] assuming that @xmath123 and @xmath75 , the determinant of matrix @xmath124 can be written as @xmath125 where @xmath126 is the angle between the vectors @xmath74 and @xmath2 .",
    "the difficulty is that for any non - zero velocity vector , @xmath127 , one can always find four directions , @xmath128 , @xmath129 , @xmath130 , and @xmath131 , such that @xmath132 . in other words , for every @xmath133 there exists four degenerate directions in which the eigenvectors are incomplete .",
    "therefore , system  is only _",
    "weakly hyperbolic_.",
    "non - strict hyperbolicity is common in many standard equations ( e.g. , euler equations of gas dynamics ) ; and , although it causes some difficulties in proving long - time existence results , it generally does not cause problems for numerical discretization of such equations .",
    "weak hyperbolicity , however , is a different story .",
    "we illustrate this point with the following simple example .",
    "let @xmath134 where @xmath135 is a constant .",
    "the eigen - decomposition of the flux jacobian can be written as follows : @xmath136 since the eigenvalues are always real , this system is hyperbolic .",
    "for all @xmath137 , the system is strongly hyperbolic , and for @xmath138 the system is only weakly hyperbolic . since we have the exact eigen - decomposition ,",
    "we can write down the exact solution for the cauchy problem for all @xmath139 : @xmath140 in the weakly hyperbolic limit we obtain : @xmath141 the change in dynamics between the strongly and weakly hyperbolic regimes is quite dramatic : in the strongly hyperbolic case the total energy is conserved , while in the weakly hyperbolic case the amplitude of the solution grows linearly in time .      in the case of the magnetic vector potential equation  , the weak hyperbolicity is only an artifact of how we are evolving the magnetic potential .",
    "one should remember that the underlying equations ( i.e. , the ideal mhd system ) are in fact hyperbolic .",
    "one way to understand all of this is to remember that the true velocity field , @xmath2 , depends on the magnetic potential in a nonlinear way .",
    "that is , even though there might be instantaneous _ growth _ in the vector potential due to the weak hyperbolicity in the potential equation , this growth will immediately change the velocity field in such a way that the overall system remains hyperbolic .    numerically , however",
    ", we must construct a modified finite volume method that can handle this _ short - lived _ weak hyperbolicity . through some experimentation with various ideas",
    ", we found that simple operator splitting techniques lead to robust numerical methods .",
    "in particular , we found that there are two obvious ways to split system ( [ eqn : vecpot_general ] ) into sub - problems .    the first possibility is based on a decomposition of the form @xmath142",
    "\\end{split } \\\\ \\label{eqn : splitting1b } \\begin{split } \\mbox{{\\bf sub - problem 2 : } \\hspace*{0.5 cm } } & \\a^1 _ { , t } - u^2 \\a^2 _ { , x } = 0,\\\\ & \\a^2 _ { , t } + u^1 \\a^2 _ { , x } + u^3 \\a^2 _ { , z } = 0,\\\\ & \\a^3 _ { , t } - u^2 \\a^2 _ { , z }   = 0 , \\\\[0.5 cm ] \\end{split}\\\\ \\label{eqn : splitting1c } \\begin{split } \\mbox{{\\bf sub - problem 3 : } \\hspace*{0.5 cm } } & \\a^1 _ { , t } - u^3 \\a^3 _ { , x } = 0,\\\\ & \\a^2 _ { , t } - u^3 \\a^3 _ { , y } = 0,\\\\ & \\a^3 _ { , t } + u^1 \\a^3 _ { , y } + u^2 \\a^3 _ { , x } = 0 .",
    "\\end{split}\\end{gathered}\\ ] ] first , consider sub - problem 1 .",
    "the first equation can be approximated using the two - dimensional method described in ( * ? ? ?",
    "* section 5.3 ) , which is a modification of leveque s wave propagation method that leads to a second order accurate approximation for smooth solutions , both in the potential and the magnetic field , and a non - oscillatory solution simultaneously for both the magnetic potential and magnetic field .",
    "once the quantity @xmath143 is updated , central finite difference approximations can be used to update @xmath144 and @xmath65 .",
    "sub - problems 2 and 3 can be approached analogously and strang operator splitting can be used to approximate ( [ eqn : system_compact ] ) .",
    "we have tested this splitting and obtained very satisfying results .",
    "a second approach to split ( [ eqn : vecpot_general ] ) is based on dimensional splitting , i.e. , we consecutively solve the problems @xmath145 \\end{split } \\\\ \\label{eqn : splitting2b } \\begin{split } \\mbox{{\\bf sub - problem 2 : } \\hspace*{0.5 cm } } & \\a^1 _ { , t } + u^2 \\a^1 _ { , y } = 0,\\\\ & \\a^2 _ { , t } - u^1 \\a^1 _",
    "{ , y } - u^3 \\a^3 _ { , y } = 0,\\\\ & \\a^3 _ { , t } + u^2 \\a^3 _ { , y } = 0,\\\\[0.5 cm ] \\end{split } \\\\ \\label{eqn : splitting2c } \\begin{split } \\mbox{{\\bf sub - problem 3 : } \\hspace*{0.5 cm } } & \\a^1 _ { , t } + u^3 \\a^1 _ { , z } = 0,\\\\ & \\a^2 _ { , t } + u^3 \\a^2 _ { , z } = 0,\\\\ & \\a^3 _ { , t } - u^1 \\a^1 _ { , z } - u^2 \\a^2 _ { , z } = 0 .",
    "\\end{split}\\end{gathered}\\ ] ] we will now present a numerical method that is based on this second splitting .",
    "our method should be easy to adapt by other users ; and , in particular , also by those who do not base their numerical method on the wave propagation algorithm .",
    "we denote the numerical solution operator for sub - problem 1 , 2 and 3 by @xmath146 , @xmath147 and @xmath148 , respectively .",
    "then a strang - type operator splitting method can be written in the form ^n+1 = l_1^t/2 l_2^t/2 l_3^t l_2^t/2 l_1^t/2 ^n .",
    "one time step from @xmath5 to @xmath6 consists in consecutively solving sub - problem 1 over a half time step , sub - problem 2 over a half time step , sub - problem 3 over a full time step , sub - problem 2 over another half time step and finally solving sub - problem 1 over another half time step .",
    "we now present the details for the approximation of the first sub - problem ( [ eqn : splitting2a ] ) for a time step from @xmath149 to @xmath150 .",
    "the evolution of @xmath144 and @xmath65 is described by two decoupled scalar transport equations , which have the form @xmath151 we assume that cell average values of @xmath152 and @xmath153 are given at time @xmath149 and we wish to approximate @xmath152 and @xmath153 at time @xmath150 . in our application , cell centered values of the advection speed @xmath154 are given at the intermediate time level ( see * step 2 * of the algorithm from  [ sec : framework ] ) .",
    "the update for all @xmath155 and @xmath156 has the form @xmath157_{ijk}^{n+1 } = \\bigl [ \\a^\\l \\bigr]_{ijk}^n & - \\frac{\\delta \\tau}{\\delta x } \\left [ { \\cal      a}^- \\delta \\a^\\l_{i+\\frac{1}{2 } \\ , j \\ , k } + { \\cal a}^+ \\delta    \\a^\\l_{i-\\frac{1}{2 } \\ , j \\ , k } \\right ] \\\\ & - \\frac{\\delta \\tau}{\\delta x } \\left [    \\tilde{f}_{i+\\frac{1}{2 } \\ , j \\ , k}^{\\ell- }   - \\tilde{f}_{i-\\frac{1}{2 } \\ , j \\ , k}^{\\ell+ } \\right ] , \\end{split}\\ ] ] with @xmath158_{ijk}^n - \\bigl[\\a^\\l \\bigr]_{i-1\\ , j \\ , k}^n,\\\\ { \\cal a}^- \\delta \\a^\\l_{i-\\frac{1}{2 } \\ , j \\ , k } & : = \\min(u_{i-1 \\ , j \\ ,",
    "k}^1,0 ) \\ , { \\cal    w}^\\l_{i-\\frac{1}{2 } \\ , j \\ , k } , \\\\ { \\cal a}^+ \\delta \\a^\\l_{i-\\frac{1}{2 } \\ , j \\ , k } & : = \\max(u_{i \\ , j \\ ,",
    "k}^1,0 ) \\ , { \\cal    w}^\\l_{i-\\frac{1}{2 } \\ , j \\ , k } , \\ ] ] and @xmath159 here @xmath160 is a cell centered value and @xmath161 is a face centered value .",
    "the key innovation in this construction as developed in @xcite is the use of a cell - based limiter , rather than the standard edge - based limiter as represented in equations .",
    "furthermore , in this construction the smoothness indicator , @xmath162 , is based on _ wave - differences _ rather than waves as in : _",
    "ijk^ = , where @xmath163 , and the index @xmath164 is again chosen from the upwind direction .",
    "the reason for the use of wave - differences instead of waves is that ultimately , the physical quantity of importance is the magnetic field and not the magnetic potential . as was shown in @xcite , standard wave limiters do not control oscillations in derivative quantities ( i.e. , the magnetic field ) , while the wave - difference limiter approach does .    once we have updated @xmath144 and @xmath65 , we update @xmath143 by discretizing the equation @xmath165 for this we use a finite difference method of the form @xmath166_{ijk}^{n+1 } = \\left[\\a^1\\right]_{ijk}^n + \\frac{\\delta \\tau}{2 } \\biggl\\ { &    \\left[u^2\\right]_{ijk}^{n+\\half } \\left(d_x \\left[\\a^2\\right]_{ijk}^n +   d_x    \\left[\\a^2\\right]_{ijk}^{n+1 } \\right ) \\\\ + &   \\left[u^3\\right]_{ijk}^{n+\\half } \\left ( d_x \\left[\\a^3\\right]_{ijk}^n + d_x    \\left[\\a^3\\right]_{ijk}^{n+1 } \\right ) \\biggr\\ } , \\end{split}\\ ] ] where @xmath167 is the standard centered finite difference operator in the @xmath104-direction , i.e. , d_x _ ijk^n : = .",
    "we will refer to the numerical solution of and as _ hyperbolic solves _ and the numerical solution of equation as the _ weakly hyperbolic solve_.      for the spatially two - dimensional case , the limiting of wave - differences eliminates unphysical oscillations in the magnetic field . in the three - dimensional case , the equation for the magnetic potential is more challenging and only weakly hyperbolic .",
    "each sub - problem of the numerical method is a combination of one - dimensional hyperbolic solves ( i.e. , equations and ) and a part that we refer to as the weakly hyperbolic solve ( i.e. , equation ) .",
    "the wave - difference limiting strategy as outlined in  [ sec : subprob1 ] is generally insufficient in controlling unphysical oscillations in the magnetic field variables .",
    "in particular , the step that produces unphysical oscillations is the weakly hyperbolic solve as described in equation .",
    "since this part of the update is quite different from standard upwind numerical methods for hyperbolic equations , there is no obvious place to introduce wave - difference limiters .",
    "instead , we describe in this section an approach based on adding artificial diffusion to this part of the update in order to remove these unphysical oscillations .",
    "we introduce a diffusive limiter that is inspired by the artificial viscosity method that is often used in other numerical schemes such as the discontinuous galerkin approach ( e.g. , see @xcite ) . instead of ( [ eqn : sub1_a1 ] ) ,",
    "we discretize the problem with an added dissipative term @xmath168 where the parameter @xmath169 depends on the solution structure and controls the amount of artificial diffusion .",
    "we choose @xmath170 where @xmath171 is a positive constant that will be discussed below , @xmath172 is a smoothness indicator that is close to zero in smooth regions and close to 0.5 near discontinuities .",
    "note that we distinguish the size of the total time step : t = t^n+1 - t^n , from the time step of a particular substep of the strang splitting : = ^n+1 - ^n .",
    "we add this additional diffusion term to each weakly hyperbolic equation in our dimensionally split algorithm in the following way : @xmath173 \\end{split } \\\\ \\label{eqn : splitting_viscous_b } \\begin{split } \\mbox{{\\bf sub - problem 2 : } \\hspace*{0.5 cm } } & \\a^1 _ { , t } + u^2 \\a^1 _",
    "{ , y } = 0,\\\\ & \\a^2 _ { , t } - u^1 \\a^1 _ { , y } - u^3 \\a^3 _ { , y } = \\varepsilon^2 a^2_{,yy},\\\\ & \\a^3 _ { , t } + u^2 \\a^3 _ { , y } = 0,\\\\[0.5 cm ] \\end{split } \\\\ \\label{eqn : splitting_viscous_c } \\begin{split } \\mbox{{\\bf sub - problem 3 : } \\hspace*{0.5 cm } } & \\a^1 _ { , t } + u^3 \\a^1 _ { ,",
    "z } = 0,\\\\ & \\a^2 _ { , t } + u^3 \\a^2 _ { , z } = 0,\\\\ & \\a^3 _ { , t } - u^1 \\a^1 _ { , z } - u^2 \\a^2 _ { , z } = \\varepsilon^3 a^3_{,zz}. \\end{split}\\end{gathered}\\ ] ] note that we diffuse only in the direction of the dimensionally split solve .",
    "consider again only the discretization used in sub - problem ( [ eqn : splitting_viscous_a ] ) .",
    "the numerical update in the weakly hyperbolic solve can be written as @xmath174_{ijk}^{n+1 }   & = \\left [ \\a^1 \\right]_{ijk}^{\\star } + 2 \\frac{\\delta \\tau}{\\delta t } \\nu \\alpha \\left ( \\left [ \\a^1 \\right]_{i-1jk}^n - 2 \\left [ \\a^1 \\right]_{ijk}^n + \\left [ \\a^1 \\right]_{i+1jk}^n \\right ) , \\end{split}\\ ] ] where @xmath175_{ijk}^{\\star}$ ] is given from update .",
    "stability requires that 0 2 , which can be achieved if we assume that @xmath176 and we take 0 0 . in our proposed method , @xmath126 is a smoothness indicator and @xmath177 is a user - defined parameter ( typically @xmath178 ) that can be tuned to control the amount of numerical dissipation across discontinuities in the magnetic field .    the smoothness indicator @xmath126 is computed according to the formulas @xmath179 with @xmath180 the parameter @xmath181 is introduced only to avoid division theory and is in practice taken to be @xmath182 . the smoothness indicator is designed to distinguish between the following cases :    1 .",
    "if @xmath143 is smooth for @xmath183 , then @xmath184 in this case one can show that @xmath185 which shows that the overall numerical method still retains @xmath186 accuracy .",
    "2 .   if @xmath143 is non - smooth in @xmath187 and smooth in @xmath188 , then @xmath189 and @xmath190 .",
    "3 .   if @xmath143 is non - smooth in @xmath188 and smooth in @xmath187 , then @xmath191 and @xmath190 .    in all cases",
    "@xmath192 , which guarantees that the numerical update will be stable up to cfl number one .",
    "in order to construct and analyze methods for the three - dimensional mhd equations , it is instructive to also look at the so - called 2.5-dimensional case . in this case",
    "we assume that @xmath2 and @xmath1 are three - dimensional vectors , but all conserved quantities @xmath193^t$ ] are functions of only two spatial variables , say @xmath194 .",
    "since @xmath195 , we can obtain a divergence free magnetic field by employing a constrained transport algorithm that only updates @xmath196 and @xmath197 , and which treats @xmath198 as just another conserved variable in the base scheme .",
    "in other words , one could simply update the transport equation for @xmath199 , @xmath200 via the method of @xcite , then compute the first two components of the magnetic field from discrete analogs of @xmath201 and @xmath202 , and let the base scheme update @xmath198 since it does nt enter into the 2.5d divergence constraint : @xmath203    an alternative approach to handling the 2.5d case , one that will allow us to test the important features of the proposed 3d scheme , is to consider the full magnetic vector potential evolution equation in the @xmath64-plane : @xmath204 approximate solutions to these equations can be computed via the method outlined in  [ sec : method_potential ] and  [ subsec : mp_limiters ] .",
    "the magnetic field can be obtained via discrete analogs of @xmath205 because the numerical update based on the scheme presented in  [ sec : method_potential ] and  [ subsec : mp_limiters ] is not equivalent to the method of @xcite in 2.5d , we expect to see some differences in the solution of the magnetic field .",
    "however , since the two methods are very closely related , we expect to obtain similar results .",
    "numerical examples for the 2.5d case comparing the 2d constrained transport method of @xcite and the proposed 3d method are discussed in  [ sec : smooth2.5d ] and  [ sec : shock2.5d ] .",
    "we present several numerical experiments in this section .",
    "all the numerical tests are carried out in the clawpack software package @xcite , which can be freely downloaded from the web . in particular , the current work has been incorporated into the mhdclaw extension of clawpack , which was originally developed by rossmanith @xcite .",
    "this extension can also be freely downloaded from the web .",
    "we begin by presenting numerical results for two problems in 2.5 dimensions ( i.e. , the solution depends only on the independent variables @xmath206 , but all three components of the velocity and magnetic field vectors are non - zero ) .",
    "the two examples that are considered are :    1 .",
    "smooth alfv@xmath207n wave ; and 2 .   cloud - shock interaction .",
    "the first example involves an infinitely smooth exact solution of the ideal mhd system .",
    "the second example involves the interaction of a high - pressure shock with a high - density bubble ( i.e. , a discontinuous example ) .",
    "we first verify the order of convergence of the constrained transport method for a smooth circular polarized alfvn wave that propagates in direction @xmath208 towards the origin .",
    "this problem has been considered by several authors ( e.g. , @xcite ) , and is a special case ( @xmath209 ) of the 3d problem described in detail in  [ sec : alfven ] .",
    "here we take @xmath210 and solve on the domain : @xmath211\\times \\left[0,\\frac{1}{\\sin\\phi}\\right].\\ ] ] the solution consists of a sinusoidal wave propagating at constant speed without changing shape , thus making it a prime candidate to verify order of accuracy .    in table",
    "[ table : alfven2.5 ] , we show the convergence rates for the 2.5d test problem . here",
    "all three components of the magnetic field have been updated in the constrained transport method and the magnetic potential was approximated using a dimensional split method for ( [ eqn : system2.5a])([eqn : system2.5c ] ) .",
    "the table clearly shows that the proposed method is second - order accurate in all of the magnetic field components , as well as the magnetic potential components .",
    "the reported errors are of the same magnitude as those reported in table 7.1 of @xcite ( page 1786 ) .",
    ".error tables for the 2.5d alfv@xmath207n problem at time @xmath212 using proposed dimensional split scheme .",
    "this table shows that all components of the magnetic field and all components of the magnetic potential converge at second order accuracy.[table : alfven2.5 ] [ cols=\"^,^,^,^\",options=\"header \" , ]      we now consider the shock tube problem described in @xcite . in this test case",
    "a one - dimensional shock tube problem is computed in a three - dimensional domain . in order to define the problem",
    ", we consider a coordinate transformation of the form @xmath213 which maps the cartesian coordinates @xmath214 to the rotated coordinate system @xmath215 .",
    "vectors transform as follows @xmath216    the riemann initial data is taken to be @xmath217 where the velocity vector and the magnetic field are given in the rotated coordinate frame . as the initial condition for the magnetic potential ( in the rotated coordinate frame ) we use @xmath218    the solution of the riemann problem at later times remains a function of @xmath70 .",
    "this fact is used to extend the computed values to ghost cell values .",
    "the computational domain is @xmath219 \\times [ 0 , 0.015625 ] \\times [ 0 , 0.015625]$ ] , which is discretized using @xmath220 grid cells . by using @xmath221 and @xmath222",
    ", we obtain simple formulas for the extension of the numerical solution to the ghost cells.to define ghost cell values in the cartesian @xmath223-direction , we can for instance use the relation @xmath224 . in the @xmath225-direction",
    "we can use @xmath226 .",
    "the ghost cell values in the @xmath104-direction were computed via extrapolation .",
    "we present numerical results at time @xmath227 as scatter plots of the three - dimensional solution plotted as a function of @xmath70 .",
    "as already documented by other authors , we also observe some oscillations in particular in the @xmath228 component of the magnetic field .",
    "these oscillations do not appear if the shock tube initial data are aligned with the mesh . in figure",
    "[ fig : rp ] we show approximations of the solution at time @xmath227 .",
    "these plots are scatterplots , where the output of the three - dimensional computation is plotted as a function of @xmath70 .",
    "the solid line in these plots is obtained by computing solutions of the one - dimensional riemann problem on a very fine mesh ( using @xmath229 grid cells ) .",
    "the computation was performed using the minmod limiter and the diffusive limiter with @xmath230 . as expected , with a less diffusive limiter",
    "the amplitude of the oscillations becomes stronger , by increasing @xmath177 , the amplitude of the oscillations becomes weaker .",
    "( a ) the rotated riemann problem .",
    "scatterplots of various components of solution at time @xmath227 using the constrained transport algorithm .",
    "the solid line in each panel is a highly - resolved 1d simulation.,title=\"fig:\",scaledwidth=50.0%](b ) the rotated riemann problem .",
    "scatterplots of various components of solution at time @xmath227 using the constrained transport algorithm .",
    "the solid line in each panel is a highly - resolved 1d simulation.,title=\"fig:\",scaledwidth=50.0% ]    ( c ) the rotated riemann problem . scatterplots of various components of solution at time @xmath227 using the constrained transport algorithm .",
    "the solid line in each panel is a highly - resolved 1d simulation.,title=\"fig:\",scaledwidth=50.0%](d ) the rotated riemann problem .",
    "scatterplots of various components of solution at time @xmath227 using the constrained transport algorithm .",
    "the solid line in each panel is a highly - resolved 1d simulation.,title=\"fig:\",scaledwidth=50.0% ]    ( e ) the rotated riemann problem .",
    "scatterplots of various components of solution at time @xmath227 using the constrained transport algorithm .",
    "the solid line in each panel is a highly - resolved 1d simulation.,title=\"fig:\",scaledwidth=50.0%](f ) the rotated riemann problem .",
    "scatterplots of various components of solution at time @xmath227 using the constrained transport algorithm .",
    "the solid line in each panel is a highly - resolved 1d simulation.,title=\"fig:\",scaledwidth=50.0% ]    ( g ) the rotated riemann problem .",
    "scatterplots of various components of solution at time @xmath227 using the constrained transport algorithm . the solid line in each panel is a highly - resolved 1d simulation.,title=\"fig:\",scaledwidth=50.0%](h ) the rotated riemann problem .",
    "scatterplots of various components of solution at time @xmath227 using the constrained transport algorithm .",
    "the solid line in each panel is a highly - resolved 1d simulation.,title=\"fig:\",scaledwidth=50.0% ]      our next test problem is the orszag - tang vortex problem .",
    "this is a standard test case for the two - dimensional mhd equations .",
    "here we add a small perturbation to the initial velocity field that depends on the vertical direction .",
    "the initial condition is @xmath231 here we used @xmath232 .",
    "the initial condition for the magnetic potential is @xmath233 the computational domain is a cube with side length @xmath234 .",
    "periodicity is imposed in all three directions .    in figures [ fig : ot_test2_a]-[fig : ot_test2_d ] we show a sequence of schlieren plots of the pressure for several slices of data in the @xmath64-plane for @xmath235 . those computations have been performed with the high - resolution constrained transport method with monotonized central limiter and the diffusive limiter using @xmath236 . in figures [ fig : ot_test2_xy_a ] , [ fig : ot_test2_xy_b ] we show schlieren plots of pressure in the @xmath64-plane for @xmath237 at different times .",
    "the 3d orszag - tang problem . shown in this figure",
    "are schlieren slices of pressure at time @xmath238 and at various @xmath225 values ( @xmath235 ) .",
    "this solution was computed on a mesh with @xmath239 grid cells.,scaledwidth=100.0% ]     the 3d orszag - tang problem . shown in this figure",
    "are schlieren slices of pressure at time @xmath240 and at various @xmath225 values ( @xmath235 ) .",
    "this solution was computed on a mesh with @xmath239 grid cells.,scaledwidth=100.0% ]     the 3d orszag - tang problem .",
    "shown in this figure are schlieren slices of pressure at time @xmath241 and at various @xmath225 values ( @xmath235 ) .",
    "this solution was computed on a mesh with @xmath239 grid cells.,scaledwidth=100.0% ]     the 3d orszag - tang problem . shown in this figure",
    "are schlieren slices of pressure at time @xmath242 and at various @xmath225 values ( @xmath235 ) .",
    "this solution was computed on a mesh with @xmath239 grid cells.,scaledwidth=100.0% ]    ( a ) the 3d orszag - tang problem .",
    "schlieren plots of pressure at time ( a ) @xmath238 and ( b ) @xmath243 computed on a mesh with @xmath239 grid cells .",
    "slices of the solution at @xmath237 in the @xmath64-plane are shown.,title=\"fig:\",scaledwidth=90.0% ]    ( b ) the 3d orszag - tang problem .",
    "schlieren plots of pressure at time ( a ) @xmath238 and ( b ) @xmath243 computed on a mesh with @xmath239 grid cells .",
    "slices of the solution at @xmath237 in the @xmath64-plane are shown.,title=\"fig:\",scaledwidth=90.0% ]    ( a ) the 3d orszag - tang vortex problem . shown in these panels",
    "are schlieren plots of pressure in the @xmath64-plane at ( a ) time @xmath241 and @xmath237 and ( b ) @xmath242 and @xmath237 .",
    "these solutions were computed on a mesh with @xmath239 grid cells.,title=\"fig:\",scaledwidth=90.0% ]    ( b ) the 3d orszag - tang vortex problem . shown in these panels are schlieren plots of pressure in the @xmath64-plane at ( a ) time @xmath241 and @xmath237 and ( b ) @xmath242 and @xmath237 .",
    "these solutions were computed on a mesh with @xmath239 grid cells.,title=\"fig:\",scaledwidth=90.0% ]      finally we consider the cloud - shock interaction problem .",
    "the initial conditions consist of a shock that is initially located at @xmath244 : @xmath245 and a spherical cloud of density @xmath246 with radius @xmath247 and centered at @xmath248 .",
    "the cloud is in hydrostatic equilibrium with the fluid to the right of the shock .",
    "the initial condition for the magnetic potential is @xmath249    this test problem can be computed on the unit cube with inflow boundary conditions on the left side and outflow conditions on all other sides .",
    "instead we make use of the symmetry of the problem and compute the problem only in a quarter of the full domain , i.e.  in @xmath250 \\times [ 0.5 , 1 ] \\times [ 0.5 , 1]$ ] and impose reflecting boundary conditions at the lower boundary in the @xmath223 and @xmath225-directions .",
    "for the conserved quantities , the reflecting boundary condition is implemented in the standard way , i.e. , by copying the values of the conserved quantities from the first grid cells of the flow domain to the ghost cells . the normal momentum component in the ghost cells",
    "is negated .",
    "the components of the magnetic potential are linearly extrapolated to the ghost cells .    in figures",
    "[ figure : cloud - shock3_density1 ] and [ figure : cloud - shock3_density2 ] , we show a sequence of schlieren plots of the density in the @xmath64-plane for @xmath251 and the @xmath252-plane for @xmath253 .",
    "the three - dimensional radial symmetric solution structure compares well with previously shown two - dimensional computations . in figures",
    "[ figure : cloud - shock_xz_a ] and [ figure : cloud - shock_xz_b ] we show the schlieren plots of density in the @xmath252-plane . here",
    "the diffusive limiter described in  [",
    "sec : method_potential ] was used with @xmath254 .",
    "( a ) grid cells at time ( a ) @xmath255 and ( b ) @xmath256 . shown here is the solution in two selected orthogonal planes .",
    "[ figure : cloud - shock3_density1],title=\"fig:\",scaledwidth=90.0% ]    ( b ) grid cells at time ( a ) @xmath255 and ( b ) @xmath256 .",
    "shown here is the solution in two selected orthogonal planes .",
    "[ figure : cloud - shock3_density1],title=\"fig:\",scaledwidth=90.0% ]    ( a ) grid cells at time ( a ) @xmath257 and ( b ) @xmath258 . shown here is the solution in two selected orthogonal planes . [",
    "figure : cloud - shock3_density2],title=\"fig:\",scaledwidth=90.0% ]    ( b ) grid cells at time ( a ) @xmath257 and ( b ) @xmath258 . shown here is the solution in two selected orthogonal planes .",
    "[ figure : cloud - shock3_density2],title=\"fig:\",scaledwidth=90.0% ]    ( a ) the 3d cloud - shock interaction problem . sequence of schlieren plots of density in the @xmath252-plane for @xmath253 at time ( a ) @xmath255 and ( b ) @xmath256.,title=\"fig:\",scaledwidth=90.0% ]    ( b ) the 3d cloud - shock interaction problem . sequence of schlieren plots of density in the @xmath252-plane for @xmath253 at time ( a ) @xmath255 and ( b ) @xmath256.,title=\"fig:\",scaledwidth=90.0% ]    ( a ) the 3d cloud - shock interaction problem .",
    "sequence of schlieren plots of density in the @xmath252-plane for @xmath253 at time ( a ) @xmath257 and ( b ) @xmath258.,title=\"fig:\",scaledwidth=90.0% ]    ( b ) the 3d cloud - shock interaction problem . sequence of schlieren plots of density in the @xmath252-plane for @xmath253 at time ( a ) @xmath257 and ( b ) @xmath258.,title=\"fig:\",scaledwidth=90.0% ]",
    "we have presented a new constrained transport method for the three - dimensional mhd equations . depending on the gauge condition , we discussed different possible evolution equations for the magnetic potential .",
    "all of these gauge conditions implicate some difficulties for the discretization .",
    "the condition used here leads to a weakly hyperbolic system for the evolution of the magnetic potential .",
    "we discretized this system with a splitting approach . for the mhd equations we used a wave propagation method .",
    "several numerical tests confirm the robustness and accuracy of the resulting constrained transport scheme .",
    "* acknowledgements . *",
    "the authors would like to thank prof .",
    "rainer grauer from the ruhr - universitt - bochum for several useful discussions , as well as the anonymous reviewers for their valuable comments .",
    "this work was supported in part by nsf grants dms-0711885 and dms-1016202 and by the dfg through for1048 .",
    "t.j . barth . on the role of involutions in the discontinuous galerkin discretization of maxwell and magnetohydrodynamic systems . in _",
    "i m a volume on compatible spatial discretizations _ , volume 142 .",
    "springer - verlag , 2005 .",
    "m.  fey and m.  torrilhon . a constrained transport upwind scheme for divergence - free advection . in t.y .",
    "hou and e.  tadmor , editors , _ hyperbolic problems : theory , numerics , and applications _ , pages 529538 .",
    "springer , 2003 .",
    "h.  de sterck .",
    "multi - dimensional upwind constrained transport on unstructured grids for `` shallow water '' magnetohydrodynamics . in _ proceedings of the 15th aiaa computational fluid dynamics conference , anaheim , california _ , page 2623 .",
    "aiaa , 2001 ."
  ],
  "abstract_text": [
    "<S> numerical methods for solving the ideal magnetohydrodynamic ( mhd ) equations in more than one space dimension must either confront the challenge of controlling errors in the discrete divergence of the magnetic field , or else be faced with nonlinear numerical instabilities . </S>",
    "<S> one approach for controlling the discrete divergence is through a so - called _ constrained transport _ method , which is based on first predicting a magnetic field through a standard finite volume solver , and then correcting this field through the appropriate use of a magnetic vector potential . in this work </S>",
    "<S> we develop a constrained transport method for the 3d ideal mhd equations that is based on a high - resolution wave propagation scheme . </S>",
    "<S> our proposed scheme is the 3d extension of the 2d scheme developed by rossmanith [ _ siam j. sci . </S>",
    "<S> comp . </S>",
    "<S> _ * 28 * , 1766 ( 2006 ) ] , and is based on the high - resolution wave propagation method of langseth and leveque [ _ j . </S>",
    "<S> comp . </S>",
    "<S> phys . _ * 165 * , 126 ( 2000 ) ] . in particular , in our extension </S>",
    "<S> we take great care to maintain the three most important properties of the 2d scheme : ( 1 ) all quantities , including all components of the magnetic field and magnetic potential , are treated as cell - centered ; ( 2 ) we develop a high - resolution wave propagation scheme for evolving the magnetic potential ; and ( 3 ) we develop a wave limiting approach that is applied during the vector potential evolution , which controls unphysical oscillations in the magnetic field . </S>",
    "<S> one of the key numerical difficulties that is novel to 3d is that the transport equation that must be solved for the magnetic vector potential is only weakly hyperbolic . in presenting our numerical algorithm </S>",
    "<S> we describe how to numerically handle this problem of weak hyperbolicity , as well as how to choose an appropriate gauge condition . </S>",
    "<S> the resulting scheme is applied to several numerical test cases .    </S>",
    "<S> magnetohydrodynamics , constrained transport , hyperbolic conservation laws , plasma physics , wave propagation algorithms </S>"
  ]
}