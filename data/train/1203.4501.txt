{
  "article_text": [
    "motivated by the ubiquity of repulsive electromagnetic interactions , most models for matter include a core component that diverges at zero separation , which results in a first - order fluid - crystal transition . except for a few exotic examples , such as certain bosonic systems  @xcite , simple fluids of atoms and small molecules",
    "thus similarly crystallize . yet when nano- and micro - scale particles are concerned , more complex models that include bounded repulsive interactions are also conceivable .",
    "soft and mostly empty particles , such as dendrimers , for instance , can sit on top of each other with only a finite energy penalty  @xcite .",
    "a soft - core interaction captures the effective coarse - grained nature of the potential of mean force between them  @xcite , and at relatively low densities these interactions are reasonably pairwise additive  @xcite .",
    "liquid state theory suggests that the phase behavior of such soft - core repulsive interactions falls into one of two categories , depending on the presence or not of negative components in the fourier transform of the pair potential  or , roughly speaking , on its steepness  @xcite . on the one hand ,",
    "flat potentials with purely positive fourier transforms undergo reentrant melting . under compression at low temperatures , the system first crystallizes and then remelts . the gaussian core model ( gcm ) , which was first proposed as a model for plastic crystals  @xcite and",
    "has since been thoroughly studied  @xcite , exhibits such behavior .",
    "on the other hand , steep potentials with negative fourier components cluster up at high densities . under compression ,",
    "these systems form crystals in which each lattice site may be occupied by multiple particles .",
    "the transition from fluid to cluster crystals is driven not only by gains in free volume , but also by reducing the overlap energy  @xcite . the penetrable sphere model ( psm ) , which was initially proposed to describe the interaction between polymeric micelles  @xcite , belongs to this second category .",
    "its properties have been explored by density functional theory ( dft ) , cell theory , kinetic theory , and basic simulations  @xcite . to complement these two systems , mladek _ et al .",
    "_ have introduced the generalized exponential model of index @xmath4 ( gem-@xmath4 ) , with a pair potential that scales with distance @xmath5 like @xmath6 , to interpolate between the gcm ( @xmath7 ) and the psm ( @xmath8 )  @xcite . since then , a number of additional dynamic and thermodynamic studies have looked at the exotic properties of this class of models  @xcite .",
    "studying the thermodynamics of cluster crystals by simulations is , however , particularly challenging .",
    "when initializing the system , there is a trade - off between configurations with more lattice sites but fewer overlaps , and configurations with fewer lattice sites but more overlaps .",
    "the problem is that once initialized , ( reasonably ) finite systems can not find the average lattice site occupancy @xmath9 because no simple ensemble allows for the lattice spacing and occupancy to simultaneously relax  @xcite .",
    "incommensurability and free energy barriers get in the way .",
    "a free energy scheme based on an extended thermodynamic description is necessary to locate the equilibrium phase , but the approaches used thus far have come at a fairly high computational cost  @xcite . in this paper",
    ", we propose a more direct and efficient extended ensemble that effectively allows both the particle number @xmath10 and the box volume @xmath11 to fluctuate .",
    "we use it to solve the equilibrium properties of the canonical psm .",
    "the plan of this paper is to first revisit the psm and the basic thermodynamics of cluster crystals ( sect .",
    "[ sect : model ] ) and to introduce the simulation methodology ( sect .",
    "[ sect : method ] ) . after discussing the results ( sect .",
    "[ sect : results ] ) , a brief conclusion follows .",
    "the penetrable sphere model ( psm ) was first introduced by marquest and witten as a prototype for soft matter interactions  @xcite .",
    "it is described by a pair potential @xmath12 where the particle diameter @xmath13 sets the unit of length and the barrier height @xmath14 sets the unit of temperature @xmath1 ( @xmath15 ) with boltzmann s constant @xmath16 set to unity for notational convenience .",
    "the model can also be seen as the @xmath17 limit of the gem-@xmath4 , with pair potential @xmath18    the phase behavior of the psm has not been accurately determined , but some of its general features are reasonably well understood .",
    "based on liquid state theory arguments , one expects that systems with bounded yet harshly repulsive pair interactions , such as the gem-@xmath4 with @xmath19  @xcite , should form face - centered cubic ( fcc ) cluster crystals at high @xmath1 and number density @xmath20 .",
    "its @xmath21 lattice sites then have an average occupancy @xmath22 .",
    "density functional theory ( dft ) predicts that @xmath23 increases linearly with @xmath24 at high @xmath1  @xcite , while at low @xmath1 the fluid - solid transition approaches the hard sphere limit  @xcite .",
    "a cell theory treatment further suggests that increasing @xmath24 in the low @xmath1 regime results in a continuous evolution of the lattice occupancy  @xcite , in contrast to the series of first - order isostructural transitions and critical points observed in the gem-4  @xcite .      in order to study the behavior of cluster - crystal formers , we first review and expand a thermodynamic framework for treating multiple - occupancy lattices .",
    "the core problem with simulating these crystals is that even for very large systems the average lattice site occupancy can not generally relax to its equilibrium value once the crystal forms a lattice commensurate with the simulation box .",
    "it is only possible to introduce or withdraw planes of defects without causing elastic stress , which severely restricts the extent to which @xmath23 can be tuned .",
    "inspired by the generalized thermodynamics of systems with vacancies and interstitials  @xcite , phase rules that take into account the possibility that crystals have multiple particles occupying each lattice site have been formulated  @xcite . in order to specify an equilibrium phase , mladek _ et al .",
    "_ introduced an additional pair of thermodynamic variables : @xmath25 and an associated chemical potential - like quantity @xmath26 , roughly corresponding to the free energy penalty of inserting a lattice site .    in this expanded formulation , the constrained helmholtz free energy @xmath27 has an exact differential form @xmath28 where the chemical potential @xmath29 , the pressure @xmath30 , and the entropy @xmath31 are all implicit functions of @xmath23 , and at equilibrium @xmath32 .",
    "the constrained gibbs free energy @xmath33 has a similar differential form @xmath34 and @xmath35 .",
    "because @xmath29 and @xmath36 are functions of @xmath25 , they do not correspond to the system s equilibrium quantities unless @xmath25 minimizes the overall free energy of the system , i.e. , @xmath37 equilibrium thus occurs when the driving force for changing the number lattice sites vanishes , i.e. , @xmath38 .",
    "it is , however , much more computationally convenient to fix @xmath25 and vary @xmath10 .",
    "the free energy minimization is then applied on the per - particle quantities , @xmath39 or @xmath40 , such that @xmath41 as obtained using a generalized gibbs - duhem relation .",
    "this thermodynamic construction provides important physical insights into the equilibrium response functions of cluster crystals .",
    "the heat capacity @xmath42 , bulk modulus ( or compressibility ) @xmath43(@xmath44 ) and coefficient of thermal expansion @xmath45 , for instance , can be described as having two different physical contributions .",
    "the first comes from `` normal '' crystal relaxation , i.e. , an affine transformation under compression , and the second from clustering . for reasons that will become clearer below",
    ", the affine component is also dubbed the virial contribution .",
    "the response function is generally defined as the derivative of a thermal quantity @xmath46 ( energy , enthalpy , volume , etc . ) with respect to a changing parameter @xmath47 ( temperature , pressure , chemical potential , etc . ) . in cluster crystals ,",
    "@xmath46 itself is a function of @xmath48 , which in turn depends on @xmath47 , so @xmath49 where the two terms correspond to the virial and clustering mechanisms , respectively  @xcite .",
    "the bulk modulus of cluster crystals , for instance , @xmath50 has an additional softening contribution due to clustering . under compression ,",
    "the lattice relaxes not only by affinely reducing the lattice constant , but also by eliminating lattice sites and clustering  @xcite .",
    "analogously , the coefficient of thermal expansion @xmath51 reveals that under isobaric heating the dilation of the lattice is accompanied by a break up of the clusters themselves , which consumes some of the additional expansion .",
    "instead of calculating the thermal derivative , it is well known that response functions can also be expressed as fluctuations of thermal quantities , e.g. , @xmath52  @xcite .",
    "although formally also true for cluster crystals , special attention needs to be given to @xmath25 being held fixed in simulations . in that case",
    ", the calculated fluctuations only capture the affine contribution from the lattice .",
    "in other words , the simulation at fixed @xmath25 does not measure the fluctuation of equilibrium lattices , but of lattices constrained to the specific equilibrium occupancy at one phase point .",
    "the clustering contribution must thus be separately calculated , in order to calculate the correct equilibrium behavior .",
    "traditional simulation methods either fix the number of particles , as in constant @xmath53 or @xmath54 simulations , or the lattice spacing , as in constant @xmath55 simulations , which in all cases prevent cluster crystals from relaxing to their equilibrium @xmath56 .",
    "an ensemble that would allow both @xmath10 and @xmath11 to fluctuate may navely seem to resolve the problem , but such @xmath57 ensemble would have unbounded fluctuations .",
    "earlier simulation approaches thus employed elaborate free energy schemes in order to minimize @xmath58 and @xmath59  @xcite or equivalently to locate @xmath38  @xcite . in these schemes",
    ", locating the equilibrium structure requires tens of free energy calculations , each necessitating one to two dozens of independently sampled state points .",
    "this high computational cost limits the method s applicability to all but the simplest models . in order to reduce the computational burden and broaden the range of accessible models one should limit resorting to free energy integrations .",
    "we present below such an approach based on reformulating the expanded isothermal - isobaric @xmath0pt$ ] ensemble  @xcite .      to elucidate the @xmath0pt$ ] ensemble , it is useful to first review the generalized ( great grand canonical ) ensemble  @xcite .",
    "its trivial partition function @xmath60 derived here using a discrete state ( histogram ) formalism even for continuous variables , implicitly defines the microcanonical @xmath61 , canonical @xmath62 , isothermal - isobaric @xmath63 , and grand canonical @xmath64 partition functions .",
    "as mentioned above , in this @xmath65 ensemble no extensive quantity is specified , which results in @xmath10,@xmath66 and @xmath67 having unbounded fluctuations .",
    "an @xmath0pt$ ] ensemble can solve this last problem by constraining @xmath10 within bounds @xmath68 $ ] that ( if properly chosen ) enclose @xmath69 at the studied @xmath30 , @xmath1 , and @xmath70 .",
    "the new partition function @xmath71 has weights @xmath72 that are both explicit ( extensive ) and implicit functions of @xmath10 to control the probability of visiting states of varying @xmath10 .",
    "these weights are not known _ a priori _ , but can be self - consistently determined , as is done for the multicanonical ensemble  @xcite , the expanded ensemble parallel tempering  @xcite , and wang - landau sampling  @xcite .",
    "once the weights are determined , the joint probability of observing a state with a specific @xmath10 , @xmath11 , and @xmath67 is @xmath73 and the marginal probabilities of observing a state with specific @xmath10 and @xmath11 or with a specific @xmath10 only are , respectively , @xmath74      during a simulation , in addition to standard particle and logarithmic volume displacements  @xcite , particle insertions ( @xmath75 ) and removals ( @xmath76 ) are used . in order to preserve detailed balance , the acceptance ratios are @xmath77 where @xmath78 , @xmath79 , @xmath80 , and @xmath81 is the energy cost of inserting / removing a particle . in order to self",
    "- consistently determine @xmath82 , for each iteration @xmath83 we obtain a histogram @xmath84 that keeps track of the frequency at which each @xmath85 state is observed .",
    "after @xmath83 iterations , the normalized histogram gives the probability of observing a state @xmath86 that approximates the density of state @xmath87 and the other partition functions @xmath88 note , however , that even once the scheme has converged @xmath61 , @xmath62 and @xmath63 all lack a multiplicative constant @xmath89 , so the conjugate field that is used for the @xmath90th iteration @xmath91 also lacks an additive constant @xmath92 .",
    "the iterative procedure is repeated until the marginal distribution @xmath93 is flat within @xmath68 $ ] , i.e. , @xmath94 ( eq .",
    "[ eq : marginalp ] ) , which coincides with the convergence criterion @xmath95 for all @xmath96 $ ] .",
    "a final simulation using the converged weights constructs the equilibrium @xmath97 .",
    "this last @xmath0pt$ ] simulation is conceptually equivalent to running a series of @xmath54 simulations with different @xmath10 s , where the transition probability of hopping from one to the other is governed by @xmath98 .",
    "the weights thus capture the constrained gibbs free energy @xmath99 of the system up to a constant @xmath100 .",
    "because the equilibrium occupancy is determined by minimizing @xmath59 with respect to @xmath10 ( eq .  [ eq : minimization ] ) , the unknown constant @xmath100 , which leads to a @xmath101 term , must be obtained by thermodynamic integration at a given @xmath102 $ ] ( sect .",
    "[ app : b ] ) .",
    "pt$ ] results for the fcc cluster crystal with @xmath103 at @xmath104 and @xmath105 .",
    "the weights are initialized with the chemical potential @xmath29 at @xmath106 ( dashed line ) and converge to @xmath107 ( @xmath108 ) .",
    "the constrained gibbs free energy per particle ( solid line ) , after adding the constant shift @xmath109 , is minimal at @xmath110 .",
    "inset : the converged distribution @xmath111 is flat within the sampled bounds , fluctuating around 1/151 ( black line).,width=326 ]      for high temperature simulations , @xmath112 monte carlo ( mc ) cycles are performed for @xmath1135000 particles at each iteration .",
    "each cycle contains on average @xmath114 particle number changes , @xmath115 particle displacements and one volume fluctuation . for the crystal phase",
    ", the particles are spread over @xmath1161372 lattice sites depending on the average occupancy .",
    "a particle range of @xmath117200 is found to provide a reasonable trade off between the need to correctly estimate the equilibrium occupancy and the computational cost .",
    "the histogram of states separates volume fluctuations in 50 bins and energy fluctuations in 500 bins that span the observed range of fluctuations . for most system sizes",
    "studied , the range has @xmath118 and @xmath119 .",
    "the summation over these states is done on logarithmic scale to avoid numerical overflow  @xcite .    a good initial",
    "guess for the weights is the chemical potential of a system with @xmath102 $ ] , @xmath120 , obtained by widom insertion in a short @xmath54 simulation  @xcite . from this point on ,",
    "fewer than ten iterations are needed to converge the standard deviation of the equilibrium probability distribution within @xmath121 .",
    "even though the resulting weights are noisy for a given @xmath10 , considering the full @xmath10 range , by , for instance , fitting them with a parabola smooths out these uncorrelated fluctuations .",
    "after including the offset @xmath100 , the constrained gibbs free energy thus has an approximate form @xmath122 where @xmath123 , and @xmath124 are numerically determined .",
    "correspondingly , @xmath125 if appropriate bounds are chosen , @xmath59 is then minimized at @xmath126 $ ] .",
    "figure  [ fig : t1.5p33.4 ] illustrates this operation . starting with @xmath127",
    ", the simulation converges to @xmath128 . after including the constant offset @xmath109 ,",
    "@xmath59 is minimal at @xmath110 ( @xmath129 ) , where the error is obtained from running several optimizations of @xmath128 .",
    "the equilibrium particle number obtained by this method is in good agreement with that determined by pure thermodynamic integration , @xmath130 , following the approach described in ref .",
    "@xcite and section  [ app : b ] .",
    "this particular example also illustrates that the minimum of @xmath59 does not need correspond to that of @xmath128 , and can even be out of the chosen range @xmath68 $ ] , although for the minimization to be reliable within the accuracy reported here the range should be chosen such that the minimum does fall within those bounds .",
    "determining the equilibrium behavior from the free energy requires a fairly high degree of numerical accuracy .",
    "it is thus worth estimating the error made in this process .",
    "the typical change in weight values over the full @xmath10 interval @xmath131 , is smaller than the shift from @xmath128 to @xmath59 .",
    "for instance , over an interval of length @xmath132 , @xmath133 .",
    "the gibbs free energy per particle , which is of order @xmath134 , is determined by thermodynamic integration with an error @xmath135 .",
    "the offset constant @xmath100 will thus have an error @xmath136 .",
    "the error @xmath137 in @xmath59 is then of order @xmath138 , which is an order of magnitude larger than the variation @xmath131 . yet",
    "the position of the minimum of the curve , @xmath139 is only shifted by @xmath140 . therefore , although the error in the vertical shift of @xmath59 may be an order of magnitude larger than the shallowness of the curve itself , the position of the minimum is preserved with an accuracy comparable to that obtained from running multiple instances of the optimization .",
    "special attention needs to be drawn to use the @xmath0pt$ ] method for the psm at relatively low temperatures , @xmath141 .",
    "first , the traditional volume fluctuation algorithm , in which the positions of all the particles are affinely rescaled , is inefficient to simulate the psm .",
    "low temperature compressions of the psm , like in a system of dense hard spheres , result in additional particle overlaps , whose cost is prohibitively high . to overcome this problem",
    ", we use an alternative volume fluctuation algorithm recently developed by schultz and kofke  @xcite , which improves the sampling efficiency by nearly three orders of magnitude at @xmath142 . in the schultz - kofke algorithm ,",
    "when volume changes from @xmath11 to @xmath143 on logarithmic scale , the position of each lattice site @xmath144 is first scaled affinely as @xmath145^{1/3}$ ] , then the distance of each particle from its lattice site @xmath146 is changed as @xmath147 the modified acceptance ratio is then @xmath148 in which the effect of volume change is redistributed into the @xmath146 scaling step  @xcite , and where @xmath149 is the change in lattice energy in the @xmath144 scaling step . for step - wise discontinuous potentials like the psm ,",
    "@xmath149 is precisely zero if the particles sitting perfectly on lattice sites do not overlap before nor after a volume displacement . yet if @xmath149 were nonzero , it would scale like @xmath10 , because all the particles on neighboring lattices would go from not overlapping to overlapping .",
    "volume compressions with @xmath150 are thus rejected with overwhelmingly high probability at low temperatures .",
    "particle insertion also becomes difficult at low temperatures . for low @xmath1 crystals with an occupancy intermediate between two integers ,",
    "new particles can only be successfully inserted at the lower - occupancy positions . modified particle insertion schemes , such as the staged - insertion algorithm designed for fluid phase  @xcite , do not help , because the problem is intrinsic to the system .",
    "inserting particles requires one to randomly identify a vacancy in the crystal , which constrains the @xmath0pt$ ] approach at low @xmath1 to crystals with non - integer occupancy .",
    "once these regions are identified , psm crystals with integer occupancy can then be treated using standard @xmath54 simulations , for instance . for the @xmath0pt$ ] scheme at low @xmath1 ,",
    "the chemical potential used as initial guess for @xmath98 is obtained from staged widom insertion  @xcite , and @xmath151 mc cycles are needed at each iteration to obtain good statistics . to speed up the simulations , more particle insertions and deletions ( @xmath152 ) and ten to a hundred times",
    "fewer volume fluctuations are used in each cycle .",
    "the particle number window is also shortened to @xmath153 .",
    "yet the inherently low efficiency of particle insertion in low @xmath1 cluster crystals leaves the @xmath0pt$ ] approach less efficient than the free energy integration scheme of ref .  .",
    "only a few state points were thus equilibrated this way .",
    "the rest were obtained with the traditional approach that involves multiple thermodynamic integrations  @xcite .       at @xmath154 and @xmath155 .",
    "bottom : the radial distribution function @xmath156 at various @xmath157 shows that the crystal order is preserved along the integration path.,width=336 ]    free energy calculation from kirkwood thermodynamic integration couples the system of interest to a reference system whose free energy can be obtained exactly  @xcite . for the cluster crystal ,",
    "the potential energy of the coupled system with particles at @xmath158 is defined as in ref .",
    "@xmath159 where @xmath160 and the coupling parameter @xmath157 varies from 0 to 1 .",
    "we choose the reference system to be free particles under spherically attractive potential wells centered at the lattice sites @xmath161 with @xmath162 where @xmath163 is the size of one attractive spherical well at lattice vector @xmath144 .",
    "the free energy of the reference system at temperature @xmath1 is therefore  @xcite @xmath164 where @xmath165 is the total volume of the potential wells and the thermal wavelength @xmath166 is a constant at fixed @xmath1 and is here set to unity .",
    "the parameters @xmath167 and @xmath168 are tuned for each simulation to obtain enough fluctuations and a smooth integration path .",
    "the constrained free energy of the solid phase with a certain occupancy is then @xmath169 as illustrated in fig .",
    "[ fig : ti0.1 ]  @xcite .",
    "it is essential for the integration path to be continuous and tp show no hysteresis , as the preservation of crystal symmetry in fig .",
    "[ fig : ti0.1 ] also illustrates . for fixed @xmath170 ,",
    "free energy integrations are performed for various @xmath10 s until the equilibrium @xmath2 is identified from eq .",
    "[ eq : minimization ]  @xcite .",
    "the free energy of the fluid is obtained from thermodynamic integration from infinite temperature limit where the system is effectively an ideal gas  @xcite @xmath171 which is equivalent to setting @xmath172 in the crystal integration scheme .",
    "standard integration over density is also used @xmath173 to verify the results .      because @xmath0pt$ ] ensemble simulations rely on building the full density of state , histogram reweighting provides the thermodynamic properties of the system at neighboring @xmath1 and @xmath30  @xcite .",
    "histogram reweighting over pressure , for instance , provides @xmath174 and @xmath175 from a single @xmath0pt$ ] simulation . for",
    "each @xmath10 within the bounds , the volume @xmath11 is sampled with the conditional probability , knowing @xmath10 , at pressure @xmath30 @xmath176 the thermal average of @xmath177 configurations obtained from monte carlo sampling at pressure @xmath30 is thus @xmath178 now , suppose the simulation is run at a nearby different pressure @xmath179 .",
    "the probability of observing a state becomes @xmath180 in order to evaluate the same average quantity @xmath181 at @xmath30 , while sampling configurations at @xmath179 subject to the distribution @xmath182 , the histogram is reweighted @xmath183    for each @xmath184 , i.e. , for each @xmath10 at fixed @xmath25 , this reweighting scheme provides @xmath185 over a short pressure interval enclosing @xmath179 . by integrating @xmath186 for each @xmath184 , the constrained gibbs free energy per particle over a pressure interval follows @xmath187 for each neighboring pressure @xmath30 , @xmath188 is minimal at the equilibrium occupancy @xmath189 and the equilibrium gibbs free energy per particle @xmath190 .",
    "the corresponding equilibrium helmholtz free energy per particle @xmath191 is similarly available for neighboring densities .",
    "numerically , the volume for each @xmath10 obtained from @xmath0pt$ ] simulations is reweighted at neighboring pressures and then fitted to a third - order polynomial in pressure , before using eq .",
    "[ eq : vintegral ] .",
    "figure  [ fig : reweight ] shows an example of the resulting @xmath192 . as a rule of thumb , histogram reweighting is sufficiently accurate as long as @xmath193 remains within the bounds @xmath68 $ ] .     at ( top ) @xmath104 , around @xmath194 , and at ( bottom ) @xmath195 around @xmath196 .",
    "a constant @xmath197 has been subtracted from the free energy in order to superimpose the curves at the beginning of the interval.,title=\"fig:\",width=326 ]   at ( top ) @xmath104 , around @xmath194 , and at ( bottom ) @xmath195 around @xmath196 . a constant",
    "@xmath197 has been subtracted from the free energy in order to superimpose the curves at the beginning of the interval.,title=\"fig:\",width=326 ]      histogram reweighting over temperature similarly provides @xmath198 and @xmath199 from a single @xmath0pt$ ] simulation .",
    "one can show that the thermal average of the volume at neighboring temperatures can be calculated from the configurations sampled at @xmath200 @xmath201 to calculate the gibbs free energy at fixed @xmath30 and neighboring @xmath1 , one reweights the isobaric - isothermal partition function .",
    "although the real partition function differs from the sampling result by a multiplicative constant @xmath202 , this constant is determined by the free energy at @xmath200 by @xmath203 in a monte carlo scheme , the fraction phase space sampled @xmath204 is proportional to the number of accepted configurations @xmath177 , because these configurations are already boltzmann weighted .",
    "note that in this formulation , @xmath202 absorbs the normalization by the total number of the samples considered . for instance , if the algorithm is ran twice as long , @xmath202 is halved .",
    "the sampling partition function at neighboring temperatures is thus @xmath205 and the corresponding constrained gibbs free energy for each @xmath10 is @xmath206 sample reweighting results are shown in fig .",
    "[ fig : reweight ] .      identifying the phase coexistence region",
    "requires the free energies of the cluster crystal and fluid phases nearby . for the solid phase ,",
    "the free energy is obtained at various temperatures using @xmath0pt$ ] simulations , thermodynamic integration , and histogram reweighting , as described in the previous sections .",
    "the free energy of the fluid phase , which does not suffer from the same occupancy ambiguity , is straightforwardly obtained from standard free energy integration techniques  @xcite . for @xmath207 near coexistence , however , standard monte carlo sampling of the fluid phase results in long correlations between the configurations .",
    "the few particle overlaps present in those conditions do not easily relax because the dense fluid only rarely opens large enough gaps . in this regime , longer simulations with @xmath208 mc cycles are necessary to estimate the equilibrium quantities .",
    "the fluid - solid phase coexistence at a specified @xmath1 is obtained by common tangent construction of the transformed free energy @xmath209 . by an appropriate choice of constant @xmath210 , the curvature of the helmholtz free energy at coexistence",
    "can be enhanced  @xcite . because @xmath211 a common tangent construction also provides the chemical potential and pressure of the two phases concerned . in order to better trace the coexistence line on the phase diagrams ,",
    "its slope is also calculated at a few points . for the @xmath30-@xmath1 projection ,",
    "the standard clausius - clapeyron relation can be used @xmath212 where @xmath213 and @xmath214 are , respectively , the per particle volume and entropy difference between the two phases across the transition .",
    "the latter quantity is obtained from the free energy results . for the @xmath1-@xmath24 projection ,",
    "each phase has @xmath215 for the fluid branch , the response functions are directly obtained from fluctuation identities  @xcite .",
    "the compressibility is accessible from fluctuations in @xmath10 for @xmath216 simulations , or in @xmath11 for @xmath54 simulations @xmath217 while the coefficient of thermal expansion is estimated from the covariance between @xmath11 and enthalpy @xmath218 for @xmath54 simulations @xmath219 as discussed in sec .",
    "[ subsect : response ] , for cluster crystals the fluctuation ( virial ) contribution is insufficient .",
    "the full derivatives for the solid branch is instead obtained by numerically differentiating the equilibrium results or by reweighting the @xmath0pt$ ] simulation results performed at the equilibrium pressure and temperature as discussed in sec .",
    "[ sec : reweight ] .",
    "using the methods described in the previous section the structure and properties of the crystal phase and of the fluid - crystal coexistence of the psm model are examined .",
    "we first identify the equilibrium cluster crystal occupancy @xmath2 at different phase points .",
    "qualitatively , @xmath189 increases with density and pressure , and at fixed pressure the number of particles per cluster decreases with increasing temperature as new lattice sites are formed .",
    "quantitatively , at fixed high t , @xmath2 grows roughly linearly with density , while at fixed density , it grows linearly with temperature ( fig.[fig : nc](a ) ) .",
    "if viewed as a function of @xmath24 and @xmath1 , @xmath220 has a bilinear form @xmath221 with positive @xmath222 and @xmath223 , and a small @xmath224 .",
    "the dft prediction , @xmath225  @xcite , is qualitatively comparable with the coefficients obtained from fitting the simulation results ( fig  [ fig : nc](a ) ) , but in order to capture the clustering behavior for temperatures as low as @xmath3 , quadratic corrections are necessary . as @xmath1 is further lowered , @xmath2 plateaus at integer occupancy values , which we denote fcc(@xmath56 ) . at @xmath226 , however fcc(@xmath23 ) with integer @xmath227 is again only stable at a single density @xmath228 , where @xmath229 is the crystal close packing density of hard spheres .",
    "for @xmath230 the ground state is a random mixture of sites with occupancy @xmath23 and @xmath231 , because all cluster arrangements are degenerate ( fig.[fig : nc](b ) ) .",
    "what about intermediate temperatures ? in the gem-4 ,",
    "transitions between cluster phases with different integer occupancy fcc(@xmath23)fcc(@xmath231 ) was found to become first order below an isotructural critical point  @xcite .",
    "although a simple phonon analysis suggests that a similar type of transition may be possible in any cluster - forming system at low enough temperature  @xcite , no such transition is observed here .",
    "this point deserves further consideration . for",
    "the small integer occupancy studied , a multiply - occupied lattice site is effectively a large coarse - grained particle whose size is related to the lattice constant @xmath222 . to obtain a first order isotructural transition , i.e. , demixing of fcc(@xmath23 ) and fcc(@xmath231 ) phases ,",
    "a large enough size heterogeneity between sites of different occupancy is necessary for the free volume gained to overcome the entropy of mixing , as in binary hard sphere mixtures  @xcite . otherwise , the sites with occupancy @xmath23 and @xmath231 randomly mix . for the psm , the evolution of the lattice constant in fig .",
    "[ fig : nc](b ) indicates that the largest lattice difference between fcc(1 ) and fcc(2 ) is smaller than @xmath232 at @xmath142 .",
    "because this difference goes to zero at @xmath226 , its relatively rapid shrinking with @xmath1 may be sufficient to prevent isostructural phase separations , although it can not be excluded altogether .",
    "this qualitative distinction between the gem-4 and the psm reflects the sensitive dependence of isostructural transitions on the details and convexity of the interaction potential  @xcite .",
    "the relatively long tail of the gem-4 interaction indeed results in an additional energetic contribution to the lattice constant , and overcomes the entropy of mixing at low enough @xmath1 .",
    "for gem-@xmath4 with @xmath233 , one expects the threshold lattice constant difference between lattices with occupancy @xmath184 and @xmath234 to also depend on @xmath1 via the entropy of mixing .",
    "qualitatively , we expect the isostructural critical point to steadily decrease with the increase of @xmath4 and @xmath23",
    ". a better knowledge of the drive for binary hard sphere mixtures of different size ratios to demix would be needed to estimate the equivalent behavior in the gem-@xmath4 .    with the equilibrium occupancy at hand ,",
    "we study how the number of particles on a given site fluctuates in various @xmath1 regimes .",
    "this quantity is particularly important in determining which of the basic theoretical approximation is most analytically reasonable .",
    "overall the relative fluctuation decreases with increasing temperature and density , but this progression is not monotonic ( fig .",
    "[ fig : nc ] right ) . at low temperatures ( @xmath141 ) ,",
    "a system with an equilibrium occupancy intermediate between two integers @xmath235 can be seen as a random mixture of sites with occupancy @xmath236 and occupancy @xmath237 .",
    "excitations creating @xmath238 or @xmath239 defects are strongly suppressed . in that limit",
    ", the problem can be solved analytically .",
    "the probability of a site having @xmath240 ( @xmath237 ) particles is @xmath241 ( @xmath242 ) , and the resulting variance is @xmath243 .",
    "the @xmath142 results agree very well with this approximation ( fig .  [",
    "fig : nc](c ) ) .",
    "this behavior explains why the mean - field cell model works increasingly well with decreasing @xmath1 and nearly quantitatively for @xmath244 . as temperature increases ,",
    "fluctuations become more pronounced , and vary continuously with occupancy . in this limit",
    "the crystal behavior is better approximated by a dft - type treatment in which the free energy is optimized with respect to occupancy and fluctuations , assuming a gaussian distribution  @xcite .     and its virial contribution @xmath174 ( eq .  [ eq : kappa ] ) at @xmath245 and @xmath142 ( inset )",
    ". the virial part @xmath174 is significantly softened by the cluster contribution , except in the low @xmath1 plateau regime ( @xmath246).,width=336 ]        as determined in earlier studies  @xcite , the bulk modulus of cluster crystals , once decomposed into its two constituents ( sect .",
    "[ subsect : response ] ) , shows a strong softening correction due to the creation / annihilation process of lattice sites at high temperatures ( fig .",
    "[ fig : bulkmodulus ] ) .",
    "but in the integer occupancy regime , such as at @xmath142 for @xmath246 , the virial part is the full resistance to external compression  @xcite .",
    "the two contributions to the coefficient of thermal expansion can be similarly calculated . at @xmath245 and @xmath195 , for instance , calculations of the different components of eq .",
    "[ eq : alpha ] agree with each other and with the decomposition ( table  [ table : alpha ] ) .",
    ".calculation of @xmath45 at @xmath247 and @xmath195 with @xmath248 using @xmath249 a fit of the @xmath250 - 5.0 results ( fig .",
    "[ fig : nc ] ) , @xmath251 multiple @xmath54 simulations with @xmath252 , @xmath253 multiple @xmath54 simulations with @xmath2 determined in @xmath249 , @xmath254 histogram reweighting ( fig .",
    "[ fig : reweight ] ) , @xmath255 histogram reweighting ( eq .  [ eq : mcvolumet ] ) , @xmath256 a direct @xmath0pt$ ] simulation ( eq .  [ eq : mcvolumep0 ] ) , and @xmath257 the fluctuation identity ( eq .",
    "[ eq : alphafluc ] ) .",
    "[ cols=\"^,^,^,^\",options=\"header \" , ]     [ table : alpha ]      the fluid - crystal transition , which is the only phase transition in the psm , is extracted from the equilibrium free energies of both phases .",
    "the high and low @xmath1 regimes are treated separately , because the underlying physics is markedly different above and below the onset of clustering at coexistence around @xmath258 .    at high @xmath1 ,",
    "the coexistence regime on the @xmath1-@xmath24 phase diagram and the coexistence pressure on the @xmath30-@xmath1 phase diagram decreases smoothly towards @xmath258 . at melting @xmath259 increases roughly linearly with @xmath1 , because the coexistence density itself increases roughly linearly with @xmath1 , as discussed above ( fig .",
    "[ fig : phasediagram ] ) .",
    "dft results capture the transition relatively well for @xmath260 , but strongly deviate below that point  @xcite . yet attributing the deviation to a stronger hard - sphere character below that @xmath1  @xcite , is not supported by the numerical results , so another physical assumption of the theory",
    "may then be breaking down .    for @xmath261 at coexistence , two conflicting descriptions have previously been suggested ( fig .  [",
    "fig : phasediagram ] ) .",
    "first , a mixed dft ( fluid ) and cell theory ( crystal ) study predicted that the fluid - solid transition continuously approaches the hs limit upon lowering @xmath1  @xcite .",
    "although the solid free energy was found to be indistinguishable from the hs results at finite temperatures , changes to the fluid phase resulted in a steady drift away from the hs behavior for @xmath262 .",
    "second , a full dft treatment predicted a crossover temperature from a hs - like coexistence to a different regime around @xmath263  @xcite .",
    "we find the second scenario to be qualitatively correct , although its predicted crossover temperature is nearly three times larger than the numerically determined one . for @xmath258 ,",
    "the coexistence crystal density gets smaller than the hs close packing density @xmath229 .",
    "clustering then gets suppressed and the fluid - solid coexistence curve is inflected . below @xmath264 , the fluid coexists with an essentially singly - occupied fcc phase .",
    "the transition is hard sphere - like with the corresponding coexistence pressure and densities ( fig .",
    "[ fig : phasediagram ] ) .    that there should be a crossover",
    "can physically be understood from the fact that at @xmath265 particle overlaps are rare and uncorrelated .",
    "they therefore marginally stabilize both the fluid and crystal phases in a similar way .",
    "once the concentration of overlaps becomes sufficiently high , however , the difference in structure between the ordered and disordered phases matters .",
    "this distinction between the high and low @xmath1 regime also has a dynamical signature  @xcite .",
    "collisions between particles can be divided in two types : soft refractive collisions , in which a particle goes through another , and hard reflective collisions , in which particles elastically bounce back from each other . at temperatures @xmath266 from molecular dynamics simulations  @xcite or @xmath267 from an enskog - type theoretical analysis  @xcite , the first collision type is highly suppressed because the particle momenta are low , and the collision frequency of the second type is as high as in hard spheres .",
    "unlike for the gem-4 model , where first - order phase transitions between integer - occupancy lattices are observed at low @xmath1 , crystal lattice occupancy in the psm changes continuously .",
    "the stability regime of integer - occupancy phases , such as fcc2 and fcc3 , only occupies a narrow slice of the phase diagram at low temperatures . above @xmath258",
    ", these phases join the continuum of non - integer - occupancy crystals whose @xmath1-@xmath24 stability regime is but a line that extends smoothly up to the liquid - solid coexistence boundary .",
    "the cell model fails to capture this regime s behavior ( fig .",
    "[ fig : phasediagram ] ) .",
    "it notably erroneously predict the existence of an intermediate single - double - triple occupancy regime ( @xmath268 in fig .",
    "[ fig : phasediagram ] ) .",
    "the limited extent of occupancy fluctuations at this low @xmath1 ( fig .",
    "[ fig : nc](c ) ) shows that such high - energy excitations are unphysical .",
    "simulations indeed clearly delineate the single - double from the double - triple occupancy regimes .",
    "in this paper , we have reformulated the extended thermodynamics of cluster crystals such that it lends itself to @xmath0pt$ ] ensemble simulations  @xcite . using this approach and thermodynamic integration",
    ", we efficiently determined the phase diagram of the canonical penetrable sphere model , which forms cluster crystals at high densities .",
    "the @xmath0pt$ ] ensemble approach naturally allows for histogram reweighting , which was here used to calculate the response functions , and could be particularly useful for studying the critical properties of cluster crystal formers , such as the gem-4 .",
    "the resulting formalism and method are analogous to a constant pressure version of the approach used for determining the binary hard sphere mixture phase diagram  @xcite , which it should be able to calculate with some adjustments .",
    "the approach also allows for the study of models that form crystals in which the vacancy concentration is relatively large , such as hard cubes  @xcite .",
    "the key limitation for these implementations is the need for an efficient particle insertion algorithm and a good initial guess of the conjugate field .",
    "we gratefully thank n. wilding for numerous discussions and particularly for the key suggestion that the @xmath0pt$ ] approach may be useful to the study of cluster crystals .",
    "we also thank d. frenkel , r. jack , and b. mladek for discussions at various stages of this project .",
    "we acknowledge national science foundation grant no .  nsf dmr-1055586 ."
  ],
  "abstract_text": [
    "<S> certain models with purely repulsive pair interactions can form cluster crystals with multiply - occupied lattice sites . simulating these models equilibrium properties </S>",
    "<S> is , however , quite challenging . here </S>",
    "<S> , we develop an expanded isothermal - isobaric @xmath0pt$ ] ensemble that surmounts this problem by allowing both particle number and lattice spacing to fluctuate . it is particularly efficient at high @xmath1 , where particle insertion is facile . using this expanded ensemble and thermodynamic integration </S>",
    "<S> , we solve the phase diagram of a prototypical cluster - crystal former , the penetrable sphere model ( psm ) , and compare the results with earlier theoretical predictions . at high temperatures and densities , the equilibrium occupancy @xmath2 of face - centered cubic ( fcc ) crystal increases linearly . at low temperatures , although @xmath2 plateaus at integer values , the crystal behavior changes continuously with density . </S>",
    "<S> the previously ambiguous crossover around @xmath3 is resolved . </S>"
  ]
}