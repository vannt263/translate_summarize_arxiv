{
  "article_text": [
    "the temperature anisotropies of the cosmic microwave background radiation ( cmb ) , and recently the polarisation anisotropies , have been used to constrain a set of cosmological parameters to establish a standard model of the universe ( @xcite , @xcite , @xcite , @xcite , @xcite , @xcite , @xcite , @xcite ) .",
    "the emphasis has now moved from revealing the contents and structure of the universe to explaining the unknown physics that generated them .",
    "underpinning the standard model is the paradigm of inflation , which hypothesises a period of super - luminal expansion at very early times and identifies gaussian , scale - free quantum fluctuations as the seeds of large - scale structure .",
    "inflation models are predicted to uniquely generate tensor perturbations to the metric in the form of a stochastic gravitational - wave background that generates a divergence - free  b - mode \" polarisation pattern in the cmb that is not generated by scalar perturbations ( @xcite ; @xcite ) .",
    "the amplitude of the b - mode signal is inflation model dependent but is generally predicted to be orders of magnitude smaller than the temperature anisotropy .    in order to detect such a subtle signal , we must build experiments of much greater sensitivity than has been possible so far .",
    "due to the physical limits on the sensitivity of individual detectors , the next generation of cmb polarisation experiments aim to achieve this by using very large arrays of detectors .",
    "for example , the q / u imaging experiment ( quiet ) is operating in its first phase with 91 detector horns , each of which produces 4 independent measurements ( 2 of q and 2 of u ) , and is planned to move to a 1500 horn arrangement in its second phase .",
    "other examples include the balloon - born spider , which will operate with 1024 detectors in its largest band @xcite , ebex @xcite which will use 1440 detectors over three bands and the ground based polarbear @xcite , which will use a total of 1274 detectors .",
    "the trend is the same for high - resolution temperature anisotropy experiments , such as apex - sz , which is operating with 330 detectors @xcite , the atacama cosmology telescope ( act ) , which has begun operating with @xmath2 detectors per band @xcite , and the south pole telescope , which has 465 in its largest band @xcite .    to detect b - modes using the new generation of experiments , tight control of experimental systematics",
    "will be required .",
    "one of these systematics is correlated noise .",
    "detectors display long term noise drifts that are characterised by a @xmath0 power spectrum , resulting in correlated noise in the time - streams .",
    "in addition to this , ground - based experiments see an even larger @xmath0 noise sourced from atmospheric fluctuations , which may have a polarised element @xcite .",
    "these noise sources can also be correlated between detector time - streams , for example through detector read - out electronics and due to the spatial correlation of atmospheric fluctuations projecting onto the focal plane .",
    "it is requisite of data analysis methods to characterise and reduce the effects of noise and systematic errors .",
    "the pipeline involves a number of steps of radical data compression .",
    "the raw output from the telescope detectors is time - ordered data ( tod ) , a massive dataset that contains signal varying with the telecope pointing information .",
    "tod is compressed into a dataset of manageable size and in the natural form for a sky varying signal - a sky map . from the sky map",
    ", we estimate the set of angular power spectra , including the decomposition of the polarisation field into e and b - mode amplitudes ( accounting for spatial systematics such as foregrounds ) , from which we estimate cosmological parameters .",
    "the best place to remove correlated noise and time - variant systematic errors is in the map - making step .",
    "the two principle approaches to map - making for cmb experiments are the maximum - likelihood ( m - l ) methods ( @xcite , @xcite , @xcite , @xcite ) , which produce optimal maps slowly , and tod filtering , which is used with monte - carlo pseudo - c@xmath3 methods ( @xcite , @xcite ) and is very fast but necessarily sub - optimal .    the m - l algorithms produce optimal maps in that they minimise the noise whilst completely preserving the signal . the whole pipeline from time - ordered data to power - spectrum can be optimal and maximum - likelihood , including tod noise estimation @xcite and power - spectrum estimation ( @xcite , @xcite ) , the latter of which uses the analytic pixel - noise covariance matrix .",
    "this approach has been used very successfully and can be extended to include information on systematics @xcite .",
    "contemporary m - l codes , such as roma @xcite and mapcumba @xcite , do not require explicit evaluation of the pixel - noise covariance matrix or its inverse ( known as the  weight matrix \" ) , and have been convincingly demonstrated as viable options for single - detector planck data analysis including polarisation ( @xcite , and references therein ) .",
    "a m - l code that includes detector correlations , called sanepic , has recently been developed and successfully applied to the blast dataset @xcite , a short duration balloon experiment involving hundreds of detectors .",
    "as future data - sets become very large , the m - l algorithm becomes increasingly difficult to implement .",
    "the method may be tenable for some massively multi - detector experiments , but will require massive and expensive computing platforms and very long computation times .",
    "the later stages of cmb data analysis require information on noise power and correlation and the propagation of systematics in the maps that is effectively supplied by passing hundreds of monte - carlo simulations through the map - making pipeline ( eg : @xcite ) .",
    "the m - l algorithm is not suited for such tasks , creating the need for fast methods that can be used on medium - sized computing platforms and used over and over again .",
    "such methods could be used to complement the m - l algorithm in analysis pipelines , or even to replace it if their performances become close to optimal .",
    "the common alternative to m - l map - making is to apply a high - pass pre - whitening filter to the tod .",
    "the noise part of filtered tod is uncorrelated , so a map with uncorrelated noise can be returned by averaging the filtered tod corresponding to each pixel ( a naive map ) .",
    "this fast method is very well suited to monte - carlo simulations , but critically distorts the signal part of the tod .",
    "the master method @xcite mitigates this effect by evaluating a filter transfer function from monte - carlo signal - only realisations that can be deconvolved in multipole space .",
    "this approach is non - optimal and introduces extra variance into the power spectrum estimates , especially at low-@xmath4 where the primordial b - mode signal is expected .",
    "the destriping method is being developed as a  third way \" to cmb map - making ( @xcite , @xcite , @xcite , @xcite , @xcite , @xcite , @xcite ) . destriping pre - whitens the tod by approximating the low frequency noise part as a series of offset functions , which are then subtracted from the tod .",
    "long baseline noise drifts from @xmath0 noise are subtracted without filtering the signal part of the tod .",
    "the method is faster than m - l map - making and is tuneable in that the offset function length can be varied , resulting in fast and dirty maps or slow and near optimal maps .",
    "most destriping codes exploit the great - circle scanning strategy of satellite experiments to subtract long offset functions that are averages of the tod in one re - pointing ( see eg : @xcite for a discussion ) .",
    "the madam code @xcite , was the first to incorporate noise information , through a prior on the offset function amplitude distribution that permits the use of short offset amplitudes .",
    "a variant of destriping that does not use noise information has recently been applied to total - intensity data from act to produce sunyaev - zeldovich ( sz ) effect maps of galaxy clusters , using destriping baselines to model the inter - detector common - mode atmospheric noise @xcite .    in a previous paper @xcite",
    ", we showed that destriping with short baselines using noise information is near - optimal when applied to non - circular scanning strategies , such as the cross - linked , azimuth only scans of ground - based experiments . in this paper , we extend the destriping algorithm to include information on noise correlations between detectors and investigate the performance of our new code , the destriping cartographer ( descart ) , as applied to multi - detector tod simulations .",
    "for these simulations , the q and u signals are not modulated to the high - frequency white noise part of the spectrum , as is the case for half - wave plate modulation experiments , and are contaminated with @xmath0 noise .",
    "we compare it to the master method with filtering , the established fast map - making method , to determine the strengths and limitations of the filtering approach for realistic future data - sets .    given the importance of computation time for large data - sets , we also investigate the algorithmic scaling of descart as applied to a large full - season multidetector data - set .",
    "we concentrate on polarisation measurements for b - mode experiments .",
    "the descart algorithm is also applicable to multi - detector sz experiments , which we plan to investigate in a future paper .",
    "this paper is organised as follows : in  [ destriping and filtering section ] , we review map - making formalism of filtering and destriping in the context of mult - detector polarisation data ; in  [ comparison of the pipelines section ] , we directly compare the filtering and destriping pipelines through simulations for a range of noise scenarios , comparing errors in timestreams , maps and e and b - mode angular power spectra ; and in  [ quiet simulations section ] , we apply descart to a much larger simulation of a massively multi - detector experiment , focussing on algorithmic scalings and the partitioning of the analysis .",
    "the map - making problem requires a solution for a sky map , @xmath5 , given detector time - streams @xmath6 , pointing information and possibly noise information .",
    "the time - ordered data ( tod ) is modelled as @xmath7 where @xmath8 is a pointing matrix that contains all of the relevant pointing information , @xmath9 indexes time and @xmath10 indexes sky pixel .",
    "the noise time - stream @xmath11 is commonly assumed to be gaussian and piece - wise stationary , satisfying @xmath12 in general , @xmath11 is correlated noise , such that ( [ tod covariance ] ) is not diagonal . if the noise is stationary , its covariance ( [ tod covariance ] ) is well described as symmetric toeplitz , or as a function of separation @xmath13 .",
    "if the instrumental beams are symmetric , the pointing matrix for a temperature measurement @xmath8 is composed of 1s and 0s and contains only one non - zero element per time row indicating which sky pixel the beam centre falls upon .",
    "this basic framework can be extended to multiple detectors and to measurements of polarisation . in the experimental configuration",
    "we simulate in this paper , each detector  pixel \" makes direct measurements of q and u stokes parameters in its own frame of reference . the rotation from sky to detector frame of reference",
    "is subsumed into the pointing matrix @xmath14    for simplicity in notation , we define the pointing matrix for detector - q time - streams as @xmath15 and for detector - u time - streams as @xmath16 . from this point",
    "we drop the distinction between them and consider @xmath17 as the appropriate pointing matrix for the time - stream indexed by @xmath18 .",
    "the map on which the polarisation pointing matrices operate contains maps of the q and u stokes parameters , concatenated end - to - end @xmath19 .    for multiple time - streams",
    ", we stack the polarisation pointing matrices , data and noise time - streams end - to - end to produce the multi - detector analogue to the data model , @xmath20    given the data model , we can construct estimators for the sky map @xmath21 .",
    "the m - l solution to the map - making problem is @xmath22 where @xmath23 is the transpose of @xmath24 and has the effect of summing tod into a map , rather than projecting a map onto tod . in the limit",
    "that we consider the tod noise to be white ( uncorrelated ) , the solution becomes very simple , corresponding to naive binning and averaging , @xmath25      the maximum - likelihood method can be approximated by the destriping algorithm ( @xcite , @xcite and references therein ) .",
    "the noise vector @xmath26 is modelled as being composed of two components : uncorrelated ( or _ white _ ) noise ; and a series of discrete offset functions that represent all of the correlated noise .    with @xmath27 representing the random gaussian realisation of white noise , the new data model for a single detector",
    "is @xmath28 where the matrix @xmath29 maps a set of basis functions , with amplitudes @xmath30 , onto the time - stream .    for multi - detector systems , we generalise the basis function amplitude vectors by concatenating them into a vector @xmath31 , and defining a block - diagonal multi - detector offset pointing matrix @xmath32 the simplest choice of basis function is a constant offset @xmath33 where @xmath34 is a chunk of the time - stream with length @xmath35 . with this definition ,",
    "@xmath36 becomes a vector of constant offsets , with amplitudes @xmath37 , approximating the correlated noise .",
    "more complicated basis functions can be chosen , for example fourier series or legendre polynomials @xcite , though we focus on using short uniform baselines .",
    "the amplitudes @xmath37 will be gaussian random numbers satisfying @xmath38 with @xmath37 as a second set of parameters , the posterior for both the map and the offset amplitudes is @xmath39 where we have used the fact that the cmb map and the offset amplitudes are completely independent .",
    "we do not wish to assume any prior for the cmb map , so we consider @xmath40 to be constant .    the next step is to decide what prior information on the amplitudes to include through @xmath41 .",
    "if we have an estimate of the power spectrum of the correlated noise , which the offset functions are designed to approximate , we can include prior information through the offset covariance matrix @xmath42 .",
    "the probability distribution for the offsets is gaussian @xmath43 where @xmath42 is the covariance of the offset amplitude estimates ( ignoring factors of @xmath44 ) .",
    "if we have prior knowledge of @xmath45 , we can build a prior @xmath42 through @xmath46    the joint posterior is a product of two gaussians : the likelihood of the data and the prior for the amplitude estimates .",
    "we can maximise the posterior by minimising the function @xmath47 , where @xmath48 solving @xmath49 , we obtain an expression for the map @xmath50 this result can be understood as follows : the correlated noise @xmath51 is subtracted from time - stream @xmath52 , leaving a time - stream composed of only signal and white noise , which is naively averaged into a map ( the maximum - likelihood map for a time - stream with uncorrelated noise is the pixel average ) .",
    "to determine the offsets , we begin by substituting ( [ destriped_map ] ) into ( [ simple destriping chisq ] ) and gathering all the terms involving the pointing matrix @xmath24 into a new operator , @xmath53 , @xmath54 where @xmath55 and @xmath56 is the identity matrix .",
    "@xmath53 is a signal cleaning operator that estimates the naive map from the timestream ( including both signal and any noise that is indistinguishable from signal ) and removes it .    solving @xmath57",
    ", we obtain an estimator for the offset amplitudes @xmath58    this is an inverse problem like that of the maximum likelihood algorithm .",
    "the system can be solved quickly , using the preconditioned conjugate gradients method , at a fraction of the processing time required to solve for the full maximum - likelihood map .",
    "an effective preconditioner @xmath59 , can be constructed and applied easily from the offset prior covariance matrix @xmath60 destriping solves the map - making problem by making an approximate model for the noise . in the limit that the offset functions perfectly model the correlated noise ,",
    "the map solution _ is _ the maximum - likelihood map .      for multi - detector systems with noise",
    "uncorrelated between time - streams , the noise covariance matrix , @xmath45 , will be non - zero only in diagonal detector - detector blocks ( which themselves will be symmetric toeplitz ) .",
    "cross - correlated noise will have non - zero off - diagonal detector - detector blocks in its @xmath45 which will lead to non - zero diagonal block in @xmath42 through equation ( [ definition of prior ] ) .",
    "the inversion of the @xmath42 is achieved by using some simplifying assumptions . to a good approximation ,",
    "the individual detector blocks can be considered to be circulant and can be inverted individually very easily .",
    "a circulant matrix becomes diagonal in fourier space and each fourier mode @xmath61 , which is independent , can be inverted as a scalar . in the presence of non - zero off - diagonal detector blocks ,",
    "each mode becomes an independent @xmath62 matrix , which we invert using cholesky decomposition .",
    "this is the same approach as is used in inverting the multi - detector noise matrix in sanepic : @xcite .",
    "this entails the inversion of @xmath63 matrices of dimension @xmath64 each , once , before the iterations begin , an @xmath65 operation .",
    "the resultant matrix @xmath66 still has diagonal detector @xmath67 blocks in fourier space , so the matrix multiplication @xmath68 are conducted in fourier space to minimise the operation count @xmath69 here the vectors @xmath70 and @xmath71 are multi - detector vectors of offsets , and the matrix @xmath72 is either @xmath73 for the matrix application or @xmath59 for the preconditioning step .      filtering approaches to map - making apply a time - domain filter to tod in order to suppress noise or systematics in the time - stream , before naively binning the now uncorrelated timestreams . for a filter @xmath74 ,",
    "the map estimate is @xmath75    in this paper , we consider the effect of aggressive filters intended to suppress correlated noise rather than filters specific to experimental systematics .",
    "one choice of filter to suppress correlated noise is the prewhitening filter @xmath76 , where @xmath77 is the white noise standard deviation .",
    "the covariance of the tod filtered in this way is diagonal ( @xmath78 ) .",
    "another common choice is the _ overwhitening _ filter , @xmath79 filter , which further suppresses low frequency noise .",
    "the filter convolution is applied in the fourier domain , where @xmath45 is diagonal .",
    "this requires a fourier transform pair to be applied to the timestream , both of which have an operational scaling of @xmath80 , where @xmath81 is the number of tod and @xmath82 is the length of the segments over which the noise is stationary and correlated ( for example the length of a constant elevation scan ) .",
    "both of the pipelines used in this paper construct the final map using a naive binning step .",
    "the noise covariance of maps constructed using naive binning is @xmath83 where @xmath84 is the covariance of the tod . for the filtering pipeline , @xmath85 , which for the prewhitening filter is diagonal and",
    "produces a diagonal pixel covariance .    in the destriping pipeline ,",
    "two sets of parameters are solved for ; the map and the offset amplitudes . the fisher matrix for the full parameter set is @xmath86 where @xmath47 is the posterior in ( [ simple destriping chisq ] ) .",
    "inverting this matrix by partition gives the noise covariance of the destriped maps    @xmath87    which can be solved for low - resolution maps of large angular scales @xcite .",
    "this solution assumes that the destriping data model is correct - that the correlated noise is perfectly described by the offset functions . whilst this is an acceptable approximation for short offset function lengths , it breaks down for long baseline functions . in this regime , unmodelled correlated noise contributes significantly to the map covariance .",
    "the quantity that destriping tries to measure is the average of the noise in a segment of the tod , often referred to as the  reference baseline \" , defined by @xmath88 where @xmath89 is noise - only tod .",
    "the covariance described by equation ( [ destriping covariance ] ) is from the error between the baseline amplitudes estimated by ( [ amp_destr ] ) and these reference baselines .",
    "if this error is uncorrelated with the unmodelled correlated noise within a tod segment , as it is for our simulations ( see  [ timestreams and maps section ] ) , we can account for the unmodelled noise by adding a correction term @xmath90 to the covariance matrix ( [ destriping covariance ] ) ,    @xmath91    where @xmath42 is the offset prior and @xmath45 is the tod noise covariance . for the symmetric toeplitz @xmath45 and @xmath42 we consider , @xmath92 is also symmetric toeplitz .",
    "the implementation of ( [ matrix simplification 1 ] ) requires an @xmath93 summation , where @xmath94 is the correlation length of the reference - offset subtracted timestream .",
    "any correlation in this timestream is due to unmodelled @xmath0 and has a short correlation length .",
    "the descart code in which we implemented the above algorithm is written in fortran and uses mpi for communication ; this ensures scalability to the largest available systems .",
    "the communication operations occur when generating and distributing the collective naive map for the current iteration , and when correlating horns in a scan .",
    "we minimize the memory usage of the code with a juggling of the data .",
    "when all the timestreams that might be correlated ( those within a single scan ) are loaded they are immediately used in two ways : added to an accumulated naive map , and reduced into baseline offsets .",
    "they are then discarded .",
    "the application of the prior and likelihood matrix operations during the pcg requires only a single allocated one - detector timestream at a time ( per process ) .",
    "finally , when the best - fit offsets have been computed , they are converted directly into a map ( which represents the correlated noise in the original naive map ) .",
    "deducting this from the first map yields the output map . at no point",
    "do we allocate full timestreams . with this modification descart",
    "can process @xmath95 one - hour timestreams per 2-gb ram process for typical baseline lengths .",
    "this increases markedly if multiple time - streams are associated with the same horn .    as currently constituted",
    "the code is not much slower than generating naive maps for larger runs , since simply loading the data takes a significant proportion of the run time .",
    "in this section , we analyse the comparative performance of the filtering and destriping pipelines as applied to simulations of a constant elevation scanning multi - detector telescope .",
    "we begin by analysing time - stream and map domain errors , the latter for which we use the root - mean - square ( rms ) residual as the comparative statistic .",
    "we proceed to analysing spherical harmonic domain systematics and errors , for which we need to estimate the e and b mode angular power spectra . for this task",
    "we use the monte - carlo approach of @xcite , generalized for polarization power spectra as in @xcite such that estimators do not mix e and b modes .",
    "e to b mixing is mitigated by applying an apodizing window function to the estimated maps .",
    "the window function we use is a symmetric circular cosine apodisation around the map centre .",
    "the apodization is the same as that used in our previous paper @xcite , to which we refer the reader for details .",
    "the method requires estimation of the power spectral noise bias @xmath96 through monte - carlo ( mc ) noise only simulations and estimation of the filter transfer function @xmath97 through signal only simulations .",
    "finally , we analyse the statistical significance of the b - mode detection provided by the two pipelines .",
    "figure [ filters plot ] shows the range of filters investigated in the filtering pipeline .",
    "these comprise prewhitening ( @xmath98 ) and overwhitening ( @xmath99 ) filters , for low frequency noise suppression , and a scan frequency filter , used for the suppression of scan - synchronous systematics .",
    "the destriping results in this section make use of inter - timestream noise correlation information .",
    "the benefit of including these correlations is dependent on the experimental set - up and for the polarised dataset we simulated , the noise reduction when including the correlation was small .",
    "for other systems , including this information may be important .",
    "when applying the algorithm to simulated data in  [ quiet simulations section ] , correlation information was ignored as the experiment has negligible inter - detector correlated @xmath0 .",
    "the choice of destriping length is informed by the noise @xmath100 : as we are incorporating prior noise information , a choice of destriping length @xmath101 is used to to approximate the optimal m - l map as closely as possible .",
    "time - ordered data was simulated for a variety of noise cases , shown in table [ parameters ] , using a one - day scanning strategy comprising four constant elevation scan sets .",
    "this scan is a typical observation of a single non - galactic field from an observatory in the chanjnantor scientific reserve in chile . at a sampling frequency of @xmath102-hz , the total integration time for the scans",
    "were 6 hours and 38 minutes .",
    "we simulated an instrument with a gaussian symmetric beam with fwhm@xmath103 and a focal plane consisting of 19 horns arranged in a hex pattern , each producing 2 time - streams .",
    "we show this arrangement in figure [ hits map ] .    for each noise case",
    ", we generated 100 signal - plus - noise and 100 independent noise - only realisations .",
    "each realisation consisted of 38 time - streams , with gaussian cross - correlated @xmath0 noise , gaussian white noise , and an independent cmb signal realisation produced using synfast @xcite from the input @xmath1s used in our previous paper ( @xcite , for which the tensor to scalar ratio @xmath104 ) .",
    "cross - correlated noise was generated by statistically correlating the @xmath0 streams . for each time - stream ,",
    "a fourier - space gaussian random number vector @xmath105 was generated , where @xmath106 indexes detectors .",
    "we built a correlation matrix @xmath107 , where @xmath108 and @xmath109 are the noise standard deviation and knee frequency for stream @xmath106 respectively and @xmath110 is the correlation coefficient for streams @xmath106 and @xmath111 . correlated @xmath0 noise streams were produced by applying the cholesky decomposition of this matrix to the set of @xmath112 mode - by - mode @xmath113 where @xmath114 and @xmath115 .",
    "to get time - domain noise stream realisations with the desired auto and cross power spectra , each @xmath116 stream was fourier transformed and added to an independent gaussian white noise realisation with standard deviation @xmath108 .",
    "the white noise level itself was determined assuming a fiducial noise - equivalent q ( neq ) of @xmath117-@xmath118 .",
    ".noise parameters used in the simulations .",
    "the spectral index of unity describes the correlated noise from detectors , whilst the spectral index of two describes atmospheric noise .",
    "the ranges of knee frequency chosen are representative of frequencies experienced by low frequency ( @xmath119-ghz ) experiments .",
    "the @xmath100 and @xmath120 of noise case 6 are representative of quiet q - band data .",
    "the values of @xmath77 here correspond to one year s of observing time with @xmath121 , @xmath122 and @xmath123 horns , where @xmath77 has been scaled so as to produce the white noise amplitude in the final map expected for these dataset sizes .",
    "for all cases , we simulate weakly correlated inter - detector @xmath124 noise , with correlation coefficient @xmath125 . [ cols=\"^,^,^,^ \" , ]     [ iterations table ]",
    "the memory requirement for analysing complete data - sets becomes untenable for massively - multidetector ground - based experiments , so partitioning the data for the destriping step is an attractive analysis option .",
    "destriped maps can be combined with a noise - weighted average - an operation that is mathematically identical , other than through the accuracy of the offset estimates , to making a map from the entire destriped dataset .",
    "however , the accuracy of the offset amplitude estimation can be increased by including more data in the solution of equation [ amp_destr ] . as argued in ",
    "[ algorithmic scalings section ] , the signal removal operator @xmath53 , which removes both signal and any noise that looks like signal , removes less noise if more data is considered . if it were to remove no noise at all , such that @xmath126 , then the offsets become the reference offsets described in  [ timestreams and maps section ] .",
    "we can expect that the pixel noise in the destriped maps will reduce as the offset amplitude estimates better model the correlated noise in the timestreams .",
    "destriped maps were produced for different destriping partitions , then combined to produce a final map that uses all of the available data ( in this case , the 40 ces data - set ) .",
    "for a set of maps @xmath127 , with q / u white noise covariances @xmath128 , the combined map is defined as @xmath129 .",
    "this ensures that the noise amplitude in the final maps is constant and any differences between them are solely due to changes in the error of the offset amplitude estimates .",
    "figure [ partitioning residuals figure ] shows the variation of the rms residual of q and u in the final combined map with destriping partition size .",
    "only pixels within the central region of the scan ( the science field itself ) were used to calculate the rms residual .    the effect of partition size on rms residual amounts to a @xmath130 reduction between destriping with 40 cess and destriping with single cess only . of this change",
    ", the majority of the improvement is achieved by considering pairs of cess - as was the case with iteration numbers and for the same reasons .",
    "the residual rms remains constant for ces numbers up to the full 202 ces dataset .",
    "a number of effects that naturally produce cross - linking within a single ces contribute to make this change small . in a separate analysis , we considered data from the central horn only , to remove the cross - linking effects of the 17 horn focal plane .",
    "the variation in rms with ces number is qualitatively similar to that shown in figure [ partitioning residuals figure ] , except that the rms reduction is much larger - amounting to a @xmath131 reduction in residuals when all 40 cess are used to estimates offset amplitudes rather than considering each ces separately .",
    "the effect of destriping analysis partitioning has been investigated recently for the planck experiment by @xcite , who found a significant variation in destriping pixel residual rms with the length of scan considered . however , we note that the scanning strategies of the planck and quiet experiments have little in common - the planck scanning strategy used revisited the vast majority of pixels only after a 6 month spin period , with the destriping relying on the cross - linking in a small number of polar pixels to determine amplitudes for offsets the length of a single great circle scan . the scanning strategy considered here",
    "is heavily cross - linked for most pixels on small time - scales .",
    "our simulations suggest that destriping partitioning is an acceptable analysis technique when the partition consists of a few cess .",
    "a caveat for this result is that it is based solely on the effects of @xmath0 noise .",
    "instrumental systematics , the simulation of which is beyond the scope of this paper , can be better constrained with larger data partitions .",
    "an example of this is scan - synchronous noise , which can be modelled by the offsets when large numbers of cess with uncorrelated scan - synchonous noise are included , and which significantly increases the number of iterations required to solve for the offset amplitudes .      a year of data consisting of 600 hours of data with 70 detectors sampled at 50hz can be analyzed with this code on 64 typical modern processor cores in approximately 30 minutes .",
    "this will scale approximately linearly with increasing time and number of detectors .",
    "this is fast enough that destriping can be included as part of a monte- carlo pipeline , replacing map - making with heavy filtering with only a small increase in computing time .",
    "it is also suitable as an alternative to maximum - likelihood mapmaking for performing repeated auxiliary tasks such as null tests in cases where running the full pipeline repeatedly is unfeasible .",
    "the code and method can therefore be applied to the largest presently existing cmb polarization data sets to make high resolution maps .",
    "the maximum - likelihood ( m - l ) map - making method has long been used in cmb data analysis pipelines to reduce sizeable time - ordered data - sets ( tod ) into optimal maps , which are optimal in the sense that the noise in the map is minimised without the loss of information - the sky signal in the maps is not distorted . however , applying the method is moving toward being untenable for future long duration , massively multi - detector cmb experiments , establishing the need for faster , approximate , map - making methods . such methods will be crucial to simulating and removing experimental systematics with enough precision to search for the small primordial gravity wave signal in the cmb polarisation field .    significant study ( see eg : @xcite and their references ) has been conducted into data - analysis for space based experiments , such as the planck experiment .",
    "we have built upon this by evaluating fast map - making methods for massively multi - detector ground based experiments , of which a large number are in development ( see @xcite for a review ) .",
    "we have developed descart , an optimised , parallel destriping code , and applied it to simulations of time - ordered data ( tod ) from such an experiment .",
    "we destripe using short baselines with a noise prior - a mode of operation that has been shown to produce near optimal maps @xcite .    for large future datasets ,",
    "the fastest map - making method under consideration is tod filtering .",
    "our comparison of the filtering and destriping approaches shows that , for the highly cross - linked scanning strategies we simulate , tod filtering underperforms in power spectrum errors when compared to destriping .",
    "this result is due to two effects : the suppression of signal sensitivity by the noise filter , which decreases the signal to noise ratio in the lower @xmath4 bins , despite removing the effects of correlated noise ; and the introduction of @xmath132 mixing by the tod filter , which can be characterised and removed by tod simulations , but which significantly contributes to the variance of the large angular scales . of these effects , the latter ( only present in the b - mode spectrum ) is much more dominant , typically doubling the bandpower variance at the expected inflationary b - mode peak at @xmath133 , although the variance increase is dependent on how aggressive the tod filter is .    in our simulations , we find that bias from filtering can strongly affect the detection of the primordial b - mode peak ( see table [ bmode peak table ] ) .",
    "this is true for the one realisation of possible scan strategies , patch shapes and receiver array arrangements presented here ; the full variation of the effect with the parameters of the scan and experiment is beyond the scope of this paper , and we expect that it can be ameliorated in many situations .",
    "it is also unclear how the leakage effect will scale for longer scanning - strategies and larger focal planes .",
    "descart s computing time depends on the length of the dataset and the condition number of the destriping matrix .",
    "each iteration of descart is dominated by operations that scale linearly with the size of the dataset - the @xmath24 and @xmath134 operators and their transposes .",
    "the number of iterations is sensitive to the condition of the matrix , which is generally improved by the addition of more heavily cross - linked data , such that the number of iterations required to solve for offset amplitudes reduces slightly . for the simulations we considered ,",
    "the computing time was dominated by the initial data - loading operation .",
    "this suggests that destriping can be potentially as fast a method as filtering .",
    "the effect of an extended focal plane is to add sufficient cross - linking to a single scan that destriping offsets are well constrained by data from that scan alone .",
    "the gain from including multiple scans to estimate offset amplitudes is a reduction of order @xmath130 in map residuals , a gain that is almost entirely returned by combining a small number of scans .",
    "the search for b - modes will likely be dependent on how well experimental and physical systematics can be constrained and mitigated . many of these systematics require aggressive filtering of the time - stream data prior to map - making . however , destriping has the potential to model some of these systematic effects in addition to correlated time - stream noise . for ground - based , constant - elevation scans ,",
    "the most important systematic is scan - synchronous signal , caused for example by ground pick - up in the side - lobes of the experimental beam and time - varying atmospheric noise .",
    "the presence of scan - synchronous signal tends to add considerably to the number of pcg iterations required to solve for offsets , as offsets have a limited capacity for modelling it .",
    "an alternative to filtering these modes is to solve for additional destriping offsets mapped by azimuth rather than by time .",
    "such an approach is equivalent to the estimation and removal of ground signal recently applied to the quad data by @xcite . for total power experiments ,",
    "the offsets can be mapped onto all the detectors within the horn , much as atmospheric common - mode offsets are mapped onto timestreams from multiple adjacent horns in the method of @xcite .    as part of the generalization of destriping to multiple detectors",
    ", we have included the possible effect of inter - detector correlated @xmath0 noise in the offset prior . the use of this information in the prior results in a marginal improvement in destriping performance , but for the experimental set - up we simulate , the effect is small .",
    "we note , however , that in other experimental situations , the inclusion of the correlation information could be important .",
    "we have investigated the use of correlation information to constrain cross - correlated @xmath0 , but have ignored the possibility of cross - correlated white noise . correlated white noise tends to affect detectors within the same horn , in which case it is optimally accounted for by including the correlations in the white noise covariance matrix , which we have considered to be uncorrelated here .",
    "the detectors in the same horn observe the same sky pixels , so this extra information does not lead to replacing the naive map evaluated in each destriping iteration with a more difficult solution , as the naive mapping operation is still diagonal in pixel - space .",
    "we plan to address experimental systematics , including correlated white noise and scan - synchronous signal , in a future paper .",
    "_ acknowledgments _ : we are grateful to bruce winstein and the quiet collaboration for useful discussions .",
    "the results in this paper were obtained by making use of the healpix and fftw subroutine libraries and using the computing facilities of the research computing services group at the university of oslo , and in particular the titan cluster .",
    "ds acknowledges the support of a science and technology facilities council phd studentship and jz acknowledges support of an stfc rolling grant .",
    "ashdown m. a. j. et al . , 2007a , a&a , 467 , 761 ashdown m. a. j. et al . , 2009 ,",
    "a&a , 493 , 753 borrill j. , 1999 , pre - print ( astro - ph/9911389v1 ) brown m. l. , challinor a. d. , north c. e. , johnson b. r. , odea d. , sutton d. , 2009a , mnras , 397 , 634 brown , m.  l. , et al . 2009b , apj , 705 , 978 burigana c. , malaspina m. , mandolesi n. , danese l. , maino d. , bersanelli m. , maltoni m. , 1997 , pre - print ( astro - ph/9906360 ) chiang , h.  c. , et al .",
    "2009 , pre - print ( astro - ph/0906.1181 ) de gasperis g. , balbi a. , cabella p. , natoli p. , vittorio n. , 2005 , a&a , 436 , 1159 delabrouille j. , 1998 , a&as , 127 , 555 dore o. , teyssier r. , bouchet f.r . , vibert d. , prunet s. , 2001 , a&a , 374 , 358 ferreira p. g. , & jaffe a. h. , 2000 , mnras , 312 , 89 fowler j.  w. , et al .",
    "2007 , applied optics , 46 , 3444 gorski k. m. , hivon e. , banday a. j. , wandelt b. d. , hansen f. k. , reinecke m. , bartelmann m. , 2005 , apj , 622 , 759 halverson , n.  w. , et al . , 2009 , apj , 701 , 42 hanany s. , rosenkranz p. , 2003",
    ", newar , 47 , 1159 hanany s. et al .",
    "2000 , apj , 545 , l5 hansen f. k. , gorski k.m . , 2003 ,",
    "mnras , 343 , 559 hincks a. d. and the act collaboration , 2009 , pre - print ( astro - ph/0907.0461 ) hinshaw g. et al .",
    "2009 , apjs , 180 , 225 hivon e. , gorski k. m. , netterfield c. b. , crill p. c. , prunet s. , hansen f. , 2002 , apj , 567 , 2 kamionkowski:1997 kamionkowski , m. , kosowsky , a. , stebbins , a. , 1997 , phys . rev .",
    "l. , 78 , 2058 keihanen e. , kurki - suonio h. , poutanen t. , maino d. , burigana c. , 2004 a&a , 428 , 287 keihanen e. , kurki - suonio h. , poutanen t. , 2005 , mnras , 360 , 390 keihanen e. , keskitalo r. , kurki - suonio h. , poutanen t. , sirvio a. s. , 2009 , pre - print ( astro - ph/0907.0367 ) r. keskitalo et al . , 2009 , pre - print ( astro - ph/0906.0175 ) kosowsky , a. 2003 , newar , 47 , 939 kovac , j.  m. , leitch , e.  m. , pryke , c. , carlstrom , j.  e. , halverson , n.  w. , & holzapfel , w.  l. 2002 , nature , 420 , 772 kurki - suonio h. , keihanen e. , keskitalo k. , poutanen t. , sirvi a. s. , maino d. , burigana c. , 2009 , pre - print ( astro - ph/0904.3623 ) lee , a.  t. , et al .",
    ", 2008 , am . inst .",
    ", 1040 , 66 maino d. et al . , 1999 ,",
    "a&as , 140 , 383 mactavish c. j. et al . , 2008 , apj , 689 , 655 melchiorri , a. , et al .",
    "2000 , apj let , 536 , l63 oxley p. et al . , 2005 , pre - print ( astro - ph/0501111 ) patanchon g. et al . , 2008 , apj , 681 , 708 plagge , t. , et al .",
    "2009 , pre - print ( astro - ph/0911.2444 ) seljak : zaldarriaga:1997 seljak , u. , zaldarriaga , m. , phys .",
    "l. , 78 , 2054 smith k. m. , 2006 , phys .",
    "d , 74 , 083002 smoot g. f. et al .",
    ", 1992 , apj , 396 , l1 spergel , d.  n. , et al .",
    "2003 , apjs , 148 , 175 stompor r. et al .",
    ", 2002 , phys .",
    "d , 65 , 022003 sutton , d. johnson b. r. , brown m. l. , cabella p. , ferreira p. g. , smith k. m. , 2009 , mnras , 393 , 894 szapudi i. , prunet s. , pogosyan d. , szalay a. , bond r.j .",
    ", 2001 , apj , 548 , l115 takahashi y. d. et al . , 2009 , pre - print ( astro - ph/0906.4069 ) tegmark m. , 1997a , apj , 480 , l87-l90 tegmark , m. , 1997b , phys .",
    "d. 55 , 5895 zaldarriaga m. , seljak u. , 1997 , phys . rev .",
    "d , 55 , 4 1830"
  ],
  "abstract_text": [
    "<S> future cosmic microwave background ( cmb ) polarisation experiments aim to measure an unprecedentedly small signal - the primordial gravity wave component of the polarisation field b - mode . to achieve this </S>",
    "<S> , they will analyse huge datasets , involving years worth of time - ordered data ( tod ) from massively multi - detector focal planes . </S>",
    "<S> this creates the need for fast and precise methods to complement the m - l approach in analysis pipelines . in this paper , we investigate fast map - making methods as applied to long duration , massively multi - detector , ground - based experiments , in the context of the search for b - modes . </S>",
    "<S> we focus on two alternative map - making approaches : destriping and tod filtering , comparing their performance on simulated multi - detector polarisation data . </S>",
    "<S> we have written an optimised , parallel destriping code , the destriping cartographer ( descart ) , that is generalised for massive focal planes , including the potential effect of cross - correlated tod @xmath0 noise . </S>",
    "<S> we also determine the scaling of computing time for destriping as applied to a simulated full - season data - set for a realistic experiment . </S>",
    "<S> we find that destriping can out - perform filtering in estimating both the large - scale e and b - mode angular power spectra . </S>",
    "<S> in particular , filtering can produce significant spurious b - mode power via eb mixing . whilst this can be removed </S>",
    "<S> , it contributes to the variance of b - mode bandpower estimates at scales near the primordial b - mode peak . for the experimental configuration </S>",
    "<S> we simulate , this has an effect on the possible detection significance for primordial b - modes . </S>",
    "<S> destriping is a viable alternative fast method to the full m - l approach that does not cause the problems associated with filtering , and is flexible enough to fit into both m - l and monte - carlo pseudo-@xmath1 pipelines .    </S>",
    "<S> cosmic microwave background  </S>",
    "<S> methods : data analysis  methods : statistical </S>"
  ]
}