{
  "article_text": [
    "an intriguing feature of quantum optics is that it enables communication protocols which are impossible to achieve by classical means .",
    "one prominent example is quantum key distribution ( qkd ) @xcite which in principle allows two parties ( alice and bob ) to communicate with unconditional security .",
    "it is thus impossible for an arbitrarily powerful eavesdropper ( eve ) to obtain knowledge of the transmitted information .    in the well - known bennett - brassard 1984 ( bb84 )",
    "protocol in its original form @xcite , alice sends single photons of different polarizations to bob . under ideal conditions ,",
    "the security of this protocol can be rigorously proved @xcite .",
    "furthermore , practically feasible procedures for distilling a secret key from the exchanged quantum states are known @xcite . during the distillation , alice and",
    "bob generate a key sequence out of their raw data stemming from the quantum state exchange .",
    "eve s attempt to gain knowledge results in a perturbation of the quantum states , such that her information about the raw key can be upper bounded .",
    "alice and bob can thus shrink their raw data such that eve s knowledge of the resulting key sequence becomes negligible .",
    "rigorous security proofs show that eve can not successfully attack an ideal implementation of bb84 .",
    "however , real implementations always exhibit deviations from the ideal model . in order to guarantee secure communication , such deviations",
    "must be included into the security proofs .",
    "one example is the use of weak coherent states instead of single photons which is considered in the gottesmann - lo - ltkenhaus - preskill ( gllp ) security proof @xcite .",
    "the resulting reduction of the key rate can be mitigated by modifications to the protocol such as in the decoy state method @xcite or in the scarani - acin - ribordy - gisin 2004 ( sarg04 ) protocol @xcite .",
    "more subtle deviations can result in side channels through which information can unnoticeably leak to eve .",
    "for example , photons might carry information in unwanted degrees of freedom @xcite .",
    "once such side channels are known , they need to be considered in a more general security proof .    nowadays ,",
    "quantum cryptography has matured to the point that several commercial products are available @xcite .",
    "each system might have loopholes which are particular to its implementation .",
    "some implementations are , for example , susceptible to non - conforming light pulses that eve sends into alice s or bob s devices .",
    "eve could use reflectometry to read modulator states @xcite or take control over the detectors by sending faked states @xcite , time - shifted pulses @xcite , or by detector blinding combined with faked states @xcite .",
    "the impact of such interventions strongly depends on the particular implementation .",
    "it is thus difficult to include them in general security proofs . alternatively ,",
    "specific countermeasures could be devised by adapting hard- or software of the systems , such that all assumptions in the security proof about the qkd module are again valid .    in this paper",
    ", we investigate a particular attack on the qkd device id3110 clavis2 from i d  quantique .",
    "the fibre - based system utilizes the plug&play principle @xcite where the quantum states are encoded as relative phase of two pulses . in our experiment",
    ", we send irregular , bright light pulses ( faked states ) outside the activation time of the gated detectors .",
    "we show that we can generate measurement results in the bob module with only a slight increase in the quantum bit error rate ( qber ) , if side effects of the attack are considered properly .",
    "the paper is organized as follows .",
    "section [ sec:2 ] describes the basic principles of our attack . in section [ sec : detec ] , we elaborate on the particular implementation of the detectors in the clavis2 system . in section [ sec : loophole ] , we present the imperfections found in the system .",
    "section [ sec : sideff ] discusses the side effect of the faked - state attack , which actually partly protects the security of the system .",
    "section [ sec : qber ] presents all the necessary elements for simulations and shows the parameters for which the clavis2 system is _ not _ secure . in section  [ sec : countermeasures ] , we discuss possible countermeasures against the proposed attack before concluding in section 8 .",
    "in the bb84 protocol  @xcite , alice randomly chooses one of two non - orthogonal bases to encode her quantum bit .",
    "bob independently chooses his measurement basis at random .",
    "if his basis matches alice s , he will measure the quantum state correctly . in half of the cases , however , bob chooses the wrong basis .",
    "alice and bob compare encoding and measurement basis via a classical authenticated channel and remove all events with basis mismatch from their raw data .    in an intercept - resend attack , eve places a copy of bob s apparatus into the quantum channel .",
    "then she performs the same kind of measurement as bob , tries to reproduce the original quantum state and sends it to bob .",
    "since eve is unaware of alice s basis choice , she will inevitably introduce errors in case of a basis mismatch between her basis and the one used by alice and bob .",
    "eve will thus always be detected in a perfect implementation of a qkd system  @xcite .    in case of an imperfect implementation , however ,",
    "eve may attack the qkd system by sending faked states instead of quantum states @xcite .",
    "her aim is to generate faked states which only produce a detection event in the bob module if eve s basis matches bob s basis . in this case , after alice and bob discard their non - matching bases , all that remains in the key are bits for which alice , eve and bob had the same basis .",
    "thus , eve generates no errors .    after the attack , bob and eve share identical bit values and basis choices .",
    "the attack works on widely used qkd protocols , namely bb84 , sarg04 , and the decoy method .",
    "the attack exhibits an extra 3 db loss because of the possible basis mismatch of eve and bob .",
    "this is easily compensated in a practical eve , since she may use better detector efficiencies and exclude loss in the line  @xcite .",
    "equivalent circuit diagram of bob s detectors in clavis2 . see text for description.,width=453 ]    the impact of faked states strongly depends on the implementation of the detection scheme in a qkd system .",
    "we will focus on systems employing avalanche photodiodes ( apds ) in the geiger mode , as it is the case in many qkd systems @xcite , and all commercially available realizations @xcite .",
    "furthermore , we assume that the apds are gated , i.e. activated only in time intervals when signal states are expected to arrive . during the activation time",
    ", a large reverse voltage is applied to the apds such that the apds are biased above the breakdown voltage .",
    "then a single photon can trigger a carrier avalanche which results in a macroscopic current .",
    "if the generated current exceeds a certain threshold , a detection event ( click ) is registered .    as an example",
    ", we consider the behavior of the gated detectors in i d  quantique s clavis2 qkd system .",
    "a detector circuitry reverse - engineered by us is shown in figure  [ fig : circ ] .",
    "the apds are biased by the high voltage supply with @xmath0 almost as large as the breakdown voltage ( @xmath1 and @xmath2 ) .",
    "the detectors are gated in geiger mode by means of ttl signals , which are applied on top of the bias voltage with a period of 200 ns .",
    "the gates are supplied as pecl logic level signals from the main board and converted to ttl signals by the buffer dd1 .",
    "the comparator da1 monitors the apd current and registers a click in the detector when the current peak passes a threshold ( @xmath3 , @xmath4 ) .",
    "the comparator produces a pecl output pulse for each detection event .    during all the time",
    "not covered by the gate , each apd is biased at a constant value @xmath5 below the breakdown voltage .",
    "the current through the apd is then approximately proportional to the incident optical power .",
    "the circuit behaves similarly as a linear photodiode followed by a comparator .",
    "principle of detector control . in the detection part of a phase - encoded qkd , the two pulses which could be generated by eve as a faked state interfere at a 50:50 beamsplitter .",
    "( a ) for bob s basis choice matching eve s , the signals interfere such that detector d0 clicks deterministically , because the photocurrent surpasses the detection threshold @xmath6 .",
    "( b ) for bob s basis choice not matching eve s , the power is split 50:50 to both detectors .",
    "the photocurrent does not surpass the threshold .",
    "therefore , the faked state is not detected.,width=302 ]    in the following subsections , we describe two unexpected deviations of the detection system from the idealized behavior implicitly assumed by the designers of the qkd system .",
    "we start by explaining the detection process in detail . in an ideal plug&play system ,",
    "the relative phase between the signal states and reference pulses in the receiver module ( @xmath7 ) is determined by a combined phase modulation of alice and bob , i.e. by a combination of alice s bit and basis ( @xmath7 ) and bob s measurement basis ( @xmath8 ) .",
    "let us consider a standard intercept - resend attack .",
    "for a matching basis choice of alice , eve and bob , the phase difference is @xmath9 or @xmath10 .",
    "this restricts the possible outcome of the measurement to a single detector and results in a conclusive outcome for bob . for a mismatched basis choice ,",
    "the phase difference is @xmath11 or @xmath12 . in this case",
    ", either of their detectors will click randomly .",
    "this clearly causes a qber of 25% .      in the linear regime of the apds",
    ", eve can substitute the quantum states with bright coherent states  @xcite .",
    "figure  [ fig : attack ] shows examples of pulses which generate a click only if bob s and eve s bases match , since the comparator following the apd will only click , if the input optical power surpasses a critical power threshold . in case of a basis mismatch",
    ", the optical power is distributed equally among the detectors and no detection click is generated .    to exploit the loophole experimentally ,",
    "we look closer at the detector characteristics .",
    "as mentioned , the apds are biased below the breakdown voltage before and after the gate .",
    "optically , bob s phase modulation extends temporally on either side of the gate pulse by approximately 10ns .",
    "we have verified that the system accepts clicks at least 10.5 ns after the gate , still assigning the click to the bit slot associated with the gate .",
    "[ cols= \" < \" , ]     eve can adapt her attack strategy , if she has access to both the after - gate and dead - time loopholes . in the following , we show a strategy which is not an optimized one , but a rather intuitive and ( as it turns out ) successful approach",
    ". eve again attacks the end of the frame as shown in figure  [ fig : xframe ] .",
    "her strategy is to attack as frequently as possible .",
    "thereby , she quickly enters a dead time of bob s detectors .",
    "she will generate detection events during the dead time and , thereby , can prolong the detector dead time as shown in section  [ no_dead ] .",
    "ideally , a major part of the attack happens during the dead state , which would completely remove the effect of afterpulses and result in negligible qber for this part of the attack .    in the simulation",
    ", we again adjust the number of attacked gates @xmath13 and simulate the qber for @xmath14 frames .",
    "figure  [ fig : best ] shows that for high transmittance the qkd system is vulnerable against the advanced attack , including for an eavesdropper with detection efficiency implementable today .",
    "the photon statistics are maintained during the attack .",
    "it is therefore applicable also to decoy state protocols .",
    "note that both eavesdropping strategies ( especially the latter one ) leave strong fingerprints . in the latter case ,",
    "the distance between two valid detection events can be smaller than the dead time of 10@xmath15s .",
    "therefore , one countermeasure is to search for too closely timed detection events .",
    "furthermore , rejecting detections during the dead time would restrict eavesdropping to lower frequencies as shown by our first simulation ( see figure  [ fig : keep ] ) .",
    "a complete protection against the presented attacks is guaranteed if the detection times are resolved , such that bob can discriminate between detections inside and outside the single - photon - sensitive part of the gate .",
    "note however that this is highly non - trivial since the intrinsic jitter caused by the avalanche build - up is about equal to the length of the gate itself .",
    "alternatively , a watchdog detector can be placed at bob s input in order to detect bright faked states .",
    "since such a detector can not be an avalanche detector ( this can be hacked ) , the countermeasure is only effective against bright faked states .",
    "we have demonstrated that gated detectors in qkd systems can be controlled by an external eavesdropper using bright laser pulses during the linear mode operation . in particular , we have analysed the attack parameters for the commercial qkd system clavis2 from i d  quantique . in principle , the system is controllable by bright control pulses arriving after the gate time .",
    "however , we have found a side effect : afterpulse generation due to the faked states .",
    "the side effect generates high qber , and therefore actually protects the system from a straightforward faked - state attack .",
    "eve can , however , take advantage of a second imperfection , namely that the system accepts the bright pulses even in the dead time and , furthermore , resets the remaining dead time . in a simulation of the attack",
    ", we have found that the system is not secure if clicks during the dead time are accepted .",
    "the presented after - gate attack can be used independently or together with the blinding attack in ref .  @xcite .",
    "although the after - gate attack in contrast to the blinding increases the qber , it has the advantages that the optical power sent into the bob module is weaker .",
    "therefore , the after - gate attack is harder to detect with a watchdog detector .",
    "another advantage is that this attack can be applied to detectors that are not blindable .",
    "i d  quantique has been notified about this loophole prior to the submission of the manuscript , and has implemented countermeasures .",
    "we acknowledge i d  quantique s valuable assistance in this project .",
    "we also thank georgy onishchukov and nitin jain for fruitful discussions .",
    "this work was supported by the research council of norway ( grant no .",
    "180439/v30 ) , daadppp mobility program financed by nfr ( project no .",
    "199854 ) and daad ( project",
    "50727598 ) .",
    ". acknowledges support from foncicyt project no .",
    "10 gisin n , ribordy g , tittel w and zbinden h 2002 _ rev .",
    "phys . _ * 74 * 145 scarani v , bechmann - pasquinucci h , cerf n j , duek m , ltkenhaus n and peev m 2009 _ rev . of mod .",
    "phys . _ * 81 * 1301 bennett c h and brassard g 1984 quantum cryptography : public key distribution and coin tossing _",
    "proceedings of ieee international conference on computers , systems and signal processing _ ( bangalore , india ) p 175 mayers d 1996 quantum key distribution and string oblivious transfer in noisy channels _ advances in cryptology - proc .",
    "crypto 96 _ ( berlin : springer ) p 343 shor p w and preskill j 2000 _ phys .",
    "lett . _ * 85 * 441 gottesman d , lo h k , ltkenhaus n and preskill j 2004 _ quant .",
    "comp . _ * 4 * 325 hwang w y 2003 _ phys .",
    "lett . _ * 91 * 057901 wang x b 2005 _ phys .",
    "lett . _ * 94 * 230503 lo h k , ma x and chen k 2005 _ phys .",
    "lett . _ * 94 * 230504 scarani v , acn a , ribordy g and gisin n 2004 _ phys .",
    "lett . _ * 92 * 057901 nauerth s , frst m , schmitt - manderbach t , weier h and weinfurter h 2009 _ new j. phys . _ * 11 * 065001 i d  quantique url ` http://www.idquantique.com ` magiq technologies ` url http://www.magiqtech.com ` vakhitov a , makarov v and hjelme d r 2001 _ j. mod .",
    "_ * 48 * 2023 ; gisin n , fasel s , kraus b , zbinden h and ribordy g 2006 _ phys . rev . a _ * 73 * 022320 makarov v and hjelme d r 2005 _ j. mod",
    ". opt . _ * 52 * 691 makarov v 2009 _ new j. phys . _",
    "* 11 * 065003 zhao y , fung c h f , qi b , chen c and lo h k 2008 _ phys .",
    "042333 lydersen l , wiechers c , wittmann c , elser d , skaar j , makarov v 2010 _ nature photon . _ advance online publication ( doi 10.1038/nphoton.2010.214 ) muller a , herzog t , huttner b , tittel w , zbinden h , gisin n 1997 _ appl .",
    "lett . _ * 51 * 793 ; stucki d , gisin n , guinnard o , ribordy g and zbinden h 2002 _ new j. phys . _",
    "* 41 ribordy g , gisin n , guinnard o , stucki d , wegmuller m and zbinden h 2004 _ j. mod . opt . _",
    "* 51 * 1381 trifonov a , subacius d , berzanskis a and zavriyev a 2004 _ j. mod",
    ". opt . _ * 51 * 1399 branciard c , gisin n , kraus b , and scarani v 2005 _ phys .",
    "rev . a _ * 72 * 032301 goodman j w , _ statistical optics _",
    "( wiley , new york , 1985 ) makarov v , brylevski a , and hjelme d r 2004 _ j. appl . opt . _ * 43 * 4385 cova s , lacaita a , ripamonti g 1991 _ ieee electron .",
    "* 12 * , 685 chau h f 2002 , _ phys .",
    "a _ * 66 * 060302(r )"
  ],
  "abstract_text": [
    "<S> we present a method to control the detection events in quantum key distribution systems that use gated single - photon detectors . </S>",
    "<S> we employ bright pulses as faked states , timed to arrive at the avalanche photodiodes outside the activation time . </S>",
    "<S> the attack can remain unnoticed , since the faked states do not increase the error rate _ per se_. </S>",
    "<S> this allows for an intercept - resend attack , where an eavesdropper transfers her detection events to the legitimate receiver without causing any errors . as a side effect , </S>",
    "<S> afterpulses , originating from accumulated charge carriers in the detectors , increase the error rate . </S>",
    "<S> we have experimentally tested detectors of the system id3110 ( clavis2 ) from i d  quantique . </S>",
    "<S> we identify the parameter regime in which the attack is feasible despite the side effect . </S>",
    "<S> furthermore , we outline how simple modifications in the implementation can make the device immune to this attack . </S>"
  ]
}