{
  "article_text": [
    "registration is a process of finding the optimal one - to - one correspondence between different data , such as images or surfaces .",
    "applications can be found in various fields , including computer graphics , computer visions and medical imaging .",
    "for example , in medical imaging , finding accurate 1 - 1 correspondence between medical data is crucial for statistical shape analysis of the anatomical structures . while in computer graphics , surface registration is needed for texture mapping .",
    "different registration approaches have been developed .",
    "existing algorithms can mainly be divided into three categories , namely , 1 .",
    "landmark based registration , 2 .",
    "intensity based registration and 3 . hybrid registration using both landmark and intensity information .",
    "landmark based registration computes a smooth 1 - 1 correspondence between corresponding data that matches important features .",
    "this kind of registration , with good feature alignment , is particularly crucial in medical imaging and computer graphics .",
    "for example , in computer graphics , landmark based registration is used to obtain the constrained texture mapping .",
    "the main advantage of the landmark based method is that larger deformations can be dealt with and intuitive user - interaction can be incorporated .",
    "intensity based registration aims to match corresponding data without feature landmarks .",
    "registration is usually obtained by matching intensity functions , such as image intensity for image registration or surface curvature for surface geometric registration .",
    "the main advantage of the intensity based registration is that more image information is taken into account and the delineation of feature landmarks is not required .",
    "however , it usually can not cope with large geometric deformations .",
    "recently , hybrid registration that combines landmark based and intensity based methods have gained increased attention .",
    "hybrid approaches use both the landmark and intensity information to guide the registration .",
    "this type of approaches can usually obtain more accurate registration result , since the advantages of landmark based and intensity based registration can be combined . in this work , we will mainly focus on the landmark based registration and the hybrid registration .",
    "most existing algorithms can compute registration accurately and efficiently when the deformation is small .",
    "however , the registration problem becomes challenging when large deformations occur .",
    "bijectivity can be easily lost and overlaps can usually be observed in the obtained registration .",
    "this causes inaccuracies in the registration .",
    "it is therefore necessary to develop an algorithm to obtain diffeomorphic registration with large deformations .    in this paper",
    ", we introduce a novel method to obtain diffeomorphic image or surface registrations via quasi - conformal maps , which can deal with large deformations .",
    "the key idea is to minimize an energy functional involving a beltrami coefficient term , which measures the distortion of the quasi - conformal map .",
    "the beltrami coefficient effectively controls the bijectivity and smoothness of the registration , even with very large deformations . by minimizing the energy functional ,",
    "we obtain an optimal beltrami coefficient associated to the desired registration , which is guaranteed to be bijective . using the proposed algorithm ,",
    "landmark - based registration between images or surfaces can be effectively computed .",
    "the obtained registration is guaranteed to be diffeomorphic ( 1 - 1 and onto ) , even with a large deformation or a large number of landmark constraints . the proposed algorithm can also be combined with matching intensity ( such as image intensity or surface curvature ) to improve the accuracy of the registration .",
    "numerical results show that the combination of landmark constraints with intensity matching can significantly improve the accuracy of the registration . to test the effectiveness of the proposed algorithm",
    ", experiments have been carried out on both synthetic and real data .",
    "results show that the proposed algorithm can compute diffeomorphic registration between images or surfaces effectively and efficiently .    in summary ,",
    "the contributions of this paper are three - folded .",
    "firstly , we propose a variational method to search for an optimized beltrami coefficient associated to a diffeomorphic quasi - conformal map with large deformations , which minimizes the local geometric distortion .",
    "secondly , we apply the model to compute the landmark based registration , which can deal with very large deformations and large amount of landmark constraints .",
    "thirdly , we extend the landmark based registration model to a hybrid registration model , which combine both landmark and intensity information to obtain more accurate registration .",
    "the rest of the paper is organized as follows . in section",
    "[ previous ] , we review some previous works closely related to this paper . in section [ math ] , we describe some basic mathematical background related to our proposed model . in section [ model ] , our proposed model for diffeomorphic registration with large deformations is explained in details .",
    "we describe the numerical implementation of the proposed algorithm in section [ numerical ] .",
    "experimental results are reported in section [ experiment ] .",
    "finally , we conclude our paper in section [ conclusion ] .",
    "in this section , we will review some related works closely related to this paper .",
    "intensity - based image registration has been widely studied . a comprehensive survey on the existing intensity - based image registration",
    "can be found in @xcite .",
    "one of the commonly used method is based on the variational approaches to minimize the intensity mismatching error .",
    "for example , vercauteren et al .",
    "@xcite proposed the diffeomorphic demons registration algorithm , which is a non - parametric diffeomorphic image registration algorithm based on thirion s demons algorithm@xcite .",
    "the basic idea is to adapt the optimization procedure underlying the demons algorithm to a space of diffeomorphic transformations .",
    "the obtained registration is smooth and bijective .",
    "several algorithms for surface registration that matches geometric quantities , such as curvatures , have also been propsoed @xcite@xcite@xcite@xcite . for example , lyttelton et al .",
    "@xcite proposed an algorithm for surface parameterizations based on matching surface curvatures .",
    "yeo et al .",
    "@xcite proposed the spherical demons method , which adopted the diffeomorphic demons algorithm @xcite , to drive surfaces into correspondence based on the mean curvature and average convexity .",
    "conformal surface registration , which minimizes angular distortions , has also been widely used to obtain a smooth 1 - 1 correspondence between surfaces @xcite .",
    "an advantage of conformal registrations is that they preserve local geometry well .",
    "quasi - conformal surface registrations , which allows bounded amount of conformality distortion , have also been studied @xcite . for example , lui et al .",
    "@xcite proposed to compute quasi - conformal registration between hippocampal surfaces based on the holomorphic beltrami flow method , which matches geometric quantities ( such as curvatures ) and minimizes the conformality distortion @xcite .",
    "landmark - based registration has also been widely studied and different algorithms have been proposed .",
    "bookstein et al .",
    "@xcite proposed to use a thin - plate spline regularization ( or biharmonic regularization ) to obtain a registration that matches landmarks as much as possible .",
    "tosun et al .",
    "@xcite proposed to combine iterative closest point registration , parametric relaxation and inverse stereographic projection to align cortical sulci across brain surfaces .",
    "these diffeomorphisms obtained can better match landmark features , although not perfectly .",
    "wang et al .",
    "@xcite proposed to compute the optimized harmonic registrations of brain cortical surfaces by minimizing a compounded energy involving the landmark - mistmatching term @xcite .",
    "the obtained registration obtains an optimized harmonic map that better aligns the landmarks .",
    "however , landmarks can not be perfectly matched , and bijectivity can not be guaranteed under large number of landmark constraints .",
    "later , lin et al .",
    "@xcite propose a unified variational approach for registration of gene expression data to neuroanatomical mouse atlas in two dimensions that matches feature landmarks .",
    "again , landmarks can not be exactly matched .",
    "inexact landmark - matching registrations are sometimes advantegous . in the case",
    "when landmark points / curves can not be accurately delineated , this method is more tolerant of errors in labeling landmarks and gives better parameterization . in the situation when exact landmark matching is required ,",
    "smooth vector field has been applied to obtain surface registration .",
    "lui et al .",
    "@xcite proposed the use of vector fields to represent surface maps and reconstruct them through integral flow equations .",
    "they obtained shape - based landmark matching harmonic maps by looking for the best vector fields minimizing a shape energy .",
    "the use of vector fields to compute the registration makes the optimization easier , although it can not describe all surface maps .",
    "an advantage of this method is that exact landmark matching can be guaranteed .",
    "time dependent vector fields can also be used @xcite .",
    "for example , glauns et al .",
    "@xcite proposed to generate large deformation diffeomorphisms of a sphere , with given displacements of a finite set of template landmarks . the time dependent vector fields facilitate the optimization procedure , although it may not be a good representation of surface maps since it requires more memory .",
    "the computational cost of the algorithm is also expensive .",
    "quasi - conformal mapping that matches landmarks consistently has also been proposed .",
    "wei et al .",
    "@xcite also proposed to compute quasi - conformal mappings for feature matching face registration .",
    "the beltrami coefficient associated to a landmark points matching parameterization is approximated .",
    "however , either exact landmark matching or the bijectivity of the mapping can not be guaranteed , especially when very large deformations occur .",
    "algorithms for hybrid registration , which combines both the landmark and intensity information to guide the registration , has also been proposed@xcite@xcite@xcite@xcite .",
    "for example , christensen et al . @xcite",
    "propsoed an algorithm for hybrid registration that uses both landmark and intensity information to guide the registration .",
    "the method utilizes the unidirectional landmark thin - plate spline ( ul - tps ) registration technique together with a minimization scheme for the intensity difference to obtain good correspondence between images .",
    "paquin et al .",
    "@xcite proposed a registration method using a hybrid combination of coarse - scale landmark and b - splines deformable registration techniques .",
    "chanwimaluang et al .",
    "@xcite proposed a hybrid retinal image registration approach that combines both area - based and feature - based methods .",
    "existing hybrid registration techniques can drive data into good correspondence when deformations are not too large . in this work ,",
    "we propose a hybrid quasi - conformal registration method , which can deal with very large deformations .",
    "in this work , we apply quasi - conformal maps to obtain diffeomorphic registrations with large deformations . in this section , we describe some basic theories related to quasi - conformal geometry . for details",
    ", we refer to readers to @xcite@xcite .",
    "a surface @xmath0 with a conformal structure is called a _ riemann surface_. given two riemann surfaces @xmath1 and @xmath2 , a map @xmath3 is _ conformal _ if it preserves the surface metric up to a multiplicative factor called the _",
    "conformal factor_. an immediate consequence is that every conformal map preserves angles . with the angle - preserving property",
    ", a conformal map effectively preserves the local geometry of the surface structure .",
    ", height=129 ]    a generalization of conformal maps is the _ quasi - conformal _ maps , which are orientation preserving homeomorphisms between riemann surfaces with bounded conformality distortion , in the sense that their first order approximations takes small circles to small ellipses of bounded eccentricity @xcite .",
    "mathematically , @xmath4 is quasi - conformal provided that it satisfies the beltrami equation : @xmath5 for some complex - valued function @xmath6 satisfying @xmath7 .",
    "@xmath6 is called the _ beltrami coefficient _ , which is a measure of non - conformality .",
    "it measures how far the map at each point is deviated from a conformal map . in particular , the map @xmath8 is conformal around a small neighborhood of @xmath9 when @xmath10 . infinitesimally , around a point @xmath9 , @xmath8 may be expressed with respect to its local parameter as follows : @xmath11    obviously , @xmath8 is not conformal",
    "if and only if @xmath12 . inside the local parameter domain , @xmath8 may be considered as a map composed of a translation to @xmath13 together with a stretch map @xmath14 , which is postcomposed by a multiplication of @xmath15 which is conformal .",
    "all the conformal distortion of @xmath16 is caused by @xmath17 .",
    "@xmath16 is the map that causes @xmath8 to map a small circle to a small ellipse . from @xmath17",
    ", we can determine the angles of the directions of maximal magnification and shrinking and the amount of them as well .",
    "specifically , the angle of maximal magnification is @xmath18 with magnifying factor @xmath19 ; the angle of maximal shrinking is the orthogonal angle @xmath20 with shrinking factor @xmath21 .",
    "thus , the beltrami coefficient @xmath6 gives us all the information about the properties of the map ( see figure [ fig : illustration1 ] ) .",
    "the maximal dilation of @xmath8 is given by : @xmath22    quasiconformal mapping between two riemann surfaces @xmath23 and @xmath24 can also be defined . instead of the beltrami coefficient , the _ beltrami differential _ is used .",
    "a beltrami differential @xmath25 on a riemann surface @xmath0 is an assignment to each chart @xmath26 of an @xmath27 complex - valued function @xmath28 , defined on local parameter @xmath29 such that @xmath30 on the domain which is also covered by another chart @xmath31 . here , @xmath32 and @xmath33 .",
    "an orientation preserving diffeomorphism @xmath34 is called quasi - conformal associated with @xmath25 if for any chart @xmath26 on @xmath23 and any chart @xmath35 on @xmath24 , the mapping @xmath36 is quasi - conformal associated with @xmath37 .",
    "in this section , we explain our proposed model for diffeomorphic registration with large deformation in details .",
    "the basic idea is to look for a quasi - conformal map to register two corresponding data , which can either be images or surfaces .",
    "the quasi - conformal map is obtained by minimizing an energy functional involving a beltrami coefficient term , which measures the distortion of the quasi - conformal map .",
    "the beltrami coefficient effectively controls the bijectivity and smoothness of the registration , even with very large deformations .",
    "let @xmath23 and @xmath24 be two corresponding images or surfaces .",
    "our goal is to find a smooth 1 - 1 mapping @xmath38 between @xmath23 and @xmath24 satisfying certain prescribed criteria . for landmark - based registration",
    ", we look for a registration that matches corresponding feature landmarks .",
    "let @xmath39 and @xmath40 be the sets of corresponding feature landmarks defined on @xmath23 and @xmath24 respectively .",
    "we search for a diffeomorphism @xmath38 subject to the landmark constraints that @xmath41 for all @xmath42 .",
    "we propose a variational approach to obtain an optimized quasi - conformal map @xmath8 , which minimizes an energy functional @xmath43 involving the beltrami coefficient terms .",
    "more specifically , we propose to solve the following minimization problem : @xmath44 subject to the constraints that :    c(i ) @xmath41 for @xmath45 ( landmark constraint ) ;    c(ii ) @xmath46 ( bijectivity ) .",
    "the first term of @xmath43 ensures the smoothness of @xmath8 .",
    "the second term of @xmath43 aims to minimize the conformality distortion of @xmath8 .",
    "the constraint c(i ) is the landmark constraint , which enforces @xmath8 to match corresponding landmarks consistently .    if @xmath38 satisfies the constraint c(ii ) , then @xmath8 is a diffeomorphism .",
    "suppose @xmath47 under some local coordinates . the beltrami coefficient @xmath48 is given by : @xmath49 where @xmath50    now , the jacobian of @xmath8 , @xmath51 , is given by : @xmath52    since @xmath53 , @xmath54 .",
    "also , @xmath55 .",
    "hence , @xmath56 everywhere .    since the jacobian is postive everywhere , by the inverse function theorem , the mapping @xmath8 is locally invertible everywhere . in other words , @xmath8 is a diffeomorphism .",
    "let : @xmath57 then : @xmath43 has a minimizer in @xmath58 .",
    "in fact , @xmath58 is compact .",
    "note that @xmath59 .",
    "in particular , the unique teichmller map is indeed in @xmath58 .",
    "we first prove that @xmath58 is complete .",
    "let @xmath60 be a cauchy sequence in @xmath58 under the norm @xmath61 .",
    "then , @xmath62 is also a cauchy sequence with respect to the @xmath63 norm . since @xmath64 , which is complete .",
    "thus , @xmath65 uniformly for some @xmath66 .",
    "since @xmath67 is continuous , @xmath68 is also continuous . besides",
    ", @xmath69 is convergent . hence , @xmath70 and @xmath71 uniformly for some @xmath72 .    in addition , @xmath73 for all @xmath74 implies @xmath75 .",
    "@xmath76 implies @xmath77 . since @xmath78 uniformly , @xmath79 locally uniformly",
    "this implies @xmath80 for @xmath81 .",
    "therefore , @xmath82 . obviously , @xmath58 is totally bounded .",
    "we conclude that @xmath58 is compact .",
    "since @xmath58 is compact and @xmath43 is continuous in @xmath58 , @xmath43 has a minimizer in @xmath58 .    in order to improve the accuracy of the registration",
    ", one can combine the landmark - matching registration model with the intensity matching model .",
    "the intensities are functions defined on @xmath23 and @xmath24 .",
    "usually , they are image intensities for image registration and surface curvatures for surface registration . ideally , we want to obtain a landmark - matching diffeomorphism @xmath38 that matches the intensities as much as possible .",
    "we denote the intensities on @xmath23 and @xmath24 by @xmath83 and @xmath84 respectively .",
    "our registration model can be modified as solving the following minimization problem :    @xmath85    subject to the constraints c(i ) and c(ii ) .",
    "@xmath86 has a minimizer in @xmath58 if @xmath87 and @xmath88 are continuous .",
    "the exisitence of minimizer depends on the continuity of @xmath87 and @xmath88 .",
    "if @xmath87 and @xmath88 are continuous , @xmath86 is continuous .",
    "since @xmath58 is compact , @xmath86 has a minimizer in @xmath58 .      in this subsection",
    ", we describe an algorithm to approximate the solutions of the above minimization problems .      given two corresponding sets of landmarks @xmath89 and @xmath90on @xmath23 and @xmath24 respectively , our goal is to look for a diffeomorphism @xmath38 that satisfies @xmath41 ( @xmath91 ) while minimizing the local geometric distortion .",
    "our proposed model is to solve the variational problem ( [ landmarkmodel ] ) as described in the last subsection .",
    "more specifically , our goal is to look for an optimal beltrami coefficient @xmath92 , which is the beltrami coefficient of some diffeomorphism @xmath38 , minimizing the following energy functional @xmath43 : @xmath93 subject to the constraints that @xmath94 , @xmath95 for @xmath96 and @xmath97 , where @xmath98 is the beltrami coefficient of @xmath8 .",
    "we apply a splitting method to solve the constrained optimization problem . in particular",
    ", we consider to minimize : @xmath99 subject to the constraints that @xmath94 and @xmath95 for @xmath96 .",
    "we iteratively minimize @xmath100 subject to the constraints .",
    "set @xmath101 .",
    "suppose @xmath102 is obtained at the @xmath103 iteration .",
    "fixing @xmath102 , we minimize @xmath104 over @xmath8 , subject to the constraint that @xmath95 ( @xmath96 ) , to obtain @xmath105 .",
    "once @xmath105 is obtained , fixing @xmath105 , we minimize @xmath106 over @xmath107 to obtain @xmath108 .    to minimize @xmath104 over @xmath8 fixing @xmath102",
    ", it is equivalent to finding a landmark matching diffeomorphism @xmath109 , whose beltrami coefficient closely resembles to @xmath102 and satisfies the landmark constraints @xmath110 . to obtain such @xmath105",
    ", we propose to use the _ linear beltrami solver ( lbs ) _ to find the descent direction for the beltrami coefficients @xmath98 such that it approaches to @xmath102 and the corresponding @xmath8 satisfies the landmark constraints .",
    "let @xmath111 . from the beltrami equation ( [ beltramieqt ] ) , @xmath112    let @xmath113 .",
    "we can write @xmath114 and @xmath115 as linear combinations of @xmath116 and @xmath117 , @xmath118 where @xmath119 ; @xmath120 ; @xmath121 .    similarly , @xmath122    since @xmath123",
    ", we obtain @xmath124    where @xmath125 .    in the discrete case",
    ", the elliptic pdes ( [ eqt : beltramipde ] ) can be discretized into sparse positive definite linear systems . given @xmath102 and the landmark constraints",
    ", one can solve the linear systems with the landmark constraints in the least square sense .",
    "a landmark matching quasi - conformal map @xmath105 , whose beltrami coefficient closely resembles to @xmath102 , can then be obtained .",
    "once @xmath105 is obtained , we minimize @xmath126 over @xmath107 while fixing @xmath105 .",
    "in other words , we look for @xmath108 minimizing : @xmath127    by considering the euler - lagrange equation , it is equivalent to solving : @xmath128    in discrete case , equation ( [ elmsplit2continuous ] ) can be discretized into a sparse linear system and can be solved efficiently .",
    "however , by simply minimizing equation ( [ elmsplit2continuous ] ) does not ensure that the corresponding diffeomorphism @xmath105 of the resultant beltrami coefficient @xmath102 satisfies the landmark constraints .",
    "therefore , we use the linear beltrami solver with input @xmath102 together with the landmark constraints to obtain a mapping with the corresponding beltrami coefficients @xmath129 resemble to @xmath102 and satisfies the exact landmark matching requirement . using @xmath130 as a descent direction , we update @xmath102 from the solution of the equation ( [ elmsplit2continuous ] ) by @xmath131 for some small @xmath132 .",
    "this guarantees the resultant @xmath102 is smooth and the landmark mismatch decreases .",
    "we keep the iteration going to obtain a sequence of pair @xmath133 .",
    "the iteration stops when @xmath134 for some small threshold @xmath135 .",
    "theoretically , the conventional penalty method requires that @xmath136 increases in each iterations . in practice , we set @xmath136 to be a large enough constant and the algorithm gives satisfactory results .    in summary , the proposed landmark based registration model can be described as follows :    @xmath137 _ ( landmark based registration ) _",
    "+ @xmath138 _ images or surfaces : @xmath23 and @xmath24 ; cooresponding landmark sets @xmath39 and @xmath40 .",
    "_ + @xmath139 _ optimal beltrami coefficient @xmath140 and the landmark matching registration @xmath141 _",
    "_ set @xmath101 .",
    "use lbs to reconstruct @xmath142 from @xmath143 satisfying the landmark constraints . ;",
    "_ 2 .   _ given @xmath102 . fixing @xmath102 , obtain @xmath105 by lbs satisfying the landmark constraints .",
    "fixing @xmath105 , obtain @xmath108 by solving : @xmath144 _ 3 .",
    "use lbs to obtain @xmath145 from @xmath102 satisfying the landmark constraints .",
    "obtain @xmath146 and update @xmath131 for some small @xmath132 .",
    "if @xmath147 , continue . otherwise , stop the iteration .",
    "_      the propsoed landmark based registration model can also be combined with matching intensity ( such as image intensity for image registration or surface curvature for surface registration ) to improve the accuracy of the registration result .",
    "more specifically , our goal is to look for an optimal beltrami coefficient @xmath92 , which is the beltrami coefficient of some diffeomorphism @xmath38 , minimizing the following energy functional @xmath86 : @xmath148 subject to the constraints that @xmath94 and @xmath41 for @xmath149 . here ,",
    "@xmath87 and @xmath88 are the intensity functions defined on @xmath23 and @xmath24 respectively .",
    "we again apply a splitting method to solve the above constrained optimization problem .",
    "we consider to minimize : @xmath150 subject to the constraints that @xmath94 and @xmath151 is the quasi - conformal map with beltrami coefficient @xmath6 satisfying @xmath152 for @xmath96 .    to solve the above optimization problem , we iteratively minimize @xmath153 subject to the constraints .",
    "set @xmath101 .",
    "suppose @xmath102 and @xmath154 is obtained at the @xmath103 iteration .",
    "fixing @xmath102 , we minimize @xmath155 over @xmath6 , subject to the constraint that @xmath152 ( @xmath96 ) , to obtain @xmath156 .",
    "once @xmath156 is obtained , fixing @xmath156 , we minimize @xmath157 over @xmath107 to obtain @xmath108 .",
    "we first discuss the minimization @xmath155 over @xmath6 fixing @xmath102 , subject to the constraint that @xmath152 ( @xmath96 ) .",
    "this problem is equivalent to solving : @xmath158    using the gradient descent method , we compute the descent direction @xmath159 , which minimizes @xmath160 .",
    "@xmath159 is given by : @xmath161    as @xmath151 is perturbed , its associated beltrami coefficient is also adjusted by @xmath162 .",
    "the adjustment can be explicitly computed .",
    "note that : @xmath163 which implies : @xmath164    thus , the adjustment @xmath162 can be obtained by : @xmath165    similiarly , we can obtain the descent direction @xmath166 , minimizes @xmath167 .",
    "@xmath168 is given by : @xmath169    therefore , the descent direction to solve the optimization problem ( [ imsplit1 ] ) is given by : @xmath170    using the above formula for the descent direction , we obtain an updated beltrami coefficient : @xmath171    we then compute a quasi - conformal map @xmath172 , whose beltrami coefficient closely resembles to @xmath173 , using lbs with the landmark constraints enforced .",
    "this step ensures a landmark matching registration can be obtained .",
    "we then update @xmath154 by : @xmath174 .",
    "once @xmath156 is obtained , fixing @xmath156 , we minimize @xmath157 over @xmath107 to obtain @xmath108 .",
    "in other words , we look for @xmath108 minimizing : @xmath175    in the case when @xmath176 , by considering the euler - lagrange equation , it is equivalent to solving : @xmath177    in discrete case , equation ( [ elmsplit2 ] ) can be discretized into a sparse linear system and can be solved efficiently .",
    "similar to section 4.2.1 , we use the linear beltrami solver with input @xmath102 together with the landmark constraints to obtain a descent direction @xmath178 to update @xmath102 by @xmath131 for some small @xmath132 .",
    "this guarantees the resultant @xmath102 is smooth and the landmark mismatch decreases .",
    "we keep the iteration going to obtain a sequence of pair @xmath179 .",
    "the iteration stops when @xmath180 for some small threshold @xmath135 .",
    "again , the conventional penalty method requires that @xmath136 increases in each iterations .",
    "however , in practice , we set @xmath181 to be a large enough constant and the algorithm gives satisfactory results .    in summary , the proposed hybrid registration model can be described as follows :    @xmath182 _ ( hybrid registration ) _",
    "+ @xmath138 _ images or surfaces : @xmath23 and @xmath24 ; cooresponding landmark sets @xmath39 and @xmath40 ; intensity functions @xmath87 and @xmath88 defined on @xmath23 and @xmath24 respectively .",
    "_ + @xmath139 _ optimal beltrami coefficient @xmath183 and the landmark matching registration @xmath141 _ +    1 .   _ set @xmath101 .",
    "use lbs to reconstruct @xmath142 from @xmath184 satisfying the landmark constraints .",
    "set @xmath185 ; _",
    "_ given @xmath102 and @xmath154 .",
    "fixing @xmath102 , obtain @xmath173 by solving : @xmath186 .",
    "_ using lbs , compute @xmath172 whose beltrami coefficient closely resembles to @xmath173 with landmark constraints enforced .",
    "let @xmath174 .",
    "_ fixing @xmath156 , obtain @xmath108 by solving : + @xmath187 _ 5 .",
    "use lbs to obtain @xmath188 from @xmath108 satisfying the landmark constraints .",
    "obtain @xmath189 and update @xmath190 for some small @xmath132 .",
    "if @xmath191 , continue . otherwise , stop the iteration . _",
    "the proposed models for landmark based and hybrid registration rely on the linear beltrami solver(lbs ) and solving the euler - lagrange(e - l ) equations . in this section",
    ", we will describe the numerical implementation of the lbs and also the discretization of equations .    practically speaking , 2d domains or surfaces in @xmath192",
    "are usually represented discretely by triangular meshes .",
    "suppose @xmath193 and @xmath194 are two surface meshes with the same topology representing @xmath23 and @xmath24 .",
    "we define the set of vertices on @xmath193 and @xmath194 by @xmath195 and @xmath196 respectively .",
    "similarly , we define the set of triangular faces on @xmath193 and @xmath194 by @xmath197 and @xmath198 .",
    "suppose @xmath199 is an orientation preserving piecewise linear homeomorphism between @xmath193 and @xmath194 .",
    "we can assume @xmath193 and @xmath194 are both embedded in @xmath200 . in case @xmath193 and @xmath194 are surface meshes in @xmath192 , we first parameterize them conformally by @xmath201 and @xmath202 . the composition of @xmath8 with the conformal parameterizations , @xmath203 , is then an orientation preserving piecewise linear homeomorphism between @xmath204 and @xmath205 embedded in @xmath200 .    to compute the quasi - conformal mapping ,",
    "the key idea is to discretize equation [ eqt : beltramipde ] with two linear systems .    given a map @xmath206 , we can easily compute its associated beltrami coefficient @xmath48 , which is a complex - valued function defined on each triangular faces of @xmath193 . to compute @xmath48",
    ", we simply need to approximate the partial derivatives on every face @xmath207 . we denote them by @xmath208 and @xmath209 respectively .",
    "note that @xmath8 is piecewise linear .",
    "the restriction of @xmath8 on each triangular face @xmath207 can be written as : @xmath210    hence , @xmath211 , @xmath212 , @xmath213 and @xmath214 .",
    "now , the gradient : @xmath215 on each face @xmath207 can be computed by solving the linear system : @xmath216 where @xmath217 $ ] and @xmath218 $ ] are two edges on @xmath207 . by solving equation ( [ eqt : gradient ] ) , @xmath219 , @xmath220 , @xmath221 and @xmath222",
    "can be obtained .",
    "the beltrami coefficient @xmath223 of the triangular face @xmath207 can then be computed from the beltrami equation ( [ beltramieqt ] ) by : @xmath224    equation ( [ eqt : linearb1cont ] ) and ( [ eqt : linearb2cont ] ) are both satisfied on every triangular faces .",
    "let @xmath225 .",
    "the discrete versions of equation ( [ eqt : linearb1cont ] ) and ( [ eqt : linearb2cont ] ) can be obtained .",
    "@xmath226    and    @xmath227    where : @xmath228 ; @xmath229 and    @xmath230 .    in order to discretize equation ( [ eqt : beltramipde ] )",
    ", we need to introduce the _",
    "discrete divergence_. the discrete divergence can be defined as follows .",
    "let @xmath231 $ ] and @xmath232 where @xmath233 or @xmath234 .",
    "suppose @xmath235 and @xmath236 ( @xmath237 ) .",
    "using equation ( [ eqt : gradient ] ) , @xmath238 and @xmath222 can be written as follows : @xmath239 where : @xmath240    suppose @xmath241 is a discrete vector field defined on every triangular faces . for each vertex @xmath242 ,",
    "let @xmath243 be the collection of neighborhood faces attached to @xmath242 .",
    "we define the discrete divergence @xmath244 of @xmath245 as follows : @xmath246    by careful checking , one can prove that @xmath247    this gives , @xmath248    as a result , equation ( [ eqt : beltramipde ] ) can be discretized : @xmath249 where @xmath250 .",
    "this is equivalent to :    @xmath251 + b_i^t[\\alpha_2(t ) a_t + \\alpha_3(t ) b_t ] = 0\\\\ \\sum_{t\\in n_i } a_i^t [ \\alpha_1(t ) c_t & + \\alpha_2(t ) d_t ] + b_i^t[\\alpha_2(t ) c_t + \\alpha_3(t ) d_t ] = 0 \\end{split}\\ ] ]    for all vertices @xmath252 .",
    "note that @xmath219 , @xmath220 , @xmath221 and @xmath222 can be written as a linear combination of the x - coordinates and y - coordinate of the desired quasi - conformal map @xmath8 .",
    "hence , equation ( [ eqt : linearb12 ] ) gives us the linear systems to solve for the x - coordinate and y - coordinate function of @xmath8 .",
    "besides , @xmath8 has to satisfy certain constraints on the boundary .",
    "one common situation is to give the dirichlet condition on the whole boundary .",
    "that is , for any @xmath253 @xmath254    note that the dirichlet condition is not required to be enforced on the whole boundary .",
    "the proposed algorithm also allows free boundary condition .",
    "for example , in the case that @xmath193 and @xmath194 are rectangles , the desired quasi - conformal map should satisfy @xmath255;\\ \\mathbf{re}(f ) = 1 \\mathrm{\\ on\\ arc\\ } [ 1 , 1+i];\\\\ & \\mathbf{imag}(f ) = 0 \\mathrm{\\ on\\ arc\\ } [ 0 , 1];\\ \\mathbf{imag}(f ) = 1 \\mathrm{\\ on\\ arc\\ } [ i , 1+i ] \\end{split}\\ ] ]    besides , in our case , interior landmark correspondences @xmath256 are also enforced .",
    "thus , we should add this constraint to the linear systems .",
    "mathematically , it is described as @xmath257 ( @xmath149 ) .      in discrete case , as the beltrami coefficient @xmath258",
    "is defined on each triangular face , we first approximate @xmath259 by    @xmath260    where @xmath243 is the collection of neighborhood faces attached to @xmath242 .",
    "the obtained @xmath261 will be the average of the beltrami coefficients @xmath258 on 1-ring neighbourhood triangles .",
    "discretizing equation ( [ elmsplit2continuous ] ) turns down to the problem of discretizing the laplacian operator @xmath262 .",
    "let @xmath263 $ ] and @xmath264 $ ] .",
    "the mesh laplacian is defined to be @xmath265    where @xmath266 and @xmath267 are the two interior angles of @xmath268 and @xmath269 which are opposite to the edge @xmath270 $ ] . to find @xmath266 and similar @xmath267",
    ", we follows the idea of @xcite .",
    "let @xmath271 be the length of the edge @xmath270 $ ] .",
    "by law of cosines : @xmath272 we have @xmath273 similar , by the law of sines : @xmath274 , we have @xmath275 therefore we have @xmath276 and the discrete laplace beltrami operator can be constructed .    as the solution of the equation ( [ elmsplit2continuous ] ) , @xmath108 ,",
    "is defined on vertices , we have to approximate @xmath277 on each face before proceeding to next step .",
    "the approximation is taken to be    @xmath278      in section 4.2.2 , we propose to solve @xmath279 by using gradient descent .",
    "however , the steps involves calculations of the gradient of @xmath6 , which is a second order derivatives .",
    "it may cause computation error and instability .",
    "we therefore separately search for the descent direction of @xmath280 and @xmath281 for the two terms @xmath160 and @xmath282 respectively in the following way .",
    "for the first term , we apply the demon force proposed by wang et al .",
    "@xcite to find the deformation :    @xmath283    where @xmath284 is the deformation vector field .",
    "the corresponding beltrami coefficient of the deformation is    @xmath285    by the composition rule of the beltrami coefficient , we have @xmath286    then the descent direction of @xmath162 , minimizes @xmath160 , is approximated by @xmath287    for the second term , we can obtain the descent direction as @xmath288 .",
    "therefore , the descent direction to solve the optimization problem is given by : @xmath170    using the demon force as registration guarantee the smoothness of @xmath289 and also stabilize the calculation of descent direction .",
    "to reduce the computation cost of registering high resolution images ( high quality surface meshes ) , we adopt a multiresolution scheme for the registration procedure . in the scheme",
    ", we first coarsen the both @xmath87 and @xmath88 by @xmath234 layers , where @xmath290 and @xmath291 is the coarest images of @xmath292 , for @xmath293 .",
    "registration process is then carried out to register between @xmath294 and @xmath295 .",
    "diffeomorphism @xmath296 can then be obtained . to proceed to finer scale , we adopt a linear interpolation on @xmath296 to obtain @xmath297 , which serves as the initial map for regstration in finer layer .",
    "resultant mapping of this scheme will be the diffeomorphism which matches the intensity and satisfies the landmark constraints for the original image resolution .",
    "we have test our proposed algorithms on synthetic data together with real medical data . in this section ,",
    "experimental results are reported .",
    "[ [ example-1 ] ] example 1 + + + + + + + + +    in this example , we test our proposed landmark based registration model on a synthetic example with large amount of landmark constraints enforced .",
    "figure[fig : landmark_example2](a ) shows the the correspondence between two landmark sets defined on two rectangles .",
    "78 corresponding landmark features are labeled on each rectangles .",
    "we compute the landmark matching diffeomorphic registration between the two rectangles , using our proposed landmark based registration model .",
    "the registration result is as shown in ( b ) , which is visualized by the deformation of the regular grids under the registration .",
    "note that the obtained registration is bijective .",
    "no overlaps or flips can be found .",
    "[ [ example-2 ] ] example 2 + + + + + + + + +    we first test our proposed algorithm on a synthetic example to obtain a landmark matching registration between two 2d rectangles with very large deformations .",
    "figure [ fig : landmark_example1](a ) shows two rectangles , with corresponding landmark sets defined on each of them .",
    "the presecribed deformations of the landmarks are large . using our proposed landmark based registration model",
    ", we compute the landmark matching diffeomorphic registration between the two rectangles .",
    "the registration result is as shown in ( b ) , which is visualized by the deformation of the regular grids under the registration .",
    "note that the obtained registration is bijective .",
    "no overlaps or flips can be found .",
    "[ [ example-3 ] ] example 3 + + + + + + + + +    ( brain landmark matching registration ) we apply the proposed algorithm to compute landmark matching quasi - conformal registration between brain cortical surfaces .",
    "figure [ fig : mistmatch](a ) and ( b ) show two brain cortical surfaces , each of them are labeled by 6 sulcal landmarks . using our proposed method",
    ", we compute the landmark - matching quasi - conformal registration between them .",
    "figure [ fig : mistmatch](c ) shows the conformal registration between the two surfaces .",
    "note that the corresponding landmarks can not be matched .",
    "figure [ fig : mistmatch](d ) shows the registration result using our proposed landmark - matching quasi - conformal registration , which matches corresponding landmarks consistently .",
    "figure shows the energy plot versus iterations .",
    "it demonstrates our method iteratively minimizes the energy functional to an optimal quasi - conformal map between the two brain surfaces . in figure",
    "[ fig : meansurface ] , we compute the landmark - matching quasi - conformal registrations with 6 sulcal landmarks between 10 brain cortical surfaces .",
    "the mean surface is then computed after the cortical surfaces are registered .",
    "the sulcal features are well - preserved , illustrating that the landmarks are consistently matched under the registration .",
    "[ [ example-4 ] ] example 4 + + + + + + + + +    we also compared our proposed landmark - matching quasi - conformal registration algorithm with other state - of - the - art algorithms , namely , 1 . harmonic map ; 2 .",
    "thin - plate spline ( tps ) and 3 .",
    "we compared our method with others with different sizes of deformation .",
    "as shown in table [ table : comparisondeformation ] , our method outperforms other methods . in all cases ( tiny , moderate and large deformation )",
    ", our method computes a non - overlap landmark - matching registration with the least amount of time . both harmonic map and",
    "tps has overlaps for their obtained landmark - matching registration results , although the computations of these methods are efficient .",
    "lddmm can obtain non - overlapping landmark - matching registration results , however , the computational cost is comparatively much more expensive .",
    ".comparison with other methods with different sizes of deformation [ cols=\"^,^,^,^\",options=\"header \" , ]     [ table : comparisondeformation ]      [ [ example-5 ] ] example 5 + + + + + + + + +    we next test our proposed hybrid registration algorithm on a synthetic example . figure [ fig : ar_result](a ) and",
    "( b ) shows two synthetic images to be registered .",
    "( a ) shows the image of the character a. ( b ) shows the image of the character r. corresponding feature landmarks are labeled on each images .",
    "our goal is to look for a diffeomorphic registration that matches the corresponding landmarks and also the image intensities .",
    "( c ) shows the obtained diffeomorphic registration using our proposed hybrid registration model .",
    "image 1 in ( a ) is deformed under the obtain registration to obtain a deformed image , which is shown in ( c ) .",
    "the deformed image closely resembles to the target image ( image 2 in ( b ) ) .",
    "landmarks are consistently matched , and the obtained registration is bijective .",
    "figure [ fig : arenergy ] shows the plots of energy versus iterations . in our algorithm , multi - level approach is applied to perform the registration from the coarsest layer to the finest ( original resolution ) layer . in this example , three layers are used .",
    "layer 1 refers to the coarsest resolution and layer 3 refers to the finest ( original ) resolution .",
    "the energy plots at different layers are shown in figure [ fig : arenergy ] .",
    "the energy is significantly reduced during the optimization process at the first layer .",
    "the obtained coarse registration is then interpolate back to the finer layer .",
    "an optimal solution is finally reached during the optimization process at the third layer after about 10 iterations . figure [ fig : multiresolutionar ] shows the optimal registration at different layers during the multiresolution scheme .            [",
    "fig : multiresolutionar ]     [ [ example-6 ] ] example 6 + + + + + + + + +    we also test the proposed hybrid registration algorithm on another synthetic example with larger deformation .",
    "figure [ fig : ic_result](a ) and ( b ) shows two synthetic images to be registered .",
    "( a ) shows the image of the character i. ( b ) shows the image of the character c. corresponding feature landmarks are labeled on each images .",
    "again , the goal is to look for a diffeomorphic registration that matches the corresponding landmarks and also the image intensities .",
    "( c ) shows the obtained diffeomorphic registration using our proposed hybrid registration model .",
    "image 1 in ( a ) is deformed under the obtain registration to obtain a deformed image , which is shown in ( c ) .",
    "the deformed image closely resembles to the target image ( image 2 in ( b ) ) .",
    "landmarks are consistently matched , and the obtained registration is bijective .",
    "[ [ example-7 ] ] example 7 + + + + + + + + +    we test the hybrid registration algorithm on real images .",
    "figure [ fig : hand_register ] shows two images of the human hands .",
    "corresponding landmark features are labeled on each images . in figure",
    "[ fig : hand_register_result ] , we show the registration results using different approaches .",
    "figure [ fig : hand_register_result](b ) shows the deformed image from image 1 using the landmark based registration model . notice that if we only use landmarks as constraints to guide the registration , the deformed image is very different ( see regions in the red boxes ) from the target image ( as shown in ( a ) ) .",
    "( c ) shows the deformed image from image 1 using the intensity based registration model .",
    "similarly , the deformed image is very different ( see regions in the red boxes ) from the target image if only intensity information is used .",
    "( d ) shows the deformed image from image 1 using the proposed hybrid registration model .",
    "the deformed image closely resembles to the target image .",
    "in fact , the intensity mismatching error is less than 1% , meaning that the registration is very accurate .",
    "[ [ example-8 ] ] example 8 + + + + + + + + +    we also test the hybrid registration algorithm to register two brain mris .",
    "figure [ fig : brain_register ] shows two human brain images .",
    "corresponding landmark features are labeled on each images . in figure",
    "[ fig : brain_registerresult ] , we show the registration results using different approaches .",
    "figure [ fig : brain_registerresult](b ) shows the deformed image from image 1 using the landmark based registration model .",
    "if we only use landmarks as constraints to guide the registration , the deformed image is different ( see regions in the red boxes ) from the target image ( as shown in ( a ) ) .",
    "( c ) shows the deformed image from image 1 using the intensity based registration model .",
    "similarly , the deformed image is very different ( see regions in the red boxes ) from the target image if only intensity information is used .",
    "notice that the tumor in the red box does not move using intensity based registration .",
    "( d ) shows the deformed image from image 1 using the proposed hybrid registration model .",
    "the deformed image closely resembles to the target image . the intensity mismatching error is less than 1% , meaning that the registration is very accurate .",
    "[ [ example-9 ] ] example 9 + + + + + + + + +    we also test the hybrid registration algorithm to register two human teeth surfaces .",
    "figure [ fig : teeth12 ] shows two human teeth surfaces , each of them are labeled with corresponding landmarks .",
    "figure [ fig : teeth_registration_lm ] shows the registration results of the two teeth surfaces using the landmark - matching quasi - conformal registration .",
    "( a ) shows the surface of teeth 1 , whose colormap is given by its mean curvature .",
    "( b ) shows the surface of teeth 2 , whose colormap is given by its mean curvature .",
    "( c ) shows the registration result using the landmark - matching quasi - conformal registration .",
    "the colormap on the surface of teeth 1 is mapped to the surface of teeth 2 using the obtained registration .",
    "note that the curvature is not matched consistently ( see the regions in the red boxes ) .",
    "it shows that the registration is not accurate if only landmarks are used to guide the registration process .",
    "figure [ fig : teeth_registration_summary ] ( c ) shows the registration result using the hybrid quasi - conformal registration . in this case , both landmarks and curvature information are used to guide the registration process .",
    "the colormap ( mean curvature ) on the surface of teeth 1 is mapped to the surface of teeth 2 using the obtained registration .",
    "note that the curvature is matched consistently , which means the registration result is accurate .                [ [ example-10 ] ] example 10 + + + + + + + + + +    we also test the hybrid registration algorithm to register two human face surfaces . figure [ fig : face_mesh ] shows two human face surfaces , each of them are labeled with corresponding landmarks .",
    "figure [ fig : face_matching ] shows the registration results of the two human faces using the landmark - matching quasi - conformal registration .",
    "( a ) shows the surface of human face 1 , whose colormap is given by its mean curvature .",
    "( b ) shows the surface of human face 2 , whose colormap is given by its mean curvature .",
    "( c ) shows the registration result using the hybrid quasi - conformal registration .",
    "the colormap on the surface of human face 1 is mapped to the surface of human face 2 using the obtained registration .",
    "note that the corresponding regions are consistently matched .",
    "( d ) shows the plot of curvature mismatching versus iterations .",
    "it shows that our algorithm iteratively adjust the quasi - conformal registration to an optimal one that minimizes the curvature mismatching error .",
    "this paper presents a novel method to obtain diffeomorphic image or surface registrations with large deformations via quasi - conformal maps .",
    "the main strategy is to minimize an energy functional involving a beltrami coefficient term .",
    "the beltrami coefficient measures the conformality distortion of the quasi - conformal map .",
    "it controls controls the bijectivity and smoothness of the registration . by minimizing the energy functional ,",
    "we obtain an optimal beltrami coefficient associated to the desired registration , which is guaranteed to be bijective , even with very large deformations . the proposed method can be applied for both landmark based registration and hybrid registration .",
    "experiments have been carried out on both synthetic and real data .",
    "results show that our proposed method can effectively obtain diffeomorphic registration between images or surfaces with least amount of local geometric distortion .",
    "the obtained registration is guaranteed to be bijective ( 1 - 1 and onto ) , even with a large deformation or large number of landmark constraints . in the future",
    ", we plan to extend the proposed method to high - genus surfaces and apply the method to more real applications in medical imaging for disease analysis ."
  ],
  "abstract_text": [
    "<S> registration , which aims to find an optimal one - to - one correspondence between different data , is an important problem in various fields . </S>",
    "<S> this problem is especially challenging when large deformations occur . in this paper </S>",
    "<S> , we present a novel algorithm to obtain diffeomorphic image or surface registrations with large deformations via quasi - conformal maps . </S>",
    "<S> the basic idea is to minimize an energy functional involving a beltrami coefficient term , which measures the distortion of the quasi - conformal map . </S>",
    "<S> the beltrami coefficient effectively controls the bijectivity and smoothness of the registration , even with very large deformations . using the proposed algorithm , </S>",
    "<S> landmark - based registration between images or surfaces can be effectively computed . </S>",
    "<S> the obtained registration is guaranteed to be diffeomorphic ( 1 - 1 and onto ) , even with a large deformation or large number of landmark constraints . </S>",
    "<S> the proposed algorithm can also be combined with matching intensity ( such as image intensity or surface curvature ) to improve the accuracy of the registration . </S>",
    "<S> experiments have been carried out on both synthetic and real data . </S>",
    "<S> results demonstrate the efficacy of the proposed algorithm to obtain diffeomorphic registration between images or surfaces .    registration , large deformation , diffeomorphic , quasi - conformal mapping , beltrami coefficient </S>"
  ]
}