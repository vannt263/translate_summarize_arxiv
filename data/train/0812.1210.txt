{
  "article_text": [
    "this paper serves two main purposes .",
    "the first is to establish a detailed record of the uves wavelength calibration and spectrum addition procedures used in the measurement of the fundamental constant @xmath2 @xcite based on spectra taken with uves on the vlt .",
    "the second purpose is a description of an alternative to the pipeline method of establishing a wavelength calibration of very large telescope ( vlt ) uv - visual echelle spectrometer ( uves ) spectra . in a belief that a scientific result on the value of a fundamental constant in the early universe should be described well enough that it can be repeated by other researchers ,",
    "we have provided more detail than is usually present in the description of a data reduction method .",
    "the standard data reduction pipeline provided by the european southern observatory ( eso ) for uves does an excellent job of providing well calibrated spectra for use in most scientific investigations .",
    "certain investigations , however , require a more precise wavelength calibration than is provided by the pipeline .",
    "@xcite point out that the uves pipeline wavelength calibration has systematic deviations in accuracy that can adversely affect precise measurements .",
    "in addition , proper validation of the accuracy of results obtained from a pipeline data reduction requires an exact knowledge of the pipeline data reduction procedures .",
    "this is often not easily available or discernible for a standard pipeline .",
    "one example of such observations is the measurement of the values of fundamental constants in the early universe such as @xmath3 , the fine structure constant and @xmath4 , the ratio of the proton to electron mass , through precise spectroscopy of distant objects .",
    "the faintness of such objects often makes the use of techniques such as iodine absorption cells impractical .",
    "this article describes a set of observing and data reduction procedures that can improve upon the wavelength accuracy relative to that available with the standard uves pipeline .",
    "the procedures achieve a wavelength accuracy of @xmath5 for thorium - argon lines in the long - slit calibration spectra for uves with a slit width of 0.8 arc seconds . the main component in achieving this accuracy",
    "is the proper selection of appropriate calibration lines , similar to that of @xcite .",
    "the examples used in this analysis are vlt uves spectra of q0347 - 383 and q0405 - 443 taken in january of 2002 and 2003 respectively .",
    "these particular spectra have been used to determine the value of @xmath4 at early times in the universe ( @xcite and references therein , @xcite ) .",
    "the measurements of @xmath4 are based on the absorption line wavelengths of molecular hydrogen produced in damped lyman alpha clouds along the line of sight to the qso .",
    "the redshifts of the h@xmath6 lines are z=3.0249007 for q0347 - 383 and z=2.5947361 for q0405 - 443 @xcite . in this work , however , we concentrate on the long - slit calibration line spectra that accompany these observations and the proper addition of the individual 2x2 binned pixel object spectra that are an intermediate product of the uves pipeline data reduction . in all of the following the word pixel",
    "refers to the 2x2 binned pixels produced during readout and maintained during the pipeline processing .",
    "the goal is to find , as accurately as possible , the true wavelength solution for each order of the spectrum and how that solution varies with time during the course of the observations .",
    "all solutions are for vacuum wavelengths .",
    "the wavelength calibration techniques are independent of the objects being observed .",
    "the best results occur when a rigorous sequence of object and calibration observations is performed .",
    "this sequence was not strictly followed in this case but the sequence is close enough to be useful .",
    "the observations of q0347 - 383 and q0405 - 443 with uves on vlt occurred during the nights of january 7 - 9 2002 for q0347 - 383 and january 4 - 6 2003 for q0405 - 443 from a program described by @xcite and @xcite . on each of the nights",
    "three separate spectra of the qso were taken with accompanying short and long - slit calibration lamp integrations at the same grating setting , all with a slit width of 0.8 arc seconds .",
    "we note that the long - slit calibration lamp spectra are included in the observation definition , presumably to prevent a resetting of the grating position between the object and calibration spectra . in this analysis",
    "we only use the long slit calibration spectra which have a higher signal - to - noise ratio than the short slit spectra . for q0347 - 383 two",
    "long - slit calibration spectra were taken each night immediately after the first and second object spectra with the third object spectrum occurring immediately after the second long - slit calibration spectrum . for q0405 - 443",
    "three long - slit calibration spectra were taken on the first and third night immediately after each of the three object spectra .",
    "on the second night there is no long - slit calibration spectrum after the second object spectrum so only two long - slit spectra exist for that night .",
    "this appears to contradict the statement in @xcite which states that calibration spectra occurred before and after each object spectrum but it is possible that there are other calibration images that the archive did not associate with the qso integrations .",
    "the q0347 - 383 observations were taken at a grating setting that put the center wavelength at 4300   and the q0405 - 443 observations at a center wavelength of 3900  .",
    "we will refer to these as the 430 and 390 grating settings in the following .",
    "we use only the blue channel spectra since they contain the spectral area of interest for the measurement of @xmath4 .",
    "table  [ tab - lag ] gives some of the observing parameters for the long - slit calibration lamp images .",
    "for very accurate wavelength calibration we suggest an observing sequence that takes several ( more than five ) long - slit calibration line spectra immediately before and immediately after each spectral image of the observed object . the primary purpose of the multiple calibration line images is to produce a meaningful median image that is free of cosmic ray events rather than an increase in the signal to noise ratio of the image .",
    "the time pacing of the calibration images also tracks drifts in the wavelength calibration due to any contributing factor .",
    "the small amount of extra time devoted to this observing sequence can make the production of cosmic ray free images straight forward . observing the calibration lamp immediately before and immediately after an object observation provides an accurate monitor of any time variation in the wavelength calibration .",
    "if the object observations are spaced close together one set of calibration lamp exposures can serve as both the before and after function for intermediate object exposures .",
    "all files associated with the observations of the two qsos were downloaded from the eso data archive .",
    "the midas based uves pipeline reduction software was also downloaded and installed in a linux based operating system .",
    "all of the data were processed with the pipeline software which removes the bias and dark counts .",
    "the bias and dark corrected files are designated by the the suffix b_.bdf in their file names .",
    "all of the image files are converted to fits format files using the midas outdisk / fits procedure .",
    "our analysis starts with the two dimensional fits format images of the long - slit calibration lamp images and long - slit flat - field images that have been bias and dark subtracted but not flat fielded .",
    "these files are identified by the terms lamp , wave and lamp , flat in the object parameter in the file header .",
    "we also utilize the short slit lamp flats identified by lamp , orderdef for identifying the location of the orders .",
    "a pipeline produced table of x and y line positions is used to provide a first guess and the wavelength solution . in this and in all other references to x and y",
    ", the x direction is along the dispersion direction and the y direction is perpendicular to the dispersion direction as seen in the pipeline rotated images .",
    "the order traces are generally along the x direction but are curved and tilted upward .",
    "the pipeline produced intermediate product spectra are used to produce the final spectrum .",
    "we do not use the primary output of the pipeline which are spectra interpolated to an equally spaced wavelength grid .",
    "all procedures are written in idl code . in the following",
    "we will write idl provided procedure names in capital italic letters and procedures written by the authors using idl code in lower case italics . after further refinement",
    "the authors intend to make the reduction code available to the public , hence the use of the procedure names in the flow charts . following the production of the pipeline products the wavelength calibration proceeds in two semi - independent phases .",
    "the first phase , called the first pass , uses the long - slit bias corrected images produced by the pipeline reduction . in the first pass the long - slit calibration images for a given setting",
    "are median combined to form a `` master '' long - slit calibration image that is free of cosmic ray hits .",
    "a first guess at the wavelength solution based on the line positions output by the pipeline provides the initial wavelength solution for each order .",
    "the solution is then iterated interactively and a set of `` good '' calibration lines is identified .",
    "this step involves some subjective judgment on the definition of good that is discussed below . in the second phase ,",
    "called the second pass , the exact spatial locations of the good lines are determined .",
    "each long - slit calibration image is shifted to a common position and a new median image is produced .",
    "the shifts are typically on the order of a few hundredths of a pixel .",
    "the wavelength solution is again interactively iterated to provide the final solution for each order .",
    "the primary output is a high signal - to - noise ratio master long - slit calibration lamp image and a vacuum wavelength solution for each order .",
    "the method assumes that the differences between two calibration lamp images at the same grating setting are small in order to form a useful median image at the beginning of the first pass data reduction .",
    "once the master long - slit calibration line image has been produced , however , the actual shifts of subsequent images can be accurately determined from the master .",
    "an overview flow chart of this process is shown in figure  [ fig - ov ] .",
    "the individual procedures of the analysis are described in subsequent sections .",
    "the first phase of the method , after producing the pipeline products , is to make a first pass at the wavelength solution which will be improved in the second pass .",
    "this step can be eliminated in subsequent measurements at the same grating setting once a master long - slit calibration line image and wavelength solution have been established .",
    "a flow diagram of the first pass wavelength calibration procedures is shown in figure  [ fig - fp ] .",
    "the names in the boxes that end in .pro are simply the names of the idl based procedures that were developed for this process .    the first pass starts by sorting all of the two dimensional images to determine their type by the entry into the object parameter of the image headers .",
    "all of the long slit calibration lamp images are median combined to eliminate the cosmic ray events .",
    "there is no attempt in this first pass to adjust the images for small shifts in the location of the lines .",
    "the positions of the lines typically had shifts of a few hundredths of a pixel over a three - night set of images .",
    "the 390 grating setting median contains 6 images and the 430 setting image contains 8 images .",
    "visual inspection of the images did not detect any residual cosmic ray hits .",
    "the location of each of the spectral orders must be determined to start the spectrum fitting .",
    "the short slit flat lamp images are used to determine the order positions .",
    "the first step is to median the images together to elliminate cosmic ray events .",
    "one order definition image was taken in each night therefore the medians contain three images which is a minimum , but certainly not optimal , number of images to form a median .",
    "figure  [ fig - ord ] shows the @xmath7 binned pixel median order - definition - image for the 390 grating setting .",
    "figure  [ fig - ord ] shows that the intensity of the order definition image varies strongly over the image in both the horizontal and vertical directions .",
    "this is a challenge to an automated order finding algorithm .",
    "the intensity variation of the spectra is similar and results in the first 100 pixels of the spectrum being rejected due to a poor signal - to - noise ratio .",
    "the orders are curved and are slanted upward going from left to right .",
    "next a first solution to the position of the orders is found . at this point",
    "the procedure becomes partially uves specific .",
    "the procedure knows that the pipeline has rotated the images so that the orders run horizontally from left to right with a slight upward tilt .",
    "it therefore looks for new orders appearing from the bottom of the image and knows that it should look for orders along the vertical direction .",
    "an efficiency map is formed by smoothing the order image with a 101 by 101 box four times .",
    "the search for orders starts 100 pixels past the left edge of the order image .",
    "the region past 100 pixels is binned in groups of 10 columns each and the groups are summed to form single columns of higher signal to noise for both the original order image and the smoothed image .",
    "the derivative is taken of each order column and the order position is defined by the s - shaped curve produced when an order is encountered .",
    "the order position is where the value of the derivative changes sign between positive and negative .",
    "the derivative must have at least two positive values followed by two negative values to be considered an order position .",
    "the flux at that position in the summed order column is compared to the flux in the smoothed column to check against noise that could produce the same pattern of two positive values followed by two negative values in the derivative . if an order is found below the lowest existing order a new order is declared and it becomes the lowest existing order .",
    "after all of the order points have been found the orders are fit in x and y with a quadratic fit .",
    "the fit is displayed on the computer screen overlaying the order image to check for any bad fits .",
    "the output is an array which has the quadratic coefficients plus the pixel numbers of the starting and ending pixels where the order is valid .",
    "orders that run off the top of the image have ending pixel values less than the 1500 pixel extent of the image .",
    "this array is used as the starting point of the final step in the order definition .    after the initial order definition step the y position of each order for each pixel column",
    "is defined . at each order position defined by the quadratic fit",
    "a gaussian fit is found in an 11 pixel column centered on the pixel position given by the fit .",
    "the idl procedure _ gaussfit _ fits a gaussian plus a constant offset to the column to determine the y position of the peak . after the x and y position for each order",
    "is determined by gaussian fitting each order is fit with a six term legendre polynomial fit using the idl procedure _ svdfit _ with the legendre option set .",
    "the legendre polynomial order fit gives the y position in pixels of each order for every pixel column .",
    "this is then taken as the vertical center position of the order at each horizontal pixel position in the long slit calibration lamp images in the following analysis .      although not absolutely critical to the wavelength calibration , the next step in the analysis is the production of the flat - field .",
    "this is identical to the flat field used in the object spectrum analysis , therefore it is also used in extracting the calibration lamp spectrum for consistency .",
    "the flat - field is constructed from the median of all of the long - slit flat - field images taken at the desired grating setting .",
    "the procedure first determines the length of the slit by looking at the center of the middle order .",
    "it determines along a vertical line where the intensity of the image falls to 1/2 of the maximum and defines the height between those points as the length of the slit .",
    "the procedure produces a flat correction image which is the inverse of the long - slit flat lamp image in the region of each order defined by the length of the slit and the beginning and ending of the order as defined in   [ ss - od ] .",
    "the image is divided by the median of all of the non - zero pixels in the flat correction image to make the median of the non - zero pixels equal to one .",
    "correction of the object spectra is achieved by multiplying the object spectrum image by the flat correction image .",
    "the long - slit calibration lamp images have low level background stray light from nonspecular reflections , grating imperfections and other sources . the next step in the analysis",
    "removes the smooth component of the stray background light to first order .",
    "the photon noise from the background light is , of course , still in the stray - light - corrected image . to start the procedure the median long - slit calibration lamp image",
    "is multiplied by a mask that is zero in the regions that contain the calibration lamp spectra and 1 in the inter - order regions .",
    "we assume that the stray light observed in the inter - order region extends smoothly into the regions containing the orders .",
    "the masked image is divided into regions of 10 columns each .",
    "each region of 10 columns is median combined in the horizontal direction to form single columns of higher signal - to - noise ratio .",
    "a third order polynomial is fit along the vertical direction of each of the columns using only the non - zero inter - order regions of the columns .",
    "this produces a set of measures of the stray light in the vertical direction spaced every 10 columns in the middle of each 10 column region .",
    "this results in a stray light image that has more resolution in the horizontal direction than in the vertical .",
    "this was done because the variation of the stray light appears to be stronger in the horizontal direction than in the vertical .",
    "the final stray light image is formed by interpolating the solution in the horizontal direction for each row of the image .",
    "this smooth distribution is then subtracted from the median long - slit calibration lamp image .",
    "the spectrum extraction procedure produces a two dimensional image of each order .",
    "the height of the image is the slit length in pixels and its length is the length of the spectral image in pixels .",
    "the total output is a four dimensional array with the dimensions spec[nx , norders,6,length ] where nx is the number of pixels in the x direction , norders is the number of usable orders and length is the length of the slit in pixels .",
    "for the 6 inputs in the third index the first is the wavelength , which at this stage is just the pixel number , the second is the flux , the third the noise , and the other 3 are populated later in other spectral analysis procedures .",
    "the first step in the procedure is to multiply the total spectral image by the flat - field correction image described in   [ ss - ff ] .",
    "the procedure next extracts the two dimension spectral image of each order .",
    "the center pixel in the vertical direction for each order is determined by the order solution discussed in ",
    "[ ss - od ] .",
    "the idl procedure round finds the pixel number and the pixels above and below the center pixel are extracted according the the value of the slit length in pixels .",
    "the flux is in adus ( analog to digital converter units ) . the spectral image of the fifth order in the array is spec[0:nx-1,4,1,0:length-1 ] in the idl array . in idl",
    "the nomenclature a : b means all entries with indexes a through b. the first index in idl is 0 rather than 1 which accounts for the length-1 in the preceding and why the fifth order has index 4 .",
    "the noise for each pixel is computed as the root mean square of the photon and read noise .",
    "the flux in adus per second is converted to electrons using the conversion factor in the header and the flat - field correction .",
    "the read noise is also listed in the header .",
    "the calculated noise in electrons is the square root of the sum of the total number of electrons plus the square of the read noise .",
    "the noise in electrons is converted back into adus and re - corrected for the flat - field .",
    "the noise image is in the same format as the flux except that the third index in the extraction array is 2 rather than 1 .",
    "the next step is the creation of a one dimensional spectrum for each order from the individual strips of spectra created by the extraction .",
    "inspection of the long - slit calibration line image indicates that the intensity along the length of the slit is quite uniform and that the image of the slit is vertical with no apparent deviation over the entire field of view . for these reasons",
    "the assembled one dimensional spectrum is simply the sum of all of the pixels in the vertical direction .",
    "if there is any fractional pixel tilt in any part of the field of view it would result in a slightly lower resolution but the center point of the line would still be the same .",
    "a comparison of the object spectra with the order definition positions confirmed that the object spectra maxima lie at the middle of the slit length .",
    "the noise is simply the square root of the sum of the squares of the noise determined for each pixel during the spectrum extraction . after this stage",
    "we have individual one dimensional spectra for each order .",
    "the physical orders are 141 to 102 for the 390 grating setting and 127 to 95 for the 430 grating setting , however only a subset of the orders had object spectra appropriate for the determination of the value of @xmath4 at the redshifts of the absorption line systems .",
    "we list the order numbers in inverse order since the image orientation returned by the pipeline has the order number decreasing in the vertical direction .",
    "the spectrum data cube now has the dimensions spec[nx , nord,6 ] since the previous array was summed along its fourth dimension .",
    "note that nord equal to zero corresponds to order 141 and 127 for the 390 and 430 grating settings .",
    "a value of nord equal to 1 corresponds to orders 140 and 126 respectively etc .",
    "the uves pipeline reduction produces a table of the x and y positions for calibration lines during the pipeline reduction along with the air wavelengths of the line and the order number .",
    "the table is labeled lxxxblue.tbl for the blue channel where xxx is the grating setting such as 390 .",
    "we use the procedure _",
    "_ on the output of this table to produce a preliminary wavelength solution for each order .",
    "the first step is the conversion of the air wavelengths to vacuum wavelengths by the formulas of @xcite as given in the @xcite .",
    "the _ lineguess _ procedure uses the idl procedure _ svdfit.pro _ in double precision with the legendre polynomial option set to produce a six term legendre polynomial fit to the wavelengths .",
    "the outputs of the procedure are six coefficients of the first six legendre polynomials for each order .",
    "these coefficients are the inputs to the procedure _",
    "waveput1m1.pro _ which converts the pixel numbers in the wavelength array of the spectrum to wavelengths .",
    "the wavelength for each of the nx pixels for an order nord in the output data cube is given by spec[0:nx-1,nord-1,0 ] .",
    "[ ss - rw ] for more details of the wavelength fitting .",
    "an important part of the wavelength calibration improvement over the pipeline calibration is the use of newly published line lists .",
    "the thorium and argon line lists came from two sources , @xcite and @xcite .",
    "@xcite list all of the thorium - argon lines between 3785.6 and 6914.4   found in a dedicated observation of thorium - argon lines with the harp spectrometer .",
    "the line list from @xcite lists lines between 3033.5 and 10506.5  .",
    "this list only includes lines that have been deemed acceptable in @xcite for accurate wavelength calibration .",
    "our lists were constructed from files kindly sent by michael murphy prior to publication , however , the files are now available from websites listed in the publications .",
    "our final list of lines contains all of the lines in the @xcite list plus the lines from @xcite that lie at shorter wavelengths than the @xcite list .",
    "the data from the lists for each line are entered into an idl data structure .",
    "an idl data structure is a list of parameters that can be a mixed combination of numbers , text strings or arrays , each with a different format .",
    "the structures for all of the identified lines are identical in format and the entire set of lines forms an idl structure array for easy access by the idl based analysis procedures .",
    "the data items for each line in the idl structure are : the wavenumber in @xmath8 ; the vacuum wavelength in  , the standard pressure and temperature ( stp ) air wavelength , the previously determined wavelength listed by @xcite , the error from @xcite , the intensity , the identification , and a `` murphy '' flag .",
    "the `` murphy '' flag is the letter m if it is listed by @xcite as a good line and the letter n if it is not .",
    "note that the @xcite list contains all of the observed lines in its wavelength range while @xcite only list the good lines therefore all of the lines outside the range of the @xcite lists are `` murphy '' lines .",
    "the next step in the first pass through the wavelength calibration is the location of the calibration line positions in the median long - slit calibration line image and a preliminary identification of the proper thorium or argon line for the line position from the line list described in   [ sss - ta ] .",
    "the line identification procedure for a particular order first determines the median flux in the order which is assumed to be the continuum emission from the calibration lamp and subtracts that from the order flux .",
    "possible line positions are identified by taking the derivative of the flux versus pixel position with the idl procedure _ deriv _ and looking for the positive to negative zero crossing that the positive and negative slopes of an emission line create in the derivative .",
    "a legitimate zero crossing requires two positive derivative values followed by two negative derivative values .",
    "the procedure does several checks on the legitimacy of the position .",
    "the flux at the position must be greater than a preset threshold which is equal to the median previously subtracted from order flux .",
    "if the line flux is only positive for one pixel or if the line appears on the side of another line it is rejected .",
    "after identification via the derivative method a gaussian fit is done at the positions that survived the checks described above to find the line position with fractional pixel accuracy .",
    "this is a straight gaussian fit with no continuum as the continuum was subtracted earlier .",
    "this is done with a slightly modified version of the idl procedure _ gaussfit _ called _ gaussfitstat _ that returns the status flag of the fitting procedure as well as the parameters of the gaussian fit .",
    "any position with a bad status flag , indicating an internal idl error such as underflow or overflow , is rejected . the position found by the gaussian fit",
    "is placed in a new line structure along with the coefficients of the gaussian fit . unlike the th / ar line list the new structure array only contains structures for the lines found in the median long - slit calibration line image",
    ". the structure for each line has 22 different entries which eventually include the information from the th / ar line lists , the `` murphy '' flag , the spectral order and other information for record keeping .",
    "one of the entries is a `` use '' flag on whether it should be used in the final wavelength solution .",
    "not all lines with positive `` murphy '' flags were used in the solution .",
    "after all of the line positions have been determined a preliminary assignment of line identifications is made .",
    "the preliminary wavelengths are matched against an atomic line list described above in   [ sss - ta ] .",
    "the line in the list with the closest wavelength to the measured wavelength of the line is assigned as the preliminary identification .",
    "there are 3751 identified lines for the 390 grating setting and 3087 lines for the 430 setting .",
    "most of these lines are not be used in the wavelength calibration      the wavelength calibration is performed using vacuum wavelengths .",
    "this means that the wavelength solution produced assigns the proper vacuum wavelength for each th / ar line as the appropriate wavelength for that pixel position in each order .",
    "the observations , however , were in conditions nearer to stp than vacuum .",
    "the wavelength calibration solution simply gives the vacuum wavelength as a function of pixel position .",
    "as such it is only valid for observations carried out under similar atmospheric conditions to those present when the calibration observations were taken . this would be true whether we used stp wavelengths , current atmosphere wavelengths or vacuum wavelengths .",
    "the @xcite measurements were made in vacuum therefore we have chosen vacuum wavelengths as our standard .",
    "the shifts in temperature for any night of observation were 0.1 degrees centigrade or less and the pressure shifts were 0.7 mm .",
    "hg or less during a night as shown in table  [ tab - lag ] . at 4000",
    "   the rate of change of air wavelength is less than @xmath9   per degree centigrade and slightly more than @xmath10   per mm .",
    "these are changes on the order of 1 part in @xmath11 or less for all nights and are 1/3 or less of the accuracy of our wavelength solution . since shifts are calculated on a night to night basis and on an order by order basis , any shifts between nights are accounted for in the zero point calculation for the wavelengths of each order for a night .",
    "future improvements , such as higher resolution spectra , will require a temperature and pressure correction in the procedure .",
    "the final step in the first pass through the wavelength calibration is a refinement of the wavelength solution .",
    "this is accomplished with an interactive idl procedure called _",
    "waverefine_uves _ in figure  [ fig - ov ] .",
    "the procedure provides a method of improving the preliminary 6 term legendre polynomial wavelength solution .",
    "wavelength solutions employing different polynomials and legendre polynomial fits of orders 4 through 7 were tried initially .",
    "the legendre polynomial fits appeared to be the most stable , without high deviations from acceptable fits at the end points of the solutions .",
    "the quality of fits improved up to the 6 order solution used in this work .",
    "the addition of an additional term to make a 7 order fit did not improve the fits and in some cases made them worse .",
    "this choice is probably unique to the uves blue channel and may be different for other spectrometers with different sources of image distortion .    for each order",
    "the procedure initially deems all identified lines as not usable . as each section of the spectrum for an order",
    "is displayed on the monitor the user indicates which lines should be included in the wavelength solution .",
    "a vertical line for each identified line is displayed at the wavelength listed in the line list with a height that is proportional to the strength in the line list .",
    "this helps the user match the observed spectrum to the appropriate lines in the list .",
    "if the line is one of the vetted acceptable lines identified in @xcite then a letter m is printed above the line position . during this first pass the majority of the lines are rejected based on a poor signal - to - noise ratio , asymmetry due to blending or obvious double lines .",
    "each order contains between 80 and 100 lines from the list described above .",
    "usually about 25 lines are selected as usable .",
    "the choices of usable lines are subjective but most of the rejections are fairly obvious .",
    "this rejection ratio is similar to the ratio described in @xcite .",
    "our selection of lines is independent of the @xcite selections in the following manner .",
    "our inital selection and rejection of lines was done without reference to which lines were murphy lines .",
    "this led to the result that some lines that were not murphy lines are included and several murphy lines were rejected . for lines that are bluer than the @xcite list only the murphy lines were available but many of those were rejected .",
    "the statistics for the 390 grating setting are that there are 2209 murphy lines in the spectral region of the observations .",
    "of these we chose 518 to use in our analysis plus 2 that are not murphy lines .",
    "for the 430 grating setting there are 1462 murphy lines in the spectral region of which we chose 527 plus again 2 lines that are not murphy lines .",
    "for obvious reasons most of the selected lines are murphy lines due to similar selection criteria .",
    "almost all of the rejections of murphy lines in our list are due to a more conservative cut on line crowding .",
    "this is a key difference in using the 2x2 binned pixels rather than the individual ccd pixels .",
    "another difference is that our selection is order by order for each of the grating settings .",
    "a line that is selected in one order may be rejected in an adjacent order if it falls in a poor signal to noise region .",
    "after the first pass through the order the procedure produces the legendre polynomial fit to the lines marked usable and displays the deviation of the measured lines from the fit . typically there will be a few extreme outliers .",
    "the program allows the user to add or remove lines from the usable list one at a time .",
    "the new solution is displayed after each addition or removal .",
    "this is the most subjective part of the procedure and the most scientifically dubious .",
    "the rejection of outlying data points is risky .",
    "the assumption here is that the true wavelength solution should be smoothly varying without any discontinuities or high - frequency variation .",
    "practice with the procedure leads to better identification of the outliers that are causing the errors in the solution .",
    "often it is not the furthest outlier that is causing a problem .",
    "removal of a single outlier that produces discontinuous break between positive and negative outliers often greatly reduces the average error .    another subjective aspect to using the procedure",
    "is that the final set of deviations from the solution should be `` random '' .",
    "a solution that produces a sharp break in the sign of the outliers or that has a systematic trend in the location of the outliers is probably wrong .",
    "after the solutions are adjusted typically 20 of the original 25 lines are left as usable .",
    "after all of the orders have their solutions the procedure is repeated several times to improve the fit .",
    "this allows some lines that may have been erroneously rejected in a previous pass to be returned to the usable line list and may result in rejection of other lines .",
    "the first pass data products are : the first pass wavelength solutions which is a set of the 6 coefficients of the first 6 legendre polynomials for each order that represent the wavelength solution for that order in terms of   versus pixel ; a median long - slit calibration image , the first pass one dimensional order by order spectrum ; and the long slit calibration line structure array with the use flag set positive for all of the lines that were deemed usable in the first pass .",
    "all of these products are updated in the second pass through the wavelength solution . the flat correction image ,",
    "order definition solutions and the length of the slit are first pass data products that are not updated in the second pass .",
    "the second pass to the wavelength calibration recognizes that the individual long - slit calibration lamp images taken over the course of the observations are not perfectly aligned .",
    "it computes the offsets between the images using the lines that were declared usable in the first pass .",
    "the procedure shifts the images to a common registration and produces a new median image which becomes the master long - slit calibration lamp image .",
    "it then follows most of the steps used in the first pass to produce a new wavelength solution for the master long - slit calibration lamp image .",
    "it also preserves the shifts calculated for the individual images to provide a baseline to compute the shifts appropriate for the source spectrum images . a flow chart of the second pass procedures is given in figure  [ fig - sp ] .",
    "the procedure starts by reading in the list of long - slit calibration lamp images and the line structure array generated in the first pass . for each line",
    "marked usable the procedure _",
    "make_longcal_mask _ finds the corner coordinates in pixels of a 7 by 21 rectangle in x and y centered on the line position .",
    "these small sub - images are the regions that will be cross correlated to find the shifts between the images . the first long - slit calibration lamp image is arbitrarily chosen as the reference image .",
    "for each line in each image the small two dimensional image is summed in the y cross dispersion direction to form a 7 pixel one dimensional spectrum .",
    "the one dimensional spectra are interpolated to a grid that has a 0.01 pixel spacing and cross correlated with the corresponding interpolated spectrum in the reference spectrum .",
    "the lag producing the maximum cross correlation signal is selected as the shift for that line relative to the reference image .",
    "after all of the shifts have been calculated the shift for each long - slit calibration line image is taken as the median of the shifts for all of the usable lines in the image .",
    "histograms of the shifts for each image are also plotted to check for anomalous distributions of shifts .",
    "the shifts for the 390 and 430 images are given is table  [ tab - lag ] .",
    "once the shifts have been calculated each image is shifted to the position of the zero shift image by interpolation . the idl procedure _ interpolate _ is used with the value of the cubic parameter set to -0.5 and the keyword grid set to true .",
    "the value of cubic is the cubic polynomial interpolation parameter .",
    "it is the value of @xmath3 in the following cubic polynomials r(x ) which are used to calculate the contribution to the interpolated value from adjacent pixels , see @xcite .",
    "@xmath12 @xmath13    @xmath14 @xmath15    @xmath16 otherwise    the shifted images are median combined to produce a cosmic ray free long - slit calibration lamp image .",
    "the stray light removal procedure described earlier in   [ ss - sl ] is performed on the median image and the result is stored as the master long - slit calibration lamp image .",
    "future long - slit calibration lamp images can be added to the master image by repeating the processing with the full set of images .",
    "the second pass spectrum extraction and spectrum assembly are identical to the first pass processing .",
    "the wavelength solution found from the first pass is put into the spectrum .",
    "the idl procedure _ firstlineposition.pro _ again assembles the detected lines into a line structure array with the new parameters from the master long calibration lamp spectrum . rather than starting from scratch the line usage flags from the first pass",
    "are transferred from the first pass line structure array to the second pass array by the procedure _",
    "lineinfoexchange.pro_.    the wavelength solution is again refined in iterative passes as described in   [ ss - rw ] .",
    "the result of this procedure is the master wavelength solution . out of the 3751 identified lines in the",
    "390 grating setting 686 lines were used in the wavelength solution .",
    "only 4 are not in the vetted murphy list .",
    "577 lines out of the 3087 identified lines were used in the 430 grating setting wavelength solution , 3 of which were not in the murphy list .",
    "the difference between these numbers and the numbers in ",
    "[ ss - rw ] is that here a line is counted more than once if it appears in more than one order .",
    "the use rate of the identified lines iss @xmath17 for the 390 setting and @xmath18 for the 430 setting .",
    "this is lower than the retention fraction in the @xcite list .",
    "the final data products for each grating setting are stored for use in determining the wavelength solution for the object spectra .",
    "they include the master long - slit calibration lamp image , the master one dimensional order by order spectrum , the master wavelength solution for that spectrum and the associated structure array of line parameters .",
    "also stored are the wavelength shifts in pixels for each of the individual long - slit calibration lamp images and the times that they were taken .",
    "the last data sets are the median flat correction image , the order definition solutions and the length of the long - slit in pixels from the first pass solutions . a list of the uves thorium and argon lines used for the 390 and 430 grating settings wavelength solutions is included in the electronic version of this paper .",
    "these lists are particular to the grating settings as opposed to the vetted line lists in @xcite .",
    "this is because a line that has a good signal - to - noise ratio in one order may fall in a poor signal - to - noise ratio area in an adjacent order .",
    "the wavelength solutions are given by    @xmath19    where @xmath20 are the legendre polynomials and the @xmath21 are the coefficients for each order that are the products of _ refinewave_uves.pro_. the legendre polynomials are only valid in the range between -1 and 1 therefore the variable x is related to the pixel number p by    @xmath22    where p ranges between 0 and 1499 for the 1500 pixel width of the blue channel .",
    "this means that the largest value of x is 0.99866666 rather than 1 but that is of no consequence since each value of x is unique , equally spaced and within the valid range of the legendre polynomials .",
    "given the nature of the legendre polynomials the coefficient @xmath23 is the wavelength in of the middle of the order and @xmath24 is the linear dispersion in per value of x. the higher order coefficients describe the deviation from linearity of the wavelength solution .",
    "tables [ tab-390 ] and [ tab-430 ] give the coefficients found for the master long - slit spectra at the two grating settings . since all of the long - slit calibration images were shifted to the position of the first calibration image for each run the solutions presented here represent the best wavelength solution for the first calibration image . since the shifts are small between images these solutions can be used as starting points for other spectra at those grating settings .",
    "we can estimate the accuracy of the wavelength solution by looking at how accurately the 6 term legendre polynomial solution reproduces the measured vacuum wavelengths of the calibration lines used in producing the solution .",
    "the statistical look at the fits is appropriate since for most orders the number of lines used in the solution is 3 to 4 times the number polynomial terms .",
    "the statistics of the fits for all of the lines gives a standard deviation on the fractional error @xmath25 of @xmath26 for the 390 grating setting and @xmath27 for the 430 grating setting .",
    "a listing of the fractional errors for each order used in the program described by @xcite is given in table [ tab - stat ] .",
    "the distribution of errors is shown in figures  [ fig - wh3 ] and [ fig - wh4 ] where the fractional differences between the calculated and listed wavelengths are shown in histograms with a bin size of @xmath28 .",
    "the histograms are reasonably symmetric about zero and the @xmath29 values correspond to roughly 75 m s@xmath30 .",
    "comparison with figure 8 in @xcite indicates that the wavelength errors are a factor of 2 less than the pipeline values but somewhat more than achieved by @xcite for their data sets which contain more calibration line images than this work , a narrower slit width ( 0.6 rather than 0.8 arc seconds ) and unbinned images . in both cases",
    "the line selection is the primary component in improving the accuracy of the calibration .",
    "the data sets we use , however , are the calibration line spectra taken at the time of the observations we want to calibrate and better represent the wavelength calibration for those objects .",
    "one of the primary points of @xcite is that the pipeline uves wavelength calibration has significant systematic residuals as shown in their figure 9 and that this residual can give false indications of variation in the measurement of the fundamental constant @xmath3 .",
    "the same systematic error residual can affect the measurement of @xmath4 as well but in a different manner @xcite than for @xmath3 . since the primary purpose of this paper is to document the wavelength calibration for the determination of @xmath4 at early times in the universe we have carried out an analysis similar to that of @xcite for our wavelength calibration .",
    "figures  [ fig - ep3 ] and [ fig - ep4 ] show the scatter of all of the calibration line fits that are used in the determination of @xmath4 at both the 390 and 430 grating settings .",
    "this figure can be directly compared to figure 9 in @xcite .",
    "the solid black line is the mean residual in 100   bins .",
    "it is clear that the large scale residuals present in the uves pipeline calibration are not present in the wavelength calibration presented here .",
    "the minimum near 3550   in figure  [ fig - ep3 ] is not well understood but may be simply a statistical anomaly .",
    "once the wavelength calibration has been performed it can be applied to the individual spectra of the objects produced by the pipeline .",
    "a typical script for the pipeline reduction is given in appendix  [ a - red ] the standard output of the uves pipeline are spectra that have been interpolated onto a constant increment wavelength grid .",
    "all orders have been combined to produce a continuous spectrum with no order breaks .",
    "the details of this process are not immediately obvious from the pipeline documentation @xcite .",
    "the results of the optimal extraction described in @xcite are , however , available as an intermediate product .",
    "these files for the blue channel are labeled fxb_uves*_b.fits , where the * represents a date and time tag along with a 3 digit identifier .",
    "these are order by order one dimensional optimal extractions of the spectra .",
    "the object spectra wavelength solutions start with a determination of the shift in wavelength of the object spectrum relative to the master wavelength solution .",
    "this is done by fitting the shifts of the individual long - slit calibration lamp images versus time for each night of observing . for nights with just two images",
    "this is a linear fit .",
    "nights with 3 images are fit with a quadratic fit . the shifts for the object spectra are determined from the shift versus time fit function by the midpoint in time of the integration .",
    "the shifts are similar to the shifts for the calibration spectra shown in table  [ tab - lag ] which are on the order 0.01 - 0.02 pixels .",
    "the master solution is interpolated to the shifted positions found above and placed into the wavelength section of the spectrum array .",
    "this wavelength solution is the appropriate vacuum wavelengths for a source at rest relative to the spectrometer and therefore has to be corrected for barycentric velocity .",
    "the appropriate barycentric velocity is calculated for the midpoint of the observation and the wavelength solution is then corrected to account for the barycentric velocity of the earth at the location of the vlt . at this point in the analysis",
    "the center points of the pixels in the different object spectra have different wavelength solutions .    in preparation for addition of the spectra",
    "the spectra are all shifted to the wavelength solution of the master wavelength solution by interpolation .",
    "the interpolation shift is determined from the shift relative to the master solution calculated above .",
    "this is not done initially since the various spectra have slightly different barycentric velocity contributions .",
    "as with the long - slit calibration spectra that bracket the observations , the shifts from the master solution is generally on the order of a few hundredths of a pixel .",
    "the spectra now all have the same pixel wavelength solution and can be added together .      since the spectra",
    "now all have the same wavelength per pixel solution they can be directly added together for each order .",
    "the 9 spectra for each object are combined to produce both the median and the mean for each pixel .",
    "the median better rejects any residual cosmic ray hits in the spectra and provides the primary spectrum for the analysis of the value of @xmath4 in @xcite .",
    "the mean spectrum is also analyzed to provide a check on the median spectrum .",
    "other `` optimal '' additions methods were utilized that weight the pixel flux by its signal to noise ratio .",
    "these methods did not produce quantifibly better results than the median spectra .",
    "this is most probably due to the remarkable uniformity of the spectra between observations of the same object . for this reason we utilize the median spectra in our analysis .",
    "data sets with significantly varying signal to noise ratios between spectra will certainly benefit from more optimal spectrum addition methods .",
    "the measurement of fundamental constants through astronomical spectra requires the best possible wavelength calibration that can be achieved .",
    "this requires both observing and data reduction procedures beyond what is practical for most standard observation and data reduction procedures .",
    "the procedures described in this paper have achieved a @xmath29 fractional @xmath31 wavelength accuracy of better than @xmath32 for uves spectra which is a factor of 2 better than the accuracy of the uves pipeline reduction .",
    "more importantly there is no detectable systematic residual wander as was discovered by @xcite in the pipeline wavelength calibration .",
    "the reduction methods are described in detail so that they can be repeated by other researchers and a suggested observing sequence was presented that can improve the accuracy of both the wavelength calibration and its transfer to the object spectra .",
    "this paper serves as a detailed description of the calibration procedures used in the determination of the fundamental constant @xmath4 through the molecular hydrogen absorption lines in the spectra of two qsos @xcite .",
    "rit wishes to acknowledge and thank wim ubachs for several discussions and comments that have greatly improved this paper .",
    "rit also wishes to acknowledge the helpful comments of an anonymous referee that greatly benefited this paper .",
    "c.m wishes to acknowledge very useful discussion with paolo molaro .",
    "the work of c.m . is funded by a cincia2007 research contract .",
    "ballester , p. et al .",
    "2004 , uves pipeline user s manual , doc .",
    "vlt - man - eso-19500 - 2964 , issue 7 ( uves pipeline v2.2.0 ) .",
    "crc handbook of chemistry and physics 75th edition 1994 , ed .",
    "lide , crc press , boca raton , p--302 .",
    "edln , b. 1966 , metrologia , 2 , 71    ivanchik , a. et al .",
    "2005 , a&a , 440 , 45    king , j.a . ,",
    "webb , j.k . ,",
    "murphy , m.t . & carswell , r.f .",
    "2008 , astro - ph0807.4366v1    lovis , c. & pepe , f. 2007 , a&a , 468 , 1115    park , s.k . &",
    "schowengerdt 1983 , computer vision , graphics , and image processing , 23 , 258    murphy , m.t . , tzanavaris , p. , webb , j.k . , & lovis , c. 2007 , mnras , 378 , 221    petitjean et al .",
    "2004 , comptes rendus physique , 5 , 411    reinhold , e. , buning , r. , hollenstein , u , ivanchik , a. , petitjean , p. , & ubachs .",
    ", w. 2006 , prl , 96 , 151101    thompson , r. , bechtold , j. , black , j. , fan , x. , kennicutt , r. , martins , c. , prochaska , j.x . , & shirley , y. 2008 , in preparation .",
    ".dates , shifts in position in pixels , temperature and pressure for the 390 and 430 grating setting long - slit calibration lamp images [ cols=\"^,^,^,^,^,^,^,^ \" , ]                      for the 390 grating setting ]     for the 430 grating setting ]     for the 390 grating setting .",
    "the solid black line is the mean of the residuals in 100   bins to check for systematic residuals . ]     for the 430 grating setting .",
    "the solid black line is the mean of the residuals in 100   bins to check for systematic residuals . ]",
    "the following is a set of typical commands is used with the midas based uves pipeline to produce the pipeline products used in this analysis .",
    "it is presented for completeness and as an example of the process .",
    "individual batch reductions may vary slightly from the example .",
    "the commands are issued in the directory that contains the data recovered from the archive .",
    "this script was for the q0347 - 383 spectra at the 430 grating setting ."
  ],
  "abstract_text": [
    "<S> this paper addresses alternative procedures to the eso supplied pipeline procedures for the reduction of uves spectra of two quasar spectra to determine the value of the fundamental constant @xmath0 at early times in the universe . </S>",
    "<S> the procedures utilize intermediate product images and spectra produced by the pipeline with alternative wavelength calibration and spectrum addition methods . </S>",
    "<S> spectroscopic studies that require extreme wavelength precision need customized wavelength calibration procedures beyond that usually supplied by the standard data reduction pipelines . </S>",
    "<S> an example of such studies is the measurement of the values of the fundamental constants at early times in the universe . </S>",
    "<S> this article describes a wavelength calibration procedure for the uv - visual echelle spectrometer on the very large telescope , however , it can be extended to other spectrometers as well . </S>",
    "<S> the procedure described here provides relative wavelength precision of better than @xmath1 for the long - slit thorium - argon calibration lamp exposures . </S>",
    "<S> the gain in precision over the pipeline wavelength calibration is almost entirely due to a more exclusive selection of th / ar calibration lines .       </S>",
    "<S> techniques : spectroscopic    95.75.fg , 95.75.pq , 95.55.qf </S>"
  ]
}