{
  "article_text": [
    "recent detections of planets around other stars have spurred a wide range of research on planet formation and planetary system evolution .",
    "the first planet discovered around a solar type star , 51 pegasi b , was in a surprisingly short period orbit @xcite .",
    "other early planets such as 70 virginis b revealed surprisingly large orbital eccentricities @xcite .",
    "multiple planet systems have revealed intricate dynamical interactions such as the resonances in upsilon andromedae @xcite and gj876 @xcite .",
    "the future of radial velocity planet searches promises to be exciting",
    ". ongoing large surveys including a broad array of nearby main - sequence stars will continue to increase the number of known extrasolar planets .",
    "refinements in the radial velocity technique should continue to improve measurement precision , permitting the detection of planets with smaller masses .",
    "the increasing time span of precision observations will permit the discovery of planets with larger orbital periods .",
    "several stars presently known to harbor one planet are expected to reveal additional planets in longer period orbits @xcite .",
    "these advances will also bring new challenges .",
    "the 51 pegasi - like planets could be rapidly confirmed by independent observers @xcite due to their short orbital periods and large velocity amplitudes .",
    "however , for a given signal - to - noise ratio , the time required to obtain observations to confirm or refute a possible planetary candidate will typically scale with the orbital period of the planet .",
    "already , one known planet ( 55 cancri d ) has an orbital period of over 14 years @xcite .",
    "it is also more difficult to obtain precise orbital elements for planets with large orbital periods .",
    "while early planet candidates were routinely observed for multiple periods before publication , recently planet candidates have been published when observations span only a single orbital period .",
    "thus , it will become increasingly easy to over - interpret early orbital determinations .",
    "a further challenge is that the growing precision and time span of radial - velocity measurements are expected to significantly increase the number of stars known to harbor multiple planets .",
    "fitting multiple - planet systems requires many more free parameters , so that observational data may not tightly constrain all the orbital parameters or even distinguish between multiple possible orbital solutions , especially in the presence of significant noise and sparsely sampled data .",
    "these trends imply that it will become increasingly important to understand the uncertainties in orbital elements and other parameters derived from such observations , and thus we must use the best possible statistical tools to analyze radial velocity data .    in this paper we introduce a bayesian analysis for constraining the orbital parameters of extrasolar planets with radial velocity observations .",
    "the bayesian framework considers a joint probability distribution function for both the observed data ( @xmath1 ) and model parameters which can not be directly observed ( @xmath2 ) .",
    "this joint probability , @xmath3 , can be expressed as the product of the probability of the observables given the model parameters , @xmath4 , and a prior probability distribution function , @xmath5 , which is based on previous knowledge of the model parameters .",
    "bayes s theorem allows one to compute a posterior probability density function , @xmath6 , which incorporates the knowledge gained by the observations @xmath1 .",
    "that is @xmath7 unfortunately , the lower integral can be extremely difficult to compute , particularly when @xmath2 has a large number of dimensions . even after this integral",
    "is performed , most questions require additional integration of @xmath8 over many of the model parameters .",
    "this paper describes the application of markov chain monte carlo ( mcmc ) simulation using the metropolis - hastings algorithm and the gibbs sampler to perform the necessary integrations .",
    "this technique allows us to accurately characterize the posterior probability distribution function for orbital parameters based on radial velocity observations .    in this paper",
    "we first describe our model for calculating radial velocities from planetary orbital parameters . in ",
    "3 we summarize methods for identifying the maximum likelihood orbital solution for a set of observed radial velocities .",
    "then , we discuss methods of characterizing the uncertainties of model parameters in  4 .",
    "we focus our attention on the application of markov chain monte carlo ( mcmc ) simulation to estimate the uncertainties for orbital parameters in a bayesian framework . in ",
    "5 we apply this technique to analyze several published extrasolar planet data sets . finally , we summarize the potential of this technique as additional long period planets and multiple planet systems are discovered .",
    "in radial velocity surveys , the velocity of the central star is precisely monitored for periodic variations which could be caused by orbiting companions .",
    "each individual observation can be reduced to a measurement of the star s radial velocity and an estimate of the observational uncertainty based on photon statistics . because the observations are averaged over hundreds of sections of the spectrum , the observational uncertainties of most current echelle based radial velocity surveys are nearly gaussian @xcite .",
    "stellar activity can also contribute to the observed radial velocities .",
    "however , most of the stars investigated in this paper are chromospherically quiet and so that the contribution of stellar `` jitter '' to the observed radial velocities is believed to be negligible .",
    "such radial velocity observations are able to detect the acceleration of a star due to the gravitational perturbations due to an orbiting planet .",
    "we model the motion of the planet as a keplerian orbit using the parameters : orbital period ( @xmath9 ) , velocity semi - amplitude ( @xmath10 ) , eccentricity ( @xmath11 ) , argument of periastron ( @xmath12 ) , and mean anomaly at the specified epoch ( @xmath13 ) .",
    "the perturbation to the radial velocity ( @xmath14 ) of a star due to a planet on a keplerian orbit is given by @xmath15   % \\ ] ] a planet s true anomaly ( @xmath16 ) is a function of time ( @xmath17 ) and is related to the planet s eccentric anomaly ( @xmath18 ) via the relation @xmath19 the eccentric anomaly is related to the mean anomaly ( @xmath20 ) via kepler s equation @xmath21 where @xmath13 is a constant , the orbital phase at @xmath22 which is related to the time of pericenter ( @xmath23 ) .",
    "for a star being perturbed by multiple planets , there is no analytic expression for the exact radial velocity perturbation .",
    "however , in many cases the radial velocity perturbation can be well modeled as the sum of multiple independent keplerian orbits .",
    "the deviations from the simple sum of keplerians model can be divided into two types : short - period interactions and secular interactions .",
    "the magnitude of the short - period interactions ( deviations from independent keplerian orbits on an orbital timescale ) is often small compared to the magnitude of the keplerian perturbation and the observational uncertainties .",
    "the secular interactions are typically modeled as changes in the keplerian orbital parameters .",
    "while the secular interactions can have large effects on the observed radial velocities , the timescales are typically much longer than the time span of observations .",
    "thus , we model the observed radial velocity of a star as    @xmath24    where @xmath25 is given by eqn .",
    "[ rveqn ] using the orbital parameters of the @xmath26th planet and there is an unknown constant velocity offset ( @xmath27 ) which provides no information about planetary companions . in practice , high precision radial velocity surveys",
    "are typically calibrated such that different observatories have different zero - point offsets , and hence it is important to allow observations from different observatories to have independent constant velocity offsets .",
    "since the uncertainties from individual observational are expected to closely follow a normal distribution , to evaluate the goodness of fit for a given model , we calculate the usual @xmath28 statistic , @xmath29 where @xmath30 is the time of the @xmath31th observation , @xmath32 is the observatory used for the @xmath31th observation , and @xmath33 is the observational uncertainty of the @xmath31th radial velocity observation .",
    "given a set of model parameters ( @xmath2 ) , which are typically the masses and orbital parameters of the planets , we wish to compare the model predictions to the observations using the model and @xmath28 statistic described in  2 .",
    "the maximum likelihood estimate ( mle ) of the model parameters @xmath34 is obtained by finding the minimum @xmath35 .",
    "these are the orbital parameters typically reported as the `` best - fit '' model .",
    "finding the set of parameters which minimizes @xmath28 can be challenging , particularly for multiple planet systems .",
    "often a combination of several methods is used to identify the `` best - fit '' orbital parameters .",
    "promising orbital periods can be recognized as sharp dips in a plot of the period versus the minimum @xmath36 for that period with the phase and amplitude allowed to vary ( a periodogram ) .",
    "there are well developed methods for determining the significance of periodicities identified in this way and estimating the false alarm probability @xcite .",
    "while a single sinusoid can not reproduce the signal of an eccentric keplerian orbit , a periodogram allows the rapid identification of any periodicities in observational data , without requiring a simultaneous fit for amplitude , eccentricity , argument of periastron , or other parameters .",
    "while the use of periodograms for an initial exploration of parameter space may not be optimal for identifying all possible keplerian variations in the radial velocities ( e.g. large eccentricities spread power across multiple frequencies ) , they do provide an efficient means for identifying potential orbital periods .",
    "accurate estimates of the orbital period are valuable input parameters for subsequent algorithms , particularly the local minimization procedures .",
    "once an initial estimate of the orbital parameters is available ( @xmath37 , an iterative minimization algorithm such as levenberg - marquardt ( lm ) @xcite can be used to refine the model parameters by minimizing @xmath36 .",
    "the ml algorithm will identify only a single local minimum for a given initial guess of model parameters , @xmath38 .",
    "unfortunately , the @xmath28 surface can have many local minima .",
    "in particular , for multiple planet systems , the many degrees of freedom and the rugged @xmath28 surface can render lm minimization particularly sensitive to the initial guess model parameters and vulnerable to finding a local minimum of @xmath28 far away from and much less probable than the global minimum . in practice ,",
    "local minimization algorithm such as lm are most useful for fine tuning the parameters of a local minima identified by global search algorithms .",
    "simulated annealing generalizes iterative algorithms such as lm to reduce the risk of becoming trapped in a local minimum @xcite .",
    "random perturbations are applied at each iteration .",
    "the perturbations are initially large ( high temperature ) and are gradually reduced ( lower temperature ) .",
    "provided the temperature is reduced sufficiently slowly , simulated annealing can convert a local minimization algorithm into a global minimization algorithm .",
    "unfortunately , the choice of the cooling curve is important .",
    "additionally , the number of iterations required may be prohibitively large .",
    "nevertheless , simulated annealing can be a valuable tool when performing global non - linear minimization .",
    "a genetic algorithm ( ga ) is an optimization algorithm loosely based on biological evolution @xcite .",
    "gas are much less likely to become trapped in local minima than local minimization algorithms such as lm .",
    "the disadvantage is that they require orders of magnitude more evaluations of the goodness of fit statistic . when fitting planetary orbits to a single set of radial velocity data , this can be merely an inconvenient delay for analytic models , but gas",
    "can be prohibitively time consuming if it is necessary to search a large number of data sets .",
    "once a ga has identified a minimum , a lm - type minimization algorithm can provide an efficient means of fine tuning the solution .",
    "gas have been applied to the @xmath39 and and gj876 systems @xcite . in these cases",
    "the gas have verified the minima found by previous authors .",
    "additional minima have been identified in the case of @xmath39 and @xcite .",
    "the previous discussion has focused on identifying the maximum likelihood or best - fit parameter values .",
    "it is also important to characterize the uncertainty in the estimation of the parameter values .",
    "here we discuss three methods of estimating these uncertainties : constant @xmath40 boundaries , resampling , and markov chain monte carlo ( mcmc ) methods",
    ".      one method of estimating the uncertainty in orbital parameters fit to the observed data is to evaluate @xmath28 at points on a grid in the parameter space near @xmath34 .",
    "then confidence intervals can be calculated by finding the boundary ( b ) along which @xmath36 is constant .",
    "the probability , @xmath9 , that the parameters lie inside the boundary can be calculated by @xmath41 where @xmath42 , and the bottom integral extends over the entire parameter space .",
    "this approach is equivalent to assuming a uniform prior in @xmath2 in a bayesian framework .",
    "unfortunately , evaluating these integrals often requires a prohibitive number of evaluations of @xmath28 , particularly when the number of parameters is large .",
    "for example , to fit the radial velocities caused by one , two , or three planets requires at least six , eleven , or sixteen model parameters , respectively .",
    "if only ten grid points are used in each dimension , then this technique would require @xmath43 , @xmath44 , or @xmath45 evaluations of @xmath28 . in practice ,",
    "the integrands are can be poorly behaved , requiring many more evaluations in each dimension .",
    "thus , this technique is usually not practical for estimating the uncertainties in orbital parameters , especially for multiple planet systems .",
    "brown ( 2004 ) has applied a similar method to the case of hd 72659 .",
    "brown evaluated @xmath36 choosing random parameter values within a region of parameter space using monte carlo rather than choosing parameters along a grid .",
    "still , the large range of parameter space made it impractical to explore the entire range of parameter space with a constant density .",
    "thus , brown initially sampled a wide range of parameter space and then manually identified several boxes of parameters space to sample at higher density . in total",
    "brown evaluated @xmath36 at hundreds of millions of points to sample the allowed parameter space for hd 72659 .",
    "one method of estimating the uncertainty in orbital parameters fit to the observed data is to apply the fitting technique repeatedly to many sets of simulated data .",
    "since the observation errors are believed to be very nearly gaussian and each radial velocity measurement has a corresponding uncertainty estimate , it is straightforward to construct simulated data sets by adding gaussian random values to the actual data points .",
    "each set of simulated data is meant to represent a possible set of measurement values .",
    "if the same fitting procedure is applied to the actual data and each simulated data set , then one can obtain the distribution of best - fit parameter values .",
    "one disadvantage of the refitting technique is that one must identify the best - fit orbital parameters for each synthetic data set . in principle",
    ", one should apply a global minimization algorithm to each data set , but in practice the computational requirements often dictate that only a local minimization routine will be run for the synthetic data sets . even when using a local minimization algorithm",
    ", the computational requirements can be a burden .",
    "for example , for a one planet system with six free parameters , @xmath36 must be calculated thirteen times for each iteration of lm for each synthetic data set . for obtaining confidence intervals roughly equivalent to 3-@xmath46",
    ", a sample of at least @xmath47 synthetic data sets is necessary . assuming that the local minimization routine requires an average of eight iterations to converge , this amounts to @xmath48 evaluations of @xmath36 .",
    "still , the use of only a local minimization algorithm on the synthetic data sets would render this type of analysis vulnerable to underestimating the range of allowed parameters .",
    "if a global minimization algorithm were used , even over a small fraction of the possible parameter space , the number of @xmath36 evaluations required would increase by orders of magnitude .",
    "unfortunately , even then the distribution estimated via resampling may not reflect the full range of possible parameter values , particularly in cases where the @xmath36 surface is significantly asymmetric around the minimum . to illustrate this possibility",
    ", we use the actual observations for the extrasolar planet around hd 72659 . in figure 1",
    ", we show the best - fit value of @xmath36 when all parameters except orbital period are allowed to vary as a function of the orbital period ( solid line ) .",
    "we also show with dotted lines the same curve , but using synthetic data sets generated from the actual observations of hd 72659 .",
    "for all the data sets , orbital periods shorter than @xmath49d are strongly ruled out and @xmath36 increases very slowly for orbital periods greater than the best - fit period .",
    "however , the variation in the location of the best - fit period across the synthetic data sets does not reflect the fact that the very slow increase in @xmath36 for longer period orbits allows a very large range of orbital periods .",
    "bayesian inference using markov chain monte carlo ( mcmc ) simulations provides an alternative method for estimating the uncertainty of fitted parameters .",
    "the mcmc method has been applied to several other astronomical data sets and problems , including spectra analysis ( kashyap & drake 1998 , van dyk et al .",
    "2001 ) , star formation history ( fernandes et al .",
    "2001 , panter , heavens , & jimenez 2003 ) , object detection ( hobson & mclachlan 2003 ) , the cepheid distance scale ( barnes et al .",
    "2003 ) , cluster weak lensing ( rodriguez 2003 ) , the sz effect ( marshall , hobson , & slosar 2003 ) , type ia supernovae ( wang , yun , & mukherjee 2004 ) , and especially the cosmic microwave background ( e.g. , knox , nelson , & skordis 2001 , verde et al .  2003 ) .",
    "the goal of the mcmc method is to generate a chain ( i.e. sequence ) of states ( i.e. sets of parameter values , @xmath50 ) which are sampled from a desired probability distribution ( @xmath51 ) .",
    "such a chain can be calculated by specifying an initial set of parameter values , @xmath52 , and a transition probability , @xmath53 .",
    "the monte carlo aspect of mcmc simulation refers to randomness in the generation of each subsequent state .",
    "the markov property specifies that the probability distribution for determination of @xmath54 can depend on @xmath55 , but not previous states .",
    "if the markov chain is reversible , that is , if @xmath56 aperiodic , and irreducible , then it can be proved that the markov chain will eventually converge to the stationary distribution @xmath51 ( gilks , richardson , & spiegelhalter 1996 ) .",
    "the requirement that the chain be irreducible guarantees that it is possible for the chain to reach every state with non - zero probability from any initial state .",
    "mcmc offers a relatively efficient method of performing the integrations necessary for a bayesian analysis ( eqn .  1 ) , if we can calculate a markov chain whose equilibrium distribution is equal to the joint posterior probability density function for the model parameters given the observed data    for application to radial velocity measurements and orbit determination , the observational errors are believed to be very nearly gaussian with accurately estimated variances .",
    "thus , if the data were generated by the model specified by @xmath2 , then the probability of drawing the observed values , @xmath57 , is proportional to @xmath58 . if we choose a uniform prior in @xmath2 ( @xmath59 ) , then the posterior distribution , @xmath8 , is also proportional to @xmath60 .",
    "this will allow us to construct markov chains with an equilibrium distribution equal to the posterior distribution , @xmath61    the metropolis - hastings ( mh ) algorithm involves the generation of a trial state ( @xmath62 ) according to a candidate transition probability function , @xmath63 , and randomly accepting the trial as the next state or rejecting the trial state in favor of the current state .",
    "the mh algorithm specifies an acceptance probability , @xmath64 , such that the transition probability @xmath65 is guaranteed to be reversible and irreducible , provided only that @xmath66 allows transitions to all @xmath2 for which @xmath51 is non - zero .",
    "the mh algorithm acceptance probability is @xmath67 if @xmath68 and @xmath69 otherwise .",
    "note that the mh algorithm does not require that the normalization of @xmath51 be known _ a priori_. while the mh algorithm guarantees that the chain will converge to @xmath51 , it does not specify when the chain will achieve convergence .    in principle",
    ", the basic mh algorithm can be implemented as follows .    1",
    ".   initialize the chain with some @xmath52 and @xmath70 .",
    "[ mcmcloop ] generate a trial state , @xmath62 , according to @xmath63 .",
    "3 .   calculate @xmath71 for trial state and @xmath72 for the current state 4 .",
    "determine the ratio @xmath73/2\\right)$ ] .",
    "draw a random number , @xmath74 , from a uniform distribution between zero and one .",
    "if @xmath75 , as defined by eqn .",
    "( [ eqnalpha ] ) , then set @xmath76 .",
    "if @xmath77 , then set @xmath78 .",
    "7 .   set @xmath79 . 8 .",
    "go to step # [ mcmcloop ] .",
    "the choice of @xmath66 and deciding when a chain has converged are the primary practical complications .",
    "the mh algorithm can be optimized for a particular problem by the judicious choice of @xmath66 .",
    "poor choices can lead to extremely inefficient sampling and hence slow convergence .",
    "the most efficient choice for @xmath66 would be @xmath80 , the posterior probability distribution itself . however , this is not possible for this application , since the whole purpose of the markov chain is to calculate the posterior distribution . in such cases ,",
    "a common choice for @xmath66 is a gaussian distribution centered around @xmath2 .",
    "still , there remain important choices about the correlations and scale of the candidate transition probability distribution .",
    "we will address correlations later in this section , but first discuss the choice of scale . if the trial states are chosen with too large a dispersion then a large fraction of the trial states",
    "will be rejected , causing the chain to remain at each state for several trials and to converge very slowly .",
    "if the trial states are chosen with too small a dispersion ( @xmath81 ) , then the small step size will cause the chain will behave like a random walk , i.e. , the number of steps required to for the chain to traverse a distance , @xmath82 , in parameter space would scale roughly as @xmath83 .    monitoring",
    "the fraction of trial states that are accepted is one way to verify that the scale chosen for @xmath66 is not too inefficient .",
    "optimal values for the acceptance rate have been determined for some simple cases .",
    "for example , when @xmath2 has only one dimension and the posterior distribution function is known to be gaussian , then an acceptance rate of @xmath84 is optimal , among the class of gaussian candidate transition probability distribution functions centered on the current value of @xmath2 . for parameter spaces with many dimensions a similar analysis yields an optimal acceptance rate of @xmath85 ( gelman et al .",
    "2003 ) .",
    "thus , it is common to choose a gaussian @xmath66 centered on @xmath2 with some guess for the scale parameters . if , after running the markov chain for some time , it becomes clear that the acceptance rate is significantly different than the desired acceptance rate , then the scale parameters are adjusted , the previous markov chain is discarded , and a new markov chain is begun .",
    "it may be necessary to repeat this several times to determine an acceptable set of scale parameters .",
    "note that markov chains which serve as the basis for altering the step size are not combined with the final markov chain for inference .    for multidimensional parameter spaces it is not always obvious how to change @xmath66 so as to obtain the desired acceptance rate .",
    "even if all the parameters are uncorrelated , there are multiple possible scale parameters .",
    "for this reason , we chose to use a special case of the metropolis - hastings algorithm , widely known as the metropolis - hasting algorithm within the gibbs sampler .",
    "the gibbs sampler generates a trial @xmath62 by altering only a subset of the parameters in @xmath2 for each step .",
    "we combine the gibbs sampler with a gaussian candidate transition function , i.e. , for the parameters in ( @xmath2 ) to be updated , the candidate transition probability function is @xmath86 \\label{eqncandtransprob}\\ ] ] for valid @xmath87 ( i.e. , if the model dictates that @xmath87 be positive definite , then trial states with negative @xmath88 are rejected ) .",
    "we use the index @xmath89 to distinguish elements of the vector of parameters , and the index @xmath90 to indicate the @xmath90-th step of the markov chain .",
    "each @xmath91 is a parameter which controls the size of the steps for the parameter indicated by @xmath89 .",
    "thus , our acceptance probability reduces to @xmath92 for valid @xmath62 , and @xmath93 for invalid parameter values .",
    "while there are several variations , we choose the parameters to be altered in the next trial state according to randomly generated permutations of the model parameters . if the parameters are chosen one at at time , then it is easy to monitor the acceptance rates for steps involving each parameter separately .",
    "if any of these acceptance rates differ from the desired acceptance rate , then the guilty scale parameters , @xmath91 , can be identified and adjusted for calculating the next markov chain more efficiently .",
    "the other major difficulty in applying mcmc is determining how long the markov chain should be before using it for inference . in practice ,",
    "one performs multiple tests which can positively identify chains which have not converged .",
    "the failure of such tests to demonstrate non - convergence suggests , but does not prove , that the chain has converged @xcite . in our experience ,",
    "we have found it advisable to construct multiple markov chains for comparison .",
    "if all the chains have converged , then the distributions of all quantities of interest should be similar to within statistical uncertainties @xcite .",
    "both refitting to simulated data sets and mcmc provide reasonable methods of assessing the uncertainty in model parameters .",
    "refitting to simulated data estimates the distribution of the mle for the simulated data , which is not necessarily the most desirable estimator .",
    "transcribed into the language of bayesian statistics , the mle is not necessary the mean or median of the parameter s marginal distribution .",
    "mcmc samples from the joint posterior distribution given a prior and the observational data .",
    "while changing the prior would require completely redoing an mle analysis , importance sampling can be applied to a realization of a markov chain to compute confidence intervals for several different priors simultaneously ( press et al .",
    "1992 ; gilks et al .",
    "this could become valuable when considering alternative formation scenarios ( e.g. alternative distributions for initial eccentricities and inclinations ) or when additional constraints become available ( e.g. new observations or long term orbital stability studies ) .",
    "note that for importance sampling to be accurate , the posterior distributions under the different priors must not be too dissimilar .",
    "further , calculating the best fit model for each set of simulated data requires repeatedly solving a complex and time consuming non - linear minimization problem .",
    "similarly , most techniques which are less sensitive to local minima ( e.g. gas ) are less efficient than mcmc for multiple planet systems which have a large number of free parameters . calculating a longer markov chain",
    "is a relatively simple task and computationally more efficient .",
    "thus , we expect the mcmc technique to generalize to multiple planet systems much better than refitting .",
    "while both methods may be practical when fitting to a small number of model parameters , mcmc is particularly useful for high dimensional parameter spaces .",
    "this advantage is particularly important for long period planets and multiple planet systems where multiple free parameters which can be traded off against each other to obtain similarly good fits .",
    "the radial velocity observations of such systems can result in large valleys in the @xmath28 surface which permit a broad range of parameter values . within these valleys",
    ", there is often a rugged @xmath28 surface , meaning that there are many nearby local minima for @xmath28 . while the rugged @xmath28 surfaces present difficulties for local minimization routines , the markov chain monte carlo method is able to jump between these local minima and accurately calculate the posterior probability distribution for model parameters .",
    "it is important to realize that if there were multiple local minima separated by a barrier region of parameter space which resulted in significantly larger values of @xmath36 , then markov chain monte carlo would have great difficulty sampling from the posterior distribution unless special care was taken to identify the well separated local minima and a candidate transition probability function was carefully chosen to allow transitions between the local minima .",
    "thus , it is still important to conduct a single global search over the parameter space to recognize if there are distinct orbital solutions separated by a large @xmath28 barrier .    in summary , mcmc has the following advantages compared to the other methods we have discussed .",
    "* mcmc naturally allows for correlated and non - gaussian uncertainties in fit parameters . * the results can be simply interpreted as the joint posterior distribution for a given prior and set of observational data .",
    "* in some cases the resulting distribution can be efficiently updated to account for additional observations or alternative priors , provided that they do not greatly alter the posterior distribution . *",
    "calculating the next step in a markov chain is much faster than performing an additional minimization with resampled data .",
    "* computationally mcmc is more efficient than other techniques , particularly for high dimensional parameter spaces .",
    "to illustrate the application of the mcmc method to fitting radial velocity data , we will present several example applications to the presently known extrasolar planets . for calculating the markov chain we use a set of parameters , @xmath94 where @xmath95 is the set of mean velocity offsets ( one offset for each observatory ) .",
    "it is common practice to choose a `` non - informative '' prior that is uniform in the logarithm of a positive definite magnitude ( e.g. , orbital period and velocity semi - amplitude ) , as suggested by several scaling arguments ( gelman et al",
    ".  2003 ) .",
    "additionally , we found that the use of @xmath96 and @xmath97 instead of @xmath9 and @xmath10 increased the rate of convergence for systems where the orbital period was not tightly constrained .",
    "similarly , we found that the use of @xmath98 and @xmath99 instead of @xmath11 and @xmath12 significantly increased the rate of convergence for systems with small eccentricities where @xmath12 is not tightly constrained .    the distribution of published orbital parameters is roughly consistent with being uniform in @xmath96 , @xmath100 , @xmath11 , @xmath12 , and @xmath13 ( aside from cutoffs at small orbital periods and large planetary masses and not including the very short period planets for which tidal forces have presumablely circularized the orbits ) .",
    "therefore , for the histograms and contour plots presented below , we have sampled from the markov chains using importance sampling so that they correspond to priors which are flat on ( @xmath96 , @xmath100 , @xmath11 , @xmath101 , @xmath13 ) .    for each planetary system , we initialize multiple chains with parameter values near the published values of the orbital elements or the best - fit models identified with a ga . we also start chains with initial parameters drawn from a gaussian distribution centered on the published values with standard deviations three times the published uncertainties . in cases where our markov chains indicated uncertainties greater than the published values , we constructed additional chains with initial parameters chosen over an even wider range .    for these simulations ,",
    "we have used a gaussian candidate transition probability function ( eqn .",
    "[ eqncandtransprob ] ) and a gibbs sampler which randomly chooses to update one or two parameters at each step with equal probability .",
    "( when two parameters have significant correlations , perturbing two parameters in a single step can allow the markov chain to explore parameter space more quickly . )",
    "all parameters other than the one or two chosen to be updated are left unchanged .",
    "the order of the parameters to be altered is determined by a randomly generated permutation .",
    "we monitor the acceptance rates for steps involving each parameter separately .",
    "if a chain had an acceptance rate below @xmath102 or above @xmath103 , then we adjusted the relevant @xmath91 and start computing a new chain . to reduce the dependence on the initial parameter values",
    ", we discard the initial @xmath104 states or the first 10% of the chain , whichever is longer .",
    "since consecutive states can are often highly correlated , we lose little information by consider only every @xmath105-th set of parameter values with @xmath105 greater than or equal to ten times the number of free parameters .",
    "we test for non - convergence of each chain by comparing the marginalized distribution of each parameter in the first half and full chain .",
    "we also compare the results of multiple chains run with multiple values of @xmath106 .",
    "this helps us recognize chains where an inappropriate step size may have resulted in a chain becoming trapped in a small region of parameter space for the duration of the chain .",
    "additionally , we run multiple chains with widely dispersed initial conditions to verify that @xmath107 , the gelman - rubin test statistic , is consistent with convergence . since we initialize the chains with wide range of initial parameter values , it is easy to recognize that the distributions of parameters based on only the early portion of the chains are dependent on the values chosen for the initial state of the markov chain .",
    "the gelman - rubin test statistics can determine if the markov chains have yet to converge by comparing the variance of each parameter within each chain to the variance of the parameter across multiple chains .",
    "for markov chains which converge , the gelman - rubin test statistic approaches @xmath108 from above .",
    "for our results we have checked that it is always less than @xmath109 and usually less than @xmath110 ( gilks et al .",
    "the plots presented are based on only the markov chain with the most desirable acceptance rates .",
    "these very conservative choices are computationally inefficient , but the inefficiency can be tolerated for the purposes of this paper . for each system , we have computed tens of markov chains , including a wide range of @xmath111 . each of our markov chains typically contains @xmath112 steps , depending on the number of fit parameters and the choice of @xmath111 .",
    "( when @xmath111 results in too high or low an acceptance rate , convergence requires many more steps . )",
    "ideally , one would attempt to improve the computational efficiency while maintaining confidence that the chains have converged . based on our experience from the systems studied in this paper , we believe that one could construct only five markov chains with a single value of @xmath111 ( chosen to give a desirable acceptance rate ) for each system and",
    "still be reasonablely confident that the markov chains had converged .",
    "we believe that further refinements to the candidate transition probability function could make mcmc even more efficient . using additional changes of variables could reduce covariances between model parameters could speed convergence and reduce the autocorrelation of the states in each chain .",
    "we hope to present such optimizations in a future paper .      despite the nearly gaussian uncertainties for the radial velocity data , the uncertainties for orbital parameters can be significantly non - gaussian .",
    "in particular , since the orbital eccentricity is confined between zero and one , we might expect significant deviations from normality when the eccentricity is small or nearly unity . in fig .",
    "[ ewhistos ] we show the distribution of eccentricities and arguments of periastron for hd 76700 , hd 68988 , and hd 4203 based on the published observations and uncertainties ( tinney et al .",
    "2002 ; vogt et al .",
    "there are several interesting features in these plots :    1 .   for hd 76700 ,",
    "the distributions of orbital elements calculated by resampling and mcmc are similar .",
    "we find the distribution of eccentricities barely includes @xmath113 ( assuming a uniform prior in @xmath2 as defined in eqn .",
    "( [ eqnparam ] ) ) and excludes @xmath114 at the 90% confidence level , in contrast to the published solution , @xmath115 .",
    "while the published orbital solution does not constrain @xmath12 , our simulations constrain the argument of pericenter to @xmath116 ( 90% confidence interval ) .",
    "additionally , the distribution of @xmath12 has a noticeable asymmetry . for planets with small eccentricities such as hd 76700 , the variables @xmath98 and @xmath117 generally have smaller uncertainties and are more gaussian than the uncertainties in @xmath11 and @xmath12 .",
    "2 .   for hd 68988",
    ", the eccentricity distribution is clearly separated from zero , and the hypothesis that @xmath118 is strongly rejected within the single planet keplerian model .",
    "again , resampling and mcmc methods result in similar uncertainty estimates .",
    "hd 4203 has a significant eccentricity , however the published observations still permit strongly non - gaussian uncertainties in @xmath11 . in this case ,",
    "mcmc results in an uncertainty distribution with a more significant high eccentricity tail and a narrower distribution in @xmath12 than is predicted by resampling .",
    "hd 80606 has a very large eccentricity ( @xmath119 ) and a very small radial separation at periastron ( @xmath120au ) .",
    "while the orbital period is very well constrained , @xmath11 , and thus radial separation at periastron ( @xmath121 ) have significant uncertainties ( fig.[rphd80606 ] ) , especially in the context of tidal dissipation , since the rate of tidal circularization is a steep function of @xmath121 @xcite .",
    "our mcmc simulations show that the current observations still permit orbital solutions with pericenter distances as small as a stellar radius .",
    "it is interesting to note that mcmc and resampling methods result in significantly different distributions for @xmath121 .",
    "the high correlation between variables does slow the convergence of the markov chains , but we have run several chains for an extended duration and none result in a significant probability of @xmath122au . if additional observations were to constrain the pericenter distance , this system might eventually provide an interesting test for theories of tidal circularization and orbital decay .      constraining the orbital parameters of long period systems",
    "is a significant challenge , since good solutions typically require observations spanning at least one orbital period . for eccentric systems , it is much more difficult to identify optimal times to observe the system while still during the first or second orbit . in fig .",
    "[ pecontours ] we show the joint distribution of the period and eccentricity for the system hd 72659 .",
    "note that the mcmc simulations reveal a much larger uncertainty in orbital period and eccentricity than suggested by resampling or by the published error bars . after this plot",
    "was prepared , marcy ( 2003 ) informed us that more recent observations of hd 72659 yield a best - fit of @xmath123 d and @xmath124 ( large solid point ) , demonstrating the potential for mcmc to provide more accurate uncertainty estimates than resampling .    in fig .",
    "[ manyorbithistos ] we show the marginalized probability distributions for @xmath9 , @xmath10 , @xmath11 , and @xmath12 for several of the known extrasolar planets with the longest orbital periods .",
    "while the parameters are well constrained for some systems , significant uncertainties in the periods and eccentricities appear to be common .",
    "both the mean value and uncertainty of orbital elements determined by mcmc simulations can be significantly different from the values and uncertainties suggested by resampling , particularly when at least one parameter has a significantly skewed distribution .",
    "for some systems the observational data do not determine a unimodal orbital solution ; in particular there can be two similarly good fits that are well separated from each other .",
    "this is particularly common in multiple planet systems . in fig .",
    "[ twosolutions47uma ] we show two possible orbital solutions for 47 uma .",
    "one corresponds to the published orbital solution and the other corresponds to a solution in which the outer planet has a much longer orbital period and large eccentricity .",
    "we have begun conducting mcmc simulations to estimate the parameter distributions for 47 uma and other multiple planet systems . for multiple planet systems",
    "several orbital parameters can be highly correlated greatly slowing convergence .",
    "we are exploring changes of variables which could accelerate convergence and permit more detailed investigations of the uncertainties in the elements of such multiple planet systems .",
    "the most easily observable deviation from keplerian motion is generally expected to be precession of the longitude of periastron .",
    "this suggests we adopt a precessing keplerian model @xmath125,\\ ] ] for each planet , where @xmath126 is the precession rate of the longitude of periapse of the @xmath26th planet and @xmath17 is the time of the observation .",
    "such a model incorporates the dominant observable perturbation to the basic keplerian model while introducing only one additional parameter per planet .",
    "this model is particularly good when the perturbations excite a single dominant secular eigenmode , as in gj876 , in which case the values of @xmath126 should be nearly equal and time - independent .",
    "further , in this model , @xmath127 can be fit to radial velocity measurement without time consuming n - body integrations .",
    "although radial velocity measurements constrain only @xmath128 , the precession rates can in principle determine the planets inclinations and masses .",
    "of course , this approach assumes that there are no additional perturbations , for example due to general relativistic effects , the quadrupole moment of the star , or additional companions .",
    "the gj 876 system is an example of a interacting system in which mutual perturbations are detectable .",
    "modeling gj 876 with two precessing keplerian orbits and applying mcmc , we investigate the precession rates of the two orbits . in the top panel of fig .",
    "[ omegadot ] , we show the probability distributions for @xmath129 ( dotted line ) , @xmath130 ( dashed line ) , and the instantaneous average of the two ( solid line ) . in the lower panel",
    "we plot the probability distribution for the difference of the precession rates . in this case , the two precession rates are comparable , allowing for a secular resonance in which @xmath131 remains small @xcite .",
    "based on the published observations , we can not yet detect a significant difference between the precession rates of the two planets .",
    "rates differing by more than @xmath132 can be excluded according to this model .",
    "radial velocity measurements can be used to identify when a transit could occur , if the system were to have a favorable inclination .",
    "this can greatly aid observers who can concentrate their efforts at the appropriate times .",
    "correlations between best - fit orbital parameters can have a significant impact on the search for transits .",
    "thus , it is important that observers understand the uncertainty in the predicted transit times .",
    "particularly , for strongly interacting multiple planet systems , there can be significant uncertainties in the possible transit times .",
    "we have fit a model based on eqn .",
    "( [ eqnprecessingkeplerian ] ) to the published radial velocity data for gj876 . using a genetic algorithm we found a model with precession rates of @xmath133/yr and @xmath134/yr for the inner and outer planets , respectively .",
    "these are similar to the precession rates found for the best - fit orbital solution obtained via self consistent n - body integrations and local minimization @xcite .",
    "clearly , this comparison does not include important short period perturbations to the orbits which should be included when forecasting transits and planning observations .",
    "additionally , a transit search would want to target the time of ingress or egress which introduces additional dependences on the stellar radii and orbital parameters .",
    "nevertheless , we use this model to demonstrate the uncertainty in potential transit times in an interacting system and the applicability of mcmc to predicting potential transit times .",
    "the actual system is most likely precessing at a similar rate and the unknown precession rate contributes to the uncertainty in predicting potential transit times . in fig.[transits ] we show the probability distributions for the center of the transit of gj 876 b approximately two months after the last published observation , assuming @xmath135 . the model which includes the precession rates ( solid line ) allows for a significantly wider range of transit times than the model which assumes fixed periapses .",
    "this significantly increases the duration over which gj 876 must be monitored to ensure that the ingress or egress falls within the window of observations .",
    "markov chain monte carlo methods provide a valuable tool for matching planetary orbits to radial velocity data",
    ". these techniques can be particularly useful for characterizing the uncertainties and correlations in estimated orbital parameters for extrasolar planets .",
    "presently , several systems have large uncertainties in orbital parameters , particularly the long period planets and multiple planet systems .",
    "our markov chain monte carlo simulations reveal that the published orbital solutions can significantly over- or underestimate the uncertainty in orbital parameters .",
    "in addition to quantifying the uncertainties of various orbital parameters , markov chain monte carlo allows specific questions to be investigated directly from the radial velocity data itself bypassing fits to orbital parameters .",
    "as more multiple planet systems are discovered , such methods could become increasingly valuable .",
    "we thank gilbert holder and hiranya peiris for discussions of markov chain monte carlo techniques .",
    "we thank geoff marcy and debra fischer for discussions of observational issues and sharing radial velocity observations before publication .",
    "we thank gregory laughlin for bringing to our attention the uncertainties in possible transit times , and john chambers for valuable discussions about gj 876 .",
    "this research was supported in part by nasa grant nag5 - 10456 and",
    "the epics sim key project .        butler , r.  p. , marcy , g.  w. , williams , e. , mccarthy , c. , dosanjh , p. , & vogt , s.  s. 1996 , , 500 butler , r.  p. , marcy , g.  w. , fischer , d.  a. , brown , t.  m. , contos , a.  r. , korzennik , s.  g. , nisenson , p. & noyes , r.  w. 1999 , , 916 .",
    "butler , r.  p. , marcy , g.  w. , vogt , s.  s. , fischer , d.  a. , henry , g.  w. , laughlin , g. , & wright , j. 2002 , 583 , 455 .",
    "butler , r.  p. , marcy , g.  w. , vogt , s.  s. , tinney , c.  g. , jones , h.  r.  a. , mccarthy , c. , penny , a.  j. , apps , k. , & carter , b.  d. , 565 .",
    "butler , r.  p. , marcy , g.  w. , williams , e. , hauser , h. , & shirts , p. 1997",
    ", , l115 charbonneau , p. 1995 , 101",
    ", 309 .",
    "hobson , m.p . ,",
    "mclachlan , c. 2003 mnras 338 , 765 .",
    "horne , j.  h. & baliunas , s.  l. 1986 , 302 , 757 .",
    "jones , h.  r.  a. , butler , r.  p. , tinney , c.  g. , marcy , g.  w. , penny , a.  j. , mccarthy , c. , carter , b.  d. & apps , k. 2002 , 333 , 871 .",
    "laughlin , g. & chambers , j.  e. 2001 , 551 , l109 .",
    "marcy , g.  w. , butler , r.  p. , vogt , s.  s. , fischer , d.  a. & lissauer , j.  j.  1998 , 505 , l147 .",
    "marcy , g.  w. , butler , r.  p. , williams , e. , bildsten , l. , graham , j.  r. , ghez a.  m. , & jernigan j.  g. 1997 , , 926 .",
    "naef , d. , latham , d.  w. , mayor , m. , mazeh , t. , beuzit , j.  l. , drukier , g.  a. , perrier - bellet , c. , queloz , d. , sivan , j.  p. , torres , g. , udry , s. & zucker , s. 2001b , 375 , l27 .",
    "panter , b. , heavens , a.f .",
    ", jimenez , r. 2003 mnras 343 , 1145 . press , w.  h. , teukolsky , s.  a. , vetterling , w.  t. , & flannery , b.  p. 1992 , _ numerical recipies in c : the art of sientific computing .",
    "_ new york : cambridge university press .",
    "stepinski , t.  f. , malhotra , r. , & black , d.  c. 2000 , 545 , 1044 .",
    "tinney , c.  g. , butler , r.  p. , marcy , g.  w. , jones , h.  r.  a. , penny , a.  j. , mccarthy , c. , carter , b.  d. , bond , b. 2002 , 587 , 423 .",
    "verde , l. , peiris , h. v. , spergel , d. n. , nolta , m. r. , bennett , c. l. , halpern , m. , hinshaw , g. , jarosik , n. , kogut , a. , limon , m. , meyer , s. s. , page , l. , tucker , g. s. , wollack , e. , wright , e. l. 2003 , apjs 148 , 195 .",
    "vogt , s.  s. , butler , r.  p. , marcy , g.  w. , fischer , d.  a. , pourbaix , d. , apps , k. & laughlin , g. 2002 , 568 , 352 ."
  ],
  "abstract_text": [
    "<S> precise radial velocity measurements have led to the discovery of @xmath0 extrasolar planetary systems . </S>",
    "<S> we investigate the uncertainty in the orbital solutions that have been fit to these observations . </S>",
    "<S> understanding these uncertainties will become more and more important as the discovery space for extrasolar planets shifts to longer and longer periods . </S>",
    "<S> while detections of short period planets can be rapidly refined , planets with long orbital periods will require observations spanning decades to constrain the orbital parameters precisely . </S>",
    "<S> already in some cases , multiple distinct orbital solutions provide similarly good fits , particularly in multiple planet systems . </S>",
    "<S> we present a method for quantifying the uncertainties in orbital fits and addressing specific questions directly from the observational data rather than relying on best fit orbital solutions . </S>",
    "<S> this markov chain monte carlo ( mcmc ) technique has the advantage that it is well suited for the high dimensional parameter spaces necessary for the multiple planet systems . </S>",
    "<S> we apply the mcmc technique to several extrasolar planetary systems , assessing the uncertainties in orbital elements for several systems . </S>",
    "<S> our mcmc simulations demonstrate that for some systems there are strong correlations between orbital parameters and/or significant non - gaussianities in parameter distributions , even though the measurement errors are nearly gaussian . </S>",
    "<S> once these effects are considered the actual uncertainties in orbital elements can be significantly larger or smaller than the published uncertainties . </S>",
    "<S> we also present simple applications of our methods such as predicting the times of possible transits for gj 876 . </S>"
  ]
}