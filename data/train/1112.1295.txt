{
  "article_text": [
    "given a direction by time , ancestry relationship between species , individuals , alleles or cells can be depicted as a rooted tree . of particular interest",
    "are binary rooted unordered trees",
    ". these can be further classified into several subclasses . here",
    "we will _ ranked trees _ , which are defined below .",
    "we assume that trees are generated by the coalescent process .",
    "an important parameter is the number of _ cherries _ of a tree . by a new approach based on generating functions",
    "we extend previous results ( see for example @xcite ) deriving an exact formula for the probability of finding @xmath0 cherries in a ranked tree of size @xmath1 .",
    "furthermore , we show that several known statistics ( see @xcite ) concerning _ pitchforks _ follow as corollaries from a partial differential equation which also gives an efficient recursion to compute the conditional probability distribution of pitchforks given a certain number of cherries .",
    "one motivation for this study comes from population genetics and the question how typical _ coalescent trees _ @xcite look like .",
    "our results give some insight into structural properties of trees generated under the standard neutral model @xcite .",
    "these results provide a reference against which non neutral and/or non independently generated trees may be compared . to illustrate the latter we pay attention to trees which are linked along a recombining chromosome .",
    "we start with some basic definitions .",
    "a _ binary rooted _ tree is a tree with a root and in which all nodes have outdegree either @xmath2 or @xmath3 .",
    "nodes with outdegree @xmath3 are called _ internal _ , nodes with outdegree @xmath2 are _",
    "external_. external nodes are also called _",
    "leaves_. the size @xmath1 of a tree is the number of its external nodes .",
    "the _ subtree _ of an internal node @xmath4 is the tree with root @xmath4 .",
    "a tree is said to be _ un - ordered _ when it is taken in the graph theoretic sense so that subtrees stemming from an internal node have not a left - right order between themselves . here , we care about tree topology and we do not care about branch lengths .",
    "we consider the following class . a binary un - ordered tree of size @xmath1",
    "is said to be a _ ranked tree _",
    "if the set of internal nodes is totally ordered by labels belonging to @xmath5 in such a way that each child s label is greater than its parent s label , ( see fig .  [ ranked6 ] ) .",
    "the total order of internal labels can be interpreted as a historical time order ; accordingly , @xcite calls such trees _ histories_.    [ cols=\"^,^,^\",options=\"header \" , ]     we will denote by @xmath6 the set of ranked trees and by @xmath7 the set of trees of size @xmath1 . in what follows , @xmath8 always represents the number of leaves of a ranked tree @xmath9 .",
    "the cardinality of the set @xmath7 is given by the following exponential generating function    @xmath10    whose first coefficients @xmath11 ( with @xmath12 ) are @xmath13 ranked trees can be bijectively mapped to @xmath2-@xmath14-@xmath3-_increasing trees _ ( see callan , 2005 ; http://www.stat.wisc.edu/~callan/notes ) . from this , it follows that the numbers given by ( [ enumr ] ) correspond to sequence @xmath15 in @xcite and are known as _",
    "euler numbers_.      the coalescent of size @xmath1 is a model for the genealogical history of a sample of @xmath1 genes .",
    "it has been introduced in population genetics by kingman and ewens @xcite and has nowadays textbook status @xcite .",
    "ranked trees can be generated by the _ coalescent process _",
    ", which starts with @xmath1 leaves and works by successively coalescing two randomly chosen branches until it reaches the most recent common ancestor when the last two remaining branches are joined . to reflect time order one can assign an integer to each internal node when created , for instance the label @xmath16 to the first coalescent event and @xmath14 to the last event , the most recent common ancestor , or the root of the tree .",
    "the probability distribution of ranked trees @xmath17 generated under the coalescent process is essentially contained in the paper of @xcite and it is described below .",
    "* probability distribution of ranked trees *    let @xmath18 and let @xmath19 be the number of internal nodes @xmath4 whose children are two leaves .",
    "such internal nodes are called the _ cherries _ of the tree .",
    "for example , ( see fig .",
    "[ ranked6 ] ) . given @xmath20 , from @xcite follows that @xmath21 i.e. the probability of any ranked tree @xmath20 depends only on two parameters , @xmath22 and @xmath1 .",
    "* the probability of generating the same ranked trees twice *    considering trees linked on a common chromosome one observes that chromosomal linkage substantially increases the probability that two neighboring trees are identical even if separated by a recombination event . to quantify the effect of linkage and recombination",
    "it is important to know the background probability that two independently generated trees are identical .",
    "this probability can be found with the help of the genarating function @xmath23    discussed in more details in section  [ recursive ] , eq .",
    "( [ y ] ) .",
    "we have the following result .",
    "[ prima ] the probability that two independently generated ranked trees of size @xmath1 are identical is @xmath24y\\left(\\frac{1}{4},z\\right)\\,.\\ ] ]    _ proof : _ from eq .",
    "( [ tagima ] ) the probability that @xmath25 are identical is    @xmath26y\\left(\\frac{1}{4},1,1,z\\right)\\\\\\nonumber & = & \\frac{4^{n-1}}{(n-1 ) ! }",
    "\\times [ z^{n-1}]y\\left(\\frac{1}{4},z\\right ) , \\nonumber\\end{aligned}\\ ] ]    where @xmath27y(1/4,z)$ ] means the @xmath28-st coefficient of the taylor expansion of @xmath29 in @xmath30 .",
    "[ [ section ] ]    let @xmath32 and @xmath33 . remove all leaves and external branches from @xmath9 and obtain a reduced tree @xmath34 . the tree",
    "@xmath34 is a so - called _ @xmath2-@xmath14-@xmath3-increasing tree _ of size @xmath35 , where , this time , the size is the total number of nodes in the tree and not only of the leaves .",
    "the class @xmath36 of @xmath2-@xmath14-@xmath3-increasing trees is composed of un - ordered rooted trees where all nodes have outdegree @xmath2 , @xmath14 or @xmath3 .",
    "the @xmath35 nodes of such a tree carry totally ordered labels belonging to @xmath37 .",
    "moreover , the labelling is such that any child node label is greater than that of the parent node . as usual",
    "@xmath38 denotes the set of @xmath2-@xmath14-@xmath3-increasing trees of size @xmath35 .",
    "hence , the function @xmath39 is a bijection from @xmath40 to @xmath38 .    given a ranked tree @xmath9 , the _ outdegree of an internal node _ of @xmath9 is the outdegree of the corresponding node in @xmath34 .",
    "thus , if @xmath41 , the nodes of outdegree @xmath2 ( resp .",
    "@xmath14 , @xmath3 ) are defined as the nodes with @xmath3 ( resp .",
    "@xmath14 , @xmath2 ) leaves as direct descendants .    here",
    ", we derive the enumeration of @xmath2-@xmath14-@xmath3-increasing trees with respect to the size and to the number of nodes with outdegree @xmath2,@xmath14 and @xmath3 .",
    "the bijection @xmath39 will allow us to use this enumerative result in section  [ weightedf ] to determine the probability distribution of the random variable @xmath22 , the _ number of cherries _",
    ", when @xmath9 is a ranked tree of size @xmath1 generated by the coalescent process",
    ". it is already known ( see @xcite ) that @xmath19 is asymptotically normal for large @xmath1 .",
    "we show now how the class of @xmath2-@xmath14-@xmath3-increasing trees can be generated recursively .",
    "in particular we construct each tree belonging to @xmath42 by adding a new node to some tree in @xmath38 .",
    "this construction , denoted by @xmath43 , will then be translated into a functional equation . solving the equation we obtain a bivariate exponential generating function counting the considered increasing trees with respect to size and to the number of nodes with outdegree @xmath2 , @xmath14 and @xmath3 .",
    "given a tree @xmath44 , @xmath43 simply adds the node labelled @xmath45 as a child of a node of @xmath9 having outdegree less than two .",
    "let @xmath46 and @xmath47 denote the number of nodes with outdegree @xmath48 and @xmath3 respectively .",
    "@xmath43 applied to @xmath9 produces @xmath49 elements of @xmath42 each time adding the new node labelled @xmath45 as a child of the nodes counted in @xmath49 . in fig .",
    "[ gentree ] we depict the first steps of this construction process .",
    "note that @xmath50 and @xmath51 . from these relations",
    "we have , in particular , that @xmath52 . the construction @xmath43 can be translated into the following _ succession rule _",
    "( see @xcite ) where each tree is represented by a label composed of the values of its parameters @xmath22 and @xmath35 while the exponents show how many times the label is produced ,      in particular , given a tree @xmath9 with parameters @xmath54 and @xmath55 , the application of @xmath43 to @xmath9 produces @xmath22 new trees having size @xmath45 and @xmath22 cherries and @xmath56 new trees having size @xmath45 and @xmath57 .",
    "the starting point of the construction is the unique tree of size one represented by @xmath58 .",
    "the previous first order partial differential equation can be solved using the _ method of characteristics _",
    "( see @xcite ) respecting the condition given by eq .",
    "( [ enumr ] ) @xmath66 indeed @xmath67 must represent the exponential generating function counting @xmath2-@xmath14-@xmath3-increasing trees with respect to size .",
    "@xmath86 using the result of proposition  [ prima ] we can now effectively calculate the probability @xmath87 that two ranked trees having @xmath1 leaves are identical when generated independently by the coalescent process : @xmath88 and @xmath89 , and so on .",
    "we are now ready to state the enumeration of ranked trees with respect to size and number of nodes of outdegree @xmath2 , @xmath14 or @xmath3 , when each tree is weighted by its probability under the coalescent process .",
    "this exact enumerative result is novel and achieved with the help of the weighted generating function @xmath90    function @xmath91 has a more intuitive interpretation if one considers the transformation @xmath92 instead .",
    "it can be interpreted as a weighted exponential generating function counting @xmath2-@xmath14-@xmath3-increasing trees with respect to the outdegree and the total number of nodes .",
    "starting from equation ( [ y ] ) , we perform some substitutions on @xmath93 to obtain @xmath94 .",
    "in particular we have @xmath95 and , multiplying by @xmath63 , we finally obtain the desired function @xmath91 .",
    "[ pere ] the weighted ordinary generating function of ranked trees considered with respect to size and number of cherries is @xmath96 the probability of having @xmath97 cherries in a ranked tree of size @xmath1 corresponds to the coefficient of @xmath98 in the taylor expansion of @xmath91 around @xmath30 , i.e. @xmath99f(x , z).\\ ] ]        looking at fig .",
    "[ ranked6 ] one can check that , for example , there are exactly @xmath101 trees represented by the monomial @xmath102 .",
    "each one of them has probability @xmath103 .",
    "this is in agreement with the term @xmath104 in the expansion .",
    "indeed , @xmath105 is the probability to obtain a ranked tree of size @xmath106 with two cherries .    using the result of proposition  [ pere ] we compute the discrete probability distribution of the random variable @xmath19 for trees of fixed size @xmath1 . in this case",
    "@xmath22 is a random variable which takes values between @xmath14 and @xmath107 . in fig .",
    "[ distpitchfork ] we have depicted the distribution of @xmath22 for a ranked tree of size @xmath108 .    by proposition  [ pere ] one can also determine the expected value @xmath109 and the variance @xmath110 of the random variable @xmath22 in dependence of tree size @xmath1 . using other methods these have been determined before , for example by @xcite .",
    "the second moment is @xmath114\\frac{d(x\\frac{df}{dx})}{dx}(1,z)=[z^n]\\frac{d^2f}{dx}(1,z)+ [ z^n]\\frac{df}{dx}(1,z",
    ") \\\\\\nonumber & = & [ z^n]\\frac{2(z^7 - 6z^6 + 15z^5 - 15z^4)}{45(z-1)^3}+e_o(n ) \\\\\\nonumber & = & [ z^n]\\left(\\frac{2}{(z-1)^3}\\left(\\frac{z^7}{45}-\\frac{2z^6}{15}+\\frac{z^5}{3}-\\frac{z^4}{3}\\right)\\right ) + e_o(n)\\,.\\end{aligned}\\ ] ] if @xmath115 , and using @xmath116 , we obtain the variance of @xmath22 @xmath117          using different methods , they have been studied before for example by @xcite . a pitchfork in",
    "a ranked ( resp .",
    "@xmath2-@xmath14-@xmath3-increasing ) tree is simply a subtree with @xmath118 leaves ( resp .",
    "@xmath3 nodes ) .",
    "if @xmath119 denotes the number of pitchforks in @xmath120 the construction of section [ recursive ] is extended to the new random variable @xmath121 .",
    "we find the following succession rule : @xmath122            for @xmath125 it reduces to eq .",
    "( [ caso1 ] ) but there is non easy analytic solution .",
    "however , we can still obtain the expected value @xmath126 for the number of pitchforks in @xmath2-@xmath14-@xmath3 increasing trees with @xmath35 nodes .",
    "starting from ( [ nosol ] ) and performing the substitutions @xmath127 and @xmath128 we obtain @xmath129    from which we have @xmath130\\frac{dy}{dv } \\left ( \\frac{1}{2},v,2z \\right)&=&[z^m]\\frac{y\\left ( \\frac{1}{2},v,2z \\right)+2(z-1)\\frac{dy}{dz } \\left ( \\frac{1}{2},v,2z \\right)}{2\\left ( v+\\frac{1}{2 } \\right ) ( v-1 ) } \\\\\\nonumber & & + [ z^m]\\frac{\\frac{dy}{dx } \\left ( \\frac{1}{2},v,2z \\right)}{2\\left ( v+\\frac{1}{2 } \\right)}. \\nonumber\\end{aligned}\\ ] ]      @xmath132\\left ( \\lim_{v\\rightarrow 1}\\frac{y\\left ( \\frac{1}{2},v,2z \\right)+2(z-1)\\frac{dy}{dz } \\left ( \\frac{1}{2},v,2z \\right)}{2\\left ( v+\\frac{1}{2 } \\right ) ( v-1)}\\right ) \\\\\\nonumber & & + \\frac{2 e_o(m)}{3}. \\nonumber\\end{aligned}\\ ] ]    the considered limit can be determined according to _ l hospital s rule _ taking the derivative of the numerator and the denominator with respect to @xmath133 and performing then the substitution @xmath125 .",
    "furthermore , from section  [ weightedf ] @xmath134 , and thus    @xmath135 \\left(\\frac{1}{3 } \\sum_{t\\in \\mathcal{i}_{012 } } r(t)\\frac{2^{m(t)-o(t)}}{m(t ) \\ , ! } z^{m(t ) } \\right ) \\\\\\nonumber & & + [ z^m ] \\left ( \\frac{2}{3}(z-1 ) \\sum_{t\\in \\mathcal{i}_{012 } } r(t)m(t)\\frac{2^{m(t)-1-o(t)}}{m(t ) \\ , ! } z^{m(t)-1 } \\right ) \\\\\\nonumber   & & + \\frac{2(m+1)}{9 } \\\\\\nonumber & = & \\frac{1}{3 } e_r(m ) + [ z^m ] \\left ( \\frac{z-1}{3z } \\sum_{k>0 } k e_r(k ) z^k \\right ) +   \\frac{2(m+1)}{9 }    \\\\\\nonumber & = & \\frac{1}{3 } e_r(m ) + \\frac{me_r(m)-(m+1)e_r(m+1)}{3 } +   \\frac{2(m+1)}{9}.    \\\\\\nonumber\\end{aligned}\\ ] ]          from eq .",
    "( [ nosol ] ) one can also compute the full probability distribution of the random variable @xmath121 when an increasing tree of fixed size is generated by the coalescent process . indeed ,",
    "if we consider            _ proof .",
    "_ consider eq .",
    "( [ nosol ] ) without the monomial @xmath143 which appears there .",
    "if we then isolate the term @xmath144 and integrate both sides of the resulting equation with respect to the variable @xmath63 we obtain the polynomial @xmath145 starting from @xmath146 . @xmath31          * the probability of having @xmath149 pitchforks in an increasing tree of size @xmath35 ( see fig .  [ distpitchfork ] ) is @xmath150y_m \\left ( \\frac{1}{2},v,2 \\right);\\ ] ] * the probability of having @xmath97 cherries and @xmath149 pitchforks in an increasing tree of size @xmath35 is @xmath151y_m \\left ( \\frac{x}{2},v,2 \\right);\\ ] ] * the probability of having @xmath149 pitchforks in an increasing tree of size @xmath35 given it has @xmath97 cherries ( see fig .",
    "[ joint ] ) is @xmath152y_m \\left ( \\frac{x}{2},v,2 \\right ) } { [ x^{o'}]y_m \\left ( \\frac{x}{2},1,2 \\right)}.\\ ] ]              c.  banderier , m.  bousquet - melou , a.  denise , p.  flajolet , d.  gardy , and d.  gouyou - beauchamps .",
    "generating functions for generating trees . in _ proceedings of 11-th formal power series and algebraic combinatorics _ , pages 4052 , 1999 .",
    "e.  f. harding .",
    "the probabilities of rooted tree - shapes generated by random bifurcation .",
    "_ advances in applied probability _ , 30 ( 1):0 pp . 4477 , 1971 .",
    "issn 00018678 .",
    "url http://www.jstor.org/stable/1426329 ."
  ],
  "abstract_text": [
    "<S> we consider exact enumerations and probabilistic properties of _ ranked _ trees when generated under the random coalescent process . using a new approach ( see @xcite ) , based on generating functions , we derive several statistics such as the exact probability of finding @xmath0 _ cherries _ in a ranked tree of fixed size @xmath1 . we then extend our method to consider also the number of _ </S>",
    "<S> pitchforks_. we find a recursive formula to calculate the joint and conditional probabilities of cherries and pitchforks when the size of the tree is fixed . </S>"
  ]
}