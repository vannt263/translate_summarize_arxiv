{
  "article_text": [
    "finding an optimal lower bound for the number of arithmetic progressions of length 3 in any subset of fixed cardinality in a set is extremely difficult , and finding this for the cyclic group would imply close to optimal bounds to szemerdi s theorem . in this paper",
    "we develop new methods that theoretically will achieve the optimal lower bound by putinar s positivstellensatz , and provide a relaxation scheme based on the lasserre hierarchy providing lower bounds to the number of arithmetic progressions .",
    "the methods are general and can be applied to any fixed density set .",
    "we apply the methods to find the first known lower bound for the number of arithmetic progressions in any subset @xmath0 of the cyclic group @xmath1 with a fixed density @xmath2 for any prime @xmath3 ( theorem [ thm : density ] ) , and investigate how much this can be improved using a similar certificate ( theorem [ thm : density2 ] and corollary [ cor : density ] ) .",
    "we discuss a possible way to improve the bounds further , which in theory could ultimately generalize szemerdi s theorem , in section [ sec : discussion ] .",
    "we provide sharper lower bounds with algebraic certificate for all primes @xmath4 ( theorem [ thm : smallprimes ] ) , and in section [ sec : numerical2 ] we discuss lower bounds found using a numerical certificate for all primes @xmath5 and the correct results up to @xmath6 found by searching through all different possibilities .",
    "we have provided tables of all these exact lower bounds in the appendix .",
    "the easiest is always to consider small examples .",
    "let @xmath7,d / n)$ ] denote the optimal lower bound for the number of arithmetic progressions of length @xmath8 in any subset of @xmath9 $ ] of cardinality @xmath10 .",
    "let @xmath11 denote the optimal lower bound for the number of arithmetic progressions of length @xmath8 in any subset of @xmath12 of cardinality @xmath10 . using the gray code for fixed density necklaces that is introduced in section [ sec : graycode ] we can find the exact value for @xmath11 when @xmath13 and @xmath14 for any @xmath15 .",
    "we have done this for @xmath16 , and the results can be found in tables [ tab : bubble3_1 ] , [ tab : bubble3_2 ] , [ tab : bubble4_1 ] , [ tab : bubble4_2 ] , [ tab : bubble5_1 ] and [ tab : bubble5_2 ] in the appendix .",
    "these results can not be extended to all @xmath17 , which is why the rest of the theorems involve lower bounds of @xmath11 .",
    "the next theorem is the first theorem quantifying how many arithmetic progressions there are in any subset @xmath0 of @xmath1 of cardinality @xmath18 .",
    "the bound holds for any prime @xmath3 .",
    "[ thm : density ] let @xmath3 be a prime number .",
    "a lower bound for the minimum number of arithmetic progressions of length @xmath19 among all subsets of @xmath1 of cardinality @xmath10 , @xmath20 is @xmath21 a certificate for the lower bound is given by : @xmath22 where @xmath23    one can hope to find a sharper bound than the one provided in theorem [ thm : density ] that holds for all primes , but how to find this is not trivial .",
    "next we provide sharper bounds for some low primes . the reason we can find nice algebraic bounds for @xmath4 has to do with that the trigonometric functions in theorem [ thm : density2 ] are on a nice form . we could find results for slightly larger @xmath3 , but it would require more work and the bounds would contain messy combinations of trigonometric functions .",
    "[ thm : smallprimes ] let @xmath3 be prime and let @xmath24 denote the minimum number of arithmetic progressions of length @xmath19 among all subsets of @xmath1 of cardinality @xmath10 .",
    "there are algebraic certificates with polynomials up to degree 3 giving the following bounds @xmath25 @xmath26",
    "@xmath27 @xmath28 and @xmath29    in fact , finding bounds sharper than those in theorem [ thm : density ] can be done very efficiently for relatively small primes using a simple degree 3 relaxation .",
    "as shown in the following theorem we can reformulate a certain relaxation as a linear program :    [ thm : density2 ] let @xmath30 be a primitive root of the prime @xmath3 .",
    "let further @xmath31 for all @xmath32 , @xmath33 for all @xmath34 @xmath35^t,\\ ] ] @xmath36 and @xmath37 for @xmath38 .",
    "the following optimization problems attain the same optimal value :    * @xmath39 where @xmath40 for @xmath41 and @xmath42 .",
    "* @xmath43    the following corollary , which follows from theorem [ thm : density ] and theorem [ thm : density2 ] shows that there is room to improve the bounds further .",
    "[ cor : density ] let @xmath3 be prime and denote the optimal value to problem ( a ) in theorem [ thm : density2 ] by @xmath44 : @xmath45 where @xmath46 for @xmath41 and @xmath42 . for all @xmath3 @xmath47",
    "this section provides a literature review on existence type theorems about arithmetic progressions .",
    "we start with some basic definitions and discuss many of the major contributions to the field .    for @xmath48 ,",
    "let us define the _",
    "( upper ) density _",
    "@xmath49    as an example , the density of the even positive integers is @xmath50 .",
    "formally we define arithmetic progressions for the integers and for finite groups in the following way :    an _ arithmetic progression of length @xmath51 _ in the positive integers is given by @xmath52 , where @xmath53 .",
    "an arithmetic progression of length @xmath51 in a finite group @xmath54 is a set of @xmath8 distinct elements @xmath55 , where @xmath56 and @xmath57 .",
    "to clarify , for example @xmath58 , @xmath59 , @xmath60 , @xmath61 , @xmath62 and @xmath63 should be considered as the same arithmetic progression as it is the same set of @xmath19 distinct elements , hence when we write @xmath64 only one representative for every arithmetic progression is used .",
    "it is interesting to study arithmetic progressions since it measures how structured a set is .",
    "a set is usually either very random in nature or has a structure similar to that of an arithmetic progression . in additive combinatorics",
    "one tries to answer questions about the length of the longest arithmetic progressions contained in very unstructured sets , how structured sets are contained in generalizations of arithmetic progressions and many similar questions . in the last century a lot of results in additive combinatorics have been proven using probabilistic methods , fourier - analytic methods , sum set estimates , graph theory , ergodic theory and algebraic methods . to answer questions about existence of arithmetic progression in subsets of the integers",
    "is one of the most difficult questions in additive combinatorics , and the question that has gotten the most attention .",
    "we refer to the book by tao and vu @xcite for an accessible introduction to the subject .",
    "van der waerden proved in 1927 @xcite that for any given positive integers @xmath30 and @xmath8 there is a number @xmath65 such that if the integers @xmath66 are colored in @xmath30 colors , then there exists a monochromatic arithmetic progression of length @xmath8 .",
    "this is one of the key results of ramsey theory .",
    "the smallest such @xmath65 will be denoted @xmath67 and is called the _ van der waerden number_. already for @xmath68 we have a huge gap between the lower bound @xmath69 for primes by berlekamp @xcite and the upper bound @xmath70 by gowers @xcite . finding bounds for van der waerden - like numbers is still an active area of research , recent contributions include @xcite .",
    "results about arithmetic progressions in fixed - density sets implies results about monochromatic arithmetic progressions in colorings and are thus more general .",
    "the first non - trivial result about existence of arithmetic progressions in sets is due to roth in 1953 .",
    "the proof is based on the hardy - littlewood circle method , and because of this result roth was awarded the fields medal in 1958 .",
    "if @xmath48 and @xmath71 , then it follows that we can find arithmetic progressions in @xmath0 of length @xmath19 .    in 1969",
    "szemerdi strengthened roth result to existence of arithmetic progressions of length 4 @xcite and in 1975 he generalized it to arithmetic progressions of arbitrary length @xcite . in order to prove the result szemerdi developed the famous regularity lemma , which states that every large enough graph can be partitioned into subgraphs of about the same size so that the edges between the different subgraphs behave fairly randomly .",
    "for these and other combinatorial results he was awarded the abel prize in 2012 .",
    "if @xmath48 and @xmath71 , then it follows that we can find arbitrarily long arithmetic progressions in @xmath0 .",
    "we denote by @xmath72 the smallest positive integer such that for any @xmath73 it holds that any subset of @xmath74 of cardinality @xmath75 contains an arithmetic progression of length @xmath8 for @xmath76 .",
    "similarly we define @xmath77 to be the smallest density such that any subset of @xmath78 of cardinality @xmath79 contains an arithmetic progression of length @xmath8 for any @xmath80 .",
    "szemerdi s theorem implies the existence of an @xmath72 for any @xmath8 and @xmath81 but fails to provide any good bounds for this number .",
    "another proof of szemerdi s theorem using ergodic methods was mainly due to furstenberg in 1982 @xcite .",
    "the ergodic methods makes the proof easier , and they have implied several other results in additive combinatorics including a multi - dimensional version and a polynomial version of szemerdi s theorem , and the related density hales - jewett theorem .",
    "tao gave a quantitative version based on ergodic theory in 2006 @xcite , but no effective bound for @xmath72 has been found using ergodic methods .",
    "even though roth s theorem is old , there has been more recent progress on improving the quantitative bounds @xmath82 .",
    "most results are formulated bounding @xmath83 instead of @xmath82 , and so we follow this notation .",
    "roth s original proof showed that there is a constant @xmath84 such that @xmath85 .",
    "this was improved by heath - brown and szemerdi @xcite showing that there exist constants @xmath86 and @xmath87 such that @xmath88 and later by bourgain @xcite showing that @xmath89 for some constant @xmath84 .",
    "more recently bourgain @xcite improved the bound to @xmath90 , then sanders @xcite improved it to @xmath91 and then sanders @xcite improved it further to @xmath92 for some large enough constant @xmath84 .",
    "versions of roth s theorem for other groups have also been of interest lately .",
    "the result was generalized to hold for arbitrary abelian groups of odd order by meshulam in 1995 @xcite .",
    "a way to generalize roth s theorem is through generalizing the ( triangle ) removal lemma , which is related to szemerdi s regulaity lemma .",
    "green generalized the removal lemma to abelian groups @xcite , and krl , serra and vela generalized it to hold for all finite groups , with a version of roth s theorem for all finite groups as a consequence @xcite :    let @xmath54 be a finite group of odd order @xmath65 and @xmath0 a subset of its elements .",
    "if the number of solutions of the equation @xmath93 with @xmath94 is @xmath95 , then the size of @xmath0 is @xmath96 .    to get the result to also hold for non - abelian groups they had to avoid using fourier analysis .",
    "other results in additive combinatorics for non - abelian groups are the results by bergelson and hindman @xcite , gowers @xcite , tao @xcite , sanders @xcite and solymosi @xcite .",
    "the results have been established long after the commutative counterparts , and often with much weaker bounds .",
    "let @xmath97 denote @xmath98 , @xmath99 , and so on .",
    "in 1998 @xcite gowers showed that there exists an absolute constant @xmath84 such that @xmath100 , which was a major improvement on the previous best bound .",
    "the bound was improved by green and tao in 2009 @xcite to @xmath101 . in 2001",
    "gowers provided the first effective upper bound for @xmath72 for @xmath102 using the fourier analytic machinery he had developed and been awarded the fields medal for in 1998 .",
    "[ thm : gowers ] let @xmath8 be a positive integer and let @xmath103 .",
    "then @xmath104    before stating our next theorem , let us state what ( gower s version of ) szemerdi s theorem implies about @xmath105,\\delta)$ ] .",
    "[ cor : limit ] it follows by theorem [ thm : gowers ] that @xmath106,\\delta ) > 0 \\ } = 0.\\ ] ] conversely , if there are lower bounds @xmath107,\\delta ) \\leq w(k,[n],\\delta)$ ] with the additional property that @xmath108,\\delta ) > 0 \\ } = 0\\ ] ] holds , then szemerdi s theorem would follow .",
    "we want to show that for any @xmath109 and @xmath110 there exists @xmath111 such that @xmath112,\\delta ) > 0 \\ } < \\epsilon\\ ] ] for all @xmath113 . by theorem [ thm : gowers ] we know that if we pick @xmath114 , then any subset @xmath115 with cardinality @xmath116 , where @xmath117 , contains an arithmetic progression of length @xmath8 , hence the desired inequality holds .    on the other hand ,",
    "suppose @xmath108,\\epsilon ) > 0 \\ } = 0.\\ ] ] since @xmath107,\\epsilon ) \\leq w(k,[n],\\epsilon)$ ] it follows that @xmath106,\\epsilon ) > 0 \\ } = 0,\\ ] ] or in other words that for any @xmath109 there exists an @xmath118 such that for any @xmath119 it holds that @xmath115 with cardinality @xmath120 has an arithmetic progression of length @xmath8 .",
    "this is equivalent to that there are bounds for szmerdi s theorem on the form @xmath121 .",
    "another proof strategy for szemerdi s theorem relies on generalizing szemerdi s regularity lemma to hypergraphs , and was developed independently by gowers @xcite and nagle , rdl , schacht and skokan @xcite .",
    "all the results above on szemerdi s theorem require a positive upper density , but this condition might not be necessary .",
    "an open problem is how dense does a set have to be in order to contain arithmetic progressions .",
    "the following has been conjectured by erds and turn .",
    "let @xmath0 be a subset of the positive integers .",
    "@xmath0 contains arithmetic progressions of any length if @xmath122 diverges .",
    "the primes do not have positive density , but results on arithmetic progressions among them would follow from the erds - turn conjecture .",
    "existence of arithmetic progressions of length 3 among any positive proportion of the prime numbers was proven by green @xcite and quantitative improvements were made by helfgott and roton @xcite . the result for arithmetic progressions of arbitrary length",
    "was found using szemerdi s regularity lemma and properties about the distribution of primes by green and tao @xcite .",
    "there exist arbitrarily long arithmetic progressions among the prime numbers .",
    "so far we have only discussed results on upper bounds for @xmath77 , one can also try to find lower bounds .",
    "the lower bounds are still very far from the upper bounds , and surprisingly not much improvements have been done on the lower bounds for over 50 years .",
    "let @xmath84 be a large enough constant .",
    "the lower bound for @xmath123 due to behrend @xcite @xmath124 was the best bound for over 60 years until elkin @xcite recently improved it to @xmath125 for larger @xmath8 the we have the following bound by rankin @xcite : @xmath126 soon after elkin improved the bound for @xmath123 , obryant @xcite improved the bounds for @xmath123 and general @xmath8 further : for every @xmath127 and @xmath65 large enough @xmath128 and @xmath129{\\log_2 n } + \\frac{1}{2n } \\log_2 \\log_2 n},\\ ] ] where @xmath130 is an unspecified constant and @xmath131 .",
    "szemerdi s theorem roughly states that any subset @xmath132 of the integers , however random and unstructured it is , will contain very structured subsets if @xmath65 and @xmath133 are large enough .",
    "one can ask how long arithmetic progressions there are in more structured sets , such as for example @xmath134 and @xmath135 .",
    "in fact , the additional structure allows us to find much longer arithmetic progressions , for example we have the following result from bourgain @xcite on sums of sets :    let @xmath136 be a prime nuber and @xmath137 additive sets in @xmath1 with @xmath138 for some @xmath139 where @xmath140 is a large enough absolute constant",
    ". then @xmath141 contains an arithmetic progression of length at least @xmath142 for some constant @xmath143 .",
    "iterated sumsets have even more structure , and results include those of srkzy @xcite , lev @xcite , nathanson and rusza @xcite , and szemerdi and vu @xcite .",
    "we state a quite general and strong theorem from @xcite :    let @xmath144 .",
    "there exists constants @xmath145 such that for any @xmath146 and @xmath147 of cardinality @xmath148 and @xmath149 , @xmath150 contains a proper arithmetic progression of length @xmath151    the number of arithmetic progressions in a fixed density set is closely related to the number of monochromatic arithmetic progressions in coloring of a set .",
    "all results above can easily be translated in terms of colorings .",
    "a _ @xmath152-coloring _ of a set @xmath0 is a map @xmath153 splitting @xmath0 into @xmath152 color classes .",
    "if there exist arithmetic progressions in any set @xmath154 with positive upper density @xmath71 then there exist monochromatic arithmetic progressions in any @xmath152-coloring of the positive integers .",
    "suppose there exist arithmetic progressions in any set @xmath154 with positive upper density .",
    "let @xmath155 be a @xmath152-coloring of the positive integers . since @xmath152 is finite we have @xmath156 for any @xmath17 , and thus for some @xmath157 the color class @xmath158 has positive upper density . by assumption",
    "there are arithmetic progressions in @xmath159 , and thus of color @xmath157 .",
    "the ultimate goal in combinatorial problems is always to count the desired constellation .",
    "the existence results on arithmetic progressions provide very strong results on how many arithmetic progressions there are in certain limits , but provides no information about the amount of arithmetic progressions far from the limits . to make the statements precise ,",
    "let us define the functions of interest :    let @xmath160,c)$ ] denote the minimal number of monochromatic arithmetic progressions of length @xmath8 in any @xmath152-coloring of @xmath9=\\{1,\\dots , n\\}$ ] .",
    "let @xmath161 denote the minimal number of monochromatic arithmetic progressions of length @xmath8 in any @xmath152-coloring of a finite group @xmath54 .",
    "let @xmath7,\\delta)$ ] denote the minimal number of arithmetic progressions of length @xmath8 in any subset @xmath162 of cardinality @xmath163 .",
    "let @xmath164 denote the minimal number of arithmetic progressions of length @xmath8 in any subset @xmath165 of cardinality @xmath166 .",
    "it would of course be desirable to find the exact values of these functions for any possible inputs @xmath8 ,",
    "@xmath17 , @xmath152 , @xmath81 and @xmath54 , but it is not likely that they will ever be found because of how complicated the functions are . finding the exact functions would give us sharp upper bounds for szemerdi s theorem for all @xmath8 , which is known to be extremely difficult already for low values of @xmath8 .",
    "since there is little hope in finding the exact functions , we aim to find as good lower bounds to the functions as possible .",
    "good lower bounds provide a better understanding of arithmetic progressions , and if they are good enough they may additionally improve the current best existence bounds .",
    "we state all the best bounds known for various inputs that we have been able to find in the literature .",
    "upper bounds are also provided , and are usually achieved by colorings .",
    "* r(3,[n],2 ) * : upper and lower bound from @xcite .",
    "@xmath167,2 ) \\leq \\frac{117}{2192}n^2(1+o(1))\\ ] ]    * r(3,@xmath12,2 ) * : upper and lower bound from @xcite ( the special case @xmath168 found first in @xcite ) .",
    "@xmath169 where constants depends on @xmath170 : @xmath171    * r(3,@xmath172,2 ) * : upper and lower bound from @xcite .",
    "@xmath173 where constants depends on @xmath170 : @xmath171    * r(3,g,2 ) * : let @xmath54 be any finite group .",
    "let @xmath174 denote the set of elements of @xmath54 of order @xmath8 , @xmath175 and @xmath176 .",
    "denote the euler phi function @xmath177 .",
    "let @xmath178 .",
    "lower bound from @xcite : @xmath179    * r(4,@xmath12,2 ) * : wolf @xcite contributed with several bound on @xmath180 .",
    "the bounds were improved by lu and peng @xcite .",
    "note that the results in their paper differs by a factor 2 , this is because they count @xmath181 and @xmath182 as distinct arithmetic progressions . if @xmath3 is prime we have ( * ? ? ?",
    "* theorem 1.1 ) : @xmath183 for general @xmath17 we have ( * ? ? ? * theorem 1.2 and theorem 1.3 ) : @xmath184 where constants depends on @xmath185 : @xmath186 furthermore we have ( * ? ? ? * theorem 1.5 ) @xmath187 and the following conjecture ( * ? ? ?",
    "* conjecture 1.1 ) : @xmath188    * r(4,[n],2 ) * : upper bound from ( * ? ?",
    "* equation ( 12 ) ) : @xmath189,2 ) \\leq \\frac{1}{72}n^2(1+o(1)).\\ ] ]    * r(5,@xmath12,2 ) * : for odd @xmath17 we have ( * ? ? ?",
    "* theorem 1.4 ) : @xmath190 for even @xmath17 we have ( * ? ? ? * theorem 1.4 ) : @xmath191 furthermore we have ( * ? ? ? * theorem 1.5 ) @xmath192    * r(5,[n],2 ) * : upper bound from ( * ? ? ?",
    "* equation ( 13 ) ) : @xmath193,2 ) \\leq \\frac{1}{304}n^2(1+o(1)).\\ ] ]    * w(3,@xmath1,@xmath81 ) * let @xmath3 be prime .",
    "a lower bound is given by theorem [ thm : density ] : @xmath194    since @xmath195 is an arithmetic progression in @xmath196 if and only if @xmath197 for distinct @xmath198 there are many related problems where one tries to count the number of solutions to various linear equations .",
    "one example is schur triples , which are triples @xmath195 such that @xmath199 , have been studied in @xcite .",
    "other examples include sets with no solutions to @xmath200 studied in @xcite and monochromatic solution to equations in groups @xcite .",
    "tools from real algebraic geometry are used to prove the main results of this paper . even though the main result can be understood without understanding polynomial optimization",
    ", it played a vital part when finding the certificates in the main theorems .",
    "only a few of the most important theorems will be presented . for a more extensive survey on the topic",
    "we refer to the excellent paper by laurent @xcite . for a longer review of how we applied and implemented methods from real algebraic geometry to the specific problem",
    "we refer to @xcite .",
    "we use polynomial optimization to count monochromatic arithmetic progressions , and so in this section we briefly review the topic .",
    "let @xmath201 be polynomials .",
    "a problem on the form @xmath202 is a polynomial optimization problem .",
    "one way to solve a polynomial optimization problem is by studying the related problem : @xmath203    let @xmath204 $ ] be polynomials .",
    "the _ quadratic module _ generated by @xmath205 is defined by : @xmath206    a quadratic module @xmath207 is _ archimedean _ if there is an @xmath208 such that @xmath209    [ thm : putinar ] let the set @xmath210 be compact .",
    "assume that the associated quadratic module @xmath207 is archimedean . if @xmath211 is strictly positive on @xmath212 , then it is possible to find sums of squares @xmath213 such that @xmath214 .    in other words ,",
    "if the quadratic module of the polynomial constraints in the polynomial optimization problem is archimedean it is possible to solve the polynomial optimization problem using @xmath215 where @xmath216 is the actual parameter , and @xmath217 is a formal indeterminate .",
    "let @xmath218 be the optimal value of the related problem in which the degrees of the sums of squares are bounded : @xmath219 it is easy to see that @xmath220 for any @xmath221 .",
    "furthermore , the following important convergence result follows directly from putinar s positivstellensatz ( we present a simplified version of theorem 3.4 page 805 @xcite , and theorem 4.1 page 79 @xcite ) :    let @xmath222 $ ] , let @xmath223 be compact and assume that @xmath224 is archimedean .",
    "assume that @xmath225 and @xmath226 defined as above are finite and let @xmath218 denote the optimal value of the @xmath221th restriction defined above .",
    "then @xmath227 as @xmath228 .",
    "the family of relaxations @xmath218 is often referred to as the lasserre hierarchy .",
    "let @xmath229 denote the vector of all monomials of degree less than or equal to @xmath230 .",
    "@xmath231 is a sum of squares of degree @xmath232 if and only if it is possible to find a positive semidefinite matrix @xmath233 such that @xmath234 .",
    "it follows that @xmath218 can be obtained by @xmath235 we rewrite the problem in order to get it on the generic form of a semidefinite program . if we let @xmath236_\\alpha x^\\alpha$ ] , we see that @xmath237_0 = \\lambda , \\\\ & \\displaystyle [ f(x ) - v _ { \\lfloor \\frac{j}{2 } \\rfloor } ^tq_0v _ { \\lfloor \\frac{j}{2 } \\rfloor } + \\sum_{i=1}^m v _",
    "{ \\lfloor \\frac{j- \\deg(g_i)}{2 } \\rfloor}^tq_iv _ {   \\lfloor \\frac{j - \\deg(g_i)}{2 } \\rfloor } g_i(x)]_\\alpha = 0 \\\\ & \\textrm { for all } \\alpha , \\\\ & \\displaystyle   q_i \\succeq 0 \\textnormal { for } i = 0,1,\\dots , m . \\\\",
    "\\end{array}\\ ] ] since @xmath238_\\alpha$ ] is a linear polynomial in the entries of the matrices @xmath239 this is indeed a semidefinite program .",
    "any numerical solution to the semidefinite program includes a certificate based on positive semidefinite matrices .",
    "the certificate can be translated into a sum of squares based certificate .",
    "the sum of squares based certificate attained additionally serves as a lower bound to the original polynomial optimization problem since @xmath240 .",
    "sum of squares based certificates are very easy to check by hand , which is one of the major advantages of this method .",
    "this subsection can be skipped for the reader who just wants to understand the final proofs as these methods were just necessary to find the numerical solutions that allowed us to find the final certificates .",
    "the main result we review in this section is theorem [ thm : schrijver ] as it is one of the strongest results when working on semidefinite programs with symmetries .",
    "we discuss the limitations of this theorem when applied to our specific problem in section [ sec : methodsdensity ] . because of these limitations we would barely gain anything by using theorem [ thm : schrijver ] instead of the easier lemma [ lem : groupaverage ] .",
    "although the lemma is a very basic result in representation theory , the numerical calculations done in this article would not have been possible without this lemma .",
    "let @xmath84 and @xmath241 be real symmetric matrices and let @xmath242 be real numbers . in this section",
    "the objective is to reduce the order of the matrices in the semidefinite programming problem @xmath243 when it is invariant under the actions of a group .    as in @xcite and @xcite",
    ", we use a @xmath244representation to reduce the dimension of the matrices . for a survey on @xmath244algebras",
    "we refer to the book by takesaki @xcite .",
    "the method we use as well as other efficient methods for invariant semidefinite programs are discussed in @xcite .",
    "other important recent contributions include @xcite .",
    "a _ matrix @xmath244-algebra _ is a collection of matrices that is closed under addition , scalar and matrix multiplication , and transposition .",
    "let @xmath54 be a finite group , which acts on a finite set @xmath245 and let @xmath246 be the group of all permutations of @xmath245 .",
    "let @xmath247 be a homomorphism @xmath248 that takes any element @xmath249 to a permutation @xmath250 of @xmath245 for which @xmath251 and @xmath252 .",
    "for every permutation @xmath253 we element - wise define the corresponding permutation matrix @xmath254 by @xmath255 for all @xmath256 .",
    "the span of these matrices is the following matrix @xmath244-algebra @xmath257 the matrices @xmath217 that commute with all permutation matrices are the _ invariant matrices _ of @xmath54 .",
    "the collection of all such matrices , @xmath258 is called the _ commutant _ of @xmath259 , and it is again a @xmath244-algebra .",
    "denote the dimension of the commutant by @xmath260 .",
    "let @xmath261 be the matrix of size @xmath262 of ones .",
    "the commutant has a basis of @xmath263-matrices @xmath264 such that @xmath265 .",
    "we form a new normalized basis by @xmath266 for which @xmath267 where @xmath268 is the kronecker delta .",
    "the _ multiplication parameters _ @xmath269 are then defined by @xmath270 for @xmath271 .",
    "we define @xmath272-matrices @xmath273 by @xmath274 for @xmath275 , which span @xmath276    the linear function @xmath277 defined by @xmath278 for @xmath279 is a bijection .",
    "the linear function additionally satisfies @xmath280 and @xmath281 for all @xmath282 .",
    "@xmath283 is positive semidefinite if and only if @xmath284 is positive semidefinite .",
    "[ cor : schrijver ]    the next lemma shows that we can find @xmath285 .",
    "it is then possible to use corollary [ cor : schrijver ] to reduce the order of the semidefinite constraint .",
    "[ lem : groupaverage ] there is a solution @xmath285 to a @xmath54-invariant semidefinite program @xmath286    let @xmath287 be @xmath262 matrices commuting with @xmath288 for all @xmath249 . if @xmath217 is an optimal solution to the optimization problem then the group average , @xmath289 , is also an optimal solution : it is feasible since @xmath290 where we have used that the well - known fact that the trace is invariant under change of basis . by the same argument @xmath291 , which implies that @xmath292 is optimal .",
    "it is easy to see that @xmath293 .",
    "all in all we get the following theorem :    [ thm : schrijver ] the semidefinite program @xmath294 has a solution @xmath295 that can be obtained by @xmath296    when @xmath230 is smaller than @xmath297 the theorem can be used to reduce the size of the linear matrix inequality , which in turn improves the computational efficiency .",
    "this allows us to solve many problems that would otherwise not be possible .",
    "the original gray code was used by frank gray in a patent filed in 1947 and granted in 1953 @xcite . for a background on gray codes",
    "we refer to knuth s art of computer programming @xcite . in this chapter",
    "we present some recent development on a gray code for fixed - density necklaces by ruskey , sawada and wiliams .",
    "these new methods are useful for counting arithmetic progressions , and the author s contribution based on these methods can be found in section [ sec : numerical2 ] .    to represent all subsets @xmath298 of density @xmath299 we use binary strings ; when for example @xmath300 , @xmath123 and @xmath301 all different possible @xmath0 are : @xmath302 , @xmath303 , @xmath304 , @xmath305 , @xmath306 .",
    "all these strings are just rotations of one another . in our application",
    "it is enough to consider the lexicographically smallest @xmath306 . to exclude rotation and generate all sets of fixed density",
    "is what is in the literature called to generate all _ fixed - density necklaces_. there is software using gray code for listing all fixed - density necklaces in constant amortized time implemented in c @xcite , based on theory developed in @xcite and @xcite .",
    "we only cover the material useful for fixed - density necklaces , and refer to the mentioned articles for the most general forms of the theorems .",
    "a _ gray code _ is a generation of all combinatorial possibilities in which only a constant amount of change is required to go from any binary string to the following binary string .",
    "if there in addition only is a constant change to go from the last binary string to the first binary string , the gray code is _ cyclic_.    to understand the concept we begin with the example of generating binary @xmath17-tuples using gray code .",
    "denote a binary @xmath17-tuple by @xmath307 where @xmath308 , and let @xmath309 denote the parity .",
    "we can generate all possible @xmath17-tuples by only changing one number @xmath310 at the time using the following algorithm :    * initiate with @xmath311 for @xmath312 and @xmath313 .",
    "* visit @xmath314 .",
    "* if @xmath313 , set @xmath315 , otherwise let @xmath316 . *",
    "terminate if @xmath317 , otherwise let @xmath318 and thus also @xmath319 and return to step 2 .    for a discussion about why this generates a cyclic gray code , and for other algorithms to generate @xmath17-tuples ,",
    "we refer to the material by knuth ( subsection 7.2.1.1 .",
    "pages 139 @xcite ) , here we just check how the algorithm works for @xmath320 :    we run through the given algorithm with input @xmath320 to generate all binary @xmath321-tuples .",
    "+ @xmath322 , @xmath323 + @xmath324 , @xmath325 + @xmath326 , @xmath323 + @xmath327 , @xmath328 + @xmath329 , @xmath323 + @xmath330 , @xmath325 + @xmath331 , @xmath323 + @xmath332 , @xmath333 + @xmath334 , @xmath323 + @xmath335 , @xmath325 + @xmath336 , @xmath323 + @xmath337 , @xmath328 + @xmath338 , @xmath323 + @xmath339 , @xmath325 + @xmath340 , @xmath323 + @xmath341 , @xmath342 + as claimed all @xmath343 of the binary @xmath321-tuples has been generated , and in every step there is only @xmath344 bit that changes .",
    "further note that to go from @xmath341 to @xmath322 we also need to change @xmath344 bit , hence the code in this example is cyclic .    a _ bubble language _ is a set of binary strings with either of the following properties :    * the first @xmath345 of any string can be switched to @xmath346 to obtain another string in the set . *",
    "the first @xmath346 of any string can be switched to @xmath345 to obtain another string in the set .",
    "a wide variety of families of combinatorial objects are bubble languages , we only give a few examples and one proof here , and refer to @xcite for omitted proofs and further examples .",
    "we consider fixed density necklaces as they represent all possibilities of fixed - density sets in our application .",
    "the proof for the following proposition also works for the lexicographically smallest representatives of all necklaces and for lyndon words ( restricting to the aperiodic necklaces ) .",
    "the set of the lexicographically smallest representatives of fixed - density necklaces is a bubble language .",
    "we prove that if we switch the first @xmath346 to a @xmath345 in any necklace we get another necklace .",
    "consider a necklace @xmath347 .",
    "if @xmath348 , then suppose the first @xmath346 appears at positions @xmath221 and @xmath349 .",
    "the string @xmath350 must start with @xmath351 for some @xmath352 , @xmath353 , because otherwise there would be a lexicographically smaller rotation of @xmath350 . note also that if we switch the first @xmath346 to @xmath345 we get a string @xmath354 which is lexicographically smaller than @xmath350 .",
    "we need to check that every rotation of @xmath354 is lexicographically larger than @xmath354 itself . rotating and switching @xmath355 with @xmath356 commutes ,",
    "so to keep the notation simple , let us rotate first .",
    "let @xmath357 denote the @xmath157th rotation of @xmath350 , let @xmath358 denote the string we get after swapping @xmath355 with @xmath356 in @xmath359 , and let us consider 4 cases :    * @xmath360 : the prefix of @xmath359 is of the form @xmath361 with @xmath362 , and is larger than the prefix of @xmath350 . since @xmath363 we have @xmath364 and the swap of @xmath355 and @xmath356 thus only removes a @xmath344 in the end of the prefix in both @xmath359 and @xmath354 , which does not affect the lexicographic order of the two .",
    "we conclude that @xmath354 is lexicographically smaller than @xmath365 .",
    "* @xmath366 : if @xmath367 then @xmath354 starts with @xmath368 and @xmath354 is thus lexicographically smaller than @xmath366 , which starts with @xmath345 .",
    "if @xmath369 , then since @xmath350 is lexicographically smaller than @xmath370 we must have @xmath371 and @xmath372 .",
    "thus we get that @xmath354 starts with @xmath373 whereas @xmath366 starts with @xmath374 .",
    "it is clear that @xmath354 is lexicographically smaller than @xmath366 .",
    "* @xmath375 : we note that @xmath375 starts with a @xmath344 whereas @xmath354 start with a @xmath376 .",
    "@xmath354 is clearly lexicographically smaller than @xmath375 . *",
    "@xmath377 : after the rotation the swap does not occur in the prefix of @xmath359 , whereas it makes the prefix of @xmath350 smaller .",
    "thus since @xmath350 is lexicographically smaller than @xmath359 we can conclude that @xmath354 is lexicographically smaller than @xmath377 .    in _ co - lexicographic ( co - lex ) order _ strings are sorted by increasing value of their last symbol , i.e. lexicographic order read from right to left .    the co - lex order does not provide a gray code , but it is more intuitive to define how we can recursively generate all binary strings in co - lex order .",
    "once we have defined everything properly it is easy to introduce the cool - lex order , which is just a small modification of co - lex order and provides the gray code we are interested in .",
    "any binary string can be decomposed in the form @xmath378 where @xmath379 is the suffix consisting of all remaining zeroes and ones .",
    "we denote the empty suffix by @xmath380 .",
    "we have the following recursive formula for generating all fixed density necklaces in a co - lex order ( * ? ? ?",
    "* page 7 ) :    let initially @xmath381 , @xmath382 and @xmath383 .",
    "all necklaces of length @xmath17 and density @xmath230 are generated recursively in co - lexicographic order by @xmath384 where @xmath221 is the minimum value such that @xmath385 is a fixed density necklace .",
    "we can visualize the recursion with a _ computation tree _ , in which every node is labeled with a suffix @xmath379 from a certain instance of the recursion .",
    "we label the root by @xmath380 , and the children of any node are labeled from left to right by @xmath386 with @xmath157 decreasing .",
    "when the suffix tree is build we add an additional leaf to each node in the tree of the form @xmath378 .",
    "the computation tree for necklaces of length @xmath387 with density @xmath321 can be found in figure [ fig : comptree ] .",
    "we can write it simpler by replacing the suffix at every node with the string in the leaf next to it .",
    "this simpler tree is called the _ compact computation tree _ , and the compact computation tree for necklaces of length @xmath387 with density @xmath321 can be found in figure [ fig : comptree2 ] .",
    "note that by construction we get the co - lex order by a pre - order traversal of the compact computation tree .",
    "now we are ready to define the cool - lex order , which provides a gray code .",
    "note that the only difference in that the term @xmath378 has been changed from first to last from the co - lex order .",
    "let initially @xmath381 , @xmath382 and @xmath383 .",
    "all necklaces of length @xmath17 and density @xmath230 are generated recursively in _ cool - lex order _ by @xmath388 where @xmath221 is the minimum value such that @xmath385 is a fixed density necklace .",
    "since the term @xmath378 is placed last in the recursion we get the cool - lex order by post - order transversal of the compact computation tree .    by either traversing the tree or using the recursive formula we can get the co - lex order and cool - lex order respectively for our example : @xmath389",
    "all we have done up to now could be done for any bubble language , not just for fixed density necklaces . by analyzing the possible steps from one binary string to the next in the compact computation tree in post - order one",
    "gets the following result ( theorem 3.1 , page 10 @xcite ) :    cool - lex order provide a gray code for any bubble language .    to prove that a specific bubble language can be generated in constant amortized time requires more involved analysis , and this was done in the case for fixed - density necklaces ( theorem 2 page 11 , @xcite ) :",
    "fixed - density necklaces can be generated in cool - lex gray code order or co - lex order in constant amortized time .",
    "the methods in this section are used to obtain the results in tables [ tab : bubble3_1 ] , [ tab : bubble3_2 ] , [ tab : bubble4_1 ] , [ tab : bubble4_2 ] , [ tab : bubble5_1 ] and [ tab : bubble5_2 ] in the appendix .",
    "recall that @xmath164 denotes the minimal number of @xmath8-arithmetic progressions in the subset @xmath390 with @xmath391 . for this article",
    "we are primarily interested in @xmath392 for prime @xmath3 . in the case when @xmath123 we have @xmath393 and using the methods introduced in sections [ sec : poly ] and [ sec : sym ] we make the following relaxation to get an algebraic certificate for the lower bound : @xmath394 where @xmath395^n : \\sum_{i=0}^{|g|-1}x_i = d\\}$ ] and @xmath396 for @xmath397 $ ] where @xmath398 are the half - spaces defining @xmath212 .",
    "let us use the degree 3 relaxation of putinar s positivstellensatz , and let the maximal lower bound using this relaxation be denoted @xmath399 .",
    "denote the elements of @xmath54 by @xmath400 and let @xmath401^t$ ] be the vector of all monomials of degree less or equal to one .",
    "we get @xmath402^{|g| } , \\\\ & \\displaystyle q_0,q_s^+,q_s^-,q_g^+,q_g^- \\succeq 0 \\textnormal { for all } g\\in g. \\end{array}\\ ] ] this optimization problem is equivalent to a problem on the form of , that is if we use the notation @xmath403_\\alpha x^\\alpha$ ] then : @xmath404_0 = \\lambda , \\\\ &   [ \\displaystyle p_{_g } -   v^t q_0 v + \\sum_{g \\in g } v^t q_g^+ vx_g + \\sum_{g \\in g }   v^t q_g^- v ( 1-x_g ) \\\\ & \\displaystyle + v^tq_s^+v(\\sum_{g \\in g } x_g -d ) + v^tq_s^-v(d - \\sum_{g \\in g } x_g)]_\\alpha = 0 , \\\\ & \\displaystyle x_{_g } \\in [ 0,1]^{|g| } , \\\\ & \\displaystyle q_0,q_s^+,q_s^-,q_g^+,q_g^- \\succeq 0 \\textnormal { for all } g\\in g. \\end{array}\\ ] ] since arithmetic progressions are invariant under affine transformations we can find a solution to the problem by restricting to invariant solutions . if @xmath405 is the identity element and @xmath406 $ ] we get @xmath407_0 = \\lambda , \\\\ &   [ \\displaystyle p_{_g } - v^tq_0v + \\sum_{g \\in g } v_g^tq_{g_1}^+v_g(1+x_g)+ \\sum_{g \\in g }",
    "v_g^tq_{g_1}^-v_g(1-x_g )   \\\\ & \\displaystyle + v^tq_s^+v(\\sum_{g \\in g } x_g -d ) + v^tq_s^-v(d - \\sum_{g \\in g } x_g)]_\\alpha = 0 , \\\\ & \\displaystyle x_{_g } \\in [ 0,1]^{|g| } \\\\ & \\displaystyle q_0,q_s^+,q_s^-,q_{g_{_1}}^+,q_{g_{_1}}^- \\succeq 0 , \\\\ & \\displaystyle q_0(g_i ,",
    "g_j ) = q_0(a + bg_i , a+bg_j ) , \\forall \\textnormal { } ( a , b ) \\in g \\rtimes \\mathbb{z}^+ , g_i , g_j \\in g , \\\\ & \\displaystyle q_0(g,1 ) = q_0(1,g ) = q_0(g_1,1 ) , \\forall \\textnormal { } g \\in g , \\\\ & \\displaystyle q_s^+(g_i , g_j ) = q_s^+(a + bg_i , a+bg_j ) , \\forall \\textnormal { } ( a , b ) \\in g \\rtimes \\mathbb{z}^+ , g_i , g_j \\in g , \\\\ & \\displaystyle q_s^+(g,1 ) = q_s^+(1,g ) = q_s^+(g_1,1 ) , \\forall \\textnormal { } g \\in g , \\\\ & \\displaystyle q_s^-(g_i , g_j ) = q_s^-(a + bg_i , a+bg_j ) , \\forall \\textnormal { } ( a , b ) \\in g \\rtimes \\mathbb{z}^+ , g_i , g_j \\in g , \\\\ & \\displaystyle q_s^-(g,1 ) = q_s^-(1,g ) = q_s^-(g_1,1 ) , \\forall \\textnormal { } g \\in g , \\\\ & \\displaystyle q_{g_1}^+(g_j , g_k ) = q_{g_1}^+(b   g_j , b   g_k ) , \\forall \\textnormal { } ( a , b ) \\in g \\rtimes \\mathbb{z}^+ , g_j , g_k \\in g ,   \\\\ & \\displaystyle q_{g_1}^-(g_j , g_k ) = q_{g_1}^-(b   g_j , b   g_k ) , \\forall \\textnormal { } ( a , b ) \\in g \\rtimes \\mathbb{z}^+ , g_i , g_j \\in g , \\\\ & \\displaystyle q_{g_1}^+(g,1 )   = q_{g_1}^+(b   g,1 ) , \\forall \\textnormal { } ( a , b ) \\in g \\rtimes \\mathbb{z}^+ , g \\in",
    "g , \\\\ & \\displaystyle q_{g_1}^-(g,1 )   = q_{g_1}^-(b   g,1 ) , \\forall \\textnormal { } ( a , b ) \\in g \\rtimes \\mathbb{z}^+ , g \\in g , \\\\ & \\displaystyle q_{g_1}^+(1,g )   = q_{g_1}^+(1,b   g ) , \\forall \\textnormal { } ( a , b ) \\in g \\rtimes \\mathbb{z}^+ , g \\in g ,   \\\\ & \\displaystyle q_{g_1}^-(1,g )   = q_{g_1}^-(1,b   g ) , \\forall \\textnormal { } ( a , b ) \\in g \\rtimes \\mathbb{z}^+ , g \\in g. \\\\ \\end{array}\\ ] ] we see that this reduces the number of variables significantly and in this new formulation we only need to require that five @xmath408-matrices are positive semidefinite instead of the @xmath409 matrices required in the original formulation .",
    "one could hope to reduce the size further using theorem [ thm : schrijver ] if the commutant is small .",
    "unfortunately though , one can not hope to get reduce the size of the @xmath410-matrices significantly since there will be one basis element of the commutant for the roughly @xmath411 pairs of @xmath19-tuples @xmath412 and @xmath413 , and these matrices turns out to be the most essential to be able to find @xmath399 .",
    "we have solved this semidefinite program to find lower bounds to @xmath24 for all primes @xmath414 and @xmath415 using the matlab - based software cvx @xcite on the triton computer cluster , which is part of the aalto science - it project .",
    "the code was parallelized and we ran it simultaneously on 100 computer nodes .",
    "all the data was generated in 5 days .",
    "the data helped us get the intuition needed to prove the theorems in this section .",
    "the theoretically most interesting piece of this data can be found in figure [ fig : allbounds ] in section [ sec : numerical2 ] . in that section",
    "the data is also discussed further .    to achieve better bounds",
    "we make a degree 5 relaxation of putinar s positivestellensatz .",
    "the sdp is the same as in the degree 3 relaxation above with the difference that @xmath416 is the vector of all monomials of degree up to @xmath417 , and thus the @xmath233-matrices are of size @xmath418 and many more equalities .",
    "just to get the equalities from the @xmath233-matrices required 2000 lines of code , which was significantly more than in the degree 3 relaxation .",
    "it is not obvious to the author how the code could be simplified significantly as there are so many different cases to consider . using the same computer cluster we found @xmath419 for all primes @xmath420 , @xmath421 and @xmath415 by running parallelized code simultaneously on 100 computer nodes for 7 days .",
    "again , the most interesting piece of data can be found in figure [ fig : allbounds ] in section [ sec : numerical2 ] .    since @xmath422 on @xmath423 it follows that @xmath424 @xmath425 and @xmath426 on @xmath423 , providing several new possibilities for polynomials that are nonnegative on @xmath423 .",
    "note that these equation holds over the discrete hypercube , but not necessarily on the continuous hypercube , so technically they have to be added before making the relaxation .",
    "similar assertion also holds for higher order polynomials .",
    "these redundant conditions simplifies the algebraic certificates we get from putinar s positivstellensatz , and replacing some of the original @xmath398s to these new constraints can in many cases simplify the computations significantly . by using these conditions and setting a lot of variables to zero",
    "we can make all polynomials homogeneous up to a constant and get lower bounds to @xmath399 .",
    "this is the main idea behind theorem [ thm : density2 ] . as adding seemingly redundant conditions on this form",
    "gives more freedom in the semidefinite relaxation one gets from putinar s positivstellensatz we believe that degree 4 and 5 version of this theorem can be found using a similar trick .",
    "numerical results suggests that a degree 4 and 5 certificate for a lower bound to the number of arithmetic progressions of length 3 would have many similar terms with certificates bounding arithmetic progressions of length 4 and 5 respectively .",
    "to simplify notation in the proofs of this section , let @xmath427 where @xmath230 is the number of orbits @xmath428 of the polynomials on the form @xmath429s under the action @xmath430 with @xmath431 .",
    "all we have to check is that the algebraic certificate @xmath432 where @xmath433 is correct .",
    "we have : @xmath434 @xmath435 @xmath436 and @xmath437 summing up we get @xmath438    an algebraic certificate proving that @xmath439 is the following : @xmath440 where @xmath441 @xmath442 @xmath443 and @xmath444 to check that everything adds up , let us use the @xmath445-notation : @xmath446 @xmath447 @xmath448 summing up yields @xmath449    an algebraic certificate proving that @xmath450 is the following : @xmath451 where @xmath452 @xmath453 @xmath454 @xmath455 and @xmath456 to check that everything adds up , let us use the @xmath445-notation : @xmath457 @xmath458 @xmath459 @xmath460 summing up yields @xmath461    an algebraic certificate proving that @xmath462 is the following : @xmath463 where @xmath464 @xmath465 @xmath466 @xmath467 and @xmath468 to check that everything adds up , let us use the @xmath445-notation : @xmath469 @xmath470 @xmath471 @xmath472 summing up yields @xmath473    an algebraic certificate proving that @xmath474 is the following : @xmath475 where @xmath476 @xmath477 @xmath478 @xmath479 and @xmath480 to check that everything adds up , let us use the @xmath445-notation : @xmath481 @xmath482 @xmath483 @xmath484 summing up yields @xmath485    an algebraic certificate proving that @xmath486 is the following : @xmath487 where @xmath488 @xmath489 @xmath490 @xmath491 and @xmath492 to check that everything adds up , let us use the @xmath445-notation : @xmath493 @xmath494 @xmath495 @xmath496 summing up yields @xmath497    to show theorem [ thm : density2 ] let us first prove two lemmas :    [ lem : density1 ] the following two problems are equivalent :    * @xmath39 where @xmath498 for @xmath499 and @xmath42 . * let @xmath30 be a primitive root of @xmath3 .",
    "@xmath500 where @xmath501 is given by @xmath502,\\ ] ] @xmath503 is element - wise given by @xmath31 for all @xmath32 , @xmath504 is the vector @xmath505^t\\ ] ] and @xmath416 is element - wise given by @xmath506 for @xmath38 .",
    "the polynomial @xmath507 in problem ( a ) can be written in matrix form .",
    "there is a unique positive semidefinite matrix @xmath508 such that if @xmath509 $ ] then @xmath510 and thus @xmath511    as arithmetic progressions are invariant under affine transformations ; if @xmath512 , and @xmath513 is an arithmetic progression , then @xmath514 is also an arithmetic progressions ; @xmath515 can also be assumed to be invariant under affine transformations by lemma [ lem : groupaverage ] .",
    "we get all elements of an orbit by first considering the orbit of the multiplicative action on @xmath516 , and then translate by the additive action to get the elements in @xmath517 for all @xmath518 .",
    "since @xmath517 is just a permutation of @xmath516 it follows that @xmath519 if and only if @xmath520 , hence requiring that @xmath521 is positive semidefinite is sufficient .",
    "let now @xmath522^t$ ] where @xmath30 is a primitive root of @xmath3 .",
    "since @xmath516 is invariant under the multiplicative group it follows @xmath523 for @xmath524 and hence @xmath525xx_0 \\\\ & \\displaystyle = x^tu'xx_0 . \\end{array}\\ ] ] we see that if we let @xmath526 we get @xmath527 where @xmath528.\\ ] ] since @xmath529 we conclude that @xmath530 , @xmath531 and that @xmath532 , where @xmath533 for all @xmath32 , @xmath35^t\\ ] ] and @xmath506 for @xmath38 .    finally we see that @xmath534 and simplifying gives the desired objective function : @xmath535    [ lem : density2 ] let @xmath30 be a primitive root of @xmath3 and @xmath536 .",
    "let further @xmath31 for all @xmath32 , @xmath35^t,\\ ] ] @xmath36 and @xmath506 for @xmath38 .",
    "the following two problems are equivalent :    * @xmath537 where @xmath501 is given by @xmath502,\\ ] ] * @xmath538 where @xmath539    as in the previous lemma , let @xmath540,\\ ] ] or in other words @xmath541\\ ] ] where @xmath542 . maximizing the objective function is equivalent to maximizing @xmath543 when @xmath544 .",
    "let @xmath545 be the matrix @xmath546 without its first row and column .",
    "@xmath545 is a circulant matrix , i.e. row @xmath157 is the first row shifted @xmath547 steps to the right .",
    "it is easy to see that @xmath501 is positive semidefinite if and only @xmath545 is positive semidefinite .",
    "@xmath545 is positive semidefinite if and only if all its eigenvalues are nonnegative .",
    "let @xmath548 , where @xmath549 .",
    "the eigenvalues of a circulant matrix with the first row @xmath550 $ ] are known to be on the form @xmath551 for @xmath552 . in our case @xmath553 for @xmath554 . by euler s formula",
    "we get @xmath555 @xmath556 since @xmath557 is an even function , thus it follows that all eigenvalues are nonnegative is equivalent to that @xmath558u \\geq 0\\ ] ] for @xmath559 , which is equivalent to the condition @xmath560 in problem ( b ) .",
    "the eigenvalue corresponding to to the eigenvector @xmath561 $ ] in @xmath545 is @xmath562 .",
    "we get the maximal value of @xmath543 when @xmath563 is maximized , that is when @xmath564 and thus @xmath565u}{p-1}=\\frac{u_0 + 2u_1+\\dots+2u_{(p-3)/2}+u_{(p-1)/2}}{p-1}.\\ ] ]    lemma [ lem : density1 ] shows that problems ( a ) and ( b ) are equivalent and lemma [ lem : density2 ] shows that problems ( b ) and ( b ) are equivalent .",
    "it immediately follows that problems ( a ) and ( b ) are equivalent .",
    "let @xmath566 to show that @xmath567 let us use the fact that the algebraic certificate in theorem [ thm : density ] is on the desired form .",
    "we have @xmath568 on the other hand , to show that @xmath569 note that by theorem [ thm : density2 ] we have @xmath570 by the matrix condition @xmath532 we know that the sum of the @xmath571 with @xmath572 which do not contribute to an arithmetic progression is zero . furthermore",
    ", if @xmath573 and @xmath574 are the unique integer such that @xmath575 and @xmath576 , then @xmath577s orbit contributes to @xmath321 arithmetic progressions and @xmath578s orbit contributes to @xmath417 arithmetic progressions respectively . in other words",
    "@xmath579 , and hence @xmath580 so @xmath581 to find a lower bound to @xmath582 we should find a lower bound for @xmath583 . since @xmath584 in order for @xmath501 to be positive semidefinite and since @xmath579 we have @xmath585 . hence @xmath586",
    "we can easily generate the list of all necklaces of length @xmath17 with @xmath587 ones using the recursive formula introduced in section [ sec : graycode ] .",
    "we can use the list to find @xmath588 , we merely need to count the number of arithmetic progressions in each necklace and find the minimum among these .",
    "note that @xmath17 does not have to be prime as long as we are cautious when we count arithmetic progressions to avoid double counting and degenerate arithmetic progressions .",
    "we have found exact solutions using fixed density necklaces for @xmath588 for @xmath589 , @xmath590 and @xmath591 . to find the exact solution we used the code for finding fixed density necklaces by sawada @xcite , and code implemented in matlab by the author for counting the number of arithmetic progressions in every necklace .",
    "the code was implemented on the triton computer cluster , which is part of the aalto science - it project , and we used 100 computer nodes for 5 days to carry out the calculations .",
    "the results can be found in tables [ tab : bubble3_1 ] , [ tab : bubble3_2 ] , [ tab : bubble4_1 ] , [ tab : bubble4_2 ] , [ tab : bubble5_1 ] and [ tab : bubble5_2 ] in the appendix .    using the degree 3 relaxation of the lasserre hierarchy we have found lower bounds to @xmath592 where @xmath593 is a prime and @xmath594 for @xmath595 we start to run into numerical problems for larger @xmath81 , which might be because of our particular choice of solver ,",
    "so then we have fewer and perhaps less accurate data points .",
    "the results for @xmath596 seems accurate in this interval , so we feel confident using this data for analysis on the asymptotic behavior of the degree 3 relaxation .      in figure",
    "[ fig : minap1 ] we show the results for @xmath123 and @xmath600 when @xmath601 , for which we have numerical data for all different relaxations we make , as well as a lower bound from theorem [ thm : smallprimes ] . in figure [ fig : minap2 ] we showed a zoomed in version around where @xmath602 becomes positive . for small values of @xmath10 and @xmath3 we can find algebraic solutions to check when the points coincide , unfortunately this is generally not the case for the larger values of @xmath10 and @xmath3 which we are more interested in .",
    "the case @xmath601 is a good representative for the situation for all small primes , and hence the numerical certificates as well as the algebraic certificates one can get from theorem [ thm : density2 ] work very well here .",
    "the problem is that the larger @xmath3 is the worse the relaxations will get .",
    "we discuss this further in section [ sec : discussion ] .",
    "we also provide a list of one necklace per @xmath10 that achieve the lower bound as a certificate in tables [ tab : smallaces1 ] and [ tab : smallaces2 ] .",
    "there is recent research on how to find necklaces with less arithmetic progressions than average for higher @xmath3 @xcite . in both papers",
    "they analyze the problem of avoiding arithmetic progressions in a @xmath417-coloring of @xmath9 $ ] , which is closely related to the fixed - density case , and it is likely that similar constructions are applicable here ."
  ],
  "abstract_text": [
    "<S> additive combinatorics is built around the famous theorem by szemerdi which asserts existence of arithmetic progressions of any length among the integers . there </S>",
    "<S> exist several different proofs of the theorem based on very different techniques . </S>",
    "<S> szemerdi s theorem is an existence statement , whereas the ultimate goal in combinatorics is always to make enumeration statements . in this article </S>",
    "<S> we develop new methods based on real algebraic geometry to obtain several quantitative statements on the number of arithmetic progressions in fixed density sets . </S>",
    "<S> we further discuss the possibility of a generalization of szemerdi s theorem using methods from real algebraic geometry . </S>"
  ]
}