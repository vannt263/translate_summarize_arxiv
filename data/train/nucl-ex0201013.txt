{
  "article_text": [
    "the phenix experiment @xcite at the relativistic heavy ion collider ( rhic ) is designed to measure hadrons , leptons , and photons produced in nucleus - nucleus , proton - nucleus , and proton - proton collisions at beam energies of up to 100 gev / a with the primary goal of detecting the quark - gluon plasma ( qgp ) and characterizing its physical properties .",
    "phenix consists of four spectrometers , or _ arms _",
    "( see fig .",
    "[ phlayout ] ) , including two _ muon arms _ designed primarily for muon identification at forward rapidities , and two _ central arms _ focusing on hadron , electron , and photon identification near mid - rapidity ( see fig .",
    "[ phschem ] ) .",
    "this document describes the software used for pattern recognition , momentum reconstruction , and particle identification for the two central arm spectrometers of the phenix detector , which began taking data in may 2000 until september 2000 , a period which will be referred to here as _",
    "run 2000_.    this document is organized as follows .",
    "section 2 provides a general overview of the detectors in the central arm spectrometers .",
    "sections 3 through 10 discuss the software for each individual detector component .",
    "section 11 explains the momentum reconstruction and track model definition method .",
    "section 12 explains the inter - detector association algorithm .",
    "section 13 explains the technique for particle identification using the time - of - flight detector .",
    "section 14 summarizes what has been discussed .",
    "in order to provide a spectrometer with optimized particle identification capabilities for various particle species , the central arm spectrometers , which each cover @xmath00.35 in pseudorapidity ( @xmath1 ) and span @xmath2 in azimuthal angle ( @xmath3 ) , necessarily contain many components . when there are differences in the two spectrometers , they will be referred to as the _ east _ and _ west _ arms .",
    "the positions of the detectors will be described in a coordinate system with the origin at the center of the central arm magnet with the z - axis along the beam .",
    "this section will briefly describe each component moving outwards radially from the beam pipe .",
    "the innermost detector in each spectrometer is the drift chamber ( dc ) @xcite .",
    "the drift chamber provides the primary vector and momentum measurement for charged particles traversing the spectrometers .",
    "the drift chamber consists of 40 planes of wires arranged in 80 drift cells placed cylindrically symmetric about the beam line .",
    "each drift chamber spans @xmath2 in @xmath3 , has a radial sensitive region from 2.02 to 2.46 meters , and covers -80 @xmath4 z @xmath4 + 80 cm .",
    "the wire planes are placed in an x - u - v configuration in the following order ( moving outward radially ) : 12 x planes ( x1 ) , 4 u planes ( u1 ) , 4 v planes ( v1 ) , 12 x planes ( x2 ) , 4 u planes ( u2 ) , and 4 v planes ( v2 ) .",
    "the u and v planes are tilted by a small @xmath5 stereo angle to allow for full three - dimensional track reconstruction .",
    "the field wire design is such that the electron drift to each sense wire is only from one side , thus removing most left - right ambiguities everywhere except within 2 mm of the sense wire .",
    "the wires are divided electrically in the middle at @xmath6 .",
    "the occupancy for a central rhic au+au collision is about two hits per wire .",
    "the magnetic field bends particles in the x - y plane .",
    "generally , the drift chamber active volume lies outside of the axial magnetic field , however there is a residual field within the volume that provides less than @xmath7 of deflection in the bend plane .",
    "there is no bending , to first order , in the non - bend plane , except for tracks very close to the magnet pole edges or at low momentum @xcite .",
    "the deflection of the tracks is sufficiently low that the track model assumption can be straight line trajectories in both planes .",
    "attached to the back of the drift chamber , at an inner inscribed radius of 248 cm , is a single layer of pad chamber called pc1 .",
    "this is a pixel - based detector @xcite with effective readout sizes of 8.45 mm in @xmath8 by 8.40 mm in the @xmath9 plane , providing three - dimensional space - point information for charged particles in the spectrometer .",
    "behind pc1 is a cylindrically shaped ring imaging cherenkov detector ( rich ) @xcite .",
    "the rich is the primary detector for electron identification in phenix .",
    "it is a threshold cherenkov detector with a high angular segmentation to cope with the high particle density expected in the most violent collisions at rhic .",
    "there are two identical rich detectors , one in each phenix arm .",
    "each rich detector consists of a gas vessel , thin reflection mirrors , and photon detectors made up of arrays of photo - multiplier tubes ( pmt s ) . during run 2000 , _",
    "@xmath10 _ was used as the cherenkov radiator .",
    "pions below 4.9 gev / c do not produce a signal in the rich , while electrons above 18 mev / c emit cherenkov light in the gas radiator .",
    "the cherenkov photons are reflected by the mirrors in the rich , and are focused onto the photon detectors .",
    "a charged particle track is identified as an electron when a sufficient number of rich pmt hits are associated with it .    on the west arm only , a second pixel pad chamber , named pc2 ,",
    "is located behind the rich at an inner inscribed radius of 419 cm .",
    "this detector was not installed for run 2000 .",
    "pc2 has an effective readout size of 14.25 mm in @xmath8 by 13.553 mm in the @xmath9 plane .    on the east arm only , a time expansion chamber ( tec ) @xcite",
    "is placed behind the rich with a radial active area from 4.1 to 5.0 meters .",
    "one of the four installed tec detector planes were instrumented for run 2000 providing azimuthal coverage of @xmath3 = @xmath11 .",
    "the tec contains four planes of wire readout ( expandable to six planes in the future ) .",
    "the wires are divided electrically at their center at z=0 .",
    "the readout electronics consist of a 5-bit non - linear flash adc .",
    "the tec provides 2-dimensional tracking in the x - y plane , contributes to electron - pion discrimination via de / dx measurements , and provides high momentum resolution for high @xmath12 particles .",
    "the tec is located outside of the axial magnetic field , so a straight line track model assumption is valid for tec track reconstruction .    placed at an inner inscribed radius of 490 cm on each arm is a third layer of pixel pad chamber , called pc3 , with an effective readout size of 16.7 mm in @xmath8 by 16.0 mm in the @xmath9 plane .",
    "only the east arm of pc3 was installed for run 2000 .",
    "located on the east arm only is the time - of - flight detector ( tof ) placed at an inner inscribed radius of 510 cm ( between pc3 and the calorimeter ) and spanning @xmath13 in @xmath3 .",
    "the tof detector , shown mounted on the east arm in fig .",
    "[ tofpic ] , serves as the primary particle identification device for charged hadrons in phenix .",
    "the tof wall is finely segmented in order to cope with the expected highest multiplicity events in central au + au collisions , which is about 1000 charged particles per unit rapidity .",
    "one tof panel contains 96 plastic scintillation counters ( bicron bc404 ) with photomultiplier tubes ( hamamatsu r3478s ) at both ends of the slat .",
    "a total of 10 tof panels , 960 slats , and 1920 channels of pmt s were installed for run 2000 .",
    "each slat is oriented along the @xmath14-@xmath3 direction and provides timing as well as longitudinal position information of particles that hit the slat .",
    "on the east arm only , placed behind the tof detector , are two planar arrays of lead - glass calorimeters ( pbgl ) imported from the cern sps experiment wa98 @xcite , as were the tof detectors .",
    "behind pc3 on the remainder of the east arm lie two planar arrays of lead - scintillator calorimeters ( pbsc ) @xcite",
    ". both of these arrays span @xmath11 in @xmath3 on the east arm .",
    "covering the full @xmath2 in @xmath3 on the west arm , and placed behind pc3 , are four pbsc arrays .",
    "the calorimeters , collectively referred to as emc , provide photon identification information , particle energy , and time - of - flight measurements .",
    "trigger , timing , and collision centrality information is provided by a set of detectors including a beam - beam counter ( bbc ) @xcite , a pair of zero - degree calorimeters ( zdc ) @xcite , and a multiplicity vertex detector ( mvd ) @xcite .",
    "the bbc consists of two identical sets of counters installed on both sides of the interaction point along the beam .",
    "each counter is composed of 64 pmt s equipped with a quartz cherenkov radiator and covers the 3.0 @xmath15 3.9 region with full azimuthal coverage .",
    "the zdc s are small transverse area hadron calorimeters which measure the energy of unbound neutrons in small forward cones ( @xmath16 @xmath4 2 mr ) around each beam axis .",
    "one zdc is located on either side of the interaction region and consists of 3 modules , each with a depth of 2 hadronic interaction lengths and read out by a single pmt .",
    "both time and amplitude are digitized for each of the 3 pmt s as well as an analog sum of the pmt s for each zdc .",
    "the mvd is a highly segmented silicon strip and pad detector .",
    "it is designed to measure and trigger on the number of charged particles , as well as to measure the collision vertex with high accuracy .",
    "the detector has a large pseudorapidity coverage ( approximately -2.64 @xmath15 2.64 ) and full azimuthal coverage , making it possible to study charged particle production as a function of @xmath17 and @xmath18 on an event - by - event basis .",
    "the detector is composed of two parts : two concentric barrels , or shells , spanning -32 @xmath19 32 cm , and two endcaps at z=@xmath035 cm .",
    "each barrel shell consists of six rows of detectors , where each row is formed by 12 panels of silicon strip detectors with a 200 @xmath20 pitch .",
    "the disk - shaped endcap sections are each composed of six silicon pad wafers each segmented into 252 pads . when fully instrumented , about 35,000 channels will be read out from the mvd .",
    "the beam - beam counters ( bbc ) and zero degree calorimeters ( zdc ) are designed to define the start timing of the nuclear interaction for time - of - flight measurements , to provide the trigger signal of the nuclear interaction , and to provide a coarse measurement of the collision vertex along the beam axis .",
    "the following equations are used to calculate the start timing ( @xmath21 ) and the vertex position along the beam axis ( @xmath22 ) for both detectors : @xmath23 and @xmath24 , where @xmath25 and @xmath26 are the average hit timing for each set of bbc counters , and @xmath27 is the velocity of light .",
    "the average hit timing in each bbc set is defined by taking a truncated average of the timing over the pmt s that have a hit ( defined as a pmt with a valid timing signal ) out of the 64 possible pmt s . in the case that there is no peak structure in the hit timing distribution in either bbc set due to low particle multiplicity , the arrival times of the first leading particle from the beam collisions are used as the hit timing value .",
    "the zdc pulse height is converted to hadronic energy equivalent using peripheral interactions with low neutron multiplicity in the zdc where single- and double - neutron peaks are clearly seen .",
    "the fitted single - neutron peak position is equivalent to 65 agev per beam for run 2000 .",
    "this fit procedure was performed using an _ analog sum _",
    "channel since pedestal offset corrections are reduced in this channel .",
    "the offset arises because the analog - to - digital converters used for the bbc and zdc are self - gating , so a minimum signal must be present to start the digitization .    the time - of - flight to the zdc",
    "was calculated using the pmt digitized times after correcting for pulse height slewing via a look - up table .",
    "the typical signal rise - time is 2 nsec .",
    "the time digitizer least - count scale was calibrated with standard delay cables .",
    "the resulting time measurements are used to calculate @xmath21 and @xmath22 as outlined above using a c++ class whose data members are stored for each event for both the bbc and zdc .",
    "[ zvertex ] plots the difference between the measured zdc and bbc vertex positions as a function of the bbc vertex position .",
    "the resolution in the difference is 2.0 cm , which is dominated by the contribution from the zdc time resolution .",
    "the multiplicity vertex detector ( mvd ) is designed to measure and trigger on the number of charged particles produced in high multiplicity events in au+au collisions and to measure the collision vertex with high accuracy .",
    "vertex finding is performed by the mvd barrel section where the hit information from the two shells of detectors can be combined and projected onto the z - axis .",
    "multiplicity measurements are performed by both the barrel and pad sections . for a vertex at the center of the mvd ( @xmath6 ) ,",
    "the inner shell covers the range -2.55 @xmath28 2.55 and the si pad detectors cover the range 1.79 @xmath29 2.64 at each end of the detector . both the inner shell and the pads have complete azimuthal coverage",
    ".    the mvd event processing , written in c++ , is handled by an mvd event reconstruction object , which is created and evaluated for each event by the main mvd reconstruction module .",
    "the event reconstruction object contains data members holding the hit information for each event and the final vertex and @xmath30 results .",
    "the content of these data members are evaluated by a call to the internal event processing method .",
    "strips , pads , hit clusters , and the vertex are treated as individual objects for the given event .",
    "the content of the cluster objects are generated from the strip objects .",
    "strip , pad , and cluster objects are accessed by a vertex object class which holds the methods containing the main reconstruction algorithms .",
    "two different algorithms are used to find the vertex position .",
    "the first algorithm is denoted the _ pseudo - tracking _ method .",
    "this vertex algorithm takes each pair of clusters ( where a cluster is a group of adjacent channels in the same row , shell , and panel of the mvd which all have signals above a threshold ) in the inner and outer shells and treats every combination in the same row of the mvd barrel as a potential track .",
    "this combination of track candidates is projected back to the beam axis to determine the vertex expected for a track which hit these two locations .",
    "for each of these possible vertex locations , a channel in a histogram is incremented .",
    "most pairs of hits do not correspond to a real track .",
    "however , when all pairs are considered , the true vertex location appears more frequently than the other locations .",
    "a clear peak appears in the histogram corresponding to the vertex position , as shown in fig .",
    "[ mvdpseudo ] from simulated central au+au events using the hijing event generator @xcite .",
    "when this algorithm finds the correct vertex location , it is correct within a standard deviation , @xmath31 , of about 190 @xmath32 m for simulated central events and 224 @xmath32 m for simulated minimum bias events . at high occupancy ( around 45% in the inner shell ) this method becomes more inefficient ( less than 98% ) and a different approach must be used .",
    "the alternative vertex algorithm , used for high multiplicity events , is the _ correlation method_. unlike the pseudo - tracking method , the correlation method makes use of the adc information from the individual channels .",
    "the algorithm is based upon the assumption that the pattern of energy loss per channel in the inner and outer shells of the mvd are similar .",
    "the pattern of adc values in the outer shell of the mvd is scaled down by the ratio of the inner - to - outer shell radius and stored in an array .",
    "the scaled pattern yields an offset proportional to the vertex location when compared to the unscaled inner shell pattern . by finding the value of the offset which makes the two patterns most similar , the vertex position is found . a histogram which plots the difference between the pattern of hits in the inner and outer shells will show a sharp minimum which corresponds to the location of the vertex , as shown in fig .",
    "[ mvdcorr ] from central hijing au+au events .",
    "this method gives the correct vertex with a standard deviation of 233 @xmath32 m for simulated central events and 250 @xmath32 m for simulated minimum bias events with an efficiency greater than 99% for inner shell occupancies above 5% .",
    "the algorithms for calculating @xmath30 are different in the mvd barrel section and endcap sections . in the mvd barrel ,",
    "only the inner shell is used . in central au+au collisions ,",
    "the occupancy in the inner shell is high @xcite , therefore the algorithm makes no attempt to find individual hits . instead",
    ", the barrel is divided into groups of 64 adjacent strips which are in the same row ( azimuthal segment ) . for each of these groups of channels ,",
    "a @xmath30 value is calculated as follows : the total adc value for all channels in this group is added up , the range of pseudorapidity ( @xmath33 ) is calculated , the pseudorapidity at the center of the group of strips is calculated , a geometric correction ( for non - normal incidence ) is applied , the number of particles is estimated by dividing the corrected adc signal by the adc signal expected for a minimum ionizing particle ( _ mip _ ) , and finally @xmath30 is estimated as the number of particles divided by @xmath33 .",
    "the average @xmath30 for a set of events is calculated by taking the average in each bin of @xmath17 .    in order to calculate @xmath30 from the mvd pads",
    ", the algorithm assumes that a single particle hits only one pad .",
    "the occupancy of the pad detectors is around 15 - 20% for central events .",
    "the algorithm estimates the number of particles associated with the observed adc value in an individual pad using an adc distribution which is taken from the distribution corresponding to the adc response expected for a single particle at normal incident angle in low multiplicity events , and the occupancy of the pad detector .",
    "the algorithm does not associate an integer number of particles with each hit .",
    "instead a mean number of particles which would be associated with a given adc channel is calculated .",
    "this number can then be converted into a @xmath30 value using the vertex location and the pad geometry .",
    "a new pad geometry for cathode readout of mwpc s was designed for the phenix pad chambers  @xcite .",
    "the basic component in this geometry is a pad consisting of nine smaller connected copper electrodes , called pixels ( fig .",
    "[ padschem ] ) .",
    "the pad is read out by a single preamplifier and discriminator .",
    "the pads are interleaved in a repeated pattern .",
    "the area defined by three adjacent pixels belonging to three different pads is called a cell .",
    "this arrangement saves a factor of three in the number of readout channels with marginal loss of performance .",
    "pad chamber information , which is stored in the phenix objectivity database , can be separated into three different groups : geometry , high voltage and electronics .",
    "all groups are accessed via object - oriented classes in the offline analysis , using time stamps as the primary key .",
    "the geometry group holds information on the geometry parameters of the chambers themselves , e.g. wire - spacing , as well as survey information , while the high voltage group keeps track of when trips have occurred .",
    "the electronics group contains threshold and gain calibrations , as well as information on where hot or inactive channels are located .",
    "[ padfired ]    the list of fired pads from an event is read by the hit reconstruction algorithm , which first translates it into a list of fired cells .",
    "the limit on the number of allowed inactive or hot pads in a cell is an input parameter whose default value is one , i.e. at least two out of three pixels in a cell have to be part of alive channels .",
    "from the cell list , cluster objects are built for each chamber by identifying all neighboring cells .",
    "the size of each cluster is checked against a pre - defined table to estimate the number of traversing particles that created the cluster .",
    "the default settings of this table were determined from simulations  @xcite . if the number of particles in a cluster is considered to be greater than one , the cluster will be recursively split depending on its shape until only one - particle clusters remain .",
    "once a cluster created by a single particle has been extracted , the average hit position is calculated by averaging over the coordinates of the cells in the cluster .",
    "the entire procedure is repeated until the list of fired cells is empty .",
    "[ padres ]    in order to determine the reconstruction efficiency , a pad chamber response simulator , which simulates which pads fired in an event , is utilized .",
    "given the coordinates of a particle entering and exiting the pad chamber , the location of the avalanche along the closest wire is calculated .",
    "the particle may also give rise to additional avalanches on neighbouring wires .",
    "the total avalanche charge is obtained from a landau distribution .",
    "the induced charge distribution on the pad cathode plane is then calculated from an empirical formula  @xcite . finally , when all particles of the event are processed , noise charge drawn from a normal distribution is added to each pad in the chamber .",
    "if the total collected charge on a pad exceeds the threshold value , the pad is registered as fired .",
    "the thresholds used in the simulation were set to match the cluster sizes ( fig .",
    "[ padfired ] ) and the very high efficiency of the real chambers .",
    "[ pad2track ]    .[table1]pad chamber position and two - track resolutions . [ cols=\"<,<,<,<\",options=\"header \" , ]     the position resolutions , presented in table  [ table1 ] ,",
    "are determined by comparing the reconstructed hit positions with the positions where the original geant  @xcite particles passed through the chambers .",
    "the position resolutions for pc1 are shown in fig .",
    "[ padres ] . by simulating minimum ionizing particle pairs with small separation between them , the probability for resolving the nearby tracks was calculated .",
    "shown in fig .",
    "[ pad2track ] is the two - track resolution along and perpendicular to the wires for the pc1 chamber .",
    "the resolution is defined as the distance where 50% of the tracks are separated by the reconstruction .",
    "the system can be optimized for two - track resolution at the expense of an increased number of ghost hits ( due to falsely split clusters ) or loss of single track efficiency by operating at lower sensitivity ( leading to reduced cluster sizes ) .",
    "the study presented here results in a negligible number of ghosts .",
    "while the detection efficiency as measured with cosmic rays is greater than 99.5% , the reconstruction efficiency is slightly lower as determined by projecting reconstructed drift chamber tracks from minimum bias data into pc1 .",
    "this results in a reconstruction efficiency calculated to be better than 98% , as expected from the pad chamber simulation .",
    "track reconstruction within the drift chamber is performed using a _ combinatorial hough transform _ ( cht ) technique @xcite . in this technique , the drift chamber hits are mapped pair - wise into a feature space defined by the polar angle at the intersection of the track with a reference radius near the mid - point of the drift chamber , @xmath3 , and the inclination of the track at that point , @xmath34 . the @xmath34 variable is proportional to the inverse of the transverse momentum , thus facilitating limited searches for specific momentum ranges and providing an initial guess for the momentum reconstruction procedure .",
    "[ dchough ] provides a schematic illustration of these variables .",
    "this coordinate mapping results in a gain effect that greatly enhances the peak - to - background ratio in the feature space .",
    "n _ is the number of points on the track , the nominal peak height is @xmath35 . in order to minimize computation time ,",
    "@xmath34 and @xmath3 were only calculated for hit pairs separated in azimuthal angle by physically reasonable amounts corresponding to @xmath12 = 150 mev / c , comparable to the natural resolution of the spectrometer . fig .",
    "[ dcmethod ] shows an example of a region of the drift chamber hits and the associated feature space from a simulated hijing central rhic au+au collision . in order to reconstruct tracks in regions where",
    "some wires have been removed for internal supports , the algorithm first looks for tracks that traverse both the x1 and x2 wire regions , then it looks for the remaining tracks that traverse the x1 or x2 regions only .    after reconstructing a track in the magnetic field bend plane",
    ", the direction of the track is specified by @xmath3 and @xmath34 .",
    "track reconstruction in the non - bend plane is first attempted by integrating information from pc1 reconstructed clusters , which contain @xmath8 information with a resolution of 1.89 mm .",
    "a straight line projection of the bend - plane track is made to the pc1 detector and a road is defined about that projection .",
    "if there is an unambiguous pc1 association , the non - bend vector is defined by the pc1 cluster and the @xmath8-coordinate of the event vertex .",
    "this assumption is not valid for secondary tracks , but those cases are later examined during momentum reconstruction .",
    "if there is no pc1 cluster association , or if there are multiple pc1 association solutions , the non - bend vector is determined from the stereo wires . for this procedure , a plane , called the x - plane ,",
    "is defined by @xmath3 and @xmath34 , but extending in @xmath8 .",
    "the path of the track trajectory through the x - plane is a straight line and is determined by including the information measured by the stereo wires . to do this ,",
    "all drift chamber hits are defined as lines in physical space parallel to the anode wire and perpendicular to the drift direction .",
    "all stereo wire hit lines are intersected with the x - plane with the intersections belonging to the track defining a line in the x - plane .",
    "again , a hough transform is used to extract these intersections by using the @xmath8 coordinate at which the track crosses the reference radius , @xmath36 , and the polar angle at that point , @xmath3 . since the x - plane is defined by a single track , a unique solution in this space",
    "is extracted .",
    "the method of determining the drift chamber track reconstruction efficiency will be discussed in more detail in section 12 . using this method , the drift chamber tracking efficiency as a function of transverse momentum",
    "is shown in fig .",
    "[ dceff ] with less than 1% spurious ( ghost ) tracks .",
    "the resulting spatial resolution of the tracks is comparable to the single - hit resolution of the detector .",
    "track reconstruction in the time expansion chamber ( tec ) is performed using a combinatorial hough transform method using the identical variables , @xmath34 and @xmath3 , and with an identical method for track reconstruction in the magnetic field bend plane as the drift chamber track reconstruction .",
    "a detailed simulation of the tec detector response is used to determine the tec tracking efficiency .",
    "this simulation calculates the average number of primary ion collisions for each track section that traverses a single drift cell @xcite .",
    "fluctuations of the number of primary collisions are modelled by poisson statistics @xcite .",
    "secondary ionization is calculated by generating a spectrum of @xmath37 electrons @xcite .",
    "the total number of primary and secondary ion pairs are calculated and the distance of the electron cluster to the wire , along with the drift time , are calculated assuming a straight line drift .",
    "gas gain fluctuations are simulated using a _ polya _",
    "distribution @xcite .",
    "after the addition of noise , and the addition of the electronics shaping time response , the charge collected on the wire as a function of time bin is calculated .",
    "the charge is finally converted into fadc channels for each track .",
    "the final fadc contents are obtained by summing the contributions from all charged tracks in the event .",
    "the track reconstruction efficiency is determined by embedding individual simulated tracks processed through the response simulation into a real data event , reconstructing the resulting _ merged _ event and determining how many of the embedded tracks are correctly reconstructed .",
    "the reconstruction efficiency is shown as a function of the charged track multiplicity in the tec in the left panel of fig .",
    "[ tecperform ] .",
    "the spatial resolution of reconstructed tracks in the tec , shown in the right panel of fig .",
    "[ tecperform ] , is determined directly from data taken in run 2000 by comparing the residuals of tracks reconstructed independently in alternating planes of the tec and fitting them to a gaussian curve .",
    "the resulting resolution , also confirmed within the simulation procedure , is determined to be 380 @xmath32 m .",
    "[ tecperform ]",
    "pattern recognition in both the pbsc and pbgl electromagnetic calorimeters ( emc ) includes single electromagnetic shower identification including calculation of the shower position , energy , time - of - flight , overlapping shower separation , and hadronic shower rejection .",
    "the technique is based upon matching energy- and impact - angle - dependent descriptions of the projected electromagnetic shower shape as measured in a test beam of electrons in the momentum range 0.3 - 5.0 gev / c @xcite and reproduced in a detailed geant simulation of the detector response .",
    "an illustration of the shape of a shower is shown in fig .",
    "[ emcshower ] for a particle impact orthogonal to , and at a @xmath38 impact angle to , the calorimeter surface .",
    "impact angle.,width=453 ]    the shower reconstruction algorithm includes two steps .",
    "first , a cluster search is performed .",
    "the cluster is defined as a contiguous group of calorimeter towers with measured energies above a certain threshold . at this point , the clusters are considered to be totally independent .",
    "second , the clusters are split into subclusters associated with local maxima .",
    "a local maximum is defined as a tower which has a deposited energy in excess of the energies measured in any of the 8 surrounding towers .",
    "a subcluster ( peak region ) is formed from the towers of the cluster sharing the energy in each tower among photons located in each peak region . here ,",
    "an iterative procedure based on a parameterized shower profile is used @xcite .",
    "each subcluster is assigned a @xmath39 value for shower identification purposes .",
    "the simplest algorithm for determining the particle position in a cellular calorimeter is to measure the center - of - gravity of the shower , @xmath40 : @xmath41 where @xmath42 is the @xmath43-coordinate of the center of tower @xmath44 , and @xmath45 is the energy deposited in the tower . for electron and photon position reconstruction , a parametrization of the shower center - of - gravity in units of tower width is applied @xcite :",
    "@xmath46 is the particle impact point , @xmath47 is the shower cross - sectional width , @xmath48 is the mean displacement of the calculated shower center - of - gravity from the impact point @xmath49 , and @xmath50 is a phase shift related to the skewed shape of the shower projection .",
    "all of these parameters ( @xmath47 , @xmath48 , and @xmath50 ) are parameterized as a function of the incident particle energy , @xmath51 , and angle of incidence , @xmath52 .",
    "@xmath48 is given by @xmath53 where @xmath54 is the effective depth of the shower penetration in the calorimeter as determined by the position of the cascade - curve median in the longitudinal direction ( @xmath55 ) @xcite .",
    "the value of @xmath47 is given by @xmath56 where @xmath57 is a constant and @xmath58 .",
    "@xmath50 is found to be essentially energy - independent and can be parameterized as a function of the impact angle only . finally , the position of the particle impact on the calorimeter surface , @xmath49 , is calculated according to the formula obtained by inverting equation ( [ eq : emc.pos.cg1 ] ) : @xmath59-\\delta+\\delta , \\label{eq : emc.ximp}\\ ] ] @xmath60 the calorimeter position resolution is well described by @xcite : @xmath61 where @xmath62 is the position resolution for an orthogonal incidence .",
    "the second term in this parametrization describes the contribution of the longitudinal shower fluctuations on the projection to the calorimeter surface .",
    "the value of @xmath63 is @xmath64 , where @xmath65 is the radiation length in the calorimeter module . using the electron test beam , a position resolution of @xmath66 was achieved .    a number of factors are taken into account when reconstructing the photon and electron energy in the calorimeters : the longitudinal energy leakage , the light attenuation in the calorimeter module , the response dependence on the particle impact position , and the shower overlaps in the high multiplicity environment , some of which will be discussed here .",
    "the nonlinearity of photon and electron energy measurements in the calorimeters is primarily connected with light attenuation in a calorimeter module .",
    "this is well described by the expression @xmath67 , where @xmath68 is the energy measured in the calorimeter , and @xmath51 is the actual photon or electron energy in gev .    in a high multiplicity environment",
    ", shower overlaps can seriously affect the electromagnetic shower energy measurements , thus degrading the energy resolution and inducing systematic shifts in the measurement . for a tower energy threshold of 3 mev , the mean cluster size in the pbsc calorimeter initiated by a 0.5 gev",
    "( 4 gev ) photon is 7 ( 19 ) towers .",
    "the larger the cluster size , the higher the probability for an overlap .",
    "however , the shower size can be reduced to 4 - 5 towers in the shower core .",
    "towers belonging to the shower core are defined using a parameterized shower profile : @xmath69 where @xmath14 is the contribution of the tower to the total shower energy @xmath51 , and @xmath70 is the predicted energy deposited in the tower .",
    "the @xmath71 parameter is chosen in order to have as few towers in a cluster as possible while keeping the energy resolution on the same level .",
    "the shower core defined in this manner contains about @xmath72 of the total shower energy , dropping to @xmath73 for a @xmath38 impact angle .",
    "using the shower core for energy measurements introduces an additional constant term of about @xmath74 in the energy resolution , which slightly worsens the energy measurements of isolated photons and electrons , but helps to considerably improve the energy measurements in the high multiplicity environment , where an energy resolution for the pbsc calorimeter of @xmath75 was achieved in electron test beams at the bnl ags and the cern sps @xcite .",
    "the time - of - flight ( tof ) information provided by the calorimeters ( using the bbc as the start counter ) is a useful tool for particle identification .",
    "this helps by enhancing the @xmath76 separation at low momenta ( @xmath77 gev / c ) , where the energy - to - momentum comparison , as well as the shower profile analysis , lose effectiveness for @xmath76 discrimination .",
    "in addition , this is the primary tool for identifying neutral hadrons , which are a major source of background in the photon spectrum in the energy region of approximately 1 to 3 gev .",
    "also , the magnet poles and structural elements of the detectors in front of the calorimeter are sources of non - vertex photons , part of which ( @xmath78% ) can be rejected using the tof information . finally , in the case of high multiplicity events , requiring consistency of the tof values measured in the different towers within the same cluster can help to identify accidental shower overlaps .",
    "several corrections are applied to measure the tof , including slewing corrections and flight path corrections based upon the collision vertex , after which a resolution of better than 700 psec for the pbsc calorimeter was achieved .",
    "electron identification using the ring imaging cherenkov detector ( rich ) is performed with two c++ classes .",
    "the first class handles the geometry of the rich detector by modelling the position , shape , and orientation of the 96 mirror panels and the position of the 5120 pmt s in the rich detector .",
    "this class also handles all optical tracing calculations .",
    "the second class uses the geometry class and performs the electron identification .",
    "the electron identification class accepts a previously reconstructed track and searches for rich pmt s that can be associated with the track .",
    "this is done by first reflecting the track about the rich mirror as if it were a light ray , and then projecting the reflected track onto the rich pmt array .",
    "if the track is an electron , the reflected ray should be projected to the center of a ring formed by hit pmt s .",
    "the number of hit pmt s within a tight association radius from the projected track is counted and the number of photo - electrons measured in the pmt s in the association radius is summed .",
    "in addition , a quality factor based upon the position of the associated hits and the position of the projected track is calculated .",
    "all of these quantities are then used to separate electron tracks from the hadron background .",
    "the middle histogram is the one with the rich hits .",
    "the lowest histogram is the distribution of a random background estimated from the data .",
    "the crosses are the difference of the middle and the lowest , resulting in the net electron signal .",
    "the electron signal below @xmath79 are caused by electrons from photon conversions far from the beam pipe.,width=415 ]    the gain of the rich pmt s is determined from the pulse height of the single photo - electron peak in the data .",
    "the geometry of the mirror system and the optics are calibrated from the data using zero magnetic field runs . in these runs , charged particle tracks are reconstructed as a straight line connecting the event vertex ( determined by the bbc ) , the pc1 hit position , and the pc3 ( or emcal ) hit positions .",
    "the orientation of the mirror panels in the geometry class are then adjusted so that the projection point of the track reflected by the mirrors points to the center of the cherenkov rings recorded in the pmt array .",
    "[ crkring ] shows the distribution of the hit pmt s around the projected ray after the geometry calibration .",
    "the hadron rejection factor provided by the rich strongly depends upon the multiplicity of the event . from data taken with a test beam with a small proto - type of the rich detector",
    ", it was shown that the rich detector can provide a pion rejection factor better than @xmath80 with an electron efficiency close to 100% . however , in high multiplicity events , the electron - pion separation is reduced since a hadron track can be associated with a rich hit produced by background electron tracks , resulting in a track that is mis - identified as an electron .",
    "the pion rejection factor in most central au+au collisions was determined to be on the order of several hundred with an electron efficiency of @xmath81 .",
    "[ crkelectron ] illustrates electron identification using the rich detector . in this figure ,",
    "the ratio of the energy ( measured by the calorimeters ) and the momentum of the charged tracks in the @xmath12 range @xmath82 gev / c are plotted .",
    "for all charged tracks , the @xmath83 ratio has a _ mip _ peak at @xmath84 on a broad distribution caused by hadronic interactions .",
    "when rich hits are required , a clear peak appears at @xmath85 , which is the electron signal .",
    "the background due to random associations of the rich and the track is estimated , and also shown in fig .",
    "[ crkelectron ] .",
    "gev / c for positively charged pions .",
    "an overall time - of - flight resolution of 115 ps is achieved.,width=529 ]    prior to the application of the time - of - flight detector ( tof ) for particle identification , the flight time of a particle impacting the tof is determined by taking the average of the measured stop time values at both ends of the hit pmt after subtraction of the start timing provided by the bbc .",
    "the pulse height information from the pmt s is used to reconstruct the hit position by calculating the center - of - gravity of the pulse heights from each end of the slat after applying timing calibrations , gain calibrations , geometrical alignment corrections , and pulse - height - dependent timing , or _ slewing effect _ , corrections .    for tof event reconstruction ,",
    "four distinct c++ classes are used .",
    "the first class defines an address object , which provides the mapping between the actual read - out channel number of the front end electronics module ( fem ) and a sequential slat identification number .",
    "the second class defines a geometry object , which handles the conversion from the slat identification number to the geometrical hit position of the particle within the phenix coordinate system .",
    "the third class defines a calibration object , which deals with all of the calibration parameters used for event reconstruction for the tof system , such as the slat - by - slat timing offset , the position offset , and the pmt gain .",
    "finally , the address , geometry , and calibration objects are accessed within a tof reconstruction object within which the energy loss in the scintillators and the hit positions are reconstructed .    during run 2000 ,",
    "the tof detector timing offset was calibrated on a slat - by - slat basis using reconstructed track information .",
    "an overall time - of - flight resolution of @xmath86110 - 120 ps is achieved by selecting pions at high momentum and comparing their time - of - flight to that expected from a @xmath87 particle with a linear trajectory originating at the event vertex , as shown in fig .",
    "[ tofres ] after corrections for the slewing effect and timing drift during the run .",
    "the method of particle identification using the tof detector will be discussed in section 13 .",
    "due to the complicated , non - uniform shape of the focusing magnetic field along the flight path of charged particles traversing the phenix central arm spectrometers , an analytic solution for the momentum of the particles can not be determined .",
    "therefore , other approaches such as look - up tables , must be used @xcite . for run 2000 , a four - dimensional field - integral grid was constructed for momentum reconstruction using the drift chamber and for track model definition within the entire radial extent of the central arms .",
    "the variables in the field - integral grid are the @xmath8 coordinate of the event vertex ; the polar angle , @xmath88 , of the particle at the vertex ; the total momentum of the particle , @xmath89 ; and the radius , @xmath14 , at which the field - integral @xmath90 is calculated .",
    "the field - integral grid is generated by explicitly swimming particles through the measured magnetic field map and numerically integrating to obtain @xmath90 for each grid point .",
    "an iterative procedure is used to reconstruct the momentum of a reconstructed track , utilizing the fact that @xmath90 varies linearly with the @xmath18 angle of the track at a given radius .",
    "this can be expressed as @xmath91 .",
    "each track is assumed to be a primary track originating from the event vertex as determined by the bbc .",
    "an initial estimate of the track momentum and charge is made from the reconstructed bend angle , @xmath92 , of the track in the drift chamber .",
    "the measured polar angle , @xmath52 , of the track in the non - bend plane at the drift chamber reference radius is used as an initial estimate of @xmath88 .",
    "then , using the radial position of each reconstructed hit associated to the track , a four - dimensional polynomial interpolation of the field - integral grid is performed to extract a value of @xmath90 for the drift chamber hit . once this is done for all hits , a robust fit in @xmath18 and @xmath90",
    "is performed to extract the quantities @xmath93 and @xmath94/@xmath89 for the track .",
    "the extracted values are then fed back into the above equation .",
    "the initial polar angle , @xmath95 , is also determined using an iterative procedure using the equation @xmath96 where @xmath50 is the bend angle of the particle trajectory relative to the straight - line trajectory of an infinite - momentum particle .",
    "typically , less than four iterations are necessary for convergence on these quantities .",
    "this procedure has an additional advantage in that it can be used to define the shape of the track within the central arm magnetic field , which can be then be used to determine the track intersections with each detector in order to facilitate inter - detector hit association as described in the next section .",
    "this is done by storing the coordinates of the particle in radial steps as additional entries ( but not keys ) in the field - integral grid .",
    "line segments connecting the interpolated grid coordinates for a track are intersected with the geometry objects describing the position of each detector in order to estimate the projection of the track on each detector .",
    "these projections are used as a seed for inter - detector hit association .",
    "finally , the length of the interpolated line segments from the event vertex to a given detector can be summed in order to provide an estimate of the flight distance of the particle to that detector .",
    "this quantity is used to facilitate particle identification using the tof .",
    "the momentum reconstruction resolution is determined by generating simulated muons ( which will not decay as they traverse the spectrometer ) with momentum @xmath97 and event vertices ranging from @xmath98 cm .",
    "a complete geant and detailed detector response simulation on each track is performed to obtain the detector hits as they would appear in the data , after which the reconstruction is run in the same manner as for data , producing a reconstructed momentum , @xmath99 .",
    "the quantity @xmath100 ( in percent ) is shown in fig .  [ momres ] .",
    "multiple scattering dominates the resolution at low momenta , while detector resolution determines the resolution at higher momenta .",
    "in addition , the momentum resolution is not multiplicity - dependent , as observed by generating the same plot using central au+au hijing events .",
    "this section will address the methods and algorithms used for inter - detector association .",
    "the general object - oriented flowchart used for inter - detector , or _ global _",
    ", reconstruction is shown in fig .",
    "[ ooflow ] .",
    "all stages of the event reconstruction query the geometry information for the spectrometer , which is stored as _ detector geometry objects_. geometry interactions ( intersections , transformations , etc . )",
    "are handled either within a specific geometry object type , or within a c++ singleton class called the _",
    "geometron_. the output of detector - specific reconstruction are stored in objects containing the hit and track information , which are stored in the data summary tapes ( dst ) created after each reconstruction pass .",
    "the anchor of inter - detector hit association is the track model object , which is discussed further below .",
    "once a track model object is created , its methods are used to perform hit association in addition to momentum reconstruction with the assumption that the particle is a pion .",
    "the resulting association and kinematics information is stored in distinct objects ( and in the dsts ) , which are then fed into the particle identification procedures . for particles that have a probability to not be a pion ,",
    "the momentum can be subsequently reconstructed using the updated particle assumption , as its momentum will differ from that of the pion due to energy loss as it traverses the spectrometer .",
    "the track model object is implemented in a flexible manner through a base class named _ phtrack _ , which defines the basic functionality that must be provided by a generic phenix track model class .",
    "the momentum reconstruction algorithm previously described is implemented as a class that inherits from the _ phtrack _ class .",
    "the most important application of the track model is to determine its intersection with the various detectors in order to perform inter - detector track and hit associations .",
    "thus , the data members of the _ phtrack _ base class include a list of projection points , vectors , and errors at each detector .",
    "also included is a list of three - dimensional coordinates approximating the shape of the track for use in event displays .",
    "it is up to the individual track models that inherit from _ phtrack _ to provide the methods for the construction and projections of a track prior to associating hits to the track .",
    "the basis for the construction of a track model object is typically , but not restricted to , a drift chamber track . during run 2000",
    ", two distinct track models were utilized .",
    "the first was an analytical linear track model used for data taken with the magnetic field turned off , and the second was the one used for momentum reconstruction .",
    "the inter - detector hit association algorithm operates on each _ phtrack _ object within an event individually .",
    "additional inputs for hit association include lists of the detector hits ( or tracks ) which are to be associated to the _ phtrack _ object .",
    "these `` hit lists '' are constructed and sorted by spectrometer arm and by increasing azimuthal angle using a class developed for this functionality in order to simplify and speed up processing .",
    "once constructed , the manipulation of these `` hit list '' objects are independent of the detector to which the hits or tracks belong . due to the small number yet wide resolution disparity of detectors that must be associated ,",
    "the hit association is performed using a three - dimensional road algorithm with each detector associated independently . for",
    "a given _ phtrack _ object , its projection point at the detector being associated is used to define the center of a window spanning the @xmath18 and @xmath8 coordinate directions .",
    "projection error estimates from the _ phtrack _ object , which can be momentum - dependent , are then used to define the widths of the roads in @xmath18 and @xmath8 .",
    "these widths can be scaled at run - time via user input parameters , typically after examining the residuals of the projections .",
    "once the window is defined , it s ranges are fed to the `` hit list '' object , which returns either a list of all hits within the window , or the closest hit to the center of the window within its boundaries .",
    "there is one special case of tec track association considered in this algorithm . for this detector , the @xmath92 angle of the tec track , along with the @xmath92 angle of the drift chamber track ,",
    "are correlated with the inverse @xmath12 of the track .",
    "this information can be used to apply an @xmath92-difference angle cut between the two detector tracks to reduce the list of tec tracks being considered for association .",
    "for the analysis of the data taken in run 2000 , the accuracy of the projection determination was good enough that the closest hit was used in the initial reconstruction pass while retaining the option for specific analyses to further optimize the association hit set in later passes on the dst s using the `` hit list '' methods .",
    "[ gloeff ]    the efficiency of the inter - detector hit association , with the association being defined as the hit closest to the center of the projection window , has been calculated based upon 200 gev / a au+au central events generated using the hijing event generator @xcite .",
    "these events were processed through the geant - based simulation of the detector response for all detectors in the central arm spectrometers . the output of the response simulation",
    "was then reconstructed in the same manner as the data while storing the pointers that relate reconstructed global tracks back to the geant tracks that contribute to them .",
    "utilities that trace a reconstructed object back to the geant information are implemented as a singleton class for use by a wide variety of evaluations . for the evaluation of the global association , the _ dominant contributor _ of the drift chamber track",
    "was used as a basis .",
    "the _ dominant contributor _ is defined as the input geant track which contributes the most hits to the reconstructed track . in order for an association to be considered to be made correctly , the geant track that provided the reconstructed hit or track for the detector in question must match the dominant contributor of the reconstructed drift chamber track to which it is associated .",
    "the efficiency is defined as the ratio of the number of tracks that were correctly reconstructed and geometrically reconstructable to the number of tracks that were geometrically reconstructable by each detector ( in order to isolate the efficiency to that of the association only ) .",
    "the results of the efficiency calculation are shown in fig .",
    "[ gloeff ] for associations to pc1 , which is situated adjacent to the drift chamber , and for associations to pc3 after spanning the tracking - detector - free gap occupied by the rich .",
    "although the efficiencies in the left panel of fig .  [ gloeff ] are lower , the performance is such that good particle identification can be achieved using the tof , as demonstrated in the next section .",
    "particle identification for charged hadrons is performed by combining the information from the drift chamber , pc1 , bbc , and the tof .",
    "the time - of - flight resolution of the tof is measured to be 115 ps , resulting in pid capability for high momentum particles .",
    "a 4@xmath31 @xmath101/k separation at momenta up to 2.4 gev / c , and a k / proton separation up to 4.0 gev / c can be achieved as shown in fig .",
    "[ tofpid ] .        once a global track is reconstructed with information from the drift chamber , pc1 , and tof ( using a window for tof association adjusted so that the residuals between the projection point and the reconstructed tof hit position is within a standard deviation of 2.5 ) , the flight - path length of the track from the event vertex to the tof as calculated by the momentum reconstruction algorithm is used to correct the time - of - flight value measured by the tof .",
    "[ tofpid ] shows a scatter plot of corrected time - of - flight as a function of the reciprocal of the momentum in minimum - bias au+au collisions , after the momentum - dependent residual cut between the track projection point and tof hits .",
    "the flight path is also corrected for each particle species in this figure .",
    "[ tofmass2 ] shows the mass - squared distribution for positively charged particles integrated over all momenta .",
    "the vertical axis in this figure is in arbitrary units .",
    "it is demonstrated that clear particle identification using the tof is achieved in run 2000 .",
    "this document has described the methods and algorithms used for event reconstruction in the phenix central arm spectrometers . using a modular , object - oriented implementation , widely disparate algorithms from widely disparate detector types",
    "have been integrated into a coherent reconstruction chain in order to successfully reconstruct hits and tracks within each detector , associate hits from different detectors , reconstruct particle momenta , and provide particle identification for phenix physics analysis .",
    "we thank the staff of the rhic project , collider - accelerator , and physics departments at bnl and the staff of phenix participating institutions for their vital contributions .",
    "we acknowledge support from the department of energy and nsf ( u.s.a . ) , monbu - sho and sta ( japan ) , ras , rmae , and rms ( russia ) , bmbf and daad ( germany ) , frn , nfr , and the wallenberg foundation ( sweden ) , mist and nserc ( canada ) , cnpq and fapesp ( brazil ) , in2p3/cnrs ( france ) , dae ( india ) , krf and kosef ( korea ) , and the us - israel binational science foundation ."
  ],
  "abstract_text": [
    "<S> the central arm spectrometers for the phenix experiment at the relativistic heavy ion collider have been designed for the optimization of particle identification in relativistic heavy ion collisions . </S>",
    "<S> the spectrometers present a challenging environment for event reconstruction due to a very high track multiplicity in a complicated , focusing , magnetic field . in order to meet this challenge , </S>",
    "<S> nine distinct detector types are integrated for charged particle tracking , momentum reconstruction , and particle identification . </S>",
    "<S> the techniques which have been developed for the task of event reconstruction are described .    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    , and    25.75.-q , 07.05.kf , 29.85.tc , 29.30.-h </S>"
  ]
}