{
  "article_text": [
    "in recent years electronic structure codes based on local orbital basis sets have proven successful in describing complex systems involving several thousands of atoms.@xcite the key concept behind the use of local orbital basis sets in the solid state is that the ground - state electronic density matrix is exponentially localized in insulators.@xcite as a consequence of this localization , the representation of one - particle operators in a local orbital basis leads to strictly sparse matrices .",
    "it is therefore possible to solve the electronic structure problem , e.g.  the kohn - sham equations of density - functional theory ( dft ) , using numerical methods whose complexity scales linearly as a function of system size.@xcite    a natural question arising is whether such local orbital basis sets would also be advantageous in the study of electronic excitations . since these basis sets are optimized for providing an accurate description of ground - state properties , it is not clear _ a priori _ how to exploit them for calculating excited state properties .",
    "for example , in the specific case of @xmath1 calculations@xcite the green s function and the screened coulomb interaction are both evaluated by using expansions over unoccupied electronic states .",
    "however , local orbital basis sets typically provide a poor description of unoccupied states , and the convergence as a function of basis size is not systematic as in the case of planewaves basis sets@xcite or finite difference methods.@xcite in this context it would be desirable to develop new methods for electronic excitations which ( i ) retain the favorable scaling of local orbital basis sets , and ( ii ) do not require the explicit calculation of unoccupied states .",
    "recently several schemes have been proposed in order to reduce or avoid the evaluation of unoccupied states in excited - state calculations.@xcite in refs .",
    "a small number of unoccupied states or even one single state are used to effectively replace the expansion over the conduction manifold .",
    "the authors of ref .   use selected eigenvectors of the dielectric matrix in order to evaluate the screened coulomb interaction without explicitly performing sums over empty states . in ref .",
    "a lanczos algorithm is used in order to calculate the dielectric matrix using continued fractions , without performing sums over empty states .",
    "we here consider the scheme proposed in ref .   for evaluating the screened coulomb interaction in extended systems .",
    "in this scheme the expansion over unoccupied states and the matrix inversion are avoided altogether , and replaced by the self - consistent solution of sternheimer equations . in a recent work@xcite",
    "we have extended the scheme of ref .   to the case of local orbital basis sets , and implemented our new scheme using the siesta package.@xcite ref",
    ".   represents , to our knowledge , the first implementation of the self - consistent sternheimer equation in a local orbitals basis for extended systems .    in the present manuscript",
    "we complement and extend the work of ref .   by systematically comparing the performance of numerical pseudo - atomic orbital basis sets with standard plane - waves results .",
    "since most excited - state calculations involve kernels describing the nonlocal and time - dependent dielectric screening of the material , we here focus on the the frequency- and wavevector- dependent dielectric matrix of representative semiconductors .    the manuscript is organized as follows . in sec .",
    "[ sec : method ] we describe our methodology .",
    "in particular , in sec .  [ sec : method-0 ] we summarize the self - consistent sternheimer scheme for the screened coulomb interaction and the inverse dielectric matrix . in secs .",
    "[ sec : method-1 ] and [ sec : method-2 ] we specialize the formalism to the case of local orbital basis sets and periodic systems , respectively . in sec .",
    "[ sec : comput - details ] we briefly describe the basis set of siesta that we use in all our calculations ( sec .",
    "[ sec : method-3 ] ) and we provide details on the structural and convergence parameters used in the calculations ( sec .  [ sec : method-4 ] ) . in sec .",
    "[ sec : results ] we discuss our results , focusing on the three semiconductors diamond , silicon , and germanium .",
    "this choice allows us to understand how the performance of our methodology varies when moving from more insulating ( diamond ) to more metallic systems ( germanium ) .",
    "in particular we investigate both the static dielectric matrices ( sec .",
    "[ sec : static ] ) , and the frequency- and wavevector - dependent dielectric functions ( sec .  [ sec : frequency ] ) . in sec .",
    "[ sec : conclusions ] we summarize our findings and draw our conclusions .",
    "we leave to appendix  [ app : qr ] some technical details of our implementation .",
    "the first order change of the valence kohn - sham wavefunction @xmath2 due to the perturbation @xmath3 is expressed by the sternheimer equation as : @xmath4 where @xmath5 is the kohn - sham hamiltonian and @xmath6 is the projector on the conduction manifold . the corresponding change in the valence electron density is given by : @xmath7 where the prefactor also takes into account the spin degeneracy ( we refer to spin - unpolarized systems for simplicity ) .",
    "the density variation of eq .",
    "( [ eq.dfpt2 ] ) induces a change in the self - consistent potential @xmath3 experienced by the electrons ( through the hartree and exchange - correlation terms ) , therefore eqs .",
    "( [ eq.dfpt1 ] ) and ( [ eq.dfpt2 ] ) must be solved iteratively .",
    "this procedure is at the core of density - functional perturbation theory for lattice dynamics.@xcite    in the following we summarize the extension of the self - consistent sternheimer approach to the calculation of the screened coulomb interaction @xmath8 and the inverse dielectric matrix @xmath9 , as derived in ref .  .",
    "these quantities are both functions of the real - space variables @xmath10 , @xmath11 , and of the frequency @xmath12 , and are related to the bare coulomb interaction @xmath13 through : @xmath14 the calculation of @xmath9 starting from @xmath8 is straightforward in reciprocal space , therefore in the following we focus on the screened coulomb interaction .",
    "we first parametrize the frequency and one spatial variable of @xmath8 by defining the potential @xmath15}({\\mathbf{r } } ' ) = w({\\mathbf{r}},{\\mathbf{r}}';\\omega)$ ] .",
    "this potential induces a change @xmath16 } $ ] of the valence wavefunction @xmath2 given by : @xmath17 } =     -(1-\\hat{p}_{{\\mathnormal{v}}})\\delta v_{[{\\mathbf{r}},\\omega]}\\psi_{\\mathnormal{v}}.\\ ] ] the associated variation of the density matrix is @xmath18 } =    2 \\sum_{{\\mathnormal{v}},\\sigma=\\pm}\\psi^*_{\\mathnormal{v}}\\delta\\psi^\\sigma_{{\\mathnormal{v}}[{\\mathbf{r}},\\omega]}.\\ ] ] in the random - phase approximation ( rpa ) this variation generates the screening hartree potential @xcite @xmath19}({\\mathbf{r } } ' ) =    \\int d{\\mathbf{r}}''\\delta n_{[{\\mathbf{r}},\\omega]}({\\mathbf{r}}''){\\mathnormal{v}}({\\mathbf{r}}'',{\\mathbf{r}}'),\\ ] ] which is added to the bare coulomb potential in order to obtain the total self - consistent potential appearing in eq .",
    "( [ eq : stern ] ) : @xmath20}({\\mathbf{r}}')=   v({\\mathbf{r}},{\\mathbf{r } } ' ) + \\delta v^h_{[{\\mathbf{r}},\\omega]}({\\mathbf{r}}').\\ ] ] the iterative self - consistent solution of eqs .",
    "( [ eq : stern])-([eq : indpot ] ) for all the values of the parameters @xmath10 and @xmath12 yields the screened coulomb interaction @xmath8 .",
    "this scheme is exactly equivalent@xcite to evaluating @xmath8 via hedin s equation @xmath21 @xmath22 being the rpa polarizability .      in order to implement the method described in sec .",
    "[ sec : method-0 ] within the basis of local orbitals @xmath23 we expand the wavefunctions and their first order variations as : @xmath24}({\\mathbf{r } } ' ) & = &     \\sum_i \\delta c_{{\\mathnormal{v}}i[{\\mathbf{r}},\\omega ] } \\phi_i({\\mathbf{r } } ' ) \\label{def : dc } .",
    "\\end{aligned}\\ ] ] the expansions would be exact if the local orbitals were to span the entire hilbert space of the single - particle hamiltonian .",
    "in practice the representation of the valence wavefunctions is expected to be accurate , while the description of the variations requires some care because they arise from the conduction manifold . by replacing eqs .",
    "( [ eq : expval])-([def : dc ] ) inside eq .",
    "( [ eq : stern ] ) and performing scalar products of both sides with basis functions we obtain the matrix equations : @xmath25    \\delta \\mathbf{c}^\\pm_{{\\mathnormal{v}}[{\\mathbf{r}},\\omega ] } =    -\\left[\\mathbf{1 } -\\mathbf{s}{\\mbox{\\boldmath$\\rho$}}^t \\right ]    \\delta \\mathbf{v}_{[{\\mathbf{r}},\\omega ] } \\mathbf{c}_{{\\mathnormal{v}}},\\ ] ] where the hamiltonian @xmath26 , overlap @xmath27 , density @xmath28 , and perturbation @xmath29}$ ] matrices are defined in the usual notation as : @xmath30 } & = & { \\langle \\phi_i| } \\delta v_{[{\\mathbf{r}},\\omega ] }     { |\\phi_j \\rangle } \\label{eq : dv}.    \\end{aligned}\\ ] ] the hamiltonian , the overlap , and the density matrices are readily available in any local orbital dft implementation .",
    "the matrix elements @xmath31}$ ] require careful consideration .",
    "the iterative self - consistent solution of the sternheimer equation starts with @xmath15}({\\mathbf{r}}')$ ] initialized to the bare coulomb potential @xmath32 .",
    "this is a nonlocal potential , therefore an expansion in the local orbital basis would require the product functions @xmath33.@xcite using such expansion@xcite in eq .",
    "( [ eq : dv ] ) would ultimately lead to the evaluation of four - point integrals , and would also introduce three - point overlaps in the sternheimer equations .",
    "in addition , the validity of such expansion for the coulomb potential is not guaranteed . in order to avoid this difficulty we evaluate the integral of eq .",
    "( [ eq : dv ] ) in real space .",
    "this real - space integral is part of the siesta implementation .",
    "we stress that the evaluation of eq .",
    "( [ eq : dv ] ) in real space does not suffer from representability issues associated with a product - basis expansion , and we do not make use of the expansion of the identity operator in the local orbital basis .    the solution of eq .",
    "( [ eq : sternmatrix ] ) yields the vector @xmath34 of the linear response coefficients which are used to construct the variation of the density matrix : @xmath35 } = 2\\sum_{{\\mathnormal{v}},\\sigma=\\pm } c^*_{{\\mathnormal{v}}i }    \\delta c^\\sigma_{{\\mathnormal{v}}j[{\\mathbf{r}},\\omega]}.\\ ] ] for the evaluation of the induced hartree potential eq .",
    "( [ eq : hartree ] ) , first the variation of the density matrix is calculated on the real - space grid : @xmath18}({\\mathbf{r } } ' ) =     \\sum_{ij } \\delta n_{ij[{\\mathbf{r}},\\omega ] } \\phi^*_i({\\mathbf{r}}')\\phi^*_j({\\mathbf{r}}'),\\ ] ] then standard fourier - transform techniques are employed .",
    "the convergence of the scf - cycle is tested on the variation of the density matrix eq .",
    "( [ eq : dn ] ) .",
    "the self - consistent procedure is carried out independently for the parameters @xmath10 and @xmath12 .",
    "apart from leading to a trivial parallelization , this scheme has the advantage that the parametrized space variable @xmath10 can be represented on a coarser grid than the one used for @xmath11 and the real - space integrals .",
    "indeed , the accuracy required for operations in @xmath11 is the same needed to describe the kohn - sham hamiltonian , while the accuracy for @xmath10 is the one needed to represent the screened coulomb interaction .      in order",
    "to address extended periodic systems and compare our results with calculations based on planewaves basis sets , in this section we specialize the formalism of sec .",
    "[ sec : method-1 ] to the case of crystalline solids .",
    "we start by introducing a new basis set which satisfies bloch s theorem from the outset . for this purpose",
    "we define the cell - periodic functions : @xmath36 where @xmath37 is a point in the brillouin zone and @xmath38 a lattice vector . in eq .",
    "( [ eq.blochbasis ] ) the orbitals @xmath39 are the same as in eq .",
    "( [ eq : expval ] ) , except that here they only span the unit cell of the crystal .",
    "it is immediate to verify that the functions @xmath40 satisfy bloch s theorem , and that the basis functions @xmath41 are periodic .    in analogy with eqs .",
    "( [ eq : expval ] ) , ( [ def : dc ] ) we expand the periodic part @xmath42 of the kohn - sham eigenfunctions @xmath43 using the basis @xmath41 : @xmath44}({\\mathbf{r } } ' ) & = & \\sum_i \\delta c_{vi{\\mathbf{k}}[{\\mathbf{q}},{\\mathbf{r}}]}\\phi_{i{\\mathbf{k}}+{\\mathbf{q}}}({\\mathbf{r } } ' ) .",
    "\\end{aligned}\\ ] ] by rewriting eq .",
    "( [ eq : stern ] ) for a periodic system@xcite and taking scalar products with basis functions we obtain the analogue of eq .",
    "( [ eq : sternmatrix ] ) for crystalline systems : @xmath45    \\delta \\mathbf{c}^\\pm_{{\\mathnormal{v}}{\\mathbf{k}}[{\\mathbf{q}},{\\mathbf{r}},\\omega ] } = \\\\    & \\qquad\\qquad\\ ; -\\left[\\mathbf{1 } - \\mathbf{s}_{{\\mathbf{k}}+{\\mathbf{q}}}{\\mbox{\\boldmath$\\rho$}}^t_{{\\mathbf{k}}+{\\mathbf{q}}}\\right ]    \\delta \\mathbf{v}_{{\\mathbf{k}}[{\\mathbf{q}},{\\mathbf{r}},\\omega ] } \\mathbf{c}_{{\\mathnormal{v}}{\\mathbf{k}}}.    \\end{split}\\ ] ] in this case the hamiltonian and the overlap matrices are defined as : @xmath46 the perturbation matrix reads : @xmath47 } =    \\int d{\\mathbf{r } } ' \\phi^*_{i{\\mathbf{k}}+{\\mathbf{q}}}({\\mathbf{r } } ' ) \\delta v_{[{\\mathbf{q}},{\\mathbf{r}}]}({\\mathbf{r } } ' ) \\phi_{j{\\mathbf{k}}}({\\mathbf{r } } ' )     \\nonumber \\\\    & &   \\hspace{-0.9 cm } =     \\sum_{{\\mathbf{r}}}e^{i{\\mathbf{k}}{\\cdot}{\\mathbf{r}}}\\int d{\\mathbf{r } } ' \\phi_{i}({\\mathbf{r}}')\\delta v_{[{\\mathbf{q}},{\\mathbf{r}}]}({\\mathbf{r } } ' )    e^{i{\\mathbf{q}}{\\cdot}{\\mathbf{r}}'}\\phi_{j}({\\mathbf{r}}'-{\\mathbf{r}}),\\label{eq.dvmatrix }    \\end{aligned}\\ ] ] where @xmath48}({\\mathbf{r}}')$ ] is the cell - periodic component of the perturbation with wavevector @xmath49:@xcite @xmath50}({\\mathbf{r } } ' )   =   \\frac{1}{n_{{\\mathbf{q}}}}\\sum_{{\\mathbf{q}}}e^{i{\\mathbf{q}}{\\cdot}({\\mathbf{r}}'-{\\mathbf{r } } ) }    \\delta v_{[{\\mathbf{q}},{\\mathbf{r}},\\omega]}({\\mathbf{r}}').\\ ] ] in eqs .",
    "( [ eq.ham.k])-([eq.dvmatrix ] ) the integrals extend over the unit cell .",
    "this implies that the sums on lattice vectors @xmath38 effectively include the unit cells containing basis orbitals which have a non - vanishing contribution in the fundamental unit cell .",
    "this is consistent with the standard procedure for calculating matrix elements in the siesta code.@xcite    for the calculation of the self - consistent potential in eq .",
    "( [ eq : ksternmatrix ] ) we analyze the density variation in bloch components as : @xmath18}({\\mathbf{r } } ' ) = \\frac{1}{n_{{\\mathbf{q } } } }    \\sum_{\\mathbf{q}}e^{i{\\mathbf{q}}{\\cdot}{\\mathbf{r } } ' } \\delta n_{[{\\mathbf{q}},{\\mathbf{r}},\\omega]}({\\mathbf{r}}'),\\ ] ] and calculate the periodic part @xmath51}({\\mathbf{r}}')$ ] on the real space grid using : @xmath52}({\\mathbf{r } } ' ) =    \\frac{2}{n_{{\\mathbf{k}}}}\\sum_{v{\\mathbf{k}}\\sigma=\\pm}\\sum _ { ij}c^*_{vi{\\mathbf{k } } }    \\delta c^\\sigma_{vj{\\mathbf{k}}[{\\mathbf{q}},{\\mathbf{r}},\\omega ] } \\\\    &   & \\hspace{-.8 cm } \\times\\sum_{{\\mathbf{r}}{\\mathbf{r}}'}e^{-i{\\mathbf{k}}{\\cdot}({\\mathbf{r}}-{\\mathbf{r}}')}e^{i{\\mathbf{q}}{\\cdot}{\\mathbf{r } } ' }    e^{-i{\\mathbf{q}}{\\cdot}{\\mathbf{r}}'}\\phi_{i}({\\mathbf{r}}'-{\\mathbf{r}})\\phi_{j}({\\mathbf{r}}'-{\\mathbf{r } } ' ) \\label{eq : dn_matrix}.    \\end{aligned}\\ ] ] in the previous two equations @xmath53 and @xmath54 are the number of wavevectors used to sample the brillouin zone ( we assume uniform sampling only for simplicity of notation ) .",
    "we point out that the presence of finite @xmath49-vectors in the above equations introduces non - trivial terms in the expressions for the variation of the charge density and the associated induced potential . loosely speaking , the phase factors @xmath55",
    "are calculated on the real - space grid , while the phase factors @xmath56 are added at the level of the matrix elements .",
    "these terms require some care in a practical implementation , as described in detail in appendix  [ app : qr ] .",
    "the method presented in sec .",
    "[ sec : method ] has been implemented using the siesta code as the starting software platform .",
    "the basis functions @xmath57 are numerical pseudo - atomic orbitals.@xcite for each orbital , the radial part is obtained by solving the radial schrdinger equation for a pseudo - atom based on troullier - martins psedupotentials.@xcite the basis orbitals are strictly localized within a preset cutoff radius , which is controlled by a so - called `` energy shift '' parameter.@xcite this parameter is uniquely defined for a given calculation .",
    "the basis of numerical pseudo - atomic orbitals can be augmented by associating multiple radial functions with the same principal atomic quantum number .",
    "such additional functions are constructed in siesta using the split - norm procedure,@xcite and are denoted in the quantum chemistry literature as `` multiple-@xmath0 '' .",
    "the split - norm construction guarantees that the additional @xmath0 s exhibit a smaller cutoff radius w.r.t . the originating radial function .",
    "this feature ensures that the spatial extent of the basis orbitals is dictated by the energy - shift parameter , regardless of how many additional @xmath0 s are used .",
    "additional flexibility in the basis set is usually achieved by augmenting this basis through `` polarization orbitals '' . such orbitals are obtained by solving the schrdinger equation for the outermost shell of the pseudo - atom in the presence of a small electric field.@xcite    these polarization orbitals are generally needed for high accuracy and it has been found that for most ground - state quantities of interest double-@xmath0 basis sets including polarization orbitals ( dzp ) yield results in good agreement with standard planewaves calculations.@xcite      for diamond , silicon , and germanium we calculate the inverse dielectric matrix @xmath58 using the method described in sec .  [",
    "sec : method ] with the initial perturbation in eq .",
    "( [ eq : stern ] ) set to @xmath15}({\\mathbf{r}}')={\\rm exp}[i({\\mathbf{q}}+{\\bf g})\\cdot{\\mathbf{r}}']$ ] , and by taking the fourier component of the resulting self - consistent potential corresponding to the wavevector @xmath59 .",
    "the dielectric function is obtained as @xmath60 and the macroscopic dielectric constant as @xmath61 .",
    "we perform calculations using the local - density approximation@xcite to density - functional theory .",
    "only valence electrons are described , and the core - valence interaction is taken into account through norm - conserving pseudopotentials.@xcite in the following we test the method described in sec .",
    "[ sec : method ] by considering a range of possibilities for the local orbitals basis sets .",
    "the lattice parameters are set to 6.74 au , 10.26 au , and 10.68 au for diamond , silicon , and germanium , respectively.@xcite the dielectric matrices are calculated by sampling the brillouin zone with a shifted @xmath62 mesh in the case of diamond and silicon , and a @xmath63 mesh for germanium .",
    "when using a triple-@xmath0 polarized ( tzp ) basis we obtain the direct band gaps 5.60 ev , 2.55 ev , and 0.04 ev for diamond , silicon , and germanium , respectively , in line with standard planewaves calculations .",
    "we use the energy - shift parameter of 10 mev for all three materials .",
    "these parameters lead to localization radii of 7.4  , 9.3  , and 9.5    for diamond , silicon and germanium , respectively , that are larger than those adopted in standard ground - state calculations using siesta .",
    "results for standard values of the energy - shift parameters and localization radii are reported in ref .  .",
    "by tuning the energy - shift parameter and the split norm it is possible to generate multiple @xmath0 orbitals with a varying degree of localization .",
    "for example , in the case of silicon , if we use a split norm of 0.15 , we obtain a localization radius of 9.3   for the first @xmath0 corresponding to the si-@xmath64 orbital , and a radius of 5.5   for the second @xmath0 .",
    "additional @xmath0 functions have by construction localization radii between those of the first and of the second @xmath0 ( fig .",
    "[ fig : zetas ] ) .",
    "a small value of the split norm leads to @xmath0 functions with very similar localization radii and shape [ fig .",
    "[ fig : zetas](a ) ] .",
    "larger values of the split norm lead to a more even distribution of radii and allow for more flexibility in the multiple-@xmath0 basis [ fig .",
    "[ fig : zetas](b ) ] .",
    "we performed calculations for several values of the split norm between 0.15 and 0.5 , and in sec .",
    "[ sec : static ] discuss our results for the two ends of this range .",
    "the standard value of the split norm in siesta calculations is 0.15 .    for comparison we also perform standard planewaves calculations using the abinit package@xcite and the yambo code@xcite , using the same brillouin - zone grids and pseudopotentials . in the planewaves calculations dielectric",
    "matrices are obtained within the random - phase approximation using the adler - wiser formulation.@xcite in all cases the calculations are found to be converged by using 92 unoccupied electronic states .",
    "we use planewaves cutoffs of 20 ry for silicon and germanium and 60 ry for diamond for the ground - state calculations .",
    "the corresponding planewaves cutoffs for the dielectric matrices are 12 ry , 6.9 ry , and 6.9 ry for diamond , silicon , and germanium , respectively .    while we carefully set all the parameters of the plane - waves calculations in order to make the comparison as accurate as possible ,",
    "there remains one systematic difference in how the long - wavelength limit @xmath65 is taken in the calculation of the dielectric constant .",
    "we obtain this limit by considering a small but finite wavevector ( @xmath66 , @xmath67 being the lattice parameter ) , while the yambo code calculates this limit analytically .",
    "the two treatments are in principle equivalent , but we can not rule out that this difference might result in small differences between the results presented in the following section .",
    "the purpose of this section is to study the convergence of the calculated dielectric matrices with the size and type of the local orbital basis , and to perform a systematic comparison with reference planewaves calculations .",
    "we discuss our results for the dielectric matrices of diamond , silicon , and germanium .",
    "we start with silicon since this has been the benchmark semiconductor in a number of previous studies of dielectric screening and quasiparticle methods .",
    "figure [ fig : si_static](a ) shows the calculated macroscopic dielectric constant of silicon as a function of basis size , for a split norm of 0.15 .",
    "the smallest possible basis includes 4 orbitals per atoms ( 1 @xmath68 orbital and 3 @xmath69 orbitals ) and is referred to as the single-@xmath0 basis ( sz ) . the basis sets with and without polarization orbitals appear to converge to different asymptotic values .",
    "the plateau of the polarized basis set is @xmath70 and is reached with the tzp basis ( 17 orbitals per atom ) .",
    "this value is within 3% of our reference planewaves result @xmath71 .",
    "interestingly the minimal polarized basis ( szp , 9  orbitals per atom ) yields values which are within 10% of the reference planewaves result .",
    "figure [ fig : si_static](b ) shows the effect of the split norm on the convergence of the macroscopic dielectric constant as a function of basis size .",
    "we observe that by increasing the split norm the calculated dielectric constant converges to the planewaves value more rapidly .",
    "we assign this trend to the fact that a larger split norm leads to a wider range of localization radii spanned by the additional basis functions , and hence improves the completeness of the basis set .",
    "figure [ fig : c_static](a ) shows the calculated macroscopic dielectric constant of diamond for a split norm of 0.15 .",
    "the trend is similar to the case of silicon discussed in sec .",
    "[ sec.silicon ] . also in this case basis sets without polarization orbitals lead to a slower convergence rate as a function of basis size , and converge to a value significantly smaller than the reference planewaves result .",
    "the converged value for the polarized basis set is @xmath72 for the 4z4p basis , which includes 36 orbitals per atom .",
    "this value agrees very well with corresponding planewaves result @xmath73 . as in the case of silicon a reasonably converged value ( @xmath74 , 1% smaller than the planewaves result )",
    "is already obtained using the tzp basis .",
    "figure [ fig : c_static](b ) shows the effect of the split norm on the convergence of the macroscopic dielectric constant as a function of basis size . in this case",
    "the trend is less clear than in fig .",
    "[ fig : si_static](b ) , however the same general conclusions apply : by increasing the split norm the dielectric constant converges more rapidly and a plateau can be identified .",
    "figure [ fig : ge_static](a ) shows the calculated macroscopic dielectric constant of germanium ( split norm 0.15 ) .",
    "also in this case the basis sets with and without polarization orbitals appear to converge to different asymptotic values .",
    "similarly to the case of silicon and diamond the polarized basis sets converge to a higher dielectric constant , @xmath75 .",
    "this value is 3% larger than the reference planewave result of @xmath76 .",
    "also in this case we observe that the tzp basis yields a dielectric constant close to the fully converged value ( @xmath77 ) .",
    "figure [ fig : ge_static](b ) shows the effect of the split norm on the convergence of the macroscopic dielectric constant as a function of basis size . as in the other two cases , by increasing the split norm the calculated dielectric constant converges more rapidly to its asymptotic value .",
    "figure [ fig : si_wreal ] shows the frequency - dependent dielectric function of silicon @xmath78 for the minimal sz basis set , the tzp basis set , and the reference planewaves calculation .",
    "the sz basis performs very poorly , the spectral weight being incorrectly transferred from the main absorption peak to higher energy .",
    "this is consistent with the small value of the macroscopic dielectric constant obtained with the sz basis in fig .",
    "[ fig : si_static ] .",
    "the tzp basis yields results in reasonable agreement with our reference planewaves result .",
    "the location of the main peaks and shoulders are correctly reproduced .",
    "we note , however , some transfer of spectral weight from the main peak at @xmath794 ev to the shoulder at @xmath793 ev , and a blueshift of the high - energy peaks .",
    "figures [ fig : c_wreal ] and [ fig : ge_wreal ] show the frequency - dependent dielectric functions of diamond and germanium , respectively .",
    "also in these cases we compare the performance of the sz basis and the tzp basis with the reference planewaves calculation .",
    "conclusions similar to the case of silicon can be drawn : the sz basis misses the main peak and yields a blueshift of the other peaks , while the tzp basis is in better agreement with the reference planewaves calculation .",
    "figure [ fig : q ] shows the wavevector dependence of the dielectric function @xmath80 for silicon , diamond , and germanium , comparing the performance of the sz and the tzp basis sets .",
    "in all cases the wavevector dependence shows the correct behavior,@xcite although the sz basis yields a smaller dielectric function across the full range of wavevectors .",
    "we reported a systematic study of the performance of numerical pseudo - atomic orbital basis sets of the siesta code in the calculation of dielectric matrices in extended systems using the self - consistent sternheimer approach of refs .  .",
    "in order to cover a range of systems from more insulating to more metallic character we presented results for the three semiconductors diamond , silicon , and germanium .",
    "dielectric matrices , converged within the multi-@xmath0 and polarization scheme , fall within 3% of reference planewaves calculations , demonstrating that this method is promising .",
    "we observed that the tzp basis already yields results very close to fully converged values .",
    "this information may prove useful for practical calculations of electronic excitations using pseudo - atomic orbital basis sets as in the siesta code .",
    "in particular the tzp basis yields the correct spectral features in the long - wavelength frequency - dependent dielectric function .",
    "we observed a consistent performance of the tzp basis across the three systems considered , regardless of their more insulating ( diamond ) or metallic ( germanium ) character . this may result from the different localization radii which already account for the varying degree of localization of the density matrix in each material .",
    "we also noted that polarization orbitals are critical for achieving good agreement with reference planewaves calculations .",
    "this is somewhat expected since polarization orbitals precisely describe the response to external fields .",
    "we have investigated how the choice of the split norm influences the convergence of the results .",
    "the increase of the split norm leads to multiple-@xmath0 orbitals with a wider distribution of localization radii and effectively improves the completeness of the basis .",
    "we point out that the localization radii of the basis sets discussed here are rather large and therefore are not optimal for practical calculations .",
    "our choice was motivated by the need to systematically explore basis sets with many @xmath0 s .",
    "we expect that similar conclusions will be obtained by augmenting the basis using diffuse numerical orbitals with similar localization radii as those considered here.@xcite the study of the performance of diffuse orbitals deserves further investigation .    by providing a systematic assessment of the performance of pseudo - atomic orbital basis sets including multiple-@xmath0 s and polarization , the present work sets the ground for future studies of dielectric screening and electronic excitations in extended systems using local orbitals .",
    "the authors would like to thank e. artacho for fruitful discussions .",
    "this work is funded by the european research council under the european community s seventh framework programme , grant no .",
    "239578 , and spanish micinn grant fis2009 - 12721-c04 - 01 .",
    "the evaluation of the variation @xmath51}$ ] of the density matrix using eq .",
    "( [ eq : dn_matrix ] ) requires the introduction of the bloch phase factors @xmath81 , @xmath82 , and @xmath83 at various stages .",
    "we proceed as follows .",
    "first we merge into a single index @xmath84 the basis index @xmath85 and the unit cell vector @xmath86 of the cell for each orbital @xmath87 : @xmath88 and @xmath89 . using this notation we rewrite eq .",
    "( [ eq : dn_matrix ] ) as follows : @xmath52}({\\mathbf{r } } ' ) =    \\frac{2}{n_{{\\mathbf{k}}}}\\sum_{v{\\mathbf{k}}\\sigma=\\pm}\\sum_{ij}c^*_{vi{\\mathbf{k } } }    \\delta c^\\sigma_{vj{\\mathbf{k}}[{\\mathbf{q}},{\\mathbf{r}},\\omega ] } \\\\    &   & \\hspace{-.8 cm } \\times e^{-i{\\mathbf{k}}{\\cdot}({\\mathbf{r}}_i-{\\mathbf{r}}_j)}e^{i{\\mathbf{q}}{\\cdot}{\\mathbf{r}}_j }    e^{-i{\\mathbf{q}}{\\cdot}{\\mathbf{r}}'}\\phi_i({\\mathbf{r}}')\\phi_j({\\mathbf{r}}'),\\label{eq.app.1 }    \\end{aligned}\\ ] ] where @xmath85 in @xmath90 is still the orbital component of the composite indices @xmath88 , and similarly for @xmath91 . in order to evaluate eq .",
    "( [ eq.app.1 ] ) we first calculate the matrix @xmath92 }     = 2\\sum_{v\\sigma=\\pm } c^*_{vi{\\mathbf{k } } }    \\delta c^\\sigma_{vj{\\mathbf{k}}[{\\mathbf{q}},{\\mathbf{r}},\\omega]}.\\ ] ] second , we perform the sum over the wavevectors @xmath37 and introduce the phase factors @xmath93 $ ] : @xmath94 } =      \\frac{1}{n_{{\\mathbf{k } } } } \\sum_{{\\mathbf{k } } } \\delta n^{(1)}_{ij{\\mathbf{k}}[{\\mathbf{q}},{\\mathbf{r}},\\omega ] }     e^{-i{\\mathbf{k}}{\\cdot}({\\mathbf{r}}_i-{\\mathbf{r}}_j)}.\\ ] ] third , we include the phase factor @xmath95 : @xmath96}({\\mathbf{r } } ' ) =     \\sum_{ij } \\delta n^{(2)}_{ij[{\\mathbf{q}},{\\mathbf{r}},\\omega ] }     e^{i{\\mathbf{q}}{\\cdot}{\\mathbf{r}}_j } \\phi_i({\\mathbf{r}}')\\phi_j({\\mathbf{r}}'),\\ ] ] and finally we introduce the factor @xmath97 : @xmath98}({\\mathbf{r } } ' ) =    e^{-i{\\mathbf{q}}{\\cdot}{\\mathbf{r } } } \\delta n^{(3)}_{[{\\mathbf{q}},{\\mathbf{r}},\\omega]}({\\mathbf{r}}').\\ ] ] this final phase factor is added only after the real space density response has been evaluated on the grid .",
    "the reason for proceeding as described here becomes evident if we make the observation that we only need to calculate the density variation inside the fundamental unit cell .",
    "this implies that we only need to work with basis orbitals belonging to the fundamental unit cell or which are nonvanishing in this cell . as a consequence we can calculate eq .",
    "( [ eq.app.2 ] ) only for those @xmath99 which lead to finite overlap with the fundamental cell .",
    "furthermore , it is convenient to calculate @xmath100}$ ] only for the index @xmath84 belonging to the fundamental unit cell [ i.e.  @xmath101 and the index @xmath102 over the orbitals with finite overlap with this cell : @xmath103 .",
    "this allows us to rewrite eq .",
    "( [ eq.app.2 ] ) as : @xmath104 } =      \\frac{1}{n_{{\\mathbf{k } } } } \\sum_{{\\mathbf{k } } } \\delta n^{(1)}_{ij{\\mathbf{k}}[{\\mathbf{q}},{\\mathbf{r}},\\omega ] }     e^{-i{\\mathbf{k}}{\\cdot}{\\mathbf{r}}_{ij'}},\\ ] ] where @xmath105 is the vector pointing from orbital @xmath84 to @xmath102 and @xmath84 is still @xmath106 .",
    "the matrix @xmath107}$ ] in eq .",
    "( [ eq.app.2b ] ) has the first dimension equal to the number of orbitals in the unit cell , and the second dimension equal to the number of orbitals that are non - zero in the fundamental unit cell .",
    "this is a sparse matrix and it is stored using the sparse matrix representation of siesta .",
    "the reason for evaluating eqs .",
    "( [ eq.app.3 ] ) and ( [ eq.app.4 ] ) separately is that the phase factor @xmath108 can not be added in the same way as the @xmath37-dependent factor into eq .",
    "( [ eq.app.2b ] ) , since it depends on the absolute position of the cell @xmath109 and not on the relative position of the orbitals @xmath110 . using this alternative notation",
    "we can rewrite eq .",
    "( [ eq.app.3 ] ) as : @xmath111}({\\mathbf{r } } ' ) =    \\sum_{i'j ' } \\delta n^{(2)}_{ij'[{\\mathbf{q}},{\\mathbf{r}},\\omega ] }     e^{i{\\mathbf{q}}{\\cdot}{\\mathbf{r}}_{j ' } } \\phi_{i'}({\\mathbf{r}}')\\phi_{j'}({\\mathbf{r}}'),\\ ] ] where @xmath112 refer to orbitals which are non - zero in the unit cell , and @xmath85 is the replica of @xmath113 belonging to the fundamental unit cell .",
    "our procedure allows us to use the the sparse matrix @xmath107}$ ] as the working quantity for the self - consistent cycle ( i.e.  for charge - density mixing and convergence tests ) .",
    "the scheme outlined here uses the sparse matrix representation built in siesta and requires only small changes to existing subroutines that manage the evaluation on the real space grid .",
    "it can therefore easily make use of subroutines that manage the density matrix during the scf procedure , such as density - mixing .",
    "furthermore , these steps ensure that the computational overhead of our procedure is minimal .",
    "42ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ]",
    " + 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase 10.1103/physrevb.34.5390 [ * * , ( ) ] @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop ( ) ,   @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase 10.1103/physrevb.43.1993 [ * * , ( ) ] @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase 10.1103/physrevlett.45.566 [ * * , ( ) ] @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase 10.1103/physrevb.79.075441 [ * * ,   ( ) ]"
  ],
  "abstract_text": [
    "<S> we present a systematic study of the performance of numerical pseudo - atomic orbital basis sets in the calculation of dielectric matrices of extended systems using the self - consistent sternheimer approach of [ f. giustino _ </S>",
    "<S> et al . _ , </S>",
    "<S> phys . </S>",
    "<S> rev . </S>",
    "<S> b * 81*(11 ) , 115105 ( 2010 ) ] . in order to cover a range of systems , from more insulating to more metallic character , we discuss results for the three semiconductors diamond , silicon , and germanium . </S>",
    "<S> dielectric matrices calculated using our method fall within 1 - 3% of reference planewaves calculations , demonstrating that this method is promising . </S>",
    "<S> we find that polarization orbitals are critical for achieving good agreement with planewaves calculations , and that only a few additional @xmath0 s are required for obtaining converged results , provided the split norm is properly optimized . </S>",
    "<S> our present work establishes the validity of local orbital basis sets and the self - consistent sternheimer approach for the calculation of dielectric matrices in extended systems , and prepares the ground for future studies of electronic excitations using these methods . </S>"
  ]
}