{
  "article_text": [
    "the variational and diffusion quantum monte carlo methods ( vmc and dmc ) are zero - temperature stochastic techniques for evaluating the expectation values of time - independent operators @xcite .",
    "these methods are particularly well suited for calculating the ground - state energies of large assemblies of interacting quantum particles .",
    "the central object is an approximate trial wave function whose accuracy controls the computed energy and the intrinsic statistical fluctuations in the calculations .",
    "it is therefore of particular importance to develop accurate trial wave functions .",
    "expectation values in vmc are evaluated using importance - sampled monte carlo integration . in dmc",
    "the ground state is projected out by evolving the schrdinger equation in imaginary time .",
    "such projector methods suffer from a fermion sign problem , in which errors in the propagation increase exponentially in imaginary time as the algorithm amplifies any spurious component of the lower - energy bosonic state .",
    "this problem may be evaded in dmc by employing the fixed - node approximation @xcite , in which the nodal surface is fixed to be that of a suitable trial wave function .",
    "the resulting dmc energy is greater than or equal to the exact energy and less than or equal to the vmc energy computed with the same trial wave function .",
    "the vmc energy depends on the entire trial wave function , but the dmc energy depends only on the nodal surface of the trial wave function .",
    "one of the appealing features of vmc and dmc is that virtually any form of trial wave function can be used .",
    "the main criteria are that the wave function must obey the correct symmetry under particle exchange , it should be flexible enough to describe the system of interest , and that it should be possible to evaluate it rapidly .",
    "the analytic properties and normalizability of the trial wave function must be such that the energy expectation value is well - defined .",
    "the simplest fermionic wave function is a slater determinant , which describes exchange but not correlation .",
    "multideterminant wave functions , pairing wave functions such as geminals @xcite , and backflow transformations @xcite can also be used .",
    "the most fruitful method of going beyond the slater determinant is , however , to multiply it by a jastrow factor @xcite , which leads to the slater - jastrow wave function .",
    "the jastrow factor is normally chosen to depend on the interparticle separations , which introduces correlation into the wave function .",
    "the introduction of a jastrow factor often leads to the recovery of 80% or more of the correlation energy of electronic systems @xcite .",
    "the jastrow factor is chosen to be everywhere positive and symmetric with respect to the exchange of identical particles in order to maintain the nodal surface defined by the rest of the wave function .",
    "one of the features of the jastrow factor is that it can conveniently be used to enforce the kato cusp conditions @xcite , which determine the behavior of the wave function when two charged particles approach one another .",
    "enforcing the kato cusp conditions does not necessarily improve the variational energy , but the reduction in the statistical fluctuations in the energy is often very important .",
    "dmc can be viewed as vmc with a perfect jastrow factor , but improving the jastrow factor can improve dmc calculations in several ways .",
    "the dmc algorithm is subject to time - step errors and to ( normally very small ) population - control errors @xcite that are reduced by improving the trial wave function . evaluating expectation values of operators",
    "that do not commute with the hamiltonian is not straightforward in dmc , but using highly accurate trial wave functions helps in achieving more accurate results .",
    "similar considerations apply when using nonlocal pseudopotentials , which involves making approximations that are ameliorated by improving the trial wave function @xcite .",
    "as the fundamental limitation on the accuracy of dmc is the quality of the nodal surface , it is desirable to use trial wave functions with optimizable nodal surfaces as afforded by , for example , multideterminant wave functions and backflow transformations .",
    "a good jastrow factor can account for the bulk of the dynamical correlation energy , which allows the optimization of parameters that affect the nodal surface to achieve a better nodal surface .    here",
    "we introduce a highly flexible form of jastrow factor which allows for the introduction of a variety of terms involving arbitrary numbers of particles .",
    "our main motivation is to be able to implement quickly different functional forms and explore the importance of different correlations in any physical system we study .",
    "jastrow factors correlating several electrons have been used in earlier calculations , such as those of refs .",
    "we study the effects of various three - body jastrow terms and introduce a four - body van der waals - like term .",
    "we also construct anisotropic jastrow factors that can capture the natural symmetries of a system .",
    "we have successfully applied these jastrow factors to a variety of systems , and we report results for the one- and two - dimensional homogeneous electron gases , the be , b , and o atoms , and the beh , n@xmath0 , h@xmath0o , and h@xmath0 molecules . our vmc and dmc calculations were performed using the casino package @xcite .",
    "hartree atomic units are used throughout ( @xmath1 ) .",
    "the structure of the paper is as follows .",
    "we describe the form and properties of the general jastrow factor in sec .",
    "[ sec : gjastrow ] .",
    "specific examples of the construction of jastrow terms are given in sec .",
    "[ sec : construction ] , and results obtained using them are presented in sec .  [",
    "sec : results ] . finally , we draw our conclusions in sec .  [",
    "sec : conclusions ] .",
    "implementation details are given in appendix  [ app : implementation ] , and an example can be found in appendix  [ app : example ] .",
    "we report only summaries of our data in this paper @xcite .",
    "quantum monte carlo ( qmc ) methods can be applied to systems which can be generically described as an ensemble of @xmath2 quantum particles and @xmath3 sources of external potential .",
    "the most common type of qmc simulations are electronic calculations , where the quantum particles are electrons and the sources of external potential are fixed nuclei ( or pseudopotentials ) . for simplicity",
    ", we refer to quantum particles as electrons and to external potentials as nuclei in the rest of this paper .",
    "our jastrow factor is applicable to other types of quantum particles and external potentials .",
    "any trial wave function can be written in the form @xmath4 where @xmath5 is the part of the wave function that imposes the symmetry and boundary conditions , and @xmath6 is a jastrow correlation factor which is constrained so that the symmetry and boundary properties of @xmath5 are transferred unmodified to @xmath7 . in the single - determinant ( sd )",
    "slater - jastrow wave function , @xmath5 is a slater determinant .",
    "there are various alternatives to slater determinants , with different advantages and disadvantages depending on the system .",
    "typically @xmath8 is constructed as a sum of terms , e.g. , @xmath9 where `` e  e '' stands for `` electron - electron , '' `` e  n '' for `` electron  nucleus , '' etc .",
    "each of these terms involves different numbers of electrons @xmath10 and nuclei @xmath11 .",
    "we shall refer to @xmath10 and @xmath11 as the electronic and nuclear ranks of a term , respectively , which are constrained to satisfy @xmath12 , @xmath13 , and @xmath14 .",
    "we have designed a generic jastrow term of selectable ranks , @xmath15 , such that the total jastrow factor is constructed as the exponential of a sum of one or more terms of the desired ranks . in this notation , @xmath16 , @xmath17 , etc .",
    "the function @xmath15 is a sum over all sets of @xmath10 electrons and @xmath11 nuclei in the system of a parameterized function of the e  e and e ",
    "n relative position vectors within each such set . while alternatives exist , a natural way of parameterizing this function for arbitrary values of @xmath10 and @xmath11 ( implying an arbitrary number of variables in the function ) is to expand it in products of functions of the individual e  e and e  n vectors .",
    "thus , we construct our jastrow factor using pairwise objects as building blocks , and in what follows we describe these objects and derive the properties of @xmath15 that follow from those of the pairwise objects .",
    "we name the e  e functions used in the expansion @xmath18 , where @xmath19 is the relevant e ",
    "e relative position vector , @xmath20 is the index of the function within a chosen basis of functions , and @xmath21 is the e  e dependency index , which allows the use of different optimizable parameters , if present , for parallel- and antiparallel - spin electron pairs , for example .",
    "similarly , the e ",
    "n basis functions are @xmath22 , where @xmath19 is the relevant e ",
    "n relative position vector , @xmath23 is the index of the function within the chosen basis set , and @xmath24 is the e  n dependency index of the basis set , which allows the use of different parameters for up- and down - spin electrons around a given nucleus , or for different atoms , for example . in the case of nonelectronic systems , e  e and e ",
    "n dependency indices are used to distinguish between particle types and spins .",
    "we introduce a compact notation for defining @xmath15 . we represent the @xmath10 electronic indices by the integer vector @xmath25 , each of whose components takes a distinct value between @xmath26 and @xmath2 , and the @xmath11 nuclear indices by the integer vector @xmath27 , each of whose components takes a distinct value between @xmath26 and @xmath3 . for each term in the jastrow factor we define the e  e and e ",
    "n dependency matrices @xmath28 and @xmath29 of respective sizes @xmath30 and @xmath31 containing the dependency indices @xmath32 and @xmath33 for each e  e and e ",
    "the components of @xmath28 and @xmath29 can be made equal depending on the symmetries of the system , including particle distinguishability and geometrical symmetries which make different nuclei equivalent .",
    "likewise , it is convenient to use matrices to represent the basis functions involved in the jastrow factor term . for e ",
    "e basis functions , each row and column of the @xmath34 matrix @xmath35 corresponds to an electron ,    @xmath36    we refer to the @xmath37 matrix formed by the e  e dependency indices @xmath38 as @xmath39 .",
    "both @xmath39 and the @xmath34 matrix of e  e expansion indices @xmath40 are defined to be symmetric , and this fact has been used in eq .",
    "( [ eq : def_phimat ] ) . noting that @xmath41 , and restricting the e  e functions to be either symmetric or antisymmetric about the origin , one finds in eq .",
    "( [ eq : def_phimat ] ) that matrix @xmath35 is symmetric , antisymmetric , or asymmetric depending on whether the functions in the basis set are all symmetric , all antisymmetric , or both types are present , respectively .    for e ",
    "n basis functions each row of the @xmath42 matrix @xmath43 corresponds to an electron and each column to a nucleus , @xmath44 we refer to the @xmath45 matrix formed by the e ",
    "n dependency indices @xmath46 as @xmath47 , and the @xmath45 matrix of e ",
    "n expansion indices is @xmath48 .",
    "we write @xmath49 as a sum of contributions from each group of @xmath10 electrons and @xmath11 nuclei in the system , @xmath50 where summations with vector indices represent sums in which every component of the vector is a summation index , and `` @xmath51 '' ( for `` sorted vector '' ) indicates that the sum is restricted to vectors whose components are sorted , e.g. , @xmath52 , which avoids redundant contributions @xcite . the contribution from the @xmath10-electron and @xmath11-nucleus",
    "group @xmath53 is @xmath54 where @xmath55 are the linear parameters , summations with matrix indices represent sums in which every component of the matrix is a summation index , @xmath56 acting on matrices implies the product of all of their components , and `` u.t . ''",
    "means that the relevant operation is restricted to the upper - triangular portion of the e ",
    "e matrices involved , excluding the diagonal .      equation ( [ eq : gjastrow_sum_of_core ] ) imposes the condition that @xmath57 must not depend on the specific ordering of the electrons and nuclei listed in @xmath58 and @xmath59 .",
    "let @xmath60 and @xmath61 be permutation matrices of respective sizes @xmath34 and @xmath62 such that @xmath63 and @xmath64 are integer vectors containing reordered electronic and nuclear indices . the value of @xmath65 should therefore equal that of @xmath57 ,    @xmath66   \\prod^{\\rm u.t . }",
    "{ { \\underline { \\phi}}}_{{\\underline { \\nu}}}^{{\\underline { \\rm p}}}({{\\bf i } } )   \\prod             { { \\underline { \\theta}}}_{{\\underline { \\mu}}}^{{\\underline { \\rm s}}}({{\\bf i}},{{\\bf i } } ) \\;,\\end{aligned}\\ ] ]    where @xmath67 =    \\frac{\\prod^{\\rm u.t.}{{\\underline { \\rm a}}}{\\,}{{\\underline { \\phi}}}_{{\\underline { \\nu}}}^{{\\underline { \\rm p}}}({{\\bf i}}){\\,}{{\\underline { \\rm a}}^{\\rm t } } }         { \\prod^{\\rm u.t.}{{\\underline { \\phi}}}_{{\\underline { \\nu}}}^{{\\underline { \\rm p}}}({{\\bf i } } ) } \\;,\\ ] ] which is @xmath68 for basis sets consisting only of symmetric functions , while in the presence of antisymmetric basis functions it may be @xmath68 or @xmath69 depending on the precise permutation performed by @xmath60 . equating the right - hand sides of eqs .",
    "( [ eq : gjastrow_core ] ) and ( [ eq : gjastrow_core_permute ] ) one finds that @xmath70 \\lambda_{{{\\underline { \\rm a}}}{\\,}{{\\underline { \\nu}}}{\\,}{{\\underline { \\rm a}}^{\\rm t } } ,           { { \\underline { \\rm a}}}{\\,}{{\\underline { \\mu}}}{\\,}{{\\underline { \\rm b}}^{\\rm t}}}^ {           { { \\underline { \\rm a}}}{\\,}{{\\underline { \\rm p}}}({{\\bf i}}){\\,}{{\\underline { \\rm a}}^{\\rm t } } ,           { { \\underline { \\rm a}}}{\\,}{{\\underline { \\rm s}}}({{\\bf i}},{{\\bf i}}){\\,}{{\\underline { \\rm b}}^{\\rm t } } } \\;.\\ ] ] this equation represents the basic symmetry property of the linear parameters of the jastrow factor , which implies that a parameter with a given set of superindices @xmath71 is determined by another parameter with a permuted set of superindices @xmath72 .",
    "this redundancy is removed by considering only one of the possible permutations of @xmath71 .",
    "we call this particular permutation of @xmath73 the signature of the group of particles @xmath53 , @xmath74 where the permutation matrices @xmath75 are computed by applying a matrix - sorting algorithm @xcite to @xmath71 . in our terminology , the set of linear parameters whose superindices reduce to the same signature constitute a parameter channel . only those parameters whose superindices equal the signature of a channel need be stored , and any other linear parameters in the channel can be computed from them via eq .",
    "( [ eq : lambda_symmetry ] ) .",
    "the signature @xmath76 may contain repeated entries such that there exist permutation matrices @xmath77 that leave the signature unchanged , @xmath78 in which case eq .",
    "( [ eq : lambda_symmetry ] ) becomes @xmath79 \\lambda_{{{\\underline { \\rm a}}}{\\,}{{\\underline { \\nu}}}{\\,}{{\\underline { \\rm a}}^{\\rm t } } ,           { { \\underline { \\rm a}}}{\\,}{{\\underline { \\mu}}}{\\,}{{\\underline { \\rm b}}^{\\rm t}}}^{{{\\underline { \\tilde { \\rm p}}}}({{\\bf i}}),{{\\underline { \\tilde { \\rm s}}}}({{\\bf i}},{{\\bf i } } ) } \\;.\\ ] ] equation ( [ eq : lambda_symmetry_invariant_signature ] ) is the symmetry constraint that relates linear parameters within a channel , which can be imposed as detailed in sec .",
    "[ sec : constraints ] .",
    "the components of @xmath40 and @xmath48 are the e  e and e ",
    "n expansion indices .",
    "we define the expansion indices so that they can each take any value between 1 and the e ",
    "e expansion order @xmath80 , and between 1 and the e ",
    "n expansion order @xmath81 , respectively .",
    "we factorize an optional cutoff function into @xmath82 and @xmath83 , so that @xmath84 for @xmath85 , and @xmath86 for @xmath87 , where @xmath88 and @xmath89 are the e  e and e ",
    "n cutoff functions and @xmath90 and @xmath91 are functions from a suitable basis set .",
    "this factorization allows an efficient implementation of localized jastrow factor terms .",
    "additionally , we allow expansion indices to take a value of zero with the special meaning that @xmath92 for all @xmath21 , @xmath24 , and @xmath19 .",
    "note that these 0-th functions do not contain cutoff functions .",
    "this allows us to construct terms with specialized functional forms , such as those involving dot products of vectorial quantities .",
    "constraints on the parameters can be expressed in the form of a system of equations involving the linear parameters and the basis function parameters .",
    "we restrict our analysis to linear constraints on the linear parameters , and constraints that can be imposed on the nonlinear parameters contained in a basis function independently from the linear parameters and from nonlinear parameters in other basis functions .",
    "linear constraints on the linear parameters can be imposed using gaussian elimination , as described in ref .",
    "the matrix of coefficients may depend on the nonlinear parameters in the basis functions , if present , and the linear system is usually underdetermined , resulting in a subset of the parameters being determined by the values of the remaining parameters , which can be optimized directly .",
    "when a constraint results in setting specific linear parameters to zero , it is more convenient simply to remove them from the list of linear parameters .",
    "this is accomplished by disallowing the indices @xmath40 and @xmath48 from taking the values corresponding to linear parameters .",
    "we call this an indexing constraint .",
    "symmetry constraints must always be imposed , otherwise the trial wave function is unphysical and calculations give erroneous results .",
    "symmetry constraints amount to equalities between pairs of parameters as per eq .",
    "( [ eq : lambda_symmetry_invariant_signature ] ) .",
    "when two of these equalities relate the same pair of parameters with opposite signs , e.g. , @xmath93 and @xmath94 , which implies @xmath95 , both parameters are eliminated using indexing constraints .",
    "the coulomb potential energy diverges when the positions of two electrons or an electron and a nucleus coincide .",
    "however , the local energy of an eigenstate of the hamiltonian , including the exact ground - state wave function , is finite and constant throughout configuration space .",
    "divergences in the local energy are therefore not a feature of the exact wave function and can lead to poor statistics in qmc calculations ; hence it is important to avoid them . the kinetic energy must diverge to cancel out the potential energy and keep the local energy finite , which is achieved by demanding that the wave function obeys the kato cusp conditions @xcite .",
    "for any two charged particles @xmath96 and @xmath97 in a two- or three - dimensional system , these are @xmath98 where @xmath99 denotes the spherical average of @xmath100 , @xmath81 represents charge , @xmath101 is the reduced mass , @xmath11 represents mass , @xmath102 is the dimensionality , and the positive sign in the denominator is for indistinguishable particles and the negative sign is for distinguishable particles .",
    "fixed nuclei are regarded as having an infinite mass .",
    "divergent interactions other than the coulomb potential would give rise to different expressions .    it is common practice to impose the e  n cusp conditions on @xmath103 and the e ",
    "e cusp conditions on the jastrow factor .",
    "this is because typical forms of @xmath103 explicitly depend on the e ",
    "n distances but not on the e ",
    "e distances .",
    "our implementation allows the option of applying both types of cusp conditions to the jastrow factor , which gives flexibility in the choice of @xmath103 and its properties . in particular",
    ", we impose the cusp conditions on a single jastrow factor term , and constrain all other terms in the jastrow factor so that their contribution to the local kinetic energy is finite at e  e and e ",
    "n coalescence points . for nondivergent interaction potentials , such as most pseudopotentials , we simply require that the kinetic energy remains finite at coalescence points .",
    "our implementation is also capable of not applying any constraints at e  e and e ",
    "n coalescence points since this is advantageous in some cases @xcite .",
    "imposing that the kinetic energy be finite at coalescence points is nontrivial if the jastrow factor contains anisotropic functions .",
    "consider the exponent of a jastrow factor @xmath104 near a point where two particles coalesce , be it two electrons or an electron and a nucleus .",
    "the dependence of @xmath104 on coordinates other than those of the coalescing particles should be smooth in the vicinity of the coalescence point , and therefore one should be able to write @xmath105 , where @xmath19 is the difference between the position vector of the two particles , and all remaining particles are held fixed .",
    "the local kinetic energy is computed from two estimators , one involving @xmath106 and the other @xmath107 .",
    "we require both quantities to remain finite as @xmath108 .",
    "we expand the jastrow factor in spherical harmonics , @xmath109 , with @xmath110 , and the gradient and laplacian of @xmath111 are @xmath112 @xmath113 y_{l , m}(\\theta,\\phi ) \\;.\\end{aligned}\\ ] ] let us assume that @xmath114 is finite at the origin and expand it to second order about @xmath115 , @xmath116 . substituting into eqs .",
    "( [ eq : def_grad_j ] ) and ( [ eq : def_lap_j ] ) , and ignoring contributions of @xmath117 or higher , we arrive at @xmath118 \\frac{\\partial y_{l , m}(\\theta,\\phi)}{\\partial \\theta } { \\bf u}_\\theta \\nonumber \\\\ & & +    \\left [      \\frac{f_{l , m}(0)}{r\\sin\\theta } +      \\frac{f_{l , m}^\\prime(0)}{\\sin\\theta }    \\right ] \\frac{\\partial y_{l , m}(\\theta,\\phi)}{\\partial \\phi } { \\bf u}_\\phi \\;,\\end{aligned}\\ ] ] @xmath119 y_{l , m}(\\theta,\\phi ) \\;.\\end{aligned}\\ ] ] the coefficient of the negative powers of @xmath120 in eqs .",
    "( [ eq : grad_j ] ) and ( [ eq : lap_j ] ) must vanish for @xmath121 and @xmath122 to be finite at the coalescence point .",
    "this gives rise to two conditions : ( a ) if @xmath123 then @xmath124 ; and ( b ) if @xmath125 then @xmath126",
    ".    application of the kato cusp or finite kinetic energy constraints requires the construction of a linear system for each linear - parameter channel in each term of the jastrow factor based on the above equations .",
    "let @xmath127 be an operator such that @xmath128 .",
    "the cusp equations associated with the coalescence of electrons @xmath96 and @xmath97 have the form @xmath129 }            { \\partial r_{ij } }    \\right]_{r_{ij}=0 } = \\gamma_{ij } \\;,\\ ] ] where @xmath130 is the right - hand side of eq .",
    "( [ eq : kato ] ) .",
    "the label `` @xmath131 '' ( for `` one contribution '' ) denotes that the sum is restricted to values of the @xmath40 sets such that the elements of the upper triangular portion of @xmath132 are all 1 except that corresponding to the electron pair formed by @xmath96 and @xmath97 , and the label `` @xmath133 '' ( for `` no contribution '' ) denotes that the sum is restricted to values of @xmath48 such that all elements of @xmath134 are 1 .",
    "these restrictions are trivially satisfied by e",
    " e terms .",
    "parameters that do not contribute to eq .",
    "( [ eq : ee_cusp ] ) should be set by the condition that the kinetic energy does not diverge at e ",
    "e coalescence points , resulting in @xmath135      \\right]_{r_{ij}=0 } = 0 \\;,\\ ] ] for @xmath123 , and @xmath136 }            { \\partial r_{ij } }    \\right]_{r_{ij}=0 } = 0 \\;,\\ ] ] for @xmath125 .",
    "the anisotropy of @xmath137 at @xmath138 determines which of eqs .",
    "( [ eq : ee_noaniso ] ) and eqs .",
    "( [ eq : ee_nocusp ] ) need be imposed . the label @xmath139 ( for `` equal - product '' ) denotes that the sum is only over indices associated with electrons @xmath96 and/or @xmath97 , and these indices take only values such that the product of the pair of functions associated with @xmath140 and @xmath141 ( @xmath142 and @xmath143 in the e ",
    "n case ) is equal throughout the sum .",
    "each set of distinct two - function products and each value of @xmath144 correspond to different equations , and each set of possible values of the indices not summed over corresponds to a separate set of equations .    for the coalescence of electron @xmath96 and nucleus @xmath145",
    "the cusp conditions take the form @xmath146 }            { \\partial r_{ii } }    \\right]_{r_{ii}=0 } = \\gamma_{ii } \\;,\\ ] ] while the kinetic energy is kept finite if @xmath147    \\right]_{r_{ii}=0 } = 0 \\;,\\ ] ] for @xmath123 and @xmath148 }            { \\partial r_{ii } }    \\right]_{r_{ii}=0 } = 0 \\;,\\ ] ] for @xmath125 .",
    "the equal - product constraint on the sum is now such that the sum is only over e ",
    "e indices associated with electron @xmath96 and e ",
    "n indices associated with nucleus @xmath145 , and these indices only take values such that the product of the pair of functions associated with @xmath140 and @xmath149 is equal throughout the sum . again , each set of distinct two - function products corresponds to a different equation , and each set of possible values of the indices not being summed over corresponds to a separate set of equations .",
    "note that the equal - product constraints in the sums of eqs .",
    "( [ eq : ee_cusp ] ) and ( [ eq : en_cusp ] ) reduce to the equal - product constraints described for the e ",
    "n @xmath150 term of the drummond - towler - needs ( dtn ) jastrow factor in the appendix of ref .",
    "@xcite when natural - power basis functions are chosen .",
    "it is possible to construct terms containing dot products by using appropriate constraints .",
    "for example , consider the basis functions @xmath151 , @xmath152 , and @xmath153 . in an e ",
    "n term we can restrict the indices so that @xmath48 takes only the values @xmath154 , @xmath155 , @xmath156 , so that the contribution of electron @xmath96 and nuclei @xmath145 and @xmath104 is @xmath157 , provided we also apply a linear constraint that equates the three nonzero linear coefficients .",
    "section [ subsec : specific_terms ] gives a practical example of a term containing dot products , which is used in sec .",
    "[ subsec : h2_mol ] .",
    "it is also possible to introduce boys - handy - style indexing , @xcite where the sum of all e  e and e ",
    "n indices is restricted to be less than or equal to some fixed integer @xmath158 .",
    "this is accomplished by setting the e  e and e ",
    "n expansion orders to @xmath158 and then eliminating the parameters that violate the conditions via indexing restrictions .",
    "possibly the simplest basis set is the natural powers , @xmath159 as used in the dtn jastrow factor for the localized @xmath160 , @xmath161 , and @xmath150 terms @xcite .",
    "these functions need to be cut off at some radius @xmath162 , for which purpose the dtn jastrow factor uses the polynomial cutoff function @xmath163 where @xmath162 is an optimizable parameter , @xmath164 is a positive integer , and @xmath165 is the heaviside step function .",
    "we also use a slightly different version of this cutoff function , @xmath166 which should be numerically superior to @xmath167 .",
    "a particular variant of @xmath168 is the anisotropic cutoff function @xmath169^{p^{(i)}_\\beta } \\;,\\ ] ] where @xmath162 is an optimizable parameter , @xmath164 is a positive integer , @xmath102 is the dimensionality of the system , @xmath170 are unit vectors along @xmath102 orthogonal directions , @xmath171 are real - valued constants , and @xmath172 are integer exponents , which are constrained so that @xmath173 is the same for all values of @xmath96 . this cutoff function is simply the product of an isotropic cutoff function and a spherical harmonic . for example , with @xmath174 , @xmath175 , @xmath176 , and @xmath177 , and the vectors pointing along the cartesian axes , we obtain @xmath178 \\;,\\ ] ] which is proportional to a real spherical harmonic with @xmath179 .",
    "the advantage of describing anisotropy in the cutoff function rather than in the basis functions is that the common spherical harmonic can be factorized out of the sum over expansion indices , which reduces the computational cost .",
    "we allow different orientations to be used for different e ",
    "n dependency indices , which is useful to adapt the functional form to , e.g. , the geometry of a molecule .",
    "an alternative to the natural - power basis in finite systems is a basis of powers of fractions which tend to a constant as @xmath180 , and therefore do not need to be cut off .",
    "we define the basis @xmath181 where @xmath182 and @xmath183 are real - valued optimizable parameters .",
    "similar basis sets with @xmath184 have been used in the literature , often in conjunction with boys - handy - style indexing @xcite , and this basis was used in ref .",
    "@xcite with an early implementation of the jastrow factor presented here .    in extended systems",
    "it is important to use a basis that is consistent with the geometry of the simulation cell and has the periodicity of the system , such as a cosine basis , @xmath185 where the @xmath186 vectors are arranged in stars defined by the cell geometry .",
    "this basis is used in the dtn jastrow factor for the extended @xmath80 and @xmath81 terms .    a suitable basis set for building specialized terms containing dot products",
    "is @xmath187 }      \\frac { { \\bf r } \\cdot { \\hat{\\bf u}_{{\\rm mod}\\left(\\nu-1,d\\right)+1 } } }            { r } \\;,\\ ] ] where @xmath102 is the dimensionality of the system and @xmath188 are unit vectors parallel to the @xmath102 cartesian axes",
    ". a term constructed using these functions with appropriate index - restriction constraints would consist of dot products between two vectors multiplied by a natural - power expansion in their moduli .",
    "we employ a condensed notation to refer to jastrow terms that use certain basis functions , cutoff functions and constraints .",
    "each term is represented by a single capital letter , with @xmath10 and @xmath11 as subindices .",
    "any other relevant information is given as a superindex .",
    "typically we use expansion orders @xmath80 and @xmath81 of 79 for two - body terms , 45 for three - body terms , and 23 for four - body terms , except when indicated otherwise .    for simple jastrow terms we use the natural power basis functions @xmath189 and the polynomial cutoff functions @xmath21 or @xmath190 .",
    "we refer to these terms as @xmath191 .",
    "@xmath192 , @xmath193 , and @xmath194 are the equivalent of the dtn @xmath160 , @xmath161 , and @xmath150 terms , respectively . in the @xmath194 term , and in any term where more than one electron and one or more nuclei are involved , we choose not to apply e ",
    "e cutoff functions , relying instead on the e ",
    "n cutoffs to fulfill this role .",
    "additional @xmath191 terms used in this paper that were not part of the dtn jastrow factor are @xmath195 , @xmath196 , @xmath197 , @xmath198 , @xmath199 , and @xmath200 . in @xmath191",
    "we typically use a truncation order in the cutoff function of @xmath201 .",
    "we use @xmath202 to refer to the anisotropic variant of @xmath191 .",
    "the @xmath202 term consists of natural power basis functions @xmath189 and the anisotropic cutoff function @xmath203 , and `` @xmath204 '' is a placeholder for describing the spherical harmonic . for example , for the highly anisotropic n@xmath205 molecule we use terms such as @xmath206 , @xmath207 , @xmath208 , and @xmath209 .    in finite systems we also use the @xmath210 basis functions in terms without explicit cutoff functions which we call @xmath211 , or @xmath212 when we force @xmath184 in the basis functions . in some systems",
    "it is useful to apply boys - handy - style indexing to @xmath212 , and we refer to the resulting term as @xmath213 .    in extended systems we make",
    "use of the cosine basis functions @xmath214 in terms denoted @xmath215 , where we choose expansion orders so that at least as many @xmath216 vectors as electrons in each spin channel are included in the expansion .    to test the flexibility of our implementation we have designed an e  e  n  n jastrow term for describing the correlations associated with van der waals interactions , which we call @xmath217 .",
    "this term is capable of distinguishing between configurations where the electron - nucleus relative position vectors @xmath218 and @xmath219 are parallel from those where they are antiparallel . introducing",
    "a dot product achieves this effect , and @xmath217 has the following functional form , @xmath220 we require basis functions to be scalars in our jastrow factor , so the dot product is separated into its components .",
    "hence , we construct the @xmath217 term using @xmath221 for the e ",
    "n basis with @xmath21 as the e ",
    "n cutoff functions , and @xmath189 for the e  e basis .",
    "we allow e ",
    "n indices to be zero , and apply a number of constraints on the linear parameters : ( a ) we eliminate all index sets except those in which the e ",
    "n indices are of the form @xmath222 or @xmath223 , with @xmath224 ; ( b ) we eliminate all parameters that do not satisfy @xmath225 ; ( c ) we equate any two linear parameters @xmath226 and @xmath227 if the zeros of @xmath228 and @xmath229 are in the same position and their nonzero components satisfy @xmath230 = { \\rm int}\\left[(k_2 - 1)/3\\right]$ ] and @xmath231 = { \\rm int}\\left[(l_2 - 1)/3\\right]$ ] .",
    "these constraints are applied in addition to the generic symmetry and cusp constraints .",
    "table  [ tab : notation ] summarizes the notation for the terms we have introduced .",
    "[ cols=\"<,<,<,<\",options=\"header \" , ]     ref .",
    "@xcite .    ref .",
    "@xcite .    ref .",
    "@xcite ( using a slightly different bond length ) .    ref .",
    "we have described a generalized jastrow factor allowing terms that explicitly correlate the motions of @xmath10 electrons with @xmath11 static nuclei .",
    "these terms can be parameterized using various basis sets , including terms that involve dot products of interparticle position vectors .",
    "we have also introduced anisotropic cutoff functions . the formalism may be applied to systems with particle types and external potentials other than electrons and coulomb potentials .",
    "optimization of the wave function is one of the most human- and computer - time consuming tasks in performing qmc calculations .",
    "we have performed term - by - term optimizations to understand how different terms in the jastrow factor contribute to the electronic description of a system , and we hope that our analysis will serve as a guideline for constructing jastrow factors for other systems .",
    "we have tested these terms on hegs , atoms , and molecules .",
    "the variational freedom from the higher - order terms generally improves the quality of the wave function .",
    "we have only considered single - determinant wave functions in this study , although our jastrow factor can of course be used with other wave function forms .",
    "we have demonstrated the construction and application of an e  e  n",
    " n jastrow factor term designed to describe van der waals interactions between atoms .",
    "this term retrieves a large fraction of the van der waals correlation energy in tests on the triplet state of h@xmath0 at the proton separation that minimizes the total energy of the system .",
    "we have found evidence for the importance of three - electron jastrow terms in the low - density 1d and 2d hegs .",
    "improving the jastrow factor for single - determinant backflow wave functions also leads to small improvements in the dmc energy of the 2d heg .",
    "this demonstrates the indirect effect that improving the jastrow factor can have on improving the nodal surface , as reported in ref .",
    "@xcite .",
    "we have made efforts to obtain accurate single - determinant vmc energies for most of the systems studied , but for beh and n@xmath0 we deliberately used inferior one - electron basis sets to see whether we could compensate for this with one - electron jastrow terms .",
    "we find that this goal can be achieved by including an @xmath195 jastrow term or anisotropic e ",
    "n terms , along with the usual @xmath193 term .",
    "we thank john trail for producing the hf wave function for h@xmath0 .",
    "the calculations were performed on the cambridge high performance computing service facility .",
    "in this section we describe our design choices in implementing our jastrow factor in the casino code @xcite .",
    "the implementation principles are modularity and extensibility , embracing the flexibility that this jastrow factor has by design rather than impeding it by focusing too strictly on performance .",
    "the most important design requirement for modularity is that basis sets be dealt with separately rather than included in the jastrow factor code .",
    "basis functions , along with their derivatives when required , are evaluated and stored for later use . for any given term with expansion orders @xmath80 and @xmath81",
    "there are @xmath232 e  e and @xmath233 e  n functions to evaluate and store .",
    "single - electron updates involve recalculating @xmath234 and @xmath235 of these functions .",
    "note that the number of basis functions that must be evaluated is independent of the term ranks @xmath10 and @xmath11 .",
    "furthermore , it is possible to allow different terms to share basis functions that do not contain optimizable parameters so that , e.g. , the natural powers involved in computing @xmath192 and @xmath193 can be re - used for @xmath194 .",
    "a number of properties of the basis functions are required to construct the jastrow factor .",
    "equation ( [ eq : lambda_symmetry_invariant_signature ] ) requires knowledge of whether basis functions are symmetric or antisymmetric , and their value , first radial derivative , and angular dependency at the origin are required by eqs .",
    "( [ eq : ee_cusp ] ) , ( [ eq : ee_noaniso ] ) , ( [ eq : ee_nocusp ] ) , ( [ eq : en_cusp ] ) , ( [ eq : en_noaniso ] ) , and ( [ eq : en_nocusp ] ) .",
    "the one - contribution , no - contribution , and equal - product constraints in these equations require a table indexing distinct products of two basis functions at any value of their arguments .",
    "we implement interfaces that make these properties avaliable so that basis functions can be treated as abstract objects in the construction of the jastrow factor , which makes implementing new basis sets straightforward .",
    "cutoff functions are dealt with as additional basis sets with an expansion order of one , and we store information identifying the cutoff functions that are strictly zero , which we use to speed up evaluation of the jastrow factor .      for the evaluation of an arbitrary - rank jastrow factor term it is necessary to use efficient procedures that iterate from a given set of electronic and nuclear indices @xmath58 and @xmath59 to the next in a specific order ; explicit loops over scalar integer indices are not an option in static code since the loop depth is variable , and the memory usage of precomputing all possible @xmath58 and @xmath59 scales badly with system size for high ranks @xmath10 and @xmath11 .",
    "these procedures should take into account which cutoff functions are zero so that particle sets that do not contribute to the jastrow factor are skipped .",
    "efficient handling of localized jastrow factor terms is important because it allows the cost of evaluating a term of any rank to scale linearly with system size if the cutoff lengths are held fixed .",
    "we implement a scheme where we construct a list of the electrons that are `` connected '' to each electron and each nucleus via nonzero cutoff functions . for the electronic indices ,",
    "the value of @xmath236 is iterated between @xmath26 and @xmath2 , then the value of @xmath237 is iterated over the values in the list associated with electron @xmath236 that are greater than @xmath236 , then the value of @xmath238 is iterated over the values in the intersection between the lists associated with @xmath236 and @xmath237 that are greater than @xmath237 , and so on .",
    "the procedure that iterates over nuclear indices selects sets of nuclei whose connected - electron lists have nonzero intersections .",
    "we iterate over @xmath59 in the outermost loop so that we can feed the intersection of all e ",
    "n lists into the @xmath58 iterator as an initial list for index @xmath236 .",
    "the signature @xmath239 of each group of particles is computed inside the electronic and nuclear loops , identifying the linear parameter channel associated with the group of particles .",
    "we then loop over linear parameters in the channel , computing the products of the relevant basis functions which have already been precomputed . in terms without indexing constraints , consecutive linear parameters tend to have very similar expansion indices , i.e. , they multiply most of the same basis functions . in order to save multiplications , it is convenient to buffer partial products so that , e.g. , if only the last two of six expansion indices change from one parameter to the next , we can recover the product of the first four functions from the previous index set and save three of the five multiplications required to combine the six basis functions .    in typical qmc calculations",
    "individual electron moves , rather than full configuration moves , are proposed , which requires computing an acceptance probability involving the ratio of the trial wave function at the proposed and original positions . to calculate this",
    "efficiently one needs to compute the part of the jastrow factor which depends on the position of a single particle @xmath96 , ignoring the contributions not involving @xmath96 . in our implementation",
    "we evaluate this one - electron jastrow factor using eq .",
    "( [ eq : gjastrow_sum_of_core ] ) , where we fix @xmath240 and iterate over the rest of @xmath58 .",
    "the main difference from the evaluation of the full jastrow factor is that @xmath58 is not sorted , and the permutation required to sort @xmath58 , which amounts to inserting @xmath96 at the correct position in @xmath58 , needs to be taken into account in the presence of antisymmetric e ",
    "e basis functions , since sign changes will be required by eq .",
    "( [ eq : lambda_symmetry_invariant_signature ] ) .",
    "the evaluation of gradients and laplacians of the jastrow factor term can be easily accommodated in the one - electron jastrow evaluation code .    for performance reasons it is advisable to implement versions of the evaluation procedure for fixed ranks , with fixed - depth loops that can be optimized by compilers .",
    "we implement three optimized versions : one for e  e terms , one for e ",
    "n terms , and one for e  e ",
    "other terms are handled by three generic procedures : one for terms without e  e functions , one for terms without e  n functions , and one for terms with both e  e and e ",
    "n functions .",
    "let us consider the @xmath196 term used for the 2d heg in section  [ subsubsec:2dheg ] .",
    "this is a system with @xmath241 electrons , half of each spin , and the @xmath196 term corresponds to @xmath242 , @xmath243 , expansion order @xmath244 , and basis functions @xmath245 the spin - pair dependency matrix @xmath28 is of size @xmath30 , but in practice we specify a reduced @xmath246 version of this matrix where each row ( column ) corresponds to different spins . for this system",
    "this matrix is @xmath247 where we assign parallel - spin electron pairs a spin - pair dependency index of 1 , and antiparallel - spin electron pairs an index of 2 .",
    "the @xmath28 matrix can be regarded as an intrinsic property of the system , but in some cases additional symmetries can be imposed in order to reduce the number of parameters in the jastrow factor term ; for example we would achieve this by setting all elements of @xmath28 to 1 in the 2d heg , choosing to ignore the distinction between parallel- and antiparallel - spin electron pairs .",
    "the elements in @xmath28 determine pairwise properties and objects .",
    "for example , there are as many sets of nonlinear parameters in a jastrow factor term as different values in @xmath28 ; in this case , there are two cutoff lengths , @xmath248 for parallel - spin electron pairs and @xmath249 for antiparallel - spin electron pairs .",
    "four distinct types of three - electron groups can be formed : three up - spin electrons ( @xmath250 ) , two up - spins and one down - spin ( @xmath251 ) , one up - spin and two down - spins ( @xmath252 ) , and three down - spin electrons ( @xmath253 ) .",
    "the spin - pair dependency matrices for these four groups are @xmath254 @xmath255 the matrices @xmath256 and @xmath257 are identical , and therefore correspond to a linear parameter channel which is used for groups of three electrons with parallel spins . the matrix @xmath258 can be transformed into @xmath259 via , e.g. , the permutation matrix @xmath260 and therefore both matrices correspond to a second linear parameter channel which is used for groups of three electrons with mixed spins .",
    "the signature of the first channel , which we refer to as the @xmath250 channel , is @xmath256 , and the signature of the @xmath251 channel is @xmath259 .",
    "both of these matrices are considered sorted by our matrix - sorting algorithm .",
    "the symmetry constraints for the parameters in each of the two channels depend on the above matrices .",
    "@xmath256 is invariant with respect to the application of any permutation , and for the @xmath250 channel eq .",
    "( [ eq : lambda_symmetry_invariant_signature ] ) equates any two parameters with the same indices in a different order .",
    "the signature of the @xmath251 channel is only invariant with respect to one nontrivial permutation , @xmath261 and therefore the symmetry constraints for this channel are @xmath262    we do not allow expansion indices to be zero in the @xmath196 term , and the presence of cutoff functions prevents the `` one contribution '' constraint of eq .",
    "( [ eq : ee_cusp ] ) from being satisfied .",
    "it is therefore not possible to impose the kato cusp conditions on the @xmath196 term .",
    "this is not a problem in practice because we use this term in conjunction with @xmath192 .    since the basis functions are isotropic , the only constraint applicable to this term at coalescence points is eq .",
    "( [ eq : ee_nocusp ] ) for @xmath263 .",
    "the derivative of the radial projection of the basis function is @xmath264 }          { \\partial r } \\right]_{r=0 } = \\delta_{\\nu 2 } - \\delta_{\\nu 1 } \\frac{c}{l_p } \\;,\\ ] ] and the constraint equation for index @xmath265 is @xmath266 = 0 \\;.\\ ] ] any two products of pairs of natural powers is equal if the sum of the exponents in each of them is equal .",
    "therefore the `` equal - product '' constraint for the @xmath196 term is @xmath267 where @xmath158 ranges from 2 to @xmath268 , and the constraint equation for index @xmath265 thus reduces to                                          for example , @xmath270 contains @xmath271 terms , but if @xmath272 , this operation can be simplified to @xmath273 , which contains @xmath274 terms .",
    "in general , the sum of an object which is symmetric with respect to the interchange of any of its @xmath10 indices , where these indices take nonrepeated values , can be rewritten as a sum over sorted sets of indices involving @xmath275 times fewer terms than the original sum .    given a symmetric @xmath37 matrix @xmath29 and a rectangular @xmath42 matrix @xmath28",
    ", this algorithm finds the permutation of these matrices , @xmath276 and @xmath277 , that correspond to the lowest collational order according to a predefined sorting criterion .",
    "the specifics of such criterion are unimportant ; the only requirement is that for any @xmath37 permutation matrix @xmath60 and @xmath278 permutation matrix @xmath61 , the application of the algorithm to the pair of matrices @xmath279 and @xmath280 also returns @xmath281 and @xmath282 .",
    "r.  dovesi , v.  r.  saunders , c.  roetti , r.  orlando , c.  m.  zicovich - wilson , f.  pascale , b.  civalleri , k.  doll , n.  m.  harrison , i.  j.  bush , p.  darco , and m.  llunell , _",
    "crystal06 user s manual _ , university of torino ( 2006 ) ."
  ],
  "abstract_text": [
    "<S> we have developed a flexible framework for constructing jastrow factors which allows for the introduction of terms involving arbitrary numbers of particles . </S>",
    "<S> the use of various three- and four - body jastrow terms in quantum monte carlo calculations is investigated , including a four - body van der waals - like term , and anisotropic terms . </S>",
    "<S> we have tested these jastrow factors on one- and two - dimensional homogeneous electron gases , the be , b , and o atoms , and the beh , h@xmath0o , n@xmath0 , and h@xmath0 molecules . </S>",
    "<S> our optimized jastrow factors retrieve more than 90% of the fixed - node diffusion monte carlo correlation energy in variational monte carlo for each system studied . </S>"
  ]
}