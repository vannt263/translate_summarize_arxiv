{
  "article_text": [
    "urban air pollution is a complex mixture of toxic components with considerable impact on the inhabitants of urban regions , particularly those belonging to sensitive groups , such as children and people with previous heart and respiratory insufficiency@xcite .",
    "therefore , forecasting the temporal evolution of air pollution concentrations in specific urban locations emerges as a priority for guaranteeing life quality in urban and metropolitan centers . with this aim , in order to identify and predict in advance episodes of low air quality at regional and local scales , air quality forecasting models have been developed , considering the characteristics of atmospheric pollution and its consequent impact on people s health and life quality .",
    "measurement stations in the region of lisbon ( portugal ) at the southwestern coast of europe . in this paper",
    "we focus on the set of measurements taken at the stations of chelas and avenida da liberdade , approximately @xmath0 km distant apart , with approximately @xmath1 data points .",
    "each data set is extracted within the period between 2002 and 2006 , with a frequency of @xmath2 hour@xmath3.,scaledwidth=50.0% ]    straightforward approaches such as box models@xcite , gaussian plume models@xcite , persistence and regression models@xcite are commonly applied to characterize and forecast air pollutants dispersion .",
    "these models are easy to implement and allow for the rapid calculation of forecasts .",
    "however , they include significant simplifications@xcite and usually do not describe the processes and interactions that control the transport and chemical behavior of pollutants in the atmosphere@xcite , important for instance for secondary pollutants@xcite .",
    "improvements have been made with deterministic dispersion models and statistical - based approaches , which however , being highly non",
    " linear@xcite , require a large amount of accurate input data and are considerably expensive from the computational point of view@xcite .    a promising alternative to all these models are artificial neural networks ( ann)@xcite .",
    "several ann models have already been used for air quality forecast , in particular for forecasting hourly averages@xcite and daily maxima@xcite .",
    "further , several authors compared already the potential of different approaches when applied to different pollutants and prediction time lags@xcite .",
    "still , though successful in many situations and having considerably less restrictions on the input data , large training data sets are usually required to improve accuracy and minimize uncertainty in the output data , which up to now has been a significant disadvantage of these models .",
    "recently , we applied methods from stochastic data analysis and statistical physics for deriving variables with reduced stochastic fluctuations@xcite to empirical data in sets of no@xmath4  concentration measurements@xcite .",
    "such methods were introduced in the late nineties@xcite for analyzing measurements on complex stochastic processes , aiming for a quantitative estimation of drift and diffusion functions from sets of measurements that fully define the evolution equation of the underlying stochastic variables .",
    "the framework has already been applied successfully , for instance to describe turbulent flows@xcite and the evolution of climate indices@xcite , performance curves of wind turbines@xcite , stock market indices@xcite , and oil prices@xcite . at the same time",
    ", the basic method has been refined in particular for data with low sampling frequency@xcite and subjected to strong measurement noise@xcite .",
    "in this paper we present an important application of such variables : using them as input for training ann enables one to reduce considerably the amount of input data needed for achieving a given accuracy .",
    "we argue that this reduction in the number of input variables is possible because the derived variables incorporate temporal correlations between independent and spatially separated monitoring stations .",
    "moreover , as we quantitatively show below , when using this reduced amount of information that includes the derived variables , the predictive power of the ann is not significantly changed , which is a major advantage when working with observational data which might include missing values . combining a faster ann training with the same predictive power may improve the ability and capability of alert system for air quality in large urban centers .",
    "we start in sec .",
    "[ sec : methods ] by briefly describing ann models as well as the main points of the stochastic data analysis procedure used . in sec .",
    "[ sec : data ] the empirical data is described , comprising two different data sets of no@xmath4  concentration measures in the city of lisbon , portugal ( see fig .",
    "[ fig1 ] ) . in sec .",
    "[ sec : results ] the results are discussed in the light of predictive power measures , and sec .  [ sec : conclusions ] concludes the paper .",
    "artificial neural network models are mathematical models inspired by the functioning of nervous systems@xcite , which are composed by a number of interconnected entities , the artificial neurons ( see fig .",
    "[ fig2 ] ) .    these neurons may be associated in many different ways@xcite , depending on the characteristics of the proposed problem . to construct an ann model the air pollution system is considered as a system that receives information from @xmath5 distinct sets of inputs @xmath6 ( @xmath7 ) , namely weather parameters and air pollution properties , and produces a specific output , in our case the concentration of the no@xmath4  pollutant@xcite .",
    "no prior knowledge about the relationship between input and output variables is assumed .",
    "the input variables should be independent from each other and each one is represented by its own input neuron @xmath7 .",
    "each neuron computes a linear combination of the weighted inputs @xmath8 , including a bias term @xmath9 , from the links feeding into it and the corresponding summed value @xmath10 is transformed using a function @xmath11 , either linear or non - linear such as log - sigmoid or hyperbolic tangent . the bias term is included in order to allow the activation functions to be offset from zero and it can be set randomly or set to a desired value ( e.g. dummy input with a magnitude equal to 1 ) .",
    "the output obtained is then passed as a new input @xmath12 to other nodes in the following layer , usually named hidden layer . though one is allowed to use several neurons in this hidden layer , it is generally advantageous to somehow minimize the number of hidden neurons , in order to improve the generalization capabilities of the model and also to avoid over - fitting .",
    "in particular , a simple one - layer ann structure with just one neuron employing a linear activation function reduces to the well - known linear regression model@xcite .",
    "the ann models used here are based on a feed - forward configuration of the multilayer perceptron that has been used by several authors @xcite .",
    "a large number of architectures has been tested .",
    "the use of two layers was verified to be sufficient .",
    "the use of more layers was concluded to be redundant , and therefore we only use two layers , one input layer and one hidden layer .",
    "represent the input variables ( neurons ) , @xmath13 the weights associated to each neuron and @xmath14 the bias vectors which combined will produce an output within certain error limits.,scaledwidth=50.0% ]    having such a framework of input variables and sets of functions , the ann has to be trained in order to obtain the best estimate for each weight @xmath13 .",
    "the weight values are determined by an optimization procedure , the so - called learning algorithm@xcite , which in our case uses a cross - validation procedure@xcite to ensure stability of the model .",
    "the cross - validation was applied dividing the available period into four sets and completing the calibration - validation procedure four times independently , i.e. , from the 4 years of data available , data from 3 years were used to build the model and data from 1 year for validation .",
    "the validation year",
    "was then cycled through the 4 year period . for each validation year , a set of performance measures were computed between the observed real values and the ann forecasts , namely , the pearson correlation coecient ( pc ) ; the root mean square error ( rmse ) ; and the skill against persistence ( sp ) . the outcomes of each resulting performance measure were analyzed for each year and then averaged for the complete period , resulting on an average value for each monitoring station .",
    "there are several learning algorithms , depending on whether the ann model is linear or non - linear . for linear ann models ,",
    "the learning algorithm is typically based on the widrow - hoff learning - rule , also known as the least mean square rule , which produces a unique solution corresponding to the absolute minimum value of the error surface@xcite .",
    "for non - linear models , the back - propagation ( bp ) is one of the most popular and common training procedures used , which is described in depth in the literature @xcite .",
    "it has been shown in literature that bp training algorithms have two caveats : convergence may be slow and the final weights may be trapped in local minima over the highly complex error surface @xcite . as an alternative , the levenberg - marquardt method@xcite minimizes an error function in `` damped '' procedures , i.e.  selecting steps proportional to the gradient of the error function .",
    "the levenberg - marquardt method requires more memory @xcite than the widrow - hoff rule , but has the advantage of converging faster and with a higher effective robustness than most bp schemes@xcite because it avoids having to compute second - order derivatives .",
    "the levenberg - marquardt method was appliedfor this study . together with the persistence model , which is the simplest way of producing a forecast and assumes that the conditions at the time of the forecast will not change , i.e. , the forecast for each time step simply corresponds to the value of the previous time step , the linear regression model constitutes the baseline against which the performance of non - linear ann models are usually compared .",
    "due to a certain level of memory that characterizes air pollutants , persistence corresponds to a benchmark model considerably more difficult to beat than climatology @xcite .      in this section",
    "we briefly describe how from a number @xmath15 of sets of measurements , one is able to derive a set of few stochastic variables containing information from all of them .",
    "this procedure assumes that corresponding to each measurement variable there is a property that evolves according to some stochastic equation .",
    "more precisely , the @xmath15-dimensional state vector @xmath16 characterizes the set of @xmath15 measurements at each time - step and evolves according to the it - langevin equations@xcite : @xmath17 where @xmath18 is a set of @xmath15 independent stochastic forces with gaussian distribution fulfilling @xmath19 and @xmath20 . on the right hand side of eq .",
    "( [ lang2dvect ] ) the term with function @xmath21 describes the determinist part , which drifts the system , while the term with @xmath22 account for the amplitude of the stochastic contributions characterized through the properties of @xmath23@xcite .",
    "the heart of the method lies in the fact that the coefficients @xmath24 and @xmath25 are closely related to the drift vectors and diffusion matrices describing the evolution of the joint probability density function of the vector state @xmath26 by means of the corresponding fokker - planck equation@xcite .",
    "as has been shown previously in other contexts@xcite , the drift vector and the diffusion matrix can therefore be extracted directly from the data set @xmath27@xcite    @xmath28    [ defcoefkm ]    for @xmath29 and where @xmath30 symbolizes conditional averaging over all measurements @xmath31 that fulfill the condition @xmath32 .    the last equation in both eqs .",
    "( [ m1 ] ) and ( [ m2 ] ) yields the operational definition of the first and second conditional moments@xcite , respectively .",
    "the limit in eq .",
    "( [ defcoefkm ] ) is typically approximated by the slope of a linear fit of the corresponding conditional moments at small @xmath33 .",
    "when this linear fit is not possible , as it is the case for the no@xmath4   measurements under consideration , an alternative estimate@xcite is to consider the first value of @xmath34 at the lowest value of @xmath33 .",
    "additional analysis has been carried out@xcite , namely confirming the markovian properties of the data sets , which is a prerequisite for assuming a langevin process , eq .  .",
    "in case markovian properties are not observed , it should be noted that this method may be still applied with alternative procedures@xcite .",
    "furthermore , in case a fourier spectrum shows periodicities , those should be filtered out by a proper detrending procedure .",
    "more details about how to apply eqs .",
    "( [ defcoefkm ] ) can be found in ref .",
    "@xcite .",
    "we apply this framework to the two - dimensional system of detrended no@xmath4   concentration measurements taken in two stations in lisbon situated in chelas and avenida da liberdade .",
    "we consider therefore a vector @xmath35 .",
    "both sets of measurements do exhibit markovian properties@xcite , and therefore both drift and diffusion functions are properly derived .    to arrive to the optimal variables , we next determine the eigensystem of the diffusion matrix and investigate its principal directions@xcite .",
    "these principal directions are computed for each mesh point previously defined in phase space@xcite .",
    "the aim is to obtain the transform of the original coordinates @xmath36 into new ones @xmath37 , such that the the diffusion matrix is diagonalized .",
    "the transformation @xmath38 is a two - times continuously differentiable function . in general ,",
    "the eigenvalues of the diffusion matrix indicate the amplitude of the stochastic force and the corresponding eigenvector indicates the phase space direction towards which such force acts .    in this way",
    ", the stochastic contribution is decoupled for each new variable .",
    "consequently , if the eigenvalues in the transformed coordinates are significantly different , we are able to restrict our investigation to the coordinates with lower stochastic sources , i.e.  lower eigenvalues . for such eigenvalues ,",
    "the vector field of their eigenvectors defines the path in phase space towards which the fluctuations are minimal . additionally ,",
    "if these @xmath39 eigenvalues are very small compared to all the others , the corresponding stochastic forces can be neglected and the system can be assumed to have only @xmath40 independent stochastic forces , reducing the number of stochastic variables in the system .",
    "for all the details see ref .",
    "@xcite .",
    "measurements in chelas and avenida da liberdade stations . while the original measurements , symbolized by @xmath41 and @xmath42 , show some periodic modes resulting from the daily , three - day and weekly cycles ( see text ) , the detrended variables",
    ", @xmath43 and @xmath44 , both in chelas and avenida da liberdade have these periodicities suppressed .",
    "plots are vertically offset for better visibility .",
    ", scaledwidth=50.0% ]",
    "we consider hourly measurements of no@xmath4  concentrations in the metropolitan region of lisbon , portugal , namely at the monitoring stations of chelas ( c ) and avenida da liberdade ( al ) ( see fig .",
    "[ fig1 ] ) .",
    "the data were recorded from 2002 to 2006 , corresponding to @xmath45 measurement points with roughly 1% of discarded values , due to incomplete or erroneous measurements .",
    "the stations are located at a distance of @xmath46 km from each other . in the following",
    ", the no@xmath4  concentrations at the stations of chelas and avenida da liberdade will be designated as @xmath47 and @xmath48 , respectively , omitting the temporal dependency when not necessary .",
    "figure [ fig3 ] shows the fourier spectrum of both these data series .",
    "the ann input data sets consist of the aforementioned hourly no@xmath4  concentration measurements , and of concentrations of two more pollutants , namely no , and co , also measured at the monitoring stations of chelas and avenida da liberdade , from january 1st 2002 until december 31st of 2006 .",
    "the first four years are used to construct the models and year 2006 is used for independent evaluation .",
    "more specifically the prediction is done in two steps . in the first step ,",
    "we consider only the period 2002 - 2005 .",
    "for this four years we take the first three , 2002 - 2004 , for training the ann and derive the respective parameter values of the ann model .",
    "using that ann we predict year 2005 .",
    "then we consider 2002 , 2003 and 2005 for training the ann , and predict 2004 .",
    "similar procedure is done for predicting 2002 and 2003 . in the second step ,",
    "we use the parameter values obtained in the first step , namely , weights and biases , for predicting 2006 .    besides pollutant concentrations",
    ", we also consider daily maximum temperature , daily mean wind direction and speed , daily humidity , daily radiance , hourly mean temperature , hourly pressure and hourly relative humidity , boundary layer height ( blh ) from the european center for medium weather forecast ( ecmwf ) , circulation weather type ( cwt ) at the regional scale determined for portugal according to trigo and dacamara@xcite , north atlantic oscillation ( nao ) index from ncep - noaa , two weekly cycles and two yearly cycles .",
    "specifically , blh fields were retrieved from the 3 hourly ecmwf 40 years reanalysis ( http://data-portal.ecmwf.int/data ) for the 2002 - 2006 period .",
    "afterward , we extracted the 00:00 utc ( blh1 ) , 03:00 utc ( blh2 ) , 9:00 ( blh3 ) and 21:00 utc ( blh4 ) data from the retrieved blh fields . together with these variables",
    "we consider the two transformed variables derived through the procedure described in sec .",
    "[ subsec : optimal ] , before we suggest a method for reducing the number of input variables . in total",
    "there are @xmath49 variables that are available as input data for the ann model ( see tab .  [ fig_tabela_var ] ) .    .",
    "description of available input parameters for prediction . here",
    "the time - lags are @xmath50 and @xmath51 hours . for model @xmath52 one",
    "considers a total maximum number of @xmath53 variables and for model @xmath54 the two transformed variables @xmath55 and @xmath56 are added . [",
    "cols=\"^,^,^ \" , ]",
    "in the previous section we concluded that one of our transformed variables is more correlated with the target than most of the meteorological and air quality variables . collecting only variables with an equal or higher correlation than the one observed for @xmath57 , one obtains the model @xmath58 , which must now be compared with the standard model @xmath59 in its predictive power . in this section",
    "we present such comparison between both models . using different measures of predictive power ,",
    "we conclude that , in general , the optimal model most frequently evidences the same predictive power as model @xmath59 .",
    "results are summarized in tab .",
    "[ fig_tabela_resultados ] .",
    "the overall conclusion is that , despite the significant decrease of input data , the predictive power of model @xmath60 is not worse than the one of the models @xmath59 .    to evaluate the efficiency and performance of our method four other quantities are computed .",
    "the first such quantity is the well - known pearson correlation coefficient ( `` pc'')@xcite , @xmath61^{1/2 } } , \\label{pc}\\ ] ] where @xmath62 denotes the respective model forecast at time @xmath63 and @xmath64 denotes the real observed values at time @xmath63 .    from tab .",
    "[ fig_tabela_resultados ] one sees that the difference in the pearson correlation between both models , @xmath59 and @xmath58 , is almost nonexistent , except for the largest time - lag , namely @xmath65 .",
    "the pc results for the independent sample ( 2006 ) are relatively lower than for the calibration - validation period as expected , with the exception of the pc for al ( t=24 hours ) .",
    "another important quantity is the skill against persistence ( `` skillp '' ) which can be interpreted as the percentage of improvement that our model can provide when compared with the persistence model , i.e.  the forecast for a given hour is the observed value of the previous time lag , i.e. , 1h , 3h , 6h , 12h or 24h hours before .",
    "it is given by @xmath66 where @xmath67 is the value of the time series variable @xmath68 1 , 3 , 6 , 12 or 24 hours before .    from tab .",
    "[ fig_tabela_resultados ] one sees that the decrease in the skill against persistence between both models , @xmath59 and @xmath58 , is not significant ( @xmath69 ) for short time - lags except for the largest time - lag , namely @xmath65 .",
    "the skill against persistence results for the independent sample ( 2006 ) are higher than for the calibration - validation period for all the time lags .",
    "another quantity is the root mean square error ( `` rmse '' ) which represents the difference between the pairs of forecast and observation values and is given by @xmath70 while for shorter time - lags there is almost no difference between both models , a slight increase ( @xmath71 ) of rmse is observed in the optimal model for the t=24 time lag .",
    "the rmse for the independent sample are usually lower for the @xmath58 , except for the al t=3 case .",
    "finally , the mutual information evaluates the dependence between observations and predictions and is given by    @xmath72    where @xmath73 is the joint probability of observations and predictions for the same time - steps and @xmath74 and @xmath75 are the corresponding marginal distributions , computed within the range of admissible values , @xmath76 and @xmath77 , properly discretized . with one single exception in the 2002 - 2005 period and one in the 2006 period , no deviations",
    "are observed when comparing the mutual information in both models .    enabling a significant reduction of input data - less than one half - and simultaneously presenting a predictive power at least as good as the one given by the standard model",
    ", one can conclude that the model @xmath58 using our stochastic may be seen as a good alternative for establishing ann models in air quality prediction .",
    "figure [ fig4 ] shows for both chelas and avenida da liberdade the scatter plot between observations ( no@xmath4  measurements ) and the corresponding predictions from a ann model training with the optimized model @xmath58 , indicating a consistently good agreement .",
    "in this paper we applied a method for deriving eigenvariables in systems of coupled stochastic variables , which were then used as input variables to considerably reduce the amount of input data needed for training the ann , typically for than a factor of two and for large time - lags by a factor of ten .",
    "the predictive power is maintained .",
    "indeed , the introduction of the stochastic variables as input data for training the ann model allows to preserve the predictive power with considerable less input information .",
    "this is because the variable incorporates temporal correlations between independent and spatially separated monitoring stations .    in the particular context of atmospheric environment",
    ", the reduction of the amount of input data , optimizes the ann models in the sense that enables faster predictive outcome without changing significantly the predictive power .",
    "thus , our stochastic variables together with the findings of this study can be taken as a first step for improving alarm systems , making them more efficient in predicting periods of lower levels in the air quality .",
    "moreover , being a general numerical procedure for any given set of measurements , our finding can be easily adapted to other ann models in weather or geophysical forecast .",
    "an extension of this work to take into account the correlations between a higher number of measurement stations is planned .",
    "the authors thank daad and fct for financial support through the bilateral cooperation drebm / daad/03/2009 .",
    "fr ( sfrh / bpd/65427/2009 ) and pgl ( _ cincia 2007 _ ) thank fundao para a cincia e a tecnologia for financial support , also with the support ref .",
    "pest - oe / fis / ui0618/2011 .",
    "the authors would like to acknowledge agncia portuguesa do ambiente and european centre for medium weather forecast for providing the environmental and meteorological data , respectively .",
    "sokhi , r.s . ,",
    "san jos , r. , kitwiroon , n. , fragkou , e. , prez , j.l . ,",
    "middleton , d.r . , 2006 .",
    "prediction of ozone levels in london using the mm5cmaq modelling system .",
    "environmental modelling & software , * 21 * 566576 .",
    "dutot , a.l . ,",
    "rynkiewicz , j. , steiner f.e . ,",
    "rude , j. , 2007 .",
    "a 24-h forecast of ozone peaks and exceedance levels using neural classifiers and weather predictions . environmental modelling and software * 22 * , 12611269 .",
    "kukkonen , j. , partanen , l. , karppinen , a. , ruuskanen , j. , junninen , h. , kolehmainen , m. , niska , h. , dorling , s. , chatterton , t. , foxall , r. , cawley , g. , 2003 . extensive evaluation of neural network models for the prediction of no2 and pm10 concentrations , compared with a deterministic modeling system and measurements in central helsinki .",
    "atmospheric environment * 37 * , 45394550 .",
    "ghasemi , f. , sahimi , m. , peinke , j. , friedrich , r. , jafari , g.r . ,",
    "tabar , m.r.r.m 2007 .",
    "markov analysis and kramers - moyal expansion of nonstationary stochastic processes with application to the fluctuations in the oil price .",
    "e  * 75 * , 060102 .",
    "lind , p.g . ,",
    "haase , m. , boettcher , f. , peinke , j. , kleinhans , d. , friedrich , r. , 2010 .",
    "extracting strong measurement noise from stochastic time series : applications to empirical data .",
    "e * 81 * 041125 .",
    "cobourn , w. , dolcine , l. , french , m. , hubbard , m. , 2000 . a comparison of nonlinear regression and neural network models for ground - level ozone forecasting .",
    "journal of the air & waste management association * 50 * 19992009 .",
    "agirre - basurko , e. , ibarra - berastegi , g. , madariaga , i. , 2006 .",
    "regression and multilayer perceptron - based models to forecast hourly o3 and no2 levels in the bilbao area . environmental modelling & software * 21 * 430446 .",
    "papanastasiou , d. k. , melas , d. , kioutsioukis i. , 2007 . development and assessment of neural network and multiple regression models in order to predict pm10 levels in a medium - sized mediterranean city , water , air and soil pollution * 182 * 325 - 334 .",
    "demuzere , m. , trigo , r. , arellano , v. , van lipzig , n. , 2009 .",
    "the impact of weather and atmospheric circulation on o3 and pm10 levels at a rural mid - latitude site .",
    "atmospheric chemistry and physics * 9 * , 26952714 ."
  ],
  "abstract_text": [
    "<S> we apply recent methods in stochastic data analysis for discovering a set of few stochastic variables that represent the relevant information on a multivariate stochastic system , used as input for artificial neural networks models for air quality forecast . </S>",
    "<S> we show that using these derived variables as input variables for training the neural networks it is possible to significantly reduce the amount of input variables necessary for the neural network model , without considerably changing the predictive power of the model . </S>",
    "<S> the reduced set of variables including these derived variables is therefore proposed as optimal variable set for training neural networks models in forecasting geophysical and weather properties . </S>",
    "<S> finally , we briefly discuss other possible applications of such optimized neural network models .    </S>",
    "<S> pollutants , neural networks , stochastic systems , environmental research 92.60.sz , 02.50.ga , 02.50.ey , </S>"
  ]
}