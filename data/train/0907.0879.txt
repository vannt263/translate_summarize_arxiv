{
  "article_text": [
    "diffusion monte carlo ( dmc ) represents a powerful method for the accurate computation of properties of molecules and solids  @xcite .",
    "however , so far few attempts @xcite have been made to use dmc to calculate the static density - response function  @xcite , which is a central quantity in the analysis of many - electron systems and time - dependent density - functional theory  @xcite .",
    "one reason is the technical difficulty inherent in the most straightforward method to do so : for a given perturbing potential one calculates the total energy at different strengths and numerically determines the second derivative .",
    "this then gives a dmc estimate of the diagonal term of the static response function @xmath0 .",
    "there are , however , several obvious difficulties with this .",
    "one needs one loop for various perturbation strengths , another loop for each @xmath1 that one wishes to sample , and if one wants the off - diagonal terms a third loop for the @xmath2 . inside",
    "each of these loops sits an entire wavefunction reoptimization cycle and a complete dmc run .",
    "the perturbations must be small enough not to change the wavefunction qualitatively and large enough to allow for sensible numerical derivatives .",
    "in a recent letter  @xcite , we showed how `` applying '' the hellmann - feynman  @xcite ( hf ) derivative to the dmc algorithm leads to a new algorithm , hellmann - feynman sampling ( hfs ) , that correctly samples the first derivative of the energy , i.e. , an expectation value of an operator .",
    "hfs works because dmc yields the correct total energy for nodes defined by the trial wavefunction . for technical reasons",
    "the operators sampled must be diagonal in real space . extending the analysis to the second derivative yields a dmc algorithm for the fixed - node ( fn ) static density - response function .",
    "note that even for a trial wavefunction with correct nodes the fixed - node density response is not the exact value as the real response includes effects from the change of the nodes . however , comparison with ref .",
    "@xcite where the nodal variation of an underlying kohn - sham ( ks ) system is implicitly used , shows that these effect can be accounted for by generalizing the rpa analysis  @xcite to fn systems .",
    "the resulting method can be performed within a single dmc run , and in the case of inhomogeneous systems can produce off - diagonal elements of @xmath0 as easily as the diagonal terms .",
    "the present paper is organized as follows . after a brief recapitulation of hf sampling ,",
    "we derive formulae for the dmc sampling of @xmath0 along the same line .",
    "we then briefly discuss technical aspects ( convergence with respect to population size , time step , etc . ) .",
    "finally , we look at the density response of the interacting and non - interacting uniform electron gas , analyze the effects of the nodes , and compare our results with the literature .",
    "our method should also enable dmc calculations of the static - response function of real solids , never done before .",
    "we use atomic units throughout .",
    "fixed - node dmc yields by construction the normalized expectation value @xmath3 , where @xmath4 is the ground - state wavefunction constrained by the nodes of the fermionic many - body trial wavefunction @xmath5 ; hfs correctly calculates @xmath6 while maintaining the basic dmc algorithm that samples @xmath7 .",
    "this is because the total energy is evaluated correctly within standard dmc , and crucially operator expectation values can be cast as hf derivatives of the total energy . keeping in mind that ultimately the dmc algorithm is nothing but a large sum that yields the total energy",
    ", we see that the hf derivative can be applied to the algorithm itself !",
    "one advantage over numerical derivatives is that the resulting formula can handle several operators simultaneously in a single dmc run , and maintaining orbital occupancy for perturbed hamiltonians ceases to be a problem .",
    "the dmc algorithm only involves numbers , so non - commutability of operators is no problem .",
    "writing down the dmc algorithm as a mathematical formula and applying the hf derivative to it yields an object that when sampled using standard dmc produces the _ exact _ operator expectation value .",
    "we find that given a hamiltonian @xmath8 , evaluating the growth estimator of the energy @xmath9 at time step @xmath10 to first order in @xmath11 yields a growth estimator that samples the operator @xmath12 .",
    "similarly the direct estimator @xmath13 of the energy yields another estimator .",
    "these are eqs .",
    "( 8) and ( 9 ) of ref .",
    "@xcite : [ def_de0 ] o^gr_i&=&.|_=0= .",
    "+ [ def_de1 ] o^e_i&=&.|_=0= -t ( - ) . where the bar refers to the dmc sampling at time step @xmath10 : @xmath14 .",
    "@xmath15 is the total weight of walker @xmath16 , @xmath17 , and @xmath18 is @xmath19 evaluated for walker @xmath16 at time step @xmath1 .",
    "now we assume two perturbations of the form @xmath20 and @xmath21 , and following ref .",
    "@xcite we obtain growth and direct estimators of the response function @xmath22 from the second derivative of the growth and direct estimators of the energy : [ chi_gr ] ^gr_ab(i)&= & -t[- ] + ^e_ab(i)&= & -t[- + - ] + [ chi_dir ] & & + t^2 [ ] .",
    "any number of operators @xmath23 and @xmath24 can be sampled in parallel within a single dmc run . from now on we use the fourier components of the density @xmath25 and @xmath26 .",
    "note also that , as in the case of the first derivative discussed in ref .",
    "@xcite , the growth estimator at @xmath10 is already an averaged quantity .",
    "this property makes it an attractive choice for a dmc calculation .",
    "equation  ( [ chi_dir ] ) is not only a more complicated formula than eq .",
    "( [ chi_gr ] ) , it also has to be summed at each time step @xmath10 . if we wish to sample many components of @xmath0 at the same time , a large array with a size quadratic in the number of components of @xmath0 in eq .",
    "( [ chi_dir ] ) has to be generated and dealt with at each time step .",
    "by contrast , eq .",
    "( [ chi_gr ] ) only has to be built at whatever time step one wishes to calculate @xmath0 .",
    "this means that at each time step one only has to maintain the @xmath27 , which is less memory intensive and much faster to compute .",
    "hence we shall only use the growth estimator eq .",
    "( [ chi_gr ] ) .",
    "the growth estimator has the advantage that for each time step and walker we only need to deal with simple sampling of @xmath28 variables for the components of the density .",
    "the entire density - response function , including off - diagonal elements , can then be calculated as a correlation function  @xcite of these variables at the end of the run saving computer time and memory . as in hfs",
    ", we find that noise rises as the sampling progresses , thus limiting the statistical error of the final result even if the sampling is continued indefinitely .",
    "so to reduce statistical noise , we increase the number of walkers instead .",
    "this has the additional advantage of reducing any population bias .",
    "we converged this by looking at population sizes of @xmath29 , @xmath30 , @xmath31 , and @xmath32 walkers .",
    "we used the latter for the main results shown here ( at @xmath33 electrons ) .",
    "looking at different time steps , we found that too large a time step shows up as a levelling off of @xmath0 at a finite value at larger @xmath1 instead of showing the correct @xmath34 behavior .",
    "interestingly , even at @xmath35 the calculated @xmath0 remained unbiased up to and well beyond @xmath36 .",
    "a large time step is desirable as equilibration will be faster . here",
    "we use @xmath37 . to monitor equilibration",
    "we artificially extract a value @xmath38 that when summed over all time steps gives the growth estimator @xmath39 at the time @xmath40 of sampling : from _ i^n-1(i)=(n-1 ) and _ i^n(i)=(n ) it follows that ( n)=n_n-(n-1)(n-1 )  .",
    "following , e.g. three typical @xmath1 s as the sampling progresses we found that @xmath41 converges exponentially .",
    "a quick run using few walkers in a smaller system can then be used to roughly estimate the convergence time which one then uses in an actual run .",
    "convergence can be improved by setting up the sampling such that one ignores the implied @xmath41 during equilibration . in order to do that it is not necessary to actually reverse engineer these @xmath41 for each element of the density response function .",
    "once one has decided on an equilibration time , @xmath42 the desired result is _",
    "i = n_eq+1^n ( i)= [ n(n)-n_eq(n_eq ) ] it is thus sufficient to perform the costly sampling of the full growth estimator only twice during the run , once after equilibration , and once at the end of the run .",
    "doing so , efficiently removes much of a @xmath43-like term without incurring much extra computation .",
    "we found that equilibration was essentially independent of @xmath44 and seemed to depend only weakly on the population size .",
    "we note that while in this paper we only calculate the diagonal terms of @xmath0 , sampling the full density - response function , including all the off - diagonal terms , is not more difficult : all that is needed is the evaluation of the correlation function of @xmath45s at different @xmath1 and @xmath2 .",
    "in order to demonstrate our method we calculated the diagonal terms of the static density response function of an unpolarized free electron gas for electron - density parameter @xmath46 , @xmath47 , and @xmath48 and corresponding density @xmath49 .",
    "we set up the dmc calculation using @xmath50 electrons in a simple - cubic super cell .",
    "we also looked at @xmath51 unit cells and smaller systems with @xmath52 electrons , however , we found no qualitative difference . in all , we calculated the density response at all @xmath53 independent @xmath1-vectors between @xmath54 and @xmath36 .",
    "our dmc calculations employed trial wave functions @xmath5 of the slater - jastrow type with a standard correlation term . prior to the dmc",
    "run @xmath5 was optimized in a variance minimization run .",
    "we used the casino  @xcite code for all our computations .     of an",
    "infinitely large unpolarized non - interacting homogeneous electron gas ( lindhard function ) at @xmath55 .",
    "the black lines close to the lindhard function show the exact finite - size lindhard function @xmath56with @xmath50 and @xmath57 electrons , the latter following the lindhard function closer .",
    "the dotted line shows the rpa response function @xmath58 , and the three remaining dot - dashed lines show ( from top to bottom ) the fixed - node lindhard function @xmath59 at @xmath50 electrons , the corresponding fixed - node density response of an interacting system @xmath60 , and the fixed - node rpa @xmath61 .",
    "the `` wiggles '' are not noise as they correspond to the shell structure seen in the exact non - interacting finite - size @xmath56,scaledwidth=48.0% ]      in general , the response function is given by _",
    "ab=_i=1 ^ 2 , [ fnx ] where the sum runs over all excited states of the many - electron system .",
    "fn dmc yields the ground - state energy for nodes given by the trial wave function .",
    "therefore the second derivative yields the fixed - node response @xmath60 of a system for which the nodes are the same for all perturbing potentials .",
    "since in the case of a fixed - node system the sum entering eq .",
    "( [ fnx ] ) runs over a set of fixed - node excited states that differ from the actual excited states of the many - electron system , the fixed - node and non fixed - node non - interacting density - response function differ considerably ( fig .",
    "[ chi1 ] ) .",
    "another interesting observation is the shell structure exhibited by all finite - size ( fs ) results . in order to visualize both the fixed - node error and the finite - size effects , we have plotted in fig .",
    "[ chi1 ] the following calculations : the static density - response function of ( i ) an infinitely large unpolarized non - interacting free electron gas , the well - known lindhard function  @xcite @xmath62 ( dashed line ) , ( ii ) @xmath56 of a non - interacting unpolarized system of 114 and 4218 electrons ( solid lines ) , ( iii ) an infinitely large unpolarized interacting free electron gas in the random - phase approximation ( rpa ) , @xmath58 ( dotted line ) , ( iv ) a finite unpolarized system of 114 non - interacting electrons within the fixed - node approximation giving @xmath59 ( top dot - dashed line ) , ( v ) a finite unpolarized system of 114 interacting electrons within our fixed - node dmc scheme ( middle dot - dashed line ) , and ( vi ) a finite unpolarized system of 114 interacting electrons in the fn rpa @xmath61 ( dot - dashed line at the bottom , see below for details ) .",
    "we see that the finite - size shell structure is not negligible even for a system of 4218 electrons .",
    "nevertheless , the exact non - interacting density - response function nicely reproduces the well - known lindhard function especially for @xmath63 .",
    "for an unpolarized @xmath50 particle homogeneous electron gas .",
    "the dotted lines show the lindhard function @xmath62 ( top ) and @xmath58 ( bottom ) .",
    "the dashed lines are @xmath64 ( top ) and @xmath61 ( bottom ) . finally , the solid lines show the fixed - node @xmath60 ( bottom ) and extrapolated interacting @xmath0 .",
    "the dots correspond to the results in ref .",
    "our data reaches to smaller @xmath1 values as our system is larger ( @xmath50 vs. up to @xmath52 electrons).,scaledwidth=48.0% ]      since the fn lindhard function @xmath59 ( top dashed line in fig .",
    "[ chis ] ) is smaller than the real lindhard function @xmath62 ( dotted line at the top of fig .",
    "[ chis ] ) the fn interacting @xmath60 is also too small ( lower solid line in fig .",
    "[ chis ] compared to the dots showing the relevant data of ref .",
    "however , assuming that the effect of the fixed - node nature of the calculation is the same for the interacting and non - interacting case , we should still be able to extract meaningful correlation data and reverse the effects of the fn approximation  @xcite .",
    "let us start with the definition for the exchange correlation ( xc ) kernel @xmath65 and the local field factor @xmath66 -f_xc(k)&=&v_c(k)g(k)= - + [ fxc ] & = & -+v_c(k ) where @xmath67 .",
    "in practise , we do not have access to @xmath68 but only to its finite - size equivalent in the fixed - node approximation .",
    "moroni and coworkers  @xcite , who include the nodal variation at a kohn - sham level argue that that while the density response contains finite size effects , @xmath65 is less afflicted by these .",
    "hence , they extract @xmath65 and add that back on to the non fixed - node infinite - cell lindhard function to correct for finite size effects , thus eliminating the shell structure .",
    "there is no reason to expect the nodal variation of the ks nodes to correctly describe the nodal variation of the fully interacting system with respect to @xmath0 : the ks nodes and the true many - body nodes are unrelated .",
    "furthermore , different qmc systems at different numbers of electrons @xmath69 also correspond to distinct nodes , but the data for @xmath65 ( e.g. ref .",
    "@xcite or fig .",
    "[ ccomp ] ) for different values of @xmath69 is mutually compatible .",
    "finally , the effect of the nodal variation on @xmath62 seems universal , i.e. independent of @xmath69 except for shell effects ( see fig .",
    "[ uninode ] ) .     at @xmath70 for @xmath71 and @xmath33 electrons . due to scaling",
    "this graph is independent of the value of @xmath72 , except for noise .",
    "note the pronounced shell structure for @xmath73 .",
    ", scaledwidth=48.0% ]    it therefore seems reasonable to assume that @xmath65 is independent of nodal effects and can thus be used to correct for wrong or absent nodal variation .",
    "hence , by using the fixed - node quantities in eq .",
    "( [ fxc ] ) , implicitly defining a fixed - node @xmath61 , we can derive a fn @xmath74 and @xmath75 ( figures   [ fxc_5 ] and [ g_5 ] ) .",
    "these are remarkably similar to the data in ref .",
    "in fact , @xmath74 even has a slight dip as suggested in ref .",
    "@xcite which however is not really visible in ref .",
    "this is encouraging and indeed we can use our data for @xmath75 in conjunction with the real @xmath58 in eq .",
    "( [ fxc ] ) to estimate the non - fn interacting @xmath0 .",
    "the result can be seen in fig .",
    "[ chis ] : all the fn quantities are too small compared to their non - fn counterparts .",
    "however our extrapolated date ( solid line at the top ) is very close the extrapolated data of ref .",
    "@xcite ( dots ) . for completeness sake fig .",
    "[ chi2 ] shows details of the extrapolated @xmath0 at @xmath55,@xmath47 , and @xmath48 . also , in fig .",
    "[ ccomp ] we show a direct comparison between our results and ref .",
    "@xcite where it is possible , i.e. at @xmath71 electrons in addition to our results for @xmath33 electrons confirming that all our data is compatible with ref .",
    "@xcite . except for noise",
    "there is no significant difference between data at different @xmath69 , corroborating the assumption that @xmath65 is independent of finite - size effects .     at @xmath76 .",
    "the value at @xmath77 clearly is an outlier .",
    "also , the noise increases as @xmath1 grows .",
    "interestingly , there is a slight dip in @xmath74 for @xmath78 as demonstrated in ref .",
    "the dots correspond to the data in ref .",
    "@xcite . , scaledwidth=48.0% ]    , but showing the local field factor.,scaledwidth=48.0% ]     particle homogeneous electron gas at @xmath79 @xmath80,@xmath47 , and @xmath48 .",
    "the dots correspond to the results in ref .",
    "note that for @xmath55 the uncorrected dmc data is lower still than standard rpa .",
    ", scaledwidth=48.0% ]     at @xmath70 and the finite - size corrected @xmath0 with the data in ref .",
    "@xcite where comparison is possible , i.e. at @xmath71 electrons .",
    "all our other data uses a larger simulation cell with @xmath50 electrons and more configurations in the dmc run .",
    "the solid dots are the four data points for @xmath71 electrons of ref .",
    "@xcite and the solid line corresponds to our data ( just under 100 data points in the shown region ) .",
    "the dashed line shows our data for the @xmath33 electron system . as suggested in ref .",
    "@xcite there is no qualitative difference between @xmath71 and @xmath33 .",
    "note that for @xmath71 we use fewer walkers than for our main results at @xmath33 .",
    ", scaledwidth=48.0% ]    in general , our results nicely follow the data in ref .",
    "@xcite , who take into account the change in the nodes at a kohn - sham level , whereas our calculations do not take into account any nodal effect on xc quantities .",
    "the fact that the methods yield consistent results for @xmath65 suggest that assuming @xmath65 to be free from nodal effects is justified and that in either case the resulting data is an accurate description of systems with the full interacting nodal variation .",
    "we have generalized ref .  @xcite to the second derivative of the energy .",
    "this yields a novel method and an efficient algorithm to calculate the static response function within dmc .",
    "our algorithm permits the computation of a large number of diagonal and off - diagonal terms in a single dmc run without the need for numerical derivatives or re - optimization .",
    "noise can be efficiently controlled by increasing the number of dmc walkers and we have found that we can use large dmc time steps without introducing a bias , potentially speeding up calculations greatly .",
    "the wavefunction nodes have a strong effect on @xmath0 , particularly for @xmath81 and generalizing the rpa analysis using @xmath64 yields a fixed - node @xmath61 . using this to extract the xc contribution of @xmath0 we find that our method s results are broadly in line with previous dmc calculations  @xcite which , however , are much more cumbersome , yield potentially fewer data points , and are effectively limited to diagonal terms only . this work has been supported by the basque unibertsitate eta ikerketa saila and the spanish ministerio de ciencia e innovacion ( grants no . fis2006 - 01343 and csd2006 - 53 ) .",
    "computing facilities were provided by the donostia international physics center ( dipc ) and the sgi / izo - sgiker upv / ehu ( supported by the national program for the promotion of human resources within the national plan of scientific research , development and innovation - fondo social europeo , mcyt and the basque government ) .                    another method ( j. vrbik and s.m .",
    "rothstein , j. chem .",
    "phys . * 96 * , 2071 1992 . ) to calculate vibrational frequencies yields similar looking formulae .",
    "however , that method can not be used for the exact fn sampling of general operators , only gives the fn response with respect to a parameter such as the distance between atoms , and applies specifically to dmc with fully retained weights .",
    "r. j. needs , m. towler , n. drummond , and p. kent , _ casino version 1.7 user manual _",
    "( university of cambridge , 2004 ) .",
    "d. pines and p. noziers , the theory of quantum liquids ( benjamin , new york , 1966 ) . b. farid ,",
    "v. heine , g. e. engel , and i. j. robertson , phys .",
    "b * 48 * , 11602 ( 1993 ) ."
  ],
  "abstract_text": [
    "<S> in a recent letter we introduced hellmann - feynman operator sampling in diffusion monte carlo calculations . here we derive , by evaluating the second derivative of the total energy , an efficient method for the calculation of the static density - response function of a many - electron system . </S>",
    "<S> our analysis of the effect of the nodes suggests that correlation is described correctly and we find that the effect of the nodes can be dealt with . </S>"
  ]
}