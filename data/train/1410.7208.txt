{
  "article_text": [
    "among a variety of multi(commodity)flow problems , one popular class embraces multiflow demand problems in undirected planar graphs in which the demand pairs are located within specified faces of the graph .",
    "more precisely , a problem input consists of : a planar graph @xmath0 with a fixed embedding in the plane ; nonnegative integer _ capacities _ @xmath1 of edges @xmath2 ; a subset @xmath3 of faces , called _ holes _",
    "( where @xmath4 is the set of faces of @xmath5 ) ; a set @xmath6 of pairs @xmath7 of vertices such that both @xmath8 are located on ( the boundary of ) one of the holes ; and _ demands _ @xmath9 for @xmath10 . a _ multiflow _ for @xmath11 is meant to be a pair @xmath12 consisting of a set @xmath13 of @xmath6-paths @xmath14 in @xmath5 and nonnegative real weights @xmath15 . here",
    "a path @xmath14 is called a @xmath6-_path _ if @xmath16 for some @xmath10 , where @xmath17 and @xmath18 are the first and last vertices of @xmath14 , respectively .",
    "we call @xmath19 _ admissible _ for @xmath20 if it satisfies the capacity constraints : @xmath21 and realizes the demands : @xmath22    the ( fractional ) _ demand problem _ , denoted as @xmath23 , or @xmath24 for short , is to find an admissible multiflow for @xmath20 ( or to declare that there is none ) .",
    "when the number of holes is `` small '' , this linear program is known to possess nice properties . to recall them ,",
    "we need some terminology and notation .    for @xmath25 , the set of edges of @xmath5 with one end in @xmath26 and the other in @xmath27 is denoted by @xmath28 and called the _ cut _ in @xmath5 determined by @xmath26 .",
    "we also denote by @xmath29 the set of pairs @xmath10 _ separated _ by @xmath26 , i.e. , such that @xmath30 . for a singleton @xmath31",
    ", we write @xmath32 for @xmath33 , and @xmath34 for @xmath35 . for a function @xmath36 and a subset @xmath37 ,",
    "@xmath38 denotes @xmath39 .",
    "so @xmath40 is the capacity of the cut @xmath41 , and @xmath42 is the total demand on the elements of @xmath6 separated by @xmath26 .",
    "a capacity - demand pair @xmath43 is said to be _ eulerian _ if @xmath44 is even for all vertices @xmath45 .",
    "the simplest sort of necessary conditions for the solvability of problem @xmath24 ( with any @xmath11 ) is the well - known _ cut condition _ : @xmath46 should hold for all @xmath47 .",
    "it need not be sufficient , and in general the solvability of a multiflow demand problem is provided by metric conditions . in our case the following results have been obtained .",
    "\\(a ) for @xmath48 , okamura and seymour  @xcite showed that the cut condition is sufficient , and that if @xmath43 is eulerian and the problem @xmath24 has a solution , then it has an integer solution , i.e. , there exists an admissible multiflow @xmath49 with @xmath50 integer - valued .",
    "okamura  @xcite showed that these properties continue to hold if @xmath51 .",
    "\\(b ) for @xmath52 , the cut condition becomes not sufficient and the solvability criterion involves also the so - called _",
    "( 2,3)-metric condition_. it is related to a map @xmath53 , where @xmath54 is the complete bipartite graph with parts of @xmath55 and @xmath56 vertices .",
    "such a @xmath57 defines the _ metric _",
    "@xmath58 on @xmath59 by @xmath60 , @xmath61 , where @xmath62 denotes the distance ( the shortest path length ) between vertices in @xmath63 .",
    "it gives a partition of @xmath59 into five sets ( with distances 1 or 2 between them ) , and @xmath64 is said to be a _ ( 2,3)-metric _ on @xmath59 .",
    "we denote @xmath65 by @xmath66 , and @xmath67 by @xmath68 .",
    "karzanov showed the following .",
    "[ tm:3hole ] let @xmath52 .",
    "then @xmath24 has a solution if and only if the cut condition  ( [ eq : cut_cond ] ) holds and @xmath69 holds for all ( 2,3)-metrics @xmath64 on @xmath59 ( the _ ( 2,3)-metric condition _ ) .",
    "furthermore , if @xmath43 is eulerian and the problem @xmath24 has a solution , then it has an integer solution .",
    "we call @xmath70 in  ( [ eq : cut_cond ] ) ( resp",
    ". @xmath71 in  ( [ eq:23metr ] ) ) the _ excess _ of a set @xmath26 ( resp . a ( 2,3)-metric @xmath64 ) w.r.t .",
    "one easily shows that @xmath70 and @xmath71 are even if @xmath43 is eulerian .",
    "\\(c ) when @xmath72 , the situation becomes more involved . as is shown in  @xcite , the solvability criterion for @xmath24",
    "involves , besides cuts and ( 2,3)-metrics , metrics @xmath58 on @xmath59 induced by maps @xmath73 with @xmath74 running over a set of planar graphs with four faces , and merely the existence of a half - integer solution is guaranteed in a solvable eulerian case .",
    "when @xmath75 , the set of unavoidable metrics in the solvability criterion becomes ugly ( see  ( * ? ? ?",
    "* sec .  4 ) ) , and the fractionality status is unknown so far .    in this paper",
    "we focus on algorithmic aspects .",
    "the first combinatorial strongly polynomial algorithm ( having complexity @xmath76 ) to find an integer solution in the eulerian case with @xmath48 is due to frank  @xcite , and subsequently a number of faster algorithms have been devised ; a linear - time algorithm is given in  @xcite .",
    "hereinafter @xmath77 stands for the number @xmath78 of vertices of the graph .",
    "efficient algorithms for @xmath51 are known as well . for a survey and references in cases @xmath79 ,",
    "see , e.g. ,  @xcite .",
    "our aim is to give an algorithm to solve problem @xmath24 with @xmath52 , which checks the solvability and finds an integer admissible multiflow in the eulerian case .",
    "our algorithm uses merely combinatorial means and is strongly polynomial ( though having a high polynomial degree ) .",
    "it is based on a subroutine for a certain planar version of the ( 2,3)-metric minimization problem .",
    "we explain how to solve the latter efficiently and in a combinatorial fashion , by reducing it to a series of shortest paths problems in a dual planar graph .",
    "* remark 1 . *",
    "the ( 2,3)-metric minimization problem in a general edge - weighted graph with a specified set of five terminals can be solved in strongly polynomial time ( by use of the ellipsoid method )  @xcite or by a combinatorial weakly polynomial algorithm  @xcite .",
    "this paper is organized as follows .",
    "section  [ sec : prelim ] reviews facts from  @xcite refining the structure of cuts and ( 2,3)-metrics that are essential for the solvability of our 3-hole demand problem . using these refinements , sections  [ sec : veri_cut ] and  [ sec : veri_23 ]",
    "develop efficient combinatorial procedures to verify cut and ( 2,3)-metric conditions for problem @xmath24 with initial or current @xmath20 ; moreover , these procedures determine or duly estimate the minimum excesses of regular cuts and ( 2,3)-metrics , which is important for the efficiency of our algorithm for @xmath24 .",
    "this algorithm is described in section  [ sec : alg ] .    to slightly simplify the further description ,",
    "we will assume , w.l.o.g .",
    ", that the boundary of any hole @xmath80 contains no isthmus . for",
    "if @xmath81 has an isthmus @xmath82 , we can examine the cut @xmath83 .",
    "if it violates the cut condition , the problem @xmath24 has no solution .",
    "otherwise @xmath24 is reduced to two smaller demand problems , with at most 3 holes and with eulerian data each , by deleting @xmath82 and modifying demands concerning @xmath80 .",
    "throughout the rest of the paper , we deal with @xmath84 as above such that @xmath52 and @xmath43 is eulerian .",
    "let @xmath85 .",
    "one may assume that the graph @xmath0 is connected and its outer ( unbounded ) face is a hole ( say , @xmath86 ) .",
    "we identify objects in @xmath5 , such as edges , paths , subgraphs , and etc .",
    ", with their images in the plane .",
    "a face @xmath87 is regarded as an open region in the plane .",
    "since @xmath5 is connected , the boundary @xmath88 of @xmath89 is connected , and we identify it with the corresponding cycle ( closed path ) considered up to reversing and shifting cyclically .",
    "note that this cycle may contain repeated vertices or edges ( an edge of @xmath5 may be passed by @xmath88 twice , in different directions ) .",
    "a subpath in this cycle is called a _ segment _ in @xmath88 .",
    "we denote the subgraph of @xmath5 induced by a set @xmath25 by @xmath90=[x]_g$ ] , the set of faces of @xmath5 whose boundary is entirely contained in @xmath90 $ ] by @xmath91 , and the region in the plane that is the union of @xmath90 $ ] and all faces in @xmath91 by @xmath92 .",
    "we also need additional terminology and notation .    a subset @xmath47 ( as well as the cut @xmath41 )",
    "is called _ regular _ if the region @xmath92 is simply connected ( i.e. , it is connected and any closed curve in it can be continuously deformed into a point ) , and for each @xmath93 ,  @xmath90\\cap \\/b(h_i)$ ] forms a segment of @xmath94 .",
    "in particular , the subgraph @xmath90 $ ] is connected .",
    "let @xmath95 and @xmath96 be the parts ( color classes ) in @xmath63 .",
    "given @xmath53 , we denote the set @xmath97 by @xmath98 , and @xmath99 by @xmath100 .",
    "then @xmath101 is a partition of @xmath59 .",
    "the ( 2,3)-metric @xmath102 is called _ regular _ if :    * all sets @xmath103 in @xmath104 are nonempty ; * for @xmath93 , the region @xmath105 is simply connected ; * for @xmath106 ,  @xmath107 holds if and only if @xmath108 ; and for @xmath109 ,  @xmath110\\cap \\/b(h_j)$ ] forms a segment of @xmath111 .",
    "[ eq : reg23 ]    then the complement to @xmath112 of @xmath113 consists of two connected components , one containing @xmath114 and the other containing @xmath115 . the structure described in  ( [ eq : reg23 ] ) is illustrated in the picture .",
    "the notions of regular sets ( cuts ) and ( 2,3)-metric are justified by the following important strengthening of the first assertion in theorem  [ tm:3hole ] ( cf .",
    "@xcite ) .",
    "[ tm:3h_sharp ] @xmath24 has a solution if and only if cut condition  ( [ eq : cut_cond ] ) holds for all regular subsets @xmath47 and ( 2,3)-metric condition  ( [ eq:23metr ] ) holds for all regular ( 2,3)-metrics on @xmath59 .",
    "* remark 2 .",
    "* in fact , the refined solvability criterion for @xmath24 given in  ( * ? ? ?",
    "2.1 ) involves a slightly smaller set of ( 2,3)-metrics ( called _ proper _ there ) than that defined by  ( [ eq : reg23 ] ) ; also it does not specify a collection of cuts .",
    "note , however , that if @xmath47 is not regular , then one can easily find nonempty sets @xmath116 such that @xmath117 ,  @xmath118 , and @xmath119 .",
    "this implies that @xmath26 is redundant ( it can be excluded from verification of  ( [ eq : cut_cond ] ) ) .",
    "in this and next sections we describe efficient procedures for checking the solvability of @xmath23 ( concerning the initial or current data ) . by theorem  [ tm:3h_sharp ]",
    ", it suffices to verify validity of cut condition  ( [ eq : cut_cond ] ) for regular sets and ( 2,3)-metric condition  ( [ eq:23metr ] ) for regular ( 2,3)-metrics .",
    "we reduce both problems to ones on shortest paths in a certain dual graph .",
    "moreover , on this way we shall obtain certain lower bounds on the minimum excesses of regular sets and regular ( 2,3)-metrics , which are crucial for our algorithm .    the dual graph needed to us",
    "is constructed as follows .",
    "first we take the standard planar dual graph @xmath120 of @xmath5 , i.e. , @xmath121 is bijective to @xmath4 and @xmath122 is bijective to @xmath123 , defined by @xmath124 and @xmath125 , where a dual edge @xmath126 connects vertices @xmath127 and @xmath128 if @xmath129 are the faces whose boundaries contain @xmath82 ( possibly @xmath130 ) .",
    "( usually one assumes that @xmath127 is a point in @xmath89 and that @xmath126 crosses @xmath82 . )",
    "we also denote the vertex of @xmath131 corresponding to a hole @xmath132 by @xmath133 .",
    "then we slightly modify @xmath131 as follows . for @xmath93 ,",
    "let @xmath134 denote the sequence of edges of the cycle @xmath94 .",
    "( recall that @xmath94 has no isthmus , as mentioned in the introduction ; hence all edges in @xmath134 are different . )",
    "then the dual vertex @xmath133 has degree @xmath135 and is incident with the dual edges @xmath126 for @xmath136 .",
    "we split @xmath133 into @xmath135 vertices @xmath137 of degree 1 each , where for @xmath136 , the end @xmath133 of @xmath126 is replaced by @xmath137 .",
    "these pendant vertices are called _ terminals _ , they belong to the boundary of the same face , denoted as @xmath138 , and the set of these terminals ordered clockwise around @xmath138 is denoted by @xmath139 .",
    "the resulting graph is just the desired dual graph for @xmath140 , denoted as @xmath141 .",
    "an example of transforming @xmath5 into @xmath141 in a neighborhood of a hole @xmath132 is illustrated in the picture , where @xmath142 are faces in @xmath5 , and the terminals in @xmath143 are indicated by big circles .",
    "the edges of @xmath141 have _ lengths _ inherited from the capacities in @xmath5 , namely , we define @xmath144 for @xmath145 .",
    "the rest of this section is devoted to verifying the cut condition and estimating the minimum excesses of regular sets .",
    "* remark 3 .",
    "* alternatively , one can deal with subsets @xmath146 subject to the only condition that for @xmath93 ,  @xmath90\\cap b(h_i)$ ] is a segment of @xmath94 ; let us call such an @xmath26 _ semi - regular_. the minimum excess among such sets can be computed by enumerating the triples of segments in @xmath147 and finding the corresponding minimum cut capacity for each triple ; this takes @xmath148 minimum cut computations in @xmath5 .",
    "we , however , prefer to deal with regular sets and apply a shortest dual paths method , which can be regarded as an introduction to the method of estimating the minimum excess of ( 2,3)-metrics described in the next section .",
    "consider a regular set @xmath47 .",
    "the fact that the region @xmath92 is simply connected implies that the cut @xmath41 of @xmath5 corresponds to a simple cycle of @xmath131 , denoted as @xmath149 , and to a set of paths in @xmath150 .",
    "more precisely , we say that @xmath26 has _ type _",
    "@xmath151 , where @xmath152 denotes the set of holes @xmath132 such that @xmath90\\cap b(h_i)\\ne\\emptyset , b(h_i)$ ] . since @xmath153 implies @xmath154 , only sets @xmath26 of types 1,2,3 are essential in  ( [ eq : cut_cond ] ) . for @xmath155 ,",
    "the cut @xmath41 meets @xmath94 by a pair @xmath156 of edges , denoted as @xmath157 ( taking into account that @xmath94 has no isthmus ) .",
    "let @xmath158 denote the set of demand pairs @xmath10 located on @xmath94 and separated by @xmath26 ( i.e. , @xmath8 lie in different components of @xmath159 ) .",
    "suppose that @xmath26 is of type 1 .",
    "let @xmath160 and @xmath161 .",
    "the cycle @xmath149 in @xmath131 passes the elements @xmath162 .",
    "it turns into path @xmath163 connecting the terminals @xmath137 and @xmath164 in @xmath150 , and we have @xmath165 ( regarding cycles and paths as edge sets ) .",
    "let @xmath166 be the collection of regular sets @xmath47 of type 1 such that @xmath160 and @xmath161 , and suppose that we are going to verify  ( [ eq : cut_cond ] ) and , moreover , to find the minimum excess within this collection . the right hand side value in  ( [ eq : cut_cond ] )",
    "is constant : @xmath167 ; therefore , the task is reduced to finding a @xmath168-shortest path @xmath14 from @xmath137 to @xmath164 in @xmath141 .",
    "thus , verification of the cut condition for the regular sets of type 1 and , moreover , finding the minimum excess among them , is reduced to solving @xmath169 shortest paths problems in @xmath141 ( each handling fixed @xmath170 and @xmath136 and all @xmath171 ) and to computing @xmath172 values @xmath158 .    for @xmath173 ,",
    "let @xmath174 denote the minimum excess @xmath70 among the regular sets @xmath47 of type @xmath175 .",
    "we have the following    [ pr : type1 ] @xmath176 can be found in time @xmath177 , where @xmath178 is the complexity of a shortest paths algorithm in a planar graph with @xmath179 nodes .    to verify  ( [ eq : cut_cond ] ) among the regular sets of type 2 , we fix distinct @xmath106 and scan pairs @xmath180 and @xmath181 .",
    "let @xmath182 be the collection of regular sets @xmath47 of type 2 with @xmath161 and @xmath183 .",
    "for these sets @xmath26 , the right hand side value in ( [ eq : cut_cond ] ) is again a constant , namely , @xmath184 .",
    "so we have to minimize @xmath185 among @xmath186 and compare this minimum with @xmath187 .",
    "now the cycle @xmath149 in @xmath131 generates two disjoint paths @xmath188 in @xmath150 going from @xmath189 to @xmath190 ; e.g. , @xmath14 is a @xmath191 path and @xmath192 is a @xmath193 path",
    ". then @xmath194 .",
    "this prompts an approach to computing the value @xmath195 or duly estimating it from below . in the graph @xmath141",
    "we find ( simple ) @xmath168-shortest paths from each terminal in @xmath189 to each terminal in @xmath190 .",
    "assume for definiteness that @xmath196 ( where we write ` @xmath62 ' for the distance w.r.t .",
    "@xmath168 ) and let @xmath14 and @xmath192 be @xmath168-shortest paths from @xmath137 to @xmath197 and from @xmath164 to @xmath198 , respectively .",
    "suppose that @xmath14 and @xmath192 are disjoint .",
    "then they induce a simple cycle @xmath199 in @xmath131 with @xmath200 , and the faces of @xmath131 lying inside @xmath199 determine a regular set @xmath186 in @xmath5 with @xmath201",
    ". then @xmath202 .",
    "next suppose that @xmath203 .",
    "let @xmath74 be the subgraph of @xmath150 induced by the edges contained in exactly one of @xmath188 .",
    "the vertices @xmath204 are of degree 1 and all other vertices of @xmath74 have even degrees .",
    "hence we can find in @xmath74 two simple paths @xmath205 such that either ( a ) each of @xmath205 connects @xmath189 and @xmath190 , and @xmath205 are _ disjoint _ , or ( b ) @xmath206 connects @xmath137 and @xmath164 ,  @xmath207 connects @xmath197 and @xmath198 , and @xmath205 are _ edge - disjoint_. in particular , @xmath208 .",
    "case  ( a ) is similar to the one considered above . in case  ( b ) , @xmath205 induce simple cycles @xmath209 in @xmath131 , where @xmath199 passes @xmath162 ,  @xmath210 passes @xmath211 , and @xmath212 .",
    "now the faces of @xmath131 lying inside @xmath199 ( resp .",
    "@xmath210 ) determine a regular set @xmath213 ( resp .",
    "@xmath214 ) of type 1 in @xmath5 .",
    "then @xmath215 this implies that if  ( [ eq : cut_cond ] ) is violated for some set in @xmath182 , i.e. , @xmath216 , then so is for at least one of @xmath217 either .",
    "moreover , we obtain the following    [ pr : type2 ] by applying the above procedure to all @xmath218 and @xmath219 , @xmath220 , one can find , in time @xmath221 , a bound @xmath222 for which at least one of the following is true :    \\(i ) @xmath223 ;    \\(ii ) there are two regular sets @xmath224 of type 1 such that @xmath225 and @xmath226 .    finally , to verify  ( [ eq : cut_cond ] ) among the regular sets of type 3 we scan all triples of pairs @xmath227 , @xmath93 . let @xmath228 be the collection of corresponding regular sets related to such a six - tuple .",
    "as before , we have a constant in the right hand side of  ( [ eq : cut_cond ] ) , namely , @xmath229 , and the goal is to find or duly estimate from below the minimum cut capacity @xmath230    acting as in the previous case , we reduce the task to finding in @xmath141 @xmath168-shortest paths from each of @xmath231 to each of @xmath232 for all @xmath233 . among these , we take three paths @xmath234 with the minimum total @xmath168-length such that all endvertices of these paths are different , and each path connects the boundaries of different holes ; let for definiteness @xmath235 connects @xmath236 and @xmath237 ( taking indices modulo 3 ) .    comparing cuts @xmath41 , @xmath238 , with their counterparts ( path systems ) in @xmath141",
    ", we have @xmath239 moreover , using @xmath234 , one can construct a `` checker '' for  ( [ eq : cut_cond ] ) which is at least as strong as the whole collection @xmath240 .",
    "this is immediate when @xmath234 are pairwise disjoint . and if not , we proceed similarly to the previous case .",
    "more precisely , let @xmath74 be the subgraph of @xmath141 induced by the edges that belong to an odd number of paths among @xmath234 .",
    "since all nonterminal vertices in @xmath74 have even degrees , we can find in @xmath74 three simple paths @xmath241 such that : either    \\(a ) each @xmath242 connects @xmath231 and @xmath243 , and @xmath241 are pairwise disjoint , or    \\(b ) each @xmath242 connects @xmath236 and @xmath244 , and @xmath241 are pairwise edge - disjoint , or    \\(c ) for some @xmath245 ,  @xmath242 connects @xmath236 and @xmath244 , each of @xmath246 connects @xmath232 and @xmath247 , the paths @xmath246 are disjoint and they are edge - disjoint from @xmath242 .    in particular , @xmath248 . in case  ( a ) , we obtain a required set @xmath238 . in case",
    "( b ) , @xmath241 induce simple cycles @xmath249 in @xmath131 , where @xmath250 passes @xmath251 , which in turn determine regular sets @xmath252 of type 1 satisfying @xmath253 and @xmath254 . and",
    "case  ( c ) gives regular sets @xmath255 and @xmath256 such that @xmath257 and @xmath258 .",
    "this leads to the following    [ pr : type3 ] by applying the above procedure to all sets of six edges @xmath259 , @xmath93 , one can find , in time @xmath260 , a bound @xmath261 for which at least one of the following is true :    \\(i ) @xmath262 ;    \\(ii ) there are three regular sets @xmath263 of type 1 such that @xmath264 and @xmath265 ;    \\(iii ) there are two regular sets @xmath224 such that @xmath160 ,  @xmath266 , where @xmath245 , and @xmath267 .",
    "in particular , propositions  [ pr : type1 ] ,  [ pr : type2 ] ,  [ pr : type3 ] give the following    [ cor : ver_cut ] to verify validity or violation of cut condition  ( [ eq : cut_cond ] ) for @xmath24 reduces to @xmath169 shortest paths computations in a dual planar graph plus @xmath148 elementary operations .",
    "in the procedure of verifying the ( 2,3)-metric condition for @xmath23 , described in this section , we also use a technique of shortest paths in the dual graph @xmath141 .    consider a regular ( 2,3)-metric @xmath58 and its corresponding partition @xmath268 ( see  ( [ eq : reg23 ] ) ) . for @xmath170 ,",
    "consider the cycle @xmath94 . by the regularity of @xmath64 , this cycle shares two edges with the cut @xmath269 , denoted as @xmath270 , and two edges with @xmath271 , denoted as @xmath272",
    "; let @xmath273 occur in this order clockwise in @xmath94 ( taking indices modulo 3 ) .",
    "note that , although the segments @xmath274\\cap b(h_i)$ ] and @xmath275\\cap b(h_i)$ ] are disjoint , the edges @xmath276 and @xmath277 may coincide , and similarly for @xmath278 and @xmath279 .",
    "so , for @xmath280 , the cut  @xmath281 meets @xmath282 by @xmath283 , meets @xmath284 by @xmath285 , and does not meet @xmath286 .",
    "since the region @xmath287 is simply connected , the cut @xmath281 corresponds to a simple cycle @xmath288 in @xmath131 ; it passes the elements @xmath289 ( in the counterclockwise order ) .",
    "the cycle @xmath288 turns into two disjoint paths in @xmath141 : path @xmath290 connecting the terminals @xmath291 and @xmath292 , and path @xmath293 connecting @xmath294 and @xmath295 .",
    "see the picture .",
    "this correspondence gives @xmath296 , implying @xmath297 taking into account that no edge of @xmath5 connects @xmath114 and @xmath115 .    in order to express @xmath68 ,",
    "consider arbitrary edges @xmath298 occurring in this order in a cycle @xmath94 , possibly with @xmath299 for some @xmath56 ( letting @xmath300 ) .",
    "removal of these edges from the cycle produces four segments @xmath301 , where @xmath302 is the ( possibly empty ) segment between @xmath303 and @xmath304 .",
    "let @xmath305 be the sum of demands @xmath306 over the pairs @xmath7 connecting neighboring segments @xmath307 plus twice the sum of demands @xmath306 over @xmath7 connecting either @xmath308 and @xmath309 , or @xmath310 and @xmath311 .",
    "now for @xmath93 , take as @xmath298 the edges @xmath312 , respectively .",
    "one can see that the contribution to @xmath68 from the demand pairs on @xmath94 is just @xmath313 .",
    "hence @xmath314    this prompts the idea to minimize @xmath66 over a class of ( 2,3)-metrics @xmath64 which for each @xmath93 , use the same quadruple of edges in @xmath94 , and therefore have equal values @xmath68 .",
    "( in reality , we will be forced to include in this class certain non - regular ( 2,3)-metrics as well . )    on this way we come to the following task , which is solved by comparing @xmath315 combinations of the lengths of @xmath168-shortest paths in @xmath141 :    [ eq : task ] given , for @xmath93 , a quadruple @xmath316 of terminals in @xmath139 ( with possible equalities ) , find a set @xmath13 of six ( simple ) paths in @xmath141 minimizing the total @xmath168-length , provided that :    * each path in @xmath13 connects terminals @xmath317 and @xmath318 with @xmath109 , and the set of endvertices of the paths in @xmath13 is exactly @xmath319 ( respecting the possible multiplicities ) .",
    "next we need some terminology and notation .",
    "let @xmath320 denote the quadruple of edges in the cycle @xmath94 of @xmath5 that corresponds to @xmath321 ( respecting the possible multiplicities ) , @xmath93 .",
    "let @xmath322 .",
    "define @xmath323 to be the minimum @xmath168-length of a path system in  ( [ eq : task ] ) and define @xmath324 to be the corresponding combinations of demands .",
    "then @xmath325 for any @xmath326 and @xmath327 where @xmath328 denote the set of regular ( 2,3)-metrics @xmath58 in @xmath5 _ agreeable to _ @xmath329 , i.e. , such that for the partition @xmath101 and @xmath93 , the cuts @xmath330 meet @xmath94 by @xmath320 .    in general , inequality  ( [ eq : zetaa ] ) may be strong .",
    "nevertheless , we can get a converse inequality by extending @xmath328 to a larger class of ( 2,3)-metrics .    * definition . *",
    "let us say that a ( 2,3)-metric @xmath58 is _ semi - regular _ if the sets @xmath331 in @xmath104 are nonempty and satisfy  ( iii ) in  ( [ eq : reg23 ] ) .",
    "( whereas @xmath332 may be empty and ( ii ) of  ( [ eq : reg23 ] ) need not hold ; in particular , subgraphs @xmath110 $ ] need not be connected . ) we show the following    [ pr : semiregular ] @xmath333 is equal to @xmath66 for some semi - regular ( 2,3)-metric @xmath64 agreeable to @xmath329 .",
    "( when a ( 2,3)-metric @xmath64 is semi - regular but not regular , it is `` dominated by two cuts '' , in the sense that there are @xmath334 such that @xmath335 , cf .",
    "* sec .  3 ) .",
    ")    we use the observation that problem @xmath24 remains equivalent when an edge @xmath82 is subdivided into several edges in series , say , @xmath336 ( @xmath337 ) with the same capacity : @xmath338 .",
    "in particular , we can subdivide edges in the boundaries of holes , due to which we may assume that each quadruple @xmath320 consists of different edges . then all terminals in each @xmath321 become different .",
    "another advantage is that when considering an optimal path system @xmath13 in  ( [ eq : task ] ) , we may assume that the paths in @xmath13 are pairwise edge - disjoint . indeed",
    ", if some edge @xmath126 of @xmath141 is used by @xmath339 paths in @xmath13 , we can subdivide the corresponding edge @xmath82 of @xmath5 into @xmath340 edges in series .",
    "this leads to replacing @xmath126 by a tuple of @xmath340 parallel edges ( of the same length @xmath341 ) and we assign each edge to be passed by exactly one of those paths .    we need to improve @xmath13 so as to get rid of `` crossings '' .",
    "more precisely , consider two paths @xmath342 , suppose that they meet at a vertex @xmath31 , let @xmath343 be the edges of @xmath14 incident to @xmath31 , and let @xmath344 be similar edges of @xmath206 .",
    "we say that @xmath14 and @xmath206 _ cross _ ( each other ) at @xmath31 if @xmath345 occur in this order ( clockwise or counterclockwise ) around @xmath31 , and _ touch _ otherwise .",
    "for an inner ( nonterminal ) vertex @xmath31 , let @xmath346 be the set of paths in @xmath13 passing @xmath31 , and @xmath347 the clockwise ordered set of edges incident to @xmath31 and occurring in @xmath346 .",
    "we assign to the edges in @xmath347 labels 1 , 2 or 3 , where an edge @xmath82 is labeled @xmath348 if for the path @xmath349 containing @xmath82 , @xmath14 begins or ends at a terminal @xmath350 in @xmath321 and @xmath82 belongs to the part of @xmath14 between @xmath31 and @xmath350 .",
    "( so if @xmath14 connects @xmath351 and @xmath352 and @xmath353 is the other edge of @xmath14 incident to @xmath31 , then @xmath353 has label @xmath354 . )    we iteratively apply the following _ uncrossing operation_. choose a vertex @xmath31 with @xmath355 . split each path of @xmath346 at @xmath31",
    "this gives , for each edge @xmath356 with label @xmath348 , a path containing @xmath82 and connecting @xmath31 with a terminal in @xmath321 ; denote this path by @xmath357 .",
    "these paths are regarded up to reversing .",
    "now we recombine these paths into pairs as follows , using the obvious fact that for each @xmath93 , the number of edges in @xmath347 with label @xmath348 is at most @xmath358 .",
    "choose two consecutive edges @xmath343 in @xmath347 by the following rule : @xmath343 have different labels , say , @xmath359 , and the number of edges in @xmath347 having the third label @xmath340 ( where @xmath245 ) is strictly less than @xmath358 .",
    "( clearly such @xmath343 exist . )",
    "we concatenate @xmath357 and @xmath357 , obtaining a path connecting @xmath321 and @xmath352 , update @xmath360 , apply a similar procedure to the updated @xmath347 , and so on until @xmath347 becomes empty .",
    "one can see that the resulting path system @xmath361 satisfies property  ( @xmath362 ) in  ( [ eq : task ] ) and has the same total @xmath168-length as before ( thus yielding an optimal solution to  ( [ eq : task ] ) ) , and now no two paths in @xmath361 cross at @xmath31 . note that for some vertices @xmath363 , edge labels in @xmath364 may become false ; this may happen with those vertices @xmath365 that belong to paths in @xmath366 .",
    "for this reason , we finish the procedure of handling @xmath31 by checking such vertices @xmath365 and correcting their labels where needed . in addition , if we reveal that one or another path in @xmath366 is not simple , we remove the corresponding closed subpath in it ( which has zero @xmath168-length since @xmath361 is optimal ) .    at the next iteration",
    "we apply a similar uncrossing operation to another vertex @xmath367 , and so on . upon termination of the process",
    "( taking @xmath368 iterations ) we obtain a path system @xmath369 such that    [ eq : nocross ] @xmath369 is optimal to  ( [ eq : task ] ) and admits no crossings .    property  ( @xmath362 ) in  ( [ eq : task ] ) implies that for each @xmath280 , the sets @xmath370 and @xmath371 are connected by exactly two paths in @xmath369 .",
    "we denote them by @xmath372 and assume that both paths go from @xmath370 to @xmath371 ( reversing paths in @xmath369 if needed ) .",
    "since @xmath372 nowhere cross , we can subdivide the space @xmath373 into two closed regions @xmath374 such that @xmath375 ,  @xmath376 lies `` on the right from @xmath290 '' and `` on the left from @xmath293 '' , while @xmath377 behaves conversely .",
    "( here we give informal , but intuitively clear , definitions of @xmath374 , omitting a precise topological description . )",
    "one of them does not contain the hole @xmath378 ; denote it by @xmath379 .",
    "we observe the following :    [ eq : rscr_p ] no path in @xmath369 meets the interior @xmath380 of @xmath379 .    indeed ,",
    "if @xmath381 goes across @xmath380 , then @xmath14 is different from @xmath290 and @xmath293 ; hence @xmath14 has one endvertex in @xmath382 . since @xmath383",
    ",  @xmath14 must cross the boundary of @xmath379 .",
    "this implies that @xmath14 crosses some of @xmath372 , contrary to  ( [ eq : nocross ] ) .    from  ( [ eq : rscr_p ] ) it follows that the interiors of @xmath384 are pairwise disjoint and that for @xmath280 , the paths @xmath372",
    "begin at consecutive terminals in @xmath370 and end at consecutive terminals in @xmath371 ( assuming as before that both paths go from @xmath370 to @xmath371 ) .",
    "so we may assume for definiteness that    [ eq : order ] for @xmath93 , the terminals @xmath385 of @xmath321 are , respectively , the end of @xmath386 , the end of @xmath387 , the beginning of @xmath388 , and the beginning of @xmath389 ;    see the picture , where for simplicity all paths are vertex disjoint .",
    "then the space @xmath390 can be subdivided into two closed regions @xmath391 and @xmath392 , where the former lies `` on the right from @xmath234 '' and the latter lies `` on the left from @xmath393 '' . one can see that    [ eq : rl ] each edge of @xmath290 is shared by the regions @xmath379 and @xmath391 , and each edge of @xmath293 is shared by @xmath379 and @xmath392 .",
    "now the sets of faces in ( the natural extensions to @xmath131 of ) the regions @xmath394 induce vertex sets @xmath103 in @xmath5 , respectively , giving a partition of @xmath59 .",
    "let @xmath64 be the ( 2,3)-metric determined by this partition .",
    "then  ( [ eq : order ] ) implies that @xmath64 is semi - regular and agreeable to @xmath329 . by  ( [ eq : rl ] ) , for @xmath280",
    ", each edge of @xmath281 connects @xmath395 with one of @xmath332 ( whereas no edge of @xmath5 connects @xmath114 and @xmath115 , or connects @xmath396 and @xmath397 for @xmath109 ) .",
    "therefore , @xmath398 yielding the proposition .",
    "* remark 4 .",
    "* strictly speaking , the metric @xmath64 in the above proof concerns the modified graph , obtained by replacing some edges @xmath399 of the original graph @xmath5 by paths @xmath400 connecting @xmath401 and @xmath31 . when returning to the original @xmath5 , those elements of @xmath395 or @xmath402 that are intermediate vertices of such paths @xmath400 disappear , and as a result , there may appear ( original ) edge connecting @xmath114 and @xmath115 , or @xmath396 and @xmath397 , @xmath109 .",
    "one can see , however , that this does not affect the value @xmath66 for the corresponding @xmath64 .",
    "finally , define @xmath403 .",
    "we conclude with the following    [ cor : delta23 ] ( i ) let @xmath404 , where @xmath320 is a quadruple of edges in @xmath94 .",
    "then @xmath405 for each regular ( 2,3)-metric @xmath64 agreeable to @xmath329 , and there exists a semi - regular ( 2,3)-metric @xmath406 agreeable to @xmath329 such that @xmath407 . in particular , if @xmath408 , then problem @xmath24 has no solution .",
    "\\(ii ) the minimum @xmath409 of excesses @xmath71 over the semi - regular ( 2,3)-metrics @xmath64 can be found in @xmath410 time .",
    "as before , we assume that the capacity - demand pair @xmath43 is eulerian .",
    "the algorithm starts with verifying cut condition  ( [ eq : cut_cond ] ) and ( 2,3)-metric condition for the initial problem @xmath23 , using the efficient procedures described in sections  [ sec : veri_cut ] and  [ sec : veri_23 ] . if some condition is violated , we declare that the problem has no solution .",
    "otherwise the algorithm recursively constructs an integer admissible multiflow .",
    "we may assume , w.l.o.g .",
    ", that all current capacities and demands are nonzero ( for edges @xmath82 with @xmath411 can be immediately deleted from @xmath5 , and similarly for pairs @xmath10 with @xmath412 ) , and that the boundary @xmath94 of each hole @xmath132 is connected and isthmusless , regarding it as a cycle .",
    "an _ iteration _ of the algorithm applied to current @xmath413 ( with @xmath43 eulerian ) chooses arbitrary @xmath170 , an edge @xmath399 in @xmath94 , and a pair @xmath414 ( where @xmath415 denotes the set of demand pairs for @xmath132 ) .",
    "let for definiteness @xmath416 follow in this order in @xmath94 .",
    "for an integer @xmath417 , let us transform @xmath43 into the capacity - demand pair @xmath418 by @xmath419 ( here we add to @xmath6 the demand pair @xmath420 with @xmath421 if it does not exist there , and similarly for @xmath422 .",
    "when @xmath423 ( @xmath424 ) , the pair @xmath420 ( resp .",
    "@xmath422 ) vanishes . )",
    "clearly @xmath418 is eulerian as well .",
    "we say that @xmath418 is obtained by the @xmath425-_reduction _ of @xmath43 .",
    "we call @xmath426 a _ feasible reduction number _ for @xmath427 , or , simply , _ feasible _ , if the problem @xmath428 is still solvable ( and therefore it has an integer solution ) .",
    "the goal of the iteration is to find the maximum feasible @xmath426 and then update @xmath20 accordingly .",
    "here we rely on the existence of an evident transformation of an integer admissible multiflow @xmath429 for @xmath418 into an integer admissible multiflow @xmath19 for @xmath43 : extract from @xmath429 an integer subflow @xmath430 from @xmath431 to @xmath401 and an integer subflow @xmath432 from @xmath31 to @xmath433 , of value @xmath426 each , and increase the flow between @xmath431 and @xmath433 by concatenating @xmath434 and the flow of value @xmath426 through the edge @xmath82 .",
    "the procedure of finding the maximum feasible @xmath426 consists of @xmath315 steps .",
    "we use a consequence from assertions in sections  [ sec : veri_cut ] ,  [ sec : veri_23 ] ( using notation from these sections ) .",
    "[ pr : nu ] let @xmath435 and let @xmath418 be obtained by the @xmath425-reduction of @xmath43 .",
    "suppose that @xmath24 is solvable but @xmath428 is not .",
    "let @xmath436 be the minimum of @xmath437 .",
    "then @xmath436 is the minimum excess for @xmath418 among the regular sets and semi - regular ( 2,3)-metrics .",
    "since @xmath428 has no solution , at least one of @xmath438 , @xmath173 , and @xmath439 is negative ( by theorems  [ tm:3hole ] ,  [ tm:3h_sharp ] ) .",
    "also @xmath440 for @xmath441 ( by propositions  [ pr : type2 ] ,  [ pr : type3 ] ) .",
    "hence @xmath442 .",
    "suppose that @xmath443 .",
    "then we are in case  ( ii ) of proposition  [ pr : type2 ] ; let @xmath224 be as in this case .",
    "then @xmath26 and @xmath444 are of type 1 and concern different holes .",
    "therefore , under the transformation @xmath445 the excess of one of @xmath224 does not change .",
    "indeed , assuming for definiteness that @xmath446 ( where , as before , @xmath447 are in @xmath94 ) , we observe that none of @xmath448 is separated by @xmath26 , whence @xmath449 . now since @xmath450 and @xmath451 ( as @xmath24 is solvable )",
    ", we have @xmath452 .",
    "but then @xmath453 and @xmath454 imply @xmath455 .",
    "next suppose that @xmath456 .",
    "then we are in case  ( ii ) or  ( iii ) of proposition  [ pr : type3 ] . arguing as above",
    ", we can conclude that there is a regular set @xmath457 ( which is one of @xmath263 in case  ( ii ) , and one of @xmath224 in case  ( iii ) ) such that @xmath458 .",
    "this implies that @xmath459 for some @xmath460 .",
    "the maximum feasible @xmath426 is computed in at most three steps .",
    "first we try to take as @xmath426 the maximum possible value , namely , @xmath462 ; let @xmath463 be defined as in  ( [ eq : split ] ) for this @xmath464 .",
    "we determine the number @xmath465 ( using procedures from sections  [ sec : veri_cut],[sec : veri_23 ] and relying on proposition  [ pr : nu ] ) . if @xmath466 then @xmath467 is as required .    and",
    "if @xmath468 , we take @xmath469 , define @xmath470 as in  ( [ eq : split ] ) for this @xmath471 and @xmath20 as before , and find @xmath472 ( step 2 ) . again ,",
    "if @xmath473 then @xmath471 is just the desired @xmath426 .",
    "we argue in a similar way as for an integer splitting in  @xcite . for a regular set @xmath47 ,",
    "define @xmath476 , where we set @xmath477 if @xmath26 separates vertices @xmath478 and @xmath479 , and 0 otherwise . for",
    "a semi - regular ( 2,3)-metric @xmath64 , define @xmath480 . then @xmath481 and @xmath482 ( since both @xmath483 and @xmath64 are metrics ) .",
    "moreover , one can check that @xmath484 and  @xmath485 , and that if @xmath486 is obtained by the @xmath487-reduction of @xmath418 for an arbitrary @xmath488 , then @xmath489    let @xmath490 be the maximum feasible reduction number for @xmath427 .",
    "when @xmath466 , the equality @xmath491 is obvious , so suppose that @xmath492 .",
    "if @xmath493 is achieved by the excess ( w.r.t .",
    "@xmath463 ) of a semi - regular ( 2,3)-metric @xmath64 and if @xmath494 , then using the second expression in  ( [ eq : new_excess ] ) and the equality @xmath495 , we have @xmath496 where @xmath497 equals 0 if @xmath493 is divided by 4 , and equals 2 otherwise .",
    "( recall that the excess of any ( 2,3)-metric is even when the capacity - demand pair is eulerian . ) in this case we have @xmath498 .",
    "indeed for @xmath499 , the pair @xmath418 obtained by the @xmath487-reduction of @xmath43 would give @xmath500 ; so @xmath488 is infeasible .",
    "now let @xmath503 .",
    "note that for any semi - regular metric @xmath406 with @xmath504 , the facts that @xmath505 and @xmath506 imply that @xmath507 for any @xmath418 obtained by the @xmath487-reduction of @xmath43 with @xmath508 .",
    "therefore , @xmath509 is achieved by either a set @xmath26 with @xmath510 or a semi - regular ( 2,3)-metric @xmath511 with @xmath512 .",
    "this implies @xmath513 .",
    "now we finish our description as follows .",
    "suppose that , at an iteration with @xmath518 , the capacity of @xmath82 becomes zero and the deletion of @xmath82 from @xmath5 causes merging @xmath132 with another hole @xmath519 .",
    "then we can proceed with an efficient procedure for solving the corresponding eulerian 2-hole demand problem . similarly ,",
    "if the demand on @xmath7 becomes zero and if the deletion of @xmath7 makes @xmath415 empty , then we can withdraw the hole @xmath132 , again obtaining the eulerian 2-hole case .",
    "finally , suppose that we have the situation when for some @xmath20 , the holes @xmath520 are different ( and the capacities of all edges are positive ) , each @xmath521 is nonempty , but the maximum feasible reduction number for any corresponding pair @xmath522 is zero .",
    "we assert that this is not the case .    indeed ,",
    "suppose such @xmath20 exist .",
    "the problem @xmath24 is solvable , and one easily shows that there exists an integer solution @xmath12 to it such that : for some path @xmath523 with @xmath524 , some edge @xmath82 of @xmath14 belongs to the boundary of the same hole @xmath132 that contains the ends @xmath525 . but",
    "this implies that @xmath526 and that @xmath527 is feasible for @xmath528 ; a contradiction .        in conclusion of this paper ,",
    "recall that when @xmath72 and @xmath43 is eulerian , the solvability of @xmath24 implies the existence of a _ half - integer _",
    "solution ( see ( c ) in the introduction ) .",
    "open question _ : does there exist a polynomial - time ( not necessarily `` purely combinatorial '' ) algorithm to find such a solution ? ( note that the solvability of @xmath24 can be verified in strongly polynomial time , by using a version of ellipsoid method . )"
  ],
  "abstract_text": [
    "<S> we consider an undirected multi(commodity)flow demand problem in which a supply graph is planar , each source - sink pair is located on one of three specified faces of the graph , and the capacities and demands are integer - valued and eulerian . </S>",
    "<S> it is known that such a problem has a solution if the cut and ( 2,3)-metric conditions hold , and that the solvability implies the existence of an integer solution . </S>",
    "<S> we develop a purely combinatorial strongly polynomial solution algorithm </S>",
    "<S> .    _ keywords _ : multi(commodity)flow , planar graph , cut condition , ( 2,3)-metric condition    _ ams subject classification _ : 90c27 , 05c10 , 05c21 , 05c85 </S>"
  ]
}