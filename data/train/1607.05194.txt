{
  "article_text": [
    "in medical image analysis , image segmentation is an important task and is primordial to visualize and quantify the severity of the pathology in clinical practice .",
    "multi - modality imaging provides complementary information to discriminate specific tissues , anatomies and pathologies .",
    "however , manual segmentation is long , painstaking and subject to human variability . in the last decades",
    ", numerous automatic approaches have been developed to speed up medical image segmentation .",
    "these methods can be grouped into two categories : the first , _ multi - atlas approaches _ estimate on - line intensity similarities between the subject being segmented and multi - atlases ( images with expert labels ) .",
    "these techniques have shown excellent results in structural segmentation when using non - linear registration @xcite ; when combined with non - local approaches they have proven effective in segmenting diffuse and sparse pathologies ( ie .",
    "multiple sclerosis ( ms ) lesions @xcite ) as well as more complex multi - label pathology ( ie .",
    "glioblastoma @xcite ) .",
    "in contrast , _ model - based approaches _ are typically trained offline to identify a discriminative model of image intensity features .",
    "these features can be predefined by the user ( e.g. with random forests @xcite ) or extracted and learned hierarchically directly from the images @xcite .",
    "both strategies are typically optimized for a specific set of multi - modal images and usually require these modalities to be available . in clinical settings , image acquisition and patient artifacts , among other hurdles , make it difficult to fully exploit all the modalities ; as such , it is common to have one or more modalities to be missing for a given instance .",
    "this problem is not new , and the subject of missing data analysis has spawned an immense literature in statistics ( e.g. @xcite ) . in medical imaging , a number of approaches have been proposed , some of which require to re - train a specific model with the missing modalities or to synthesize them @xcite .",
    "synthesis can improve multi - modal classification by adding information of the missing modalities in the context of a simple classifier such as random forests @xcite .",
    "approaches to imitate with fewer features a classifier trained with a complete set of features have also been proposed @xcite .",
    "nevertheless , it should stand to reason that a more complex model should be capable of extracting relevant features from just the available modalities without relying on artificial intermediate steps such as imputation or synthesis .",
    "this paper proposes a deep learning framework ( hemis ) that can segment medical images from incomplete multi - modal datasets .",
    "deep learning @xcite has shown an increasing popularity in medical image processing for segmenting but also to synthesize missing modalities @xcite . here",
    ", the proposed approach learns , separately for each modality , an embedding of the input image into a latent space . in this space ,",
    "arithmetic operations ( such as computing first and second moments of a collection of vectors ) are well defined and can be taken over the different modalities available at inference time .",
    "these computed moments can then be further processed to estimate the final segmentation .",
    "this approach presents the advantage of being robust to any combinatorial subset of available modalities provided as input , without the need to learn a combinatorial number of imputation models .",
    "we start by describing the method (  [ sec : method ] ) , follow with a description of the datasets (  [ sec : data ] ) and experiments (  [ sec : results ] ) and finally offer concluding remarks (  [ sec : concl ] ) .",
    "typical convolutional neural network ( cnn ) architectures take a multiplane image as input and process it through a sequence of convolutional layers ( followed by nonlinearities such as @xmath0 ) , alternating with optional pooling layers , to yield a per - pixel or per - image output @xcite . in such networks",
    "every input plane is assumed to be present within a given instance : since the very first convolutional layer mixes input values coming from all planes , any missing plane introduces a bias in the computation that the network is not equipped to deal with .",
    "we propose an approach wherein each modality is initially processed by its own convolutional pipeline , independently of all others .",
    "after a few independent stages , feature maps from all available modalities are _ merged _ by computing mapwise statistics such as the mean and the variance , quantities whose expectation does not depend on the number of terms ( i.e. modalities ) that are provided . after merging ,",
    "the mean and variance feature maps are concatenated and fed into a final set of convolutional stages to obtain network output .",
    "this is illustrated in fig .",
    "[ fig : hemis ] . in this procedure",
    ", each modality contributes a separate term to the mean and variance ; in contrast to a vanilla cnn architecture , a missing modality does not throw this computation off : the mean and variance terms simply become estimated with larger uncertainty . in seeking to be robust to any subset of missing modalities , we call this approach _ hetero - modal _ rather than multi - modal , recognizing that in addition to taking advantage of several modalities , it can take advantage of a diverse , instance - varying , set of modalities .",
    "in particular , it does not require that a `` least common denominator '' modality be present for every instance , as sometimes needed by common imputation methods .",
    ", are provided to independent modality - specific convolutional layers in the * back end*. feature maps statistics ( first & second moments ) are computed in the * abstraction layer * , which after concatenation are processed by further convolutional layers in the * front end * , yielding pixelwise classifications outputs . ]",
    "let @xmath1 denote a modality within the set of available modalities for a given instance , and @xmath2 represent the image of the @xmath3-th modality . for simplicity , in this work",
    "we assume 2d data ( e.g. a single slice of a tomographic image ) , but it can be extended in an obvious way to full 3d sections . as shown on fig .",
    "[ fig : hemis ] , hemis proceeds in three stages :    _ 1 . back",
    "end : _ in our implementation , this consists of two convolutional layers with , the second followed with a @xmath4 max - pooling layer , denoted respectively @xmath5 and @xmath6 . to ensure that the output layer consists of the same number of pixels as the input image , the convolutions are zero - padded and the stride for all operations ( including max - pooling ) is 1 . in particular , pooling with a stride of 1 _ does not downsample _ , but simply `` thickens '' the feature maps ; this is found to add some robustness to the results . the number of feature maps in each layer is given in fig .",
    "[ fig : hemis ] .",
    "let @xmath7 be the the @xmath8-th feature map of @xmath9 .",
    "abstraction layer : _ modality fusion is computed here , as first and second moments across available modalities in @xmath10 , separately for each feature map @xmath8 , @xmath11 =       \\frac{1}{|\\mathcal{k}| }       \\sum_{k \\in \\mathcal{k } } c_{k,\\ell}^{(2 ) }    \\quad\\text{and}\\quad    \\widehat{\\mathrm{var}}_{\\ell}\\left[c^{(2)}\\right ] =       \\frac{1}{|\\mathcal{k}|-1 }       \\sum_{k \\in \\mathcal{k } } \\left ( c_{k,\\ell}^{(2 ) } -              \\widehat{\\mathrm{e}}_{\\ell}\\left[c^{(2)}\\right ] \\right)^2\\!\\!,\\ ] ] with @xmath12 $ ] defined to be zero if @xmath13 ( a single available modality ) .",
    "front end : _ finally the front end combines the merged modalities to produce the final model output . in our implementation , we concatenate all @xmath14 $ ] and @xmath15 $ ] feature maps , pass them through a convolutional layer @xmath16 with relu activation , to finish with a final layer @xmath17 that has as many feature maps as there are target segmentation classes .",
    "the pixelwise posterior class probabilities are given by applying a softmax function across the @xmath17 feature maps , and a full image segmentation is obtained by taking the pixelwise most likely posterior class .",
    "no further postprocessing on the resulting segment classes ( such as smoothing ) is done .",
    "* pseudo - curriculum training procedure  *    to carry out segmentation efficiently , the model is trained fully convolutionnally to minimize a pixelwise class cross - entropy loss , in the spirit of @xcite .",
    "it has long been known that noise injection during training is a powerful technique to make neural networks more robust , as shown among others with denoising autoencoders @xcite , and dropout and related procedures @xcite . here",
    ", we make the hemis architecture robust to missing modalities by randomly dropping any number for a given training example .",
    "inspired by previous works on curriculum learning @xcite  where the model starts learning from easy scenarios before turning to more difficult ones ",
    "we used a pseudo - curriculum learning scheme where after few warmup epochs where all modalities are shown to the model , we start randomly dropping modalities , ensuring a higher probability of dropping zero or one modality only .",
    "* interpretation as an embedding  *    an embedding is a mapping from an arbitrary source space to a target real - valued vector space of fixed dimensionality . in recent years",
    ", embeddings have been shown to yield unexpectedly powerful representations for a wide array of data types , including single words @xcite , variable - length word sequences and images @xcite , and more .    in the context of hemis ,",
    "the back end can be interpreted as learning to separately map each modality into an _ embedding common to all modalities _ , within which vector algebra operations carry well - defined semantics . as such",
    ", computing empirical moments to carry out modality fusion is sensible .",
    "since the model is trained entirely end - to - end with backpropagation , the key aspect of the architecture is that this embedding only needs be defined implicitly as that which minimizes the overall training loss .",
    "cross - modality interactions can be captured within specific embedding dimensions , as long as there are a sufficient number of them ( i.e. enough feature maps within @xmath10 ) , as they can be combined by @xmath16 .    with this interpretation ,",
    "the back end consists of a modular assembly of operators , viewed as reusable building blocks that may or may not be needed for a given instance , each computing the embedding from its own input modality .",
    "these projections are summarized in the abstraction layer ( with a mean and variance , although additional summary statistics are simple to entertain ) , and this summary further processed in the front end to yield final model output .",
    "we studied the hemis framework on two neurological pathologies : multiple sclerosis ( ms ) with the ms grand challenge ( msgc ) and a large relapsing remitting ms ( rrms ) cohort , as well as glioma with the brain tumor segmentation ( brats ) dataset @xcite .    *",
    "ms * _ msgc : _ the msgc dataset @xcite provides 20 training mr cases with manual ground truth lesion segmentation and 23 testing cases from the boston children s hospital ( chb ) and the university of north carolina ( unc ) .",
    "we downloaded the co - registered t1w , t2w , flair images for all 43 cases as well as the ground truth lesion mask images for the 20 training cases .",
    "while lesions masks for the 23 testing cases are not available for download , an automated system is available to evaluate the output of a given segmentation algorithm .    _",
    "rrms : _ this dataset is obtained from a multi - site clinical study with 300 relapsing - remitting ms ( rrms ) patients ( mean age 37.5  yrs , sd 10.0  yrs ) .",
    "each patient underwent an mri that included sagittal t1w , t2w and t1 post - contrast ( t1c ) images .",
    "the mri data were acquired on 1.5 t scanners from different manufacturers ( ge , philips and siemens ) .    * brats * the _ brats-2015 _ dataset contains 220 subjects with high grade and 54 subjects with low grade tumors .",
    "each subject contains four mr modalities ( flair , t1w , t1c and t2 ) and comes with a voxel level segmentation ground truth of 5 labels : _ healthy _ , _ necrosis _ , _ edema _ , _ non - enhancing tumor _ and _ enhancing tumor_. as done in @xcite , we transform each segmentation map into 3 binary maps which correspond to 3 tumor categories , namely ; _ complete _ ( which contains all tumor classes ) , _ core _ ( which contains all tumor subclasses except `` edema '' ) and _ enhancing _ ( which includes the `` enhanced tumor '' subclass ) . for each binary map , the dice similarity coefficient ( dsc )",
    "is calculated @xcite .    _",
    "brats-2013 _ contains two test datasets ; challenge and leaderboard .",
    "the challenge dataset contains 10 subjects with high grade tumors while the leaderboard dataset contains 15 subjects with high grade tumors and 10 subject with low grade tumors .",
    "there are no ground truth provided for these datasets and thus quantitative evaluation can be achieved via an online evaluation system  @xcite . in our experiments",
    "we used challenge and leaderboard datasets to compare the hemis segmentation performance to the state - of - the - art , when trained on all modalities .",
    "* pre - processing and implementation details  *    before being provided to the network , bias field correction @xcite and intensity normalization with a zero mean , truncation of 0.001 quantile and unit variance is applied to the image intensity .",
    "the multi - modal images are co - registered to the t1w and interpolated to 1 mm isotropic resolution .",
    "we used keras library @xcite for our implementation . to deal with class imbalance",
    ", we adopt the patch - wise training procedure mentioned in @xcite .",
    "we first train the model with a balanced dataset which allows learning features that are agnostic to the class distribution . in a second phase ,",
    "we train only the final classification layer with a distribution close to the ground truth .",
    "this ensures that we learn good features yet keep the correct class priors .",
    "the method was trained using an nvidia titanx gpu , with a stochastic gradient learning rate of @xmath18 , decay constant of @xmath19 and nesterov momentum coefficient of @xmath20 @xcite . for both brats-2015 and ms ,",
    "we split the dataset into three separate subsets ",
    "train , valid and test  with ratios of 70% , 10% and 20% respectively . to avoid over - fitting we used early stopping on the validation set .",
    "we first validate hemis performance against state - of - the - art segmentation methods on the two challenge datasets : msgc and brats . since the test data and the ranking table for brats 2015 are not available , we submitted results to brats 2013 challenge and leaderboard .",
    "these results are presented in table [ tab : brats_submission ] .",
    "are from methods competing in the brats 2013 challenge for which a static table is provided at https://www.virtualskeleton.ch/brats/staticresults2013 .",
    "since then , other methods have been added to the scoreboard but for which no reference is available . ] as we observe , hemis outperforms tustison et  al .",
    "@xcite , the winner of the brats 2013 challenge , on most tumor region categories .",
    "the msgc dataset illustrates a direct application of hemis flexibility as only three modalities ( t1w , t2w and flair ) are provided for a small training set .",
    "therefore , given the small number of subjects , we first trained hemis on rrms dataset with four modalities and fine - tuned on msgc .",
    "our results were submitted to the msgc website , with a resuts summary appearing in table  [ tab : fullresultsmsgc ] .",
    "the msgc segmentation results include three other supervised approaches ; when compared to them , hemis obtains highly competitive results with a combined score of 83.2% , where 90.0% would represent human performance given inter - rater variability .",
    "the main advantage of hemis lies in its ability to deal with missing modalities , specifically when different subjects are missing different modalities . to illustrate the model s flexibility in such circumstances , we compare hemis performance to two common approaches to deal with random missing modalities .",
    "the first , _ mean - filling _ , is to replace a missing modality by the modality s mean value . in our case since all means are zero by construction , replacing a missing modality by zeros can be viewed as imputing with the mean .",
    "the second approach is to train a _",
    "multi - layer perceptron _",
    "( mlp ) to predict the expected value of specific missing modality given the available ones . since",
    "neural networks are generally trained for a unique task , we need to train 28 different mlps ( one for each @xmath21 in table  [ tab : big_table ] for a given dataset ) to account for different possibilities of missing modalities .",
    "we used the same mlp architecture for all these models , which consists of 2 hidden layers with 100 hidden units each , trained to minimize the mean squared error .",
    "[ fig : ms_imputed_modalities ] shows an example of predicted modalities for an ms patient .",
    "table  [ tab : big_table ] shows the dsc for this experiment on the test set . on the brats dataset , for the core category",
    ", hemis achieves the best segmentation in almost all cases ( 14 out of 15 ) and for the complete and enhancing categories it leads in most cases ( 10 and 9 cases out of 15 respectively ) .",
    "also , the mean - filling approach hardly outperforms hemis or mlp - imputation .",
    "these results are consistent with the ms lesion segmentation dataset , where hemis outperforms other imputation approaches in 9 out of 15 cases . in scenarios where only one or two",
    "modalities are missing , while both hemis and mlp - imputation obtain good results , hemis outperforms the latter in most cases on both datasets . on brats ,",
    "when missing 3 out of 4 modalities , hemis outperforms the mlp in a majority of cases . moreover , whereas the hemis performance only gradually drops as additional modalities become missing , the performance drop for mlp - imputation and mean - filling is much more severe . on the rrms cohort , the mlp - imputation appears to obtain slightly better segmentations when only one modality is available .    although it is expected that tumor sub - label segmentations should be less accurate with fewer modalities , we should still hope for the model to report a sensible characterization of the tumor `` footprint '' . while mlp and mean - filling fail in this respect , hemis quite well achieves this goal by outperforming in almost all cases of the complete and core tumor categories .",
    "this can also be seen in fig .  [",
    "fig : seg_result ] where we show how adding modalities to hemis improves its ability to achieve a more accurate segmentation . from table  [",
    "tab : big_table ] , we can also infer that the flair modality is the most relevant for identifying the complete tumor while t1c is the most relevant for identifying core and enhancing tumor categories . on the rrms dataset ,",
    "hemis results are also seen to degrade slower than the other imputation approaches , preserving good segmentation when modalities go missing .",
    "indeed , as seen in fig .",
    "[ fig : seg_result ] , even though with flair alone hemis already produces good segmentations , it is capable of further refining its results when adding modalities , by removing false positives and improving outlines of the correctly identified lesions or tumor .",
    "we have proposed a new fully automatic segmentation framework for heterogenous multi - modal mri using a specialized convolutional deep neural network .",
    "the embedding of the multi - modal cnn back - end allows to train and segment datasets with missing modalities .",
    "we carried out an extensive validation on ms and glioma and achieved state - of - the art segmentation results on two challenging neurological pathology image processing tasks .",
    "importantly , we contrasted the graceful performance degradation of the proposed approach as modalities go missing , compared with other popular imputation approaches , which it achieves without requiring training specific models for every potential missing modality combination",
    ". future work should concentrate on extending the approach to broader modalities outside of mri , such as ct , pet and ultrasound .",
    "brosch , t. , yoo , y. , tang , l.y.w . , li , d.k.b . ,",
    "traboulsee , a. , tam , r. : miccai proceedings , chap .",
    "`` deep convolutional encoder networks for multiple sclerosis lesion segmentation '' , pp . 311 . springer ( 2015 )              havaei , m. , davy , a. , warde - farley , d. , biard , a. , courville , a. , bengio , y. , pal , c. , jodoin , p.m. , larochelle , h. : brain tumor segmentation with deep neural networks .",
    "arxiv preprint arxiv:1505.03540 ( 2015 )    hofmann , m. , steinke , f. , scheel , v. , charpiat , g. , et  al . : mri - based attenuation correction for pet / mri : a novel approach combining pattern recognition and atlas registration .",
    "journal of nuclear medicine 49(11 ) , 18751883 ( 2008 )        long , j. , shelhamer , e. , darrell , t. : fully convolutional networks for semantic segmentation . in : proceedings of the ieee cvprconference on computer vision and pattern recognition .",
    "34313440 ( 2015 )            srivastava , n. , hinton , g. , krizhevsky , a. , sutskever , i. , salakhutdinov , r. : dropout : a simple way to prevent neural networks from overfitting .",
    "j.the journal of mach.ine learninging researchearch 15(1 ) , 19291958 ( 2014 )    styner , m. , lee , j. , chin , b. , chin , m. , commowick , o. , tran , h. , markovic - plese , s. , jewells , v. , warfield , s. : 3d segmentation in the clinic : a grand challenge ii : ms lesion segmentation .",
    "midas 2008 , 16 ( 2008 )        tustison , n.j . ,",
    "shrinidhi , k. , wintermark , m. , durst , c.r . , kandel , b.m . ,",
    "gee , j.c . ,",
    "grossman , m.c . ,",
    "avants , b.b . :",
    "optimal symmetric multimodal templates and concatenated random forests for supervised brain tumor segmentation ( simplified ) with antsr .",
    "neuroinformatics 13(2 ) , 209225 ( 2015 )      vincent , p. , larochelle , h. , bengio , y. , manzagol , p.a . : extracting and composing robust features with denoising autoencoders . in : proc.eedings of the 25th international conf.erence on mmachine learning .",
    ". 10961103 .",
    "acm ( 2008 )    xu , k. , ba , j. , kiros , r. , cho , k. , courville , a. , salakhudinov , r. , zemel , r. , bengio , yoshuaand  courville , a. , salakhudinov , r. , zemel , r. , bengio , y. : show , attend and tell : neural image caption generation with visual attention . in : blei , d. , bach , f. ( eds . )",
    "proceedings of the 32nd international conference on machine learning ( icml-15 ) .",
    "`` 20482057 '' .",
    "jmlr workshop and conference proceedings ( 2015 )"
  ],
  "abstract_text": [
    "<S> we introduce a deep learning image segmentation framework that is extremely robust to missing imaging modalities . instead of attempting to impute or synthesize missing data , the proposed approach learns , for each modality , an embedding of the input image into a single latent vector space for which arithmetic operations ( such as taking the mean ) are well defined . </S>",
    "<S> points in that space , which are averaged over modalities available at inference time , can then be further processed to yield the desired segmentation . as such </S>",
    "<S> , any combinatorial subset of available modalities can be provided as input , without having to learn a combinatorial number of imputation models . </S>",
    "<S> evaluated on two neurological mri datasets ( brain tumors and ms lesions ) , the approach yields state - of - the - art segmentation results when provided with all modalities ; moreover , its performance degrades remarkably gracefully when modalities are removed , significantly more so than alternative mean - filling or other synthesis approaches .    </S>",
    "<S> , multi - modal , deep learning , convolutional neural networks , data abstraction , data imputation </S>"
  ]
}