{
  "article_text": [
    "phylogenetic trees are graphs depicting the evolutionary relationships among species ; thus , they are powerful tools for examining fundamental biological questions and understanding biodiversity ( e.g. , @xcite ) .",
    "the wealth of available genetic sequences has rapidly increased the number of phylogenetic studies from across the tree of life ( e.g. , @xcite ) .",
    "for example , stbase contains a million species trees generated from sequence data in genbank @xcite .",
    "new next - generation sequencing technologies and sequence capture methods ( e.g. , @xcite ) will further increase the rate in which phylogenetic data is generated in the coming years .",
    "this continuous flow of new phylogenetic data necessitates new approaches to store , evaluate , and synthesize existing phylogenetic trees .",
    "recently smith et al",
    ".  introduced tree alignment graphs ( tags ) as a way to analyze large collections of phylogenetic trees @xcite .",
    "tags preserve the structure of the input trees and thus provide an intuitive , interpretable representation of the input trees , which enables users to visually assess patterns of agreement and conflict .",
    "the tag structure also makes it possible to combine trees whose tips include nested taxa ( e.g. , the tips of one tree contain species in taxonomic families , while the tips of another tree contain the families ) , which was true of only a few previous synthesis approaches @xcite .",
    "indeed , a tag was used to merge a taxonomy of all @xmath02.3 million named species with @xmath0500 published phylogenetic trees to obtain an estimate of the tree of life @xcite .    the original tag definition of smith et al .",
    "@xcite depends on the order of the input trees , which can be problematic .",
    "further , the several details of the synthesis process were not specified .",
    "our aim in this paper is to lay the theoretical foundations for further research on tags . to this end",
    ", we first provide a mathematically precise definition of tags which is independent of the order of the input trees ( section [ definition ] ) , and develop an algorithm for constructing tags ( section [ consttag ] ) .",
    "we also describe algorithms to build strict and majority - rule consensus trees using tags ( section [ consensus ] ) .",
    "we show how to check the compatibility among input trees and construct a supertree from compatible phylogenetic trees using a tag ( section [ compatibility ] ) .",
    "finally , we discuss the future applications and problems associated with using tags for assessing and synthesizing the enormous and rapidly growing number of available phylogenetic trees in the future ( section [ discussion ] ) .",
    "[ [ related - work . ] ] related work .",
    "+ + + + + + + + + + + + +    tags are part of a long history of using graph structures to synthesize the relationships among phylogenetic trees with partial taxonomic overlap .",
    "the classic example is the build algorithm @xcite and its later variations ( e.g. , @xcite ) .",
    "these methods yield polynomial - time algorithms to determine whether a collection of input trees is compatible , and , if so , output the parent tree(s ) .",
    "other graph - based algorithms , such as the mincutsupertree @xcite , the modified mincutsupertree @xcite , or the multilevelsupertree @xcite algorithm allow users to synthesize collections of conflicting phylogenetic trees .",
    "although tags share important features with these earlier graph - theoretic approaches , tags display more directly the phylogenetic relationships exhibited by the input trees and therefore provide a more intuitive framework to examine patterns of conflict among trees @xcite .",
    "tags also potentially summarize the information in the input trees with fewer nodes than previous graphs for semi - labeled trees @xcite .",
    "let @xmath1 be a rooted tree . then , @xmath2 and @xmath3 denote , respectively , the root and the leaf set of @xmath1 , and @xmath4 and @xmath5 denote , respectively , the set of vertices and the set of edges of @xmath1 .",
    "the set of all internal vertices of @xmath1 is @xmath6 .",
    "we define @xmath7 to be the partial order on @xmath4 where @xmath8 if @xmath9 is a vertex on the path from @xmath2 to @xmath10 .",
    "if @xmath11 and @xmath8 , then @xmath9 is the _ parent _ of @xmath10 and @xmath10 is a _ child _ of @xmath9 .",
    "two vertices in @xmath1 are _ siblings _ if they share a parent .",
    "let @xmath12 be a finite set of _",
    "labels_. a _",
    "phylogenetic tree on @xmath12 _ is a pair @xmath13 where 1 ) @xmath1 is a rooted tree in which every internal vertex has degree at least three , except @xmath2 , which has degree at least two , and 2 ) @xmath14 is a bijection from @xmath3 to @xmath12 @xcite .",
    "tree @xmath1 is called the _ underlying tree _ of @xmath15 and @xmath14 is called the _ labeling map _ of @xmath15 . for convenience , we will often assume that the set of labels @xmath12 of @xmath15 is simply @xmath16 .",
    "the _ size _ of @xmath15 is the cardinality of @xmath3 .",
    "@xmath15 is _ binary _ ( or _ fully resolved _ )",
    "if every vertex @xmath17 has degree three and @xmath2 has degree two .",
    "let @xmath13 be a phylogenetic tree on @xmath12 and let @xmath18 be any vertex in @xmath4 .",
    "the subtree of @xmath1 rooted at vertex @xmath19 , denoted by @xmath20 , is the tree induced by @xmath21 .",
    "the _ cluster at @xmath18 _ , denoted @xmath22 , is the set of leaf labels @xmath23 .",
    "we write @xmath24 to denote the set of all clusters of @xmath15 .",
    "note that @xmath24 includes trivial clusters ; i.e. , clusters of size one or @xmath25 .      here",
    "we define the tree alignment graph ( tag ) .",
    "our definition is somewhat different from that of smith et al .",
    "we explain these differences later .",
    "we first need an auxiliary notion .",
    "a _ directed multi - graph _ is a directed graph that is allowed to have multiple edges between the same two vertices .",
    "more formally , a directed multi - graph is a pair @xmath26 of disjoint sets ( of vertices and edges ) together with two maps @xmath27 and @xmath28 assigning to each edge @xmath29 an _ initial vertex _ @xmath30 and a _ terminal vertex _",
    "edge @xmath29 is said to be _ directed _ from @xmath30 to @xmath31 .",
    "the _ in - degree _ of a node @xmath18 is the number of edges @xmath29 such that @xmath32 ; the _ out - degree _ of @xmath18 is the number of edges @xmath29 such that @xmath33 .",
    "we call a node with out - degree zero a _ leaf node _ ; all non - leaf nodes are called _",
    "internal nodes_.    a _ directed acyclic ( multi- ) graph _ , _ dag _ for short , is a directed multi - graph with no cycles .",
    "[ tree alignment graph ( tag)][dfn : tag ] let @xmath34 be a collection of phylogenetic trees and @xmath35 .",
    "the _ tree alignment graph _ of @xmath34 is a directed graph @xmath36 along with an injective function @xmath37 , called the _ vertex - labeling function _ , such that    * for each @xmath38 , @xmath39 for some @xmath40 , and * for each @xmath41 and each @xmath42 where @xmath43 , there exists a unique @xmath44 such that @xmath45 and @xmath46 .",
    "figure [ fig : mytag ] illustrates definition [ dfn : tag ] .",
    "( 0,1.2 ) to ( -0.5,0.8 ) ; ( 0,1.2 ) to ( 1.5,0 ) node [ below ] * @xmath47 * ; ( -0.5,0.8 ) to ( 0.3,0 ) node [ below ] * @xmath48 * ; ( -0.5,0.8 ) to ( -0.6,0 ) node [ below ] * @xmath49 * ; ( -0.5,0.8 ) to ( -1.5,0 ) node [ below ] * @xmath50 * ; at ( -0.5,1.3 ) @xmath51 ;    ( 4,1.2 ) to ( 3.5,0.8 ) ; ( 4,1.2 ) to ( 5.5,0 ) node [ black , below ] * @xmath48 * ; ( 3.5,0.8 ) to ( 4.3,0 ) node [ black , below ] * @xmath47 * ; ( 3.5,0.8 ) to ( 3.4,0 ) node [ black , below ] * @xmath49 * ; ( 3.5,0.8 ) to ( 2.5,0 ) node [ black , below ] * @xmath50 * ; at ( 3.5,1.3 ) @xmath52 ;    ( 7.5,1.2 ) to ( 7,0.8 ) node [ black , left ] @xmath18 ; ( 7.5,1.2 ) to ( 8.5,0 ) node [ black , below ] * @xmath29 * ; ( 7,0.8 ) to ( 7.4,0 ) node [ black , below ] * @xmath49 * ; ( 7,0.8 ) to ( 6.5,0 ) node [ black , below ] * @xmath50 * ; at ( 7,1.3 ) @xmath53 ;    ( 7.5,1.5 ) to ( 5.58,0.2 ) ; ( 7.5,1.5 ) to ( 6.78,0.2 ) ; ( 7.6,3 ) to ( 6,1.8 ) ; ( 6,1.6 ) to ( 5.5,0.2 ) ; ( 6,1.6 ) to ( 6.7,0.2 ) ; ( 6,1.6 ) to ( 8,0.18 ) ; ( 7.9,3 ) to ( 9.1,0.2 ) ; ( 8.2,3 ) to ( 9.8,1.8 ) ; ( 10,1.6 ) to ( 5.68,0.2 ) ; ( 10,1.6 ) to ( 6.84,0.2 ) ; ( 9.9,1.6 ) to ( 9.18,0.2 ) ; ( 7.8,3 ) to ( 8.1,0.2 ) ; ( 6.3,2.8 ) to ( 7.3,1.6 ) ; ( 6.3,2.8 ) to ( 10.2,0.15 ) ; ( 6,1.6 ) ellipse ( 6 mm and 2 mm ) ; at ( 6,1.6 ) @xmath50,@xmath49,@xmath48 ;    ( 7.3,1.4 ) ellipse ( 4 mm and 2 mm ) ; at ( 7.3,1.4 ) @xmath50,@xmath49 ;    ( 6.3,2.8 ) ellipse ( 6 mm and 2 mm ) ; at ( 6.3,2.8 ) @xmath50,@xmath49,@xmath29 ;    ( 8,3 ) ellipse ( 7 mm and 2 mm ) ; at ( 8,3 ) @xmath50,@xmath49,@xmath48,@xmath47 ; at ( 5.6,3.2 ) @xmath54 ;    ( 10,1.6 ) ellipse ( 6 mm and 2 mm ) ; at ( 10,1.6 ) @xmath50,@xmath49,@xmath47 ;    ( 5.5,0 ) circle [ radius=0.2 ] ; ( 6.7,0 ) circle [ radius=0.2 ] ; ( 8.1,0 ) circle [ radius=0.2 ] ; ( 9.1,0 ) circle [ radius=0.2 ] ; ( 10.3,0 ) circle [ radius=0.2 ] ;    at ( 5.5,0 ) @xmath50 ; at ( 6.7,0 ) @xmath49 ; at ( 8.1,0 ) @xmath48 ; at ( 9.1,0 ) @xmath47 ; at ( 10.3,0 ) @xmath29 ;    [ [ remarks ] ] remarks : + + + + + + + +    1 .",
    "note that we only use the vertex - labeling function @xmath55 to facilitate the definition and to label the leaf nodes of the tag .",
    "we do not actually label the internal vertices of the tag , since , as the tag gets bigger , assigning labels using @xmath55 becomes impractical .",
    "2 .   having a unique edge in the tag for each input tree edge enables systematically annotating the tag for each individual input tree , as the tag also provides a means for storing phylogenetic trees .",
    "[ lemma1 ] the tag is acyclic",
    ".    stems from the fact that for each edge @xmath56 , @xmath57 .",
    "[ [ comparison - with - smith - et - al.s - tag . ] ] comparison with smith et al.s tag .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    in @xcite , smith et al .",
    "define their tag procedurally , as follows .",
    "let @xmath34 be a collection of phylogenetic trees and @xmath58 .",
    "let @xmath36 be a directed graph along with an injective vertex - labeling function @xmath37 .",
    "initially , @xmath54 has a vertex @xmath59 , and @xmath60 vertices @xmath61 , for each @xmath62 .",
    "next , smith et al.s method process each input tree @xmath63 , in some order , and does the following :    1 .",
    "map each vertex @xmath64 to vertex @xmath65 where @xmath66 .",
    "[ step : add ] map each vertex @xmath67 to the vertex @xmath65 , where @xmath68 , @xmath69 , and @xmath70 . if no such @xmath71 exists , then add new vertex @xmath71 with @xmath72 in @xmath54 .",
    "3 .   in the case of a vertex @xmath67 mapping to multiple vertices in @xmath54 , for each such @xmath73 vertices @xmath74 , where for each @xmath75 there exists @xmath44 such that @xmath76 and @xmath77 , discard all mapping of @xmath18 to @xmath78 , except @xmath79 .",
    "note that @xmath19 can still be mapped to multiple vertices in @xmath54 .",
    "for example , vertex @xmath18 of @xmath80 in fig .",
    "[ fig : mytag ] is mapped to vertices @xmath81 and @xmath82 of @xmath83 in fig .",
    "[ fig : cont ] .",
    "4 .   for edge @xmath84 , add directed edges in @xmath54 from all mappings of @xmath10 to all mappings of @xmath9 .",
    "observe that smith et al.s definition of the tag coincides with definition [ dfn : tag ] when the input trees have completely overlapping leaf label sets ; however , it differs when the input trees have partially overlapping leaf label sets , as we discuss next .",
    "notice that step  [ step : add ] first tries to map a vertex @xmath67 to a vertex @xmath65 for which @xmath85 , and @xmath86 does not have any label of @xmath3 other than that of @xmath22 .",
    "if no suitable match exists , then a new vertex @xmath87 is added to @xmath54 . as a result ,",
    "the set of vertices in the tag that this procedure creates can depend on the order of input trees .",
    "[ fig : cont ] illustrates how changing the order of input trees can lead to different tags for the input trees of fig .",
    "[ fig : mytag ] .",
    "when @xmath53 is processed after @xmath51 and @xmath52 , the vertex @xmath18 of @xmath53 maps to @xmath81 and @xmath82 in step [ step : add ] .",
    "on the other hand , processing @xmath53 before @xmath51 and @xmath52 , necessitates the creation of @xmath88 in the resulting tag .",
    "smith et al .",
    "discussed the possibility of order dependence of their tag and addressed it through a post - processing procedure @xcite .",
    "for the given collection of input trees and the tag that results from the first round of processing , the post - processing procedure recomputes the mapping of each internal vertex of the input tree following step 2 . if the new mapping of an internal vertex of the input tree differs from the old mapping , then the mapping is updated . edges of the resulting tag that correspond to the outdated mapping are removed and edges for the new mapping are added .",
    "for example , there will be no change in tag @xmath83 after applying post - processing procedure .",
    "on the contrary , post - processing will map @xmath89 to @xmath81 and @xmath82 in @xmath90 .",
    "this new mapping will cause adding directed edges , 1 ) from @xmath91 to @xmath81 and @xmath82 , 2 ) from @xmath81 to @xmath92 and @xmath93 , and 3 ) from @xmath82 to @xmath92 and @xmath93 in @xmath90 .",
    "let @xmath94 be the resulting tag after applying post - processing on @xmath90 .",
    "clearly , @xmath83 and @xmath94 are different .",
    "we note that since the post - processing is inadequate for overcoming order - dependence , an algorithm for pre - processing of input trees is in development .",
    "in contrast to smith et al.s tag @xcite , our tag ( in definition 1 ) is independent of the order of input trees .",
    "( 1.3,2.89 ) to ( -0.3,1.7 ) ; ( 1.5,2.84 ) to ( -0.1,1.7 ) ;    ( -0.25,1.5 ) to ( -0.05,0.2 ) ; ( -.15,1.5 ) to ( 0.05,0.2 ) ;    ( -0.05,1.5 ) to ( 0.95,0.2 ) ; ( .05,1.5 ) to ( 1.05,0.2 ) ;    ( .15,1.5 ) to ( 1.95,0.2 ) ; ( 1.85,2.84 ) to ( 2.95,0.2 ) ; ( 1.7,2.84 ) to ( 2,0.2 ) ; ( 2.4,2.85 ) to ( 4,1.7 ) ; ( 2.6,2.85 ) to ( 4.2,1.7 ) ;    ( 4.05,1.5 ) to ( 0.08,0.19 ) ; ( 4.25,1.5 ) to ( 0.28,0.19 ) ;    ( 4.3,1.5 ) to ( 1.05,0.2 ) ; ( 4.5,1.5 ) to ( 1.25,0.2 ) ;    ( 4.45,1.5 ) to ( 3,0.2 ) ; ( 2,2.84 ) to ( 4,0.2 ) ; ( 0,1.5 ) ellipse ( 6 mm and 2 mm ) ; at ( 0,1.5 ) @xmath50,@xmath49,@xmath48 ;    ( 2,3 ) ellipse ( 8 mm and 2 mm ) ; at ( 2,3 ) @xmath50,@xmath49,@xmath48,@xmath47,@xmath29 ; at ( 1,3.3 ) @xmath83 ;    ( 4,1.5 ) ellipse ( 6 mm and 2 mm ) ; at ( 4,1.5 ) @xmath50,@xmath49,@xmath47 ;    ( 0,0 ) circle [ radius=0.2 ] ; ( 1,0 ) circle [ radius=0.2 ] ; ( 2,0 ) circle [ radius=0.2 ] ; ( 3,0 ) circle [ radius=0.2 ] ; ( 4,0 ) circle [ radius=0.2 ] ;    at ( 0,0 ) @xmath50 ; at ( 1,0 ) @xmath49 ; at ( 2,0 ) @xmath48 ; at ( 3,0 ) @xmath47 ; at ( 4,0 ) @xmath29 ;    ( 7.7,3 ) to ( 7.5,1.7 ) ; ( 7.5,1.5 ) to ( 5.58,0.2 ) ; ( 7.5,1.5 ) to ( 6.78,0.2 ) ; ( 8,3 ) to ( 10.3,0.2 ) ; ( 7.6,3 ) to ( 6,1.8 ) ; ( 6,1.6 ) to ( 5.5,0.2 ) ; ( 6,1.6 ) to ( 6.7,0.2 ) ; ( 6,1.6 ) to ( 8,0.18 ) ; ( 7.9,3 ) to ( 9.1,0.2 ) ; ( 8.2,3 ) to ( 9.8,1.8 ) ; ( 10,1.6 ) to ( 5.68,0.2 ) ; ( 10.2,1.6 ) to ( 6.84,0.2 ) ; ( 10.3,1.6 ) to ( 9.18,0.2 ) ; ( 7.8,3 ) to ( 8.1,0.2 ) ; ( 6,1.6 ) ellipse ( 6 mm and 2 mm ) ; at ( 6,1.6 ) @xmath50,@xmath49,@xmath48 ;    ( 7.5,1.5 ) ellipse ( 4 mm and 2 mm ) ; at ( 7.5,1.5 ) @xmath50,@xmath49 ;    ( 8,3 ) ellipse ( 8 mm and 2 mm ) ; at ( 8,3 ) @xmath50,@xmath49,@xmath48,@xmath47,@xmath29 ; at ( 7,3.3 ) @xmath90 ;    ( 10,1.6 ) ellipse ( 6 mm and 2 mm ) ; at ( 10,1.6 ) @xmath50,@xmath49,@xmath47 ;    ( 5.5,0 ) circle [ radius=0.2 ] ; ( 6.7,0 ) circle [ radius=0.2 ] ; ( 8.1,0 ) circle [ radius=0.2 ] ; ( 9.1,0 ) circle [ radius=0.2 ] ; ( 10.3,0 ) circle [ radius=0.2 ] ;    at ( 5.5,0 ) @xmath50 ; at ( 6.7,0 ) @xmath49 ; at ( 8.1,0 ) @xmath48 ; at ( 9.1,0 ) @xmath47 ; at ( 10.3,0 ) @xmath29 ;    the input trees in @xcite always include a taxonomy tree , which contains all of the leaf labels from the input trees and could be a star tree ( i.e. , all the leaf nodes connecting to a root node ) if no taxonomic classification is available . here",
    "we study the tag in the standard supertree framework , so we do not assume that a taxonomy tree is included .",
    "we now present an algorithm for constructing the tag for a collection of phylogenetic trees .",
    "the algorithm first collects clusters by reading through the input trees and making each unique cluster a node in the tag",
    ". it then adds edges between nodes in the tag .",
    "let @xmath34 be the input collection of @xmath95 phylogenetic trees .",
    "let @xmath96 and @xmath97 .",
    "we define a bijection @xmath98 that maps each taxon in @xmath99 to a unique number in @xmath100 . for each tree @xmath13 in @xmath34 ,",
    "the _ bit - string _ of @xmath19 is a binary string of length @xmath101 , where the @xmath102th bit is 1 , if @xmath103 , or 0 , otherwise .",
    "we collect bit - strings from the input trees in a list @xmath104 and construct a tag node for each unique bit - string .    [",
    "[ collecting - bit - strings ] ] collecting bit - strings : + + + + + + + + + + + + + + + + + + + + + + +    the algorithm starts by traversing each input tree in post - order .",
    "when , after traversing its subtree , a vertex @xmath18 is visited , we compute @xmath18 s bit - string as follows .",
    "if @xmath18 is a leaf with label @xmath62 , the bit string for @xmath18 is simply the string of length @xmath101 with a 1 at position @xmath105 and 0s everywhere else .",
    "if @xmath18 is an internal node , its bit - string is the _ or _ of the bit - strings of @xmath18 s children .",
    "after each bit - string is computed , it is stored in @xmath104 . when the traversals of all @xmath95 input trees are complete , @xmath104 has @xmath106 bit - strings .",
    "[ [ filtering - unique - bit - strings ] ] filtering unique bit - strings : + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    to remove duplicates from @xmath104 , we first sort it using _ radix sort _",
    "* chapter 8) . given @xmath107 @xmath49-bit numbers and any positive integer @xmath108 , radix sort sorts these numbers in @xmath109 time . in our case , @xmath110 and @xmath111 ,",
    "giving a running time of @xmath112 .",
    "this quantity is minimized when @xmath113 , giving a running time of @xmath114 .    after sorting @xmath104 , we remove its duplicate bit - strings in a single linear scan .",
    "this can be done in @xmath115 time through standard methods .",
    "[ [ tag - nodes ] ] tag nodes : + + + + + + + + + +    we construct a node in the tag for each unique bit - string in @xmath104 . for bit - strings corresponding to the leaf nodes",
    ", we also associate the appropriate label from @xmath99 using function @xmath98 .",
    "once the vertices of input trees have been mapped to the vertices of tag , we add directed edges to the tag .",
    "we traverse each input tree in post - order .",
    "when a tree traversal visits an internal vertex @xmath18 of an input tree , we find the bit - strings of @xmath18 and @xmath18 s children in @xmath104 and locate the nodes corresponding to them in the tag .",
    "we then add directed edges from the tag node corresponding to @xmath18 to the tag nodes for @xmath18 s children .    for a given collection of @xmath95 phylogenetic trees on @xmath101 labels",
    ", the tag can be built in @xmath116 time .",
    "collecting bit - strings and then sorting them requires @xmath116 time .",
    "the remaining steps take time linear in the size of the input .",
    "let @xmath34 be a collection of @xmath95 input phylogenetic trees with completely overlapping leaf label set of size @xmath101 . the _ strict consensus tree",
    "_ for @xmath34 is the tree whose clusters are precisely those that appear in all the trees in @xmath34 . the _ majority - rule consensus tree _ for @xmath34 is the tree whose clusters are precisely those that appear in more than half ( i.e. , the majority ) of the trees in @xmath117 .",
    "here we show how to build the majority - rule consensus trees for @xmath117 from the tag for @xmath117 .",
    "we then outline the modifications needed to compute the strict consensus tree .",
    "algorithm majorityruletree ( algorithm  [ alg : majority ] ) builds the majority - rule tree for @xmath117 by traversing the tag @xmath54 for @xmath34 .",
    "let @xmath118 and @xmath55 be the vertex - labeling function .",
    "we assume that each vertex @xmath18 in @xmath54 stores the _ cardinality _ of @xmath18  i.e. , the number of taxa in @xmath119  along with @xmath120 , the number of times cluster @xmath119 appears in a tree in @xmath117 .",
    "we also assume that multiple edges between the same two vertices are replaced by a single edge .",
    "the next observation follows from the fact that the input trees have completely overlapping leaf label sets .",
    "[ jobs : rootd ] @xmath54 has precisely one vertex @xmath121 with in - degree zero .",
    "let @xmath18 be a node in @xmath54 .",
    "then , @xmath18 is a _ majority node _ if @xmath122 .",
    "the clusters associated with majority nodes are precisely the clusters of the majority - rule tree .",
    "let the nodes of the majority - rule tree correspond to the majority nodes of @xmath54 .",
    "next we develop an approach to hook up these nodes to actually build the majority - rule tree .",
    "let @xmath71 and @xmath18 be nodes of @xmath54 . then",
    ", @xmath18 is a _ majority ancestor _ of @xmath71 if @xmath18 is a majority node , and there is directed path from @xmath18 to @xmath71 in @xmath54 .",
    "algorithm  [ alg : majority ] is based on the following observation ( parts of which were noted in @xcite ) .",
    "[ obs : majobs ] let @xmath71 and @xmath18 be majority nodes in @xmath54 .",
    "then ,    a.   if there is a directed path from a majority node @xmath71 to a majority node @xmath18 in @xmath54 , then @xmath123 , and b.   [ obs : pt1 ] if @xmath18 is the parent of @xmath71 in the majority - rule tree for @xmath117 , then @xmath18 is the ( unique ) minimum - cardinality majority ancestor of @xmath71 ; further , @xmath124 .",
    "let @xmath71 be a node in @xmath54 .",
    "the _ most recent majority ancestor of @xmath71 _ is the unique minimum - cardinality majority ancestor @xmath71 . for each vertex @xmath65 ,",
    "our algorithm maintains two variables : @xmath125 , a reference to the smallest cardinality majority ancestor of @xmath71 seen thus far , and @xmath126 , the cardinality of @xmath125 .",
    "initially , every node @xmath71 , except the node @xmath121 of in - degree zero , has @xmath127 , representing initial best estimate of the most recent majority ancestor of @xmath71 .",
    "the algorithm revises this estimate repeatedly until it converges on the correct value .",
    "after this process is complete , it is now a simple matter to assemble the majority - rule tree , since , for each majority node @xmath71 , @xmath125 points to @xmath71 s parent in that tree .",
    "algorithm [ alg : majority ] processes the nodes of @xmath54 according to topological order  this ordering exists because @xmath54 is acyclic ( from lemma 1 ) .",
    "when the algorithm visits a node @xmath71 , it examines each successor @xmath18 , and considers two possibilities .",
    "if @xmath71 is a majority node , then @xmath71 may become the new value of @xmath128 , while if @xmath71 is not a majority node , @xmath125 may become the new value of @xmath128 .",
    "by observation  [ obs : majobs ] , the decision depends solely on node cardinalities .",
    "let @xmath121 be the unique vertex in @xmath54 with in - degree @xmath129 perform a topological sort of @xmath130 let @xmath131 be the set of majority nodes in @xmath54 let @xmath1 be the tree with vertex set @xmath132 , where , for every @xmath133 , the parent of @xmath71 in @xmath1 is @xmath125 let @xmath14 be the function that maps each leaf @xmath71 of @xmath1 to @xmath86 @xmath134 [ alg : majority ]    given the tag @xmath54 for a collection @xmath117 of @xmath95 phylogenetic trees on the same @xmath101 leaves , the majority - rule consensus tree of @xmath117 can be computed in @xmath106 time .",
    "correctness can be proved using observation  [ obs : majobs ] . to bound the running time , note that topological sort takes time linear in the size of @xmath54 , and the main loop ( lines  [ step : mainloop][step : endmainloop ] ) examines each node and each edge once .",
    "since the number of edges and nodes in @xmath54 is @xmath106 , the claimed time bound follows .",
    "the algorithm for strict consensus tree is similar to algorithm  [ alg : majority ] , with only one significant difference : instead of dealing with majority nodes , it focuses on _ strict _ nodes , that is , tag nodes @xmath71 such that @xmath135 .",
    "we omit the details , and simply summarize the result .    given the tag for a collection @xmath117 of @xmath95 phylogenetic trees on the same @xmath101 leaves , the strict consensus tree of @xmath117 can be computed in @xmath106 time .",
    "let @xmath15 and @xmath136 be two phylogenetic trees on @xmath12 and @xmath137 , respectively , where @xmath138 .",
    "we say that @xmath136 _ displays _",
    "if , up to suppressing non - root nodes of degree two , the minimum rooted subtree of @xmath136 that connects the elements of @xmath12 _ refines _",
    "@xmath15 , i.e. , @xmath15 can be obtained from it by contracting internal edges . _ suppressing a node of degree two _ means replacing that node and its incident edges by an edge .",
    "let @xmath117 be the input collection of rooted phylogenetic trees .",
    "we say that @xmath117 is _ compatible _ if there exists a phylogenetic tree @xmath15 , called a _",
    "compatible supertree for @xmath139 _ , that simultaneously displays every tree in @xmath117 .",
    "a classic result in phylogenetics is that compatibility can be tested in polynomial time @xcite . in this section ,",
    "we show that compatibility can be tested directly from the tag for @xmath117 .",
    "we need some definitions . as before",
    ", we assume that multiple edges between the same two tag vertices are replaced by a single edge .",
    "the _ extended tag _ is the graph @xmath140 obtained from @xmath54 by adding undirected edges between every two vertices @xmath141 such that @xmath86 and @xmath119 are clusters corresponding to sibling vertices in some tree in @xmath117 .",
    "@xmath140 is a _ mixed _",
    "graph , i.e. , a graph that contains both directed and undirected edges . see fig .",
    "[ fig : comp ] .    ( 1.5,1.3 ) to ( 0,0.7 ) ; ( 1.5,1.3 ) to ( 1.5,-0.1 ) node [ black , below ] * @xmath48 * ; ( 0,0.7 ) to ( 0.4,-0.1 ) node [ black , below ] * @xmath49 * ; ( 0,0.7 ) to ( -.5,-0.1 ) node [ black , below ] * @xmath50 * ; at ( 0,1.4 ) @xmath51 ;    ( 4.5,1.3 ) to ( 3,0.7 ) ; ( 4.5,1.3 ) to ( 4.5,-0.1 ) node [ black , below ] * @xmath47 * ; ( 3,0.7 ) to ( 3.4,-0.1 ) node [ black , below ] * @xmath49 * ; ( 3,0.7 ) to ( 2.5,-0.1 ) node [ black , below ] * @xmath50 * ; at ( 3,1.4 ) @xmath52 ;    ( 7.1,0.2 ) to ( 6.5,-0.8 ) ; ( 7.1,0.2 ) to ( 7.7,-0.8 ) ; ( 8.1,1.4 ) to ( 7.2,0.4 ) ; ( 8.1,1.4 ) to ( 8.9,-0.8 ) ; ( 6.5,-1 ) to ( 7.7,-1 ) ; ( 7.1,0.2 ) to ( 8.9,-1 ) ; ( 7.1,0.2 ) to ( 10.1,-1 ) ;    ( 9.9,1.5 ) to ( 7.28,0.36 ) ; ( 9.9,1.5 ) to ( 10.1,-0.8 ) ; ( 7.1,0.2 ) ellipse ( 3 mm and 2 mm ) ; ( 8.1,1.4 ) ellipse ( 3 mm and 2 mm ) ; ( 9.9,1.5 ) ellipse ( 3 mm and 2 mm ) ; at ( 7.4,1.6 ) @xmath140 ;    ( 6.5,-1 ) circle [ radius=0.2 ] ; ( 7.7,-1 ) circle [ radius=0.2 ] ; ( 8.9,-1 ) circle [ radius=0.2 ] ; ( 10.1,-1 ) circle [ radius=0.2 ] ;    at ( 6.5,-1 ) @xmath50 ; at ( 7.7,-1 ) @xmath49 ; at ( 8.9,-1 ) @xmath48 ; at ( 10.1,-1 ) @xmath47 ;    let @xmath142 be a mixed graph . an _ arc component _ of @xmath143 is a maximal sub - mixed graph @xmath144 of @xmath143 such that for every two nodes @xmath71 and @xmath18 in @xmath144 there is a path from @xmath71 to @xmath18 which consists only directed edges , irrespective of their directions . let @xmath18 be a node of @xmath143 . the mixed graph obtained by deleting @xmath18 and its incident directed and undirected edges is denoted by @xmath145 .",
    "let @xmath146 be a subset of @xmath147 .",
    "we write @xmath148 to denote the ( mixed ) graph obtained from @xmath143 by deleting each node in @xmath146 from @xmath143 .",
    "the _ restriction of @xmath143 to @xmath146 _ , denoted by @xmath149 , is the subgraph of @xmath143 obtained by deleting each node in @xmath150 from @xmath143 .",
    "let @xmath151 be the set of nodes in @xmath140 that have in - degree zero and no incident edges .",
    "find the node sets @xmath152 of the arc components of @xmath153 .",
    "delete all undirected edges of @xmath153 whose endpoints are in distinct arc components . a tree with a root node and @xmath154 as its subtrees .",
    "the extended tag is closely related to the _ restricted descendancy graph _",
    "( rdg ) @xcite .",
    "the rdg has a unique node for each internal input tree node along with @xmath60 leaf nodes .",
    "let @xmath71 and @xmath18 be two input tree nodes , and let @xmath155 and @xmath156 be the corresponding nodes in the rdg . if @xmath71 is a parent of @xmath18 , then there is a directed edge from @xmath155 to @xmath156 in the rdg .",
    "if @xmath71 and @xmath18 are siblings , then there is an undirected edge between @xmath155 and @xmath156 in the rdg . otherwise , there is no edge between @xmath155 and @xmath156 .",
    "the extended tag can be viewed as a compact version of the rdg of @xmath117 .",
    "thus , a slight adaptation of the descendant  algorithm @xcite enables us to determine whether @xmath117 is compatible given its extended tag @xmath140 .",
    "the details of this adaptation are shown in algorithm [ fig : algo2 ] .",
    "the algorithm first attempts to decompose the problem into subproblems , each of which corresponds to one of the subtrees of the compatible supertree .",
    "if no such decomposition exists , then @xmath117 is incompatible .",
    "otherwise , the algorithm identifies a collection of subproblems , each associated with a different arc component , and recursively tests compatibility for each subproblem .",
    "[ thm : compat ] let @xmath140 be the extended tag for a collection @xmath117 of phylogenetic trees .",
    "if @xmath117 is compatible , then descendant@xmath157 returns a compatible supertree for @xmath117 ; otherwise , descendant@xmath157 returns the statement _ not compatible_.    let @xmath158 be the collection of phylogenetic trees after labeling the internal nodes of the input trees in @xmath34 by their clusters .",
    "the order of labels in a cluster does not matter , that is , we assume two labels identical if their respective clusters are identical sets . now",
    "the extended tag of @xmath34 is the same as the rdg of @xmath158 .",
    "the correctness of algorithm [ fig : algo2 ] now follows from the proof of ( * ? ? ?",
    "* preposition 4 ) for @xmath158 .",
    "we omit the details for lack of space .    [ [ running - time ] ] running time : + + + + + + + + + + + + +    following ( * ? ? ?",
    "* preposition 3 ) ) , we can show that if @xmath117 consists of @xmath95 _ fully resolved _",
    "phylogenetic trees on the leaf set of size @xmath101 , then the descendant  subroutine runs in time @xmath159 . we conjecture that the running time can be reduced to @xmath160 using the approach discussed in @xcite .",
    "if , however , the input trees are not fully resolved , the running time increases by a factor of @xmath101 .",
    "[ [ remark . ] ] remark .",
    "+ + + + + + +    as we mention earlier , there are considerable similarities between the extended tag and the rdg . nevertheless , the former has some advantages in practice . while every internal node of a tree in @xmath117 gives rise to a distinct node in the rdg , the extended tag has one node for each unique cluster .",
    "for instance , in the extreme case when @xmath117 contains @xmath95 identical phylogenetic trees on @xmath99 , the rdg has @xmath106 nodes , while the extended tag contains only @xmath161 nodes . more typically , the trees in @xmath117 will share many clusters , and the likelihood of this being the case is especially high when @xmath95 is much larger than @xmath101 .",
    "we have presented a formal definition of the tag that does not depend on the order of the input trees . we have also presented a procedure for building tags , and described how to use tags to find consensus trees and to determine whether a collection of phylogenetic trees is compatible . extending tags to include potentially thousands of input trees from across the tree of life",
    "leads to several future challenges ; two major ones are incorporating trees at different taxonomic levels and finding ways to synthesize conflicting phylogenetic input trees . it may be possible to address the second of these challenges using ideas from the ancestralbuild algorithm @xcite .",
    "dealing with conflict among the input trees is also essential for processing large - scale phylogenetic data sets .",
    "although a visual inspection of the tag provides some insight into the areas of conflict , approaches to quantify phylogenetic conflict within the tag may provide valuable insight into mechanisms causing phylogenetic incongruence among biological datasets and help guide future phylogenetic research .",
    "the synthesis approach of smith et al .",
    "@xcite relies on a subjective ranking of the input trees .",
    "potentially , a mincutsupertree approach , like the multilevelsupertree algorithm @xcite , could be applied to a tag to provide an efficient and effective approach for synthesizing a tree of life .",
    "b.  c. faircloth , j.  e. mccormack , n.  g. crawford , m.  g. harvey , r.  t. brumfield , and t.  c. glenn .",
    "ultraconserved elements anchor thousands of genetic markers spanning multiple evolutionary timescales .",
    ", 61(5):716726 , 2012 .",
    "j.  e. mccormack , b.  c. faircloth , n.  g. crawford , p.  a. gowaty , r.  t. brumfield , and t.  c. glenn .",
    "ultraconserved elements are novel phylogenomic markers that resolve placental mammal phylogeny when combined with species - tree analysis .",
    ", 22:746754 , 2012 .",
    "r.  d.  m. page .",
    "modified mincut supertrees . in d.",
    "gusfield and r.  guig , editors , _ international workshop , algorithms in bioinformatics ( wabi ) _ , volume 2452 of _ lecture notes in computer science _ , pages 300315 .",
    "springer verlag , sept .",
    "2002 .",
    "s.  a. smith , k.  a. cranston , j.  f. allman , j.  w. brown , g.  burleigh , r.  chaudhary , l.  coghill , k.  a. crandall , j.  deng , b.  drew , r.  gazis , k.  gude , d.  s. hibbett , c.  hinchliff , l.  a. katz , h.  d.  l. iv , e.  j. mctavish , c.  l. owen , r.  ree , j.  a. rees , d.  e. soltis , and t.  williams . synthesis of phylogeny and taxonomy into a comprehensive tree of life .",
    "( under review ) ."
  ],
  "abstract_text": [
    "<S> tree alignment graphs ( tags ) provide an intuitive data structure for storing phylogenetic trees that exhibits the relationships of the individual input trees and can potentially account for nested taxonomic relationships . </S>",
    "<S> this paper provides a theoretical foundation for the use of tags in phylogenetics . </S>",
    "<S> we provide a formal definition of tag that  unlike previous definition  does not depend on the order in which input trees are provided . in the consensus case , </S>",
    "<S> when all input trees have the same leaf labels , we describe algorithms for constructing majority - rule and strict consensus trees using the tag . </S>",
    "<S> when the input trees do not have identical sets of leaf labels , we describe how to determine if the input trees are compatible and , if they are compatible , to construct a supertree that contains the input trees . </S>"
  ]
}