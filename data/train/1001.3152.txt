{
  "article_text": [
    "the origin and nature of the dark energy @xcite is one of the most difficult challenges facing physicists and cosmologists now . among all the proposed models to tackle this problem ,",
    "a scalar field is perhaps the most popular one up to now .",
    "the scalar field , denoted by @xmath1 , might only interact with other matter species through gravity , or have a coupling to normal matter and therefore producing a fifth force on matter particles .",
    "this latter idea has seen a lot of interests in recent years , in the light that such a coupling could potentially alleviate the coincidence problem of dark energy @xcite and that it is commonly predicted by low energy effective theories from a fundamental theory .",
    "nevertheless , if there is a coupling between the scalar field and baryonic particles , then stringent experimental constraints might be placed on the fifth force on the latter provided that the scalar field mass is very light ( which is needed for the dark energy ) .",
    "such constraints severely limit the viable parameter space of the model .",
    "different ways out of the problem have been proposed , of which the simplest one is to have the scalar field coupling to dark matter only but not to standard model particles , therefore evading those constraints entirely .",
    "this is certainly possible , especially because both dark matter and dark energy are unknown to us and they may well have a common origin .",
    "another interesting possibility is to have the chameleon mechanism @xcite , by virtue of which the scalar field acquires a large mass in high density regions and thus the fifth force becomes undetectablly short - ranged , and so also evades the constraints .",
    "study of the cosmological effect of a chameleon scalar field shows that the fifth force is so short - ranged that it has negligible effect in the large scale structure formation @xcite for certain choices of the scalar field potential .",
    "but it is possible that the scalar field has a large enough mass in the solar system to pass any constraints , and at the same time has a low enough mass ( thus long range forces ) on cosmological scales , producing interesting phenomenon in the structure formation .",
    "this is the case of some @xmath2 gravity models @xcite , which survives solar system tests thanks again to the chameleon effect @xcite .",
    "note that the @xmath2 gravity model is mathematically equivalent to a scalar field model with matter coupling .",
    "no matter whether the scalar field couples with dark matter only or with all matter species , it is of general interests to study its effects in cosmology , especially in the large scale structure formation .",
    "indeed , at the linear perturbation level there have been a lot of studies about the coupled scalar field and @xmath2 gravity models which enable us to have a much clearer picture about their behaviors now .",
    "but linear perturbation studies do not conclude the whole story , because it is well known that the matter distribution at late times becomes nonlinear , making the behavior of the scalar field more complex and the linear analysis insufficient to produce accurate results to confront with observations .",
    "for the latter purpose the best way is to perform full @xmath0-body simulations @xcite to evolve the individual particles step by step .",
    "@xmath0-body simulations for scalar field and relevant models have been performed before @xcite .",
    "for example , in @xcite the simulation is about a specific coupled scalar field model .",
    "this study however does not obtain a full solution to the spatial configuration of the scalar field , but instead simplifies the simulation by assuming that the scalar field s effect is to change the value of the gravitational constant , and presenting an justifying argument for such an approximation . as discussed in @xcite ,",
    "this approximation is only good in certain parameter spaces and for certain choices of the scalar field potential , and therefore full simulations tare needed to study the scalar field behaviour more rigorously .",
    "recently there have also appeared @xmath0-body simulations of the @xmath2 gravity model @xcite , which do solve the scalar degree of freedom explicitly .",
    "however , embedded in the @xmath2 framework there are some limitations in the generality of these works . as a first thing ,",
    "@xmath2 gravity model ( no matter what the form @xmath3 is ) only corresponds to the couple scalar field models for a specific value of coupling strength @xcite .",
    "second , in @xmath2 models the correction to standard general relativity is through the modification to the poisson equation and thus to the gravitational potential as a whole @xcite , while in the coupled scalar field models we could clearly separate the scalar fifth force from gravity and analyze the former directly @xcite .",
    "also , in @xmath2 models , as well as the scalar - tensor theories , the coupling between matter and the scalar field is universal ( the same to dark matter and baryons ) , while in the couple scalar field models it is straightforward to switch on / off the coupling to baryons and study the effects on baryonic and dark matter clusterings respectively ( as we will do in this paper ) .",
    "correspondingly , the general framework of @xmath0-body simulations in coupled scalar field models could also handle the situation where the chameleon effect is absent and/or scalar field only couples to dark matter , and thus provide a testbed for possible violations of the weak equivalence principle .",
    "in this paper we shall go beyond @xcite and consider the case where the chameleon scalar field couples differently to different species of matter . to be explicit , we consider two matter species , and let one of them have no coupling to the scalar field . because it is commonly believed that normal baryons , being observable in a variety of experiments , should have extremely weak ( if any )",
    "coupling to scalar fields , we call the uncoupled matter species in our simulation `` baryons '' .",
    "it is however reminded here that this matter species is not really baryonic in the sense that it does not experience normal baryonic interactions .",
    "the inclusion of true baryons will make the investigation more complicated and is thus beyond the scope of the present work .",
    "the paper is organized as follows : in   [ sect : eqns ] we list the essential equations to be implemented in the @xmath0-body simulations and describe briefly the difference from normal lcdm simulations .   [ sect : simu ] is the main body of the paper , in which ",
    "[ subsect : simu_detail ] gives the details about our simulations , such as code description and parameter set - up , ",
    "[ subsect : simu_result ] displays some preliminary results for visualization , such as baryon / cdm distribution , potential / scalar field configuration and the correlation between the fifth force ( for cdm particles ) and gravity ;   [",
    "subsect : simu_ps ] quantifies the nonlinear matter power spectrum of our model , especially the difference from lcdm results and the bias between cdm and baryons ;   [ subsect : simu_mf ] briefly describes the essential modifications one must bear in mind when identifying _",
    "virialized _ halos from the simulation outputs and shows the mass functions for our models ;   [ subsect : simu_prof ]",
    "we pick out two halos from our simulation box and analyzes their total internal profiles , as well as their baryonic / cdm density profiles .",
    "we finally summarize in ",
    "[ sect : con ] .",
    "in this section we first describe the method to simulate structure formation with two differently coupled matter species and the appropriate equations to be used .",
    "those equations for a single matter species have been discussed in details previously in @xcite , but the inclusion of different matter species requires further modifications and we list all these for completeness .",
    "the lagrangian for our coupled scalar field model is",
    "@xmath4 + v(\\varphi ) - c(\\varphi)\\mathcal{l}_{\\mathrm{cdm } } + \\mathcal{l}_{\\mathrm{s}}\\ \\\\end{aligned}\\ ] ] where @xmath5 is the ricci scalar , @xmath6 with @xmath7 newton s constant , @xmath1 is the scalar field , @xmath8 is its potential energy and @xmath9 its coupling to dark matter , which is assumed to be cold and described by the lagrangian @xmath10 .",
    "@xmath11 includes all other matter species , in particular our _ baryons_. the contribution from photons and neutrinos in the @xmath0-body simulations ( for late times , _",
    "i.e. _ , @xmath12 ) is negligible , but should be included when generating the matter power spectrum from which the initial conditions for our @xmath0-body simulations are obtained ( see below ) .",
    "the dark matter lagrangian for a point - like particle with bare mass @xmath13 is @xmath14 where @xmath15 is the coordinate and @xmath16 is the coordinate of the centre of the particle . from this equation",
    "it can be easily derived that @xmath17 also , because @xmath18 where @xmath19 is the four velocity of the dark matter particle , the lagrangian could be rewritten as @xmath20 which will be used below .",
    "( [ eq : dmemt_particle ] ) is just the energy momentum tensor for a single dark matter particle . for a fluid with many particles",
    "the energy momentum tensor will be @xmath21 in which @xmath22 is a volume microscopically large and macroscopically small , and we have extended the 3-dimensional @xmath23 function to a 4-dimensional one by adding a time component . here",
    "@xmath19 is the averaged 4-velocity of the collection of particles inside this volume , and is not necessarily the same as the @xmath24-velocity of the observer .",
    "meanwhile , using @xmath25 it is straightforward to show that the energy momentum tensor for the scalar field is given by @xmath26.\\end{aligned}\\ ] ] so the total energy momentum tensor is @xmath27\\nonumber\\\\ & & + c(\\varphi)t^{\\mathrm{cdm}}_{ab } + t^{\\mathrm{s}}_{ab}\\end{aligned}\\ ] ] where @xmath28 , @xmath29 is the energy momentum tensor for all other matter species including baryons , and the einstein equation is @xmath30 where @xmath31 is the einstein tensor . note that due to the coupling between the scalar field @xmath1 and the dark matter , the energy momentum tensors for either will not be conserved , and we have @xmath32 where throughout this paper we shall use a @xmath33 to denote the derivative with respect to @xmath1 .    finally ,",
    "the scalar field equation of motion ( eom ) from the given lagrangian is @xmath34 where @xmath35 . using eq .",
    "( [ eq : dmlagrangian2 ] ) it can be rewritten as @xmath36    eqs .",
    "( [ eq : emt_tot ] , [ eq : einsteineq ] , [ eq : dm_energy_conservation ] , [ eq : phieom ] ) summarize all the physics that will be used in our analysis .",
    "we will consider a special form for the scalar field potential , @xmath37^{\\mu}},\\end{aligned}\\ ] ] where @xmath38 and @xmath39 are dimensionless constants while @xmath40 has mass dimension four .",
    "as has been discussed in @xcite , @xmath41 to evade observational constraints and @xmath39 can be set to @xmath42 without loss of generality , since we can always rescale @xmath1 as we wish .",
    "meanwhile , the coupling between the scalar field and dark matter particle is chosen as @xmath43 where @xmath44 is yet another dimensionless constant characterizing the strength of the coupling .    as discussed in @xcite , the two dimensionless parameters @xmath38 and @xmath45",
    "have clear physical meanings : roughly speaking , @xmath38 controls the time when the scalar field becomes important in cosmology while @xmath45 determines how important the scalar field would ultimately be .",
    "in fact , the potential given in eq .",
    "( [ eq : potential ] ) is partly motivated by the @xmath2 cosmology @xcite , in which the extra degree of freedom behaves as a coupled scalar field in the einstein frame . as we can see from eq .",
    "( [ eq : potential ] ) , the potential @xmath46 when @xmath47 while @xmath48 when @xmath49 . in the latter case , however , @xmath50 , so that the effective total potential @xmath51 has a global minimum at some finite @xmath1 .",
    "if the total potential @xmath52 is steep enough around this minimum , then the scalar field becomes very heavy and thus follows its minimum dynamically , as is in the case of the chameleon cosmology ( see _ e.g. _",
    "if @xmath53 is not steep enough at the minimum , however , the scalar field will experience a more complicated evolution .",
    "these two different cases can be obtained by choosing appropriate values of @xmath45 and @xmath38 : if @xmath45 is very large or @xmath38 is small then we run into the former situation and if @xmath45 is small and @xmath38 is large we have the second . in reality",
    ", the situation can get even more complicated because when @xmath45 , which characterizes the coupling strength , increases , the cdm evolution could also get severely affected , which in turn has back - reactions on the scalar field itself .",
    "the @xmath0-body simulation only probes the motion of particles at late times , and we are not interested in extreme conditions such as black hole formation / evolution , which mean that taking the non - relativistic limit of the above equations should be a sufficient approximation for our purpose .",
    "the existence of the scalar field and its ( different ) couplings to matter particles lead to the following changes to the @xmath54cdm model : firstly , the energy momentum tensor has a new piece of contribution from the scalar field ; secondly , the energy density of dark matter in gravitational field equations is multiplied by the function @xmath9 , which is because the coupling to scalar field essentially renormalizes the mass of dark matter particles ; thirdly , dark matter particles will not follow geodesics in their motions as in @xmath54cdm , but rather the total force on them has a contribution , the fifth force , from the exchange of scalar field quanta ; finally , cdm particles must be distinguished from baryons so that the fifth force only acts on the former and these two species only interact gravitationally .",
    "this last point is one main difference between the present work and a previous one @xcite .",
    "these imply that the following things need to be modified or added :    1 .",
    "the scalar field @xmath1 equation of motion , which determines the value of the scalar field at any given time and position ; 2 .",
    "the poisson equation , which determines the gravitational potential ( and thus gravity ) at any given time and position , according to the local energy density and pressure , which include the contribution from the scalar field ( as obtained from @xmath1 equation of motion ) ; 3 .",
    "the total force on the dark matter particles , which is determined by the spatial configuration of @xmath1 , just like gravity is determined by the spatial configuration of the gravitational potential ; 4 .",
    "the cdm and baryonic particles must be tagged respectively so that the code knows to assign forces correctly to different species .",
    "we shall describe these one by one now .",
    "for the scalar field equation of motion , we denote @xmath55 as the background value of @xmath1 and @xmath56 as the scalar field perturbation .",
    "then eq .",
    "( [ eq : phieom ] ) could be rewritten as @xmath57 by subtracting the corresponding background equation from it . here",
    "@xmath58 is the covariant spatial derivative with respect to the physical coordinate @xmath59 with @xmath60 the conformal coordinate , and @xmath61 .",
    "@xmath58 is essentially the @xmath62 , but because here we are working in the weak field limit we approximate it as @xmath63 by assuming a flat background ; the minus sign is because our metric convention is @xmath64 instead of @xmath65 . for the simulation here we will also work in the quasi - static limit , assuming that the spatial gradient is much larger than the time derivative , @xmath66 ( which will be justified below ) .",
    "thus the above equation can be further simplified as @xmath67,\\nonumber\\end{aligned}\\ ] ] in which @xmath68 is with respect to the conformal coordinate @xmath60 so that @xmath69 , and we have restored the factor @xmath70 in front of @xmath71 ( the @xmath1 here and in the remaining of this paper is @xmath72 times the @xmath1 in the original lagrangian unless otherwise stated ) .",
    "note that here @xmath22 and @xmath73 both have the dimension of _ mass _ density rather than _ energy _ density .",
    "next look at the poisson equation , which is obtained from the einstein equation in weak - field and slow - motion limits . here",
    "the metric could be written as @xmath74 from which we find that the time - time component of the ricci curvature tensor @xmath75 , and then the einstein equation @xmath76 gives @xmath77 where @xmath78 and @xmath79 are respectively the total energy density and pressure .",
    "the quantity @xmath80 can be expressed in terms of the comoving coordinate @xmath60 as @xmath81 where we have defined a new newtonian potential @xmath82 and used @xmath83 .",
    "thus @xmath84\\nonumber\\end{aligned}\\ ] ] where in the second step we have used eq .",
    "( [ eq : einsteineqn ] ) and the raychaudhrui equation , and an overbar means the background value of a quantity . because the energy momentum tensor for the scalar field is given by eq .",
    "( [ eq : phiemt ] ) , it is easy to show that @xmath85 $ ] and so @xmath86\\right\\}\\nonumber\\\\ & & + 4\\pi ga^{3 } \\left\\{\\bar{\\rho}_{\\mathrm{cdm}}c(\\bar{\\varphi})+ \\bar{\\rho}_{\\mathrm{b}}+ 2\\left[\\dot{\\bar{\\varphi}}^{2}-v(\\bar{\\varphi})\\right]\\right\\}.\\nonumber\\end{aligned}\\ ] ] now in this equation @xmath87 in the quasi - static limit and so could be dropped safely .",
    "so we finally have @xmath88\\nonumber\\\\ & & + 4\\pi ga^{3 } \\left[\\rho_{\\mathrm{b}}-\\bar{\\rho}_{\\mathrm{b}}\\right ] - 8\\pi ga^{3}\\left[v(\\varphi)-v(\\bar{\\varphi})\\right].\\ \\\\end{aligned}\\ ] ]    finally , for the equation of motion of the dark matter particle , consider eq .",
    "( [ eq : dm_energy_conservation ] ) . using eqs .",
    "( [ eq : dmemt_particle ] , [ eq : dmlagrangian2 ] ) , this can be reduced to @xmath89 obviously the left hand side is the conventional geodesic equation and the right hand side is the new fifth force due to the coupling to the scalar field .",
    "note that because @xmath90 is the projection tensor that projects any 4-tensor into the 3-space perpendicular to @xmath19 , so @xmath91 is the spatial derivative in the 3-space of the observer and perpendicular to @xmath92 ; consequently the fifth force @xmath93 has no component parallel to @xmath92 ( the time component ) , indicating that the energy density of cdm will be conserved and only the particle trajectories are modified , as mentioned in @xcite .",
    "remember that @xmath92 in eq .",
    "( [ eq : dmeom ] ) is the 4-velocity of individual particles , but from eq .",
    "( [ eq : wfphieom ] ) we see that @xmath94 is computed in the fundamental observer s frame ( where density perturbation is calculated ) , so if we also want to work on eq .",
    "( [ eq : dmeom ] ) in the fundamental observer s frame ( so that we can use the @xmath94 from eq .",
    "( [ eq : wfphieom ] ) directly ) , then we must rewrite eq .",
    "( [ eq : dmeom ] ) by substituting @xmath95 up to first order in perturbations , in which @xmath96 is the 4-velocity of the fundamental observer and @xmath97 is the peculiar velocity of the particle .",
    "then the first term in the above expression is the gradient of @xmath94 observed by the fundamental observer ( rather than an observer comoving with the particle ) and the second term is a velocity dependent acceleration @xcite . in @xcite",
    "it is claimed that the second term is of big importance ; in our simulations , however , this term will be neglected ( from here on ) because it depends on @xmath98 , which is very small due to the chameleon nature of the model .",
    "we have checked in a linear perturbation computation that removing this term only changes the matter power spectrum by less than 0.0001% .",
    "now in the non - relativistic limit the spatial components of eq .",
    "( [ eq : dmeom ] ) can be written as @xmath99 where @xmath100 is the physical time coordinate .",
    "if we instead use the comoving coordinate @xmath60 , then this becomes @xmath101 where we have used eq .",
    "( [ eq : newphi ] ) .",
    "the canonical momentum conjugate to @xmath60 is @xmath102 so we have now @xmath103 in which eq .",
    "( [ eq : wfdpdtcomov ] ) is for cdm particle and eq .",
    "( [ eq : wfdpdtcomovb ] ) is for baryons .",
    "note that according to eq .",
    "( [ eq : wfdpdtcomov ] ) the quantity @xmath104 $ ] acts as a new piece of potential : the potential for the fifth force .",
    "this is an important observation and we will come back to it later when we calculate the escape velocity of cdm particles within a virialized halo .",
    "( [ eq : wfphieom ] , [ eq : wfpoisson ] , [ eq : wfdxdtcomov ] , [ eq : wfdpdtcomov ] , [ eq : wfdpdtcomovb ] ) will be used in the code to evaluate the forces on the dark matter particles and evolve their positions and momenta in time .      in our numerical simulation",
    "we use a modified version of mlapm ( @xcite , see [ subsect : simu_detail ] ) , and we will have to change our above equations in accordance with the internal units used in that code . here",
    "we briefly summarize the main features .",
    "mlapm code uses the following internal units ( with subscript @xmath105 ) : @xmath106 in which @xmath107 is the present size of the simulation box and @xmath108 is the present hubble constant , and @xmath109 , with subscript , can represent the density for either cdm ( @xmath110 ) or baryons ( @xmath111 ) . using these newly - defined quantities , it is easy to check that eqs .",
    "( [ eq : wfdxdtcomov ] , [ eq : wfdpdtcomov ] , [ eq : wfpoisson ] , [ eq : wfphieom ] ) could be rewritten as @xmath112,\\\\ \\label{eq : intpoisson}\\nabla^{2}\\phi_{c } & = & \\frac{3}{2}\\omega_{\\mathrm{cdm}}\\bar{c } \\left(\\rho_{c,\\mathrm{cdm}}\\frac{c}{\\bar{c}}-1\\right)\\nonumber\\\\ & & + \\frac{3}{2}\\omega_{\\mathrm{b}}\\left(\\rho_{c,\\mathrm{b}}-1\\right ) - \\kappa\\frac{v-\\bar{v}}{h^{2}_{0}}a^{3},\\end{aligned}\\ ] ] and @xmath113 where @xmath114 is the present cdm fractional energy density , we have again restored the factor @xmath70 and again the @xmath1 is @xmath72 times the @xmath1 in the original lagrangian . note that in eq .",
    "( [ eq : intdpdtcomov ] ) the term in the bracket on the right hand side only applies to cdm but not to baryons .",
    "also note that from here on we shall use @xmath115 unless otherwise stated , for simplicity .",
    "we also define @xmath116 to be used below .",
    "making discretized version of the above equations for @xmath0-body simulations is non - trivial task .",
    "for example , the use of variable @xmath117 instead of @xmath1 ( appendix  [ appen : discret ] ) helps to prevent @xmath118 , which is unphysical , but numerically possible due to discretization .",
    "we refer the interested readers to appendix  [ appen : discret ] to the whole treatment , with which we can now proceed to do @xmath0-body runs .",
    "[ subsect : eqn_nonrel ]",
    "the full name of mlapm is multi - level adaptive particle mesh code . as the name has suggested , this code uses multilevel grids @xcite to accelerate the convergence of the ( nonlinear ) gauss - seidel relaxation method @xcite in solving boundary value partial differential equations . but more than this , the code is also adaptive , always refining the grid in regions where the mass / particle density exceeds a certain threshold .",
    "each refinement level form a finer grid which the particles will be then ( re)linked onto and where the field equations will be solved ( with a smaller time step ) .",
    "thus mlapm has two kinds of grids : the domain grid which is fixed at the beginning of a simulation , and refined grids which are generated according to the particle distribution and which are destroyed after a complete time step .",
    "one benefit of such a setup is that in low density regions where the resolution requirement is not high , less time steps are needed , while the majority of computing sources could be used in those few high density regions where high resolution is needed to ensure precision .",
    "some technical issues must be taken care of however .",
    "for example , once a refined grid is created , the particles in that region will be linked onto it and densities on it are calculated , then the coarse - grid values of the gravitational potential are interpolated to obtain the corresponding values on the finer grid . when the gauss - seidel iteration is performed on refined grids , the gravitational potential on the boundary nodes",
    "are kept constant and only those on the interior nodes are updated according to eq .",
    "( [ eq : gs ] ) : just to ensure consistency between coarse and refined grids .",
    "this point is also important in the scalar field simulation because , like the gravitational potential , the scalar field value is also evaluated on and communicated between multi - grids ( note in particular that different boundary conditions lead to different solutions to the scalar field equation of motion )",
    ".    in our simulation the domain grid ( the finest grid that is not a refined grid ) has @xmath119 nodes , and there are a ladder of coarser grids with @xmath120 , @xmath121 , @xmath122 , @xmath123 , @xmath124 nodes respectively .",
    "these grids are used for the multi - grid acceleration of convergence : for the gauss - seidel relaxation method , the convergence rate is high upon the first several iterations , but quickly becomes very slow then ; this is because the convergence is only efficient for the high frequency ( short - range ) fourier modes , while for low frequency ( long - range ) modes more iterations just do not help much .",
    "to accelerate the solution process , one then switches to the next coarser grid for which the low frequency modes of the finer grid are actually high frequency ones and thus converge fast .",
    "the mlapm solver adopts the self - adaptive scheme : if convergence is achieved on a grid , then interpolate the relevant quantities back to the finer grid ( provided that the latter is not on the refinements ) and solve the equation there again ; if convergence becomes slow on a grid , then go to the next coarser grid . this way it goes indefinitely except when converged solution on the domain grid is obtained or when one arrives at the coarsest grid ( normally with @xmath125 nodes ) on which the equations can be solved exactly using other techniques . for our scalar field model ,",
    "the equations are difficult to solve anyway , and so we truncate the coarser - grid series at the @xmath124-node one , on which we simply iterate until convergence is achieved .",
    "furthermore , we find that with the self - adaptive scheme in certain regimes the nonlinear gs solver tends to fall into oscillations between coarser and finer grids ; to avoid such situations , we then use v - cycle @xcite instead .    for the refined grids",
    "the method is different : here one just iterate eq .  ( [ eq : gs ] ) until convergence , without resorting to coarser grids for acceleration .",
    "as is normal in the gauss - seidel relaxation method , convergence is deemed to be achieved when the numerical solution @xmath126 after @xmath127 iterations on grid @xmath128 satisfies that the norm @xmath129 ( mean or maximum value on a grid ) of the residual @xmath130 is smaller than the norm of the truncation error @xmath131\\end{aligned}\\ ] ] by a certain amount , or , in the v - cycle case , the reduction of residual after a full cycle becomes smaller than a predefined threshold ( indeed the former is satisfied whenever the latter is ) .",
    "note here @xmath132 is the discretization of the differential operator eq .",
    "( [ eq : diffop ] ) on grid @xmath128 and @xmath133 a similar discretization on grid @xmath134 , @xmath135 is the source term , @xmath136 is the restriction operator to interpolate values from the grid @xmath128 to the grid @xmath134 . in the modified code",
    "we have used the full - weighting restriction for @xmath136 .",
    "correspondingly there is a prolongation operator @xmath137 to obtain values from grid @xmath134 to grid @xmath128 , and we use a bilinear interpolation for it . for more details see @xcite .",
    "mlapm calculates the gravitational forces on particles by centered difference of the potential @xmath138 and propagate the forces to locations of particles by the so - called triangular - shaped - cloud ( tsc ) scheme to ensure momentum conservation on all grids .",
    "the tsc scheme is also used in the density assignment given the particle distribution .",
    "the main modifications to the mlapm code for our model are :    1 .",
    "we have added a parallel solver for the scalar field based on eq .",
    "( [ eq : u_phi_eom ] ) .",
    "the solver uses a nonlinear gauss - seidel method and the same criterion for convergence as the ( linear ) gauss - seidel poisson solver .",
    "2 .   the solved value of @xmath117 is then used to calculate local mass density and thus the source term for the poisson equation , which is solved using fast fourier transform . 3 .",
    "the fifth force is obtained by differentiating the @xmath117 just like the calculation of gravity .",
    "4 .   the momenta and positions of particles",
    "are then updated taking in account of both gravity and the fifth force .",
    "there are a lot of additions and modifications to ensure smooth interface and the newly added data structures . for the output , as there are multilevel grids all of which host particles , the composite grid is inhomogeneous and thus we choose to output the positions , momenta of the particles , plus the gravity , fifth force and scalar field value _ at the positions _ of these particles .",
    "we can of course easily read these data into the code , calculate the corresponding quantities on each grid and output them if needed .      as mentioned above ,",
    "the most important difference of the present work from @xcite is the inclusion of baryons - the particles which do not couple to the scalar field .",
    "the baryons do not contribute to the scalar field equation of motion and are not affected by the scalar fifth force , at least directly , so that it is important to make sure that they do not mess up the physics .    in the modified code",
    "we distinguish baryons and cdm particles by tagging all of them .",
    "we consider the situation where 20% of all matter particles are baryonic and 80% are cdm . at the beginning of each simulation , we loop over all particles and for each particle we generate a random number from a uniform distribution in @xmath139 $ ] .",
    "if this random number is less than 0.2 then we tag the particle as baryon , and otherwise we tag it as cdm .",
    "once these tags have been set up they will never been changed again , and the code then determines whether the particle contributes to the scalar field evolution and feels the fifth force or not according to its tag .",
    "all the simulations are started at the redshift @xmath140 . in principle , modified initial conditions ( initial displacements and velocities of particles which is obtained given a linear matter power spectrum ) need to be generated for the coupled scalar field model , because the zeldovich approximation @xcite is also affected by the scalar field coupling @xcite . in practice , however , we have found in our linear perturbation calculation @xcite that the effect on the linear matter power spectrum is negligible ( @xmath141 ) for our choices of parameters @xmath142 .",
    "another way to see that the scalar field has really negligible effects on the matter power spectrum at early times is to look at fig .",
    "[ fig : figure2 ] below , which shows that at those times the fifth force is just much weaker than gravity and therefore its impact ignorable . considering these",
    ", we simply use the @xmath54cdm initial displacements / velocities for the particles in these simulations , which are generated using grafic2 @xcite .",
    "the physical parameters we use in the simulations are as follows : the present - day dark energy fractional energy density @xmath143 and @xmath144 , @xmath145  km / s / mpc , @xmath146 , @xmath147 . the simulation box has a size of @xmath148  mpc , where @xmath149 .",
    "we simulate 4 models , with parameters @xmath150 equal to @xmath151 , @xmath152 , @xmath153 and @xmath154 respectively ( such parameters are chosen so that the deviation from @xmath54cdm will be neither too small to be distinguishable or too large to be realistic ) . for each model",
    "we make 5 runs with exactly the same initial condition , but different seeds in generating the random number to tag baryons and cdm particles ; all the 4 models use the same 5 seeds so that results can be directly compared .",
    "we hope the average of the results from 5 runs could reduce the scatter .",
    "in all those simulations the mass resolution is @xmath155 , the particle number is @xmath156 , the domain grid is a @xmath157 cubic and the finest refined grids have 16384 cells on one side , corresponding to a force resolution of @xmath158kpc .",
    "we also make a run for the @xmath54cdm model using the same parameters ( except for @xmath159 , which are not needed now ) and initial condition .      in table",
    "[ tab : table1 ] we have listed some of the main results for the 20 runs we have made , from which we could obtain some rough idea how the motions of baryons and cdm particles differ from each other . we see that for the model @xmath160 the cdm particles could be up to @xmath161 times faster than baryons , thanks to the enhancement by the fifth force .",
    "we will come back to this point later when we argue for the necessity of a modified strategy of identifying virialized halos .    [",
    "cols=\"^,^,^,^,^\",options=\"header \" , ]                 in fig .",
    "[ fig : figure1 ] we have shown some snapshots of the distribution of baryonic and cdm particles , to give some idea about the hierachical structure formation and for comparisons with other figures below .",
    "it shows clearly how some clustering objects develop , with filaments connecting them together .",
    "the baryons roughly follow the clustering of cdm particles , but in some low density regions they become slightly separated .    to understand how the motion of the particles is altered by the coupling to the scalar field , in fig .",
    "[ fig : figure2 ] we have shown the correlation between the magnitudes of the fifth force and gravity on the cdm particles ( remember that baryons do not feel the fifth force ) . ref .",
    "@xcite has made a detailed qualitatively analysis about the general trend of this correction , and here we just give a brief description :    from eqs .",
    "( [ eq : intpoisson ] , [ eq : intphieom ] ) we could see that , _ when the scalar field potential _ , _ i.e. _ , _ the last term of eqs .",
    "( [ eq : intpoisson ] , [ eq : intphieom ] ) could be neglected _ , then the scalar field @xmath1 is simply proportional to the gravitational potential @xmath138 and as a result eq .",
    "( [ eq : intdpdtcomov ] ) tells us that the strength of the fifth force is just @xmath162 times that of gravity ; in other words , the effect of the scalar field is a rescaling of the gravitational constant by @xmath163 .",
    "this is because in this situation , the effective mass of the scalar field , which is given by @xmath164 , where @xmath165 is the effective total potential , is light and the fifth force is long - range , like gravity . for comparison , in fig .",
    "[ fig : figure2 ] we also plot this @xmath162 proportion between the two forces , as a straight line : @xmath166 , where @xmath167 denote respectively the magnitudes of the fifth force and gravity , and the factor 0.8 in front of @xmath168 comes from the fact that only 80% of the particles are cdm ( and thus contribute to the fifth force ) .",
    "this scaling relation actually sets an upper limit on how strong the fifth force could be relative to gravity , should it not be suppressed by other effects .",
    "in contrast , when the value of @xmath1 is small , the last term of eqs .",
    "( [ eq : intpoisson ] , [ eq : intphieom ] ) is not negligible and the scalar field acquires a heavy mass , making it short - ranged . as a result",
    ", a particle outside a high density region might not feel the fifth force exerted by particles in that region , even it is quite close to the region .",
    "but because it can feel gravity from that region , so the total fifth force on the particle becomes less than the @xmath162 scaling .    in general ,",
    "the value of @xmath1 is determined by @xmath169 as well as its background value @xmath55 ( which sets the boundary condition to solve the interior value ) . at early times",
    "@xmath55 is very close to 0 and @xmath73 is high everywhere , making @xmath1 small everywhere too , and suppressing the fifth force so that it is significantly below the @xmath162-scaling ( first row of fig .",
    "[ fig : figure2 ] ) . at later times",
    ", @xmath55 increases and @xmath73 decreases , weakening the above effect so that the fifth force becomes `` saturated '' ( _ i.e. _ , approaches the @xmath170 prediction ) and the points in the figure hit the straight lines ( last two rows ) . because decreasing @xmath38 and increasing @xmath45 have the same effects of making @xmath1 small , in the models with @xmath171 the fifth force saturates later than in the models with @xmath172 .",
    "in addition , because high @xmath73 tends to decrease @xmath1 and increase the scalar field mass , so in high density regions ( where gravity is stronger ) the fifth force also saturates later .",
    "the agreement between the numerical solution of the fifth force and the @xmath162-scaling relation in cases of weak - chameleon effect serves as an independent check of our numerical code .",
    "[ fig : figure3 ] plots the spatial configuration for the gravitational potential at the same position and output times as in fig .",
    "[ fig : figure1 ] .",
    "as expected , the potential is significantly deeper where there is significant clustering of matter [ cf .",
    "[ fig : figure1 ] ] .",
    "we also show in fig .",
    "[ fig : figure4 ] the spatial configuration for the scalar field @xmath1 at the same output position and times . at early times",
    "when @xmath1 is small and the scalar field mass is heavy , the fifth force is so short - ranged that @xmath1 only depends on the local density .",
    "this means that the spatial configuration of @xmath1 in this situation could well reflect the underlying dark matter distribution , a fact which could be seen clearly in the first row .",
    "as time passes by , the mass of the scalar field decreases on average and @xmath55 increases , the value of @xmath1 at one point is more and more influenced by the matter distribution in neighboring regions , and such an `` averaging '' effect weakens the contrast and makes the plots blurring ( last two rows ) .",
    "furthermore , obviously decreasing @xmath38 and increasing @xmath45 could increase the scalar field s mass , shorten the range of the fifth force , make @xmath1 less dependent on its value in neighboring regions , and thus strengthen the contrast in the figures .      to have a more quantitative description about how the matter clustering property is modified with respect to the @xmath54cdm model",
    ", we consider the matter power spectra @xmath173 in our simulation boxes .",
    "the nonlinear matter power spectrum in the present work is measured using powmes @xcite , which is a public available code based on the taylor expansion of trigonometric functions and yields fourier modes from a number of fast fourier transforms controlled by the order of the expansion .",
    "we also average the results from the 5 runs for each model and calculate the variance .            in fig .",
    "[ fig : figure5 ] shown are the fractional differences between the @xmath173 for our 4 models and for @xmath54cdm , at two different output times . at early times ( @xmath174 , upper solid curves in each panel ) , the difference is generally small , but still the 2 models with @xmath172 show up to @xmath175 deviation from @xmath54cdm prediction .",
    "this is because for larger @xmath38 the scalar field is lighter and the fifth force less suppressed , its influence in the structure formation therefore enhanced .",
    "notice that on small scales the deviation from @xmath54cdm decreases , which is a desirable property of chameleon models which are designed to suppress the fifth force on small scale high density regions .    the lower solid curves in each panel of fig .  [ fig : figure5 ] display the same quantities at @xmath176 ( late times ) .",
    "we can see the trend of increasing deviation from @xmath54cdm for all 4 models , because fifth force is essentially unsuppressed at the late epoch [ cf .",
    "[ fig : figure2 ] ] .",
    "for example , the deviation of the model @xmath177 is significantly larger than that of the model @xmath178 as navely expected , thanks to the lack of suppression of fifth force in both models ( the @xmath179 model obviously has a smaller saturated fifth force ) .    for comparison",
    "we also plot the @xmath180 that is predicted by the linear perturbation theory for the 4 models under consideration ( the dashed curves ) . as can be seen there , at large scales ( small @xmath128 ) where linear perturbation is considered as a good approximation , the linear and nonlinear results agree pretty well ( especially for the @xmath174 case ) .",
    "the largest scale we can probe is limited by the size of our simulation boxes ( @xmath181 ) and as a result we can not make plot beyond the point @xmath182 , where nonlinearity is expected to first become significant .",
    "however , in the case of @xmath176 , we can see the clear trend of the linear and nonlinear results merging towards @xmath183 at vanishing @xmath180 .",
    "similar results can be found in fig .  2 of @xcite for f(r ) gravity .",
    "because we have two species of matter particles , one uncoupled to the scalar field , we are also interested in their respect power spectrum and the bias between them .",
    "these are displayed in fig .",
    "[ fig : figure6 ] . the results could be understood easily : because a cdm particle always feel stronger total force than a baryon at the same position , so the clustering of the former is identically stronger than the latter as well .",
    "this could result in a significant bias between these two species at the present time , especially for the models with @xmath172 , where the fifth force is less suppressed .",
    "we identify halos in our @xmath0-body simulations using mhf ( mlapm halo finder ) @xcite , which is the default halo finder for mlapm .",
    "mhf optimally utilizes the refinement structure of the simulation grids to pin down the regions where potential halos reside and organize the refinement hierarchy into a tree structure . because mlapm refines grids according to the particle density on them , so the boundaries of the refinements are simply isodensity contours .",
    "mhf collect the particles within these isodensity contours ( as well as some particles outside ) .",
    "it then performs the following operations : ( i ) assuming spherical symmetry of the halo , calculate the escape velocity @xmath184 at the position of each particle , ( ii ) if the velocity of the particle exceeds @xmath184 then it does not belong to the virialized halo and is removed .",
    "( i ) and ( ii ) are then iterated until all unbound particles are removed from the halo or the number of particles in the halo falls below a pre - defined threshold , which is 20 in our simulations .",
    "note that the removal of unbound particles is not used in some halo finders using the spherical overdensity ( so ) algorithm , which includes the particles in the halo as long as they are within the radius of a virial density contrast .",
    "another advantage of mhf is that it does not require a pre - defined linking length in finding halos , such as the friend - of - friend procedure .",
    "when it comes to our coupled scalar field model , the mhf algorithm also needs to be modified .",
    "the reason is that , as we mentioned above , the scalar field @xmath1 behaves as an extra `` potential '' ( which produces the fifth force ) and so the cdm particles experience a deeper total `` gravitational '' potential than what they do in the @xmath54cdm model .",
    "consequently , the escape velocity for cdm particles increases compared with the newtonian prediction .",
    "this is indeed important to bear in mind because , as we have seen in table  [ tab : table1 ] , the cdm particles are typically much faster than what they are in the @xmath54cdm simulation , and so if we underestimate @xmath184 then some particles which should have remained in the halo would be incorrectly removed by mhf . in general , similar things should be taken care of in other theories involving modifications to gravity in the non - relativistic limit , such as mond and @xmath2 gravity .",
    "an exact calculation of the escape velocity in the coupled scalar field model is obviously difficult due to the complicated behaviour of the scalar field , and thus here we introduce an approximated algorithm , which is based on the mhf default method @xcite , to estimate it .",
    "mhf works out @xmath184 using the newtonian result @xmath185 in which @xmath138 is the gravitational potential . under the assumption of spherical symmetry",
    ", the poisson equation @xmath186 could be integrated once to give @xmath187 which is just the newtonian force law .",
    "this equation can be integrated once again to obtain @xmath188 where @xmath189 is an integration constant and can be fixed @xcite by requiring that @xmath190 as @xmath191 in which @xmath192 is the virial radius of the halo and @xmath193 is the mass enclosed in @xmath192 .    when the fifth force acts on cdm particles , the force law eq .",
    "( [ eq : ahf_newton_law ] ) is modified and these particles feel a larger total `` gravitational '' potential . to take this into account , we need to have the knowledge about how the force law is modified and a simple rescaling of gravitational constant @xmath7 has been shown to be not physical in certain regimes .",
    "to solve the problem , we notice that in the mhf code eq .",
    "( [ eq : ahf_newton_law ] ) is used in the numerical integrations to obtain both @xmath194 and @xmath189 [ cf .",
    "eqs.([eq : ahf_phi ] , [ eq : ahf_phi0 ] ) ] .",
    "more explicitly , the code loops over all particles in the halo in ascending order of the distance from the halo centre , and when a particle is encountered its mass is uniformly distributed into the spherical shell between the particle and its previous particle ( the thickness of the shell is then the @xmath195 of the integration ) . obviously when the fifth force is added into eq .",
    "( [ eq : ahf_newton_law ] ) we could use the same method to compute the total `` gravitational '' potential which includes the contribution from @xmath1 ( call this contribution @xmath196 ; because @xmath197 , so from eq .",
    "( [ eq : wfdpdtcomov ] ) we can easily see @xmath198 ) .",
    "but now there is a subtlety here : not all particles are cdm while only cdm particles contribute to @xmath196 .",
    "so in the modified mhf code we calculate @xmath199 and @xmath200 separately , using all particles for the former and only cdm for the latter .",
    "finally @xmath201 is our estimate of the escape velocity . because we have recorded the components of gravity and the fifth force for each particle in the simulation , so the fifth - force - to - gravity ratio can be computed at the position of each particle , which is approximated to be @xmath202 at that position . in this way we have ,",
    "at least approximately , taken into account the environment dependence of the fifth force and thus of @xmath196 .    to see how our modification of the mhf code affects the final result on the mass function , in fig .",
    "[ fig : figure7 ] we compare the mass functions for the model @xmath177 calculated using three methods : the modified mhf , the original mhf ( by default for @xmath54cdm simulations ) and another modified mhf in which we set @xmath184 to be very large so that no particles will ever escape from any halo ( this is similar to the spherical overdensity algorithm mentioned above ) .",
    "it could be seen that the difference between these methods can be up to a few percent for small halos where the potential is shallow , particle number is small and the result is sensitive to whether more particles are removed . as expected , the second method gives least halos because there @xmath184 is smallest and many particles are removed , while the third method gives most halos because no particles are removed at all .",
    "[ fig : figure8 ] displays the mass functions for the 4 models as compared to the @xmath54cdm result .",
    "as expected , the fifth force enhances the structure formation and thus produces more halos in the simulation box .",
    "as our simulations have reached a force resolution of @xmath203  kpc , while the typical size of the large halos in the simulations is of order mpc , we could ask what the internal profiles of the halos look like and how they have been modified by the coupling between cdm particles and the scalar field .",
    "we have selected 2 typical halos from each simulation .",
    "halo i is centred on @xmath204  mpc , which is slightly different for different simulations , and has a virial mass @xmath205 ; halo ii is centred on @xmath206  mpc , which is also slightly different for different simulations , and has a virial mass @xmath207 ( note here that the virial masses are for the _ @xmath54cdm simulations _ , and for scalar field simulations they can be , and generally are , slightly different ) .    the largest halos , such as halo i , generally reside in the higher density regions where the scalar field has a heavier mass and shows stronger chameleon effect .",
    "consequently the fifth force inside them is severely suppressed so that we can expect small deviation from the @xmath54cdm halo profile . on the other hand ,",
    "the intermediate and small halos ( such as halo ii ) are mostly in relatively low density regions in which scalar field has a light mass and the fifth force tends to saturate ; this means that they should generally have a higher internal density than the same halos in the @xmath54cdm simulation due to the enhanced growth by the fifth force .",
    "this above analysis is qualitatively confirmed by fig .",
    "[ fig : figure9 ] , where we can see that for the cases of @xmath171 ( stronger chameleon ) the difference between the predictions of the coupled scalar field models and the @xmath54cdm paradigm is really small for halo i. furthermore , this figure also shows some new and more interesting features for the cases of @xmath172 .",
    "considering halo i in the models @xmath178 and @xmath177 for example : in the former case , the coupled scalar field model produces an obviously consistent higher internal density profile than @xmath54cdm , from the inner to the outer regions of the halo ; while for the latter case , the density profile of the coupled scalar field model is lower in the inner region but higher in the outer region !",
    "we plan to make a detailed analysis of the complexities arising here regarding the effects of a coupled scalar field on the internal density profiles for halos in a future work , and in this work we will only give a brief explanation for the new feature observed above : fig .",
    "[ fig : figure11 ] shows the distributions of particle velocities and fifth - force - to - gravity ratio at the positions of the particles in halo i for the two models @xmath178 and @xmath177 .",
    "as we can see there , for the model @xmath177 the large value of @xmath45 makes the chameleon effect strong so that the fifth force is generally much smaller than gravity in magnitude , while at the same time the velocities of particles are more concentrated towards the high end , implying a significantly higher mean speed than @xmath54cdm ( as we have checked numerically ) ; as a result in the central region of the halo the particles have higher kinetic energy than in @xmath54cdm but the potential is not significantly deeper , so that particles tend to get far away from the centre of the halo , producing a lower inner density profile . as for the model with @xmath178 ,",
    "the situation is just the opposite : the fifth force is saturated and of the same order as gravity due to the weak chameleon effect , so that the total potential is greatly deeper than its @xmath54cdm counterpart , while at the same time the particles are not as fast as those in @xmath177 : the consequence is that the halo accretes more particles towards its centre .",
    "one might also have interests in how the cdm part and the baryonic part of the halo profile differ from each other , and this is given in fig .",
    "[ fig : figure10 ] , in which we compare the cdm and baryon density profiles of halos i and ii . obviously the cdm density is higher than baryons everywhere , again thanks to the boost from the fifth force . for smaller @xmath38 and larger @xmath45 ( which help strengthen the chameleon effect and suppress the fifth force ) ,",
    "the difference between the two is smaller ( compare the halo i in the models @xmath178 and @xmath208 ) .",
    "however , in the situations where the fifth force is already saturated or unsuppressed ( such as in halo ii ) , increasing @xmath45 increases the saturated value of the fifth force , and thus can instead magnify the difference ( compare the halo ii in the models @xmath178 and @xmath208 ) .",
    "the above results again show the complexity of the chameleon scalar field model as compared to other coupled scalar field models .",
    "we will study the environment and epoch dependence of the halo density profiles in a upcoming work .",
    "to summarize , in this paper we have investigated into a model where cdm and baryons couple differently to a chameleon - like scalar field , and performed full @xmath0-body simulations , by directly solving the spatial distribution of the scalar field , to study the nonlinear structure formation under this setup .",
    "the new complexity introduced here compared to @xcite is that we must distinguish between baryons and cdm so that we know how to calculate the force upon each particle .",
    "we do this by tagging the initial almost homogeneously distributed particle randomly so that 80% of all particles are tagged as cdm .",
    "we then only use cdm particles to calculate the scalar field and only applies the fifth scalar force on cdm particles .",
    "the coupling function ( characterized by the coupling strength @xmath45 ) and bare potential ( characterized by the parameter @xmath38 which controls its steepness ) of the scalar field are chosen to be the same as in @xcite . as discussed there , the coupling of the scalar field to cdm particles acts on the latter a fifth force .",
    "when @xmath38 is small and @xmath45 is large , the chameleon effect becomes stronger , which gives the scalar field a heavy mass , making the fifth force short - ranged and the scalar field dependent only on the local matter density .",
    "other ways to strengthen the chameleon effect includes increasing the density and decreasing the background value of the scalar field , which itself is equivalent to increasing the background cdm energy density .",
    "we have displayed in figs .",
    "[ fig : figure2 ] , [ fig : figure4 ] how changing the determining factors change the scalar field configuration and the strength of the fifth force .",
    "we have also measured the nonlinear matter power spectrum from the simulation results and compared them with the @xmath54cdm prediction .",
    "depending on the values of @xmath142 as well as the background cdm density , the former can be up to @xmath209 larger than the latter . nonetheless , when the chameleon effect is set to be strong , the deviation gets suppressed and in particular decreases towards small scales , showing the desirable property of chameleon models that they evade constraints on small scales .",
    "the bias between cdm and baryons power spectra follows the same trend .    to identify virialized halos from the simulations , we have modified mhf , mlapm s default halo finder , so that the calculation of the escape velocity includes the effect of the scalar field .",
    "we find that such a modification leads to up to a - few - percent enhancement on the mass function compared with what is obtained using the default mhf code , because in the latter case the escape velocity is underestimated and some particles are incorrectly removed from the virialized halos .",
    "we find that the mass function in the coupled scalar field models is significantly larger than the @xmath54cdm result , because of the enhanced structure growth induced by the fifth force .",
    "finally , we have analyzed the internal profiles of ( the same ) two halos selected from each simulation .",
    "we find that when chameleon effect is strong and fifth force is suppressed , our result is very close to the @xmath54cdm prediction ; this is the case for very large halos ( which generally reside in higher density regions ) and @xmath171 . for large halos and @xmath172 ,",
    "the situation is more complicated because the competition between two effects of the coupled scalar field , namely the speedup of the particles and the deepening of the total attractive potential , has arrived a critical point : if the former wins , such as in the model @xmath177 , then the inner density profile can be lower than that in @xmath54cdm ; if the latter wins , such as in the model @xmath177 , then we expect the opposite . for smaller halos which locate in lower density regions ,",
    "the fifth force is not suppressed that much and causes faster growth of the structure , so the halo is more concentrated and has a higher internal density .",
    "meanwhile , the bias between baryons and cdm density profiles also increase as the fifth force becomes less suppressed , which is as expected .",
    "our results already show that new features can be quantitatively studied with the @xmath0-body method and the improving supercomputing techniques , and that the chameleon model has rather different consequences from other coupled scalar field models .",
    "the enhancement in the structure formation due to the fifth force is significant for some of our parameter space , which means other observables , such as weak lensing , could place new constraints on the model .",
    "also one might be interested in how the halo profiles would be like at different epoch of the cosmological evolution and in different environments .",
    "these will be left as future work .",
    "the work described here has been performed under the hpc - europa project , with the support of the european community research infrastructure action under the fp8 `` structuring the european research area '' programme .",
    "the @xmath0-body simulations are performed on the huygens supercomputer in the netherlands , and the post - precessing of data is performed on cosmos , the uk national cosmology supercomputer .",
    "we thank john barrow , kazuya koyama , andrea maccio and gong - bo zhao for helpful discussions relevant to this work , and lin jia for assistance in plotting the figures .",
    "b.  li is supported by a research fellowship in applied mathematics at queens college , university of cambridge and the stfc rolling grant in damtp .",
    "natexlab    bibnamefont    bibfnamefont    citenamefont    url    urlprefix    [ 2]#2 [ 2][]#2    , and , * * , ( ) .    , * * , ( ) .    and ,",
    "* * , ( ) .    and , * * , ( ) .    and , * * , ( ) .    and , * * , ( ) .    , , , and , * * , ( )",
    ", , and , * * , ( ) .    and , * * , ( ) .    and , * * , ( ) .    and , * * , ( ) .    and , * * , ( ) .    , , and , * * , ( ) .    ,",
    "* * , ( ) .    and , * * , ( ) .    , , and , * * , ( ) .    and , * * , ( ) .    and , * * , ( ) ;",
    "* * , ( )    and , * * , ( ) .    , and ( ) , arxiv:0902.3452 [ astro - ph ] .",
    ", , , and , * * , ( ) .    , , and ( ) , arxiv:0812.3901 [ astro - ph ] .    and , * * , ( ) .",
    ", , , and , submitted ; arxiv:0910.3207 [ astro-ph.co ] .    , * * , ( ) .    , and , * * , ( ) .    , and , * * , ( ) .    and , * * , ( ) .    and , * * , ( ) .    , and , * * , ( ) .    , * * , ( ) .    , and , * * , ( ) .    , * * , ( ) .    , , and , _ numerical recipes in c. the art of scientific computing _ ( cambridge university press , cambridge 1992 ) , second ed .    , and , _ a multigrid tutorial _",
    "( society for industrial and applied mathematics , philadelphia 2000 ) , second ed .    , * * , ( ) .    , , and , * * , ( ) .    ) , arxiv : astro - ph/9506070 .    , and , * * , ( ) .    , , and , * * , ( ) .    , and , * * , ( ) .    and , * * , ( ) .",
    "in the mlapm code the partial differential equation eq .",
    "( [ eq : intpoisson ] ) is ( and in our modified code eq .",
    "( [ eq : intphieom ] ) will also be ) solved on discretized grid points , and as such we must develop the discretized versions of eqs .",
    "( [ eq : intdxdtcomov ] - [ eq : intphieom ] ) to be implemented into the code .    but before going on to the discretization , we need to address a technical issue .",
    "as the potential is highly nonlinear , in the high density regime the value of the scalar field @xmath210 will be very close to 0 , and this is potentially a disaster as during the numerical solution process the value of @xmath210 might easily go into the forbidden region @xmath118 @xcite .",
    "one way of solving this problem is to define @xmath211 in which @xmath212 is the background value of @xmath213 , as in @xcite .",
    "then the new variable @xmath117 takes value in @xmath214 so that @xmath215 is positive definite which ensures that @xmath216 .",
    "however , since there are already exponentials of @xmath213 in the potential , this substitution will result terms involving @xmath217 $ ] , which could potentially magnify any numerical error in @xmath117 .    instead",
    ", we can define a new variable @xmath117 according to @xmath218 by this , @xmath117 still takes value in @xmath214 , @xmath219 and thus @xmath220 which ensures that @xmath213 is positive definite in numerical solutions .",
    "besides , @xmath221^{\\beta}$ ] so that there will be no exponential - of - exponential terms , and the only exponential is what we have for the potential itself .",
    "@xmath222 above .",
    "then the poisson equation becomes @xmath223\\nonumber\\\\ & & + \\frac{3}{2}\\omega_{\\mathrm{b}}\\left(\\rho_{c,\\mathrm{b}}-1\\right ) - \\frac{3\\omega_{v_{0}}a^{3}}{\\left[1-\\left(1+e^{u}\\right)^{\\beta}\\right]^{\\mu } } + 3\\bar{\\omega}_{v}a^{3},\\ \\ \\ \\ \\\\end{aligned}\\ ] ] where we have defined @xmath224 which is determined by background cosmology , the quantity @xmath225 is also determined solely by background cosmology .",
    "these background quantities should not bother us here .",
    "the scalar field eom becomes @xmath226^{\\mu+1}}\\nonumber\\\\ & & - 3\\gamma\\omega_{\\mathrm{cdm}}e^{\\gamma\\sqrt{\\kappa}\\bar{\\varphi } } - \\frac{3\\mu\\beta\\omega_{v_{0}}a^{3}e^{\\beta\\sqrt{\\kappa}\\bar{\\varphi } } } { \\left[1-e^{\\beta\\sqrt{\\kappa}\\bar{\\varphi}}\\right]^{m+1}}\\end{aligned}\\ ] ] in which we have used the fact that @xmath227 , and moved all terms depending only on background cosmology ( the source terms ) to the right hand side .",
    "so , in terms of the new variable @xmath117 , the set of equations used in the @xmath0-body code should be @xmath228\\end{aligned}\\ ] ] plus eqs .",
    "( [ eq : u_poisson ] , [ eq : u_phi_eom ] ) .",
    "these equations will ultimately be used in the code . among them , eqs .",
    "( [ eq : u_poisson ] , [ eq : u_dpdt ] ) will use the value of @xmath117 while eq .",
    "( [ eq : u_phi_eom ] ) solves for @xmath117 . in order that these equations can be integrated into mlapm",
    ", we need to discretize eq .",
    "( [ eq : u_phi_eom ] ) for the application of newton - gauss - seidel iterations .    to discretize eq .",
    "( [ eq : u_phi_eom ] ) , let us define @xmath229 .",
    "the discretization involves writing down a discretion version of this equation on a uniform grid with grid spacing @xmath230 .",
    "suppose we require second order precision as is in the standard poisson solver of mlapm , then @xmath231 in one dimension can be written as @xmath232 where a subscript @xmath233 means that the quantity is evaluated on the @xmath234-th point .",
    "of course the generalization to three dimensions is straightforward .",
    "@xmath240\\nonumber\\\\ & & + \\frac{1}{h^{2}}\\left[b_{i , j+\\frac{1}{2},k}u_{i , j+1,k } - u_{i , j , k}\\left(b_{i , j+\\frac{1}{2},k}+b_{i , j-\\frac{1}{2},k}\\right ) + b_{i , j-\\frac{1}{2},k}u_{i , j-1,k}\\right]\\nonumber\\\\ & & + \\frac{1}{h^{2}}\\left[b_{i , j , k+\\frac{1}{2}}u_{i , j , k+1 } - u_{i , j , k}\\left(b_{i , j , k+\\frac{1}{2}}+b_{i , j , k-\\frac{1}{2}}\\right ) + b_{i , j , k-\\frac{1}{2}}u_{i , j , k-1}\\right].\\end{aligned}\\ ] ]      @xmath242\\nonumber\\\\ & & + \\frac{1}{h^{2}}\\left[b_{i , j+\\frac{1}{2},k}u_{i , j+1,k } - u_{i , j , k}\\left(b_{i , j+\\frac{1}{2},k}+b_{i , j-\\frac{1}{2},k}\\right ) + b_{i , j-\\frac{1}{2},k}u_{i , j-1,k}\\right]\\nonumber\\\\ & & + \\frac{1}{h^{2}}\\left[b_{i , j , k+\\frac{1}{2}}u_{i , j , k+1 } - u_{i , j , k}\\left(b_{i , j , k+\\frac{1}{2}}+b_{i , j , k-\\frac{1}{2}}\\right ) + b_{i , j , k-\\frac{1}{2}}u_{i , j , k-1}\\right]\\nonumber\\\\ & & -\\frac{\\left(h_{0}b\\right)^{2}}{ac^{2}}\\left[3\\gamma\\omega_{\\mathrm{cdm}}\\rho^{\\mathrm{cdm}}_{c , i , j , k } \\left(1+e^{u_{i , j , k}}\\right)^{\\gamma } + \\frac{3\\mu\\beta\\omega_{v_{0}}a^{3}\\left(1+e^{u_{i , j , k}}\\right)^{\\beta } } { \\left[1-\\left(1+e^{u_{i , j , k}}\\right)^{\\beta}\\right]^{\\mu+1}}\\right]\\nonumber\\\\ & & + \\frac{\\left(h_{0}b\\right)^{2}}{ac^{2}}\\left [ 3\\gamma\\omega_{\\mathrm{cdm}}e^{\\gamma\\sqrt{\\kappa}\\bar{\\varphi } } + \\frac{3\\mu\\beta\\omega_{v_{0}}a^{3}e^{\\beta\\sqrt{\\kappa}\\bar{\\varphi } } } { \\left[1-e^{\\beta\\sqrt{\\kappa}\\bar{\\varphi}}\\right]^{\\mu+1}}\\right].\\end{aligned}\\ ] ]    then the newton - gauss - seidel iteration says that we can obtain a new ( and often more accurate ) solution of @xmath117 , @xmath243 , using our knowledge about the old ( and less accurate ) solution @xmath244 as @xmath245 the old solution will be replaced by the new solution to @xmath246 once the new solution is ready , using the red - black gauss - seidel sweeping scheme .",
    "note that    @xmath247\\nonumber\\\\ & & -\\frac{1}{2h^{2}}\\left[b_{i+1,j , k}+b_{i-1,j , k}+b_{i , j+1,k } + b_{i , j-1,k}+b_{i , j , k+1}+b_{i , j , k-1}+6b_{i , j , k}\\right]\\nonumber\\\\ & & -\\frac{\\left(h_{0}b\\right)^{2}}{ac^{2}}3\\gamma^{2}\\omega_{\\mathrm{cdm}}\\rho^{\\mathrm{cdm}}_{c , i , j , k } \\left(1+e^{u_{i , j , k}}\\right)^{\\gamma}b_{i , j , k}\\nonumber\\\\ & & -\\frac{\\left(h_{0}b\\right)^{2}}{ac^{2 } } \\frac{3\\mu\\beta^{2}\\omega_{v_{0}}a^{3}\\left(1+e^{u_{i , j , k}}\\right)^{\\beta } } { \\left[1-\\left(1+e^{u_{i , j , k}}\\right)^{\\beta}\\right]^{\\mu+1}}b_{i , j , k } \\left[1+(\\mu+1)\\frac{\\left(1+e^{u_{i , j , k}}\\right)^{\\beta}}{1-\\left(1+e^{u_{i , j , k}}\\right)^{\\beta}}\\right].\\end{aligned}\\ ] ]    in principle , if we start from a high redshift , then the initial guess of @xmath246 could be such that the initial value of @xmath213 in all the space is equal to the background value @xmath212 , because anyway at this time we expect this to be approximately true . for subsequent time steps we could use the solution for @xmath246 at the previous time step as our initial guess ; if the time step is small enough then we do not expect @xmath117 to change significantly between consecutive times so that such a guess will be good enough for the iteration to converge fast ."
  ],
  "abstract_text": [
    "<S> in this paper we present the results of @xmath0-body simulations with a scalar field coupled differently to cold dark matter ( cdm ) and baryons . </S>",
    "<S> the scalar field potential and coupling function are chosen such that the scalar field acquires a heavy mass in regions with high cdm density and thus behaves like a chameleon . </S>",
    "<S> we focus on how the existence of the scalar field affects the formation of nonlinear large - scale structure , and how the different couplings of the scalar field to baryons and cdm particles lead to different distributions and evolutions for these two matter species , both on large scales and inside virialized halos . </S>",
    "<S> as expected , the baryon - cdm segregation increases in regions where the fifth force is strong , and little segregation in dense regions . </S>",
    "<S> we also introduce an approximation method to identify the virialized halos in coupled scalar field models which takes into account the scalar field coupling and which is easy to implement numerically . </S>",
    "<S> it is find that the chameleon nature of the scalar field makes the internal density profiles of halos dependent on the environment in a very nontrivial way . </S>"
  ]
}