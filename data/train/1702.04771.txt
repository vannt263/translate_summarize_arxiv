{
  "article_text": [
    "since its introduction in @xcite , the worm algorithm and its generalizations have played an increasing role for monte carlo simulation of systems with constraints . an interesting class of systems where worm algorithms have been applied are lattice field theories ( see @xcite @xcite for examples related to the systems studied here ) .",
    "part of that interest comes from the fact that the complex action problem , caused by a non - vanishing chemical potential @xmath3 , can in some cases be solved by exactly rewriting the system in terms of new , so - called dual variables .",
    "the complex action problem is the fact that in the conventional representation in terms of field variables the action @xmath4 of many field theories becomes complex at finite @xmath3 and the boltzmann factor @xmath5 can not be used as a probability in a monte carlo simulation .",
    "if a suitable dual representation can be found , the new form of the partition sum has only real and positive contributions , such that a simulation directly in terms of the dual variables solves the complex action problem .",
    "the dual variables for matter fields are closed loops of conserved flux , often referred to as worldlines , while gauge fields are represented as 2-dimensional world sheets ( not considered here ) .",
    "the fact that the dual variables for matter fields are loops of conserved flux makes the worm algorithm the perfect tool for updating these worldlines .",
    "however , the structure of the dual representation of lattice field theories is often more complicated than the one encountered for spin systems used for the original formulation of the worm algorithm @xcite : often new weight factors appear that live on the sites @xmath1 of the lattice ( not only on the links as in the case of most spin systems ) .",
    "furthermore , these additional weight factors depend on all the flux variables connected with @xmath1 , and the construction of a suitable worm algorithm has to include these weight factors correctly in the probabilities for the metropolis acceptance steps defining the worm .",
    "although worm - type algorithms have been used for updating such more general systems @xcite @xcite , surprisingly little theoretical background , such as proofs of the detailed balance condition ( or any other condition ensuring the correct distribution of the configurations ) can be found in the literature .",
    "the goal of this paper is to address this issue for a certain general class of systems and to put the use of worm algorithms on a more sound theoretical basis for these models .",
    "a simple example for the type of systems we consider is given by the worldline representation of the relativistic bose gas ( rbg ) .",
    "in the conventional form the rbg on the lattice is described by the action @xmath6",
    "\\right ) \\ ; , \\label{action}\\ ] ] where the first sum runs over the sites @xmath1 of a 4-dimensional lattice , the second sum is over the four euclidean directions @xmath7 , and @xmath8 denotes the unit vector in @xmath9-direction . in the conventional representation",
    "the degrees of freedom are the complex valued field variables @xmath10 at the sites @xmath1 of the lattice .",
    "@xmath11 denotes the combination @xmath12 , where @xmath13 is the bare mass parameter .",
    "the coupling of the quartic self - interaction is denoted by @xmath14 and the chemical potential by @xmath3 .",
    "the partition sum @xmath15 is obtained by integrating the boltzmann factor @xmath16 over all field configurations , i.e. , @xmath17 \\ ,",
    "e^{-s_{rbg}}$ ] , with the product measure @xmath18 = \\prod_x \\int_\\mathds{c } d \\phi_x / 2\\pi$ ] .",
    "it is obvious that for @xmath19 the action ( [ action ] ) has a non - zero imaginary part and the rbg thus has a complex action problem in the conventional representation .",
    "the rbg is an important model system which has been studied not only with dual techniques , but also with other numerical approaches to the complex action problem ( see , e.g. , @xcite @xcite ) .",
    "the rbg has a dual representation in terms of worldlines which completely solves the complex action problem ( for the derivation of the dual form used here see @xcite ) . in the dual representation",
    "the partition sum is given by @xmath20 \\ !",
    "\\right ) \\right ] \\ ; \\times \\label{bosedual } \\\\ \\hspace*{-7 mm }   & & \\left [ \\ , \\prod_{x,\\nu}\\ ! \\frac{e^{\\,\\mu \\ , \\delta_{\\nu,4 } \\ , k_{x,4 } } } { ( |k_{x,\\nu}| + l_{x,\\nu } ) ! \\ , l_{x,\\nu } ! } \\right ] \\!\\ !",
    "\\left [   \\prod_x    f\\!\\left ( \\ , \\sum_{\\sigma=1}^d \\big [ |k_{x,\\sigma}| +   |k_{x-\\widehat{\\sigma},\\sigma}| +   2 ( l_{x,\\sigma } + l_{x-\\widehat{\\sigma},\\sigma } ) \\big ]   \\right ) \\right]\\ ! .",
    "\\nonumber\\end{aligned}\\ ] ] here the dynamical degrees of freedom are represented by two sets of variables living on the links of the lattice : the flux variables @xmath21 and the auxiliary variables @xmath22 .",
    "the partition sum is a sum over all configurations of both variables .",
    "while the @xmath23 are unconstrained , the flux @xmath24 is conserved , i.e. , it obeys the discretized version of the vanishing divergence condition , @xmath25 which is implemented by the product of kronecker deltas in the first line of ( [ bosedual ] ) ( we use the notation @xmath26 ) .",
    "the flux conservation implies that the admissible configurations of @xmath24 are closed worldlines .",
    "the partition sum has two types of weight factors , both displayed between square brackets in the second line of ( [ bosedual ] ) : the first one lives on the links @xmath27 and depends only on the dual variables on that link .",
    "the second type of weight factors lives on the sites @xmath1 of the lattice and depends on all dual variables that live on links that are attached to @xmath1 .",
    "the function @xmath28 is given by the integral @xmath29 .",
    "obviously all weight factors in ( [ bosedual ] ) are real and positive also for @xmath19 and the dual formulation in terms of worldlines of flux solves the complex action problem .",
    "while the unconstrained variables @xmath23 can easily be updated with standard monte carlo techniques , for the flux variables @xmath24 the constraints ( [ fluxconservation ] ) have to be taken into account , and the strategy of the worm algorithm is the method of choice in such a situation .",
    "however , as already outlined in the initial paragraphs of this introduction , the challenge here is that in addition to the weight factors living on the links ( which are the only ones appearing in the original formulation of the worm algorithm @xcite ) , in a model such as ( [ bosedual ] ) we also have weights that live on the sites @xmath1 and depend on all flux variables connected with @xmath1 .",
    "in such a case there are many possible ways to include these additional weight factors in the metropolis acceptance probability for a new step of the worm . compared to the standard worm applications with weights only on the links , in the general case considered here , it is a non - trivial challenge to construct a correct metropolis step for the worm and to prove detailed balance .    in this paper",
    "we study a worldline model which generalizes the dual representation ( [ bosedual ] ) of the rbg .",
    "that model has local link weights , as well as local site weights , and is a prototype for a large class of worldline models that can be updated with a worm algorithm .",
    "we give an explicit construction of a worm algorithm and provide a detailed analysis , and in particular prove that the algorithm obeys the detailed balance condition .",
    "this proof closes a gap in the understanding of worm algorithms for more general applications and puts worldline simulations of such systems on a sound theoretical basis .",
    "furthermore we show that a free parameter that can be introduced in our algorithm which allows one to influence properties of the worms . using a numerical study of the relativistic bose gas ,",
    "we demonstrate that this parameter changes the probability for starting and terminating the worm and thus can be used to optimize the length and the numbers of fluxes that are changed per worm .",
    "the model we consider has a single integer valued conserved flux @xmath21 living on the links of the @xmath0-dimensional lattice @xmath30 , which we assume to have periodic boundary conditions in all directions @xmath31 . the links of the lattice are denoted as @xmath27 with @xmath32 and @xmath33 , i.e. , they are the oriented connection between the lattice sites @xmath1 and @xmath34 . for later use",
    "we introduce also the alternative labeling of links with negative direction indices @xmath9 and the corresponding notation for the flux variables , @xmath35 the flux @xmath24 is conserved , i.e. , it obeys the discretized version of the vanishing divergence condition ( [ fluxconservation ] ) .",
    "the partition function of the model we consider is given by @xmath36    \\left [ \\ , \\prod_{x,\\nu } l_{x,\\nu } ( k_{x,\\nu } ) \\right ]   \\left [ \\prod_x s_x ( \\{k_{x,\\bullet } \\ } ) \\right ]   \\ ; .",
    "\\label{zflux}\\ ] ] the partition function is a sum @xmath37 over all configurations of the flux variables @xmath38 .",
    "as in the dual rbg partition sum ( [ bosedual ] ) , the flux conservation condition ( [ fluxconservation ] ) is implemented by the product over the corresponding kronecker deltas , i.e. , the first term in the sum ( [ zflux ] ) , and the admissible configurations of @xmath39 thus are closed worldlines of flux .",
    "the other two factors under the sum ( [ zflux ] ) are two types of weight factors for the configurations : the first type of weight factors is located on the links @xmath27 of the lattice and is formulated as a product over the real and positive link weight factors @xmath40 .",
    "the link weight factors @xmath41 depend only on the flux variable @xmath24 sitting on the link @xmath27 .",
    "furthermore they can be different for different links , i.e. , they can have an explicit dependence on @xmath27 , which can , e.g. , be used to take into account a second dual variable , such as the auxiliary variable @xmath23 of the rbg ( [ bosedual ] ) .",
    "also a chemical potential which gives a different weight to fluxes in positive and negative time direction can be implemented via the explicit dependence of the link weight factors @xmath41 on @xmath27 .",
    "the other type of weight factors is located on the sites @xmath1 of the lattice and is formulated as a product over the real and positive site weight factors @xmath42 .",
    "these depend on all flux variables that live on links attached to the site @xmath1 , i.e. , on the set of links @xmath43 . also here",
    "we allow for a local dependence on the site @xmath1 , which can , e.g. , again be used to take into account the second dual variable @xmath23 of the rbg ( [ bosedual ] ) .",
    "for illustration we note that for representing the flux representation of the rbg for a fixed background configuration of the @xmath23 variables one chooses the link and site weight factors @xmath44   \\ !",
    "\\right )   \\ ; . \\nonumber\\end{aligned}\\ ] ] the dual partition function ( [ bosedual ] ) of the rbg is then obtained as @xmath45 with @xmath15 given by ( [ zflux ] ) , using the weights ( [ lands ] ) . as already mentioned , the update of the unconstrained variables @xmath46 of the rbg can be trivially implemented with standard methods and is not considered here .",
    "we conclude the discussion of the generalized model described by ( [ zflux ] ) with a few comments about observables . in a dual representation",
    "also the observables need to be represented in terms of the flux variables . for bulk observables , which are obtained as derivatives of the free energy with respect to parameters of the theory",
    ", they assume the form of moments of sums of the flux variables .",
    "often also interesting topological properties of the observables become evident in the dual representation : in particular conserved charges are represented as a winding number of the corresponding worldlines about the compactified time direction .",
    "finally it is possible to study also @xmath47-point functions in the dual formalism : they are represented by open strings of flux connecting the space time points where the fields of the @xmath47-point function are placed ( see , e.g. , @xcite for details of defining the observables for the rbg ( [ bosedual ] ) ) .",
    "having introduced the general worldline model , we now come to the definition of the update with a worm algorithm . the key idea of the worm algorithm is to violate the constraint ( [ fluxconservation ] ) at the endpoints of a randomly chosen starting link @xmath48 by changing the corresponding flux to @xmath49 , where @xmath50 is the flux increment of the worm , with @xmath51 chosen randomly . subsequently the worm propagates the defect at @xmath52 across the lattice by making random choices for the directions @xmath53 and so determines the sites @xmath54 and the links @xmath55 along which it moves in steps labelled by @xmath56 . in each step",
    "it proposes to change the flux variable of that link according to @xmath57 each step of the worm is accepted with a local metropolis decision .",
    "the worm terminates when a final step is accepted , where it reaches its starting point @xmath58 .",
    "then the defects are healed and we have a new configuration where all flux variables on links along a closed loop @xmath59 were changed : if @xmath60 denotes the starting configuration given by flux variables @xmath24 obeying ( [ fluxconservation ] ) , then the worm changes @xmath60 into a new configuration @xmath61 , where the fluxes on the links @xmath27 of the closed loop @xmath59 are given by @xmath62 all other flux variables remain unchanged .",
    "the new configuration @xmath61 also obeys the constraints ( [ fluxconservation ] ) , since the rule ( [ ktilde ] ) ensures that the total change of flux is also conserved at each site @xmath1 .",
    "it is straightforward to see that any admissible configuration of fluxes that obeys ( [ fluxconservation ] ) can be transferred by finitely many worms into any other admissible configuration , such that the worm algorithm is ergodic .",
    "it is convenient to introduce the following notation for a worm @xmath63 of length @xmath47 , @xmath64 i.e. , we characterize the worm by its starting link , given by the starting site @xmath65 and the starting direction @xmath66 , by the flux increment @xmath51 , and by the choices it makes for the directions @xmath53 in each step @xmath67 .",
    "the total number of steps is given by @xmath47 , and the worm visits the sites @xmath68 in the steps labelled with @xmath69 .",
    "note that the condition that the worm closes gives rise to @xmath70 and thus to @xmath71 , where @xmath72 is the extent of the lattice in direction @xmath9 and @xmath73 is the winding number of the worm around that direction ( note that due to the periodic boundary conditions the lattice is a ( hyper- ) torus ) .",
    "we remark that the worm can also retrace one or more steps , i.e. , @xmath74 is a legitimate choice and in this case the flux variable @xmath75 remains unchanged due to the rule ( [ fluxchange ] ) and the convention ( [ negativesteps ] ) .",
    "this implies that a worm can have dangling dead ends , where the flux remains unchanged , which are not part of the closed loop @xmath59 where the flux is actually altered when the worm is completed . in the two diagrams on the lhs .  of fig .",
    "[ wormcontours ] we show two examples of worms that change the flux along the same closed loop , but differ by several dangling dead ends .",
    "note that , although they change the flux along the same loop @xmath59 , worms with dangling dead ends have a different length .",
    "in addition to worms with dangling dead ends also other worms give rise to the same loop with changed flux : the worm can start at a different site of the loop or run through the loop in opposite direction with flux increment @xmath76 instead of @xmath50 . the third diagram in fig .",
    "[ wormcontours ] is an example of such a worm .",
    "we conclude that there are infinitely many worms that lead from a given configuration to another configuration where the flux is changed along a closed loop @xmath59 . for proving detailed balance also these loops with dangling dead ends will have to be considered .",
    "we finally point out that the loop @xmath59 where the flux is changed is not necessarily a single loop , but can consist of disconnected pieces .",
    "an example of such a loop is shown in the rhs .",
    "plot of fig .",
    "[ wormcontours ] .",
    "( third worm ) .",
    "the starting points of the worms are marked with a circle , the orientation with arrows and we denote the flux increment next to the first step of the worm .",
    "the example on the rhs .",
    "shows that the loop @xmath59 where a worm changes the flux can consist of several disconnected pieces.,width=566 ]    we now describe the general form of the worm algorithm using pseudocode .",
    "the code has two parts : the part for starting the worm and the pseudocode for running and terminating the worm .",
    "metropolis decisions determine the acceptance of the various steps of the worm with the metropolis probability min@xmath77 , where @xmath78 is referred to as the metropolis ratio .",
    "we use three different metropolis ratios : @xmath79 is used for starting the worm , @xmath80 for running the worm , and @xmath81 for terminating the worm .",
    "the corresponding mathematical expressions will be given later . in our code rand ( )",
    "denotes a random number generator that provides random numbers uniformly distributed in the interval @xmath82 .",
    "we stress that if the worm does not start , then the unchanged configuration @xmath60 is also the next configuration in the markov chain of configurations .    as is obvious from the pseudocode ,",
    "once it has started the worm propagates the defect introduced at the endpoint @xmath83 of the starting link , by proposing to add new links @xmath55 and changing the corresponding flux to @xmath84 .",
    "this trial flux is accepted with the metropolis probability min@xmath77 until the worm reaches its starting site @xmath58 and accepts the terminating step .",
    "the corresponding metropolis ratios @xmath85 , @xmath86 and @xmath87 now have to be chosen such that the configurations @xmath60 of the flux variables @xmath24 have the correct distribution according to their weights in the partition sum .",
    "from the partition sum ( [ zflux ] ) we read off the probability weight @xmath88 for an admissible configuration @xmath60 , @xmath89   \\left [ \\prod_x s_x ( \\{k_{x,\\bullet } \\ } ) \\right ]   \\ ; . \\label{pc}\\ ] ] the worm algorithm changes a configuration @xmath60 of the flux variables into a new configuration @xmath61 which differs from @xmath60 by a closed loop @xmath59 along which the flux has been changed",
    ". as we have already discussed , there are infinitely many different worms that change @xmath60 into @xmath61 .",
    "these are worms which differ by dangling dead ends , by their starting site on the loop or by their orientation ( using a flux increment @xmath76 instead of @xmath50 ) .",
    "all these worms contribute to the total transition probability @xmath90 from @xmath91 to @xmath61 and will have to be taken into account in our analysis .",
    "a key property for generating configurations @xmath60 with distribution ( [ pc ] ) is the detailed balance condition ( see , e.g. , @xcite for a standard textbook , or @xcite for a review in the context of lattice field theory ) , @xmath92 note that in addition to ( [ detailedbalance ] ) , the transition probability @xmath90 also needs to be defined as a proper , normalized probability , i.e. , @xmath93 and @xmath94 .",
    "together with detailed balance this implies the fixed point condition @xmath95 of the monte carlo process . this is a sufficient condition for the process to generate the correct distribution @xmath88 .",
    "the key step for constructing a worm algorithm that obeys detailed balance for the general worldline model is to correctly distribute the link and site weight factors @xmath96 and @xmath97 in the definitions for the metropolis ratios @xmath85 , @xmath86 and @xmath87 that determine the worm . a correct assignment , which will allow us to prove detailed balance in the next section and thus determines the correct worm algorithm for the general worldline model , is given by @xmath98 here we use the notation @xmath99 to indicate that in the set of link variables @xmath100 , which are the arguments of the site weights @xmath101 , one inserts the values the fluxes have after the worm has passed through @xmath102 .",
    "more explicitly : @xmath103 i.e. , the flux in the previous link @xmath104 of the worm has been replaced by the already accepted new flux @xmath105 and for the current step we use @xmath106 .",
    "the real and positive amplitude @xmath2 in ( [ rhos ] ) and ( [ rhot ] ) is a free parameter of the algorithm and we will show that detailed balance holds for arbitrary positive values of @xmath2 .",
    "it can be used to control the acceptance probability of the first step and the terminating probability of the last step : in a region of couplings where the average value of the site weights @xmath101 is very high , the acceptance probability for the initial step would be very small , and increasing the amplitude @xmath2 can be used for boosting the starting probability of the worm .",
    "on the other hand , for couplings where the average value of the site weights @xmath101 is very small , the acceptance probability for the terminating step would also be small , giving rise to worms that propagate for many steps ( not necessarily changing many fluxes , since a worm can annihilate its own changes via dangling dead ends ) .",
    "this implies that adjusting @xmath2 gives us control over the average length of worm and thus allows one to tune the efficiency of the algorithm .",
    "before we come to proving detailed balance for the worm defined by the metropolis ratios , let us comment a little on the choices ( [ rhos ] )  ( [ rhot ] ) . for a system without site weights ,",
    "i.e. , @xmath107 , our worm algorithm reduces to the standard worm algorithm @xcite , which only depends on the ratios of the link weights @xmath41 . in these ratios the weights",
    "are also balanced , such that the amplitude factor @xmath2 is not necessarily needed , but still may be introduced to adjust the average length of the worm .    in the general wordline model ( [ zflux ] ) also the site weights @xmath108 need to be taken into account for the metropolis ratios .",
    "however , here we have the situation that when the worm proposes the new flux @xmath84 for the current link @xmath55 , this proposal flux enters the arguments at both endpoints of that link , i.e. , at @xmath102 and @xmath109 .",
    "the problem is that the final value of @xmath110 is not yet known - dependence in the rbg admits an alternative strategy based on the insertion of an initial source - sink pair and a different propagation rule for the defect @xcite . ] , since it also depends on the decision the worm makes in the subsequent step , i.e. , on the choice of the link @xmath111 .",
    "thus in the metropolis ratio @xmath112 for the link @xmath55 we can take into account the final site weight @xmath99 only for the starting point @xmath102 of that link . in the metropolis ratio @xmath113 in ( [ rhor ] )",
    "we form the ratio of that final site weight @xmath114 at @xmath102 with the old site weight @xmath115 at @xmath116 in the denominator .",
    "the situation is even more involved for the starting metropolis ratio @xmath117 defined in ( [ rhos ] ) : there we also do not know the final site weight for the starting site @xmath58 , as its value will be determined only in the last step of the worm , depending on the direction @xmath118 in which the closing site @xmath119 is approached and the flux @xmath120 of the last link in the worm .",
    "we are now ready to prove the detailed balance condition ( [ detailedbalance ] ) with the weight @xmath88 of the flux configurations @xmath60 given in ( [ pc ] ) and the worm algorithm defined by the pseudocode in the previous section with the metropolis ratios ( [ rhos ] )  ( [ rhot ] ) for starting , running and terminating the worm .",
    "we have already stressed that there are infinitely many worms @xmath63 that lead from a configuration @xmath60 to the new configuration @xmath61 which differs by the flux along some loop @xmath121 .",
    "the total transition probability @xmath90 is a sum over the individual contributions @xmath122 from the worms @xmath63 , @xmath123 in the same way we have infinitely many reverse worms @xmath124 that lead from @xmath61 to @xmath60 with individual contributions @xmath125 to the reverse total transition probability @xmath126 .",
    "thus , when taking into account all worms connecting @xmath60 and @xmath61 , the detailed balance condition ( [ detailedbalance ] ) assumes the form @xmath127 the key observation for finding a sufficient condition to solve this equation is the fact that the set @xmath128 of worms from @xmath60 to @xmath61 and the set @xmath129 of worms from @xmath61 to @xmath60 allow for one - to - one mappings , such that to every worm @xmath63 in @xmath128 we can identify a worm @xmath130 , which we refer to as inverse worm . for a given worm @xmath63",
    ", we define the inverse worm @xmath131 via @xmath132 i.e , the inverse worm @xmath131 starts at the same site @xmath58 and runs backwards through the steps of @xmath63 , using the same flux increment @xmath50 .",
    "it is obvious , that @xmath131 inverts the steps of @xmath63 and changes the configuration @xmath61 back into @xmath60 .    using the fact that our definition of @xmath131 induces a one - to - one mapping between @xmath129 and @xmath128 , we can rewrite the detailed balance condition ( [ detailedbalance2 ] ) into the form , @xmath133 an obvious sufficient solution to this equation is the condition @xmath134 which demands that the ratio of the transition probability @xmath122 of @xmath63 and the transition probability @xmath135 of the inverse worm @xmath131 equals the ratio @xmath136 of weights of the two configurations @xmath61 and @xmath60 .",
    "note that one could be tempted to choose different definitions for the inverse of a worm @xmath63 , e.g. , the worm @xmath137 which starts at the same site @xmath58 , runs through the same links in the same orientation as @xmath63 , but with the negative flux increment @xmath76 .",
    "however , @xmath131 as defined in ( [ inverseworm ] ) is the natural choice if we take into account how the cancellation proceeds : the inverse worm @xmath131 starts with the closing link of @xmath63 and step by step cancels the changes of @xmath63 .",
    "this implies that for every site on the contour of the worm the heads of @xmath63 and of @xmath131 see the same configuration of fluxes and thus have the same options for steps with the same weights .",
    "as we will see , this property is essential for the correct normalization of the probabilities of the individual steps of the worm . for the alternative worm @xmath138 this is not the case , and for every site on the worm contour @xmath63 and @xmath138 see a different configuration of flux .",
    "thus @xmath63 and @xmath138 have different probabilities for their choices , and the cancellation of the normalization factors , which is an essential step in the proof of detailed balance below , is no longer possible .",
    "the transition probability @xmath122 of a worm @xmath63 is given by a product over the probabilities @xmath139 , @xmath140 and @xmath141 for its steps ,",
    "@xmath142 using this form and the identification of the inverse worm @xmath131 given in ( [ inverseworm ] ) , equation ( [ ratioworm ] ) turns into @xmath143 here we use the notation @xmath144 , @xmath145 and @xmath146 to indicate that the probabilities of the inverse worm @xmath131 , appearing in the denominator of ( [ ratioworm2 ] ) , start from the configuration @xmath61 which the worm @xmath131 takes back into the original configuration @xmath60 .",
    "let us now come to discussing the probabilities @xmath139 , @xmath140 and @xmath141 for the individual steps of the worms .",
    "it is important to understand the difference between the metropolis ratios @xmath85 , @xmath86 and @xmath87 given in ( [ rhos ] )  ( [ rhot ] ) and the step probabilities @xmath139 , @xmath140 and @xmath141 which constitute the probability @xmath147 in eq .",
    "( [ stepsofworm ] ) . the true , normalized probability of the worm to go in a new direction is not given by the metropolis acceptance probability min@xmath148 alone .",
    "one has to take into account the `` try until accepted '' feature for the intermediate and terminating steps in the worm algorithm , since the proposed steps out of @xmath1 are almost always rejected .",
    "a possible way out would be to replace the ' ' try until accepted \" steps by a heatbath step .",
    "] , and for these steps the metropolis acceptance probability min@xmath148 has to be normalized by a sum over the metropolis acceptance probabilities of all possible steps .",
    "consequently the probabilities for the steps in the worm @xmath63 are given by @xmath149 where the normalization @xmath150 for the probabilities of the steps for running and terminating the worm is given by @xmath151   \\ ; + \\ ; \\mbox{min } \\ , \\big\\ {   \\rho^{t}_{x_i,\\sigma } , 1 \\big\\ } \\delta_{x_i+\\hat{\\sigma},x_0 } \\big ] ~.\\ ] ] as discussed , this takes into account the `` try until accepted '' feature of the worm in the given configuration of fluxes .",
    "the probability for the starting step of the worm has no `` try until accepted '' feature , such that it is given by the metropolis acceptance probability @xmath152 normalized with the probability @xmath153 for selecting the starting link and its orientation .",
    "we furthermore stress that using the probabilities defined in ( [ eq : prob ] ) it is possible to demonstrate the normalization condition for the full transition probabilities @xmath94 .",
    "now we also see why the particular choice for inverse worm @xmath131 in eq .",
    "( [ inverseworm ] ) is fundamental for showing detailed balance . for this choice of @xmath131 one",
    "has exactly the same normalization factors as in @xmath63 , and all factors @xmath154 cancel in ( [ ratioworm2 ] )",
    ". a different choice of @xmath131 , e.g. , as the worm @xmath138 that runs through the steps of @xmath63 in the same orientation but with @xmath76 , does not give rise to this cancellation .",
    "having established the cancellation of the normalization factors in ( [ ratioworm2 ] ) , we are left with showing @xmath155 here we have already reordered the terms of the inverse worm @xmath131 in the denominators and paired them in ratios with the matching links of the forward worm in the numerators . inspecting the metropolis ratios ( [ rhos ] )  ( [ rhot ] ) for a worm @xmath63 and the corresponding inverse worm @xmath131 defined in ( [ inverseworm ] ) , one easily shows the following properties , @xmath156 finally we make use of the identity @xmath157 for @xmath158 and find @xmath159 using ( [ rhos ] )  ( [ rhot ] ) for the metropolis ratios and multiplying them as in the second term of ( [ ratioworm4 ] ) one finds that the result for this product is indeed the rhs .",
    "links in dangling dead ends appear in forward , as well as in backward direction in the product and it is easy to see that these factors cancel , and do not contribute to @xmath136 .",
    "in the same way it is easy to see that also the amplitude factor @xmath2 cancels and can be chosen freely to optimize the starting and closing probabilities and thus the average length of the worms .",
    "this concludes the proof of detailed balance .",
    "normalized with @xmath160 , the number of lattice links as a function of the amplitude @xmath2 .",
    "we show the results for coupling set i ( lhs .  plot ) and coupling set ii ( rhs . ) and compare different volumes.,title=\"fig:\",width=294 ]    normalized with @xmath160 , the number of lattice links as a function of the amplitude @xmath2 .",
    "we show the results for coupling set i ( lhs .  plot ) and coupling set ii ( rhs . ) and compare different volumes.,title=\"fig:\",width=296 ]     normalized with @xmath160 , the number of lattice links as a function of the amplitude @xmath2 .",
    "we show the results for coupling set i ( lhs .  plot ) and coupling set ii ( rhs . ) and compare different volumes.,title=\"fig:\",width=294 ]    normalized with @xmath160 , the number of lattice links as a function of the amplitude @xmath2 .",
    "we show the results for coupling set i ( lhs .  plot ) and coupling set ii ( rhs . ) and compare different volumes.,title=\"fig:\",width=294 ]     normalized with @xmath160 , the number of lattice links as a function of the amplitude @xmath2 .",
    "we show the results for coupling set i ( lhs .  plot ) and coupling set ii ( rhs . ) and compare different volumes.,title=\"fig:\",width=294 ]   normalized with @xmath160 , the number of lattice links as a function of the amplitude @xmath2 .",
    "we show the results for coupling set i ( lhs .  plot ) and coupling set ii ( rhs . ) and compare different volumes.,title=\"fig:\",width=297 ]     normalized by the number of steps of the worm as a function of @xmath2 .",
    "we show the results for coupling set i ( lhs .  plot ) and set ii ( rhs . ) , comparing different volumes.,title=\"fig:\",width=294 ]   normalized by the number of steps of the worm as a function of @xmath2 .",
    "we show the results for coupling set i ( lhs .  plot ) and set ii ( rhs . ) , comparing different volumes.,title=\"fig:\",width=295 ]     normalized by the number of steps of the worm as a function of @xmath2 .",
    "we show the results for coupling set i ( lhs .  plot ) and set ii ( rhs . ) , comparing different volumes.,title=\"fig:\",width=294 ]   normalized by the number of steps of the worm as a function of @xmath2 .",
    "we show the results for coupling set i ( lhs .  plot ) and set ii ( rhs . ) , comparing different volumes.,title=\"fig:\",width=296 ]     normalized by the number of steps of the worm as a function of @xmath2 .",
    "we show the results for coupling set i ( lhs .  plot ) and set ii ( rhs . ) , comparing different volumes.,title=\"fig:\",width=294 ]   normalized by the number of steps of the worm as a function of @xmath2 .",
    "we show the results for coupling set i ( lhs .  plot ) and set ii ( rhs . ) , comparing different volumes.,title=\"fig:\",width=296 ]    let us now analyze the role of the amplitude parameter @xmath2 .",
    "we have seen that detailed balance holds independently of the actual value of @xmath2 .",
    "however , the amplitude enters in the metropolis ratios ( [ rhos ] ) and ( [ rhot ] ) for starting and for terminating the worms .",
    "it is obvious , that increasing @xmath2 to sufficiently large values will increase the acceptance probability min@xmath161 for the starting step .",
    "on the other hand , increasing @xmath2 will lower the probability min@xmath162 for accepting the terminating step .",
    "thus we expect that large @xmath2 increases the length of the worms , since the terminating step is accepted less often and more termination attempts are needed to finish the worm",
    ".    this qualitative picture can be checked with the following quantities : the starting ratio @xmath163 , the number of termination attempts @xmath164 , the number of steps @xmath165 , and the ratio of sterile worms @xmath166 .",
    "they are defined as follows : @xmath167    in order to analyze the role of the amplitude parameter @xmath2 in our algorithm we implemented the worm for the relativistic bose gas as defined in ( [ action ] ) using the dual representation ( [ bosedual ] ) and a conventional local monte carlo update for the auxiliary variables @xmath23 .",
    "here sweeps for the @xmath23 are alternated with worms , but it is also possible to interleaf worm steps and updates of the auxiliary variables @xcite .",
    "the correctness of the implementation of the worm algorithm was tested against analytical results for the free case of @xmath168 and against the numerical results of a standard monte carlo simulation in the conventional representation at @xmath169 . for the analysis of the algorithmic observables ( [ observables ] ) that illustrate the role of the amplitude we use two set of couplings :    coupling set i : @xmath170 , @xmath171 , @xmath172 coupling set ii :",
    "@xmath173 , @xmath174 , @xmath175    the statistics is @xmath176 worms after @xmath177 worms for equilibration for coupling set i , and @xmath178 worms after @xmath179 worms for equilibration for coupling set ii .",
    "the algorithmic observables are computed for three different lattice sizes @xmath180 , @xmath179 and @xmath181 to assess possible finite size effects on the worm .",
    "we stress at this point that this numerical analysis is not meant as a detailed study of autocorrelation properties ( which also would imply a more systematic scan of the coupling space ) .",
    "the simulations presented here focus on illustrating in a specific model at two different coupling sets that the amplitude parameter @xmath2 indeed can be used to vary and optimize properties of the worm algorithm .",
    "the quantities that directly analyze the starting and terminating probabilities , i.e. , the starting ratio @xmath163 and the number of terminating attempts @xmath164 are shown in fig .",
    "[ starting ] and in fig .  [ terminating ] .",
    "both quantities are plotted as a function of @xmath2 and we show the results for coupling sets i and ii for the three different volumes .",
    "the starting ratio @xmath163 ( fig .  [ starting ] ) , as well as the number of termination attempts @xmath164 ( fig .  [ terminating ] ) show the expected dependence on @xmath2 : @xmath163 is an increasing function of @xmath2 and for coupling set i ( lhs .  plot in fig .  [ starting ] )",
    "quickly reaches its maximum value @xmath182 where all starting attempts are accepted .",
    "the approach towards the limiting value is of course strongly coupling dependent , and for coupling set ii the increase is much slower .",
    "the number of termination attempts @xmath164 increases with @xmath2 as expected , but of course without reaching an asymptotic value .",
    "while the starting ratio @xmath163 has no finite size effect ( as expected ) , the number of terminating attempts @xmath164 shows a mild volume dependence which we attribute to worms closing around the periodic boundaries .",
    "it is interesting to note that @xmath164 reaches rather high numbers ( which again depend on the couplings ) , which implies that for large @xmath2 the worm might spend a lot of time in the vicinity of its starting point , trying unsuccessfully to close the loop .",
    "as expected , the increase of @xmath164 with increasing @xmath2 , implies that also the number of ( accepted ) steps @xmath165 of the worm increases with @xmath2 .",
    "this behavior is seen in fig .",
    "[ steps ] . also here",
    "we observe a mild finite size effect , which again can be attributed to worms that wind around the periodic boundaries .    finally , in fig .  [ zero ]",
    "we show the ratio of sterile worms as a function of @xmath2 .",
    "sterile worms are those worms where the worm retraces exactly all previous steps and then terminates without changing the flux variables . in other words ,",
    "sterile worms consist only of dangling dead ends .",
    "one expects that the number of sterile worms goes down as the worms become longer , i.e. , as @xmath165 increases , since for longer paths the probability to exactly retrace all steps goes down .",
    "actually the largest fraction of sterile worms are the 2-step worms , where after the starting step the worm is canceled immediately by the second step .",
    "it is obvious that these 2-step worms are strongly affected by any change of the terminating probability determined by the amplitude @xmath2 .",
    "and indeed we observe that as @xmath2 is increased ( leading to larger @xmath165 ) the ratio of sterile worms @xmath166 goes down .",
    "however , the decline is not necessarily uniform as is obvious for coupling set i shown in the lhs .",
    "plot of fig .",
    "we furthermore observe , that @xmath166 has no finite size effects .",
    "this is not a surprise , since sterile worms that are made only of dangling ends can not wind and thus do not see the finiteness of the volume .",
    "the absence of any volume dependence for @xmath166 further supports our interpretation that the finite size effects observed for @xmath164 and for @xmath165 come from worms that wind around the periodic boundaries .",
    "we conclude our analysis of the influence of the amplitude parameter @xmath2 on properties of the worm by studying the actual amount of flux that is changed by the worm . for this analysis",
    "we define @xmath183 where @xmath24 and @xmath184 are the fluxes before and after the worm .",
    "note that this definition goes beyond simply determining the size of the loop @xmath59 that is changed by a worm , but takes into account that a worm could run through sub - loops several times thus creating changes of flux larger than @xmath185 .",
    "we show our results for @xmath186 as a function of @xmath2 in figs .",
    "[ length ] and [ change ] . in fig .",
    "[ length ] @xmath186 is normalized by the total number of links @xmath160 , while in fig .",
    "[ change ] we normalize by the number of accepted worm steps @xmath165 . when normalizing by the number of links ( fig .",
    "[ length ] ) we find that @xmath187 increases as @xmath2 increases and the worms become longer .",
    "this is indeed as expected . on the other hand , when normalizing by the number of worm steps @xmath165 we find that @xmath188 decreases when @xmath2 is increased and thus @xmath165",
    "this means that long worms are not necessarily more efficient in the sense that they lead to larger amounts of flux changed per step .",
    "however , a complete efficiency analysis has to take into account also the starting probability of the worm and depending on the couplings this balance between the two effects might give quite different optimal values of @xmath2 for different couplings .",
    "the last observation suggests that the role of the amplitude parameter @xmath2 might go beyond optimizing properties of a worm , but that @xmath2 even could be used to analyze the dynamics of worms by varying their length for a given set of couplings and to study how this influences efficiency and other characteristics .",
    "in this article we introduce a general worldline model , where the partitions function has weight factors that live on the links of the lattice , as well as weight factors on the sites of the lattice .",
    "the latter are not present in the standard applications the worm algorithm was developed for and one has to identify the correct distribution of the site weight factors in the metropolis decisions of the worm .",
    "a key complication in the general model is that in a step of the worm the final weights are known only at one side of the link .",
    "we propose a suitable distribution of the site weight factors in the metropolis acceptance probabilities which is independent of any particular form of the site weights .",
    "for the starting and terminating steps specific metropolis probabilities are used .",
    "we analyze the algorithm in detail and give a proof of detailed balance .    in the starting and the terminating step the site weights are unbalanced , i.e , they appear only in the denominator for the starting step and the numerator for the terminating step .",
    "we introduce an amplitude @xmath2 for the starting and terminating steps ( there @xmath2 appears in the denominator ) , such that very small or very large numbers for the site weights can be compensated for .",
    "this allows one to influence the starting and the terminating probabilities of the worm and to optimize the average worm length of the algorithm .",
    "the worldline model we consider is kept rather general , such that a wide class of systems with link and site weights is included .",
    "furthermore the key steps of our proof of detailed balance ( decomposition of the transition probability into contributions of individual worms @xmath63 , identification of the correct inverse worm @xmath131 , matching of individual weights for steps of @xmath63 and @xmath131 ) do not refer to any specific properties of the model , such that our proof can be used as blueprint for even more general models .",
    "the above mentioned amplitude @xmath2 , which enters the metropolis ratios for starting and for terminating the worm , not only serves to compensate for potentially low starting probabilities , but via adjusting the terminating probability @xmath2 can also be used to control the length of the worm and to optimize its performance .",
    "we demonstrate this feature of our worm algorithm in a numerical study of the 4-d relativistic bose gas .",
    "the introduction of such a parameter can be generalized to other systems and other variants of worm algorithms in a straightforward way such that the performance of worm algorithms can be optimized for different systems and various values of the couplings .",
    "this work was supported by the austrian science fund , fwf , dk _ hadrons in vacuum , nuclei , and stars _",
    "( fwf dk w1203-n16 ) .",
    "n.  prokofev and b.  svistunov , phys .",
    "* 87 * ( 2001 ) 160601 .",
    "m.  g.  endres , phys .",
    "d * 75 * ( 2007 ) 065012 [ hep - lat/0610029 ] .",
    "s.  chandrasekharan , pos lattice * 2008 * ( 2008 ) 003 [ arxiv:0810.2419 [ hep - lat ] ] .",
    "d.  banerjee , s.  chandrasekharan , phys .",
    "d * 81 * ( 2010 ) 125007 [ arxiv:1001.3648 [ hep - lat ] ] .",
    "t.  korzec , i.  vierhaus and u.  wolff , comput .",
    "commun .",
    "* 182 * ( 2011 ) 1477 [ arxiv:1101.3452 [ hep - lat ] ] .",
    "u.  wolff , nucl .",
    "b * 824 * ( 2010 ) 254 erratum : [ nucl .",
    "b * 834 * ( 2010 ) 395 ] [ arxiv:0908.0284 [ hep - lat ] ] .",
    "u.  wolff , nucl .",
    "b * 832 * ( 2010 ) 520 [ arxiv:1001.2231 [ hep - lat ] ] .",
    "p.  weisz and u.  wolff , nucl .",
    "b * 846 * ( 2011 ) 316 [ arxiv:1012.0404 [ hep - lat ] ] .",
    "m.  hogervorst and u.  wolff , nucl .",
    "b * 855 * ( 2012 ) 885 [ arxiv:1109.6186 [ hep - lat ] ] .",
    "j.  siefert and u.  wolff , phys .",
    "b * 733 * ( 2014 ) 11 [ arxiv:1403.2570 [ hep - lat ] ] .",
    "f.  niedermayer and u.  wolff , arxiv:1612.00621 [ hep - lat ] . c.  gattringer and t.  kloiber , nucl .",
    "b * 869 * ( 2013 ) 56 [ arxiv:1206.2954 [ hep - lat ] ] . c.  gattringer and t.  kloiber , phys .",
    "b * 720 * ( 2013 ) 210 [ arxiv:1212.3770 [ hep - lat ] ] .",
    "f.  bruckmann , c.  gattringer , t.  kloiber and t.  sulejmanpasic , phys .",
    "d * 94 * ( 2016 ) 114503 [ arxiv:1607.02457 [ hep - lat ] ] .",
    "t.  rindlisbacher and p.  de forcrand , arxiv:1610.01435 [ hep - lat ] .",
    "t.  rindlisbacher , o.  akerlund and p.  de forcrand , nucl .",
    "b * 909 * ( 2016 ) 542 [ arxiv:1602.09017 [ hep - lat ] ] . s.  katz , f.  niedermayer , d.  nogradi and c.  torok , arxiv:1611.03987 [ hep - lat ] .",
    "g.  aarts , phys .",
    ".  lett .",
    "* 102 * ( 2009 ) 131601 [ arxiv:0810.2089 [ hep - lat ] ] .",
    "m.  cristoforetti , f.  di renzo , a.  mukherjee and l.  scorzato , phys .",
    "d * 88 * ( 2013 ) 051501 [ arxiv:1303.7204 [ hep - lat ] ] .",
    "m.  lscher , `` computational strategies in lattice qcd '' , in `` modern perspectives in lattice qcd : quantum field theory and high performance computing '' , proceedings of les houches summer school session 93 ( 2009 ) , p. 331 - 399",
    "[ arxiv:1002.4232 [ hep - lat ] ] ."
  ],
  "abstract_text": [
    "<S> we introduce a generalized worldline model where the partition function is a sum over configurations of a conserved flux on a @xmath0-dimensional lattice . </S>",
    "<S> the weights for the configurations of the corresponding worldlines have factors living on the links of the lattice , as well as terms which live on the sites @xmath1 and depend on all fluxes attached to @xmath1 . </S>",
    "<S> the model represents a general class of worldline systems , among them the dual representation of the relativistic bose gas at finite density . </S>",
    "<S> we construct a suitable worm algorithm and show how to correctly distribute the site weights in the various metropolis probabilities that determine the worm . </S>",
    "<S> we analyze the algorithm in detail and give a proof of detailed balance . </S>",
    "<S> our algorithm admits the introduction of an amplitude parameter @xmath2 that can be chosen freely . using a numerical simulation of the relativistic bose gas </S>",
    "<S> we demonstrate that @xmath2 allows one to influence the starting and terminating probabilities and thus the average length and the efficiency of the worm .    </S>",
    "<S> remarks on the construction of worm algorithms for lattice field theories in worldline representation mario giuliani , christof gattringer university of graz + institute for physics + a-8010 graz , austria    0 </S>"
  ]
}