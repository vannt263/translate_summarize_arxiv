{
  "article_text": [
    "liver cancer is the third cause of cancer - related death @xcite .",
    "visualization of focal liver lesions ( flls ) has been attempted by employing various imaging techniques .",
    "ultrasound is often performed in the diagnostics due to its low cost , efficiency and non - invasiveness .",
    "the use of contrast - enhanced ultrasound ( ceus ) can further assess the contrast enhancement ( i.e. , the intensity of the fll area relative to that of the adjacent parenchyma ) patterns of flls , which has markedly improved the accurate diagnosis of flls @xcite .",
    "as shown in fig.[fig : tumor ] , temporal enhancement patterns typically characterize the benign or malignant flls ( e.g. , sustain enhancement in the last two vascular phases for benign and hypo - enhancement for malignant flls ) . on the other hand ,",
    "spatial enhancement patterns during the arterial phase often characterize the specific types of flls .",
    "extensive research efforts have been made to assist the experts in diagnosing different types of cancers and , in particular , flls using ultrasound images @xcite@xcite .",
    "however , the application of ceus for differentiating flls is still a relatively new technique @xcite@xcite@xcite@xcite .",
    "a cascade of artificial neural networks@xcite is employed to classify flls based on manually segmented lesion regions .",
    "anaye et al .",
    "@xcite analyzes the dynamic vascular patterns ( dvps ) of flls with respect to surrounding healthy parenchyma to differentiate between benign and malignant flls . in @xcite ,",
    "bakas et al .",
    "track a manually initialized fll and its surrounding parenchyma to characterize it as either benign or malignant based on its vascular signature . in their recent work @xcite , an automated method for selection of the optimal frame for initialization of the fll candidates is proposed .",
    "[ fig : tumor ]    in all these works , varying degrees of manual interactions are required to identify the regions of interest ( rois ) of flls or the normal parenchyma .",
    "the manual annotations are highly dependent on the skills and knowledge of the experts , leading to large variations in inter-/intra - observer image interpretations . besides , the ever - increasing amount of ceus data acquired and processed nowadays demands automatic computational systems that can save the radiologists time and efforts .",
    "in addition , most of the previous works focused on differentiating between benign and malignant flls , or characterizing a specific type of flls .",
    "we , on the other hand , are trying to combine different enhancement patterns to recognize multiple different types of flls in a unified framework .",
    "the main contributions of our work herein are threefold .",
    "first , we propose a fully automatic computational framework to recognize flls by modeling the locations of rois as latent variables in a discriminative model and combining both spatial and temporal enhancement patterns of the rois into the framework .",
    "our model is then trained by a weakly supervised learning algorithm , which alternates between inferring the most probable spatial and temporal locations of the rois and optimizing the model parameters .",
    "second , considering that most of the video frames and the regions in each frame contain redundant or irrelevant information for recognizing flls , the automatic detection of optimal locations of the rois is made very efficient by a novel data - driven inference method , which combines the spatial and temporal pruning techniques to disregard less discriminative frames and regions .",
    "the optimal roi locations are then determined by dynamic programming .",
    "last but not least , a new region representation for rois is presented to capture the important and relevant ultrasonic characteristics of flls , which is not necessarily limited to our framework .",
    "we apply our method on a new dataset ( namely sysu - ceus dataset ) we collected and made public , which contains in total 353 ceus video sequences of three types of flls ( @xmath0 hcc , @xmath1 hem and @xmath2 fnh ) , and is , to the best of our knowledge , the largest dataset in the literature .",
    "the experimental results demonstrate that our method achieves promising performance without manual interactions .",
    "the accurate classification of flls highly depends on the representation of the characteristics of the lesion regions ( e.g. , internal echo , morphology , edge , echogenicity and posterior echo enhancement ) . however , one single roi @xmath3 is often insufficient to capture all the ultrasonic characteristics .",
    "for instance , the region inside the lesion , denoted as @xmath4 , can capture the internal echo of the fll ; the lesion region @xmath3 can be used to observe the boundary and the morphology of the fll ; and the tissue area surrounding the lesions , denoted as @xmath5 , can be used to measure the posterior echo enhancement .",
    "the echogenicity of the lesion can be measured by comparing the intensities of above regions .",
    "thus , given an roi @xmath3 , the regions @xmath4 and @xmath5 can be obtained by shrinking and enlarging @xmath3 by a small factor , respectively .",
    "we then propose an effective region representation as following :    where @xmath6 extracts the appearance features of each region , such as grey level co - occurrence matrix(glcm ) and local phase(lp ) ; @xmath7 calculates the mean intensity difference of two regions .",
    "consequently , the concatenation of all these features , @xmath8 , captures all the desired ultrasonic characteristics of this region @xmath3 .",
    "given a ceus video sequence @xmath9 , @xmath10 is the corresponding class label of the fll in this video , ranging over a finite set @xmath11 ( e.g. , @xmath11=\\{hcc , hem , fnh } ) .",
    "we assume that the fll can be compactly represented by a set of rois @xmath12 in three vascular phases : arterial , portal venous , and late phases . intuitively , rois are the most discriminative regions for distinguishing different flls . and",
    "each roi @xmath13 is a region extracted from the video frame @xmath14 , at the spatial location @xmath15 , where @xmath16 are the coordinates and the scale of the roi .",
    "the latent variables @xmath17 , where @xmath18 , is the location of @xmath13 , taken values from a finite set @xmath19 of all possible roi locations",
    ". given video @xmath9 , its corresponding class label @xmath10 , and latent variables @xmath20 , the conditional probability of the recognition problem is defined as ,    where @xmath21 is the model parameter vector , @xmath22 , and @xmath23 is a feature vector depending on the video sequence @xmath9 , the class label @xmath10 , and the latent variables @xmath20 .",
    "we define the formulation of @xmath24 as the following , including two terms : unary potential and pairwise potential ,    where @xmath25 is the unary potential function of variable @xmath26 and @xmath27 is the pairwise potential function of @xmath28 .",
    "@xmath29 is the set of neighboring latent variables ( defined for the pairs of temporally adjacent rois ) .",
    "\\1 ) unary potential @xmath30 : this singleton potential function @xmath25 models the compatibility between class label @xmath10 and appearance of region @xmath13 ( note that @xmath31 ) .    where @xmath32 is the feature vector describing the appearance of the region , as defined in section [ sec : feature ] .",
    "the indicator function @xmath33 is equal to one if @xmath34 , zero otherwise .",
    "similarly , @xmath35 is equal to one if @xmath36 , zero otherwise .",
    "the parameter @xmath37 is simply the concatenation of all @xmath38 .",
    "\\2 ) pairwise potential @xmath39 : the potential function @xmath27 models the compatibility between class label @xmath10 and the temporal transition of a pair of neighboring latent variables @xmath28 .    where @xmath40 includes two components : appearance variance feature , computed by the difference of @xmath32 and @xmath41 , and spatial displacement feature , i.e. , euclidean distance between the spatial coordinates of @xmath26 and @xmath42 . and",
    "the parameter @xmath43 is simply the concatenation of all @xmath44 .",
    "given a training set @xmath45 , the model parameter @xmath21 can be learned by maximizing the conditional log - likelihood on the training samples :    where @xmath46 denotes the conditional log - likelihood of the @xmath47 training example , defined in eq([eq : logeq ] ) , and @xmath48 denotes the conditional log - likelihood of the whole training set .",
    "the objective function @xmath48 is not concave , due to the latent variables @xmath20 .",
    "we adopt the latent structural svm learning framework @xcite , which alternates between inferring the latent variables @xmath20 and optimizing the model parameter @xmath21 .",
    "the problem of inferring @xmath20 can be solved efficiently using a data - driven inference algorithm ( sec .",
    "[ sec : inference ] ) , and the parameter optimization is a standard structural svm training problem , solved by the cutting - plane algorithm . we repeat the above two steps until convergence .",
    "we use the one - vs - one binary classification strategy for multi - class classification problem .    given a learned model , the classification is achieved by first finding the best hypothesis @xmath49 for @xmath50 rois , then picking the fll class with the highest svm score .",
    "the score of an example @xmath9 with a learned classifier is defined as :    @xmath51      the inference task is to find the optimal locations of the rois ( i.e. , the latent variables @xmath52 ) .",
    "however , the searching space will be very large if we consider all regions in all frames .",
    "thus , we propose a data - driven inference algorithm , which efficiently combines the spatial and temporal pruning techniques to disregard less discriminative frames and regions .",
    "the optimal locations @xmath49 of the most discriminative rois can then be determined using dynamic programming .",
    "\\1 ) temporal pruning : in a ceus video , the appearance of ultrasound frames often varies slowly and smoothly according to the hemodynamic , and the most discriminative frames are usually those with the largest contrast changes compared with neighboring frames .",
    "thus , a small set of candidate frames , which have local maximum of the contrast change , are automatically selected . in particular , for each frame @xmath53 in a video @xmath9 , we compute the contrast feature @xmath54 from the co - occurrence distribution @xmath55 defined over @xmath56 @xcite .",
    "the contrast vector @xmath57 is then @xmath58 .",
    "let @xmath59 be the gradient of @xmath57 , the candidate frame set @xmath60 is formed by finding the frames at the local maximum of @xmath59 .",
    "\\2 ) spatial pruning : after temporal pruning , we also prune the less important regions by considering two priors : saliency prior and location prior .",
    "first , we believe that _ salient _ regions ( e.g. , having higher contrast or containing typical structures ) have more discriminative information , and thus are more likely to be candidates of rois .",
    "second , we observe that flls often appear in or close to the center of the images , probably because a skilled ultrasound operator usually places the liver area in the middle of the display . according to these two observations , we evaluate all the regions with different scales in each candidate frame @xmath61 ( sliding window protocol ) , and only select the regions with prior probability larger than a threshold @xmath62 as roi candidates . the prior probability of a region @xmath63 being an roi is ,    where @xmath64 is the normalized mean saliency of the region @xmath63 in the saliency map @xmath65 , computed by the quaternion - based spectral saliency method @xcite on image @xmath66 . @xmath67 and @xmath68 are the centroid of region @xmath63 and the image @xmath66 , respectively .",
    "@xmath69 is a gaussian distribution .",
    "it is worth noting that the spatial pruning in the last two vascular phases ( portal and late ) can be more aggressive .",
    "this is because the contrast between flls and normal tissues is often very low , and the locations of flls do not change much since the arterial phase .",
    "thus , in the last two phases , we only search the regions in a spatial neighborhood around the locations of roi candidates found in the arterial phase .",
    "finally , given the model parameters and the observations , the latent variables @xmath70 form a hidden markov model , and can be solved exactly by the viterbi algorithm @xcite .",
    ".sensitivities and mean accuracies on characterizing benign and malignant flls .",
    "sens means the sensitivity of the specific class . [ cols=\"^,^,^,^,^\",options=\"header \" , ]     [ tab : feature ]    we first report the sensitivities and mean accuracies of our method in differentiating benign and malignant flls in table .",
    "[ tab : comparison ] .",
    "the average accuracy ( @xmath71 ) is comparable , if not superior , to the results reported in previous studies on smaller datasets @xcite@xcite.the second experiment in table .",
    "[ tab : inference ] shows the effectiveness of our data - driven inference algorithm by altering the procedure to determine the rois .",
    "our data - driven inference algorithm (  ddi \" ) is compared with 1 )  manual \" : the roi of each instance in the arterial phase is manually selected and the inference only performed in the portal and late phase ; 2 )  bruteforce \" : the liver region is labeled and the optimal rois are searched in the entire region of liver , without pruning ; 3 )  baseline \" : the rois are randomly selected in the images of three phases .",
    "the results demonstrate that our fully automatic inference algorithm achieves comparable performance to the `` manual '' method , and performs better than `` brute force '' and `` baseline '' .",
    "note that the performance of our algorithm on fnh is worse because the amount of training data of fnh is relatively small .    finally , in table.[tab : feature ] we compare the region representation of our framework with other state - of - the - art methods : multiple - roi @xcite , roi@xmath72 @xcite and roi@xmath73 @xcite .",
    "each region representation is tested with three popular low - level features : glcm , law s texture , and local phase , similar to @xcite .",
    "we manually select rois in three phases as required in previous works ( note here we do not consider the performance of the inference algorithm ) , and use linear svm as the classifier .",
    "the results show that our region representation obtains superior performances in general .",
    "in this work we propose a fully automatic computational framework for characterizing different types of flls in ceus , which efficiently combines the diverse information of spatial and temporal enhancement patterns .",
    "besides , a weakly supervised learning algorithm is utilized , which alternates between inferring the latent variables ( i.e. the locations of rois ) and optimizing the model parameters . an efficient data - driven inference algorithm is then proposed to efficiently determine the optimal locations of rois .",
    "the results show promising classification accuracies and the potential of being developed for real - time clinical applications . in the future",
    ", a more interactive system will be developed to enable the radiologists to revise the diagnosis according to the detailed outputs of our algorithm ( e.g. , the locations of rois and the reference frames ) ."
  ],
  "abstract_text": [
    "<S> the aim of this study is to provide an automatic computational framework to assist clinicians in diagnosing focal liver lesions ( flls ) in contrast - enhancement ultrasound ( ceus ) . </S>",
    "<S> we represent flls in a ceus video clip as an ensemble of region - of - interests ( rois ) , whose locations are modeled as latent variables in a discriminative model . </S>",
    "<S> different types of flls are characterized by both spatial and temporal enhancement patterns of the rois . </S>",
    "<S> the model is learned by iteratively inferring the optimal roi locations and optimizing the model parameters . to efficiently search the optimal spatial and temporal locations of the rois </S>",
    "<S> , we propose a data - driven inference algorithm by combining effective spatial and temporal pruning . </S>",
    "<S> the experiments show that our method achieves promising results on the largest dataset in the literature ( to the best of our knowledge ) , which we have made publicly available .    </S>",
    "<S> ceus , flls , spatio - temporal model , </S>"
  ]
}