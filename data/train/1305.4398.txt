{
  "article_text": [
    "in recent work , hsia and silverman  @xcite ask a dynamical question in analogy with a question of scharaschkin  @xcite ; the dynamical question is as follows .",
    "let @xmath0 be a self - morphism of a variety over a number field @xmath1 , let @xmath3 be a subvariety , and let @xmath2 .",
    "hsia and silverman ask whether the closure of the intersection of the orbit @xmath6 with the subvariety @xmath7 is equal to the intersection of @xmath8 with the closure of @xmath9 in the adelic topology , i.e. whether @xmath10 where @xmath11 denotes the closure in the adelic topology .",
    "the purpose of this paper is to give some justification to the assertion that a closely related question has a positive answer . in particular , when @xmath12 , ( and a choice of an integral model for @xmath7 is made ) we give evidence for the assertion that @xmath13 for some integer @xmath14 , as long as the map @xmath15 is sufficiently random .",
    "our evidence is twofold : a probabilistic argument that holds under certain randomness assumptions , and unconditional results in the case that @xmath15 is tale and @xmath7 is @xmath16-invariant or @xmath15-preperiodic .",
    "the probabilistic argument is given in section  [ sec : prob_proof ] and is based on a probabilistic argument of poonen  @xcite for the original question of scharaschkin .",
    "precisely , we show the following :    assume that @xmath15 is sufficiently random ( see section  [ subsec : assumptions ] for the precise statement ) and that the lengths of the cyclic part of the orbit @xmath9 modulo @xmath17 are integers with at least the same probability of being smooth as that of a random integer of similar size",
    ". then there exists a sequence of _ squarefree _ integers @xmath14 such that @xmath18 as @xmath19 . here",
    "@xmath20 denotes the cyclic part of @xmath9 in @xmath21 .    if the intersection of the orbit @xmath9 modulo @xmath14 with @xmath22 is contained only in the tail of @xmath23 , then the intersection @xmath24 consists of finitely many _ iterates _ of @xmath25 under @xmath15 .",
    "more specifically , @xmath26 for all @xmath27 , where @xmath28 denotes the composition of @xmath15 with itself @xmath29 times . therefore @xmath30 is contained in @xmath31 and so can be computed by a finite computation .",
    "therefore , it is reasonable to restrict to the cyclic part of the orbit in the above theorem .    in section  [ sec : computations ] , we provide numerical evidence for the randomness assumptions needed in the heuristic argument from section  [ sec : prob_proof ] .",
    "we also describe experiments on randomly generated morphisms of @xmath32 which support the argument that   holds .",
    "the unconditional results are the focus of section  [ sec : dynamicalhasse ] .",
    "assume that @xmath33 is quasi - projective , that @xmath15 is tale , and that @xmath34 , i.e. , that @xmath7 is _ @xmath35-invariant _ , for some positive integer @xmath36 . under these assumptions",
    "we show that if @xmath37 , then for all but finitely many primes @xmath17 , there exists an @xmath38 such that @xmath39 if every irreducible component of @xmath7 is _ preperiodic _ ,",
    "i.e. , @xmath40 for some integers @xmath41 with @xmath42 , @xmath33 is quasi - projective , and @xmath15 is tale and closed , then we obtain the same result . more generally , we prove    let @xmath33 be a quasi - projective variety over a global field @xmath1 .",
    "assume that @xmath15 is tale , and either ( 1 ) that @xmath7 is @xmath43-invariant or ( 2 ) that @xmath15 is closed and every irreducible component of @xmath7 is @xmath15-preperiodic . if @xmath2 is such that @xmath44 then , for all but finitely many primes @xmath45 , @xmath46 where @xmath47 denotes closure in the @xmath45-adic topology .",
    "in  [ subsec : closing ] , we discuss whether the assumption that @xmath7 is preperiodic or @xmath16-invariant can be weakened in any way .",
    "this project was started during the workshop on global arithmetic dynamics , part of the semester program on complex and arithmetic dynamics at the institute for computational and experimental research mathematics ( icerm ) .",
    "we thank zo chatzidakis , alice medvedev , and thomas scanlon for helpful discussions during the workshop , and we are grateful to the icerm staff and the organizers of the workshop , xander faber , michelle manes , lucien szpiro , thomas tucker , and michael zieve , for their support .",
    "we thank serge cantat for pointing out a construction in section  [ subsec : closing ] .",
    "let @xmath33 be a projective variety over @xmath48 , let @xmath49 be a closed @xmath48-subvariety , and let @xmath50 be a @xmath48-morphism .",
    "we write @xmath51 the goal of this section is to prove , under some randomness assumptions , that if @xmath52 , then with probability @xmath53 there exists a positive integer @xmath14 such that , roughly speaking , the cyclic part of @xmath54 is disjoint from @xmath22 .    to make this precise , we need some further notation .",
    "fix a finite set of primes @xmath55 such that @xmath56 and @xmath25 extend to flat projective models @xmath57 and @xmath58 , respectively , over @xmath59 .",
    "after possibly enlarging @xmath55 , we also assume that @xmath15 extends to a morphism @xmath60 .",
    "then for any integer @xmath14 which is relatively prime to all elements of @xmath55 , we may consider the base change @xmath61 .",
    "similarly , we have @xmath62 , @xmath63 and @xmath64",
    ". we will often abuse notation and write @xmath65 for @xmath66 .",
    "we write @xmath67 as @xmath68 is contained in the finite set @xmath69 , there is some pair of non - negative integers @xmath70 such that @xmath71 .",
    "let @xmath72 be the minimal such integer ; then we define the cyclic part of @xmath68 as @xmath73      with the above notation , our randomness assumptions on @xmath15 and @xmath7 are then based on the following heuristics :    1 .",
    "the reduction of morphisms @xmath50 modulo @xmath17 behave like random maps on a finite set @xmath74 .",
    "2 .   for any @xmath75 , the condition that @xmath76 is independent from the condition that @xmath77 .",
    "3 .    for any @xmath78 ,",
    "the condition that @xmath79 is independent from the condition that @xmath80 for primes @xmath81 .",
    "these heuristics are made precise as follows",
    ".    1 .   for all primes @xmath82 , @xmath83 2 .",
    ": for all primes @xmath82 @xmath84 for @xmath85 , and @xmath86 distinct points modulo @xmath17 .",
    "3 .   if @xmath87 , then @xmath88    any two different models will differ at only finitely many primes . therefore ,",
    "since assumptions   say something about behavior at sufficiently large primes , these assumptions are really assumptions on @xmath89 and @xmath25 and not @xmath90 .",
    "if @xmath91 is a ( large ) finite set , and @xmath92 is a sufficiently random map , then cardinality of the forward orbit of a random starting point is likely to be of size @xmath93  @xcite .",
    "this , together with the weil conjectures which give that @xmath94 and @xmath95 , shows that the above heuristics imply the precise assumptions  .    [ rem : assumptionfailures ] we warn the reader that there are maps of special type for which the random map heuristic does not apply .",
    "for example , for linear automorphisms on @xmath96 , orbits can be as large as @xmath97 .      under assumptions   and",
    "if @xmath7 has sufficiently small codimension , then , with probability @xmath53 , we will have @xmath98 for all but finitely many @xmath17 _ even if _ @xmath99 and @xmath7 have empty intersection .",
    "the intuition is as follows . if @xmath7 is , say , of codimension @xmath53 in @xmath33 , then the probability that the reduction of @xmath100 modulo @xmath17 is contained in @xmath101 should equal @xmath102 .",
    "furthermore , if the orbit is of length @xmath103 , as we would expect , then the likelihood of @xmath104 should be given by @xmath105 , assuming @xmath17 is sufficiently large .",
    "thus , if the orbits are long , there will be `` accidental '' intersections modulo @xmath17 .",
    "assume that assumptions   hold , and that @xmath106 .",
    "then , as @xmath107 , @xmath108    [ rem : big - size - ok ] the proposition still holds under a relaxed orbit size assumption : it is sufficient to assume @xmath109 for some @xmath110 such that @xmath111 .    by assumption  , @xmath112 , and by the weil conjectures , @xmath113 , @xmath114 .",
    "therefore , assumption   gives that @xmath115 in particular , @xmath116 and therefore , by assumption  , @xmath117      the situation is quite different over composite integers @xmath14 .",
    "indeed , the main result of this section is that , assuming some further randomness properties , there exist integers @xmath14 such that the probability that @xmath118 and @xmath22 are disjoint is arbitrarily close to @xmath53 .",
    "we begin by recalling some background on smooth numbers .",
    "an integer @xmath29 is if all primes @xmath17 dividing @xmath29 are bounded above by @xmath119 .",
    "define @xmath120    smooth integers have the following well - known distribution  ( * ? ? ?",
    "10 , p. 97 ) for @xmath121 and @xmath122 tending to infinity , @xmath123 where @xmath124 , and @xmath125 for @xmath126 .    our analysis will be based on the following heuristic : that @xmath127 has the same `` likelihood '' of being smooth as a random integer of the same size . by",
    ", @xmath128 , so the heuristic implies that the density of primes @xmath17 for which @xmath129 is @xmath130-smooth equals @xmath131 where @xmath132 , and hence that @xmath133 this heuristic leads us to the following precise : for @xmath134 and @xmath135 fixed and @xmath136 , @xmath137    [ prop : probresult ] assume  . then there exists a sequence of _ squarefree _ integers @xmath14 such that @xmath18 as @xmath19 .",
    "define @xmath138 since for any square free integer @xmath139 , @xmath140 , we have , as @xmath141 , @xmath142 in particular , @xmath143 therefore , if we take @xmath144 we find that @xmath145 , thus @xmath146 , and hence @xmath147 as @xmath141 .",
    "we ran experiments , detailed below , to justify the assumption   on the smoothness of the cycle lengths .",
    "our experiments do not confirm this assumption .",
    "fortunately , it is clear from the proof of proposition [ prop : probresult ] that we only need that the cycle lengths be at least as smooth as the prediction   and this is what we see in the experiments .",
    "we also found some maps with special properties for which the cycle lengths are even smoother .",
    "we conjecture that cycle lengths be at least as smooth as the prediction   in all cases but we do nt know how to explain the extra smoothness shown in the experiments .",
    "we will consider three maps : @xmath148 for each prime less than 100,000 , 500,000 and 1,000,000 respectively we compute @xmath149 , the length of the periodic cycle length of @xmath150 $ ] , @xmath151 $ ] , or @xmath152 $ ] under @xmath15 , @xmath153 , and @xmath154 respectively in @xmath155 .",
    "setting @xmath156 , we compute @xmath157 $ ] at each prime in the range specified .",
    "we then create the graphs below which compare @xmath158 to the predicted value of @xmath159 where @xmath160 and @xmath161 is the dickman @xmath161-function .",
    "recall that assumption   states that @xmath162 should behave linearly ; the graphs ( figures 1 , 2 , and 3 below ) support this assumption .",
    "the data appears linear for large enough @xmath122 , with slope at least as big as predicted .",
    "all computations were performed using c and sage 4.8  @xcite .",
    "[ dim1 ]   for @xmath163 and @xmath164,title=\"fig : \" ]    [ dim2 ] : for @xmath165 and @xmath166,title=\"fig : \" ]    [ dim3 ]   for @xmath167 and @xmath168,title=\"fig : \" ]      in this section , we let @xmath169 and let @xmath170 . fix a point @xmath171 and consider a morphism @xmath172 with integer coefficients ; then @xmath173 . as",
    "@xmath7 contains few integral points , namely only those points with exactly one coordinate equal to @xmath174 and the remaining coordinates @xmath175 , one expects the intersection @xmath176 to be empty .",
    "thus , by the arguments in   [ sec : prob_proof ] , we expect to find an integer @xmath14 such that @xmath177    we considered a fixed integer starting point @xmath25 and @xmath178 randomly generated morphisms from @xmath179 with integer coefficients . for each of these morphisms , we computed whether the intersection @xmath180 was empty for some positive integer @xmath181 .",
    "the results are as follows :    1 .   for @xmath182 of these maps ,",
    "i.e. , @xmath183 out of @xmath178 , there exists a prime power @xmath184 such that @xmath185 .",
    "2 .   for @xmath186 of these maps ,",
    "i.e. , @xmath187 out of @xmath178 , there exists a positive integer @xmath181 such that @xmath188 .",
    "3 .   for @xmath189 of the @xmath190 remaining maps ,",
    "we conclude that @xmath191 by finding an integer @xmath192 such that @xmath188 . in each of these cases ,",
    "the smallest such @xmath14 is supported at more than @xmath53 prime .",
    "4 .   for the remaining @xmath193 maps , @xmath194 for all @xmath195 .",
    "however , we are still able to conclude that @xmath191 by showing that the image of @xmath196 modulo @xmath197 is disjoint from @xmath198    all computations were performed using ` magma `  @xcite .",
    "let @xmath1 be a global field , and let @xmath199 denote its set of places . for a finite set @xmath55 of places of @xmath1 containing all the archimedean places",
    ", we write @xmath200 to denote the ring of @xmath55-integers . for all @xmath201",
    ", we use @xmath202 to denote the @xmath45-adic completion .",
    "if @xmath45 is nonarchimedean , we write @xmath203 , @xmath204 , and @xmath205 for the valuation ring , maximal ideal , and residue field of @xmath45 , respectively .",
    "let @xmath33 denote a @xmath1-variety , i.e. , a reduced separated scheme of finite type over @xmath1 , let @xmath3 denote a closed @xmath1-subvariety , and let @xmath206 denote a @xmath1-endomorphism . for any @xmath1-variety @xmath207 ,",
    "define @xmath208 we equip @xmath209 with the @xmath45-adic topology and @xmath210 with the product topology .",
    "we view @xmath211 as a subset of @xmath212 via the diagonal embedding . for every subset @xmath213 of @xmath212 or @xmath209",
    ", we write @xmath214 or @xmath215 for the closure of @xmath213 in the product topology or @xmath45-adic topology , respectively .",
    "since @xmath207 is separated , @xmath209 , and hence @xmath212 , is hausdorff .",
    "we note that as @xmath207 is not assumed to be projective , @xmath212 need not agree with the adelic points of @xmath207 . for basic terminologies and properties of scheme theory",
    ", we refer the readers to @xcite , for properties of smooth and tale morphisms used throughout this section , we refer the readers to @xcite .",
    "[ [ the - dynamical - hasse - principle - for - tale - maps - and - preperiodic - subvarieties ] ] the dynamical hasse principle for tale maps and preperiodic subvarieties ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    for any point @xmath2 , we have the following containments : @xmath216 recall the definition by hsia - silverman @xcite that @xmath217 is said to be dynamical brauer - manin @xmath55-unobstructed if the leftmost containment is an equality for every @xmath2 satisfying @xmath218 , where @xmath219 is the union of all positive dimensional preperiodic subvarieties of @xmath7 . in analogy , we define the dynamical hasse principle :    [ def : hasse ] the triple @xmath217 is said to satisfy the dynamical hasse principle ( over @xmath1 ) if for every @xmath2 such that @xmath220 , there exists a place @xmath45 ( depending on @xmath25 ) such that @xmath221 .",
    "if there are infinitely many such places @xmath45 , we say that @xmath217 satisfies the strong dynamical hasse principle .",
    "when @xmath222 , if @xmath217 satisfies the strong dynamical hasse principle then it is immediate that @xmath223 is brauer - manin @xmath55-unobstructed for every @xmath55 .",
    "the reason is that for every @xmath2 such that @xmath220 , both containments above are equalities since all the three sets are the empty set .",
    "our main results in this section are the following :    [ thm : dynamicalhasse ] assume that @xmath33 is quasi - projective , that @xmath15 is tale , and that @xmath7 is @xmath43-invariant , i.e. , that @xmath224 , for some @xmath225 . if @xmath2 is such that @xmath44 then , for all but finitely many primes @xmath45 , @xmath226 consequently , @xmath227 satisfies the strong dynamical hasse principle .",
    "[ thm : new_global ] assume that @xmath33 is quasi - projective and that @xmath15 is tale and closed . let @xmath7 be a preperiodic subvariety of @xmath33 , which means that there exist @xmath228 and @xmath229 such that @xmath230 . for every @xmath2 , if @xmath44 then , for all but finitely many primes @xmath45 , @xmath226 consequently , @xmath227 satisfies the strong dynamical hasse principle .",
    "notice that in the theorems , we do not suppose that @xmath7 is irreducible .",
    "but it is clear that the general case reduces to this . indeed , for instance in [ thm :",
    "new_global ] , let @xmath231 be an irreducible component of @xmath7 such that the closure of the orbit of @xmath25 meets @xmath231 . though the component @xmath231 does not have to be preperiodic in general , @xmath231 is preperiodic when it is of maximal dimension ( thanks to the taleness of @xmath15 ) .",
    "moreover , if @xmath231 is not preperiodic , then some power of @xmath15 sends it to a component of @xmath7 of greater dimension .",
    "thus , if the closure of the orbit of @xmath25 meets @xmath231 , it necessarily meets some preperiodic component of @xmath7 , so we may replace @xmath7 by this component .",
    "in   [ subsec : local ] we prove a local version of theorem  [ thm : dynamicalhasse ] .",
    "next in   [ subsec : global ] , we show how theorem  [ thm : dynamicalhasse ] follows from the local version , theorem  [ thm : adic_closure ] . in",
    " [ subsec : preinvariant ] we prove theorem  [ thm : new_global ] and in   [ subsec : closing ] we give some closing remarks .      throughout this section",
    ", we work locally .",
    "let @xmath91 denote a complete discrete valuation ring , @xmath232 its maximal ideal , and @xmath36 its residue field ; we will assume that @xmath36 is perfect .",
    "we write @xmath233 for the fraction field of @xmath91 .",
    "[ thm : adic_closure ] let @xmath234 be a smooth quasi - projective scheme over @xmath91 , let @xmath15 be an tale endomorphism of @xmath234 , and let @xmath235 be a reduced and closed subscheme of @xmath234 such that @xmath236 for some @xmath237 .",
    "let @xmath238 be such that the reduction @xmath239 of @xmath25 modulo @xmath232 is preperiodic under @xmath240 if @xmath241 then @xmath242 does not intersect the @xmath232-adic closure of @xmath9 .          * @xmath244 is an open and closed subset of @xmath245 , and it is compact if @xmath36 is finite .",
    "* for each @xmath246 , and each positive integer @xmath29 , @xmath247 is open and closed and the collection @xmath248 forms a basis of neighborhoods of @xmath122 .",
    "furthermore , for any @xmath249 , the set @xmath244 is a disjoint union of subsets of the form @xmath250 ; if @xmath36 is finite , then @xmath244 is a disjoint union of _ finitely many _ such subsets .",
    "note that the @xmath232-adic topology on @xmath245 is defined as follows .",
    "let @xmath251 be an affine open cover of @xmath234 ; assume that each @xmath252 is of the form @xmath253/i_{\\alpha})$ ] .",
    "then @xmath254 is identified with the zero locus of @xmath255 in @xmath256 , and we equip it with the usual @xmath232-adic topology .",
    "this topology is independent of the choice of an affine covering and independent of the choice of presentation @xmath253/i_{\\alpha})$ ] of an open in the covering .",
    "since , by assumption , @xmath234 is of finite type , we assume that the covering is finite .",
    "all assertions in the lemma follow immediately from the above description of the @xmath232-adic topology on @xmath245 .",
    "[ lem : complete_local ] let @xmath234 be a smooth quasi - projective scheme over @xmath91 , let @xmath25 be an @xmath91-point of @xmath234 , and let @xmath239 denote its reduction in @xmath257 .",
    "then the @xmath258-adic completion @xmath259 is isomorphic to @xmath260 $ ] , where @xmath261 is the relative dimension of @xmath234 at @xmath25 over @xmath91 .",
    "moreover , a choice of an isomorphism @xmath262\\ ] ] gives the corresponding homeomorphism @xmath263    if @xmath233 is characteristic @xmath175 and @xmath36 is characteristic @xmath17 , then the ring @xmath264 is finite ( as a module ) over @xmath265 $ ] where @xmath266 is the ring of witt vectors over @xmath36  ( * ? ? ?",
    "since the point @xmath25 gives rise to a section of the structural morphism : @xmath267 we have @xmath264 is isomorphic to @xmath268 $ ] .",
    "if @xmath233 and @xmath36 have equal characteristic , we have @xmath264 is isomorphic to @xmath269 $ ] , and @xmath91 is isomorphic to @xmath270 $ ] .",
    "again , the point @xmath25 makes sure that the image of @xmath213 in @xmath264 lies in @xmath271 where @xmath272 is the maximal ideal of @xmath264 .",
    "thus the structural morphism makes @xmath264 a power series in @xmath261 variables with coefficients in @xmath91 .",
    "every point @xmath273 in @xmath274 is equivalent to an @xmath91-morphism : @xmath275 which is in turn equivalent to specifying an @xmath91-algebra homomorphism : @xmath276 thus , for a fixed isomorphism @xmath277 $ ] , we have that giving @xmath278 is equivalent to giving an element : @xmath279    [ lem : reduced_completion ] retain the notation from lemma  [ lem : complete_local ] .",
    "assume that @xmath235 is a closed subscheme of @xmath234 such that @xmath280 ; write @xmath281 for the ideal sheaf of @xmath235 .",
    "after fixing an isomorphism @xmath277 $ ] ( which exists by lemma  [ lem : complete_local ] ) , we may view @xmath282 as an ideal of @xmath268 $ ] .",
    "then the homeomorphism @xmath283 in   maps @xmath284 onto @xmath285 furthermore , the @xmath286-adic completion @xmath287 is reduced if @xmath235 is reduced at @xmath239 .",
    "the first assertion is immediate .",
    "the fact that @xmath288 is a well - known property : taking completion preserves exact sequences of finitely generated modules over a noetherian ring ( see , for example  @xcite ) .",
    "since the local ring @xmath289 is reduced and excellent , its completion is reduced ( * ? ? ?",
    "[ lem : f_i ] retain the notation from lemma  [ lem : complete_local ] and fix an isomorphism @xmath277 $ ] .",
    "assume that @xmath15 is an endomorphism of @xmath234 such that @xmath290 .",
    "then there are power series @xmath291 in @xmath268 $ ] such that @xmath292 fits into the following commutative diagram : @xmath293^{\\varphi } \\ar[d]^{h_{\\tau } } &                      c(p,1)\\ar[d]^{h_{\\tau}}\\\\                      { { \\mathfrak m}}^g\\ar[r]^{f } &                      { { \\mathfrak m}}^g                  } \\ ] ]          although the lemma is stated for a particular ring @xmath300 , it will be clear from the proof that we require only that @xmath300 is a noetherian equidimensional catenary ring ( see  @xcite for the definition ) .",
    "let @xmath303 be the minimal primes containing @xmath299 ; then @xmath304 .",
    "let @xmath305 . we will prove that for any integer @xmath306 , @xmath15 fixes the set @xmath307 the proof uses backwards induction on @xmath308 . from this statement ,",
    "the lemma follows immediately .    since , for each @xmath309 @xmath310 there exists some @xmath311 ( depending on @xmath312 ) such that @xmath313 .",
    "let @xmath25 be an arbitrary prime in @xmath314 .",
    "then there is some @xmath315 such that @xmath316 .",
    "we have : @xmath317 since @xmath318 is the maximal dimension , we must have equality and so @xmath319 .",
    "then a counting argument shows that @xmath15 fixes @xmath320 .",
    "now fix @xmath321 and assume that @xmath15 fixes @xmath322 for all @xmath323 .",
    "let @xmath25 be an arbitrary prime in @xmath324 , and let @xmath325 be such that @xmath316 .",
    "if @xmath326 is strictly greater that @xmath327 , then , by the induction hypothesis , @xmath328 for some @xmath312 . since @xmath329 and @xmath25 are two distinct minimal primes containing @xmath299 and @xmath330 , this yields a contradiction . thus , we have @xmath331 and so @xmath332 .",
    "again , a counting argument shows that @xmath15 fixes @xmath324 , as desired .",
    "assume that @xmath333 .",
    "we first perform a few reductions . by assumption ,",
    "@xmath334 for some positive integer @xmath139 ; after replacing the data @xmath335 with @xmath336 for each @xmath337 , we may assume that @xmath338 .",
    "we have also assumed that @xmath25 is @xmath15-preperiodic modulo @xmath232 , i.e. , that @xmath339 . since @xmath333 , the @xmath232-adic closure of @xmath9 intersects @xmath235 if and only if @xmath232-adic closure of @xmath340 intersects @xmath235 .",
    "therefore , by replacing @xmath25 with @xmath341 , we may assume that @xmath239 is @xmath15-periodic of period @xmath342 .",
    "for each @xmath343 , by replacing the data @xmath335 with the data @xmath344 , we may assume that @xmath15 fixes @xmath239 .",
    "by lemma  [ lem : complete_local ] , we may identify @xmath264 and @xmath345 with @xmath268 $ ] and @xmath346 , respectively . by lemma  [ lem : f_i ] , there exist power series @xmath292 such that @xmath15 acts by @xmath347 in the chart @xmath346 .    if @xmath348 , then @xmath349 contains the @xmath232-adic closure of @xmath9 and is disjoint from @xmath242 , so we are done .",
    "now suppose that @xmath350 .",
    "as in lemma  [ lem : reduced_completion ] , let @xmath281 denote the ideal sheaf of @xmath235 .",
    "let @xmath351 denote a choice of generators of the ideal @xmath282 of @xmath268 $ ] . because @xmath352 , we have @xmath353 where @xmath354 is the induced map on the stalk at @xmath239 . therefore @xmath355 . by lemma",
    "[ lem : reduced_completion ] , @xmath282 is a radical ideal of @xmath264 , and , since @xmath15 is tale , @xmath356 is a ring isomorphism .",
    "thus , we may apply lemma  [ lem : map_i_to_i ] to conclude that @xmath357 .",
    "therefore , there exist power series @xmath358 $ ] , where @xmath359 , such that @xmath360    for a vector @xmath361 in @xmath362 , define : @xmath363 and for @xmath364 , write @xmath365 . by  , we now have : @xmath366 thus , the closure of @xmath367 is contained in @xmath368 since @xmath369 and @xmath370 vanishes on @xmath242 , this completes the proof .    if @xmath352 , then we can prove a stronger statement than  , namely : @xmath371 the proof proceeds in the same way as the proof of  .",
    "more explicitly , we may write each @xmath372 as a linear combination of the @xmath373 s and obtain @xmath374 .    morally speaking",
    ", if we consider @xmath375 as the `` distance '' from @xmath25 to @xmath235 then equality   means that when @xmath25 comes close to @xmath235 ( i.e. @xmath350 ) and @xmath15 fixes @xmath25 modulo @xmath232 , then all elements in @xmath9 are equidistant to @xmath235 .",
    "thus @xmath25 becomes a `` satellite '' of @xmath235 by moving around @xmath235 under @xmath15 .",
    "[ unif ] retain the notation from theorem  [ thm : adic_closure ] .",
    "assume that @xmath233 is a finite extension of @xmath376 and that @xmath15 fixes @xmath25 modulo @xmath232 .",
    "using lemma  [ lem : complete_local ] , identify @xmath264 with @xmath268 $ ] , and @xmath378 with @xmath346 .",
    "the orbit @xmath9 has a if there exist power series @xmath379 in @xmath380 $ ] , convergent on @xmath381 such that :        as above , we reduce to the case that @xmath338 ( i.e. @xmath235 is invariant ) and assume that @xmath350 . by ( * ? ? ?",
    "* theorem 3.3 ) or ( * ? ? ?",
    "* theorem 7 ) , there is a uniformization of @xmath384 ( possibly after replacing @xmath15 by an iterate ) .",
    "let @xmath385 be such a uniformization . by definition [ unif ] , the @xmath232-adic closure of @xmath9 is contained in @xmath386 .",
    "if there is some @xmath387 such that @xmath388 , then @xmath389 for every natural number @xmath29 .",
    "let @xmath390 be any of the equations defining @xmath235 in @xmath234 .",
    "then we have @xmath391 for every natural number @xmath29 .",
    "since a nonzero @xmath17-adic analytic function on @xmath381 can have only finitely many zeros , the analytic function @xmath392 must be identically zero on @xmath381 .",
    "therefore @xmath393 and so the whole orbit of @xmath25 is contained in @xmath242 , contradicting our assumption that @xmath394 .      * the proof of theorem  [ thm : adic_closure ] that does not require on uniformization can be translated into a simple and effective algorithm , hence is suitable for computational purposes .",
    "* lemma  [ lem : map_i_to_i ] and results of the same type may be of independent interest .",
    "indeed , results of a similar spirit are studied in a recent preprint of bell and lagarias  @xcite . *",
    "our proof requires no assumption on the characteristic of @xmath233 , whereas uniformization of orbits does not hold if @xmath395 ( for example , it is impossible to have an `` exponential function '' since dividing by @xmath396 is prohibited ) .",
    "[ lem : has_model ] assume that @xmath15 is tale and that @xmath397 .",
    "fix a point @xmath2 , then there exists a finite set @xmath398 containing all the archimedean places such that @xmath399 and @xmath25 extend to models @xmath400 and @xmath401 , respectively , over @xmath402 with the following properties :      we first find models for @xmath33 , @xmath7 , @xmath15 and @xmath25 over , say , some @xmath200 . as the locus in @xmath405",
    "over which @xmath234 is not smooth , @xmath235 is not flat , or @xmath406 is not tale is closed , by enlarging @xmath55 , we may assume that this locus is empty . since @xmath235 is flat over @xmath200 and its generic fiber",
    "is reduced , @xmath235 is itself reduced .",
    "it remains to ensure that @xmath407 . by enlarging @xmath55 again",
    ", we may assume that every irreducible component of @xmath235 contains some point in the generic fiber .",
    "then since @xmath397 and @xmath7 is dense in @xmath235 , we have @xmath408 .",
    "fix @xmath398 as in lemma  [ lem : has_model ] . for @xmath409 ,",
    "let @xmath410 be the valuation ring of @xmath45 in @xmath1 .",
    "by lemma  [ lem : has_model ] , there exist models @xmath234 and @xmath235 of @xmath33 and @xmath7 , respectively , over @xmath411 .",
    "we take the formally smooth base change from @xmath411 to @xmath203 , and abuse notation by ( still ) using @xmath235 and @xmath234 to denote the resulting models over @xmath412 .",
    "now we apply theorem  [ thm : adic_closure ] to show that @xmath413 does not intersect the closure of @xmath9 in @xmath414 .",
    "since @xmath414 is closed in @xmath415 , @xmath416 does not intersect the closure of @xmath9 in @xmath417 .",
    "this completes the proof in the case when @xmath33 is smooth .",
    "let @xmath418 be such that @xmath419 .",
    "as in the proof of theorem  [ thm : adic_closure ] , by replacing the data @xmath335 with the data @xmath420 for @xmath421 , we may assume that @xmath338 .",
    "we prove the theorem by noetherian induction .",
    "if @xmath422 , there is nothing to prove .",
    "assume that @xmath423 ; let @xmath424 be the smooth locus of @xmath33 , and let @xmath425 with the reduced closed subscheme structure . since @xmath15 is tale , @xmath15 preserves both @xmath424 and @xmath426 .",
    "if @xmath427 then we use the induction hypothesis on @xmath426 .",
    "now suppose that @xmath428 .",
    "write @xmath429 . by lemma  [ lem : has_model ]",
    ", there exists a finite set of places @xmath55 such that @xmath33 and @xmath7 , respectively , have flat ( hence reduced ) models @xmath234 and @xmath235 over @xmath200 .",
    "in addition , @xmath15 and @xmath25 both extend to @xmath200 ( by an abuse of notation , we denote these extensions by @xmath15 and @xmath25 , respectively ) , and @xmath352 .",
    "since @xmath15 is tale at @xmath25 generically , by enlarging @xmath55 , we may assume that @xmath15 is tale at every point in @xmath25 .",
    "let @xmath430 denote the open subscheme of @xmath234 consisting of smooth points over @xmath200 , and let @xmath431 be a model of @xmath432 over @xmath200 .",
    "now let @xmath45 be a place outside @xmath55 and pull back all models to @xmath203 . by theorem  [ thm : adic_closure ] , @xmath433 does not intersect the @xmath45-adic closure of @xmath9 in @xmath434 . since , by lemma  [ lem : topology ] , @xmath435 is quasi - compact and @xmath417 is hausdorff , the set @xmath434 is closed in @xmath417 . therefore @xmath436 does not intersect the @xmath45-adic closure of @xmath9 in @xmath417 .",
    "this completes the proof .",
    "we proceed by induction on the dimension of @xmath7 .",
    "the case @xmath437 is easy , as follows .",
    "let @xmath438 be the union of all iterates of @xmath7 .",
    "if @xmath377 intersects @xmath438 then @xmath25 is preperiodic and there is nothing to prove . otherwise , we apply theorem [ thm : dynamicalhasse ] for @xmath438 instead of @xmath7 . to carry out the induction step , we need the following lemma which might be of independent interest .    [",
    "lem : ycapy_1 ] let @xmath33 and @xmath15 be as in theorem [ thm : new_global ] .",
    "let @xmath207 be an irreducible @xmath15-preperiodic subvariety of @xmath33 .",
    "let @xmath439 be a periodic iterate of @xmath207 .",
    "then every irreducible component of @xmath440 is preperiodic .    replacing @xmath15 by an iterate , we reduce to the case @xmath441 .",
    "let @xmath442 and @xmath443 denote the normalizations of @xmath439 and @xmath444 , respectively .",
    "for every integer @xmath445 , define : @xmath446 where @xmath447 is counted with multiplicity . by the semicontinuity theorem ,",
    "@xmath448 is closed in @xmath439 .",
    "now let @xmath449 be an irreducible component of @xmath440 having dimensional @xmath306 and generic point @xmath450 .",
    "let @xmath451 , the main observation is that @xmath452 is an irreducible component of @xmath453 .",
    "assume otherwise and let @xmath454 be an irreducible component of @xmath453 strictly containing @xmath452 .",
    "let @xmath455 denote the generic point of @xmath454 .",
    "since @xmath456 , we have @xmath457 . on the other hand , by semicontinuity @xmath458 .",
    "hence we must have @xmath459 .    by faithful flatness",
    ", the map @xmath460 induced by @xmath15 is surjective @xcite .",
    "therefore , there exists @xmath461 in @xmath462 such that @xmath463 and the zariski closure @xmath231 of @xmath461 contains @xmath449 . from the last paragraph and the fact that taking normalization commutes with tale base changes , we have : @xmath464    by comparing dimensions",
    ", we see that @xmath7 and @xmath465 are two irreducible components of @xmath462 containing @xmath450 .",
    "since @xmath454 strictly contains @xmath452 , we have that @xmath231 strictly contains @xmath449 .",
    "note that it is impossible for both @xmath7 and @xmath465 to contain @xmath231 since @xmath449 is an irreducible component of @xmath466 .",
    "therefore the set of irreducible components of @xmath462 containing @xmath461 is strictly smaller than the set of irreducible components of @xmath467 containing @xmath450 .",
    "together with the semicontinuity theorem , we have @xmath468 contradicting ( [ eq : wsc ] ) .",
    "now let @xmath469 denote the union of all @xmath306-dimensional irreducible components of all the @xmath448 s for @xmath445 .",
    "this is a finite union since @xmath470 for all sufficiently large @xmath29 thanks to finiteness of @xmath471 .",
    "we have proved that @xmath452 is an irreducible component of @xmath469 . for each @xmath472 , repeat the same arguments for @xmath43 instead of @xmath15 , we have that @xmath473 is an irreducible component of @xmath469 .",
    "this proves that @xmath449 is preperiodic .",
    "now assume that @xmath480 for some @xmath481 .",
    "for every @xmath45 , we have @xmath482 and @xmath483 if @xmath484 , then the above identities together with @xmath485 imply : @xmath486 this can only happen for finitely many @xmath45 s by applying the induction hypothesis for @xmath466 , whose irreducible components are preperiodic by lemma [ lem : ycapy_1 ] .",
    "[ subsec : closing ] it is natural to ask whether the assumption in theorem  [ thm : dynamicalhasse ] that @xmath7 is preperiodic is necessary .",
    "we show that if @xmath1 is a number field and @xmath487 is a single @xmath1-point , then @xmath488 fails the strong hasse principle if and only if @xmath489 is not periodic but has , i.e. for all but finitely many primes @xmath490 , the reduction of @xmath489 modulo @xmath490 is periodic .      *",
    "let @xmath490 be a prime such that we have models over @xmath493 .",
    "if the reduction of @xmath489 modulo @xmath490 is periodic then the @xmath490-adic closure of the orbit of @xmath494 contains @xmath489 .",
    "consequently , if @xmath489 is not periodic but has almost everywhere periodic reduction then @xmath488 does not satisfy the strong hasse principle . *",
    "conversely , if @xmath489 is either periodic or does not have almost everywhere periodic reduction , then @xmath495 satisfies the strong dynamical hasse principle .",
    "\\(a ) the first assertion follows immediately from the @xmath490-adic uniformization of the @xmath496-orbit of @xmath489 ( for some @xmath497 depending on @xmath490 ) and the fact that for every analytic function @xmath498 from @xmath499 to @xmath500 , the point @xmath501 lies in the closure of @xmath502 . such uniformization exists by ( * ? ? ?",
    "* theorem 3.3 ) , or more precisely by its generalization in ( * ? ? ?",
    "* theorem 7 ) . for the second assertion ,",
    "note that the orbit of @xmath503 does not contain @xmath489 but the @xmath490-adic closure of this orbit contains @xmath489 for almost all @xmath490 .",
    "\\(b ) the case that @xmath489 is periodic follows from theorem [ thm : dynamicalhasse ] .",
    "hence we assume that @xmath489 is non - periodic .",
    "let @xmath2 such that @xmath504 .",
    "for every @xmath490 such that @xmath33 , @xmath15 , @xmath25 and @xmath489 have models over @xmath493 , if @xmath505 then @xmath489 and @xmath506 have the same reduction modulo @xmath490 for @xmath14 as large as we like .",
    "this implies that @xmath489 is periodic modulo @xmath490 .",
    "but there are infinitely many primes such that this conclusion does not hold thanks to our assumption on @xmath489 , hence @xmath495 satisfies the strong dynamical hasse principle .",
    "some results in the literature suggest that the examples of non - periodic points with almost everywhere periodic reduction must be very special , and so the strong dynamical hasse principle mostly holds when the endomorphism is tale and the subvariety is a single point . for instance , by a result of pink  ( * ? ? ?",
    "* corollary 4.3 ) , such points can not exist for the multiplication - by-@xmath306 map on an abelian variety .",
    "furthermore , by  ( * ? ? ?",
    "* corollary 1.2 ) , such points also can not exist for a self - map of @xmath507 of degree at least two ( though such a map is not tale , and thus [ prop : periodic - reduction ] does not apply directly ) .",
    "on the other hand , the translation - by - one map on @xmath507 is an obvious example where non - periodic points become periodic modulo almost all primes , so that the strong dynamical hasse principle fails ; more generally , an automorphism of @xmath508 of infinite order , given by an integer - valued matrix , has the same property . as it was pointed out to us by serge cantat , one can use this to construct other , though somewhat artificial , examples : take an automorphism @xmath15 of a smooth variety @xmath33 with a fixed point @xmath122 , inducing an infinite - order automorphism on the tangent space at @xmath122 .",
    "then @xmath15 lifts to the blow - up of @xmath33 at @xmath122 , inducing an automorphism of the exceptional divisor , and points of that exceptional divisor are periodic modulo almost all primes .",
    "it seems reasonable to conjecture that non - periodic points with almost everywhere periodic reduction do not exist for polarized morphisms @xmath15 ( that is , morphisms such that @xmath509 for some integer @xmath510 and some ample line bundle @xmath511 ) , so that the strong dynamical hasse principle holds for number fields @xmath1 , tale polarized morphisms @xmath15 and @xmath512 .",
    "notice however that tale polarized endomorphisms are extremely rare , cf .",
    "@xcite .",
    "[ prop : bm_curve ] let @xmath33 be a smooth geometrically integral projective curve of genus @xmath261 over a number field @xmath1 , let @xmath15 be a nonconstant self - map of @xmath33 over @xmath1 , and @xmath7 a finite subset of @xmath513 .",
    "we make the following additional assumptions .    *",
    "if @xmath514 , assume that @xmath15 is not conjugate to @xmath515 , * if @xmath516 , assume that @xmath15 has a preperiodic point in @xmath517 .",
    "( if we regard @xmath33 as an elliptic curve , this condition is equivalent to the condition that @xmath15 is not a translate by a non - torsion point . )",
    "when @xmath33 is an abelian variety , @xmath7 is an arbitrary subvariety and @xmath15 is a @xmath1-endomorphism of @xmath33 such that @xmath522 $ ] is an integral domain , hsia and silverman show the equality : @xmath523 under certain strong conditions .",
    "we refer the readers to ( * ? ? ?",
    "* theorem 11 ) for more details .",
    "our proof of proposition [ prop : bm_curve ] gives an unconditional proof of their result when @xmath33 is an elliptic curve .",
    "the case @xmath524 is trivial since all endomorphisms of curves of genus at least two are of finite order . if @xmath525 , this follows from  @xcite as mentioned above ( see remark 9 from @xcite if @xmath526 ) .",
    "now consider the case when @xmath527 .",
    "if @xmath25 is @xmath15-preperiodic then there is nothing to prove , so we assume that @xmath25 is wandering",
    ". there exists a non - negative integer @xmath342 such that @xmath528 for all @xmath529 . after replacing @xmath25 by @xmath530",
    ", we may assume the @xmath15-orbit of @xmath25 does not intersect @xmath531 .",
    "it remains to show that @xmath532 . by assumption ( b ) , there is some @xmath418 such that @xmath533 has a fixed point . by replacing the data @xmath534 with @xmath336 for @xmath337",
    ", we may assume that @xmath15 has a fixed point .",
    "note that if we can prove @xmath535 for @xmath536 a finite extension of @xmath1 , and @xmath537 the set of places of @xmath536 lying above places in @xmath55 , then this implies that @xmath532 .",
    "thus , we may assume that there is a fixed point @xmath538 .",
    "using @xmath539 as the point at infinity we have the following weierstrass equation for @xmath33 : @xmath540    let @xmath541 be the latts map associated to @xmath15 . since @xmath539 is fixed by @xmath15 , we have @xmath542 .",
    "let @xmath543 be a finite set of places such that @xmath544}}$ ] and such that the leading coefficients of @xmath438 and @xmath7 are in @xmath545 .",
    "then @xmath546 assume that @xmath547 and let @xmath548 be an element of the intersection .",
    "note that since @xmath7 is a finite set of points , @xmath549 and so @xmath550 for every @xmath551 . by theorem [ thm : new_global ] , for almost all @xmath490",
    ", the @xmath490-adic closure of @xmath9 does not contain @xmath539 .",
    "therefore @xmath552 for almost all @xmath490 .",
    "for such @xmath490 , we can write @xmath553 with affine coordinates @xmath554 .",
    "we now enlarge @xmath543 so that :       since @xmath561 , properties ( i ) , ( iii ) and   imply that @xmath562 for every @xmath29 , and every @xmath563 . by property",
    "( iv ) and the weierstrass equation for @xmath33 , we have @xmath564 for every @xmath29 , and every @xmath563 . therefore @xmath100 has @xmath558-integral affine coordinates for every @xmath29 .",
    "this contradicts siegel s theorem asserting finiteness of integral points ."
  ],
  "abstract_text": [
    "<S> let @xmath0 be a morphism of a variety over a number field @xmath1 . </S>",
    "<S> we consider local conditions and a `` brauer - manin '' condition , defined by hsia and silverman , for the orbit of a point @xmath2 to be disjoint from a subvariety @xmath3 , i.e. , for @xmath4 we provide evidence that the dynamical brauer - manin condition is sufficient to explain the lack of points in the intersection @xmath5 ; this evidence stems from a probabilistic argument as well as unconditional results in the case of tale maps . </S>"
  ]
}