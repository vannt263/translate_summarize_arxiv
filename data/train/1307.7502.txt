{
  "article_text": [
    "predicting human mobility patterns is not only a fundamental problem in geography and spatial economics  @xcite ; it also has many practical applications in urban planning  @xcite , traffic engineering  @xcite , infectious disease epidemiology  @xcite , emergency management  @xcite and location - based service  @xcite . since the 1940s ,",
    "many trip distribution models  @xcite have been presented to address this challenging problem , among which the gravity model is the prevailing framework  @xcite . despite its wide use in predicting mobility patterns at different spatial scales  @xcite ,",
    "the gravity model relies on specific parameters fitted from systematic collections of traffic data .",
    "if previous mobility measurements are lacking , the gravity model is not applicable .",
    "a similar limitation exists in all trip distribution models that rely on context - specific parameters , such as the intervening opportunity model  @xcite , the random utility model  @xcite and others .",
    "quite recently , the introduction of the radiation model  @xcite has provided a new insight into the long history of modelling population movement .",
    "the model is based on a solid theoretical foundation and can precisely reproduce observed mobility patterns ranging from long - term migrations to inter - county commutes . surprisingly , the model needs only the spatial distribution of population as an input , without any adjustable parameters .",
    "nevertheless , some evidence has demonstrated that the radiation model may be not applicable to predicting human mobility at the city scale  @xcite .",
    "understanding mobility patterns in cities is of paramount importance in the sense that cities are the foci of disease propagation , traffic congestion and pollution  @xcite , partly resulting from human movement .",
    "these problems can be resolved through developing more efficient transportation systems and optimising traffic management strategies , all of which depend on our ability to predict human travel patterns in cities  @xcite . despite the success of the radiation model in countries",
    ", we continue to lack an explicit and comprehensive understanding of the underlying mechanism accounting for the observed mobility patterns in cities .",
    "we argue that this is mainly ascribed to the relatively high mobility of residents in cities compared to larger scales , such as travelling among counties . inside cities , especially metropolises , high development of traffic systems allow residents to travel relatively long distance to locations with more opportunities and attraction . in this sense ,",
    "the models that are quite successful in reproducing mobile patterns at large spatial scales fail at the city scale . yet",
    ", revealing the underlying driving force and restrictions for such mobility to predict mobile patterns in cities remains an outstanding problem .        in this paper",
    ", we develop a population - weighted opportunities model without any adjustable parameters as an alternative to the radiation model to predict human mobility patterns in a variety of cities .",
    "insofar as the distribution of population in different cities are available , our model offers universal prediction of human mobility patterns in several cities as quantified by some key measurements , including distance distribution , destination travel constraints and flux .",
    "in contrast , the models that succeed in predicting mobility patterns at large spatial scales , such as countries , are inappropriate at the city scale because of the underestimation of human mobility .",
    "our approach suggests the diversity of human mobility at different spatial scales , deepening our understanding of human mobility behaviours .",
    "the model is derived from a stochastic decision making process of individual s destination selection .",
    "before an individual selects a destination , s / he will weigh the benefit of each location s opportunities .",
    "the more opportunities a location has , the higher the benefit it offers and the higher the chance of it being chosen .",
    "although the number of a location s opportunities is difficult to straightforwardly measure , it can be reflected by its population .",
    "insofar as the population distribution is available , it is reasonable to assume that the number of opportunities at a location is proportional to its population , analogous to the assumption of the radiation model  @xcite .",
    "in contrast to the radiation model s assumption that individuals tend to select the nearest locations with relatively larger benefits , we enlarge the possible chosen area of individuals to include the whole city regarding the relatively high mobility at the city scale .",
    "as shown in figure  [ fig - diff ] , our assumption leads to much better prediction than that of the radiation model .",
    "nevertheless , the possibility of travel in the observed data still decays as the distance between origin and destination increases . such decay , as predicted by different models and common in real observations , results from the reduction of attraction associated with a type of cost .",
    "for example , the gravity model  @xcite assumes that the attraction of a destination , i.e. , its opportunities , is reduced according to a function of the distance from the origin .",
    "however , the distance function inevitably includes at least one parameter . to capture the mobility behaviours and avoid adjustable parameters",
    ", we simply assume that the attraction of a destination is inversely proportional to the population @xmath0 in the circle centred at the destination with radius @xmath1 ( the distance between the origin @xmath2 and destination @xmath3 , as illustrated in the inset of figure  [ fig - diff ] ) , minus a finite - size correction @xmath4 , _ i.e. _ ,     travel distance distributions @xmath5 produced by the radiation model and the pwo model in comparison with empirical data .",
    "four cities , ( _ a _ ) beijing , ( _ b _ ) shenzhen , ( _ c _ ) abidjan and ( _ d _ ) chicago , are studied . here",
    ", @xmath5 is defined as the probability of travel between locations at distance @xmath6.,width=340 ]     comparing the destination travel constraints of the radiation and the pwo models with real data .",
    "four cities are explored as representative cases : ( _ a _ ) beijing , ( _ b _ ) shenzhen , ( _ c _ ) abidjan and ( _ d _ ) chicago .",
    "@xmath7 is the probability of travel towards a location with population @xmath8.,width=340 ]        @xmath9    where @xmath10 is the relative attraction of destination @xmath3 to travellers at origin @xmath2 , @xmath11 is the total opportunities of destination @xmath3 and @xmath12 is the total population in the city .",
    "further , assuming that the probability of travel from @xmath2 to @xmath3 is proportional to the attraction of @xmath3 and recalling the assumption that the number of opportunities @xmath11 is proportional to the population @xmath13 , we have the travel from @xmath2 to @xmath3 as @xmath14 where @xmath15 is the trips departing from @xmath2 and @xmath16 is the number of locations in the city .",
    "the presented model reflects the effect of competition for opportunities among potential destinations : for a traveller at origin @xmath2 travelling to a potential destination @xmath3 , more population between @xmath2 and @xmath3 will induce stronger competition for limited opportunities , so that the probability of being offered opportunities will be lower . in this regard ,",
    "it is reasonable to assume that the attraction of a destination for a traveller is the destination s opportunities inversely weighted by population between the destination and the origin .",
    "we therefore name our model the _ population - weighted opportunities model _",
    "( pwo ) . we will then demonstrate the universal predictability of mobility patterns in cities via the pwo model through a variety of real travel data in several cities .      to validate the pwo model by comparison with the performance of the radiation model(see details in * materials and methods , the radiation model * ) ,",
    "we employ human daily travel data from four cities collected by gps , mobile phone and traditional household surveys ( see details in * materials and methods , data sets and data preprocessing * ) .",
    "figure  [ fig - diff ] exemplifies travel from a downtown and a suburban location in beijing predicted in an intuitive manner by the pwo model and the radiation model in comparison with real data .",
    "it shows that the radiation model underestimates the travel areas in both cases , whereas the travel patterns resulting from our model are quite consistent with empirical evidence , demonstrating the relatively higher mobility in cities than at larger spatial scales where the radiation model succeeds , such as countries .",
    "we systematically investigate the travel distance distribution obtained by both models based on real data .",
    "travel distance distribution is an important statistical property to capture human mobility behaviours  @xcite and reflect a city s economic efficiency  @xcite .",
    "we find that , as shown in figure  [ fig - tdd ] , the distributions of travel distance predicted by the pwo model are in good agreement with the real distributions . in contrast",
    ", the radiation model underestimates long - distance ( longer than approximately 2 km ) travel in all cases .",
    "this implies that the assumption of the radiation model is inappropriate at the city scale by precluding individuals from choosing relatively long travels to find better locations with more opportunities .",
    "the success of the pwo model in predicting real travel distance distributions in cities provides strong evidence for the validity of its basic assumptions .",
    "we next explore the probability of travel towards a location with population @xmath8 , say , @xmath7 , for both observed data and the predictive models .",
    "@xmath7 is a key quantity for measuring the accuracy of origin - constrained mobility models ( the radiation model and pwo model used here are both origin - constrained ) , because origin - constrained models can not ensure the agreement between modelled travel to a location and real travel to the same location  @xcite . in figure  [ fig - des ]",
    ", we can see that our model equally or better predicts empirical observations compared to the radiation model .    a more detailed measure of a model s ability to predict mobility patterns",
    "can be implemented in terms of the travel fluxes between all pairs of locations produced by a model in comparison with real observations , as has been used in ref .",
    "as shown in figure  [ fig - box ] , we find that  excepting the case of abidjan  the average fluxes predicted by the radiation model deviate from the real fluxes , whereas the results from the pwo model are in reasonable agreement with real observations .",
    "note that the boxplot method used here can not allow an explicit comparison to distinguish the performance of the two models .",
    "for example , in figure  [ fig - box](e ) , although the results deviate from the empirical data significantly , the boxes are still coloured green , suggesting the need of an alternative statistical method .",
    "thus we exploit the srensen similarity index  @xcite ( see details in * materials and methods , srensen similarity index * ) to quantify the degree of similarity with real observations to offer a better comparison .",
    "we have also applied both models to six european cities and another four u. s. cities to make a more comprehensive comparison ( details are available in the * supplementary material , section s1 * and * s2 * ) .",
    "the results are shown in figure  [ fig - ssi ] .",
    "for all studied cases , our model outperforms the radiation model and exhibits relatively high index values , say , approximately 0.7 , indicating that the pwo model captures the underlying mechanism that drives human movement in cities .",
    "we developed a population - weighted opportunities model as an alternative to the radiation model to reproduce and predict mobile behaviours in cities with different sizes , economic levels and cultural backgrounds .",
    "our model needs only the spatial distribution of population as an input , without any adjustable parameters .",
    "the mobility patterns resulting from the model are in good agreement with real data with respect to travel distance distribution , destination travel constraints and flux , suggesting that the model captures the fundamental mechanisms governing human daily travel behaviours at city scale .    the radiation model , despite having the advantage of being parameter - free and performing well at large spatial scale , can not offer satisfactory predictions of mobility patterns at the city scale .",
    "the problem lies in the underestimation of the relatively high mobility at the city scale .",
    "in particular , the radiation model assumes that limited mobility prevents people from selecting a farther location with more opportunities to gain more benefits than a nearby location .",
    "this assumption is reasonable at the inter - city scale , but inappropriate in cities .",
    "the pwo model can successfully overcome this problem by assuming the attraction of a potential destination is inversely proportional to its population , which results from competition for opportunities in the whole city .",
    "insofar as only population distribution is available , our model presently offers the best prediction of mobility patterns at the city scale , significantly deepening our understanding of human mobility in cities and demonstrating the universal predictability of mobility patterns at the city scale .",
    "comparison between the prediction ability of the pwo and the radiation model in terms of srensen similarity index ( ssi ) .",
    "ssi is calculated from eq .",
    "( [ eqssi ] ) .",
    "14 cities around the world are studied .",
    ", width=340 ]    we have also compared the pwo model with three classical parameterised models : the gravity model  @xcite , the intervening opportunity model  @xcite and the rank - based model  @xcite ( see details in the * supplementary material , section s3 * ) . although in rare cases the parameterised models can yield better predictive accuracy than the pwo model , their parameter - dependence nature limits their scope to the cases with particular previous systematic mobility measurements and relatively stable mobility patterns .",
    "the pwo model , without such limitations , has much more predictive power . by exploring the relationship between all the previous models and our pwo model ( see details in the * supplementary material , section s4 * ) , we find that although these models have different hypotheses , they share an underlying mechanism : the probability that an individual selects a location to travel is decreased along with the increment of some prohibitive factors ( distance or population ) .",
    "the key difference lies in that the gravity model , the intervening opportunity model and the rank - based model need adjustable parameters to quantify the decrement , whereas the decrement is naturally determined by population distribution in the radiation model and the pwo model .",
    "it is noteworthy that despite the advantages of the pwo model in predicting mobility patterns at the city scale , the predictability could be improved further .",
    "the travel matrices established by the model share approximately 70% common part with the real data ( see figure  [ fig - ssi ] ) . although such accuracy can suffice for the requirements in many areas of applications , _",
    "e.g. _ , in urban planning and epidemic modelling  @xcite , it is still below the average upper limit of the predictability of human mobility  @xcite . in principle",
    ", the pwo model is essentially a type of aggregate travel model  @xcite based on the collective behaviours of groups of similar travellers , whereas the diversity of real individuals behaviours  @xcite is in contrast to the assumptions of aggregate models , accounting for their inaccuracy in reproducing and predicting movement patterns .",
    "microscopic mobility models , such as agent - based models  @xcitemay offer better prediction of mobility patterns as an alternative but suffer from much higher computational complexity .",
    "therefore , an efficient macroscopic mobility model taking the diversity of individual behaviours into account would be worth pursuing in the future to further deepen our understanding of human mobility .",
    "\\(1 ) beijing taxi passengers .",
    "this data set is the travel records of taxi passengers in beijing in a week  @xcite .",
    "when a passenger gets on or gets off a taxi , the coordinates and time are recorded automatically by a gps - based device installed in the taxi . from the data set we extract 1,070,198 taxi passengers travel records .",
    "some evidence indicates that in beijing , the average travel distance of taxi passengers is similar to the commuting distance  @xcite and the spatial distribution of taxi passengers is similar to that of populations  @xcite .",
    "thus the taxi passengers data can capture the travel pattern of urban residents to some extent , although taxi passengers only constitute a small subset of the population in a city .",
    "zone partition and population density distribution in four cities .",
    "( _ a _ ) beijing with 3,025 zones , ( _ b _ ) shenzhen with 1,634 zones , ( _ c _ ) abidjan with 219 zones and ( _ d _ ) chicago with 1,406 zones .",
    "the density function @xmath17 represents the probability of finding travel starting from zone @xmath2 .",
    ", width=340 ]    \\(2 ) shenzhen taxi passengers .",
    "the shenzhen taxi passenger tracker data has the same data format as that of beijing .",
    "the data set records 2,338,576 trips by taxi passengers in 13,798 taxis in shenzhen from 18 apr .",
    "2011 to 26 apr . 2011 .",
    "\\(3 ) abidjan mobile phone users .",
    "the data set contains 607,167 mobile phone users movements between 381 cell phone antennas in abidjan , the biggest city of ivory coast , during a two - week observation period  @xcite .",
    "each movement record contains the coordinates ( longitude and latitude ) of the origin and destination .",
    "the data set is based on the anonymised call detail records ( cdr ) of phone calls and sms exchanges between five million of orange company s customers in ivory coast . to protect customers privacy",
    ", the customer identifications have been anonymised by orange company .",
    "\\(4 ) chicago travel tracker survey .",
    "chicago travel tracker survey was conducted by the chicago metropolitan agency for planning during 2007 and 2008 , which provides a detailed travel inventory for each member of 10,552 households in the greater chicago area .",
    "the survey data are available online at http://www.cmap.illinois.gov/travel-tracker-survey . because some participants provided one - day travel records but others provided two - days , to maintain consistency , we only extracted the first - day travel records from the data set .",
    "the extracted data include 87,041 trips , each of which includes coordinates of the trip s origin and destination .",
    "the raw travel data of four cities contain latitude and longitude coordinates of each traveller s origin and destination .",
    "the raw data can not be immediately used in mobility models .",
    "alternatively , we used coarse - grained travel data through partitioning a city into a number of zones , each of which corresponds to a location in the literature  @xcite .",
    "because of the absence of natural partitions in cities ( in contrast to states or counties ) , we simply partition all cities into equal - area square zones , each of which is of dimension 1 km @xmath18 1 km .",
    "figure  [ fig - map ] shows the zone partition results and the number of zones in four cities .",
    "we assign an origin ( or destination ) zone i d to each trip if its origin ( or destination ) falls into the range of that zone .",
    "then , we can accumulate the total number @xmath19 of trips departed from an arbitrary zone @xmath2 , and the total number @xmath20 of trips from zone @xmath2 to zone @xmath3 . in general ,",
    "the number of trips departed from a zone is proportional to the population of the zone  @xcite .",
    "the spatial distributions of population density estimated from travel data in the four cities are shown in figure  [ fig - map ] .",
    "the radiation model  @xcite is a parameter - free model to predict travel fluxes among different locations based on population distribution : @xmath21 where @xmath20 is the trips departing from location @xmath2 to location @xmath3 , @xmath15 is the total trips departing from location @xmath2 , @xmath22 is the population at location @xmath2 , @xmath23 is the population at location @xmath3 , @xmath24 is the total population in the circle of radius @xmath1 centred at location @xmath2 ( excluding the origin @xmath2 and destination @xmath3 ) .",
    "srensen similarity index is a statistic tool to identifying the similarity between two samples .",
    "it has been widely used for dealing with ecological community data  @xcite .",
    "@xcite used a modified version of the index to measure whether real fluxes are correctly reproduced ( on average ) by mobility prediction models , defined as @xmath25 where @xmath26 is the travels from location @xmath2 to @xmath3 predicted by models and @xmath20 is the observed number of trips .",
    "obviously , if each @xmath26 is equal to @xmath20 the index is 1 ; if all @xmath26s are far from the real values , the index is close to 0 .",
    "we acknowledge the organisers of the d4d challenge for permitting us to use the abidjan mobile phone data set .",
    "xyy thanks prof .",
    "ke xu and xiao liang for their enthusiastic sharing of beijing taxi gps data .",
    "this work was supported by nsfc grant @xmath27 and @xmath28 , doctoral fund of ministry of education ( 20110003110027 ) and partly supported by the opening foundation of institute of information economy , hangzhou normal university ( pd@xmath29 )",
    ".    10    barthlemy m. 2011 spatial networks .",
    "rep . _ * 499 * , 1 - 101 .",
    "batty m. 2008 the size , scale , and shape of cities",
    ". _ science _ * 319 * , 769 - 771 .",
    "ortzar jd , willumsen lg .",
    "2011 _ modelling transport .",
    "_ new york , usa : john wiley & sons .",
    "helbing d. 2001 traffic and related self - driven many - particle systems . _ rev .",
    "phys . _ * 73 * , 1067 - 1141 .",
    "hufnagel l , brockmann d , geisel t. 2004 forecast and control of epidemics in a globalized worlds .",
    "usa _ * 101 * , 15124 - 15129 .",
    "eubank s , guclu h , kumar va , marathe mv , srinivasan a , toroczkai z , wang n. 2004 modelling disease outbreaks in realistic urban social networks .",
    "_ nature _ * 429 * , 180 - 184 .",
    "balcan d , colizza v , gonalves b , hu h , ramasco jj , vespignani a. 2009 multiscale mobility networks and the large spreading of infectious diseases .",
    "usa _ * 106 * , 21484 - 21489 .",
    "bagrow jp , wang d , barabsi a - l .",
    "2011 collective response of human populations to large - scale emergencies .",
    "_ plos one _ * 6 * , e17680 .",
    "lu x , bengtsson l , holme p. 2012 predictability of population displacement after the 2010 haiti earthquake .",
    "usa _ * 109 * , 11576 - 11581 .",
    "rutherford a , cebrian m , dsouza s , moro e , pentland a , rahwan i. 2013 limits of social mobilization .",
    "usa _ * 110 * , 62816286 .",
    "scellato s , noulas a , mascolo c. 2011 exploiting place features in link prediction on location - based social networks .",
    "_ acm kdd11 _ 1046 - 1054 .",
    "stouffer sa .",
    "1940 intervening opportunities : a theory relating mobility and distance . _ am .",
    "rev . _ * 5 * , 845 - 867 .",
    "1946 the @xmath30 hypothesis : on the intercity movement of persons .",
    "rev . _ * 11 * , 677 - 686 .",
    "domencich t , mcfadden d. 1975 _ urban travel demand : a behavioural analysis .",
    "_ amsterdam , netherlands : north - holland .",
    "simini f , gonzlez mc , maritan a , barabsi a - l .",
    "2012 a universal model for mobility and migration patterns .",
    "_ nature _ * 484 * , 96 - 100 .",
    "simini f , maritan a , nda z. 2013 human mobility in a continuum approach . _",
    "plos one _ * 8 * , e60069 .",
    "noulas a , scellato s , lambiotte r , pontil m , mascolo c. 2012 a tale of many cities : universal patterns in human urban mobility . _",
    "plos one _ * 7 * , e37027 .",
    "lenormand m , huet s , gargiulo f , deffuant g. 2012 a universal model of commuting networks .",
    "_ plos one _ * 7 * , e45985 .",
    "jung ws , wang f , stanley he .",
    "2008 gravity model in the korean highway .",
    "_ europhys lett .",
    "_ * 81 * , 48005 .",
    "krings g , calabrese f , ratti c , blondel vd . 2009",
    "urban gravity : a model for inter - city telecommunication flows .",
    "mech . _ * 2009 * , l07003 .",
    "kaluza p , koelzsch a , gastner mt , blasius b. 2010 the complex network of global cargo ship movements .",
    "_ j. r. soc .",
    "interface _ * 7 * , 1093 - 1103 . goh s , lee k , park js , choi my . 2012",
    "modification of the gravity model and application to the metropolitan seoul subway system .",
    "e _ * 86 * , 026102 .",
    "masucci ap , serras j , johansson a , batty m. 2013 gravity versus radiation model : on the importance of scale and heterogeneity in commuting flows . _",
    "* 88 * , 022812 .",
    "liang x , zhao j , li d , xu k. 2013 unraveling the origin of exponential law in intra - urban human mobility . _",
    "rep . _ * 3 * , 2983 .",
    "bettencourt l , lobo j , helbing d , kuhnert c , west gb .",
    "2007 growth , innovation , scaling , and the pace of life in cities .",
    "usa _ * 104 * , 7301 - 7306 .",
    "song c , qu z , blumm n , barabsi a - l .",
    "2010 limits of predictability in human mobility .",
    "_ science _ * 327 * , 1018 - 1021 .",
    "brockmann d , hufnagel l , geisel t. 2006 the scaling laws of human travel .",
    "_ nature _ * 439 * , 462 - 465 .",
    "gonzlez mc , hidalgo ca , barabsi a - l .",
    "2008 understanding individual human mobility patterns .",
    "_ nature _ * 453 * , 779 - 782 .",
    "roth c , kang sm , batty m , barthlemy m. 2011 structure of urban movements : polycentric activity and entangled hierarchical flows .",
    "_ plos one _ * 6 * , e15923 .",
    "jambu m. 1991 _ exploratory and multivariate data analysis .",
    "_ new york , usa : academic press .",
    "srensen t. 1948 a method of establishing groups of equal amplitude in plant sociology based on similarity of species and its application to analyses of the vegetation on danish commons .",
    "skr . _ * 5 * 1 - 34 .",
    "truscott j , ferguson nm .",
    "2012 evaluating the adequacy of gravity models as a description of human mobility for epidemic modelling .",
    "_ plos comput .",
    "* 8 * , e1002699 .",
    "yan x - y , han x - p , wang b - h , zhou t. 2013 diversity of individual mobility patterns and emergence of aggregated scaling laws . _ sci . rep . _ * 3 * , 2678 .",
    "bagrow jp , lin y - r .",
    "2012 mesoscopic structure and social aspects of human mobility . _ plos one _ * 7 * , e37676 .",
    "song c , koren t , wang p , barabsi a - l .",
    "2010 modelling the scaling properties of human mobility .",
    "phys . _ * 6 * , 818 - 823 . han x - p , hao q , wang b - h , zhou t. 2011 origin of the scaling law in human mobility : hierarchy of traffic systems .",
    "e _ * 83 * , 036117 .",
    "hasan s , schneider cm , ukkusuri sv , gonzlez mc .",
    "2012 spatiotemporal patterns of urban human mobility .",
    "_ j. stat .",
    "phys . _ * 151 * , 304 - 318 .",
    "szell m , sinatra r , petri g , thurner s , latora v. 2012 understanding mobility in a social petri dish .",
    "* 2 * 457 .",
    "schneider cm , belik v , couronn t , smoreda z , gonzlez mc .",
    "2013 unravelling daily human mobility motifs .",
    "_ j. r. soc .",
    "interface _ * 10 * , 20130246 .",
    "liang x , zheng x , lv w , zhu t , xu k. 2012 the scaling of human mobility by taxis is exponential . _ physica a _ * 391 * , 2135 - 2144 .",
    "qin p , zheng x , wang l. 2014 travel mode choice and impact of fuel tax in beijing . _",
    "econ . _ * 19.01 * , 92 - 110 .",
    "yang z , yuan nj , xie x , lian d , rui y , zhou t. 2014 indigenization of urban mobility .",
    "_ arxiv:1405.7769 _    blondel vd , esch m , chan c , clerot f , deville p , huens e , ziemlicki c. 2012 data for development : the d4d challenge on mobile phone data .",
    "_ arxiv:1210.0137 _    biblabel[1][s#1 ]    cite[1][s#1 ]    * supplementary material *",
    "we use gowalla check - ins data set  @xcite ( downloaded from http://snap.stanford.edu/data/loc-gowalla.html ) to test the performance of our population - weighted opportunities ( pwo ) model in predicting the mobility patterns in european cities .",
    "gowalla is a location - based social networking website in which users share their locations through checking - in .",
    "the data set includes in total 6,442,890 check - ins of users over the period of feb .",
    "2009 - oct .",
    "for the data set we define a trip of a user s by his / her two consecutive check - ins at different locations .",
    "if a trip s origin and destination are both in same city , we classify the trip to inner - city trips .",
    "based on the data , we sort out inner - city trips in six european cities that have a sufficient number of gowalla users , including london ( uk ) , berlin ( german ) , prague ( czech ) , oslo ( norway ) , copenhagen ( denmark ) and goteborg ( sweden ) .",
    "table s1 shows the number of trips in each city .",
    "according to the methods presented in section * materials and methods , data preprocessing * in the main text , we partition each city into equal - area square zones , each of which is of 1 @xmath31 .",
    "figure  [ fig - map - e ] shows the zone partition results and the population density distribution of the six cities .    * the zone partition and population density distribution of six european cities*. ( a ) london .",
    "( b ) berlin .",
    "( c ) prague .",
    "( d ) oslo .",
    "( e ) copenhagen .",
    "( f ) goteborg .",
    "the density function @xmath17 represents the probability of finding a travel started from zone @xmath2 .",
    ", width=340 ]    * comparing the travel distance distributions generated by different models*. ( a ) london .",
    "( b ) berlin .",
    "( c ) prague .",
    "( d ) oslo .",
    "( e ) copenhagen .",
    "( f ) goteborg .",
    "@xmath5 is the probability of a travel between locations at distance @xmath6.,width=340 ]        0.48@lcc    city & number of trips & number of zones + london & 49,323 & 986 + berlin & 18,504 & 494 + prague & 10,066 & 268 + oslo & 11,464 & 88 + copenhagen & 10,022 & 364 + goteborg & 67,438 & 422 +      we compare the travel distance distributions and the travel fluxes between all pairs of locations produced by the pwo model and the radiation model .",
    "the results are respectively shown in figure  [ fig - tdd - e ] and figure  [ fig - box - e ] , in which we can see that the predictions of the pwo model , including the distributions of travel distance and the travel fluxes between all pairs of locations are in good agreement with real observations , whereas the radiation model s results deviate from the real data .",
    "we collected travel survey data from the _ metropolitan travel survey archive _ website ( http://www.surveyarchive.org/ ) , which records more than 40 u. s. cities travel survey archives .",
    "most surveys contain information of citizens , including their households , vehicles and a diary of their trips on a given day ( including each trip s origin and destination location , start and end time , trip mode and purpose ) . through checking the data we find that for most data sets the trip - endpoints are labelled by taz code or zip code . due to the difficulty in converting the codes to geographic coordinates",
    ", we only use the survey data sets of four u. s. cities ( new york , seattle , detroit and the twin cities ) that contains the information of trip - endpoint s geographic coordinates ( latitude and longitude ) .",
    "we find out and record all trips in terms of the coordinates of their origins and destinations from the four data sets .",
    "table s2 shows the number of trips and some other data descriptions of the four cities .",
    "figure  [ fig - map - si ] shows the zone partition results and the population density distribution of the four cities .",
    "0.48@lccccccc    city & survey year & households & trips & zones + new york & 1998 & 10,971&69,282&3,006 + seattle & 2006 & 4,746&62,277&3,175 + detroit & 1994 & 7,300&53,583&4,056 + twin cities & 2001 & 8,961&35,469&2,684 +      figure  [ fig - tdd - si ] shows the travel distance distributions produced by the pwo model as well as the radiation model .",
    "we can see that the pwo model can precisely reproduce the observed distributions of travel distance , whereas the prediction results of the radiation model deviate from the real data .",
    "we also compare the travel fluxes between all pairs of locations produced by both models with the real data . as shown in figure  [ fig - box - si ] , we find that the average fluxes predicted by both models deviate from real observations to some extent .",
    "the prediction errors result from the low sampling rate in the household travel surveys .",
    "for instance , in new york , there are 3,006 zones and the travel matrix contains more than @xmath32 elements in principle . however , the surveys only record 69,282 trips .",
    "in other word , more than @xmath33 of the real travel matrix s elements are zeros .",
    "in contrast , the travel matrices established by the models are always fully filled ( although the values of some elements are very small ) . thus the fluxes predicted by both models",
    "inevitably deviate the insufficient samples of real fluxes .",
    "we believe adequate sampling rate of real fluxes will allow a fair comparison between reproduced results and real observations to validate our model .    * the zone partition and population density distribution of four u. s. cities*. ( a ) new york .",
    "( b ) seattle .",
    "( c ) detroit .",
    "( d ) twin cities .",
    "the density function @xmath17 represents the probability of finding a travel started from zone @xmath2 .",
    ", width=340 ]    * comparing the travel distance distributions generated by different models*. ( a ) new york .",
    "( b ) seattle .",
    "( c ) detroit .",
    "( d ) twin cities .",
    "@xmath5 is the probability of a travel between locations at distance @xmath6.,width=340 ]",
    "since the 1940s , many trip distribution models have been proposed for predicting human or freight mobility patterns .",
    "the gravity model  @xcite and intervening opportunity model  @xcite are two widely used models among them .",
    "since both of them rely on specific parameters estimated in terms of real traffic data to predict mobility model , we name them parameterised models .",
    "a recently presented rank - based model  @xcite also belongs to the parameterised models , although it needs very low input information to reproduce some key characteristics of human mobility patterns . in this section",
    ", we will compare the prediction performance of the pwo model with those of parameterised models .      *",
    "( 1 ) the gravity model *    the gravity model  @xcite stems from newton s gravity law and has many modified versions so far .",
    "the original gravity model has the form @xmath34 where @xmath20 is the travels departed from location @xmath2 to location @xmath3 , @xmath22 and @xmath23 are the populations of origin and destination and @xmath1 is the distance between @xmath2 and @xmath3 .",
    "although this model has a very similar form with newton s gravity law , the model s prediction results may violate the origin constraint @xmath35 and the destination constraint @xmath36 . to ensure the constraints",
    ", one can alternatively use the doubly constrained gravity model  @xcite @xmath37 where @xmath15 is the total travels departed from location @xmath2 , @xmath38 is the total travels arrived at location @xmath3 , @xmath39 is a function of the distance @xmath1 , and @xmath40 as well as @xmath41 are balancing factors that are interdependent to each other .",
    "an iterative process enables calculating @xmath42 and @xmath43 , but it demands high computational complexity . to simplify the calculation",
    ", one can use the singly constrained versions , either origin or destination constrained , of the gravity model by setting one set of the balancing factors @xmath42 or @xmath43 equal to one .    here",
    "we employ the origin - constrained gravity model  @xcite to predict mobility patterns in cities , described as @xmath44 the distance function @xmath39 can be of any forms , such as power or exponential function . based on numerical test , we find that the gravity model with power function @xmath45 offers better characterization of the cities mobility patterns than the exponential function ( see figure  [ fig - tdd - pe ] and figure  [ fig - box - pe ] ) .",
    "thus we use the power distance function , the parameter @xmath46 of which is estimated by fitting the real travel data of eight cities .    * ( 2 ) the intervening opportunities ( i. o. ) model *    the i. o. model  @xcite stresses that trip making is not directly related to distance but to the relative accessibility of opportunities for satisfying the objective of the trip .",
    "the model s basic assumption is that for every trip departed from a location , there is a constant probability @xmath47 that determines a traveller being satisfied with a single opportunity . if a location @xmath3 has @xmath48 opportunities ( we assume the number of opportunities at a location @xmath3 is proportional to its population @xmath49 ) , the probability of a traveller being attracted by location @xmath3 is @xmath50 , where @xmath51 .",
    "considering now the probability @xmath52 of not being satisfied by any of the opportunities offered by the @xmath53 destinations away from the origin @xmath2 , we can write @xmath54 or @xmath55 where @xmath56 is the total population between location @xmath2 and @xmath3 ( including @xmath2 and @xmath3 ) . assuming that the number of destinations is sufficiently large",
    ", we can treat @xmath57 and @xmath58 as continuous variables .",
    "then eq .",
    "( [ eqiod2 ] ) can be rewritten as @xmath59 after integration we obtain @xmath60 where @xmath12 is the total population in the city .",
    "note that the trip departed from location @xmath2 to location @xmath3 is equal to @xmath61.\\ ] ] combining eq .",
    "( [ eqiod5 ] ) and eq .",
    "( [ eqiod4 ] ) , we obtain the i. o. model : @xmath62    * ( 3 ) the rank - based model *    the rank - based model  @xcite assumes that the probability of an individual travelling from an origin to a destination depends ( inversely ) only upon the rank - distance between the destination and the origin .",
    "the model is described as @xmath63 where @xmath64 is the rank - distance from location @xmath3 to @xmath2 ( _ e.g. _ , if @xmath3 is the closest location to @xmath2 , @xmath65 ; if @xmath3 is the second closest location to @xmath2 , @xmath66 ) and @xmath67 is an adjustable parameter .      before applying the parameterised models , it is necessary to estimate their parameters .",
    "the goal of the parameter estimation is to maximise the accuracy of reproducing real mobility patterns by the models .",
    "here we use hyman method  @xcite , a standard method for calibrating gravity model in transportation planning  @xcite , to identify the gravity model s parameter .",
    "hyman method aims to find an optimal parameter to minimise the difference between modelled average travel distance and real average travel distance @xmath68 where @xmath69 is the average distance given by the gravity model with parameter @xmath46 , @xmath70 is the real average travel distance , @xmath71 is the number of travels from zone @xmath2 to @xmath3 generated by the gravity model and @xmath20 is the real number of travels from zone @xmath2 to @xmath3 .",
    "it is not easy to solve the equation @xmath72 .",
    "hyman suggests that we use the secant method to address this problem , described by the following process :    * step 1*. give an initial estimate of @xmath73 .    *",
    "step 2*. calculate a trip matrix using the gravity model with the parameter @xmath74 and obtain a modelled average travel distance @xmath75 .",
    "estimate a better value of @xmath46 by means of @xmath76 * step 3*. applying the gravity model with the estimated value of @xmath46 to calculate a new trip matrix and obtain a newly modelled average travel distance @xmath69 to compare with @xmath70 . if they are sufficiently close to each other , terminate the iteration and accept the newest value of @xmath46 as the best estimation ; otherwise go to step 4 .",
    "* step 4*. improve the estimation of @xmath46 via : @xmath77 * step 5*. repeat steps 3 and 4 until @xmath69 is sufficiently close to @xmath70 .",
    "the estimated parameters of the gravity model , the i.o . model and the rank - based model by hyman method are listed in table s3 for different cities .",
    "0.48@lccccccc    city & gravity & i. o. & rank - based & avg .",
    "travel dis .",
    "+ & @xmath46 & @xmath78 & @xmath67 & @xmath70 ( km ) + beijing&1.71&5.71@xmath79&1.14&5.50 + shenzhen&1.63&3.41@xmath79&1.19&4.77 + abidjan&2.43&3.04@xmath80&1.36&2.47 + chicago&2.14&2.69@xmath81&1.15&9.49 + new york&2.28&5.45@xmath81&1.20&11.71 + seattle&1.93&2.65@xmath81&1.12&8.30 + detroit&2.02&4.59@xmath81&1.13&8.94 + twin cities&1.93&3.56@xmath81&1.04&8.15 +      * comparing the travel distance distributions generated by two types of gravity models*. ( a ) beijing .",
    "( b ) shenzhen .",
    "( c ) abidjan .",
    "( d ) chicago .",
    "( e ) new york .",
    "( f ) seattle .",
    "( g ) detroit .",
    "( h ) twin cities.,width=340 ]        * comparing the travel distance distributions generated by different models*. ( a ) beijing .",
    "( b ) shenzhen .",
    "( c ) abidjan .",
    "( d ) chicago .",
    "( e ) new york .",
    "( f ) seattle .",
    "( g ) detroit .",
    "( h ) twin cities.,width=340 ]    * comparing the destination travel constraints of different models*. ( a ) beijing .",
    "( b ) shenzhen .",
    "( c ) abidjan .",
    "( d ) chicago .",
    "( e ) new york .",
    "( f ) seattle .",
    "( g ) detroit .",
    "( h ) twin cities.,width=340 ]            * comparing the prediction ability of different models based on srensen similarity index ( ssi)*.,width=340 ]    * ( 1 ) travel distance distribution *    figure  [ fig - tdd - all ] shows the travel distance distribution predicted by different models .",
    "we see that both the gravity model and the rank - based model can reproduce the observed distributions of travel distance in most cases , but the i. o. model s results have significant deviation from the real data .",
    "although in some cases the results of the gravity model ( or rank - based model ) are better than those of the pwo model , the gravity model needs a distance - decay function with adjustable parameters to match real data , whereas our model relies solely on the population distribution without free parameters .    *",
    "( 2 ) destination travel constraints *    figure  [ fig - des - all ] shows the destination travel constraints produced by the models .",
    "we see that the results from the pwo model are in equal or better agreement with the real data than those of the other models in all cases .",
    "it is noteworthy that the rank - based model shows the worst performance in this aspect .",
    "we speculate that the fact that the rank - based model do not make use of the population data at destination locations accounts for the big difference from real observations .    *",
    "( 3 ) travel fluxes between all pairs of locations",
    "*    we compare the travel fluxes between all pairs of locations predicted by models with empirical data .",
    "as shown in figure  [ fig - box - ch ] and figure  [ fig - box - us ] , we observe that all the predicted average fluxes by the pwo model , the gravity model and the rank - based model are comparable with the real fluxes to some extent . to give a more explicit comparison among different models , we use srensen similarity index as an alternative to measure the degree of agreement between reproduced travel matrices and empirical observations .",
    "figure  [ fig - ssi - all ] shows that on average , the accuracy of the pwo model is higher than that of the i. o. model and the rank - based model .",
    "although in some cases the gravity model can yield better prediction accuracy than the pwo model , the gravity model needs parameter values estimated from previous mobility measurements .",
    "in contrast , the pwo model only require the population distribution as input , rendering its application scope broader .",
    "to deepen our understanding of the underlying mechanism in the trip distribution models explored in this paper , we discuss the relationship among them .",
    "we will first show that , in the particular case of uniform population distribution , the pwo , the radiation model , the i. o. model and the rank - based model can all transform into gravity - like models .",
    "next , we will show that these models can be classified into two categories of modelling frameworks : sequential selection and global selection .",
    "consider a uniform population distribution ( _ i.e. _ @xmath82 , where @xmath83 is the population density ) .",
    "we can write the pwo model ( eq .",
    "( 1 ) in the main text ) as @xmath84 where @xmath85 is the area of the city . comparing with eq .",
    "( [ eqgr ] ) , we can realise that eq .",
    "( [ eqcd1 ] ) is actually a gravity model with the distance function @xmath86 .",
    "this function is a power law with a cut - off ( see figure  [ fig - func](a ) ) .",
    "since the population is not uniformly distributed in real cities , we can not directly use such distance function in the gravity model to predict travel fluxes .",
    "alternatively , we have to estimate its parameters by relying on real traffic data prior to applying the gravity model .",
    "however , we may directly choose a population function , such as @xmath87 , to be used in the pwo model in the sense that the heterogeneity of population distribution has been captured by @xmath0 .",
    "figure  [ fig - func](b ) shows the relationship between the population @xmath0 and the travel proportion @xmath88 in abidjan , which is in agreement with the population function .",
    "when the population distribution is of uniform distribution ( @xmath89 ) , the radiation model  @xcite is reduced to @xmath90 which is actually a gravity model with a power - law distance function with power exponent @xmath91 . comparing with the uniform version of the pwo model ( having a power exponent @xmath92 )",
    ", the selection scope of an individual in the radiation model is relatively more local .",
    "the radiation model can characterise the mobility patterns at the country scale ( the estimated power exponent of gravity law in the case of u. s. state - wide commuting trips is @xmath93  @xcite , which does not significantly deviate from @xmath94 ) , but it is not applicable to predicting city mobility patterns .",
    "table s2 shows that the estimated power exponents of the cities are subject to the range @xmath95 , quite close to the exponent in eq .",
    "( [ eqcd1 ] ) but different from that in eq .",
    "( [ eqrd1 ] ) .    the i. o. model can be also transformed into a gravity - like form in the case of uniform population distribution : @xmath96 where @xmath97 .",
    "the distance function is of high - order exponential form , implying the lack of long - distance travel generated by the model .",
    "thus it is not surprise that the i. o. model usually underestimates long - distance travels , as shown in figure  [ fig - tdd - all ] .",
    "* distance function and population function*. ( a ) the distance function @xmath86 . @xmath98 .",
    "( b ) the relationship between the population @xmath0 and travel proportion @xmath88 .",
    "blue circles are empirical data and red line is the theoretical function ( @xmath99).,width=340 ]    the rank - based model uses rank - distance rather than spatial distance to predict the travels between locations . when the population are uniformly distributed in cities , the rank - distance between locations is proportional to the square of the spatial distance , such that the rank - based model can be rewritten as @xmath100 the distance function in eq .",
    "( [ eqrk1 ] ) is a power law with the power exponent around 2 ( see table s2 ) .",
    "it can thus yield similar results to the travel distance distribution resulting from the gravity model and the pwo model ( see figure  [ fig - tdd - all ] ) .",
    "however , in the rank - based model the information of population in destination is ignored , rendering the destination travel constraints inaccurate , as shown in figure  [ fig - des - all ] .",
    "taken together , insofar as given uniform population distributions , the pwo model , the radiation model , the i. o. model and the rank - based model can presented to be gravity - like models .",
    "although these models have different hypothesis , they share similar underlying mechanism : the probability that an individual selects a travel destination is decreased along with the increment of some prohibitive factors . in the gravity models ,",
    "the factor is spatial distance ; in the rank - based model it is the rank - distance ; in the i. o. model , the radiation model or the pwo model , it is the population between origins and destinations .",
    "the key difference lies in the fact that the gravity model , the i. o. model and the rank - based model need adjustable parameters to quantify the decrement effect , whereas in the radiation model and the pwo model , the decrement effect is naturally determined by population distribution .      according to the decision - making process of travellers for selecting destinations",
    ", the frameworks of predicting mobility patterns can be classified into two categories .",
    "the first category includes the i. o. model and the radiation model , in which each traveller ranks potential destinations in ascending order according to the distance to his / her origin .",
    "an individual first decides whether to travel to the first destination in terms of a probability which is determined by some specific rules ( see schematic in figure  [ fig - cat](b ) ) .",
    "if the individual abandons the destination , the second one will be considered in terms of the same probability .",
    "analogously , all potential destinations will be considered step by step until the individual eventually decides to travel to a chosen one .",
    "we name such step - by - step decision - making process _",
    "sequential selection_. the modelling framework can be described in a unified form : @xmath101 where @xmath52 is the probability of excluding the 1st to @xmath3th destinations departed from the origin @xmath2 and @xmath102 is the probability of selecting @xmath3th destination insofar as the 1st to @xmath103th destinations are not selected .",
    "thus , the probability of selecting @xmath3 to travel can be expressed in a joint probability @xmath104    * schematic description of sequential selection and global selection*. ( a ) simplified scenario of destination selection .",
    "central circle ( red ) is the origin , other circles are selectable destinations .",
    "( b ) the decision - making process of sequential selection .",
    "each traveller ranks all possible destinations in ascending order according to the distance to his / her origin .",
    "an individual first decides whether to travel to the first destination in terms of some probability if the individual abandons the first destination , the second one will be considered in terms of the same probability .",
    "subsequently , all possible destinations will be considered step by step until the individual decides to travel to the chosen one .",
    "( c ) the decision - making process of global selection .",
    "a traveller evaluates the attractions of all possible destinations simultaneously and selects a destination to travel with a probability proportional to the destination s attraction.,width=302 ]    the i. o. model can be derived by assuming that the probability @xmath102 is proportional to the population of destination @xmath3 ( _ i.e. _ @xmath105 ) .",
    "after some calculations , we finally have @xmath106 which is the probability of selecting destination @xmath3 departed from @xmath2 in the i. o. model .    similarly , assuming that the probability @xmath102 is the ratio of the population of destination @xmath3 to the total population @xmath56 between locations @xmath2 and @xmath3 , we have @xmath107 and @xmath108 which is nothing but the radiation model .    different forms of probability @xmath102 can lead to different versions of models that are subject to the framework of sequential selection .",
    "for instance , assuming the probability @xmath102 is the ratio of @xmath23 to the remaining population @xmath109 , we can have @xmath110 and @xmath111 which is the uniform selection model  @xcite .    note that in the sequential selection models , it is possible to find that travellers do not select any destinations to travel unless the system is infinite  @xcite .",
    "in general , the probability is @xmath112 . in other words",
    ", a traveller stays at the origin with probability @xmath113 . for the i. o. model , @xmath114 ; for the radiation model and the uniform selection model , @xmath115 .",
    "the second category , named _ global selection _ , includes the gravity model , the pwo model and the rank - based model . in global selection model s decision - making process",
    ", a traveller evaluates the attractions of all possible destinations simultaneously and selects a destination to travel with a probability proportional to the destination s attraction ( see schematic in figure  [ fig - cat](c ) ) .",
    "the unified framework can be described as @xmath116 where @xmath117 is the attraction of destination @xmath3 .",
    "if we solely use population to capture the destination s attraction , the uniform selection model is obtained ; if we use some functions to describe the decay of attraction along with the increase of ( real or rank ) distance , we can obtain the gravity or the rank - based model ( see eq .",
    "( s3 ) and eq .",
    "( s10 ) ) ; if the attraction is inversely proportional to the population between destinations and origins , the pwo model is derived .    despite the difference between the two modelling frameworks ,",
    "both sequential and global selection models imply the preference for closer destinations in human travel decision - making : in sequential selection model , a closer destination has a higher priority to be selected ; in global selection model , the attraction of a closer destination decays slowly than that of a farther one .",
    "although both frameworks capture the decision - making process of travellers to some extent , our comparison study ( figure s9-s13 ) demonstrates that at the city scale , global selection models perform better than sequential selection models",
    ".    99 cho e , s. myers a , leskovec j. friendship and mobility : user movement in location - based social networks .",
    "acm sigkdd international conference on knowledge discovery and data mining ( kdd ) , 2011 .",
    "1946 the @xmath30 hypothesis : on the intercity movement of persons . _ am .",
    "rev . _ * 11 * , 677 - 686 .",
    "stouffer sa .",
    "1940 intervening opportunities : a theory relating mobility and distance . _ am .",
    "rev . _ * 5 * , 845 - 867 .",
    "noulas a , scellato s , lambiotte r , pontil m , mascolo c. 2012 a tale of many cities : universal patterns in human urban mobility . _",
    "plos one _ * 7 * , e37027 .",
    "ortzar jd , willumsen lg .",
    "2011 _ modelling transport . _ new york , usa : john wiley & sons .",
    "1969 the calibration of trip distribution models .",
    "* 1 * , 105 - 112 .",
    "simini f , gonzlez mc , maritan a , barabsi a - l .",
    "2012 a universal model for mobility and migration patterns .",
    "_ nature _ * 484 * , 96 - 100 .",
    "simini f , maritan a , nda z. 2013 human mobility in a continuum approach . _",
    "plos one _ * 8 * , e60069 .",
    "masucci ap , serras j , johansson a , batty m. 2013 gravity versus radiation model : on the importance of scale and heterogeneity in commuting flows .",
    "e _ * 88 * , 022812 ."
  ],
  "abstract_text": [
    "<S> despite the long history of modelling human mobility , we continue to lack a highly accurate approach with low data requirements for predicting mobility patterns in cities . here </S>",
    "<S> , we present a population - weighted opportunities model without any adjustable parameters to capture the underlying driving force accounting for human mobility patterns at the city scale . </S>",
    "<S> we use various mobility data collected from a number of cities with different characteristics to demonstrate the predictive power of our model . </S>",
    "<S> we find that insofar as the spatial distribution of population is available , our model offers universal prediction of mobility patterns in good agreement with real observations , including distance distribution , destination travel constraints and flux . </S>",
    "<S> in contrast , the models that succeed in modelling mobility patterns in countries are not applicable in cities , which suggests that there is a diversity of human mobility at different spatial scales . our model has potential applications in many fields relevant to mobility behaviour in cities , without relying on previous mobility measurements . </S>"
  ]
}