{
  "article_text": [
    "proving that a graph property @xmath1 is not definable in first order logic @xmath2 can be a challenging task , especially on graphs with an additional linear order on the vertices .",
    "proving that a graph property such as 3-colorability , which is definable in monadic second order logic @xmath3 , is not definable in fixed point logic on ordered graphs amounts to solving the famous @xmath4 problem .    in the case of @xmath2 and @xmath3 properties the basic tools for proving non - definability are the various _ ehrenfeucht - frass games _ also called _",
    "pebble games_. however , proving the existence of winning strategies for these games can be exasperating .",
    "two additional tools can be used to make the construction of such winning strategies easier and more transparent : the _ composition of winning strategies _ and the use of _ locality properties _ such as hanf locality and gaifman locality .",
    "these techniques are by now well understood , even if not always simple to apply , and are described in monographs such as @xcite .",
    "however these techniques are not easily applicable for stronger logics , such as @xmath5 and @xmath0 , which extend @xmath2 respectively @xmath3 with modular counting quantifiers @xmath6 which say that the number of elements satisfying @xmath7 equals @xmath8 modulo @xmath9 .",
    "furthermore , the pebble game method or the locality method may be difficult to use when dealing with ordered structures or when proving non - definability for the case where the definition may use an order relation on the universe in an _ order - invariant _ way .",
    "definability in @xmath3 and @xmath0 depends on whether the vocabulary of graphs or hypergraphs is considered .",
    "the vocabulary of graphs is @xmath10 consisting of the edge relation symbol @xmath11 .",
    "the vocabulary @xmath12 of hypergraphs is two - sorted , with two unary relation symbols @xmath13 and @xmath11 whose interpretations partition the universe , and has the binary incidence relation @xmath14 between @xmath13 elements and @xmath11 elements .",
    "structures of @xmath12 can be not only graphs but hypergraphs . in @xcite @xmath3 over @xmath10",
    "is denoted @xmath15 , while @xmath3 over @xmath12 is denoted @xmath16 . in the case of",
    "@xmath2 the choice of @xmath17 or @xmath12 does not have any effect on definablility .",
    "the notion of definability was extended in @xcite to integer valued graph parameters , and in @xcite to real or complex valued graph parameters and graph polynomials . in @xcite and @xcite",
    "graph polynomials definable in @xmath3 respectively @xmath18 were introduced .",
    "the techniques of pebble games and locality do not lend themselves easily , or are not useful at all , for proving non - definability in these cases .",
    "we assume the reader is familiar with the basics of finite model theory @xcite and graph theory @xcite .",
    "_ connection matrices _ were introduced in @xcite by m. freedman , l. lovsz and a. schrijver where they were used to characterize to characterize various partition functions based on graph homomorphisms , cf . also @xcite .",
    "let @xmath19 be a graph parameter whose image is in some field @xmath20 such as the real or the complex numbers .",
    "a @xmath21-connection matrix @xmath22 is an infinite matrix , where the rows and columns are indexed by finite @xmath21-labeled graphs @xmath23 and the entry @xmath24 is given by the value of @xmath25 . here",
    "@xmath26 denotes the _ @xmath21-sum _ operation on @xmath23 and @xmath27 , i.e. the operation of taking the disjoint union of @xmath23 and @xmath27 and identifying vertices with the corresponding @xmath21-many labels .    in @xcite connection matrices",
    "were used to show that certain graph parameters and polynomials are not @xmath3-definable .",
    "the main result of @xcite is the _ finite rank theorem _ , which states that the connection matrices of @xmath0-definable graph polynomials have finite rank .",
    "connection matrices and the finite rank theorem were generalized in @xcite to matrices @xmath28 where @xmath29 is a binary operation on labeled graphs subject to a smoothness condition depending on the logic one wants to deal with .",
    "however , very few applications of the finite rank theorem were given .",
    "the purpose of this paper lies in the demonstration that the finite rank theorem is a _ truly manageable tool _ for proving non - definability which leaves no room for hand - waving arguments .",
    "to make our point we discuss graph properties ( not)-definable in @xmath5 and @xmath0 .",
    "we also discuss the corresponding ( non)-definability questions in @xmath0 for graph parameters and graph polynomials .",
    "although one can derive pebble games for these two logics , see e.g. @xcite , using them to prove non - definability may be very awkward .",
    "instead we use a feferman - vaught - type theorem for @xmath5 for disjoint unions and cartesian products , theorem [ th : fv - cfol ] , which seems to be new for the case of products . the corresponding theorem for disjoint unions , theorem [ th : fv - cmsol](i ) , for @xmath0 was proven by b. courcelle @xcite .",
    "the proof of the finite rank theorem for these logics follows from the feferman - vaught - type theorems .",
    "the details will be spelled out in section [ se : fol ] .    with the help of the finite rank theorem",
    "we give new and uniform proofs for the following :    using connection matrices for various generalizations of the cartesian product @xmath30 we prove non - definability of the following properties in @xmath5 with the vocabulary of graphs @xmath31 with linear order :    * forests , bipartite graphs , chordal graphs , perfect graphs , interval graphs , block graphs ( every biconnected component , i.e. , every block , is a clique ) , parity graphs ( any two induced paths joining the same pair of vertices have the same parity ) ; * trees , connected graphs ; * planar graphs , cactus graphs ( graphs in which any two cycles have at most one vertex in common ) and pseudo - forests ( graphs in which every connected component has at most one cycle ) ; * bridgeless graphs , @xmath21-connected .",
    "the case of connected graphs was also shown undefinable in @xmath5 by .",
    "j. nurmonen in @xcite using his version of the pebble games for @xmath5 .",
    "using connection matrices for various generalizations of the disjoint union @xmath32 we prove non - definability of the following properties in @xmath0 with the vocabulary of graphs @xmath31 with linear order :    * hamiltonicity ( via cycles or paths ) , graphs having a perfect matching , cage graphs ( regular graphs with as few vertices as possible for their girth ) , well - covered graphs ( where every minimal vertex cover has the same size as any other minimal vertex cover ) . here",
    "@xmath32 is the join operation @xmath33 . * the class of graphs which have a spanning tree of degree at most @xmath34 . here",
    "@xmath32 is a modified join operation ( * ? ? ?",
    "* remark 5.21 , page 350 ) .    using connection matrices for various generalizations of the disjoint union @xmath32",
    "we prove non - definability of the following properties in @xmath0 with the vocabulary of hypergraphs @xmath35 with linear order :    * regular graphs and bi - degree graphs . *",
    "graphs with average degree at most @xmath36 ; * aperiodic digraphs ( where the greatest common divisor of the lengths of all cycles in the graph is @xmath37 ) ; * asymmetric ( also called rigid ) graphs ( i.e. graphs which have no non - trivial automorphisms ) .",
    "a graph parameter is @xmath0-definable if it is the evaluation of a @xmath0-definable graph polynomial .",
    "the precise definition of definability of graph polynomials is given in section [ se : solpol ] .",
    "most prominent graph polynomials turned out to be definable in @xmath0 , sometimes using a linear order on the vertices in an order - invariant way , among them the various tutte polynomials , interlace polynomials , matching polynomials , and many more , cf .",
    "this led the second author to express his belief in @xcite that all `` naturally occurring graph polynomials '' are @xmath0-definable .",
    "however , in @xcite it was shown , using connection matrices , that the graph polynomial counting harmonious colorings is not @xmath0-definable .",
    "a vertex coloring is harmonious if each pair of colors appears at most once at the two end points of an edge , cf .",
    "that this is indeed a graph polynomial was shown in @xcite . however , the main thrust of @xcite consists in showing that certain graph parameters are not evaluations of the standard prominent graph polynomials .    in section [ se :",
    "solpolx ] , we use connection matrices to show that many `` naturally occurring graph polynomials '' are not @xmath0-definable .",
    "all these examples count various colorings and are graph polynomials by @xcite .",
    "the corresponding notion of coloring is studied extensively in the literature .    to illustrate this",
    "we show that the following graph polynomials are not @xmath0-definable in the language of graphs :    * the _ chromatic polynomial _",
    "@xmath38 which counts proper vertex @xmath21-colorings of @xmath39 ; * for every fixed @xmath40 , @xmath41 which counts vertex @xmath21-colorings @xmath42 $ ] for which no color induces a subgraph with a connected component of size larger than @xmath43 ; * the _ vertex - acyclic polynomial _",
    "@xmath44 which counts proper vertex @xmath21-colorings @xmath45 $ ] such that there is no two colored cycle in g.    we show that the following graph polynomials are not even @xmath0-definable in the language of hypergraphs :    * the _ rainbow polynomial _ @xmath46 which counts _ path - rainbow connected @xmath21-colorings _ , which are functions @xmath47 $ ] such that between any two vertices @xmath48 there exists a path where all the edges have different colors .",
    "* @xmath49 is the number of _ convex colorings _ , which are vertex @xmath21-colorings @xmath42 $ ] such that every color induces a connected subgraph of g. * for every fixed @xmath40 , @xmath50 which counts _",
    "@xmath43-improper colorings_. a @xmath43-improper coloring is function @xmath45 $ ] for which every color induces a graph in which no vertex has degree more than @xmath43 .",
    "* @xmath51 which counts _ non - repetitive colorings_. a function f : e(g )  [ k ] is a non - repetitive coloring if the sequence of colors on any path in @xmath39 is non - repetitive .",
    "a sequence @xmath52 is non - repetitive if there is no @xmath53 such that @xmath54 .",
    "* the _ harmonious polynomial _",
    "@xmath55 which counts proper vertex @xmath21-colorings @xmath45 $ ] such that for any two distinct edges @xmath56 and @xmath57 , it holds that @xmath58 .",
    "the underlying proof idea here is similar to that in @xcite .",
    "we bring it here for completeness .",
    "path - rainbow connected colorings were introduced in @xcite and their complexity was studied in @xcite .",
    "@xmath59-colorings were studied in @xcite , @xcite and @xcite .",
    "note @xmath60 is the chromatic polynomial .",
    "convex colorings were studied for their complexity e.g. in @xcite and @xcite . from @xcite",
    "we get that @xmath46 , @xmath41 , and @xmath49 are graph polynomials with @xmath21 as the variable .",
    "acyclic vertex colorings were introduced in @xcite and a. v. kostochka proved in 1978 in his thesis that it is np - hard to decide for a given g and k if the there exists an acyclic vertex coloring with at most k colors , see @xcite .",
    "acyclic edge colorings were studied e.g. in @xcite .",
    "it is np - hard to determine whether g is t - improperly 2-colorable for any fixed positive t ( even if g is planar ) , cf .",
    "non - repetitive colorings were introduced in @xcite .",
    "their complexity was studied in @xcite .",
    "the minimal number of colors needed to color @xmath39 in a non - repetitive way is called the _ thue number _ of @xmath39 .",
    "section [ se : solpolx ] contains more examples of graph polynomials and graph parameters not definable in @xmath0 .      in section [ se : reg ]",
    "we illustrate the use of connection matrices in the case of regular languages .",
    "this serves as a `` warm - up '' exercise . in section [ se : fol ] we introduce the general framework for connection matrices of graph properties , i.e. , boolean graph parameters , and of properties of general @xmath61-structures . in section [",
    "se : limits ] we spell out the advantages and limitations of the method of connection matrices in proving non - definability . in section",
    "[ se : even ] we give a proof of the feferman - vaught theorem for @xmath5 . in section [ se : nondef ] we illustrate the use of connection matrices and the finite rank theorem for proving non - definability of properties . in section [ se : solpol ] we recall the framework of definable graph polynomials and @xmath61-polynomials and the corresponding definable numeric parameters . in section",
    "[ se : cmsol - pol - fv ] we prove a feferman - vaught - type theorem for @xmath0-polynomials with respect to sum - like operations , which is the main ingredient in finite rank theorems for @xmath0-polynomials , and in section [ se : solpolx ] we show how to prove non - definability of many numeric graph invariants .",
    "our first motivating examples deal with regular languages and the operation of concatenation @xmath62 . by the well - known bchi - elgot - trakhtenbrot theorem , see @xcite , a language @xmath63 is regular if and only if the class @xmath64 of ordered structures representing the words of @xmath65 is definable in @xmath3 ( or equivalently in @xmath0 or @xmath66 , the existential fragment of @xmath3 ) .",
    "the connection matrix @xmath67 with columns and rows indexed by all words of @xmath68 is defined by @xmath69 iff @xmath70 . rather than @xmath65 .",
    "we allow this slight abuse of notation to achieve simpler notation . ]",
    "the myhill - nerode theorem , see @xcite , can be used to derive the following properties of @xmath67 :    [ p : reg-1 ] let @xmath63 be a regular language .",
    "there is a finite partition @xmath71 of @xmath68 such that the sub - matrices obtained from restricting @xmath67 to}$ ] denotes the submatrix of @xmath67 with rows and columns corresponding to @xmath72 and @xmath73 respectively . ]",
    "@xmath74}$ ] have constant entries .    in particular , the infinite matrix @xmath67 has finite rank over any field @xmath75 .",
    "@xmath67 has an infinite sub - matrix of rank at most @xmath37 .",
    "now we can also look at counting functions and numeric parameters of words , such as the length @xmath76 of a word @xmath77 or the number of words @xmath78 in a language @xmath65 which are ( connected ) sub - words of a given word @xmath77 .",
    "the corresponding connection matrices @xmath79 and @xmath80 defined by @xmath81 and @xmath82 respectively do not satisfy ( i ) and ( iii ) above , but still have finite rank . on the other hand the function @xmath83 which gives the maximal size of a word in @xmath65 which occurs as a connected sub - word in @xmath77 gives rise to connection matrix @xmath84 of infinite rank . here",
    "@xmath85 where @xmath86 and therefore @xmath87 .",
    "we can use these connection matrices to show that @xmath88 is not regular , by noting that the sub - matrix @xmath89 with columns indexed by @xmath90 and rows indexed by @xmath91 has @xmath92 everywhere but in the diagonal , hence has infinite rank , contradicting ( ii ) of proposition [ p : reg-1 ] .    the numeric parameters on words @xmath93 are @xmath3-definable : @xmath94 , where @xmath95 means that @xmath96 is a proper possibly empty initial segment of @xmath77 .",
    "similarly , @xmath97 , where @xmath98 denotes the relation @xmath96 is a connected sub - word of @xmath77 . we shall give a general definition of @xmath3-definable numeric parameter in section [ se : solpol ] .",
    "but we state here already    [ p : reg-2 ] the connection matrices @xmath99 and @xmath100 have finite rank , provided @xmath19 is @xmath3-definable .",
    "the function @xmath83 is not @xmath3-definable .",
    "connection matrices for concatenation of words are known in automata theory as hankel - matrices and were introduced in @xcite , see also @xcite and @xcite .",
    "[ se : framework ]    let @xmath61 be a purely relational finite vocabulary which may include constant symbols and may include a distinguished binary relation symbol for a linear order .",
    "@xmath61-property _ is a class of finite @xmath61-structures closed under @xmath61-isomorphisms .",
    "if the context is clear we just speak of properties and isomorphisms .",
    "we denote by @xmath101 the set of @xmath18 formulas over @xmath61 .",
    "a sentence is a formula without free variables .",
    "let @xmath102 be a subset of @xmath18 .",
    "@xmath103 is a _ fragment of @xmath18 _ if the following conditions hold :    for every finite relational vocabulary @xmath61 the set of @xmath104 formulas contains all the atomic @xmath61-formulas and is closed under the boolean operations @xmath105 and under renaming of relation and constant symbols .",
    "@xmath103 is equipped with a notion of _ quantifier rank _ @xmath106 and we denote by @xmath107 the set of formulas of quantifier rank at most @xmath108 .",
    "the quantifier rank of atomic formulas is @xmath92 .",
    "the quantifier rank of a boolean combination of formulas @xmath109 is the maximum quantifier rank of @xmath110 .",
    "the quantifier rank is sub - additive under substitution of sub - formulas .",
    "the set of formulas of @xmath107 with a fixed set of free variables is , up to logical equivalence , finite .",
    "furthermore , if @xmath111 is a formula of @xmath107 with @xmath112 a free variable of @xmath103 , then there is a formula @xmath113 logically equivalent to @xmath114 in @xmath115 with @xmath116 .",
    "typical fragments are @xmath2 and @xmath3 . @xmath0 and the fixed point logics @xmath117 and",
    "@xmath118 and their corresponding finite variable subsets correspond to fragments of @xmath18 if we replace the counting or fixed - point operators by their @xmath18-definitions .    for two @xmath61-structures @xmath119 and @xmath120",
    "we define the _ equivalence relation of @xmath107- non - distinguishability _ , and we write @xmath121 , if they satisfy the same sentences from @xmath107 .",
    "let @xmath122 be a function .",
    "a binary operation @xmath29 between @xmath61-structures is called _",
    "( @xmath123,@xmath103)-smooth _ , if for all @xmath124 whenever @xmath125 and @xmath126 then @xmath127 a binary operation @xmath29 between @xmath61-structures is _ @xmath103-smooth _ if it is ( @xmath92,@xmath103)-smooth .    for two @xmath61-structures @xmath128 and @xmath129",
    ", we denote by @xmath130 the _ disjoint union _ , which is a @xmath61-structure - structures @xmath128 and @xmath129 and tuples @xmath131 and @xmath132 of @xmath133 respectively @xmath134 elements , we denote by @xmath135 the disjoint union @xmath130 extended with the tuples @xmath131 and @xmath132 , i.e. the structure @xmath136 . ] ; @xmath137 the _ rich disjoint union _ which is the disjoint union augmented with two unary predicates for the universes @xmath133 and @xmath134 respectively ; @xmath138 the _ cartesian product _ , which is a @xmath61-structure ; and for graphs @xmath139 by @xmath140 the _",
    "join _ of two graphs obtained from the disjoint union of @xmath39 and @xmath141 by adding all possible edges between vertices of @xmath39 and vertices of @xmath141 .",
    "a _ @xmath103-transduction _ of @xmath61-structures into @xmath142-structures is given by defining a @xmath142-structure inside a given @xmath61-structure .",
    "the universe of the new structure may be a definable subset of an @xmath143-fold cartesian product of the old structure .",
    "if @xmath144 we speak of _ scalar _ and otherwise of _ vectorized _ transductions . for every @xmath21-ary relation symbol @xmath145",
    "we need a @xmath61-formula in @xmath146 free individual variables to define it .",
    "we denote by @xmath147 a sequence of @xmath61-formulas which defines a transduction .",
    "we denote by @xmath148 the map sending @xmath61-structures into @xmath142-structures induced by @xmath147 .",
    "we denote by @xmath149 the map sending @xmath142-formulas into @xmath61-formulas induced by @xmath147 . for a @xmath142-formula @xmath150",
    "is the _ backward translation _ of @xmath151 into a @xmath61-formula .",
    "@xmath147 is _ quantifier - free _ if all its formulas are from @xmath152 .",
    "we skip the details , and refer the reader to @xcite .",
    "a fragment @xmath103 is _ closed under scalar transductions _",
    ", if for @xmath147 such that all the formulas of @xmath147 are in @xmath104 , @xmath147 scalar , and @xmath153 , the backward substitution @xmath150 is also in @xmath104 .",
    "a fragment of @xmath18 is called _ tame _ if it is closed under scalar transductions and containment of the form @xmath154 .",
    "@xmath2 , @xmath3 and @xmath0 are all tame fragments .",
    "so are their finite variable versions .",
    "@xmath2 and @xmath18 are also closed under vectorized transductions , but the monadic fragments @xmath3 and @xmath0 are not .",
    "we shall frequently use the following :    [ p : fund ] let @xmath147 define a @xmath103-transduction from @xmath61-structures to @xmath142-structures where each formula is of quantifier rank at most @xmath108 .",
    "let @xmath151 be a @xmath155-formula .",
    "then @xmath156 and @xmath157 is in @xmath158 .",
    "[ p : fol-1 ] [ th : fv - cmsol ]     the rich disjoint union @xmath159 of @xmath61-structures and therefore also the disjoint union are @xmath2-smooth , @xmath3-smooth and @xmath0-smooth .",
    "they are not @xmath18-smooth .",
    "the @xmath21-sum @xmath26 of @xmath61-structures is @xmath3-smooth and @xmath0-smooth , but not @xmath18-smooth , for @xmath160 .",
    "the cartesian product @xmath161 of @xmath61-structures is @xmath2-smooth , but not @xmath3-smooth    the join @xmath33 of @xmath61-structures is @xmath2-smooth and @xmath3- and @xmath0-smooth in the vocabulary of graphs , but is not @xmath3- and @xmath0-smooth in the vocabulary of hypergraphs .",
    "let @xmath147 be a quantifier - free scalar transduction of @xmath61-structures into @xmath61-structures and let @xmath29 be an @xmath103-smooth operation . then the operation @xmath162 is @xmath103-smooth .",
    "if @xmath147 has quantifier rank at most @xmath21 , it is @xmath163-smooth .",
    "\\(i ) is shown for @xmath2 and @xmath3 using the usual pebble games . for @xmath0",
    "one can use courcelle s version of the feferman - vaught theorem for @xmath0 , cf .",
    "( iii ) is again shown using the pebble game for @xmath2 .",
    "( v ) follows from proposition [ p : fund ] .",
    "the negative statements are well - known , but also follow from the developments in the sequel .",
    "( ii ) and ( iv ) follow from ( i ) and ( v ) .",
    "[ th : fv - cfol ]     the rich disjoint union @xmath159 of @xmath61-structures , and therefore the disjoint union , too , is @xmath5-smooth .",
    "the cartesian product @xmath161 of @xmath61-structures is @xmath5-smooth .",
    "the proof does not use pebble games , but feferman - vaught - type reduction sequences .",
    "( i ) can be proven using the same reduction sequences which are used in @xcite .",
    "we will prove ( ii ) in section [ se : even ] .",
    "to the best of our knowledge , ( ii ) of theorem [ th : fv - cfol ] has not been stated in the literature before .",
    "theorem [ th : fv - cfol](ii ) is proven using modifications of the reduction sequences from ( * ? ? ?",
    "* theorem 1.6 ) .",
    "reduction sequences are tuples of formulas @xmath164 obtained from a formula @xmath7 so that the truth - value of @xmath165 on @xmath7 is a boolean combination of the truth - values of @xmath128 on @xmath166 and @xmath129 on @xmath167 .",
    "we call this a feferman - vaught theorem , because our proof actually computes the reduction sequences explicitly",
    ". one might also try to prove the theorem using the pebble games defined in @xcite , but at least for the case of the cartesian product , the proof would be rather complicated and less transparent .    [",
    "th : frt - tame ]   + let @xmath103 be a tame fragment of @xmath18 .",
    "let @xmath29 be a binary operation between @xmath61-structures which is @xmath103-smooth .",
    "let @xmath168 be a @xmath61-property which is definable by a @xmath103-formula @xmath113 and @xmath169 be the connection matrix defined by @xmath170 then    there is a finite partition @xmath71 of the ( finite ) @xmath61-structures such that the sub - matrices obtained from restricting @xmath169 to @xmath171}$ ] have constant entries .    in particular , the infinite matrix @xmath169 has finite rank over any field @xmath75 .",
    "@xmath169 has an infinite sub - matrix of rank at most @xmath37 .",
    "\\(i ) follows from the definition of a tame fragment and of smoothness and the fact that there are only finitely many formulas ( up to logical equivalence ) in @xmath172 .",
    "( ii ) and ( iii ) follow from ( i ) .",
    "the advantages of the finite rank theorem for tame @xmath103 in proving that a property is not definable in @xmath103 are the following :    once the @xmath103-smoothness of a binary operation has been established , proofs of non - definability become surprisingly simple and transparent .",
    "one of the most striking examples is the fact that asymmetric ( rigid ) graphs are not definable in @xmath0 , cf .",
    "corollary [ co : ms2 ] .",
    "many properties can be proven to be non - definable using the same or similar sub - matrices , i.e. , matrices with the same row and column indices .",
    "this is well illustrated in the examples of section [ se : nondef ] .",
    "the classical method of proving non - definability in @xmath2 using pebble games is complete in the sense that a property is @xmath173-definable iff the class of its models is closed under game equivalence of length @xmath108 . using pebble games",
    "one proves easily that the class of structures without any relations of even cardinality , @xmath174 , is not @xmath2-definable .",
    "this can not be proven using connection matrices in the following sense :    let @xmath147 be a quantifier - free transduction between @xmath61-structures and let @xmath175 be the binary operation on @xmath61-structures : @xmath176 then the connection matrix @xmath177 satisfies the properties ( i)-(iii ) of theorem [ th : frt - tame ] .",
    "recall that we denote by @xmath178 the modular counting quantifiers @xmath6 which says that the number of elements satisfying @xmath7 equals @xmath8 modulo @xmath9 .",
    "the proof of theorem [ th : fv - cfol](ii ) follows exactly the proof of theorem 1.6 in @xcite , in which an analogous statement was proven for the ordered sum of structures .",
    "we spell out the changes needed in the proof from @xcite for the ordered product @xmath161 .    given @xmath179 and @xmath180 ,",
    "their ordered product is given by @xmath181 together with the lexicographic order @xmath182 on @xmath183 induced by @xmath184 and @xmath185 .",
    "the proof proceeds by induction and computes the reduction sequences of @xmath5-formulas for @xmath161 .",
    "reduction sequences are tuples of formulas @xmath186 obtained from a formula @xmath7 so that the truth - value of @xmath187 on @xmath7 is a boolean combination of the truth - values @xmath188 of @xmath189 on @xmath190 and the truth - values @xmath191 of @xmath192 on @xmath193 .",
    "the existence of reduction sequences directly implies smoothness .",
    "the reduction sequences and boolean functions of the atomic relations are given as follows .",
    "the difficult cases are those of the quantifiers .",
    "we discuss @xmath194 in detail . for all other cases we just state the reduction sequences and the corresponding boolean formulas .",
    "see the proof of theorem 1.6 in @xcite for a detailed discussion of @xmath195 .    for @xmath196",
    ": :     +    reduction sequence :    @xmath197 +    boolean function : @xmath198 . for @xmath199",
    ": :     +    reduction sequence :    @xmath200 +    boolean function : @xmath198 . for @xmath201",
    ": :     +    reduction sequence :    @xmath202 +    boolean function :    @xmath203 .",
    "let @xmath204 and @xmath205 be reduction sequences for @xmath7 and @xmath113 respectively , and let @xmath206 and @xmath207 be the corresponding boolean functions with disjoint variables . .    for @xmath208",
    ": :     +    reduction sequences :    @xmath209 +    boolean function :    @xmath210 . for @xmath211 : :     +    reduction sequences : @xmath147 +    boolean function : @xmath212 .",
    "now we turn to @xmath213 .",
    "we look at @xmath206 in disjunctive normal form : @xmath214 with @xmath215 and @xmath216 and @xmath217 @xmath218 has @xmath219 boolean variables , @xmath220 .",
    "we assume without loss of generality that every @xmath221 contains all of the variables .",
    "in other words , @xmath222 @xmath223 and @xmath224 for every @xmath225 .    now let : @xmath226 and similarly @xmath227    consider the formula @xmath228 .",
    "@xmath229 iff the number of pairs @xmath230 such that @xmath231 is even .",
    "@xmath231 iff @xmath218 holds for @xmath232 and @xmath233 . note that @xmath232 satisfies at most one of the @xmath234 and similarly for @xmath233 .",
    "the number of pairs @xmath235 for which @xmath218 holds is even iff the number of @xmath221 such that @xmath221 holds for an odd number of pairs @xmath235 is even .",
    "this holds iff the number of @xmath221 such that @xmath236 holds for an odd number of @xmath237 and @xmath238 holds for an odd number of @xmath239 , is even .",
    "let @xmath240 and let @xmath241 finally we put @xmath242 where @xmath243 iff @xmath244 and @xmath245 iff @xmath246 .",
    "so , we have :    for @xmath247 : :     +    reduction sequence :    @xmath248 +    boolean function :    @xmath249 . for @xmath195",
    ": :     +    reduction sequence :    @xmath250 +    boolean function :    @xmath251 .    a similar proof covers all quantifiers @xmath252 .",
    "e.g. consider the quantifiers @xmath253 . here",
    "we set , for each @xmath254 : @xmath255 where the outer @xmath256 is over tuples @xmath257 of disjoint subsets of @xmath258 , which additionally satisfy that @xmath259 for every @xmath254 , @xmath260 iff @xmath261 and @xmath262 iff @xmath263 .",
    "the reduction sequence of @xmath264 is and @xmath265 and express them using @xmath266 , @xmath267 , @xmath268 and @xmath269 , in a similar way to our treatment of @xmath194 and @xmath270 in the proof above . ] @xmath271",
    "we will prove non - definability in @xmath5 using theorem [ th : fv - cfol ] for cartesian products combined with @xmath2 transductions .",
    "it is useful to consider a slight generalization of the cartesian product as follows .",
    "we add two constant symbols @xmath272 and @xmath273 to our graphs . in @xmath274 the symbol @xmath272 is interpreted as the pair of vertices @xmath275 from @xmath276 and @xmath277 respectively such that @xmath278 is the interpretation of @xmath279 ( i.e. @xmath272 in @xmath280 ) for @xmath281 .",
    "the transduction @xmath282 transforms a digraph @xmath283 into an undirected graph whose edge relation is the symmetric closure of the edge relation of the digraph .",
    "the following transduction @xmath284 transforms the cartesian product of two directed graphs @xmath285 with the two constants @xmath286 and @xmath287 , @xmath281 into a certain digraph .",
    "it is convenient to describe @xmath284 as a transduction of the two input graphs @xmath276 and @xmath277 : @xmath288    consider the transduction @xmath289 obtained from @xmath290 by applying @xmath291 when the input graphs are directed paths @xmath292 of length @xmath293 .",
    "the input graphs look like this :        the result of the application of the transduction is given in figure [ fg : forests ] .    [",
    "cols=\"^,^,^ \" , ]      +    the result of the transduction has a bridge iff @xmath294 .",
    "it is @xmath295-connected iff @xmath296 .",
    "hence , the connection matrices of bridgelessness and of @xmath295-connectivity with directed paths as row and column labels have infinite rank .",
    "the properties of being bridgeless or @xmath295-connected are not @xmath5-definable even in the presence of linear order .    for any @xmath297 ,",
    "if we join @xmath298 to the result of @xmath299 we get non - definability of @xmath300-connectivity , so we have :    for every @xmath301 , the property of being @xmath300-connected is not @xmath5-definable even in the presence of linear order .",
    "considering the connection matrix where the rows and columns are labeled by the graphs on @xmath302 vertices but without edges @xmath303 , the graph @xmath304 is    1 .",
    "hamiltonian iff @xmath305 ; 2 .   has a perfect matching iff @xmath305 ; 3 .",
    "is a cage graph ( a regular graph with as few vertices as possible for its girth ) iff @xmath305 ; 4 .   is a well - covered graph ( every minimal vertex cover has the same size as any other minimal vertex cover ) iff @xmath305 .",
    "all of these connection matrices have infinite rank , so we get    [ co : ms1 ] none of the properties above are @xmath0-definable as graphs even in the presence of an order .    using a modification @xmath306 of the join operation from ( * ? ? ?",
    "* remark 5.21 , page 350 ) one can show the same for the class of graphs which have a spanning tree of degree at most @xmath34 .",
    "let @xmath39 and @xmath141 be graphs .",
    "let @xmath307 be the vertices of @xmath141 .",
    "@xmath308 is obtained from @xmath309 by taking two additional copies @xmath310 and @xmath311 of @xmath141 with vertices of the form @xmath312 , @xmath313 or @xmath314 respectively , and adding , for every @xmath315 , the edges @xmath316 and @xmath317 . if @xmath318 and @xmath319 are edgeless graphs with @xmath302 respectively @xmath143 vertices , then @xmath308 has a spanning tree of degree at most @xmath34 iff @xmath320 .",
    "the operation @xmath306 is @xmath3-smooth over the vocabulary of graphs since it can be defined as a transduction of the rich disjoint union of @xmath39 and @xmath141 .",
    "the connection matrix of @xmath308 and the property of having a spanning tree of degree at most @xmath34 has infinite rank , implying that the property is not @xmath3-definable in the vocabulary of graphs .    for any fixed natural number @xmath321 , by performing a transduction on @xmath308 which attaches @xmath322 new vertices as pendants to each vertex of @xmath308",
    ", the non - definability result extends to the class of graphs which have a spanning tree of degree at most @xmath323 .    for the language of hypergraphs we can not use the join operation , since it is not smooth .",
    "note also that hamiltonian and having a perfect matching are both definable in @xmath0 in the language of hypergraphs . but using the connection sub - matrices of the disjoint union we still get :    1 .",
    "regular : @xmath324 is regular iff @xmath305 ; 2 .",
    "a generalization of regular graphs are _ bi - degree _ graphs , i.e. , graphs where every vertex has one of two possible degrees .",
    "@xmath325 is a bi - degree graph iff @xmath305 .",
    "the average degree of @xmath324 is at most @xmath36 iff @xmath305 ; 4 .",
    "a digraph is _ aperiodic _ if the common denominator of the lengths of all cycles in the graph is @xmath37 .",
    "we denote by @xmath326 the directed cycle with @xmath8 vertices . for prime numbers",
    "@xmath327 the digraphs @xmath328 is aperiodic iff @xmath329 .",
    "a graph is _ asymmetric ( or rigid ) _ if it has no non - trivial automorphisms .",
    "it was shown by p. erds and a. rnyi @xcite that almost all finite graphs are asymmetric .",
    "so there is an infinite set @xmath330 such that for @xmath331 there is an asymmetric graph @xmath332 of cardinality @xmath8 .",
    "@xmath333 is asymmetric iff @xmath334 .",
    "[ co : ms2 ] none of the properties above are @xmath0-definable as hypergraphs even in the presence of an order .",
    "the case of asymmetric graphs illustrates that it is not always necessary to find explicit infinite families of graphs whose connection matrices are of infinite rank in order to show that such a family exists .",
    "[ se : solpol ]      here we follow closely the exposition from @xcite .",
    "let @xmath103 be a tame fragment of @xmath18 .",
    "we are now ready to introduce the @xmath103-definable polynomials .",
    "they are defined for @xmath61-structures and generally are called _ @xmath104 invariants _ as they map @xmath61-structures into some commutative semi - ring @xmath335 , which contains the semi - ring of the integers @xmath336 , and are invariant under @xmath61-isomorphisms .",
    "if @xmath61 is the vocabulary of graphs or hypergraphs , we speak of graph invariants and graph polynomials .    for our discussion @xmath337 or @xmath338 suffices , but the definitions generalize .",
    "our polynomials have a fixed finite set of variables ( indeterminates , if we distinguish them from the variables of @xmath103 ) , @xmath339 .",
    "[ def : monomials - simple ] let @xmath340 be a @xmath61-structure .",
    "elements of @xmath341 are @xmath104-definable simple @xmath340-monomials .",
    "[ def : monomials ] let @xmath340 be a @xmath61-structure .",
    "we define the @xmath104-definable _ @xmath340-monomials _ inductively .",
    "@xmath104-definable simple monomials are @xmath104-definable monomials .",
    "let @xmath342 be a @xmath343-formula in @xmath103 , where @xmath344 is a constant symbol not in @xmath61 and @xmath345 is a unary relation symbol .",
    "let @xmath43 be a simple monomial .",
    "then @xmath346 is a @xmath104-definable @xmath340-monomial .",
    "finite products of @xmath104-definable monomials and simple monomials are @xmath104-definable monomials .",
    "note the degree of a monomial is polynomially bounded by the cardinality of  @xmath340 .",
    "[ def : polynomials ] the @xmath340-polynomials definable in @xmath104 are defined inductively :    @xmath104-definable monomials are @xmath104-definable polynomials .",
    "let @xmath347 be a @xmath348-formula in @xmath103 where @xmath349 be a finite sequence of constant symbols not in @xmath61 .",
    "let @xmath43 be a @xmath350-polynomial .",
    "then @xmath351 is a @xmath104-definable polynomial .",
    "let @xmath352 be a @xmath353-formula in @xmath103 where @xmath354 be a finite sequence of relation symbols not in @xmath61 .",
    "let @xmath43 be a @xmath355-polynomial definable in @xmath103 .",
    "then @xmath356 is a @xmath104-definable polynomial .",
    "the polynomial @xmath43 may depend on relation or function symbols occurring in @xmath7 .",
    "an @xmath340-polynomial @xmath357 is an expression with parameter @xmath340 .",
    "the family of polynomials , which we obtain from this expression by letting @xmath340 vary over all @xmath61-structures , is called , by abuse of terminology , a @xmath104-polynomial .",
    "the quantifier rank of a @xmath104-polynomial @xmath358 is the maximal quantifier rank of the formulas defining @xmath358 .    among the @xmath103-definable polynomials we find most of the known graph polynomials from the literature , cf .",
    "@xcite .",
    "the matching generating polynomial of a graph @xmath39 is the generating function of matchings in @xmath39 : @xmath359 where @xmath360 is the number of matchings of size @xmath8 of @xmath39 .",
    "@xmath361 is an @xmath3-polynomial given by @xmath362 where @xmath363 is any tautology , @xmath364 , and @xmath365 .",
    "the monomial @xmath366 depends on @xmath367 .",
    "we simplify the notation by writing @xmath368    _ @xmath103-definable numeric graph parameters _ are evaluations of @xmath103-definable polynomials and take values in @xmath335 .",
    "_ @xmath103-definable properties _ are special cases of numeric parameters which have boolean values .",
    "[ rm : fol - param ] for @xmath2- and @xmath5-parameters , the formulas must not contain any second order variables .",
    "therefore , sums of the form @xmath369 are not allowed , while sums of the form @xmath370 are allowed . moreover , the monomials are required to be simple monomials .      for the proof of the finite rank theorem for @xmath103-polynomials which involve second order variables it is not enough that the binary operation @xmath29 on @xmath61-structures is @xmath103-smooth .",
    "we need a way to uniquely decompose the relation over which we perform summation in @xmath165 into relations in @xmath128 and @xmath129 respectively , from which we can reconstruct the relation in @xmath165 . for our discussion here it suffices to restrict @xmath29 to _ @xmath103-sum - like operations_. @xmath165 is _ @xmath103-sum - like _ if there is a _ scalar _",
    "@xmath103-transduction @xmath147 such that @xmath371 an operation is _ @xmath103-product - like _",
    "if instead of scalar transductions we also allow _ vectorized _ transductions .",
    "typically , the cartesian product is @xmath2-product - like , but not sum - like .",
    "the @xmath21-sum and the join operation on graphs are @xmath2-sum - like ( but , in the case of join , not on hypergraphs ) .",
    "in remark [ rm : fol - param ] we required that @xmath5-parameters only have simple monomials .",
    "we did so because the feferman - vaught theorem and the finite rank theorem for @xmath161 do not hold when allowing general monomials .",
    "let @xmath5-polynomials be the extension of @xmath5-parameters by allowing monomials which are not simple .",
    "for example , consider the following @xmath5-polynomial , which is not a @xmath5-parameter : @xmath372 the connection matrix @xmath373 restricted to @xmath303 , the edgeless graphs , has entries @xmath374 , is a vandermonde matrix and therefore has infinite rank .",
    "the graph polynomial @xmath375 does not satisfy a bilinear reduction theorem such as theorem [ th : fv - disjoint - union ] .",
    "assume there is a polynomial @xmath376 , and @xmath5-polynomials @xmath377 such that @xmath378 let @xmath379 where @xmath303 is the edgeless graph with @xmath302 vertices .",
    "by definition of @xmath5-polynomials , @xmath380 has degree at most @xmath302 in @xmath339 .",
    "therefore , @xmath381 @xmath382 has degree at most @xmath383 in @xmath339 for some @xmath384 .",
    "in contrast , @xmath385 .",
    "therefore , it can not be the case that there is such @xmath376 .",
    "now we can state the finite rank theorem for @xmath103-polynomials .",
    "the proof uses the same techniques as in @xcite .",
    "[ maintheorem ]   + let @xmath103 be a tame fragment of @xmath18 such that @xmath159 is @xmath386-smooth and @xmath29 be an @xmath103-sum - like operation between @xmath61-structures .",
    "let @xmath1 be a @xmath104-polynomial .",
    "then the connection matrix @xmath387 has finite rank .",
    "the proof is given in section [ se : cmsol - pol - fv ] in @xcite the theorem was only formulated for @xmath21-sums , and the join operation and for the logic @xmath0 .",
    "[ maintheorem - fo ]   + let @xmath388 be an @xmath5-product - like operation between @xmath61-structures .",
    "let @xmath1 be an @xmath389-parameter .",
    "then the connection matrix @xmath390 has finite rank .",
    "the proof of theorem [ maintheorem - fo ] is similar to that of theorem [ maintheorem ] .",
    "in this section we prove an analogue of the feferman - vaught theorem for sum - like operations , theorem [ maintheorem ] .",
    "we start by explicitly giving a feferman - vaught theorem for the matching polynomial , proceed with the case of rich disjoint union , and end with all sum - like operations .      as an example",
    ", we prove here a feferman - vaught theorem for the matching generating polynomial with the @xmath37-sum operation .",
    "@xmath391 is a polynomial in @xmath392 $ ] . as we need a field we work in the field of rational functions @xmath393 .",
    "we will need the following auxiliary graph polynomials whose inputs are @xmath37-labeled graphs @xmath394 : @xmath395 where @xmath396 says that @xmath397 is incident to an edge of @xmath367 .",
    "the definition of @xmath391 in equation ( [ eq : matching - pol ] ) extends to @xmath37-labeled graphs @xmath394 naturally by ignoring the label on @xmath397 . for a @xmath37-labeled graph @xmath394 , @xmath398 and @xmath399",
    "let @xmath400 .",
    "there exists a polynomial @xmath401 $ ] such that for any two @xmath37-labeled graphs @xmath394 and @xmath402 , @xmath403    there exist a matrix @xmath404 such that @xmath376 can be written as the bilinear form @xmath405    ( i ) : a matching @xmath367 of @xmath406 is a disjoint union of two matchings @xmath407 and @xmath408 of @xmath39 and @xmath141 respectively such that at most one of @xmath407 and @xmath408 is incident to @xmath397 respectively @xmath409 .",
    "@xmath410 is the generating function of matchings @xmath411 such that one of @xmath407 and @xmath408 is incident to @xmath397 respectively @xmath412 .",
    "analogously , @xmath413 is the generating function of matchings @xmath411 such that both @xmath407 and @xmath408 are not incident to @xmath397 respectively @xmath409 .",
    "so we have : @xmath414 the theorem holds with the polynomial @xmath415 ( ii ) : the matrix @xmath133 can be taken to be @xmath416    the connection matrix @xmath417 has rank @xmath295 .",
    "the connection matrix @xmath418 is spanned by two rows which correspond to @xmath419 and @xmath420 .",
    "hence , the rank of @xmath417 is a t most @xmath295 .",
    "the matrix @xmath133 turns out to be a @xmath421-matrix due to a good choice of auxiliary graph polynomials .",
    "if we replace @xmath422 by @xmath423 where @xmath134 is any @xmath424-matrix over @xmath393 , we get @xmath425 with @xmath426 where @xmath427 can have arbitrary entries from @xmath393 .      here",
    "we prove a feferman - vaught - type theorem for rich disjoint union and structures of some vocabulary @xmath61 .",
    "we do this for @xmath104-polynomials of the form @xmath428 where @xmath429 are @xmath103-sentences over the appropriate expansion of @xmath61 .",
    "generalization to all @xmath104-polynomials is not hard using the normal form lemma for @xmath103-polynomials , lemma [ lem : normal - form ] :    [ lem : normal - form ] let @xmath103 be a fragment of @xmath18 .",
    "let @xmath358 be a @xmath104-polynomial .",
    "then there exist @xmath430 , @xmath103-formulas @xmath431 , and @xmath432 , and @xmath433 such that @xmath434 where @xmath435 and @xmath436 .",
    "the monomials of @xmath103-polynomials are already in the desired form .",
    "to prove lemma [ lem : normal - form ] , the main property of @xmath386 that we use here is closure under conjunction which allows us to eliminate nested sums .",
    "the following is well known @xcite :    [ prop : theta ] let @xmath386 be a fragment of @xmath18 .",
    "let @xmath61 be a vocabulary .",
    "for every @xmath437 there is a finite set @xmath438 of @xmath439-sentences of quantifier rank @xmath108 such that :    every @xmath440 has a model ;    the conjunction of any two sentences @xmath441 is not satisfiable ;    every @xmath439 sentence @xmath113 of quantifier rank at most @xmath108 is equivalent to exactly one finite disjunction of sentences in @xmath438 ;    every finite @xmath61-structure @xmath128 satisfies exactly one sentence @xmath442 of @xmath438 .",
    "proposition [ prop : theta ] uses that @xmath386 is fragment and therefore @xmath443 is finite up to equivalence and is closed under boolean operations .",
    "the following proposition reformulating @xmath386-smoothness follows directly from the definition of @xmath386-smoothness in section [ se : framework ] and proposition [ prop : theta ] :    [ prop : reform ] let @xmath386 be a fragment of @xmath18 such that @xmath159 is @xmath386-smooth .",
    "let @xmath444 and @xmath445 be a vocabularies and let @xmath142 be the vocabulary of the rich disjoint union of a @xmath444-structure and @xmath445-structure .",
    "there exists a function @xmath446 such that for every two @xmath444-structures @xmath128 and @xmath129 , @xmath447 we write @xmath448 rather than @xmath449 when @xmath450 .    in the proof of theorem [ th : fv - disjoint - union ] we will use @xmath142 with various subscripts to denote vocabularies which correspond to structures obtained as rich disjoint unions , and @xmath61 with various subscripts to denote vocabularies of pre - union structures ) .",
    "[ th : fv - disjoint - union ] let @xmath386 be a tame fragment of @xmath18 such that @xmath159 is @xmath386-smooth .",
    "let @xmath61 be a vocabulary and let @xmath142 be the vocabulary of the rich disjoint union of @xmath61-structures .",
    "let @xmath358 be a @xmath451-polynomial in the form of equation ( [ eq : p ] ) .",
    "there exist @xmath452 , @xmath439-polynomials @xmath453 and a polynomial @xmath454 $ ] such that    for any two @xmath61-structures @xmath128 and @xmath129 @xmath455    @xmath456 can be written as a bilinear form @xmath457 where the matrix @xmath367 has as entries polynomials with coefficients from @xmath458 and is independent of the @xmath61-structures .    in the following proof ,",
    "the graph polynomials @xmath459 as well as @xmath358 all have the same quantifier rank @xmath460 and hence @xmath43 can be taken as the number @xmath461 of @xmath451-polynomials of quantifier rank at most @xmath460 , which is finite .",
    "let @xmath108 be the maximum quantifier rank of @xmath431 , @xmath462 and @xmath463 .    by definition of @xmath358 , @xmath464",
    "is given by @xmath465 consider the summation in equation ( [ eq : two - prods ] ) .",
    "it is a sum over all @xmath466 such that @xmath467 .",
    "there is a unique partition @xmath468 .",
    "we have that @xmath467 iff @xmath469 by the definition of rich disjoint union .",
    "let @xmath470 be the vocabulary of @xmath471 and @xmath472 , and let @xmath473 be the vocabulary of @xmath474 . by proposition [ prop : reform ] , there exists @xmath475 such that @xmath476 hence we can write : in @xmath477 in the following formula denotes that @xmath478 entails @xmath431 .",
    "( note that the notation @xmath479 is usually used in this paper in expressions such as @xmath480 , where @xmath479 denotes that the structure @xmath128 satisfies @xmath7 . ) ] @xmath481    now consider e.g. the product @xmath482 .",
    "it is a product over all @xmath483 such that @xmath484 again this condition can be written as a condition on a rich disjoint union of two structures : @xmath485 iff @xmath486 .",
    "let @xmath487 and @xmath488 be the vocabularies of @xmath489 and @xmath490 respectively .",
    "the vocabulary of @xmath491 is @xmath470 .",
    "using proposition [ prop : reform ] there exists a function @xmath492 such that @xmath493 for every @xmath494 , let @xmath495 @xmath496 is an @xmath497-formula .    if @xmath498 , then @xmath499 similarly , there exist @xmath497-formulas @xmath500 , @xmath501 and @xmath502 such that if @xmath498 , then @xmath503 and if @xmath504 , then @xmath505    for every two @xmath506-sentence @xmath507 and @xmath508 and every hintikka sentence @xmath509 ,",
    "let @xmath510 be the following @xmath439-polynomial : @xmath511 note that @xmath510 is a @xmath386-polynomial over the vocabulary @xmath61 with quantifier rank @xmath108 . then using eq .",
    "( [ eq : with - theta ] ) we have @xmath512    let @xmath513 and let @xmath514 be a bijection .",
    "for each @xmath515 , denote @xmath516 and let @xmath517 and @xmath518 .",
    "we set @xmath519 and the theorem follows .",
    "the matrix @xmath520 is given explicitly as @xmath521    if the statement of theorem [ th : fv - disjoint - union ] is changed such that instead of rich disjoint union we take simple disjoint union , and correspondingly , @xmath358 has vocabulary @xmath61 , then the theorem holds as well . additionally , there are polynomials @xmath522 $ ] such that @xmath523 and @xmath524 can be written in bilinear form . here",
    "we use the fact that the number of @xmath439-polynomials with a fixed quantifier rank bound on their formulas and any fixed set of indeterminates is finite .",
    "this follows from the fact that the same is true for the number of formulas of any fixed vocabulary and quantifier rank .    as a consequnce of theorem [ th : fv - disjoint - union ]",
    "we have :    let @xmath103 be a tame fragment of @xmath18 such that @xmath159 is @xmath386-smooth .",
    "let @xmath358 be a @xmath451-polynomial in the form of equation ( [ eq : p ] ) .",
    "then the connection matrix @xmath525 has finite rank over the field of rational functions with indeterminates @xmath339 and @xmath526 .",
    "the entries of @xmath525 are polynomial , and hence we consider the rank of @xmath525 over the field of rational functions .",
    "note that for every evaluation @xmath527 of @xmath358 such that @xmath528 belong to some subfield @xmath20 of @xmath529 , the matrix @xmath530 has finite rank over @xmath20 .",
    "theorem [ th : fv - disjoint - union ] remains true when interpret the @xmath386-polynomials not over the ring @xmath458 with the standard @xmath531 and @xmath532 , but over other rings and semirings .",
    "stated explicitly , the following is true :    let @xmath103 be a tame fragment of @xmath18 such that @xmath159 is @xmath386-smooth .",
    "let @xmath533 be a semiring .",
    "let @xmath358 be a @xmath451-polynomial in the form of equation ( [ eq : p ] ) .",
    "there exist @xmath452 , @xmath439-polynomials @xmath453 and a polynomial @xmath534 $ ] such that    for any two @xmath61-structures @xmath128 and @xmath129 @xmath455    @xmath456 can be written as a bilinear form @xmath457 where the matrix @xmath367 has as entries polynomials with coefficients from in @xmath533 and is independent of the @xmath61-structures .",
    "for instance , the above holds for @xmath535 with @xmath536 and @xmath531 as the semiring s addition and multiplication , respectively , cf .",
    "note , however , that it is not immediately clear how to extend the finite rank theorem to this context , since ranks of matrices over semirings can be defined in various ways .",
    "the bilinear reduction theorem for semirings has found applications in the theory of weighted ( aka multiplicity ) automata , cf .",
    "@xcite .      here",
    "we prove a feferman - vaught - type theorem for sum - like operations .",
    "let @xmath537 and @xmath61 be vocabularies and let @xmath142 be the vocabulary of the disjoint union of two @xmath61-structures .",
    "let @xmath103 be a tame fragment of @xmath18 such that @xmath159 is @xmath386-smooth and @xmath29 be an @xmath103-sum - like operation between @xmath61-structures .",
    "let @xmath358 be a @xmath538-polynomial in the form of equation ( [ eq : p ] ) .",
    "there exists a polynomial @xmath539 $ ] and @xmath439-polynomials @xmath453 such that    for any two @xmath61-structures @xmath128 and @xmath129 @xmath540    @xmath456 can be written as a bilinear form .",
    "let @xmath147 be a scalar @xmath103-transduction from @xmath541 structures to @xmath537 structures such that @xmath542 using theorem [ th : fv - disjoint - union ] it is enough to show that there exists a @xmath451-polynomial @xmath543 such that @xmath544 let @xmath545 be the formula of @xmath147 which defines the universe of the transduction .",
    "such @xmath543 is given by @xmath546 where we consider @xmath547 and @xmath548 in @xmath431 , @xmath462 and @xmath463 as free variables for the purpose of applying the map @xmath149 .",
    "we use here that @xmath386 is tame and therefore closed under transductions and containments .",
    "let @xmath358 be a @xmath538-polynomial in the form of equation ( [ eq : p ] ) .",
    "then the connection matrix @xmath549 has finite rank over the field of rational functions with indeterminates @xmath339 and @xmath526 .",
    "again evaluations of @xmath358 have finite rank over the relevant subfield of @xmath529 .",
    "using the finite rank theorems requires showing that connection matrices have infinite rank . in the case of numeric @xmath61-invariants and @xmath61-polynomials , a simple technique for obtaining infinite rank is by showing that @xmath19 is @xmath29-maximizing or @xmath29-minimizing .",
    "we will also use other techniques .",
    "we say a @xmath61-parameter @xmath19 is _ @xmath29-maximizing _ ( _ @xmath29-minimizing _ ) if there exist an infinite sequence of non - isomorphic @xmath61-structures @xmath550 @xmath551 such that for any @xmath552 , @xmath553 furthermore , if @xmath19 is unbounded on @xmath554 then @xmath19 is _ unboundedly @xmath29-maximizing_. analogously we define _",
    "( unboundedly ) @xmath29-minimizing_.    [ p : maxmin ] if @xmath19 is a unboundedly @xmath29-maximizing ( @xmath29-minimizing ) @xmath61-parameter , then @xmath555 has infinite rank .      using proposition [ p : maxmin ] , theorem [ maintheorem ] and proposition [ p : fol-1 ] we show that many @xmath61-parameters are not @xmath0-definable :    [ p : max ] the following graph parameters are not @xmath0-definable in the language of hypergraphs .",
    "+ _ spectral radius , chromatic number , acyclic chromatic number , arboricity , star chromatic number , clique number , hadwiger number , hajs number , tree - width , path - width , clique - width , edge chromatic number , total coloring number , thue number , maximum degree , circumference , longest path , maximal connected planar ( bipartite ) induced subgraph , boxicity , minimal eigenvalue , spectral gap , girth , degeneracy , _ and _ minimum degree_.    all these graph parameters @xmath556 are unboundedly @xmath557-maximizing or @xmath557-minimizing .",
    "variations of the notions of @xmath29-maximizing or @xmath29-minimizing @xmath61-parameters can also lead to non - definability results , e.g. :    the number of connected components ( blocks , simple cycles , induced paths ) of maximum ( minimum ) size is not @xmath0-definable in the language of hypergraphs .    consider the connection matrix with respect to the operation of disjoint union of graphs @xmath558 which consists of the disjoint union of @xmath8 cliques of size @xmath8 .",
    "we denote the number of connected components of maximum size in a graph @xmath39 by @xmath559 .",
    "then @xmath560 so @xmath561 is of infinite rank .",
    "the other cases are proved similarly",
    ".    in section [ se : means ] we discuss the rank of connection matrices of various graph parameters based on averages , such as the average degree , and many others .",
    "these are examples where the computation of the rank is a bit more sophisticated .      here",
    "we use the method of connection matrices for showing that ( hyper)graph polynomials are not @xmath3-definable .",
    "some of the material here is taken from the first author s thesis @xcite .",
    "as examples we consider the polynomials @xmath46 , @xmath41 , and @xmath49 , which were defined in the introduction .    to show that none of @xmath46 , @xmath41 , or @xmath49 are @xmath0-polynomials in the language of graphs , and that neither @xmath46 nor @xmath49 are @xmath0-polynomials in the language of hypergraphs , we prove the following general proposition :    [ lm : non - def - gp ] given a @xmath61-parameter @xmath358 , a binary operation @xmath29 on @xmath61-structures and an infinite sequence of non - isomorphic @xmath61-structures @xmath562 , let @xmath563 be an unbounded function such that one of the following occurs :    [ item:1 ] for every @xmath564 , @xmath565 iff @xmath566 .",
    "[ item:2 ] for every @xmath564 , @xmath567 iff @xmath566",
    ".    then the connection matrix @xmath549 has infinite rank .",
    "let @xmath564 and let @xmath568 be the graph parameter given by @xmath569 . if ( [ item:1 ] ) holds , consider the restriction @xmath570 of the connection matrix @xmath571 to the rows and columns corresponding to @xmath572 , @xmath573 .",
    "if ( [ item:2 ] ) holds , consider the restriction @xmath570 of @xmath571 to to the rows corresponding to @xmath574 and the columns corresponding to @xmath575 , @xmath573 . in both cases",
    "@xmath570 is a finite triangular matrix with non - zero diagonal .",
    "hence the rank of @xmath571 is at least @xmath576 .    using that @xmath19 is unbounded",
    ", we get that @xmath549 contains infinitely many finite sub - matrices with ranks which tend to infinity .",
    "hence , the rank of @xmath549 is infinite ,    we now use lemma [ lm : non - def - gp ] to compute connection matrices where @xmath29 is the disjoint union @xmath557 , the @xmath37-sum @xmath577 or the join @xmath33 .",
    "in addition to the graph polynomials introduced in the introduction , we consider the definability of some _ @xmath578-polynomials _ denoted @xmath579 where @xmath578 is a graph property .",
    "@xmath579 counts vertex @xmath21-colorings @xmath42 $ ] such that for every color @xmath580 $ ] , the graph @xmath581 induced by the vertices colored @xmath548 under @xmath19 belongs to @xmath578 .",
    "such colorings were introduced by f. harary , cf .",
    "several of the colorings presented so far are @xmath578- colorings for appropriate choices of @xmath578 .",
    "the following connection matrices have infinite rank :    @xmath582 ;    for every @xmath583 the matrix @xmath584 ;    @xmath585    @xmath586 ;    @xmath587 ;    @xmath588 ;    @xmath589 ;    @xmath590 ;    @xmath591 ;    @xmath592 ;    for every @xmath583 the matrix @xmath593 ;    @xmath594 ;    @xmath595 .",
    "for @xmath38 we use the fact that join of cliques is again a clique , @xmath596 and that @xmath597 iff @xmath598 .    in a similar fashion , for @xmath41 we use cliques and that @xmath599 iff @xmath600",
    ".    for @xmath44 we use cliques .",
    "we have @xmath601 iff @xmath602 .",
    "for @xmath603 we use cliques and the fact that @xmath604 iff @xmath605 .    for @xmath606",
    "we use cliques and the fact that @xmath607 iff @xmath605 .    for @xmath608",
    "we use cliques and the fact that @xmath609 iff @xmath605 .    for @xmath610",
    "we use cliques and the fact that @xmath611 iff @xmath612 .    for @xmath613",
    "we use cliques and the fact that @xmath614 iff @xmath615 .    for @xmath46 , we use that the @xmath37-sum of paths with one end labeled is again a path with @xmath616 and that @xmath617 iff @xmath618 .    for @xmath49",
    ", we use edgeless graphs and disjoint union @xmath619 and that @xmath620 iff @xmath598 .    for @xmath50",
    "we use cliques and that @xmath621 iff @xmath622    for @xmath51 we use that @xmath37-sum of stars @xmath623 is again a star .",
    "we have @xmath624 iff @xmath602 .",
    "for @xmath55 we use the graphs @xmath625 consisting of @xmath302 disjoint edges .",
    "we have @xmath626 iff @xmath627 .",
    "@xmath38 , @xmath41 ( for any fixed @xmath628 ) , @xmath44 , @xmath603 , @xmath606 , @xmath608 , @xmath610 and @xmath613 are not @xmath0-definable in the language of graphs .",
    "@xmath46 , @xmath49 , @xmath51 , and @xmath50 ( for any fixed @xmath628 ) are not @xmath0-definable in the languages of graphs and hypergraphs .",
    "\\(i ) the join is @xmath0-sum - like and @xmath0-smooth for graphs ( but not for hypergraphs ) .",
    "( ii ) the @xmath37-sum and the disjoint union are @xmath0-sum - like and @xmath0-smooth for graphs and hypergraphs .      maximization and minimization",
    "can sometimes be thought of as a type of mean .",
    "for example , the maximal ( minimal ) degree of a graph is obtained from the generalized mean @xmath629 when @xmath358 tends to @xmath630 ( @xmath631 ) .",
    "other instances of the generalized mean also lead to infinite connection matrices ranks .",
    "in particular , below we show examples for @xmath632 , @xmath633 and @xmath634 .",
    "the following lemma will be useful :    [ lem : rankprop ] let @xmath29 be any binary operation between @xmath61-structures .",
    "the @xmath29-connection matrix of a linear combination of @xmath61-invariants with @xmath29-connection matrices of finite rank is of finite rank .",
    "the @xmath29-connection matrix of a finite product of @xmath61-invariants with @xmath29-connection matrices of finite rank is of finite rank",
    ".       follows from the sub - additivity of the rank of matrices .",
    "it is enough to prove the claim for the product of two graph invariants , @xmath19 and @xmath556 .",
    "denote the @xmath29-connection matrices of @xmath19 and @xmath556 by @xmath367 and @xmath570 respectively .",
    "since @xmath367 and @xmath570 are of finite rank , there exists @xmath635 such that for every @xmath636 , the row @xmath637 is a linear combination of the rows @xmath638 and @xmath639 is a linear combination of the rows @xmath640 .",
    "hence , for every @xmath636 there exist @xmath641 such that for every @xmath642 , @xmath643 hence , @xmath644 so , @xmath645 is spanned by @xmath646 rows .",
    "let @xmath647 denote the average degree : @xmath648    the rank of @xmath649 is infinite .    to see this , look at the connection matrix @xmath649 , whose entries can be expressed as follows : @xmath650 the sub - matrix of @xmath649 which consists only of rows and columns corresponding to graphs with exactly one edge is the cauchy matrix @xmath651 , hence the rank of @xmath649 is infinite .",
    "we can prove a similar statement for other graph parameters given as arithmetic means :    [ p : averages ] the following arithmetic means have @xmath557-connection matrices of infinite rank :    for every @xmath636 , the average size of the @xmath8-th neighborhood of vertices @xmath652 , @xmath653 .",
    "average number of simple cycles in which vertices @xmath652 occur .",
    "average number of triangles in which vertices @xmath652 occur .",
    "average size of connected component in which vertices @xmath652 occur .",
    "average number of edges incident to an edge @xmath654 .",
    "average number of cycles which include @xmath654 .    for every @xmath655 , the average number of @xmath8-paths which include @xmath654 .",
    "let the quadratic mean of the degrees of vertices @xmath652 be @xmath656    the rank of @xmath657 is infinite .",
    "@xmath658 has infinite connection matrix rank with respect to @xmath557 by looking again at graphs with exactly one edge .",
    "again , @xmath659 has entries @xmath660 .",
    "hence , by lemma [ lem : rankprop ] , @xmath661 has infinite rank .    with similar proofs",
    ", we have :    the corresponding quadratic means to those in proposition [ p : averages ] have @xmath557-connection matrices of infinite rank .",
    "let the harmonic mean of the degrees of vertices @xmath652 be @xmath662 we only consider graphs with no isolated vertices in order to avoid devision by zero .",
    "the rank of @xmath663 is infinite .",
    "note that @xmath664 and consider @xmath665 for every function @xmath666 , let @xmath667 be the matrix such that the entry in row @xmath8 and column @xmath668 is @xmath669 .",
    "assume @xmath670 is of finite rank .",
    "then @xmath671 is of finite rank .",
    "clearly , @xmath672 is also of finite rank , since @xmath673 is obtained from @xmath674 by multiplying each row @xmath8 of @xmath674 by a scalar @xmath675 .",
    "the matrix @xmath676 is of row rank @xmath37 because all of its rows are equal .",
    "so , @xmath677 is of finite rank by lemma [ lem : rankprop ] .",
    "the matrix @xmath678 is of row rank @xmath295 , since it is spanned by the vectors @xmath679 and @xmath680 .",
    "so , @xmath681 is of finite rank again by lemma [ lem : rankprop ] .",
    "now notice @xmath682 hence , we have that @xmath683 is of finite rank , but @xmath684 is a cauchy matrix and is therefore of infinite rank , in contradiction .      here",
    "we discuss definability and non - definability of @xmath61-parameters in @xmath5 .",
    "recall from section [ se : solpol ] that formulas in @xmath5-parameters may not have second order variables .",
    "examples of @xmath5-parameters @xmath685 , @xmath686 , in the vocabulary of graphs : @xmath687 where @xmath688 is the set of vertices of @xmath39 adjacent to all other vertices , @xmath689 is the generating function of the degrees of vertices in @xmath39 , and @xmath690 is the number of vertices of odd degree .    on the other hand , we can use theorem [ maintheorem - fo ] to show non - definability of @xmath5-parameters :    [ prop : fo - non - def - poly ] the following are not @xmath5-definable :    the number @xmath691 of spanning forests    the number @xmath692 of spanning trees .    the number @xmath693 of cycles in @xmath39 .    the number @xmath694 of connected components in @xmath39 .    the tree - width @xmath695 of @xmath39 .    the number @xmath696 of blocks of @xmath39 .",
    "we use the constructions from section [ se : fol ] .",
    "the number of spanning forests @xmath697 in the graph from figure [ fg : forests ] , the graph obtained by applying @xmath289 to two directed paths of length @xmath698 and @xmath699 , is @xmath37 if @xmath700 , and is @xmath698 if @xmath701 .",
    "hence , @xmath702 has infinite rank . since @xmath289 is a @xmath5-product - like operation , @xmath697 is not @xmath5-definable .",
    "the other cases are similar .",
    "we describe them shortly .",
    "we use @xmath703 from figure [ fg : trees ] .",
    "the graph is connected iff @xmath704 , implying that the connection matrix of the number of spanning trees is zero below the diagonal and non - zero otherwise , so has infinite rank .",
    "we use @xmath289 from figure [ fg : forests ] again .",
    "we have @xmath705 iff @xmath701 , otherwise @xmath706 .",
    "hence the connection matrix of @xmath693 has @xmath295 on the diagonal and @xmath37 otherwise .",
    "consequently it has infinite rank .",
    "we use @xmath703 from figure [ fg : trees ] .",
    "we have @xmath707 if @xmath704 and @xmath708 otherwise .",
    "hence , the connection matrix of @xmath694 so has infinite rank .",
    "we use @xmath709 from figure [ fg : planar ] .",
    "we have @xmath710 iff @xmath700 , and otherwise @xmath711 .",
    "we use @xmath299 from figure [ fg : bridgeless ] .",
    "we have @xmath712 if @xmath713 , @xmath714 if @xmath715 and otherwise @xmath716 .",
    "we are grateful for the detailed feedback from the referees which allowed us to improve the presentation of the paper .",
    "n.  alon , j.  grytczuk , m.  hauszczak , and o.  riordan .",
    "nonrepetitive colorings of graphs . in m.",
    "kronski , j.  spencer , and a.  ruciski , editors , _ proceedings of the 10th international conference on random structures and algorithms _ ,",
    "volume 21 , 34 of _ random structures and algorithms _ , pages 336346 , danvers , ma , august  610 2002 .",
    "wiley periodicals .",
    "b.  courcelle .",
    "graph rewriting : an algebraic and logic approach . in j.",
    "van leeuwen , editor , _ handbook of theoretical computer science _",
    ", volume  2 , chapter  5 , pages 193242 .",
    "elsevier science publishers , 1990 .                k.  edwards . the harmonious chromatic number and the achromatic number . in r.  a. bailey , editor , _",
    "survey in combinatorics _ , volume 241 of _ london math .",
    "lecture note ser .",
    "_ , pages 1347 .",
    "cambridge univ .",
    "press , 1997 .",
    "b.  godlin , t.  kotek , and j.a .",
    "evaluation of graph polynomials . in _",
    "34th international workshop on graph - theoretic concepts in computer science , wg08 _ , volume 5344 of _ lecture notes in computer science _ , pages 183194 , 2008 .",
    "f.  harary .",
    "conditional colorability in graphs . in _ graphs and applications : proceedings of the first colorado symposium on graph theory ( boulder , colo . , 1982 )",
    "_ , pages 127136 .",
    "wiley - intersci .",
    "publ . , wiley , new york , 1985 .",
    "t.  kotek , j.a .",
    "makowsky , and b.  zilber . on counting generalized colorings .",
    "in m.  grohe and j.a .",
    "makowsky , editors , _ model theoretic methods in finite combinatorics _ ,",
    "volume 558 of _ contemporary mathematics _ ,",
    "pages 207242 .",
    "american mathematical society , 2011 ."
  ],
  "abstract_text": [
    "<S> in this paper we extend and prove in detail the finite rank theorem for connection matrices of graph parameters definable in monadic second order logic with counting ( @xmath0 ) from b. godlin , t. kotek and j.a . </S>",
    "<S> makowsky ( 2008 ) and j.a . </S>",
    "<S> makowsky ( 2009 ) . </S>",
    "<S> we demonstrate its vast applicability in simplifying known and new non - definability results of graph properties and finding new non - definability results for graph parameters . </S>",
    "<S> we also prove a feferman - vaught theorem for the logic cfol , first order logic with the modular counting quantifiers . </S>"
  ]
}