{
  "article_text": [
    "quantum and thermal fluctuations of charges give rise to a wide range of electromagnetic phenomena ; these include luminescence from active media , e.g. fluorescence and spontaneous emission  @xcite , the finite linewidth of lasers near threshold  @xcite , thermal radiation and heat transfer from hot objects  @xcite , and dispersive interactions ( casimir forces ) between nearby surfaces  @xcite .",
    "fluctuation - driven effects are not only responsible for many naturally occurring processes but are also poised to take an increasingly active role in emerging nanotechnologies  @xcite , spurring interest in the study and engineering of complex shapes that could dramatically alter their behavior  @xcite . although rooted in similar principles , the physical mechanisms behind each of these processes vary considerably , leading to theoretical descriptions that differ both in their formulation and implementation .",
    "ultimately , however , all such calculations reduce to a series of classical scattering problems  @xcite that until recently remained largely specialized to situations involving simple , high  symmetry geometries , e.g. planar and spherical objects .    in this manuscript , we present a framework for the general - purpose calculation of many different incandescence and luminescence processes , including fluorescence , spontaneous emission , thermal radiation , heat transfer , and casimir forces in arbitrary geometries .",
    "in particular , we derive a fluctuating volume  current ( fvc ) formulation of electromagnetic fluctuations that exploits techniques from the volume  integral equation ( vie ) formulation of electromagnetic scattering  @xcite and which expands the range and validity of current methods to situations involving inhomogeneous media . although fvc is similar in spirit to our previous fluctuating surface ",
    "current ( fsc ) methods  @xcite , unlike fsc our new approach is not limited to piecewise - homogeneous objects . here , the unknowns are volume currents within objects rather than surface currents as in fsc , and can therefore easily handle more complex structures , including inhomogeneous bodies with temperature gradients or spatially varying permittivities .",
    "in contrast to recently developed scattering - matrix methods  @xcite , the fvc and fsc methods do not require a separate basis of incoming / outgoing wave solutions to be selected ( a potentially difficult task in geometries involving interleaved objects or complex structures favoring nonuniform spatial resolution ) , although vie can be used to compute the scattering matrix if desired .",
    "we show that regardless of which quantity is computed , the final expressions for power and momentum transfer are based on simple trace formulas involving well - studied vie and current  current correlation matrices that encode the spectral properties of fluctuating sources . we find that while the number of vie unknowns is large compared to scattering or fsc formulations , the associated vie matrices admit low - rank approximations that turn out to significantly reduce the complexity of trace evaluations , making practical calculations tractable .",
    "we validate the fvc method by checking its predictions against known solutions for homogeneous objects and then apply it to calculate thermal radiation , heat transfer , and fluorescence from compact objects ( spheres , ellipsoids , and cubes ) with spatially varying permittivities and temperature gradients .",
    "the same trace formulas can be readily adapted to obtain the angular distribution of far - field radiation , which we illustrate by providing new predictions of directional emission from inhomogeneous objects . the as explained below , while vie methods can be applied to arbitrary geometries , they are particularly advantageous in situations where object sizes are on the order of ( or smaller ) than the relevant wavelengths , providing a useful complement to well - established techniques better suited for the study of arbitrary geometries with lengthscales that are large or small compared to the relevant electromagnetic wavelengths , e.g. proximity approximations  @xcite .",
    "electromagnetic fluctuation phenomena can be roughly divided into two categories : incandescence and luminescence problems .",
    "_ incandescence _ refers to electromagnetic radiation from objects generated by the quantum and thermal motion of charged particles in matter , whereas _ luminescence _ refers to incoherent emission of light from non - thermal sources .",
    "the oldest and most well - studied manifestation of incandescence is the familiar glow of objects  thermal radiation  that occurs when an object is heated above the temperature of its surrounding environment  @xcite . although planck s law was not more than a century ago at the center of vigorous controversy which helped establish the foundations of quantum mechanics  @xcite , much of our recent interest in this phenomenon spawns from its profound impact on energy and related nanotechnologies .",
    "interest in complex designs is also fueled by our increasing ability to engineer selective and even dynamically tunable emitters and detectors at wavelengths for which there is currently a lack of coherent sources  @xcite , in addition to solar - energy harvesting applications  @xcite .",
    "in addition to radiation , fluctuations can also mediate heat exchange  @xcite and interactions  @xcite ( known as casimir forces ) between objects  unlike heat exchange , casimir interactions persist even at equilibrium and are known to arise primarily due to contributions of quantum rather than finite - temperature fluctuations .",
    "one fundamental distinction between `` near - field '' effects ( between objects at wavelength - scale separations or less ) and the more familiar `` far - field '' phenomena ( separations @xmath0 wavelength ) is that the former can be significantly enhanced by the contributions of evanescent waves  @xcite , growing in a power - law fashion with decreasing object separations . as a result",
    ", the heat transfer between real materials can exceed the predictions of the planck blackbody law by orders of magnitude  @xcite and quantum forces can even reach atmospheric pressures at nanometric lengthscales  @xcite , motivating interest in complex designs that can be tailored for various applications , including thermophotovoltaic energy conversion  @xcite , nanoscale cooling  @xcite , and mems design .",
    "@xcite    until very recently , however , calculations and experiments remained focused on planar structures and simple approximations thereof  @xcite .",
    "since all such thermal effects arise due to the presence of fluctuating current sources , from the perspective of calculations their descriptions reduce to a series of classical scattering calculations involving fields due to currents  @xcite , the spectral characteristics of which are related to the underlying physical means of excitations . in the case of incandescence , they are determined by the thermal and dissipative properties of materials via the well - known fluctuation  dissipation theorem ( fdt )  @xcite .",
    "naively , this involves repeated calculations of electromagnetic green s functions throughout the bodies , which can prove prohibitive for complex objects where the latter must be computed numerically , especially due to the broad bandwidth associated with thermal fluctuations , but it turns out that more sophisticated formulations exist  @xcite .",
    "these include time- and frequency - domain methods where the power transfer or force on an object is obtained via integrals of the flux or maxwell stress tensor , or equivalently electromagnetic green s functions , along some arbitrary surface enclosing the body  @xcite .",
    "recent techniques forgo surface integrations altogether in favor of unfamiliar but more efficient expressions involving traces of either scattering  @xcite or boundary - element  @xcite matrices .",
    "regardless of the choice of unknowns , in practical implementations the latter are expanded in terms of either delocalized spectral bases ( e.g. fourier or mie series ) best suited for high  symmetry geometries , or geometry - agnostic localized bases ( piecewise polynomial `` element '' functions ) defined on meshes or grids and applicable to arbitrary objects  @xcite . while there has been much progress so far , these methods have yet to be generalized to handle structures with temperature gradients or varying permittivities .",
    "temperature gradients can arise for instance due to the interplay of phonon and photon transport  @xcite , such as in heterogeneous structures with disparate thermal conductivities , including chalcogenide / metal interfaces  @xcite or quartz - platium - polymer structures  @xcite , or in graphene - based devices  @xcite .",
    "temperature gradients have also been observed in atomic force microscopes  @xcite and nanowires  @xcite , as well as in situations involving irradiated particles immersed in fluids  @xcite , magnetic nanocontacts  @xcite , or microcavities subject to strong photothermal effects  @xcite .",
    "material inhomogeneities also arise in microcavity lasers stemming from nonlinear effects  @xcite .",
    "surprisingly , there are only a handful of calculations involving non - isothermal particles , including calculation of radiation from atomic gases in shock - layer structures with linear temperature gradients  @xcite or calculations of large - radii spheres based on mie series or related semi - analytical expansions  @xcite .",
    "as we show in a separate publication , temperature gradients in inhomogeneous bodies can lead to a number of interesting effects , including highly directional thermal emission  @xcite .",
    "luminescence , like incandescence , involves incoherent emission of light due to quantum and thermal fluctuations of charges , but differs in that excitations are driven by coherent rather than thermal sources .",
    "examples include spontaneous emission , raman scattering , and fluorescence from active media externally pumped by coherent light  @xcite .",
    "although the spectral properties of fluctuating currents depend on complicated and often nonlinear light  matter interactions , the resulting radiation is incoherent and can be modeled by exploiting scattering techniques similar to those employed in incandescence problems  @xcite .",
    "there are however many important differences between these two classes of problems .",
    "for instance , the luminescence spectrum of many emitters is relatively narrow ( involving wavelengths close to material resonances ) and this has implications for calculations which favor frequency as opposed to time - domain techniques ( the latter being better suited for broad - bandwidth processes ) .",
    "furthermore , while many thermal radiation problems involve objects with uniform temperature distributions , the properties of current fluctuations excited by external pumps depend sensitively on the inputs and can change dramatically and _ continuously _ throughout the bodies , which is problematic for sie / fsc formulations based on piecewise homogeneity .",
    "such a situation arises for instance in the fluorescence from objects with features @xmath1 incident wavelengths , where resonant absorption can lead to significant spatial variations in the amplitudes of the fluctuating currents  @xcite .    until recently ,",
    "the fluorescence or raman emission pattern of small particles was obtained by analytical methods based on mie series or related basis expansions  @xcite .",
    "more recent techniques for studying luminescence from arbitrarily shaped particles instead rely on numerical techniques  @xcite , most commonly time - domain methods  @xcite , and include studies of bowtie antennas  @xcite , nanostars  @xcite , conical tips  @xcite , dimers  @xcite , and thin films  @xcite .",
    "frequency domain methods include finite - element  @xcite , boundary - element  @xcite , and discrete dipole approximation ( dda )  @xcite methods .",
    "these tools have been exploited for instance to demonstrate that both shape and material degrees of freedom can be used to tailor particle emission , making it possible to enhance fluorescence and raman processes  @xcite as well as obtain unusual angular emission patterns  @xcite ; even more recently , there has been interest in studying effects related to active ( non - hermitian ) systems  @xcite . in most cases ( with a few exceptions  @xcite ) , the total radiated power in a given direction is computed by directly summing the contribution of individual emitters inside the objects , requiring repeated evaluation of green s functions over both volumes and surfaces .",
    "in addition , many calculations rely on approximations in which the effect of the incident drive is either approximated or entirely neglected  @xcite or where only the radiation from a partial set of emitters inside the objects is obtained  @xcite .",
    "vie approach not only removes limitations associated with such approximations by fully accounting for both the emission and excitation - dependent properties of all fluctuating sources , but introduces new trace - formulas that offer compactness , simplicity and a unified framework for computing a wide range of fluctuation phenomena , allowing techniques and ideas from one area to be more easily applied to another .    a technique that in principle shares many similarities with the vie method is the so - called discrete - dipole approximation ( dda )  @xcite , which models objects as finite arrays of polarizable dipoles whose response and interactions due to incident electromagnetic fields can be obtained via the solution of a corresponding integral equation  @xcite",
    "dda has been recently employed and suggested as an efficient approach for computing radiative heat transfer  @xcite as well as fluorescence  @xcite from arbitrary geometries , but unfortunately suffers from a number of important limitations .",
    "technically , dda belongs to the general class of volume integral equations traditionally solved numerically via the method of weighted residuals  @xcite ( or method of moments as it is conventionally known when applied to computational electromagnetics  @xcite ) , by which integral equations are converted into a solvable and finite set of linear systems of equations .",
    "specifically , system unknowns ( fields or equivalent currents ) are approximated by expanding them in a finite set of basis functions , often determined by discretizations of objects into meshes or grids , and then forcing the resulting semi - discrete equations to be equal in a weak sense , i.e. by integrating them against a set of testing functions  @xcite .",
    "the actual choice and combination of basis and testing functions gives rise to a plethora of practical variants  @xcite .",
    "dda can be considered to be a particular implementation of the vie method known as a collocation method  @xcite , involving constant or dipole basis functions and dirac - delta distributions for testing , with solutions forced to be accurate only at a finite set of points ( known as point matching )  @xcite .",
    "however , it is now known that methods of weighted residuals are only guaranteed to _ converge in norm _ under special circumstances , the lack of which can lead to numerous convergence and efficiency issues  @xcite .",
    "specifically , basis functions must span the function space of the unknowns and testing functions must span the dual space of the range of the corresponding vie operator  @xcite .",
    "dda respects neither of these , and as a consequence its applicability is largely limited to situations involving light scattering in structures with small index contrasts and weakly polarizable media  @xcite , beyond which it can lead to a number of severe convergence and accuracy problems  @xcite .",
    "( note that dda also makes a number of other approximations that break down in geometries involving wavelength - scale objects , cf .",
    "eq .  14 in ref .  .",
    ") in contrast , our fvc formulation is based on a recently developed vie framework ( dubbed jm - vie ) that is numerically solved by means of a galerkin method of moments  @xcite .",
    "jm - vie exploits basis and testing functions spanning the function space of internal volume currents  @xcite , the stability and superior convergence of which have been demonstrated in geometries involving highly inhomogeneous objects and large dielectric contrasts  @xcite . while the associated jm - vie matrix elements involve complicated , expensive , and highly singular volume  volume integrals of homogeneous green s functions integrated against pairs of basis functions , these were recently shown to reduce to surface ",
    "surface integrals over smoother kernels that can be readily handled using specialized integration techniques originally developed for sie methods  @xcite .    in the following sections , we derive our fvc formulation of fluctuating currents and",
    "demonstrate that it can be employed to study a wide class of electromagnetic fluctuation effects in general geometries , with no uncontrolled approximations except for the finite discretization ( basis ) .",
    "we begin in sec .",
    "[ sec : fvc - deriv ] with a brief review of the vie formulation of electromagnetic scattering , followed by derivations of formulas involving power and momentum transfer , as well as far - field radiation patterns from radiating objects .",
    "the final _ boxed _ expressions are described via traces of products of vie and current  current correlation matrices which encode the spatial and spectral characteristics of the fluctuating sources . in sec .",
    "[ sec : ftc ] , we show that important algebraic properties of the associated vie and correlation matrices allow efficient evaluation of the trace expressions ; specifically , a number of the vie matrices admit low - rank approximations , enabling us to exploit sophisticated and fast iterative techniques for their evaluation . finally , in sec .  [",
    "sec : apps ] the fvc framework is validated against known results and also applied to obtain predictions in new geometries that currently lie outside the scope of state - of - the - art techniques , such as objects subject to spatially varying temperatures and dielectric properties .",
    "in this section , we begin by reviewing the vie method of em scattering and apply it to derive an fvc formulation of fluctuation - induced phenomena in inhomogeneous media .",
    "our approach relies on the jm - vie formulation and associated galerkin method of moments presented in  ref .  ,",
    "also briefly discussed .",
    "as noted above , a strategy based on sie formulations is unavailable for modeling inhomogeneous objects since finding the radiation of a point source ( the green s function ) in inhomogeneous media is nearly impossible with only surface unknowns  @xcite .",
    "matters are further complicated for fluctuation phenomena involving power or momentum transfer , in which case inhomogeneities in the properties of the fluctuating sources ( e.g. spatial variations throughout the bodies due to temperature or dielectric changes ) must also be accurately accounted for . starting with the recently developed power formulas  @xcite",
    ", we derive compact trace expressions for the power and momentum transfer and far - field radiation pattern of complicated objects with inhomogeneous properties .",
    "finally , we elaborate on special algebraic properties of the associated vie and correlation matrices that allow fast computations of the matrix - trace formulas , making large and complicated calculations tractable .",
    "due to a single dipole source @xmath2 within a body @xmath3 along with the induced polarization ",
    "currents @xmath4 throughout @xmath3 and two nearby bodies , @xmath5 and @xmath6 , resulting in scattered fields @xmath7 .",
    "the characteristics of the dipole sources @xmath2 ( fluctuation statistics ) and the permittivities of the bodies @xmath8 ( material properties ) both vary within each object . ]",
    "the derivations of vies often rely on the volume equivalence principle , which shares many similarities with  but is significantly simpler and more easily derived than  the more well - known surface equivalence principle  @xcite .",
    "consider the system of arbitrarily shaped , inhomogeneous bodies described by the relative permittivity @xmath9 and permeability @xmath10 functions , depicted schematically in fig .  [ fig : schem ] .",
    "let @xmath11 and @xmath12 denote 6-component electromagnetic fields and volume currents , @xmath13 and consider the scattering problem involving incident fields @xmath14 due to @xmath12 ( in the absence of bodies ) and scattered fields @xmath15 due to reflections and scattering from objects and sources . defining the 6-component volume currents @xmath16 associated with bound polarization @xmath17 and magnetization @xmath18 currents inside the objects , described by the @xmath19 susceptibility tensor @xmath8 ( which for convenience also includes the permittivity and permeability of the ambient medium )",
    ", it follows that the scattered field can be be written as a convolution of @xmath4 with the homogeneous green s function of the ambient medium  @xcite .",
    "( note that there is no assumption on @xmath8 , which can describe both anisotropic and/or chiral media , changing only the form of the homogeneous green s function  @xcite . ) in particular , the unknown scattered fields can be shown to be related to the free and bound currents , respectively , via convolutions @xmath20 with the @xmath19 homogeneous green s tensor of the ambient medium ( typically free space ) @xmath21 , written explicitly in ref .  .",
    "this is the core idea behind the volume equivalence principle , which we review below .",
    "we begin by writing the total field @xmath22 via the volume equivalence principle  @xcite in terms of the incident @xmath23 and scattered @xmath24 fields , or more explicitly : @xmath25 \\end{split}\\ ] ] where it is clear that all of the scattering information ( including material inhomogeneities ) is `` encoded '' in the convolution of the homogeneous green s function with the polarization / magnetization current . multiplying both sides of eq .",
    "[ eq : efield ] with @xmath26 and using the definition of @xmath4 in eq .",
    "[ eq : ejdef ] , one arrives at the following vie for the induced currents @xmath4 : @xmath27 which can be solved to obtain @xmath4 from the incident sources @xmath12 .",
    "this is the so - called jm - vie formulation of electromagnetic scattering in which the unknowns are induced currents rather than fields or field densities .",
    "compared to other formulations based on field unknowns , jm - vie exhibits superior performance in terms of accuracy and convergence , especially for objects with high refractive index  @xcite .",
    "the operator equation above is customarily solved by reducing it to an approximate , finite - dimensional linear system .",
    "let @xmath28 be some convenient set of @xmath29 vector - valued basis functions .",
    "we can then approximate our unknowns @xmath4 ( and , for convenience below , the source currents @xmath2 ) in this basis : @xmath30 there are two main categories of basis functions that are used in the numerical solution of the jm - vie above , known as _ spectral _ and _ mom sub - domain _ bases . a spectral basis consists of non - localized fourier - like basis functions whereas mom sub - domain bases are localized functions obtained by discretizing objects into meshes or grids of volumetric elements , e.g. cubes , tetrahedra , and hexahedra  @xcite , and defining functions by low - order polynomials with local support in one or a few elements . in this work ,",
    "we resort to the second category and exploit piecewise constant basis functions defined in cubes , due to the flexibility they offer for modeling geometries of arbitrary shape  @xcite .",
    "we note however that the proposed framework and the resulting matrix - trace formulas can also be evaluated using spectral bases as well .    finally , the semi - discrete equation is `` tested '' with another set of functions ( called testing functions ) to produce a linear system . in the galerkin approach ,",
    "the set of testing functions is the same with the one of the basis functions .",
    "the resulting galerkin jm - vie linear system reads @xmath31 where @xmath32 and @xmath33 .",
    "also , @xmath34 denotes the standard inner product of functions @xmath35 , with the @xmath36 superscripts denoting the conjugate transpose ( adjoint ) operation . without loss of generality",
    ", we can choose the basis functions to satisfy an orthogonality relation , so that @xmath37 .",
    "in this case the matrix @xmath38 ( often called gram matrix ) is equal to the identity matrix , i.e. , @xmath39 , and it follows that @xmath40 note that our simplifying assumption of orthogonal basis functions can be easily relaxed , leading to slightly modified @xmath41 and @xmath42 matrices ( below ) .    the numerical evaluation of galerkin inner products in eq .",
    "[ eq : wvmatrices ] involves multidimensional integrals over the support of both basis and testing functions .",
    "this integration can be quite cumbersome due to singularities ( when the support of the basis and the testing functions overlap ) and the highly dimensional aspect of the problem .",
    "however , previous work@xcite demonstrated that these challenging volumetric integrals can be reduced to surface integrals ( of lower singularity ) , allowing us to benefit from decades of work dedicated to the accurate and efficient evaluation of the associated surface integrals . here , we make use of the free - software demcem@xcite and directfn@xcite , which leverage the techniques described in refs .   .",
    "furthermore , mom jm - vie formulations with local basis / testing functions typically result in very large linear systems , which can be solved with iterative algorithms for non - symmetric dense systems . in each iteration ,",
    "the associated matrix - vector products take @xmath43 time .",
    "moreover , it is practically impossible to explicitly store the ( dense ) matrix @xmath44 requiring @xmath45 memory .",
    "in fact , there are now well - established , fast algorithms to reduce the costs of such integral equation solvers  @xcite .",
    "however , the ability to exploit fast solvers in fluctuation em problems is not a priori guaranteed since as we show below the final formulas involve complicated traces of products of jm - vie and related matrices . in sec .  [",
    "sec : ftc ] , we describe a fast procedure for the computation of the proposed matrix - trace , which relies on a straightforward and easily implemented fft - based fast algorithm presented in  ref .   that scales as @xmath46 for each matrix - vector product and requires @xmath47 memory .    before concluding this section , we introduce some additional definitions and notation . in particular , further below we exploit the so - called green matrix @xmath48 , defined as @xmath49 which involves interactions among basis functions mediated by the green s function . for @xmath50 objects ,",
    "the associated matrices and vectors can be conveniently written as : @xmath51 { { g}}^{21 }   &   { { g}}^{22 } & \\ldots & \\vdots                \\\\[0.5em ] \\vdots         &   \\vdots        & \\ddots &   \\vdots     \\\\[0.5em ] { { g}}^{n1 }   &   { { g}}^{n2 } & \\cdots & { { g}}^{nn } \\end{pmatrix};\\quad { \\xi}\\rightarrow \\begin{pmatrix } { { \\xi}}^{1 }     \\\\[0.5em ] { { \\xi}}^{2 }     \\\\[0.5em ]   \\vdots    \\\\[0.5em ]   { { \\xi}}^{n } \\end{pmatrix}\\ ] ] where the superscripts denote blocks associated with the various objects , with diagonal components corresponding to self - interactions and off - diagonal blocks involving interactions between different objects .",
    "finally , we define the projection , @xmath52 which selects specific blocks of vectors @xmath53 or diagonal blocks of matrices @xmath54 corresponding to object @xmath55 .",
    "we now derive a compact matrix - trace formula for the computation of the ensemble - averaged flux into body @xmath56 ( or equivalently the absorbed power ) due to fluctuating current sources in body @xmath57 , integrated over all possible positions and orientations .",
    "the first step consists of the evaluation of the flux from @xmath56 due to a single dipole source @xmath12 immersed in @xmath57 , which we denote as @xmath58 .",
    "direct application of poynting s theorem implies that the flux on the objects is given by :  @xcite @xmath59 which amounts to the work done by the total field on the polarization currents in @xmath57 . expressing the induced currents and fields in the basis of jm - vie currents and using the relation @xmath60 yields the following discrete approximation ( see ref .   for a complete analysis ) : @xmath61 } \\end{split}\\ ] ] where @xmath62 denotes the hermitian part of @xmath48 .",
    "it is then straightforward to obtain the ensemble - averaged flux @xmath63 , which yields : @xmath64}\\\\ & = \\frac{1}{2 } { { \\rm tr } \\left [ { { p}}^q    { { c } } { { p}}^q { { w}}^\\ast { \\operatorname{sym}}{({{p}}^p { { g } } ) }    { { w } } \\right ] } \\end{split}\\ ] ] where @xmath65 is a current  current correlation matrix that captures a statistical , ensemble average over sources , described in more detail in sec .  [ sec : cmat ] . defining the matrix @xmath66 , which is simply a projection of the correlation matrix unto the space of basis functions in @xmath67 , we find that the ensemble - averaged flux is given by : @xmath68}. } \\ ] ]      in addition to carrying energy , the radiation emitted by fluctuating sources also carries linear and angular momentum , which can also be described using similar expressions .",
    "the starting point consists of the evaluation of the force ( or torque ) imparted on an object @xmath56 due to a single dipole source immersed in @xmath57 .",
    "although electromagnetic forces are often computed via surface - integrals of the maxwell stress tensor , it is also possible and in our case more convenient to express the force as a volume integral by considering the lorentz force acting on the internal currents @xmath4 induced on @xmath56  @xcite . in particular , the force on the object is given by : @xmath69 where @xmath70 denotes the usual partial derivative with respect to infinitesimal displacements .",
    "the derivation of the above expression follows from application of the time - average lorentz force @xmath71 on the electric charge and current densities ( @xmath72 ) in an infinitesimal volume element @xmath73 , together with a similar expression for the force on the magnetic sources . integrating over the volume of the body and employing stokes theorem along with maxwell s equations immediately yields eq .",
    "[ eq : force ] . in a similar fashion ,",
    "the torque about some origin @xmath74 can be obtained by integrating the differential torque @xmath75 on a volume element .    expressing the induced currents and fields in the basis of jm - vie currents and following a similar procedure as that of sec .",
    "[ sec : ptf ] , one finds that the ensemble - averaged force on the object can be written in the compact and convenient form : @xmath76 , } \\label{eq : transfer}\\ ] ] where in this case and in contrast to power transfer , the relevant quantity is the matrix representation @xmath77 of the gradient of the green s function operator @xmath78 , whose matrix elements @xmath79 .",
    "also , @xmath80 denotes the skew - hermitian part of @xmath48 .",
    "the torque on the object can be obtained similarly by computing angular derivatives of @xmath78 .",
    "it turns out that the calculation of these matrix elements requires evaluating multidimensional integrals whose singularities are more severe than those of @xmath78 .",
    "a key distinction between fluctuation - induced transfers of power and momentum is that , in the latter case , one finds nonzero fluctuation - induced forces and torques between bodies even at thermal equilibrium and even at zero temperature ; these are just the usual equilibrium casimir forces .",
    "@xcite equation  [ eq : transfer ] , which computes only the non - equilibrium contribution to the force , must generally be augmented by these equilibrium contributions to yield the total force .",
    "connections between eq .",
    "[ eq : transfer ] and expressions for equilibrium forces , along with techniques for evaluating the above - mentioned integrals and results of vie computations of non - equilibrium casimir forces and torques are addressed in subsequent work  @xcite .",
    "in addition to power and momentum transfer , another useful quantity is the far - field radiation intensity of our system , which can also be expressed as a simple trace formula . the result which follows trivially from eq .",
    "[ eq : ptf ] , is that the ensemble - averaged flux radiated by an isolated body @xmath57 to the background medium is given by : @xmath81}\\ ] ] where the minus sign corresponds to the direction of the power flux and stems from poynting s theorem .",
    "however , in addition to the overall radiation , it is also useful to obtain the radiation intensity over specific directions , or equivalently the power radiated per solid angle .",
    "the angle - resolved radiation intensity @xmath82 from a single source @xmath12 immersed in @xmath57 can be obtained by expressing the radiation field at infinity @xmath83 ( where only far field contributions remain ) in terms of the free and bound current sources , as follows : @xmath84|^2\\ ] ] where @xmath85 is the wavenumber and @xmath86 is the wave impedance , both in vacuum .",
    "also , @xmath87 is the @xmath88 green s tensor of the ambient medium which maps currents to far - field electric fields , and @xmath89 is a @xmath90 transformation tensor that maps vectors from cartesian to spherical coordinates and projects their radial component to zero  @xcite . given the solution of the vie scattering problem and following the same procedure described above , it is straightforward to write the radiation intensity as a matrix - trace formula of the form : @xmath91 } \\end{split}\\ ] ] where the matrix @xmath92 is the discretized form of the operator @xmath93 , obtained in a similar fashion as @xmath48 .",
    "ensemble averaging over all sources , we find that the final formula for the angle - resolved radiation intensity @xmath94 is given by : @xmath95}.   } \\ ] ] equation  [ eq : uformula ] can be integrated over all solid angles @xmath96 to yield the total radiation rate @xmath97 , which as expected agrees with results obtained by direct application of eq .",
    "[ eq : ptf_0 ] , as discussed in sec .",
    "[ sec : ftc ] .",
    "the formulas above are very general in that they apply to many different kinds of fluctuation processes , the physical properties and origins of which are embedded in the correlation matrices @xmath98 , involving ensemble averages over all sources @xmath12 and polarizations throughout the bodies . in particular , the matrix elements of the correlation matrices describe interactions among basis functions and are given by : @xmath99 which follows trivially from the orthogonality property of our basis functions and the fact that @xmath100 .",
    "although in general the calculation of each matrix element involves volume  volume integrals against pairs of basis functions , current fluctuations are temporally and spatially uncorrelated in local media  @xcite and are described by : @xmath101 where the subscripts denote polarization degrees of freedom and @xmath102 is a position - dependent spectral tensor whose form depends on the physical origins of the fluctuations .",
    "it follows that @xmath103 is hermitian and positive - semidefinite and thus admits a cholesky factorization @xmath104 , which we exploit in sec .",
    "[ sec : ftc ] to demonstrate that our radiation , power , and momentum formulas are susceptible to fast - trace calculations .",
    "when the sources of fluctuations involve only quantum and thermal vibrations ( heat ) , the correlation function @xmath105 is determined by thermodynamic considerations such as the well - known fdt  @xcite , relating current fluctuations to dissipation in materials . without loss of generality ,",
    "the spectral function is given by :  @xcite @xmath106 where the @xmath107 tensor describes losses in the medium and @xmath108 is the planck distribution , or the average energy of an oscillator having local temperature @xmath109 .",
    "equation  [ eq : fdt ] in conjunction with the power transfer and radiation formulas above are exploited below to evaluate thermal radiation and heat transfer between inhomogeneous bodies with spatially varying temperature and dielectric properties , and also in an upcoming paper that focuses on non - equilibrium casimir forces  @xcite .    in situations involving active media driven by external pumps , the properties of the fluctuating currents and hence @xmath105 depend on the details of the input drive along with the physical emission mechanisms . for a broad range of processes",
    ", the spectral function can be written in the simple form : @xmath110 where @xmath111 describes the response of the medium due to the pump and @xmath112 describes the emission spectrum of the excited medium , which depends on the distribution of active molecules in the medium and on complicated electronic transitions mediated by the pump as well as quantum / thermal processes  @xcite . in the particular example of one - photon fluorescence from a medium ( with high quantum yield )",
    "excited by incident light , the pump spectrum is proportional to the locally absorbed power and hence can be computed by direct application of the vie power formulas .",
    "such a relationship in conjunction with eq .",
    "[ eq : uformula ] is exploited below to compute the fluorescence spectrum of an irradiated sphere .",
    "a similar dependence on the local field intensity arises in the case of raman scattering , except that @xmath111 is proportional to the raman polarizability tensor rather than the susceptibility of the medium  @xcite . in the case of spontaneous emission from a gain medium , the emission spectrum",
    "is determined by spatially dependent effective permittivity and temperature profiles determined by the driven steady - state atomic populations of the medium , both of which can be obtained by application of steady - state ab - initio laser theory ( salt )  @xcite .",
    "similar descriptions apply in more complicated systems , including fluorophores with low quantum yields or active media subject to highly nonlinear ( e.g. two - photon ) processes .",
    "the matrix - trace formulas derived in the previous sections require products of inverses of the jm - vie matrix @xmath113 with dense matrices @xmath114 , @xmath115 , and @xmath116 .",
    "as mentioned above , due to their large size and correspondingly severe cpu and memory limitations , it is practically impossible to form explicitly either the green matrix or its inverse . there are however fast fft - based procedures for evaluating matrix - vector products of the jm - vie system matrix and the green matrix  @xcite . here",
    "we describe a framework based on iterative methods for the fast computation of the associated trace formulas above .",
    "we begin with the matrix - trace formula @xmath117 in the presence of @xmath50 bodies ( including @xmath56 and @xmath57 ) , which after some algebraic manipulations can be written as follows ( ignoring pre - factors ) : @xmath118}\\\\ & + \\sum\\limits_{\\substack{m=1 \\\\ m\\neq p}}^n{{\\rm tr } \\left [   { { c}}^{qq }    { \\operatorname{sym}}{\\left ( { { w}}^{pq\\ast}{{g}}^{pm } { { w}}^{mq } \\right ) }    \\right ] } \\\\ & = s^{q\\rightarrow p } + c^{q\\rightarrow p } \\end{split}\\ ] ] where @xmath119 is the @xmath120 block of the matrix @xmath121 . due to the different characteristics of @xmath122 and @xmath123 , we need to address them separately . as discussed in sec .  [",
    "sec : cmat ] , the matrix @xmath119 can be assumed to be hermitian and positive semidefinite , hence it admits a cholesky factorization , @xmath124 .",
    "in addition , @xmath125 is a hermitian , negative semidefinite matrix@xcite and it also admits a low - rank approximation since it is associated with the smooth , imaginary part of the green s functions .",
    "hence , it can be approximated to any desired accuracy by a truncated singular value decomposition ( svd ) factorization , @xmath126 , where @xmath127 , with @xmath128 .",
    "the norm of the error in the aforementioned truncation is bounded by the norm of the vector of discarded singular values .",
    "the classical svd algorithm requires the complete matrix , hence we resort here to a class of modern randomized matrix approximation techniques , and more specifically to the randomized svd method ( rsvd )  @xcite .",
    "rsvd is effective for matrices with fast drop of the singular values and it requires only a fast matrix - vector procedure , which we have developed as described above .",
    "the matrix with the singular values can be further decomposed so that @xmath129 .",
    "finally , it follows that the self - term in eq .",
    "[ eq : fastptf ] can be written as the square of a frobenius norm , @xmath130}\\\\ & =   - \\| { { l}}_{{{c}}^{qq}}^\\ast ( { { w}}^{pq\\ast } { { u^{pp}}}){{l_{s^{pp } } } } \\|_{\\rm f}^2 . \\end{split}\\ ] ] for the most time consuming part of the norm , we need to solve the adjoint jm - vie system @xmath131 times ( for each of the leading singular vectors of @xmath125 ) .",
    "note however that we can solve for each vector of @xmath132 independently and thus the entire procedure is embarrassingly parallelizable .",
    "also , @xmath133 and @xmath134 are either sparse or diagonal , while @xmath135 is a `` tall - and - skinny '' matrix ( the number of columns is much smaller than the number of rows ) and hence the matrix product appearing in the norm can be computed efficiently .",
    "the trace formula for @xmath123 is not symmetrical and therefore can not be reduced to a norm . in this case , one can exploit the fact that @xmath136 admits a low - rank approximation due to the smoothing properties of the green s function for disjoint objects .",
    "the final dimensions of the low - rank approximation of @xmath123 ( for a prescribed accuracy ) depend on the electric distance between objects @xmath55 and @xmath137 @xcite , i.e. , @xmath138 , where @xmath139 , with @xmath140 .",
    "the final formula for @xmath123 after the cholesky factorization of the singular values matrix ( @xmath141 ) is given by @xmath142 } \\end{split}\\ ] ] where @xmath143 both @xmath144 and @xmath145 are `` tall - and - skinny '' , and we can not compute the trace by forming explicitly their product , due to memory limitations .",
    "alternatively , we can use the standard vectorization of a matrix @xmath146 , which converts the matrix into a column vector , together with the identity , @xmath147 } = { \\rm vec}({{x}})^t \\cdot \\overline{{\\rm vec}({{y}})}$ ] , and write eq .",
    "[ eq : c_qp ] in the following computationally friendly form : @xmath148 the overall computational complexity for the evaluation of @xmath123 consists of a single run of the randomized - svd for a non - symmetric matrix@xcite , and @xmath149 solves of the adjoint jm - vie system . in the case of the matrix - trace formulas for the force and the torque , the procedure is similar with the one described above . the only difference stems from the replacement of @xmath48 with @xmath77 and @xmath150 with @xmath151 .    finally , the case of far - field radiation is somewhat simpler . according to eq .",
    "[ eq : uformula ] , we just need to solve @xmath152 times the adjoint jm - vie system , since @xmath153 .",
    "hence , the radiation intensity for a specific direction or solid angle @xmath96 , is given by the following square of the frobenius norm : @xmath154 this is a very useful formula , especially when directional information of the radiated power is of interest .",
    "in addition , the total radiated power can be evaluated by integrating eq .",
    "[ eq : u_fro ] over all solid angles , as mentioned in sec .",
    "[ sec : dir ] , which would amount to employing a numerical integration scheme over the unit sphere ( e.g. lebedev quadrature  @xcite ) .",
    "alternatively , one could exploit eq .",
    "[ eq : ptf_0 ] and the associated norm @xmath155 to compute the total radiated power from an isolated body .",
    "the latter is expected to be more efficient for total - radiation computations with prescribed accuracy , controlled by the svd factorization of the green matrix , in which case the minimum number of jm - vie solves needed for a prescribed accuracy is estimated in advance .",
    "in contrast , the former approach is based on adaptive quadrature schemes where the accuracy is controlled by the comparison of results between different orders of integration , with no a priori control .",
    "in this section , we apply the fvc method to obtain new results in complex geometries . to begin with ,",
    "we show that the green matrices appearing in our trace formulas admit low - rank decompositions ( as discussed in sec .",
    "[ sec : ftc ] ) by computing their ranks to within some tolerance in a representative structure involving two vacuum - separated , homogeneous cubes .",
    "we validate the fvc method by checking its predictions against known results of thermal radiation and near - field heat transfer between homogeneous bodies , including spheres , cubes , and ellipsoids , obtained using a boundary - element implementation of our recent fsc formulation  @xcite .",
    "we show that when subject to temperature gradients or continuously varying permittivities , complex bodies can exhibit highly modified thermal radiation and heat transfer spectra , leading to directional emission at selective wavelengths .",
    "finally , we demonstrate that the same formalism can be exploited to study luminescence from excited media by computing the fluorescence spectrum of a sphere irradiated by monochromatic incident light .",
    "we show that the impact of the resulting inhomogeneous current fluctuations can not be easily obtained by exploiting simple homogenization or effective - medium approximations . for convenience and simplicity",
    ", we consider dielectric media with no material dispersion ( constant @xmath156 and large dissipation @xmath157 ) , though our approach is general in that it can readily handle other kinds of materials such as metals with @xmath158 and even gain media .",
    "low - rank approximations of the associated ( free - space ) green matrices are instrumental to the practical and efficient evaluation of our trace formulas . in this section , we present some representative results obtained from computing the ranks of both @xmath125 and @xmath136 , to within some tolerance , for the particular problem of two vacuum - separated , homogeneous cubes of edge - length @xmath159 and separated by a surface ",
    "surface distance @xmath160 , shown schematically in fig .",
    "[ fig : heat ] .     of a cube of edge - length @xmath161 held at temperature @xmath162 ,",
    "normalized by the corresponding black - body spectrum @xmath163 , for different ( a ) discretization mesh densities and ( b ) rsvd truncation tolerances . ]",
    ".ranks of @xmath164 for various frequencies ( @xmath165 ) and tolerances ( tol ) in truncated svd .",
    "the ranks correspond to the case of a cube of edge - length @xmath161 .",
    "in addition , results for a sphere of radius @xmath166 are included in brackets . [ cols=\"^,^,^,^,^,^,^ \" , ]     table i shows the singular values of @xmath164 , corresponding to one of the two cubes , as a function of the normalized frequency @xmath167 and tolerance @xmath168 ; that is , we obtain the singular values that produce svd factorizations bounded in norm by the tolerance @xmath168 , also known as a truncated svd .",
    "since the associated matrix is very large and our trace formulations can be cast in terms of fast matrix ",
    "vector products , our calculations exploit the rsvd method recently developed for big - data problems  @xcite .",
    "( note that results for the second cube , involving @xmath169 , would be identical since both cubes have equal sizes and number of unknowns . )",
    "our results reveal at least two important features : first , the ranks scale linearly with @xmath170 at large frequencies , and sub - linearly ( roughly constant ) at small frequencies . additional numerical experiments ( not shown ) confirm that the effect of mesh density on the ranks is negligible , yet another manifestation of the favourable convergence properties of the jm - vie formulation  @xcite .",
    "this also suggests a strategy for obtaining the finite rank of @xmath125 with prescribed accuracy : we begin by computing the rank of the operator for a prescribed accuracy by using a coarse mesh and then run a fixed - rank rsvd algorithm with finer mesh .",
    "finally , fig .",
    "[ fig : convergence ] illustrates the rate of convergence of the radiation spectrum @xmath171 from an isolated cube at a fixed temperature @xmath162 with respect to different ( a ) discretization mesh densities and ( b ) truncation tolerance , normalized to the spectrum of a corresponding black body @xmath172 , where @xmath173 denotes the surface area of the cube .",
    "the situation changes in the case of the `` coupling '' green matrix @xmath174 , which encodes interactions between objects .",
    "table ii shows the significant singular values associated with the coupling matrix of the same cube ",
    "cube geometry at a fixed frequency @xmath170 and for various separations @xmath160 , obtained by leveraging the rsvd technique . as expected , the singular values increase as @xmath160 decreases , a consequence of the power - law drop - off of the green s function with separation in the near field .",
    "it follows that the computation complexity of the trace formulas increases as the two bodies come close together .",
    "( note that , as described in sec .",
    "[ sec : ftc ] , our trace formulas for power and momentum transfer require us to solve two vie systems for every corresponding eigenvector , but fortunately each system can be solved independently and the overall process is embarrassingly parallelizable . )",
    "nevertheless , we find that @xmath175 remains very low rank even for relatively close separations @xmath176 , below which constraints on the resolution make the fvc approach less practical .",
    "however , it is precisely at such small separations that approximate methods such as the proximity approximation become accurate  @xcite .",
    "normalized by the corresponding black - body spectrum @xmath177 of different bodies of surface area @xmath173 held at temperature @xmath178  k , including a sphere of radius @xmath166 ( blue lines ) , cube of edge - length @xmath161 ( green line ) , and ellipsoid of long semi - axis @xmath166 and short semi - axis @xmath179 ( red line ) .",
    "the objects have either ( a ) uniform permittivities @xmath180 or ( b ) spatially varying @xmath181 , with @xmath182 and @xmath183 . for comparison",
    ", we also plot the radiation spectrum @xmath184 ( dashed lines ) of corresponding bodies with homogeneous effective permittivities @xmath185 .",
    "the insets depict the angular distribution of far - field radiation @xmath186 , normalized by the maximum intensity over all directions @xmath187 , at selected frequencies . ]",
    "we begin by validating our fvc approach by checking its predictions of thermal radiation from homogeneous bodies against results obtained using our recently developed fsc formulation  @xcite , which is well - suited for handling piece - wise constant structures and fluctuations statistics .",
    "figure  [ fig : radiation](a ) shows the flux spectra @xmath171 of multiple objects ( of uniform temperature @xmath162 and permittivity @xmath180 , including a sphere of radius @xmath166 ( blue line ) , a cube of edge - length @xmath161 ( green line ) , and an prolate ellipsoid of long semi - axis @xmath166 and short semi - axes @xmath179 ( red line ) .",
    "note that in each case @xmath171 is normalized to the corresponding flux from a black body .",
    "as shown , there is excellent agreement between the fvc ( solid lines ) and fsc ( circles ) predictions , both of which illustrate the expected radiation enhancement at geometric resonances .",
    "the fvc method can also handle more complex structures , including inhomogeneous bodies with spatially varying permittivities .",
    "in particular , fig .",
    "[ fig : radiation](b ) shows @xmath171 for the same geometries of fig .",
    "[ fig : radiation](a ) but for objects with linearly varying permittivity profiles @xmath188 , with @xmath189 and @xmath182 ( solid lines ) and axes chosen to lie at the geometric center of each object . compared to the spectrum of the homogeneous bodies of fig .",
    "[ fig : radiation](a ) , one finds that the resonances are shifted to larger frequencies and their peak amplitudes are significantly smaller , a consequence of the decreased effective permittivity of each object . for comparison",
    ", we also show @xmath190 ( dashed lines ) from corresponding homogeneous objects with effective permittivities , @xmath191 corresponding to uniform @xmath192 .",
    "our calculations reveal that in the illustrated frequency range and for our choice of dielectric profiles , the homogeneous approximation is qualitatively accurate to within @xmath193 . on the other hand , employing eq .",
    "[ eq : uformula ] to compute the angular radiation patterns at selected frequencies , shown as insets in fig .",
    "[ fig : radiation ] , reveals significant changes , e.g. significantly larger directional emission , that can not be captured by the effective - medium approximation .",
    "in particular , the radiation patterns of the inhomogeneous objects break @xmath194 mirror symmetry .",
    "for example , the flux from the cube at @xmath195 is slightly larger in the @xmath196 than in the @xmath197 direction , a situation that is reversed at larger @xmath198 ( see insets ) .",
    "generally , the transition frequency of the favored radiation direction depends on the geometry ; for instance , even at a frequency as high as @xmath199 , the ellipsoid continues to radiate more along the @xmath196 direction .     of various bodies normalized by the corresponding predictions of a simple approximation @xmath200 , defined in  eq .  [ eq : teff ] , including ( a ) sphere of radius @xmath166 and radially varying temperature profile @xmath201 for both @xmath202  k ( blue line ) and @xmath203 ( green line ) , and ( b ) sphere of radius @xmath166 ( blue line ) or ellipsoids with short semi - axes @xmath179 and long semi - axis @xmath166 along the @xmath194 ( green line ) or @xmath204 ( red line ) directions , subject to vertically varying temperature profiles @xmath205 , where @xmath206 denotes the @xmath207-dimension of the corresponding body .",
    "in all cases , objects have uniform permittivity @xmath180 and are subject to temperature gradients @xmath208 and @xmath209  k. the insets in ( a ) show the local density of states along a cross - section of the sphere at different frequencies while those in ( b ) show the angular distribution of far - field radiation @xmath186 normalized by @xmath187 . ]",
    "more pronounced changes arise when objects are subject to spatial temperature gradients .",
    "figure  [ fig : radiationt ] shows @xmath171 from homogeneous ( @xmath180 ) ellipsoids subject to either ( a ) radially varying @xmath210 or ( b ) @xmath207-varying temperature profiles ( see caption ) . in both cases ,",
    "@xmath211 is normalized by the flux @xmath200 obtained from a naive approximation in which the temperature variations are removed in favor of a uniform effective temperature @xmath212 determined by a simple average of the planck distribution over the volume @xmath213 of the bodies , @xmath214 such a simple approximation obviates the need for exact calculations that explicitly incorporate inhomogeneities , but is clearly inadequate for wavelength - scale objects .",
    "specifically , fig .",
    "[ fig : radiationt](a ) shows @xmath171 from spheres with radially varying temperatures , illustrating that beyond the sub - wavelength regime @xmath215 and depending on the choice of @xmath216 and @xmath217 , @xmath211 can be many times larger or smaller than that predicted by eq .  [ eq : teff ] .",
    "the failure of this naive approximation is especially apparent near resonances , where the coupling of fluctuating sources ( dipoles ) to far - field radiation ( the local density of states ) is highly position - dependent .",
    "the insets of fig .",
    "[ fig : radiationt](a ) show cross - sections of the spatially varying flux contribution from dipoles in the interior of the sphere at two relatively close frequencies . at @xmath218",
    ", we find that dipoles closer to the center can couple more efficiently to far - field radiation than those near the edges , causing eq .",
    "[ eq : teff ] to underestimate the flux by @xmath219 in the case @xmath220 , @xmath221  k ( green line ) and to overestimate it by @xmath222 when @xmath223 , @xmath224 ( blue line ) .",
    "the converse is true at @xmath225 , in which case their coupling to radiation is largest at the center and edges of the sphere .",
    "similar effects arise in situations involving @xmath207-varying temperature profiles , explored in fig .",
    "[ fig : radiationt](b ) for either spheres ( blue line ) or ellipsoids with either their long - axes ( green line ) or short - axes ( red line ) aligned with the @xmath194 direction .",
    "for instance , ellipsoids can exhibit highly directional emission ( almost a factor of 3 times larger ) along the direction of increasing temperature .",
    ", normalized by the corresponding black - body spectrum @xmath226 , between two cubes of edge - length @xmath161 and temperature @xmath178  k separated by surface  surface distance @xmath227 .",
    "the cubes are assumed to have either uniform permittivities @xmath228 ( red dashed line ) , @xmath229 ( black dashed line ) , or @xmath180 ( blue dashed line ) , or vertically varying permittivities @xmath230 defined with respect to the local axis @xmath231 at the center of each cube ( shown on the inset ) , chosen so that the system has mirror symmetry about the @xmath232@xmath233 plane intersecting the origin @xmath234 .",
    "the gradients are either increasing ( black solid line ) or decreasing ( green solid line ) toward or away from the center , corresponding to the choice of @xmath235 or @xmath236 , respectively . ]    in addition to far - field radiation , the fvc method can be employed to obtain radiative transfer between objects .",
    "figure  [ fig : heat ] shows the heat - transfer spectrum @xmath171 ( computed via eq .",
    "[ eq : transfer ] ) normalized by @xmath237 ( same as above ) , between two vacuum - separated cubes of edge - length @xmath161 and surface  surface separation @xmath227 , of either uniform ( dashed lines ) or vertically varying ( solid lines ) permittivities .",
    "we consider dielectric profiles of the form @xmath238 defined with respect to the local axis located at the center of each cube @xmath231 , chosen so that the entire system has mirror symmetry about the origin ( see inset ) .",
    "we consider two different profiles , @xmath239 ( black line ) or @xmath240 ( green line ) , corresponding to increasing gradients toward or away from the origin . for comparison , we also plot the transfer between cubes of uniform permittivities @xmath228 ( red dashed line ) , @xmath180 ( green dashed line ) , and @xmath241 , corresponding to the minimum , maximum , or average of the spatially varying permittivities , respectively . as shown , depending on the wavelength regime ( near versus far field )",
    "inhomogeneities can have a different effect on the heat transer .",
    "for instance , at low @xmath242 where near - field effects prevail , homogeneous bodies with smaller dielectric constants tend to transfer more heat  the same dependence is observed for planar objects separated by vacuum , where the near - field contribution @xmath243  @xcite .",
    "not surprisingly , because nearby regions tend to contribute more than far - away regions , one observes that despite having the same average permittivities @xmath244 ( dashed blue line ) , the transfer is sensitive to the local dielectric variation , exhibiting larger enhancement in the case where the permittivity is increasing toward ( green solid line ) rather than away ( black solid line ) from the origin . at larger @xmath245 where far - field effects begin to dominate , one observes the opposite behavior , in which case the largest transfer is obtained for decreasing permittivities toward the origin .",
    "essentially , as illustrated in fig .",
    "[ fig : radiation](b ) , at sufficiently large wavelengths , bodies with dielectric gradients tend to radiate along the direction of increasing permittivity .",
    "( in arbitrary units ) of a homogeneous and non - dispersive dielectric sphere of radius @xmath166 and permittivity @xmath180 excited by an @xmath204-polarized planewave propagating along the @xmath194 direction with frequency @xmath246 .",
    "the absorbed power @xmath247 inside the sphere , obtained by solving a single scattering problem as described in  ref .  ,",
    "is shown in the top contour plots along three sphere cross - sections .",
    "@xmath211 is computed exactly ( blue line ) or via a homogeneous approximation @xmath184 in which the absorbed power is taken to be uniformly distributed inside the sphere and given by @xmath248 ( red line ) .",
    "the ratio of the two is plotted as the black dashed line on the right axis .",
    "the insets depict the angular distribution of fluorescence emission , normalized by the maximum intensity over all directions , at selected frequencies . ]",
    "we now consider application of the fvc formulas to the calculation of fluorescence .",
    "a typical fluorescence setup consists of an incident wave impinging on a fluorescent body , leading to the absorption and subsequent re - emission of light by molecules inside the body .",
    "@xcite both of these effects are captured by the current  current correlation matrix described in sec .",
    "[ sec : cmat ] , which encodes the spectral properties of the fluctuations . in the particular problem of one - photon fluorescence induced by an incident monochromatic wave at a given frequency @xmath249 , the spectral function @xmath250 has the form given in eq .",
    "[ eq : fluo ] , with the excitation spectrum given by the locally absorbed power , @xmath251 denoting the fluorescence spectrum of the bulk medium , usually a relatively broad lorentzian lineshape centered near the material s absorption resonance .",
    "( note that @xmath252 in the absence of a fluorescent medium . ) a well - known approach to enhance fluorescence involves designing bodies to have strong resonances at @xmath249 , leading to increased absorption  @xcite .",
    "for bodies designed to have additional resonances within the fluorescence bandwidth , determined by @xmath112 , there is an additional source of enhancement arising from the increased local density of states , or increased coupling of dipole emitters to far - field radiation .",
    "inhomogeneities arise due to the fact that @xmath111 and the local density of states are both highly spatially non - uniform near resonances .",
    "figure  [ fig : fluorescence ] shows the fluorescence emission @xmath171 from a sphere of radius @xmath166 and uniform permittivity @xmath180 , irradiated by an @xmath232-polarized , @xmath207-traveling incident wave of frequency @xmath253 , chosen to coincide with one of its resonances . for simplicity , we assume a non - dispersive and uniformly distributed fluorescent medium with @xmath254 , although as noted above our formalism can just as easily handle spatially varying distributions .",
    "the first step in computing the fluorescence emission is to obtain the locally absorbed power within the sphere @xmath247 , which boils down to the calculation of a single and far simpler scattering problem exploiting eq .",
    "[ eq : pabs ] , as described in ref .  .",
    "along with @xmath211 ( blue line ) , fig .",
    "[ fig : fluorescence ] shows @xmath111 along three different cross - sections intersecting the center of the sphere ( top contour plots ) , illustrating the highly non - uniform spatial pattern of current fluctuations .",
    "also shown is the spectrum @xmath184 obtained by application of a homogeneous approximation ( red line ) where the absorbed power is averaged over the volume of the sphere to yield a uniform , effective @xmath255 , along with the corresponding ratio @xmath256 ( black line ) .",
    "as before , such approximations yield accurate results in the sub - wavelength regime but break down at larger frequencies . for instance , at @xmath257 we find that @xmath258 .",
    "more importantly , the approximation fails to capture the angular distribution of radiation ( insets ) : both the direction of largest fluorescence and overall emission pattern change drastically as the emission frequency increases from @xmath259 to @xmath260 .",
    "our fvc formulation of electromagnetic fluctuations enables accurate calculations of wide - ranging incandescence ( e.g. thermal radiation , dispersion forces , heat transfer ) and luminescence ( e.g. spontaneous emission , fluorescence , raman scattering ) phenomena in arbitrary geometries . similar to recently proposed scattering - matrix and surface - integral equation formulations of radiative heat transfer , the resulting quantities are obtained via traces of matrices involving interactions among basis functions ; however , because the jm - vie `` scattering '' unknowns are volume currents rather than propagating waves or surface currents , the formalism is applicable to a broader set of problems .",
    "for example , as demonstrated here , our approach captures phenomena associated with the presence material inhomogeneities , such as spatially varying temperature gradients and dielectric properties within bodies . in future work",
    ", we plan to exploit the fvc approach to demonstrate predictions of highly directional radiation from inhomogeneous structures subject to thermal gradients  @xcite , non - equilibrium casimir torques on chiral particles  @xcite , and enhanced directional emission from parity - time symmetric ( gain ) media  @xcite .",
    "furthermore , although our calculations focused on geometries involving compact bodies , the same power and momentum formulas derived above apply to geometries involving extended bodies , the subject of future work .",
    "this work was supported in part by grants from the singapore - mit programs in computational engineering and in computational and systems biology , from the skolkovo - mit initiative in computational mathematics , from the army research office through the institute for soldier nanotechnologies under contract no .",
    "w911nf-07-d0004 , and from the national science foundation under grant no ."
  ],
  "abstract_text": [
    "<S> we describe a fluctuating volume  current formulation of electromagnetic fluctuations that extends our recent work on heat exchange and casimir interactions between arbitrarily shaped homogeneous bodies [ phys . </S>",
    "<S> rev . </S>",
    "<S> b. 88 , 054305 ] to situations involving incandescence and luminescence problems , including thermal radiation , heat transfer , casimir forces , spontaneous emission , fluorescence , and raman scattering , in inhomogeneous media . </S>",
    "<S> unlike previous scattering formulations based on field and/or surface unknowns , our work exploits powerful techniques from the volume  integral equation ( vie ) method , in which electromagnetic scattering is described in terms of volumetric , current unknowns throughout the bodies . </S>",
    "<S> the resulting trace formulas ( boxed equations ) involve products of well - studied vie matrices and describe power and momentum transfer between objects with spatially varying material properties and fluctuation characteristics . </S>",
    "<S> we demonstrate that thanks to the low - rank properties of the associated matrices , these formulas are susceptible to fast - trace computations based on iterative methods , making practical calculations tractable . </S>",
    "<S> we apply our techniques to study thermal radiation , heat transfer , and fluorescence in complicated geometries , checking our method against established techniques best suited for homogeneous bodies as well as applying it to obtain predictions of radiation from complex bodies with spatially varying permittivities and/or temperature profiles . </S>"
  ]
}