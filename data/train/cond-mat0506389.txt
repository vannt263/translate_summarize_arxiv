{
  "article_text": [
    "the representation of the one - particle electronic structure of molecules and solids in terms of localized wannier  @xcite orbitals is nowadays `` enjoying a revival ''  @xcite as a useful tool for many applications  @xcite . the main impetus for this renewal of interest",
    "was given by the establishment , by king - smith and vanderbilt ( ksv ) , of a formally exact relationship between the sum of the wannier function ( wf ) centers and a gauge - invariant berry phase , in the context of the modern theory of polarization  @xcite .",
    "however , the intrinsic nonuniqueness in the wannier function definition , and the difficulty in defining their centers within a periodic cell calculation , limited their practical use , until a particularly elegant method due to marzari and vanderbilt  @xcite ( mv ) became available some years ago .",
    "their scheme allows one to obtain , in a given isolated or extended system , a unique set of maximally localized wannier functions that minimizes a well - defined spread functional .",
    "moreover , the mv formalism provides as an important byproduct the positions of the wf centers , whose sum gives direct access to the macroscopic polarization of the physical system .",
    "the mv scheme , which became instantly popular , presents nevertheless an inconvenience , in that crystalline solids are treated on a different footing with respect to the case of , e.g. , large disordered systems simulated at the @xmath0 point only .",
    "the two prescriptions are indeed equivalent in the thermodynamic limit , but they formally differ when discrete brillouin zone ( bz ) samplings ( or finite supercells for isolated objects ) are used , which is necessarily the case in any practical calculation . in the first part of this work we show that there is nothing fundamental in this discrimination , i.e. that a given choice for a spread functional in @xmath0-sampled cells dictates unambiguously the mathematical expression in _ discrete _ @xmath1-point space , and that invariance under `` bz folding '' is the guideline which estabilishes the link .",
    "the resulting formalism is completely general and , while being similar in spirit to the original ( mv ) one , presents a much simpler algebra .",
    "a more relevant issue affects more directly the modern theory of polarization , and concerns the asymptotic convergence with respect to bz sampling .",
    "it was already shown formally and numerically  @xcite that both methods ( ksv and mv ) for calculating the polarization of a molecule or a crystal in periodic boundary conditions ( pbc ) are plagued by a slow @xmath2 convergence , where @xmath3 is the linear dimension of the supercell containing the isolated molecule , or alternatively the resolution of the @xmath1-point mesh . the problem is usually addressed , in the context of the berry - phase ksv approach , by refining the @xmath1-point grid along `` stripes '' in the brillouin zone within a separate , non - selfconsistent calculation  @xcite . for finite systems ,",
    "an extrapolation technique was recently proposed  @xcite , in which the @xmath2 error is removed from the wannier multipoles by performing a series of calculations in cubic supercells of increasing size  .",
    "both solutions are somewhat unsatisfactory , in that they require many calculations to be performed on the same system , with a cost that is higher than what is normally needed to converge total energies and densities . in the second part of this work we propose a simple `` refining '' procedure , which is able to provide an extremely accurate value for the center and spread once a well - localized set of maximally localized wannier functions is available .",
    "we show first formally and then by numerical examples that this technique , while requiring a very minor computational effort , is able to outperform in terms of accuracy both the standard ksv berry - phase approach and the alternative formula based on `` unrefined '' wf centers  .",
    "finally , our derivation also provides a novel , intuitive interpretation of the position / localization operator in periodic boundary conditions and of its relationship to the corresponding well - known free - space operators .",
    "the theoretical basis for the mv approach rests on a continuum formulation , in which the space is infinitely extended in all directions ; this translates to an infinitely dense brillouin zone sampling in the case of crystalline solids . for practical calculations",
    "a finite sampling ( or finite simulation supercell ) is necessary , and mv give detailed prescriptions for the `` discretization '' of the relevant mathematical objects ( gradients and laplacians in @xmath1-space ) .",
    "we start here our alternative derivation from a slightly different viewpoint , i.e. we `` discretize '' the problem from the very beginning by choosing an appropriate spread functional in the @xmath0-point case , and then work out the formulas in @xmath1-space without making any further approximation .",
    "this approach leads automatically to a general and size - consistent formalism , that is invariant under bz unfolding .",
    "we assume a born - von krmn ( bvk ) supercell of volume @xmath4 , which is a multiple of the primitive ( p ) unit cell of the crystal ( of volume @xmath5 ) under study . in this system with periodic boundary conditions ( pbc )",
    "there are @xmath6 allowed bloch vectors , where @xmath6 is given by the ratio between the volumes : @xmath7 the generalized bloch orbitals ( which are not necessarily eigenstates of the hamiltonian ) are orthonormal on the primitive cell : @xmath8 and can be written as usual : @xmath9 where the @xmath10 are periodic functions , and can be represented on the reciprocal lattice of the p cell : @xmath11 @xmath12 represents the plane - wave cutoff , while @xmath13 is the fourier coefficient of the lattice - periodic part of the bloch function : @xmath14 we will use the bvk supercell for representing our wannier functions : @xmath15 where the normalization constant is chosen so that these @xmath16 are orthonormal on the bvk supercell .",
    "a particularly simple relationship holds in reciprocal space : @xmath17 we remind the reader that the reciprocal lattice of the bvk cell is spanned by all vectors of type @xmath18 , which we will call @xmath19 in the following , to distinguish them from the @xmath20 vectors of the primitive reciprocal lattice .",
    "eq .  [ wfgspace ] does not define a unique set of wannier functions , because of the gauge arbitrariness in the choice of the unitary representation of the bloch vectors .",
    "this indeterminacy can be solved by defining a spread functional @xmath21 which depends explicitly on the gauge , so that the minimization of @xmath21 leads to a well defined set of localized orbitals with the desired properties .",
    "berghold and coworkers  @xcite proposed a particularly simple and appealing expression for @xmath21 and the related wannier centers @xmath22 , which is valid for @xmath0-only bz sampling in a lattice of general symmetry .",
    "since our bvk supercell is sampled at @xmath0 by construction , we can use the same expressions as berghold , that in our notations read :    @xmath23    here @xmath24 are dimensionless complex numbers given by : @xmath25 } represents a small set of reciprocal lattice vectors @xmath26 with weights @xmath27 . in the case of a cubic bvk supercell of edge @xmath3",
    "these quantities reduce to the @xmath28 primitive reciprocal - space vectors of the bvk cell and the weights are all equal : @xmath29 while in the most general case of a triclinic cell a maximum number of six independent vectors and weights must be used , according to the prescriptions given in ref .   and  .",
    "with these notations and conventions in hand , we are now ready to write down a @xmath1-space expression for @xmath30 and @xmath21 . both quantities depend directly on @xmath24 , and the key of the derivation is then the `` brillouin - zone unfolding '' of this latter quantity . using the same notation as mv : @xmath31 it is straightforward to derive a very simple expression for @xmath24 : @xmath32 with this formula we can write our operational definitions of position and quadratic spread in @xmath1-space :    [ eqnsk ] @xmath33 , \\\\ \\omega   & = & \\sum_n \\sum_i \\bar{\\mathrm{w}}_i \\ , 2 \\ , \\big(1 - \\big|             \\frac{1}{n } \\sum_\\mathbf{k } m^{(\\mathbf{k , b}_i)}_{nn }            \\big| \\big ) \\label{spreadk}\\end{aligned}\\ ] ]    it is interesting to notice the strikingly close similarity between our expression for the centers ( eq .  [ wancenk ] ) and eq . 31 of mv , the only difference being the order in which the complex logarithm and the average over @xmath1-points is taken  ) is also very close to eq",
    ". 23 of mv ( which is further discussed in  ) , and coincides with it when @xmath34 . ] .",
    "we argue that the one proposed here is a more natural choice , since it retains the correct translational properties of their formula , while strictly enforcing size consistency .",
    "size consistency means that the formalism gives mathematically identical answers for the @xmath1-point representation and for the equivalent bvk real - space @xmath0-point representation .",
    "our formula is correct by construction , and extends exactly to the case of isolated systems with @xmath0-point sampling without any further algebra .",
    "another advantage of our scheme is its simplicity , which becomes evident when taking the gradient of the spread functional with respect to an infinitesimal unitary rotation in a given @xmath35 subspace .",
    "thus , we consider the transformation : @xmath36 where the rotation matrices @xmath37 are obtained by adding an infinitesimal antihermitian matrix @xmath38 to the identity : @xmath39 the variation of the total spread with respect to this transformation is readily obtained in terms of the @xmath40 matrices and the _ phases _ of the @xmath24 complex numbers : @xmath41 @xmath42 where @xmath43 stays for hermitian - conjugate , and @xmath44 is the phase : @xmath45 this expression for the gradient can easily be obtained by observing that , in eq .",
    "[ eqspread ] , one can write @xmath46 .",
    "we note that the for the spread functional ( eq .  [ eqspread ] ) several possibilities exist , which are all equivalent in the thermodynamic limit  @xcite . in the appendix",
    "we briefly consider these alternatives , and we provide a formal derivation of the gauge - invariant part of the spread  @xcite , which further evidences the close relationship of our formulation to the original mv scheme . because of the exact mapping between the bvk supercell and the primitive one , we find it particularly natural to choose our wannier functions to be real . even if there is no formal proof that at the global minimum of @xmath21 the wannier functions are real , this is nevertheless a very reasonable assumption  @xcite , and allows one to fully take advantage of the time - reversal symmetry , with significant gain in computational efficiency .    for the minimization of @xmath21 with respect to the @xmath47 degrees of freedom many efficient schemes are available  @xcite .",
    "we decided in this work to implement a damped dynamics algorithm , which allows for good control over the process , at the expense of requiring more human input for the optimal tuning of the two independent parameters ( time step and friction ) . in antiferromagnetic mno , a case that is known  @xcite to be difficult to converge",
    ", we were able to obtain this way a very accurate and symmetrical minimum ( to machine precision ) in a couple of thousand time steps , which required only a few minutes on a modern workstation .",
    "an even more appealing feature of the dynamical scheme is the availability of a mathematically conserved constant of motion , which provides a very stringent test on the accuracy of the implementation .",
    "since the wannier functions in an insulator are known to be _ exponentially _ localized in space  @xcite , similar convergence properties can be expected for any physical quantity that is extracted from this particular representation of the electronic structure . instead ,",
    "as we pointed out at the beginning , both the sum of wannier centers and the berry phase ( which is formally related to the wannier centers by the derivation in ksv ) converge only as @xmath2 , and need special treatment whenever accurate values are needed .",
    "we will show in this section that this slow convergence is indeed not a _ intrinsic _ feature of the ground state electronic structure of an extended system , and can be dramatically improved by a simple , inexpensive and very general procedure . before explaining our correction in detail",
    ", we will first provide an intuitive picture of the position operator in pbc , which , as resta showed  @xcite , is the `` kernel '' of both berry phase and maximally localized wannier function calculations .",
    "let s consider a one - dimensional system of one single electronic state @xmath48 , which we will assume to be _ well localized _ within a periodic cell of length @xmath3 .",
    "the expression for the fundamental , dimensionless complex number @xmath49 is very similar to the 3d expression : @xmath50 the average value of the position operator ( eq .  [ eqwancen ] ) becomes : @xmath51 while the quadratic spread ( eq .  [ eqspread ] ) reduces to : @xmath52 by defining the charge density @xmath53 , it is easy to see that the following is true   and eq .",
    "[ localpot ] to a general 3d lattice is straightforward by using the set of @xmath26 vectors and weights defined in the text . ] :    @xmath54 dx = 0 \\label{eqsin}\\ ] ]    @xmath55 \\big\\ } dx \\label{localpot}\\ ] ]        these equations can be directly compared to the elementary textbook definitions of the position and quadratic spread for a square - integrable electronic state in one dimension ( i.e. without pbc , the superscript @xmath56 stays for `` free - space '' ) :    @xmath57    @xmath58    the resemblance is indeed striking , the only difference being the replacement of the @xmath59 and @xmath60 operators with trigonometric functions that are periodic on the cell .",
    "this relationship between the ( polynomial ) free - space operators and the ( trigonometric ) pbc ones is made evident in fig .",
    "[ fig1 ] , where they are plotted together in order to show their close matching in a region surrounding the localized state . indeed , by a taylor expansion one obtains : @xmath61 @xmath62 \\sim x^2 - 2\\big(\\frac{2\\pi}{l}\\big)^2 \\frac{x^4}{4 ! }",
    "+ ... \\ ] ] thus , we arrived from a different starting point at the same @xmath2 convergence of the position and spread , which has already been discussed in the literature  @xcite .",
    "it is particularly clear from this derivation that the intrinsic property of the periodic lattice and the localized state are by no means responsible for the slow convergence , which is instead determined exclusively by the mathematical form of the pbc position operator .    to end this section",
    ", we note that eq .",
    "[ eqsin ] alone is not sufficient to _ define _ the center @xmath63 , since also @xmath64 satisfies the same requirement . in the context of equations  [ eqsin ] and  [ localpot ]",
    ", a correct definition of @xmath63 can be given as the points in the lattice which minimize eq .",
    "[ localpot ] ( it is easy to show that this definition is identical to the standard one in eq .  [ barx1d ] ) .",
    "interestingly , from this point of view the position @xmath63 can be thought of as an _ internal _ parameter of the formalism , which is implicit in the definition of the spread .",
    "since we are working with wannier functions which are expected to be well localized in space ( as the 1d state depicted in fig .  [ fig1 ] ) , there is actually no need to insist on using the pbc formulas for calculating wannier centers .",
    "one could argue here that our `` wannier functions '' are formally still periodic ( although represented on a large bvk supercell ) , and since their hilbert space is defined within pbc , only the action of pbc - allowed operators is justified on them .",
    "actually , another point of view can be used .",
    "we recall that _ true _ wannier functions are continuous functions in the full 3d ( reciprocal ) @xmath65-space .",
    "the mean value of a local operator @xmath66 in real space can be written @xmath67 or , equivalently in @xmath65-space ( @xmath68 is the continuous fourier transform of the wannier density @xmath69 ) : @xmath70 if the wannier function is localized ( i.e. zero beyond a given distance from its center ) , the integral in eq .",
    "[ eqrspace ] can be limited to a finite region of space , for example a cubic box centered around the region where the wannier density is nonzero .",
    "the @xmath65-space integral in eq .",
    "[ eqqspace ] can then be recast to a sum over a _",
    "discrete _ set of reciprocal space vectors , which is also _ finite _ because of the plane - wave cut off , and the result is still _",
    "exact_.    if the integration box is chosen to be smaller than the region where the wannier density is nonzero , then the reciprocal - space sum carries an error which is due to the overlap between the tails of the wannier functions and their ( artificially ) repeated images .",
    "this overlap depends on the decay properties of the localized state , and in particular it goes _ exponentially _ to zero for increasing integration box size whenever @xmath71 is exponentially localized .    in a standard dft simulation of a periodic crystal , the discrete set of reciprocal - space wannier function coefficients",
    "are defined by eq .",
    "[ wfgspace ] , and converge to their thermodynamic limit as soon as the total charge density is converged .",
    "then , the only effect of a further refinement of the @xmath1-points mesh is an increase in the bvk cell volume , which leads to the progressive reduction of the overlap term discussed above .",
    "therefore , assuming exponential decay for the wannier functions , our technique allows for an _ exponential _ convergence of the calculated expectation value of any free - space operator .",
    "the natural `` bounding box '' for the integration domain in real space is , for a general lattice , a wigner - seitz bvk cell aligned on the wannier center . with this choice ,",
    "the discrete fourier representation of a given local free - space operator ( we use here again the standard conventions for normalizations and fourier transforms ) is : @xmath72 and the expectation value is simply given as @xmath73    starting from a well - localized set of wannier functions we can now define a `` refined '' spread operator @xmath74 , where the contribution from the individual wf is : @xmath75 the @xmath76-space expression for this formula can be derived starting from the fourier series of a parabola in a one dimensional box : @xmath77 @xmath78 and is readily generalized to three dimensions using the same set of vectors and weights \\{@xmath79 } introduced in section 2 : @xmath80 + \\ ] ] @xmath81 the `` refined '' position @xmath82 which appears in eq .",
    "[ omeganprim ] is then again an _ internal parameter _ , which is defined by the minimum of @xmath83 for a given @xmath84 ( see the discussion at the end of section 3 ) . by taking the gradient of @xmath83 with respect to @xmath82",
    "one obtains that , at the minimum , the integral : @xmath85 vanishes . consistently with the definition of the spread , this condition has to be enforced in reciprocal space , where this integral becomes : @xmath86 , \\label{deltar}\\ ] ] the stationary point can be obtained iteratively starting from a set of maximally localized wannier functions and unrefined centers , by updating at every iteration @xmath82 through the addition of @xmath87 as calculated in eq .  [ deltar ] until convergence is reached .",
    "if the wannier function is exactly zero in a region surrounding the boundary of the wigner - seitz cell , one iteration is sufficient to provide the _ exact _ value of the center , while for less converged cases up to ten iterations may be necessary to achieve machine precision .",
    "these iterations have anyway negligible cost , since the fourier transform of the wannier function on the bvk cell has to be evaluated only at the beginning ( twice for each wannier function to get the density in reciprocal space ) .    both expressions @xmath21 and @xmath88",
    "are in fact particular cases of a class of localization criteria which rely on individual wannier densities only , through some generalized spread functional @xmath89 : @xmath90\\ ] ] a similar generalised , density - dependent spread can be used in practice to explore alternative localization criteria , like e.g. the maximal coulomb self - repulsion of edmiston and ruedenberg  @xcite , or the orbital self - interaction as defined by perdew and zunger  @xcite .",
    "an article comparing such alternatives is under preparation  @xcite .",
    "since the present free - space - like expressions for position and spread are more accurate than those derived in the first part of this work , one could wonder why we did not use them from the beginning . the reason is exclusively related to computational efficiency . in eqns .",
    "[ eqnsk ] the localization algorithm involves operations on small @xmath91 matrices only , where @xmath92 is the number of bands in the primitive cell ( the computationally intensive calculation of the @xmath93 matrices has to be performed only once at the beginning of the iterative minimization ) . if , instead , the refined spread ( or one of the alternative localization criteria discussed above ) is used directly for localizing the wannier functions , several fourier transforms on the full wannier ( bvk ) grid are required for each iteration , at a substantially higher cost .",
    "this expensive procedure is anyway not necessary for the scope of the present work , since the actual set of wannier wavefunctions obtained from one localization method or the other coincide in practice to a high degree of accuracy  @xcite ( in particular , the decay properties are expected to be very similar ) .",
    "therefore , we find it most convenient to use this refinement step in a one - shot fashion once a set of maximally localized wannier functions is obtained within the more efficient localization functional ( eqns .",
    "[ eqnsk ] ) .",
    "of oxygen in mgo as computed using the sum of unrefined wannier centers ( eq .  [ wancenk ] , circles ) , the berry - phase approach ( eq .  [ berry ] , diamonds ) and our new scheme ( eq .  [ omeganprim ] , squares ) .",
    "the blow - up in the inset shows the improvement of our method with respect to the berry - phase approach.,scaledwidth=40.0% ]    to demonstrate the effectiveness of our method we have chosen two examples which have been extensively studied in the literature : ( i ) the dynamical born effective charge of oxygen atoms in rocksalt mgo , and ( ii ) the spontaneous polarization of the ferroelectric , tetragonally distorted phase of knbo@xmath94 . our calculations were performed within the local density approximation  @xcite , by using norm - conserving troullier and martins  @xcite pseudopotentials in the kleinman and bylander  @xcite form .",
    "a non - linear core correction  @xcite was adopted for the mg pseudopotential , while the k pseudopotential was generated in the @xmath95 ionized configuration with the semicore @xmath96 orbitals included in the valence .",
    "we used the experimental lattice constants and atomic positions ( @xmath97=7.96 a.u .",
    "for mgo  @xcite , and the structural data for knbo@xmath94 from ref .  ) .",
    "we expanded the electronic ground state on a plane - wave basis up to a cutoff of 70 ry .",
    "the bz sampling was performed with @xmath0-centered simple cubic ( orthorombic ) grids in reciprocal space for mgo ( knbo@xmath94 ) , by taking into account the time - reversal symmetry only .",
    "we will compare the results as a function of @xmath1-mesh resolution for three different methods for calculating the polarization : ( i ) the sum of wannier centers as obtained by eq .",
    "[ wancenk ] ; ( ii ) the sum of _ refined _ wannier centers as described in the previous section ; ( iii ) the berry - phase approach .",
    "we note that the berry - phase result can be readily obtained from the quantities that are already available in the localization formalism : @xmath98      , red line and squares ) with respect to the standard `` trigonometric '' spread ( eq .  [ spreadk ] , black line and circles ) is apparent .",
    "we provide for comparison the alternative spreads discussed in the appendix , which are also based on the same trigonometric kernel and show similar , slow convergence properties.,scaledwidth=40.0% ]    , as computed using the sum of unrefined wannier centers ( eq .  [ wancenk ] , circles ) , the berry - phase approach ( eq .  [ berry ] , diamonds ) and our new scheme ( eq .  [ omeganprim ] , squares ) . ,",
    "scaledwidth=45.0% ]    the dynamical born effective charge ( @xmath99 ) of oxygen was calculated by the finite - difference method , i.e. by considering the difference in total polarization between the ideal centrosymmetric ground state and an atomic configuration where the oxygen sublattice was displaced by 1% of the cubic lattice constant along the @xmath59 direction .",
    "the atomic coordinates were prepared in such a way that , in the ideal lattice , the o atom sits at the origin , and in this case the electronic contribution to the polarization is exactly zero modulo a polarization quantum ( all four wannier functions are symmetrical about the o in this case ) .",
    "we compare in fig .",
    "[ figborn ] the resulting value for @xmath99 as calculated by the three different methods ( i - iii ) .",
    "the results clearly show that the sum of the _ unrefined _ wannier centers can be very inaccurate , and even for the finest mesh the error is still large .",
    "mgo is probably a very unfortunate case in that each @xmath100-like wannier function has a strongly asymmetric shape , and the errors in the individual centers do not cancel out efficiently in the strained configuration , so that the total polarization carries an important deviation from the exact value .",
    "the berry - phase calculation is a much better estimate , but in the inset it can be seen that the convergence is still relatively slow . as we explained in the preceding sections , it was already shown that the berry - phase result converges only as @xmath2 , i.e. it shares the same asymptotic behaviour as the sum of the unrefined wannier centers ( _ albeit _ with a quite different prefactor in this particular case ) .",
    "the sum of the _ refined _ wannier centers instead shows an extremely fast convergence , and gives a very accurate result already for a @xmath101 mesh .",
    "the value of @xmath99 we obtain is -1.95 , which is in excellent agreement with previous experimental and theoretical investigations  @xcite .    to complement our methodological test , we calculated also the refined value for the total quadratic spread as a function of @xmath1-mesh resolution , and the results",
    "are reported in fig .",
    "[ figspread ] .",
    "it is clear that this quantity shares the same , excellent , convergence properties as the position operator ( upper panel ) . in the lower panel of the same figure",
    "we report for comparison the results of an analogous calculation of the total spread in bulk silicon . the convergence is slower than in mgo , as can be expected from the very different character of this covalent compound as compared to the highly ionic magnesium oxide , but the benefit that can be obtained through the use of the more accurate free - space definition of the spread is still very clear .",
    "the `` unrefined '' value of the spread is also compared to the alternative , very similar prescriptions discussed in the appendix .",
    "we present in fig .",
    "[ figknbo3 ] our results for the spontaneous polarization of knbo@xmath94 .",
    "the sum of the unrefined wannier centers is less inaccurate in this case , and is fairly close to the values obtained within the berry phase formalism .",
    "the sum of the refined centers has , again , much better convergence properties than the two traditional methods . by increasing the mesh from @xmath102",
    "to @xmath103 the value of the spontaneous polarization increases by 0.02 % , while within the same @xmath103 mesh the traditional techniques carry an error which is two orders of magnitude higher . extrapolating the @xmath2 trend",
    "one can guess that @xmath104 @xmath1-points along the reciprocal space stripes  @xcite would be needed to achieve similar accuracy within the berry - phase formalism .",
    "the final value we obtain , 0.38 c / m@xmath105 , compares very well with experimental data and previous theoretical investigations  @xcite .",
    "in conclusion , we have derived a simple and general formalism for the computation of maximally localized wannier functions .",
    "we provide an intuitive picture of the convergence properties of this scheme and similar ones , relating them to the taylor expansion of elementary trigonometric functions .",
    "we show that the convergence can be dramatically improved by a simple strategy based on the exponential localization of the wannier functions in insulating materials .",
    "we expect our scheme to open the way to both accurate and efficient calculations of polarization properties in a wide range of physical systems , making the expensive linear - response approach or the relatively cumbersome non - self consistent calculation of `` stripes '' in reciprocal space unnecessary .    as a final remark",
    ", we note that the wannier function - based theory of polarization is becoming increasingly important especially in disordered systems , where not only the global polarization but also the _ local _ bonding properties and dipole moments may be interesting to follow during , e.g. a molecular dynamics simulation  @xcite . in these applications",
    "the improved accuracy provided by our method could be an extremely valuable tool .",
    "we wish to thank david vanderbilt for insightful comments on the manuscript .",
    "this work was supported by the national science foundation s division of materials research through the information technology research program , grant number dmr-0312407 , and made use of mrl central facilities supported by the national science foundation under award no .",
    "the form  [ eqspread ] for the spread functional was chosen mainly because of its simplicity , and because it allows for a direct interpretation as the integral of the wannier density multiplied by a real function on the bvk cell ( see the discussion in sec .",
    "unfortunately this expression does not lead to an elegant separation into invariant and non - invariant parts .",
    "however , this issue is readily solved by choosing an alternative definition of the spread : @xmath106 which coincides with the @xmath0-point prescription of mv and which _ does _ allow for an exact separation of the invariant part .",
    "this choice still allows for the simple interpretation based on cosine - like functions . if we define a function of @xmath107 : @xmath108   dx % \\label{localpot}\\ ] ] it is clear that when @xmath107 maximizes @xmath109 , @xmath107 is automatically the wannier center of eq .  [ eqwancen ] .",
    "both expressions for the spread ( @xmath21 as in eq .",
    "[ eqspread ] and @xmath110 discussed here ) are consistent with the same value of @xmath107 at the minimum : @xmath111\\ ] ] @xmath112\\ ] ]    moving on to 3d , the operational definition of the spread becomes : @xmath113 where it is easy to see that @xmath24 are nothing other than the matrix elements indicated as @xmath114 , @xmath115 , @xmath116 in mv .",
    "thinking in terms of the big bvk cell , this can be written equivalently as : @xmath118 gives the spread per _ primitive _ cell , and the same notations as mv for the @xmath119-th wannier function at the @xmath120 site , @xmath121 are used . from this expression",
    "it is clear how to construct an obvious invariant quantity , @xmath122 ( @xmath92 is the number of bands in the primitive cell ) : latexmath:[\\[\\omega_i   = \\frac{1}{n } \\sum_i \\bar{\\mathrm{w}}_i ( nj -   \\sum_{\\mathbf{r}\\mathbf{r}',nm }     this formula in @xmath1-space .",
    "a first simplification is trivial : @xmath124 and noticing that @xmath125 we obtain the final expression in @xmath1-space : @xmath126 which is exactly eq .",
    "34 of the mv paper .",
    "it is interesting to work out the remaining terms , @xmath127 and @xmath128 , which are indicated as `` diagonal '' and `` off - diagonal '' parts in mv ( we recall that @xmath127 vanishes for a centrosymmetric system  @xcite ) .",
    "the easiest way is to first solve the expression for latexmath:[\\[\\omega_{mv } - \\omega_d = \\sum_i \\bar{\\mathrm{w}}_i ( j -   \\sum_{\\mathbf{r},n }      comparing this formalism with the mv one , it is clear that @xmath133 and @xmath128 are identical , while the terms @xmath21 and @xmath127 differ .",
    "this derivation provide in a certain sense a `` unification '' of the two , formerly distinct , mv prescriptions for the @xmath0-point case and in @xmath1-space .",
    "the gradients with respect to unitary rotations of the bloch orbitals are simply given by setting @xmath134 ( instead of @xmath135 ) in eq .",
    "4 .    to complete our discussion",
    ", we note that a third form of the one - particle quadratic spread was proposed by resta and sorella  @xcite , which leads to yet another operational definition for the localization criterion : @xmath136 the @xmath1-space folding of this formula is straightforward , while the gradient is again given by eq .  4 , with @xmath137 .",
    "all functionals @xmath21 , @xmath110 and @xmath138 are identical in the thermodynamic limit . for finite bvk cells they all share the same definition of the wannier center .",
    "the resulting maximally localized wannier functions themselves are identical in cases where @xmath139 are equal for all @xmath140 bands ( e.g. bulk si , centrosymmetric mgo crystal ) .",
    "the numerical value of the spread can differ slightly , because the higher orders in the taylor expansion are different .",
    "some examples concerning this discrepancy are reported in the main text ( see , e.g. , fig .  [ figspread ] ) ."
  ],
  "abstract_text": [
    "<S> we present an alternative formalism for calculating the maximally localized wannier functions in crystalline solids , obtaining an expression which is extremely simple and general . in particular </S>",
    "<S> , our scheme is exactly invariant under brillouin zone folding , and therefore it extends trivially to the @xmath0-point case . </S>",
    "<S> we study the convergence properties of the wannier functions , their quadratic spread and centers as obtained by our simplified technique . </S>",
    "<S> we show how this convergence can be drastically improved by a simple and inexpensive `` refinement '' step , which allows for very efficient and accurate calculations of the polarization in zero external field . </S>"
  ]
}