{
  "article_text": [
    "quantum monte carlo simulations are emerging as a promising alternative route towards high - accuracy predictions of molecular and materials properties . the fixed - node approximation @xcite is widely used in quantum monte carlo simulations @xcite of many - fermion systems to avoid the sign problem @xcite .",
    "it consists of solving for the lowest - energy eigenstate , @xmath0 , of the hamiltonian , @xmath1 , with the boundary conditions that the wave function vanishes on the nodal surface of an anti - symmetric trial function , @xmath2 , i.e. at the points @xmath3 in configuration space where @xmath4 . the fixed - node energy ( fne)_i.e . _ the eigenvalue @xmath5 of the hamiltonian corresponding to @xmath0is an upper bound for the ground state energy , and",
    "it becomes exact if @xmath2 has the same nodes as the true ground state wave function , @xmath6 .",
    "therefore , for a given trial function , the fne is more accurate than the variational energy ( the expectation value of @xmath1 on @xmath2 ) , because exactness of the latter requires the stronger condition that @xmath2 coincide with @xmath6 for all @xmath3 .",
    "indeed , the fixed - node approximation offers the best viable numerical solution for several many - fermion problems @xcite .",
    "the ability to calculate low - order derivatives of the born - oppenheimer , energy with respect to an external parameter , @xmath7 , is an important ingredient of the calculation of materials properties .",
    "forces acting on individual atoms or the stress acting within an extended system are examples of first - order derivatives whose vanishing determines the mechanical equilibrium of a system .",
    "similarly , vibrational frequencies  as well as any kind of static generalized susceptibility  are determined by second - order derivatives .",
    "the calculation of derivatives of the fne , @xmath8 , has the potential of largely extending the scope of applications of quantum monte carlo simulations and spawning further methodological developments ( besides the examples given above , @xmath7 could also be the strength of any external field , or a variational parameter which modifies the nodal surface of @xmath2 ) .",
    "however technical difficulties @xcite have long hindered routine calculation of fne derivatives , and despite recent progress @xcite open questions still remain . in particular , the nodal displacement upon variation of @xmath7 has always been neglected _ in toto _ or in part @xcite , thus adding a further bias on top of the fixed - node approximation : referring to recent literature , @xmath7-independent nodes have been chosen in the path integral monte carlo calculation of electronic forces @xcite ; they _ have _ to be chosen so in applications of the hellmann - feynman theorem @xcite ; finally , the drift - diffusion factor of the propagator , together with its nodal contributions , has been dropped from the weights in correlated - sampling quantum monte carlo simulations @xcite .    in this paper",
    "we address the calculation of the derivatives of the fne without any further approximations . to this end",
    ", we examine in detail a simple but significant model that , we believe , is representative of the difficulties which are met in the calculation of these derivatives in more realistic situations .",
    "the focus being on the role of nodal displacements , we consider a system where such a role is crucial and a check against exact results is possible , namely a spinless fermi gas in two dimensions in a weak external field .",
    "the hamiltonian of our model system is : @xmath9 where the strength of the external field , @xmath7 , is the parameter upon which the fne is considered to depend , and where periodic boundary conditions have been assumed .",
    "the ground state is a slater determinant , @xmath10 , of @xmath7-dependent mathieu functions @xcite , whereas our trial function is @xmath11 with a symmetric jastrow factor @xmath12 which introduces spurious pair correlations .",
    "the fixed - node solution , exact in this case , is recovered as an absolutely non - trivial result of the simulation , since the trial function , wrong on purpose , can be made poor at will by tuning the _ pseudo - potential _",
    ", @xmath13 .",
    "we use the reptation quantum monte carlo ( rqmc ) method @xcite , in which the calculation of derivatives is simpler to implement than with branching algorithms  just as simple as in path integral monte carlo @xcite .",
    "the fne can be computed from the mixed estimate of the hamiltonian , @xmath14 by averaging the local energy @xmath15 over the mixed distribution @xmath16 .",
    "the unknown state @xmath0 is expressed in terms of @xmath2 through the imaginary - time propagator , @xmath17 . upon discretization of the imaginary time evolution and introduction of importance sampling",
    ", the mixed distribution can be cast into the form : @xmath18 where @xmath19 is the time step .",
    "the importance - sampled green s function , @xmath20 , is replaced by a short - time approximation , a common choice being @xcite @xmath21 with @xmath22 .    in the rqmc method",
    "a generalized metropolis algorithm is used to sample the probability distribution for a path of finite length in imaginary time ( a _ reptile _",
    ", @xmath23 , @xmath24 the limit in eq .",
    "( [ f ] ) being reached for large enough @xmath25 .",
    "replacement of eq .",
    "( [ f ] ) in ( [ e ] ) shows that the fne can be evaluated by averaging the local energy on the distribution @xmath26 , @xmath27 since @xmath28 is explicitly known , we can differentiate to get @xmath29 \\label{modo_derivata}\\end{aligned}\\ ] ] finite increments of amplitude @xmath30 are used for the evaluation of @xmath31 and @xmath32 on the path configurations sampled from @xmath28 .",
    "equivalently , finite increments can be used for @xmath5 via the correlated - sampling method : @xmath33 with @xmath34 , primed quantities being evaluated at @xmath35 .    ) ; right panel : eq .",
    "( [ wpiu ] ) with a smoothed @xmath36 .",
    "the range of @xmath37 and @xmath38 is @xmath39 . ]    in the _ variational _ quantum monte carlo ( vmc ) approximation , the probability distribution @xmath28 in eq .",
    "( [ modo_derivata ] ) or ( [ modo_rewate ] ) is replaced by @xmath40 .",
    "small energy differences are routinely calculated by vmc @xcite .",
    "the more accurate fna requires instead the full probability distribution of eq  ( [ p ] ) , which entails nontrivial difficulties through the term @xmath32 of eq .",
    "( [ modo_derivata ] ) . therefore we now examine in some detail the behavior of the probability distribution @xmath26 when a configuration along the path , say @xmath41 , approaches a node of @xmath2 .",
    "when the distance @xmath37 from the nodal surface is small enough , the dynamics of the system is dominated by the hard wall potential due to the fixed - node boundary conditions @xcite .",
    "the importance - sampled green s function should behave like that of a one - dimensional motion close to a hard wall @xmath42 $ ] , as shown in the left panel of fig .",
    "( [ g ] ) .",
    "the short time approximation @xmath43 , instead , is a very poor approximation near a node , because it assumes @xmath22 to be constant during a time step , whereas @xmath36 diverges as @xmath44 . the approximation ( [ wpiu ] ) for a one - dimensional motion close to a hard wall , shown in the middle panel of fig .",
    "( [ g ] ) , also bears little resemblance to @xmath45 .",
    "first , @xmath46 does not vanish at @xmath47 where @xmath45 does .",
    "sampling from @xmath46 would thus imply an unphysical finite density at the nodes ; the correct density , which is proportional to @xmath48 can be recovered including in the algorithm a metropolis test based on the square of the trial function @xcite .",
    "second , @xmath46 vanishes at @xmath49 where @xmath45 does not .",
    "this would imply a divergence proportional to @xmath50 of @xmath51 at the nodes , thus making the evaluation of the derivative , eq .  ( [ modo_derivata ] ) , impossible .",
    "such a divergence can be eliminated , leaving the zero - time - step limit unchanged , by a suitable cutoff on the quantum force , @xmath52 .",
    "we thus replace @xmath36 in eq .",
    "[ wpiu ] with @xmath53 @xcite .",
    "the resulting green s function , @xmath54 , is shown in the right panel of fig .",
    "( [ g ] ) . with this replacement",
    "the variance of the estimator ( [ modo_derivata ] ) of the derivative is finite .",
    "however we empirically find that the extrapolation of the result at @xmath55 can be problematic ( see also ref .",
    "[ 10 ] ) in the simulation of electrons in atoms and molecules , it proves convenient to use an interpolation between eq .",
    "( [ wpiu ] ) and a locally better green s function near the nuclei @xcite . in the same spirit",
    ", we use an interpolation @xmath56 between @xmath54 and a locally better green s function @xmath57 near the nodes : @xmath58 where the function @xmath59 smoothly varies from 0 to 1 as @xmath37 goes from 0 to @xmath60 . in the new green s function",
    "@xmath61 the potential @xmath62 is treated in the primitive approximation , whereas the nodal dependence has the correct behavior of @xmath45 .",
    "although the variance due to @xmath32 is finite using @xmath63 , a time - step dependent cutoff on @xmath37 is legitimate and can be useful .",
    "we turn now to the discussion of our results for the fermi gas .",
    "we first choose a very poor trial function @xmath64 with a pseudo - potential , @xmath65 where @xmath66 and @xmath67 , yielding a variational energy about 20% higher than the exact ground state energy ( whereas the fne and the exact result coincide in this case , since the slater determinant is the true ground state wave function ) . the derivative @xmath68 , with @xmath69 and @xmath70 , is calculated using @xmath56 .",
    "the result , shown in tab",
    ".  [ tabuno ] , does indeed recover the correct value .    for comparison , we also perform calculations using the approximation of ref .",
    "@xcite , which drops the drift - diffusion part of the propagator in eq .",
    "( [ modo_derivata ] ) and introduces an extra factor @xmath40 in order to recover the exact result in the limit of perfect importance sampling . as shown in tab .",
    "[ tabuno ] , the approximate algorithm is more efficient ( it gives a statistical error 3 times smaller for the same number of path configurations ) .",
    "however its result for the derivative is clearly biased . using a better trial function @xmath71 with @xmath72 the systematic bias of the approximate algorithm becomes smaller than statistical error .",
    "it is interesting to note that the ratio of the statistical error between the two methods does not seem to depend strongly on the quality of @xmath2 .",
    "we also have evidence that the efficiency depends on the number of particles only through the extra cost of sampling configurations for a larger system ( simulations have been performed for @xmath73 and @xmath74 particles ) .    .",
    "first derivative of fixed - node energy calculated with variational monte carlo ( vmc ) , using rqmc with @xmath75 and using the approximated algorithm as explained in the text [ cols=\"^,^,^,^,^,^,^,^,^\",options=\"header \" , ]      in fig .",
    "[ d1e_002 ] we show the time - step dependence of various derivatives calculated using different green s functions .",
    "data obtained with @xmath54 have smaller statistical errors than with @xmath56 , but their extrapolation to zero time - step is harder to guess in advance .",
    "the upper panel shows derivatives of the fne , @xmath76 .",
    "the calculation with @xmath56 extrapolates to the exact result assuming a quadratic time - step dependence , whereas an @xmath77 term seems necessary in order to account for the @xmath54 data .",
    "the problems with the @xmath78 limit using @xmath54 are more evident for the derivative of the density fluctuation , @xmath79 , where @xmath80 : as we can see from the lower panel of fig .",
    "( [ d1e_002 ] ) , in this case an even smaller power of @xmath81 would be required to extrapolate to the exact result at @xmath82 .    ) , upper panel , and of the density fluctuation ( @xmath83 ) , lower panel .",
    "we show calculations using @xmath56 ( black squares and diamonds ) and @xmath54 ( gray circles and stars ) ; the black lines are quadratic fits , whereas the gray lines include a square root term .",
    "[ d1e_002],width=264 ]    the physical interest in @xmath79 stems from its relation to the static dielectric response .",
    "the derivative of @xmath84 is evaluated as @xmath85 , with @xmath86 ( cfr .",
    "( [ modo_derivata ] ) @xcite ) .",
    "the same physical information can be formally obtained from @xmath87 .",
    "second derivatives are in principle straightforward to evaluate , but differentiation of eq .",
    "( [ modo_derivata ] ) leads to terms containing @xmath88 and @xmath89 which have large fluctuations .    despite its low efficiency , the calculation of second derivatives of the energy offers an interesting conceptual advantage over the first derivative of the density fluctuation .",
    "suppose we do nt know the exact nodal dependence of @xmath2 on the strength @xmath7 of the external field .",
    "starting from plane - wave nodes at @xmath90 , we can explore a family of wave functions , @xmath91 , in which the one - particle orbitals are mathieu functions calculated for an external potential of strength @xmath92 _ different _ from the physical value @xmath7 .",
    "the nodal dependence of @xmath91 on @xmath7 varies with @xmath93 : for @xmath94 , no nodal displacements are allowed ; for @xmath95 , the exact nodal dependence is recovered .",
    "we can compute within the _ same _ run ( hence in a correlated way ) the values of @xmath96 pertaining to several choices of @xmath93 .",
    "the result is shown in fig .",
    "( [ d2e_lambda ] ) .",
    "because of the variational character of the fixed node approximation , the optimal nodal dependence ( within the family @xmath91 , and within error bars ) is given by the value @xmath93 corresponding to the minimum of @xmath96 . inspection of fig .",
    "( [ d2e_lambda ] ) leads us to conclude that : ( i ) suppression of the nodal dependence ( @xmath94 ) leads to a small statistical error , but produces a large bias ; ( ii ) the minimum of @xmath96 is consistent with the exact nodal dependence ( @xmath95 ) ; ( iii ) the dependence of @xmath96 on @xmath93 is quadratic , so that calculations for just 3 values of @xmath93 would suffice ( this could be useful for a higher - dimensional optimization ) .",
    "unfortunately , the calculation of second derivatives has still very large statistical errors ( if nodal displacement is properly included ) .",
    "we hope that a successful implementation of noise reduction techniques @xcite could eventually turn it into a convenient computational tool .",
    "further perspectives in nodal optimization are offered by the calculation of first derivatives of the fne , for instance in conjunction with the stochastic gradient approximation method @xcite .",
    "anderson , j. chem .",
    "* 63 * , 1499 ( 1975 ) ; _ ibid . _",
    "* 65 * , 4121 ( 1976 ) ; j.w .",
    "moskowitz , k. e. schmidt , m.a .",
    "lee and m.h .",
    "kalos j. chem . phys . * 77 * 349 ( 1982 ) : p.j .",
    "reynolds , d. m. ceperley , b. j. alder and w.a .",
    "lester , j. chem . phys . * 77 * , 5593 ( 1982 ) . for a recent review on fixed - node diffusion quantum monte carlo and further references , see m. foulkes , l. mitas , r. needs and g. rajagopal , rev .",
    "phys . * 73 * , 33 - 83 ( 2001 ) .",
    "kalos and p. whitlock _ monte carlo methods _",
    "( wiley & sons , 1986 ) b. l. hammond , w. a. lester and p. j. reynolds , _ monte carlo methods in ab initio quantum chemistry _ ( world scientific , singapore , 1994 ) .",
    "f. zong and d. m. ceperley , phys .",
    "e * 58 * , 5123 ( 1998 ) . c. filippi and c. j. umrigar , phys .",
    "b * 61 * , r16291 ( 2000 ) .",
    "r. assaraf and m. caffarel , j. chem . phys . * 113 * , 4028 ( 2000 ) .",
    "this is true with one exception @xcite ; however it seems fair to say that the results reported in ref .",
    "@xcite need a somewhat educated guess for the extrapolation to zero time step .",
    "f. schautz and h .- j .",
    "flad , j. chem . phys . * 110 * , 11700 ( 1999 ) ; k. c. huang , r. j. needs and g. rajagopal , j. chem .",
    "* 112 * , 4419 ( 2000 ) ; f. schautz and h .- j .",
    "flad , j. chem . phys .",
    "* 112 * , 4421 ( 2000 ) .",
    "lett . * 83 * , 4682 ( 1999 ) .",
    "we assume in the argument smoothness of the factor @xmath100 of @xmath101 .",
    "it is common practice to smooth the divergence of the local energy at the nodes when evaluating eq .",
    "( [ wpiu ] ) . c. j. umrigar , m. p. nightingale and k. j. runge , j. chem .",
    "phys . * 99 * , 2865 ( 1993 ) .",
    "i. s. gradshstein and i.m .",
    "ryzhik,_tables of integrals , series and products _",
    "( academic press , new york , 1980 ) s. baroni and s. moroni , phys . rev .",
    "lett . * 82 * , 4745 ( 1999 ) within rqmc it is straightforward to compute unbiased expectation values of observables that do not commute with the hamiltonian @xcite . see e.g. r. assaraf and m. caffarel , phys .",
    "83 * , 4682 ( 1999 )"
  ],
  "abstract_text": [
    "<S> we present quantum monte carlo calculations of total energy derivatives , consistently performed in the fixed - node approximation . </S>",
    "<S> contributions from nodal displacements , neglected or approximated in previous investigations , are properly taken into account . </S>",
    "<S> their impact on the efficiency is discussed . </S>"
  ]
}