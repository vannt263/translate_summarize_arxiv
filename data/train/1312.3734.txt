{
  "article_text": [
    "modern density - functional theory ( dft ) was introduced by hohenberg and kohn in a classic paper  @xcite and is now the workhorse of quantum chemistry and other fields of quantum physics .",
    "subsequently , dft was put on a mathematically firm ground by lieb using convex analysis.@xcite the central quantity of dft is the universal density functional @xmath11 , which represents the electronic energy of the system consistent with a given density @xmath12 . clearly , the success of dft hinges on the modelling of @xmath0 , an extremely complicated function of the electron density .",
    "it is an interesting observation that , over the last two or three decades , @xmath0 has been modelled sufficiently accurately to make dft the most widely applied method of quantum chemistry , in spite of the fact that schuch and verstraete  @xcite have shown how considerations from the field of computational complexity place fundamental limits on exact dft : if @xmath11 could be found efficiently , all np hard problems would be solvable in polynomial time , which is highly unlikely.@xcite    from a mathematical point of view , dft is neatly formulated using convex analysis@xcite : the universal density functional @xmath11 and the ground - state energy @xmath7 are related by a conjugation operation , with the density @xmath12 and external potential @xmath13 being elements of a certain banach space @xmath14 and its dual @xmath15 , respectively .",
    "the functionals @xmath0 and @xmath2 are equivalent in the sense that they contain the same information  each can be generated exactly from the other .",
    "the universal density functional @xmath0 is convex and lower semi - continuous but otherwise highly irregular and ill behaved .",
    "importantly , @xmath0 is everywhere discontinuous and not differentiable in any sense that justifies taking the functional derivative in formal expressions  even for the @xmath13-representable densities ,",
    "as pointed out by lammert.@xcite for example , it is common practice to formally differentiate @xmath0 with respect to the density , interpreting the functional derivative `` @xmath16 '' as a scalar potential at  @xmath17 .",
    "however , this derivative , a gteaux derivative , does not exist .",
    "together with the problem of @xmath13-representability , conventional dft is riddled with mathematically unfounded assumptions that are , in fact , probably false .",
    "for example , conventional kohn  sham theory assumes , in addition to differentiability of @xmath0 , that , if @xmath12 is @xmath13-representable for an interacting @xmath18-electron system , then @xmath12 is also @xmath13-representable for the corresponding noninteracting system.@xcite while providing excellent predictive results with modelled approximate density functionals , it is , from a mathematical perspective , unclear why kohn  sham dft works at all .",
    "it is the goal of this article to remedy this situation by introducing a family of regularized dfts based on a tool from convex analysis known as the _ moreau envelope _ or _",
    "yosida regularization_. for @xmath3 , the idea is to introduce a regularized energy functional @xmath19 related to the usual ground - state energy @xmath2 by @xmath20 where @xmath21 is the usual @xmath22-norm .",
    "the convex conjugate of @xmath23 is the moreau envelope @xmath24 of @xmath0 , from which the regularized ground - state energy can be obtained by a hohenberg - kohn minimization over densities : @xmath25 where @xmath26 .",
    "the usual hohenberg ",
    "kohn variation principle is recovered as @xmath5 .",
    "importantly , the moreau envelope @xmath27 is _ everywhere differentiable _ and converges pointwise from below to @xmath11 as @xmath5 .",
    "we use the term `` regularized '' for both @xmath23 and @xmath28 , although it is @xmath28 that , as will be shown below , becomes differentiable through the procedure .",
    "a remark regarding the banach spaces of densities and potentials is here in order . if @xmath13 is a coulomb potential , then the regularization term in eq .",
    "becomes infinite .",
    "moreover , the strongest results concerning the moreau  yosida regularization are obtained in a reflexive setting . the usual banach spaces @xmath29 and @xmath30 for densities and potentials , respectively,@xcite are therefore abandoned , and both replaced with the hilbert space @xmath31 , where @xmath32 ^ 3 $ ] is an arbitrarily large but finite box in @xmath33 . as is well known , domain truncation represents a well - behaved approximation : as @xmath34 increases , all eigenvalues converge to the @xmath33-limit .",
    "moreover , the continuous spectrum is approximated by an increasing number of eigenvalues whose spacing converges to zero .",
    "we observe that , in the box , the difference @xmath35 is arbitrarily small and _",
    "explicitly known_it does not relate to the electronic structure of the system and is easily calculated from @xmath13 .",
    "nothing is therefore lost in the transition from @xmath1 to @xmath36 . on the contrary",
    ", we obtain a structurally simpler theory that allows taking the derivative of expressions involving the universal functional",
    ". moreover , the differentiability of @xmath37 implies @xmath13-representability of any @xmath12 , for noninteracting as well as interacting systems , as needed for a rigorous formulation of kohn  sham theory . in this paper",
    ", we explore the moreau envelope as applied to dft , demonstrating how every concept of standard dft has a counterpart in the moreau - regularized formulation of dft and vice versa .",
    "the remainder of the article is organized as follows : in sec.[sec : prelim ] , we review formal dft and discuss the regularity issues of the universal functional within the nonreflexive banach - space setting of lieb.@xcite in preparation for the moreau  yosida regularization , we next reformulate dft in a truncated domain , introducing the hilbert space @xmath31 as density and potential space .",
    "the moreau ",
    "yosida regularization is a standard technique of convex analysis , applicable to any convex function such as the universal density functional .",
    "we introduce this regularization in sec.[sec : my ] , reviewing its basic mathematical properties .",
    "to establish notation , a review of convex analysis is given in the appendix ; for a good textbook of convex analysis in a hilbert space , with an in - depth discussion of the moreau ",
    "yosida regularization , see ref .  .",
    "following the introduction of the moreau ",
    "yosida regularization , we apply it to dft in sec.[sec : mydft ] and subsequently to kohn ",
    "sham theory in sec.[sec : ks ] .",
    "finally , sec.[sec : conclusion ] contains some concluding remarks .",
    "in dft , we express the born ",
    "oppenheimer ground - state problem of an @xmath18-electron system in the external electrostatic potential @xmath38 as a problem referring only to the one - electron density @xmath39 .",
    "oppenheimer @xmath18-electron molecular hamiltonian is given by @xmath40 where @xmath41 and @xmath42 are the kinetic - energy and electron - electron repulsion operators , respectively , while @xmath43 is a multiplicative @xmath18-electron operator corresponding to the scalar potential @xmath38 .",
    "the scalar @xmath44 is introduced to distinguish between the interacting ( @xmath45 ) and noninteracting ( @xmath46 ) systems .    by levy s constrained - search argument,@xcite the ( fully interacting ) ground - state energy ,",
    "@xmath47 can be written in the form of a hohenberg ",
    "kohn variation principle , @xmath48 where @xmath49 is the set of @xmath18-representable densities  that is , @xmath50 if and only if there exists a normalized @xmath18-electron wave function with finite kinetic energy and density @xmath12 . in eq .",
    ", the infimum extends over all properly symmetrized and normalized @xmath51 , the first - order sobolev space consisting of those functions in @xmath52 that have first - order derivatives also in @xmath52 and therefore have a finite kinetic energy .",
    "different universal density functionals @xmath0 can be used in  eq.([eq : e_of_v_dft ] ) , the only requirement of an admissible functional being that the correct ground - state energy @xmath7 is recovered .",
    "given that @xmath53 , it follows that @xmath54 .",
    "as demonstrated by lieb in ref .  , the universal density functional @xmath0 can be chosen as a unique lower semi - continuous convex function with respect to the @xmath55 topology .",
    "( by definition , therefore , @xmath56 for any @xmath57 ; see appendix  a for remarks on extended - valued functions . ) moreover , by a sobolev inequality,@xcite we may embed the @xmath18-representable densities in the banach space @xmath58 , with norm @xmath59 and topological dual @xmath60 .",
    "given that this banach space @xmath14 has a stronger topology than @xmath61 , a convergent sequence in @xmath14 converges also in @xmath62 . from the lower semi - continuity of @xmath0 in @xmath61 ,",
    "we then obtain @xmath63 implying that @xmath0 is lower semi - continuous also in the topology of @xmath14 .",
    "we note that the choice @xmath64 is not unique , but it has the virtue that all coulomb potentials are contained in @xmath15 .    on the chosen banach spaces , the ( concave and continuous ) ground - state energy @xmath65 and the ( convex and lower semi - continuous ) universal density functional @xmath66 are related by the variation principles    @xmath67    in the terminology of convex analysis ( see appendix a ) , @xmath68 and @xmath69 are each other s convex fenchel conjugates . to reflect the nonsymmetric relationship between @xmath2 and @xmath0 in eqs . and",
    ", we introduce the nonstandard but useful mnemonic notation    @xmath70    which is suggestive of the `` shape '' of the resulting functions : @xmath71 is concave , whereas @xmath72 is convex .",
    "the density functional @xmath0 in  eq . is an extension of the universal functional @xmath73 derived by hohenberg and kohn,@xcite the latter functional having from our perspective the problem that it is defined only for ground - state densities ( @xmath13-representable densities ) in @xmath74 , an implicitly defined set that we do not know how to characterize .",
    "it can be shown that the functional @xmath0 defined by eq . is identical to the constrained - search functional  @xcite @xmath75 , where the minimization is over all ensemble density matrices",
    "@xmath76 corresponding to a density @xmath12 , constructed from @xmath18-electron wave functions with a finite kinetic energy . a related functional is the ( nonconvex ) levy  lieb constrained search functional,@xcite @xmath77 , obtained by minimizing over pure states only . in any case , eq . defines the _ unique _ lower semi - continuous , convex universal functional such that @xmath78 .",
    "in fact , any @xmath79 that satisfies the condition @xmath80 is an admissible density functional . in particular , @xmath81 and @xmath73",
    "are both admissible , satisfying this requirement when extended from their domains ( @xmath49 and @xmath82 , respectively ) to all of @xmath14 by setting them equal to @xmath83 elsewhere .",
    "the hohenberg ",
    "kohn variation principle in eq .",
    "is appealing , reducing the @xmath18-electron problem to a problem referring only to one - electron densities .",
    "however , as discussed in the introduction , @xmath0 is a complicated function . in particular",
    ", here we consider its nondifferentiability .",
    "the gteaux derivative is closely related to the notion of directional derivatives , see appendix  a. a function @xmath0 is gteaux differentiable at @xmath84 if the directional derivative @xmath85 is linear and continuous in all directions @xmath86 , meaning that there exists a @xmath87 such that @xmath88 however , @xmath0 is finite only on @xmath49 . in a direction @xmath89",
    "such that @xmath90 , @xmath91 for all @xmath92 , implying that @xmath93 and hence that @xmath0 is not continuous in the direction of @xmath94 .",
    "the same argument shows that @xmath0 is discontinuous also in directions @xmath94 such that the density @xmath95 is negative in a volume of nonzero measure for all @xmath92 .    abandoning strict gteaux differentiability for this reason , we may at the next step",
    "investigate whether the directional derivative exists and is linear for directions that stay inside @xmath96 , the subset of @xmath14 containing all nonnegative functions that integrate to @xmath18 electrons .",
    "after all , the discontinuity of @xmath0 in directions that change the particle number is typically dealt with using a lagrange multiplier for the particle number constraint .",
    "however , lammert has demonstrated that , even within @xmath96 , there are , for each @xmath12 , directions such that @xmath93 , associated with short - scale but very rapid spatial oscillations in the density ( and an infinite kinetic energy).@xcite      apart from lower ( upper ) semi - continuity of a convex ( concave ) function , the minimal useful regularity is not gteaux differentiability but subdifferentiability ( superdifferentiability ) , see appendix  a. let @xmath97 be convex lower semi - continuous .",
    "the subdifferential of @xmath98 at @xmath99 , @xmath100 , is by definition the collection of slopes of supporting continuous tangent functionals of @xmath98 at @xmath99 , known as the _ subgradients _ of @xmath98 at @xmath99 , see fig .",
    "[ fig : tangents ] in appendix  a. if the graph of @xmath98 has a `` kink '' at @xmath99 , then there exists more than one such subgradient .",
    "at a given point @xmath101 , the subdifferential @xmath102 may be empty .",
    "we denote by @xmath103 the set of points @xmath101 such that @xmath104 .",
    "it is a fact that @xmath103 is dense in @xmath105 when @xmath98 is a proper lower semi - continuous convex function .",
    "the superdifferential of a concave function is similarly defined .    together with convexity , subdifferentiability is sufficient to characterize minima of convex functions : a convex lower semi - continuous functional @xmath106 has a global minimum at @xmath107 if and only if @xmath108 . similarly @xmath109 has a minimum if and only if @xmath110 .",
    "subdifferentiability is a substantially weaker concept than that of gteaux ( or directional ) differentiability . clearly , if @xmath111 is gteaux differentiable at @xmath99 , then @xmath112 .",
    "however , the converse is not true : in infinite - dimensional spaces , it is possible that @xmath113 , a singleton , while @xmath111 is not differentiable at @xmath99 .",
    "this is so because @xmath102 being a singleton is not enough to guarantee continuity of @xmath98 .    in dft",
    ", subdifferentiability has an important interpretation .",
    "suppose @xmath12 is an ensemble ground - state density of @xmath13 , meaning that , for all @xmath114 , we have the inequality @xmath115 then , the subdifferential of @xmath11 at @xmath12 is @xmath116 which is a restatement of the first hohenberg ",
    "kohn theorem : the potential for which @xmath12 is a ground - state density is unique up to a constant shift . on the other hand , if @xmath12 is not a ground - state density for any @xmath117 , then @xmath118 .",
    "thus , a nonempty subdifferential is equivalent to ( ensemble ) @xmath13-representability : @xmath119 if and only if @xmath12 is @xmath13-representable . denoting the set of ensemble @xmath13-representable densities by @xmath120",
    ", we obtain @xmath121 we note that @xmath120 is dense in @xmath96 , the subset of @xmath14 containing all nonnegative functions that integrate to @xmath18 electrons .",
    "however , even though subdifferentiability is sufficient for many purposes , differentiability of @xmath0 would make formal manipulations easier . moreover , the characterization of @xmath13-representable @xmath122 is unknown and probably dependent on the interaction strength @xmath44 .",
    "these observations motivate the search for a differentiable regularization of the universal functional .",
    "let us briefly consider the superdifferential of @xmath2 , a concave continuous ( and hence upper semi - continuous ) function over @xmath15 . a fundamental theorem of convex analysis states that @xmath123 where we use the same notation for sub- and superdifferentials .",
    "thus , the potential @xmath13 has a ground state with density @xmath12 if and only if @xmath124 ; if @xmath13 does not support a ground state , then @xmath125 is empty . denoting the set of potentials in @xmath15 that support a ground state by @xmath126",
    ", we obtain : @xmath127 if a ground state is nondegenerate , then @xmath128 is a singleton ; together with the fact that @xmath2 is continuous , it then follows that @xmath2 is gteaux differentiable at @xmath13 . on the other hand , if the ground state is degenerate , then the subdifferential is the convex hull of @xmath129 ground - state densities : @xmath130 and @xmath2 is not differentiable at this @xmath13 unless all the @xmath131 are equal  that is , if the degenerate ground states have the same density . for example , in the absence of a magnetic field , the hydrogen atom has the degenerate ground states @xmath132 and @xmath133 , with the same density .",
    "in sec .  [ sec : my ] , we outline the mathematical background for the moreau  yosida regularization . many useful results , such as differentiability of the moreau envelope @xmath27 , are only available when the underlying vector space @xmath14 is reflexive or , even better , when @xmath14 is a hilbert space",
    ". however , the banach space @xmath134 used in lieb s formulation of dft is nonreflexive . in this section ,",
    "we truncate the full space @xmath33 to a box @xmath135 ^ 3 $ ] of finite volume @xmath136 , so large that the ground state energy of every system of interest is sufficiently close to the @xmath33 limit .",
    "what is lost from this truncation is well compensated for by the fact that we may now formulate dft using the hilbert space @xmath137 for both potentials and densities , as we shall now demonstrate .      for the spatial domain @xmath138 ,",
    "the @xmath18-electron ground - state problem is a variational search for the lowest - energy wave function @xmath139 , the first - order sobolev space with vanishing values of the boundary of @xmath140 , the @xmath18-fold cartesian product of @xmath138 .",
    "the search is carried out only over the subset of @xmath141 which is also normalized and properly symmetrized : for a total spin projection of @xmath142 , the corresponding subset of wavefunctions is antisymmetric in the @xmath143 first and the @xmath144 last particle coordinates separately .",
    "any potential in the full space , @xmath145 , induces a potential @xmath146 in the truncated domain .",
    "we remark that @xmath147 , with equivalent topologies . since the domain is bounded , the rellich  kondrakov theorem@xcite states that @xmath141 is compactly embedded in @xmath148 , which in turn implies that the spectrum of the hamiltonian @xmath149 in eq . is purely discrete.@xcite thus , for any potential @xmath13 in the box , one or more ground - state wave functions @xmath150 exists .",
    "we next observe that , if @xmath151 is a coulomb potential , then the truncated potential @xmath13 belongs to @xmath31 .",
    "moreover , @xmath152 since @xmath138 is bounded .",
    "it is therefore sufficient to consider the ground - state energy as a function @xmath153 regarding the continuity of @xmath154 , we note that the proof given in ref .   for the continuity of @xmath2 in the @xmath155 topology",
    "is equally valid for @xmath154 in the @xmath156 topology .",
    "convergence in @xmath31 implies convergence in @xmath157 .",
    "therefore , @xmath154 is continuous in the @xmath31 topology .",
    "we remark that , as @xmath158 , @xmath159 converges to the exact , full - space ground - state energy @xmath7 . on the other hand ,",
    "the associated eigenfunctions converge if and only if the full - space ground - state energy @xmath7 is an eigenvalue , with @xmath160 as a counterexample .      invoking the usual ensemble constrained - search procedure ,",
    "we obtain @xmath161 where @xmath162 is the set of @xmath18-representable densities : @xmath163 if and only if there exists a properly symmetrized and normalized @xmath164 such that @xmath165 .",
    "it is straightforward to see that @xmath166 the density functional @xmath167 is completely analogous to the full - space functional @xmath0 . in particular , @xmath167 is lower semi - continuous in the @xmath168 topology by theorem  4.4 and corollary  4.5 in ref .  .",
    "we remark that @xmath169 for any @xmath163 , as seen from the fact that , if @xmath51 and @xmath170 with @xmath171 , then we must have @xmath164 .",
    "since @xmath138 is bounded , the cauchy  schwarz inequality gives for any measurable @xmath172 , @xmath173 by an argument similar to that of eq .",
    ", @xmath167 is now seen to be lower semi - continuous also with respect to the @xmath31 topology .",
    "note that @xmath174 so that every @xmath18-representable density is in @xmath31 . since @xmath167 is convex and lower semi - continuous on @xmath175 , we may now formulate dft in the hilbert space @xmath176 as    @xmath177    given that hilbert spaces possess a richer structure than banach spaces , this formulation of dft is particularly convenient : densities and potentials are now elements of the same vector space @xmath176 and reflexivity is guaranteed .",
    "even for the full space , @xmath178 , indicating that it is possible to avoid the use of the box .",
    "indeed , we may restrict the ground - state energy to potentials @xmath179 : @xmath180 a concave and continuous map . invoking the theory of conjugation within this reflexive hilbert - space setting",
    ", we have a convex lower semi - continuous universal functional @xmath181 however , coulomb potentials are not contained in @xmath182 . on the other hand , this theory is sufficient for dealing with all truncated coulomb potentials , obtained , for example , from the usual coulomb potentials by setting them equal to zero outside the box @xmath183 ; it is also sufficient when working with yukawa rather than coulomb potentials .",
    "the optimality conditions for the hohenberg  kohn and lieb variation principles in eqs . and   are @xmath184 denoting the set of densities for which @xmath167 is subdifferentiable by @xmath185 ( by analogy with @xmath120 in @xmath14 ) and the set of potentials for which @xmath154 is superdifferentiable by @xmath186 ( by analogy with @xmath126 in @xmath187 ) , we obtain @xmath188 where @xmath189 is dense in the subset of @xmath176 containing all nonnegative functions that integrate to @xmath18 electrons .",
    "the differentiability properties of @xmath167 are the same as those of @xmath0 discussed in section  [ sec : nonreg ] .",
    "to introduce differentiability , a further regularization is necessary .",
    "in this section , we present the basic theory of moreau  yosida regularization , introducing infimal convolutions in section[subsec : inf ] , moreau envelopes in section[subsec : moreau ] , proximal mappings in section[subsec : prox ] , and conjugates of moreau envelopes in section[subsec : conmoreau ] . the results are given mostly without proofs ; for these proofs , we refer to the book by bauschke and  combettes,@xcite whose notation we follow closely .      in preparation for the moreau ",
    "yosida regularization , we introduce the concept of infimal convolution in this section and discuss its properties on a hilbert space @xmath190 .    for @xmath191 ,",
    "the _ infimal convolution _ is the function @xmath192 given by @xmath193    in the context of convex conjugation , the infimal convolution is analogous to the standard convolution in the context of the fourier transform . here",
    "are some basic properties of the infimal convolution for functions that do not take on the value @xmath194 :    [ thm : infimal ] let @xmath191 .",
    "then :    1 .   @xmath195 ; 2 .",
    "@xmath196 ; 3 .",
    "@xmath197 ; 4 .   if @xmath98 and @xmath129 are convex , then @xmath198 is convex .",
    "see ref  , props .",
    "12.6 ,  12.11 and  13.21 .    henceforth , we restrict our attention to _ all lower semi - continuous proper convex functions _",
    "@xmath199 , denoting the set of all such functions by @xmath200 , see appendix  [ matsup ] .",
    "we also need the concepts of coercivity and supercoercivity : a function @xmath201 is _ coercive _ if @xmath202 whenever @xmath203 and _ supercoercive _ if @xmath204 whenever @xmath203 . for example",
    ", @xmath205 is coercive , whereas @xmath206 is not coercive .    for functions in @xmath200",
    ", we have the following stronger properties of the infimal convolution :    [ thm : infimal2 ] let @xmath207 such that either @xmath129 is supercoercive or @xmath98 is bounded from below and @xmath129 is coercive",
    ". then    1 .",
    "@xmath208 ; 2 .",
    "@xmath209 ; 3 .",
    "[ item : uniqueness ] for each @xmath210 , there exists @xmath211 such that @xmath212 where @xmath213 is unique if @xmath129 is strictly convex .",
    "point  1 follows from ref .  , prop .",
    "point  2 follows from theorem  [ thm : infimal ] above .",
    "finally , point 3  follows from the fact that strictly convex functions have unique minima ; the existence of a minimum follows from the ( super)coerciveness of the mapping @xmath214 .      in the following ,",
    "we introduce the moreau envelope of functions in @xmath200 and review its properties .",
    "[ def : myx ] for @xmath215 and @xmath216 , the _ moreau  yosida regularization _ or the _ moreau envelope _",
    "@xmath217 is the infimal convolution of @xmath98 with @xmath218 : @xmath219    since @xmath215 and since @xmath218 is strictly convex and supercoercive , it follows from theorem[thm : infimal ] that @xmath220 .",
    "in fact , @xmath221 is much more well behaved than a general function in @xmath200 , as the following theorem shows .",
    "[ thm : my ] the moreau envelope @xmath221 of @xmath215 with @xmath222 satisfies the following properties :    1 .",
    "@xmath220 with @xmath223 ; 2 .",
    "@xmath224 for all @xmath210 and all @xmath225 ; 3 .",
    "@xmath226 ; 4 .   for all @xmath227 , @xmath228 from below as @xmath5 ( even if @xmath229 ) ; 5 .",
    "@xmath221 is continuous ; 6 .",
    "@xmath221 is frchet differentiable : for every @xmath210 , there exists @xmath230 such that for all @xmath231 : @xmath232 7 .",
    "the subdifferential of @xmath221 at @xmath99 is given by @xmath233    point1 follows from theorems  [ thm : infimal ] and  [ thm : infimal2 ] . for points  2 and 3 ,",
    "see ref . ,",
    "12.9 . for point 4 , see prop .",
    "12.32 . for points 57 ,",
    "see props .  12.15 , 12.28 , and 12.29 .    in figure",
    "[ fig : moreau ] , the moreau envelope is illustrated for a convex function @xmath98 on the real axis .",
    "we observe that the minimum value of @xmath111 is preserved by the moreau envelope @xmath234 and that the second argument @xmath235 to the infimal convolution removes all kinks , giving a curvature equal to that of this function .    .",
    "the function @xmath236 is plotted in thick lines , whereas @xmath111 is shown in a thinner line .",
    "finally , for a chosen value of @xmath237 , the function @xmath238 is superposed on @xmath111 and @xmath239 using a dashed line .",
    "[ fig : moreau ] ]      from theorem[thm : infimal ] , it follows that the infimum of @xmath239 in eq .",
    "is attained with a unique minimizer .",
    "we make the following definitions :    [ prox ] let @xmath215 and @xmath216 .",
    "the _ proximal mapping _",
    "@xmath240 is defined by @xmath241 where @xmath242 is _ the proximal point of @xmath98 at @xmath210_.    the usefulness of the proximal mapping follows from the following theorem :    [ thm : my2 ] let @xmath215 and @xmath216",
    ". then    1 .",
    "if @xmath243 and @xmath5 , then @xmath244 2 .",
    "the frchet ( and gteaux ) derivative of @xmath221 at @xmath99 is given by @xmath245 3 .",
    "for all @xmath246 , it holds that @xmath247 4 .   if @xmath210 , then @xmath248    for point 1 , see the proof of prop .  12.32 in ref .  .",
    "for point 2 , see prop .  12.29 ; for point 3 , see prop .",
    "point 4 follows from point 2 and 3 .",
    "given that @xmath220 , there exists a concave @xmath249 such that @xmath250 and @xmath251 .",
    "the following theorem gives the basic properties of this conjugate :    [ thm : cmy ] if @xmath221 is the moreau envelope of @xmath215 , then their conjugates and the superdifferentials of these conjugates are related as    @xmath252    eq .",
    "follows from the fact that the convex conjugate of @xmath253 is @xmath254 and from theorem  [ thm : infimal ] .",
    ". follows from the fact that the superdifferential of a sum of concave functions is the sum of their superdifferentials if one of the functions is continuous at a common point in their domains , see remark  16.36 of ref .  .",
    "finally , @xmath255 .",
    "being related in such a simple manner , @xmath256 and @xmath257 share many properties .",
    "we note , however , that @xmath257 is strictly concave , whereas @xmath256 may be merely concave .",
    "we remark that the moreau envelope is not defined for a _ concave _ function @xmath258 , only for convex functions .",
    "thus , the notation @xmath259 for a @xmath260 is not to be interpreted as a moreau envelope , but as the _ concave conjugate _ of a moreau envelope , @xmath261 .",
    "having introduced moreau  yosida regularization in the preceding section , we are ready to apply it to dft on the hilbert space @xmath175 .      applying eqs . and   with @xmath262 and @xmath263 , we obtain the regularized lieb functional @xmath264 and ground - state energy @xmath265 ,    @xmath266    importantly , these functions are related to each other as conjugate functions ; just as we have already encountered for the @xmath1 and @xmath267 conjugate pairs . as such , the following hohenberg  kohn and lieb variation principles hold on the hilbert space @xmath176 :    @xmath268    however , unlike @xmath0 and @xmath167 , which are finite only for @xmath18-representable densities , the moreau ",
    "yosida regularized lieb functional @xmath269 is finite on the whole hilbert space : @xmath270 since , in eq .",
    ", a finite value is always found on the right - hand side , even when @xmath271 .",
    "a curious side effect of the regularization is therefore that the minimizing density in the regularized hohenberg ",
    "kohn variation principle in eq .",
    "( which exists for all @xmath272 ) may not be @xmath18-representable : it may be negative in a region of finite measure or contain an incorrect number of electrons .    to illustrate the behaviour of the regularized functional for nonphysical densities , consider @xmath273 when @xmath12 is @xmath18-representable and @xmath274 . from the definition of the moreau envelope in eq .",
    ", we obtain straightforwardly that @xmath275 the regularized density functional thus depends on @xmath276 in a simple quadratic manner , with a minimum at @xmath277 .",
    "as @xmath278 tends to zero from above , @xmath279 increases more and more rapidly with increasing @xmath280 , approaching @xmath281 more closely .",
    "as expected , the regularized functional is differentiable in the direction that changes the number of electrons .    on the face of it , the existence of minimizing ` pseudo - densities ' in the hohenberg ",
    "kohn variation principle that are not @xmath18-representable may seem to be a serious shortcoming of the moreau ",
    "yosida regularization  ideally , we would like the minimizing density to arise from some @xmath18-electron wave function .",
    "however , the appearance of nonphysical pseudo - densities is an inevitable consequence of the regularization  differentiability in all directions can not be achieved without extending the effective domain of @xmath167 to all @xmath176 ; alternatively , we may retain the effective domain of @xmath18-representable densities and instead work with restricted functional derivatives , defined only in directions that conserve some properties of the density .",
    "such an approach is straightforward for directions that change the number of electrons in the system but much more difficult for directions that lead to negative densities or to an infinite kinetic energy .",
    "the existence of minimizing pseudo - densities that are not @xmath18-representable is less important than the fact that @xmath269 converges pointwise to @xmath0 from below as @xmath282 , even when @xmath283 .",
    "also , we shall in the next subsection see that every @xmath284 is linked to a unique physical ground - state density @xmath285 .",
    "it is therefore possible to regard ( and to treat ) the hohenberg ",
    "kohn minimization over pseudo - densities in @xmath176 as a minimization over physical densities in @xmath185 , as discussed below .",
    "we also observe that @xmath286 converges pointwise to @xmath154 from below as @xmath287 .",
    "more importantly , for any chosen @xmath216 , we may recover the exact ground - state energy @xmath154 from the regularized energy @xmath286 simply by adding the term @xmath288 , which _ does not depend on the electronic structure of the system_. indeed , this term is no more relevant for the molecular electronic system than the neglected nuclear  nuclear repulsion term  its purpose is merely to make the ground - state energy strictly concave and supercoercive in the external potential so that the universal density functional becomes differentiable and continuous .",
    "indeed , no information regarding the electronic system is lost in the regularization beyond what is lost upon truncation of the domain from @xmath289 to an arbitrarily large cubic box @xmath183 , needed to make @xmath288 finite for all potentials .",
    "according to the general theory of moreau  yosida regularization , a unique minimizer , which we shall here call the _ proximal ( ground - state ) density _ , @xmath290 exists for any @xmath284 in the regularized lieb functional of eq . , which may therefore be written as @xmath291 from eq .",
    ", we conclude that the standard lieb functional is subdifferentiable at @xmath292 and hence that @xmath292 is an ensemble @xmath13-representable ground - state density in @xmath176 : @xmath293 we also see from eq . that every @xmath284 and associated proximal ground - state density @xmath292 together satisfy the subgradient relation @xmath294 implying that @xmath295 is an external potential with ground - state density @xmath285 . in the following ,",
    "we refer to @xmath296 as the _ proximal potential _ associated with @xmath12 .",
    "we recall that , by the hohenberg ",
    "kohn theorem , the density determines the potential up to a constant .",
    "the subdifferential of @xmath167 at the proximal density @xmath292 is therefore @xmath297 where @xmath296 is the proximal potential of eq ..",
    "conversely , suppose that @xmath298 .",
    "there then exists an external potential @xmath13 such that @xmath299 . expressing @xmath13 in the form @xmath300 for some @xmath301",
    ", we obtain @xmath302 , which by eqs . and   implies that @xmath12 is the proximal density of @xmath303 .",
    "thus , every ensemble @xmath13-representable density @xmath298 is the proximal density of @xmath304 where @xmath13 is such that @xmath299 : @xmath305 in short , we have the important fact that the set of proximal densities in @xmath176 is _ precisely _ the set of ensemble ground - state densities @xmath306 . a density @xmath284 whose proximal density is @xmath292 is called a _ carrier density _ of @xmath292 .    by the hohenberg ",
    "kohn theorem , the potential @xmath13 in eq . is unique up a constant @xmath274 .",
    "the carrier density is therefore uniquely determined up to an additive constant .",
    "the nonuniqueness of the carrier density also follows directly from eq.([eq : frhoc ] ) , which shows that @xmath12 and @xmath307 where @xmath284 and @xmath274 have the same proximal ground - state density @xmath285 .    to summarize , even though the densities in the regularized hohenberg ",
    "kohn variation principle in eq .",
    "are pseudo - densities ( not associated with any @xmath18-electron wave function ) , every such density @xmath284 is uniquely mapped to a ground - state density by the surjective proximal operator @xmath308 this operator performs the decomposition @xmath309 where the proximal density @xmath285 may be viewed as the ` projection ' of @xmath12 onto @xmath185 with potential @xmath310 .",
    "we note that @xmath311 , even when @xmath298 .",
    "the proximal operator is therefore not a true projector .    for any @xmath284 ,",
    "the proximal density @xmath292 and proximal potential @xmath296 together satisfy the usual reciprocal relations for the standard lieb functional and ground - state energy : @xmath312 see eq .",
    ", and therefore satisfy the relation : @xmath313 thus , to every solution of the regularized hohenberg  kohn variation principle with @xmath314 in eq . there corresponds a proximal solution to the standard variation principle with @xmath315 .      regarding the differentiability of the regularized lieb functional , we note from theorems[thm : my ] and  [ thm : my2 ] that @xmath269 is frchet differentiable so that @xmath316 with the derivative given by eq .",
    ": @xmath317 gteaux differentiability follows from frchet differentiability : the existence of @xmath318 implies that the directional derivatives at @xmath12 exist in all directions @xmath319 and are equal to @xmath320 hence the functional derivative of @xmath269 is well defined and given by @xmath321 justifying the formal manipulations involving functional derivatives in dft , recalling that @xmath322 tends to @xmath323 pointwise from below as @xmath324 .",
    "( however , @xmath296 need not converge to anything . )",
    "the optimality conditions of the regularized dft variation principles in eqs . and are the reciprocal relations @xmath325 which for the regularized hohenberg  kohn variation principle may now be written in the form of a stationary condition : @xmath326 in combination with eq . , we obtain @xmath327 and hence from  eq . the following hohenberg ",
    "kohn stationary condition : @xmath328 suggestive of an iterative scheme with the repeated calculation of the proximal density until self - consistency .",
    "by contrast , the lieb optimality condition @xmath329 in eq . can not be written as a stationary condition since the ground - state energy @xmath286 ( just like @xmath2 and @xmath154 ) is differentiable only when @xmath13 has a unique ground - state density . from theorem[thm : cmy ] , we obtain @xmath330 which shows that the degeneracy of the ground - state energy is preserved by the moreau  yosida regularization .    for any @xmath284 in  eq .",
    ", an explicit expression for the potential @xmath296 in terms of the proximal density is given in eq .",
    ", yielding the regularized ground - state energy @xmath331 hence , _ for every @xmath284 , there exists a potential @xmath296 for which @xmath12 is the ground - state density_. stated differently , the set of ensemble @xmath13-representable pseudo - densities @xmath332 is equal to the full hilbert space : @xmath333 we recall that the proximal density @xmath292 is the exact ( standard ) ground - state energy of @xmath296 , see eq ..",
    "in the present section , we apply moreau  yosida regularization to kohn  sham theory , beginning with a discussion of the adiabatic connection .",
    "the essential point of the regularized kohn ",
    "sham theory is the existence of a common ground - state pseudo - density for the interacting and noninteracting systems , thereby solving the representability problem of kohn  sham theory .    in the present section ,",
    "we simplify notation by omitting the subscript that indicates the length of the box from all quantities  writing @xmath190 , for instance , rather than @xmath176 everywhere .",
    "the presentation of moreau  yosida regularized dft given in section  [ sec : mydft ] was for the fully interacting electronic system , with an interaction strength @xmath334 in the hamiltonian of eq .. however , given that nothing in the development of the theory depends on the value of @xmath44 , it may be repeated without modification for @xmath335 . in particular",
    ", we note that the set of ground - state pseudo - densities is equal to the whole hilbert space and hence is the same for all interaction strengths , see eq .. consequently , _",
    "every @xmath336 is the ground - state pseudo - density of some @xmath337 , for each @xmath44_.    to setup the adiabatic connection , we select @xmath336 . denoting by @xmath338 the regularized universal density functional at interaction strength @xmath44",
    ", we obtain from eq .",
    "the unique external potential @xmath339 for which the regularized ground - state energy at that interaction strength @xmath340 is given by @xmath341 as @xmath44 changes , the potential @xmath342 can be adjusted to setup an adiabatic connection of systems with the same ground - state pseudo - density @xmath12 at different interaction strengths .    in the moreau ",
    "yosida regularized adiabatic connection , the pseudo - density @xmath12 has a proximal ground - state density that depends on @xmath44 : @xmath343 which is the true ground - state density in the potential @xmath342 at that interaction strength : @xmath344 in short , in the adiabatic connection , the effective potential @xmath342 has the same ground - state pseudo - density @xmath12 but different ground - state densities @xmath345 for different interaction strengths . in the next subsection ,",
    "we shall see how this decomposition makes it possible to calculate the true ground - state energy by ( regularized ) kohn  sham theory in a rigorous manner , with no approximations except those introduced by domain truncation .",
    "consider an @xmath18-electron system with external potential @xmath346 .",
    "we wish to calculate the ground - state energy and to determine a ground - state density of this system : @xmath347 this can be achieved by solving the interacting many - body schrdinger equation , in some approximate manner . in kohn  sham theory , we proceed differently , solving instead a noninteracting problem with the same density .",
    "we begin by transforming  eq . into a regularized many - body energy , noting that the energy and superdifferential of the exact and regularized ground - state energies are related according to eqs . and   as @xmath348 from these relations",
    ", it follows that the pseudo - density @xmath349 is a ground - state density of the regularized system : @xmath350 the subscript ` c ' indicates that @xmath351 is the carrier density of both the physical ground - state of the system @xmath12 according to eq . and the ground - state density of the kohn",
    " sham system @xmath352 : @xmath353 our task is to determine the carrier density and regularized ground - state energy by solving  eq .. the solution will subsequently be transformed to yield the physical ground - state density and energy .",
    "we observe that the carrier density @xmath354 is obtained from the physical density @xmath12 by subtracting @xmath355 with @xmath216 , see eq .",
    "( [ eq : rhoast ] ) . in practice , @xmath356 since the external potential is the attractive coulomb potential of the nuclei .",
    "it therefore follows that the pseudo - density is strictly positive : @xmath357 .",
    "given that @xmath358 , there exists a kohn  sham potential @xmath359 such that @xmath351 is the ground - state density of a noninteracting system in this potential : @xmath360 to determine the regularized kohn ",
    "sham potential @xmath361 , we first note that the potentials @xmath362 and @xmath361 satisfy the stationary condition in eq . : @xmath363 to proceed , we next introduce the regularized hartree  exchange  correlation energy and potential as @xmath364 yielding the following expression for the kohn  sham potential as a function of the density : @xmath365 to solve the regularized kohn - sham problem in eq . , we first note that it is related in a simple manner to the standard kohn ",
    "sham problem : @xmath366 we then proceed in an iterative fashion .",
    "from some trial pseudo - density @xmath367 , we iterate    @xmath368    until convergence , beginning with @xmath369 and terminating when self - consistency has been established .",
    "we emphasize that the regularized kohn  sham iterations in eqs . and   are _ identical to the iterations in standard kohn  sham theory _ except for the use of a regularized hartree  exchange ",
    "correlation potential in the construction of the kohn  sham matrix and the subtraction of @xmath370 from the density generated by diagonalization of the resulting kohn",
    " sham matrix .",
    "having determined the ground - state carrier density @xmath351 and the corresponding kohn  sham potential @xmath361 by iterating eq . and   until self consistency , we calculate the interacting regularized ground - state energy as @xmath371 from which the physical ground - state energy @xmath372 is recovered by adding @xmath373 according to eq . , while the ground - state density @xmath12 is recovered by adding @xmath355 to the pseudo - density @xmath351 according to  eq .. we note that the pair @xmath374 is uniquely determined to the extent that @xmath12 in eq .",
    "is unique ; for systems with degenerate ground - state densities , several equivalent pairs @xmath374 exist .    by means of moreau  yosida regularization , we have thus setup kohn ",
    "sham theory in a rigorous manner , where the interacting and noninteracting ground - state densities are different ( by an amount proportional to @xmath278 ) but related by the same carrier density @xmath351 , thereby solving the noninteracting representability problem of standard kohn  sham theory .",
    "moreover , differentiability of the regularized universal density functional means that the potentials associated with this pseudo - density at different interaction strengths are well defined as the ( negative ) derivatives of the density functional . in the limit where @xmath324 , standard kohn ",
    "sham theory is approached , although the limit itself is not expected to be well behaved .",
    "the possibility of setting up dft follows from the mathematical properties of the ground - state energy @xmath7 , which is continuous and concave in the external potential @xmath13 . by convex conjugation",
    ", it may be exactly represented by the lower semi - continuous and convex universal density functional @xmath11 , whose properties reflect those of the ground - state energy .",
    "unfortunately , @xmath11 depends on the density @xmath12 in a highly irregular manner , being everywhere discontinuous and nowhere differentiable .",
    "these characteristics of @xmath0 arise in part because @xmath2 is concave but not strictly concave and not supercoercive . by modifying @xmath2 in a way that introduces strict concavity and supercoercivity without losing information about the electronic system",
    ", we obtain an alternative dft , where the universal density functional is much more well behaved , being everywhere differentiable ( and therefore also continuous ) .",
    "this is achieved by moreau ",
    "yosida regularization , where we apply convex conjugation not to @xmath7 itself but to the strictly concave function @xmath375 , where @xmath216 .",
    "the resulting density functional @xmath376 is convex and differentiable .",
    "standard dft is recovered as @xmath324 but this limit need not be taken for the theory to be exact  for any chosen value of @xmath278 , we can perform dft as usual ; the exact ground - state energy is recovered as @xmath377 .",
    "the only restriction on the exact theory is the truncation of the domain from @xmath289 to a box of finite ( but arbitrarily large ) volume ; such a domain truncation simplifies the moreau ",
    "yosida formulation of dft by introducing ( reflexive ) hilbert spaces of densities and potentials .",
    "the densities that occur naturally in regularized dft are not physical densities since they can not be generated from an @xmath18-electron wave function in the usual manner .",
    "nevertheless , each ` pseudo - density ' @xmath12 has a clear physical interpretation : it can be uniquely decomposed as @xmath378 , where @xmath292 is a physical ground - state density ( the ` proximal density ' ) and @xmath296 the associated potential .",
    "this density decomposition justifies kohn  sham theory : a given pseudo - density @xmath12 is uniquely decomposed as @xmath379 , at each interaction strength @xmath44 . as @xmath44 changes , the decomposition of @xmath12 changes accordingly . for the fully interacting system , @xmath380 where @xmath381 is the physical ground - state density and @xmath362 the external potential ; for the noninteracting system , @xmath382 , where @xmath383 and @xmath384 are the kohn  sham density and potential , thereby solving the noninteracting representability problem of kohn  sham theory .",
    "the working equations of regularized kohn  sham theory are essentially identical to those of standard kohn  sham theory .    here ,",
    "we have considered standard moreau ",
    "yosida regularization .",
    "however , we may also consider a generalized approach , in which the regularizing term @xmath385 is replaced by @xmath386 , where the operator @xmath387 is chosen based on some _ a priori _ knowledge of the desired solution .",
    "indeed , some choices of @xmath387 result in approaches closely related to known regularization techniques , such as the zhao  morrisson ",
    "parr approach  @xcite to calculate the noninteracting universal density functional and the `` smoothing - norm '' regularization approach of heaton - burgess _ et .",
    ", used both in the context of optimized effective potentials  @xcite and lieb optimization methods  @xcite . these and related approaches will be discussed in a forthcoming paper .",
    "we expect such moreau ",
    "yosida techniques to be of great practical value in the implementation of procedures that attempt to determine either the ground - state energy or the universal density functional by direct optimization techniques using their derivatives , bearing in mind that both the derivatives and the objective functions are well defined in the regularized context .",
    "this work was supported by the norwegian research council through the coe centre for theoretical and computational chemistry ( ctcc ) grant no .",
    "179568/v30 and the grant no .",
    "171185/v30 and through the european research council under the european union seventh framework program through the advanced grant abacus , erc grant agreement no .  267683 .",
    "a.  m.  t.  is also grateful for support from the royal society university research fellowship scheme .",
    "in this section , we review some important concepts of convex analysis and the calculus of variations . suggested reading for convex analysis are van tiel s book@xcite and the classic text by ekeland and tmam.@xcite the present article relies on additional information gathered in the book by bauschke and combettes,@xcite which focuses on the hilbert - space formulation of convex analysis . for functional analysis ,",
    "the monograph by kreyszig@xcite is recommended .",
    "we are here concerned with extended real - valued functions @xmath388 over a banach or hilbert space @xmath389 .",
    "note that we define @xmath390 for any @xmath391 , and @xmath392 for positive real numbers @xmath99 , but that @xmath393 is not defined .",
    "we recall that @xmath15 , the topological dual of @xmath14 , is the set of continuous linear functionals over @xmath14 : if @xmath394 , then @xmath395 is a real - valued map , continuous and linear in @xmath107 .",
    "we denote by @xmath396 the value of @xmath395 at @xmath99 , except in the dft setting , where the notation @xmath397 is used . for simplicity , we assume in this section that @xmath14 is reflexive so that @xmath398 . ultimately , we shall work with hilbert spaces , which are reflexive banach spaces so that @xmath399 by the riesz representation theorem of functional analysis .",
    "let @xmath400 be an extended - valued function .",
    "the ( effective ) domain @xmath401 is the subset of @xmath14 where @xmath98 is not @xmath83 .",
    "the function @xmath98 is said to be proper if @xmath402 .",
    "the function @xmath98 is convex if , for all @xmath99 and @xmath403 in @xmath14 , and for all @xmath404 , @xmath405 note that this formula also makes sense if , say , @xmath406 .",
    "the interpretation of convexity is that a linear interpolation between two points always lays on or above the graph of @xmath98 .",
    "we say that @xmath98 is strictly convex if strict inequality holds for @xmath407 in eq.([eq : convexity ] ) .",
    "moreover , @xmath98 is said to be concave if the inequality is reversed in eq.([eq : convexity ] ) and strict concavity is defined similarly .",
    "perhaps the most important property of a convex @xmath98 is that any local minimum is also a global minimum .",
    "moreover , if @xmath98 is strictly convex , the global minimizer , if it exists , is unique .",
    "convex optimization problems are in this sense well behaved .",
    "the minimal useful regularity of convex functions is not continuity but lower semi - continuity . in a metric space @xmath14 ,",
    "a function @xmath98 is said to be lower semi - continuous if , for every sequence @xmath408 converging to some @xmath107 , we have @xmath409 the importance of lower semi - continuity is that it guarantees the existence of a global minimum if @xmath410 is compact : @xmath411 for some @xmath412 .",
    "for concave functions , upper semi - continuity is the corresponding useful notion ; @xmath98 is upper semi - continuous if @xmath413 is lower semi - continuous , by definition .",
    "we are particularly interested in lower semi - continuous proper convex functions .",
    "the set @xmath414 is defined as consisting of all functions that can be written in the form @xmath415 for some family @xmath416 of dual functions and some @xmath417 .",
    "the set @xmath414 contains precisely all lower semi - continuous proper convex functions on @xmath14 and the functions identically equal to @xmath418 . in other words",
    ", @xmath98 is lower semi - continuous proper convex or identically equal to @xmath418 if and only if it is the pointwise supremum of a set of continuous affine ( `` straight - line '' ) functions over @xmath14 .",
    "we denote by @xmath419 all proper lower semi - continuous functions on @xmath14 : @xmath420 .",
    "it is a fact that any @xmath421 is also _ weakly _ lower semi - continuous .    on the dual space @xmath187",
    ", we denote by @xmath422 the set of all functions that can be written in the form @xmath423 these functions are precisely the weak-@xmath424 lower semi - continuous proper convex functions on @xmath187 and the improper functions @xmath418 .",
    "the proper functions are @xmath425 .",
    "the unique function @xmath129 is said to be the _",
    "convex conjugate _ of @xmath98 and is denoted by @xmath429 ; likewise , @xmath430 is the _ convex conjugate _ of @xmath129 .",
    "a pair of functions @xmath431 and @xmath432 that are each other s convex conjugates are said to be _ dual functions_. the dual functions contain the same information , only coded differently : each property of @xmath98 is reflected , in some manner , in the properties of @xmath433 and vice versa .",
    "we note the relations @xmath434 for functions @xmath431 and @xmath432 .",
    "in fact , the conjugation operation is a bijective map between @xmath414 and @xmath422 , they contain precisely those functions that satisfy the biconjugation relations in  eq ..                a dual function @xmath394 is said to be a _ subgradient _ to @xmath98 at a point @xmath99 where @xmath111 is finite if @xmath443 meaning that the affine function @xmath444 is nowhere above the graph of @xmath98 .",
    "the subdifferential @xmath445 is the set of all subgradients to @xmath98 at @xmath99 , see figure  [ fig : tangents ] .",
    "note that @xmath102 may be empty .",
    "the function @xmath98 is said to be subdifferentiable at @xmath107 if @xmath446 .",
    "a function @xmath447 has a global minimum at @xmath107 if and only if @xmath108 .",
    "similarly @xmath109 has a minimum if and only if @xmath110 . a function @xmath431 is subdifferentiable on a dense subset of its domain @xmath105 .    .",
    "for a @xmath448 , @xmath449 is a collection of slopes of tangent functionals .",
    "one such slope @xmath395 and its affine mapping is shown explicitly , the rest is indicated with stippled lines .",
    "@xmath395 is not unique since the graph of @xmath98 has a `` kink '' at @xmath450.[fig : tangents ] ]    in the context of dft , @xmath0 is subdifferentiable at @xmath451 if and only if @xmath12 is the ground - state density of a potential @xmath452 , @xmath453 so that @xmath454 by the hohenberg  kohn theorem , we know that @xmath455 if @xmath12 is @xmath13-representable and that @xmath118 otherwise .",
    "thus , from the point of view of convex analysis , the notion of @xmath13-representability of @xmath12 is equivalent to subdifferentiability of @xmath0 at @xmath12 .",
    "it follows that the @xmath13-representable densities are dense in the set of @xmath18-representable densities , the effective domain of @xmath0 .",
    "let @xmath456 .",
    "the _ directional derivative _ of @xmath98 at @xmath99 in the direction of @xmath403 is defined by @xmath457\\ ] ] if this limit exists ( @xmath83 is accepted as limit ) . for @xmath447 ,",
    "the directional derivative @xmath458 always exists .",
    "let @xmath107 be given . if there is a @xmath459 such that @xmath460 then @xmath98 is said to be _ gteaux differentiable _ at @xmath99 .",
    "in other words , a function is gteaux differentiable if its various directional derivatives may be assembled into a linear functional at @xmath99 .",
    "the gteaux derivative is the usual notion of functional derivative encountered in the calculus of variations , for which we write @xmath461 .",
    "if @xmath98 is continuous and has a unique subgradient at @xmath99 , then it is is also gteaux differentiable at @xmath99 ; the converse statement is also true , but note that a unique subgradient alone is not enough to ensure gteaux differentiability : continuity is not implied by a unique subgradient .      a stronger notion of differentiability is given by the frchet derivative .",
    "let @xmath107 .",
    "if there exists @xmath394 such that for all sequences @xmath462 in @xmath14 as @xmath463 , @xmath464 then @xmath98 is _ frchet differentiable _ at @xmath99 , and @xmath465 is the frchet derivative .",
    "clearly , frchet differentiable implies gteaux differentiable , but not the other way around .",
    "in fact , if @xmath466 exists at @xmath99 , then @xmath467 so that @xmath98 is approximated by its linearization around @xmath99 .",
    "this is not true if @xmath98 is merely gteaux differentiable .",
    "19ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ] ",
    "+ 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop _ _  ( ,  ) @noop",
    "* * ,   ( ) @noop * * ,   ( ) @noop _ _  ( ,  , ) @noop * * ,   ( ) @noop _ _  ( , ,  ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop _ _  ( ,  ,  ) @noop _ _  ( ,  ,  ) @noop _ _  ( , ,  )"
  ],
  "abstract_text": [
    "<S> the universal density functional @xmath0 of density - functional theory is a complicated and ill - behaved function of the density  in particular , @xmath0 is not differentiable , making many formal manipulations more complicated . </S>",
    "<S> whilst @xmath0 has been well characterized in terms of convex analysis as forming a conjugate pair @xmath1 with the ground - state energy @xmath2 via the hohenberg  kohn and lieb variation principles , @xmath0 is nondifferentiable and subdifferentiable only on a small ( but dense ) set of its domain . in this article </S>",
    "<S> , we apply a tool from convex analysis , moreau  yosida regularization , to construct , for any @xmath3 , pairs of conjugate functionals @xmath4 that converge to @xmath1 pointwise everywhere as @xmath5 , and such that @xmath6 is ( frchet ) differentiable . for technical reasons , </S>",
    "<S> we limit our attention to molecular electronic systems in a finite but large box . </S>",
    "<S> it is noteworthy that no information is lost in the moreau  </S>",
    "<S> yosida regularization : the physical ground - state energy @xmath7 is exactly recoverable from the regularized ground - state energy @xmath8 in a simple way . </S>",
    "<S> all concepts and results pertaining to the original @xmath1 pair have direct counterparts in results for @xmath9 . </S>",
    "<S> the moreau  </S>",
    "<S> yosida regularization therefore allows for an exact , differentiable formulation of density - functional theory . </S>",
    "<S> in particular , taking advantage of the differentiability of @xmath10 , a rigorous formulation of kohn  sham theory is presented that does not suffer from the noninteracting representability problem in standard kohn  sham theory . </S>"
  ]
}