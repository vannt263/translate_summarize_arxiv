{
  "article_text": [
    "the observation of cosmic microwave background ( cmb ) radiation by esa mission will be able to provide the understanding of our universe with many key cosmological parameters with unprecedented precision .",
    "the signal received from the sky , however , will contain not only the cmb radiation , but also foreground emissions such as synchrotron , dust , free - free emission , sunyaev - zeldovich effect from galaxy clusters and extra - galactic point sources . removing foreground contaminations",
    "is therefore one of the main tasks for the mission . of these different foreground emissions , the purpose for extraction of extra - galactic point sources has two folds : to separate the foregrounds from the underlying cmb signals to achieve the scientific goal of the mission as this type of foreground contamination is rather non - gaussian . on the other hand ,",
    "the whole sky coverage and a wide range of the observing frequencies provide an opportunity for producing the extra - galactic point source catalogue , most notably , the proposed early release compact source catalogue ( ercsc ) , which will be released in roughly 7 months when the full sky is covered once .",
    "recently , the nasa _ wilkinson microwave anisotropy probe _",
    "( ) experiment @xcite has demonstrated the importance of the component separation tools for extraction of cmb power spectrum from the raw data .",
    "one of the sources with localized peculiarities of the cmb sky is from the point source contamination . for the mission ,",
    "the catalogue of the radio point sources was obtained @xcite and the final cmb maps were cleaned from the point source contribution .",
    "the channels at high frequency correspond to the lfi frequency range , in which the contamination of point sources seems 3 times higher than that from the . for the hfi channels , the point sources",
    "are expected to be more significant regarding the issue of component separation and of point source catalogue .    in this paper , we compare the theoretically - optimal filter @xcite ( hereafter tof ) and the adaptive top - hat filter @xcite ( athf ) proposed for extra - galactic point source detection . theoretically speaking , the filter proposed by tegmark & de oliveira - costa is _ optimal _ in terms of the gain factor .",
    "the gain factor is an indicator of the amplitude enhancement of point sources relative to the background . by ` theoretically ' we mean that the required information input for this filter is known : the cmb and the noise power spectrum , and the circular beam shape and size .",
    "this filter is known as a ` matched filter ' in the field of signal processing .",
    "a lot of effort has been devoted to the development of other linear filters @xcite , namely the spherical mexican hat wavelet ( mhw ) , and the so - called pseudo - filter .",
    "vio et al .",
    "( 2002 ) and barreiro et al .",
    "( 2002 ) have performed the comparison between the tof and the pseudo - filter .",
    "vielva et al .",
    "( 2001 , 2003 ) have applied the mhw on simulation data for the mission .",
    "the in - flight beam shape properties are crucial in connection with the point source extraction .",
    "there are many issues regarding the in - flight antenna beam shape properties and its reconstruction @xcite .",
    "first of all , according to optics calculations the main beams are not circular gaussian @xcite , but elliptical , which is normally formulated as bivariate gaussian functions . secondly , with the most likely scan strategy ,",
    "the inclination angle of the beam is not all parallel through the sky due to possible precession of its spin axis , but is rather slowly rotating along circular scans .",
    "note that this slow rotation of the antenna beam is different from the balloon - borne experiments such as _ maxima-1 _ , which has a fast rotating beam @xcite , or _ wmap _ , in which the pixels have hits of multiple orientations @xcite , and therefore a resultant quasi - symmetric pixel - beam .",
    "furthermore , there could exist mirror degradation effect during the approximately 15-month routine operation of the mission @xcite , which will mimic the change of the inclination angle and the shape of the beam .",
    "the combined effect from the above - mentioned factors will cause the in - flight beam shape to change with time not only its ellipticity ratio @xmath0 , where @xmath1 and @xmath2 are the major and minor axis of the ellipse , but also the inclination angle .",
    "there are also some minor effects such as the issues on pointing accuracy and the noise properties that could also mimic the beam degradation .",
    "the filters which assume a circular gaussian beam for point source extraction will need corresponding modifications .",
    "the adaptive top - hat filter is flexible for real situations .",
    "the athf is similar to the so - called gabor transform of the signal , using a adaptive width of the kernel .",
    "the athf has a top - hat shape with two cut - off scales working in harmonic domain .",
    "the two cut - off scales @xmath3 and @xmath4 serve to cut down the unwanted power from both sides of the power spectrum .",
    "simultaneously , the two scales retain the essential part of power spectrum where the convolution ( by the beam ) of point sources is most pronounced .",
    "we also propose a median filtering technique for removing the point source from the maps .",
    "the median filter can be used on combination with any methods of point source detection in order to increase the precision of the cmb map reconstruction .",
    "the layout of this paper is as follows . in section 2",
    "we discuss the antenna beam shape properties by firstly introducing the scan strategy and the definition of the window function . in section 3",
    "we present the detailed analysis on the theoretically - optimal filter ( tof ) ( the matched filter ) and the adaptive top - hat filter ( athf ) . in section 4",
    "we compare by simulations the tof and the athf on gain capability on more realistic situations and apply the athf on discussions and conclusion are in section 5 .",
    "the manifestation of point sources in the upcoming maps is a direct reflection of the properties of the pixelized antenna beam shape , which is related to the scan strategy , pointing accuracy , map - making algorithm and the extraction of the systematic effects from the time - ordered data ( tod ) set and pixelized maps as well . before our analysis of point source problem , in particular , for the early release compact source catalogue ( ercsc ) , we need to describe the experiment when the tod contain the information about the signal ( and noise ) from a large number of circular time - ordered scans @xcite . below",
    "we assume for simplicity that the systematic features are already removed and the instrumental noise is gaussian white noise .",
    "in the temporal domain the observed signal @xmath5 is the combined signal @xmath6 of the cmb and foregrounds from the sky ( hereafter beam - convolved ` sky signals ' ) , plus random instrumental noise @xmath7 , @xmath8 where @xmath9 and @xmath10 is the multipole expansion of the time - stream beam @xmath11 . in eq .",
    "( [ eq : eq2 ] ) @xmath12 are the corresponding multipole coefficients of the cmb and foreground signal expansion on the sphere and @xmath13 are the spherical harmonics .",
    "following tegmark & efstathiou we also assume that map making algorithm is linear .",
    "thus the signal in each pixel @xmath14 should have the following relation @xmath15 where @xmath16 is the corresponding pointing matrix and @xmath14 is the sky signals convolved by the pixel beam @xmath17 , @xmath18 @xmath19 is the two - dimensional vector with its components @xmath20 and @xmath21 denoting the location on the surface of the sphere .",
    "the definition of the pointing matrix @xmath16 depends on the scan strategy of an experiment .",
    "below , as a basic model , we will use the model of the scan strategy of the mission which was discussed by burigana et al . .",
    "let @xmath22 be the unit vector along the satellite spin - axis in the anti - sun direction and @xmath23 is that along the direction of the optical axis of the telescope .",
    "the angle between spin - axis and optical axis is @xmath24 .",
    "the satellite itself will scan the same circle 60 times around the spin - axis at @xmath25 r.p.m .. each hour the spin - axis is manoeuvred along the ecliptic plane by @xmath26 .",
    "note that for our geometrical model , during the circling of the optical axis around the spin - axis in each step , the inclination of the beam relative to the optical axis are stable .",
    "for modelling of the antenna beam shape we will describe the simplest scan strategy with the spin axis right on the ecliptic plane without any additional ( regular ) modulation ( e.g. it can be above or below the plane due to precession ) .",
    "this model reflects the geometrical properties of the beam asymmetry and their manifestation in the pixelized maps . under the assumptions mentioned above we",
    "can now describe the elliptical beam shape model as follows , @xmath27 , \\label{eq : eq5}\\ ] ] where    @xmath28    @xmath29 is the rotation matrix which describes the inclination of the elliptical beam , @xmath30 with @xmath31 being the inclination angle between @xmath32 axis and the major axis of the ellipse .",
    "the @xmath33 matrix denotes the beam dispersion along the ellipse principal axes , which can be expressed as @xmath34 the center of the cartesian coordinate system is denoted by @xmath35 and @xmath36 at some moment @xmath37 with @xmath38 axis along the @xmath23 , and @xmath32 and @xmath39 axis on the plane tangent to the celestial sphere .",
    "we will choose below the standard orientation of the local cartesian coordinate system with @xmath32 axis parallel to the scanning direction .",
    "after some time @xmath40 , where @xmath41 is the number of the sub - scans , the spin axis of the satellite shall be stepped along the ecliptic plane to @xmath42 with the small deviation @xmath43 .",
    "for a small part of the sky we can neglect the rotation of the cartesian coordinate system and choose the @xmath44 and @xmath45 axes parallel to @xmath32 , @xmath39 axis .",
    "the received signals in each pixel @xmath46 depend on the orientation of the pixel beam @xmath47 and the location of its center @xcite . for the upcoming non - symmetric spatially - dependent beam",
    ", the convolution of the signal with asymmetric beam immediately produces non - gaussian signature coupled with the underlying signal , which affects the estimation of angular power spectrum .",
    "although the real beam profile ( including the sidelobes ) are complicated , we begin our analysis from the model of the time - dependent , elliptical beam shape which is applicable up to @xmath48 db level . at low amplitude part of the beam shape ( @xmath49 db ) the complexity of the beam estimation increase dramatically .",
    "moreover , due to possible precession of the spin axis @xmath22 ( around the standard orientation ) , which can be described as some additional noise , it is possible to find some transformation of the width of the beam taking into account the statistical properties of the precession . in such a case",
    "the angle between the spin axis and the optical axis should be @xmath50 , where @xmath51 and @xmath52 denote a random precession .      due to the scan strategy and ( possible )",
    "precession , the pixel beam pattern , in principle , should be different for different pixels on the sphere , which means that we need some modification of the standard tools for the @xmath53 power spectrum extraction by taking into account any possible peculiarities from the bivariate gaussian beam shape .",
    "the finite resolution of the pixel beam means that the signal we receive from the sky is smoothed by the beam , @xmath54 usually the influence of the pixel beam on the observed signals can be described in terms of the window function @xcite @xmath55 where @xmath56 and @xmath57 denote the positions of the corresponding pixels in the map and @xmath58 is the spherical harmonic transform of the beam function pointing in the direction @xmath56 .",
    "this window function determines the cmb signal correlation matrix as @xmath59 in the framework of the mission it is possible to use the flat sky approximation ( as a part of the whole sky @xmath53 harmonic analysis ) in order to estimate the point source contamination and beam influence on the high multipole part of the @xmath53 power spectrum . for such flat sky limit",
    "the computation cost is minimal , as we can implement fast fourier transforms ( fft ) for the cmb anisotropy .",
    "when the sky signal is convolved with an elliptical beam with an angle between its major axis and the scan direction , the temperature becomes @xmath60 ) t_{\\rm cmb}({{\\mbox{\\boldmath $ k$ } } } ) ,   \\label{eq : eq9}\\ ] ] where @xmath61 is the fourier transform of the beam profile at the origin , and @xmath62 $ ] is the rotation operator with an angle @xmath31 with respect to the scan direction @xcite , which can be written explicitly as @xmath63)=\\exp\\left[-\\frac{1}{2}({\\sf r k})^{\\rm t } { \\sf d}({\\sf r k } ) \\right ] , \\ ] ] where @xmath29 and @xmath33 are defined as in eq .",
    "( [ eq : inclination ] ) and ( [ eq : dispersion ] ) and @xmath64 the window function now can be expressed as @xcite @xmath65 ) b^{*}({\\sf r}_{\\alpha+\\delta \\theta}[{{\\mbox{\\boldmath $ k$}}}]),\\end{aligned}\\ ] ] where @xmath66 is the angle of wave vector @xmath67 in the @xmath68 space such that @xmath69 and @xmath70 . moreover , for the flat sky approximation ( and without the influence of the instrumental noise and any peculiarities of the scanning such as precession ) we can use the assumption of stable beam orientation , @xmath71 , with the corresponding fourier image for the elliptical part of the beam shape , @xmath72 \\nonumber \\\\ & = & \\exp \\left[-\\frac{k^2_x}{2a^2}- \\frac{(k_y - k_x\\frac{b^2}{a^2})^2 a^2\\sigma^4}{2}\\right ] \\label{eq : eq10}\\end{aligned}\\ ] ] where @xmath73 , @xmath74 , @xmath75 and @xmath76 . without loss of generality , we can rotate the coordinate system such that @xmath77 , and , for small @xmath78 , @xmath79 with @xmath80 .",
    "the window function can be written as @xmath81 \\nonumber \\\\",
    "\\times & \\exp \\left\\ { -k^2\\sigma^2 r \\left [ 1 + ( r^{-2}-1 ) \\sin^2",
    "\\phi_k \\right ] \\right\\ } , \\label{eq : eq12}\\end{aligned}\\ ] ] with the bivariate beam profile @xmath82 \\right\\}. \\label{eq : eq11}\\ ] ] the integral in eq .",
    "( [ eq : eq12 ] ) can be expressed analytically @xcite .",
    "if the asymmetry of the beam shape is low then we can express @xmath83 as an infinite series in powers of asymmetry parameter @xmath84 , @xmath85 where @xmath86 @xmath87 and @xmath88 are the euler gamma function of the first and the second kind , respectively , and @xmath89 is a generalized hyper - geometric function . for beams with symmetric shape where @xmath90 and @xmath91 , we obtain from eq .",
    "( [ eq : eq13 ] ) @xmath92 where the zeroth - order bessel function @xmath93 corresponds to the standard asymptotic of the legendre polynomials @xmath94 at @xmath95 . in a general case when @xmath96 the window function @xmath97 is a function of the separation angle @xmath98 and phase @xmath99 as from eq .",
    "( [ eq : eq13 ] ) .",
    "this fact reflects the influence of the anisotropy of the beam on the cmb signal after convolution which transforms isotropic cmb signal to anisotropic one .    for applications of the above - mentioned properties of the beam shape and the window function for point source extraction , let us define the mean beam profile as follows , @xmath100 in the flat sky approximation , taking eq .",
    "( [ eq : eq11 ] ) into account , the mean beam profile is related to the ellipticity parameter @xmath101 as @xmath102 i_0\\left [ \\frac{k^2\\sigma^2(r^2 - 1)}{4r}\\right ] ,   \\label{eq : eqmb}\\ ] ] where @xmath103 is the bessel function of the first kind .",
    "for the window function @xmath104 in the flat sky approximation we have @xmath105\\right \\ } \\nonumber \\\\ = \\exp\\left[-\\frac{k^2\\sigma^2(r^2 + 1)}{2r } \\right ] i_0\\left [ \\frac{k^2\\sigma^2(r^2 - 1)}{2r}\\right ] .",
    "\\label{eq : eqm1}\\end{aligned}\\ ] ] the last two approximations play a crucial role in point source extraction .",
    "first of all , the actual value of the beam profile at the location of the point source is related to the orientation of the beam as @xmath106 \\nonumber \\\\ & \\times & \\exp\\left[-\\frac{k^2\\sigma^2 ( r^2 - 1)}{4r } \\cos 2\\phi_{{{\\mbox{\\boldmath $ k$}}}}\\right ] , \\label{eq : eqm2}\\end{aligned}\\ ] ] and is different from the mean beam profile .",
    "these differences depend on the position of the point source in the map and for a given value of the flux @xmath107 the result of the point source subtraction should be different for different points of location .",
    "in this section we would like to elaborate for point source extraction the subtleties of the 3 linear filters : the theoretically - optimal filter , the adaptive top - hat filter and the pseudo - filter .",
    "the analyses and comparisons are based on the assumption that the beam shapes for all frequency channels are circular gaussian and are known if required ( by the tof and the pseudo - filter ) and the signal properties , both the cmb and pixel noise power spectrum , are known if required ( by the tof ) .",
    "the analysis and comparison is in terms of the gain factor .",
    "the gain factor is defined as @xmath108 , where @xmath109 is the signal @xmath110 to noise @xmath111 ratio with `` @xmath112 '' indicating after convolution by the filter .      in the following analyses for the theoretically - optimal filter ( tof )",
    "we adopt the convention of notation by tegmark & efstathiou , tegmark & de oliveira - costa ( hereafter td98 ) , i.e. , the _ de - convolved _ power spectrum of the combined signal is defined as @xmath113 where @xmath114 is the sky signals including cmb and all foregrounds but the point source contribution , @xmath115 is the noise power spectrum , which is taken as @xmath116 , and @xmath117 is the window function .",
    "thus the _ combined _ ( except point sources ) power spectrum in the map is @xmath118 .",
    "note that the in - flight beam @xmath119 and the window function @xmath117 definitely have some error bars caused by possible mirror degradation effects , the galactic foreground contaminations and the instrumental noise .",
    "thus simple inversion of @xmath120 for the power spectrum requires specific renormalization due to the antenna beam shape properties .",
    "the idea to construct the theoretically - optimal filter ( tof ) for point source extraction is outlined in td98 .",
    "we can write down the signal as the sum of the point source contribution and the rest ( td98 ) @xmath121 where @xmath122 is a dirac delta function , @xmath107 is the flux of the point source at the direction @xmath123 , @xmath12 is the coefficients of the signal decomposition with @xmath124 as in eq .",
    "( [ eq : ctot ] ) , @xmath125 the spherical harmonics , and @xmath126 ^ 2 } { ( h\\nu / k t_{\\rm cmb})^4}.\\ ] ] this filter is named as ` theoretically - optimal ' because it is constructed in such a way that the gain factor will be maximal , i.e. , when the ` observed ' signal , @xmath127 is convolved with the filter @xmath128 , @xmath129 the maximization of the ` signal ' to ` noise ' ratio ( @xmath130 ) will give us the filter shape , where @xmath131 is the square root of the variance of the point source amplitudes and @xmath111 now is the _ rms _ of the combined signal , both convolved by the filter @xmath128 .",
    "equivalently , we want to maximize @xmath132 [ ( f \\otimes b ) ( \\rh_j \\cdot \\rh ) ] \\rangle } { \\sum_\\ell \\lfactors \\fl^2 \\wl^2 \\cl } \\nonumber \\\\     & = &   g^2\\sum_i s_i^2 \\frac{\\left[\\sum_\\ell \\lfactors \\fl \\overline{\\bl }   \\right]^2}{\\sum_\\ell \\lfactors",
    "\\fl^2 \\wl^2 \\cl } ,   \\label{eq : g}\\end{aligned}\\ ] ] where @xmath133 denotes convolution , @xmath119 are the coefficients of the spherical harmonic decomposition of the beam profile , @xmath134 is the multipole expansion of @xmath128 , and @xmath135 is the mean beam .",
    "we thus can obtain the tof for each frequency channel .",
    "note that in reaching eq .",
    "( [ eq : g ] ) the filter is assumed isotropic in the fourier rings and statistically homogeneous .",
    "thus in the spherical harmonic decomposition this filter has only @xmath136-dependence , but not on the azimuthal numbers @xmath137 .",
    "this condition is only valid when the sky signal and the pixel noise are gaussian .",
    "if the sky signal ( or the pixel noise ) is non - gaussian , however , then eq .  ( [ eq : g ] ) needs the corresponding modification . for the following analyses we assume for simplicity that the gaussian assumption is appropriate for the cmb plus foreground .",
    "the determination of the tof is similar to the definition of functional derivatives definition .",
    "suppose that @xmath138 corresponds to the maximization of the ratio @xmath139 from eq .",
    "( [ eq : g ] ) , then a small variation @xmath140 of the shape from the @xmath138 shall shift the function @xmath141 away from the maximal value @xmath142 , which is proportional to the @xmath140 , @xmath143  , if @xmath144 .",
    "so we have @xmath145 and obtain the following formulae from eq .",
    "( [ eq : g ] ) , @xmath146 where @xmath147 f_n , \\label{eq : m}\\ ] ] @xmath148 @xmath149 @xmath150 and @xmath151    equivalently , to maximize the gain factor @xmath152 is to take @xmath153 , the condition that the first functional derivative is zero , @xmath154 .",
    "if we assume that the tof profile is an analytic function , then from eq .",
    "( [ eq : m ] ) we get @xmath155 as one can see from eq .",
    "( [ eq : a ] ) and ( [ eq : b ] ) the coefficients @xmath31 and @xmath99 are also the functionals of the tof profile . substituting eq .",
    "( [ eq : f ] ) into eq .",
    "( [ eq : a ] ) and ( [ eq : b ] ) we obtain the following relationship between @xmath31 and @xmath99 functionals , @xmath156 taking into account the definitions of the @xmath31 and @xmath99 functionals and eq .",
    "( [ eq : ab ] ) , we reach the conclusion that the tof @xmath157 from eq .",
    "( [ eq : f ] ) have the form @xmath158 where @xmath159 and @xmath160 is the maximal gain after filtering , @xmath161 if the tof @xmath138 corresponds to the global maximum of the gain ( in the class of the analytic functions ) then the second functional derivative @xmath162 should be negative at @xmath163 . for small variations around @xmath138",
    "this corresponds to the condition @xmath164 , according to eq .",
    "( [ eq : d ] ) . after substituting @xmath165 into eq .",
    "( [ eq : n ] ) we get @xmath166 where @xmath167 . as one",
    "can see from eq .",
    "( [ eq : delta ] ) , for any values of the @xmath168 functions , the function @xmath169 is negative and the filter @xmath163 corresponds to the maximal gain in the functional space of the linear filters .",
    "the filter shape of eq .",
    "( [ eq : ro ] ) for point source extraction is a generalization of the td98 filter , which is obtained under the assumption of circular gaussian antenna beam shapes .",
    "the new element which we get for the more complicated antenna beam shape in eq .",
    "( [ eq : ro ] ) shows that for the tof construction , instead of the td98 model , we need to know the mean beam ( over all @xmath137 from eq .",
    "( [ eq : b ] ) beam profile ) , the window function @xmath170 , and all the signal properties as well .",
    "one of the most crucial factors affecting the efficiency of the tof is from the systematic effects , namely , the possible degradation effect of the primary and secondary mirror surface during the flight @xcite . as mentioned in the introduction , the mirror degradation could change the ellipticity ratio and the beam size , so the calibration and reconstruction of the in - flight antenna beam shape will have direct consequence of eq .",
    "( [ eq : b ] ) and the window function .    from a practical point of view , when we apply the tof of eq .",
    "( [ eq : ro ] ) for the point source extraction , in particular for the ercsc , it is necessary to know precisely the power spectrum of the sky signals and the pixel noise properties",
    ". it is , however , only possible at the earliest after the analyses of component separation and @xmath53 extraction when the mission is completed .",
    "conversely , for the realization of the @xmath53 extraction it is necessary to know the window function @xmath170 for all frequency ranges .",
    "this means that for the ercsc construction it is better to to use primitive filters which require as little information as possible about the properties of the antenna beam shape and the sky signals .    one additional possibility for the new class of the linear filters comes from eq .",
    "( [ eq : m ] ) at @xmath153 but for the non - analytical shape of the optimal filter @xmath171 , which is not in the scope of this paper . in the next section",
    "we will demonstrate that the maximization of the gain factor can be obtained using a simple top - hat filter .",
    "chiang et al .",
    "introduce another class of filter similar to the gabor transform @xcite : the adaptive top - hat filter ( athf ) , which is implemented in the harmonic space with two adaptive cut - off parameters , @xmath172 , where @xmath173 is a heaviside function , @xmath4 and @xmath3 are two adaptive parameters .",
    "the athf allows us to investigate a new class of non - analytical functions for the ercsc .",
    "point source extraction by the athf is based on the idea that each point source in the map ( and the tod as well ) manifests itself as a non - gaussian feature which is convolved with the beam shape .",
    "the goal , therefore , is to distinguish these non - gaussian features from the cmb signal and pixel noise by using some general properties of the cmb map only .",
    "the athf is generalized from the amplitude - phase analysis method for point source extraction in the maps @xcite . in filtering",
    ", the parameter @xmath4 suppresses all the power of the signal from the sky at the multipole range @xmath174 for which the beam shape influence on the signal is not crucial .",
    "this part of filtering by the athf reflects the fact that the pure cmb signal has @xmath175 tail , whereas dust , synchrotron and free - free emission have @xmath176 tails for the foregrounds @xcite .",
    "the parameter @xmath3 , on the other hand , suppresses the high multipole power from pixel noise and secondary anisotropies , in order to relatively increase the point source amplitudes above the threshold of detection .",
    "non - symmetric beam break the statistical isotropy of the fourier ring in the power spectrum and the ellipticity of the beam will manifest itself in the fourier domain @xcite .",
    "the usual estimation of the ellipticity ratio of antenna beam ( @xmath177 ) is well above the ratio of the two proposed cut - off scales of the athf for all the channels @xcite , which means the cut - off scales of the athf will retain the part of the elliptic shape on the fourier ring .    before our analyses , we would like to emphasize again the adaptiveness of the athf which does not at all need any _ a priori _ information of the experiment parameters . in principle",
    ", we can start from any values of the @xmath4 and @xmath3 parameters for investigation of the peak amplitudes in the cmb map without any assumptions on the properties of the signal and noise .",
    "we can choose , for example , @xmath178 , where @xmath179 is the multipole mode corresponding to the pixel size , and @xmath180 , the lowest multipole mode .",
    "after the first step of the iteration , the maxima might contain both cmb peaks and point sources above some specified threshold @xmath181 , where @xmath182 is the square root of the variance of the filtered map and @xmath183 is a dimensionless amplitude , which , following the standard criterion ( see , e.g. td98 ) , we will set @xmath184 .",
    "the next few steps of the iteration are to increase the @xmath4 parameter .",
    "because the power of the low multipole part of the cmb and foreground signal are gradually subtracted by the increasing @xmath4 , the new variance of the signal after filtering @xmath185 must be smaller than the preceding one , but the point source amplitudes changes only slightly , which results in pushing the gain factor higher .",
    "the steps of increasing @xmath4 are carried on up to the step where the gain factor dips after reaching a maximum value .",
    "we can then tune the @xmath3 parameter in the similar way by lowering it from @xmath178 .",
    "tuning of the cut - off scales of the athf will produce the so - called brownian motion of the cmb peaks , as compared to motions within the beam size for beam - convolved point sources @xcite , which is useful in lowering the threshold of the criterion for point source detection .    for practical implementation of the iteration scheme",
    ", however , it is not necessary to start from @xmath186 . in order to minimize the time needed for the realization of the iteration scheme , we can use as the first step from the suggested sets of @xmath4 and @xmath3 for all the channels @xcite .",
    "below to obtain the maximal gain from the athf , we can give the same treatment as that for the td98 filter , but treating @xmath187 and @xmath188 as variables .",
    "again , the same assumptions are made on the properties of the signal and noise similar to the td98 filter and its generalization tof [ eq .  ( [ eq : f ] ) ] , namely , the mean beam , the window function and the power spectra of the signal and noises are known . for analysis we will use the flat sky approximation for a small path of the sky .",
    "the generalization of the analysis for the whole sphere can be done without special modification .",
    "let us start with eq .",
    "( [ eq : g ] ) for the flat path of the sky , the cut - off shape of the athf transforms the @xmath187 and @xmath188 parameters on to the summations at both numerator and denominator , @xmath189 ^ 2 } { \\int\\limits_{\\textstyle \\kmin}^{\\textstyle \\kmax } dk\\ ; k \\;w^2(k ) c(k ) } ,   \\label{eq : g1}\\ ] ] where the shape of the filter @xmath190 now is quite peculiar . by the definition ,",
    "the perturbations of the @xmath187 and @xmath188 parameters , @xmath191 and @xmath192 , produce the perturbations of the filter shape @xmath193    as one can see from eq .",
    "( [ eq : g2 ] ) these perturbations correspond to @xmath194 at the ranges @xmath195 and @xmath196 . thus finding the optimal values of the @xmath187 and @xmath188 parameters through the same treatment as in the last section",
    "is not appropriate . from a theoretical point of view",
    "that means that for a given top - hat shape of the filter the point of maxima of the gain parameter does not correspond to any solutions for eq .",
    "( [ eq : m ] ) .    in order to find the optimal @xmath187 and @xmath188 values we use instead the following conditions @xmath197 and @xmath198 . for eq .",
    "( [ eq : g1 ] ) these conditions lead to @xmath199 and @xmath200 we get from eq .",
    "( [ eq : g3 ] ) and eq .",
    "( [ eq : g4 ] ) @xmath201 apart from a trivial solution in eq .",
    "( [ eq : equiv0 ] ) , with undefined value of the @xmath202 , there are non - trivial solutions . for comparison with other filters",
    "we use the same circular gaussian model for the antenna beam and the window function , @xmath203 , where @xmath204 is the @xmath205 , so from eq .",
    "( [ eq : equiv0 ] ) we have @xmath206 .",
    "we can assume that @xmath207 , @xmath208    we further have the following two assumptions .",
    "at the range of @xmath209 , the power spectrum of the combined signal @xmath210 is mainly determined by the sky signals , and the pixel noise contribution is not significant , so @xmath211 on the other hand , for the range of @xmath212 , the power spectrum is mainly determined by the pixel noise power spectrum , which leads @xmath213 the assumptions of eq .",
    "( [ eq : asum ] ) , ( [ eq : approkmin ] ) and ( [ eq : approkmax ] ) are illustrated in fig .",
    "[ powerspectrum ] , in which we show the simulated power spectrum for the high frequency instrument ( hfi ) 100 ghz frequency channel .",
    "( [ eq : approkmin ] ) and eq .  ( [ eq : approkmax ] ) lead to the following relationship between @xmath188 and @xmath187 parameter , @xmath214 which leads to @xmath215.\\ ] ] the ratio @xmath139 can then be obtained from eq.([eq : g1 ] ) @xmath216 we can further solve eq .",
    "( [ eq : g4 ] ) by inserting eq .",
    "( [ eq : ctot ] ) , which then becomes ( with the integral part of @xmath217 ) @xmath218 if the @xmath219 , eq .  ( [ approx ] ) can be approximated and we reach @xmath220 note that we use the simple trapezoidal rule for the integration , which works better when the index @xmath221 is smaller .",
    "we carry out the simulations of the hfi 100 ghz channel for point source extraction by the tof and the athf .",
    "the simulation area is 25.6 @xmath222 , and the pixel size is 3.0 arcmin .",
    "the @xmath223 and the @xmath224 are @xmath225 and @xmath226 , respectively . point sources with amplitudes above @xmath227 at this channel would be flushed out by both ( symmetric ) filters with the 5 @xmath228 criterion ( see the 5th column of table 3 in chiang et  al .  ) , so we add randomly 50 point sources whose amplitudes are @xmath229 to check the efficiency . obviously the number of point sources is too large for this frequency channel , but it serves as the demonstration of the efficiency of extraction .",
    "we specifically use an elliptical beam shape in the simulation with ellipticity ratio @xmath230 @xcite .",
    "we designate the elliptical beam size such that @xmath231 where @xmath232 . for the hfi 100 ghz channel",
    "the fwhm is 10.7 arcmin . in order to simulate more realistic situations",
    ", we put this beam in rotation while scanning across the simulation area in order to investigate how the elliptical beam could affect the efficiency of point source extraction for the tof and the athf .",
    "the period of rotation of the beam is @xmath233 along both sides of the simulation square .",
    "although the rotation period is too large for such size of map , it nevertheless can elucidate the effect of elliptical beam shape regarding point source extraction .    without the exact information of the in - flight beam size and orientation , the optimal form of the tof",
    "is by inserting a circular beam function into eq .",
    "( [ eq : ro ] ) , where the window function @xmath234 . in fig .  [ comparison ]",
    "we plot the point source extraction rate from the tof for the 50 point sources .",
    "the plot is the extraction percentage of point sources against the @xmath98 inserted to the tof ( in terms of 100 ghz channel @xmath235 ) .",
    "we would like to examine , for in - flight elliptical beam shapes , how the supplied beam function for the tof can affect the extraction rate . in the dotted curve",
    ", the power spectrum is precisely known .",
    "the short - dash curve is the case when the slope of the cmb power spectrum has 5 per cent more tilt , whereas the long - dash line 5 per cent less tilt .",
    "the horizontal line marks the athf extraction percentage . with the exact power spectrum ,",
    "the tof is able to detect 85 per cent of the point sources with amplitude @xmath229 when the supplied @xmath98 is chosen in between @xmath236 and @xmath237 . for the case of 5 per cent",
    "more tilt in power spectrum , the supplied beam function will need adjustment to a smaller @xmath98 value to ensure the tof to have a maximal resonance , and adjustment to a larger @xmath98 for the case of 5 per cent less tilt .",
    "on the other hand , the athf can reach 74 per cent of extraction rate without any information . from fig .",
    "[ comparison ] it is not surprising that the safe bet of the beam function is @xmath238 for the uncertainties in the power spectrum .",
    "however , as the cleaning of foreground contamination precedes the determination of the angular power spectrum , and during the whole sky scan of the mission , the possible degradation effect of the mirrors could change the beam size and shape , the efficiency of the tof will be hampered .      in this subsection",
    "we apply the athf to the derived map from the 1-year data .",
    "the derived maps are produced by tegmark , de oliveira - costa & hamilton performing an independent component separation analysis from the team .",
    "they are the foreground - cleaned map ( fcm ) and the wiener - filtered map ( wfm ) .",
    "the fcm was tested to be non - gaussian @xcite , partly due to galactic emission . here",
    "we investigate the possible point source residues from their component separation .",
    "we use the athf on the fcm as it is the map with scientific significance . in fig .",
    "[ filteringrange ] we show the power spectra of the fcm and the q - band map with the corresponding filtering ranges ( the shaded area ) of the athf : @xmath239 for the fcm and @xmath240 for the q - band map .",
    "it is easy to see that the cmb ( plus foreground ) power spectra ( convolved with the beam ) and the noise level .",
    "note that the presentation of the angular power spectrum in fig .",
    "[ filteringrange ] is the standard format , i.e. @xmath53 with the factor @xmath241 , which is different from fig .",
    "[ powerspectrum ] used for analysis in the previous section .",
    "we therefore apply the athf with filtering ranges covering the conjunction of the cmb and noise power curves .",
    "the choice of the filtering range follows the rule of the thumb described in chiang et al .",
    ": the @xmath4 to exclude most of the cmb power , the @xmath3 the noise power , and both to keep the part being convolved by the beam .",
    "[ pointsource ] shows the filtered maps of the fcm ( top panel ) and the q - band map ( bottom ) .",
    "the circled in the top panel are filtered peaks with amplitudes above @xmath242 .",
    "one interesting feature in fig .",
    "[ pointsource ] is that not all the residues we recover are extragalactic point sources .",
    "the dash circles are not peaks , but dips . in the bottom panel",
    "we retain the positions of the circles for comparison , from which those peaks are point sources .",
    "this is to prove that most of the peaks we retrieve from the fcm are point source residues .",
    "we do not intend to recover all residues from one single iteration of the athf but simply demonstrate the usefulness and quickness of the athf on the real data .",
    "application of the athf on the 5 different channel maps will be on a separate paper .",
    "one important issue related to elliptical beam - convolved point source extraction is the removal of point sources .",
    "normally , circular gaussian profile is used for cleaning the elliptical beam - convolved point sources from the map after detection of the point source position . due to the ellipticity of the beam and pixel noise ,",
    "there are considerable residues after the cleaning by circular gaussian profile . to eliminate the residual peaks , we apply a simple algorithm that is modified from the so - called hybrid median filter used in signal processing .",
    "the hybrid median filter is useful in noise reduction and in particular in elimination of shot noise .",
    "this non - linear filter replaces the targeting pixel with average of the neighboring pixels from the same row , column and two diagonals . in the modified cascading version , the targeted region ( @xmath243 pixels ) centered at the residual peak",
    "is replaced with the following algorithm ( see fig .  [ hybridmedian ] ) .",
    "the central pixel is replaced by the median of the 8 pixels from the same row , column , and two diagonals right outside the targeted region .",
    "the four pixels at the four corners in the region can then be decided by the median of their 4 corner pixels , which include the already - replaced central pixel .",
    "the rest 4 pixels can be replaced by the median of their neighbouring pixels from the same row and column .",
    "we have discussed analytically the three main linear filters for point source extraction of the mission .",
    "the tof is optimal in terms of the gain factor .",
    "the so - called optimal pseudo - filter is at its best asymptotic at the far ends to the tof under certain circumstance .",
    "both of these filters require the experiment parameters such as the beam shape and size .",
    "note that the calculation is based on the simple geometrical model of the beam .",
    "as we mention in the beginning , the point source is the reflection of , among others , the beam shape properties .",
    "the possible antenna beam degradation would be a problem for the calibration of the in - flight antenna beam shape @xcite , causing the change of the inclination and the ellipticity ratio of the beam during the mission .",
    "there is one comment on the extraction of point sources from the time - ordered scans when the inclination of the beam , the issue of pointing and the noise properties are most crucial : the inclination angle and the pointing will decide the point source fwhm on the time - ordered data , for which the athf is particularly useful .    note also that we can easily generalize the multi - frequency method for point source extraction @xcite by applying the athf for all frequency channels .",
    "this paper was supported by danmarks grundforskningsfond through its support for the establishment of the theoretical astrophysics center .",
    "the authors are grateful for tegmark et al . for their processed maps .",
    "we acknowledge the use of healpix @xcite package and the glesp code @xcite for whole - sky data processing .",
    "we thank o. verkhodanov for the help with the glesp package .",
    "grski , k. m. , hivon , e. , & wandelt , b. d. 1999 , proceedings of the mpa / eso cosmology conference `` evolution of large - scale structure '' , eds .",
    "j. banday , r. s. sheth and l. da costa , printpartners ipskamp , nl"
  ],
  "abstract_text": [
    "<S> the manifestation of point sources in the upcoming maps is a direct reflection of the properties of the pixelized antenna beam shape for each frequency , which is related to the scan strategy , pointing accuracy , noise properties and map - making algorithm . in this paper </S>",
    "<S> we firstly compare analytically two filters for the point source extraction , namely , the adaptive top - hat filter ( athf ) , the theoretically - optimal filter ( tof ) . </S>",
    "<S> our analyses are based on the premise that the experiment parameters the tof assume and require are already known : the cmb and noise power spectrum and a _ circular _ gaussian beam shape and size , whereas the athf does not need any _ a priori _ knowledge . </S>",
    "<S> the analyses show that the tof is optimal in terms of the gain after the parameter inputs . </S>",
    "<S> we simulate the _ planck _ </S>",
    "<S> hfi 100 ghz channel with elliptical beam in rotation to test the efficiency of the tof and the athf . </S>",
    "<S> we also apply the athf on the q - band map and the derived map ( the foreground - cleaned map by tegmark , de oliveira costa & hamilton ) from the 1-year data . </S>",
    "<S> the uncertainties on the angular power spectrum will hamper the efficiency of the tof . to tackle the real situations for the point source extraction , most importantly , the elliptical beam shape with slow precession and change of the ellipticity ratio due to possible mirror degradation effect , the athf is computationally efficient and well suited for the construction of the early release compact source catalogue .    </S>",
    "<S> techniques : image processing  cosmic microwave background  methods : analytical </S>"
  ]
}