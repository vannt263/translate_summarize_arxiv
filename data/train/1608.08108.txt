{
  "article_text": [
    "flash  @xcite is the free - electron laser ( fel ) facility at the deutsches elektronen - synchrotron ( desy ) in hamburg , germany .",
    "it contains two undulator beamlines , flash1 and flash2 , driven by the same linear accelerator . while flash1 consists of fixed - gap undulator modules , flash2 is equipped with variable - gap undulator modules .",
    "the variable - gap feature enables the simultaneous operation of flash1 and flash2 at different wavelengths  @xcite .",
    "it also enables the implementation of undulator tapering in flash2 .",
    "undulator tapering involves the variation of the undulator parameter @xmath0 as a function of the distance @xmath1 along the undulator line , for the purpose of enhancing the radiation power ( and hence the efficiency ) of the fel .",
    "this has been demonstrated empirically in x - ray fels , such as lcls  @xcite and sacla  @xcite . in order to maximize the enhancement of radiation power , the taper profile @xmath2 needs to be properly optimized .",
    "present - day imaging experiments at x - ray fels call for an increased number of photons within a shorter pulse duration  @xcite .",
    "to meet the stringent demand on the radiation power , the theory of taper optimization has been revisited in recent years . in ref .",
    "@xcite , an important step is made towards the formulation of a universal taper law . in refs .",
    "@xcite , taper optimization methods based on the classic kroll - morton - rosenbluth ( kmr ) model  @xcite are demonstrated in numerical simulations . in refs .",
    "@xcite , a multidimensional optimization method is performed in numerical simulations , whereby the optimal taper profile @xmath2 is obtained by scanning through a parameter space comprising the taper order ( such as linear and quadratic ) , the taper start point , the taper amplitude etc .",
    "the multidimensional optimization approach is relatively straightforward .",
    "guided by the theoretical studies , this approach is implemented empirically in flash2 at a wavelength of 44  nm , and the results are presented in this article .",
    "the empirical results of the taper optimization are then compared with the corresponding numerical simulations .",
    "the agreement and discrepancies between the empirical and simulation results are analyzed .",
    "the article concludes by excluding a number of otherwise possible causes of the discrepancies .",
    "flash2 contains a total of 12 undulator modules . between every two adjacent modules ,",
    "there is a drift section for beam focusing , trajectory correction , phase shifting , diagnostics etc .",
    "table  [ exppars ] shows the known machine parameters . for machine parameters not listed in table  [ exppars ] ,",
    "the nominal design values  @xcite are assumed .",
    ".machine parameters [ cols=\"<,^,^\",options=\"header \" , ]     in the simulation , the initial values of the optical functions and the quadrupole strengths are chosen self - consistently to give the desired average beta value , independent of the values used in the experiment .       for ( a )",
    "linear tapering ( @xmath3 ) and ( b ) quadratic tapering ( @xmath4 ) . the blue solid curve , red dashed curve and yellow dotted curve correspond respectively to start modules @xmath5 6 , 7 and 8 . ]    ) , the optimal linear taper ( @xmath6 , @xmath7 ) and the optimal quadratic taper ( @xmath8 , @xmath9 ) . ]",
    "the same multidimensional optimization is performed in simulation . using eq .",
    "( [ taperprofdeg ] ) as the ansatz , the parameters @xmath10 , @xmath11 and @xmath12 are scanned for the highest final radiation energy .",
    "the results are shown in fig .",
    "[ deltak_plots_sim ] . among all the taper profiles considered in fig .",
    "[ deltak_plots_sim ] , the optimal linear taper occurs at @xmath13 and @xmath14 , whereas the optimal quadratic taper occurs at @xmath15 and @xmath16 .    for the optimal linear taper , the optimal quadratic taper and no taper ,",
    "the simulated pulse energy evolutions along the undulator line are shown in fig .",
    "[ energy_evol_sim](a ) .",
    "the corresponding taper profiles are shown in fig .",
    "[ energy_evol_sim](b ) for reference .      comparing fig .",
    "[ deltak_plots_exp ] ( empirical ) and fig .",
    "[ deltak_plots_sim ] ( simulation ) , the optimal taper profiles are consistent . in both cases , the optimal linear taper occurs at @xmath13 and @xmath14 , and the optimal quadratic taper occurs at @xmath15 and @xmath16 .",
    "[ deltak_plots_exp ] and  [ deltak_plots_sim ] also show good agreement in the overall trend for the final optical pulse energy @xmath17 . in both cases ,",
    "the overall trend for linear tapering ( @xmath3 ) is @xmath18 whereas the overall trend for quadratic tapering ( @xmath4 ) is @xmath19 however , figs .",
    "[ deltak_plots_exp ] and  [ deltak_plots_sim ] show disagreement in terms of the absolute pulse energies .",
    "the range of pulse energies is generally higher in the simulation than in the experiment .",
    "next , the pulse energy evolution along the undulator line is compared between simulation [ see fig .  [ energy_evol_sim](a ) ] and experiment [ see fig .  [ energy_evol_exp](a ) ] . in both cases , the pulse energy remains in the order of 1 @xmath20j before module 5 , and exceeds the 10-@xmath20j threshold in module 5 . in the absence of tapering , the initial saturation point is situated around module 8 in both cases ( see solid curves ) . with the optimal linear and quadratic tapers ,",
    "final saturation is reached within the 12 undulator modules in both simulation and experiment , but occurs earlier in the experiment than in the simulation ( see dashed and dotted curves ) .    in the experiment , the optimal linear taper and the optimal quadratic taper yield almost identical final pulse energy .",
    "but in the simulation , the final pulse energy for the optimal quadratic taper is 1.2 times higher than that for the optimal linear taper .    in the experiment ,",
    "the enhancement factor is @xmath21 but in the simulation , the enhancement factor is @xmath22 which is 2.6 times higher than that in the experiment .      in both the simulation and empirical results ,",
    "the optimal linear taper starts from module 7 , while the optimal quadratic taper starts from module 6 .",
    "the reason for this difference in the optimal start point is that the undulator parameter decreases much more slowly at the beginning of the quadratic taper .",
    "this is seen in figs .",
    "[ energy_evol_exp](b ) and  [ energy_evol_sim](b ) . in module 6",
    "from which the quadratic taper starts , the undulator parameter @xmath23 is effectively identical to the initial value @xmath24 , as @xmath25 .",
    "it is in module 7 where the undulator parameter starts to show a significant difference from the initial value . in other words ,",
    "the optimal quadratic taper starts effectively from module 7 , the same module from which the optimal linear taper starts .    refs .",
    "@xcite suggest that the optimal taper start point is two gain lengths before the initial saturation point .",
    "in one - dimensional theory , the gain length is given by @xmath26 where @xmath27 is the dimensionless pierce parameter , @xmath28 ka is the alfvn current , @xmath29 is the rms radius of the electron beam , and @xmath30 is the bessel factor for planar undulators , with @xmath31 $ ] .    with the parameters in tables  [ exppars ] and  [ simpars ] , the pierce parameter is @xmath32 , and the gain length is @xmath33 m. thus",
    ", the optimal taper start point is predicted to be @xmath34 m before the initial saturation point , excluding the length of the drift section between undulator modules .",
    "if we assume that the precise initial saturation point is at the beginning of module 8 , then the optimal taper start point should lie within module 7 .",
    "this rough prediction agrees with the simulation and empirical results .       and ( b ) resonant phase @xmath35 along the undulator line .",
    "the blue solid curve , red dashed curve and yellow dotted curve correspond respectively to no taper ( @xmath36 ) , the optimal linear taper ( @xmath6 , @xmath7 ) and the optimal quadratic taper ( @xmath8 , @xmath9 ) . ]    the kroll - morton - rosenbluth ( kmr ) model  @xcite is a theoretical analysis of undulator tapering in fels based on a one - dimensional relativistic hamiltonian formulation . in refs .",
    "@xcite , the kmr model is used as a method to optimize fel taper profiles in numerical simulations .",
    "after choosing the resonant phase @xmath37 , the taper profile @xmath2 is computed from the differential equation @xmath38,\\ ] ] where @xmath39 is the on - axis field amplitude and @xmath1 is the position along the undulator line . with a constant @xmath35 , the optimization is known as the ordinary kmr method . with a variable @xmath35 which increases gradually from zero ,",
    "the optimization is known as the modified kmr method .    with the simulation results at hand",
    ", the evolution of the resonant phase @xmath35 along the undulator line can be back - calculated from eq .",
    "( [ kmr_equation ] ) .",
    "this back - calculation requires the taper profile @xmath2 [ see fig .",
    "[ energy_evol_sim](b ) ] and the field amplitude evolution @xmath40 [ see fig .  [ psir_evol_sim](a ) ] as inputs .",
    "carrying out this back - calculation for the optimal linear taper , the optimal quadratic taper and no taper , the resulting @xmath37 functions are shown in fig .",
    "[ psir_evol_sim](b ) .",
    "the optimal linear and quadratic tapers start from module 7 and module 6 , respectively .",
    "before the taper starts , @xmath41 [ see dashed and dotted curves in fig .",
    "[ psir_evol_sim](b ) ] .",
    "this is expected , as @xmath42 implies @xmath41 according to eq .",
    "( [ kmr_equation ] ) .",
    "for the same reason , in the absence of any tapering , @xmath35 remains zero at all times [ see solid line in fig .  [ psir_evol_sim](b ) ] .",
    "when the optimal linear taper starts in module 7 , @xmath35 increases abruptly from 0 to @xmath43 , and remains almost constant afterwards [ see dashed curve in fig .",
    "[ psir_evol_sim](b ) ] .",
    "when the optimal quadratic taper starts in module 6 , @xmath35 increases gradually and monotonically from 0 , until it reaches a value of @xmath44 in the final module [ see dotted curve in fig .",
    "[ psir_evol_sim](b ) ] .",
    "the @xmath37 function for the optimal linear taper resembles one used in the ordinary kmr method , whereas the @xmath37 function for the optimal quadratic taper resembles one used in the modified kmr method .",
    "the empirical and simulation results are in good agreement in terms of :    * the @xmath45 values for the optimal linear and quadratic tapers ; * the overall trend in the plots of the final energy @xmath17 versus @xmath12 ( see figs .",
    "[ deltak_plots_exp ] and  [ deltak_plots_sim ] ) ; and * the module in which the exponential gain crosses the 10-@xmath20j threshold ( see figs .",
    "[ energy_evol_exp ] and  [ energy_evol_sim ] ) .",
    "however , there are three main discrepancies between the empirical and simulation results :    * in the parameter space @xmath46 considered , the @xmath17 range is generally lower in the experiment than in the simulation ( see figs .",
    "[ deltak_plots_exp ] and  [ deltak_plots_sim ] ) . *",
    "the enhancement factor @xmath47 is 3.9 in the simulation , but only 1.5 in the experiment . * with the optimal linear and quadratic tapers , final saturation occurs earlier in the experiment than in the simulation ( see figs .",
    "[ energy_evol_exp ] and  [ energy_evol_sim ] ) .",
    "the exact causes of these discrepancies are not known .",
    "yet , it is possible to _ exclude _ a number of otherwise possible causes , such as the shot - to - shot variability , drift of the machine and wakefield effects .",
    "these are addressed in the upcoming subsections .",
    "the discrepancies in question can also be caused by incorrect assumptions of parameter values .",
    "for the simulation , the nominal flash2 parameter values in table  [ simpars ] are assumed .",
    "the assumed nominal values in the simulation can be different from the unknown actual values in the experiment .    as illustrated in the sensitivity study in ref .",
    "@xcite , a slight change in the emittance , energy spread or peak current can have a huge impact on the optimized radiation power of a tapered fel . in other words , if the actual emittance , energy spread or peak current is worse than assumed , then the optimized radiation energy will be lower than expected .",
    "this will , in turn , influence the enhancement factor .",
    "this can possibly explain the discrepancies in question .",
    "however , the proposition that the emittance , energy spread or peak current is worse than assumed will be _ disproved _ in the following subsections .      in the empirical results ( figs .",
    "[ deltak_plots_exp ] and  [ energy_evol_exp ] ) , the shot - to - shot fluctuations are accounted for by the error bar , which indicates the standard deviation of many shots .",
    "all the error bars are within @xmath48 23 @xmath20j , which is too small to account for the discrepancies between the simulation and empirical results .",
    "consider two scenarios in particular , the optimal linear taper and no taper .",
    "since the optimal linear taper only starts from undulator module 7 , the two scenarios are identical before module 7 . in principle",
    ", the two scenarios should yield the same pulse energy evolution before module 7 .",
    "this is precisely the case in the simulation [ see solid and dashed curves in fig .  [ energy_evol_sim](a ) ] , which is the ideal case free of any drift .",
    "but in the empirical results [ see solid and dashed curves in fig .",
    "[ energy_evol_exp](a ) ] , the two scenarios yield slightly different energies in modules 5 and  6 . the energy differences can be partly attributed to the drift of the machine .",
    "but despite the drift , the energy differences are still within 24 @xmath20j , which is too small to account for the discrepancies between the simulation and empirical results .       for ( a )",
    "linear tapering and ( b ) quadratic tapering . ]    in order to disprove that the emittance is underestimated , the simulation is repeated with the normalized emittance slightly increased , from 1.4 mm mrad to 1.6 mm mrad .",
    "all other parameters in tables  [ exppars ] and  [ simpars ] are kept unchanged . with",
    "the average beta function @xmath49 kept unchanged , this requires increasing the rms beam radius @xmath50 from 82 @xmath20 m to 87 @xmath20 m .",
    "the new simulation results are shown in fig .",
    "[ deltak_plots_sim_normemit ] .",
    "if the emittance were indeed underestimated in the original simulation , then the new simulation ( with an increased emittance ) would show an improved agreement with the empirical results .",
    "but in the new simulation results , the overall trends of the final pulse energy @xmath17 change . as seen in fig .",
    "[ deltak_plots_sim_normemit ] , the overall trend for linear tapering ( @xmath3 ) becomes @xmath51 whereas the overall trend for quadratic tapering ( @xmath4 ) becomes @xmath52 the overall trends actually become further off from those in the empirical results ( see fig .",
    "[ deltak_plots_exp ] ) .",
    "meanwhile , there is no improved agreement in the @xmath17 range and in the enhancement factor .",
    "this disproves that the emittance is underestimated in the original simulation .    comparing the two sets of simulation results in fig .",
    "[ deltak_plots_sim ] and  [ deltak_plots_sim_normemit ] , the increased emittance makes it more favourable to start the taper at a later point down the undulator line .",
    "the optimal quadratic taper in fig .",
    "[ deltak_plots_sim ] starts from module 6 , whereas that in fig .",
    "[ deltak_plots_sim_normemit ] starts from module 7 . as for linear taper ,",
    "module 7 remains the most favourable start module .",
    "yet , while module 8 is the least favourable of the three start modules considered in fig .",
    "[ deltak_plots_sim ] , it becomes the second most favourable in fig .",
    "[ deltak_plots_sim_normemit ] .    the shift in the optimal taper start point can be explained as follows .",
    "@xcite suggest that the optimal taper start point @xmath53 is two gain lengths before the initial saturation point . in one - dimensional theory ,",
    "this is given by @xmath54 with the definition of the pierce parameter in eq .",
    "( [ pierce ] ) , one can deduce that @xmath55",
    "the proportionality implies that an increased emittance moves the optimal taper start point downstream .",
    "it also implies that a further increase in emittance would move the optimal taper start point further downstream , thus making the overall trends of @xmath17 even further off from those in the empirical results .       for ( a ) linear tapering and ( b ) quadratic tapering . ]    in order to disprove that the peak current is overestimated , the simulation is repeated with the peak current slightly decreased , from 1.5 ka to 1.2 ka . in order to keep the known bunch charge in table  [ exppars ] unchanged",
    ", this requires increasing the rms bunch length from 24 @xmath20 m to 30 @xmath20 m .",
    "all other parameters in tables  [ exppars ] and  [ simpars ] are kept unchanged .",
    "the new simulation results are shown in fig .",
    "[ deltak_plots_sim_pcurrent ] .    again , by decreasing the peak current in the simulation , the overall trends in the final pulse energy @xmath17 become further off from those in the empirical results ( see fig .  [ deltak_plots_exp ] ) .",
    "this disproves that the peak current is overestimated .",
    "comparing the two sets of simulation results in fig .",
    "[ deltak_plots_sim ] and  [ deltak_plots_sim_pcurrent ] , the decreased peak current also makes it more favourable to start the taper in a later undulator module .",
    "this agrees with the one - dimensional theoretical prediction from eqs .",
    "( [ pierce ] ) and  ( [ z0 ] ) that @xmath56       for ( a ) linear tapering and ( b ) quadratic tapering . ]    in order to disprove that the energy spread is underestimated , the simulation is repeated with the energy spread slightly increased , from 0.5 mev to 0.7 mev .",
    "all other parameters in tables  [ exppars ] and  [ simpars ] are kept unchanged .",
    "the new simulation results are shown in fig .",
    "[ deltak_plots_sim_espread ] .",
    "again , by increasing the energy spread in the simulation , the overall trends in the final pulse energy @xmath17 become further off from those in the empirical results ( see fig .",
    "[ deltak_plots_exp ] ) .",
    "this disproves that the energy spread is underestimated .",
    "comparing the two sets of simulation results in fig .",
    "[ deltak_plots_sim ] and  [ deltak_plots_sim_espread ] , the increased energy spread also makes it more favourable to start the taper in a later undulator module .",
    "however , it is impossible to use the one - dimensional formulation to explain the shift in the optimal taper start point caused by the increased energy spread , as it is done for the emittance and the peak current .",
    "nonetheless , the energy spread effects can be explained by similar arguments using the generalized formulation of ming xie  @xcite .      in ref .",
    "@xcite , a simulation study on the effects of wakefields is performed on a case of the ttf - fel , which is the predecessor of the flash1 and flash2 facilities .",
    "the machine parameters used in the simulation study are in the same orders of magnitude as those in tables  [ exppars ] and  [ simpars ] .",
    "the study identifies three major sources of wakefields , namely , the conductivity , surface roughness and geometrical changes of the beam pipe along the undulator .",
    "the simulation on the ttf - fel case shows that wakefields can reduce the saturation power of the fel by three orders of magnitude , while keeping the saturation length almost unchanged . in principle",
    ", wakefield effects can be a possible explanation for the discrepancies between our empirical and simulation results for flash2 .",
    "however , this can be disproved as follows .    in the empirical optimization of undulator tapering , the optimal taper profile which maximizes the final radiation energy is also that which best compensates the energy loss due to wakefields  @xcite .",
    "meanwhile , in the simulation which results in fig .",
    "[ deltak_plots_sim ] , wakefields are _ not _ considered . if wakefield effects were significant , then the optimal taper profile should occur at very different @xmath45 values in the empirical and simulation results .",
    "but as seen in figs .",
    "[ deltak_plots_exp ] and  [ deltak_plots_sim ] , this is _ not _ the case .",
    "in fact , the experiment and simulation yield the exact same @xmath45 values for the optimal linear taper , and for the optimal quadratic taper . this leads us to the conclusion that wakefield effects are not significant in the experiment , and therefore do not account for the discrepancies in question .",
    "the ideal trajectory of the electron beam is the central axis along the undulator line .",
    "but if the electron beam undergoes betatron oscillations as a whole , it deviates from the ideal trajectory and is subject to trajectory errors .",
    "these errors can be caused by a combination of many factors , which include    * the imperfect alignment of the undulator modules ; * the imperfect alignment of the quadrupole magnets ; and * the inclined injection of the electron beam to the undulator modules .",
    "trajectory errors can degrade the fel performance through a number of mechanisms  @xcite .",
    "a complete analysis of all these mechanisms is not trivial .",
    "but in taper optimization studies , it is the undulator parameter @xmath0 which characterizes a taper profile .",
    "the following discussions shall focus on the implication of trajectory errors to @xmath0 .",
    "the undulator parameter @xmath0 is associated with the magnetic field strength @xmath57 on the central axis of the undulator by the definition @xmath58 in the presence of trajectory errors , the electron beam deviates from the central axis . even if the on - axis field strength @xmath57 were perfectly accurate , the electron beam would still experience a field strength different from the desired value @xmath57 , hence an undulator parameter different from the desired value @xmath0 . as derived in the appendix ,",
    "the effective undulator parameter is @xmath59 where @xmath60 is the deviation of the electron beam from the central axis , and @xmath61 is the undulator wavenumber .",
    "the magnetic field strength experienced by an electron beam with a trajectory error @xmath60 in an undulator with parameter @xmath0 is equivalent to that experienced by an on - axis electron beam in an undulator of parameter @xmath62 .",
    "the effective undulator parameter @xmath62 also leads to a phase shift error .",
    "as mentioned in section  [ phaseshifterconfig ] , the required phase shift in the drift section depends solely on the @xmath0 value of the preceding undulator module .",
    "given an input value @xmath0 , the phase shifter is automatically adjusted to ensure proper phase matching at the end of the drift section .",
    "but if the effective value is @xmath63 , then a phase mismatch will occur . as derived in the appendix , this phase mismatch is given by @xmath64 , \\label{delphi}\\ ] ] here @xmath65 is the drift section length , which is 800 mm in flash2 .",
    "and @xmath66 associated with a trajectory error of @xmath67 @xmath20 m .",
    "the final pulse energy is plotted as a function of the taper amplitude @xmath12 for ( a ) linear tapering and ( b ) quadratic tapering . ]",
    "the simulation is now repeated with the @xmath68 and @xmath66 associated with a trajectory error of @xmath67 @xmath20 m , calculated from eqs .",
    "( [ keff ] ) and  ( [ delphi ] ) . with a trajectory error of @xmath67 @xmath20 m ,",
    "the difference between @xmath62 and @xmath0 becomes comparable to the pierce parameter @xmath69 , and is therefore significant .",
    "the new simulation results are shown in fig .",
    "[ deltak_plots_sim_orbiterr ] .",
    "again , the overall trends in the final pulse energy @xmath17 become further off from those in the empirical results ( see fig .",
    "[ deltak_plots_exp ] ) .",
    "thus , the @xmath68 and @xmath66 associated of a trajectory error of @xmath67 @xmath20 m can not account for the discrepancies between the empirical and simulation results .      in the preceding discussions ,",
    "the different possible causes of the discrepancies in question are considered separately . in the following , combinations of these factors will be discussed .",
    "shot - to - shot fluctuations and the drift of the machine can each affect the measured optical pulse energy by about 20 @xmath20j .",
    "the combined effect is then 40 @xmath20j , which is still too small to account for the discrepancies in question .",
    "the emittance , the peak current and the energy spread have been considered individually . as discussed in sections  [ emittanceunderestimated][energyspreadunderestimated ] ,",
    "if any of these three parameters is worse than assumed , then the optimal taper start point @xmath53 will be shifted downstream [ see e.g. eqs .",
    "( [ z0_emit ] ) and  ( [ z0_current ] ) ] . from this one can deduce that if all three ( or at least two of the three ) parameters are worse than assumed , then the optical taper start point @xmath53 will be shifted even further downstream .",
    "this will , in turn , make the overall trends of the final pulse energy @xmath17 even further off from those in the empirical results .",
    "thus , the discrepancies between the simulation and empirical results can not be explained by the combination of an underestimated emittance , an overestimated peak current and an underestimated energy spread .",
    "there are no indications that the three parameters are much different from their design values .",
    "but in principle , one could consider different scenarios where one parameter is worse than assumed while another parameter is _",
    "better _ than assumed .",
    "one example examined in numerical simulation is the scenario where the normalized emittance is halved while the energy spread is doubled ( results not shown ) .",
    "the resulting range of optical pulse energies becomes closer to that in the experiment .",
    "yet , the overall trends of the final pulse energy @xmath17 , as well as the @xmath45 values of the optimal tapers , become further off from those in the experiment .    even though there are possible explanations for some of the discrepancies between the empirical and simulation results ,",
    "there is no simple explanation that would explain all differences .",
    "a multidimensional optimization method has been implemented empirically in flash2 , to optimize the taper profile for the maximum radiation energy .",
    "the empirical results have been correlated to simulations .    in the empirical study ,",
    "the taper profile is characterized by the taper order @xmath10 , the start module @xmath11 and the taper amplitude @xmath12 . for the optimal linear ( @xmath70 ) and quadratic ( @xmath71 ) tapers , the evolution of the optical pulse energy along the undulator line was examined .",
    "the empirical results were compared with the corresponding results of numerical simulation .",
    "the two sets of results show good agreement in terms of the overall trend in the variation of the final pulse energy @xmath17 with @xmath12 .",
    "they also show good agreement for the optimal linear and quadratic tapers regarding the start module ( @xmath11 ) , the taper amplitude ( @xmath12 ) and the exponential gain profile .",
    "however , there are discrepancies in terms of the general range of pulse energies , the enhancement factor from tapering , as well as the final saturation points for the optimal tapers .",
    "possible causes of the discrepancies have been examined , and a number of them excluded , such as emittance , energy spread and peak current deviations .",
    "also , shot - to - shot variation , the drift of the machine , wakefield effects , as well as the systematic @xmath0 and phase shift errors associated with a beam trajectory error have been excluded .",
    "remaining factors are mainly ( i ) a poor overlapping between the electron beam and the optical mode , caused by the misalignment and mismatch of the electron optics ; and ( ii ) phase mismatch caused by random errors in the phase shifters .",
    "these remaining factors need to be investigated in more detail .",
    "further studies in numerical simulations and empirical measurements are planned for the future .",
    "the authors would like to thank katja honkavaara and siegfried schreiber for their crucial roles in facilitating this international collaboration .",
    "the authors would also like to thank evgeny schneidmiller , markus tischer and mikhail yurkov for their participation in the planning meeting for the experimental work .",
    "in section  [ trajerr ] , the effective undulator parameter @xmath62 associated with a trajectory error is discussed .",
    "this appendix gives a derivation for @xmath62 and the subsequent phase mismatch @xmath66 .",
    "consider a pair of magnetic poles in the undulator , directly opposite to each other .",
    "define the @xmath60-axis as the straight line passing through the middle points of the two pole tips . as usual",
    ", the @xmath1-axis is in the direction of beam propagation , perpendicular to the @xmath60-axis .",
    "a trajectory error in the @xmath60-direction changes the distance between the electron beam and the magnetic pole , which has a strong impact on the magnetic field strength experienced by the beam .",
    "meanwhile , an trajectory error purely in the @xmath72-direction imposes no change on the beam - pole distance , and is therefore not treated here .    following the derivation in ref .",
    "@xcite , the variation of the magnetic field strength @xmath73 along the @xmath60-axis is examined using a two - dimensional model in the @xmath74-plane . along the @xmath1-axis ,",
    "the magnetic field strength is periodic , with a period of @xmath75 . assuming that the periodic variation is perfectly sinusoidal , the following ansatz can be written for the magnetic scalar potential : @xmath76 here @xmath77 is an unknown function which depends only on @xmath60 .",
    "the scalar potential @xmath78 has to satisfy the laplace equation @xmath79 substituting eq .",
    "( [ eq : scalarpotential ] ) into eq .",
    "( [ eq : laplace ] ) results in the second - order ordinary differential equation @xmath80 to which the general solution is @xmath81 with arbitrary constants @xmath82 and @xmath83 . inserting this into eq .",
    "( [ eq : scalarpotential ] ) , the scalar potential may be rewritten as @xmath84 the @xmath60-component of the magnetic field is then @xmath85    recalling that the peak field on the @xmath1-axis is @xmath86 , we have @xmath87 . given the symmetry of the system about the plane @xmath88 , we have @xmath89 and hence @xmath90 . with these results , eq .",
    "( [ eq : by ] ) can be rewritten as @xmath91 to examine the variation of @xmath73 along the @xmath60-axis , we set @xmath1 = 0 and obtain @xmath92    : ( a ) the effective undulator parameter @xmath68 of an undulator module and ( b ) the resulting error @xmath93 in the phase shift immediately after the undulator module .",
    "these plots are made for a desired @xmath0 value of 2.638 , which is in resonance with the initial energy of the electron beam . ]    in other words , if the electron beam has a trajectory error of @xmath60 , then it experiences a field @xmath94 as given by eq .",
    "( [ eq : by_along_y ] ) .",
    "analogous to eq .",
    "( [ k_def ] ) , the effective undulator parameter can be defined as @xmath95 a plot of @xmath62 versus @xmath60 is shown in fig .  [ keff_vs_y](a ) .",
    "note that @xmath96 for all @xmath97 , meaning that any trajectory error in the @xmath60-direction effectively _ increases _ the undulator parameter from the desired value @xmath0 .",
    "the difference between the effective undulator parameter @xmath68 and the desired value @xmath0 can be expressed as @xmath98.\\ ] ] this difference of @xmath99 in an undulator module , in turn , leads to a phase mismatch in the drift section thereafter . in the drift section",
    ", there is a phase advance due to the speed difference between the electron beam and the radiation emitted in the preceding undulator module . for a drift length @xmath65 after an undulator module with parameter @xmath0 , this phase advance is  @xcite @xmath100 the phase shifter in the drift section is configured to perform automatic phase matching for the @xmath101 associated with the input value @xmath0 .",
    "thus , the difference of @xmath99 causes a phase shift error of @xmath102.\\ ] ] the absolute phase error @xmath103 is shown in fig .",
    "[ keff_vs_y](b ) as a function of @xmath60 . in this discussion , the additional phase advance due to the fringe fields at the two ends of an undulator module is not considered .",
    "p.  schmser , m.  dohlus , j.  rossbach , in _ ultraviolet and soft x - ray free - electron lasers : introduction to physical principles , experimental results , technological challenges _",
    "( springer , berlin , 2008 ) , pp ."
  ],
  "abstract_text": [
    "<S> in a free - electron laser equipped with variable - gap undulator modules , the technique of undulator tapering opens up the possibility to increase the radiation power beyond the initial saturation point , thus enhancing the efficiency of the laser . </S>",
    "<S> the effectiveness of the enhancement relies on the proper optimization of the taper profile . in this work </S>",
    "<S> , a multidimensional optimization approach is implemented empirically in the x - ray free - electron laser flash2 . </S>",
    "<S> the empirical results are compared with numerical simulations .    free - electron laser , undulator tapering , experiment , numerical simulation </S>"
  ]
}