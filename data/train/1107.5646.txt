{
  "article_text": [
    "the network approach , where interacting elements are represented as nodes and interactions as edges , has become widely used in the study of complex systems @xcite .",
    "although this approach unquestionably discards many details , it has turned out to provide much insight into the function and dynamics of the systems in question .",
    "many large networks display similar properties on the global scale , such as broad degree distributions , short path lengths , and abundance of triangles ; on the mesoscopic level , complex networks often display community structure @xcite .",
    "there is much variation in the mesoscale structure of different networks @xcite , reflecting different underlying functional and dynamical mechanisms .",
    "such differences can also be observed in the relative significance of _ motifs _ , sets of small topologically equivalent subgraphs @xcite .",
    "the concept of motifs has also been generalized to unweighted @xcite and weighted @xcite networks .",
    "static networks are often time - aggregates of systems where connections are not continuously active but established only during limited periods of time .",
    "this temporal aspect turns out to be crucial for processes like spreading of information and electronic viruses in communication networks @xcite , epidemiological applications @xcite , and signal processing in the brain ( see , _",
    "e.g. _ , @xcite ) .",
    "sometimes temporal aspects such as link activation frequencies are incorporated in the static network representation as link weights , which are then assumed to affect dynamic processes like spreading in probabilistic mean field manner .",
    "however , it has recently become clear that temporal inhomogeneities not captured by this approach have an important effect on many processes @xcite .    in this article",
    "we use the _ temporal networks _ approach ( see , _",
    "e.g. _ , @xcite and @xcite for a review ) to study the details of link activations without projecting out the temporal dimension .",
    "while static networks consist of nodes and edges , temporal networks consist of nodes and _ events_. a ( directed ) event @xmath0 connects the two nodes @xmath1 only during the time interval from @xmath2 to @xmath3 .",
    "our presentation uses directed events for generality , but undirected events can be used with minimal changes .",
    "we restrict ourselves to the case where nodes can not participate in simultaneous events , _",
    "i.e. _ , at any given time at most one event can be assigned to a node .",
    "it is reasonable to expect temporal networks to have mesoscale structures both in topology and time .",
    "these structures are likely to reflect the function of the system even better than mesoscale structures in static networks and thus their characterization can improve our understanding of various complex systems , from the nature of human social interactions and information processing by groups to temporal patterns that determine the outcomes of dynamical processes like spreading .",
    "_  have studied strongly and weakly connected components in temporal networks @xcite .",
    "braha and bar - yam @xcite have studied motifs in static snapshot networks , aggregated over one day of email data , and found that dense subgraphs are overrepresented .",
    "et al . _",
    "@xcite have defined dynamical motifs as sequences of connected events belonging to adjacent time windows of network aggregation .",
    "in essence , these are time - respecting paths @xcite , that is , linear chains of events , and are thus different from the temporal motifs discussed in this paper . zhao _",
    "et al . _",
    "@xcite have studied communication motifs in electronic social networks with an approach that has some similarity to the approach we take in this paper  they , too , consider subsets of communication events where the time between consecutive events sharing a node is within a chosen threshold time .",
    "however , in their analysis , the time dimension of such temporal subgraphs appears to have been projected out by projecting the patterns into static subgraphs .",
    "the _ temporal motifs _ we introduce here can be used to study the full mesoscale topological - temporal structure of temporal networks .",
    "we also present an efficient algorithm for identifying all temporal motifs in empirical data sets on temporal graphs , that is , time - stamped sequences of events between nodes .",
    "in static networks the motifs are  in a very general sense  defined as classes of isomorphic , connected subgraphs .",
    "we define temporal motifs analogously , first by defining connected subgraphs in temporal networks and then by extending the definition of isomorphism such that it also takes into account the temporal information in these subgraphs .    as an example , in a social communication network one might detect an event sequence where alice calls bob , who then calls carol and dave .",
    "a similar sequence might be observed to often take place between the same people , as well as between other sets of four individuals .",
    "all these sequences are members of the same class , which we call a temporal motif . in genetic regulation data",
    "the event sequence would correspond to regulatory interactions switching on and off as the intercellular system performs its function .",
    "in addition to providing insight into the operation of the system under study , temporal motifs allow studying similarities and differences of temporal networks , as originally proposed for static motifs in @xcite .",
    "in addition they may help in building models of network evolution @xcite .",
    "we start with a formal definition of temporal motifs in section [ sec : definitions ] , and then cover the main ideas of the identification algorithm . in section",
    "[ sec : generalizations ] we discuss some useful generalizations and show how they can also be implemented efficiently . section [ sec : evaluation ] glances at different methods for evaluating the significance of the observed motif counts .",
    "finally , in section [ sec : results ] we use the methods to identify temporal motifs in a large temporal network constructed from mobile phone data and discuss the insights the motifs provide",
    ". a detailed account on all algorithms is provided in the appendix .",
    "static motifs are classes of isomorphic subgraphs . while there is variation in exactly what kind of subgraphs",
    "are studied , it is practically always required that these subgraphs be connected",
    ". for static graphs connectivity means that there is a path between all pairs of nodes , or equivalently that there is a sequence of mutually _ adjacent _ edges between all pairs of edges , where two edges are adjacent if they have one node in common .    in temporal networks",
    "the definition of adjacency should intuitively also include time ; two calls made by the same person a month apart are hardly close to each other .",
    "we consider two events @xmath4__-adjacent _ _ if they have at least one node in common and the time difference between the end of the first event and the beginning of the second event is no longer than @xmath4 .",
    "equivalently , two events are @xmath4__-connected _ _ if there exists a sequence of events @xmath5 such that all pairs of consecutive events are @xmath4-adjacent .    using these definitions ,",
    "a _ connected temporal subgraph _ consists of a set of events such that all pairs of events in it are @xmath4-connected .",
    "this ensures that subgraphs are connected both topologically and temporally .",
    "while this definition could already be used as a basis of temporal motifs , it suffers from the same shortcoming as its static cousin : in some simple cases the number of connected subgraphs explodes .",
    "for example an @xmath6-star where all events take place within @xmath4 contains @xmath7 connected temporal subgraphs with @xmath8 events , which would make the resulting motif statistics difficult to interpret in any intuitive fashion .    with static motifs",
    "the most common restriction is to require the subgraphs to be both connected and induced , i.e. require that they include all edges between the nodes in the subgraph .",
    "while this choice does reduce the number of subgraphs and makes it easier to interpret the resulting motifs , it unfortunately fails to solve the problem with the @xmath6-star above .    with temporal networks",
    "our choices are not as restricted .",
    "one alternative is to consider only those connected subgraphs where all @xmath4-connected events of each node are consecutive .",
    "this not only solves the problem with the @xmath6-star  we now get @xmath9 subgraphs with @xmath8 events  but also offers an intuitive interpretation : each subgraph takes into account all relevant events for each node within the time span covered for that node , in the sense that no events can be skipped .",
    "we call connected subgraphs that satisfy this requirement _ valid temporal subgraphs _ and denote them by @xmath10",
    ". figure [ fig : temporal_subgraphs_illustration ] illustrates the concept .     * ( a ) * an example event data set @xmath11 with six events .",
    "durations have been omitted for simplicity .",
    "with @xmath12 there are two maximal subgraphs , shown in * ( b ) * and * ( c)*. * ( d ) * valid subgraphs contained in the maximal subgraph in ( b ) .",
    "in addition to these the maximal subgraph itself and all unit subgraphs are valid subgraphs .",
    "the maximal subgraph in ( c ) does not contain other valid subgraphs than the maximal and unit subgraphs . *",
    "( e ) * event sets that are contained in ( b ) but are not valid subgraphs : the upper one because it is not @xmath4-connected , the lower one because it does not include all consecutive @xmath4-connected events of node @xmath13.,width=453 ]    _ temporal motifs _ are now defined as classes of isomorphic valid subgraphs , where the isomorphism is taken to include also the similarity of the temporal order of events .",
    "accordingly , two temporal subgraphs are isomorphic if they are topologically equivalent and the order of their events is identical . in cases where the requirement for the identity of the full order of events is too strict ,",
    "it can easily be weakened .",
    "this is discussed in section [ sec : generalizations ] .",
    "some special temporal motifs are worth mentioning .",
    "the unit set @xmath14 is trivially a valid subgraph for all events , and hence the smallest temporal motif contains only one event . for every event @xmath15",
    "there is a unique maximal subgraph @xmath16 that contains @xmath15 and in which all event pairs are still @xmath4-connected .",
    "the maximal subgraph is always also a valid subgraph .",
    "when motifs are based only on maximal subgraphs they are called _",
    "maximal motifs_.    the presented definition for temporal subgraph is meaningful only when each node is involved in at most one event at a time .",
    "when overlapping events are allowed , the large number of different situations that can arise in the most general case makes it more difficult to define temporal subgraphs in such a way that the results could still be easily interpreted . yet",
    "the prospects of such a definition are enticing , as it would allow for the exploration of almost any temporal network data , for example transportation networks @xcite and time - varying brain functional networks @xcite .",
    "because maximal subgraphs are temporally separated from all other events by at least time @xmath4 , all subgraphs are fully contained in some maximal subgraph . based on this observation the process of identifying all temporal motifs in a given event set @xmath11 can be separated to three parts :    1 .",
    "find all maximal connected subgraphs @xmath16 .",
    "2 .   find all valid subgraphs @xmath17 .",
    "3 .   identify the motif corresponding to @xmath10 .    to find the maximal subgraph where @xmath15 belongs to , we start from @xmath15 and iterate forward and backward in time to find all @xmath4-adjacent events ;",
    "this process is then repeated recursively with all new events encountered . assuming the @xmath4-adjacent events can be found in constant time , the time complexity of this step is @xmath18 . since the same maximal set is discovered starting from any event in it , the total time complexity of this part is @xmath19 .    for the second part ,",
    "consider an undirected graph @xmath20 where the vertices corresponds to events in @xmath16 and there is an edge between two vertices if those events are @xmath4-adjacent and consecutive for either node . now",
    "each valid subgraph contained in @xmath16 corresponds to some connected vertex set of @xmath20 ( see [ appendix : subgraphs ] for proof ) , and the problem of finding all valid temporal subgraphs reduces to identifying all induced subgraphs of @xmath20 and checking that the events of each node are consecutive .",
    "the algorithm for identifying valid subgraphs is given in [ appendix : subgraphs ] .",
    "identifying the motif for subgraph @xmath10 requires solving the isomorphism problem such that we also include information about the order of the events .",
    "we do this by mapping all relevant information into a directed and coloured graph as illustrated in figure [ fig : motif_mapping ] , for which the isomorphism can be readily solved with existing algorithms . in practice",
    "we calculate for this graph its _ canonical form _ , a labeling of vertices that is identical for all isomorphic graphs , so that we can easily tell if two valid subgraphs correspond to the same motif .",
    "finding the canonical form is a non - trivial task , but many efficient algorithms have been developed for this purpose ; the one we used is called _ bliss _ and described in @xcite .    as a final step , to make temporal motifs more accessible we convert the information about the order of events back into plain integers .",
    "figure [ fig : motif_mapping]e shows a concise presentation of the motif corresponding to the original temporal subgraph in figure [ fig : motif_mapping]a .",
    "illustration of the algorithm for identifying temporal motifs . * ( a ) * a valid subgraph @xmath10 with four events . *",
    "( b ) * a vertex is created for each event and edges are added to connect them to the corresponding nodes .",
    "colours are used to distinguish between the two types of vertices ; the labels of the event vertices are arbitrary . * ( c ) * directed edges are created between event vertices to denote their order : from the first event ( @xmath21 ) to the second ( @xmath22 ) , from the second to the third ( @xmath23 ) and from the third to the fourth ( @xmath24 ) .",
    "when durations are included we use the order of the starting times . a canonical labeling",
    "is then calculated for this graph ; all temporal subgraphs with that are isomorphic at this stage will yield the same canonical labeling . *",
    "( d ) * a concise presentation for the temporal motif .",
    "the numbers next to edges denote the order of the events .",
    "note that the numbers are always on the side of the arrow heads.,width=529 ]",
    "* ( a ) * two valid subgraphs that differ only in the mutual order of events @xmath25 and @xmath26 . *",
    "( b ) * if the events are mobile phone calls , the possible flow of information ( red arrows ) is identical in the two subgraphs .",
    "the mutual order of @xmath25 and @xmath26 is irrelevant . *",
    "( c ) * the temporal flow motif corresponding to both event sets in ( a ) where the only requirement is that @xmath27 takes place before the other two events . * ( d ) * compact notation for the temporal motif in ( c ) .",
    "as described in the text , with this notation @xmath28 and @xmath29 , but the order of @xmath30 and @xmath31 is undefined.,scaledwidth=95.0% ]    assuming that the node colours are denoted by integers  as is often the case  we could have used the colours to mark the order of events in figure [ fig : motif_mapping]c instead of putting in additional links .",
    "the edge notation , however , has another benefit : it can be used to denote a _ partial order _ of events .",
    "unlike _ total order _ , partial order does not necessarily define the order of all pairs . for example , an order where @xmath15 takes place before both @xmath32 and @xmath33 , but the mutual order of @xmath32 and @xmath33 remains undefined , is a partial order and as such can not be represented with integer labels .    to see why this is useful , consider mobile phone communication where information flows both ways",
    " both can talk regardless of who placed the call  and the two temporal subgraphs in figure [ fig : journeys_motivation]a that differ only in the order of the last two events .",
    "if we are only interested in the flow of information , the two subgraphs are identical because they allow the same flows , shown in figure [ fig : journeys_motivation]b .",
    "in general such flows are known as _ time - respecting paths _ or _ journeys _ @xcite : a sequence of events @xmath34 such that consecutive events are adjacent and @xmath35 @xmath36 .    in a _ flow motif _",
    "the order of two events is restricted if and only if it is relevant to the flow pattern in the subgraphs , that is , only when reversing the mutual order of two events would either create a new journey or remove an existing one . because journeys must progress via adjacent events",
    "it is enough to place restrictions on the order of adjacent events ; all longer journeys will be automatically included . if the flow is undirected , such as information flow during phone calls , preserving journeys ( and not making new ones ) corresponds to restricting the order of all adjacent events as shown in figure [ fig : journeys_motivation]c . in the case of directed flow",
    "we would only restrict the order of events that meet head - to - tail ; no flow is possible if the events meet either head - to - head or tail - to - tail .",
    "if the events have a partial order we can of course no longer use integers to denote this order as was done in figure [ fig : motif_mapping]d .",
    "arbitrary sets could be used to represent partial orders by defining @xmath37 , but they would render the most common simple motifs unnecessarily complicated .",
    "we propose a notation that uses sets when necessary but falls back to plain integers when possible .",
    "we label events with pair @xmath38 where @xmath39 and @xmath40 is a set , and define order relation as @xmath41 by choosing @xmath42 whenever possible the notation reduces to a comparison of integers because in this case @xmath43 . to make the notation more compact we write @xmath44 as ` @xmath45 ' or simply ` @xmath46 ' if @xmath47 .",
    "for example in figure [ fig : journeys_motivation]d the label ` @xmath48 ' corresponds to @xmath49 and ` @xmath30 ' to @xmath50 . in [ appendix",
    ": labels ] we present an algorithm for finding such labels for any partial order of events .",
    "the standard interpretation of a static motif count , i.e. the number of subgraphs in the motif , is presented in terms of a null model @xcite .",
    "the null model is usually a conditionally randomized version of the empirical network , e.g. a configuration model with the same degree sequence as the empirical network .",
    "if for some motif the count significantly exceeds that of the null model , the hypothesis ( i.e. , lack of correlations reflected in the motif ) is rejected and the motifs are considered to be structurally significant .",
    "however , as pointed out in @xcite , the proper choice of the null model is non - trivial .",
    "if the null model is far from having any realistic features , then it is no wonder that it is rejected but this plain fact does not tell anything about the nature of the correlations . the standard z - score analysis compares the difference of the empirical motif count and the average value from the null model to the variance of the latter .",
    "this gaussian assumption about the null model has no a priori justification .",
    "this problem is even more severe for temporal motifs . here",
    "the most obvious randomized reference is time - shuffling @xcite : given a random permutation @xmath51 of events we count the occurrence of motifs in time - shuffled data set where event @xmath15 occurs at time @xmath52 .",
    "unlike in the time - shuffled reference , in most complex systems temporal distributions are far from poissonian and contain strong temporal correlations @xcite .",
    "the situation is improved if we use parametrized null models , where in some limit the empirical situation is restored .",
    "then we can hope that by monitoring the parameter dependence of the deviations from the null model we can learn about the nature of the correlations .",
    "another intuitive choice is to compare the occurrence of motifs to a time - reversed reference @xcite .",
    "since causality depends on the direction of time but correlation does not , this comparison should highlight motifs whose occurrence at least partially results from causality . on the other hand ,",
    "if a motif is abundant only because of correlations , it should be equally common in both the data and the time - reversed reference . note that it is not necessary to explicitly construct the time - reversed reference :",
    "the occurrence of a motif in the time - reversed data is equal to the occurrence of a time - reversed motif in the actual data .    considering the problems with null models",
    ", it seems to be important to compare parts of the data with _",
    "itself_. if there are different types of nodes and events , we can study whether the occurrence of temporal motifs differs between them .",
    "also , we can always study the occurrence of motifs at different times . in this way we would gain information about the relative weights of the motifs without any reference to arbitrary null models .    when analyzing motif counts we need to take into account that they are trivially correlated with average activity and correlations of adjacent events .",
    "to get more insight into the occurrence patterns of temporal motifs we suggest looking at the relative occurrence of different motifs .",
    "suppose that we have two sequences of motif counts  for example the counts of all 3-event temporal motifs in the empirical data and the reference  and the relative frequencies of the @xmath53 motif are @xmath54 and @xmath55 .",
    "the symmetrized kullback - leibler divergence measures the relative entropy of these two distributions and is defined as @xmath56 provided that @xmath57 and @xmath58 @xmath59 ( we exclude motifs that are not present in either ) .",
    "the kullback - leibler divergence places more weight on common motifs , and even large relative differences in the rarest motifs do not change the value too much .",
    "kendalls @xmath60 , on the other hand , measures the similarity of the ordered sequences and places an equal weight on all the motifs regardless of their count . given two motif sequences of length @xmath6 , both sorted by count , kendalls @xmath60 is defined as @xmath61 where @xmath62 is the number of motif pairs that are in the same order in both sequences and @xmath63 the number of motif pairs in different order .",
    "the value @xmath64 is reached when the two sequences are identical , and @xmath65 when they are in opposite order .",
    "we use temporal motifs to study the short time - scale structure of mobile phone calls of a single european mobile phone operator .",
    "the data covers a period of 120 days , but we exclude motifs that occur entirely on the first or the last day of this period to remove possible bias caused by the limits of the data .",
    "the remaining data contains @xmath66 million mobile phone calls between nearly @xmath67 million customers .",
    "the data has been mutualized by removing all events on unidirectional edges , i.e. we require that the communication is reciprocated on each edge .",
    "the time window is @xmath68 except in figure [ fig : maximal_motif_distributions ] where other time windows are explored . with @xmath68 , 35 % of events are @xmath4-adjacent to at least one other event and hence non - trivial temporal motifs are not all that rare .",
    "all results with time - shuffled references have been averaged over 5 independent runs .     the four most common ( on left ) and least common ( on right ) motifs in * ( a ) * the empirical data , * ( b ) * unbiased time - shuffled reference and * ( c ) * the biased reference with bias strength @xmath69 .",
    "the values below each motif denote the total count and , in parenthesis , the fraction out of all motifs with three events.,title=\"fig:\",width=604 ] +    the four most common ( on left ) and least common ( on right ) motifs in * ( a ) * the empirical data , * ( b ) * unbiased time - shuffled reference and * ( c ) * the biased reference with bias strength @xmath69 . the values below each motif denote the total count and , in parenthesis , the fraction out of all motifs with three events.,title=\"fig:\",width=604 ] +    the four most common ( on left ) and least common ( on right ) motifs in * ( a ) * the empirical data , * ( b ) * unbiased time - shuffled reference and * ( c ) * the biased reference with bias strength @xmath69 .",
    "the values below each motif denote the total count and , in parenthesis , the fraction out of all motifs with three events.,title=\"fig:\",width=604 ]    figure [ fig : most_and_least_common_motifs]a shows the four most and least common 3-event temporal motifs ( there are 68 3-event motifs in total ) in the data , and figure [ fig : most_and_least_common_motifs]b the same in the time - shuffled reference . unsurprisingly , the number of non - trivial motifs in the reference is lower  only 8.6 % of events are @xmath4-adjacent to some other event  but the two cases still appear qualitatively similar .",
    "the most common motifs illustrate the bursty nature of the mobile phone data , while the least common motifs are triangles even though triangles are often considered to be the building blocks of social networks .",
    "the distribution of different motifs is more balanced in the reference : in the empirical data the most common 3-event motif makes up 27 % of all 3-event motifs , but only 6.3 % in the time - shuffled reference .    to make the comparison more interesting",
    ", we add a bias to the time - shuffling that favors shorter inter - event times and therefore increases the number of motifs .",
    "the shuffling is done using markov chain monte carlo sampling , which is also necessary to enforce the condition that each user is involved in at most one event at a time . in the unbiased case",
    "each step consists of selecting two events uniformly at random , @xmath15 and @xmath32 , and switching their times if this does not result in overlapping events for any of the ( at most ) four nodes involved . to create a single randomized reference",
    "we make @xmath70 such switches , which equals on average 10 switches per event .    to introduce a bias , instead of picking only two events at each step we randomly select one target event @xmath15 and @xmath71 candidates , @xmath72 , and then make a switch with the candidate that places @xmath15 closest to its new adjacent events .",
    "to measure this closeness we use the geometric average of time differences to the temporally closest adjacent events .",
    "the parameter @xmath73 controls the bias strength : the more candidates there are , the more likely it is to find one close to @xmath15 .",
    "setting @xmath74 gives the normal unbiased randomization .",
    "figure [ fig : most_and_least_common_motifs]c shows the most and least common motifs in the biased reference with @xmath69 .",
    "this reference naturally has higher motif counts than the unbiased reference , but the total number of 3-event motifs is still only 60 % of that of the empirical data . perhaps surprisingly , the least common motif is now twice as common as in the empirical data . in the empirical data",
    "this motif is uncommon partly because the events take place in a non - causal order , whereas the order has little significance in the reference .",
    "furthermore , because this kind of subgraph takes place primarily due to correlations , it is likely that the nodes have other events at approximately the same time .",
    "if these events take place between those in the triangle , the subgraph would no longer be valid ( see lower subgraph in figure [ fig : temporal_subgraphs_illustration]e ) . in the references the maximal subgraphs are smaller , which makes it less likely that such interfering events would destroy the validity .",
    "the bias makes triangles more common while keeping the maximal subgraphs small , and therefore the triangles are more often valid .    as a further example clarifying this point , we present in figure [ fig : triangle_motifs ] all motifs based on the different directed triangles with 3 events .",
    "the six motifs in figure [ fig : triangle_motifs]a would by equally common in the time - shuffled reference , but in the empirical data we observe a 4-fold difference between the most and least common triangle .",
    "there are two factors that explain this : _ burstiness _ and",
    "_ causality_. burstiness appears in the fact that in the four most common motifs the two calls made by @xmath75 are consecutive ; in the two least common motifs they are not .",
    "causality is most apparent when comparing the most and the least common motif . in the most common motif",
    "the caller of the second call ( c ) knows about the first call ( because he made it himself ) , and the caller of the third call ( b ) could know about both previous calls . in the least common motif",
    "the caller of the second call ( b ) can not know about the first one , and the caller of the third call ( c ) can not know about the call made by b. the most common motif is both bursty and causal , while the least common is neither .",
    "causality is an obvious explanation also for the counts in figure [ fig : triangle_motifs]b : the triangle where events could cause one another is three times as common as the other one .",
    "note that these two motifs are time - reversals of each other , i.e. if the time were reversed , each motif of the first kind would turn into the second , and vice versa .",
    "number of maximal motifs of different size when the size is measured by * ( a ) * the number of nodes and * ( b ) * the number of events in the motif . in both plots",
    "the values larger than 10 have been binned with logarithmic bins using factor @xmath76 . *",
    "( c ) * fraction of events in motifs of a given size , and * ( d ) * the corresponding cumulative distribution . in all plots",
    "the solid lines correspond to empirical data , dotted lines to the unbiased time - shuffled reference.,title=\"fig:\",width=453 ]    number of maximal motifs of different size when the size is measured by * ( a ) * the number of nodes and * ( b ) * the number of events in the motif . in both plots",
    "the values larger than 10 have been binned with logarithmic bins using factor @xmath76 . *",
    "( c ) * fraction of events in motifs of a given size , and * ( d ) * the corresponding cumulative distribution . in all plots",
    "the solid lines correspond to empirical data , dotted lines to the unbiased time - shuffled reference.,title=\"fig:\",width=453 ]    figures [ fig : maximal_motif_distributions]a  b show the number of maximal motifs of different size for different values of @xmath4 , measured either by the number of nodes or by the number of events in the motifs .",
    "the distributions are broad for all time windows , and those with larger @xmath4 are naturally broader .",
    "figures [ fig : maximal_motif_distributions]c  d show the fraction of events in maximal motifs of different size . comparing the distributions with @xmath77 and",
    "@xmath78 suggests that between these values a giant temporal component is beginning to form .",
    "the distribution with @xmath77 is very close to a power - law , as both the density and cumulative distributions are straight lines . when @xmath79 the number of events contained in very large maximal motifs is starting to grow .",
    "increasing the time window further beyond @xmath80 would at some point give birth to a giant temporal component : a large fraction of events would become @xmath4-connected .",
    "* ( a ) * the ratio of total number of motifs with a given number of events in the actual data versus the time - shuffled reference .",
    "the lines correspond to motifs with 2 , 3 and 4 events , from bottom to top . *",
    "( b ) * the symmetric kullback - leibler divergence between motifs in the actual data and the time - shuffled reference . * ( c ) * kendall s @xmath60 between motifs in the actual data and the time - shuffled reference .",
    "the motif counts of the references are averages of 5 different runs for each value of the bias strength.,width=529 ]    finally , figure [ fig : bias_results]a shows that if we only look at the number of motifs , the biased references seem to approach the actual data as we increase the bias strength .",
    "similar behaviour is seen in figure [ fig : bias_results]b for the symmetrized kl divergence calculated between the actual data and the reference , and also for kendalls @xmath60 in figure [ fig : bias_results]c .",
    "however , in figure [ fig : most_and_least_common_motifs ] we saw that with @xmath69 there are already motifs that are more common in the reference than in the real data ; it is therefore not possible that the reference becomes identical to the data when the total number of motifs become equal .",
    "in addition , motifs with more events are relatively more common in the empirical data regardless of the bias .",
    "a qualitative difference between motif sequences remains even if we were able to match the total number of motifs .",
    "in this paper we have introduced the concept of temporal motifs , and provide a mapping between temporal subgraphs and colored directed graphs that allows an efficient algorithm for their identification . using this algorithm we can locate and make statistics about the main mesoscopic building blocks of temporal networks , which will carry great importance for understanding their functions and underlying mechanisms .",
    "while the focus of this article is more on technical definitions , algorithms , and general aspects of the evaluation of motif counts , we have also presented some results on a huge temporal network based on mobile phone call data .",
    "some conclusions can already be drawn .",
    "of all temporal motifs with three events , the most common ones involve only two nodes .",
    "this is in accord with the independent finding that burstiness in human communication is mostly a link property @xcite .",
    "another interesting  though not surprising ",
    "result is that the motifs which allow causal interpretations are more common .",
    "the fat - tailed distributions of maximal motifs are in agreement with observations about the correlations in the network @xcite , although our present approach gives a more detailed insight about the mechanisms .",
    "our initial results also show that the temporal motifs are common enough to have an impact on dynamics and too complex to be explained by simple temporal correlations .",
    "the occurrence of motifs is intuitively sensible , as they highlight two universal properties of human communication , namely burstiness and causality .",
    "there are a number of directions to pursuit in the future .",
    "for example here we have ignored the case where nodes can have simultaneously multiple events .",
    "this generalization presents a challenge both in defining the valid subgraphs and in developing the algorithms for their identification .",
    "further research is also needed to develop measures for analyzing the occurrence patterns of motifs .",
    "the presented examples are far from being able to illustrate the full richness of phenomena that can be explored with temporal motifs .",
    "currently we are in the course of investigating several temporal networks and hope that it this approach will be useful in a broad range of studies , even more so as the presented algorithm is able to handle large networks . as empirical temporal networks are becoming more and more common",
    ", we expect temporal motifs and their analysis to prove useful in many different fields of science .",
    "the project ictecollective acknowledges the financial support of the future and emerging technologies ( fet ) programme within the seventh framework programme for research of the european commission , under fet - open grant number : 238597 .",
    "we acknowledge support by the academy of finland , the finnish centre of excellence program 20062011 , project no .",
    "jk is supported by the finland distinguished professor ( fidipro ) program of tekes .",
    "we would like to thank renaud lambiotte for his comments and albert - lszl barabsi of northeastern university for providing access to the unique mobile phone data set .",
    "the following result is used in section [ sec : identification ] to find temporal subgraphs inside maximal temporal subgraphs :    let @xmath81 be an undirected graph that has a vertex for each event in @xmath82 and every vertex is connected to the next and previous @xmath4-adjacent event of both nodes in that event ( there are at most four such events ) . then every valid subgraph contained in @xmath82 corresponds to a connected subgraph of @xmath81 .    consider a valid subgraph @xmath83 and the corresponding vertex set in @xmath20 . because all event pairs in @xmath10 are @xmath4-connected and the events of every node are consecutive",
    ", there is at least one path between all vertex pairs in this set .",
    "therefore there is at least one connected subgraph of @xmath20 that corresponds to @xmath10 .     *",
    "( a ) * an example of a maximal subgraph @xmath82 with @xmath12 and * ( b ) * the corresponding undirected graph @xmath81 used to identify all valid subgraphs contained in @xmath82 . * ( c ) * a connected subgraph of @xmath20 and * ( d ) * the corresponding temporal subgraph that is not a valid subgraph because the events of node @xmath13 are not consecutive : @xmath25 takes place between @xmath27 and @xmath26 and is @xmath4-connected to them , so it should be included.,width=529 ]    note that the inverse is not true : there are connected subgraphs of @xmath20 whose vertex sets do not correspond to any valid subgraph ; an example is given in figure [ fig : connected_subgraphs ] . therefore to identify all valid subgraphs @xmath83 we first need to find all distinct connected subgraphs of @xmath20 and then ensure that the corresponding subgraphs are valid by checking that for every node the events ( that are in @xmath82 and hence @xmath4-connected ) are consecutive .",
    "this check can be carried out with little extra cost while constructing the colored graph needed to calculate the canonical form , as the construction requires going through all events anyway .    a pseudo - code to identify all connected vertex sets of an arbitrary graph ( in this case @xmath81 ) is given in algorithm [ alg : identify_subgraphs ] . in function findconnectedsets",
    "we first start @xmath84 search trees so that the tree initialized with node @xmath85 will find all connected sets where @xmath85 is the smallest node .",
    "the nodes in the set @xmath86 are excluded from that search tree ; initially this set contains all nodes smaller than @xmath85 .",
    "the set @xmath87 includes nodes where the search can progress , initially all neighbours larger than @xmath85 . because each search tree finds only sets where @xmath85 is the smallest node , the trees are necessarily distinct .",
    "the function subfind first adds the current set to be returned ( line 10 ) and then grows the sets recursively . for each node @xmath88 , @xmath86 is updated by excluding nodes smaller than @xmath85 .",
    "thus each subtree has a different smallest node from those in @xmath87 and the subtrees are again distinct .",
    "the set @xmath87 is updated to contain nodes where the search can progress : previously allowed nodes larger than @xmath85 and those new neighbours of @xmath85 that are not yet excluded .",
    "@xmath89 is an undirected graph .",
    "@xmath90 @xmath91 @xmath92 @xmath93 @xmath94 @xmath95 @xmath96 @xmath97    because the subtrees are distinct at each step , the algorithm will return each connected set at most once . to see that it returns all possible connected set , consider how we could arrive at an arbitrary connected set @xmath98 .",
    "the search path is rooted at @xmath99 .",
    "let @xmath100 , @xmath101 , be the set of elements added at depth @xmath8 . because @xmath98 is connected , there is at least one node in @xmath102 that is a neighbour of some node in @xmath100 .",
    "the only way the construction can fail is if for some @xmath8 there is a node @xmath103 that has already been excluded , i.e. it is in @xmath86 .",
    "it is not possible that @xmath104 was excluded in the beginning ",
    "the tree was rooted at @xmath105 and only nodes smaller than @xmath106 were excluded ",
    "so it must have happened during the search .",
    "but if @xmath104 was added to @xmath86 it means that it was in @xmath87 but some larger node of @xmath98 was added instead , which is a contradiction  in the subtree leading to @xmath98 we would have added @xmath104 .",
    "hence no node @xmath104 can exist and the construction can always proceed until @xmath98 is obtained .",
    "pseudo - code for finding the labels is presented in algorithm [ alg : label_nodes ] . on lines",
    "28 we first initialize all labels to @xmath49 , unless there are multiple roots which get each initialized with a unique element . the loop on lines 919 then iteratively pushes the labels forward along directed paths , adding new elements when needed : first pick any node with zero in - degree ( line 10 ) , and find its children who can not be reached through other children ( @xmath107 ) ( lines 1113 ) .",
    "the labels of these children are then updated by incrementing the value of @xmath46 and pushing the set @xmath108 down to the child ( line 1415 ) , adding a new unique element to each set if there are multiple children to update ( lines 1618 ) .",
    "@xmath89 is a directed acyclic graph .",
    "@xmath109 is the set of nodes from which there is a directed path to @xmath110 .",
    "@xmath111 @xmath112 @xmath113 ,",
    "@xmath114 @xmath115 @xmath116 pick any node @xmath15 with @xmath117 in @xmath20 @xmath118 @xmath119 @xmath120 @xmath121 @xmath122 @xmath116 remove @xmath15 from @xmath89    it is easy to see that this algorithm results in valid labels :    * if event @xmath15 must come before @xmath32 then there is ( at least one ) directed path from @xmath15 to @xmath32 . the set @xmath108",
    "will be pushed along this path and therefore @xmath123 , and the value @xmath46 will increase along this path and therefore @xmath124 .",
    "* if there is no restriction for the mutual order of @xmath15 and @xmath32 , there is no directed path between these nodes .",
    "we can trace backwards all paths from these nodes to find that either 1 .",
    "the paths traced from @xmath15 and from @xmath32 end up in distinct root nodes and hence @xmath125 because each root was initialized with a different element , 2 .",
    "the paths converge to a common node that hence has multiple children and the two branches were assigned unique elements of @xmath126 , and therefore @xmath127 and @xmath128 , or 3 .   both of the above ( there can be multiple directed paths leading to these nodes ) , which also means that @xmath127 and @xmath129 .",
    "the labels this algorithm provides are plain integers when the input graph @xmath20 contains a total order of events .",
    "10                                                                junttila t and kaski p ( 2007 ) d applegate , g s brodal , d panario and r  sedgewick ( eds ) _ proceedings of the ninth workshop on algorithm engineering and experiments and the fourth workshop on analytic algorithms and combinatorics _",
    "p 135 ( siam )"
  ],
  "abstract_text": [
    "<S> temporal networks are commonly used to represent systems where connections between elements are active only for restricted periods of time , such as networks of telecommunication , neural signal processing , biochemical reactions and human social interactions . </S>",
    "<S> we introduce the framework of _ temporal motifs _ to study the mesoscale topological - temporal structure of temporal networks in which the events of nodes do not overlap in time . </S>",
    "<S> temporal motifs are classes of similar event sequences , where the similarity refers not only to topology but also to the temporal order of the events . </S>",
    "<S> we provide a mapping from event sequences to colored directed graphs that enables an efficient algorithm for identifying temporal motifs . </S>",
    "<S> we discuss some aspects of temporal motifs , including causality and null models , and present basic statistics of temporal motifs in a large mobile call network . </S>"
  ]
}