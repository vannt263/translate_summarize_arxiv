{
  "article_text": [
    "_ program title : _ mqsvis    _ catalogue identifier : _ ` aemr_v1_0 `    _ program summary url : _",
    "http://cpc.cs.qub.ac.uk/summaries/aemr_v1_0.html    _ program obtainable from : _ cpc program library , queen s university , belfast , n. ireland    _ licensing provisions : _ standard cpc licence , http://cpc.cs.qub.ac.uk/licence/licence.html    _ no .",
    "of lines in distributed program , including test data , etc . : _",
    "1643    _ no . of bytes in distributed program , including test data , etc .",
    "13212    _ distribution format : _",
    "tar.gz    _ programming language : _ c with openmp extensions ( main numerical program ) , python ( helper scripts )    _ computer : _ modern pc ( tested on amd and intel processors ) , hp bl2x220    _ operating system : _ unix / linux    _ has the code been vectorized or parallelized ?",
    ": _ yes ( openmp )    _ ram : _ 200 mb for single run for @xmath0 tile    _ running time : _ 1 - 2h for @xmath0 tile , depending on the values of parameters    _ classification : _ 4.15 , 18    _ nature of problem : _ recently macroscopically populated quantum superpositions for light , generated by optimal quantum cloner , were demonstrated .",
    "they are of fundamental and technological interest .",
    "their properties are governed by gaussian hypergeometric function @xmath1 of half - integer parameters , which can not be reduced to neither elementary nor easily tractable functions .",
    "computation of photon number distribution , visibility and mean number of photons , necessary for characterization of these states , requires evaluation of infinite sums involving this function performed over its parameters .",
    "_ solution method : _ mqsvis program suite computes various quantum indicators , such as photon number distribution , visibility , mean number of photons , variance for macroscopic quantum superpositions of light .",
    "it takes losses ( modeled with a beamsplitter ) and imperfect photodetection ( modeled with a weierstrass transform applied to the photon number distribution ) into account .",
    "cutoffs of the infinite hypegeometric sums are estimated dynamically , and precision is enhanced with computation of expressions in logarithmic form . depending on the experimental parameters , program chooses one of the several ways of summation to achieve the best efficiency .",
    "program is parallelized using openmp standard , which ensures best utilization of multicore processors , and splits the work into tiles computed with different nodes of a computer cluster .",
    "this allows to compute the required indicators for realistic values of the parameters .",
    "macroscopic quantum superposition ( mqs ) and entanglement were pointed out by e. schrdinger in 1935 .",
    "he posed a _ gedanken experiment _ where the quantum formalism was applied to a macroscopic object  a cat and a microscopic object  a two - level radioactive atom , describing them in a joint quantum superposition @xcite .",
    "these objects were closed in a box and if the atom decayed at a random time , additional mechanism installed inside was activated to kill the cat .",
    "the conclusion was striking : the cat was dead and alive at the same time , as long as no one opened the box .",
    "it revealed the phenomenon of quantum entanglement : the state of the cat is random ( dead or alive ) but perfectly correlated with the state of the atom ( decayed or not ) .",
    "it also planted a question to what extent macroscopic objects obey laws of quantum mechanics .",
    "small mqs were produced in : nanoscale magnets , laser - cooled trapped ions , photons in a microwave cavity , @xmath2 molecules , superconducting devices @xcite and macroscopic - size diamonds cooled @xcite and in room temperature ( 2011 ) @xcite . in 2007 ,",
    "macroscopically populated polarization entangled superpositions of light were generated in the room conditions by optimal quantum cloning ( oqc ) .",
    "it is based on parametric frequency down conversion ( pdc ) @xcite where a higher energetic blue photon in a given polarization is turned , with some probability , into two lower energetic red photons by a nonlinear crystal preserving the polarization .",
    "the more the crystal is pumped with the blue photon beam , the higher the probability of conversion , resulting in multi - photon output .",
    "oqc does not violate the no - cloning theorem @xcite , which states that an unknown quantum state ( here : polarization ) can not be copied perfectly .",
    "it makes imperfect copies , characterized by a cloning fidelity lower than one @xcite .",
    "there are two kinds of mqs of light produced by oqc : the micro - macro singlet state , where a single photon is entangled with a `` macroscopic qubit '' , and the bright entangled squeezed vacuum @xcite .",
    "they contain @xmath3-@xmath4 photons .",
    "mqs are promising alternative for quantum technologies .",
    "they allow exploring the quantum - to - classical transition @xcite , efficient interaction with matter and photons @xcite , studying the principle of quantum measurement and form a non - gaussian class of quantum states , necessary for fault tolerant quantum computing @xcite .",
    "importantly , they give hope for a loophole - free bell inequality test @xcite enabling the ultimate test of the quantum theory .",
    "theoretical and experimental analysis of mqs is challenging due to their large complexity and fast decoherence @xcite , both scaling exponentially with hilbert space dimension .",
    "commercial numerical tools ( matlab , wolfram mathematica ) and libraries ( blas , netlib , lapack ) model mqs only for small populations .",
    "intuitions based on these results are often misleading for high populations @xcite . here , slowly convergent multiple infinite hypergeometric series arises , which is intractable for these applications .",
    "this results in lack of commonly accepted model of mqs .    in this paper",
    ", we develop numerical model for mqs of light and discuss the method of efficient computation of gaussian hypergeometric function for half - integer values of its parameters and moderate value of the argument .",
    "we show how to dynamically estimate a cutoff for infinite sums involving this function performed over its parameters .",
    "our algorithm offers precision exceeding double precision by several orders of magnitude . depending on the experimental parameters it chooses one of the several ways of summation to achieve the best efficiency .",
    "it is parallelizable , which allows better utilization of multi - processor computers .",
    "we tested our numerical results with recently developed analytical model for mqs for certain regimes of parameter values @xcite .",
    "the numerical methods presented here can be adjusted for analysis of similar experimental schemes .",
    "this paper is organized as follows . in section  [ macro ]",
    "we introduce mqs , their properties and show the origins of hypergeometric function . in section  [ sec : numerical_methods ]",
    "we discuss methods used in numerical model of mqs .",
    "section  [ sec : examples ] includes examples : computation of mqs photon number distribution and distinguishability .",
    "in our analysis , we focus on the micro - macro singlet state , but our results can be generalized for the bright squeezed vacuum . the singlet is produced by phase covariant optimal quantum cloner @xcite .",
    "this method requires first a pair of linearly polarized photons created in a usual state through parametric frequency down conversion ( pdc ) @xmath5 .",
    "subscripts @xmath6 and @xmath7 denote two spatial modes and @xmath8 and @xmath9 denote horizontal and vertical polarization , see fig .",
    "[ fig : cloner]a .",
    "the equatorial states of the poincar sphere of all polarization states , see fig .",
    "[ fig : cloner]b , are given by the following transformation of the linear polarization @xmath10 , @xmath11 , where @xmath12 and @xmath13 are creators for two orthogonal polarizations @xmath14 and @xmath15 .",
    "this subspace , parametrized by the polar angle @xmath16 , is privileged for the phase covariant cloner .",
    "here , its hamiltonian reads @xmath17 and shows that all equatorial states are cloned equally well ( the form of @xmath8 is the same for all @xmath14 ) .",
    "due to rotational invariance of the singlet , it can be expressed in this basis @xmath18 .",
    "next , one of its spatial modes , e.g.  b , is amplified by the cloner to create a multi - photon state @xmath19 or @xmath20 .",
    "this unitary evolution leads to the micro - macro singlet @xmath21 the multi - photon states are infinite superposition of photon number states @xmath22 with the real - valued probability amplitude @xmath23 where @xmath24 .",
    "here , @xmath25 is amplification gain , @xmath26 , @xmath27 .",
    "the notation @xmath28 denotes @xmath29 photons in polarization @xmath14 and @xmath30 in @xmath15 , which contribute to the superposition @xmath31 with probability @xmath32 .",
    "[ fig : setup1 ] depicts @xmath33 and @xmath34 for @xmath35 and reveals slow decay of @xmath36 in infinity .",
    "convergence of @xmath37 and @xmath38 to zero is slower for higher gain .",
    "( solid line , left y axis ) and @xmath39 ( dashed line , right y axis ) computed for gain @xmath35.,height=113 ]    -7 mm    the states @xmath40 and @xmath31 are orthogonal due to different occupation parity in polarizations and are called macroscopic qubit . in experiment",
    "they contained @xmath41 photons on average , where @xmath42 .",
    "however , in this regime detection is not single photon resolving and they reveal effective overlap .",
    "their distinguishability is efficiently quantified by photon number distributions @xmath43 and @xmath44 giving probability of having @xmath45 photons in polarization @xmath14 and @xmath46 in @xmath15 simultaneously @xmath47 where @xmath48 .",
    "distinguishability equals @xmath49      partial indistinguishability of @xmath40 and @xmath31 is a drawback to any quantum protocol and bell inequality test , and needs to be fixed by special quantum state engineering . in @xcite",
    "a filtering method was suggested to increase distinguishability of macro - qubit .",
    "it is described by the projective measurement @xmath50 it cuts off the low photon number contributions below a threshold @xmath51 in the initial superposition so that the preselected macro - states contain @xmath51 photons at least distributed over two polarization modes",
    ". we will call this operation the theoretical preselection .",
    "photon number distributions for mqs subjected to theoretical preselection read @xmath52 @xmath53 @xmath54 , normalization constant @xmath55 .    for large class of useful observables , mean values evaluated for preselected multi - photon states will involve sums of the form @xmath56 , where @xmath57 is a polynomial .",
    "for example , for mean number of photons one sets @xmath58 and @xmath59 for its variance .    in the experiment , theoretical preselection",
    "is implemented by a weak measurement .",
    "the state is split into two beams , reflected and transmitted , by a beam splitter ( bs ) with high transmitivity .",
    "quantum operation @xmath60 is performed only on the reflected part and the result is feedforwarded to the transmitted beam ( i.e.  the summation constraint on occupations is shifted from reflected to transmitted part ) .",
    "this is the beam - splitter preselection .",
    "action of a bs with reflectivity @xmath61 ( transmitivity @xmath62 ) on two orthogonal polarizations @xmath14 and",
    "@xmath63 is independent . for a given polarization ,",
    "if one bs input is vacuum @xmath64 and the other is photon number state @xmath65 , its action is given by @xmath66 with the probability amplitude @xmath67 , where @xmath68 ( @xmath69 ) denotes mode where @xmath70 ( @xmath45 ) photons were transmitted ( reflected ) .",
    "for the multi - photon states we get @xmath71 and similar expression for @xmath72 .",
    "the coefficients may be grouped as follows @xmath73 .",
    "evaluation of any physical quantity will lead to the following subexpressions @xmath74 and @xmath75 , where @xmath76 are non - negative integers . for the beam - splitter preselection photon number distributions",
    "read @xmath77 with @xmath78 , where normalization constant @xmath79 and @xmath80 is a kronecker delta function equal 1 if @xmath81 and 0 else . here , important mean values are computed by @xmath82 .",
    "beam splitter is useful for many other basic quantum operations , e.g.  losses , homodyne detection , inefficient detection , entanglement distillation .",
    "we notice that the ratios @xmath83 and @xmath84 are rational functions of @xmath85 and @xmath85 and @xmath86 , respectively . according to the definition of a hypergeometric term @xcite , @xmath32 , @xmath87 ,",
    "@xmath88 are double hypergeometric terms and their infinite sums over these parameters are hypergeometric functions .",
    "the sum of the probability governing mqs is given by gaussian hypergeometric function @xmath89 where @xmath90 , @xmath91 , @xmath92 , @xmath93 , @xmath94 .",
    "the situation is similar for the probability governing the mqs after passing bs . here , the sums @xmath95 and @xmath96 , where @xmath97 is the floor function @xmath98 , have to be written for odd and even @xmath86 and @xmath99 separately @xmath100 we checked that no closed form of @xmath101 , @xmath102 , @xmath103 and @xmath104 exist using the gosper s , zeilberger s , and petkovek s algorithms @xcite .",
    "these algorithms constitute the standard mathematical tools for hypergeometric series analysis .",
    "closed form , if existed , would eliminate sums over @xmath85 and @xmath105 completely and reduce the computation time .    in our case",
    ", these sums have to be computed iteratively .",
    "this prevents efficient simulation of mqs properties and evolution for realistic parameters , since it is neither possible to bring this function to elementary ones nor to other special functions ( e.g.  bessels ) tractable more easily .",
    "the function @xmath1 arises directly form probability governing the mqs @xmath32 .",
    "parameters @xmath6 and @xmath7 of @xmath1 are half integers .",
    "this class of gaussian hypergeometric functions is the least known in the literature .",
    "there are only a few known identities simplifying @xmath1 with half - integer parameters @xcite , but they can not be used here .",
    "moreover , recurrence transformations lead to other half - integer forms of @xmath1 . unconditional convergence of the hypergeometric sum is guaranteed by @xmath106 .",
    "it is difficult to find the appropriate cutoffs for the sums over @xmath85 and @xmath105 .",
    "high cutoffs make the computation long and error prone whereas too low values result in omitting significant terms .",
    "the fast computation of @xmath1 in a non - asymptotic regime of its arguments and parameters is challenging @xcite . in literature , there are algorithms applicable for some special cases of relations between its parameters @xcite , but not useful here .",
    "moreover , in our intermediate regime they become unstable .",
    "neither gaussian quadrature @xcite nor pad @xcite approximations exist .    to be able to compute eq .",
    "( [ eq : qbs1 ] ) and similar ones of the form @xmath107 we aim at partial factorization with respect to @xmath108 and @xmath109 to compute the sums over @xmath85 and @xmath105 separately .",
    "full factorization can not be achieved due to the preselection condition @xmath110 .",
    "we change the variable order @xmath111 ( similarly for @xmath112 ) in eq .",
    "( [ eq : sumij ] ) @xmath113 we avoid four nested sums and get a double sum of independent series . however , it became clear , that the hypergeometric functions have to be additionally summed up in infinite sums over its parameters .    in case of computation of mean values , @xmath57 has first to be split into sum of monomials @xmath114 , where , importantly , @xmath115 are real coefficients",
    ". then hypergeometric terms take the form @xmath116 and @xmath117 , where @xmath118 and @xmath119 are integers .",
    "the analysis presented above for @xmath120 still holds for @xmath121 and @xmath122 .",
    "factorials in numerators and denumerators of hypergeometric terms @xmath38 , @xmath37 , @xmath87 and @xmath88 take large values , unavailable for the standard machine arithmetic .",
    "ieee 754 double precision numbers are capable of storing 15 significant decimal digits and magnitudes @xmath123 to @xmath124 @xcite . for @xmath125",
    "they exceed @xmath124 , but the values of terms are between 0 and 1 and need to be computed precisely .",
    "one way to compute @xmath36 , @xmath39 , @xmath87 and @xmath88 is to use libraries offering enhanced precision arithmetic .",
    "for example , the gnu multiple precision arithmetic library ( gmp ) @xcite and the gnu multiple precision floating - point reliable library ( mpfr ) @xcite are available for the c and c++ . the class library for numbers ( cln ) @xcite cooperates with c++ and the mpmath @xcite with python",
    ". these libraries offer low speed compared to the double precision arithmetic .",
    "the other possible way of computing hypergeometric terms is to use their logarithmic forms : @xmath126 , @xmath127 , @xmath128 , @xmath129 .",
    "the number magnitudes are within range of double precision for large @xmath85 and @xmath105 . moreover ,",
    "both the standard c / c++ and mpfr offer ` lgamma(n ) ` function , which calculates @xmath130 with hardware acceleration .    in order to find the best method of computation of the subexpressions we compared all the mentioned solutions .",
    "the relative error estimation was based on the values obtained symbolically with computer algebra system wolfram mathematica .",
    "we showed superiority of c / c++ computation with double - precision .",
    "it is not only several orders of magnitude faster but also consumes less memory .",
    "the reason for that is that ieee 754 arithmetic is built - in into modern computer processors and does not need any additional memory structures .",
    "the average error of double - precision calculation is of the order of @xmath131 , low enough for numerical simulations .",
    "the error can be further decreased at the significant cost of speed with mpfr library , which is the second fastest solution .",
    "computation of @xmath101 , @xmath102 , @xmath103 and @xmath104 requires finding proper cutoffs for infinite sums over @xmath85 and @xmath105 in eqs .",
    "( [ eq : g ] ) and ( [ eq : ab ] ) .",
    "first , we tested convergences of these sums , since their acceleration allows setting cutoffs earlier .",
    "several convergence rate acceleration methods were tested : the aitken s delta - squared process @xcite , the shanks transformation @xcite and the richardson extrapolation @xcite .",
    "none of them improves much the computation time .",
    "they raise the complexity of the algorithm instead .",
    "next , we worked out algorithm for finding cutoffs for sums @xmath103 and @xmath104 , but simplified procedure holds for @xmath101 and @xmath102 .",
    "the hypergeometric terms @xmath36 , @xmath39 , @xmath132 and @xmath133 converge slowly",
    ". function @xmath87 is depicted in fig .",
    "[ fig : fij ] ( see fig .  [",
    "fig : setup1 ] for @xmath134 ) .",
    "the greater @xmath86 gets , the slower @xmath87 converge over variable @xmath85 and more terms have to be included in the summation ( similarly for @xmath88 and variable @xmath105 )",
    ". one may apply high constant sum cutoffs .",
    "but even for large @xmath85 ( @xmath105 ) there exist @xmath86 ( @xmath99 ) for which the fixed range is too small",
    ".     evaluated for @xmath85 , parametrized by @xmath86 ( @xmath35).,height=113 ]    -7 mm    as a solution to this problem , we applied a dynamic cutoff with an adjustable precision e.g.  @xmath135 .",
    "the summation range was divided into two intervals . in the first one , the terms @xmath87 and",
    "@xmath88 monotonically grow to achieve the global maximum .",
    "the second interval is infinite and the terms slowly decrease asymptotically to 0 .",
    "the value @xmath136 for which @xmath87 achieves its maximum can be found by solving differential equation @xmath137 , which leads to equation @xmath138 , where @xmath139 denotes the digamma function ( the first derivative of @xmath140 ) .",
    "the inverse of @xmath141 can be computed numerically with the paul fackler s method @xcite .",
    "similar method may be used for finding maximum of @xmath88 .",
    "alternatively , algorithm starts from @xmath142 ( @xmath143 ) and for each @xmath85 ( @xmath105 ) evaluates @xmath132 ( @xmath112 ) .",
    "it adds this term to the sum and compares @xmath132 to the previous term @xmath144 .",
    "if @xmath145 the algorithm is still in the first interval and continues summation .",
    "otherwise , the summation is performed over the second interval , the algorithm checks if @xmath87 is smaller than the desired precision and if yes , it stops .",
    "error is minimized by adding the terms in the increasing order in the first interval . in practice",
    ", the algorithm uses the logarithmic forms ( they allow finer comparison of @xmath132 and @xmath144 ) .",
    "we compared the fixed and dynamic methods of assigning cutoffs for the sum @xmath103 in table  [ tab : fijcutoff ] ( the numbers for @xmath104 are similar ) .",
    "the latter decreases the number of terms for small @xmath86 and @xmath99 and achieves a good precision for their large values .",
    "it significantly improves speed and accuracy of the computation e.g.  for @xmath35 , if @xmath146 , the summation includes @xmath147 whereas if @xmath148 it includes @xmath149 terms to get the same accuracy with relative error @xmath135 .",
    ".comparison of cutoff values and relative error of computation of @xmath103 for @xmath35 with the fixed and dynamic cutoff estimation methods . [ cols=\"^,>,>,^,>,^ \" , ]     @xmath121 and @xmath122 have the same properties as @xmath87 and @xmath88 , only converge slower .",
    "therefore , the presented algorithm is capable of finding cutoffs of infinite hypergeometric sums required in computation of mean values .",
    "computation of the sum @xmath150 in eq .",
    "( [ eq : sumij_rewritten ] ) involves infinite summation of product of two gaussian hypergeometric functions @xmath103 and @xmath104 over @xmath86 and @xmath99 , where @xmath151 . the solution is to pre - compute the values of @xmath103 and @xmath104 with method presented in section [ sssec : cutoff ] and store them in the computer memory .",
    "the next step is to perform the final summation .",
    "the cutoffs @xmath152 and @xmath153 over variables @xmath86 and @xmath99 , respectively , are found separately during the pre - computation stage , so that @xmath154 and @xmath155 are smaller than the desired relative computation error .",
    "additional speedup of computations is achieved by changing the order of summation and eliminating one of the infinite sums @xmath156 the computation time of this formula is polynomial @xmath157 .",
    "further optimization is possible by noting the fact that hypergeometric terms @xmath32 , @xmath87 , @xmath88 are probability distributions and @xmath24 , @xmath158 , which implies @xmath159 . these properties allow to rewrite eq .",
    "( [ eq : s1 ] ) into a form involving finite summation range @xmath160 here computation time is also polynomial @xmath161 .",
    "( [ eq : s2 ] ) takes advantage over eq .",
    "( [ eq : s1 ] ) for small values of @xmath162 , for which the sum intervals are relatively short and the result is obtained quickly .",
    "however , the larger value of @xmath162 is , the more terms in eq .",
    "( [ eq : s2 ] ) have to be taken into account . as a result of that",
    ", the summation takes longer and errors accumulate significantly . at some point eq .",
    "( [ eq : s1 ] ) gives more reliable results and performs faster than eq .",
    "( [ eq : s2 ] ) . thus , the routine computing @xmath150 decides , depending on @xmath162 , which method to apply .",
    "formulae for photon number distributions , e.g.  eq .",
    "( [ eq : qth1 ] ) or ( [ eq : qbs1 ] ) require prior computation of normalization @xmath163 and @xmath164 , respectively . in principle , it is possible to take advantage of the fact that @xmath165 , compute unnormalized distribution values for all pairs @xmath166 , sum them up to obtain the inverse of its normalization constant and later renormalize the result .",
    "this method is useful in cases where all meaningful values of @xmath167 have to be computed anyway .",
    "however , in general , the normalization constant should be computed separately .    for theoretical preselection , according to eqs .",
    "( [ eq : s1 ] ) and ( [ eq : s2 ] ) , normalization constants equal @xmath168 we empirically found for @xmath35 , @xmath169 to be a good threshold for switching from eq .",
    "( [ eq : nth1c ] ) to eq .",
    "( [ eq : nth1b ] ) . according to eq .",
    "( [ eq : qth1 ] ) , computation of @xmath163 directly gives @xmath170 .",
    "@xmath164 is computed directly with eqs .",
    "( [ eq : s1 ] ) and ( [ eq : s2 ] ) .",
    "we found that for @xmath35 and @xmath171 the computation time required by eqs .",
    "( [ eq : s1 ] ) and ( [ eq : s2 ] ) is similar and for @xmath172 the former is faster . in order to compute photon number distribution @xmath173 we turn eq .",
    "( [ eq : qbs1 ] ) into a simpler form @xmath174 it is similar to eq .",
    "( [ eq : nth1b ] ) and is evaluated likewise .",
    "the main difference is that sums in eq .",
    "( [ eq : qbs1c ] ) traverse only even or odd values of @xmath86 and @xmath99 , depending on the parity of @xmath45 and @xmath46 .",
    "the computation time is polynomial @xmath157 , where @xmath152 is the cutoff of the infinite sum over @xmath86 .",
    "distinguishability given in eq .",
    "( [ eq : overlap_symmetry ] ) is not optimal for computation , since it does not minimize summation errors and for large values of the cutoffs it is difficult to keep coefficients of the photon number distributions in memory .",
    "( [ eq : overlap_symmetry ] ) may be optimized by change of variables @xmath175 where @xmath176 is the cutoff of the infinite sum over variable @xmath45 .",
    "the computation time of eq .",
    "( [ eq : overlap2 ] ) is polynomial @xmath177 and has the same advantages and disadvantages as eq .",
    "( [ eq : overlap_symmetry ] ) , but requires only half of the calculations .",
    "more complex idea is to first , divide the @xmath166 plane into rectangles , compute the photon number distributions for each rectangle separately and save the data to a disk .",
    "next , we calculate partial overlaps for each rectangle and sum up the contributions @xcite .",
    "our approach uses tiles of a size @xmath178 and performs two - step summation @xmath179 where @xmath180 , @xmath181 and @xmath176 , @xmath182 are the cutoffs of the sums over @xmath45 and @xmath46 respectively .",
    "computation complexity of eq .",
    "( [ eq : overlap3 ] ) is the same as of eq .",
    "( [ eq : overlap_symmetry ] ) , but this method offers several advantages .",
    "the values of @xmath183 and @xmath184 can be selected in such a way that the precomputed values of coefficients ( e.g.  @xmath103 and @xmath104 ) are stored in memory and used for all points of the single tile . additionally , different tiles can be computed in parallel with separate processors .",
    "this significantly speeds up the calculations and leads to a better usage of the computer resources and minimizes errors by grouping summed terms in smaller sets , but requires proper estimation of cutoffs @xmath176 , @xmath182 and tile size @xmath178 .",
    "computation gets twice shorter if eq .",
    "( [ eq : overlap3 ] ) is rewritten to the following form @xmath185 where @xmath186 .      in order to estimate cutoffs @xmath176 and @xmath182 in eqs .",
    "( [ eq : overlap3 ] ) and ( [ eq : overlap3a ] ) we tried the method presented in section  [ sssec : cutoff ] . however , unlike @xmath103 and @xmath104 , eq .",
    "( [ eq : overlap3 ] ) involves a lot of near - zero terms for small @xmath45 and @xmath46 before entering the more significant regions and we had to adjust this algorithm accordingly .",
    "the new solution analyzes the shape of photon number distributions .",
    "the distribution cut for a given @xmath46 spans of three different intervals of @xmath45 , see fig .",
    "[ fig : ranges ] .",
    "showing three main intervals of @xmath45 where photon number distribution behaves differently.,height=75 ]    -7 mm    the first interval ( a ) starts at @xmath187 and ends at @xmath188 for the beam - splitter preselection ( @xmath189 for the theoretical ) . here , the values of the distributions are small and their input is negligible .",
    "the interval b for @xmath190 ( @xmath191 ) gives the main input . in region",
    "c the values of are slowly fading out in infinity .",
    "the proposed algorithm analyzes the values of @xmath192 to find the start of the region c. to speed up the search , it begins at @xmath193 ( @xmath194 ) , which is an approximate end of region b , and takes samples of the photon number distribution for @xmath195 to the point where the values of the distribution are not distinguishable from 0 with the desired precision .",
    "this point lays inside region c and can be used as a good cutoff value @xmath176 and @xmath182 .",
    "this method gives the results which confirm the values obtained analytically .",
    "for the theoretical preselection we model the resolution of detectors measuring photon number @xmath196 with the weierstrass transform , i.e.  we apply the low - pass filter with gaussian distribution for which @xmath197 .",
    "the photon number distribution @xmath198 takes the form @xmath199 where @xmath200 is the standard deviation .",
    "gaussian properties of the filter allow for replacing the infinite summation over @xmath118 and @xmath119 with finite ranges .    in case of the beam - splitter preselection , applying a gaussian filter to the photon number distribution values",
    "does not influence the result in a significant way .",
    "since the filtering slows the computations , which in case of the beam - splitter preselection are already time - consuming , there is no reason for the weierstrass transform .",
    "application of eq .",
    "( [ eq : weierstrass ] ) to eq .",
    "( [ eq : overlap3a ] ) means that each tile of size @xmath201 has to be increased by a @xmath202 margin .",
    "computation time for each tile is increased approximately @xmath203 times and requires more computer memory , but is still quite easily tractable .",
    "mqsvis is a program suite developed for computation of various quantum indicators for mqs of light .",
    "these indicators include :    * photon number distributions for mqs of light , * visibility , * visibility computed from the overlap , * visibility computed for the photon number distributions transformed with weierstrass transform for different values of @xmath204 ( gaussian blur ) , * mean number of photons in both polarizations ( jointly and separately for each polarization ) , * variance of number of photons in both polarizations ( jointly and separately for each polarization ) .      in order to compile and test mqsvis program suite for linux / unix operating systems with gnu utilities ( gnu make , gnu compiler collection ) it is enough to run the following commands in a directory containing unpacked source code    ....      make      make check ....    in case of linux / unix with gnu make and intel c compiler , one has to modify ` makefile ` , replacing ` gcc ` with ` icc ` and ` -fopenmp ` option with ` -openmp ` .    for other platforms and compilers",
    ": one should compile ` mqsvis_norm.c ` with a standard c compiler , and ` mqsvis_tile.c ` with a c compiler and openmp extensions turned on . if compiler does not offer openmp extensions , the program will still work but will not utilize multiple cores or processors .",
    "program computes squared normalization for preselected macroscopic quantum superpositions ( mqs ) of light .",
    "this value is required by _",
    "mqsvis_tile _ program .",
    "program parameters : _ m _  average number of photons , _ dth _  preselection threshold .",
    "program computes photon number distribution for preselected macroscopic quantum superpositions ( mqs ) of light for a single tile .",
    "it produces partial results of quantum indicators : visibility , man number of photons , variance , to be gathered by _",
    "mqsvis_gather _ script . additionally , saves photon number distribution for single mqs state to a file .",
    "program parameters : _ m _  average number of photons , _ dth _  preselection threshold , _ r",
    "_  amount of losses , _",
    "n2 _  squared normalization , computed by _",
    "_ program , _ tilesize _  width and height of a single tile , _ tilex _  tile column ( counted from 0 ) , _ tiley _  tile row ( counted from 0 ) , _ plotstep _  step used for saving photon number distributions _",
    "plotfname1 _  file to save photon number distribution for tile @xmath205 , _ plotfname2 _  file to save photon number distribution for tile @xmath206 .    environment variables ( used only when compiled with openmp extensions ) : _ omp_num_threads _  maximal number of cores or processors utilized by the program .      a script developed to gather partial results computed by _",
    "mqsvis_tile _ program .",
    "it computes final quantum indicators for macroscopic quantum superpositions of light .",
    "program requires partial results of _ mqsvis_tile _ program to be saved in text files with the names in the form    ....",
    "m%s_dth%s_r%s-%d,%d.txt ....    where first ` % s ` is replaced with average number of photons , second ` % s ` with preselection threshold , third ` % s ` with losses and ` % d,%d ` are comma - separated tile coordinates numbered from 0 .",
    "program parameters : _ m _  average number of photons , _ dth _  preselection threshold , _ r _",
    " losses , _ tiles _  number of tiles in a row / column .      below we present a sample session with the above programs .",
    "the sequence of commands could be used e.g.  for testing of the suite .    1 .",
    "compute normalization for @xmath207 and @xmath208 and save it to a file + ....",
    "mqsvis_norm 5 2 > normalization.txt .... 2 .",
    "compute tile @xmath209 for @xmath210 ( no losses ) , tile size @xmath211 + ....",
    "mqsvis_tile 5 2 0 $ ( < normalization.txt ) 10 0 0 1 \\",
    "plot-0,0.txt /dev / null > m5_dth2_r0 - 0,0.txt .... 3 .",
    "compute tile @xmath212 , and parallely tile @xmath213 for the same parameters + ....",
    "mqsvis_tile 5 2 0 $ ( < normalization.txt ) 10 1 0 1 \\",
    "plot-1,0.txt plot-0,1.txt > m5_dth2_r0 - 1,0.txt .... 4 .",
    "compute tile @xmath214 + ....      mqsvis_tile 5 2 0 $ ( < normalization.txt ) 10 1 1 1 \\",
    "plot-1,1.txt /dev / null > m5_dth2_r0 - 1,1.txt .... 5 .",
    "gather the results + ....      python mqsvis_gather.py 5 2 0 2 ....    the computed results for the above session , printed out in the last step , are as follows    ....      total probability sum=0.626948016783147      visibility=0.683      visibility prim=0.683      simple visibility computed from the overlap=1.000      visibility with gaussian blur ( 3sigma=1)=0.968      visibility with gaussian blur ( 3sigma=1.5)=0.746      visibility with gaussian blur ( 3sigma=15)=0.491      visibility with gaussian blur ( 3sigma=150)=0.912      mean=8.362      mean",
    "k=6.269      mean l=2.092      variance=68.303      variance k=40.241      variance l=15.715      maximal value=0.0408525598455265 ....",
    "we discussed numerical methods useful for modeling of macroscopic quantum superpositions of light generated by phase covariant quantum cloner .",
    "properties of these mqs are governed by gaussian hypergeometric function , which parameters are half integers and argument takes moderate values .",
    "no simplifications of this function are possible .",
    "it is given by slowly convergent infinite sum , impossible to accelerate .",
    "the algorithm dynamically finds cutoff as well as cutoffs of sums involving hypergeometric functions .",
    "we achieved precision  @xmath135 .",
    "the model allows simulation of experimental schemes involving linear optical elements and mqs , as well as computation of expectation values of some observables .",
    "it is not possible to obtain such results by analytical calculation .",
    "our model takes into account values of experimental parameters .",
    "depending on them optimizes computation by choice of the more efficient , parallelizable algorithm for evaluation of the indicators for these states , e.g.  the photon number distribution or distinguishability .",
    "numerical methods presented here can be adjusted for analysis of decoherence and similar experimental schemes , different filtering techniques and modified mqss . as an example",
    ", we included a model of a realistic detector what improved applicability of our model for scientific research .",
    "we verified our numerical results with recently developed analytical model for mqs , available only for certain regimes of parameter values @xcite .",
    "finally , mqsvis program suite was developed and implemented in c and python programming languages .",
    "it utilizes the developed numerical model and allows to compute various quantum indicators for mqs of light : photon number distributions , visibility in case of limited resolution of photodetectors , mean and variance of photon number ( jointly and separately for each polarization ) .",
    "parallelization was achieved with splitting the computing tasks into tiles and utilization of openmp compiler extensions .",
    "a. b. thanks j. arabas and r. w. chhajlany for discussions .",
    "calculations were carried out at ci task ( galera cluster ) and cyfronet ( zeus cluster ) .",
    "this work was partially supported by ministry of science and higher education grant no .",
    "2619/b / h03/2010/38 ."
  ],
  "abstract_text": [
    "<S> macroscopically populated quantum superpositions pose a question to what extent macroscopic world obeys quantum mechanical laws . </S>",
    "<S> recently such superpositions for light , generated by optimal quantum cloner , were demonstrated . </S>",
    "<S> they are of fundamental and technological interest . </S>",
    "<S> we present numerical methods useful for modeling of these states . </S>",
    "<S> their properties are governed by gaussian hypergeometric function , which can not be reduced to neither elementary nor easily tractable functions . </S>",
    "<S> we discuss the method of efficient computation of this function for half integer parameters and moderate value of its argument . </S>",
    "<S> we show how to dynamically estimate a cutoff for infinite sums involving this function performed over its parameters . </S>",
    "<S> our algorithm exceeds double precision and is parallelizable . </S>",
    "<S> depending on the experimental parameters it chooses one of the several ways of summation to achieve the best efficiency . </S>",
    "<S> methods presented here can be adjusted for analysis of similar experimental schemes .    </S>",
    "<S> macroscopic quantum superpositions , macroscopic entanglement , optimal quantum cloning , gaussian hypergeometric function , quantum optics </S>"
  ]
}