{
  "article_text": [
    "many astrophysical flows involve dynamically significant magnetic fields , such as molecular clouds , accretion disks , the galactic dynamo , jets , galaxy clusters , stellar dynamos and coronae , the solar wind and the interstellar medium .",
    "these problems tend to be three - dimensional , multiscale and turbulent , so there is an ongoing interest in developing high - resolution and efficient magnetohydrodynamics ( mhd ) algorithms for them . in this paper , we outline an extension of the constrained transport algorithm ( evans & hawley 1988 ) to the combination of higher spatial order and zone - centered grids , and with resolution - enhanced tuned derivatives .",
    "we then describe how these measures fit together to yield an algorithm that closely approaches the theoretical maximum wavenumber resolution of spectral algorithms .",
    "the induction equation for a magnetic field @xmath0 and a velocity field @xmath1 in ideal mhd is @xmath2 analytically , this equation conserves magnetic divergence : @xmath3 .",
    "however , this may or may not be the case for a finite - difference treatment of this equation .",
    "tth ( 2000 ) reviews the methods taken by various algorithms to treat the divergence in mhd simulations .",
    "a spectral code explicitly projects the fourier components so that @xmath4 . for a finite difference code , the magnetic field",
    "can be evolved by a constrained transport scheme that preserves the magnetic divergence to machine precision ( evans & hawley 1988 ) . alternatively ,",
    "if the discretization does nt conserve magnetic divergence , the divergence can be removed with measures such as periodic use of a poisson solver ( brackbill & barnes 1980 ) , adding a divergence diffusion term @xmath5 to the magnetic evolution , or following an artificial and independently evolving divergence field ( dedner et al .",
    "2002 ) to propagate divergence away from where it is produced and then dissipate it . the powell scheme ( powell et al.1999 ) adds a source term to advect divergence rather than let it grow in place .",
    "a finite difference code can also employ a vector potential @xmath6 such that @xmath7 , in which case the magnetic divergence is automatically zero .",
    "this requires the use of a higher - order advection algorithm to ensure accurate second - derivatives , as is done in the pencil code ( brandenburg & dobler 2002 ) .",
    "we denote any finite difference scheme for mhd that explicitly conserves the magnetic divergence to machine precision as constrained transport ( ct ) , and any scheme that does not as unconstrained transport ( ut ) .",
    "several variations of ct are possible .",
    "if the electric field is differenced as a curl : @xmath8 then the magnetic divergence is preserved to machine precision for most grid types ( see appendix ) .",
    "evans & hawley ( 1988 ) introduced ct for staggered grids and tth ( 2000 ) showed that it works for centered grids as well ( see the appendix for explanation of centered and staggered grids ) . londrillo & del zanna ( 2000 ) further showed that high - order ct is possible on staggered grids with a radius - two stencil . in this paper , we show that volume - centered ct is possible on arbitrarily large stencil sizes , with hyperresistivity , and that the resolution of this algorithm at moderately high order approaches the theoretical maximum exhibited by a spectral code .    in   [ algorithms ] , we discuss the specifics of the algorithm , and in   [ simulations ] , we describe test simulations that demonstrate the capabilities of ct with high - order spatial derivatives .",
    "our algorithm is based on a constrained transport scheme , plus measures to enhance the resolution and maintain stability .",
    "high wavenumber resolution is achieved by a combination of high - order and tuned finite differences plus hyperdiffusivity , and stability is achieved by runge - kutta timestepping and hyperdiffusivity .",
    "a high - order timestepping scheme for the evolution equations is essential for the stability of most algorithms .",
    "the time update for a variable @xmath9 is @xmath10 , where @xmath11 represents some estimate of @xmath12 .",
    "one example is the second - order runge - kutta scheme , which estimates @xmath13 and then identifies @xmath14 .",
    "another class of algorithms maintains the conservation of mass and momentum by computing fluxes through zone boundaries .",
    "a variety of techniques exist for time - extrapolating the fluxes at @xmath15 , such as piecewise parabolic advection ( colella and woodward 1984 ) , total variation diminishing ( harten 1983 ) , riemann solvers ( toro 1999 ) , the method of characteristics ( stone & norman 1992a , hawley & stone 1995 ) , and many more .",
    "mhd poses a challenge to time extrapolation because there are seven or eight wavemode characteristics , depending on the technique used for treating magnetic divergence .",
    "in particular , the well - known method - of - characteristics algorithm interpolates along the alfvn characteristic while neglecting the fast and slow mode characteristics . for our simulations",
    ", we use runge - kutta for time - extrapolation because it does nt invoke any diffusive spatial interpolations (   [ diffusivity ] ) , and because it automatically captures all three mhd wavemode types . in our demonstration implementation",
    ", we use second - order runge - kutta while the pencil code ( brandenburg & dobler 2002 ) uses third - order , although either order has proven successful .      a common class of algorithms",
    "is based on momentum fluxes that are time - extrapolated with upwind spatial interpolations .",
    "the errors from the interpolations required for these flux transport algorithms produce an intrinsic diffusivity that can stabilize the evolution , even in the absence of any explicit diffusive terms .",
    "the nature and magnitude of the diffusivity has been characterized in zhong ( 1998 ) and dobler et al ( 2006 ) .",
    "runge - kutta timestepping , on the other hand , has no spatial interpolations , and thus no intrinsic diffusivity .",
    "one then generally needs an explicit stabilizing diffusivity .",
    "one has various options for the form of this diffusivity , with laplacian or hyper - laplacian typically chosen .",
    "these diffusivities have the benefit that their magnitude is easily characterized , and the diffusive coefficient can be tuned to have the minimum value necessary to preserve stability .",
    "consider : @xmath16 } { \\mbox{\\boldmath $ \\nabla$}}^{[4 ] } { { \\bf v}}.\\ ] ] let the fourier components be @xmath17 where @xmath18 is the wavenumber .",
    "they evolve according to @xmath19 } ( k_x^4 + k_y^4 + k_z^4 ) \\hat{{{\\bf v}}}({{\\bf k}}).\\ ] ] the @xmath20 term is the laplacian viscosity and the others are higher - order hyperdiffusivities .",
    "specifically , @xmath21 @xmath22 and @xmath23 } = \\partial_x^4 + \\partial_y^4 + \\partial_z^4.$ ] they differ in that the higher the order , the more selective they are in diffusing high - k structure while preserving low - k structure .",
    "equivalently stated , high - order hyperdiffusivities erase small - scale structure without affecting the larger scales . for many physical applications , such as the turbulent magnetic dynamo ,",
    "the large scale structure is unaffected by the nature of the small - scale diffusivity ( haugen & brandenburg 2004 ) , and so in these instances , the use of hyperdiffusivity instead of laplacian diffusivity enhances the wavenumber resolution .",
    "the @xmath24 operator is spherically symmetric in fourier space while the @xmath23}$ ] operator is not .",
    "this affects the maximum - possible timestep because in order to be advectively stable , the courant condition implies that the product @xmath25 must be less than a given value , and so the high - k corners of the 3d fourier cube are the most vulnerable to advective instability .",
    "in these corners , the @xmath24 term delivers more diffusion than the @xmath23}$ ] term , but with a cost of twice as many finite difference operations .",
    "hyperdiffusivity acts together with high - order finite differences to enhance the resolution of a simulation .",
    "high - order finite differences allows structure to be finite differenced with less error , and hyperdiffusivity allows this structure to evolve with less dissipation than it would with laplacian diffusivity .",
    "hyperdiffusivity can benefit the timestep as well as the resolution .",
    "suppose one chooses the laplacian term to provide the dominant fraction of the diffusivity .",
    "one typically then evaluates by trial and error the minimum value of @xmath20 and the maximum timestep @xmath26 that one can get away with to maintain stability . once these values are chosen , the addition of a small measure of hyperdiffusivity , small enough so as not to contribute significantly to the total diffusivity , but large enough to affect the highest - k structure , increases the maximum stable timestep by about 50% .",
    "this technique works because the highest - wavenumber structure is the most vulnerable to instability , and so the timestep depends most critically on the value of the diffusivity for these wavenumbers .",
    "one could additionally note that  maximum stable timestep \" is not sharply defined .",
    "for instance , a timestep at the cusp of stability might be unstable , but only after perhaps more than 10 timesteps . also , the maximum stable timestep depends on the maximum value of the velocity in the simulation , which is changing in time .",
    "the equations of incompressible mhd with diffusivity and hyperdiffusivity are @xmath27 } { \\mbox{\\boldmath $ \\nabla$}}^{[4 ] } { { \\bf v}}\\label{equtv } + \\nu_{{\\scriptscriptstyle\\mathsf}6 } { \\mbox{\\boldmath $ \\nabla$}}^6 { { \\bf v}}\\label{equtv } + \\nu_{{\\scriptscriptstyle\\mathsf}[6 ] } { \\mbox{\\boldmath $ \\nabla$}}^{[6 ] } { { \\bf v}}\\label{equtv } + \\nu_{{\\scriptscriptstyle\\mathsf}d } { \\mbox{\\boldmath $ \\nabla$}}{\\mbox{\\boldmath $ \\nabla$}}\\cdot   { { \\bf v}}\\label{eqctv}\\ ] ] @xmath28 } { \\mbox{\\boldmath $ \\nabla$}}^[4 ] { \\bf j } \\bf \\right ] + \\eta_{{\\scriptscriptstyle\\mathsf}d } { \\mbox{\\boldmath $ \\nabla$}}{\\mbox{\\boldmath",
    "$ \\nabla$}}\\cdot { { \\bf b}}\\label{eqctb}\\ ] ] @xmath29    .",
    "[ tablevar ] variables in the equations of mhd [ cols= \" < , < , < , < \" , ]",
    "the forcing is the same as used by maron et al .",
    "a random forcing field is added to the velocity every timestep .",
    "the spectrum of the forcing field is @xmath30 , truncated 2.5 lattice units from the origin in fourier space , and the fourier components have random phases .",
    "the forcing power , simulation volume and density are unity , which yields rms velocity and magnetic fields of order unity ( maron 2004 ) .",
    "the diffusivities are given in ",
    "[ simulations ] .",
    "we plot the kinetic and magnetic spectra in figure [ figct]_(a)_. the spectra are very similar for constrained and unconstrained transport simulations , and also for different orders .",
    "however the spectra alone do not distinguish between simulations of different orders because an error in the derivative manifests itself as an advective dispersion rather than as a diffusivity (   [ rez ] ) .",
    "one instead has to examine the fields in real space .    in figure  [ figct]_(b )",
    "_ , we compare the magnetic fields at t=0.4 crossing times . for the comparison ,",
    "we examine the difference between the fields integrated over space by computing the @xmath31 norm between simulations @xmath32 and @xmath33 @xmath34 ^ 2 d(\\mbox{vol } ) } { \\int b_y(i)^2 d\\mbox{vol } + \\int b_y(j)^2 d(\\mbox{vol})}.\\ ] ] stone et .",
    "( 1992b ) argue that this kind of comparison is more meaningful than merely plotting the overlay of both fields .",
    "the constrained transport simulation with polynomial - based finite differences on a radius - eight stencil ( ct8 in table [ tablesim ] ) serves as the basis of comparison .",
    "we compare the constrained transport simulations to an unconstrained transport simulation on a radius - eight tuned finite - difference stencil ( ut8 ) .",
    "we use ut8 as a stand - in for the spectral algorithm because of its high wavenumber resolution .",
    "the spectral algorithm delivers the highest - attainable resolution because spectral derivatives are exact for all wavenumbers . with this",
    ", a 3d spectral simulation without an aliasing grid - shift correction can resolve structure up to k=2/3 , and with a grid - shift correction it can resolve up to k=.94 ( canuto 1987 ) .",
    "the spectral algorithm can also set the magnetic divergence to zero in fourier space at negligible cost .",
    "unconstrained transport does not explicitly conserve magnetic divergence and so in model ut8 the divergence is cleaned with a fourier projection every timestep .",
    "we also tried applying the correction every fourth timestep and with virtually identical results .",
    "the radius - eight stencil of ut8 yields derivatives that are accurate up to k=.56 .",
    "the @xmath31 norms given in table  ( [ tablek ] ) show how the simulations progressively approach the ct8 result as the stencil size increases .",
    "the match is poor for ct1 and better for ct3 .",
    "we also note that the radius - three simulation with tuned derivatives ( ct3 t ) performs better than the radius - four simulation with polynomial - based derivatives , establishing the effectiveness of tuned derivatives .",
    "this can also be qualitatively seen in figure ( [ figct ] ) , where we see that the fields for ct8 and ut8 are closely aligned ( fig .",
    "[ figct ] ) , and that they also closely resemble those for ct3 .",
    "we attribute the remaining differences between ct8 and ut8 to the fact that the magnetic divergence is removed spectrally in ut8 , while it is handled by constrained transport in ct8 . collectively , the high - order constrained and unconstrained transport simulations ( ct3 , ct8 & ut8 ) more closely resemble each other than they do the low - order constrained transport simulations ( ct1 & ct2 ) . we conclude that ct3 is already a good approximation to the spectral algorithm .",
    "we adapted the vector potential code pencil to run in ct mode and used it to compare the vector potential and ct techniques .",
    "we ran an alfvn wave on a @xmath35 grid with zero viscosity and resistivity .",
    "( figure  [ figalfven ] ) .",
    "after ten crossing times , both the vector potential and ct techniques yield wave profiles that agree with each other to within 1 percent .",
    "the shape of the profiles are also well - matched with the initial conditions , with a phase error of 10 percent .",
    "we also used both techniques to run a turbulent dynamo simulation we started with an initially weak magnetic field in the form of a beltrami wave and applied helical forcing until it grew to a steady state .",
    "the box size is @xmath36 , the density is unity , the forcing power is equal to @xmath37 the viscosity is equal to @xmath38 and the resistivity is equal to @xmath39 the rms magnetic field strength is plotted in figure  ( [ figdynamo ] ) . after 30 crossing times ,",
    "the values for @xmath40 for the ct and vector potential techniques agree to 1 percent ( figure  [ figdynamo ] ) .",
    "we ran an alfvn wave test where the propagation axis is oblique to the grid axes , with the initial conditions in gardiner & stone ( 2005 ) : @xmath41 @xmath42 the simulation volume is a unit cube , modeled on a grid of size @xmath43 .",
    "the velocity field is quasi - incompressible , with the divergence removed spectrally every 4 timesteps .",
    "the kinetic and magnetic diffusivities are all set to zero for this linear problem .",
    "we ran two simulations : one with third - order polynomial finite differences and another with third - order tuned finite differences from table  ( [ tablek ] ) .",
    "after the wave has traveled 16 times around the periodic box , the waveform remains almost indistinguishable from the initial conditions , with the tuned finite differences yielding a more precise result than the polynomial finite differences ( figure  [ figalfvenb ] ) .",
    "we have developed a new version of the constrained transport algorithm that uses volume - centered fields and hyperresistivity on a high - order finite difference stencil , with tuned finite difference coefficients to enhance high - wavenumber resolution .",
    "high - order interpolation allows implementation of staggered dealiasing .",
    "together , these measures yield a wavenumber resolution that approaches the ideal value achieved by the spectral algorithm .    volume centered fields are desirable because then @xmath1 , @xmath0 and @xmath44 all reside at the same grid location , allowing @xmath44 to be constructed directly from the cross product of @xmath1 and @xmath0 without interpolation .",
    "for staggered fields , @xmath1 and @xmath0 reside at the zone faces and @xmath44 on the edges , and so constructing @xmath44 involves spatial interpolation , which reduces wavenumber resolution .",
    "high - order stencils and tuned finite difference coefficients both enhance the wavenumber resolution of finite differences .",
    "for a radius - three stencil with tuned coefficients , derivatives can be computed to a relative precision of @xmath45 up to a nyquist - scaled wavenumber of @xmath46 . without tuning ,",
    "this would be @xmath47 for a radius - three stencil .",
    "a radius - one stencil derivative such as is used in zeus ( stone & norman 1992a ) is only accurate up to @xmath48 .",
    "the spectral derivative is precise up to @xmath49 , although in practice it is limited to @xmath50 because of aliasing .",
    "aliasing limits a finite - difference code to @xmath51 unless the finite - difference grid shift aliasing correction is used (   [ dealiasing ] ) .    hyperresistivity is desirable because it is more effective than laplacian resistivity in diffusing high - wavenumber modes while at the same time preserving low - wavenumber modes .",
    "the fact that hyperresistivity can be written as a curl allows its inclusion into ct .",
    "if laplacian diffusivity were used instead , too much high - wavenumber structure would be diffused for the high - order or tuned derivatives to matter .",
    "the resolution of the algorithm described here approaches that of a spectral code , but because it uses finite differences , it runs faster than a spectral code and is nt restricted to periodic boundary conditions .",
    "also , since the finite differences are local , it is easily scalable to thousands of processors .",
    "the spectral algorithm is more difficult to scale to large numbers of processors because it involves all - to - all communications between processors .",
    "a finite difference code only passes information between processors whose subgrids are adjacent in physical space .",
    "lastly , because the code works with the magnetic field rather than the vector potential , boundary conditions are often easier to implement .",
    "we received support for this work from nsf career grant ast99 - 85392 , nsf grants ast03 - 07854 and ast06 - 12724 , and nasa grant nag5 - 10103 .",
    "we acknowledge stimulating discussions with e. blackman , a. brandenburg , b. chandran , and j. stone , and we also acknowledge the referee , wolfgang dobler , for thorough comments that improved the paper . \"",
    "constrained transport expresses the magnetic induction equation as a pure curl plus a divergence diffusivity : @xmath52 where @xmath53 is defined in equation  ( [ eqctb ] ) .",
    "the @xmath54 term serves to diffuse away magnetic divergence , and the finite differences are arranged so that @xmath55 thus , the curl term does not contribute to the evolution of the magnetic divergence , and if the initial conditions are divergence - free , the magnetic divergence remains zero throughout the evolution .    to see how constrained transport works , denote the vector field by @xmath56 = @xmath57 where @xmath58 are integers specifying the locations of grid cell centers .",
    "there are two basic grid types :  centered \" and  staggered \" ( figure  [ figstagger ] ) . for a centered grid , scalar and vector quantities",
    "are located at cell centers . for a staggered grid ,",
    "scalar quantities are located at cell centers and vector quantities at cell faces .",
    "for instance , we would index the components of @xmath53 as @xmath59    the finite divergence divergence of the curl of @xmath53 is @xmath60 which consists of terms such as @xmath61 one can straightforwardly see that this is zero for finite differences of the form eq .",
    "[ stencil ] for both centered and staggered grids . thus , constrained transport can be coordinated with high - order and tuned finite differences , as well as with hyperresistivity .    for a staggered grid ,",
    "@xmath53 \" vectors are located at cell edges , whereas the @xmath1 and @xmath0 vectors from which they are constructed are found at cell faces .",
    "a staggered grid ct scheme therefore involves spatial interpolation , one example being the method of characteristics scheme for time - interpolating alfvn waves .",
    "we use volume - centered fields and runge - kutta timestepping because , among other reasons , no interpolation is required .",
    "colella , p. , & woodward , p. r. 1984 , j. comput .",
    "phys . , 54 , 174 dedner , a. , kemm , f. , kroner , d. , munz , c .- d . , schnitzer , t. & wesenberg , m. 2002 , j. comput .",
    "phys . , 175 , 645 dobler , w. , stix , m. & brandenburg , a. 2006 , apj 638 , 336"
  ],
  "abstract_text": [
    "<S> numerical simulations including magnetic fields have become important in many fields of astrophysics . </S>",
    "<S> evolution of magnetic fields by the constrained transport algorithm preserves magnetic divergence to machine precision , and thus represents one preferred method for the inclusion of magnetic fields in simulations . </S>",
    "<S> we show that constrained transport can be implemented with volume - centered fields and hyperresistivity on a high - order finite difference stencil . </S>",
    "<S> additionally , the finite - difference coefficients can be tuned to enhance high - wavenumber resolution . </S>",
    "<S> similar techniques can be used for the interpolations required for dealiasing corrections at high wavenumber . together </S>",
    "<S> , these measures yield an algorithm with a wavenumber resolution that approaches the theoretical maximum achieved by spectral algorithms . </S>",
    "<S> because this algorithm uses finite differences instead of fast fourier transforms , it runs faster and is nt restricted to periodic boundary conditions . </S>",
    "<S> also , since the finite differences are spatially local , this algorithm is easily scalable to thousands of processors . </S>",
    "<S> we demonstrate that , for low - mach - number turbulence , the results agree well with a high - order , non - constrained - transport scheme with poisson divergence cleaning . </S>"
  ]
}