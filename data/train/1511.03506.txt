{
  "article_text": [
    "the theoretical description of extended systems has become more and more important in the course of treating realistic systems .",
    "presently , energy conversion has become an important topic , and there has been an upsurge of research in electrochemistry .",
    "the targeted systems are rather complex , _ e.g. _ the simulation of electrolytes in contact with electrodes .",
    "this can often not be done with density functional theory , due to the system size and corresponding large numerical effort . on the other hand",
    ", empirical models may not always work well , and besides , they depend on the choice of parameters , such as force fields . the combination of quantum mechanical ( qm ) and molecular mechanics ( mm ) methods ( qm / mm ) is therefore tempting in this area .",
    "therefore , the present article aims at a description of an implementation of such a qm / mm scheme for molecular and periodic systems .",
    "the main intention is to establish a qm / mm scheme for molecules _ and _ periodic systems .",
    "these schemes have become popular over the past years especially for the modeling of biological systems , see _",
    "e.g. _ @xcite .",
    "also , periodic systems are now investigated on this level , _",
    "e.g. _ @xcite .",
    "the systems to be targeted with the present approach are in the area of electrochemistry , _",
    "e.g. _ electrolytes , in contact with metal surfaces .",
    "motivated by the aim to develop a theoretical scheme to treat electrochemical interfaces self - consistently , we formulated a qm / mm approach which in the first stage is making use of the so called subtractive scheme to evaluate the system s energy ( see , _ e.g. _",
    "@xcite ) . in this scheme ,",
    "the total energy and forces are obtained as    @xmath0    @xmath1    compared to molecules , the periodicity has to be taken into account .",
    "this is in the present approach achieved by summing the interactions with the help of the ewald method in the case of periodicitiy in three dimensions , and parry s potential @xcite for the case of periodicity in two dimensions .",
    "the mm interaction is thus summed for the whole system , and subsequently corrected due to the contributions from the qm region : the energy of the qm region and its periodic replicas are again summed with the ewald or parry method , on the mm and the qm level separately .",
    "subsequently , the data obtained is inserted in equations [ energyequation ] and [ gradientequation ] .",
    "this qm / mm level corresponds to a mechanical embedding , where the interactions between the qm and mm region are treated on the mm level .",
    "the qm and mm calculations for the qm region are performed without taking the atoms into account which are not in the qm region .",
    "however , the total energy in equation [ energyequation ] and the forces in equation [ gradientequation ] now include effects of the qm region .",
    "an extension of mechanical embedding leads to electrostatic embedding where the qm calculations include the effects of all the other atoms by e.g. representing these atoms by point charges .",
    "the present implementation corresponds thus to a periodic extension of a mechanical embedding . for a comparison of the embedding schemes , see e.g. @xcite .",
    "the present scheme requires a qm and an mm code , and a connection between both . for the mm region gulp",
    "was used @xcite , and for the qm region crystal @xcite .",
    "energies and gradients are obtained from these codes and manipulated according to equations ( [ energyequation ] ) and ( [ gradientequation ] ) . besides these codes",
    ", it is necessary to have a routine which works with the manipulated energies and forces : here , a modified version of gulp is used .",
    "finally , an interface ( _ i.e. _ wrapper ) to perform the communication between the three aforementioned codes is required , for purposes such as _ e.g. _ extracting the energy and gradients , or setting up new input files during an optimisation ( _ e.g. _ gulp and crystal inputs for the qm region are generated automatically during an optimisation ) .",
    "this strategy has the advantage that features which are available within gulp can be used for qm / mm calculations , such as the geometry optimisation or molecular dynamics .",
    "however , one has to keep in mind that in the present implementation only the mm hessian is available .",
    "the target of the present work is mainly to establish the methodology .",
    "a relatively simple potential is used @xcite , which employs intermolecular coulomb and lennard - jones terms , and a harmonic intramolecular potential .",
    "the advantage is that this is well suited for test purposes , as _",
    "results for the water dimer already exist and can thus be compared with .",
    "the _ ab - initio _ calculations were done on the simple lda ( local density approximation ) level , with dirac - slater exchange and the correlation functional as in ref .",
    "@xcite . if not stated otherwise , for oxygen a @xmath2 $ ] gaussian basis set ( as in ref .",
    "@xcite ) , and for hydrogen a @xmath3 $ ] basis set ( as in ref .",
    "@xcite ) was used .",
    "these basis sets are medium sized , which also means that they are robust and problems from linear dependencies are unlikely to occur .",
    "the structures are visualised with xcrysden @xcite and molden @xcite .",
    "results for the geometry and vibrational frequencies of the water molecule are displayed in table [ h2omoleculegeometry ] .",
    "the mm results are practically identical to those of the publication where this potential was suggested @xcite .",
    "the qm results ( on the lda level ) are in reasonable agreement with the lda results in ref .",
    "larger basis sets were used in ref .",
    "@xcite , and indeed , the agreement of the computed h - o - h angle ( 108.1@xmath4 vs 104.9@xmath4 in ref .",
    "@xcite ) can be improved , when the oxygen basis set is enhanced . for this purpose ,",
    "the @xmath5 $ ] oxygen basis set from ref .",
    "@xcite was used , together with a finer integration grid and higher thresholds for the integral selection .",
    "the o - h distance agrees already well with the medium sized basis sets described in section [ technicaldetails ] . with the enhanced basis set ,",
    "also the vibrational frequencies agree well with the ones computed in ref .",
    "@xcite .",
    ".[h2omoleculegeometry]geometry of the h@xmath6o molecule , vibrational frequencies and charges at the mm level calculated with the empirical potential and with qm on lda - level . for the mm system , charges are as defined by the potential , while mulliken charges are given for the qm case . [",
    "cols=\"^,^,^,^,^\",options=\"header \" , ]     the mm results for the dimer are in full agreement with an earlier work where the same potential was used @xcite , which can be seen as a test of the implementation of the potential ( the computed mm oxygen - oxygen equilibrium distance in @xcite is 2.737  , and the computed mm intermolecular energy is 28.63 kj / mol , corresponding to 0.0109 @xmath7 or 0.30 ev ) .",
    "the qm results show that there is a stronger attraction on this level , resulting in a shorter oxygen - oxygen equilibrium bond length .",
    "the results agree reasonably well with the lda results from @xcite , where an oxygen - oxygen equilibrium distance of 2.710   was obtained and a binding energy of 9.02 kcal / mol , corresponding to 0.39 ev or 0.0144 @xmath7 . using data from tables [ h2odimergeometry ] and [ h2omoleculegeometry ] to compute the binding energy ,",
    "then the binding energy would be 0.0206 @xmath7 or 0.56 ev ; the deviations are again due to the smaller basis sets used in the present work .",
    "the mm value ( 0.0109 @xmath7 , 0.30 ev , see above ) is close to the experiment @xcite , whereas lda overbinds .",
    "the qm / mm results are very similar to the mm results for the molecule made of o4 , h5 , h6 , _",
    "i.e. _ the molecule which is not in the qm region .",
    "this is to be expected , as the qm part mainly influences the molecule in the qm region , and the intermolecular interactions are due to the mm part .",
    "the qm part has thus only an indirect influence due to the slightly different geometry of the qm water molecule .",
    "thus , the oxygen - oxygen equilibrium distance obtained with the qm / mm approach is close to the mm value .",
    "subsequently , the energy curve when separating both water molecules was computed . for this purpose ,",
    "the oxygen - oxygen distance was fixed at a certain value , and the geometries of all hydrogen positions were optimised .",
    "this way , one point of the potential curve is obtained . when this procedure is performed for a set of oxygen - oxygen distances , then the potential curve in figure [ h2odimerpotentialcurve ] is obtained . there , the data was fitted with a morse potential .",
    "it turns out that mm and qm / mm are very similar ( equilibrium distance , curvature at the minimum , binding energy of the dimer ) .",
    "this is due to the reason mentioned above , that the qm part has only little influence on the intermolecular interaction . from the fits with the morse potential ,",
    "the binding energy is obtained as 0.22 ev ( mm ) , 0.21 ev ( qm / mm ) versus 0.55 ev ( qm ) .          in a next step ,",
    "periodicity was implemented .",
    "an advantage of the presently used codes is that both employ the same electrostatic potentials , _",
    "i.e. _ saunders potential @xcite for one dimensional periodicity , parry s @xcite for two dimensional periodicity and the ewald potential for three dimensional periodicity .",
    "note that in the present case of two - dimensional periodicity , the implementation of the periodicity is truly two - dimensional .",
    "this implies that the system is _ not _ repeated in the third direction ( _ z_-direction ) , and there is consequently no parameter for the vacuum thickness .    .",
    "note that the system is periodic only in two dimensions , but not in the _",
    "z_-direction.,width=453 ]    as a test , the potential curve was computed , where a water dimer was periodically arranged , with the lattice constants @xmath8 , and a fixed angle @xmath9 ( see figure [ h2odimer2dperiodicgeometry ] ) .",
    "then , the oxygen positions were fixed at a distance of 2.8   ( one oxygen 2.8   vertically above the other along the _",
    "z_-axis , which is the non - periodic direction ) . for various lattice constants",
    ", the hydrogen positions were optimised . in the qm / mm case ,",
    "one molecule was considered the qm region ; here it is the one whose oxygen atom has a hydrogen bridge to the second water molecule .",
    "this resulted in three potential curves visualised in figure [ h2odimer2dperiodicpotentialcurve ] .    .",
    "the minimum energy of the various fits is shifted to zero.,width=453 ]    for large values of the lattice constant , one obtains essentially the structure of a single water dimer , as the interaction between the dimers is small .",
    "when reducing the lattice constant , the water molecules tilt to the molecules of the neighbouring cell , as the interaction to this neighbouring molecule becomes more important .",
    "the potential curve has a minimum for a certain lattice constant , which is shortest at the qm level and longer at the mm level .",
    "the qm / mm equilibrium distance is now in between the qm and mm equilibrium distance , as the dominant interactions are now the qm - interaction between neighbouring molecules in one layer and the mm - interaction between neighbouring molecules in the other layer .      in a next step , the qm / mm expressions as in equations ( [ energyequation ] ) and ( [ gradientequation ] )",
    "were used to perform molecular dynamics .",
    "the implementation is similar to the one used for geometry optimisation as was described in the previous sections .",
    "the energy and gradient calculations in the molecular dynamics part of the gulp code were correspondingly modified , and the _ ab - initio _ energy and gradient are again extracted from crystal .      to test the implementation ,",
    "molecular dynamics simulations were performed for the water dimer ( without any periodicity ) , at the level of mm , qm and qm / mm . the starting point was a system consisting of two water molecules at a relatively large distance ( oxygen - oxygen distance @xmath105  ) . at the mm level , as cpu time is not critical , a simple , nearly brute force way to obtain the minimum structure was to employ an nvt ensemble at @xmath11=10 k with a production run of 400 ps , using a time step of 1 fs .",
    "on the qm level , the optimisation was more difficult due to problems with overheating , when the system gained kinetic energy too quickly .",
    "thus , a series of molecular dynamics runs was used to obtain the minimum structure .",
    "starting again from the geometry where two water molecules are far apart , a 1 ps simulation was performed ( time step 1 fs , initial temperature 100 k , and cooling with a rate of 0.1 k / step down to 5 k ) .",
    "subsequently , the final geometry was used as a new initial geometry , and a simulation at a temperature of 5 k ( nve ensemble , 1 ps , time step 1 fs ) was performed . after repeating this procedure a few times ,",
    "the final structure was essentially the one of the geometry optimisation in table [ h2omoleculegeometry ] .    at the qm / mm level ,",
    "the simulation turned out to be straightforward .",
    "the nvt ensemble was used , at a temperature of 10 k , and with a simulation length of 100 ps ( 1 fs time step ) .    in all cases ,",
    "the final structure agreed reasonably well with the one obtained from a straightforward optimisation as described in section [ optimisationsection ] , _",
    "e.g. _ the o - o distance at the end of the md run was 2.733   ( mm ) , 2.614   ( qm ) , and 2.781   ( qm / mm ) .",
    "two water molecules were periodically arranged in a two - dimensional box of 5@xmath125   size , and a molecular dynamics run at the mm level was performed ( nvt ensemble , 400 ps total length , 1 fs time step ) .",
    "the initial temperature was 300 k , and lowered to 50 k in 25000 steps . the final structure agreed with the one obtained by a normal minimisation with the default optimiser ( bfgs ) . with",
    "a similar ( though shorter ) molecular dynamics run and using the qm / mm energy and forces , an optimisation at the qm / mm level was performed .",
    "the structure agreed reasonably well with the one from the mm optimisation .",
    "this serves as an additional test for the qm / mm implementation .",
    "[ waterbox ]    in the case of three - dimensional periodicity , 32 water molecules were considered , in a cubic box of 9.856  , corresponding to a density of 1 g/@xmath13 ( see figure [ waterbox ] ) .",
    "the calculation of the radial pair distribution function and of the mean square displacement ( msd ) was implemented in gulp , or independently computed with isaacs @xcite .",
    "a simulation length of 25 ps equilibration ( nvt ensemble ) and subsequently 100 ps production was chosen ( nve ensemble ) , at a time step of 1 fs .",
    "o molecules , at the mm level , for temperatures in the range from 50 to 491 k. the msd for temperatures @xmath14 164 k is almost constant and displayed in the inset.,width=377 ]    results for the msd at the mm level are summarised in figure [ mmmsd ] .",
    "the temperature is the one as it was obtained as an average over the run . for temperatures",
    "@xmath15 218 k , there is a linear slope , which increases with temperature , whereas for temperatures @xmath14 164 k , the msd is approximately constant .",
    "this indicates a phase transition from the liquid to the solid phase in this temperature range , with this potential .",
    "the radial pair distribution functions are displayed in figure [ radialpdfbild ] .",
    "they agree reasonably well with the literature , _",
    "e.g. _ with empirical potentials @xcite , dft @xcite and recently also mp2 @xcite .",
    "\\a ) o molecules , at the mm level , for temperatures in the range from 50 to 477 k. the displayed radial pair distribution functions are for o - o ( a ) , o - h ( b ) and h - h ( c).,title=\"fig:\",width=238 ] b ) o molecules , at the mm level , for temperatures in the range from 50 to 477 k. the displayed radial pair distribution functions are for o - o ( a ) , o - h ( b ) and h - h ( c).,title=\"fig:\",width=238 ] c ) o molecules , at the mm level , for temperatures in the range from 50 to 477 k. the displayed radial pair distribution functions are for o - o ( a ) , o - h ( b ) and h - h ( c).,title=\"fig:\",width=238 ]    finally , qm / mm simulations were performed for systems with 32 h@xmath6o molecules , out of which 0 to 4 molecules were treated on the qm level , and all the other ones on the mm level .",
    "this is labelled as ( h@xmath6o)@xmath16 ( where superscript and subscript are the numbers of qm and mm treated molecules , respectively ) , with @xmath17 ranging from 0 to 4 .",
    "the qm region is fixed to the initially defined qm molecules .",
    "more sophisticated approaches define a spatial qm region , and consider diffusion into and out of this region via an adaptive scheme @xcite .",
    "the present results are similar to the mm results , for example a comparison is shown in figure [ radialpdfbildqmmm ] for the oxygen - oxygen radial pair distribution function . in the simulations , it turns out that qm clusters are formed : initially , the qm molecules were put far apart . after a while , they start to form dimers in the case of ( h@xmath6o)@xmath18 , and arrange in a triangle for ( h@xmath6o)@xmath19 . for ( h@xmath6o)@xmath20 , there are enough qm molecules so that they can form a chain , which connects the cells ; _",
    "i.e. _ there is a stripe of qm molecules going through the unit cell .",
    "this formation of qm clusters and qm stripes is presumably due to the different binding energies of qm molecules and mm molecules with the functional and potential used in the present work ( see the discussion about the water dimer in section [ water_molecule_and_dimer ] ) .",
    "this may require a readjustment of the water potential is some cases , but not necessarily in general .",
    "for example , in the case of systems such as water in contact with a transition metal surface , the first water layer has an ice - like structure , and might constitute a possible qm region , whereas the remaining water molecules might be described with a semi - empirical potential .",
    "o molecules , at the qm / mm level , with the number of qm molecules varied from 0 to 4.,width=453 ]",
    "a qm / mm implementation for periodic systems has been presented .",
    "calculations on the water dimer and for water with two and three - dimensional periodicity show that the implementation works properly .",
    "structural optimisation and molecular dynamics simulations have been implemented on the qm / mm level . in the case of three - dimensional periodicity , as a test system a box of 32 water molecules was studied at the mm and qm / mm level .",
    "the pair distribution functions agree well when computed on the mm or qm / mm levels .",
    "we acknowledge support from the european research council ( erc ) through the erc - starting grant theofun ( grant agreement no .",
    "259608 ) as well as from the dfg ( deutsche forschungsgemeinschaft ) .    0 f. maseras and k. morokuma , j. comput .",
    "chem . * 16*:1170 - 1179 ( 1995 ) .",
    "m. svensson , s. humbel , r. d. j. froese , t. matsubara , s. sieber , and k. morokuma , j. phys . chem . * 100*:19357 - 19363 ( 1996 ) .",
    "u. eichler , c. m. klmel , and j. sauer , j. comput . chem . * 18*:463 - 477 ( 1996 ) .",
    "d. bakowies and w. thiel , j. phys .",
    "chem . * 100*:10580 - 10594 ( 1996 ) .",
    "p. sherwood et al , j. mol .",
    "( theochem ) * 632*:1 - 28 ( 2003 ) .",
    "j. sauer and m. sierka , j. comput .",
    "chem . * 21*:1470 - 1493 ( 2000 ) .",
    "d. a. yarne , m. e. tuckerman , and g. j. martyna , j. chem . phys .",
    "* 115*:3531 - 3539 ( 2001 ) .",
    "t. laino , f. mohamed , a. laio , and m. parrinello , j. chem .",
    "theory comput .",
    "* 2*:1370 - 1378 ( 2006 ) . c. f. sanz - navarro , r. grima , a. garca , e. a. bea , a. soba , j. m. cela , p. ordejn , theor .",
    "acc . * 128*:825 - 833 ( 2011 ) .",
    "d. e. parry , surf .",
    "science * 49*:433 - 440 ( 1975 ) ; * 54 * , 195 ( 1976 ) ( erratum ) .",
    "h. lin and d. g. truhlar , theor .",
    "acc . * 117*:185 - 199 ( 2007 ) .",
    "j. d. gale , j. chem .",
    ", faraday trans .",
    "* 93*:629 - 637 ( 1997 ) .",
    "r. dovesi , v. r. saunders , c. roetti , r. orlando , c. m. zicovich - wilson , f. pascale , b. civalleri , k. doll , n. m. harrison , i. j. bush , ph .",
    "darco , m. llunell , crystal2009 , university of torino , torino , 2009 .",
    "k. toukan and a. rahman , phys .",
    "b * 31*:2643 - 2648 ( 1985 ) .",
    "j. p. perdew and a. zunger , phys .",
    "b * 23*:5048 - 5079 ( 1981 ) . m.d .",
    "towler , n.l .",
    "allan , n.m .",
    "harrison , v.r .",
    "saunders , w.c .",
    "mackrodt and e. apr , phys .",
    "b * 50*:5041 - 5054 ( 1994 ) .",
    "r. ditchfield , w. j. hehre , and j. a. pople , j. chem . phys .",
    "* 54*:724 - 728 ( 1971 ) .",
    "a. kokalj , comp .",
    "28*:155 - 168 ( 2003 ) .",
    "g. schaftenaar and j. h. noordik , j. comput .- aided mol",
    ". design , * 14*:123 - 134 ( 2000 ) .",
    "x. xu and w. a. goddard iii , j. phys .",
    "a * 108*:2305 - 2313 ( 2004 ) .",
    "l. valenzano , f. j. torres a. , k. doll , f. pascale , c. m. zicovich - wilson and r. dovesi , z. phys .",
    "220*:893 - 912 ( 2006 ) .",
    "b. j. smith , d. j. swanton , j. a. pople , h. f. schafer iii , and l. radom , j. chem .",
    "phys . * 92*:1240 - 1247 ( 1990 ) .",
    "m. schtz , s. brdarski , p .- o .",
    "widmark , r. lindh , and g. karlstrm , j. chem . phys . * 107*:4597 - 4605 ( 1997 ) .",
    "k. s. kim , b. j. mhin , u - s .",
    "choi , and k. lee , j. chem .",
    "* 97*:6649 - 6662 ( 1992 ) . m. schtz , g. rauhut , and h .- j .",
    "werner , j. phys .",
    "a * 102*:5997 - 6003 ( 1998 ) w. klopper , j. g. c. m. van duijneveldt - van de rijdt and f. b. van duijneveldt , phys .",
    "* 2*:2227 - 2234 ( 2000 )",
    ". g. s. tschumper , m. l. leininger , b. c. hoffman , e. f. valeev , h. f. schaefer , and m. quack , j. chem . phys . * 116*:690 - 701 ( 2002 ) .",
    "j. a. anderson and g. s. tschumper , j. phys .",
    "a * 110*:7268 - 7271 ( 2006 ) .",
    "w. l. jorgensen , j. am . chem . soc . * 103*:335 - 340 ( 1981 ) .",
    "t. kiss and a. baranyai , j. chem . phys . * 131*:204310 ( 2009 ) .",
    "h. yu and w. van gunsteren , j. chem .",
    "phys . * 121*:9549 - 9564 ( 2004 )",
    ".    k. doll , v. r. saunders , n. m. harrison , int .",
    "j. quantum chem . * 82*:1 - 13 ( 2001 ) .",
    "k. doll , comp .",
    "137*:74 - 88 ( 2001 ) .",
    "b. civalleri , ph .",
    "darco , r. orlando , v. r. saunders , and r. dovesi , chem .",
    ". lett . * 348*:131 - 138 ( 2001 ) .",
    "l. a. curtiss , d. j. frurip , and m. blander , j. chem .",
    "phys . * 71*:2703 - 2711 ( 1979 ) .    v. r. saunders , c. freyria - fava , r. dovesi , and c. roetti , comp . phys",
    ". comm . * 84*:156 - 172 ( 1994 ) .",
    "s. le roux and v. petkov , j. appl .",
    "* 43*:181 - 185 ( 2010 ) .",
    "a. rahman and f. h. stillinger , j. chem . phys . * 55*:3336 - 3359 ( 1971 ) .",
    "w. l. jorgensen , j. chandrasekhar , j. d. madura , r. w. impey , and m. l. klein , j. chem .",
    "phys . * 79*:926 - 935 ( 1983 ) .",
    "m. sprik , j. phys . chem . * 95*:2283 - 2291 ( 1991 ) .",
    "k. laasonen , m. sprik , m. parrinello , and r. car , j. chem .",
    "phys , . * 99*:9080 - 9089 ( 1993 )",
    ". s. izvekov and g. a. voth , j. chem . phys . * 116*:10372 - 10376 ( 2002 ) .",
    "j. vandevondele , f. mohamed , m. krack , j. hutter , m. sprik , and m. parrinello , j. chem . phys . * 122*:014515 ( 2005 ) .",
    "m. del ben , m. schnherr , j. hutter , and j. vandevondele , j. phys .",
    "* 4*:3753 - 3759 ( 2013 ) .",
    "r. e. bulo , b. ensing , j. sikkema , and l. visscher , j. chem .",
    "theory comput .",
    "* 5*:2212 - 2221 ( 2009 ) .",
    "r. e. bulo , c. michel , p. fleurat - lessard , and ph .",
    "sautet , j. chem .",
    "theory comput .",
    "* 9*:5567 - 5577 ( 2013 ) ."
  ],
  "abstract_text": [
    "<S> a qm / mm implementation for periodic systems is reported . </S>",
    "<S> this is done for the case of molecules and for systems with two and three - dimensional periodicity , which is suitable to model electrolytes in contact with electrodes . </S>",
    "<S> tests on different water - containing systems , ranging from the water dimer up to liquid water indicate the correctness of the scheme . </S>",
    "<S> furthermore , molecular dynamics simulations are performed , as a possible direction to study realistic systems . </S>"
  ]
}