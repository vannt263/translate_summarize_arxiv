{
  "article_text": [
    "modern sequencing technology is providing an increasingly detailed picture of the distribution of genes across a wide array of taxa .",
    "some molecular biologists have used these data to argue that unless ancestral genomes were considerably larger than present - day ones , extensive lateral gene transfer ( lgt ) must be invoked to explain the current distribution of genes @xcite , @xcite , @xcite .",
    "lgt is a process by which a gene ( or genes ) from one species is transferred into the genotype of another species by various genetic mechanisms .",
    "the extent of lgt is controversial , but it has been argued to be widespread in prokaryotes ( e.g. bacteria ) and during the earlier epochs of evolution , suggesting in turn that a network , rather than a tree , best describes the evolution of life  @xcite .    although the pattern of presence and absence of different genes across a set of species can suggest that lgt events occurred in the evolution of these species , another explanation is that certain genes are simply lost in different lineages . as a result ,",
    "various attempts to quantify the extent of lgt based on gene content have been developed , typically based either on most - parsimonious scenarios or on stochastic models of gene genesis , loss and transfer ( see , for example , @xcite , @xcite , @xcite ) .",
    "attempts to reconstruct evolutionary histories under the assumption that no lgt events have occurred ( and that genes arise just once ) imply that some common ancestors of the considered species must have had far more genes than their current - day descendants .",
    "@xcite refer to such an unlikely all - encompassing ancestral genome as the ` genome of eden ' hypothesis .",
    "allowing lgt events reduces the need for genes to be present at earlier species , as illustrated for a single gene in fig .",
    "[ intro ] .    in this paper",
    ", we exploit the combinatorial structure that underlies a key biological insight on which a recent heuristics analysis of data was based by @xcite ( see also @xcite , @xcite ) .",
    "this insight is that simple models of gene evolution , in which a gene typically arises just once ( gene genesis ) but can be lost multiple times , imply lower bounds on the extent of lgt simply to prevent hypothetical ancestral genomes from becoming unfeasibly large .",
    "for such a model , we aim to bound the number of gene transfer events that have occurred in the evolution of a set of taxa , based on the presence / absence patterns of genes in each of these taxa , assuming that ancestral genomes are bounded by a given size .",
    "notice that we wish to count transfer events ( rather than the total number of genes that are transferred ) , since in each transfer event , several genes may be transferred from one species into another .",
    "thus our count of lgts is conservative , and recognizes that genes are not independently transferred and that a transfer event may insert a section of the genome ( with several genes ) into an individual organism of a different species .",
    "the structure of this paper is as follows . in the next section ,",
    "we define the model of gene genesis , loss and transfer precisely , and summarize our main results .",
    "we then provide proofs of these results in subsequent sections , and end with some concluding comments and a conjecture .",
    "we begin by recalling some notation concerning digraphs , and phylogenetic trees and networks .",
    "let @xmath0 be a vertex of a digraph @xmath1 .",
    "the _ indegree _ of @xmath0 is the number of arcs directed into @xmath0 , while the _ outdegree _ of @xmath0 is the number arcs directed out of @xmath0 .",
    "the indegree of @xmath0 is denoted by @xmath2 and the outdegree of @xmath0 is denoted by @xmath3 .",
    "the _ degree _ of  @xmath0 is  @xmath4 .",
    "furthermore , @xmath5 is an _ in - neighbour _ of @xmath0 if @xmath6 is an arc in @xmath1 , while @xmath7 is an _ out - neighbour _ of @xmath0 if @xmath8 is an arc in @xmath1 .",
    "a digraph @xmath1 is _ rooted _ if there exists a vertex , @xmath9 say , of indegree zero such that , for each vertex @xmath0 in @xmath1 , there exists a directed path from @xmath9 to @xmath0 .    throughout the paper",
    ", @xmath10 will denote a finite set of taxa and @xmath11 will denote a finite set of genes .",
    "a _ phylogenetic tree ( on @xmath10 ) _ is a rooted tree whose root has degree at least two and all other internal vertices have degree at least three , and whose leaf set is @xmath10 .",
    "more generally , a _",
    "phylogenetic network @xmath12 ( on @xmath10 ) _ is a rooted acyclic digraph with the following properties :    * the root has outdegree at least two and , for all vertices @xmath0 with @xmath13 , we have @xmath14 ; and * the set of vertices of outdegree zero is @xmath10 .",
    "the elements of @xmath10 are the _ leaves _ of @xmath12 . for a subset @xmath15 of the vertex set of @xmath12 , the sub - digraph of @xmath16 _ induced by @xmath15 _",
    "is the digraph whose vertex set is @xmath15 , and whose arc set is the subset @xmath17 of @xmath18 .",
    "we now describe the model of gene genesis , loss , and transfer . for each taxon",
    "@xmath19 , assume that the subset @xmath20 of @xmath11 consisting of the genes in @xmath11 that have been observed in taxon @xmath21 is known .",
    "we refer to the associated map @xmath22 as a",
    "_ genome assignment_. let  @xmath16 be a phylogenetic network on @xmath10 .",
    "for a fixed positive integer @xmath23 , and a genome assignment @xmath24 , a _",
    "@xmath25-gene labelling of @xmath12 _ is a mapping @xmath26 such that the following hold :    * @xmath27 for each @xmath19 ; * @xmath28 for all @xmath29 ; * for each gene @xmath30 , the sub - digraph of @xmath12 induced by @xmath31 is rooted ( and therefore connected ) .    note that if @xmath32 and @xmath33 , then @xmath12 has no @xmath25-labelling .",
    "if @xmath12 has a @xmath25-labelling , we say that @xmath12 _ exhibits _ such a labelling .",
    "a gene labelling describes a possible evolution of the genes observed in the taxa under consideration .",
    "property ( i ) says that each leaf of the network is labelled by the set of genes observed in the corresponding taxon .",
    "property ( ii ) demands that each vertex is labelled by a set of at most  @xmath23 genes ; the parameter @xmath23 thus bounds the sizes of the ancestral genomes .",
    "lastly , ( iii ) , means that each gene in @xmath11 is created once at most .",
    "there is no restriction on the number of times a gene is lost .",
    "any function @xmath34 which satisfies properties @xmath35 and @xmath36 we will call a _",
    "@xmath37-gene labelling_. with these definitions in hand we can now state the main results of this paper .",
    "our first result establishes lower and upper bounds on the number of lgt events required to explain a given data set .",
    "suppose our input is given by a rooted phylogenetic tree @xmath38 on @xmath10 ( `` species tree '' ) , a genome assignment @xmath22 , and a positive integer @xmath23 .",
    "given a phylogenetic network  @xmath12 , we say that  @xmath12 can be obtained from  @xmath38 by _ adding _",
    "@xmath39 _ arcs _ , if there is a subgraph  @xmath40 of  @xmath12 that is a subdivision of  @xmath38 ( i.e.  @xmath40 can be obtained from  @xmath38 by replacing arcs by directed paths ) and  @xmath39 arcs of  @xmath12 are not arcs of  @xmath40 . here",
    ", one views these added arcs as lgt events .",
    "we are interested in the minimum number of lgt events that must be added to @xmath38 in order for the resulting network to exhibit a @xmath25-gene labelling .",
    "we denote this minimum number by @xmath41 .",
    "given the above input , theorem  [ prop : lb ] provides lower and upper bounds for @xmath41 . for a vertex @xmath0 of @xmath38 , let @xmath42 denote",
    "the number of genes @xmath30 for which there exist two leaves @xmath43 such that @xmath44 , @xmath45 and the most recent common ancestor of  @xmath46 and  @xmath47 in  @xmath38 is  @xmath0 .",
    "[ prop : lb ] let @xmath48 be a rooted phylogenetic tree on @xmath49 , let @xmath11 be a set of genes , let @xmath22 be a genome assignment , and let @xmath23 be a positive integer . then :    * @xmath50 .",
    "* @xmath51 .",
    "the proof of theorem  [ prop : lb ] is given in section  [ boundproof ] .",
    "the next two results show that two fundamental decision questions concerning the existence of @xmath52)-labellings are np - complete .",
    "first , consider the following problem :    lp0.85 + _ given : _ & a phylogenetic network @xmath12 on @xmath10 , a finite set @xmath53 of genes , a genome assignment @xmath54 , and a positive integer @xmath23 .",
    "+ _ question : _ & does @xmath12 exhibit a @xmath25-labelling ?",
    "+    [ prop : homeomorphism ] the decision problem gene labelling is np - complete even if @xmath55 .    a related problem , but concerning rooted phylogenetic trees , is the following :    lp0.85 + _ given : _",
    "& a finite set @xmath56 of taxa , a finite set @xmath53 of genes , a genome assignment @xmath54 , and a positive integer @xmath23 . + _ question : _ & does there exist a rooted phylogenetic tree @xmath12 on @xmath10 that exhibits a @xmath25-labelling ?",
    "+    [ gktree ] the decision problem @xmath25-tree is np - complete .    the proofs of these two theorems are established section  [ unravel ] .      despite the apparent intractability of the two problems described above , there are instances for which there exist polynomial - time algorithms .",
    "several such instances are described in section  [ easysec ] .",
    "one in particular is given next .",
    "let @xmath12 be a phylogenetic network on @xmath10 .",
    "a sequence of vertices and arcs is an _ underlying cycle _ of @xmath12 if it is a cycle of the underlying graph ( i.e the undirected graph obtained by ignoring the directions of the arcs ) . a phylogenetic network @xmath12 on @xmath10 is a _ galled tree _ if , for each pair @xmath57 and @xmath1 of underlying cycles , the vertex sets of @xmath57 and @xmath1 are disjoint .",
    "each such cycle is called a _ gall_. theorem  [ prop : level1 ]",
    "shows that restricting the phylogenetic networks in gene labelling to galled trees , the decision problem becomes polynomial - time solvable .",
    "[ prop : level1 ] let @xmath12 be a galled tree on @xmath10 , let @xmath11 be a set of genes , let @xmath22 be a genome assignment , and let @xmath23 be a positive integer .",
    "then there is a polynomial - time algorithm for deciding whether or not @xmath12 exhibits a @xmath25-gene labelling .",
    "theorem  [ prop : level1 ] , together with the following corollary , is established in section  [ easysec ] .",
    "[ gallcor ] let @xmath38 be a rooted phylogenetic tree on @xmath10 , let @xmath11 be a set of genes , let @xmath22 be a genome assignment , and let @xmath23 be a positive integer . if @xmath39 is a fixed positive integer , then there is a polynomial - time algorithm for deciding whether or not there is a galled tree @xmath12 on @xmath10 that can be obtained from @xmath38 by adding at most @xmath39 arcs and which exhibits a @xmath25-gene labelling .",
    "in this section , we prove theorem  [ prop : lb ] .    _ proof of theorem  [ prop : lb ] . _ for the proof of ( i ) , suppose that a network @xmath12 admitting a @xmath25-gene labelling can be obtained by adding @xmath41 arcs to  @xmath38 .",
    "it follows that there exists a tree  @xmath40 that is a subdivision of  @xmath38 and a subgraph of  @xmath12 .",
    "in other words ,  @xmath40 is an embedding of  @xmath38 in  @xmath12 .",
    "an arc of  @xmath12 is said to be an _",
    "lgt - arc _ if it is not an arc of  @xmath40 .",
    "consider two leaves  @xmath58 and their lowest common ancestor  @xmath0 in  @xmath40 .",
    "suppose that for a gene  @xmath59 we have  @xmath44 and  @xmath45 . since network  @xmath12 admits a  @xmath25-gene labeling  @xmath34 , there has to be an undirected path from  @xmath46 to  @xmath47 in  @xmath12 containing only vertices  @xmath5 with  @xmath60 .",
    "furthermore , at least one such undirected path has to consist of two directed paths , one ending in  @xmath46 and one ending in  @xmath47 , since the subgraph of  @xmath12 induced by  @xmath61 is rooted and hence contains a rooted tree .",
    "there are four possibilities .",
    "firstly , it is possible that this undirected  @xmath62-path passes through  @xmath0 , implying that  @xmath63 .",
    "the remaining three cases are illustrated in fig .",
    "[ fig : bound ] .",
    "the first case is that the undirected  @xmath62-path uses an lgt - arc  @xmath64 between two vertices  @xmath65 that have  @xmath0 as their lowest common ancestor in @xmath40 .",
    "a second possibility is that the path uses two lgt - arcs  @xmath66 and  @xmath67 such that  @xmath0 is the lowest common ancestor of  @xmath68 and  @xmath69 in  @xmath40 . finally , it is also possible that the path uses two lgt - arcs  @xmath70 and  @xmath67 such that  @xmath0 is the lowest common ancestor of  @xmath68 and  @xmath69 in  @xmath40 .",
    "thus , for any vertex  @xmath0 with  @xmath71 , there has to be either an lgt - arc  @xmath64 or two lgt - arcs  @xmath72 or two lgt - arcs  @xmath73 , with  @xmath68 and  @xmath69 two vertices that have  @xmath0 as their lowest common ancestor in  @xmath40 .    given a vertex  @xmath0 of  @xmath38",
    ", we say that an lgt - arc  @xmath74 _ satisfies _",
    "@xmath0 if  @xmath0 is the lowest common ancestor of  @xmath75 and  @xmath76 in  @xmath40 . since in a tree there is a unique lowest common ancestor , each single lgt - arc satisfies at most one vertex .",
    "furthermore , we say that a pair of lgt - arcs  @xmath77 _ satisfies _",
    "@xmath0 if  @xmath0 is the lowest common ancestor of either  @xmath75 and  @xmath78 , or of  @xmath79 and  @xmath76 or of  @xmath76 and  @xmath78 in  @xmath40 .",
    "it follows directly that each pair of lgt - arcs satisfies at most three vertices .",
    "since there are  @xmath41 lgt - arcs , in total at most @xmath80 vertices  @xmath0 with  @xmath71 can be satisfied . from the previous paragraph",
    "we know that each vertex  @xmath0 with  @xmath71 needs to be satisfied , either by a single lgt - arc or by a pair of lgt - arcs .",
    "it follows that there can be at most  @xmath80 vertices  @xmath0 with  @xmath71",
    ". part ( i ) follows by generously bounding  @xmath80 by  @xmath81 .    .",
    "the three cases apply , without loss of generality , whenever  @xmath44 ,  @xmath45 , but  @xmath82 , where  @xmath0 is the lowest common ancestor of  @xmath46 and  @xmath47 in  @xmath40 .",
    "straight lines denote arcs , while curves denote paths .",
    "solid curves are in  @xmath40 , while dotted lines / curves can be either in  @xmath40 or only in  @xmath12 . ]    for ( ii ) , we can construct a network  @xmath12 admitting a  @xmath25-gene labelling as follows .",
    "we select a set  @xmath83 of  @xmath23 arbitrary genes in  @xmath84 and set  @xmath85 for each internal vertex  @xmath0 of  @xmath38 .",
    "the third property of a  @xmath25-gene labelling is now satisfied for the genes in  @xmath83 . for the remaining  @xmath86 genes we do the following .",
    "we introduce  @xmath87 additional isolated vertices  @xmath88 and label these vertices by disjoint sets  @xmath89 that partition  @xmath90 and contain at most  @xmath23 genes each .",
    "finally , we add arcs from the root to each  @xmath91 and from each  @xmath91 to each leaf  @xmath21 with  @xmath92 .",
    "this leads to the claimed upper bound .    to improve upon this simple",
    "upper bound turns out to be challenging .",
    "this can perhaps be explained by the results in the next section , in which we show that , even if the network  @xmath12 is given and  @xmath55 , it is np - complete to decide if a  @xmath25-gene labelling of  @xmath12 exists .",
    "we begin this section by first showing that gene labelling is np - complete .",
    "first consider the following decision problem :    lp0.85 + _ given : _ & directed acyclic graphs  @xmath93 and @xmath94 with @xmath95 .",
    "+ _ question : _ & is  @xmath96 homeomorphic to a subgraph of  @xmath1 ? +    a graph  @xmath96 is _ homeomorphic _ to a graph  @xmath97 if  @xmath97 can be obtained from  @xmath96 by replacing arcs  @xmath6 by internally vertex - disjoint directed  @xmath98 paths .",
    "hence , dash can be seen as a disjoint - paths problem .",
    "the graph  @xmath96 is called the `` pattern graph '' .",
    "it was observed by fortune et al .",
    "@xcite that np - hardness of dash follows from a result of even , itai , and shamir  @xcite on multi - commodity flows",
    ".    * theorem  [ prop : homeomorphism ] . * _ the decision problem gene labelling is np - complete even if @xmath55 . _",
    "_ the reduction is from dash .",
    "let @xmath99 be an instance of dash .",
    "we begin by showing that we may assume , for each vertex @xmath5 in @xmath96 , we have @xmath100 . to see this ,",
    "let @xmath101 and @xmath102 be the digraphs obtained from @xmath1 and @xmath96 , respectively , by iteratively doing the following for each vertex @xmath0 in @xmath96 :    * let @xmath103 be the set of in - neighbours of @xmath0 in @xmath96 and let @xmath104 be the set of out - neighbours of @xmath0 in @xmath96 .",
    "* in @xmath96 , replace @xmath0 and the arcs @xmath105 and @xmath106 with the new vertices @xmath107 and the new arcs @xmath108 and @xmath109 . *",
    "let @xmath110 be the set of in - neighbours of @xmath0 in @xmath1 and let @xmath111 be the set of out - neighbours of @xmath0 in @xmath1 .",
    "* in @xmath1 , replace @xmath0 and the arcs @xmath112 and @xmath113 with the new vertices @xmath107 and the new arcs @xmath114 and @xmath115    at the end of this iterative construction , for each vertex @xmath5 in @xmath102 , we have @xmath116 . moreover , it is straightforward to check that @xmath102 is homeomorphic to a subgraph of @xmath101 if and only if @xmath96 is homeomorphic to a subgraph of @xmath1 .",
    "it now follows that we may assume that our given instance @xmath99 of dash is of the form at the completion of this construction .",
    "we next describe a polynomial - time transformation of our instance @xmath99 of dash into an instance of gene labelling with @xmath55 .",
    "set @xmath55 .",
    "we define @xmath12 , @xmath56 , @xmath53 , and the function @xmath117 iteratively as follows .",
    "initially , set @xmath56 and @xmath53 to be both empty .",
    "let @xmath12 be the phylogenetic network obtained from @xmath118 by applying the following sequence of operations :    * for each arc @xmath119 of @xmath96 , add a new gene @xmath120 to @xmath53 , add new leaf vertices @xmath121 to @xmath122 and to @xmath56 , add new arcs @xmath123 and @xmath124 to @xmath18 , and set @xmath125 .",
    "furthermore , delete all incoming arcs of @xmath5 from @xmath18 . at the end of ( i ) , the constructions of the sets @xmath56 and @xmath53 , and the function @xmath117 are completed . *",
    "repeatedly remove all leaves of the resulting network not in @xmath56 and repeatedly remove all vertices of indegree zero that do not have an element of @xmath56 as a child .",
    "* finally , root the resulting network by choosing a vertex of indegree zero as a root and then adding an arc from this root to each other vertex of indegree zero . setting @xmath12 to be the resulting phylogenetic network on @xmath56",
    ", we have now constructed the desired instance of gene labelling .",
    "an example of this construction is shown in fig .",
    "[ fig : homeomorphism ] .",
    "note that , while @xmath1 may not be connected , @xmath12 is connected because of ( o - iii ) .",
    "we complete the proof by showing that @xmath12 admits a @xmath126-gene labelling if and only if @xmath96 is homeomorphic to a subgraph of @xmath1 .    .",
    "from an instance  @xmath127 of dash , a phylogenetic network  @xmath12 is constructed with leaf - labelling  @xmath125 and  @xmath128 .",
    "disjoint paths  @xmath129 and  @xmath130 in  @xmath1 correspond to a labelling  @xmath131 . ]",
    "suppose that  @xmath96 is homeomorphic to a subgraph of  @xmath1 .",
    "then , for each arc  @xmath119 of  @xmath96 , there exists a directed  @xmath98 path in  @xmath1 such that all these directed paths are pairwise vertex disjoint .",
    "we first claim that for each such  @xmath98 path in  @xmath1 , there exists a corresponding  @xmath98 path in  @xmath12 . to see this , observe that , in the construction of  @xmath12 from  @xmath1 , the only arcs deleted are those arcs directed into a vertex , @xmath5 say , for which @xmath5 is a vertex in @xmath96 , and arcs incident with a vertex , @xmath7 say , for which either there is no directed path from @xmath7 to a vertex in @xmath56 or there is no directed path from a parent of a vertex in @xmath56 to @xmath7 .",
    "none of these deletions deletes an arc on any @xmath98 path in @xmath1 and so the claim holds .",
    "now , for each arc  @xmath119 of  @xmath96 and for each vertex  @xmath7 on the associated  @xmath98 path in  @xmath12 , set  @xmath132 . since the children  @xmath133 of  @xmath5 and  @xmath134 of  @xmath0 are the only other vertices with a label containing  @xmath120 , the subgraph of  @xmath16 induced by  @xmath135 is rooted and connected .",
    "labelling all remaining vertices  @xmath7 by  @xmath136 thus leads to a  @xmath126-gene labelling of  @xmath12 .",
    "now suppose that  @xmath34 is a  @xmath126-gene labelling of  @xmath12 . it remains to show that  @xmath96 is homeomorphic to a subgraph of  @xmath1 .",
    "consider a gene  @xmath137 , and let @xmath119 be the associated arc of  @xmath96 .",
    "since  @xmath34 is a  @xmath126-gene labelling , the subgraph of  @xmath12 induced by @xmath138 is connected .",
    "furthermore , each of the arcs added in ( o - iii ) in the construction of @xmath12 joins two vertices that are assigned distinct genes in @xmath53 by @xmath34 as @xmath34 is a @xmath126-labelling of @xmath12 .",
    "thus none of these arcs are contained in the subgraph of  @xmath12 induced by  @xmath138 .",
    "since  @xmath5 has no other incoming arcs ,  @xmath5 has indegree zero in this subgraph .",
    "since the child  @xmath134 of  @xmath0 is also labelled  @xmath139 , it follows that  @xmath12 contains a directed path from  @xmath5 to  @xmath0 whose vertices are assigned @xmath140 under @xmath34 .",
    "this path is also a directed path in @xmath1 . moreover , for two distinct genes @xmath141 , these paths are pairwise disjoints and so they are pairwise disjoint in @xmath1 .",
    "the union of these paths in @xmath1 forms a subgraph  @xmath97 of  @xmath1 such that  @xmath96 is homeomorphic to  @xmath97 .",
    "this completes the proof of the theorem .",
    "we turn now to the proof of theorem  [ gktree ] , which is based on the concepts of tree - width and tree - decomposition from graph theory ",
    "we define these notions now ; for further background the interested reader may wish to consult  @xcite .",
    "a _ tree decomposition _ of a graph  @xmath142 is a pair  @xmath143 where  @xmath144 is a tree and , for all @xmath145 , the set @xmath146 is a subset of @xmath147 such that :    * @xmath148 ; * for each  @xmath149 , there exists an  @xmath145 with  @xmath150 ; * for each  @xmath151 , the subgraph of  @xmath38 induced by  @xmath152 is connected .",
    "the _ width _ of the tree decomposition is defined as @xmath153 .",
    "we use the following np - complete problem for the reduction in the proof of the theorem .",
    "lp0.85 + _ given : _ & an undirected graph  @xmath142 and a natural number  @xmath154 .",
    "+ _ question : _ & does there exist a tree decomposition of  @xmath97 with width at most  @xmath154 ?",
    "+    * theorem  [ gktree ] . * _ the decision problem @xmath25-tree is np - complete . _    _ proof . _",
    "the reduction is from treewidth .",
    "let @xmath155 be an instance of treewidth , and set @xmath156 , @xmath157 , @xmath158 for each edge @xmath159 , and @xmath160 .",
    "we complete the proof by showing that there exists a tree decomposition of  @xmath97 with width at most  @xmath154 if and only if there exists a phylogenetic tree  @xmath12 on  @xmath49 that admits a  @xmath25-gene labelling .",
    "firstly , let  @xmath143 be a tree decomposition of  @xmath97 with width  @xmath154 . for each  @xmath161",
    ", there exists an  @xmath145 with  @xmath150 .",
    "hence , for each taxon  @xmath162 , there exists a vertex  @xmath163 of  @xmath38 with  @xmath164 .",
    "we construct  @xmath12 from  @xmath38 by choosing an arbitrary vertex as a root , directing all edges away from the root and , for each  @xmath165 , adding a leaf  @xmath21 and an arc  @xmath166 where @xmath163 is an arbitrary vertex of  @xmath38 with @xmath164 . repeatedly deleting leaves not in @xmath56 , set @xmath12 to be the resulting rooted phylogenetic tree on @xmath56 .",
    "we can now obtain a  @xmath25-gene labelling  @xmath34 of  @xmath12 by setting  @xmath27 for each leaf  @xmath165 and  @xmath167 for each other vertex .",
    "for each gene  @xmath59 , the subgraph of  @xmath168 induced by  @xmath31 is connected by property ( iii ) of a tree decomposition , and is rooted as  @xmath12 is a rooted phylogenetic tree .    now suppose that there exists a phylogenetic tree  @xmath12 on  @xmath49 and a  @xmath25-gene labelling  @xmath34 of  @xmath16 .",
    "then we can obtain a tree decomposition @xmath169 of  @xmath97 by setting  @xmath170 and @xmath171 for all @xmath145 , and defining  @xmath38 to be the tree obtained from @xmath12 by ignoring the rooting and thus orientation of each of the arcs .",
    "all properties of a tree decomposition are clearly satisfied , and the width is at most  @xmath172 because  @xmath173 by the definition of a  @xmath25-gene labelling .",
    "let @xmath12 be a galled tree on @xmath10 , let @xmath11 be a set of genes , let @xmath54 be a genome assignment , and let @xmath23 be a positive integer .",
    "the main result of this section shows that there is a polynomial - time algorithm for deciding whether @xmath12 exhibits a @xmath25-labelling .",
    "if @xmath12 is a phylogenetic tree , then this problem is equivalent to deciding if @xmath175 .",
    "let @xmath38 be a phylogenetic tree on @xmath10 , let @xmath11 be a set of genes , let @xmath54 be a genome assignment , and let @xmath23 be a positive integer .",
    "then there is a polynomial - time algorithm for deciding whether @xmath176 .",
    "[ zero ]    deciding whether @xmath176 is equivalent to deciding if @xmath38 has a @xmath25-gene labelling . with this in mind",
    ", it is easily seen that the following @xmath37-gene labelling function @xmath34 of @xmath38 minimizes @xmath23 . for all @xmath29 , the gene @xmath177 is in @xmath178 precisely if @xmath0 is a vertex of the minimal subtree of @xmath38 that connects those leaves @xmath21 for which @xmath179 .",
    "if @xmath28 for @xmath0 , then @xmath34 is a @xmath25-gene labelling ; otherwise there is no such gene labelling of @xmath38 .",
    "proposition  [ one ] ( below ) establishes the main result when @xmath12 has exactly one gall .",
    "we will use this proposition as the base case for an inductive proof of the main result .",
    "the proof of this proposition relies on the following construction .",
    "let @xmath12 be a galled tree on @xmath10 with exactly one gall .",
    "thus the undirected graph underlying @xmath12 has exactly one cycle .",
    "label ( in order ) the vertices of this cycle @xmath180 , where @xmath181 is the unique vertex in @xmath12 with two arcs directed into it .",
    "let @xmath182 be the following map from the vertex set @xmath122 of @xmath12 to @xmath183 . for each @xmath29 , the gene @xmath177 is in @xmath184 precisely if , ignoring the direction of the arcs , either :    * there is a pair of leaves @xmath46 and @xmath47 with @xmath44 and @xmath45 , and @xmath0 is on a path between @xmath46 and @xmath47 that avoids @xmath181 , or * there is a pair of leaves @xmath46 and @xmath47 with @xmath44 and @xmath45 , and @xmath0 is on _ all _ paths between @xmath46 and @xmath47 .",
    "the following two observations are important for what follows .",
    "first , if @xmath34 is a @xmath37-gene labelling of @xmath12 , then it is easily seen that @xmath185 for all @xmath29 .",
    "second , @xmath182 is not necessarily a @xmath37-gene labelling of @xmath12 .",
    "the exact reason for this is that there can be a gene @xmath177 such that the sub - digraph of @xmath12 induced by @xmath186 consists of two rooted connected components ; one lying below @xmath181 ( more precisely , in the subgraph of @xmath12 induced by the vertices that are reachable from @xmath181 by a directed path ) and at one lying above @xmath181 ( more precisely , in the subgraph of @xmath12 induced by the vertices that are not reachable from @xmath181 by a directed path ) .",
    "now let @xmath187 be the subset of genes @xmath177 for which the sub - digraph of @xmath12 induced by @xmath186 is disconnected .",
    "we extend @xmath182 to a @xmath37-gene labelling @xmath34 of @xmath12 by reformulating the problem as an undirected network flow problem and then using its solution to identify the extension . here",
    "one can view each edge @xmath188 as the two arcs @xmath66 and @xmath70 .",
    "we construct an undirected graph @xmath15 from @xmath12 by starting with the sub - digraph of @xmath12 induced by @xmath189 and ignoring the direction of the arcs , adding a source vertex @xmath75 , and , for each gene  @xmath190 , adding a new vertex @xmath191 and the three edges @xmath192 , @xmath193 , and @xmath194 , where @xmath195 and @xmath196 are the smallest and largest index @xmath197 for which @xmath198 .",
    "now assign each @xmath191 capacity @xmath199 and , for each @xmath200 , assign @xmath201 capacity @xmath202 .    to illustrate the above construction ,",
    "consider the galled tree @xmath12 shown in fig .",
    "[ fig : exampleinput ] . each leaf @xmath21 of @xmath12",
    "is labelled by the set @xmath20 of input genes observed in the corresponding taxon .",
    "the map @xmath182 is shown in fig .",
    "[ fig : fstar ] . the undirected graph @xmath15 with @xmath203",
    "is shown in fig .",
    "[ fig : auxgraph ] .      with one gall .",
    "each leaf @xmath21 of @xmath12 is labelled by @xmath20 .",
    "( b ) the initial labelling  @xmath182 in which , for example , the sub - digraph of @xmath12 induced by @xmath204 ( displayed by the dashed arcs and their end vertices ) consists of two connected components .",
    "( c ) auxiliary graph @xmath15 with capacities in parentheses .",
    "( d ) a @xmath205-gene labelling of @xmath12 .",
    "this gene labelling corresponds to a maximum flow in @xmath15 which sends one unit of flow through @xmath206 and @xmath207 and one unit of flow through @xmath208 and @xmath209 .",
    ", title=\"fig : \" ] [ fig : exampleinput ]      with one gall .",
    "each leaf @xmath21 of @xmath12 is labelled by @xmath20 .",
    "( b ) the initial labelling  @xmath182 in which , for example , the sub - digraph of @xmath12 induced by @xmath204 ( displayed by the dashed arcs and their end vertices ) consists of two connected components .",
    "( c ) auxiliary graph @xmath15 with capacities in parentheses .",
    "( d ) a @xmath205-gene labelling of @xmath12 .",
    "this gene labelling corresponds to a maximum flow in @xmath15 which sends one unit of flow through @xmath206 and @xmath207 and one unit of flow through @xmath208 and @xmath209 .",
    ", title=\"fig : \" ] [ fig : fstar ]      with one gall .",
    "each leaf @xmath21 of @xmath12 is labelled by @xmath20 .",
    "( b ) the initial labelling  @xmath182 in which , for example , the sub - digraph of @xmath12 induced by @xmath204 ( displayed by the dashed arcs and their end vertices ) consists of two connected components .",
    "( c ) auxiliary graph @xmath15 with capacities in parentheses .",
    "( d ) a @xmath205-gene labelling of @xmath12 .",
    "this gene labelling corresponds to a maximum flow in @xmath15 which sends one unit of flow through @xmath206 and @xmath207 and one unit of flow through @xmath208 and @xmath209 .",
    ", title=\"fig : \" ] [ fig : auxgraph ]      with one gall .",
    "each leaf @xmath21 of @xmath12 is labelled by @xmath20 .",
    "( b ) the initial labelling  @xmath182 in which , for example , the sub - digraph of @xmath12 induced by @xmath204 ( displayed by the dashed arcs and their end vertices ) consists of two connected components .",
    "( c ) auxiliary graph @xmath15 with capacities in parentheses .",
    "( d ) a @xmath205-gene labelling of @xmath12 .",
    "this gene labelling corresponds to a maximum flow in @xmath15 which sends one unit of flow through @xmath206 and @xmath207 and one unit of flow through @xmath208 and @xmath209 .",
    ", title=\"fig : \" ] [ fig : fopt ]    there exists an integer flow in @xmath15 from @xmath75 to @xmath181 with value @xmath210 if and only if there exists a @xmath25-gene labelling of @xmath12 .",
    "moreover , if there is such an integer flow , then it leads to a @xmath25-gene labelling of @xmath12 .",
    "[ flow ]    first suppose that there exists such a flow @xmath211 with value @xmath210 .",
    "based on @xmath211 , we show that there exists a @xmath25-labelling @xmath34 of @xmath12 . for this existence proof",
    ", we assume that we know the path that each unit of flow takes .",
    "we will conclude the proof by showing how an actual @xmath25-labelling can be constructed .    initially set @xmath212 .",
    "since @xmath211 has value @xmath210 and each @xmath191 has capacity @xmath199 , there is exactly one unit of flow passing through @xmath191 from @xmath75 to @xmath181 .",
    "furthermore , as @xmath211 is integer , it uses exactly one of the two edges @xmath193 and @xmath194 . if @xmath211 uses @xmath193 , then the corresponding unit of flow either uses the vertices on the path from @xmath213 to @xmath181 through @xmath214 or the vertices on the path from @xmath213 to @xmath181 through @xmath215 . depending on which of these paths this unit of flow takes , add @xmath216 to @xmath217 for each of the vertices on this path .",
    "similarly , if @xmath211 uses @xmath194 , then the corresponding unit of flow either uses the vertices on the path from @xmath218 to @xmath181 through @xmath214 or the vertices on the path from @xmath218 to @xmath181 through @xmath215 . depending on which of these paths this unit of flow takes , add @xmath216 to @xmath217 for each of the vertices on this path . doing this for each @xmath219 , we claim that the resulting map @xmath26 is a @xmath25-labelling of @xmath12 .",
    "clearly , @xmath34 satisfies ( iii ) .",
    "furthermore , as each vertex @xmath201 has capacity @xmath202 , the cardinality of @xmath217 is at most @xmath23 .",
    "thus @xmath34 satisfies ( ii ) .",
    "it now follows that @xmath34 is a @xmath25-labelling of @xmath12 .",
    "now suppose that there exists a  @xmath25-gene labelling @xmath34 of @xmath12 . by one of the two observations earlier ,",
    "@xmath185 for all @xmath29 .",
    "consider a gene @xmath219 .",
    "the sub - digraph of @xmath12 induced by @xmath186 consists of two rooted connected components .",
    "however , by ( iii ) , the sub - digraph of @xmath12 induced by @xmath31 is rooted and connected .",
    "therefore , there is a path on the cycle consisting of vertices @xmath201 with @xmath220 that connects the two components . sending one unit of flow from @xmath75 to the first vertex on this path via @xmath191 , and then along this path to @xmath181 for each @xmath219 gives a desired integer flow .",
    "we have now shown that if there is an integer flow @xmath211 from @xmath75 to @xmath181 with value @xmath210 , then there is a @xmath25-labelling of @xmath12 .",
    "this does not directly give such a labelling as we can make no distinction on the flow units .",
    "in particular , it is not directly clear which of the two paths a flow unit takes once it reaches a vertex @xmath201 in the cycle .",
    "this can be rectified as follows .",
    "let @xmath211 be such a flow and let @xmath219 . ignoring the vertices @xmath221",
    ", either the flow unit through @xmath191 takes the path from @xmath213 to @xmath181 via @xmath207 or the path from @xmath218 to @xmath181 via @xmath222 . to make this decision ,",
    "consider the following modification of the integer flow problem .",
    "extend @xmath182 to @xmath223 by adding @xmath216 to each of @xmath224 and , for each of these vertices , subtract one from their capacities .",
    "if there is an integer flow from @xmath75 to @xmath181 in @xmath225 of @xmath226 units , then we may assume that the unit of flow through @xmath191 in @xmath15 follows the path from @xmath213 to @xmath181 via @xmath222 . in this case ,",
    "replace @xmath182 with @xmath223 and @xmath15 with @xmath225 , and repeat for another element in @xmath227 .",
    "if there is no such integer flow in @xmath225 , then the unit of flow through @xmath191 in @xmath15 follows the path from @xmath218 to @xmath181 via @xmath222 . in this second case ,",
    "replace @xmath182 with that obtained by adding @xmath216 to each of @xmath224 and , for each of these vertices , subtract one from their capacities , and replace @xmath15 with @xmath225 .",
    "continuing in this way , we eventually obtain a @xmath25-labelling of @xmath12 .    to illustrate lemma  [ flow ] and its proof , consider the example prior to the lemma , illustrated in fig .",
    "[ fig : example ] . in @xmath15 ,",
    "a maximum flow could send either two units of flow through @xmath207 or one unit of flow through vertex @xmath207 and one unit of flow through vertex @xmath209 .",
    "from the latter option , one can for example obtain the @xmath205-gene labelling shown in fig .",
    "[ fig : fopt ] .",
    "let @xmath12 be a phylogenetic network on @xmath10 , let @xmath11 be a set of genes , let @xmath54 be a genome assignment , and let @xmath23 be a positive integer .",
    "* if @xmath12 is a galled tree with exactly one gall , then there is a polynomial - time algorithm for deciding whether @xmath12 exhibits a @xmath25-labelling , in which case , such a labelling can also be found in polynomial time . *",
    "if @xmath38 is a phylogenetic tree , then there is a polynomial - time algorithm for deciding whether @xmath228 .",
    "[ one ]    first note that a maximum - valued integer flow can be found in @xmath229 time  @xcite .",
    "thus , ( i ) follows from lemma  [ flow ] . for ( ii ) ,",
    "if @xmath230 , then there is @xmath231 possible ways of adding a single arc to @xmath38 .",
    "applying lemma  [ flow ] to each such way gives the desired algorithm .",
    "this completes the proof of the proposition .",
    "we now extend proposition  [ one](i ) to all galled trees using induction on the number of galls .",
    "let @xmath12 be a galled tree on @xmath10 , let @xmath11 be a set of genes , let @xmath54 be a genome assignment and let @xmath23 be a positive integer .",
    "if @xmath12 has either no galls or exactly one gall , then we have such an algorithm by propositions  [ zero ] and  [ one ] , so we may assume that @xmath12 has at least two galls . in this case there exists a vertex @xmath232 of @xmath12 with the property that , for some gall , each of the vertices in the vertex set of this gall are descendants of @xmath232 and no vertex that is a proper descendant @xmath232 has this property .",
    "let @xmath233 be the phylogenetic network obtained from @xmath12 by replacing @xmath232 and all of its descendants with a single vertex @xmath234 .",
    "let @xmath235 be the phylogenetic network obtained from @xmath12 by deleting all of the vertices of @xmath12 that are not descendants of @xmath232 and adjoining a parent vertex @xmath236 to @xmath232 with one further child other than @xmath232 .",
    "call the additional child vertex @xmath237 .",
    "let @xmath238 denote the leaf set of @xmath235 .",
    "effectively , we have partitioned @xmath12 into two phylogenetic networks @xmath233 and @xmath235 .",
    "see figure  [ fig : galledtree ] for an example .",
    "let @xmath239 the proof of the following lemma is straightforward , and so the details are omitted .     and the decomposition of  @xmath12 into  @xmath235 and  @xmath233 described in the text.,width=415 ]    the galled tree @xmath12 has a @xmath25-labelling if and only if each of @xmath233 and @xmath235 has a @xmath25-labelling .",
    "[ repeat ]    by proposition  [ one](i ) , there is a polynomial - time algorithm for deciding whether or not @xmath235 has a @xmath25-labelling .",
    "if there is no such labelling , then , by lemma  [ repeat ] , @xmath12 has no @xmath25-labelling . on the other hand ,",
    "if @xmath235 has a @xmath25-labelling , then one needs to check if @xmath233 has a @xmath25-labelling .",
    "now repeat the above construction with @xmath12 replaced by @xmath233 . continuing in this way ,",
    "we either find a galled tree with a single gall that does not exhibit a @xmath25-labelling , and thereby show that @xmath12 has no such labelling , or we find no such galled tree and conclude that @xmath12 has a @xmath25-labelling .",
    "note that the number of galls in @xmath12 is polynomial in the size of the vertex set of @xmath12 .",
    "in particular , we have established the following results .",
    "* theorem  [ prop : level1 ] * _ let @xmath12 be a galled tree on @xmath10 , let @xmath11 be a set of genes , let @xmath54 be a genome assignment , and let @xmath23 be a positive integer .",
    "then there is a polynomial - time algorithm for deciding whether @xmath12 exhibits a @xmath25-gene labelling . _    [ gallcor ]",
    "let @xmath38 be a rooted phylogenetic tree on @xmath10 , let @xmath11 be a set of genes , let @xmath54 be a genome assignment , and let @xmath23 be a positive integer . if @xmath39 is a fixed non - negative integer , then there is a polynomial - time algorithm for deciding whether or not there is a galled tree @xmath12 on @xmath10 that can be obtained from @xmath38 by adding at most @xmath39 arcs and which exhibits a @xmath25-gene labelling .",
    "suppose that  @xmath12 is a galled tree on  @xmath10 that can be obtained from  @xmath38 by adding at most  @xmath39 arcs .",
    "then there is an embedding  @xmath40 of  @xmath38 in  @xmath12 .",
    "notice that since  @xmath12 is a galled tree , it follows that all vertices of  @xmath12 are contained in  @xmath38 and thus that  @xmath12 can be obtained from  @xmath38 by subdividing at most  @xmath240 arcs and adding at most  @xmath39 arcs .    hence , given  @xmath38",
    ", we can try each possible way of subdividing at most  @xmath240 arcs and adding at most  @xmath39 arcs . for each such possibility , we check if the resulting network is a galled tree . in each such case",
    "we can check if a  @xmath25-gene labelling of this network exists , by theorem  [ prop : level1 ] .",
    "the time needed is polynomial in the size of the input , for each fixed  @xmath39 .",
    "the analysis of this paper rests on a number of assumptions concerning gene evolution .",
    "perhaps the most restrictive is the requirement that gene genesis is a unique event .",
    "this requirement reflects the fact that a gene is typically a long and fairly precise sequence of nucleotides , and the probability that a similar sequence could evolve independently in a different part of the tree is small .",
    "this seems reasonable if dna sequence evolution is described by a neutral model @xcite , but , in some cases , natural selection will , no doubt , direct the evolution of dna sequences towards certain genes that confer higher fitness . thus , simple arguments based on neutrality need to be treated with caution .",
    "it would be interesting to extend the analysis of this paper to allow for a small frequency of independent gene genesis events .",
    "a related question is what degree of sequence similarity is required in order to classify two sequences as coding for the same gene . insisting on exact sequence identity is too severe ,",
    "since it is well known that different species typically encode a gene with slightly different sequences that result from random site substitutions ( indeed these differences have been the main signal used for phylogenetic tree reconstruction @xcite ) .",
    "this question of gene identity is also relevant to the probability of independent gene genesis : a region of dna that codes for a gene could , in principle , accumulate sufficient site mutations to put it just outside the range of being identified with that gene , but could then mutate back within range , giving the appearance of a second gene genesis event",
    ".    other aspects of the model that may be criticized are the assumptions that the species tree is known with certainty ( or , indeed , that it is meaningful to talk of a ` species tree ' @xcite ) , and that the model does not penalize gene losses at all .",
    "our computational complexity results highlight that many problems are surprisingly difficult , even for a tree , and some questions still remain to be explored further .",
    "one that seems particularly interesting is described as follows , along with our conjecture as to its possible resolution .",
    "given a rooted phylogenetic tree  @xmath38 , a set of genes  @xmath20 for each leaf  @xmath21 of  @xmath38 , and natural numbers  @xmath23 and  @xmath39 , consider the problem of deciding whether it is possible to add at most  @xmath39 arcs to  @xmath38 to obtain a phylogenetic network  @xmath12 that admits a  @xmath25-gene labelling .",
    "doolittle , y. boucher , c. .",
    "nesb , c.j .",
    "douady , j. o. andersson , and a. j. roger , ( 2003 ) , how big is the iceberg of which organellar genes in nuclear genomes are but the tip ?",
    "b. 358 , 3958 .",
    "mirkin , t. i. fenner , m.y .",
    "galperin , and e.v .",
    "koonin , ( 2003 ) , algorithms for computing parsimonious evolutionary scenarios for genome evolution , the last universal common ancestor and dominance of lateral gene transfer in the evolution of prokaryotes , bmc evol .",
    "biol . 3 , 2 ."
  ],
  "abstract_text": [
    "<S> the complex pattern of presence and absence of many genes across different species provides tantalising clues as to how genes evolved through the processes of gene genesis , gene loss and lateral gene transfer ( lgt ) . </S>",
    "<S> the extent of lgt , particularly in prokaryotes , and its implications for creating a ` network of life ' rather than a ` tree of life ' is controversial . in this paper </S>",
    "<S> , we formally model the problem of quantifying lgt , and provide exact mathematical bounds , and new computational results . in particular , we investigate the computational complexity of quantifying the extent of lgt under the simple models of gene genesis , loss and transfer on which a recent heuristic analysis of biological data relied . </S>",
    "<S> our approach takes advantage of a relationship between lgt optimization and graph - theoretical concepts such as tree width and network flow . </S>",
    "<S> +    * keywords : * tree , phylogenetic network , lateral gene transfer , tree - width    * email : * l.j.j.v.iersel@gmail.com , c.semple@math.canterbury.ac.nz , m.steel@math.canterbury.ac.nz </S>"
  ]
}