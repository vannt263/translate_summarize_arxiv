{
  "article_text": [
    "a central goal in complex systems research is to understand how macroscopic transitions arise from the microscopic interactions within a system  @xcite . in this context",
    "an important role is played by coarse - grained models , describing the system in terms of a set of ordinary differential equations ( odes )  @xcite . by capturing the dynamics of the system in terms of a suitable set of variables ,",
    "it is sometimes possible to construct a faithful model of a given transition that is easy enough to be tractable by the tools of nonlinear dynamics . in the analysis",
    "the transition then appears as a bifurcation , whose study reveals deep insights into the nature and behaviour of the underlying microscopic system .",
    "a paradigmatic example is the epidemiological sis model  @xcite . in its simplest incarnation ,",
    "this model describes the propagation of an infectious disease in a group of randomly interacting agents .",
    "each agent is either infected with the disease ( state i ) or susceptible to the disease ( state s ) . in time , the state of agents changes due to transmission of the disease and recovery of infected agents .",
    "the dynamics of this system can be understood by writing a single differential equation that captures the proportion of agents @xmath0 $ ] that are infected .",
    "depending on the details of interactions the system either approaches a state where the disease is extinct or a state where it persists at a constant level . in the ode - based model ,",
    "the transition between the two qualitatively different types of behaviours occurs at a threshold parameter value that is a bifurcation point .    in the sis model , and many other models besides , the important bifurcation is local , i.e.  it is a bifurcation that can be characterised by changes in the phase portrait in the proximity of a single steady state or other invariant set  @xcite .",
    "for instance in the epidemic example this bifurcation is a transcritical bifurcation in which a steady state with non - zero density of infected agents intersects the state where the disease is extinct , and the two exchange their stability .",
    "thus the relevant changes in the phase portrait occur in the vicinity of the extinct steady state .",
    "the transcritical bifurcation and its close relatives , the fold and pitchfork bifurcations have been linked to phase transitions in a wide variety of systems including epidemics  @xcite , collective motion of animals  @xcite , human opinion formation  @xcite , neuronal dynamics  @xcite and others . in a smaller number of models the underlying bifurcation is a hopf bifurcation , which marks the onset of , at least transient , oscillations  @xcite .",
    "however , even the hopf bifurcation is a local bifurcation . by comparison models in which a phase - transition corresponds to a non - local bifurcation in a macroscopic model",
    "are rare .",
    "in nonlinear dynamics several non - local bifurcations have been described .",
    "an example of particular interest for the present paper is the heteroclinic bifurcation  @xcite . in this bifurcation",
    "a transition in the macroscopic dynamics of a system occurs , due to the appearance of a trajectory connecting different invariant sets ( see fig .",
    "[ figure1 ] ) .",
    "such bifurcations already occur robustly in relatively low - dimensional dynamical systems  @xcite .",
    "the closely related homoclinic bifurcation often marks the point where a limit cycle is destroyed and thus causes a discontinuous phase transitions in many systems .",
    "one of these is the adaptive sis model : an sis system , where additionally the susceptible nodes try to avoid infection by rewiring their links away from infected nodes  @xcite .    in the adaptive sis model the importance of",
    "the homoclinic bifurcation is very minor .",
    "the bifurcation can play the role of an epidemic threshold in a small parameter space , where it occurs close to a hopf bifurcation , such that very large simulations are needed to see the limit cycle .",
    "a homoclinic bifurcation was also found to enable a transition to full cooperation in a game theoretical model , but required global information transfer between agents  @xcite .",
    "homoclinics , heteroclinics , and other non - local bifurcations are also known to play a major role in fluid dynamics and climate system modelling  @xcite .",
    "perhaps the best known example is the lorenz model  @xcite .",
    "however , this model is directly formulated on the macroscopic level , such that no direct connection to the phase transition in the underlying microscopic dynamics can be made . by contrast , models that resolve the detailed dynamics are often too complex to reveal a detailed picture of heteroclinics in the dynamics by use of bifurcation theory .",
    "in a recent paper we investigated the dynamics of a heterogeneous adaptive sis model , which combined sis dynamics and disease avoidance behaviour with heterogeneity in the susceptibility of the population . both heterogeneity and adaptivity",
    "are known to impact the dynamics of diseases of humans  @xcite , and are therefore presently high on the agenda in network epidemiology .",
    "for instance adaptivity was shown to significantly increase the epidemic threshold and lead to a first - order transition at the onset of the disease  @xcite and can induce robust oscillations  @xcite .",
    "moreover , studies showed that adaptive disease avoidance behaviour can effectively enhance the impact of disease control efforts  @xcite .",
    "the heterogeneity between individuals was shown to lower the epidemic threshold in some networks  @xcite , but can also reduce the size and risk of outbreaks  @xcite    in  @xcite we found that a plausible disease avoidance mechanism can lead to states where the network has a heterogeneous topology , but is more resilient to the invasion of diseases than it would be possible in less heterogeneous topologies .",
    "these findings are thus contrary to the intuition gained from landmark results for simpler models  @xcite , which seem to suggest that heterogeneous topologies would always aid the transmission of the disease .    while our previous publication  @xcite pointed to a mechanism that leads to the emergence of extraordinarily stable heterogeneous topologies , the actual transition at which this mechanisms sets in was too complicated to analyze within the scope of that paper . here",
    "we investigate this transition first in the previously proposed model and then in a highly stylized model that enables a deeper understanding of the phenomenon .",
    "we find that the threshold for the onset of an endemic infection does not correspond to a loss of stability of the disease - free state . instead , there is a large parameter range in which initial disease - free networks are unstable and",
    "thus permit disease invasion , but outbreaks do not lead to an endemic state but collapse back to another disease - free state , with different network topology .",
    "the dynamics of the system in this region is thus reminiscent of an sir model .",
    "however , there is no recovered ( r ) agent state in the model that confers immunity .",
    "instead , an initial outbreak leads to the formation of more resilient network topologies , and thus `` inocculates '' the network against future disease invasion .",
    "network inocculation is characterized by the presence of heteroclinic orbits that connect different disease free states .",
    "because of the basic physics of the system the disease - free states form a manifold .",
    "when the infectivity of the disease is changed the orbit starting from a given initial steady state may connect to a ( unique ) saddle point . when this happens a saddle - heteroclinic bifurcation occurs , which ends the inocculation - type dynamics from the respective initial network .",
    "for all higher values of infectivitity the heteroclinic trajectory from that initial state leads to an endemic state where the disease can persist in the system indefinitely .",
    "thus the onset of endemic disease dynamics is marked by a phase transition caused by a heteroclinic bifurcation in the underlying dynamics .",
    "this paper is organized as follows : we start by reviewing the previously proposed model ( sec .",
    "[ secmodel ] ) . in agent - based simulations we observe that the outcomes of simulation runs can be classified into 3 different types ( sec .",
    "[ secclassification ] ) .",
    "we then explore the phase boundaries between the three different types of outcomes .",
    "using percolation theory we analytically compute the threshold where outbreaks start to occur ( sec .",
    "[ secpercolation ] ) .",
    "thereafter , using moment expansions , we formulate a macroscopic model of the dynamics in terms of ordinary differential equations ( sec .",
    "[ secmoments ] ) , this model allows us to study the dynamics by tools of dynamical systems theory . combining , results from all of the tools established up to this point we show that the transition from outbreaks to endemic behavior occurs due to a heteroclinic bifurcation ( sec .",
    "[ sectransition ] ) . to understand this transition in greater detail we finish by formulating and analzing a simpler solvable model for the network inocculation phenomenon ( sec .",
    "[ secsolvable ] ) .",
    "we consider a population of @xmath1 agents , which can be either infected ( state i ) or susceptible to the disease ( state s ) .",
    "the agents are connected by a total of @xmath2 bilateral social contacts .",
    "thus the system can be described as a network in which the the agents are the network nodes and the social contacts are the links . in time",
    "the system evolves ( a ) because of the epidemic dynamics , and ( b ) due to a behavioural response of the agents to the disease , which leads to the rewiring of links .",
    "during the course of the epidemic dynamics ( a ) for every link connecting a susceptible and an infected agent there is a chance that the susceptible agent becomes infected , amounting to an infection rate of @xmath3 ( per link ) , where @xmath4 is a parameter that controls the overall infectivity of the disease and @xmath5 is a parameter that describes the susceptibility of the susceptible agent . in particular , we consider the case where two types of agents exist : highly susceptible agents ( type a ) and less susceptible agents ( type b ) .",
    "these types are intrinsic properties of the agents , i.e.  unlike the epidemic states the type of an agent never changes .",
    "furthermore , all infected agents recover at a fixed rate @xmath6 , which is identical for all agents . upon recovery",
    ", agents immediately become susceptible again .",
    "we denote the proportion of agents of type a in the population by @xmath7 and their susceptibility by @xmath8 .",
    "the remaining portion of agents @xmath9 is of type b and has susceptibility @xmath10 . in the following we chose these parameters such that @xmath11 .",
    "we thus control the heterogeneity of susceptibility in the population by changing @xmath8 and @xmath12 simultaneously such that the mean susceptibility @xmath13 remains fixed .",
    "hence the intra - individual heterogeneity is indicated by one of the parameters , say @xmath8 , whereas the overall spreading rate is controlled by the epidemic parameter @xmath4 .    in the social dynamics ( b ) , the agents react to the presence of the disease by rewiring their social connections . in each small time interval of length @xmath14 , a susceptible agent who is linked to an infected agent breaks that link with probability @xmath15 . for every link",
    "a susceptible agent breaks it and establishes a new link to a randomly chosen susceptible agent , such that the total number of links is conserved .    in the following ,",
    "we use the parameters @xmath16 , @xmath17 , @xmath18 , @xmath19 and @xmath20 unless noted otherwise .",
    "we start the analysis by numerically exploring the possible outcomes in agent - based simulations .",
    "we initialize the system as a erds - rnyi random graph , where each agent is initially infected with probability @xmath21 and susceptible otherwise .",
    "we then simulate the time evolution of the system of agents using a gillespie algorithm  @xcite .",
    "three typical outcomes are shown in fig .",
    "[ figure2 ] . depending on the parameter values ,",
    "we observe either a rapid collapse to a disease - free state , before a significant proportion of the agents have been infected ( type i ) , an initial epidemic outbreak , in which a large proportion of agents are infected ( type ii ) , or an outbreak leading to an endemic state where the disease persists indefinitely ( type iii ) .",
    "let us try to extrapolate from the finite - size simulation to arbitrarily large systems .",
    "the results of this analysis should hold in large finite systems encountered in the real world or studied in large agent - based simulations , where finite size effects are mostly irrelevant , due to the size of the system considered .",
    "referring to an infinitely large system is attractive because it allows us to avoid problems in the classification of behaviours that exist in the finite system .",
    "consider that in the finite case the difference between type i ( recovery to the disease - free state ) behaviour and type ii ( outbreak , collapse ) behaviour is not rigorously defined , i.e.  the transition is gradual as the number of infected at maximum increases .",
    "furthermore , even the difference between type ii and type iii ( persistent ) behaviour becomes fuzzy : the finite size agent - based simulation has a finite probability to spontaneously collapse to the absorbing disease - free state .",
    "thus persistent dynamics can not be a true long - term behaviour , although we never observed such a collapse of apparently persistent epidemics in all but the smallest simulation runs ( e.g.  @xmath22 ) or when the system is just at the epidemic threshold .",
    "by contrast , the different types of behaviour can be cleanly defined in the infinite system .",
    "we say that the behavior of the system is of type i , if the epidemic never grows to a point where a finite proportion of the agents is infected .",
    "this makes type i behavior qualitatively different from type ii and type iii , where the at some point a finite proportion of the agents is infected .",
    "we further distinguish type ii and type iii behaviour by their long - term behavior : we can say that a system shows type iii behavior if in the infinite size limit , a finite proportion of the agents are infected after arbitrarily long time .    now returning to finite systems ,",
    "the considerations above enable us to classify the dynamics using scaling relationships .",
    "however , in practice this is not necessary as the differences in sufficiently large simulations are clear cut .",
    "results from simulations with @xmath23 nodes in fig .",
    "[ figure3 ] show that the three types of outcomes can be clearly distinguished .",
    "we observe that in some ranges of infectivity different types of outcomes are possible . to explore this in more detail",
    "we use the proposed classification to plot the propensity of outcomes in fig .",
    "[ figure4 ] . for low values of heterogeneity between nodes @xmath24",
    "we find that for systems there are only two possible outcomes , namely type i ( recovery ) and type iii ( endemic ) behavior .",
    "however , if the susceptibility of agents is very heterogeneous then also type ii ( outbreak , collapse ) behavior is observed .    in fig .",
    "[ figure4 ] we see that regions of different types of outcomes are separated by transition regions where 2 outcomes are possible . to prepare for the more detailed exploration below ,",
    "let us now construct a 2-parameter phase diagram of the system ( fig .  [ figure5 ] ) . in this diagram",
    "we draw the phase boundaries at the points where different type of outcome occurs in simulation , e.g.  the phase boundary between outcomes of type i and type ii @xmath25 is set of points where type ii outcome starts to show up and the same to phase boundary between type ii and type iii @xmath26 .",
    "let us now try to understand the phase diagram analytically .",
    "we start by considering the onset of outbreaks , i.e.  the boundary of type i behaviour .",
    "the ability of a disease to spread in a population can be quantified in terms of the basic reproductive number @xmath27 , which denotes the number of secondary infections , caused by one infected , in the limit of low disease prevalence . if @xmath28 the disease can percolate through the network , and thus outbreaks become possible .",
    "we can compute @xmath27 by considering a typical newly infected agent and computing the number of neighbours this agent will infect before recovering . following",
    "@xcite we take into account that the number of links of the focal agent decreases in time as neighbouring agents rewire away .",
    "the loss rate of links is equal to the rewiring rate @xmath29 .",
    "thus the remaining degree after time @xmath30 is @xmath31 where @xmath32 is the initial number of neighbours .",
    "since we are interested in the limit of low prevalence , all neighbors can be assumed to be susceptible and we can find the number of secondary infections by multiplying the probability of transmission , which we call @xmath33 for the moment , and then integrating over the typical time to recovery @xmath34 .",
    "this yields @xmath35 for the heterogeneous network , we can express the probability of transmission @xmath33 as @xmath36 where @xmath37 is the probability that a randomly chosen neighbour is of type a , and @xmath38 the probability that a randomly chosen neighbour is of type b. as the initial network is an erds - rnyi random graph , @xmath39 and @xmath40 . substituting in to eq .",
    "( [ rnaught ] ) and and setting @xmath41 yields @xmath42 and hence the threshold @xmath43 with @xmath44 .",
    "expectedly this equation is very closely related to the epidemic threshold in the homogeneous system .",
    "the two values of @xmath5 are effectively averaged and only the numerical mean appears .",
    "a comparison of the outbreak threshold identified based on percolation arguments and the numerical results show good qualitative agreement ( fig .  [ figure5 ] ) . in the simulations we observe the outbreak only at slightly higher levels of infectivity , which is most likely a finite size effect . closely above to the theoretical threshold for the infinite size system the finite size simulation can still collapse to the absorbing disease free state due to stochastic extinction .",
    "the results obtained above were based on the assumption that agents of type a and type b are well mixed .",
    "while this assumption is true in the initial state , very different outbreak thresholds can be found if the assumption is violated , for instance if rewiring in response to an earlier outbreak led to a non - random mixing in the population .",
    "we explore this particular scenario in detail in the next section .    to gain a general understanding of the effects of assortativity in the disease free state",
    "let us now consider a disease free state with given number of a  a and b  b links .",
    "we denote the density of these links in the population by @xmath45 $ ] and @xmath46 $ ] , respectively .",
    "the numerical values of both of these quantities are understood to be normalized with respect to the total number of nodes @xmath1 . in this notation",
    "the density of a ",
    "b links @xmath47 $ ] can then be computed from the conservation law @xmath48+[ab]+[bb])\\ ] ] given @xmath45 $ ] and @xmath46 $ ] we can therefore write the number of nodes of types @xmath49 that are infected by a given node of type @xmath50 as @xmath51 ( 1+\\delta_{i , j})}{\\omega p_j}\\left(1-{\\rm e}^{-\\frac{\\omega}{\\mu}}\\right).\\ ] ] these values form the entries in a @xmath52 next - generation matrix . the disease can spread if the leading eigenvalue of this matrix is larger than one . by pulling the repeated factor out of the matrix",
    "we get the condition @xmath53 where @xmath54 is the leading eigenvalue of @xmath55}{p_a } & \\frac{\\psi_a [ ab]}{p_b } \\\\",
    "\\frac{\\psi_b [ ab]}{p_a } & \\frac{2\\psi_b [ bb]}{p_b }    \\end{array } \\right)\\ ] ] this provides a condition that can be solved for , say , the critical number of a  a links @xmath45 $ ] at which outbreaks start . while easy to compute this condition is quite lengthy and is hence omitted here . the result is shown in fig .  [ figure6 ] .",
    "the computation shows that for a given value of infectivity an outbreak can occur if the density of a  a links is sufficiently high .",
    "this is intuitively reasonable as a disease close to the threshold will mainly spread in the highly - susceptible ( type a ) population .",
    "to investigate the system further we can capture the dynamics by a moment expansion . following the procedure in  @xcite we write a system of differential equations that capture the dynamics of the abundances of different types of links and node states .",
    "we use symbols of the form @xmath56 $ ] and @xmath57 $ ] with @xmath58 and @xmath59 to respectively denote the proportion of agents and per capita density of links between agents of a given type .",
    "for instance @xmath60 $ ] is the proportion of agents that are infected and of type a , and @xmath61 $ ] is the per capita density of links between susceptible agents of type a and infected agents of type b. all of these variables are normalized with respect to the total number of nodes @xmath1 . given the number of infected nodes of a given type we can thus find the number of susceptible nodes by using the conservation law @xmath62+[s_{u}]=p_{u}$ ] .",
    "the time evolution of the proportion of nodes that are infected and of type a and b can be respectively written as @xmath63=-\\mu [ i_{\\rm a}]+\\beta \\psi_{\\rm a } \\sum_v [ s_{\\rm a}i_v],\\ ] ] @xmath64=-\\mu [ i_{\\rm b}]+\\beta \\psi_{{\\rm b } } \\sum_v [ s_{\\rm b}i_v].\\ ] ]    for the link densities , using a pair - approximation leads to equations of the form @xmath65}{dt}= \\mu [ s_{\\rm a}i_{\\rm a } ] -2\\beta\\psi_{\\rm a } ( \\frac{[s_{\\rm a}s_{\\rm a}][s_{\\rm a}i_{\\rm a}]}{[s_{\\rm a}]}+\\frac{[s_{\\rm a}s_{\\rm a}][s_{\\rm a}i_{\\rm b}]}{[s_{\\rm a } ] } )   + \\frac{\\omega [ s_{\\rm a}]}{[s_{\\rm a}]+[s_{\\rm b } ] } ( [ s_{\\rm a}i_{\\rm a}]+[s_{\\rm a}i_{\\rm b } ] ) , \\end{split}\\ ] ] where the terms on the right hand side describe the impact of the different processes on the motif considered , @xmath66 $ ] in this example .",
    "for instance the first term corresponds to the creation of @xmath67@xmath67 links due to recovery of the infected node in @xmath67@xmath68 links . in total",
    "the @xmath68 nodes recover at the rate @xmath69 $ ] .",
    "every such recovery event creates an expected number of @xmath67@xmath67 links that is identical to the average number of @xmath68@xmath67 links anchored on an @xmath68 node , which is @xmath70/[i_{\\rm a}]$ ] . in summary ,",
    "the change in the density of @xmath67@xmath67 links due to recovery of @xmath68 nodes is @xmath71[i_{\\rm a}s_{\\rm a}]/[i_{\\rm a}]=\\mu[i_{\\rm a}s_{\\rm a}]$ ] , which explains the first term in eq .",
    "( [ longeq ] ) .",
    "similarly , @xmath72}{dt}= & \\mu [ s_{\\rm b}i_{\\rm b } ] -2\\beta\\psi_{\\rm b } ( \\frac{[s_{\\rm b}s_{\\rm b}][s_{\\rm b}i_{\\rm a}]}{[s_{\\rm b}]}+\\frac{[s_{\\rm b}s_{\\rm b}][s_{\\rm b}i_{\\rm b}]}{[s_{\\rm b } ] } )   \\\\ & + \\frac{\\omega [ s_{\\rm b}]}{[s_{\\rm a}]+[s_{\\rm b}]}([s_{\\rm b}i_{\\rm a}]+[s_{\\rm b}i_{\\rm b } ] ) , \\end{split}\\ ] ] @xmath73}{dt}= & \\mu ( [ s_{\\rm b}i_{\\rm a}]+[s_{\\rm a}i_{\\rm b } ] )   \\\\ & -\\beta\\psi_{\\rm a } ( \\frac{[s_{\\rm b}s_{\\rm a}][s_{\\rm a}i_{\\rm a}]}{[s_{\\rm a } ] }   + \\frac{[s_{\\rm b}s_{\\rm a}][s_{\\rm a}i_{\\rm b}]}{[s_{\\rm a } ] } )   -\\beta\\psi_{\\rm b } ( \\frac{[s_{\\rm a}s_{\\rm b}][s_{\\rm b}i_{\\rm a}]}{[s_{\\rm b } ] } + \\frac{[s_{\\rm a}s_{\\rm b}][s_{\\rm b}i_{\\rm b}]}{[s_{\\rm b } ] } )    \\\\ & + \\frac{\\omega [ s_{\\rm b}]}{[s_{\\rm a}]+[s_{\\rm b}]}([s_{\\rm a}i_{\\rm a}]+[s_{\\rm a}i_{\\rm b } ] )   + \\frac{\\omega [ s_{\\rm a}]}{[s_{\\rm a}]+[s_{\\rm b}]}([s_{\\rm b}i_{\\rm a}]+[s_{\\rm b}i_{\\rm b } ] ) , \\end{split}\\ ] ]    @xmath74}{dt}=&2\\mu [ i_{\\rm a}i_{\\rm a}]-(\\mu + \\beta \\psi_{\\rm a } + \\omega)[s_{\\rm a}i_{\\rm a } ]   + 2\\beta\\psi_{\\rm a}(\\frac{[s_{\\rm a}s_{\\rm a}][s_{\\rm a}i_{\\rm a}]}{[s_{\\rm a}]}+\\frac{[s_{\\rm a}s_{\\rm a}][s_{\\rm a}i_{\\rm b}]}{[s_{\\rm a } ] } )   \\\\ & -\\beta\\psi_{\\rm a}(\\frac{[s_{\\rm a}i_{\\rm a}][s_{\\rm a}i_{\\rm a}]}{[s_{\\rm a } ] } + \\frac{[s_{\\rm a}i_{\\rm a}][s_{\\rm a}i_{\\rm b}]}{[s_{\\rm a } ] } ) , \\end{split}\\ ] ]    @xmath75}{dt}= & 2\\mu [ i_{\\rm b}i_{\\rm b}]-(\\mu + \\beta \\psi_{\\rm b } + \\omega ) [ s_{\\rm b}i_{\\rm b } ]   + 2\\beta\\psi_{\\rm b}(\\frac{[s_{\\rm b}s_{\\rm b}][s_{\\rm b}i_{\\rm a}]}{[s_{\\rm b}]}+ \\frac{[s_{\\rm b}s_{\\rm b}][s_{\\rm b}i_{\\rm b}]}{[s_{\\rm b } ] } )   \\\\ & -\\beta\\psi_{\\rm b}(\\frac{[s_{\\rm b}i_{\\rm b}][s_{\\rm b}i_{\\rm a}]}{[s_{\\rm b } ] } + \\frac{[s_{\\rm b}i_{\\rm b}][s_{\\rm b}i_{\\rm b}]}{[s_{\\rm b } ] } ) , \\end{split}\\ ] ]    @xmath76}{dt}= & \\mu [ i_{\\rm a}i_{\\rm b}]-(\\mu + \\beta \\psi_{\\rm a } + \\omega)[s_{\\rm a}i_{\\rm b } ]     + \\beta\\psi_{\\rm b}(\\frac{[s_{\\rm a}s_{\\rm b}][s_{\\rm b}i_{\\rm a}]}{[s_{\\rm b}]}+ \\frac{[s_{\\rm a}s_{\\rm b}][s_{\\rm b}i_{\\rm b}]}{[s_{\\rm b } ] } )   \\\\ & -\\beta\\psi_{\\rm a}(\\frac{[s_{\\rm a}i_{\\rm b}][s_{\\rm a}i_{\\rm a}]}{[s_{\\rm a } ] } + \\frac{[s_{\\rm a}i_{\\rm b}][s_{\\rm a}i_{\\rm b}]}{[s_{\\rm a } ] } ) , \\end{split}\\ ] ]    @xmath77}{dt}= & \\mu [ i_{\\rm a}i_{\\rm b}]-(\\mu + \\beta \\psi_{\\rm b } + \\omega)[s_{\\rm b}i_{\\rm a } ]    + \\beta\\psi_{\\rm a}(\\frac{[s_{\\rm a}s_{\\rm b}][s_{\\rm a}i_{\\rm a}]}{[s_{\\rm a}]}+ \\frac{[s_{\\rm a}s_{\\rm b}][s_{\\rm a}i_{\\rm b}]}{[s_{\\rm a } ] } ) \\\\ & -\\beta\\psi_{\\rm b}(\\frac{[s_{\\rm b}i_{\\rm a}][s_{\\rm b}i_{\\rm a}]}{[s_{\\rm b } ] } + \\frac{[s_{\\rm b}i_{\\rm a}][s_{\\rm b}i_{\\rm b}]}{[s_{\\rm b } ] } ) , \\end{split}\\ ] ]    @xmath78}{dt}= -2\\mu [ i_{\\rm a}i_{\\rm a}]+\\beta \\psi_{\\rm a}[s_{\\rm a}i_{\\rm a } ]     + \\beta\\psi_{\\rm a}(\\frac{[s_{\\rm a}i_{\\rm a}][s_{\\rm a}i_{\\rm a}]}{[s_{\\rm a}]}+ \\frac{[s_{\\rm a}i_{\\rm a}][s_{\\rm a}i_{\\rm b}]}{[s_{\\rm a } ] } ) , \\end{split}\\ ] ]    @xmath79}{dt}= -2\\mu [ i_{\\rm b}i_{\\rm b}]+\\beta \\psi_{\\rm b}[s_{\\rm b}i_{\\rm b } ]   + \\beta\\psi_{\\rm b}(\\frac{[s_{\\rm b}i_{\\rm b}][s_{\\rm b}i_{\\rm a}]}{[s_{\\rm b}]}+ \\frac{[s_{\\rm b}i_{\\rm b}][s_{\\rm b}i_{\\rm b}]}{[s_{\\rm b } ] } ) .",
    "\\end{split}\\ ] ]    in contrast to the percolation approach and agent - based simulations the moment expansion allows us to investigate the dynamics directly on an emergent level . in the context of the moment equations",
    "the different types of long - term behaviours now appear as attractors of a dynamical system .",
    "numerical continuation reveals a bifurcation diagram that is typical of adaptive epidemic models ( fig .",
    "[ figure7 ] ) .",
    "at sufficiently high infection rate , there is a stable steady state where the disease persists with high prevalence .",
    "when we gradually lower the infection rate this steady state becomes unstable due to a saddle node bifurcation , or by undergoing a hopf bifurcation quickly followed by saddle - node bifurcation , depending on parameters .",
    "the limit cycle formed in the hopf bifurcation only exists in a very small parameter range before it is destroyed in further bifurcations .",
    "the situation is more complex for the disease free states . while the branches of steady states where the disease is present have well - defined values in all of the dynamical variables , the disease free states form a manifold . all states in which the density of infected nodes is zero are necessarily stationary .",
    "however , this still permits networks with different values of the variables @xmath45 $ ] and @xmath46 $ ] .",
    "above we already explored the stability of the manifold of disease - free steady states using the microscopic branching process approach .",
    "we can now replicate these results using the macroscopic moment expansion approach .",
    "for this purpose we compute the jacobian matrix of the moment equations on the manifold of the disease - free steady states . these states are then stable if the leading eigenvalue of the jacobian has a negative real part .",
    "comparison of the threshold that is thus obtained with previous results ( see fig .",
    "[ figure6 ] ) shows that the two approaches are in almost perfect agreement .",
    "let us now turn our attention to the transition between type ii and type iii behavior",
    ". from the analysis above it is already evident that this transition is not caused by a local bifurcation .",
    "the endemic steady state is stable long before the destabilization of the disease - free state occurs .",
    "therefore , the endemic state is an attractor throughout most of the parameter range considered here . for low values of heterogeneity , a system starting in the disease - free state approaches this attractor as soon as the disease - free state is destabilized .    for higher values of heterogeneity",
    "the situation is different .",
    "the initial disease - free state is no longer in the basin of attraction of the endemic state .",
    "the system thus undergoes a single outbreak before it falls back to a different disease - free state ( with a different distribution of links between node types ) which is then stable against further outbreaks .    the transition between type ii ( single outbreak ) and type iii ( endemic state ) behavior is represented by a transition of the initial disease - free saddle from one basin of attraction to another one . for a given parameter set",
    "we can visualize thee different basins of attraction based on numerical simulations ( fig .",
    "[ figure6 ] ) .",
    "we note that type ii ( outbreak - collapse ) behavior occurs when the density of a  a links is high , whereas endemic behavior is observed for intermediate density of a  a links .",
    "while the a  a link density has to exceed a threshold value to allow outbreaks , the outbreak eventually collapses if a second threshold is exceeded .",
    "we note that outbreak ( type ii ) dynamics always land the network in a final state that is characterized by lower connectivity of the highly - susceptible type a nodes , in which disease propagation is suppressed .",
    "hence one can say that the outbreak inoculates the network against subsequent outbreaks of the same disease .",
    "the nature of the transition from type ii to type iii behavior is revealed when one considers trajectories from agent - based simulations ( fig .",
    "[ figure8 ] ) .",
    "as the parameter is tuned closer to the transition point the trajectories start to approach the saddle point that is formed in the fold bifurcation of the endemic state ( see fig .",
    "[ figure7 ] ) . in fig .",
    "[ figure8 ] one can see one of the trajectories turning sharply in as it passes close to the saddle .",
    "this shows that the transition between type ii and type iii behaviour is caused by a saddle - heteroclinic bifuraction . in this bifurcation",
    "the unstable manifold from the saddle hits the initial state , such that a heteroclinic connection between saddles is formed .",
    "this connection also marks a basin boundary , such that in the bifurcation the initial state passes from one basin of attraction to the other .",
    "we can illustrate the situation with a simplified sketch of the phase portrait ( fig .",
    "[ figure9 ] ) .",
    "the figure shows how two thresholds divide the manifold of disease - free steady states into different sections in which perturbations lead to three different types of outcomes observed .",
    "if other parameters of the system change then these two thresholds move such that for a given initial condition , the transitions appear as transcritical and heteroclinic bifurcations respectively .",
    "let us emphasize that the x - axis in fig .",
    "[ figure9 ] can not be the variable @xmath45 $ ] as the different types of behaviour would occur in a different order ( cf .",
    "[ figure6 ] ) .",
    "the different order of sections when plotted over @xmath45 $ ] does not imply qualitatively different dynamics , but is more difficult to visualize in a two - dimenional sketch .",
    "even the simplified ode system discussed above has eleven degrees of freedom , and as such it is difficult to analyse in detail . in fact , the basic phenomenon of inoculation via a heteroclinic bifurcation can be captured in a solvable two - dimensional stylized model as we now describe .",
    "we consider a well - mixed population with two susceptible types ( denoted @xmath80 and @xmath81 as previously ) , and a single infective type @xmath82 .",
    "having removing the network structure , to see the same phenomenon inoculation , it is necessary to introduce a new non - linear term to induce bistability .",
    "we keep the same infection as above , but make a minimal modification to recovery : instead of spontaneous recovery , infectious individuals may be coopted back to a susceptible state by interaction with a pair of susceptible individuals of the same type .",
    "while the cooption to the susceptible type may seem strange at first glance , very similar mechanisms are typically considered in threshold models of opinion formation , including for instance an adaptive network model for opinion formation among locusts  @xcite .",
    "while we intend the proposed model mainly as an abstract illustration , one can imagine that very similar models can be relevant in situations where both opinion formation and epidemic processes occur .",
    "this is the case for instance , when choices can be made that prevent infection ( e.g.  vaccination ) or transmission ( e.g.  hygiene , safer sex ) .",
    "the dynamics of the simplified model are captured by the rate equations @xmath83}{dt}=&-\\beta \\psi_a[i][s_a]+\\mu[i][s_a]^2\\\\ \\frac{d[s_b]}{dt}=&-\\beta \\psi_b[i][s_b]+\\mu[i][s_b]^2\\\\ \\frac{d[i]}{dt}=&\\beta [ i]\\big(\\psi_a[s_a]+\\beta \\psi_b[s_b]\\big)-\\mu[i]\\big([s_a]^2+[s_b]^2\\big)\\ , . \\end{split}\\ ] ]    note that the system is two - dimensional since @xmath84+[s_b]+[i]=1 $ ] is a conserved quantity .",
    "the line @xmath0=0 $ ] is a manifold of fixed points . along the absorbing lines",
    "@xmath84=0 $ ] and @xmath85=0 $ ] , the system is reduced to the one - dimensional ode @xmath86}{dt}=\\beta \\psi_{\\ast}[i](1-[i])-\\mu[i](1-[i])^2\\,,\\ ] ] where @xmath87 .",
    "the behaviour of this system has two phases .",
    "there are always steady states at @xmath0=0 $ ] ( extinction ) and @xmath0=1 $ ] ( endemic infection ) , with the possibility of a third at @xmath0=1-\\beta\\psi_\\ast/\\mu$ ] .",
    "if this third steady state lies in @xmath88 then it is a saddle , and the extinct and endemic states are stable .",
    "if it lies outside the physically relevant region then the extinct state is unstable .    by choosing @xmath89 appropriately ,",
    "we are able to realise a situation in which there is a saddle on the @xmath84=0 $ ] line but not on @xmath85=0 $ ] .",
    "this structure motivates the unusual non - linear choice made for recovery .",
    "the phase portrait of the system is shown in fig .",
    "[ figure10 ] . from the figure ,",
    "perturbation around a state with @xmath0 = 0 $ ] has three possible outcomes . for small @xmath84",
    "$ ] , we have a type i region , where no outbreaks can occur . for large @xmath84 $",
    "] , the trajectory is carried all the way to the stable endemic equilibrium at @xmath0=1 $ ] in a type iii scenario . in between",
    ", there is a range of values for @xmath84 $ ] with type ii trajectories that initially depart , but then return to the @xmath0=0 $ ] line .",
    "this region is bounded on the left by the point where the non - zero eigenvalue of the jacobian matrix changes sign , which we compute to be the point where @xmath84 $ ] solves @xmath90+\\beta\\psi_b(1-[s_a])-\\mu[s_a]^2-\\mu(1-[s_a])^2\\,.\\ ] ] on the right the type ii region is bounded by the separatrix of the endemic and extinct states , which can be found by examining @xmath86}{d[s_a]}=-1+\\frac{1-[i]-[s_a]}{(-\\beta\\psi_a+\\mu [ s_a])[s_a]}\\big(-\\mu(1-[i]-[s_a])+\\beta\\psi_b\\big)\\,,\\ ] ] implying the separatrix @xmath0=1-[s_a]-\\beta\\psi_b/\\mu$ ] .",
    "the results above allow us also to draw a phase diagram of the system ( fig .",
    "[ figure11 ] ) . in this diagram stable disease - free behavior ( type i )",
    "is separated from epidemic behvior ( type ii and iii ) by a transcritical bifurcation , while outbreak ( type ii ) and epidemic ( type iii ) behaviour are separated by the heteroclinic bifucation .",
    "trajectories starting in the type ii phase lead to final states in the type i phase .",
    "in fact , the black arrow is the trajectory for @xmath91 , @xmath84_{0 } = 0.6 $ ] .",
    "again , we can think of this kind of event as an inoculation , since the initial outbreak is crushed , and we are left with fewer type a susceptibles so that future outbreaks need a much higher @xmath4 ( around 1.8 in this case ) to succeed .",
    "in this paper we investigated a previously proposed model for the spreading of a disease across a network in the face of behavioral responses to the disease and intra - individual heterogeneity of epidemic parameters . to understand the dynamics of this system we used a variety of tools , including agent - based simulation , percolation theory , moment expansions , analytical bifurcation theory , numerical integration of odes and continuation .",
    "our results point to a phenomenon that we named _",
    "network inoculation_. introducing a disease into a given network may lead to an outbreak that collapses and leaves the network with a different topology as agents have rewired their connections in response to the disease . although the altered topology will be generally more heterogeneous than the initial topology , it is more resilient to disease outbreaks . in this sense network inoculation is strongly reminiscent of immunological inoculation as in both cases contact to the pathogen leads to a response that hardens the system against future exposure to the pathogen .",
    "our analysis showed that the outbreak and collapse dynamics characteristic of network inoculation occurs in a region bordered by two phase transitions . when viewed from a macroscopic perspective one of these transitions",
    "is a transcritical bifurcation , whereas the other is a saddle - heteroclinic bifurcation .",
    "network inoculation thus provides a ( rare ) example of a phenomenon where a global bifurcation causes a phase transition in a model that can be understood both on the micro- and macroscale .",
    "we emphasize that network inoculation is not a peculiarity of the specific model studied here .",
    "by contrast , we expect the phenomenon to occur in a wide variety of models as soon as certain requirements are met .",
    "while the phenomenon may as well occur in other models , let us for consistency summarise the requirements of network inoculation in epidemic terms .",
    "network inoculation can occur if there is        if the first two conditions are met there will be generally a saddle of some sort whose stable manifold marks the separatrix between the basins of the two attractors . network inoculation will occur if the initial state is in ( or on ) the basin of the inoculated outcome .",
    "when parameters are changed the separatrix will generally move , which can cause an initial state to enter or leave the basin of the inoculated outcome , in a heteroclinic bifurcation .",
    "the conditions above require a bistability between an endemic ( 1 ) and a disease - free ( 2 ) state .",
    "while such bistability is not observed in the most simple models , it is very common in even slightly more complex models . in particular",
    "this bistability has been observed in numerous variants of the adaptive sis models .",
    "it therefore seems to be a robust feature of epidemiological models that appears once behavioral responses to the disease are modeled .",
    "furthermore we require the existence of multiple disease - free states with different stability properties .",
    "while the simplest epidemiological models have only a single disease - free state multiple disease free states naturally appear as soon as an additional macroscopic variable exists .",
    "network inoculation was not observed in previous investigations of the adaptive sis models .",
    "while this model shows robust bistability it has only a unique disease free state and hence does not meet the requirements of network inoculation .",
    "likewise , network inoculation was not observed in previous models of epidemics in heterogeneous populations . in these models",
    "there are naturally multiple disease - free states which differ in the connectivity of the different classes of individuals .",
    "however , because these previous models did not consider adaptive rewiring of links the connectivities of the different classes of agents are parameters , rather than dynamical variables . thus the different disease - free states are not observed simultaneously for one choice of parameters , hence again inoculation - type dynamics can not occur .",
    "once intra - individual heterogeneity and adaptive network rewiring are both considered multiple disease free states that differ in the connectivity of classes of individuals occur robustly .",
    "because adaptive rewiring can change these connectivities , they are now dynamical variables , and the multiple disease - free states can be observed simultaneously , for a given set of the remaining parameters .",
    "when multiple disease - free states exist the generic expectation is that they will have different stability properties at least in some reason of the parameter space , and thus there will in general be a parameter region where the conditions for network inoculation in the narrow sense are met .    because bistability between endemic and disease free states has proven to be a very robust feature of adaptive epidemiological models",
    ", we can moreover expect the onset of network inoculation via the heteroclinic bifurcation to be a common phenomenon .",
    "both ingredients , the adaptive response of the network to the disease , and intra - individual heterogeneity are known to exist in the real world . in the light of the arguments above we expect network inoculation , and its onset via the heteroclinic bifurcation to occur whenever these two ingredients are combined in the same model .",
    "thus it seems that the reason why network inoculation has not been observed in the past is not the phenomenon itself is rare , but rather that the models that have been studied so far have been too strongly simplified to capture this , potentially common , phenomenon .",
    "this work was supported by the epsrc under grant ep / k031686/1 , national natural science foundation of china ( grant nos .",
    "11575041 , 61433014 ) , and the program of outstanding ph.d .",
    "candidate in academic research by uestc ( grant no .",
    "ybxszc20131036 ) .",
    "tr gratefully acknowledges the support of the royal society ."
  ],
  "abstract_text": [
    "<S> in epidemiological modelling , dynamics on networks , and in particular adaptive and heterogeneous networks have recently received much interest . here </S>",
    "<S> we present a detailed analysis of a previously proposed model that combines heterogeneity in the individuals with adaptive rewiring of the network structure in response to a disease . </S>",
    "<S> we show that in this model qualitative changes in the dynamics occur in two phase transitions . in a macroscopic description one of these </S>",
    "<S> corresponds to a local bifurcation whereas the other one corresponds to a non - local heteroclinic bifurcation . </S>",
    "<S> this model thus provides a rare example of a system where a phase transition is caused by a non - local bifurcation , while both micro- and macro - level dynamics are accessible to mathematical analysis . </S>",
    "<S> the bifurcation points mark the onset of a behaviour that we call _ network inoculation_. in the respective parameter region exposure of the system to a pathogen will lead to an outbreak that collapses , but leaves the network in a configuration where the disease can not reinvade , despite every agent returning to the susceptible class . </S>",
    "<S> we argue that this behaviour and the associated phase transitions can be expected to occur in a wide class of models of sufficient complexity .    * throughout history epidemic diseases have been a major cause of death in the human population . after a brief respite during the mid twentieth centrury , </S>",
    "<S> incidences of epidemics are now on the rise again , due to the emergence of new diseases such as aids and ebola , and the return of old killers , such as tuberculosis and influenza . </S>",
    "<S> consequently , the study of epidemilogy has received much recent attention from the mathematics and physics communities . in particular , </S>",
    "<S> network models provide a new theoretical tool by which the spreading of epidemic diseases can be understood and lessons for the real world can be learned . </S>",
    "<S> the present direction of this field is to push network models to greater realism by incorporating more and more aspects of real world epidemics , while maintaining mathematical and/or numerical tractability of the models . in this paper </S>",
    "<S> we study the combined effect of two properties of real world contact networks across which real epidemics spread : adaptivity and heterogeneity . </S>",
    "<S> the network is adaptive in the sense that individuals in the network can respond to the presence of the disease , and it is heterogeneous in the sense that the individuals represented by network nodes have different properties , making them more or less susceptible to the disease . </S>",
    "<S> we show that combining these features leads to a phenomenon that we call _ network inoculation_. exposure of a given initial network to a pathogen can lead to an outbreak that collapses and leaves the network resistant to future outbreaks . </S>",
    "<S> this resistance is acquired solely through the rewiring of network structure , without any becoming physically immune to the disease . </S>",
    "<S> we use a variety of tools , including agent - based simulation , moment expansions , percolation methods , and numerical continuation , to reveal the heteroclinic mechanism that leads to this inoculation phenomenon . * </S>"
  ]
}