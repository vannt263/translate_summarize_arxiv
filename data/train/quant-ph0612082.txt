{
  "article_text": [
    "the faithful storage of a traveling light pulse in an atomic memory and the subsequent retrieval of the state are currently being pursued in a number of laboratories around the world @xcite .",
    "a strong motivation for this research comes from the field of quantum communication , where quantum information is easily transmitted by photons , but the photonic states need to be stored locally to process the information .",
    "such applications as well as other ideas from quantum - information science have led to a strong interest in techniques to facilitate a controlled interaction between atoms and single photons @xcite",
    ". a conceptually simple realization of a matter - light quantum interface consists of a single atom absorbing a single photon .",
    "however , due to the very weak coupling of a single atom to light , this approach is extremely challenging and requires the use of very high - finesse cavities to effectively increase the coupling @xcite . to circumvent the problem of weak coupling",
    ", it has recently been realized that one can use an optically thick ensemble of atoms , and several different proposals have been made for how external classical control fields can be used to controllably map photon states onto collective atomic states @xcite .",
    "the goal in all of these approaches is to map an incoming signal pulse into a long - lived atomic coherence ( referred to as a spin wave ) , so that it can be later retrieved  on demand \" with the highest possible efficiency .",
    "remarkable experimental progress has already been made toward the implementation of these protocols in atomic gases @xcite and in impurities embedded in a solid state material @xcite .",
    "a central question that emerges from these advances is which approach represents the best possible strategy for given experimental parameters and for desired memory characteristics , and how the control fields or possibly the shape of the input photon wave packet can be chosen to achieve the maximum efficiency . in a recent paper @xcite",
    ", we presented a novel physical picture that unifies a wide range of different approaches to photon storage in @xmath0-type atomic media and yields the optimal control strategy .",
    "this picture is based on two key observations .",
    "first , we showed that the retrieval efficiency of any given stored spin wave depends only on the optical depth of the medium and not on the properties of the control pulse .",
    "physically , this follows from the fact that the branching ratio between collectively enhanced emission into desired modes and spontaneous decay depends only on the optical depth .",
    "the second observation is that the optimal storage process is the time reverse of retrieval ( see also @xcite ) .",
    "this universal picture implies that the maximum efficiency for the combined process of storage followed by retrieval is the same for all approaches considered and depends only on the optical depth @xcite .",
    "the optimum can be attained by adjusting the control or the shape of the photon wave packet . in the present paper and in the two papers that follow , refs .",
    "@xcite , which we will refer to henceforth as paper ii and paper iii , respectively , we present all the details behind this universal picture and the optimal control shaping that it implies , as well as consider several extensions of this analysis beyond the results of ref .  @xcite . in particular ,",
    "in the present paper we discuss the cavity model to be compared in paper ii to the free - space model . in paper ii , the full analysis of the free - space model is presented , and , in addition ,",
    "the effects of spin - wave decay and of nondegeneracy of the two lower levels of the @xmath0 system are discussed .",
    "finally , in paper iii , we generalize our treatment to two different regimes of inhomogeneous broadening : with and without redistribution between frequency classes during the storage time .    a generic model for a quantum memory uses the @xmath0-type level configuration shown in fig .",
    "[ fig : lambda ] , in which a weak ( quantum ) signal field ( the dashed line ) is detuned by a frequency @xmath7 from the @xmath8 transition , whose optical coherence decays with rate @xmath9 , where @xmath10 is the spontaneous emission rate from state @xmath11 .",
    "a copropagating ( classical ) control beam ( the solid line ) with the same detuning @xmath7 from the @xmath12 transition and time - dependent rabi frequency envelope @xmath13 is used to coherently manipulate the signal propagation and map the photonic state onto the atoms , and vice versa . in the present paper and in papers ii and iii , we discuss several different approaches to photon storage , including far - off - resonant raman , electromagnetically induced transparency ( eit ) , and photon - echo techniques .",
    "if we neglect the decay of the @xmath14 coherence , i.e. , the decay of the spin wave , the only sources of loss in all of these approaches are the decay @xmath15 of the optical polarization on the @xmath8 transition during both storage and retrieval , and the leakage of the pulse through the medium during storage . to achieve the maximum storage efficiency",
    ", one has to minimize these two types of loss , and , in fact , as we will show in the present paper and in papers ii and iii , one has to make a compromise between them .",
    "higher optical depth increases the coherent coupling between the quantum signal field and the atoms and , thus , allows for higher photon storage efficiencies .",
    "it has therefore been suggested to put a cavity around the atomic ensemble @xcite , which will effectively increase the free - space optical depth @xmath16 by a factor equal to the number of passes a photon makes in the cavity before leaking out .",
    "we will denote this increased effective optical depth by the cooperativity parameter @xmath2 .",
    "high - efficiency retrieval of a photon from an ensemble enclosed in a cavity has been recently demonstrated @xcite .",
    "in addition to being a promising experimental setup in itself @xcite , the slightly simpler theoretical treatment of the cavity model offers a very useful tool for understanding the more complicated free - space model .",
    "thus , in the present paper , we will treat photon storage in the cavity model , to be compared in paper ii to the free - space model .",
    "we will now review the three photon storage protocols ( raman , electromanetically induced tranparency , and photon echo ) that are often discussed in the literature on photon storage and that we treat as special cases of our general formalism .",
    "the remainder of this section is intended as an introduction to both the present paper and paper ii and will thus make use of the figures of merit of both the cavity model ( the cooperativity parameter @xmath2 ) and the free - space model ( the optical depth @xmath16 ) .",
    "it will be implied in the following discussion that all the formulas containing @xmath2 ( @xmath16 ) refer to the cavity ( free - space ) model .",
    "one possible strategy for light storage uses the raman configuration , where the fields have a large detuning ( we will show that the appropriate limit is @xmath17 or @xmath18 rather than @xmath19 , as one might naively assume by analogy with the single - atom case ) and the photons are absorbed into the stable ground state @xmath20 by stimulated raman transitions @xcite . with far - off - resonant interactions , the excited state @xmath11 can be adiabatically eliminated to give simplified and solvable equations @xcite .",
    "based on these simplified equations , the raman scheme for storage of quantum states of light in atomic ensembles was proposed in ref .",
    "@xcite and , simultaneously with the present work , has been analyzed in detail and optimized under the constraint of limited control power @xcite .",
    "we show in the present paper and in paper ii that , in the limit of large cooperativity parameter @xmath2 or large optical depth @xmath16 , one can ignore the decay @xmath15 of the optical @xmath8 coherence , as is done in ref .",
    "@xcite .",
    "an alternative storage strategy is based on electromagnetically induced transparency @xcite , where resonant control fields ( @xmath21 or @xmath22 ) are used to open a spectral transparency window for the quantum field . in this approach",
    ", the quantum field travels at a reduced group velocity , which is then adiabatically reduced to zero . similarly to the raman case , the excited state can also be eliminated on resonance , provided the control field is sufficiently weak .",
    "this again simplifies the equations to analytically solvable ones @xcite .",
    "we will treat both the far - off - resonant raman scheme and the resonant eit scheme as special cases of a more general ",
    "adiabatic \" limit , i.e. , the limit in which the excited state can be adiabatically eliminated .",
    "we will show that , for the purposes of optimal photon storage , the condition of validity of the adiabatic elimination is almost independent of the single - photon detuning @xmath7 ( in particular , it is similar in the raman and resonant cases ) and is given by @xmath23 or @xmath3 , where @xmath5 is the duration of the incoming pulse .",
    "we will show that , provided a ( smooth ) incoming photon wave packet is long enough that this condition is satisfied ( @xmath24 or @xmath25 ) , it can be stored with the maximum possible efficiency , which depends only on the optical depth @xmath16 or the cooperativity parameter @xmath2 and not on the detuning @xmath7 or the shape of the wave packet . in the case of the cavity model discussed in the present paper ,",
    "this maximum efficiency is simply given by @xmath1 .",
    "finally , in the photon - echo - based approach to storage , a resonant photon is first allowed to get absorbed by the ensemble with the control field off .",
    "while the phrase  photon echo \" often refers to a wide class of experiments , we shall here consider a special case where one applies then a short resonant @xmath26 pulse , which maps excitations from the unstable excited state @xmath11 into the stable ground state @xmath20 . because this approach uses very short control pulses and",
    "because , as we will show , it is most efficient in storing short input pulses ( @xmath27 or @xmath28 ) , we will refer to this approach as  fast \" storage .",
    "this technique was originally suggested in ref .",
    "@xcite for the case of doppler - broadened atoms and has since been extensively studied both theoretically @xcite and experimentally @xcite . in ref .",
    "@xcite , it was noted that , if the photons are retrieved by using a control laser pulse traveling in the backward direction compared to storage , the doppler broadening is reversed , and the dephasing occurring during storage is therefore also reversed , resulting in an  echo , \" which may result in high efficiencies . in refs .",
    "@xcite , it was proposed to use controlled reversible inhomogeneous broadening ( crib ) , that is , to artificially add an inhomogeneous broadening to an originally homogeneously broadened line and then to reverse this broadening to achieve an echo signal . in the present paper and in paper ii , we consider a different limit of this proposal , where there is no inhomogeneous broadening of the optical transition , and storage is simply achieved by applying a fast @xmath26 pulse at the right time .",
    "retrieval , which is accomplished with a second @xmath26 pulse , results @xcite in a directional output ( as opposed to the loss due to the decay rate @xmath29 ) exactly as in the adiabatic limit .",
    "we will show that in the limit of large @xmath16 or @xmath2 this procedure leads to an ideal storage and retrieval of the photonic state , while at every finite value of @xmath16 or @xmath2 there exists an optimal input photon mode that can be stored with efficiency equal to the maximum adiabatic storage efficiency ( given by @xmath1 in the case of the cavity model ) . for comparison , in paper iii",
    ", we will discuss how this approach measures up to the crib approach and show that adding and reversing inhomogeneous broadening as proposed in refs .",
    "@xcite may lead to an improvement in the storage efficiency , although the improvement is rather limited .",
    "the optimization of storage in all of these schemes consists of finding the optimal balance between two sources of error : leakage of the input pulse through the ensemble and scattering of the input photons into @xmath30 due to spontaneous emission . in the eit approach ,",
    "a stronger control field is desirable , since it produces more robust interference and a wider transparency window , thus minimizing spontaneous emission losses . on the other hand ,",
    "higher control power means larger group velocity and hence the inability to localize the input pulse inside the medium .",
    "the optimization in this case finds the optimal power and shape for the control field , given the duration and shape of the input pulse .",
    "in contrast , in the raman scheme , a high value of @xmath13 is required to have a sufficient coupling of the input photon to the spin wave @xcite . on the other hand , large @xmath13 will increase the decay rate due to spontaneous emission , which is given by the optical pumping rate @xmath31 .",
    "the optimization with respect to the shape and power of @xmath13 for a given input mode again balances between these two sources of error . finally , in the fast storage scheme the control fields",
    "are fixed to be perfect @xmath26 pulses , but one can optimize with respect to the duration @xmath5 and the shape of the input mode . the input mode should be made as short as possible in order to avoid the loss due to optical polarization decay @xmath32 . however , a mode that is too short will be too wide in frequency space and will not be absorbed by the ensemble ( i.e. , it will leak through ) .",
    "the optimization with respect to the duration and shape of the input mode finds the optimal balance between these two sources of error .    in all the photon storage techniques considered ,",
    "ideal performance ( i.e. , unit efficiency ) can be achieved in the limit of infinite optical depth @xmath16 or infinite cooperativity parameter @xmath2 .",
    "for example , in the eit regime in free space , the width of the spectral transparency window is @xmath33 , where @xmath34 is the length of the ensemble and @xmath35 is the eit group velocity @xcite .",
    "thus , for a given @xmath5 and a given large value of @xmath16 , one can first make @xmath13 , and hence @xmath36 , small enough for the pulse to fit inside the medium .",
    "then the enhancement of @xmath37 by an extra factor of @xmath38 will ensure , if @xmath16 is sufficiently large , that the transparency window is still wide enough to induce negligible spontaneous emission . in the raman regime , to avoid spontaneous emission decay via the optical pumping rate @xmath31",
    ", one should make @xmath13 sufficiently small .",
    "if the optical depth or the cooperativity parameter is large enough , the coupling of the input mode to the atoms will then still be sufficient to avoid leakage even at this small value of @xmath13 .",
    "finally , in fast storage , the pulse that is short enough ( @xmath39 ) to avoid optical polarization decay can still be absorbed in a free - space medium provided @xmath16 is large enough ( @xmath23 , as we will show in paper ii ) . in the cavity model discussed in the present paper , due to the availability of only one spin - wave mode ( the one that couples to the cavity mode )",
    ", high - efficiency fast storage is harder to achieve than in free space : only pulses of a particular shape and duration ( @xmath28 ) give high fast storage efficiencies .",
    "although ideal performance can be achieved at infinite optical depth , in practice , optical depth is always limited by experimental imperfections such as a limited number of atoms in a trap ( e.g. , ref .",
    "@xcite , where the optical depth is roughly 8) , competing four - wave mixing processes ( e.g. , ref .",
    "@xcite , where the optical depth is roughly 4 ) , inhomogeneous broadening of impurity levels in solid state samples @xcite , or other types of experimental imperfections .",
    "therefore , the optimization of storage protocols at finite optical depth is essential .    before proceeding with our analysis",
    ", we would like to specially note the recent work of dantan _",
    "et al . _ , which also considers and illuminates some of the issues we discuss in the present paper @xcite and in paper ii @xcite . in particular , in refs .",
    "@xcite , focusing on broadband squeezed states as the input , the authors consider adiabatic storage in a cavity , derive an efficiency expression equivalent to ours , and recognize the interesting similarity between raman and resonant regimes , both of which feature reduced sensitivity to spontaneous emission .",
    "we show in the present paper how , for the case of a single incoming spatiotemporal field mode , proper control field shaping can be used to achieve the same optimal efficiency independent of detuning .",
    "this effectively makes the raman , the resonant , and the intermediate regimes all exhibit equally reduced sensitivity to spontaneous emission . in ref .",
    "@xcite , as in paper ii , the authors compare adiabatic storage in a cavity to adiabatic storage in free space and recognize important similarities and differences . in particular , it is recognized that the error in the cavity case scales as the inverse of the atomic density ( as we also find in the present paper ) , while in free space it may scale as the inverse of the square root of the density .",
    "we show in paper ii how proper optimization can be used to make the error in the free - space case also scale as the inverse of atomic density .",
    "we also bridge in free space the gap between the eit and raman cases , showing how proper control field shaping can be used to achieve the same optimal efficiency independent of detuning .",
    "we would also like to note that the connection between optimal photon storage and time reversal that we present was first made in the context of photon - echo - based techniques .",
    "in particular , it was first shown in ref .",
    "@xcite and then discussed in detail in refs .",
    "@xcite that under certain conditions , such as high optical depth and sufficiently slow optical polarization decay rate , photon - echo techniques can result in ideal storage and retrieval , and that the retrieved photon field is then the time reverse of the original input field .",
    "we generalize this result in ref .",
    "@xcite , in the present paper , and in papers ii and iii by demonstrating that the ideas of time reversal can be used to optimize photon storage even when the dynamics of the system are not completely reversible and when the ideal unit efficiency can not be achieved .",
    "this is the case for finite cooperativity parameter @xmath2 in the cavity model and for finite optical depth @xmath16 in the free - space model .",
    "we also generalize the time - reversal - based optimization of photon storage from photon - echo - based techniques to any storage technique including , but not limited to , eit and raman techniques in homogeneously ( present paper , ref .",
    "@xcite , and paper ii ) and inhomogeneously ( paper iii ) broadened @xmath0-type media .",
    "we would also like to point out that mathematically some of the optimization problems we are solving in the present work ( including ref .",
    "@xcite , the present paper , and papers ii and iii ) fall into a rich and well - developed field of mathematics called optimal control theory @xcite .",
    "in particular , we are interested in shaping the control pulse to maximize the storage efficiency ( or efficiency of storage followed by retrieval ) for a given input photon mode in the presence of optical polarization decay . since in the equations of motion the control multiplies a dependent variable ( optical polarization )",
    ", this problem is a nonlinear optimal control problem @xcite .",
    "a general solution to all nonlinear optimal control problems does not exist , so that such problems have to be treated on a case by case basis .",
    "we believe that the methods we suggest , such as the iterative time - reversal method introduced in secs .",
    "iv and v of paper ii , may be useful in solving optimal control problems in other open ( as well as closed ) quantum systems .",
    "similar iterative methods are a standard tool in applied optimal control @xcite and have been used for a variety of applications , including laser control of chemical reactions @xcite , design of nmr pulse sequences @xcite , loading of bose - einstein condensates into an optical lattice @xcite , and atom transport in time - dependent superlattices @xcite .",
    "in fact , an optimization procedure that is based on gradient ascent @xcite , and that is very similar to that of refs .",
    "@xcite , is directly applicable to our problem of finding the optimal control pulse , as we will discuss elsewhere @xcite .",
    "however , in the present paper and in papers ii and iii , we use time - reversal iterations for optimal control in a way different from the methods of refs .",
    "@xcite , as we will discuss in sec .",
    "v of paper ii .",
    "in particular , we will show that , in addition to being a convenient computational tool , our iterative optimization algorithm is , in fact , experimentally realizable @xcite .",
    "the remainder of this paper is organized as follows .",
    "section [ sec : effic ] applies to both the cavity and the free - space models and discusses our figure of merit for the performance of the photon storage .",
    "the rest of the paper discusses storage and retrieval of photons using homogeneously broadened atomic ensembles enclosed in a cavity . in sec .",
    "[ sec : cavmod ] , we introduce the model . in sec .",
    "[ sec : cavopt ] , without fully solving the equations analytically , we show that both the retrieval efficiency and the optimal storage efficiency are equal to @xmath1 ( where @xmath2 is the cooperativity parameter ) , and derive the optimal storage strategy . in secs .",
    "[ sec : cavad ] and [ sec : cavfast ] , we solve the equations analytically in the adiabatic and fast limits , respectively , and demonstrate that the optimal storage efficiency can be achieved for any smooth input mode at any detuning satisfying @xmath3 and a certain class of resonant input modes satisfying @xmath4 , where @xmath5 is the duration of the input mode . in sec .",
    "[ sec : cavsum ] , we summarize the discussion of the cavity model . finally , in the appendixes , we present some details omitted in the main text .",
    "when comparing different storage and retrieval approaches , it is essential to have a figure of merit characterizing the performance of the memory .",
    "the discussion in this section of the appropriate figure of merit applies both to the cavity model discussed in this paper and to the free - space models discussed in papers ii and iii . throughout this work",
    "we shall assume that we initially have a single incoming photon in a known spatiotemporal mode denoted by @xmath40 ( or , for the case of computing retrieval efficiency alone , a single excitation in a known atomic spin - wave mode ) .",
    "we define the efficiency @xmath41 of all the mappings we consider ( storage alone , retrieval alone , or storage followed by retrieval ) as the probability to find the excitation in the output mode ( photonic or atomic , as appropriate ) after the interaction . depending on the application one has in mind , this single - photon efficiency may or may not be the right quantity to consider , but provided that we are interested in a situation where we are mapping a single input mode into a single output mode , any other quantities may be derived from the single - photon efficiency @xmath41 .    for all the interactions we consider , the full evolution results in a passive ( beam - splitter - like ) transformation @xmath42 where @xmath43 and @xmath44 denote the annihilation operators for all the input and output modes , respectively ( all photonic , spin - wave , and langevin noise operators ) , with commutation relations @xmath45 = \\delta_{j , k}$ ] and @xmath46 = \\delta_{j , k}$ ] . here",
    "the matrix @xmath47 has to be unitary to preserve the commutation relations .",
    "the mapping from a certain input mode @xmath48 to an output mode @xmath49 with efficiency @xmath41 is therefore described by @xmath50 , where @xmath51 satisfies @xmath52 = 1 $ ] and represents some linear combination of all other input modes orthogonal to @xmath48 .",
    "if all input modes other than @xmath48 are in the vacuum state , the parameter @xmath41 completely characterizes the mapping .",
    "if , for instance , the mode we are storing is in an entangled state with some other system @xmath53 , where @xmath54 and @xmath55 are the zero- and one - photon fock states of the input mode , and @xmath56 and @xmath57 are two orthonormal states of the other system , the fidelity of the entangled state after the mapping is easily found to be @xmath58 .",
    "similarly , refs .",
    "@xcite characterize the performance in terms of squeezing preservation parameter @xmath59 .",
    "if the input state is a squeezed vacuum state in a given mode @xmath48 , the squeezing preservation parameter can be shown to be equivalent to single - photon efficiency , i.e. , @xmath60 .",
    "we will show below in the description of our model why in most experimental situations it is indeed reasonable to assume that the incoming noise ( which is included in @xmath51 ) is vacuum noise .",
    "the details of the model and the derivation of the equations of motion are provided in appendix [ sec : appmodel ] . in this section ,",
    "we only give a brief introduction to the model and present the equations of motion without derivation .",
    "we consider a medium of @xmath61 @xmath0-type atoms with two metastable lower states , as shown in fig .",
    "[ fig : lambda ] , interacting with two single - mode fields .",
    "we neglect reabsorption of spontaneously emitted photons and treat the problem in a one - dimensional approximation .",
    "the @xmath8 transition of frequency @xmath62 of each of the atoms is coupled to a quantized traveling - wave cavity radiation mode ( e.g. , a mode of a ring cavity with one of the mirrors partially transmitting ) with frequency @xmath63 described by a slowly varying annihilation operator @xmath64 . the cavity decay rate is @xmath65 and the corresponding input - output relation is @xcite @xmath66 in addition , the transitions @xmath12 of frequency @xmath67 are driven by a single - mode copropagating classical plane - wave control field with frequency @xmath68 ( i.e. , at two - photon resonance @xmath69 , where @xmath70 is the energy difference between the two metastable states ) described by a slowly varying rabi frequency envelope @xmath71 .    in the dipole and rotating - wave approximations , assuming that almost all atoms are in the ground state at all times , and defining the polarization annihilation operator @xmath72 and the spin - wave annihilation operator @xmath73 ( where @xmath74 are slowly varying collective atomic operators defined in appendix [ sec : appmodel ] ) , to first order in @xmath75 , the heisenberg equations of motion are @xmath76 where we have introduced the polarization decay rate @xmath15 , the spin - wave decay rate @xmath77 , and the corresponding langevin noise operators @xmath78 and @xmath79 .",
    "the coupling constant @xmath80 ( assumed to be real for simplicity ) between the atoms and the quantized field mode is collectively enhanced @xcite by a factor of @xmath81 to @xmath82 .    as described in appendix [",
    "sec : appmodel ] , under reasonable experimental conditions , the incoming noise described by @xmath78 and @xmath79 is vacuum , i.e. , all normally ordered noise correlations are zero .",
    "this is precisely the reason why , as noted in sec .",
    "[ sec : effic ] , efficiency is the only number we need in order to fully characterize the mapping .",
    "we assume that all atoms are initially pumped into the ground state , i.e. , no @xmath83 or @xmath84 excitations are present in the atoms .",
    "we also assume that the only input field excitations initially present are in the quantum field mode with an envelope shape @xmath85 nonzero on @xmath86 $ ] .",
    "the goal is to store the state of this mode in @xmath84 and , starting at a time @xmath87 , retrieve it back into a field mode .",
    "since we are interested only in computing efficiencies ( defined below ) and since the incoming noise is vacuum , we can ignore the noise operators in eqs .",
    "( [ caveqs1])-([caveqs3 ] ) and treat these equations as complex number equations . during storage , the initial conditions are @xmath88 , @xmath89 , and the input mode is @xmath90 ( normalized according to @xmath91 ) .",
    "we have here dropped the carets on the operators to denote their complex number representations .",
    "the storage efficiency is then @xmath92 similarly , during retrieval , the initial and boundary conditions are @xmath93 , @xmath94 , and @xmath95 .",
    "@xmath96 then represents the shape of the quantum mode into which we retrieve , and the total efficiency of storage followed by retrieval is given by @xmath97 if we instead take @xmath98 , we obtain the retrieval efficiency : @xmath99    from now on we will neglect the slow decay of the spin wave ( i.e. , set @xmath100 ) but , as briefly discussed below at the ends of secs .",
    "[ sec : cavadret ] and [ sec : cavadst ] , spin - wave decay is not hard to include .",
    "nonzero @xmath77 will simply introduce an exponential decay without making the solution or the optimal control shaping harder .    to get the closest analogy to the free - space regime",
    ", we assume we are always in the  bad cavity \" limit ( @xmath101 ) , in which @xmath102 in eq .  ( [ caveqs1 ] ) can be adiabatically eliminated to give @xmath103 where @xmath104 is the cooperativity parameter . to relate to the free space situation discussed in paper ii , we can write the cooperativity parameter as @xmath105 $ ] , where @xmath106 is the definition of optical depth used in the free - space model of paper ii and where the factor in the square brackets ( proportional to cavity finesse ) is equal to the number of passes a photon would make through an empty cavity before leaking out ( i.e. , the photon lifetime in the cavity divided by the time a single pass takes ) . thus , up to a factor of order unity",
    ", the cooperativity parameter @xmath2 represents the effective optical depth of the medium in the cavity , so that the efficiency dependence on @xmath2 in the cavity should be compared to the efficiency dependence on @xmath16 in free space .",
    "we note that , although eqs .",
    "( [ caveout])-([cavseq ] ) describe our case of quantized light coupled to the @xmath8 transition , they will also precisely be the equations describing the propagation of a classical probe pulse . to see this",
    "one can simply take the expectation values of eqs .",
    "( [ caveqs1])-([caveqs3 ] ) and use the fact that classical probe pulses are described by coherent states .",
    "it is convenient to reduce eqs .",
    "( [ cavpeq ] ) and ( [ cavseq ] ) to a single equation @xmath107 + ( \\gamma ( 1+c ) + i \\delta ) \\dot s + |\\omega|^2 s =   -\\omega^ * \\sqrt{2 \\gamma c } { \\mathcal{e}}_\\textrm{in}.\\ ] ] this second - order differential equation can not , in general , be fully solved analytically . however , in the next section we derive a number of exact results about the optimal efficiency anyway .",
    "in this section , we derive several important results regarding the optimal strategy for maximizing the storage efficiency , the retrieval efficiency , and the combined ( storage followed by retrieval ) efficiency without making any more approximations .",
    "it is convenient to first consider retrieval .",
    "although we can not , in general , analytically solve for the output field @xmath96 , we will now show that the retrieval efficiency is always @xmath1 independent of the detuning @xmath7 and the control shape @xmath71 provided that no excitations are left in the atoms at @xmath108 , i.e. , @xmath109 and @xmath110 . from eqs .",
    "( [ cavpeq ] ) and ( [ cavseq ] ) and using @xmath95 , we find @xmath111 using this and eqs .",
    "( [ etar ] ) and ( [ caveout ] ) , the retrieval efficiency becomes @xmath112 which reduces to @xmath1 for @xmath113 , @xmath114 .",
    "the value of the retrieval error ( @xmath115 ) and its independence from @xmath7 and @xmath13 follow directly from the branching ratio between the decay rates in eq .",
    "( [ cavpeq ] ) ( or equivalently in eq .",
    "( [ cavcons ] ) ) .",
    "the decay rate for @xmath116 into undesired modes is @xmath15 , while the decay rate for @xmath116 into the desired mode @xmath117 is @xmath118 . the retrieval efficiency , which is the ratio between the desired decay rate and the total decay rate , is , therefore , equal to @xmath1 independent of the control field .",
    "we have thus shown that , provided our control pulse is sufficiently long and/or powerful to leave no excitations in the atoms ( we will refer to this as complete retrieval ) , the retrieval efficiency is independent of @xmath7 and @xmath71 and is always equal to @xmath1 .",
    "therefore , any control field is optimal for retrieval provided it pumps all excitations out of the system . using this knowledge of the retrieval efficiency , in the remainder of this section",
    "we will use a time - reversal argument to deduce the optimal storage strategy and the optimal storage efficiency . here",
    "we will only give the essence of and the intuition behind the time - reversal argument , and leave the derivation to secs .",
    "iv and v of paper ii . in the remainder of the paper",
    ", we will independently confirm the validity of this argument in the adiabatic and fast limits .",
    "applied to the present situation , the essence of the time - reversal argument is as follows .",
    "suppose one fixes the cooperativity parameter @xmath2 and the detuning @xmath7 and considers complete retrieval from the spin wave with a given control field @xmath71 into an output mode @xmath96 of duration @xmath119 . according to the time - reversal argument , the efficiency for storing the time reverse of the output field ( @xmath120 ) with @xmath121 , the time reverse of the retrieval control field , into the spin wave is equal to the retrieval efficiency @xcite .",
    "although this claim is not trivial to prove ( see paper ii ) , it is rather intuitive : since the retrieval procedure can be regarded as a generalized beam - splitter - like transformation ( sec .  [ sec : effic ] ) , the equality of the two efficiencies is simply the statement that the probability of going from a given input port of the beam splitter to a given output port is equal to the probability of going backward from that output port to the original input port .",
    "therefore , the time - reversal argument shows that the maximum efficiencies for storage and storage followed by retrieval are @xmath1 ( i.e. , the retrieval efficiency ) and @xmath122 ( i.e. , its square ) , respectively .",
    "moreover , it says that these maximum efficiencies are obtained if the input field @xmath40 and the storage control field @xmath71 are such that @xmath123 , i.e. , the time reverse of @xmath71 , retrieves the spin - wave excitation into the output mode @xmath124 , i.e. , the time reverse of @xmath40 . in order to say for which input fields the optimal storage control",
    "@xmath71 can be found ( or , equivalently , into which output fields a spin - wave excitation can be retrieved ) , we need to consider the limits , in which eq .",
    "( [ cavoneeq ] ) can be fully solved analytically .",
    "these limits , adiabatic and fast , will be discussed in the following sections .",
    "in the previous section , we have found , based on time reversal , the maximum storage efficiency and the scenario under which it can be achieved .",
    "since the optimal storage into a given input mode requires the ability to carry out optimal retrieval into the time reverse of this mode , we will , in the following sections ( secs .",
    "[ sec : cavad ] and [ sec : cavfast ] ) , solve eq .",
    "( [ cavoneeq ] ) analytically in two important limits to find out which modes we can retrieve into and store optimally . the first such limit , which we will discuss in this section ( sec .",
    "[ sec : cavad ] ) , corresponds to smooth control and input fields , such that the term in the square brackets in eq .",
    "( [ cavoneeq ] ) can be dropped .",
    "this `` adiabatic '' limit corresponds to an adiabatic elimination of @xmath116 in eq .",
    "( [ cavpeq ] ) .",
    "the precise conditions for this approximation will be discussed in sec .  [",
    "sec : cavadcond ] . in this section",
    ", we discuss the retrieval process .",
    "it is instructive to recognize that in the adiabatic approximation ( i.e. , with @xmath125 in eq .",
    "( [ cavpeq ] ) replaced with @xmath126 ) , if one uses rescaled variables @xmath127 , @xmath128 , and @xmath129 and makes a change of variables @xmath130 , where @xmath131 then eqs .  ( [ caveout])-([cavseq ] )",
    "become independent of @xmath13 and can be solved in this @xmath13-independent form , so that for any given @xmath13 the solution in the original variables would follow by simple rescaling . however , since the equations are sufficiently simple and in order to avoid confusion introduced by additional notation , we will solve eqs .",
    "( [ caveout])-([cavseq ] ) directly without making the change of variables .    to compute the output field during adiabatic retrieval , we assume for simplicity that retrieval begins at time @xmath132 rather than at time @xmath133 and adiabatically",
    "eliminate @xmath116 in eqs .",
    "( [ cavpeq ] ) and ( [ cavseq ] ) ( i.e. , replace @xmath125 in eq .",
    "( [ cavpeq ] ) with zero ) to obtain a first - order linear ordinary differential equation for @xmath134 .",
    "then , using @xmath135 and @xmath95 , we solve this equation to find @xmath136 the @xmath137-dependent phase @xmath138 in the last factor is the ac stark shift , which results in a shift of the output field frequency away from bare two - photon resonance . computing the retrieval efficiency using eq .",
    "( [ cavadeout ] ) , we find @xmath139 which is equal to @xmath1 provided the control pulse is sufficiently powerful and/or long to ensure that @xmath140 which is the same as the condition @xmath141 .",
    "note that adiabatic elimination did not affect the exact value of the efficiency and kept it independent of @xmath71 and @xmath7 by preserving the branching ratio between the desired and undesired state transfers .",
    "also note that , unlike the general argument in the previous section , which assumed @xmath141 , eq .",
    "( [ etacavfiniteh ] ) allows for the precise calculation of the retrieval efficiency for any @xmath142 .    as noted in the introduction , two important subsets of the adiabatic limit , the resonant limit and the raman limit ,",
    "are often discussed in the literature .",
    "although , as we show in this work , the basic physics based on the branching ratio and time - reversal arguments is shared by both of these approaches to quantum memory , a more detailed discussion of the physics behind them involves significant differences .",
    "in fact , prior to this work , the fact that the two approaches are in a sense equivalent was not recognized to our knowledge : only interesting similarities were pointed out @xcite . as an example of an important difference ,",
    "the resonant and raman limits give different dependences on @xmath2 of the duration of the output pulse in eq .",
    "( [ cavadeout ] ) : @xmath143 where we assumed @xmath144 . in the resonant limit ( @xmath145 ) , @xmath146 , while in the raman limit ( @xmath147 ) , @xmath148 .",
    "it is worth emphasizing that the raman limit condition is @xmath147 and not @xmath149 , as one may naively think by analogy with the single - atom case .",
    "it follows from the concept of time reversal that the modes that can be stored optimally are the time reverses of the modes onto which a spin wave can be retrieved .",
    "we will now show that , in the adiabatic limit , at any given @xmath7 and @xmath2 , we can shape @xmath71 to retrieve onto any normalized mode @xmath150 . integrating the norm squared of eq .",
    "( [ cavadeout ] ) with @xmath151 , we get @xmath152 solving this equation for @xmath153 and then taking the square root of its derivative with respect to @xmath137 , we find @xmath154 .",
    "knowing @xmath153 , the phase of @xmath71 can be determined from eq .",
    "( [ cavadeout ] ) . putting the magnitude and the phase together , we have @xmath155 where @xmath153 should be determined from eq .",
    "( [ eeq ] ) . for any @xmath150",
    ", this expression gives the control @xmath71 that retrieves the spin wave into that mode .",
    "the phase of @xmath71 , up to an unimportant constant phase , is given by the phase of the desired output mode plus compensation for the stark shift ( the last factor ) .",
    "it is also worth noting that , up to a minus sign and a factor equal to the first fraction in eq .",
    "( [ cavretoptom ] ) , @xmath71 is simply equal to @xmath156 .",
    "we note that , if one wants to shape the retrieval into a mode @xmath150 that drops to zero at some time @xmath119 sufficiently rapidly , @xmath154 in eq .",
    "( [ cavretoptom ] ) will go to @xmath157 at @xmath158 .",
    "the infinite part can , however , be truncated without significantly affecting the efficiency or the precision of @xmath150 generation .",
    "one can confirm that the loss in efficiency is small by inserting into the adiabatic solution in eq .",
    "( [ etacavfiniteh ] ) a value of @xmath142 that is finite but large enough to satisfy eq .",
    "( [ cavrethcond ] ) .",
    "one can similarly confirm that the generation of @xmath150 can be precise with truncated control fields by using eq .",
    "( [ cavadeout ] ) . however , to be completely certain that the truncation is harmless , one has to solve eqs .",
    "( [ caveout])-([cavseq ] ) numerically without making the adiabatic approximation .",
    "we will do this in sec .",
    "[ sec : cavadcond ] for the case of storage , where the same truncation issue is present .",
    "we briefly mention that the spin - wave decay rate @xmath77 , which we have ignored so far , simply introduces a decay described by @xmath159 into eq .",
    "( [ cavadeout ] ) and , unless we retrieve much faster than @xmath160 , makes retrieval efficiency control dependent . with nonzero @xmath77 ,",
    "we can still shape retrieval to go into any mode : we shape the control using eq .",
    "( [ cavretoptom ] ) as if there were no @xmath77 decay except that the desired output mode @xmath150 should be replaced with the normalized version of @xmath161 , i.e. , @xmath162^{-\\frac{1}{2}}.\\ ] ] the retrieval efficiency will , however , be output - mode - dependent in this case : it will be multiplied ( and hence reduced ) by @xmath163^{-1}$ ] .      in principle , using the solution for retrieval from the previous section , the time - reversal argument of sec .",
    "iv immediately guarantees that , provided we are in the adiabatic limit ( conditions to be discussed in sec .",
    "[ sec : cavadcond ] ) , we can always shape the control field to store any input mode @xmath40 at any detuning @xmath7 with the maximum efficiency @xmath1 . however , for completeness , and to verify that the optimal storage control field is indeed the time reverse of the control field that retrieves into @xmath164 , we give in this section the solution to adiabatic storage .    in the adiabatic approximation , we use a procedure very similar to that used in the retrieval solution , to find @xmath165 where @xmath166 the storage efficiency is then @xmath167 we are interested in computing the control that maximizes @xmath168 for a given @xmath40 .",
    "we find in appendix [ sec : appstor ] that the maximum storage efficiency is @xmath1 and that it can be achieved ( in the adiabatic limit ) for any @xmath7 and @xmath40 , and that the optimal control is @xmath169 where @xmath170 can be found by inserting eq .",
    "( [ cavstoptom ] ) into eq .",
    "( [ hdefcav ] ) .",
    "the phase of @xmath71 , up to an unimportant constant phase , is thus given by the phase of the input mode plus compensation for the stark shift ( the last factor ) .",
    "as for the retrieval control discussed in the previous section , we note that , although @xmath154 in eq .",
    "( [ cavstoptom ] ) goes to @xmath157 at @xmath132 , the infinite part can be truncated without significantly affecting the efficiency .",
    "this can be confirmed analytically using eq .",
    "( [ cavetas ] ) provided the adiabatic limit is satisfied .",
    "we will also confirm this numerically in the next section without making the adiabatic approximation .    as expected from the time - reversal argument",
    ", the optimal control we derived is just the time reverse ( @xmath171 ) of the control that retrieves into @xmath164 , the time reverse of the input mode .",
    "we verify this in appendix [ sec : appstor ] .",
    "although optimal storage efficiencies are the same in the raman and adiabatic limits , as in the case of retrieval , rather different physical behavior can be seen in the two limits .",
    "it is now the dependence on @xmath2 of the optimal control intensity ( which can be found from eq .",
    "( [ cavstoptom ] ) ) that can be used to separate resonant and raman behavior .",
    "assuming for simplicity @xmath144 , in the resonant limit ( @xmath145 ) , @xmath172 , while in the raman limit ( @xmath147 ) , @xmath173 . since complete retrieval and optimal storage",
    "are just time reverses of each other , it is not surprising that these relations are identical to the ones we derived for the dependence of output pulse duration on @xmath2 in the previous section .",
    "this opposite dependence of @xmath174 on @xmath2 in the raman and eit limits is , in fact , the signature of a simple physical fact : while the coupling of the input photon to the spin wave increases with increasing @xmath13 in the raman case , it effectively decreases in the eit regime where a very large @xmath13 will give a very wide transparency window and a group velocity equal to the speed of light .",
    "this is why as the cooperativity parameter changes , the control has to be adjusted differently in the two regimes .    as for retrieval",
    ", we briefly mention that nonzero @xmath77 simply introduces @xmath175 decay into eq .",
    "( [ cavadf ] ) .",
    "the optimal storage control can still be found using eq .",
    "( [ cavstoptom ] ) as if there were no decay , except that the input mode should be replaced with the normalized version of @xmath176 , i.e. , @xmath177^{-\\frac{1}{2}}\\!.\\ ] ] however , the optimal storage efficiency will now depend on input pulse duration and shape : it will be multiplied ( and hence reduced ) by @xmath178 .",
    "it is important to note that with nonzero spin - wave decay the optimal storage efficiency of a particular input mode is no longer identical to the retrieval efficiency into its time reverse .",
    "this is not at variance with the time - reversal argument discussed in detail in paper ii ( which still applies when @xmath179 ) , since the corresponding optimal storage and retrieval control shapes are no longer the time reverses of each other , and , in contrast to the @xmath100 case , the retrieval efficiency is now control dependent .",
    "finally , we note that , when we consider storage followed by retrieval , in order to take into account the spin - wave decay during the storage time @xmath180 $ ] , one should just multiply the total efficiency by @xmath181 .",
    "we have found that , provided we are in the adiabatic limit , any input mode can be stored optimally . in this section",
    "we show that , independent of @xmath7 , the sufficient and necessary condition for optimal adiabatic storage of a pulse of duration @xmath5 to be consistent with the adiabatic approximation is @xmath3 .    to find the conditions for the adiabatic elimination of @xmath116 in eq .",
    "( [ cavpeq ] ) , we do the elimination and then require its consistency by enforcing @xcite latexmath:[\\[\\label{cavpdot }    throughout this section that @xmath144 ) . during retrieval , sufficient conditions for eq .",
    "( [ cavpdot ] ) are @xmath183 which limit , respectively , the power and the bandwidth of the control pulse .",
    "these are easily satisfied in practice by using sufficiently weak and smooth retrieval control pulses .    during storage , the satisfaction of eq .",
    "( [ cavpdot ] ) requires , in addition to conditions ( [ cavcond1 ] ) and ( [ cavcond2 ] ) , the satisfaction of @xmath184 which limits the bandwidth of the input pulse .",
    "in particular , for a smooth input pulse of duration @xmath5 , this condition is implied by @xmath185 let us now show that for optimal storage , the condition ( [ cavcond ] ) also implies conditions ( [ cavcond1 ] ) and ( [ cavcond2 ] ) and is thus the only required adiabaticity condition ( provided @xmath186 is smooth ) .",
    "application of eq .",
    "( [ cavstoptom ] ) reduces eq .",
    "( [ cavcond1 ] ) to eq .",
    "( [ cavcond ] ) .",
    "equation ( [ cavcond2 ] ) , in turn , reduces to the conditions on how fast the magnitude @xmath174 and the phase @xmath187 ( which compensates for the stark shift ) of the control can change : @xmath188 where @xmath189 .",
    "application of eq .",
    "( [ cavstoptom ] ) shows that eq .",
    "( [ cavcond ] ) implies eq .",
    "( [ cavomchange ] ) .",
    "we have thus shown that @xmath3 is a sufficient condition for the validity of adiabatic elimination in optimal storage .",
    "but , in fact , from the amplitude of the optimal storage control field ( eq .  ( [ cavstoptom ] ) ) , one can see that eq .",
    "( [ cavcond1 ] ) implies that @xmath3 is also a necessary condition for the validity of adiabatic elimination in optimal storage .",
    "( to show that @xmath3 is a necessary condition , one also has to use the extra condition on the adiabatic value of @xmath190 @xcite to rule out the special situation when @xmath71 is such that eq .",
    "( [ cavpdot ] ) is satisfied but eq .",
    "( [ cavcond1 ] ) is not . )    to verify the adiabaticity condition in eq .",
    "( [ cavcond ] ) and investigate the breakdown of adiabaticity for short input pulses , we consider a gaussian - like input mode ( shown in fig .  3 of paper ii ) @xmath191 where for computational convenience we have required @xmath192 and where @xmath193 is a normalization constant .",
    "we fix the cooperativity parameter @xmath2 , the detuning @xmath7 , and the pulse duration @xmath5 , and use eq .",
    "( [ cavstoptom ] ) to shape the control field .",
    "we then use eqs .",
    "( [ cavpeq ] ) and ( [ cavseq ] ) _ without _ the adiabatic approximation to calculate numerically the actual storage efficiency that this control field gives , and multiply it by the control - independent retrieval efficiency @xmath1 , to get the total efficiency of storage followed by retrieval .",
    "as we decrease @xmath5 , we expect this efficiency to fall below @xmath194 once @xmath3 is no longer satisfied . and indeed in fig .",
    "[ fig : cavadbreak](a ) we observe this behavior for @xmath195 and @xmath196 . in fig .",
    "[ fig : cavadbreak](b ) , we fix @xmath197 and show how optimal adiabatic storage breaks down at different detunings @xmath7 from @xmath126 to @xmath198 . from fig .  [",
    "fig : cavadbreak](b ) , we see that , as we move from the resonant limit ( @xmath199 ) to the raman limit ( @xmath200 ) , we can go to slightly smaller values of @xmath201 before storage breaks down . however , since the curves for @xmath202 and @xmath203 almost coincide , it is clear that @xmath3 is still the relevant condition no matter how large @xmath7 is , which must be the case since the condition ( [ cavcond1 ] ) breaks down for shorter @xmath5 .",
    "the most likely reason why in the raman limit adiabaticity is slightly easier to satisfy is because in the raman limit it is only condition ( [ cavcond1 ] ) that reduces to @xmath3 , while conditions ( [ cavcond2 ] ) and ( [ cavcond3 ] ) reduce to @xmath204 , which is weaker than @xmath3 ( since @xmath205 in the raman limit ) . in the resonant limit , in contrast , all three conditions ( [ cavcond1])-([cavcond3 ] ) reduce to @xmath3 .    before turning to the discussion of fast retrieval and storage",
    ", we note that the use of eq .",
    "( [ cavstoptom ] ) to calculate the storage control fields for fig .",
    "[ fig : cavadbreak ] resulted in a control field @xmath71 whose magnitude went to @xmath157 at @xmath206 , as predicted in the previous section . to generate fig .",
    "[ fig : cavadbreak ] , the optimal @xmath154 were therefore cut off for @xmath207 to take the value @xmath208 .",
    "the fact that the optimal efficiency of @xmath194 represented by the dashed lines in fig .",
    "[ fig : cavadbreak ] is still achieved by the dotted curves , despite the use of truncated controls , proves that truncation of the storage control does not significantly affect the storage efficiency . since the retrieval field generation is directly related to optimal storage by time reversal , as explained in sec .",
    "[ sec : cavopt ] , this also means that truncating retrieval controls does not significantly affect the precision with which a given retrieval mode @xmath150 can be generated .",
    "the losses associated with truncation are insignificant only if the conditions in eq .",
    "( [ cavrethcond ] ) and eq .",
    "( [ cavsthcond ] ) are still satisfied for the truncated retrieval and storage control fields , respectively . if the limit on the control pulse energy is so tight that these conditions are not satisfied , a separate optimization problem , which is beyond the scope of the present paper , has to be solved .",
    "we have shown that adiabatic storage allows us to store optimally a mode of duration @xmath5 , having any smooth shape and any detuning @xmath7 , provided that the adiabaticity condition @xmath3 is satisfied . in this section",
    "we solve eq .",
    "( [ cavoneeq ] ) analytically in the second important limit , the so - called  fast \" limit , and show that this limit allows for optimal storage of a certain class of input modes of duration @xmath28 .",
    "the fast limit corresponds to the situation when @xmath13 is very large during a short control pulse ( @xmath209 and @xmath210 ) , so that we can neglect all terms in eq .",
    "( [ cavoneeq ] ) except @xmath211 and @xmath212 .",
    "this corresponds to keeping only terms containing @xmath13 on the right - hand side of eqs .",
    "( [ cavpeq ] ) and ( [ cavseq ] ) and results in undamped rabi oscillations between optical and spin polarizations @xmath116 and @xmath134 .",
    "one can use this limit to implement a `` fast '' storage scheme , in which the input pulse is resonant ( @xmath195 ) and the control pulse is a short @xmath26 pulse at @xmath213 , as well as fast retrieval , in which the control is a @xmath26-pulse at @xmath133 . provided the @xmath26 pulse",
    "is applied on resonance and at approximately constant intensity , the condition for perfect @xmath26 pulse performance is @xmath209 ( assuming @xmath144 ) . to fully describe these processes",
    ", we furthermore need to solve eq .",
    "( [ cavoneeq ] ) while the control is off , which can also be done analytically .    during fast retrieval , assuming the @xmath26 pulse takes place at time @xmath206 instead of time @xmath214 and assuming the @xmath26 pulse is perfect , the initial @xmath215 results after the @xmath26 pulse in @xmath216 .",
    "we then solve for @xmath217 from eq .",
    "( [ cavpeq ] ) and insert the solution into eq .",
    "( [ caveout ] ) to obtain @xmath218 consistent with the general expression in eq .",
    "( [ cavetar ] ) and the branching ratio argument in sec .",
    "[ sec : cavopt ] , the retrieval efficiency is again @xmath1 .    an alternative explanation for why the fast retrieval gives the same retrieval efficiency as the adiabatic retrieval is that , thanks to the adiabatic elimination of @xmath116 , the adiabatic limit effectively describes a two - level system . therefore , eq .  ( [ cavfasteout ] ) is in fact a special case of eq .",
    "( [ cavadeout ] ) with @xmath219 although , at this @xmath71 , eq .",
    "( [ cavadeout ] ) is not a good approximation to the actual output field because , for example , condition ( [ cavcond1 ] ) is not satisfied , this illustrates the equivalence of the two approaches .",
    "since the control field in fast retrieval is not adjustable ( it is always a perfect @xmath26 pulse ) , fast retrieval gives only one possible output mode , that of eq .",
    "( [ cavfasteout ] ) . by time reversal ,",
    "the time reverse of this mode of duration @xmath220 is thus the only mode that can be optimally stored ( with efficiency @xmath1 ) using fast storage at this @xmath2 .",
    "for completeness and to confirm the time - reversal argument , the optimal input mode for fast storage can also be calculated directly . for an input mode @xmath40 that comes in from @xmath206 to @xmath221 , assuming a perfect @xmath26 pulse at @xmath221 , we find by a method similar to the one used in fast retrieval that @xmath222 where @xmath223 similarly to retrieval , eq .",
    "( [ cavfastf ] ) is a special case of eq .",
    "( [ cavadf ] ) with @xmath224 ( the time reverse of the right - hand side of eq .",
    "( [ cavfastom ] ) ) . since @xmath225 is real and normalized according to @xmath226 , this integral is a scalar product similar to eq .",
    "( [ cavetas ] ) discussed in appendix [ sec : appstor ] , and the optimal fast storage efficiency of @xmath1 is achieved for a single input mode @xmath227 ( up to an arbitrary overall unimportant phase ) .",
    "this optimal @xmath40 is precisely the ( renormalized ) time reverse of the output of fast readout in eq .",
    "( [ cavfasteout ] ) , as expected by time reversal .",
    "two comments are in order regarding the optimal input pulse @xmath227 .",
    "first , we would like to note that short exponentially varying pulses , as in our optimal solution @xmath227 , have been proposed before to achieve efficient photon - echo - based storage @xcite .",
    "second , it is worth noting that , although @xmath227 gives the optimal storage , generating such short exponentially rising pulses may in practice be hard for high @xmath2 . since the efficiency is given by the overlap of @xmath40 with @xmath225 ( see eq .  ( [ cavfastst ] ) ) , fast storage in a cavity is inferior in this respect to fast storage in free space , because in the latter case any input pulse satisfying @xmath39 and @xmath228 results in storage efficiency close to unity @xcite .",
    "in conclusion , we have treated in detail the storage and retrieval of photons in homogeneously broadened @xmath0-type atomic media enclosed in a running - wave cavity .",
    "we have shown that , provided that no excitations are left in the atoms at the end of the retrieval process , the retrieval efficiency is independent of the control and the detuning and is equal to @xmath1 .",
    "we have also derived the optimal strategy for storage in the adiabatic and fast limits and , therefore , demonstrated that one can store , with the optimal efficiency of @xmath1 , any smooth input mode satisfying @xmath3 and having any detuning @xmath7 and a certain class of resonant input modes satisfying @xmath4 .",
    "we have also noted that the optimal storage control field for a given input mode is the time reverse of the control field that accomplishes retrieval into the time reverse of this input mode .",
    "this fact and the equality of maximum storage efficiency and the retrieval efficiency are , in fact , the consequence of a general time - reversal argument to be presented in detail in paper ii . in paper ii",
    ", we will also present the full discussion of photon storage in homogeneously broadened @xmath0-type atomic media in free space , while in paper iii , we will consider the effects of inhomogeneous broadening on photon storage .    finally , it is important to note that , to achieve the optimal efficiencies derived in the present paper , it is necessary to have rigid temporal synchronization between the input pulse and the storage control pulse , which may become difficult in practice for short input pulses .",
    "in fact , since there is only one accessible atomic mode in the case of homogeneously broadened media enclosed in a cavity ( unless one varies the angle between the control and the input @xcite ) , this temporal synchronization is necessary to obtain high efficiencies even if the cooperativity parameter is very large .",
    "this problem can , however , be alleviated whenever multiple atomic modes are accessible , which is the case for homogeneously broadened media in free space considered in paper ii and for inhomogeneously broadened media considered in paper iii . in those cases ,",
    "infinite optical depth allows one to achieve unit efficiency without rigid synchronization .",
    "however , despite this disadvantage of the cavity setup , we will discuss in paper ii that the cavity setup is superior to the free - space setup in other respects , such as the enhancement of the optical depth by the cavity finesse and the avoidance of the unfavorable scaling of the error as @xmath229 ( vs @xmath230 ) , which sometimes occurs in the free - space model .",
    "we thank m.  fleischhauer , m.  d.  eisaman , e.  polzik , j.  h.  mller , a.  peng , i.  novikova , d.  f.  phillips , r.  l.  walsworth , m.  hohensee , m.  klein , y.  xiao , n.  khaneja , a.  s.  zibrov , p.  walther , and a.  nemiroski for fruitful discussions .",
    "this work was supported by the nsf , danish natural science research council , darpa , harvard - mit cua , and sloan and packard foundations .",
    "in sec .  [ sec : cavmod ] , we gave a brief introduction to the model and presented the equations of motion without derivation . in this appendix ,",
    "the details of the model and the derivation of the equations of motion ( [ caveqs1])-([caveqs3 ] ) are provided .",
    "the electric - field vector operator for the cavity field is given by @xmath231 where @xmath232 is the mode creation operator , @xmath233 is the mode frequency , @xmath234 is the polarization unit vector , @xmath235 is the permittivity of free space , @xmath236 is the quantization volume for the field , and @xmath237 is the speed of light .",
    "the copropagating single - mode classical plane - wave control field with frequency @xmath238 is described by an electric - field vector @xmath239 where @xmath240 is the polarization unit vector , and @xmath241 is the amplitude .",
    "then , using the dipole and rotating - wave approximations , the hamiltonian is @xmath242 here @xmath243 stands for hermitian conjugate , @xmath244 is the internal state operator of the @xmath245th atom between states @xmath246 and @xmath247 , @xmath248 is the position of the @xmath245th atom , @xmath249 is the dipole moment vector operator for the @xmath245th atom , @xmath250 ( assumed to be equal for all @xmath245 ) is the rabi frequency of the classical field , and @xmath251 ( assumed to be real for simplicity and equal for all @xmath245 ) is the coupling constant between the atoms and the quantized field mode .",
    "we note that , in order to avoid carrying extra factors of @xmath252 around , @xmath13 is defined as half of the traditional definition of the rabi frequency , so that a @xmath26 pulse , for example , takes time @xmath253 .    in the heisenberg picture , we introduce slowly varying collective atomic operators @xmath254 and a slowly varying cavity mode annihilation operator @xmath255 which satisfy same - time commutation relations @xmath256 & = & \\delta_{\\nu \\alpha } \\hat \\sigma_{\\mu \\beta}(t ) - \\delta_{\\mu \\beta } \\hat \\sigma_{\\alpha \\nu}(t ) ,",
    "\\\\ \\left[\\hat { \\mathcal{e}}(t),\\hat { \\mathcal{e}}^\\dagger(t)\\right ] & = & 1,\\end{aligned}\\ ] ] and yield an effective rotating frame hamiltonian @xmath257 the equations of motion are then given by @xmath258 with the input - output relation for the quantum field given by eq .",
    "( [ io ] ) .    in eqs .",
    "( [ fullcavityeq ] ) we have introduced decay , which , in turn , necessitated the introduction of langevin noise operators @xmath259 for the atomic operators and the input field @xmath260 for the quantum field . the radiative decay rate of the excited state @xmath261 is @xmath262 , the sum of decay rates into @xmath20 and into @xmath263 .",
    "the decay rate of optical coherence @xmath264 is @xmath265 where , in addition to radiative decay , we allow for extra dephasing , such as , for example , that caused by collisions with buffer gas atoms in warm vapor cells .",
    "similarly , the decay rate @xmath266 of @xmath267 allows for possible extra dephasing , while the decay rate @xmath77 of @xmath268 is due to dephasing only . in some experiments",
    "@xcite , @xmath77 comes from the transverse diffusion of atoms out of the region defined by the quantized light mode . in these cases ,",
    "the decay of @xmath268 will be accompanied by population redistribution between states @xmath263 and @xmath20 . in order to ensure that the corresponding incoming noise is vacuum ( which our analysis requires , as we explain below and in sec .",
    "[ sec : effic ] ) , we will assume in such cases that the incoming atoms are fully pumped into the level @xmath263 , which would correspond to a @xmath269 decay rate of @xmath270 into @xmath271 ( not included in eqs .",
    "( [ fullcavityeq ] ) since it does not affect the final equations ) .",
    "this is indeed the case if , as in ref .",
    "@xcite , the control beam diameter is much greater than the diameter of the quantized light mode .    assuming that almost all atoms are in the ground state at all times ( @xmath272 and @xmath273 ) , defining polarization @xmath274 and spin wave @xmath275 , and working to first order in @xmath75 , we obtain eqs .",
    "( [ caveqs1])-([caveqs3 ] ) , where @xmath276 and @xmath277 .    using the generalized einstein relations @xcite @xmath278 where @xmath279 denotes the deterministic part ( i.e. , with noise omitted ) of the equation for @xmath280 in eqs .",
    "( [ fullcavityeq ] ) , and again using the approximation that almost all atoms are in the ground state , we find that the only nonzero noise correlations between @xmath78 , @xmath79 , @xmath281 , and @xmath282 are @xmath283 the fact that normally ordered correlations are zero means that the incoming noise is vacuum , which is precisely the reason why , as noted in sec .  [",
    "sec : effic ] , efficiency is the only number we need in order to fully characterize the mapping .",
    "the property of eqs .",
    "( [ fullcavityeq ] ) that guarantees that the incoming noise is vacuum is the absence of decay out of state @xmath263 into states @xmath11 and @xmath20 .",
    "the decay into state @xmath11 does not happen because the energy of an optical transition ( on the order of @xmath284 k ) is much greater than the temperature , at which typical experiments are done .",
    "in contrast , the energy of the @xmath14 transition in some experiments , such as the one in ref .",
    "@xcite , may be smaller than the temperature . however , the @xmath14 transition is typically not dipole allowed , so that the rate of @xmath263 decay into @xmath20 can be neglected , as well .",
    "as noted above , for the case when atoms are diffusing in and out of the quantized light mode , to keep the decay rate of @xmath263 zero , we assume that the incoming atoms are fully pumped into @xmath263 .    from eq .",
    "( [ cavcomrel ] ) and with the usual @xmath272 assumption , we have @xmath285 = 1 , \\\\",
    "\\left[\\hat p(t),\\hat p^\\dagger(t)\\right ] = 1.\\end{aligned}\\ ] ] in particular , this means that @xmath84 can be thought of as an annihilation operator for the spin - wave mode , into which we would like to store the state of the incoming photon mode .",
    "the input and output fields , which propagate freely outside of the cavity , satisfy @xcite @xmath286 = \\left[\\hat { \\mathcal{e}}_\\textrm{out}(t),\\hat { \\mathcal{e}}^\\dagger_\\textrm{out}(t')\\right ] = \\delta(t - t')\\ ] ] and can be expanded in terms of any orthonormal set of field ( envelope ) modes @xmath287 defined for @xmath288 , satisfying the orthonormality relation @xmath289 and completeness relation @xmath290 , as @xmath291 where annihilation operators @xmath292 and @xmath293 for the input and the output photon modes , respectively , satisfy @xmath294 = \\left[\\hat b_\\alpha , \\hat b^\\dagger_\\beta\\right ] = \\delta_{\\alpha \\beta}.\\ ] ]    repeating for clarity the setup from sec .",
    "[ sec : cavmod ] , we recall that all atoms are initially pumped into the ground state , i.e. , no @xmath83 or @xmath84 excitations are present in the atoms .",
    "we also assume that the only input field excitations initially present are in the quantum field mode with annihilation operator @xmath48 and envelope shape @xmath85 nonzero on @xmath86 $ ] .",
    "the goal is to store the state of this mode into @xmath84 and at a time @xmath87 retrieve it back onto a field mode . during storage , we can",
    ", in principle , solve the operator eqs .",
    "( [ caveqs1])-([caveqs3 ] ) for @xmath295 as some linear functional of @xmath296 , @xmath297 , @xmath298 , @xmath299 , and @xmath300 .",
    "the storage efficiency is then given by @xmath301 since @xmath299 and @xmath300 give zero when acting on the initial state , and since all normally ordered noise correlations are zero , only the term in @xmath295 containing @xmath296 will contribute to the efficiency .",
    "moreover , @xmath302 is the only part of @xmath296 that does not give zero when acting on the initial state .",
    "thus , for the purposes of finding the storage efficiency , we can ignore @xmath78 and @xmath79 in eqs .",
    "( [ caveqs1])-([caveqs3 ] ) and treat these equations as complex number equations with @xmath88 , @xmath89 , and @xmath90 .",
    "we have here dropped the carets on the operators to denote their complex number representations . to get back the nonvacuum part of the original operator from its complex number counterpart",
    ", we should just multiply the complex number version by @xmath48 .",
    "similarly , during retrieval , we can ignore @xmath297 and @xmath298 and can treat eqs .",
    "( [ caveqs1])-([caveqs3 ] ) as complex number equations with the initial and boundary conditions given in sec .",
    "[ sec : cavmod ] .",
    "in this appendix , we present the derivation of eq .",
    "( [ cavstoptom ] ) , which gives the optimal storage control field during adiabatic storage .",
    "we then verify that this optimal control is just the time reverse of the control that retrieves into the time reverse of the input mode .    to solve for the control field @xmath71 that maximizes the storage efficiency @xmath168 in eq .",
    "( [ cavetas ] ) , we note that @xmath225 defined in eq .",
    "( [ cavadf ] ) satisfies @xmath303 , with the equality achieved when @xmath304 which is equivalent to the requirement we had in eq .",
    "( [ cavrethcond ] ) for complete retrieval .",
    "since we also have @xmath305 , the integral in eq .",
    "( [ cavetas ] ) can be seen as a simple scalar product between states , and the efficiency is therefore @xmath306 with the equality achieved when ( up to an undefined overall unimportant phase ) @xmath307 we will now show that , for any given @xmath40 , @xmath7 , and @xmath2 , there is a unique control that satisfies eq .",
    "( [ cavimped ] ) and thus gives the maximum storage efficiency @xmath1 . in refs .",
    "@xcite , this control was found through a quantum impedance matching bernoulli equation obtained by differentiating eq .",
    "( [ cavimped ] ) . in order to be able in paper ii to generalize more easily to free space",
    ", we will solve eq .",
    "( [ cavimped ] ) directly . to do this",
    ", we follow a procedure very similar to that in sec .",
    "[ sec : cavadret ] .",
    "we integrate the norm squared of eq .",
    "( [ cavimped ] ) from @xmath126 to @xmath137 to get @xmath308 since @xmath309 , the normalization of @xmath40 requires the satisfaction of eq .",
    "( [ cavsthcond ] ) . assuming it is satisfied to the desired precision",
    ", we solve eq .",
    "( [ cavint ] ) for @xmath170 , and then taking the square root of the negative of its derivative with respect to @xmath137 , we find @xmath154 .",
    "knowing @xmath170 , the phase of @xmath71 can then be determined from eq .",
    "( [ cavimped ] ) . putting the magnitude and the phase together ,",
    "we obtain the expression for the optimal control given in eq .",
    "( [ cavstoptom ] ) .",
    "we will now show that , as expected from the time - reversal argument , the optimal control we derived is just the time reverse ( @xmath171 ) of the control that retrieves into @xmath164 , the time reverse of the input mode . to see this",
    ", we note that from eq .",
    "( [ eeq ] ) it follows that the magnitude of the control field @xmath71 that retrieves into @xmath310 is determined by @xmath311 putting @xmath310 into eq .",
    "( [ cavretoptom ] ) , taking the complex conjugate of the result , and evaluating at @xmath312 , we get @xmath313 since @xmath314 determined by eq .",
    "( [ heq ] ) and @xmath170 determined by eq .",
    "( [ cavint ] ) are equal , the right - hand side of eq .",
    "( [ omstar ] ) is , in fact , equal to the right - hand side of eq .",
    "( [ cavstoptom ] ) , as desired .",
    "s. r. hastings - simon , m. u. staudt , m. afzelius , p. baldi , d. jaccard , w. tittel , and n. gisin , opt .",
    "commun . * 266 * , 716 ( 2006 ) ; m. u. staudt , s. r. hastings - simon , m. afzelius , d. jaccard , w. tittel , and n. gisin , _ ibid . _ * 266 * , 720 ( 2006 ) ; m. u. staudt , s. r. hastings - simon , m. nilsson , m. afzelius , v. scarani , r. ricken , h. suche , w. sohler , w. tittel , and n. gisin , phys . rev . lett .",
    "* 98 * , 113601 ( 2007 ) .",
    "s. a. moiseev and b. s. ham , phys .",
    "a * 70 * , 063809 ( 2004 ) ; s. a. moiseev and m. i. noskov , laser phys . lett .",
    "* 1 * , 303 ( 2004 ) ; s. a. moiseev , izv .",
    "nauk , ser .",
    "fiz . * 68 * , 1260 ( 2004 ) [ bull .",
    "phys . * 68 * , 1408 ( 2004 ) ] ; s. a. moiseev , c. simon , and n. gisin , e - print arxiv : quant - ph/0609173 ; n. sangouard , c. simon , m. afzelius , and n. gisin , phys .",
    "a * 75 * , 032327 ( 2007 ) .",
    "we note for the sake of clarity that the storage scheme employed in ref .",
    "@xcite can not be regarded as a subset of the general scheme considered in the present work , and more work has to be done in order to compare the performance of the two .              for clarity",
    ", we note that , although it might , in principle , be possible to describe the experimental setup in ref .",
    "@xcite by our model , this setup is slightly different from our model in that the propagation directions of the control and the photon are orthogonal ( rather than the same ) and the cavity mode is a standing - wave mode ( rather than a running - wave mode ) .",
    "l. s. pontryagin , v. g. boltyanskii , r. v. gamkrelidze , and e f. mishchenko , _ the mathematical theory of optimal processes _ , translated by k. n. trirogoff , edited by l. w. neustadt ( gordon and breach science publishers , new york , 1986 ) .                            to be more precise , such time - reversed storage stores into the complex conjugate of the original spin - wave mode .",
    "we study in paper ii how , for the case of nonzero energy difference @xmath315 between states @xmath263 and @xmath20 , the position - dependent phase @xmath316 , by which a given spin wave and its complex conjugate differ , reduces the optimal efficiency of storage followed by backward retrieval , where backward retrieval means that the retrieval and storage controls are counter - propagating",
    ". however , in the present paper , we assume that , for storage followed by retrieval , the @xmath317 vectors of the storage and retrieval control fields are pointing in the same direction , in which case nonzero @xmath315 is not a problem .    to be precise , another condition in addition to eq .",
    "( [ cavpdot ] ) required for the validity of the adiabatic elimination is that @xmath190 derived from adiabatic elimination must be much less than @xmath318 , so that it is close to the given value of @xmath88 . during retrieval , this condition ,",
    "however , is equivalent to condition ( [ cavcond1 ] ) evaluated at @xmath206 .",
    "similarly , during storage of a sufficiently smooth pulse ( which will , thus , satisfy @xmath319 ) , the desired condition on the adiabatic value of @xmath190 is implied by condition ( [ cavcond ] ) .",
    "thus , we do not state this condition on the adiabatic value of @xmath190 separately ."
  ],
  "abstract_text": [
    "<S> in a recent paper [ gorshkov _ et al . _ , phys . </S>",
    "<S> rev . lett . * 98 * , 123601 ( 2007 ) ] , we used a universal physical picture to optimize and demonstrate equivalence between a wide range of techniques for storage and retrieval of photon wave packets in @xmath0-type atomic media in free space , including the adiabatic reduction of the photon group velocity , pulse - propagation control via off - resonant raman techniques , and photon - echo - based techniques . in the present paper , we perform the same analysis for the cavity model . in particular , we show that the retrieval efficiency is equal to @xmath1 independent of the retrieval technique , where @xmath2 is the cooperativity parameter . </S>",
    "<S> we also derive the optimal strategy for storage and , in particular , demonstrate that at any detuning one can store , with the optimal efficiency of @xmath1 , any smooth input mode satisfying @xmath3 and a certain class of resonant input modes satisfying @xmath4 , where @xmath5 is the duration of the input mode and @xmath6 is the transition linewidth . in the two subsequent papers of the series , we present the full analysis of the free - space model and discuss the effects of inhomogeneous broadening on photon storage . </S>"
  ]
}