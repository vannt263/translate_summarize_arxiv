{
  "article_text": [
    "the graphs in this paper can be directed or undirected . consider a connected graph @xmath0 with a set @xmath11 of terminal vertices , or simply _ terminals _ , and a length ( or cost ) function @xmath12 .",
    "let @xmath13 be a root vertex ( i.e. there is a path from @xmath5 to any vertex in @xmath14 ) if @xmath4 is directed or a special vertex called _ root _ if @xmath4 is undirected . the ( rooted ) steiner tree problem ( ` steiner - tree ` ) is to determine a directed tree @xmath15 in @xmath4 , rooted at @xmath5 , spanning all terminals of @xmath9 and having a minimum total length .",
    "the undirected steiner tree problem , where one searches for a minimum - length tree spanning the terminals in an undirected graph , has been widely studied and the associated decision problem was one of karp s 21 np - complete problems @xcite .",
    "it also has many applications , as shown in @xcite .",
    "this problem is apx - hard @xcite , but it can be solved in polynomial time when the number of terminals is fixed @xcite , and admits constant ratio approximation algorithms otherwise @xcite .",
    "there are less results about the directed version , which is a generalization of the undirected one and of the set cover problem , and only non constant ratio approximation algorithms are known @xcite .",
    "directed problems occur for instance in vlsi design @xcite or in multicast routing @xcite .",
    "we consider in this paper a generalization of the ( rooted ) steiner tree problem .",
    "assume we are given a _",
    "function @xmath16 , where @xmath8 is an upper bound on the number of paths containing @xmath10 and linking @xmath5 to terminals .",
    "equivalently , for every @xmath17 in a tree @xmath15 rooted at @xmath5 , the subtree of @xmath15 rooted at @xmath18 can not contain more than @xmath8 terminals . without loss of generality ,",
    "we assume that @xmath19 for each edge @xmath10 .",
    "the minimum - length capacitated ( rooted ) steiner tree problem is defined as follows : + * minimum - length ( rooted ) capacitated steiner tree problem * ( ` ml - cap - steiner - tree ` )    _ input_. a connected graph @xmath20 ; a set @xmath21 of @xmath22 terminals ; a root vertex @xmath23 ; two functions on @xmath24 : a nonnegative length function @xmath25 and a positive capacity function @xmath26 .    _",
    "objective_. determine , if it exists , a minimum - length directed tree @xmath15 rooted at @xmath5 , that spans all the vertices of @xmath9 and does not violate the capacity constraints .",
    "+ if @xmath0 is undirected and @xmath17 is an arc of @xmath15 , then @xmath27 $ ] must be an edge of @xmath24 .",
    "note that ` steiner - tree ` is the special case of ` ml - cap - steiner - tree ` where @xmath28 for all @xmath7 ( in this case , a feasible solution always exists ) . `",
    "ml - cap - steiner - tree ` appears naturally in several contexts , for example when designing a wind farm collection network @xcite , in the design of telecommunication networks @xcite or in power distribution system optimization @xcite .",
    "when @xmath29 for all @xmath7 , ` ml - cap - steiner - tree ` turns into a decision problem , denoted by ` cap - steiner - tree ` , and consisting of determining whether there exists or not a tree rooted at @xmath5 , spanning all the terminals , and not violating the capacity constraints .    when @xmath30 , i.e. a feasible solution is a spanning tree , ` ml - cap - steiner - tree ` is solvable in polynomial time if @xmath31 for all @xmath7 , while it is np - hard if @xmath32 for all @xmath7 @xcite",
    "several authors propose models and methods based on mathematical programming to solve this capacitated spanning tree problem for real - life applications such as telecommunication network design problems @xcite .",
    "their methods allow to solve the case where there is a positive integer demand at each vertex ( instead of a unit demand as in ` ml - cap - steiner - tree ` ) . in @xcite ,",
    "the authors provide approximation algorithms for a variant of ` ml - cap - steiner - tree ` where the capacities are uniform and the problem always admits a feasible solution , since it is assumed that a metric completion of the graph is available .",
    "this paper addresses the problem where the demand is equal to 1 for each terminal vertex and @xmath33 .",
    "as will be made clear in the next sections , there are strong links between`ml - cap - steiner - tree ` and the two following famous problems , namely the minimum - length vertex - disjoint paths problem ( ` ml - vdisj - path ` ) and the minimum - length edge - cost flow problem ( ` edge - cost - flow ` ) .    * minimum - length vertex - disjoint paths problem * ( ` ml - vdisj - path ` )    _ input_. a graph @xmath0 ; a nonnegative length function @xmath25 on @xmath24 ; @xmath34 disjoint vertex pairs @xmath35 .    _",
    "objective_. find @xmath34 mutually vertex - disjoint paths @xmath36 of minimum total length so that @xmath37 links @xmath38 to @xmath39 @xmath40 .",
    "* minimum edge - cost flow problem * ( ` edge - cost - flow ` )    _ input_. a graph @xmath0 ; a positive integer @xmath41 ; two specified vertices @xmath42 and @xmath43 ; a nonnegative length function @xmath25 on @xmath24 ; a positive capacity function @xmath26 on @xmath24 .    _",
    "objective_. find a minimum - length feasible flow of @xmath41 units from @xmath42 to @xmath43 , where the length of a flow is the sum of the lengths of the arcs / edges carrying a positive flow .",
    "when @xmath29 for all @xmath7 , ` ml - vdisj - path ` is known as the vertex - disjoint paths problem and will be denoted by ` vdisj - path ` .",
    "it is np - complete in directed and undirected graphs @xcite and remains np - complete for fixed @xmath34 in directed graphs @xcite , but it can be solved in polynomial time if @xmath34 is fixed and the graph is either undirected @xcite or a directed acyclic graph @xcite .",
    "the np - hardness results for ` vdisj - path ` apply to ` ml - vdisj - path ` as well , but for this latter problem the complexity is unknown in the case where @xmath34 is fixed and the graph is undirected .",
    "however , a polynomial - time probabilistic algorithm for @xmath44 has been recently presented in @xcite .    for any graph",
    "theoretical terms not defined here , the reader is referred to @xcite .",
    "we use the term _ path _ both for a chain when the graph is undirected , and for a directed path when the graph is directed , i.e. when it is a digraph .",
    "if the graph is directed , recall that , in the definition of ` ml - cap - steiner - tree ` , @xmath5 is assumed to be a root vertex .",
    "this is a trivial necessary condition for the existence of a feasible solution and can be easily checked . since all trees studied in this paper are directed from @xmath5 towards the terminals , we use the term _ tree _ instead of directed tree .",
    "for a vertex @xmath18 in a tree @xmath15 , we denote by @xmath45 the subtree of @xmath15 rooted at @xmath18 . for a subgraph @xmath46 of @xmath4",
    ", we indifferently denote by @xmath47 or @xmath48 the sum of the lengths of the arcs / edges in @xmath49 .",
    "also , for @xmath7 , a rooted tree @xmath15 in @xmath4 , and two vertices @xmath50 and @xmath18 such that @xmath18 is a descendant of @xmath50 in @xmath15 , we say that @xmath50 is @xmath10__-linked _ _ ( resp .",
    "_ ) to @xmath18 in @xmath15 if @xmath10 belongs ( resp",
    ". does not belong ) to the path @xmath52 from @xmath50 to @xmath18 in @xmath15 .",
    "similarly , when we write that @xmath5 is @xmath51-linked to a subset @xmath53 of terminals in @xmath15 , this means that @xmath10 does not belong to the paths in @xmath15 that link @xmath5 to the terminals of @xmath53 .",
    "the capacity constraints therefore impose that , for all @xmath7 , @xmath5 is @xmath10-linked to at most @xmath8 terminals in any feasible solution @xmath15 to an ` ml - cap - steiner - tree ` instance .",
    "equivalently , @xmath45 contains at most @xmath8 terminals for all @xmath17 in @xmath15 .",
    "the next section gives an overview of our results concerning ` ml - cap - steiner - tree ` and explains how the paper is organized .",
    "in this section we show that our results provide a complete characterization of the complexity of ` ml - cap - steiner - tree ` that allows us to distinguish beween easy and hard cases of the problem for digraphs , directed acyclic graphs ( called dags ) and undirected graphs .",
    "notice that any undirected instance of ` ml - cap - steiner - tree ` can be transformed into a directed one by replacing each edge by two opposite arcs having the same length and capacity .",
    "hence , any positive result ( existence of a polynomial - time algorithm or approximation result ) for directed graphs is also true for undirected graphs , while any negative result for undirected graphs ( np - hardness or non - approximability result ) is also true for directed graphs .",
    ", the following parameters are considered : the number @xmath41 of terminal vertices , the minimum and maximum edge capacities , and the edge lengths .",
    "more precisely , @xmath41 can be fixed or not ; the minimum and maximum edge capacities can be non depending on @xmath41 ( equal to 1 or not ) , they can be greater than or equal to @xmath54 ( @xmath55 ) , and they can be equal ( uniform capacity ) or not ; the edge lengths can be all equal to @xmath56 , all equal to a positive value ( i.e. uniform ) , or non uniform .",
    "we settle all cases except one , namely the undirected case with uniform capacity and fixed @xmath57 , but we prove that ` ml - cap - steiner - tree ` is then equivalent to ` ml - vdisj - path ` in undirected graphs with fixed @xmath34 , whose complexity is a long - standing open problem in this case @xcite .",
    "our results are summarized in four tables .",
    "each line of each table corresponds to a specific case of ` ml - cap - steiner - tree ` and refers to the theorem where the case is settled .",
    "the first table contains results that are valid for the three types of graphs , while the next three tables contain results that are specific to digraphs , undirected graphs , and dags , respectively . in these tables , we denote by @xmath58 the best possible approximation ratio for ` steiner - tree ` , and by @xmath59 the best possible approximation ratio for ` ml - vdisj - path ` with a fixed number of source - sink pairs .",
    "the three trees drawn in figure 1 provide another picture of the possible cases for the three types of graphs ( digraphs , dags and undirected graphs ) .",
    "the numbers assigned to the leaves of these trees refer to the corresponding rows in the tables .",
    "the values of the three parameters appear on the branches and each branching node corresponds to a partition of the possible cases : the value on a branch excludes the values on the branches to the left .",
    "for instance , in undirected graphs , the capacities can be either uniform equal to 1 , or at least @xmath60 , or uniform of value at least 2 and at most @xmath61 , or , finally , any capacities not yet considered .",
    "moreover , if a leaf corresponds to a branch where the values of some parameters are unspecified , then this means that the associated result holds even in the most general case ( if it is a positive , i.e. , tractability result ) or in the most specific case ( if it is a negative , i.e. , hardness result ) with regard to the unspecified values .",
    "for instance , the np - hardness result associated with leaf 7 holds even if @xmath41 is fixed and if all lengths are 0 ( since neither the value of @xmath41 nor the lengths appear on this branch ) , and the result associated with leaf 11 holds for any lengths and any capacities ( since only the assumption on @xmath41 being fixed appears on this branch ) .",
    "therefore , for digraphs , the branch  any capacity \" includes the case of uniform capacities between 2 and @xmath61 for @xmath41 fixed ( or not ) .",
    "concerning the last line of table 3 , if the capacity is uniform and @xmath41 is fixed , then there exists some constant @xmath62 such that all capacities are equal to @xmath54 : hence , in the tree dealing with undirected graphs in figure [ fig : arbres ] , the branch `` any capacity '' , which leads to case 8 of table [ tabundirectedgraphs ] , excludes the case where @xmath41 is fixed .     & & & + & & & + & & & + & & & + & & & +     & & and @xmath63 & +    [ h ]     & & & + & & & + & & & + & & & +     & & & + & & & + & & & +    we describe in section 3 the structure of optimal solutions to an ` ml - cap - steiner - tree ` instance .",
    "section 4 is devoted to relations between ` ml - cap - steiner - tree ` and ` ml - vdisj - path ` .",
    "we prove in section 5 some np - hardness results for the general case , while special cases where the number @xmath41 of terminals is fixed , or where all capacities are almost equal to @xmath41 , are studied in sections 6 and 7 .",
    "we can assume , without loss of generality , that there is a bijection between the set of 1-degree vertices ( leaves ) in @xmath64 and @xmath9 . indeed ,",
    "if @xmath65 is not a leaf , we can add a new terminal vertex @xmath66 and an edge @xmath67 $ ] ( or an arc @xmath68 ) with capacity @xmath69 and length @xmath56 , and replace @xmath43 by @xmath66 in @xmath9 .",
    "moreover , if there is a leaf @xmath70 in @xmath4 , then @xmath18 can be removed from @xmath4 since the removal of @xmath18 from a solution @xmath15 to an ` ml - cap - steiner - tree ` instance gives a solution @xmath71 which is at least as good as @xmath15 .",
    "a solution @xmath15 ( if any ) to an ` ml - cap - steiner - tree ` instance is a tree rooted at @xmath5 , and defines @xmath41 paths from @xmath5 to the @xmath41 terminals .",
    "the vertices with degree at least 3 in @xmath72 are called _",
    "junction vertices_.    to each junction vertex @xmath18 , we associate the set @xmath73 of terminals in the subtree @xmath45 rooted at @xmath18 .",
    "moreover , for an arc @xmath17 in @xmath15 , @xmath74 is the number of terminals to which @xmath5 is @xmath10-linked in @xmath15 .",
    "if there is no directed path linking two vertices @xmath18 and @xmath75 in @xmath15 , then @xmath76 , otherwise @xmath15 would contain a cycle . given a tree",
    "@xmath15 spanning a set @xmath9 of terminals , its _ skeleton _ is the tree obtained from @xmath15 by iteratively contracting vertices @xmath77 with exactly one incoming arc @xmath78 and exactly one outgoing arc @xmath79 ( i.e. , the path @xmath80 is replaced by an arc @xmath81 ) .",
    "this means that there is an arc @xmath78 in the skeleton of @xmath15 if and only if there is a path from @xmath50 to @xmath18 in @xmath15 , each internal vertex of this path being of degree 2 in @xmath15 . when all capacities are 1 , the skeleton of a feasible solution is a star , since the root is the only possible vertex with degree @xmath82 in this skeleton .",
    "we now prove some properties which will be useful later .",
    "[ prop : numbvert ] the skeleton of an inclusion - wise minimal tree @xmath15 rooted at @xmath5 and spanning @xmath41 terminals ( all of degree 1 ) contains at most @xmath83 vertices , where @xmath84 is the degree of root @xmath5 in @xmath15 .",
    "let @xmath85 be the number of junction vertices in the skeleton @xmath86 of @xmath15 .",
    "clearly , @xmath86 contains @xmath87 vertices and @xmath88 edges . since the sum of the degrees of all vertices in @xmath86 is @xmath89 ,",
    "we have @xmath90 , which implies @xmath91 and @xmath92 .    [ prop : pathlength ] given an inclusion - wise minimal tree @xmath15 rooted at @xmath5 and spanning @xmath41 terminals ( all of degree 1 ) , the path with minimum number of vertices from root @xmath5 to a terminal in the skeleton of @xmath15 contains at most @xmath93 vertices .",
    "let @xmath86 be the skeleton of @xmath15 , @xmath94 its number of vertices , and @xmath95 the minimum number of vertices on a path from @xmath5 to a terminal in @xmath86 .",
    "* if @xmath5 has degree 1 in @xmath15 , then @xmath86 contains one vertex at levels 1 and 2 , and at least @xmath96 vertices at levels @xmath97 .",
    "hence , @xmath98 , which implies @xmath99 .",
    "* if @xmath5 has degree at least 2 in @xmath15 , then @xmath86 contains at least @xmath100 vertices at levels @xmath101 .",
    "hence , @xmath102 , which implies @xmath103 .    in both cases , it follows from property [ prop : numbvert ] that @xmath104 .",
    "notice that , if @xmath15 is a complete binary tree , then @xmath105 : therefore , up to a constant factor , the bound in the previous property can not be improved .",
    "given a graph @xmath4 with a root @xmath5 and @xmath41 terminals , a _ potential skeleton _ in @xmath4 is defined as a tree @xmath106 , rooted at @xmath5 , spanning the @xmath41 terminals , and such that the only vertices without outgoing arc are the @xmath41 terminals , while any other vertex , except possibly @xmath5 , has degree at least 3 in @xmath106 ( and hence in @xmath4 ) . while the skeleton of a solution to an ` ml - cap - steiner - tree ` instance is a potential skeleton , the reverse is not necessarily true , as illustrated in figure [ fig : potential ] .",
    "if we select the left arc incident to @xmath5 in the first potential skeleton of the figure , then there are no three vertex - disjoint paths from the left neighbor of @xmath5 to the terminals in @xmath4 .    [ h ]    . ]",
    "[ enumskelet ] given a graph @xmath4 with @xmath107 vertices , @xmath41 terminals , and a root vertex @xmath5 , it is possible to enumerate in @xmath108 time all potential skeletons of inclusion - wise minimal trees rooted at @xmath5 and spanning the @xmath41 terminals in @xmath4 .",
    "as shown in the proof of property [ prop : numbvert ] , the skeleton of such a tree contains at most @xmath60 junction vertices .",
    "there are @xmath109 ways of choosing at most @xmath60 junction vertices , and , for each such choice , it follows from cayley s formula that there are at most @xmath110 different labelled trees containing only @xmath5 , the @xmath41 terminals , and the chosen junction vertices .",
    "we can orient the edges of every labelled tree from the root @xmath5 towards the other vertices , which takes @xmath111 time per tree , and reject the labelled rooted trees that do not satisfy the definition of a potential skeleton .",
    "the whole procedure therefore takes @xmath108 time .",
    "we detail in this section several links between ` ml - cap - steiner - tree ` and some vertex - disjoint paths problems . we begin with a simple complexity result in the case of unit capacities . in this case ,",
    "an optimal solution to ` ml - cap - steiner - tree ` necessarily consists of @xmath41 vertex - disjoint paths with minimum total length , each one linking @xmath5 to a terminal , and we obtain the following theorem .    [ th : cstp - cap1 ] ` ml - cap - steiner - tree ` is polynomial - time solvable if @xmath112 @xmath113 .",
    "assume the input graph @xmath4 is directed , and let us add to @xmath4 a new vertex @xmath42 and an arc @xmath114 of length 0 and capacity 1 for each terminal @xmath115 .",
    "solving ` ml - cap - steiner - tree ` then amounts to finding @xmath41 internally vertex - disjoint paths from @xmath5 to @xmath42 , with minimum total length .",
    "it is well - known that this can be done in polynomial time , but we briefly recall how .",
    "we consider the graph @xmath116 obtained from @xmath4 by replacing each vertex @xmath117 by an arc @xmath118 of length 0 , and each arc @xmath119 ( resp .",
    "@xmath120 ) by an arc @xmath121 ( resp .",
    "@xmath122 ) having the same length as the original one .",
    "all capacities are set equal to 1 .",
    "it is then sufficient to determine a minimum - cost flow of @xmath123 units from @xmath5 to @xmath42 in @xmath116 by using any min - cost flow algorithm @xcite .",
    "recall that , if the graph @xmath4 is undirected , we can transform it into a directed one by replacing each edge by two opposite arcs . in this case , only one of two opposite arcs associated to an edge carries a positive flow in the solution .",
    "the following problem is a generalization of ` ml - vdisj - path ` .",
    "+ * minimum - length labelled vertex - disjoint paths problem * ( ` ml - lab - vdisj - path ` )    _ input_. a graph @xmath0 ; an integer @xmath124 ; a nonnegative length function @xmath25 on @xmath24 ; a label @xmath125 on every @xmath7 ; @xmath34 disjoint vertex pairs ( @xmath38 , @xmath39 ) , each one being associated with a set @xmath126 of labels .",
    "_ objective _ : find @xmath34 mutually vertex - disjoint paths @xmath36 of minimum total length so that @xmath37 links @xmath38 to @xmath39 and all labels on @xmath37 belong to @xmath127 @xmath40 .",
    "+ when @xmath29 for all @xmath7 , ` ml - vdisj - path ` ( resp . `",
    "ml - lab - vdisj - path ` ) turns into a decision problem , denoted by ` vdisj - path ` ( resp . `",
    "lab - vdisj - path ` ) .",
    "notice that ` ml - vdisj - path ` is the special case of ` ml - lab - vdisj - path ` where @xmath128 for @xmath129 .",
    "we now show several links between ` ml - cap - steiner - tree ` and some variants of ` ml - vdisj - path ` and ` ml - lab - vdisj - path ` .",
    "[ th : reductionfrommvdp ] ` ml - vdisj - path ` with @xmath34 source - sink pairs is polynomially reducible to ` ml - cap - steiner - tree ` with @xmath130 terminals .",
    "assume first that the input graph @xmath0 of the ` ml - vdisj - path ` instance is undirected .",
    "let @xmath46 be defined as follows : @xmath131 is obtained by adding to @xmath14 a vertex @xmath5 and @xmath132 terminals @xmath133 , @xmath134 ; @xmath135 is obtained from @xmath24 by adding an edge of capacity @xmath136 and length 0 between @xmath5 and every @xmath38 , @xmath129 , as well as edges of capacity 1 and length 0 between @xmath39 and every @xmath133 , @xmath134 .",
    "the edges of @xmath24 keep their original length , while their capacity is fixed to @xmath34 .",
    "we prove that solving ` ml - vdisj - path ` in @xmath4 is equivalent to solving ` ml - cap - steiner - tree ` in @xmath49 .",
    "the construction of @xmath49 from @xmath4 is illustrated in figure [ fig : mndpcstp ] for @xmath137 , with the pair @xmath138 on every @xmath139 .",
    "[ htbp ]     with @xmath137 to ` ml - cap - steiner - tree ` in @xmath46 with @xmath140 . ]    given a solution @xmath15 to ` ml - vdisj - path ` in @xmath4 , one can get a solution @xmath71 to`ml - cap - steiner - tree ` in @xmath49 of same total length by orienting all paths from @xmath38 to @xmath39 , @xmath129 , and then adding the @xmath34 arcs @xmath141 , as well as the @xmath130 arcs incident to the terminals",
    ".    now , assume there is a solution @xmath71 for ` ml - cap - steiner - tree ` in @xmath49 . since there are @xmath130 terminals while the sum of the capacities of the edges incident to @xmath5 is precisely this amount , we know that @xmath5 is @xmath141-linked to exactly @xmath136 terminals in @xmath71 , @xmath129 .",
    "in particular , @xmath5 is @xmath142-linked to @xmath34 terminals , and these are necessarily @xmath143 , otherwise @xmath71 would contain a cycle .",
    "using the same argument , with @xmath136 decreasing from @xmath34 to @xmath69 , we get that @xmath5 is @xmath141-linked to @xmath144 .",
    "notice that all paths from @xmath5 to @xmath133 , @xmath145 , use the same sub - path from @xmath38 to @xmath39 .",
    "hence , by removing from @xmath71 all arcs incident to @xmath5 and to the terminals , we get a solution @xmath15 to ` ml - vdisj - path ` with same total length .",
    "the proof for digraphs is obtained by replacing  edge \" by  arc \" in the construction of @xmath49 .",
    "[ cor:2mvdp - unif ] given two integers @xmath41 and @xmath26 with @xmath146 and @xmath147 , ` ml - vdisj - path ` with @xmath44 source - sink pairs is polynomially reducible to`ml - cap - steiner - tree ` with @xmath41 terminals and uniform capacity @xmath26 .",
    "the proof is similar to the previous one .",
    "the main difference is the definition of @xmath46 . in the undirected case , @xmath131 is obtained by adding to @xmath14 two vertices @xmath5 and @xmath18 and @xmath41 terminals @xmath148 ; @xmath135 is obtained from @xmath24 by adding the edges @xmath149 , [ r , s_2 ] , [ v , s_1 ] , [ v , t_1 ] , [ s'_1,t_2 ] , [ s'_2,t_i]$ ] for @xmath150 , and @xmath151 $ ] for@xmath152 .",
    "the edges of @xmath24 keep their original length while those in @xmath153 have length 0 .",
    "all capacities are set equal to @xmath26 .",
    "we then prove that ` ml - vdisj - path ` on @xmath4 is equivalent to ` ml - cap - steiner - tree ` in @xmath49 in a similar way as in the previous theorem .",
    "the only path that goes from @xmath5 to @xmath154 contains @xmath155 , and hence the remaining capacity on this edge is @xmath156 : this implies that the paths from @xmath5 to the @xmath26 terminals adjacent to @xmath157 must contain @xmath158 , and the rest of the proof is unchanged .",
    "the proof for digraphs is obtained by adding arcs instead of edges to obtain @xmath49 .",
    "[ cor : pmvdp - unif ] ` ml - vdisj - path ` with @xmath159 source - sink pairs is polynomially reducible to ` ml - cap - steiner - tree ` with @xmath160 terminals and uniform capacity @xmath34 .",
    "again , the proof is similar to the one of theorem [ th : reductionfrommvdp ] . in this case , @xmath46 is constructed as follows .",
    "@xmath131 is obtained by adding to @xmath14 a vertex @xmath5 , @xmath161 vertices @xmath162 and @xmath160 terminals @xmath133 with @xmath163 ; @xmath135 is obtained from @xmath24 by adding the edges @xmath164 $ ] , @xmath165 $ ] and @xmath166 $ ] for @xmath167 , as well as edges between @xmath39 and every @xmath133 with @xmath134 and edges between @xmath168 and every @xmath133 with @xmath169 .",
    "the edges of @xmath24 keep their original length while those in @xmath153 have length 0 .",
    "all capacities are set equal to @xmath34 .",
    "we then prove that ` ml - vdisj - path ` on @xmath4 is equivalent to ` ml - cap - steiner - tree ` in @xmath49 in a similar way as in theorem [ th : reductionfrommvdp ] .",
    "notice that , in this case , given any solution @xmath71 to ` ml - cap - steiner - tree ` in @xmath49 , @xmath5 is necessarily @xmath170-linked to terminals @xmath133 ( @xmath171 ) for all @xmath167 , and @xmath5 is @xmath142-linked to terminals @xmath172 ( @xmath171 ) .",
    "_ the results stated in theorems [ th : reductionfrommvdp ] , [ cor:2mvdp - unif ] and [ cor : pmvdp - unif ] are also valid for ` ml - vdisj - path ` and ` ml - cap - steiner - tree ` with strictly positive lengths , since the arcs or edges added to @xmath4 in order to obtain @xmath49 can have arbitrary lengths .",
    "indeed , the total length of a solution @xmath15 to ` ml - vdisj - path ` will then differ from the total length of the corresponding solution @xmath71 to ` ml - cap - steiner - tree ` by a value equal to the total length of the added arcs or edges . _",
    "we next show that , when the number @xmath41 of terminals is fixed , ` ml - cap - steiner - tree ` is polynomially reducible to ` ml - lab - vdisj - path ` .",
    "[ th : reductiontomlvdp ] when @xmath173 is fixed , ` ml - cap - steiner - tree ` can be reduced in polynomial time to ` ml - lab - vdisj - path ` with a fixed number of source - sink pairs .",
    "we first consider the undirected case .",
    "let @xmath174 be an instance of`ml - cap - steiner - tree ` in a graph @xmath4 containing @xmath41 terminals .",
    "it follows from property [ enumskelet ] that the set of potential skeletons of optimal solutions to @xmath174 can be enumerated in @xmath109 time ( since @xmath41 is a constant ) , where @xmath107 is the number of vertices in @xmath4 .    to every such potential skeleton @xmath15 ,",
    "we associate a graph @xmath46 constructed as follows , in order to deal with vertex - disjoint paths ( and not internally vertex - disjoint paths ) . for each arc @xmath78 of @xmath15",
    ", we create a copy @xmath175 of @xmath50 and a copy @xmath176 of @xmath18 ; hence , every vertex @xmath18 of @xmath15 is replaced in @xmath49 by @xmath177 copies of @xmath18 , where @xmath177 is the degree of @xmath18 in @xmath15 .",
    "all vertices of @xmath4 that do not appear in @xmath15 are also put in @xmath131 ( with only one copy of each ) . for each edge",
    "@xmath27 $ ] of @xmath4 we put an edge of same length in @xmath49 between each copy of @xmath50 and each copy of @xmath18 .",
    "this construction is illustrated in figure [ fig : mlndp ] .",
    "we then create a source - sink pair @xmath178 in @xmath49 for all arcs @xmath78 in @xmath15 . from property",
    "[ prop : numbvert ] , @xmath15 contains at most @xmath179 vertices , and there are therefore at most @xmath180 such pairs . for each @xmath181 , let @xmath182 denote the number of terminals in the subtree @xmath45 of @xmath15 rooted at @xmath18 , and let @xmath183 be the set of labels associated with the source - sink pair @xmath178 .",
    "we set @xmath184 . in the example of figure",
    "[ fig : mlndp ] , we have @xmath185 , and @xmath186 . the label @xmath187 associated with an edge @xmath10 in @xmath49",
    "is the capacity of the corresponding edge in @xmath4 .",
    "an optimal solution to ` ml - lab - vdisj - path ` in @xmath49 ( if any ) corresponds to a minimum - length solution to ` ml - cap - steiner - tree ` in @xmath4 having @xmath15 as skeleton .",
    "since we enumerate all potential skeletons , the best solution to ` ml - cap - steiner - tree ` obtained during this enumeration is an optimal solution for @xmath174 .",
    "the proof is similar for digraphs , by replacing edge by arc .",
    "[ htbp ]     to ` ml - lab - vdisj - path ` in @xmath188 ( the length of @xmath189 $ ] is equal to 3 , and all other lengths are equal to 1 . ) ]    [ cor : mcstpuniftomvdp ] when @xmath190 is fixed , ` ml - cap - steiner - tree ` ( resp . `",
    "cap - steiner - tree ` ) with uniform capacity is polynomially reducible to ` ml - vdisj - path ` ( resp . `",
    "vdisj - path ` ) with a fixed number of source - sink pairs .",
    "the proof is similar to the proof of theorem [ th : reductiontomlvdp ] .",
    "however , since the capacities are all equal to a constant @xmath26 , we do not have to use labels .",
    "consider any potential skeleton @xmath15 : if @xmath5 has at least one successor @xmath18 such that the number of terminals in the subtree @xmath45 of @xmath15 rooted at @xmath18 is strictly larger than @xmath26 , then @xmath15 can be rejected since it can not correspond to the skeleton of a tree satisfying the capacity constraints . otherwise , an optimal ( resp .",
    "a feasible ) solution to ` ml - vdisj - path ` is a minimum - length ( resp . a feasible ) solution to ` ml - cap - steiner - tree `",
    "having @xmath15 as skeleton .",
    "[ htbp ]        the relations proved in this section are summarized in figure [ fig : pathsteiner ] , where a trivial polynomial reduction corresponds to a generalization of a special case .",
    "we recall that ` vdisj - path ` is np - complete in digraphs , even with @xmath44 souce - sink pairs @xcite , while it is polynomial - time solvable in undirected graph @xcite and dags @xcite when @xmath34 is fixed .",
    "we close this section by mentioning that the reductions given in theorems [ th : reductionfrommvdp ] and [ cor : pmvdp - unif ] are fpt - reductions @xcite with parameters @xmath34 and @xmath191 .",
    "in this section , we prove some np - hardness and np - completeness results .",
    "we first show that ` cap - steiner - tree ` in digraphs is np - complete even if @xmath192 is fixed , the minimum capacity @xmath193 is any value in @xmath194 , while the maximum capacity @xmath195  is at least 2 .",
    "[ th : cstp - directed - unif - k - fixed ] ` cap - steiner - tree ` is np - complete in digraphs , even if @xmath57 is fixed , for any @xmath196 and @xmath63 , with @xmath197 .",
    "this is a direct consequence of theorem [ th : reductionfrommvdp ] ( for @xmath198 , @xmath199 and @xmath200 ) and theorem [ cor:2mvdp - unif ] ( for @xmath146 ) . indeed , ` vdisj - path ` is np - complete in digraphs with @xmath44 source - sink pairs @xcite , and the two theorems show how to polynomially reduce ` vdisj - path ` in this case to ` cap - steiner - tree ` with the right number of terminals .",
    "notice that we can fix the values of @xmath193 and @xmath195 in the constructed ` cap - steiner - tree ` instances ( with @xmath196 , and @xmath63 ) by assigning these two values to two different arcs incident to terminals .    ` cap - steiner - tree ` with uniform capacity @xmath201 is np - complete in digraphs , even if @xmath146 is fixed .    for undirected graphs",
    ", we have the following result :    [ th : cstp - undirected - non - unif ] ` cap - steiner - tree ` is np - complete in undirected graphs , even if @xmath57 is fixed and if the minimum capacity @xmath202 and the maximum capacity @xmath195 are two fixed constants , with @xmath203 and @xmath204 .    we give a polynomial - time reduction from ` sat ` .",
    "assume first that @xmath198 and all edge capacities are equal to 1 or 2 .",
    "let @xmath205 be the set of variables and let @xmath206 be the set of clauses in an arbitrary instance @xmath174 of ` sat ` .",
    "for each variable @xmath207 , we denote by @xmath208 ( resp .",
    "@xmath209 ) the number of occurrences of @xmath207 ( resp .",
    "@xmath210 ) in the clauses . we can assume , without loss of generality , that @xmath211 for every @xmath136 ( by exchanging @xmath207 and @xmath212 everywhere in the clauses , if necessary ) .",
    "the following instance @xmath213 of ` cap - steiner - tree ` is associated to @xmath174 .    for each variable @xmath207",
    ", we construct a _ variable gadget _ as follows : we add two vertices @xmath214 and @xmath215 , and two vertex - disjoint paths between them .",
    "the first one , @xmath37 , corresponding to literal @xmath207 , is @xmath216 , where , for each @xmath217 , the edge @xmath218 has capacity 2 , and , for each @xmath219 , the edge @xmath220 has capacity 1 .",
    "the second path , @xmath221 , corresponding to literal @xmath210 , is @xmath222 , where , for each @xmath223 , the edge @xmath224 has capacity 2 , and , for each @xmath225 , the edge @xmath226 has capacity 1 .",
    "the edges @xmath227 and @xmath228 also have capacity 1 .",
    "the variable gadgets are linked together as follows : for each @xmath229 , there is an edge @xmath230 of capacity 1 .    for each clause @xmath231",
    ", we construct a _ clause gadget _ as follows : we add two vertices @xmath232 , and , for each literal @xmath207 ( or @xmath210 ) contained in @xmath231 , we add edges @xmath233 ( or @xmath234 ) and @xmath235 ( or @xmath236 ) of capacity 2 , if this literal occurs @xmath237 times in clauses @xmath238 .",
    "the clause gadgets are linked together as follows : for each @xmath239 , there is an edge @xmath240 of capacity 2 .",
    "we complete the construction of @xmath213 by adding a root @xmath5 and 3 terminals @xmath241 , as well as 3 edges @xmath242 , @xmath243 and @xmath244 of arbitrary capacity ( 1 is fine , but any value fits ) , an edge @xmath245 of capacity 1 , and an edge @xmath246 of capacity 2 .",
    "the construction of @xmath213 is illustrated in figure [ fig : satcstp ] for @xmath174 with @xmath247 and @xmath248 .",
    "solid lines have capacity 2 while dotted edges have capacity 1 .",
    "[ htbp ]        let @xmath15 be a feasible solution to @xmath213 ( if any ) . to avoid cycles , the paths from @xmath5 to @xmath249 and @xmath250 must use the same sub - path @xmath251 from @xmath5 to @xmath252 , and thus all edges of @xmath251 must have capacity 2 .",
    "so , @xmath251 starts with the edge @xmath253 .",
    "then , the only possibility is to use the edge @xmath254 ( or @xmath255 ) for some @xmath136 , and then the edges @xmath256 and @xmath257 ( or @xmath258 and @xmath259 ) .",
    "the next step is to use the edge @xmath260 . using similar arguments with increasing values of @xmath261",
    ", we get that @xmath251 necessarily contains all edges @xmath240 with @xmath262 , and ends at @xmath263 ( which is adjacent to @xmath249 and @xmath250 ) .    since @xmath251 starts with the edge @xmath253 , the path @xmath264 from @xmath5 to @xmath154 starts with the edge @xmath265 . moreover , to avoid cycles , @xmath264 and @xmath251 are internally vertex - disjoint .",
    "since @xmath266 and @xmath267 belong to @xmath251 for all @xmath261 , we conclude that , for each @xmath136 , either @xmath264 contains @xmath37 and then @xmath251 may contain only edges of @xmath221 , or @xmath264 contains @xmath221 and then @xmath251 may contain only edges of @xmath37 .",
    "this means that , for each @xmath261 , there is a subpath of three edges of @xmath251 , from @xmath266 to @xmath267 , containing one edge of @xmath37 ( resp .",
    "@xmath221 ) for @xmath136 such that @xmath207 ( resp .",
    "@xmath210 ) is one of the literals contained in clause @xmath231 , and there is no @xmath123 for which the subpath from @xmath268 to @xmath269 contains one edge of @xmath221 ( resp .",
    "@xmath37 ) . we can therefore define a satisfying truth assignment @xmath270 as follows : for each @xmath136 , if @xmath37 is a subpath of @xmath264 , then @xmath271 , else @xmath272 .",
    "conversely , if there is a satisfying truth assignment @xmath273 for @xmath174 , we construct a feasible solution for @xmath213 as follows .",
    "the path @xmath264 from @xmath5 to @xmath154 begins with the edge @xmath265 and , for each @xmath136 , @xmath264 has @xmath37 as a subpath if @xmath271 , and it has @xmath221 as a subpath if @xmath272 . the path @xmath251 from @xmath5",
    "to @xmath263 begins with the edge @xmath253 and can be constructed sequentially by using edges not contained in @xmath264 ( this is always possible , since @xmath273 is a satisfying truth assignment for @xmath174 ) .",
    "the solution to @xmath213 is then obtained by adding edges @xmath274 , @xmath243 and @xmath244 to @xmath275 .",
    "the solution to @xmath213 corresponding to the truth assignment @xmath276 for @xmath174 is represented in figure [ fig : satcstp ] with bold lines .    in order to generalize this reduction to any @xmath57 , any @xmath203 , and any @xmath277",
    ", we attach @xmath278 terminals to @xmath252 ( instead of 2 ) and @xmath279 terminals to @xmath5 ( instead of 0 ) : the edges with capacity 1 and 2 become edges with capacity @xmath193 and @xmath278 , respectively .",
    "moreover , since the edges incident to the terminals can have any capacity , we can set the capacity of one of them to @xmath195 .",
    "notice that the previous result is not valid for dags since the graphs constructed in the above proof possibly contain circuits .",
    "we now prove a complexity result for ` lab - vdisj - path ` , i.e. ` ml - lab - vdisj - path ` with lengths 0 .",
    "[ cor : hardness - mlvdp - undirected ] ` lab - vdisj - path ` with @xmath34 source - sink pairs is np - complete in undirected graphs , and hence in digraphs , for any fixed @xmath159 , even if @xmath127 contains all labels for every @xmath280 and @xmath281 contains all labels but one .    for @xmath44 ,",
    "this follows from the proof of theorem [ th : cstp - undirected - non - unif ] . indeed , consider the two source - sink pairs @xmath282 and @xmath283 , identify the label of each edge with its capacity , and set @xmath284 and @xmath285 .",
    "we have shown that there is a feasible solution to the instance @xmath174 of ` sat ` if and only if there are two vertex - disjoints paths @xmath286 and @xmath287 linking @xmath288 to @xmath289 and @xmath290 to @xmath157 , and such that @xmath286 uses edges of label 1 or 2 , while @xmath287 uses only edges with label 2 . for larger values of @xmath34",
    ", we simply add dummy source - sink pairs .",
    "note that this is in contrast with ` vdisj - path ` , which is polynomial - time solvable in undirected graphs @xcite and in dags @xcite when @xmath34 is fixed .",
    "a similar problem has been studied in @xcite .",
    "more precisely , ` twocol - vdisj - path ` is defined as follows : given an undirected graph in which every edge has color 1 or 2 , and two source - sink pairs @xmath291 and @xmath292 , determine whether @xmath4 contains two vertex - disjoint paths , the first one from @xmath288 to @xmath289 using only edges of color 1 , and the second one from @xmath290 to @xmath157 using only edges of color 2 . `",
    "twocol - vdisj - path ` is the special case of ` ml - lab - vdisj - path ` where there are @xmath44 source - sink pairs , all lengths are 0 , and @xmath293 for each @xmath294 .",
    "it is proved in @xcite that this problem is np - complete .",
    "the reduction given in the proof of theorem [ th : cstp - undirected - non - unif ] yields an alternative proof of the np - completeness of ` twocol - vdisj - path ` : indeed , as in the previous corollary , we can fix @xmath295 and @xmath283 , and identify the colors of the edges with their capacities . also , for every variable gadget , we add a path consisting of two edges of capacity ( color ) 1 between the endpoints of the edges of capacity 2 so that @xmath286 ( the path that goes through edges of capacity 1 and 2 ) can avoid edges with color 2 .",
    "+ the next result deals with dags and undirected graphs with uniform capacity .",
    "[ th : unif - dag - sat ] ` cap - steiner - tree ` is np - complete in dags and undirected graphs , even in the case of uniform capacity @xmath26 , for any @xmath296 ( not depending on @xmath41 ) .    let ` 3-sat`@xmath297 be the satisfiability problem in which every clause contains at most 3 variables , every variable appears in at most 3 clauses , and every litteral ( a variable or its complement ) appears in at most 2 clauses . `",
    "3-sat`@xmath297 is known to be np - complete @xcite .",
    "we show how to polynomially reduce ` 3-sat`@xmath297 to ` cap - steiner - tree ` with uniform capacity @xmath296 .",
    "let @xmath298 be an instance of ` 3-sat`@xmath297 with @xmath205 as set of variables and @xmath206 as set of clauses . to obtain an instance @xmath213 of ` cap - steiner - tree ` with uniform capacity @xmath26",
    ", we construct the following graph @xmath0 : for every variable @xmath299 , we create three vertices @xmath300 and @xmath26 terminals @xmath301 ; for every clause @xmath302 we create a terminal @xmath303 ; finally we add a vertex @xmath5 .",
    "for the directed case , we consider the following arcs : for every @xmath304 , we create the arcs @xmath305 ; for every @xmath306 we create the arcs @xmath307 ( resp .",
    "@xmath308 ) if @xmath207 ( resp .",
    "@xmath210 ) is in @xmath231 .",
    "all the arcs have capacity @xmath26 .",
    "the resulting graph @xmath4 can clearly be obtained in polynomial time and is a dag .",
    "for the undirected case , we consider the same graph , but we replace each arc by an edge .",
    "the construction is illustrated in figure [ fig : sat3 ] for @xmath309 and the ` 3-sat`@xmath297 instance where @xmath310 and @xmath311 , the arcs being oriented from @xmath5 down to the terminals in the directed case .     to ` cap - steiner - tree ` . ]",
    "assume there is a truth assignment @xmath270 for @xmath174 .",
    "we construct a feasible solution @xmath15 to @xmath213 as follows .",
    "if @xmath312 ( resp .",
    "@xmath313 ) then we include @xmath314 ( resp .",
    "@xmath315 ) in @xmath15 . for each clause @xmath231",
    ", we choose one of the true litterals in @xmath231 , say @xmath207 ( resp .",
    "@xmath212 ) , and add the arc @xmath307 ( resp .",
    "@xmath308 ) to @xmath15 .",
    "finally , for all @xmath304 , we add the arcs @xmath170 , @xmath316 , @xmath317 to @xmath15 . clearly , @xmath15 is a tree rooted at @xmath5 and spanning all the terminals ; in fact , @xmath15 is a spanning tree .",
    "for every @xmath318 with @xmath312 ( resp .",
    "@xmath313 ) , @xmath5 is @xmath170-linked ( resp .",
    "@xmath316-linked ) to @xmath319 , and is @xmath316-linked ( resp .",
    "@xmath170-linked ) to at most two terminals @xmath303 associated with clauses containing @xmath212 ( resp .",
    "@xmath207 ) , since there are at most two such clauses .",
    "since @xmath320 , all capacity constraints are satisfied .",
    "the solution @xmath15 associated with the truth assignment @xmath321 is represented in figure [ fig : sat3 ] with bold lines .",
    "now , let @xmath15 be a feasible solution to @xmath213 .",
    "consider first the directed case .",
    "for all @xmath306 , there is at least one index @xmath136 such that either @xmath322 and we then set @xmath323 or @xmath324 and we then set @xmath325 .",
    "if a variable did not get any value , we arbitrarily choose one , say @xmath326 .",
    "this gives a truth assignment satisfying each clause @xmath231 .",
    "let us verify that we have not assigned simultaneously values @xmath326 and @xmath327 to some variable .",
    "notice first that , since @xmath15 has no cycle , @xmath5 is either @xmath170-linked or @xmath316-linked to the @xmath26 terminals @xmath301 .",
    "since all capacities equal @xmath26 , this means that either @xmath328 or @xmath329 has no @xmath303 @xmath330 as successor , which means that we do not assign both values @xmath326 and @xmath327 to a variable @xmath207 .",
    "consider now the undirected case .",
    "if there is an index @xmath136 such that @xmath331 , then @xmath332 since , in this case , @xmath5 must be @xmath315-linked to @xmath319 in @xmath15 . hence , @xmath333 ( otherwise , there would be a cycle in @xmath15 ) and we can replace @xmath334 by @xmath170 . similarly ,",
    "if @xmath335 for some index @xmath136 , we replace this arc by @xmath336 .",
    "assume now that @xmath337 and @xmath333 for some @xmath338 and @xmath339 .",
    "then , we have @xmath340 for some index @xmath341 and we replace @xmath342 by @xmath170 . we make a similar exchange if @xmath343 and @xmath344 . after having performed all these replacements , we get a new spanning tree @xmath71 , since each vertex ( except the root ) still has exactly one incoming arc .",
    "moreover , @xmath71 has the same structure as the tree @xmath15 analyzed in the directed case .",
    "we can therefore obtain a satisfying truth assignment using the same rules as above .",
    "remember ( see section 1 ) that ` edge - cost - flow ` consists in determining aminimum - length feasible flow of @xmath41 units from @xmath42 to @xmath43 in a given graph , where the length of a flow is the total length of the arcs / edges carrying a positive flow . `",
    "edge - cost - flow ` is very close to ` ml - cap - steiner - tree ` . indeed , given an instance of ` ml - cap - steiner - tree ` in a graph @xmath4 with @xmath41 terminals , we can construct a graph @xmath49 obtained from @xmath4 by adding a vertex @xmath345 and linking every terminal to this new vertex . solving ` edge - cost - flow ` in @xmath49 with @xmath346 and @xmath347 is then equivalent to solving ` ml - cap - steiner - tree ` in @xmath4 , except that a feasible solution is not required to be a tree .",
    "the proof of theorem [ th : unif - dag - sat ] provides the following corollary :    ` edge - cost - flow ` is np - hard in dags and undirected graphs , even if all lengths are 1 and all capacities are 1 or 2 .",
    "consider first the directed acyclic case .",
    "given an instance @xmath298 of ` 3-sat`@xmath297 , let us construct a graph @xmath0 , as in the proof of theorem [ th : unif - dag - sat ] , setting @xmath309 .",
    "we then add a vertex @xmath345 and link @xmath348 @xmath349 and @xmath303 @xmath330 to @xmath345 .",
    "for all arcs @xmath10 incident to @xmath5 , as well as those linking @xmath38 to @xmath350 and @xmath351 , we set @xmath352 , while @xmath353 is set to @xmath354 for all other arcs @xmath10 .",
    "all arcs have capacity 2 , except those incident to @xmath345 which have capacity 1 .",
    "we then solve an ` edge - cost - flow ` instance , looking for a flow of @xmath355 units from @xmath5 to @xmath345 .",
    "let @xmath213 be this instance .",
    "we prove that @xmath174 is satisfiable if and only if the total length of an optimal solution to @xmath213 is at most @xmath356 .",
    "if there is a satisfying truth assignment for @xmath174 , we construct a solution @xmath15 to @xmath213 as in the proof of theorem [ th : unif - dag - sat ] , except that we add an arc from every terminal to @xmath345 .",
    "it is not difficult to check that the total length of such a solution is at most @xmath357 .",
    "consider now a solution @xmath15 to @xmath213 of total length at most @xmath357 .",
    "since the @xmath358 arcs incident to @xmath345 have capacity 1 , they all carry a positive flow .",
    "hence , for every @xmath359 , there is at least one index @xmath136 such that @xmath307 or @xmath308 carries a positive flow in @xmath15 .",
    "moreover , for every @xmath318 , at least one of the arcs @xmath314 and @xmath315 carries a positive flow in @xmath15 .",
    "therefore , the total length of @xmath15 is at least @xmath360 , which means that no other arc @xmath10 with @xmath361 can belong to @xmath15 . in particular , for every @xmath359 , there is _ exactly _ one arc in @xmath15 with a positive flow linking a vertex in @xmath362 to @xmath303 , and , for every @xmath363 , _ exactly _ one of the arcs @xmath314 and @xmath315 carries a positive flow flow in @xmath15 . if @xmath314 ( resp .",
    "@xmath315 ) carries a positive flow in @xmath15 , then there is no flow on the arcs linking @xmath168 ( resp .",
    "@xmath329 ) to a @xmath303 since @xmath364 ) ( resp .",
    "@xmath316 ) has capacity 2 while 2 units of flow are used to reach @xmath350 and @xmath351 .",
    "hence the structure of @xmath15 is the same as in the proof of theorem [ th : unif - dag - sat ] , and we can set @xmath365 if @xmath314 carries a positive flow in @xmath15 , and @xmath366 otherwise , to obtain a satisfying truth assignment for @xmath174 .    to obtain a graph with uniform length 1 ,",
    "we replace each arc @xmath10 by a path with @xmath353 arcs of length 1 .",
    "the proof is similar for the undirected case .",
    "we close this section by considering a final uniform case for ` ml - cap - steiner - tree ` .",
    "[ th : unit - cost - steiner ] ` ml - cap - steiner - tree ` is np - hard in any graph , even if all capacities are equal to @xmath54 for any positive constant @xmath62 and if all lengths are 1 .",
    "it is well - known that ` steiner - tree ` is np - hard even in the case of unit lengths @xcite . given any positive number @xmath62 , we show how to polynomially reduce ` steiner - tree ` with unit lengths to ` ml - cap - steiner - tree ` with uniform capacity @xmath54 and unit lengths .",
    "let @xmath213 be an instance of ` steiner - tree ` in a graph @xmath46 with @xmath367 terminals and @xmath352 for all @xmath7 .",
    "we construct a graph @xmath0 from @xmath49 by adding @xmath62 terminals and linking them to @xmath5 with edges / arcs of length 1 .",
    "we then set all capacities to @xmath367 to obtain an instance @xmath174 of ` ml - cap - steiner - tree ` with @xmath368 terminals , @xmath352 and @xmath369 for all @xmath7 .",
    "clearly , solving @xmath213 is equivalent to solving @xmath174 , and @xmath174 can be built from @xmath213 in polynomial time .",
    "in this section , we assume that the number @xmath41 of terminals is fixed . the first theorem deals with undirected graphs having uniform capacity , and",
    "complements theorems [ th : cstp - undirected - non - unif ] and [ th : unif - dag - sat ] .",
    "[ th : undirected - unif - fixedk ] in undirected graphs with a fixed number @xmath41 of terminals and uniform capacity , ` cap - steiner - tree ` is solvable in polynomial time , and ` ml - cap - steiner - tree ` is polynomially equivalent to ` ml - vdisj - path ` with a fixed number of source - sink pairs .",
    "the first part of the theorem is a direct consequence of theorem [ cor : mcstpuniftomvdp ] , since ` vdisj - path ` is polynomial - time solvable and even fpt in undirected graphs",
    "when the number of source - sink pairs is fixed @xcite . the second part comes from theorems [ cor : pmvdp - unif ] and [ cor : mcstpuniftomvdp ] .",
    "on the one hand , recall that , for a fixed number @xmath34 of source - sink pairs , the complexity of ` ml - vdisj - path ` in undirected graphs is open for a long time @xcite ( and so determining the one of ` ml - cap - steiner - tree ` in this case is as hard as settling this open problem ) ; however , there exists a probabilistic polynomial - time algorithm to solve the case with two source - sink pairs @xcite , although no deterministic one is known yet . on the other hand , corollary",
    "[ cor : hardness - mlvdp - undirected ] shows that ` ml - lab - vdisj - path ` with lengths 0 is already np - complete in undirected graphs when @xmath159 is fixed .",
    "the next theorem shows that ` ml - lab - vdisj - path ` is tractable in dags if @xmath34 is fixed , which will come in handy for proving that ` ml - cap - steiner - tree ` is solvable in polynomial time in dags if @xmath41 is fixed .",
    "[ th : cds - dag - k - fixed ] in dags , ` ml - lab - vdisj - path ` is solvable in polynomial time for any fixed number of source - sink pairs .",
    "ml - lab - vdisj - path ` by using a dynamic programming algorithm .",
    "more precisely , consider a dag @xmath0 with a label @xmath187 on each arc @xmath7 , and with @xmath34 vertex - disjoint pairs @xmath370 and their associated label sets @xmath127 .",
    "we first order the vertices of @xmath4 using a topological ordering , and denote by @xmath371 the position of each vertex @xmath18 in such an ordering ( i.e. , @xmath372 for all @xmath373 ) .",
    "let @xmath374 be the set of @xmath34-tuples @xmath375 of vertices of @xmath4 , and let @xmath376 be the function such that @xmath377 is the minimum total length of a set of @xmath34 vertex - disjoint paths in @xmath4 such that the @xmath136th one goes from @xmath38 to @xmath168 and uses only arcs with labels in @xmath127 . if @xmath378 for all @xmath129 , then @xmath379 if @xmath380 for all @xmath136 , and @xmath381 otherwise .",
    "consider now a @xmath34-tuple @xmath375 such that @xmath382 for at least one index @xmath136 , and let @xmath383 be the index such that @xmath384 .",
    "if @xmath385 for some @xmath386 , then @xmath387 . otherwise , let @xmath388 be the set of vertices @xmath18 such that @xmath389 and there exists an arc @xmath390 whose label is in @xmath391 .",
    "if @xmath392 then @xmath387 ; otherwise , we have @xmath393 the dynamic programming algorithm works as follows . for @xmath394 from 2 to @xmath107 , we enumerate all @xmath34-tuples @xmath395 with @xmath396 and , for each of them , we compute the corresponding value of @xmath397 .",
    "the number of enumerated @xmath34-tuples is thus in @xmath398 and the value of each one can be computed in @xmath399 , which yields an @xmath400-time algorithm .",
    "the optimal value to the ` ml - lab - vdisj - path ` instance is then equal to @xmath401 .",
    "[ th : dag - fixedk ] ` ml - cap - steiner - tree ` is solvable in polynomial time in dags if @xmath41 is fixed .",
    "this is a direct consequence of theorems [ th : reductiontomlvdp ] and [ th : cds - dag - k - fixed ] .",
    "notice that ` ml - lab - vdisj - path ` in dags can not be fpt in @xmath34 ( unless fpt = w[1 ] ) , since ` vdisj - path ` ( i.e. , the special case where all arcs have zero length and @xmath402 for each @xmath136 ) is w[1]-hard with respect to @xmath34 in dags @xcite . moreover , ` ml - cap - steiner - tree ` can not be fpt in @xmath41 ( unless fpt = w[1 ] ) , since theorem [ cor : pmvdp - unif ] shows that ` ml - vdisj - path ` can be fpt - reduced to ` ml - cap - steiner - tree ` ( with respective parameters @xmath34 and @xmath403 ) .",
    "in this section , we study the case where all capacities are almost equal to the number of terminals .",
    "we first consider the case where the minimum capacity @xmath193 is at least equal to @xmath54 , where @xmath404 is an arbitrary constant . in",
    "what follows , we denote by @xmath58 the best possible approximation ratio for ` steiner - tree ` ( @xmath405 in undirected graphs @xcite ) , and by @xmath59 the best possible approximation ratio for ` ml - vdisj - path ` with a fixed number of source - sink pairs .",
    "as mentioned in the previous section , @xmath406 in dags , and determining whether @xmath406 or not in undirected graphs is a long - standing open problem .    without loss of generality , we assume in this section that @xmath407 for all @xmath408 . if this is not the case , we modify the lengths as follows : for all @xmath408 , we multiply @xmath353 by @xmath409 if @xmath410 , where @xmath411 is the lowest common multiple of the denominators of the lengths @xmath353 , and we set @xmath352 if @xmath10 has length zero .",
    "the first result obtained in this section complements theorem [ th : unit - cost - steiner ] and generalizes the first part of theorem [ th : undirected - unif - fixedk ] . notice that , from theorem [ th : cstp - directed - unif - k - fixed ] , ` cap - steiner - tree ` is np - complete in digraphs with uniform capacity @xmath413 for any constant @xmath414 .",
    "[ th : cstp - large - capa - unif ] in dags and undirected graphs having uniform capacity @xmath413 , ` cap - steiner - tree ` is solvable in polynomial time and ` ml - cap - steiner - tree ` can be approximated within a ratio of @xmath415 , for any constant @xmath416 .",
    "we first state and prove some useful properties .",
    "let @xmath174 be an instance of ` cap - steiner - tree ` .",
    "[ fact7.1 ] there is a feasible solution @xmath15 for @xmath174 if and only if there is a tree @xmath417 ( called _ reduced _ tree ) rooted at @xmath5 , spanning a subset @xmath418 of terminals , and such that , for every edge @xmath10 incident to @xmath5 in @xmath417 , @xmath5 is @xmath51-linked to at least @xmath62 terminals in @xmath417 .",
    "a feasible solution for @xmath174 is clearly such a tree .",
    "so , assume that such a tree @xmath417 exists .",
    "we iteratively complete @xmath417 to obtain a steiner tree @xmath15 spanning also the terminals in @xmath419 as follows .",
    "for every terminal @xmath420 , we consider any path @xmath421 from @xmath5 to @xmath43 in @xmath4 , and we add to @xmath417 the subpath of @xmath421 from @xmath18 to @xmath43 , where @xmath18 is the vertex in @xmath422 the closest to @xmath43 on @xmath421 . from the hypothesis , given any edge @xmath10 of @xmath4 ( including those not in @xmath417 ) , we know that @xmath5 is @xmath51-linked to at least @xmath62 terminals in @xmath417 . hence , @xmath15 does not violate the capacity constraints and is therefore a feasible solution to @xmath174 .",
    "[ fact7.2 ] if @xmath417 is a _ minimal _ , i.e. inclusion - wise minimal , reduced tree ,",
    "then each of its subtrees rooted at a vertex distinct from @xmath5 contains at most @xmath62 terminals .",
    "let @xmath417 be a minimal reduced tree , and assume it contains a vertex @xmath423 such that @xmath424 contains at least @xmath425 terminals .",
    "we can assume without loss of generality that @xmath18 is a child of @xmath5 .",
    "since all terminals are leaves , we can remove one of the terminals of @xmath424 from @xmath417 to obtain a smaller reduced tree , a contradiction .",
    "[ fact7.3 ] a minimal reduced tree contains at most @xmath426 terminals .",
    "assume a minimal reduced tree @xmath417 contains at least @xmath427 terminals , and consider any child @xmath18 of @xmath5 in @xmath417 .",
    "it follows from the previous claim that @xmath5 is @xmath428-linked to at least @xmath425 terminals in @xmath417 .",
    "all terminals being leaves , we can therefore delete any terminal from @xmath417 to obtain a smaller reduced tree , a contradiction .",
    "we can now prove theorem [ th : cstp - large - capa - unif ] .",
    "we first consider ` cap - steiner - tree ` .",
    "according to claim [ fact7.3 ] and property [ prop : numbvert ] , the undirected skeleton of a minimal reduced tree can contain up to @xmath429 vertices .",
    "we therefore enumerate all labelled trees ( including potential skeletons of reduced trees ) on at most @xmath429 vertices .",
    "we then orient each of them from the root to the leaves , and for each such rooted tree we try to replace the arcs by vertex - disjoint paths in a similar way as in theorem [ cor : mcstpuniftomvdp ] .",
    "if such a replacement is possible , we test whether the extended skeleton is a reduced tree : in such a case , we stop the enumeration since we know from claim [ fact7.1 ] that the ` cap - steiner - tree ` instance @xmath174 has a feasible solution .",
    "if no potential skeleton can be extended to a reduced tree , then @xmath174 has no solution : indeed , if such a solution @xmath15 exists , it contains a minimal reduced tree , whose skeleton is necessarily considered in our enumeration and then extended to a reduced tree , which leads to a contradiction .",
    "there are @xmath430 ways of choosing at most @xmath431 terminals among @xmath41 . for each such choice of at most @xmath431 terminals",
    ", it then follows from property [ enumskelet ] that the set of potential skeletons of minimal reduced trees spanning these terminals can be enumerated in @xmath432 time ( since @xmath62 is a constant ) .",
    "finally , at most @xmath433 arcs must be replaced by vertex - disjoint paths in every potential skeleton ( recall that this can be done in polynomial time in dags and undirected graphs , since @xmath62 is a constant ) .",
    "hence , the whole process takes a polynomial time .",
    "consider now a ` ml - cap - steiner - tree ` instance @xmath213 .",
    "we proceed as above , but instead of choosing arbitrary vertex - disjoint paths , we solve the associated ` ml - vdisj - path ` instance with a @xmath59-approximation algorithm , and , instead of stopping the enumeration when a reduced tree is found , we enumerate all of them and store the best one , denoted by @xmath434 .",
    "notice that the total length of @xmath434 is at most @xmath59 times larger than the total length of an optimal solution to @xmath213 since such an optimal solution contains a reduced tree .",
    "we then use a @xmath58-approximation algorithm to determine a minimum - length steiner tree @xmath435 spanning all the terminals not already spanned by @xmath434 . clearly , the total length of @xmath435 is at most @xmath58 times larger than the total length of an optimal solution to @xmath213 .",
    "we finally build a solution @xmath15 to @xmath213 by removing from @xmath436 all arcs of @xmath435 entering a vertex with in - degree 2 in @xmath436 .",
    "this yields a @xmath437-approximation algorithm to ` ml - cap - steiner - tree ` ( with @xmath406 for dags ) .",
    "it follows from theorem [ th : cstp - undirected - non - unif ] that ` cap - steiner - tree ` with non - uniform capacities is np - complete in undirected graphs when the minimum capacity @xmath193 equals @xmath54 , for any constant @xmath438 .",
    "we show however that theorem [ th : cstp - large - capa - unif ] can be extended to dags with non - uniform capacities .",
    "[ th : cstp - large - capa - non - unif - dags ] in dags with @xmath439 , ` cap - steiner - tree ` is solvable in polynomial time and ` ml - cap - steiner - tree ` can be approximated within a ratio of @xmath440 , for any constant @xmath404 .    as was the case for the previous theorem ,",
    "we start with some claims . in particular",
    ", we extend the definition of a reduced tree to take into account the non - necessarily uniform capacities .",
    "let @xmath174 be an instance of ` cap - steiner - tree ` in a dag with @xmath412 for some constant @xmath416 .",
    "if @xmath441 , then the result follows from theorem [ th : dag - fixedk ] .",
    "so , assume @xmath442 .",
    "[ fact : reducedtree ] there is a feasible solution @xmath15 to @xmath174 if and only if there is a tree @xmath417 ( called a _ reduced _ tree ) rooted at @xmath5 , spanning at least @xmath62 terminals , and such that , for each arc @xmath443 with capacity @xmath444 ( not only those incident to @xmath5 ) , @xmath5 is @xmath445-linked to at least @xmath446 terminals in @xmath417 .    a solution for @xmath174 is clearly such a tree .",
    "now , assume the existence of a reduced tree @xmath417 that spans a subset @xmath53 of at least @xmath62 terminals .",
    "we complete @xmath417 to obtain a steiner tree @xmath15 spanning also the terminals in @xmath419 , as in claim [ fact7.1 ] . from the hypothesis , for each arc @xmath443 of @xmath417 , @xmath5 is @xmath445-linked to at least @xmath446 terminals in @xmath417 , and , for each arc @xmath447 of @xmath4 not in @xmath417 , @xmath5 is @xmath448-linked to at least @xmath449 terminals of @xmath417 .",
    "hence , @xmath15 does not violate the capacity constraints and is thus a feasible solution to @xmath174 .",
    "[ fact : dagnonunif ] in any _ minimal _ , i.e. inclusion - wise minimal , reduced tree @xmath417 , no vertex has out - degree greater than @xmath425 .",
    "assume that a minimal reduced tree @xmath417 contains a vertex @xmath18 with at least @xmath450 outgoing arcs and let @xmath451 be a child of @xmath18 in @xmath417 .",
    "let @xmath452 denote the subtree obtained from @xmath417 by removing all vertices of @xmath453 .",
    "since every subtree @xmath454 of @xmath417 rooted at a child @xmath75 of @xmath18 contains at least one terminal ( otherwise @xmath417 is not minimal ) , we know that @xmath455 ( and thus also @xmath452 ) spans at least @xmath456 terminals . hence , for every arc @xmath443 of @xmath452 not on the path from @xmath5 to @xmath18 in @xmath417 and not in @xmath455 , we know that @xmath5 is @xmath445-linked to at least @xmath457 terminals in @xmath452 . for every child @xmath75 of @xmath18 in @xmath452 , we know that , for any arc @xmath443 in @xmath458 , @xmath5 is @xmath445-linked to the at least @xmath459 terminals in the subtree of @xmath455 obtained by removing all the vertices of @xmath460 . finally , for any arc @xmath443 on the path from @xmath5 to @xmath18 in @xmath452 , we know that @xmath5 is @xmath445-linked to at least @xmath446 terminals in @xmath452 , since this was the case in @xmath417 .",
    "hence , we have proved that @xmath452 satisfies the definition of a reduced tree , and is included in @xmath417 while being smaller , a contradiction .",
    "[ fact : height ] any directed path in the skeleton of a minimal reduced tree @xmath417 contains at most @xmath425 arcs .",
    "assume that the skeleton of a minimal reduced tree @xmath417 contains a directed path with at least @xmath450 arcs .",
    "without loss of generality , we can choose such a path @xmath421 from @xmath5 to a terminal @xmath461 , since each leaf is a terminal ( otherwise @xmath417 is not minimal ) .",
    "we denote by @xmath18 the predecessor of @xmath43 in @xmath421 . since each internal vertex of @xmath421 has degree at least 3 in the skeleton of @xmath417 ( and hence in @xmath417 ) , and since @xmath417 is minimal , we know that @xmath417 spans at least @xmath462 terminals .",
    "we now remove the path from @xmath18 to @xmath43 in @xmath417 and thus obtain a subtree @xmath452 spanning at least @xmath463 terminals . using arguments similar to those in the proof of claim [ fact : dagnonunif ] , it is easy to check that @xmath452 satisfies the definition of a reduced tree , which means that @xmath417 was not minimal , a contradiction",
    ".    we can now prove theorem [ th : cstp - large - capa - non - unif - dags ] .",
    "it follows from claims [ fact : dagnonunif ] and [ fact : height ] that the skeleton of a minimal reduced tree has maximum out - degree @xmath425 and maximum height @xmath425 .",
    "hence , the undirected skeleton of a minimal reduced tree contains at most @xmath464 terminals ( which are its leaves ) , and it follows from property [ prop : numbvert ] that such a skeleton has at most @xmath465 vertices .",
    "we therefore enumerate all trees with at most @xmath465 vertices , keeping only those that span at least @xmath62 and at most @xmath466 terminals , in order to ensure that any potential skeleton of a minimum reduced tree is enumerated .",
    "each such enumerated tree is oriented from @xmath5 to the leaves , and we then try to replace its arcs by vertex - disjoint paths but , unlike in theorem [ th : cstp - large - capa - unif ] , when replacing an arc @xmath78 of a tree by a path , we impose that each arc of the path from @xmath50 to @xmath18 has a label ( capacity ) @xmath467 , where @xmath468 is the number of terminals which are not descendant of @xmath18 in the tree . in other words , instead of solving a ` vdisj - path ` instance , we solve a ` lab - vdisj - path ` instance .",
    "if all arcs can be replaced by labelled vertex - disjoint paths , we test whether the extended skeleton is a reduced tree : in such a case , we stop the enumeration , since we know from claim [ fact : reducedtree ] that @xmath174 has a feasible solution . otherwise , we conclude that @xmath174 has no solution .",
    "let us show that the whole process takes a polynomial time .",
    "@xmath466 being a constant , this means that , from cayley s formula and from the number of ways for choosing at most @xmath465 vertices among @xmath107 , there is a polynomial number of labelled trees to enumerate . besides , since the number of arcs that must be replaced by vertex - disjoint paths is at most @xmath469 in each tree , this means , from theorem [ th : cds - dag - k - fixed ] , that the associated ` lab - vdisj - path ` instance can be solved in polynomial time .",
    "consider now a ` ml - cap - steiner - tree ` instance @xmath213 .",
    "we proceed in a similar way as in theorem [ th : cstp - large - capa - unif ] .",
    "more precisely , instead of choosing arbitrary vertex - disjoint paths , we solve an ` ml - lab - vdisj - path ` instance with a fixed number of vertex pairs , which takes a polynomial time in dags according to theorem [ th : cds - dag - k - fixed ] .",
    "however , instead of stopping the enumeration when a reduced tree is found , we enumerate all of them and store the best one , that we denote by @xmath434 .",
    "the total length of @xmath434 is a lower bound on the total length of an optimal solution to @xmath213 , since such an optimal solution contains a reduced tree .",
    "we then use a @xmath58-approximation algorithm to determine a minimum - length steiner tree @xmath435 spanning all the terminals not already spanned by @xmath434 .",
    "the total length of @xmath435 is at most @xmath58 times larger than the total length of an optimal solution to @xmath213 .",
    "we finally build a solution @xmath15 to @xmath213 by removing from @xmath436 all arcs of @xmath435 entering a vertex with in - degree 2 in @xmath436 .",
    "this yields a @xmath470-approximation algorithm for ` ml - cap - steiner - tree ` in dags .",
    "the results given in this section generalize the main results known about the complexity and approximation of ` steiner - tree ` .    if @xmath472 , then any steiner tree is a feasible solution to ` cap - steiner - tree ` , and thus ` ml - cap - steiner - tree ` is equivalent to ` steiner - tree ` , which can be solved in polynomial time when @xmath41 is fixed @xcite .",
    "so consider the case where @xmath473 . in",
    "what follows , we denote by @xmath474 the subset of arcs / edges with capacity at least @xmath41 .",
    "let @xmath174 be an ` ml - cap - steiner - tree ` instance and let @xmath15 be an optimal solution to @xmath174 .",
    "let @xmath75 be the closest vertex to @xmath5 in @xmath15 having out - degree at least 2 ( with possibly @xmath475 ) .",
    "all arcs on the path linking @xmath5 to @xmath75 are in @xmath474 , while those in @xmath476 can have any capacity since @xmath5 is @xmath10-linked to at most @xmath60 terminals for all @xmath10 in @xmath476 .",
    "moreover , @xmath476 spans all terminals and , since we can assume that all vertices without outgoing arcs in @xmath15 are terminals , we know that @xmath15 contains at most @xmath60 vertices of degree at least 3 ( see the proof of property [ prop : numbvert ] ) .",
    "assume we can find in @xmath4 a vertex @xmath75 and two terminals @xmath477 and @xmath478 such that there are three internally vertex - disjoint paths : @xmath479 from @xmath5 to @xmath75 ( with possibly @xmath475 ) with all its arcs in @xmath474 , @xmath480 from @xmath75 to @xmath477 , and @xmath481 from @xmath75 to @xmath478 .",
    "we can then build a feasible solution to @xmath174 by extending @xmath482 arbitrarily to obtain a steiner tree spanning all terminals .",
    "indeed , any arc in @xmath482 has a residual capacity @xmath483 , and there are @xmath61 other terminals to span in order to get a steiner tree .",
    "conversely , if there is a feasible solution to @xmath174 , then there is such a triple @xmath484 .",
    "[ claim : shortpath ] let @xmath15 be an optimal solution to an instance @xmath174 of ` ml - cap - steiner - tree ` in a graph @xmath0 with @xmath485 and @xmath410 for all @xmath7 .",
    "let @xmath75 be the vertex with out - degree at least 2 the closest to @xmath5 in @xmath15 , and let @xmath479 be the path from @xmath5 to @xmath75 in @xmath15 .",
    "then all shortest paths from @xmath5 to @xmath486 in @xmath487 intersect @xmath476 only at @xmath75 , and @xmath479 is one of them .",
    "first notice that @xmath488 and all arcs of @xmath479 belong to @xmath474 .",
    "let @xmath489 be any shortest path from @xmath5 to @xmath75 in @xmath49 , and let @xmath490 be the set of vertices that belong to both @xmath489 and @xmath476 . if @xmath491 then @xmath492 is a feasible solution to @xmath174 , which means that @xmath493 , otherwise @xmath15 would not be optimal .",
    "so assume @xmath494 and let @xmath71 be the tree obtained from @xmath15 by replacing @xmath479 by @xmath489 , and by removing all arcs @xmath495 with @xmath496 , to ensure that each vertex ( except @xmath5 ) still has in - degree 1 .",
    "notice that @xmath497 , since @xmath498 and at least one arc ( of length @xmath499 ) is removed from @xmath476 to obtain @xmath71 .",
    "then , we remove all arcs @xmath78 such that @xmath500 contains no terminal ( since they are useless in a solution to @xmath174 ) . this way , we obtain a new tree @xmath501 rooted at @xmath5 , spanning all terminals , and such that @xmath502 and @xmath503 @xmath504 .",
    "this is illustrated on figure [ fig : cor77 ] .",
    "let @xmath505 be a vertex in @xmath506 , and let @xmath43 be any terminal in @xmath507 . in @xmath501",
    ", there is a path from @xmath5 to @xmath43 , while there is no path from @xmath75 to @xmath43 .",
    "so @xmath508 , which is the closest vertex to @xmath75 on @xmath509 verifying @xmath510 , has outdegree at least 2 in @xmath501 .",
    "let @xmath511 be the vertex with outdegree at least 2 which is the closest to @xmath5 in @xmath501 ( @xmath511 belongs to @xmath512 , from the previous paragraph ) , and let @xmath513 be the path from @xmath5 to @xmath511 in @xmath501 .",
    "note that the only vertices @xmath18 in @xmath501 with @xmath514 are those on @xmath513 , and that all arcs on @xmath513 have capacity at least @xmath41 since they also belong to @xmath489 .",
    "moreover , since @xmath503 for every child @xmath18 of @xmath511 in @xmath501 , all arcs in @xmath515 only need to have capacity @xmath60 .",
    "hence , @xmath501 is a feasible solution to @xmath174 with @xmath516 , a contradiction .    .",
    "]    we now consider ` ml - cap - steiner - tree ` with @xmath471 and show that , when @xmath41 is fixed , it is solvable in polynomial time .",
    "[ th : large - capas - fixedk ] if @xmath41 is fixed and @xmath517 , ` ml - cap - steiner - tree ` can be solved by an algorithm whose running time is polynomial , and whose only non fpt factor with respect to k is @xmath518 . in particular , ` ml - cap - steiner - tree ` is solvable in polynomial time if @xmath519 .",
    "the case @xmath472 has already been settled at the beginning of this section .",
    "so , assume @xmath473 .",
    "given an instance @xmath174 of ` ml - cap - steiner - tree ` , we solve @xmath174 as follows .",
    "we consider all vertices @xmath75 such that @xmath75 is either the root @xmath5 or a vertex of degree at least 3 in @xmath4 .",
    "for each such vertex @xmath75 :    * we determine a shortest path @xmath479 from @xmath5 to @xmath75 in @xmath487 , and we denote by @xmath520 the subgraph of @xmath4 obtained by removing all vertices of @xmath479 , except @xmath75 ; * we consider all pairs @xmath521 of distinct terminals and all subsets @xmath490 of at most @xmath522 vertices @xmath523 of degree at least 3 in @xmath520 .",
    "so , let @xmath524 be such a quadruple .",
    "we first determine two internally vertex - disjoint paths @xmath480 and @xmath481 linking @xmath75 to @xmath477 and to @xmath478 in @xmath520 , and such that @xmath525 contains all vertices of @xmath490 and has minimum total length . as in the proof of theorem [ th : cstp - cap1 ] , this can be done in polynomial time : we add a sink @xmath42 and two arcs @xmath526 and @xmath527 , and we determine two internally vertex - disjoint paths of minimum total length from @xmath75 to @xmath42 by using a min - cost flow algorithm ; in addition , we impose a flow equal to 1 on each arc @xmath118 corresponding to a vertex @xmath18 of @xmath490 in the graph @xmath116 obtained from @xmath520 ( as in the proof of theorem [ th : cstp - cap1 ] ) , to ensure that the paths contain @xmath490 .",
    "assume we are able to find the two internally vertex - disjoint paths @xmath480 and @xmath481 in @xmath520 .",
    "we then consider the graph @xmath528 obtained from @xmath520 by assigning a length 0 to all arcs on @xmath525 , and we determine a directed tree @xmath529 of minimum total length in @xmath528 , rooted at @xmath75 , and spanning all terminals in @xmath530 .",
    "let @xmath531 denote the set of arcs @xmath78 in @xmath529 with @xmath18 not belonging to @xmath525 .",
    "we finally build a solution to @xmath174 by taking all arcs of @xmath532 .    among all built solutions ,",
    "we keep the best one , which we denote by @xmath533 .",
    "we now prove that @xmath533 is an optimal solution to @xmath174 .",
    "let @xmath534 be an optimal solution to @xmath174 , and let @xmath75 be the vertex in @xmath534 the closest to @xmath5 with out - degree at least 2 .",
    "let @xmath535 and @xmath536 be two children of @xmath75 in the skeleton of @xmath534 , and let @xmath477 ( resp .",
    "@xmath478 ) be a terminal in @xmath537 ( resp .",
    "@xmath538 ) closest to @xmath535 ( resp .",
    "@xmath536 ) in terms of the number of vertices on the path linking them in the skeleton of @xmath537 ( resp .",
    "@xmath538 ) .",
    "we denote by @xmath539 and @xmath540 the paths in @xmath534 linking @xmath5 to @xmath75 , @xmath75 to @xmath477 , and @xmath75 to @xmath478 , respectively .",
    "finally , let @xmath490 be the set of vertices @xmath523 on @xmath541 having degree at least 3 in @xmath534 , and let @xmath542 denote the set of arcs in @xmath534 that do not belong to @xmath543 .",
    "we first prove that the proposed algorithm considers the quadruple @xmath524 .",
    "since @xmath75 has out - degree at least 2 , it is either the root @xmath5 or a vertex of degree at least 3 in @xmath4 .",
    "it follows from claim [ claim : shortpath ] that @xmath520 contains all vertices of @xmath490 .",
    "hence , we only have to prove that @xmath544 .",
    "let @xmath545 ( resp .",
    "@xmath546 ) be the number of vertices in the skeleton of @xmath537 ( resp .",
    "@xmath538 ) . if @xmath547 , the path from @xmath535 to @xmath477 in the skeleton of @xmath534 is reduced to @xmath548 vertex @xmath549 ; otherwise , @xmath535 has out - degree at least 2 in @xmath534 , and we know from the proof of property [ prop : pathlength ] that the path from @xmath535 to @xmath477 in the skeleton of @xmath534 has at most @xmath550 vertices .",
    "similarly , the path from @xmath536 to @xmath478 in the skeleton of @xmath534 has at most @xmath551 vertices .",
    "hence @xmath490 contains at most @xmath552 vertices .",
    "since @xmath75 has out - degree at least 2 , it follows from property [ prop : numbvert ] that the skeleton of @xmath553 contains at most @xmath180 vertices , which implies @xmath554 .",
    "the sum @xmath552 is therefore maximized for @xmath555 , which implies that @xmath490 contains at most @xmath522 vertices .",
    "we now prove that @xmath556 .",
    "let @xmath532 be the solution returned by the proposed algorithm for the quadruple @xmath524 .",
    "it follows from claim [ claim : shortpath ] that @xmath557 , and that @xmath520 contains all vertices of @xmath553 .",
    "since @xmath558 and @xmath540 are two internally vertex - disjoint paths linking @xmath75 to @xmath477 and to @xmath478 in @xmath520 , we have @xmath559 .",
    "consider now the set @xmath560 of arcs @xmath78 in @xmath542 with @xmath18 not belonging to @xmath525 , and let @xmath15 be the tree obtained from @xmath553 by replacing @xmath558 and @xmath540 by @xmath480 and @xmath481 , and by removing the arcs in @xmath561 .",
    "note that @xmath15 is a tree rooted at @xmath75 , spanning all terminals in @xmath562 , and with total length at most equal to @xmath563 in @xmath528 ( since all arcs in @xmath525 have length 0 in @xmath528 ) . hence , @xmath564 in @xmath528 , which implies @xmath565 in @xmath4 . in summary",
    ", @xmath566    the total number of possible quadruples is @xmath567 . for each of them",
    ", we have to compute a shortest path , a minimum - cost flow , and an optimal steiner tree spanning @xmath61 terminals .",
    "the latter problem can be solved in time fpt with respect to the number of terminals @xcite , and the other two problems can be solved in polynomial time @xcite .    together with theorem [ th : undirected - unif - fixedk ] , the previous theorem shows , in particular , that theorems [ th : cstp - directed - unif - k - fixed ] and [ th : cstp - undirected - non - unif ] are best possible",
    ". it also implies , together with theorem [ th : cstp - cap1 ] , that ` ml - cap - steiner - tree ` is polynomial - time solvable if @xmath198 and all capacities are equal .",
    "when @xmath41 is part of the input ( i.e. , not fixed ) , we have the following result , which complements theorem [ th : unit - cost - steiner ] .    [",
    "th : large - capas - non - fixedk ] if @xmath568 , ` cap - steiner - tree ` is solvable in polynomial time and ` ml - cap - steiner - tree ` can be approximated within a ratio of @xmath440 .",
    "we use the same ideas as those used in the proof of the previous theorem .",
    "more precisely , for solving an instance @xmath174 of ` cap - steiner - tree ` , we enumerate all triples @xmath484 , where @xmath75 is either the root @xmath5 or a vertex of degree at least 3 in @xmath4 , and @xmath569 both belong to @xmath9 . for each such triple , we determine a shortest path @xmath479 from @xmath5 to @xmath75 in @xmath487 , remove all vertices of @xmath479 , except @xmath75 , to create @xmath520 , and determine two internally vertex - disjoint paths @xmath480 and @xmath481 from @xmath75 to @xmath477 and to @xmath478 in @xmath520 .",
    "this can be done in polynomial time using path and flow techniques similar to those used in the previous proof ( without lengths on the arcs ) .",
    "if we succeed in finding the three paths @xmath570 for a triple @xmath484 , then we greedily complete their union into a steiner tree rooted at @xmath5 and spanning all terminals , which gives a solution to @xmath174 .",
    "otherwise , @xmath174 does not have any feasible solution .",
    "all this can be done in polynomial time , since there are @xmath571 triples @xmath484 to enumerate .",
    "for an instance @xmath213 of ` ml - cap - steiner - tree ` , we again enumerate all triples @xmath484 , and determine for each such triple a shortest path @xmath479 from @xmath5 to @xmath75 in @xmath49 , as well as two internally vertex - disjoint paths of shortest total length , @xmath480 and @xmath481 from @xmath75 to @xmath477 and to @xmath478 in @xmath520 ( as in the proof of theorem [ th : large - capas - fixedk ] ) .",
    "if we succeed in finding the three paths @xmath570 for a triple @xmath484 , we then use a @xmath58-approximation algorithm to determine a directed tree @xmath529 of minimum total length , rooted at @xmath5 , and spanning all terminals in @xmath530 .",
    "let @xmath531 be the set of arcs @xmath78 in @xmath529 with @xmath18 not belonging to @xmath572 ; we build a solution to @xmath213 by taking all arcs of @xmath532 . among all built solutions ,",
    "we keep the best one , which we denote by @xmath533 .",
    "now , let @xmath534 be an optimal solution to @xmath213 , and let @xmath75 be the vertex in @xmath534 the closest to @xmath5 with out - degree at least 2 .",
    "let @xmath535 and @xmath536 be two distinct children of @xmath75 in @xmath534 , and let @xmath477 be a terminal in @xmath537 , and @xmath478 a terminal in @xmath538 .",
    "the triple @xmath484 is considered in our enumeration , and we clearly have @xmath573 and @xmath574 .",
    "hence , @xmath575 .",
    "again , the whole process takes a polynomial time .",
    "indeed , there are @xmath571 enumerated triples , and , for each of them , we have to determine a shortest path , a minimum - cost flow , and a @xmath58-approximate solution to an instance of ` steiner - tree ` .",
    "all these problems can be solved in polynomial time .",
    "we have studied the complexity of ` ml - cap - steiner - tree ` in digraphs , dags and undirected graphs , and we have dealt with any possible case with respect to all the parameters that we considered ( minimum and maximum capacities , lengths , and number of terminals ) . moreover , whenever ` ml - cap - steiner - tree ` was intractable while ` cap - steiner - tree ` , the case with lengths @xmath56 , was not , we have provided approximation results for ` ml - cap - steiner - tree ` nearly as good as the best ones for ` steiner - tree ` .",
    "while we have also obtained some results about the parameterized complexity of ml - cap - steiner - tree , several questions remain open in this area :    * the results associated with leaves 11 and 13 in figure [ fig : arbres ] are best possible , since the fpt - reduction from vdisj - path parameterized by @xmath34 described in theorem [ cor : pmvdp - unif ] shows in particular that cap - steiner - tree is w[1]-hard with respect to either @xmath41 or @xmath62 in this case , even with uniform capacities ( note that , in this reduction , we have @xmath191 and @xmath576 ) .",
    "* however , the result associated with leaf 9 in figure 1 may not be the best possible one ( i.e. , this case might actually be fpt with respect to @xmath62 ) , since in undirected graphs vdisj - path is fpt with respect to @xmath34 ( so theorem [ cor : pmvdp - unif ] does not provide any useful information in this case ) .",
    "* finally , we think that the main open problem is related to the result provided in theorem [ th : large - capas - fixedk ] ( and associated to leaf 5 in figure [ fig : arbres ] ) . we have proved that ml - cap - steiner - tree is polynomial - time solvable in this case , hence generalizing the same result already known for steiner - tree , but it may actually be fpt with respect to @xmath41 : in particular , notice that this is indeed the case for steiner - tree .",
    "this work was done with the support of the gaspard monge program for optimization and operations research ( pgmo ) http://www.fondation-hadamard.fr/fr/pgmo .",
    "j. cong , a. b. kahng , k .- s .",
    "leung ( 1998 ) , _ efficient algorithms for the minimum shortest path steiner arborescence problem with applications to vlsi physical design_. ieee trans .",
    "on cad of integrated circuits and systems 17 , 2439 .",
    "g. duan , y. yu ( 2003 ) , _ distribution system optimization by an algorithm for capacitated steiner tree problems with complex flows and arbitrary cost functions _ , international journal of electrical power and energy systems 25 , 515523 .",
    "e. uchoa , r. fukasawa , j. lysgaard , a. pessoa , m. poggi de arago , d. andrade ( 2008 ) , _ robust branch - cut - and - price for the capacitated minimum spanning tree problem over a large extended formulation _ , math . program .",
    ", ser . a 112 , 443472 .",
    "d. watel , m .- a .",
    "weisser , c. bentz , d. barth ( 2015 ) _ an fpt algorithm in polynomial space for the directed steiner tree problem with limited number of diffusing nodes _ , information processing letters 115 , 275279 ."
  ],
  "abstract_text": [
    "<S> given a graph @xmath0 with a root @xmath1 , positive capacities @xmath2 , and non - negative lengths @xmath3 , the minimum - length ( rooted ) edge capacitated steiner tree problem is to find a tree in @xmath4 of minimum total length , rooted at @xmath5 , spanning a given subset @xmath6 of vertices , and such that , for each @xmath7 , there are at most @xmath8 paths , linking @xmath5 to vertices in @xmath9 , that contain @xmath10 . </S>",
    "<S> we study the complexity and approximability of the problem , considering several relevant parameters such as the number of terminals , the edge lengths and the minimum and maximum edge capacities . for all but one combinations of assumptions regarding these parameters </S>",
    "<S> , we settle the question , giving a complete characterization that separates tractable cases from hard ones . </S>",
    "<S> the only remaining open case is proved to be equivalent to a long - standing open problem . </S>",
    "<S> we also prove close relations between our problem and classical steiner tree as well as vertex - disjoint paths problems .    </S>",
    "<S> = 0.5 cm </S>"
  ]
}