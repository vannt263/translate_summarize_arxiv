{
  "article_text": [
    "the design of radiological imaging equipment has developed to reflect the best compromise between a number of contradictory performance requirements .",
    "in particular the design of x - ray tubes has evolved to best fit the requirements for the smallest possible focal spot size combined with the maximum target heat capacity . in this case",
    "the performance compromise is between geometrical blurring introduced by a finite focal spot size and movement blurring introduced by the long radiographic exposure time required to operate a very small focal spot within its heat loading limits .",
    "the most common resulting design , rotating target with an acute target angle , represents an impressive engineering solution to this problem .",
    "an alternative potential solution to the problem of geometrical blurring , applicable to modern digital receptors , is digital image processing .",
    "provided the characteristics of the image blurring function are known , an image can , in theory , be restored to that which would have been produced by a perfect point focal spot . however , in practice the degree to which radiological images can be restored to remove geometric blurring , using conventional fourier deconvolution strategies , is severely limited by noise . the relatively poor signal - to - noise ratio of radiological images is a direct result of the requirement to operate within the alarp principle , so that patient radiation doses are ` kept as low as reasonably practicable consistent with the intended purpose ' @xcite .",
    "radiological images are therefore expected to be inherently noisy , with quantum noise being the dominant noise source .",
    "the noise power extends to the highest spatial frequencies recorded by the receptor , and it is the modulation at these higher spatial frequencies which is amplified using fourier - based techniques , resulting in an image dominated by high frequency noise . the wiener filter @xcite is a popular deconvolution tool which attempts to address the shortcomings of direct fourier inversion techniques .",
    "its application to non - mammographic images has been demonstrated by @xcite .",
    "however , it is our experience that these techniques are of marginal value in radiology .    in this work ,",
    "an alternative image restoration approach based on a bayesian maximum entropy method is applied to a radiological image deconvolution problem : reduction of geometric blurring in mammography .",
    "the aim of the work is to demonstrate an improvement in image spatial resolution with no associated penalty in terms of reduction in the signal - to - noise ratio perceived by the observer .",
    "the images used here were digitized _",
    "ab initio _ ; in principle digitized film could be used , but this would almost certainly be an unacceptable inconvenience if digital processing of this nature were to become part of clinical practice .",
    "indeed it is the advent of computed and direct radiography which we believe make this work particularly timely .",
    "there is a large body of literature describing methods which aim to improve the quality of image information content through restoration techniques .",
    "medical images are usually measurements of photon flux , and the data is usually noisy and often incomplete ; statistical methods have yielded some robust methods of estimating the ` true ' image distribution in these circumstances .",
    "the expectation maximization ( em ) algorithm @xcite has been widely applied to finding solutions which maximize a likelihood function for quantum noise limited data ; in the medical context this method has been used by @xcite , @xcite and @xcite for tomographic imaging . in the astronomical community",
    "em is known as richardson - lucy deconvolution @xcite .",
    "describe a method which maximizes the mean value of the log - likelihood for quantum noise limited data .",
    "it has been shown that this is equivalent to minimizing csiszr s i - divergence @xcite , a quantity equal to the negative of the entropy expression , @xmath0 , given in equation ( [ entropy ] ) .",
    "the usefulness of bayesian restoration stems from the fact that it allows the incorporation of sophisticated _ a priori _ knowledge into the formulation of the restoration method , while quite naturally enforcing desirable properties such as positivity in the restoration .",
    "it has been argued by @xcite that in the absence of further prior information entropy is the only consistent prior for positive , additive images . gives a summary of these methods in terms of information theoretic image formation models .",
    "the links between statistical mechanics and information theory were established by @xcite .",
    "image restoration using mem was first described in a landmark paper by @xcite .",
    "the driving force behind practical implementations of the method came from radio astronomy and the need to improve radio maps of the sky @xcite .",
    "mem is a deconvolution technique derived from the forward map ( 1 ) for the imaging system , which relates postulated hidden data @xmath1 to the observed data @xmath2 .",
    "@xmath3    equation ( [ forwardmapfig ] ) is the forward map for the imaging system .",
    "the psf , denoted by @xmath4 , characterizes the geometric blurring of the imaging system , which acts on the hidden data .",
    "the hidden image is then further corrupted by additive noise to produce the observed image @xmath2 .",
    "the goal of image restoration is to obtain a solution @xmath5 , which approximates to the hidden image @xmath6 , as closely as the data and noise allow .",
    "we outline briefly the mem approach to the problem here , but for a more complete review see @xcite and @xcite .",
    "the notation in the following analysis has been simplified in relation to equation ( [ forwardmapfig ] ) , in that the data etc .",
    "are represented as vectors rather than 2d arrays .",
    "a trial restoration @xmath5 is obtained and used as an initial guess for the hidden image @xmath6 .",
    "the trial restoration is blurred , via equation ( [ forwardmapfig ] ) , to generate mock data @xmath7 .",
    "the @xmath8 goodness of fit statistic is used to measure the degree of misfit between the observed data and mock data :    @xmath9    where @xmath10 is the variance in the noise , here taken to be constant .",
    "it might be thought that a good approach would be to minimize this degree of misfit by choosing a suitable @xmath5 , but this process is equivalent to the straightforward matrix inversion :    @xmath11    where @xmath12 is the matrix representation of the linear forward map equation ( [ forwardmapfig ] ) .",
    "the problem here is that typically the matrix @xmath12 is ill - conditioned , i.e. almost singular , so for a given @xmath13 there are many vectors @xmath5 which almost satisfy equation ( [ inversion ] ) , not necessarily close together .",
    "thus if @xmath13 contains even a small amount of noise , the resulting @xmath5 can be far from the true image @xmath6 ; in other words the reconstruction is then dominated by noise rather than data , often referred to as over - restoration . in the presence of noise we would not in any case expect @xmath8 to be minimized , but rather to be reduced to the appropriate value @xmath14 , where @xmath15 is the number of pixels in the image . even when @xmath12 is not ill - conditioned there are many @xmath5 which satisfy this criterion .",
    "mem is an example of regularized deconvolution and relies on a scheme of iterated forward maps rather than attempting to find a direct solution of the inverse problem .",
    "mem treats the restoration process as a statistical inference problem based on bayes theorem and the aim is to obtain the most probable image @xmath5 given the data :    @xmath16    the likelihood @xmath17 is determined from our knowledge of the forward map equation ( [ forwardmapfig ] ) ; the image noise is mainly quantum ( photon ) noise , which is modelled as a gaussian process , so the likelihood term is quantified by the @xmath8 distribution :    @xmath18    the prior @xmath19 is the probability that would be assigned by to a particular reconstruction @xmath5 prior to the introduction of observational constraints .",
    "it is assumed that each luminance quantum has an equal _ a priori _ chance of falling into any pixel , in which case it is easy to show that    @xmath20    where @xmath21 is the configurational entropy of the hidden image . for positive additive distributions",
    "the entropy is defined as @xcite :    @xmath22\\ ] ]    here @xmath23 is a ( constant ) default level ; @xmath21 is maximized when @xmath24 , giving a flat featureless reconstruction .",
    "if each luminance quantum has a different chance of falling into any pixel , the default levels @xmath25 for pixel @xmath26 can be chosen accordingly , and s is maximized when @xmath27 . a non - flat default level would be appropriate for example when the x - ray illumination is not uniform or when other knowledge of the restoration is known _ a priori_. the strict definition of posterior probability is therefore :    @xmath28    values of @xmath29 which maximize this probability should be determined .",
    "this can not be achieved analytically , and a numerical scheme must be employed . in practice a pragmatic modification of equation ( [ posterior1 ] ) is used :    @xmath30    where @xmath31 , and @xmath32 is a multiplier , as yet undetermined .",
    "@xmath8 is a measure of the misfit between the actual observations and those corresponding to the trial values @xmath29 ; @xmath21 is a measure of the structure within the trial image .",
    "if @xmath32 is too small then too much weight will be given to the data , thus amplifying the effects of noise ; if @xmath32 is too large then too much weight will be given to the entropy and each @xmath29 will be dragged towards its default value @xmath25 , thus losing real features .",
    "the procedure is to maximize @xmath33 with @xmath32 initially fixed ; a particular value of @xmath8 will correspond to this maximum .",
    "the aim is that this value should coincide with the expectation @xmath14 ; the value of @xmath32 which achieves this aim is found by a process of iteration .",
    "initial feasibility tests were undertaken using the matlab optimization toolbox ( the mathworks ltd , cambridge , uk ) , particularly the constrained nonlinear minimization function _",
    "fmincon _ in its largescale configuration , with a positivity constraint on each @xmath29 .",
    "this function employs a preconditioned conjugate gradient method @xcite .",
    "our procedure has two loops .",
    "the inner one , in which @xmath32 is fixed , iterates towards the minimum value of @xmath34 for that @xmath32 , and generates a corresponding value @xmath35 .",
    "the second loop iterates over @xmath32 to minimize @xmath36 , and is terminated when @xmath35 falls within the narrow statistical range @xmath37 @xcite .",
    "typically each loop requires 20 to 30 iterations , and the final value of @xmath32 is of order 20 .",
    "after our successful initial implementation commercially available c++ software was purchased ( memsys5 , maximum entropy data consultants , bury st edmunds , uk ) .",
    "this employs essentially the same scheme , but is highly optimized , as described in @xcite and @xcite .",
    "the memsys5 software can handle larger images than our initial implementation , with much shorter processing times .",
    "image quality comparisons were carried out using the leeds tormam test object ( figure [ figuretormam ] ) at various settings of geometric magnification .",
    "this phantom contains three groups of test features ; fibres , simulated microcalcification clusters and low contrast plastic disks , plus an area designed to give an anthropomorphic impression of a breast parenchymal pattern with overlying microcalcification clusters @xcite .",
    "this latter area of the phantom was not used in the present work .",
    "the phantom was imaged in various configurations on a laboratory - based siemens mammomat 3 mammography unit , with measured focal spot sizes of 0.7@xmath380.3 mm broad focus and 0.2@xmath380.2 mm fine focus . in all cases",
    "the phantom was imaged on top of a 3.5 cm thick stack of perspex to provide realistic scatter and attenuation as recommended in the instructions for the phantom .",
    "the radiographic factors used were 28kvp , 40mas .",
    "these factors were chosen to be representative of the values used in routine mammographic quality assurance tests .",
    "the level of quantum noise in the test images was therefore realistic .",
    "the digital image receptor was part of a philips acr-3 computed radiography system ( 100 @xmath39 m pixel size ) , comprising @xmath40 pixels with overall dimensions @xmath41 cm .    in order to provide a sample of the point spread function ( psf ) in the plane of the phantom , a piece of brass foil with a pinhole was included in the test images .",
    "in any practical application of this technique , the psf information would be obtained from calibration images appropriately scaled for the position of the object . including the psf with the image was convenient in this demonstration as the scaling and interpolation step was avoided .",
    "the measured overall psf is a convolution of one due to geometry and the the detector psf , but is nevertheless the appropriate one to use .",
    "in fact the contribution from the detector psf was small , evidenced by the fact that the measured psf scaled with focal spot size and magnification in the appropriate manner ( see figure [ figurepsf ] ) .",
    "three imaging geometries were used to illustrate varying degrees of focal spot geometrical blurring :    magnification 1.8 , broad focus ( 1.8bf ) .",
    ": :    the plane of the phantom was 33.5 cm from the tube focus and 27 cm from    the plane of the receptor .",
    "the image would be expected to be    unacceptably degraded by geometric blurring .",
    "magnification 1.8 , fine focus ( 1.8ff ) .",
    ": :    the phantom was in the same position as above , but imaged using the    fine focal spot .",
    "this is the conventional magnification view provided    on this mammography unit and used clinically .",
    "magnification 3.0 , fine focus ( 3.0ff ) .",
    ": :    the plane of the phantom was 20.5 cm from tube focus and 40 cm from the    plane of the receptor .",
    "this high magnification factor is not supported    on standard mammography units because even using fine focus , the image    would be unacceptably blurred .",
    "images of the focal spots obtained in each configuration are shown in figure [ figurepsf ] .",
    "the original and processed sets of images were viewed and scored by two independent observers both experienced in the use of mammographic image quality test phantoms .",
    "the test images were graded using the 3 , 2 , 1 , 0 scoring system recommended in the tormam phantom instructions and adopted in surveys of mammographic image quality in the uk breast screening programme @xcite .",
    "the original images were in siemens spi file format which were 12-bit grayscale images holding 10-bit image data . a conversion to dicom format was necessary to allow matlab to read the image data , but the conversion process retained all the luminance information held in the original files .",
    "matlab r12 was used to perform some preprocessing so that the subsequent mem processing could be applied .",
    "these steps were :    * the original images have a varying background brightness caused by non - uniform intensity of the x - ray beam ( which is by design in mammographic systems ) and by variations in sensitivity over each digital plate ( several such were used ) . to make the images more amenable to mem processing it was desirable to reduce this background @xcite .",
    "a gaussian low pass filter was constructed and applied to the original images in the fourier domain to obtain a background map .",
    "this map was subtracted from the original leaving a flattened image , which retained the phantom s high frequency features ( see figure [ figureprofile ] ) .",
    "it should be noted that the philips acr-3 system is not a linear one , as each pixel value is proportional to the logarithm of the number of photons striking the detector ; however , as the raw signal to mean background ratio is small ( see figure [ figureprofile ] ) , typically less than 0.1 , this procedure effectively linearizes the system , necessary for application of any of the methods discussed in section [ mir ] . *",
    "removal of spurious , bright pixels not corresponding to any real feature in the tormam phantom .",
    "these pixels would lead to artefacts in the restored image .",
    "the removal was done by observing the image histogram and setting high valued outliers to some mean background level . *",
    "the psf images were cropped from the original tormam images . in each case the noisy background of the psf was filtered out ( typically by discarding those pixels with less than 10% of the psf peak value ) . this had the effect of slightly narrowing each psf - thus leading to a conservative under - restoration .",
    "memsys5 was used to treat the images following the matlab preprocessing .",
    "the interface to the memsys5 kernel accepts image and psf - image files as inputs ( matlab image format was convenient ) and allows the setting of certain parameters related to the theory described in section 2 .",
    "the default image model @xmath23 was defined to be a flat image with low pixel luminance values : our belief that , in the absence of data , very high photon counts were recorded ( i.e. no absorption due to intervening material ) .",
    "memsys5 uses a slightly more sophisticated forward map that that presented in equation ( [ forwardmapfig ] ) .",
    "the processed images contained between 2.2 million and 3.9 million pixels .",
    "memsys5 typically converged to a solution within 15 @xmath32-iterations with a processing time of four to eight minutes , for an image of the full test object shown in figure [ figuretormam ] .",
    "the smaller images to be presented in figures [ figurecrow1 ] to [ figurecrow2 ] were cropped from such an image after processing , rather than processed individually .",
    "the processed output files from memsys5 were 8-bit png files .",
    "all image processing was carried out on a pentium 4 2.4ghz machine with 512 mb of ram .",
    "before proceeding to a systematic comparison of the original and mem processed images and related scores , we will say a few words about our initial aspirations for this technique .",
    "as mentioned in section 1 these were to show improved spatial resolution without reduction in signal - to - noise ratio perceived by the observer , particularly a level of performance in which mem processed 1.8bf images are at least as good as unprocessed 1.8ff ones .",
    "our belief is that such a performance would be of clinical interest .",
    "figures [ figurecrow1 ] and [ figurecalc ] compare appropriate images of a filament group and simulated microcalcifications .",
    "these figures show that mem reconstruction can give improvements in both resolution _ and _ perceived signal - to - noise ratio , and that the mem processed 1.8bf images are marginally better in this instance than the 1.8ff unprocessed ones in both respects .",
    "this promise encouraged us to undertake a systematic evaluation , and to consider magnifications greater than those normally used in clinical practice .",
    "three particle groups ( b , d and e ) were chosen for this evaluation .",
    "the nominal particle size ranges for these groups are 180 - 283 @xmath39 m , 106 - 177 @xmath39 m and 90 - 141 @xmath39 m respectively @xcite .",
    "in addition to the scoring system mentioned earlier we also calculate some signal to noise ratios ( snr ) for these particular features .",
    "figure [ figure1.8bf ] shows images of the three particle groups , cropped from the images taken under 1.8bf conditions .",
    "the selected particle group is clearly visible in figures [ figure1.8bf ] ( a ) and ( d ) , discernible in figure [ figure1.8bf ] ( e ) , just discernible in figure [ figure1.8bf ] ( b ) and not seen in figures [ figure1.8bf ] ( c ) and ( f ) ; however , we show the latter images to preserve the two by three format , which eases comparison with later improvements . as expected , unprocessed images obtained in this configuration are too blurred to be clinically useful",
    ". however , the mem processed images show significant improvements in resolution and signal - to - noise ratio , particularly regarding the high frequency noise , which were quantified using cuts similar to that shown in figure [ figureprofile ] ; the quoted snr is the difference between the largest signal and the mean background within each group , divided by the standard deviation of the signal in a region close to the group .",
    "figures for group b are @xmath42 and @xmath43 .",
    "group d : @xmath44 and @xmath45 .",
    "particle group e is not detected at this setting .",
    "figure [ figure1.8ff ] shows cropped images of the same three particle groups , obtained with the conventional 1.8ff configuration .",
    "remarks regarding group visibility are as for figure [ figure1.8bf ] .",
    "the pinhole psf imaged under these conditions is small and approximately gaussian in shape , comprising just a few pixels .",
    "as expected , images obtained in this configuration are sharper than in the 1.8bf case ; nevertheless mem restoration still shows significant improvements .",
    "snr measurements for group b are @xmath42 and @xmath46 .",
    "group d : @xmath47 and @xmath48 .",
    "particle group e is not detected at this setting .",
    "figure [ figure3.0ff ] shows cropped images of the same three particle groups , obtained with an unconventional 3.0ff configuration . in this case",
    "all three groups are detectable in the original image of the phantom , but the mem processed images show clear improvements in resolution , enabling fine details of individual microcalcifications to be discerned in image ( d ) .",
    "snr measurements for group b are @xmath49 and @xmath46 .",
    "group d : @xmath50 and @xmath51 .",
    "group e : @xmath52 and @xmath53 .        to effect the same comparison as that illustrated in figure [ figurecalc ] , between unprocessed 1.8ff images and mem processed 1.8bf ones , the bottom row in figure [ figure1.8bf ] should be compared with the top row in figure [ figure1.8ff ] .",
    "figure [ figurecrow2 ] shows images of filament groups b , d and f taken with the 1.8ff configuration .",
    "these respectively have diameters 0.35 , 0.25 and 0.20 mm , length 10 mm .",
    "all three groups are detectable in the original and mem processed images , but again the latter show improvements in resolution and visibility . to avoid information overload",
    "we do not show the 1.8bf and 3.00ff cases here , but experience with these matches that with the particle groups , and is quantified in the table of scores discussed below .",
    "the results obtained from scoring the original and mem processed images under each of the three imaging geometries are shown in table [ table1 ] .",
    "the processed images show an improved score in each case .",
    "this implies that the signal - to - noise ratio perceived by the observers for the various test features , including low contrast objects , was increased by the application of the mem processing .",
    "mode & image & + & & filaments & particles & disks & total + 1.8bf & original & 20.5 & 6.0 & 24.5 & 51.0 + & mem & 38.5 & 8.5 & 30.0 & 77.0 + 1.8ff & original & 27.0 & 6.0 & 21.5 & 54.5 + & mem & 41.0 & 10.5 & 29.5 & 81.0 + 3.0ff & original & 42.0 & 9.5 & 27.5 & 79.0 + & mem & 57.5 & 11.0 & 35.5 & 104.0 +",
    "the aim of the work was to demonstrate an improvement in spatial resolution for realistic radiological images from mem de - blurring , with no associated penalty in terms of reduction in the signal - to - noise ratio perceived by the observer .",
    "the expected resolution improvements are shown in figures [ figure1.8bf]-[figurecrow2 ] .",
    "somewhat unexpected , however , were the improvements in image score shown in table 1 , as most of the features in the tormam phantom , i.e. the fibre groups and disks , are essentially low - contrast features whose detection would be expected to be limited by the relative noise level in the image .",
    "the improvement in scores therefore implies an improvement in signal - to - noise ratio for this phantom . for the filaments and particles , which are comparable to the psf in extent ,",
    "improvements in visibility are effected by enhanced intensity and sharpness due to focussing , and by noise reduction . for the disks , which are significantly larger than the psf , sharpness ( resulting in easier edge detection ) and noise reduction",
    "are the important factors",
    ".    it may be that the improvements in features imaged against a uniform background , as in these demonstrations , are better than those which might be achieved when imaging diagnostic features against an anatomical background .",
    "suitable experiments are under way .",
    "there are a number of possible applications of mem deconvolution in radiology .",
    "this paper has demonstrated the use of high geometric magnification in conjunction with a relatively large focal spot .",
    "other options might be to use larger focal spot tubes to increase heat capacity and therefore allow extremely short exposures , or high outputs which could be used with high filtration .",
    "other deconvolution problems in radiology include light scatter in image intensifier optics and reduction of the effects of scattered radiation .",
    "an image processing approach based on a maximum entropy method has been applied to the problem of restoring focal spot geometric blurring in magnification mammography .",
    "the results show an improvement in image spatial resolution and an improvement in terms of the image signal - to - noise ratio perceived by the observer , as evaluated using a standard phantom and at a realistic quantum noise level .",
    "this successful demonstration of image de - blurring in noisy radiological images offers the possibility of weakening the link between focal spot size and geometric blurring in radiology , and thus opening up new approaches to system optimization .",
    "a. jannetta acknowledges receipt of a research studentship from northumbria university .",
    "we are grateful to the royal society for award of research grant 574006.g503/23863/sm for the purchase of dedicated hardware and image processing software .",
    "it is a pleasure to thank dr .",
    "stephen gull of the astrophysics group , cavendish laboratory , university of cambridge for many useful conversations about mem .",
    "cowen a  r , brettle d  s , coleman n  j  parkin g  j  s 1992 a preliminary investigation of the imaging performance of photostimulable phosphor computed radiography using a new design of mammographic quality control test object _",
    "j. radiol . _ * 65 *  52835"
  ],
  "abstract_text": [
    "<S> an image restoration approach based on a bayesian maximum entropy method ( mem ) has been applied to a radiological image deconvolution problem , that of reduction of geometric blurring in magnification mammography . </S>",
    "<S> the aim of the work is to demonstrate an improvement in image spatial resolution in realistic noisy radiological images with no associated penalty in terms of reduction in the signal - to - noise ratio perceived by the observer . </S>",
    "<S> images of the tormam mammographic image quality phantom were recorded using the standard magnification settings of 1.8 magnification / fine focus and also at 1.8 magnification / broad focus and 3.0 magnification / fine focus ; the latter two arrangements would normally give rise to unacceptable geometric blurring . </S>",
    "<S> measured point - spread functions were used in conjunction with the mem image processing to de - blur these images . </S>",
    "<S> the results are presented as comparative images of phantom test features and as observer scores for the raw and processed images . </S>",
    "<S> visualization of high resolution features and the total image scores for the test phantom were improved by the application of the mem processing . </S>",
    "<S> it is argued that this successful demonstration of image de - blurring in noisy radiological images offers the possibility of weakening the link between focal spot size and geometric blurring in radiology , thus opening up new approaches to system optimization . </S>"
  ]
}