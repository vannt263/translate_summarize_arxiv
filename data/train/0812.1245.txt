{
  "article_text": [
    "the zeus experiment  @xcite was operated at the electron - proton collider hera at desy until 2007 .",
    "the zeus detector was a sophisticated , multi - component tool for studying particle reactions provided by electron - proton collisions with an energy 27.5 gev and 920 gev , respectively .",
    "the inner tracking components of the zeus detector were : the silicon strip micro vertex detector  @xcite with barrel ( bmvd ) and forward ( fmvd ) parts ; the central tracking detector ( ctd )  @xcite consisting of the cylindrical drift chamber ; the forward tracking device ( ftd )  @xcite and the forward straw - tube tracker ( stt )  @xcite .",
    "the mvd was located in the vicinity of interaction point , inside of the ctd .",
    "the magnetic field in the central region of the zeus detector was produced by a thin superconducting solenoid .",
    "the field had a strength of 14.3 kgauss at the center and was directed parallel to the proton beam .",
    "the barrel mvd and ctd were located in the field which was almost homogeneous with a small radial component far from the center .",
    "forward trackers were placed outside of the solenoid or close to its edge where the field is inhomogeneous .",
    "we consider a mathematical framework for a rigorous approach to a common track fit , which can be performed with tracks including all inner tracking components or with any combination of them .",
    "the approach offers a rigorous treatment of field inhomogeneity , multiple scattering and energy loss . the track fitting procedure makes use of the kalman filter technique and we discuss how to optimize computations and make the fitting procedure fast .",
    "the zeus coordinate system is a right - handed cartesian system , with the @xmath0axis pointing in the proton beam direction ( forward ) and the @xmath1axis pointing to the center of the hera ring .",
    "the coordinate origin is at the nominal interaction point .",
    "the barrel ( bmvd ) and forward ( fmvd ) section of the mvd includes 600 and 112 sensors , respectively  @xcite .",
    "a sensor is a silicon single - sided strip detector with a readout pitch of @xmath2 which includes five innermost strips for capacitive charge division .",
    "the zeus mvd has 307,200 and 53,730 readout channels in the barrel and forward sections , respectively .",
    "the barrel section , centered at the interaction point , is about 63 cm long .",
    "the silicon sensors are arranged in three concentric cylindrical layers with radii about 5 cm , 8 cm and 12 cm .",
    "two back to back sensors in a layer provide measurements of nominal @xmath3 and @xmath0 position .",
    "the fmvd is composed of four transverse disks of 14 wedges each , which extend the angular coverage down to @xmath4 from the beam line .",
    "each wedge has two sensor layers separated by approximately 8 mm in @xmath0direction .",
    "they are mounted back to back , such that the angle between strips is @xmath5 .",
    "the ctd  @xcite is a cylindrical drift chamber , with a sensitive volume approximately 2 m in length and 0.4 ( 1.6 m ) in inner ( outer ) diameter .",
    "the ctd wires are arranged into nine concentric superlayers numbered consecutively from the inside out .",
    "the odd - numbered superlayers have sense wires running parallel to the chamber axis ( i.e. @xmath0axis ) while those in the even - numbered superlayers have a @xmath6 stereo angle .",
    "we denote sense wires in corresponding superlayers as axial and stereo , respectively .",
    "each superlayer contains eight sense wire layers  there are 4608 sense wires in total .",
    "a set of eight sense wires is surrounded by field wires , azimuthally dividing a superlayer into cells of polygonal shape .",
    "each sense wire is read out by a flash adc and , finally a drift distance is evaluated for a hit .",
    "all axial wires in superlayer one and the odd numbered wires in superlayer three and five ( in total 704 wires ) are additionally equipped with the z - by - timing system , which measures @xmath0 position of a hit",
    ".    the stt uses straw drift chambers with 7.5 mm diameter capton tubes of varying length from 20 cm to 75 cm .",
    "there are in total 10,944 wires in 48 wedge shaped sectors .",
    "each wedge covers an azimuthal span of @xmath7 .",
    "each sector consists of 3 layers of straws perpendicular to the @xmath0axis .",
    "a track crossing the stt nominally delivers 24 drift time measurements .",
    "the likelihood function of a track measurement has a meaning regardless of the details of any fitting method .",
    "the maximum - likelihood estimator is _ efficient _ in the sense that no other unbiased estimator has smaller variances .",
    "a track model which is appropriate for the likelihood function , together with a given method of track fit , may produce an efficient estimate of parameters .",
    "a general point of view of the information delivered by a tracker can help to interpret behavior of variances of fitted parameters and hit residuals .",
    "we can model a multi - component tracker by a set of track detecting elements and intermediate blocks of passive material , which are located in a static magnetic field .",
    "track parameters in the detector element @xmath8 are described by a vector @xmath9 . for the case of a three - dimensional fit ,",
    "the dimension of the vector,@xmath9 , is 5 .",
    "the track measurement in the tracker element @xmath8 , i.e. the @xmath10 hit , is a vector denoted by @xmath11 . in general @xmath11 is the vector with its dimension corresponding to that of the tracking element .",
    "for example , @xmath11 has only 1 coordinate for a silicon strip of the mvd , a drift tube of the stt or a stereo wire of the ctd and 2 coordinates ( drift time and @xmath0 position of a hit ) for an axial wire of the ctd which is additionally equipped with the z - by - timing system .",
    "the measurement error can be described by the covariance matrix @xmath12 .",
    "we approximate the probability ( density ) of the measurement @xmath11 given the vector of track parameters @xmath9 @xmath13 by a gaussian function with the mean value @xmath14 and covariance matrix @xmath12 : @xmath15 where @xmath16 is a normalization constant .",
    "an operator @xmath17 projects the actual vector @xmath9 into the space of measurement : @xmath18    suppose that we are interested in the track parameters at the beginning of track , @xmath19 .",
    "the likelihood function takes the form of a product : @xmath20 the first term is the probability for a particle to pass through the points @xmath21 given the parameters @xmath19 at the beginning and the second one is the probability to obtain the measurements , @xmath22 , while measuring the points in the space of track parameters @xmath23 of the real ( not the mean ) trajectory .",
    "the probability , @xmath24 , can be approximated by a gaussian distribution @xmath25 the mean trajectory is defined as : @xmath26 where the operator @xmath27 swims track parameters @xmath19 into the detector element @xmath8 .",
    "the track model may be described as a continuous curve for the mean trajectory with fluctuations of actual parameters @xmath9 with respect to the mean trajectory , @xmath28 the fluctuation , @xmath29 , accumulates the effect of multiple scattering on the pass from the beginning of the track to the given element .",
    "vectors @xmath30 are correlated and , therefore , matrix @xmath31 has dense structure ( many non - zero elements ) .",
    "we can combine gaussian functions from ( [ lx1 ] ) and ( [ pxnx2 ] ) : @xmath32 where the non - diagonal covariance matrix @xmath33 has dimension equal to the sum of dimensions of all measurements @xmath34 .",
    "the dimension of the @xmath35 may be of order @xmath36 for modern tracking detectors .",
    "maximization of the likelihood function of gaussian type , i.e. least square fitting with large non - diagonal covariance matrix @xmath35 , requires a lot of computations , although not more than 5 parameters are fitted . because of large computing time , the model is not convenient for a track fitting in a multi - component tracker .",
    "but the model includes a small number of fitted parameters , and is suitable for a subsequent update of detector alignment parameters  @xcite , where an expansion of hit residuals w.r.t .",
    "fitted parameters is needed .",
    "a charged particle traversing a medium can be described by a stochastic process with the markov property and , therefore , the conditional probability distribution of future states depends only upon the present state and not on any past states . the probability function for a particle to pass through the points @xmath37 in ( [ pxnx2 ] )",
    "can be rewritten as : @xmath38 we approximate the conditional probability ( density ) , @xmath39 , for track parameters @xmath9 , given the parameters in the previous state @xmath40 , by the gaussian distribution , @xmath41 with the mean @xmath42 and covariance matrix @xmath43 .",
    "the mean trajectory in the tracking element @xmath8 is @xmath44 the operator @xmath45 swims track parameters @xmath40 into the detector element @xmath8 according to the equations of motion .",
    "suppose that we are interested in track parameters in all points of track measurement , i.e. @xmath46 .",
    "the likelihood function takes a form : @xmath47 with gaussian functions @xmath48 and @xmath49 where @xmath16 and @xmath50 are normalization constants .",
    "the model for the total track is not a continuous curve , but consists of @xmath51 continuous segments .",
    "a variation of track parameters in the point of discontinuity @xmath52 describes the effect of multiple scattering on the pass from the the previous element @xmath53 to the element @xmath8 .",
    "vectors @xmath54 are uncorrelated .",
    "a spread of the @xmath55 is defined by the covariance matrix @xmath56 .",
    "the maximum likelihood estimation of parameters @xmath57 satisfies the system of equations @xmath58 if operators @xmath45 and @xmath17 are non - linear ( e.g. in magnetic field ) then the latter equations are non - linear also",
    ". the problem can be solved iteratively using the well known method of linearization of operations ( [ ex ] ) and ( [ xkswim ] ) .",
    "anyhow we can regard the functional , @xmath59 , as a linear form w.r.t .",
    "vectors of estimated parameters @xmath60 .",
    "the vector , @xmath9 , associates in ( [ lxn ] ) only with vectors in neighboring data points @xmath53 and @xmath61 and , therefore , the linear form @xmath59 includes only 3 terms with vectors @xmath62 and @xmath63 isolates a coefficient in a corresponding linear term . ] , respectively .",
    "finally , the system ( [ dldx ] ) looks as @xmath64 where submatrices related to points @xmath65 , @xmath66 are parts of the information matrix .",
    "the sparse ( with many zero elements ) , band structure of the information matrix can be exploited to reduce computations drastically .",
    "this can be achieved by using either a dedicated algorithm of matrix inversion  @xcite , or else ( e.g. in the broken lines fit  @xcite ) by the matrix ( cholesky ) decomposition into a unit triangle , @xmath67 , and a diagonal , @xmath68 , matrix @xmath69 which requires two steps to solve for @xmath70 : @xmath71 the track model based on relations ( [ xkswim ]  [ dxk ] ) is well suited also for an implementation of the progressive track fit by the method  @xcite or for the application of the kalman filter formalism  @xcite .",
    "both methods are rather economical regarding computing time because they include operations with matrices of maximal size 5 by 5 for each hit .",
    "in  @xcite it was shown that an appropriate mathematical framework for the iterative procedure of track fitting is the theory of linear filtering , in particular the kalman filter  @xcite . to consider the mathematical framework of a kalman filter , we try to follow the notation used in  @xcite . in the following",
    "we describe a case with a linear system and a non - linear system will be discussed at subsec .",
    "[ nonlinear ] .",
    "the kalman filter proceeds progressively from one measurement to the next and improves the knowledge about the particle trajectory by updating the track parameters with each new measurement . the system state vector ( track parameters ) after inclusion of @xmath53 measurements is denoted by @xmath72 , and its covariance matrix by @xmath73 .",
    "the state vector and its covariance matrix are propagated to the location of the next measurement with the _ prediction equations _ :",
    "@xmath74 and @xmath75 where @xmath45 is the transport matrix and @xmath56 denotes the covariance matrix of the _ process noise _ , which occurs due to the random perturbation of the particle s trajectory .",
    "the measurement of the vector @xmath76 and its covariance matrix are denoted by @xmath11 and @xmath12 , respectively .",
    "the _ expected _ measurement @xmath11 is described by the projection matrix @xmath17 .",
    "the estimated residuals are @xmath77 and its covariance matrix become : @xmath78 the updating of the system state vector after inclusion of the measurement @xmath8 is defined by the _ filter equations _ : @xmath79 with the filtered residuals and its covariance matrix @xmath80 the matrix , @xmath81 , is called the _ filtering ( gain ) matrix_. the filtered state vector is pulled towards the measurement and , therefore the quadratic mean of the filtered residual is smaller than the measurement error .",
    "the @xmath82 increment after the filtering of the state vector is given by : @xmath83    the track parameters after the filtering procedure are known with optimal precision only at the last point of the fit . the smoothing part of the kalman filter is a very useful complement , which solves the problem of optimal parameter estimation at every point of the trajectory .",
    "the smoothing is also a recursive procedure which proceeds step by step in the direction opposite to that of the filter with the _ smoother equations _ : @xmath84 the smoothed state vector , @xmath85 , is more precise , because it includes information from all measurements .",
    "the variance of the smoothed state vector , @xmath86 , is smaller than the variance of the filtered state vector , @xmath87 .",
    "the quadratic mean of the smoothed residual is closer to the measurement error ( detector resolution ) than the filtered one .",
    "a particle s motion in a detector with magnetic field is a nonlinear process . in case of a non - linear system",
    ", we have to replace the transport , @xmath45 , and projection , @xmath17 , matrices in ( [ fxk1 ] ) and ( [ frk ] ) , respectively , by exact non - linear functions : @xmath88 jacobian matrices of these functions ( jacobians in the following ) @xmath89 will be used in equations for covariance matrix propagation ( [ ck1 ] ) and ( [ crk ] ) instead of @xmath45 and @xmath17 , respectively . in practice ,",
    "estimation with kalman filter for a non - linear system shows properties similar to those of maximum - likelihood estimation :    * the estimator is asymptotically unbiased , i.e. its bias tends to zero as the number of measurements increases . *",
    "the distribution of deviations of estimated parameters from true values approaches a gaussian distribution also asymptotically , i.e for sufficiently large number of measurements .",
    "the equation of motion of a particle with momentum @xmath90 ( velocity @xmath91 ) and charge @xmath92 in a static magnetic field @xmath93 is : @xmath94 where coordinates @xmath95 are in cm , @xmath96 is in gev / c , the magnetic field @xmath97 is in kgauss , and parameter @xmath98 is equal : @xmath99 the distance along the trajectory of a particle ( path length ) is given by : @xmath100 the unitary vector @xmath101 pointing along the direction of the trajectory is : @xmath102 equation  ( [ dpdt ] ) can be rewritten as : @xmath103 where @xmath104 . the latter equation combined with eq .",
    "( [ n ] ) gives a system of linear differential equations : @xmath105 where @xmath106 .",
    "the zeus inner tracking detectors were designed using minimal material . we take account of the effect of multiple scattering in the approximation of thin scatterers .",
    "multiple scattering after traversing a material of small thickness , @xmath107 , results in the perturbation of angles and coordinates , but the effect on the latter has an additional order of smallness @xmath108 and can be neglected .",
    "the deflection of the particle momentum @xmath90 due to multiple scattering is decomposed into deflections in two orthogonal planes .",
    "we define two unit vectors @xmath109 which in combination with @xmath101 form a right - handed cartesian system : @xmath110 the direction of the momentum after the scattering is : @xmath111 where @xmath112 are random variables with @xmath113 here @xmath114 is the well - known molire theory expression for rms of the deflection angle of a charged particle traversing a medium  @xcite @xmath115,\\ ] ] where @xmath116 is the material thickness in radiation lengths , which has to account for the track inclination : @xmath117 we rewrite eq .",
    "( [ nprim ] ) for the deflection of components : @xmath118 taking into account eqs .",
    "( [ thetams ] ) , we derive : @xmath119 an ionization energy loss is regarded as a deterministic correction to a track energy . in the approximation of thin scatterer , track energy , @xmath120 , after the traversal of a material is : @xmath121 where @xmath122 is the mean rate of ionization energy loss in the material .",
    "seven equations ( [ dxds ] ) describe a particle motion in a magnetic field , although five parameters suffice to define the trajectory at any point .",
    "a suitable track parameterization may depend on the detector geometry and field shape . the magnetic field in the central part of the zeus detector",
    "is directed parallel to the @xmath0axis . for the large part of the mvd",
    "the field is almost homogeneous with only a small radial component ( @xmath123 at the edge of the bmvd ) . for the most forward parts of the ctd and fmvd",
    "the inhomogeneity is larger , with reduction of the axial component by 8% and increasing of the radial component up to 15% .",
    "the stt detector is located outside the superconducting solenoid where the field is inhomogeneous .",
    "we choose a different way to proceed depending on the polar angle,@xmath124 , of a track ( @xmath125 ) :    * we use an option with inhomogeneous field for `` forward '' tracks @xmath126 ; * a homogeneous field model is used for `` central '' tracks @xmath127 ; * an inhomogeneous field is used also for `` rear '' tracks @xmath128 .",
    "the set of measurements , @xmath34 , with its covariance matrices , @xmath129 , and the map of magnetic field , @xmath93 , are input for the track fit . to develop a mathematical framework for kalman filter implementation we have to make the following steps :    * select a convenient parameterization of the state vector , @xmath9 . *",
    "find a solution of the prediction equations , @xmath130 , and a function to project the vector @xmath9 to the measurement , @xmath131 .",
    "* obtain jacobians of latter functions @xmath132 * define covariance matrix of the process noise , @xmath56 .",
    "the magnetic field at the central region of the zeus superconducting solenoid is nearly parallel to the @xmath0axis ( @xmath133 ) and has almost constant strength .",
    "therefore we approximate it as homogeneous on the path from one point to the next .",
    "the system of equation ( [ dxds ] ) looks as @xmath134 where @xmath135 .",
    "the component @xmath136 is constant and the angle ( azimuthal ) , @xmath137 , of the track direction with the @xmath1axis depends linearly on @xmath138 : @xmath139 where @xmath140 are initial values at @xmath141 . a pair of conserved quantities can be derived from ( [ soldxds ] ) : @xmath142 with initial values , @xmath143 .",
    "coordinates can by expressed via the track direction : @xmath144 in a homogeneous field , the particle trajectory is a helix . for the case of axial ( cylindrical ) symmetry ,",
    "a natural replacement of particle coordinates , @xmath1 and @xmath145 , are the radius , @xmath146 , and the @xmath147coordinate at radius @xmath146 , which we denote as @xmath148 .",
    "the relation between these pairs of parameters reads : @xmath149 and @xmath150 with the usage of an arc - length in the @xmath151-plane , @xmath152 , corresponding curvature @xmath153 and parameter @xmath154 ( cotangent of the polar angle of the particle direction ) @xmath155 we obtain the solution for particle coordinates : @xmath156 where @xmath157 are values at @xmath158 .",
    "the particle which is located at a radius , @xmath159 , given @xmath158 , then arrives at a radius , @xmath146 , given the value of @xmath160 , which satisfies the equation : @xmath161 solutions of the latter equation are @xmath162 \\\\ d = r^2 - r_0 ^ 2 = \\delta r ( 2 r_0 + \\delta r),\\,\\,\\ , \\delta r = r - r_0 . \\end{array }   \\label{t}\\ ] ] the solution @xmath163 ( with minus sign ) corresponds to a shorter path length .",
    "we describe a particle in a homogeneous magnetic field by a state vector at a reference cylindrical surface of radius @xmath164 : @xmath165 where    * @xmath166  =   @xmath147coordinate at radius @xmath164 , * @xmath167  =  @xmath0-coordinate , * @xmath168  =  angle of @xmath151-projection of track direction with the @xmath1axis , * @xmath169  =  @xmath170 at radius @xmath164 , * @xmath171  =  @xmath172 , inverse momentum signed according to particle charge , @xmath92 .",
    "such cylindrical parameterization looks natural for the barrel tracking detectors .",
    "an analogous state vector was used for the implementation of the kalman filter formalism for the aleph time projection chamber  @xcite .      in the prediction stage of the kalman filter ,",
    "the state vector @xmath173 is propagated at the next reference radius , @xmath174 .",
    "we obtain this transformation from ( [ xyru][xyzt ] ) : @xmath175 where @xmath176 and the variable , @xmath177 , is evaluated from ( [ t ] ) .",
    "we approximate the jacobian of this transformation as : @xmath178 elements of the jacobian which always are very close to zero or unity , we set explicitly to 0 or 1 , respectively .",
    "we exploit the sparse structure of the jacobian to reduce computations , as will be discussed in sect .",
    "[ fastkf ] .",
    "nontrivial elements of the jacobian are presented in appendix a.          each sense stereo wire runs at a small angle , @xmath192 , and its location in the @xmath151-plane at coordinate @xmath0 is : @xmath193 where @xmath194 is the @xmath0coordinate of the nominal center of the ctd .",
    "a `` planar drift '' approximation is used to render measurements in space  @xcite .",
    "drift distance is measured along the `` planar drift measurement axis '' , @xmath180 : @xmath195 which is obtained by rotating the vector , @xmath101 , through @xmath196 .",
    "the vector @xmath101 depends linearly on the @xmath0 coordinate : @xmath197 a state vector @xmath9 is defined at a cylindrical reference surface of a radius , @xmath164 .",
    "we define the radius , @xmath164 , in a way that the reference point is close to the point where the trajectory hits the planar drift plane .",
    "close to the reference point , we use linearized equations of motion ( [ linxyz ] ) .",
    "a condition of the trajectory intersection with the planar drift plane reads : @xmath198 = 0.\\\\ \\end{array }    \\label{intersctd}\\ ] ] the variable advance , @xmath183 , to travel from the radius , @xmath184 , to the planar drift plane is a solution ( of smallest absolute value ) of a quadratic equation , @xmath199 : @xmath200 with coefficients @xmath201 \\omega_k / \\lambda_k , & { \\cal p}_{ky } =   \\left [ p_{wy } + ( z_k - z_c ) p'_{wy } \\right ] \\omega_k / \\lambda_k .",
    "\\\\ \\end{array }    \\label{coeffctd}\\ ] ] the expected measurement , @xmath131 , is the drift distance . to evaluate it , we project the position vector in the planar drift system of the wire , @xmath202 , to the measurement axis @xmath180 : @xmath203.\\\\ \\end{array }    \\label{projctd}\\ ] ] to `` stretch '' the projected value according to the stereo angle , @xmath192",
    ", we have to replace @xmath180 by @xmath204 in the following formulas .",
    "the expected measurement is a linear function of the @xmath183 : @xmath205 we approximate the jacobian , @xmath206 , by setting its elements which are very close to zero or unity , explicitly to 0 or 1 : @xmath207 nontrivial elements of the jacobian are defined in appendix b.    the axial wires of the ctd run parallel to the @xmath0axis and parameters @xmath208 and @xmath209 vanish in ( [ rsw ] ) and ( [ nsw ] ) , respectively . a condition of the intersection of the trajectory with the `` planar drift plane '' results in eq .",
    "[ intersctd ] , which has the solution @xmath210 a measurement vector for an axial wire , @xmath11 , is either one - dimensional ( drift distance ) or two - dimensional ( drift distance and z position ) . let s consider the vector of expected measurement , @xmath131 , for a general , two - dimensional case @xmath211 with the first component ( drift distance ) and second ( z position ) , which are defined in ( [ projctd ] ) and ( [ linxyz ] ) , respectively : @xmath212 we approximate the jacobian , @xmath213 as : @xmath214 and @xmath215 elements of the jacobian are presented in appendix b.      we evaluate the components of a vector of particle direction , @xmath101 , using parameters @xmath216 : @xmath217 we obtain deviations of parameters @xmath216 , induced by multiple scattering , from eq .",
    "( [ varn ] ) : @xmath218 where @xmath219 are random variables defined by ( [ thetams ] ) .",
    "nonzero elements of the matrix , describing multiple scattering in one scatterer , are : @xmath220 with rms of the deflection angle , @xmath114 , which is defined by eq .",
    "( [ sms ] ) .",
    "the matrix , @xmath56 , in eq.([ck1 ] ) takes into account a summary effect of multiple scattering : @xmath221 and , therefore the index @xmath222 runs over all elements of material on the path from @xmath223 to @xmath10 state .",
    "the following choice of track parameters at a reference @xmath0coordinate is suited for forward tracks ( @xmath224 ) : @xmath225 where    * @xmath1  =   @xmath1coordinate in the cartesian coordinate system of zeus , * @xmath145  =   @xmath145coordinate in the cartesian coordinate system , * @xmath226  =  @xmath227 track slope in @xmath228plane , * @xmath229  =  @xmath230 track slope in @xmath231plane , * @xmath232  =  @xmath233 , inverse momentum signed according to particle charge , @xmath92 .",
    "this parametrization will be called `` cartesian '' .",
    "the implementation of the kalman filter technique in an inhomogeneous magnetic field is analogous to those described in  @xcite . in the following",
    "we discuss the case of forward tracks .",
    "the rear tracks are specified in subsec .",
    "[ rear ] .      for forward tracks we can use the @xmath0 coordinate as independent variable instead of the path length in eqs .  ( [ dxds ] ) .",
    "the equations rewritten w.r.t .",
    "@xmath0 coordinate read : @xmath234 where the functions @xmath235,@xmath236 are @xmath237,\\\\ a_{y}=(1+t_{x}^{2}+t_{y}^2)^{\\frac{1}{2}}\\cdot   \\left[-t_{x}\\cdot(t_{y}b_{y}+b_{z } ) + ( 1+t_{y}^{2})b_{x } \\right].\\\\ \\end{array }   \\label{dxdz1 } \\end{array}\\ ] ] to transport track parameters in the inhomogeneous field from plane @xmath238 to plane @xmath0 , we solve the latter equations with initial values defined at @xmath239 @xmath240 three methods are used to solve eqs .",
    "( [ dxdz ] ) , depending on the distance , @xmath241 between these planes .",
    "_ @xmath242 _ : a parabolic expansion of the particle trajectory is used    @xmath243    \\2 .",
    "_ @xmath244 _ : the classical fourth - order runge - kutta method  @xcite is selected to find the solution of the equations ( [ dxdz ] ) .",
    "_ @xmath245 _ : a fifth - order runge - kutta method with adaptive step size control  @xcite is used .",
    "the jacobian of transformation of parameters given at @xmath239 to @xmath0 , @xmath246 , is defined as : @xmath247 elements of the latter jacobian which are very close to zero or unity , are set to 0 or 1 , respectively .",
    "nontrivial elements of the jacobian ( [ jacobcar ] ) for short distance @xmath248 we approximate as : @xmath249 with derivatives @xmath250 and @xmath251 , which we define below .    to swim derivatives at long distance ( @xmath252 )",
    ", we define equations for derivatives as described in @xcite and solve them by a runge - kutta method simultaneously with equations of motion .",
    "the magnetic field is smooth enough even in the stt area and , therefore we regard eqs.([dxdz ] ) as almost invariant with respect to small shifts by @xmath1 and @xmath145 .",
    "derivatives with respect to initial @xmath253 , @xmath254 are trivial : @xmath255 to obtain equations for @xmath256 , we differentiate equations ( [ dxdz ] ) with respect to @xmath257 and change the order of the derivative operators @xmath258 and @xmath259 on the left hand sides : @xmath260 , \\\\",
    "d / dz(\\partial t_{y } / \\partial t_{x0 } ) = &    q_{0 } \\cdot \\kappa \\cdot \\left[(\\partial a_{y}/\\partial t_{x } ) ( \\partial t_{x}/\\partial t_{x0 } )   + ( \\partial a_{y}/\\partial t_{y } ) ( \\partial t_{y}/\\partial t_{x0 } )   \\right ] , \\\\ \\partial q / \\partial t_{x0 } \\",
    "= & 0 , \\end{array}\\ ] ] where @xmath261 initial values for the solution of latter equations are : @xmath262 the equations for @xmath263 are analogous to eqs.([dtx ] ) , but the initial values are : @xmath264 to obtain equations for @xmath265 , we differentiate eqs.([dxdz ] ) with respect to @xmath266 and change the order of the derivative operators @xmath267 and @xmath259 in the left parts : @xmath268   \\ ; , \\\\",
    "d / dz(\\partial t_{y } / \\partial q_{0 } ) = &    \\kappa \\cdot a_{y } + \\kappa \\cdot q_{0 } \\cdot \\left[(\\partial a_{y}/\\partial t_{x } ) ( \\partial t_{x}/\\partial q_{0 } )   + ( \\partial a_{y}/\\partial t_{y } ) ( \\partial t_{y}/\\partial q_{0 } )   \\right ]   \\ ; , \\\\ \\partial q / \\partial q_{0 } = & 1   \\ ; . \\end{array}\\ ] ] initial values for the solution of latter equations are : @xmath269          the linear expansion of a particle trajectory ( [ linxyzcar ] ) defines the particle coordinates in the immediate vicinity of a stereo wire .",
    "an approach to obtain the projection of cartesian state vector to ctd stereo measurement is similar to those discussed in subsec .",
    "[ projcylctd ] .",
    "a condition of the trajectory intersection with the planar drift plane reads : @xmath287 = 0,\\\\ \\end{array }    \\label{intersctdcar}\\ ] ] where the coordinate of the wire , @xmath288 , and vector , @xmath101 , are defined by ( [ rsw ] ) and ( [ nsw ] ) , respectively .",
    "the variable advance , @xmath274 , to travel from the reference plane to the planar drift plane is a solution of a quadratic equation , @xmath289 : @xmath290 with coefficients @xmath291 we obtain the expected measurement , @xmath131 , i.e. drift distance , as in ( [ projctd ] ) : @xmath292\\,m_x \\\\ & ~~+ \\left[y_k + t_{ky}\\,\\delta s_k - r_{wy }            - ( z_k - z_c+\\delta s_k)\\,r'_{wy } \\right]\\,m_y , \\\\ \\end{array }    \\label{hkcylctdcar}\\ ] ] where the @xmath180 have to by replaced by @xmath204 to take into account the stereo angle , @xmath192 . derivatives with respect to slopes have an additional order of smallness @xmath281 and we approximate the jacobian , @xmath282 , for the ctd stereo measurement : @xmath293 elements of the jacobian , @xmath279 , are presented in appendix c.    axial wires of the ctd run parallel to the @xmath0axis and parameters , @xmath208 and @xmath209 vanish in ( [ rsw ] ) and ( [ nsw ] ) , respectively .",
    "a condition of the intersection of the trajectory with the planar drift plane leads to eq .",
    "( [ intersctdcar ] ) , which has the solution : @xmath294 we consider the vector of expected measurement , @xmath131 , for the general , two - dimensional case @xmath295 with the first and second component being a drift distance and @xmath0position , respectively : @xmath296 we approximate the jacobian , @xmath213 , as : @xmath297 and @xmath298 where we take into account an additional order of smallness @xmath281 for derivatives with respect to track slopes .",
    "we obtain nontrivial elements of latter jacobians in appendix c.      signal wires of a given stt layer are arranged in a plane perpendicular to the @xmath0axis with coordinate @xmath299 .",
    "we locate the reference plane at the position of the layer , i.e. @xmath300 . the particle trajectory inside a straw tube we approximate by a straight line .",
    "the latter line and the signal wire are described as lines which pass through points @xmath301 and @xmath302 and have directions @xmath303 and @xmath304 , respectively : @xmath305 components of the vector of particle direction , @xmath303 , we calculate using track slopes @xmath306 : @xmath307 the expected measurement is a drift distance in the straw , which is evaluated as a distance between these two lines : @xmath308 after simple calculations the expected measurement reads : @xmath309 the jacobian of the latter transformation we can approximate as : @xmath310 with @xmath311      we evaluate deviations of track slopes induced by multiple scattering from eq .",
    "( [ varn ] ) : @xmath312 where @xmath219 are random variables defined by ( [ thetams ] ) .",
    "nonzero elements of the matrix describing multiple scattering in one scatterer are : @xmath313 with rms of the deflection angle , @xmath114 , which is defined by eq .",
    "( [ sms ] ) . the matrix , @xmath56 , in prediction equation ( [ ck1 ] )",
    "has to account for a summary effect of multiple scattering on a path from @xmath223 to @xmath10 state , and is therefore evaluated analogous to ( [ qijsum ] ) .      for rear tracks",
    "@xmath314 we use a parameterization analogous to those for forward tracks .",
    "the meaning of parameters @xmath315 is identical with ( [ xf ] ) . for rear tracks we define slopes w.r.t .",
    "negative direction of the @xmath0axis : @xmath316 equations of particle motion for rear tracks are identical to ( [ dxdz ] ) for forward tracks , but with slightly different definition of functions @xmath235,@xmath236 : @xmath317,\\\\ a_{y}=(1+t_{x}^{2}+t_{y}^2)^{\\frac{1}{2}}\\cdot   \\left[-t_{x}\\cdot(-t_{y}b_{y}+b_{z } ) -(1+t_{y}^{2})b_{x } \\right].\\\\ \\end{array }   \\label{dxdz1rear } \\end{array}\\ ] ] equations ( [ linxyzcar ] ) for linear and ( [ parabolic ] ) for parabolic expansions of trajectory can be used for rear tracks also , if we regard the expansion w.r.t .",
    "@xmath0coordinate decrement , @xmath318 .",
    "a global perigee parameterization of tracks  @xcite is used for analyses in the zeus experiment .",
    "the perigee parameters are parameters of a helix , which are defined at the track s point of closest approach to the @xmath0axis : @xmath319 where    * @xmath320  =  angle of @xmath151projection of track direction with the @xmath1axis , * @xmath321  =  helix curvature signed by a particle charge , @xmath92 , * @xmath322  =  signed minimal distance to @xmath0axis , * @xmath323  =  @xmath0coordinate at point of closest approach , * @xmath170  =  cotangent of track direction w.r.t . @xmath0-axis .",
    "transformations between local parameters ( cylindrical or cartesian ) and global zeus perigee parameters are given in appendix d.",
    "most of the calculation by the kalman filter technique is in the following procedures :    * transportation and projection of track parameters ( [ exac ] ) and evaluation of jacobian matrices ( [ jakob ] ) ; * matrix operations in prediction ( [ ck1 ] ) , filter ( [ kxc ] ) and smoother ( [ smooth ] ) equations ; * search of a track crossing with material to evaluate effects of multiple scattering and energy loss .",
    "approaches to fast computation with kalman filter technique were discussed for the magnet tracking  @xcite,@xcite at the hera - b detector .    to reduce computations we use a flexible strategy for propagating track parameters and derivatives in the inhomogeneous field , as described for forward and rear tracks in subsec.[eqmotion ] . for long ( @xmath324 ) distances we use numerical integration of the equations of motion , but integrate derivatives together with a `` zero trajectory '' that allows to reduce computations .",
    "for short distances ( @xmath325 ) we use parabolic expansion ( [ parabolic ] ) of the particle trajectory , which is very fast in computations .    to keep the computational effort at a minimum we exploit the sparse structures of the jacobian matrices .",
    "the jacobian of track propagation includes elements which are very close to 0 or 1 , therefore we use jacobian approximations and set such elements to 0 or 1 .",
    "the jacobians for cylindrical ( [ jacob ] ) and cartesian ( [ jacobcar ] ) parameterization contain only 11 and 10 nontrivial elements , respectively . to calculate the product of matrices @xmath326 in ( [ ck1 ] ) we implement functions , which take into account a sparse structure of the matrix @xmath45 .",
    "for example , the function for 10 nontrivial elements of the @xmath45 implies 73 multiplications , which is much smaller than 200 multiplications needed for the case of the completely filled matrix @xmath45 of size 5 by 5 .",
    "the jacobians of projection transformation , @xmath17 , are approximated also , as shown in ( [ dhdxcylmvd ] ) , ( [ dhdxcylctd ] ) , ( [ jacobhcylaxial ] ) , ( [ jacobhcylaxial1 ] ) etc .",
    "we implement corresponding functions for the calculation of products of @xmath327 and @xmath328 in ( [ kxc ] ) or @xmath329 in ( [ rrk ] ) .",
    "these functions take into account the sparse structure of the matrix @xmath17 .",
    "for example , only 20 multiplications are sufficient to obtain the matrix @xmath328 for the option with one nontrivial element in the matrix @xmath17 .",
    "this has to be compared with 100 multiplications needed for the completely filled matrix of size 5 by 1 .",
    "to evaluate the effects of multiple scattering and energy loss , we describe the distribution of material in the zeus inner trackers by using about 1800 separate volumes . after crossing a given volume",
    ", a particle can reach only a limited number of other volumes .",
    "we implement an approach called _ volume navigation _",
    "@xcite for fast search of a track s crossings with these volumes . using the monte carlo technique ,",
    "we evaluate for each volume a list of volumes , which can be crossed subsequently . on average ,",
    "one list includes about 7 subsequent volumes .",
    "the lists are used to navigate a fast search of track crossing with volumes .",
    "the described approaches have been programmed  @xcite in c++ .",
    "we follow recipes of effective programming of numerical calculations  @xcite and implement stl containers to store objects like hits , states , tracks etc .",
    "[ cpu ]    . computing time of the track fit per zeus event on a pc with processor intel cpu 3.06ghz for different groups of tracks .",
    "[ cols=\"^,^,^,^\",options=\"header \" , ]     a zeus event contains up to 100 fitted tracks and about 30 tracks on average .",
    "the longest tracks include about 80 hits in the central area , 50 hits in a transition region and 30 hits in the very forward direction .",
    "fitting all the tracks in one event takes @xmath330 on pc with processor intel cpu 3.06ghz ( see table[cpu ] ) and @xmath331 with processor intel cpu 1ghz .",
    "about of @xmath332 of tracks are fitted using the inhomogeneous field as shown in table[cpu ] .",
    "the computing time for these tracks is comparable with those which are fitted using the homogeneous field approximation .",
    "( 15.5,20 ) ( -0.50,14.0 ) ( 7.7,14.0 )    ( -0.50,7.0 ) ( 7.7,7.0 )    ( -0.50,0.0 )    ( 4.75,18.9)(0,0)[t ] ( 12.5,18.9)(0,0)[t]@xmath321 ( 4.5,11.9)(0,0)[t]@xmath322 ( 12.5,11.9)(0,0)[t]@xmath333 ( 4.5,4.9)(0,0)[t]@xmath170    the precision of fitted parameters depends on the resolution and details of the performance of the zeus trackers and will be discussed in the next note  @xcite . here",
    "we would like to mention that approximations implemented to reduce computations , are not made at the expense of track parameter precision .",
    "evaluation of the covariance matrices of fitted parameters in ( [ kxc ] ) and ( [ smooth ] ) are the most complicated computations , including operation with the transport , projection and process noise matrices .",
    "calculated variances of these matrices are in good agreement with the residuals of the fitted parameters .",
    "standard deviations of pull distribution ( residuals normalized by their estimated error ) are close to unity for different track momenta , as shown in fig.[pull_mom ] .",
    "we consider a mathematical framework for the rigorous approach to a common track fit using the trackers in the inner region of the zeus detector : ctd , bmvd , fmvd and stt .",
    "we discuss track models and likelihood functions in such a multi - component tracker .",
    "the approach offers a rigorous treatment of field inhomogeneity , multiple scattering and energy loss . the track fitting procedure makes use of the kalman filter technique .",
    "we describe details of the mathematics for the fast implementation of a kalman filter for the cylindrical drift chamber , barrel and forward silicon strip detectors and straw drift chambers .",
    "the cases of homogeneous and inhomogeneous field are considered .",
    "we discuss how to reduce computations and make the track fitting procedure fast .",
    "average computing time of track fitting in one zeus event is about of 20ms on a pc with processor intel cpu 3.06ghz .",
    "* acknowledgments : * fruitful discussions with r.mankel helped me a lot to finalize the results .",
    "cordial thanks to a.antonov , c.catteral and g.hartner for their expertise on the implementation of zeus trackers in the simulation and reconstruction software .",
    "i am grateful to o.behnke and g.hartner for the careful reading of the manuscript .",
    "i would like to thank the zeus group at desy for the kind hospitality extended to me during my visit .",
    "10    a.  polini et al . , nucl .",
    "instr .  and meth .",
    "* a581 * ( 2007 ) 656    b.  foster et al .",
    "instr .  and meth .",
    "* a228 * ( 1994 ) 254    s.  fourletov(zeus stt collaboration ) , nucl .",
    "instr .  and meth .",
    "* a535 * ( 2004 ) 191    by zeus collaboration ( r. mankel for the collaboration ) , _ alignment of the zeus micro - vertex detector , _ prepared for 1st lhc detection alignment workshop , geneva , 4 - 6 sep 2006 . published in `` geneva 2006 , lhc detector alignment '' ( 2006 )",
    "51    v.p .",
    "zhigunov , s.g .",
    "nikitin , v.f .",
    "perelygin and a.a .",
    "spiridonov , nucl .",
    "instr .  and meth .",
    "* 179 * ( 1981 ) 427    v.  blobel , nucl .",
    "instr .  and meth .",
    "* a566 * ( 2006 ) 14    p.  billoir , nucl .",
    "instr .  and meth .",
    "* 225 * ( 1984 ) 352    r.  frhwirth , nucl .",
    "instr .  and meth .",
    "* a262 * ( 1987 ) 444    r.e .",
    "kalman , trans .",
    "asme , j.basic engineering ( 1960 ) r.  battin , am .",
    "rocket soc .",
    "32 ( 1962 ) 1681 r.e .",
    "kalman and r.s .",
    "bucy , trans .",
    "asme , j.basic engineering ( 1962 )    r.  mankel , rep .",
    "* 67 * ( 2004 ) 553    t.lohse , w.witzeling , adv .",
    "high energy phys .",
    "* 9 * ( 1992 ) 81    g.  hartner , _ vctrak briefing : program and math , _ zeus note 98 - 058 ( 1998 )    w.  press , s.  teukolsky , w.  vetterling and b.  flannery , _ numerical recipes in c , _ cambridge university press , cambridge ( 1992 )    a.spiridonov , _ optimized integration of the equations of motion of a particle in the hera - b magnet _ , hera - b note 98 - 113 ( 1998 ) , physics/0511177    r.mankel and a.spiridonov , nucl .",
    "instr .  and meth .",
    "* a426 * ( 1999 ) 268    a.  spiridonov , nucl .  instr .  and meth .",
    "* a566 * ( 2006 ) 153    r.mankel , nucl .",
    "instr .  and meth .",
    "* a395 * ( 1997 ) 169    a.spiridonov , _ implementation and performance of rigorous track fit for the zeus detector _ , zeus note in preparation",
    "elements of the jacobian ( [ dhdxcylctd ] ) of projection transformation ( [ hkcylctd ] ) for the stereo ctd are : @xmath336,\\\\ \\end{array }    \\label{dhdxcylctd1}\\ ] ] with derivatives @xmath337,\\\\ ~~\\partial a_{ky}/\\partial \\lambda_k&= -\\frac{\\displaystyle 1}{\\displaystyle \\omega_k } \\left [ \\frac{\\displaystyle \\lambda_k } { \\displaystyle 1 + \\lambda_k^2 } ( \\sin \\phi_k - \\lambda_k r'_{wy } ) + r'_{wy } \\right].\\\\ \\end{array }    \\label{dtdxcylctd}\\ ] ] elements of the corresponding jacobian ( [ jacobhcylaxial ] ) for the axial ctd look as : @xmath338",
    "nontrivial elements of the jacobian ( [ hcarctds ] ) of projection transformation ( [ hkcylctdcar ] ) for the stereo ctd are : @xmath339 with @xmath340 @xmath341 elements of the corresponding jacobian ( [ jacobcaraxial ] ) for the axial ctd read as : @xmath342 with @xmath343 @xmath344",
    "track parameters , @xmath345 , at the beginning of a central track , which is fitted using the cylindrical parameterization ( [ xsol ] ) , are converted to perigee parameters ( [ xsperigee ] ) : @xmath346 where @xmath347   - { \\frac { \\displaystyle \\pi}{\\displaystyle 2}}\\,{\\rm sign}(q / r_h ) .",
    "\\end{array}\\ ] ] we convert fitted cartesian parameters at the beginning of a forward track , @xmath348 , into perigee parameters ( [ xsperigee ] ) : @xmath349 where @xmath350 the transformation from cartesian to perigee parameterization for rear tracks is similar to ( [ carper ] ) for parameters @xmath351 , but differs for parameters @xmath323 and @xmath352 : @xmath353"
  ],
  "abstract_text": [
    "<S> in this note we present a mathematical framework for a rigorous approach to a common track fit for trackers located in the inner region of the zeus detector . </S>",
    "<S> the approach makes use of the kalman filter and offers a rigorous treatment of magnetic field inhomogeneity , multiple scattering and energy loss . </S>",
    "<S> we describe mathematical details of the implementation of the kalman filter technique with a reduced amount of computations for a cylindrical drift chamber , barrel and forward silicon strip detectors and a forward straw drift chamber . </S>",
    "<S> options with homogeneous and inhomogeneous field are discussed . </S>",
    "<S> the fitting of tracks in one zeus event takes about of 20ms on standard pc . </S>"
  ]
}