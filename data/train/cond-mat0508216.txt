{
  "article_text": [
    "the cluster variation method ( cvm ) was introduced by kikuchi @xcite in 1951 , as an approximation technique for the equilibrium statistical mechanics of lattice ( ising  like ) models , generalizing the bethe ",
    "peierls @xcite and kramers  wannier @xcite approximations , an account of which can be found in several textbooks @xcite .",
    "apart from rederiving these methods , kikuchi proposed a combinatorial derivation of what today we can call the cube ( respectively triangle , tetrahedron ) approximation of the cvm for the ising model on the simple cubic ( respectively triangular , face centered cubic ) lattice .",
    "after the first proposal , many reformulations and applications , mainly to the computation of phase diagram of lattice models in statistical physics and material science , appeared , and have been reviewed in @xcite .",
    "the main line of activity has dealt with homogeneous , translation  invariant lattice models with classical , discrete degrees of freedom , but several other directions have been followed , including for instance models with continuous degrees of freedom @xcite , free surfaces @xcite , models of polymers @xcite and quantum models @xcite . out of equilibrium properties",
    "have also been studied , in the framework of the path probability method @xcite , which is the dynamical version of the cvm . despite the cvm",
    "predicts mean  field like critical behaviour , the problem of extracting critical behaviour from sequences of cvm approximations has also been considered by means of different approaches @xcite .",
    "a line of research which is particularly relevant to the present discussion has considered heterogeneous and random models .",
    "much work has been devoted in the 80 s to applications of the cvm to models with quenched random interactions ( see e.g.  @xcite and refs.therein ) , mainly aiming to the phase diagram , and related equilibrium properties , of ising  like models of spin glasses in the average case .",
    "the most common approach was based on the distribution of the effective fields , and population dynamics algorithms were developed and studied for the corresponding integral equations .",
    "all this effort was however limited at the replica ",
    "symmetric level .",
    "approaches taking into account the first step of replica symmetry breaking have been developed only recently @xcite , at the level of the bethe ",
    "peierls approximation , in its cavity method formulation , for models on random graphs in both the single instance and average case .",
    "these approaches have been particularly successful in their application to combinatorial optimization problems , like satisfiability @xcite and graph coloring @xcite .",
    "another interesting approach going in a similar direction has been proposed recently @xcite , which relies on the analysis of the time evolution of message  passing algorithms for the bethe ",
    "peierls approximation .    prompted by the interest in optimization and ,",
    "more generally , inference problems , a lot of work on the cvm has been done in recent years also by researchers working on probabilistic graphical models @xcite , since the relation between the bethe ",
    "peierls approximation and the belief propagation method @xcite was recognized @xcite .",
    "the interaction between the two communities of researchers working on statistical physics and optimization and inference algorithms then led to the discovery of several new algorithms for the cvm variational problem , and to a deeper understanding of the method itself .",
    "there have been applications in the fields of image restoration @xcite , computer vision @xcite , interference in two  dimensional channels @xcite , decoding of error  correcting codes @xcite , diagnosis @xcite , unwrapping of phase images @xcite , bioinformatics @xcite , language processing @xcite .    the purpose of the present paper is to give a short account of recent advances on methodological aspects , and therefore applications will not be considered in detail .",
    "it is not meant to be exhaustive and the material included reflects in some way the interests of the author .",
    "the plan of the paper is as follows . in the basic definitions for statistical mechanics and probabilistic graphical models",
    "are given , and notation is established . in the cvm",
    "is introduced in its modern formulation , and in it is compared with related approximation techniques .",
    "its properties are then discussed , with particular emphasis on exact results , in .",
    "finally , the use of the cvm as an approximation and the algorithms which can be used to solve the cvm variational problem are illustrated in .",
    "conclusions are drawn in .",
    "we are interested in dealing with models with discrete degrees of freedom which will be denoted by @xmath0 .",
    "for instance , variables @xmath1 could take values in the set @xmath2 ( binary variables ) , @xmath3 ( ising spins ) , or @xmath4 ( potts variables ) .",
    "statistical mechanical models are defined through an energy function , usually called hamiltonian , @xmath5 , and the corresponding probability distribution at thermal equilibrium is the boltzmann distribution @xmath6,\\ ] ] where the inverse temperature @xmath7 has been absorbed into the hamiltonian and @xmath8\\ ] ] is the partition function , with @xmath9 the free energy .",
    "the hamiltonian is typically a sum of terms , each involving a small number of variables .",
    "a useful representation is given by the _ factor graph _ @xcite .",
    "a factor graph is a bipartite graph made of variable nodes @xmath10 , one for each variable , and _",
    "function nodes _ @xmath11 , one for each term of the hamiltonian .",
    "an edge joins a variable node @xmath12 and a function node @xmath13 if and only if @xmath14 , that is the variable @xmath1 appears in @xmath15 , the term of the hamiltonian associated to @xmath13 .",
    "the hamiltonian can then be written as @xmath16 a simple example of a factor graph is reported in , and the corresponding hamiltonian is written as @xmath17    ( -3,-1)(10,3 )    the factor graph representation is particularly useful for models with non  pairwise interactions .",
    "if the hamiltonian contains only 1variable and 2variable terms , as in the ising model @xmath18 then it is customary to draw a simpler graph , where only variable nodes appear , and edges are drawn between pairs of interacting spins @xmath19 . in physical models the interaction strength @xmath20 can depend on the distance between spins , and interaction is often restricted to nearest neighbours ( nns ) , which are denoted by @xmath21 .    in combinatorial optimization problems",
    ", the hamiltonian plays the role of a cost function , and one is interested in the low  temperature limit @xmath22 , where only minimal energy states ( ground states ) have a non  vanishing probability .",
    "probabilistic graphical models @xcite are usually defined in a slightly different way . in the case of",
    "_ markov random fields _ , also called _ markov networks _ , the joint distribution over all variables is given by @xmath23 where @xmath24 is called _ potential _",
    "( potentials involving only one variable are often called _ evidences _ ) and @xmath25 of course , a statistical mechanical model described by the hamiltonian ( [ hsumha ] ) corresponds to a probabilistic graphical models with potentials @xmath26 . on the other hand , _ bayesian networks _",
    ", which we will not consider here in detail , are defined in terms of directed graphs and conditional probabilities .",
    "it must be noted , however , that a bayesian network can always be mapped onto a markov network @xcite .",
    "the original proposal by kikuchi @xcite was based on an approximation for the number of configurations of a lattice model with assigned local expectation values .",
    "the formalism was rather involved to deal with in the general case , and since then many reformulations came .",
    "a first important step was taken by barker @xcite , who derived a computationally useful expression for the entropy approximation .",
    "this was then rewritten as a cumulant expansion by morita @xcite , and schlijper @xcite noticed that this expansion could have been written in terms of a mbius inversion .",
    "a clear and simple formulation was then eventually set up by an @xcite , and this is the one we shall follow below .    the cvm can be derived from the variational principle of equilibrium statistical mechanics , where the free energy is given by @xmath27 \\label{varprin}\\ ] ] subject to the normalization constraint @xmath28 it is easily verified that the minimum is obtained for the boltzmann distribution @xmath29 = { \\rm arg } \\,{\\rm min } \\ , { \\cal f}\\ ] ] and that the variational free energy can be written in the form of a kullback ",
    "leibler distance @xmath30    the basic idea underlying the cvm is to treat exactly the first term ( energy ) of the variational free energy @xmath31 in and to approximate the second one ( entropy ) by means of a truncated cumulant expansion .",
    "we first define a _ cluster _ @xmath32 as a subset of the factor graph such that if a factor node belongs to @xmath32 , then all the variable nodes @xmath14 also belong to @xmath32 ( while the converse needs not to be true , otherwise the only legitimate clusters would be the connected components of the factor graph ) .",
    "given a cluster we can define its energy @xmath33 probability distribution @xmath34 and entropy @xmath35    then the entropy cumulants are defined by @xmath36 which can be solved with respect to the cumulants by means of a mbius inversion , which yields @xmath37 where @xmath38 denotes the number of variables in cluster @xmath32 .",
    "the variational free energy can then be written as @xmath39 where the second summation is over all possible clusters .",
    "the above equation is still an exact one , and here the approximation enters .",
    "a set @xmath40 of clusters , made of maximal clusters and all their subclusters , is selected , and the cumulant expansion of the entropy is truncated retaining only terms corresponding to clusters in @xmath40 . in order to treat the energy term exactly it is necessary that each function node is contained in at least one maximal cluster .",
    "one gets @xmath41 where the coefficients @xmath42 , sometimes called mbius numbers , satisfy @xcite @xmath43 the above condition means that every subcluster must be counted exactly once in the entropy expansion and allows to rewrite also the energy term as a sum of cluster energies , yielding the approximate variational free energy @xmath44 where the cluster free energies are given by @xmath45 .",
    "\\label{clusterfree}\\ ] ] the cvm then amounts to the minimization of the above variational free energy with respect to the cluster probability distributions , subject to the normalization @xmath46 and compatibility constraints @xmath47 it is of great importance to observe that the above constraint set is approximate , in the sense that there are sets of cluster probability distributions that satisfy these constraints and nevertheless can not be obtained as marginals of a joint probability distribution .",
    "an explicit example will be given in .",
    "the simplest example is the pair approximation for a model with pairwise interactions , like the ising model ( [ ising ] ) .",
    "the maximal clusters are the pairs of interacting variables , and the other clusters appearing in @xmath40 are the variable nodes .",
    "the pairs have mbius number 1 , while for the variable nodes @xmath48 , where @xmath49 is the _ degree _ of node @xmath12 , that is , in the factor graph representation , the number of function nodes it belongs to .",
    "the quality of the approximation ( [ cvmapprox ] ) depends on the value of the neglected cumulants . in the applications to lattice systems it is typically assumed that",
    ", since cumulants are related to correlations , they vanish quickly for clusters larger than the correlation length of the model . in the first cumulants ,",
    "relative to the site ( single variable ) entropy , are shown for the homogeneous ( @xmath50 ) , zero field ( @xmath51 ) , square lattice ising model , in the square approximation of the cvm .",
    "cumulants for the square lattice ising model ]    it can be seen that the cumulants peak at the ( approximate ) critical point and decrease as the cluster size increases .",
    "this property is not however completely general , it may depend on the interaction range .",
    "it has been shown @xcite that this does not hold for finite instances of the sherrington  kirkpatrick spin  glass model , which is a fully connected model .",
    "the meaning of cumulants as a measure of correlation can be easily understood by considering a pair of weakly correlated variables and writing their joint distribution as @xmath52 , \\qquad \\varepsilon \\ll 1.\\ ] ] the corresponding cumulant is then @xmath53 \\rangle = \\or(\\varepsilon).\\ ] ]",
    "the idea of _ region  based free energy approximations _ , put forward by yedidia @xcite , is quite useful to elucidate some of the characteristics of the method , and its relations to other techniques .",
    "a region  based free energy approximation is formally similar to the cvm , and can be defined through equations ( [ cvmfree ] ) and ( [ clusterfree ] ) , but the requirements on the coefficients @xmath42 are weaker . the single counting condition is imposed only on variable and function nodes , instead of all subclusters : @xmath54    interesting particular cases are obtained if @xmath40 contains only two types of regions , _ large regions _ and _ small regions_. the _ junction graph _ method @xcite is obtained if they form a directed graph , with edges from large to small regions , such that :    1 .",
    "every edge connects a large region with a small region which is a subset of the former ; 2 .",
    "the subgraph of the regions containing a given node is a connected tree .    on the other hand ,",
    "the _ bethe  peierls approximation _ , in its most general formulation , is obtained by taking function nodes ( with the associated variable nodes ) as large regions and variable nodes as small regions .",
    "this reduces to the usual statistical physics formulation in the case of pairwise interactions .",
    "the cvm is a special region  based free energy approximation , with the property that @xmath40 is closed under intersection .",
    "indeed , one could define @xmath40 for the cvm as the set made of the maximal clusters and all the clusters which can be obtained by taking all the possible intersections of ( any number of ) maximal clusters .",
    "it is easy to verify that the bethe ",
    "peierls approximation is a special case of cvm only if no function node shares more than one variable node with another function node .",
    "if this is not the case , one should be careful when applying the bethe  peierls approximation .",
    "consider a model with the factor graph depicted in , where @xmath55 ( @xmath56 ) , @xmath57 and @xmath58    ( -1,-2)(7,2 )    the cvm , with function nodes as maximal clusters , is exact ( notice that it coincides with the junction graph method ) , and the corresponding exact cumulant expansion for the entropy is @xmath59 while the bethe  peierls entropy is @xmath60 the two entropies differ by the cumulant @xmath61 , and hence correlations between variable nodes 2 and 3 can not be captured by the bethe  peierls approximation . in it",
    "is clearly illustrated how the bethe ",
    "peierls approximation can fail .",
    "at large enough @xmath62 the exact entropy is larger ( by roughly @xmath63 ) than the bethe ",
    "peierls one .",
    "entropy of the bethe ",
    "peierls approximation vs the exact one for a model for which the bethe ",
    "peierls approximation is not a special case of the cvm ]",
    "the cvm is known to be exact in several cases , due to the topology of the underlying graph , or to the special form of the hamiltonian . in the present section",
    "we shall first consider cases in which the cvm is exact due to the graph topology , then proceed to the issue of realizability and consider cases where the form of the hamiltonian makes an exact solution feasible with the cvm .",
    "it is well known that the cvm is exact for models defined on tree  like graphs .",
    "this statement can be made more precise by referring to the concept of _ junction tree _",
    "@xcite , which we shall actually use in its generalized form given by yedidia , freeman and weiss @xcite .",
    "a junction tree is a tree  like junction graph .",
    "the corresponding large regions are often called _ cliques _ , and the small regions _",
    "separators_. with reference to it is easy to check that the cvm , as described in the previous section , corresponds to a junction tree with cliques @xmath64 and @xmath65 and separator @xmath66 , while the junction graph corresponding to the bethe  peierls approximation is not a tree .    for a model defined on a junction tree the joint probability distribution factors @xcite according to @xmath67 where @xmath68 and @xmath69 denote the sets of large and small regions , respectively , and",
    "@xmath70 is the degree of the small region @xmath71 in the junction tree .",
    "notice that no normalization is needed .",
    "the above factorization of the probability leads to the exact cumulant expansion @xmath72 and therefore the cvm with @xmath73 is exact .    as a first example , consider a particular subset of the square lattice , the strip depicted in , with open boundary conditions in the horizontal direction , and define on it a model with pairwise interactions ( we do not use the factor graph representation here ) .    according to the junction tree property , the joint probability factors as follows : @xmath74 where i and ii denote the sets of chains ( except boundary ones ) and ladders , respectively , shown in . as a consequence , the cumulant expansion @xmath75 of the entropy is also exact , and the cluster variation method with @xmath76 is exact . for strip width @xmath77",
    "we obtain the well  known statement that the bethe ",
    "peierls approximation is exact for a one  dimensional chain .",
    "rigorous proofs of this statement have been given by brascamp @xcite and percus @xcite .",
    "more generally , schlijper has shown @xcite that the equilibrium probability of a @xmath78dimensional statistical mechanical model with finite range interactions is completely determined by its restrictions ( marginals ) to @xmath79dimensional slices of width at least equal to the interaction range .    in the infinite length limit",
    "@xmath80 translational invariance is recovered @xmath81 - \\sum_{\\bi{s } } p_{\\rm i}(\\bi{s } ) \\ln p_{\\rm i}(\\bi{s})\\ ] ] and solving for @xmath82 we obtain the transfer matrix formalism : @xmath83 p_{\\rm i}^{1/2}(\\bi{s^\\prime } ) \\right\\ } \\\\",
    "\\sum_{\\bi{s } } p_{\\rm i}(\\bi{s } ) = 1\\end{aligned}\\ ] ]    the natural iteration method ( see ) in this case reduces to the power method for finding the largest eigenvalue of the transfer matrix .    as a second example , consider a tree , like the one depicted in , and a model with pairwise interactions defined on it .",
    "in this case the probability factors according to @xmath84 where @xmath85 denotes a pair of adjacent nodes .",
    "the cumulant expansion of the entropy is therefore @xmath86 and the pair approximation of the cvm ( coinciding with bethe  peierls and junction graph ) is exact .",
    "recently this property has been exploited to study models on finite connectivity random graphs , which strictly speaking are not tree  like : loops are present , but in the thermodynamic limit their typical length scales like @xmath87 @xcite .    as a final example , consider the so  called ( square ) cactus lattice ( the interior of a husimi tree ) , depicted in .    here",
    "the probability factors according to @xmath88 the entropy cumulant expansion takes the form @xmath89 and the cvm with @xmath40 made of square plaquettes and sites is exact . again , this coincides with the junction graph method and , if function nodes are associated to square plaquettes ( so that the corresponding factor graph is tree  like ) , with bethe  peierls .",
    "we have seen that when the probability factors in a suitable way , the cvm can be used to find an exact solution . by analogy , we could ask whether , as in the mean field approximation , cvm approximations can yield an estimate of the joint probability distribution as a function of the cluster distributions , in a factorized form . in the general case ,",
    "the answer is negative .",
    "one can not , using a trial factorized form like @xmath90^{a_\\alpha } \\label{cvmproduct}\\ ] ] ( which would lead to a free energy like that in eqs.[cvmfree]-[clusterfree ] ) , obtain a joint probability distribution which marginalizes down to the cluster probability distributions used as a starting point . as a consequence",
    ", we have no guarantee that the cvm free energy is an upper bound to the exact free energy .",
    "moreover , in sufficiently frustrated problems , the cluster probability distributions can not even be regarded as marginals of a joint probability distribution @xcite .",
    "it can be easily checked that is not , in the general case , a probability distribution .",
    "it is not normalized and therefore its marginals do not coincide with the @xmath91 s used to build it . at best , one can show that @xmath90^{a_\\alpha } \\propto \\exp[-h(\\bi{s } ) ] , \\label{factorprop}\\ ] ] but the normalization constant is unknown .",
    "this has been proven in @xcite at the bethe ",
    "peierls level , and the proof can be easily generalized to any cvm approximation .",
    "let us now focus on a very simple example .",
    "consider three ising variables , @xmath55 , @xmath92 , with the following node and pair probabilities : @xmath93 a joint @xmath94 marginalizing to the above probabilities exists for @xmath95 , which shows clearly that the constraint set is approximate , and in particular it can be too loose .",
    "for instance , in @xcite it has been shown that due to this problem the bethe ",
    "peierls approximation for the triangular ising antiferromagnet predicts , at low temperature , unphysical results for the correlations and a negative entropy .",
    "moreover , the joint probability @xmath94 is given by the cvm  like factorized form @xmath96 only if @xmath97 , that is if the variables are completely uncorrelated .    as a more interesting case , we shall consider in the next subsection the square lattice ising model . in this case",
    "it has been shown @xcite that requiring realizability yields an exactly solvable case .      for a homogeneous ( translation ",
    "invariant ) model defined on a square lattice , the square approximation of the cvm , that is the approximation obtained by taking the elementary square plaquettes as maximal clusters , entails the following approximate entropy expansion : @xmath98 the corresponding factorization @xmath99 for the probability does not , in general , give an approximation to the exact equilibrium distribution .",
    "indeed , it does not marginalize to the cluster distributions and is not even normalized .",
    "one could , however , try to impose that the joint probability given by the above factorization marginalizes to the cluster distributions .",
    "it turns out that it is sufficient to impose such a condition on the probability distribution of a @xmath100 square , like the one depicted in .",
    "it is easy to check that for an ising model the cvm  like function @xmath101 marginalizes to the square , pair and site distributions ( @xmath102 , @xmath103 and @xmath104 respectively ) only if odd expectation values vanish and @xmath105 where the l.h.s .",
    "is the next nearest neighbour correlation , while the r.h.s .  is the square of the nearest neighbour correlation .",
    "leaving apart the trivial non  interacting case , the above condition is satisfied by an ising model with nearest neighbour , next nearest neighbour and plaquette interactions , described by the hamiltonian @xmath106 if the couplings satisfy the _ disorder _",
    "condition ( see @xcite and refs .  therein ) @xmath107 this defines a variety in the parameter space , lying in the disordered phase of the model , and in particular in the region where nearest neighbour and next nearest neighbour interactions compete . in this case",
    "the square approximation of the cvm yields the exact solution , including the exact free energy density @xmath108,\\ ] ] and the nearest neighbour correlation @xmath109 higher order correlations can be derived from the joint probability , for example the two  body correlation function @xmath110 ( where spin variables have been identified by their coordinates on the lattice ) , which simply reduces to a power of the nearest neighbour correlation : @xmath111 . for this reason a line of disorder points is often referred to as a one  dimensional line . or the plaquette correlation : @xmath112 finally , since all the pair correlations are given simply as powers of the nearest ",
    "neighbour correlation we can easily calculate the momentum space correlation function , or structure factor . we first write @xmath113 , where @xmath114 . after a fourier",
    "transform one finds @xmath115 , where @xmath116 it can be verified that the structure factors calculated by sanchez @xcite and ( except for a misprint ) cirillo and coworkers @xcite reduce to the above expression on the disorder line .",
    "there is at least another case in which the probability factors at the level of square plaquettes , and the cvm yields the exact solution .",
    "it is the wako ",
    "sait  muoz ",
    "eaton model of protein folding @xcite . here",
    "we will not delve into the details of the model , giving only its hamiltonian in the form @xmath117 it is a one  dimensional model with arbitrary range multivariable interactions , but the particular form of these interactions makes an exact solution possible .",
    "a crucial step in this solution was the mapping to a two  dimensional model @xcite , where the statistical variables are the @xmath118 s ( see for an illustration ) .",
    "in terms of these variables the hamiltonian is local , and the only price one has to pay is to take into account the constraints @xmath119 which can be viewed as local interactions .    (",
    "-2,-11)(11,2 ) ( -1,-.5)(11,-.5 ) ( .5,-11)(.5,1 ) ( 1,0)1 ( 2,0)2 ( 3,0)3 ( 4,0)4 ( 5,0)5 ( 6,0)6 ( 7,0)7 ( 8,0)8 ( 9,0)9 ( 10,0)10 ( 5.5,.5)@xmath120 ( 0,-10)10 ( 0,-9)9 ( 0,-8)8 ( 0,-7)7 ( 0,-6)6 ( 0,-5)5 ( 0,-4)4 ( 0,-3)3 ( 0,-2)2 ( 0,-1)1 ( -.5,-5.5)@xmath12 ( 1,-1)@xmath121 ( 2,-1)@xmath121 ( 3,-1)@xmath121 ( 4,-1)@xmath121 ( 5,-1)@xmath121 ( 6,-1)@xmath121 ( 7,-1)@xmath121 ( 8,-1)@xmath121 ( 9,-1)@xmath121 ( 10,-1)@xmath121 ( 2,-2)@xmath122 ( 3,-2)@xmath122 ( 4,-2)@xmath122 ( 5,-2)@xmath122 ( 6,-2)@xmath121 ( 7,-2)@xmath121 ( 8,-2)@xmath121 ( 9,-2)@xmath121 ( 10,-2)@xmath121 ( 3,-3)@xmath122 ( 4,-3)@xmath122 ( 5,-3)@xmath122 ( 6,-3)@xmath121 ( 7,-3)@xmath121 ( 8,-3)@xmath121 ( 9,-3)@xmath121 ( 10,-3)@xmath121 ( 4,-4)@xmath122 ( 5,-4)@xmath122 ( 6,-4)@xmath121 ( 7,-4)@xmath121 ( 8,-4)@xmath121 ( 9,-4)@xmath121 ( 10,-4)@xmath121 ( 5,-5)@xmath122 ( 6,-5)@xmath121 ( 7,-5)@xmath121 ( 8,-5)@xmath121 ( 9,-5)@xmath121 ( 10,-5)@xmath121 ( 6,-6)@xmath121 ( 7,-6)@xmath121 ( 8,-6)@xmath121 ( 9,-6)@xmath121 ( 10,-6)@xmath121 ( 7,-7)@xmath121 ( 8,-7)@xmath121 ( 9,-7)@xmath121 ( 10,-7)@xmath121 ( 8,-8)@xmath122 ( 9,-8)@xmath122 ( 10,-8)@xmath122 ( 9,-9)@xmath122 ( 10,-9)@xmath122 ( 10,-10)@xmath122    in order to derive the factorization of the probability @xcite , we need first to exploit the locality of interactions , which allows us to write @xmath123 where @xmath124 denotes the probability of the @xmath120th row in and @xmath125 denotes the joint probability of rows @xmath120 and @xmath126 .    as a second step ,",
    "consider the effect of the constraints .",
    "this is best understood looking at the following example : @xmath127 the cvm  like factorization is possible since every factor in the numerator , except @xmath128 , cancels with a factor in the denominator .",
    "a similar result can be obtained for the joint probability of two adjacent rows , and substituting into one eventually gets @xmath129 where @xmath130square plaquettes , corners ( on the diagonal ) , and their subclusters@xmath131 and @xmath42 is the cvm mbius number for cluster @xmath32 .",
    "in most applications the cvm does not yield exact results , and hence it is worth investigating its properties as an approximation .",
    "an important issue is the choice of maximal clusters , and in particular the existence of sequence of approximations ( that is , sequence of choices of maximal clusters ) with some property of convergence to the exact results .",
    "this has been long studied in the literature regarding applications to lattice , translation invariant , systems and will be the subject of subsection [ asymptotic ] .",
    "in particular , rigorous results concerning sequences of approximations which converge to the exact solution have been derived by schlijper @xcite , providing a sound theoretical basis for the earlier investigations by kikuchi and brush @xcite .",
    "another important issue is related to the practical determination of the minima of the cvm variational free energy . in the variational formulation of statistical mechanics",
    "the free energy is convex , but this property here is lost due to the presence of negative @xmath42 coefficients in the entropy expansion .",
    "more precisely , it has been shown @xcite that the cvm variational free energy is convex if @xmath132 similar conditions have been obtained by mceliece and yildirim @xcite and heskes , albers and kappen @xcite .",
    "if this is not the case multiple minima can appear , and their determination can be nontrivial .",
    "several algorithms have been developed to deal with this problem , falling mainly in two classes : message  passing algorithms , which will be discussed in subsection [ messpassalg ] and variational , provably convergent algorithms , which will be discussed in subsection [ varalg ] .",
    "the first studies on the asymptotic behaviour of sequences of cvm approximations are due to schlijper @xcite .",
    "he showed that it is possible to build sequences of cvm approximations ( that is , sequences of sets of maximal clusters ) such that the corresponding sequence of free energies converge to the exact one , for a translation  invariant model in the thermodynamic limit .",
    "the most interesting result , related to the transfer matrix idea , is that for a @xmath78dimensional model the maximal clusters considered have to increase in @xmath79 dimensions only .",
    "these results provided a theoretical justification for the series of approximations developed by kikuchi and brush @xcite , who introduced the @xmath133 series of approximations for translation  invariant models on the two  dimensional square lattice , based on zig  zag maximal clusters , as shown in , and applied it to the zero field ising model . based solely on the results from the @xmath134 ( which is equivalent to the plaquette approximation ) and @xmath135 approximations , kikuchi and brush postulated a linear behaviour for the estimate of the critical temperature as a function of @xmath136 .",
    "in we have reported the inverse critical temperature as a function of @xmath136 for @xmath137 to 6 .",
    "the extrapolated inverse critical temperature is @xmath138 , to be compared with the exactly known @xmath139 .",
    "inverse critical temperature of the @xmath133 approximation series ]    it is not our purpose here to make a complete finite size scaling analysis , in the spirit of the coherent anomaly method ( see below ) , of the cvm approximation series .",
    "we limit ourselves to show the finite size behaviour of the critical magnetization .",
    "more precisely , we have computed the magnetization of the zero field ising model on the square lattice at the exactly known inverse critical temperature , again for @xmath137 to 6 .",
    "shows that the critical magnetization vanishes as @xmath140 , and the fit gives a very good estimate for the exponent , consistent with the exact result @xmath141 .    as a further illustration of the asymptotic properties of the @xmath133 series we report in the zero temperature entropy ( actually the difference between the extrapolated entropy density and the @xmath133 estimate ) of the ising triangular antiferromagnet as a function of @xmath142 @xcite .",
    "it is clearly seen that asymptotically @xmath143 , and the fit yields the numerical results @xmath144 ( the exact value being @xmath145 ) and @xmath146 ( remarkably close to @xmath147 ) .",
    "zero temeperature entropy of the triangular ising antiferromagnet in the @xmath133 approximation series ]    an attempt to extract non  classical critical behaviour from high precision low and high temperature results from cvm was made by the present author @xcite , using pad and adler approximants .",
    "this work has led to the development of an 18 ( @xmath148 ) site cluster approximation for the simple cubic lattice ising model @xcite , which is probably the largest cluster ever considered .",
    "the results obtained for the ising model are still compatible with the most recent estimates @xcite , although of lower precision .",
    "it has also been considered the possibility of extracting non  classical critical behaviour from cvm results by means of the coherent anomaly method , which applies finite size scaling ideas to series of mean  field  like approximations .",
    "a review of these results can be found in @xcite .      in order to describe this class of algorithms it is useful to start with the bethe ",
    "peierls approximation ( pair approximation of the cvm ) free energy for the ising model : @xmath149 .",
    "\\label{betheising}\\end{aligned}\\ ] ] one can easily recognize the energy terms , the pair entropy , the site entropy ( with a mbius number @xmath150 , where @xmath49 is the degree of node @xmath12 ) , and the lagrange terms corresponding to the normalization and pair  site compatibility constraints . observe that , due the presence of normalization constraints , it is enough to impose the consistency between the spin expectation values given by the site and pair probabilities .",
    "a physical way of deriving message  passing algorithms for the determination of the stationary points of the above free energy is through the introduction of the effective field representation .",
    "consider the interaction @xmath151 and assume that , whenever this is not taken into account exactly , its effect on variable @xmath1 can be replaced by an effective field @xmath152 .",
    "this can be made rigorous by observing that the stationarity conditions @xmath153 can be solved by writing the probabilities as @xmath154 \\\\",
    "\\fl p_{ij}(s_i , s_j ) & = & \\exp\\left [ f_{ij } + \\left ( h_i + \\sum_{k \\ , { \\rm nn } \\ , i}^{k \\ne j } h_{i , k } \\right ) s_i    + \\left ( h_j + \\sum_{k \\ , { \\rm nn } \\ , j}^{k \\ne i } h_{j , k } \\right ) s_j + j_{ij } s_i s_j \\right ] ,   \\label{p - vs - heff}\\end{aligned}\\ ] ] where the effective fields , and the site and pair free energies @xmath155 and @xmath156 , are related to the lagrange multipliers through @xmath157 @xmath155 and @xmath156 are determined by the normalization , but first of all the effective fields must be computed by imposing the corresponding compatibility constraints , which can be cast into the form @xmath158 .",
    "\\label{heff - iter}\\ ] ]    this is a set of coupled nonlinear equations which is often solved by iteration , that is an initial guess is made for the @xmath159 s , plugged into the r.h.s .",
    "of which returns a new estimate , and the procedure is then repeated until a fixed point is ( hopefully ) reached .",
    "the values of the effective fields at the fixed point can then be used to compute the probabilities according to .",
    "the above equations , and their generalizations at the cvm level , have been intensively used in the 80 s for studying the average behaviour of models with quenched random interactions , like ising spin glass models .",
    "this work was started by a paper by morita @xcite , where an integral equation for the probability distribution of the effective field , given the probability distributions of the interactions and fields , was derived . in the general case",
    "this integral equation takes the form @xmath160 \\right ) \\times \\nonumber \\\\",
    "\\lo \\times p_j(h_j ) dh_j p_{ij}(j_{ij } ) dj_{ij } \\prod_{k \\ , { \\rm nn } \\ , j}^{k \\ne i } p_{j , k } ( h_{j , k } ) dh_{j , k } , \\label{integralequation}\\end{aligned}\\ ] ] with simplifications occurring if the probability distributions can be assumed to be site ",
    "independent , which is the most studied case .",
    "typical calculations concerned : the determination of elements of the phase diagrams of ising spin glass models , through the calculation of the instability loci of the paramagnetic solution ; results in the zero temperature limit , where solutions with a discrete support are found ; iterative numerical solutions of the integral equation . a review of this line of research until 1986 can be found in @xcite .",
    "it is important to notice that the results obtained by this approach are equivalent to those by the replica method , at the replica symmetric level .",
    "the effective field approach is reminiscent of the message  passing procedure at the heart of the belief propagation ( bp ) algorithm , and indeed the messages appearing in this algorithm are related , in the ising case , to the effective fields by @xmath161 , where @xmath162 denotes a message going from the nn pair @xmath85 to node @xmath12 .    in order to derive the bp algorithm",
    "consider the bethe ",
    "peierls approximation for a model with variable nodes @xmath12 and factor nodes @xmath13 .",
    "the variables @xmath1 need not be limited to two states and the hamiltonian is written in the general form . the cvm free energy , with the normalization and compatibility constraints , can then be written as @xmath163 where @xmath164 denotes the set of variables entering factor node @xmath13 , except @xmath12 .",
    "the stationarity conditions @xmath165 can then be solved , in analogy with , by @xmath166 in the particular case of an ising model with pairwise interactions , the previously mentioned relationship between messages and effective fields is evident from the above equation .",
    "now @xmath167 and @xmath168 take care of normalization , and the messages @xmath169 are related to the lagrange multipliers by @xmath170    notice that the messages can be regarded as exponentials of a new set of lagrange multipliers , with the constraints rewritten as in the following free energy @xmath171    again , imposing compatibility between variable nodes and factor nodes , one gets a set of coupled equations for the messages which , leaving apart normalization , read @xmath172    the above equations , and their iterative solution , are the core of the bp algorithm . also , their structure justifies the name `` sum - product '' @xcite , which is often given them in the literature on probabilistic graphical models , and the corresponding term `` max - product '' for their zero temperature limit .",
    "there are several issues which must be considered when discussing the property of an iterative algorithm based on .",
    "first of all , one could ask whether messages have to be updated sequentially or in parallel .",
    "this degree of freedom does not affect the fixed points of the algorithm , but it affects the dynamics .",
    "this issue has been considered in some depth by kfir and kanter @xcite in the context of the decoding of error  correcting codes . in that case",
    "they showed that the sequential update results in twice faster convergence with respect to the parallel update .",
    "convergence is however not guaranteed if the underlying graph is not tree  like , that is if the pair approximation of the cvm is not exact .",
    "this issue has been investigated theoretically by tatikonda and jordan @xcite , mooij and kappen @xcite , ihler et al @xcite , who derived sufficient conditions for convergence , and by heskes @xcite , who derived sufficient conditions for the uniqueness of the fixed point . in practice",
    "it is typically observed that the bp algorithm converges if the frustration due to competitive interactions , like those characteristic of spin  glass or constraint satisfaction models , is not too large . in some cases ,",
    "the trick of damping , or inertia , can help extending the convergence domain .",
    "the trick consists in taking the updated message equal to a weighted ( possibly geometrical ) average of the old message and the new one given by .",
    "the convergence domain of the bp algorithm has been determined for several problems , like satisfiability @xcite , graph colouring @xcite , error correcting codes @xcite and spin glasses @xcite . within its convergence domain , the bp algorithm is indeed very fast , and this is its real strength .",
    "see the next subsection for some performance tests and a comparison with provably convergent algorithms .",
    "once a fixed point has been obtained it is worth asking whether this corresponds to a minimum of the free energy or not .",
    "this has been partially solved by heskes @xcite , who has shown that stable fixed points of the belief propagation algorithm are minima of the cvm pair approximation free energy , but the converse is not necessarily true .",
    "actually , examples can be found of minima of the free energy which correspond to unstable fixed points of the belief propagation algorithm .",
    "an important advancement in this topic is the _ generalized belief propagation _ ( gbp ) algorithm by yedidia and coworkers @xcite .",
    "the fixed points of the gbp algorithm for a certain choice of clusters correspond to stationary points of the cvm free energy at the approximation level corresponding by the same choice of clusters or , more generally , of a region graph free energy .",
    "actually , for a given choice of clusters , different gbp algorithms can be devised . here only the so  called _ parent to child",
    "_ gbp algorithm @xcite will be considered .",
    "other choices are described in @xcite .    in order to better understand this algorithm ,",
    "notice a few characteristics of the belief propagation algorithm .",
    "first of all , looking at the probabilities one can say that a variable node receives messages from all the factor nodes it belongs to , while a factor node @xmath13 receives messages from all the other factor nodes to which its variable nodes @xmath14 belong .",
    "in addition , the constraint corresponding to the message @xmath173 ( see ) can be written as @xmath174    the parent to child gbp algorithm generalizes these characteristics in a rather straightforward way .",
    "first of all , messages @xmath175 ( @xmath176 ) are introduced from regions ( parent regions ) to subregions ( child regions ) .",
    "then , the probability of a region takes into account messages coming from outer regions to itself and its subregions .",
    "finally , exploiting the property of the mbius numbers , the constraint corresponding to @xmath177 is written in the form @xmath178 it can be shown @xcite that this new set of constraints is equivalent to the original one .    to make this more rigorous ,",
    "consider the free energy given by equations ( [ cvmfree ] ) and ( [ clusterfree ] ) , with the above compatibility constraints ( with lagrange multipliers @xmath179 ) and the usual normalization constraints ( with multipliers @xmath180 ) . one obtains @xmath181 + \\sum_{\\gamma \\in r } \\lambda_\\gamma    \\left [ \\sum_{\\bi{s_\\gamma } } p_\\gamma(\\bi{s_\\gamma } ) - 1 \\right ] +    \\nonumber \\\\   \\fl + \\sum_{\\beta \\subset \\alpha \\in r } \\sum_{\\bi{s_\\beta } }   \\ln m_{\\alpha \\to \\beta}(\\bi{s_\\beta } ) \\left [ \\sum_{\\alpha \\subseteq \\gamma \\in r } a_\\gamma \\sum_{\\bi{s_{\\gamma \\setminus \\beta } } } p_\\gamma(\\bi{s_\\gamma } ) - \\sum_{\\beta \\subseteq \\gamma \\in r } a_\\gamma \\sum_{\\bi{s_{\\gamma \\setminus \\beta } } }    p_\\gamma(\\bi{s_\\gamma } ) \\right],\\end{aligned}\\ ] ] where it is not necessary to put all the possible @xmath182 compatibility constraints , but it is enough to put those which satisfy @xmath183 , @xmath184 and @xmath71 is a direct subregion of @xmath32 , that is there is no region @xmath185 with @xmath186 such that @xmath187 .",
    "notice also that the lagrange term corresponding to the @xmath182 constraint can be written as @xmath188    the stationarity conditions @xmath189 can then be solved , leaving apart normalization , by @xmath190 \\prod_{\\beta \\subseteq \\gamma } \\prod_{\\beta \\subset \\alpha",
    "\\in r}^{\\alpha \\nsubseteq \\gamma } m_{\\alpha \\to    \\beta}(\\bi{s_\\beta } ) , \\label{gbp - p - vs - mess}\\ ] ] where @xmath191 denotes the restriction of @xmath192 to subregion @xmath71 .",
    "finally , message update rules can be derived again by the compatibility constraints , though some care is needed , since in the general case these constraints are not immediately solved with respect to the ( updated ) messages , as it occurs in the derivation of .",
    "here one obtains a coupled set of equations in the updated messages , which can be solved starting from the constraints involving the smallest clusters .",
    "an example can be helpful here .",
    "consider a model defined on a regular square lattice , with periodic boundary conditions , and the cvm square approximation , that is the approximation obtained by taking the elementary square plaquettes as maximal clusters .",
    "the entropy expansion contains only terms for square plaquettes ( with mbius numbers 1 ) , nn pairs ( mbius numbers -1 ) and single nodes ( mbius numbers 1 ) , as in .",
    "a minimal set of compatibility constraints includes node  pair and pair  square constraints , and one has therefore to deal with square  to  pair and pair  to  node messages , which will be denoted by @xmath193 and @xmath194 respectively . with reference to the portion of the lattice depicted in the probabilities , according to , can be written as @xmath195 \\ , m_{i , a}(s_i ) \\ , m_{i , j}(s_i ) \\ ,",
    "m_{i , l}(s_i ) \\ , m_{i , h}(s_i ) , \\nonumber \\\\",
    "\\fl p_{ij}(s_i , s_j ) \\propto \\exp[-h_{ij}(s_i , s_j ) ] \\ , m_{i , a}(s_i ) \\ ,   m_{i , l}(s_i ) \\ , m_{i , h}(s_i ) \\times \\nonumber \\\\",
    "\\lo \\times m_{j , b}(s_j ) \\ , m_{j , c}(s_j ) \\ , m_{j , k}(s_j ) \\ ,",
    "m_{ij , ab}(s_i , s_j ) \\ , m_{ij , lk}(s_i , s_j ) , \\nonumber \\\\",
    "\\fl p_{ijkl}(s_i , s_j , s_k , s_l ) \\propto \\exp[-h_{ijkl}(s_i , s_j , s_k , s_l ) ] \\ , m_{i , a}(s_i ) \\ , m_{i , h}(s_i ) \\ , m_{j , b}(s_j ) \\ , m_{j , c}(s_j ) \\times \\nonumber \\\\",
    "\\lo \\times m_{k , d}(s_k ) \\ , m_{k , e}(s_k ) \\ , m_{l , f}(s_l ) \\ , m_{l , g}(s_l ) \\times \\nonumber \\\\",
    "\\lo \\times m_{ij , ab}(s_i , s_j ) \\ ,   m_{jk , cd}(s_j , s_k ) \\ , m_{kl , ef}(s_k , s_l ) \\ , m_{lj , gh}(s_l , s_j).\\end{aligned}\\ ] ]    imposing node  pair and pair  square constraints one gets equations like @xmath196 \\ , m_{i , j}(s_i )   \\propto \\sum_{s_j } \\exp[-h_{ij}(s_i , s_j ) ] \\times \\nonumber \\\\",
    "\\lo \\times m_{j , b}(s_j ) \\ , m_{j , c}(s_j ) \\ , m_{j , k}(s_j ) \\ ,",
    "m_{ij , ab}(s_i , s_j ) \\ , m_{ij , lk}(s_i , s_j ) , \\nonumber \\\\",
    "\\fl \\exp[-h_{ij}(s_i , s_j ) ] \\ , m_{i , f}(s_i ) \\ , m_{j , k}(s_j ) \\ ,",
    "m_{ij , lk}(s_i , s_j ) \\propto \\sum_{s_k , s_l } \\exp[-h_{ijkl}(s_i , s_j , s_k , s_l ) ]   \\times \\nonumber \\\\ \\lo \\times m_{k , d}(s_k ) \\ , m_{k , e}(s_k ) \\ , m_{l , f}(s_l ) \\ , m_{l , g}(s_l ) \\times \\nonumber \\\\",
    "\\lo \\times m_{jk , cd}(s_j , s_k ) \\ , m_{kl , ef}(s_k , s_l ) \\ ,",
    "m_{lj , gh}(s_l , s_j).\\end{aligned}\\ ] ] the above equations can be viewed as a set of equations in the updated messages at iteration @xmath197 , appearing in the l.h.s .",
    ", given the messages at iteration @xmath198 , appearing in the r.h.s .. it is clear that one has first to calculate the updated pair  to  site messages according to the first equation , and then the updated square  to  pair messages according to the second one , using in the l.h.s .  the updated pair  to  site messages just obtained .",
    "gbp ( possibly with damping ) typically exhibits better convergence properties ( and greater accuracy ) than bp , but the empirical rule that a sufficient amount of frustration can make it not convergent is valid also for gbp .",
    "it is therefore fundamental to look for provably convergent algorithms , which will be discussed in the next subsection .",
    "a variation of the bp algorithm , the conditioned probability ( cp ) algorithm , with improved convergence properties , has recently been introduced @xcite .",
    "the extension of this algorithm beyond the bp level is however not straightforward .",
    "we conclude the present subsection by mentioning that techniques like the thouless ",
    "palmer equations , or the cavity method , both widely used in the statistical physics of spin glasses , are strictly related to the bethe  peierls approximation .",
    "the thouless  anderson ",
    "palmer @xcite equations can be derived from the bethe  peierls free energy for the ising model , through the so - called plefka expansion @xcite .",
    "one has first to write the free energy as a function of magnetizations and nearest  neighbour correlations through the parameterization @xmath199 then to solve analytically the stationarity conditions with respect to the @xmath200 s and finally to expand to second order in the inverse temperature .",
    "finally , the cavity method @xcite is particularly important since it allows to deal with replica symmetry breaking .",
    "the cavity method , though historically derived in a different way , can be regarded as an alternative choice of messages and effective fields in the bethe  peierls approximation . with reference to ,",
    "introduce messages @xmath201 from variable nodes to factor nodes according to @xmath202 then the probabilities become @xmath203 and the message update equations ( [ bp - mess - upd ] ) become @xmath204 the effective fields corresponding to the factor  to ",
    "variable messages @xmath169 are usually called cavity biases , while those corresponding to the variable  to  factor messages @xmath205 are called cavity fields . in the ising example above a factor node is just a pair of nns and cavity biases reduce to effective fields @xmath159 , while cavity fields take the form @xmath206 .",
    "the cavity method admits an extension to cases where one step of replica symmetry breaking occurs @xcite .",
    "in such a case one assumes that there exist many states characterized by different values of the cavity biases and fields , and introduces the probability distributions of cavity biases and fields over the states . from the above message update rules",
    "one can then derive integral equations , similar to , for the distributions .",
    "these integral equations can in principle be solved by iterative population dynamics algorithms , but most often one restricts to the zero temperature case , where these distributions have a discrete support .",
    "the zero temperature case is particularly relevant for hard combinatorial optimization problems , where 1step replica symmetry breaking corresponds to clustering of solutions .",
    "clustering means that the space of solutions becomes disconnected , made of subspaces which can not be reached from one another by means of local moves , and hence all local algorithms , like bp or gbp , are bound to fail .",
    "the cavity method has been used to solve these kind of problems in the framework of the survey propagation algorithm @xcite , which has been shown to be a very powerful tool for constraint satisfaction problems like satisfiability @xcite and colouring @xcite defined on finite connectivity random graphs .",
    "these graphs are locally tree  like and therefore all the analysis can be carried out at the bethe ",
    "peierls level .",
    "a sort of generalized survey propagation capable of dealing with short loops would really be welcome , but it seems that realizability issues are crucial here and replica symmetry breaking can only be introduced when cvm gives an exact solution .    a different approach , still aimed to generalize the bp algorithm to situations where replica symmetry breaking occurs , has been suggested by van mourik @xcite , and is based on the analysis of the time evolution of the bp algorithm .      in the present subsection",
    "we discuss algorithms which update probabilities instead of messages . at every iteration a new estimate of probabilities , and hence of the free energy , is obtained .",
    "these algorithms are typically provably convergent , and the proof is based on showing that the free energy decreases at each iteration .",
    "this is of course not possible with bp and gbp algorithms , where the probabilities and the free energy can be evaluated only at the fixed point .",
    "the price one has to pay is that in variational algorithms one has to solve the compatibility constraints at every iteration , and therefore these are double loop algorithms , where the outer loop is used to update probabilities and the inner loop is used to solve the constraints .    the natural iteration method ( nim )",
    "@xcite is the oldest algorithm specifically designed to minimize the cvm variational free energy .",
    "it was originally introduced @xcite in the context of homogeneous models , for the pair and tetrahedron ( for the fcc lattice ) approximations . in such cases",
    "the compatibility constraints are trivial .",
    "later @xcite it was generalized to cases where the compatibility constraints can not be solved trivially .",
    "an improved version of the algorithm , with tunable convergence properties , appeared in @xcite and its application is described in some detail also in @xcite , where higher order approximations are considered .",
    "the algorithm is based on a double loop scheme , where the inner loop is used to solve the compatibility constraints , so that at each iteration of the outer loop a set of cluster probabilities which satisfy the constraints is obtained .",
    "proof of convergence , based on showing that the free energy decreases at every outer loop iteration , exist in many cases , but it has also been shown that there are non  convergent cases , like the four  dimensional ising model @xcite in the hypercube approximation .",
    "we do not discuss in detail this algorithm since it is rather slow , and better alternatives have been recently developed .",
    "a first step in this direction was the _ concave  convex procedure _",
    "( cccp ) by yuille @xcite , who started from the observation that the non  convergence problems of message  passing algorithms arise from concave terms in the variational free energy , that is from the entropy of clusters with negative mbius numbers .",
    "his idea was then to split the cvm free energy into a convex and a concave part , @xmath207 and to write the update equations to be iterated to a fixed point as @xmath208 where @xmath209 and @xmath210 are successive iterates . in order to solve the compatibility constraints , at each iteration of , the lagrange multipliers enforcing the constraints are determined by another iterative algorithm where one solves for one multiplier at a time , and it can be shown that the free energy decreases at each outer loop iteration",
    ". therefore we have another double loop algorithm , which is provably convergent , faster than nim ( as we shall see below ) , and allows some freedom in the splitting between convex and concave parts .    a more general and elegant formalism ,",
    "which will be described in the following , has however been put forward by heskes , albers and kappen ( hak ) @xcite .",
    "their basic idea is to consider a sequence of convex variational free energies such that the sequence of the corresponding minima tends to the minimum of the cvm free energy .",
    "more precisely , if the cvm free energy @xmath211 is denoted for simplicity by @xmath31 , they consider a function @xmath212 , convex in @xmath213 , with the properties @xmath214 the algorithm is then defined by the update rule for the probabilities @xmath215 and it is easily proved that the free energy decreases at each iteration and that a minimum of the cvm free energy is recovered at the fixed point .    a lot of freedom is left in the definition of @xmath216 , and strategies of varying complexity and speed can be obtained .",
    "nim ( when convergent ) and cccp can also be recovered as special cases .",
    "the general framework is based on the following three properties .    1 .   if @xmath176 , then @xmath217 is convex over the constraint set , i.e.  it is a convex function of @xmath91 and @xmath218 if these satisfy the compatibility constraint .",
    "the linear bound @xmath219 holds , with equality only for @xmath220 3 .",
    "if @xmath221 , and @xmath218 and @xmath222 ( @xmath223 and @xmath224 ) satisfy the compatibility constraints , the bound @xmath225 holds , and it is tighter than the previous bound .",
    "a tighter bound typically entail faster convergence .    in order to give an example , consider again the cvm square approximation for a model on a regular square lattice with periodic boundary conditions and focus on the entropy part of the free energy , which according to the entropy expansion has the form @xmath226 this contains both convex ( from square and site entropy ) and concave terms ( from pair entropy ) .",
    "notice that the numbers of plaquettes is the same as the number of sites , while there are two pairs ( e.g.horizontal and vertical ) per site .",
    "this implies that the free energy is not convex over the constraint set .",
    "several bounding schemes are possible to define @xmath227 . for instance",
    ", one can obtain a function which is just convex over the constraint set by applying property ( iii ) to the site terms and half the pair terms , with the result @xmath228 in the following the hak algorithm will always be used with this bounding scheme .",
    "the nim can be obtained if , starting from the above expression , one applies property ( ii ) to the not yet bounded pair terms , with the result @xmath229 this is clearly a looser bound than the previous one , and hence it leads to a ( much ) slower algorithm . in the general case , the nim ( which of course was formulated in a different way ) can be obtained by bounding all entropy terms except those corresponding to the maximal clusters .",
    "this choice does not always lead to a convex bound ( though in most practically relevant cases this happens ) and hence convergence is not always guaranteed .",
    "the cccp recipe corresponds to bounding every convex ( @xmath230 ) term by @xmath231 using property ( ii ) . in the present case this gives @xmath232 which is convex independently of the constraints , and hence the bound is again looser than    in all cases one",
    "is left with a double loop algorithm , the outer loop being defined by the update rule for probabilities , and the inner loop being used for the minimization involved in .",
    "this minimization is simpler than the original problem , since the function to be minimized is convex . in each of the above schemes a particular technique",
    "was proposed for the convex minimization in the inner loop , and here these will not be covered in detail .",
    "a point which is important to notice here is that the bounding operation gives a new free energy which is structurally different from a cvm free energy .",
    "it must be minimized with respect to @xmath213 at fixed @xmath233 and , viewed as a function of @xmath213 , it contains an entropy expansion with coefficients @xmath234 which do not satisfy anymore the mbius relation ( [ mobiusnumbers ] ) ( for instance , in the `` just convex over the constraint set '' scheme , we have @xmath235 , @xmath236 and @xmath237 ) .",
    "this means that a message  passing algorithm like parent  to  child gbp , which relies on the mbius property , can not be applied . in @xcite a different message  passing algorithm , which can still be viewed as a gbp algorithm , is suggested .",
    "observe also that there are entropy  like terms @xmath238 which are actually linear in @xmath218 and must therefore be absorbed in the energy terms .",
    "the main reason for investigating these double loop , provably convergent algorithms , is the non  convergence of bp and gbp in frustrated cases . since bp and gbp , when they converge , are the fastest algorithms for the determination of the minima of the cvm free energy , it is worth making some performance tests to evaluate the speed of the various algorithms .",
    "the cpu times reported below refer to an intel pentium 4 processor at 3.06 ghz , using g77 under gnu / linux .",
    "consider first a chain of @xmath239 ising spins , with ferromagnetic interactions @xmath240 and random bimodal fields @xmath241 independently drawn from the distribution @xmath242 the boundary conditions are open , and the model is exactly solved by the cvm pair approximation .",
    "the various algorithms described are run from a disordered , uncorrelated state and stopped when the distance between two successive iterations , defined as the sum of the squared variations of the messages ( or the probabilities , or the lagrange multipliers , depending on the algorithm and the loop  outer or inner  considered ) . reports the cpu times obtained with several algorithms , for the case @xmath243 , @xmath244 .",
    "the hak algorithm is not reported since it reduces to bp due to the convexity of the free energy .",
    "it is seen that the cpu time grows linearly with @xmath239 for all algorithms except nim , in which case it goes like @xmath245 . despite the common linear behaviour , there are order of magnitude differences between the various algorithms .",
    "while bp and cp converges in 4 and 9 seconds respectively for @xmath246 , cccp takes 15 seconds for @xmath247 . for nim ,",
    "finally , the fixed point is reached in 12 seconds for @xmath248 .",
    "cpu times ( seconds ) for the 1d ising chain with random fields ]    as a further test , consider , again at the level of the pair approximation , the two  dimensional edwards ",
    "anderson spin glass model , defined by the hamiltonian with @xmath51 and random bimodal interactions @xmath20 independently drawn from the distribution @xmath249 here the frustration effects are even more important and the non  convergence problem of bp becomes evident . as a rule of thumb ,",
    "when the temperature , measured by @xmath250 , is small enough and @xmath213 ( the fraction of antiferromagnetic bonds ) is large enough , the bp algorithm stops converging .",
    "the condition for the instability of the bp fixed point has been computed , in the average case , for ising spin glass models with pairwise interactions @xcite . in order to compare algorithm performances , reports cpu times vs @xmath251 for @xmath252 lattices with periodic boundary conditions , @xmath253 and @xmath254 , that is well into the paramagnetic phase of the model .",
    "the initial guess is a ferromagnetic state with @xmath255 .",
    "it is seen that the cpu times scale roughly as @xmath256 for all the algorithms considered except nim , which goes like @xmath257 .",
    "again the algorithms with linear behaviour are separated by orders of magnitude .",
    "for @xmath258 bp converges in 6 seconds , hak in 370 seconds and cccp in 2460 seconds .",
    "cp has not been considered in the present and the following tests , although empirically it is seen that its behaviour is rather close to the hak algorithm .",
    "its performance is however severely limited as soon as one considers variable with more than two states , due to a sum over the configurations of the neighbourhood of a nn pair .",
    "cpu times ( seconds ) for the 2d edwards  anderson model in the paramagnetic phase ]    a similar comparison can be made in the ferromagnetic phase , setting @xmath259 and @xmath260 . here the cpu times for the bp algorithm exhibit large fluctuations for different realizations of the disorder , and the data reported are obtained by averaging over 30 such realizations . now all algorithms exhibit comparable scaling properties , with cpu times growing like @xmath261 .",
    "as far as absolute values are concerned , for @xmath262 convergence is reached in 4 , 44 , 680 and 1535 seconds by bp , hak , cccp and nim respectively .",
    "cpu times ( seconds ) for the 2d edwards  anderson model in the ferromagnetic phase ]    a similar scaling analysis was not possible into the glassy phase ( which is unphysically predicted by the pair approximation ) , due to non  convergence of bp and too large fluctuations of the convergence time of the other algorithms .",
    "as a general remark we observe that bp is the fastest algorithm available whenever it converges . among the provably convergent algorithms , the fastest one turns out to be hak , at least in the `` just convex over the constraints '' @xcite scheme which was used here .",
    "some aspects of the cluster variation method have been briefly reviewed .",
    "the emphasis was on recent developments , not yet covered by the 1994 special issue of progress of theoretical supplement @xcite , and the focus was on the methodological aspects rather than on the applications .",
    "the discussion has been based on what can be considered the modern formulation of the cvm , due to an @xcite , based on a truncation of the cumulant expansion of the entropy in the variational principle of equilibrium statistical mechanics .",
    "the advancements in this last decade were often due to the interaction between two communities of researchers , working on statistical physics and , in a broad sense , probabilistic graphical models for inference and optimization problems .",
    "the interest of both communities is currently on heterogeneous problems , while in the past the cvm was most often applied to translation invariant lattice models ( in this topic , the only new advancements discussed have been the attempts to extract information about critical behaviour from cvm results ) .",
    "the more general point of view that has to be adopted in studying heterogeneous problems has been crucial to achieve many of the results discussed .",
    "the formal properties of the cvm have been better understood by comparing it with other region  based approximations , like the junction graph method or the most general formulation of the bethe ",
    "peierls approximation ( the lowest order of the cvm ) , which can treat also non  pairwise interactions .",
    "studying realizability , that is the possibility of reconstructing a global probability distribution from the marginals predicted by the cvm , has led to the discovery of non  tree  like models for which the cvm gives the exact solution .",
    "a very important step was made by understanding that belief propagation , a message  passing algorithm widely used in the literature on probabilistic graphical models , has fixed points which correspond to stationary points of the bethe  peierls approximation .",
    "the belief propagation can thus be regarded as a powerful algorithm to solve the cvm variational problem , that is to find minima of the approximate free energy , at the bethe ",
    "peierls level .",
    "this opened the way to the formulation of generalized belief propagation algorithms , whose fixed points correspond to stationary points of the cvm free energy , at higher level of approximation .    belief propagation and generalized belief propagation are certainly the fastest available algorithms for the minimization of the cvm free energy , but they often fail to converge . typically this happens when the problems under consideration are sufficiently frustrated . in order to overcome this difficulty double loop , provably convergent algorithms",
    "have been devised , for which the free energy can be shown to decrease at each iteration .",
    "these are similar in spirit to the old natural iteration method by kikuchi , but orders of magnitude faster , though not as fast as bp and gbp .",
    "when the frustration due to competitive interactions or constraints is very strong , like in spin ",
    "glass models in the glassy phase or in constraints satisfaction problems in the hard regime , even double loop algorithms become useless , since we are faced with the problem of replica symmetry breaking , corresponding to clustering of solutions .",
    "very important advancements have been made in recent years by extending the belief propagation algorithm into this domain .",
    "these results are in a sense at the border of the cvm , since they are at present confined to the lowest order of the cvm approximation , that is the bethe  peierls approximation .",
    "it will be of particular importance , in view of the applications to hard optimization problems with non  tree  like structure , to understand how to generalize these results to higher order approximations .",
    "i warmly thank pierpaolo bruscolini , carla buzano and marco pretti , with whom i have had the opportunity to collaborate and to exchange ideas about the cvm , marco zamparo for a fruitful discussion about , riccardo zecchina for many discussions about the survey propagation algorithm , and the organizers of the lavin workshop `` optimization and inference in machine learning and physics '' where i had the opportunity to discuss an early version of this work ."
  ],
  "abstract_text": [
    "<S> the cluster variation method ( cvm ) is a hierarchy of approximate variational techniques for discrete ( ising  like ) models in equilibrium statistical mechanics , improving on the mean  field approximation and the bethe  </S>",
    "<S> peierls approximation , which can be regarded as the lowest level of the cvm . in recent years </S>",
    "<S> it has been applied both in statistical physics and to inference and optimization problems formulated in terms of probabilistic graphical models .    </S>",
    "<S> the foundations of the cvm are briefly reviewed , and the relations with similar techniques are discussed . </S>",
    "<S> the main properties of the method are considered , with emphasis on its exactness for particular models and on its asymptotic properties .    </S>",
    "<S> the problem of the minimization of the variational free energy , which arises in the cvm , is also addressed , and recent results about both provably convergent and message - passing algorithms are discussed . </S>"
  ]
}