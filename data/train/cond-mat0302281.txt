{
  "article_text": [
    "the properties of strongly correlated electron systems near the mott insulating phase depend sensitively on the doping.@xcite most simulations of these systems have been carried out within the grand canonical ensemble , where a convenient formalism exists for the evaluations of finite temperature green s functions and other physical quantities that can be expressed in terms of them.@xcite in this framework , to explore the doping dependence , it is necessary to carry out simulations at various discrete values of the chemical potential @xmath0 , and interpolate between them . in this paper",
    "we describe a method for optimally combining data from these simulations to obtain results for a continuous range of @xmath1 .",
    "we first evaluate canonical ensemble expectation values and partition functions ( up to an overall constant ) from simulations performed in the grand canonical ensemble . using the approach of ferrenberg and swendsen  @xcite to combine results from simulations performed with different value of the chemical potential",
    ", we obtain canonical ensemble quantities for a wide range of fillings from a modest number of simulations . from these",
    "we are able to construct grand canonical expectation values , enabling us to study a variety of physical quantities as a continuous function of the chemical potential .    in section",
    "ii we present our methodology , and in section  iii we illustrate it with results for the two - dimensional hubbard model .",
    "we begin by briefly summarizing the approach to the simulation of strongly correlated many - electron systems in the grand canonical ensemble set out in ref .  .",
    "the expectation value of a physical observable @xmath2 is @xmath3 }           { { \\rm tr}\\,\\left[e^{-\\beta ( h -\\mu n)}\\right ] } , \\label{eq : trace}\\ ] ] where @xmath4 is the hamiltonian , @xmath5 the inverse temperature , @xmath1 the chemical potential and @xmath6 the number operator for the electrons . in order to perform a numerical simulation",
    ", one must first evaluate the traces over the electron degrees of freedom .",
    "this is possible if the hamiltonian is quadratic in the electron creation and annihilation operators , or can be made so through a hubbard - stratonovich transformation . to this end",
    "we introduce a small imaginary - time step , @xmath7 , by writing @xmath8 . the partition function",
    "can then be written in the form @xmath9 =   { \\rm tr}\\,\\left[e^{-\\delta\\tau(h-\\mu n)}\\right]^l.\\ ] ] for each time - slice @xmath10 , we introduce a set of hubbard - stratonovich variables @xmath11 such that @xmath12 here @xmath13 and @xmath14 are the creation and annihilation operators for electrons at lattice site @xmath15 with @xmath16-component of spin @xmath17 ; @xmath18 is a single particle hamiltonian for an electron propagating through the external field , @xmath11 ; and @xmath19 is a positive definite weight function .",
    "@xmath20 indicates an integral over continuous hubbard - stratonovich variables or a sum over discrete ones .",
    "typically , @xmath11 has a component for each spatial lattice site or link .",
    "the traces in eq .",
    "( [ eq : trace ] ) can now be performed , yielding an expression of the general form @xmath21 here @xmath22 stands for the totality of hubbard - stratonovich variables on all time slices , @xmath23 and the determinants for spin up and down electrons are given by @xmath24 , \\label{eq : det}\\ ] ] where @xmath25 is the unit matrix and @xmath26 the quantity @xmath27 in eq .",
    "( [ eq : sum ] ) can generally be expressed in terms of finite temperature green s functions for a single electron propagating in the background field provided by the hubbard - stratonovich variables , @xmath22 .",
    "for example , @xmath28 = & d_\\uparrow(x,\\mu)\\ ; d_\\downarrow(x,\\mu)\\ ; \\delta_{\\sigma,\\sigma^\\prime } \\nonumber \\\\ & \\times \\left(\\frac{1}{i+e^{\\,\\beta\\,\\mu}\\ : a_\\sigma(x)}\\right)_{i , j}.\\end{aligned}\\ ] ] for models with particle - hole symmetry , such as the hubbard model at half - filling , the product of the electron determinants is positive , and one can use importance sampling techniques to generate a sequence of hubbard - stratonovich configurations with the probability distribution @xmath29 the average value of @xmath27 in these configurations is then an estimator for @xmath30 .",
    "details of an algorithm for efficiently generating configurations are given in ref .  .",
    "for systems which do not have particle - hole symmetry , such as the hubbard model away from half - filling , the product of electron determinants will in general not be positive definite .",
    "in such cases , one can generate hubbard - stratonovich fields using the probability distribution @xmath31 it is then necessary to move the sign of @xmath32 , @xmath33 into the measurements yielding @xmath34 the expectation value of the sign can be written @xmath35 here @xmath36 is the partition function of the physical system , and @xmath37 that of a fictitious one in which the sign of the product of determinants , @xmath38 , is ignored .    to obtain information about the canonical ensemble from grand canonical simulations , we note that so long as the electron number operator commutes with the hamiltonian , and the hubbard - stratonovich variables are chosen so that eq .",
    "( [ eq : hs ] ) holds , then the product of electron determinants has an expansion in the fugacity of the form @xmath39 once we have gone to the computational expense of perform an ldu decomposition of @xmath40 , eq .",
    "( [ eq : asig ] ) , which we must do each time we make a measurement,@xcite it is straightforward to evaluate the left - hand side of eq .",
    "( [ eq : fug ] ) for a number of different values of @xmath1 .",
    "( [ eq : fug ] ) then yields a set of linear equations that can be solved for the @xmath41 . at moderate to low temperatures , only a limited subset of the @xmath41 will make a significant contribution to the product of determinants , so the system of equations to be solved is considerably smaller than the number of spatial lattice points . since the canonical partition function for the sector with electron number @xmath6 is given by @xmath42 where @xmath43 we can evaluate @xmath44 using an ensemble of hubbard - stratonovich fields generated with the probability distribution @xmath45 .    if the operator @xmath2 is defined on a single imaginary - time slice , or if it does not change the electron number from time slice to time slice , then we can also write @xmath46 and we can obtain a set of linear equations for the @xmath47 by evaluating the left - hand side of eq .",
    "( [ eq : ox ] ) for different values of @xmath1 . in this case",
    "@xmath48 finally , the expectation value of the operator @xmath2 in the canonical ensemble sector with electron number @xmath6 is @xmath49 also , once the @xmath50 and @xmath51 are in hand , @xmath52 gives the grand canonical expectation values as continuous functions of @xmath1 .    from simulations at a single value of @xmath1 one only expects to be able to make accurate determinations of the @xmath50 and @xmath51 for @xmath6 in the vicinity of @xmath53 .",
    "we must therefore perform a set of simulations with chemical potentials @xmath54 , sufficiently spaced to cover the range of @xmath6 relevant to the problem of interest .",
    "as indicated in eqs .",
    "( [ eq : zn ] ) and ( [ eq : on ] ) , the outputs of our simulations are @xmath55 and @xmath56 , rather than @xmath50 and @xmath51",
    ". we can combine results from simulations with different values of the chemical potential by writing @xmath57 with @xmath58 following ferrenberg and swendsen , we choose the @xmath59 and @xmath60 to minimize the variance of @xmath50 and @xmath51 subject to the constraints of eq .",
    "( [ eq : constraint ] ) . a short calculation yields @xmath61 } { \\sum_\\gamma \\ ; 1/[z_\\abs(\\mu_\\gamma)\\ ; \\sigma^2_n(\\mu_\\gamma ) ] } , \\label{eq : solve}\\ ] ] where @xmath62 is the variance of @xmath63 , which we determine from the simulation .",
    "of course , a corresponding result holds for the @xmath60 with @xmath62 replaced by the variance of the @xmath64 .",
    "the constants @xmath65 can be determined up to an overall normalization by iteratively solving the equation @xmath66 with the @xmath50 given by eqs .",
    "( [ eq : combo ] ) and ( [ eq : solve ] ) .",
    "the @xmath67 are measured directly in the simulations .",
    "it is also possible to obtain @xmath37 , and therefore @xmath68 , as a continuous function of @xmath1 .",
    "we simply note that @xmath69 where @xmath70    note that once the @xmath41 are known for any configuration , we can determine @xmath38 for any value of @xmath1 from the right - hand side of eq .",
    "( [ eq : fug ] ) . a simulation performed at the chemical potential , @xmath54 ,",
    "will , of course , only determine the ratio @xmath71 .",
    "however , we can combine results from simulations performed at different values of the chemical potential just as for the @xmath50 .",
    "free energy difference between half - filled system and system with chemical potential @xmath1 .",
    "statistical errors are negligible on this scale.,width=336 ]    we illustrate the methodology outlined in the last section with results for the two - dimensional hubbard model .",
    "the hamiltonian is @xmath72 here @xmath13 and @xmath14 are the creation and annihilation operators for electrons with @xmath16-component of spin @xmath17 at lattice site @xmath15 , and @xmath73 .",
    "the sum @xmath74 is over all pairs of nearest neighbor lattice sites .",
    "@xmath75 is the hopping parameter , and @xmath76 the coulomb coupling constant .",
    "the coulomb term is reduced to quadratic form in the electron creation and annihilation operators using hirsch s discrete hubbard - stratonovich transformation  @xcite @xmath77 for @xmath78 , which corresponds to half - filling , particle - hole symmetry implies that @xmath79 is always positive,@xcite so @xmath80 , and there is no sign problem .",
    "it is therefore convenient to adopt the normalization @xmath81 in solving eq .",
    "( [ eq : z ] ) for @xmath65 .",
    "thus , we are in fact able to use eqs .",
    "( [ eq : z ] ) and ( [ eq : zp ] ) to determine @xmath82 and @xmath83 respectively .",
    "all of the results we present here are on a @xmath84 lattice with @xmath85 and @xmath86 . the number of time slices , @xmath87 , is chosen so that @xmath88 . except where otherwise noted , simulations were performed at @xmath89 and @xmath90 for each temperature . at @xmath91",
    "we performed additional runs at both @xmath92 and @xmath93 , while at other temperatures either @xmath92 or @xmath94 was used . for runs at @xmath90 , 100,000 monte",
    "carlo sweeps with 10,000 warmup sweeps were performed . for all other runs",
    ", 400,000 monte carlo sweeps with 10,000 warmup sweeps were performed . for all simulations , non - local moves , as suggested in ref .  ,",
    "were used to assure ergodicity .",
    "to invert eqs .",
    "( [ eq : fug ] ) and ( [ eq : ox ] ) , the right - hand sides are measured at the set of chemical potentials , @xmath95 where @xmath54 is the chemical potential used in the simulation , @xmath96 and @xmath97 .",
    "after inversion and averaging over configurations , particle sectors where @xmath98 are dropped to prevent the spread of roundoff error from the inversion .",
    "the jackknife method was used for error analysis .",
    "it should be noted that , after analysis , results at different values of @xmath1 are not statistically independent .",
    "density of the system for several different values of @xmath5 .",
    "as errors depend on @xmath1 , errorbars are shown at several points along the curves here and in subsequent figures .",
    "also shown is the zero - temperature result , calculated using exact diagonalization.,width=336 ]     charge compressibility of the system , obtained by the analytical differentiation of @xmath99 .",
    ", width=336 ]     ( a ) the antiferromagnetic structure factor , @xmath100 .",
    "( b ) the @xmath101-wave pair field correlation function .",
    ", width=336 ]    in fig .",
    "[ fig : f ] we plot the free energy difference , @xmath102 as a function of @xmath1 , for two values of @xmath5 . in fig .",
    "[ fig : n ] we plot the density defined by @xmath103 . here",
    "@xmath104 is the number of spatial lattice points and @xmath105 is calculated using the standard thermodynamic identity , @xmath106 as the temperature is lowered , the transition between the half - filled state ( @xmath107 ) and the 6-hole state ( @xmath108 ) becomes sharper .",
    "in particular , at zero - temperature the density decreases in a series of jumps , due to the discreteness of the finite - size spectrum .    within our framework",
    "it is also straightforward to compute the compressibility of the system , @xmath109 , by differentiation of eq .",
    "( [ eq : n ] ) .",
    "note that the differentiation can be performed analytically .",
    "figure  [ fig : comp ] shows the compressibility as a function of @xmath1 for different values of @xmath5 . as the temperature is lowered , the compressibility develops a peak around @xmath110 that is likely to be the signature of the low - temperature divergence expected from the metal - insulator transition.@xcite     the expectation value of the sign . calculated from runs with 100,000 monte carlo sweeps at @xmath111 , @xmath112 , and @xmath90 .",
    ", width=336 ]    = -1 as previously mentioned , within our numerical scheme it is possible to calculate observables that are not diagonal in the particle number .",
    "figure  [ fig : safpd](a ) shows the antiferromagnetic structure factor .",
    "this is given by @xmath113 where @xmath114 is the standard spin operator .",
    "the plot of this quantity vs.  @xmath1 clearly indicates that the antiferromagnetic correlations present at half - filling are sharply suppressed upon doping .",
    "a similar plot of the equal - time @xmath101-wave pair field correlation function is shown in fig .  [",
    "fig : safpd](b ) . here",
    "the @xmath101-wave pair field correlation function is given by @xmath115 where @xmath116 creates two electrons in a @xmath101-state . here ,",
    "@xmath117 sums over the four near - neighbor sites of @xmath118 and @xmath119 gives the sign alternation characteristic of a @xmath101-wave pairing amplitude .",
    "the enhancement of @xmath120 toward @xmath121 is a finite - size effect due to a strong antiferromagnetic response in the nearest - neighbor terms in eq .",
    "( [ eq : pd ] ) .",
    "finally , we show the expectation value of the sign in fig .",
    "[ fig : sign ] . here",
    "the sign is calculated as a continuous function of @xmath1 using eqs .",
    "( [ eq : zp ] ) and ( [ eq : znp ] ) .",
    "note that the sign is small in the @xmath110 region where the density is changing rapidly and electron correlations are believed to be important .",
    "the statistical fluctuations of the other observables grow as the sign decreases .",
    "in this paper we have presented a new method for extracting canonical ensemble results from grand canonical ensemble quantum monte carlo simulations . as canonical information",
    "is only extracted from sectors whose particle number is close to the average number of particles in the simulation , simulations must be performed at several different chemical potentials to obtain results for a range of particle number sectors .",
    "these separate simulations can then be combined to obtain a complete picture of the different canonical ensembles with lower statistical fluctuations than any of the simulations taken individually .",
    "once the canonical results are obtained , they can be combined to give grand canonical results as a continuous function of the chemical potential .    in this work",
    "we have presented results for the two - dimensional hubbard model on a @xmath84 lattice with coloumb interactions of moderate strength , but the method is applicable to any quantum mechanical problem , simulated in the grand canonical ensemble , for which particle number is conserved .",
    "r.  blankenbecler , d.j .",
    "scalapino and r.l .",
    "sugar , phys .",
    "d * 24 * , 2278 , ( 1981 ) ; and s.r .",
    "white , d.j .",
    "scalapino , r.l .",
    "sugar , e.y .",
    "loh , j.e .",
    "gubernatis and r.t .",
    "scalettar , phys .",
    "b * 40 * , 506 , ( 1989 ) ."
  ],
  "abstract_text": [
    "<S> we show how canonical ensemble expectation values can be extracted from quantum monte carlo simulations in the grand canonical ensemble . in order to obtain results for all particle sectors , </S>",
    "<S> a modest number of grand canonical simulations must be performed , each at a different chemical potential . from the canonical ensemble results , </S>",
    "<S> grand canonical expectation values can be extracted as a continuous function of the chemical potential . </S>",
    "<S> results are presented from the application of this method to the two - dimensional hubbard model . </S>"
  ]
}