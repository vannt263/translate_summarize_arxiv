{
  "article_text": [
    "in this communication a workable algorithm is derived and presented that allows each processor to store all information required to quickly look up any two - electron integral , involving four basis functions , needed for either density - functional or multiconfigurational wavefunction methods .",
    "the method is demonstrated by applications of a uniform electron gas , confined to a cubic box , for electrons with wavevectors that are enclosed in a fermi sphere .",
    "strategies for rapid calculation or efficient storage of two - electron integrals , for density - functional  @xcite calculations , or multiconfigurational active space methods  @xcite continue to evolve as different mathematical techniques and different types of computing platforms arise and as different types of basis functions are implemented for use in electronic structure calculations . a recent comprehensive review of these efforts by reine _",
    "@xcite includes discussions of least - square variational fitting methods  @xcite and rys polynomials  @xcite .",
    "other methods such as direct methods  @xcite , analytic algebraic decompositions  @xcite , tensor hypercontraction  @xcite and multipole methods  @xcite are also widely used .",
    "many of these methods support the hypothesis that the space of two - electron integrals is smaller than naively expected .",
    "this paper seeks to formally prove , for separable functions used in electronic structure calculations , that the set of information on which the n@xmath0 coulomb integrals truly depends is much smaller than expected from a permutational analysis .",
    "further a practical approach is developed and applied to the uniform electron gas .",
    "the algorithm is based upon a three - dimensional fourier transform , a one - dimensional laplace transform , an additional one - dimensional integral transform , and the use of gaussian quadrature .",
    "the storage requirements needed to calculate matrix elements associated with the coulomb operator is reduced to o(@xmath2 ) for either planewaves or gaussians .",
    "another motivation for this work is that the development of massively parallel methods requires one to break a problem up into many independent subtasks that can then be performed simultaneously by a large number of computer processors  @xcite . to achieve high efficiency on massively parallel architectures ,",
    "it is necessary to ensure that the amount of information exchanged between processors is small and that the rate of information exchange is intrinsically faster than the computing time used by any processor . for future low - power computing platforms it is desireable ,",
    "if not expected , for each processor to have a very limited amount of computer memory .",
    "thus , in reference to many - electron quantum mechanics or density functional theory  @xcite , it is appropriate to reconsider whether there are other means for reconstructing matrix elements that might be more efficient on modern massively parallel architectures . for such systems it would be ideal to allow each processor to quickly reconstruct any possible coulomb integral needed for a quantum - mechanical simulation without information transfer to or from other processors .",
    "there is one important aspect of this derivation that appears to be universally correct for many , possibly all , choices of separable basis functions and that is definitely correct for planewave and gaussian basis functions .",
    "therefore some general considerations are discussed before moving the focus of this paper to applications within planewave basis sets .",
    "given a set of infinitely differentiable and continuous one - dimensional functions , labeled as f@xmath3 , it is possible to create three - dimensional basis functions @xmath4 according to : @xmath5 with @xmath6 .",
    "common examples of such basis functions include planewaves inside a box or unit cell or products of one - dimension gaussian functions which generally also have separable polynomial prefactors . in the former case one",
    "generally uses all possible products subject to the constraint that @xmath7 and then seeks convergence by performing the calculation as a function of the cutoff wavenumber ( @xmath8 ) . assuming one chooses a total of n three - dimensional basis functions , it is then clear that there are approximately @xmath9 one - dimensional basis functions for each cartesian coordinate . for simplicity , but not actually required for this observation",
    ", the assumption is that the same one - dimensional basis sets are used for each cartesian component .",
    "so , even though there are @xmath10 pairs of three dimensional basis functions , there are only n@xmath11 one dimensional products of basis functions . for planewaves ,",
    "the complexity is further reduced to @xmath12 since the product of a planewave is a plane wave . for gaussians",
    "this number becomes @xmath13 , with @xmath14 a characteristic number of neighbors , since the product of two well separated gaussians is identically zero .",
    "the matrix elements that are needed to solve the coulomb problem in density functional theory or to determine matrix elements required for either hartree - fock or multi - configurational calculations are given by    @xmath15    however , by using a continuous fourier transform of @xmath16 , followed by a laplace transform of @xmath17 , the above equation can be written in quasi - separable form according to : @xmath18 eq .",
    "4 follows from eq .  3 by a continuous fourier transform of @xmath19 .",
    "5 follows from eq .  4 by a continuous laplace transform of @xmath20 .",
    "6 follows from eq .",
    "5 since all functions are separable . in the above equation , the nine - dimensional integral",
    "is reduced to a triple product .",
    "each one of these products are composed of three dimensional integrals that is defined according to : @xmath21    for either one - dimensional planewaves or gaussians , the above three - dimensional integral can be determined , as a function of @xmath22 , without significant difficulty .",
    "it is possible that for other separable functions these integrals would be difficult to calculate .",
    "however , since in the worst case there are only @xmath23 of these integrals , one can imagine calculating them only once and storing them forever .",
    "this means that one only needs to find an efficient numerical method for performing the laplace integral in eq .",
    "6 . from this standpoint , an observation that is absolutely key to capitalizing on this quasi - separable form",
    "is that by integrating the above expression ( eq .  8) over @xmath24 , the @xmath22-dependent part of the , now , two dimensional integral , can in principal , be reduced to products of quantities with the following form : @xmath25 with @xmath26 .",
    "therefore , for a large enough value of @xmath27 , it follows that eq .",
    "( 7 ) may be rewritten , to any desired precision , according to : @xmath28 in the above equation the @xmath29 are hard - to - determine constants that depend upon the functional form of separable basis sets , the taylor expansion coefficients , @xmath30 , in eq .",
    "( 9 ) , a lot of really complicated algebra , triple products of two - dimensional integrals associated with eq .",
    "( 8) , and the collection of common coefficients of @xmath31 arising from the occurrence of triple summations associated with each cartesian coordinate . it would be algebraically difficult and computationally inefficient but not impossible to calculate these numbers .",
    "* however , for the purpose here it is only necessary to know that the value of @xmath29 could , in principle , be found and to accept that knowledge about the asymptotic power law associated with the laplace integrand provides very important information about how to numerically evaluate the integral which extends to infinity . * to make further progress , the second term in the eq .",
    "10 is temporarily rewritten by making the substitution @xmath32 , and @xmath33 .",
    "this leads to : @xmath34 now , since both definite integrals are to be evaluated over a finite interval , these integrals can be evaluated using gaussian - quadrature or other one - dimensional numerical integration meshes according to : @xmath35 in the above expressions the two sets of gaussian - quadrature weights and points , @xmath36 and @xmath37 depend only on the choice of @xmath27 and methods and codes for choosing these points are widely available and well known  @xcite . a back transformation of the right - hand sum , obtained by setting @xmath38 , and defining @xmath39 , the integral collapses to the original recognizable form : @xmath40       \\prod_x a_x(\\alpha_i , i_x , j_x , k_x , l_x ) \\\\ \\nonumber + & & 4\\pi   \\sigma_{i=1}^q \\omega_i    \\sigma_{n=0}^{\\infty } \\gamma_n({\\bf i , j , k , l } )    \\frac{1}{\\alpha_i^{n+\\frac{3}{2}}}.\\end{aligned}\\ ] ] with a suitable redefinition of notation for the volume elements and the recognition that the second term includes a summation which is exactly equal to @xmath41 , the laplace integral is reduced to quadratures over products of three one - dimensional integrals ( eq .",
    "here , it is emphasized , that eq .",
    "( 7 ) could have been immediately written in terms of numerical integrals .",
    "however the analysis followed allows one to determine how the asymptotic form of the integrand scales so that the particular case of gaussian quadrature methods , that are amenable to numerical evaluation of polynomials over finite intervals , may be used for performing the integrations .",
    "as written , it has been demonstrated that one needs to store at most n@xmath42 one dimensional integrals to reconstruct any of the n@xmath43 integrals .",
    "based on past usage of quadrature methods , it is reasonable to expect that one can perform multiscale numerical one - dimensional integration , such as the laplace transformation here , with approximately 30 - 100 sampling points  @xcite .",
    "@xmath44 while the results discussed here are a factor of 2 - 4 away from this goal , it is likely that the number of sampling points can be significantly decreased by determining the value of @xmath27 which allows for the most efficient numerical integration , by breaking the @xmath22 integral ( laplace transformation ) into more than two intervals , and/or by using techniques similar to the variational one - dimensional exponential quadrature methods of ref  @xcite .",
    "for example , a quadrature mesh constructed to integrate polynomials of @xmath45 , rather than x , would be twice as efficient as the standard gaussian quadratures meshes . except for the clear need to exploit the @xmath46 transformation for the final interval that extends to @xmath47 , finding the best quadrature sums",
    "are expected to depend on the form of the separable functions being employed . here , for simplicity and reproducibility by others , only standard gaussian - quadrature methods , with @xmath48 , are used .",
    "for planewaves , the product of the one - dimensional functions @xmath50 reduce to a product of two one - dimensional planes waves which is itself a planewave .",
    "if one starts with @xmath9 one dimensional planewaves ( e.g. @xmath51 , the products will only provide @xmath12 plane waves .",
    "therefore the number of one - dimensional integrals that are required is reduced to @xmath49 . as a simple application",
    ", the m - dependence of the exact exchange energy of an unpolarized gas of 2 m electrons in a box with finite volume ( v = lxlxl ) is determined in this section .",
    "as m gets very large , the exchange energy will converge to the kohn - sham value of @xmath52 .",
    "it is also easy to verify based on scaling arguments that for any number of planewaves placed inside such a box , the exact exchange energy will scale a @xmath53/l with @xmath54 depending on the occupations @xmath55 as a function of wavevector and the number of electrons m placed in the box . here to validate the numerics , the standard choice of occupation numbers are taken to be unity for all planewaves enclosed in a fermi sphere of various radii .",
    "the radii , or fermi wavevector , are chosen so that there are shell closings in reciprocal space .    for a finite system ,",
    "it is possible to fully occupy a fermi sphere for a well defined cutoff wavevector if one chooses m= 7 , 33 , 123 , 257 , 515 , 925,1419 , 2109 , 3071 , 4169 , 5575 , 7153 , or 9171 electrons of each spin . in fig .  1 ,",
    "the ratio of the exact exchange energy to the kohn - sham energy is presented as a function of @xmath56 . in the large m limit ,",
    "it is evident that this ratio converges linearly to 1 .",
    "this indicates that all the integrals are being performed accurately . in fig .  2 ,",
    "the time required per electron , as a function of the total number of electrons , is shown . for cases where each ks - orbital is identically equal to a planewave the time required for the calculation of the exchange ( or coulomb ) interaction scales as the square of the number of electrons . for 9171 electrons ,",
    "the hartree - fock exchange energy can be calculated in four seconds on a macbook air . in table",
    "i , the convergence of the hartree - fock energy for m=9171 parallel spin electrons is shown as a function of gaussian - quadrature mesh . for purposes of reproducibility",
    ", the first mesh is determined by q quadrature points on the interval between 0 and 1 .",
    "these points , designated by @xmath57 in eq .",
    "( 12 ) are then transformed as described above to reduce the calculation of each exchange integral to the form shown in eq .",
    "14 ( e.g. a total of 2q mesh points for the two intervals ) .",
    "the results show that with standard quadrature methods , and an overly simple tesselation into only two sub - intervals , it is difficult to efficiently converge the energy due to sharp structure near @xmath58 .",
    "however , as shown in the right - most columns , if one further breaks the first interval into sub - intervals defined by @xmath59,[1/5 ^ 7,1/5 ^ 6], ... ,[1/5,1]$ ] and then uses 5- , 10- , and 15-point quadrature meshes in each of these sub intervals , convergence of the energy for m=9171 electrons is achieved .",
    ".ratio of exchange energy to kohn - sham exchange energy for a cube containing 2m=18342 electrons as a function of the number of quadrature points used in eq .  14 .",
    "mesh 1 uses q quadrature points on an interval between 0 and 1 .",
    "mesh 2 , which breaks interval 1 into eight sub - intervals with geometrically varying length scales is numerically more efficient and allows for at least six - place precision .",
    "this suggests that the variational exponential quadrature methods , used for radial integrations in ref .",
    "@xcite may be more efficient [ cols=\">,>,>,>,>,>\",options=\"header \" , ]      to summarize , this paper provides a practical and systematically improvable algorithm that reduces the storage required for the coulomb integrals to @xmath60 for the special cases of basis sets that are commonly used in electronic structure calculations . for the case of planewave calculations , it is only recently that researchers have begun to entertain the possibility of performing multiconfigurational corrections using such basis sets .",
    "the results of this paper significantly lower the storage requirements needed for either dft , hartree - fock , or multi - configurational methods based upon planewaves .",
    "future improvements of this method , with initial applications of the self - interaction correction  @xcite to the uniform electron gas calculations are in progress  @xcite . as compared to structurally simpler plane - wave methods , conversion of this algorithm for use withing gaussian - based - orbital methodologies , will require a large investment of programming time but are fully expected to provide the same reduction of memory / disk requirements for reconstruction of the two - electron integrals .",
    "p. hohenberg and w. kohn , phys . rev . *",
    "136 * , b864 ( 1964 ) .",
    "w. kohn and l.j .",
    "sham , phys .",
    "* 140 * , a1133 ( 1965 )",
    ". f. aquilante , t. b. pedersen , v. veryazov and r. lindh , wires comput .",
    "* 3 * 143 ( 2013 ) .",
    "10.1002/wcms.1117 d. ma , g. li manni , l. gagliardi , j. of chem .",
    "phys . * 135 * 044128 , ( 2011 ) .",
    "doi : 10.1063/1.3611401 .",
    "reine simen , helgaker trygve , lindh roland .",
    "multielectron integrals .",
    "wires comput mol sci * 2 * 290 ( 2012 ) .",
    "a.m. kster , j. chem . phys . * 118 * , 9943 ( 2003 ) . b.i .",
    "dunlap , j.w.d .",
    "connolly , j.r .",
    "sabin , j. chem . phys . * 71 * , 4993 ( 1979 ) . m. dupuis , j. rys , and h.f .",
    "king , j. chem .",
    "* 65 * , 111 ( 1976 ) .",
    "o. vahtra , j. almlof , m.w .",
    "feyereisen , chem .",
    "* 213 * 514 ( 1993 ) .",
    "pederson , d.v .",
    "porezag , j. kortus and d.c .",
    "patton , phys .",
    "solidi b * 217 * , 197 ( 2000 ) .",
    "parrish , c.d .",
    "sherrill , e. g. hohenstein , s.i .",
    "l. kokkila , and t. j. martinez , j. chem . phys . * 140 * , 181102 ( 2014 ) .",
    "lambrecht , c. ochsenfeld , j. chem . phys . * 123 * , 184101 ( 2005 ) . j. p. perdew , j. a. chevary , s. h. vosko , k. a. jackson , m. r. pederson , d. j. singh , and c. fiolhais , phys . rev .",
    "b * 46 * , 6671 ( 1992 ) .",
    "j. p. perdew , k. burke , and m. ernzerhof , phys .",
    "lett . * 77 * , 3865 ( 1996 ) .",
    "n. mardirossian and m. head - gordon , j. chem . phys . *",
    "142 * , 074111 ( 2015 ) .",
    "y. zhao , n.e .",
    "schultz , and d.g .",
    "truhlar , j. chem .",
    "theory comput .",
    "* 2 * , 364 ( 2006 ) .",
    "m.r . pederson and k.a .",
    "jackson , phys .",
    "b * 41 * , 7453 ( 1990 ) .",
    "press , william h. ; teukolsky , saul a. ; vetterling , william t. ; flannery , brian p. ( 2007 ) . numerical recipes : the art of scientific computing ( 3rd ed . )",
    "( new york : cambridge university press . isbn 978 - 0 - 521 - 88068 - 8 ) .",
    "perdew and a. zunger , phys .",
    "b * 23 * , 5048 ( 1981 ) .",
    "pederson , a. ruzsinszky , and j.p .",
    "perdew , j. chem . phys . * 140 * , 121105 ( 2014 ) . m.r .",
    "pederson , j. chem .",
    "* 142 * , 064112 ( 2015 ) .",
    "j. sun and m.r .",
    "pederson ( to appear ) ."
  ],
  "abstract_text": [
    "<S> it is tacitly accepted that , for practical basis sets consisting of n functions , solution of the two - electron coulomb problem in quantum mechanics requires storage of o(n@xmath0 ) integrals in the small n limit . </S>",
    "<S> for localized functions , in the large n limit , or for planewaves , due to closure , the storage can be reduced to o(n@xmath1 ) integrals . here </S>",
    "<S> , it is shown that the storage can be further reduced to o(@xmath2 ) for separable basis functions . </S>",
    "<S> a practical algorithm , that uses standard one - dimensional gaussian - quadrature sums , is demonstrated . </S>",
    "<S> the resulting algorithm allows for the simultaneous storage , or fast reconstruction , of any two - electron coulomb integral required for a many - electron calculation , on each and every processor of massively parallel computers even if such processors have very limited memory and disk space . </S>",
    "<S> for example , for calculations involving a basis of 9171 planewaves , the memory required to effectively store all coulomb integrals decreases from 2.8gbytes to less than 2.4 mbytes . </S>"
  ]
}