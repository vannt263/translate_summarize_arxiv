{
  "article_text": [
    "szemerdi and trotter  settling a conjecture of erds  determined the maximal order of magnitude of the number of incidences between @xmath0 points and @xmath1 straight lines of the euclidean plane @xcite .",
    "their result has innumerable applications and several generalizations , e.g. , to pseudo - lines @xcite and families of curves of degree @xmath4 of freedom @xcite .",
    "the importance of the szemerdi - trotter theorem is also shown by the fact that two completely different methods ( or , rather , theories ) have been developed for demonstrating their bound and proving wide - spread generalizations since the publication of the original result .",
    "a probabilistic `` cutting plane '' approach can be found in @xcite , while the `` crossing number method '' in @xcite and @xcite .",
    "the latter is usually considered `` the '' proof of the szemerdi - trotter bound .",
    "extending some applications to a more general setting requires a similar bound for _ complex _ points and lines ( see some examples below ) .",
    "unfortunately , all three existing proofs rely heavily upon the topology of the _ real _ euclidean plane and no natural complex or multidimensional counterparts have been found so far .",
    "the goal of this paper is to prove such a bound and show some applications .",
    "our main result is formulated as follows .",
    "[ main ] there exists an absolute constant @xmath5 such that , for any @xmath0 points and @xmath1 complex lines in the complex plane @xmath3 , the number of incidences of points and lines is at most @xmath6    an equivalent formulation of the szemerdi - trotter theorem gives an upper bound on the number of lines containing at least @xmath7 , @xmath8 , points in the plane .",
    "since the equivalence of the two formulations is solely combinatorial and does not depend on the underlying space ( see  @xcite for a proof ) , it generalizes as well to the complex plane :    [ eqq ] for @xmath0 point in the complex place @xmath9 , and any natural number @xmath10 , the number of complex lines incident to at least @xmath7 points is @xmath11    theorem [ main ] ( and also theorem  [ eqq ] ) is asymptotically tight : for every @xmath1 and @xmath0 , there exists a system of complex points and lines with at least @xmath12 incidences .",
    "erds  @xcite showed that the szemerdi - trotter bound is tight , and there are @xmath0 points and @xmath1 lines in @xmath13 with @xmath12 incidences .",
    "every point @xmath14 and every line @xmath15 , @xmath16 , in this construction can be interpreted as a point @xmath17 and a complex line @xmath15 , @xmath18 , with the same incidence structure .",
    "the proof of theorem  [ main ] can be found in sections  [ out][combl ] . in the remainder of this section , we present three immediate consequences of theorem  [ main ] .",
    "all three results generalize theorems on plane geometry and their proof is based on the szemerdi - trotter bound .",
    "since each of them uses purely combinatorial arguments apart from the szemerdi - trotter bound , they generalize to the complex plane with the same combinatorial proof and our theorem  [ main ] .",
    "the first result is the generalization of a theorem due to beck  @xcite .",
    "there exists an absolute constant @xmath19 such that , for any @xmath0 points in the complex plane , at least one of the following two statements holds true    * there are at least @xmath20 complex lines incident to at least two points , * there is a complex line incident to at least @xmath21 points .",
    "the next result is about sum sets and product sets . given a set @xmath22 , we denote by @xmath23 and @xmath24 the set of all pairwise sums and products , respectively , formed by elements of @xmath25 . elekes  @xcite proved that if @xmath26 then @xmath27 by solymosi  @xcite .",
    "we show the following .",
    "there is an absolute constant @xmath28 such that , for any set @xmath29 of @xmath0 elements , @xmath30    our last result is about point sets in @xmath13 .",
    "it generalizes a theorem of elekes  @xcite from homothetic subsets to _ similar _ ones . for two point sets @xmath31",
    ", we put @xmath32 where @xmath33 means that @xmath25 and @xmath34 are _ similar _ to each other ( i.e. , they are equivalent under a sequence of translation , rotation , and scaling ) .",
    "the maximal number of similar copies of a configuration of @xmath7 points in a set of @xmath0 points in @xmath13 is denoted by @xmath35    there is an absolute constant @xmath36 , such that @xmath37",
    "our proof follows , in some sense , the arguments of szemerdi and trotter .",
    "it has the same schematic structure :    \\(i ) the proof will be by contradiction ;    \\(ii ) we consider a minimal counterexample ( i.e. , for which @xmath38 is minimal ) and show that it must contain a rather regular substructure of points and lines ( see our separation lemma in section  [ sepl ] ) ;    \\(iii ) we state and prove an elaborate version of the covering lemma of szemerdi and trotter  @xcite ( our covering lemma in section  [ covl ] ) ;    \\(iv ) the contradiction follows from a lower bound on the number of intersecting ( crossing ) pairs of lines in the minimal counterexample ( section  [ combl][ss - main ] ) .",
    "there are several principal differences , however , compared to the original szemerdi - trotter proof .",
    "they cover a constant portion of the points by squares but it is not easy to find the appropriate cover in @xmath9 .",
    "they make use of the simple but crucial fact that if a square is dissected into four parts by its diagonals then , for any two points in one quadrant , if we build a square on these points as two opposite corners , a suitable neighborhood of at least one of the other corner points will lie inside the original square .",
    "unfortunately , the natural four - dimensional idea of covering by hypercubes does not have this property .",
    "that is why we need a much more involved covering lemma in the four ( real ) dimensional space @xmath39 .",
    "similar difficulties arise if we want to find appropriate regular structures , like those in our separation lemma .",
    "szemerdi and trotter used the space of directions of lines of the euclidean plane and find a linear transformation that produces two almost orthogonal families of lines . unfortunately again , the space of directions of complex lines is two - dimensional , and thus much more difficult to handle",
    ".    a natural generalization of the szemerdi - trotter theorem ( and our theorem  [ main ] ) would be an upper bound on the number of incidences of points and @xmath40-flats in the @xmath41-dimensional real euclidean space .",
    "[ cony ] we are given @xmath0 points and @xmath1 @xmath40-flats ( @xmath40-dimensional affine subspaces ) in @xmath42 such that any two subspaces intersect in at most one point .",
    "the number of incidences of points and @xmath40-flats is @xmath43    for @xmath44 , this is equivalent to the szemerdi - trotter theorem .",
    "our theorem  [ main ] is a special case for @xmath45 where all @xmath46-flats correspond to complex lines in @xmath9 .",
    "our proof technique does not establish conjecture  [ cony ] for @xmath45 because the separation lemma ( our lemma  [ first ] ) does not seem to extend for arbitrary 2-flats in @xmath42 .",
    "we exploit the geometry of the complex plane only in subsection  [ ssec : cmplx ] , the proof of the separation lemma .",
    "subsections  [ ssec : comb ] and  [ ssec : dis ] use purely combinatorial arguments , and then sections  [ covl ] and  [ combl ] rely exclusively on real euclidean geometry and real linear transformations , and we treat complex lines of @xmath9 as @xmath46-flats of @xmath39 .    in the next subsection we summarize some basic properties of complex lines in the complex plane , which are used in subsection  [ ssec : cmplx ] .",
    "we also point out why this approach does not seem to extend to @xmath46-flats in @xmath39 .",
    "besides the space of complex lines in @xmath3 , we consider the space of directions of complex lines , which we denote by @xmath47 .",
    "the direction of a line @xmath48 @xmath49 is @xmath50 ; the direction of a line @xmath51 @xmath52 is @xmath53 . for a complex line @xmath54 , let @xmath55 denote its direction , and",
    "similarly let @xmath56 denote the multiset of directions of a set @xmath57 of complex lines .",
    "the space of directions @xmath47 is called the grassmannian manifold where @xmath58 and @xmath59 stands for the space of special unitary two - by - two matrices . ] @xmath60 and it can be represented by the complex projective line @xmath61 or the riemann - sphere @xmath62 @xcite . the ( standard ) correspondence between @xmath47 and @xmath62 is defined as follows : we identify every complex direction @xmath63 with a point @xmath64 in the plane @xmath65 of @xmath66 , then a stereographic projection maps every point from the plane @xmath65 to a sphere @xmath67 in @xmath66 ; and the @xmath53 direction is mapped to the point @xmath68 of the sphere . notice that a main circle @xmath69 of the sphere corresponds to the circle of unit slope directions , that is , to directions of the lines @xmath70 with @xmath63 and @xmath71 @xcite .",
    "@xmath60 has an essentially unique invariant metric ( invariant to unitary transformations ) .",
    "the distance @xmath72 between directions of two complex lines @xmath73 and @xmath74 in @xmath9 can be defined in terms of their _ principal angle _",
    "@xmath75 , which is equivalent to the chordal distance in the riemann - sphere representation  @xcite . in this paper",
    ", we always use the chordal metrics of @xmath62 measured in degrees .",
    "for example , if two directions @xmath76 and @xmath77 are _ orthogonal _ , ( i.e. , @xmath78 or @xmath79 and @xmath80 ) , then they correspond to antipodal points in the sphere representation @xmath81 , hence @xmath82 .",
    "the identification @xmath83 , @xmath84 maps complex lines to 2-flats of @xmath39 . in particular , @xmath85 maps the space of complex 1-subspaces @xmath86 to the grassmannian manifold @xmath87 of 2-subspaces in @xmath39 .",
    "@xmath87 has several different invariant metrics ( invariant to orthogonal transformations ) .",
    "all metrics can be defined in terms of the two principle angles between two 2-subspaces  @xcite .",
    "we consider the distance between the directions of two 2-flats in @xmath39 to be the sum of their principle angles . in this way , the distance of two orthogonal 2-subspaces is @xmath88 .",
    "a simple consequence of this notation is that @xmath89 maps a small neighborhood of an @xmath90 into a subset of a neighborhood of @xmath91 .",
    "specifically , we will use later that @xmath89 maps a @xmath92-neighborhood in @xmath60 to a subset of a @xmath93-neighborhood in @xmath87 .",
    "note that the group of non - degenerate complex linear transformations @xmath94 acts on @xmath9 and preserves the point - line incidences .",
    "therefore we use freely these transformations on the complex plane .",
    "@xmath94 also acts on the space of its 1-subspaces @xmath60 .",
    "we use one more property of the space of complex directions in the proof of our separation lemma : two sufficiently small disjoint disks in @xmath60 can be mapped into two small neighborhoods around two orthogonal directions by a nondegenerate linear transformation if the disks are at least a constant ( say , @xmath95 ) distance apart .",
    "@xmath87 does not have this property : two disjoint disks in @xmath87 may contain 2-subspaces incident to a common line , hence no linear transformation can increase their distance above @xmath96 .",
    "this is why the proof technique of szemerdi and trotter does not apply to @xmath46-flats in @xmath39 .",
    "our first main lemma ( separation lemma ) is a straightforward generalization of szemerdi and trotter s result in the plane .",
    "it claims that a hypothetic counterexample to theorem  [ main ] contains a fairly regular ( grid - like ) sub - structure of points and complex lines .",
    "let @xmath97 be a _",
    "system _ of a point set @xmath98 and a line set @xmath99 in the complex plane .",
    "let @xmath100 and @xmath101 denote the number of points and lines , respectively , and let @xmath102 denote the number of point - line incidences . a system @xmath97 is _ critical system _ if @xmath103 is minimal among all systems where @xmath104 with constant @xmath105 .    * ( separation lemma)*[first ] in a critical system @xmath97",
    ", there is a point set @xmath106 and two line sets @xmath107 such that for the constant @xmath108    \\(a ) @xmath109 ;    \\(b ) every point @xmath110 is incident to at least @xmath111 lines from both @xmath112 and @xmath113 ;    \\(c ) there are two orthogonal directions @xmath114 , such that the directions of the lines of @xmath112 and @xmath113 are in the @xmath92-neighborhood of @xmath115 and @xmath116 , resp . , after a non - degenerate complex linear transformation of @xmath9 .",
    "consider a critical system @xmath97 of @xmath0 points and @xmath1 lines in @xmath9 .",
    "first we show that in this hypothetic system , @xmath0 and @xmath1 can not be extremely far from each other , more precisely , either of them is much larger than the square root of the other .",
    "[ alap ] in a critical system @xmath97 , we have @xmath117    by symmetry , it suffices to prove the first inequality .",
    "let @xmath118 denote the number of complex lines incident to the point @xmath119 . by the inequality of quadratic and arithmetic means , we have @xmath120 @xmath121 where the last step follows from @xmath122 .",
    "therefore , by @xmath123 , we have @xmath124 whence the desired inequality .    [ en ] @xmath125    [ enne ] in a critical system @xmath126",
    ", we have @xmath127    our next goal is to show that every point is incident to a large number of lines . for a set @xmath128 of complex lines and a point @xmath129 ,",
    "we denote by @xmath130 the subset of lines from @xmath128 incident to @xmath131 .",
    "let @xmath132 denote the average degree of a point and let let @xmath133 denote the average degree of a line in @xmath97 .",
    "we show that the degree of every point in @xmath98 is at least half of the average .",
    "[ fele ] in a critical system @xmath97 , every @xmath134 is incident to at least @xmath135 lines of @xmath99 ( i.e , @xmath136 ) and every @xmath137 is incident to at least @xmath138 points of @xmath98 .    by symmetry ,",
    "it is enough to prove @xmath136 .",
    "we suppose , by contradiction , that there exists a point @xmath119 incident to less than @xmath135 lines from @xmath99 .    since the system @xmath139 is smaller than the critical system @xmath97 , we have @xmath140 .",
    "this , together with corollary  [ en ] , implies an upper bound on the total number of incidences in the system @xmath97 .",
    "@xmath141 @xmath142 the last inequality is equivalent to either @xmath143 or @xmath144 depending on the value in the maximum . in either case",
    ", the inequality has no integer solution : a contradiction .",
    "denote by @xmath47 the space @xmath145 of directions of complex lines .",
    "the direction of a line @xmath146 is @xmath50 , the direction of a line @xmath147 is @xmath53 .",
    "we represent @xmath47 as the sphere @xmath62 , where a main circle @xmath69 corresponds to the unit slope directions ( cf . , subsection  [ ssec : gr ] ) .",
    "let us denote the two closed hemispheres on the two sides of @xmath69 by @xmath148 and @xmath149 .",
    "we may assume ( after a non - degenerate linear transformation of @xmath9 ) that @xmath150 , @xmath151 , and there is at most one class of parallel lines whose direction lies on @xmath69 .",
    "let @xmath152 and @xmath153 such that @xmath154 and @xmath155 .",
    "note that lines from a class of parallel lines whose direction corresponds to a point in @xmath69 may be in either @xmath156 or @xmath157 .",
    "let @xmath158 and @xmath159 be the set of points incident to at least @xmath160 lines from both @xmath156 and @xmath157 .",
    "we split the points of @xmath161 into two subsets , let @xmath162 and let latexmath:[$p_2= \\",
    "{ p \\in p \\setminus p_0 :     in a critical system @xmath97 , we have @xmath164 .",
    "let @xmath165 and let @xmath166 denote the number of incidences of the system @xmath167 , that is , the number of incidences of @xmath168 and _ all _ lines of @xmath99 , for @xmath169 .",
    "suppose , by contradiction , that @xmath170 .",
    "the systems @xmath171 , @xmath172 , and @xmath173 are all smaller than the critical system @xmath97 .",
    "this implies that the bound of theorem  [ main ] holds for each of these three systems .",
    "taking into account the incidences of the systems @xmath174 and @xmath175 , as well , we obtain : @xmath176 this inequality has no roots in the interval @xmath177 $ ] , ( the smallest root is approximately @xmath178 ) .",
    "this proves that @xmath179 .",
    "let @xmath180 denote the set of non - degenerate linear transformations of @xmath9 that act as an automorphism on each of @xmath69 , @xmath181 , and @xmath182 .",
    "relying on the definitions of @xmath156 , @xmath157 , @xmath183 , and @xmath184 , we formulate a lemma that immediately implies the separation lemma .",
    "[ finale ] there exists a point set @xmath185 of size at least @xmath186 and two line sets @xmath187 and @xmath188 such that for every point @xmath189 , @xmath131 is incident to at least @xmath190 lines from @xmath112 and from @xmath113 , respectively , and the directions of the lines of @xmath112 and @xmath113 are in the @xmath92 neighborhood of two orthogonal directions of @xmath47 after a transformation @xmath191 .",
    "we prove lemma  [ finale ] in the end of this section after several small steps .",
    "one difficulty in finding sets @xmath112 and @xmath113 is that the boundary of the two hemispheres @xmath148 and @xmath149 is a one - dimensional manifold : it is possible that for every point @xmath192 , the directions of most of the incident lines are very close the boundary @xmath69 .",
    "this undesirable property of a point @xmath119 is captured in definition  [ def : na ] below .",
    "[ def : na ] consider a direction @xmath193 .",
    "a point @xmath134 is called an _ @xmath194-point _ , if the directions of at least @xmath195 lines of @xmath196 and at least @xmath197 lines of @xmath198 lie in the open disk in @xmath47 with radius @xmath93 and center at @xmath199 .",
    "[ cello ] there is a set @xmath200 of at least @xmath201 points and a transformation @xmath191 such that no point of @xmath202 is a @xmath194-point for any @xmath193 after applying @xmath203 to @xmath9 .    for the proof of lemma  [ cello ] ,",
    "we initiate a recursive algorithm . put @xmath204 , @xmath205 , and @xmath206 , @xmath207 .",
    "we obtain @xmath208 ( reps . , @xmath209 ) from @xmath156 ( resp .",
    ", @xmath157 ) by deleting at most one class of parallel lines , that is , lines whose direction lies in @xmath69 .",
    "every @xmath210 is incident to at least @xmath211 lines of @xmath208 and at least @xmath212 lines of @xmath209 .",
    "setting @xmath213 , the system @xmath214 satisfies the following four properties .",
    "[ inv:14 ] we have @xmath215 , @xmath216 , and @xmath217 such that    1 .",
    "@xmath218 , where @xmath219 ; 2 .   @xmath220 and @xmath221 ; 3 .",
    "@xmath222 , where @xmath223 ; 4 .   for every @xmath224 , we have @xmath225 and @xmath226 , where @xmath227 .",
    "the following lemma provides an induction on the systems @xmath228 under certain condition .",
    "( notice that lemma  [ cello ] follows immediately if this condition is not satisfied and @xmath229 . )    [ iterativ ] if a system @xmath230 , @xmath231 , satisfies the sparse invariant but there is no @xmath191 such that after applying @xmath203 at least @xmath232 points are not @xmath194-points for any @xmath233 , then there are sets @xmath234 , @xmath235 , and @xmath236 satisfying the sparse invariant .    in order to prove lemma  [ iterativ ] , we define a few more concepts and determine a transformation @xmath191 in lemma  [ triple ] below .",
    "we partition the circle @xmath69 into three arcs : a half circle @xmath237 $ ] , and two quarter circles @xmath238 $ ] , and @xmath239 $ ] ( see figure  [ recurse ] ) .",
    "we define two new properties for every point @xmath240 with respect to an arc @xmath241 .    _",
    "_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ a point @xmath240 is an @xmath242-point , if it is an @xmath194 point for an @xmath193 and @xmath199 is in the @xmath93-neighborhood of the arc @xmath241 .",
    "let @xmath243 be the projection to @xmath69 along main halfcircles incident to @xmath244 and @xmath245 .",
    "a point @xmath240 is a @xmath246-point , if the projection of the direction of at least @xmath247 lines of @xmath248 are in @xmath25 .",
    "_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _",
    "_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _    let @xmath249 and @xmath250 denote the number of @xmath242-points and @xmath246-points in the system @xmath251 . since @xmath252 ,",
    "every point @xmath240 is a @xmath253-point for at least one of @xmath254 .",
    "[ triple ] consider a system @xmath251 satisfying the sparse invariants .",
    "there is a transformation @xmath191 which assures @xmath255 simultaneously for @xmath254 .",
    "for every @xmath256 , @xmath257 , we define the transformation @xmath258 for every vector @xmath259 , the transformation @xmath260 scales the component parallel to @xmath261 by @xmath262 and the perpendicular component by @xmath263 .",
    "note that @xmath264 because a vector @xmath265 has unit slope ( that is , @xmath266 ) if and only if so does @xmath267 .    for every @xmath193",
    ", we define @xmath268 , where @xmath269 @xmath270 is a unary transformation ( i.e. , it is an isometry on the sphere @xmath271 ) and @xmath272 .    consider the orbit of elements of @xmath47 under @xmath273 for all @xmath274 .",
    "these orbits are the main halfcircles between @xmath275 and its antipodal @xmath276 .",
    "if we increase @xmath277 continuously from @xmath278 to @xmath279 then the image of every point ( except for @xmath279 and its antipodal @xmath280 ) will move continuously toward @xmath281 along a main halfcircle .",
    "the directions of lines of @xmath282 will enter any small neighborhood of @xmath279 .",
    "+ _ proof of lemma  [ triple ] .",
    "_ we build @xmath203 as a combination of a @xmath260 and a @xmath283 for some @xmath277 and @xmath284 .",
    "first we apply a @xmath273 with a @xmath277 such that exactly @xmath285 points of @xmath286 are @xmath287 points .",
    "such a @xmath277 exists because every point of @xmath240 becomes a @xmath287-point for a sufficiently big @xmath277 , @xmath288 .",
    "( as we increase @xmath277 continuously , possibly several points of @xmath286 become @xmath287-points at the same time .",
    "we can model this event as if these points change their status one by one . ) in a second step , we apply a @xmath289 with appropriate @xmath290 .",
    "note that for any @xmath290 , the transformation @xmath283 is an automorphism on the hemisphere @xmath291 and so the set of @xmath287 points remains fixed .",
    "we can choose a @xmath284 , @xmath290 , such that the remaining @xmath292 points are balanced between @xmath293 and @xmath294 .",
    "+ we are now ready to prove the iteration , lemma  [ iterativ ] .",
    "consider the system @xmath251 satisfying the sparse invariants .",
    "assume that after any transformation @xmath191 , at least @xmath295 points of @xmath286 are @xmath194-points for some @xmath199 .",
    "we apply the transformation @xmath191 provided by lemma  [ triple ] such that @xmath255 for @xmath254 .",
    "observe that if a @xmath253-point is also an @xmath194-point for some @xmath233 then @xmath199 must be in the @xmath93 neighborhood of arc @xmath296 and so @xmath131 is an @xmath297-point .",
    "this implies that @xmath298 for @xmath254 .",
    "consider the embedding of @xmath47 into a unit sphere of the euclidean three - space centered at the origin ( @xmath299 ) .",
    "for every @xmath300 , let @xmath301 be the plane in @xmath66 whose normal vector is parallel to the @xmath66-embedding of @xmath199 and that partitions the multiset of ( the @xmath66-embeddings of ) the directions @xmath302 into two equal parts .",
    "if @xmath199 is in generic position , then @xmath301 passes through the embeddings of at most one direction of @xmath302 .",
    "let @xmath303 be three generic points at or in the very small neighborhood of the midpoints of the arcs @xmath304 , @xmath305 , and @xmath306 ( that is , the directions @xmath307 , @xmath308 , and @xmath309 ) , respectively . as a shorthand notation ,",
    "let @xmath310 , and @xmath311 .",
    "along with the partition @xmath312 , we define another partition @xmath313 , such that for every @xmath254 , @xmath314 and the endpoints of @xmath315 are the centers of @xmath316 and @xmath317 . more specifically , @xmath318 $ ] , @xmath319 $ ] , and @xmath320 $ ] .",
    "we can now define the sets @xmath321 , @xmath322 , and @xmath323 as follows .    * if there is a @xmath324 such that @xmath325 does not intersect the @xmath93-neighborhood of @xmath296 ( see figure  [ recurse ] , right , for @xmath326 ) , then let @xmath327 is @xmath297-point@xmath328 .",
    "let @xmath322 ( resp . ,",
    "@xmath329 be the set of lines from @xmath330 ( resp .",
    ", @xmath331 ) whose direction are embedded in @xmath66 on the same side of the plane @xmath325 as @xmath296 . *",
    "if @xmath325 intersects the @xmath93-neighborhood of @xmath296 for every @xmath324 , then consider the arc @xmath332 for @xmath333 where @xmath334 is maximal .",
    "let @xmath335 is an @xmath336-point@xmath328 .",
    "let @xmath322 ( resp . ,",
    "@xmath323 ) be the set of lines from @xmath330 ( resp .",
    ", @xmath331 ) whose directions are embedded in @xmath66 on the same side of the plane @xmath337 as @xmath332 .",
    "it is easy to check that @xmath321 , @xmath322 , and @xmath323 satisfy all four sparse invariants .",
    "we may suppose without loss of generality that @xmath338 .",
    "we count the number @xmath166 of incidences of the system @xmath339 . on one hand ,",
    "every point is incident to at least @xmath340 lines and so @xmath341 . on the other hand ,",
    "the system @xmath339 is smaller than the critical system @xmath97 and so the szemerdi - trotter bound applies .",
    "@xmath342    assuming @xmath108 and @xmath343 , we have @xmath344 and @xmath345 .",
    "we can bound each term in inequality  ( [ ( 2 ) ] ) as follows : @xmath346 inequality ( [ ( 2 ) ] ) is written as @xmath347 this inequality is false for @xmath348 : a contradiction .",
    "therefore there is an index @xmath349 such that at least @xmath232 points in the system @xmath251 are not @xmath194-points for any @xmath193 after an appropriate transformation @xmath191 .",
    "since @xmath350 for every @xmath343 , lemma  [ cello ] follows .",
    "+ we cover @xmath47 with open disks of diameter @xmath351 .",
    "denote the minimal number of covering disks by @xmath352 .",
    "we give a rough upper estimate for @xmath353 .",
    "place greedily disjoint disks of radius @xmath354 on @xmath47 . by a volume argument , the number of disks is less than @xmath355 .",
    "disks with the same center and radius @xmath351 cover @xmath47 .",
    "we conclude that @xmath356 .",
    "subdivide both @xmath148 and @xmath149 into at most @xmath357 subsets of diameter less then @xmath351 . let @xmath358 and @xmath359 , respectively , denote the families of these subsets .    consider the subdivision @xmath358 and @xmath359 defined above . by lemma  [ cello ] , there is a transformation @xmath191 and a set @xmath360 of @xmath201 points such that the points of @xmath361 are not @xmath194-points for any @xmath193 after applying @xmath203 . to every @xmath362 , we assign two small sets @xmath363 and @xmath364 such that    * the directions of at least @xmath365 lines of @xmath196 and @xmath198 are in @xmath366 and in @xmath367 , resp . ;",
    "* the distance of @xmath368 and @xmath369 is at least @xmath95 .",
    "first we choose @xmath370 and @xmath371 such that at least @xmath372 lines of @xmath196 and @xmath198 are in @xmath366 and in @xmath367 , respectively .",
    "if their distance is at least @xmath373 then let @xmath374 and @xmath375 .",
    "otherwise let @xmath376 be point on @xmath69 equidistant from @xmath377 and @xmath378 .",
    "both the @xmath373-neighborhood of @xmath377 in @xmath149 and the @xmath373-neighborhood of @xmath378 in @xmath148 are contained in the disk @xmath379 of radius @xmath93 centered at @xmath380 .",
    "since @xmath131 is not an @xmath381-point , @xmath196 or @xmath198 has at least @xmath382 lines whose directions lie outside @xmath379 .",
    "assume w.l.o.g .",
    "that @xmath196 has this property .",
    "choose @xmath363 such that it is not completely in @xmath379 and the directions of at least @xmath365 lines of @xmath196 are in @xmath366 ; and let @xmath375 .",
    "for at least @xmath383 points of @xmath361 , we have chosen the same @xmath363 and @xmath364 .",
    "let @xmath202 be the set of these points .",
    "since @xmath357 , we have @xmath384 .",
    "finally , we apply a linear transformation on @xmath9 ( not necessarily from @xmath184 ) that maps @xmath368 and @xmath369 into the @xmath92-neighborhood of two perpendicular directions @xmath385 and @xmath386 .",
    "this can be done because the chordal metrics of @xmath387 is equivalent to the metrics of @xmath86 .",
    "( e.g. , we can apply @xmath388 where @xmath389 is the bisector of two representative points from @xmath366 and @xmath367 with an appropriate @xmath257 : the points of @xmath366 and @xmath367 move along main halfcircles through @xmath390 . when the representative points of the two sets are antipodal , the diameter of the image of either set is below @xmath92 .",
    "we denote the two classes of lines by @xmath112 and @xmath113 , respectively .",
    "our second main lemma ( covering lemma ) is an elaborate version of a lemma of szemerdi and trotter  @xcite .",
    "it states that given a point set in @xmath391 , a constant fraction of the points can be enclosed into non - overlapping axis - aligned cubes such that the points are approximately evenly distributed among them . before formulating the covering lemma",
    ", we introduce the concepts of @xmath284-_side - cube_s and _ shift - graph_s .    in our terminology ,",
    "a _ cube _ is an axis - aligned hypercube in @xmath391 ; a cube is always full - dimensional if not stated otherwise .",
    "we interpret the directions `` above '' and `` below '' in @xmath391 along the vector @xmath392 .",
    "let @xmath393 be a cube in @xmath391 , let @xmath131 be the center of a @xmath394-dimensional face of @xmath393 , and @xmath284 an integer . apply a central scaling to @xmath393 with center @xmath131 and with ratio @xmath395 .",
    "the resulting cube is a _ @xmath284-side - cube _ of @xmath393 ( figure  [ f1 ] ) .",
    "a cube has a @xmath284-side - cube along each of its sides .",
    "since every cube in @xmath396 has @xmath41 sides , every cube has @xmath41 @xmath284-side - cubes .",
    "we say that the _ orientation _ of a @xmath284-side - cube @xmath397 of @xmath393 is the orientation of the vector pointing from the center of @xmath393 to that of @xmath397 .",
    "consider a cube @xmath393 in @xmath391 .",
    "let @xmath398 be the translate of @xmath393 by vector @xmath399 , where @xmath400 is the edge length of @xmath393 .",
    "let @xmath401 be the @xmath284-side - cube of @xmath393 along the bottom side of @xmath393 .",
    "[ def - graph ] we are given a set @xmath402 of non - overlapping cubes .",
    "the _ shift - graph _",
    "@xmath403 is a directed graph : the nodes of @xmath403 correspond to the elements of @xmath402 . the graph @xmath403 has a directed edge @xmath404 if and only if    1 .",
    "@xmath405 and @xmath406 have a common interior point , 2 .",
    "there is a vertical segment connecting the bottom side of @xmath407 and the top side of @xmath408 which does not intersect any other cube of @xmath402 .",
    "( figure  [ tr ] . )    [ cover ] * ( covering lemma ) * given a set @xmath409 of @xmath0 points in @xmath391 , an integer @xmath284 , and an integer @xmath410 , there exists a set @xmath402 of non - overlapping cubes and a permutation of the coordinate axes such that    1 .",
    "the number of cubes is @xmath411 ; 2 .   for every @xmath412 ,",
    "we have @xmath413 ; 3 .",
    "the shift graph @xmath403 has at most @xmath414 edges .",
    "fix a unit distance such that the minimal distance in the point set @xmath98 be greater than the diameter of a unit cube .",
    "fix a cartesian coordinate - system @xmath391 such that none of the coordinates of any point of @xmath98 is an integer .",
    "a cube is called a _ grid - cube _ if all coordinates of all vertices are integers .",
    "consider a subdivision @xmath415 of @xmath391 into grid - cubes of unit side length . by",
    "the choice of the coordinate system , every unit cube contains at most one point of @xmath98 and every point of @xmath98 is in the interior of a cube of @xmath415 .",
    "we describe an algorithm , algorithm  [ alg ] , for an input of @xmath0 points in @xmath391 and an integer @xmath284 .",
    "algorithm  [ alg ] proceeds in a finite number of _",
    "phases_. a phase @xmath416 _ processes _ every cube of @xmath417 that contains a point of @xmath98 , and it determines a subdivision @xmath418 .",
    "every @xmath417 is a lattice subdivision of @xmath391 into congruent grid cubes .",
    "one cube of @xmath418 consists of @xmath419 cubes of @xmath417 , where @xmath420 .",
    "algorithm  [ alg ] terminates at a phase @xmath421 , when a single cube of @xmath417 contains @xmath98 .",
    "_ processing _ a cube @xmath422 means that algorithm  [ alg ] labels @xmath393 or other cubes within @xmath393 with one of the four special labels _ green _ , _ yellow _ , _ blue _ , and _",
    "selected_. algorithm  [ alg ] can remove the labels _ green _ and _ yellow _ ; the labels _ selected _ and _ blue _ are permanent .",
    "* * green cubes . * in phase @xmath423 ,",
    "algorithm  [ alg ] may place some cubes into a set @xmath424 and label them _",
    "green_. green cubes are disjoint , every green cube contains at least @xmath4 points and no special cube . in phase @xmath425 ,",
    "a constant fraction cubes in @xmath426 become side cubes of selected cubes , and the rest of them are unlabeled .",
    "* * yellow cubes . * for every green cube @xmath427 , algorithm  [ alg ] places an enclosing cube @xmath428 ( possibly @xmath429 ) into a set @xmath430 and labels it _",
    "yellow_. if a green label is removed from @xmath431 then the corresponding yellow label is also removed from @xmath393 .",
    "* * selected cubes .",
    "* algorithm  [ alg ] inductively places cubes into @xmath432 and labels them _ selected_. selected cubes are disjoint , and every @xmath433 contains exactly one green cube as side - cube , and no other special cube . * * blue cubes . *",
    "some cubes are placed into a set @xmath434 and labeled _",
    "blue_. blue cubes form a hierarchical structure : a blue cube contains either a unique cube from @xmath432 or at least two non - overlapping blue cubes .    in every phase @xmath416 ,",
    "algorithm  [ alg ] processes cubes of @xmath435 and then determines @xmath418 . for every subdivision @xmath417 , there are @xmath419 lattice subdivisions such that every cube of @xmath418 consists of @xmath419 cubes of @xmath417 : algorithm  [ alg ] chooses one of them to be @xmath418 .    at the end of each phase @xmath416 , a cube @xmath428 can be in one of the following six states .",
    "initially , in phase @xmath436 , every cube @xmath437 is in state @xmath438 .",
    "each state specifies the special cubes in @xmath393 and the cardinality @xmath439 .",
    "we consider only the maximal ( for inclusion ) special cubes contained in @xmath393 , special cubes contained in another special cube within @xmath393 are not considered .",
    "the cardinality @xmath440 corresponding to the state of a cube do not take into account any point that has ever been in a special cube ( except for @xmath393 itself ) because algorithm  [ alg ] deletes every point lying in special cubes at the end of every phase .",
    "( point deletions are permanent , and not revoked when green or yellow labeled are removed ) .",
    "* @xmath393 is not special , it contains no special cubes , and @xmath441 ; * @xmath442 , @xmath443 , @xmath393 contains no other special cube , and @xmath444 ; * @xmath442 , @xmath445 , @xmath393 contains one maximal blue cube , it contains one cube @xmath446 , and @xmath447 ; * @xmath393 is not special , @xmath393 contains one maximal blue cube , no cube of @xmath430 , and @xmath448 ; * @xmath449 , @xmath393 contains exactly one maximal cube from @xmath432 , and @xmath450 ; * @xmath449 , @xmath393 contains at least two maximal blue cubes , and @xmath451 ;    for every cube @xmath428 containing a point of @xmath98 , algorithm  [ alg ] assigning @xmath393 to one of the six states based on the states of the @xmath419 sub - cubes of @xmath393 from the previous subdivision @xmath452 and on the cardinality @xmath440 .",
    "( all empty cubes of @xmath417 are , by default , in state @xmath438 . )",
    "a step when a yellow cube @xmath393 and the enclosed green cube @xmath431 are unlabeled corresponds to a state transition for the cubes @xmath393 . for a cube @xmath428 , we summarize the states of the @xmath419 subcubes of @xmath393 in @xmath452 by a shorthand notation @xmath453 saying that @xmath393 consists of @xmath454 subcubes in state @xmath455 , @xmath456 ( hence @xmath457 )",
    ". the assignment of a cube @xmath393 to state @xmath458 is denoted by @xmath459 .",
    "we state one more simple proposition before we proceed with algorithm  [ alg ] .",
    "[ ppp ] let @xmath428 and @xmath460 such that @xmath461 and @xmath462 ( that is , @xmath463 is a refinement of @xmath417 ) .",
    "then @xmath464 is the union of at most @xmath465 ( possibly overlapping ) cubes .",
    "the hyperplanes along the faces of @xmath466 dissect @xmath464 into at most @xmath465 non - overlapping axis - aligned boxes .",
    "it is enough to show that each such box can be covered by a cube within @xmath467 .",
    "consider one such box @xmath468 .",
    "let @xmath469 , @xmath470 , be the smallest grid - cube containing both @xmath466 and @xmath468 .",
    "let @xmath400 be a longest edge of @xmath468 that is perpendicular to the common face @xmath471 of @xmath466 and @xmath468 .",
    "since the lower dimensional cube @xmath471 has the same edge length as @xmath466 and @xmath466 is from a subdivision @xmath463 , we conclude that @xmath400 is a longest edge of @xmath468 .",
    "let @xmath472 be the hyperplane perpendicular to @xmath400 through @xmath471 .",
    "necessarily , @xmath472 separates @xmath466 and @xmath468 . denoting by @xmath473 the halfspace of @xmath472 containing @xmath468",
    ", the axis - aligned box @xmath474 contains @xmath468 but its _ shortest _ edge is @xmath400 .",
    "therefore , @xmath468 can be encapsulated into a cube within @xmath474 .",
    "[ alg ] input : @xmath98 , and a coordinate system .",
    "+ set @xmath475 , @xmath476 , @xmath477 , @xmath478 , and @xmath479 .",
    "let @xmath480 denote the cube subdivision where every unit grid - cube is subdivided into @xmath419 congruent cubes , each of which is at state @xmath438 .",
    "+ until not all points of @xmath98 are in a single cube of @xmath417 , do :    1 .",
    "put @xmath481 .",
    "let @xmath482 and @xmath483 ; 2 .   for every @xmath428 where @xmath484 do a.   if @xmath485 and @xmath486 , then @xmath487 . b.   if @xmath485 and @xmath488 , then @xmath489 .",
    "for this let @xmath490 and @xmath491 . c.   [ stepp ] if @xmath492 or @xmath493 and @xmath494 , then @xmath495 .",
    "for this , let @xmath466 be the subcube of @xmath393 in state @xmath496 .",
    "let @xmath491 and @xmath497 where @xmath498 is a cube chosen from the @xmath499 cubes provided by proposition  [ ppp ] such that @xmath500 .",
    "d.   if @xmath492 or @xmath501 and @xmath502 , then @xmath503 .",
    "e.   if @xmath504 , then @xmath505 . for this , let @xmath431 be the subcube of @xmath393 in state @xmath506 .",
    "let @xmath507 and @xmath508 where @xmath509 is any cube whose @xmath284-side - cube is @xmath431 .",
    "f.   if @xmath510at least two of @xmath511 or @xmath512anything else , then @xmath513 . for this , let @xmath514 .",
    "g.   [ stepp+ ] if @xmath515 or @xmath516 , then @xmath513 . for this , let @xmath431 and @xmath466 be the subcubes of @xmath393 in states @xmath506 and @xmath517 , respectively .",
    "let @xmath518 and let @xmath519 where @xmath520 is a cube whose @xmath284-side - cube is @xmath431",
    ". exists : one of the bounding hyper - planes of @xmath431 separates @xmath431 from @xmath466 .",
    "let this hyperplane be the common face of @xmath431 and @xmath521 .",
    "] h.   [ stepp++ ] if @xmath522 , then @xmath513 .",
    "for this , let @xmath431 and @xmath466 be the green and maximal blue cubes enclosed in the yellow subcube of @xmath393 .",
    "let @xmath523 and let @xmath524 where @xmath520 is a cube whose @xmath284-side - cube is @xmath431.@xmath525 3 .",
    "choose @xmath418 out of the @xmath419 possibilities such that at least @xmath526 portion of all cubes of @xmath430 are in central position within a cube of @xmath527 .",
    "[ step4 ] for every cube @xmath528 do : let @xmath529 .",
    "5 .   for every cube @xmath442 which is",
    "_ not _ in central position in @xmath418 and for the corresponding @xmath530 , @xmath427 , do : let @xmath531 and let @xmath532 .",
    "( the unlabeling incurs a state transition for @xmath393 : if @xmath393 is in state @xmath506 then @xmath487 ; if @xmath393 is in state @xmath533 then @xmath534 . as a result ,",
    "every yellow subcube of a @xmath535 is in central position within @xmath418 . )",
    "output : @xmath432 .",
    "let @xmath389 and @xmath536 denote the total number of blue and selected cubes , respectively , at the end of algorithm  [ alg ] .",
    "let @xmath537 denote the total number of cubes that were ever labeled green during algorithm  [ alg ] .",
    "we define a rooted tree graph on the blue cubes : the vertices correspond to the blue cubes , a cube @xmath538 is the _ child _ of @xmath408 if and only if @xmath539 . the leaves of this tree correspond to blue cubes containing a unique cube of @xmath540 .",
    "so the tree has @xmath536 leaves .",
    "every intermediate node ( state @xmath541 ) has at least two children .",
    "we have @xmath542 because in a binary tree , the number of leaves exceeds the number of intermediate nodes .    in algorithm",
    "[ alg ] , at least @xmath543 yellow cubes are not deleted and placed into central position in the next subdivision . every yellow cube in central position contained a green cube which is encapsulated in a unique blue cube , hence @xmath544 .",
    "we give an upper bound on the total number of points in terms of @xmath536 by accounting for the points deleted in step  [ step4 ] of the algorithm .",
    "for every blue cube ( in states @xmath545 and @xmath541 ) , we deleted at most @xmath546 points . for every yellow cube ( states @xmath506 and @xmath533 ) , we deleted at most @xmath547 points . finally , at the last phase the cube containing @xmath98 contains at most @xmath548 points that are not wrapped in any special cube ( state @xmath549 ) .",
    "therefore , using @xmath550 ,    @xmath551 @xmath552 @xmath553 @xmath554    finally , a @xmath284-side - cube can have @xmath41 possible orientations .",
    "let @xmath402 be the set of cubes from @xmath432 with the most frequent orientation .",
    "we can permute the coordinate axes such that the @xmath284-side - cubes in @xmath402 lie along the bottom side .",
    "the cubes of @xmath402 satisfy properties 1 and 2 of lemma  [ cover ] .",
    "they number of cubes is @xmath555 , if @xmath556 .",
    "it remains to verify that the shift graph @xmath403 has at most @xmath414 edges .",
    "we show that the in - degree of every node in @xmath403 is at most one .",
    "suppose that @xmath403 has a directed edge @xmath404 . by definition , @xmath557 and @xmath406 overlap .",
    "since @xmath538 and @xmath408 are interior disjoint , necessarily , @xmath538 is above @xmath408 and @xmath407 is bigger than @xmath408 .",
    "notice that both @xmath538 and @xmath408 were selected in algorithm  [ alg ] .",
    "let @xmath558 be the minimal blue cube containing @xmath538 ( with possibly @xmath559 ) . recall that @xmath560 and @xmath407 lies in a yellow cube of @xmath452 which is in central position within @xmath561 . therefore , if @xmath562 intersects @xmath406 , then @xmath563 .",
    "that is , @xmath561 contains a blue cube .",
    "this implies that @xmath538 was placed into set @xmath432 in step  [ stepp+ ] or step  [ stepp++ ] of algorithm  [ alg ] . since @xmath407 is bigger than @xmath408 and so the edge - length of @xmath538 is at least @xmath564 times bigger than that of @xmath538 . since the projection of @xmath565 and @xmath408 to a hyperplane @xmath566 intersect",
    ", the projection of @xmath407 contains that of @xmath408 .    now assume , by contradiction , that there is a cube @xmath567 , @xmath568 , such that @xmath569 is an edge of @xmath403 . on one hand , @xmath570 can not be above @xmath538 because every vertical segment connecting the lower side of @xmath570 and the upper side of @xmath408 intersects the interior of @xmath538 ( cf . ,",
    "part ( 2 ) of definition  [ def - graph ] ) . on the other hand",
    ", @xmath570 can not be below @xmath561 because then @xmath570 lies in @xmath561 and by symmetry every vertical segment connecting the lower side of @xmath407 and the upper side of @xmath408 would intersect @xmath570 .",
    "therefore , @xmath404 is the only ingoing edge for @xmath408 in the graph @xmath403 .",
    "we combine the separation lemma and the covering lemma in lemma  [ last ] .",
    "note that the @xmath39-embeddings of two non - parallel complex lines intersect in a single point .",
    "a _ crossing _ in @xmath39 is a pair of @xmath46-flats in @xmath39 with exactly one intersection point .    *",
    "( combination lemma)*[last ] we are given a set @xmath202 of @xmath0 points and two sets @xmath112 and @xmath113 of 2-flats in @xmath571 such that the direction of elements of @xmath112 and @xmath113 are in the @xmath93-neighborhood of two orthogonal 2-dimensional subspaces @xmath572 and @xmath573 , resp . , and we are also given a parameter @xmath574 , @xmath575 .",
    "apply lemma [ cover ] to @xmath202 with parameters @xmath587 and @xmath588 in @xmath571 .",
    "there is a set @xmath402 of @xmath589 non - overlapping cubes such that there are at least @xmath587 points of @xmath202 in a @xmath279-side - cube .",
    "we assume that this special side cube of every @xmath393 is the lower side - cube @xmath590 ( our argument is analogous for any other position of the side - cubes ) .",
    "we construct @xmath576 by choosing a set @xmath591 for at least half of the cubes in @xmath402 .",
    "fix a cube @xmath412 and denote by @xmath592 the hyperplane through its lower face ( i.e. , the common face of @xmath393 and its @xmath279-side - cube @xmath590 ) .",
    "consider two points @xmath593 and let @xmath594 .",
    "notice that @xmath40 is at most twice as long as the side length of @xmath590 because @xmath590 is in @xmath39 .",
    "let @xmath595 and @xmath596 ( reps . ,",
    "@xmath597 and @xmath598 ) be two 2-flats of direction @xmath115 and @xmath116 incident to @xmath131 ( resp . , @xmath400 ) .",
    "denote the two intersection points by @xmath599 and @xmath600 . @xmath601 and @xmath602 are located at two antipodal points of the thales - sphere ( @xmath603 ) over @xmath604 .",
    "the diameter of the thales - sphere is @xmath40 , therefore the part of the thales - sphere above @xmath592 lies completely in @xmath393 .",
    "hence , at least one of @xmath601 and @xmath602 is in the cube @xmath393 , and also in @xmath605 .",
    "observe that the crossing pairs @xmath606 and @xmath607 intersect in the balls @xmath608 and @xmath609 of radius @xmath610 centered at @xmath601 and @xmath602 . indeed , denote by @xmath611 the intersection point of some @xmath612 and @xmath613 .",
    "consider the closed polygonal curve @xmath614 .",
    "its four sides are in the 2-flats @xmath615 and @xmath616 , respectively . by definition of the metrics of 2-subspaces in @xmath39 , @xmath617 and @xmath618 .",
    "whence @xmath619 .",
    "ideally , at least one of @xmath608 and @xmath609 lies entirely above @xmath592 and then the intersection points in that ball lie in the interior of @xmath620 .",
    "if this is the case for _ every _ pair @xmath621 , then let @xmath622 and @xmath623 , and properties _ 2 _ and _ 3 _ of lemma  [ last ] are satisfied for @xmath468 .",
    "unfortunately , it is possible that for some @xmath621 , both @xmath608 and @xmath609 intersects the hyperplane @xmath592 and some of the intersection points lie outside @xmath620 .",
    "two 2-flats of direction @xmath115 and @xmath116 intersect the hyperplane @xmath592 in lines of direction @xmath624 and @xmath625 . if both @xmath608 and @xmath609 intersects @xmath592 , then @xmath131 and @xmath400 are in a @xmath626-neighborhood of a 2-flat of direction @xmath627 lying in @xmath592 .",
    "consider the shift graph @xmath403 .",
    "let @xmath628 be the set of cubes in @xmath402 whose out - degree is @xmath278 or @xmath279 in @xmath629 . by the covering lemma ,",
    "@xmath403 has @xmath414 edges and so at least half of the nodes have out - degree @xmath278 or @xmath279 .",
    "we have @xmath630 regions .    if the out - degree of @xmath631 in @xmath403 is @xmath278 , then we associate a set @xmath632 and @xmath633 to @xmath393 . the properties",
    "_ 2 _ and _ 3 _ of lemma  [ last ] are satisfied for @xmath468 because @xmath634 contains at least one of @xmath608 and @xmath609 in its interior .",
    "consider a cube @xmath635 whose out - degree is one in @xmath403 and let @xmath636 be the cube such that @xmath404 is an edge of @xmath403 .",
    "project the point set @xmath637 and the cube @xmath408 to the hyperplane @xmath592 by @xmath638 , @xmath639 . the planes through the faces of the @xmath640-dimensional cube @xmath641 partition @xmath642 into at most @xmath643 3-dimensional boxes .",
    "one of them , @xmath397 , contains at least @xmath4 points of @xmath644 ( see figure  [ fig : cube ] ) .",
    "let @xmath645 . to @xmath635 , we associate a pair @xmath646 such that @xmath647 . for the choice of @xmath468 , we distinguish two cases :    1 .   if @xmath648 , then let @xmath468 be the union of @xmath649 and the region below @xmath538 and above the hyperplane through the lower face of @xmath650 .",
    "2 .   if @xmath651 , then let @xmath652 be a hyperplane such that the plane @xmath653 separates @xmath654 and @xmath397 in @xmath592 .",
    "it defines a halfspace @xmath655 containing @xmath397 .",
    "let @xmath468 be the union of @xmath656 and @xmath657 .",
    "we show that for any pair @xmath583 , at least one of the balls @xmath608 and @xmath609 lie entirely in @xmath468 in both cases .",
    "first we consider case ( a ) : if neither ball is entirely in @xmath649 , then @xmath131 and @xmath400 are in the @xmath626-neighborhood of a plane in @xmath592 .",
    "the distance @xmath658 is less than twice the side length of the cube @xmath397 .",
    "so both balls lie in the region above the hyperplane through the lower face of @xmath650 .",
    "next we consider case ( b ) .",
    "assume that @xmath652 is orthogonal to @xmath659 ( we argue analogously , if @xmath652 is orthogonal to @xmath660 or @xmath661 ) .",
    "the points @xmath601 and @xmath602 are antipodal in the thales sphere of @xmath131 and @xmath400 . if neither @xmath608 nor @xmath609 lies in the interior of @xmath468 , then both balls intersect both @xmath592 and @xmath652 .",
    "this is possible only if @xmath131 and @xmath400 are in the @xmath626-neighborhood of two 2-flats : one of direction @xmath662 and another of direction @xmath663 .",
    "the diameter of the intersection of two such neighborhoods is strictly less than @xmath40 .",
    "a contradiction : @xmath40 is the distance of @xmath131 and @xmath400 , so @xmath131 and @xmath400 can not be in both neighborhoods simultaneously .",
    "this proves that @xmath608 and @xmath609 lies in @xmath468    finally , we check that the regions of @xmath576 are non - overlapping : each region @xmath582 consists of @xmath620 and a region directly below @xmath393 for non - overlapping cubes @xmath664 .",
    "the region below @xmath393 , however , does not intersect any @xmath665 for any @xmath666 lying below @xmath393 .",
    "this completes the proof of lemma  [ last ] .",
    "we proceed by contradiction .",
    "let @xmath97 be a critical system of @xmath0 points and @xmath1 complex lines in @xmath3 .",
    "that is , @xmath38 is minimal among all systems @xmath97 where the number of incidences is @xmath667 .    by the separation lemma",
    ", there is a set @xmath202 of at least @xmath186 points and two sets of complex lines @xmath112 and @xmath113 such that the ( complex ) directions of lines in @xmath112 and @xmath113 are within a @xmath92 neighborhood of two orthogonal directions @xmath668 and for every point @xmath189 , @xmath669 and @xmath670 .",
    "we identify the complex plane with the four - dimensional real euclidean space by @xmath671 .",
    "the directions of 2-flats in @xmath672 and @xmath673 are in a @xmath93-neighborhood of directions of two orthogonal directions @xmath674 . in the remainder of the proof , we consider the system @xmath675 as a system of points and @xmath46-flats in @xmath39 .",
    "we apply lemma  [ last ] to @xmath202 , @xmath112 , @xmath113 with parameter @xmath676 .",
    "( by lemma  [ alap ] , the constraints @xmath677 and @xmath678 are satisfied . )",
    "we obtain a family @xmath576 non - overlapping compact sets in @xmath39 of cardinality @xmath679 ; and for each @xmath680 we have a subset @xmath681 of size exactly @xmath4 .",
    "next , we deduce a lower bound on the number of crossings @xmath682 of the almost orthogonal families of @xmath46-flats @xmath112 and @xmath113 .",
    "consider a region @xmath582 .",
    "each point @xmath683 is incident to at least @xmath111 lines of @xmath112 and of @xmath113 . at most @xmath4 lines of @xmath684 and of @xmath685",
    "may be incident to some other point of @xmath686 because @xmath687 .",
    "thus , there are at least @xmath688 lines of @xmath684 ( and of @xmath685 , resp . ) which do not pass through any other point of @xmath686 .",
    "let us count for each @xmath582 the crossings @xmath689 such that @xmath690 , @xmath691 , and @xmath692 .",
    "by the combination lemma , there are at least @xmath693 such crossings for each pair @xmath583 . for every @xmath582",
    ", we have counted distinct crossings because the crossing pairs intersect in disjoint regions .",
    "the total number of crossings is at least @xmath694 there are more than @xmath695 distinct crossings , because @xmath696 .",
    "a contradiction , since @xmath697 , thus the number of crossings is at most @xmath698 .",
    "we conclude that @xmath699 ."
  ],
  "abstract_text": [
    "<S> this paper generalizes the szemerdi - trotter theorem to the complex plane . </S>",
    "<S> szemerdi and trotter proved that the number of point - line incidences of @xmath0 points and @xmath1 lines in the real euclidean plane is @xmath2 , and this bound is tight . </S>",
    "<S> we extend the methods of szemerdi and trotter and prove that the number of point - line incidences of @xmath0 points and @xmath1 complex lines in the complex plane @xmath3 is @xmath2 , which is tight , too . </S>"
  ]
}