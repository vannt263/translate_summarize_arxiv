{
  "article_text": [
    "training neural networks requires setting several hyper - parameters to adequate values : number of hidden layers , number of neurons per hidden layer , learning rate , momentum , dropout rate , etc .",
    "although tuning such hyper - parameters via parameter search has been recently investigated by  @xcite , doing so remains extremely costly , which makes it imperative to develop more efficient techniques .    of the many hyper - parameters , those that determine the network s architecture are among the hardest to tune , especially because changing them during training is more difficult than adjusting more dynamic parameters such as the learning rate or momentum .",
    "typically , the architecture parameters are set once and for all before training begins .",
    "thus , assigning them correctly is paramount : if the network is too small , it will not learn well ; if it is too large , it may take significantly longer to train while running the risk of overfitting .",
    "networks are therefore usually trained with more parameters than necessary , and pruned once the training is complete .",
    "this paper introduces divnet , a new technique for reducing the size of a network . divnetdecreases the amount of redundancy in a neural network ( and hence its size ) in two steps : first",
    ", it samples a diverse subset of neurons ; then , it merges the remaining neurons with the ones previously selected .",
    "specifically , divnetmodels neuronal diversity by placing a determinantal point process ( dpp )  @xcite over neurons in a layer , which is then used to select a subset of diverse neurons .",
    "subsequently , divnet``fuses '' information from the dropped neurons into the selected ones through a reweighting procedure .",
    "together , these steps reduce network size ( and act as implicit regularization ) , without requiring any further training or significantly hurting performance .",
    "divnetis fast and runs in time negligible compared to the network s prior training time .",
    "moreover , it is agnostic to other network parameters such as activation functions , number of hidden layers , and learning rates .    for simplicity ,",
    "we describe and analyze divnetfor feed - forward neural networks , however divnetis _ not _ limited to this setting . indeed , since divnetoperates on a layer fully connected to the following one in a network s hierarchy",
    ", it applies equally well to other architectures with fully connected layers .",
    "for example , it can be applied without any further modification to deep belief nets and to the fully - connected layers in convolutional neural networks . as these layers are typically responsible for the large majority of the cnns memory footprint  @xcite , divnetis particularly well suited for such networks .",
    "[ [ contributions . ] ] contributions .",
    "+ + + + + + + + + + + + + +    the key contributions of this paper are the following :    =1em    introduction of dpps as a flexible , powerful tool for modeling layerwise neuronal diversity (  [ sec : pruning ] ) .",
    "specifically , we present a practical method for creating dpps over neurons , which enables diversity promoting sampling and thereby leads to smaller network sizes .",
    "a simple but crucial `` fusing '' step that minimizes the adverse effects of removing neurons .",
    "specifically , we introduce a reweighting procedure for a neuron s connections that transfers the contributions of the pruned neurons to the ones that are retained (  [ sec : reweighting ] ) .",
    "the combination of both ideas is called divnet .",
    "we perform several experiments to validate divnetand compare to previous neuron pruning approaches , which divnetconsistently outperforms . notably , divnet s reweighting strategy benefits other pruning approaches .    [ [ related - work . ] ] related work .",
    "+ + + + + + + + + + + + +    due to their large number of parameters , deep neural networks typically have a heavy memory footprint .",
    "moreover , in many deep neural network models parameters show a significant amount of redundancy  @xcite .",
    "consequently , there has been significant interest in developing techniques for reducing a network s size without penalizing its performance .    a common approach to reducing",
    "the number of parameters is to remove connections between layers . in  @xcite",
    ", connections are deleted using information drawn from the hessian of the network s error function . @xcite",
    "reduce the number of parameters by analyzing the weight matrices , and applying low - rank factorization to the final weight layer .",
    "@xcite remove connections with weights smaller than a given threshold before retraining the network .",
    "these methods focus on deleting parameters whose removal influences the network the least , while divnetseeks diversity and merges similar neurons ; these methods can thus be used in conjunction with ours .",
    "although methods such as  @xcite that remove connections between layers may also delete neurons from the network by removing all of their outgoing or incoming connections , it is likely that the overall impact on the size of the network will be lesser than approaches such as divnetthat remove entire neurons : indeed , removing a neuron decreases the number of rows or columns of the weight matrices connecting the neuron s layer to both the previous and following layers .",
    "convolutional neural networks  @xcite replace fully - connected layers with convolution and subsampling layers , which significantly decreases the number of parameters .",
    "however , as cnns still maintain fully - connected layers , they also benefit from divnet .",
    "closer to our approach of reducing the number of hidden neurons is  @xcite , which evaluates each hidden neuron s importance and deletes neurons with the smaller importance scores . in  @xcite",
    ", a neuron is pruned when its weights are similar to those of another neuron in its layer , leading to a weight update procedure that is somewhat similar in idea ( albeit simpler ) to our reweighting step : where  @xcite removes neurons with equal or similar weights , we consider the more complicated task of merging neurons that , as a group , perform redundant calculations based on their activations .",
    "other recent approaches consider network compression without pruning : in  @xcite , a new , smaller network is trained on the outputs of the large network ; @xcite use hashing to reduce the size of the weight matrices by forcing all connections within the same hash bucket to have the same weight . @xcite and @xcite",
    "show that networks can be trained and run using limited precision values to store the network parameters , thus reducing the overall memory footprint .",
    "we emphasize that divnet s focus on neuronal diversity is orthogonal and complementary to prior network compression techniques .",
    "consequently , divnetcan be combined , in most cases trivially , with previous approaches to memory footprint reduction .",
    "in this section we introduce our technique for modeling neuronal diversity more formally .",
    "let @xmath0 denote the training data , @xmath1 a layer of @xmath2 neurons , @xmath3 the activation of the @xmath4-th neuron on input @xmath5 , and @xmath6 the activation vector of the @xmath4-th neuron obtained by feeding the training data through the network . to enforce diversity in layer @xmath1 ,",
    "we must determine which neurons are computing redundant information and remove them . doing so requires finding a maximal subset of ( linearly ) independent activation vectors in a layer and retaining only the corresponding neurons . in practice , however , the number of items in the training set ( or the number of batches ) can be much larger than the number of neurons in a layer , so the activation vectors @xmath7 are likely linearly independent .",
    "merely selecting by the maximal subset may thus lead to a trivial solution that selects all neurons .    reducing redundancy",
    "therefore requires a more careful approach to sampling .",
    "we propose to select a subset of neurons whose activation patterns are diverse while contributing to the network s overall computation ( i.e. , their activations are not saturated at 0 ) .",
    "we achieve this diverse selection by formulating the neuron selection task as sampling from a determinantal point process ( dpp ) .",
    "we describe the details below .",
    "dpps are probability measures over subsets of a ground set of items .",
    "originally introduced to model the repulsive behavior of fermions  @xcite , they have since been used fruitfully in machine - learning  @xcite .",
    "interestingly , they have also been recently applied to modeling inter - neuron inhibitions in neural spiking behavior in the rat hippocampus  @xcite .",
    "dpps present an elegant mathematical technique to model diversity : the probability mass associated to each subset is proportional to the determinant ( hence the name ) of a dpp kernel matrix .",
    "the determinant encodes negative associations between variables , and thus dpps tend to assign higher probability mass to diverse subsets ( corresponding to diverse submatrices of the dpp kernel ) .",
    "formally , a ground set of @xmath8 items @xmath9 and a probability @xmath10 $ ] such that @xmath11 where @xmath12 is a @xmath8-by-@xmath8 positive definite matrix , form a dpp .",
    "@xmath12 is called the _ dpp kernel _ ; here , @xmath13 indicates the @xmath14 principal submatrix of @xmath12 indexed by the elements of @xmath15 .",
    "the key ingredient that remains to be specified is the dpp kernel , which we now describe .",
    "there are numerous potential choices for the dpp kernel .",
    "we found that experimentally a well - tuned gaussian rbf kernel provided a good balance between simplicity and quality : for instance , it provides much better results that simple linear kernels ( obtained via the outer product of the activation vectors ) and is easier to use than more complex gaussian rbf kernels with additional parameters .",
    "a more thorough evaluation of kernel choice is future work .",
    "recall that layer @xmath1 has activations @xmath7 . using these , we first create an @xmath16 kernel @xmath17 with bandwidth parameter @xmath18 by setting @xmath19 to ensure strict positive definiteness of the kernel matrix @xmath17 , we add a small diagonal perturbation @xmath20 to @xmath17 ( @xmath21 ) .",
    "the choice of the bandwidth parameter could be done by cross - validation , but that would greatly increase the training cost .",
    "therefore , we use the fixed choice @xmath22 , which was experimentally seen to work well .    finally , in order to limit rounding errors , we introduce a final scaling operation : suppose we wish to obtain a desired size , say @xmath23 , of sampled subsets ( in which case we are said to be using a @xmath23-dpp  @xcite ) . to that end , we can scale the kernel @xmath24 by a factor @xmath25 , so that its _ expected _ sample size becomes @xmath23 . for a dpp with kernel @xmath12",
    ", the expected sample size is given by  ( * ? ? ?",
    "34 ) : @xmath26 = \\operatorname{tr}(l ( i+l)^{-1}).\\ ] ] therefore , we scale the kernel to @xmath27 with @xmath25 such that @xmath28 where @xmath29 is the expected sample size for the kernel @xmath24 .    finally , generating and then sampling from @xmath30 has @xmath31 cost . in our experiments , this sampling cost was negligible compared with the cost of training . for networks with very large hidden layers",
    ", one can avoiding the @xmath32 cost by using more scalable sampling techniques  @xcite .      simply excising the neurons that are not sampled by the dpp",
    "drastically alters the neuron inputs to the next layer .",
    "intuitively , since activations of neurons marked redundant are not arbitrary , throwing them away is wasteful .",
    "ideally we should preserve the total information of a given layer , which suggests that we should `` fuse '' the information from unselected neurons into the selected ones .",
    "we achieve this via a reweighting procedure as outlined below .    without loss of generality , let neurons 1 through @xmath23 be the ones sampled by the dpp and @xmath33 their corresponding activation vectors .",
    "let @xmath34 be the weights connecting the @xmath4-th neuron ( @xmath35 ) in the current layer to the @xmath36-th neuron in the next layer ; let @xmath37 denote the updated weights after merging the contributions from the removed neurons .",
    "we seek to minimize the impact of removing @xmath38 neurons from layer @xmath1 . to that end",
    ", we minimize the difference in inputs to neurons in the subsequent layer before ( @xmath39 ) and after ( @xmath40 ) dpp pruning .",
    "that is , we wish to solve for all neurons in the next layer ( indexed by @xmath36 , @xmath41 ) : @xmath42    eq .  [ eq : reweighting ] is minimized when @xmath43 is the projection of @xmath44 onto the linear space generated by @xmath45 .",
    "thus , to minimize eq .",
    "[ eq : reweighting ] , we obtain the coefficients @xmath46 that for @xmath47 minimize @xmath48    and then update the weights by setting @xmath49 using ordinary least squares to obtain @xmath50 , the reweighting procedure runs in @xmath51 .",
    "to quantify the performance of our algorithm , we present below the results of experiments on common datasets for neural network evaluation : ` mnist `  @xcite , ` mnist_rot `  @xcite and ` cifar-10 `  @xcite .",
    "all networks were trained up until a certain training error threshold , using softmax activation on the output layer and sigmoids on other layers ; see table  [ tab : networks ] for more details . in all following plots ,",
    "error bars represent standard deviations .",
    ".overview of the sets of networks used in the experiments .",
    "we train each class of networks until the first iteration of backprop for which the training error reaches a predefined threshold . [ cols=\"^,^,^,^\",options=\"header \" , ]      to validate our claims on the benefits of using dpps and fusing neurons , we compare these steps separately and also simultaneously against random pruning , where a fixed number of neurons are chosen uniformly at random from a layer and then removed , with and without our fusing step .",
    "we present performance results on the test data ; of course , both dpp selection and reweighting are based solely on information drawn from the training data .",
    "figure  [ fig : reconstruction ] visualizes neuron activations in the first hidden layer of a network trained on the ` mnist ` dataset .",
    "each column in the plotted heat maps represents the activation of a neuron on instances of digits 0 through 9 .",
    "figure  [ fig : reconstruction - dpp ] shows the activations of the 50 neurons sampled using a @xmath23-dpp ( @xmath23 = 50 ) defined over the first hidden layer , whereas figure  [ fig : reconstruction - first ] shows the activations of the first 50 neurons of the same layer .",
    "figure  [ fig : reconstruction - first ] contains multiple similar columns : for example , there are 3 entirely green columns , corresponding to three neurons that saturate to 1 on each of the 10 instances . in contrast , the dpp samples neurons with diverse activations , and figure  [ fig : reconstruction - dpp ] shows no similar redundancy",
    ".            figures  [ fig : k - dpp ] through  [ fig : reweighting - pruning - influence ] illustrate the impact of each step of divnetseparately .",
    "figure  [ fig : k - dpp ] shows the impact of pruning on test error using dpp pruning and random pruning ( in which a fixed number of neurons are selected uniformly at random and removed from the network ) .",
    "dpp - pruned networks have consistently better training and test errors than networks pruned at random for the same final size .",
    "as expected , the more neurons are maintained , the less the error suffers from the pruning procedure ; however , the pruning is in both cases destructive , and is seen to significantly increase the error rate .",
    "this phenomenon can be mitigated by our reweighting procedure , as shown in figure  [ fig : reweighting - influence ] . by fusing and reweighting neurons after pruning , the training and test errors",
    "are considerably reduced , even when 90% of the layer s neurons are removed .",
    "pruning also reduces variability of the results : the standard deviation for the results of the reweighted networks is significantly smaller than for the non - reweighted networks , and may be thus seen as a way to regularize neural networks .",
    "finally , figure  [ fig : reweighting - pruning - influence ] illustrates the performance of divnet(dpp pruning and reweighting ) compared to random pruning with reweighting .",
    "although divnet s performance is ultimately better , the reweighting procedure also dramatically benefits the networks that were pruned randomly .",
    ".45   [ fig : k - dpp - test - error ] -.4 cm    .45   [ fig : k - dpp - training - error ] -.4 cm    .45   [ fig : reweighting - influence - test - error ] -.4 cm    .45   [ fig : reweighting - influence - training - error ] -.4 cm    .45   [ fig : reweighting - pruning - influence - test - error ] -.4 cm    .45   [ fig : reweighting - pruning - influence - training - error ] -.4 cm    we also ran these experiments on networks for shrinking the second layer while maintaining the first layer intact .",
    "the results are similar , and may be found in appendix  [ appendix : second - layer ] .",
    "notably , we found that the gap between divnetand random pruning s performances was much wider when pruning the last layer .",
    "we believe this is due to the connections to the output layer being learned much faster , thus letting a small , diverse subset of neurons ( hence well suited to dpp sampling ) in the last hidden layer take over the majority of the computational effort .",
    "much attention has been given to reducing the size of neural networks in order to reduce memory consumption .",
    "when using neural nets locally on devices with limited memory , it is crucial that their memory footprint be as small as possible .    .45   [ fig : activation - pruning - mnist ] -.4 cm    .45   [ fig : activation - pruning - rot ] -.4 cm    node importance - based pruning ( henceforth `` importance pruning '' ) is one of the most intuitive ways to cut down on network size",
    ". introduced to deep networks by  @xcite , this method removes the neurons whose calculations impact the network the least . among the three solutions to estimating a neuron s importance discussed in  @xcite , the sum the output weights of each neuron ( the ` onorm ' function ) provided the best results :    @xmath52    figure  [ fig : activation - pruning ]",
    "compares the test data error of the networks after being pruned using importance pruning that uses onorm as a measure of relevance against divnet .",
    "since importance pruning deletes neurons that contribute the least to the next layer s computations , it performs well up to a certain point ; however , when pruning a significant amount of neurons , this pruning procedure even removes neurons performing essential calculations , hurting the network s performance significantly .",
    "however , since divnetfuses redundant neurons , instead of merely deleting them its resulting network delivers much better performance even with very large amounts of pruning .",
    "in order to illustrate numerically the impact of divneton network performance , table  [ tab : compression - train ] shows network training and test errors ( between 0 and 1 ) under various compression rates obtained with divnet , without additional retraining ( that is , the pruned network is not retrained to re - optimize its weights ) .",
    "@xmath53=1em    in all experiments , sampling and reweighting ran several orders of magnitude faster than training ; reweighting required significantly more time than sampling .",
    "if divnetmust be further sped up , a fraction of the training set can be used instead of the entire set , at the possible cost of subsequent network performance .",
    "when using dpps with a gaussian rbf kernel , sampled neurons need not have linearly independent activation vectors : not only is the dpp sampling probabilistic , the kernel itself is not scale invariant . indeed , for two collinear but unequal activation vectors , the corresponding coefficient in the kernel will not be 1 ( or @xmath25 with the @xmath54 update ) .",
    "in our work , we selected a subset of neurons by sampling once from the dpp .",
    "alternatively , one could sample a fixed amount of times , using the subset with the highest likelihood ( i.e. , largest @xmath55 ) , or greedily approximate the mode of the dpp distribution .    our reweighting procedure benefits competing pruning methods as well ( see figure  [ fig : reweighting - pruning - influence ] ) .",
    "we also investigated dpp sampling for pruning concurrently with training iterations , hoping that this might allow us to detect superfluous neurons before convergence , and thus reduce training time .",
    "however , we observed that in this case dpp pruning , with or without reweighting , did not offer a significant advantage over random pruning .",
    "consistently over all datasets and networks , the expected sample size from the kernel @xmath17 was much smaller for the last hidden layer than for other layers .",
    "we hypothesize that this is caused by the connections to the output layer being learned faster than the others , allowing a small subset of neurons to take over the majority of the computational effort .",
    "divnetleverages similarities between the behaviors of neurons in a layer to detect redundant parameters and merge them , thereby enforcing neuronal diversity within each hidden layer . using divnet , large",
    ", redundant networks can be shrunk to much smaller structures without impacting their performance and without requiring further training .",
    "we believe that the performance profile of divnetwill remain similar even when scaling to larger scale datasets and networks , and hope to include results on bigger problems ( e.g. , imagenet  @xcite ) in the future .",
    "many hyper - parameters can be tuned by a user as per need include : the number of remaining neurons per layer can be fixed manually ; the precision of the reweighting and the sampling procedure can be tuned by choosing how many training instances are used to generate the dpp kernel and the reweighting coefficients , creating a trade - off between accuracy , memory management , and computational time .",
    "although divnetrequires the user to select the size of the final network , we believe that a method where no parameter explicitly needs to be tuned is worth investigating .",
    "the fact that dpps can be augmented to also reflect different distributions over the sampled set sizes  @xcite might be leveraged to remove the burden of choosing the layer s size from the user .",
    "importantly , divnetis agnostic to most parameters of the network , as it only requires knowledge of the activation vectors .",
    "consequently , divnetcan be easily used jointly with other pruning / memory management methods to reduce size .",
    "further , the reweighting procedure is agnostic to how the pruning is done , as shown in our experiments .    furthermore , the principles behind divnetcan theoretically also be leveraged in non fully - connected settings .",
    "for example , the same diversifying approach may also be applicable to filters in cnns : if a layer of the cnn is connected to a simple , feed - forward layer  such as the s4 layer in  @xcite  by viewing each filter s activation values as an vector and applying divneton the resulting activation matrix , one may be able to remove entire filters from the network , thus significantly reducing cnn s memory footprint .",
    "finally , we believe that investigating dpp pruning with different kernels , such as kernels invariant to the scaling of the activation vectors , or even kernels learned from data , may provide insight into which interactions between neurons of a layer contain the information necessary for obtaining good representations and accurate classification .",
    "this marks an interesting line of future investigation , both for training and representation learning .",
    "this work is partly supported by nsf grant : iis-1409802 .",
    ".49     .49     .49     .49     .49     .49",
    "on training error ( using the networks trained on ` mnist ` ) .",
    "the dotted lines show min and max errors . ]     on the number of neurons that remain after pruning networks trained on ` mnist ` ( when pruning non - parametrically , using a dpp instead of a @xmath23-dpp . ) ]"
  ],
  "abstract_text": [
    "<S> we introduce divnet , a flexible technique for learning networks with diverse neurons . </S>",
    "<S> divnetmodels neuronal diversity by placing a determinantal point process ( dpp ) over neurons in a given layer . </S>",
    "<S> it uses this dpp to select a subset of diverse neurons and subsequently fuses the redundant neurons into the selected ones . </S>",
    "<S> compared with previous approaches , divnetoffers a more principled , flexible technique for capturing neuronal diversity and thus implicitly enforcing regularization . </S>",
    "<S> this enables effective auto - tuning of network architecture and leads to smaller network sizes without hurting performance . </S>",
    "<S> moreover , through its focus on diversity and neuron fusing , divnetremains compatible with other procedures that seek to reduce memory footprints of networks . </S>",
    "<S> we present experimental results to corroborate our claims : for pruning neural networks , divnetis seen to be notably superior to competing approaches . </S>"
  ]
}