{
  "article_text": [
    "b - lymphocytes express on their surface y - shaped receptors , called antibodies , with highly specific binding sites .",
    "all antibodies of a given b - cell are of the same type , the idiotype .",
    "if the antibodies are cross - linked by complementary structures , situated e.g. on an antigen , the b - cell is stimulated to proliferate and , after a few cell cycles , differentiate into plasma cells and memory cells .",
    "plasma cells secrete large amounts of antibodies , which attach to the antigen and mark it for further processing .",
    "useful clones survive , while others , lacking stimulation , die @xcite .",
    "complementary structures can be found also on b - lymphocytes .",
    "b - cells of complementary idiotype may stimulate each other , thus the b - lymphocyte system forms a functional network , the idiotypic network @xcite .",
    "a history and thorough discussion of immunological paradigms can be found in @xcite , cf .",
    "also @xcite . for reviews on idiotypic networks with emphasis on modeling",
    "see @xcite , and with focus on new immunological and clinical findings see @xcite .",
    "the idiotypic network is an attractive concept for system biologists , but due to their complexity also a challenge for theoretical physicists .",
    "the size of the potential idiotypic repertoire of humans is estimated to exceed @xmath0 @xcite , the expressed repertoire is of order @xmath1 @xcite .",
    "interactions between b - cells of complementary idiotype are genuinely nonlinear .",
    "thus , modeling idiotypic networks is an inviting playground for statistical physics , nonlinear dynamics , and complex systems .",
    "networks , especially random and randomly evolving networks , with applications in a plethora of different , multidisciplinary fields @xcite experience great interest in the community of statistical physicists .",
    "computer scientists try to mimick the immune system to fight against foreign invaders @xcite .    a minimalistic model of the idiotypic network",
    "was proposed in @xcite where the nodes represent b - lymphocytes and antibodies of a given idiotype .",
    "the idiotype is characterized by a bitstring .",
    "populations with complementary idiotypes , allowing for a few mismatches , can interact . in the model ,",
    "an idiotype population may be present or absent . for survival",
    "it needs stimulation by sufficiently many complementary idiotypes , but becomes extinct if too many complementary idiotypes are present .",
    "this reflects the log - bell shaped dose - response curve characteristic for b - lymphocytes @xcite .",
    "the dynamics is driven by the influx of new idiotypes generated by mutations in the bone marrow .",
    "the potential idiotypic network consists of all idiotypes an organism is able to generate .",
    "each idiotype @xmath2 is labelled by a bitstring of length @xmath3 : @xmath4 , which is the binary address of the node in the network .",
    "two nodes @xmath2 and @xmath5 are linked if their bitstrings are complementary . we allow for @xmath6 mismatches , i.e. their hamming distance must obey @xmath7 .",
    "these nodes and links build an undirected graph @xmath8 , the base graph .",
    "each node has the same number of neighbors , @xmath9 .",
    "the expressed idiotypic network is only a part of the potential network .",
    "new idiotypes generated in the bone marrow are introduced by occupying empty nodes randomly .",
    "occupied nodes are selected to survive if they receive sufficient stimulus , i.e. if the number of occupied neighbors is within an allowed window . to be specific ,",
    "the rules for ( parallel ) update are    1 .",
    "occupy empty nodes with probability @xmath10 + 2 .",
    "count the number of occupied neighbors @xmath11 of node @xmath2 .",
    "if @xmath11 is outside the window @xmath12\\,$ ] , set the node @xmath2 empty + 3 .",
    "+    the model has a minimal number of parameters , namely the length of the bitstring , the allowed number of mismatches , upper and lower thresholds of the window , and the influx probability of new idiotypes .",
    "we can consider our model system as a descendant of conway s game of life @xcite .",
    "there , on an infinite regular 2d lattice the sites can take value 0 or 1 .",
    "the system is updated in parallel in discrete time .",
    "if the number of living neighbors lies between a lower and an upper threshold , a site becomes populated or survives in the next step .",
    "the dynamics is entirely determined by the initial configuration .",
    "there is continuous interest in the highly complex properties of game of life , for a recent status report see @xcite .",
    "schulman and seiden @xcite investigated a probabilistic version of the game of life , where the update rule is modified in two ways .",
    "sites for which a window rule is fulfilled will be occupied or will survive with given probabilities .",
    "furthermore , a site can be occupied or survives in a stochastic way , parametrized by a temperature @xmath13 such that for @xmath14 the modified window rule applies but plays no role for @xmath15 .",
    "starting from random initial conditions , simulations show a sharp transition of the global mean occupation when @xmath13 is increased . the high temperature phase is well described by a mean field theory which fails however to reproduce low temperature results . excluding sites without occupied neighbors",
    "improves the agreement of theory and simulation for low temperatures . a second order mean field theory",
    "was proposed in @xcite .",
    "gutowitz et al .",
    "@xcite developed a local structure theory for cellular automata on regular lattices , which considers the evolution of joint probabilities of sets of neighboring cells ( block configurations ) and thus include correlations .",
    "application to the problem of schulman and seiden yields results which agree with their simulations @xcite .",
    "bidaux et al .",
    "@xcite considered a binary probabilistic cellular automaton with a totalistic update rule involving 8 neighbors on regular lattices in @xmath16 .",
    "if the window rule is fulfilled , it applies with probability @xmath10 .",
    "simulations with random initial conditions show a transition of the global mean occupation at a critical value @xmath17 , which is continuous for @xmath18 and first order for @xmath19 .",
    "a mean field theory describes qualitatively a first order transition .",
    "an overview of mean field theories of cellular automata including the probabilistic game of life can be found in @xcite    in the context of network models there are numerous mean field approaches aimed to describe degree distribution , clustering coefficient , average shortest distance between two nodes , mean populations , e.g. in susceptible - infectious - recovered models of epidemic spread , and other characteristics .",
    "many references can be found in the recent monograph by newman @xcite , cf .",
    "also @xcite .",
    "gleeson and cahalane @xcite investigate cascades of activation in a model with a threshold dynamics on a poisson random graph with average degree @xmath20 .",
    "starting with few active nodes , neighbors become permanently active if the fraction of active neighbors exceeds a threshold , drawn for each node from a given distribution .",
    "the fraction of activated nodes in the @xmath21th update step is determined recursively .",
    "the final fraction of active nodes @xmath22 is related to the fixed points of this recursion .",
    "for gaussian distributed thresholds with mean @xmath23 this fraction as a function of @xmath20 may change in a continuous or discontinuous way depending on @xmath23 . in this paper",
    "we deal with a network of complex architecture which emerges as a result of a random evolution .",
    "the architecture is build of groups of nodes , the modules , which share statistical properties . to describe this architecture ,",
    "a global mean field theory is obviously not appropriate .",
    "depending on the parameters , different architectures can occur . in a previous paper @xcite",
    "we have reached a detailed understanding of the building principles of the architectures , which allows to calculate the number and size of the groups and their linking . here",
    "we develop a modular mean field theory to calculate the statistical properties for given architectures .",
    "in the next section we shortly sketch the building principles @xcite and collect the results needed to develop the theory . in sec .",
    "[ sec : meanfield ] we determine the evolution equation for the mean population of the groups for a given architecture , which properly takes into account the update rule of the model , random influx and the window rule",
    ". the fixed point of this evolution equation gives the stationary mean populations and allows to compute also the mean life time and the mean occupation of the neighborhood . in sec .",
    "[ sec : specialcases ] we consider two groups of nodes for which the mean field theory considerably simplifies : singletons , which are essentially isolated nodes , and groups of self - coupled nodes , core groups , in static patterns . in sec .",
    "[ sec : correlation ] we extend the mean field theory by including correlations , which is necessary to describe 2-cluster patterns .",
    "the results of the mean field theory for the general case are compared with simulations for a range of the influx parameter @xmath10 in sec .",
    "[ sec : evaluation ] .",
    "some probabilistic aspects of the stability of patterns are discussed in the appendix .",
    "simulations of the model for one and two allowed mismatches revealed that the system evolves for typical parameters towards a complex functional architecture @xcite .",
    "groups of nodes were identified which share statistical properties such as the mean occupation , the mean life time and the mean number of occupied neighbors .",
    "also the size of the groups and the linking between them have been determined . with increasing influx of new idiotypes transitions between architectures of different complexity are observed . for small influx static patterns",
    "are found . for an intermediate range of the influx a stationary dynamic architecture",
    "is observed which is the most interesting one .",
    "it includes a densely connected core , a periphery , and isolated nodes ( singletons ) , resembling the notion of central and peripheral part of the biological network @xcite . for larger influx",
    "the architecture becomes more irregular .    in @xcite an analytic description of the general building principles of these architectures",
    "was proposed .",
    "it allows to calculate number and size of groups and their linking for a given architecture .",
    "ideal static patterns , i.e. patterns without defects which persist without influx , are completely characterized .    for a given architecture , i.e. a pattern",
    ", the nodes can be classified according to the values of bits in determinant positions common to all nodes .",
    "different patterns are characterized by the number @xmath24 of such positions .",
    "the entries in these determinant positions decide to which group a node belongs .",
    "the pattern can be built by regular arrangement of elementary building blocks , which are hypercubes of dimension @xmath24 .",
    "we call these building blocks pattern modules",
    ". the concept is explained in detail and many examples are given in @xcite .    for a given pattern , i.e. a given @xmath24 ,",
    "the number of groups and their sizes can be calculated combinatorially @xmath25 and the number of links @xmath26 of a given node @xmath27 to nodes in @xmath28 is @xmath29 where @xmath30 .",
    "for example , on a base graph @xmath31 with @xmath12 = [ 1 , 10]$ ] we observe an architecture of three groups .",
    "it has two determinant bits and is described by a pattern module of dimension @xmath32 .",
    "persisting occupied nodes in the first group form 2-clusters , potential hubs , the second group , occasionally link together several 2-clusters , and the nodes in the third group are stable holes .",
    "the links are given by the corresponding matrix @xmath33 .",
    "on the same base graph , for intermediate influx @xmath10 , we also find a dynamical 12-group architecture .",
    "its architecture , visualized in fig .",
    "[ fig : scheme12 g ] , is based on a pattern module of dimension @xmath34 .",
    "the corresponding link matrix is given in table  [ tab : linkmat12 g ] .",
    "we find two large core groups with links to almost all other groups , two peripheral groups connected to the core , groups of stable holes , which separate the singletons from the central network .    in both cases",
    "the architecture is stationary , simulation and analytic predictions agree perfectly .    ,",
    "observed in simulations for @xmath35 on a base graph @xmath31 with @xmath12=[1,10]$ ] in agreement with eqs .",
    "( [ eq : groupsize ] ) and ( [ eq : linkmatrix ] ) .",
    "the size of the boxes corresponds to the group size .",
    "the lines show possible links between nodes of the groups . ]     & & @xmath36 & @xmath37 & @xmath38 & @xmath39 & @xmath40 & @xmath41 & @xmath42 & @xmath43 & @xmath44 & @xmath45 & @xmath46 & @xmath47 + & @xmath48 & & & & & & & & & & 55 & 22 & 2 + singletons & @xmath49 & & & & & & & & & 45 & 20 & 12 & 2 + & @xmath50 & & & & & & & & 36 & 18 & 20 & 4 & 1 + & @xmath51 & & & & & & & 28 & 16 & 26 & 6 & 3 & + [ -1.65ex]periphery & @xmath52 & & & & & & 21 & 14 & 30 & 8 & 6 & & + & @xmath53 & & & & & 15 & 12 & 32 & 10 & 10 & & & + [ -1.65ex]core & @xmath54 & & & & 10 & 10 & 32 & 12 & 15 & & & & + & @xmath55 & & & 6 & 8 & 30 & 14 & 21 & & & & & + & @xmath56 & & 3 & 6 & 26 & 16 & 28 & & & & & & + st .",
    "holes & @xmath57 & 1 & 4 & 20 & 18 & 36 & & & & & & & + & @xmath58 & 2 & 12 & 20 & 45 & & & & & & & & + & @xmath59 & 2 & 22 & 55 & & & & & & & & & +    the occupation of nodes is in general not permanent but fluctuates due to the influx while the architecture persists . for a given pattern",
    "the mean occupation of the groups varies systematically with the influx @xmath10 .",
    "the mean occupation and other statistical quantities can be computed in a modular mean field theory .",
    "we consider the nodes as situated in a mean field exerted by the neighboring groups characteristic for a given architecture .",
    "the required link matrix @xmath60 in our model can be calculated or obtained in simulations .",
    "other modular architectures could be treated , too .",
    "in a mean field approach we assume that all nodes are independently occupied with a probability @xmath61 , @xmath62 , characteristic for the group the node belongs to . since a node is either occupied or unoccupied , @xmath63 ,",
    "we have @xmath64 we consider the evolution of a given set of mean occupations @xmath65 to a new set @xmath66 induced by the update algorithm @xmath67 where @xmath68 the fixed point @xmath69 of eq .",
    "( [ eq : upd ] ) solves the self - consistency condition that we require for the stationary state of our model system @xmath70    having obtained the fixed points @xmath69 , we can compute the mean life time , see eq .",
    "( [ eq : tau_g ] ) below , and the number of occupied neighbors by @xmath71        the update map @xmath72 is constructed following the steps of the update algorithm , random influx and application of the deterministic window rule . to be specific ,",
    "we consider a node @xmath27 , with @xmath73 , and its neighbourhood @xmath74 .",
    "then the update algorithm says that an empty node @xmath75 is occupied by the influx with probability @xmath10 .",
    "next , the window condition is applied : an occupied node @xmath75 survives if the neighbourhood fulfills the window condition , otherwise it is emptied .",
    "we denote the occupation of a node @xmath75 after the influx by @xmath76 and the occupation of @xmath75 after the update by @xmath77 . a microscopic configuration of @xmath74 after the influx is denoted by @xmath78 , which is a list of occupations of all neighbors of @xmath75",
    ". then we have @xmath79 where @xmath80 is the transition matrix of the update of @xmath81 to @xmath82 depending on the window condition @xmath83 specifying eq .",
    "( [ eq : transmat ] ) to @xmath84 we obtain from eqs .",
    "( [ eq : expectlaw ] ) , ( [ eq : scexplicit ] ) , and ( [ eq : transmat ] ) @xmath85 \\mathbb{w}({\\partial \\tilde{v}_g})\\,.\\ ] ] averaging over all configurations @xmath86 leads to @xmath87 { p^{\\mathbb{w}}_{g}}\\,,\\ ] ] where @xmath88 is the probability that after the influx the neighbours of @xmath75 fulfill the window condition , @xmath89 in the next subsections [ sec : microstate ] and [ sec : randominflux ] we determine the probability @xmath90 of a microstate @xmath91 and the transition probability @xmath92 for the transition from @xmath93 to @xmath94 induced by the influx . in subsection",
    "[ sec : windowrule ] @xmath95 is explicitly determined .",
    "we introduce the notation @xmath96 for the set of neighbors of @xmath75 belonging to group @xmath28 , @xmath97 .",
    "a microscopic configuration of @xmath98 is denoted by @xmath99 .",
    "figure  [ fig : dv ] shows an example configuration .",
    "furthermore , a microscopic configuration @xmath100 with @xmath101 occupied nodes is denoted by @xmath102 .",
    "such a configuration has probability @xmath103 there are @xmath104 equivalent microconfigurations with the same number of occupied nodes @xmath105 .",
    "multiplying this number yields , of course , the binomial distribution .",
    "the multiplicity has to be taken into account when calculating the average occupation of @xmath98 @xmath106    s neighborhood . filled and empty circles represent occupied nodes and unoccupied nodes , respectively . ]    the probability of a microscopic configuration @xmath107 of the whole neighbourhood @xmath74 is determined by the occupation numbers @xmath108 .",
    "it factorises as @xmath109      the probability of the transition between two microstates @xmath102 and @xmath110 is @xmath111 here , @xmath112 is the number of empty nodes in @xmath102 which become occupied , @xmath113 is the number of nodes of @xmath102 which remain empty .",
    "the factor @xmath114 is introduced the number of occupied nodes can not decrease during the influx .",
    "there are @xmath115 different microconfigurations @xmath110 which can be reached from one microconfiguration @xmath102 with the same probability , cf .",
    "( [ eq : tinflux ] ) .",
    "again , there are @xmath116 equivalent microconfigurations @xmath117 . considering",
    "the whole neighbourhood we have @xmath118      after the random influx which leads to a transition from @xmath119 to @xmath120 it is tested whether or not the window condition eq .",
    "( [ eq : wc ] ) @xmath121 is fulfilled .",
    "the probability that the window condition is fulfilled is given by eq .",
    "( [ eq : pw ] ) . replacing the sums over all microstates of @xmath93 and @xmath94 by the sums over all mesostates",
    "@xmath122 and @xmath123 with occupation numbers @xmath124 and @xmath125 we have to account for the multiplicities derived above .",
    "this leads to @xmath126    _ { l=1}^{d_m\\!+\\!1 } \\!\\ !",
    "\\openone \\left ( t_l \\leqslant n({\\partial \\tilde{v}_g } ) \\leqslant      t_u",
    "\\right ) \\nonumber \\\\ *    & & \\times \\prod _ { l=1}^{d_m\\!+\\!1 } \\sum _ { k_l=0}^{{l_{gl } } } { { l_{gl}}-k_l \\choose      { \\widetilde{k}_l}-k_l } { { l_{gl}}\\choose k_l } \\\\ *    & & \\times t_{\\text{influx } }    ( { \\widetilde{c}}_{l|k_l } | c_{l|k_l } ) { \\text{prob}}(c_{l|k_l } ) \\ , , \\nonumber\\end{aligned}\\ ] ] where @xmath127 . the factors @xmath128 and @xmath129 are given by eqs .",
    "( [ eq : tinflux ] ) and ( [ eq : probcl ] ) . since by definition @xmath130 for @xmath131 and @xmath132 it is not necessary to explicitly write the factor @xmath133 , in contrast to eq .",
    "( [ eq : tinflux ] ) .",
    "we obtain @xmath134    _ { l=1}^{d_m\\!+\\!1 } \\!\\ !",
    "\\openone \\left ( t_l \\leqslant \\sum_{l=1}^{d_m\\!+\\!1 } { \\widetilde{k}_l}\\leqslant t_u \\right ) \\nonumber \\\\ *    & & \\times \\prod _ { l=1}^{d_m\\!+\\!1 } \\sum _ { k_l=0}^{{\\widetilde{k}_l } } { { l_{gl}}-k_l \\choose      { \\widetilde{k}_l}-k_l } { { l_{gl}}\\choose k_l } \\\\ *     & & \\times p^{{\\widetilde{k}_l}-k_l } ( 1-p)^{{l_{gl}}-{\\widetilde{k}_l } } n_l^{k_l }    ( 1-n_l)^{{l_{gl}}-k_l}\\ , , \\nonumber \\end{aligned}\\ ] ] which holds for all groups @xmath135 .",
    "we can simplify eq .",
    "( [ eq : pwfinexpl ] ) observing @xmath136 applying the binomial formula @xmath137^{{\\widetilde{k}_l } } \\,,\\ ] ] we can carry out the sum over the @xmath105 in eq .",
    "( [ eq : pwfinexpl ] ) and obtain @xmath138    _ { l=1}^{d_m\\!+\\!1 } \\!\\ !",
    "\\openone \\left(t_l \\leqslant \\sum_{l=1}^{d_m\\!+\\!1 } { \\widetilde{k}_l}\\leqslant t_u\\right ) \\nonumber \\\\ *     & & \\times \\prod _ { l=1}^{d_m\\!+\\!1 } { { l_{gl}}\\choose   { \\widetilde{k}_l } }    \\left [ n_l+(1-n_l)p \\right ] ^{{\\widetilde{k}_l } } \\nonumber \\\\ *     & & \\times [ 1-n_l-(1-n_l)p]^{{l_{gl}}-{\\widetilde{k}_l } } \\,.\\end{aligned}\\ ] ] since the mean occupation of some node in @xmath28 after the influx is @xmath139 , eq .",
    "( [ eq : pwfinsimp ] ) can be written in a compact way as @xmath140    _ { l=1}^{d_m\\!+\\!1 } \\!\\ !",
    "\\leqslant \\sum_{l=1}^{d_m\\!+\\!1 } { \\widetilde{k}_l}\\leqslant t_u\\right ) \\nonumber \\\\ *     & & \\times \\prod _ { l=1}^{d_m\\!+\\!1 } { { l_{gl}}\\choose   { \\widetilde{k}_l } }      { \\widetilde{n}}_l ^{{\\widetilde{k}_l } } ( 1-{\\widetilde{n}}_l)^{{l_{gl}}-{\\widetilde{k}_l } } \\,,\\end{aligned}\\ ] ] which has an obvious intuitive meaning : the probability that @xmath141 of the @xmath142 nodes of @xmath143 are occupied is @xmath144 and @xmath95 is obtained by multiplying over all groups and summing over all occupations obeying the window condition .",
    "thus , all quantities in eq .",
    "( [ eq : scav ] ) are determined and we are able to calculate the mean occupation of all groups @xmath145 , e.g. by iteration of eq .",
    "( [ eq : upd ] ) .      in a similar way",
    ", we are now able to calculate the mean life time ( expectation of life ) of an occupied node @xmath75 in group @xmath146 . its expectation value is defined as @xmath147 where @xmath148 is the probability that an occupied node @xmath27 remains occupied in @xmath149 subsequent steps and disappears in the following step , @xmath150 this can be expressed in terms of the update transition matrix @xmath151 introduced in eq .",
    "( [ eq : transmat ] ) .",
    "we use the shorthand @xmath152 and @xmath153 defined accordingly and write @xmath154 where @xmath155 denotes the neighbourhood of @xmath75 after the influx in the @xmath149-th step of the iteration",
    ". now we take the average of eq .",
    "( [ eq : probtau ] ) over all possible configurations @xmath156 assuming that the configurations in consecutive steps are independent , the average of eq .",
    "( [ eq : probtau ] ) factorizes . in the steady state @xmath157",
    "is independent of the time step @xmath149 and given by eq .",
    "( [ eq : pwfinsimp2 ] ) .",
    "this yields @xmath158 observing @xmath159 we finally obtain @xmath160",
    "in this section we discuss the numerical calculation of statistical network properties and consider special cases which allow essential simplifications .",
    "the general case is considered in sec .",
    "[ sec : evaluation ] .",
    "we consider the model on the basegraph @xmath8 with parameters @xmath12 $ ] and @xmath10 .",
    "we formulate the mean field theory for an architecture with module dimension @xmath24 . the link matrix @xmath33 is given by eq .",
    "( [ eq : linkmatrix ] ) .",
    "the mean occupations of the groups in the steady state are the fixed points @xmath69 of eq .",
    "( [ eq : scc ] ) . in general , eq .  ( [ eq : scc ] ) is a system of @xmath161 multivariate polynomial equations in the form of eq .",
    "( [ eq : scav ] ) .",
    "the factor @xmath95 is a polynomial in @xmath10 of maximal order @xmath162 , where @xmath163 is the degree of a node on the base graph .",
    "@xmath95 is also a multivariate polynomial in @xmath164 , @xmath165 .",
    "the maximal exponent of each @xmath164 is @xmath142 , such that the order of the multivariate polynomial is @xmath162 , because @xmath166 .",
    "note , that it is not possible to neglect higher orders of the polynomial , since the binomial coefficients may be very large .",
    "that is , in general we have to solve very complex equations .    in the following we treat groups of nodes for which eq .",
    "( [ eq : scc ] ) can be simplified in good approximation exploiting structural properties of the link matrix and properties of the groups of singletons and stable holes .",
    "singletons are surrounded only by stable holes .",
    "they occur in most patterns , in static patterns as well as in dynamic ones .",
    "therefore , singletons are important .",
    "their treatment is simple , since they decouple in very good approximation from the rest .    typically , stable holes are surrounded by more than @xmath167 occupied nodes , such that their occupation is zero after each update step .",
    "an occupied stable hole is a very rare event , and in good approximation we can assume that all stable holes are empty .",
    "singletons are surrounded by @xmath162 stable holes .",
    "the probability that @xmath168 out of @xmath162 empty stable holes are occupied by the influx is @xmath169 .",
    "thus , the probability that the window condition is fulfilled is given by @xmath170 this follows also directly from eq .",
    "( [ eq : pwfinsimp ] ) for singletons setting all hole groups empty .",
    "note , that @xmath171 only depends on @xmath10 , and @xmath172 for small @xmath10 . for singletons",
    "( [ eq : scav ] ) has the unique solution @xmath173 the mean occupation @xmath174 is plotted in fig .",
    "[ fig : mfsingletons ] and compared with simulation results .     with @xmath175 = [ 1,10]$ ] compared with simulation ( symbols ) .",
    "for small @xmath10 , @xmath176 , for @xmath177 the patterns in the simulation become _ transient _ , such that no group averages are available .",
    "singletons occur in various patterns , cf .",
    "[ fig : mfavssim ] .",
    "[ fig : mfsingletons ] ]      self - coupled nodes in static patterns have only stable holes and members of their own group as neighbors .",
    "they appear for instance in @xmath32 , 4 , and 6 patterns , cf .",
    "it is characteristic for these patterns , that the self - coupled nodes have a high mean occupation and thus suppress the occupation of the stable holes . supposing a high occupation of the self - coupled nodes we can consider stable holes as unoccupied .",
    "then , instead of the system of eqs .",
    "( [ eq : scc ] ) we have only one independent equation for the respective occupied core group .    as an example we consider the @xmath178 pattern .",
    "@xmath179 are singletons , the group of self - coupled nodes is @xmath180 .",
    "the stable hole groups @xmath181 , @xmath182 , and @xmath183 are suppressed by the occupation of @xmath180 if @xmath184 . with this constraint",
    "we can simply consider the union @xmath185 and put @xmath186 for all groups of stable holes .",
    "this simplifies the link matrix as given in fig .",
    "[ fig : matrixsimplification ] . the nodes in @xmath179 , singletons ,",
    "are treated as given above , @xmath187 . for the self - coupled nodes in @xmath180 we have a polynomial of 4th order in @xmath188 and of 80th order in @xmath10 , @xmath189    @xmath190    in fig .",
    "[ fig : mfs2dm4 ] we plotted @xmath191 over @xmath188 for representative choices of the influx parameter @xmath10 . for small values of @xmath10",
    ", @xmath192 is very close to @xmath188 such that the common way to plot @xmath192 over @xmath188 is inconvenient .",
    "the roots of @xmath193 give the fixed points @xmath194 of eq .",
    "( [ eq : onegroup_8c ] ) .",
    "fixed points with @xmath195 , i.e. with @xmath196 are stable .",
    "pattern on graph @xmath31 with @xmath175 = [ 1,10]$ ] .",
    "the lines give the function @xmath191 from the mean field theory for @xmath197 ( _ solid _ ) , @xmath198 ( _ dashed _ ) , @xmath199 ( _ dotted _ ) , and @xmath200 ( _ dash - dotted _ ) .",
    "the symbols mark stable ( @xmath201 ) and unstable ( @xmath202 ) fixed points .",
    "note , that the fixed points @xmath203 and @xmath204 are much smaller than @xmath205 , which is a range where the equation is actually not valid.[fig : mfs2dm4 ] ]    the case of @xmath206 is treated in the same way . for both @xmath178 and @xmath207",
    "the stable fixed points are in very good agreement with the simulations , cf .",
    "[ fig : mfonegroup ] .     in a @xmath178 pattern ( _ upper curve _ ) and nodes of group @xmath181 in a @xmath206 pattern ( _ lower curve _ ) , both on graph @xmath31 with @xmath175 = [ 1,10]$ ] compared with the respective values from simulations ( _ symbols _ ) .",
    "lines end at the value of @xmath10 where the patterns become unstable in the simulations , cf .",
    "[ fig : mfavssim ] ( _ right _ ) . ]",
    "the case of @xmath32 can not be treated this way , however .",
    "it is easy to see that for @xmath197 the respective iteration equation for the occupied group @xmath179 is @xmath208 , which has the fixed points @xmath209 and @xmath210 .",
    "the fixed point @xmath211 corresponds to the perfect 2-cluster pattern but it is unstable .",
    "generically , the iteration converges to the stable fixed point @xmath209 . also for @xmath212 the iteration will not produce the correct result of the simulations , even if we consider the full set of equations for all groups , cf .",
    "( [ eq : scc ] ) .",
    "the reason is simple : in the 2-cluster pattern an occupied node has only one occupied neighbor , which obviously obstructs the mean field approach .",
    "correlations between the two occupied neighbors are not negligible , they are treated in the next section .",
    "in any 2-cluster pattern the occupied nodes form pairs of mutually stimulating nodes , cf . fig .  [",
    "fig : correlation ] .",
    "their survival significantly depends on the presence of the respective partner , they are strongly correlated .",
    "this holds for all 2-cluster patterns on base graphs with arbitrary numbers of allowed mismatches @xmath6 .",
    "the pattern module of a 2-cluster pattern on @xmath8 is of dimension @xmath213 and the group of 2-cluster nodes shall be denoted by @xmath179 in all these cases .     and",
    "@xmath5 from @xmath179 forming a 2-cluster and their disjoint neighborhoods @xmath214 and @xmath215 . the line width of the links corresponds to the correlation strength . in the ideal pattern @xmath2 and @xmath5",
    "are occupied and the other nodes are empty . [",
    "fig : correlation ] ]    we measured in simulations the correlation between nearest neighbors in different patterns .",
    "the correlation is quantified by the two - point connected correlation function @xmath216 if @xmath217 , @xmath2 and @xmath5 are correlated , if @xmath218 , they are uncorrelated , and if @xmath219 , they are anti - correlated .",
    "we determined @xmath220 for @xmath221 and @xmath222 a nearest neighbor of @xmath223 and an element of @xmath224 .",
    "the average over all members of @xmath225 and their neighbors in @xmath224 is denoted by @xmath226 .",
    "tables  [ tab : correlation1 ] and [ tab : correlation2 ] show @xmath227 measured for all @xmath228 and @xmath229 for the 2-cluster and the 8-cluster pattern , respectively .",
    "the correlation in the 2-cluster is the strongest and thus indeed relevant . assuming independence gives qualitatively false results , as explained above .",
    ".@xmath227 for the 2-cluster pattern , @xmath230 .",
    "the corresponding value for @xmath231 calculated in the mean field approach below is @xmath232 .",
    "+ [ cols=\"^ , < , < , < \" , ]",
    "we notice that the solution of eq .",
    "( [ eq : scc ] ) can be very laborious , apart from very few simple special cases . in general we can determine the stable fixed points @xmath69 by iteration starting with some reasonable initial values @xmath233 .",
    "the suitable choice of the initial values is crucial , because eq .  ( [ eq : scc ] ) often has multiple stable fixed points .",
    "however , the basin of attraction is rather large for fixed points corresponding to dynamic patterns .",
    "_ generic _ initial values , i.e. values near the stationary results of the respective simulation , converge to the simulation results .    for a nongeneric choice of @xmath233",
    "the iteration may lead to results which do not correspond to the behaviour of the simulated system .",
    "for example , _ homogenous _ initial values @xmath234 for all groups lead to a homogenous fixed point @xmath235 .",
    "this is equivalent to an architecture with only one group .",
    "an analysis of one single polynomial equation like in subsection [ sec : occupiedcore ] can be possible in this case .",
    "@xcite analyzes a similar situation .",
    "_ symmetric _ initial conditions @xmath233 with @xmath236 lead to symmetric fixed points .",
    "this is due to the symmetry of the link matrix @xmath237 which is inherited to the update map @xmath72 .    for generic initial conditions we computed the fixed points for various pattern modules and an interesting interval of the parameter @xmath10 on @xmath31 and @xmath12=[1,10]$ ] and",
    "compare the results with simulation data .",
    "in the simulations we obtained the mean occupation as @xmath238 } n_t(v ) \\,,\\ ] ] the mean number of occupied neighbors of @xmath2 @xmath239 } n_t(\\partial v ) \\,,\\ ] ] and the mean life time @xmath240 } n_t(v)\\,,\\ ] ] where @xmath241 is the number of births during the observation time , i.e. the number of new occupations of the node by the influx .",
    "of course , @xmath242 must be fulfilled , otherwise @xmath243 has no meaning .    in fig .",
    "[ fig : mfavssim ] we compare mean field results with the simulation . in the left column we plotted isolines of histograms of @xmath244 , @xmath245 and @xmath243 as a function of @xmath10 , the simulations were started from empty base graphs . in the right column we used snapshots of the different patterns as initial conditions .            in the simulations started from the scratch for different values of the influx @xmath10 , the system evolved randomly and reached a steady state with a stable architecture . in the steady state we measured @xmath244 , @xmath245 and @xmath243 for all nodes during an observation time of @xmath246 iterations . for each choice of @xmath10",
    "we created histograms of the frequency of nodes against one of the three statistical node characteristics . in the figure",
    "we show the isolines of a compilation of all histograms in a range of @xmath247 $ ] .",
    "the observed aggregations of nodes indicate the self - organization of the nodes into persisting groups as well as the statistical differences of the groups in dependence of @xmath10 .    in general , the mean field results show a good agreement with the simulation .",
    "for @xmath32 we took the correlation correction into account , as described in sec .  [ sec : correlation ] .",
    "mean field results for some patterns are not matched by a corresponding peak in the histograms .",
    "these patterns are seldom reached in simulations starting from the scratch , because their basin of attraction is too far away from the initial empty configuration or behind a high barrier which is difficult to be passed .",
    "the peaks which are not matched by a mean field result may occur if a pattern does not persist over the observation time .",
    "this affects the time average of the node statistics , see , for example , the left column at @xmath248 .    in the plots we also see that the character of the patterns changes with increasing @xmath10 .",
    "for moderate influx , @xmath249 , we identified almost static patterns associated with modules @xmath250 .",
    "for @xmath251 there are no permanently occupied nodes , the pattern is dynamic , but a well defined group structure with @xmath34 exists , cf . fig .",
    "[ fig : scheme12 g ] .",
    "this is the most interesting architecture as explained above , cf .",
    "also @xcite .",
    "the basin of attraction of the corresponding fixed point of eq .",
    "[ eq : scc ] is large compared to the static patterns .    for @xmath177 perturbations",
    "due to the random influx become so large , that the orientation of the pattern module in the base graph starts changing .",
    "mathematically , these reorientations are rotations @xcite .",
    "after such a rotation there still exist 12 groups , but their identification by temporal averaging of node characteristics is impossible .",
    "the mean field theory does not consider rotations .",
    "it rather assumes that the nodes always remain in their groups .",
    "however , we can compare averages over the whole graph from the simulations with the mean field results averaged over all groups @xmath252 where @xmath253 denotes one of the quantities @xmath254 or @xmath255 .",
    "these averages are in good agreement , see plots of mean occupation and occupied neighbors in fig .",
    "[ fig : mfavssim ] .",
    "we believe that these rotations of the pattern are the origin of the difference between mean field results and simulation in the mean life time plot at @xmath256 . due to a rotation",
    "many previously occupied nodes become stable holes . thus , significantly many nodes do not reach their usual life expectation .    the fact that we do not observe all patterns in the simulations starting from an empty base graph ,",
    "is a motivation to prepare the initial conditions . in the right column of fig .  [",
    "fig : mfavssim ] we compare the mean field results to node statistics from simulations with different predetermined initial architecture .",
    "the observation time was 200,000 iterations .",
    "the picture proves that for the same value of @xmath10 different patterns can persist , however , with different stability .",
    "the plotted lines of a pattern end at the value of @xmath10 for which the pattern becomes unstable .",
    "we considered a minimalistic model @xcite to describe the random evolution of the idiotypic network which is , given very few model parameters , mainly controlled by the random influx of new idiotypes and the disappearance of not sufficiently stimulated idiotypes .",
    "numerical simulations have shown that after a transient period a steady state is achieved .",
    "depending on the influx and on other parameters , the emerging architecture can be very complex .",
    "typically , groups of nodes can be distinguished with clearly distinct statistical properties .",
    "these groups are linked together in a characteristic way .",
    "we achieved a detailed analytical understanding of the building principles of these very complex structures emerging during the random evolution @xcite .",
    "modules of remarkable regularity serve as building blocks of the complex pattern .",
    "we can calculate for instance size and connectivity of the idiotype groups in perfect agreement with the empirical findings based on numerical simulations .",
    "in this paper we developed a modular mean field theory which allows to compute the statistical characteristics of a variety of patterns given their architecture .",
    "the results are in very good agreement with the simulations .",
    "we thus have both structural and statistical information .",
    "the quantities usually considered in the context of networks , like degree distribution , cluster coefficient , centrality , etc .",
    ", are coarser than those investigated here and they do not reveal the details of the architecture .    for certain groups of nodes , namely singletons and the self - stabilizing core in static patterns , which decouple in good approximation from the rest , the mean field treatment can be simplified considerably . for the pattern consisting of pairs of occupied neighbors , the 2-cluster pattern , the naive mean field theory fails .",
    "therefore , we extended the mean field theory to include correlations . also for the @xmath34 architecture correlations can be taken into account , which requires an intricate analysis of the building principles but is rewarded with an almost perfect match between theory and simulations @xcite .    the modular mean field theory",
    "can be applied to calculate statistical properties of other stationary networks with known modular architecture .",
    "stability of patterns is a central and complex question . here",
    "we restrict ourselves to discuss the stability of the occupation state of a single node depending on the state of its neighborhood and the influx .",
    "we quantify this stability in terms of the probability that a node changes its occupation , i.e. to occupy empty nodes or to clear occupied nodes , respectively .    in the following",
    "we calculate the probability to change the occupation of a node @xmath2 given the number of occupied neighbors @xmath11 .",
    "we distinguish three cases .",
    "+ ( 1 ) @xmath257 , @xmath258 .",
    "this is an unstable hole , because it can be occupied by the influx and will survive if @xmath259 $ ] after the influx .",
    "the probability of occupation and survival is @xmath260 where @xmath10 is the probability that @xmath2 itself becomes occupied , and the sum gives the probability that the number of occupied neighbors lies in the window , i.e. @xmath261 $ ] empty neighbors become occupied .",
    "@xmath262 is the binomial distribution , where @xmath263 if @xmath264 .",
    "+ ( 2 ) @xmath265 , @xmath266 .",
    "this is an occupied node , including the case of an isolated node .",
    "the deletion of an occupied node requires that after the influx @xmath267 is outside the window . for @xmath268 the occupation of @xmath269",
    "$ ] or @xmath270 $ ] empty neighbors is required . for @xmath271 $ ] the occupation of",
    "@xmath270 $ ] is needed .",
    "this yields @xmath272 where @xmath273 if @xmath274 .",
    "the changes of occupation in cases ( i ) and ( ii ) are possible within one iteration .",
    "there are more complex scenarios which require more iterations .",
    "all occupation changes which demand the deletion of neighbors need at least two iterations , for instance the occupation of a stable hole .",
    "such occupation changes also involve the neighbors of the neighbors . as an additional sophistication",
    ", we have to regard , that two neighbors of @xmath2 have overlapping neighborhoods , they have at least the node @xmath2 in common .",
    "+ ( 3 ) @xmath257 , @xmath275 .",
    "this is a stable hole . during the first iteration",
    "the influx may increase the number of occupied neighbors by @xmath276 $ ] , such that the number of occupied neighbors becomes @xmath277 .",
    "the probability for this process is @xmath278 . in order to achieve @xmath279 , @xmath280 nodes of @xmath214",
    "must be emptied , @xmath281 $ ] .",
    "the probability to empty one occupied node @xmath282 is given by @xmath283 , cf .",
    "( [ eq : stability2 ] ) . however , the probability to empty @xmath280 occupied nodes in @xmath214 is not simply @xmath284 , because the neighborhoods @xmath285 are not disjoint .",
    "neglecting this correlation , one can proceed with the second iteration as follows .",
    "we have after the first iteration @xmath286 and @xmath287 .",
    "thus , the second iteration is simply case ( 1 ) , i.e. the occupation of an unstable hole . collecting the probabilities of the consecutive steps for all possible choices of @xmath168 and @xmath280",
    "gives then @xmath288 where @xmath289 denotes the sum over all choices of @xmath280 occupied nodes of @xmath214 which are emptied .",
    "for our parameter setting , and generally if @xmath290 , we find @xmath291 .",
    "stable holes are the nodes with the most stable occupation state .",
    "we expect that a pattern is stable , i.e. its nodes preserve their statistical properties for a long time , if it has sufficiently many stable holes .",
    "thanks is due to andreas khn , heinz sachsenweger , mario thne , benjamin werner , and sven willner for valuable comments",
    "thanks the imprs mathematics in the sciences and the evangelisches studienwerk villigst e.v . for funding .",
    "h.  schmidtchen and u.  behn .",
    "randomly evolving idiotypic networks : analysis of building principles . in h.",
    "bersini and j.  carneiro , editors , _ artificial immune systems icaris 2006 _ , volume 4163 of _ lecture notes in computational sciences _ , pages 8194 , berlin heidelberg , 2006 .",
    "springer - verlag .",
    "h.  schmidtchen and u.  behn .",
    "architecture of randomly evolving idiotypic networks . in a.  deutsch , r.  bravo de la parra , r.  de  boer , o.  diekmann , p.  jagers , e.  kisdi , m.  kretzschmar , p.  lansky , and h.  metz , editors , _ mathematical modeling of biological systems _ , volume  ii , pages 157167 , boston , 2008 . birkhuser ."
  ],
  "abstract_text": [
    "<S> we develop a modular mean field theory for a minimalistic model of the idiotypic network . </S>",
    "<S> the model comprises the random influx of new idiotypes and a deterministic selection . </S>",
    "<S> it describes the evolution of the idiotypic network towards complex modular architectures , the building principles of which are known . </S>",
    "<S> the nodes of the network can be classified into groups of nodes , the modules , which share statistical properties . </S>",
    "<S> each node experiences only the mean influence of the groups to which it is linked . </S>",
    "<S> given the size of the groups and linking between them the statistical properties such as mean occupation , mean life time , and mean number of occupied neighbors are calculated for a variety of patterns and compared with simulations . for a pattern which consists of pairs of occupied nodes correlations are taken into account . </S>"
  ]
}