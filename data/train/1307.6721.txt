{
  "article_text": [
    "we use standard notations and terminology of graph theory , see for instance @xcite . the graphs considered here are finite and undirected without multiple edges and loops . given a graph @xmath2",
    ", we write @xmath21 for the vertex set and @xmath22 for the edge set .",
    "a _ homomorphism _ from a graph @xmath1 to a graph @xmath2 is a mapping @xmath23 such that the images of adjacent vertices are adjacent .",
    "denote by @xmath24 the set of homomorphisms from @xmath1 to @xmath2 and by @xmath0 the number of homomorphisms from @xmath1 to @xmath2 . throughout this article , we write @xmath25 and @xmath26 for the path and the star on @xmath10 vertices , respectively .",
    "the length of a path is the number of its edges .",
    "the _ union of graphs _ @xmath2 and @xmath1 is the graph @xmath27 with vertex set @xmath28 and edge set @xmath29 .",
    "a tree @xmath30 together with a root vertex @xmath31 will be denoted by @xmath32 .",
    "the problem of computing @xmath0 is difficult in general .",
    "however , there has been recent interest in counting homomorphisms between special graphs . in particular , formulas for computing the number of homomorphisms between two different paths",
    "were given in @xcite .",
    "but even for these special trees , the formulas are bulky and inelegant . in section  [ treewalk ] , by using the transfer - matrix method , we shall give an algorithm for computing the number of homomorphisms from trees to any graph .",
    "this algorithm will be called _ tree - walk algorithm_.    recently , the first author proved a conjecture of nikiforov concerning the number of closed walks on trees .",
    "he proved in @xcite that , for a fixed integer @xmath4 , the number of closed walks of length @xmath4 on trees of order @xmath10 attains its maximum at the star @xmath33 and its minimum at the path @xmath9 .",
    "in other words , @xmath34 where @xmath15 is a tree on @xmath10 vertices and @xmath35 is the cycle on @xmath4 vertices .",
    "bollobs and tyomkyn @xcite gave a variant of the first author s result by replacing the number of closed walks by the number of all walks , that is @xmath36 where @xmath15 is a tree on @xmath10 vertices .",
    "in both @xcite and @xcite , the authors use a certain transformation of trees . in @xcite , it is called the _ generalized tree shift _ , whereas in @xcite , it is renamed to _ kc - transformation_.    to define this transformation , let @xmath37 and @xmath38 be two vertices of a tree @xmath30 such that every interior vertex of the unique @xmath37@xmath38 path @xmath39 in @xmath30 has degree two , and write @xmath40 for the neighbor of @xmath38 on this path",
    ". denote by @xmath41 the set of neighbors of a vertex @xmath31 .",
    "the kc - transformation , @xmath42 , of the tree @xmath30 with respect to the path @xmath39 is obtained from @xmath30 by deleting all edges between @xmath38 and @xmath43 and adding the edges between @xmath37 and @xmath43 instead ( see fig .",
    "note that @xmath42 and @xmath44 are isomorphic .",
    "the following property of kc - transformation was proved in  @xcite .",
    "[ pr1 ] the kc - transformation gives rise to a graded poset of trees on @xmath10 vertices with the star as the largest and the path as the smallest element .",
    "see figure  [ poset ] .",
    "in @xcite the first author proved that the kc - transformation increases the number of closed walks of fixed length in trees . by proposition  [ pr1 ] , this leads to the proof of inequality  .    in the very same spirit , bollobs and tyomkyn",
    "@xcite showed that the kc - transformation increases the number of walks of fixed length in trees . in the language of graph homomorphism",
    ", their result can be restated as follows .",
    "[ bollobs - tyomkyn ] [ th:1 ] let @xmath30 be a tree and let @xmath45 be obtained from @xmath30 by a kc - transformation .",
    "then @xmath46 for any @xmath47 .",
    "now a natural question arises : does inequality   still true when replacing @xmath12 by any tree ?",
    "a tree is called _ starlike _ if it has at most one vertex of degree greater than two .",
    "note that paths are starlike .",
    "we answer this question in the affirmative for starlike trees .",
    "[ of starlike ] let @xmath30 be a tree and @xmath45 the kc - transformation of @xmath30 with respect to a path of length @xmath48 .",
    "then the inequality @xmath49 holds when @xmath48 is even and @xmath1 is any tree , or @xmath48 is odd and @xmath1 is a starlike tree .",
    "moreover , we find a counterexample for inequality   when @xmath48 is odd and @xmath1 is not a starlike tree ( see the end of section  [ treewalks ] ) .",
    "another extremal problem concerning the number of homomorphisms between trees that worth considering is to find the extremal trees for @xmath50 over all trees on @xmath4 vertices . for",
    "this problem , we prove the following theorem , which can be considered as a dual of inequality  .    [ into paths ] let @xmath3 be a tree on @xmath4 vertices and let @xmath51 be obtained from @xmath3 by a kc - transformation .",
    "* if @xmath10 is even , or @xmath10 is odd and @xmath52 , then @xmath53 * for any @xmath54 , @xmath55    note that inequality   is not true in general when @xmath10 is odd and @xmath56 is greater than @xmath57 ; see fig .",
    "[ counter2 ] for a counterexample .    for the sake of keeping this paper",
    "self - contained , we will also give a new proof for the following theorem of sidorenko @xcite concerning the extremal property of the stars among trees .",
    "note that fiol and garriga  @xcite proved the special case of this theorem when @xmath58 , clearly , they were not aware of the work of sidorenko .",
    "[ of stars ] let @xmath2 be an arbitrary graph and let @xmath3 be a tree on @xmath4 vertices .",
    "then @xmath59    we have already seen a few examples to the phenomenon that in many extremal problems concerning trees it turns out that the maximal ( minimal ) value of the examined parameter is attained at the star and the minimal ( maximal ) value is attained at the path among trees on @xmath10 vertices ( cf .",
    "@xcite ) . in what follows",
    "we will show that this phenomenon occurs quite frequently if one studies homomorphisms of trees .",
    "let @xmath60 be the starlike tree on @xmath61 vertices which has exactly @xmath62 leaves and the vertex of degree @xmath62 has distance @xmath63 from the leaves , respectively .",
    "[ minimality - path ] let @xmath15 be a tree on @xmath10 vertices . assume that for a tree @xmath3 we have @xmath64 then @xmath65 and @xmath10 is even .",
    "in fact , we conjecture that we only have to exclude the case @xmath66 and @xmath67 .",
    "[ disappointment ] let @xmath15 be a tree on @xmath10 vertices , where @xmath17 .",
    "then for any tree @xmath3 we have @xmath68    an _ endomorphism _ of a graph is a homomorphism from the graph to itself . for a graph @xmath2 ,",
    "denote by @xmath69 the set of endomorphisms of @xmath2 .",
    "we remark that @xmath69 forms a monoid with respect to the composition of mappings .",
    "one of the main results of this paper is the following extremal property about the number of endomorphisms of trees .",
    "[ main ] for all trees @xmath15 on @xmath10 vertices we have @xmath70    this paper is organized as follows . in section  [ treewalk ] , we state the tree - walk algorithm . in section",
    "[ arb : graph ] , we prove some lower bounds involving markov chains and an upper bound ( theorem  [ of stars ] ) for the number of homomorphisms from trees to an arbitrary graph .",
    "section  [ treewalks ] is devoted to the proof of theorem  [ of starlike ] .",
    "the proofs of theorem  [ minimality - path ] and theorem  [ main ] are given in section  [ main : section ] , where some lower bounds concerning the homomorphisms of arbitrary trees are also proved . in section  [ homtopath ]",
    "we prove theorem  [ into paths ] , this part can be read separately , it only builds on the algorithm of section  [ treewalk ] .    in order to make our paper transparent , we offer the following two tables , figure  [ table1 ] and [ table2 ] , which summarize our results . in both tables ,",
    "the first row follows from theorem  [ th:1 ] or its generalization corollary  [ ex : totree ] .",
    "the last row is obvious since @xmath71 is the sum of degree powers of @xmath2 and it also follows from corollary  [ ex : totree ] .",
    "the first , second and third columns follow from theorem  [ into paths ] , theorem  [ of stars ] and corollary  [ to stars ] respectively .",
    "the  @xmath72 \" means that there is no inequality between the two expressions in general and the `` '' means that we do nt know whether the statement is true or not .",
    "@xmath73    @xmath74",
    "in this section we shall state an algorithm for the number of homomorphisms from a tree to any graph by the transfer - matrix method . as a generalized concept of walks in graphs",
    ", we call a homomorphism from a tree to a graph a _ tree - walk _ on this graph .",
    "let @xmath75 and @xmath76 be two vectors .",
    "we usually denote by @xmath77 the _ norm _ of @xmath78 and by @xmath79 the _ hadamard product _ of @xmath78 and @xmath80 .",
    "denote by @xmath81 the @xmath10-dimensional row vector with all entries are equal to @xmath82 .",
    "let @xmath2 be a graph with @xmath10 vertices .",
    "the _ adjacency matrix _ of @xmath2 is the @xmath83 matrix @xmath84 , where @xmath85 when @xmath86 , otherwise @xmath87 .",
    "we begin with a fundamental lemma about the number of walks in a graph .",
    "[ le:1 ] let @xmath2 be a labeled graph and @xmath88 the adjacency matrix of @xmath2 .",
    "then the @xmath89-entry of the matrix @xmath90 counts the number of walks in @xmath2 from vertex @xmath91 to vertex @xmath92 with length @xmath10 .    by easy induction on @xmath10 .",
    "see for example ( * ? ? ?",
    "* theorem 4.7.1 ) .",
    "let @xmath30 be a tree and @xmath2 be a graph with vertices labeled by @xmath93 .",
    "let @xmath94 be any vertex of @xmath30 .",
    "the @xmath10-dimensional vector @xmath95 where @xmath96 is called the _ hom - vector _ at @xmath31 from @xmath30 to @xmath2 . clearly , @xmath97 .",
    "the following tree - walk algorithm can be viewed as a generalization of lemma  [ le:1 ] for computing the number of tree - walks in graphs . 0.1 in    * the tree - walk algorithm .",
    "* let @xmath88 be the adjacency matrix of the labeled graph @xmath2 .",
    "let @xmath31 be a leaf of the tree @xmath30 .",
    "we now give the algorithm to compute @xmath98 .",
    "starting from a leaf of the tree @xmath30 other than @xmath31 ( a tree usually has at least two leaves ) , @xmath99 say . walking along the tree until you come to the first vertex with degree greater than two , @xmath100 say .",
    "let @xmath101 denote the path from @xmath99 to @xmath100 with length @xmath102 .",
    "by lemma  [ le:1 ] , we have @xmath103 .",
    "if the degree of vertex @xmath100 is @xmath48 , we denote its @xmath104 branches other than @xmath101 by @xmath105 .",
    "there is one branch that contains the vertex @xmath31 , @xmath106 say",
    ". we can compute the hom - vectors @xmath107 by recursively using this algorithm .",
    "clearly we have @xmath108 where @xmath109 is the union of @xmath110 , @xmath111 .",
    "now continue to walk on the tree @xmath30 from @xmath100 along the branch @xmath106 until you go to the first vertex with degree bigger than two , @xmath112 say .",
    "let @xmath113 be the length of the path , denoted by @xmath39 , from @xmath114 to @xmath115 .",
    "by induction on @xmath113 , one easily shows that @xmath116 which is the most important operation of this algorithm .",
    "do the same thing on @xmath112 as what we have done on @xmath100 , and the process stop until we walk to the last vertex of @xmath30 , which must be @xmath31 according to the algorithm . at the same time , the hom - vector at @xmath31 from @xmath30 to @xmath2 is obtained and thus @xmath117 .",
    "note that we can modify this algorithm to obtain @xmath98 at any vertex @xmath94 by using operation  .",
    "the following typical example would explain our algorithm better .",
    "let @xmath30 be the tree in fig .",
    "we also choose @xmath2 to be @xmath30 .",
    "denote by @xmath118 $ ] the induced subtree on the vertex set @xmath119 . to compute @xmath120 by tree - walk algorithm , we start at vertex @xmath121 and first stop at @xmath122 which is a vertex with degree greater than two . by lemma  [ le:1 ]",
    "we have @xmath123,4,t)={\\bf 1_{7 } } a_t^{2}=(3,3,5,6,4,2,3).\\ ] ] using the algorithm recursively , to compute @xmath124,4,t)$ ] , we start at vertex @xmath82 and first stop at @xmath62 . by operation  , we have @xmath125,3,t)=&{\\bf h}(t[1,3],3,t)\\ast{\\bf h}(t[2,3],3,t)\\\\ = & ( { \\bf 1_{7 } } a_t)\\ast({\\bf 1_{7 } } a_t ) = ( 1,1,9,9,4,1,1 ) . \\end{aligned}\\ ] ] we continue to walk from vertex @xmath62 and stop at @xmath122 , by operation   we get @xmath126,4,t)={\\bf h}(t[1,2,3],3,t)a_t=(9,9,11,14,10,4,9).\\ ] ] now again by operation we have @xmath127,4,t)=&{\\bf h}(t[1,2,3,4],4,t)\\ast{\\bf h}(t[6,5,4],4,t)\\\\ = & ( 27,27,55,84,40,8,27).\\end{aligned}\\ ] ] to finish the computing , we continue to walk from @xmath122 and at last stop at @xmath128 and apply   again we get @xmath129,4,t)a_t = ( 55,55,138,122,92,40,84).\\end{aligned}\\ ] ] thus @xmath130    * alternative way : recursions .",
    "* there is an alternative way to think to the tree - walk algorithm , namely we consider two type of recursion steps .",
    "* recursion 1 . *",
    "if we have a tree @xmath30 with a non - leaf root vertex @xmath31 , then we can decompose @xmath30 to @xmath131 such that @xmath132 , and @xmath133 and @xmath134 are strictly smaller than @xmath30 . in this case @xmath135",
    "* recursion 2 .",
    "* if we have a tree @xmath30 with a root vertex @xmath31 which is a leaf with the unique neighbor @xmath136 then @xmath137 where @xmath138 is the adjacency matrix of @xmath2 .",
    "hence we use recursion 1 or recursion 2 according to the root vertex @xmath31 is a non - leaf or a leaf . in most of the proofs",
    "we simply check whether some property of the vector @xmath98 remains valid after applying recursion 1 and recursion 2 .",
    "[ markov ] let @xmath2 be a graph and let @xmath139 be a markov chain on @xmath2 : @xmath140 where @xmath141 and @xmath142 if @xmath143 .",
    "let @xmath144 be the stationary distribution of @xmath39 : @xmath145 let us define the following entropies : @xmath146 and @xmath147 where @xmath148 is the degree of the vertex @xmath91 , and let @xmath149 let @xmath3 be a tree with @xmath150 leaves on @xmath4 vertices , where @xmath151 .",
    "then @xmath152    let @xmath31 be a root of @xmath30 .",
    "let @xmath153 be the number of homomorphisms of @xmath3 into @xmath2 such that the root vertex @xmath31 goes into the vertex @xmath154 .",
    "let @xmath155    we will show by induction on @xmath4 that @xmath156 where @xmath157 is the number of leaves different from @xmath31 , so it is @xmath150 if @xmath31 is not a leaf and @xmath158 if @xmath31 is a leaf .",
    "note that @xmath159    if @xmath31 is not a leaf of @xmath3 , then we can decompose @xmath3 to @xmath160 and @xmath161 .",
    "then @xmath162 because of the hadamard - products of the hom - vectors . from this",
    "the claim follows immediately by induction .",
    "if @xmath31 is a leaf of @xmath3 with the unique neighbor @xmath136 , then let @xmath163 so @xmath164",
    ".    for positive numbers @xmath165 and positive weights @xmath166 with @xmath167 , the weighted am - gm inequality says that @xmath168 @xmath169 hence @xmath170 @xmath171 in the last step we used that @xmath172 is a stationary distribution with respect to @xmath39",
    ". hence @xmath173 now the claim follows by induction .",
    "to finish the proof of the theorem , we only have to choose a nonleaf root and use that @xmath174    note that the inequality @xmath175 always hold .",
    "consequently , @xmath176 as theorem  [ markov ] suggests , this is an inequality for entropies and indeed , it can be proved by this way . by @xmath39 and @xmath172",
    ", we defined a distribution on the set of homomorphisms : we choose a root according to @xmath172 , then we choose every nonleaf new vertex according to @xmath39 and finally we choose the leaves uniformly .",
    "the entropy of this distribution is exactly @xmath177 since every nonleaf vertex has distribution @xmath172 .",
    "note that this entropy is smaller than the entropy of the uniform distribution , that is , @xmath178 . for basic facts about entropy ,",
    "see for example  @xcite .",
    "[ spectral - markov ] let @xmath2 be a connected graph on the vertex set @xmath179 and let @xmath7 be the largest eigenvalue of the adjacency matrix of the graph @xmath2 .",
    "let @xmath180 be a positive eigenvector of unit length corresponding to @xmath7 .",
    "let @xmath181 .",
    "then for any rooted tree @xmath3 on @xmath4 vertices we have @xmath182 where @xmath183 is the spectral entropy of the graph @xmath2 .",
    "we will use theorem  [ markov ] .",
    "let @xmath184 .",
    "since @xmath180 is a positive eigenvector , we have @xmath185 . for all @xmath91 we have @xmath186 ,",
    "thus @xmath187 .",
    "for @xmath181 we have @xmath188 hence @xmath189 this means that @xmath139 is a markov chain with stationary distribution @xmath144 .",
    "the conditional entropy @xmath190 @xmath191 hence the result follows from theorem  [ markov ] .",
    "a markov chain is called reversible if @xmath192 for all @xmath193 .",
    "as we have seen , the markov chain constructed in the previous proof is reversible .",
    "it is not hard to show that on trees every markov chains are reversible .",
    "theorem  [ spectral - markov ] is the best possible in the sense that there can not be a larger number than @xmath7 in such a statement since @xmath194 indeed , @xmath195    note that we can deduce that if @xmath196 is a sequence of trees such that @xmath3 has @xmath4 vertices then @xmath197 this result could have been deduced as well from a theorem of b. rossman and e. vee  @xcite claiming that @xmath198 where @xmath199 is the cycle on @xmath4 vertices .",
    "in fact , this was proved for directed trees and cycles , but it implies the inequality for undirected tree and cycle .",
    "this result can also be deduced from theorem 3.1 of @xcite .",
    "[ degree - markov ] let @xmath2 be a graph on the vertex set @xmath179 with @xmath200 edges and with degree sequence @xmath201 .",
    "then for any tree @xmath3 on @xmath4 vertices we have @xmath202 where @xmath203    let us consider the following classical markov chain : @xmath204 if @xmath205 . the stationary distribution is @xmath206 . note that @xmath207 and @xmath208 hence the result follows from theorem  [ markov ]",
    "the homomorphism density @xmath209 is defined as follows : @xmath210 this is the probability that a random map is a homomorphism .",
    "sidorenko s conjecture says that @xmath211 for every bipartite graph @xmath1 with @xmath212 edges .",
    "it is known that sidorenko s conjecture  @xcite is true for trees . by now , there are many proofs for this particular case of sidorenko s conjecture : see @xcite and it can be deduced as well from theorem 3.1 of  @xcite . below",
    "we give a new proof for this fact .    for any tree @xmath3 on @xmath4 vertices and a graph @xmath2",
    "we have @xmath213    let @xmath214 .",
    "the theorem will immediately follows form theorem  [ degree - markov ] . by convexity of the function",
    "@xmath215 we have @xmath216 hence @xmath217      the objective of this section is to give a new proof for theorem  [ of stars ] in order to keep this paper self - contained .",
    "this was proved originally by sidorenko @xcite .",
    "our proof is very similar to the original one , but it is slightly more elementary .    before we start the proof we will need two definitions and two lemmas .",
    "let @xmath218 and @xmath219 be two rooted graphs with root vertices @xmath136 and @xmath31 , respectively . then @xmath220 denotes the graph obtained from @xmath221 by identifying the vertices @xmath136 and @xmath31 .",
    "let @xmath222 be a graph with specified ( not necessarily distinct ) vertices @xmath136 and @xmath31 .",
    "let @xmath223 and @xmath224 be two graphs with root vertices @xmath225 and @xmath226 .",
    "finally , let the graphs @xmath227 and @xmath228 be obtained from @xmath229 as follows : @xmath230 @xmath231 @xmath232 ( in other words , in @xmath233 and @xmath228 we attach two copies of the same graph at the specified vertex . )",
    "then for any graph @xmath2 we have @xmath234    let @xmath193 and let @xmath235 denote the number of homomorphisms of @xmath222 to @xmath2 where @xmath136 goes to @xmath91 and @xmath31 goes to @xmath92 .",
    "we similarly define @xmath236 and @xmath237 .",
    "then @xmath238 similarly , @xmath239 and @xmath240 hence @xmath241 we are done .",
    "let @xmath242 be the distance of the vertices @xmath243 .",
    "then the _ wiener - index _",
    "@xmath244 of a graph @xmath2 is defined as @xmath245    in our application @xmath222 will be a tree and @xmath223 and @xmath224 be the trees on @xmath246 vertices .",
    "the following lemma about the wiener - index is trivial .",
    "let @xmath222 be a tree with distinct vertices @xmath136 and @xmath31 .",
    "let @xmath223 and @xmath224 be two copies of the two - node trees with root vertices @xmath225 and @xmath226 , respectively .",
    "finally , let the graphs @xmath227 and @xmath228 be obtained from @xmath229 as in the former lemma . then @xmath247 .",
    "let @xmath248 be the set of those trees @xmath249 on @xmath4 vertices for which @xmath250 is maximal .",
    "let @xmath251 be the tree for which @xmath252 is minimal . we show that @xmath253 .",
    "assume for contradiction that @xmath254 .",
    "then @xmath30 has two leaves , @xmath255 and @xmath256 such that @xmath257 .",
    "let @xmath136 and @xmath31 be the unique neighbors of @xmath255 and @xmath256 , respectively .",
    "then @xmath258 . let @xmath259 , @xmath260 and @xmath261 .",
    "then @xmath262 as in the lemmas , let @xmath231 @xmath232 note that @xmath233 and @xmath228 are also trees on @xmath4 vertices . by the lemma we have @xmath234 since @xmath263 , then @xmath264 .",
    "so @xmath265 implying that @xmath266 as well .",
    "but then @xmath267 , so one of them has strictly smaller wiener - index than @xmath30 , this contradicts the choice of @xmath30 .",
    "hence @xmath30 must be @xmath13 .",
    "after all , it is a natural question whether it is true or not that @xmath268 for any tree @xmath3 on @xmath4 vertices .",
    "surprisingly , the answer is no !",
    "it was already known to a. leontovich @xcite .",
    "it turns out that even if restrict @xmath2 to be tree there is a counterexample .",
    "let @xmath269 be the tree obtained from @xmath270 by putting a pendant edge to the third vertex of the path .",
    "then there is a tree @xmath30 for which @xmath271 the following tree @xmath30 is suitable : let @xmath272 be the tree where the root vertex @xmath273 have @xmath274 neighbors , all of its neighbors has @xmath275 neighbors and the vertices having distance @xmath246 from @xmath273 have @xmath276 neighbors . if we choose @xmath277 such that @xmath278 ( for instance @xmath279 , where @xmath280 and @xmath48 is large ) , then @xmath281",
    "the main purpose of this section is to prove theorem  [ of starlike ] .",
    "we shall give an inductive proof of theorem  [ th:1 ] which can be generalized to tree - walks by tree - walk algorithm .",
    "we first need some notations .",
    "let @xmath30 be a tree and @xmath282 its kc - transformation with respect to a path @xmath39 of length @xmath48 , a path with vertices labeled consecutively with @xmath283 .",
    "we denote by @xmath138 and @xmath233 the components of @xmath284 and @xmath285 in the subgraph of @xmath30 by deleting all the edges of @xmath39 .",
    "let @xmath286 , @xmath287 and @xmath288 be the components of @xmath45 corresponding with components @xmath138 , @xmath233 and @xmath39 under the kc - transformation , respectively .",
    "the vertices of the path @xmath288 will be labeled consecutively with @xmath289 , where @xmath290 is corresponding to @xmath291 for @xmath292 .",
    "so @xmath293 in @xmath30 , and @xmath294 in @xmath45 .",
    "[ funny ] let @xmath295 be positive numbers satisfying the inequalities : @xmath296 , @xmath297 for @xmath298 . then @xmath299 and @xmath300 .",
    "clearly , we only have to prove that @xmath301 , the other inequality is trivial .",
    "note that @xmath302 .",
    "if one of @xmath303 , say @xmath304 then @xmath305 if both @xmath306 for @xmath298 , then @xmath307 @xmath308 hence we are done .",
    "we first treat the case of @xmath48 being even .    in this proof @xmath48",
    "is even : @xmath309 .",
    "we label @xmath310 with @xmath311 , @xmath312 with @xmath313 , @xmath314 with @xmath315 and @xmath316 with @xmath317 , where @xmath318 ( resp .",
    "@xmath319 ) is corresponding to @xmath320 ( resp .",
    "@xmath321 ) under the kc - transformation . for @xmath322 , we always write @xmath323 and @xmath324 where we use the labels of vertices of @xmath30 and @xmath45 to index the parameters of the hom - vectors to @xmath30 and @xmath45 respectively .",
    "we hope that it will not cause any confusion .",
    "we shall prove by induction on the steps of tree - walk algorithm that @xmath325 for @xmath326 .",
    "we simply write @xmath327 if two such hom - vectors from @xmath1 to @xmath30 and @xmath45 satisfy the inequalities  ,   and  .",
    "it is easy to verify that all these inequalities are satisfied after applying any recursion step of the tree - walk algorithm .",
    "when @xmath31 is a leaf of @xmath1 then it is trivial that these inequalities are preserved .",
    "if @xmath31 is not a leaf then we use lemma  [ funny ] to see that the hadamard - product preserves these inequalities .",
    "[ path - odd k ] let @xmath48 be odd and assume that @xmath138 and @xmath233 have at least two vertices .",
    "let @xmath328 denote the number of homomorphism of @xmath329 into @xmath30 and @xmath45 , respectively , such that the endvertex of @xmath329 goes to the vertices @xmath330 and @xmath331 , respectively .",
    "then the following inequalities hold for every @xmath332 : @xmath333 for @xmath334 and @xmath335 .",
    "we prove the claim by induction on @xmath332 .",
    "for @xmath336 , the claim is trivial .",
    "note that we only have to prove that @xmath337 for @xmath334 and @xmath335 .",
    "we obtain the inequality @xmath338 by simply exchanging the role of @xmath138 and @xmath233 . also note that if we put @xmath339 in the inequality   and   we obtain that @xmath340 for @xmath341 .",
    "observe that for any vertex @xmath31 we have : @xmath342    we will treat the cases @xmath343 and @xmath344 separately .",
    "* case 1 : @xmath343 . * in this case , we have to prove the inequalities : @xmath345    the inequalities @xmath346 simply follow from the inequalities @xmath347 , and @xmath348 .",
    "observe that @xmath349 @xmath350 @xmath351 @xmath352 @xmath353 we used the induction hypothesis and that @xmath354 .",
    "in general , @xmath355 since any homomorphism of @xmath356 starting at the vertex @xmath136 can be extended to a homomorphism of @xmath357 starting at @xmath136 .",
    "clearly , we can get @xmath358 similarly , or we just switch the role of @xmath138 and @xmath233 .    finally , @xmath359 @xmath360 hence we are done in this case .",
    "* case 2 : @xmath344 . * clearly , the inequalities @xmath361 simply follow from the inequalities @xmath347 , and @xmath362 as before .",
    "so we only have to prove the inequality @xmath363 for @xmath335 .",
    "we can assume that @xmath364 .",
    "if @xmath365 , then @xmath366 and @xmath367 @xmath368    so we only have to consider the case @xmath369 .",
    "in this case we consider the cases @xmath370 separately .",
    "unfortunately , all of them behaves a bit differently .",
    "* subcase @xmath371 : * @xmath372 since @xmath373 , because @xmath374 .",
    "* subcase @xmath375 : * @xmath376 @xmath377 since @xmath373 and @xmath378 .",
    "* subcase @xmath379 : * here we jump back from @xmath332 to @xmath380 , so we need a few notations .",
    "let @xmath381 and @xmath382 denote the degree of @xmath383 in @xmath138 and @xmath233 , respectively .",
    "furthermore , let @xmath384 denote the distance of the vertices @xmath136 and @xmath31 .",
    "then @xmath385 @xmath386 @xmath387 @xmath388 since the inequality follows from the following inequalities : @xmath389    * subcase @xmath390 : * @xmath391 @xmath392 on the other hand , @xmath393 @xmath394 the inequality @xmath395 follows from @xmath396    * subcase @xmath397 : * @xmath398 @xmath399    from lemma  [ path - odd k ] we only keep the inequalities @xmath400 for @xmath401 .    for a tree @xmath1 and @xmath322 ,",
    "let us write @xmath323 and @xmath324 where we use the labels of vertices of @xmath30 and @xmath45 to index the parameters of the hom - vectors to @xmath30 and @xmath45 , respectively .",
    "we say that @xmath402 if the following inequalities hold @xmath403 for @xmath401 .",
    "as we have seen these inequalities hold for a path @xmath329 and its endvertex .",
    "since these inequalities are preserved for hadamard - product by lemma  [ funny ] , we see that @xmath404 for starlike trees @xmath1 , where @xmath31 is the center of the starlike tree .",
    "this implies that @xmath405    the following generalization of inequality   follows immediately from proposition  [ pr1 ] and theorem  [ of starlike ] .",
    "[ ex : totree ] let @xmath1 be a starlike tree and let @xmath15 be a tree on @xmath10 vertices",
    ". then @xmath406    the reader may wonder that if inequality holds when @xmath48 is odd and @xmath1 is not a starlike tree .",
    "this is not true in general .",
    "a counterexample will be constructed in the following , which also shows that @xmath407 is not true for any tree @xmath1 .",
    "[ bipartite ] let @xmath30 be a tree with color classes @xmath138 and @xmath233 considered as a bipartite graph .",
    "then @xmath408    [ to stars ] let @xmath3 be a tree on @xmath4 vertices , then @xmath409 if @xmath410",
    "then the second inequality is strict .    since @xmath30 and @xmath33 are bipartite graphs , a color class of @xmath30 have to go into a color class of @xmath33 .",
    "if the color class @xmath138 goes to the center of @xmath33 , then any vertex belonging to the color class of @xmath233 can go to any leaf of the star , so it provides @xmath411 homomorphisms .",
    "the other case provides @xmath412 homomorphisms .",
    "this simple proposition also shows us how to construct a tree @xmath15 for which @xmath413 .",
    "let @xmath414 be the doublestar on @xmath415 vertices with @xmath416 leaves and two vertices of degree @xmath48 .",
    "then it is easy to see that @xmath417 while @xmath418 hence for @xmath419 we have @xmath420 note that @xmath421 can be obtained from @xmath422 by a kc - transformation .",
    "in this section we give the proof of theorem  [ minimality - path ] and theorem  [ main ] .",
    "as we will see , theorem  [ minimality - path ] with some additional observations implies theorem  [ main ] .    to prove theorem  [ minimality - path ] we will build on the fact that there are not many homomorphisms into a path .",
    "indeed , by theorem  [ of stars ] we have @xmath423 so for a particular tree @xmath15 , it is enough to prove that for every tree @xmath3 we have @xmath424 this would immediately imply that @xmath425 we will prove that inequality  [ lower bound ] is indeed true for all tree @xmath15 with at least four leaves and for a large class of trees with three leaves . for the remaining trees with three leaves we use theorem  [ of starlike ] .    to prove theorem  [ minimality - path ] and theorem  [ main ]",
    "we can not rely entirely on the use of kc - transformation .",
    "that is why we had to find another strategy to prove these theorems .",
    "indeed , kc - transformation does not always increase the number of endomorphisms of trees .",
    "the first counterexample is the two trees on @xmath426 vertices in fig .",
    "[ counter3 ] .",
    "the tree @xmath427 is the kc - transformation of @xmath428 , but @xmath429      note that theorem  [ of stars ] and theorem  [ of starlike ] together implies the following chain of inequalities : @xmath430 since @xmath33 is a starlike tree . in this section , we will also give a direct proof for it .    * theorem  [ main]*(second part ) .",
    "let @xmath15 be a tree on @xmath10 vertices .",
    "then @xmath431 if @xmath432 then strict inequality holds .    for the sake of simplicity",
    "we prove the statement for @xmath433 .",
    "the same proof applies to @xmath434 , we only need to compute a bit more carefully . in the end of the proof we will give the details of this more precise calculation .",
    "note that @xmath435 .",
    "let @xmath15 be a tree on @xmath10 vertices and let @xmath436 be its degree sequence .",
    "note that @xmath437 , since the tree has only @xmath57 edges and the stars corresponding to the first two largest degrees can share at most one common edge .",
    "first we prove that @xmath438 . to see it ,",
    "let @xmath439 be the vertices of the tree @xmath15 such that @xmath440 induces a tree for every @xmath48 .",
    "then we can chose the image of @xmath441 by @xmath10 ways , and if we have already chosen the image of @xmath442 , then we can chose the image of @xmath443 in at most @xmath444 ways , since it must be the neighbor of some previous vertex .",
    "this means that @xmath445 .    if @xmath446 then @xmath447 if @xmath448 , since then @xmath449    so we can assume that @xmath450 .",
    "set @xmath451 .",
    "we can assume that @xmath432 , consequently @xmath452 .",
    "let @xmath114 be the vertex having the largest degree and @xmath453 its neighbors .",
    "now we can decompose the set of endomorphisms according to the image of @xmath114 is @xmath114 or not .",
    "if it is @xmath114 then there can be at most @xmath454 such endomorphisms .",
    "if the image of @xmath114 is not @xmath114 , then we can chose that image in at most @xmath455 ways and the image of @xmath456 can be chosen at most @xmath113 times and the image of all other vertices can be chosen in at most @xmath444 ways . hence @xmath457 all we need to prove is that if @xmath458 then @xmath459 with the notations @xmath451 we have @xmath460 by the binomial theorem we have @xmath461 it is enough to prove that @xmath462 .",
    "this is equivalent with @xmath463 and it is true since it is equivalent with @xmath464 in the last step we have used that @xmath465 .",
    "it is clear from the proof that we only have to check whether one of the inequalities hold for some @xmath444 : @xmath466 for @xmath467 it is easy to see that if @xmath468 then the first inequality holds and if @xmath469 , equivalently @xmath470 then the second inequality holds .",
    "for @xmath471 the first inequality holds if @xmath472 , and the second inequality holds if @xmath473 , equivalently @xmath474 . for @xmath66 the claim is trivial @xmath475 .",
    "[ geq 4 leaves ] let @xmath3 and @xmath15 be trees on @xmath4 and @xmath10 vertices , respectively . if the tree @xmath15 has at least four leaves , then @xmath476    an easy consequence of this theorem is the following .",
    "[ 4l ] if @xmath15 is a tree on @xmath10 vertices with at least @xmath122 leaves , then @xmath477    indeed , @xmath478 where the second inequality follows from theorem  [ of stars ] .",
    "a consequence of this theorem is that path has the minimal number of endomorphisms .",
    "* theorem  [ main]*(first part ) .",
    "for all trees @xmath15 on @xmath10 vertices we have @xmath479    if @xmath15 has at least four leaves , then @xmath480 where the first inequality follows from corollary  [ 4l ] , while the second inequality follows from theorem  [ into paths ] . if the tree @xmath15 has exactly three leaves , then it is star - like .",
    "hence we can use theorem  [ of starlike ] to prove the first inequality : @xmath481    the proof of theorem  [ geq 4 leaves ] will be given next , which would complete the proof of theorem  [ main ] .",
    "first , we prove a reduction lemma which says that we only have to prove theorem  [ geq 4 leaves ] for trees with exactly @xmath122 leaves .",
    "[ reduction ] let @xmath3 be a tree on @xmath4 vertices and let @xmath10 be fixed",
    ". assume that for all tree @xmath482 we have @xmath483 where @xmath484 and @xmath482 has at least four leaves , or @xmath485 and @xmath482 has exactly four leaves .",
    "then for any tree @xmath15 on @xmath10 vertices with at least @xmath122 leaves we have @xmath476    in the proof of this lemma we will subsequently use the following very simple fact .",
    "if @xmath2 is a graph and @xmath486 are induced subgraphs of @xmath2 with possible intersection , then for any graph @xmath1 we have @xmath487    we can assume that @xmath488 .",
    "assume that @xmath15 is tree with at least @xmath489 leaves .",
    "otherwise we have nothing to prove .",
    "let us call a path maximal in @xmath15 if it connects leaves .",
    "if a maximal path contains @xmath48 vertices of degree at least @xmath62 , then we say that the maximal path has @xmath48 branches .",
    "first we prove the statement if @xmath15 contains a maximal path with at least @xmath62 branches .",
    "let @xmath490 be a maximal path with vertices @xmath440 having degree at least @xmath62 .",
    "let @xmath491 be the branches which we get if we delete all vertices and edges of the path @xmath490 except @xmath492 .",
    "so @xmath493 is a rooted tree with root @xmath494 .",
    "let @xmath495 and @xmath496 be the two neighbors of @xmath497 on the path @xmath490 .",
    "let @xmath134 be the tree induced by the vertices @xmath498 .",
    "let @xmath499 .",
    "we distinguish two cases .",
    "_ 1 . case .",
    "_ in this case we assume that @xmath500 .",
    "consider the following trees @xmath501 and @xmath502 .",
    "@xmath501 is the tree spanned by the vertices @xmath503 and the branches @xmath504 .",
    "@xmath502 is the tree spanned by the vertices @xmath505 and the branches @xmath506 .",
    "note that @xmath507 , @xmath508 and @xmath486 contains at least @xmath122 leaves , because @xmath344 . by the hypothesis of the lemma we have @xmath509 for @xmath298 . hence @xmath510",
    "@xmath511 @xmath512 in this case we are done .",
    "_ 2 . case .",
    "in this case we assume that @xmath513 .",
    "consider the following trees @xmath501 and @xmath502 .",
    "@xmath501 is the tree spanned by the vertices @xmath514 .",
    "@xmath502 is simply @xmath134 .",
    "note that @xmath507 , @xmath515 and @xmath501 contains at least @xmath122 vertices . by the hypothesis of the lemma we have @xmath516 we also know that in this case @xmath517 note that @xmath518 then @xmath510 @xmath511 @xmath512 in this case we are done too .",
    "hence if one of the maximal path of @xmath15 has at least @xmath62 branches then we are done .",
    "we still have to consider the trees @xmath15 where all maximal paths have at most @xmath246 branches . in the following",
    "we show that they have quite simple structure : they are starlike or double starlike trees , see figure  [ doublestarlike ] .",
    "let @xmath114 be a vertex of @xmath15 of degree at least @xmath62 .",
    "let us decompose @xmath15 to the branches @xmath519 at @xmath114 .",
    "so @xmath114 is a leaf in the trees @xmath519 .",
    "we show that all except at most one of @xmath520 are paths .",
    "assume that , for instance , @xmath504 are not paths .",
    "then they contains at least two leaves of @xmath15 : @xmath521 contains @xmath522 , @xmath523 contains @xmath524",
    ". then the maximal path @xmath525 has at least three branches : one - one inside the branches @xmath521 and @xmath523 and @xmath526 at the vertex @xmath31 .",
    "if all branches are paths , then we are done : @xmath15 is starlike .",
    "if one of them is not path , say @xmath521 , then let us consider the vertex @xmath527 having degree at least @xmath62 which is closest to @xmath114 . repeating the previous argument to @xmath115 instead of @xmath114 , all except one branches at @xmath115 must be path and we also know that the branch containing @xmath114 is not path .",
    "hence the tree is double starlike , where the middle path is @xmath528 .",
    "we can consider a starlike tree as a double starlike tree , where @xmath529 .",
    "let @xmath530 and @xmath531 be the leaves of @xmath15 , where @xmath530 are closer to @xmath114 than to @xmath115 , while @xmath531 are closer to @xmath115 than to @xmath114 . if @xmath529 we just decompose the set of leaves into two sets of ( almost ) equal size .",
    "note that @xmath532 . since we can assume that there are at least @xmath489 leaves , we assume that @xmath533 .",
    "if @xmath534 are some vertices of a tree , then we say that the tree spanned by @xmath534 is the smallest subtree which contains the vertices @xmath534 .",
    "it is @xmath535    if @xmath536 and @xmath537 both hold , then let @xmath501 be the tree spanned by the vertices @xmath538 , and let @xmath502 be the tree spanned by the vertices @xmath539 .",
    "then @xmath507 , @xmath540 and both @xmath486 have at least @xmath122 leaves . since @xmath541 @xmath542 we have @xmath510 @xmath511 @xmath543",
    "hence we are done in this case .",
    "if @xmath544 and @xmath545 then let @xmath501 be the tree spanned by @xmath538 and let @xmath502 be the tree spanned by @xmath546 .",
    "then @xmath547 , @xmath548 and both @xmath486 have at least @xmath122 leaves . in this case",
    "we are done as before .",
    "clearly , the case @xmath549 and @xmath550 is completely similar .",
    "the last case is @xmath551 ( and @xmath552 ) .",
    "let @xmath553 , @xmath554 , @xmath555 , @xmath556 .",
    "then @xmath557 , @xmath558 .",
    "note that @xmath559 has @xmath122 leaves , thus @xmath560 for @xmath561 .",
    "if @xmath562 , then from @xmath563 , @xmath564 we obtain that @xmath565 .",
    "if @xmath566 , then from @xmath567 we obtain that @xmath565 .",
    "hence we are done in this case as well .",
    "[ weak-4leaves ] let @xmath15 be a tree with exactly @xmath122 leaves and two vertices of degree @xmath62 .",
    "let @xmath37 and @xmath38 be the vertices of @xmath15 with degree @xmath62 .",
    "assume that there are at most @xmath62 vertices of @xmath15 which have degree @xmath246 and not on the path @xmath568 .",
    "then for any tree @xmath3 on @xmath4 vertices we have @xmath569 where @xmath10 is the number of vertices of @xmath2 .",
    "we can assume that @xmath570 , otherwise the statement is trivial .",
    "we prove the slightly stronger inequality @xmath571 if @xmath570 , then this implies that @xmath572 or equivalently , @xmath476 to prove this statement we use theorem  [ markov ] with a suitable markov chain .",
    "let @xmath573 for @xmath574 if @xmath91 has degree @xmath246 . naturally , @xmath575 if @xmath576 and @xmath91 is a leaf . finally , if @xmath577 , @xmath578 then @xmath573 and if @xmath577 , @xmath579 then @xmath580 .    let @xmath332 be the number of vertices of @xmath568 .",
    "then @xmath581 . let @xmath582 .",
    "then the stationary distribution is the following : @xmath583 if @xmath584 , @xmath585 if @xmath586 , but has degree @xmath246 and finally , @xmath587 if @xmath91 is a leaf .",
    "then @xmath588 on the other hand , @xmath589 @xmath590 @xmath591 note that @xmath592 @xmath593 hence if @xmath594 then @xmath595 consequently @xmath596 the above inequality is satisfied if @xmath597 this proves the statement of the theorem .",
    "[ weak-4leaves2 ] let @xmath15 be a tree obtained from a path on @xmath598 vertices by gluing one - one @xmath599 at the middle vertices to both ends of the path @xmath600 ( see fig .  [ two ] ) .",
    "then for any tree @xmath3 on @xmath4 vertices we have @xmath601    we will show by induction on @xmath4 that @xmath602 let @xmath31 be any leaf of @xmath3 with unique neighbor @xmath136 and let @xmath603 be a rooted tree with root @xmath136 .",
    "let us use the hom - vectors of the fig .",
    "[ two ] , that is @xmath604 now suppose that @xmath605 it is easy to see by induction that @xmath606 if @xmath607 has at least two vertices . by tree - walk algorithm",
    ", we have @xmath608 which shows  .    next we introduce a transformation which we will call ls - switch ( large - small switch ) .",
    "let @xmath609 be a tree with specified vertices @xmath136 and @xmath31 such that the distance of @xmath136 and @xmath31 is even and @xmath610 has an automorphism of order @xmath246 which exchanges the vertices @xmath136 and @xmath31 .",
    "let @xmath611 be rooted trees such that @xmath612 is the rooted subtree of @xmath613 and @xmath614 is the rooted subtree of @xmath615 .",
    "let the tree @xmath30 be obtained from the trees @xmath616 by attaching a copy of @xmath617 to @xmath609 at vertex @xmath136 and a copy of @xmath618 at vertex @xmath31 .",
    "assume that the tree @xmath45 is obtained from the trees @xmath616 by attaching a copy of @xmath619 to @xmath609 at vertex @xmath136 and a copy of @xmath620 at vertex @xmath31 .",
    "then @xmath45 is the ls - switch of @xmath30 .",
    "observe that there is a natural bijection between the color classes of @xmath45 and @xmath30 .",
    "a particular case of the ls - switch is when @xmath609 is a path of even length with end vertices @xmath136 and @xmath31 , @xmath612 and @xmath614 are one - vertex rooted trees , then @xmath45 is obtained from @xmath30 by an even - kc - transformation , i.e. , kc - transformation according to a path of even length .",
    "another useful special case is when @xmath609 is a tree where we attach an arbitrary tree to the middle vertex of the path on @xmath62 vertices and @xmath136 and @xmath31 are the end vertices of the path ( in this case the automorphism simply switches @xmath136 and @xmath31 ) , and @xmath620 are the rooted trees with @xmath82 vertex , in this case we get back to a particular case of the original _ kelmans - transformation _  @xcite .    actually , the following theorem with respect to the ls - switch is also true and its proof is just a trivial extension of the even case of theorem  [ of starlike ] .",
    "let @xmath45 be the ls - switch of @xmath30 .",
    "let @xmath1 be an arbitrary tree .",
    "then @xmath621    ( sketch . ) the unique shortest path connecting all @xmath622 s in @xmath30 ( or @xmath45 ) will be denoted by @xmath623 , a path of even length with vertices labeled consecutively by @xmath624 . without loss of generality",
    ", we can assume that @xmath625 .",
    "for @xmath626 , let @xmath627 denote the component of @xmath30 that contains the vertex @xmath92 when we delete all the edges of @xmath623 . by the definition of ls - switch ,",
    "the subtrees @xmath627 and @xmath628 are isomorphic , so we can identify @xmath629 with @xmath630 .",
    "we will also consider @xmath631 as the subset of @xmath632 and @xmath633 as the subset of @xmath634 .",
    "let @xmath31 be a vertex of @xmath1 . for @xmath635 , @xmath636 ( @xmath637 ) and @xmath638 ( @xmath626 )",
    ", we define @xmath639 @xmath640 and @xmath641 we prove by induction that the following inequalities are preserved by the steps of the tree - walk algorithm . for any @xmath642 , @xmath638 ( @xmath643 ) , @xmath644 , @xmath645 , @xmath646 and @xmath647 we have @xmath648 we only need to check that the two operations in the tree - walk algorithm preserve all the above inequalities , which is routine and left to the reader .",
    "[ 4-leaves ] let @xmath15 be a tree on @xmath10 vertices with exactly four leaves .",
    "then for any tree @xmath3 on @xmath4 vertices we have @xmath569 where @xmath10 is the number of vertices of @xmath15 .",
    "if @xmath15 has a vertex of degree @xmath122 then by theorem  [ degree - markov ] we have @xmath649 where @xmath650",
    "hence @xmath651 now assume that @xmath15 has two vertices , @xmath37 and @xmath38 , of degree @xmath62 . among these trees ( @xmath10 vertices",
    ", @xmath122 leaves , two vertices of degree @xmath62 ) let us choose @xmath652 to be the one for which @xmath653 is minimal and among these trees the length of the path is maximal .",
    "let the four leaves of @xmath652 denoted by @xmath654 such that @xmath655 are closer to @xmath37 than @xmath38 , and @xmath656 are closer to @xmath38 than @xmath37 .",
    "let the number of edges of @xmath657 be @xmath658 , respectively .",
    "we show that @xmath659 . indeed ,",
    "if say @xmath660 then @xmath652 can be obtained by an ls - switch from a graph @xmath661 as follows .",
    "if @xmath256 is even , then let @xmath136 be the unique vertex such that @xmath662 .",
    "then @xmath663 is a path of even length .",
    "let @xmath664 .",
    "furthermore , let @xmath133 be the tree spanned by the vertices @xmath665 . @xmath666 and @xmath667",
    ". then @xmath134 is a rooted subtree of @xmath133 and @xmath668 is a rooted subtree of @xmath669 . now making an inverse ls - swith we obtain @xmath661 .",
    "we know that @xmath670 and in @xmath661 , the vertices of degree @xmath62 , @xmath38 and @xmath136 , has distance @xmath671 contradicting the choice of @xmath652 .",
    "if @xmath256 is odd , then let @xmath136 be the unique neighbor of @xmath672 and we repeat the previous argument .",
    "the distance of @xmath136 and @xmath37 is even again .",
    "hence we can assume that @xmath659 .",
    "if not all of them are @xmath246 , then we can use lemma  [ weak-4leaves ] to get that @xmath673 if @xmath674 , then we use lemma  [ weak-4leaves2 ] to obtain that @xmath675 this proves the statement .",
    "the statement immediately follows from lemma  [ 4-leaves ] and lemma  [ reduction ] .      [ 3-leaves ] ( a ) let @xmath676 , and @xmath677 .",
    "then for any tree @xmath3 on @xmath4 vertices we have @xmath678    \\(b ) let @xmath679 , and @xmath680 .",
    "then for any tree @xmath3 on @xmath4 vertices we have @xmath681    ( a )    we can think to @xmath60 with @xmath682 as follows : we consider @xmath683 and we subdivide the edges between the vertex of degree @xmath62 and its neighbors a few times .",
    "let us write the weights @xmath684 to the vertices of @xmath683 according to the figure and then let us write weights @xmath121 on the new vertices obtained by subdivision .",
    "it is easy to check that there is a unique markov chain on @xmath60 , where the stationary distribution is proportional to the weights .",
    "( in fact , we write a few transition probabilities on the figure . )",
    "it is easy to check that @xmath685 and if @xmath686 , then @xmath589 @xmath687 @xmath688 @xmath689 @xmath690 since @xmath691 we can choose @xmath692 to deduce that @xmath693 this is already greater than @xmath694 for @xmath151 .",
    "the statement is trivial for @xmath695 .",
    "( b )    we use completely the same argument as in part ( a ) .",
    "we think to @xmath696 as a subdivision of @xmath697 and use the markov chain on the figure .",
    "again we have @xmath685 and the sum of the weights is @xmath698 .",
    "hence @xmath699    since @xmath700 we can choose @xmath701 to deduce that @xmath693 this is already greater than @xmath694 for @xmath488 .",
    "the statement is trivial for @xmath702 .",
    "since every markov chains are reversible on a tree , there is a natural way to define a new markov chain on a subdivided edge .",
    "assume that the probabilities of the stationary distribution were @xmath703 and @xmath704 were the transition probabilities at the vertices @xmath705 .",
    "then @xmath192 ( reversibility ) and we can put a vertex @xmath332 with weight @xmath706 and @xmath707 on the edge @xmath89 . then the new stationary distribution will be proportional to the weights @xmath708 .    * theorem  [ minimality - path]*. let @xmath15 be a tree on @xmath10 vertices",
    ". assume that for a tree @xmath3 we have @xmath64 then @xmath65 and @xmath10 is even .",
    "note that if @xmath15 has at least @xmath122 leaves then theorem  [ 4-leaves ] implies that @xmath709 contradicting to the condition of the theorem .",
    "hence @xmath710 for some @xmath63 .",
    "observe that if one of @xmath63 is even then @xmath60 can be obtained from @xmath9 by an even - kc - transformation and then theorem  [ of starlike ] implies @xmath711 contradicting to the condition of the theorem .",
    "note that if @xmath10 is odd , then one of @xmath63 is necessarily even and so we are done . from lemma  [ 3-leaves ] we also know that @xmath712 , say @xmath713 and @xmath714 .",
    "but then @xmath715 , because it must be even .",
    "hence @xmath65 and @xmath10 is even .",
    "there is a tree @xmath3 for which @xmath716 .    on the figure",
    "one can see a rooted tree and its homomorphism vectors to @xmath717 and @xmath718 .",
    "now if we attach @xmath48 copies of this rooted tree at the root then for the obtained tree @xmath3 we have @xmath719 for large enough @xmath48 .    on the other hand , it seems that @xmath720 if @xmath721 and even .",
    "in this section we study the extremal problem about the number of homomorphisms from trees to a fixed path . the main purpose of this section is to prove theorem  [ into paths ] .",
    "as the theorem suggests we have to distinguish whether @xmath10 is even or odd .      in this section",
    "we will prove the part ( i ) of theorem  [ into paths ] .",
    "first we need some new definitions and lemmas .",
    "a vector @xmath75 is _ symmetric _ if @xmath722 for @xmath723 , and _ unimodal _ if @xmath724 for some @xmath92 .",
    "denote by @xmath725 the set of symmetric positive integer vectors of dimension @xmath10 . for any @xmath726 ,",
    "define the _ dominance order _ on @xmath727 by @xmath728 it is clear that @xmath727 is a poset with respect to this order and @xmath729 implies @xmath730 .",
    "let @xmath731 be the set of all unimodal vectors in @xmath725 .",
    "[ le : 2 ] let @xmath732 and @xmath733 such that @xmath734",
    ". then @xmath735 .",
    "it is clear that both @xmath736 and @xmath737 are in @xmath727 . for @xmath738 , by the symmetry property of @xmath739 and @xmath740 , we have the identity @xmath741 where @xmath742 . from @xmath732 and @xmath743 , we see that @xmath744 and @xmath745 for @xmath746 .",
    "thus the right - hand side of the above identity is nonnegative , which is equivalent to @xmath747 .",
    "it is clear that if @xmath748 then @xmath749 for any positive integer @xmath48 , where @xmath138 is the adjacency matrix of @xmath750 .",
    "but for the path with odd vertices , this is not true in general .    [",
    "le : 6 ] let @xmath138 be the adjacency matrix of @xmath25 and @xmath751 a positive integer . if @xmath752 , then @xmath753 .",
    "let @xmath75 , @xmath754 and @xmath755 . for @xmath756 ,",
    "the sum of coefficients of all @xmath757 ( @xmath758 ) in @xmath759 is the sum of @xmath92-th column of @xmath760 and the coefficient of @xmath761 in @xmath762 also equals the sum of @xmath92-th column of @xmath760 .",
    "it follows that the sum of coefficients of all @xmath153 ( @xmath763 ) in @xmath764 equals the sum of coefficients of all @xmath153 ( @xmath758 ) in @xmath765 .",
    "but for every @xmath91 , the coefficient of @xmath153 in @xmath766 is the sum of @xmath91-th row of @xmath767 and the coefficient of @xmath153 in @xmath768 is the sum of @xmath91-th column of @xmath767 , which are equal .",
    "thus @xmath769 follows from the unimodality of @xmath78 , which shows that @xmath753 .    before we prove part ( i ) of theorem  [ into paths ]",
    ", we show that we only have to prove the statement for the case of even @xmath10 since the following lemma implies it for the case of odd @xmath10 if @xmath770 .",
    "[ average ] if @xmath770 then @xmath771    let the vertices of @xmath9 be labeled consecutively by @xmath772 .",
    "we can decompose the set @xmath773 to the following two sets .",
    "the first set consists of those homomorphisms which do not contain the vertex @xmath10 in their image and the second set consists of those homomorphisms which contain the vertex @xmath10 in their image .",
    "clearly , the cardinality of the first set is @xmath774 .",
    "the cardinality of the second set will be denoted by @xmath775 .",
    "so @xmath776 we can repeat this argument with the path @xmath777 as well : @xmath778 rearranging this we obtain that @xmath779 the crucial observation is that @xmath780 indeed , if @xmath781 then @xmath782 because @xmath783 , so all these homomorphisms go to the path @xmath784 and therefore there is a natural correspondence between the two sets . hence if @xmath785 then by adding together eq .   and",
    "eq .   we obtain  eq .  .",
    "let @xmath138 be the adjacency matrix of @xmath9 .",
    "let @xmath786 be the kc - transformation of the tree @xmath3 with respect to a @xmath37@xmath38 path @xmath39 .",
    "let @xmath521 and @xmath523 be the components of @xmath38 and @xmath37 in the subgraph of @xmath3 by deleting all the edges of @xmath39 respectively .",
    "the case @xmath10 is even .",
    "it is easy to see that an element of @xmath787 multiplied by @xmath138 is still in @xmath787 and the hadamard product of two elements in @xmath787 is also in @xmath787 . by the tree - walk algorithm ,",
    "any hom - vector from a tree to @xmath9 is in @xmath787 .",
    "again by the tree - walk algorithm , we have @xmath788 and @xmath789 where @xmath48 is the length of the path @xmath39 . by lemma  [ le : 6 ]",
    ", we have @xmath790 it follows from lemma  [ le : 2 ] that @xmath791 , which implies @xmath792 .",
    "for the case of odd @xmath10 we have already seen that lemma  [ average ] implies the statement .",
    "the kc - transformation does not always increase the number of homomorphisms to the path @xmath9 when @xmath10 is odd .",
    "for example , in fig .",
    "[ counter2 ] , we have @xmath793 .      clearly , if @xmath10 is even or @xmath10 is odd and @xmath52 , then part ( i ) of theorem  [ into paths ] implies the part ( ii ) . in this subsection , we will develop some more transformations on trees to prove part ( ii ) of theorem  [ into paths ] for odd @xmath10 .",
    "* from now on in this subsection , @xmath10 is odd . *    for any @xmath794 , denote by @xmath795 the rooted tree with a root at @xmath136 . as usual",
    ", we will denote by @xmath796 the hom - vector of the rooted tree @xmath795 into @xmath2 .",
    "one can easily check that the hom - vector of a rooted tree into @xmath9 , i.e. , @xmath797 is not unimodal anymore . on the other hand ,",
    "the situation is not as bad as one may think after the first sight .",
    "we say that @xmath798 is _ symmetric bi - unimodal _ if the sequence itself is symmetric and the two subsequences @xmath799 and @xmath800 are unimodal .",
    "let @xmath795 be a rooted tree and @xmath801 be the hom - vector of @xmath795 into @xmath9 .",
    "then @xmath801 is symmetric bi - unimodal .",
    "this statement follows from the tree - walk algorithm and the observation that if @xmath798 and @xmath802 are symmetric bi - unimodal , then the sequences @xmath803 and @xmath804 are also symmetric bi - unimodal .",
    "the following one is a very surprising theorem .",
    "in fact , it is not true for even @xmath10 .",
    "let @xmath805 be a rooted tree and @xmath806 be its rooted subtree , i.e. , @xmath134 is subtree of @xmath133 and their roots are the same . let @xmath801 be the hom - vector of @xmath805 into @xmath9 and let @xmath807 be the hom - vector of @xmath806 into @xmath9 .",
    "assume that @xmath808 and @xmath809 , so @xmath91 is closer to the center than @xmath92 .",
    "then @xmath810    we need to prove that @xmath811 .",
    "( from this form it is clear that it is a natural associative ordering on rooted trees . )",
    "we prove this claim by induction on the number of vertices of @xmath805 .",
    "if @xmath812 then it is trivial to check the statement .",
    "if @xmath136 is not a leaf in @xmath133 then by induction this inequality holds for the branches at @xmath136 and then it is true for the hadamard products . if @xmath136 is a leaf in @xmath133 then so in @xmath134",
    "let @xmath31 be the unique neighbor of @xmath136 and let us consider the rooted trees @xmath813 and @xmath814 .",
    "let @xmath815 and @xmath816 be their hom - vectors .",
    "then , @xmath817 where @xmath818 .",
    "note that the numbers @xmath819 are still congruent modulo @xmath246 . because of the symmetry we can assume that @xmath820 .",
    "if in addition @xmath821 then we have @xmath822 and we can apply the induction hypothesis : @xmath823 in all four cases , thus @xmath824 if @xmath825 then the above four inequalities are still true , because @xmath826 are still closer to @xmath827 than the numbers @xmath828 .",
    "hence we have proved the statement .",
    "let @xmath805 be a rooted tree and let @xmath801 be its hom - vector .",
    "assume that @xmath829 and @xmath830",
    ". then @xmath831 .",
    "the proof is almost identical to the proof of the correlation inequality and thus is omitted .",
    "let @xmath832 be trees .",
    "let @xmath136 be an arbitrary vertex of @xmath133 and let @xmath138 and @xmath233 be the color classes of @xmath134 considered as a bipartite graph .",
    "let @xmath833 and @xmath834 be the number of homomorphisms from @xmath133 to @xmath134 where @xmath136 goes to @xmath138 and @xmath233 , respectively .",
    "then let @xmath835 note that @xmath836 is independent of the vertex @xmath136 .",
    "let the vertices of @xmath9 be labeled consecutively by @xmath772 . if @xmath837 then @xmath838 denotes the number of homomorphisms of @xmath133 into @xmath9 , where the image of @xmath136 is a vertex of even index and @xmath839 denotes the number of homomorphisms of @xmath133 into @xmath9 , where the image of @xmath136 is a vertex of odd index .",
    "thus in this case @xmath840    first we prove the following curious theorem on the function @xmath841 .",
    "[ g - path ] let @xmath3 be a tree on @xmath4 vertices",
    ". then @xmath842    we will prove theorem  [ g - path ] by using two transformations : the ls - switch and the so - called short - path shift .",
    "recall that the ls - switch is a generalization of the even - kc - transformation . for the sake of convenience we repeat its definition below .",
    "let @xmath609 be a tree with specified vertices @xmath136 and @xmath31 such that the distance of @xmath136 and @xmath31 is even and @xmath610 has an automorphism of order @xmath246 which exchanges the vertices @xmath136 and @xmath31 .",
    "let @xmath611 are rooted trees such that @xmath612 is the rooted subtree of @xmath613 and @xmath614 is the rooted subtree of @xmath615 .",
    "let the tree @xmath30 be obtained from the trees @xmath616 by attaching a copy of @xmath617 to @xmath609 at vertex @xmath136 and a copy of @xmath618 at vertex @xmath31 .",
    "assume that the tree @xmath45 is obtained from the trees @xmath616 by attaching a copy of @xmath619 to @xmath609 at vertex @xmath136 and a copy of @xmath620 at vertex @xmath31 .",
    "then @xmath45 is the ls - switch of @xmath30 .",
    "observe that there is a natural bijection between the color classes of @xmath45 and @xmath30 .",
    "this transformation seems to be quite general , but still the following theorem is true .",
    "[ ls - th ] let @xmath30 be a tree and @xmath45 be the ls - switch of @xmath30 .",
    "then @xmath843 for @xmath844 .",
    "in particular , @xmath845    let the vertices of @xmath9 be labeled consecutively by @xmath772 .",
    "for a rooted tree @xmath846 let @xmath847 denote the number of homomorphisms of @xmath30 into @xmath9 such that @xmath332 goes to the vertex @xmath91 .",
    "so @xmath848 is the hom - vector of @xmath846 into @xmath9 .",
    "let @xmath849 be the number of homomorphisms of @xmath609 into @xmath9 such that @xmath136 goes to @xmath91 and @xmath31 goes to @xmath92 .",
    "note that @xmath850 because of the automorphism of order @xmath246 of @xmath610 switching the vertices @xmath136 and @xmath31 .",
    "also note that @xmath851 if @xmath91 and @xmath92 are incongruent modulo @xmath246 since the distance of @xmath136 and @xmath31 is even .",
    "observe that for @xmath844 we have @xmath852 and @xmath853 using @xmath850 we can rewrite these equations as follows : @xmath854 @xmath855 and @xmath856 @xmath857 hence @xmath858 @xmath859 by the correlation inequalities , the signs of @xmath860 and @xmath861 only depend on the positions of @xmath91 and @xmath92 , so they are the same .",
    "hence @xmath862    the main problem with the ls - switch is that it preserves the sizes of the color classes of the tree ( considered as a bipartite graph ) .",
    "so we need another transformation which can help to compare trees with different color class sizes . for this reason we introduce the following transformation which we will call _ short path shift_.    assume that @xmath45 is obtained from the rooted tree @xmath805 by attaching it to the middle vertex of a path on @xmath62 vertices .",
    "let us assume that @xmath30 is obtained from @xmath805 by attaching it to an end vertex of a path on @xmath62 vertices .",
    "then for any odd @xmath17 , we have @xmath863    we will say that @xmath45 is obtained from @xmath30 by a short - path shift .    let @xmath798 be the hom - vector of @xmath805 . then the hom - vector of @xmath795 is @xmath864 and the hom - vector of @xmath865 is @xmath866 hence @xmath867 while @xmath868 using the symmetry @xmath869 we get that @xmath870 by the log - concavity of the hom - vector , all @xmath871 for @xmath872 .",
    "hence @xmath863    observe that both transformations decreases the wiener - index ( sum of the distances of every pair of vertices in @xmath30 ) strictly : @xmath873 if @xmath45 is obtained from @xmath30 by an ls - switch or short - path shift and @xmath45 is not isomorphic to @xmath30 .",
    "for @xmath874 we have @xmath875 , so there is nothing to prove .",
    "hence we can assume that @xmath17 .",
    "let us consider the tree @xmath876 on @xmath4 vertices for which @xmath877 is minimal and among these trees it has the largest wiener - index .",
    "we show that @xmath876 is @xmath12 .",
    "assume for contradiction that @xmath876 is not @xmath12 .",
    "let @xmath31 be an end vertex of a longest path of @xmath876 .",
    "clearly , @xmath31 is a leaf , let @xmath136 be its unique neighbor .",
    "we distinguish two cases .",
    "if @xmath878 then @xmath876 can be decomposed into two branches , one of which is a star on at least @xmath62 vertices .",
    "( otherwise , @xmath31 can not be an end vertex of a longest path . )",
    "hence @xmath136 has another neighbor @xmath879 which is a leaf . in this case , @xmath876 is an image of a tree @xmath880 by a short - path shift with respect to the path @xmath881 .",
    "hence @xmath882 and @xmath883 .",
    "this contradicts the choice of @xmath876 .    if @xmath884 then let @xmath879 be the closest vertex to @xmath31 having degree at least @xmath62",
    "( such a @xmath879 must exist , because @xmath876 is not @xmath12 . )",
    "note that @xmath885 .",
    "let us decompose the tree @xmath876 into branches @xmath886 , @xmath887 and @xmath888 at the vertex @xmath879 , where @xmath887 and @xmath888 are non - trivial trees .",
    "if @xmath889 is even , then @xmath876 is an image of a tree @xmath880 by an ls - switch , where @xmath890 are one - vertex trees .",
    "if @xmath889 is odd ( consequently @xmath891 is even ) , then @xmath876 is an image of a tree @xmath880 by an ls - switch , where @xmath806 is a one - vertex tree and @xmath892 is the rooted tree on the vertex set @xmath893 . in both cases @xmath882 and @xmath894 . in the first case ,",
    "the second inequality is strict contradicting the choice of @xmath876 . in the second case",
    ", it may occur that @xmath888 is also an edge implying that @xmath895 . by changing the role of @xmath161 and @xmath896",
    ", we can ensure that @xmath887 is also an edge ( otherwise we get the same contradiction as before ) . hence in this case @xmath897 is a path with an edge attached on the second vertex . in this case",
    "we can realize that it is a short - path shift of a path at the vertex @xmath879 .",
    "hence we get a contradiction in this case too , which finishes the proof of the theorem .    to prove part ( ii ) of theorem  [ into paths ] , we will distinguish two cases according to the parity of @xmath4",
    ".      if @xmath4 is even , then @xmath898 since @xmath899 .",
    "( however , the color classes of @xmath9 are not symmetric , but the color classes of @xmath12 are symmetric so it is equally likely which color class goes to which one . ) hence by theorem  [ g - path ] we have @xmath900 if @xmath4 is odd then we still need to work a bit .      from now on @xmath10 and @xmath4",
    "since @xmath4 is odd , it makes sense to speak about large and small color class of the tree considered as a bipartite graph .",
    "if @xmath3 is a tree on @xmath4 vertices , then @xmath901 will denote the color class of size at most @xmath902 and @xmath903 will denote the color class of size at least @xmath904 .",
    "@xmath901 and @xmath903 stands for small and large .",
    "the notation @xmath905 denotes @xmath906 , where @xmath907 .",
    "hence it means that the small color class goes to the even - indexed vertices of the path .",
    "we can similarly define @xmath908 .",
    "the following is a simple observation .",
    "[ 01-path ] @xmath909    this lemma asserts that the small class of the path @xmath12 ` likes ' to go the large class of the path @xmath9 .",
    "let @xmath136 be a leaf of @xmath12 .",
    "note that @xmath910 .",
    "let @xmath31 be its neighbor , and let @xmath798 be the hom - vector of @xmath911 .",
    "then the hom - vector of @xmath912 is @xmath913 .",
    "note that @xmath914 while @xmath915 note that @xmath916 since @xmath917 has even number of vertices .",
    "hence @xmath909    the following theorem is the main result of this part of the proof .",
    "it will imply the minimality of the path .",
    "[ s - hom ] let @xmath4 be odd .",
    "then for any tree @xmath3 on @xmath4 vertices we have @xmath918    * theorem  [ into paths ]  ( ii ) @xmath919 are odd positive integers .",
    "* let @xmath4 be odd . for any tree @xmath3 on @xmath4 vertices we have @xmath920    from theorem  [ g - path ]",
    "we know that @xmath842 in other words , @xmath921 by theorem  [ s - hom ] and lemma  [ 01-path ] we have @xmath922 these inequalities together imply that @xmath923 hence @xmath920    now we start to prove theorem  [ s - hom ] .",
    "we need a few lemmas .",
    "the first one is trivial , but crucial .",
    "[ leaf - move ] let @xmath133 be a tree on @xmath4 vertices , and let @xmath910 be a leaf .",
    "let @xmath924 an arbitrary vertex of the small class .",
    "let @xmath134 be a tree obtained from @xmath133 by deleting the vertex @xmath136 from @xmath133 and attaching a leaf @xmath225 to @xmath31 .",
    "( so we simply move a leaf of the large class to another place , but we take care not changing the sizes of the color classes . )",
    "then @xmath925    let @xmath926 .",
    "note that @xmath927 since any homomorphism of @xmath928 into @xmath9 , where the small class goes to even - indexed vertices , can be extended into a similar homomorphism of @xmath133 in exactly two ways .",
    "similarly , @xmath929 hence @xmath925    we will use the following transformation too .    let @xmath45 be a tree which contains a claw : three leaves attached to the same vertex .",
    "let @xmath30 be obtained from @xmath45 by deleting the three leaves and attaching a path of length @xmath62 to the common neighbor of the leaves .",
    "we call this transformation _ claw - deletion_.    note that the claw - deletion changes the sizes of the color classes",
    ". we have to be careful when we apply it , because it may occur that claw - deletion changes the small class into the large one .",
    "we need the following property of the claw - deletion .",
    "[ claw - deletion ] let @xmath45 be a tree on @xmath4 vertices with color classes @xmath930 and @xmath931 .",
    "assume that @xmath932 and @xmath45 contains a claw .",
    "let @xmath30 be obtained from @xmath45 by a claw - deletion , where we assume that the center @xmath31 of the claw is in the class @xmath930 .",
    "then @xmath933    note that the condition @xmath932 guarantees that the small class can not become the large one in @xmath30 .",
    "let @xmath934 be the leaves of @xmath30 , and let @xmath31 be their common neighbor .",
    "let @xmath935 .",
    "let @xmath798 be the hom - vector of @xmath936 .",
    "then the hom - vector of @xmath937 is @xmath938 and the hom - vector of @xmath32 is @xmath939 if @xmath940 .",
    "if @xmath941 then the hom - vector of @xmath937 is @xmath942 , while the hom - vector of @xmath32 is @xmath943 . in both cases @xmath944    our strategy will be the following .",
    "we transform a tree into a path by moving leaves and using the ls - switch and claw - deletion repeatedly . if we want to apply this last operation , we need to be sure that the condition @xmath932 holds .",
    "the following lemma will be useful .",
    "[ leaves ] let @xmath30 be a tree with color classes @xmath138 and @xmath233 .",
    "assume that all leaves of @xmath30 belong to the color class @xmath138",
    ". then @xmath945 .",
    "we prove the statement by induction on the number of vertices .",
    "if @xmath30 has at most @xmath62 vertices , the claim is trivial .",
    "assume that @xmath30 has @xmath10 vertices and we have proved the statement for trees on at most @xmath57 vertices .",
    "let @xmath441 be a leaf of @xmath30 , and let @xmath31 be its unique neighbor .",
    "let @xmath440 be the leaves of @xmath30 adjacent to @xmath31 .",
    "note that @xmath946 and @xmath947 .",
    "erase @xmath440 from @xmath30 , and let @xmath928 be the obtained tree . if @xmath31 is a leaf in the obtained tree then erase it as well and let us denote the resulted tree by @xmath948 , otherwise @xmath949 . it may occur that @xmath948 is the empty graph , but it is not problem .",
    "for @xmath948 it is still true that one color class , @xmath950 , contains all leaves .",
    "thus by induction @xmath951 . then @xmath952 as desired .",
    "[ leaf - rem ] let @xmath45 be a tree on @xmath4 vertices with color classes @xmath903 and @xmath901 .",
    "assume that @xmath45 contains a claw , and all leaves belong to @xmath903 .",
    "then @xmath953 .",
    "indeed , if we delete two leaves from the claw then it is still true for the resulting tree @xmath928 that all leaves belong to one color class , and it must be the larger one .",
    "hence @xmath954 , and since @xmath4 is odd , we have @xmath955 .",
    "thus for the original tree @xmath45 we have @xmath953 .",
    "let @xmath956 be the set of trees on @xmath4 vertices which minimizes @xmath905 . from @xmath956",
    "let us choose the tree @xmath957 , which has the smallest number of leaves and among these trees it has the largest wiener - index .",
    "we show that @xmath957 must be @xmath12 .",
    "assume for contradiction that @xmath958 .",
    "first of all , @xmath957 can not be an image of an ls - switch , because if @xmath959 can be obtained from a tree @xmath249 by an ls - switch , then by theorem  [ ls - th ] we have @xmath960 and @xmath249 has at most as many leaves as @xmath957 , and @xmath961 .",
    "hence it would contradict the choice of @xmath957 .",
    "let @xmath901 and @xmath903 be the small and large class of @xmath957 , respectively .",
    "note that @xmath903 must contain a leaf by lemma  [ leaves ] .",
    "we will distinguish two cases according to @xmath901 containing a leaf too or not .",
    "* @xmath901 contains a leaf @xmath31 .",
    "let @xmath37 be the unique neighbor of @xmath31 .",
    "first , we show that @xmath37 has degree at least @xmath62 . if @xmath962 then let @xmath879 be the closest vertex to @xmath31 having degree at least @xmath62 .",
    "such a @xmath879 must exist , because @xmath957 is not @xmath12 .",
    "note that @xmath885 .",
    "let us decompose the tree @xmath957 into branches @xmath886 , @xmath887 and @xmath888 at the vertex @xmath879 , where @xmath887 and @xmath888 are non - trivial trees .",
    "if @xmath889 is even , then @xmath957 is an image of a tree @xmath249 by an ls - switch , where @xmath890 are one - vertex trees .",
    "if @xmath889 is odd ( consequently @xmath963 is even ) , then @xmath957 is an image of a tree @xmath249 by an ls - switch , where @xmath612 is a one - vertex tree and @xmath964 is the rooted tree on the vertex set @xmath965 . in the second case",
    ", it may occur that @xmath888 is also an edge implying that @xmath966 . by changing the role of @xmath161 and @xmath896",
    ", we can ensure that @xmath887 is also an edge ( otherwise we get the same contradiction as before ) . hence in this case @xmath957 is a path with an edge attached on the second vertex . in this case",
    "we can realise that it is an ls - switch of a path since @xmath4 is odd .",
    "hence we get a contradiction in this case too .",
    "now let @xmath910 be a leaf .",
    "let us delete it , and attach @xmath225 to @xmath31 . this way we get a tree @xmath45 .",
    "by lemma  [ leaf - move ] we know that @xmath967 furthermore , @xmath45 is an ls - switch ( in fact , an even - kc - transformation ) of a tree @xmath249 .",
    "indeed , let us decompose the tree @xmath45 at @xmath37 to @xmath968 and the path @xmath969 .",
    "thus if we move @xmath612 from @xmath37 to @xmath225 we get a tree @xmath249 for which @xmath970 note that @xmath225 and @xmath31 is not a leaf in @xmath249 anymore .",
    "maybe , the original neighbor of @xmath136 became a leaf in @xmath249 , but still the number of leaves of @xmath249 is strictly less than the number of leaves of @xmath957 .",
    "this contradicts the choice of @xmath957 .",
    "hence we are done in this case .    * case 2 .",
    "* @xmath901 contains no leaf .",
    "hence all leaves belong to the class @xmath903 .",
    "let @xmath971 be a longest path of @xmath957 .",
    "as in the previous case , the unique neighbors @xmath972 and @xmath973 of @xmath441 and @xmath497 , respectively , have degree at least @xmath62 .",
    "we can assume that @xmath974 , otherwise @xmath957 is a star and it contains a claw and we can do claw - deletion , which strictly decreases @xmath905 . since @xmath972 and @xmath973 have degree at least @xmath62 , and @xmath971 were the longest path , the only possible way it can occur that @xmath972 and @xmath973 have other neighbors @xmath975 and @xmath976 , respectively , which are leaves .",
    "now let us delete @xmath975 and add a new neighbor @xmath977 to @xmath973 .",
    "let @xmath45 be the obtained tree .",
    "then by lemma  [ leaf - move ] @xmath967 on the other hand , it is still true that all leaves of @xmath45 belong to its large class . moreover , it contains a claw : @xmath978 . by remark  [ leaf - rem ] the conditions of lemma  [ claw - deletion ] are satisfied , and we can do a claw - deletion .",
    "then we get a tree @xmath249 for which @xmath979 this contradicts the choice of @xmath957 .",
    "hence we get contradictions in all cases .",
    "we collected a few open problems and conjectures in this section .",
    "we first recall a conjecture from the introduction , namely that there is no exceptional case in theorem  [ minimality - path ] if @xmath17 .    * conjecture  [ disappointment ] * let @xmath15 be a tree on @xmath10 vertices , where @xmath17 . then for any tree @xmath3 we have @xmath68    note that to prove conjecture  [ disappointment ] , one only needs to prove that for any tree @xmath3 we have @xmath980 for @xmath721 , where @xmath10 is even .",
    "there is also an open problem in figure  [ table1 ] .",
    "is it true that @xmath981 for every tree @xmath15 on @xmath10 vertices ?",
    "we believe that the answer is affirmative for this question .",
    "this question naturally leads to the following problem .",
    "[ hard problem ] characterize all graphs @xmath2 for which @xmath268 for all @xmath4 and all trees @xmath3 on @xmath4 vertices .",
    "note that if @xmath2 is @xmath444-regular , then @xmath982 . we have also seen that the inequality of problem  [ hard problem ] is satisfied if @xmath983 or @xmath33 . probably , it is hard to characterize these graphs .",
    "maybe , it is easier to describe those graphs @xmath2 for which the inequality of problem  [ hard problem ] is satisfied for large enough @xmath4 .",
    "the dual of problem  [ hard problem ] is also natural :    [ medium problem ] characterize all trees @xmath3 on @xmath4 vertices for which @xmath268 for all graph @xmath2 .",
    "probably , this is an easier problem than problem  [ hard problem ] .",
    "note that already sidorenko @xcite achieved nice results on this problem .",
    "still the problem is far from being solved .    in light of the tree - walk algorithm",
    ", it would be interesting to develop an algorithm for computing the number of homomorphisms from bipartite graphs to any graph .",
    "the first author is very grateful to lszl lovsz and mikls simonovits for suggesting to study the papers of alexander sidorenko .",
    "he also thanks benjamin rossman for the comments on the paper @xcite .",
    "this research was partly done while the second author was visiting the alfrd rnyi institute of mathematics .",
    "he is very grateful to mikls abrt and the institute for their hospitality and support .",
    "he also would like to thank yanfeng luo for introducing the graph homomorphisms and jiang zeng for all his encouragement during this work .",
    "special thanks goes to masao ishikawa for suggesting the name tree - walk algorithm .",
    "a.m. leontovich , the number of mappings of graphs , the ordering of graphs and the muirhead theorem , problemy peredachi informatsii 25 ( 1989 ) , no .",
    "2 , 91104 ; translation in problems inform .",
    "transmission 25 ( 1989 ) 154 - 165 ."
  ],
  "abstract_text": [
    "<S> in this paper we study several problems concerning the number of homomorphisms of trees . </S>",
    "<S> we give an algorithm for the number of homomorphisms from a tree to any graph by the transfer - matrix method . by using this algorithm and some transformations on trees , we study various extremal problems about the number of homomorphisms of trees . </S>",
    "<S> these applications include a far reaching generalization of bollobs and tyomkyn s result concerning the number of walks in trees .    </S>",
    "<S> some other highlights of the paper are the following . </S>",
    "<S> denote by @xmath0 the number of homomorphisms from a graph @xmath1 to a graph @xmath2 .    </S>",
    "<S> for any tree @xmath3 on @xmath4 vertices we give a general lower bound for @xmath5 by certain entropies of markov chains defined on the graph @xmath2 . as a particular case , we show that for any graph @xmath2 , @xmath6 where @xmath7 is the largest eigenvalue of the adjacency matrix of @xmath2 and @xmath8 is a certain constant depending only on @xmath2 which we call the spectral entropy of @xmath2 . in the particular case </S>",
    "<S> when @xmath2 is the path @xmath9 on @xmath10 vertices , we prove that @xmath11 where @xmath3 is any tree on @xmath4 vertices , and @xmath12 and @xmath13 denote the path and star on @xmath4 vertices , respectively .    </S>",
    "<S> we also show that if @xmath3 is any fixed tree and @xmath14 for some tree @xmath15 on @xmath10 vertices , then @xmath15 must be the tree obtained from a path @xmath16 by attaching a pendant vertex to the second vertex of @xmath16 . </S>",
    "<S> in fact , we conjecture that if @xmath17 and @xmath15 is an arbitrary tree on @xmath10 vertices , then @xmath18 for any tree @xmath3 .    all the results together enable us to show that @xmath19 where @xmath20 is the set of all endomorphisms of @xmath3 ( homomorphisms from @xmath3 to itself ) . </S>"
  ]
}