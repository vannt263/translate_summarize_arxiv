{
  "article_text": [
    "a recent paper@xcite it was demonstrated that it is possible to solve some eigenvalue problems of the schrdinger type to almost arbitrary high precision . the cases presented explicitly were ( i )  the ground state eigenenergy of the anharmonic oscillator , @xmath1 which was found to an accuracy of more than @xmath2 decimal digits , ( ii )  the eigenstate number @xmath3 of the same equation where the eigenenergy was found to an accuracy of more than @xmath3 decimal digits , and ( iii )  the lowest even and odd parity states of the double - well potential , @xmath4 where the two eigenenergies were found to an accuracy of more than @xmath5 decimal digits for the case @xmath6 .    in the latter case the two eigenenergies are degenerate to almost @xmath7 decimals , with the difference directly computable by the wkb method .",
    "the @xmath8 order wkb expansion given in @xcite provide an accuracy of about @xmath9 decimals for the difference , all of which agrees with the difference between the two numerical calculated eigenenergies .    also the eigenenergies of the highly excited states of equation  ( [ anharmonicoscillator ] ) can be calculated by the wkb method . the @xmath10 order wkb expansion given in @xcite provide an accuracy of about @xmath11 decimals , all of which agrees with the numerical result .",
    "it is certainly difficult to find physical systems where one need to know eigenenergies to tens of thousands of decimals or more .",
    "however , if one need to compute the wavefunction very accurately to very high values of @xmath12 ( to f.i .",
    "evaluate matrix elements ) the value depends extremely sensitively on the eigenvalue parameter .",
    "thus , in our opinion , algorithms for very - high - precision evaluation of eigenvalues may be useful in combination with routines for very - high - precision evaluation of matrix elements and normalization integrals .    in this paper",
    "we demonstrate that the latter can be achieved very simply , with the number of eigenfunction evaluations growing only linearly with the desired precision @xmath0 in decimal digits .",
    "each eigenfunction evaluation will in turn require a number of high - precision multiplications which grows linearly with @xmath0 , and each such multiplication require a cpu time which scales asymptotically between @xmath13 and @xmath14 ( depending on which high - precision multiplication algorithm is used ) .",
    "thus , the total time to evaluate one normalization integral to @xmath0 decimals precision can be expected to increase somewhat faster than @xmath15 . however , since the eigenfunction evaluations are independent they can be run in parallel .",
    "the rest of this paper is organized as follows . in section",
    "[ remarks ] we make some general remarks on numerical integration rules .",
    "we base our analysis on the euler - maclaurin summation formula and the poisson resummation formula .",
    "our conclusion is that the trapezoidal rule is not only the simplest one but also the best one . for integrals over finite intervals",
    "some there are endpoint corrections which should be considered separately ; these corrections vanish for our normalization integrals . in section  [ examples ]",
    "we consider some simple example cases similar to our wavefunction normalization integrals .",
    "for an infinite ( in principle ) integration range and a fixed number @xmath16 of integration steps one must strive for a balance between the error @xmath17 due to using a finite stepsize @xmath18 , and the error @xmath19 due to covering only a finite integration range .",
    "these errors can be estimated by respectively analysing the fourier transform @xmath20 of the integrand @xmath21 as @xmath22 ( by the method of steepest descent ) , and the asymptotic behaviour of @xmath21 as @xmath23 .",
    "it appears that both analyses can be extended to wavefunction normalization integrals by use of the wkb approximation .",
    "this extension is done in section  [ wavefunction ] .",
    "there is no scarcity of numerical integration formulae in the literature@xcite .",
    "standard choices are rules for @xmath24 which reproduces integrals of polynomials below a certain order exactly , @xmath25      & \\label{integrationrules}\\\\[-1.6ex ]      i\\left\\{f\\right\\ }      & \\approx \\frac{3}{8}\\left ( f_{0 } + 3 f_{1 } + 3 f_{2 } + f_{3}\\right)h \\equiv s_{3/8}(h),\\nonumber\\\\      i\\left\\{f\\right\\ }      & \\approx \\frac{2}{45}\\left(7 f_{0 } + 32 f_{1 } + 12 f_{2 } + 32 f_{3 } + 7 f_{4}\\right)h \\equiv b(h),\\nonumber\\end{aligned}\\ ] ] with @xmath26 and @xmath27 when there is @xmath28 terms in the integration rule .",
    "these are known respectively as the trapezoidal , simpson s , simpson s @xmath29 , and boole s rule .",
    "they are automatically exact for polynomials which are antisymmetric about the midpoint @xmath30 .",
    "the @xmath16 independent coefficients are chosen to give exact results for all symmetric ( about @xmath31 ) polynomials of order below @xmath32 . however , as @xmath16 increases the weight coefficients develop in a suspicious way . to integrate functions over large intervals to very high precision it seems dubious to extend the procedure above .",
    "an alternative way to handle integration over large intervals is to divide them into many smaller ones , and apply one of the rules above to each of the subintervals .",
    "we denote this by a bar over the rule , @xmath33 etc .",
    "a rather common choice is to extend simpson s rule , leading to the formula @xmath34      & \\label{extendedsimpson}\\\\[-1.6ex ]      & \\left.+ 2 f_{m-2 } + 4 f_{m-1 } + f_{m}\\right)h,\\nonumber\\end{aligned}\\ ] ] which looks curious to any member of an equal society .",
    "what is wrong with half of the points ?",
    "are they of the wrong gender ? which mysterious force of numerical error analysis leads to this spontaneous breakdown of translation invariance ?",
    "fig . 1  comparison of accuracy of the extended trapezoidal and simpson s rules for some integrands with very smooth boundary behaviour .    in our opinion",
    "only @xmath35 is a logically sensible procedure .",
    "we claim that this is also the best procedure . to support and exemplify this claim we have evaluated the integrals below : @xmath36,\\end{aligned}\\ ] ] by the @xmath35 and @xmath37 rules .",
    "the relative errors of the two methods as function of discretization length @xmath18 are shown in figure  1 .",
    "the result is as expected that @xmath38 behave as well as @xmath39 with _ twice _ the discretization length @xmath18 .",
    "the examples in figure 1 are untypical in the sense that the integrands are very smooth at the endpoints ( which is typical for the normalization integrals we are primarily interested in ) .",
    "one may use the euler - maclaurin summation formula to see which quantity is actually computed by the various integration rules @xmath40 h      = \\int_a^b \\text{d}x\\,f(x )      + \\sum_{k=1}^\\infty \\frac{b_{2k}}{(2k)!}\\delta^{(2k-1 ) } + \\cdots \\nonumber\\\\       & = \\int_a^b \\text{d}x\\,f(x ) + \\frac{\\delta^{(1)}}{12}-\\frac{\\delta^{(3)}}{720 }      + \\frac{\\delta^{(5)}}{30240 } -\\frac{\\delta^{(7)}}{1209600 } + \\cdots,\\label{eulermaclaurin}\\end{aligned}\\ ] ] where @xmath41 h^{k+1}$ ] , and the ellipsis in the first line denote `` non - perturbative '' terms depending on how @xmath21 varies in the full integration range . with",
    "@xmath37 one finds the corresponding quantity for the extended simpson s rule : @xmath42 i.e. , the @xmath43-coefficient has been eliminated at the cost of increasing all the remaining coefficients .",
    "a natural way to eliminate the @xmath43-coefficient would be to calculate @xmath44 explicitly at the endpoints , or use a numerical approximations like @xmath45      f'(x ) & = -\\frac{3f(x ) - 4 f(x+\\delta )",
    "+ f(x+2\\delta)}{2\\delta } + \\frac{1}{3}f^{(3)}(x)\\,\\delta^3+\\ldots,\\\\[0.1ex ]      f'(x ) & = \\phantom{-}\\frac{3f(x)-4f(x-\\delta)+f(x-2\\delta)}{2\\delta}+ \\frac{1}{3}f^{(3)}(x)\\,\\delta^3+\\ldots,\\end{aligned}\\ ] ] for sufficiently small @xmath46 .",
    "one should take @xmath46 somewhat smaller than @xmath18 .",
    "the modified trapezoidal rule described in @xcite is generally worse than the extended simpson s rule because of an inaccurate approximation of @xmath44 .",
    "however , there are few reasons to use the same discretization length for computing derivatives at the endpoints as for computing the bulk contribution to the integral . to avoid introduction of significant new errors",
    "it is sufficient to choose @xmath47 in the first formula . by choosing @xmath48 in the last two one",
    "also eliminates the @xmath49-term in equation ( [ eulermaclaurin ] ) .      there",
    "exist expressions for the `` non - perturbative '' terms in equation  ( [ eulermaclaurin ] ) , but we find the poisson resummation formula more clarifying : assume @xmath21 is an entire , integrable function , with fourier transform @xmath50 then one version of the poisson resummation formula reads @xmath51 this can be used to estimate the accuracy of the numerical integration formula @xmath52 when @xmath21 is an entire function its fourier transform @xmath20 will vanish faster that any inverse power of @xmath53 as @xmath54 .",
    "this means that the numerical approximation to the ( infinite range ) integral of an entire function will converge _ very fast _ towards the exact value as @xmath55 .",
    "integrals of @xmath21 over a finite range @xmath56 $ ] can be viewed as integrals of @xmath57 over an infinite range . but @xmath58 will usually be discontinuous , with a fourier transform @xmath59 which vanishes only algebraically as @xmath54 .",
    "the `` perturbative '' endpoint corrections of the euler - maclaurin formula can be used to account for these algebraic terms in a systematic way .",
    "but there is no point in making endpoint corrections beyond the error in the bulk contribution , the latter being of magnitude @xmath60 .",
    "in this section we will analyze the behaviour of some simple cases which are similar to typical ground state normalization integrals .",
    "consider first the ground state of the harmonic oscillator , @xmath62 , in which case @xmath63 hence we have @xmath64 in practise we must approximate the infinite sum by a finite one , @xmath65 if we make @xmath18 too small the first correction term ( on the second line above ) becomes too large . if we make @xmath18 too large the second correction term becomes too large .",
    "i.e. , the optimal choice of @xmath18 occurs approximately when @xmath66 , @xmath67 this leads to an expected error of order @xmath68 i.e. , to evaluate this integral numerically to @xmath0 decimals accuracy one must choose @xmath69      in more generality consider @xmath71 with @xmath72 a positive integer . in this case",
    "the integral is @xmath73 we use the saddle point method to estimate its fourier transform @xmath74 the saddle point equation becomes @xmath75 with @xmath76 solutions @xmath77 the two most relevant saddle points occur for @xmath78 and @xmath79 , at which the real part of the exponent @xmath80 is ( when @xmath81 ) @xmath82 i.e. , the leading error due to a finite stepsize @xmath18 is of magnitude @xmath83 ( apart from a prefactor of less importance ) . on the other hand , including only the @xmath16 first terms of the sum leads to an error of magnitude @xmath84^{2n}}$ ] . for a given @xmath16 we should choose @xmath18 to balance these errors , i.e. @xmath85 with @xmath86^{(2n-1)/4n^2}$ ] .",
    "this leads to an error of magnitude @xmath87 with @xmath88^{1 - 1/2n}$ ] .",
    "i.e. , to evaluate the integral numerically to @xmath0 decimals accuracy one must choose @xmath89 where the numerical approximation is very good for @xmath90",
    ".      finally consider @xmath92 . in this case @xmath93\\nonumber\\\\     & \\mathop{\\to }     \\left\\ {       \\begin{array}{ll }         2^{-1 } \\gamma\\left({1}/{4}\\right)&\\text{as $ a\\to0$,}\\\\         { \\sqrt{\\pi}}/{a}&\\text{as $ a\\to\\infty$. }       \\end{array }         \\right.\\end{aligned}\\ ] ] the saddle point approximation to the fourier transform @xmath94 leads to the saddle point equation @xmath95 we introduce @xmath96 which leads to a quadratic equation for @xmath97 , @xmath98 it is convenient to rewrite @xmath53 so that @xmath99",
    ". then the solutions for equation  ( [ quadraticequation ] ) becomes @xmath100 i.e. , @xmath101 which in both cases of @xmath102 leads to the solution @xmath103    fig .",
    "2  predicted ( lines ) and obtained ( points ) precision as function of @xmath16 , for the three example integrals discussed in the text . in order from top to bottom : @xmath104 , @xmath105 , @xmath106 .",
    "the number of function evaluations in each case is @xmath28 .",
    "as can be seen , the obtained precision agrees well with the theoretical estimate .",
    "there are two more ways to take the cube root .",
    "one of them leads to an equally relevant saddle point , @xmath107 while the last one is irrelevant .",
    "the real part of the exponent at the relevant saddle points is @xmath108 this provides an error estimate in parametric form : if we choose a finite stepsize @xmath109 the corresponding error will be of magnitude @xmath110 the error caused by summing over only a finite range of @xmath12-values , @xmath111 , should be chosen to be of the same magnitude as @xmath17 .",
    "i.e. , with @xmath112 , @xmath113 i.e. , we must use @xmath114 evaluation steps in the numerical integration .",
    "our investigation of the example integrals gives us confidence that we can obtain a fairly good _ a priori _ estimate of the obtainable precision @xmath115 at a given number @xmath16 of discretization steps , at least asymptotically for large @xmath16 .",
    "for this we need to ( i ) estimate the behaviour of the fourier transform , @xmath116 , of the integrand at large @xmath81 ( to find the obtainable accuracy @xmath17 at a given stepsize @xmath18 ) , and ( ii ) estimate how the integrand decays away from its maxima ( to find the required @xmath12-range of summation for the same accuracy ) .    both quantities can be obtained to reasonable accuracy by use of the wkb approximation .      for large @xmath12 an estimate of solutions to the eigenvalue problems @xmath118 can be written in the form . ]",
    "@xmath119 where @xmath120 , and @xmath121 with @xmath122 the beta function .",
    "we have evaluated the wkb integral using partial integration , and let @xmath123 in the remainder .",
    "further , in the last equality we have assumed @xmath124 to be eigenvalue number @xmath125 , and evaluated it by the wkb approximation .",
    "we use this approximation to estimate the fourier transform , @xmath126 by the saddle point method .",
    "the saddle point equation can be written @xmath127 giving @xmath128^{1/2n}\\ , \\right\\}.      \\label{fourierestimate}\\end{aligned}\\ ] ] thus , to compute the normalization integral to @xmath0 decimals precision one must choose @xmath129 so that the right hand side of ( [ fourierestimate ] ) becomes equal to @xmath130 ( or smaller ) .",
    "the value of @xmath18 is best found numerically .",
    "but note that one at least must have @xmath131 , or @xmath132    for large @xmath12",
    "the normalization integrand behaves like @xmath133 thus , to compute the normalization integral to @xmath0 decimals precision one should integrate to a value @xmath134 for which the right hand side of ( [ psisquareestimate ] ) becomes less than @xmath130 .",
    "the value of @xmath135 is best found numerically .",
    "but note that one at least must have @xmath136 , or @xmath137 this provides a lower limit on the number of integration steps , @xmath138 here we have assumed @xmath139 to be eigenvalue number @xmath125 , and used the wkb approximation to estimate its value . since @xmath125 is the number of nodes in the eigenfunction , the inequality ( [ lowerlimit ] ) quite reasonably says that the number of evaluation points must be larger than the number of oscillations .",
    "specializing the results of the previous section to the ground state of the @xmath141-potential , and approximating @xmath142 by zero , one finds from equation ( [ fourierestimate ] ) that @xmath143 and from equation ( [ psisquareestimate ] ) that @xmath144 from this one deduces that the optimal choices for @xmath145 and @xmath146 are so that @xmath147 i.e. , @xmath148 the corresponding estimated error becomes @xmath149    i.e. , if one wants to compute the normalization integral to @xmath0 decimals precision one has to choose @xmath150    fig .",
    "3  this figure displays the computer time ( measured in milliseconds ) required to compute some normalization integrals to @xmath0 decimals estimated precision .",
    "the cases considered are ( i ) the ground state wavefunction of the @xmath141-potential ( @xmath142 ) , ( ii ) the @xmath151 excited state wavefunction of the @xmath141-potential ( @xmath152 ) , and ( iii ) the ground state wavefunction of the @xmath153-potential ( @xmath154 ) with @xmath155 .",
    "the main effect of having highly excited states @xmath156 lies in the extra factors @xmath157 in the error estimates , with @xmath158 found in equation ( [ c_expression ] ) .",
    "clearly @xmath158 becomes large for large @xmath125 . to account for this factor",
    "we must replace @xmath130 by @xmath159 in the error analysis .",
    "i.e. , make the replacement @xmath160 in the expressions like ( [ estimatedm ] ) .",
    "there are also @xmath161-dependent corrections to the remainding factors , but they are best treated numerically .",
    "we next consider the lowest even parity eigenstate of @xmath163 with @xmath164 is small and positive . by wkb analysis",
    "one finds that the solution behaves like @xmath165 ( up to an algebraic prefactor ) in the region of interest ( @xmath166 , @xmath167 ) .",
    "we again estimate fourier transform of @xmath168 by the saddle point method , assuming the relevant saddle point to be in a region where the approximation ( [ doublewellgroundstate ] ) is valid .",
    "the saddle point equation , @xmath169 = 0,\\ ] ] has a solution consistent with this assumption , @xmath170 the corresponding exponent is @xmath171      \\approx -\\frac{1}{3s}(1-\\text{i } ) ( ps)^{3/2 } ,     \\label{wwexponent}\\ ] ] where the last equality is valid for @xmath172 . to evaluate the integral to @xmath0 decimals precision one must choose @xmath81 so that @xmath173 ( or smaller ) .",
    "for very large @xmath0 one may use the last approximation in equation  ( [ wwexponent ] ) to find @xmath174 otherwise it is simplest to determine @xmath18 numerically .",
    "further , to evaluate the integral to @xmath0 decimals precision one must add contributions from the ( positive ) @xmath12-range where @xmath175 i.e. , we must take @xmath135 to be the largest solution to the equation @xmath176 .",
    "for very large @xmath0 the solution becomes @xmath177 hence the number of required function evaluations again grow asymptotically for large @xmath0 like @xmath178 cf . equation ( [ estimatedm ] ) .",
    "this work was supported in part by the higher education commision of pakistan ( hec ) and the  smforsk  program of the research council of norway .",
    "the calculations were performed using the cln@xcite high - precision numerical library .",
    "a.  mushtaq , a.  noreen , k.  olaussen , and i.  verb , _ very - high - precision solutions of a class of schrdinger type equations _ ,",
    "computer physics communications , ( in press ) doi:10.1016/j.cpc.2010.12.046 ( 2011 )"
  ],
  "abstract_text": [
    "<S> we demonstrate that it is possible to compute wave function normalization constants for a class of schrdinger type equations by an algorithm which scales linearly ( in the number of eigenfunction evaluations ) with the desired precision @xmath0 in decimals .    </S>",
    "<S> eigenvalue problems ; bound states ; trapezoidal rule ; poisson resummation </S>"
  ]
}