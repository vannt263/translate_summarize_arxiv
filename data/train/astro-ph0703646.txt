{
  "article_text": [
    "the photometric analysis of large galaxies is a double edged sword . while increased resolution , compared to distant galaxies , provides avenues for more detailed analysis of galaxy properties ( to name a few : examination of star formation regions , examination of core parameters to search for massive blackholes , spiral arm analysis , isophotal irregularities that may signal rings , bars or other secular evolution processes ) , it is a data reduction fact that the larger number of pixels complicates the extraction of simple parameters , such as total magnitude , mean surface brightness and isophotal radius .",
    "for example , the fact that the galaxy is spread over a larger area of the sky means that the outer pixels have more sky luminosity than galaxy luminosity , increasing the error in any galaxy value .",
    "in addition , increased angular size has frequently prevented a fair comparison between distant and nearby galaxy samples simply because the techniques used to extract parameters from nearby galaxies differ from those used on small galaxies .",
    "in general , the analysis of large galaxies ( i.e. ones with many pixels ) requires a full surface photometry study of the isophotes and their shape . for most extragalactic systems ,",
    "the shape of choice is an ellipse .",
    "the astrophysics behind this assumption is that galaxy light traces stellar mass , and stellar mass follows elliptical orbits as given by kepler s 1st law .",
    "certainly , this is true the case of early - type galaxies ( elliptical and s0 s ) as demonstrated by studies that examined the residuals from elliptical isophotes ( jedrzejewski 1987 ) .",
    "this is also mostly true for disk galaxies , although the lumpiness of their luminosity distribution due to recent star formation increases the noise around each ellipse ( see the discussion in  2.4 ) . for dwarf",
    "irregular systems , any regular contours are poor describers of their shape , thus an ellipse is used because it is the simplest shape ( aside from a circle ) to describe an irregular isophote .",
    "therefore , the analysis of large galaxies begins with the reduction of their 2d images into 1d surface photometry as described by elliptical isophotes . in turn",
    ", the 1d profiles can be fit to various functions in order to extract characteristic luminosities ( stellar mass ) , scale lengths and standard surface brightnesses ( luminosity density ) . when combined with kinematic information",
    ", these three parameters form the fundamental plane for galaxies , a key relationship for understanding the formation and evolution of galaxies .    aside from direct relevance to the fundamental plane , the need for better galaxy photometric tools has also increased with the influx of quality hst imaging . before hst ,",
    "distant galaxies were mere point sources , but now with wfpc2 , acs and nicmos data , there is the need to perform full surface photometric studies on a much larger volume of the universe .",
    "the sizes of our database on the photometric structure of galaxies has increased a thousandfold in the last 10 years , but most of the tools used to reduce this new data are up to 20 years out - of - date .",
    "thus , the analysis of high resolution space imaging data is far behind spectroscopic and high energy data , not due to lack of interest , but due to the inadequacy of our 2d analysis tools .",
    "the goal of this software project ( called the archangel project for obtuse historical reasons ) has been to produce a series of proto - nvo type tools , related to surface photometry , and develop a computing environment which will extend the capability of individual observers ( or entire data centers ) to perform virtual observatory science .",
    "there is no attempt herein to replace existing analysis packages ( i.e. pyiraf ) , but rather our goal is to supplement existing tools and provide new avenues for data reduction as it relates to galaxy photometry .",
    "we hope that the fundamental components in this package will provide the community with new methods to which they can add their own ideas and techniques as well as provide learning environment for new researchers .",
    "in addition , there is growing amount of data by non - optical astronomers as new space missions provide imaging data in wavelength regions previously unexplored .",
    "thus , there is a new and growing community of non - optical astronomers with 2d analysis needs that we hope to serve .",
    "the tools described herein are not intended to be a complete data reduction package per say , but rather a set of basic modules that allows the user to 1 ) learn the procedures of galaxy photometry , 2 ) tailor the tools to their particular needs , 3 ) begin an advanced learning curve of combining basic modules to produce new and more sophisticated tools . turning raw data ( level 1 or 2 data ) from the telescope ( space or ground ) into calibrated , flattened images",
    "is the job of other , more powerful packages such as pyraf .",
    "the tools presented herein bridge the intermediate step between calibrated data and astrophysically meaningful values . specifically , we are concerned with the analysis of 2d images into 1d values , such as a surface brightness profile , and further tabulation into final values , such as total luminosity or scale length .    with respect to galaxy images , the numbers most often valued are luminosity , scale length and luminosity density .",
    "unfortunately , due to the extended nature of galaxies , the quality and accuracy of these values can varying depending on the type of value desired .",
    "for example , luminosities can be extracted in metric form ( luminosity within 16 kpc ) or isophotal ( luminosity inside the 26.5 mag arcsecs@xmath1 isophote or the total luminosity , an extrapolation to infinite radius .",
    "scale length can be expressed as the radius of half - light or a formula fit to the luminosity distribution ( e.g. seric function ) .",
    "luminosity density can be described through a detailed surface photometry profile , or integrated as a mean surface brightness within an isophote , or again a fitted curve such as an exponential disk .",
    "the tools provided by this project allow an inexperienced user the capability to explore their dataset and extract meaningful results while outlining the limitations to that data .",
    "for the experienced researcher , these tools enhance their previous background in data reduction and provide new , and hopefully , faster avenues of analysis . to this end , the tools provided by this package",
    "provide a user with most basic of descriptions of a galaxy s light , then allowing the option to select any meaningful parameter by toggling a switch . for most parameters , such as aperture magnitudes ,",
    "the switch is simple and automatic . for more complicated parameters , such as a profile fit or an asymptotic magnitude ,",
    "the switch is understandably more sophisticated and needing more explanation to the user for accurate use .",
    "this paper is divided into five sections describing the major components of the reduction package : 1 ) sky determination , 2 ) 2d profile fitting , 3 ) aperture photometry , 4 ) extraction of 1d parameters from surface brightness profiles and 5 ) extracting total magnitudes .",
    "each section contains examples of the reduction of galaxy images from the 2mass archive .",
    "the fastest way to introduce the techniques and tools used in our package is to walk through the analysis of a several different types of galaxy images .",
    "a more non - linear reader can refer to the appendix for a listing of the major tools .",
    "a script titled @xmath2 is included which outlines the usage of the routines described below . for a majority of galaxy images",
    ", this script will produce a usable surface brightness profile , and this script forms the core of the client / server version of this package ( see  5 ) .",
    "but , a sharper understanding of the data requires more interaction with the techniques , the user is encouraged to run through the examples given in the package .    to illustrate our tools ,",
    "we have selected 2mass @xmath3 images of several galaxies found in the revised shapley - ames catalog with the characteristics of smooth elliptical shape ( ngc 3193 ) , disk shape ( ic 5271 ) , spiral features ( ngc 157 ) and low in surface brightness / low contrast to sky ( ngc 2082 ) .",
    "the analysis procedure for each galaxy is divided into five basic parts ; 1 ) sky determination , 2 ) cleaning , 3 ) ellipse fitting , 4 ) aperture photometry and 5 ) profile fitting .    before starting it",
    "is assumed that the data frame has be initially processed for flatfielding , dark subtraction and masking of chip defects .",
    "small defects , such as cosmic rays , are cleaned by the analysis routines .",
    "but the errors are always reduced if known features are removed before analysis .",
    "the following routines work on poorly flattened data ( e.g. gradients or large - scale features ) , and will signal the poorness by the resulting errors , but the removal of large - scale flattening problems requires more interaction then acceptable for this package and remains the responsibility of the user .      any galaxy photometry analysis process begins with an estimate of the image s sky value . while this is not critical for isophote fitting , it is key for actually finding targets , cleaning the frame of stars and smaller galaxies , plus determination of the photometry zeropoints .",
    "accurate sky determination will , in the end , serve as the final limit to the quality of surface photometry data since a majority of a galaxy s luminosity distribution is near the sky value .",
    "for this reason , sky determination has probably received as much attention in astronomical data literature as any other comparable reduction or analysis problem .",
    "the difficulty in sky determination ranges from too few photons to know the behavior of the instrumental response ( e.g. , high energy data ) to a high temporal varying flux of sky photons that overwhelms the galaxy signal ( e.g. , near - ir data ) .",
    "surface fitting , drift scans , sky flats and super flats are all procedures used to minimize the sky contribution to the noise levels of the final data .",
    "several clever , but not technically challenging , algorithms were included in the noao iraf system to handle time averaged flats and data , median co - adding and cosmic ray subtraction . in the end ,",
    "improved ccd quality lowered the demands of sky subtraction as the production of linear , good charge transfer and uniform sensitivity chips replaced the earlier generations and their wildly inaccurate backgrounds .",
    "frames for ngc 3193 , an elliptical selected from the rsa sample ( schombert 2007 ) . note the proper cleaning of contaminating stars , even a object near the galaxy core . ]    for a cosmetically smooth image , an efficient , but crude , sky fit is one that simply examines the border of the frame and does an iterated average , clipping pixels more than 4@xmath4 from the mean .",
    "a border sky fit is often sufficient to find the starting center of the galaxy ( for the ellipse fitting routines ) , clean the frame of stars / galaxies external to the object of interest ( the ellipse fitting routines will clean along the isophotes , see below ) and provide a preliminary error estimate to the photometry .",
    "this error estimate is preliminary in that the true limiting error in the surface ( and aperture ) photometry of large galaxies is not the rms of an isophote , but how well the sky value is know .",
    "once the number of pixels involved in a calculation ( be it an isophote or an aperture ) becomes large ( greater than 50 for typical readout noises ) , then the error is dominated by the precision of the sky value .",
    "the disadvantage to a border sky fit is the occasional inconvenient occurrence of stars or bright galaxies on the edge of the frame .",
    "an iterated mean calculation will remove small objects . and",
    "large objects will be signaled with large @xmath4 s in an iterative mean search . in an automated procedure ,",
    "more than likely , the task will have to halt and request human intervention to find a starting sky value .",
    "after years of experimentation , the method of choice for accurate sky determination for extended galaxies is to evaluate sky boxes .",
    "this is a procedure where boxes of a set sized are placed semi - randomly ( semi in the sense of avoiding stars and other galaxies ) in the frame .",
    "an algorithm calculates an iterative mean and @xmath4 for each box .",
    "these means ( and @xmath4 s ) are then super - summed to find the value of the sky as the mean of the means ( and likewise , the error on the sky value is the @xmath4 on this mean ) .    from an analysis point of view , there are several advantages to this technique .",
    "one is that each box exists as a measurement independent of the other boxes .",
    "thus , the statistical comparison of the boxes is a real measure of the quality of the sky determination for the frame in terms of its accuracy and any gross trends with the frame .",
    "another advantage is that contaminating objects are relatively easy to avoid ( visual choice of sky boxes ) or to sort by the higher @xmath4 per box .",
    "lastly , sky boxes are the easiest method of finding regions for sky determination outside the galaxy itself , particularly where an irregular object may fill a majority of the data frame .",
    "the most difficult decision in sky determination by boxes is , of course , where to place the boxes .",
    "when done visually , the user selects region ( usually with a cursor ) that are free of stars and sufficiently far away from the target galaxy to be clear of its envelope light . for an automated process",
    ", the procedure returns for a final sky estimate after the ellipse fitting process is completed and when all the stars / galaxies are cleaned ( set to values of not - a - number , nan ) .",
    "then , the outer edge of the large galaxy is determined and an iterative analysis of sky boxes outside this radius is used to determine the true sky and , most importantly , the variation on the mean of those boxes as a measure of how well the sky is known .",
    "this procedure is the role of _ sky_box _ , see the appendix for a more detailed description of its options .",
    "reduction of a 2d image into a 1d run of intensity versus radius in a galaxy assumes some shape to the isophote",
    ". very early work on galaxies used circles since the data was obtained through circular apertures in photoelectric photometers . for early type galaxies ,",
    "the ellipse is the shape that most closely follows the shape of the isophotes .",
    "this would confirm that the luminosity being traced by an isophote is due to stellar mass , which follow elliptical orbits ( kepler s 1st law ) .",
    "as one moves to along the hubble sequence to later type galaxies , the approximation of an ellipse to the isophotes begins to break down due to recent star formation producing enhancements in luminosity density at semi - random positions .",
    "however , no consistent shape describes the isophotes of irregular galaxies , so an ellipse is the best shape , to first order , and provides a common baseline for comparison to more regular galaxies .",
    "image of ic 5271 , a sb(rs ) galaxy selected from the rsa catalog .",
    "typical of the isophotes for a disk / bulge galaxy , there is a cross over point as one transitions from a more spherical bulge to a flattened disk .",
    "while this is flagged by the reduction software , it is astrophysically real and signals the lens morphology often seen in surface brightness profiles of disk galaxies . ]",
    "fitting a best ellipse to a set intensity values in a 2d image is a relatively straight forward technique that has been pioneered by cawson ( 1987 ) and refined by jedrzejewski ( 1987 ) ( see also an excellent review by jensen & jorgensen 1999 ) . the core routine from these techniques ( prof ) was eventually adopted by stsdas iraf ( i.e. ellipse ) .",
    "the primary fitting routine in this package follows the same techniques ( in fact , uses much of the identical fortran code from the original gasp package of cawson ) with some notable additions .",
    "these codes start with an estimated x - y center , position angle and eccentricity to sample the pixel data around the given ellipse .",
    "the variation in intensity values around the ellipse can be expressed as a fourier series with small second order terms .",
    "then , an iterative least - squares procedure adjusts the ellipse parameters searching for a best fit , i.e. minimized coefficients .",
    "there are several halting factors , such as maximum number of iterations or minimal change in the coefficients , which then moves the ellipse outward for another round of iterations .",
    "once a stopping condition is met ( edge of the frame or sufficiently small change in the isophote intensity ) , the routine ends . a side benefit to above procedure",
    "is that the cos(4@xmath5 ) components to each isophote fit are easily extracted , which provides a direct measure of the geometry of the isophote ( i.e. boxy versus disk - like , jedrzejewski 1987 ) .",
    "one new addition , from the original routines , is the ability to clean ( i.e. mask ) pixels along an isophote .",
    "basically , this routine first allows a few iterations to determine a mean intensity and rms around the ellipse .",
    "any pixels above ( or below ) a multiple of the rms ( i.e. 3@xmath4 ) are set to not - a - number ( nan ) and ignored by further processing .",
    "due to the fact that all objects , stars and galaxies , have faint wings , a growth factor is applied to the masked regions .",
    "while this process is efficient in early - type galaxies with well defined isophotes , it may be incorrect in late - type galaxies with bumpy spiral arms and hii regions .",
    "the fitting will be smoother , but the resulting photometry will be underestimated .",
    "this process can be controlled early in the analysis pipeline by the user with an initial guess of the galaxy s hubble type .",
    "also , the erased pixels are only temporary stored until an adequate fit is found . once a satisfactory ellipse is encountered , only then are the pixels masked for later ellipse fitting .",
    "the masked data is written to disk at the end of the routine as a record of the cleaning .",
    "the ellipse fitting is the function of _ efit _ as described in the appendix .    for early - type galaxies , lacking any irregular features ,",
    "the cleaning process is highly efficient .",
    "the pipeline first identifies the galaxy and its approximate size by moment analysis .",
    "it then cleans off stars / galaxies outside the primary galaxy by moment identification and radius growth for masking .",
    "stars / galaxies inside the primary galaxy are removed by the ellipse fitting routine .",
    "the resulting ellipses are inspected for crossover ( isophotes that crossover are assumed to be due to errors or embedded stars / galaxies and removed by averaging nearby ellipse isophotes , this is not true for disk galaxies ) .",
    "the smoothed ellipses are used by a more robust cleaning algorithm and the whole ellipse fitting process is repeated on the cleaned frame .",
    "image of ngc 157 , a face - on sc(s ) galaxy selected from the rsa catalog .",
    "similar to ic 5271 , there are several crossover points in the fitted ellipses .",
    "the fitting program does a good job of following the spiral arms in the inner regions , then a large jump from bulge to disk region . ]",
    "an example of the analysis of an elliptical is found in figure 1 , a 2mass @xmath3 image of ngc 3193 .",
    "the top panel is the raw 2mass image , the bottom panel is the resulting cleaned image output at the end of the reduction process .",
    "the cleaning process efficiently removed all the stars on the frame , including the brighter object on the northern edge of the frame and its diffraction spikes .",
    "the star closest to the galaxy core is a problem in two arenas .",
    "the first is in the calculation of ellipse , as the inner star would drag the calculated moments off center .",
    "the isophote erasing routine has handled this as can be seen in figure 2 , where the fitting ellipses are shown and are not deflected by the erased star .",
    "second , is that calculated total magnitudes would either be over estimated ( if the star is not masked ) or under estimated ( if the star is masked and the galaxy light from those pixels is not replaced ) .",
    "this problem will be discussed in  2.6 .",
    "as one goes towards later type galaxies , there is an increase in the non - elliptical nature to their isophotes and an increase in luminosity density enhancements ( hii regions , stellar clusters , spiral features ) which are legitimate components to the galaxy s light distribution and should not be cleaned .",
    "the user can specify the galaxy type and the cleaning restrictions will be tightened ( only to stellar objects and at a higher cleaning threshold ) plus the restrictions on overlapping ellipses is loosened ( e.g. the transition from a round bulge to a flat disk ) .",
    "most importantly , while some galaxy features are cleaned for the sake of a harmonious ellipse fit , those pixels need to be filled for later aperture photometry .",
    "image of ngc 2082 , a lsb disk galaxy .",
    "note , that the ellipse fitting routine expanded the annulus size to increase the s / n . ]    an example of this behavior can be found in figure 3 , the @xmath3 image of ic 5271 .",
    "the red ellipses indicate isophote fits that crossover .",
    "while flagged as an error , this is in fact the real behavior of the isophotes as one transitions from bulge to disk .",
    "the resulting intensities are probably overestimated due to the crossover effect , but this error will be minor compared to the errors that would result from an off - center or overly round ellipse .",
    "the quality of the fitting procedure can be judged by the behavior of the ellipse parameters such as eccentricity , position angle and center .",
    "if there are large jumps in any of the parameters that determine shape , then this may signal a feature in the galaxy that needs to be cleaned ( a buried star for example ) .",
    "slightly less abrupt changes may signal an astrophysically interesting features , such as a bar or lens morphology . under the assumption that the isophotes of a typical galaxy are a smooth function with radius , the ellipse fitting algorithm checks for ellipse parameters that indicate a crossing of the isophotal lines .",
    "these ellipses are smoothed and flagged ( the mean of the inner and outer ellipse parameters is used ) . in certain scenarios ,",
    "crossing isophotes are to be expected , for example the transition region from a bulge to a disk ( see figure 2 ) , and the smoothing criteria is relaxed .",
    "this is the function of @xmath6 as described in the appendix .",
    "an example of @xmath6 s corrections can be seen in figure 4 , the @xmath3 image of ngc 157 .",
    "several interior ellipses display erratic behavior , but @xmath6 took the mean average of nearby ellipses ( in green ) to produce a more rational fit .",
    "the resulting intensities were also more stable , although the rms is going to be highly than the typical isophotes found in an elliptical .",
    "an example of a lsb galaxy fit is found in figure 5 .",
    "the ellipse fitting routine , recognizing that the target is low in contrast with respect to sky , widened the annulus for collecting pixel values .",
    "this increases the s / n at some loss of spatial resolution .",
    "since resolution is usually not important in a galaxy s halo region , this is an acceptable trade off .",
    "lsb galaxies are susceptible to fitting instability , the fitting routines are tightened against rapid changes in eccentricity and centering to prevent this behavior .",
    "lsb galaxies also demonstrate a key point in determining errors from surface photometry .",
    "there are two sources of error per isophote , the rms around the ellipse and the error in the sky value .",
    "the rms value is a simple calculation using the difference between the mean and the individual pixel values .",
    "this rms then reflects into an observable error as the @xmath7 .",
    "however , as the isophote intensity approaches the sky value , the number of pixels increases and the error due to rms becomes an artificially low value .",
    "in fact , at low intensities , the knowledge of the sky value dominates and the error in the isophote is reflected by the sky error ( preferably as given by the @xmath4 on the means of a large number of sky boxes ) .      with a file of isophotal intensities versus radius in hand , it is a simple step to producing a surface brightness profile for the galaxy .",
    "there are a few tools are in the package to examine the quality of the ellipse fitting ( e.g. @xmath8 , an interactive comparison of the image and the ellipses ) . at the very least ,",
    "a quick visual inspection of the ellipses seems required as a bad mismatch leads to strongly biased results ( see cautionary tale in  4 ) .",
    "a user can either step through a directory of data files ( e.g. using the @xmath9 tool ) or a user can automatically produce a group of gif images with a corresponding html page , then use a browser to skim through a large number of files .",
    "calibration from image data numbers ( dn ) to fluxes ( or magnitudes ) is usually obtained through standard stars with corrections for airmass and instrumental absorption .",
    "if these values are in the fits headers , then they are automatically added to the object s xml file .",
    "additional corrections for galactic absorption , k - corrections and surface brightness dimming are well documented in the literature and can be assigned automatically by grabbing xml data from ned .",
    "a chosen cosmology converts radius in pixel units into astrophysically meaningful values of kiloparsecs .",
    "a python command line script ( @xmath10 ) based on ned wright s cosmology calculator is included in the package all these values can be added to the xml file for automatic incorporation to the analysis programs . if they do nt exists , then instrumental mags will be used , which can easily be converted to real units later on",
    ".     fits to disk and bulge .",
    "the solid line is the addition of the two curves . ]",
    "analysis of a 1d surface brightness profile ( the job for the @xmath11 tool ) depends on the scientific goals of the user .",
    "for example , early - type galaxies are typically fit to a de vaucouleurs r@xmath12 curve to extract a scale length ( effective radius ) and characteristic surface brightness ( effective surface brightness ) .",
    "irregular and dwarf galaxies are well fit by exponential profiles which provide a disk scale length and central surface brightness .",
    "disk galaxies can be fit with a combination of bulge and disk fits , to extract b / d ratios and disk scale lengths .    due to this combination of @xmath13 and exponential curves for large bulge spirals , it is computationally impossible to correctly determine which function , or combination of functions , best fits a particular galaxy s profile . in the past",
    ", one would examine the 2d image of the galaxy and obvious disk - like galaxies would be fit to @xmath13 plus exponential .",
    "objects with elliptical appearance were fit to a strict @xmath13 shape .",
    "this produces a problem for large bulge s0 s which are difficult to detect visually unless nearly edge - on .",
    "the simplest solution to this problem , using only the 1d surface photometry , is to examine the profiles in a plot of mag arcsecs@xmath14 versus linear radius . with this plot ,",
    "exponential disks appear as straight lines , see figure 6 as an example of a pure disk in ngc 2403 .",
    "bulge plus disk components are also straight forward in this mag / linear radius space , see figure 7 a good example of a bulge plus disk fit in ngc 3983 . if a profile displays too much curvature , with no clear linear disk portion , then it is a good candidate for a pure @xmath13 fit ( see figure 8 , ngc 3193 ) .",
    "this option is easily checked by plotting the profile in mag arcsecs@xmath14 versus r@xmath12 space as shown in figure 8 .",
    "most r@xmath12 profiles only have a linear region in the middle of the surface brightness profile , typically with a flattened core and fall - off at large radii ( see schombert 1987 ) .",
    "fit is shown . ]",
    "the seric function is also popular for fitting surface brightness profiles ( graham & driver 2005 ) , although not currently supported by this package , any fitting function is easy to add to the reduction routines as the core search routine is a grid search @xmath15 minimization technique .",
    "however , there are issues with surface photometric data where the inner regions have the highest s / n but the outer regions better define a galaxy s structure ( schombert & bothun 1987 ) . with user guidance ,",
    "this grid search works well for any user defined function .",
    "also , since there are a sufficient number of packages for fitting 1d data in the community , this package only provides a simple graphic plotting function .",
    "more sophisticated analysis needs guidance by the user , but this package provides the framework for just such additions .",
    "often the scientific goal of a galaxy project is to extract a total luminosity for the system ( and colors for multiple filters ) . for small galaxies ,",
    "a metric aperture or isophotal magnitude is suitable for comparison to other samples ( certainly the dominate source of error will not be the aperture size ) .",
    "however , for galaxies with large angular size ( i.e. many pixels ) , their very size makes total luminosity determination problematic .",
    "natively , one would think that a glut of pixels would make the problem of determining a galaxies luminosity easier , not more difficult .",
    "however , the problem here arises with the question of where does the galaxy stop ? or , even if you guess an outer radius , does your data contain all the galaxy s light ?",
    "the solution proposed by de vaucouleurs decades ago is to use a curve of growth ( de vaucouleurs 1977 ) .",
    "almost all galaxies follow a particular luminosity distribution such that the total light of a galaxy can be estimated by using a standard growth curve to estimate the amount of light outside your largest aperture . for a vast majority of galaxies , selecting either an exponential or r@xmath12 curve of growth is sufficient to adequately describe their total luminosities ( burstein 1987 ) .",
    "however , for modern large scale ccd imaging , the entire galaxy can easily fit onto a single frame and there is no need for a curve of growth as all the data exists in the frame .    with adequate s / n",
    ", it would seem to be a simple task to place a large aperture around the galaxy and sum the total amount of light ( minus the sky contribution ) .",
    "however , in practice , a galaxy s luminosity distribution decreases as one goes to larger radii , when means the sky contribution ( and , thus , error ) increases . in most cases , larger and larger apertures simply introduce more sky noise ( plus faint stars and other galaxies ) . and , to further complicate matters , the breakover point in the optical and near - ir , where the galaxy light is stronger than the sky contribution will not contain a majority of the galaxy s light .",
    "so the choice of a safe , inner radius will underestimate the total light .",
    "the procedure selected in this package , after some numerical experimentation , is to plot the aperture luminosity as a function of radius and attempt to determine a solution to an asymptotic limit of the galaxy s light .",
    "this procedure begins by summing the pixel intensities inside the various ellipses determined by @xmath16 . for small radii",
    ", a partial pixel algorithm is used to determine aperture luminosity ( using the surveyors technique to determine each pixel s contribution to the aperture ) . at larger radii , a simply sum of the pixels , and",
    "the number used , is output .",
    "in addition , the intensity of the annulus based on the ellipse isophote and one based on the fit to the surface photometric profile are also outputted at these radii ( see below ) .",
    "note that a correct aperture luminosity calculation requires that both a ellipse fit and a 1d fit to the resulting surface photometry has be made .",
    "the ellipse fit information is required as these ellipses will define the apertures , and masked pixels are filled with intensities given by the closest ellipse .",
    "a surface photometric fit allows the aperture routine to use a simple fit to the outer regions as a quick method to converge the curve of growth .",
    "once the aperture luminosities are calculated , there are two additional challenges to this procedure .",
    "the first is that an asymptotic fit is a difficult calculation to make as the smallest errors at large radii reflect into large errors for the fit .",
    "two possible solutions are used to solve this dilemma .",
    "the first solution is to fit a 2nd or 3rd order polynomial to the outer radii in a luminosity versus radius plot .",
    "most importantly for this fit , the error assigned the outer data points is the error on the knowledge of the sky , i.e. the rms of the mean of the sky boxes .",
    "this is the dominant source of error in large apertures and the use of this error value results in a fast convergence for the asymptotic fit .",
    "the resulting values from the fit will be the total magnitude and total isophotal size , determined from the point where the fit has a slope of zero .",
    "a second solution is to use an obscure technique involving rational functions .",
    "a rational function is the ratio of two polynomial functions of the form    @xmath17    where @xmath18 and @xmath19 are the degree of the function .",
    "rational functions have a wide range in shape and have better interpolating properties than polynomial functions , particularly suited for fits to data where an asymptotic behavior is expected .",
    "a disadvantage is that rational functions are non - linear and , when unconstrained , produce vertical asymptotes due to roots in the denominator polynomial .",
    "a small amount of experimentation found that the best rational function for aperture luminosities is the quadratic / quadratic form , meaning a degree of 2 in the numerator and denominator .",
    "this is the simplest rational function and has the advantage that the asymptotic magnitude is simply @xmath20 , although is best evaluated at some radii in the halo of the galaxy under study .",
    "usually the aperture luminosity values will not converge at the outer edges of a galaxy .",
    "this is the second challenge to aperture photometry , correct determination of the luminosity due to the faint galaxy halo .",
    "this is where the surface photometry profile comes in handy .",
    "contained in that data is the relationship between isophotal luminosity and radius , using all the pixels around the galaxy .",
    "this is often a more accurate number than attempting to determine the integrated luminosity in an annulus at the same radius .",
    "this information can be used to constraint the curve of growth in two ways .",
    "one , we can use the actual surface brightness intensities and convert them to a luminosity for each annulus at large radii . then",
    ", this value can be compared to the aperture value and a user ( or script ) can flag where the two begin to radically deviate .",
    "often even the isophotal intensities will vary at large radii and , thus , a second , more stable method is to make a linear fit of an exponential , r@xmath12 or combined function to the outer radii and interpolate / extrapolate that fit to correct the aperture numbers .",
    "figure 9 display the results for all three techniques for the galaxy ngc 1003 .",
    "the black symbols are the raw intensities summed from the image file .",
    "the blue symbols are the intensities determined from the surface photometry .",
    "the orange symbols are the intensities determined from the fits to the surface photometric profile .",
    "this was one of the worst case scenarios due to the fact the original image is very lsb ( in the near - ir @xmath3 band ) .",
    "due to noise in the image and surface photometry , the outer intensities grow out of proportional to the light visible in the greyscale figure .",
    "a fit to the raw data does not converge ( blue line )",
    ". a 2nd order fit to the profile fit ( orange line ) also fails to capture the asymptotic nature .",
    "the rational function fit ( pink line ) does converge to an accurate value .",
    "if similar types of galaxies are being analyzed , it is a simple procedure to automate this process .",
    "in the past , when disk space was at a premium and i / o rates were slow , astronomical data was stored in machine specific formats . however , today disk space is plentiful and file access times are similar to processing times on most desktop systems .",
    "thus , a majority of simple astronomical databases are stored in flat file format , also called plain text or ascii files ( note : this is an interesting throwback to the original data methods from the end of the 19th century , where information is stored as a system of data and delimiters , such as spaces or commas ) .",
    "the endproduct data files for most packages rarely exceed a few kilobytes or a few hundred lines .",
    "the simplest access to these types of files is an editor such as vi or emacs .",
    "sufficient documentation ( i.e. header files ) makes understanding the data , and writing applications for further analysis these data files , a relatively simple task .",
    "however , there is a strong driver to migrate output files into xml format for even the simplest data files .",
    "extensible markup language ( xml ) is a w3c - recommended general - purpose markup language that is designed store and process data .",
    "the core of xml is the use of tags , similar to html tags ( i.e. ` < tag > data</tag > ` ) , to delineate data values and assign attributes to those values ( for example , units of measure ) .",
    "xml is not terse and , therefore , somewhat human - legible ( see figure 1 for xml example of astronomical data )",
    ".     scans .",
    "the red ellipses are fits from the 2mass galaxy pipeline",
    ". the blue ellipses are the resulting fits from this package .",
    "the 2mass fits clearly fail to follow the flatter isophotes in the outer regions .",
    "this results in an underestimate of these isophote s intensity values , as seen in the surface brightness profile in the bottom panel . ]",
    "xml has several key advantages over plain file formats .",
    "for one , xml format allows an endless amount of additional information to be stored in each file that would not have fit into the standard data plus delimiter style .",
    "for example , calibrating data , such as redshift or photometric zeropoint , can be stored in each file along with the raw data with very little increase in file size overhead as the tags handle the separation .",
    "there is no need to reserve space for these quantities nor is there any problem adding future parameters to the xml format .",
    "using xml format puts all the reduction data into a single file for compactness and , in addition , since xml files are plain text files , there is no problem with machine to machine transfer .",
    "the reading of xml files is not a complication for either compiled or interpreted languages .",
    "a disadvantage to xml format is that it s clumsy to read .",
    "however , there exist a number of excellent xml editors on the market ( for example , http://www.oxygenxml.com ) .",
    "these allow a gui interface with an efficient query system to interact with the xml files .",
    "while many users would prefer to interact with the raw data files in plain text form , in fact , even a simple editor is gui window into the bytes and bits of the actual data on machine hardware .",
    "a gui xml editor is simply a more sophisticated version of vi or emacs",
    ".     scans .",
    "the red ellipses are fits from the 2mass galaxy pipeline",
    ". the blue ellipses are the resulting fits from this package .",
    "the 2mass galaxy pipeline failed to follow the isophote twists ( i.e. changes in position angle ) .",
    "this results in an underestimate of these isophote s intensity values , as seen in the surface brightness profile in the bottom panel . ]",
    "an additional reason to migrate to xml is a new power that xml data files bring to data analysis .",
    "many interpreted languages ( i.e. python and perl ) have an _ eval _ or _ exec _ function , a method to convert xml data into actual variables within the code at runtime ( i.e. dynamically typed ) .",
    "this has a powerful aspect to analysis programs as one does not have to worry about formats or the type of data entries , this is handled in the code itself .",
    "dynamical typing introduces a high level of flexibility to code . in python",
    ", one can convert xml data ( using python s own xml modules to read the data ) into lists that contain the variable name and value , then transform these lists into actual code variables using an _ exec _ command . for example ,    .... for var , value in xml_vars :    exec(var+'='+value ) ....    produces a set of new variables in the running code . and python s",
    "unique try / except processing traps missing variables without aborting the routine .",
    "for example , if the variable redshift exists in the xml data file then    .... try :    distance = redshift / h_o except :    print ' redshift undefined '    distance = std_distance ....    this same try / except processing also traps overflows and other security flaws that might be used by a malicious user attempting to penetrate your server using the xml files .",
    "thus , xml brings a level of security as well as enhancing your code .",
    "lastly , another advantage to xml format is the fact that all of the reduction data ( ellipse fitting , aperture photometry , calibration information , surface photometry ) can be combined into a single file , e.g. galaxy_name.xml , which can be interrogated by any analysis routine that understands xml .",
    "a simple switch at the end of the reduction process integrates the data into an xml file for transport , or access by plotting packages , etc .",
    "if you have read this far , and are still awake , this section walks through the reduction of part of the revised shapley - ames sample ( schombert 2007 ) taken from the 2mass database that overlaps the 2mass large galaxy atlas ( jarrett 2003 ) . as a cautionary tale to the importance to doing large galaxy photometry with care , we also offer in this section a comparison of our technique with the results from an automated , but much cruder reduction pipeline from the 2mass project .    allowing the ellipses to vary from isophote to isophote , not only in eccentricity , but also in position angle and ellipse center , are critical to obtaining an accurate description of a galaxy s luminosity profile . shown in figures 10 , 11 and 12",
    "are examples of @xmath3 images extracted from the 2mass archives that were part of the large galaxy atlas ( jarrett 2003 ) . in each case",
    ", the 2mass pipeline calculates a luminosity profile based on the isophotes around an ellipse from the mean moments of the whole galaxy .",
    "thus , the fitted ellipses do not change in axial ratio or position angle and , for most spirals , this technique will result in an ellipse that is too flat in the core and , often , too round in the halo regions .",
    "if the galaxy has a bar , this technique will also underestimate the bar contribution , spreading its light into larger radii ellipses .",
    "the red ellipses are fits from the 2mass galaxy pipeline",
    ". the blue ellipses are the resulting fits from this package . the 2mass galaxy pipeline , for some strange reason , assumed a circular shape to was is clearly an elongated galaxy .",
    "this results in an underestimate of these isophote s intensity values , as seen in the surface brightness profile in the bottom panel . ]",
    "given that the light is averaged around the ellipse , this effect may be minor if the galaxy is fairly smooth and uniform .",
    "however , galaxies that are smooth and regular are a minority in the local universe . for the three examples , shown in figure 10 , 11 and 12 ,",
    "the 2mass fits consistently underestimate the amount of disk light per isophote , as seen in comparison to the luminosity profile determined from the raw data using the archangel routines .",
    "this , in turn , results in fitted central surface brightnesses that are too bright in central surface brightness , and fitted disk scale lengths that are too shallow .",
    "in fact , for 49 galaxies in common between the near - ir rsa sample ( schombert 2007 ) and the 2mass large galaxy atlas , figure 13 displays the difference between the fitted disk scale lengths ( @xmath21 ) and the difference between the fitted disk central surface brightness ( @xmath22 ) . given the typical @xmath21 s , the error in 2mass fits corresponds to a 50% error in a galaxy s size .",
    "likely , errors in the central surface brightness fits averages around 0.5 mags .",
    "thus , not using the proper reduction technique not only increases the noise in the measured parameters , but produces a biased result .    ) from fits of an exponential law to 2mass surface photometry versus this package s surface brightness reduction .",
    "the bottom panel displays the difference in fitted center surface brightnesses between the 2mass profiles and the new rsa sample .",
    "typically , the 2mass pipeline overestimates the eccentricity ( too round ) which results in smaller scale lengths and brighter central surface brightnesses .",
    ", width=642 ]",
    "one of the more powerful modules to the python language is the @xmath23 , the module that allows python scripts to download any url address . if address is a web page , there",
    "also exist several addition modules that parse html and convert html tables into arrays .",
    "this means a simple script can be written to pull down a web page , parse it html and extract a data into table format . and ,",
    "on top of this procedure , the information could be then be used into a standard get / post web form used by many data archives .    as an example",
    ", the package contains _ dss_read _ , a script that takes the standard name for a galaxy , queries ned for its coordinates and then goes to the dss website and extracts the pss - ii image of the galaxy . while this sounds like a computationally intense task , in fact the script is composed of 49 lines .",
    "the downside to this network power is , of course , the possibility of abuse .",
    "unrestricted application of such scripts will overload websites and given network speeds , the typical user does nt need their own personal digital sky at their home installation .",
    "lastly , various archives , in order to slow massive downloads , have an id / password interface .",
    "to penetrate these sites requires the _ mechanize _ module which simulates the actions of a brower , following links , parsing i d s and passwords and handling cookies .",
    "while these avatars are simple to build , the wise usage of them remains a key challenge for the future .",
    "the fastest way to learn a data reduction process is to jump in and try it . to this end",
    ", the tarball contains all the images discussed in this document , and several test images with known output .",
    "this allows the user to practice on images where the final results are known .",
    "thus , we encourage the readers to download , compile and run !",
    "tarballs are found at http://abyss.uoregon.edu/@xmath0js/archangel .",
    "another option , for the user who does nt wish to set - up the package on their own system ( or perhaps only has a handful of galaxies to reduce ) , is the client / server version of this package available at http://http://abyss.uoregon.edu/@xmath0js / nexus ( see figure 14 ) .",
    "although more limited in its options , the web version has the advantage of speed ( it s run on a solaris sun blade ) and a fast learning curve .        as to the future ,",
    "a number of tools need to be added to this package .",
    "for example , quantitative morphology uses the concentration and asymmetry indices to parameterize a galaxy s global structure .",
    "while these values are easy to extract from small angular size objects , they are a challenge for large systems . yet",
    ", a detailed comparison of these values to visual morphology is a key step in understanding quantitative morphology at higher redshifts .",
    "however , in order get the current tools out to the community , the package is frozen .",
    "additional tools will be added to the package website as , in order of priority , 1 ) needed by the pi to meet various science goals , 2 ) requested by outside users to obtain their science goals , and 3 ) requested by outside users as possible new computational areas to explore . as with all evolving software ,",
    "an interested user should contact the author to see where future directions lie ( js@abyss.uoregon.edu ) .",
    "this project was funded by joe bredekamp s incredible nasa s airs program .",
    "i am grateful to all the suggestions i have gotten from airs pi s at various workshops and panel reviews .",
    "the program is a mixed of technology plus science types and is one of nasa s true gems for innovative research ideas .",
    "burstein , d. , davies , r.  l. , dressler , a. , faber , s.  m. , stone , r.  p.  s. , lynden - bell , d. , terlevich , r.  j. , & wegner , g.  1987 , , 64 , 601    cawson , m.  g.  m. , kibblewhite , e.  j. , disney , m.  j. , & phillipps , s.  1987 , , 224 , 557    graham , a.  w. , & driver , s.  p.  2005 , publications of the astronomical society of australia , 22 , 118    jarrett , t.  h. , chester , t. , cutri , r. , schneider , s.  e. , & huchra , j.  p.  2003",
    ", , 125 , 525    jedrzejewski , r.  i.  1987 , , 226 , 747    schombert , j.  m. , & bothun , g.  d.  1987 , , 93 , 60    de vaucouleurs , g.  1977 , , 33 , 211",
    "this package is a combination of fortran and python routines .",
    "the choice of these languages was not arbitrary .",
    "python is well suited for high level command processing and decision making .",
    "it is a clear and expressive language for text processing .",
    "therefore , its style is well suited to handling file names and data structures .",
    "since it is a scripting language , it is extremely portable between os s .",
    "currently , every flavor of unix ( linux , mac os x and solaris ) comes packaged with python .",
    "in addition , there is a hook between the traditional astronomy plotting package ( pgplot ) and python ( called ppgplot ) , which allows for easy gui interfaces that do not need to be compiled .",
    "the use of fortran is driven by the fact that many of the original routines for this package were written in fortran .",
    "for processing large arrays of numbers , c++ provides a faster routine , but current processor speeds are such that even a 2048x2048 image can be analyzed with a fortran program on a dual processor architecture faster than the user can type the next command .",
    "stsci provides a hook to fits formats and arrays ( called pyfits and numarray ) , but python is a factor of 100 slower than fortran for array processing .",
    "currently there are three fortran compilers in the wild , g77 , gfortran and g95 .",
    "the routines in this package can use any of these compilers plus a version of python greater than 2.3 .",
    "cfitsio is required and avaliable for all os s from its gsfc website .",
    "the python libaries pyfits and numarray are found at stsci s pyraf website .",
    "for any graphics routines , the user will need a verson of pgplot and install ppgplot as a python library .",
    "the ppgplot source is avaliable at the same website as this package .",
    "the graphics routines are only needed for data inspection , the user should probably develop their own high - level graphics to match their specifics . in the directory",
    "/util one can find all the python subroutines to fit 1d data surface or aperture photometry .",
    "the examples in this manual will guide you in constructing your own interface .",
    "lastly , the output data files for this package are all set in xml format .",
    "this format is extremely cumbersome and difficult to read ( it is basically an extension of the html format that web browsers use ) .",
    "however , a simple command line routine is offered ( @xmath24 ) that will dump or add any parameter or array out of or into a xml file .",
    "to go from a raw data frame containing a galaxy image to a final stage containing ellipse fits , surface photometry , profile fits and aperture values requires three simple scripts , _ profile _ , _ bdd _ and _ el_. the scripts _ profile _ and _ el _ are automatic and can be run as batch jobs .",
    "_ bdd _ is an interactive routine to fit the surface photometry and is a good mid - point to study the results of the ellipse fitting . in a majority of cases , the user simply needs to run those three scripts with default options to achieve their science results .",
    ".... usage : sky_box option file_name box_size",
    "prf_file     options : -h = this message           -f = first guess of border           -r = full search , needs box_size                and prf_file           -t = full search , needs box_size           -c = find sky for inner region ( flats )                needs x1,x2,y1,y2 boundarys     output : 1st mean , 1st sig , it mean , it sig npts , iterations ....",
    "ellipse fitting routine , needs a standard fits file , output in .prf file format ( xml_archange converts this format into xml )     options : -h = this mesage           -v= output each iteration           -q = quiet           -xy = use new xc and yc           -rx = max radius for fit           -sg = deletion sigma ( 0=no dets )           -ms = min slope ( -0.5 )           -rs = stopping radius           -st = starting radius    when deleting , output fits file called file_name.jedsub ....                              cursor commands : / = abort               q = move to next frame c = contrast            r = reset zoom z = zoom                t = toggle ellipse plot p = peek at values a,1 - 9 = delete circle   b = delete box ....              window # 2 cursor commands : x = erase point         d = disk fit only m = erase all min pts   f = do bulge+disk fit u = erase all max pts   e = do r**1/4 fit only b = redo boundaries     p = toggle 3fit/4fit q = abort               r = reset graphics / = write .xml file and exit ....           add or delete data into xml format        -o = output element value or array        -d = delete element or array        -a = replace or add array , array header and data is cat'ed into routine        -e = replace or add element        -c = create xml file with root element        -k = list elements , attributes , children ( no data ) ...."
  ],
  "abstract_text": [
    "<S> photometry of galaxies has typically focused on small , faint systems due to their interest for cosmological studies . </S>",
    "<S> large angular size galaxies , on the other hand , offer a more detailed view into the properties of galaxies , but bring a series of computational and technical difficulties that inhibit the general astronomer from extracting all the information found in a detailed galaxy image . to this end , </S>",
    "<S> a new galaxy photometry system has been developed ( mostly building on tools and techniques that have existed in the community for decades ) that combines ease of usage with a mixture of pre - built scripts . </S>",
    "<S> the audience for this system is a new user ( graduate student or non - optical astronomer ) with a fast , built - in learning curve to offer any astronomer , with imaging data , a suite of tools to quickly extract meaningful parameters from decent data . </S>",
    "<S> the tools are available either by a client / server web site or by tarball for personal installation . </S>",
    "<S> the tools also provide simple scripts to interface with various on - line datasets ( e.g. 2mass , sloan , dss ) for data mining capability of imaged data .    as a proof of concept , </S>",
    "<S> we preform a re - analysis of the 2mass large galaxy atlas to demonstrate the differences in an automated pipeline , with its emphasis on speed , versus this package with an emphasis on accuracy . </S>",
    "<S> this comparison finds the structural parameters extracted from the 2mass pipeline is seriously flawed with scale lengths that are too small by 50% and central surface brightness that are , on average , 1 to 0.5 mags too bright . a cautionary tale on how to reduce information - rich data such as surface brightness profiles . </S>",
    "<S> this document and software can be found at http://abyss.uoregon.edu/@xmath0js/archangel . </S>"
  ]
}