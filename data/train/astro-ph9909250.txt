{
  "article_text": [
    "observations of temperature fluctuations in the cosmic microwave background ( cmb ) are poised to become perhaps the most precise tools to probe cosmological models ( , bond & jaffe 1998 ) .",
    "characteristics of microwave detection technology  in particular , long - time - scale noise correlations  make these observations especially challenging @xcite . such difficult observations  and such high scientific stakes  require equally careful analyses of the data .",
    "a map of the cmb sky is not enough ; detector characteristics will ensure that the noise contribution to such a map is highly correlated from pixel to pixel , in a pattern depending in detail upon the detector noise spectrum and the observing strategy .",
    "but correct estimation of the map and the noise is especially crucial for cosmological analyses which are themselves trying to measure a variance , the intrinsic power spectrum , @xmath0 of the cmb  mis - estimation of the noise can directly add or subtract ( , bias ) the estimated @xmath0 @xcite .",
    "unfortunately , we usually do not have an _ independent _ determination of the detector noise power spectrum , at least not one that has been made under the same operating conditions as the actual experiment .",
    "moreover , there are noise contributions such as atmospheric emission which may have similar characteristics but are completely independent of the instrument . for this reason",
    ", we prefer to estimate the noise directly from the experimental data , perhaps using prior estimates of the noise under different conditions as a guide . in this paper",
    ", we discuss how to jointly estimate the microwave sky map and the noise correlation matrix using a maximum - likelihood formalism .",
    "this brings together two strands of cmb data analysis that had previously been seen as separate steps .",
    "we also discuss the further use of the map and correlation matrix for power spectrum estimation , and the pitfalls that this may incur relative to the ideal ( but impossible to implement ! ) full analysis .",
    "although cmb experiments have had to address this problem in the past , only cursory descriptions have been made of the methods used to estimate the noise and the validity of the approximations @xcite .    in section  [ sec : formalism ] we begin with a discussion of cmb observations and a review of the bayesian formalism for cmb mapmaking and parameter estimation .",
    "we extend this formalism to new maximum likelihood estimates for both the map and noise correlations . in section  [",
    "sec : method ] we discuss an iterative method for determining this maximum likelihood and apply it to a two model observational strategies as a test .",
    "in section  [ sec : dipole ] we present the problem of estimating the noise for a data stream with large signal - to - noise , namely calibration with the dipole . in section  [ sec : conclusions ] we conclude .",
    "as has become customary , we start our analysis with bayes theorem @xmath1 where @xmath2 are the parameters we are trying to determine , @xmath3 is the data , and @xmath4 is the `` background information '' describing the problem @xcite , which we will often omit from our probability expressions .",
    "the quantity @xmath5 is thus the likelihood , the probability of the data given a specific set of parameters , @xmath6 is the prior probability for the parameters , and the left - hand side of the equation is the posterior probability for the parameters given the data .    here",
    ", we will take the data , @xmath7 , as given by a time series of cmb measurements , @xmath8 where @xmath9 labels the time , @xmath10 , @xmath11 and @xmath12 are the experimental noise and sky signal contributions at that time .",
    "the signal is in turn given by the operation of a `` pointing matrix , '' @xmath13 on the sky signal at pixel @xmath14 , @xmath15 ( , the `` map '' ) ; we take the latter to be already pixelized and smeared by the experimental beam , so @xmath16 is a very sparse matrix with a single `` 1 '' entry for each time corresponding to the observed pixel . in what follows",
    "we will often rely on the summation convention and write @xmath17 , or occasionally use matrix notation , as in @xmath18 , etc .",
    "we will assume that the observed noise @xmath12 is a realization of a stationary gaussian process with power spectrum @xmath19 .",
    "this means that the correlation matrix of the noise is given by @xmath20 the stationarity of the process requires ( or is defined by ) @xmath21 .",
    "most generally , we will take the parameters to be    * the observed cmb signal on the sky , @xmath15 ; * the power spectrum of the noise , @xmath19 * ( possibly ) any cosmological parameters which describe the distribution of the @xmath15 ( , the cmb power spectrum , @xmath0 , although we could also directly use the cosmological parameters such as @xmath22 and @xmath23 ) .",
    "sometimes , we will assign a prior distribution for the cmb signal on the sky itself ( _ i.e. _ , uniform in the sky temperature ) such that the cosmological parameters ( or @xmath0 ) will be irrelevant  we will see that this doing this as an intermediate step retains all of the information in the dataset . at other times",
    "we will marginalize over the cmb signal itself and determine those parameters .    with these parameters and the data , @xmath7 ,",
    "bayes theorem becomes @xmath24 & \\propto &     p[\\tn(\\omega)|i ] p(t_p , c_\\ell",
    "| i ) \\nonumber \\\\    & & \\times p[d_i | \\tn(\\omega ) , t_p , i].\\end{aligned}\\ ] ] here , we have used two pieces of information to simplify slightly .",
    "first , the noise power spectrum , @xmath19 does not depend at all on the signal , so we can separate out its prior distribution .",
    "second , given the noise power spectrum and the sky signal , the likelihood does not depend upon the cosmological parameters .",
    "for the gaussian noise we assume , the likelihood is simply @xmath25   \\nonumber\\\\    & = & \\ln \\left| n_{ii ' } \\right| +    \\sum_{ii ' } ( d_i - s_i)n^{-1}_{ii'}(d_{i'}-s_{i ' } ) \\nonumber\\\\    & = & \\sum_k \\left",
    "[ \\ln \\tn_k +      |\\td_k-\\ts_k|^2/\\tn_k \\right]\\end{aligned}\\ ] ] ( ignoring an additive constant ) ; recall that @xmath26 .",
    "the second equality uses tildes to denote the discrete fourier transform at angular frequency @xmath27",
    ".    we will now apply these general formulae to various cases .",
    "we will start with the simplest case , where we have complete prior knowledge of the noise power spectrum .",
    "this is the case that has been previously discussed in the literature , but we emphasize that it is very unrealistic .",
    "we assign a delta - function prior distribution to @xmath28 , transforming it in effect from a parameter to part of the prior knowledge .",
    "first , we assume no cosmological information about the distribution of temperatures on the sky : @xmath29 ; with this separation the posterior for @xmath0 is simply the prior  the experiment gives us no new information .",
    "we will also assign a uniform prior to @xmath15 , lacking further information .",
    "now , the posterior distribution for the sky temperature is simply proportional to the likelihood , which can be rewritten by completing the square in the exponential as @xmath30\\end{aligned}\\ ] ] with the mean ( also , the likelihood maximum ) given by @xmath31 ( in matrix notation ) , and the noise correlation matrix by @xmath32 occasionally , the inverse of this correlation matrix is referred to as the _ weight matrix_. as is usual for linear gaussian models , the mean is just the multidimensional least - squares solution to @xmath33 with noise correlation @xmath28 .",
    "this is just the standard mapmaking procedure @xcite , cast into the form of a bayesian parameter - estimation problem .    for the case of known noise",
    ", however , this map is more than a just a visual representation of the data .",
    "even if we wish to determine the cosmological parameters , it is an essential quantity : we can write the prior for both the map and the spectrum as @xmath34 using the laws of probability , and so we can see that our rewriting of the likelihood in the form of eq .",
    "[ eq : maplike ] remains useful .",
    "that is , the full distribution is only a function of the data through the maximum - likelihood map , @xmath35in statistical parlance , @xmath35 is a _",
    "sufficient statistic_. thus for known noise , we can _ always _",
    "start by making a map ( and calculating its noise matrix , @xmath36 ) .      here",
    ", we briefly examine the specific form of the signal prior , @xmath37 , motivated by simple gaussian models .",
    "that is , we take the sky temperature , @xmath15 , to be an actual realization of a gaussian cmb sky , with covariance specified by the power spectrum , @xmath0 , @xmath38 ( note that we include beam - smearing by a symmetric beam with spherical harmonic transform @xmath39 in this definition ) ; @xmath40 gives the cosine of the angle between the pixels . with this covariance ,",
    "the prior becomes @xmath41.\\ ] ] we thus have a posterior distribution for @xmath15 and @xmath0 which is the product of two gaussians , @xmath42 , given by eqns .",
    "[ eq : maplike ] and [ eq : signalprior ] . in the usual cosmological likelihood problem",
    ", we do nt care about the actual sky temperature _ per se _ , but are concerned with the @xmath0 ( or the parameters upon which the power spectrum depends ) . thus",
    ", we can marginalize over the @xmath15 , @xmath43 , \\label{theq}\\end{aligned}\\ ] ] where we have included a prior for the power spectrum itself , so we can write the gaussian factor as the likelihood for the map given @xmath0 , @xmath44 .",
    "equation [ theq ] defines the effective likelihood for the map ( @xmath35 , now considered as the data rather than the timestream itself , @xmath45 ) , which is easily computed again by completing the square , giving @xmath46.\\ ] ] this is just the usual cmb likelihood formula : the `` observed map , '' @xmath47 , is just the sum of two quantities ( noise and signal ) distributed as independent gaussians .",
    "note again that the data only enter through the maximum likelihood map , @xmath35 , although that calculation is only implicit in this formula .",
    "further , the power spectrum @xmath0 only enters through the signal correlation matrix , @xmath48 , and in a very nonlinear way",
    ".    we can also play a slightly different game with the likelihood .",
    "if we retain the gaussian prior for the cmb temperature but _ fix _ the cmb power spectrum , we can estimate the map with this additional prior knowledge .",
    "we will again be able to complete the square in the exponential and see that @xmath15 is distributed as a gaussian : @xmath49\\ ] ] with @xmath50 now , the mean is given by @xmath51 which is just the _ wiener filter_. it has correlation matrix given by @xmath52 note that the maximum - likelihood map , @xmath35 still appears in these formulae , but it is no longer the maximum of the _ posterior _ distribution , now given by the wiener filter , @xmath53 .    this subsection has shown how many of the usual cmb data calculations can be seen as different uses of the bayesian formalism :    * the least - squares map ( seeing it as a `` sufficient statistic '' ) , * the cmb cosmological - parameter likelihood function , and * the wiener filter map of the cmb signal .",
    "the differences depend on what quantity is estimated ( the map or the power spectrum ) and what prior information is included .",
    "the previous subsection briefly outlined the bayesian approach to cmb statistics , assuming a known noise power spectrum .",
    "now , we will relax this assumption and approach the more realistic case when we must estimate both the experimental noise and the anisotropy of the cmb .",
    "we will take as our model a noise power spectrum of amplitude @xmath54 in bands numbered @xmath55 , with a shape in each band given by a fixed function @xmath56 with a width of @xmath57 ; @xmath58 is the number of discrete modes in the band @xmath55 where @xmath59 is the width of the band and @xmath60 is the minimum frequency of the data - stream .",
    "we will usually take @xmath61 so @xmath62 is piecewise constant .",
    "that is , @xmath63    we again assign a constant prior to the sky map , @xmath15 .",
    "as the prior for the noise we will take @xmath64 . with @xmath65 and a single band , this is the usual jeffereys prior advocated for `` scale parameters '' and the units on @xmath66 are irrelevant @xcite .    with this model and priors , the joint likelihood for the noise and",
    "the map becomes @xmath67 \\nonumber\\\\    & = &   \\prod_\\alpha    { 1\\over\\bn_\\alpha^{\\nu+n_\\alpha/2 } }     \\exp\\left [ -{1\\over2\\bn_\\alpha }      \\sum_{k\\in\\alpha}\\frac{1}{p_k}\\left|\\teps_k\\right|^2\\right]\\end{aligned}\\ ] ] where @xmath68 refers to a sum over modes in band @xmath55 .",
    "we also define the estimate of the noise as @xmath69 for future use",
    ".    we can simultaneously solve for the maximum - probability noise and signal .",
    "carrying out the necessary derivatives gives @xmath70\\nonumber\\\\ & = & ( d - at)^t n^{-1 } a = \\varepsilon^t n^{-1 } a\\end{aligned}\\ ] ] ( switching between indices in fourier space and matrix notation ) and @xmath71.\\ ] ] setting these to zero and solving , we then find we must simultaneously satisfy @xmath72 ( using matrix notation for simplicity ) and @xmath73 equation  [ eq : maxlmap ] is just the usual maximum - likelihood map solution ; equation  [ eq : maxlnoise ] is the average `` periodogram '' ( , the naive power spectrum calculated from the fourier transform ) of the noise over the band @xmath55 , with a slight modification for the prior probability , parameterized by @xmath74 ; for wide bands this modification is irrelevant . as we will see below , iteration is actually a very efficient way to solve equations [ eq : maxlmap ] and [ eq : maxlnoise ] simultaneously . for future reference",
    ", we also write down the derivative with respect to the map at the joint maximum ( , substituting eq .",
    "[ eq : maxlnoise ] into eq .",
    "[ eq : tpderiv ] ) , @xmath75.\\ ] ]    if we fix the noise at the joint maximum , then the problem reduces to that of the previous section , a gaussian likelihood in @xmath15 for which the usual tools can be applied .",
    "this is not a rigorous approach to the problem , however due to correlation between noise and signal estimation . to get a handle on this",
    ", we calculate the curvature of the distribution around this joint maximum , which we define as @xmath76 where a subscript @xmath55 or @xmath14 refers to a derivative with respect to @xmath54 or @xmath15 , respectively .",
    "@xmath77 refers to the full matrix ; @xmath78 to the sub - blocks .",
    "explicitly , the parameter derivatives are @xmath79 and @xmath80 with the cross - curvature @xmath81    the distribution about the joint maximum is _ not _ a gaussian in the @xmath54 directions , so there is more information available than this .",
    "nonetheless , if we treat the distribution as if it were gaussian , we can calculate the covariance matrix , given by the inverse of this curvature matrix ; if we assume that the matrix @xmath82 is invertible , then we find that the effective variance of the map is increased from @xmath83 to @xmath84^{-1 } \\label{correction}\\end{aligned}\\ ] ] which we have evaluated at the simultaneous peak of the distribution to determine @xmath54 .    to assess the importance of the correction term we can consider an approximate expression that relates @xmath85 to @xmath86",
    "; we shall assume that @xmath87 is approximately white , with a constant number of frequency samples per bin , , @xmath88 , @xmath89 for all @xmath55 , and @xmath65 .",
    "the key parameter is then @xmath90 where @xmath91 is the total time spent on a pixel @xmath14 and @xmath59 is the dimensionful width of the bins .",
    "a simple way of obtaining @xmath92 is by reordering the data stream in such a way that all time samples for a given pixel are grouped contiguously .",
    "then the minumum frequency for a given pixel will correspond to @xmath93 where @xmath91 is now the length of the data stream segment .",
    "we then have that the total number of discrete modes in bin of width @xmath59 is @xmath94 .",
    "the extra factor of two comes from equation ( [ correction ] ) .    if we take the ensemble average of eq .",
    "[ correction ] we obtain @xmath95 for an equal amount of time spent on each pixel we have that @xmath96 where @xmath97 so that eq .  [ corrapp ] simplifies to @xmath98 this immediately shows us two limits . in the case of one frequency per band , the inverse variance is negative and the problem is ill - defined ; in some sense one is trying to estimate too much from the data set . in the limit of just one band ( , @xmath99 )",
    "the correction for the effective variance is negligible . for practical cases",
    "one needs enough bins to properly capture the shape of the noise periodogram , so one has to consider some intermediate regime .",
    "for the case of one pixel and white noise , to get a correction of less than 1@xmath100 to the @xmath101 , one needs @xmath102 . for more realistic cases of many pixels and non - white noise ,",
    "much larger bins are necessary , and must be evaluated on a case by case basis .",
    "we note a caveat to this procedure : consider an experiment that simply chops with a given frequency of rotation in a circle on the sky ( as in a simple model for planck s observing strategy ) .",
    "any source of noise synchronous with this motion will necessarily be very difficult to distinguish from sky signal .",
    "that is , there will necessarily be strong covariance between chop- or spin- synchronous noise and the signal .",
    "this will remain somewhat the case even if the pattern moves slowly on the sky . in this case , other information , such as the smoothness of the noise power spectrum , must be used .      instead of this joint solution , formally , at least , we know the appropriate procedure : marginalize over the quantity we do nt care about ( the noise power spectrum ) to obtain the distribution for the quantity we wish to know ( the map , @xmath15 ) .",
    "we can actually carry out the integral in this case : @xmath103^{-(n_\\alpha/2+\\nu-1)}\\end{aligned}\\ ] ] ( this is just student s t distribution in a slightly different form than is usually seen ) .",
    "if we stay in fourier space , the maximum of this distribution can be calculated to be the solution of @xmath104.\\ ] ] note that this is _ exactly the same form _ as eq .",
    "[ eq : maxltpderiv ] , the equation for the maximum probability map in the joint estimation case , with the prefactor @xmath105 replaced by @xmath106 .",
    "this is equivalent to changing the exponent of the prior probability from @xmath74 to @xmath107 : the marginalized maximum for @xmath65 ( jefferys prior ) is the same as the joint maximum for @xmath108 ( constant prior ) .",
    "we have also seen that for @xmath109 , the value of @xmath74 is irrelevant , so that these maxima should be nearly equal .",
    "( moreover , the numerical tools to calculate the joint solution , outlined below , can be used in this case , too . ) note also that if @xmath110 , the equation is nt solved for any map . in this case , either our prior information is so unrestrictive or the bands are so narrow that it is impossible to distinguish between noise and signal , and the probability distribution has no maximum when the noise is marginalized .    in principle , any further analysis of the map would have to rely on the full distribution of eq .",
    "[ eq : noisemarg ] . in practice ,",
    "the t - distribution is quite close to a gaussian although the tails are suppressed by a power - law rather than an exponential .",
    "it will thus be an excellent approximation to take the distribution to be a gaussian @xmath111,\\end{aligned}\\ ] ] with noise covariance given by @xmath112,\\end{aligned}\\ ] ] where @xmath113 is the solution to eq .",
    "[ eq : margmax ] and the derivatives are taken with respect to the _ full _ distribution of eq .  [ eq : margmax ] .",
    "note that the inverse of @xmath114 ( occasionally referred to as the weight matrix ) is given by the sum of two terms .",
    "the first is just the weight matrix that would be assigned given the maximum probability solution for the noise , eq .",
    "[ eq : noisecorr ] ( with the numerically irrelevant change of the prior @xmath115 as noted above ) .",
    "again we find a correction term due to the fact that we are only able to _ estimate _ this noise power spectrum .",
    "this correction term can be minimized by taking sufficiently wide bands , as in the simultaneous estimation case above ( and subject to the same caveats ) .",
    "in this section we propose an algorithm for finding the maximum likelihood estimate ( mle ) of the noise and signal and we apply it to two models that contain all the essential features of current cmb measurement processes .",
    "we parameterize the map and noise as described above , in terms of a set of pixel temperatures , @xmath15 , and a set of bandpowers , @xmath54 .",
    "the noise is stationary and gaussian with a periodogram of the form : @xmath116 given some prior knowledge of the position of @xmath117 we divide the noise periodogram , @xmath19 , into logarithmically equally spaced bins below @xmath117 and linearly equally spaced bins above @xmath117",
    ".    equations  [ eq : maxlmap ] and [ eq : maxlnoise ] are nonlinear and it is therefore impractical to obtain an explicit solution for @xmath54 and @xmath15 .",
    "however the structure of this system lends itself to an iterative approximation scheme ; given the @xmath118 estimate the map , @xmath119 , we can find the the @xmath118 estimate of the noise in a band @xmath55 , @xmath120 from equation  [ eq : maxlnoise ] .",
    "as we shall see , this system will converge to the mle of @xmath15 and @xmath54 .",
    "we note that this algorithm is similar to `` expectation - maximization '' ( em ) algorithms @xcite which alternate between filling in unknown data ( as in our mapmaking step ) and calculating a maximum - likelihood estimation of some quantity ( the power - spectrum estimation step ) .",
    "the algorithm starts with initial conditions : @xmath121 the iterative step is @xmath122    the first model cmb experiment we will analyse is an idealized small sky mapping experiment for which we shall adopt the name _ fence _ scan @xcite : for the first half of the experiment the beam is swept back and forward horizontally , shifting downwards until the entire patch has been covered ; for the second half of the scan the beam is swept back and forth vertically , shifting horizontally to the left , again until the patch is completely covered .",
    "the end result is a set of perpendicularly crossed linked scans .",
    "the second model scan is a small sky version of the original planck surveyor scan strategy , where great circles intersect at the two poles ( we shall call it a _ poles _ scan ) : the beam sweeps horizontally back and forth along a square patch of the sky , drifting downwards until the bottom of the patch when it reaches the end of the scan ; at the edge of each horizontal sweep the beam returns to the same pixels ( one on the left and one on the right ) .",
    "the crosslinking is then simply at the two end pixels ( which play the role of the poles in the full - sky , great circle planck scan ) .",
    "we consider a map with @xmath123 pixels for the fence scan and @xmath124 pixels for the poles scan .",
    "we generate 56000 observations per scan .",
    "the noise is generated by a stationary , gaussian number generator with periodogram given by eq .",
    "[ eq : noiseper ] and we choose @xmath125=0.5 where @xmath126 is the duration of one horizontal sweep ; we have found this to be typical values in the boomerang and maxima experiments .",
    "the first thing to check is if the algorithm converges .",
    "we quantify this by comparing the map and periodogram in successive iterations using @xmath127 where @xmath128 is the number of bins that characterize the periodogram and @xmath129 is the number of pixels in the map .",
    "the form of the denominator guarantees that spurious null values of these quantities wo nt bias the measure of convergence . in figure",
    "[ fig : convergence ] we plot the average of 200 simulated experiments for three levels of signal - to - noise .",
    "there are essentially only two parameters which may effect the existence of , and convergence to , a fixed point : the number of samples per bin , @xmath57 , and the signal - to - noise of the experiment . as we saw in the previous section",
    ", @xmath57 must be sufficiently large for @xmath130 to be positive definite ; otherwise the problem is ill - posed . as one would expect from eq .",
    "[ corrapp ] , this is tied to the convergence of the iterative scheme we propose : if the @xmath57 are small the algorithm either does not converge or takes a prohibitively long time to converge ( of order @xmath131 iterations ) . for simplicity of analysis",
    "we consider all linear bins to have the same number of samples .",
    "we then find that the threshold for both of the experimental strategies is @xmath132 ; the number of logarithmic bins between the minimum frequency and @xmath133 are @xmath134 . for values greater than this",
    ", the system has difficulties in converging , for smaller values there is very little increase in speed .",
    "a few comments are in order .",
    "firstly in choosing such values of @xmath57 we are in a regime in which both the joint estimate of @xmath135 and the sole estimate of @xmath15 using the marginalized likelihood give essentially the same results .",
    "secondly one may worry that one is smoothing out important features in the noise periodogram , in particular mis - estimating the shape of the periodogram below @xmath117 and smoothing over spectral `` spikes '' .",
    "we have found that in choosing @xmath136 logarithmic bins below @xmath117 we adequately resolve the shape while at the same time having enough samples per bin to get rapid convergence .",
    "fine structures in the noise periodogram are typically wide enough to be resolved with the resolution we propose here ; very fine structures are usually due to systematic effects and should be taken care of as such .",
    "thirdly , as we saw in section  [ unknownnoise ] , the wider the bins , the smaller the correction to the noise covariance matrix ; this must be taken into account when subsequently using @xmath36 for estimating @xmath0 .",
    "for the `` borderline '' values of @xmath57 we use for figure  [ fig : convergence ] we expect the correction terms to increase @xmath36 by @xmath137@xmath138 .",
    "larger values of @xmath57 for which convergence is slightly more rapid should give smaller corrections .",
    "the second factor we mentioned is the signal - to - noise of the experiment ; the figure of merit to be used is the signal - to - noise per frequency band _ in the bands where there is signal_. let us clarify what we mean .",
    "for the ensemble average signal periodogram we know that there will only be a significant signal amplitude for frequencies corresponding to the scan frequency and its harmonics . comparing to the ensemble average noise periodogram",
    ", there will be two limiting regimes : if the signal - to - noise is small , the noise will dominate and the `` spikes '' of the signal will be subdominant ; if the signal - to - noise is large , the signal periodogram , _ at the scan frequency and its harmonics _ will stand out .",
    "the signal - to - noise in these bands is naturally related to the signal - to - noise per beam ; for the case of white noise one has @xmath139 where the constant of proportionality is dependent on the characteristics of the experiment ( see appendix  [ ston ] ) .",
    "the larger the s / n of the experiment , the further away the initial estimate of the periodogram will be from the ml estimate .",
    "prior expectation of the smoothness of @xmath19 can also be used to distinguish between noise and spikes from the signal , although , as mentioned above scan - synchronous noise ( which produces similar spikes in the periodogram ) is very difficult to disentangle from the signal . from figure",
    "[ fig : convergence ] we can read off the effect for different levels of signal - to - noise . for @xmath140 , we can see that , regardless of the level of signal - to - noise , between @xmath141 , the algorithm converges to better than one percent in the first 5 iterations . for",
    "signal - to - noise up to one , the speed of convergence is approximately constant , while for high signal - to - noise , after a transient of slow convergence , the map converges to the fixed point much faster .",
    "the evolution of @xmath142 is much more sensitive to the signal - to - noise : the higher the signal - to - noise the slower the convergence at each iteration .    thus far we have shown that the algorithm converges to a fixed point which we know is the mle estimate of @xmath15 and @xmath54 .",
    "it is now important to check how biased such an estimate is , , whether for an ensemble of realizations of the noise time series the average of the mle @xmath54 is centred on the true ensemble average @xmath54 .",
    "to do so we have generated 200 realizations of the mock experiments for both fence and poles scans . in figure",
    "[ fig : sn1a ] we plot the results for an experiment with signal - to - noise per beam of order unity .",
    "the open circles are the mle of the @xmath54 after 5 iterations of our algorithm , and as we see match up with the ensemble average noise periodogram ( dashed lines ) for both the poles and fence scans .",
    "moreover we find that the initial estimate of the noise periodogram , @xmath143 ( crosses ) , is also a good estimate of the @xmath54 at this level of signal - to - noise .",
    "naturally , for higher signal - to - noise per beam , the initial estimate is not that good . in figure  [ fig : sn5a ] we plot the ensemble average @xmath19 as a dashed line , @xmath143 as crosses and the mle of @xmath54 as open circles for experiments with signal - to - noise of 5 . in the high signal - to - noise range of the periodogram , which corresponds to @xmath144 , @xmath145 is a very bad estimate of @xmath54 ; one is misinterpreting signal as noise .",
    "we clearly see , however the the mle estimate of @xmath54 is centred on the @xmath19 , a result which is not surprising given what we found in our analysis of the convergence of the algorithm .    a possible alternative to initial conditions ,",
    "@xmath146 and @xmath145 , of equation  [ eq : ic ] is to start with the raw map : @xmath147 indeed in the absence of low frequency , @xmath148 noise , this is the mle solution to the map .",
    "we have regenerated our monte carlo results using these initial conditions and present them in figure  [ fig : sn_raw ] .",
    "the first thing to note is that the mle of @xmath54 is centred on the ensemble average @xmath19 just as in the original choice of @xmath149 .",
    "again this is evidence that the mle fixed point is a strong attractor of the iterative algorithm , and relatively insensitive to initial conditions .",
    "in addition we find that @xmath145 constructed from the raw map estimate of the signal is a bad estimator for @xmath54 in the low frequency range .",
    "this is true in both low and high signal - to - noise experiments given that at low frequencies the noise component of the periodogram always dominates : the raw map misrepresents the low frequency noise as signal and subtracts it away from the data stream as such .",
    "in this section , we apply the formalism developed in the earlier sections to a somewhat different problem : the calibration of anisotropy experiments off the cmb dipole . nowadays , many anisotropy experiments have a `` spinning mode '' when they rotate in a circle of constant elevation on the sky @xcite .",
    "( over short periods of time , this scan is approximately a scan at constant `` latitude '' relative to some fixed pole on the sky . )",
    "the circle is chosen to have sufficiently large opening angle such that the measurement is sensitive to large - angle cmb anisotropy .",
    "the amplitude of the cmb dipole is sufficiently high that the data for these scans is dominated by the modulation of the dipole around the circle . in this case , the data are given by @xmath150 where @xmath12 and @xmath15 are noise and anisotropy signal as before , and @xmath151 is the dipole pattern at pixel @xmath14 , which has a well - measured amplitude and well - understood pattern .",
    "the constant of proportionality for the dipole , @xmath152 , is then the calibration of the detector .",
    "we also allow contamination from the galaxy at that pixel , @xmath153 , where @xmath154 allows an extrapolation from the frequencies where the galaxy is well - measured to those observed by the experiment under consideration .",
    "( of course , if we take the signal , @xmath15 , or the galaxy , @xmath155 , to be in real temperature units , they too must include the calibration parameter . )",
    "we wish to basically apply the same rationale as before : determine @xmath55 along with the other parameters , or ideally determine @xmath55 marginalizing over the other parameters . for the purposes of dipole calibration",
    ", we can ignore the intrinsic cmb contribution , or , for a particular power spectrum , include it in the noise ( because of the circular nature of the scan , the isotropy of the cmb translates to an effective stationarity for circular scans , so the cmb signal contribution could easily be included ) .",
    "because the signal - to - noise of the dipole measurements is so high , it hardly matters . we can thus rewrite the above equation in a suggestive form : @xmath156 where @xmath157 and @xmath158 . in this form",
    ", we immediately see that we can use the techniques developed above to estimate @xmath159 . for known noise ,",
    "the best - fit calibration would be @xmath160    in fact , if our model of the galaxy were perfect , we could just set @xmath161 and estimate that single parameter : @xmath162^{-1 }   ( b_{i0 } + b_{i1})^t   n^{-1 } d\\ ] ] where now there are no matrix manipulations ( except for @xmath163 ) .",
    "however , our extrapolation of galactic models and observations remains sufficiently uncertain that it is probably best to wholly ignore the data within the galactic plane , which amount to a small number of pixels in a dipole scan .",
    "with unknown noise , we can again iterate to simultaneously determine the noise power spectrum and the calibration .",
    "however , there is one significant difference in this case : because the dipole scans describe nearly perfect circles on the sky , the dipole signal is nearly sinusoidal ( and the galaxy signal , although complicated , is nearly periodic with the same period ) .",
    "thus , most of the signal power will be located in a very narrow frequency bin ( or harmonics thereof ) and will have much higher signal - to - noise than the cmb anisotropy .",
    "this has several practical effects . outside of this bin",
    ", the noise power can be determined by simply taking the periodogram of the data .",
    "if we expect the noise power spectrum to be smooth compared to the width of the dipole spike , we may be able to estimate the noise outside of the spike and smoothly extrapolate into the region shared with the dipole . in this case",
    ", we expect that the determination of the noise and calibration to be nearly independent , and so the marginalization exercise above should prove superfluous ( as should any need for iteration ) .",
    "the simplicity of this result is somewhat compromised by the presence of the galactic signal .",
    "to a very good approximation , we can assume that the contribution from the galaxy is zero except for a small number of pixels where it overwhelms the rest of the data , and again that the dipole signal is much larger than the anisotropy signal .",
    "as our models of moderate - latitude galactic emission improve , this information can be incorporated .",
    "but because of the known angular frequency of the dipole signal , it is safe to remove any part of the data possibly contaminated by galactic emission .    in this case",
    ", the data are @xmath164 where we also take @xmath165 the formally infinite noise in these pixels just amounts to ignoring those rows and columns in matrix manipulation .",
    "how does this method compare with more traditional methods of dipole calibration ?",
    "rather then encompass all of the noise into a power spectrum , it is customary to split the noise into @xmath166 where @xmath167 and @xmath168 are constant over short segments of the data , and @xmath169 is a white noise component .",
    "that is , the noise is described as an offset , a linear drift , and white noise , over sufficiently short timespans .",
    "the amplitude of the noise , @xmath170 is estimated and a least - squares fit to @xmath167 , @xmath168 and the calibration is done on the short segments and combined at the end of the process . this can be complicated somewhat by marginalizing over the @xmath171 in each segment and finding a single , global calibration and errors . to the extent",
    "that this is a good model for the noise , this procedure should find correct results .",
    "note , though , that eq .",
    "[ eq : dipolenoise ] is not a completely general description of noise while our result simply assumes gaussian and stationary noise .    of course , this procedure can be extended to deal with any sort of `` template , '' that is , signals of known shape but unknown amplitude .",
    "such amplitudes can be estimated or even marginalized over in the usual way for gaussian likelihoods . here",
    ", though , we present it as a superior way to account for low - frequency noise when calibrating experiments .",
    "in this paper we have addressed the task of correctly estimating noise in current cmb experiments .",
    "our main points and conclusions are :    1 .   long term , correlated noise is ubiquitous in current cmb experiments .",
    "the dependence of the noise characteristics on the specifics of the actual observational conditions make it essential to devise an algorithm which can estimate the noise from the data stream itself .",
    "2 .   under the assumption of stationarity and gaussianity of the noise we present the maximum likelihood estimates of both signal and noise from a data stream .",
    "these estimates are solutions to a coupled set of nonlinear equations which must be solved iteratively .",
    "3 .   given that we are now jointly estimating the signal and noise , there will be correlations between the map and the pixel noise covariance matrix .",
    "the standard expression for the pixel noise covariance matrix is now modified by a correction term which is effectively proportional to the number of pixels and inversely proportional to the width of the bands one is using to characterize the noise periodogram .",
    "if we forgo estimating the noise periodogram and marginalize over it , we obtain an estimate for the map and its covariance which is effectively equivalent to the joint estimate of map and noise in the limit of wide bands .",
    "we show that , for wide enough bands , the iterative method converges quickly to the fixed point . for convergence better than a few percent ,",
    "this can be achieved in 4 - 6 iterations , for @xmath172 .",
    "an analysis of two standard observational strategies shows that our estimate is unbiased .",
    "we show that the two conventional alternative methods are biased for high signal - to - noise . 7 .",
    "it is conventional wisdom that an ideal observational strategy has signal - to - noise of unity @xcite .",
    "we show that , in this regime , a good approximation to the estimator of the noise periodogram is the banded periodogram of the data stream .",
    "thus one is able to avoid the time consuming process of performing multiple iterations .",
    "a few additional comments should be made :    1 .   for gaussian theories one can by - pass the map estimation step altogether , constructing an iterative algorithm that estimates @xmath87 and @xmath0 directly .",
    "this sensibly puts the spatial power spectrum of the signal and the temporal power spectrum of the noise on the same footing . a priori , however , the computational expense of such an algorithm is prohibitive ; however , it is possible to simplify the matrix manipulations exploiting the stationarity of the noise and the isotropy of the signal .",
    "we have not addressed the computationally feasibility of our method ; it is well known that for data sets of current cmb experiments and the expected megapixel datasets there is a serious problem with actually performing all the matrix manipulations @xcite . in the case of our method",
    "these problems are of course worse : one must perform these matrix manipulations multiple times .",
    "we have limited ourselves to implementing our procedure assumimg the limitations of the standard map making procedure ( we do not think that there is an alternative more efficient but accurate methods which can be applied for large data sets ) and are therefore at the limit of computational capability with regards to data sets from experiments such as boomerang and maxima .",
    "a possible approach is to make local ( in time ) estimates of the noise periodogram by restricting oneself to subsections of the time stream which are long enough to show the long term correlations of the noise but small enough to be computationally tractable .",
    "this approach is indeed justified in some of the current experiments which have `` ac coupled detectors '' , whose signal is high - pass filtered by the hardware .",
    "we have also not addressed the problem of `` gaps '' in the data , the fact that sections of the data may be contaminated with , for example , cosmic rays , high amplitude galactic emission , fast detector transients , etc . there",
    "exist a variety of techniques for estimating the fourier transform of unevenly sampled data , from the more conventional ones like the lomb periodogram @xcite to advanced multitaper techniques @xcite . for many data sets ,",
    "only a small fraction of the time series is in gaps ; a simple filling - in procedure followed by a standard fft periodogram will be adequate .",
    "4 .   in section  [ sec : dipole ] we have only considered spatial templates ( such as the galaxy or the dipole ) .",
    "however , many cmb experiments suffer from the presence of signals which have a well defined structure in time @xcite .",
    "examples of such signals are detector variations due to the mechanical motion of the experimental apparatus or microphonic contaminants with well defined frequency and phase .",
    "once again this can be dealt with in the way described in section  [ sec : dipole ] albeit with obvious modifications to eqs .",
    "[ dip1 ] and [ dip2 ] to include temporal templates .",
    "5 .   for ground - based and balloon - borne experiments",
    "an essential problem is atmospheric contamination @xcite .",
    "the template is now spatially and temporally varying and therefore quite difficult to characterize in detail .",
    "a possible way of dealing with this contaminant is to have a channel dedicated to measuring atmospheric emission at high frequency during the time of observation ; one then uses the data stream of this channel as a template .",
    "of course this is an open problem and must be dealt with carefully in current cmb experiments .",
    "the techniques we have described here will be applied to the maxima @xcite and boomerang @xcite experiments .",
    "we would like to thank j. borrill , a. lange , c.b .",
    "netterfeld , j. ruhl , g. smoot and especially s. hanany and a. lee for useful conversations .",
    "resources of the combat collaboration ( nasa aisrp grant nag-3941 ) , nasa ltsa grant nag5 - 6552 , and nsf kdi grant 9872979 were used .",
    "one would like to relate the signal - to - noise in the map to the signal - to - noise in the time series . to do so we will work out a simple analytical model of a one dimensional experiment @xcite .",
    "we shall consider a great circle scan , choosing @xmath173 with @xmath174 and @xmath175 .",
    "if we assume a scan speed @xmath176 we can define the pointing matrix to be @xmath177.\\end{aligned}\\ ] ] the periodogram of the data stream is @xmath178 where @xmath179 and we have assumed that the total time of the scan is @xmath180 , corresponding to @xmath181 consecutive scans of the great circle .",
    "as we can see from figure  [ fig : pointing ] , @xmath182 is highly peaked at multiples of the scan frequency @xmath183 ( with peak amplitude @xmath184 ) ; this means that the signal in the time series is concentrated at these frequencies .",
    "a natural measure of the signal - to - noise in the time series is to compare the integrated power in signal for a band around a multiple @xmath185 of the scan frequency with the integrated power in noise within the same frequency band , , @xmath186 naturally for arbitrary noise and signal , this ratio will depend on the multiple of the scan frequency one is looking at .",
    "for example if the noise has a @xmath148 the @xmath187 will be much smaller at low @xmath188 than at high @xmath188 .",
    "let us consider a simple case where the comparison is independent of @xmath189 : @xmath190 and @xmath191 .",
    "we then find that ( looking at @xmath192 ) : @xmath193 the signal - to - noise in a given band is then @xmath194    bond , j.r . , jaffe a.h . , and",
    "knox , l. , _ phys . rev . _ * d * ( 1998 ) .",
    "bond , j.r . and jaffe , a. , _ phil .",
    "a _ , in press ( 1999 ) .",
    "borrill , j. , proceedings of the rome conference on _",
    "3k cosmology _ , in press ( 1999 ) de bernardis , p. and masi , s. , proceedings of the rencontres de moriond on _ fundamental parameters in cosmology _ , in press , 1998 de bernardis , p. , proceedings of the rome conference on _",
    "3k cosmology _ , in press ( 1999 ) delabrouille , j. , grski , k. and hivon .",
    "e. , _ m.n.r.a.s _ , * 298 * , 445 ( 1998 ) .",
    "delabrouille , j. , _ astron .",
    "@xmath195 astroph .",
    "_ , * 127 * , 555 , ( 1998 ) .",
    "devlin , m.j _ et al _ _ ap . j. lett _ * 509 * 72 ( 1998 ) grski , k.m .",
    ", _ astroph .",
    "jour . _ * 430 * l85 ( 1994 ) grski , k.m .",
    "_ et al _ , _ astroph .",
    "jour . _ * 430 * l89 ( 1994 ) grski , k.m .",
    "_ et al _ , _ astroph .",
    "jour . _ * 464 * l11 ( 1996 ) grski , k.m . ,",
    "hivon , e. and wandelt , b. , proceedings of the mpa / eso conference on evolution of large - scale structure : from recombination to garching , eds .",
    "banday , r.k .",
    "sheth and l. da costa , in press ( 1999 ) .",
    "jaffe , a. , in preparation , ( 1999 ) .",
    "kendall , m.g . and stuart , a. , _ the advanced theory of statistics _ ,",
    "charles griffin ( 1977 ) .",
    "kogut , a. _ et al _ , _ astroph .",
    "jour . _ * 470 * 653 ( 1996 ) komm , r. _ et al _ , _ astroph .",
    "jour _ , in press , ( 1999 ) , lee , a _ et al _ , proceedings of the rome conference on _",
    "3k cosmology _ , in press ( 1999 ) lineweaver , c. _ et al _ _ astroph .",
    "_ * 436 * 452 ( 1994 ) lupton , r. , _ statistics in theory and in practice _ ,",
    "pup , princeton ( 1993 ) moon , t.k .",
    ", _ ieee signal proc . magazine _ ,",
    "november 1996 , 47 ( 1996 ) .",
    "press , w. _ et al _ , _ numerical recipes _ , cup , cambridge , 1993 .",
    "tegmark , m. , _ phys .",
    "rev . _ * d56 * , 4514 ( 1997 ) tegmark , m. , _ astroph .",
    "jour . _ * 455 * , 1 ( 1996 ) wright , e.l , _ et al _ _ astroph .",
    "_ * 458 * l53 ( 1996 ) wright , e.l , astro - ph/9612105"
  ],
  "abstract_text": [
    "<S> to correctly analyse data sets from current microwave detection technology , one is forced to estimate the sky signal and experimental noise simultaneously . given a time - ordered data set we propose a formalism and method for estimating the signal and associated errors without prior knowledge of the noise power spectrum . </S>",
    "<S> we derive the method using a bayesian formalism and relate it to the standard methods ; in particular we show how this leads to a change in the estimate of the noise covariance matrix of the sky signal . </S>",
    "<S> we study the convergence and accuracy of the method on two mock observational strategies and discuss its application to a currently - favoured calibration procedure .    </S>",
    "<S> cosmic microwave background </S>"
  ]
}