{
  "article_text": [
    "in combinatorics on words , the most famous class of infinite words is certainly that of sturmian words .",
    "they code digital straight lines in the discrete plane having irrational slope , and are characterized by the property of having exactly @xmath0 factors of length @xmath1 , for every @xmath2 .",
    "it is well known ( see @xcite , proposition 2.1.17 ) that a finite word @xmath6 is a factor of some sturmian word if and only if @xmath6 is a binary _ balanced _ word , that is , for every letter @xmath7 and every pair of factors of @xmath6 of the same length , @xmath4 and @xmath8 , one has that @xmath4 and @xmath8 contain the same number of @xmath7 s up to one , i.e. , @xmath9    finite sturmian words ( finite factors of sturmian words ) have _ at most _",
    "@xmath0 factors of length @xmath1 , for every @xmath2 .",
    "however , this property does not characterize them , as shown by the word @xmath10 , which is not sturmian since the factors @xmath11 and @xmath12 do not verify .",
    "the finite words defined by the property of having at most @xmath0 factors of length @xmath1 , for every @xmath2 , are called _",
    "trapezoidal words_. the name comes from the fact that the graph of the function counting the distinct factors of each length ( usually called the factor complexity ) defines , for trapezoidal words , an isosceles trapezoid .",
    "trapezoidal words were defined by de luca @xcite by means of combinatorial parameters on the repeated factors of finite words . for a finite word @xmath6 over a finite alphabet @xmath13 , let @xmath14 be the minimal length of an unrepeated suffix of @xmath6 and let @xmath15 be the minimal length for which @xmath6 does not contain right special factors , i.e. , factors having occurrences followed by distinct letters .",
    "de luca proved that for any word @xmath6 of length @xmath16 one always has @xmath17 and studied the case in which the equality holds .",
    "this is in fact the case in which @xmath6 is trapezoidal , since one can prove ( see proposition [ prop : trap ] later ) that a word @xmath6 is trapezoidal if and only if @xmath18 then , de luca proved that finite sturmian words verify and are therefore trapezoidal .",
    "the non - sturmian trapezoidal words were later characterized by dalessandro @xcite . since a non - sturmian word is not balanced , it must contain a pair of factors having the same length and not verifying .",
    "such a pair is called a _",
    "pathological pair_. let @xmath6 be a non - sturmian word and @xmath19 its pathological pair of minimal length .",
    "dalessandro proved that @xmath6 is trapezoidal if and only if @xmath20 for some @xmath21 and @xmath22 , where @xmath23 is the reversal of the fractional root @xmath24 of @xmath25 and @xmath26 is the fractional root of @xmath27 .",
    "this characterization is quite involved and will be discussed in detail later .",
    "the characterization by dalessandro allows us to give an enumerative formula for trapezoidal words .",
    "indeed , it is known that the number of sturmian words of length @xmath1 is equal to @xmath28 ( cf .",
    "@xcite ) , where @xmath29 is the euler totient function , i.e. , @xmath30 is the number of positive integers smaller than or equal to @xmath1 and coprime with @xmath1 . in section [ sec : formula ]",
    "we prove that the number of non - sturmian trapezoidal words of length @xmath1 is @xmath31 and thus the number of trapezoidal words of length @xmath1 is @xmath32 ( theorem [ theor : enum ] ) .",
    "we then distinguish trapezoidal words into two distinct classes , accordingly with the definition below .",
    "[ def : closed ] let @xmath6 be a finite word over an alphabet @xmath13 .",
    "we say that @xmath6 is _ closed _ if it is empty or it has a factor ( different from the word itself ) occurring exactly twice in @xmath6 , as a prefix and as a suffix , that is , with no internal occurrences . a word which is not closed is called _",
    "open_.    for example , the words @xmath33 and @xmath34 are closed , whereas the word @xmath35 is open .",
    "the notion of closed word is closely related to the concept of _ complete return _ to a factor @xmath4 in a word @xmath6 , as considered in @xcite .",
    "a complete return to @xmath4 in @xmath6 is any factor of @xmath6 having exactly two occurrences of @xmath4 , one as a prefix and one as a suffix .",
    "hence @xmath6 is closed if and only if it is a complete return to one of its factors ; such a factor is clearly both the longest repeated prefix and the longest repeated suffix of @xmath6",
    ".    the notion of closed word is also equivalent to that of _ periodic - like _ word @xcite .",
    "a word @xmath6 is periodic - like if its longest repeated prefix does not appear in @xmath6 followed by different letters .",
    "we derive some properties of open and closed trapezoidal words in section [ sec : openclosed ] .",
    "we prove that the set of closed trapezoidal words is contained in that of sturmian words ( proposition [ prop : clostur ] ) .",
    "we then characterize the special factors of closed trapezoidal words ( lemma [ lem : clo1 ] ) by showing that every closed trapezoidal word @xmath6 contains a bispecial factor @xmath4 such that @xmath4 is a central word and the left ( resp .",
    "right ) special factors of @xmath6 are the prefixes ( resp .",
    "suffixes ) of @xmath4 .",
    "we show that trapezoidal palindromes ( hence , sturmian palindromes ) are closed words ( theorem [ theor : palclo ] ) , and that a closed trapezoidal word is a sturmian palindrome if and only if its longest repeated prefix is a palindrome ( proposition [ prop : palh ] ) .    in section [ sec : sesqui ] we introduce _ semicentral words _",
    ", that are trapezoidal words in which the longest repeated prefix , the longest repeated suffix , the longest left special factor and the longest right special factor all coincide .",
    "we prove in theorem [ theor : sesqui ] that a trapezoidal word @xmath6 is semicentral if and only if it is of the form @xmath36 , for a central word @xmath4 and two different letters @xmath5 .",
    "we then study , in section [ sec : fibo ] , the prefixes of the fibonacci infinite word @xmath25 , and show that the sequence of the numbers of consecutive prefixes of @xmath25 that are closed ( resp .",
    "open ) is the sequence of fibonacci numbers ( theorem [ theor : fibo ] ) .",
    "the paper ends with conclusions and open problems in section [ sec : conc ] .",
    "an _ alphabet _ , denoted by @xmath13 , is a finite set of symbols , called _",
    "letters_. a _ word _ over @xmath13 is a finite sequence of letters from @xmath13 .",
    "the subset of the alphabet @xmath13 constituted by the letters appearing in @xmath6 is denoted by @xmath37 .",
    "we let @xmath38 denote the @xmath39-th letter of @xmath6 . given a word @xmath40 , with @xmath41 for @xmath42 ,",
    "the nonnegative integer @xmath1 is the _ length _ of @xmath6 , denoted by @xmath16 .",
    "the empty word has length zero and is denoted by @xmath43 .",
    "the set of all words over @xmath13 is denoted by @xmath44 .",
    "the set of all words over @xmath13 having length @xmath1 is denoted by @xmath45 . for a letter @xmath46",
    ", @xmath47 denotes the number of @xmath7 s appearing in @xmath6 .    the word @xmath48 is called the _ reversal _ of @xmath6 .",
    "palindrome _ is a word @xmath6 such that @xmath49 . in particular , we assume @xmath50 and so the empty word is a palindrome .    a word @xmath51 is a _ factor _ of a word @xmath6 if @xmath52 for some @xmath53 . in the special case @xmath54 ( resp .",
    "@xmath55 ) , we call @xmath51 a prefix ( resp .  a suffix ) of @xmath6 . an occurrence of a factor of a word @xmath6 is _ internal _ if it is not a prefix nor a suffix of @xmath6 .",
    "the set of prefixes , suffixes and factors of the word @xmath6 are denoted respectively by @xmath56 , @xmath57 and @xmath58 .",
    "a _ border _ of the word @xmath6 is any word in @xmath59 different from @xmath6 .",
    "the _ factor complexity _ of a word @xmath6 is the function defined by @xmath60 , for every @xmath61 . a factor @xmath4 of @xmath6 is _ left special _ ( resp .",
    "_ right special _ ) in @xmath6 if there exist @xmath62 , @xmath63 , such that @xmath64 ( resp .",
    "@xmath65 ) .",
    "a factor is _ bispecial _ in @xmath6 if it is both left and right special .",
    "a _ period _ for the word @xmath6 is a positive integer @xmath66 , with @xmath67 , such that @xmath68 for every @xmath69 .",
    "since @xmath16 is always a period for @xmath6 , we have that every non - empty word has at least one period .",
    "we can unambiguously define _ the _ period of the word @xmath6 as the smallest of its periods .",
    "the period of @xmath6 is denoted @xmath70 .",
    "the _ fractional root _",
    "@xmath71 of a word @xmath6 is its prefix whose length is equal to the period of @xmath6 .",
    "a word @xmath6 is _ a power _ if there exists a non - empty word @xmath4 and an integer @xmath72 such that @xmath73 . a word which is not a power is called _",
    "primitive_.    for example ,",
    ". the left special factors of @xmath6 are @xmath75 , @xmath7 , @xmath76 , @xmath77 and @xmath78 .",
    "the right special factors of @xmath6 are @xmath75 , @xmath7 , @xmath76 and @xmath77 .",
    "therefore , the bispecial factors of @xmath6 are @xmath75 , @xmath7 , @xmath76 and @xmath77 .",
    "the period of @xmath6 is @xmath79 and the fractional root of @xmath6 is @xmath80 .",
    "the following parameters were introduced by aldo de luca @xcite :    given a word @xmath81 , @xmath82 ( resp .",
    "@xmath83 ) denotes the minimal length of a prefix ( resp .  a suffix ) of @xmath6 which occurs only once in @xmath6 .",
    "given a word @xmath81 , @xmath84 ( resp .",
    "@xmath85 ) denote the minimal length for which there are no left special factors ( resp .",
    "no right special factors ) of that length in @xmath6 .",
    "[ ex:1 ] let @xmath86 .",
    "the longest left special factor of @xmath6 is @xmath87 , and it is also the longest repeated suffix of @xmath6 ; the longest right special factor of @xmath6 is @xmath88 , and it is also the longest repeated prefix of @xmath6 .",
    "thus , we have @xmath89 , @xmath90 , @xmath91 and @xmath92 .",
    "notice that the values @xmath93 and @xmath15 are positive integers , unless for the words that are powers of a single letter , in which case @xmath94 and @xmath95 .",
    "moreover , one has @xmath96 and @xmath97 ( cf .",
    "@xcite , corollary 4.1 ) .",
    "the following proposition is from de luca ( @xcite , proposition 4.2 ) .",
    "[ prop : del ] let w be a word of length @xmath16 such that @xmath98 and set @xmath99 and @xmath100 .",
    "the factor complexity @xmath101 is strictly increasing in the interval @xmath102 $ ] , is nondecreasing in the interval @xmath103 $ ] and strictly decreasing in the interval @xmath104 $ ] .",
    "moreover , for @xmath39 in the interval @xmath105 $ ] , one has @xmath106 .",
    "if @xmath107 , then @xmath101 is constant in the interval @xmath103 $ ] .",
    "proposition [ prop : del ] allows one to give the following definition .",
    "a non - empty word @xmath6 is _ trapezoidal _ if    * @xmath108  for  @xmath109 , * @xmath110  for   @xmath111 , * @xmath112  for   @xmath113 .",
    "trapezoidal words were considered for the first time by de luca @xcite .",
    "the name _ trapezoidal _ was given by dalessandro @xcite .",
    "the choice of the name is motivated by the fact that for these words the graph of the complexity function defines an isosceles trapezoid ( possibly degenerated in a triangle ) .    .",
    "one has @xmath114 and @xmath115.,height=226 ]    it follows from the definition that a trapezoidal word is necessarily a binary word , since @xmath116 , the number of distinct letters appearing in @xmath6 , must be @xmath117 or @xmath118 .",
    "the word @xmath86 considered in example [ ex:1 ] is trapezoidal .",
    "see  [ fig : graph ] .    in the following proposition",
    "we gather some characterizations of trapezoidal words .    [",
    "prop : trap ] let @xmath6 be a word .",
    "the following conditions are equivalent :    1 .",
    "@xmath6 is trapezoidal ; 2 .",
    "@xmath119 ; 3 .",
    "@xmath120 ; 4 .",
    "@xmath6 is binary and has at most one left special factor of length @xmath1 for every @xmath61 ; 5 .",
    "@xmath6 is binary and has at most one right special factor of length @xmath1 for every @xmath61 ; 6 .",
    "@xmath6 has at most @xmath0 distinct factors of length @xmath1 for every @xmath61 ; 7 .",
    "@xmath121 for every @xmath61 .",
    "the equivalence of @xmath122 , @xmath123 , @xmath124 , @xmath125 and @xmath126 is in @xcite and @xcite .",
    "the equivalence of @xmath126 and @xmath127 follows from elementary considerations on the factor complexity of binary words .",
    "indeed , it is easy to see the number of distinct factors of length @xmath0 of a binary word @xmath6 is at most equal to the number of distinct factors of length @xmath1 plus the number of right special factors of length @xmath1 .",
    "the equivalence of @xmath128 and @xmath122 comes directly from the definitions and from proposition [ prop : del ] .    from now on ,",
    "we fix the alphabet @xmath129 . recall that a word @xmath130 is _ sturmian _ if and only if it is balanced , i.e. , verifies .",
    "the following proposition is from de luca ( @xcite , proposition 7.1 ) .",
    "[ prop : sturmtrap ] every sturmian word is trapezoidal .    the inclusion in proposition [ prop : sturmtrap ] is strict , since there exist trapezoidal words that are not sturmian , e.g. the word @xmath86 considered in example [ ex:1 ] .",
    "recall that a word @xmath6 is _ rich _",
    "@xcite ( or _ full _",
    "@xcite ) if it has @xmath131 distinct palindromic factors , that is the maximum number of distinct palindromic factors a word can contain .",
    "the following proposition is from de luca , glen and zamboni ( @xcite , proposition 2 ) .",
    "[ prop : traprich ] every trapezoidal word is rich .",
    "again , the inclusion in proposition [ prop : traprich ] is strict , since there exist binary rich words that are not trapezoidal , e.g. the word @xmath132 .",
    "we now discuss the case of non - sturmian trapezoidal words .",
    "we first recall the definition and some properties of _ central words _ @xcite .",
    "a word @xmath130 is a central word if and only if it has two coprime periods @xmath66 and @xmath133 and length equal to @xmath134 .",
    "[ prop : ipcent ] a word @xmath130 is a central word if and only if it satisfies one of the following equations , for some @xmath135 and @xmath61 :    1 .",
    "@xmath136 2 .",
    "@xmath137 3 .   @xmath138    moreover , if case @xmath139 holds one has that @xmath4 and @xmath8 are central words .",
    "it is known that if @xmath140 is a central word , then the longest between @xmath4 and @xmath8 has not internal occurrences in @xmath6 .",
    "thus , @xmath6 is a closed word .",
    "note that this is also a consequence of our theorem [ theor : palclo ] .",
    "[ prop : newcent ] a word @xmath130 is a central word if and only if @xmath6 is a palindrome and @xmath141 and @xmath142 are both sturmian words .    [ prop : centrbis ] a word @xmath130 is a central word if and only if there exists a sturmian word @xmath143 such that @xmath6 is a bispecial factor of @xmath143 .",
    "recall that a word @xmath6 is not balanced if and only if it contains a _",
    "pathological pair _",
    "@xmath19 , that is , @xmath25 and @xmath27 are factors of @xmath6 of the same length but they do not verify . moreover , if @xmath25 and @xmath27 are chosen of minimal length , there exists a palindrome @xmath4 such that @xmath144 and @xmath145 , for two different letters @xmath7 and @xmath77 ( see ( * ? ? ?",
    "* proposition 2.1.3 ) or ( * ? ? ?",
    "* lemma 3.06 ) ) .",
    "we can also state that @xmath25 and @xmath27 are sturmian words , since otherwise they would contain a pathological pair shorter than @xmath146 and hence @xmath6 would contain such a pathological pair , against the minimality of @xmath25 and @xmath27 . so the word @xmath4 is a palindrome such that @xmath147 and @xmath148 are sturmian words , that is , by proposition [ prop : newcent ] , @xmath4 is a central word .",
    "moreover , we have the following    let @xmath6 be a binary non - sturmian word and @xmath19 a pathological pair of @xmath6 of minimal length .",
    "then there exists a unique central word @xmath4 such that @xmath144 and @xmath145 .",
    "suppose by contradiction that there exists a word @xmath149 , with @xmath150 , such that @xmath6 contains as factors @xmath147 , @xmath148 , @xmath151 and @xmath152 .",
    "let @xmath153 be the longest common prefix between @xmath4 and @xmath154 .",
    "since @xmath155 there exist distinct letters @xmath156 such that @xmath157 is a prefix of @xmath4 and @xmath158 is a prefix of @xmath154",
    ". then @xmath6 would contain as factors @xmath159 , @xmath160 , @xmath161 and @xmath162 .",
    "therefore , @xmath6 would contain a pathological pair @xmath163 shorter than @xmath19 , a contradiction .",
    "the following lemma is attributed to aldo de luca in @xcite .",
    "we provide a proof for the sake of completeness .",
    "[ lem : separation ] let @xmath6 be a non - sturmian word and @xmath19 the pathological pair of @xmath6 of minimal length .",
    "then @xmath25 and @xmath27 do not overlap in @xmath6 .    by contradiction , suppose that @xmath6 contains a factor @xmath164 such that @xmath165 and @xmath166 , with @xmath167 . since @xmath168 , then @xmath169 would be a pathological pair of @xmath6 shorter than @xmath19 .",
    "we then have :    [ prop : centralroot ] let @xmath6 be a binary non - sturmian word .",
    "then there exists a unique central word of minimal length @xmath4 such that @xmath170 , for @xmath62 distinct letters and @xmath171 .",
    "we call the word @xmath4 the _ central root _ of @xmath6 .",
    "the following is the characterization of trapezoidal non - sturmian words given by dalessandro @xcite .",
    "[ theor : dal ] let @xmath6 be a binary non - sturmian word",
    ". then w is trapezoidal if and only if @xmath172 where @xmath19 is the pathological pair of @xmath6 of minimal length .",
    "in particular , if @xmath6 is trapezoidal , then @xmath173 and the longest right special factor of @xmath6 is the prefix of @xmath6 of length @xmath174 , that is , the longest proper prefix of @xmath66",
    ".    hence , trapezoidal words are either sturmian or of the form described in theorem [ theor : dal ] .",
    "let @xmath86 be the non - sturmian trapezoidal word considered in example [ ex:1 ] .",
    "we have @xmath175 and @xmath176 , so that @xmath177 and @xmath178 .",
    "the word @xmath6 can be written as @xmath20 , with @xmath179 and @xmath180 .    from now on , according to theorem [ theor : dal ] , @xmath19 is the pair of pathological factor of @xmath6 of minimal length .",
    "we now show that the words @xmath66 and @xmath133 of the factorization are sturmian words .",
    "we premise the following known result :    let @xmath6 be a finite word and @xmath71 its fractional root",
    ". then @xmath6 is sturmian if and only if so is every power of @xmath71 .",
    "[ lem : pk ] let @xmath6 be a trapezoidal non - sturmian word .",
    "then the words @xmath66 and @xmath133 of the factorization are sturmian words .    since @xmath25 and @xmath27 are sturmian , by the preceding proposition all powers of @xmath24 and @xmath26 are sturmian as well .",
    "observe that @xmath181 can be restated as @xmath182 . as prefixes and reversals of sturmian words",
    "are sturmian , the assertion follows .",
    "the following result , due to de luca , glen and zamboni @xcite , states that trapezoidal palindromes are all sturmian .",
    "we give a new proof based on theorem [ theor : dal ] .",
    "[ theor : trappal ] the following conditions are equivalent :    1 .",
    "@xmath6 is a trapezoidal palindrome ; 2 .",
    "@xmath6 is a sturmian palindrome .",
    "let @xmath6 be a trapezoidal palindrome .",
    "if @xmath6 is non - sturmian we can write , by theorem [ theor : dal ] , @xmath183 , with @xmath184 such that @xmath185 and @xmath186 . without loss of generality ,",
    "we can assume @xmath187 ; then @xmath188 contains @xmath25 and @xmath27 as factors , a contradiction since , by lemma [ lem : pk ] , @xmath66 is sturmian .",
    "so @xmath6 can not be a non - sturmian word .",
    "hence , we proved that trapezoidal palindromes are sturmian .",
    "since by proposition [ prop : sturmtrap ] , sturmian words are trapezoidal , the assertion follows .",
    "mignosi @xcite proved the following formula ( see also @xcite ) for the number @xmath189 of sturmian words of length @xmath1 : @xmath190 where @xmath29 is the euler totient function .",
    "therefore , by proposition [ prop : sturmtrap ] , in order to count the number of trapezoidal words of length @xmath1 , it is sufficient to count the number of non - sturmian trapezoidal words of that length .",
    "recall from theorem [ theor : dal ] that every non - sturmian trapezoidal word @xmath6 can be uniquely written as @xmath20 , with @xmath191 and @xmath22 , with @xmath144 , @xmath145 , where @xmath4 is the central root of @xmath6 and @xmath19 is the pathological pair of @xmath6 of minimal length .",
    "our goal is to count , for a given central word @xmath4 , how many non - sturmian trapezoidal words exist with central root @xmath4 and length @xmath1 .",
    "let us premise the following technical lemma , which is a straightforward consequence of theorem [ theor : dal ] .",
    "[ lem : tech ] let @xmath4 be a central word , and @xmath156 different letters .",
    "the non - sturmian trapezoidal words having central root @xmath4 are exactly the words of the form @xmath192 , for any @xmath193 with @xmath194 , and @xmath195 with @xmath196 .",
    "[ theor : enum ] for all @xmath61 , the number of trapezoidal words of length @xmath1 is @xmath197    we first notice that for any word @xmath51 and any @xmath198 , there exists a unique word of length @xmath199 in @xmath200 ( resp .  in @xmath201 ) . from this remark and lemma [ lem :",
    "tech ] , we deduce that for any @xmath202 and for any central word @xmath4 of length @xmath203 , there are exactly @xmath204 non - sturmian trapezoidal words of length @xmath1 having central root @xmath4 .",
    "since there are @xmath205 central words of length @xmath39 ( see @xcite ) , we have that the number of non - sturmian trapezoidal words of length @xmath1 is @xmath206 since the number of trapezoidal words of length @xmath1 is @xmath32 , by and the statement follows .    in table",
    "[ table : trap ] we give the number of trapezoidal words of each length up to 20 .",
    "c * 30@l @xmath1 & 1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 & 9 & 10 & 11 & 12 & 13 & 14 & 15 & 16 & 17 & 18 & 19 & 20 +    ' '' ''    @xmath207 & 2 & 4 & 8 & 16 & 28 & 46 & 70 & 102 & 140 & 190 & 250 & 318 & 398 & 496 & 602 & 724 & 862 & 1018 & 1192 & 1382 +    ' '' ''",
    "in this section we derive some properties of open and closed trapezoidal words . recall that a word @xmath6 is closed if it is empty or it has a factor ( different from @xmath6 ) occurring exactly twice in @xmath6 , as a prefix and as a suffix ; otherwise it is open .",
    "let @xmath6 be a non - empty word over @xmath13 .",
    "the following characterizations of closed words follow easily from the definition :    1 .",
    "@xmath6 has a factor occurring exactly twice in @xmath6 , as a prefix and as a suffix of @xmath6 ; 2 .",
    "the longest repeated prefix of @xmath6 does not have internal occurrences in @xmath6 , that is , occurs in @xmath6 only as a prefix and as a suffix ; 3 .",
    "the longest repeated suffix of @xmath6 does not have internal occurrences in @xmath6 , that is , occurs in @xmath6 only as a suffix and as a prefix ; 4 .",
    "the longest repeated prefix of @xmath6 is not right special in @xmath6 ; 5 .",
    "the longest repeated suffix of @xmath6 is not left special in @xmath6 ; 6 .",
    "@xmath6 has a border that does not have internal occurrences in @xmath6 ; 7 .",
    "the longest border of @xmath6 does not have internal occurrences in @xmath6 ; 8 .",
    "@xmath6 is the complete return to its longest repeated prefix ; 9 .",
    "@xmath6 is the complete return to its longest border ; 10 .",
    "@xmath208 , with @xmath209 non - empty , and @xmath210 .",
    "[ prop : rev ] let @xmath6 be a word . then @xmath6 is open ( resp",
    ".  closed ) if and only if @xmath211 is open ( resp .",
    "closed ) .",
    "straightforward .",
    "the following proposition gives a characterization of open trapezoidal words .",
    "[ prop : openspe ] let @xmath6 be a trapezoidal word",
    ". then the following conditions are equivalent :    1 .",
    "@xmath6 is open ; 2 .",
    "the longest repeated prefix of @xmath6 is also the longest right special factor of @xmath6 ; 3 .",
    "the longest repeated suffix of @xmath6 is also the longest left special factor of @xmath6 .",
    "let @xmath213 be the longest repeated prefix of @xmath6 and @xmath214 the letter such that @xmath215 is a prefix of @xmath6 .",
    "since @xmath6 is not closed , @xmath213 has a second non - suffix occurrence in @xmath6 followed by a letter @xmath216 .",
    "since @xmath213 is the longest repeated prefix of @xmath6 , we have @xmath217 .",
    "therefore , @xmath213 is right special in @xmath6 .",
    "suppose that @xmath6 has a right special factor @xmath218 longer than @xmath213 .",
    "since @xmath6 is trapezoidal , @xmath6 has at most one right special factor for each length ( proposition [ prop : trap ] ) .",
    "since the suffixes of a right special factor are right special factors , we have that @xmath213 must be a proper suffix of @xmath218 .",
    "since @xmath218 is right special in @xmath6 , it has at least two occurrences in @xmath6 followed by different letters .",
    "this implies a non - prefix occurrence of @xmath215 in @xmath6 , against the definition of @xmath213 .",
    "let @xmath213 be the longest repeated prefix of @xmath6 .",
    "since @xmath213 is a right special factor of @xmath6 there exist different letters @xmath7 and @xmath77 such that @xmath220 and @xmath221 are factors of @xmath6 .",
    "this implies that @xmath213 can not appear in @xmath6 only as a prefix and as a suffix , that is , @xmath6 can not be a closed word .",
    "@xmath222 can be proven symmetrically .",
    "[ prop : hrkl ] let @xmath6 be a trapezoidal word .",
    "if @xmath6 is open , then @xmath223 and @xmath224 .",
    "if @xmath6 is closed , then @xmath225 and @xmath226 .",
    "the claim for open trapezoidal words follows directly from proposition [ prop : openspe ] .",
    "suppose that @xmath6 is a closed trapezoidal word .",
    "then @xmath225 ( since @xmath6 is closed ) and therefore @xmath226 ( since @xmath6 is trapezoidal ) .    the latter proposition , however , does not characterize open and closed trapezoidal words .",
    "actually , one can have @xmath227 , as is the case in the word @xmath228 , which is closed , and also in the word @xmath229 , which is open .",
    "open trapezoidal words can be sturmian ( e.g.  @xmath230 ) or not ( e.g.  @xmath231 ) .",
    "closed trapezoidal words , instead , are always sturmian , as shown in the following proposition , that can also be found in a paper of the first two authors together with aldo de luca ( cf .",
    "@xcite , proposition 3.6 ) .",
    "here we report a proof following a totally different approach , based on theorem [ theor : dal ] .",
    "[ prop : clostur ] let @xmath6 be a trapezoidal word",
    ". if @xmath6 is closed , then @xmath6 is sturmian .",
    "suppose that @xmath6 is not sturmian .",
    "then , by theorem [ theor : dal ] , @xmath20 , @xmath191 , @xmath22 , with @xmath19 being the pathological pair of @xmath6 of minimal length , @xmath173 ( and hence @xmath232 since @xmath6 is trapezoidal ) and the longest right special factor of @xmath6 is the prefix of @xmath6 of length @xmath174 .",
    "let @xmath233 be the suffix of @xmath133 of length @xmath234 , that is , the longest repeated suffix of @xmath6 .",
    "since @xmath6 is closed , the only other occurrence of @xmath233 in @xmath6 is as a prefix of @xmath6 .    if @xmath235 , then @xmath233 is a prefix of the longest right special factor of @xmath6 .",
    "this is a contradiction with the fact that @xmath233 does not have internal occurrences in @xmath6 .    if @xmath107 , then @xmath66 is a prefix of @xmath236 and hence @xmath66 is a factor of @xmath133",
    "this implies that @xmath25 is a factor of @xmath133 , and therefore @xmath133 contains both @xmath25 and @xmath27 as factors .",
    "hence @xmath133 would be non - sturmian , contradicting lemma [ lem : pk ] .    as a corollary of proposition [ prop : clostur ]",
    ", we have that every trapezoidal word is open or sturmian .",
    "we now focus on closed trapezoidal words and their special factors .",
    "[ lem : clo1 ] let @xmath6 be a closed trapezoidal word and @xmath4 the longest left special factor of @xmath6 . then @xmath4 is also the longest right special factor of @xmath6 ( and thus @xmath4 is a bispecial factor of @xmath6 ) .",
    "moreover , @xmath4 is a central word .",
    "let @xmath4 be the longest left special factor of @xmath6 , so that there exist different letters @xmath62 such that @xmath237 and @xmath238 are factors of @xmath6 .",
    "we claim that @xmath237 and @xmath238 both occur in @xmath6 followed by some letter . indeed , suppose the contrary .",
    "then one between @xmath237 and @xmath238 , say @xmath237 , appears in @xmath6 only as a suffix .",
    "let @xmath233 be the longest repeated suffix of @xmath6 .",
    "since @xmath4 is a repeated suffix of @xmath6 , we have @xmath239 .",
    "if @xmath240 , then @xmath241 and since @xmath6 is closed , @xmath4 appears in @xmath6 only as a prefix and as a suffix , against the hypothesis that @xmath238 is a factor of @xmath6 .",
    "so @xmath242 and therefore @xmath237 must be a suffix of @xmath233 .",
    "this implies an internal occurrence of @xmath237 in @xmath6 , a contradiction .",
    "so , there exist letters @xmath5 such that @xmath243 and @xmath244 are factors of @xmath6 .",
    "now , we must have @xmath245 , since otherwise @xmath246 would be a left special factor of @xmath6 longer than @xmath4 .",
    "thus @xmath4 is right special in @xmath6 .",
    "since @xmath6 is closed , we have , by proposition [ prop : hrkl ] , @xmath226 , and therefore @xmath4 is the longest right special factor of @xmath6 .    by proposition [ prop : clostur ] , @xmath6 is sturmian . since @xmath4 is a bispecial factor of a sturmian word , we have by proposition [ prop : centrbis ] that @xmath4 is a central word .",
    "let @xmath247 .",
    "the longest repeated prefix of @xmath6 is @xmath229 , which is also the longest repeated suffix and does not have internal occurrences , hence @xmath6 is a closed trapezoidal word .",
    "the longest left special factor of @xmath6 is @xmath87 , which is also the longest right special factor of @xmath6 and it is a central word .    by theorem [ theor : trappal ] , trapezoidal palindromes coincide with sturmian palindromes , so the next results will be stated in terms of sturmian palindromes but one can replace the word `` sturmian '' with the word `` trapezoidal '' .    some results on sturmian palindromes can be found in @xcite .",
    "in particular , we recall here the following one .",
    "[ theor : delucas ] a palindrome @xmath81 is sturmian if and only if its minimal period @xmath248 satisfies @xmath249 .",
    "the next theorem shows that sturmian palindromes , and so , by theorem [ theor : trappal ] , trapezoidal palindromes , are all closed words .",
    "[ theor : palclo ] let @xmath6 be a sturmian palindrome",
    ". then @xmath6 is closed .    by contradiction , suppose that @xmath6 is open .",
    "then @xmath213 , the longest repeated prefix of @xmath6 , is also the longest right special factor of @xmath6 ( proposition [ prop : openspe ] ) .",
    "since @xmath6 is a palindrome , we have that the longest repeated suffix of @xmath6 is @xmath250 , the reversal of @xmath213 . in particular , then , @xmath251 .    by proposition",
    "[ prop : hrkl ] , @xmath223 and @xmath224 .",
    "thus we have @xmath252 , since @xmath6 is trapezoidal ( see proposition [ prop : trap ] ) .",
    "it follows that @xmath253 , for a letter @xmath254 . by theorem [ theor : delucas ] , the period of @xmath6 is @xmath255 , so that @xmath256 .",
    "therefore , we have @xmath257 .",
    "since @xmath213 is right special in @xmath6 , there exists a letter @xmath217 such that @xmath258 is a factor of @xmath6 .",
    "now , any occurrence of @xmath258 in @xmath6 can not be preceded by the letter @xmath214 , since @xmath259 is the longest repeated suffix of @xmath6 .",
    "thus @xmath6 contains the factor @xmath260 .",
    "hence , @xmath6 contains both @xmath261 and @xmath260 as factors , and this contradicts the fact that @xmath6 is sturmian .        from theorem [ theor : palclo ] and lemma [ lem : clo1 ] , we derive the following characterization of the special factors of sturmian palindromes .",
    "[ cor : sturpal ] let @xmath6 be a sturmian palindrome .",
    "then the longest left special factor of @xmath6 is also the longest right special factor of @xmath6 and it is a central word .",
    "let us recall the following characterization of rich words from  @xcite :    [ prop : compret ] a word @xmath6 is rich if and only if every factor of @xmath6 which is a complete return to a palindrome is palindromic itself .",
    "we have the following result :    [ prop : palh ] let @xmath6 be a closed trapezoidal word and @xmath213 its longest repeated prefix .",
    "then @xmath6 is a sturmian palindrome if and only if @xmath213 is a palindrome .",
    "the word @xmath6 is a complete return to @xmath213 , and it is rich by proposition  [ prop : traprich ] . since trapezoidal palindromes coincide with sturmian palindromes by theorem [ theor : trappal ] , the preceding proposition implies the assertion .",
    "the general structure of a closed trapezoidal word is depicted in  [ fig : clotrap ] .    , is also the longest repeated suffix and does not have internal occurrences .",
    "the longest left special factor , @xmath4 , is also the the longest right special factor and it is a central word ( lemma [ lem : clo1 ] ) .",
    "the word is a palindrome if and only if @xmath213 is a palindrome ( proposition [ prop : palh]).,height=37 ]    [ rem : richpal ] using proposition [ prop : compret ] , one can prove that theorem [ theor : palclo ] can be generalized to rich palindromes .",
    "indeed , let @xmath6 be a rich palindrome , and @xmath4 the longest border of @xmath6 .",
    "in order to prove that @xmath6 is closed , it is sufficient to prove that @xmath4 does not have internal occurrences in @xmath6 .",
    "suppose the contrary .",
    "then @xmath6 would contain a proper prefix of the form @xmath262 . by proposition [ prop : compret ]",
    ", @xmath262 is a palindrome .",
    "hence , @xmath262 would be a suffix of @xmath6 , against the maximality of @xmath4 .",
    "notice that the converse is not true .",
    "the word @xmath263 is a closed palindrome of length @xmath264 but contains only @xmath264 palindromic factors , so it is not rich .",
    "in what follows , we let by @xmath265 respectively denote the longest repeated prefix , the longest repeated suffix , the longest right special factor and the longest left special factor of the word @xmath6 .",
    "an intriguing class of trapezoidal words is that of words in which all these factors coincide .",
    "let @xmath6 be a trapezoidal word .",
    "we say that @xmath6 is _ semicentral _ if @xmath266 .",
    "notice that , by proposition [ prop : openspe ] , semicentral words can also be defined as those open trapezoidal words in which the longest repeated prefix is also the longest repeated suffix .",
    "the following theorem provides a characterization of semicentral words .",
    "[ theor : sesqui ] a trapezoidal word @xmath6 is semicentral if and only if there exists a central word @xmath4 such that @xmath36 with @xmath267 , @xmath245 .    by  , if @xmath6 is semicentral we can write @xmath36 , with @xmath268 and @xmath5 ( possibly equal ) letters in @xmath13 . since @xmath4 is a bispecial factor of @xmath6 , it must have a third occurrence in @xmath6 ; as @xmath269 , such an occurrence can not be preceded by @xmath216 or followed by @xmath214 .",
    "we have then @xmath270 where @xmath271 , @xmath272 and @xmath273 . if @xmath274 , then @xmath275 , so that @xmath245 and @xmath276",
    ". thus @xmath277 for some @xmath61 , so that it is a central word .",
    "similarly , if @xmath278 it follows that @xmath245 and @xmath279 is central .",
    "let then @xmath280 .",
    "from   it follows that there exists a prefix @xmath281 of @xmath4 such that @xmath282 , and a suffix @xmath283 of @xmath4 such that @xmath284 .",
    "hence , as @xmath285 , we obtain @xmath286 again , this implies @xmath245 , otherwise the number of occurrences of @xmath214 in @xmath287 and @xmath288 would be different .",
    "thus , @xmath289 is central by proposition  [ prop : ipcent ] .",
    "conversely , let @xmath4 be a central word and @xmath36 , with @xmath290 .",
    "we claim that @xmath291 occurs in @xmath6 .",
    "this is clear if @xmath4 is a power of @xmath214 or @xmath216 ; by proposition  [ prop : ipcent ] , the other possibility is @xmath289 for some words @xmath292 , so that @xmath293 gives the desired occurrence of @xmath291 .",
    "hence @xmath4 is a right special factor and a repeated suffix of @xmath6 , so that @xmath294 and @xmath295 .",
    "since @xmath296 , it follows from that @xmath6 is trapezoidal and @xmath297 .",
    "analogously , since @xmath4 is a left special factor and a repeated prefix of @xmath6 , one proves that @xmath298 .    by proposition [ prop : ipcent ]",
    ", every central word @xmath4 different from a power of a single letter can be written as @xmath289 for central words @xmath299 and @xmath300 and distinct letters @xmath5 .",
    "theorem [ theor : sesqui ] provides a similar characterization for semicentral words ( and this motivates the choice of the name ) .",
    "it is also worth noticing that semicentral words are non - strictly bispecial sturmian words ( see @xcite ) , that is , for any semicentral word @xmath6 one has that @xmath301 and @xmath302 are all sturmian words , but nevertheless either @xmath303 or @xmath304 is not sturmian .",
    "the semicentral words of length @xmath305 are : @xmath306 , @xmath307 , @xmath308 , @xmath309 , @xmath310 , @xmath311 , @xmath312 and @xmath313 .    as a consequence of theorem [ theor : sesqui ] , we have that the number @xmath314 of semicentral words of length @xmath1 is :    @xmath315",
    "in this section , we give an interesting example of the open / closed dichotomy in trapezoidal words , by analyzing prefixes of the fibonacci infinite word under this new light .",
    "the fibonacci infinite word @xmath25 is the word @xmath316 obtained as the limit of the substitution @xmath317 , @xmath318 .",
    "note that every prefix of the fibonacci word is sturmian , and therefore trapezoidal .",
    "we investigate which prefixes of @xmath25 are open and which are closed . if one writes up the list of the prefixes of @xmath25 for each length ( see table [ tab : fibo ] ) , can notice that the sequences of `` open '' and `` closed '' alternate following the fibonacci sequence @xmath319 ( defined by @xmath320 and @xmath321 for every @xmath322 ) .",
    "more precisely , the numbers of consecutive prefixes that are closed ( resp .",
    "open ) , that is , the lengths of the runs of `` c '' and `` o '' in table [ tab : fibo ] , are the fibonacci numbers . in theorem",
    "[ theor : fibo ] we show this fact .    r*9@c*11c @xmath1 & 1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 & 9 & 10 & 11 & 12 & 13 & 14 & 15 & 16 & 17 & 18 & 19 & 20 +   + @xmath323 & c & o & c & o & c & c & o & o & c & c & c & o & o & o & c & c & c & c & c & o +    [ tab : fibo ]    [ theor : fibo ] let @xmath6 be a prefix of the fibonacci word @xmath25",
    ". then @xmath6 is open if and only if there exists @xmath39 such that @xmath324 .",
    "first , let us recall some well known properties of the fibonacci word .",
    "let @xmath325 be the set of palindromic prefixes of @xmath25 .",
    "it is well known that the elements of @xmath326 are the prefixes @xmath327 of @xmath25 such that @xmath328 , @xmath329 .",
    "the words in @xmath326 are all central words . also , for every @xmath330 we have @xmath331 where @xmath332 , @xmath333 for even @xmath39 , and @xmath334 , @xmath335 for odd @xmath39 .",
    "our assertion is trivially verified if @xmath336 .",
    "hence we only need to show that for all @xmath330 , a prefix @xmath6 of @xmath25 with @xmath337 is    1 .",
    "open if @xmath338 , and 2",
    ".   closed otherwise , i.e. , when @xmath339 .",
    "let us fix @xmath330 and set @xmath340 , @xmath341 as in  .",
    "we know that the prefix of @xmath25 of length @xmath342 is @xmath343 . by theorem  [ theor : palclo ] , it is a closed word and its longest repeated prefix is @xmath327 .",
    "moreover , @xmath327 is also the longest repeated prefix of the semicentral word @xmath344 , that is the prefix of @xmath25 of length @xmath345 .",
    "therefore , @xmath327 is the longest repeated prefix for all @xmath6 s in between , i.e. , for each @xmath346 with @xmath338 .",
    "as @xmath327 has an internal occurrence in all such prefixes , they are all open , proving point 1 .",
    "it remains to show that any prefix of @xmath347 longer than @xmath344 is closed .",
    "indeed , such words have a border which is strictly longer than @xmath327 , and which can not have any internal occurrences for otherwise @xmath348 would have a second occurrence in @xmath344 .",
    ".the structure of the prefixes of @xmath25 with respect to the palindromic prefixes @xmath327 . [ cols=\"<,<,^,<,^\",options=\"header \" , ]     the longest word in a run of closed prefixes of @xmath25 is a central word .",
    "the longest word in a run of open prefixes of @xmath25 is a semicentral word .",
    "in this paper we have investigated trapezoidal words , which are a natural generalization of finite sturmian words .",
    "we exhibited a formula for counting trapezoidal words and studied open and closed trapezoidal words separately .",
    "trapezoidal words form a subclass of the class of rich words , that are words containing the maximum number of palindromic factors .",
    "a challenging problem is that of finding an enumerative formula for rich words .",
    "this problem is still open , even in the binary case . we think that separating rich words in open and closed could give further insights on these words .",
    "more generally , we think that the open / closed dichotomy can be useful in the study of other classes of words .",
    "for instance , it would be interesting to generalize the results obtained in section  [ sec : fibo ] for the fibonacci word to the class of standard words .",
    "m.  bucci , a.  de  luca , a.  de  luca , rich and periodic - like words , in : v.  diekert , d.  nowotka ( eds . ) , dlt 2009 , 13th international conference on developments in language theory , vol .",
    "5583 of lecture notes in comput .",
    "sci . , springer , 2009 , pp .",
    "145155 .",
    "a.  carpi , a.  de  luca , central sturmian words : recent developments , in : c.  de  felice , a.  restivo ( eds . ) , dlt  2005 , 9th international conference on developments in language theory , vol .",
    "3572 of lecture notes in comput .",
    "sci . , springer , 2005 , pp . 3656 .",
    "g.  fici . a characterization of bispecial sturmian words , in : b. rovan , v. sassone , and p. widmayer ( eds . ) , mfcs  2012 , 37th international symposium on mathematical foundations of computer science , vol .",
    "7464 of lecture notes in comput .",
    "sci . , springer , 2012 , pp . 383394 .",
    "g.  fici , a classification of trapezoidal words , in : p.  ambro ,  .",
    "holub , z.  maskov ( eds . ) , words 2011 , 8th international conference on words , no .  63 in electronic proceedings in theoretical computer science , 2011 , pp . 129137 ."
  ],
  "abstract_text": [
    "<S> trapezoidal words are words having at most @xmath0 distinct factors of length @xmath1 for every @xmath2 . </S>",
    "<S> they therefore encompass finite sturmian words . </S>",
    "<S> we give combinatorial characterizations of trapezoidal words and exhibit a formula for their enumeration . </S>",
    "<S> we then separate trapezoidal words into two disjoint classes : open and closed . a trapezoidal word is closed if it has a factor that occurs only as a prefix and as a suffix ; otherwise it is open . </S>",
    "<S> we investigate open and closed trapezoidal words , in relation with their special factors . </S>",
    "<S> we prove that sturmian palindromes are closed trapezoidal words and that a closed trapezoidal word is a sturmian palindrome if and only if its longest repeated prefix is a palindrome . </S>",
    "<S> we also define a new class of words , _ semicentral words _ , and show that they are characterized by the property that they can be written as @xmath3 , for a central word @xmath4 and two different letters @xmath5 . </S>",
    "<S> finally , we investigate the prefixes of the fibonacci word with respect to the property of being open or closed trapezoidal words , and show that the sequence of open and closed prefixes of the fibonacci word follows the fibonacci sequence .    </S>",
    "<S> sturmian words , trapezoidal words , rich words , closed words , special factors , palindromes , enumerative formula . </S>"
  ]
}