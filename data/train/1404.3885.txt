{
  "article_text": [
    "[ [ optical - flow . ] ] optical flow .",
    "+ + + + + + + + + + + + +    optical flow is a powerful tool for detecting and analyzing motion in a sequence of images .",
    "the underlying idea is to depict the displacement of patterns in the image sequence as a vector field  the optical flow vector field  generating the corresponding displacement function .",
    "this framework has applications in a variety of areas connected to computer graphics and video analysis , e.g. in video compressing , video surveillance or vision - based robot navigation .",
    "[ [ variational - methods . ] ] variational methods .",
    "+ + + + + + + + + + + + + + + + + + + +    in their seminal article @xcite , horn and schunck proposed a _",
    "variational ansatz _ for the computation of the optical flow vector field . in this approach",
    "one minimizes an _ energy functional _ consisting of a _ similarity ( data ) term _ and a _ regularity term _ :",
    "@xmath0 here @xmath1 denotes an admissible space of vector fields , @xmath2 denotes the regularity term for the vector field @xmath3 , and @xmath4 denotes the similarity term , which depends on the image sequence @xmath5 under consideration .",
    "this method turned out to be particularly successful , as the resulting optical flow fields satisfy certain desirable properties governed by the choice of the regularization term @xmath6 .    in their article , horn and schunck",
    "considered the optical flow problem for a sequence of images defined on some domain in @xmath7 .",
    "they proposed to use the @xmath8-norm of the first derivative of the vector field @xmath3 as a regularization term .",
    "the _ wellposedness _ of this ansatz has been shown first by schnrr in @xcite .",
    "there they had to impose an additional assumption on the image sequence in order to ensure the coercivity of the functional @xmath9 ; this is mainly caused by the so called _ aperture problem _ , which results from the impossibility of detecting or discriminating certain types of motion in a very regular image .",
    "after the development of the horn ",
    "schunck functional , several extensions and improvements of the regularization term have been developed , see e.g. @xcite .",
    "a survey on variational techniques for optical flow can be found in @xcite . in the article @xcite , nagel proposed to add _ regularization in time _ via smoothing across image discontinuities . _ time smoothing of the flow field _",
    ", on the other hand , has been introduced by weickert and schnrr in @xcite , where the authors considered an additional term containing the time derivative of the vector field @xmath3 in the definition of the regularization functional .",
    "this alteration still yields a convex energy functional and thus the wellposedness of the optical flow problem can be proven employing similar methods as for the original horn  schunck functional . while these results have been derived for domains in @xmath7 , the situation of more general",
    " possibly curved  image domains has not been considered there . a first attempt in this direction",
    "can be found in @xcite , where the authors introduced the optical flow functional for images on the round sphere . finally , the case of an arbitrary compact two - dimensional manifold as image domain has been studied in @xcite .",
    "there the authors discuss the usage of the horn ",
    "schunck functional on a manifold and prove a similar wellposedness result as for the plane .",
    "[ [ time - varying - image - domains . ] ] time varying image domains .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + +    recently , kirisits , lang and scherzer have studied the optical flow problem on a time varying image domain  @xcite .",
    "the motivation for that was an application in volumetric microscopy , where one studies the early development of a zebra - fish embryo . in this setting , almost all movement between consecutive images takes place on the surface of the embryo s yolk cell , which , however , is time - dependent as well . in theory",
    ", it would be possible to use the complete volumetric data in order to compute a three - dimensional optical flow field . in practice",
    ", however , this is not viable because of the huge amount of data involved .",
    "instead , it makes sense to extract the moving surface in a first step and then to compute the flow field on this surface in a second , separate step .",
    "the main mathematical challenge at this point is the correct treatment of a vector field on a moving manifold @xmath10 , @xmath11 $ ] .",
    "we assume in this paper that this manifold is given by a family of parametrizations @xmath12 , where the configuration space @xmath13 is a fixed compact two - dimensional manifold ( possibily with boundary ) .",
    "the image sequence is defined on this moving manifold , and it is assumed that the structure of the manifold has an influence on the deformation of the image sequence .",
    "the difficulty is _ to capture the structure of the moving manifold in the optical flow field . _",
    "therefore , one has to develop a regularization term that depends on _ the induced , changing riemannian metric . _    at this point , we want to note that it would , in principle , be possible to use some fixed riemannian metric on @xmath13 in order to obtain a regularization term like in  @xcite",
    ". then one would lose , however , all the information about the correct manifold @xmath14 as well as its movement in space . in the experimental section we will compare this naive approach to our geometrical method and we will see that there is a significant difference in the resulting optical flow fields .    [ [ contributions - of - the - article . ] ] contributions of the article .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + +    one possibility of a regularization term capturing the structure of a moving manifold has already been given in  @xcite .",
    "in this article we propose a different one that is induced by a metric @xmath15 on the product manifold @xmath16\\times m$ ] .",
    "this metric @xmath15 is constructed in such a way that it incorporates all available information on the moving image domain : @xmath17 the constant @xmath18 is a weighting parameter and @xmath19 denotes the induced surface metric of the parametrization @xmath20 at time @xmath21 .",
    "given such a metric , we can use a weighted @xmath22-norm as regularization term : @xmath23 this regularization term is defined for vector fields @xmath24 on the product manifold @xmath25 .",
    "however , since we do not want to change the time parametrization , we will only consider vector fields with vanishing time component , cf .",
    "remark  [ rem : zeropartialt ] for a more detailed explanation of this choice .",
    "moreover , @xmath26 denotes the extension of the metric to @xmath27-@xmath27 tensor fields , @xmath28 denotes the covariant derivative of @xmath15 and @xmath29 is the corresponding volume form . note",
    "that this term enforces spatio - temporal regularity , as it contains derivatives in both time and space .",
    "the parameter @xmath30 that is included in the definition of the metric allows to penalize regularity in time and space separately .",
    "this choice for the regularization term is a natural geometric generalization of the regularization term on the static manifold @xmath31\\times { { \\mathbb{r}}}^2 $ ] from @xcite .",
    "if we decide to enforce no regularity in time , then the optical flow problem reduces for each time point @xmath32 to the optical flow problem on the static manifold @xmath33 . in this case",
    ", our regularization term equals the regularization term used in @xcite .",
    "the similarity term we use in this paper is simply the squared @xmath8-norm of the defect of the optical flow equation , that is , @xmath34 regarding the wellposedness of this optical flow problem we obtain the following result :    let @xmath10 be a moving two - dimensional compact surface , the movement of which is described by a family of parametrizations @xmath35 .",
    "for all parameters @xmath36 and any image sequence @xmath37 the optical flow functional @xmath38 has a unique minimizer in @xmath39    a similar result is also shown under the assumption of partial dirichlet boundary conditions .",
    "the @xmath8-norm in the regularization term is added to enforce the coercivity of the energy functional .",
    "we also discuss under which assumptions we can set the parameter @xmath40 to zero and still obtain a wellposedness result for our functional .",
    "we compare our functional to the functionals introduced by kirisits et al .",
    "@xcite and discuss the wellposedness of the optical flow problem using the regularization terms that are employed there .    finally , we demonstrate the functionality of our approach in a series of experiments using both synthetic and real data . in these experiments",
    "we also show the difference between our approach and the straightforward approach , that does not use the actual structure of the moving manifold . in both experiments",
    "one can see notably different results in regions of the manifold where either the curvature or the deformation of the manifold is large .",
    "another important topic is the strong dependence of the optical flow field on the parametrization of the moving manifold . in appendix",
    "[ ap : param ] we present a brief discussion on a possible approach to compute realistic parametrizations given an observed moving un ",
    ". the long term goal will be the combination of segmentation and computation of the optical flow , which we hope will lead to more reliable results .",
    "[ [ organization - of - the - article . ] ] organization of the article .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + +    in section  [ preliminaries ] we recall the differential geometric and functional analytic tools that we will use throughout the article .",
    "readers that are acquainted with the theory of sobolev spaces of vector fields on riemannian manifolds might skip this part and directly start with section  [ problemformulation ] which contains the rigorous mathematical formulation of the optical flow problem studied in this article .",
    "in section  [ regularization ] we construct the regularization term that we employ in this article , prove the wellposedness of the corresponding functional and derive the optimality conditions . up to this point all calculations and results are presented in a coordinate independent manner . in order to obtain an implementable version we derive in section",
    "[ coordinates ] a coordinate version of the optimality conditions .",
    "this involves rather technical calculations , that are partly postponed to the appendix . in section  [ experiments ]",
    "we show numerical experiments that demonstrate the functionality of the proposed energy functional .",
    "the appendix contains a discussion on how to compute the parametrization of the moving manifold and the actual calculations of the coordinate version of the optimality conditions .",
    "[ [ acknowledgements . ] ] acknowledgements .",
    "+ + + + + + + + + + + + + + + + +    we thank pia aanstad from the university of innsbruck for kindly providing the microscopy data used in this article .",
    "we are grateful for helpful comments and discussions to lukas lang , peter michor and otmar scherzer .",
    "martin bauer was supported by fwf project p24625 and clemens kirisits was supported by the vienna graduate school in computational science ( ik i059-n ) and fwf project s10505-n20 .",
    "finally we want to thank the referees for their careful proofreading and their valuable comments .",
    "in this section we are going to recall the differential geometric and functional analytic tools for sobolev spaces of vector fields on @xmath41-dimensional embedded surfaces , which we will need throughout the article .",
    "a more detailed overview on these topics can be found e.g.  in ( * ? ? ?",
    "* sect .  3 ) .",
    "[ [ riemannian - geometry . ] ] riemannian geometry .",
    "+ + + + + + + + + + + + + + + + + + + +    we are working on @xmath41-dimensional surfaces that are embedded in @xmath42 and parametrized by a mapping @xmath43 from some _ configuration space _ @xmath13 into @xmath42 .",
    "we will always assume that @xmath13 is a compact @xmath41-dimensional manifold , possibly with boundary ; typical examples are the @xmath41-dimensional sphere @xmath44 or the torus @xmath45 .",
    "the mapping @xmath20 is assumed to be smooth ( that is , at least @xmath46 ) and injective with injective tangential mapping @xmath47 ( in other words , @xmath20 is a smooth embedding ) .",
    "the embedding @xmath20 induces in a natural way via pullback a riemannian metric @xmath48 on the configuration space @xmath13 . for tangent vectors",
    "@xmath49 , @xmath50 , @xmath51 , it is given by @xmath52 here @xmath53 denotes the standard scalar product on @xmath42 and @xmath54 denotes the application of the differential @xmath55 of the embedding @xmath20 to the tangent vector @xmath56 .    in a chart @xmath57 on @xmath13 the expression of the metric reads as @xmath58 with @xmath59 .",
    "next we note that the metric induces an isomorphism between the tangent bundle and the cotangent bundle @xmath60 with inverse @xmath61 .",
    "therefore @xmath48 defines a metric on the cotangent bundle @xmath62 via @xmath63 in this article we will need the extension of the metric to @xmath27-@xmath27 tensor fields .",
    "the reason for this is , that this type of tensor field occurs as derivative of a vector field on @xmath13 , which will be a part of our regularization term . on these tensor fields",
    "the metric is given by @xmath64    applied to a @xmath27-@xmath27 tensor field @xmath65 this equals the squared hilbert schmidt norm of @xmath65 : @xmath66 where the adjoint @xmath67 is computed with respect to the riemannian metric @xmath48 .",
    "here we have interpreted @xmath65 as a linear mapping from @xmath68 to @xmath68 .",
    "[ [ sobolev - spaces - of - vector - fields . ] ] sobolev spaces of vector fields .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    the riemannian metric @xmath48 on @xmath13 induces a unique volume density , which we will denote by @xmath69 . in the chart",
    "@xmath57 its formula reads as @xmath70    the levi  civita covariant derivative of the metric @xmath48 , which is the unique torsion - free connection preserving the metric @xmath48 , will be denoted by @xmath71 . when it is clear from the context , we omit the @xmath48 and simply write @xmath72 instead of @xmath71 .",
    "note that @xmath71 is just the tangential component of the usual derivative in the ambient space @xmath73 , more precisely , for a vector field @xmath74",
    "@xmath75    we define the sobolev norms of orders zero and one by @xmath76    the sobolev space @xmath77 is then defined as the completion of the space of all vector fields @xmath78 with respect to the norm @xmath79 . on a compact manifold",
    "different metrics yield equivalent norms and thus lead to the same sobolev spaces .",
    "we note that , as for sobolev spaces in @xmath80 , there is an alternative , equivalent definition of @xmath77 as the space of all square integrable vector fields with square integrable weak derivatives .",
    "for the definition of more general sobolev space on manifolds we refer to @xcite ; see also @xcite for an exposition in a similar notation as it is used in this article .",
    "an extension of this theory to non - compact manifolds can be found in the book @xcite .",
    "we assume that we are given a moving two - dimensional compact surface @xmath10 , @xmath11 $ ] the movement of which is described by a family of parametrizations @xmath20 . for the moment",
    ", we will restrict ourselves to compact surfaces without boundary , but we will discuss the situation of manifolds with boundary later .",
    "more precisely , we assume that there exists a two - dimensional compact @xmath46-manifold @xmath13 and a @xmath46-mapping @xmath81 \\times m \\to { { \\mathbb{r}}}^3\\ ] ] such that for every fixed time @xmath11 $ ] the mapping @xmath82 is an embedding and its image equals @xmath14 .",
    "the mapping @xmath20 defines the movement of the manifold in the sense that the path of a point @xmath83 is precisely the curve @xmath84 . or",
    ", a point @xmath85 corresponds to a point @xmath86 if and only if there exists @xmath51 with @xmath87 and @xmath88 .",
    "next we model the movement of an image on this moving surface . for simplicity we will only consider grey - scale images , although the model does not change significantly if we also allow color , that is , vector valued , images .",
    "we stress that in our model the movement of the image is not solely driven by the movement of the surface , but that there is also an additional movement on the surface , the reconstruction of which is precisely what we are aiming for .",
    "the image sequence we are considering is given by a real valued function @xmath89 on @xmath90 \\times { { \\mathbb{r}}}^3\\,;\\ ] ] for each @xmath91 $ ] , the function @xmath92 is the image at the time @xmath21 .",
    "moreover , there exists a family of diffeomorphisms @xmath93 such that @xmath94 that is , the diffeomorphisms @xmath95 generate the movement of the image on the evolving surface .",
    "next , it is possible to pull back the image and the driving family of diffeomorphisms to the configuration space @xmath13 .",
    "doing so , we obtain a time dependent function @xmath96\\times m \\to { { \\mathbb{r}}}$ ] defined by @xmath97 and a family of diffeomorphisms @xmath98 of @xmath13 defined by @xmath99 such that @xmath100 for all @xmath91 $ ] and @xmath51 .",
    "furthermore we assume that the diffeomorphisms @xmath98 are generated by a time dependent vector field @xmath3 on @xmath13 . then the curves @xmath101 are precisely the integral curves of @xmath3 , that is , @xmath102 if the image @xmath103 is sufficiently smooth",
    ", it is possible to compute the time derivative of equation  . using the relation   and the fact that @xmath98 is surjective",
    ", we then see that the image @xmath103 and the vector field @xmath3 satisfy the _ optical flow equation _",
    "@xmath104 on @xmath31 \\times m$ ] . we do note that in the equation   all information about the movement of the manifold is suppressed , as all the functions have been pulled back to @xmath13 .",
    "it is , however , possible to re - introduce some knowledge of @xmath105 by formulating the optical flow equation not in terms of differentials but rather in terms of gradients . to that end",
    "we denote by @xmath48 the time dependent riemannian metric on @xmath13 that is induced by the family of embeddings @xmath82 .",
    "since by definition @xmath106 , we can rewrite the optical flow equation as @xmath107 for all @xmath108 \\times m$ ] .",
    "now assume that the model manifold @xmath13 is a compact manifold with boundary .",
    "then the same model of a moving image on the embedded manifolds @xmath14 is possible , as long as it is guaranteed that the boundary of the manifold acts as a barrier for the movement of @xmath89 .",
    "that is , the diffeomorphisms @xmath98 satisfy the additional boundary condition @xmath109 for @xmath110 . in this case , one arrives at the same optical flow equation  , but , additionally , one obtains ( partial ) dirichlet boundary conditions of the form @xmath111 for all @xmath108 \\times \\partial m$ ] .",
    "the situation is different , when the image @xmath89 actually moves across the boundary of @xmath14 , which can occur if the manifold with boundary @xmath14 represents the limited field of view on a larger manifold that contains the moving image .",
    "then it is not reasonable to model the movement of the image by a family of global diffeomorphism @xmath95 .",
    "however , locally it can still be modeled as being generated by a family of local diffeomorphisms , which in turn can be assumed to be generated by a time dependent vector field on @xmath13 . with this approach ,",
    "one arrives , again , at the same optical flow equation  .",
    "the difference to the situations discussed above is that the integral curves of @xmath3 may be defined only on bounded intervals .",
    "[ [ the - inverse - problem . ] ] the inverse problem .",
    "+ + + + + + + + + + + + + + + + + + + +    now we consider the inverse problem of reconstructing the _ movement _ of a family of images from the image sequence .",
    "we assume that we are given the family of manifolds @xmath14 together with the parametrizations @xmath82 and the family of images @xmath112 ( already pulled back to @xmath13 ) .",
    "our task is to find a time dependent vector field @xmath3 on @xmath13 that generates the movement of @xmath103 ; in other words , a vector field @xmath3 that satisfies the optical flow equation  .    solving this equation directly is not sensible , as , in general , the solution , if it exists , will not be unique : the optical flow equation does not `` see '' a flow that is tangential to the level lines of the image @xmath103 .",
    "thus , if @xmath3 is any solution of   and the vector field @xmath113 satisfies @xmath114 then also @xmath115 is a solution ; this is called the _ aperture problem _ ( see  @xcite ) . in addition",
    ", the whole model fails in the case of noise leading to non - differentiable data @xmath103 . in order to be still able to formulate the optical flow equation , it is possible to pre - smooth the image @xmath103 , but this will invariably lead to errors in the model and thus the optical flow equation will only be satisfied approximately by the generating vector field @xmath3 . for these reasons , it is necessary to introduce some kind of regularization .",
    "note that the main focus lies here in the problem of solution selection .",
    "one of the most straightforward regularization methods is the application of tikhonov regularization , where we try to minimize a functional composed of two terms , a similarity term , which ensures that the equation is almost satisfied , and a regularity term , which ensures the existence of a regularized solution and is responsible for the solution selection .",
    "if we consider only spatial regularity , the definition of the regularity term is straightforward , using for each time point @xmath21 the pullback metric @xmath116 this leads to the energy functional @xmath117 here @xmath40 and @xmath118 are weighting parameters . in this case",
    "the problem completely decouples in space and time , i.e. , the optimal vector field @xmath3 has to be minimal for each time point separately .",
    "thus the problem reduces for each time @xmath21 to the calculation of the optical flow on the ( static ) riemannian manifold @xmath119 , which yields for each time point @xmath21 the energy functional @xmath120 this functional is well investigated . for @xmath121 the coercivity of the energy",
    "functional is clear and one can easily deduce the well - posedness of the optical flow problem . in @xcite",
    "it was shown that one can guarantee the coercivity of the energy functional for @xmath122 by requiring the image sequence to satisfy additional conditions .",
    "the conditions in  @xcite for optical flow in the plane require that the partial derivatives of the image @xmath103 are linearly independent functions .",
    "this is equivalent to the requirement that no non - trivial constant vector field @xmath3 satisfies the optical flow equation for the given image .",
    "similar requirements are commonly found for tikhonov regularization with derivative based regularization terms , see e.g.  @xcite and  ( * ? ? ?",
    "* section  3.4 ) . in the case of a non - flat manifold @xmath13",
    ", the condition translates to the non - existence of a non - trivial covariantly constant vector field satisfying the optical flow equation . obviously , this condition is automatically satisfied , if the only covariantly constant vector field is @xmath123 , and thus it may be omitted in manifold settings , see  @xcite .      in the following",
    "we will look for solutions that additionally satisfy a regularity constraint in time @xmath21 .",
    "for the optical flow in the plane @xmath7 , this method has been introduced in  @xcite .",
    "spatio - temporal regularization of the optical flow on moving manifolds , has also been considered in  @xcite , but with a different regularity term than the one we will construct in the following .    in order to construct the regularity term",
    ", we consider the product manifold @xmath124\\times m\\ ] ] and equip it with the almost product metric @xmath17 the parameter @xmath18 is a weighting parameter , which is included in order to be able to penalize spatial regularity and regularity in the time variable differently .",
    "this metric is called almost product metric due to the dependence of the metric @xmath125 on the time @xmath21 . in order to simplify notation",
    "we denote @xmath126 by @xmath28 from now on .    in the following",
    ", we will always indicate by a `` bar '' ( @xmath127 ) that an object is related to the product manifold @xmath25 .",
    "for instance , @xmath128 denotes a metric on @xmath25 , whereas @xmath48 denotes a ( time dependent ) metric on @xmath13 .",
    "similarly , @xmath24 will later denote a vector field on @xmath25 , whereas @xmath3 will denote a time dependent vector field on @xmath13 .",
    "we could also consider @xmath105 as an embedded submanifold of @xmath129 : @xmath130\\times m&\\to & { { \\mathbb{r}}}\\times { { \\mathbb{r}}}^3 \\ , , \\\\ ( t , x)&\\mapsto&(t , f(t , x))\\ , . \\end{array } \\right.\\ ] ] we stress here that the metric @xmath128 is _ not _ the pullback of the ( time scaled ) euclidean metric on @xmath105 by the parametrization @xmath131 .",
    "instead , it is constructed in such a way that the paths of the points on @xmath13 are at each time @xmath21 orthogonal to the manifold @xmath14 . moreover , these paths are geodesics with respect to @xmath128 .",
    "these properties do , in general , not hold for the usual pullback metric .",
    "from now on we will identify a time dependent vector field @xmath3 on @xmath13 with the vector field @xmath132 and define both the similarity term and the regularization term in terms of @xmath24 . taking the squared @xmath8-norm with respect to the metric @xmath15 of the right hand side of the optical flow equation we obtain for the similarity term the functional @xmath133 here we used the fact that the volume form on @xmath25 splits into @xmath134 .",
    "for the regularization term we use a weighted @xmath22-norm of the vector field @xmath24 , that is , @xmath135 where @xmath40 and @xmath118 are weighting parameters . in",
    ", the term @xmath136 denotes the @xmath8-norm of the vector field @xmath24 and @xmath137 denotes the norm of its derivative with respect to the riemannian metric @xmath15 , that is , @xmath138    to summarize , we propose to solve the optical flow problem on a moving manifold by minimizing the energy functional @xmath139 which is defined on @xmath140    note that the regularization term depends implicitly on the parameter @xmath30 as well .",
    "however , a large value of @xmath30 leads to less time regularity , which is in contrast to the influence of the parameters @xmath40 and @xmath118 .",
    "formally , the limit @xmath141 corresponds to no time regularization at all .",
    "[ rem : kirlansch ] we stress the difference between the regularization term proposed in this article and the one from @xcite , which is given by @xmath142 even though the latter functional is also a natural generalization of @xcite  from an embedded point of view  , there is no obvious metric on @xmath143 for which it is a weighted homogeneous @xmath22-norm .    in the case",
    "@xmath144 , where @xmath6 is the homogeneous sobolev semi - norm , only variations of the movement on the manifold are penalized but not the overall speed of the movement .",
    "in contrast , a positive value of @xmath40 encourages a low speed , which may lead to a systematic underestimation of the magnitude of the computed flow . for this reason the choice @xmath144 is usually preferable .",
    "note , however , that one of the basic assumptions in our model is that most of the movement of the image is driven by the movement of the manifold .",
    "thus , using a positive value of @xmath40 can be justified and is somehow natural provided that this assumption holds .",
    "in addition , the actual numerical computation of the flow field is easier for @xmath145 because the condition of the resulting linear equation becomes better with increasing @xmath40 .",
    "still , we have used the parameter choice @xmath144 for our numerical experiments later in the paper .",
    "[ rem : zeropartialt ] it is also possible to identify the non - autonomous vector field @xmath3 on @xmath13 with the vector field @xmath146 on @xmath25 , which incorporates the movement of the image both in time and space .",
    "if one does so , however , one has to be careful about the regularity term . simply using the squared ( weighted ) @xmath22-norm of @xmath147 has the undesirable effect that the natural movement of the manifold , which is given by the vector field @xmath148 , need not be of minimal energy for the regularization term :",
    "the vector field @xmath149 is in general not covariantly constant . instead of the norm of the vector field @xmath147 itself",
    "one should therefore penalize the norm of the difference between @xmath147 and @xmath149 .",
    "doing so , one arrives at the same regularization term   as above , although the interpretation is slightly different .",
    "the proof of the wellposedness of our model , that is , the question whether the proposed energy functional @xmath150 attains a unique minimizer in @xmath151 , is quite straightforward . in the following result ,",
    "we denote by @xmath152 the space of functions on @xmath25 with an essentially bounded weak derivative .",
    "assume that @xmath153 and that @xmath37 .",
    "then the functional @xmath154 defined in   has a unique minimizer in @xmath151 .",
    "we will see in sect .",
    "[ optimality_cond ] that this optimization problem is in a natural way connected to neumann boundary conditions .",
    "if we want to consider mixed boundary conditions instead  dirichlet in space and neumann in time  we have to restrict the domain of the energy functional to @xmath155\\times \\partial m\\}.\\end{aligned}\\ ] ] the wellposedness result remains valid on @xmath156 .",
    "the condition @xmath157 guarantees that the similarity term @xmath158 is finite for every square integrable vector field on @xmath25 ; in particular it is proper . from the condition",
    "@xmath145 we obtain that the regularization term @xmath6 and therefore also the energy functional @xmath150 is coercive .",
    "thus @xmath150 is a proper and coercive , quadratic functional on the hilbert space @xmath151 , which implies the existence of a unique minimizer ( cf .",
    "( * ? ? ? * section  3.4 ) or  @xcite ) .",
    "[ re : coercivity ] the condition @xmath145 is not necessary if there is another way of guaranteeing the coercivity of the regularization term .",
    "this is for instance possible , if there exists no non - trivial covariantly constant vector field of the form @xmath159 on @xmath25 .",
    "in that case , the homogeneous sobolev semi - norm @xmath160 is in fact a norm on @xmath151 that is equivalent to the standard sobolev norm , and therefore also the parameter choice @xmath144 guarantees the coercivity of @xmath150 .",
    "note that this condition is independent of the moving image @xmath103 .",
    "more generally , even if there are non - trivial , admissible , covariantly constant vector fields on @xmath25 , the energy function will be still coercive for @xmath144 , as long as no such vector field satisfies the optical flow equation @xmath161 .",
    "note , however , that the numerical computation of a minimizer may become difficult , because the problem , though still wellposed , may become ill - conditioned as the parameter @xmath40 approaches zero .    with a similar argumentation one can show that the functionals proposed in  @xcite are wellposed provided they are coercive , compare remark [ rem : kirlansch ] .",
    "because there all the regularization terms penalize only the derivative of the vector field @xmath3 but not its size , the coercivity will only hold if one of the conditions in remark  [ re : coercivity ] is satisfied .      [",
    "th : gradient ] the @xmath8 gradient of the optical flow energy functional @xmath9 is given by @xmath162    * for @xmath9 seen as functional on @xmath163 its domain of definition is the set of all vector fields @xmath164 satisfying neumann boundary conditions , i.e. , @xmath165 where @xmath166 denotes the normal to the boundary of @xmath143 with respect to @xmath128 . * for @xmath9 restricted to @xmath167 its domain of definition is the set of all vector fields @xmath168 satisfying mixed boundary conditions , more precisely , @xmath169 note here that on @xmath170 the normal vector @xmath166 is given by @xmath171 .    here",
    "@xmath172 denotes the bochner laplacian of @xmath15 , which is defined via @xmath173 with @xmath174 denoting the @xmath8-adjoint of the covariant derivative .",
    "the bochner laplacian differs only by a sign from the usual laplace beltrami operator .",
    "we calculate the gradients for the two terms separately . using a variation @xmath175",
    "we obtain the following expression for the variation of the similarity term : @xmath176 from this equation one can easily read off the @xmath8 gradient of the similarity term .",
    "it reads as @xmath177 the variation of the regularization term is given by @xmath178 the second step consists of a partial integration using the @xmath8 adjoint of the covariant derivative , which we denote by @xmath174 .",
    "the last two term in the above expression are the boundary term that results from the partial integration . from this",
    "we can read off the formula for the gradient of the regularization term .",
    "taking into account that the outer normal vector to the boundary of @xmath170 is given by @xmath171 this concludes the proof on @xmath163 .",
    "for @xmath167 the situation is simpler , since the first boundary integral is already zero if @xmath179 .    because of the strict convexity of the energy functional @xmath150 , a vector field @xmath24 is a minimizer if and only if it is an element of @xmath180 and @xmath181 .",
    "thus we obtain the following result :    the minimizer of the energy functional @xmath150 on @xmath163 defined in   is the unique solution @xmath182 of the equation @xmath183 \\times \\partial m \\\\    \\bar \\nabla_{\\partial_t}\\bar u & = 0   & & \\text { in } \\{0,t\\}\\times m.    \\end{aligned}\\ ] ] if we restrict the energy functional to @xmath167 it is the unique solution of @xmath184 \\times \\partial m.    \\end{aligned}\\ ] ]",
    "the aim of this section is to express the previously derived optimality conditions in a local coordinate chart in order to obtain an implementable version of the previous sections . to simplify the exposition",
    ", we will restrict ourselves to the case of mixed boundary conditions .",
    "note that this includes in particular the situation where @xmath13 is a compact manifold without boundary .",
    "let @xmath57 be a local chart on @xmath13 with coordinate frame @xmath185 , @xmath186 . in the following we will use the einstein summation convention in order to simplify the notation .",
    "the main computational difficulty is the computation of the bochner laplacian @xmath187 , as it involves the adjoint of the covariant derivative .",
    "this is most easily done in an orthonormal frame with respect to the metric @xmath128 .",
    "we stress here that the natural frame @xmath188 is in general not orthonormal , because @xmath189 will be different from 0 .",
    "note , however , that the construction of the metric implies that @xmath190 for @xmath191 . we can therefore obtain an orthonormal frame by scaling the vector @xmath192 to unit length and , for instance , applying the gram ",
    "schmidt orthogonalization process to the ( time and space dependent ) vectors @xmath185 , @xmath186 . doing so , we obtain an orthonormal frame of the form @xmath193 with space dependent vector fields @xmath194 and @xmath195 on @xmath196 .",
    "the ( time and space dependent ) coordinate change matrix between these two bases will be denoted by @xmath197 ; we have @xmath198 note that the coefficient function @xmath199 will be the constant 0 if the gram  schmidt process is used for orthogonalization .    in the orthonormal frame @xmath200 , the norm of @xmath201",
    "can be written as @xmath202 where @xmath203 denotes the covariant derivative of the vector field @xmath24 along @xmath204 .",
    "writing @xmath24 as @xmath205 , the covariant derivative can be computed as @xmath206 where @xmath207 are the _ connection coefficients_. these are defined by the equations @xmath208    in order to actually compute the connection coefficients , we use the fact that they are related to the christoffel symbols @xmath209 of @xmath128 with respect to @xmath188 via @xmath210 finally , the christoffel symbols are defined as @xmath211 where @xmath212 denote the coefficients of the metric @xmath128 with respect to @xmath188 , and @xmath213 denotes the partial derivatives of the coefficients of the inverse metric @xmath214 .    applying these definitions to our special situation",
    ", we arrive at the following explicit formula for the optimality conditions in local coordinates :    [ th : opt_coord ] in the chart @xmath57 , the unique minimizer @xmath215 of the energy functional @xmath150 defined in   solves the equation @xmath216 where @xmath217 and @xmath218 is the @xmath219-component of @xmath220 .",
    "the connection coefficients @xmath207 of @xmath221 are given by @xmath222    moreover , the christoffel symbols @xmath223 have the form @xmath224    the derivations of this equation and of the coordinate expression of the connection symbols and the christoffel symbols are postponed to the appendix .",
    "[ [ numerical - implementation . ] ] numerical implementation .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + +    we illustrate the behaviour of the proposed model in two experiments . in both of them",
    "the moving surface @xmath225 is parametrized globally by a function @xmath226 \\times m \\to \\mathbb{r}^3 $ ] , where @xmath227 is a rectangular domain .",
    "note that , due to the chosen images , we can always set @xmath144 and still have wellposedness , cf .",
    "remark  [ re : coercivity ] .",
    "we also conducted experiments with a positive value of @xmath40 , which yielded faster convergence of the numerical method .",
    "the main difference to the results with @xmath122 were shortened flow fields .",
    "we solve the optimality conditions from thm .",
    "[ th : opt_coord ] with finite differences on a @xmath228 grid approximation of @xmath143 .",
    "derivatives in all three directions are approximated by central differences and the resulting sparse linear system is solved with the standard matlab implementation of the generalized minimal residual method ( gmres ) .",
    "+     +    [ [ experiment - i - synthetic - data . ]",
    "] experiment i , synthetic data . + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    the first image sequence we apply our model to are @xmath229 frames of the well known hamburg taxi sequence , scaled to the unit interval . the sequence has a resolution of @xmath230 , which leads to a total number of @xmath231 grid points .    the surface we consider is a ring torus whose major circle turns into an ellipse while its tube of uniform thickness grows ripples over time .",
    "the corresponding embedding reads @xmath232 where @xmath233 , @xmath234 , and @xmath235 . in fig .",
    "[ fig : e2data ] we show @xmath103 , @xmath14 and @xmath89 .    in figs .",
    "[ fig : e2arrows ] and [ fig : e2colors ] results for the parameter choice @xmath236 and @xmath122 are depicted .",
    "the finite difference step size @xmath237 was set to @xmath27 for all three directions .",
    "the gmres algorithm was terminated after a maximum of @xmath238 iterations with a restart every @xmath239 iterations .",
    "this led to a relative residual of @xmath240 . in fig .",
    "[ fig : e2colors ] we use the color coding from @xcite to visualize the optical flow .",
    "this is done by applying it to the pulled back vector field first , and drawing the resulting color image onto @xmath14 via @xmath20 afterwards .",
    "finally , we illustrate how the moving surface influences the optical flow vector field . to that end",
    "we repeat experiment i on the flat torus with all parameters unchanged .",
    "that is , we compute the optical flow from the hamburg taxi sequence according to the model of weickert and schnrr @xcite only with periodic boundary conditions . in fig .",
    "[ fig : e2comparison1 ] we juxtapose the resulting vector field with the optical flow computed on the deforming torus .",
    "a common measure for comparing two optical flow vector fields @xmath3 and @xmath241 is the angular error @xmath242 see @xcite for example . the main purpose of adding the additional component @xmath27 to both vectors is to avoid division by zero . extending the above definition in a straightforward way to vector fields in @xmath243 we show in fig .",
    "[ fig : e2angerr ] the angular error between the optical flow computed on the deforming and flat torus , respectively , both before and after pushforward to the deforming torus .",
    "note that two unit vectors @xmath244 standing at an angle of @xmath245 would have an angular error of approximately @xmath246 .",
    "another common measure is the so - called endpoint error @xmath247 , which also takes into account the lengths of the vectors .",
    "however , since vector lengths are typically affected by the choice of regularization parameters and finding comparable values for the flat and deforming torus is not straightforward , we chose not to visualize the endpoint error .",
    "angular error between the pulled back vector fields .",
    "right : @xmath243 angular error between the pushed forward vector fields . ]",
    "+     +    [ [ experiment - ii - microscopy - data . ] ] experiment ii , microscopy data . + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    finally , we test our model on real - world data .",
    "the image sequence under consideration in this section depicts a living zebrafish embryo during the gastrula period and has been recorded with a confocal laser - scanning microscope .",
    "the only visible feature in this dataset are the embryo s endodermal cells which , expressing a green fluorescent protein , proliferate on the surface of the embryo s yolk .",
    "understanding and reconstructing cell motion during embryogenesis is a major topic in developmental biology and optical flow is one way to automatically extract this information @xcite .",
    "see @xcite for a detailed account on the embryonic development of a zebrafish , and @xcite for more information on laser - scanning microscopy and fluorescent protein technology .",
    "the considered data do not depict the whole embryo but only a cuboid section of approximately @xmath248 .",
    "they have a spatial resolution of @xmath249 voxels and the elapsed time between two consecutive frames is about four minutes . as in @xcite",
    "we avoid computational challenges by exploiting the fact that during gastrulation endodermal cells form a monolayer .",
    "this means they can be regarded as sitting on a two - dimensional surface .",
    "therefore , by fitting a surface through the cells positions , we can reduce the spatial dimension of the data by one .",
    "we refer to @xcite on how this surface extraction was done .",
    "in this particular experiment we apply our model to @xmath250 frames of the resulting 2d cell images with a resolution of @xmath251 and again scaled to the unit interval .",
    "the extracted surface can be conveniently parametrized as the graph of a function @xmath252 describing the height of the surface .",
    "that is , @xmath20 takes the form @xmath253 in fig .",
    "[ fig : e3data ] we show @xmath103 , @xmath14 and @xmath89 .",
    "the regularization parameters were set to @xmath254 , @xmath144 , @xmath255 and for the spatial boundaries we chose homogeneous dirichlet boundary conditions .",
    "the gmres solver converged faster this time and was terminated after the relative residual dropped below @xmath256 .",
    "results are shown in fig .",
    "[ fig : e3colors ] . in fig .",
    "[ fig : e3comparison1 ] we juxtapose the pulled back optical flow with the optical flow computed in the plane with the same parameters .",
    "finally , we again compare the two vector fields by computing their angular error .",
    "this time we do so after push forward only , since for real - world data we are primarily interested in the vector field on the embedded surface .",
    "choosing a suitable regularization term is a major challenge in the computation of the optical flow on a moving manifold when using variational methods .",
    "the main question is how to incorporate the structure of the manifold and of its movement into the regularization . in this paper",
    "we have approached this problem from a purely differential geometric point of view .",
    "we have constructed a riemannian metric on the time - dependent manifold in such a way that the paths of points on the manifold are geodesics with respect to this metric .",
    "we have then used a horn  schunck type quadratic regularization term with additional time smoothing for the computation of the optical flow .",
    "the experiments performed within this setting indicate the viability of this approach and also show that using the manifold structure can have a significant influence on the computed optical flow field .",
    "still , because of the usage of a quadratic regularization term that is not adapted to the image structure , the resulting flow fields tend to be oversmoothed .",
    "the next step is therefore the extension to more complicated , anisotropic regularization terms as discussed in  @xcite , which may be more accurate for certain applications of optical flow .",
    "so far we have assumed , that we are given the moving surface with a fixed parametrization . in applications",
    "this parametrization might be unknown , i.e. , one might only observe the shape of the surface , but not its actual parametrization .",
    "thus one will need to extract the parametrization from the observed data .",
    "in this part we will briefly sketch a possible approach to achieve this goal .",
    "note that the choice of parametrization will have a tremendous influence on the resulting optical flow field .",
    "in particular one can choose a parametrization , such that the optical flow field is almost zero . to achieve",
    "this one can take any fixed parametrization @xmath82 and solve the optical flow problem for this parametrization using small regularization parameters .",
    "then one can use the resulting optical flow field @xmath241 to generate a path of diffeomorphisms @xmath257",
    ". then the path @xmath258 has the desired property .    in the following",
    "we will assume that the evolution of the image has no influence on the evolution of the surface ",
    "the influence of the surface evolution on the image evolution is taken into account by the nature of the regularization term .",
    "furthermore we assume that we are given only the shape of the surface at each timepoint @xmath21 , but not the actual parametrization , i.e. , that we are given a path in the space of unparametrized , embedded surfaces ; see @xcite for a rigorous mathematical definiton of this infinite dimensional manifold .    at each time point",
    "@xmath21 we can now choose any parametrization of the surfaces yielding a path of embeddings @xmath259\\times m\\mapsto \\mathbb r^3.\\ ] ] thus we have reduced the problem to finding the path of reparametrizations that best corresponds to the observed shape evolution .    one way to tackle",
    "this problem is to define an energy functional on the space of embeddings that incorporates the available information on realistic shape evolutions . in order to be independent of the initial parametrization of the path of surfaces",
    "we require that the energy functional is invariant under the action of the diffeomorphism group , i.e. , @xmath260 , for all @xmath261 . in this case",
    ", the energy functional on the space of parametrized surfaces induces an energy functional on the shape space of unparametrized surfaces .",
    "such a functional can be defined using a riemannian metric , a finsler type metric , or by some even more general lagrangian , see e.g. @xcite .    for the sake of simplicity",
    ", we will focus on the riemannian case only , i.e. , @xmath262 where @xmath263 is some reparametrization invariant metric on the manifold of all embeddings .    for historical reasons going back to euler  @xcite ,",
    "these metrics are often represented via the corresponding inertia operator @xmath264 : @xmath265 the simplest such metric is the reparametrization invariant @xmath8-metric  or @xmath266metric .",
    "this metric is induced by the operator @xmath267 : @xmath268 in order to guarantee that the bilinear form @xmath269 really induces a riemannian metric , we require @xmath264 to be an elliptic pseudo - differential operator , that is symmetric and positive with respect to the @xmath8-metric .",
    "in addition we assume that @xmath264 is invariant under the action of the reparametrization group @xmath270 .",
    "the invariance of @xmath264 implies that the induced metric @xmath269 is invariant under the action of @xmath270 as required .",
    "using the operator @xmath264 , one can include physical or biological model - parameters in the definition of the metric .",
    "now we want to find the optimal reparametrization of the initial path @xmath20 with respect to this energy functional .",
    "therefore we have to solve the optimization problem : @xmath271,\\operatorname{diff}(m))}{\\operatorname{argmin } } e(f(t,\\varphi(t , x)).\\ ] ] further expanding the energy functional using the invariance of the riemannian metric yields : @xmath272    as an example we want to consider this functional for the @xmath8-metric . therefore we decompose @xmath273 for each time point @xmath21 into a part that is normal to the surface @xmath20 and a part that is tangential : @xmath274 since these parts are orthogonal to each other  w.r.t . the @xmath8metric  the energy functional reads as @xmath275 this functional is minimal for @xmath276 this however corresponds to a reparametrization @xmath277 such that @xmath278 consists only of a deformation in normal direction .    for a more general metric @xmath269 this will not hold anymore , since normal and tangential vector fields might not be orthogonal with respect to the @xmath269metric .",
    "instead one can show that for the optimal path @xmath279 we will have that @xmath280 is normal , cf .",
    "in the following we give a sketch of the derivation of the formulas in theorem  [ th : opt_coord ] .",
    "this is a straight forward computation using the definition of the christoffel symbols as @xmath281 and the fact that the metric @xmath128 and its inverse have the forms @xmath282 respectively , and @xmath283      the connection coefficients @xmath207 are defined as @xmath210 moreover , the coordinates @xmath284 have the form @xmath285 using these facts and the form of the christoffel symbols derived in  , the result follows from a straight forward calculation .",
    "as shown in theorem  [ th : gradient ] , the gradient of @xmath286 has the form @xmath289 denote now by @xmath290 the coordinates of @xmath3 with respect to @xmath291 , that is , @xmath292 .",
    "then @xmath293 moreover we have @xmath294 moreover , the coordinate expression of @xmath295 is @xmath296",
    ". therefore we obtain @xmath297 since @xmath298 , we obtained the claimed representation .",
    "[ le : bl1 ] in the local coordinate frame @xmath299 the bochner laplacian on the riemannian manifold @xmath300 of a vector field @xmath301 satisfying neumann boundary conditions @xmath302 is given by @xmath303    to calculate the expression of the laplacian we have to compute the formula for the @xmath8-adjoint of the covariant derivative . taking two vector fields",
    "@xmath301 , @xmath304 we have @xmath305 using @xmath306 we obtain the following expression for the first summand ( @xmath307 ) : @xmath308 using the variational formula ( * ? ? ?",
    "* section 4.6 ) @xmath309 yields @xmath310 note that for neumann boundary conditions the first term in the above expression vanishes .",
    "next , we will derive an explicit representation of the bochner laplacian in coordinates . to that end",
    ", we treat the two terms in   separately . for the second term we note that @xmath313 and thus we obtain @xmath314 moreover , we obtain from   that @xmath315 hence , the first term becomes @xmath316      combining lemma  [ le : sim_grad ] , equations   and  , and the fact that the gradient of @xmath318 is simply @xmath319 , we arrive , after dividing everything by two , at  ; equations   are simply the neumann boundary conditions in coordinate form .",
    "a.  imiya , h.  sugaya , a.  torii , and y.  mochizuki .",
    "variational analysis of spherical images . in a.",
    "gagalowicz and w.  philips , editors , _ computer analysis of images and patterns _ , volume 3691 of _ lecture notes in computer science _ ,",
    "pages 104111 .",
    "springer berlin , heidelberg , 2005 .",
    "i.  h. jermyn , s.  kurtek , e.  klassen , and a.  srivastava . .",
    "in _ proceedings of the 12th european conference on computer vision - volume part v _ , eccv12 , pages 804817 , berlin , heidelberg , 2012 .",
    "springer - verlag .      c.  kirisits , l.  f. lang , and o.  scherzer .",
    "optical flow on evolving surfaces with an application to the analysis of 4d microscopy data . in a.",
    "kuijper , k.  bredies , t.  pock , and h.  bischof , editors , _ ssvm13 : proceedings of the fourth international conference on scale space and variational methods in computer vision _ ,",
    "volume 7893 of _ lecture notes in computer science _ , pages 246257 , berlin , heidelberg , 2013 .",
    "springer - verlag .",
    "nagel . extending the ` oriented smoothness constraint ' into the temporal domain and the estimation of derivatives of optical flow . in _ proceedings of the first european conference on computer vision _ ,",
    "eccv 90 , pages 139148 , new york , ny , usa , 1990 .",
    "springer - verlag new york , inc .",
    "b.  schmid , g.  shah , n.  scherf , m.  weber , k.  thierbach , c.  campos  prez , i.  roeder , p.  aanstad , and j.  huisken .",
    "high - speed panoramic light - sheet microscopy reveals global endodermal cell dynamics .",
    ", 4:2207 , 2013 .",
    "a.  torii , a.  imiya , h.  sugaya , and y.  mochizuki . .",
    "in m.  de  gregorio , v.  di  maio , m.  frucci , and c.  musio , editors , _ brain , vision , and artificial intelligence _ ,",
    "volume 3704 of _ lecture notes in computer science _",
    ", pages 527536 .",
    "springer berlin , heidelberg , 2005 .",
    "j.  weickert , a.  bruhn , t.  brox , and n.  papenberg .",
    "a survey on variational optic flow methods for small displacements . in o.",
    "scherzer , editor , _ mathematical models for registration and applications to medical imaging _ , volume  10 of _ mathematics in industry _ , pages 103136 .",
    "springer , berlin heidelberg , 2006 ."
  ],
  "abstract_text": [
    "<S> * abstract . * </S>",
    "<S> optical flow is a powerful tool for the study and analysis of motion in a sequence of images . in this article </S>",
    "<S> we study a horn  schunck type spatio - temporal regularization functional for image sequences that have a non - euclidean , time varying image domain . to that end </S>",
    "<S> we construct a riemannian metric that describes the deformation and structure of this evolving surface . </S>",
    "<S> the resulting functional can be seen as natural geometric generalization of previous work by weickert and schnrr ( 2001 ) and lefvre and baillet ( 2008 ) for static image domains . in this work </S>",
    "<S> we show the existence and wellposedness of the corresponding optical flow problem and derive necessary and sufficient optimality conditions . </S>",
    "<S> we demonstrate the functionality of our approach in a series of experiments using both synthetic and real data </S>",
    "<S> .    * keywords . * optical flow , evolving surfaces , spatio - temporal regularization , variational methods </S>",
    "<S> .    * msc subject classification . </S>",
    "<S> * 58j90 ; 65m30 ; 68u10 ; </S>"
  ]
}