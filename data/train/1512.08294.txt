{
  "article_text": [
    "before addressing the regularization of the b - factor fit , we present the equations that describe it .",
    "we assume that the thermal displacements are the combination of internal plus rigid - body motions , @xmath1 .",
    "independence between rigid - body motions and internal motions results in the thermal averages @xmath2 , which lead to the fit @xmath3    we rename the parameters as @xmath4 and rewrite the fit as @xmath5 , with @xmath6 , @xmath7 for @xmath8 , and @xmath9 for @xmath10 ( @xmath11 and @xmath12 , with @xmath13 ) . here and in the following ,",
    "we denote by @xmath14 any of the @xmath15 atoms and @xmath16 any of the @xmath17 variables .",
    "the variable @xmath18 corresponds to the thermal fluctuations due to internal motions , predicted by the enm ( see methods ) .",
    "the force constant of the model is thus obtained directly from the fit , as @xmath19 .    in the context of b - factors , it is natural to weight , by its mass @xmath20 , the contribution of each atom @xmath21 to the error of the fit .",
    "we use therefore the weighted variables @xmath22 and @xmath23 instead of @xmath24 and @xmath25 , respectively ( this does not make any difference if , as it is customary , only the alpha carbons are considered ) . moreover , it is convenient to express the fit in terms of the normalized and dimensionless variables @xmath26 and the normalized and dimensionless parameters @xmath27 . in matrix notations , the fit is then simply written @xmath28 .      to limit the risk of overfitting",
    ", we adopt the tychonov regularization , also known as ridge regression .",
    "we first describe the usual approach for obtaining the non - scaled parameters @xmath29 , which are defined as the values of the fit parameters @xmath30 that minimize the quantity @xmath31 where @xmath32 denotes the scalar product and @xmath33 is the covariance matrix .",
    "the ordinary least square ( ols ) regression is recovered as the special case @xmath34 .",
    "the minimization of @xmath35 can be interpreted as a constrained minimization of the error of the fit @xmath36 , where the constraint is set on the norm of the parameters , @xmath37 , via a lagrange multiplier @xmath38 . in other words ,",
    "the error can not be minimized at the cost of having too large values of the parameters .",
    "the explicit solution of the above minimization problem is @xmath39 .    since the covariance matrix @xmath40 is symmetric and positive definite , its eigenvalues @xmath41 are real and positive . to simplify the computation",
    ", we define the normalized projections of the fitted variable @xmath42 over the eigenvectors @xmath43 of the covariance matrix as @xmath44 , i.e. @xmath45 . the solution is then given by the following formula , which is convenient if we have to perform computations for several values of the tykhonov parameter @xmath38 : @xmath46 when @xmath38 increases , the parameters @xmath29 tend to zero and so does the fitted dependent variable .",
    "protocols for ridge regression typically address this problem by avoiding to penalize the offset of the fit , and choosing this offset in such a way that the fit is unbiased , i.e. that the average of the fit is equal to the average of @xmath42 .",
    "nevertheless , this procedure modifies the relationship between the explanatory variables .",
    "in particular , in the present case , the offset has to be interpreted as the component of the fit due to translations .",
    "increasing the offset would have the effect of artificially increasing the contribution of translations , which would then be treated differently from the other degrees of freedom .      to ensure that the fitted dependent variable is correctly scaled with respect to @xmath42 , while still considering translational motions similarly to other degrees of freedom , we modify the ridge regression protocol so as to optimize the scale of the fit parameters @xmath30 .",
    "more precisely , we multiply all parameters @xmath29 by a constant scalar @xmath47 , to obtain the rescaled parameters @xmath48 .",
    "this transformation does not modify the physical interpretation of the fit .",
    "it is easy to see that the optimally rescaled parameters have to satisfy the condition @xmath49 , with @xmath50 in order to keep the analytic treatibility , we impose this constraint on the scale via a new lagrange multiplier @xmath51 , so that the rescaled ridge regression is still formulated as the minimization of a quadratic function of the parameters :    @xmath52 + \\left(\\mathbf{y},\\mathbf{y}\\right)\\ , , \\nonumber\\end{aligned}\\ ] ]    with @xmath53 .",
    "the non - scaled fit can be obtained as a particular case by setting @xmath54 , which implies @xmath55 . since the term @xmath56 is constant ,",
    "minimizing the objective function @xmath57 is equivalent to minimizing @xmath58 , and the solution of this problem is thus given by @xmath59 , that is @xmath60 the proportionality factor @xmath47 must fulfill @xmath61 ( eq.([eq : scale ] ) ) .",
    "we find @xmath62 note that we defined the penalisation term as @xmath63 instead of @xmath64 .",
    "this adjustment is of course not necessary , but it is convenient as it allows the rescaled solution to be proportional to the non - scaled solution obtained at the same value of @xmath38 .",
    "the interplay of the constraints imposed by the two lagrange multipliers implies that , contrary to @xmath29 , the rescaled fit parameters @xmath48 do not tend to zero when @xmath38 increases . @xmath65",
    "these limit values of the parameters @xmath48 are independent of the correlation matrix @xmath40 , except for their scale @xmath66 that depends on the eigenvalues @xmath41 .",
    "therefore , when @xmath38 increases , the information on the correlations between the predictor variables is progressively lost , and their relative weights in the fit become more and more strongly determined by their individual correlations with the dependent variable .",
    "there are alternative ways to formulate the rescaled ridge regression problem .",
    "in particular , instead of the constraint on the norm of the parameters @xmath67 , we may choose to impose a constraint on the euclidian distance @xmath68 between the parameters @xmath69 and adequately chosen reference values of these parameters , @xmath70 : @xmath71 provided that the reference parameters are chosen as @xmath72 , the minimization with respect to @xmath69 of the new objective function @xmath73 + \\left(\\mathbf{y},\\mathbf{y}\\right)\\ , , \\nonumber\\end{aligned}\\ ] ] yields @xmath59 , which is exactly the same result as eq.([eq : asca ] ) above .",
    "note that the previous formulation of the objective function , in eq.([eq : scaledpr ] ) , is retrieved by setting @xmath74 .",
    "the parameter that enforces the scale is now @xmath75 note that the value of the scale parameter is still determined by eq.([eq : nu ] ) , but we are free to choose the multiplier @xmath76 and the scale of the reference parameters @xmath77 as it is most convenient .",
    "a simple and interesting choice is to set @xmath77 independent of @xmath38 . to recover the correct infinite @xmath38 limit , it must hold @xmath78 , so that @xmath79 , and the term @xmath68 vanishes in the limit of infinite @xmath38 .",
    "this gives a more straightforward interpretation to the penalisation term in rescaled ridge regression , i.e. the error can not be minimized at the cost of having parameters values too different from those that would be obtained if the predictor variables were not correlated to each other .",
    "another possibility is to set @xmath51 as constant .",
    "again , the infinite @xmath38 limit requires @xmath55 and @xmath80 .",
    "since @xmath55 , we do not have to impose any constraint on the scale , but the optimal scale is automatically imposed by the chosen scale of the reference paraters . in that case , the reference parameters are not constant but depend on @xmath38 via @xmath81 .",
    "there is also a direct correspondence with the non - scaled ridge regression since , in that case , both @xmath82 and @xmath83 , and @xmath84 .      in view of addressing the problem of the optimal choice of @xmath38",
    ", we note that there is a formal analogy between the function @xmath85 that has to be minimized and a free energy , where the ridge parameter @xmath38 plays the role of the temperature .",
    "consider a discrete physical system that can access @xmath86 microstates .",
    "the boltzmann distribution in statistical mechanics is given by @xmath87 , where @xmath88 is the probability of microstate @xmath89 and @xmath90 its energy , @xmath91 is the boltzmann constant , and @xmath92 the absolute temperature .",
    "it can be formally described as the probability distribution that maximizes the entropy for given average energy or , equivalently , minimizes the energy for given entropy .",
    "the constraint on the entropy is fixed by the lagrange multiplier @xmath92 , and the normalization condition on the probabilities , @xmath93 , is imposed through another lagrange multiplier . the objective function can be put in the form @xmath94 , where @xmath95 is the average energy and @xmath96 is the entropy . for the sake of the analogy , we adopt the equivalent objective function @xmath97 , where @xmath98 is the uniform distribution in the space of the microstates .",
    "the term @xmath99 does not modify the result of the constrained minimization .",
    "the term @xmath100 is proportional to the kullback - leibler divergence ( @xmath101 ) between the boltzmann distribution @xmath102 and the reference distribution @xmath98 that corresponds to the infinite temperature limit .",
    "thus , we can write @xmath103 , and interpret the boltzmann distibution @xmath104 as the distribution that minimizes the energy subject to the normalization constraint and the constraint on the kl divergence from the uniform distribution .    now consider the ridge regression problem .",
    "it consists in determining the values of the parameters @xmath30 that minimize the error of the fit @xmath105 , which is analogous to an energy , under a constraint @xmath106 on the scale of the parameters ( eq.([eq : scale ] ) ) , which is analogous to the normalization condition on the probabilities @xmath93 , and a constraint on the divergence @xmath107 from reference parameters @xmath70 ( eq.([eq : f ] ) ) , which is analogous to the divergence @xmath108 from the uniform distribution .",
    "this formal analogy suggests that the ridge parameter @xmath38 ( or @xmath109 , with our definition of the rescaled ridge regression problem in eq.([eq : scaled ] ) ) plays a role analogous to that of the temperature in a statistical mechanical system .",
    "it is therefore interesting to compare the behaviour of the two systems in the zero temperature and in the infinite temperature limit .    in the zero temperature limit",
    ", only the microstate of minimum energy contributes to the boltzmann distribution of a thermodynamic system .",
    "we can interpret this state as the state dominated by the correlations between degrees of freedom embodied in the energy function . in the ridge regression context , the contribution to the fit of each principal component ( i.e. each eigenvector @xmath43 of the correlation matrix ) is weighted by the factor @xmath110 ( eqs.([eq : a_spectral],[eq : asca ] ) ) , so that the relative contribution of the eigenvector @xmath111 corresponding to the minimum eigenvalue @xmath112 is maximal when @xmath34 .",
    "the similarity with a thermodynamic system is particularly striking if @xmath113 as , in that case , the eigenvector @xmath111 is the only one that significantly contributes to the regression at @xmath34 .    on the other hand , in the infinite temperature limit , the probabilities @xmath88 tend to the reference values @xmath114 , i.e. the distribution no longer depends on the energies and all microstates are equally populated .",
    "similarly , when @xmath115 in ridge regression , the parameters @xmath30 tend to their reference values @xmath116",
    "( @xmath117 in non - scaled regression , and @xmath118 if we set @xmath119 or @xmath120 in rescaled regression , eq.([eq : ascinf ] ) ) , which no longer depend on the correlation matrix , except for the scaling factor .",
    "furthermore , the equipopulation of the thermodynamic microstates finds an interesting correspondance in the fact that the factors @xmath110 weighting the contributions of the eigenvectors @xmath43 to the fit are all equal when @xmath121 .    to further analyze this analogy",
    ", we can compute the derivative of the error of the fit with respect to @xmath38 , which is equivalent to the specific heat at constant volume @xmath122 , @xmath123>0\\ , .",
    "\\label{eq : cv}\\ ] ] the cauchy - schwartz inequality allows to prove that @xmath122 is positive for @xmath124 , which means that the error of the fit increases with @xmath38 for @xmath124 , as is intuitive since @xmath38 imposes a constraint that is fulfilled at the cost of increasing the error .",
    "thus , the positivity of @xmath122 for @xmath125 provides additional support to the thermodynamic analogy .",
    "we now propose two criteria for choosing suitable tykhonov parameters inspired by the above statistical mechanical analogy .",
    "a good value of @xmath38 should provide a satisfactory trade - off between minimizing the error and reducing overfitting . in the small @xmath38 phase the error is small but @xmath68 is large and",
    "overfitting is the main problem , while in the large @xmath38 phase the contrary holds .",
    "we conjecture that , if these phases are separated by a second order phase transition with diverging specific heat in the limit of infinite variables , we may observe a peak of the specific heat for the actual number of variables @xmath17 .",
    "thus , we define @xmath126 as the value of @xmath38 at which the specific heat has a maximum .",
    "there is only one such value @xmath127 , which can be numerically determined by maximizing the specific heat eq.([eq : cv ] ) .",
    "the second criterion that we propose is based on the `` entropic '' contribution to the free energy , @xmath128 .",
    "this quantity is equal to zero both at @xmath34 , where all the information of the correlation matrix is retained , and for @xmath115 , where @xmath129 and thus @xmath130 , and the information of the correlation matrix is lost ( except for the scaling factor ) . in between , the penalty @xmath128 reaches a maximum , and we hypothesize that this maximum corresponds to a possibly optimal choice of the ridge parameter @xmath38 .",
    "we call `` maximum penalty ( mp ) fit '' ridge regression with this choice of @xmath38 .",
    "we consider the case of the rescaled ridge regression , with the reference parameters chosen equal to the parameters obtained in the @xmath115 limit , i.e. @xmath119 and @xmath131 .",
    "using eqs.([eq : asca]-[eq : f ] ) , the mp ridge parameter @xmath132 is then defined as the value of @xmath38 that maximizes the term @xmath133 since @xmath134 , the @xmath135 factor can be expressed as follows : @xmath136 , with @xmath137 .",
    "note that the dependency of @xmath135 on @xmath38 actually has only a very minor effect on the determination of @xmath132 .",
    "therefore , a possible approximation is to simply maximize @xmath138 , considering @xmath51 as a constant .",
    "we have verified that it yields highly similar , although slightly reduced , values of @xmath132 .",
    "we tested two additional alternative definitions of @xmath132 , based on different choices of the reference parameters @xmath70 , by setting either @xmath120 or @xmath139 instead of @xmath119 .",
    "we found that these choices produce results that are generally similar , although a bit poorer on average , than those based on the above definition . more detail , and comparative plots presenting the performances of these alternative definitions are given in supp .",
    "text s1 and supp .",
    "the new criteria presented above are compared with two well - known schemes for selecting the tykhonov parameter , namely the range risk ( rr ) optimization @xcite and the generalized cross validation @xcite .",
    "the gcv criterion is based on the minimization of the error of the fit with a penalty on the effective number of fitted parameters , which results in minimizing the following quantity : @xmath140 ^ 2 } \\label{eq : gcv}\\ ] ] where @xmath141 is the error of the fit , @xmath15 is the number of samples and @xmath142 is the number of parameters .",
    "although gcv may be defined for negative @xmath38 as well , we only considered positive @xmath38 since the objective function diverges at @xmath143 , which causes numerical instabilities , and since we observed that the performances of the gcv fit generally worsen if negative @xmath38 are allowed .",
    "the rr criterion leads to a related formula .",
    "nevertheless , we found that these two schemes produce the same results up to numerical precision in the examined case , and we discuss only gcv .    finally , we consider the traditional two - parameters fit of b - factors , i.e. @xmath144 @xmath145 .",
    "we call this fit the `` no - rotation '' ( norot ) fit , since it neglects all variables associated with rigid rotations , while the intercept of the fit can be interpreted as the contribution of rigid - body translations .",
    "we also consider the one - parameter fit @xmath144 @xmath146 , which neglects all rigid - body degrees of freedom ( hence we refer to it as the norigid fit ) .",
    "this fit has the advantage that the fitted force constant @xmath147 is guaranteed to be positive if the covariance between the experimental b - factors and those predicted through the enm is positive , which is always the case in our data sets .",
    "the fitting procedures described above were applied to 35 different protein datasets .",
    "the x - ray dataset consists of 376 monomeric proteins with experimentally determined b - factors , and corresponds to the real case application .",
    "the nmr dataset consists of 183 monomeric proteins for which pseudo b - factors were computed from the structural variability within the nmr ensemble . in this case",
    ", the superposition of the structures in each ensemble ensures that all rigid - body motions are excluded from the thermal fluctuations , and that the pseudo b - factors are representative of internal motions only .",
    "in addition , we created @xmath148 sets of simulated data , by adding randomly generated rotations and translations to the internal fluctuations present in each nmr ensemble , in such a way that the average fraction of motion due to internal , rotational , and translational degrees of freedom is @xmath149 , @xmath150 and @xmath151 , respectively , in each set @xmath152 ( see methods ) .",
    "an example of the atomic fluctuations for a protein in the nmr dataset and in simulated sets with rigid - body motions of increasing amplitude is given in fig.[fig:1de1 ] .",
    "interestingly , even though the overall shape of the ( pseudo ) b - factor profiles remain very similar with low to medium amplitudes of added rigid - body motions , critical alterations such as the formation of additional peaks can be observed with larger amplitudes of added rotations ( e.g. with @xmath153 in fig.[fig:1de1]c ) .    , and @xmath154 .",
    "for clarity , only five structures in each ensemble are shown .",
    "( c ) the pseudo b - factors for the same protein , as of function of the position in the sequence , in the nmr ensemble 1de1 ( @xmath155 ) , and in the simulated sets with different values of @xmath156 , with @xmath157 . ]    for each protein , the predicted fluctuations due to internal motions were obtained with the tnm program @xcite , and were used to estimate the force constants @xmath158 and the fractions of degrees of freedom @xmath156 , @xmath92 , and @xmath159 , for each protein in each dataset ( see methods ) .",
    "besides the force constant , two parameters define the force field of the tnm , the exponent @xmath160 and the cutoff @xmath161 .",
    "we adopt here the parameters @xmath162 and @xmath163 , as these values produce optimal predictions of interatomic distance fluctuations ( unpublished ) .",
    "we briefly discuss later the impact of choosing different values of these parameters .",
    "the average values of the ridge parameter @xmath38 and of the error of the fit are reported on fig.[fig : lambda ] , for different datasets and fitting procedures .",
    "more precisely , we compare the ordinary least square regression ( ols ) with the rescaled ridge regression using different regularization criteria : generalized cross validation ( gcv ) , specific - heat maximum ( cv ) , and maximum penalty ( mp ) .",
    "furthermore , the two - parameters fit that neglects rigid - body rotations is referred to as norot , and the one - parameter fit that neglects both rigid - body rotations and translations as norigid .     on selected sets of simulated data ( left ) and in the x - ray dataset",
    "( right ) .",
    "bottom : relative error of the fit ( eq . [ eq : errorfit ] ) .",
    "the error bars correspond to the standard deviation over all proteins in each set . ]",
    "overall , the comparison of the respective behaviour of these different fits is very consistent across all datasets , which does support the validity of the nmr data with added rigid - body motions as relevant simulated test sets .",
    "the gcv criterion generates very small values of the ridge parameter @xmath38 , e.g. @xmath164 on average in the x - ray dataset ( fig.[fig : lambda ] , top ) .",
    "this is due to the fact that the number of data points @xmath15 ( i.e. the number of atoms ) is much larger than the number of parameters @xmath17 , so that the effective number of parameters ( eq . [ eq : gcv ] ) depends very weakly on @xmath38 and is always approximately equal to @xmath142 .",
    "the results produced by the gcv fit are therefore very close to those obtained by minimizing the error of the fit without any regularization , as in ols regression ( @xmath34 ) . the new criteria that we introduce here , cv and mp , both yield substantially larger values of @xmath38 , on all examined datasets .",
    "for example , in the x - ray dataset , the average @xmath38 is equal to @xmath165 with the cv criterion , and to @xmath166 with the mp criterion . with larger values of @xmath38 ,",
    "the constraint imposed on the parameters of the fit becomes stronger , resulting in somewhat larger fitting errors ( fig.[fig : lambda ] , bottom ) .",
    "however , even with the mp fit that imposes the strongest regularization , the error remains lower than with the common two - parameters fit ( norot ) . on average",
    "over all simulated sets , the relative error of the fitted b - factors decreases from @xmath167 with the norot fit , to @xmath168 with the mp fit , and @xmath169 with the ols fit .",
    "the corresponding values in the x - ray dataset are @xmath170 with the norot fit , @xmath171 with the mp fit , and @xmath172 with the ols fit .      in the simulated datasets ,",
    "the contribution of internal degrees of freedom to the fluctuations of the atomic coordinates is known exactly .",
    "these sets give thus the possibility to assess and compare the quality of the various fitting schemes and regularization criteria .",
    "the error on internal motions @xmath173 ( eq . [ eq : errorint ] ) reflects the ability to accurately retrieve the fluctuations due to internal degrees of freedom from a fit of b - factor data that may also include contributions from rigid - body degrees of freedom .",
    "this error arises in part from the imperfections of the elastic network model used to make the predictions , and in part from the presence of `` noise '' in the b - factor data , in the form of fluctuations due to rigid - body motions .",
    "since we are here interested in the latter source of error , we take as reference the lowest possible value of this error ( @xmath174 ) that is obtained with the norigid fit , which does not account for rigid - body motions , on the nmr dataset with @xmath175 , which does not contain fluctuations due to rigid - body motions .",
    "the performances of the various fits as a function of the internal fraction @xmath156 ( with @xmath157 ) are given in fig.[fig : errint ] .",
    "with the norigid fit , all fluctuations are interpreted as being due to internal motions , and the error @xmath173 thus rapidly increases as the internal fraction drops . the norot fit , which accounts for internal motions and translations , but not for rotations , presents a quite similar behaviour except that it is more robust to the addition of rigid - body fluctuations .",
    "it appears therefore as optimal in the presence of rigid - body motions of medium amplitude ( i.e. in the range @xmath176 ) .",
    "[ eq : errorint ] ) is given as a function of the fraction of internal motions @xmath156 , in the simulated sets with @xmath157 , for different types of fit .",
    "the lowest possible value of the error , @xmath174 , is obtained with the norigid fit on the nmr dataset ( @xmath155 ) . ]",
    "if there are rigid - body fluctuations of larger amplitude ( @xmath177 ) , the norot fit is no longer sufficient , and accounting for all degrees of freedom in the fit becomes a critical necessity . for that purpose ,",
    "the cv fit and the mp fit , based on the new criteria that we introduced , both appear clearly superior to the ols and the gcv fit .",
    "the cv fit outperforms the ols and gcv fits in all of the datasets that we examined , with an error on internal motions that remains relatively stable across the whole range of @xmath156 ( @xmath178 ) .",
    "the error of the mp fit is more dependent on the internal fraction @xmath156 , but it still outperforms the ols and gcv in most datasets , except for very low amplitudes of added rigid - body fluctuations ( @xmath179 ) . in the range @xmath180 , the mp criterion stands out as the optimal choice , yielding a significantly lower error than all other fits .",
    "in particular , at @xmath181 , the error on internal motions @xmath173 is as low as @xmath170 with the mp fit , which is quite impressive considering that the minimum error possibly achievable is @xmath166 , and that the addressed problem is quite challenging since the amplitude of the `` noise '' ( rigid - body fluctuations ) is here four times larger than that of the `` signal '' ( internal fluctuations ) . for comparison , at @xmath181 , @xmath182 without regularization ( ols ) , and @xmath183 with the gcv criterion .",
    "we also examined the error @xmath173 on the simulated sets with either @xmath184 or @xmath185 .",
    "the results are similar to those obtained with @xmath157 , except for the norot fit ( supp .",
    "as it could be expected , the norot fit performs much better when there are added translations but no rotations , and much worse when there are added rotations but no translations .",
    "in addition , a related performance measure can be obtained by considering as a proxy of the real force constant the force constant determined by the norigid fit on the nmr set without rigid - body motions , @xmath186 . in each simulated set @xmath152",
    ", the comparison between @xmath186 and the force constants @xmath187 estimated from the various fitting procedures , leads to the definition of the error on the force constant , @xmath188 ( eq . [ eq : errorkappa ] ) .",
    "for all fits , the behaviour of @xmath188 as a function of @xmath156 is strongly related to that of @xmath173 , and leads to similar conclusions ( supp .",
    "s3 ) .    furthermore , to investigate more systematically the impact of using different levels of regularization , we examined the parametrization @xmath189 , where @xmath190 is the maximum eigenvalue of the normalized covariance matrix , and @xmath191 is a factor that was exponentially increased from @xmath192 to @xmath193 .",
    "we can see in fig.[fig : errint_2 ] that for each simulated set , there is an optimal value of @xmath191 , corresponding to a minimum of the error @xmath173 . both the depth and the position of this minimum depend on the fractions of @xmath156 , @xmath92 , and @xmath159 that define each simulated set .",
    "yet , in all cases , either the mp or cv criterion , or both , yield an average @xmath38 value and error @xmath173 that are very similar to those obtained at the minimum .",
    "these results suggest that , for the current application , the new criteria that we introduced not only outperform the gcv criterion , but are also generally close to optimal in terms of selecting the right level of regularization .",
    "[ eq : errorint ] ) is given as a function of the average ridge parameter @xmath38 for different types of fit .",
    "each subplot corresponds to a different simulated dataset , with fractions of degree of freedom : @xmath194 and @xmath157 , @xmath184 , or @xmath185 . ]      as detailed above , the analysis of the results obtained on the simulated datasets have shown that the performances of the different fitting procedures depend to some extent on the fractions of motion due to internal degrees of freedom ( @xmath156 ) , rigid - body translations ( @xmath92 ) , and rigid - body rotations ( @xmath159 ) .",
    "notably , if the contribution of rigid - body motions remains small or medium , accounting for all degrees of freedom may not be necessary , and the use of the norigid or norot fit can be appropriate . on the contrary ,",
    "if rigid - body motions account for a sufficiently high fraction of the fluctuations , then a full fit including contributions from both translations and rotations is necessary , and the regularization with the mp criterion yields the best performances .",
    "hence , an important question that arises concerns the actual values of the @xmath156 , @xmath92 , and @xmath159 fractions in the b - factor data from x - ray experiments . to answer that question",
    ", we used the simulated data to evaluate the ability of the different fits to accurately estimate the @xmath156 , @xmath92 , @xmath159 fractions .",
    "the left panel of fig.[fig : itr ] shows the average value ( over all proteins @xmath195 in a simulated set ) of the fitted internal fraction , @xmath196 , as a function of the actual value of @xmath156 in the set .",
    "a very strong linear correlation is observed between @xmath196 and @xmath156 , for all fits except the norigid fit , which only accounts for internal motions and thus always yields @xmath197 .",
    "the norot fit tends to systematically overestimate the importance of internal motions , i.e. @xmath198 , since fluctuations due to rigid - body rotations are not accounted for and mostly interpreted as being due to internal degrees of freedom . on the other hand , in fits with @xmath124 , the contribution of internal motions is underestimated when @xmath156 is large , and overestimated when @xmath156 is small ( with a threshold at @xmath199 for all types of fit ) .",
    "this bias increases with @xmath38 , and is thus most visible in the mp fit , and practically non - existent in the ols and gcv fits .     as a function of the real internal fraction @xmath156 .",
    "the dashed line corresponds to @xmath200 .",
    "( right ) root mean square error of the fitted internal fraction , rmse(@xmath201 ) ( eq .",
    "[ eq : rmsei ] ) , as a function of @xmath156 . ]    the right panel of fig.[fig : itr ] shows the root mean square error of the fitted internal fraction , rmse@xmath202 , as a function of @xmath156 .",
    "interestingly , despite the fact that the mp fit is subject to the strongest regularization , and thus affected by the strongest bias @xmath203 , it does yield the lowest error on the estimation of the internal fraction for individual proteins ( at least when @xmath204 , otherwise the norigid fit is superior ) .",
    "this is explained by the fact that the bias is accompanied by a sizeable reduction of the variance ( between proteins ) of the fitted fraction @xmath201 . on the contrary ,",
    "the ols and gcv fits are affected by a large variance of the fitted internal fraction .",
    "therefore , even though there is little to no systematic bias , the error on @xmath201 is actually much larger with these two fits .",
    "the norot and cv fits present intermediate performances .",
    "similar results hold for the other types of degrees of freedom , @xmath92 and @xmath159 ( supp .",
    "s4 ) .    in a number of cases ,",
    "the parameters of the fit correspond to negative values of the fraction of motion due to either internal , translational or rotational degrees of freedom , which is unphysical ( in particular , @xmath205 means a negative force constant ) . as shown on fig.[fig : negitr ] , this problem is particularly serious when the internal fraction is large .",
    "for example , at @xmath206 , unphysical parameters are obtained for as many as 63% of the proteins , with the ols fit . here again , the benefits of regularization are very apparent : e.g. at @xmath181 , the number of proteins with negative @xmath201 , @xmath207 , or @xmath208 fractions is reduced from 10% with the ols fit , to 3% with the cv fit , and 0% with the mp fit .",
    "similar results are obtained on the dataset of crystallographic b - factors . in this case ,",
    "unphysical parameters are derived from the ols fit for about 15% of the proteins , but this number drops to 1% with the mp fit .    , @xmath207 , or @xmath208 ratio is given for the different fits , on selected simulated datasets ( left ) , and on the x - ray dataset ( right ) . ]    in summary , the analysis of the results obtained on the simulated data indicates that the mp fit produces the best estimation of the @xmath156 , @xmath92 , @xmath159 fractions , for individual proteins ( unless @xmath209 , in which case the norigid fit may be preferable ) .",
    "this is achieved at the price of a systematic bias , which is a consequence of the regularization of the parameters . on the contrary ,",
    "the ols and gcv fits are characterized by a large rmse on the fitted @xmath156 , @xmath92 , @xmath159 fractions , and moreover often generate unphysical values of the parameters .",
    "however , these fits are not biased , i.e. on average over a sufficiently large set of proteins , the estimated fractions of motion due to the different types of degrees of freedom , @xmath196 , @xmath210 , and @xmath211 , are remarkably accurate ( fig . [",
    "fig : itr ] , left ) .",
    "thus , although the ols and gcv fits may not be well suited to any real - case application , this absence of bias is an interesting feature that can be exploited to evaluate the average contributions of internal and rigid - body motions in crystallographic b - factors .",
    "the results for experimental b - factors measured in protein crystals are presented in fig.[fig : dof ] .",
    "the ols fit , which is expected to give the least biased estimates , yields average values of @xmath212 for internal , @xmath213 for translational , and @xmath214 for rotational degrees of freedom .",
    "the regularized fits based on the cv and mp criteria generate very similar values of the fraction of internal motions , which is consistent with the fact that the bias on @xmath156 is minimal when @xmath199 ( fig.[fig : itr ] , left ) .",
    "these fits do however somewhat underestimate , on average , the contribution of rigid - body translations and overestimate the contribution of rigid - body rotations ( e.g. @xmath215 and @xmath216 with the mp fit ) . in any case , these results strongly suggest that the contribution of rigid - body motions is quite important in crystallographic b - factors , with internal motions accounting for 20% or less of the measured atomic fluctuations . in this range",
    ", the commonly used two - parameters norot fit fails to provide satisfactory results , and the mp fit appears as a much preferable alternative ( see e.g. fig.[fig : errint ] ) .",
    "one of the main motivations of this work was to assess how the evaluation of the force constant from a fit of crystallographic b - factors can be improved by properly accounting for fluctuations due to rigid - body degrees of freedom .",
    "as detailed above , this assessment can be performed rigorously with the simulated datasets , in which the relative contributions of internal and rigid - body motions are known _ a priori_.",
    "such knowledge is not available in the x - ray dataset , but it is however possible to evaluate the variability of the force constants estimated by the different fitting procedures across all proteins in the set .",
    "we assess this variability by measuring the standard deviation of the logarithm of the force constant , @xmath217 , plotted in fig.[fig : kappa ] .",
    "we consider the logarithm because its fluctuations are better behaved , and it allows to eliminate the influence of multiplicative scale factors .",
    ", is given for selected sets of simulated data ( left ) and for the x - ray dataset ( right ) . in each set ,",
    "the proteins for which at least one of the fits yielded a negative value of @xmath158 were omitted , for all fits .",
    "the dashed line corresponds to the value of @xmath217 obtained with the norigid fit on the nmr dataset ( @xmath175 ) .",
    "a value of @xmath218 corresponds to a multiplicative spread of @xmath219 , i.e. for most proteins , the estimated force constant is smaller than @xmath220 times and larger that @xmath221 times the geometric mean . ]    in the simulated sets , an important part of the variability is due to the nature of the nmr data .",
    "typically , the extent of structural variability within an nmr ensemble is determined by the number and quality of the interatomic distance constraints extracted from the experiment , which may depend on a number of factors not directly related to the dynamical properties of the macromolecule . in consequence ,",
    "the norigid fit applied to the nmr dataset without added rigid - body motions ( @xmath155 ) generates values of the force constants that are already considerably spread out , with @xmath222 .",
    "the addition of rigid - body motions tends to increase this variability , although @xmath217 shows a relatively limited dependence on the internal fraction @xmath156 ( fig.[fig : kappa ] , left ) .",
    "this is not overly surprising since , in each simulated set , the amplitude of added rigid - body motions is identical for all proteins .",
    "the largest variability amongst force constants evaluated for different proteins occurs with the ols and gcv fits .",
    "these fits account for rigid - body motions but are not ( or only slightly ) regularized , and the collinearity between predictor variables leads thus , in a number of cases , to the determination of either negative or very large values of the force constant . increasing @xmath38 tends to mitigate this problem , and consequently reduces the variability ( supp .",
    "the mp fit is thus characterized by an intermediate level of variability of the force constants , similar to that of the norot fit .",
    "it is however important to recognize that a low variability does not imply a correct estimation of @xmath158 .",
    "for example , the norigid and norot fits yield a relatively low variability but systematically underestimate the force constant , since fluctuations due to rigid - body rotations are interpreted as resulting from internal degrees of freedom .",
    "the results are essentially similar in the x - ray dataset ( fig.[fig : kappa ] , right ) . here again , we expect some intrinsic variability of the estimated force constants , due to a variety of phenomena that may influence the b - factors measured in protein crystals , such as crystal packing and static disorder @xcite .",
    "it is therefore unlikely that any fitting procedure could achieve a complete elimination of the spread of the force constants estimated for different proteins . with @xmath223",
    ", the mp fit does however produce a substantial reduction of the variability , in comparison with both the ols fit ( @xmath224 ) , in which case we can interpret the excess variability as due to overfitting , and the commonly used norot fit ( @xmath225 ) .      in the elastic network model , the stiffness of the spring associated to a given pair of residues is typically defined as a function of the spatial distance separating these two residues .",
    "we adopted here a common expression of the force constant , @xmath226 if @xmath227 , and @xmath228 otherwise , where @xmath229 is the minimal interatomic distance between residues @xmath21 and @xmath230 , and @xmath231 ( @xmath232 ) is a reference distance ( see methods ) .",
    "the results presented above are related to the determination of the factor @xmath158 , with chosen values of the distance threshold @xmath163 , and of the exponent @xmath162 . in order to analyze the dependence of the force constant on @xmath161 and @xmath160 and to ensure the robustness of our conclusions , we investigated the influence of these two parameters of the enm on the estimated force constants . in practice , we varied @xmath161 from @xmath233 to @xmath234 , and @xmath160 from 0 to 8 , and applied the resulting models to the x - ray dataset .",
    "the average and the standard deviation of the logarithm of the fitted force constants are given in fig.[fig : cut - off ] , for the various fits , with different values of @xmath161 and @xmath160 .    , eliminating proteins for which @xmath158 is negative , are plotted versus the distance cut - off @xmath161 for exponent @xmath162 ( left ) and versus the exponent @xmath160 for distance cut - off @xmath163(right ) . ]",
    "as could be expected , the average force constant tends to decrease when the distance cut - off @xmath161 increases ( fig.[fig : cut - off ] , top left ) .",
    "indeed , if the number of interacting pairs of residues increases due to a larger cut - off , the force constant associated with each pair must decrease to maintain a similar amplitude of the atomic fluctuations .",
    "we also measured the correlation coefficients between the force constants determined at different values of @xmath161 and @xmath160 , over all proteins of the x - ray data set , for each type of fit .",
    "the force constants obtained for the different proteins , with two different sets of parameters @xmath161 and @xmath160 , are always highly correlated to each other ( correlation coefficient larger than 0.98 ) as long as @xmath235 .",
    "drastic changes do however occur when the cut - off distance @xmath161 is decreased below 3.5 : forces constants determined with @xmath236@xmath237 tend to present vanishing correlations with those determined using different values of @xmath161 and @xmath160 , irrespective of the type of fit .",
    "these observations are consistent with the fact that if the distance cut - off is too small , crucial interactions are ignored , which can result in a disruption of the overall integrity of the structure , and have dramatic effects on the predicted dynamics . in contrast , the force constant depends much more weakly on the exponent @xmath160 ( fig.[fig : cut - off ] , right ) .",
    "this is due to the choice of the reference distance @xmath238 . indeed ,",
    "when @xmath160 increases , @xmath239 increases for pairs of residues with @xmath240 , and decreases for pairs or residues with @xmath241 .",
    "these two effects appear to compensate each other fairly well , which explains the small impact of @xmath160 on the scaling factor @xmath158 .",
    "importantly , all types of fits show the same qualitative behavior , and the differences between the fits are mostly independent of the choice of the @xmath160 and @xmath161 parameters , which demonstrates the robustness of the results presented in the previous sections , where we used @xmath163@xmath237 and @xmath162 .",
    "note however that , even if the parameters @xmath160 and @xmath161 have a relatively limited effect on the force constant @xmath158 , they may significantly affect the normal modes of motion predicted by the enm , and thus the overall performances of the model .",
    "crystallographic b - factors are commonly used to train and validate computational models of protein dynamics .",
    "there are however a number of possible shortcomings to this approach @xcite .",
    "in particular , rigid - body rotations are often neglected , even though several studies concluded that the occurrence of such motions is a major determinant of experimental b - factors @xcite .",
    "our results support these conclusions , and indicate that the contribution of internal motions is lower than 20% , on average .",
    "a systematic analysis of simulated sets of pseudo b - factors , characterized by variable amplitudes of rigid - body fluctuations , suggests that these estimations are subject to very little bias .",
    "these results are also consistent with a study by halle @xcite and a follow - up by li and brschweiler @xcite , who showed that b - factors in x - ray protein structures are well predicted by the number of contacts of each residue . in light of the importance of rigid - body motions to b",
    "- factors , this observation may be explained by the negative correlation between the number of contacts , which tends to be larger for buried residues , and the atomic fluctuations due to rigid - body rotations , which more severely affect surface residues as they are further away from the center of mass . on the other hand",
    ", the number of contacts also has a strong influence on the fluctuations due to internal degrees of freedom , predicted for example by the enm .",
    "this entails a high level of collinearity between explanatory variables and underlines the fact that , to determine the scale of the enm force constant via a fit of b - factors , it is not only important to properly account for all rigid - body degrees of freedom , but also to carefully regularize the fit in order to reduce the risk of overfitting .",
    "for that purpose , we introduced two novel criteria for determining the ridge parameter @xmath38 .",
    "the definition of these criteria was motivated by a strong formal analogy between ridge regression and statistical mechanics , where @xmath38 plays the role of the temperature .",
    "our results demonstrate that the mp criterion is an almost optimal way of choosing @xmath38 , at least for the problem of fitting force constants from b - factors . for simulated b - factors with an internal fraction close to @xmath181 ( the range that we expect to find in x - ray structures )",
    ", the mp fit was shown to yield the minimum root mean square error ( rmse ) on the estimation of the fluctuations due to internal degrees of freedom , the minimum rmse on the logarithm of the fitted force constant , and the minimum rmse on the estimated fractions of internal , translational and rotational motions . in contrast , the commonly used gcv criterion produces a 40% larger value of the rmse on internal fluctuations .",
    "furthermore , in the x - ray dataset , the gcv fit generates unphysical values of the parameters ( e.g. negative force constants ) for 47 out of 376 proteins , while this number is reduced to 5 with the mp fit .",
    "the gcv criterion also induces an increase of the across - protein variability of the logarithm of the force constants , from @xmath242 with the mp criterion to @xmath243 .",
    "the poor performances of the gcv fit indicate that the ridge parameter determined by this criterion is too small and does not provide a sufficient regularization of the fit of b - factors .",
    "this is most likely due to the fact that overfitting occurs here because of the high level of collinearity between explanatory variables , even though the number of fitted parameters ( @xmath17 ) remains small with respect to the number of data points ( @xmath244 number of residues ) .",
    "the cv criterion produces a level of regularization that is intermediate between the gcv and mp fits . despite yielding poorer performances than mp when the internal fraction is close to @xmath181 , and thus when applied to x - ray structures , the cv criterion is consistently superior to gcv over all sets of simulated data , and it outperforms mp when the internal fraction is either large or small . in consequence , even though the cv fit appears to be somewhat less well adapted than mp to the present application , it has the advantage of being more robust with respect to the nature of the analysed data , and is thus a good candidate for application in a wide range of situations .",
    "note that the analogy between statistical mechanics and ridge regression that we explored here can easily be extended to other types of constrained minimization problems , where the weight of the constraint imposed on the parameters has to be fixed in an optimal way .",
    "in particular , in the context of statistical mechanics our analogy evidences the existence of an intrinsic temperature that maximizes the penalty term @xmath245 , where @xmath92 is the temperature and @xmath246 is the entropy , at which the minimization of the energy and the maximization of the entropy are well balanced .    in summary ,",
    "the present results further confirm the predominance of rigid - body motions in crystallographic b - factors , and underline the importance of accounting for all degrees of freedom via a carefully regularized fit when b - factors are used to scale computational models of protein dynamics .",
    "the mp fit stands out as the optimal choice for that particular application .",
    "importantly , the potential benefits of the mp and cv criteria are not limited to the fit of b - factor data .",
    "although further studies would be necessary to assess the general applicability of these criteria to the regularization of other multi - variable fits , the strong performances displayed here , in comparison with the common gcv approach , suggest that the adoption of these new criteria could be advantageous in various applications",
    ". this may be particularly true for problems that bear similarity to the considered case , i.e. when the number of fitted parameters is small enough with respect to the number of data points but the explanatory variables are highly collinear , and/or when restrictions apply to the physically acceptable values of the parameters . on the other hand ,",
    "the rescaled variant of ridge regression that we introduced here is readily applicable to any regression problem in which the intercept of the fit has a physical meaning and must be penalised similarly to the other explanatory variables .",
    "we examined a test set of 380 non - redundant monomeric proteins whose structure has been solved by x - ray crystallography , with resolution better than 2 , extracted from the top500 dataset used to benchmark the molprobity program @xcite . from this set ,",
    "we eliminated the proteins with pdb codes 2sns , 1cne , and 2ucz , because the record of b - factors was missing in these proteins ( all recorded b - factors were equal ) , and 1rho , which was the most serious outlier for all the fits and was predicted as hexameric by the software pisa @xcite .    the 183 structural ensembles in the nmr dataset were selected according to the following criteria : they consist of at least 20 models with identical number of residues ; they correspond to monomeric proteins of at least 50 residues that present at most 30% sequence identity with one another ; they are not listed under the scop classifications `` peptides '' or `` membrane and cell surface proteins '' ; they do not include ligands , dna or rna molecules , chain breaks , or non - natural amino acids ; and they do not contain highly flexible loops or c- or n - terminal tails . to enforce the latter criterion ,",
    "highly flexible regions were defined as stretches of at least two consecutive residues for which the mean square fluctuations of the c@xmath247 coordinates are larger than 2.5 times the average over all residues .",
    "such loops or tails typically correspond to disordered regions , for which the observed fluctuations within the nmr ensemble are not meaningful , and which are usually absent from structures determined by x - ray crystallography .",
    "the structures in each nmr ensemble were superposed , so as to ensure the absence of any rigid - body component to the observed displacements of the atomic coordinates .",
    "pseudo b - factors , corresponding to thermal fluctuations due solely to internal motions , were then computed for each residue @xmath21 :      where @xmath249 is the number of structural models in the ensemble , @xmath250 is the position of the c@xmath247 atom of residue @xmath21 in model @xmath251 of the superposed ensemble , and the averages are taken over all models of the ensemble .",
    "on the basis of the nmr dataset , we generated @xmath148 sets of simulated data , by adding rigid - body contributions of controlled amplitude to the thermal fluctuations .",
    "for each set @xmath152 , we applied the following procedure to all superposed nmr ensembles . each structure",
    "@xmath251 in the ensemble was subjected to a random translation and rotation , and its coordinates were adapted in consequence :      the orientations of the rotation and translation vectors @xmath253 and @xmath254 were drawn randomly from a uniform spherical distribution , and their amplitudes from a standard normal distribution .",
    "the scalar parameters @xmath255 and @xmath256 give control over the relative importance of internal , rotational , and translational motions . the resulting structural ensemble can be considered as a series of snapshots of a molecule undergoing fluctuations due to both internal and rigid - body motions . for each residue ,",
    "the mean square fluctuations were then computed from this ensemble of snapshots , ensuring that the contribution of rigid - body motions is affected by the same kind of noise as for the internal motions .        where @xmath15 is the number of atoms .",
    "the average fractions of motion due to translational ( @xmath150 ) and rotational ( @xmath151 ) degrees of freedom are defined similarly . for each protein in each set , the parameters @xmath255 and @xmath256 were adjusted so as to reach pre - defined values of @xmath149 , @xmath150 , and @xmath151 . more precisely , simulated sets were build for 11 different @xmath259 values @xmath260 , with either @xmath261 , @xmath262 , or @xmath263 .",
    "the relative amplitude of added rigid - body motions , @xmath264 , was thus varied from 11% ( @xmath265 ) to 900% ( @xmath266 ) .",
    "note that the structural variability within a superposed nmr ensemble does not perfectly reflect the actual dynamical behaviour of the protein .",
    "indeed , it may also be affected by the resolution of the nmr experiment , and the way the structure - building software deals with missing or conflicting distance constraints .",
    "still , mean square fluctuations extracted from superposed nmr ensembles have been shown to correlate well with b - factors from x - ray experiments , and with nmr measurements more directly related to protein dynamics @xcite . the structural variability within nmr ensembles",
    "has also been successfully used to investigate the behaviour of enms @xcite , or to parametrize their force field @xcite . in any case , for our purposes , it is not necessary to assume that the collection of structural models within an ensemble gives an accurate picture of the protein s dynamics .",
    "we merely consider that each ensemble provides a reasonably realistic example of possible fluctuations due to internal motions , captured with a certain level of noise .      in this work we adopted the torsional network model ( tnm ) , an enm in torsion angle space that preserves the bond lengths and bond angles of the protein @xcite .",
    "all protein atoms were considered in the computation of the kinetic energy .",
    "the native interactions were identified with pairs of heavy atoms at distance smaller than @xmath161 , which was varied from @xmath233 to @xmath234 .",
    "for every pair of residues , only the pair of atoms at smallest distance were regarded as native contacts and joined with a spring with force constant @xmath267 , where @xmath268 is the equilibrium distance between the two atoms , @xmath238is a reference distance , @xmath269 is the force constant obtained from the fit of b - factors and @xmath160 is an exponent that we varied from 0 to 8 .",
    "finally , the force constant of torsion angles was fixed at @xmath270 , a value that we had previously tested as almost optimal .          where @xmath15 is the number of atoms and @xmath142 the number of predictor variables ( @xmath17 when rigid - body motions are accounted for ) .",
    "the @xmath272 are the normalised and dimensionless predictor variables , @xmath30 the corresponding fitted parameters , and @xmath273 is the variance of the dependent variable @xmath274 .    in the simulated sets ,",
    "the contributions of the internal degrees of freedom are known exactly . a straightforward way to evaluate the quality of the different fitting procedures",
    "is thus to assess their ability to accurately extract the atomic fluctuations due to internal motions , @xmath275 , from datasets with varying amounts of added `` noise '' ( i.e. rigid - body fluctuations ) .",
    "the relative error on internal motions is defined as :      where the @xmath277 parameter is obtained from the full fit of the atomic fluctuations @xmath278 .",
    "a related measurement is obtained by considering the force constant estimated from the nmr set without rigid - body motions , @xmath269 , as a proxy of the real force constant .",
    "considering that the force constant @xmath158 is a multiplicative factor in the enm model , the @xmath158 values derived from the fits on simulated sets with added rigid - body motions are compared to @xmath269 as follows :      the error measures are computed for each protein independently , and the reported values of @xmath160 and @xmath173 are averaged over all proteins in the considered dataset . since @xmath188 is not defined when @xmath280 , the reported values are averaged over the subset of proteins for which none of the fitting procedures generates a negative value of @xmath158 ( i.e. between 165 ( @xmath281 ) and 176 ( @xmath155 ) proteins , out of 183 , for the different simulated sets ) .    in the simulated datasets , the fractions of motion due to internal ( @xmath156 ) , translational ( @xmath92 ) , and rotational ( @xmath159 ) degrees of freedom",
    "were adjusted to specific predefined values .",
    "the corresponding contributions of the three types of degrees of freedom can be estimated from the different fits .",
    "in particular , the fitted fraction of motion due to internal degrees of freedom , in protein @xmath195 , is :          where @xmath284 is the number of proteins in the dataset .",
    "the corresponding measures for the translational and rotational degrees of freedom , rmse(@xmath207 ) and rmse(@xmath208 ) , respectively , are defined similarly .",
    "dos santos hg , klett j , mndez r , bastolla u. ( 2013 ) characterizing conformation changes in proteins through the torsional elastic response .",
    "biochem biophys acta 1834:836 - 46 .",
    "rueda m , chacn p , orozco m. ( 2007 ) thorough validation of protein normal mode analysis : a comparative study with essential dynamics .",
    "structure 15:565 - 75 .",
    "riccardi d , cui q , philips gn jr .",
    "( 2010 ) evaluating elastic network models of crystalline biological molecules with temperature factors , correlated motions , and diffuse x - ray scattering .",
    "biophys j. 99:2616 - 25 .",
    "krissinel e , henrick k. ( 2007 ) inference of macromolecular assemblies from crystalline state .",
    "j mol biol . 372:774 - 797 .",
    "davis iw , leaver - fay a , chen vb , block jn , kapral gj , wang x , murray lw , arendall wbiii , snoeyink j , richardson js , richardson dc .",
    "( 2007 ) molprobity : all - atom contacts and structure validation for proteins and nucleic acids .",
    "nucleic acids res .",
    "35 : w375w383 .",
    "berjanskii m , wishart ds .",
    "( 2006 ) nmr : prediction of protein flexibility .",
    "nat protoc .",
    "1:683 - 8 ."
  ],
  "abstract_text": [
    "<S> multivariate regression is a widespread computational technique that may give meaningless results if the explanatory variables are too numerous or highly collinear . </S>",
    "<S> tikhonov regularization , or ridge regression , is a popular approach to address this issue . </S>",
    "<S> we reveal here a formal analogy between ridge regression and statistical mechanics , where the objective function is comparable to a free energy , and the ridge parameter plays the role of temperature . </S>",
    "<S> this analogy suggests two new criteria to select a suitable ridge parameter : the specific - heat ( cv ) and the maximum penalty ( mp ) fits . </S>",
    "<S> we apply these methods to the calibration of the force constant in elastic network models ( enm ) . </S>",
    "<S> this key parameter , which determines the amplitude of the predicted atomic fluctuations , is commonly obtained by fitting crystallographic b - factors . however , rigid - body motions are typically partially neglected in such fits , even though their importance has been repeatedly stressed . </S>",
    "<S> considering the full set of rigid - body and internal degrees of freedom bears significant risks of overfitting , due to the strong correlations between explanatory variables , and requires thus careful regularization . using simulated data , we show that ridge regression with the cv or mp criterion markedly reduces the error of the estimated force constant , its across - protein variation , and the number of proteins with unphysical values of the fit parameters , in comparison with popular regularization schemes such as generalized cross - validation . </S>",
    "<S> when applied to protein crystals , the new methods are shown to provide a more robust calibration of enm force constants , even though our results indicate that rigid - body motions account on average for more than 80% of the amplitude of b - factors . </S>",
    "<S> while mp emerges as the optimal choice for fitting crystallographic b - factors , the cv fit is more robust to the nature of the data , and is thus an interesting candidate for other applications .    </S>",
    "<S> there is growing interest in the investigation of the intrinsic dynamical properties of proteins in their native state , for these properties play a key role in ensuring proper functional activity , notably for catalysis @xcite , allosteric regulation @xcite , or molecular recognition @xcite . </S>",
    "<S> however , despite recent progress @xcite , the experimental study of protein dynamics remains rather challenging , and computational methods can thus often provide valuable alternatives . among those , </S>",
    "<S> elastic network models ( enm ) @xcite are becoming increasingly popular , since they are able to provide detailed analytic predictions of native protein dynamics at a very reasonable computational cost . </S>",
    "<S> the enm predictions have been shown to correlate well with experimentally observed conformational changes @xcite , and with long molecular dynamics trajectories @xcite .    </S>",
    "<S> one of the advantages of enms is that their force field is derived from the experimentally determined structure of the protein of interest , adopting the principle of minimal frustration , and relies on a very small number of coarse - grained parameters . </S>",
    "<S> typically , pairs of residues separated by a spatial distance lower than a certain cut - off value are identified as relevant interactions and connected by elastic springs . </S>",
    "<S> the dynamical behaviour of the resulting network is determined by the stiffness of the spring assigned to each pair of residues , which is often expressed as a constant multiplied by a decaying power function of the interresidue distance . </S>",
    "<S> several previous studies have been focused on the determination of the optimal parameters of this model , i.e. the distance - dependence of the force constant , via the cut - off and the exponential factor @xcite , or the influence of the chemical nature of each amino acid type @xcite . in the present work , </S>",
    "<S> we address a somewhat different question , the evaluation of the overall scale of the force constants . </S>",
    "<S> although it does not influence the shape of the normal modes , this parameter is crucial for determining the amplitude of the predicted internal motions of the macromolecule . for that purpose , we adopt here the torsional network model ( tnm ) , an enm in torsion angle space that preserves the bond lengths and bond angles within the protein @xcite .    in enm studies , </S>",
    "<S> it is customary to obtain the scale of the force constants by fitting the predicted thermal displacements of each atom to the experimental mean square fluctuations @xmath0 measured as temperature factors ( b - factors ) in x - ray crystallography . </S>",
    "<S> this approach is based on the implicit assumption that the atomic displacements underlying crystallographic b - factors result mainly from motions due to internal degrees of freedom . </S>",
    "<S> however , it has been known for a long time that the b - factors are mainly influenced by rigid - body motions taking place in the crystal @xcite . </S>",
    "<S> on the other hand , crystallised macromolecules experience a different environment than when isolated in solution , and the contacts established with neighbouring molecules in the crystal have also been shown to affect the normal modes of motion @xcite . </S>",
    "<S> several studies , in which crystal contacts were modelled explicitly , did however come to the conclusion that these contacts only weakly perturbate the internal dynamics of the protein , while the anisotropic temperature factors are dominated by rigid - body motions of the protein @xcite . </S>",
    "<S> soheilifard et al . </S>",
    "<S> @xcite , and later lezon @xcite , proposed to improve the fit of b - factors by considering the amplitudes of rigid - body motions via six additional fitting parameters </S>",
    "<S> . however , the proposed fits are not complete , because ten parameters are necessary for a full representation of the thermal fluctuations due to rigid - body motions @xcite .    </S>",
    "<S> it is in principle straightforward to perform a complete fit of b - factors using 10 free parameters corresponding to rigid - body motions , plus one free parameter that rescales the internal motions predicted by the enm , which is equal to the inverse of the force constant . in general </S>",
    "<S> , there is however a high level of collinearity between the variables describing internal motions and rigid - body rotations . </S>",
    "<S> a fit of b - factors that fully accounts for rigid - body motions runs therefore a significant risk of overfitting and must be carefully regularized . </S>",
    "<S> ridge regression @xcite is one of the most common methods for regularizing fits with many variables . </S>",
    "<S> it relies heavily on the choice of an adequate value for the ridge parameter but , although several criteria have been proposed for that purpose @xcite , there is no consensus on how to systematically determine the optimal value of this parameter . in this paper , we propose two new criteria for choosing the ridge parameter , based on the analogy between ridge regression and statistical mechanics . </S>",
    "<S> we call maximum penalty ( mp ) or specific - heat ( cv ) fit the ridge regression performed with either choice of the ridge parameter . </S>",
    "<S> we show that the mp fit yields close to optimal results when rigid - body motions account for a fraction of the fluctuations close to that estimated for x - ray structures , while the cv fit is more robust to the amplitude of rigid - body fluctuations . </S>",
    "<S> in contrast , other widely used approaches , such as the generalized cross - validation ( gcv ) criterion @xcite , fail to provide a sufficient level of regularization . </S>",
    "<S> the programs for performing the mp and cv fits and computing the force constants within the enm are available on request . </S>"
  ]
}