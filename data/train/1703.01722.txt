{
  "article_text": [
    "density functional theory ( dft ) @xcite is widely used ab - initio method ( no empirical or adjustable parameters ) for understanding and predicting a diverse range of materials properties . the main computational bottleneck in dft simulations",
    "is the calculation of the eigenfunctions and eigenvalues corresponding to the occupied spectrum of the kohn - sham eigenproblem .",
    "since these eigenfunctions  number proportional to the number of atoms @xmath5need to be orthogonal , the overall computational complexity of dft calculations is @xmath6 @xcite , which severely restricts the size of systems that can be studied .    in order to overcome the @xmath6 scaling bottleneck , a number of real - space solution strategies have been developed over the past two decades that scale as @xmath0 ( see , e.g. , @xcite and references therein ) , with mature implementations of the key ideas now available @xcite .",
    "these approaches circumvent the calculation of the kohn - sham orbitals and directly determine the quantities of interest like electron density , energy , and atomic forces .",
    "however , nearly all of the developed @xmath0 techniques assume the presence of a bandgap in the electronic structure , which makes them unsuitable for the study of metallic systems @xcite as well as systems that undergo transition between insulating and metallic @xcite .    a key property exploited by @xmath0 methods is the _ nearsightedness principle _ @xcite , i.e. , the locality of electronic interactions in real - space .",
    "this manifests itself in the exponential decay of the real - space density matrix for insulators as well as metallic systems at finite electronic temperature / occupation - smearing @xcite .",
    "the truncation that can be employed in practice , while maintaining the desired accuracy , determines the prefactor of @xmath0 methods as well as the system sizes at which linear scaling can be achieved in practical calculations .",
    "while this has been studied previously for insulators @xcite , the dependence of truncation region size on smearing for a given accuracy in metallic systems has not been carefully studied heretofore @xcite .    in this work ,",
    "we employ the recently developed @xmath0 spectral quadrature ( sq ) method @xcite  identically applicable to both insulating and metallic systems  to study the locality of electronic interactions in aluminum ( a prototypical metallic system ) for various smearings .",
    "we find that the convergence of energy and atomic forces with truncation region size is exponential , with an associated rate whose growth increases with smearing , while remaining sub - linear .",
    "notably , truncation region sizes of @xmath2 bohr are required to achieve chemical accuracy for typical smearing values of @xmath3 ha .",
    "we also find through comparison with lithium and molybdenum that the difference in truncation region sizes for various metallic systems is likely to be consequence of the difference in the prefactor rather than the convergence rate .",
    "the remainder of this paper is organized as follows .",
    "we outline @xmath0 dft in section [ sec : ondft ] and the clenshaw - curtis sq method in section [ sec : ccsqdft ] .",
    "next , we study the nearsightedness of aluminum in the context of practical @xmath0 dft calculations in section [ sec : results ] .",
    "finally , we provide concluding remarks in section [ sec : conclusions ] .",
    "in density functional theory ( dft ) , the kohn - sham eigenproblem can be rewritten as @xcite @xmath7 where @xmath8 is the density matrix , @xmath9 is the fermi - dirac function , @xmath10 is the fermi level , @xmath11 is value of the smearing , and @xmath12 is the hamiltonian : @xmath13 above , @xmath14 is the exchange - correlation potential , @xmath15 is the electrostatic potential , and @xmath16 is the nonlocal pseudopotential .",
    "the electrostatic potential @xmath15 is the solution of the poisson equation @xcite @xmath17 where @xmath18 denotes the position of the nuclei , @xmath19 is the electron density , and @xmath20 is the total pseudocharge density of the nuclei . the fermi level @xmath10 is determined by solving for the constraint on the total number of electrons , i.e. , @xmath21 , where @xmath22 denotes the trace .",
    "once the electronic ground - state has been determined , the free energy takes the form @xcite @xmath23 where @xmath24 is the exchange - correlation energy , @xmath25 is the self energy associated with the pseudocharges , and @xmath26 is the electrostatic correction for overlapping pseudocharges .",
    "thereafter , the force on the @xmath27 nucleus can be written as @xcite @xmath28 where the summation index @xmath29 runs over the @xmath27 atom and its periodic images , @xmath30 is the pseudocharge density of the @xmath27 nucleus that generates the potential @xmath31 , @xmath32 is the electrostatic force correction arising from overlapping pseudocharges , and @xmath33 is the nonlocal pseudopotential associated with the atom .",
    "the real - space density matrix has exponential decay for insulators as well as metallic systems at finite temperature @xcite .",
    "linear - scaling methods exploit this property for the @xmath0 calculation of the ground - state electron density , energy and atomic forces given in eqns .",
    "[ eqn : selfcons : densitymatrix ] , [ dm : groundstate ] , and [ eqn : forces ] , respectively .",
    "note that in the above description for dft , we have employed a local reformulation of the electrostatics @xcite to enable @xmath0 scaling for the complete dft problem .",
    "the clenshaw - curtis spectral quadrature ( sq ) method is an @xmath0 technique for performing density functional theory ( dft ) calculations that is identically applicable to both insulating and metallic systems @xcite . it has been formulated in terms of the finite - difference discretization in order to exploit the locality of electronic interactions in real space , enable systematic convergence , and facilitate large - scale parallel implementation .",
    "in the sq method , the quantities of interest are expressed as bilinear forms or sums over bilinear forms , which are then approximated by spatially localized clenshaw - curtis quadrature rules . in doing so , the two additional parameters introduced into the calculation are the order of quadrature ( @xmath34 ) and the size of the truncation region ( @xmath35 ) .    as an example , in each iteration of the self - consistent field ( scf ) method , the electron density at the @xmath36 finite - difference node is written as @xmath37 where @xmath38 is the mesh - size ; @xmath39 is a column vector with the only non - zero entry being @xmath40 in the @xmath36 position ; @xmath41 is the restriction of @xmath39 to the truncation region of the @xmath36 node ; @xmath42 is the nodal hamiltonian ",
    "restriction of the hamiltonian to the truncation region of the @xmath36 node  which is scaled and shifted such that its spectrum lies in @xmath43 $ ] ; and @xmath44 are the chebyshev expasion coefficients for the function @xmath9 , with the fermi level @xmath10 chosen to satisfy the constraint on the total number of electrons , i.e. , @xmath45 similarly , the band structure energy , electronic entropy , and nonlocal component of the atomic force can be expressed in terms of nodal quantities , details of which can be found in previous work @xcite . when combined with a local reformulation of the electrostatics @xcite ,",
    "the sq method enables the @xmath0 evaluation of the electron density , energy , and atomic forces for insulating as well as metallic systems .    in this work",
    ", we employ the _ infinite - cell _ version of the sq method , wherein the results corresponding to the infinite crystal are obtained without recourse to brillouin zone integration or large supercells @xcite .",
    "specifically , rather than employ bloch boundary conditions on the orbitals in the unit cell , zero - dirichlet ( or equivalently periodic ) boundary conditions are prescribed at infinity , and the relevant components of the density matrix associated with any spatial point within the unit cell are calculated by utilizing the potential within the truncation region surrounding that point .",
    "this is theoretically equivalent to the calculation of the density matrix in all of space while employing truncation in a region of size @xmath46 throughout the @xmath0 method , and then utilizing the components of the density matrix corresponding to the spatial points within the unit cell for the calculation of the electron density , energy , and atomic forces .",
    "in this section , we utilize the spectral quadrature ( sq ) method to study the nearsightedness of matter in the context of practical @xmath0 density functional theory ( dft ) calculations .",
    "we focus on aluminum in this work , since it is a prototypical metallic system . within dft",
    ", we utilize the perdew - wang parametrization @xcite of the correlation energy calculated by ceperley - alder @xcite and norm - conserving troullier - martins pseudopotentials @xcite .",
    "we accelerate the convergence of the self - consistent field ( scf ) method using the periodic pulay mixing scheme @xcite with restarts @xcite . in each scf iteration",
    ", we solve the poisson equation for the electrostatic potential using the alternating anderson - jacobi ( aaj ) method @xcite and determine the fermi level using brent s method .    in all the simulations , we utilize a twelfth - order finite - difference discretization with mesh - size",
    "@xmath38 chosen such that the energy and atomic forces are converged  with respect to highly converged plane - wave results computed by abinit @xcite as well as real - space results computed using sparc @xcite  to within @xmath47 ha / atom and @xmath47 ha / bohr , respectively .",
    "we choose the quadrature order within the sq method so that the resulting errors in the energy and atomic forces are within @xmath48 ha / atom and @xmath48 ha / bohr , respectively . here and below",
    ", the error in the energy and atomic forces denotes the magnitude of the difference and the maximum difference in any component , respectively .",
    "in addition , all coordinates are defined with respect to the origin located at the corner of the unit cell .",
    "we consider a @xmath49-atom face - centered cubic ( fcc ) unit cell of aluminum at the equilibrium lattice constant of @xmath50 bohr , with the atom located at [ @xmath51 @xmath51 @xmath52 bohr moved to [ @xmath53 @xmath54 @xmath55 bohr .",
    "in addition , we choose the following values for the smearing : @xmath56 , @xmath57 , @xmath58 , @xmath59 , @xmath60 , and @xmath61 ha .",
    "these values encompass the wide range of temperatures encountered in density functional theory ( dft ) calculations , ranging from ambient to warm dense matter @xcite .    in fig .",
    "[ fig : error : smearing ] , we plot the variation of the error in the energy and atomic forces as a function of @xmath62 for the aforementioned values of smearing .",
    "the results obtained by sparc @xcite ( via diagonalization ) for the same mesh - size and finite - difference order are used as reference .",
    "we observe that there is exponential convergence in the energy and atomic forces at all smearings , with relatively minor variations between @xmath63 ha .",
    "next , we fit the above data to the function @xmath64 where @xmath65 denotes the convergence rate , and @xmath66 is the associated prefactor . in fig . [",
    "fig : pre : rate : smearing ] , we plot the values of @xmath67 and @xmath68values of @xmath66 and @xmath65 averaged between the energy and atomic forces  as a function of @xmath11 .",
    "we observe that both @xmath67 and @xmath68 increase monotonically as @xmath11 is increased , with similar rates ( @xmath69 and @xmath70 ) .",
    "overall , we conclude that the convergence in the energy and atomic forces with truncation region size is exponential , with the rate demonstrating a growth that increases with smearing , while remaining sub - linear .    in previous theoretical work @xcite",
    ", it has been predicted that for finite values of smearing , the density matrix has exponential decay with a rate that increases linearly ( an upper bound ) with the smearing @xcite . though we obtain exponential convergence of the energy and atomic forces , the mathematical results are not directly applicable in the context of an @xmath0 method .",
    "this is because of the continuous truncation of the density matrix ( explicitly or implicitly ) throughout the @xmath0 approach , rather than truncation once the complete density matrix is calculated . in order to verify this , we plot in fig .",
    "[ fig : decay : dm ] the components of the density matrix associated with the spatial points @xmath71 $ ] bohr and @xmath72 $ ] bohr for @xmath73 ha and @xmath74 ha . and @xmath75 are representative of other spatial points within the unit cell . ]",
    "the decay rates of @xmath76 at these smearings are @xmath77 and @xmath78 , respectively .",
    "the corresponding rates for @xmath75 are @xmath77 and @xmath79 , respectively . however , the associated convergence rates of the energy and forces in the @xmath0 sq method are @xmath80 and @xmath81 , respectively .",
    "these results indicate that the variation in the decay rate of the density matrix with smearing is not in exact correspondence with the convergence of energy and atomic forces in an @xmath0 method .",
    "the smearing is typically chosen to correspond to the physical temperature in the dft simulation . however , in order to improve the efficiency and stability of the calculations , this constraint can be relaxed .",
    "specifically , a larger smearing can be chosen , while maintaining the desired accuracy in the energy and forces .",
    "for example , consider the reference energy and forces at the various smearings for the aluminum system listed in table [ table : energy : force ] .",
    "it is clear that the results for @xmath74 ha provide a good approximation to those at @xmath73 ha . though the truncation region size that needs to be chosen at these two smearings is not noticeably different ( fig . [",
    "fig : error : smearing ] ) , close to an order of magnitude speedup can be obtained due to the reduction in the quadrature order ( @xmath34 ) required within the sq method",
    ".    .reference energy and atomic forces for the aluminum system at various values of smearing ( @xmath11 ) . [ cols=\"^,^,^,^,^,^\",options=\"header \" , ]     another option to relax the constraint on the physical temperature is to employ alternate smearing functions , e.g. gaussian smearing @xcite , wherein @xmath82 @xmath83 being the complementary error function . since @xmath83 is steeper than the fermi - dirac function , larger values of smearing can be employed , e.g. gaussian smearing with @xmath84 ha provides similar accuracy as fermi - dirac smearing with @xmath74 ha , while considering the fermi - dirac smearing with @xmath73 ha as reference . in fig .",
    "[ fig : erfc : fd ] , we present the convergence of the energy and atomic forces with @xmath62 for the fermi - dirac and gaussian smearing functions .",
    "we observe similar convergence for both choices , with no noticeable gain from the ability to choose a larger value of @xmath11 in gaussian smearing .",
    "however , a lower value of quadrature can be employed in sq , mainly because @xmath83 is an entire function in the complex plane @xcite . overall , relaxing of the constraint on the physical temperature does not have any significant influence on the required truncation region size , but can provide improvement in the efficiency of the calculations because of the enhanced smoothness of the smearing function .",
    "we now compare the results obtained for aluminum with lithium and molybdenum for a smearing of @xmath85 ha and @xmath86 ha , respectively .",
    "we consider a @xmath87-atom body - centered cubic ( bcc ) unit cell of lithium at equilibrium lattice constant of @xmath88 bohr , with the atom positioned at [ @xmath89 @xmath89 @xmath89 ] bohr moved to [ @xmath91 @xmath92 @xmath93 bohr ; and @xmath87-atom bcc unit cell of molybdenum at equilibrium lattice constant of @xmath94 bohr , with the atom located at [ @xmath95 @xmath95 @xmath95 ] bohr moved to [ @xmath97 @xmath98 @xmath99 bohr .",
    "we employ mesh - sizes of @xmath100 and @xmath101 bohr for the lithium and molybdenum systems , respectively , which results in energy and forces that are with respect to highly accurate plane - wave results to within @xmath47 ha / atom and @xmath47 ha / bohr , respectively .    in fig .",
    "[ fig : comparison_al_li_mo ] , we present the error  defined with respect to the results obtained by sparc @xcite via diagonalization at the same mesh - size and finite - difference order  in the energy and atomic forces as a function of the truncation region size ( @xmath46 ) for the aforedescribed aluminum , lithium , and molybdenum systems .",
    "we observe that the convergence rate for lithium and molybdenum is very similar to that of aluminum .",
    "however , the associated prefactors are noticeably different , particularly in the case of the atomic forces .",
    "these results indicate that for a given smearing , the difference in the truncation region sizes required for achieving a desired accuracy in various metallic systems is likely to be consequence of the difference in the prefactor rather than the convergence rate .      the implication of the above results on practical @xmath0 dft calculations for metallic systems merits further consideration . for aluminum , with",
    "generally used smearing of @xmath102 ha , we have found that truncation regions of size @xmath103 bohr are required to achieve chemical accuracy of @xmath104 ha / atom and @xmath104 ha / bohr in the energy and atomic forces , respectively .",
    "consequently , @xmath0 scaling can be achieved in practical calculations only for domain sizes larger than @xmath2 bohr , which translates to aluminum systems of @xmath4 atoms .",
    "indeed , the quantitative features of these results depend on the nature of the metallic system , as shown in the previous subsection .",
    "finally , we note that the extremely rapid convergence of the energy and atomic forces with @xmath62 for relatively large values of smearing suggests that non - orbital based @xmath0 methods like sq are an extremely attractive choice for high - temperature simulations .",
    "for example , at @xmath105 ha smearing , truncation regions of size @xmath106 bohr are sufficient to achieve an accuracy of @xmath104 ha / atom and @xmath104 ha / bohr in the energy and atomic forces , respectively .",
    "this also suggests that orbital - free dft @xcite@xmath0 theory in which the electronic kinetic energy is approximated with a functional of the electron density  becomes a better approximation to dft at higher temperatures @xcite , since the electronic kinetic energy can be expressed as the trace of the product of the density matrix with the hamiltonian .",
    "we have investigated the nearsightedness of electronic interactions in aluminum as a function of the smearing / electronic temperature in the context of @xmath0 density functional theory ( dft ) calculations .",
    "in particular , we have determined the variation of the error in the energy and atomic forces as a function of the truncation region size for smearing values of @xmath1 ha .",
    "we have found that the convergence is exponential , with a rate whose growth increases with smearing , while remaining sub - linear . in particular , truncation regions of size @xmath2 bohr are required to achieve chemical accuracy for typically used smearing values of @xmath3 ha .",
    "we have also found through comparison with lithium and molybdenum that the difference in truncation region sizes for various metallic systems is likely to be consequence of the difference in the prefactor rather than the convergence rate .",
    "this translates to very large prefactors for linear - scaling methods at moderate system sizes , and @xmath0 scaling in practical calculations only for systems larger than @xmath4 atoms .",
    "this work was performed under the auspices of the u.s .",
    "department of energy by lawrence livermore national laboratory under contract de - ac52 - 07na27344 .",
    "we gratefully acknowledge support from the laboratory directed research and development program .",
    "we also acknowledge the valuable and insightful discussions with john e. pask , and the help of swarnava ghosh and phanisri p. pratapa in performing some of the simulations relevant to this work .    49 natexlab#1#1[2]#2 , , ( ) .",
    ", , , , , . , ( ) . , , ( ) .",
    ", , , , , , , ( ) . , , , , ( ) .",
    ", , , , ( ) . , ( ) .",
    ", , , , , , , ( ) .",
    "openmx : www.openmx-square.org , .",
    ", , , , , , , , , , , .",
    ", , ( ) . , ( ) .",
    ", , , , , ( ) . , , , ( ) .",
    ", , , ( ) . , , ( ) .",
    ", , , , ( ) . , ( ) .",
    ", , , ( ) . , , ( ) . , , ( ) .",
    ", , , , , ( ) . , , , ( ) .",
    ", , , ( ) . , ,",
    "( ) . , , , ( ) . , , ( )",
    ", , , ( ) . , , ( ) .",
    ", , , ( ) . , , , ( ) .",
    ", , , , , , , , , , , , , , , , ( ) .",
    ", , , , , , ( ) .",
    ", , in : ( ed . )",
    ", , volume   of _ _ , , , pp . .",
    ", , , , , , ( ) ."
  ],
  "abstract_text": [
    "<S> we investigate the locality of electronic interactions in aluminum as a function of smearing / electronic temperature in the context of @xmath0 density functional theory calculations . </S>",
    "<S> specifically , we determine the convergence in energy and atomic forces with truncation region size for smearing of @xmath1 ha . we find exponential convergence accompanied by a rate that increases sub - linearly with smearing , with truncation region sizes of @xmath2 bohr required to achieve chemical accuracy for typical smearing values of @xmath3 ha . </S>",
    "<S> this translates to @xmath0 scaling for systems larger than @xmath4 atoms .    </S>",
    "<S> linear - scaling , metallic systems , truncation region size , smearing , density matrix decay </S>"
  ]
}