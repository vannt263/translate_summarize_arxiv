{
  "article_text": [
    "kohn - sham density functional theory ( dft ) @xcite has a relatively high accuracy / cost ratio , which makes it a popular electronic structure method for predicting material properties and behavior . in dft ,",
    "the system of interacting electrons is replaced with a system of non - interacting electrons moving in an effective potential @xcite .",
    "the electronic ground - state in dft is typically determined by solving for the kohn - sham orbitals , the number of which is commensurate with the size of the system , i.e. number of electrons @xcite . since these orbitals need to be orthonormal , the overall solution procedure scales cubically with the number of atoms @xcite . in order to overcome this restrictive scaling ,",
    "significant research has focused on the development of linear - scaling methods @xcite .",
    "nearly all of these approaches , in one form or the other , employ the decay of the density matrix @xcite in conjunction with truncation to achieve linear - scaling @xcite .",
    "however , an efficient linear - scaling algorithm for metallic systems at low temperatures still remains an open problem @xcite .",
    "orbital - free dft ( of - dft ) represents a simplified version of dft , wherein the electronic kinetic energy is modeled using a functional of the electron density @xcite .",
    "commonly used kinetic energy functionals include the thomas - fermi - von weizsacker ( tfw ) @xcite , wang - teter ( wt ) @xcite , and wang , govind & carter ( wgc ) @xcite variants . amongst these ,",
    "the wt and wgc functionals are designed so as to match the linear - response of a homogeneous electron gas @xcite .",
    "previous studies have shown that of - dft is able to provide an accurate description of systems whose electronic structure resembles a free - electron gas , e.g. aluminum and magnesium @xcite .",
    "there have been recent efforts to extend the applicability of of - dft to covalently bonded materials @xcite as well as molecular systems @xcite .",
    "in essence , of - dft can be viewed as a ` single - orbital ' version of dft , wherein the cubic - scaling bottleneck arising from orthogonalization is no longer applicable .",
    "in addition , of - dft possesses an extremely favorable scaling with respect to temperature compared to dft @xcite .",
    "overall , of - dft has the potential to enable electronic structure calculations for system sizes that are intractable for dft .",
    "the plane - wave basis is attractive for performing of - dft calculations @xcite because of the spectral convergence with increasing basis size and the efficient evaluation of convolutions using the fast fourier transform ( fft ) @xcite .",
    "however , developing implementations which can efficiently utilize modern large - scale , distributed - memory computer architectures is particularly challenging .",
    "further , evaluation of the electrostatic terms within the plane - wave basis typically scales quadratically with the number of atoms @xcite . in view of this",
    ", recent efforts have been directed towards developing real - space approaches for of - dft , including finite - differences @xcite and finite - elements @xcite . amongst these",
    ", the finite - element method provides the flexibility of an adaptive discretization .",
    "this attribute has been employed to perform all - electron calculations @xcite and to develop a coarse - grained formulation of of - dft for studying crystal defects @xcite .",
    "however , higher - order finite - differences  shown to be extremely efficient in non - periodic of - dft with the tfw kinetic energy functional @xcite  remain unexplored in the context of periodic of - dft simulations , particularly when linear - response kinetic energy functionals like wt and wgc are employed .    the electronic ground state in of - dft",
    "can be expressed as the solution of a non - linear , constrained minimization problem @xcite .",
    "the approaches which have previously been employed to solve this problem include variants of conjugate - gradient @xcite and newton @xcite methods . in these approaches , the techniques used to enforce the constraints include lagrange multipliers @xcite , the penalty method @xcite and the augmented - lagrangian method @xcite . in this work ,",
    "we present a local real - space formulation and implementation of periodic of - dft .",
    "in particular , we develop a fixed - point iteration with respect to the kernel potential for simulations involving linear - response kinetic energy functionals . we develop a parallel implementation of the formulation using higher - order finite - differences .",
    "we demonstrate the robustness , efficiency and accuracy of the proposed approach through selected examples , the results of which are compared against existing plane - wave methods .    the remainder of this paper is organized as follows .",
    "we introduce of - dft in section [ sec : ofdft ] and discuss its real - space formulation in section [ sec : formulation ] .",
    "subsequently , we describe the numerical implementation in section [ section : numericalimplementation ] , and validate it through examples in section [ section : examples ] .",
    "finally , we conclude in section [ section : conclusions ] .",
    "consider a charge neutral system of @xmath0 atoms and @xmath1 electrons in a cuboidal domain @xmath2 under periodic boundary conditions .",
    "let @xmath3 denote the positions of the nuclei with charges @xmath4 respectively .",
    "the energy of this system as described by of - dft is @xcite @xmath5 where @xmath6 , @xmath7 being the electron density . introducing the parameters @xmath8 and @xmath9 so that different variants of the electronic kinetic energy @xmath10 can be encompassed within a single expression ,",
    "we can write @xmath11 where @xmath12 is the thomas - fermi energy @xcite , @xmath13 is the von weizsacker @xcite term and @xmath14 is a non - local kernel energy incorporated to make the kinetic energy satisfy the linear - response of a homogeneous electron gas @xcite . they can be represented as @xmath15 where @xmath16 and @xmath17 are parameters , and the constant @xmath18 . on the one hand , the thomas - fermi - von weizsacker ( tfw ) family of functionals with the adjustable parameter @xmath8",
    "is obtained by setting @xmath19 @xcite . on the other hand , kinetic energy functionals which satisfy the lindhard susceptibility function",
    "are obtained by setting @xmath20 with appropriate choices of @xmath16 , @xmath17 and the kernel @xmath21 @xcite . in particular ,",
    "the wang & teter ( wt ) functional @xcite utilizes a density independent kernel , whereas the wang , govind & carter ( wgc ) functional @xcite employs a density dependent kernel .",
    "it is common to perform a taylor series expansion of the density dependent kernel @xmath21 about the average electron density @xmath22 @xcite .",
    "on doing so , we arrive at @xmath23 where @xmath24 is the order of the expansion , the coefficients @xmath25 and the kernels @xmath26    the second term in eqn .",
    "[ eqn : energy : ofdft ] is referred to as the exchange - correlation energy .",
    "it is generally modeled in of - dft using the local density approximation ( lda ) @xcite : @xmath27 where @xmath28 is the sum of the exchange and correlation per particle of a uniform electron gas of density @xmath29 . employing the perdew - zunger @xcite parameterization of the correlation energy calculated by ceperley - alder @xcite",
    ", the exchange and correlation functionals can be represented as @xmath30 where @xmath31 , and the constants @xmath32 , @xmath33 , @xmath34 , @xmath35 , @xmath36 , @xmath37 and @xmath38 .",
    "the final three terms in eqn .",
    "[ eqn : energy : ofdft ] represent electrostatic energies @xcite . in periodic systems",
    ", they can be expressed as @xmath39 where the summation indices @xmath40 and @xmath41 run over all atoms in @xmath42 and @xmath2 , respectively .",
    "the hartree energy @xmath43 is the classical interaction energy of the electron density , @xmath44 is the potential due to the nucleus positioned at @xmath45 , @xmath46 is the interaction energy between the electron density and the nuclei , and @xmath47 is the repulsion energy between the nuclei .",
    "the ground state of the system in of - dft is given by the variational problem @xcite @xmath48 where @xmath49 is some appropriate space of periodic functions and @xmath50 represents the constraint on the total number of electrons .",
    "the inequality constraint @xmath51 is to ensure that @xmath52 is nodeless , i.e. @xmath52 does not change sign . in this work ,",
    "we focus on developing a local formulation and higher - order finite - difference implementation for determining the ground - state in periodic of - dft simulations .",
    "in this section , we develop a framework for periodic of - dft that is amenable to a linear - scaling real - space implementation .",
    "first , we present a local description of the kernel energy and potential in section [ subsec : localreformulationvlr ] .",
    "next , we discuss how the electrostatics can be rewritten into local form in section [ subsec : electrostaticreformulation ] . finally , we describe the methodology for determining the of - dft ground - state in section [ subsec : groundstate ] .      in simulations where linear - response kinetic energy functionals are employed ,",
    "the kernel energy @xmath14 as well as the kernel potential @xmath53 \\,,\\end{aligned}\\ ] ] are inherently non - local in real - space . in order to enable a linear - scaling implementation , we start by defining the potentials @xmath54 after approximating the kernels @xmath55 in fourier space using rational functions @xcite , we arrive at @xmath56 where @xmath57 and @xmath58 are solutions of the helmholtz equations @xmath59 under periodic boundary conditions and appropriate choice of complex constants @xmath60 and @xmath61 . above ,",
    "@xmath62 and @xmath63    thereafter , the kernel potential @xmath64 and the corresponding kernel energy @xmath14 can be calculated in linear - scaling fashion using the expressions @xmath65 \\ , , \\label{eqn : vlinearresponse : local } \\\\",
    "t_{lr}(u ) & = & \\frac{1}{2}c_f \\sum_{m=0}^{l } \\sum_{n=0}^{l } \\sum_{p=0}^m \\sum_{q=0}^n   \\sum_{r=1}^r c_{mnpq } \\int_{\\omega } \\bigg [ u^{2(m - p+\\alpha)}(\\bx ) v_{mnq\\beta r}(\\bx )    +   u^{2(n - q+\\beta)}(\\bx ) v_{mnp\\alpha r}(\\bx ) \\bigg ] \\ ,",
    "\\mathrm{d\\bx } \\nonumber \\\\ \\end{aligned}\\ ] ] where @xmath57 and @xmath58 are solutions of the helmholtz equations given in eqns .",
    "[ eqn : helmholtz : beta ] and [ eqn : helmholtz : alpha ] , respectively .",
    "the electrostatic energies in eqns .",
    "[ eqn : eh ] , [ eqn : eext ] and [ eqn : ezz ] are non - local in real - space .",
    "moreover , they are individually divergent in periodic systems . to overcome this , we introduce the charge density of the nuclei @xcite : @xmath66 where @xmath67 is the charge density of the @xmath68 nucleus , and the summation index @xmath69 runs over all atoms in @xmath42 . in of - dft calculations , it is common to remove the core electrons and replace the singular coulomb potential with an effective potential @xmath70 , referred to as the pseudopotential approximation @xcite .",
    "the absence of orbitals in of - dft requires that the pseudopotential be local , i.e. @xmath70 depends only on the distance from the nucleus . since the pseudopotential replicates the coulomb potential outside the core cutoff radius @xmath71 , @xmath67 has a compact support within a ball of radius @xmath71 centered at @xmath72 @xcite .",
    "it follows that @xmath73    using the above definition for the charge densities , we can rewrite the total electrostatic energy as the following variational problem @xmath74 where @xmath75 is the electrostatic potential , @xmath76 is some appropriate space of periodic functions , the second last term accounts for the self energy of the nuclei and the last term corrects for overlapping charge densities .",
    "a detailed discussion on the nature of @xmath77 and its evaluation can be found in appendix [ appendix : correct : repulsiveenergy ] . with this reformulation of the total electrostatic energy , we arrive at the variational problem @xmath78 where the functional @xmath79      in the framework described above , the variational problem for determining the ground - state in of - dft can be written as @xmath80 where @xmath81 through this decomposition",
    ", the ground - state can be ascertained by solving the electronic structure problem in eqn .",
    "[ eqn : groundstateelectronic ] for every configuration of the nuclei encountered during the geometry optimization described by eqn .",
    "[ eqn : groundstatesplit ] .",
    "below , we discuss the solution strategy for both of these simulation components .",
    "consider the variational problem in eqn .",
    "[ eqn : groundstateelectronic ] for determining the electronic ground - state .",
    "on taking the first variation , we arrive at the euler - lagrange equation @xmath82 where @xmath64 is as given by eqn .",
    "[ eqn : vlinearresponse : local ] , and @xmath83 is the lagrange multiplier used to enforce the constraint @xmath84 .",
    "further , @xmath75 is the solution of the poisson equation @xmath85 under periodic boundary conditions and @xmath86 the exchange - correlation potential @xmath87 can be decomposed as @xmath88 with @xmath89 and @xmath90 being the exchange and correlation potentials , respectively .",
    "even though the notation does not make it explicit , the dependence of @xmath91 on @xmath52 makes eqn .",
    "[ eqn : eulerlagrange ] a non - linear problem .",
    "it is worth noting that since @xmath92 , the poisson problem defined by eqn .",
    "[ eqn : poisson ] with periodic boundary conditions is well - posed .",
    "the electronic ground - state can be determined by solving the non - linear eigenvalue problem in eqn .",
    "[ eqn : eulerlagrange ] for the eigenfunction corresponding to the lowest eigenvalue .",
    "irrespective of the solution technique and choice of kinetic energy functional , @xmath75 needs to be recalculated for every update in @xmath93 .",
    "the same is true for @xmath64 when linear - response kinetic energy functionals are employed .",
    "therefore , the solution of eqn .",
    "[ eqn : eulerlagrange ] requires the repeated solution of the poisson equation in eqn .",
    "[ eqn : poisson ] and the complex - valued non - hermitian helmholtz equations in eqns .",
    "[ eqn : helmholtz : beta ] and [ eqn : helmholtz : alpha ] . in view of this , the self - consistent field method ( scf ) @xcite  commonly utilized in dft calculations  is an attractive choice because relatively few iterations are typically required for convergence .",
    "however , we have found such an approach to be unstable for both the tfw and wgc kinetic energy functionals , especially as the system size is increased . since the number of helmholtz equations that need to be solved can be significantly large in practice ( e.g. fifty - two in this work ) , they are expected to completely dominate the execution time . in order to mitigate this , we develop a fixed - point method for determining the electronic ground - state when linear response kinetic energy functionals are employed @xcite .",
    "this is similar in spirit to the scf method , and is found to converge rapidly , as demonstrated by the examples in section [ section : examples ] .",
    "we rewrite the nonlinear eigenvalue problem in eqn .",
    "[ eqn : eulerlagrange ] as a fixed - point problem with respect to @xmath64 : @xmath94 \\ , , \\label{eqn : fixedpoint : map1}\\ ] ] where the mappings @xmath95 and @xmath96 & = & c_f \\sum_{m=0}^{l } \\sum_{n=0}^{l } \\sum_{p=0}^m \\sum_{q=0}^n   \\sum_{r=1}^r   c_{mnpq } \\bigg [ ( m - p+\\alpha )   u^{2(m - p+\\alpha-1)}(\\bx ) v_{mnq\\beta r}(\\bx ) \\ , \\nonumber \\\\ & + & ( n - q+\\beta ) u^{2(n - q+\\beta-1)}(\\bx ) v_{mnp\\alpha r}(\\bx ) \\bigg ] \\,.\\end{aligned}\\ ] ] above , @xmath57 and @xmath58 are solutions to the helmholtz equations given in eqns . [",
    "eqn : helmholtz : beta ] and [ eqn : helmholtz : alpha ] , respectively .",
    "the mapping @xmath97 corresponds to the solution of the nonlinear eigenvalue problem in eqn .",
    "[ eqn : eulerlagrange ] for a fixed kernel potential @xmath64 .",
    "the mapping @xmath98 $ ] corresponds to the calculation of @xmath64 for some given @xmath93 .",
    "therefore , the fixed - point of the composite mapping @xmath99 $ ] coincides with the solution of the euler - lagrange equation ( eqn .",
    "[ eqn : eulerlagrange ] ) for the electronic ground - state .",
    "in order to solve this fixed - point problem , we treat it as a non - linear equation and adopt an iteration of the form @xcite @xmath100 - v_{lr , k } \\right)\\,,\\ ] ] where the index @xmath101 represents the iteration number and @xmath102 is appropriately chosen to ensure / accelerate convergence .",
    "once the fixed - point @xmath103 has been determined , @xmath104 can be calculated by solving eqn .",
    "[ eqn : mvf ] for @xmath105 . in fig .",
    "[ fig : flowchart ] , we present a flowchart that outlines the aforedescribed fixed - point approach .",
    "it is worth noting that for the choice of tfw kinetic energy functional ( @xmath19 ) , the solution of eqn .",
    "[ eqn : mvf ] coincides with the electronic ground - state .    after determining the electronic ground - state ,",
    "the corresponding energy can be evaluated using the expression @xmath106 \\",
    ", \\mathrm{d\\bx } \\nonumber \\\\ & + & \\int_{\\omega } \\varepsilon_{xc } ( u^*(\\bx ) ) u^{*2}(\\bx ) \\",
    ", \\mathrm{d \\bx } + \\frac{1}{2 } \\int_{\\omega}(u^{*2}(\\bx)+ b(\\bx,\\br ) ) \\phi^{*}(\\bx ) \\ , \\mathrm{d\\bx }   \\nonumber \\\\   & - & \\frac{1}{2}\\sum_{j } \\int_{\\omega } b_j(\\bx,\\br_j ) v_j(\\bx,\\br_j ) \\ , \\mathrm{d\\bx } + \\mathcal{e}_c^*(\\br )    \\,,\\end{aligned}\\ ] ] where @xmath107 , @xmath108 and @xmath109 are solutions of eqns .",
    "[ eqn : helmholtz : beta ] , [ eqn : helmholtz : alpha ] and [ eqn : poisson ] , respectively , for @xmath110 .",
    ".,scaledwidth=100.0% ]      consider the minimization problem in eqn .",
    "[ eqn : groundstatesplit ] for determining the equilibrium configuration of the atoms . during this geometry optimization",
    ", the forces on the nuclei can be calculated using the relation @xmath111 where @xmath112 denotes the force on the @xmath68 nucleus and the summation over @xmath113 signifies the @xmath68 atom and its periodic images .",
    "additionally , @xmath109 is the solution of the poisson equation in eqn .",
    "[ eqn : poisson ] for @xmath114 and @xmath115 corrects for the error in forces due to overlapping charge density of nuclei .",
    "the expression for this correction has been derived in appendix [ appendix : correct : repulsiveenergy ] .",
    "the second equality in eqn . [ eqn : force : nuclei ] is obtained by using the fact that the energy is stationary with respect to @xmath93 and @xmath75 at the electronic ground - state , and the last equality is obtained by using the spherical symmetry of @xmath116 ( i.e. , @xmath117 ) .",
    "since @xmath118 has compact support in a ball of radius @xmath71 centered at @xmath119 , only a finite number of periodic images of the @xmath68 atom have an overlap with @xmath2",
    ". therefore , evaluation of the atomic forces is amenable to a linear - scaling real - space implementation .",
    "in this section , we describe a higher - order finite - difference implementation of the formulation presented in the previous section . we restrict our computation to a cuboidal domain @xmath2 of sides",
    "@xmath120 , @xmath121 and @xmath122 .",
    "we generate a uniform finite - difference grid with spacing @xmath123 such that @xmath124 , @xmath125 and @xmath126 , where @xmath127 , @xmath128 and @xmath129 are natural numbers .",
    "we index the grid points by @xmath130 , where @xmath131 , @xmath132 and @xmath133 .",
    "we approximate the laplacian of any function @xmath134 at the grid point @xmath130 using higher - order finite - differences @xcite @xmath135 where @xmath136 represents the value of the function @xmath134 at the grid point @xmath130 .",
    "the weights @xmath137 are given by @xcite @xmath138 similarly , we approximate the gradient at the grid point @xmath130 using higher - order finite - differences @xmath139 where @xmath140 , @xmath141 and @xmath142 represent unit vectors along the edges of the cuboidal domain @xmath2 .",
    "the weights @xmath143 are given by @xcite @xmath144 these finite - difference expressions for the laplacian and gradient represent @xmath145 order accurate approximations , i.e. error is @xmath146 . while performing spatial integrations , we assume that the function @xmath134 is constant in a cube of side @xmath123 around each grid point , i.e. @xmath147 we enforce periodic boundary conditions on @xmath2 by employing the following strategy . in the finite - difference representations of the laplacian and gradient presented in eqns .",
    "[ eqn : fd : laplacian ] and [ eqn : gradient : approximate ] respectively , we map any index that does not correspond to a node in the finite - difference grid to its periodic image within @xmath2 .",
    "we start with precomputed radially - symmetric and compactly - supported isolated - atom electron densities for each type of atom .",
    "we superimpose these isolated - atom electron densities for the initial configuration of the nuclei , and scale the resulting electron density such that the constraint on the total number of electrons is satisfied .",
    "we take the pointwise square - root of the electron density so obtained as the starting guess @xmath148 . during the aforedescribed calculation , we only visit atoms whose isolated - atom electron densities have non - zero overlap with @xmath2 .",
    "similarly , for every new configuration of atoms encountered during the geometry optimization , we calculate the charge density of the nuclei using the relations @xmath149 where the summation reduces to all atoms whose charge density has non - zero overlap with @xmath2 .",
    "the localized nature of the above operations ensures that the evaluation of @xmath148 and @xmath150 scales linearly with the number of atoms .",
    "we solve the variational problem in eqn .",
    "[ eqn : mvf ] using a conjugate gradient method that was originally developed for dft @xcite and later adopted in simplified form for of - dft @xcite .",
    "specifically , we utilize the polak - ribiere update @xcite with brent s method @xcite for the line - search .",
    "we refer the reader to appendix [ appendix : nlcgteter ] for further details on the implemented algorithm . for every update in the square - root electron density",
    ", we solve the poisson equation in eqn .",
    "[ eqn : poisson ] under periodic boundary conditions using the generalized minimal residual ( gmres ) @xcite method with the block - jacobi preconditioner @xcite .",
    "since the solution so obtained is accurate to within an indeterminate constant , we enforce the condition @xmath151 for definiteness . in every subsequent poisson equation encountered ,",
    "we use the previous solution as starting guess . for the complex - valued helmholtz equations in eqns .",
    "[ eqn : helmholtz : beta ] and [ eqn : helmholtz : alpha ] , we first separate out each equation into its real and imaginary parts , and then solve the resulting coupled equations simultaneously under periodic boundary conditions using gmres with block - jacobi preconditioners . in every iteration of the fixed - point method",
    ", we use the solution of the helmholtz equations from the previous iteration as the starting guess .",
    "we accelerate the convergence of the fixed - point iteration by utilizing anderson mixing @xcite , details of which can be found in appendix [ appendix : anderson ] .",
    "once the electronic ground - state square - root electron density has been determined , the energy and forces are evaluated using eqns .",
    "[ eqn : groundstateenergy ] and [ eqn : force : nuclei ] respectively .",
    "while doing so , we restrict the summation over the periodic images to atoms whose charge densities have non - zero overlap with @xmath2 . we solve for the equilibrium configuration of the atoms by using the conjugate gradient method with the polak - ribiere update and secant line search @xcite .",
    "we have developed a parallel implementation of the proposed approach using the portable , extensible toolkit for scientific computations ( petsc ) @xcite suite of data structures and routines .",
    "within petsc , we have utilized distributed arrays with the star - type stencil option .",
    "the communication between the processors is handled via the message passing interface ( mpi ) @xcite .",
    "in this section , we validate the proposed formulation and higher - order finite - difference implementation of periodic of - dft through selected examples .",
    "henceforth , we shall refer to this framework as rs - fd , which is an acronym for real - space finite - differences .",
    "in all the simulations , we employ the goodwin - needs - heine pseudopotential @xcite .",
    "in addition , we choose @xmath152 for the tfw functional , and @xmath153 , @xmath154 , @xmath155 , @xmath156 and @xmath157 for the wgc functional . wherever applicable",
    ", we compare our results with the plane - wave code profess @xcite . within profess , we utilize a plane - wave energy cutoff of @xmath158 ev , which results in energies and forces that are converged to within @xmath159 ev / atom and @xmath160 ev / bohr respectively . unless specified otherwise , we use sixth - order accurate finite - differences and a mesh size of @xmath161 bohr within rs - fd .",
    "we choose a cutoff radius of @xmath162 bohr for the isolated - atom electron densities as well as the charge densities of the nuclei , whereby the enclosed charge for each nucleus is accurate to within @xmath163 .",
    "we utilize tolerances of @xmath164 and @xmath165 on the normalized residual as the stopping criterion for the conjugate gradient and gmres methods , respectively .",
    "we employ a history of @xmath166 in anderson mixing and a tolerance of @xmath164 on the normalized residual for convergence of the fixed - point method .",
    "these parameters and tolerances result in rs - fd energies and forces that are converged to within @xmath167 ev / atom and @xmath167 ev / bohr , respectively .",
    "it is worth noting that the aforementioned rs - fd tolerances are highly conservative , i.e. chemical accuracies are achieved even when they are significantly relaxed , as discussed in section [ subsec : scalingperformance ] .",
    "we perform all simulations on computer cluster wherein each node has the following configuration : altus 1804i server - 4p interlagos node , quad amd opteron 6276 , 16c , 2.3 ghz , 128 gb , ddr3 - 1333 ecc , 80 gb ssd , mlc , 2.5 \" hca , mellanox connectx 2 , 1-port qsfp , qdr , memfree , centos , version 5 , and connected through infiniband cable .",
    "we start by verifying convergence of the energy computed by rs - fd with respect to the mesh - size ( @xmath123 ) . as the representative example , we choose a @xmath168-atom face - centered cubic ( fcc ) unit cell of aluminum with lattice constant of @xmath169 bohr , and displace the atom at the corner of the unit cell  the origin of the coordinate system  to [ @xmath170 @xmath171 @xmath172 bohr .",
    "we evaluate the energy of this system as a function of @xmath123 for second and sixth - order accurate finite - difference approximations . in fig .",
    "[ fig : convergenceenergy ] , we plot the resulting convergence in energy for the tfw and wgc kinetic energy functionals , with the reference value computed using sixth - order finite - differences and @xmath173 bohr .",
    "we observe that sixth - order finite - differences demonstrates significantly higher rates of convergence compared to second - order finite - differences .",
    "specifically , the sixth - order scheme obtains convergence rates of @xmath174 and @xmath175 for the tfw and wgc functionals , respectively , whereas the second - order discretization obtains rates of @xmath176 and @xmath177 , respectively .",
    "interestingly , the computed convergence rates are not equal to the order of the finite - difference approximation .",
    "possible reasons for this include the nonlinearity of the problem , need for finer meshes to obtain the asymptotic convergence rates , the use of trapezoidal rule for integration , and the  egg - box \" effect .",
    "overall , these results indicate that second - order finite - differences are prohibitively expensive for obtaining the chemical accuracies desired in of - dft calculations , thereby motivating higher - order approximations .     +      next , we verify the convergence of the atomic forces with respect to the mesh - size ( @xmath123 ) .",
    "we choose the same example as that used for studying convergence of the energy in section [ subsec : convergenceenergymesh ] .",
    "we calculate the force on the displaced atom for the tfw and wgc kinetic energy functionals , and plot the resulting error versus @xmath123 in fig . [",
    "fig : convergenceforce ] .",
    "the error is defined to be the maximum difference in the force from that obtained using sixth - order finite - differences with mesh - size of @xmath173 bohr .",
    "we again observe that sixth - order finite - differences demonstrates significantly larger convergence rates compared to second - order finite - differences .",
    "specifically , the convergence rates obtained by the sixth - order scheme for tfw and wgc are @xmath178 and @xmath179 , respectively , whereas the rates for the second - order approximation are @xmath180 and @xmath181 , respectively .",
    "notably , the convergence rates for the force are larger than those obtained for the energy when using a sixth - order discretization . the possible reasons for the convergence rates not matching the finite - difference order are the need for finer meshes for obtaining asymptotic rates , the non - variational nature of the finite - difference approximation , and the  egg - box \" effect .",
    "+    overall , we conclude from the results presented in the previous and current subsection that higher - order finite - differences are necessary for performing accurate and efficient electronic structure calculations based on of - dft",
    ". indeed , larger convergence rates may be possible as the order of the finite - difference approximation is increased .",
    "however , this comes at the price of increased computational cost per iteration due to the reduced locality of the discretized operators and larger inter - processor communication .",
    "we have found sixth - order finite - differences to be an efficient choice , which is in agreement with our previous conclusions for the non - periodic tfw setting @xcite . in view of this",
    ", we will employ sixth - order finite - differences for all the remaining simulations in this work .",
    "we now demonstrate convergence of the fixed - point method for simulations involving the wgc kinetic energy functional . for this study , we choose ( i ) @xmath182-atom system consisting of @xmath183 fcc unit cells of aluminum with lattice constant of @xmath184 bohr ( ii ) @xmath185-atom system consisting of a vacancy in @xmath183 fcc unit cells of aluminum with lattice constant of @xmath184 bohr .",
    "for these two examples , we plot in fig .",
    "[ fig : andersonmixing : mixparam ] the progression of error during the fixed - point iteration .",
    "specifically , we compare the convergence of the basic fixed - point iteration ( i.e. no mixing ) with that accelerated by anderson mixing . within anderson mixing , we choose mixing history size @xmath166 , and mixing parameters @xmath186 and @xmath187 .",
    "we observe that anderson mixing significantly accelerates the convergence of the fixed - point iteration , with the mixing parameter @xmath188 demonstrating the best performance .",
    "we have found these results to be representative of other calculations utilizing the wgc kinetic energy functional . in view of this",
    ", we will utilize anderson mixing with mixing parameter @xmath188 for the remaining simulations in this work .     +    in fig .",
    "[ fig : andersonmixing : mixhist ] , we compare the convergence of the anderson accelerated fixed - point iteration for mixing histories of different sizes . specifically , we choose @xmath166 , @xmath189 , and @xmath190 for this study .",
    "we observe that the size of the mixing history does not have any noticeable impact on the fixed - point iteration .",
    "in fact , the plots of the error versus iteration number in fig . [",
    "fig : andersonmixing : mixhist ] are nearly identical .",
    "overall , we conclude that the fixed - point iteration accelerated with anderson mixing is extremely robust and efficient .",
    "in particular , the error decreases rapidly , and approximately @xmath191 iterations are sufficient to obtain the desired chemical accuracy in energies and forces .",
    "indeed , the energies are converged to within @xmath192 ev / atom and the forces are converged to within @xmath193 ev / bohr for a fixed - point iteration error of @xmath194 in figs . [",
    "fig : andersonmixing : mixparam ] and [ fig : andersonmixing : mixhist ] .",
    "+    in this work , we have proposed a fixed - point problem with respect to @xmath64 for simulations involving linear - response kinetic energy functionals . however , it is also possible to develop an analogous fixed - point problem with respect to @xmath93 . in table",
    "[ table : mixcomparison ] , we compare the performance of the fixed - point iterations with respect to @xmath93 and @xmath64 for the wgc functional . in both cases , we accelerate the iteration using anderson mixing with @xmath166 .",
    "it is clear that the relative performance of the two fixed - point iterations is system dependent .",
    "however , we have found that the iteration with respect to @xmath64 is significantly more robust than the one with @xmath93 .",
    "therefore , we employ the fixed - point iteration with respect to @xmath64 for determining the electronic ground - state in simulations involving linear - response kinetic energy functionals .",
    ".number of steps required to reduce the error to @xmath164 in the fixed - point iterations with respect to @xmath52 and @xmath195 .",
    "anderson mixing with @xmath166 has been employed in both cases .",
    "[ cols=\"^,^,^\",options=\"header \" , ]",
    "in the local reformulation of the electrostatics presented in section [ subsec : electrostaticreformulation ] , the repulsive energy can be expressed as @xmath196 where the second term accounts for the self energy of the nuclei .",
    "using eqn .",
    "[ eqn : b : pseudopotential ] , we arrive at @xmath197 above , the summations indices @xmath40 and @xmath69 run over all atoms in @xmath42 .",
    "if the charge density of the nuclei do not overlap , eqn .",
    "[ eqn : b : ezz ] can be rewritten as @xmath198 which is exactly the expression given in eqn .",
    "[ eqn : ezz ] for the repulsive energy prior to reformulation .",
    "however , the use of relatively ` soft ' pseudopotentials  which are attractive because of the significant reduction in the number of basis functions required for convergence  can frequently result in overlapping charge density of the nuclei .",
    "even in this situation , the repulsive energy in ab - initio calculations is calculated by treating the nuclei as point charges ( i.e. , eqn .",
    "[ eqn : repulsiveenergyappendix ] ) .",
    "since the electrostatic reformulation in this work does make this distinction between overlapping and non - overlapping charge density of the nuclei , we present a technique below that reestablishes agrement .",
    "we start by generating a ` reference ' charge density @xmath199 which is the superposition of spherically symmetric and compactly supported ` reference ' charge densities @xmath200 .",
    "these nuclei - centered charge densities satisfy the relations @xmath201 thereafter , the correction to the repulsive energy can be expressed as @xmath202 a direct computation of this energy correction will scale quadratically with respect to the number of atoms . in order to enable linear - scaling ,",
    "we rewrite eqn .",
    "[ eqn : repulsivecorrection ] as @xmath203 where @xmath204 is the solution to the poisson equation @xmath205 with periodic boundary conditions .",
    "the potential @xmath204 so calculated is accurate to within a constant , which can be determined by evaluating @xmath206 at any point in space .",
    "the correction to the forces on the nuclei @xmath207 can be represented as @xmath208 \\,\\mathrm{d\\bx }   \\nonumber \\\\ & = & \\frac{1}{2 } \\sum_{j ' } \\int_{\\omega } \\bigg [ \\nabla \\tilde{b}_{j'}(\\bx,\\br_{j ' } ) \\left(v_c(\\bx,\\br)- \\tilde{v}_{j'}(\\bx,\\br_{j'})\\right ) + \\nabla b_{j'}(\\bx,\\br_{j ' } ) \\left(v_c(\\bx,\\br)+v_{j'}(\\bx,\\br_{j'})\\right ) \\nonumber \\\\   & & + \\nabla v_{c , j'}(\\bx,\\br_{j ' } ) \\left(\\tilde{b}(\\bx,\\br)+b(\\bx,\\br)\\right ) + b_{j'}(\\bx,\\br_{j ' } ) \\nabla v_{j'}(\\bx,\\br_{j ' } ) - \\tilde{b}_{j'}(\\bx,\\br_{j ' } ) \\nabla \\tilde{v}_{j'}(\\bx,\\br_{j ' } ) \\bigg ] \\,\\mathrm{d\\bx } \\nonumber \\,,\\end{aligned}\\ ] ] where the summation @xmath113 is over @xmath68 atom and its periodic images .",
    "additionally , @xmath209 it is important to note that even with these corrections to the energy and forces , the overall of - dft formulation maintains its linear - scaling nature with respect to the number of atoms .",
    "in algorithm [ algo : nlcg ] , we present the conjugate gradient method implemented in rs - fd to solve the variational problem in eqn .",
    "[ eqn : mvf ] .",
    "this differs from the standard non - linear conjugate gradient method @xcite in that it is able to handle the constraints @xmath84 and @xmath51 .",
    "[ algo : nlcg ] * input * : @xmath210 , @xmath211 , @xmath195 and @xmath212 + @xmath213 + ( ) @xmath214 @xmath215 , where @xmath216 denotes the inner product + @xmath217 + @xmath218 + @xmath219 + @xmath220 + @xmath221 +   * output * : @xmath222",
    "the fixed - point problem in eqn .",
    "[ eqn : fixedpoint : map1 ] can be rewritten as @xmath223 - v_{lr } \\,.\\ ] ] this equation can be solved using an iteration of the form @xcite @xmath224 where @xmath102 is chosen to approximate the inverse jacobian . in multi - secant type methods , @xmath102 is set to the solution of the constrained minimization problem @xcite @xmath225 where @xmath226 \\ , ,   \\nonumber \\\\ y_k & = & [ f(v_{lr , k - m+1 } ) - f(v_{lr , k - m } ) , \\ldots , f(v_{lr , k } ) - f(v_{lr , k-1 } ) ] \\ , .",
    "\\nonumber \\end{aligned}\\ ] ] in the above equations , @xmath227 represents the mixing history .",
    "the solution of this variational problem is @xmath228 in the specific case of anderson mixing @xcite , @xmath229 is set to @xmath230 , where @xmath40 is a @xmath231 identity matrix .",
    "this leads to the update formula : @xmath232    65 natexlab#1#1[2]#2 , , ( ) . , , ( ) .",
    ", , , , , .",
    "( ) . , , ( ) . , , , ( )",
    ", , , ( ) . , , in : ( ed . ) , , volume   of _ _ , , , pp . . , ( ) . ,",
    ", , , ( ) . , , , ( ) .",
    ", , ( ) . , , , , ( ) .",
    ", , , ( ) . , , , , ( ) . , , ( ) .",
    ", , , ( ) . , , , ( ) .",
    ", , , , , , ( ) . , , ( ) .",
    ", , , , ( ) . , , , , ( ) .",
    ", , , ( ) . , ( ) .",
    ", , , ( ) . , , ( ) .",
    ", , , ( ) . , , ( ) .",
    ", , , ( ) . , , ( ) .",
    ", , , ( ) . ,",
    "( ) . , , ( ) . , ,",
    ", , , . , ( ) .",
    ", , , ( ) . , , , , , ( ) . , , ( ) .",
    ", , , volume  , , . , ( ) .",
    ", , , , , , , , , , , , , argonne national laboratory , .",
    ", , , , in : , , ( eds . ) , , , , pp . . , , , , volume  , , . , , , ( ) . , , ( ) . , , , . , ( ) . , , volume  , , ."
  ],
  "abstract_text": [
    "<S> we present a real - space formulation and higher - order finite - difference implementation of periodic orbital - free density functional theory ( of - dft ) . specifically , utilizing a local reformulation of the electrostatic and kernel terms , we develop a generalized framework for performing of - dft simulations with different variants of the electronic kinetic energy . in particular , we propose a self - consistent field ( scf ) type fixed - point method for calculations involving linear - response kinetic energy functionals . in this framework , </S>",
    "<S> evaluation of both the electronic ground - state as well as forces on the nuclei are amenable to computations that scale linearly with the number of atoms . we develop a parallel implementation of this formulation using the finite - difference discretization . </S>",
    "<S> we demonstrate that higher - order finite - differences can achieve relatively large convergence rates with respect to mesh - size in both the energies and forces . </S>",
    "<S> additionally , we establish that the fixed - point iteration converges rapidly , and that it can be further accelerated using extrapolation techniques like anderson s mixing . </S>",
    "<S> we validate the accuracy of the results by comparing the energies and forces with plane - wave methods for selected examples , including the vacancy formation energy in aluminum . </S>",
    "<S> overall , the suitability of the proposed formulation for scalable high performance computing makes it an attractive choice for large - scale of - dft calculations consisting of thousands of atoms .    </S>",
    "<S> finite - differences , real - space , fixed - point , anderson mixing , conjugate gradient , electronic structure . </S>"
  ]
}