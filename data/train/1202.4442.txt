{
  "article_text": [
    "the aim of weather forecasting is to give a good prediction of the future states of the atmosphere on the basis of present observations and mathematical models describing the dynamics ( physical behaviour ) of the atmosphere .",
    "these models consist of sets of non - linear partial differential equations which have only numerical solutions .",
    "the problem with these numerical weather prediction models is that the solutions highly depend on the initial conditions which are always in a way or in another not fully accurate . a possible solution to address this problem is to run the model with different initial conditions and produce ensembles of forecasts .",
    "with the help of ensembles one can estimate the distribution of future weather variables which leads us to probabilistic weather forecasting @xcite .",
    "the ensemble prediction method was proposed by @xcite and since its first operational implementation @xcite it became a widely used technique all over the world .",
    "however , despite e.g. the ensemble mean gives a better estimate of a meteorological quantity than most or all of the ensemble members , the ensemble is usually under - dispersive and in this way , uncalibrated .",
    "this phenomena was observed at several operational ensemble prediction systems , for an overview see e.g. @xcite",
    ".    the bayesian model averaging ( bma ) method for post - processing ensembles in order to calibrate them was introduced by @xcite .",
    "the basic idea of bma is that to each ensemble member forecast corresponds a conditional probability density function ( pdf ) that can be interpreted as the conditional pdf of the future weather quantity provided the considered forecast is the best one .",
    "then the bma predictive pdf of the future weather quantity is the weighted sum of the individual pdfs corresponding to the ensemble members and the weights are based on the relative performances of the ensemble members during a given training period . in @xcite the bma method was successfully applied to obtain 48 hour forecasts of surface temperature and sea level pressure in the north american pacific northwest based on the 5 members of the university of washington mesoscale ensemble @xcite .",
    "these weather quantities can be modeled by normal distributions , so the predictive pdf is a gaussian mixture .",
    "later @xcite developed a discrete - continuous bma model for precipitation forecasting , where the discrete part corresponds to the event of no precipitation , while the cubic root of the precipitation amount ( if it is positive ) is modeled by a gamma distribution . in @xcite",
    "the bma method was used for wind speed forecasting and the component pdfs follow gamma distribution . finally , using von mises distribution to model angular data",
    "@xcite introduced a bma scheme to predict surface wind direction .    in the present work",
    "we apply the bma method for calibrating ensemble forecasts of wind speed produced by the operational limited area model ensemble prediction system ( lameps ) of the hungarian meteorological service ( hms ) called aladin - huneps @xcite .",
    "aladin - huneps covers a large part of continental europe with a horizontal resolution of 12 km and it is obtained by dynamical downscaling ( by the aladin limited area model ) of the global arpege based pearp system of mto france @xcite .",
    "the ensemble consists of 11 members , 10 initialized from perturbed initial conditions and one control member from the unperturbed analysis .",
    "this construction implies that the ensemble contains groups of exchangeable forecasts ( the ensemble members can not be distinguished ) , so for post - processing one has to use the modification of bma as suggested by @xcite .",
    "as it was mentioned in the introduction , bma post - processing of ensemble predictions was applied for wind speed data obtained from the hms .",
    "the data file contains 11 member ensembles ( 10 forecasts started from perturbed initial conditions and one control ) of 42 hour forecasts for 10 meter wind speed ( given in m / s ) for 10 major cities in hungary ( miskolc , szombathely , gyr , budapest , debrecen , nyregyhza , nagykanizsa , pcs , kecskemt , szeged ) produced by the aladin - huneps system of the hms , together with the corresponding validating observations , for the period between october 1 , 2010 and march 25 , 2011 .",
    "the forecasts are initialized at 18 utc , the startup speed of the anemometers measuring the validating observations is @xmath0 m / s .",
    "the data set is fairly complete , since there are only two days ( 18.10.2010 and 15.02.2011 ) when three ensemble members are missing for all sites and one day ( 20.11.2010 ) when no forecasts are available .",
    "figure [ fig : fig1 ] shows the verification rank histogram of the raw ensemble , that is the histogram of ranks of validating observations with respect to the corresponding ensemble forecasts .",
    "this histogram is far from the desired uniform distribution , in most of the cases the ensemble members either underestimate , or overestimate the validating observations ( the ensemble range contains the observed wind speed only in @xmath1 of the cases ) .",
    "hence , the ensemble is under - dispersive and in this way it is uncalibrated .",
    "to obtain a probabilistic forecast of wind speed the modification of bma gamma model of @xcite for ensembles with exchangeable members @xcite was used .",
    "the first idea is to have two exchangeable groups : one contains the control denoted by  @xmath2 ,  the other one the 10 ensemble members corresponding to the different perturbed initial conditions which are denoted by  @xmath3 ,  respectively .  in this way",
    "we assume that the probability density function ( pdf ) of the forecasted wind speed  @xmath4  equals : @xmath5 where  @xmath6 $ ] ,  and   @xmath7 is the conditional pdf corresponding to the ensemble members . as we are working with wind speed data ,",
    "@xmath8  is a gamma pdf with mean  @xmath9  and standard deviation  @xmath10 .",
    "here we restrict both the mean and the standard deviation parameters to constant values for all ensemble members , which reduces the number of parameters and simplifies calculations .",
    "mean parameters  @xmath11  are estimated with the help of linear regression , while weight  @xmath12  and standard deviation parameters  @xmath13 ,  by maximum likelihood method , using training data consisting of ensemble members and verifying observations from the preceding  @xmath14  days ( training period ) . in order to handle the problem that the wind speed values under 0.1 m / s are considered to be zero , the maximum likelihood ( ml ) method for gamma distributions suggested by @xcite is applied , while the maximum of the likelihood function is found with the help of em algorithm @xcite . for more details",
    "see @xcite .",
    "once the estimated parameters for a given day are available , one can use either the mean or the median of the predictive pdf as a point forecast .",
    "based on a more careful look on the ensemble members there are some differences in the generation of the ten exchangeable ensemble members . to obtain them only five perturbations",
    "are calculated and then they are added to ( odd numbered members ) and subtracted from ( even numbered members ) the unperturbed initial conditions @xcite .",
    "figure [ fig : fig2 ] shows the plume diagram of ensemble forecast of 10 meter wind speed for debrecen initialized at 18 utc , 22.10.2010 .",
    "( solid line : control ; dotted line : odd numbered members , dashed line : even numbered members ) .",
    "this diagram clearly illustrates that the behaviour of ensemble member groups  @xmath15  and  @xmath16  really differ from each other .",
    "therefore , in this way one can also consider a model with three exchangeable groups : control , odd numbered exchangeable members and even numbered exchangeable members .",
    "this idea leads to the following pdf of the forecasted wind speed  @xmath4 : @xmath17 where for weights  @xmath18 $ ]  we have @xmath19 ,  while pdf  @xmath7  and parameters @xmath20  are the same as for the model .",
    "obviously , both the weights and the parameters can be estimated in the same way as before .    to 9 truecm ( a ) ( b )    to 9 truecm ( c ) ( d )    as an illustration we consider the data and forecasts for debrecen for two different dates 30.12.2010 and 17.03.2011 for models and .",
    "figures [ fig : fig3]a and [ fig : fig3]b show the pdfs of the two groups in model , the overall pdfs , the median forecasts , the verifying observations , the first and last deciles and the ensemble members . the same functions and quantities can be seen on figures [ fig : fig3]c and [ fig : fig3]d , where besides the overall pdf we have three component pdfs and three groups of ensemble members .",
    "on 30.12.2010 the spread of the ensemble members is quite fair and the ensemble range contains the validating observation ( 3.2 m / s ) . in this case",
    "the ensemble mean ( 3.5697 m / s ) overestimates , while bma median forecasts corresponding to the two- and three - group models ( 3.2876 m / s and 3.2194 m / s , respectively ) are pretty close to the true wind speed .",
    "a different situation is illustrated on figures [ fig : fig3]b and [ fig : fig3]d , where the spread of the ensemble is even higher , but all ensemble members underestimate the validating observation ( 6.1 m / s ) .",
    "obviously , the same holds for the ensemble mean ( 3.2323 m / s ) and due to the bias correction the bma median forecasts corresponding to models and also give bad results ( 3.3409 m / s and 3.0849 m / s , respectively ) .",
    "to check the performance of probabilistic forecasts based on models and and the corresponding point forecasts , as a reference we use the ensemble mean and the ensemble median .",
    "we compare the mean absolute errors ( mae ) and the root mean square errors ( rmse ) of these point forecasts and also the mean continuous ranked probability scores ( crps ) @xcite and the coverages and average widths of @xmath21 and @xmath22 prediction intervals of the bma predictive probability distributions and of the raw ensemble .",
    "we remark that for mae and rmse the optimal point forecasts are the median and the mean , respectively @xcite .",
    "further , given a cumulative distribution function ( cdf )  @xmath23  and a real number  @xmath4 ,  the crps is defined as @xmath24 the mean crps of a probability forecast is the average of the crps values of the predictive cdfs and corresponding validating observations taken over all locations and time points considered .",
    "for the raw ensemble the empirical cdf of the ensemble replaces the predictive cdf .",
    "the coverage of a  @xmath25  prediction interval is the proportion of validating observations located between the lower and upper @xmath26  quantiles of the predictive distribution . for a calibrated predictive pdf",
    "this value should be around  @xmath27 .",
    "data analysis provided below was performed with the help of the ensemblebma package of r @xcite . as a first step the length of the appropriate training period was determined , then the performances of the bma post - processed ensemble forecasts corresponding to models and were analyzed .      according to the results of e.g. @xcite to determine the length of the training period to be used we compare the mae values of bma median forecasts , the rmse values of bma mean forecasts , the crps values of bma predictive distributions and the coverages and average widths of @xmath22 and @xmath21 bma prediction intervals for training periods of length  @xmath28  calendar days . in order to ensure the comparability of the results we consider verification results from 02.12.2010 to 25.03.2011 ( 114 days ) .",
    "consider first the two - group model . on figure",
    "[ fig : fig4 ] the average widths and coverages of @xmath21 and @xmath22 bma prediction intervals are plotted against the length of the training period .",
    "the average widths of the prediction intervals show an increasing trend , so shorter training periods yield sharper forecasts",
    ". coverages of @xmath21 and @xmath22 prediction intervals are not monotonously increasing , too . for short training periods",
    "the coverage of the @xmath21 prediction interval oscillates around the correct @xmath21 , but for training periods not shorter than 17 days it stays above this level .",
    "the coverage of the @xmath22 prediction interval stabilizes above the correct @xmath22 for training periods longer than 24 days .",
    "hence , to have calibrated forecasts , one should choose a training period not shorter than 25 days .",
    "figure [ fig : fig5 ] shows crps values of bma predictive distribution , mae values of bma median forecasts and rmse values of bma mean forecasts as functions of the training period length .",
    "crps and rmse both take their minima at 28 days , the corresponding values are @xmath29 and @xmath30 , respectively .",
    "mae takes its minimum of @xmath31 at 30 days , while the second smallest value ( @xmath32 ) is obtained with a training period of length 28 days .",
    "this means that for model a 28 days training period seems to be reasonable and training periods longer than 30 days can not be taken into consideration .",
    "similar conclusions can be drawn from figures [ fig : fig6 ] and [ fig : fig7 ] for the three - group model . in this case",
    "the @xmath21 and @xmath22 prediction intervals are slightly narrower than the corresponding intervals of model , their coverages stabilize above the correct @xmath21 and @xmath22 for training periods longer than 17 and 24 days , respectively .",
    "crps and mae plotted on figure [ fig : fig7 ] both reach their minima of @xmath33 and @xmath34 , respectively , at 30 days , while values @xmath35 and @xmath36 corresponding to training period of length 28 days are both the fourth smallest ones .",
    "rmse takes its minimum of @xmath37 at 27 days , and increases afterwards .",
    "the fourth smallest value ( @xmath38 ) again corresponds to 28 days , while the rmse corresponding to 30 days is significantly larger ( @xmath39 ) .",
    "moreover , @xmath21 and @xmath22 prediction intervals corresponding to 28 days are sharper than the appropriate prediction intervals calculated using training period of length 30 days ( @xmath40 and @xmath41 vs. @xmath42 and @xmath43 ) .",
    "hence , we suggest the use of a training period of length 28 days for both bma models .      according to the results of the previous subsection , to test the performance of bma post - processing on the 11 member aladin - huneps ensemble we use a training period of 28 calendar days . in this way",
    "ensemble members , validating observations and bma models are available for 146 calendar days ( on 20.11.2010 all ensemble members are missing ) .",
    "first we check the calibration of bma post - processed forecasts with the help of probability integral transform ( pit ) histograms .",
    "the pit is the value of the bma predictive cumulative distribution evaluated at the verifying observations @xcite .",
    "the closer the histogram to the uniform distribution , the better is the calibration . on figure",
    "[ fig : fig8 ] the pit histograms corresponding to two- and three - group bma models and are displayed . compared to the verification rank histogram of the raw ensemble ( see figure [ fig : fig1 ] ) one can observe a large improvement with the use of calibration .",
    "however , these pit histograms are still not perfect , e.g. kolmogorov - smirnov test rejects uniformity both for the two- and for the three - group model .",
    "the corresponding @xmath44-values are @xmath45 and @xmath46 , respectively , so the pit of the two - group model is slightly better .",
    ".coverage and average width of prediction intervals . [ cols=\"<,^,^,^,^,^ \" , ]     finally , on figure [ fig : fig10 ] common bias parameters  @xmath47 of both bma models investigated and standard deviation parameters @xmath13   of the two - group model are plotted , together with the differences in standard deviation parameters of three- and two - group models .",
    "bias parameters are rather stable , the relative standard deviations of  @xmath48  and  @xmath49 are @xmath50 and @xmath51 , respectively . hence , the bma mean forecast of a particular day is mainly determined by the corresponding ensemble forecasts .",
    "the standard deviation parameters show more variability , for  @xmath52 and  @xmath53  the relative standard deviations are equal to @xmath54 and @xmath55 for model , and @xmath56 and @xmath57 for model .",
    "in the present study the bma ensemble post - processing method is applied for the 11 member aladin - huneps ensemble of the hms to obtain 42 hour predictions for 10 meter wind speed .",
    "two different bma models are investigated , one assumes two groups of exchangeable members ( control and forecasts from perturbed initial conditions ) , while the other considers three ( control and forecasts from perturbed initial conditions with positive and negative perturbations ) . for both models a 28 days training period",
    "is suggested .",
    "the comparison of the raw ensemble and of the probabilistic forecasts shows that the mean crps values of bma post - processed forecasts are considerably lower than the mean crps of the raw ensemble .",
    "further , the mae and rmse values of bma point forecasts ( median and mean ) are also lower than the maes and rmses of the ensemble median and of the ensemble mean .",
    "the calibrations of bma forecasts are nearly perfect , the coverages of @xmath21 and @xmath58 prediction intervals are very close to the right values .",
    "the three - group bma model slightly outperforms the two - group one and in almost all cases yields a real mixture of gamma distributions .    in this way",
    "one can conclude that bma post - processing of ensemble forecasts of wind speed data of the hms significantly improves the precision and calibration of the forecasts , its operational application is worth considering .",
    "* acknowledgments . *",
    "research was supported by the hungarian scientific research fund under grants no .",
    "otka t079128/2009 and otka nk101680 and by the tmop-4.2.2.c-11/1/konv-2012 - 0001 project .",
    "the project has been supported by the european union , co - financed by the european social fund .",
    "the authors are indebted to tilmann gneiting for his useful suggestions and remarks and to mt mile and mihly szcs from the hms for providing the data .",
    "99 bao , l. , gneiting , t. , raftery , a. e. , grimit , e. p. and guttorp , p. ( 2010 ) bias correction and bayesian model averaging for ensemble forecasts of surface wind direction .",
    "rev . _ * 138 * , 18111821 .",
    "descamps , l. , labadier , c. , joly , a. and nicolau , j. ( 2009 ) ensemble prediction at mto france ( poster introduction by olivier riviere ) _ 31st ewglam and 16th srnwp meetings , _",
    "28th september ",
    "1st october , 2009 .",
    "available at : http://srnwp.met.hu/annual_meetings/2009/download/sept29/morning/posterpearp.pdf fraley , c. , raftery , a. e. , gneiting , t. and sloughter , j. m. ( 2009 ) ensemblebma : an r package for probabilistic forecasting using ensembles and bayesian model averaging .",
    "_ technical report _",
    "516r , department of statistics , university of washington .",
    "hornyi , a , kertsz , s. , kullmann , l. and radnti , g. ( 2006 ) the arpege / aladin mesoscale numerical modeling system and its application at the hungarian meteorological service . _",
    "i d ojrs _ * 110 * , 203227 ."
  ],
  "abstract_text": [
    "<S> prediction of various weather quantities is mostly based on deterministic numerical weather forecasting models . </S>",
    "<S> multiple runs of these models with different initial conditions result ensembles of forecasts which are applied for estimating the distribution of future weather quantities . however , the ensembles are usually under - dispersive and uncalibrated , so post - processing is required .    in the present work bayesian model averaging ( bma ) is applied for calibrating ensembles of wind speed forecasts produced by the operational limited area model ensemble prediction system of the hungarian meteorological service ( hms ) .    </S>",
    "<S> we describe two possible bma models for wind speed data of the hms and show that bma post - processing significantly improves the calibration and precision of forecasts .    </S>",
    "<S> _ key words : _ bayesian model averaging , gamma distribution , continuous ranked probability score . </S>"
  ]
}