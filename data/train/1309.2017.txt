{
  "article_text": [
    "in deriving the partition function for a desired ensemble , the most common approach is to maximize an entropy function with constraints appropriate to the thermodynamic condition . while equivalent to the approach proposed below , such a method ( called the traditional approach hereafter ) does not make clear to students the explicit role of the assumption of equal _ a priori _ states and the corresponding role of the entropy in the thermodynamic potential for the microcanonical ensemble .",
    "indeed , @xmath2 is often taken as a postulate@xcite and its connection to the statistical formula @xmath4 ( appearing on boltzmann s tombstone ) is not obvious .",
    "further , in the traditional approach , the role of the entropy in understanding equilibrium in non - isolated , open ensembles can be confusing .",
    "we note in passing that concerns over the rigor of the method of most probable distribution prompted darwin and fowler to develop a derivation of the partition function based upon complex analysis.@xcite    also , infrequently stressed is the gibbs entropy , @xmath1 , where @xmath5 is the probability of finding a system in a given state , which can be invoked for any equilibrium ensemble and associated state probabilities.@xcite it is a direct consequence of the statistical entropy formula , @xmath4 , in conjunction with the gibbs construction of an ensemble that contains a large number of macroscopic subsystems , each consistent with the desired thermodynamic variables ; @xmath6 gives the number of possible realizations within the gibbs construction for the ensemble under consideration .",
    "the gibbs entropy also permits the derivation of the connection between the characteristic thermodynamic function and the partition function for a given ensemble without further appeal to thermodynamic expressions , as is required in the traditional approach .    in the present approach ,",
    "first , the connections between the statistical formula @xmath7 , the gibbs entropy , @xmath1 , and the microcanonical entropy expression @xmath2 are clarified .",
    "the condition for microcanonical equilibrium , and the associated role of the entropy in the thermodynamic potential then arises from the postulate of equal _ a priori _ states .",
    "the derivation of the canonical partition function follows by invoking the gibbs construction and the first and second law of thermodynamics _ via _ the fundamental equation , @xmath8 , that incorporates the conditions of conservation of energy and composition without the needs for explicit constraints .",
    "the role of the temperature ( coming from the constraint of total energy and an appeal to appropriate thermodynamic relationships in the traditional approach ) is immediately apparent and also introduced _ via _ the fundamental equation .",
    "the need for explicit maximization of any function is thus also avoided .",
    "legendre transforming a particular thermodynamic function to include desired thermodynamic control variables for an ensemble of interest and invoking equilibrium leads to the corresponding partition function . using the resulting probabilities in the gibbs entropy expression",
    "directly connects the partition function to the thermodynamic potential .",
    "the central role of the entropy in establishing equilibrium for a given ensemble emerges naturally from the current approach .",
    "connections to generalized ensemble theory also arise and are presented in this context .",
    "the present approach is novel in providing clarity as to the roles played by the different formulas and physical quantities of interest .",
    "further , it makes explicit the assumptions inherent in deriving the partition function for an ensemble and provides its direct connection to the relevant thermodynamic potential in a systematic fashion .",
    "this approach also makes deriving the partition function for a given ensemble a simplified , straight - forward process , even for more challenging examples such as the isothermal - isobaric ensemble .",
    "using this approach in the classroom has led to better retention and understanding of the foundations of statistical mechanics and an ability for students to confidently apply the machinery to problems that arise in their subsequent work .",
    "we begin by introducing the concept of an ensemble of replicas that describe the molecular states corresponding to a given macrostate ; this picture is referred to as the  gibbs construction \" herein , due to it s original introduction by gibbs@xcite who addressed many of the subtleties inherent@xcite in the formulation of statistical mechanics .",
    "consider a collection of macroscopic molecular  subsystems \" of @xmath9 molecules within a volume @xmath10 , each of which is part of the larger gibbs construction , the totality of which is known as the  system \" .",
    "no other constraints have yet been imposed , _",
    "i.e. _ the system s macrostate is otherwise unspecified .",
    "it is desirable to define the microscopic statistics of this system as thoroughly as possible and then apply any other constraints at the end .",
    "let the total number of subsystems in our collection be known as @xmath11 .",
    "then let @xmath12 , the occupation number , denote the number of subsystems from this collection that are in the same thermodynamic state .",
    "these occupations will thus take on a large value in the thermodynamic limit and they obey a sum rule , @xmath13 .",
    "note , technically the energy is course - grained , _",
    "i.e. _ specified to within a small but otherwise arbitrary range ( these arguments are presented in detail elsewhere@xcite ) and the results are insensitive to this choice .    first , consider the following combinatoric formula : @xmath14 @xmath15 is the number of ways in which the set of occupations @xmath16 may be arranged consistent with the given macrostate .",
    "first , it is to be shown that when evaluated at fixed energy , this quantity @xmath17 may be identified with the thermodynamic entropy of the ensemble of systems at equilibrium , with each systems entropy given by s = @xmath18 .",
    "note , the expression necessarily involves the logarithm of the combinatoric expression to make the entropy an extensive property ; for two independent systems the possible number of arrangements is the product of those for the individual systems , @xmath19 .",
    "next the connection between the combinatoric formula @xmath20 and the gibbs entropy is presented ; the details of this have been given elsewhere.@xcite applying the sterling approximation@xcite to the factorial function gives the entropy : @xmath21 further substituting @xmath22 where @xmath23 is identified as the probability of a particular state and using the property of the natural log gives a system s entropy as:@xcite @xmath24    this is the gibbs entropy in an as yet unspecified ensemble with its associated probabilities ; the gibbs entropy is an entirely general definition that , for any equilibrium ensemble , specifies the relationship between the partition function and the associated characteristic thermodynamic function .",
    "now , specializing to a set of microcanonical subsystems , and invoking the equilibrium principle of equal _ a priori _ states , _",
    "i.e. _ @xmath25 , gives the well known result : @xmath26 it is also simple and useful to show that the gibbs entropy , and thus the thermodynamic entropy , is maximized microcanonically@xcite by the state - independent probabilities @xmath27 .",
    "proceeding , taking the derivative of equation [ eq : ge ] and setting it to zero as @xmath28 gives @xmath29 , a constant value independent of the summation index .",
    "thus , normalizing the probabilities as , @xmath30 immediately yields @xmath31 .",
    "thus , for an isolated system , the assumption of equal _ a priori _ states leads to a probability @xmath5 that is independent of index , _",
    "i.e. _ every subsystem has energy @xmath32 by construction",
    ". further , the characteristic maximum entropy in the microcanonical equilibrium ensemble also follows . then applying the gibbs entropy expression leads to the identification of the thermodynamic entropy as the characteristic function of the microcanonical ensemble and gives its relationship to the @xmath33 partition function , @xmath34 , which can also be interpreted as the density of states@xcite at that energy",
    "specializing the gibbs construction from the previous section to include temperature , we have a collection of subsystems all possessing the same @xmath35 .",
    "this can be thought of by placing the subsystems in contact with a large heat bath of temperature @xmath36.@xcite we now imagine that each subsystem ( after having achieved equilibrium with the heat bath by definition ) is to be insulated and the energy of the @xmath37 subsystem is measured as @xmath38 , and for which there is also an associated macroscopic entropy @xmath39 . of great importance , we also note that the thermodynamic energy @xmath38 is exactly equal to the microscopic configurational energy of the subsystem upon insulation . furthermore , the details and/or rates involved in the insulation process are irrelevant for an equilibrium ensemble .    using the earlier result , the entropy for a collection of subsystems with a specified energy @xmath38 is @xmath40 , where @xmath11 is the number of subsystems with energy @xmath38 in the ensemble .",
    "consider the ratio of the density at energies @xmath41 :    @xmath42    the fundamental equation of thermodynamics@xcite is now invoked :    @xmath43    the canonical ensemble is given by a state with well defined thermodynamic variables , @xmath44 .",
    "so the energy function , @xmath45 is legendre transformed to a new thermodynamic function , the helmholtz free energy , @xmath46 _ via _ :    @xmath47    where the condition for canonical equilibrium is that @xmath48 and @xmath49 are constant , giving : @xmath50    integrating between two state points gives :    @xmath51    note , the constraints of fixed temperature , particle number and volume have been explicitly enforced by using the fundamental equation , equation [ eq : fe ] and dropping differential terms that are fixed canonically .    substituting equation [ eq : ds ] into equation [ eq : ratio ] gives : @xmath52 where @xmath53 and @xmath54 ( _ i.e. _ the probability of choosing the @xmath37 state from the entire ensemble at equilibrium with the heat bath ) .",
    "the normalization factor , @xmath55 , may be readily recognized as the canonical partition function .",
    "most importantly , we note that the insulation procedure applied to each subsystem has allowed us to identify the macroscopic energy ( and entropy ) of that microcanonical system , with the microscopic energy of the molecular configuration present at the time of insulation .",
    "we can now proceed to use the gibbs entropy expression , equation [ eq : ge ] , substituting the canonical expression for @xmath5 to obtain : @xmath56    above , @xmath57 represents the canonical average energy that is identified with the thermodynamic energy , @xmath32.@xcite thus , the relationship @xmath58 is obtained directly from the gibbs entropy .",
    "note , the gibbs entropy is defined for any set of probabilities and , as was shown above , is simply a consequence of the combinatoric formula @xmath59 interpreted in the context of the gibbs construction .",
    "thus , an entropy can be associated even with nonequilibrium probabilities .",
    "however , in that case , the entropy does not play the role of being the constrained maximized quantity that it does at equilibrium and its utility , in such circumstances , is unclear .",
    "further note , the role of temperature is introduced _ via _ the fundamental equation without further appeal to thermodynamic relationships .",
    "this emphasizes the role of temperature as the system is in contact with a heat bath  different energy ranges are now accessible with canonical probabilities .",
    "the ability of a diathermal system to exchange energy with its surroundings also clarifies how the concepts of work and entropy make sense for an open system and provides their relationship to the temperature .",
    "gibbs construction for the canonical ensemble .",
    "the subsystems of identical @xmath60 are in thermal equilibrium with a large bath at temperature @xmath36.,width=3 ]",
    "using the gibbs construction from the previously derived canonical ensemble , the constraint that all subsystems possess identical @xmath9 can now be relaxed .",
    "we now consider the ratio of subsystem , having chosen a particular system from the energy level @xmath38 with @xmath61 molecules :    @xmath62    as before , the fundamental equation of thermodynamics can be relied upon to relate the change in entropy to the other variables of our ensemble . in this case , the probabilities that will generate the macrostate corresponding to constant @xmath63 are desired .",
    "after doing so , the entropy _ via the boltzmann law _ is used to determine the microscopic states .",
    "legendre transforming the canonical thermodynamic equation to substitute @xmath64 for @xmath9 : @xmath65 where at equilibrium @xmath66 and with constant @xmath63 : @xmath67    upon integrating , the difference equation for the entropy is found :    @xmath68\\end{aligned}\\ ] ]    the ratio of microstates then becomes :    @xmath69    and since @xmath70 @xmath71 where the normalization factor @xmath72 is the _ grand canonical partition function _ :",
    "@xmath73    it may be noted that in this case the constraint of constant @xmath9 was merely relaxed , legendre transformed to the corresponding macrostate , and the partition function then followed quite naturally and simply .",
    "the resulting probabilities can now be substituted into the gibbs entropy and the relationship between the thermodynamic potential and partition function is thus directly established .",
    "gibbs construction for the grand canonical ensemble .",
    "@xmath64 has been legendre transformed to replace @xmath9 as the macroscopic constant , and so the set of subsystems includes those of differing @xmath9 values.,width=3 ]",
    "having successfully derived the grand canonical partition function by relaxing the constant @xmath9 constraint , it can now be shown that the isothermal - isobaric ensemble is generated by starting with constant @xmath74 and relaxing the condition of constant @xmath10 .",
    "consider the number of subsystems with both volume @xmath75 and energy @xmath76 :    @xmath77    legendre transforming our desired variables to a new characteristic function @xmath78 , and then applying the condition of equilibrium @xmath79 and our constant differential terms : @xmath80    and so the ratio of observable subsystems becomes :    @xmath81 } \\nonumber \\\\",
    "= \\frac{e^{\\beta e_i}e^{\\beta pv_j}}{e^{\\beta e_{i+1}}e^{\\beta pv_{j+1}}}\\end{aligned}\\ ] ]    and since @xmath70 @xmath82 where the normalization factor , @xmath83 is the _ isothermal - isobaric partition function_.    again , the associated probabilities can now be substituted into the gibbs entropy and the relationship between the thermodynamic potential and partition function is thus directly established .",
    "gibbs construction for the isothermal - isobaric ensemble .",
    "@xmath84 has been legendre transformed to replace @xmath10 as the macroscopic constant , and so the set of subsystems includes those of differing @xmath10 values.,width=3 ]",
    "based on the previous sections , it may be noted that if a partition function for _ any _ macrostate in thermal equilibrium is to be derived , one shall _ always _ arrive at an expression that involves an exponential function ; this follows as a consequence of the boltzmann law . furthermore , the partition function being the normalization factor to express this as a probability means that one will always have a discrete sum .",
    "therefore , our partition functions will always be some variation on a theme amounting to a ",
    "sum of exponentials . \"    in the continuum limit , it can be shown that the canonical partition function @xmath85 ( written as a sum over energy levels ) transforms as :    @xmath86    or , in other words , the canonical partition function is the laplace transform of the microcanonical partition function @xmath11 .",
    "how does it work the other way ?",
    "let s apply the inverse laplace transform to @xmath85 :    @xmath87    where the phase space differential form @xmath88 .",
    "now , @xmath89 and because no singularity is present in the right - half of the complex plane , the contour may be taken vertically through @xmath90 . since @xmath91 along the integration , the substitution @xmath92",
    "can be made :    @xmath93    where indeed equation [ eq : delta_function ] can be identified as the microcanonical partition function . thus , any constant energy shell ensemble may be laplace transformed to an ensemble of a new intensive variable . as the partition functions are related to one another through the laplace transform ,",
    "this is isomorphic to the thermodynamic potentials ( to each of which may be associated a particular partition function ) being related through the legendre transform.@xcite    the quantum harmonic oscillator is an illustrative example of how the canonical partition function may be transformed to the microcanonical case :    @xmath94 \\label{eq : nve_qho}\\end{aligned}\\ ] ]    the reason that the aforementioned  recipe \" for generating the partition function ( as outlined in sections [ sec : canonical],[sec : grand_canonical ] and [ sec : isobaric ] ) in an arbitrary ensemble works is due to the thermodynamic relations and the boltzmann law . the underlying mathematical structure that allows this has also been previously formulated as generalized ensemble theory.@xcite",
    "an approach is presented for deriving partition functions that is an alternative to more common methods .",
    "it emphasizes the central role that ( maximizing ) the boltzmann entropy plays in connecting the molecular states of the system to the observable thermodynamics . using this technique in a classroom setting for a beginning graduate class in statistical mechanics",
    "has led to systemization and demystification of the derivation for useful ensembles . also , the role of legendre transforms to introduce thermodynamic control variables appears naturally and is tied directly to both the derivation of the ensemble and corresponding partition function . within this formalism , students are clear on how the thermodynamic potential relates to a given ensemble and the role of equal _ a priori _ states .",
    "further , relating the partition function to the thermodynamic potential using the gibbs entropy is straightforward and no further appeal to thermodynamic expressions is required as the relevant thermodynamic connection was included from the start of the derivation .",
    "finally , the similarities between the derivation method demonstrated and the relations known from generalized ensemble theory have been noted . it is our hope that the formulaic approach presented here will be of utility in both research and pedagogy .",
    "the authors acknowledge funding from the u.s .",
    "department of energy , basic energy sciences ( grant no .",
    "de0gg02 - 07er46470 ) .",
    "lawrence livermore national laboratory is operated by lawrence livermore national security , llc , for the u.s .",
    "department of energy , national nuclear security administration under contract de - ac52 - 07na27344 ."
  ],
  "abstract_text": [
    "<S> a pedagogical approach for deriving the statistical mechanical partition function , in a manner that emphasizes the key role of entropy in connecting the microscopic states to thermodynamics , is introduced . </S>",
    "<S> the connections between the combinatoric formula @xmath0 applied to the gibbs construction , the gibbs entropy , @xmath1 , and the microcanonical entropy expression @xmath2 are clarified . </S>",
    "<S> the condition for microcanonical equilibrium , and the associated role of the entropy in the thermodynamic potential is shown to arise naturally from the postulate of equal _ a priori _ states . </S>",
    "<S> the derivation of the canonical partition function follows simply by invoking the gibbs ensemble construction at constant temperature and using the first and second law of thermodynamics ( _ via _ the fundamental equation @xmath3 ) that incorporate the conditions of conservation of energy and composition without the needs for explicit constraints ; other ensemble follow easily . </S>",
    "<S> the central role of the entropy in establishing equilibrium for a given ensemble emerges naturally from the current approach . </S>",
    "<S> connections to generalized ensemble theory also arise and are presented in this context . </S>"
  ]
}