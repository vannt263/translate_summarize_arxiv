{
  "article_text": [
    "in this section we derive the first and second order moments of cell counts in the different compartments of the network model . a proliferation mechanism following a memoryless branching process known in the literature as a multi - type galton watson process",
    "is adopted .",
    "population mean values and covariance matrices are essential tools both for stochastic simulation of the network and for implementing the parameter estimation procedure described in section * s2*. we start our development by considering the source node of our network , i.e. , the draining lymph node .",
    "the classical multi - type galton watson branching process ( mgw)is a prototypical branching process , representing the evolution of a population whose members reproduce and die subject to random laws ( see the classical textbooks ( _ 1 , 2 _ ) ) . the generation of a cell , which is defined as the number division steps the cells undergoes before its birth , represents the type of that cell .",
    "we will denote by @xmath0 the sampling time ( or time step ) of the discrete time process describing the proliferation .",
    "the generic time point @xmath1 will be denoted by @xmath2 .",
    "let the state of the population in the draining lymph node at time @xmath2 be represented by the vector @xmath3 $ ] , where @xmath4 are discrete random variables given by the counts of cells after @xmath5 divisions , being @xmath6 the maximum generation considered .",
    "+ it is well known that a mgw process is a homogeneous vector markov process @xmath7 , @xmath8 , with the following properties ( see ( _ 1 , 2 _ ) ) :    1 .",
    "each cell action is independent from others ; 2 .   each cell offspring generates its own branching process ; 3 .   at each time point",
    ", the cell has no memory about previous time steps .    in the most simple setting ,",
    "a cell of type @xmath5 can make three probabilistic decisions during each time step @xmath0 :    1",
    ".   remain in the same generation @xmath5 with probability @xmath9 ; 2 .   divide to generate two cells of type @xmath10 with probability @xmath11 ; 3 .",
    "die with probability @xmath12 .",
    "the transition from @xmath7 to @xmath13 in one time step is regulated by the probability generating function ( pgf ) :    @xmath14^t \\ , \\ ] ]    where @xmath15 \\in \\mathbb{c}^{p+1 } , \\vert s_i \\vert \\leq 1 \\ , \\ ] ] and @xmath16 @xmath17 it is clear that the @xmath18 component of @xmath19 expresses all the possible outcomes of a cell of type @xmath5 in one time step . letting @xmath20 $ ] , this concept is expressed by the property that @xmath21 , which implies that @xmath22 and , because we assume that cells of generation @xmath6 can only die or survive , @xmath23 .",
    "this assumption is due to the fact that in our experimental setup , the cfse fluorescence intensity becomes negligible for generations higher than @xmath6 .",
    "the moments of the mgw process can be expressed in terms of derivatives of @xmath24 ( see ( _ 1 , 2 _ ) ) . specifically , the mean value of type @xmath25 cell count at the time point @xmath26 starting from a single cell of type @xmath5 at the time point @xmath27 , is given by @xmath28=\\frac { \\partial{f_{i}(\\mathbf{s } ) } } { \\partial{s_{j}}}\\bigg|_{\\mathbf{s}=\\mathbf{1 } } \\ , i,\\ j=0 , 1,\\ldots , p , \\",
    "\\label{meanij}\\ ] ] where @xmath29 denotes a vector whose @xmath30 component is @xmath26 and whose other components are @xmath27 . since our markov process is stationary , we can easily derive the transition matrix @xmath31 which maps cell counts at time @xmath2 to cell counts at time @xmath32 : @xmath33 it is easy to check that the mean value of @xmath34 conditional to a given state @xmath35 is : @xmath36 = \\mathbf{z}_{dr}(n-1 ) \\tilde{\\mathbf{m}}_{dr } \\ .\\ ] ] the mean value @xmath37 is obtained by taking expectaction with respect to @xmath35 in : @xmath38=e[\\mathbf{z}_{dr}(n ) ] = \\boldsymbol{\\mu}_{dr}(n-1 ) \\tilde{\\mathbf{m}}_{dr } \\ .\\ ] ] for computing the covariance matrix of cell counts @xmath7 , we start by calculating the conditional second order moment @xmath39 $ ] :    @xmath40 =   \\\\ e[\\mathbf{z}^t_{dr}(n)\\mid \\mathbf{z}_{dr}(n-1 ) ] e[\\mathbf{z}_{dr}(n)\\mid \\mathbf{z}_{dr}(n-1)]+ cov[\\mathbf{z}_{dr}(n ) \\mid \\mathbf{z}_{dr}(n-1)]= \\\\ \\tilde{\\mathbf{m}}^t_{dr}\\mathbf{z}^t_{dr}(n-1)\\mathbf{z}_{dr}(n-1)\\tilde{\\mathbf{m}}_{dr}+\\sum_{l=0}^{p}\\mathbf{v}_lz_{dr , l}(n-1 ) \\ ,   \\end{array } \\label{condmom}\\ ] ]    where @xmath41 represents the one step covariance matrix for one cell present in the state @xmath42 ( see ( _ 1 _ ) ) : @xmath43_{\\mathbf{s}=\\mathbf{1 } } , \\ \\",
    "i \\neq j \\label{vij}\\ ] ] @xmath44_{\\mathbf{s}=\\mathbf{1}}. \\label{vii}\\ ] ] by taking expectation with respect to @xmath45 in we get the second order moment @xmath46 :",
    "@xmath47=\\tilde{\\mathbf{m}}_{dr}^t\\mathbf{s}^*_{dr}(n-1 ) \\tilde{\\mathbf{m}}_{dr } + \\sum_{l=0}^{p}\\mathbf{v}_l\\mu_{dr , l}(n-1 ) \\ .\\ ] ] then , we get the covariance matrix @xmath48 recursion by considering that @xmath49 : @xmath50    now , we want to extend this basic model by allowing the presence of migration from the draining lymph node .",
    "to this purpose , we introduce the r.v.@xmath51s @xmath52 @xmath53 representing binomial random variables associated to the cells of different types .",
    "we assume that @xmath54 if the cell of type @xmath5 migrates in a time step @xmath0 and @xmath55 if the cell of type @xmath5 does nt migrate .",
    "we denote by @xmath56 and @xmath57 the probabilities of the two possible events , respectively . notice that",
    ", we assume here that the _ naive _ t cells ( type @xmath27 ) and the highest generation cells(type @xmath6 ) have null migration probabilities , i.e. , @xmath58 .",
    "this is in accordance with biological knowledge on the process and the fact that the cfse measuring equipment has limited resolution .",
    "+ now , we introduce the pgf s describing the mgw process with the presence of migration :    @xmath59    notice that the parameters @xmath60 in the first equation above have a meaning different from the ` mortality ' rate of the basic model ( without migration ) . here , they take into account the cumulative effect of death and migration of cells of the various generations .",
    "hence , we can use with the pgf s in for computing the transition matrix of the process in our source node @xmath61 in the presence of migration :    @xmath62    then , with a slight abuse of notation , we will replace the mean value and covariance recursive equations and with the following expressions holding in the presence of migration : @xmath63    @xmath64    where the one time step covariance matrices @xmath65 are again computed through and .",
    "now , we can derive the conditional expected value of the migrating t cells from the draining lymph node by introducing the probability generating function for one cell of type @xmath66 in one time step : @xmath67 @xmath15 \\in \\mathbb{c}^{p+1 } , \\vert s_l \\vert \\leq 1 \\ , l= 0 , 1 , \\ldots , p \\ .\\ ] ] then , we get the conditional expected value of migrating t cells at time point @xmath2 as : @xmath68=\\mathbf{z}_{dr}(n-1)\\mathbf{m}_{mig}\\ ] ] where again the transition matrix @xmath69 is computed through with the pgf s in : @xmath70 by taking expectation over @xmath71 in , we get the mean value of migrating t cells @xmath72 at time point @xmath2 : @xmath73 to compute the covariance matrix at time point @xmath2 , @xmath74 , we first derive the conditional and unconditional second order moments of the migrating cell counts : @xmath75   = \\\\",
    "e[\\mathbf{z}^t_{mig}(n ) \\mid \\mathbf{z}_{dr}(n-1)]e[\\mathbf{z}_{mig}(n ) \\mid \\mathbf{z}_{dr}(n-1)]+ cov[\\mathbf{z}_{mig}(n)\\mid \\mathbf{z}_{dr}(n-1 ) ] = \\\\",
    "\\mathbf{m}^t_{mig}\\mathbf{z}^t_{dr}(n-1)\\mathbf{z}_{dr}(n-1)\\mathbf{m}_{mig}+\\sum_{l=0}^{p}\\mathbf{v}_{mig , l } z_{dr , l}(n-1 ) \\ , \\end{array}\\ ] ] where @xmath76 represents the one step covariance matrix of one cell of type @xmath66 available for migration from the draining lymph node .",
    "these matrices can be computed again through equations and , with the pgf s in .    by taking expectation over @xmath71",
    ", we get : @xmath77=\\mathbf{m}_{mig}^t\\mathbf{s}^*_{dr}(n-1)\\mathbf{m}_{mig}+\\sum_{l=0}^{p}\\mathbf{v}_{mig , l } \\mu_{dr , l}(n-1).\\ ] ] then , the covariance matrix is readily obtained : @xmath78      assuming a time step equal to 4 hours and that t cells take approximately 12 hours to move from the draining lymph node to the distal compartments , the transfer compartment can be built by assembling 3 serial subcompartments tr1 , tr2 and tr3 ( see fig .",
    "[ fig : figure1 ] ) . of course",
    ", any different choice would not impact on the structure of the model , which is very flexible in this respect .",
    "clearly , a rough knowledge of the migration time and of the time step , i.e. , the mean division time , is necessary for appropriately structuring the transfer compartment .",
    "we assume that migrating t cells @xmath79 at time point @xmath2 are located in the tr1 subcompartment .",
    "we denote by @xmath80 the t cells counts vector of the first subcompartment .",
    "then , the mean value @xmath81 and covariance matrix @xmath82 are : @xmath83=\\boldsymbol{\\mu}_{mig}(n)\\\\ \\mathbf{s}_{tr1}(n)&=&\\mathbf{s}_{mig}(n ) \\ .\\end{aligned}\\ ] ] after one time step in the tr1 compartment , the cells @xmath80 undergo a transition while moving to the tr2 subcompartment , according to the pgf @xmath84 $ ] , defined as : @xmath85 from these pgf s we easily derive the transition matrix @xmath86 :    @xmath87    hence the conditional mean value of cell counts in the tr2 compartment is given by : @xmath88=\\mathbf{z}_{tr1}(n-1)\\boldsymbol{m}_{tr } \\ . \\label{ztr2}\\ ] ] by taking expectation over @xmath89 in , we get : @xmath90=\\boldsymbol{\\mu}_{tr1}(n-1)\\boldsymbol{m}_{tr } \\ . \\label{mutr2}\\ ] ] the covariance matrix @xmath91 at time point @xmath2 can be easily computed following the same steps as for @xmath92 :    @xmath93    where @xmath94 is obtained through and by using the pgf s introduced in .",
    "concerning the splitting of the cell population among the the distal lymph nodes and spleen , we model this phenomenon as contemporary to the transition to the third transfer subcompartment .",
    "hence , at the the end of the third transfer time step , we are able to compute the three distinct subpopulations in the subcompartment tr3 ( see fig .",
    "this step is described in the next subsection together with the proliferation in the distal nodes .",
    "the cell population evolution in the distal lymph nodes and spleen depends on the intrinsic proliferation process and the immigration flow from the transfer compartment .",
    "since we assume that splitting of the migrating population takes place during the transition from tr2 to tr3 , we can compute the three flows of cells directed to the distal compartments , directly at the level of the third transfer subcompartment .",
    "the flow from the tr2 compartment towards the distal nodes is divided into three distinct components named @xmath95 to identify the number of cells addressed to the spleen , iliac and mesenteric lymph nodes , respectively .",
    "we will denote by @xmath96 the probabilities that a cell decides to move to the spleen , the mesenteric or the iliac node . at the same time , our model takes care of a proliferation transition during the ` splitting ' time step , according to the mgw pgf modified to account for the splitting . in the remaining part of this section , we will make reference to the spleen , giving for granted that similar formulas hold for the other distal compartments .",
    "the transition function from @xmath97 to @xmath98 is regulated by the following pgf :    @xmath99^t \\label{pgfspleen}\\ ] ]    where @xmath15 \\in \\mathbb{c}^{p+1 } , \\vert s_i \\vert \\leq 1 \\ , \\ ] ] and @xmath100 then , the conditional mean value of @xmath101 is given by : @xmath102=\\mathbf{z}_{tr2}(n-1)\\mathbf{m}_{split , spl}\\ ] ] where    @xmath103    expectation over @xmath104 leads to : @xmath105 by using the same machinery adopted before , we get the recursion for the cell counts covariance matrix : @xmath106 where @xmath107 the one step covariance matrix for one cell of type @xmath66 , which can be derived by exploiting .",
    "now , we turn to the computation of the mean and the covariance matrix of cell counts in the spleen . before doing this , we have to quantify the immigrating flow @xmath108 in the spleen and its covariance matrix : @xmath109&= & \\boldsymbol{\\mu}_{tr3,spl}(n)\\\\ % \\boldsymbol{\\lambda}_{il}(n)=e[\\mathbf{z}_{il}(n)|\\mathbf{z}_{il}(n-1)=0]&=&\\boldsymbol{\\mu}_{tr3,il}(n)\\\\ % \\boldsymbol{\\lambda}_{mes}(n)=e[\\mathbf{z}_{mes}(n)|\\mathbf{z}_{mes}(n-1)=0]&=&\\boldsymbol{\\mu}_{tr3,mes}(n)\\\\ \\mathbf{w}_{spl}(n ) = cov[\\mathbf{z}_{spl}(n)|\\mathbf{z}_{spl}(n-1)=0]&=&\\mathbf{s}_{tr3,spl}(n ) \\ .",
    "% \\mathbf{w}_{il}=cov[\\mathbf{z}_{il}(n)|\\mathbf{z}_{il}(n-1)=0]&=&\\mathbf{s}_{tr3,il}(n)\\\\ % $ \\mathbf{w}_{mes}=cov[\\mathbf{z}_{mes}(n)|\\mathbf{z}_{mes}(n-1)=0]&=&\\mathbf{s}_{tr3,mes}(n ) .",
    "\\end{array } \\label{immflow}\\ ] ] now , we can compute the conditional expected value of cell counts in the spleen , by considering the mgw process with the immigration flow ( _ 40 _ ) :    @xmath110=\\mathbf{z}_{spl}(n-1)\\mathbf{m}_{dist}+\\boldsymbol{\\lambda}_{spl}(n ) \\ , % \\mathbf{z}_{il}(n)=e[\\mathbf{z}_{il}(n)|\\mathbf{z}_{il}(n-1)]=\\mathbf{z}_{il}(n-1)\\mathbf{m}_{dist}+\\boldsymbol{\\lambda}_{il}(n)\\\\ % \\mathbf{z}_{mes}(n)=e[\\mathbf{z}_{mes}(n)|\\mathbf{z}_{mes}(n-1)]=\\mathbf{z}_{mes}(n-1)\\mathbf{m}_{dist}+\\boldsymbol{\\lambda}_{mes}(n),\\ ] ]    where @xmath111 . by taking expectation over @xmath112",
    ", we get :    @xmath113    finally , we can compute the covariance matrix @xmath114 through the usual machinery , by suitably taking into account the immigrating population adding to the standard mgw process : @xmath115 where @xmath116 is given by and .",
    "all _ in vivo _ cfse experiments require to sacrifice animals to collect data .",
    "this means that measurements taken at different time points actually refer to different individuals .",
    "this fact introduces an inter - individual stochastic variability in terms of t cell counts which need be addressed in our inference scheme .",
    "+ to take into account this issue , model identification has been performed by using _",
    "relative frequencies _ as model variables instead of t cell counts .",
    "this choice mainly based on the results in ( _ 3 _ ) , allows one to derive an explicit expression for the asymptotic log - likelihood function of the relative frequencies when dealing only with one draining lymph node(_35 _ ) .",
    "when dealing with the entire network , the inference problem becomes much more complicated .",
    "also in our context , we take a relative frequency approach , which will allow us to derive a closed form expression for a normal approximation to the log - likelihood function . to this purpose",
    ", we introduce the vectors @xmath117 \\in \\mathbb{r}^{p_{tot}}$ ] and @xmath118\\in \\mathbb{r}^{p_{tot}}$ ] where @xmath119 and @xmath120 represent the cell counts and the mean values vectors computed in the previous section , with the exclusion of the first component representing _ naive _ ( type @xmath27 ) t cells .",
    "similarly , we introduce the covariance matrices @xmath121 and build up the overall cell counts covariance matrix as @xmath122 we highlight that the matrix @xmath123 is introduced to incorporate the measurements taken at the different lymph nodes and spleen in the likelihood function .",
    "the block diagonal form is justified by the fact that the measurements performed in the different model compartments are independent . in order to construct the likelihood function , let @xmath124 be the vector random variable representing the relative frequencies at time point @xmath2 .",
    "the @xmath18 component of @xmath125 is defined as @xmath126 where @xmath127 .",
    "notice that @xmath128 .",
    "let @xmath129 be a vector whose components are : @xmath130 following arguments similar to those used in ( _ 3 _ ) , let us introduce the matrix @xmath131 whose entries are given by : @xmath132 moreover , define @xmath133 where @xmath134 is the correlation matrix of the cell counts , whose entries are given by @xmath135 then , the mean and the covariance matrix of relative frequencies can be derived as : @xmath136 & = & [ r_1(n ) , \\ldots , r_{p_{tot}}(n)]^t \\\\",
    "\\boldsymbol{\\sigma}(n ) & = & \\mathbf{d}(n ) / ( \\sum_{i=1}^{p_{tot}}\\mu_i(n))^2 \\ . \\end{array } \\label{normreduced}\\ ] ] since we know that @xmath128 , the relative frequencies distribution is degenerate . to this purpose ,",
    "considering any subset of relative frequencies in the @xmath137 dimensional vector of relative frequencies and the related covariance matrix , named ( with abuse of notation ) @xmath138^t",
    "\\in \\mathbb{r}^{p_{tot}-1}$ ] and @xmath139 , we get @xmath136 & = & [ r_1(n ) , \\ldots , r_{(p_{tot}-1)}(n)]^t \\\\",
    "\\mathbf{\\sigma}(n ) & = & \\tilde{\\mathbf{d}}(n ) / ( \\sum_{i=1}^{p_{tot}}\\mu_i(n))^2 \\ , \\end{array}\\ ] ] where @xmath140 is defined like in ( [ d ] ) through suitably rearranged submatrices of @xmath131 .",
    "the above equations allow us to construct the normal approximation to the log - likelihood function for our estimation problem .",
    "in fact , assume that @xmath141 mice are sacrificed at the time point @xmath2 .",
    "denote by @xmath142 , @xmath143 , the relative frequency measurements at the timepoint @xmath2 , and by @xmath144 the relative frequencies covariance matrix at the same time point .",
    "then , the contribution to the normal approximation of the log likelihood function at time @xmath2 is given by : @xmath145 where @xmath129 and @xmath146 are functions of the probability parameter vector @xmath147^t .\\ ] ]    of course , if independent measurements are taken at different time points @xmath148 , then the global negative approximate log likelihood function is @xmath149 notice that actually the cost function defined in ( [ likelihood1 ] ) would represent the true log likelihood function if the relative frequencies were normally distributed : this is the case ( asymptotically ) when dealing with the draining lymph node only ( see ( _ 35 _ ) ) . in our case , the cost function ( [ likelihood ] ) represents a normal approximation of the negative log likelihood function , because we have no guarantee on the asymptotic normality of relative frequencies . by minimizing the cost function function ( [ likelihood ] ) ,",
    "we get parameter estimates : @xmath150",
    "* t. e. harris , the theory of branching processes ( 2002 ) . * kimmel , d. e. axelrod , branching processes in biology .",
    "interdisciplinary applied mathematics , ( 2002 ) . * yakovlev a.y .",
    ", yanev n.m .",
    ", relative frequencies in multitype branching processes .",
    "the annals of applied probability .",
    "2009 ; p.p 1 - 14 .",
    "* pettini e , prota g , ciabattini a , boianelli a , fiorino f , pozzi g , vicino a. , medaglini d. , vaginal immunization to elicit primary t - cell activation and dissemination .",
    "plos one . 2013;8(12):e80545 .",
    "* boianelli a , pettini e , prota g , medaglini d , vicino a. identification of a branching process model for adaptive immune response . in : proc .",
    "ieee 52nd conference on decision and control ( cdc ) , 2013 .",
    "ieee ; 2013 .",
    "7205 - 7210 ."
  ],
  "abstract_text": [
    "<S> in this paper we consider a model based on branching process theory for the proliferation and the dissemination network of t cells in the adaptive immune response . a multi - type galton watson branching process is assumed as the basic proliferation mechanism , associated to the migration of t cells of the different generations from the draining lymph node to the spleen and other lymphoid organs . </S>",
    "<S> time recursion equations for the mean values and the covariance matrices of the the cell population counts are derived in all the compartments of the network model . moreover , a normal approximation of the log - likelihood function of the cell relative frequencies is derived , which allows one to obtain estimates of both the probability parameters of the branching process and the migration rates in the various compartments of the network . </S>"
  ]
}