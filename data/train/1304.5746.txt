{
  "article_text": [
    "one of the oldest theorems in graph theory is attributed to euler , and it says that a ( undirected ) graph admits an _ euler circuit _ , i.e. , a closed walk visiting every edge exactly once , if and only if a graph is connected and all its vertices are of even degrees . respectively , a directed graph has a _ directed euler circuit _ if and only if a graph is ( weakly ) connected and for each vertex , its in - degree is equal to its out - degree . while checking",
    "if a given directed or undirected graph is eulerian is easily done in polynomial time , the problem of finding @xmath1 edges ( arcs ) in a graph to form an eulerian subgraph is np - hard .",
    "we refer to the book of fleischner @xcite for a thorough study of eulerian graphs and related topics .    in @xcite , cai and",
    "yang initiated the study of parameterized complexity of subgraph problems motivated by eulerian graphs .",
    "particularly , they considered the following parameterized subgraph and induced subgraph problems :    and    the decision versions of both @xmath1-circuit and euler @xmath1-subgraph are known to be the @xmath4-complete  @xcite .",
    "cai and yang in  @xcite proved that @xmath1-circuit on undirected graphs is @xmath5 . on the other hand ,",
    "the authors have shown in @xcite that euler @xmath1-subgraph is @xmath6$]-hard .",
    "the variant of the problem @xmath7-circuit , where one asks to remove at most @xmath1 edges to obtain an eulerian subgraph was shown to be @xmath5 by cygan et al .",
    "@xcite on directed and undirected graphs .",
    "the problem of removing at most @xmath1 vertices to obtain an induced eulerian subgraph , namely euler @xmath8-subgraph , was shown to be @xmath6$]-hard by cai and yang for undirected graphs @xcite and by cygan et al .",
    "for directed graphs @xcite .",
    "dorn et al . in @xcite",
    "provided fpt algorithms for the weighted version of eulerian extension .    in this work",
    "we extend the set of results on the parameterized complexity of eulerian subgraph problems by considering the problems of finding an ( induced ) eulerian subgraph with _ at least _",
    "@xmath1 ( vertices ) edges .",
    "we consider the following problems :    and    the decision version of long circuit was shown to be @xmath4-complete by cygan et al . in  @xcite and it is not difficult to see that same is true for large euler subgraph . let us note that by plugging - in these observations into the framework of bodlaender et al .",
    "@xcite , it is easy to conclude that on undirected graphs both problems have no polynomial kernels unless @xmath9 .",
    "however , the parameterized complexity of these problems appears to be much more interesting .    * our results . *",
    "we show that large euler subgraph behaves differently for directed and undirected cases . for undirected graphs , we prove that the problem is @xmath5 .",
    "we find this result surprising , because very closely related euler @xmath1-subgraph is known to be @xmath6$]-hard @xcite . the proof is based on a structural result interesting in its own .",
    "roughly speaking , we show that large treewidth certifies containment of a large induced euler subgraph . for directed graphs ,",
    "large euler subgraph is @xmath4-complete for each @xmath10 , and this bound is tight  the problem is polynomial - time solvable for each @xmath3 .",
    "we also prove that euler @xmath1-subgraph is @xmath6$]-hard for directed graphs .",
    "long circuit is proved to be @xmath5   for directed and undirected graphs .",
    "our algorithm is based on the results by gabow and nie  @xcite about the parameterized complexity of finding long cycles .",
    "the known and new results about euler subgraph problems are summarized in table  [ tabl : compl ] .",
    ".parameterized complexity of euler subgraph problems .",
    "[ cols=\"^,^,^\",options=\"header \" , ]     this paper is organised as follows .",
    "section  [ sec : defs ] contains basic definitions and preliminaries . in section",
    "[ sec : vertex - undir ] we show that large euler subgraph is fpt on undirected graphs . in section  [ sec",
    ": vertex - dir ] we prove that on directed graphs , euler @xmath1-subgraph is w[1]-hard while large euler subgraph is np - complete for each @xmath10 . in section",
    "[ sec : edge ] we treat long curcuit and show that it is fpt on directed and undirected graphs .",
    "* graphs . *",
    "we consider finite directed and undirected graphs without loops or multiple edges .",
    "the vertex set of a ( directed ) graph @xmath0 is denoted by @xmath11 , the edge set of an undirected graph and the arc set of a directed graph @xmath0 is denoted by @xmath12 . to distinguish edges and arcs , the edge with two end - vertices @xmath13",
    "is denoted by @xmath14 , and we write @xmath15 for the corresponding arc . for a set of vertices @xmath16 , @xmath17 $ ] denotes the subgraph of @xmath0 induced by @xmath18 , and by @xmath19 we denote the graph obtained form @xmath0 by the removal of all the vertices of @xmath18 , i.e. , the subgraph of @xmath0 induced by @xmath20 .",
    "let @xmath0 be an undirected graph .",
    "for a vertex @xmath21 , we denote by @xmath22 its _ ( open ) neighborhood _ , that is , the set of vertices which are adjacent to @xmath21 . the _ degree _ of a vertex @xmath21 is denoted by @xmath23 , and @xmath24 is the maximum degree of @xmath0 .",
    "let now @xmath0 be a directed graph .",
    "for a vertex @xmath25 , we say that @xmath26 is an _ in - neighbor _ of @xmath21 if @xmath27 . the set of all in - neighbors of @xmath21",
    "is denoted by @xmath28 .",
    "the _ in - degree _ @xmath29 .",
    "respectively , @xmath26 is an _ out - neighbor _ of @xmath21 if @xmath30 , the set of all out - neighbors of @xmath21 is denoted by @xmath31 , and the _ out - degree _ @xmath32 .    for a ( directed ) graph @xmath0 , a ( directed ) _ trail _ of _ length _",
    "@xmath1 is a sequence @xmath33 of vertices and edges ( arcs resp . ) of @xmath0 such that @xmath34 , @xmath35 , the edges ( arcs resp . ) @xmath36 are pairwise distinct , and for @xmath37 , @xmath38 ( @xmath39 resp . ) .",
    "a trail is said to be _ closed _ if @xmath40 .",
    "a closed ( directed ) trail is called a ( directed ) _ circuit _ , and it is a ( directed ) _ cycle _ if all its vertices except @xmath40 are distinct . clearly , any cycle is a subgraph of @xmath0 , and it is said that @xmath41 is an _ induced cycle _ of @xmath0 if @xmath42 $ ] .",
    "a ( directed ) path is a trail such that all its vertices are distinct . for a ( directed ) walk ( trail , path resp . )",
    "@xmath33 , @xmath43 and @xmath44 are its _ end - vertices _ , and @xmath45 are its _ internal _ vertices . for a a ( directed ) walk ( trail , path resp . ) with end - vertices @xmath26 and @xmath21 , we say that it is an _",
    "( _ trail _ , _ path _ resp . ) .",
    "we omit the word `` directed '' if it does not create a confusion .",
    "also we write a trail as a sequence of its vertices @xmath46 .",
    "a connected ( directed ) graph @xmath0 is an _ euler _ ( or _ eulerian _ ) graph if it has a ( directed ) circuit that contains all edges ( arcs resp . ) of @xmath0 . by the famous result by euler ( see , e.g. , @xcite ) ,",
    "a connected graph @xmath0 is an euler graph if and only if all its vertices have even degrees . respectively",
    ", a connected directed graph @xmath0 is an euler directed graph if and only if for each vertex @xmath25 , @xmath47 .",
    "* ramsey numbers .",
    "* the _ ramsey number _",
    "@xmath48 is the minimal integer @xmath49 such that any graph on @xmath49 vertices has either a clique of size @xmath50 or an independent set of size @xmath51 . by the famous paper by erds and szekeres  @xcite , @xmath52",
    ".    * parameterized complexity .",
    "* parameterized complexity is a two dimensional framework for studying the computational complexity of a problem .",
    "one dimension is the input size @xmath49 and another one is a parameter @xmath1 .",
    "it is said that a problem is _ fixed parameter tractable _ ( or @xmath5 ) , if it can be solved in time @xmath53 for some function @xmath54 , and it is said that a problem is in @xmath55 , if it can be solved in time @xmath56 for some function @xmath54 .",
    "one of the basic assumptions of the parameterized complexity theory is the conjecture that the complexity class @xmath57}}\\neq { \\ensuremath{\\operatorname{fpt}}}$ ] , and it is unlikely that a @xmath6$]-hard problem could be solved in @xmath5-time .",
    "a problem is _ @xmath58-hard_(_complete _ )",
    "if it is @xmath4-hard ( complete ) for some fixed value of the parameter @xmath1 . clearly , a @xmath58-hard problem is not in @xmath55   unless @xmath59@xmath60@xmath4 .",
    "we refer to the books of downey and fellows  @xcite , flum and grohe  @xcite , and niedermeier  @xcite for detailed introductions to parameterized complexity .",
    "* treewidth . * a _ tree decomposition _ of a graph",
    "@xmath0 is a pair @xmath61 where @xmath62 is a tree and @xmath63 is a collection of subsets ( called _ bags _ ) of @xmath11 such that :    1 .",
    "@xmath64 , 2 .",
    "for each edge @xmath65 , @xmath66 for some @xmath67 , and 3 .   for each @xmath68 the set @xmath69 induces a connected subtree of @xmath62",
    ".    the _ width _ of a tree decomposition @xmath70 is @xmath71 .",
    "treewidth _ of a graph @xmath0 ( denoted as @xmath72 ) is the minimum width over all tree decompositions of @xmath0 .",
    "recall that our aim is to prove that long circuit is @xmath5   for directed and undirected graphs and large euler subgraph is @xmath5   for undirected graphs .",
    "hence , we should argue that these problems are @xmath4-hard .",
    "notice that for exact variants of these problems , i.e. , @xmath1-circuit and euler @xmath1-subgraph for undirected graphs , the @xmath4-hardness was proved by cai and yang  @xcite , and for long circuit ( for directed and undirected cases ) , it was shown by cygan et al . in  @xcite .",
    "[ prop : npc ] large euler subgraph is @xmath4-complete for undirected graphs when @xmath1 is a part of the input .    let @xmath0 be a @xmath49-vertex cubic graph",
    ". denote by @xmath73 the graph obtained by subdividing each edge of @xmath0 .",
    "it is straightforward to see that @xmath73 has an induced euler subgraph with at least @xmath74 vertices if and only if @xmath0 is hamiltonian .",
    "as the hamiltonian cycle is known to be @xmath4-complete for cubic planar graphs  @xcite , the result follows .",
    "finally , we observe that while we obtain @xmath5   results , it is unlikely that these problems have polynomial kernels . let @xmath0 be a ( directed ) graph with @xmath75 connected components @xmath76 , and let @xmath1 be a positive integer .",
    "notice that @xmath0 has a circuit with at least @xmath1 edges ( arcs resp . ) if and only if @xmath77 has a circuit with at least @xmath1 edges ( arcs resp . ) for some @xmath78 .",
    "also @xmath0 has an induced euler subgraph with at least @xmath1 vertices if and only if @xmath77 has an induced euler subgraph with at least @xmath1 vertices for some @xmath78 . by the results of bodlaender",
    "@xcite , this observation together with proposition  [ prop : npc ] and the np - hardness of long circuit  @xcite immediately imply the following proposition .",
    "[ prop : kernel ] long circuit for directed and undirected graphs and large euler subgraph for undirected graphs have no polynomial kernels unless @xmath9 .",
    "in this section we show that large euler subgraph is @xmath5   for undirected graphs . using ramsey arguments",
    ", we prove that if a graph @xmath0 has sufficiently large treewidth , then @xmath0 has an induced euler subgraph on at least @xmath1 vertices .",
    "then if the input graph has large treewidth , we have a yes - answer .",
    "otherwise , we use the fact that large euler subgraph can be solved in @xmath5   time for graphs of bounded treewidth . all considered here graphs are undirected .    for a given positive integer @xmath1",
    ", we define the function @xmath79 for integers @xmath80 recursively as follows :    * @xmath81 , * @xmath82 for @xmath83 .",
    "we need the following two lemmas .",
    "[ lem : connect ] let @xmath0 be a graph , and suppose that @xmath84 are distinct vertices joined by at least @xmath79 internally vertex - disjoint paths of length at most @xmath85 in @xmath0 for some @xmath80 .",
    "then @xmath0 has an induced euler subgraph on at least @xmath1 vertices .",
    "consider the minimum value of @xmath85 such that @xmath0 has @xmath79 internally vertex disjoint @xmath86-paths .",
    "we have at least @xmath87 such paths @xmath88 that are distinct from the path @xmath84 .",
    "we assume that each path @xmath89 has no chords that either join two internal vertices or an internal vertex and one of the end - vertices , i.e. , each internal vertex is adjacent in @xmath90 $ ] only to its two neighbors in @xmath89 .",
    "otherwise , we can replace @xmath89 by a shorter path with all vertices in @xmath91 distinct from the path @xmath84 .",
    "we consider two cases .",
    "* case 1 . @xmath92 . * the paths @xmath88 are of length two and therefore have exactly one internal vertex .",
    "assume that @xmath93 are internal vertices of these paths .",
    "because @xmath94 , the graph @xmath95 $ ] either has a clique @xmath96 of size @xmath1 or an independent set @xmath97 of size at least @xmath98 .",
    "suppose that @xmath0 has a clique @xmath96 .",
    "if @xmath1 is odd , then @xmath99 $ ] is an induced euler subgraph on @xmath1 vertices .",
    "if @xmath1 is even , then @xmath100 $ ] is an induced euler subgraph on @xmath101 vertices .",
    "assume now that that @xmath102 is an independent set of size @xmath98 .",
    "let @xmath103 .",
    "if @xmath104 and @xmath1 is even or @xmath105 and @xmath1 is odd , then @xmath106 $ ] is an induced euler subgraph on @xmath101 vertices .",
    "else if @xmath105 and @xmath1 is even or @xmath104 and @xmath1 is odd , then @xmath107 $ ] is an induced euler subgraph on @xmath1 vertices .",
    "@xmath108 . *",
    "we say that paths @xmath89 and @xmath109 are _ adjacent _ if they have adjacent internal vertices .",
    "let @xmath110 .",
    "suppose that there is an internal vertex @xmath21 of one of the paths @xmath88 that is adjacent to at least @xmath111 internal vertices of some other distinct @xmath111 paths .",
    "then there are @xmath110 paths @xmath112 that have respective internal vertices @xmath113 such that i ) @xmath21 is adjacent to @xmath113 and ii ) either each @xmath114 is at distance at most @xmath115 from @xmath51 in @xmath116 for all @xmath117 or each @xmath114 is at distance at most @xmath115 from @xmath75 in @xmath116 for all @xmath117 .",
    "but then either the vertices @xmath118 or @xmath119 are joined by at least @xmath120 internally vertex - disjoint paths of length at most @xmath121 .",
    "this contradicts our choice of @xmath85 .",
    "hence , for each @xmath122 , any internal vertex of @xmath89 has adjacent internal vertices in at most @xmath123 other paths , and @xmath89 is adjacent to at most @xmath124 other paths . as @xmath125 , there are @xmath98 distinct paths @xmath126 that are pairwise non - adjacent , i.e. , they have no adjacent internal vertices .",
    "let @xmath127 $ ] and @xmath128 $ ] .",
    "notice that by our choice of the paths , @xmath129 and @xmath130 if @xmath105 , and @xmath131 ( @xmath132 resp . ) can be obtained from @xmath133 ( @xmath134 resp . ) by the removal of @xmath135 if @xmath84 are adjacent .",
    "if @xmath104 and @xmath1 is even or @xmath105 and @xmath1 is odd , then @xmath133 is an induced euler subgraph on at least @xmath101 vertices .",
    "else if @xmath105 and @xmath1 is even or @xmath104 and @xmath1 is odd , then @xmath134 is an induced euler subgraph on at least @xmath1 vertices .    for @xmath10 ,",
    "let @xmath136    [ lem : deg ] for @xmath10 , any 2-connected graph @xmath0 with @xmath137 has an induced euler subgraph on at least @xmath1 vertices .",
    "let @xmath0 be a 2-connected graph and let @xmath26 be a vertex of @xmath0 with @xmath138 .",
    "as @xmath0 is 2-connected , @xmath139 is connected .",
    "let @xmath21 be an arbitrary vertex of @xmath140 .",
    "denote by @xmath62 a tree of shortest paths from @xmath21 to all other vertices of @xmath140 in @xmath73 .",
    "* claim a. * _ if there is a @xmath141-path @xmath142 of length at least @xmath143 in @xmath62 for some @xmath144 , then @xmath0 has an induced euler subgraph on at least @xmath1 vertices .",
    "_    denote by @xmath145 the vertices of @xmath140 in @xmath142 in the path order , @xmath146 and @xmath147 .",
    "let @xmath148 be the union of @xmath149-subpaths of @xmath142 , let @xmath150 be the union of @xmath151-subpaths of @xmath142 , and let @xmath152 be the union of @xmath153-subpaths of @xmath142 .",
    "notice that some subpaths can be empty depending whether @xmath50 modulo 3 is 0 , 1 or 2 .",
    "observe that @xmath154 are edge - disjoint induced subgraphs of @xmath0 . since @xmath155 , there is @xmath156 for @xmath157 with at least @xmath158 edges .",
    "then @xmath156 has at least @xmath98 vertices .",
    "let @xmath159 $ ] . by the definition of @xmath156 , @xmath133 is a union of induced cycles with one common vertex @xmath26 such that for different cycles @xmath160 in the union , @xmath161 and @xmath162 whenever @xmath163 and @xmath164 .",
    "hence , @xmath133 is an euler graph with at least @xmath1 vertices .",
    "from now we assume that all @xmath141-paths in @xmath62 have length at most @xmath165 for @xmath144 .",
    "* claim b. * _ if there is a vertex @xmath166 with @xmath167 , then @xmath0 has an induced euler subgraph on at least @xmath1 vertices .",
    "_    recall that @xmath62 is a tree of shortest paths from @xmath21 .",
    "we assume that @xmath62 is rooted in @xmath21 .",
    "then the roof defines the parent - child relation on @xmath62 .",
    "let @xmath168 be a parent of @xmath169 ( if exists ) and let @xmath170 be the children of @xmath169 .",
    "if @xmath169 has no parent , then @xmath171 and @xmath172 .",
    "otherwise , @xmath173 .",
    "let @xmath174 . for each @xmath175 ,",
    "let @xmath176 be a descendant of @xmath177 in @xmath62 .",
    "denote by @xmath89 the unique @xmath178-path in @xmath62 for @xmath179 . as all @xmath141-paths in @xmath62 have length at most @xmath165 for @xmath144 , the paths @xmath180 have length at most @xmath165 .",
    "notice that these paths have no common vertices except @xmath169 .",
    "observe now that @xmath181 are adjacent to @xmath26 in @xmath0 .",
    "therefore , we have at least @xmath182 internally vertex - disjoint @xmath183-paths in @xmath0 . by lemma  [ lem :",
    "connect ] , it implies that @xmath0 has an induced euler subgraph on at least @xmath1 vertices .    to complete the proof of the lemma , it remains to observe that if @xmath184 and all @xmath141-paths in @xmath62 have length at most @xmath165 for @xmath144 , then @xmath185    kosowski et al .",
    "@xcite obtained the following bound for treewidth .",
    "[ thm : bod ] let @xmath0 be a graph without induced cycles with at least @xmath186 vertices and let @xmath187 .",
    "then @xmath188 .",
    "this theorem together with lemma  [ lem : deg ] immediately imply the next lemma .",
    "[ lem : tw - bound ] let @xmath0 be a graph and let @xmath10 .",
    "if @xmath189 , then @xmath0 has an induced euler subgraph on at least @xmath1 vertices .",
    "suppose that @xmath189 .",
    "then @xmath0 has a 2-connected component @xmath73 with @xmath190 .",
    "if @xmath191 , then @xmath73 has an induced euler subgraph on at least @xmath1 vertices by lemma  [ lem : deg ] .",
    "otherwise , by theorem  [ thm : bod ] , @xmath73 has an induced cycle on at least @xmath1 vertices , i.e. , an induced euler subgraph .",
    "now we show that large euler subgraph is @xmath5   for graphs of bounded treewidth .",
    "[ lem : cmsol ] for any positive integer @xmath75 , large euler subgraph can be solved in linear time for graphs of treewidth at most @xmath75 .",
    "recall that the syntax of the _ monadic second - order logic _ ( msol ) of graphs includes logical connectives @xmath192 , @xmath193 , @xmath194 , variables for vertices , edges , sets of vertices and edges , and quantifiers @xmath195 , @xmath196 that can be applied to these variables .",
    "besides the standard relations @xmath60 , @xmath197 , @xmath198 , the syntax includes the relation @xmath199 for two vertex variables , which expresses whether two vertex @xmath26 and @xmath21 are adjacent , and for a vertex variable @xmath21 and an edge variable @xmath200 , we have the relation @xmath201 which expresses that @xmath21 is incident with @xmath200 . the _ counting monadic first - order logic _",
    "( cmsol ) is an extension of msol with the additional predicate @xmath202 which expresses whether the cardinality of a set @xmath203 is @xmath204 modulo @xmath205 .    by the celebrated courcelle s theorem  @xcite ,",
    "any problem that can be expressed in cmsol can be solved in linear time for graphs of bounded treewidth . moreover",
    ", this result holds also for optimization problems .",
    "observe that to solve large euler subgraph for a graph @xmath0 , it is sufficient to find a subset of vertices @xmath206 of maximum size such that @xmath206 induces an euler graph",
    ". clearly , @xmath206 induces an euler graph if and only if i ) @xmath207 $ ] is connected and ii ) each vertex of @xmath208 $ ] has even degree . the both properties can be expressed in cmsol .",
    "the standard way to express connectivity is to notice that @xmath207 $ ] is connected if and only if for any @xmath209 , @xmath210 and @xmath211 , there is an edge @xmath212 such that @xmath213 and @xmath214 .",
    "then we have to express the property that for any @xmath215 , @xmath216}(u)=|n_{g[u]}(u)|$ ] is even . to do it",
    ", it is sufficient to observe that @xmath217}(u)$ ] if and only if @xmath218 such that i ) for any @xmath219 , @xmath220 , and ii ) for any @xmath221 such that @xmath220 , @xmath219 .",
    "since we can express in cmsol whether @xmath222}(u)|$ ] is even , the claim follows .",
    "now we can prove the main result of this section .",
    "[ thm : fpt - vertex ] for any positive integer @xmath1 , large euler subgraph can be solved in linear time for undirected graphs .",
    "clearly , we can assume that @xmath186 , as any euler graph has at least three vertices .",
    "if @xmath223 , then we can find any shortest cycle in the input graph @xmath0 .",
    "it is straightforward to see that if @xmath0 has no cycles , then we have no euler subgraph , and any induced cycle is an induced euler subgraph on at least three vertices .",
    "hence , it can be assumed that @xmath10 .",
    "we check in linear time whether @xmath189 using the bodlaender s algorithm  @xcite .",
    "if it is so , we solve our problem using lemma  [ lem : cmsol ] .",
    "otherwise , by lemma  [ lem : tw - bound ] , we conclude that @xmath0 has an induced euler subgraph on at least @xmath1 vertices and return a yes - answer .",
    "notice , that the proof of theorem  [ thm : fpt - vertex ] is not constructive . in the conclusion of this section",
    "we sketch the algorithm that produces an induced euler subgraph on at least @xmath224 vertices if it exists .",
    "first , for each @xmath80 , we can test existence of two vertices @xmath84 such that the input graph @xmath0 has at least @xmath79 internally vertex - disjoint @xmath86-paths of length at most @xmath85 in @xmath5  time with the parameter @xmath85 using the color coding technique  @xcite .",
    "if we find such a structure for @xmath225 , we find an induced euler subgraph with at least @xmath1 vertices that is either a clique or a union of @xmath86-paths as it is explained in the proof of lemma  [ lem : connect ] .    otherwise , we find all 2-connected components . if there is a 2-connected component @xmath73 with a vertex @xmath26 with @xmath226 , then we find an induced euler subgraph with at least @xmath1 vertices that is a union of cycles with the common vertex @xmath26 using the arguments form the proof of lemma  [ lem : deg ] .",
    "if all 2-connected components have bounded maximum degrees , we use the algorithm of kosowski et al .",
    "@xcite that in polynomial time either finds an induced cycle on at least @xmath1 vertices or constructs a tree decomposition of width at most @xmath227 .",
    "in the fist case we have an induced euler subgraph on at least @xmath1 vertices .",
    "in the second case the treewidth is bounded , and large euler subgraph is solved by a dynamic programming algorithm instead of applying lemma  [ lem : cmsol ] .      in this section",
    "we show that euler @xmath1-subgraph and large euler subgraph are hard for directed graphs .",
    "first , we consider euler @xmath1-subgraph .",
    "it is straightforward to see that this problem is in @xmath55 , since we can check for every subset of @xmath1 vertices , whether it induces an euler subgraph .",
    "we prove that this problem can not be solved in @xmath228   time unless @xmath229}}$ ] .",
    "[ thm : w - hard ] the euler @xmath1-subgraph is @xmath6$]-hard for directed graphs .",
    "we reduce the multicolored @xmath1-clique problem that is known to be @xmath6$]-hard  @xcite :    let @xmath230 be an instance of multicolored @xmath1-clique .",
    "we construct the directed graph @xmath133 as follows .",
    "* construct the copies of @xmath231 .",
    "* for @xmath232 and for each @xmath233 and @xmath234 , if @xmath235 , then construct an arc @xmath15 for the copies of @xmath26 and @xmath21 in @xmath133 .",
    "* for each @xmath37 , construct two vertices @xmath236 , then join @xmath177 by arcs with all vertices of @xmath237 and join every vertex of @xmath237 with @xmath238 by an arc .",
    "* construct arcs @xmath239 .",
    "we set @xmath240 .",
    "we claim that @xmath0 has a clique with @xmath1 vertices if and only if @xmath133 has an induced euler subgraph with at least @xmath241 vertices .",
    "let @xmath242 be a clique in @xmath0 , @xmath243 for @xmath37 .",
    "observe that @xmath244 are pairwise non - adjacent in @xmath133 .",
    "hence , the set of vertices @xmath245 induces a cycle in @xmath133 .",
    "hence , we have an induced euler subgraph with at least @xmath241 vertices .",
    "suppose now that @xmath133 has an induced euler subgraph @xmath41 with at least @xmath241 vertices .",
    "observe that every directed cycle in @xmath0 contains the arc @xmath246 , because if we delete this arc , we obtain a directed acyclic graph . since any euler directed graph is a union of arc - disjoint directed cycles ( see , e.g. , @xcite ) , @xmath41 is an induced directed cycle .",
    "moreover , for each @xmath37 , @xmath41 contains at most one vertex of @xmath237 .",
    "indeed , assume that two vertices @xmath13 of @xmath41 are in the same set @xmath237 .",
    "then the @xmath15-paths and the @xmath247-path in @xmath41 should contain @xmath246 , but this is impossible . because @xmath41 has @xmath248 vertices , we conclude that @xmath41 contains exactly one vertex @xmath249 from each @xmath237 for @xmath37 , and @xmath250 for @xmath37",
    ". then @xmath251 $ ] . since @xmath41 is an induced cycle , @xmath244 are pairwise non - adjacent in @xmath133 .",
    "then @xmath252 is a clique in @xmath0 .    for large euler subgraph for directed graphs ,",
    "we prove that this problem is @xmath58-complete .",
    "[ thm : paranp ] for any @xmath10 , large euler subgraph is @xmath4-complete for directed graphs .",
    "we reduce to the 3-satisfiability problem .",
    "it is known  @xcite that this problem is @xmath4-complete even if each variable is used in exactly 4 clauses : 2 times in positive and 2 times in negations .",
    "suppose that boolean variables @xmath253 and clauses @xmath254 compose an instance of 3-satisfiability such that each variable is used in exactly 4 clauses : 2 times in positive and 2 times in negations .",
    "let @xmath255 .",
    "without loss of generality we assume that @xmath256 .",
    "we construct the directed graph @xmath0 as follows ( see fig .",
    "[ fig : npc ] ) .    * for each @xmath257 , construct vertices @xmath258 and arcs @xmath259 , @xmath260 .",
    "* for each @xmath261 , construct @xmath262 . * for each @xmath263 , construct vertices @xmath264 and arcs @xmath265 , @xmath266 , @xmath267 , @xmath268 , @xmath269 , @xmath270 , @xmath271 , @xmath272 , @xmath273 .",
    "* for each @xmath274 , construct @xmath275 . *",
    "construct @xmath276 .",
    "* for each @xmath277 , let @xmath278 . for @xmath279 ,",
    "* * if @xmath280 for some @xmath281 and @xmath282 is the fist occurrence of the literal @xmath177 in @xmath283 , then construct @xmath284 ; * * if @xmath280 for some @xmath281 and @xmath282 is the second occurrence of the literal @xmath177 in @xmath283 , then construct @xmath285 ; * * if @xmath286 for some @xmath281 and @xmath282 is the fist occurrence of the literal @xmath287 in @xmath283 , then construct @xmath288 ; * * if @xmath286 for some @xmath281 and @xmath282 is the second occurrence of the literal @xmath287 in @xmath283 , then construct @xmath289 .",
    "we claim that @xmath283 can be satisfied if and only if @xmath0 has an induced euler subgraph with at least @xmath1 vertices .    for @xmath257 ,",
    "let @xmath290 and @xmath291 . for @xmath292 and @xmath279 , @xmath293 .",
    "let also @xmath294 and @xmath295 .",
    "suppose that the variables @xmath253 have values such that @xmath283 is satisfied .",
    "we construct the set of vertices @xmath206 as follows :    * for @xmath257 , if @xmath296 , then the vertices of the set @xmath89 are included in @xmath206 , and @xmath297 is included otherwise ; * for @xmath263 , if @xmath278 , then we choose a literal @xmath298 in @xmath299 and include @xmath300 in @xmath206 .",
    "observe that @xmath206 induces a cycle in @xmath0 and @xmath301 .",
    "then @xmath207 $ ] is an induced euler subgraph on at least @xmath1 vertices .",
    "assume now that a set @xmath302 induces an euler graph @xmath303 $ ] and @xmath304 .",
    "since @xmath10 , @xmath305 because @xmath306 has no cycles except vertex - disjoint triangles .",
    "suppose that some @xmath307 .",
    "if @xmath308 , then @xmath309 , and if @xmath310 , then @xmath311 .",
    "also exactly one of the vertices @xmath312 is in @xmath206 .",
    ". then @xmath314 .",
    "further , either @xmath315 or some vertex @xmath316 or @xmath317 .",
    "but if @xmath316 or @xmath317 , @xmath318 .",
    "hence , @xmath315 . if @xmath319 , then @xmath320 , and if @xmath321 , then @xmath322 .",
    "suppose now that some @xmath315 .",
    "if @xmath319 , then @xmath320 , and if @xmath321 , then @xmath322 .",
    "also exactly one of the vertices @xmath323 is in @xmath206 .",
    ". then @xmath313 .",
    "further , either @xmath307 or some vertex @xmath316 or @xmath317 .",
    "but if @xmath316 or @xmath317 , @xmath324",
    ". hence , @xmath307 . if @xmath310 , then @xmath311 .",
    "we have that for each @xmath277 , exactly one @xmath325 for @xmath279 , and for @xmath326 , @xmath327 .",
    "also we have that @xmath320 .",
    "now we consequently consider @xmath328 .",
    "we already know that @xmath320 .",
    "assume inductively that @xmath329 .",
    "then exactly one of the vertices @xmath330 is in @xmath206 .",
    "assume that @xmath331 is in @xmath206 as another case is symmetric . then either @xmath332 or some vertex @xmath333 should be in @xmath206 .",
    "but if @xmath313 , then because @xmath307 , @xmath334 and this is impossible for an euler graph",
    ". then @xmath335 . by the same arguments",
    "we show that @xmath336 . if @xmath337 , then @xmath338 , and we can proceed with our inductive arguments .",
    "we conclude that for each @xmath339 , either @xmath340 or @xmath341 , and if @xmath340 ( @xmath341 resp . ) , then @xmath342 ( @xmath343 resp . ) . moreover , if @xmath340 ( @xmath341 resp . ) and @xmath344 , then @xmath133 has no arcs between the vertices of these two sets .",
    "we define the truth assignment for the variables @xmath253 as follows : for each @xmath339 , if @xmath340 , then @xmath345 , and @xmath296 otherwise .",
    "we claim that @xmath283 is satisfied by this assignment . to show it , consider a clause @xmath278 . we know that there is @xmath279 such that @xmath344 .",
    "assume that @xmath280 ( the case @xmath286 is symmetric ) .",
    "then @xmath346 is joined by arcs in @xmath0 with @xmath89 .",
    "it follows that @xmath89 was not included in @xmath206 , i.e. , @xmath341 and @xmath296 .",
    "hence , @xmath298 .",
    "we proved that large euler subgraph is @xmath4-complete for directed graphs for @xmath10 . in the conclusion of this section",
    "we observe that the bound @xmath10 is tight unless @xmath59@xmath60@xmath4 .",
    "[ prop : poly ] large euler subgraph can be solved in polynomial time for @xmath3 .    for @xmath347 ,",
    "the problem is trivial . if @xmath348 , then any shortest cycle @xmath41 in a directed graph @xmath0 is an induced euler subgraph of @xmath0 with at least two vertices , and @xmath0 has no induced euler subgraph if @xmath0 is a directed acyclic graph .",
    "hence , it remains to consider @xmath223 .",
    "suppose that @xmath133 is an induced euler subgraph of a directed graph @xmath0 , and @xmath133 has at least three vertices .",
    "denote by @xmath134 the graph obtained from @xmath133 by the deletion of all pairs of opposite arcs , i.e. , for each pair of vertices @xmath349 such that @xmath350 , we delete @xmath351 .",
    "clearly , for any @xmath352 , @xmath353 . if @xmath134 is empty , then",
    "because @xmath354 , there are three distinct vertices @xmath355 such that @xmath356 and either @xmath357 or @xmath358 . then @xmath359 $ ] is an euler subgraph of @xmath0 .",
    "if @xmath134 is non - empty , then @xmath134 has a shortest cycle @xmath41 . because @xmath134 has no cycles of length two , @xmath360 $ ] is an induced euler subgraph with at least three vertices .",
    "we conclude that large euler subgraph can be solved for @xmath223 as follows . if @xmath0 has three distinct vertices @xmath361 such that @xmath362 and either @xmath363 or @xmath364 , then @xmath359 $ ] is an euler subgraph of @xmath0 . otherwise , let @xmath73 be the graph obtained from @xmath0 by the deletion of all pairs of opposite arcs . we find a shortest cycle @xmath41 in @xmath73 , and we have that @xmath360 $ ] is an induced euler subgraph with at least three vertices",
    ". finally , if @xmath73 is a directed acyclic graph , then we return a no - answer .",
    "in this section we show that long circuit problem is @xmath5   for directed and undirected graphs .    clearly , we can solve this problem in @xmath5   time for undirected graphs applying the algorithm by cai and yang  @xcite for @xmath50-circuit for each @xmath365 .",
    "for directed graphs , we can use the same approach based on the color coding technique introduced by alon , yuster and zwick  @xcite . for completeness , we sketch the proof here .    [",
    "lem : atmost ] the at least @xmath1 and at most @xmath241-circuit problem can be solved in @xmath366 expected time and in @xmath367 worst - case time for ( directed ) graphs with @xmath49 vertices and @xmath368 edges ( arcs ) .    as the algorithms for directed and undirected graphs are basically the same , we consider here the directed case . for simplicity ,",
    "we solve the decision problem , but the algorithm can be easily modified to obtain a circuit of prescribed size if it exists .      first , we describe the randomized algorithm .",
    "we color the arcs of @xmath0 by @xmath241 colors @xmath369 uniformly at random independently from each other .",
    "now we are looking for a _ colorful _ circuit in @xmath0 that has at least @xmath1 arcs , i.e. , for a circuit such that all arcs are colored by distinct colors .    to do it",
    ", we apply the dynamic programming across subsets .",
    "we choose an initial vertex @xmath26 and try to construct a circuit that includes @xmath26 . for a set of colors",
    "@xmath370 , denote by @xmath371 the set of vertices @xmath25 such that there is a @xmath15-trail with @xmath372 edges colored by distinct colors from @xmath203 .",
    "it is straightforward to see that @xmath373 . for @xmath210 , @xmath374 if and only if @xmath21 has an in - neighbor @xmath375 such that @xmath376 is colored by a color @xmath377 and @xmath378 .",
    "we consequently construct the sets @xmath371 for @xmath203 with @xmath379 elements .",
    "we stop and return a yes - answer if @xmath380 for some @xmath203 of size at least @xmath1 .",
    "notice that the sets @xmath371 can be constructed in time @xmath381 .",
    "since we try all possibilities to select @xmath26 , the running time is @xmath382 .",
    "now we observe that for any positive number @xmath383 , there is a constant @xmath384 such that after running our randomized algorithm @xmath385 times , we either get a yes - answer or can claim that with probability @xmath204 @xmath0 has no directed circuit with at least @xmath1 and at most @xmath241 arcs",
    ".    this algorithm can be derandomized by the technique proposed by alon , yuster and zwick  @xcite . to do it , we replace random colorings by a family of at most @xmath386 hash functions that can be constructed in time @xmath387 .",
    "let us recall that a fundamental cycle in undirected graph is formed from a spanning tree and a nontree edge .",
    "for undirected graphs , it is slightly more convenient to use the structural result by gabow and nie .",
    "[ thm : gabow - undir ] in a connected undirected graph having a cycle with @xmath1 edges , either every depth - first search tree has a fundamental cycle with at least @xmath1 edges or some cycle with at least @xmath1 edges has at most @xmath393 edges .",
    "[ lem : bound - length ] let @xmath0 be a ( directed ) graph without cycles of length at least @xmath1 . if @xmath0 has a circuit with at least @xmath1 edges ( arcs resp . )",
    ", then @xmath0 has a circuit with at least @xmath1 and at most @xmath394 edges ( arcs resp . ) .",
    "let @xmath41 be a circuit in @xmath0 .",
    "it is well - known ( see , e.g. , @xcite ) that @xmath41 is a union of edge - disjoint ( arc - disjoint ) cycles @xmath395 .",
    "moreover , it can be assumed that for any @xmath175 , the circuit @xmath396 is connected .",
    "suppose now that @xmath41 is a circuit with at least @xmath1 edges ( arcs resp . )",
    "that has minimum length",
    ". then the circuit @xmath397 has at most @xmath98 edges ( arcs resp . ) .",
    "since @xmath0 has no cycles of length at least @xmath1 , @xmath398 has at most @xmath98 edges ( arcs resp . ) .",
    "thus @xmath41 has at most @xmath394 edges ( arcs resp . ) .",
    "[ thm : fpt - edge ] the long circuit problem can be solved in @xmath391 expected time and in @xmath392 worst - case time for directed graphs with @xmath49 vertices and @xmath368 arcs , and in @xmath389 expected time and in @xmath390 worst - case time for undirected graphs with @xmath49 vertices and @xmath368 edges .",
    "first , we consider directed graphs .",
    "let @xmath0 be a directed graph . by theorem  [ thm : gabow - dir ]",
    ", we can check whether @xmath0 has a cycle with at least @xmath1 arcs .",
    "if we find such a cycle @xmath41 , then @xmath41 is a circuit with at least @xmath1 arcs , and we have a yes - answer .",
    "otherwise , we conclude that each cycle in @xmath0 is of length at most @xmath98 .",
    "then by lemma  [ lem : bound - length ] , if @xmath0 has a circuit with at least @xmath1 arcs , then it has a circuit with at least @xmath1 and at most @xmath394 arcs .",
    "we find such a circuit ( if it exist ) by solving at least @xmath1 and at most @xmath241-circuit for @xmath399 by making use of lemma  [ lem : atmost ] .",
    "combining the running times , we have that long circuit can be solved in @xmath391 expected time and in @xmath392 worst - case time .    for the undirected case ,",
    "we assume that the input graph @xmath0 is connected , as otherwise we can solve the problem for each component .",
    "we choose a vertex @xmath21 arbitrarily and perform the depth - first search from @xmath21 . in this way we find the fundamental cycles for the dfs - tree rooted in @xmath21 , and check whether there is a fundamental cycle of length at least @xmath1 .",
    "if we have such a cycle , then it is a circuit with at least @xmath1 edges , and we have a yes - answer .",
    "otherwise , by theorem  [ thm : gabow - undir ] , either @xmath0 has no cycles of length at least @xmath1 or @xmath0 has a cycle with at least @xmath1 and at most @xmath393 edges .",
    "if @xmath0 has no cycles with at least @xmath1 edges , then by lemma  [ lem : bound - length ] , if @xmath0 has a circuit with at least @xmath1 edges , it contains a circuit with at least @xmath1 and at most @xmath394 edges .",
    "we conclude that if the constructed fundamental cycles have lengths at most @xmath98 , then @xmath0 either has a circuit with at least @xmath1 and at most @xmath394 edges or has no circuit with at least @xmath1 edges .",
    "we check whether @xmath0 has a circuit with at least @xmath1 and at most @xmath394 edges by solving at least @xmath1 and at most @xmath241-circuit for @xmath399 using lemma  [ lem : atmost ] .",
    "since the depth - first search runs in linear time , we have that on undirected graphs long circuit can be solved in @xmath389 expected time and in @xmath390 worst - case time ."
  ],
  "abstract_text": [
    "<S> an undirected graph is eulerian if it is connected and all its vertices are of even degree . </S>",
    "<S> similarly , a directed graph is eulerian , if for each vertex its in - degree is equal to its out - degree . </S>",
    "<S> it is well known that eulerian graphs can be recognized in polynomial time while the problems of finding a maximum eulerian subgraph or a maximum induced eulerian subgraph are np - hard . in this paper </S>",
    "<S> , we study the parameterized complexity of the following euler subgraph problems :    * large euler subgraph : for a given graph @xmath0 and integer parameter @xmath1 , does @xmath0 contain an induced eulerian subgraph with at least @xmath1 vertices ? * long circuit : for a given graph @xmath0 and integer parameter @xmath1 , does @xmath0 contain an eulerian subgraph with at least @xmath1 edges ?    </S>",
    "<S> our main algorithmic result is that large euler subgraph is fixed parameter tractable ( fpt ) on undirected graphs . </S>",
    "<S> we find this a bit surprising because the problem of finding an induced eulerian subgraph with exactly @xmath1 vertices is known to be w[1]-hard . </S>",
    "<S> the complexity of the problem changes drastically on directed graphs . on directed graphs we obtained the following complexity dichotomy : large euler subgraph is np - hard for every fixed @xmath2 and is solvable in polynomial time for @xmath3 . for long circuit , </S>",
    "<S> we prove that the problem is fpt on directed and undirected graphs . </S>"
  ]
}