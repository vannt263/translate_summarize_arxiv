{
  "article_text": [
    "the aim of this review is to provide a snapshot of the present status of dynamical fermion simulations , both as regards their performance and the possible sources of systematic errors that are not fully under control , as well as an introduction to some of the algorithmic ideas that are currently being investigated .",
    "as the goal is to be pedagogical rather than exhaustive we do not attempt to summarise all of the algorithmic talks that were presented at this conference .    in",
    "we consider the present state of large - scale dynamical fermion computations , comparing their costs and their control of systematic errors .",
    "this leads us to consider the issue of the locality of using fractional powers of the fermion determinant in .",
    "in we consider various algorithms for introducing `` fat links '' in a differentiable way . in",
    "we review a new algorithm which allows a domain - decomposition approach to be used for lattice field theories . in",
    "we outline the theory behind some of the algorithms that are being used to include fractional powers of the fermion determinant ; the same techniques may be applied to evade instabilities in numerical integrators ( ) , as can some other clever tricks ( ) . finally , we consider in some detail algorithms for including the dynamical effects of on - shell chiral fermions in , and in particular emphasise that all the methods used may be considered to be different approximations to the neuberger operator .",
    "before comparing the performance and efficacy of the various dynamical fermion algorithms currently being used in large - scale numerical computations there some caveats that must be emphasised .",
    "since such computations are extremely expensive they have only been carried out at a small set of parameter values , and thus we can not reliably compare their results or behaviour in either the continuum or thermodynamic ( infinite volume ) limit .",
    "indeed , there are usually only results for two or fewer different lattice spacings .    for the same reason it is not possible to compare the performance of the algorithms at the same physical quark masses ; for this we would need to interpolate between runs with different dynamical ( not valence ) quark masses .",
    "some computations have been carried out with two quark flavours and others with three , and again we are forced to ignore these differences due to lack of data .",
    "since the cost of adding in a third heavy dynamical quark is usually small compared to the cost of the two lightest quarks this probably is not too important within the large error bars .",
    "it is very hard to make reliable estimates of the autocorrelation times involved , and thus to estimate the cost of generating statistically independent configurations from an equilibrium distribution .",
    "not only do results depends on the operator whose integrated autocorrelations are measured , but also on the physics of the system , such as the presence of nearby phase transitions .",
    "computations have been carried out on different lattice sizes , so we obviously need to compare the `` cost per unit volume . '' it would be wrong to assume navely that the cost of all algorithms scale linearly with the number of lattice sites @xmath0 at fixed lattice spacing @xmath1 : while the algorithm ( ) cost scales as @xmath2 for fixed ( volume - independent ) @xmath3 errors in the parameters of the effective action being simulated , the cost of the hybrid monte carlo ( hmc ) algorithm in free field hmc for a constant acceptance rate .",
    "we shall see later ( ) that for hmc computations involving light fermions the step size @xmath4 is constrained by instability in the integrator rather than by the bulk behaviour of the hmc hamiltonian , so a @xmath2 dependence might be more appropriate for hmc too . ]",
    "grows as @xmath5 .",
    "fortunately the effects of such different volume extrapolations are small compared to the errors in the cost estimates anyhow .",
    "= 0.45    -6ex    shows the approximate cost of evolving a @xmath6 lattice through one unit of md time as a function of the dynamical @xmath7 mass achieved .",
    "four types of fermion action have been used recently for large - scale computations .",
    "_ wilson / clover _ fermions seem to increase in cost as the @xmath7 mass is reduced much more rapidly than the other formulations ; indeed , there are runs at smaller @xmath7 mass which are so expensive that they lie significantly above the graph .",
    "it may be conjectured that this is because the dirac spectrum not bounded below , which is not the case for _ ks / staggered _ fermions ( where recent data from the milc collaboration use the improved action ) , _ twisted mass _ ( ) fermions , or _ domain wall _ ( gw / overlap ) fermions .",
    "the question of which formulation on - shell chiral fermions is best , or indeed whether such formulations are to be preferred at all , depends on how much chiral symmetry is required . at present dynamical gw fermions",
    "seem to be about 10100 times more expensive than the corresponding or runs at comparable masses .",
    "the figure also indicates subjective extrapolations for the costs .",
    "in particular it seems reasonable that the cost for dynamical domain wall fermions , or any other formulation exhibiting exact on - shell lattice chiral symmetry , should eventually become cheaper for light enough quarks because the chiral limit for them does not require taking the continuum limit .",
    "there has been much debate recently about whether dynamical fermion formulations that weight configurations with a non - integral power of the fermion determinant correspond to local quantum field theories ( qfts ) or not , and how significant locality is .",
    "for example , staggered quarks appear in multiples of four `` tastes ; '' when the staggered fermion fields are integrated over we are left with a fermion determinant @xmath8 in the functional integral .",
    "this is replaced by @xmath9 to obtain a corresponding two taste theory , and gauge configurations may be generated with this weight using inexact ( )  ( ) or exact ( phmc or rhmc ) algorithms  ( ) .",
    "if a qft is local then we are guaranteed that it has the cluster decomposition property , and that within the context of renormalized perturbation theory it satisfies the familiar power counting rules , exhibits universality , and is amenable to a systematic improvement procedure . on the other hand ,",
    "if it is not local then there is little we can say about these properties other than that we we have no _ a priori _ reason to expect them to hold . in particular , if we have a non - local lattice theory then we have no good reason to invoke power - counting arguments to justify taking the nave continuum limit , or to expect the lattice theory to be described by continuum perturbation theory however small the lattice spacing .",
    "the fact that a formulation is not manifestly local does not logically imply that it is not local .",
    "after all , it is easy to transform a manifestly local theory into an equivalent but non - manifestly - local form : we use this freedom to replace fermion fields with a non - manifestly - local fermion determinant , or an equally non - manifestly - local pseudofermion representation . for the case of two tastes of staggered fermions",
    "there may be a local fermion kernel @xmath10 such that @xmath11 , however , in general a non - manifestly local theory has no reason to be equivalent to a local one .",
    "even if there was a local action corresponding to taking fractional powers of the fermion determinant in the functional integral , we are still required to use this local action to measure fermionic quantities . for the case of staggered quarks",
    "this means one must use the hypothetical @xmath10 rather than @xmath12 for valence measurements .",
    "we should not expect that measuring operators corresponding to a local four taste valence action @xmath12 on configurations generated with @xmath13 to lead to consistent results . not only might there be unknown renormalisations of the parameters between the sea and valence actions ( e.g. , what is the justification for using the same numerical value for the quark masses ? ) but the degrees of freedom are not even the same . unless we know @xmath10 explicitly or are only interested in measuring purely gluonic observables we are forced into having a `` mixed action , '' that is different sea and valence actions , and such a situation suffers from the same problems , such as violation of unitarity , as quenched qcd .",
    "of course , one might hope that these problems do not occur , or at least are smaller than for an arbitrary mixed action situation , but these systematic errors are not quantitatively under control .",
    "some recent publications @xcite have studied the question as to whether the operator @xmath14 is in fact local . to make this question meaningful we need to specify which square root is under consideration .",
    "if the square root of the lattice operator is defined by taking the square roots of its eigenvalues in a basis in which it is diagonal then the sign of these roots is arbitrary . in the tests that have been carried out",
    "the square root has been defined by a polynomial approximation , which corresponds to choosing the positive square roots .",
    "suppose we applied this procedure to the wilson dirac operator @xmath15 ; we would find that the square root was non - local , because the local square root ( @xmath16 ) is not a positive operator .",
    "it is important to stress that the fact that @xmath14 appears to be non - local does not prove that there is no corresponding local operator @xmath10 with the same determinant ; on the other hand the only operator we know with this determinant ( and with staggered lattice symmetry ) is @xmath14 itself , so it is worthwhile verifying that it is not ( miraculously ) local as has sometimes been suggested as a possibility .",
    "after all , the neuberger operator appears to be local on sufficiently smooth gauge configurations  @xcite , despite the fact that it is not manifestly local .",
    "hoping for the existence of @xmath10 , or even proving it , is insufficient : we would need to use this operator for valence measurements in order to have a manifestly consistent unitary theory .",
    "let us now briefly review how the locality of a lattice dirac operator may be measured numerically .",
    "we define a `` wavefunction '' by applying a lattice dirac operator to a point source , @xmath17 .",
    "we then say that the corresponding qft is ultralocal if the wavefunction has `` compact support , '' @xmath18 , and is local if the wavefunction has `` fast decrease , '' @xmath19 , with @xmath20 being the localisation length .",
    "note that in both cases the wavefunction falls to zero at any non - zero physical distance in the continuum limit , thus corresponding to a local continuum theory .",
    "= 0.49    -6ex    typical results for the effective localisation length @xmath21\\right\\}^{-1}$ ] are shown in as a function of the physical distance ( @xmath22 is the sommer scale ) .",
    "the effective localisation length does not reach a plateau in the region where we may hope that finite - size effects are under control , so we can not extract a definite estimate of @xmath20 , on the other hand the evidence is that it must be non - zero at a non - zero physical distance , independent of @xmath1 , so the operator can not be local in the continuum limit .",
    "furthermore , the magnitude of the localisation length is comparable with the inverse @xmath7 mass , and thus use of @xmath14 would not lead to meaningful ( valence ) spectrum measurements .",
    "the reader is also referred to interesting related work in the schwinger model  @xcite .",
    "we shall now survey the topic of `` fat links . ''",
    "the idea of replacing gauge link variables by some average of their neighbours is not new , and for a long time has been used to construct operators that are good sources and sinks , in the sense that they have a better overlap with ground state .",
    "the basic idea is that instead of explicitly constructing a more complicated less local improved operator we use the simplest operator with the correct symmetries ( quantum numbers ) but taken as a function of the smeared or fattened link fields .",
    "the fattening procedure is thus equivalent to building a physical size smeared source . of course , to calculate masses and so forth we need to measure temporal correlation functions , and the sources and sinks for these should be localised in time , so we typically want to use spatial link fattening only in this case .",
    "another use of fat links which is becoming important as dynamical fermion computations become commonplace is that of smearing the action itself , in this case by computing the original action as a function of the fattened link fields . here",
    "the goal is to suppress uv fluctuations in the gauge fields .",
    "this may be considered as a means of constructing improved actions in the spirit of renormalisation - group improved ( or `` perfect '' ) actions , or systematic improvement in powers of @xmath1 ( either perturbative or not ) .",
    "there have recently been two main applications of fat links : improving gauge actions so as to produce smoother gauge fields upon which quenched gw dirac operators are localised , and improving fermionic actions themselves .",
    "we shall consider the latter here , as we are concerned with dynamical fermion algorithms .",
    "the problem with using a highly improved action such as hyp  @xcite or perfect actions  @xcite in dynamical computations is that we either need to find non - md - based algorithms for generating the gauge configurations including the effect of the fermion determinant , or we need to compute the md force corresponding to the improved actions .",
    "the most successful fat actions , such as hyp , used in quenched computations have been those where the fat links are somehow projected onto the group manifold . indeed",
    ", this seems to be a crucial ingredient for their success .",
    "unfortunately this projection would seem to be a non - differentiable operation ( i.e. , the fat links are not a smooth function of the original thin links ) . the first attempt to show that this was not necessarily so , and indeed that the md equations of motion for fat actions could be practicable , was using the flic ( fat link improved clover ) action  @xcite .",
    "let @xmath2 be the usual unprojected ape - smeared link , then the usual iterative projection @xmath23 where @xmath24 maximizes @xmath25 is not differentiable ; however by defining successively @xmath26 and @xmath27 instead we obtain a mapping that is almost differentiable . the `` almost ''",
    "is that differentiability fails along the branch cut of the cube root , but this does not seem too important in practice .",
    "= 0.4    another `` projection '' procedure which is truly differentiable is that of `` stout links ''  @xcite .",
    "let @xmath2 be a suitably smeared link and @xmath28 the corresponding thin link , so that @xmath29 is an untraced sum of plaquettes .",
    "this may be `` projected '' onto @xmath30 by first projecting it onto the @xmath31 algebra and then exponentiating it into the group , @xmath32 , where @xmath33 means the traceless antihermitian part .",
    "this is now differentiable , but it does not look too much like projection ( except when @xmath34 ) . in quenched tests",
    "stout links seem to be about as good as ordinary projected fat links , but require a little more tuning .",
    "these methods can be applied iteratively to produce differentiable links of arbitrary obesity .",
    "an interesting new algorithm based on the schwarz alternating procedure ( sap ) has been introduced by both as a preconditioner for solving the lattice dirac equation  @xcite and as dynamical fermion monte carlo algorithm  @xcite .",
    "the sap , introduced in 1870 , was probably the first domain decomposition method for solving the dirichlet problem for elliptic partial differential equations in complicated domains .",
    "the inequalities used in the convergence proof of the sap for pdes rely on the elliptic nature of the systems .",
    "= 0.5    -6ex    the basic idea is to decompose the lattice into blocks , and then update each block with boundary conditions specified by the most recent fields on the neighbouring blocks , as illustrated in . in the figure @xmath35 blocks",
    "are shown , but when considering the scaling behaviour of the algorithm the blocks should be taken to be of fixed physical size .",
    "when we invert the dirac operator on the lattice we modify the ( pseudo)fermion fields in a fixed gauge background . for a nearest - neighbour fermion",
    "kernel , such as the wilson dirac operator , the fermion fields in the even blocks are coupled only to those in other odd blocks and vice versa .",
    "we can thus alternate updates of all the even and all the odd block fields , giving a procedure that has a large degree of parallelism .",
    "notice that we are not just alternating single updates but we are alternating complete solutions of the dirichlet problem on each set of blocks .",
    "this procedure converges to the correct solution , but the rate of convergence is slow ; so instead of using sap as a solver we may use it as a preconditioner for a space solver ( such as gcr or fgmres ) . for this purpose",
    "accurate block solves are not required , as the preconditioner need only be an approximation to the inverse , and only a few schwarz cycles are required .",
    "this method seems to lead to a significant speed - up by a factor of 23 over a range of quark masses , as illustrated in .",
    "the algorithm parallelises easily , especially on coarse - grained architectures such as pc clusters .",
    "= 0.5    -6ex      a more radical use of the sap is as a dynamical fermion algorithm itself , in which we update the gauge fields in the blocks .",
    "the pseudofermion term in the action involves the inverse of the lattice dirac operator , and is thus manifestly non - local . in order to allow the update of a subset of the gauge links we make use of the schur complement factorisation of the quark determinant : @xmath36 .",
    "we indicate the grey and white block of by @xmath37 and @xmath38 respectively , and exterior boundaries ( indicated by white dots in the figure ) by @xmath39 and @xmath40 . this decomposition is easily derived from the ul factorisation @xmath41 we may now introduce two pseudofermion fields , @xmath42 with support on the interior of the blocks and @xmath43 with support on the boundary ; the associated pseudofermion part of the action being @xmath44 , with @xmath45 being the schur complement operator introduced above .",
    "the gauge fields on the `` active '' links within the blocks together with the @xmath42 pseudofermions can be equilibrated with @xmath43 held fixed , and then the effect of the `` schur complement '' interaction @xmath45 can be incorporated into a global hmc process .",
    "we occasionally shift the blocks to ensure all links get their turn to be active and thus updated .    according to the preliminary results that have been presented",
    ", this scheme successfully separates the short- and long - distance effects . within the blocks",
    "the smallest eigenvalues of the dirac operator are regulated by the inverse block size , whereas for the force due to the @xmath43 pseudofermions is small and only weakly mass dependent in the interior of the blocks ; this allows larger step sizes for the global hmc process .",
    "this looks very promising , and it will be interesting to see how the costs scale for very small quark masses . so far",
    "the procedure has been applied to wilson fermions , and it might be painful to generalise it for those fatter fermion actions for which the fraction of `` active '' links becomes smaller .",
    "previously in we discussed the validity of using a fractional power of the fermion determinant in order to circumvent the doubling problem for staggered fermions . in this section",
    "we shall ignore such matters of principal and consider the available repertoire of practical dynamical fermion algorithms available for this case .",
    "to date , all large - scale computations with two or three tastes of staggered quarks have used the  algorithm  @xcite .",
    "this is an inexact algorithm , in the sense that it is a markov process that converges to an equilibrium distribution that only approximates the desired one .",
    "it is based on the alternation of md trajectories and gaussian momentum refreshment , but with no accept / reject step to correct for non - zero step size errors . by using a clever combination of non - reversibility and area non - preservation in the md integrator , the  algorithm converges to a distribution with errors of @xmath3 in the parameters of the action . as already noted in these @xmath3 errors",
    "are volume independent .",
    "it is important to note that this result is an asymptotic expansion in @xmath4 , so there are also errors of the form @xmath46 which are only small if the quantity @xmath47 where @xmath48 is some suitable scale parameter .",
    "indeed , we may expect these non - analytic errors to become dominant at the same @xmath4 for which the md becomes unstable  ( ) ; we should not expect to be able to use a larger step size than for the corresponding exact hmc algorithms , except that instead of getting a tiny acceptance rate we would just quietly get an incorrect answer .",
    "the observation that the estimate of the errors in the equilibrium distribution is an asymptotic expansion .",
    "indeed , we may reasonably expect scaling for more highly - improved theories to break down at smaller values of @xmath1 .",
    "] tells us that we have no reason to expect the results for large @xmath4 to just correspond to a renormalisation of the parameters , as was originally suggested for the related langevin algorithm .",
    "relatively recently the polynomial  @xcite and rational  @xcite hybrid monte carlo algorithms have been developed .",
    "these permit the simulation of fractional powers of the fermion determinant without any concomitant systematic errors in the equilibrium distribution .",
    "the basic idea is to use a polynomial or rational function approximation to the power occurring in the action . recall that in the context of the hmc algorithm an approximate action suffices for md evolution , and an accurate action is only needed for the acceptance test .",
    "this permits us to use a relatively cheap approximation for each md step , and a more expensive approximation for the infrequent acceptance tests .",
    "the fermion kernel @xmath12 on the lattice is a large sparse matrix , and we wish to use its inverse square root , or more generally some continuous function @xmath49 of it .",
    "we define such functions on hermitian matrices by diagonalisation , if @xmath50 where @xmath51 is diagonal then @xmath52 .",
    "the key property of polynomial and rational functions is that they do not require the diagonalisation to be carried out explicitly , since @xmath53 and @xmath54 .",
    "the theory of optimal @xmath55 ( ) approximation over a compact interval is well understood : s theorem tells us that there is a unique optimal approximation characterised by having alternating error maxima of equal magnitude ( c.f . , ) . in general",
    "we can determine the coefficients of the optimal approximation numerically using  algorithm , but for the interesting cases of @xmath56 and @xmath57 they are have been calculated in closed form in terms of elliptic functions by .",
    "= 0.45    -6ex    it is not necessary to use the optimal approximation , but doing so leads to surprisingly small errors ; for example , if we consider rational approximations to @xmath56 of degree @xmath58 then the optimal / approximation has a maximum error of @xmath59 over @xmath60 , clearly has a maximum error of about  1 .",
    "it is worth emphasising the rle played by polynomials in the theory of optimal approximation .",
    "these polynomials are defined by @xmath61 , and have exactly @xmath62 alternating extrema of unit magnitude over the interval @xmath63 .",
    "this means that @xmath64 is the best approximation to @xmath65 of degree @xmath66.$ ] with respect to the weight @xmath67 , up to a trivial factor in the normalisation of @xmath68 . nevertheless , truncated expansions are not optimal in general , even for polynomials . ]",
    "there are some advantages of rational over polynomial approximations . in most cases",
    "the error for approximations of a given degree are much smaller for rational approximations ; for example for the @xmath69 $ ] error for @xmath70 is proportional to @xmath71 for the best rational approximation of degree @xmath72 whereas the best polynomial approximation has an error that only falls as @xmath73 .",
    "the rational approximation s exponential convergence means that it can be made exact to machine precision in a numerically stable and cheap manner .",
    "the obvious advantage of a polynomial approximation is that it does not require the numerical solution of systems of linear equations , but bear in mind that the polynomial approximation to @xmath74 corresponds to computing the matrix inverse using the method , as compared with the more efficient solvers that are used in the computation of rational approximations .",
    "if the rational functions are expressed as a partial fraction expansion , and a multi - shift solver  @xcite is used to compute all the necessary inverses simultaneously in the same space , then rational approximations are very competitive .",
    "in order to understand some of recent techniques for decreasing the cost of dynamical fermion hmc computations by increasing the integration step size we need to briefly review some earlier results on the mechanisms which limit these step sizes  @xcite .",
    "= 0.46    -6ex    in order to satisfy detailed balance and thus be an exact algorithm we need to use an area - preserving reversible md integration scheme within the hmc algorithm .",
    "fortunately symmetric symplectic integrators , of which the familiar leapfrog scheme is the lowest - order example , have these desirable properties .",
    "they are only exactly reversible up to floating - point rounding errors , and these errors become important when they are exponentially amplified by the chaotic nature of the underlying equations of motion  @xcite .",
    "this is illustrated in , where the exponent @xmath75 that characterizes this chaotic amplification is plotted as a function of the integration step size  @xmath4 .",
    "notice that @xmath76 in all three graphs ; this corresponds to the fact the underlying continuous time equations of motion are indeed chaotic .",
    "this interpretation is supported by the fact that the @xmath75 seems to have a constant value independent of @xmath4 .",
    "when @xmath4 exceeds some critical value @xmath77 then @xmath78 ; this corresponds to an instability of the leapfrog integrator , a phenomenon which occurs for the leapfrog scheme even for a single harmonic oscillator .",
    "@xmath77 depends on quark mass : for the quenched theory or the case of heavy fermions the instability occurs at values of @xmath4 so large that the acceptance rate is already essentially zero , since @xmath79 ; with light fermions the instability sets in for much smaller values of @xmath4 , and is what prevents larger step sizes from being used . indeed ,",
    "this is the reason why the use of higher - order symmetric symplectic integrators is not useful ; they increase the exponent @xmath72 characterising the growth of the bulk contribution , @xmath80 , but yet again this is only an asymptotic expansion and the contributions of the form @xmath81 dominate when @xmath82 .      in order to include the dynamical effects of fermions we need to evaluate a functional integral including the fermionic determinant @xmath8 .",
    "the usual method of doing so is to write this as a bosonic functional integral over a pseudofermion field with kernel @xmath83 , using the identity @xmath84 .",
    "we then alternate markov steps of ( i )  selecting a pseudofermion field from a gaussian heatbath with the gauge fields @xmath85 held fixed , and of ( ii )  updating the gauge fields , e.g. , by using an hmc algorithm , while keeping the pseudofermion fields fixed .",
    "this is a perfectly valid procedure , but we are introducing extra noise into the system by only using a single pseudofermion field to sample the functional integral .",
    "this noise manifests itself as fluctuations in the force exerted by the pseudofermions on the gauge fields ; this increases the maximum fermion force , which may trigger the integrator instability ; and this in turn requires us to decrease the integration step size .",
    "a less noisy estimate is to use the identity @xmath86^n $ ] to introduce @xmath72 _ multipseudofermion _ fields , @xmath87 this should increase the value of @xmath77 .      in the limit of an infinite number of multipseudofermions the force on the gauge fields",
    "is computed `` exactly , '' but this is not the same as computing the force due to @xmath8 , because the pseudofermions are updated at beginning of a gauge field trajectory , and do not represent @xmath8 except at the beginning of the trajectory .",
    "it is not at all clear that this is in any way a problem , however .",
    "alternating gauge field trajectories with pseudofermion heatbath updates is a valid markov chain with the correct equilibrium distribution .",
    "furthermore , the md ensures that the gauge fields evolve along a trajectory in the fixed pseudofermion background , and this is not the same trajectory as they would take under the `` instantaneous '' force due to @xmath8 .",
    "there appears to be no reason for the pseudofermion force along a trajectory to be larger for one sort of trajectory that for the other : they are just different markov chains with the same fixed point distribution .",
    "the first method of implementing multipseudofermions was introduced by hasenbusch  @xcite . for the case of the wilson fermion action",
    "@xmath88 he introduced the quantity @xmath89 , and used the identity @xmath90 to write the fermion determinant as @xmath91 .",
    "he then used a separate pseudofermion for each determinant , and tuned @xmath92 to minimise the cost .",
    "this method easily generalises to more than two pseudofermions , and to more complicated actions such as the wilson - clover action .",
    "another way of implementing multipseudofermions is to use the rhmc technique ( ) to implement @xmath72th root of the fermion kernel @xcite .",
    "following the usual procedure for rhmc we use a partial fraction expansion of the optimal rational approximation for @xmath72th root , and use a multishift solver to compute all the terms in the same space .",
    "the advantage of this approach is the no tuning is required , as the condition number @xmath93 is divided equally among all the multipseudofermions . if we make the nave assumption that the cost is proportional to condition number of the matrices we need to invert , then the condition number for each multipseudofermion kernel is @xmath94 , so the total fermionic force is reduced by factor @xmath95 . if this permits us to increase the step size by the same factor then the optimal value @xmath96 minimises the cost , with an optimal cost reduction of @xmath97 .",
    "of course , this argument is too nave , we can not reduce force by an arbitrarily large factor just by increasing the number of multipseudofermion fields  @xmath72 . at some point the fluctuations in the force coming from the stochastic estimate of the fermion determinant are no longer larger than the force itself , at which point increasing @xmath72 much further will not help .",
    "= 0.25    -7ex    an interesting `` replay '' trick for reducing fluctuations in @xmath98 along an hmc md trajectory has been suggested by and sommer  @xcite .",
    "consider the situation shown in .",
    "the system starts at point @xmath99 in phase space , and the energy change along the trajectory to @xmath100 with step size @xmath4 is @xmath101 .",
    "if @xmath101 is small , say @xmath102 , then we accept the new configuration with probability @xmath103 or else keep the old configuration @xmath28 ; but if @xmath104 we construct a more accurate trajectory from @xmath105 with step size @xmath106 . in order to ensure reversibility we need to make sure that this same reduced step size would be used if we started at @xmath107 , so we must verify that the fictitious energy change along the trajectory from @xmath108 with step size @xmath4 has energy change @xmath109 .",
    "if this is the case we accept @xmath110 with probability @xmath111 or else keep @xmath28 , and everything is area - preserving and reversible .",
    "if @xmath112 then we would not try reducing the step size in the reverse direction , so we fall back to accepting @xmath28 . by considering the cases where the energy changes @xmath101 , @xmath113 , and @xmath114 are negative , between 0 and 1 , and @xmath115 separately detailed balance is easily verified .",
    "this procedure is very useful if the system occasionally hits a large energy fluctuation , for example if it comes across an integrator instability .",
    "if such instabilities occur frequently then we must ask whether it would not be preferable just to reduce the step size ( say to @xmath106 ) for all trajectories . another issue to consider",
    "is that often these large @xmath98 changes occur as the system is approaching equilibrium , and we will be forced to reduce @xmath4 anyhow as the system becomes more equilibrated and `` sees '' the large force due to the light fermions .",
    "another interesting trick that is sometimes useful was introduced by sexton and weingarten  @xcite over a decade ago .",
    "their idea is to split md hamiltonian into two parts , usually corresponding to the boson and fermion parts of the action , and to construct a symmetric symplectic integrator with larger steps for more expensive ( fermion ) part by a clever application of the baker ",
    "campbell  hausdorff formula .",
    "this helps if the step size is limited by cheaper ( boson ) part , but unfortunately becomes less useful as @xmath116 when the step size is limited by the integrator instabilities induced by the fermion force .",
    "nevertheless , it is a useful technique when the large contributions to the force are not also the most expensive .",
    "we now turn to one of the most important developments of recent years : the formulation of on - shell chirally symmetric fermions on the lattice .",
    "our goal is to show that the various techniques developed for this purpose , such as the domain wall or overlap formulations , are equivalent , in the sense that they are just different approximations to the same on - shell chiral lattice theory .",
    "there are many variants of the methods , but they all seem to correspond to choosing ( explicitly or implicitly ) a rational approximation to the @xmath117 function , and of computing the inverse of the corresponding approximate neuberger operator .",
    "let us fix our notation and conventions : we shall work in euclidean space with hermitian @xmath118 matrices ; and we shall take all dirac operators to be @xmath119 hermitian , @xmath120 .",
    "although it was not the way the subject developed historically ( a matter that we will not even attempt to review here ) , an elegant logical approach @xcite is to ask if it is possible to have chiral symmetry on the lattice without doublers if we only insist that the symmetry holds on shell .",
    "such a transformation would have to be of the form @xmath121 which becomes a chiral transformation on - shell where @xmath122 .",
    "note that we are free to specify the chiral transformation properties of @xmath123 and @xmath124 independently .",
    "for this transformation to be a symmetry the dirac operator must be invariant @xmath125 for a small transformation , @xmath126 , this implies that @xmath127 , which is just the ginsparg  wilson ( gw ) relation @xmath128 .      we can find a solution of the ginsparg",
    " wilson relation as follows : let the lattice dirac operator be of the form @xmath129 , where @xmath130 , thus @xmath131 .",
    "this satisfies the ginsparg ",
    "wilson relation if @xmath132 , and it has the correct continuum limit @xmath133 if @xmath134 .",
    "both of these conditions are satisfied by the choice @xmath135.\\ ] ] there are many other possible solutions , but these essentially all correspond to just using a different dirac operator within neuberger s operator",
    ".    we should emphasise that we are only considering vector - like theories with a chiral symmetry here , chiral theories with unpaired weyl fermions can be discretised on the lattice , but getting the phase of the fermion measure correct is critical . simulating such theories is a much harder problem than the already challenging computations required for the case considered here .",
    "all numerical techniques for calculating with on - shell chiral fermions may be viewed as different ways of approximating neuberger s operator .",
    "it is relatively straightforward if somewhat expensive to apply the operator , for instance by using a rational or polynomial approximation to the @xmath117 function , but it is more challenging to apply its inverse .",
    "the difficulty is that neuberger s operator is constructed out of two non - commuting operators , @xmath119 and @xmath136 , so the inverse of a rational approximation is not just the reciprocal rational function .",
    "there are various ways the inverse may be computed : the most direct approach is by a nested space approach , where for every outer iteration a full inner inversion is required to apply the neuberger operator .",
    "the obvious problems with this approach are ( i )  the information built up in the inner space is not made use of in the outer space ; ( ii )  the accuracy ( residual ) required for the inner solves in order to reach a specified accuracy for the outer solve is not immediately obvious .",
    "quite a lot of work has gone into developing these techniques , including recent studies of various preconditioners and the use of `` flexible inverters '' for which the approximation used for the preconditioner may vary during the outer inversion  @xcite .",
    "an alternative approach to computing the inverse of the neuberger operator is to express it as a single inverse of a five dimensional operator .",
    "this may done is by linearising a continued fraction representation of a rational approximation to the neuberger operator  @xcite by the introduction of a set of @xmath137 auxiliary spinor fields ; these can be introduced either as constraints or as new dynamical variables . from this viewpoint",
    "the new `` fifth '' dimension is just an means of approximating the @xmath117 function , and the gauge fields are still only four dimensional .",
    "this is similar to the domain wall formulation  @xcite , and it is possible to translate domain wall fermions into an equivalent four - dimensional approximation to the neuberger operator  @xcite . to do this",
    "we first separate the left- and right - handed parts of the domain wall kernel and cyclically shift the latter by one site in the fifth dimension . in the domain wall formalism",
    "the four - dimensional fermion fields have their left - handed components on one wall and their right - handed components on the other wall , and the shift moves them both to the same wall , as well as reducing the kernel to a form in which we can identify an explicit fifth - dimensional transfer matrix  @xmath33 . in this form",
    "we can integrate out the bulk fermion fields , cancelling the jacobian with the contribution from the five - dimensional pseudofermion fields , and construct an effective four dimensional hamiltonian @xmath138 , which is the euclidean form of a cayley transform of the transfer matrix .",
    "this gives a higham approximation @xmath139 to the neuberger operator @xmath140 .",
    "borii also introduced the `` truncated overlap '' for which @xmath141 , and chiu has shown how to modify the domain wall formalism to give a approximation in the equivalent effective four - dimensional theory @xcite . at this meeting brower ,",
    "originos , & neff @xcite introduced `` mbius fermions , '' which interpolate between domain wall and truncated overlap fermions .",
    "we see that there are many formulations of overlap fermions , all of which satisfy the gw relation , and which are equivalent in continuum limit .",
    "the principal differences between them are that they use different lattice dirac operators within the @xmath117 function , and different approximations to the @xmath117 function .",
    "this is presumably also true for perfect actions .",
    "the choice between the formulations is essentially just a trade - off between computational speed and the amount of chiral symmetry breaking .      to date",
    ", most applications of on - shell chiral fermions have been for valence computations , but of course we need to introduce dynamical ( sea ) overlap fermions too in order to be able to obtain reliable chiral results from full qcd .",
    "the first studies of dynamical overlap were carried out in the schwinger model  @xcite several years ago .",
    "large - scale dynamical domain - wall qcd computations have been carried out by the rbc collaboration  @xcite .",
    "recently fodor , katz , & szab  @xcite and cundy , krieg , frommer , lippert , & schilling  @xcite have studied dynamical overlap fermions in qcd on `` ridiculously small lattices . ''    apart from the issues in common with valence overlap computations that we have discussed previously , hmc computations involving overlap fermions require the computation of the md force . in particular , there is an issue concerning what to do when one of the eigenvalues of @xmath16 passes through zero , which for continuous time md evolution with an exact neuberger operator would lead to a singular force .",
    "if a polynomial or rational approximation to the @xmath117 function is used then this is readily differentiable and leads to a computable force term , so one method of handling the singular force is just to observe that there is no discontinuity in the approximations to the @xmath117 function .",
    "this is effectively the method used in the dynamical domain wall computations , where the higham approximation is implicitly used and which , for practicable values of @xmath137 , smoothes the discontinuity enough to keep the force under control .",
    "of course , this is just a reflection of the fact that chiral symmetry is not very well approximated .",
    "another approach @xcite is to modify the leapfrog integrator to reflect or refract at a zero crossing in such a way that the md process is still exactly reversible and area preserving",
    ". it will be interesting which , if any , of these approaches avoids the hmc acceptance rate becoming small due to zero crossings .",
    "we also note the suggestion  @xcite of working in the chiral sector with no zero modes , and explicitly reweighting the configurations with @xmath142 where @xmath143 is the topological charge .",
    "we are at an interesting point in the development of algorithms for dynamical fermion computations in qcd . on the one hand",
    "it is now generally accepted that quenching leads to significant systematic errors , and that to proceed towards reliable higher accuracy calculations we need to include dynamical fermions one way or another . on the other hand",
    ", there is much debate about whether the systematic errors of two or three flavour staggered quark simulations are under control .",
    "recent progress with dynamical and gw fermions also show that the prospects for carrying out large - scale dynamical computations with light quarks , with all sources of systematic errors under control , and even with good chiral symmetry properties should be expected with the current or next generation of computers .",
    "i would like to thank martin and urs wenger for making helpful comments on draft versions of this article ."
  ],
  "abstract_text": [
    "<S> we consider recent progress in algorithms for generating gauge field configurations that include the dynamical effects of light fermions . </S>",
    "<S> we survey what has been achieved in recent state - of - the - art computations , and examine the trade - offs between performance and control of systematic errors . </S>",
    "<S> we briefly review the use of polynomial and rational approximations in hybrid monte carlo algorithms , and some of the theory of on - shell chiral fermions on the lattice . </S>",
    "<S> this provides a theoretical framework within which we compare algorithmic alternatives for their implementation ; and again we examine the trade - offs between speed and error control . </S>"
  ]
}