{
  "article_text": [
    "a primary focus in algebraic statistics is the study of statistical models that can be represented by polynomials in the model parameters .",
    "this class of algebraic statistical models includes graphical models for both gaussian and discrete random variables @xcite . in this article",
    "we study a family of binary graphical models with hidden variables .",
    "the underlying graph is the complete bipartite graph @xmath0 :    @xmath1    the @xmath2 white nodes in the top row of figure [ fig : rbm ] represent hidden random variables .",
    "the @xmath3 black nodes in the bottom row represent observed random variables . the _ restricted boltzmann machine _ ( rbm ) is the undirected graphical model for binary random variables specified by this bipartite graph .",
    "we identify the model with its set of joint distributions which is a subset @xmath4 of the probability simplex @xmath5 .",
    "the graphical model for gaussian random variables represented by figure [ fig : rbm ] is the _ factor analysis _ model , whose algebraic properties were studied in @xcite .",
    "thus , the restricted boltzmann machine is the binary undirected analog of factor analysis .",
    "our aim here is to study this model from the perspectives of algebra and geometry . unlike in the factor analysis study @xcite , an important role",
    "will now be played by _ tropical geometry _",
    "this was already seen for @xmath6 and @xmath7 in the solution by cueto and yu @xcite of the implicitization challenge in ( * ? ? ?",
    "* problem 7.7 ) .",
    "the restricted boltzmann machine has been the subject of a recent resurgence of interest due to its role as the building block of the deep belief network .",
    "deep belief networks are designed to learn feature hierarchies to automatically find high - level representations for high - dimensional data .",
    "a deep belief network comprises a stack of restricted boltzmann machines . given a piece of data ( state of the lowest visible variables ) , each layer s most likely hidden states are treated as data for the next layer . a new effective training methodology for deep belief networks , which begins by training each layer in turn as an rbm using contrastive divergence , was introduced by hinton et al .",
    "this method led to many new applications in general machine learning problems including object recognition and dimensionality reduction @xcite .",
    "while promising for practical applications , the scope and basic properties of these statistical models have only begun to be studied .",
    "for example , le roux and bengio @xcite showed that any distribution with support on @xmath8 visible states may be arbitrarily well approximated provided there are at least @xmath9 hidden nodes .",
    "therefore , any distribution can be approximated with @xmath10 hidden nodes .",
    "the question which started this project is whether the restricted boltzmann machine is identifiable .",
    "the dimension of the fully observed binary graphical model on @xmath0 is equal to @xmath11 , the number of nodes plus the number of edges .",
    "we conjecture that this dimension is preserved under the projection corresponding to the algebraic elimination of the @xmath2 hidden variables .",
    "here is the precise statement :    [ conj : main ] the restricted boltzmann machine has the expected dimension , i.e.  @xmath4 is a semialgebraic set of dimension @xmath12 in @xmath5 .",
    "this conjecture is shown to be true in many special cases .",
    "in particular , it holds for all @xmath2 when @xmath13 is a power of @xmath14 .",
    "this is a consequence of the following :    [ thm : looksreasonable ] the restricted boltzmann machine has the expected dimension @xmath12 when @xmath15 and when @xmath16 .",
    "we note that theorem [ thm : looksreasonable ] covers most cases of restricted boltzmann machines as used in practice , as those generally satisfy @xmath17 .",
    "the case of large @xmath2 is primarily of theoretical interest and has been studied recently in @xcite .",
    "this paper is organized as follows . in section",
    "2 we introduce four geometric objects , namely , the rbm model , the rbm variety , the tropical rbm model , and the tropical rbm variety , and we formulate a strengthening of conjecture [ conj : main ]",
    ". section  3 is concerned with the case @xmath18 . here",
    "the rbm variety is the variety of secant lines of the segre variety @xmath19 .",
    "the general case @xmath20 arises from that secant variety by way of a construction we call the _ hadamard product of projective varieties _ , as shown in proposition [ prop : hadamard ] . in section  4",
    "we analyze the tropical rbm model , we establish a formula for its dimension ( theorem [ thm : cornercuts ] ) , and we draw on results from coding theory to derive theorem [ thm : looksreasonable ] and table [ tab : knownspecialcases ] . in section  5",
    "we study the piecewise - linear map that parameterizes the tropical rbm model .",
    "the _ inference functions _ of the model ( in the sense of @xcite ) are @xmath2-tuples of _ linear threshold functions_. we discuss the number of these functions .",
    "figure [ fig : tm^1_3 ] shows the combinatorial structure of the tropical rbm model for @xmath21 and @xmath22 .",
    "we begin with an alternative definition of the restricted boltzmann machine .",
    "this `` machine '' is a statistical model for binary random variables where @xmath3 of the variables are visible and @xmath2 of the variables are hidden .",
    "the states of the hidden and visible variables are written as binary vectors @xmath23 and @xmath24 respectively .",
    "we introduce @xmath11 model parameters , namely , the entries of a real @xmath25 matrix @xmath26 and the entries of two vectors @xmath27 and @xmath28 , and we set @xmath29 the probability distribution on the visible random variables in our model equals @xmath30 where @xmath31 is the _ partition function_. we denote by @xmath4 the subset of the open probability simplex @xmath32 consisting of all such distributions @xmath33 as the parameters @xmath34 and @xmath35 run over @xmath36 , @xmath37 and @xmath38 respectively .    in what follows we refer to @xmath4 as the _ rbm model _ with @xmath3 visible nodes and @xmath2 hidden nodes .",
    "it coincides with the binary graphical model associated with the complete bipartite graph @xmath0 as described in the introduction .",
    "this is indicated in figure [ fig : rbm ] by the labeling with the states @xmath39 and the model parameters @xmath40 .",
    "the parameterization in ( [ eq : psi ] ) is not polynomial because it involves the exponential function .",
    "however , it is equivalent to the polynomial parameterization obtained by replacing each model parameter by its value under the exponential function : @xmath41 this coordinate change translates ( [ eq : psi ] ) into the squarefree monomial @xmath42 and we see that the probabilities in ( [ eq : distribution ] ) can be factored as follows : @xmath43 the rbm model @xmath44 is the image of the polynomial map @xmath45 whose @xmath46th coordinate equals ( [ eq : distribution ] ) .",
    "this shows that @xmath44 is a semialgebraic subset of @xmath5 .",
    "when faced with a high - dimensional semialgebraic set arising in statistics , it is often useful to simplify the situation by disregarding all inequalities and by replacing the real numbers @xmath47 by the complex numbers @xmath48 .",
    "this leads us to considering the zariski closure @xmath49 of the rbm model @xmath44 .",
    "this is the algebraic variety in the complex projective space @xmath50 parameterized by ( [ eq : distribution2 ] ) .",
    "we call @xmath49 the _ rbm variety_.    given any two subvarieties @xmath51 and @xmath52 of a projective space @xmath53 , we define their _ hadamard product _",
    "@xmath54 to be the closure of the image of the rational map @xmath55 for any projective variety @xmath51 , we may consider its hadamard square @xmath56 } = x * x$ ] and its higher hadamard powers @xmath57 } \\ , = \\,x * x^{[k-1]}$ ] . if @xmath58 is a subset of the open simplex @xmath59 then its hadamard powers @xmath60}$ ] are also defined by componentwise multiplication followed by rescaling so that the coordinates sum to one .",
    "this construction is compatible with taking zariski closures , i.e.  we have @xmath61 } } =   \\overline{m}^{[k]}$ ] .    in the next section",
    "we shall take a closer look at the case @xmath18 , and we shall recognize @xmath62 as a secant variety and @xmath63 as a phylogenetic model . here , we prove that the case of @xmath20 hidden nodes reduces to @xmath18 using hadamard powers .",
    "[ prop : hadamard ] the rbm variety and model factor as hadamard powers : @xmath64 } \\quad \\hbox{and } \\quad m^k_n \\,=\\ , ( m^1_n)^{[k]}.\\ ] ]    a strictly positive vector @xmath65 with coordinates @xmath66 as in ( [ eq : distribution2 ] ) admits a componentwise factorization into similar vectors for @xmath18 , and , conversely , the componentwise product of @xmath2 probability distributions in @xmath63 becomes a distribution in @xmath44 after division by the partition function .",
    "hence @xmath67}$ ] in @xmath5 .",
    "the equation @xmath68 } $ ] follows by passing to the zariski closure in @xmath50 .    the emerging field of _ tropical mathematics _",
    "is predicated on the idea that @xmath69 is approximately equal to @xmath70 when @xmath71 and @xmath72 are quantities of different scale . for a first introduction see @xcite , and for further reading see @xcite and references therein .",
    "the process of passing from ordinary arithmetic to the max - plus algebra is known as _",
    "tropicalization_. the same approximation motivates the definition of the _ softmax _ function in the neural networks literature .",
    "a statistical perspective is offered in work by pachter and the third author @xcite .    if @xmath73 approximates @xmath74 in the sense of tropical mathematics , and if we disregard the global additive constant @xmath75 , then ( [ eq : distribution ] ) translates into the formula @xmath76 this expression is a piecewise - linear concave function @xmath77 on the space of model parameters @xmath78 .",
    "as @xmath46 ranges over @xmath79 , there are @xmath80 such concave functions , and these form the coordinates of a piecewise - linear map @xmath81 here @xmath82 denotes the _ tropical projective space _",
    "@xmath83 , as in @xcite .",
    "the image of the map @xmath84 is denoted @xmath85 and is called the _ tropical rbm model_. the map @xmath84 is the _ tropicalization _ of the given parameterization of the rbm model .",
    "it is our objective to investigate its geometric properties .",
    "this situation fits precisely into the general scheme of parametric maximum a posterior ( map ) inference introduced in @xcite and studied in more detail by elizalde and woods @xcite . in section  5 below , we discuss the statistical relevance of the map @xmath84 and we examine its geometric properties .",
    "of particular interest are the domains of linearity of @xmath84 , and how these are mapped onto the cones of the model @xmath85 .",
    "finally , we define the _ tropical rbm variety _",
    "@xmath86 to be the tropicalization of the rbm variety @xmath49 .",
    "as explained in @xcite and @xcite , the tropical variety @xmath86 is the intersection in @xmath82 of all the tropical hypersurfaces @xmath87 where @xmath88 runs over _ all _ polynomials that vanish on @xmath49 ( or on @xmath44 ) . by definition , @xmath87 is the union of all codimension one cones in the normal fan of the newton polytope of @xmath88 .",
    "if the homogeneous prime ideal of the variety @xmath49 were known then the tropical variety @xmath86 could in theory be computed using the algorithms in @xcite which are implemented in the software gfan ( @xcite ) .",
    "however , this prime ideal is not known in general .",
    "in fact , even for small instances , its computation is very hard and relies primarily on tropical geometry techniques such as the ones developed in @xcite .",
    "for instance , the main result in @xcite states that the rbm variety @xmath89 is a hypersurface of degree @xmath90 in @xmath91 , and it remains a challenge to determine a formula for the defining irreducible polynomial of this hypersurface . to appreciate this challenge , note that the number of monomials in the relevant multidegree equals @xmath92 .    here is a brief summary of the four geometric objects we have introduced :    * the semialgebraic set @xmath93 of probability distributions represented by the restricted boltzmann machine .",
    "we call @xmath44 the _ rbm model_. * the zariski closure @xmath49 of the rbm model @xmath44",
    ". this is an algebraic variety in the complex projective space @xmath50 .",
    "we call @xmath49 the _ rbm variety_. * the tropicalization @xmath86 of the variety @xmath49 .",
    "this is a tropical variety in the tropical projective space @xmath94 .",
    "we call @xmath86 the _ tropical rbm variety_. * the image @xmath85 of the tropicalized parameterization @xmath84 .",
    "this is the subset of @xmath94 consisting of all optimal score value vectors in the map inference problem for the rbm .",
    "we call @xmath85 the _ tropical rbm model_.    we have inclusions @xmath95 and @xmath96 .",
    "the latter inclusion is the content of the second statement in ( * ? ? ?",
    "* theorem 2 ) .",
    "we shall see that both inclusions are strict even for @xmath97 .",
    "for example , @xmath98 is a proper subset of @xmath99 since points in this set must satisfy the inequality @xmath100 as indicated in theorem [ thm : wishfulthinking ] below .",
    "likewise , @xmath101 is a proper subfan of @xmath102 .",
    "this subfan will be determined in our discussion of the secondary fan structure in example [ ex52 ] .",
    "the dimensions of our four geometric objects satisfy the following chain of equations and inequalities : @xmath103 here , the tropical objects @xmath85 and @xmath86 are polyhedral fans , and by their dimension we mean the dimension of any cone of maximal dimension in the fan . when speaking of the dimension of @xmath49 we mean the krull dimension of the projective variety , and for the model @xmath44 we mean its dimension as a semialgebraic set .    the leftmost inequality in ( [ ineqchain ]",
    ") holds because @xmath104 .",
    "the left equality holds by the bieri - groves theorem ( cf .",
    "* theorem 4.5 ) ) which ensures that every irreducible variety has the same dimension as its tropicalization .",
    "the second equality follows from standard real algebraic geometry results because @xmath4 has a regular point and is zariski dense in @xmath105 .",
    "finally , the rightmost inequality in ( [ ineqchain ] ) is seen by counting parameters in the definition ( [ eq : psi])([eq : distribution ] ) of the rbm model @xmath4 , and by bounding its dimension by the dimension of the ambient space @xmath5 .",
    "we conjecture that both of the inequalities in ( [ ineqchain ] ) are actually equalities :    [ conj : main2 ] the tropical rbm model has the expected dimension , i.e.  @xmath106 is a polyhedral fan of dimension @xmath12 in @xmath82 .    in light of the inequalities ( [ ineqchain ] ) ,",
    "conjecture [ conj : main2 ] implies conjecture [ conj : main ] . in section  4",
    "we shall prove some special cases of these conjectures , including theorem  [ thm : looksreasonable ] .",
    "we saw in proposition [ prop : hadamard ] that the rbm for @xmath107 can be expressed as the hadamard power of the rbm for @xmath18 .",
    "therefore , it is crucial to understand the model with one hidden node . in this section",
    "we fix @xmath18 and we present an analysis of that case . in particular , we shall give a combinatorial description of the fan @xmath108 which shows that it has dimension @xmath109 , as stated in conjecture [ conj : main2 ] .",
    "we begin with a reparameterization of our model that describes it as a secant variety .",
    "let @xmath110 , @xmath111 , @xmath112 be real parameters which range over the open interval @xmath113 , and consider the polynomial map @xmath114 whose coordinates are given by @xmath115    [ prop : secantdescriptionm1n ] the image of @xmath65 coincides with the rbm model @xmath63 .",
    "recall the parameterization   of the rbm model @xmath63 from section  2 : @xmath116 we define a bijection between the parameter spaces @xmath117 and @xmath118 as follows : @xmath119 @xmath120 this substitution is invertible and it transforms ( [ eq : distribution4 ] ) into ( [ eq : distribution3 ] ) .",
    "proposition  [ prop : secantdescriptionm1n ] shows that @xmath63 is the first mixture of the independence model for @xmath3 binary random variables . in phylogenetics",
    ", it coincides with the _ general markov model on the star tree _ with @xmath3 leaves .",
    "a semi - algebraic characterization of that model follows as a special case from recent results of zwiernik and smith  @xcite .",
    "we shall present and discuss their characterization in theorem [ thm : wishfulthinking ] below .",
    "first , however , we remark that the zariski closure of a mixture of an independence model is a secant variety of the corresponding segre variety .",
    "this fact is well - known ( see e.g. @xcite ) and is here easily seen from ( [ eq : distribution3 ] ) .",
    "we conclude :    the first rbm variety @xmath121 coincides with the first secant variety of the segre embedding of the product of projective lines @xmath122 into @xmath123 , and the first tropical rbm variety @xmath124 is the tropicalization of that secant variety .",
    "we next describe the equations defining the first secant variety @xmath121 .",
    "the coordinate functions @xmath66 are the entries of an @xmath3-dimensional table of format @xmath125 . for each set partition @xmath126 we can write this table as an ordinary two - dimensional matrix of format @xmath127 , with rows indexed by @xmath128 and columns indexed by @xmath129 .",
    "these matrices are the _ flattenings _ of the @xmath125-table .",
    "pachter and sturmfels ( * ? ? ?",
    "* conjecture 13 ) conjectured that the homogeneous prime ideal of the projective variety @xmath130 is generated by the @xmath131-minors of all the flattenings of the table @xmath132 .",
    "this conjecture has been verified computationally for @xmath133 .",
    "a more general form of this conjecture was stated in @xcite .",
    "the set - theoretic version of that general conjecture was proved by landsberg and manivel in ( * ? ? ?",
    "* theorem 5.1 ) .",
    "their results imply :    [ thm : flat ] the projective variety @xmath130 is the common zero set of the @xmath131-minors of all the flattenings of the table @xmath132 .",
    "we now come to the inequalities that determine @xmath63 among the real points of @xmath121 . for any pair of indices @xmath134",
    "we write @xmath135 for the covariance of the two random variables @xmath136 and @xmath137 obtained by marginalizing the distribution , and we write @xmath138 for the @xmath139-covariance matrix .",
    "we regard @xmath140 as a polynomial map from the simplex @xmath5 to the space @xmath141 of symmetric @xmath139-matrices .",
    "the off - diagonal entries of the covariance matrix @xmath140 are the @xmath142-minors obtained by marginalization from the table @xmath143 . for example , for @xmath6",
    "the covariances are @xmath144    zwiernik and smith @xcite gave a semi - algebraic characterization of the general markov model on a trivalent phylogenetic tree in terms of covariances and moments .",
    "the statement of their characterization is somewhat complicated , so we only state a weaker necessary condition rather than the full characterization .",
    "specifically , applying ( * ? ? ?",
    "* theorem 7 ) to the star tree on @xmath3 leaves implies the following result .",
    "[ thm : wishfulthinking ] if a probability distribution @xmath145 lies in the first rbm model @xmath63 then all its matrix flattenings ( as in theorem [ thm : flat ] ) have rank @xmath146 and @xmath147    these inequalities follow easily from the parameterization ( [ eq : distribution4 ] ) , which yields @xmath148 this factorization also shows that the binomial relations @xmath149 hold on @xmath63 . these same binomial relations",
    "are valid for the covariances in factor analysis ( * ? ? ?",
    "* theorem 16 ) , thus further underlining the analogies between the gaussian case and the binary case .",
    "theorem 20 in @xcite extends the covariance equations @xmath149 to a collection of quadratic binomial equations in all tree - cumulants , which in turn can be expressed in terms of higher order correlations . for the star tree ,",
    "these equations are equivalent on @xmath5 to the rank @xmath150 constraints . however , for general tree models , the binomial equations in the tree - cumulants are necessary conditions for distributions to lie in these models .",
    "we now turn to the tropical versions of the rbm model for @xmath18 . the variety @xmath121 is cut out by the @xmath151-minors of all flattenings of the table @xmath152 .",
    "it is known that the @xmath153-minors of * one * fixed two - dimensional matrix form a tropical basis ( cf .",
    "@xcite ) . indeed ,",
    "that statement is equivalent to ( * ? ? ?",
    "* theorem 6.5 ) .",
    "it is natural to ask whether the tropical basis property continues to hold for the set of * all * @xmath153-determinants in theorem [ thm : flat ] .",
    "since each flattening of our table corresponds to a non - trivial edge split of a tree on @xmath3 taxa ( i.e. a partition of the set of taxa into two sets each of cardinality @xmath154 ) , our question can be reformulated as follows :    [ conj : intersectionofedgesplits ] is the tropical rbm variety @xmath124 equal to the intersection of the tropical rank @xmath14  varieties associated to non - trivial edge splits on a collection of trees on @xmath3 taxa ?",
    "the tropical rank two varieties associated to each of the edge splits have been studied recently by markwig and yu @xcite .",
    "they endow this determinantal variety with a simplicial fan structure that has the virtue of being shellable .",
    "the cones of this simplicial fan correspond to weighted bicolored trees on @xmath155 taxa with no monochromatic cherries .",
    "the points in a cone can be viewed as a matrix encoding the distances between leaves with different colors in the weighted bicolored tree .",
    "question  [ conj : intersectionofedgesplits ] is void for @xmath156 , so the first relevant case concerns @xmath6 taxa .",
    "we were surprised to learn that the answer is negative already in this case :    [ ex:2222 ] the prime ideal of the variety @xmath157 is generated by the @xmath131-minors of the three flattenings of the @xmath158-table @xmath65 . as a statistical model ,",
    "each one of the three flattenings corresponds to the graphical model associated to each one of the quartet trees @xmath159 , @xmath160 and @xmath161 , as depicted in figure  [ fig : quartets ] .",
    "algebraically , each flattening corresponds to the variety cut out by the @xmath131-minors of a @xmath162-matrix of unknowns .",
    "these minors form a tropical basis .",
    "the tropical variety they define is a pure fan of dimension @xmath163 in @xmath164 with a 6-dimensional lineality space .",
    "the simplicial fan structure on this variety given by @xcite has the @xmath88-vector @xmath165 .",
    "combinatorially , this object is a shellable @xmath166-dimensional simplicial complex which is the bouquet of @xmath167 spheres .",
    "however , this determinantal variety admits a different fan structure , induced from the grbner fan as in @xcite , or from the fact that the sixteen @xmath131-minors form a tropical basis .",
    "its @xmath88-vector is @xmath168 .",
    "the tropical variety @xmath169 is a pure fan of dimension @xmath170 in @xmath164 .",
    "its lineality space has dimension @xmath166 , and the cones of various dimensions are tallied in its @xmath88-vector @xmath171 question  [ conj : intersectionofedgesplits ] asks whether the @xmath170-dimensional tropical variety @xmath169 is the intersection of the three @xmath163-dimensional tropical determinantal varieties associated with the three trees in figure [ fig : quartets ] .",
    "the answer is `` no '' . using the software gfan @xcite",
    ", we computed the tropical prevariety cut out by the union of all forty - eight @xmath153-minors .",
    "the output is a _ non - pure _ polyhedral fan of dimension @xmath172 with a @xmath166-dimensional lineality space ( the same one as of @xmath169 ) , having @xmath88-vector @xmath173 .",
    "the tropical variety @xmath169 is a triangulation of a proper subfan , and each of the @xmath174 10-dimensional maximal cones lies in the prevariety but not in the variety .",
    "an example of a vector in the relative interior of a maximal cone is @xmath175 ( here , coordinates are indexed in lexicographic order @xmath176 ) . given the weights @xmath177 , the initial form of each @xmath153-minor of each flattening is a binomial , however , the initial form of the following polynomial in the ideal of @xmath157 is the underlined monomial : @xmath178 anders jensen performed another computation , using gfan and soplex  @xcite , which verified that we get a tropical basis by augmenting the @xmath153-minors with the above quartic and its images under the symmetry group of the @xmath166-cube .",
    "this is a non - trivial computation because the corresponding fan structure on @xmath169 has the @xmath88-vector @xmath179 using the language of @xcite , we may conclude from our computational results that the notions of tropical rank and kapranov rank disagree for @xmath158-tensors .",
    "last but not least , we examine the tropical model @xmath180 .",
    "this is a proper subfan of the tropical variety @xmath124 , namely , @xmath108 is the image of the tropical morphism @xmath181 which is the specialization of ( [ eq : phi ] ) for @xmath18 .",
    "equivalently , @xmath84 is the tropicalization of the map ( [ eq : distribution4 ] ) , and its coordinates are written explicitly as @xmath182 this concave function is the maximum of two linear functions .",
    "the @xmath109 parameters are given by a column vector @xmath27 , a row vector @xmath183 , and a scalar @xmath184 .",
    "a different  but entirely equivalent  tropicalization can be derived from ( [ eq : distribution3 ] ) .",
    "as @xmath46 ranges over @xmath79 , there are @xmath80 such concave functions , and these form the coordinates of the tropical morphism @xmath84 .",
    "we note that @xmath84 made its first explicit appearance in ( * ? ? ?",
    "* equation ( 10 ) ) , where it was discussed in the context of _ ancestral reconstruction _ in statistical phylogenetics .",
    "subsequently , develin @xcite and draisma @xcite introduced a tropical approach to secant varieties of toric varieties , and our model fits well into the context developed by these two authors .",
    "the first tropical rbm model @xmath108 is the image of the tropical secant map for the segre variety @xmath122 in the sense of develin @xcite and draisma @xcite .",
    "the linear space for their constructions has basis @xmath185 , and the underlying point configuration consists of the vertices of the @xmath3-cube .    in light of example [ ex:2222 ]",
    ", it makes sense to say that the @xmath186-tensors in the tropical variety @xmath124 are precisely those that have _ kapranov ( tensor ) rank _ @xmath146 . this would be consistent with the results and nomenclature in @xcite . a proper subset of the tensors of kapranov rank @xmath146 are those that have _ barvinok ( tensor ) rank _ @xmath146 .",
    "these are precisely the points in the first tropical rbm model @xmath108 .",
    "we close this section by showing that @xmath108 has the expected dimension :    [ prop : rbm1 ] the dimension of the tropical rbm model @xmath108 is @xmath109 .",
    "each region of linearity of the map @xmath84 is defined by a partition @xmath187 of @xmath79 into two disjoint subsets @xmath188 and @xmath189 , according to the condition @xmath190 or @xmath191 .",
    "thus , the corresponding region is an open convex polyhedral cone , possibly empty , in the parameter space @xmath192 .",
    "it consists of all triples @xmath193 such that @xmath194 for @xmath195 and @xmath196 for @xmath197 .",
    "assuming @xmath198 , we can choose a partition @xmath187 of @xmath79 such that this cone is non - empty and both @xmath188 and @xmath189 affinely span @xmath199 .",
    "the image of the cone under the map @xmath84 spans a space isomorphic to the direct sum of the images of @xmath200 and @xmath201 .",
    "hence this image has dimension @xmath109 , as expected .",
    "an illustration of the proof of proposition [ prop : rbm1 ] is given in figure [ fig : slicingn=3 ] .",
    "the technique of partitioning the vertices of the cube will be essential in our dimension computations for general @xmath2 in the next section . in section  5",
    "we return to the small models @xmath108 and take a closer look at their geometric and statistical properties .",
    "this section is concerned with conjecture  [ conj : main2 ] which states that the tropical rbm model has the expected dimension .",
    "namely , our aim is to show that @xmath203 for @xmath18 this is proposition [ prop : rbm1 ] , and we now consider the general case @xmath107 .",
    "our main tool towards this goal is the dimension formula in theorem [ thm : cornercuts ] below . as in the previous section , we study the regions of linearity of the tropical morphism @xmath84 .",
    "let @xmath204 denote the matrix of format @xmath205 whose rows are the vectors in @xmath79 .",
    "a subset @xmath187 of the vertices of the @xmath3-cube is a _ slicing _ if there exists a hyperplane that has the vertices in @xmath187 on the positive side and the remaining vertices of the @xmath3-cube on the other side . in the notation in the proof of proposition",
    "[ prop : rbm1 ] , the subset @xmath187 was denoted by @xmath189 .",
    "two examples of slicings for @xmath206 are shown in figure  [ fig : slicingn=3 ] .    for any slicing @xmath187 of the @xmath3-cube , let @xmath207 be the @xmath208-matrix whose rows @xmath46 indexed by the vertices in @xmath187 are @xmath209 and whose other rows are all identically zero .",
    "the following result extends the argument used for proposition  [ prop : rbm1 ] .",
    "[ lem : matrixfortropicalmorphism ] on each region of linearity , the tropical morphism @xmath84 in ( [ eq : phi ] ) coincides with the linear map represented by a @xmath210-matrix of the form @xmath211 for some slicings @xmath212 of the @xmath3-cube .",
    "the tropical map @xmath213 can be written as follows : @xmath214 consider a parameter vector @xmath215 with coordinates @xmath216 we associate to this vector the @xmath2 hyperplanes @xmath217 for @xmath218 .",
    "let us assume that @xmath215 is chosen generically . then , for each index @xmath219 , we have @xmath220 , and we obtain a slicing of the @xmath3-cube with @xmath221 .",
    "the generic parameter vector @xmath215 lies in a unique open region of linearity of the tropical morphism @xmath84 .",
    "more precisely , this region corresponds to the cone of all @xmath222 in @xmath223 such that @xmath224 for @xmath225 . by construction",
    ", the map @xmath226 is linear on this cone . following the definition of @xmath84",
    "we see that this linear map is just left multiplication of the vector @xmath215 by a matrix whose rows are indexed by the observed states @xmath46 and columns indexed by the coordinates of @xmath215 .",
    "this matrix is precisely the matrix @xmath227 above , where @xmath228 for @xmath225 .",
    "the result follows by continuity of the map  @xmath84 .    as an immediate consequence of lemma [ lem : matrixfortropicalmorphism ] we obtain the following result :    [ thm : cornercuts ] the dimension of the tropical rbm model @xmath229 equals the maximum rank of any matrix of size @xmath230 of the form @xmath231 where @xmath232 is any set of @xmath2 slicings of the @xmath3-cube .    theorem [ thm : cornercuts ] furnishes a tool to attack conjecture  [ conj : main2 ] .",
    "what remains is the combinatorial problem of finding a suitable collection of slicings of the @xmath3-cube . in what follows",
    "we shall apply existing results from coding theory to this problem .",
    "there are two quantities from the coding theory literature @xcite that are of interest to us .",
    "the first one is @xmath233 , the size ( number of codewords ) of the largest binary code on @xmath3 bits with each pair of codewords at least hamming distance ( number of bit flips ) @xmath234 apart .",
    "the second one is @xmath235 , the size of the smallest _ covering code _ on @xmath3 bits . in other words",
    ", @xmath235 is the least number of codewords such that every string of @xmath3 bits lies within hamming distance one of some codeword .",
    "we obtain :    [ cor : codingconn ] the dimension of the tropical rbm model satisfies    * @xmath236  for @xmath237 , * @xmath238  for @xmath239 , * @xmath240  for @xmath241 .    for the first statement , let @xmath242 and fix a code with minimum distance @xmath243 . for each codeword",
    "let @xmath244 denote its hamming neighborhood , that is , the codeword together with all strings that are at hamming distance @xmath245 .",
    "these @xmath246 sets @xmath244 , together with some hamming neighborhood in the complement of their union , are pairwise disjoint , and each of them corresponds to a a slicing of the cube as in theorem [ thm : cornercuts ] .",
    "the disjointness of the @xmath2 neighborhoods means that @xmath247 .",
    "elementary row and column operations can now be used to see that the corresponding @xmath248 matrix @xmath249 has rank @xmath11 .",
    "this is because , after such operations , @xmath227 consists of a block of format @xmath250 and @xmath2 blocks of format @xmath251 along the diagonal .",
    "the first block has rank @xmath3 and the remaining @xmath2 blocks have rank @xmath13 each .",
    "the same reasoning is valid for @xmath239 except that it may now happen that @xmath252 . in this case , the @xmath2 blocks have total rank @xmath253 and together with the first @xmath254 block they give a matrix of maximal rank @xmath255 .    for the third statement , we suppose @xmath256 are slicings with subslicings @xmath257 such that the @xmath258 are disjoint and no @xmath13 of the vertices in a given @xmath259 lie in a hyperplane",
    ". then @xmath260 by similar arguments .",
    "this is because we may construct the @xmath261 by pruning neighbors from codewords , and are left with a lower - dimensional hamming neighborhood which is a slicing .",
    "the computation of @xmath233 and @xmath235 , both in general and for specific values of @xmath3 , has been an active area of research since the 1950s . in table",
    "[ tab : knownspecialcases ] we summarize some of the known results for specific values of @xmath3 .",
    "this table is based on @xcite . for general values of @xmath3",
    ", the following bounds can be obtained .",
    ".special cases where conjecture [ conj : main2 ] holds , based on @xcite and corollary [ cor : codingconn ] .",
    "bold entries show improvements made by various researchers on the bounds provided by corollary [ cor : codingbounds ] . for example , for @xmath262 , @xmath85 has the expected dimension if @xmath263 and dimension @xmath264 if @xmath265 , while the corollary [ cor : codingbounds ] bounds are @xmath266 and @xmath267 , respectively . the @xmath268 column lists lower bounds on @xmath233 while the @xmath269 column lists upper bounds on @xmath235 . [ cols=\"^,^,^\",options=\"header \" , ]     [ prop : codebounds ] for binary codes with @xmath198 , the varshamov bound holds : @xmath270 for covering codes , the following inequality holds : @xmath271 for @xmath272 with @xmath273 , we have the equality @xmath274",
    ".    a proof of the varshamov bound on @xmath233 may be found in @xcite .",
    "the last statement holds because @xmath275 for perfect hamming codes : for every @xmath276 there is a perfect @xmath277 hamming code ( i.e. a perfect hamming code on @xmath278 bit , of size @xmath279 , and with hamming distance @xmath234 ) . for a proof of this result ,",
    "see @xcite . additionally ,",
    "we have @xmath280 for @xmath281 ; see @xcite .",
    "the simple upper bound on @xmath235 can be obtained by using overlapping copies of the next smallest hamming code .",
    "suppose @xmath282 for any @xmath283 , i.e. @xmath3 is between _ hamming integer numbers _",
    "( i.e.  integers of the form @xmath278 ) .",
    "let @xmath284 be the next smallest hamming integer @xmath3 , with @xmath285 , so @xmath286 .",
    "the number of hidden nodes needed to cover the @xmath284-cube is exactly @xmath287 .",
    "we may use the @xmath284 codes to cover each of the @xmath288 faces of the @xmath3-cube with @xmath289 vertices , although we will have overlaps .",
    "that is , @xmath290 taking @xmath291 in the inequality , we obtain @xmath292 this implies @xmath293 .",
    "our method results in the following upper and lower bounds for arbitrary values of @xmath3 . note that the bound is tight if @xmath13 is a power of @xmath14 . otherwise there might be a multiplicative gap of up to @xmath14 between the lower and upper bound .",
    "in addition to these general bounds , we have the specific results recorded in table [ tab : knownspecialcases ] .",
    "[ cor : codingbounds ] the coding theory argument leads to the following bounds :    * if @xmath294 , then @xmath295 . * if @xmath296 , then @xmath297 . *",
    "if @xmath298 , then @xmath299 .",
    "this is now easily completed by combining corollary [ cor : codingbounds ] with the inequalities in ( [ ineqchain ] ) .",
    "we close this section with the remark that the use of hamming codes is a standard tool in the study of dimensions of secant varieties .",
    "we learned this technique from tony geramita . for a review of the relevant literature",
    "see @xcite .",
    "it is important to note that , in spite of the combinatorial similarities , the varieties we study here are different and more complicated than higher secant varieties of segre varieties .",
    "the tropical model @xmath85 is not just a convenient tool for estimating the dimension of the statistical model @xmath44 .",
    "it is also of interest as the geometric object that organizes the space of inference functions which the model can compute .",
    "this statistical interpretation of tropical spaces was introduced in @xcite and further developed in @xcite .",
    "we shall now discuss this perspective for the rbm model .",
    "given an rbm model with fixed parameters learned by some estimation procedure and an observed state @xmath46 , we want to infer which value @xmath300 of the hidden data maximizes @xmath301 .",
    "the inferred string @xmath300 might be used in classification or as the input data for another rbm in a deep architecture .",
    "such a vector of hidden states is called an _ explanation _ of the observation @xmath46 .",
    "each choice of parameters @xmath302 defines an _ inference function _",
    "@xmath303 sending @xmath304 .",
    "the value @xmath305 equals the hidden string @xmath23 that attains the maximum in the tropical polynomial @xmath306    in order for the inference function @xmath307 to be well - defined , it is necessary ( and sufficient ) that @xmath308 lies in an open cone of linearity of the tropical morphism @xmath84 . in that case , the maximum in equation   is attained for a unique value of @xmath309 . that @xmath309 can be recovered from the expression of @xmath84 as we vary the parameters in the fixed cone of linearity .",
    "thus , the inference functions are in one - to - one correspondence with the regions of linearity of the tropical morphism @xmath84 .",
    "the rbm model grew out of work on artificial neurons modeled as linear threshold functions @xcite , and we pause our geometric discussion to make a few remarks about these functions and the types of inference functions that our model can represent . a _ linear threshold function _ is a function @xmath310 defined by choosing a weight vector @xmath311 and a target weight @xmath312 . for any point @xmath313 we compute the value @xmath314 , we test if this quantity is at most @xmath312 or no , and we assign value @xmath315 or @xmath245 to @xmath46 depending on @xmath316 or @xmath317 . the weights @xmath318",
    "define a hyperplane in @xmath199 such that the vertices of the @xmath3-cube lie on the `` true '' or `` false '' side of the hyperplane . using the linear threshold functions",
    ", we construct a @xmath2-valued function @xmath319 where we replace the weight vector @xmath311 by a @xmath320 matrix @xmath26 and the target weight @xmath321 by a vector @xmath322 .",
    "more precisely , the function assigns a vertex of the @xmath2-cube where the @xmath219-th coordinate equals 0 if @xmath323 and @xmath245 if not .",
    "our discussion of slicings of the @xmath3-cube in section  4 implies the following observation :    the inference functions for the restricted boltzmann machine model @xmath44 are precisely those boolean functions @xmath324 for which each of the @xmath2 coordinate functions @xmath325 is a linear threshold function .",
    "most boolean functions are not linear threshold functions , that is , are not inference functions for the model @xmath63 . for example , the parity function can not be so represented . to be precise , while the number of all boolean functions is @xmath326 , it is known @xcite that for @xmath327 the number @xmath328 of linear threshold functions satisfies @xmath329 the exact number @xmath328 of linear threshold functions has been computed for up to @xmath330 .",
    "the _ on - line encyclopedia of integer sequences _",
    "* a000609 ) reveals @xmath331 combining @xmath2 such functions for @xmath107 yields @xmath332 possible inference functions for the rbm model @xmath44 .",
    "this number grows exponentially in the number of model parameters .",
    "this is consistent with the result of elizalde and woods in @xcite which states that the number of inference functions of a graphical model grows polynomially in the size of the graph when the number of parameters is fixed .",
    "in typical implementations of rbms using ieee 754 doubles , the size in bits of the representation is @xmath333 .",
    "thus the number @xmath334 of inference functions representable by a theoretical rbm @xmath44 will eventually outstrip the number @xmath335 representable in a fixed - precision implementation ; for example with @xmath336 hidden nodes , this happens at @xmath337 . as a result , the size of the regions of linearity will shrink to single points in floating point representation .",
    "this is one possible contributor to the difficulties that have been encountered in scaling rbms .",
    "the tropical point of view allows us to organize the geometric information of the space of inference functions into the tropical model @xmath85 , which can then be analyzed with the tools of tropical and polyhedral geometry .",
    "we now describe this geometry in the case @xmath18 .",
    "geometrically , we can think of the linear threshold functions as corresponding to the vertices of the @xmath338-dimensional zonotope corresponding to the @xmath3-cube .",
    "this zonotope is the minkowski sum in @xmath339 of the @xmath80 line segments @xmath340 $ ] where @xmath46 ranges over the set @xmath79 .",
    "the quantity @xmath328 is the number of vertices of these zonotopes , and their facet numbers were computed by aichholzer and aurenhammer ( * ? ? ?",
    "* table 2 ) .",
    "they are @xmath341 for example , the second entry in ( [ ltf ] ) and ( [ auren ] ) refers to a @xmath234-dimensional zonotope known as the _ rhombic dodecahedron _",
    ", which has @xmath342 facets and @xmath343 vertices . likewise , the third entry in ( [ ltf ] ) and ( [ auren ] ) refers to a @xmath166-dimensional zonotope with @xmath344 facets and @xmath345 vertices .",
    "the normal fan of that zonotope is an arrangement of eight hyperplanes , indexed by @xmath346 , which partitions @xmath347 into @xmath348 open convex polyhedral cones .",
    "that partition lifts to a partition of the parameter space @xmath349 for @xmath350 whose cones are precisely the regions on which the tropical morphism @xmath84 is linear .",
    "the image of that morphism is the first non - trivial tropical rbm model @xmath101 .",
    "this model has the expected dimension @xmath351 and it happens to be a pure fan .    , title=\"fig:\"][subfig:2 ]     is glued from four triangulated bipyramids . in this octahedron graph , each of the bipyramids is represented by a shaded triangle . ]    .",
    "[ ex52 ] the tropical rbm model @xmath101 is a @xmath351-dimensional fan whose lineality space is @xmath234-dimensional .",
    "it is a subfan of the secondary fan of the @xmath234-cube ( * ? ? ?",
    "* corollary 2.2 ) .",
    "the secondary fan of the @xmath234-cube can be represented as a @xmath234-dimensional polyhedral sphere with @xmath352-vector @xmath353 .",
    "the @xmath354 facets of that @xmath234-sphere correspond to triangulations of the @xmath234-cube .",
    "the tropical model @xmath101 consists of all regular subdivisions of the @xmath234-cube with two regions covering all eight vertices .",
    "it sits inside the polyhedral @xmath234-sphere as a _ simplicial _",
    "subcomplex with @xmath88-vector @xmath355 .",
    "its @xmath342 facets ( tetrahedra ) correspond to a single triangulation type of the @xmath234-cube as depicted in figure  [ subfig:2 ] .",
    "the @xmath356 vertices of @xmath101 come in two families : six vertices @xmath357 corresponding to diagonal cuts , as in figure  [ subfig:1 ] , and eight vertices @xmath358 representing corner cuts , as in figure  [ subfig:0 ] .",
    "the edges come in three families : four edges @xmath359 corresponding to pairs of corner cuts at antipodal vertices of the cube , twenty - four edges @xmath360 , and twelve edges @xmath361 .",
    "finally , of the four possible triangles , only two types are present : the ones with two vertices of different type .",
    "thus , they are @xmath342 triangles @xmath362 and @xmath363 triangles @xmath364 .",
    "figure  [ fig : tm^1_3 ] depicts the simplicial complex @xmath101 which is pure of dimension @xmath234 .",
    "the six vertices @xmath365 and the twelve edges @xmath366 form the edge graph of an octahedron .",
    "the four nodes interior to the shaded triangles represent pairs of vertices @xmath358 that are joined by an edge .",
    "each of the shaded triangles represents three tetrahedra that are glued together along a common edge @xmath359 .",
    "thus the twelve tetrahedra in @xmath101 come as four triangulated bypiramids .",
    "the four bypiramids are then glued into four of the triangles in the octrahedron graph .",
    "our analysis shows that the complex @xmath101 has reduced homology concentrated in degree @xmath245 and it has rank   @xmath234 .",
    "the previous example is based on the fact that the image of the tropical map @xmath367 is a subfan of the secondary fan of the @xmath3-cube . however , it is important to note that @xmath84 is * not * a morphism of fans with respect to the natural fan structure on the parameter space @xmath192 given by the slicings of the @xmath3-cube .    consider the case @xmath368 . here",
    "@xmath369 equals @xmath347 with its secondary fan structure coming from the two triangulations of the square .",
    "modulo lineality , this fan is simply the standard fan structure @xmath370 on the real line .",
    "the fan structure on the parameter space @xmath349 has @xmath356 maximal cones .",
    "modulo lineality , this is the normal fan of the rhombic dodecahedron , i.e.  a partition of @xmath371 into @xmath356 open convex cones by an arrangement of four planes through the origin .",
    "ten of these @xmath356 open cones are mapped onto cones , namely , four are mapped onto @xmath372 , two are mapped onto @xmath373 , and four onto @xmath374 .",
    "the remaining four cones are mapped onto @xmath375 , so @xmath84 does not respect the fan structures relative to these four cones .",
    "the situation is analogous for @xmath206 but more complicated .",
    "the tropical map @xmath84 is injective on precisely eight of the @xmath348 maximal cones in the parameter space .",
    "these eight cones are the slicings shown on figure  [ subfig:1 ] .",
    "the map @xmath84 is injective on such a cone , but the cone is divided into three subcones by the secondary fan structure on @xmath350 .",
    "the resulting @xmath376 maximal cells in the parameter space are mapped in a 2-to-1 fashion onto the @xmath342 tetrahedra in figure  [ fig : tm^1_3 ] .",
    "it would be worthwhile to study the combinatorics of the graph of @xmath377 for @xmath198 .",
    "we thank jan draisma , jm landsberg , honglak lee , sorgey norin , lior pachter , seth sullivant , ilya sutskever , jenia tevelev , and piotr zwiernik for helpful discussions .",
    "special thanks go to anders jensen for computations he did for  us .",
    "m.  develin , f.  santos and b.sturmfels : _ on the tropical rank of a matrix _ , in discrete and computational geometry , ( eds .",
    "goodman , j. pach and e. welzl ) , mathematical sciences research institute publications * 52 * , cambridge university press ( 2005 ) 213242 ."
  ],
  "abstract_text": [
    "<S> the restricted boltzmann machine is a graphical model for binary random variables . </S>",
    "<S> based on a complete bipartite graph separating hidden and observed variables , it is the binary analog to the factor analysis model . </S>",
    "<S> we study this graphical model from the perspectives of algebraic statistics and tropical geometry , starting with the observation that its zariski closure is a hadamard power of the first secant variety of the segre variety of projective lines . </S>",
    "<S> we derive a dimension formula for the tropicalized model , and we use it to show that the restricted boltzmann machine is identifiable in many cases . </S>",
    "<S> our methods include coding theory and geometry of linear threshold functions . </S>"
  ]
}