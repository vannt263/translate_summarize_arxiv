{
  "article_text": [
    "the lattice - boltzmann method ( lbm ) provides an alternative to the orthodox approach to computational fluid dynamics , in which the starting point is always a discretization of the navier  stokes equations .",
    "the method , which is fundamentally based on boltzmann s kinetic transport equation , instead describes a fluid by a number of interacting populations of particles moving and colliding on a fixed lattice . with the advent of the introduction of a diagonal collision integral with single - time relaxation to local equilibrium ,",
    "the method becomes tantalisingly simple and efficient .    in recent years",
    ", the lbm has enjoyed much applied success modelling various flows of genuine engineering interest ( see e.g. ,  @xcite and the references therein ) .",
    "however , when populations are far from equilibrium , such as is the case in the vicinity of shocks , the lbm exhibits numerical instability . often , numerical instability in the lbm is attributed to the absence of a positivity constraint on the populations .",
    "recent development of the entropic lbm ( elbm )  @xcite are attempts to improve stability properties through compliance with a discrete entropy @xmath0-theorem .",
    "although such techniques should , conceivably , reduce the magnitude of spurious oscillations , one should perhaps not be disappointed to find that such numerical instabilities are not removed entirely .",
    "in this paper we suggest an alternative and versatile approach .",
    "the idea is simply stated : we propose a lbm in which the difference between microscopic and macroscopic entropy is monitored in the simulation , and populations are returned to their equilibrium states if a threshold value is exceeded .",
    "this technique is appealing because dissipation is introduced in a controlled , targeted and illiberal manner .",
    "furthermore , we stress that equilibration itself will leave macroscopic entropy completely unchanged .",
    "we coin the name _",
    "ehrenfests steps _ for this procedure because we feel that the technique is most clearly understood if introduced using the ehrenfests coarse - graining idea  @xcite .",
    "this report is organised as follows . in section  [ sec2 ]",
    "the lbm is recalled . in section  [ sec3 ]",
    "we recall the basic theory required to discuss the ehrenfests coarse - graining and introduce ehrenfests steps .",
    "the reader is directed to  @xcite for a more comprehensive review of coarse - graining .",
    "finally , we present the results of a shock tube numerical experiment which compares various lbms .",
    "the boltzmann kinetic transport equation is the following time evolution equation for one - particle distribution functions @xmath1 : @xmath2 the _ collision integral _ , @xmath3 , describes the interactions of the populations @xmath4 .",
    "the lattice - boltzmann approach drastically simplifies this model by stipulating that populations can only move with a finite number of velocities @xmath5 : @xmath6 where @xmath7 is the one - particle distribution function associated with motion in the @xmath8th direction .",
    "for example , in one - dimension , one might consider three velocities @xmath9 , for some @xmath10 .",
    "the model is further simplified by specifying the collision integral as the bhatnager ",
    "krook ( bgk ) operator  @xcite : @xmath11 .",
    "we make this assumption for the remainder of the paper .",
    "now ,   describes free - flight dynamics together with relaxation to local equilibria , @xmath12 , in time proportional to @xmath13 .",
    "the discrete velocities and local equilibrium states can all be mindfully chosen so that the navier  stokes equations are recovered by the lattice - boltzmann equation  , subject to ceratin conservation laws , in the large time - scale , @xmath14 , limit via a chapman ",
    "enskog procedure  @xcite . here",
    ", the macroscopic fluid density @xmath15 and momentum @xmath16 are the zeroth- and first - order hydrodynamic moments of the populations respectively .",
    "the rate of dissipation introduced by the model is proportional to @xmath13 .",
    "the local equilibrium states can be found by maximising a local entropy functional subject to the constraints of conservation of mass and momentum .",
    "there are numerous ways to discretize   and obtain a numerical method .",
    "we prefer the following , second - order accurate in time , lattice - based lbgk scheme  @xcite : @xmath17 with @xmath18 . here",
    ", the discrete velocities are associated with an underlying spatial lattice @xmath19 and @xmath20 .",
    "populations live on this lattice , propagate to neighbouring lattice sites with their corresponding discrete velocities and are updated via  .",
    "the parameter @xmath21 $ ] controls the viscosity in the model , with @xmath22 corresponding to the zero - viscosity limit .",
    "to introduce the ehrenfests coarse - graining idea  @xcite we use a formal kinetic equation @xmath23 together with a strictly concave entropy functional @xmath24 .",
    "we tacitly assume that entropy does not decrease with time : @xmath25 . for our purposes",
    ", we are always interested in the example of the lattice - boltzmann equation   with associated entropy functional which defines the local equilibrium states .    the ehrenfests idea was to supplement the mechanical motion from   with periodic averaging in cells to produce piecewise constant , or _",
    "coarse - grained _ , densities .",
    "this operation necessitates entropy production .",
    "we wish to allow a generalisation of the ehrenfests coarse - graining whereby averaging in cells is replaced with some other partial equilibration procedure .",
    "specifically , we assume we have some linear operator @xmath26 which transforms a microscopic description of the system @xmath4 into a macroscopic description @xmath27 . for our example , the macroscopic description is that provided by the usual hydrodynamic moments .",
    "now , given a macroscopic description , @xmath28 , we consider the solution @xmath29 of the optimisation problem @xmath30    averaging in cells is a particular example of this entropy maximisation problem for the boltzmann ",
    "gibbs  shannon ( bgs ) entropy functional @xmath31 , where the integration is taken over the whole of phase space",
    ".    we will refer to @xmath29 as the quasi - equilibrium distribution .",
    "the quasi - equilibrium manifold @xmath3 is the set of quasi - equilibrium distributions parameterised by the macroscopic variables @xmath28 .",
    "entropy maximisation leads naturally to an evolution equation for the macroscopic description .",
    "the so - called _ quasi - equilibrium approximation _ to   is an equation for the evolution of @xmath28 : @xmath32 for our example , the quasi - equilibrium distributions are precisely the local equilibria @xmath33 and   coincides with the compressible euler equations  @xcite .",
    "now , one can envisage constructing various _ coarse - graining chains _ which provide stepwise approximation to the macroscopic equations  .",
    "let @xmath34 be the phase flow for the kinetic equation  .",
    "let @xmath13 be a fixed _ coarse - graining time _ and suppose we have an initial quasi - equilibrium distribution @xmath35 .",
    "the ehrenfests chain is the sequence of quasi - equilibrium distributions @xmath36 , where @xmath37 .",
    "entropy increases in the ehrenfests chain .",
    "the entropy gain in a link in the chain is made up from two parts : the entropy gain from the mechanical motion ( from @xmath7 to @xmath38 ) and the gain from the equilibration ( from @xmath38 to @xmath39 ) .",
    "consequently , conservative systems become dissipative and dissipative systems more so .",
    "the gain in macroscopic entropy in a particular link is given by the expression @xmath40 .",
    "note that there is zero gain in macroscopic entropy from the equilibration part .",
    "the ehrenfests chain provides a stepwise approximation to a solution of some coarse - grained macroscopic equations via @xmath41 , @xmath42 . for our example , these equations are the compressible navier ",
    "stokes equations  @xcite . however , this chain is computationally prohibitive because the rate of introduced dissipation is proportional to @xmath13 .",
    "the ehrenfests chain corresponds to the following lbm : @xmath43 which we recognise as a forward euler discretization of  .",
    "another possibility is to construct a chain as follows . as already noted",
    ", the dissipative term introduced by the ehrenfests chain depends linearly on @xmath13 .",
    "therefore , there is symmetry between forward and backward motion in time starting from any quasi - equilibrium initial condition .",
    "it is precisely this principle that enables one to construct chains with zero macroscopic entropy production .",
    "each subsequent link in the chain is constructed using entropic involution .    to make such a chain useful ,",
    "the user is at liberty to add a required amount of dissipation by shifting the involuted point in the direction of the quasi - equilibrium state , with some entropy increase .",
    "of course , this shift leaves macroscopic entropy unchanged .",
    "this chain corresponds to the elbm that we have eluded to in the introduction : @xmath44 with @xmath45 .",
    "the number @xmath46 is chosen so that a constant entropy condition is satisfied .",
    "this , in itself , provides a positivity constraint on the populations .",
    "if the entropic involution operator is partially linearised so that subsequent links are constructed with the use of reflections in the quasi - equilibrium manifold , rather than inversions , then the corresponding lbm is precisely lbgk  .",
    "we can now state the main idea of the paper .",
    "we propose to create a new chain .",
    "this chain begins and proceeds , for the bulk of time , as the either the entropic involution chain or its linearised version , as described in the previous subsection .",
    "however , the difference between microscopic and macroscopic entropy is monitored throughout the simulation , by which we mean the quantities @xmath47 a threshold value is set and an alarm is triggered if exceeded .",
    "the alarm simply signals that a link from the ehrenfests chain  an ehrenfests step  be used in place of a regular link of the primary chain at this point .",
    "links in the chain which are intolerably far from their quasi - equilibrium states are merely returned to their equilibrium .",
    "the result is a chain which provides additional dissipation only where it is anticipated to be required .",
    "coupling the entropic involution chain with ehrenfests steps will , in general , no longer constitute a chain with zero macroscopic entropy production .",
    "indeed , in a chain of length @xmath48 the total macroscopic entropy gain is given by the expression @xmath49 $ ] , where @xmath50 is the set of indices corresponding to the ehrenfests steps .",
    "to conclude this report , we perform a one - dimensional numerical experiment to demonstrate the performance of the proposed lbm corresponding to a chain with ehrenfests steps .",
    "the implementation is as follows .",
    "if @xmath51 , for some given tolerance @xmath52 then we accept an ehrenfests step .",
    "the resulting lbm is as follows : @xmath53 we have selected lbgk   as the primary chain and we will henceforth refer to this lbm as lbgk - es .    the method lbgk - es , as described , is a second - order accurate in time scheme with first - order degradation in regions where ehrenfests steps are employed .",
    "however , as is often found , when the thickness of such regions is of the order of the lattice spacing , the method remains second - order everywhere .",
    "for contrast we are interested in comparing lbgk - es with lbgk   and elbm   ( as described in  @xcite ) . in all of our simulations",
    "we select the three - velocity model mentioned in the introduction and a uniformly spaced lattice .",
    "further , we always choose @xmath54 and @xmath55 . the coefficient @xmath56 , which controls the viscosity in the model , is fixed at @xmath57 , which is close to the zero viscosity limit . in each case",
    "the entropy is @xmath58 , with @xmath59  @xcite , where @xmath60 , @xmath61 and @xmath62 denote the static , left - moving and right - moving populations respectively . for this entropy ,",
    "the local equilibria are available analytically for the three - velocity model .",
    "they are given by the expressions @xmath63 for lbgk - es we fix the tolerance , @xmath64 , to either @xmath65 or @xmath66 .",
    "as already mentioned , for elbm , there is a parameter , @xmath67 , which is chosen to satisfy a constant entropy condition .",
    "this involves finding the nontrivial root of the equation @xmath68 inaccuracy in the solution of this equation can introduce artificial viscosity . to solve",
    "numerically we employ a robust routine based on bisection .",
    "the root is solved to an accuracy of @xmath69 .",
    "furthermore , we always ensure that the returned value of @xmath67 does not lead to an entropy decrease . so that our results can be faithfully reproduced , we stipulate that we will consider two possibilities if no nontrivial root of   exists .",
    "we either elect to select @xmath70 or we select the positivity bound @xmath71 , with @xmath72 . for fairness , since both of these procedures introduce diffusivity into elbm , we consider analogous procedures for lbgk too , i.e. , we elect to select either @xmath70 or @xmath73 if a populations is predicted to become negative .",
    "shock tube simulation after @xmath74 time steps using ( a ) lbgk  ; ( b ) elbm  ; ( c ) lbgk - es   with @xmath75 ; ( d ) lbgk - es   with @xmath76 .",
    "in this example , lbgk does not produce a negative population so the aforementioned regularisation procedures are redundant .",
    "similarly , for elbm in this example , the entropy estimate equation always has a nontrivial root .",
    "sites where ehrenfests steps are employed are indicated by crosses .",
    "[ shocktube],height=529 ]      the one - dimensional shock tube for a compressible isothermal fluid is a standard benchmark test for hydrodynamic codes .",
    "our computational domain will be the interval @xmath77 $ ] and we discretize this interval with @xmath78 uniformly spaced lattice sites .",
    "we choose the initial density ratio as @xmath79 .",
    "initially , for @xmath80 we set @xmath81 else we set @xmath82 .",
    "we observe that , of all the lbms considered in the experiment , only the method which includes ehrenfests steps is capable of suppressing spurious post - shock oscillations ( fig .  [ shocktube ] ) .",
    "the code used to produce the simulations in this section is freely available by making contact with the corresponding author .",
    "ehrenfests steps introduce additional dissipation _ locally _ , on the base of _ point - wise analysis of non - equilibrium entropy_. they admit a huge variety of generalisations : incomplete ehrenfests steps , partial involution , etc .  @xcite .",
    "in order to preserve the second - order of lbm accuracy it is worthwhile to perform ehrenfests steps on only a small share of sites ( the number of sites should be @xmath83 , where @xmath84 is the number of sites , @xmath85 is the macroscopic characteristic length and @xmath86 is the lattice step ) with highest @xmath51 .",
    "numerical experiments show that even small shares of such steps drastically improve stability .",
    "more tests are presented in  @xcite ."
  ],
  "abstract_text": [
    "<S> the lattice - boltzmann method ( lbm ) and its variants have emerged as promising , computationally efficient and increasingly popular numerical methods for modelling complex fluid flow . however , it is acknowledged that the method can demonstrate numerical instabilities , e.g. , in the vicinity of shocks . </S>",
    "<S> we propose a simple and novel technique to stabilise the lattice - boltzmann method by monitoring the difference between microscopic and macroscopic entropy . </S>",
    "<S> populations are returned to their equilibrium states if a threshold value is exceeded . </S>",
    "<S> we coin the name _ </S>",
    "<S> ehrenfests steps _ for this procedure in homage to the vehicle that we use to introduce the procedure , namely , the ehrenfests idea of coarse - graining . </S>"
  ]
}