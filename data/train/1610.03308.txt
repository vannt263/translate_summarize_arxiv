{
  "article_text": [
    "despite its success , time - dependent density functional theory ( td - dft ) within the adiabatic local or semi - local approximation still suffers from various deficiencies like the underestimation of charge transfer excitation energies or the absence of multiple electron excitations in the spectrum  @xcite . in order to describe excited states in the framework of dft ,",
    "it is in principle not necessary to work within the time - dependent regime .",
    "various time - independent dft approaches have been investigated over the years , mostly at the formal level  @xcite . in this paper , we will focus on ensemble dft ( edft ) for excited states  @xcite .",
    "the latter relies on the extension of the variational principle to an ensemble of ground and excited states which is characterized by a set of ensemble weights  @xcite .",
    "note that boltzmann weights can be used  @xcite but it is not compulsary .",
    "in fact , any set of ordered weights can be considered  @xcite .",
    "since the ensemble energy ( _ i.e. _ the weighted sum of ground- and excited - state energies ) is a functional of the ensemble density , which is the weighted sum of ground- and excited - state densities , a mapping between the physical interacting and kohn  sham ( ks ) non - interacting ensembles can be established .",
    "consequently , a weight - dependent ensemble exchange - correlation ( @xmath0 ) functional must be introduced in order to obtain the exact ensemble energy and , consequently , exact excitation energies . despite its formal simplicity ( exact optical and ks gaps are easily related in this context  @xcite ) and advantages in contrast to td - dft ( it is straightforward to describe multiple excitations with an ensemble )",
    ", edft is not standard essentially because , so far , not much effort has been put in the development of approximate @xmath0 functionals for ensembles . in particular , designing density - functional approximations that remove the so - called `` ghost interaction '' error  @xcite , which is induced by the ensemble hartree energy , is still challenging  @xcite . employing an ensemble exact exchange energy",
    "is of course possible but then optimized effective potentials should in principle be used , which is computationally demanding .",
    "recently , accurate edft calculations have been performed for the helium atom  @xcite , the hydrogen molecule  @xcite , and for two electrons in boxes or in a three - dimensional harmonic well ( hooke s atom )  @xcite , thus providing more insight into the ensemble @xmath0 energy and potential .",
    "+ very recently , burke and coworkers  @xcite have shown that the nontrivial asymmetric hubbard dimer can be used for understanding the limitations of standard approximate dft in the strongly correlated regime and also for developing @xmath0 functionals in thermal dft  @xcite . in the same spirit ,",
    "we propose in this work to construct an exact edft for this model system .",
    "the paper is organized as follows .",
    "after a brief introduction to edft ( sec .",
    "[ subsec : edft ] ) , a generalization of the adiabatic connection formalism to ensembles will be presented in sec .",
    "[ subsec : gace ] .",
    "the formulation of edft for the hubbard dimer is discussed in sec .",
    "[ sec : edft_for_hubb_dimer ] and exact results are given and analyzed in sec .  [ sec : results ] .",
    "ground - state density - functional approximations are finally proposed and tested in sec .",
    "[ sec : gs_approx ] .",
    "conclusions are given in sec .",
    "[ sec : conclu ] .",
    "according to the gross  oliveira ",
    "kohn ( gok ) variational principle  @xcite , that generalizes the seminal work of theophilou  @xcite on equiensembles , the following inequality @xmath1 is fulfilled for any ensemble characterized by an arbitrary set ( _ i.e. _ not necessarily a boltzmann one ) of weights @xmath2 with @xmath3 and a set of @xmath4 orthonormal trial @xmath5-electron ( with @xmath5 fixed ) wavefunctions @xmath6 .",
    "the lower bound in eq .",
    "( [ eq : gok_vp_tr ] ) is the exact ensemble energy , _",
    "i.e. _ the weighted sum of ground- and excited - state energies , @xmath7 where @xmath8 is the exact @xmath9th eigenfunction of the hamiltonian operator @xmath10 with energy @xmath11 and @xmath12 .",
    "a consequence of the gok principle is that the ensemble energy is a functional of the ensemble density  @xcite , _ i.e. _ the weighted sum of ground- and excited - state densities , @xmath13 note that , in the standard formulation of edft  @xcite , the additional condition @xmath14 is used so that the ensemble density integrates to the number @xmath5 of electrons . in the rest of this work , we will focus on non - degenerate two - state ensembles . in the latter case ,",
    "a single weight parameter @xmath15 in the range @xmath16 can be used , since @xmath17 and @xmath18 , so that eq .",
    "( [ eq : gok_vp_tr ] ) becomes @xmath19,\\end{aligned}\\ ] ] where , for convenience , the trial density matrix operator @xmath20 has been introduced .",
    "@xmath21 denotes the trace and the ensemble energy equals @xmath22 for any electronic system , the hamiltonian can be decomposed as @xmath23 where @xmath24 is the kinetic energy operator , @xmath25 denotes the two - electron repulsion operator , @xmath26 is the nuclear potential and @xmath27 is the density operator . like in conventional ( ground - state ) dft , the exact ensemble energy can be expressed variationally as follows  @xcite , @xmath28 + \\int d{\\bf r}\\ , v_{ne}({\\bf r } ) n({\\bf r})\\right\\},\\end{aligned}\\ ] ] where @xmath29&=&\\underset{\\hat{\\gamma}^{{w}}\\rightarrow n}{\\rm min}\\left\\{{\\rm tr}\\left[\\hat{\\gamma}^{{w}}(\\hat{t}+\\hat{w } _",
    "{ ee})\\right]\\right\\ } \\nonumber\\\\ & = &   { \\rm tr}\\left[\\hat{\\gamma}^{{w}}[n](\\hat{t}+\\hat{w } _ { ee})\\right]\\end{aligned}\\ ] ] is the analog of the levy ",
    "lieb ( ll ) functional for ensembles .",
    "the minimization in eq .",
    "( [ eq : general_ll_ensfun ] ) is performed over all ensemble density matrix operators with density @xmath30 , @xmath31=n_{\\hat{\\gamma}^{{w}}}(\\mathbf{r})=n(\\mathbf{r}).\\end{aligned}\\ ] ] note that , according to the gok variational principle , the following inequality is fulfilled for any local potential @xmath32 , @xmath33 \\leq f^{{w}}[n]+ \\int d{\\bf{r}}\\,v({\\bf{r}})n({\\bf{r } } ) ,   \\end{aligned}\\ ] ] where @xmath34 $ ] is the ensemble energy of @xmath35 , so that the ensemble ll functional can be rewritten as a legendre  fenchel transform  @xcite , @xmath36 = \\sup\\limits_{v } \\left\\ { e^{w}[v ]   -\\int d{\\bf{r}}\\,v({\\bf{r}})n({\\bf{r } } ) \\right\\}.\\end{aligned}\\ ] ] note also that , in eq .",
    "( [ eq : min_n_ew ] ) , the minimizing density is the exact physical ensemble density @xmath37 + like in standard ground - state dft , the ks decomposition , @xmath38 = t^{w}_{s}[n ] + e_{hxc}^{w}[n],\\end{aligned}\\ ] ] is usually considered , where @xmath39&=&\\underset{\\hat{\\gamma}^{{w}}\\rightarrow n}{\\rm min}\\left\\{{\\rm tr}\\left[\\hat{\\gamma}^{{w}}\\hat{t } \\right]\\right\\ } \\nonumber\\\\ & = & { \\rm tr}\\left[\\hat{\\gamma}_s^{{w}}[n]\\hat{t } \\right]\\end{aligned}\\ ] ] is the non - interacting ensemble kinetic energy and @xmath40 $ ] is the ( @xmath41-dependent ) ensemble hartree - exchange - correlation functional .",
    "applying the gok principle to non - interacting systems leads to the following legendre ",
    "fenchel transform , @xmath42 = \\sup\\limits_{v } \\left\\ { \\mathcal{e}^{ks , w}[v ]   -\\int d{\\bf{r}}\\,v({\\bf{r}})n({\\bf{r } } ) \\right\\},\\end{aligned}\\ ] ] where @xmath43 $ ] is the ensemble energy of @xmath44 .",
    "combining eq .",
    "( [ eq : min_n_ew ] ) with eq .",
    "( [ eq : ens_ks_decomp ] ) leads to the following ks expression for the exact ensemble energy , @xmath45 + e_{hxc}^{w}[n_{\\hat{\\gamma}^{{w } } } ] \\nonumber\\\\ & & + \\int d{\\bf r}\\ , v_{ne}({\\bf r } ) n_{\\hat{\\gamma}^{{w}}}({\\bf r})\\big\\ } . \\ ] ] the minimizing non - interacting ensemble density matrix in eq .",
    "( [ eq : min_gamma_ew ] ) , @xmath46 reproduces the exact physical ensemble density , @xmath47 it is obtained by solving the self - consistent equations  @xcite @xmath48}{\\delta n({\\bf r } ) }   \\right)\\hat{n}({\\bf r})\\right]\\ket{\\phi^{ks , w}_{i } } = \\nonumber \\\\   & & \\mathcal{e}^{ks , w}_{i}\\ket{\\phi_i^{ks , w } } , ~ i = 0,1.\\end{aligned}\\ ] ] + as readily seen in eq .",
    "( [ eq : ensembleenergy_2states ] ) , the exact ( neutral ) excitation energy is simply the first derivative of the ensemble energy with respect to the ensemble weight , @xmath49 using eq .",
    "( [ eq : min_gamma_ew ] ) and the hellmann ",
    "feynman theorem leads to @xmath50 +   \\int d{\\bf r } \\left(v_{ne}({\\bf r})+\\frac{\\delta e^{w}_{hxc}[n_{\\hat{\\gamma}_s^w}]}{\\delta n({\\bf r})}\\right)n_{\\partial_w\\hat{\\gamma}_s^{{w}}}({\\bf r } )",
    "\\nonumber\\\\ & & + \\left.\\dfrac{\\partial e_{hxc}^{\\xi}[n_{\\hat{\\gamma}_s^{{w}}}]}{\\partial \\xi}\\right|_{\\xi = w } , \\label{eq : excitationenergy_deriv2 } \\end{aligned}\\ ] ] where @xmath51 by using eq .  (",
    "[ eq : eks - dft_sc_eqs ] ) , we finally obtain @xmath52}{\\partial \\xi}\\right|_{\\xi = w}. \\label{eq : excitationenergy_deriv3 } \\end{aligned}\\ ] ] if the ground and first - excited states differ by a single electron excitation then the ks excitation energy ( first term on the right - hand side of eq .",
    "( [ eq : excitationenergy_deriv3 ] ) ) reduces to the weight - dependent ks homo - lumo gap @xmath53 .",
    "if , in addition , we use the decomposition @xmath54=e_h[n]+e^{w}_{xc}[n],\\end{aligned}\\ ] ] where @xmath55 $ ] is the conventional ( weight - independent ) ground - state hartree functional , @xmath56 = \\frac{1}{2 } \\iint d{\\bf r } d{\\bf r ' } ~ \\frac{n({\\bf r})n({\\bf",
    "r'})}{\\mid{{\\bf r}-{\\bf r'}}\\mid } , \\end{aligned}\\ ] ] we then recover the ks - edft expression for the excitation energy  @xcite , @xmath57 where @xmath58/\\partial \\xi\\right|_{\\xi = w}$ ] .",
    "interestingly , in the @xmath59 limit , the excitation energy can be expressed exactly in terms of the usual ground - state ks homo - lumo gap @xmath60 as @xmath61 as shown analytically by levy  @xcite and illustrated numerically by yang _",
    "et al . _",
    "@xcite , @xmath62 corresponds to the jump in the @xmath0 potential when moving from @xmath63 ( ground state ) to @xmath59 ( ensemble of ground and excited states ) .",
    "this is known as the derivative discontinuity ( dd ) and should not be confused with the ground - state dd that is related to ionization energies and electron affinities , although there are distinct similarities at a formal level  @xcite .",
    "consequently , the quantity @xmath64 will be referred to as dd in the following .",
    "+ returning to the decomposition in eq .",
    "( [ eq : enshxc_decomp ] ) , the @xmath0 contribution is usually split as follows , @xmath65=e^{w}_{x}[n]+e^{w}_{c}[n],\\end{aligned}\\ ] ] where @xmath66={\\rm tr}\\left[\\hat{\\gamma}_s^{{w}}[n]\\hat{w}_{ee}\\right]-e_h[n]\\end{aligned}\\ ] ] is the exact ensemble exchange energy functional and @xmath67 $ ] is the non - interacting ensemble density matrix operator with density @xmath30 ( see eq .",
    "( [ eq : nonintek ] ) ) . consequently , according to eqs .",
    "( [ eq : general_ll_ensfun ] ) , ( [ eq : ens_ks_decomp ] ) and ( [ eq : nonintek ] ) , the ensemble correlation energy equals @xmath68&= & { \\rm tr}\\left[\\hat{\\gamma}^{{w}}[n](\\hat{t}+\\hat{w } _ { ee})\\right ] \\nonumber\\\\ & & - { \\rm tr}\\left[\\hat{\\gamma}_s^{{w}}[n](\\hat{t}+\\hat{w } _ { ee})\\right]<0.\\end{aligned}\\ ] ]      in order to construct the ensemble @xmath0 functional @xmath69 $ ] from the ground - state one ( @xmath63 ) , franck and fromager  @xcite have derived a generalized adiabatic connection for ensembles ( gace ) where an integration over both the interaction strength parameter @xmath70 ( @xmath71 ) and an ensemble weight @xmath72 in the range @xmath73 is performed .",
    "the major difference between conventional acs  @xcite and the gace is that , along a gace path , the ensemble density is held constant and equal to @xmath30 when both @xmath70 _ and _ @xmath72 vary .",
    "consequently , the integration over @xmath70 can be performed in the ground state while the deviation of the ensemble @xmath0 energy from the ground - state one is obtained when varying @xmath72 only .",
    "formally , the gace can be summarized as follows .",
    "let us consider the schrdinger , @xmath74({\\bf",
    "r})\\hat{n}({\\bf r})\\right ) \\ket{\\psi_{i}^{\\xi}[n ] } \\nonumber\\\\ & & = { e}^{\\xi}_{i}[n]\\ket{\\psi^{\\xi}_{i}[n]}\\end{aligned}\\ ] ] and ks @xmath75({\\bf r})\\hat{n}({\\bf r})\\right ) \\ket{\\phi_{i}^{ks,\\xi}[n ] } \\nonumber\\\\ & & = \\mathcal{e}^{ks,\\xi}_{i}[n]\\ket{\\phi^{ks,\\xi}_{i}[n]}\\end{aligned}\\ ] ] equations where @xmath76 .",
    "the potentials @xmath77({\\bf r})$ ] and @xmath78({\\bf r})$ ] are adjusted so that the gace density constraint is fulfilled , @xmath79}({\\mathbf r})=n_{\\hat{\\gamma}^\\xi_s[n]}({\\mathbf r})=n({\\mathbf r}),\\hspace{0.2 cm } 0\\leq \\xi\\leq w,\\end{aligned}\\ ] ] where @xmath80= ( 1-\\xi ) \\vert { \\psi}_0^{\\xi}[n]\\rangle\\langle { \\psi}_0^{\\xi}[n]\\vert + \\xi   \\vert { \\psi}_1^{\\xi}[n]\\rangle\\langle { \\psi}_1^{\\xi}[n]\\vert\\end{aligned}\\ ] ] and @xmath81&=&(1-\\xi ) \\vert { \\phi}^{ks,\\xi}_0[n]\\rangle\\langle { \\phi}^{ks,\\xi}_0[n]\\vert \\nonumber \\\\ & & + \\xi \\vert { \\phi}^{ks,\\xi}_1[n]\\rangle\\langle { \\phi}^{ks,\\xi}_1[n]\\vert.\\end{aligned}\\ ] ] according to eqs .",
    "( [ eq : ens_ks_decomp ] ) and ( [ eq : enshxc_decomp ] ) , the ensemble @xmath0 energy can be expressed as @xmath65&=&e_{xc}[n]+ \\int_0^w d\\xi \\dfrac{\\partial e^{\\xi}_{xc}[n]}{\\partial \\xi } \\nonumber\\\\ & = & e_{xc}[n]+ \\int_0^w d\\xi \\left ( \\dfrac{\\partial f^{\\xi}[n]}{\\partial \\xi } - \\dfrac{\\partial t_s^{\\xi}[n]}{\\partial \\xi } \\right),\\end{aligned}\\ ] ] where @xmath82 $ ] is the ground - state @xmath0 functional .",
    "since @xmath77 $ ] and @xmath78 $ ] are the maximizing ( and therefore stationary ) potentials in the legendre  fenchel transforms of eqs .",
    "( [ eq : legendre_fenchel_ensemblell ] ) and ( [ eq : legendre_fenchel_ensemblets ] ) when @xmath83 , respectively , using the expressions @xmath84&=&(1-\\xi)e^{\\xi}_{0}[n]+\\xi e^{\\xi}_{1}[n ] \\nonumber\\\\ & & -\\int d{\\bf r}\\,v^{\\xi}[n]({\\bf r}){n}_{\\hat{\\gamma}^\\xi[n]}({\\bf r } ) , \\\\ t_s^{\\xi}[n]&=&(1-\\xi)\\mathcal{e}^{ks,\\xi}_{0}[n]+\\xi\\mathcal{e}^{ks,\\xi}_{1}[n ] \\nonumber\\\\ & & -\\int d{\\bf r}\\,v^{ks,\\xi}[n]({\\bf r}){n}_{\\hat{\\gamma}^\\xi_s[n]}({\\bf r}),\\end{aligned}\\ ] ] with the ensemble density constraint in eq .",
    "( [ eq : gace_dens_constr ] ) and the hellmann ",
    "feynman theorem we finally obtain @xmath85&=&e_{xc}[n]+ \\int_0^w d\\xi\\ ;   \\delta^\\xi_{xc}[n],\\end{aligned}\\ ] ] where the gace integrand is simply equal to the difference in excitation energy between the interacting and non - interacting electronic systems whose ensemble density with weight @xmath72 is equal to @xmath30 : @xmath86=\\left(e^{\\xi}_{1}[n]-e^{\\xi}_{0}[n]\\right)-\\left(\\mathcal{e}^{ks,\\xi}_{1}[n]-\\mathcal{e}^{ks,\\xi}_{0}[n]\\right ) .",
    "\\end{aligned}\\ ] ] note that , when the density @xmath30 equals the physical ensemble density @xmath87 ( see eq .",
    "( [ eq : phys_ens_dens ] ) ) and @xmath88 , the gace integrand reduces to the @xmath0 dd @xmath89 introduced in eq .",
    "( [ eq : xcdd ] ) .",
    "+ an open and critical question is whether the gace can actually be constructed for all weights @xmath72 in @xmath90 and densities of interest .",
    "in other words , does the gace density constraint lead to interacting and/or non - interacting @xmath91-representability problems ?",
    "so far , the gace has been constructed only for the simple hydrogen molecule in a minimal basis and near the dissociation limit  @xcite , which basically corresponds to the strongly correlated symmetric hubbard dimer . in the following ,",
    "we extend this work to the nontrivial asymmetric hubbard dimer .",
    "an important feature of such a model is that , in contrast to the symmetric case , the density ( which reduces to site occupations ) can vary , thus allowing for the construction of density functionals  @xcite .",
    "in the spirit of recent works by burke and coworkers  @xcite as well as senjean  _ et al . _",
    "@xcite , we propose to apply edft to the asymmetric two - electron hubbard dimer .",
    "the corresponding model hamiltonian is decomposed as follows , @xmath92 where the two sites are labelled as 0 and 1 , and @xmath93 is the hopping operator ( @xmath94 ) which plays the role of the kinetic energy operator .",
    "the two - electron repulsion reduces to an on - site repulsion , @xmath95 where @xmath96 is the spin - occupation operator .",
    "the last two contributions on the right - hand side of eq .",
    "( [ eq : asym_hubb_ham ] ) play the role of the local nuclear potential . in this context , the density operator is @xmath97 . for convenience",
    ", we will assume that @xmath98 note that the latter condition is fulfilled by any potential once it has been shifted by @xmath99 .",
    "therefore , the final expression for the hamiltonian is @xmath100 where @xmath101 . in this work",
    ", we will consider the singlet two - electron ground and first excited states for which analytical solutions exist ( see refs .",
    "@xcite and the appendix ) . for convenience ,",
    "the occupation of site 0 is denoted @xmath102 and we have @xmath103 since the number of electrons is held constant and equal to 2 . therefore , in this simple system , the density reduces to a single number @xmath30 that can vary from 0 to 2 .",
    "consequently , in this context , dft becomes a site - occupation functional theory  @xcite and the various functionals introduced previously will now be functions of @xmath30 . the ensemble ll functional in eq .",
    "( [ eq : general_ll_ensfun ] ) becomes @xmath104\\right\\},\\end{aligned}\\ ] ] where the density constraint reads @xmath105=n$ ] .",
    "by analogy with eq .",
    "( [ eq : legendre_fenchel_ensemblell ] ) and using @xmath106 , we obtain the following legendre  fenchel transform expression , @xmath107 where @xmath108 and @xmath109 are the ground- and first - excited - state energies of @xmath110 .",
    "note that , even though analytical expressions exist for the energies , @xmath111 has no simple expression in terms of the density @xmath30 .",
    "nevertheless , as readily seen in eq .",
    "( [ eq : lf_hubb ] ) , it can be computed exactly by performing so - called lieb maximizations .",
    "note that an accurate parameterization has been provided by carrascal  _ et al . _",
    "@xcite for the ground - state ll functional ( @xmath63 ) .",
    "+ similarly , the ensemble non - interacting kinetic energy in eq .",
    "( [ eq : legendre_fenchel_ensemblets ] ) becomes @xmath112 where @xmath113 and @xmath114 are the ground- and first - excited - state energies of the ks hamiltonian @xmath115 . from the simple analytical expressions for the homo and lumo energies , @xmath116 and @xmath117",
    "it comes that @xmath118 and @xmath119 a consequence of the latter equality is that , according to the hellmann ",
    "feynman theorem , the density ( _ i.e. _ the occupation of site 0 ) in the non - interacting first excited state is equal to 1 for any @xmath120 and @xmath121 values , as illustrated in the top left - hand panel of fig .",
    "[ fig : densetat ] .",
    "therefore , a density @xmath30 will be ensemble non - interacting representable in this context if it can be written as @xmath122 where the non - interacting ground - state density @xmath123 varies in @xmath124 ( see the top left - hand panel of fig .",
    "[ fig : densetat ] ) , thus leading to the non - interacting representability condition @xmath125 or , equivalently , @xmath126 . for such densities ,",
    "the maximizing ks potential in eq .",
    "( [ eq : hubb_tsw ] ) equals @xmath127 and , consequently , the ensemble non - interacting kinetic energy functional can be expressed analytically as follows , @xmath128 the ensemble correlation energy , which is the key quantity studied in this work , is defined as follows , @xmath129 where , by analogy with eq .",
    "( [ eq : eh_def ] ) , the hartree energy equals  @xcite @xmath130 the exact ensemble exchange energy in eq .",
    "( [ eq : ens_exx_def ] ) becomes in this context @xmath131 thus leading , according to the appendix , to the analytical expression @xmath132-e_h(n ) , \\nonumber \\\\ & = & e^{w=0}_{x}(n)+\\dfrac{uw}{2}\\left[1-\\dfrac{(1-n)^2(1+w)}{(1-w)^2}\\right],\\end{aligned}\\ ] ] where @xmath133 is the ground - state exchange energy for two unpolarized electrons .",
    "note that the exchange contribution to the gace integrand ( see eq .",
    "( [ eq : int_gace_integrand ] ) ) will therefore have a simple analytical expression , @xmath134.\\end{aligned}\\ ] ]    finally , the maximizing potential @xmath135 in eq .",
    "( [ eq : lf_hubb ] ) which reproduces the ensemble density @xmath30 fulfills , according to the inverse legendre ",
    "fenchel transform , @xmath136 where the minimizing density is @xmath30 .",
    "therefore , @xmath137 and , since @xmath138 ( see eqs .",
    "( [ eq : vksw_analytical ] ) and ( [ eq : tsw ] ) ) , the ensemble hartree-@xmath0 potential reads @xmath139 as a result , the ensemble correlation potential can be calculated exactly as follows , @xmath140 where all contributions but @xmath135 have an analytical expression .",
    "the hartree potential equals @xmath141 and , according to eq .",
    "( [ eq : hubb_ens_exx_ana ] ) , the ensemble exchange potential reads @xmath142.\\end{aligned}\\ ] ]",
    "in the rest of the paper , the hopping parameter is set to @xmath143 . for clarity",
    ", we shall refer to the local potential in the physical ( fully - interacting ) hubbard hamiltonian as @xmath144 .",
    "this potential is the analog of the nuclear - electron attraction potential in the _ ab initio _ hamiltonian .",
    "the corresponding ensemble density is the weighted sum of the ground- @xmath145 and excited - state @xmath146 occupations of site 0 , @xmath147 where , according to the hellmann ",
    "feynman theorem , @xmath148 @xmath149 note that the first - order derivative of the energies with respect to @xmath121 can be simply expressed in terms of the energies ( see eq .",
    "( [ eq : deriv_ener_deltav ] ) ) and that , for a fixed @xmath150 value , the ensemble density varies linearly with @xmath41 .",
    "ground- and excited - state densities are shown in fig .",
    "[ fig : densetat ] . for an arbitrary potential value @xmath151 , in the weakly correlated regime ( @xmath152 ) , sites are either doubly occupied or empty in the ground state and they become equally occupied in the first excited state .",
    "therefore , in this case , the model describes a charge transfer excitation . on the other hand , in the strongly correlated regime ( @xmath153 )",
    ", the ground - state density will be close to 1 ( symmetric case ) while the excited - state density becomes increasingly sensitive with @xmath154 to variations in @xmath121 .",
    "when @xmath154 is large , infinitesimal values for @xmath121 can lead to doubly occupied or empty sites in the first excited state .",
    "as clearly seen from the hamiltonian expression in eq .",
    "( [ eq : final_ham_hubb ] ) , if @xmath155 , site 0 `` gains '' an electron whereas , for @xmath156 , it `` loses '' an electron , thus leading to a discontinuity at @xmath157 for the excited state density when @xmath158 .",
    "let us stress that , for large but finite @xmath154 values , the latter density will vary rapidly and continuously from 0 to 2 in the vicinity of @xmath157 while the ground - state density remains essentially equal to 1 .",
    "this observation will enable us to interpret the gace integrand in the following .",
    "+ turning to the calculation of the dd ( see eq .",
    "( [ eq : xcdd ] ) ) , the latter can be obtained in two ways , either by taking the difference between the physical @xmath159 and ks @xmath160 excitation energies , which gives @xmath161 or by differentiation , @xmath162 in the former case , we obtain from eqs .",
    "( [ eq : hubb_noint_e0 ] ) , ( [ eq : elumo_hubb ] ) , and ( [ eq : vksw_analytical ] ) the analytical expression @xmath163 regarding eq .",
    "( [ eq : dd_finite_diff ] ) , the @xmath72-dependent ensemble @xmath0 energy @xmath164 must be determined numerically by means of a legendre  fenchel transform calculation ( see eqs .",
    "( [ eq : lf_hubb ] ) and ( [ eq : ens_corr_energy ] ) ) and its derivative at @xmath88 is then obtained by finite difference . as illustrated in the right - hand top panel of fig .",
    "[ fig : fish1 ] , the two expressions are indeed equivalent . in the symmetric hubbard dimer ( @xmath165 ) , it is clear from eq .",
    "( [ eq : dd_exp_hubb ] ) that the dd is weight - independent , since @xmath166 , and it is equal to @xmath167 $ ] . in this particular case ,",
    "the ground and first - excited states actually belong to different symmetries . in the asymmetric case ,",
    "various patterns are obtained ( see fig .  [",
    "fig : fish1 ] ) .",
    "interestingly , the `` fish picture '' obtained by yang  _ et al . _",
    "@xcite for the helium atom is qualitatively reproduced by the hubbard dimer model when @xmath168 , except in the small-@xmath41 region where a sharp change in the dd ( with positive slope ) is observed for the helium atom .",
    "this feature can not be reproduced probably because , in the hubbard model , the continuous real space is replaced by a lattice . from the analytical expression , @xmath169^{3/2 } } , \\ ] ] and fig .",
    "[ fig : densetat ] , it becomes clear that , in the hubbard dimer , the dd will systematically decrease with @xmath41 .",
    "let us finally focus on the weight @xmath170 for which the dd vanishes .",
    "for that particular weight , the ks homo - lumo gap is equal to the exact physical excitation energy .",
    "as shown in fig .",
    "[ fig : w0 ] , @xmath171 is quite sensitive to changes in @xmath172 in the vicinity of @xmath173 .",
    "note that , as discussed previously , the dd is constant and strictly positive in the symmetric dimer , which explains why @xmath171 is not defined around @xmath174 .",
    "@xmath175 with @xmath176 , @xmath177 and @xmath178 .      the general gace integrand expression in eq .",
    "( [ eq : general_gace_integrand ] ) can , in the case of the hubbard dimer , be simplified as follows , @xmath179 where the local potential @xmath180 can be computed exactly by means of the legendre  fenchel transform in eq .",
    "( [ eq : lf_hubb ] ) .",
    "results are shown in fig .",
    "[ fig : gace_integrand ] .",
    "note that , for a fixed density @xmath30 , the non - interacting @xmath91-representability condition for an ensemble weight @xmath72 ( see eq .",
    "( [ eq : cond_ens_dens ] ) ) reads @xmath181 in the symmetric case ( @xmath182 ) , the weight - independent value @xmath167 $ ] is recovered . in the weakly correlated regime ( @xmath183 ) , the analytical exact exchange expression for the gace integrand ( see eq .",
    "( [ eq : x_integrand_gace ] ) ) reproduces very well the total @xmath0 one , as expected .",
    "+ let us now focus on the stronger correlation regimes . for the large @xmath184 and @xmath185 values , we can see plateaus for the considered @xmath186 and @xmath187 densities in the range @xmath188 , thus leading to discontinuities in the gace integrand when @xmath189 . as readily seen in eq .",
    "( [ eq : dd_fun ] ) , these discontinuities are induced by the @xmath72-dependent fully interacting excitation energy ( first term on the right - hand side ) . as illustrated in fig .",
    "[ fig : densetat ] , when @xmath154 is large , the density of the ground state remains equal to 1 in the vicinity of the symmetric potential ( @xmath157 ) while the density of the excited state is highly sensitive to infinitesimal changes in the potential .",
    "the reason is that , in the @xmath189 limit , states with a doubly - occupied site are degenerate ( with energy @xmath154 ) when @xmath190 .",
    "the degeneracy is lifted when @xmath121 is not strictly zero . for finite but large @xmath191 values ,",
    "the first - excited state density will vary continuously and rapidly from 0 to 2 in the vicinity of @xmath157 .",
    "therefore , within the gace , the fully - interacting ensemble density reduces to @xmath192 with the condition @xmath193 , thus leading to @xmath194 and @xmath195 .",
    "the latter range describes exactly the plateaus observed in the @xmath185 panel of fig .",
    "[ fig : gace_integrand ] . in this case , the gace potential in the physical system is almost symmetric , thus leading to the following approximate value for the plateau , @xmath196 this expression will be used in the following section for analyzing the ensemble @xmath0 energy and potential .",
    "we also notice in fig .",
    "[ fig : gace_integrand ] that , outside the plateaus , the gace integrand becomes relatively small as @xmath154 increases .",
    "this can be interpreted as follows . in the @xmath189 limit , when @xmath197 , the ground ( with singly occupied sites ) and first - excited ( with a doubly occupied site )",
    "states are degenerate with energy 0 . if we consider , for example , an infinitesimal positive deviation from @xmath198 in the potential , sites will be singly occupied in the ground state and site 0 will be empty in the first excited state .",
    "it would be the opposite if the deviation were negative , thus leading to discontinuites in the ground- and excited - state densities at @xmath199 , as expected from the @xmath185 panel of fig .",
    "[ fig : densetat ] . for large but finite @xmath191 values , the ground - state density will vary continuously from 0 to 1 around @xmath200 while the first - excited - state density varies from 1 to 0 .",
    "the first excitation is a charge transfer .",
    "it means that , in this case , the fully - interacting ensemble density with weight @xmath72 can be written as @xmath201 with @xmath202 , thus leading to @xmath203 therefore , for a given density @xmath30 , the condition @xmath204 can be rewritten as @xmath205 in addition to the non - interacting @xmath91-representability condition in eq .",
    "( [ eq : rep_condition ] ) .",
    "note that , around @xmath206 , this condition becomes @xmath207 . in summary , for a fixed density @xmath30 , the range of ensemble weights @xmath208 can be described in the vicinity of @xmath197 .",
    "this range corresponds to situations where no plateau is observed in the gace integrand . since , according to eq .",
    "( [ eq:3rdorder_energy ] ) , the ground- and first - excited - state energies at @xmath197 can be expanded as follows , @xmath209 we conclude that , when @xmath208 and @xmath154 is large , an approximate gace integrand expression is @xmath210 note that , for an ensemble non - interacting representable density @xmath30 such that @xmath211 , the condition @xmath212 must be fulfilled , according to eq .",
    "( [ eq : rep_condition ] ) .",
    "if , in addition , @xmath213 ( _ i.e. _ @xmath214 ) , then the gace integrand is expected to diverge in the strongly correlated limit when @xmath215 , which is exactly what is observed in the @xmath185 panel of fig .",
    "[ fig : gace_integrand ] .",
    "exact ensemble @xmath0 density - functional energies are shown in fig .",
    "[ fig : exc_energies ] . as discussed just after eq .",
    "( [ eq : rep_condition ] ) , in the strictly symmetric case ( @xmath182 ) , the gace integrand is weight - independent , thus leading to an ensemble @xmath0 energy with weight @xmath41 that deviates from its ground state value by @xmath216 $ ]",
    ". therefore this deviation increases with the weight , as clearly illustrated in fig .",
    "[ fig : exc_energies ] . in the weakly correlated regime ,",
    "the deviation from the ground - state functional is essentially driven by the exchange contribution , as expected . for @xmath217 ,",
    "the deviation induced by the correlation energy becomes significant when approaching the equiensemble case . on the other hand , in stronger correlation regimes ( @xmath184 and 10 ) ,",
    "the weight - dependence of the ensemble correlation energy becomes crucial even for relatively small ensemble weights .",
    "the bumps observed at @xmath182 are a pure ensemble correlation effect . in the light of sec .",
    "[ subsec : gace_analysis ] , we can conclude that these bumps , which correspond to the largest deviation from the ground - state _ xc _ functional , are induced by the plateaus in the gace integrand which are defined in the range @xmath218 .",
    "outside this range , the integrand is given by eq .",
    "( [ eq : dd_fun_approx_outside_plateau ] ) .",
    "consequently , for given ensemble weight @xmath41 and density @xmath30 such that @xmath219 , the ensemble @xmath0 energy ( whose deviation from its ground - state value is obtained by integration from 0 to @xmath41 ) can be approximated as follows , @xmath220 which reduces to the ground - state @xmath0 energy when @xmath189 .",
    "for finite but large @xmath191 values , we obtain at the border of the @xmath91-representable density domain , @xmath221 where the second term on the right - hand side is negative .",
    "these derivations are in perfect agreement with fig .",
    "[ fig : exc_energies ] .",
    "note finally that , for @xmath219 , the ensemble @xmath0 potential can be approximated as follows , according to eq .",
    "( [ eq : ehxc_pot_derivative ] ) and ( [ eq : ens_xc_ener_outside_plateau ] ) , @xmath222.\\end{aligned}\\ ] ] + let us now focus on the complementary range @xmath223 .",
    "in this case , the ensemble @xmath0 energy is obtained by integrating over @xmath224 $ ] and @xmath225 $ ] weight domains , thus leading to the following approximate expression , according to eqs .",
    "( [ eq : dd_plateau_exp ] ) and ( [ eq : dd_fun_approx_outside_plateau ] ) , @xmath226 turning to the ensemble @xmath0 potential , it comes from eq .",
    "( [ eq : xcfun_ener_plateau ] ) that @xmath227\\dfrac{\\vert1-n\\vert}{1-n } \\nonumber\\\\ & & +   2t(n-1)\\bigg[\\dfrac{1}{\\sqrt{(1-w)^2-(1-n)^2 } } \\nonumber\\\\ & & -\\dfrac{1}{\\sqrt{1-(1-n)^2}}\\bigg].\\end{aligned}\\ ] ] since , in the @xmath189 limit , the ground - state @xmath0 potential becomes discontinuous at @xmath182 and reduces to  @xcite @xmath228 we conclude that , in the strongly correlated limit , the ensemble @xmath0 potential reduces to @xmath229 where , as readily seen , the ground - state discontinuity at @xmath182 has been removed .",
    "this is in perfect agreement with the @xmath185 panel of fig .",
    "[ fig : ens_xc_pot ] .",
    "note that , even though the exact exchange potential varies also linearly with @xmath30 , its slope is weight - dependent ( see eq .  ( [ eq : exact_ens_x_pot ] ) ) and equals the expected @xmath230 value only when @xmath231 , as illustrated in fig .",
    "[ fig : ens_xc_pot ] . in other words , both exchange and correlation contributions are important in the vicinity of @xmath30=1 .",
    "strong correlation effects become even more visible at the borders of the bumps in the @xmath0 ensemble energy , namely @xmath232 . indeed , at these particular densities , the ensemble @xmath0 potential exhibits discontinuities , according to eqs .",
    "( [ eq : xcpot_outside_plateau ] ) and ( [ eq : xcpot_plateau ] ) : @xmath233 which reduces to @xmath198 when @xmath189 , which is in perfect agreement with the panel @xmath185 of fig .",
    "[ fig : ens_xc_pot ] .",
    "in practical edft calculations , it is common to use ( weight - independent ) ground - state ( gs ) @xmath0 functionals  @xcite .",
    "such an approximation induces in principle both energy- and density - driven errors . in this paper",
    ", we will only discuss the former .",
    "the exact gs @xmath0 functional will be used and the approximation will be referred to as gs@xmath0 . the analysis of the density - driven errors requires the use an accurate parameterization for the gs correlation functional  @xcite .",
    "this is left for future work . for analysis purposes",
    ", we also combined the exact ( analytical ) ensemble exchange functional with the exact gs correlation functional , thus leading to the gs@xmath234 approximation . in summary , for a given local potential @xmath172 , the following exact @xmath235 and approximate @xmath236 ensemble energies have been computed , where @xmath87 is the _ exact _ ensemble density .",
    "results are shown in fig .",
    "[ fig : approx_ens_energies ] for various correlation regimes . in the symmetric case ( @xmath174 ) ,",
    "@xmath166 so that both exact and approximate ensemble energies are linear in @xmath41 and , as expected from fig .",
    "[ fig : exc_energies ] , gs@xmath234 performs better than gs@xmath0 . in the asymmetric case ( @xmath237 ) ,",
    "approximate ensemble energies become curved , as expected . while",
    ", for @xmath217 , gs@xmath234 remains more accurate than gs@xmath0 ( except for the equiensemble ) , the use of the ensemble exact exchange energy in conjunction with the gs correlation functional induces large errors on the ensemble energy in the strongly correlated regime ( @xmath185 ) .",
    "indeed , in the vicinity of the equiensemble , the ensemble energy is highly curved and its slope becomes negative , which is unphysical . on the other hand ,",
    "using both ground - state exchange and correlation functionals provides much better results .",
    "this can be rationalized as follows . according to fig .",
    "[ fig : densetat ] , when @xmath237 and @xmath185 , the equiensemble density equals 1.5 , which corresponds to the border of the bump in the ensemble @xmath0 energy that was discussed previously . using the @xmath185 panel of fig .",
    "[ fig : exc_energies ] , we conclude that gs@xmath234 underestimates the equiensemble correlation energy significantly while the exact ensemble @xmath0 energy is almost identical to the ground - state one .",
    "the former is in fact slightly lower than the latter , as expected from eq .",
    "( [ eq : exc_ener_border ] ) and confirmed by the @xmath185 panel of fig .",
    "[ fig : approx_ens_energies ] . therefore , in this particular case",
    ", gs@xmath0 is much more accurate than gs@xmath234 .",
    "edft is an exact time - independent alternative to td - dft for the calculation of neutral excitation energies .",
    "even though the theory has been proposed almost thirty years ago , it is still not standard due to the lack of reliable density - functional approximations for ensembles . in this paper ,",
    "exact two - state edft calculations have been performed for the nontrivial asymmetric two - electron hubbard dimer . in this system",
    ", the density reduces to a single number which is the occupation @xmath30 ( @xmath238 ) of one of the two sites .",
    "an exact analytical expression for the weight - dependent ensemble exchange energy has been derived .",
    "even though the ensemble correlation energy is not analytical , it can be computed exactly , for example , by means of legendre  fenchel transforms . despite its simplicity",
    ", this model has shown many features which can be observed in realistic electronic systems .",
    "in particular , the derivative discontinuity associated with neutral excitations could be plotted and analyzed in various correlation regimes .",
    "it appears that , in many situations , it is possible to find an ensemble weight such that the ks gap equals exactly the optical one .",
    "+ we have also shown that , in order to connect the ensemble @xmath0 functional with weight @xmath41 ( @xmath16 ) to the ground - state one ( @xmath63 ) , a generalized adiabatic connection for ensembles ( gace ) , where the integration is performed over the ensemble weight rather than the interaction strength , can be constructed exactly for any ensemble - representable density .",
    "the gace formalism was used for analyzing exact ensemble @xmath0 energies in the strongly correlated regime . in particular",
    ", we could show that in the density domains @xmath239 and @xmath240 , the ensemble @xmath0 energy reduces to the ground - state one whereas , for @xmath241 , the ensemble and ground - state @xmath0 energies differ substantially .",
    "the difference is actually , in the strongly correlated limit , proportional to @xmath242 when @xmath182 .",
    "the existence of these three density domains is directly connected to the fact that , in the strongly correlated regime , the well - known discontinuity at @xmath182 in the ground - state @xmath0 potential is removed when @xmath243 and it is replaced by two discontinuities , at @xmath244 and @xmath245 , respectively . + finally , ground - state density - functional approximations have been tested and the associated functional - driven error has been analyzed . whereas the use of the exact ( weight - dependent ) ensemble exchange functional in conjunction with the ground - state ( weight - independent ) correlation functional provides relatively accurate ensemble energies in the strictly symmetric or weakly correlated regimes , the combination of both ground - state exchange and correlation functionals provides much better ( sometimes almost exact ) results in the strongly correlated regime .",
    "this supports the idea that the use of ground - state functionals in practical edft calculations is not completely irrelevant .",
    "the analysis of density - driven errors is currently in progress .",
    "we hope that this work will stimulate new developments in edft for both model and _ ab initio _ hamiltonians .",
    "the authors thank the anr ( mcfunex project ) for financial support .",
    "42ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ]",
    " + 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase 10.1103/physreva.37.2809 [ * * , ( ) ] link:\\doibase 10.1103/physreva.37.2805 [ * * , ( ) ] @noop * * ,   ( ) @noop * * ,   ( ) \\doibase http://dx.doi.org/10.1063/1.4866998 [ * * ,   ( ) ] link:\\doibase    10.1103/physreva.90.042501 [ * * ,   ( ) ] http://scitation.aip.org/content/aip/proceeding/aipcp/10.1063/1.4938857 [ * * ,   ( ) ]",
    "\\doibase    http://dx.doi.org/10.1063/1.4872255 [ * * ,   ( ) ] http://stacks.iop.org/0953-8984/27/i=39/a=393001 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.93.245131 [ * * , ( ) ] @noop _ _ ,  ed .",
    "( ,  ,  ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase 10.1080/00268976.2013.858191 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.52.r4313 [ * * , ( ) ] link:\\doibase 10.1103/physrevlett.110.126403 [ * * ,   ( ) ] \\doibase http://dx.doi.org/10.1063/1.4871462 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.90.050502 [ * * ,   ( ) ] @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop ( ) ,   @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase 10.1103/physrevb.52.2504 [ * * , ( ) ] @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase 10.1103/physreva.94.012511 [ * * ,   ( ) ]",
    "individual ground- and first - excited - state singlet energies @xmath246 ( @xmath76 ) are in principle functions of @xmath120 , @xmath154 and @xmath121 , and they are solutions of @xmath247 the exact ground - state energy can be expressed analytically as follows  @xcite , @xmath248 where @xmath249 and @xmath250 the first - excited - state energy is then obtained by solving a second - order polynomial equation for which analytical solutions can be found  @xcite . + differentiating eq .",
    "( [ eq:3rdorder_energy ] ) with respect to @xmath154 gives @xmath251 since , according to the hellmann ",
    "feynman theorem , @xmath252 combining eqs .",
    "( [ eq : hubb_noint_e0 ] ) , ( [ eq : hubb_noint_e1 ] ) , ( [ eq : vksw_analytical ] ) with eq .",
    "( [ eq : hubb_ens_exx ] ) finally leads to the expression in eq .",
    "( [ eq : hubb_ens_exx_ana ] ) .",
    "+ similarly , we obtain the following expression for the derivative of individual energies with respect to the local potential , @xmath253"
  ],
  "abstract_text": [
    "<S> ensemble density functional theory ( edft ) is an exact time - independent alternative to time - dependent dft ( td - dft ) for the calculation of excitation energies . despite its formal simplicity and advantages in contrast to td - dft </S>",
    "<S> ( multiple excitations , for example , can be easily taken into account in an ensemble ) , edft is not standard which is essentially due to the lack of reliable approximate exchange - correlation ( @xmath0 ) functionals for ensembles . following burke and coworkers [ phys . </S>",
    "<S> rev . </S>",
    "<S> b * 93 * , 245131 ( 2016 ) ] , we propose in this work to construct an exact edft for the nontrivial asymmetric hubbard dimer , thus providing more insight into the weight dependence of the ensemble @xmath0 energy in various correlation regimes . for that purpose , an exact analytical expression for </S>",
    "<S> the weight - dependent ensemble exchange energy has been derived . </S>",
    "<S> the complementary exact ensemble correlation energy has been computed by means of legendre  fenchel transforms . </S>",
    "<S> interesting features like discontinuities in the ensemble @xmath0 potential in the strongly correlated limit have been rationalized by means of a generalized adiabatic connection formalism . finally , functional - driven errors induced by ground - state density - functional approximations have been studied . in the strictly symmetric case or in the weakly correlated regime , combining ensemble exact exchange with ground - state correlation functionals gives relatively accurate ensemble energies . however , in the strongly correlated regime , this approximation leads to highly curved ensemble energies with negative slope which is unphysical . </S>",
    "<S> using both ground - state exchange and correlation functionals gives much better results in that case . </S>",
    "<S> in fact , exact ensemble energies are almost recovered in some density domains . </S>",
    "<S> the analysis of density - driven errors is left for future work . </S>"
  ]
}