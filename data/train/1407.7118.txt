{
  "article_text": [
    "the _ hawkes process _  @xcite is a linearly self - exciting conditional poisson point process .",
    "it can be mapped onto a a branching process in which initial _ immigrant events _ can produce subsequent _ offspring events_. further , all realized offspring may produce offspring in the same way .",
    "thus each immigrant along with its multi - generational tree of offspring forms a _",
    "cluster_. this model has attracted a lot of attention since it parsimoniously combines exogenous activity ( immigration ) with endogeneous self exciting dynamics ( offspring ) .",
    "+ the seminal application of the hawkes model was within seismology  @xcite , where its spatio - temporal marked extension is being successfully used for modeling so - called triggered seismicity : the self - generated aftershock sequence after individual earthquakes ( see for instance review in  @xcite ) .",
    "recent applications include : modeling genomic events along dna  @xcite ; neural spike trains  @xcite ; brain seizures  @xcite ; and the spread of violence  @xcite and crime  @xcite . in financial and econometrical applications ,",
    "the hawkes process is becoming the gold standard for modeling high frequency fluctuations of financial prices ( see for instance  @xcite ) .",
    "+ in the theory of hawkes processes , the immigration process , i.e. , the location of clusters , is a poisson process .",
    "this implies that the cluster locations are independent . in this form",
    ", the likelihood of the hawkes model can be evaluated and thus maximum likelihood estimation ( mle ) can be performed .",
    "an extension of this model with inhomogenous poisson immigration  @xcite may also be estimated by maximum likelihood .",
    "+ poissonian immigration corresponds to exponentially distributed waiting times between immigrants .",
    "here we introduce a natural extension : the  _ hawkes process with renewal process immigration_. the renewal immigration process , like the poisson process , has i.i.d ( independent and identically distributed ) waiting times , but with a general waiting time distribution instead of the exponential distribution .",
    "the exponential distribution has a dispersion index value of one ( the ratio of the variance to the mean of interevent times ) , and is thus called equi - dispersed .",
    "the renewal process can describe both under- and over- dispersed immigration ( dispersion index less than and greater than @xmath0 , respectively ) .",
    "for instance , with a weibull waiting time distribution , one obtains this flexibility by introducing only one extra parameter relative to the poisson process .",
    "this flexibility comes at the cost of making the evaluation of the likelihood impossible , thus making direct mle practically impossible .",
    "+ to the best of our knowledge , there are no existing mathematical papers focused on this hawkes model with renewal immigration and more generally for renewal cluster processes and branching process with renewal process immigration .",
    "there have been some similar models proposed for applications in climatology but with either very restrictive model assumptions , or less desirable estimation properties . in  @xcite ,",
    "a renewal cluster model was proposed for clustering of rainfall events . in this model ,",
    "clusters are separated , from the end point of the last cluster to the starting point of the next cluster , by a renewal process .",
    "thus no overlap in clusters is allowed , which is a severe assumption in many applications .",
    "this simplification makes maximum likelihood estimation easy .",
    "further , using bartlett - lewis type clustering  @xcite , only the most recent generation point is fertile in this model .",
    "that is , the offspring are distributed after their immigrant in a finite renewal process with random termination size . in  @xcite ,",
    "a bartlett - lewis cluster process with renewal process immigration was considered for clustering of rainfall events .",
    "introducing overdispersion into the immigration process was motivated by the occasional observation of long periods without rainfall .",
    "the authors maximized a quasi - likelihood to estimate the model .",
    "+ in the present paper , we propose a novel way to calibrate such generalized renewal hawkes processes using the _ expectation maximization _ ( em ) algorithm  @xcite .",
    "we show that the problem of missing data ( the branching structure ) , which is necessary for the derivation of the complete data likelihood function , can be easily addressed within the em approach .",
    "the em algorithm has already been used for the estimation of the standard hawkes process  @xcite . here",
    "we extend this approach to the case of renewal process immigration , and introduce another em algorithm with a reduced set of missing data .",
    "+ the structure of the paper is as follows .",
    "section 2 presents the general structure of the standard hawkes process with poisson immigration together with the hawkes process with renewal immigration .",
    "section 3 introduces the complete data em algorithm for the estimation of hawkes process with renewal immigration .",
    "section 4 introduces the semi - complete data em algorithm using a minimal set of missing data . in section 5 ,",
    "the computation of likelihood and performance of goodness of fit tests for estimates of the hawkes model with renewal immigration are discussed .",
    "section 6 presents results of monte carlo studies of the complete data em algorithm including starting point selection , non - parametric methods , consistency , model selection , and robustness of branching ratio estimation under immigrant process misspecification . in section 7",
    ", the semi - complete data em algorithm is shown to be a computationally efficient method for the estimation of the hawkes process with inhomogeneous poissonian immigration . in section 8 , we conclude with a discussion on the significance and relevance of our findings , and directions for further research .",
    "consider a sequence of random event times @xmath1 , such that @xmath2 with _ inter - event waiting times _ @xmath3 .",
    "this sequence defines an _ univariate point process _ with _ counting process _",
    "denote a realization of the point process @xmath5 on @xmath6 $ ] with _ stopping time _",
    "@xmath7 where @xmath8 .",
    "when necessary , we denote the _ history _ of the process @xmath9 on time window @xmath10 $ ] .",
    "a point process @xmath11 can be defined by its _ conditional intensity _",
    "@xmath12 which is the instantaneous conditional probability of an event occurring  @xcite .",
    "the _ compensator _ of the point process is the expected value of the counting process at time @xmath13 : @xmath14 $ ] .",
    "+ the hawkes process  @xcite is a self - exciting conditional poisson process with the following linear conditional intensity function  : @xmath15 where @xmath16 is the _ background intensity _ and the conditional self - exciting term is @xmath17 where @xmath18 the function @xmath19 is the intensity of an inhomogeneous poisson process originating at each observed point , @xmath20 .",
    "it is also called the _",
    "memory kernel_. the function @xmath21 is the _ offspring density _ , a pdf ( probability density function ) only giving mass to positive support .",
    "the parameter @xmath22 is the _ branching ratio _ , a non - negative constant determining the strength of self - excitation .",
    "+ the hawkes process can also be considered as a branching process : @xmath23 is the _ immigration intensity _ , and @xmath19 is the _ offspring intensity _  an inhomogeneous poisson process triggered by each observed point .",
    "the branching ratio @xmath22 is the expected number of offspring of each point , and the offspring density provides the law for the parent - child inter - event times . due to the autoregressive nature of the process",
    ", it becomes non - stationary for @xmath24 ( the case @xmath25 is borderline stationary with non - standard scaling properties @xcite ) .",
    "the branching process is constructed as follows : the poissonian immigration process @xmath26 introduces immigrant points into the zeroeth generation ; each immigrant generates a subsequent offspring process , which introduces first - generation _ offspring _",
    "events @xmath27 ; each offspring may introduce second - generation offspring @xmath28 in the same way ; and so on over many generations .",
    "the union of the immigrants and offspring of multiple generations defines the hawkes process ( @xmath29 ) .",
    "further , by summing the mutually independent immigration and offspring intensities , one recovers the conditional intensity  .",
    "a realization of this conditional intensity is in the top panel of fig .  1",
    ". +        [ fig1 ]    the standard definition of the hawkes process   assumes constant or time - varying but deterministic immigration intensity @xmath30 , or in other words a poissonian immigration process @xmath26 .",
    "here we extend the definition by introducing the _ hawkes process with renewal immigration_. for this , we allow the immigration process @xmath26 to be a general renewal process , where waiting times @xmath31 are i.i.d from some pdf @xmath32 that is not necessary exponential . the conditional intensity of this process is then given by : @xmath33 ) = \\mu(t - t_{i[n(t ) ] } ) + \\phi(t|\\mathcal{h}_{t-}),\\ ] ] where we have defined the index function for immigrants @xmath34=k\\in { 1,\\dots , n(t)}~ , \\label{def_indexmostrecent}\\ ] ] which provides the point index @xmath35 of the most recent immigrant event @xmath36 before @xmath13 in the hawkes realization @xmath37 .",
    "the conditional intensity of offspring @xmath38 is given by the same equation  , and the intensity @xmath39 of the renewal immigration process is defined with @xmath40 where @xmath41 is the cdf ( cumulative distribution function ) of waiting times @xmath42 .",
    "the density @xmath43 may be expressed using expression   below .",
    "constant intensity then corresponds to a poisson process with exponentially distributed inter - event times that are equi - dispersed , and a strictly decaying intensity will provide a sub - exponential distribution of inter - event times that are over - dispersed .",
    "the intensity @xmath30 integrates to infinity and thus the process does not go extinct .",
    "a realization of this process together with renewal immigrantion is presented in the lower panel of figure  1 .",
    "+ where an immigrant together with its associated offspring form a cluster , the hawkes process is a _ poisson cluster process _ , and the hawkes process with renewal immigration is thus a _ renewal cluster process_. thus , the model   introduces `` nearest neighbour '' dependence into the location of clusters , allowing for both under- and over - dispersion in the immigration process itself . in some sense , the over - dispersed renewal process , having `` one step memory '' , can be considered as the simplest case of a self - exciting process .",
    "thus , the hawkes process with renewal immigration is a step towards a model with two stages of self excitation . +",
    "a challenging aspect of this model is the estimation procedure .",
    "the general form of the log - likelihood of a realization @xmath37 on @xmath6 $ ] is given by  @xcite : @xmath44 where @xmath45 is the parameter vector of the model .",
    "maximizing this log likelihood   with respect to @xmath45 has the interpretation of maximizing the intensity at observed points and minimizing intensity where no points are observed . for the standard hawkes model ,",
    "the conditional intensity   can be evaluated and thus mle can be performed .",
    "for the hawkes process with renewal immigration , to evaluate the intensity   and thus the likelihood  , one needs to know which events are immigrants . since this information is unobserved ( all events  immigrants and descendants",
    " are identical ) , direct mle using   is not possible . in order to account for this missing data , in the following section we will employ an expectation maximization ( em ) algorithm .",
    "+ it is worth explaining the structure of the likelihood as the details are relevant in the following sections .",
    "the likelihood  , @xmath46,\\ ] ] is the product of the _ joint inter - event time density _ and the probability that no events occur between the last point and the stopping time . the joint inter - event time density within can be factored into a product of conditional poisson marginal inter - event time densities , @xmath47 which is the conditional probability of observing a point at @xmath13 times the probability of no points between the previous point @xmath48 and @xmath13 . for an inhomogeneous poisson process",
    ", the density becomes unconditional and , for a homogeneous poisson process , it becomes an exponential density .",
    "an expectation maximization ( em ) algorithm , first introduced in  @xcite , is an iterative algorithm for performing mle in the presence of missing data that , if known , would simplify the likelihood .",
    "consider the _ complete data _ likelihood function @xmath49 that has an explicit form for known sets of _ observed data _ @xmath50 and _ missing data _ @xmath51 . set @xmath50 together with set @xmath51 forms the _ complete data_. maximization of @xmath52 with respect to @xmath45 then results in parameter estimates .",
    "when @xmath51 is unknown , one can account for the missing data probabilistically using the following iterative procedure .",
    "+ first , one needs to guess the initial parameter estimates @xmath53}$ ] .",
    "then each @xmath54th iteration consists of two steps .",
    "given the estimates of parameters @xmath55}$ ] in the _ expectation ( e ) step _ , one needs to calculate the expected value of the complete data log - likelihood with respect to the conditional distribution of missing data  @xmath51 , given the observed data @xmath50 and current estimates of parameters @xmath55}$ ] :    @xmath56})=      \\mathrm{e}_{\\boldsymbol{z}|\\boldsymbol{x},\\boldsymbol{\\hat\\theta}^{[m ] } }      \\big[\\log \\text{l}(\\boldsymbol{\\theta};\\boldsymbol{x},\\boldsymbol{z})\\big].\\ ] ]    the conditional expectation   requires the derivation of the conditional pdf @xmath57})$ ] , which is nothing more than the likelihood function for estimation of missing data  @xmath51 given  @xmath55}$ ] and  @xmath50 . in the _ maximization ( m )",
    "step _ , the expected likelihood   is maximized to obtain new estimates of parameters @xmath58}$ ] : @xmath59}=\\arg\\max_{\\boldsymbol{\\theta}}q(\\boldsymbol{\\theta}|\\boldsymbol{x},\\boldsymbol{\\hat\\theta}^{[m]}).\\ ] ] the algorithm then proceeds by iterating the e and m steps until the parameter estimates @xmath55}$ ] stabilize . with each iteration",
    ", parameter estimates are guaranteed not to make the observed data likelihood worse  @xcite .",
    "+ an em algorithm for the hawkes process was identified in @xcite and formalized in @xcite . in particular , this em algorithm has had strong convergence results proven and tested @xcite , and in practice converges in less than 50 iterations , given sensible initial parameter estimates . here",
    "this algorithm is extended to the case of renewal process immigration , and an algorithm with a reduced set of missing data is also presented in section [ sec : semiem ] .",
    "+ for the case of the hawkes process with renewal immigration , @xmath50 is given by @xmath37 , and unobserved data @xmath51 is given by the _ branching structure _ of the process , which contains information of : ( i ) immigrant events and ( ii ) parenthood of offspring events ( see figure  1 ) .",
    "this branching structure is typically described with the lower - triangular matrix @xmath60 with diagonal elements @xmath61 if point @xmath62 is an immigrant and @xmath63 if not ; and sub - diagonal elements @xmath64 if point @xmath65 is direct parent to point @xmath62 . since a point can be either an immigrant or an offspring of a single parent , then each row of the matrix has only one unit element , and the rest of the entries are zero .",
    "+ consider the joint density @xmath66 .",
    "when the branching structure  @xmath60 for the self - excited hawkes process with renewal immigrants   is known , the conditional density @xmath67 can be split into a product of marginal inter - event time densities for independent inhomogeneous poisson sub - processes ( i.e. , densities of the form  ): @xmath68^ { z_{i , i } 1_{\\lbrace i[i]=j \\rbrace } }    \\prod_{i=1}^{n } \\prod_{j = j[i]}^{i-1 }   \\left [ \\eta h(t_i - t_j)e^{-\\int_{t_j}^{t_i } \\eta h(s - t_j)ds } \\right]^ { z_{i , j } } \\ ] ] the first term in square brackets is the immigrant inter - event time density @xmath43 introduced in relation with expression  ) and @xmath69 $ ] is defined in  . when a lag @xmath70 is an immigrant inter - event time ( i.e. , @xmath71=j \\rbrace}=1 $ ]",
    ") then @xmath43 is evaluated at that lag .",
    "the second term in the square brackets is the _ offspring intevent time density_. when a lag @xmath70 is a parent - child inter - event time ( i.e. , @xmath72 ) then the offspring inter - event time density is evaluated at that lag . to avoid undefined values of  , the offspring inter - event time density",
    "is only evaluated at lags within the support of the offspring density @xmath73 .",
    "this is done by defining this index function @xmath74:=\\min(j\\in \\lbrace 1 , \\dots , i-1 \\rbrace~:~h(t_i - t_j)>0 ) \\label{defindexfun}\\ ] ] that takes the index @xmath75 of point @xmath20 and returns the index of the most distant previous point @xmath76 with @xmath20 in the support of its offspring density @xmath77 .",
    "this issue is not present for @xmath43 since the immigration intensity never vanishes .",
    "+ following  , the complete data likelihood @xmath78 is constructed as a product of the joint pdf of observed events @xmath79 and a compensator term which accounts for the probability of observing no event after the last event in each independent subprocess .",
    "thus , after substituting   into   and rearranging , the complete data log - likelihood of the hawkes process with renewal immigration is written as :    @xmath80}^{i-1 } z_{i , j } \\log \\eta h(t_{i}-t_{j } )       - \\int_{0}^{r}\\phi(s|\\mathcal{h}_{s-})ds \\right ] \\\\",
    "+ \\left[\\sum_{i=1}^{n } \\sum_{j=1}^{i-1 } z_{i , i } 1_{\\lbrace i[i]=j \\rbrace } \\log\\mu(t_{i}-t_{j } )    -\\sum_{i=1}^{n+1}\\sum_{j=1}^{i-1 } 1_{\\lbrace i[i]=j \\rbrace}\\int_{t_{j}}^{t_{i}}\\mu(s - t_{j})ds \\right].\\end{gathered}\\ ] ]    for compact notation in  , we have also denoted @xmath81 as the starting time and @xmath82 as the stopping time .",
    "neither of these points are included in the sample .",
    "as it is seen , the complete data log likelihood is decoupled into a sum of independent terms for offspring and immigrant processes ( in square brackets ) .",
    "thus for a given branching structure @xmath60 , the estimation of parameters @xmath45 for the model amounts to independent estimation from i.i.d ( independent and identically distributed ) samples of immigrant inter - event times and parent - child inter - event times respectively .",
    "+ the following subsections describe the e step and m step for the corresponding em - algorithm that accounts for the unobserved branching structure @xmath60 .",
    "the e step involves evaluating the q function  , which is the expected value of the complete data log - likelihood   given the observed data @xmath37 and previous estimates of parameters @xmath55}$ ] :    @xmath83 } ) & = &      \\mathrm{e}_{\\boldsymbol{z}_{n\\times n}|\\boldsymbol{t}_{1:n},\\boldsymbol{\\hat\\theta}^{[m ] } }      \\big[\\log \\text{l}(\\boldsymbol{\\theta};\\boldsymbol{t}_{1:n},\\boldsymbol{z}_{n\\times n})\\big]\\propto      \\nonumber \\\\      & & \\left[\\sum_{i=1}^{n } \\sum_{j = j[i]}^{i-1 } \\mbox{pr}[z_{i , j}=1|\\boldsymbol{t}_{1:i},\\widehat{\\boldsymbol{\\theta}}^{[m ] } ] \\log\\eta h(t_{i}-t_{j } ) - \\int_{0}^{r}\\phi(s|\\mathcal{h}_{s-})ds \\right]\\nonumber \\\\      & & + \\left[\\sum_{i=1}^{n } \\sum_{j=1}^{i-1 } \\mbox{pr } [ z_{i , i } 1_{\\lbrace i[i]=j \\rbrace}=1 |\\boldsymbol{t}_{1:i},\\widehat{\\boldsymbol{\\theta}}^{[m ] } ] \\log\\mu(t_{i}-t_{j } )   \\right.\\nonumber \\\\      & & \\left.-\\sum_{i=1}^{n+1}\\sum_{j=1}^{i-1 } \\mbox{pr}[i[i]=j|\\boldsymbol{t}_{1:i},\\widehat{\\boldsymbol{\\theta}}^{[m]}]\\int_{t_{j}}^{t_{i}}\\mu(s - t_{j})ds \\right],\\end{aligned}\\ ] ]    where we have omitted the expectation of the first term in  , which is constant with respect to @xmath45 and is thus irrelevant to the determination of the parameters @xmath45 .",
    "+ to compute  , the missing data @xmath60 should be defined probabilistically .",
    "we denote the probability weights as @xmath84 and introduce the abbreviation @xmath85 for immigrant probabilities . by definition ,",
    "the weights sums to one : @xmath86 , @xmath87 .",
    "the first event ( @xmath88 ) has @xmath89 and is thus an immigrant .",
    "the second event ( @xmath90 ) has @xmath91 and thus can either be an immigrant or an offspring with the respective probabilities .",
    "each next event has one more parameter in the probability distribution than its predecessor .",
    "all these probabilities for the @xmath92 observed points can be presented as a lower - triangular matrix @xmath93 that is , at each iteration of the em algorithm , equal to the expected value of the branching structure matrix : @xmath94}_{n \\times n}=\\mathrm{e } [ \\boldsymbol{z}_{n\\times n } | \\boldsymbol{t}_{1:n},\\boldsymbol{\\hat\\theta}^{[m]}]~. \\label{defbranaverastr}\\ ] ] finally , we denote conditional probability weights : @xmath95=k ] , ~j\\leq i$ ] that are abbreviated @xmath96 for immigrants . in this notation , probabilities in   can be written in the form : @xmath97 = \\pi_{i , j } \\nonumber \\\\      & & \\mbox{pr } [ i[i]=j |\\boldsymbol{t}_{1:i } ] : = \\omega_{i , j }      = \\pi_{j}\\bar{\\pi}_{j+1|j}\\dots \\bar{\\pi}_{i-1|j } \\nonumber \\\\      & & \\mbox{pr } [ z_{i , i } 1_{\\lbrace i[i]=j \\rbrace}=1 |\\boldsymbol{t}_{1:i } ] = \\mbox{pr } [ i[i]=j |\\boldsymbol{t}_{1:i } ] \\pi_{i|j}=\\omega_{i , j}\\pi_{i|j},\\end{aligned}\\ ] ] where we have introduced weights @xmath98 and the bar denotes the complementary probability : @xmath99 .",
    "the first line of ( [ eq : q_weights ] ) is just the definition ( [ defprobwes ] ) .",
    "the second line defines the probability that @xmath100 is the last immigrant in the series of @xmath101 events up to time @xmath62 as the product of the probability @xmath102 that @xmath100 is an immigrant times the probabilities that all following events are not immigrants ( conditional on j being an immigrant ) .",
    "the third line defines the probability that @xmath100 is the last immigrant before immigrant @xmath101 in the series of @xmath101 events up to time @xmath62 .",
    "+ to derive the probability weights @xmath103 defined by ( [ defprobwes ] ) , we will exploit the branching structure of the hawkes process with renewal immigration  , which consists of a superposition of independent subprocesses . according to the thinning property  @xcite ( that was originally exploited for a similar purpose of `` stochastic declustering '' in  @xcite ) , the probability that an observed event @xmath20 comes from one of the subprocesses",
    "is equal to the proportion of the subprocess conditional intensity at @xmath20 in the total conditional intensity at the same time @xmath20 . + conditional probability weights @xmath104 can be calculated using the _ complete data conditional intensity _  , where the immigrant events @xmath105 are known . to derive unconditional probability weights @xmath103 , one needs to introduce the _",
    "incomplete data conditional intensity _ : @xmath106 where the incomplete data conditional intensity of immigration @xmath107 is a weighted mixture of immigrant intensities @xmath108 with weights @xmath109   equal to the probability that the event @xmath100 at time @xmath76 is the most recent immigrant before @xmath48 .",
    "+ finally , the estimation of probability weights for given observed data @xmath37 and parameters @xmath55}$ ] can be written in the following form : @xmath110 probability weights @xmath111 and @xmath112 , which enter the q function  , can be jointly computed in a recursive way , iterating over all observed events . for each event @xmath101 at time @xmath20 , we denote the probability weight vectors @xmath113 and @xmath114 .",
    "the first event is set to be an immigrant ( @xmath115 ) .",
    "looking at the weight vector makes the recursive relation clear : @xmath116 this recursive equation   expresses that the weight vector @xmath117 is the hadamard product ( e.g. , @xmath118 ) of the previous weight vector @xmath119 and a vector of complement probabilities ; and with @xmath120 concatenated on the end of the product . that is , taking the weight vector @xmath117 , discarding the last element from the vector , and then removing the last @xmath111 probability weight from each remaining element of the vector , one obtains the previous weight vector @xmath119 . having the weight vector @xmath119 then makes it possible to compute the necessary @xmath111 probablility weights ( using  ) to compute the next weight vector @xmath117 .",
    "this iteration is done for @xmath121 , producing all necessary probability weights for the e step .",
    "after the estimates of probability weights @xmath111 and @xmath112 for the given estimates of parameters @xmath55}$ ] and observed data @xmath37 are obtained , one can maximize the expected complete data log - likelihood ( q function )   with respect to the parameter vector @xmath45 to obtain new estimates @xmath58}$ ] .",
    "however rather than perform multivariate optimization of  , one can exploit the decoupling of the immigrant and offspring terms in  .",
    "decomposition of the q function   into the expected log - likelihood of the immigration process intensity @xmath122 and the offspring process intensity @xmath123 allows one to estimate the two processes independently when they do not share any common parameters .",
    "+ by recalling the form of an inter - event time density for an inhomogeneous poisson process , it can be seen that the m step estimation of the immigration process intensity @xmath122  i.e. , maximization of the expected complete data log - likelihood presented in the second square brackets in    is simply the maximization of the expected complete data log - likelihood for the inter - event times @xmath124 of the inter - event time density @xmath125 with parameter vector @xmath126 @xmath127=j \\rbrace}=1 |\\boldsymbol{t}_{1:i } ] \\log g(t_i - t_k|\\boldsymbol{\\theta}_g )       = \\arg \\max_{\\boldsymbol{\\theta}_g } \\sum_{i=1}^{n}\\sum_{j=1}^{i-1 }       \\omega_{i , j}\\pi_{i|j}\\log g(t_i - t_j;\\boldsymbol{\\theta}_g),\\ ] ] where the weights @xmath128 denote the probability @xmath129=j\\}}=1 |\\boldsymbol{t}_{1:i } ] $ ] that @xmath76 and @xmath20 are immigrants with no other immigrant events between them as defined by expression  .",
    "in other words , expression   is the maximum likelihood density estimation with a weighted i.i.d . sample . with the determination of the estimate @xmath130 , the immigrant intensity",
    "can then be computed using  .",
    "a non - parametric estimate of the density is possible , but numerical stability issues arise when computing the estimate for @xmath122 as the denominator becomes very small .",
    "+ estimation of the offspring intensity , requiring maximization of the expected complete data log - likelihood presented in the first brackets in  , is perfomed by separately estimating the branching ratio @xmath22 and the offspring density @xmath21 .",
    "+ the explicit mle for the branching ratio parameter  @xmath22 can be obtained by analytically maximizing with respect to @xmath22 :    @xmath131    where @xmath132 is the cdf : @xmath133 .",
    "the estimated branching ratio   is the ratio of the expected number of offspring to a number , which is slightly smaller than the total number @xmath92 .",
    "the denominator inflates the estimate of the number of offspring in the finite observation window to account for unobserved offspring expected to occur after the stopping time @xmath7 @xcite .",
    "+ estimation of the offspring density @xmath134 , parameterized by @xmath135 , is density mle with an i.i.d sample with sample weights , @xmath136}^{i-1 }       \\pi_{i , j}\\log \\text{h}(t_i - t_j;\\boldsymbol{\\theta}_h),\\ ] ] where the sample weights @xmath103 are the probability that @xmath76 is parent to @xmath20  .",
    "non - parametric estimation of the offspring density @xmath21 is straight - foward , for example assuming it to be a piecewise - constant function on intervals of length @xmath137 .",
    "the estimator is then given by @xmath138      in the proposed em algorithm , one needs to store @xmath139 probability weights and inter - event times for the estimation of the offspring density from i.i.d data , as shown from expression .",
    "estimation of the immigration density   and the branching ratio   only require the immigrant probabilities , i.e. , @xmath140 probability weights and inter - event times .",
    "one approach to address the quadratic complexity of the estimation of @xmath21 is to consider a reduced set of missing data .",
    "this is done in the following section . however , within the current algorithm , there are two approaches that may be taken to speed up the estimation of @xmath21 . + the first one is a monte carlo approach , which works as follows .",
    "choose an `` effective sample size '' , e.g. , the expected number of offspring points @xmath141 , take a sample ( with replacement ) of size @xmath142 from all positive inter - event times @xmath143 where the probability of selecting an inter - event time is proportional to its corresponding sample weight @xmath103 . then estimate @xmath21 on this unweighted sample . in   and other simple non - parametric density estimation techniques ,",
    "the inclusion of sample weights is easy .",
    "however , this approach also allows for other non - parametric techniques where considering sample weights is not as natural .",
    "thus , more complicated and potentially less suitable non - parametric estimation methods  for example choosing a smoothness penalty for the estimate and solving for the estimate using variational calculus as in @xcite  should not be necessary . + the second approach assumes that the offspring density has finite memory , i.e. , a finite support with upper endpoint @xmath144 . then , take @xmath145 to be the largest number of points observed within the support of the density .",
    "thus , the e step and m step only need to be performed on lags @xmath146 .",
    "this reduces the memory requirements and computational complexity from @xmath139 to @xmath147 with @xmath148 without introducing error into the procedure .",
    "taking @xmath149 too small will bias downward the estimation of the branching ratio  this is clear from   where the denominator will be too large .",
    "however , for hawkes processes with light tailed offspring distributions , this may provide a good approximation .",
    "further , @xmath149 may be adaptively chosen at each iteration of the em algorithm as one obtains an idea on which support most of the mass is distributed .",
    "in this section , an alternative em algorithm with a reduced set of missing data is proposed .",
    "it may be used for more computationally efficient estimation of the hawkes process with renewal process immigration .",
    "it may also be used to estimate the hawkes process with deterministic inhomogeneous poissonian immigration intensity @xmath30  the most efficient implementation allowing this to be done in linear time ( see sec . [",
    "sec : study2 ] ) .",
    "+ instead of the missing data being the entire branching matrix , here it is reduced to only the diagonal elements @xmath150 ; i.e. , it is reduced to the indicator variables for if a point is an immigrant or not .",
    "this is abbreviated by @xmath151 and called the _",
    "immigrant vector_. thus , given the _ semi - complete data _ @xmath152 , the _ semi - complete data log - likelihood _   may be written : @xmath153=j \\rbrace } \\log \\mu(t_{i}-t_{j } ) - \\sum_{i=1}^{n+1}\\sum_{j=1}^{i-1 } 1_{\\lbrace i[i]=j \\rbrace}\\int_{t_{j}}^{t_{i}}\\mu(s - t_{j})ds\\end{aligned}\\ ] ]    the derivation is similar to that of the complete data log - likelihood  . here",
    "immigration and offspring processes are separated , but the offspring processes are not decoupled from each - other , unlike in   where they are decoupled .",
    "the q function follows by taking the expectation of   with respect to @xmath151 given the observations and parameter values .",
    "the full expression is omitted for brevity ( its structure is already known from  ) .",
    "because the parts of   and   concerning immigration are identical , the immigration part of @xmath154 is identical to the immigration part in  .",
    "the offspring part will be discussed shortly . for the e - step ,",
    "the weights are computed using  , except that only the immigrant - specific probabilities @xmath155 and @xmath156 are needed .",
    "thus the e - step memory requirements here are @xmath140 rather than @xmath139 as in the complete data case .",
    "regarding the m - step , estimation of @xmath122 will be the same as in the complete - data case  .",
    "the offspring density @xmath21 and the branching ratio @xmath22 will be jointly estimated by numerically maximizing the part of the q function concerning the memory kernel : @xmath157    while this method is very useful for parametric estimation ( see sec .",
    "[ sec : study2 ] ) , the non - parametric estimation of @xmath21 will be difficult , due to the fact that , for example , unit mass and positivity must be enforced .",
    "moreover , the offspring density must be evaluated at @xmath139 lags @xmath158 . the monte carlo approach proposed in sec .",
    "[ sec : compeff ] can not reduce the computation here since @xmath159 are unknown .",
    "however , the second trick of assuming finite support of @xmath21 can reduce the computation to @xmath160 .",
    "further , using an exponential offspring density ( or any linear combination of them ) , a recursive relationship @xcite reduces the complexity to @xmath140 .",
    "computing likelihoods and performing goodness of fit tests to obtain p - values for estimates of the hawkes model with renewal immigration requires evaluating the complete data conditional intensity  .",
    "thus the immigrant vector @xmath161 must be known . + as will be shown , likelihoods and p - values must be computed for each immigrant vector , and aggregated . in general , there are @xmath162 possible valid immigrant vectors ( the first point is set to be an immigrant ) .",
    "immigrant vectors are indexed as @xmath163 , where the index i is one more than the decimal representation of the binary number in the immigrant vector excluding the first element , i.e. , @xmath164 , @xmath165 , @xmath166 , etc . to simplify computation ,",
    "a monte carlo approach can be used where sample averages of likelihoods and p - values are taken .",
    "specifically , given the probabilistic description of the branching structure obtained in the e step ( probability weights  ) , an ensemble of realizations of the immigrant vector may be generated , and likelihoods and p - values computed for each realization .",
    "ensemble average likelihoods and p - values may then be taken . a monte carlo study of the inferential power of these statistics is conducted in sec .",
    "[ sec : casecomplete ] .",
    "one needs to simulate realizations @xmath167 of the random variable @xmath151 with binary state space of dimension @xmath92 . for this , an acceptance - rejection thinning type algorithm @xcite",
    "is used : initialize by setting @xmath168 since the first point is treated as an immigrant .",
    "next , for each following event @xmath20 , @xmath121 , bernoulli random variables with probabilities @xmath169   are generated , and the first success is taken ( at @xmath170 ) as the second immigrant ( so @xmath171 ) ; then the third immigrant is selected in the same way with probabilities @xmath172 ; and so on .",
    "this thinning procedure is repeated until the stopping time @xmath7 is reached , resulting in a realization @xmath173 where @xmath174 .",
    "this procedure can be repeated @xmath175 times , and the sample set @xmath176 contains the ( possibly repeating ) indices of the sampled immigrant vectors .",
    "we now present a way to calculate a likelihood value for the hawkes model with renewal immigration .",
    "this procedure is valid for both the complete and semi - complete data em algorithms .",
    "the goal is to have a function by which hawkes models with and without renewal immigration may be compared in an objective statistical way . to accomplish this ,",
    "we treat the renewal process immigration as an inhomogeneous poisson process with ( deterministic ) intensity , @xmath177}|\\boldsymbol{z}_{1:n}^{(j)}),\\ ] ] which can be evaluated knowing the immigrant index vector @xmath178 .",
    "thus , plugging in the hawkes conditional intensity   with inhomogeneous poisson immigration intensity   into the log - likelihood equation  , and then transforming to a likelihood , one obtains the _ conditional incomplete data likelihood _",
    "@xmath179 for the immigrant vector j. by conditioning , the incomplete data likelihood may then be written , @xmath180,\\ ] ] which is a weighted sum of the conditional incomplete data likelihood  .",
    "the weighting probabilities in   may be computed by probabilities from the e step  . however",
    ", this is computationally burdensome . instead , a monte carlo approximation of the likelihood",
    ", @xmath181 may be done with sampled immigrant vector indices @xmath176 .",
    "the approximate log - likelihood may be obtained by taking the logarithm of this average  .",
    "one must be careful with the implementation of these calculations as numerical precision issues may be encountered in the averaging .",
    "the logarithm of the incomplete data likelihood   or its approximation   may be directly compared with the log - likelihood of the standard hawkes process  .      to perform a hypothesis test for an estimated point process model ,",
    "one often does _ residual analysis _",
    "@xcite based on the _ time change property _",
    "@xcite : for point process @xmath183 with compensator @xmath184 , the set of _ transformed times _",
    "@xmath185 , @xmath186 , are generated by a unit rate poisson process .",
    "thus for an observed realization @xmath37 , one can estimate its conditional intensity , transform it to @xmath187 and test if the resultant process is unit poissonian .",
    "for instance , one can test if the transformed inter - event times are standard exponential distributed .",
    "a popular portmanteau - type test for this is the kolmogorov smirnoff ( ks ) test @xcite .",
    "this test measures the _",
    "ks distance _ between the empirical transformed inter - event time distribution and the standard exponential null distribution . under the null hypothesis ,",
    "the distribution of the ks distance is known and thus a p - value may be computed .",
    "+ more generally , define the _ test statistic _",
    "( e.g. , the ks distance ) as a random variable @xmath188 , which , under the null hypothesis , has known _ reference distribution _ @xmath189 . here",
    "the observed test statistic @xmath190 transforms a realization of points @xmath37 , given the immigrant vector for those points @xmath191 .",
    "for semi - complete data sets @xmath192 , the null hypothesis @xmath193 is an event where the model is true for @xmath194 .",
    "then the _ semi - complete data p - values _ are @xmath195=1-f_{0}(s(\\boldsymbol{t}_{1:n},\\boldsymbol{z}^{(j)}_{1:n } ) ) , ~j=1,\\dots,2^{n-1}.\\ ] ]    for the incomplete data set @xmath196 , the null hypothesis @xmath197 is that the model is true .",
    "the test statistic for this , @xmath198 , is unknown because the immigrant vector is unknown .",
    "thus , by conditioning , the _ incomplete data p - value _ is @xmath199= \\sum_{j=1}^{2^{n-1 } } \\mathrm{pr}[\\boldsymbol{z}_{1:n}=\\boldsymbol{z}_{1:n } ] p^{(j)},\\ ] ] which may be expressed in terms of the semi - complete data @xmath182-values  .",
    "a monte - carlo approximation of the @xmath182-value   may be done , @xmath200 by taking the average of the semi - complete data @xmath182-values , having their indices in the sampled set @xmath201 .",
    "in this section , we discuss the convergence of the em algorithm ( consistency ) , the power of the goodness of fit test of sec . [",
    "sec : gof ] , and the robustness of hawkes process estimation in the case of mis - specification of the immigration process .",
    "we consider a particular type of renewal process for immigration , namely a renewal process whose inter - event durations @xmath202 have a weibull distribution with conditional intensity @xmath203 parametrized with the _ shape parameter _ @xmath204 and _ scale parameter _ @xmath205 . in this case , the pdf of inter - event times @xmath202 is given by : @xmath206    the case @xmath207 , for which the intensity   is constant , corresponds to the standard hawkes process   with @xmath208 .",
    "when @xmath209 , the intensity decays implying that the inter - event time density   is sub - exponential . in this case , the immigration process is over - dispersed in comparison with the respective poisson process for @xmath207 . on the other hand , as @xmath210 ,",
    "the inter - event density   weakly converges to a delta - function @xmath211 , and the immigration process becomes deterministic with regular event spacing @xmath212 .",
    "+ for the offspring density , @xmath213 , we consider both the exponential pdf , originally suggested by hawkes  @xcite : @xmath214 with shape parameter @xmath215 ; and the omori - type heavy - tailed pdf @xcite : @xmath216 with shift parameter @xmath217 and pareto tail index @xmath218 . +",
    "the exponential offspring density  , which is typical for financial and econometric applications  @xcite , ensures markovian properties to the model  @xcite . with respect to calibration",
    ", it reduces the computational complexity of evaluation of the log - likelihood from @xmath139 to @xmath140 by taking advantage of a recursive relation  @xcite and is more robust to outliers than heavy tailed alternatives  @xcite .",
    "a heavy - tailed offspring density   is typical for seismological applications  @xcite , where it accounts for the power law decay of aftershock activity with time ( _ omori s law _ ) in the so - called _ epidemic - type aftershock sequence ( etas ) _ models . while the computational complexity of evaluation of the log - likelihood is @xmath139 and can not be reduced , in practical applications",
    ", one can approximate the power law   with a sum of weighted exponential functions  @xcite .",
    "we now discuss the sensitivity to starting values , the speed of convergence , and the use of non - parametric estimation in the complete data em algorithm .",
    "the em algorithm is iterative and requires starting parameter estimates .",
    "further , em algorithms in general can get stuck in local optima and have a linear rate of convergence  @xcite .",
    "thus , selecting reasonable starting points , and understanding the speed of convergence are important .",
    "however , it was shown in  @xcite that the em algorithm for the standard hawkes process is a projected gradient descent algorithm with superlinear convergence .",
    "but , the speed of convergence worsens ( towards linear convergence ) as clusters are increasingly overlapping .",
    "this is intuitively clear , as the branching structure becomes less obvious as clusters overlap .",
    "this was explored in detail in  @xcite .",
    "a comprehensive study of this phenomenon will not be done for this extended algorithm as new insights are not expected . instead",
    "a couple of illustrative examples are given : + * example i * : a realization of 1000 points of a standard hawkes process   ( @xmath219 ) with high branching ratio was simulated .",
    "then the hawkes model with renewal immigration   was estimated on this data using the complete data em algorithm .",
    "the initial parameter estimates were chosen to be very close to a pure weibull renewal process with parameters estimated by mle ( @xmath220 , @xmath221 ) .",
    "a small offspring component was included in the initial estimate with uniform density on a large support ( @xmath222 ) .",
    "+ * example ii * : a realization of 1000 points of a hawkes process with weibull renewal immigration  ,   @xmath223 with low branching ratio is simulated . then the hawkes model with renewal immigration was estimated on this data using the complete data em algorithm .",
    "the initial parameter estimates included poissonian immigration , a higher branching ratio , and a uniform offspring density ( @xmath224 ) .",
    "+ the results are shown in fig .",
    "2 with example i in the top row and example ii in the bottom row . the estimates of the parameters and the offspring density converge well within 50 iterations , however they do not become completely stable .",
    "this is due to the nonparametric density estimation , discussed below .",
    "despite the convergence from poor starting estimates for these different synthetic examples , for analysis of real data the authors recommend taking multiple starting points and keeping the best result .",
    "+    , @xmath212 , and @xmath22 being represented by k , b , and e respectively .",
    "the right column provides the estimated offspring density @xmath225 .",
    "the starting value is the dotted line , and the true function is the bold dashed line . over iterations ,",
    "the estimated functions ( solid lines ) become increasingly dark . , width=491 ]    [ fig : convergence ]    the local likelihood non - parametric density estimation technique ( implemented in r as locfit ) was used @xcite .",
    "this flexible technique estimates the log density using splines in a locally adaptive way .",
    "the technique budgets function complexity , only allowing the estimated function to be complex in regions where the data suggests that this is necessary  avoiding over - fitting and over - smoothing .",
    "however it still requires the selection of a smoothing bandwidth parameter .",
    "if insufficient smoothness is required , over - fitting will occur .",
    "the risk of over - fitting is worsened by the iterative nature of the algorithm .",
    "but , the locfit method allows for an effective measure of the degrees of freedom of the estimated function to be computed . with this",
    ", one can use , e.g. , aic for the estimated hawkes model to select the smoothing parameter .",
    "sample weights were considered by using the monte carlo method explained in sec .",
    "[ sec : compeff ] .",
    "thus , from iteration to iteration , the parameter estimates will never become completely stable .",
    "+ in the examples above , only an exponential offspring density was considered for the data generating process .",
    "heavy tailed ( sub - exponential ) offspring densities will be difficult to estimate non - parametrically .",
    "for instance , most non - parametric density estimation techniques will estimate the tail poorly due to sparse observations .",
    "the inclusion of mass in the estimate `` beyond the data '' can be achieved only by requiring a degree of smoothness from the estimated function . however , the assumption of high smoothness will cause problems when estimating regions of the density with high curvature ( e.g. , a steep mode ) . if a heavy tailed density is suspected , it may be worth starting with a parametric density such as the weibull  .",
    "this section discusses the bias and efficiency of the complete data em estimator for the hawkes process with renewal immigration  .",
    "+ we have considered synthetic realizations of the process   with parameters @xmath226 and @xmath22 presented in table  .",
    "the weibull shape parameter @xmath226 was given values @xmath227 ranging from highly over - dispersed to highly under - dispersed .",
    "for each value of @xmath226 , the scale parameter @xmath212 was chosen such that the expected immigrant inter - event time was equal to 10 , i.e. , @xmath212 was given values in @xmath228 .",
    "the characteristic time @xmath229 of the exponential offspring density   was chosen to be @xmath230 .",
    "+ for each combination of parameters , 50 independent realizations each of size 500 events were simulated .",
    "efficient simulation was performed using the algorithm of @xcite which exploits the branching process formulation of the hawkes process .",
    "the model parameters @xmath231 , @xmath232 , @xmath233 , @xmath234 were then estimated using the em algorithm .",
    "we intentionally chose `` bad '' starting values for the estimation procedure to demonstrate the convergence of the method : we selected @xmath235}=1 $ ] ; the scale parameter @xmath236}$ ] was chosen as the true value @xmath212 multiplied by a uniform random number in @xmath237 $ ] ; the branching ratio @xmath238}$ ] was chosen as a uniform random number in @xmath239 $ ] ; and the characteristic time of the offspring density @xmath229 was chosen as a uniform random number in @xmath240 $ ] .",
    "+ the bias and standard deviation of the estimates are presented in table  [ tab : well ] . in general ,",
    "most parameters were well estimated , especially the branching ratio @xmath22 .",
    "due to the fixed sample size of 500 points , when @xmath22 is larger , the expected number of immigrants @xmath241 $ ] is smaller . thus the bias and the variance of estimates of immigration process parameters @xmath231 and @xmath232 are larger with larger @xmath22 and are worst for @xmath242 , i.e. , when the @xmath241=50 $ ] .",
    "another factor that introduces systematic error into the results is when @xmath22 is large and thus clusters are overlapping . intuitively it is clear that when clusters triggered by different immigrant events significantly overlap , it is hard to discern the branching structure .",
    "systematic studies have confirmed that both mle and em estimation of the hawkes process are indeed worse in the case of overlapping clusters  @xcite .",
    "however , the bias decreases with increasing sample size .",
    "+    . results of the em estimation ( section  [ sec : em ] ) of the hawkes process with weibull renewal immigration   and exponential offspring density on synthetic data . for each combination of parameters ,",
    "this table presents the average bias and standard deviation ( in brackets ) of estimates over 50 synthetic realizations . [ cols=\"^,^,^,^,^,^,^\",options=\"header \" , ]     following from the analysis presented above , model selection can be successfully resolved using aic and/or the wilks test . in the following section , we will see that misspecification of the model ( misspecification of the immigration process ) can significantly bias parameter estimates .      in this section ,",
    "we explore the robustness of the estimation of the branching ratio   when the immigrant process is mis - specified in the hawkes model . for this , we consider again the hawkes process with weibull renewal immigration  , and exponential offspring density  .",
    "we fixed parameters @xmath243 and @xmath244 and varied the immigration shape parameter @xmath226 from highly over - dispersed 0.4 to under - dispersed 1.4 .",
    "as before , the scale parameter @xmath212 was chosen so that , for any given @xmath226 , the expected immigrant inter - event time was fixed ( in this case @xmath245=4 $ ] ) . + for each value of @xmath226 , we have simulated 50 independent realizations .",
    "each realization was used for parametric mle of the standard hawkes process with poisson immigration   and ( i ) exponential offspring density   and ( ii ) omori - type density  . figure 3",
    "presents results of the estimation of the branching ratio @xmath233 as a function of the shape parameter @xmath226 of the underlying immigration process .",
    "+     using the hawkes model with poissonian immigration and exponential offspring density ( black ) and omori - type density ( grey ) when the true process is generated with the hawkes model with weibull renewal immigration with shape parameter @xmath226 .",
    "the true branching ratio ( 0.5 ) is presented with a horizontal dashed line .",
    "solid lines correspond to median values and dotted lines present quartiles of estimates for both kernels.,width=264 ]    [ fig : varying_k ]    as seen from figure 3 , both models with poisson immigration have a significant bias in the estimation of @xmath233 . in the case of under - dispersed immigration ( @xmath246 )",
    ", one observes a relatively small negative bias which is similar for exponential   and omori - type   offspring densities .",
    "in contrast , for over - dispersed immigration ( @xmath209 ) the bias is positive and much stronger .",
    "for instance , when @xmath247 , the branching ratio has median positive bias of 0.17 and 0.31 for the hawkes process with exponential and omori - type offspring densities respectively .",
    "in this section , a monte carlo study is done , using the semi - complete - data em algorithm to estimate the standard hawkes process   with deterministic immigration intensity @xmath248 . of course",
    ", this algorithm may also estimate the hawkes process with renewal process immigration . for computational efficiency ,",
    "an exponential offspring density   is chosen . in this case",
    ", both the e and m steps of the semi - complete - data em algorithm are @xmath140 and it thus becomes possible to estimate the model on large datasets with a standard pc ( e.g. , estimation on a sample of tens of thousands of points takes a few minutes ) .",
    "the immigration intensity will be estimated using kernel estimation @xmath249 where the kernel function @xmath250 is a pdf with bandwidth parameter @xmath251 .",
    "this estimator   distributes mass @xmath252 around each point @xmath62 .",
    "the higher the bandwidth , the more dispersed the mass is .",
    "one practical issue is that mass may be distributed outside of the interval @xmath6 $ ] .",
    "this may easily be solved by symetrically `` reflecting '' any mass outside of the interval back into the interval .",
    "this operation is denoted by the term @xmath253 .",
    "another practical issue is the selection of a kernel density and the bandwidth . in general , this involves managing the trade off between model complexity and goodness of fit . for more detail on how to select the bandwidth ,",
    "see  @xcite . a nice feature of this estimator  )",
    "is that @xmath254 , i.e. , it is an unbiased estimator for the total number of immigrant points in the sample .",
    "an important consequence of this is that there is not systematic error in the estimation of the branching ratio  .",
    "+        [ fig : inhomo_mu ]    this monte carlo study involves simulating the hawkes process with sinusoidal immigration intensity @xmath255 , exponential offspring density   with scale parameter @xmath256 , and branching ratio values @xmath22 sweeping 0.1 to 0.9 by 0.1 .",
    "for each set of parameters , 50 simulations of this process on one period of the immigration intensity @xmath257 $ ] were performed .",
    "the median sample size was 1200 with quartiles 520 and 1310 .",
    "two models were estimated on each realization using the semi - complete data em algorithm ( see section [ sec : semiem ] ) : the first being the true model , and the second ( the false model ) being the true model but with homogeneous immigration ( i.e. , @xmath258 ) .",
    "the initial parameter estimates were randomly chosen uniformly at random in the following intervals @xmath259 , @xmath260 and @xmath261 . the em algorithm was allowed to perform 200 iterations , but in 90 percent of the time converged in less than 100 iterations .",
    "the convergence criterion was that the cumulative sum of the absolute differences of estimated parameters for the previous 3 iterations were within @xmath262 .",
    "+ in fig .",
    "4 , the true immigration intensity and a summary of the estimated immigration intensity across all samples is given for the estimated true model .",
    "the immigration intensity is well estimated , including cases when most of the points are offspring ( when @xmath242 ) .",
    "+ in fig .  5 , the errors in the estimation of the branching ratio for the true model ( grey ) and the false model ( black ) are summarized . for the true model ,",
    "estimation is consistent and efficient . for the false model , the branching ratio is consistently overestimated , in particular for low values of the branching ratio ",
    "i.e. , an upward bias of more than 0.6 when the true branching ratio @xmath263 , and still an upward bias of approximately 0.1 when @xmath243 .",
    "the overestimation is due to the fact that the inter - event time process of the inhomogeneous immigration is over - dispersed and contains apparent clustering .",
    "estimation improves with increasing @xmath22 because , as the number of offspring points increases , the memory of the estimated offspring becomes concentrated on the shorter offspring timescale . as a consequence",
    ", the dispersion / clustering in the immigration process can no longer be attributed to the memory kernel .",
    "[ fig : inhomo_eta ]",
    "in this article , the hawkes process with renewal immigration   was proposed and estimation was made possible by the introduction of two expectation - maximisation ( em ) algorithms , the first being an extension of @xcite .",
    "these estimation techniques were shown to be consistent in simulation studies , and easily allow for non - parametric estimation ( more easily than in @xcite ) .",
    "further , a computationally efficient implementation of the semi - complete data em algorithm was shown to be useful for estimating an inhomogeneous poissonian background intensity .",
    "the importance of correctly specifying the immigration process on branching ratio estimation was highlighted ",
    "indicating strong potential for the overestimation of the branching ratio when poissonian immigration is falsely assumed .",
    "+ as has been discussed , the hawkes model has been used in many areas .",
    "we recommend as a best practice that the hawkes process with renewal immigration be considered as an alternative model in such studies , in particular , when quantification of the branching ratio is of interest and one observes highly dispersed locations of clusters in the data . alternatively ,",
    "when one observes that the rate of events is changing , the inhomogeneous specification of the immigration process should be chosen .",
    "+ let us finish by providing a few examples of the relevance of the results of this paper to the existing literature .",
    "attempts to quantify the branching ratio for high frequency prices fluctuations of the s&p 500 e - mini futures contracts where the rate of events changes significantly over the day  @xcite can profit from using the semi - complete data em algorithm with non - parametric estimation of the inhomogeneous poissonian background intensity .",
    "further , in  @xcite , it was shown that the empirical inter - event time distribution of the s&p 500 e - mini futures contracts price fluctuations has too heavy of a tail to be explained by a hawkes process with poissonian immigration .",
    "allowing for overdispersed renewal immigration could be helpful here .",
    "either of these approaches should lower the estimated branching ratio from the levels reported in  @xcite .",
    "for the modeling of rainfall , this approach provides a richer model than @xcite and superior estimation to @xcite .",
    "+ there are a number of further methodological research directions suggested by this paper . in general , the em algorithm enables the maximum likelihood estimation of multi - type point processes , where the type is unobserved ; for instance , in other types of cluster processes , potentially with renewal process immigration . within the hawkes model , the em algorithm may also be extended to the case of the marked hawkes model  in which the size of an event influences its expected number of offspring via its fertility function  allowing for easy non parametric estimation of the fertility function .",
    "additionally , the hawkes model could be further extended to have self - exciting immigration , that is , a model with two stages of clustering .",
    "d.j . daley and d.  vere - jones . _ an introduction to the theory of point processes . volume ii : general theory and structure _ , volume  1 of _ probability and its applications_. springer verlag , 2nd edition edition , 2003 .",
    "d.  sornette and i.  osorio . .",
    "_ chapter in `` epilepsy : the intersection of neurosciences , biology , mathematics , physics and engineering '' , editors : osorio i. , zaveri h.p . ,",
    "frei m.g . , arthurs s. , crc press , taylor & francis group , _ ,",
    "pages 203237 ( http://arxiv.org/abs/1007.2420 ) , 2010 ."
  ],
  "abstract_text": [
    "<S> we introduce the _ hawkes process with renewal immigration _ and make its statistical estimation possible with two _ expectation maximization _ ( em ) algorithms . the standard _ hawkes process </S>",
    "<S> _ introduces _ immigrant points _ via a poisson process , and each immigrant has a subsequent cluster of associated offspring of multiple generations . </S>",
    "<S> we generalize the immigration to come from a renewal process ; introducing dependence between neighbouring clusters , and allowing for over / under dispersion in cluster locations . </S>",
    "<S> this complicates evaluation of the likelihood since one needs to know which subset of the observed points are immigrants . </S>",
    "<S> two em algorithms enable estimation here : the first is an extension of an existing algorithm that treats the entire branching structure - which points are immigrants , and which point is the parent of each offspring - as missing data . </S>",
    "<S> the second considers only if a point is an immigrant or not as missing data and can be implemented with linear time complexity . </S>",
    "<S> both algorithms are found to be consistent in simulation studies . </S>",
    "<S> further , we show that misspecifying the immigration process introduces signficant bias into model estimation especially the _ branching ratio _ , which quantifies the strength of self excitation . </S>",
    "<S> thus , this extended model provides a valuable alternative model in practice . </S>",
    "<S> + keywords : expectation - maximization algorithm ; branching process models ; renewal cluster process models ; point process models ; non - parametric estimation </S>"
  ]
}