{
  "article_text": [
    "the calculation of the power spectrum through direct fourier transform of 2d data in astrophysics is often hampered by two problems .",
    "i. : :    images may have irregular boundaries or parts of the image are    missing . in many cases masks are applied to remove contaminating    foreground sources , creating holes in the data that are hard to    correct for in fourier analysis .",
    "such problems arise , for example ,    when angular fluctuations of a diffuse emission are analyzed and a    number of compact sources have to be excised from the image ( e.g.    * ? ? ?",
    ": :    another problem often encountered when dealing with limited data sets    is the presence of large scale structures , which are not fully covered    by the image .",
    "the large scale power can leak into the observable    fourier frequency range , distorting the measured spectrum .",
    "this often    occurs in 1d timing analysis when the noise process monitored has    power on timescales longer than the total length of the time series    ( e.g. * ? ? ?",
    "* ) , or in 3d data cubes of hydrodynamical simulations for    example , when characterizing the turbulent velocity field in a    sub - volume of a larger simulated volume ( e.g. * ? ? ?",
    "these problems are illustrated in the left panel of fig.[fig : intro ] , which shows the fourier power density spectrum ( pds ) calculated for a 2d image . as input an image with steep pds @xmath1 was used .",
    "the red points show the fourier pds for the whole image , blue points show the pds calculated for a section one third of the linear size of the original image and green points show the case when about 25% of the data in the original image are missing and replaced with zero .",
    "changes in the slope and normalization are readily visible for blue and green curves .    a practical way to deal with these problems has been suggested in a series of papers by @xcite .",
    "their @xmath0-variance method preferentially selects fluctuations at a given spatial scale @xmath2 by convolving an image with two filters - a compact `` core '' filter and a more extended `` annulus '' .",
    "the core filter has a characteristic size @xmath3 and both filters are normalized to unity .",
    "the difference between the images convolved with these two filters is an image where all fluctuations with sizes much larger or much smaller than @xmath2 are suppressed .",
    "therefore the variance of the resulting image provides a measure of a typical amplitude of fluctuations of size @xmath3 in the original image .",
    "introduction of a mask helps to deal with the boundaries or data gaps .    in this paper",
    "we discuss a simple method , based on the @xmath0-variance approach to compute a low resolution power spectrum ( strictly speaking the convolution of the true power spectrum with a broad filter ) even when a large fraction of the original data is missing .",
    "the right panel in fig .",
    "[ fig : intro ] shows power spectra computed with our method for the same images used in the left panel .",
    "compared to the original @xmath0-variance method , our approach uses a different implementation of the filter , which simplifies the procedure , while cleanly compensating for missing data .",
    "we further test this particular implementation for a number of potential applications ",
    "e.g. measuring the power spectrum of the surface brightness fluctuations of the x - ray images of galaxy clusters , or characterizing the power spectrum of a turbulent velocity field in simulations .",
    "many other methods have been devised to deal with data with gaps .",
    "notably , multi - taper analysis techniques have been developed to estimate the power spectra of one - dimensional @xcite and multidimensional @xcite data in cartesian coordinates and on the sphere @xcite .",
    "the choice of taper functions is adapted to the type of data to be treated and the number of tapers is chosen to balance the bias and variance in the resulting power spectrum .",
    "these methods can recover very high resolution power spectra , suppressing the power leakage produced by the finite data length and are ideally suited to well sampled data where only few or no points are missing .",
    "severe gaps in the data complicate the application of these methods however .",
    "@xcite deal with large gaps by calculating separate power spectra for each segment and averaging together the results , which is not easily applicable to data sets with varying data and gap lengths or data in more than 1d .",
    "@xcite uses multi - tapering methods to compute the power spectrum of complete data sets with few small gaps , which requires the calculation of optimized taper functions for the precise structure of gaps in the data .",
    "although this method does a very good job at recovering the power spectral shape , it requires long and complex calculations which are not directly transferable between data sets with different sampling patterns and was only tested for cases where gaps cover a small fraction ( e.g. 5% ) of the data .",
    "the method we discuss in this paper is simple , robust and computationally fast .",
    "it has no tuning parameters and the interpretation of the resulting power spectrum is straightforward .",
    "most importantly , it can be applied without modifications to the data severely affected by gaps of different sizes .",
    "the trade - off is its low spectral resolution , so it is useful for cases when the underlying power spectrum is a smooth function of a wavenumber / frequency .",
    "possible applications in astrophysics include aperiodic variability patterns normally found in agn light curves ; analysis of fluctuations in 2d images , e.g. maps of molecular lines , x - ray images , faraday rotation measure maps defined in irregularly shaped regions ; characterization of 3d density or velocity fields in numerical simulations .",
    "all these cases are often affected to a varying degree by gaps in the data .",
    "these gaps arise mainly due to time constraints in the observations in time series , co - adding of several 2d images with different orientations and excision of contaminating sources and limited computational volumes in 3d simulations .",
    "we demonstrate that for data sets of sufficiently large dynamic range the proposed method recovers well the overall shape and normalization of the spectrum even when gaps occupy large fraction of the data set .    in terms of uncertainties in the power spectrum estimation at a given frequency ,",
    "the method is analogous to the regular fourier power spectrum , for data sets without gaps , provided that similar binning of the fourier powers is made in the frequency space .    in the following section we will describe the method ( sec .  [ sec : method ] ) and demonstrate its ability to recover the original power spectrum from simulated 2d images with gaps in sec .",
    "[ tests ] .",
    "we also apply the method in spherical coordinates and use it to evaluate the power spectrum for a characteristic case of cmb data analysis in sec .",
    "[ sec : cmb ] .",
    "we explore the properties and applications of the method to 3d data cubes in sec .",
    "[ sec:3d ] and 1d time series in sec .",
    "[ sec : timing ] . expected scatter and errors",
    "are discussed in sec .",
    "[ sec : error ] and we summarize our conclusions in sec .",
    "[ sec : conclusion ] .",
    "we consider an isotropic homogeneous random field , so that it can be characterized by a power spectrum @xmath4 , where @xmath5 is a scalar . instead of calculating the `` true '' power spectrum @xmath4 , where @xmath5 is the wave number , we want to evaluate the amplitude of fluctuations for a broad interval of wave numbers @xmath6 .",
    "we allow for gaps in the data and want to recover the correct shape and normalization of the power spectrum , provided that @xmath4 does not contain sharp features .",
    "the method consists of few simple steps for any given spatial scale @xmath2 :    ( i ) : :    the original image is convolved with two filters ( e.g. gaussian )    having different smoothing lengths    @xmath7 and    @xmath8 , where    @xmath9 .",
    "( ii ) : :    convolved images are corrected for the data gaps ( see     [ sec : method_wg ] ) .",
    "( iii ) : :    the difference of two images is calculated .",
    "this difference image is    dominated by fluctuations at scales @xmath10 .",
    "( iv ) : :    the variance of the resulting image is calculated and re - casted into    an estimate of the power .    the variance values are collected as a function of length scale or , correspondingly , wave number @xmath11 to produce the power spectrum @xmath12 .",
    "the tilde is added to distinguish the result from the true power spectrum .",
    "we first consider the case of data without gaps (  [ sec : method_ng ] , steps i , iii and iv ) and then discuss the procedure of correcting for gaps (  [ sec : method_wg ] ) using a mexican hat filter as an example .      to isolate structures of a characteristic length - scale , we first smooth the image @xmath13 with two gaussian filters ( for simplicity we consider 1d case ) : @xmath14 of slightly different widths @xmath7 and @xmath15 , where @xmath9 .",
    "the top panel in fig .",
    "[ fig : filter ] shows an example of two such gaussian filters , normalized to unity , together with their difference . for clarity only , in the figure we use @xmath16 .",
    "after convolving the image with each of these filters , both resulting images @xmath17 and @xmath18 will retain structures larger than @xmath2 and lose structures smaller than @xmath2 so the difference image @xmath19 will predominantly contain structures with the characteristic scales @xmath3 .    for @xmath20 the resulting filter @xmath21 e^{-\\frac{x^2}{2\\sigma^2 } } , \\label{eq : fs0}\\end{aligned}\\ ] ] which is the familiar mexican hat filter .",
    "obviously the shape of the filter does not depend on @xmath22 in the limit of @xmath23 . in practice",
    "we use @xmath24",
    ".     used for filtering ( red , blue ) and their difference ( black ) . _",
    "bottom panel : _ fourier transforms of the gaussian functions shown above ( red , blue ) , their difference ( black ) and the difference squared , amplified for clarity ( magenta ) .",
    "the magenta curve is the filter effectively applied on the power spectrum of the image treated , therefore the variance of the filtered image is normalized by the area under this curve . the transmitted power peaks at @xmath25 . ]    in terms of power spectra , the above procedure is equivalent to multiplying the original power spectrum of the data by the power spectrum of the filter , shown in the bottom panel of fig . [",
    "fig : filter ] .",
    "this panel shows the fourier transforms of the two gaussian filters , which are of course also gaussian , and their difference .",
    "the square of the difference , is the filter power spectrum . as shown in appendix",
    "[ ap : power ] , the peak of the filter power is at @xmath26 and its width is @xmath27 , independent of @xmath22 , as long as @xmath28 . here and below we adopt the relation between the spatial scale @xmath29 and a wavenumber @xmath5 in a form @xmath30 without a factor @xmath31 .",
    "the resulting filter is relatively broad and it can not be made narrower by using smaller values of @xmath22 .",
    "this has the implication that sharp features in the power spectrum will be smeared out , so our aim is to recover the broad band shape and normalization of the power spectrum but not narrow features .",
    "the choice of the gaussian filters is twofold .",
    "firstly , they provide a good balance in terms of the width in real and frequency space .",
    "the width in the real space is important when gaps or edges are present in the data ( see next section ) .",
    "a small width implies that the region affected by a given gap does not extend over the whole image .",
    "secondly , the use of gaussian filter is computationally convenient , since n - dimensional convolution with a gaussian in a real space can be easily factorized into 1d convolutions in each dimension .",
    "thus the difference between two convolved images , which we denote as @xmath32 is @xmath33 can be used to calculate the variance at scales @xmath34 and evaluate @xmath12 using a simple relation for the normalization ( see appendix [ ap : power ] ) .",
    "we now consider the image with gaps and introduce a mask @xmath35 such that @xmath36 here `` undefined '' refers not only to gaps , but also to areas outside the image boundaries .",
    "essentially for an @xmath37-dimensional image we treat the whole @xmath37-dimensional space outside the image boundaries as a data gap .",
    "the image @xmath13 is also set to zero in the gaps and outside image boundaries .",
    "thus , one can write @xmath38 , where @xmath39 is the true image without gaps , defined over the whole @xmath37-dimensional space",
    ".    direct application of the filter @xmath40 described by eq .",
    "[ eq : fs0 ] to the image @xmath13 with gaps will produce many spurious structures , which are difficult to correct for .",
    "however one can use the fact that the @xmath32 image can be represented as the difference of two smoothed images .",
    "consider , for instance , @xmath41 .",
    "convolving the image with gaps with a gaussian will still produce spurious features , but their amplitude can be drastically reduced by dividing @xmath17 by the mask @xmath35 , convolved with the same gaussian , to produce a corrected image @xmath42 : @xmath43 note , that we make the convolution in the infinite @xmath37-dimensional space without assumption of the image periodicity outside the image boundaries .",
    "intuitively the effect of the division by the convolved mask is clear : the amplitude of @xmath44 is going to be lower close to the gaps or close to image boundaries .",
    "the convolved mask @xmath45 largely shares these properties and the ratio @xmath46 will lack an obvious trend of the amplitude decrease near the gaps .",
    "the same argument applies to @xmath47 .",
    "finally @xmath48    the final step of the variance calculation is done only for the part of the corrected image @xmath49 where the mask @xmath50 ( see appendix [ ap : power ] ) . in summary , the biases introduced by the shape of the image boundaries and holes in the mask are corrected for by subjecting the mask to the same smoothing procedure and then dividing the smoothed image by the smoothed mask .",
    "therefore , the flux lost by smearing the image out of the mask boundaries is compensated by an equal loss of mask area around the edges . when approaching a gap , the convolved mask @xmath51 decreases smoothly from a value of 1 before the gap to 0 well into the gap , provided that the gap is larger than the filter size",
    ". therefore the convolved mask typically has a value of order 0.5 or larger at the edge of the original gap .",
    "since only unmasked parts of the image are used for the variance calculations , points where the denominators in eq .",
    "[ eq : ic ] vanish are automatically discarded .",
    "our approach is analogous to the @xmath0-variance method of @xcite and @xcite .",
    "in particular , one of the suggested forms of the filters in @xcite ( see their equation 11 ) leads to a convolution of an image with a mexican hat filter , in the limit of their parameter @xmath52 .",
    "in other words the difference between filters is the same as used here .",
    "however the individual filters are different .",
    "@xcite use a gaussian as a `` core '' filter and a ring - like shape function produced by a linear combination of two gaussians , as a `` annulus '' filter . in our implementation of the mexican hat filter",
    "the role of the core and annulus filters ( see @xcite for definitions ) is played by two gaussians with slightly different widths .",
    "far from image gaps and boundaries only the difference between the core and annulus filters matters .",
    "but in the presence of gaps or boundaries the functional forms of both filter starts to be important . representing the mexican hat as a difference between two gaussians simplifies the whole procedure when correcting for the missing data and ensures that the effect of gaps is almost identical for @xmath53 and @xmath54 .",
    "figure [ mask ] shows a simulated image with an isotropic power law power spectrum of slope @xmath55 .",
    "the top row in this figure shows the image decomposition into components of different spatial scales .",
    "the bottom row shows the same simulated image to which an arbitrary mask is applied ( left ) .",
    "other images in the bottom row show the decomposition performed on the _ masked _ image . clearly , the method is quite insensitive to the presence of the mask , as seen in fig .",
    "indeed , the fluctuations on different spatial scales can be recovered in the masked image without introducing spurious structures near the edges or gaps .",
    "to test the ability of the method to recover the original power spectrum of an image , we generated a set of 2d gaussian random fields .",
    "we simulate the effect of irregular edge shapes and excision of contaminating sources by masking out regions with different shapes and size scales . the mask in fig .",
    "[ mask ] is typical for wide field images when different exposures are combined and contaminating sources are excluded , creating irregular edges and holes in the mosaiced image . for the tests below we use more complicated masks , shown in fig .  [ fig:2dmask ] to verify the performance of the method in more extreme cases .",
    "the tests have also been run using the simple mask shown in fig .",
    "[ mask ] , recovering the input power spectra at least as accurately .",
    "the black areas represent the discarded parts of the input images .",
    "data gaps in real astronomical images are usually less extreme , compared to mask 2 .",
    "we use this extreme example to test the ability of the method to recover the input power spectrum even for images this heavily affected by gaps.,title=\"fig : \" ]   spectra .",
    "the black areas represent the discarded parts of the input images .",
    "data gaps in real astronomical images are usually less extreme , compared to mask 2 .",
    "we use this extreme example to test the ability of the method to recover the input power spectrum even for images this heavily affected by gaps.,title=\"fig : \" ]     we checked for overall biases in the power spectrum shape and normalization by generating images with randomized phases and amplitudes to simulate a gaussian field ( e.g. * ? ? ?",
    "images were constructed with power law power spectra of slopes between 0 and 4 and , for each case , 100 realisations were produced and masked by the patterns shown in fig .",
    "[ fig:2dmask ] .",
    "figure [ fig : mean_var ] shows the variance of the filtered images as a function of their characteristic filter scale @xmath56 , for different slopes of the power spectrum .",
    "simulated images had a size of @xmath57 pixels and a central @xmath58 pixels section of each image was used to calculate the power spectrum .",
    "the @xmath59 spectra were computed for each simulated image and their average is plotted in fig .",
    "[ fig : mean_var ] using black dots for the unmasked images , green squares for mask 1 and blue stars for mask 2 .",
    "spectrum over 100 realizations of simulated images .",
    "black dots show the spectrum computed for unmasked images .",
    "green squares and blue stars correspond to images masked using patters 1 and 2 ( see fig .  [ fig:2dmask ] ) .",
    "the slopes of the input power spectra are given in each panel .",
    "the input spectra are normalized to unity at @xmath60 . ]",
    "a very small deviation from a perfect power law shape is apparent at the high frequency end of the recovered power spectra even in the unmasked case .",
    "this happens because as the filter width approaches the size of the resolution element , the filter is under - sampled and fluctuations at those scales are less accurately recovered .",
    "there is a small decrease of power , of not more than 10% of the expected value , at k=0.3 pix @xmath61 . below this frequency",
    "the recovered power spectrum is not affected , so if the range of frequencies covered is large , the high frequency part can be discarded and the spectral slope can be accurately measured .",
    "similar effects are seen in 1d and 3d .",
    "the high frequency points in fig .",
    "[ fig : mean_var ] have the smallest scatter since they are averaged over many fourier modes .",
    "therefore , the statistical uncertainty , discussed in sec .",
    "6 is small , and can be smaller than the deviations described above . to avoid assigning too much weight to these points when fitting the measured power spectra , a systematic error of 10%",
    "was quadratically added to the estimated statistical uncertainty , associated with each point .    .",
    "results of power law fits to @xmath59 spectra averaged over 100 realizations of gaussian random fields in 2d with and without the mask .",
    "the input power spectra were normalized to 1 at @xmath60 and have slopes ranging from 0 to -4 .",
    "for the two groups of columns under the headings mask 1 and mask 2 , the masks shown in fig .",
    "[ fig:2dmask ] were applied to the images before calculating @xmath59 . for each case , a recovered power law slope and normalization are given .",
    "deviations in the normalization are largely explained by the normalization bias calculated in appendix  [ ap : bias ] . [ cols=\"^,^,^,^,^,^,^,^ \" , ]      as mentioned in  [ sec : introduction ] and [ sec : method_ng ] the method described above is a further development of the @xmath0-variance method of @xcite and @xcite . for the periodic data without gaps",
    "both methods produce mathematically equivalent results .",
    "we now proceed with a more detailed comparison of the filters performance for non - periodic data with gaps .",
    "the functional form used in @xcite , in the limit of their parameter @xmath52 , is as follows :    @xmath62    where @xmath63 is the size of the filter .",
    "it is obvious that the difference between these two filters is the mexican hat filter .",
    "however the shape of the second filter @xmath64 is very different from the first one @xmath65 .",
    "therefore it is expected that the impact of edges and gaps will be different for the filtered images corrected for these gaps and edges .",
    "this is in contrast with the representation of the mexican hat filter as the difference between two gaussians with almost equal width , which guarantees that the gaps have essentially identical impact on both gaussian convolutions leading to the filtered images .    to verify the above conjecture we made a number of test with different power spectra and masks .",
    "an example of an image and its masked version is shown in fig .",
    "[ fig : paos_img ] . as before the non - periodic image was obtained by cutting a section of a larger periodic image , in which a random realization of a gaussian random field with slope -2 was generated .",
    "the spectra recovered from the original and masked images for both methods are shown in fig .  [",
    "fig : paos_ps ] .",
    "the red and green points were obtained using the procedure described in  [ sec : method_wg ] , for the original and masked cases , respectively . both for the original and for masked images the spectrum agrees well with the input spectrum , shown by the horizontal dashed line .",
    "the spectrum , obtained using eq .",
    "[ eq : os ] shows larger deviations from the true input spectrum , especially for the masked image , shown in black .",
    "similar results were obtained for other types of masks probed .",
    "we therefore conclude that for non - periodic data sets with gaps the filtering based on two nearly identical gaussians provides more robust and accurate results .",
    "we note that the value of @xmath66 recommended by the authors is @xmath67 . repeating",
    "the test for this value of @xmath66 gave similar results to the @xmath68 case and our approach with similar gaussian still proved more accurate .",
    "the same method can be constructed in spherical coordinates . as an example , in this section we apply the filter formalism to the study of temperature anisotropies of the cosmic microwave background ( cmb ) radiation .",
    "let @xmath69 be the cmb temperature in the direction @xmath70 .",
    "a decomposition of the @xmath69 map on the sphere in a basis of spherical harmonics is , @xmath71 where @xmath72 is the spherical harmonic of order @xmath73 evaluated at the direction @xmath74 and @xmath75 are multipole coefficients .",
    "we assume that @xmath69 is a gaussian isotropic and homogeneous random field .",
    "the angular power spectrum @xmath76 for multiple @xmath63 can be estimated as @xmath77 where the averaging is done over @xmath78 .",
    "figure [ fig : cmbfit ] , shows the theoretical prediction for the angular power spectrum of the cmb temperature anisotropies for different angular frequencies ( or multipoles @xmath63 ) .",
    "the units of the y - axis are @xmath79 .    similarly to the cartesian 2d case described in  [ sec : method_wg ] one can define a filter as a difference between two gaussians defined on a sphere and allow for the data gaps .",
    "this yields an image ( cf .",
    "eq .  [ eq : a9 ] ) @xmath80 dominated by a particular angular scale @xmath10 .",
    "as before the variance of the resulting image is calculated and divided by the power of the filter . in the multipole space the corresponding filter has the same properties as the 2d filter in cartesian coordinates , described in the appendix  [ ap : power ] ( see eq .",
    "[ eq : filter ] ) .",
    "namely , @xmath81 where @xmath7 , @xmath82 and @xmath9 .",
    "the expected shape of the power spectrum can be calculated as : @xmath83 where @xmath84 is defined as the multipole where @xmath85 reaches its maximum .",
    "the corresponding angular power spectrum @xmath86 is shown in figure [ fig : cmbfit ] with the dashed line . clearly , the filtering procedure smears out small scale features , but recovers the overall shape and normalization of the power spectrum .",
    "this smoothed power spectrum is what we want to recover from the data using the proposed method .    in real data ,",
    "the estimation of the angular power spectrum must deal with the pixelized data and with the presence of the milky way and other contaminants that make necessary the exclusion of some pixels on the sky map .",
    "we used healpix to deal with the pixelized maps .",
    "the power spectrum is evaluated from the variance of the filtered images @xmath87 as @xmath88 where @xmath89 is the window multipole function for the healpix pixel .",
    "the presence of a mask usually biases the estimation of the power spectrum multipoles ( @xmath76-s ) and , at the same time , it couples these otherwise independent quantities . to test the method",
    "we impose a sky mask that covers @xmath90 24% of the sky , including the galactic plane and the position of bright radio sources .",
    "we also consider two different hemispheres of data separately , defined by an equatorial plane perpendicular to the direction ( l , b)=(0 , 45 ) in galactic coordinates .",
    "therefore , each hemisphere analyzes roughly 38% of the sky .",
    "we apply filters , of width of 0.1 , 0.12 , 0.22 , 0.35,0.42 , 0.5 , 1 , 2 , 3 , 4 , 8 , 10and 20 .",
    "an example of a masked cmb realization , filtered at two different scales is shown in fig .",
    "[ fig : cmbmap ] . when applying our thirteen different filters in the two masked hemispheres , we obtain @xmath91 for each hemisphere , displayed by the filled green and blue circles , in fig . [",
    "fig : cmbfit ] .",
    "the estimates from the two different hemispheres and for each filter scale @xmath2 follow closely the theoretical prediction provided by the dashed line .    for a single realization of the sky",
    ", the relative scatter of power spectrum estimates with respect to the average value is known to approximately follow the scaling @xmath92 which corresponds to the black solid line in the bottom panel of fig .",
    "[ fig : cmbfit ] .",
    "the symbol @xmath93 denotes the fraction of the sky covered in each hemisphere ( around @xmath9036% ) , and @xmath94 provides the effective width , in multipole space , of each filter .",
    "the blue and green circles show that the estimates of the angular power spectrum are scattered around the theoretical expectation by an amount that is not far from the theoretical prediction .",
    "this behavior breaks down at smaller angular scales , due to effects related to the finite pixel size , which in this case is slightly below 7 arc minutes .",
    "with @xmath95fraction of the sky not being masked .",
    "at @xmath63 values higher than @xmath96 the filter size reaches the pixel scale and the errors detach from the theoretical prediction .",
    ", scaledwidth=48.0% ]",
    "when analysing data of numerical simulations , e.g. a velocity field in hydrodynamic simulations , one often deals with 3d data cubes . in this section",
    "we extend the method on three dimensions and compare our power spectrum results with calculations using the conventional fourier transform . as before ,",
    "we generate isotropic gaussian random fields with a power law power spectrum spectrum , in 3d .",
    "in particular we consider a red noise process with slope @xmath97 , corresponding to the 3d kolmogorov power spectrum , which is often assumed when dealing with the turbulent velocity field .    ) .",
    "top : initial size of the box ; middle and bottom : @xmath98 and @xmath99 of the original size on a side respectively .",
    "red : the mean of 100 cube realization , gray : the range of statistical uncertainties corresponding to 1 @xmath2 scatter .",
    "[ fig : trimerr3d ] , scaledwidth=48.0% ]    .",
    "the power spectrum was obtained by averaging power spectra calculated for 100 random realizations with the same slope @xmath100 .",
    "the input power spectrum is shown with the dashed line .",
    "blue , red and green curves show the recovered power spectra from the initial box size ( @xmath101 cells ) , and trimmed sections of @xmath98 and @xmath99 of the original size on a side , respectively .",
    "[ fig : trim3d ] , scaledwidth=48.0% ]    the power spectrum @xmath59 is calculated analogously to the 2d case , by filtering the cube with 3-dimensional gaussians .",
    "the analysis in appendix  [ ap : power ] is directly applicable for @xmath102 .",
    "as before we assume isotropy in the random field , so we are only interested in the power spectrum as a function of spatial scale .",
    "the first question we address is whether the shape of the red noise is recovered well when the noise extends below the lowest wave numbers set by the size of the cube . to this end",
    "we calculate the power spectrum for the full simulated box and also for smaller `` trimmed '' boxes , which are cut from the original larger cube .",
    "the mean of 100 power spectra evaluated through the variance ( see  [ sec : method ] ) for the full box and trimmed sections , 1/2 and 1/4 of the original size on a side , are shown in fig .",
    "[ fig : trimerr3d ] .",
    "the 1@xmath2 statistical uncertainties for all three cases are shown on fig .",
    "[ fig : trimerr3d ] with gray shadows .",
    "the mean of 100 cube realisations and their trimmed sections are shown by the red lines on each panel , while the scatter is represented by the gray area .",
    "power spectra calculated through the conventional fourier transform are shown in fig .",
    "[ fig : trim3d ] .",
    "the input power law power spectrum is shown by the dashed black line . since trimmed cubes",
    "are not periodic anymore the power spectrum recovered through fourier transform is strongly distorted by leakage of power from very low frequencies .",
    "however , we see good agreement between the input and recovered power spectra calculated through the variance method .",
    "the minor discrepancies are only on the smallest and highest wave numbers .",
    "both discrepancies are caused by the fact that the value of the variance is a convolution of the true pds with the filter in frequency space . as a result at low @xmath5",
    "the power leaks out if the full simulated box is used , the simulated cubes effectively have zero power at frequencies lower then @xmath103 .",
    "this effect goes away if a subsection of the original cube is used ( see also 2d case in fig .  [",
    "fig : intro ] ) .",
    "we now proceed by considering the impact of data gaps on the recovered power spectra .",
    "we consider 3d masks covering different fractions of the cube volume .",
    "slices of masks through the box center are shown in fig  [ fig : masks3d ] .",
    "the first two masks are generated randomly and the fraction of missing data is 50 per cent in the left panel to 85 per cent in the middle panel .",
    "often , when one deals with simulations of galaxy clusters , large sub - halos or one of the sub - clusters in merging systems are excluded from the analysis .",
    "consequently , we generated a third 3d mask that mimics a situation when large sub - halo is excluded .",
    "the slice of this mask is shown on the right panel in fig .",
    "[ fig : masks3d ] .    ; white : data used for power spectrum calculations , @xmath50 . left and middle panels : masks are generated with random gaps .",
    "the fraction of discarded data is 50 and 85 per cent .",
    "right panel : mask mimics the case of excluded sub - halo . [ fig : masks3d ] , scaledwidth=48.0% ]    figure [ fig : maskfft3d ] shows the power spectrum of the data with gaps calculated through the conventional fourier transform and with the variance method .",
    "clearly , the direct fourier method should not be used for data with gaps .",
    "the increase of the gaps fraction leads to the leakage of power causing the flattening of the spectrum and the decrease of its normalization . at the same time the power spectra calculated through the variance",
    "are perfectly recovered , with only minor changes on small and large wave numbers even in case when 85 per cent of the data are in gaps .    ;",
    "red : 85 per cent of data is excluded , the middle panel in fig . [",
    "fig : masks3d ] ; green : large sub - volume of the box is excluded , see the right panel in fig .",
    "[ fig : masks3d ] .",
    "fourier method changes the slope and normalization of the recovered power spectrum , while the variance method recovers power spectrum without distortions on a large range of wavenumbers .",
    "[ fig : maskfft3d ] , scaledwidth=48.0% ]",
    "a possible 1d application of the method can be found in the study of light curves of variable objects .",
    "the method is of course not suitable for the search of periodicities , but can be useful for studies of aperiodic variability , when the broad band shape of the power spectrum is of interest .    the top panel in fig .",
    "[ fig : lc ] shows a simulated light curve typical for long term x - ray monitoring of an active galactic nucleus ( agn ) ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "the power spectra of these light curves is normally modeled as a single or broken power law , where the slopes and/or break frequencies are of interest ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "these light curves often have yearly gaps due to visibility constraints and different variability time - scales are covered by varying the sampling rate .",
    "the window function produced by these gaps causes spurious features in the power spectrum and different approaches have to be used to remove these features from the fourier transform of the light curve ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "top : simulated light curve , typical of agn long term x - ray monitoring , with varying sampling frequency and containing yearly gaps .",
    "bottom : the sampling rate varies with time , here the time difference between consecutive observations is plotted as a function of time , except for the largest gap , after the short , high cadence monitoring . ]",
    "the case of agn light curves is essentially different from images and simulated data cubes since normally the light curves are not sampled continuously over a regular grid , but consist of snapshot observations on irregularly spaced time intervals .",
    "long term agn light curves , as described above , suffer strongly from this effect , since the timescale coverage is optimized by combining epochs of very different sampling rates as shown in the bottom panel of fig .",
    "[ fig : lc ] . for our example",
    ", frequencies from @xmath104 to @xmath105 hz are probed using only 1100 light curve points .",
    "if it was evenly sampled , this range would require 20.000 points .",
    "this uneven sampling does not pose a problem to the variance calculation , since the filter convolution can be performed over uneven grids . in this case , the mask is simply the same time series , with all flux values replaced by 1 .",
    "figure [ fig : filteredlcs ] shows the filtered light curves on different timescales produced by this approach , gaps in the time series and varying sampling rates do not prevent a clean filtering of the fluctuations .        in figure",
    "[ fig : filteredlcs ] we have only plotted the useful part of each filtered light curve , these sections are selected to reduce the effect of aliasing , which is potentially a larger problem for light curves than for images . in the case of isotropic fluctuations in images , fluctuations on length scales shorter than the pixel size",
    "are averaged out . in the case of light curves , unless they are continuously exposed , variability on timescales shorter than the sampling interval adds to that of the longer fluctuations .",
    "this effect aliases power into lower frequency bands and distorts the measured power spectrum .",
    "aliasing can be diminished by demanding a minimum number of exposures within the convolution gaussian around a given lightcurve point for this point to count towards the variance calculation .",
    "in other words , if a point in the light curve has no neighbors closer than @xmath106 , for a given filter width @xmath2 , then it can not provide information on the corresponding frequency @xmath56 .",
    "therefore , although the point can participate in the convolution of the light curve , it should not be counted in the variance for that frequency .",
    "the procedure applied on the simulated light curve counts the number of neighbors for each point in the light curve while making the convolution and later discards points that have less than 6 neighbors for a given filter width , producing the filtered lightcurves in figure [ fig : filteredlcs ] .",
    "therefore , the shorter timescales are only probed by the more intensively sampled sections .",
    "we tested the recovery of the input power spectra for unevenly sampled light curves for different minimum numbers of neighbors within @xmath106 of each point .",
    "figure [ fig : pdslc_sigma4 ] shows an example of these tests , for simulated light curves of power law slope -1 .",
    "each power spectrum is the average of 100 simulations , to average out the fluctuations between different realizations . in the figure",
    ", the black solid line represents the power spectrum with no minimum number of neighbors required , so that all light curve points count towards all frequency bins .",
    "the peak in the middle is the effect of aliasing and the drop at high frequencies is the result of counting many isolated points in the variance , since these have all the same value they reduce the variance artificially .",
    "the red dashed line uses at least two neighbors and already corrects this last problem , while the aliasing is not resolved . requiring 6 neighbors ( pink dot - dashed line )",
    "already solves a large part of both problems , while requiring 10 neighbors ( blue dotted line ) produces a power spectrum quite close to the input power law .",
    "using more neighbors does not improve the recovered power spectrum but it reduces the probed frequency range , since at high frequencies the sampling rate itself limits the number of possible neighbors .",
    "the minimum number of neighbor points required to count a point in the variance calculation affects the shape of the resulting power spectrum .",
    "the power spectra above are each an average of 100 realizations , requiring 0 neighbors ( solid , black ) , two neighbors ( red , dashed ) , six neighbors ( pink , dot - dashed ) and ten neighbors ( blue , dotted ) .",
    "requiring more than 10 neighbors does not improve the recovered power spectrum and reduces the sampled frequency range as explained in the text .",
    "error bars denote the rms scatter in each set of simulations.,width=264 ]    finally , the entire power spectrum of the full range of frequencies covered by the light curve in fig . [ fig : lc ] can be computed directly .",
    "figure [ fig : pdslc ] shows the result of applying the filter formalism using a minimum of 6 neighbors to simulated light curves with the same sampling pattern and a bending power law power spectrum . for this figure",
    ", 100 random realizations were averaged together . at low frequencies the flat input slope and extreme mask produces the slope bias expected from the results in table 1 while the high frequency normalization is biased upwards by a factor of 1.3 , as expected from appendix  [ ap : bias ] .",
    "the approximate slopes , break and normalization of the input power spectrum , shown by the solid line , are clearly recovered .",
    "power spectrum of the simulated light curve with the same sampling as in in fig .",
    "[ fig : lc ] with a flat input power spectrum which bends to a power law slope of 2 at a frequency @xmath107 hz .",
    "the black symbols correspond to @xmath108 averaged over 100 realizations of the light curve .",
    "error bars denote the rms scatter in each set of simulations.,width=226 ]    for light curves similar to the one shown in fig .",
    "[ fig : lc ] the power spectrum is usually estimated through monte carlo simulations of sample light curves with given power spectrum parameters , attempting to recover only power law slopes , breaks and normalizations .",
    "the simplicity of the variance method is that it can be applied directly on the full light curve , regardless of the gap and sampling distributions and reproduce the overall shape with approximately correct normalization of the power spectrum .",
    "this will be particularly useful for large samples of agn light curves from large - area repeated surveys , where estimation of aliasing and red noise leak for each particular agn becomes impractical . for comparison , power spectrum fitting of the light curve in fig .",
    "[ fig : lc ] using psresp @xcite takes several hours whereas @xmath59 and its error estimate can be obtained in a few seconds on the same computer and both methods recover the spectrum with similar accuracy .",
    "as with other methods , it is possible to predict the uncertainty of the power estimates by assuming certain properties of the underlying variability process . in this case",
    "we will assume that the data being treated correspond to a gaussian field , so that independent points in the power spectrum are distributed around their mean values as a @xmath109 distribution with two degrees of freedom , with standard deviation equal to the mean .",
    "this means that the uncertainty of the power for each individual fourier mode is equal to the power itself .",
    "therefore , to calculate the expected uncertainty in a frequency bin , it is only necessary to combine quadratically the power at the frequencies that fall within the bin .",
    "the effect of the filter in frequency domain is to make a weighted average of the power spectrum estimates within the width of the filter .",
    "therefore , the expected uncertainty , @xmath110 , of @xmath59 can be calculated as a weighted mean of the @xmath4 values that fall under the frequency filter , where the values are combined quadratically .",
    "independent fourier modes in each dimension are separated in frequency by @xmath111 where @xmath112 is number of pixels in dimension @xmath113 .",
    "this spacing needs to be taken into account when calculating the uncertainty in order to include the correct number of power estimates under the filter . in the case of isotropic fluctuations in @xmath37 dimensions , where we only calculate the power as a function of @xmath114 , different groups of indices producing the same value of @xmath5",
    "are averaged together and this should also be considered in the uncertainty calculation .    the correct density of fourier modes is easily obtained by summing over all the independent modes , or equivalently over half the data points , i.e. over points @xmath115 , from 1 to @xmath116 in the first dimension and from 1 to @xmath112 in all the following dimensions as    @xmath117    for 1 dimension and @xmath118 for 2 dimensions . for larger @xmath37",
    "the formula is similar .",
    "the filter @xmath119 is centered on @xmath56 in frequency domain and is given in equation a6 . clearly for larger data sets ( larger @xmath112 ) , the independent modes are spaced more closely in frequency so more power spectrum points are averaged together under the same filter width and the uncertainty decreases accordingly as @xmath120 . since the number of fourier modes within the filter width grows linearly with increasing frequency in each dimension , the expected error spectrum is steeper than the powerlaw power spectrum by 0.5 in 1-d , by 1 in 2-d and by 1.5 in 3-d .",
    "as shown in the next section , this prediction is well matched by the data .",
    "the expected error can be calculated in one pass through the data points per frequency @xmath56 , so it does not imply a significant computational effort .",
    "the assumption of a gaussian field implies that each independent frequency will have its power distributed as a @xmath109 distribution with two degrees of freedom but the average over many such points will lead to a gaussian distribution . for low frequencies",
    "the number of fourier modes within the filter is small , so the distribution of powers deviates noticeably from gaussian .",
    "however , since the filter is broad in frequency , in 1d @xmath121 already contains enough points to produce an approximately symmetric distribution of measured power . in 2d and 3d cases the symmetry",
    "is achieved at even lower frequencies since the number of fourier modes within the filter grows as @xmath122 .",
    "the values of @xmath4 in the error formula can be estimated by interpolating between measurements of @xmath59 , given that the true underlying form is not known a priori . using the measured power spectrum in the error formula automatically takes into account the normalization bias and any other distortions , so that the resulting errors always represent the statistical uncertainty around the measured values .",
    "if the spectrum is finally rescaled by the normalization bias , the errors should be rescaled accordingly .",
    "the error formula predicts the scatter of @xmath59 measurements around the underlying power spectrum for a gaussian noise process .",
    "we tested the accuracy of this approach by comparing directly the predicted error to the rms scatter in 100 realizations of a noise process .",
    "figure [ fig : var_error ] shows this comparison of measured scatter in markers and predicted errors in lines , both relative to the measured power spectrum .",
    "solid lines and nearby markers correspond to 1d time series without gaps with input power spectra slopes of -1 and -2 ( the power spectra themselves are not shown here ) .",
    "there is a very good agreement between the measured rms spread and the estimated uncertainty @xmath110 in the case of continuous data sets .",
    "the error estimate described in this section is equivalent to the expected scatter from fourier analysis in the case of continuous data sets .",
    "the analysis above shows that the scatter around the mean power in binned fourier transforms and in @xmath59 spectra are identical , so both methods are equivalent when measuring low resolution power spectra of data without gaps .",
    "evidently , gaps in the data will reduce the number of available independent points and so the uncertainty in the power spectrum measurement should increase . as a first step to model this effect we scale @xmath110 by the number of points actually available in the data ( @xmath123 ) compared to the total number of points",
    "if there were no gaps @xmath124 : @xmath125 .     as a further refinement",
    ", it is convenient to count the number of available points as a function of @xmath56 , since small gaps do not affect the power estimates at low wavenumbers .",
    "this estimate is shown by the dashed lines in fig .",
    "[ fig : var_error ] . a good match to the measured scatter ( markers closest to the dashed lines )",
    "was obtained when points in gaps were discounted only if the gap was longer than 10% of the filter spatial scale ( @xmath126 ) . the errors and scatter measurements correspond to the same sets of simulated light curves discussed above , this time masked by gaps of random lengths so that 85% of the points were discarded .",
    "the uncertainty for each slope increases and the increase is larger at small spatial scales , which are affected by more gaps . in any case , the increase in uncertainty for any length scale is between @xmath110 and @xmath127 , so that for a small fraction of missing points the dependence of the error increase on @xmath56 can be neglected .    in the case of light curves with uneven sampling and very different sampling rates",
    "it is more convenient to scale the error by the lengths of useful data stretches to the total length .",
    "as before , useful light curve stretches can be selected for each frequency @xmath56 by requiring a minimum number of neighbors for useful data points .",
    "all useful segments are added to produce @xmath128 and the error is scaled as @xmath129 , where @xmath130 is the total length , used to calculate the frequency spacing .",
    "comparison of predicted relative error ( lines ) with measured rms scatter ( markers ) , for sets of 100 @xmath131 of simulated light curves .",
    "the solid lines and corresponding markers are calculated for continuous light curves of 2048 points and power law slopes of 1 ( blue lines and markers ) and 2 ( red lines and markers ) .",
    "the dashed lines and markers show the predicted and measured errors for the same light curves after 85% of the data points have been masked out producing gaps of random length . for this range of slopes",
    "at least the analytic prediction of the uncertainty in eq .",
    "[ eq : error ] works well . ]    when using these error estimates to fit models to the power spectrum it is necessary to use only independent measurements that , given the mixing effect of the filter , should be separated by at least a factor or 2 in frequency .",
    "the analytic error estimate was compared to monte carlo simulations of gaussian fields in 1 , 2 and 3d , for simple power law or broken power law power spectra of zero or negative slopes .",
    "although this is a limited subset of all possible power spectra it does cover a wide range of astrophysical phenomena of interest .",
    "more examples are given in fig .",
    "[ examples ] . here",
    "2d images with broken power law power spectra and affected heavily gaps as shown in mask 2 of fig .",
    "[ fig:2dmask ] are examined .",
    "the decrease in number of points was estimated from gap size distribution in the x direction only to estimate the errors .",
    "since the gap structure is largely isotropic , this simple 1d estimate gave a good approximation , shown by the dashed line , error estimates from rms scatter of 100 trials is shown in black markers . in the same figure we plot the predicted error and rms scatter of 100 simulated data cubes with power law slope 11/3 , also masking out 50% of the data points .",
    "the mask in this case is similar to that shown in fig .",
    "[ fig : masks3d ] , which affects all scales in approximately the same way so the effect of the mask can be estimated simply by rescaling the predicted error by the square root of the ratio of the total number of points to the number of points actually available .     relative error prediction for 2d ( red ) and 3d ( blue ) data .",
    "in this example the input power spectrum of the 2d data is a broken power law of low frequency slope 0.5 and high frequency slope 2.5 , and for the 3d data is a power law of slope 11/3 .",
    "the images have been masked out by random sized gaps covering 50% of the image .",
    "the predicted errors divided by the average power spectrum are shown by the dashed lines and the measured rms scatter of the 100 realizations is shown by the blue and red markers . the error formula in eq .",
    "[ eq : error ] predicts the errors accurately for simple and broken power law spectra in images and data cubes as well.,height=302 ]      a special case that we considered is largely found in 1-d light curves where observational constraints produce strictly periodic gaps .",
    "if the data and gap stretches are of equal length or the data stretch is longer , then the variance method and error estimate can be directly applied .",
    "however , if the gaps ( @xmath132 ) are longer than the data stretches ( @xmath133 ) and the sampling pattern is strictly periodic , then some timescales are effectively not probed by the data and the method can not be expected to produce reliable power spectral estimates for the corresponding frequencies .",
    "frequencies above @xmath134 and below @xmath135 are properly reproduced and the error estimate applies , as shown with an example in fig .",
    "[ fig : periodic ] .",
    "the power spectrum of frequencies within this range are not reliable and should be discarded .",
    "unsurprisingly , it is possible to recover the power spectrum for the timescales that are well sampled , either shorter than each individual data stretch @xmath133 or longer than a few times the sampling interval . in cases like this it is common to make separate estimates for the high and low frequency power spectrum , by averaging together individual power spectra from short stretches for the first case and by computing the power spectrum of low resolution light curves , averaging together data over @xmath133 and using the sampling interval as time step for the latter .",
    "one of the advantages of the variance method is that it can compute reliably the same range of frequencies directly from the complete light curve , without any further manipulation of the data .",
    "effect of periodic gaps in 1-d data .",
    "the above @xmath59 spectrum is the average of 100 realizations of slope 2 light curves masked by periodic gaps , where every 20 data points are followed by 80 gap points .",
    "the rms spread of the simulations is shown by the black markers and the uncertainty predicted by eq .",
    "[ eq : error ] is shown by the corresponding black line .",
    "the average power spectrum in blue crosses fits well the input power spectrum shown by the top black line and the error estimate works well for frequencies above @xmath136 and below @xmath137 , the power spectrum for frequencies in between these values should be discarded .",
    ", width=245 ]",
    "a simple method for estimating a low resolution power spectrum from data with gaps is described .",
    "essentially the variance associated with a given scale is calculated by convolving the image with a mexican hat filter .",
    "gaps in the data , described by the mask @xmath35 are corrected for by representing the mexican hat filter as a difference between two gaussian filters , convolving the image and mask with these filters and dividing results before calculation of the final mexican hat - filtered image .",
    "the variance of the filtered image is then calculated and the power spectrum is evaluated by repeating the procedure for different filter scales .",
    "the calculated power spectrum is smeared out by the width of the filter , so sharp features are lost , but the broadband spectral shape and normalization are recovered well .",
    "the strength of the method is that it is simple and robust .",
    "it can deal with severe gaps in the data and produce accurate power - spectral power law slopes and normalizations with no tuning parameters and is computationally cheap . by dividing the filtered images by their correspondingly filtered masks and maintaining the calculation in the space domain , the method cleanly compensates for data gaps even if these have complicated shapes and cover significant part of the data set .",
    "we use simulations to show that the power spectrum recovered from complete data sets and from their masked versions are consistent and no additional biases are introduced by the masks .",
    "the method can be applied straightforwardly to 1d timing analysis , 2d imaging of , for example , brightness fluctuations in galaxy clusters , and higher dimensional data cubes from numerical simulations .",
    "we are grateful to the anonymous referee for many useful comments and suggestions which helped to improve this paper .",
    "we also thank a. banday for helpful discussion on cmb data analysis .",
    "pa acknowledges support from fondecyt grant number 11100449 .",
    "iz would like to thank the international max planck research school ( imprs ) in garching .",
    "this work was partly supported by the division of physical sciences of the ras ( program ofn-17 ) .",
    "consider a @xmath37-dimensional ` image ' @xmath138 , where @xmath29 is @xmath37-dimensional vector , and corresponding mask @xmath139 with values of either 0 or 1 .",
    "@xmath140 means that this particular region of the image does not contain useful information and should be ignored when calculating the power .",
    "we first consider cartesian coordinates .",
    "our goal is to estimate typical amplitude of the power spectrum for a given spatial scale @xmath141 or , equivalently , given wave number @xmath56 . here and below we adopt the relation @xmath142 without a factor @xmath31 .",
    "the image is assumed to be an isotropic gaussian random field so we will only compute the power as a function of the scalar @xmath56 .",
    "we start by defining a gaussian filter in spatial domain , which will be convolved with the ] assuming first that the mask is equal to 1 everywhere we can combine two gaussians to create a filter which selects fluctuations with a given scale ( see fig .  [",
    "fig : filter ] ) : @xmath143 where @xmath7 , @xmath82 and @xmath144 .",
    "the shape of the filter is identical to the mexican hat in the limit of small @xmath22 . in fourier space",
    "the corresponding filter is : @xmath145 making a taylor expansion for @xmath22 we obtain @xmath146 the filter shape is therefore independent of the value of @xmath22 in the limit of small values so that the taylor expansion is valid .",
    "the value of @xmath22 only determines the normalization of the filter and this effect is canceled in the conversion of the variance of the filtered image , @xmath147 to @xmath59 below .",
    "the peak of the filter is at @xmath148 ( see fig .  [",
    "fig : filter ] ) .",
    "it is therefore natural to relate the characteristic scale @xmath56 corresponding to this particular filter width @xmath2 by : @xmath149 thus the final expression for the filter in fourier domain is : @xmath150 convolving the image @xmath138 with the filter @xmath151 described by eq .",
    "[ eq : fs ] and integrating the square of the convolved image is equivalent to integrating the product of the power spectrum @xmath4 and the square of the fourier transform of the filter , @xmath152 .",
    "below , @xmath147 is the variance of the filtered image @xmath153 since the mean of this filtered image is zero .",
    "@xmath154 notice that in eq .",
    "[ eq : filter ] the filter drops to zero for @xmath5 larger and smaller than @xmath56 so that the function @xmath4 can be approximated by @xmath59 and taken out of the integral : @xmath155 the last approximation breaks down for very steep power spectra , of positive or negative slope , where its product with the filter does not drop rapidly to zero for values of @xmath5 different to @xmath56 .",
    "the quantity @xmath147 is calculated from the image by following the filter and difference method described and expression [ eq : expected ] relates this quantity to the power @xmath4 through a scale - dependent normalization .",
    "therefore , the power @xmath59 can be evaluated .    in practice",
    "the mask is not unity everywhere . in this case",
    "the above calculation is done by convolving the image and mask with the two gaussian filters , dividing the convolved images ; subtracting results and applying the original mask to the result : @xmath156 the square of @xmath157 is then integrated .",
    "the regions where the image is not defined ( @xmath158 ) , which do not contribute to the variance , are simply compensated for by counting all pixels where @xmath140 and making appropriate scaling : @xmath159 where @xmath160 and @xmath161 .    comparing eq .",
    "[ eq : vobs ] and [ eq : expected ] we get the final estimate of the power density spectrum @xmath162 for a given wave number @xmath56 : @xmath163 where @xmath164 and @xmath165 for @xmath166 .",
    "the evaluation of the power density spectrum thus reduces to eq .",
    "[ eq : rmsk ] for a set of values of @xmath56 .",
    "for a pure power law spectrum @xmath167 the expression [ eq : van ] can be easily evaluated and exact relation between @xmath12 and @xmath168 can be written .",
    "the shape of the spectrum is of course recovered correctly , while the normalization may differ slightly , caused by moving @xmath4 outside the integral in eq .",
    "[ eq : expected ] : @xmath169 corresponding bias @xmath170 is shown in fig .",
    "[ fig : plb ] .",
    "one can see that for the most relevant problems ( 2d or 3d geometry ,",
    "@xmath171 in the range [ -3:0 ] ) the bias is modest . ["
  ],
  "abstract_text": [
    "<S> a simple method for calculating a low - resolution power spectrum from data with gaps is described . </S>",
    "<S> the method is a modification of the @xmath0-variance method previously described by stutzki and ossenkopf . </S>",
    "<S> a mexican hat filter is used to single out fluctuations at a given spatial scale and the variance of the convolved image is calculated . </S>",
    "<S> the gaps in the image , defined by the mask , are corrected for by representing the mexican hat filter as a difference between two gaussian filters with slightly different widths , convolving the image and mask with these filters and dividing the results before calculating the final filtered image . </S>",
    "<S> this method cleanly compensates for data gaps even if these have complicated shapes and cover a significant fraction of the data . </S>",
    "<S> the method was developed to deal with problematic 2d images , where irregular detector edges and masking of contaminating sources compromise the power spectrum estimates , but it can also be straightforwardly applied to 1d timing analysis or 3d data cubes from numerical simulations .    </S>",
    "<S> [ firstpage ] </S>"
  ]
}