{
  "article_text": [
    "the classical description in the binary collision approximation is well applicable for the description of ion - solid interactions in the energy range above @xmath01  kev ; the multiple interaction with two or more atoms , if significant , may be treated in a simple first - order approximation . in the computer simulation of phenomena related to ion - solid interactions ,",
    "this provides the possibility of an efficient reproduction of many experimental conditions playing with the parameters of the interaction model . due to the importance of this subject great efforts",
    "have been performed towards the development of efficient simulation programs  @xcite . to illustrate the central role that computer simulations have played in the field",
    ", it will suffice to mention that one of the most prominent phenomena , the channeling of ions in crystals , was first observed in simulation results  @xcite . in this context",
    ", one should refer also to the paper of barrett  @xcite which provides an important supplement to the theory of ion - crystal interaction allowing to address some aspects of the phenomenon which are difficult to treat theoretically .",
    "currently , with ion beams being widely used as a precision tool for the analysis and modification of materials , there has been an increase of the level of demands to simulation algorithms .",
    "one example is the use of low - energy ion beams for surface structure determinations .",
    "the classical picture of scattering together with the effects of blocking of scattering on atomic pairs form the basis for obtaining detailed information about the atom locations . the only way to extract",
    "this information is the comparison of intensities measured for different scattering geometries with the results of simulations for many trial structures .",
    "however , a fundamental problem occurs here due to the insufficient efficiency of existing algorithms . due to the small scattering cross sections ,",
    "the direct simulation by calculation of individual ion trajectories ( the program marlowe  @xcite is the most developed code of this type ) is often not practicable . to understand this one has to keep in mind that the experimental procedure typically consists in the measurement of angular scans with a small - aperture energy detector . to acquire the necessary statistics in a measured spectrum , the required number of ions in the beam amounts to @xmath1 for low - energy ( kev range ) scattering of heavy ions like ne or ar and to @xmath2 for scattering of ions with energies in the mev range .",
    "specially in the latter case it is out of the question to calculate the histories of motion of such a number of particles directly .",
    "for this reason , the conclusion is reached  @xcite that even the power of supercomputers is by far not enough to perform such simulations .",
    "an overview of the existing approaches to this problem shows that two main ideas are used depending on the ion energy . in the simulation of backscattering of high - energy channeled ions ,",
    "one can rely on the single - scattering model assuming that the motion of the ion in the outgoing path can be described by a straight - line trajectory .",
    "this allows to avoid a precise description of this segment of the ion trajectory . as a result",
    ", each ion contributes to the statistics according to the probability of close collisions along the ingoing path .",
    "the inverse ( blocking ) condition can be treated analogously ( see ref .  [ ] , for example ) .",
    "this model is well tractable and serves as the basis for a large number of algorithms which have been developed ( see refs .  [ ] for the most widely used ) .",
    "this algorithm does not work , however , if one is interested to simulate the channeling - blocking conditions or the scattering of low - energy and/or heavy ions . in these cases ,",
    "significant influence of crystal structure and/or strong multiple and plural scattering result in the necessity to reproduce the whole history of motion of individual ions inside the sample . as a result , the single - scattering algorithm needs a serious modification : now , to avoid the calculation of outgoing trajectories , we need to know the probability for an ion to end up in the detector for every position of the atom of the considered lattice site . a solution with emphasis for applications in the medium - energy ion scattering ( meis ) case ( @xmath3  kev light ions )",
    "was proposed in ref .",
    "[ ] ( the computer program vegas ) . according to the time - reversibility rule  @xcite , the mentioned probability can be represented by the flux of ions at the same point in the case that the beam enters , inversely , from the detector side . as a result , the simulation consists in the calculation of two fluxes , the direct flux and the inverse flux , followed by their convolution with the probability that the scattering atom occupies the required position . in this approach",
    "the electronic and nuclear energy losses are neglected , thus its applicability is guaranteed only at small depths of ion penetration and for relatively light ions .",
    "due to purely technical difficulties ( the main one is the need to store large sets of data for the fluxes ) , this method for medium energies is always used in a simplified form .",
    "namely , the energy and angular variables are not considered during the convolution of fluxes .",
    "it is assumed , in fact , that there is a one - to - one correspondence between energy and depth and the scattering angle of the collision is taken to be the same as the angle between the direction of the incoming beam and the direction to the detector .",
    "thus , such approach considers mainly the effect of the spatial distribution of fluxes and can not claim to achieve a detailed description of energy spectra and multiple ( plural ) scattering effects .    in the case of low - energy ( @xmath4  kev ) ion scattering ( leis ) where only a small number of atomic layers contribute to the detected yield",
    ", the full version of this `` reversing approach '' seems to be possible  @xcite .",
    "the only additional problem arising is that with the higher dimension of phase space the accumulated data arrays become very dilute . as a result",
    ", the convolution of the fluxes requires some special procedure . for this purpose , it was proposed to sum pairs of crossing trajectories of incoming and ( time - reversed ) outgoing fluxes with weights determined by the scattering cross section .",
    "it is clear that some tolerances in coordinates and energy have to be assumed in order to identify crossings among the finite set of calculated trajectories ; the associated inaccuracies are equivalent to those present in the case of the numerical convolution of both fluxes .",
    "one might expect , however , that allowing for an admissible level of accuracy , the efficiency of the simulation can be considerably increased as compared to the direct approach .",
    "indeed , a satisfactory description of experimental results for several leis conditions was found as a result of the application of this approach  @xcite .    in the present paper a new simulation approach is proposed .",
    "the developed computer code has the name tric ( transport of ions in crystals ) . in this method ,",
    "complete histories of ion collisions inside the sample are calculated as in the direct simulation approaches . to increase the efficiency we use a specific advance of the monte carlo method , the strategy of  importance sampling \"  @xcite : the distribution of thermal displacements of crystal atoms is sampled giving preference to those positions which result in scattering in a direction close to that of the detector .",
    "the actual probabilities of such displacements are accounted for in the accumulated statistics by the use of appropriate weighing factors .",
    "this procedure results in an illumination of the detector by intensive  showers \" of scattering events .",
    "additionally , in order to achieve a smoother statistics of rare events due to plural scattering , the strategy of  stratified sampling \"  @xcite is applied : the main fraction of close collisions which results in scattering to different directions are also sampled more often and these trajectories are also allowed to send showers towards the detector .",
    "the same strategy is used for a preferable choice of the initial coordinates of the ions entering into the crystal among those resulting in higher efficiency in the accumulated statistics .",
    "the paper is organized as follows .",
    "we present in sect .",
    "ii a detailed description of the simulation procedure . in sect .",
    "iii the efficiency and quality of the procedure are illustrated by the description of several experimental results under different conditions , selected also based on general interest . since the reversing approach , closely related with our proposed method , is in fact the only alternative claiming a similar efficiency we pay special attention in sect .",
    "iv to a careful analysis of its basis ; the main intention there is to recognize clearly the relative advantages of the two approaches .",
    "some concluding remarks are made in sect .",
    "the main idea that allows the increase of efficiency of the simulation is based on the fact that , due to thermal motion , each crystal atom can be found in different positions when the incoming ion crosses the considered lattice site . in the case that the atom is located close to the ion trajectory , a significant change in the ion motion can take place .",
    "events of scattering into directions close to the direction to the detector are obviously of special interest and it appears desirable to treat them selectively .",
    "this procedure should increase the number of relevant events at least in cases where scattering does not strongly perturb the further motion of the ion .    to implement this simple idea we use the following procedure .",
    "first , the impact parameter @xmath5 which corresponds to scattering from the current direction of motion into the direction to the center of the detector ( see the left - hand side of fig .  [ fig1 ] ) is determined ( @xmath6 denotes the number of the current lattice site ) . knowing this value",
    ", we can define the line ( in the scattering plane ) of atom positions necessary for such scattering . then , assuming that the relevant scattering directions lie within a cone of width @xmath7 , we can define the corresponding region of impact parameters whose half - widths in the scattering plane , @xmath8 , and in the perpendicular direction , @xmath9 , can be estimated as @xmath10 in this way also a fraction of the distribution profile of atom displacements is separated , the  hot \" region . then , one or several ( @xmath11 ) atom positions can be drawn from this region treating it as a part of the total ( gaussian ) distribution of atomic displacements ; as a result a shower of ion trajectories is directed towards the detector .",
    "the remaining part of the distribution is used to continue the trajectory of the  primary \" ion . in such a way",
    "all possible displacements of the atom are sampled .",
    "notice that the width of the shower @xmath7 is assumed to be significantly larger then the width of the detector @xmath12 .    in the accumulated statistics , events due to ions in the showers (  secondary \" ions ) must contribute with weights @xmath13 given by the probability for the atom to be displaced into the  hot \" region . to calculate them we notice first that a probability should be adscribed also to the primary ion itself ( @xmath14 before the @xmath6-th collision ) which decreases with depth as a result of emission of the secondary ions , ( trajectory  degradation \" ) .",
    "then the weights @xmath13 and @xmath15 after the collision are updated as @xmath16 where @xmath17 is the integral fraction of the probability of the  hot \" region .",
    "the sum of probabilities is conserved , @xmath18 , as necessary .",
    "it is worthwhile to note also that this approach provides absolute values of the scattering yield : the expectation value for a certain energy - angular range is equal to that obtained in a direct simulation with the same number of ions sent to the sample",
    ".    one can easily recognize the similarity of this approach with the strategy of  importance sampling \" used in the monte carlo numerical integration  @xcite where the values of the integration variable are sampled more densely in the regions that give the highest contribution to the integral .",
    "this similarity is not accidental because the scattering yield , as an average over the ion initial conditions and the thermal displacement of atoms , is , in fact , determined by an integral over a multidimensional space . due to the inherent complexity of this integral ,",
    "the importance - sampling strategy can be used only on an intuitive basis as described above .",
    "it is clear that this strategy should be effective at high energies where the single - scattering model describes well the process . at low energies",
    "the shower approach can also be efficient . in this case",
    "the showers emitted at large depths are significantly attenuated due to strong re - scattering on the way out of the crystal .",
    "this is a disadvantage but it is largely compensated by the fact that the primary ions themselves can leave with large probability the sample volume and the numerous accompanying showers from the top layers produce an intensive flux in the direction of the detector .",
    "it can be said that , in this case , the main part of the procedure is the direct simulation of ion trajectories and the showers are used only as an improvement at the last stage .",
    "these arguments show that the most serious difficulties in the application of the shower approach can be met in the simulation for intermediate ion energies where the rare plural - scattering events result in violent fluctuations ( see examples in the next section ) .    as shown at the right - hand side of fig .",
    "[ fig1 ] , a similar procedure can be used for the simulation of the yield of recoiled atoms . when an ion crosses a lattice site occupied by an atom of the considered species , a shower of recoils is emitted .",
    "the  hot \" region selects now the atom displacements which result in emission of recoiled atoms within the chosen cone .",
    "one additional recoil atom is sent by sampling the remaining part of the gaussian distribution of atomic positions .",
    "this recoil , in turn , is allowed to produce new recoils , as in the case of the primary ion , and also scattering showers .",
    "the trajectory of the impinging primary ion is followed further with the atom displacement drawn according to the total gaussian distribution . to describe the whole cascade we consider",
    "also recoils produced by the ions in showers ( not allowed to produce new showers ) .",
    "the result of these many possibilities is a strongly developed tree of the cascade .",
    "since all particles in the cascades have similar histories of collisions , the treatment using a recursive algorithm turns out to be very efficient .",
    "violent fluctuations in the accumulation of scattering events can have different causes .",
    "a first important point in this respect is that , when the showers are generated at every lattice site crossed by the primary ion , this ion itself can not scatter into the detector direction .",
    "this excludes the possibility of detection of events with weights @xmath14 which are ordinarily much larger than the weights of the secondary ions @xmath13 .",
    "thus , the displayed fluctuations are entirely due to the dispersion of the values of @xmath13 .",
    "if the number of ions in one shower @xmath11 is fixed , the value of the weight @xmath13 for a certain scattering angle @xmath19 depends on the position of the  hot \" region with respect to the center of the gaussian distribution of thermal displacements . since the width of this distribution is rather small compared to interatomic distances , variations of several orders of magnitude in the values of @xmath13 are possible . to improve upon this situation",
    ", it is reasonable , instead of fixing @xmath11 , to fix the value of the weight of one event @xmath20 , treating accordingly the number of ions in a shower as variable , @xmath21 ( the fractional part is treated as the probability for sending one additional ion ) . when @xmath22 the resulting effect is expressed as an increase of the number of detected events with a smaller weight @xmath20 from intense showers ( distributed to some extent over angles and energies ) instead of one event with a large weight .",
    "an advantage in the inverse case , @xmath23 , is that the load on the computer due to the simulation of non - significant events is avoided .",
    "in addition , the discrete counts of such  quanta of probability \" closely mimics the aspect of experimental data . for orientation , a reasonable value of the quanta @xmath20 can be estimated defining @xmath11 in the input as the number of ions in the most intense shower ( @xmath24 ) .    in the case of crystalline structure of the sample one",
    "has a further possibility to increase the number of detected events .",
    "clearly , trajectories of ions entering into the crystal at different points of the surface can produce significantly different contributions to the useful statistics .",
    "thus , in the sampling of the initial coordinates it seems reasonable to choose points with higher efficiency more often . in the program tric",
    "this is organized as a self - learning procedure : the distribution of initial coordinates , taken initially as uniform over the unit cell of the crystal surface , is deformed in the course of the simulation according to the accumulated information on the efficiency . as necessary , the initial value of the weight @xmath25 is taken to be inversely proportional to the density of the simulated distribution . effectively , such modification corresponds to a larger number of impinging ions and this results in faster ( up to an order of magnitude ) accumulation of statistics .",
    "another source of fluctuations is the plural scattering . in order to develop a picture of how these fluctuations arise we should mention the following .",
    "an appropriate choice of the width of the shower @xmath7 is determined by the demand that the shower should be wide enough to encompass the whole profile of multiple scattering in the outgoing path .",
    "one may believe in this case that the transport inwards and the transport outwards the central region ( of width @xmath12 ) are properly balanced in the shower .",
    "however , at low energies and/or for heavy ions , this condition is difficult to fulfill because the shower should be taken very wide and , as a result , only a small fraction of the ions in the shower reaches our small - aperture detector .",
    "but , if the above condition is not fulfilled , the reduction of ion flux in the shower cone due to diffusion outward is to be compensated by the plurally scattered primary ions .",
    "as this takes place , the main contribution comes from primary ions scattered accidentally to directions close to the cone mantle . since the probability of further scattering into the cone is large for these ions ( small @xmath26 in ( [ ddtt ] ) )",
    "they produce rare but very intense showers of secondary ions with almost equal energies . as a result",
    "the accumulated energy spectrum is disturbed by splashes in some channels .",
    "we solve this problem in a similar way as described above : the plural scattering events are sampled more frequently than they happen in reality . for this goal a second cone is considered , coaxial with the first and significantly wider than it .",
    "wide showers are produced by the primary ion inside this cone in addition to the showers in the internal cone .",
    "then , ions of the outer cone are allowed to send showers into the internal cone , similarly to the primary ion . as a result",
    ", our goal is achieved because the weights of ions in the outer cone are small compared with the weight of the primary ion @xmath14 and the number of showers sent to the internal cone is now large to smooth sufficiently the accumulated energy spectrum . in principle , a whole hierarchy of such nested cones or even some smooth deformation of the density of sampling of atom displacements could be organized .",
    "it turns out , however , that in many cases the implementation of the above two - step approach solves practically all problems .",
    "this is illustrated in the next section ( fig .",
    "[ fig7]a ) .    to estimate the efficiency of the shower approach compared to the direct simulation we should consider first the values of the weights of the accumulated events @xmath20 . since the weight of an event in the direct simulation is unity",
    ", the number of impinging ions in the latter should be larger approximately by a factor @xmath27 to achieve the same level of fluctuations in the statistics .",
    "of course , this can not serve as an accurate estimate of relative efficiency , the calculation of the history of motion with shower emission is more extensive while , on the other hand , the calculated exiting flux is concentrated near the relevant region .",
    "nevertheless , the direct comparison of two approaches , where possible , shows that the mentioned factor reflects well the situation .",
    "the value of this factor depends on ion energy and is typically @xmath28 at kev energies while at hundreds of kev it is @xmath29 .",
    "therefore , the advantage of the shower approach in this respect is enormous .",
    "a typical time for simulation of one energy spectrum using an ordinary pc is several minutes , thus the proposed approach is capable to treat problems practically not solvable by the direct approach .",
    "note that both approaches are based on the same , rather general , model of ion - solid interaction .",
    "it is worthwhile to note also that the sending of showers aiming to the detector mainly results in misses .",
    "this unavoidable drawback , when one is interesting only in the yield of a small - aperture detector , turns out to be an advantage if one needs to simulate the 2d angular distribution of the scattered ions .",
    "such possibility is illustrated in the following section .",
    "in fact , we are capable to calculate with the present approach 3d - distributions including the energy scale .",
    "the implementation of this algorithm as a fortran program includes all important elements of the binary collision model  @xcite . a wide possibility to choose the type of the interaction potential is provided .",
    "the scattering integrals for binary collisions as functions of impact parameter and energy are tabulated at a preliminary stage of the calculation and used afterwards by interpolating with splines . additionally , the impact - parameter dependence of inelastic energy losses is considered . to account for the simultaneous interaction with two or more atoms we sum the deviations in ion motion due to the interaction with individual atoms . in principle , all this provides the possibility to perform simulations for energies in a wide range . at high energies the procedure of generation of showers could encounter difficulties due to restrictions in the accuracy of computer calculations .",
    "the reason is that the width of the  hot \" region in the transverse plane becomes so small that an accurate transformation of impact parameter to scattering angle may be practically impossible .",
    "for this reason , if this width becomes smaller than @xmath30 of the thermal vibration amplitude @xmath31 , the procedure of shower generation is inverted : the scattering angle is sampled within the shower cone and then , in reverse order , the impact parameter is calculated . as a result , our approach can claim to represent an improvement of the single - scattering model as it additionally accounts for the multiple scattering on the outgoing path .",
    "materials of any crystal structure , including compounds , with rectangular unit cells can be described in the input . on a lower level",
    ", however , the program works with a description in terms of the wigner - setz cell and , in principle , this provides the possibility to treat also wider classes of structures .",
    "an amorphous structure can be simulated by a random rotation of the crystal lattice after each collision .",
    "the surface of the sample is defined as an imaginary plane appropriately located with respect to the crystal lattice .",
    "if the detector position is defined to be at the back side of the sample , a simulation of transmission through a crystal slab of a given thickness is performed . as output data ,",
    "the depth profiles of close collisions , the energy spectra and the 2d angular distributions of scattered ions or recoiled atoms of a certain species are calculated .",
    "finally , the procedure is automated to calculate angular scans with step - wise rotation of the target , the detector or the beam direction around a certain axis .",
    "the fortran code of the program tric is supplied with a graphical user interface allowing to comfortably supply the input data , to run the calculations and to inspect the simulation results .",
    "in this section we present examples of applications of our program based on the shower approach to simulations under different experimental conditions .",
    "the first one concerns the scattering of 5  kev ar@xmath32 ions from the ( 100 ) surface of a fe@xmath33n crystal as studied experimentally in ref .",
    "the structure of this crystal can be considered as _ fcc _",
    "fe with an additional n atom located at the center of the unit cell .",
    "the topmost atomic layer at the surface contains nitrogen and , depending on the growth conditions , can exist in two types of surface reconstructions , c4 and 4pg .",
    "figure  [ fig2 ] shows simulated angular scans for the c4 surface differing from the bulk - terminated one only by an outward displacement ( 0.23   ) of the nitrogen atoms . in these scans , the crystal is rotated around the surface normal , which is coplanar with the beam and the detector directed respectively at 42@xmath34 and 12@xmath34 from the surface at opposite sides of the normal .",
    "the yield of scattered ar as well as of fe and n recoils were calculated . in fig .",
    "[ fig3 ] the energy spectrum of scattered ar is shown for the orientation indicated in fig .",
    "[ fig2 ] by an arrow . also shown is the angular distribution of scattered ions .",
    "the latter illustrates the blocking of scattering from the top - layer fe atoms by re - scattering from nearby atoms ; this largely explains the strong variation of the yield in the angular scan .",
    "these variations are strongest when either the beam or the detector are positioned close to the scattering  horizon \" which is formed by the reflection from the surface as a whole ( very small intensity at the bottom part of the angular distribution ) . in the case shown in fig .",
    "[ fig3 ] the detector is at the border of the shadow cone .",
    "the shape of the energy spectrum as an isolated peak is due to the blocking of the particles scattered from atoms of deep atomic layers by atoms of the top layer .",
    "this shape of the spectra favors the choice of the energy window for the performance of angular scans .",
    "the double - humped structure is explained by the effective competition of single- and double - scattering from fe atoms of the top layer  @xcite .",
    "comparison of simulated angular scans for the scattering of 5  kev ar@xmath32 ions from the surface of a fe@xmath33n(100 ) crystal with the experimental results from ref .",
    "[ ] ( top panel ) .",
    "the yield of recoiled fe and n atoms is shown in the center and lower panels , respectively .",
    "see text for more details.,width=321 ]    as seen in fig .",
    "[ fig2 ] , the experimental results are well reproduced in the simulation both for scattered ions and for recoils of the two atomic species .",
    "note that , in order to achieve this agreement , the screening radii in the used  universal \" potentials  @xcite were properly reduced , as commonly done for the description of scattering of heavy ions at low energies . with the same potential the data for the more complex reconstruction 4pg",
    "are also described with the same quality . in general , the present results demonstrate that the quality of the description of the experimental data is similar to that provided by the code match  @xcite ; in fact , the results of both simulation can hardly be distinguished when plotted together .     ( a ) comparison of our simulation results for 3  kev ne@xmath32 ions scattering from amorphous copper with experimental data  @xcite and results of simulation with the marlowe code .",
    "the simulation results were folded with a gaussian distribution in order to simulate the experimental energy resolution of 40  ev .",
    "the dashed curve corresponds to a calculation in the single - scattering approximation .",
    "panel ( b ) shows simulations performed by applying additional approximations .",
    "the dashed curve corresponds to a simulation using the single scattering approximation with impact - parameter - dependent energy losses while the thin solid curve was calculated considering the energy losses as the result of a uniform stopping force . ]",
    "the second example , shown in fig .",
    "[ fig4]a , corresponds also to a leis experiment , now of 3  kev ne@xmath32 scattering from a polycrystalline cu sample . under these conditions",
    "an intriguing peak is observed  @xcite in the experimental spectrum at the energy corresponding to a single ne - cu collision .",
    "here the beam incidence was along the surface normal and the scattering angle was 129@xmath34 . for these strong - scattering conditions",
    "the code marlowe is capable to reproduce the general shape of the spectrum including the surface peak .",
    "our simulations shown in the same picture also reproduce the spectrum shape ; some differences with the marlowe simulation at low energies may be due to a difference in the used potentials of ion - atom interaction or in the treatment of inelastic energy losses . in general , the shape of the spectrum under these conditions differs considerably from the spectrum predicted by the single - scattering model ( also shown in the figure ) .",
    "the authors of ref .",
    "[ ] associated the appearance of this peak with the onset of plural and multiple scattering in the deeper layers .",
    "first , due to the the large variations of kinematic energy losses , the plural collisions in scattering from deeper layers yield a broad scattering spectrum ( in particular , this explains the presence of the high - energy tail ) while ( single ) scattering events from the top layers form the narrow peak . on the other hand , the latter",
    "is also favored by the relatively small inelastic energy losses : independently of the depth of scattering , all single - scattering events have similar energies at the exit . to demonstrate the decisive role of strong localization of energy losses at small impact parameters , we present in fig .",
    "[ fig4]b the results of a simulation where both nuclear and electronic energy losses are replaced by equivalent continuous stopping forces ( thin solid curve ) .",
    "as seen , with such description of energy losses , the spectrum changes drastically .",
    "first , the surface peak disappears since single scattering events from different depths have now different energies . and second",
    ", the variation of kinematic energy loss in plural scattering is now not effective and , as a result , the shape of the spectrum on both sides of the surface peak is also strongly modified . on the other hand , in the shower approach we can check also the role of plural and multiple scattering . for this purpose",
    ", the simulation was performed using a special procedure , in which in all collisions before and after the emission of the shower , the ion deflection was canceled ( the single - collision model with impact - parameter - dependent energy losses ) .",
    "these results are also shown in fig .",
    "[ fig4]b as a dashed curve and demonstrate that the multiple and plural scattering events themselves are of minor importance for the formation of the surface peak . in summary we can conclude that the surface peak reflects mainly the correlation between scattering and energy loss : at this low energies ions scattered in deeper layers have more chances to exit from the sample if they do not re - scatter strongly on atoms of the upper layers and , consequently , the energy losses in the passage through these layers are also small .",
    "it is worthwhile to note that the program tric passes here a serious test : the simulation with shower generation produces results identical to those obtained when running the program in the direct simulation mode .",
    "turning now to medium energy ion scattering ( meis ) , we show in fig .",
    "[ fig5 ] the angular distribution of 100  kev he@xmath32 ions scattered on a si(100 ) crystal .",
    "the geometry ( the @xmath35112@xmath36 axis is in the center of the position - sensitive detector ) and the two depth ranges chosen for collection of the scattering events are equivalent to the experimental conditions used by kobayashi  @xcite .",
    "the results of the simulations are also very similar to the experimental results : even at such relatively small depths the washing - out of the blocking pattern is well seen , first of all for the narrow channels .",
    "although this effect of re - channeling is well predictable , its detailed demonstration in the referred experiment is rather interesting and our simulations support these results .",
    "notice that , with @xmath37 ions being sent to the crystal in the simulation , the total yield over the detector amounts here to @xmath38 only ( remind that , in the direct simulation , this would be an expected number of counts ) . in this sense , the results of our simulation are unique , it is hardly possible to obtain them using other known methods .",
    "comparison of our simulations ( solid curves ) of angular scans for 100  kev @xmath39 scattering from a monolayer - thick ysi@xmath40 film on si(111 ) with the result of a vegas simulation ( dashed curves ) and experimental data  @xcite ( dots ) .",
    "the direction of the incident beam is parallel to ( a ) the @xmath35100@xmath36 and ( b ) @xmath35011@xmath36 directions of the si substrate while the detector lies in the plane @xmath41011@xmath42 .",
    "the structure of surface layers is shown at the top .",
    "the yield is normalized to the rutherford cross section .",
    "the dash - dotted curve in the lower graph shows results for a trial structure with y atoms located at the top layer . ]    in fig .",
    "[ fig6 ] we show meis angular scans for the yield of 100  kev protons scattered from y atoms of a ysi@xmath40 monolayer epitaxially grown on si(111 ) ( a side - view of the structure is shown in the picture ) .",
    "the results of the measurements and of the simulations with the program vegas are taken from ref .",
    "the dips in the scans are due to blocking of the scattering from y atoms by si atoms of the upper layers .",
    "all parameters in the two simulations are taken to be identical .",
    "the achievement of a perfect agreement by optimization of parameters of crystal structure and lattice dynamics is , in fact , the actual goal of the meis analysis  @xcite . here",
    ", we emphasize only that results of our simulation coincide well with the results of the vegas simulation . in principle , this is predictable for such thin layers ( see introduction ) . as an additional test of our simulation procedure we performed simulations also for the case when the top layer is terminated by y atoms instead of si atoms .",
    "as is seen from the figure , the scattering yield in this case simply reproduces the rutherford cross section .",
    "the most difficult problem for simulations is the description of conditions where plural scattering is strongly effective .",
    "besides low energies , this happens also in the medium and high - energy cases where heavy - ion beams and/or heavy - atom targets are considered . for the case of scattering from amorphous samples , biersack _ et al . _",
    "@xcite proposed the fast version of the code trim  @xcite where the consumption of computer power is reduced at the cost of additional approximations .",
    "figure  [ fig7]a shows their results  @xcite for scattering of 100  kev protons from a 1000   - thick gold foil , together with the results of simulations done with the shower approach .",
    "as seen , the two approaches produce in fact identical results , also for similar computation efforts .",
    "the only visible difference is at the low - energy tail where yield is entirely due to the plural scattering .",
    "therefore , these results can be regarded as a confirmation of the accuracy of the trim approach by comparison with an exact treatment of the model with a similar structure of the target .    in fig .",
    "[ fig7]b the simulation results are compared with results of an experiment  @xcite of 280  kev @xmath43-particles scattering from a 1130   - thick pt foil . in general , the agreement is satisfactory also here . in the two cases shown in fig .",
    "[ fig7 ] the shape of the spectra differs significantly from those predicted by the single - collision model : the yield is higher for the main part of the spectra , also the low - energy tail which is entirely due to the plural scattering can not be predicted at all by the single - collision model . to reproduce all the features above the fluctuation level ,",
    "the showers must be generated in wide cones . in the considered cases",
    "the double - cone approach ( see sect .",
    "ii ) was used with a half - width of 40@xmath34 for the internal cone and of 160@xmath34 for the outer cone . in this way , at least the double - scattering events are treated with special efforts .",
    "the effect of the usage of the two cones is illustrated in fig .",
    "[ fig7]a where , for comparison , the simulation results obtained in the single - cone approach are included .",
    "the level of fluctuations in this case suggests that much larger efforts are necessary to achieve the same level of precision of simulation as in the double - cone approach . to demonstrate the role of plural scattering in more detail , we show ( fig .",
    "[ fig7]b ) separately the contribution of showers emitted by ions moving in the outer cone .",
    "it is seen that these histories of collisions completely explain the nature of the low - energy tail and , in general , contain mainly the effect of plural scattering .",
    "on the other hand , the partial spectrum of ions in the showers produced directly by the primary ion is influenced by multiple scattering .",
    "it looks surprising at a first glance that , in contrast with the predicted increase of the yield compared to the single - scattering spectrum  @xcite , this partial spectrum shows the inverse ordering due to multiple scattering .",
    "this is , however , natural because in this partial spectrum we do not consider the compensation of the transport out of the internal cone by the transport coming from the external region .    as a last example we reproduce in our simulations the experiment  @xcite performed in the early times of channeling studies with the special aim to test the lindhard time - reversibility rule  @xcite . here",
    "a proton beam of high energy ( 1  mev ) is incident on a w crystal along the @xmath35100@xmath36 direction ( close to the surface normal ) and the protons scattered by 135@xmath34 into a random direction of the crystal lattice are detected . in the inverse situation",
    "the beam and detection directions were interchanged . the angular spread in the beam and the aperture of the detector were approximately equal , @xmath44 , and the yield was measured in an energy window corresponding to a layer of 1000   thickness at a depth of 3000   .",
    "the yield was measured as a function of the beam misorientation in the first case and as a function of the detection angle relative to the @xmath35100@xmath36 channel in the second .",
    "the simulated channeling and blocking wells are shown in fig .  [ fig8 ] .",
    "their widths are similar and coincide well with the experimental results . to achieve also the coincidence of the absolute values we had to normalize the yield to the path length of the incoming ions inside the considered layer ( by multiplying the yield by @xmath45 in the second case , where @xmath46 is the angle of beam incidence relative to the surface normal ) .",
    "the meaning of this procedure is explained in the next section . in general ,",
    "the time - reversibility is confirmed by the simulation similarly as in the referred experiment .",
    "in this section we discuss the advantages of the proposed approach in comparison with those used currently in simulations of swift ion - solid interaction .",
    "first , the shower approach is equivalent in accuracy with the direct simulation as performed by the code marlowe .",
    "the difference lies only in the much higher efficiency ( lower level of statistical fluctuations ) as illustrated in sect .",
    "ii and iii .",
    "this is in fact of primary importance since , in many situations , extensive analysis of experimental data becomes feasible .",
    "furthermore , for medium and higher ion energies a proper simulation of multiple and plural scattering is not possible at all by other methods . for medium - energy ion scattering from amorphous samples , the accelerated version of the code trim",
    "@xcite seems competitive but this is achieved at the cost of additional approximations .",
    "barrett s approach  @xcite , followed by later developments like the programs flux  @xcite and upic  @xcite , is based on the single - scattering model and has consequently its region of applicability restricted to the cases where multiple and plural scattering can be neglected . in principle",
    ", the calculation of the close - encounter probabilities in this approach bears some similarity with our procedure of shower generation . in this way ,",
    "the picture of collisions with small impact parameters is well reproduced .",
    "however , only one of the two segments of the trajectory is described realistically while the other is approximated by a straight line .",
    "the reversing procedure used in the programs vegas  @xcite and match  @xcite is closely related with the shower approach and it is rather instructive to compare both strategies in more detail .",
    "first , to fill some gaps in the published descriptions , we present here a general analysis of the basis of this approach in a systematic way .",
    "the problem is formulated in terms of the fluxes of incoming and outgoing ions properly convoluted at certain lattice sites .",
    "analogously as for the incoming flux , a certain distribution of initial conditions ( see below ) has to be assumed for the calculation of the time - reversed outgoing flux .",
    "therefore , the problem is formulated from the outset differently than in the direct simulation : the simulation is aimed to obtain the integral yield in some range of exit directions @xmath47 and of energies of scattered ions @xmath48 ( the detector acceptance ) . in order to treat the problem in the most general way",
    ", we will not assume in the following that @xmath47 or @xmath49 are small .",
    "further , as in any non - direct approach , special care must be taken in order to ensure that the statistics of thermal displacements of target atoms is treated correctly in order to guarantee that , in this respect , the approach is equivalent to the direct simulation .",
    "basically , since the ion velocity is much larger than the thermal velocities of the target atoms , each ion passing through the sample volume sees a frozen pattern of atom displacements .",
    "the configurations of displacements must be chosen randomly according to the model assumed for the description of thermal vibrations . in the reversing approach , as also in the shower approach , we use the following circumstance  @xcite : when averaging the scattering yield over different configurations of atom displacements one may replace the contribution of each configuration by the average over the displacements of one of the atoms , arbitrarily chosen .",
    "note that the probabilities of displacements of this atom can be dependent on the actual ( fixed ) positions of other atoms ; in fact , accounting for correlations in the thermal vibrations is needed in any realistic description .",
    "the possibility of averaging can be used to smooth the statistics of scattering events in the simulation : the smoothing is achieved by multiple sampling of the displacements of an atom met along the ion path . for every resulting trajectory the same procedure can be iterated at the next lattice site ( the atom positions chosen in the previous collisions must be considered as a modification of the initial configuration of the surrounding ) .",
    "note that the direct simulation is usually performed in the same manner ,",
    "the only special feature here is that only one sample is taken at each lattice site .",
    "multiple sampling of atom positions allows to obtain several scattering events for every impinging ion .",
    "the advantage of this is that a significant part of the calculations is common to all trajectories .",
    "a dramatic increase of efficiency in simulation using the shower approach is achieved due to a special way of sampling which enhances the probability to finally reach the detector .",
    "to apply the strategy of importance sampling we appeal , in fact , to the single - scattering model assuming that it can be used at least as a first approximation .",
    "the reversing approach is based on a different idea .",
    "the random sampling of atom displacements has , in fact , the only purpose to find those positions of the atom which result in useful scattering events .",
    "every such position defines simultaneously the corresponding outgoing trajectory which starts from the vicinity of the considered lattice site and ends up in the detector .",
    "therefore , the problem could be solved in the reversed order , starting with the identification of these trajectories .",
    "a set of such trajectories can be generated considering the time - reversed motion of ions starting from the detector . with this information the random sampling of atom displacements is not needed , the relevant positions of the atom are those which provide a connection of the trajectory of the ingoing ion with one of the outgoing trajectories .",
    "the trajectories are to be connected as a result of the scattering on this atom .",
    "to recognize clearly the relation between the shower and reversing approaches we can formally write the considered contribution to the scattering yield @xmath50 ( @xmath6 is the site number ) as @xmath51 where @xmath52 denotes the flux of ions in the beam before entering into the sample volume , @xmath53 the operator of scattering on the atom and operators @xmath54 and @xmath55 describe the transformations of the flux before and after the collision with the @xmath6-th atom , respectively . in the shower approach the resulting transformation of @xmath52 is projected on the detector acceptance profile @xmath56 ( @xmath52 and @xmath56 can be considered as elements of a real hilbert state ) .",
    "the reversing approach consists in this picture in the action of the two operators @xmath54 and @xmath53 followed by the projection on the state @xmath57 .    to specify the way this plan",
    "can be implemented , we need to represent the action of the operator @xmath53 explicitly . denoting by @xmath58 the phase variables of the incoming ion entering the lattice site volume ,",
    "we can write the probability that further motion will end up in the detector as @xmath59 the integration is performed over the phase variables of the ion after the collision @xmath60 , @xmath61 is the probability of scattering into one of the states within @xmath62 ; this probability is related to the probability that the atom is located at the appropriate position . finally , @xmath63 is the probability that , in the course of its further motion , the ion in a state within @xmath62 will leave the crystal with an energy and in a direction within the detector acceptance .",
    "the probability @xmath64 is explicitly determined in the case that both the scattering angle @xmath65 and the energy loss @xmath66 in the binary ion - atom collision are uniquely determined by the impact parameter @xmath67 . to derive the corresponding expression we describe the states @xmath58 and @xmath60 in a local coordinate system where the @xmath68 axis is aligned with the ion velocity before the collision . as a result ,",
    "@xmath69 where @xmath70 and @xmath71 are the coordinates in the scattering plane and in the perpendicular direction , respectively .",
    "the first @xmath72-function satisfies the condition that the two trajectories must intersect and the second takes into account the relation between the energies before and after the collision . in the case of potential scattering the state of ion motion after the collision ( given by the coordinate in the scattering plane @xmath73 and the velocity direction @xmath74 )",
    "is uniquely determined by the atom position @xmath75 .",
    "the jacobian of this relation appearing in ( [ cccc ] ) is expressed as    @xmath76    where @xmath77 is the impact parameter corresponding to the scattering angle @xmath19 and @xmath78 is the scattering cross section .",
    "finally , @xmath79 in ( [ cccc ] ) is the density of distribution of thermal displacements of the target atom .",
    "note that @xmath75 , the atom position which results in the considered collision , is a function of @xmath58 and @xmath60 .    to confirm the validity of eqs.([cccc ] ) and",
    "( [ jjjj ] ) , let us calculate the angular dependence of the probability of scattering on a single atom ( the variation due to the uncertainty of the atom position @xmath75 ) .",
    "first , we integrate both sides of eq.([cccc ] ) over @xmath80 and @xmath81 and this cancels the two @xmath72-functions .",
    "the coordinate @xmath73 is related to the coordinate @xmath82 of the point of crossing of the scattering asymptotes , in such a way that @xmath83 .",
    "in addition , we take into account that , for a given scattering angle , @xmath82 is directly related to the coordinate @xmath68 of the atom : @xmath84 . as a result",
    "we arrive at the familiar expression : @xmath85 which expresses nothing but the concept of differential cross section @xmath86 .",
    "the contribution of scattering from the considered atom to the yield at the detector is obtained as an integral of the probability ( [ aaaa ] ) multiplied by the flux @xmath87 of ions of the beam reaching this lattice site : @xmath88 further , the variables @xmath58 and @xmath60 are uniquely related to @xmath89 and @xmath90 respectively , the parameters of motion of the ion when it enters ( exits ) the sample volume .",
    "it is useful to refer directly to the latter parameters and , for this purpose , we replace the integrations over @xmath58 and @xmath60 in ( [ aaaa ] ) and ( [ iiii ] ) by integrations over @xmath89 and @xmath90 , respectively .",
    "then , the jacobians @xmath91 and @xmath92 must be added into the integrands .",
    "note only that the relation @xmath93 can not be defined for all @xmath89 ( some initial conditions @xmath89 result in trajectories which never pass through the vicinity of the considered lattice site ) .",
    "the same is possible for the pair of variables @xmath60 and @xmath90 . to account for this , we assume the value of the respective jacobian in such cases to be zero",
    "now , combining the above equations , we arrive at the expression : @xmath94 as a function of @xmath90 the probability @xmath95 is easily evaluated : @xmath96 if @xmath90 is within the region of acceptance of the detector , otherwise @xmath97 .",
    "one can interpret this as the operation of projection of the outgoing flux on the exit states , the set determined by the detector acceptance ; the  density of states \" is here uniform . in general , all aspects of eq.([yyyy ] ) are reproduced in the above equation . particularly , the operators @xmath54 and @xmath55 are represented as the transformations of variables @xmath98 and @xmath99 with the corresponding jacobians .",
    "( [ yyyy ] ) and ( [ ffff ] ) show that the two segments of the ion trajectory , before and after the collision with the considered atom , can be treated analogously .",
    "the flux @xmath57 can be represented as the result of the time - reversed evolution of the  beam \" with a uniform profile ( uniform distribution of angles and energies within the detector acceptance and , also , uniform distribution of initial coordinates at the sample surface ) .",
    "this shows a way in which the integral ( [ ffff ] ) can be evaluated using the monte - carlo approach .",
    "the relations of variables @xmath93 and @xmath100 can be reconstructed by the calculation of a number of trajectories of incoming ions with the corresponding distribution of initial conditions and a number of trajectories of outgoing ions calculated in time - reversed mode ( including negative energy losses ) .",
    "the densities of the two fluxes approaching the considered lattice site are represented by the factors @xmath101 and @xmath102 , respectively , in the integrand of ( [ ffff ] ) .",
    "the integration itself , however , presents here a serious problem .",
    "first , it is difficult in practice to reconstruct in numerical form the distribution of the fluxes in the 5-dimensional section of the phase space . and , second , the presence of @xmath72-functions in ( [ ffff ] ) results in the need of some special procedure .",
    "for this reason , the standard numerical integration is practicable only in a simplified version of this approach , as performed by the computer code vegas , where the energy is not resolved and the scattering angle is assumed to be fixed . in this case",
    "the procedure is reduced to the convolution of two two - dimensional fluxes at a closed surface containing the considered atom .",
    "if the fluxes are represented by sets of trajectories , the conditions expressed in ( [ ffff ] ) by the @xmath72-functions ( the  conditions of crossing  for a pair of ingoing and outgoing trajectories ) can not be satisfied exactly .",
    "therefore , to accumulate a representative statistics , one has to introduce in these conditions some tolerances , sacrificing thereby the accuracy of the simulation . in the numerical integration where the density in phase space is presented by histograms ,",
    "the sizes of the bins of the histograms play the role of the tolerances .",
    "another procedure for the integration is implemented in the program match .",
    "pairs of incoming and outgoing trajectories are matched to identify that crossing at the considered lattice site .",
    "the tolerances for coincidence of coordinate @xmath71 and for the energy relation , @xmath103 and @xmath104 , are specified beforehand and , in terms of eq.([ffff ] ) , the whole procedure can be formulated as follows .",
    "the tolerances are introduced as a replacement of the @xmath72-functions by normalized pulse functions @xmath105 the integration over @xmath90 in ( [ ffff ] ) is associated with the monte - carlo sum : @xmath106 where @xmath107 is the area of the unit cell of the crystal surface and @xmath108 is the number of calculated outgoing trajectories . to obtain the yield of scattering for @xmath109 ions in the beam , we replace the integral over @xmath89 ( together with the jacobian @xmath110 and the beam profile @xmath111 ) simply by a sum over all impinging ions",
    "the terms of the resulting double sum are determined by the rest of the integrand in ( [ ffff ] ) : @xmath112 hence , each crossing of trajectories contributes to the accumulated statistics with its own weight .",
    "the weight ( [ wwww ] ) differs from the weight actually applied in the program match , where it is simply taken as the product of the cross section and the atomic density .",
    "the dependence on the angle @xmath19 in ( [ wwww ] ) includes , however , an additional factor @xmath113 .",
    "the necessity of such factor is immediately recognized when one tries to calculate the yield of scattering from one atom ( [ ssss ] ) by the simulation .",
    "the factor @xmath113 in ( [ wwww ] ) is compensated in this case by the number of crossings of trajectories , which is proportional to @xmath114 ; the latter follows from a simple geometrical consideration .",
    "the first fractional factor in ( [ wwww ] ) plays the same role , the normalization on the number of crossings . as a result , the monte carlo sum",
    ", the sum of weights ( [ wwww ] ) , gives the absolute value of the scattering yield @xmath50 .",
    "interestingly , the first fractional factor in the weight ( [ wwww ] ) is reminiscent of the quantum definition of the number of states , the volume of phase space divided by the planck s constant . here ,",
    "analogously , the tolerances @xmath103 and @xmath104 represent the volume per state for states of ions _ exiting _ from the sample volume ; the phase space attains thereby a coarse - grained structure .    as stated above",
    ", the described procedure is equivalent to the simulation in the direct mode , the result represents the contribution of the chosen configuration of atoms displacements additionally averaged over displacements of the @xmath6-th atom . as stated above",
    ", such averaging does not bias the results of the simulation and it might be expected that the resulting smoothing of the accumulated statistics will improve significantly the efficiency of the simulation .",
    "however , one can meet serious problems in the practical implementation of this approach .",
    "the first problem is the choice of reasonable values for the tolerances @xmath103 and @xmath104 .",
    "in fact , the use of tolerances introduces some inaccuracy into the description of scattering and , consequently , the tolerances must be small to provide sufficient accuracy of the simulation results .",
    "on the other hand , small tolerances imply smaller probabilities of trajectory crossings and , therefore , the efficiency of the calculation is lowered .",
    "thus , the optimal values are the maximal values of @xmath103 and @xmath104 which still provide sufficient accuracy .",
    "the inaccuracies have the following origin .",
    "replacement of the @xmath72-functions in ( [ ffff ] ) by finite - width pulse functions is allowed only when the fluxes @xmath110 and @xmath115 are sufficiently smooth .",
    "in fact , we assume here that each calculated trajectory of ion motion can be associated with a family of close trajectories , the family limited by the tolerances , and they are treated simultaneously",
    ". the critical points in this assumption are the following .",
    "first , the simultaneous treatment of the family of trajectories assumes that they all reach the detector .",
    "this means that the tolerances should correlate with the detector acceptance , the  resolution \" in the connection of trajectories , so to say , must be finer than that of the detector . in this connection , one should also take into account that , after many collisions with atoms on the outgoing path , the ions of the family can exit from the sample in strongly different directions and , as a result , not all of them will be detected .",
    "it is clear that this difficulty increases when the ion energy is increased ( scattering from large depths ) .    applying this approach one must decide also at which lattice site",
    "the desired matching procedure will be performed .",
    "assuming , as in eq.([ffff ] ) , that the site is the same for all incoming ions , one has to choose the site in the top layer , the first one met along the ion path .",
    "otherwise , this atom should be considered as being at a fixed position and , therefore , direct scattering in the direction to the detector would be possible .",
    "however , in such implementation of the approach , the problem of strong statistical fluctuations is not entirely eliminated .",
    "the fluctuations manifest themselves as extremely large values of the weight ( [ wwww ] ) when two trajectories intersect at a small angle @xmath19 .",
    "such fluctuations rarely appear in the cases when a large - angle scattering ( with small cross section ) happens at some other lattice site . here , such scattering events ( happening at larger depths ) are present in the outgoing trajectories .",
    "in fact , this means that the large - angle scattering is treated here in a way equivalent as in the direct simulation and this is a clear disadvantage .",
    "the procedure can be modified in such a way that the connection of ingoing and outgoing trajectories is performed only at the points of large - angle scattering .",
    "the modification consists in the following .",
    "first , the interesting site will be chosen as specific for each ingoing ion .",
    "the whole trajectory of ion motion in the frozen lattice is inspected to find the site where the ion most closely approaches the equilibrium position of the atom .",
    "if the matching procedure is performed at this site , the range of impact parameters of possible collisions is restricted , it is limited by the amplitude of thermal vibrations of the atom . in the case of low - energy heavy ions ( strong interaction )",
    "this means an effective restriction of the possibility of small - angle scattering .",
    "however , even at low energies , this does not ensure an appropriate low level of fluctuations of the weights @xmath13 . at higher energies",
    "this becomes impossible at all , the allowed values of the impact parameter correspond to large variations of @xmath19 .",
    "it is readily recognized that this is the same problem as that solved by the shower approach .",
    "again , the main difficulties lie in the treatment of the plural scattering .",
    "to solve this problem we can use again the main idea of the shower approach , which is to emphasize the events of scattering in the direction to the detector .",
    "the only difference will be that the multiple sampling of atom displacements from the  hot \" region is replaced by a corresponding selection of crossings of trajectories .",
    "namely , the position of the atom necessary for the connection of ingoing and outgoing trajectories must be located within the  hot \" region .",
    "therefore , the reversing approach turns out to be nothing but a special version of the shower approach . in order to choose , for a given application , which of the two versions is more convenient",
    ", one should consider the following .",
    "first , the simulation with the reversing version can not be considered as an exact treatment inside the binary collision model since the finite tolerances for connection of trajectories represent an unavoidable source of inaccuracies .",
    "practically , the only way to control the inaccuracies is the repetition of the simulation using different values of @xmath103 and @xmath104 .",
    "obviously , this is a serious drawback of the approach .",
    "another drawback is that the whole procedure of the reversing approach is too cumbersome for an extensive usage and for developments of the model of interaction .",
    "the arguments above show that , with some simplifications , this approach can be applied to the simulation of scattering of low - energy heavy ions ( as it was used before ) but is hardly practicable at higher energies .",
    "it is even difficult to estimate , for example , what kind of efforts would be necessary to reproduce the data presented in fig .",
    "[ fig7 ] . for the program tric , this is also a difficult problem , the calculations with an ordinary pc take about 20 hours .",
    "one can conclude , however , that in general , this program is capable to address by simulations a wide class of problems of scattering and recoil emission .    to finish this section we make some remarks intended to clarify possible consequences of the reversibility rule for the interpretation of experimental results .",
    "it is seen in eq.([ffff ] ) that , under the assumption of a purely potential motion of the ions ( the jacobians @xmath116 ) , the yield of scattering from one lattice site is symmetric under interchange of the beam and detector directions provided that the flux in the beam is also uniform and the respective phase - space volumes are equal .",
    "the latter condition is less relevant because the difference can be simply accounted for by a factor in the yield .",
    "therefore , we can conclude that the yield of scattering from one atom for a given beam - detector configuration is determined if it is known for the inverse situation .",
    "however , in the measurements of the yield in a certain energy window , as ordinarily made , the effective number of contributing atoms can be different .",
    "this fact was taken into account in the transformation of the data shown in fig .",
    "the shower approach proposed in this paper solves effectively the main problem of simulation of ion scattering from solids within the binary collision model , which is elimination of the violent statistical fluctuations in the monte - carlo sum .",
    "this is achieved as a result of specific effective improvements of the direct simulation approach .",
    "the improvements consist in the use of the strategies of importance- and stratified sampling , special ingredients of the monte - carlo method . as a result ,",
    "the computer power required for simulation is reduced by several orders of magnitude .",
    "this is , in fact , a decisive advantage allowing to address simulation problems which can not be treated with other methods . as discussed in sect .",
    "iv , our method avoids also many shortcomings inherent to alternative approaches .",
    "it is argued in particular that , in fact for the first time , this method allows a reliable treatment of the rare events of plural scattering .",
    "such possibility is especially important because the plural scattering is also not amenable to theoretical treatment and the only proposed method of simulation , the modified version of the code trim , has significant restrictions .",
    "first of all , it is capable to treat only amorphous structures .",
    "we performed a detailed analysis of the basis of the reversing approach , as applied in the programs vegas and match .",
    "the latter program offers the only alternative for an exact treatment of the binary collision model , including multiple and plural scattering .",
    "it is argued in particular that the corresponding procedure for matching must use a similar scheme of importance sampling as used in the shower approach .",
    "the main difference lies in the method of sampling . basically , if the scattering from shallow depths is considered , the two methods are equivalent .",
    "the applicability of the reversing approach at larger depths needs , however , a special justification . also , right from the beginning , this approach uses an approximation ( the finite tolerances assumed for the connection of the two segments of the ion trajectory ) . note also that the procedure used in its practical application is much more cumbersome than that used in the shower approach .",
    "in fact , in simulations for medium and high energy ions this approach becomes impracticable at all .",
    "simulations with the code tric can be performed for large classes of crystal structures of the samples and provide a detailed picture of scattering or recoil yields in the form of energy and angular distributions .",
    "all these qualities are promising for a wide use of the developed computer code both in basic research and in the analysis of materials .",
    "in particular , this provides the possibility to efficiently compare measurements with simulations made for many trial structures allowing in this way a precise structural analysis .",
    "this paper shows several examples of the use of the program although , of course , it is not possible to cover all potential applications ( e.g. simulations of the sputtering or total reflection yields , well possible in this approach , are also interesting applications of the code tric ) .",
    "the illustration examples in sect .",
    "iii are chosen to demonstrate the capabilities to solve specific problems and to show the accuracy of this method in comparison with others .",
    "in particular , we show the capability to simulate the interaction of different ions of low and medium energies with solid matter including complex structures , to calculate the yield of scattered ions and recoils and to reproduce their energy spectra and angular distributions .",
    "in addition , we address the interpretation of the time reversibility rule and provide additional insight into the origin of the surface peak .",
    "khodyrev gratefully acknowledges the hospitality provided by the cmam during several research stays .",
    "authors thank a. guirao and j. alvarez from cmam for technical help with computer resources .",
    "this work was financed by projects mat2005 - 03011 and fis2008 - 01431 ; j.e .",
    "prieto and a. rivera also acknowledge support by the programs  ramn y cajal \" and  j. de la cierva \" of the spanish mec , respectively ."
  ],
  "abstract_text": [
    "<S> for basic studies of ion - solid interactions as well as for the retrieving of reliable structural information from ion scattering experiments , accurate simulations of swift ion - solid interactions are essential . </S>",
    "<S> this , however , faces a fundamental problem : due to the small cross sections for scattering , the probability of an incoming particle to reach the detector is always small . as a result , </S>",
    "<S> programs based on the  brute force \" approach where ion trajectories are calculated taking into account the large diversity of histories of collisions , require extremely long computation times to reach acceptable statistics . in this paper , a new simulation approach </S>",
    "<S> is proposed which combines an exact treatment of the interactions within the binary collision model with a high computational efficiency . </S>",
    "<S> the main idea is to use the strategy of importance sampling in the simulation of atomic thermal displacements : the positions resulting in scattering events close to the direction of the detector are sampled with increased probability . as a result , </S>",
    "<S> the detector is illuminated by intensive showers of scattered ions , even if multiple scattering is important in the way out of the sample volume . </S>",
    "<S> the developed computer code provides the possibility to address wide classes of simulation problems . </S>",
    "<S> it is able to treat complex crystal and amorphous structures , to use different models of ion - atom interaction ( potential , inelastic energy loss , multiple scattering on electrons ) . </S>",
    "<S> the program provides information such as depth profiles of close collision yield , energy spectra and 2d angular distributions of scattered and recoiled ions . to illustrate these features we present the results of simulations for several , widely different conditions and compare them with experimental results . </S>",
    "<S> it is argued that , in fact for the first time , this method provides a possibility to reliably treat the rare events of plural scattering , the most intricate problem for the theoretical description as well as for computer simulations of ion - solid interactions . </S>"
  ]
}