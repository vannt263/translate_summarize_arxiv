{
  "article_text": [
    "smoothed particle hydrodynamics ( sph ) has become a popular tool for studying astrophysical flows since its introduction in the mid-1970s by @xcite and @xcite . instead of solving the equations of hydrodynamics on a mesh",
    ", sph operates by associating fluid elements with particles that characterize the flow .",
    "local properties are estimated by `` smoothing '' the attributes of particles ( neighbors ) near a given point .",
    "typically , the particles carry a fixed mass ( unless converted to another form , such as collisionless stars ) , and the smoothing is done in a spherically symmetric manner using an interpolation function known as the smoothing kernel . because it is gridless , sph is naturally spatially adaptive if the scale of the smoothing , set by the smoothing length @xmath4 , varies as the particles move with the flow .",
    "if individual particle timesteps are employed , the scheme will also be temporally adaptive .",
    "sph has been used with success especially in investigations of the formation and evolution of galaxies and large scale structure , where spatial and temporal adaptivity are essential because of the large range in scales present .",
    "along with the successes has come an understanding of various limitations with sph .",
    "examples include : an artificial clumping instability for particular choices of the smoothing kernel @xcite ; a lack of energy or entropy conservation for various forms of the equations of motion when the smoothing lengths vary spatially @xcite ; and a poor handling of instabilities at shearing interfaces owing to artificial surface tension effects @xcite .",
    "many of the problems have already been overcome through a variety of improvements to the original formulation of sph , such as the introduction of generalized smoothing kernels @xcite , fully conservative equations of motion based on variational principles @xcite , and various methods to eliminate artificial surface tension effects @xcite",
    ".    however , some issues remain unresolved , which has led to numerous misconceptions within the community of users of sph .",
    "for example , because densities in sph are calculated using smoothed estimates , rather than by solving the mass continuity equation , the flow of the fluid on small scales is not described correctly , as emphasized by @xcite .",
    "one claimed advantage of sph over grid based methods is that the previous history of fluid elements can be determined straightforwardly because individual particles retain their identity over time . with mesh codes , this can be accomplished only by introducing tracer particles into the flow so that the evolution of the density field can be reconstructed @xcite .",
    "in fact , this `` advantage '' of sph owes to the fact that this method does not solve the equations of motion correctly on the smoothing scale .    here , we focus on another issue with sph that has received little attention in the literature , but for which confusion abounds : the numerical convergence of this technique .",
    "a commonly used approach for making sph spatially adaptive is to allow the smoothing length of each particle to decrease or increase depending on the local density of particles .",
    "one possible choice is to scale the smoothing lengths in proportion to the mean interparticle separation according to @xmath11 @xcite .",
    "a benefit to this scaling is that the number of particles used to compute smoothed estimates ( particles neighboring a given point ) , @xmath5 , is roughly constant , optimizing the efficiency of the method from one region to another .",
    "but , this choice is somewhat arbitrary and leads to difficulties that are not widely recognized .    in sph ,",
    "local quantities are estimated by smoothing continuous fluid variables with an interpolation kernel .",
    "the resulting convolutions are evaluated numerically by approximating the integrals with discrete sums .",
    "these sums are calculated over @xmath5 fluid elements ( particles ) near a given point . for the scaling",
    "noted above @xmath12 constant , and is typically limited to relatively small values @xmath13 to maximize spatial resolution .",
    "however , the approximation of the convolution integrals by discrete sums entails an error that depends directly on @xmath5 and not @xmath3 or @xmath4 .",
    "therefore , as the resolution is improved by increasing @xmath3 and reducing @xmath4 , numerical convergence is not possible because the error in the discrete estimates does not vanish if @xmath5 is held constant .",
    "systematic studies of the convergence properties of sph are lacking , but evidence that this source of error exists is present in the literature .",
    "for example , in his review of sph , @xcite performed a series of tests to empirically determine the convergence rate of sph .",
    "the behavior we suggest can be seen clearly in the gresho vortex problem , as in fig .",
    "6 of @xcite . here",
    ", various runs were performed at improving resolution by increasing the total number of particles , @xmath3 , and reducing the smoothing lengths , @xmath4 , but holding the number of neighbors , @xmath5 fixed .",
    "the solid curves in this figure compare the error in each case to a known analytic solution . for small particle numbers , increasing @xmath3 decreases the error , but eventually the error saturates and plateaus at value that depends in detail on the choice of artificial viscosity .",
    "however , if the runs with varying @xmath3 are compared to the highest resolution versions ( dashed curves ) , the error shows a monotonically decreasing trend with @xmath3 , for all choices of the artificial viscosity .",
    "this behavior can be explained only by the presence of a residual source of error that does not depend directly on @xmath3 and @xmath4 . in what follows ,",
    "we show that this error arises in the discrete sums used to approximate the local smoothing convolutions and that it depends directly only on the number of neighbors in these sums , @xmath5 .    for a random distribution of particles",
    ", this residual error essentially arises from shot noise in the discrete estimates and is expected to scale as @xmath14 .",
    "however , as emphasized by @xcite , sph particles are usually not randomly distributed but are instead arranged in a `` quasi - regular '' pattern because of local forces between them .",
    "an analysis of the error in this situation suggests that the noise should scale with @xmath5 as @xmath15 , where @xmath16 is the number of dimensions .",
    "( note that to this order of accuracy , the error estimate vanishes for @xmath17 , meaning that 1-dimensional tests can not be used to gauge the numerical convergence of sph for @xmath18 , contrary to common belief . )    using simple numerical tests , we verify that the expected @xmath19 behavior is a reasonable characterization of the discreteness error for multi - dimensional simulations with sph .",
    "therefore , the discreteness error , error@xmath20 , can be bounded by the estimates @xmath21 error@xmath20 @xmath22 . using this scaling , we suggest an optimal compromise between accuracy and efficiency by requiring that this error decline at the same rate as the error associated with the smoothing procedure itself , which directly involves only the smoothing lengths , @xmath4 . in detail",
    ", the outcome depends on the form of the smoothing kernel , but for typical choices we find that the number of neighbors in the smoothed estimates should increase with the total particle number as @xmath7 . in this case",
    ", the smoothing lengths would scale as @xmath23 , rather than with the average separation between particles as @xmath24 , in which case @xmath4 represents the geometric mean of the size of the system and the average interparticle separation .",
    "our empirical tests verify that numerical convergence can indeed be obtained with sph , if the neighbor number grows systematically with improved resolution . of course",
    ", this comes with the consequence of increased computational expense relative to holding @xmath5 fixed , and implies an unfavorable cpu scaling of @xmath25 compared to grid codes which are typically @xmath8 . this should not be surprising , since sph is a monte carlo - like algorithm and it is well - known in other contexts that , while being flexible and general , monte carlo methods typically have unfavorable convergence properties relative to other more specialized techniques .",
    "ultimately , applications with sph must therefore choose between accuracy and computational efficiency .",
    "what is clear , however , is that if sph is used with constant @xmath5 , numerical convergence is not possible .",
    "we emphasize that this issue with the convergence of sph is well - known in some disciplines ( e.g. @xcite ) .",
    "however , the specific problem we analyze here has been virtually ignored in discussions of the use of sph in applications to cosmology and galaxy formation .",
    "in sph , densities are estimated from the particles by smoothing .",
    "this involves convolving a continuous field quantity , @xmath26 , with a smoothing function @xmath27 through @xmath28 where @xmath29 and @xmath30 denote the true field and its smoothed version .",
    "the smoothing length @xmath4 represents a characteristic width of the kernel over which the desired quantity is spread .",
    "the smoothing kernel is normalized to unity and asymptotically approaches a dirac @xmath31-function when @xmath1 .",
    "this can be achieved with a sufficiently large number of particles to describe the continuous system as @xmath0 .",
    "assuming that the volume within the smoothing kernel is sufficiently sampled with these discrete points , we can further approximate the above integral by discrete summations .",
    "the  volume \" element @xmath32 is estimated from @xmath33 where @xmath34 and @xmath35 are the mass and density of particle @xmath36 and we have @xmath37    with this approximation , we immediately obtain the density estimate in its discrete form @xmath38 as used in sph according to : @xmath39 where the sum is over all the particles within the volume element centered at @xmath40 . a smoothing function with compact support",
    "is usually used to limit the  volume \" to finite extent in order to minimize computation time .",
    "equation now operates on a finite number @xmath5 of particles near a given point . in order to satisfy the consistency of this step , which is to approach the continuous limit with such finite summations ,",
    "the condition @xmath2 is required .    moreover , in applications with finite @xmath3 and @xmath5 , there is a lack of self - consistency based on the above approach .",
    "if we would represent a scalar field @xmath29 with a constant value , say @xmath41 , the following condition @xmath42 is generally not satisfied with the density field estimated from .",
    "this lack of self - consistency is most extreme where large density gradients are present , e.g. between two phases of flow @xcite or close to a boundary @xcite . in other words ,",
    "the volume estimate in sph from equation with a finite @xmath5 is not an accurate partitioning of space . in order to satisfy the condition of consistency and self - consistency ,",
    "the following conditions @xmath43 indeed should be met if no other fixes such as normalization are applied .",
    "next we discuss the consistency of the euler equations that sph actually solves .",
    "the original euler equations in lagrangian form describe the evolution of density , momentum , and internal energy according to : @xmath44    @xmath45    @xmath46    where @xmath47 , @xmath48 and @xmath49 represent the density , velocity , and internal energy per unit mass .",
    "the equation of state    @xmath50    is a closure equation for the above system , where @xmath51 is the adiabatic index of the gas . following the derivation in @xcite , the equations of motion",
    "can be discretized as @xmath52    @xmath53    @xmath54    where the factors @xmath55 and @xmath56 depend on derivatives of the density with respect to the smoothing lengths .",
    "in practice instead of @xmath49 , we can also use a variable @xmath57 from @xmath58 to solve the energy equation as in @xcite .",
    "these two approaches are equivalent in principle .",
    "@xcite have calculated the errors in the continuity and momentum equations with the above sph formulation assuming a finite @xmath5 ( ignoring the factors @xmath55 , which spoils the fully conservative nature of the equations ) as @xmath59    @xmath60    where @xmath61 , @xmath62 are matrices close to the identity matrix @xmath63 and @xmath64 is a non - vanishing error vector .",
    "@xmath61 , @xmath62 and @xmath64 are all determined by the particle distribution within smoothing length @xmath4 ( see @xcite for detailed definitions ) . as a result",
    ", these errors will remain at the same level while we increase @xmath3 if @xmath5 is fixed .",
    "however , a consistent scheme would require all the error terms in the above two equations go down as @xmath65 .",
    "similar conclusions can also be drawn for the energy equation .",
    "based on the above discussions of the density estimate and the discretized euler equations in sph , the condition @xmath66 , @xmath67 and @xmath68 has to be met in order to have a _ consistent and self - consistent _ scheme .",
    "moreover , reducing @xmath4 will lead to finer time steps according to the cfl condition .",
    "if the magnitude of the error from a fixed @xmath5 remains constant , the overall error will build up more rapidly in a high resolution run than a lower resolution one .",
    "the error in sph from the smoothing procedure ( independent of particle distribution ) can be approximated to lowest order by : @xmath69 for the usual b - splines @xcite and the wendland functions @xcite , this is a second order term where @xmath70 = 2 .",
    "higher order precision can be achieved by constructing different classes of smoothing kernels . however , not all are appropriate since smoothed estimates of positive definite quantities can take on negative values .",
    "the error from discretizing the integral convolutions in the smoothing procedure depends on whether or not particles are ordered in space . optimistically ,",
    "if the particles are quasi - ordered and not randomly distributed , it has been conjectured that the discretization error can be approximated by @xcite @xmath71 this estimate is based on the study of the complexity associated with the low discrepancy sequence in numerical integration by @xcite .",
    "this indicates that the actual number of particles within the volume of each sph particle should match the _ expected _ number of particles .",
    "clearly , this is highly dependent on the randomness in the actual distribution of sph particles .",
    "the pressure force between sph particles always tends to regulate the distribution of the sph neighbors into an isotropic distribution .",
    "however , this  restoring \" pressure force does not push the particles into an exact desired distribution since the number of neighbors is finite .",
    "hence , the velocity field exhibits noise on small scales .",
    "such velocity noise will further induce fluctuations in the density field .",
    "in realistic applications , especially with highly turbulent flows , it is questionable whether the pressure forces can effectively regulate sph particles into a quasi - ordered configuration .    on the other hand ,",
    "if the distribution of particles is _ truly _ random , the convergence of sph should follow ( slow ) monte - carlo behavior : @xmath72    we further parameterize the dependence of discretization error on the number of neighbors from these two extreme situations as @xmath73 where @xmath74 .    from the perspective of convergence",
    ", we require that as the total number of sph particles is made larger , we will be able to simulate finer scale structure .",
    "the smoothing error is already consistently reduced by making @xmath4 smaller . at the same time",
    ", we must also use more neighbors in the discrete sums to combat the discretization error , which will eventually dominate if no action is taken .",
    "we can write these conditions as @xmath75    if we parameterize the dependence of smoothing length @xmath4 on @xmath3 written by @xmath76 then the relation between @xmath5 and @xmath3 is just @xmath77    the requirements of convergence impose the follow conditions on the dependence of @xmath78 on @xmath3 : @xmath79 and @xmath80    for any case @xmath81 , there is a power - law dependence of @xmath5 on @xmath3 . in order to balance the smoothing and discretization errors ,",
    "i.e. @xmath82 , we have @xmath83 .",
    "the dependence of of @xmath4 and @xmath5 can be expressed as , @xmath84    for commonly used smoothing kernel forms , we have @xmath85 .",
    "recall for random distributions we have @xmath86 and for quasi - ordered distributions @xmath87 , so @xmath78 for these two extremes is @xmath88 and @xmath89 .",
    "the dependence of @xmath5 on @xmath3 is thus between @xmath90 $ ] .",
    "this suggests a simple intermediate choice is given by :    @xmath91    in detail , other choices would follow if higher - order smoothing kernels are used , which would require an even stronger scaling of @xmath5 with @xmath3 .",
    "this can be readily seen from the expression of @xmath5 in equation [ eq : ngbscaling ] , where the power - law index @xmath92 approaches 1 for sufficiently large @xmath70 if @xmath51 fixed .",
    "for example we have @xmath93 for the smoothing kernel functions constructed by @xcite , and then @xmath5 should vary between @xmath94 $ ] .",
    "this indicates that the regularity in the particle distribution , which poses a strong limit for numerical interpolation , has to be improved to be much better than a quasi - ordered configuration if higher order smoothing kernels are employed .",
    "we note that an earlier suggestion of increasing @xmath5 to reduce the error was proposed by @xcite from 1-d error analysis of sph .",
    "on the surface , their analysis on the arbitrary spaced particles is similar to our result of quasi - order distribution .",
    "the difference here is that the discretization error in sph in multi - dimensions is much worse than the _ truncation error _ inferred from the second euler - maclaurin formula in 1-d given by @xcite .",
    "a direct application with the scaling in equation [ eq : ngbscaling ] will not work with classical sph codes .",
    "if more than @xmath95 neighbors are used in the discrete estimates , the sph particles will quickly form close pairs , as demonstrated in @xcite and @xcite .",
    "such a configuration actually makes the discretization errors worse , which is opposite to our purpose .    for the kernel functions widely used in sph codes , the function @xmath96 tends to flatten when two particles are close together .",
    "consequently , the net repulsive force also diminishes between close pairs .",
    "when a large number of neighbors @xmath5 is used , particles will be less sensitive to small perturbations within the smoothing kernel .",
    "in reality , the density estimate error fluctuates around the true value as a function of @xmath5 as shown in @xcite .",
    "the whole system thus favors a distribution of particles with close pairs which minimizes the total energy .",
    "hence the entire system would not achieve the resolution one aims for .",
    "this clumping instability is the primary reason that the convergence study with variable @xmath5 is not possible in sph simulations @xcite with conventional smoothing kernels . with the cubic spline ,",
    "sometimes additional repulsive forces are added in the inner smoothing length in the equations of motion to fight against the pairing instability , as in @xcite .",
    "@xcite instead proposed a centrally peaked kernel to mitigate against clumping .",
    "@xcite have shown that wendland functions are free from the clumping instability for large @xmath5 when used to perform smoothing in sph .",
    "the desirable property of the wendland functions is that they are smooth and have non - negative fourier transforms in a region with compact support .",
    "similarly , @xcite has shown that the sinc family of kernels is able to avoid particle clumping . in what follows",
    ", we adopt the wendland @xmath97 function , defined on @xmath98 $ ] as    @xmath99    in the p - gadget-3 code ( an updated version of gadget-2 @xcite ) to study the convergence rate of sph .",
    "we also update the viscosity switch in p - gadget-3 using the method by @xcite to effectively reduce the artificial viscosity in shear flows while maintaining a good shock capturing capability .",
    "this effectively reduces the viscosity in the flows producing results closer to the _ inviscid _ case .",
    "this switch also greatly enhances the accuracy of sph in the subsonic regime especially where large shear is present .",
    "the time integration accuracy is also improved following the suggestions by @xcite and @xcite .    to verify the absence of the clumping instability with our new code , we plot the distribution of distances to the closest neighbor particle from a realistic situation . in figure",
    "[ fig : pair_instability ] , we compare the performance of the wendland @xmath97 with the original cubic spline for the gresho vortex test @xcite .",
    "the details of the set - up can be found in the following sections . in the upper panel of figure  [ fig : pair_instability ] , we show the distribution of the distance to the nearest neighbor for each sph particle in a subdomain of the simulation at @xmath100 with the cubic spline .",
    "this test involves strong shearing motions from a constant rotating velocity field . at @xmath100 ,",
    "the vortex has completed almost a full rotation .",
    "the distance to the nearest neighbor is further normalized to the mean interparticle separation in the initial conditions .    with @xmath101",
    ", the distribution of distances shows that most of the particles are still well - separated from one other .",
    "this situation quickly worsens as soon as we use @xmath102 , which is the critical number for the cubic spline reported by @xcite .",
    "a significant portion of the particles now have their closest neighbor within a factor of @xmath103 of the initial separation . for an even higher @xmath104 ,",
    "most of the particles have formed close pairs as indicated by the peak near @xmath105 . as a comparison",
    ", the lower panel of figure  [ fig : pair_instability ] shows that close particle pairs are not present with the wendland @xmath97 as we vary @xmath5 from 100 to 200 ( equivalent to @xmath10655 with cubic spline ; see @xcite ) to 500 .",
    "this test confirms the good performance of sph against the pairing instability with the wendland function and gives us confidence that we can use this code to perform further tests to study the convergence rate with varying @xmath5 .",
    "we use a randomly distributed particle set to test the density estimate in sph .",
    "@xmath107 particles are distributed randomly within a 3-d box with unit length .",
    "we use the density estimate routine in sph with varying @xmath5 from 40 to 3200 to derive the density field accordingly . in figure",
    "[ fig : random_data_set ] , we plot the histogram of the density estimated at the position of each particle for varying @xmath5 .",
    "the variance within the density field is largest for small @xmath5 values , which are shown in the red colors .",
    "as the number of neighbors increases , the distribution slowly approaches a gaussian like distribution peaked at @xmath108 .",
    "this behavior shows the trade - off between variance and bias in the sph density estimate .",
    "larger @xmath5 hence larger @xmath4 will increasingly smear out fluctuations on short scales .",
    "however this does not show the actual accuracy of the sph density estimate .",
    "in fact , the _ precise _ density field in this set - up is difficult to give but the behavior of the density field can be seen from a pure statistical argument . to be more specific",
    ", the number of particles falling within a fixed volume associated with each particle follows a _ poisson _ distribution .",
    "the expected number of such occurrences goes linearly with larger volume ( larger @xmath5 ) . as a result",
    ", the standard deviation of the density distribution follows a @xmath109 trend .",
    "so should the trend of the standard deviation of the density distribution given by sph if the density estimate is accurate .",
    "however , this is not strictly true as we show in the lower panel of figure  [ fig : random_data_set ] , where the black crosses are the measured standard deviation of the density distribution with varying @xmath5 .",
    "there is a significant spread that is much greater for small @xmath5 than the guiding line indicating @xmath109 .",
    "the deviation is already significant for @xmath110 , which is the recommended number by @xcite based on a shock tube test . in the upper panel of figure  [ fig : random_data_set ]",
    ", we can also see there is a long tail for small @xmath5 values .",
    "this suggests there is an overestimate of density where we suspect the self - contribution of each particle to the density estimates plays an exaggerated role .    in order to verity this ,",
    "we carry out density estimates with self - contribution excluded for the same configuration of particles .",
    "the standard deviation of the density distribution as a function of @xmath5 is shown in the red filled circles in the lower panel of figure  [ fig : random_data_set ] .",
    "this brings the relation much closer to the expected @xmath109 line where the deviation at small @xmath5 is greatly reduced due to the subtraction of the self - contribution term .    excluding the self - contribution is not the usual practice in modern sph codes .",
    "@xcite actually advocated to use equation [ eq : sphdensity ] with self - contribution excluded to give a better density calculation based on a similar comparison in 2-d .",
    "@xcite however argues that the distribution of sph particles is essentially different from a random distribution .",
    "if particles are distributed randomly , individual particles do not care about the locations of other particles . in sph , due to the repulsive pressure force , each sph particle is trying to establish a zone where other sph particles can not easily reside .",
    "however , as we see in figure  [ fig : pair_instability ] , sph forms close pairs so that the argument by @xcite is no longer valid . note that it is not uncommon to see a value above @xmath102 in the literature with the cubic spline .",
    "the sph density estimate will then give a biased result for irregularly distributed particles .",
    "this comparison actually favors the use of a large @xmath5 where the distribution is highly disordered .",
    "although the above experiment is based on a situation where the particle distribution is truly random , the realistic situation is between such a truly random distribution and a quasi - regular one .",
    "however , quasi - regular distributions are hard to achieve in multi - dimensional flows because of shear .",
    "c    c      a random distribution of particles , as discussed in the above section , is an extreme case for sph simulations .",
    "we relax these particles according to the procedure described in @xcite to allow them to evolve into a glass configuration . given an @xmath111 repulsive force , the particles settle in a equilibrium distribution which is quasi force - free and homogeneous in density .",
    "this mimics the other extreme case where sph particles are well regulated by pressure forces .",
    "nevertheless , the outcome of this relaxation is not perfect where tiny fluctuations in the density field are still present because of the discrete nature of the system .",
    "we now measure the sph density estimate on this glass configuration for different @xmath5 and estimate the standard deviation of the density for each @xmath5 .",
    "as the upper panel in figure  [ fig : glass_data_set ] shows , the density distribution is much narrower than that for a random set of points . for sufficiently high @xmath5 ,",
    "the distribution approaches a dirac-@xmath31 distribution .",
    "the convergence is also much faster than in figure  [ fig : random_data_set ] .",
    "in fact , we observe a @xmath112 trend for the glass configuration .",
    "for this set up , there is no need to exclude the self - contribution term , which is consistent with @xcite .",
    "this measured @xmath112 rate is quite interesting in itself .",
    "@xcite conjectured that the discretization error with sph behaves as @xmath113 .",
    "this means that the randomness in the distribution of sph particles is closer to a low discrepancy sequence rather than to a truly random one .",
    "our experiment shows this @xmath112 ( neglecting the @xmath114 ) rate is certainly appropriate for a glass configuration , which is carefully relaxed to an energy minimum state .",
    "however , this rate may not hold for a general applications .",
    "thus , these two examples support the dependence of the density estimate error on @xmath5 as in the previous analysis .",
    "namely , @xmath109 for truly random data points and @xmath112 for a distribution with good order .",
    "realistic applications will fall between these two extremes and could be more biased towards the @xmath109 case .",
    "c    c      we have noted that a constant scalar field is not exactly represented by the sph method . based on our discussion of the self - consistency of the sph density estimation , we can further measure the magnitude of this inconsistency and its dependence on the number of neighbors @xmath5 .",
    "define a parameter @xmath115 as @xmath116 which represents the sph estimate of a constant scalar field @xmath117 .",
    "this parameter @xmath115 should follow a peaked distribution around 1 with some errors .",
    "we compute this parameter with a simple extra routine after the density calculation in the code since this parameter requires the sph density field as input . in figure",
    "[ fig : volume_error ] , we plot the distributions of the calculated values of @xmath115 for randomly distributed particles with several different @xmath5 values .",
    "the distributions of @xmath115 are indeed rather broad around 1 .",
    "similarly as the errors in the density estimate , the standard deviation of the distribution is consistently larger for smaller @xmath5 values .",
    "some extreme values of q with small @xmath5 are even on the order of unity .",
    "the peaks of the distribution with small @xmath5 are actually slightly below 1 , which indicates some bias towards a density overestimate .",
    "this is consistent with the above discussion of the self - contribution to the density overestimate at small @xmath5 values .    for this random distribution of particles , increasing @xmath5 will lead to a more accurate volume estimate by reducing the inconsistency in the density estimate .",
    "for example , the spread of the distribution of @xmath115 for @xmath118 is greatly reduced compared to @xmath119 .",
    "as we repeat this experiment with even more neighbors , the distribution of @xmath115 approaches a dirac-@xmath31 function eventually with the error in the volume estimate reduced to zero . in this limit ,",
    "the self - consistency of sph is finally restored . however , as in the lower panel of figure  [ fig : volume_error ] , such an improvement depends slowly on the number of number @xmath5 at a rate @xmath120 .",
    "we also consider the cubic spline in this test , which is included in the lower panel of figure  [ fig : volume_error ] .",
    "the dependence of q on @xmath5 for a cubic spline follows the same @xmath109 trend .",
    "the cubic spline shows a slightly lower magnitude for the same @xmath5 compared with the wendland @xmath121 function .",
    "this is because the wendland @xmath121 is slightly more centrally peaked than the cubic spline . to have the same effective resolution length ,",
    "a higher number of @xmath5 is required for wendland @xmath121 ( see the table of such scaling in @xcite ) .",
    "the behavior of @xmath115 with respect of @xmath5 is consistent with the two smoothing functions .",
    "we then repeat this calculation with the particles in a glass configuration .",
    "the results of the wendland @xmath121 function and cubic splines are presented with the solid symbols in figure  [ fig : volume_error ] .",
    "as we see from the previous section , the relaxed particle distribution reduces the errors in the density estimate .",
    "the inconsistency in the volume estimate , as measured in @xmath115 , declines as a function of @xmath122 in this case .",
    "this is true for both the wendland @xmath121 function and cubic spline .    in practice ,",
    "when we use sph , the true distribution is unknown .",
    "so the error in the density estimate is difficult to quantify .",
    "we suggest a simple procedure to measure q in simulations to give us an estimate of the overall quality of the density estimate .",
    "based on the comparison between the @xmath115 value for randomly distributed particles and particles in a glass configuration , a typical number @xmath123 with cubic spline as often adopted in the literature leads to a volume estimate error between 1@xmath124 and 10@xmath124 from the true value .",
    "however , a glass configuration is a rather idealized and we suspect that sph particles will not maintain such good order in most applications .",
    "this error in the volume estimate , which is self - inconsistency in the sph density estimate , also has dynamical consequences as the volume estimate , @xmath125 is used for the derivation of the equations of motion .",
    "in addition to the error terms derived by @xcite , an error on the order of a percent level is already present from the density estimate step itself .",
    "the quality of the particle distribution is crucial to minimizing this error .",
    "however , once the particles deviate from a regular distribution , the errors in the equations of motion will pose another challenge for the particles to return back to an ordered configuration .",
    "one way to impose a small error in the volume estimate is to use a large @xmath5 .",
    "increasing @xmath5 can regulate this error with a dependence between @xmath109 and @xmath112 .",
    "in this section , we perform dynamical tests with sph for several problems to study the convergence rates in each situation .",
    "the evolution in multi - dimensional flows is more complex than in 1-d and , as noted in  1 , one - dimensional tests can not be used to judge convergence of sph in multi - dimensions .",
    "the test problems are chosen so analytic behaviors are known in advance ( @xcite ) .",
    "also the test problems consider both smooth flows and highly turbulent flows .",
    "these test problems are purely _ hydro _ as no further compilations from other factors such as gravity are present .",
    "we also do not consider problems with shocks for our tests as the presence of discontinues will reduce the code to being at best first order accurate .",
    "the first problem is the gresho vortex test @xcite .",
    "we quantify the @xmath126 velocity error with sph and its convergence rate as a function of the total number of sph particles .",
    "this test involves a differentially rotating vortex with uniform density in centrifugal balance with pressure and azimuth velocity specified according to @xmath127    and    @xmath128    the value of @xmath129 is taken to be @xmath130 following @xcite and @xcite , as in the original paper of @xcite .",
    "@xcite and @xcite also investigate the behavior by varying this constant background pressure @xmath131 .",
    "the velocity noise will decline for decreased @xmath131 such that the system is more stable .",
    "this test problem is suitable for examining the noise in the velocity field since the density field is uniform . the vortex should be time independent having the initial analytical structure .",
    "@xcite however found that this test poses a challenge to sph since the vortex quickly breaks up with gadget .",
    "@xcite , @xcite , and @xcite have tested their sph formulation with the same problem and found improvements with a better parameterization of artificial viscosity . the convergence rate reported by @xcite and",
    "@xcite is similar to the one given by @xcite , @xmath132 , while @xcite give a rate of @xmath133 .",
    "this discrepancy is due to a modified version of the equations of motion by @xcite .",
    "the set - up of this problem has three sharp transition points which is problematic for sph .",
    "this test is also very sensitive to the particle noise which will can induce a false triggering of artificial viscosity .",
    "we initialize the particles on an n@xmath134n@xmath13416 lattice .",
    "the number of particles vertically assures that we can extend @xmath5 to several thousand for each particle without overlap . the @xmath126 velocity error as a function of the number of effective 1-d resolution elements @xmath3",
    "is shown in figure  [ fig : gresho_convergence ] .",
    "the black squares are the simulations with @xmath135 and the blue filled circles are the ones with @xmath110 . for the red diamonds , we run the simulation with increasing @xmath5 as @xmath136 starting from @xmath135 at the lowest resolution @xmath137 .",
    "the convergence rates are as @xmath138 , @xmath132 and @xmath139 respectively .",
    "the former two are consistent with @xcite , @xcite and @xcite .",
    "also , a larger number of neighbors gives a slightly faster convergence rate in this test ( @xmath138 vs. @xmath132 ) .",
    "for @xmath135 and @xmath140 , the @xmath141 velocity error at the highest resolution at @xmath142 is actually _ above _ the convergence rate .",
    "this is what is expected based on the argument for consistency in the sph method .",
    "a fixed @xmath5 may work well for a range of different resolutions until the resolution is ultimately so high that the errors from the density estimate , from the discretized continuity equation and momentum equation , are not consistently reduced according to the corresponding resolution length @xmath4 .",
    "the result with varying @xmath5 , on the other hand , shows a much faster convergence rate as @xmath139 with the highest resolution at @xmath143 with @xmath144 .",
    "this validates the arguments presented earlier and shows the result given by sph does _ converge _ to the proper solution and the convergence rate is improved in this test problem as we increase @xmath5 when @xmath65 .",
    "such a convergence rate is actually close to the rate @xmath145 measured with moving mesh code arepo @xcite for the same problem .     .",
    "convergence rate of the velocity field in the gresho vortex test as a function of @xmath146 with sph .",
    "blue filled circles are the results with a fixed number of neighbors @xmath110 while the black filled squares are the ones with a smaller number of neighbors @xmath147 .",
    "the convergence rate shows a @xmath132 behavior for the former and @xmath138 for the latter .",
    "the red squares are with increased @xmath5 as a function of total number of sph particles @xmath3 .",
    "the convergence rate for this run scales almost as @xmath139 .",
    "such a convergence rate is close to @xmath133 for the grid - based code in @xcite . ]",
    "we have also included two series of the gresho vortex test with the cubic spline as in the green symbols in figure  [ fig : gresho_convergence ] .",
    "the performance with the cubic spline is disappointing in this test . with @xmath148 ,",
    "the @xmath126 error reaches to a minimum value at an intermediate resolution at @xmath149 . for @xmath150 , where the clumping instability is reducing the effective resolution ,",
    "the minimum @xmath126 error is achieved at @xmath151 . in terms of the absolute error",
    ", the highest resolution actually fails to give the best results .",
    "this behavior is also observed in the gresho vortex test and the kh instability test in @xcite .",
    "this is another vortex problem described by @xcite and employed by @xcite and @xcite .",
    "it also has a time - invariant analytic solution . unlike the previous test ,",
    "the density and velocity profiles are both smooth .",
    "this problem will test the convergence rate of the solver for smooth flows .",
    "we generate the initial conditions in a box of size @xmath152 ^ 2 $ ] with periodic boundary conditions .",
    "similar to the previous test , several additional identical layers are stacked along the @xmath153 direction to get a thin slab configuration .",
    "the velocity field is set up as    @xmath154    @xmath155    the distribution of the density field and the internal energy per unit mass are calculated according to the following temperature distribution    @xmath156    as @xmath157 and @xmath158 .",
    "consequently , the entropy @xmath159 is a constant within the domain . as in @xcite",
    ", we then measure the @xmath160 error in the density field at @xmath161 obtained with our code with respect to the analytical density field for different resolutions .",
    "the result if shown in figure  [ fig : yee_convergence ] where the blue filled circles are obtained with @xmath110 while the red diamonds are with varying @xmath5 .",
    "the dashed line is a @xmath162 trend with the dashed - dotted line taken from @xcite measured with the arepo code .",
    "the overall magnitude of the error with sph is also close to the one for the arepo simulation in @xcite .",
    "in fact , the result for @xmath110 with sph shows a second order convergence for the first four resolutions , but for the two highest resolution runs the @xmath160 density error starts to reach a plateau . beginning with @xmath140 at @xmath163 ,",
    "we re - simulate the two high resolution runs with @xmath164 . as a result , the overall error is reduced and is now consistent with the expected rate of @xmath162 .    the above result based on the isentropic vortex problem shows that sph _ can _ be a second - order accurate scheme as long as the other errors do not dominate over the  smoothing error \" introduced from the density estimate .",
    "again , the condition @xmath165 and @xmath166 needs to be satisfied .",
    "as for the fixed @xmath5 run , starting from @xmath167 the other errors rather than the  smoothing error \" become dominant and start to degrade the performance of sph .    in order to see the effects of the discretization error , we have repeated this experiment with smaller @xmath5 and also using the cubic spline .",
    "for the two series of @xmath168 and @xmath169 , as in green symbols in figure  [ fig : yee_convergence ] , the convergence rate systematically slows down from @xmath170 to @xmath171 from a second order convergence rate . the convergence rate with the cubic spine , where @xmath148 , is the slowest one .",
    "moreover , it shows signs of turning over at the highest resolution with the cubic spline .     .",
    "convergence rate of the isentropic vortex test as a function of @xmath146 with sph code .",
    "the error is computed from the @xmath160 norm of the density field at @xmath161 when the vortex has completed a full rotation .",
    "blue filled circles are the result for a fixed number of neighbors @xmath110 .",
    "the convergence rate exhibits a @xmath162 behavior except for the two high resolution runs .",
    "the red filled diamonds are the two high resolution runs for increasing @xmath5 and now the error is consistent with the expected @xmath162 trend . ]      in this section , we move to a more complex problem involving the chaotic feature of multi - dimensional flows with sph . in particular , we simulate subsonic turbulence in the gas ( which is weakly compressible ) . following @xcite and @xcite , we employ a periodic box with unit length filled with an isothermal gas @xmath87 with unit mean gas density and unit sound speed .",
    "the initial positions of the particles are set on a cubic lattice .",
    "the stirring force field is set up in fourier space and we only inject energy between k = 6.28 and k = 12.56 .",
    "the amplitude of these modes follows a -5/3 law as : @xmath172 , while the phases are calculated for an ornstein@xmath173uhlenbeck process @xmath174 such that a smoothly varying driving field with finite correlation time is obtained .",
    "the parameters in the ornstein@xmath173uhlenbeck process are identical to the ones adopted by @xcite and @xcite as well as @xcite .",
    "a helmholtz decomposition in k - space is applied before the fourier transformation to yield a pure solenoidal component in the driving force field . at every time step , before the hydro force calculation , this driving routine is called to compute the acceleration .",
    "the magnitude of the driving force is adjusted such that the @xmath175 velocity is at @xmath176 once the system reaches a quasi - equilibrium state . besides the routine to calculate the driving force , we have also included a function to measure the velocity power spectrum on the fly .",
    "the turbulent velocity power spectrum is calculated whenever a new snapshot is written .",
    "we use the ",
    "nearest neighbor sampling \" method for our estimate .",
    "finally the 1d power spectrum is obtained by averaging the velocity power with each component in fixed @xmath177 bins .",
    "we use the time - averaged velocity power spectra between @xmath178 and @xmath179 for the following comparison .",
    "we emphasize that our sph code is able to give improved performance in this test over the previous studies of @xcite and @xcite .",
    "a snapshot of the velocity field is shown in figure  [ fig : subsonic_high_res ] in a high resolution test with @xmath180 particles .",
    "our sph code is able to resolve finer structures compared to the other two studies noted .",
    "the velocity field is qualitatively closer to the one simulated with grid based codes .",
    "this is a result of the use of the artificial viscosity switch proposed by @xcite and the wendland @xmath121 smoothing kernel .",
    "four different resolutions , @xmath107 , @xmath181 , @xmath182 and @xmath183 , are used for a resolution study .",
    "we actually fix the smoothing length @xmath4 for all the simulations based on @xmath110 for the @xmath107 resolution run and subsequently scale @xmath5 for the other three cases .",
    "this is done to directly test the effect of varying @xmath5 on the hydrodynamics by controlling the same resolution length @xmath4 so that the smoothing error is fixed .",
    "the projected velocity maps of these four resolutions are shown in figure  [ fig : turbulence_resolution ] .",
    "the velocity fields are similar to one another between these four simulations .    in figure",
    "[ fig : turbulence_convergence ] , we compare the velocity power spectrum for these four resolutions .",
    "we multiply the power spectrum by @xmath184 so that the inertial range described by @xmath185 shows up as a horizontal line . the power spectrum shows good agreement with the @xmath186 law on large scales .",
    "the velocity power goes down significantly below that once the wave number @xmath187 is above 40 .",
    "however , there is significant power contained on the smallest scales .",
    "the spatial extent where neighbor particles are searched corresponds to @xmath188 , which is the range where the turn - over is observed .",
    "this turn - over can be seen as the result of dissipation of velocity noise on the resolution scale @xcite .    improvements with varying @xmath5 in this test problems can be seen .",
    "the effect of varying @xmath5 on the velocity power spectrum is visible on both large and small scales . with more neighbors , the velocity field on the kernel scale ( smoothing length @xmath4 )",
    "is better regulated as the power is reduced by an order of magnitude .",
    "this can be also seen in that the turn - over point for higher resolution increasingly shifts to a higher @xmath187 value . on large scales where the modes are well resolved",
    ", more neighbors also help to bring the power spectrum into better agreement with the @xmath186 law .",
    "this can be verified by comparing the red and purple lines for @xmath183 and @xmath107 in figure  [ fig : turbulence_convergence ] .",
    "the variance on the power spectrum between @xmath189 and @xmath190 is reduced for the latter case .",
    "the velocity power contained within @xmath190 and @xmath188 is also significantly higher in the @xmath183 run with @xmath191 than @xmath107 with @xmath110 .",
    "the result is that there is increasingly less power in the noisy motion on the kernel scale but more power in a coherent fashion .",
    "the conclusion is that @xmath5 does play an important role in this subsonic turbulence test as suggested by @xcite .",
    "this also agrees with the consistency requirement for sph in order to recover the continuous limit that the  discretization errors \" also need to be reduced with @xmath192 .",
    "figure  [ fig : volume_error_turbulence ] shows the value of @xmath115 , as defined above , in the turbulence tests at @xmath193 .",
    "we have also over - plotted the trend of q from the static distribution of random particles and the glass configuration in the previous section .",
    "this allows us to use @xmath115 , which describes the deviation from an exact partition of unity , to access the degree of disorder in realistic applications of sph .",
    "in fact , the distribution of @xmath115 for these six snapshots are between the two static cases .",
    "the trend of @xmath115 with respect to @xmath5 , however , is quite shallow among these dynamical cases , indicating a @xmath109 trend .",
    "sph is not able to re - order the particles to a distribution with the degree of order characterized by the glass configuration .",
    "the degree of disorder could be much higher in post - shock flows frequently encountered in astrophysical simulations than what we have found in these weakly compressible turbulence flows with sph since the density variation is much higher in the former .     .",
    "a high resolution subsonic turbulence test with @xmath180 particles showing the magnitude of the velocity field at @xmath194 for a thin slice in the box .",
    "a cross comparison between this figure and the ones in @xcite and @xcite at the same resolution shows that our sph code is able to resolve the finest structures among all three .",
    "the velocity field is qualitatively closer to the one simulated with a grid based code .",
    "this is a result of the use of the artificial viscosity switch proposed by @xcite and the wendland @xmath121 smoothing kernel .",
    "@xmath195 is used in this example . ]",
    "ll    ll     the velocity power spectrum in a driven subsonic turbulence test at different resolutions .",
    "the velocity power is multiplied by @xmath184 , where @xmath187 is the wave number , such that the inertial range will show up as a horizontal line .",
    "different total numbers of sph particles are used while the number of neighbors are set up such that the  smoothing length \" @xmath4 is the same for all the simulations . even with the same nominal ",
    "h - resolution \" , the @xmath183 run shows an improvement over the @xmath107 run , especially for the location of the point of turn - over from the minimum on small scales and the increased velocity power on large scales . ]     the distribution of @xmath196 for several snapshots at the same @xmath197 in the subsonic turbulence tests in order to access the degree of disorder in realistic sph applications .",
    "the trend of q from the static random particles and the glass configuration are also over - plotted here .",
    "the distribution of @xmath115 for these six snapshots is between the two static cases .",
    "the trend of @xmath115 with respect to @xmath5 , however , is quite shallow in these dynamical cases .",
    "these points roughly follow a @xmath109 trend .",
    "sph is not able to reorder the particles to a distribution with the degree of order characterized by a glass configuration . ]",
    "the main findings of our study are as follows :    * we argue that the requirements of consistency and self - consistency within the sph framework require that @xmath198 and @xmath199 need to be satisfied to obtain the true continuum behavior of a flow .",
    "we summarize the errors from the smoothing step and from the discretization step in the sph density estimate and propose a power - law scaling between the desired @xmath5 given the total number of sph particles @xmath3 in order to have a consistent and convergent scheme .",
    "the dependence @xmath200 $ ] is derived based on a balance between these two types of errors for commonly used smoothing kernels .",
    "* we verify the error dependence on @xmath5 for the discretization error with a quasi - ordered glass configuration and a truly random one .",
    "the range for the power - law index between @xmath5 and @xmath3 is obtained based on these two extreme conditions .",
    "the discretization error in the density estimate decreases roughly as @xmath201 for the glass configuration and as @xmath109 for the random distribution .",
    "* we propose a simple method to calculate a parameter @xmath115 , which measures the deviation from an exact partition of unity in sph .",
    "the error in the volume estimate in sph is further examined for a glass configuration and a random one . in agreement with the behavior of the density estimate error",
    ", this quantity also shows the same dependence on @xmath5 in these two situations . in realistic applications ,",
    "the error introduced with the density estimate step itself is on the order of several percent for the @xmath5 value used in most published work . *",
    "we use the wendland @xmath121 function as a new smoothing kernel to perform dynamical tests with a varying @xmath5 to avoid the clumping instability .",
    "we confirm that particle pairs do not form even with a large value of @xmath5 .",
    "the artificial viscosity by @xcite also greatly improves the performance of our sph code . as a consequence ,",
    "the results from our study are not influenced by the numerical artifacts from these two aspects as in some of the previous studies . * a fixed @xmath5 , which indicates an inconsistent scheme , gives a slow convergence rate as reported by previous studies in the two vortex problems .",
    "as shown in the figures , the convergence rate levels off and eventually turns over for sufficiently fine resolution . also the error obtained with the cubic spline is larger than for the wendland @xmath121 function .",
    "the cubic spline actually exaggerates the discretization error as the wendland @xmath121 function is much smoother . * for smooth flows , as seen in the isentropic vortex problem",
    ", varying @xmath5 according to the proposed power - law dependence can give second - order convergence .",
    "the same improvement is seen in the gresho vortex test , where several discontinuities are included .",
    "the convergence rate @xmath202 with varying @xmath5 is closer to the rate @xmath203 measured with the second - order accurate moving mesh arepo code for the same problem . * for highly turbulent flows",
    ", the velocity noise poses another challenge in addition to the errors in the density estimate for the sph particles to retain an ordered configuration .",
    "though our code is able to give a better result in the subsonic turbulence test compared with previous studies , the velocity noise on the kernel scale is always present .",
    "this velocity noise can be reduced by an order of magnitude with a larger @xmath5 , but the inertial range resolved with sph code only shows a slight improvement . *",
    "we measure the randomness of sph particles in the above subsonic turbulence tests using the calculation of @xmath115 .",
    "this further verifies our assumptions when deriving the dependence of @xmath5 on @xmath3 .",
    "the distribution of sph particles in this example is indeed between a truly random configuration and a quasi - ordered case .",
    "this approach can be used in general to quantify the randomness in sph in applications .",
    "unfortunately , sph is not able to rearrange the particles into a highly ordered configuration characterized by a low discrepancy sequence . *",
    "the usual practice of using a fixed @xmath5 indicates that the same level of noise will be present even if higher resolution is used .",
    "this error can be stated as a ",
    "zeroth order \" term which is _ independent of resolution_. moreover , the errors introduced can be roughly approximated by a gaussian distribution around the true value provided @xmath5 is large enough so that the self - contribution term is not significant even for highly random distributions .",
    "we emphasize that the inconsistency and the errors associated with particle disorder is not a specific feature to a particular sph code but is rather a generic problem .",
    "in fact , the set of equations in gadget are fully conservative since they are derived from the euler - lagrange equations ( see @xcite , @xcite and @xcite ) .",
    "to our knowledge , this approach has not been fully adopted by the community yet .",
    "the conservation of mass , linear momentum , angular momentum and total energy has been long recognized to be the unique advantage over other techniques . indeed , its conservative nature , its robustness and its simple form have made it a popular tool for astrophysical modeling and in other disciplines .",
    "however , the errors associated with the finite summation @xmath204 , usually termed as  noise \" in the sph literature , and its impact on the convergence of sph has not been well understood so far . as we discussed earlier , such an error naturally and inevitably emerges from the density estimate itself and also from the momentum equation when evolving the system .    obviously , one promising direction to improve the particle method is to use a more accurate volume estimate .",
    "it is possible to derive a numerical scheme which can reproduce a polynomial up to the @xmath205 order polynomial exactly following the procedure by @xcite . in practice",
    ", it is sufficient to eliminate the zero - th order error by renormalization such that the corrected scheme is second - order accurate by symmetry .",
    "recently , @xcite proposed a new class of gridless lagrangian methods which use finite - element godunov schemes .",
    "these gridless methods dramatically reduce the low - order errors and numerical viscosity in sph method and significantly improve accuracy and convergence .",
    "they show better performance in resolving fluid - mixing instabilities , shocks and subsonic turbulence , which is critical in a wide range of physical and astrophysical problems .",
    "we caution against equating numerical precision with physical accuracy of a simulation because both physics and numerics play roles in the modeling of a complex system .",
    "for example , we compared cosmological hydrodynamical simulations of a milky - way like galaxy using both the improved gadget code ( presented in this paper ) and the gridless gizmo code by @xcite with the same initial conditions , physics prescriptions and resolutions , and found that both simulations produced similar galaxy properties such as disk mass , size and kinematics , although gizmo resolves the spiral structures better .",
    "these results suggest that the robustness of astrophysical simulations depends not only on the numerical algorithms , but also on the physical processes , as highlighted also in a number of recent papers on galaxy simulations ( e.g. , @xcite ) .",
    "we thank volker springel , phil hopkins , mark vogelsberger , jim stone , andreas bauer and daniel price for valuable discussions on this work .",
    "we further thank paul torrey for his contributions to the experimental setups in the early stage and suggestions throughout the project .",
    "lh acknowledges support from nasa grant nnx12ac67 g and nsf grant ast-1312095 , yl acknowledges support from nsf grants ast-0965694 , ast-1009867 and ast-1412719 .",
    "we acknowledge the institute for cyberscience at the pennsylvania state university for providing computational resources and services that have contributed to the research results reported in this paper .",
    "the institute for gravitation and the cosmos is supported by the eberly college of science and the office of the senior vice president for research at the pennsylvania state university .      ,",
    "o. , moore , b. , stadel , j. , potter , d. , miniati , f. , read , j. , mayer , l. , gawryszczak , a. , kravtsov , a. , nordlund ,  . ,",
    "pearce , f. , quilis , v. , rudd , d. , springel , v. , stone , j. , tasker , e. , teyssier , r. , wadsley , j. , & walder , r. 2007 , , 380 , 963      , a.  c. , fryxell , b. , plewa , t. , rosner , r. , dursi , l.  j. , weirs , v.  g. , dupont , t. , robey , h.  f. , kane , j.  o. , remington , b.  a. , drake , r.  p. , dimonte , g. , zingale , m. , timmes , f.  x. , olson , k. , ricker , p. , macneice , p. , & tufo , h.  m. 2002 , , 143 , 201                                                                  , c. , wadepuhl , m. , parry , o.  h. , navarro , j.  f. , jenkins , a. , springel , v. , teyssier , r. , carlson , e. , couchman , h.  m.  p. , crain , r.  a. , dalla vecchia , c. , frenk , c.  s. , kobayashi , c. , monaco , p. , murante , g. , okamoto , t. , quinn , t. , schaye , j. , stinson , g.  s. , theuns , t. , wadsley , j. , white , s.  d.  m. , & woods , r. 2012 , , 423 , 1726    , j. , crain , r.  a. , bower , r.  g. , furlong , m. , schaller , m. , theuns , t. , dalla vecchia , c. , frenk , c.  s. , mccarthy , i.  g. , helly , j.  c. , jenkins , a. , rosas - guevara , y.  m. , white , s.  d.  m. , baes , m. , booth , c.  m. , camps , p. , navarro , j.  f. , qu , y. , rahmati , a. , sawala , t. , thomas , p.  a. , & trayford , j. 2014 , arxiv e - prints:1407.7040"
  ],
  "abstract_text": [
    "<S> we study the convergence properties of smoothed particle hydrodynamics ( sph ) using numerical tests and simple analytic considerations . </S>",
    "<S> our analysis shows that formal numerical convergence is possible in sph only in the joint limit @xmath0 , @xmath1 , and @xmath2 , where @xmath3 is the total number of particles , @xmath4 is the smoothing length , and @xmath5 is the number of neighbor particles within the smoothing volume used to compute smoothed estimates . </S>",
    "<S> previous work has generally assumed that the conditions @xmath0 and @xmath1 are sufficient to achieve convergence , while holding @xmath5 fixed . we demonstrate that if @xmath5 is held fixed as the resolution is increased , there will be a residual source of error that does not vanish as @xmath6 and @xmath1 . </S>",
    "<S> formal numerical convergence in sph is possible only if @xmath5 is increased systematically as the resolution is improved . using analytic arguments </S>",
    "<S> , we derive an optimal compromise scaling for @xmath5 by requiring that this source of error balance that present in the smoothing procedure . for typical choices of the smoothing kernel , we find @xmath7 . </S>",
    "<S> this means that if sph is to be used as a numerically convergent method , the required computational cost does not scale with particle number as @xmath8 , but rather as @xmath9 , where @xmath10 , with a weak dependence on the form of the smoothing kernel . </S>"
  ]
}