{
  "article_text": [
    "qso absorption line spectroscopy being a major activity at many observatories for the last two decades is now developing into a powerful tool for extragalactic research thanks to the new generation of large telescopes . the steady improvement in sensitivity and resolution of spectroscopic instrumentation opens new fields in the study of qso absorption systems .",
    "it is now becoming possible to investigate the intensity fluctuations within the line profiles and thus to estimate hydrodynamic characteristics of the absorbing gas .",
    "the majority of the narrow qso absorption lines represents intervening systems and allows us to probe the properties of diffuse matter at very high redshifts .",
    "resolved profiles of hydrogen lines and especially lines of heavier elements ( ` metals ' ) show a diversity of shapes and structures . up to now , their analysis is based on the assumption that the observed complexity is caused by individual ` clouds ' randomly distributed along the line of sight with slightly different radial velocities .",
    "it is also a basic assumption that the hydrodynamic ( ` bulk ' or ` turbulent ' ) velocity distribution inside each cloud is gaussian and completely uncorrelated ( _ microturbulence _ ) .",
    "this model implies that each subcomponent of the complex profile being resolved should have a symmetrical profile and its shape should not alter with higher spectral resolution .",
    "observations show , however , that the complexity of the line profiles increases with higher resolution , a tendency expected for correlated bulk motions which have , in general , non - gaussian distributions along a given line of sight ( levshakov & kegel 1997 ; levshakov , kegel & mazets 1997 ; levshakov , kegel & takahara 1999 ; papers  i , ii , and iii hereafter , respectively ) .",
    "it follows that the microturbulent approximation is not appropriate in this case because it does not account for all the relevant physical processes involved in the radiative transfer .",
    "moreover , being applied to real data , the microturbulent analysis leads to a loss of valuable information contained in the observations and may even yield unphysical results ( levshakov & kegel 1999 ; levshakov , takahara & agafonova 1999 ; lta hereafter ) .",
    "the need for more sophisticated procedures of data analysis becomes therefore obvious .    in recent years",
    ", it has been shown that accounting for the correlations in the velocity field ( _ mesoturbulence _ ) may change the interpretation of the line measurements substantially ( papers  i and ii ) .",
    "a mesoturbulent approach has been already successfully applied to the study of the deuterium and hydrogen absorption in q  19371009 ( levshakov , kegel & takahara 1998a ) , q  1718 + 4807 ( levshakov , kegel & takahara 1998b ) , and q  1009 + 2956 ( levshakov , tytler & burles 2000 ) .",
    "for all three qsos about the same value for the d / h ratio was derived in contrast to the previously announced microturbulent results .",
    "our first inversion codes ,  the reverse monte carlo ( paper  iii ) , and the entropy - regularized minimization ( lta ) ,  have been developed for a model of a stochastic velocity field neglecting any density fluctuations .",
    "they have been applied to the analysis of the hi and di lines and/or to the metal absorption lines with similar profiles when species trace the same volume elements independently on the density fluctuations . in the present paper",
    ", we extend this study to the inverse problem for a model of compressible turbulence when one observes non - similar profiles of different atoms and/or ions from the same absorption - line system . as in our previous papers ,",
    "we use the term ` turbulence ' in a wider sense as compared with hydrodynamic turbulence to label the unknown nature of the line broadening mechanism . in this",
    "regard we consider any kind of bulk motions ( infall , outflows , tidal flows etc . ) of more or less stochastic nature leading to fluctuating velocity and density ( temperature ) fields as continuous random functions of the space coordinate along a given line of sight within the intervening absorbing region .",
    "two noteworthy works have been recently carried out aiming at the recovery of the physical intergalactic structure from the lyman-@xmath0 forest lines .",
    "nusser & haehnelt ( 1999a , b ) developed an inverse procedure based on the relation between density and velocity fourier coefficients .",
    "the quality of their recovery is , however , restricted by the assumption that the lyman-@xmath0 forest structure traces mainly the matter density distribution and that the amplitude of the peculiar velocities is rather small to affect the local absorption coefficient significantly .",
    "this assumption is questionable since there is no simple way to distinguish _ observationally _ whether the density or the velocity fluctuations are the main source of the ` line - like ' structure observed in the lyman-@xmath0 forest ( levshakov & kegel 1998 ) . moreover , recent studies of nearby large - scale motions in the universe indicate that the hubble flow is considerably perturbed .",
    "peculiar velocities in the range from 300 to 500 km  s@xmath1 have been found in a sample of galaxies complete out to a distance of 60  mpc ( e.g. , watkins 1997 ; gramann 1998 ; giovanelli et al .",
    "1998 ) , a fact which should be taken into account in the inverse procedures .",
    "the method described in the present paper is quite flexible and equally accounts for the density and velocity fluctuations .",
    "it is based on a stochastic optimization approach similar to that developed in paper  iii .",
    "we estimate simultaneously the physical parameters _ and _ appropriate realizations of the density @xmath2 and velocity @xmath3 distributions along the line of sight to reproduce hydrogen and metal lines from a given absorption system . in this regard ,",
    "the more spectra of different elements are incorporated in the analysis the higher accuracy of the estimation can be obtained .    in @xmath4 our model and the underlying basic assumptions are specified .",
    "the inversion code is described in @xmath5 .",
    "the validity of the method is tested in @xmath6 using simulated sets of noisy line profiles ( hi , cii , siii , civ , siiv , and ovi ) .",
    "finally , the main conclusions are outlined in @xmath7 .",
    "in this section we consider the line formation in a lyman - limit system ( lls ) ,  the intervening absorbing gas being optically thin in the lyman continuum ( presumably outer regions of a foreground galaxy ) .",
    "to specify the calculations , we use the standard photoionization model of donahue & shull ( 1991 , hereafter ds ) , namely , an extended region of thickness @xmath8 with a given metallicity .",
    "the region is ionized by a background photoionizing spectrum given by mathews & ferland ( 1987 ) .",
    "the gas is assumed to be in thermal equilibrium .",
    "we concentrate our efforts on the llss because , on one hand , they can be analyzed with a minimum number of model assumptions and , on the other hand , they are the most promising targets for measuring the extragalactic deuterium to hydrogen ratio ( burles & tytler 1998a , b ) .",
    "in addition , one may expect that kinematic characteristics such as dispersions of the velocity and density fluctuations within llss are directly related to the processes of galaxy formation .",
    "if this is true , these characteristics should change with cosmic time ( i.e. with @xmath9 ) , and we can estimate them through the inversion procedure in question .",
    "the llss often show carbon and silicon line absorption from different ionization stages and even ovi lines ( e.g. , kirkman & tytler 1999 ) .",
    "the electron density in the llss is rather low , @xmath10  @xmath11 , and the kinetic temperature @xmath12 is about @xmath13  k. under these conditions photoionization dominates the ionization structure and the relative abundance of different ions of the same element is a function of the density only , once the radiation field has been specified .    with the assumed spectral distribution it is convenient to describe the thermal and the ionization state of the gas in the llss through the dimensionless ` ionization parameter ' @xmath14 , equal to the ratio of the number of photons with energies above one rydberg to the total hydrogen density .",
    "following ds , we assume that the ionizing background radiation is not time or space dependent . then for a given value of @xmath15 ( or the specific radiation flux @xmath16 at 1  ry ) ,",
    "the distribution of @xmath17 along the line of sight represents the reciprocal hydrogen density .    within the absorbing region",
    "the velocity distribution @xmath3 for all species is the same , but their fractional ionizations may vary significantly along the line of sight and therefore their apparent profiles may show a diversity of shapes .",
    "this allows us to tackle the inverse problem , i.e. to find such velocity , gas density and temperature distributions along the line of sight that provide the observed variety of the line profiles .",
    "we consider the formation of absorption lines in the light of a point - like source of continuum radiation , i.e. the absorbing region is assumed to be far from the quasar .",
    "the observed absorption spectra therefore correspond to only one line of sight , i.e. to one realization of the radial velocity and gas density distributions .    for a resolved and optically thin absorption line",
    ", one observes directly the apparent optical depth @xmath18 as function of wavelength @xmath19 @xmath20 where @xmath21 and @xmath22 are the intensities in the line and in the continuum , respectively .",
    "the recorded spectrum is a convolution of the true spectrum and the spectrograph point - spread function @xmath23 @xmath24 where @xmath25 is the true ( intrinsic ) optical depth .",
    "the intensity of the background continuum source @xmath22 changes usually very slowly over the width of the spectrograph function , and hence the normalized observed intensity is @xmath26    the instrumental point - spread function @xmath23 can be determined experimentally , whereas @xmath25 is the quantity of astrophysical interest .",
    "the true optical depth is defined through the local absorption coefficient @xmath27 by @xmath28 where @xmath29 is the normalized coordinate along the line of sight .    in this equation @xmath30",
    "is a stochastic variable which depends on the random realization of three fields  : velocity , density and temperature .",
    "we write @xmath31 as the product of the local absorption cross - section per atom , @xmath32 , and the local number density of absorbing atoms , @xmath33 @xmath34    at point @xmath35 , the absorption cross - section has the form @xmath36\\ : .",
    "\\label{eq : e6}\\ ] ]    the quantity @xmath37 is a constant for a particular line @xmath38 where @xmath39 and @xmath40 are the mass and charge of the electron , @xmath41 is the oscillator strength of the line for absorption , and @xmath42 is the rest wavelength of the line center .",
    "the profile function @xmath43 describes the local broadening at point @xmath35 .",
    "it is doppler shifted according to the local velocity @xmath44 .",
    "thus we have @xmath45 = \\phi_\\lambda\\{\\delta\\lambda_{\\rm d}(x),[\\lambda - \\lambda_0 - \\lambda_0\\frac{v(x)}{c}]\\}\\ : .",
    "\\label{eq : e8}\\ ] ]    under interstellar / intergalactic conditions the profile function @xmath43 is determined in general by the doppler effect and by radiation damping , i.e. it corresponds to a voigt profile .",
    "the doppler width of the line , @xmath46 , is determined in this case by the thermal width , @xmath47 , @xmath48 and hence @xmath47 characterizes the width of the local absorption coefficient at a given value of @xmath49 ( here @xmath50 is boltzmann s constant , @xmath51 is the mass of the ion under consideration , and @xmath52 is the local kinetic temperature ) .",
    "now , let @xmath53 be the local number density of element ` a ' , @xmath54 be the density of ions in the @xmath55th ionization stage , and @xmath56 be the relative abundance of this element which is regarded to be a constant along the line of sight . according to the standard model of ds , the fractional ionization of ions \\{@xmath57 } @xmath58 may be described by a function of @xmath17 only , @xmath59 $ ] .",
    "then for a fixed value of @xmath19 within the line profile , the optical depth is given according to equations ( [ eq : e4])([eq : e6 ] ) by @xmath60\\ , \\phi_\\lambda[\\delta\\lambda_{\\rm d}(x),v(x)]\\,{\\rm d}x , \\label{eq : e11}\\end{aligned}\\ ] ] or with @xmath61 @xmath62\\ , \\phi_\\lambda[\\delta\\lambda_{\\rm d}(x),v(x)]\\,{\\rm d}x .",
    "\\label{eq : e12}\\end{aligned}\\ ] ]    having defined @xmath63 , the ionization fractions @xmath64 can be calculated using a photoionization model corresponding to that of ds or ferland ( 1995 ) . in the present paper we used the results of ds since we may neglect the radiation transfer and high - density effects incorporated in ferland s cloudy code .",
    "when using the conventional voigt - profile fitting ( vpf ) procedure several subcomponents are usually assumed to describe an absorption line which is too complex to be fitted by a single voigt profile .",
    "each component is supposed to represent a homogeneous plane - parallel slab of gas with its own physical parameters  : radial velocity , the rms velocity , density , ionization and element abundances ( see e.g. tytler et al .",
    ". this fitting method would yield physically reasonable results for gas in spatially separate homogeneous clouds if we could know _ a priori _ the actual number of these clouds and have a justification for their homogeneity .",
    "as far as the number of subcomponents is unknown , the vpf method loses uniqueness and stability .",
    "the main question remains whether the complex line shape is caused by separate homogeneous clouds or by a continuous medium with fluctuating characteristics .",
    "there are no unambiguous observational data favoring one or the other assumption . but some indirect information such as the increasing complexity of the line profiles with increasing spectral resolution and recently performed 3d hydrodynamic calculations ( see e.g. rauch , haehnelt & steinmetz 1997 ) give higher weight to the model of a fluctuating continuous medium .",
    "applied to the inversion problem , this has important consequences .",
    "1 illustrates step - by - step the line formation process in a stochastic medium .",
    "the synthetic spectra of siiv@xmath65 ( panel * a * ) and siiii@xmath66 ( panel * b * ) are formed in an absorbing region with the fluctuating velocity and density fields shown in panels * c * and * d * , respectively .",
    "the corresponding distribution of the ionization parameter @xmath67 is shown in panel * e*.",
    "let us consider a point within the siiv and siiii profiles , for example at the radial velocity @xmath68  km  s@xmath1 ( panels * a * and * b * ) .",
    "then filled circles in panel * c * mark those volume elements having the same radial velocity .",
    "the corresponding points in panel * d * show the density in the corresponding areas contributing to the ` observed ' intensity .",
    "it is clearly seen that for a given point within the line profile the observed intensity results from a mixture of different ionization states ( labeled portions of the @xmath17-distribution in panel * e * ) .",
    "it is also obvious that each point of the line profile is caused by a different combination of these states .",
    "as an example , panel * f * shows the different fractional ionizations of siiii and siiv at the points with @xmath68 km  s@xmath1 .    in practical applications , the metal abundances , @xmath69 ,",
    "are usually estimated from the ratio of the total column densities @xmath70 and @xmath71 by means of the ` correction for the ionization '  : @xmath72    the mean value of @xmath73 is usually estimated from the ratio @xmath74 . while this procedure is suggestive , it is _ incorrect _ if the degree of ionization varies along the line of sight . from eq .",
    "( [ eq : e12 ] ) and accounting for @xmath75 , it follows that @xmath76\\,{\\rm d}x }   { \\int\\,n_{\\rm h}(x)\\,\\upsilon_{{\\rm a},j}[u(x)]\\,{\\rm d}x } = \\frac{\\bar{\\upsilon}_{{\\rm a},i}}{\\bar{\\upsilon}_{{\\rm a},j}}\\ : , \\label{eq : e25}\\ ] ] where @xmath77 and @xmath78 denote the mean density - weighted fractional ionizations .",
    "the ratio @xmath79 as a function of @xmath17 can be calculated from the adopted photoionization model .",
    "then the mean value of the ionization parameter , @xmath73 , is estimated using the implicitly assumed relation @xmath80    since @xmath64 is a non - linear function of @xmath81 , it is clear that the equality @xmath82 holds only in the case of a uniform density .",
    "applying relation ( [ eq : e25a ] ) to the case of a fluctuating gas density leads to a wrong value of @xmath73  and moreover the estimation of the mean ionization parameter will depend on the specific pair of ions chosen to calculate the left - hand side of ( [ eq : e25 ] ) .    to illustrate the numerical differences that may occur between the micro- and mesoturbulent approaches we consider the following example .",
    "the absorption lines shown in fig .",
    "1 have approximately the same total column densities [ the data are taken from ellison et al .",
    "1999 ( @xmath83  @xmath84 ) and molaro et al . 1999",
    "( @xmath85  @xmath84 ) ] .",
    "the ratio @xmath86 suggests that @xmath87 , i.e. @xmath88 .",
    "however , the mesoturbulent solution yields a 2.5 times higher value for the mean ionization parameter , i.e. @xmath89 ( for more details , see levshakov , agafonova & kegel 2000 ) .",
    "it is worthwhile to conclude this section with a few remarks concerning the vpf method . from a mathematical point of view",
    "the vpf is quite consistent since it simply means the representation of the unknown radial velocity distribution function by the sum of several voigt functions .",
    "in such a way we can very well reproduce the line profiles and , in the case of unsaturated lines , calculate accurately the total column densities .",
    "but if we wish to go further and estimate physical parameters like kinetic temperature , ionization and metallicity , the vpf may produce misleading results . if reality corresponds to a model like that shown in fig .",
    "1 , it is physically unjustified to interpret each subcomponent as belonging to one distinguished cloud since as shown in fig .",
    "1 the contribution to any point within the line profile does not come from a single separate area but from volume elements distributed over the whole absorbing region .",
    "the monte carlo inversion ( mci ) of line profiles includes the estimation of the physical parameters and simultaneously of three random functions @xmath63 , @xmath52 , and @xmath44 .",
    "for the equilibrium models of ds , the kinetic temperature is determined from the energy balance equation in the optically thin limit . in this case @xmath12",
    "depends on the gas density only , the dependence being described approximately by a power law , i.e. @xmath90 for an individual realization the remaining two random functions @xmath63 and @xmath44 are determined as follows .",
    "the hydrodynamic velocity and density fields are formed as a result of interference of many independent and random factors  infall and outflows , rotation , tidal flows , shock waves etc . in this case",
    ", we may consider the fluctuating amplitude of the velocity or the density along the line of sight as a kind of brownian motion which is mathematically described by the so - called markovian processes ( e.g. rytov et al .",
    "1989 ) . in particular , in case of gaussian fields the finite difference representation of the velocity as a markovian process has the form @xmath91 where @xmath92 , @xmath93 being the correlation between the velocity values at points separated by a distance @xmath94 , i.e. @xmath95 , @xmath96 the velocity dispersion of bulk motions , and @xmath97 a random normal variable with zero mean and dispersion @xmath98    the density and velocity are in general related through the continuity equation .",
    "however , since we consider one component of the velocity field only , the correlation between this component and the density is less tight and in lowest order approximation we may consider the two quantities to be statistically independent of each other .",
    "suppose further that the logarithmic density distribution is normal and that the dimensionless variable @xmath99 , with @xmath100 being the mean gas density has the second central moment @xmath101 characterizing the dispersion of the density field along the line of sight [ this definition implies that the expectation value @xmath102 for any @xmath35 ]",
    ". then consider , by analogy with @xmath44 , a random function @xmath104 with the following representation @xmath105 where @xmath106 , @xmath107 being the correlation between the values of @xmath108 at points separated by a distance @xmath94 , @xmath109 the logarithmic density dispersion , and @xmath97 a random normal variable with zero mean and dispersion @xmath110    having defined @xmath104 , the distribution of the hydrogen density can be obtained through johnson s transformation ( kendall & stuart 1963 )  : @xmath111 with the relationship between the dispersions @xmath109 and @xmath101 @xmath112    with ( [ eq : e18 ] ) , we can rewrite the expression ( [ eq : e12 ] ) for @xmath113 in the form @xmath114\\ , \\phi_\\lambda[\\delta\\lambda_{\\rm d}(x),v(x)]\\,{\\rm d}x .",
    "\\label{eq : e20}\\end{aligned}\\ ] ] where @xmath115 is the expectation value of the total hydrogen column density .    equation ( [ eq : e20 ] ) can be simplified if we have a fully resolved profile of an optically thin line . in this case",
    "the total ion column density along the given line of sight , @xmath116 , can be found directly from the observed profile ( paper  ii ) , and thus we can eliminate the unknown abundance from ( [ eq : e20 ] ) . integrating ( [ eq : e20 ] ) over @xmath19 yields @xmath117 where the mean density - weighted fractional ionization @xmath77 is @xmath118\\,{\\rm d}x\\ : .",
    "\\label{eq : e22}\\ ] ] inserting ( [ eq : e23 ] ) into ( [ eq : e20 ] ) leads to @xmath119\\ , \\phi_\\lambda[\\delta\\lambda_{\\rm d}(x),v(x)]\\,{\\rm d}x\\,.\\nonumber \\label{eq : e21}\\end{aligned}\\ ] ]    next , the obvious relationship @xmath120 shows that the mean ionization parameter @xmath121 is given by the expression @xmath122 ( use again the johnson transformation to evaluate the probability density distribution of @xmath17 ) . here",
    "@xmath123 is a multiplicative factor introduced by ds in oder to express @xmath15 in terms of @xmath16 .",
    "for the photoionizing spectrum of mathews & ferland , @xmath123 is @xmath124 ( in cgs units ) .",
    "the result ( [ eq : e27 ] ) has quite interesting consequences .",
    "namely , if the density is completely homogeneous @xmath125 then @xmath126 .",
    "but if the density field is perturbed @xmath127 , then with the same mean density @xmath100 and the same background radiation flux @xmath16 one obtains a higher value of @xmath121 without any additional sources of ionization . intermittent regions of low and high ionization caused by the density fluctuations may occur in this case along a given line of sight .",
    "now we can describe our model in detail .",
    "it is fully defined by specifying @xmath128 ( the expectation value of the total column density ) , the mean value of the ionization parameter @xmath121 , the rms values of the density and velocity fluctuations , @xmath101 and @xmath96 , respectively , the correlation coefficients @xmath129 and @xmath130 , and the abundances @xmath69 of the elements involved in the analysis .",
    "all these parameters are components of the parameter vector @xmath131 . additionally to these physical parameters , the density and velocity distributions are to be known .",
    "the continuous random functions @xmath44 and @xmath104 are represented in our computations by their values @xmath132 and @xmath133 sampled at the equally spaced spatial points @xmath134 .",
    "they are computed with the relations ( [ eq : e14 ] ) and ( [ eq : e16 ] ) which correlate the values at neighboring points ( @xmath135 ) . to estimate @xmath131 , @xmath136 and @xmath137 from the absorption line profiles",
    ", we have to minimize the objective function @xmath138 ^ 2/\\sigma^2_{\\ell , i}\\ : .",
    "\\label{eq : e28}\\ ] ] here @xmath139 is the observed normalized intensity of spectral line @xmath140 according to eq .",
    "( [ eq : e3 ] ) , and @xmath141 is the experimental error within the @xmath55th pixel of the line profile .",
    "@xmath142 is the simulated intensity of line @xmath140 at the same @xmath55th pixel having wavelength @xmath143 .",
    "the total number of spectral lines involved in the optimization procedure is labeled by @xmath144 , and the total number of data points @xmath145 , where @xmath146 is the number of data points for the @xmath140th line .",
    "the number of degrees of freedom is labeled by @xmath147 .",
    "let us go on to consider the correlation coefficients @xmath130 and @xmath148 .",
    "as known , the markovian processes have exponential correlation functions  : @xmath149 , where @xmath150 is referred to as the correlation length and depends , in general , on the spatial scale . for the step size @xmath151 ,",
    "the correlation coefficient @xmath152 is very close to unity .",
    "the computational procedure is quite insensitive to the concrete values of @xmath152 because of the stochastic relations ( [ eq : e14 ] ) and ( [ eq : e16 ] )",
    ". therefore the value of @xmath152 can not be estimated in the same manner as other physical parameters .",
    "it appears to be more suitable to fix a few sets of @xmath130 and @xmath148 and then to carry out the estimation of other parameters with each of these sets .",
    "hence , in reality the parameter vector @xmath131 does not include components @xmath130 and @xmath148 .",
    "the computational scheme is similar to that described in paper  iii , but in the present work we used instead of the classical metropolis method the more efficient generalized simulated annealing algorithm ( xiang et al .",
    "1997 ) .",
    "model calculations with different synthetic spectra have shown that the minimization of @xmath153 in form of eq .",
    "( [ eq : e28 ] ) does not allow us to recover the physical parameters with a sufficiently high accuracy ( see also lta ) .",
    "to stabilize the estimation of @xmath131 , we need to augment @xmath153 by a regularization term ( or a penalty function ) .",
    "the choice of the penalty function is rather heuristic and depends on the particular problem .",
    "for instance , when we try to fit model spectra to real noisy data it is reasonable to stop the minimization procedure at the value of @xmath154 in order to avoid fitting intensity fluctuations caused by the noise .",
    "another restriction stems from the restoring procedure for the density and velocity distributions .",
    "if we use instead of the processes ( [ eq : e14 ] ) and ( [ eq : e16 ] ) their normalized analogies  : @xmath155 and @xmath156 with the dispersions @xmath157 , more stable estimations for @xmath96 and @xmath109 are obtained .",
    "in addition , the process @xmath158 should be centered , i.e. @xmath159 ( the center of the velocity distribution is determined by the relative positions of spectral lines and in principle can differ from zero ) .",
    "accounting for all these remarks , the modified objective function is now written in the form @xmath160 where @xmath0 is a constant of order unity and @xmath161 , @xmath162 , @xmath163 are the quantities derived from the current configuration .",
    "it follows that in the vicinity of the global minimum we must have @xmath164 .",
    "if the optimization of @xmath165 gives @xmath166 , the estimated rms velocity @xmath167 is biased . to correct its value ,",
    "the following relation can be used @xmath168    the practical implementation of the proposed computational procedure for recovering the physical parameters from spectral lines of different ions is described in the following section .",
    "cccccc model & @xmath100 & @xmath16 & @xmath8 & @xmath96 & @xmath101 + & @xmath11 & ergs / s  @xmath169  hz & kpc & km / s + a & 0.001 & @xmath170 & 5.5 & 25 & 1.5 + b & 0.005 & @xmath171 & 1.5 & 20 & 0.8 +    we tested the numerical procedure described above by inverting synthetic spectra with known physical parameters and known underlying velocity - density distributions along the line of sight .",
    "we have considered two models a and b with the physical parameters listed in table  1 .    to calculate random fields",
    "several procedures can be utilized .",
    "the most simple one has been realized in model  a  : the velocity and gas density fields were produced by means of two independent markovian processes according to eqs .",
    "( [ eq : e14 ] ) and ( [ eq : e16 ] ) with @xmath172 , @xmath173 and @xmath174 . the fractional ionization for the different ions included in the analysis",
    "were then calculated using the model of ds .",
    "it is worth emphasizing that this model may not necessarily capture the physics most correctly since it assumes a specific type of the ionizing radiation , but since our purpose in this paper is to show the principal possibility of recovering the adopted physical characteristics of the absorbing region from the synthetic spectra , the ds model was chosen because of its transparency and easiness to compute .",
    "the synthetic spectra were then calculated according to eq .",
    "( [ eq : e12 ] ) with fixed metallicity for all ions @xmath175 ( solar abundances were taken from grevesse 1984 ) . to complete the procedure",
    "the spectra were convolved with a gaussian point - spread function having fwhm = 7 km  s@xmath1 and a gaussian noise with s / n = 50 was added to each pixel ( dots with error bars in fig .  2 ) .",
    "2 shows the hydrodynamic fields ( normalized velocity @xmath176 and gas density ) together with the kinetic temperature ( in units of @xmath13  k ) and the ionization parameter @xmath177 distributions along the line of sight ( panels * a *    * d * ) .",
    "the histograms in panels * e * and * f * give the density - weighted velocity distributions of the different ions which determine the shapes of the spectral lines presented in turn in panels * g *  ",
    "* l * for the hi  ly12 , cii , civ , siii , siiv , and ovi lines , respectively .",
    "the ly12 line was chosen for the analysis because it is unsaturated and , hence , allows us to estimate the neutral hydrogen column density quite accurately .",
    "the choice of metallic ions was motivated by the fact that their lines are formed in different parts of the adsorbing region  : cii , for example , needs denser gas and lower temperature to be produced ( the area in the vicinity of @xmath178 ) , whereas ovi mainly is found in the very diffuse and hot areas ( @xmath179 and 0.8 ) .",
    "such a diversity of lines in question enables us to restore the underlying density and radial velocity distributions in more detail .",
    "model b differs from model a not only by the values of physical parameters but by the method to generate random fields as well . to produce the stochastic velocity and density contrast ,",
    "@xmath180 , distributions , the corresponding power spectra were utilized .",
    "the computational scheme was similar to that proposed by bi , ge & fang ( 1995 ) but with another set of power spectra .",
    "we assume that the 1d power spectrum for the velocity is given and then we calculate the 1d power spectrum for @xmath181 .",
    "in particular , for the normalized radial velocity distribution , @xmath182 , the following 1d power spectrum was chosen [ it corresponds to the correlation function @xmath183@xmath184 adopted in lta ]  : @xmath185 where @xmath186 is the gamma function , @xmath150 and @xmath187 are fixed constants ( @xmath188 and @xmath150 is in units of @xmath8 ) .",
    "we can calculate the 1d power spectrum for the density contrast from its 3d spectrum which in turn is defined by the 3d power spectrum for the velocity  : @xmath189 .",
    "( this relation stems from the continuity equation when it is linearized in comoving coordinates ) .",
    "the 3d power spectrum @xmath190 is related to its 1d spectrum via ( see monin & yaglom 1975 )  : @xmath191 and thus @xmath192\\ : .",
    "\\label{eq : e32a}\\ ] ]    the 1d power spectrum for the density contrast is then determined directly from its 3d spectrum ( monin & yaglom )  : @xmath193    given the power spectra @xmath194 and @xmath195 , which are the fourier transforms of the covariance functions of @xmath196 and @xmath181 , both random fields @xmath182 and @xmath180 can be modeled using the moving - average method as described in lta . in order to avoid the appearance of negative @xmath33",
    ", the gas density itself is assumed to have a log - normal distribution ( see e.g. bi , brner & chu 1992 ; bi & davidsen 1997 ) . it is calculated from @xmath181 according to @xmath197 the density contrast , as calculated from ( [ eq : e34 ] ) , equals @xmath180 in linear approximation .    the correlation functions of the processes @xmath182 and @xmath180 with the foregoing power spectra and with the adopted parameters @xmath198 and @xmath199 are shown in fig .",
    "they differ significantly from the exponential form corresponding to the pure markovian process .",
    "so the objective to utilize these kind of stochastic fields was to test whether we can approximate a finite realization of an arbitrary non - markovian process by a markovian one .",
    "the corresponding hydrodynamic fields and line profiles for model  b are shown in fig .",
    "4 ( notations are the same as in fig .  2 ) .",
    "the recovering procedure aimed at the minimization of the objective function @xmath165 , eq .",
    "( [ eq : e29 ] ) , consists of two repeating steps  : firstly a random point in the physical parameter box is chosen and then the appropriate optimal velocity and density configurations are estimated .",
    "( in our actual calculations we used instead of the physical parameters @xmath128 and @xmath121 their reduced values @xmath200 and @xmath201 .",
    "this was made to achieve better stability of the results ) .    in both steps",
    "the stochastic acceptance rule was employed .",
    "the move in the parameter space or in the velocity - density configuration space is accepted if it leads to a lower current value of @xmath165 .",
    "if @xmath165 jumps up , then the move might be accepted according to an acceptance probability @xmath202 .",
    "two types of the acceptance probability were used in the procedure  : the standard boltzmann - type statistics as utilized in the metropolis algorithm @xmath203 and the tsallis statistics being the generalization of the boltzmann distribution ( e.g. xiang et al .",
    "1997 ) @xmath204^{1/(1 - q_{\\rm a})}\\ : , \\label{eq : e36}\\ ] ] where @xmath205 is a fixed constant and @xmath206 is the so - called annealing parameter ( ` artificial temperature ' ) .",
    "lccccccccrcc & @xmath207 & @xmath208 & @xmath96 & @xmath101 & @xmath209 & @xmath210 & @xmath211 & @xmath153 & @xmath212 & @xmath162 & @xmath163 + & & @xmath84 & km / s + & 4.426e-3&1.583e19&20.0&0.8&4.900e-5&3.550e-6&8.100e-5 + 1&4.392e-3&1.819e19&20.04&0.722&4.839e-5&3.488e-6&5.318e-5&1.057&-0.008&1.020&1.025 + 2&3.871e-3&1.744e19&22.95&0.729&4.835e-5&3.558e-6&8.409e-5&1.031&0.033&1.017&1.006 + 3&5.532e-3&1.580e19&24.57&1.215&4.853e-5&3.540e-6&4.516e-5&1.046&-0.028&1.009&0.937 + 4&3.878e-3&1.727e19&21.08&0.803&4.974e-5&3.602e-6&8.336e-5&1.095&4.0e-4&0.993&1.009 + 5&4.081e-3&1.837e19&21.97&0.695&4.936e-5&3.490e-6&7.794e-5&1.100&-0.013&1.005&0.986 + 6&3.104e-3&1.964e19&22.92&0.447&4.919e-5&3.456e-6&1.406e-4&1.095&-2.0e-4&1.012&0.966 + 7&5.683e-3&1.490e19&20.98&1.419&4.865e-5&3.628e-6&5.097e-5&1.103&-0.019&0.991&1.001 + 8&4.083e-3&1.780e19&19.56&1.206&4.988e-5&3.458e-6&7.769e-5&1.093&-0.068&0.983&1.096 + 9&4.520e-3&1.546e19&22.77&1.012&4.840e-5&3.701e-6&7.674e-5&1.151&-0.004&1.002&0.991 + 10&4.980e-3&1.630e19&26.05&0.998&4.913e-5&3.516e-6&7.615e-5&1.155&0.008&1.014&0.994 + 11&3.848e-3&1.821e19&20.28&0.679&4.961e-5&3.535e-6&8.471e-5&1.090&-0.013&1.000&1.017 + & 4.083e-3&1.727e19&21.97&0.803&4.913e-5&3.535e-6&7.674e-5 +    in general the acceptance after tsallis leads to quicker convergency , but it depends strongly on the value of @xmath205 and requires a few initial trial computations to adjust this parameter .",
    "the annealing parameter @xmath206 should decrease with the simulation time to ensure the convergence to the global minimum .",
    "we used the ` cooling ' rate of type @xmath213 , with the initial value @xmath214 and the power index @xmath215 having different values for both procedure steps ( i.e. the move in the parameter space and the move in the density - velocity configuration space ) .",
    "their values were adjusted in numerous numerical experiments with the aim to reach better stability and quicker convergency .",
    "the results presented below were obtained with @xmath216 , @xmath217 , @xmath218 , @xmath219 and @xmath220 ( here @xmath221 is the @xmath153 value for the initial step in the parameter space ) . the visiting distribution ( a local search distribution providing trial values ) was gaussian in all cases with the fixed dispersion of 0.1 ( in dimensionless units ) .",
    "the results of the computations are shown in fig .  2 ( model  a , markovian fields ) and in fig .",
    "4 ( model  b , non - markovian fields ) by solid lines ( panels * g *    * l * ) . for both cases",
    "the step size was @xmath222 and the correlation coefficients @xmath223 .",
    "these values were chosen as the optimal ones after several trial runs with different @xmath94 , @xmath130 and @xmath148 .",
    "the mci is a probabilistic procedure .",
    "it follows that one does not know in advance if the global minimum of the objective function is reached in a single run .",
    "several runs with different initial values should be performed to obtain the parameter estimations and their confidence levels . to illustrate the probabilistic character of the mci solutions , fig .",
    "5 shows the results of three different runs for model  a ( left - side panels ) and for model  b ( right - side panels ) .",
    "solid lines in all panels represent adopted fields , whereas dashed and two types dotted lines are the mci solutions .",
    "all recovered fields yield @xmath224 , implying that the absorption spectra calculated in different runs are indistinguishable from each other .",
    "the example shown by solid lines in fig .",
    "2 or 4 ( panels * g *    * l * ) is just one of the solutions obtained for the corresponding model  a or b. however , it is not possible to restore the exact pixel - to - pixel structure of the stochastic velocity and density patterns along the line of sight  many configurations are possible with equal probability .",
    "but we see that all these configurations have the same ( statistically indistinguishable ) density - weighted velocity distributions ( panels * d * and * h * ) , since as already mentioned above only these distributions determine the observed line shapes .",
    "it is obvious that the quality of recovering depends crucially on the diversity of ion profiles accounted for in the mci analysis  : the more ions originating from regions with different physical conditions are considered the higher reliability of the estimated parameters can be reached .",
    "table 2 lists the results of 11 runs for model  b ( model  a shows entirely analogous results ) .",
    "it is seen that the accuracy of the estimated parameters is rather high  : the median values do not differ from the adopted ones by more than 10% . as for the confidence levels , it is obvious that much more runs are needed to calculate them with a sufficient accuracy .",
    "we have not carried out such computations since in the present context the exact values of the confidence levels are not of importance . but from the runs",
    "performed we can make some qualitative conclusions .",
    "for instance , the metallicities are estimated with very high accuracy ( the error in @xmath225 is explained by the weakness of the oxygen line ) , i.e. the numerical procedure is quite sensitive to these parameters .",
    "the dispersions of @xmath96 and @xmath101 show significantly wider margins caused by the randomness of the fields which they characterize .",
    "the estimations of @xmath207 and @xmath208 have an accuracy of about 20% that can be considered as quite acceptable for these physical parameters .",
    "a higher accuracy can be obtained for the estimations of the total column densities of the individual ions and for the mean ( density - weighted ) kinetic temperatures @xmath226 these physical parameters are listed in table  3 in the same order as the results presented in table  2 .    to complete this section",
    ", we note that the computational time of one run with the adopted set of the spectral lines and with two 100 components vectors representing the velocity and density random configurations takes about 10 hours on a pentium  iii processor with 500 mhz .",
    "lcccccccccccc & hi&cii&civ&siii&siiv&ovi & hi&cii&civ&siii&siiv&ovi + & & + & 5.92e16&5.52e13&2.76e14&4.43e12&1.80e13&6.22e12&1.75&1.74&1.88&1.74&1.84&2.16 + 1&5.95e16&5.24e13&2.86e14&4.33e12&1.77e13&5.14e12&1.74&1.72&1.93&1.73&1.87&2.14 + 2&6.07e16&5.61e13&2.65e14&4.55e12&1.75e13&5.90e12&1.74&1.72&1.89&1.73&1.84&2.14 + 3&5.96e16&5.52e13&2.77e14&4.45e12&1.77e13&6.05e12&1.75&1.73&1.91&1.73&1.85&2.32 + 4&5.85e16&5.50e13&2.79e14&4.40e12&1.79e13&5.55e12&1.74&1.72&1.89&1.73&1.85&2.14 + 5&6.06e16&5.68e13&2.86e14&4.43e12&1.76e13&6.64e12&1.74&1.72&1.91&1.72&1.86&2.12 + 6&5.98e16&5.56e13&2.82e14&4.33e12&1.78e13&6.13e12&1.74&1.73&1.87&1.74&1.84&1.97 + 7&5.96e16&5.51e13&2.74e14&4.53e12&1.78e13&6.30e12&1.73&1.72&1.92&1.72&1.86&2.31 + 8&5.96e16&5.65e13&2.87e14&4.34e12&1.77e13&6.07e12&1.75&1.74&1.89&1.74&1.85&2.21 + 9&5.91e16&5.47e13&2.55e14&4.61e12&1.75e13&6.48e12&1.73&1.72&1.89&1.73&1.84&2.24 + 10&5.97e16&5.58e13&2.79e14&4.42e13&1.76e13&8.73e12&1.74&1.73&1.90&1.73&1.85&2.26 + 11&5.88e16&5.55e13&2.83e14&4.37e13&1.78e13&5.98e12&1.75&1.75&1.90&1.74&1.85&2.10 + & 5.96e16&5.55e13&2.79e14&4.42e13&1.77e13&6.07e12&1.74&1.72&1.90&1.73&1.85&2.14 +",
    "we have developed a new method to solve the inverse problem in the analysis of intergalactic ( interstellar ) hydrogen and metal lines arising from clumpy stochastic media . in the method ,",
    "the random velocity and density configurations along the line of sight are approximated by markovian processes . the global optimization method based upon simulated annealing",
    "is then used to fit theoretical line profiles to a set of ` observational ' data .",
    "the proposed procedure allows us to estimate the physical parameters of the absorbing gas such as column densities , metal abundances , mean ( density - weighted ) kinetic temperatures for each ion , and mean ionization parameter together with the hydrodynamic characteristics  the radial velocity dispersion and the dispersion of the density fluctuations .",
    "the computational scheme has been tested on a variety of synthetic spectra that emulate modern observational data  : the absorption lines of hi , cii , siii , civ , siiv , and ovi which are usually observed in the lyman limit systems ( @xmath227 @xmath84 ) .",
    "the ionization structure of the absorbing region was calculated using the standard photoionization model of donahue & shull ( 1991 ) with a background ionizing spectrum given by mathews & ferland ( 1987 ) .",
    "the inversion procedure proved to be very effective and robust allowing us to recover the physical parameters with reasonable accuracy albeit the structure of the random velocity and density fields can not be restored with a pixel - to - pixel conformity .",
    "however , the integral characteristics of these random fields , namely , the density - weighted velocity distribution , can be estimated quite precisely .",
    "thus we can conclude that our procedure provides reliable results and can be applied to the analysis of real data .",
    "note that while performing the inversion of absorption lines , one has to take into account the following .",
    "all our computational tests have been carried out under the assumption that the spectrum of the ionizing radiation is known , i.e. we used the same mathews & ferland spectrum to generate ` observational ' data and to fit them with our theoretical profiles . in reality , the characteristics of the ionizing radiation are not known exactly . therefore in real applications",
    "several types of the background photoionizing spectra should be tried . the problem how the computational results are affected by different types of the background ionizing radiation",
    "will be studied in detail elsewhere .",
    "the proposed method has been successfully applied to the analysis of qso high resolution spectral data with possible deuterium absorption at @xmath228 towards apm  08279 + 5255 ( levshakov , agafonova & kegel 2000 ) .",
    "it has been demonstrated that the blue - side asymmetry of the hydrogen ly@xmath0 line can be explained quite naturally by an asymmetric configuration of the velocity field only .",
    "the results obtained revealed a considerably lower neutral hydrogen column density as compared with the vpf measurements performed by molaro et al .",
    "in contrast to molaro et al .",
    ", we have managed to fit simultaneously all absorption lines observed in this system .",
    "these results can be considered as encouraging and favor the application of the developed computational procedure to the analysis of other high quality observational data .",
    "the authors are grateful to ellison et al . for providing the spectra of quasar apm  08279 + 5525 .",
    "sal and iia gratefully acknowledge the hospitality of the university of frankfurt / main and the european southern observatory ( garching ) where this work was performed .",
    "this work was supported by the deutsche forschungsgemeinschaft and by the rfbr grant no .",
    "00 - 02 - 16007 ."
  ],
  "abstract_text": [
    "<S> a new method , based on the simulated annealing algorithm and aimed at the inverse problem in the analysis of intergalactic ( interstellar ) complex spectra of hydrogen and metal lines , is presented . </S>",
    "<S> we consider the process of line formation in clumpy stochastic media accounting for fluctuating velocity and density fields ( mesoturbulence ) . </S>",
    "<S> this approach generalizes our previous reverse monte carlo and entropy - regularized minimization methods which were applied to velocity fluctuations only . </S>",
    "<S> the method allows one to estimate , from an observed system of spectral lines , both the physical parameters of the absorbing gas and appropriate structures of the velocity and density distributions along the line of sight . </S>",
    "<S> the validity of the computational procedure is demonstrated using a series of synthetic spectra that emulate the up - to - date best quality data . </S>",
    "<S> hi , cii , siii , civ , siiv , and ovi lines , exhibiting complex profiles , were fitted simultaneously . </S>",
    "<S> the adopted physical parameters have been recovered with a sufficiently high accuracy . </S>",
    "<S> the results obtained encourage the application of the proposed procedure to the analysis of real observational data .    </S>",
    "<S> = 0.2 cm </S>"
  ]
}