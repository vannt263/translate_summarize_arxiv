{
  "article_text": [
    "it is now widely accepted that the first order fermi acceleration , which is driven in various astrophysical shocks , provides a factory of non - thermal energetic particles .",
    "for example , recent observations discovered synchrotron x - rays from energetic electrons with energies above @xmath0ev in the shell of the supernova remnant 1006 @xcite . since the basic theory was proposed more than 20 years ago by 78 , krymski ( 1977 ) , axford et al .",
    "( 1977 ) , and blandford and ostriker ( 1978 ) , many papers have dealt with fundamental mechanisms of shock acceleration .",
    "the mechanism has been applied to many situations ranging from interplanetary shocks to relativistic shocks in active galactic nuclei or gamma - ray bursts ( see for review blandford & eichler 1987 and kirk & duffy 1999 ) .",
    "although most of the recent theoretical interests have been concentrated on non - linear problems where the shock structure is modified by accelerated particles ( ellison , baring & jones 1996 , berezhko & ellison 1999 ) , some of the linear problems in the test particle approximation still remain to be clarified and need more close examinations , especially for relativistic shocks , oblique shocks and injection of seed particles .",
    "the first order fermi acceleration in shock waves with test particle approximation is the most basic problem of the shock acceleration . as a particle gains energy whenever the particle repeats shock crossing and recrossing between the upstream and downstream of the shock front",
    ", it is essential to calculate the average energy gain per this cycle and the number distribution of the repeated cycles before the particles escape to far downstream .",
    "these are determined by the shock speed , the compression ratio of the shock , the pitch angle distribution of particles at the shock crossing and the return probability of particles , i.e. , the probability of recrossing the shock front for particles that cross the front from the upstream to the downstream .",
    "as is well known , the energy spectrum of particles accelerated by this mechanism takes a power law form , @xmath1 . for the non - relativistic shocks ,",
    "the conventional diffusion approximation can be used to obtain the universal power law spectrum with an index of @xmath2 , where @xmath3 is the compression ratio of the shock ( bell 1978a ) . however , for relativistic shocks , oblique shocks and acceleration of low energy particles ,",
    "in which the fluid speed is not negligible compared with the particle velocity , anisotropy of particle distribution at the shock front becomes large and the diffusion approximation is not relied on .",
    "thus , one should develop more sophisticated treatments beyond the diffusion approximation even in the linear regime .",
    "there are three ways to do this .",
    "one is to solve the transport equation with appropriate collision operators , as was developed by kirk & schneider ( 1987 , 1988 ) for relativistic shocks , and by malkov & vlk for the injection problem .",
    "they solved for eigenvalues and eigenfunctions of the transport equation both for upstream and downstream and by using the matching condition at the shock front they obtained the spectral index @xmath4 and the distribution function .",
    "this method works well when the pitch angle diffusion is a main process of the scattering , while it seems to have met some difficulties when the simpler case of pure large angle scattering is considered .",
    "another approach is the single - particle approach , which was originally used by 78 for non - relativistic shocks and was extended by 81 for relativistic shocks .",
    "although this method is in principle equivalent to the former method , it is more intuitive and more tractable as will be described in this paper . to determine the pitch angle distribution at the shock front ,",
    "78 and 81 basically utilized the distribution functions obtained by macroscopic methods such as the diffusion equation .",
    "81 also used an upstream distribution function , which is realized far upstream when particles suffer large angle scattering ; these functions may be different from real ones at the shock front as was shown in kirk & schneider ( 1987 , 1988 ) .",
    "the third one is the monte carlo simulation in which the motion of each particle is traced faithfully ( ellison , jones & reynolds 1990 ; ostrowski 1991 ; bednarz & ostrowski 1998 ) .",
    "while monte carlo simulation can make a direct estimation of the distribution function and the spectral index , a large scale simulation is needed to obtain sufficiently accurate results .",
    "physical interpretations of simulation results in terms of analytical models are desirable .",
    "the results of acceleration in such situations in fact depend on the nature of scattering mechanisms of particles by magnetic irregularity existing in the background plasma .",
    "this is because the anisotropy of particle distribution at the shock front is strongly subject to the detail of the scattering process .",
    "especially , two conventional scattering models , large angle scattering and pitch angle diffusion , lead to significantly different spectral index in relativistic or highly oblique shocks ( kirk & schneider 1988 ; ellison , jones & reynolds 1990 ; naito & takahara 1995 ; ellison , baring & jones 1996 ) .",
    "it also may be the case for acceleration of low energy particles .",
    "the pitch angle diffusion is derived by the quasi - linear theory of plasma turbulence ( e.g. , melrose 1980 ) but this description is adequate only for weak turbulence while it is often supposed that the turbulence can be strong in astrophysical shock environments ( see ellison , jones & reynolds 1990 and references therein ) . on the other hand , the large angle scattering , which isotropizes the particle direction in a single scattering independently of the direction before scattering ,",
    "may mimic some effect of strong turbulence , though there is no theoretical justification for this .",
    "theory of particle transport in strongly turbulent field required for realistic investigation of this problem is very difficult and not yet established , to our knowledge .    in this paper",
    ", we adopt the large angle scattering model regarding that it mimics the scattering under strongly turbulent field , and investigate the nature of the shock acceleration in highly anisotropic situation , basically taking the second approach mentioned above .",
    "the specific large angle scattering model used in the paper is prescribed in section2 , and assumes that the particle direction after scattering does not depend on the direction before scattering ( although this feature is not always true for general large angle scattering , we use the term ` large angle scattering ' for the specific model in this paper ) .",
    "this mathematical simplicity allows us to treat the problem of particle transport as a random walk .",
    "thus , our approach is based on the theory of random walk in a moving medium not on the diffusion theory to examine the pitch angle distribution at the shock front and the return probability of the particles from the downstream of the shock .",
    "therefore , it can be applied to any value of the shock velocity .",
    "the paper is organized as follows . in",
    ", we show that the motion of a particle suffering from the large angle scattering can be treated as a random walk in a moving medium , and formulate the random walk using the probability theory . in",
    ", we derive analytical approximate solutions , and devote to a specific case of isotropic scattering in .",
    "finally , we apply these results to the shock acceleration in .",
    "in this paper , we treat the first order fermi acceleration in parallel shocks for any value of the shock speed .",
    "we assume the test particle approximation and adopt large angle scattering as the scattering process of particles .    in order to know how particles are accelerated ,",
    "the properties of particle trajectories are to be investigated in detail .",
    "when particles move around on each side of the shock front , their motion can be regarded as one - dimensional because , in plane - parallel shocks , only the position along the field line is relevant .",
    "if the scattering process is assumed to be described by large angle scattering , the motion of particles on each side of the shock front can be treated as a random walk in a moving medium as is described in this section .",
    "thus , the problem will be reduced to the random walk of particles in a moving medium with an absorbing boundary ; the shock front becomes such a boundary both for upstream and for downstream .    in this section ,",
    "first , we formulate a random walk treatment of the motion of particles following the large angle scattering and examine the properties of the random walk in a moving medium .",
    "although the method described in this section may also be used for general problems of particle motion in a moving medium if this scattering model is suitable , we confine our attention to the fermi acceleration in shock waves in this paper .    in the following argument",
    ", we assume that the velocity of scattering centres is uniform on each side of the shock front and is be equal to the velocity of fluid ( therefore , we call the velocity of the scattering centres the fluid velocity in the following ) .",
    "it is also assumed that energy loss mechanisms of particles ( e.g. synchrotron loss ) is negligible , and that the scattering of particles is elastic in the fluid frame , i.e. , the particle energy does not change upon scattering .",
    "hereafter , we take the unit @xmath5 ( @xmath6 is the speed of light ) and take the spatial coordinate @xmath7 along the magnetic field line or the shock normal toward downstream direction so that the fluid velocity , @xmath8 , is positive on each side of the shock front .",
    "we use subscript ( + ) and ( - ) to denote the downstream direction ( @xmath9 ) and upstream direction ( @xmath10 ) , respectively .",
    "physical quantities measured in the fluid frame are expressed with a prime .",
    "we prescribe the large angle scattering model in the fluid frame by the following three conditions .    1 .",
    "the energy of particle measured in the fluid frame is conserved at scattering .",
    "thus , while particles stay in either the upstream or the downstream region , particle speed @xmath11 does not change in the fluid frame . 2 .",
    "the probability density of displacement of the particle along the magnetic field line between successive scatterings is assumed to obey an exponential distribution with mean free path @xmath12 .",
    "( here , the term ` the mean free path ' means the displacement along a magnetic field line and _ not _ a length on the orbit of its gyro motion . )",
    "then , the probability density of the displacement @xmath13 is written as @xmath14 where the signs of @xmath13 and @xmath15 must be the same .",
    "the pitch angle cosine of particle @xmath15 after scattering is determined according to the probability density function @xmath16 independently of the pitch angle before scattering .",
    "below , for simplicity , we represent this function as @xmath17 .",
    "clearly , it must satisfy @xmath18 .",
    "the functional form of @xmath19 and @xmath16 still is free and various scattering processes can be adopted .",
    "an often used case is that the mean free time is independent of @xmath15 and the scattering is isotropic , which we consider in .",
    "because the problems of particle transport with a boundary are to be considered in the following , it is better to describe the position of the particle in the reference frame in which the coordinate of the boundary position takes a fixed value , and scattering centres are flowing with fluid speed @xmath8 .",
    "we call this reference frame the boundary rest frame .",
    "( for the shock acceleration , this frame is of course the shock rest frame for each side of the shock front .",
    "but we consider general case here . ) therefore , below , we describe the speed @xmath11 and pitch angle cosine @xmath15 of particles in the fluid frame and describe the position of particle @xmath7 and the time @xmath20 in the boundary rest frame .",
    "( since we consider only steady states below , we need not consider about @xmath20 in the following in fact . )",
    "this treatment is widely used for various transport equations such as diffusion convection equation or radiation hydrodynamics ( kirk , schlickeiser & schneider 1988 ) .",
    "thus , we describe the scattering law in terms of the displacement measured in the boundary rest frame , @xmath21 , which is given through a lorentz transformation of @xmath13 as @xmath22 where @xmath23 is defined as @xmath24 and @xmath25 .",
    "here , @xmath23 represents the degree of advection effects to the particle motion in the boundary rest frame and is a fundamental parameter in the random walks in a moving medium described below . clearly ,",
    "if @xmath26 , a particle can not advance against the flow of scattering centres , which is not of interest for the shock acceleration .",
    "hence , we consider only the case of @xmath27 below .",
    "it can be shown easily that when a particle moves towards ( + ) direction @xmath28 in the boundary rest frame , the range of the pitch angle cosine in the fluid frame is @xmath29 , and for ( - ) direction @xmath30 , the range becomes @xmath31 .",
    "then , the probability distribution of @xmath21 becomes @xmath32 where @xmath33 here , @xmath34 denotes the mean free path of the particle measured in the boundary rest frame and can depend on @xmath15 even if @xmath11 is the same . for later argument",
    ", we define the following two scale lengths , @xmath35 where @xmath36 and @xmath37 denote the scale of scattering length in the boundary rest frame for ( + ) direction and for ( - ) direction , respectively .",
    "it should be noted that , even if both @xmath38 and @xmath17 depend on @xmath11 , when the dependences are separable into @xmath11 and @xmath15 , the properties of particle motion is determined only by @xmath23 except that the temporal and spatial scales can be different .",
    "as far as only the probability of return and the pitch angle distribution at the shock front are to be considered , these scales are not relevant at all .",
    "then , one can choose the scale of the time and space in order for the computation to become the simplest .      in the large angle scattering model described in the previous subsection , since the pitch angle of a particle after scattering",
    "is determined independently of that of before scattering and @xmath11 is conserved , the displacement of the particle between successive scatterings is determined independently and equally on each scattering . because of this property , the particle motion can be treated as a well - defined random walk . in this subsection",
    ", we formulate such a random walk treatment .",
    "our arguments as to the random walk in this subsection are based on the chapter 2 of cox & miller ( 1965 ) .      in the random",
    "walk considered here , the displacement of the particle @xmath21 takes a continuous value rather than a discrete value .",
    "for such a random walk , one of the fundamental concepts is the probability density function ( p.d.f . ) of the displacement for each step of random walk , @xmath39 . for the large angle scattering model , we can write this function in terms of @xmath40 and @xmath17 , which introduced in the previous subsection . using , we obtain @xmath41 in this description , the renewal of @xmath15 at the scattering and the translation to the following scattering point are treated as _ one step _ of the random walk .",
    "although this p.d.f .",
    "have no information about @xmath15 , if we combine the information of the random walk with the scattering law , the information about @xmath15 can be taken out as described later .",
    "corresponding to the p.d.f .",
    "@xmath39 , the moment generating function ( m.g.f . )",
    "is defined as @xmath42 which is the two - sided laplace transform of the p.d.f .",
    "@xmath39 . clearly , @xmath43 . in general , at some values of @xmath44 this integral diverges .",
    "for example , for the large angle scattering model , the value of @xmath45 and @xmath46 are such divergence points . however , in the following arguments , we need to consider only the value of @xmath44 in the range , @xmath47 and so we need not worry about such a divergence",
    ".    we can derive the following formulas about the derivatives of @xmath48 and the moments of @xmath39 from m.g.f .",
    "as @xmath49 @xmath50 in the range of @xmath44 mentioned above , @xmath51 always holds and then @xmath48 is a downward - convex function in this region .",
    "therefore , the value of @xmath52 at which @xmath53 always exists .",
    "this quantity @xmath54 , which is determined only by the functional form of @xmath39 , includes the most important characteristics of the random walk in a moving medium .",
    "in fact , this @xmath54 together with @xmath23 play an important role in the following description .",
    "clearly , the sign of @xmath54 is equal to the sign of @xmath23 and @xmath55 , i.e. , it is positive throughout this paper .",
    "the problem of random walk in a moving medium with boundaries can be formulated as the problem of _ the random walk with absorbing barriers _ in the probability theory .",
    "the procedure is as follows .",
    "first , consider that a particle begins a random walk from the origin @xmath56 under the situation in which there are two absorbing barriers at the position @xmath57 and @xmath58 @xmath59 .",
    "then the particle moves according to the p.d.f .",
    "@xmath60 at each step .",
    "if the particle advances beyond one of the barriers , it is absorbed by the barrier and the random walk is terminated then .    to make the argument clear",
    ", we introduce the probability density function of scattering points at the @xmath61-th step , @xmath62 .",
    "the integration of @xmath62 outside of the boundaries ( @xmath63 or @xmath64 ) denotes the probability that the particle is absorbed at the @xmath61-th step .",
    "the integral of @xmath62 over the inside region is _ not _ normalized to unity but denotes the probability that the particle is not absorbed until or at the @xmath61-th step and can carry out the @xmath65 step .",
    "the function @xmath62 can be written as a convolution of @xmath66 by @xmath60 over the non - absorption region , @xmath67 because the particle starts from @xmath56 , it can be seen easily @xmath68 and @xmath69 .",
    "all @xmath62 can be calculated in principle using iteratively .",
    "next , we introduce the density of scattering points summed over all steps , @xmath70 which constitutes one of the key concepts in the following description . if one is not discussing the number of steps before absorption , the only relevant quantity is the density of scattering points @xmath71 .",
    "we limit our considerations to those using @xmath71 in this paper , although the distribution of the number of steps before absorption is important to discuss the dispersion of acceleration time of particles .",
    "it is noted that @xmath71 is not the same as the physical number density of particles and their mutual relation is explained in the appendix a.    from and , we can derive a fredholm integral equation of the second kind for @xmath71 : @xmath72 especially , for no - boundary case ( @xmath73 ) , the solution @xmath74 obeys @xmath75 it is noted that @xmath71 satisfies certain integral conditions . to simplify the following description ,",
    "we introduce the probability density of absorption positions , @xmath76 here @xmath77 instead of @xmath7 is used for the spatial coordinate in the absorbing regions .",
    "@xmath78 satisfies the following two conditions .",
    "since the particle is eventually absorbed by either of the absorbing barriers , @xmath79 in addition , in the problem of the random walk with absorbing barriers , a theorem which is called the wald s identity holds .",
    "one of the simplest versions of this theorem is the following identity @xmath80 where @xmath54 was defined in the previous subsection . in the shock acceleration ,",
    "the barrier exists only at one side , i.e. , @xmath81 for downstream region and @xmath82 for upstream region . in the following section , we use one of these conditions to normalize the approximate solutions . for @xmath83 , we use , i.e. , @xmath84 on the other hand , for @xmath85 , we use , i.e. , @xmath86      in order to know the properties of random walk after large numbers of steps , it is helpful to consider the asymptotic form of @xmath74 for @xmath87 or @xmath88 . using the convolution theorem to ,",
    "the two - sided laplace transform of @xmath62 for the no - boundary case turns out to be @xmath89 therefore , from , the two - sided laplace transform of the scattering point density for no boundary case @xmath74 within the range @xmath90 becomes @xmath91 thus , @xmath74 is calculated by the bromwich integral as @xmath92 where @xmath4 is real and @xmath93 . for @xmath87 , the integral path is taken on the @xmath94 side and the residue at @xmath95 is dominant in the integral .",
    "the residue is calculated easily as @xmath96 then , we obtain the asymptotic form of @xmath74 for @xmath87 as @xmath97 the asymptotic form for @xmath88 is calculated in a similar way .",
    "the integral path is taken on the @xmath98 side and the residue at @xmath99 is dominant in the integral .",
    "the residue is calculated as @xmath100 then , we obtain @xmath101 for later convenience , we define the ratio of these two constants as @xmath102 if @xmath103 holds , @xmath104 is almost unity ( see ) . however , it is to be noted that @xmath104 is not equal to unity , i.e. , @xmath105 in general .",
    "equation indicates that the scale length of density of scattering points far upstream is equal to the inverse of @xmath54 .",
    "we denotes this length as @xmath106 while @xmath36 and @xmath37 are the scale lengths of single scattering , @xmath107 is the scale length of multiple scatterings .",
    "if @xmath23 is small enough and the scattering is isotropic , this scale length @xmath107 should coincide with the diffusion length derived by the conventional diffusion equation , @xmath108 , where @xmath109 is the diffusion coefficient ( @xmath110 ) , which is explicitly shown in .",
    "in contrast , when @xmath23 is large , we can not safely use the conventional diffusion equation and the length @xmath111 .",
    "however , even in such a case , we can regard @xmath107 as a diffusion length , since the distribution is an outcome of multiple scatterings in the random walk . here and hereafter",
    ", we call this @xmath107 simply ` the diffusion length ' and call @xmath111 ` the conventional diffusion length ' .",
    "we also show in that this diffusion length @xmath107 indeed coincides with the scale length of particle distribution derived by peacock ( 1981 ) and kirk & schneider ( 1988 ) in the far upstream region for relativistic shocks .    for later convenience",
    ", we also define the ratio of scale lengths of single scattering to the diffusion length as @xmath112      as already mentioned , although the density of scattering points does not give direct information about pitch angle cosine of the particle @xmath15 , we can derive the probability density of @xmath15 at absorption with an aid of the scattering law .",
    "the probability density of @xmath15 at the absorption by the boundary @xmath57 is given by @xmath113 and that at the boundary @xmath58 is given by @xmath114 the integral conditions for @xmath71 can be rewritten as the conditions for @xmath115 or @xmath116 . for @xmath85",
    ", the condition can be rewritten in terms of @xmath115 as @xmath117 similarly , for @xmath83 , the wald s identity can be rewritten as @xmath118 here , we define the total absorption probability by the boundary at @xmath119 @xmath120 this function also means the probability that the particle , which is injected in downstream side at a distance of @xmath121 from the boundary , reaches the boundary against the flow of scattering centres .",
    "if @xmath122 holds , also means @xmath123 for _ any _ models .",
    "since , for isotropic scattering and for @xmath124 , @xmath125 approaches the conventional diffusion length @xmath111 as already mentioned , agrees with the result of the conventional diffusion approximation obtained by drury ( 1983 ) .      in order to apply the random walk theory described above to the shock acceleration , it is useful to consider the probability density of the pitch angle cosine @xmath15 when the particle which crossed the shock front with @xmath126 returns to the front crossing the reverse direction . for downstream , random walk with a finite @xmath121 and @xmath81",
    "is applied while for upstream that with a finite @xmath127 and @xmath82 is applied . as will be shown in later sections , all the quantities associated with the shock acceleration",
    "can be represented with this probability density .",
    "hereafter , we denote the spatial coordinate by @xmath128 with the shock front at @xmath129 in order to retain @xmath7 coordinate for the random walk problem treated so far where @xmath56 corresponds to the injection point of the particle .",
    "first , let us consider the return probability for the upstream .",
    "the particle first crosses the boundary toward ( - ) direction , i.e. , from the downstream to the upstream with a pitch angle cosine @xmath130 . in order to calculate the probability density of the pitch angle cosine at the return @xmath131 , @xmath132 , it is useful to introduce the density of scattering points before return , @xmath133 , which is defined on @xmath134 .",
    "this density can be calculated in the following way .",
    "the probability density of the first scattering point for the particle which crossed the boundary with pitch angle cosine @xmath135 is determined by the scattering law .",
    "particles which have the first scattering point at @xmath136 make the scattering point density @xmath137 , where @xmath138 denotes the scattering point density of particles injected at @xmath56 in the random walk with absorbing barriers at @xmath57 and @xmath58 .",
    "therefore , we obtain @xmath139 where @xmath140 and @xmath141 . using this ,",
    "@xmath132 is calculated as @xmath142 where @xmath143 . for this case , the total return probability is always unity ( ) , i.e. , @xmath144 we can rewrite this as an integral condition for @xmath133 , @xmath145    for the downstream , the probability density of pitch angle cosine @xmath146 at return for the particle which initially crossed the shock front with @xmath147 ( ( + ) direction ) , @xmath148 , is calculated in a similar way . the scattering point density @xmath149",
    "is written as @xmath150 which is defined on @xmath151 .",
    "using this density , @xmath152 is calculated as @xmath153 the total return probability @xmath154 is not unity and is given as @xmath155 the integral condition becomes a condition for @xmath156 as @xmath157 as is shown in .    in the following sections , we derive approximate analytic solutions of @xmath158 and @xmath159 where we use the normalization condition for the scattering point density @xmath160 and @xmath161 .",
    "in this section , we derive approximate analytic solutions for the probability densities by obtaining approximate solutions for the integral equation .",
    "we start from the asymptotic solution of and for the no - boundary problem .",
    "first we approximate the no - boundary solution @xmath74 as @xmath162 note that this approximation neglects a peak around @xmath56 arising from the injection ( see in for monte carlo results ) .    to obtain approximate solutions for problems with finite boundaries from those for no - boundary problems , we transform the original integral equation to an alternative integral equation @xmath163 where we define the kernel @xmath164 ( see for its derivation ) .",
    "this integral equation is , of course , equivalent to .",
    "first , we consider approximate solution for the upstream @xmath165 taking @xmath85 and a finite value of @xmath127 .",
    "starting from the approximation , the kernel of the integral equation for @xmath71 becomes separable into @xmath7 , @xmath166 as @xmath167 where @xmath168 substituting this into , we obtain @xmath169 where @xmath170 and @xmath171 the term proportional to @xmath172 represents the effects of the existence of the absorbing boundary at @xmath57 .",
    "although we do not need to explicitly evaluate @xmath173 in our procedures described below , @xmath173 can be solved if we substitute into the definition of @xmath173 as @xmath174 where @xmath175 if we use the approximation again and remembering @xmath176 , the becomes @xmath177 where @xmath178 and @xmath179 in , the second term with the scale length @xmath107 represents the distribution formed by the diffusion process after a large number of scattering , similar to the asymptotic form of @xmath74 for far upstream .",
    "the first term represents the correction to the diffusive term by the following three non - diffusive effects ; the density of scattering points contributed by particles which take only a few steps , the effect of finite initial mean free path @xmath180 ( finite distance from the boundary to the first scattering point ) , and the absorbing effect near the boundary .",
    "when we take the limit @xmath181 , this term disappears and is just reduced to the diffusive solution . depending on @xmath180 ,",
    "@xmath182 can take a positive or negative value . for small @xmath180",
    "the correction term is positive and it mainly reflect the scattering points of the few step particles , while for large @xmath180 it is negative accounting for the effects of finite mean free path and absorption at the boundary .",
    "these features are mentioned again in for a specific scattering model .    substituting this to",
    ", we obtain an approximate solution for @xmath183 @xmath184 however , this approximate solution does not satisfy the condition in general because we do not use the exact solution of @xmath71 .",
    "although there may be various ways of remedying this problem , here we adopt a simple and practical way to renormalize the amplitude of @xmath185 so as to satisfy for a given @xmath180 .",
    "thus , instead of @xmath185 we use the coefficient @xmath186 defined by @xmath187 where we define @xmath188 this method also has a merit in avoiding to calculate a complicated integral in the original definition of @xmath185 .",
    "next , we consider approximate solution for the downstream @xmath189 in a similar way by taking @xmath83 and a finite value of @xmath121 . starting from the approximation ,",
    "the kernel becomes @xmath190 where @xmath191 @xmath71 is obtained as @xmath192 where @xmath193 substituting this into and using the approximation again , we obtain @xmath194 where @xmath195 @xmath196 similarly to the case of @xmath160 , the second term in denotes the diffusive term , which corresponds to the asymptotic form for far downstream , and the first term represents the correction to it .",
    "@xmath197 takes positive value for small @xmath180 and negative value for large @xmath180 . using this to , we obtain approximate solution of @xmath198 @xmath199 we again renormalize @xmath200 so as to satisfy the integral condition for the same reason as in the upstream .",
    "thus , instead of @xmath200 we use @xmath201 defined by @xmath202 where we define @xmath203 and we use the relation @xmath204 which is derived by together with the definition of @xmath54 and @xmath18 .",
    "the total return probability @xmath205 is calculated by easily , @xmath206 where we define @xmath207      to compare our approximation with more conventional diffusive approximation , for reference we consider also the latter approximation which we call multi - step approximation .",
    "this is done by ignoring the first term in or , i.e. , by setting @xmath208 . in this approximation",
    ", the density profile takes the same form to the results of the diffusive approximation .",
    "but , since we do not take the limit @xmath181 , this approximation includes partly the effect of the finite mean free path .",
    "( although , the effect of the first step return is lost . )    thus , in the multi - step approximation , the probability density functions become @xmath209 @xmath210 and @xmath211 where we define @xmath212 in the multi - step approximation , the pitch angle distribution at return becomes independent of @xmath213 and @xmath214 .",
    "further @xmath183 is independent of @xmath126 and @xmath198 is separable with respect to @xmath126 and @xmath15 .",
    "although in general the multi - step approximation is not satisfactory , there are cases where this makes some sense as shown in .",
    "the absorption probabilities of the particle injected at a distance @xmath121 in the downstream from the shock front , @xmath116 and @xmath215 , are of some theoretical interest , although it is not explicitly used in later considerations . to obtain their approximate expression , we start with together with the approximation . we renormalize the amplitude of @xmath216",
    "so as to satisfy the wald s identity as @xmath217 using @xmath218 , we obtain @xmath219 @xmath220 it is to be noted that @xmath215 has the scale length @xmath107 for large @xmath121 .",
    "the absorption probability of the particle injected in the upstream at the distance of @xmath127 from the shock front and the pitch angle cosine @xmath15 , @xmath115 , can be also calculated in a similar manner .",
    "using with we renormalize @xmath221 so as to satisfy , although we do not present the result here . in principle it is possible to calculate @xmath183 and @xmath198 by using these @xmath222 .",
    "however , since the expressions are too cumbersome and impractical to denote @xmath183 and @xmath198 in an analytical form , we use the and for @xmath183 and @xmath198 respectively in the following argument .",
    "we make further approximation such as the multi - step approximation .",
    "if we set @xmath223 for all @xmath7 , which is the diffusive solution , and if we ignore the first term in , using wald s identity , we obtain @xmath224 @xmath225 in the limit of @xmath124 , in which the conventional diffusion approximation holds , the constant @xmath226 approaches unity and this expression of @xmath215 agrees with .",
    "peacock(1981 ) derived the absorption probability in a similar form ( see his equation ( 24 ) ; he did not give a concrete expression of the constant @xmath226 ) , but did it in the downstream fluid frame under non - relativistic fluid speed condition and the diffusion approximation .",
    "in the following section , we will make comparisons with his expression for the isotropic scattering .",
    "corresponding approximation in the upstream can be made in a similar way .",
    "if we set the diffusive solution @xmath227 , @xmath71 becomes @xmath228 , where @xmath229 is some constant .",
    "ignoring the first term in and determining @xmath229 through , we obtain @xmath230 if we use these expressions for @xmath116 and @xmath115 to calculate @xmath198 and @xmath183 , the results coincide with the results of the multi - step approximation , obtained in the previous subsection as should be since only diffusive return is taken into account .",
    "we call these expressions for @xmath116 , @xmath215 and @xmath115 ` the multi - step approximation ' , too .",
    "in this section , we apply the random walk theory developed so far to a specific model of scattering .",
    "we consider here the model in which the mean free time @xmath231 is independent of @xmath15 ( although the energy dependence may be allowed , it is not relevant here ) , i.e. , @xmath232 , and the scattering is isotropic in the fluid frame , @xmath233 this model has been widely used both in analytic works ( peacock 1981 ) and in the monte carlo simulations ( ellison , jones & reynolds 1990 ) .",
    "to check the validity of our model , we also perform the monte carlo simulation in which the particle position is traced step by step faithfully according to the adopted scattering law . in the simulation ,",
    "the escaping boundary is set at @xmath234 , which is far enough not to influence the return probability of the particle ( see e.g. ) .      in this model ,",
    "@xmath34 is given by @xmath235 for the reason mentioned in section 2.1 , we can take the unit of length as @xmath236 in the following argument .",
    "thus , @xmath34 becomes @xmath237 and @xmath238 the p.d.f .",
    "of the random walk is given by @xmath239 where @xmath240 is the exponential integral defined by ( see abramowitz & stegun ) @xmath241 the m.g.f .",
    "is given by @xmath242 and the moments of @xmath60 are calculated as @xmath243 shows the p.d.f .",
    "@xmath60 ( a ) , and the m.g.f .",
    "@xmath48 ( b ) for @xmath244 .",
    "it is seen that the p.d.f .",
    "becomes more asymmetric for larger @xmath23 because of the advection effect .",
    "the equation to determine @xmath54 ( or @xmath245 ) is given by @xmath246    presents the scale lengths of the random walk , @xmath36 , @xmath37 and @xmath107 .",
    "we also show the conventional diffusion length @xmath111 mentioned in section 2.2.3 extrapolating it to high @xmath23 .",
    "since it depends on the lorentz factor of fluid speed @xmath247 in the unit of length used here ( @xmath248 ) , we show the two cases ; the case of a relativistic particle in a relativistic flow ( @xmath249 ; lower dotted curve ) , and the case of a non - relativistic particle in a non - relativistic flow ( @xmath250 ; upper dotted curve , @xmath251 ) . the diffusive scale length for a pitch angle diffusion model @xmath252 ( kirk & schneider 1987a ) is represented , too .",
    "( here , we choose the pitch angle diffusion coefficient in their model so that it has the same spatial diffsion coefficient as our model . ) for @xmath253 , @xmath107 can be approximated as @xmath254 and for @xmath255 , @xmath256 where @xmath257 therefore , if the ratio @xmath23 is small enough ( @xmath258 ) , our diffusion length @xmath107 coincides with the conventional one @xmath111 , as expected . on the other hand ,",
    "if @xmath23 becomes larger , the difference between @xmath107 and @xmath111 becomes larger . as mentioned in section 2.2.3 , for large @xmath23",
    ", @xmath111 becomes meaningless because the conventional diffusion approximation is no longer valid .",
    "however , @xmath107 still has a meaning of ` the diffusion length ' and this is explicitly shown later in .",
    "in fact , this scale length has been derived by 81 and kirk & schneider ( 1988 ) independently as the scale length of the particle distribution on the far upstream region of relativistic parallel shocks for large angle scattering models . in 81 ,",
    "the equation that is equivalent to was derived from the conservation law of particles in the upstream of the shock using ` the relativistic diffusion approximation ' ( which was named by 87 ) , where @xmath259 corresponds to our @xmath54 in his equation ( 16 ) . in kirk & schneider ( 1988 ) ,",
    "such equivalent equation to was also derived as the equation to determine the eigenvalues for large - angle scattering operator . in their equation",
    "( 34 ) , @xmath260 corresponds to @xmath54 and @xmath261 was taken to unity .",
    "the upstream density profile obtained in a previous monte carlo work for oblique shocks ( naito & takahara 1995 ) deviates from the diffusion approximation , which can be interpreted using @xmath107 obtained here if we consider in the de hoffmann - teller frame . also shows that , when @xmath23 becomes larger , the difference between @xmath36 and @xmath37 is larger and @xmath107 approaches to @xmath37 .",
    "behaviour of @xmath252 is similar to that of @xmath107 but takes a smaller value .",
    "it indicates that the diffusive scale length depends on the scattering model explicitly .",
    "the constants @xmath213 and @xmath214 , which determine the density of scattering points in the no - boundary case , becomes @xmath262 shows the ratio @xmath263 as a function of @xmath23 .",
    "for the limit @xmath124 , @xmath104 approaches to unity , which agrees with the results of the conventional diffusion approximation ( drury 1983 ) .",
    "however , as @xmath23 becomes larger , @xmath104 becomes smaller and approaches @xmath264 as @xmath265 when @xmath255 .",
    "shows an example of the no - boundary solution @xmath74 ( solid histogram ) for @xmath266 , which is obtained by the monte carlo simulation , together with the asymptotic approximation @xmath267 (; dashed curve ) .",
    "it confirms that @xmath267 approaches @xmath74 asymptotically for @xmath88 or @xmath87 .",
    "although @xmath74 has a peak around @xmath56 , our approximation ignores this peak as described in .",
    "shows an example of the results when the single boundary is located at @xmath268 .",
    "the density of scattering points @xmath71 ( solid histogram ) for @xmath266 is obtained by a monte carlo simulation , along with our approximate solutions and that of the conventional diffusion equation ( drury 1983 ; his equation ( 3.41 ) ) @xmath269 ( dotted curve ) .",
    "it is clearly seen that the conventional diffusion equation does not give a sufficiently good approximation to the real solution for high @xmath23 .",
    "especially , the random walk result shows that @xmath71 has a finite value at the absorption barriers , while @xmath269 becomes @xmath264 there . the small difference between the monte carlo result and the our approximation near the absorbing boundary is mainly caused by omitting the peak in @xmath74 around @xmath56 in making our approximation .      here , we present the return probabilities of particles for the isotropic large angle scattering model under the approximation made in the previous section .",
    "this model gives @xmath270 @xmath271 @xmath272 and @xmath273 where we define @xmath274 from these quantities , the probability densities of pitch angle at return @xmath183 and @xmath198 are calculated by and , while those for the multi - step approximation are calculated by and , respectively .",
    "the total return probability @xmath205 is also calculated by or .",
    "shows the probability density of pitch angle at return @xmath275 in ( a ) and @xmath276 in ( b ) for @xmath277 and for several values of the initial pitch angle cosine @xmath126 .",
    "our approximation ( solid curves ) gives a fairly good fit to the monte carlo simulation ( grey histograms ) for all initial pitch angle cosine @xmath126 .",
    "for small @xmath126 , the fit deviates a little because the effects of the peak in @xmath74 around @xmath56 , which is ignored in our approximation , affect the probability density .",
    "the multi - step approximation ( dotted curves ) does not fit well when the initial mean free path @xmath180 is small because effects of the return after only a few steps of scattering becomes important .",
    "but , for large @xmath180 and for @xmath198 , the multi - step approximation can fit to the monte carlo simulation .",
    "the expression of the absorption probability @xmath215 by our approximation is a little cumbersome and is presented in .",
    "the absorption probability by the multi - step approximation is given by together with .",
    "presents @xmath215 as a function of the initial position @xmath121 for @xmath278 .",
    "the result of our approximation ( solid curve ) gives a good fit to the monte carlo results ( filled circles ) ( small difference is in part caused by omitting the peak in @xmath74 ) .",
    "the multi - step approximation ( dashed curve ) deviates from the monte carlo results , but gives a correct scale length ( @xmath107 ) .",
    "this result directly confirms that the diffusion length for such large @xmath23 is given by our diffusion length @xmath107 .",
    "results using the conventional diffusion length @xmath111 instead of @xmath107 in the expression of the multi - step approximation ( and ) for two case as in are also represented ; lower dotted curve for @xmath279 and upper dotted curve for @xmath280 ) .",
    "it should be noted that if we extrapolate the expression ( 24 ) in peacock ( 1981 ) , which was derived by adopting the diffusion approximation for particles in downstream of the shock front , to relativistic fluid speed in fluid frame and then transform it to the expression for the boundary rest frame , it turns out to correspond to the multi - step approximation except that it has the scale length of return @xmath280 ( in our unit ) .",
    "these results do not give a satisfactory fit .",
    "presents the total return probability @xmath281 from the downstream for mildly high @xmath23 ( @xmath282 ) as a function of initial pitch angle cosine @xmath283 , which is measured in the boundary rest frame .",
    "the results of our approximation ( solid curve ) excellently agree with the monte carlo simulation ( filled circles ) .",
    "the dotted curve shows the approximate solution of 81 ( shown in his fig.2 ) .",
    "the result of the multi - step approximation ( dashed curve ) , which uses the correct length @xmath107 , is similar to peacock s one , but slightly better than it .",
    "these two diffusive approximations do not agree with the monte carlo results for small @xmath283 .",
    "the reason is similar to that for @xmath183 and @xmath198 ; in diffusive approximations , effects of return after only a few steps of scattering are not accounted for . in general , for higher @xmath23 or smaller @xmath180 , such effects become important and these diffusive approximations become worse .      here , we show the results of the density of the scattering points for the particles which cross the shock front with the pitch angle cosine @xmath126 .",
    "shows @xmath284 in ( a ) and @xmath285 in ( b ) calculated by the monte carlo simulation ( histograms ) for several values of the initial pitch angle @xmath126 along with our approximate solutions .    it is seen that our approximation ( solid curves ) coincides well with monte carlo simulation .",
    "but , a discrepancy is recognized for @xmath286 in ( b ) . because the normalization conditions used in our approximation ( the , ) employ only the information of finally absorbed particles and do not care about escaping particles to the far downstream , our approximation fails to give a good fit in a distant region where escaping particles dominate , while it gives a satisfactory fit in a near region where almost all the last scattering points exist .",
    "this also means that our approximation works well for absorbed particles , therefore the return probability densities themselves are represented by our approximations quite well as shown in and .",
    "another important feature of @xmath161 and @xmath160 is that the density of the scattering points near the boundary depends on the initial pitch angle @xmath126 . here",
    ", we explain this feature for @xmath161 ( that for @xmath160 is similar ) .",
    "( b ) shows that @xmath189 increases when @xmath287 for small @xmath180 but that it decreases when @xmath287 for large @xmath180 .",
    "this can be explained as already mentioned in section 3 ; for small @xmath180 the scattering point of few step particles are important , while for large @xmath180 the effect of finite initial mean free path is important . in our approximate expression of , while @xmath200 is always positive , @xmath197 becomes negative for large @xmath180 , as shown in ( b ) .",
    "( this feature also appears for @xmath160 , as shown in ( a ) . )    because of this feature , when we average the return probability over an incoming particle distribution , the first term in , which denotes the non - diffusive effects , will become small enough compared with the diffusive term which is associated with @xmath200 .",
    "then , there appears a possibility to use the multi - step approximation to determine the _ averaged _ pitch angle distribution over all incident particles even if @xmath23 is large .",
    "the same consideration applies for @xmath160 , too . as will be shown in the following section , at least for the isotropic large angle scattering model and for typical incoming @xmath126 distributions ,",
    "_ this is actually the case_. in practice , for this reason , we can use the multi - step approximation to determine the pitch angle distribution at the shock front for _ arbitrary _ shock speed as shown in the following section .",
    "in this section , we apply the random walk theory developed so far to the shock acceleration and calculate the spectral index of the accelerated particles for the isotropic large angle scattering model described in the previous section . in the following ,",
    "we consider the acceleration in parallel shocks where the fluid speed measured in the shock rest frame are uniform on each side of the shock front ; @xmath288 for the upstream and @xmath289 for downstream respectively .",
    "we also consider only relativistic particles ( @xmath290 , i.e. , @xmath291 ) because , in this case , the ratio @xmath23 does not change on each side of the shock front even if the particle gains energy in the process of multiple crossing at the shock front .",
    "in addition , for such particles , the lorentz transformation of @xmath292 to @xmath15 becomes as simple as @xmath293 where @xmath292 is the pitch angle cosine measured in the shock rest frame .",
    "hereafter , we use subscripts u , d or superscripts ( u ) , ( d ) to indicate quantities in the upstream and downstream regions , respectively .",
    "the pitch angle cosine measured in the upstream fluid frame is denoted by @xmath294 and that measured in the downstream fluid frame by @xmath295 .    in the following",
    ", we present the results only for two simple jump conditions @xmath296 and @xmath297 ( i.e. , @xmath298 ) .",
    "but , since the results are expressed in terms of @xmath288 and @xmath289 , they are applicable to any jump conditions .",
    "( jump conditions for relativistic shocks are discussed in blandford & mckee , 81 , appl & camenzind and heavens & drury . )",
    "the spectral index of the accelerated particles @xmath4 is given by @xmath299 where @xmath300 is the averaged return probability for the particles crossing the shock front toward downstream and @xmath301 is the logarithm of the energy gain factor ( see peacock 1981 ) .",
    "( here , @xmath302 denotes to average over the pitch angle distribution crossing the shock front . )",
    "@xmath301 is given as @xmath303 where @xmath304 @xmath305 and @xmath306 is the relative velocity of the upstream fluid with respect to the downstream fluid , @xmath307 if the dependences on @xmath15 and @xmath11 in @xmath38 and @xmath17 are separable , these quantities are independent of the particle energy , i.e. , @xmath11 .",
    "introducing the normalized pitch angle distribution of particles crossing the shock front from upstream toward downstream by @xmath308 , and that from downstream toward upstream by @xmath309 , i.e. , @xmath310 we can write relevant quantities as follows . using @xmath311 and @xmath312 ,",
    "@xmath300 is written as @xmath313 the logarithm of the energy gain factor is given by @xmath314 and @xmath315 the factor @xmath316 in means that only particles which return again to the shock front are to be considered .    the pitch angle distribution @xmath308 and @xmath309 in a steady state",
    "are determined as follows .",
    "if @xmath308 is known , @xmath309 is determined by @xmath308 , @xmath317 on the other hand , @xmath308 is also determined by @xmath309 , @xmath318 therefore , in a steady state , @xmath309 satisfies an integral equation ( a fredholm equation of second kind ) @xmath319 where the kernel of this integral equation is given by @xmath320 this kernel denotes the probability density of the particle which crosses the shock front from downstream to upstream with @xmath321 crosses the shock front again from downstream to upstream with @xmath295 after one cycle .",
    "if @xmath309 can be solved , @xmath308 is calculated through .",
    "although in the above we have made the integral equation for @xmath309 , one can alternatively make the integral equation for @xmath308 .",
    "it is generally difficult to solve the integral equation analytically even if our approximation are used .",
    "then , we numerically evaluate the kernel for our approximation . on the other hand , in the multi - step approximation , @xmath322 and @xmath323",
    "can be calculated analytically without solving the integral equation . because the dependence of @xmath324 in are separable in @xmath15 and @xmath135 in this approximation",
    ", it becomes @xmath325 because @xmath326 in is independent of @xmath135 , we obtain @xmath327 these results agree with the results obtained by peacock(1981 ) , but @xmath107 was replaced by @xmath111 in .    shows the kernel of for @xmath328 and @xmath297 .",
    "the numerical evaluation based on our approximation for @xmath329 ( solid curve ) , @xmath330 ( dashed curve ) and @xmath331 ( dotted curve ) together with that of the multi - step approximation are shown .",
    "it is seen that the kernel is almost independent of the initial pitch angle cosine @xmath283 .",
    "the reason for this coincidence is considered to be due to compensation effects of several non - diffusive effects when averaged over the initial pitch angle as was mentioned in the previous section . although this is partly due to our assumption of the isotropic large angle scattering , it is of a great importance in applications to the shock acceleration . although the multi - step approximation is a poor approximation to the detailed particle transport , it can be a good approximation when we average over the pitch angle distribution .",
    "thus , this result gives a justification for using the multi - step approximation even for relativistic shocks .",
    "presents the pitch angle distribution at the shock front in various frames for various shock velocities .",
    "the results of the multi - step approximation ( dotted curve ) and the monte carlo simulation ( solid histogram ) are shown . as is seen ,",
    "the results of the multi - step approximation agree quite well with the monte carlo results even for highly relativistic shocks .",
    "this is not surprising once we admit that the kernel is well approximated by the multi - step approximation .",
    "thus , we have confirmed the point mentioned above that the multi - step approximation gives a good fit to the steady state pitch angle distribution at the shock for any shock speed . also , it is to be noted that the assumptions used in peacock ( 1981 ) are adequate for arbitrary shock speed if the correct diffusion length @xmath107 is used in the downstream as in the multi - step approximation .",
    "= 7.95 cm    in the previous subsection , we have shown that the pitch angle distributions at the shock crossing @xmath322 and @xmath323 can be well approximated by the multi - step approximation . here , using this approximation , we show analytical expressions of the quantities associated with the shock acceleration , @xmath300 , @xmath301 and @xmath4 , for the isotropic large angle scattering .",
    "first , using @xmath332 ( ) and @xmath322 by the multi - step approximation , @xmath300 is calculated as @xmath333 where @xmath334 with @xmath335 @xmath336 @xmath337 @xmath338 @xmath339 is defined in .",
    "then , the logarithm of the energy gain factor is given by @xmath340 and @xmath341 where @xmath342 with dilogarithm @xmath343 defined by ( see abramowitz & stegun 1965 ) @xmath344 using these results , gives the spectral index @xmath4 . in ( a )",
    "are presented the quantities associated with the shock accelerations as functions of shock speed @xmath345 for the compression ratio @xmath346 . in ( b ) are shown the results for different jump condition ( @xmath298 ) . as is seen in these two figures ,",
    "the result of the multi - step approximation excellently agree with the results of the monte carlo simulation even if shock speed becomes highly relativistic .",
    "presents the spectral index @xmath4 as functions of the compression ratio @xmath3 similar to fig .  4 of 90 .",
    "our results ( solid curves ) basically coincide with their approximate expression ( dashed curves ; their equation(29 ) ) .",
    "small discrepancy between these two results may be caused by the difference of the method to determine the spectral index @xmath4 ; we calculate @xmath4 using , while @xmath4 was determined by fitting the calculated particle spectrum directly in 90 .",
    "although we have considered the particle acceleration in parallel shocks with the large angle scattering model , it is of some interest to discuss whether our formulation can be extended to other scattering regime .",
    "recently , the acceleration in ultra - relativistic shocks has attracted some attention in relation to the ultra - high - energy cosmic rays ( uhecr ) . however , in such highly relativistic shocks , the large angle scattering model adopted here can not be used safely in a physical sense ; because the residence time of particles in upstream is quite short ( it is shorter than the gyro - period of particles ) , its point - like feature may lead to unsuitable results ( bednarz & ostrowski 1996 ) .",
    "this is also problematic for the pitch angle diffusion model based on the quasi - linear theory ; because it assumes the resonance between the magnetohydrodynamical waves and particle gyro - motion , it requires time much longer than the gyro - period .",
    "gallant & achterberg ( 1999 ) proposed two deflection mechanisms of particles in upstream ; regular deflection owing to the gyro - motion in uniform magnetic field , and ` direction angle ' diffusion by randomly oriented small magnetic cells , where the direction angle is defined as the angle between the particle velocity and the shock normal .",
    "gallant , achterberg & kirk ( 1999 ) and kirk et al . (",
    "2000 ) calculated the spectral index using such direction angle diffusion model .",
    "bednarz & ostrowski ( 1998 ) also calculated the index adopting the small angle scattering model , which is approximately equivalent to the direction angle diffusion model in a mathematical sense .",
    "these works showed the spectral index @xmath4 typically becomes @xmath347 for ultra - relativistic shock limit , while our large angle scattering model gives @xmath348 .",
    "this index of 2.2 may be universal when the direction angle diffusion ( or equivalent process ) is proper for the scattering / deflection process in both upstream and downstream , though it is not yet settled whether the real scattering / deflection process during such quite short time can be treated well as a diffusion in direction angle .    because our probability function based description of the shock acceleration described in section 5.1 needs only two probability functions @xmath349 and @xmath350 to obtain the spectral index , it can be extended to include other scattering or deflection mechanisms if corresponding probability functions can be defined .",
    "for example , for the model of regular deflection in upstream the probability function @xmath349 can be defined and expressed in an analytical form under the condition that the direction of velocity perpendicular to the shock normal is randomly distributed at the shock crossing from downstream .",
    "thus , if the large angle scattering model is adopted in downstream ( assuming the bohm diffusion ) , one can calculate the spectral index .",
    "we have given a new formulation of the first order fermi acceleration in shock waves with any shock speed in the point of view of the random walk of single particles suffering from large angle scattering .",
    "first , we have investigated the properties of particle trajectories in a moving medium .",
    "we showed that the problem could be formulated in terms of the random walk with absorbing boundaries based on the probability theory and derived an integral equation for the density of scattering points . by approximately solving it in an analytical form ,",
    "we have given approximate analytic expressions for the probability density of pitch angle at return for particles which cross the shock front at a given pitch angle .",
    "we have confirmed that our approximate solutions agree with the monte carlo results quite well for the isotropic scattering .",
    "we have also shown that they are quite different from those based on the diffusion approximation for relativistic and mildly relativistic shocks .",
    "it is seen that the non - diffusive effects such as the return after only a few steps of scattering or the finite mean free path , which are not included in the diffusion approximation , are very important .    using these results",
    "we have applied our formulation to the shock acceleration and compared our results with those in the literature such as ` the relativistic diffusion approximation ' , which was developed by 81 , together with the conventional diffusion approximation .",
    "we have found that the multi - step approximation , in which the effects of the return after only a few steps of scattering are neglected , gives a quite good fit to the monte carlo results on the pitch angle distributions at the shock crossing and the spectral index of accelerated particles .",
    "this is somewhat surprising because the multi - step approximation gives a poor fit to the monte carlo results when we fix the initial pitch angle at the shock crossing .",
    "one reason for this is considered that when averaging over the initial pitch angle , the effects of a few steps of return and the finite mean free path tend to cancel out and as a result the diffusive return term becomes dominant .",
    "thus , our approach gives a theoretical base to use the multi - step approximation in the shock acceleration with any shock speed .",
    "we have also given a correct expression for the diffusive length scale for relativistic shocks , which equals to the scale lengths previously derived by 81 and kirk & schneider ( 1988 ) for far upstream distribution in relativistic shocks , instead of a naive diffusion length based on the conventional diffusion equation .",
    "this work is supported in part by the grant - in - aid for scientific research of the ministry of education , science , sports and culture ( no .",
    "11640236 ) .",
    "abramowitz m. , stegun i.a .",
    ", 1965 , handbook of mathematical functions .",
    "dover , new york appl s. , camenzind m. , 1988 , a&a , 206 , 258 axford w.i .",
    ", leer e. , skadron g. , 1977 , proc.15th int .",
    "cosmic ray conf.(plovdiv ) , 11 , 132 bell a.r . , 1978a , mnras , 182 , 147 blandford r.d . , eichler d. , 1987 , phys.rep . , 154 , 1 blandford r.d . ,",
    "mckee c.f . , 1976 , phys.fluids , 19 , 1130 blandford r.d . , ostriker j.p . , 1978 , apj , 221 , l229 bednarz j. , ostrowski m. , 1996 , mnras , 283 , 447 bednarz j. , ostrowski m. , 1998 , phys.rev.lett . , 80 , 3911 berezhko e.g. , ellison d.c . , 1999 ,",
    "apj , 526 , 385 cox d.r . , miller h.d . , 1965 ,",
    "the theory of stochastic processes .",
    "methuen , london drury l.oc . , 1983 , rep.prog.phys , 46 , 973 ellison d.c . , jones f.c .",
    ", reynolds s.p . , 1990 , apj , 360 , 702 ellison d.c . , baring m.g .",
    ", jones f.c . , 1996 ,",
    "apj , 473 , 1029 gallant y.a .",
    ", achterberg a. , 1999 , mnras , 305 , l6 gallant y.a .",
    ", achterberg a. , kirk j.g . , 1999 ,",
    "a&as , 138 , 549 heavens a.f . ,",
    ". , 1988 , mnras , 235 , 997 kirk j.g . , duffy p. , 1999",
    ", j.phys.g .",
    "nucl.part.phys . , 25 , r163 kirk j.g . , guthmann w. , gallant y.a . ,",
    "achterberg a. , 2000 , apj , in press kirk j.g . , schlickeiser r. , schneider p. , 1988",
    ", apj , 328 , 269 kirk j.g . , schneider p. , 1987a",
    ", apj , 315 , 425 kirk j.g . , schneider p. , 1988 ,",
    "a&a , 201 , 177 koyama k. , petre r. , gotthelf e.v . , hawng u. , matsuura m. , ozaki m. , holt s.s . , 1995 , nat , 378 , 255 krymsky g.f . , 1977 , soviet phys.dokl . , 22 , 327 malkov m.a . , vlk h.j . , 1995 ,",
    "a&a , 300 , 605 melrose d.b . , 1980 , plasma astrophysics .",
    "gordon and breach , new york naito t. , takahara f. , 1995 , mnras , 275 , 1077 ostrowski m. , 1991 , mnras , 249 , 551 peacock j.a . , 1981 , mnras , 196 , 135",
    "in order to consider the connection of the density of scattering points in random walk to the physical number density , let us introduce the concept of _ the staying time density_. we define the staying time density @xmath351 as the total staying time in the region between @xmath7 and @xmath352 for the particle which is injected at the origin @xmath56 and absorbed eventually by one of the absorbing barriers .",
    "the total staying time in the non - absorbing region before absorption is clearly given by @xmath353 then , the particle - averaged staying time density @xmath354 ( i.e. , the ensemble average of @xmath355 ) is given as follows .",
    "consider the contribution to the staying time of a particle between the successive scatterings .",
    "since the probability of the particles to move beyond @xmath21 without scattering is @xmath356 and since the staying time density is @xmath357 , the pitch angle averaged staying time density made by the particle during one step , @xmath358 , is given by @xmath359 where @xmath360 is measured in the boundary rest frame . using the probability density of the @xmath61-th scattering point @xmath62 , the staying time density made by the particles during the @xmath61-th step to @xmath65-th step is written as @xmath361 therefore , summing up all steps from @xmath362 to @xmath363 , the total staying time density is written as @xmath364 if we consider a steady state problem , in which particles are injected at the origin at a constant rate ( with pitch angle distribution @xmath17 ) , @xmath354 gives the physical number density for unit injection rate .",
    "these relations also have been used in the monte carlo simulations ( e.g. naito & takahara 1995 ) .",
    "the problem of the random walk of single particles , which is discussed in , is equivalent to a steady state problem in which one particle is injected at the origin per one step . in the latter problem , @xmath62 means the number density of scattering points of particles injected before @xmath61-steps and @xmath71 correspond to the number density of scattering points made by all particles existing that time . here",
    ", we consider the integral equation for @xmath71 in this equivalent steady problem .",
    "let us consider the random walk of particles in steady state with no boundary but with _ imaginary _ boundaries at @xmath57 and @xmath58 .",
    "the number density of scattering points clearly equal to @xmath74 .",
    "then , we can distinguish the particles that cross the boundaries at least once ( ` passed particles ' ) from those that never crossed the boundaries ( ` non - passed particles ' ) .",
    "we write densities of scattering points of the former and latter particles as @xmath365 and @xmath71 , respectively .",
    "this @xmath71 obviously coincides with the density of scattering points of the random walk of single particle with the absorbing barriers at @xmath57 and @xmath58 .",
    "the sum of these two densities should be the solution for the no - boundary problem , @xmath74 , @xmath366 non - passed particles are injected at the origin steadily at one particle per step . on the other hand , passed particles are _ created _ when non - passed particles cross one of the imaginary boundaries and this can be regarded as the passed particles are injected at the first scattering point after they first cross the boundary . if we denote density of the first scattering point as @xmath367 , this is calculated by the distribution of non - passed particles @xmath71 as , @xmath368 each passed particle which is injected at each first scattering point @xmath369 makes the density of scattering point @xmath370 .",
    "thus , @xmath365 is written as @xmath371 using and , we obtain @xmath372 by the definition of @xmath367 , @xmath373 @xmath374 thus , defining the kernel as @xmath375 we get a fredholm integral equation of the second kind , @xmath376 this provides an alternative form of the integral equation for @xmath71 .",
    "this is the case of @xmath83 .",
    "we first rewrite the wald s identity as @xmath378 this equation can be rewritten further as @xmath379 on the other hand , @xmath380 in the can be rewritten as @xmath381 thus , combining these two , we obtain the condition to be satisfied for @xmath380 : @xmath382 using the representation of p.d.f . for large angle scattering model , this condition becomes .",
    "the absorption probability from initial position @xmath121 , @xmath215 , by our approximation is calculated as follows .",
    "@xmath383 where we define functions @xmath384 @xmath385 and a constant @xmath386"
  ],
  "abstract_text": [
    "<S> we formulate the first order fermi acceleration in shock waves in terms of the random walk theory . </S>",
    "<S> the formulation is applicable to any value of the shock speed and the particle speed , in particular , to the acceleration in relativistic shocks and to the injection problem , where the particle speed is comparable to the fluid speed , as long as large angle scattering is suitable for the scattering process of particles . </S>",
    "<S> we first show that the trajectory of a particle suffering from large angle scattering can be treated as a random walk in a moving medium with an absorbing boundary ( e.g. , the shock front ) . </S>",
    "<S> we derive an integral equation to determine the density of scattering points of the random walk , and by solving it approximately we obtain approximate solutions of the probability density of pitch angle at and the return probability after the shock crossing in analytic form . </S>",
    "<S> these approximate solutions include corrections of several non - diffusive effects to the conventional diffusion approximation and we show that they agree well with the monte carlo results for isotropic scattering model for any shock speed and particle speed . when we neglect effects of ` a few step return ' , we obtain ` the multi - step approximation ' which includes only the effect of finite mean free path and which is equivalent to ` the relativistic diffusion approximation ' used by peacock ( 1981 ) if the correct diffusion length is used in his expression . </S>",
    "<S> we find that the multi - step approximation is not appropriate to describe the probability densities of individual particles for relativistic shocks , but that the pitch angle distribution at the shock front in steady state is in practice quite well approximated by that given by the multi - step approximation because the effects of finite mean free path and a few step return compensate each other when averaged over pitch angle distribution . </S>",
    "<S> finally , we give an analytical expression of the spectral index of accelerated particles in parallel shocks valid for arbitrary shock speed using this approximation .    # 1#2    # 1section  [ sec:#1 ] </S>",
    "<S> # 1appendix  [ apn:#1 ] # 1equation  ( [ eq:#1 ] ) # 1([eq:#1 ] ) # 1fig .  </S>",
    "<S> [ fig:#1 ]    </S>",
    "<S> 81peacock 87kirk & schneider 90ellison et al . </S>",
    "<S> 88kirk 78bell    # 1#1_u # 1#1_d # 1#1_f # 1#1_rel # 1#1_+ # 1#1_- # 1#1_d # 1#1_d0 # 1#1_ud # 1#1_du # 1#1_uw # 1#1_dw # 1#1^(u ) # 1#1^(d )    0_0    # 1dilog ( # 1 )    acceleration of particles  methods : analytical  shock waves  cosmic rays . </S>"
  ]
}