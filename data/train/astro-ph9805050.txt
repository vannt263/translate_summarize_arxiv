{
  "article_text": [
    "in recent times , problems in the modelling of both nonmagnetic and magnetic stellar atmospheres have emerged that can not be solved by traditional numerically intensive computing .",
    "take as an example the calculation of line - blanketed lte stellar atmospheres by means of opacity sampling as done in _",
    "atlas12_. even on present - day fast single - processor machines realistic frequency step sizes lead to rather prohibitive cpu times ( see castelli , these proceedings ) .",
    "the same applies to the modelling of broadband linear ( bblp ) and circular ( bbcp ) polarisation in sunspots , in the solar network and in magnetic stars , and to full zeeman doppler imaging ( zdi ) .",
    "the usual remedies to this software crisis do not excel in imagination : employing coarse frequency grids , approximate formal solvers or milne - eddington atmospheres is a cheap expedient but does not attack the problem at its root .    instead of waiting for the next increase in cpu clock rates to be able to run today s models on tomorrow s computers , it would be preferable to go parallel .",
    "indeed , parallel architectures are readily available nowadays and languages with parallel constructs provide concurrent execution of program segments .",
    "obviously there is no way around the restructuring and at least partial rewriting of existing programs , but is nt this preferable to physically doubtful approximations or to poor frequency sampling ?",
    "high performance fortran ( hpf ) would seem the obvious choice for the denizens of the fortran universe , but does the data parallel paradigm of hpf really provide optimum parallelism in spectral line synthesis , be it lte or nlte , polarised or unpolarised ? would hpf really speed up stellar atmosphere calculations with a suitably modified version of _ atlas _ , and what about zdi ? is nt it most likely that we have to rethink our approach in a far more radical way ?",
    "supercomputing should not be a synonym for brute number crunching nor should it reduce to the use of a few special instructions and highly specialised subprograms that can take advantage of parallel architectures .",
    "supercomputing deserves its name only when it encompasses object oriented software design on the _ appropriate level of abstraction _",
    ", when it ensures code safety and reliability , when it provides potentially massively parallel execution of _ large sections _ of the code , and when the most accurate and stable numerical methods are used .",
    "[ 0.4 ]    in polarised radiative transfer the latter requirement translates into the use of the zeeman feautrier ( zf ) method ( auer et al .",
    "tedious to code and prone to bugs in fortran77 , a zf solver constitutes no problem for the ada programmer thanks to the high level abstractions made possible by the use of the ada programming language ; the block tri - diagonal scheme can be written down straightforwardly as given in rees & murphy ( 1987 ) .",
    "extensive tests have revealed that especially in the presence of blends the zf solver is ( at constant number of depth points ) up to 5  times more accurate than the delo method ( rees & murphy , 1987 ) as demonstrated in fig .  1 .",
    "if a 4000 interval is to be covered , the modelling of bblp and bbcp in a solar - type atmosphere involves opacity sampling over about @xmath0 zeeman subcomponents and @xmath1 formal solutions to achieve the minimum frequency resolution . since it is well known that in the presence of heavy blending milne - eddington based approaches are hopelessly inadequate we have no alternative to the admittedly expensive zf and delo solvers . the only way to be able to afford those relatively slow solvers appears to lie in parallelism on a large scale .",
    "you do nt have to visit homepages of astronomical colleagues to know that most of them program in fortran .",
    "but is fortran ( or hpf ) of any help in the computational astrophysics problems listed above ? codes of some 1000 fortran statements have been written ab initio in the late 1980s using simplified formal solvers and coarse fixed spatial integration grids to synthesise intensity spectra over intervals a mere 2 wide ; compare this to the hundreds and thousands of ngstrms required for the modelling of broadband polarisation .",
    "can such a program be upgraded for the latter purpose ?",
    "obviously a minor change wo nt do it but even if one were prepared to restructure large parts of the program , i claim that for very fundamental reasons this is not possible in a purely fortran context",
    ". there are no threads of control in _ data parallel _ hpf , so there is no way to directly implement the natural approach , viz . the computation in parallel of the emerging spectrum at each frequency point . for",
    "this one would have to employ posix threads ( pthreads ) , taking care of the individual threads , mutexes , and locks , but this is truly hard and unrewarding work .",
    "none of the hpf features promise substantial gains in performance .",
    "ada95 and its concurrent constructs , the task types and the protected types are ideally suited for parallelising line synthesis and stellar atmosphere codes .",
    "task objects are program entities that can execute concurrently on different nodes ( also in distributed systems ) , protected objects can be used to provide light - weight synchronisation .",
    "in the past few years i have developed a new generation of codes in the fields of polarised and unpolarised line synthesis and of zeeman doppler imaging .",
    "these codes are all written in ada95 and conform to my definition of supercomputing given above .",
    "they incorporate up - to - date astrophysics , deal with realistic atmospheres , provide full treatment of blends involving anomalous zeeman patterns , and offer a choice of accurate and numerically stable formal solvers ( delo , zf ) . on the software side ,",
    "maximum reuse of software modules is achieved by information hiding and encapsulation , and by extensive use of generics , of child libraries and of inheritance . and finally ,",
    "all codes provide for potentially massive parallelism ; they run  with virtually no change  on anything from pcs to silicon graphics supercomputers , taking full advantage of resources ranging from 1  processor to 32  processors and more .",
    "[ 0.65 ]    it is absolutely amazing how congenial the _ control - parallel _ paradigm of ada tasking is to line synthesis and stellar atmosphere problems .",
    "no large - scale modifications are needed to convert the sequential version of a program to a parallel version : changing not even 20 expressions in a 3500  loc ( lines of code ) ada program is sufficient to obtain a simple parallel version of a sequential code . at the same time , almost perfect load balance ( distribution of the computations to the various cpus according to their availability ) is achieved in an easy and elegant way through the use of protected objects for synchronisation . in most cases",
    "there is nothing more to do than put the subprogram that is to be executed in parallel into a task , replace those variables that are to be read or updated in mutual exclusion by protected objects , and finally statically create or dynamically allocate as many task objects as processors are available . in the shortest of times ( 2 hours and less ) you are gratified with a parallel program ! numerous examples of how the object oriented and parallel features of ada95 can be employed in scientific computing can be found in stift ( 1998 ) .",
    "thanks to a dedicated silicon graphics origin200 server with four r10000 processors , magnetic broadband polarisation in heavily blended spectra is at last revealing some of its secrets",
    ". calculations of extensive grids of broadband polarisation as a function of magnetic field strength and direction , of the atmospheric model , and of the wavelength interval have shown that the polarisation signal does not saturate at large field values as in the case of the classical zeeman triplet but may display complex behaviour as can be seen in fig .",
    "it thus appears that strong fields do not necessarily lead to a strong polarisation signal , but that rather the opposite can be true .",
    "leroy ( 1989 ) has demonstrated that the wavelength dependence of the degree of linear polarisation @xmath2 depends on the magnetic field strength ; his analysis did not include the effects of blending . extending the calculations presented by stift ( 1997 ) by synthesising spectra over the whole visible range for various atmospheres and a grid of magnetic field strengths and field directions ( fig .",
    "3 displays the solar case ) allows a systematic investigation of the @xmath2 vs. @xmath3 relation . as franco leone has suggested , this relation could possibly be used as a diagnostic tool for estimating the mean magnetic field modulus of a magnetic ap star .",
    "first results indicate that this is indeed the case , the @xmath4 relation appearing to be insensitive to the stellar magnetic geometry and independent of magnetic phase , reflecting only the mean magnetic field modulus .",
    "the outlook is fascinating : supercomputing with ada95 provides the means for major advances in the field of magnetic polarisation and stellar atmospheres , combining object orientation with straightforward scalable parallelism . with the technology and thousands of lines of ada code available for",
    "free , computational astrophysics can easily overcome the present software crisis .",
    "this work has been made possible by the austrian _ fonds zur frderung der wissenschaftlichen forschung _ under project p12101-ast .",
    "additional support came from the _ hochschuljubilumsstiftung der stadt wien_."
  ],
  "abstract_text": [
    "<S> certain problems in the field of stellar atmospheres , polarised radiative transfer and magnetic field diagnostics can not be addressed by means of traditional sequential programming techniques because cpu times become prohibitive on even the fastest single processor machines when realistic physics and accurate numerical methods are employed . </S>",
    "<S> this contribution discusses the question of what kind of supercomputing approach is best suited for the modelling of ap stars , pointing out the superiority of parallel computing with ada95 over high performance fortran in all of the above - mentioned fields . </S>"
  ]
}