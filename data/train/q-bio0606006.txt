{
  "article_text": [
    "many mathematical models involving reaction and diffusion ( e.g. catalytic reactions , morphogenesis ) are based on partial differential equations ( pdes ) describing the evolution of species concentrations in space and time  @xcite .",
    "one advantage of such pde models is the extensive set of existing theoretical and computational tools for their analysis and efficient simulation .",
    "a disadvantage of such continuum - based models in certain chemical and biological contexts is the relatively low number of molecules of some of the species involved .",
    "this may render mean - field type pde models inaccurate ; individual - based stochastic models become then more appropriate than continuum ones .    directly using a stochastic , molecular - based model for a spatially",
    "distributed pattern - forming system will typically be very computationally intensive .",
    "it becomes then important to extract useful coarse - grained , macroscopic information from the microscopic molecular - based model using as few detailed simulations as possible .",
    "this is the goal of equation - free methods @xcite which were designed for cases where the exact _ macroscopic _ equations are unavailable in closed form .    deriving accurate macroscopic equations",
    "rigorously is a challenging task ( see discussions in refs .",
    "@xcite for fluid dynamics , bacteria or eukaryotic cells , respectively ) .",
    "the mathematical assumptions leading to closures may not be quantitatively correct over large parameter regimes , making the pde models inaccurate there .",
    "equation - free methods _",
    "circumvent _ the derivation of accurate pdes by using short bursts of fine - scale simulation to estimate necessary numerical quantities ( residuals , action of jacobians ) on demand , rather than through explicit closed formulas . here",
    "we will illustrate how even _ approximate _ pde models can be exploited to accelerate  exact \" ( particle - based ) simulations . in the context of equation - free methods",
    "this can be accomplished naturally by using the approximate pdes to construct _",
    "preconditioners _ in the iterative numerical linear algebra involved in fixed point , stability and bifurcation computations .",
    "we call this procedure _  equation - assisted \" _ computation .",
    "our model problem is a stochastic reaction - diffusion system capable of exhibiting a turing instability @xcite .",
    "such models can serve as a prototypes of more realistic pattern formation mechanisms during morphogenesis ( see e.g. refs .",
    "the paper is organized as follows : in section [ secstomodel ] , we introduce this illustrative stochastic reaction - diffusion model : the schnakenberg @xcite system of two chemical species in one dimension .",
    "it can predict pattern formation under some conditions and it was also used previously in complex models of limb development  @xcite . in section [ secmacropde ] we start by presenting the mean field schnakenberg pdes at the limit of large particle numbers , and briefly summarize their bifurcation behavior in a parameter regime where they exhibit pattern formation .",
    "we briefly describe , in section [ sectheory ] , the computation of bifurcation diagrams using a timestepper based approach  both deterministic and  equation - free \" , based on a stochastic simulator implementing a spatially discretized version of the gillespie stochastic simulation algorithm @xcite ( ssa ) .",
    "we also discuss basic features of preconditioning and  equation - assisted \" bifurcation computations .",
    "we then present , in section [ secresults ] , our  equation - assisted \" results and discuss their comparison with the  equation - free \" case . here",
    "the mean field pde is used to construct a preconditioner , to accelerate the numerical linear algebra in our coarse - grained steady state computations .",
    "we conclude with a brief summary and discussion .",
    "we consider the schnakenberg @xcite system of two chemical species @xmath0 and @xmath1 with the following reaction mechanism : @xmath2 here eq .  ( [ ureact ] ) describes production and degradation of @xmath0 and eq .",
    "( [ vreact ] ) describes production of @xmath1 .",
    "moreover , @xmath0 is also produced in the reaction eq .",
    "( [ uvreact ] ) .",
    "we will assume that the concentrations of @xmath3 and @xmath4 are constants .    to simulate stochastically eqs .",
    "( [ ureact ] )  ( [ uvreact ] ) , one can use the gillespie ssa , a standard way to model stochastically a spatially homogeneous ( well mixed ) chemical system .",
    "the algorithm is based on answering two essential questions at each time step : when will the next chemical reaction occur , and what kind of reaction will it be ?",
    "gillespie @xcite derived a simple way to answer these two questions  at each step , the computer performs a reaction , updates numbers of reactants and products and continues with another time step until the algorithm reaches a time of interest .",
    "next , we introduce diffusion to the system .",
    "we assume that @xmath0 diffuses with ( macroscopic ) diffusion coefficient @xmath5 and @xmath1 diffuses with ( macroscopic ) diffusion coefficient @xmath6 .",
    "we consider a spatially one - dimensional domain  the interval @xmath7 $ ] with suitable boundary conditions as specified later . the generalization of gillespie s ideas to spatially nonhomogeneous systems can be found in the literature ( see e.g. refs .",
    "@xcite ) . here , we follow the most straightforward way , adding diffusion as another set of  reactions \" to the system . namely , we divide our domain into @xmath8 boxes ( small intervals ) of length @xmath9 .",
    "we denote by @xmath10 and @xmath11 the number of respective molecules in the spatial interval @xmath12 $ ] for @xmath13 .",
    "this means that we describe the state of the stochastic reaction - diffusion system by two @xmath8-dimensional vectors @xmath14,$ ] @xmath15 $ ] and we consider the following reactions at each time step @xmath16 @xmath17 where eq .",
    "( [ reactboxi ] ) means that we implement the schnakenberg reaction mechanism ( eqs .",
    "( [ ureact ] )  ( [ uvreact ] ) ) in every spatial box .",
    "equations ( [ diffip1 ] )  ( [ diffin1 ] ) describe diffusion ; the transition rates between boxes are denoted by @xmath18 and @xmath19 and they are connected to the macroscopic diffusion coefficients through the formulas @xmath20 , and @xmath21 the eqs .",
    "( [ reactboxi ] )  ( [ diffin1 ] ) , together with suitable boundary conditions , will be simulated using gillespie ssa and will be our illustrative stochastic reaction - diffusion problem in this paper .",
    " @xmath22 with periodic boundary conditions for @xmath23 , @xmath24 , 0.03 and 0.06 at @xmath25 with an initial condition being the perturbed uniform steady state .",
    "spatial patterns develop for @xmath26 ; the solutions were shifted to have a local @xmath27 minimum at @xmath28 we plot @xmath27 ( red curve ) and @xmath29 ( blue curve ) in the same picture.,title=\"fig : \" ]    @xmath22 with periodic boundary conditions for @xmath23 , @xmath24 , 0.03 and 0.06 at @xmath25 with an initial condition being the perturbed uniform steady state .",
    "spatial patterns develop for @xmath26 ; the solutions were shifted to have a local @xmath27 minimum at @xmath28 we plot @xmath27 ( red curve ) and @xmath29 ( blue curve ) in the same picture.,title=\"fig : \" ]    @xmath22 with periodic boundary conditions for @xmath23 , @xmath24 , 0.03 and 0.06 at @xmath25 with an initial condition being the perturbed uniform steady state .",
    "spatial patterns develop for @xmath26 ; the solutions were shifted to have a local @xmath27 minimum at @xmath28 we plot @xmath27 ( red curve ) and @xmath29 ( blue curve ) in the same picture.,title=\"fig : \" ]    ) ([rd2 ] ) with periodic boundary conditions .",
    "solutions were shifted to have the local @xmath27 minimum at @xmath28,title=\"fig : \" ] ) ([rd2 ] ) with periodic boundary conditions .",
    "solutions were shifted to have the local @xmath27 minimum at @xmath28,title=\"fig : \" ]    if we have enough molecules in the system , then eqs .  ( [ reactboxi ] )  ( [ diffin1 ] )",
    "are well approximated by a system of two reaction - diffusion pdes for the species concentrations @xmath30 and @xmath31 ; at the mesh points @xmath32 , @xmath33 @xmath34 where @xmath35 .",
    "the constant @xmath36 can be interpreted as the number of molecules in the box corresponding to a dimensionless concentration of 1 .",
    "reaction and diffusion rates are scaled as follows : @xmath37 , @xmath38 @xmath39 @xmath40 @xmath41 @xmath42 @xmath43 @xmath44 where @xmath45 and @xmath46 are ( constant ) concentrations of reactants @xmath3 and @xmath4 , @xmath47 , @xmath48 , are macroscopic reaction rate constants and @xmath5 , @xmath6 are macroscopic diffusion coefficients .",
    "next ( instead of further nondimensionalization ) we simply choose values for the six kinetic parameters and we study the turing instabilities of the resulting model . in the rest of this paper , we put @xmath49 , @xmath50 , @xmath51 , @xmath52 , @xmath53 , @xmath54 .",
    "then the scaling of kinetic constants reads as follows @xmath55 passing the number @xmath36 of molecules in a box to infinity and the box length @xmath56 to zero , i.e. @xmath57 and @xmath58 , one can derive the following system of macroscopic partial differential equations for concentrations @xmath27 and @xmath29 .",
    "@xmath59 @xmath60 here , @xmath61 \\to [ 0,\\infty)$ ] , @xmath62 \\to [ 0,\\infty)$ ] and suitable boundary conditions ( e.g. no - flux , periodic ) must be introduced .",
    "considering no - flux or periodic boundary conditions , one can easily verify that the homogeneous steady state of eqs .",
    "( [ rd1 ] )  ( [ rd2 ] ) is given by @xmath63 @xmath64 .",
    "linearizing eqs .",
    "( [ rd1 ] )  ( [ rd2 ] ) , one sees that the homogeneous steady state is stable for @xmath65 , i.e. when no diffusion is present in the system .",
    "in fact , the same result holds whenever @xmath66 : no spatial patterning can be expected if the diffusion coefficients of both species are the same .",
    "however , turing @xcite showed that the homogeneous steady state @xmath67 might become unstable for @xmath68 . indeed , linearizing eqs .",
    "( [ rd1 ] )  ( [ rd2 ] ) , one finds that the steady state @xmath67 is unstable and spatial patterns develop if @xmath69 . in this paper , we fix the diffusion coefficient @xmath70 .",
    "spatial patterns may then develop for @xmath26 .",
    "we show numerically computed solutions of eqs .",
    "( [ rd1 ] )  ( [ rd2 ] ) with periodic boundary conditions for different values of the diffusion coefficient @xmath6 in fig .",
    "[ figilldet ] .",
    "the initial condition was chosen to be @xmath67 with small additive random noise .",
    "the graphs of @xmath27 ( red solid curve ) and @xmath29 ( blue dashed curve ) are plotted at dimensionaless time @xmath25 , and can be practically considered as steady states ; this has been confirmed also through a steady state solver . in fig .",
    "[ figstodet ] , we compare representative ssa results with the deterministic ones .",
    "we divide the domain @xmath7 $ ] into @xmath71 boxes and using @xmath72 ( i.e. , defining density scaling so that dimensionless density 1 corresponds to @xmath73 molecules of the relevant chemical species in a box ) and we choose the values of the parameters as in eq .",
    "( [ consca2 ] ) together with @xmath74 and @xmath75 .",
    "we will quantify the fluctuations of the stochastic simulations at stationarity below .",
    "and @xmath1 ) with respect to the diffusion coefficient @xmath6 . the diffusion coefficient for @xmath0",
    ", @xmath5 is fixed at @xmath76 .",
    "axis notation : @xmath77 and @xmath78 are the first fourier coefficients of the solution ( for @xmath79 and @xmath80 respectively ) .",
    "different steady state solution branches are plotted in different colors .",
    "solid ( dashed ) lines represent stable ( unstable ) steady states .",
    "the bifurcation points along the solution curves are marked by circles and denoted with the corresponding bifurcation type (  sn \" for saddle - node bifurcation and  pf \" for pitchfork bifurcation ) .",
    "the straight line represents the uniform steady state ( as shown in the solution profile for point 13 ) .",
    "the inset is a blowup of the bifurcation diagram for small @xmath6 .",
    "representative solution profiles ( solid ( dashed ) line for @xmath27 ( @xmath29 ) ) on different branches ( numbered and marked by `` @xmath81 '' ) are also included.,title=\"fig : \" ]   and @xmath1 ) with respect to the diffusion coefficient @xmath6 .",
    "the diffusion coefficient for @xmath0 , @xmath5 is fixed at @xmath76 .",
    "axis notation : @xmath77 and @xmath78 are the first fourier coefficients of the solution ( for @xmath79 and @xmath80 respectively ) .",
    "different steady state solution branches are plotted in different colors .",
    "solid ( dashed ) lines represent stable ( unstable ) steady states .",
    "the bifurcation points along the solution curves are marked by circles and denoted with the corresponding bifurcation type (  sn \" for saddle - node bifurcation and  pf \" for pitchfork bifurcation ) .",
    "the straight line represents the uniform steady state ( as shown in the solution profile for point 13 ) .",
    "the inset is a blowup of the bifurcation diagram for small @xmath6 .",
    "representative solution profiles ( solid ( dashed ) line for @xmath27 ( @xmath29 ) ) on different branches ( numbered and marked by `` @xmath81 '' ) are also included.,title=\"fig : \" ]    the computer - assisted study of turing patterns in a deterministic pde context requires the numerical computation and parametric continuation of steady states .",
    "spatially distributed pde steady states in a bifurcation diagram are , in general , computed by discretizing the pde into a ( sufficiently ) large set of odes of the type @xmath82 , finding the roots of @xmath83 and continuing them in parameter space . here",
    "@xmath84 is a vector containing the system state ( the discretized concentrations of @xmath0 and @xmath1 ) , @xmath85 is the right hand side of the discretization of eqs .",
    "( [ rd1 ] ) and  ( [ rd2 ] ) and @xmath86 is a @xmath87-dimensional parameter vector ; here @xmath88 since we consider the single parameter @xmath6 .",
    "pseudo - arclength continuation and branch switching are by now standard numerical tools that have been incorporated in special purpose packages like auto  @xcite or content  @xcite . for deterministic problems for which a good _ dynamic simulator _ is available , the so - called  timestepper - based \" approach allows the computation of bifurcation diagrams in the form of a  wrapper \" around the dynamic simulator ( see e.g. refs .",
    "@xcite ) . given the current state @xmath89 as an initial condition , the timestepper computes the future ( after a  reporting time \" @xmath90 ) state @xmath91 .",
    "steady states of the original system are then found as fixed points of @xmath92 where @xmath93 .",
    "the bifurcation diagram in fig .",
    "[ bifurdiagram ] has been computed in both ways ( giving , of course , identical results ) ; a discussion of some pertinent details can be found in the appendix . fixed point algorithms , like the newton - raphson iteration ,",
    "constitute the workhorse of these solutions of large sets of coupled , nonlinear algebraic equations ; these involve the repeated solutions of large sets of linear , coupled algebraic equations .",
    "consider now performing these repeated linear solves through _ matrix - free _ iterative linear solvers ( such as gmres  @xcite ) ; in a nonlinear equation context we will typically use a matrix - free newton - gmres solver  @xcite . for the timestepper - based computation ( solving the nonlinear system @xmath92 ) we do not need to compute the jacobian @xmath94 .",
    "we only need to compute matrix - vector products of this jacobian with given known vectors @xmath95 , which can be estimated by a finite different approximation @xmath96 /\\varepsilon$ ] with suitably small @xmath97 .",
    "such _ matrix - free _ linear algebra methods constitute an important component of _ equation - free _ bifurcation calculations . in this context macrosocopic ,",
    "coarse - grained equations are not explicitly available ; yet we believe they exist , and we do have available a fine - scale ( in this case , stochastic ) dynamic simulator . we can then _ substitute _ the ( unavailable ) deterministic timestepper with a fine scale , _ stochastic _ timestepper involving _ lifting _ , _ evolving _ , and _ restriction _ steps  @xcite .",
    "this provides an estimate of the ( unavailable ) deterministic timestepper for the ( unavailable ) closed macroscopic evolution equations , obtained _ on demand _ through the stochastic simulator .",
    "all computations of the matrix - free newton - gmres involve calls to such a timestepper ( with systematically chosen initial conditions ) ; the stochastic simulator can then be used to numerically compute coarse - grained bifurcation diagrams such as the one in fig .",
    "[ bifurdiagram ] even in the absence of closed macroscopic evolution equations ( i.e. , equation - free ) . in this paper",
    ", we propose an  equation - assisted \" approach that accelerates equation - free computations by linking approximate deterministic models with accurate stochastic ones : equation - free bifurcation computations ( based on the coarse timestepper ) are _ preconditioned _ using the timestepper of an ( approximate ) deterministic model .",
    "good discussions of the basic features of newton - gmres , as well as pseudocode and matlab implementations can be found in refs .",
    "consider solving a general set of @xmath98 nonlinear equations with @xmath98 unknowns , @xmath92 ; the linear equations to be solved at each newton step are of the form @xmath99 for @xmath100 , @xmath101 , @xmath102 with @xmath103 where @xmath104 is the current solution guess at each newton step .",
    "for every iterative linear solve , it is important to note that , at each iteration in gmres , only one call to @xmath105 is needed .",
    "gmres _ does not require _ the jacobian matrix @xmath106 to be computed explicitly .",
    "the jacobian matrix always occurs in the form of a matrix - vector product , which can be approximated by finite differences : @xmath107/h$ ] where @xmath56 is suitably small .",
    "when newton - gmres is used in steady state computations using the _ coarse _ timestepper ( i.e. @xmath108 , where @xmath109 is the coarse timestepper based on the stochastic simulator ) , each evaluation of @xmath110 involves evolving the coarse timestepper @xmath109 for time @xmath90 , which is often computationally intensive ; possibly several replica simulations need to be performed for variance reduction .",
    "it thus becomes an important task to reduce the total number of function evaluations to convergence . as discussed in ref .",
    "@xcite , gmres requires less overall function evaluations when the eigenvalues of the matrix ( i.e. , @xmath111 in eq .",
    "( [ precon ] ) ) are more clustered .",
    "for a given linear system in the form of eq .",
    "( [ precon ] ) , the preconditioning of gmres involves finding a regular matrix @xmath112 , such that the preconditioned linear system , @xmath113 leads to a more clustered eigenvalue spectrum . solving eq .",
    "( [ precon ] ) is equivalent to solving eq .",
    "( [ precon1 ] ) .",
    "it is well known that the system in eq .",
    "( [ precon1 ] ) will have better properties ( from a numerical point of view ) than the original system in eq .",
    "( [ precon ] ) if @xmath112 is close to the inverse of @xmath114 , i.e. if @xmath115 is small using a suitable matrix norm .",
    "hence , preconditioning by an appropriate matrix @xmath112 can improve the efficacy of numerical solvers for eq .",
    "( [ precon ] ) ; the goal of this paper is to show how this preconditioning idea can be applied to equation - free stochastic reaction - diffusion problems ( and spatially distributed evolution problems more generally ) .",
    "an _ approximate _ deterministic evolution equation for the stochastic system statistics may be available ( eqs .",
    "( [ rd1 ] ) and  ( [ rd2 ] ) ) , based on closure assumptions , which is not accurate enough to compute with ; yet we can take advantage of such an evolution equation by using it to create a  good \" preconditioning matrix @xmath116 .",
    "this preconditioning is implemented here by multiplying the original output of each ( stochastic simulation based ) evaluation of @xmath110 with @xmath117 , where @xmath118 is defined using the _",
    "mean field pde timestepper @xmath119 .",
    "that is , we use the deterministic timestepper of the approximate pdes ( here , at the current solution guess @xmath120 ) to help accelerate the equation - free netwon - gmres computation ; a much simpler preconditioning scheme would constantly use the inverse of the deterministic timestepper _ at the deterministic steady state_. at each newton step the linear equation set to be actually solved by gmres after preconditioning is @xmath121 for the one - dimensional problem used for illustration here , it is easy to compute @xmath122 for a given vector @xmath95 by solving @xmath123 through direct linear algebra ( e.g. gauss elimination ) . in general , however , it is worth noting that @xmath124 can be solved for @xmath125 with gmres , through repeated calls to the ( deterministic ) timestepper of the ( not - so - accurate ) deterministic pdes ( eqs .",
    "( [ rd1 ] ) and  ( [ rd2 ] ) ) .",
    "the y - axis is the norm of the ( coarse ) residual .",
    "the dashed line shows the estimated magnitude of the stochastic simulator fluctuations rescaled to account for replica averaging ( which we use to estimate the fluctuations in the evaluation of the coarse timestepper ) .",
    "the relative error of the corresponding solution guess at each newton step is shown in the insets ( solid ( dashed ) line for @xmath126(@xmath127 ) with y - axis ranging from -0.5 to 0.5 except the first one ) along the convergence curve .",
    "the converged coarse steady solution profiles are shown at the upper right .",
    "parameters used : @xmath128 boxes in the domain @xmath129 $ ] , @xmath130 , @xmath131 with 150 copies . ]    ) .",
    "the dashed line shows the estimated magnitude of the stochastic simulator fluctuations , rescaled to account for replica averaging ( which we use to estimate the fluctuations in the evaluation of the coarse timestepper ) .",
    "the upper right insets show the converged coarse steady solution profiles .",
    "parameters used : @xmath128 boxes in the domain @xmath129 $ ] , @xmath130 , @xmath131 with 150 copies . ]    , the coarse timestepper @xmath132 , and the coarse timestepper after preconditioning @xmath133 , which are all evaluated at the computed unstable coarse steady state .",
    "( a ) leading 40 ( smallest magnitude ) eigenvalues of @xmath134 .",
    "the eigenvalues have already started clustering at 1 .",
    "( b ) leading 40 eigenvalues of @xmath132 .",
    "this ( partial ) spectrum is very similar to the spectrum in ( a ) .",
    "the appearance of complex conjugate eigenvalue pairs close to 1 and eigenvalues larger than 1 as in ( b ) ( and possibly also in ( c ) ) is probably caused by the relatively large fluctuations in the evaluation of the coarse timestepper ( while the differences between the eigenvalues within this cluster are relatively small ) .",
    "( c ) leading 15 eigenvalues of @xmath135 .",
    "most of the eigenvalues are clustered close to 1 . ]    for our coarse timestepper ( based on ssa simulation ) , we discretize the one - dimensional domain [ 0 , @xmath136 with @xmath137 into @xmath128 equally spaced boxes .",
    "we choose @xmath138 , which means that the unit density in each box corresponds to 2000 molecules .",
    "each evaluation of the coarse timestepper corresponds to evolving 150 replicas of the ssa simulator for time @xmath130 ; the average of all replicas is reported .",
    "we have assumed that there exist some  underlying pdes \" that describe the evolution of the ( statistics of the ) ssa simulator averaged over an infinite number of copies . in our computations",
    "we estimate the coarse timestepper of these  underlying pdes \" by averaging over several ( here 150 ) copies ; even though averaging reduces their variance , fluctuations will always remain when a finite number of copies is used .",
    "note that we should not , in general , expect these  underlying pdes \" to be the same as the mean field pde system described in section  [ secmacropde ] ( eqs .",
    "( [ rd1 ] ) and  ( [ rd2 ] ) ) , which corresponds to the limit of _ infinite numbers of molecules_. we do , however , know that if the parameter @xmath36 increases to infinity , the  underlying pdes \" do converge to eqs .",
    "( [ rd1 ] ) and  ( [ rd2 ] ) .",
    "we start by using matrix - free newton - gmres to compute representative spatially nonuniform ( both stable and unstable ) coarse steady states through the ssa simulator .",
    "the newton - gmres fixed point solver used is adapted from the matlab code _",
    "@xcite with two modifications : ( a ) constant relative tolerance for each gmres solve ; and ( b ) since our preconditioner changes every time we update the current solution guess , an additional function for constructing the updated preconditioner was included as an additional input parameter . the convergence of newton - gmres to a coarse , spatially nonuniform , stable steady state ( point 2 in fig .",
    "[ bifurdiagram ] ) is shown in fig .",
    "[ stable_convergence ] .",
    "the magnitude of the fluctuations introduced by the stochastic simulator is estimated at this coarse steady state as follows : from long - term ssa simulations , after the stationary state has been reached , we estimate the standard deviation @xmath139 for each @xmath10 and @xmath140 @xmath141 ; our estimate of the magnitude of the fluctuations is the euclidean norm of this vector of standard deviations . averaging over @xmath142 replicas",
    "should scale this estimate by a factor of @xmath143 ; the resulting estimate is marked by a dashed line in figs .",
    "[ stable_convergence ] and  [ preconditioning ] .",
    "this number also provides an estimate of a reasonable expected residual norm upon convergence of the newton - gmres .    because of the presence of fluctuations in the evaluation of the coarse timestepper , an _ inexact _ matrix - vector product is computed at each gmres iteration .",
    "the convergence of gmres in the presence of noise is the focus of extensive study in the current literature ( see e.g. refs .",
    "these references include discussions of bounds of the attainable accuracy of the computed solution and possible relaxation strategies in the presence of noise . in the context of newton - gmres ,",
    "the right hand side of the linear equation we want to solve at each newton step ( i.e. @xmath144 ) is also computed with fluctuations .",
    "a representative _ unstable _ coarse steady state ( point 4 in the bifurcation diagram ) is also computed with newton - gmres . in this case , however , we also implemented the equation - assisted preconditioning of the coarse gmres , as discussed in section  [ sectheory ] , using the inverse of the corresponding jacobian computed from the known deterministic approximate pdes .",
    "the convergence of newton - gmres before and after preconditioning ( that is equation - free and equation - assisted , respectively ) is compared in fig .",
    "[ preconditioning ] .",
    "the leading parts of the eigenvalue spectra of @xmath134 , @xmath132 ( the first 40 eigenvalues ) and @xmath145 ( the first 15 eigenvalues ) evaluated at the coarse steady state are computed using the coarse timestepper and the iterative eigenvalue solver arpack ( implemented in matlab as function _ eigs _ ) and shown in fig .",
    "[ eig_spectrum ] .",
    "a quick inspection of the numerically computed leading spectra shows that , after preconditioning , the eigenvalues of the preconditioned jacobian based on the coarse timestepper were indeed more clustered close to 1 , consistent with the reduction in gmres iterations observed in fig .",
    "[ preconditioning ] .",
    "note that the first vector in the krylov subspace constructed for gmres ( @xmath146 ) is generally obtained by setting the initial solution guess for the linear system to zero .",
    "this implies that @xmath146 is _ different _ for the preconditioned and unpreconditioned gmres ( @xmath147 and @xmath148 for the linear system eq .",
    "( [ precon ] ) , respectively , where @xmath116 is the preconditioner ) .",
    "since all the subsequent vectors in the krylov subspace are built upon the first ones , this may also lead to a difference in the number of gmres iterations to convergence .",
    "figure  [ preconditioning ] shows the cumulative calls to the coarse timestepper needed to reduce the _",
    "nonlinear residual _ , which is similarly defined for both the preconditioned and the unpreconditioned case .",
    "the results indicate that the preconditioner is effective in reducing the nonlinear residual , and efficient in terms of overall timestepper evaluations .",
    "the preconditioned and unpreconditioned _ linear _ residuals , on the other hand , are measured in different norms ( @xmath149 and @xmath150 ) ; we impose the same _ relative _ tolerance for convergence . for",
    "non - noisy problems and very tight relative termination tolerances , the results of the two types of linear solve at the end of the first newton step would be practically the same ; with larger termination tolerances , given the presence of noise , this is clearly not the case . when the initial guess is far away from the true solution ( at the first newton step ) the initial tolerance for gmres can be set relatively high , to avoid  oversolving \" the linear equation at the early stages of convergence",
    "the purpose of this paper is to illustrate a simple idea : that coarse - grained , macroscopic equations can be used to assist detailed , fine scale stochastic simulations even when they are not really accurate .",
    "this is accomplished by using certain features of such closed - form macroscopic equations ( such as their discretized linearizations ) as _ preconditioners _ in equation - free iterative linear algebra computations .",
    "this is then an  equation - assisted \" approach : we compute with a coarse timestepper based on the fine scale model , but accelerate the convergence of these computations using  the best available \" continuum deterministic model .    in this paper",
    "we illustrated the concept using a coarse timestepper based on a _ spatially distributed _",
    "ssa reaction - diffusion implementation of the schnakenberg kinetic scheme , and preconditioning with the corresponding jacobian derived from the mean - field pdes .",
    "this allowed us to accelerate the equation - free computation of both stable and unstable spatially structured reaction - diffusion steady states .",
    "the approach can be used as a computational  wrapper \" around different types of inner stochastic simulators .",
    "the inner simulator was based on spatially discretized ssa ; the approach could also be wrapped around  already accelerated \" ssa schemes ( e.g. those exploiting separation of time scales  @xcite ) .",
    "the approach could also be wrapped around non - ssa , lattice gas spatially distributed kinetic monte carlo simulators , or around simulators based on  the best available \" analytically coarse - grained models of kinetic monte carlo processes ( e.g. refs .",
    "it can also be wrapped around different ( non - kmc ) types of fine scale or hybrid models such as lattice - boltzmann inner simulators @xcite ( with density pde preconditioning ) , or around molecular , brownian or dissipative particle dynamics simulators of condensed matter problems , with the preconditioning coming from traditional continuum closures ( elasticity theory , non - newtonian rheology ) . beyond steady state computations",
    ", such preconditioning might also be helpful in other coarse - grained computations involving matrix - free iterative linear algebra , such as implicit coarse integration schemes .",
    "this work was partially supported by the u.s .",
    "department of energy ( igk , lq through pppl ) and darpa , by the nsf ( dms-0404537 , ctk ) and by the biotechnology and biological sciences research council , university of oxford and linacre college , oxford ( re ) .",
    "it is a pleasure for the authors to acknowledge helpful suggestions by giovanni samaey and wim vanroose during the preparation of this manuscript .",
    "the bifurcation diagram with respect to the diffusion coefficient @xmath6 of species @xmath1 is computed using both the steady state and the deterministic timestepper approach with identical results and is plotted in fig .",
    "[ bifurdiagram ] .",
    "we used the following parameters in our computations with the deterministic timestepper from the discretized ode system : domain length @xmath137 , number of nodes @xmath128 , time reporting horizon @xmath151 .",
    "the stability of the steady state solutions is identified by checking the leading eigenvalues ( @xmath152 ) of the jacobian matrix of the linearized ode system evaluated at the steady states ; we confirmed that the eigenvalues of the linearization of our timestepper at steady state ( @xmath153 ) indeed satisfy @xmath154 .",
    "the matrix - free eigenvalue solver arpack is used to compute the leading eigenvalues for both the deterministic and the coarse timsteppers .",
    "the first two fourier coefficients of the steady state solution , @xmath77 and @xmath78 ( for @xmath79 and @xmath80 respectively ) , are plotted versus the bifurcation parameter @xmath6 .",
    "the ( partial ) bifurcation diagram consists of four different branches of solutions ( plotted in different colors ) .",
    "the steady states computed in this bifurcation diagram show at most one peak due to the relatively short domain length .",
    "steady states with @xmath142 peaks ( as shown in fig .",
    "[ figilldet ] ) can be easily obtained by using @xmath142 copies of the one - peak solution as building blocks ; yet the stabilities of the multi - peak and one - peak steady states are not the same ( see e.g. ref ."
  ],
  "abstract_text": [
    "<S> spatially distributed problems are often approximately modelled in terms of partial differential equations ( pdes ) for appropriate coarse - grained quantities ( e.g. concentrations ) . </S>",
    "<S> the derivation of accurate such pdes starting from finer scale , atomistic models , and using suitable averaging , is often a challenging task ; _ approximate _ pdes are typically obtained through mathematical closure procedures ( e.g. mean - field approximations ) . in this paper , we show how such _ approximate _ macroscopic pdes can be exploited in constructing _ </S>",
    "<S> preconditioners _ to accelerate stochastic simulations for spatially distributed particle - based process models . </S>",
    "<S> we illustrate how such preconditioning can improve the convergence of equation - free coarse - grained methods based on coarse timesteppers . </S>",
    "<S> our model problem is a stochastic reaction - diffusion model capable of exhibiting turing instabilities . </S>"
  ]
}