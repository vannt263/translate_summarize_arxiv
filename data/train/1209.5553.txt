{
  "article_text": [
    "in the subsurface , producing geothermal systems are characterized by coupled hydraulic , thermal , chemical and mechanical processes . to determine the potential of a geothermal site , and decide optimal production strategies , it is important to understand and quantify these processes . rigorous mathematical modeling and accurate numerical simulations are essential , but multiple interacting processes acting on different scales leads to challenges in solving the coupled system of equations .",
    "standard discretization methods include finite element , control - volume and finite difference methods for the space discretization ( see @xcite and references therein ) , while standard implicit , explicit or implicit - explicit methods have until recently mostly been used for the discretization in time @xcite .",
    "challenges with the discretization are , amongst others , related to severe time - step restrictions associated with explicit methods and excessive numerical diffusion for implicit methods .",
    "furthermore , implicit methods require at each time step the solution of large systems of nonlinear equations , which may lead to bottlenecks in practical computations .    in this paper , we consider a different approach for the temporal discretization based on the exponential rosenbrock ",
    "euler method ( erem ) and rosenbrock - type methods ( rosm ) .",
    "exponential integrators have recently been suggested as efficient and robust alternatives for the temporal discretization for several applications ( see @xcite .",
    "rosenbrock - type methods have been intensively developed in the literature and used in a variety of applications ( see @xcite and reference therein ) .",
    "however , neither of these approaches have yet found wide - spread use in porous media applications .",
    "the mathematical model discussed , consists of a system of partial differential equations that express conservation of mass and energy .",
    "in addition , the model entails phenomenological laws describing processes active in the reservoir , such as darcy s law for fluid flow with variable density and viscosity , fourier s law of heat conduction , and those describing the relation between fluid properties ( nonlinear fluid expansivity and compressibility ) and porosity subject to pressure and temperature variations .",
    "the resulting system of equations is nonlinear and coupled and requires sophisticated numerical techniques .",
    "our solution technique is based on a sequential approach , which decouples the mathematical model .",
    "an advantage of this approach is that it allows for specialized solvers for unknowns with different characteristics .",
    "as the linearized fully coupled matrices are often very poorly conditioned such that small time - steps are required , a carefully chosen sequential approach leads to higher efficiency and accuracy than a simultaneous solution approach if the couplings are not too strong @xcite .",
    "a finite volume method is applied for the space discretization while the exponential rosenbrock  euler method and rosenbrock - type methods are applied to integrate the systems in time based on successive linearizations .",
    "the exponential rosenbrock ",
    "euler method is based on the linearization of the odes resulting from the space discretization at each time step .",
    "the linear part is solved exactly in time up to a given tolerance in the computation of a matrix exponential function of the jacobian .",
    "the nonlinear part is approximated using low - order taylor expansions .",
    "as in all exponential integrator schemes , the expense is the computation of the matrix exponentials of the stiff jacobian matrix resulting from the spatial discretization . computing matrix exponentials of stiff matrices is a notorious problem in numerical analysis @xcite , but new developments for both lja points and krylov subspace techniques @xcite have led to efficient numerical approaches ; see e.g. @xcite and references therein . besides , the method is l - stable , and performs well for super - stiff odes .",
    "the rosenbrock - type methods use the appropriate rational functions of the jacobian from the spatial discretization .",
    "the parameters in these schemes are found in consistency with the required order of convergence in time . as a result",
    "these schemes are a - stable ( as will be discussed below ) and only few linear systems are solved at each time step .",
    "the paper is organized as follows .",
    "we present the model equations in section 2 , and the finite volume method for spatial discretization in section 3 , along with temporal discretization schemes .",
    "the implementation of the exponential rosenbrock - euler method is discussed in section 4 . in section 5",
    "we present some numerical examples , which also include simulations for a fractured reservoir , and show comparisons to standard approaches , before we draw conclusions in section 6 .",
    "we assume single - phase flow of water , which allows the energy equation to be written in terms of temperature .",
    "the model equations are given by @xmath0 ( see @xcite ) .",
    "the model equations are given in the bounded spatial domain @xmath1 , with boundary @xmath2 , and in the time interval is @xmath3 $ ] . here",
    "@xmath4 is the porosity ; @xmath5 is the heat transfer coefficient ; @xmath6 is the heat production ; @xmath7 is the density ; @xmath8 stand for heat capacity ; @xmath9 is the temperature ; @xmath10 is the thermal conductivity tensor , with the subscripts @xmath11 and @xmath12 referring to fluid and rock ; and @xmath13 is the darcy velocity given by @xmath14 where @xmath15 is the permeability tensor , @xmath16 is the viscosity , @xmath17 is the gravitational acceleration and @xmath18 the pressure .",
    "the mass balance equation for a single - phase fluid is given by @xmath19 where @xmath20 $ ] is contribution from a source or sink per time unit .",
    "assuming in equation ( [ masscon ] ) that the rock is slightly compressible , the porosity is a function of pressure and can be expressed as a linear function , yielding @xmath21 with @xmath22 where @xmath23 is the porosity at the initial pressure , @xmath24 the initial pressure and @xmath25 the bulk vertical compressibility of the porous medium .",
    "notice that @xmath26 where @xmath27 and @xmath28 are respectively the thermal fluid expansivity and its compressibility defined by @xmath29    inserting equation ( [ masscon3 ] ) and ( [ rockcomp ] ) in equation ( [ masscon2 ] ) yields @xmath30 the state functions @xmath16,@xmath31 and @xmath32 can found @xcite .",
    "the model problem is therefore to find the functions @xmath33 satisfying the nonlinear equations ( [ heat ] ) and ( [ masscon4 ] ) subject to ( [ darcy ] ) .",
    "notice if @xmath34 we have the equilibrium state of the heat with @xmath35 .",
    "we use the finite volume method@xcite on a structured mesh @xmath36 , with maximum mesh size @xmath37 .",
    "we denote by ( @xmath38 ) the family of control volumes of mesh @xmath36 .",
    "the finite volume method space discretization consists in :    1 .",
    "integrate each equations of ( [ heat ] ) and ( [ masscon4 ] ) over each control volume @xmath38 .",
    "2 .   use the divergence theorem to convert the volume integral into the surface integral in all divergence terms .",
    "use two - point flux approximations for diffusion heat and flow fluxes @xcite @xmath39 4 .   use the standard upwind weighting @xcite for the convective ( advective ) flux @xmath40    here we denote by @xmath41 the unit normal vector to @xmath42 outward to @xmath43 and @xmath44 the elementary surface measure .",
    "for an edge @xmath45 of the control volume @xmath43 , @xmath46 will denote the unit normal vector to @xmath45 outward to @xmath47 .",
    "let us illustrate the spatial discretization of the second equation of ( [ heat ] ) on a structured mesh @xmath36 ( the two - point flux approximation is sufficient for so - called @xmath48-orthogonal grids ) .",
    "we denote by @xmath49 the set of interior edges of the control volumes of @xmath50 . for any function @xmath51",
    ", @xmath52 denotes the approximation of @xmath51 at time @xmath53 at the center of the control volume @xmath54 and @xmath55 the approximation of @xmath51 at time @xmath53 at the center of the edge @xmath45 . for a control volume @xmath56 ,",
    "we denote by @xmath57 the set of edges of @xmath47 , @xmath58 the lebesgue measure of the control volume @xmath54 , @xmath59 the edge interface between the control volume @xmath47 and the control volume @xmath60 , @xmath61 the distance between the center of the control volume @xmath47 and center of the control volume @xmath62 , and @xmath63 the distance between the control volume @xmath47 and the edge @xmath45 . letting @xmath64",
    ", we therefore have @xmath65 these approximations are for interior edges and dirichlet boundary condition . for a neumann boundary condition ,",
    "@xmath66 is naturally given .",
    "in the case of a discrete - fracture model , we make adjustments to the spatial discretization following the approach in @xcite .    to determine the convective fluxes , we set @xmath67 .",
    "standard upwind weighting yields @xmath68    reorganizing these space approximations yield the following system of odes @xmath69 for a given initial pressure @xmath70 , with corresponding initial velocity @xmath71 ) and initial temperature @xmath72 , the technique used in the paper consists in solving successively the systems @xmath73 and @xmath74 the odes ( [ spaceheat1 ] ) is usualy stiff since the smaller absolute value of the eigenvalues of the jacobian matrix is usually closed to zero .",
    "we now present our numerical methods for the odes ( [ spaceheat1 ] ) based on the sequential approach . considering a sequential solution approach ,",
    "we start by presenting low order time discretization schemes and their stability properties before we give some higher order schemes .",
    "we briefly describe the standard integrators that will be used for comparison with exponential rosenbrock - euler method and rosenbrock - type methods .",
    "consider the odes ( [ spaceheat2 ] ) and ( [ spaceheat3 ] ) within the interval @xmath76,\\,\\tau>0 $ ] .",
    "given a time - step @xmath77 , applying the @xmath78euler scheme with respect to the function @xmath79 in the odes ( [ spaceheat2 ] ) yields @xmath80 for @xmath81 the scheme is implicit and given the approximate solutions @xmath82 and @xmath83 at time @xmath84 , the solution @xmath85 at time @xmath86 is obtained by solving the nonlinear equation @xmath87 which is solved using the newton method . for efficiency , all linear systems are solved using the matlab function bicgstab with ilu(0 ) preconditioners with no fill - in , which are updated at each time step .    to solve the odes ( [ spaceheat3 ] ) we apply again the @xmath75-euler method , but with respect to @xmath88 , yielding @xmath89 for @xmath90 the @xmath75-euler scheme is second order in time , and for @xmath91 the scheme is first order in time . in this paper ,",
    "the standard sequential approach to solve the odes ( [ spaceheat ] ) consists of applying successively the schemes ( [ temscheme ] ) and ( [ prescheme ] ) .      to introduce the exponential euler - rosenbrock method (",
    "also called exponential euler method ) , let us first consider the following system of odes @xmath92\\\\ \\mathbf{y}(0)=\\mathbf{y}_{0 } , \\end{array}\\right.\\end{aligned}\\ ] ] which appear after spatial discretisation of semilinear parabolic pdes . here",
    "@xmath93 is a stiff matrix and @xmath17 a nonlinear function .",
    "this allows us to write the exact solution of ( [ extraodes ] ) as @xmath94 given the exact solution at the time @xmath84 , we can construct the corresponding solution at @xmath86 as @xmath95 note that the expression in ( [ exactnu ] ) is still an exact solution .",
    "the idea behind exponential time differencing ( etd ) is to approximate @xmath96 by a suitable polynomial  @xcite .",
    "the simplest case is when @xmath96 is approximated by the constant @xmath97 .",
    "the corresponding ( etd1 ) scheme is given by @xmath98 where @xmath99 note that the etd1 scheme in ( [ etd ] ) can be rewritten as @xmath100    this new expression has the advantage that it is computationally more efficient as only one matrix exponential function needs to be evaluated at each step .",
    "recently , the etd1 scheme was applied to advection - dominated reactive transport in heterogeneous porous media @xcite .",
    "for this problem , a rigorous convergence proof is established for the case of a finite volume discretization in space @xcite . in these works , it was observed that the exponential methods were generally more accurate and efficient than standard implicit methods .",
    "as our systems ( [ spaceheat2 ] ) and ( [ spaceheat3 ] ) are nonlinear , we need to linearize before applying the etd1 scheme .",
    "consider the system the odes ( [ spaceheat2 ] ) .",
    "for simplicity we assume that it is autonomous @xmath101    let @xmath82 and @xmath83 be the numerical approximations of the exact solutions @xmath102 and @xmath103 . to obtain the numerical approximation @xmath85 of the exact solution @xmath104 , we linearize @xmath105 at @xmath82 and obtain the following semilinear odes @xmath106 where @xmath107 denotes the jacobian of the function @xmath108 respect to @xmath79 and @xmath17 the remainder given by @xmath109 applying the etd1 scheme to ( [ linear ] ) yields @xmath110 this scheme , called the exponential rosenbrock - euler method ( erem)@xcite ( or the exponential euler method ( eem ) ) has been reinvented in different names ( see references in @xcite ) .",
    "the erem scheme is second order in time @xcite for autonomous problems . to deal with non - autonomous problems , while conserving the second order accuracy of eerm scheme , it must first be converted to autonomous problems .",
    "the corresponding version is given in the next section by equation([neermg ] ) .",
    "the scheme ( [ eerm ] ) contains the exponential matrix function @xmath111 . to obtain the simplest rosenbrock - type methods ,",
    "the exponential function is approximated by the following rational function @xmath112 where @xmath113 is a parameter . for a given parameter @xmath113 , using the approximation ( [ ratapp ] ) in equation ( [ eerm ] ) , the corresponding rosenbrock - type method ( also called linear implicit methods ) is given by @xmath114    for the parameter @xmath115 , the corresponding rosenbrock - type method is order two in time for regular solutions and order 1 if @xmath116 . to solve the odes ( [ spaceheat3 ] )",
    "we apply again the erem scheme or the rosenbrock - type method ( [ ros ] ) , but with respect to @xmath88 , which yields respectively @xmath117 and @xmath118 as with @xmath78euler methods , the sequential approaches with the exponential rosenbrock - euler method and rosenbrock - type methods proposed in this paper consists in solving the odes ( [ spaceheat ] ) by applying successively the schemes ( [ eerm ] ) and ( [ ros ] ) to the odes ( [ spaceheat2 ] ) and the schemes ( [ eerm1 ] ) and ( [ ros1 ] ) to the odes ( [ spaceheat3 ] ) .",
    "the sequential technique presented is the so called trotter splitting and is generally first order accurate@xcite .",
    "the alternative technique is the so called strang splitting which consists to apply the schemes ( [ eerm ] ) and ( [ ros ] ) to the odes ( [ spaceheat2 ] ) with time step @xmath119 , afterward apply the schemes ( [ eerm1 ] ) and ( [ ros1 ] ) to the odes ( [ spaceheat3 ] ) with time step @xmath77 and then apply again the schemes ( [ eerm ] ) and ( [ ros ] ) to the odes ( [ spaceheat2 ] ) with time step @xmath119 .",
    "strang splitting is formally second -order accurate in time for sufficiently smooth solution @xcite .",
    "we can obviously observe that this approach is less efficient than trotter splitting .",
    "trotter splitting and strang splitting are called multiplicative operator splittings .    in the sequel",
    ", sequential approach will mean trotter splitting .",
    "one of the important features of any numerical scheme is its stability properties .",
    "our goal here is to study the stability properties of the schemes presented in the previous section and high order rosenbrock - type methods .",
    "a special interest will be given to two rosenbrock - type methods of order two and three because of their good stability properties .",
    "in applying the high order rosenbrock - type methods , we will use the previously presented sequential approaches to solve the odes ( [ spaceheat2 ] ) and ( [ spaceheat3 ] ) .    consider the following odes @xmath120\\\\ \\mathbf{y}(0)=\\mathbf{y}_{0 } , \\end{array}\\right.\\end{aligned}\\ ] ] where @xmath121 is nonlinear function .",
    "the corresponding @xmath78euler scheme is given by @xmath122 note that the exponential rosenbrock ",
    "euler method presented in the previous section is for autonomous odes . before applying it to non - autonomous system ( [ extraodes1 ] )",
    ", transformation @xmath123 must be performed to obtain autonomous odes .",
    "given the numerical solution @xmath124 , the linearization equation leading to @xmath125 is given by @xmath126 & = & \\left [ \\begin{array}{cc }          d_{\\mathbf{y}}\\mathbf{f}(\\mathbf{y}^{n},t_{n } ) & d_{t}\\mathbf{f}(\\mathbf{y}^{n},t_{n})\\\\            0 & 0\\\\         \\end{array } \\right ] \\left [ \\begin{array}{c }          \\mathbf{y}(t)\\\\            t         \\end{array } \\right ] + \\left [ \\begin{array}{c }         \\mathbf{g}_{n } ( \\mathbf{y}(t),t)\\\\            1         \\end{array } \\right ] \\newline\\\\ \\mathbf{g}_{n } ( \\mathbf{y}(t),t)&=&\\mathbf{f}(\\mathbf{y}(t),t)-d_{\\mathbf{y}}\\mathbf{f}(\\mathbf{y}^{n},t_{n})\\mathbf{y}(t)-d_{t}\\mathbf{f}\\ , t.     \\ ] ] using this transformation and ( * ? ? ?",
    "* lemma 1 ) , the corresponding erem scheme for non - autonomous system is given by @xmath127    the exponential functions @xmath128 are defined by @xmath129 these functions satisfy the recurrence relations @xmath130    the corresponding lower order rosenbrock - type methods is given by @xmath131 . \\ ] ] in order to study their stability properties , we apply the @xmath78euler , erem and rosm schemes to the linear odes @xmath132 with constant time step @xmath133 .",
    "we therefore have @xmath134 where @xmath135 for the @xmath78euler scheme , @xmath136 for the erem scheme and @xmath137 for the rosm scheme .",
    "the function @xmath138 is called the stability function of the method .",
    "the set @xmath139    is called the stability domain of the method . a numerical method is a -stable if its stability domain @xmath140 satisfies @xmath141 let us study the a - stability of the @xmath78euler .",
    "let @xmath142 , we have @xmath143    we can therefore observe that the @xmath78euler scheme is a -stable if @xmath144 rosm scheme is a -stable if @xmath145 and erem scheme is a -stable .",
    "a - stability is not the whole answer to the problem of stiff equations , excellent numerical methods for super - stiff equations would be l - stable .",
    "numerical methods are l - stable if they are a - stable and in addition ( see @xcite ) @xmath146 we can observe that the @xmath78euler scheme is l - stable if @xmath147 , the rosm scheme is l - stable if @xmath148 and the erem scheme is l - stable .    in the sequel we will use the rosm schemes with @xmath148 and @xmath115 , which will be denoted respectively by rosm@xmath149 and rosm@xmath150 .",
    "the s - stage rosenbrock - type methods for the ode ( [ extraodes1 ] ) are given by @xmath151 the coefficients @xmath152 are obtained by using the consistency conditions required to achieve the desirable order of convergence @xmath18 in time .",
    "different ways to find these coefficients are presented in the literature ( see @xcite and references therein ) .",
    "the approximation @xmath153 is called an embedded approximation associated to the s - stage rosenbrock - type approximation @xmath154 and is used to control the local errors for adaptivity purpose . the coefficients @xmath155 are determined using the consistency conditions such that the embedded approximation is order @xmath156 . in this work ,",
    "we use the second order scheme ros2(1 ) , where the coefficients are given in table  [ ros2 ] , and also the third order scheme denoted ros3p in @xcite , which uses additional conditions to avoid order reduction ( see table  [ ros3 ] ) .",
    "the ros2(1 ) scheme is l - stable and the ros3p scheme is a - stable ( see @xcite ) .",
    ".coefficients of the ros2(1 ) scheme from @xcite . [ cols=\"<,<\",options=\"header \" , ]     the implementation of rosenbrock - type schemes is straightforward as there are no nonlinear equations to solve at each time step . for efficiency , all linear systems are solved using the matlab function bicgstab with ilu(0 ) preconditioners with no fill - in .",
    "the time step adaptivity can be performed using the standard error control and the step size prediction as in @xcite with an appropriate norm of @xmath157 .",
    "the key element in all exponential integrator schemes is the computation of the matrix exponential functions , the so called @xmath158 functions .",
    "there are many techniques available for that task@xcite .",
    "standard pad approximation compute at every time step the whole matrix exponential functions and are therefore memory and time consuming for large problems .",
    "krylov subspace technique and the real fast leja points technique are proved to be efficient for this computation for large systems @xcite .",
    "let us summarize these techniques while solving ode ( [ extraodes1 ] ) with the erem scheme .",
    "the main idea of the krylov subspace technique is to approximate the action of the exponential matrix function @xmath159 on a vector @xmath13 by projection onto a small krylov subspace @xmath160  @xcite .",
    "the approximation is formed using an orthonormal basis of @xmath161 $ ] of the krylov subspace @xmath162 and of its completion @xmath163 $ ] .",
    "the basis is found by arnoldi iteration , which uses stabilized gram - schmidt to produce a sequence of vectors that span the krylov subspace ( see algorithm  [ alg : al2 ] ) .",
    "let @xmath164 be the @xmath165 standard basis vector of @xmath166 .",
    "we approximate @xmath167 by @xmath168 with @xmath169.\\ ] ] the coefficient @xmath170 is recovered in the last iteration of arnoldi s iteration in algorithm  [ alg : al2 ] .",
    "we denote by @xmath171 the standard euclidan norm .",
    "the approximation ( [ approphi ] ) is the first two terms of the expansion given in ( * ? ? ?",
    "* theorem 2 ) .",
    "initialise : @xmath172 @xmath173 @xmath174 @xmath175 @xmath176 @xmath177    for a small krylov subspace ( i.e , @xmath178 is small ) a standard pad approximation can be used to compute @xmath179 , but an efficient way used in  @xcite is to recover @xmath180 directly from the pad approximation of the exponential of a matrix related to @xmath181 .    notice that this implementation can be done without explicit computation of the jacobian matrix @xmath182 as the krylov subspace @xmath162",
    "can be formed by using the following approximations @xmath183 for a suitably chosen perturbation of @xmath184 ( see @xcite ) , while solving the ode ( [ extraodes1 ] ) .",
    "these approximations prove that the exponential rosenbrock - euler scheme with the krylov subspace technique can be implemented using the free jacobian technique .",
    "the implementations in expokit  @xcite ( for function @xmath185 ) and in @xcite use the truncation error in the approximation ( [ approphi ] ) to build the local error estimates ( see ( * ? ? ?",
    "* theorem 2 ) ) . the time step subdivisions depend on the given tolerance and the local errors .",
    "this technique has been successfully applied to the nonlinear advection diffusion - reaction - equation in @xcite where advection plays a key role",
    ". we will used it to solve the temperature equation ( [ spaceheat2 ] ) .",
    "the key points of this method are as follows : for a given vector @xmath13 , real fast ljapoints approximate @xmath186 by @xmath187 , where @xmath188 is an interpolation polynomial of degree @xmath178 of @xmath128 at the sequence of points @xmath189 called spectral real fast ljapoints .",
    "these points @xmath190 belong to the spectral focal interval @xmath191 $ ] of the matrix @xmath192 , i.e. the focal interval of the smaller ellipse containing all the eigenvalues of @xmath193 .",
    "this spectral interval can be estimated by the well known gershgorin circle theorem  @xcite .",
    "it has been shown that as the degree of the polynomial increases , and hence the number of ljapoints increases , superlinear convergence is achieved  @xcite ; i.e. , @xmath194 set @xmath195 , the sequence of fast lja points is generated by @xmath196 } { \\max } \\underset { k=0}{\\prod^{j-1}}\\mid \\xi-\\xi_{k } \\mid \\quad j=1,2,3,\\cdots.\\end{aligned}\\ ] ] given the newton s form of the interpolating polynomial , @xmath188 is given by @xmath197 + \\underset{j=1}{\\sum ^{m}}\\varphi_{i}\\left [ \\xi_{0},\\xi_{1 } , \\cdots,\\xi_{j}\\right ] \\underset{k=0}{\\prod^{j-1}}\\left ( z-\\xi_{k } \\right)\\end{aligned}\\ ] ] where the divided differences @xmath198 $ ] are defined recursively by @xmath199 : = \\varphi_{i}(\\xi_{0}),\\;\\ ; d_{1}=\\varphi_{i}\\left [ \\xi_{0},\\xi_{1}\\right]:=\\dfrac{\\varphi_{i}\\left[\\xi_{1}\\right]-\\varphi_{i}\\left[\\xi _ { 0}\\right]}{\\xi_{1}-\\xi_{0}}.\\\\ d_{i}= \\varphi_{i}\\left [ \\xi_{0},\\xi_{1},\\cdots,\\xi_{i}\\right]=\\dfrac{\\varphi_{i}\\left[\\xi_{0},\\xi_{1},\\cdots,\\xi_{i-2 } , \\xi_{i } \\right]-\\varphi_{i}\\left[\\xi_{0},\\xi_{1},\\cdots,\\xi_{i-2},\\xi_{i-1 } \\right]}{x_{i}-x_{i-1}}. \\end{array}\\right.\\end{aligned}\\ ] ] due to cancelation errors , this standard procedure can not produce accurate divided differences with magnitude smaller than machine precision .",
    "it can be shown @xcite that the divided differences of a function @xmath200 of the independent variable @xmath201 at the points @xmath202 $ ] are the first column of the matrix function @xmath203 , where @xmath204 here @xmath205 is the identity matrix . to compute @xmath206 , where @xmath207 is the first standard basis vector of @xmath208",
    ", we apply taylor expansion of order @xmath18 with scaling and squaring or pad approximation @xcite .",
    "the interest of the newton interpolation comes from the fact that the approximation with a polynomial of degree @xmath178 is directly obtained from the approximation with a polynomial of degree @xmath209 , in fact we have @xmath210 the error estimate from this approximation is given by @xmath211 where @xmath212 is the weighted and scaled norm defined by @xmath213 where @xmath214 and @xmath215 denote respectively the desirable absolute and relative tolerance , and @xmath216 the size of the matrix @xmath182 .",
    "following the work in @xcite , during the evaluation of the @xmath217 functions , the stopping criterion is @xmath218 where @xmath219 being the order of convergence of the method ( @xmath220 for the scheme erem ) . in order to filter possible oscillations in the error estimate ,",
    "the average on the last five previous values of the errors is used instead of @xmath221 in the stopping condition . in the case of an unaccepted degree @xmath178 , we increase the degree of the polynomial following relation ( [ newt ] ) .",
    "when the degree @xmath178 for convergence is too large , the time step @xmath77 has to be split as described in @xcite .",
    "the algorithm with the function @xmath111 is given in @xcite .",
    "for the case where the spectral of @xmath182 is more spread along the imaginary axis , as for example in some hyperbolic problems , the method has been upgraded in @xcite .",
    "the attractive computational features of the method are clear in the sense that there is no krylov subspace to store or linear systems to solve , but a drawback is that the method is based on interpolation , which is generally ill - conditioned .",
    "a major drawback is that the required degree of the polynomial grows with the norm of the matrix @xmath222 .",
    "in the two examples , we deal with temperatures between 0 and @xmath223 .",
    "the water thermal expansivity @xmath27 and its compressibility @xmath28 used is from @xcite .",
    "these two state functions depend on both pressure and the temperature .",
    "as we are dealing with low - enthalpy reservoirs ( @xmath224 ) , some water properties can be well approximated as a function of temperature only .",
    "the water density in @xmath225 and the fluid viscosity in @xmath226 ( see @xcite ) used are given respectively by @xmath227 and @xmath228 the water heat capacity in @xmath229 used is also function of the temperature only in the interval @xmath230 and given by ( see @xcite ) @xmath231 the water thermal conductivity used is @xmath232 .",
    "we take the heat transfer coefficient @xmath233 sufficiently large to reach the local equilibrium .",
    "all our tests were performed on a workstation with a 3 ghz intel processor and 8 gb ram .",
    "our code was implemented in matlab 7.11 .",
    "we also used part of the codes in @xcite for the spatial discretization .",
    "the absolute tolerance in the krylov subspace technique , leja point technique , newton iterations and all linear systems is @xmath234 .",
    "the dimension in the krylov technique used is @xmath235 .",
    "the initial pressure used is the steady state pressure with water properties at the initial temperature . in the legends of all of our graphs we use",
    "the following notation    * `` implicittheta=1 '' denotes results from the theta euler with @xmath236 in([spaceheat2 ] ) and ( [ spaceheat3 ] ) .",
    "* `` implicittheta=0.5 '' denotes results from the theta euler with @xmath90 in([spaceheat2 ] ) and ( [ spaceheat3 ] ) .",
    "* `` eremkleja '' denotes results from erem scheme with krylov subspace for matrix exponential in the pressure system ( [ spaceheat3 ] ) and real fast leja points for matrix exponential in the temperature system ( [ spaceheat2 ] ) .",
    "* `` eremkrylov '' denotes results from erem scheme with krylov subspace for matrix exponential in ( [ spaceheat2 ] ) and ( [ spaceheat3 ] ) . *",
    "`` rosm(1 ) '' denotes results from the the scheme rosm with @xmath148 in([spaceheat2 ] ) and ( [ spaceheat3 ] ) . * `` rosm(1/2 ) '' denotes results from the the scheme rosm with @xmath115 in([spaceheat2 ] ) and ( [ spaceheat3 ] ) . *",
    "`` ros2 '' denotes results from the scheme ros2(1 ) in([spaceheat2 ] ) and ( [ spaceheat3 ] ) . *",
    "`` ros3p '' denotes results from the scheme ros3p in([spaceheat2 ] ) and ( [ spaceheat3 ] ) .",
    "we use different constant time steps with the goal to study the convergence of the temperature and pressure equation at the final time along with the efficiency of numerical schemes .",
    "the reference solutions used in the calculation of the errors are the numerical solutions with the time step size equal to the half of the lower time step in the graphs .",
    "we consider a heterogeneous reservoir described by the domain @xmath237 \\times \\left[0,1\\right ] \\times \\left[0,0.1\\right],$ ] where all distances are in km . the half upper part of the reservoir is less permeable than the lower part .",
    "the injection point is located at the position @xmath238,$ ] injecting with the rate @xmath239 , and the production is at @xmath240,$ ] with rate @xmath241 with the lowest pressure at the point @xmath242 .",
    "homogeneous neumann boundary conditions are applied for both the pressure equation , given by the mass conservation law , and the energy equation .",
    "the water temperature at the injection well is @xmath243 .",
    "the upper half of the reservoir has rock properties : permeability @xmath244 darcy , porosity @xmath245 , @xmath246 , @xmath247,@xmath248 while rock properties of the lower half are : permeability @xmath249 darcy , porosity @xmath250 , @xmath251 , @xmath252,@xmath253 . in the two part the bulk vertical compressibility @xmath254 .",
    "we use a structured parallelepiped mesh .",
    "the size of the system is @xmath255 for the odes ( [ spaceheat3 ] ) and @xmath256 for the odes ( [ spaceheat2 ] ) .",
    "the initial temperature at @xmath257 is @xmath258 and the temperature increases @xmath259 at every 10 m.    the initial temperature field is presented in figure  [ fig01a ] , the temperature field at @xmath260 days is shown in figure  [ fig01b ] while figure  [ fig01c ] shows the temperature at @xmath261 days .",
    "we can observe that the cold water decreases reservoir temperature at injection well and that the temperature at the production well increases .",
    "figure  [ fig01d ] shows how the temperature errors at the final time @xmath260 days decrease with time step size . from this figure",
    "we can observe that the schemes with the same order of convergence in time have almost the same errors with our sequential approach .",
    "we can also observe that for large time steps , the errors are almost the same for all the schemes . the implicit @xmath75-euler method with @xmath236 and the rosm(1 ) are both of order @xmath262 in time .",
    "this order may decrease up to 1 for less smooth solutions @xcite or relatively small time steps as for simple problems these schemes are order 1 .",
    "we can observe that the erem scheme and the implicit @xmath75-euler method with @xmath90 are slightly more accurate than the ros2 scheme .",
    "erem scheme and the implicit @xmath75-euler method with @xmath90 are @xmath263 in time , the ros2(1 ) scheme is order @xmath264 and the ros3p scheme is order @xmath265 .",
    "this order may decrease for less smooth solutions @xcite .",
    "we can however observe that schemes with high orders in time for simple problems are affected by order reduction in the sequential approach .",
    "figure  [ fig01e ] shows the relative @xmath266 temperature errors as the function of the cpu time corresponding to figure  [ fig01d ] .",
    "we can observe the efficiency of the erem scheme comparing the others schemes .",
    "this figure also shows that the exponential rosenbrock - euler method and rosenbrock- type methods are very efficient as compared to the standard implicit @xmath75-euler methods .",
    "figure  [ fig01f ] shows the cpu time as a function of time step size corresponding to figure  [ fig01d ] and figure  [ fig01e ] .",
    "we can clearly observe that the exponential rosenbrock - euler method and rosenbrock- type methods are again very efficiency compared to standard implicit @xmath75-euler methods . from this figure",
    "we can observe that erem scheme , rosm(1 ) and rosm(1/2 ) schemes are at least five time as efficient , the ros2 is at least twice as efficient and the ros3p at least one and half time as efficient as the standard methods . while these factors may be dependent on the particular implementation , and the availability of good nonlinear solvers for the nonlinear solves in the standard methods , we believe them to be representative .",
    "0.01 0.01 0.01 0.01      we consider here a 2 d fractured reservoir @xcite , with a quasi - structured triangular mesh in the domain @xmath267 \\times \\left[0,100\\right ] $ ] , where all distances are in m. the matrix properties are : permeability @xmath268 darcy , porosity @xmath269 , @xmath252,@xmath246 , @xmath248 and @xmath270 .",
    "the fractures have an aperture of @xmath271 and a permeability of @xmath272 darcy .",
    "the injection point is located at the position @xmath273 , with constant pressure @xmath274mpa , while the production point is located at the point @xmath275 , with constant pressure @xmath276pa .",
    "homogeneous neumann boundary conditions are applied for both the pressure equation given by the mass conservation law and the energy equation .",
    "the size of the system is @xmath277 for the odes ( [ spaceheat3 ] ) and @xmath278 for the odes ( [ spaceheat2 ] ) . the initial temperature is @xmath279 while the water temperature at the injection well is @xmath280 .",
    "the 2d grid with fractures is shown in figure  [ fig02a ] , the temperature field at time @xmath281 days in figure  [ fig02b ] and the temperature field at the time @xmath282 days in figure  [ fig02c ] .",
    "figure  [ fig02d ] shows the pressure field at time @xmath281 days .",
    "figure  [ fig03a ] shows the time convergence of the all the schemes as the temperature errors decrease with time step size at the final time @xmath281 days . from this figure",
    "we can observe again that the schemes with the same order of convergence in time have almost the same errors .",
    "the implicit @xmath75-euler method with @xmath236 and the rosm(1 ) are order @xmath283 in time .",
    "the erem scheme , the @xmath75-euler method with @xmath90 and the ros2(1 ) scheme are order @xmath284 in time while the ros3p scheme is order @xmath265 . these orders may increase for relatively small time steps .",
    "again we can observe that schemes with high orders in time for simple problems are affected by order reduction in the sequential approach .",
    "figure  [ fig03b ] shows the relative @xmath266 temperature errors as function of the cpu time corresponding to figure  [ fig03a ] . as in the first example",
    ", we can observe the efficiency of the schemes rosm(1/2 ) and erem with the krylov technique compared to the others schemes .",
    "figure  [ fig03c ] shows the cpu time as a function of time step size , corresponding to figure figure  [ fig03a ] and figure  [ fig03b ] .",
    "again we observe that erem scheme , rosm(1 ) and rosm(1/2 ) schemes are almost four times as efficient as the standard implicit methods , while the ros2 and the ros3p are almost twice as efficient as the standard implicit methods .",
    "from these examples , we expect the efficiency gain to increase with the size of the problem .",
    "the relative @xmath266 pressure errors are almost the same for all the numerical schemes .",
    "we therefore plot only the errors for two numerical schemes with order 1 and 2 in time respectively .",
    "figure  [ fig03a ] shows the pressure errors at time @xmath281 days as a function of time step size for the erem scheme and @xmath75-euler method with @xmath236 .",
    "we can observe the convergence of those schemes while solving the pressure equation .",
    "the order of convergence in time is @xmath285 and may decrease according to @xcite for rough solutions ( less smooth solutions ) .",
    "we have proposed a novel approach for simulation of geothermal processes in heterogeneous porous media .",
    "this approach decouples the mass conservation equation from the energy equation and solves each stiff odes from space discretization sequentially using the exponential rosenbrock - euler method and rosenbrock - type methods for the time integration .",
    "numerical simulations in 2d and 3d show that using the krylov subspace technique and real leja points technique in the computation of the exponential functions @xmath128 in the exponential rosenbrock - euler method , and the matlab function bicgstab with ilu(0 ) preconditioners with no fill - in for solving all linear systems appearing in the rosenbrock - type methods and the implicit euler theta methods , makes our approach more efficient compared to the sequential standard implicit euler methods .",
    "we thank tor harald sandve for sharing with us the 2d fractured grid and its discretization .",
    "this work was funded by the research council of norway ( grant number 190761/s60 ) .",
    "l.  bergamaschi ,  m.  caliari and m.  vianello . the relpm exponential integrator for fe discretizations of advection - diffusion equations , in : m.  bubak , g.  d.   van albada , p.  sloot ( eds . ) , lecture notes in computer sciences volume 3039 , springer verlag , berlin heidelberg , 2004 , pp . 434 - 442 .",
    "d.   coumou , t.  driesner , s.   geiger , c.  a.   heinrich and s.   k.   matthi .",
    "the dynamics of mid - ocean ridge hydrothermal systems : splitting plumes and fluctuating vent temperatures .",
    ", 245 , pp . 218231 , 2006 .",
    "s.  geiger , t.   driesner , c.   a ..   heinrich and s.   k.   matthi .",
    "multiphase thermohaline convection in the earthcrust : i. a new finite element  finite volume solution technique combined with a new equation of state for nacl - h2o . , ( 63):399434 , 2006 .",
    "d. o. hayba and s.  ingebritsen .",
    "the computer model hydrotherm , a three - dimensional finite  difference model to simulate ground  water flow and heat transport in the temperature range of 0 to @xmath286 . ,",
    "1994 .",
    "r.  podgorney , h.  huang and d.  gaston .",
    "massively parallel fully coupled implicit modeling of coupled thermal - hydrological - mechanical processes for enhanced geothermal system reservoirs , , 2010 , sgp - tr-188 ."
  ],
  "abstract_text": [
    "<S> simulation of geothermal systems is challenging due to coupled physical processes in highly heterogeneous media . combining the exponential rosenbrock  euler and rosenbrock - type methods with control - volume ( two - point flux approximation ) space discretizations </S>",
    "<S> leads to efficient numerical techniques for simulating geothermal systems . in terms of efficiency and accuracy , the exponential rosenbrock  </S>",
    "<S> euler time integrator has advantages over standard time - dicretization schemes , which suffer from time - step restrictions or excessive numerical diffusion when advection processes are dominating . </S>",
    "<S> based on linearization of the equation at each time step , we make use of matrix exponentials of the jacobian from the spatial discretization , which provide the exact solution in time for the linearized equations . </S>",
    "<S> this is at the expense of computing the matrix exponentials of the stiff jacobian matrix , together with propagating a linearized system . </S>",
    "<S> however , using a krylov subspace or leja points techniques make these computations efficient . </S>",
    "<S> the rosenbrock - type methods use the appropriate rational functions of the jacobian from the spatial discretization . </S>",
    "<S> the parameters in these schemes are found in consistency with the required order of convergence in time . as a result , these schemes are a - stable and only a few linear systems are solved at each time step . the efficiency of the methods compared to standard time - discretization techniques are demonstrated in numerical examples .    </S>",
    "<S> exponential integration , krylov subspace , ljapoints , rosenbrock - type methods , fast time integrators , geothermal systems </S>"
  ]
}