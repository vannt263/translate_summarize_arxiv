{
  "article_text": [
    "it is well known that stars are generically rotating on the main sequence and , in particular , massive stars are rapid rotators  @xcite .",
    "although the distribution of angular momentum in the stellar interior is poorly known except for the sun , it is expected that the inner portion is rotating more rapidly than the outer part as the star evolves and the central part of the star contracts .",
    "in fact some recent theoretical studies on the evolution of rotating stars have demonstrated that massive stars in their late evolutionary phases develop a central core that is rotating more rapidly than the outer envelopes  @xcite .",
    "hence the differential rotation is supposed to exist quite commonly in the stellar interior especially at the advanced stages of evolution .",
    "the above - mentioned works on the evolution of rotating stars ignore non - spherical deformations of stars and the angle - averaged centrifugal force is added as a correction to the spherical models .",
    "this is not justified , however , if the star is rotating rapidly and the physical conditions on the rotation axis and on the equatorial plane are substantially different .",
    "then the rotational equilibrium should be properly taken into account",
    ". this will be particularly important for the investigation of the progenitors of gamma ray bursts , since they are supposed to be driven by the gravitational collapse of very rapidly rotating massive stars  @xcite",
    ".    over the years substantial effort has been made to numerically obtain configurations in rotational equilibrium in various contexts .",
    "beginning with the pioneering works by @xcite , a robust iterating formula was developed by  @xcite and was extended to general relativistic and/or magnetized stars  @xcite .",
    "the polytropic equation of state ( eos ) was replaced by more generic ones  @xcite .",
    "one of the limitations of these studies that hamper the application to the study on the evolution of rotating stars , putting aside the treatment of convections and meridional circulations , is the assumption that the whole star is rotating cylindrically , that is , the angular velocity is constant on each of the concentric cylinders and , as a result , the eos is barotropic , that is , the pressure is a function of density alone  @xcite . on the contrary ,",
    "the theoretical studies based on the spherical models indicate clearly that the stellar core and envelopes composed of different elements rotate rather independently of each other , since the steep gradient of mean molecular weight tends to suppress the transport of angular momentum beyond the boundary of elements .",
    "if one attempts to employ the rotational equilibrium configurations in the study of the post - main - sequence evolutions of massive stars , therefore , it is almost mandatory to treat multiple layers that obey different rotation - laws .    motivated by these facts , we present a new formulation to numerically construct non - relativistic configurations in rotational equilibrium , which consist of multiple layers .",
    "we assume that each layer rotates still cylindrically but the rotation - law , namely the angular velocity as a function of the distance from the rotation axis , can be different from layer to layer .",
    "this assumption allows us to employ the conventional formula based on the bernoulli equation in each layer , a big advantage over the original partial differential equations .",
    "the eos should be barotropic in each layer accordingly .",
    "we then introduce a junction condition , that is , the continuity of pressure at the boundary of the layers to combine them in such a way that the whole star is in rotational equilibrium . in this paper , mainly for demonstration purposes , we obtain two - layered configurations with each layer having different polytropic eos s for three representative rotation - laws:(1 ) @xmath0-constant law ( rigid rotation ) , ( 2 ) @xmath1-constant law and ( 3 ) @xmath2-constant law ( see the next section for the exact definitions of these rotation laws ) . in principle , there is no problem in treating different rotation - laws and/or a larger number of layers .",
    "the paper is organized as follows . in sec .",
    "[ sec : basic ] , we describe the new formulation to obtain rotational equilibrium configurations with multiple layers , explaining numerical issues in detail .",
    "section  [ sec : res ] is devoted to the demonstration of some model computations . in sec .",
    "[ sec : sum ] , we give some discussions and summarize the paper .",
    "in this paper the configurations in rotational equilibrium are assumed to be axisymmetric and steady with dissipative processes being neglected .",
    "possible meridian flows are also ignored .",
    "then the basic equations are @xmath3 where the spherical coordinates are used and the subscript @xmath4 refers to each component .",
    "the gravitational potential , mass density , pressure , angular velocity and gravitational constant are denoted by @xmath5 , @xmath6 , @xmath7 , @xmath8 and @xmath9 , respectively . for a barotropic eos , i.e. , @xmath10 , which we assume for each layer throughout this paper , the left hand side of eq .",
    "( [ eq : hydro2 ] ) can be integrated . the second term on the right hand side ( rhs ) of eq .",
    "( [ eq : hydro2 ] ) , on the other hand , can be also integrated if the angular velocity is a function of the cylindrical radius , i.e. , @xmath11 . as representative cases ,",
    "the following three rotation laws are chosen in this paper although there is no limitation in principle : @xmath12 in these expressions , @xmath13 , @xmath14 and @xmath15 are constants that specify how fast the rotation is for each rotation law whereas @xmath16 is a constant that gives a radius of the cylinder , inside which the rotation is almost rigid .",
    "the second and third rotation laws are referred to as the @xmath1-constant and @xmath2-constant laws , respectively , according to their limits of @xmath17 .",
    "the first rotation law is also called @xmath0-constant law .",
    "as already mentioned , the constants @xmath13 , @xmath14 , @xmath15 and @xmath16 can be different from layer to layer for multi - layered configurations .",
    "the values of these constants in the @xmath4-th layer ( see fig .  [",
    "fig : multi ] . )",
    "are represented by the subscript @xmath18 in the following .    the integration of eq .",
    "( [ eq : hydro2 ] ) in each layer gives the so - called bernoulli equation , @xmath19 where @xmath20 is a specific enthalpy defined by @xmath21 as a function of the mass density alone and @xmath22 is called a bernoulli constant .",
    "the second term on rhs corresponds to the rotational potential and is given for each rotation law as @xmath23 where the amplitude , @xmath24 , is expressed separately for later convenience .",
    "note that the bernoulli constants can be different from layer to layer .",
    "it is well known that the barotropic condition is equivalent to the requirement that the angular velocity be a function of the cylindrical radius alone , i.e. , @xmath11  @xcite . in this article , we assume a different rotation law for each layer , which means that the angular velocity is not a function of the cylindrical radius alone even if the rotation law is cylindrical in each layer . as a result , the eos can not be a single continuous barotropic one .",
    "in fact , the angular velocity is discontinuous across the layer boundary , which leads in general to the discontinuity in density as shown later . on the other hand ,",
    "the pressure is continuous at the layer boundary , which can be understood as follows : multiplied by the density , eq .",
    "( [ eq : hydro2 ] ) is written at the layer boundary as @xmath25 the right hand side ( rhs ) of this equation contains step functions , that is , the density and angular velocity .",
    "note that the gravitational potential , which is obtained by the integration of the density , is continuous .",
    "then the pressure is also continuous because otherwise the left hand side of eq .",
    "( [ eq : hydro3 ] ) would give a delta function .",
    "this in turn leads to the conclusion that a single continuous barotropic eos can not be applied across the layer boundary , since the pressure could not be continuous for the discontinuous density for such an eos .",
    "therefore , eos s that are barotropic in each layer but different from layer to layer are required .",
    "as the simplest example , we employ in this article polytropic eos s with a different polytropic constant and/or index in each layer .",
    "the essential points of our formula are summarized as follows : ( 1 ) the rotational equilibrium is locally ensured by the bernoulli equation in each layer and ( 2 ) the layer boundary is the location where the layers are joined so that the pressure should become continuous .",
    "the problem is now reduced to the solution of eqs .",
    "( [ eq : ber ] ) and ( [ eq : gravity ] ) and the search of the location where the pressures of the different layers coincide . before discussing multi - layered configurations",
    ", we briefly review the hachisu self - consistent field ( hscf ) scheme  @xcite , which is known to be a very robust algorithm to solve iteratively eqs .",
    "( [ eq : ber ] ) and ( [ eq : gravity ] ) for single - layered configurations in rotational equilibrium and on which our formula is based . in this scheme , we first introduce the following non - dimensional variables : @xmath26 where @xmath27 , @xmath28 and @xmath29 are the maximum density , pressure and speed of light , respectively , and the subscript @xmath4 is dropped in @xmath30 , @xmath16 , @xmath29 and @xmath31 .",
    "the radius is normalized by the equatorial radius of the equilibrium configuration , @xmath32 , which is unknown a priori and is expressed as @xmath33 by the introduction of a new variable @xmath34 .",
    "then eqs .",
    "( [ eq : ber ] ) and ( [ eq : gravity ] ) are reduced to @xmath35 in eqs .",
    "( [ eq : ber2 ] ) and ( [ eq : pois2 ] ) , we have two unknown functions @xmath36 and @xmath37 and three constants @xmath34 , @xmath38 , and @xmath39 once the eos and rotation law ( [ eq : rot0]-[eq : rot2 ] ) are specified . it is noted that the specific enthalpy @xmath31 is a function of the density alone because of the barotropic condition . in the hscf method , we give @xmath27 , the equatorial radius @xmath40 and polar radius @xmath41 instead of @xmath34 , @xmath42 and @xmath39 to specify the model and the latter three are treated as unknown variables to be solved .",
    "note that @xmath40 is unity by the definition of @xmath34 ( see eq .",
    "( [ eq : defofbeta ] ) ) .",
    "this choice of variables is essential for the hscf scheme .",
    "indeed other choices such as @xmath27 and @xmath38 ( and @xmath43 ) fail to obtain convergence in the iteration ( see below ) more often than not .    the two unknown functions @xmath36 and @xmath37 and three unknown constants @xmath34",
    ", @xmath38 , and @xmath39 are obtained iteratively in the hscf method as follows .",
    "first we give a trial density distribution @xmath44 and solve eq .",
    "( [ eq : pois2 ] ) to obtain @xmath45 . as a second step , eq .",
    "( [ eq : ber2 ] ) is evaluated at the following points : the stellar surfaces on the equator and on the rotation axis and the point of the maximum density , which are denoted as @xmath46 , @xmath47 and @xmath48 , respectively ( see fig .",
    "[ fig : multi ] ) .",
    "@xmath49 where we made use of the fact that the enthalpy vanishes on the stellar surface .",
    "note that the radius , @xmath50 , of point c is not known a priori . for the rigid rotation @xmath51 is independent of @xmath16 .",
    "we solve eqs .",
    "( [ eq : hac0 ] ) and ( [ eq : hac1 ] ) with respect to @xmath39 and @xmath38 for @xmath36 obtained in the first step . with these values of @xmath38 and @xmath39 , we then search for the location where the rhs of eq .",
    "( [ eq : hac2 ] ) takes the maximum value . the maximum of the rhs of eq .",
    "( [ eq : hac2 ] ) thus obtained gives @xmath34 in turn .",
    "we are now in a position to update @xmath37 , solving the bernoulli equation ( [ eq : ber2 ] ) for @xmath52 and @xmath39 obtained so far .",
    "we then repeat the procedure until a sufficient convergence is achieved .",
    "we move on to the multi - layered case .",
    "although , for simplicity , we consider only two - layered structures in the following , the extension to configurations with a larger number of layers is straightforward .",
    "then we have again two unknown functions @xmath36 and @xmath37 and this time five constants @xmath34 , @xmath53 , and @xmath54 in eqs .",
    "( [ eq : ber ] ) and ( [ eq : gravity ] ) .",
    "another important function to be determined is the layer boundary expressed by a function @xmath55 .",
    "just as in the single layer case , the choice of variables and the iteration scheme are critically important to make the scheme convergent .",
    "we first write down the equations employed to obtain the unknown constants , which correspond to eqs .",
    "( [ eq : hac0])-([eq : hac2 ] ) for the single - layered case . as explained above",
    ", the pressure should be continuous across the layer boundary . employing this condition on the equator ( point @xmath56 in figure  [ fig : multi ] ) and on the rotation axis ( point @xmath57 in the same figure ) , we write down the bernoulli equation for both sides of the layer boundary at these points : @xmath58 where we omit @xmath59 over the normalized variables for notational simplicity and @xmath60 , @xmath61 are the radii of points @xmath56 and @xmath57 , respectively . note that @xmath62 because the eos s are different from layer to layer .",
    "we employ the previous conditions at points @xmath46 , @xmath47 and @xmath48 , which are written as @xmath63 note that in eq .",
    "( [ eq : cond7 ] ) we do not know a priori in which layer the maximum density point @xmath48 lies . using eqs .",
    "( [ eq : cond2])-([eq : cond7 ] ) we can determine for the given eos s and rotation laws seven unknown constants out of @xmath34 , @xmath64 , @xmath65 , @xmath66 , @xmath67 , @xmath68 , @xmath69 , @xmath70 , @xmath60 , @xmath61 , in which @xmath71 and @xmath72 .",
    "this implies that one can give three constants to specify the model .",
    "as argued shortly , however , @xmath69 and @xmath61 as well as @xmath68 and @xmath60 can not be specified independently .",
    "this can be understood by considering a non - rotating but two - layered configuration . in this case",
    "one can construct an equilibrium configuration by integrating eq .",
    "( [ eq : hydro2 ] ) radially from the center to @xmath61 with the use of the gravitational potential @xmath73 .",
    "then it is obvious that @xmath69 depends on @xmath61 and vice versa ( note that the maximum density is also fixed ) .",
    "going back to the multi - layered rotational case , we have found that the combination of @xmath70 , @xmath61 and @xmath60 is a good choice .",
    "the triplet of @xmath70 , @xmath74 and @xmath68 can be an alternative .",
    "note that the inclusion of @xmath70 seems to be mandatory as has been demonstrated by the hscf scheme . to summarize , eqs .",
    "( [ eq : cond2])-([eq : cond7 ] ) are used to obtain either @xmath34 , @xmath66 , @xmath67 , @xmath64 , @xmath65 , @xmath68 and @xmath69 for given @xmath70 , @xmath60 and @xmath61 or @xmath34 , @xmath66 , @xmath67 , @xmath64 , @xmath65 , @xmath60 and @xmath61 for given @xmath70 , @xmath68 and @xmath69 .",
    "now we proceed to the iteration scheme proposed in this paper . after solving the poisson equation for the trial density distribution , eqs .",
    "( [ eq : cond2])-([eq : cond7 ] ) are solved for the variables chosen in the previous section .",
    "the procedure is divided into the following three steps : + ( 1 ) @xmath64 and @xmath66 are calculated from eqs .",
    "( [ eq : cond5 ] ) and ( [ eq : cond6 ] ) as @xmath75 ( 2 ) for a trial value of @xmath34 , @xmath68 and @xmath69 are obtained from eqs .",
    "( [ eq : cond2 ] ) and ( [ eq : cond4 ] ) and , combined with eqs .",
    "( [ eq : cond1 ] ) and ( [ eq : cond4 ] ) , give @xmath65 as @xmath76 then @xmath67 is obtained from eq .",
    "( [ eq : cond1 ] ) or ( [ eq : cond3 ] ) .",
    "+ ( 3 ) the point that gives the largest value to @xmath77 is searched in layer 1 and is referred to as point @xmath78 . the counter part in layer 2",
    "is then looked for and is called point @xmath79 .",
    "the point @xmath48 is found by comparing @xmath78 and @xmath79 to @xmath56 .",
    "the maximum value thus obtained is divided by @xmath80 with the appropriate @xmath4 and the updated value of @xmath34 is obtained .",
    "the steps ( 2 ) and ( 3 ) are repeated until the value of @xmath34 converges at a sufficient level .",
    "the final step of the iteration is the updates of the density distribution and the location of the layer boundary .",
    "this is accomplished as follows . regarding the specific enthalpy as a function of pressure alone",
    ", we first solve the bernoulli equation , eq .",
    "( [ eq : ber ] ) , for each layer in the absence of the other layer and the layer boundary as a result : @xmath81 where @xmath82 is an inverse function of the specific enthalpy for layer @xmath4 . since the pressure should be continuous at the layer boundary as discussed in sec .",
    "[ sec : bs ] , we look for a point on each radial ray ( a line with @xmath83 const . ) , at which @xmath84 and @xmath85 coincides with each other .",
    "this gives the updated layer boundary as @xmath86 . on the other hand , @xmath87 and @xmath88",
    "obtained above give the updated density distribution for each layer .",
    "this closes the iteration procedure .",
    "we go back to the poisson equation and repeat all the steps until a sufficient level of convergence is reached .",
    "to demonstrate that the new formula described above really works , we will apply it to two - layered configurations for some representative rotation laws . for simplicity ,",
    "we employ two polytropic eos s , @xmath89 , in which @xmath90 and @xmath91 are the polytropic constants and indices for layer @xmath4 .",
    "we take rather arbitrarily @xmath92 and @xmath93 in cgs unit and @xmath94 .",
    "note that the specific enthalpy is given as @xmath95 for layer @xmath4 .",
    "adopting @xmath96 we obtain white dwarf - like configurations .",
    "we work with the normalized variables ( eqs .",
    "( [ eq : nor1])-([eq : nor2 ] ) ) and the numerical domain covers a quadrant of the meridian section , @xmath97 and @xmath98 , under the assumption of equatorial symmetry .",
    "we typically deploy 1000 mesh points on the @xmath99-coordinate and 200 grid points on the @xmath100-coordinate to obtain an acceptable accuracy , which is confirmed by the normalized virial equation  @xcite defined as @xmath101 where @xmath102 and @xmath103 are the rotational , gravitational and internal energies , respectively .",
    "the ratio should vanish for exact solutions .",
    "note finally that the poisson equation is solved by the green function method employed by  @xcite .      as a mandatory step ,",
    "we first construct a non - rotational configuration with two layers according to the present formula and compare it with the solution obtained by the ordinary and much simpler method , that is , the radial integration . setting @xmath104 and @xmath105",
    ", we obtain @xmath106 from eq .",
    "( [ eq : h01 ] ) and @xmath107 from eqs .",
    "( [ eq : cond2 ] ) and ( [ eq : cond4 ] ) that are actually identical with each other",
    ". then , eq .  ( [ eq : h02 ] ) gives @xmath108 because the first term vanishes owing to @xmath106 and the second term is also zero because of @xmath107 . as a consequence , eq .",
    "( [ eq : cond1 ] ) becomes identical with eq .",
    "( [ eq : cond3 ] ) .",
    "it should be noted that @xmath109 even in the non - rotational case , since the eos s are different between two layers .",
    "table  [ tab : test ] summarizes the comparison of the non - rotating configuration obtained by the new formulation , which is referred to as `` 2d '' in the table , with the solution of the one - dimensional hydrostatic equation obtained by the radial integration from center to surface , which is called `` 1d '' .",
    "the radius , mass and the bernoulli constants in 2d , which characterize the equilibrium configuration , nicely agree with the 1d counter parts .",
    "indeed , the relative errors in these quantities are less than one percent and the normalized virial is of the order of @xmath110 , both of which indicate that the present method can reproduce the non - rotational configuration .",
    ".[tab : test ] comparison of the non - rotational two - layered configurations obtained by the ordinary method ( 1d ) and the present formula ( 2d ) . the radius , mass in cgs unit and normalized virial are denoted by @xmath111 , @xmath112 , and @xmath113 , respectively . for this model",
    "we adopt @xmath114 . [",
    "cols=\"^,^,^,^,^,^\",options=\"header \" , ]                                                            heger ,  a. , & langer ,  n. , 2000 , apj , 544 , 1016 heger ,  a. , woosley ,  s.  e. , & spruit ,  h.  c. , 2005 , apj , 626 , 350 hirschi ,  r. , meynet ,  g. , & maeder ,  a. , 2004 , astron .",
    "astrophys . , 425 , 649 jackson ,  s. ,  macgregor ,  k.  b. , & skumanich ,  a. , 2005 , apjs , 156 , 245    kiuchi ,  k. & kotake ,  k. , 2008 , mnras , 385 , 1327 kiuchi ,  k. & yoshida ,  s. , 2008 , prd , 78 , 044045 kiuchi ,  k. , kotake ,  k. & yoshida ,  s. , 2009 , apj , 698 , 541 komatsu ,  h. , eriguchi ,  y. , & hachisu ,  i. , mnras , 237 , 355 ( 1989 ) , 239 , 153 ( 1989 )      limongi ,  m. , straniero ,  o. , & chieffi ,  a. , 2000 apj , 129 , 625 macgregor ,  k.  b. , jackson ,  s. , skumanich ,  a. , % metcalfe ,  t.  s. , 2007 apj , 663 , 560 ostriker ,  j.  p. , & mark ,  j.  , w - k . , 1968 , apj , 151 , 1075"
  ],
  "abstract_text": [
    "<S> we present a new formula to numerically construct configurations in rotational equilibrium , which consist of multiple layers . </S>",
    "<S> each layer rotates uniformly or differentially according to cylindrical rotation - laws that are different from layer to layer . assuming a different barotropic equation of state ( eos ) for each layer </S>",
    "<S> , we solve the bernoulli equation in each layer separately and combine the solutions by imposing continuity of the pressure at each boundary of the layers . </S>",
    "<S> it is confirmed that a single continuous barotropic eos is incompatible with the junction condition . identifying appropriate variables to be solved , we construct a convergent iteration scheme . for demonstration , we obtain two - layered configurations , each layer of which rotates rapidly with either an `` @xmath0-constant law '' or a `` @xmath1-constant law '' or a `` @xmath2-constant law '' . </S>",
    "<S> other rotation laws and/or a larger number of layers can be treated similarly . </S>",
    "<S> we hope that this formula will be useful in studying the stellar evolution in multi - dimension with the non - spherical configuration induced by rotation being fully taken into account . </S>"
  ]
}