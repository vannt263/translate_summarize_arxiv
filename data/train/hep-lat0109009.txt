{
  "article_text": [
    "this paper looks at the iterative solution of complex , non - hermitian systems of linear equations associated with a lattice qcd problem in particle physics .",
    "let the @xmath0 by @xmath0 system of equations be @xmath1 .",
    "we use a version of the gmres method that deflates eigenvalues and can solve systems with multiple right - hand sides .",
    "we give examples that show deflating eigenvalues can make a significant improvement in the convergence for qcd matrices .",
    "we work with the non - hermitian wilson - dirac matrix @xmath2 given by , @xmath3 , \\end{aligned}\\ ] ] because we perfer to consider systems for which multiple - mass shifts are possible .",
    "our lattice here is of size @xmath4 .",
    "after the standard even / odd preconditioning , the lattice qcd problem has the form , @xmath5 where @xmath6 is of dimension 248,832 .",
    "we set @xmath7 , which for this size matrix and beta value ( 6.0 ) means working essentially at @xmath8 .",
    "we consider a typical , non - exceptional configuration , @xmath9 . the method is designed to efficiently solve the multiple right - hand sides of @xmath10 that occur when the all to all \" propagators used for disconnected diagrams are calculated .",
    "we will use multiple right - hand sides formed with z(2 ) noise vectors .",
    "the matrix is not extremely sparse , with about 200 nonzeros per row .",
    "krylov subspace methods are iterative methods for solving large systems of linear equations . with approximate solution @xmath11 , and residual vector @xmath12 ,",
    "the linear equations can be recast as @xmath13 then the krylov subspace of dimension @xmath14 for this problem is @xmath15 the conjugate gradient method is for hermitian problems , and gmres  @xcite is a well - known krylov method for the non - hermitian case .",
    "the effectiveness of krylov methods is often controlled by the distribution of eigenvalues .",
    "the existence of small eigenvalues can significantly slow the convergence rate .",
    "this motivates attempts to remove or deflate some eigenvalues from the effective spectrum for an iterative method .",
    "the gmres method fully orthogonalizes a basis for the krylov subspace .",
    "as the iteration proceeds , the expense and storage both grow .",
    "this makes occasional restarting necessary .",
    "we refer to each pass through the gmres iterations between restarts as a `` cycle '' .",
    "several approaches have been proposed for deflating eigenvalues from gmres ; see  @xcite for references . for deflation in qcd problems , see @xcite .",
    "our approach differs from previous qcd deflation in that the eigenvalue problem is solved simultaneously with the linear equations .    in this paragraph",
    ", we describe the method for the first right - hand side .",
    "after the first gmres cycle , approximate eigenvectors called harmonic ritz vectors , are computed from the same krylov subspace generated for solving the linear equations .",
    "let the approximate eigenvectors corresponding to the @xmath16 approximate eigenvalues of smallest modulus be @xmath17 .",
    "for the next cycle , the subspace used for gmres is @xmath18 having the approximate eigenvectors in the subspace accomplishes two things .",
    "the corresponding eigenvalues are deflated once the approximate eigenvectors are moderately accurate .",
    "also the approximate eigenvectors are improved as the method proceeds .",
    "it sometimes takes several cycles to improve the approximate eigenvectors to the point that they are useful .",
    "this method is called gmres - dr ( gmres with deflated restarting )  @xcite .",
    "gmres - dr gives the approximate eigenvectors in the form of a short arnoldi - type recurrence @xmath19 where @xmath20 is an @xmath0 by @xmath16 orthonormal matrix who s columns span the subspace of approximate eigenvectors , and @xmath21 is a full @xmath22 by @xmath16 matrix .",
    "now we look at solving the second and subsequent right - hand sides .",
    "we use the eigenvector information that was generated in solving the first right - hand side",
    ". an efficient approach in which the eigenvalues are deflated outside of the gmres cycles with a simple projection is called gmres - proj  @xcite . with the short arnoldi - type recurrence  ( [ shortar ] ) from gmres - dr",
    ", we need to store only @xmath22 vectors of length @xmath0 in order to have access to both the approximate eigenvectors and their products with @xmath23 .",
    "this allows for fairly inexpensive projections .",
    "we use a minimum residual projection  @xcite here .",
    "the gmres - proj method applies cycles of standard gmres , with a projection over the approximate eigenvector subspace in between cycles .",
    "this projection is not needed between all of the gmres cycles .",
    "we test the approaches just discussed with the matrix @xmath6 , given earlier .",
    "_ example 1 .",
    "_ for the first right - hand side , we compare gmres - dr with standard gmres .",
    "figure  [ figure1 ] gives a plot of the residual norms for gmres - dr(40,20 ) , gmres - dr(20,10 ) , gmres(40 ) , and gmres(20 ) .",
    "gmres - dr(40,20 ) uses subspaces of dimension 40 , of which 20 basis vectors are approximate eigenvectors .",
    "gmres(40 ) also restarts when the subspace reaches dimension 40 .",
    "starting around iteration 300 , gmres - dr(40,20 ) performs considerably better than the other methods . at that point",
    ", it has developed good enough approximations to some of the smallest eigenvalues .",
    "the eigenvalues halfway surround the origin  @xcite , on the positive real side .",
    "this makes the problem difficult , but removing some of the surrounding eigenvalues nearest the origin is helpful .",
    "= 2.8 in -.1 cm    -.5 cm    _ example 2 .",
    "_ for the second right - hand side , we compare gmres - proj with standard gmres and also with gmres - dr . with gmres , there is no deflation , and with gmres - dr , the deflation happens only after accurate enough approximate eigenvectors develop .",
    "meanwhile , gmres - proj is able to deflate from the start .",
    "figure  [ figure2 ] has the residual norms for gmres(20)-proj(30 ) , gmres(20)-proj(20 ) , gmres(20)-proj(10 ) , gmres(20 ) , and gmres - dr(40,20 ) .",
    "gmres(20)-proj(30 ) refers to cycles of gmres(20 ) with occational projections over 30 approximate eigenvectors in between .",
    "we project in between every third cycle .",
    "gmres(20)-proj(20 ) and gmres(20)-proj(10 ) use the approximate eigenvectors generated while solving the first right - hand side with 400 iterations of gmres - dr(40,20 ) and gmres - dr(20,10 ) , respectively .",
    "gmres(20)-proj(30 ) s eigenvectors come from 610 iterations of gmres - dr(50,30 ) ( more iterations are needed in this case for the eigenvectors to become accurate enough ) .",
    "the expense per iteration is nearly the same for gmres(20 ) and all the gmres - proj methods , while gmres - dr(40,20 ) has greater orthogonalization expense .",
    "more storage is needed for the gmres - proj methods than for gmres .",
    "for example , gmres(20)-proj(20 ) needs over 40 vectors of length @xmath0 , while gmres(20 ) uses a little over 20 .",
    "the deflation in gmres - proj makes it much better than gmres(20 ) .",
    "gmres(20)-proj(20 ) is also considerably better than gmres - dr(40,20 ) , because the deflation can start from the beginning ( both use 20 krylov vectors and 20 eigenvectors for each cycle ) .",
    "= 2.8 in -.1 cm    -.5 cm",
    "deflating eigenvalues is useful for lattice qcd problems , particularly for the second and subsequent right - hand sides .",
    "while z(2 ) noise vectors were used for these examples , the speedup from deflation is independent of the nature of the right - hand side .",
    "future plans include implementing multiple mass versions of gmres - dr and gmres - proj that solve several systems of equations with shifted matrices but the same right - hand side .",
    "we also would like to investigate deflating eigenvalues for the subsequent right - hand sides from lanczos methods such as the conjugate gradient method and bicgstab .",
    "the work of both authors is partly supported by the baylor university sabbatical program and ncsa and utilized the sgi origin 2000 system at the university of illinois .",
    "ww is also partly supported by nsf grant no .",
    "0070836 .                    b.  medeke . on algebraic multilevel preconditioners in lattice gauge theory \" , a.  frommer _ et .",
    "( eds . ) lecture notes in comp .",
    "sci . and eng . , _",
    "numerical challenges in lattice chromodynamics _ , springer , berlin ( 2000 ) p.  99 ."
  ],
  "abstract_text": [
    "<S> versions of gmres with deflation of eigenvalues are applied to lattice qcd problems . </S>",
    "<S> approximate eigenvectors corresponding to the smallest eigenvalues are generated at the same time that linear equations are solved . </S>",
    "<S> the eigenvectors improve convergence for the linear equations , and they help solve other right - hand sides .    epsf </S>"
  ]
}