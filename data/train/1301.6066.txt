{
  "article_text": [
    "an inherent difficulty in studying the dynamics of magnetized plasmas is the enormous separation of important time - scales present in many physical systems of interest .",
    "nonlinear gyrokinetic theory has become an indispensable tool in these inquiries , as it removes the fastest time - scales from the system , while keeping much of important physics relevant to turbulent transport@xcite . a particularly nice way to construct a gyrokinetic theory , pioneered in refs .  , is to use lie - transforms to asymptotically change into co - ordinates in which gyro - orbit dynamics are decoupled from the rest of the system .",
    "a great advantage of this technique , aside from the entirely systematic and formal procedure , is that the single particle equations are guaranteed to be hamiltonian , with associated conservation properties .",
    "going further , it is advantageous from both a philosophical and practical standpoint to derive the entire system _ _ , _ _ including both electromagnetic fields and particles , from a single _ field - theoretic _ variational principle .",
    "these ideas were explored by sugama@xcite and brizard@xcite , who derived gyrokinetic action principles starting from maxwell - vlasov theories , as well as in previous work in refs .  .",
    "some advantages of this type of formulation are a much simplified derivation of the gyrokinetic maxwell s equations and exact energy - momentum conservation laws through noether s theorem .",
    "field theories often admit many different variational principles ( e.g. , for maxwell - vlasov see refs .  ) , each with its own advantages and disadvantages .",
    "a good example is the difference between lagrangian and eulerian actions ; the former being constructed in variables that follow particle motion and the latter in variables at fixed points in phase space .",
    "it is interesting to explore new types of variational principles , both for the general understanding of the structure of the theory in question , and for practical applications that may require an action of a particular form .    in this work",
    ", we present a new gyrokinetic action principle in eulerian co - ordinates , using euler - poincar reduction theory@xcite on the lagrangian action in refs .  .",
    "in addition , using the reduced legendre transform and a modified version of the dirac theory of constraints , we derive field theoretic poisson brackets , similar to the vlasov - maxwell@xcite and vlasov - poisson@xcite brackets . to our knowledge",
    "this is the first explicit demonstration of the field theoretic hamiltonian structure of the gyrokinetic system ( see refs .   for a different approach that has recently been used to write down a poisson brackets for simplified gyrokinetic systems ) .",
    "our derivation proceeds from the action principle in ref .   and its geometric formulation@xcite .",
    "we do not purport to derive a gyrokinetic co - ordinate system , but rather formulate the theory based on a given single particle lagrangian . in this way , it is trivial to extend concepts to deal with more complex gyrokinetic theories , for instance theories with self consistent , time - evolving background fields@xcite .",
    "we then use the ideas in ref .   to reduce the lagrangian action to one in eulerian co - ordinates , based on symmetry under the particle - relabeling map from lagrangian to eulerian variables .",
    "the variations for this new action principle in the eulerian frame are _ constrained , _ and lead to the _ euler - poincar equations , _ which are shown to give the standard gyrokinetic vlasov equation . in some ways",
    "the action principle is similar to that of brizard@xcite , in that constrained variations must be used , with both theories having a similar form for the variation of the distribution function , @xmath0 .",
    "nevertheless , there are significant differences , particularly that our principle is formulated in terms of the eulerian phase space fluid velocity and is in standard 6-d phase space , rather than 8-d extended phase space .",
    "the eulerian gyrokinetic action of refs .",
    "is quite different to that presented here , with unconstrained variations in 12-dimensional extended phase space and the use of hamilton - jacobi functions in the action functional . for more information on this approach to gyrokientic theory ,",
    "see refs .  .",
    "equipped with the eulerian action , a reduced legendre transform is performed@xcite , leading straightforwardly to a poisson bracket . however ,",
    "this bracket must be _ reduced _ to a constraint submanifold before a meaningful form can be obtained , a process that is performed with a modified version of the dirac theory of constraints@xcite .",
    "finally , we show how to include the electromagnetic fields in the bracket via second application of dirac theory .",
    "one of our primary motivations in this work is the possibility of utilizing recent ideas from fluid mechanics to develop advanced numerical tools for gyrokinetics .",
    "of particular importance is the idea of geometric integrators , which are designed to numerically conserve various important geometrical properties of the physical system .",
    "for instance , having a numerical algorithm that has hamiltonian structure can be very important , with profound consequences for the long - time conservation properties@xcite .",
    "the theory of finite dimensional geometric integrators is relatively well developed@xcite , including an application to single particle guiding center dynamics@xcite . however , many aspects of the construction of field - theoretic geometrical integrators are not as well understood , both for practical implementation and the deeper mathematical theory . one approach , which has yielded fruitful results , is to discretize a variational principle and perform variations on the discrete action to derive an integration scheme",
    ". some examples of field theoretic integrators constructed in this way are those for elastomechanics@xcite , electromagnetism@xcite , fluids and magnetohydrodynamics@xcite , and a particle - in - cell ( pic ) scheme for the vlasov - maxwell system@xcite .",
    "the results presented in this work would be used to construct a continuum eulerian gyrokinetic integrator , since our variational principle is in eulerian form .",
    "analogously , a variational principle in lagrangian form is used to construct a lagrangian ( particle - in - cell ) integrator@xcite .",
    "we note that in discretizing a variational principle it is obviously not desirable to be in an extended phase space , unless these extra dimensions can somehow be removed after a discretization . as well as",
    "integrators , other potential applications of the formulation presented here are the use in stability calculations with casimir invariants @xcite and the construction of regularized models for large - eddy simulation@xcite .",
    "it is significant to note at this point that as the power of modern supercomputing systems continues to advance at a rapid pace toward the exascale ( @xmath1 floating point operations per second ) and beyond , it is quite clear that the associated software development challenges are also increasingly formidable . on the emerging architectures memory and data motion",
    "will be serious bottlenecks as the required low - power consumption requirements lead to systems with significant restrictions on available memory and communications bandwidth .",
    "consequently , it will be the case in multiple application domains that it will become necessary to re - visit key algorithms and solvers  with the likelihood that new capabilities will be demanded in order to keep up with the dramatic architectural changes that accompany the impressive increases in compute power .",
    "the key challenge here is to develop new methods to effectively utilize such dramatically increased parallel computing power .",
    "algorithms designed using geometric ideas could be very important as simulations of more complex systems are extended to longer times and enlarged spatial domains with high physics fidelity .",
    "the article is organized as follows . in section  [ sec : ep explanation ] we clarify the differences between eulerian and lagrangian action principles for kinetic theories and explain the euler - poincar formulation of the maxwell - vlasov system@xcite .",
    "this is done with as little reference to the formal mathematics as possible , with the hope that readers unfamiliar with the concepts of lie groups and algebras will understand the general structure of the theory .",
    "section  [ sec : gyrokinetic - variational - principle ] explains the construction of the gyrokinetic variational principle , starting from a given single particle gyrokinetic lagrangian .",
    "we give a brief derivation of the euler - poincar equations and show how these lead to a standard form of the gyrokinetic equations .",
    "the hamiltonian structure is dealt with in section  [ sec : the - hamiltonian - formulation ] .",
    "after formally constructing a poisson bracket from the lagrangian , we describe how the modified dirac theory of constraints is used to reduce the bracket to a meaningful form .",
    "finally , numerical applications are briefly discussed in section  [ sec : numerical - applications ] and conclusions given in section  [ sec : concluding - remarks ] .    throughout this article we use cgs units . in integrals and derivatives",
    ", @xmath2 denotes all phase space variables , while @xmath3 denotes just position space variables .",
    "species labels are left out for clarity and implied on the variables @xmath0 ( or @xmath4 ) , @xmath5 , @xmath6 , @xmath7 and @xmath8 , respectively the distribution function , particle mass , particle charge , eulerian fluid velocity and momenta conjugate to @xmath7 .",
    "summation notation is utilized where applicable , with capital indices spanning @xmath9 and lower case indices @xmath10 .",
    "when formulating a variational principle for a continuum fluid - type theory , it is very important to specify whether lagrangian or eulerian variables are being used .",
    "these notions can be confusing in kinetic plasma theories , since one must consider the motion of the _ phase - space _ fluid .",
    "in addition , unlike the euler fluid equations , the equations of motion for kinetic plasma theories have the same form in eulerian and lagrangian co - ordinates . considering the vlasov - maxwell system for simplicity ,",
    "a lagrangian description gives the equation of motion at the position of a particle carried along by the flow ( simply a physical particle ) .",
    "one formulates a variational principle in terms of the fields @xmath11 , @xmath12 , which are the current position and velocity of an element of phase space that was initially at @xmath13 .",
    "the distribution function is of course just carried along by the lagrangian co - ordinates , i.e. , @xmath14 .",
    "this type of formulation is the most natural for a kinetic theory , since it is the logical continuum generalization of the action principle for a collection of particles interacting with an electromagnetic field .",
    "an eulerian variational principle is formulated in terms of the velocity of the phase space fluid at a fixed point , @xmath7 , without the notion of where phase space density has been in the past .",
    "thus , at a point @xmath15 , the @xmath3 component of the fluid velocity is simply @xmath16 ( the co - ordinate ) , while the @xmath16 component is @xmath17 .",
    "the distribution function @xmath4 , is _ advected _ by @xmath7 , meaning it is the solution to the differential equation @xmath18 , where @xmath7 and @xmath19 are in six - dimensional phase space .",
    "an illustration of these concepts is given in figure  [ fig : psi map illustration ] for the 1-d poisson - vlasov system ( in 2-d phase space ) .",
    "finally , we note that in discussing the distinction between eulerian and lagrangian actions , we refer only to the plasma component of the variational principle ; the electromagnetic fields are always in eulerian co - ordinates .     and its inverse for the one - dimensional vlasov - poisson system.[fig : psi map illustration ] ]      this section gives a very informal introduction to euler - poincar theory through a brief review of the vlasov - maxwell formulation presented in ref .",
    "we purposefully do not use the group theoretical notation of refs .",
    "( e.g. , the @xmath20 and @xmath21 operations ) so as to introduce the general ideas to readers not familiar with lie groups and algebras .",
    "euler - poincar type variational principles first appeared in ref .   in the context of magnetohydrodynamics .",
    "the purpose of the euler - poincar framework is to provide a straightforward method to pass from a lagrangian to an eulerian action principle .",
    "the important idea is that the lagrangian is invariant under the right action of the particle relabeling transformation , @xmath22 , which maps plasma particles with initial position @xmath13 to their current position @xmath15 .",
    "in essence , this invariance means that we can eliminate the extraneous particle labeling information and still have an equivalent system .",
    "the map @xmath23 acts on @xmath4 on the right as @xmath24 , where @xmath25 is the initial distribution function .",
    "this equation is simply @xmath14 , as discussed above . in the electromagnetic part of the lagrangian @xmath23",
    "does not act on the potentials @xmath26 and @xmath27 , since electromagnetic dynamics must be independent of particle labeling .",
    "the phase space fluid velocity in the lagrangian frame is simply @xmath28 , since this is the rate of change of @xmath15 at the position @xmath15 .",
    "in contrast , the eulerian phase space fluid velocity is @xmath29 , since this operation first takes @xmath15 back to @xmath13 with @xmath30 and then gives the velocity at @xmath15 with @xmath28 , see figure  [ fig : psi map illustration ] .",
    "the starting point for the reduction is a lagrangian lagrangian for the vlasov - maxwell system .",
    "for instance , @xmath31\\nonumber \\\\   & + \\frac{1}{8\\pi}\\int d\\bm{x}\\left[\\left|-\\nabla\\phi-\\frac{\\partial\\bm{a}}{\\partial t}\\right|^{2}-\\left|\\nabla\\times\\bm{a}\\right|^{2}\\right],\\label{eq : full low lagrangian}\\end{aligned}\\ ] ] which is very similar to the action principle of low@xcite .",
    "the vlasov equation follows from the standard euler - lagrange equations for @xmath32 , @xmath33 along with @xmath34 .",
    "maxwell s equations come from the euler - lagrange equations for @xmath27 and @xmath26 .",
    "this lagrangian is invariant under the relabeling transformation @xmath23 , i.e.,@xmath35 where @xmath36 is the eulerian fluid velocity , a vector field . in recognizing that the distribution function is actually a phase space _",
    ", we denote @xmath37 . treating @xmath0 as 6-form rather than a scalar changes the form of certain geometrical operations in the euler - poincar equations [ eqs .   and and is very important for the gyrokinetic euler - poincar treatment ( see section  [ sec : gyrokinetic - variational - principle ] ) .",
    "practically speaking , to construct the reduced lagrangian , @xmath38 one simply replaces @xmath39 with @xmath7 , and considers @xmath3 and @xmath16 to be co - ordinates rather than fields .",
    "thus,@xmath40\\nonumber \\\\   & + \\frac{1}{8\\pi}\\int d\\bm{x}\\left[\\left|-\\nabla\\phi-\\frac{\\partial\\bm{a}}{\\partial t}\\right|^{2}-\\left|\\nabla\\times\\bm{a}\\right|^{2}\\right],\\label{eq : reduced low lagrangian}\\end{aligned}\\ ] ] where @xmath41 denotes the @xmath3 components of @xmath7 .",
    "the equations of motion are derived from the reduced lagrangian @xmath42 , by considering how the unconstrained variations of @xmath23 ( used to derive the standard euler - lagrange equations ) translate into _ constrained _ variations of @xmath7 and @xmath0 .",
    "this leads to variations of the form @xmath43,\\;\\ ; \\delta f=-\\mathcal{l}_{\\eta}f,\\label{eq : reduced variations form}\\ ] ] where @xmath44 is in the same space as @xmath7 and vanishes at the endpoints ; and @xmath45 $ ] is the standard lie bracket , @xmath46 .",
    "evolution of @xmath0 is given by the advection equation @xmath47 which arises from the equation @xmath48 .",
    "variation of @xmath49 with @xmath50 and @xmath51 leads to the _ euler - poincar equations _ , @xmath52 where @xmath53 is a 1-form density .",
    "we give straightforward derivations of eqs .   and in section  [ sub",
    ": ep - gyrokinetic - variational ] below . since @xmath0 is a 6-form , @xmath54 and eq .",
    "is the conservative form of the vlasov equation ( see section  [ sub : ep - gyrokinetic - variational ] for more information ) .",
    "the equations for @xmath27 and @xmath26 are just the standard euler - lagrange equations .",
    "calculation of eq .   with the vlasov - maxwell reduced lagrangian [ eq",
    ".   leads to @xmath55 as expected .",
    "the fact that there is no need to solve differential equations for components of @xmath7 is related to the strong degeneracy in the system ( see sections  [ sec : gyrokinetic - variational - principle ] and [ sec : the - hamiltonian - formulation ] below ) .    to obtain the hamiltonian or _ lie - poisson _ form of the equations , one performs a reduced legendre transform as , @xmath56 where @xmath57 and the inner product @xmath58 is integration over phase space [ see eq .  ] .",
    "( a thorough treatment of the degeneracies of the system is given in ref . .",
    ") it is then straightforward to show that @xmath59\\nonumber \\\\ + & \\sum_s \\int d\\bm{z}f\\left(\\frac{\\delta\\theta}{\\delta\\bm{m}}\\cdot\\nabla\\frac{\\delta\\gamma}{\\delta f}-\\frac{\\delta\\gamma}{\\delta\\bm{m}}\\cdot",
    "\\nabla \\frac{\\delta\\theta}{\\delta f}\\right)\\nonumber \\\\ - & \\,4\\pi c \\int d\\bm{x}\\left(\\frac{\\delta\\gamma}{\\delta\\bm{a}}\\cdot\\frac{\\delta\\theta}{\\delta\\bm{e}}-\\frac{\\delta\\theta}{\\delta\\bm{a}}\\cdot\\frac{\\delta\\gamma}{\\delta\\bm{e}}\\right),\\label{eq : lp bracket definition}\\end{aligned}\\ ] ] is an infinite dimensional poisson bracket for the system ; that is , @xmath60 , @xmath61 , @xmath62 and @xmath63 are formally the same as the euler - poincar equations ( using the generalized legendre transform of ref .  ) , and the jacobi identity is satisfied .",
    "nevertheless , this manifestation of the bracket has major problems .",
    "in particular , the meaning of functional derivatives with respect to the @xmath8 variables can be unclear , since these are constrained due to the linearity of the lagrangian in @xmath7 . to overcome these problems and formulate a meaningful bracket on the space of plasma densities and electromagnetic fields , we use a modified version of the dirac theory of constraints@xcite . for the convenience of the reader a very brief overview of standard dirac theory in appx .  [",
    "appendix dc ] , while the modified version used in parts of this work is covered in appx .",
    "[ appendix moddc ] .",
    "the relevant constraints are@xmath64 we form the constraint matrix @xmath65 and construct the inverse according to the procedure detailed in appxs .",
    "[ appendix dc ] and [ appendix moddc ] .",
    "this comes out to be , @xmath66 which is simply the single particle poisson matrix ( multiplied by @xmath67 ) and @xmath68 is a function of @xmath2 .",
    "we will see a similar connection to the single particle poisson bracket in the reduction of the gyrokinetic bracket .",
    "we then use eq .   and restrict the functionals @xmath69 and @xmath70 to not depend @xmath8 , i.e. , @xmath71 ( see appx .  [ appendix moddc ] ) .    the final result , including a change of variables from @xmath27 to @xmath68 , is the poisson bracket for the mawell - vlasov system,@xmath72\\nonumber \\\\   & + 4\\pi c\\int d\\bm{x}\\left(\\frac{\\partial\\gamma}{\\partial\\bm{e}}\\cdot\\nabla\\times\\frac{\\delta\\theta}{\\delta\\bm{b}}-\\frac{\\partial\\theta}{\\partial\\bm{e}}\\cdot\\nabla\\times\\frac{\\delta\\gamma}{\\delta\\bm{b}}\\right).\\label{eq : full vm bracket}\\end{aligned}\\ ] ] this bracket is identical to that published previously , initially proposed in ref .   with a correction given later in ref .",
    "the derivation above explicitly shows the link between this and the work of ref .  .",
    "there is a slight taint on the validity of this bracket in that it requires @xmath73 for the jacobi identity to be satisfied ( as shown in refs .   through direct calculation ) .",
    "recently , this obstruction has been partially fixed using the dirac theory of constraints@xcite .",
    "somewhat more detail is given for the derivation of the gyrokinetic bracket ( see section [ sec : the - hamiltonian - formulation ] ) , which proceeds in a very similar manner .",
    "euler - poincar reduction is perhaps more natural when applied to fluid systems@xcite . in this case , there are fewer degeneracies and the lagrangian / eulerian distinction is more obviously relevant ( e.g.  one does not _ measure _ phase space fluid velocities , in contrast to the eulerian fluid velocity of a fluid system ) .",
    "recently , similar ideas have been applied to general reduced fluid and hybrid models in plasma physics@xcite .",
    "our starting point is the geometric approach to gyrokinetic theory advocated in ref .  .",
    "the general idea is to construct a field theory , including electromagnetic potentials , from the particle poincar - cartan 1-form , @xmath74 .",
    "this approach is conceptually very simple ; once the interaction of quasi - particles with the electromagnetic field is specified , particle and field equations follow in straightforward and transparent way via the euler - lagrange equations . with any desired approximation ( e.g. , expansion in gyroradius ) ,",
    "energetically self - consistent equations are easily obtained without necessitating the use of the pullback operator .",
    "the use of these ideas in gyrokinetic simulation has been advocated in , for instance refs .  .",
    "in this article we consider the particle 1-form @xmath74 as given , its derivation can be found in refs .   among other works .",
    "the poincar - cartan form @xmath74 in 7-d phase space , @xmath75 , ( including time ) defines particle motion through hamilton s equation , @xmath76 which is derived from stationarity of the action @xmath77 . here",
    "@xmath78 is a vector field whose integrals define particle trajectories ( including the time component ) and @xmath79 denotes the inner product .",
    "note that @xmath74 is essentially just @xmath80 , where @xmath81 is the standard lagrangian ; that is , for @xmath82 , the lagrangian is simply @xmath83 . to construct a field theory ,",
    "@xmath74 is used to define the liouville 6-form,@xmath84 the liouville theorem of phase space volume conservation is then simply , @xmath85 . introducing the distribution function of particles in phase space @xmath4",
    ", the field theory action for the interaction of a field of particles with the electromagnetic field is @xmath86 where @xmath87 is the electromagnetic lagrangian density . in this action",
    "@xmath74 is in the lagrangian frame .",
    "for example , in cartesian position and velocity space , @xmath88 is in @xmath13 co - ordinates , while @xmath74 is in @xmath89 co - ordinates .",
    "unless general relativity is important , one can choose @xmath78 to be of the form @xmath90 component of @xmath78 could have dependence on the phase - space co - ordinates .",
    "when this is true , one can not work in 6-d phase space with a separate treatment of time ] , where @xmath91 has no time component , and consider 6-d phase space .",
    "defining @xmath92 to be the @xmath93 component of @xmath94 ( i.e. , no @xmath95 ) , the @xmath93 component of @xmath96 is the standard liouville theorem of phase space volume conservation,@xmath97 we can simplify the variational principle by considering @xmath74 to be @xmath80 and carrying out the wedge product .",
    "this type of procedure provides a generalization of the original variational principle of low@xcite [ e.g. , eq .",
    "] to arbitrary particle - field interaction .",
    "we now specialize to a general gyrokinetic form for the particle lagrangian , @xmath98 with @xmath99 here , @xmath100 is the gyrocenter position ,",
    "@xmath101 the gyrocenter parallel velocity co - ordinate , @xmath102 the conserved magnetic moment and @xmath103 the gyrophase .",
    "the vector field @xmath104 is the vector potential of the background magnetic field and @xmath105 is the background magnetic field unit vector .",
    "these fields will not be considered variables in the field theory action .",
    "the vector @xmath106 , where @xmath107 , is necessary for gyrogauge invariance of the lagrangian , i.e. , invariance with respect to a change in the definition of the @xmath103 co - ordinate .",
    ".   is accurate to first order in @xmath108 , the ratio of the gyroradius to the scale length of the magnetic field@xcite .",
    "the single particle hamiltonian , @xmath109 , contains both the guiding center contribution , @xmath110 , and the gyrocenter contribution from the fluctuating fields , @xmath111 . for most of this article @xmath111",
    "will be taken to be a general function of @xmath112 .",
    "different forms exist in the literature , depending on desired accuracy and fluctuation model used .",
    "for instance , in ref .  , @xmath111 is given to second order in @xmath113 ( the ratio of the magnitudes of the fluctuating fields , @xmath114 and @xmath115 , to the background field ) as@xmath116 where @xmath117 , @xmath118 is difference between the particle and gyrocenter positions , and @xmath119 denotes an average over @xmath103 .",
    "the tilde in @xmath120 denotes the gyrophase dependent part of a function and @xmath121 is a gauge function associated with the first order gyrocenter perturbation , @xmath122 .",
    "eq .   is the standard gyrokinetic single particle lagrangian in",
    "_ hamiltonian _",
    "form@xcite , meaning all the fluctuating field perturbations are in the hamiltonian part ( @xmath123 component ) of @xmath74 .",
    "this is the form most suitable for computer simulation@xcite and also has the advantage of having the same poisson structure as the guiding center equations .",
    "we now construct a field theory from the single particle lagrangian eq .  , a process often referred to as _",
    "_ lifting__@xcite .",
    "we first calculate the phase space component ( @xmath124 component ) of the volume element @xmath125 .",
    "this is simply @xmath126 , with @xmath127 , i.e. , the standard guiding center jacobian . in co - ordinates ,",
    "the variational principle eq .",
    "is then simply,@xmath128+\\int dt\\ , l_{em},\\label{eq : lagrangian gk action}\\end{aligned}\\ ] ] which is essentially the original gyrokinetic variational principle of sugama@xcite .",
    "@xmath129 should be chosen as @xmath130 where @xmath131 , so the ampre - poisson system is obtained , removing fast time - scale electromagnetic waves .",
    "we proceed in the reduction of the gyrokinetic variational principle , eq .",
    ", in a very similar way to the vlasov - maxwell case ( section [ sec : ep explanation ] ) .",
    "the advected parameter is the 6-form @xmath132 .",
    "@xmath133 is often considered a function for simplicity of notation , but it is understood that operations should be carried out as for a 6-form , e.g. , @xmath134 rather than @xmath135 .",
    "the connection to the standard distribution function is provided by the liouville theorem ; the advection equation @xmath136 coupled with liouville s theorem , eq .  , implies @xmath137 which is the standard vlasov equation .",
    "operating on eq .",
    "on the right with the particle - relabeling map , @xmath30 , leads to the reduced lagrangian @xmath138 where @xmath139 and @xmath140 are the @xmath100 and @xmath103 components of the eulerian fluid velocity @xmath7 .    the unconstrained variations in the lagrangian frame , @xmath141 lead to constrained variations in the eulerian frame by defining@xcite @xmath142 or equivalently @xmath143 . recalling @xmath144 , one then calculates @xmath145 and @xmath50 , giving @xmath146 which is solved for @xmath147 giving the variational form stated in eq .  .",
    "similarly , using @xmath148 and @xmath149 , one obtains @xmath150 using eqs .   and , we give a basic derivation of the euler - poincar equations for a general lagrangian with an advected volume form , @xmath133.@xmath151\\nonumber \\\\ = & \\int dt\\left[\\left\\langle \\frac{\\delta l}{\\delta\\bm{u}},\\left(\\frac{\\partial\\eta}{\\partial t}+\\left[\\bm{u},\\eta\\right]\\right)\\right\\rangle _",
    "{ \\mathfrak{g}}+\\left\\langle \\frac{\\delta l}{\\delta\\hat{f}},\\mathcal{l}_{\\eta}\\hat{f}\\right\\rangle _ { v}\\right]\\nonumber \\\\ = & \\int dt\\sum_{s}\\int d\\bm{x}dud\\mu d\\theta\\left\\ { -\\frac{\\partial}{\\partial t}\\frac{\\delta l}{\\delta\\bm{u}}\\eta^{i}-\\left[\\frac{\\delta l}{\\delta u^{j}}\\partial_{i}u^{j}\\right.\\right.\\nonumber \\\\   & \\left.\\left.+\\partial_{j}\\left(\\frac{\\delta l}{\\delta u^{i}}u^{j}\\right)\\right]\\eta^{i}+\\eta^{i}\\hat{f}\\partial_{i}\\frac{\\delta l}{\\delta\\hat{f}}\\right\\ } \\nonumber \\\\ = & \\int dt\\left\\langle -\\frac{\\partial}{\\partial t}\\frac{\\delta",
    "l}{\\delta\\bm{u}}-\\mathcal{l}_{\\bm{u}}\\frac{\\delta l}{\\delta\\bm{u}}+\\hat{f}\\nabla\\frac{\\delta l}{\\delta\\hat{f}},\\,\\eta\\right\\rangle _ { \\mathfrak{g}},\\label{eq : full ep deivation}\\end{aligned}\\ ] ] giving eq .   since @xmath44 is arbitrary .",
    "the two brackets used are defined as @xmath152 between a 1-form density @xmath153 and a vector field @xmath154 ; and @xmath155 between a function @xmath4 and a volume form @xmath133 .",
    "integration by parts is used , with boundary terms dropped , in arriving at the third line . note that @xmath133 sometimes includes the volume element ( lines 1 and 2 ) and sometimes does not ( lines 3 and 4 ) .",
    "a more precise derivation can be found in refs .  .",
    "it is now simple to write down the equations of motion for @xmath7 , using@xmath156 the derivation is carried out without assumptions about the form of @xmath7 ( e.g. , lack of @xmath103 dependence ) and the @xmath133 advection equation [ eq .",
    "is used to cancel time derivatives .",
    "we illustrate the general form of the calculation with the @xmath157 component of eq .  , @xmath158 the first two terms in eq .",
    "add to zero due to the advection equation , while the terms involving @xmath140 cancel .",
    "rearranging and expanding the divergence term leads to @xmath159 which gives@xmath160 and @xmath161 when @xmath162 and @xmath163 are applied respectively . similarly , the other @xmath164 equations give @xmath165 and eq .",
    "is combined wiht eq .   to give @xmath139 in terms of co - ordinates .",
    "the form of eqs .  - is identical to the standard lagrangian equations for @xmath166 because of the linearity of the lagrangian in @xmath7 .",
    "note that various terms have different origins in the lagrangian and eulerian derivations ; for instance , @xmath167 in the eulerian derivation ( it is just a co - ordinate ) , while this is not true in the lagrangian case .",
    "equipped with the solution for @xmath7 in terms of phase space co - ordinates , the gyrokinetic vlasov equation is eq .  , or in co - ordinates , @xmath168 maxwell s equations follow from the standard euler - lagrange equations for @xmath27 and @xmath26 , @xmath169 since @xmath170 and @xmath171 do not appear in @xmath172 . these lead to the gyrokinetic maxwell s equations for @xmath114 and @xmath115 , @xmath173 where @xmath174",
    "we now perform the generalized legendre transform of @xmath172 and use the corresponding hamiltonian formulation to construct the poisson brackets for the gyrokinetic system .",
    "one complication is the degeneracy in the lagrangian that arises from the lack of quadratic dependence on @xmath7 , @xmath175 and @xmath176 .",
    "this issue is discussed in detail refs .   and",
    "those same arguments apply to the gyrokinetic case .    for the moment",
    ", we formulate a bracket on the space of plasma densities ( see section  [ sub : inclusion - of - electromagnetic ] ) and carry out a legendre transform in @xmath7 by defining @xmath177 this type of formulation treats the gyrokinetic poisson - ampre equations [ eqs .   and ] as _ constraints _ on the motion of @xmath133 , rather than dynamical equations in their own right .",
    "the gyrokinetic hamiltonian is defined , as for a standard legendre transform , as@xmath178-\\frac{1}{8\\pi}\\int d\\bm{x}\\left(\\left|\\nabla\\phi_{1}\\right|^{2}-\\left|\\nabla\\times\\left(\\bm{a}+\\bm{a}_{1}\\right)\\right|^{2}\\right).\\label{eq : full gk hamiltonian}\\end{aligned}\\ ] ] it is easy to show that with this hamiltonian@xmath179\\right\\rangle _ { \\mathfrak{g}}\\nonumber \\\\   & + \\left\\langle \\hat{f},\\frac{\\delta\\theta}{\\delta\\bm{m}}\\cdot\\nabla\\frac{\\delta\\gamma}{\\delta\\hat{f}}-\\frac{\\delta\\gamma}{\\delta\\bm{m}}\\cdot\\nabla\\frac{\\delta\\theta}{\\delta\\hat{f}}\\right\\rangle _ { v}\\label{eq : full gk poisson bracket}\\end{aligned}\\ ] ] is a valid poisson bracket ( see sec .",
    "[ ep reduction explanation ] and ref .  ) . to evaluate functional derivatives of @xmath180 [ eq .  ] , one should obtain the green s function solutions for @xmath181 and @xmath182 , for instance @xmath183 from the gyrokinetic poisson - ampre equations , and insert these into @xmath180 , see refs .  .",
    "for practical calculation , this is the same as neglecting the electromagnetic part of @xmath180 in the functional derivative . in the same way as the maxwell - vlasov system ( sec .",
    "[ ep reduction explanation ] ) , the manifestation of the bracket in eq .",
    "is not well defined due to the constraints on @xmath8 . in the next section , the dirac theory of constraints ( see appxs .  [",
    "appendix dc ] and [ appendix moddc ] ) is used to reduce eq .",
    "to a bracket of the space of densities @xmath133 .",
    "a complete treatment of the geometry of the poisson - vlasov system , with the electric field as a constraint , is given in ref .  .",
    "many similar ideas will apply to the gyrokinetic system , with complications arising from the nonlocal nature of the theory@xcite and larger constraint space ( @xmath181 and @xmath182 rather than just @xmath26 ) .",
    "we reiterate that there are two sets of constraints we consider here ; the constraints on @xmath8 variables , similar to the maxwell - vlasov system , and the constraints due to @xmath181 and @xmath182 , which are the gyrokinetic poisson - ampre equations .",
    "we first deal with the @xmath8 constraints , eliminating these variables entirely , then explain how to include @xmath181 and @xmath182 in section  [ sub : inclusion - of - electromagnetic ] .",
    "there are six constraints given by @xmath184 with the functional derivatives as listed in eq .  .",
    "one then forms the constraint matrix @xmath65 with the poisson bracket of eq .",
    "using@xmath185 dropping boundary terms in integrations and inserting the constraint equations ( after calculation of the brackets , see appx .",
    "[ appendix moddc ] ) leads to the very simple form,@xmath186 where all functions are of the @xmath2 variable and @xmath187@xmath188 . because of the simple form in @xmath189 , this matrix is easy to invert according to eq .   giving , @xmath190 where again functions are of the @xmath2 variable , @xmath191 and @xmath192",
    "of course , this matrix is nothing but the single particle gyrokinetic poisson matrix@xcite as was the case for the maxwell - vlasov system . restricting the functionals @xmath69 and @xmath70 to not depend on @xmath8 ( see appx .",
    "[ appendix moddc ] ) and using @xmath193,\\phi_{j}\\left(\\bm{z}\\right)\\right\\ } = \\hat{f}\\left(\\bm{z}\\right)\\frac{\\partial}{\\partial z^{j}}\\frac{\\delta\\gamma}{\\delta\\hat{f}},\\label{eq : pb with gamma and phi}\\ ] ] the field theory gyrokinetic poisson bracket is simply,@xmath194 here @xmath195 is the single particle poisson bracket structure@xcite @xmath196 we note that , although all @xmath197 terms are left out above for clarity , the @xmath198 and @xmath199 terms cancel in a full calculation as expected , so there is no issue with these being undefined ( see appx .",
    "[ appendix moddc ] ) .",
    "the field theory bracket , eq .  , is of exactly the form one would expect based on the poisson - vlasov bracket@xcite and maxwell - vlasov bracket@xcite ( eq .   without @xmath200 and @xmath201 terms ) .",
    "it is aesthetically pleasing to see this type of structure emerge from the entirely systematic procedure applied above . since we have not given a proof of the modified dirac procedure used in the calculation ( see appx .",
    "[ appendix moddc ] ) , we directly prove the jacobi identity for the gyrokinetic bracket [ eq .  ] in appx .",
    "[ appendix ji proof ] .",
    "this shows it is indeed a valid poisson bracket for this gyrokinetic system .",
    "the reduced hamiltonian to be used with eq .   is simply eq",
    ".   with constraints on @xmath8 inserted explicitly,@xmath202 it is easy to show that @xmath203 is just the conservative form of the gyrokinetic vlasov equation , eq .  .",
    "the bracket , eq .",
    ", does not include electromagnetic field equations , meaning the gyrokinetic maxwell s equations , eqs .   and ,",
    "must be specified as separate constraints on the motion to obtain a closed system . here",
    ", we illustrate how to explicitly include the electromagnetic potentials in the bracket for a simplified gyrokinetic system .",
    "this procedure also works to extend the simple poisson - vlasov bracket@xcite to include the motion of @xmath26 .",
    "the general technique is to add a poisson - ampre canonical bracket to the gyrokinetic bracket [ eq .  ] and apply standard dirac theory to this extended bracket .",
    "it is important to recognize that this is only valid because the full constraint matrix would be block diagonal if the reduction were performed in one - step from an original bracket that included electromagnetic and plasma components ( i.e. , eq .   with the addition of canonical brackets in @xmath182 and @xmath181 ) .",
    "this condition is satisfied because @xmath182 and @xmath181 do not appear in the symplectic structure of the original lagrangian .    for clarity ,",
    "we use with a simplified electrostatic system in the drift kinetic limit , with @xmath204 where @xmath205 .",
    "we also assume quasineutrality , which amounts to neglecting the @xmath206 term in the lagrangian , and set @xmath207 to zero the gyrokinetic lagrangian is no longer gyrogauge invariant , an issue of little practical importance for formulating such a model . ] .",
    "the hamiltonian for the system is @xmath208 and the unreduced poisson bracket@xmath209 where @xmath210 is the variable canonically conjugate to @xmath26 .",
    "this model is the electrostatic version of the simplified gyrokinetic system in refs .  .",
    "physically , the @xmath211 term in the hamiltonian is the polarization drift in the drift kinetic limit@xcite .",
    "@xmath212 indicates a gradient with respect to a co - ordinate system locally perpendicular to the background magnetic field ( we are neglecting derivatives of @xmath213 ) . unlike in the previous section , @xmath26",
    "is now considered a separate field in the hamiltonian , and poisson s equation should not be used to evaluate functional derivatives .",
    "the constraints are @xmath214,\\nonumber \\\\ \\phi_{2 } & = \\pi,\\label{eq : pb with phi constraints}\\end{aligned}\\ ] ] where @xmath215 since @xmath216 .",
    "@xmath217 is the gyrokinetic poisson equation ; this constraint arises as a secondary dirac constraint that is necessary to satisfy @xmath218 , see ref .   for more information . using eq .",
    "the constraint matrix is , @xmath219 where @xmath220\\label{eq : func deriv for constraint mat}\\ ] ] with @xmath221 and @xmath222 indicating the derivative is with respect to @xmath223 .",
    "the inverse matrix , chosen to satisfy eq .  , is @xmath224 where @xmath225.\\label{eq : func deriv for cinv mat}\\ ] ] the notation @xmath226}$ ] is used for clarity to denote the inverse of the operator @xmath227}$ ] , which is similar to the perpendicular laplacian .",
    "while we will not consider this here , existence of the inverse of this type of operator ( with smooth @xmath228 ) can very likely be proven using standard partial differential equation analysis techniques@xcite .",
    "the dirac bracket is constructed using@xmath229 where @xmath230 with the corresponding definition for @xmath231 . with eq .",
    ", this leads to @xmath232\\nonumber \\\\",
    "-\\int d\\bm{x}\\nabla_{\\perp}^{-1 } & \\cdot\\left(\\frac{b^{2}}{c^{2}\\hat{n}}\\nabla_{\\perp}^{-1}\\frac{\\delta\\gamma}{\\delta\\phi}\\right)\\left[\\tilde{n}_{\\theta}+\\frac{mc^{2}}{e}\\nabla_{\\perp}\\cdot\\left(\\frac{\\nabla_{\\perp}\\phi}{b^{2}}\\tilde{n}_{\\theta}\\right)\\right].\\label{eq : dirac bracket with potentials}\\end{aligned}\\ ] ] here , @xmath195 is the single particle bracket as in eq .",
    "( with @xmath233 ) .",
    "note that in forming eq .",
    ", terms involving @xmath234 in the dirac part of eq .  ,",
    "canceled with the canonical part of the original bracket , as would be expected .    with the reduced hamiltonian ( eq .   without the first term ) ,",
    "the bracket can easily be checked to give the vlasov equation as @xmath235 .",
    "noticing that the @xmath236 term in @xmath237 [ see eq .",
    "integrates to zero , we see that @xmath238 .",
    "this is used in @xmath239 to show@xmath240\\right\\ } = 0,\\label{eq : time derivative of poisson's}\\ ] ] which is just the time derivative of poisson s equation for this gyrokinetic model . using the procedure presented above",
    "there should be no particular obstacle to the construction of brackets for more complex gyrokinetic theories .",
    "for instance , one could include finite larmor radius effects or magnetic fluctuations , and treating @xmath241 as a separate variable@xcite . ] .",
    "however , considering the complexity of the bracket for even a very simple gyrokinetic model , such brackets are unlikely to be of much practical use .",
    "in a general sense , one of the main motivations for this work is to possibly help address the increasing need to develop new algorithms with the long - time conservation properties necessary to help improve the physics fidelity of simulation results as we move towards exascale computing and beyond . of specific interest in this paper is the desire to explore the possibility of applying the eulerian variational methods developed here in a _",
    "discrete _ context to design continuum geometric integrators for gyrokinetic systems . to elaborate on this idea , here",
    "we give a simple explanation of some geometric discretization methods based on recent work in numerical fluid dynamics .",
    "the methods described here are just examples from a large array of literature on the subject .",
    "some other techniques can be found in , for instance refs .  .",
    "in addition we remark on how euler - poincar models can be used to formulate sub - grid models for turbulence simulation and some of the challenges associated with extending these ideas to gyrokinetic turbulence .    [ [ lagrangian - side - discrete - euler - poincar - equations ] ] lagrangian side : discrete euler - poincar equations + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    conceptually , an obvious way to design a geometric integrator for an euler - poincar system is to directly discretize the euler - poincar variational principle .",
    "if one can design discrete variations of the correct form , the entire integrator can be constructed directly from the variational principle as for a standard variational integrator .",
    "this approach has recently been successfully applied to develop an integrator for the euler fluid equations@xcite and more complex fluids , including magnetohydrodynamics ( mhd)@xcite . the utility of such an approach is illustrated by the very nice properties of these schemes .",
    "for instance , the mhd scheme@xcite exactly preserves @xmath73 and the cross helicity @xmath242 . as one consequence of this ,",
    "there is almost no artificial magnetic reconnection .",
    "the symplectic nature of the scheme also leads to other very good long time conservation properties .",
    "the first requirement in constructing an euler - poincar integrator is a finite dimensional approximation to the diffeomorphism lie group . in the case of fluids or mhd",
    ", the group is that of _ volume preserving _ diffeomorphisms and a matrix lie group is constructed to satisfy analogous properties to the infinite dimensional group . for vlasov - poisson , vlasov - maxwell or a gyrokinetic system ,",
    "the group is that of _",
    "symplectomorphisms_. thus , for a discretization , a different matrix lie group than the fluid case should be used , with properties designed to mimic those of the infinite dimensional symplectomorphism group . using this group",
    "one can find the lie algebra , which will give the form of the space of discrete vector fields ( just the eulerian phase space fluid velocities ) .",
    "group operations can then be constructed as matrix multiplications as for a standard finite dimensional lie group , and advected parameters included through the use of discrete exterior calculus .",
    "one would then use the _ _ discrete euler - poincar theorem__@xcite , which gives discrete update equations [ in analogy with eq .   from a discrete reduced lagrangian .",
    "an algorithm of this form can be shown to be symplectic and have similar conservation properties ( arising from variants of noether s theorem ) to the continuous system .",
    "the final update equations obtained from this method are not as complex as one might expect and would not preclude incorporation into large scale codes .",
    "obviously there are several unanswered questions regarding the application of this method to kinetic plasma systems .",
    "first , one must discretize the symplectomorphism group , which may not be trivial . in two phase space dimensions",
    "the group is the same as the group of volume preserving diffeomorphisms ; however , in higher dimensions the symplectomorphisms form a more restricted class of transformations .",
    "the lack of a finite boundary in velocity space may also present issues relating to the discretization of the symplectomorphisms .",
    "the degeneracy of the system is another aspect which differs from the fluid system , and the consequences of this in the discrete setting would have to be carefully considered . finally ,",
    "for a gyrokinetic system , it would be necessary to remove the @xmath103 dimension in some way .",
    "this could potentially be done either in the continuous setting or after discrete equations have been obtained .",
    "[ [ hamiltonian - side - poisson - bracket - discretization ] ] hamiltonian side : poisson bracket discretization + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    another way to form a discrete hamiltonian system is to directly discretize the poisson bracket . the general idea is simple , one finds a discrete hamiltonian functional and discrete bracket that are finite dimensional approximations to the continuous versions . in this way , one discretizes ( in phase space ) via the method of lines , and reduces the infinite dimensional system to an approximate finite dimensional one .",
    "any symplectic temporal discretization can then be used to ensure the system is discretely hamiltonian @xcite .",
    "the difficultly arises in ensuring a correct hamiltonian discretization of the bracket .",
    "this requires antisymmetry and the jacobi identity to be satisfied , and such a bracket can be very difficult to find in practice .",
    "for instance , for the euler fluid equations , the non - canonical structure complicates matters and a discrete bracket has been found only for simplified cases@xcite . an obvious place to start in this endeavor would be the vlasov - poisson system , as the structure is much more simple .",
    "generalizations to gyrokinetic systems could then potentially be achieved through nambu bracket formulations@xcite .",
    "[ [ alpha - models - and - large - eddy - simulation ] ] alpha models and large - eddy simulation + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    much work has been done in the last decade in the fluids community on so - called _ alpha models . _",
    "the general idea is to regularize the fluid equations ( navier - stokes or mhd ) at the level of the euler - poincar variational principle , by adding terms into the lagrangian that include gradients of the fluid velocity .",
    "these terms penalize the formation of small scale structures , and can thus be used as a large eddy simulation ( les ) model , causing turbulence to dissipate at larger scales@xcite .",
    "these methods have been shown to have some significant advantages over more traditional les methods ( for instance those based on hyperdiffusion ) especially for simulation of mhd turbulence@xcite . as gyrokinetic turbulence simulation becomes a more mature subject , it is interesting to enquire whether similar alpha models could be formulated for gyrokinetic large eddy simulation .",
    "in fact , alpha models can be _ derived _ from a standard fluid variational principle , by averaging over small scale fluctuations that are assumed to be advected by the larger scale flow@xcite .",
    "approaching the gyrokinetic variational principle in a similar way leads to the addition of extra , regularized terms into the gyrokinetic lagrangian .",
    "for instance , following the general ideas in ref .  ,",
    "averaging over perpendicular @xmath100-space fluctuations of scale length @xmath243 , and ensuring electromagnetic gauge invariance , we were led to the regularized lagrangian @xmath244 , where @xmath245 while this lagrangian gives well - defined equations of motion , there is a fundamental problem in that it destroys some of the degeneracy in the original system . as a consequence of this ,",
    "the equations of motion involve solving spatial pdes for @xmath7 , which would significantly increase computation times , defeating the purpose of an les .",
    "it is not yet clear if it is possible to design a regularization of this type for the gyrokinetic system that retains the redundancy of the @xmath7 fields and allows one to write down a standard vlasov equation .",
    "we note that gyrokinetic les has been explored and implemented recently on the gene code , by adding hyperdiffusive terms in the perpendicular co - ordinates@xcite .",
    "in this article we have applied the euler - poincar formalism to derive a new gyrokinetic action principle in eulerian co - ordinates .",
    "we start with a single - particle poincar - cartan 1-form , using the theory of ref .   to systematically construct a gyrokinetic field theory action in lagrangian co - ordinates .",
    "the fundamental idea is then to reduce this action using symmetry under the the particle - relabeling map , @xmath246 , which takes particles with initial position @xmath13 to their current location @xmath15@xcite .",
    "this process leads to an action functional formulated in terms of the eulerian phase space fluid velocity , @xmath7 , and the advected plasma density , @xmath133 , as well as the standard electromagnetic potentials .",
    "in the course of reduction , the arbitrary variations of the lagrangian fields ( used to derive equations of motion ) lead to _ constrained _ variations of the eulerian fields , @xmath7 and @xmath133 .",
    "because of this , field motion is governed by the _ euler - poincar _ equations rather than the standard euler - lagrange equations .",
    "explicit calculation of the euler - poincar equations for a standard gyrokinetic single particle lagrangian is shown to give the gyrokinetic vlasov equation .",
    "since the space of electromagnetic potentials is not altered by @xmath247 , the gyrokinetic poisson - ampre equations arise from the standard euler - lagrange equations for the perturbed potentials .    using the methodology set out in ref .",
    "we then perform a legendre transform to derive the hamiltonian form of the gyrokinetic system .",
    "the principal difficulty is the strong degeneracy , which is related to the linearity and lack of time derivatives for certain function variables in the action principle .",
    "physically , this arises from the fact that the plasma distribution function encodes the information about particle phase space trajectories .",
    "the degeneracy leads to a poisson bracket in terms of too many variables ; namely , a series of constrained momentum variables canonically conjugate to @xmath7 as well as the distribution function @xmath133 . to reduce the bracket into a well defined form we use a modified version of the dirac theory of constraints , which is a systematic way to project a poisson bracket onto a constraint submanifold when momentum variables are constrained .",
    "the modified dirac procedure ( see appx .  [ appendix moddc ] ) can be a significant simplification over standard dirac theory for certain types of systems .",
    "this process leads to an infinite dimensional gyrokinetic poisson bracket , which takes a natural form based on the single particle bracket .",
    "we also demonstrate how this procedure leads to the full , electromagnetic vlasov - maxwell bracket@xcite . since the electromagnetic equations in the gyrokinetic system are really constraints on the motion , we chose to include these in the bracket via a second application of the dirac theory of constraints .",
    "the general method is expounded through construction of the bracket for a simplified electrostatic model with no finite larmor radius effects .",
    "although the brackets obtained by such an approach are probably to complicated to be of much practical use , it makes for an interesting application of dirac theory .    as a final comment , we note that there is an emerging ( and very likely increasing ) demand for a new class of algorithms capable of dealing with the demands of powerful modern supercomputers  moving on the path to the exascale and beyond@xcite .",
    "approaches based on geometric integration may prove highly relevant as increasingly ambitious simulations of larger and more complex systems are undertaken .",
    "we extend our thanks to dr .  john krommes and joshua burby for enlightening discussion . this research is supported by u.s .",
    "doe ( de - ac02 - 09ch11466 ) .",
    "cc acknowledges financial support from the agence nationale de la recherche and from the european community under the contract of association between euratom , cea , and the french research federation for fusion studies .",
    "the dirac theory of constraints or dirac bracket is used to build poisson brackets for hamiltonian systems with constraints .",
    "the original purpose of the theory was to construct quantizable poisson brackets starting with a degenerate lagrangian , i.e. , a lagrangian where the momenta are not independent functions of velocities .",
    "the theory applies equally well to a bracket that is already in non - canonical form , a realization that can be very useful in the construction of field theoretic brackets@xcite . for example , in ref .",
    ", the non - canonical magnetohydrodynamic bracket is reduced to incorporate the incompressibility constraint .",
    "we give a very brief overview of the theory here for the convenience of the reader .",
    "more complete treatments can be found in refs .  .",
    "we consider an infinite dimensional hamiltonian system , described by field variables @xmath248 ( for @xmath249 ) , with poisson bracket @xmath250 , hamiltonian @xmath251 , and @xmath5 local constraint functions @xmath252 .",
    "the constraint matrix , @xmath253 and its inverse , defined using @xmath254 are used to form the dirac bracket,@xmath255 by construction this bracket satisfies the jacobi identity@xcite .",
    "geometrically , the constraints force motion to lie on a _ constraint submanifold , _ which inherits the dirac bracket from the poisson bracket on the original manifold@xcite .",
    "more precisely , the constraints @xmath256 are casimir invariants of the dirac bracket  ( [ eq : dirac brak defn ] ) , i.e. , @xmath257 for any functional @xmath69 and for all @xmath258 .    in the case where the matrix @xmath259 is not invertible , dirac theory suggests the use of one or more secondary constraints , which must be included and the constraint matrix @xmath260 recalculated .",
    "see refs .   for more information .",
    "in this appendix we provide some justification of the modified dirac procedure used in the calculation of the vlasov - maxwell and gyrokinetic poisson brackets [ eqs .   and . for clarity",
    "we restrict ourselves to the finite dimensional case , even though the technique is applied to infinite dimensional systems in the present manuscript .",
    "the purpose of this modified procedure is to simplify the computation of the dirac bracket and reduce the dimensionality of the constrained system .",
    "the modified dirac procedure involves the following steps :    1 .",
    "compute the constraint matrix @xmath260 and simplify its expression by applying the constraints .",
    "the resulting matrix @xmath261 is weakly equal to @xmath260 .",
    "2 .   construct the dirac bracket using eq .",
    "( [ eq : dirac brak defn ] ) with @xmath261 instead of @xmath260 .",
    "3 .   choose a set of @xmath5 variables , denoted @xmath262 , to be eliminated from the bracket  ( [ eq : dirac brak defn ] ) using the constraint equations , so that it can be completely rewritten in terms of the remaining @xmath263 variables , denoted @xmath264 .",
    "substitute these into the bracket and drop all partial derivatives with respect to the @xmath262 .",
    "this new bracket ( of reduced dimensionality ) is the _ reduced dirac bracket_.    since the above procedure departs from the standard one for the computation of the dirac bracket , the reduced bracket is not _ a priori _ a poisson bracket .",
    "below we justify this procedure by providing the condition under which the reduced dirac bracket is a poisson bracket .    regarding step 1 , assuming @xmath260 is analytic in the constraint variables , the invertibility of the matrix @xmath261 is sufficient to ensure that the reduced dirac bracket exists , in particular , that it satisfies the jacobi identity .",
    "this follows from the fact that if @xmath265 $ ] is non - zero , we can find a small open neighborhood of @xmath266 such that @xmath267 by continuity , implying @xmath260 is invertible in this region .    regarding step 3 , we write the dirac bracket in the form @xmath268 where @xmath269 is the poisson matrix@xcite satisfying the jacobi identity , @xmath270 as explained above , we single out a subset of the @xmath2 variables to be eliminated by the reduction procedure ( denoted @xmath271 ) and label the remaining variables @xmath264 .",
    "we rewrite the @xmath5 constraints in the form @xmath272 this should be possible at least locally under the hypothesis of the implicit function theorem .",
    "note that all the constraints considered in this manuscript are already of this form .",
    "next we consider the general coordinate change @xmath273 , where @xmath274 are the constraints .",
    "this change of variables is invertible , and its inverse is given by @xmath275 and @xmath276 .",
    "since the constraints are casimir invariants of the dirac bracket , the transformed jacobi matrix must be in the form @xmath277 where the number of rows and columns of zeros is the same as the number of constraints . since @xmath278 satisfies the jacobi identity , it is straightforward to see from eq .   that @xmath279 must also .",
    "setting @xmath274 to @xmath280 and applying the coordinate change @xmath281 leads to a poisson bracket in @xmath282 that satisfies the jacobi identity .",
    "the set of functions depending on @xmath264 constitutes a poisson algebra with the poisson bracket given by @xmath283    this bracket is obtained by simply dropping the @xmath284 terms in the dirac bracket . for consistency",
    "we require this to be equal to the operation of the reduced dirac bracket @xmath285 , a condition which is obviously ensured if we drop @xmath284 and use @xmath286 to eliminate @xmath262 .",
    "note that this is equivalent to removing the rows and columns of @xmath269 corresponding to the @xmath262 variables .",
    "of course , one can reach the same point by the variable change @xmath287 as explained above , illustrating that dropping @xmath262 partial derivatives will lead to a bracket satisfying the jacobi identity .",
    "note that if a constraint is simply a co - ordinate @xmath288 , all @xmath289 will be automatically eliminated from the dirac bracket by the standard dirac procedure .",
    "this behavior is seen in both the finite dimensional example below as well as the infinite dimensional brackets in the main body of the paper .",
    "for example , the functional derivative @xmath290 cancels in the calculation leading to the vlasov - maxwell bracket , eq .  .",
    "we now give an example of the procedure for a well known finite dimensional system , the poisson bracket for the lorentz force . using a 12-dimensional extended phase space @xmath291 and the modified dirac theory above , both the @xmath15 bracket and the canonical bracket",
    "are easily derived in one step .",
    "start with the lagrangian for a particle in an electromagnetic field ( using unit charge and mass for clarity ) , @xmath292 and apply the dirac theory of constraints to the canonical poisson bracket in extended phase space @xmath293 where @xmath294 means switch @xmath4 to @xmath295 and vice versa .",
    "there are 6 constraints on the canonical momenta , @xmath296 , @xmath297 obtained from @xmath298 .",
    "this gives the constraint matrix @xmath299 , the symplectic form in @xmath300 space .",
    "the dirac bracket follows from the computation of @xmath301  : @xmath302 note that , as explained above , the terms involving @xmath303 cancel automatically .",
    "we can now form the reduced dirac bracket in the variables of our choice ( except @xmath304 ) by simply removing partial derivatives and substituting in constraints . here",
    "there is no need to apply the constraints on @xmath260 before its inversion , so step 1 has been skipped .",
    "for instance , removing @xmath305 trivially leads to the standard @xmath15 bracket @xmath306 while removing @xmath16 leads to the @xmath307 canonical bracket , @xmath308 one could even form a @xmath309 bracket if desired , although the @xmath310 term would have to be changed into @xmath309 co - ordinates using the constraint equations .    while these finite dimensional brackets can be straightforwardly derived from the lagrangian [ eq .   through other means , derivation of infinite dimensional brackets can be more challenging .",
    "so long as suitable care is taken , the method outlined above can be very useful in deriving poisson brackets from certain types of field theoretic lagrangians , as is carried out in the main body of this work for the vlasov - maxwell and gyrokinetic brackets .",
    "we provide a direct proof of the jacobi identity , @xmath311 for the gyrokinetic bracket presented above , @xmath312 here @xmath313 denotes the permutation of @xmath69 , @xmath70 , and @xmath314 through the other two possibilities .",
    "the bracket , eq .  , is in the form @xmath315 where @xmath316 is an anti - self adjoint operator with dependence on @xmath133 . for operators of this type ( see ref .  )",
    "the second functional derivatives cancel in the calculation of eq .  .",
    "this implies that the only part of @xmath317 that contributes in the jacobi identity is @xmath318 and eq .",
    "becomes @xmath319 thus , the jacobi identity of the functional poisson bracket follows directly from that for the single particle bracket .",
    "76ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ]  + 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty @noop * * ,   ( ) @noop * * ,   ( ) @noop * * , ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * , ( ) link:\\doibase 10.1063/1.866641 [ * * ,   ( ) ] @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) _ _ ,  arxiv : physics/0307148[ph.d .",
    "thesis ] ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop _ _ ,  oxford texts in applied and engineering mathematics ( ,  ) @noop * * ,   ( ) @noop ( ) @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase 10.1063/1.4774063 [ * * ,   ( ) ] @noop ( ) ,   @noop * * ,   ( ) @noop * * ,   ( ) in  link:\\doibase 10.1063/1.33633 [ _ _ ] ,  , vol .  ,  ( ) pp .   @noop ( ) ,   @noop * * , ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * , ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase 10.1103/physrevlett.100.035006 [ * * , ( ) ] link:\\doibase 10.1063/1.3589275 [ * * ,   ( ) ] link:\\doibase 10.1063/1.4714608 [ * * ,   ( ) ] @noop * * ,   ( ) @noop * * ,   ( ) @noop ( ) ,   @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase 10.1016/j.aop.2009.04.003 [ * * ,   ( ) ] @noop * * ,   ( ) link:\\doibase 10.1017/s0022377804003563 [ * * ,   ( ) ] http://stacks.iop.org/0741-3335/55/i=3/a=035001 [ * * ,   ( ) ] @noop * * ,   ( ) @noop * * ,   ( ) @noop ( ) ,   @noop * * ,   ( ) in @noop _ _ ,  , vol .  ,",
    "( ) @noop * * ,   ( ) link:\\doibase    10.1145/1189762.1189766 [ * * ( ) ,  10.1145/1189762.1189766 ] @noop * * ,   ( ) link:\\doibase 10.1006/jcph.2001.6973 [ * * , ( ) ] @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * , ( ) @noop * * ,   ( ) link:\\doibase 10.1063/1.3677366 [ * * ,   ( ) ] http://science.energy.gov/~/media / ascr / ascac / pdf / reports / exascale_subcommit% tee_report.pdf [ `` , ''  ] ( ) @noop _ _ ,  texts in applied mathematics  ( ,  )"
  ],
  "abstract_text": [
    "<S> we present a new variational principle for the gyrokinetic system , similar to the maxwell - vlasov action presented in ref .  . </S>",
    "<S> the variational principle is in the eulerian frame and based on _ constrained _ variations of the phase space fluid velocity and particle distribution function . using a legendre transform </S>",
    "<S> , we explicitly derive the field theoretic hamiltonian structure of the system . </S>",
    "<S> this is carried out with a modified dirac theory of constraints , which is used to construct meaningful brackets from those obtained directly from euler - poincar theory . </S>",
    "<S> possible applications of these formulations include continuum geometric integration techniques , large - eddy simulation models and casimir type stability methods . </S>"
  ]
}