{
  "article_text": [
    "network coding , introduced in @xcite , has proven to be an important tool for improving network throughput . as one of the simplest applications of network coding ,",
    "the two - way relay network ( twrn ) has been extensively studied in the literature .",
    "a twrn usually comprises two source nodes ( @xmath0 and @xmath1 ) and one relay node ( @xmath2 ) , where @xmath0 and @xmath1 have information to exchange with each other .",
    "a direct link between @xmath0 and @xmath1 is unavailable .    in the literature ,",
    "several transmission methods have been proposed for the twrn , such as digital network coding ( dnc ) in @xcite@xcite , codeword superposition ( cw - sup ) in @xcite and @xcite , physical - layer network coding ( pnc ) in @xcite@xcite and analog network coding ( anc ) in @xcite@xcite . among them , dnc requires the relay node to jointly decode individual messages from both @xmath0 and @xmath1 on the uplink and then combine them together as a new message for delivery on the downlink .",
    "the codeword superposition strategy superimposes the two individual codewords received on the uplink and forwards the result to both sources .",
    "pnc requires the relay node to decode a function of the two messages instead of the two individual messages and forward this function message to both sources .",
    "another method , anc , requires the relay node to simply amplify the mixed signals received over the uplink without decoding , and forward this amplified signal to the source nodes .    in all cases , since each source node has perfect knowledge of the message originating from itself , it can subtract its own transmitted message and obtain the intended message from the other source upon receipt of the relay s network - coded message .",
    "note that anc performs worse than pnc as noise at the relay is amplified when transmitting on the downlink , thus degrading the achievable rate , as was shown in @xcite . hence in this work",
    "we shall only consider pnc , dnc and cw - sup strategies over fading channels .",
    "for clarity , a graphical description of the strategy considered is depicted in fig .",
    "[ fig : comparison_nc ] , where the message transmitted by @xmath0 is denoted by @xmath3 , and the one from @xmath1 is @xmath4 . without loss of generality , we assume that the message @xmath4 is longer than @xmath3 .",
    "it is composed of two parts : @xmath5 and @xmath6 , where @xmath5 is assumed to have the same length as the message @xmath3 . with the dnc based strategy or cw - sup ,",
    "the decoded messages at @xmath2 are @xmath7 and @xmath8 . with pnc - sup",
    ", the relay decodes the function message @xmath9 and the remaining bits @xmath10 .",
    "it should be noted that pnc is a family of techniques , and the pnc strategy considered in this work is a specific one from @xcite .",
    "in addition , in some works in the literature , network coding schemes with a conventional multi - access uplink for twrns were also referred to as pnc schemes . in this work , however , to distinguish a conventional multi - access uplink from the idea of decoding a function message over the uplink , we shall refer to the former as a dnc scheme .    in a twrn , an achievable rate region with dnc was first investigated in @xcite for a three - slot protocol . in @xcite , an achievable rate region with only time - resource allocation",
    "was investigated for the case of static channels . in @xcite ,",
    "a codeword superposition technique was discussed and only the optimal time division between the uplink and the downlink phases was investigated . in @xcite and @xcite , the capacity region employing pnc",
    "was derived for awgn channels without any discussion of resource allocation . in @xcite",
    "the optimized constellation for twrns with pnc was investigated for symmetric traffic scenario , by adjusting the pnc map with the channel gains . in @xcite ,",
    "analog network coding is studied as a way to utilize interference in wireless networks .",
    "furthermore , pnc was demonstrated to be better than dnc with time sharing uplink in @xcite in terms of achievable throughput as long as snr is higher than -5db .    in @xcite , @xcite and @xcite , we investigated the minimization of total energy usage for a three - node twrn subject to stability constraints , with various allowed transmit modes based on dnc",
    ". only an orthogonal , time - sharing uplink , as well as time sharing of the digital network coded bits with the remaining bits in the downlink were considered in @xcite . in @xcite , joint decoding on the uplink",
    "was allowed , ensuring that all points in the multi - access channel rate region are achievable .",
    "the non - fading ( static ) case was considered in @xcite .",
    "the fading scenario was investigated in the preliminary version of this work in @xcite .",
    "however , no mention of pnc and cw - sup was made in @xcite@xcite .",
    "it is also noted that the strategies considered in this work are different from the traditional three - phase dnc and two - phase pnc .",
    "the dnc schemes considered in this paper utilize a multi - access uplink , while the three - phase dnc adopts the time sharing uplink transmission .",
    "in addition , the traditional dnc or pnc usually considers the symmetric traffic scenario , whereas in this work we assume asymmetric traffic .",
    "although in @xcite pnc was shown to perform better than dnc with a time - sharing uplink , its performance relative to dnc with a multi - access uplink is still unknown . in this work",
    ", we will focus on comparing the performance and complexity of the optimized pnc , dnc and cw - sup strategies , with a multi - access uplink assumed for the latter two .",
    "it will be shown that the proposed pnc strategy outperforms other strategies with relatively high data rate requirements . in the regime of low data rate requirements , dnc - sup performs better than the proposed pnc and cw - sup strategies .",
    "to summarize , our main contributions are :    * we find the resource allocation that minimizes the total average energy required to support a given rate requirement in a three - node twrn in a fading channel .",
    "* we prove that dnc - sup outperforms dnc - ts and cw - sup under all channel conditions .",
    "* we show that the proposed pnc - sup strategy outperforms dnc - sup in applications with high data rate requirements on both sides .",
    "however , if data rate requirements on both sides are low , dnc - sup is preferred in terms of total average transmit energy usage . * based on the analysis of different schemes , we present an optimal algorithm to select the best strategy with different rate pair requirements in terms of energy usage .",
    "the rest of this paper is organized as follows . in section",
    "ii , we describe the three - node twrn and our setup . in section iii - a , we briefly describe the strategies considered . from section ii - b to section ii - e , we discuss respectively the pnc strategy , the orthogonal time - sharing of dnc message and the excess bits of the longer message , the superposition of the dnc bits and the excess bits of the longer message , and the superposition of the source messages . in section iii - f , an optimal algorithm to always select the best strategy is presented .",
    "numerical results are presented in section iv and section v concludes this work .",
    "we consider a three - node , two - way relay network consisting of two sources @xmath0 , @xmath1 and one relay node @xmath2 . @xmath0 and @xmath1 exchange information through the relay @xmath2 without a direct link between them . a block",
    "flat - fading channel model is assumed for all links , i.e. , the channel is a constant over one slot , defined as a cycle through all defined transmission modes in a strategy .",
    "the instantaneous channel power gains , corresponding to links @xmath0-@xmath2 , @xmath1-@xmath2 , @xmath2-@xmath0 and @xmath2-@xmath1 , are defined as @xmath11 , @xmath12 , @xmath13 and @xmath14 , respectively , their averages by @xmath15 ( @xmath16 ) , and their probability density functions by @xmath17 .",
    "we also assume ergodicity in the channel processes .",
    "noise at every node is modeled by an i.i.d .",
    "gaussian random variable with zero mean and unit variance .",
    "each node is equipped with one antenna and works in half - duplex mode , i.e. , it can not transmit and receive simultaneously .",
    "it is assumed that all transmitters incur some energy overhead due to the energy needed to operate the transmitter hardware , which is a constant independent of transmit power .",
    "this energy overhead is defined as @xmath18 for all three nodes together .    for each transmission strategy , the following optimization is performed .",
    "given instantaneous channel state information ( csi ) as well as their probability distributions , find    1 .",
    "the optimal time fraction to allocate to each mode in the transmission strategy over all time , i.e. , the designed values are applied regardless of instantaneous csi , and 2 .   the channel - dependent optimal power and rate allocations for each node , in each mode .    here , the optimal solution is the one that minimizes the total energy used .",
    "the constraints that must be met are that the _ average _ rate from @xmath0 to @xmath1 is at least @xmath19 , and that from @xmath1 to @xmath0 is at least @xmath20 .",
    "in this work , we consider four strategies : pnc - sup , dnc - ts , dnc - sup and cw - sup , as shown in fig .",
    "[ fig : comparison_nc ] . without loss of generality",
    ", we let @xmath21 in the following analysis .    in the pnc - sup strategy",
    ", there are a total of three transmission modes .",
    "the first mode is when @xmath0 and @xmath1 simultaneously transmit two messages ( @xmath3 and @xmath5 respectively ) of the same length at the same rate , encoded so that @xmath2 is able to decode the sum @xmath22 ( see @xcite for details ) . in the second mode , with @xmath21 , @xmath1 transmits to @xmath2 the bits that were not transmitted in the first mode ( @xmath6 ) , at a rate that will be found through solving the optimization problem below .",
    "finally , in the third mode , the relay node superimposes the sum message ( @xmath22 ) on @xmath6 , and broadcasts the combination to @xmath0 and @xmath1 .    in dnc - ts",
    ", we consider a multi - access uplink and time sharing of the digital network - coded message ( denoted as @xmath23 in fig . [ fig : comparison_nc ] ) and the remaining bits of the longer message ( @xmath6 ) on the downlink . on the other hand , in dnc - sup , a multi - access uplink and the superposition of the digital network coded bits and the remaining bits of the longer message on the downlink",
    "are considered .",
    "the last strategy considered is taken from @xcite , cw - sup , and comprises a multi - access uplink and a codeword superposition of the two original messages from @xmath0 and @xmath1 at @xmath2 for transmission on the downlink .",
    "no explicit network coding technique is applied in this strategy .",
    "note that from queueing theory , for a queueing system with the service rate close to the arrival rate , there are packets buffered at all nodes with high probability . to make the problem tractable for pnc - sup ( inherently required by the second mode of pnc - sup )",
    ", we further introduce the constraint that if @xmath24 , then the message to be transmitted in each slot from @xmath0 is shorter than the one from @xmath1 , irrespective of the instantaneous channel gains , and vice versa for the case @xmath25 .",
    "note also that for all strategies if @xmath24 , with the service rate close to the arrival rate , the number of bits from @xmath0 buffered at @xmath2 is smaller than that from @xmath1 with high probability .",
    "hence we assume that it can always transmit more data to @xmath0 in each slot , irrespective of the instantaneous channel gains , and vise versa for the case @xmath25 .",
    "in this strategy , there are three transmission modes . in mode one , @xmath0 and @xmath1 transmit to @xmath2 @xmath3 and @xmath5 of the same length , respectively , and r decodes @xmath26 . in mode two",
    ", @xmath1 transmits @xmath6 to @xmath2 . in mode three , the relay broadcasts to @xmath0 and @xmath1 the superposition of @xmath27 and @xmath10 .",
    "for the first mode , it was demonstrated in @xcite that the achievable symmetric transmit rate with pnc is @xmath28 over the awgn channel is suggested in [ 15 ] , the achievable pnc rate exploits the recent result given in [ 17 ] .",
    "] , where @xmath29 is the signal - to - noise ratio at the receiver from both @xmath0 and @xmath1 .",
    "the details of how to practically transmit rates close to this theoretical capacity are given in @xcite .",
    "the @xmath30 expression implies that transmit powers at @xmath0 and @xmath1 are adjusted at each channel use so that the instantaneous snr in the @xmath0-@xmath2 and @xmath1-@xmath2 links are identical .",
    "while this is sub - optimal , no other simple capacity expression exists for pnc and therefore we use this scheme in this paper .",
    "note that the pnc map is matched to channel fading coefficients in [ 10 ] , but no rate expression was derived .",
    "the power required to transmit a message at rate @xmath31 from @xmath32 in the first mode is therefore given by , @xmath33 the total power required in the first mode then is , @xmath34 the associated transmit rate @xmath35 is given by , @xmath36 where the channel inversion equality @xmath37 is required [ 17 ] for the validity of the pnc rate expressions .    in the second mode ,",
    "the remaining bits of @xmath1 will be delivered to the relay node .",
    "the minimum power needed by @xmath1 to transmit its remaining bits at the rate @xmath38 is @xmath39 which comes from the shannon channel capacity for point - to - point gaussian channels , i.e. , @xmath40 .",
    "the total transmit power then is @xmath41 and the total transmit rate @xmath42 . the power required in the downlink phase ( the third mode ) consists of two parts .",
    "one is to transmit the common network - coded message at rate @xmath43 and the other is to transmit the remaining bits of the message from @xmath1 to @xmath0 at rate @xmath44 .",
    "the decoding method at @xmath0 and @xmath1 is as follows .",
    "firstly , both source nodes decode the common message in the presence of the interference from the private message .",
    "hence @xmath0 can subtract its own message from the network - coded message and obtain part of the message from @xmath1 .",
    "@xmath1 can also subtract its own message from the network - coded message and obtain the full message from @xmath0 .",
    "@xmath0 , however , needs to decode the remaining bits of the larger message from @xmath1 , and then combine it with the message embedded in the network - coded message to obtain the full message from @xmath1 .",
    "hence , from the shannon capacity formula , @xmath45 where @xmath46 is the power required for transmission of the network - coded bits and @xmath47 is that for the remaining bits of the larger message .",
    "( [ eqn : bc2 ] ) comes from the fact that @xmath48 is a monotonically increasing function of @xmath49 if @xmath50 . the power required to transmit the network - coded message",
    "then is given by , @xmath51    for the remaining bits after subtracting the network - coded message , the achievable rate is given by @xmath52 and the power required by the relay to transmit at this rate is @xmath53 the total power required in the third mode is given by , @xmath54 we define @xmath55 and @xmath56 as the average transmit power required and the associated average transmit rate for the @xmath57th phase , respectively , where the expectation is over the associated channel distributions . in addition , @xmath58 ( @xmath59 ) denotes the time fraction assigned to the @xmath57th phase .",
    "@xmath60 is proportional to the average transmit energy consumed in the @xmath57th phase .",
    "hence , assuming that @xmath24 , minimizing average energy - usage with average rate constraints and pnc at the relay , is formulated as follows .",
    "we call this problem * p1*. @xmath61 subject to : @xmath62 where the target function in ( [ eqn : pncobj ] ) is the average energy consumed per slot",
    ". @xmath19 ( assuming @xmath21 ) in ( [ eqn : pnccon1 ] ) comes from the fact that only part of the larger message is simultaneously transmitted with the smaller message such that the two messages have the same length .",
    "@xmath63 in ( [ eqn : pnccon2 ] ) is for unicast transmission of the remaining bits of the larger message .",
    "( [ eqn : pnccon5 ] ) comes from the channel - inversion equality to alleviate intrinsic interference .",
    "note that the overhead energy @xmath18 is a constant and its value does not affect the optimal solution to * p1*. hence we simply assume @xmath64 in the rest of this work .",
    "note that the objective function is a convex function of the transmit rates and a linear function of the time fraction of each mode .",
    "in addition , the constraints are also linear functions of time fractions and/or of the transmit rates .",
    "therefore , * p1 * is a standard convex optimization problem and it can be solved by the lagrange multiplier method @xcite . by taking the first - order derivative of the lagrangian with respect to the related parameters , the associated kkt conditions are given by , @xmath65 and constraints in ( [ eqn : pnccon1])-([eqn : pnccon4 ] ) and ( [ eqn : pnccon6 ] ) are satisfied with equality .",
    "the lagrangian multiplier @xmath66 is with the rate requirement in the @xmath57th phase and @xmath67 with the physical constraint in ( [ eqn : pnccon6 ] ) . from these kkt conditions ,",
    "the associated optimal power allocation strategy is given by @xmath68^+ , \\label{eqn : pncopt1}\\\\ p_{1i}^{\\mathrm{pnc}}(g_{1r},g_{2r})&=\\left[\\beta_1^ * \\log_2 e \\frac{g_{3-i , r}}{g_{1r}+g_{2r}}-\\frac{1}{2g_{ir}}\\right]^+ , \\label{eqn : pncopt2}\\\\ p_2^{\\mathrm{pnc}}(g_{r1},g_{r2})&=\\left[\\beta_2^*\\log_2 e - \\frac{1}{g_{2r}}\\right ] , \\label{eqn : pncopt3 } \\ ] ] where the asterisks denote optimality .",
    "@xmath69^+=\\max(\\cdot , 0)$ ] and ( [ eqn : pncopt2 ] ) comes from ( [ eqn : pnc1 ] ) , ( [ eqn : pnc2 ] ) and ( [ eqn : pncopt1 ] ) .",
    "( [ eqn : pncopt3 ] ) comes from the assumption that @xmath21 .",
    "it is observed that the total power allocation in the uplink , i.e. , @xmath70 , has the water - filling structure in ( [ eqn : pncopt1 ] ) , with the instantaneous channel gains @xmath11 as well as @xmath12 taken into account . by deriving the first - order derivative of ( [ eqn : pnckkt2 ] ) ( similar to power allocation for broadcast channels in @xcite ) , the optimal power allocation in the downlink is summarized in lemma [ downlink1 ] .",
    "[ downlink1 ] if @xmath71 , the power allocation in the downlink is    * if @xmath72 , then @xmath73^+\\\\ p_{3,p}^{\\mathrm{pnc}}=0\\\\ \\end{array } \\right.\\end{aligned}\\ ] ] * if @xmath74 and @xmath75 , then @xmath76^+\\\\ \\end{array } \\right.\\end{aligned}\\ ] ] * if @xmath74 and @xmath77 , then @xmath78^+\\\\ p_{3,p}^{\\mathrm{pnc}}=[\\frac{(\\beta_{3,p}^*g_{r1}-\\beta_{3,c}^*g_{r2})}{(\\beta_{3,c}^*-\\beta_{3,p}^*)g_{r1}g_{r2}}]^+\\\\ \\end{array } \\right.\\end{aligned}\\ ] ]    for the case that @xmath79 power allocation for the third mode in the downlink can be derived in a similar manner and is omitted for brevity .",
    "a multi - bisection method is used to numerically find the optimal solution to * p1*. the procedure is as follows .    1 .   for a given @xmath80 we can obtain @xmath81 from ( [ eqn : pnccon1 ] ) and then find the appropriate @xmath82 and @xmath83 from ( [ eqn : pncopt1 ] ) and ( [ eqn : pncopt2 ] ) .",
    "we then compute @xmath67 from ( [ eqn : pnckkt1 ] ) .",
    "2 .   with the computed @xmath67 ,",
    "we can then iteratively find the appropriate @xmath84 , @xmath85 and @xmath86 for the second mode and the third mode satisfying ( [ eqn : pnckkt1 ] ) and ( [ eqn : pnckkt2 ] ) subject to the pre - defined accuracy , and obtain the associated @xmath56 , @xmath55 and @xmath58 from ( [ eqn : pnccon3])-([eqn : pnccon5 ] ) , ( [ eqn : pncopt3 ] ) and lemma [ downlink1 ] .",
    "for instance , the pre - defined accuracy for mode 2 can be @xmath87 where @xmath88 is a very small number .",
    "we hence iterate @xmath80 with all the computed @xmath58 and follow the same procedure in 1 ) and 2 ) until we arrive at the optimal solution subject to the pre - defined accuracy , e.g. , the convergence constraint can be @xmath89 , where @xmath90 is also a very small positive number .",
    "note that @xmath91 must be satisfied since the inner iteration should have higher accuracy than the outer iteration in numerical computation , e.g. , we can set @xmath92 and @xmath93 .",
    "this algorithm is presented to obtain the optimal lagrangian multipliers . in simulation , it is shown to converge to the global optimal solution in only tens of iterations .      in this section ,",
    "we consider the use of digital network coding in place of pnc , and seek similarly to minimize total average energy usage .",
    "the downlink time - shares a network coded message and a message of the remaining bits from one source , and explains why we call this strategy dnc - ts .",
    "the four modes in this strategy are described as follows .    *",
    "_ mode 1 : _",
    "@xmath0 and @xmath1 simultaneously transmit to @xmath2 at average rates @xmath94 and rate @xmath95 with average powers @xmath96 and @xmath97 in the multi - access uplink respectively . * _ mode 2 : _",
    "@xmath2 broadcasts to @xmath0 and @xmath1 at an average rate @xmath98 with an average power @xmath99 using digital network coding .",
    "* _ mode 3 : _",
    "@xmath2 transmits only to @xmath0 at an average rate @xmath100 with an average power @xmath101 . *",
    "_ mode 4 : _ @xmath2 transmits only to @xmath1 at an average rate @xmath102 with an average power @xmath103 .    in order for the subscripts to match the transmission modes",
    ", we introduce the new definitions @xmath104 , @xmath105 , @xmath106 , @xmath107 and @xmath108 for each mode . in dnc - ts , mode 3 ( if @xmath1 transmits the longer message ) and mode 4 ( if @xmath0 transmits the longer message ) are useful for transmitting bits that can not be network - coded due to the asymmetric message sizes . without them , we would have to zero - pad the shorter message in order to apply network coding in mode 2 .",
    "however , since the network - coded message must be decoded by _ both _ sources , the rate in mode 2 is constrained by the smaller of @xmath13 and @xmath14 .",
    "in contrast , the message in mode 3 is only for @xmath0 , and therefore its rate is limited only by @xmath13 , and similarly for mode 4 .",
    "it is thus always beneficial , in the asymmetric case of interest here , to use mode 3 or 4 , in addition to the network - coded mode 2 .",
    "let @xmath109 ( @xmath110 ) be the transmit power of @xmath32 for a given gain pair ( @xmath111,@xmath112 ) .",
    "for the multi - access uplink transmit mode , i.e. , mode 1 , we have @xmath113 and @xmath114 where the expectation is taken over the distribution of channel gains .",
    "as stated in @xcite , the optimal decoding order for a multi - access channel is to firstly decode the data from the stronger user , i.e. , the user with the better uplink channel gain .",
    "this result follows from mac - bc duality .",
    "hence with the assumption that @xmath115 , we have @xmath116 from ( [ eqn : ma1 ] ) and ( [ eqn : ma2 ] ) , the transmit powers of @xmath0 and @xmath1 for a given channel gain pair and transmit rate pair are derived in @xcite and are omitted here for brevity .",
    "in addition , for modes 2 to 4 , we have @xmath117 @xmath118 where @xmath119 and @xmath120 are averaged over the channel gain distribution . as in the pnc based strategy",
    ", a fraction @xmath121 ( @xmath122 ) of time is allocated to mode @xmath57 .",
    "therefore @xmath123 is proportional to the average energy used for transmission in mode @xmath57 .",
    "the optimal dnc - ts strategy is found by solving problem * p2 * : @xmath124 subject to @xmath125    in @xcite , it was observed that mode 3 and mode 4 are never both active due to network coding gain . hence assuming that @xmath126 , mode 4 can be dropped and only mode 1 to mode 3 will be used .",
    "in addition , it was observed in @xcite that the rate constraints in ( [ lopt_2 ] ) and ( [ lopt_3 ] ) are met with equality .",
    "hence we have @xmath127 and @xmath128 .",
    "since * p2 * is a convex optimization problem , its optimal solution can be derived from the kkt conditions .",
    "the details are presented in @xcite and are omitted here for brevity . for modes 2 to 3 , we have a water - filling structure for the optimal power allocations : @xmath129^+   i = 2,3 .",
    "\\label{eqn : kkt3}\\ ] ]    for mode 1 , resource allocation is however a little bit complicated and the result is summarized in the following lemma .",
    "[ uplink ] if @xmath130 and @xmath24 , the power allocation for the multi - access uplink transmission mode can be described as follows .    1 .   if @xmath131 , then @xmath132^+ \\\\ p_{12}^*=0 \\\\ \\end{array } \\right.\\end{aligned}\\ ] ] 2 .   if @xmath133 , then * if @xmath134 , then @xmath135^+\\\\ \\end{array } \\right.\\end{aligned}\\ ] ] * if @xmath136 and @xmath137 , then @xmath132^+\\\\ p_{12}^*=0\\\\ \\end{array } \\right.\\end{aligned}\\ ] ] * if @xmath136 and @xmath138 , then @xmath139^+\\\\ p_{12}^*=[\\frac{(\\beta_{12}^*-\\beta_{11}^*)g_{11}\\log_2e}{g_{11}-g_{12}}-\\frac{1}{g_{12}}]^+\\\\ \\end{array } \\right.\\end{aligned}\\ ] ]    for the case that @xmath115 power allocation for mode 1 can be derived in a similar manner",
    "the downlink channel from @xmath2 to @xmath0 and @xmath1 can be considered as a degraded broadcast channel , except that each receiver has full knowledge of the message being transmitted to the other . in section ii.c ,",
    "the possibility of superposition coding at r and successive interference cancelation ( sic ) decoding at @xmath0 and @xmath1 was not considered . in this section",
    ", we will allow for the superposition of the network - coded message with the remainder of the longer message in a new mode 5 , described as follows when @xmath24 , and when the message from @xmath1 is always longer than the one from @xmath0 .",
    "* _ mode 5 : _",
    "@xmath2 broadcasts to @xmath0 and @xmath1 at the average rate pair ( @xmath140 ) on the downlink .",
    "each node decodes the network coded message first and @xmath0 decodes the remaining bits of the larger message after subtracting the network coded message .",
    "@xmath141 is the rate of the network coded message to both users and @xmath142 that of the remaining bits of the longer message to @xmath0 .",
    "we now define @xmath143 , and @xmath144 , to be consistent with the notation of previous sections .",
    "if @xmath145 , the required energy pair ( @xmath146,@xmath147 ) , for a given rate pair ( @xmath148,@xmath149 ) , is given by , @xmath150 similarly , if @xmath151 , the required energy pair ( @xmath146,@xmath147 ) , for a given rate pair ( @xmath148,@xmath149 ) is given by , @xmath152    for a given gain pair @xmath153 , the total energy usage in mode 5 then is defined as @xmath154 .",
    "note that in section [ time sharing ] mode 5 was not allowed .",
    "introducing mode 5 turns problem * p2 * into @xmath155 subject to @xmath156    this new problem is equivalent to a simpler optimization problem with only mode 1 and mode 5 used . the conclusion is summarized below and the proof is given thereafter .",
    "[ lemma : equivalence ] the solution to ( [ p3_opt ] ) must necessarily have only mode 1 and mode 5 active , i.e. , @xmath157 where @xmath158 is the optimal value of @xmath121 .",
    "note that from @xcite , at most one of mode 3 and mode 4 will be active and this also applies to * p2*. with the assumption that @xmath159 , we conclude that @xmath160 .",
    "it comes from the rate gain of network coding and hence we should employ network coding to the fullest extent in our strategy .",
    "below we prove @xmath161 by contradiction .",
    "suppose in the optimal solution , we have both @xmath162 and @xmath163 positive .",
    "for a given gain pair in the downlink , ( @xmath164,@xmath165 ) , the total energy consumed in mode 2 and mode 3 is given by , @xmath166    now consider replacing modes 2 and 3 with mode 5 . since the bit rates in modes 2 and 3 were @xmath167 and @xmath168 respectively , when modes 2 and 3 are replaced by mode 5 , we must have broadcast - channel rates of @xmath169 the corresponding total consumed energy for this gain pair per unit time is given by @xmath170    we can now compare the energy consumption on the downlink for mode 5 and time sharing of mode2 and mode 3 . when @xmath171 , we have the comparison in ( 54)-(58 ) , which shows that mode 5 uses less average energy than time sharing of mode 2 and mode 3 .",
    "@xmath172    note that ( [ eqn:2 ] ) follows from convexity and ( [ eqn:4 ] ) follows from the fact that @xmath173 ( @xmath174 ) is a strictly decreasing function of @xmath175 and @xmath145 .",
    "hence mode 2 and mode 3 should be replaced by mode 5 in this case to minimize energy usage .    on the other hand , if @xmath151 , we have @xmath176 where ( [ eqn:22 ] ) follows from convexity .",
    "hence we have proved that for any channel gain pair we can use mode 5 to replace mode 2 and mode 3 to reduce energy consumption while delivering the same rates .",
    "averaging over all possible channel gain pairs , it is directly deduced that the average energy consumed by employing mode 5 is less than that with mode 2 and mode 3 . the assumed optimal solution to * p2 *",
    "thus could not be optimal .",
    "_ remarks _ : intuitively , with sic decoding allowed at each receiver , dnc - sup is able to achieve all points in the capacity region of the broadcast channel while dnc - ts can not",
    ". therefore dnc - sup outperforms dnc - ts .",
    "henceforth , an equivalent optimization problem which only consists of mode 1 and mode 5 , * p2* , aiming to minimize total average energy usage , is formulated as follows .",
    "@xmath177 subject to @xmath178    the optimal solution of * p2 * is straightforward to obtain and was presented in [ 8 ] .",
    "note that the optimal power allocation in both modes are identical to those of mode 1 and mode 3 in the pnc - based strategy .",
    "it is noted that * p2 * and * p2* differ only in the downlink transmission .",
    "the former time shares the digital network - coded bits and the remaining bits of the larger message in the downlink and the latter superimposes the network - coded bits and the remaining bits of the larger message in the downlink .      in @xcite and @xcite ,",
    "the authors discussed a codeword superposition of the two original messages from @xmath0 and @xmath1 at @xmath2 for transmission in the downlink .",
    "as each source has the knowledge of the message transmitted by itself , it can subtract this message and decode the intended message without interference .",
    "hence the broadcast channel in the downlink is equivalent to two interference - free awgn channels .",
    "note that in this codeword superposition strategy , the relay node simply superimposes the two messages from the two sources and no network coding technique is applied .",
    "the transmit power of the relay node then is the sum of the transmit power for transmission of each of the two messages to the intended source . for convenience",
    ", we refer to this transmission strategy in the downlink as mode 6 and we shall analyze mode 6 in our setup and minimize the total energy usage . note that in @xcite@xcite , the authors assumed that each node is subject to individual power constraint and focused on the throughput region of this network . in our setup , however , we are more interested in total energy usage of this system instead of deriving the throughput region .",
    "* _ mode 6 : _ on average , @xmath2 broadcasts to @xmath0 and @xmath1 at rate pair ( @xmath179 ) in the downlink .",
    "each node subtracts the message originating from itself and then decodes the intended message from the other source .    for a given rate pair ( @xmath180 ) and",
    "gain pair ( @xmath181,@xmath182 ) , the energy required is given by @xmath183 where each source enjoys an interference - free gaussian channel with sic within one slot . hence the capacity on either side in the downlink is given by the shannon formula @xmath184 ( @xmath185 ) and the total power required is @xmath186 . in this section , we are interested in deriving the minimal energy usage with mode 1 and mode 6 .",
    "we are further interested in comparing energy usage of the designed transmission strategy in the previous section with the one consisting of mode 1 and mode 6 .",
    "the optimization problem to minimize energy usage with mode 1 and mode 6 can be formulated as * p3 * , @xmath187 subject to @xmath188    since * p5 * is a convex optimization problem , we can derive kkt conditions and obtain the optimal solution .",
    "hence , the optimal solution to * p5 * has @xmath189^+ ,    \\quad   i=1,2    \\label{eqn:6kkt3 } \\ ] ] where @xmath190 ( @xmath191 ) are lagrangian multipliers .",
    "it is observed in ( [ eqn:6kkt3 ] ) that the optimal power allocation again has a water - filling structure .",
    "note that the optimal power allocation for the uplink is identical to lemma [ uplink ] and is hence omitted .",
    "comparing dnc - sup and cw - sup , we can prove the following lemma .",
    "[ codeword ] for ergodic fading channels , dnc - sup performs no worse than cw - sup in terms of energy usage , which indicates the superiority of our proposed transmission strategy in the downlink .",
    "suppose in the optimal solution to * p5 * , the optimal rate pair for a given gain pair ( @xmath181,@xmath182 ) in the downlink is @xmath192 and @xmath193 and the energy required is given in ( [ boche1 ] ) .",
    "we construct another solution which employs mode 5 with the optimal assigned time fraction @xmath194 .    comparing the link gains @xmath181 and @xmath182 and the associated transmit rates @xmath192 and @xmath193 , there are four cases to be investigated .",
    "* case i ) : @xmath195 and @xmath196 .    in case",
    "i ) , by employing mode 5 , we have @xmath197 the energy required is given by , @xmath198    hence we have @xmath199 since @xmath200 .    * case ii ) : @xmath201 and @xmath202 .    in this case , we can simply transmit a network coded message at rate @xmath192 , in other words , we have @xmath203 both sources can obtain @xmath192 bits of message , hence @xmath1 can obtain more information than in mode 6 . the energy required in mode 5 ,",
    "is given by @xmath204    * case iii ) .",
    "@xmath205 and @xmath196 .",
    "in case iii ) , by employing mode 5 , we have @xmath197 the energy required is given by , @xmath206    hence we have @xmath207    * case iv ) . @xmath205 and @xmath202 .    in this case",
    ", we can also simply transmit a network coded message at rate @xmath193 , in other words , we have @xmath208 both sources can obtain @xmath193 bits of message , hence @xmath0 can obtain more information than in mode 6 . the energy required in mode 5 ,",
    "is given by @xmath209    hence we have verified that for all cases mode 5 performs better than mode 6 in terms of energy usage .",
    "we have so far analyzed four different strategies for twrns .",
    "here we design an algorithm to obtain the optimal solution among these strategies for twrns with arbitrary rate pair requirements .",
    "note that we have shown that dnc - sup outperforms dnc - ts and cw - sup .",
    "hence only pnc - sup and dnc - sup are considered in the optimal solution in terms of energy usage , which is given as follows .    1 .   for a given rate pair requirement , we solve * p1 * for pnc - sup and * p2 * for dnc - sup to obtain their total energy usage .",
    "we compare the total energy usage of pnc - sup and dnc - sup .",
    "if pnc - sup uses less energy , it is selected as the optimal transmit strategy .",
    "otherwise , dnc - sup is selected .    in this way",
    ", we always select the optimal strategy and the minimum total average energy usage is then achieved for arbitrary rate pair requirements . for reference",
    ", we call it * popt*.",
    "we now present numerical results to verify our findings .",
    "noise at each node is assumed to be gaussian with zero mean and unit variance and all links are assumed to be rayleigh fading channels .",
    "the associated instantaneous channel state information ( csit ) , as well as channel statistics are assumed to be known to the corresponding transmit nodes .",
    "moreover , coding and decoding algorithms are not employed directly .",
    "rather , we use the theoretical achievable rate over each link as the transmit rate .",
    "it is also noted that the unit of rate requirement on either side is frames per slot .",
    "in addition , the constant overhead energy usage ( for circuit operation ) for a twrn is assumed to be zero , as it does not affect the transmit energy usage for the different strategies .    for comparison with * p1 *",
    ", we also present the achievable minimal average energy used for a twrn by pnc with zero padding ( pnc - zp ) . specifically , when the messages from the two sources are not of equal length , we zero pad the shorter message to make it equal in length to the longer message .",
    "the associated optimization problem is referred to as * p0 * : @xmath210 subject to the following constraints , @xmath211 where ( [ eqn : pnczpcon1 ] ) and ( [ eqn : pnczpcon2 ] ) follows from the fact that the two transmitted messages have the same length after zero - padding .",
    "@xmath212 is the time fraction assigned for the transmission on the uplink and @xmath213 is for transmission over the downlink .",
    "this is a standard convex optimization problem and the solution to * p0 * is given by , @xmath214^+ , \\label{eqn : pnzpcopt2}\\\\ p_2^{\\mathrm{pnc}}(g_{r1},g_{r2})&=\\left[\\beta_2^*\\log_2 e - \\frac{1}{g_{2r}}\\right ] , \\label{eqn : pnzpopt3 } \\]]where @xmath215 and @xmath84 are lagrangian multipliers for ( [ eqn : pnczpcon1 ] ) and ( [ eqn : pnczpcon2 ] ) respectively",
    ".    for clarity , table [ tab1 ] lists the different optimization problems with the corresponding transmit strategies .",
    "description + ine * p0 * & pnc - zp & physical layer network coding with zero padding for the smaller message in the downlink + ine * p1 * & pnc - sup & physical layer network coding with superposition in the downlink + ine * p2 * & dnc - ts & time sharing of dnc message and the remaining bits of the larger message in the downlink + ine * p2* & dnc - sup & superposition of dnc message and the remaining bits of the larger message in the downlink + ine & cw - sup & superposition of two original codeword messages in the downlink + ine    [ tab1 ]    in fig .",
    "[ fig : energy_usage_strategy1 ] , the minimal average transmit energy usage per slot with symmetrical rate requirements ( @xmath216 ) of different strategies are compared . under a symmetric traffic scenario , dnc - ts and dnc - sup",
    "are identical to each other , hence only the solution to dnc - sup is plotted .",
    "it is also seen that pnc - zp performs identical to pnc - sup as they are the same for symmetric traffic case .",
    "it is observed that pnc - sup outperforms dnc - sup and cw - sup at relatively high data rate requirements , i.e. , @xmath217 frame / slot .",
    "however , with low data rate requirements , dnc - sup and cw - sup perform better than pnc - sup in terms of total energy usage .",
    "it is because , with low data rate requirement , interference in joint decoding in the multi - access uplink plays a negligible role in degrading performance .",
    "however , with high data rate requirements , interference from joint - decoding in the multi - access uplink dominates the performance of the uplink transmission with dnc - sup and cw - sup . on the other hand",
    ", pnc - sup can perform better in the high data rate requirement regime , because the relay node only decodes a function of individual messages in the uplink instead of jointly decoding two messages .",
    "it is also interesting to note that dnc - sup and cw - sup are quite close to each other with symmetric traffic , which intuitively follows from dnc - sup being bounded by the instantaneous minimum gain of two downlink channels and cw - sup suffering from more messages being transmitted in the downlink .",
    "as designed , * popt * always selects the optimal strategy in terms of energy usage and performs best for all rate pair requirements .",
    "we next discuss the performance of the different strategies for asymmetric traffic scenarios ( @xmath218 ) .    in fig .",
    "[ fig : energy_usage_bc ] , we compare the optimal time - sharing solution in @xcite , pnc - zp , pnc - sup , dnc - ts and dnc - sup .",
    "it is observed that with multi - access transmission , dnc - ts performs better than the solution in @xcite in terms of energy usage , as @xcite only considers orthogonal , time - sharing transmissions , which was investigated by yeung in terms of achievable throughput region in @xcite .",
    "hence our strategy also outperforms the strategy in @xcite in terms of energy usage .",
    "it is observed that with superposition coding in the downlink by dnc - sup for asymmetric traffic , we can perform even better in terms of energy , which validates lemma [ lemma : equivalence ] .",
    "it should also be noted that with @xmath19 and @xmath20 approaching each other , the energy benefit from the superposition coding on the downlink gradually decreases as fewer remaining bits can be superimposed on the network coded message .",
    "it is interesting to note that the minimal energy usage by pnc - zp is a constant when @xmath159 and that it performs worse than pnc - sup , which is due to the fact that with zero padding the virtual traffic is determined by @xmath219 and will incur unnecessary energy usage .    in fig .",
    "[ fig : energy_comparison_boche ] , we compare pnc - sup , dnc - ts , dnc - sup and cw - sup .",
    "it is observed that with small rate pair requirements , pnc - sup performs worse than the other strategies .",
    "it is also observed that cw - sup is worse than dnc - sup in terms of energy usage , which verifies our theoretical observation in lemma [ codeword ] .",
    "however , it is noted that dnc - ts , which employs time sharing in the downlink , consumes more energy resources than cw - sup .",
    "this intuitively follows from two facts .",
    "the first is that the network coded message enjoys a channel whose average link gain is less than that of either link in the downlink , while in cw - sup , messages are sent over interference - free individual channels whose average link gains are unity .",
    "the second is that in cw - sup , both messages can use more time resources for transmission in the downlink , whereas in dnc - ts , the network - coded message and the excess bits of the larger message compete for time - resource allocation .    in fig .",
    "[ fig : unequal_gain ] , we compare dnc - sup and cw - sup for different average channel gain pairs .",
    "it can be observed that the total average energy used per slot in the case of @xmath220 is less than that in the case of @xmath221 for both dnc - sup and cw - sup strategies . for dnc - sup",
    ", this is because the energy consumption for the remaining bits of the larger message is determined by @xmath222 , i.e. , @xmath223 and the case with @xmath224 obviously performs better than the case with @xmath225 . for cw - sup ,",
    "it is because the larger message is transferred over the link @xmath226 on the downlink .",
    "hence , the performance of cw - sup improves with higher @xmath227 .",
    "in this work , the problem of minimizing energy usage in a twrn over a fading channel was formulated and solved for various transmit strategies and comparisons were performed .",
    "three transmission strategies were considered : physical - layer network coding ( pnc ) , digital - network coding ( dnc ) , and codeword superposition ( cw - sup ) . in the downlink for dnc ,",
    "a simple time sharing strategy of the digital network - coded message and the remaining bits of the larger message ( dnc - ts ) was first considered and extended to a superposition strategy which superimposed these two messages ( dnc - sup ) . between dnc and cw - sup , the superiority of the superposition of network coded message and the excess bits of the larger message ( dnc - sup ) ,",
    "was demonstrated theoretically in terms of energy usage .",
    "more importantly , it was shown that , in terms of total energy usage , the specific pnc scheme performs better than dnc in the regime of relatively high data rate requirements , and worse than dnc with relatively low data rate requirements .",
    "this provides some insights on when to select pnc or dnc for twrns .",
    "finally , an optimal algorithm to always select the best strategy in terms of energy usage was presented .        c. h. liu , and f. xue , ",
    "network coding for two - way relaying : rate region , sum rate and opportunistic scheduling , \" in _ proc .",
    "communications ( icc08)_,0.5em plus 0.5em minus 0.4emmay .",
    "2008 , pp . 10441049 .",
    "s. l. fong , m. fan and r. w. yeung ,  practical network coding on three - node point - to - point relay networks , \" in _ proc .",
    "information theory ( isit11)_,0.5em plus 0.5em minus 0.4emaug .",
    "2011 , pp . 20552059 .",
    "z. chen , t. j. lim and m. motani ,  digital network coding aided two - way relaying : energy minimization and queue analysis , \" _ ieee trans .",
    "wireless commun._,0.5em plus 0.5em minus 0.4emvol .",
    "4 , pp . 19471957 , apr . 2013 .",
    "b. rankov and a. wittneben ,  spectral efficient signaling for half - duplex relay channels , \" in _ proc",
    ". asilomar conf .",
    "signals , systems and computers ( acssc05)_,0.5em plus 0.5em minus 0.4emoct .",
    "2005 , pp . 10661071 .",
    "t. oechtering and h. boche ,  stability region of an optimized bidirectional regenerative half - duplex relaying protocol , \" _ ieee trans .",
    "commun._,0.5em plus 0.5em minus 0.4emvol .",
    "9 , pp . 15191529 , 2008 .",
    "t. koike - akino , p. popovski and v. tarokh , ",
    "optimized constellation for two - way wireless relaying with physical network coding , \" _ ieee j. sel .",
    "areas commun._,0.5em plus 0.5em minus 0.4emvol .",
    "27 , pp . 773787 , jun . 2009 .",
    "r. louie , y. li , and b. vucetic ,  practical physical layer network coding for two - way relay channels : performance analysis and comparison , \" _ ieee trans .",
    "wireless commun._,0.5em plus 0.5em minus 0.4emvol .",
    "2 , pp . 764777 , 2010 .",
    "a. s. avestimehr , a. sezgin and d. tse ,  capacity of the two - way relay channel within a constant gap , \" _",
    "european trans .",
    "telecommun._,0.5em plus 0.5em minus 0.4emvol . 21 , no .",
    "363 - 374 , 2010 , wiley online library .",
    "m. p. wilson , k. narayanan , h. pfister and a. sprintson ,  joint physical layer coding and network coding for bidirectional relaying , \" _ ieee trans .",
    "theory_,0.5em plus 0.5em minus 0.4emvol . 56 , no . 11 , pp . 56415654 , 2010 .    s. katti , s. gollakota and d. katabi ,  embracing wireless interference : analog network coding , \" _ acm sigcomm computer communication review._,0.5em plus 0.5em minus 0.4emvol . 37 . no",
    "4 , pp . 397408 , acm , 2007 ."
  ],
  "abstract_text": [
    "<S> + in this paper , we consider three transmit strategies for the fading three - node , two - way relay network ( twrn )  physical - layer network coding ( pnc ) , digital network coding ( dnc ) and codeword superposition ( cw - sup ) . </S>",
    "<S> the aim is to minimize the total average energy needed to deliver a given pair of required average rates . </S>",
    "<S> full channel state information is assumed to be available at all transmitters and receivers . </S>",
    "<S> the optimization problems corresponding to the various strategies in fading channels are formulated , solved and compared . for the dnc - based strategies , a simple time sharing of transmission of the network - coded message and the remaining bits of the larger message ( dnc - ts ) </S>",
    "<S> is considered first . </S>",
    "<S> we extend this approach to include a superposition strategy ( dnc - sup ) , in which the network - coded message and the remainder of the longer source message are superimposed before transmission . </S>",
    "<S> it is demonstrated theoretically that dnc - sup outperforms dnc - ts and cw - sup in terms of total average energy usage . </S>",
    "<S> more importantly , it is shown in simulation that dnc - sup performs better than pnc if the required rate is low and worse otherwise . finally , an algorithm to select the optimal strategy in terms of energy usage subject to different rate pair requirements is presented .    two - way , fading , pnc , dnc , energy usage </S>"
  ]
}