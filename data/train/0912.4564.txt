{
  "article_text": [
    "let @xmath3 denote the @xmath4-dimensional hypercube , i.e. , @xmath3 is a graph with @xmath5 vertices , each vertex is labeled by an @xmath4-bit binary string and two vertices are adjacent iff their strings differ exactly in one bit .",
    "the @xmath6-th level of @xmath3 is the set of vertices labeled by strings with exactly @xmath6 ones .",
    "the _ middle levels graph _ is a subgraph of @xmath7 induced by the middle two levels @xmath8 and @xmath9 , and is denoted by @xmath10 ( see fig . [",
    "fg : q5 ] ) .",
    "the _ middle levels conjecture _ asserts that the graph @xmath10 has a hamiltonian cycle for every @xmath8 .",
    "it appears as an  exercise \" in knuth s book ( * ? ? ?",
    "* exercise 56 , sect .",
    "7.2.1.3 ) , in which the conjecture is credited to buck and wiedermann @xcite .     and",
    "the middle levels graph @xmath11.,width=491 ]    in spite of considerable efforts , the conjecture remains open ( see e.g. , @xcite and the references therein ) . it was shown to be true for @xmath12 by moews and reid , and for @xmath13 by shields and savage @xcite and @xmath14 by shields et al .",
    "@xcite .    in this note",
    ", we verify that the conjecture is also true for @xmath2 by constructing a hamiltonian cycle in the middle two levels of 37-dimensional hypercube with the aid of the computer .",
    "we achieve this by plugging a new decomposition technique and an efficient algorithm for ordering the narayana objects into a hamiltonian path heuristic developed by shields et al . @xcite . in the largest case , our program could find a hamiltonian path in a graph with @xmath15 vertices in about a week on a standard pc .",
    "the organization of this note is as follows . in section [ reduce ]",
    ", we briefly review the approach taken by shields et al .",
    "@xcite for reducing the size of the problem . in section [ run ]",
    ", we describe an additional reduction that decomposes the problem into a number of smaller subproblems . in section [ narayana ] , we introduce an efficient algorithm for ordering the narayana objects which was helpful for reducing the resource needed in the computation . finally in section 5 ,",
    "we summarize our computational results . throughout the paper",
    ", @xmath16 denotes the dimension of a hypercube .",
    "the hamiltonicity of the middle levels graph , which has @xmath17 vertices , can be reduced to the problem for finding a suitable hamiltonian path in a smaller graph with @xmath18 vertices @xcite .    for an @xmath4-bit binary sequence @xmath19 ,",
    "define the _ cyclic shift _",
    "@xmath20 by @xmath21 .",
    "for every two vertices @xmath22 and @xmath23 in @xmath24 , @xmath22 and @xmath23 are adjacent iff @xmath25 and @xmath26 are adjacent .",
    "this naturally introduces an equivalence relation @xmath27 on the set of vertices of @xmath24 such that @xmath28 iff @xmath29 for some integer @xmath6 . by noticing that that @xmath30 for every @xmath22 , each equivalence class has @xmath4 elements .",
    "a further reduction can be made by considering the _",
    "complement_. the complement of an @xmath4-bit binary string @xmath31 is @xmath32 .",
    "note that two vertices @xmath22 and @xmath23 are adjacent iff @xmath33 and @xmath34 are adjacent . by considering these two operations , the vertices of @xmath24",
    "is partitioned into @xmath35 classes , each of them has @xmath36 vertices ( fig .",
    "[ fg : redu ] ) . here and hereafter",
    ", we denote the number of vertices of a graph @xmath37 by @xmath38 .    for an @xmath4-bit binary sequence @xmath22 ,",
    "let @xmath39 denote this equivalence class including @xmath22 , i.e. , @xmath40 .",
    "let @xmath41 denote the graph whose vertices are these equivalence classes and two vertices @xmath39 and @xmath42 in @xmath41 are adjacent iff there is an edge between @xmath43 and @xmath44 in @xmath24 for some @xmath45 and @xmath46 .",
    "the following lemma , which was shown by shields and savage @xcite , guarantees that we can lift a hamiltonian path in @xmath41 to a hamiltonian cycle in the middle levels graph .     and its relationship to the vertices of @xmath11.,width=453 ]    [ lem : shields ]",
    "if there is a hamiltonian path in @xmath41 starting from the vertex @xmath47 and ending at the vertex @xmath48 , then there is a hamiltonian cycle in @xmath24 .",
    "since the graph @xmath41 is still huge ( i.e. , @xmath49 ) , we divide @xmath41 into a number of smaller graphs and search them individually and possibly in parallel .",
    "a _ run _ of a binary string @xmath22 is a consecutive appearance of 1 s or 0 s in @xmath22 .",
    "for example , we say that @xmath50 has one run and @xmath51 has four runs",
    ". we will divide @xmath41 into three parts depending on the number of runs of strings in a vertex .",
    "notice that @xmath39 may contain strings having different runs .",
    "we pick a string with @xmath8 one s such that it starts with @xmath52 and ends with @xmath53 as a representative of @xmath39 , and the number of runs of this string is referred as the number of runs of @xmath39 . since",
    "this number is always even , we introduce a new unit called  brun \" which is equal to two runs .",
    "note that , in @xmath41 , only @xmath54 has 1 brun and only @xmath48 has @xmath8 bruns . in a preliminary experiment , we found that a decomposition based on the following three intervals is plausible ( see figs .",
    "[ fg : brun ] and [ fg : part ] ) .     and",
    "the decomposition of @xmath41 based on ",
    "brun\".,width=264 ]    * front part : @xmath55  brun(s ) * middle part : @xmath56  bruns * rear part : @xmath57  bruns    .",
    "each small circle represents an induced subgraph by the vertices with a specified brun.,width=302 ]    note that , when @xmath2 , these three intervals are @xmath58 and @xmath59 .",
    "we will find a hamiltonian path in each of these three graphs and then connect them to get a hamiltonian path in @xmath41 . in order to apply lemma [ lem : shields ]",
    ", we fix the start vertex of a path in the front part to @xmath54 and the end vertex of a path in the rear part to @xmath48 .",
    "in addition , we should satisfy the additional requirements that ( i ) an end vertex of a path in the front part is adjacent to a start vertex of a path in the middle part , and ( ii ) an end vertex of a path in the middle part is adjacent to a start vertex of a path in the rear part .",
    "after some considerations , we pick strings @xmath60 as terminals of paths . note that @xmath61 has a maximum number of neighbors in vertices with @xmath62 bruns and with @xmath63 bruns , respectively .",
    "in addition , ( i ) @xmath64 , ( ii)@xmath65 , and ( iii ) for every @xmath6 , @xmath66 and @xmath67 are adjacent in @xmath41 where @xmath68 denotes the reverse of a string @xmath19 i.e. , @xmath69 . we also use the following fact which can easily be verified .",
    "[ fact : rev ] let @xmath70 be a subset of @xmath71 .",
    "suppose that there is a hamiltonian path in an induced subgraph of @xmath41 with vertices of at least @xmath72 bruns and at most @xmath73 bruns that starts from @xmath39 and ends at @xmath42 .",
    "then there is a hamiltonian path in the same graph that starts from @xmath74 and ends at @xmath75 .    for a hamiltonian path @xmath76 , let @xmath77 denote a hamiltonian path in a same graph whose existence is guaranteed by fact [ fact : rev ] . in summary ,",
    "our search procedure is the following : first find a hamiltonian path in each of three parts of the graph starting from @xmath78 and ending at @xmath79 where @xmath72 and @xmath73 are the left - end and right - end of each interval , and let denote these three paths as @xmath80 , @xmath81 and @xmath82 . then connect @xmath80 , @xmath83 and @xmath82 in this order to get a hamiltonian path in @xmath41 which fulfills the condition in lemma [ lem : shields ] .",
    "each vertex of the graph @xmath41 can naturally be stored using @xmath4 bits of memory . however ,",
    "this can be reduced by using an efficient ordering of the vertices . indeed , since the number of vertices of @xmath41 is less than @xmath84 for @xmath85 , we can store them using a 32-bit integer par item . in this section ,",
    "we give an efficient algorithm for ordering the vertices of our reduced graphs .",
    "a bit surprisingly , plugging this ordering scheme into a program gives a significant improvement of a running time of the program that will be shown in the next section .",
    "the @xmath4-th catalan number is the number of expressions containing @xmath4 pairs of parentheses which are correctly matched and is well - known to be @xmath86 notice that the number of vertices in @xmath41 is equal to the @xmath8-th catalan number @xmath87 .",
    "this suggests that there is a bijection between the set of vertices of @xmath41 and the set of correctly matched @xmath4 pairs of parentheses .",
    "in the following , we identify a sequence of parentheses with a binary string under a mapping ",
    "( \" @xmath88  0 \" and  ) \" @xmath88  1 \" .",
    "in addition , by a technical reason , we add one  0 \" to the top of the string .",
    "for example , we consider that  ( ( ) ( ( ) ) ) \" represents the string `` @xmath89 '' .",
    "an @xmath0 bit binary string starting with @xmath52 is said to be _ correctly matched _ if it is corresponding to a correctly matched @xmath4 pairs of parentheses .",
    "for every vertex @xmath39 in @xmath41 , there is a unique correctly matched string in @xmath39 .",
    "we should only consider a string with @xmath8 one s since no string with @xmath9 one s is correctly matched .",
    "suppose that we represent a string by a path in the grid such that it goes upward when we read 0 and downward when we read 1 .",
    "for example , a path for the string @xmath90 is drawn as fig .",
    "[ fg:0000111 ] .",
    "it is clear that a string @xmath22 is correctly matched iff the starting point of the path for @xmath22 is located at the lowest level in the path and it is only the point on this level .",
    "recall that @xmath39 contains every string that obtained from @xmath22 by applying the cycle shift an arbitrary times .",
    "note that , for every @xmath22 with @xmath8 one s , a path for @xmath22 ends at one step higher than the starting point of the path .",
    "hence if we draw paths for @xmath22 and @xmath91 for some @xmath6 , a path for the substring that shifted backward in @xmath91 is drawn at one level higher than the original level ( fig .",
    "[ fg : cycle ] ) .",
    "( a ) and for @xmath92 ( b ) .",
    "a dotted line represents a path for the substring ` 01101 ' which goes backward by the cycle shift in ( b).,width=264 ]    by this observation , it is easy to see that a correctly matched string in @xmath39 can be obtained by ( i ) draw a path for @xmath22 , and pick the rightmost point among all points on the lowest level of the path , and ( ii ) shift @xmath22 so that this point becomes the top of the resulting string .",
    "it is also easy to see that every other string in @xmath39 is not correctly matched .",
    "this guarantees the uniqueness and hence completes the proof .    by this fact",
    ", there is a bijection from the set of vertices in @xmath41 to the catalan objects , i.e. , the vertices in @xmath41 are uniquely mapped to integers @xmath93 .      in our programs , we number vertices @xmath39 in @xmath41 according to the lexicographical ordering ( starting from 0 ) of a correctly matched string in @xmath39 .",
    "obviously , the ordering of a string @xmath22 is equal to the number of strings lexicographically smaller than @xmath22 . hence if we can count the number of strings smaller than @xmath94 for a given prefix @xmath94 , then the ordering of @xmath22 can easily be computed .",
    "for example , the ordering of the string @xmath95 in a set @xmath96 can be computed as the sum of the numbers of strings in @xmath97 starting from @xmath98 , @xmath99 and @xmath100 .",
    "let @xmath101 be the set of correctly matched strings of length @xmath102 .",
    "for a prefix @xmath103 with @xmath104 , the number of strings in @xmath105 starting with @xmath94 is shown to be @xmath106 where @xmath107 and @xmath108 .",
    "here we denote the number of @xmath52 s and @xmath53 s in @xmath94 by @xmath109 and @xmath110 , respectively .",
    "intuitively , @xmath111 denotes the height of the end point of a path for @xmath94 and @xmath8 denotes the number of  remaining \" one s in a string ( see fig .",
    "[ fg : weight ] ) .",
    "note that these numbers are known as the catalan triangle ( see e.g. , the sequence a009766 of @xcite )",
    ". using eq .",
    "( [ eq : cat ] ) , we can calculate the lexicographical ordering of a vertex @xmath39 efficiently .",
    "for example , the ordering of @xmath112 is given by @xmath113 .",
    "is equal to the number of left - right paths in the grid.,width=188 ]      since we decompose the graph @xmath41 into smaller parts , it is desirable to give an efficient ordering algorithm for the set of vertices of these decomposed graphs . by a similar argument to",
    "that in section 4.1 , the number of vertices of @xmath41 with @xmath73 bruns is shown to be @xmath114 which is known as the narayana numbers .",
    "@xmath115 is the number of correctly matched @xmath8 pairs of parentheses that contains the subsequence ",
    "( ) \" exactly @xmath73 times . note that the catalan numbers are represented by the sum of the narayana numbers , i.e. , @xmath116    it is also shown that the lexicographical ordering of a string @xmath22 in the set of correctly matched strings with @xmath73 bruns can be efficiently computed using the following formula : @xmath117 that represents the number of correctly matched strings of which the meanings of @xmath111 and @xmath8 are the same as in eq .",
    "( [ eq : cat ] ) and @xmath73 denotes the ` remaining ' number of the subsequence  ( ) \" .",
    "a detailed discussion on how to compute the ordering for such narayana objects will be appeared in the full version of this note .",
    "we develop a program for finding a hamiltonian path for decomposed graphs based on the algorithm proposed by shields et al.@xcite in which we represent the vertices of graphs by the ordering described in section [ narayana ] . using this program ,",
    "we have succeeded to find a desired hamiltonian path for every three parts , i.e. , the front , middle , rear parts of @xmath41 for every @xmath118 , which shows the hamiltonicity of the middle levels graphs for @xmath119 .",
    "note that , for smaller values of @xmath8 , our decomposition schema would not work .",
    "the computational results are summarized in table [ result ] .",
    "our program is executed on a pc with an intel xeon processor of @xmath120 ghz and @xmath121 gb of memory available .",
    "note that the maximum memory used in our experiments was about @xmath122 gb . we show the elapsed time in seconds , and the case that takes less than 1 second is shown as 0 .",
    "the second column shows the elapsed time of a base program to find a path in the entire graph @xmath41 . in a base program",
    ", we do nt use our ordering scheme and vertices are stored as @xmath4-bit strings .",
    "the third column shows the longest elapsed time of a base program for finding a path in each of three decomposed graphs . the fourth column shows the elapsed time of a program with the ordering technique for the entire graph @xmath41 .",
    "the later columns show the elapsed time of a program in which both techniques , i.e. , the decomposition described in section 3 and the ordering described in section 4.3 are included .",
    "a bit surprisingly , introducing the ordering into a search program gives a significant improvement of the running time .",
    "the combination of our two techniques reduces the running time by a factor of about 30 when @xmath123 . for @xmath2 ,",
    "the number of vertices of the front , middle and rear parts of the graph is @xmath124 , @xmath125 and @xmath124 , respectively .",
    "notice that the running time is the longest for the front part of the graph .",
    "this suggests that finding a hamiltonian path is harder for a graph consisting of vertices with smaller number of runs than that with larger number of runs .",
    "the source codes of the programs we used as well as some additional data are available on the web page @xcite . note that our program can handle up to @xmath126 . at the time of writing this note ,",
    "the search for the front and rear parts of the graph for @xmath126 has been finished successfully , and that for the middle part , which has about @xmath127 billion nodes , is in progress .",
    "several months after writing the above , our program for finding a hamiltonian path in the middle part of the graph for @xmath126 has successfully terminated .",
    "this confirms that the middle two levels of @xmath128-dimensional hypercube is also hamiltonian .",
    "the number of vertices of the front , middle and rear parts of the graph is about @xmath129 , @xmath130 and @xmath129 , respectively .",
    "the running time of the program ( executed on the same machine as above ) is about 56 days , 81 days and 27 days , respectively .",
    "m.  buck and d.  wiedermann , _ gray codes with restricted density _",
    ", 48 , 163171 ( 1984 ) j.r .",
    "johnson , _ long cycles in the middle two layers of the discrete cube _ , j.combin .",
    "theory ser .",
    "a 105 ( 2 ) , 255271 ( 2004 ) d.e .",
    "knuth , _ the art of computer programming volume 4 , fascicle 3 _ , addison - wesley pub ( 2005 ) i.  shields and b.j .",
    "shields and c.d .",
    "savage , _ an update on the middle levels problem _ , disc .",
    ", 309 , 52715277 ( 2009 ) i.  shields and c.d .",
    "savage , _ a hamilton path heuristic with applications to the middle two levels problem _ , congressus numerantium , 140 , 161 - 178 ( 1999 ) m.  shimada and k.  amano , supplement of the paper available at http://www.cs.gunma-u.ac.jp/~amano/mlc/index.html n.j.a .",
    "sloane , the on - line encyclopedia of integer sequences , http://www2.research.att.com/~njas/sequences/"
  ],
  "abstract_text": [
    "<S> the middle levels conjecture asserts that there is a hamiltonian cycle in the middle two levels of @xmath0-dimensional hypercube . </S>",
    "<S> the conjecture is known to be true for @xmath1 [ i.  shields , b.j .  </S>",
    "<S> shields and c.d .  </S>",
    "<S> savage , disc . </S>",
    "<S> math . </S>",
    "<S> , 309 , 52715277 ( 2009 ) ] . in this note </S>",
    "<S> , we verify that the conjecture is also true for @xmath2 by constructing a hamiltonian cycle in the middle two levels of 37-dimensional hypercube with the aid of the computer . </S>",
    "<S> we achieve this by introducing a new decomposition technique and an efficient algorithm for ordering the narayana objects . </S>"
  ]
}