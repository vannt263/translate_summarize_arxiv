{
  "article_text": [
    "whereas the reduction of turbulent transport by zonal flows is a widely accepted phenomenon  @xcite , its quantitative understanding is still poor .",
    "the determination of the zonal flow amplitude and turbulent transport level are nonlinear questions whose answers require costly gyrokinetic simulations .",
    "the cost grows enormously if , by means of parameter scans , one wants to know how those quantities depend on the magnetic geometry or the plasma conditions .",
    "a useful simplification is provided by the initial value problem consisting of calculating the long - time and collisionless evolution of a zonal perturbation . among other reasons ,",
    "its usefulness is due to the fact that an exact expression for the value of the perturbation at @xmath0 , called residual value , can be derived .",
    "even though the explicit evaluation of the final expression can only be carried out in simplified geometries and for long wavelengths of the perturbation , the analytical solution gives insight into the physics .",
    "this partly explains the attention attracted by the work of rosenbluth and hinton  @xcite and the effort put on subsequent extensions that we cite below . in stellarator research ,",
    "the interest in this problem was spurred by the suggestion  @xcite of a direct relation between zonal flow residual value and turbulent transport level .    the seminal paper  @xcite dealt with long - wavelength potential perturbations in large aspect ratio and circular cross section tokamaks .",
    "explicit solutions of related problems for more complex tokamak geometries and arbitrary wavelengths have been given in  @xcite . in recent years",
    ", several articles have addressed the problem in stellarators  @xcite . in this paper",
    "we report on a code to evaluate fast and accurately the exact expressions of the zonal flow residual value , for arbitrary wavelengths and for tokamak and stellarator geometries . but why is this useful if the same answer can be obtained , in principle , by linear runs of a local gyrokinetic code ?",
    "as we will illustrate later on , it turns out that the solution by means of gyrokinetic simulations of the residual zonal flow problem , especially at short wavelengths , is very demanding in terms of computational resources .",
    "we will show that our method is faster .",
    "these differences can be of several orders of magnitude in computing time , especially in the case of stellarators .",
    "moreover , the code and the results of this work are not only interesting from the point of view of physics , but also for validation of gyrokinetic codes .",
    "the rest of the paper is organized as follows . in section  [ sec : residual ]",
    "we derive the residual zonal flow expressions for arbitrary wavelengths and magnetic geometry . in section",
    "[ sec : cas3dk ] we report on the code used to evaluate the expressions presented in section  [ sec : residual ] . as a check",
    ", we compare our calculations with analytical results from @xcite , obtained in simplified tokamak geometry . in order to avoid any confusion",
    ", we note that the results in @xcite were not derived as an initial value problem , but as the stationary solution of a forced system .",
    "we explain this in more detail in section  [ sec : cas3dk ] . in section  [ sec : results ] our results are compared with local and global gyrokinetic simulations of the initial value problem , employing the codes gene  @xcite and euterpe @xcite , respectively .",
    "we also compare the differences in computational time required by each approach showing that the method introduced in this paper is faster than those gyrokinetic simulations .",
    "stellarator residual values are calculated , using our method and also gyrokinetic codes , for a range of wavelengths much wider than previously available in the literature .",
    "the stellarator calculations are done for the standard configuration of wendelstein 7-x ( w7-x ) .",
    "we comment on a purely stellarator effect already predicted in  @xcite ; namely , that the approximation of adiabatic electrons is always incorrect ( even at long wavelengths ) for the purpose of determining the residual zonal flow in stellarators .",
    "we quantify the error by computing , with our method , the residual value when kinetic or adiabatic electrons are used .",
    "this result is confirmed by gyrokinetic simulations .",
    "the conclusions are presented in section  [ sec : conclusions ] .    throughout this paper , we assume that the electrostatic potential @xmath1 associated to the zonal flow is constant on flux surfaces .",
    "it is true that zonal flows ( _ i.e. _ flows that are only weakly damped , and therefore remain in the plasma for long times ) usually correspond to electrostatic potentials with small variations on flux surfaces , but we should emphasize that assuming that @xmath1 is constant on flux surfaces is , at most , a good approximation .",
    "in this section , we give a detailed calculation of the residual zonal flow for arbitrary wavelengths in tokamak and stellarator geometries .",
    "we solve the linear and collisionless gyrokinetic equations at long times , assuming that the electrostatic potential perturbation is constant on flux surfaces .    in strongly magnetized plasmas ,",
    "one employs the smallness of @xmath2 to average over the gyromotion . here",
    ", @xmath3 is the characteristic length of variation of the magnitude of the magnetic field @xmath4 , @xmath5 is the thermal gyroradius , @xmath6 is the thermal speed , @xmath7 is the gyrofrequency , @xmath8 is the equilibrium temperature , @xmath9 is the mass , and @xmath10 is the charge of species @xmath11 , where @xmath12 is the proton charge .",
    "gyrokinetic theory  @xcite gives a procedure to rigorously derive the gyroaveraged kinetic equations order by order in @xmath13 .",
    "the averaging operation is conveniently expressed in a new set of phase space coordinates , called gyrokinetic coordinates .",
    "denote by @xmath14 the particle position and velocity .",
    "the coordinate transformation , to lowest order in @xmath15 , is given by @xmath16    \\mathbf{v } =     v_{\\parallel}(\\mathbf{r},v,\\lambda,\\sigma)\\hat\\mathbf{b}(\\mathbf{r } ) +     \\omega_s    { \\mbox{\\boldmath$\\rho$}}_s(\\mathbf{r},v,\\lambda,\\gamma)\\times\\hat\\mathbf{b}(\\mathbf{r } )   + o(\\rho_{ts\\star}v_{ts}).\\end{aligned}\\ ] ] in equation ( [ eq : gyrokintrans ] ) , @xmath17 is the gyrocenter position , @xmath18 is the magnitude of @xmath19 , @xmath20 is the pitch angle , @xmath21 is the sign of the parallel velocity @xmath22 @xmath23 is the unit vector in the direction of the magnetic field @xmath24 , @xmath25 is the component of the velocity perpendicular to @xmath24 , and @xmath26 is the gyroradius vector , defined as @xmath27.\\ ] ] here , @xmath28 and @xmath29 are unit vector fields orthogonal to each other which satisfy @xmath30 at every point .",
    "finally , the gyrophase @xmath31 is @xmath32    we introduce straight field line coordinates @xmath33 , where @xmath34 $ ] is the radial coordinate defined as the normalized toroidal flux @xmath35 , @xmath36 is a poloidal angle and @xmath37 is a toroidal angle , with @xmath38 . the magnetic field in these coordinates is written as @xmath39 here , @xmath40 is the safety factor , and @xmath41 and @xmath42 are the derivatives of the poloidal and toroidal fluxes with respect to @xmath43 .",
    "it will be convenient to define the coordinate @xmath44 , that labels magnetic field lines on each flux surface .",
    "unless otherwise stated , we use @xmath45 as the set of independent spatial coordinates . note that @xmath46 , @xmath47 .",
    "we employ @xmath36 as the coordinate along a field line .    the distribution function in gyrokinetic coordinates , @xmath48 ,",
    "can be written as @xmath49 where @xmath50 and @xmath51 is a maxwellian distribution whose density @xmath52 and temperature @xmath53 are flux functions , @xmath54 the lowest - order quasineutrality condition implies @xmath55 . note",
    "that to @xmath56 the distribution function is independent of the gyrophase .",
    "the linear and collisionless time evolution of @xmath57 is given by  @xcite @xmath58 \\fl\\hspace{1 cm } + \\frac{1}{b}\\left(\\nabla\\langle\\varphi\\rangle \\times\\hat\\mathbf{b}\\right)\\cdot\\nabla\\psi \\left[\\frac{n_s'}{n_s }       + \\left(\\frac{m_s v^2}{2 t_s } +        \\frac{3}{2}\\right)\\frac{t_s'}{t_s } \\right ] f_{s0},\\end{aligned}\\ ] ] where primes denote differentiation with respect to @xmath43 , the function @xmath59 is defined by @xmath60 the gyroaveraged electrostatic potential is @xmath61 and the magnetic drift velocity reads @xmath62 .",
    "\\label{eq : driftv}\\ ] ]    the orderings in gyrokinetic theory allow to separate the variations of the fields on the small and large scales , and decompose in fourier modes with respect to the former . since we are interested in studying the evolution of an electrostatic potential perturbation that depends only on @xmath43 and the problem is linear , we can take a single mode of the form @xmath63 here , @xmath64 with @xmath65 , and @xmath66 varies on the macroscopic scale @xmath3 .",
    "observe that , due to the effects of magnetic geometry , the dependence of @xmath66 on @xmath43 can not be avoided even for flat density and temperature profiles .",
    "a recent explanation of scale separation , as well as a proof of the equivalence between the local and global approaches to gyrokinetic theory can be found in @xcite .",
    "to lowest order , the gyroaveraged electrostatic potential is @xmath67 where the magnitude of the gyroradius vector is @xmath68 and @xmath69 is the zeroth - order bessel function of the first kind , @xmath70 if the electrostatic potential has the form ( [ eq : eikonalvarphi ] ) , then the distribution function can be written as @xmath71 and consequently @xmath72 where @xmath73 and @xmath74 vary on the scale @xmath3 .",
    "then , equation ( [ eq : gk0 ] ) becomes @xmath75 where we have used the notation @xmath76 for the radial magnetic drift frequency and @xmath77 .",
    "from now on , and for brevity , we omit the dependence of @xmath66 on @xmath43 ; that is , we write @xmath78 instead of @xmath79 .",
    "denote by @xmath80 the frequency associated to the time derivative in ( [ eq : gk2 ] ) .",
    "the objective is to expand ( [ eq : gk2 ] ) in powers of @xmath81 , solve the lowest order equations and determine @xmath78 in the limit @xmath82 .",
    "the @xmath81 expansion means , in particular , that we average over the lowest order particle trajectories and solve for time scales much longer than a typical orbit time , which is @xmath83 .",
    "we define the orbit average for a phase - space function @xmath84 as @xmath85 where @xmath86^{-1}$ ] is the bounce frequency . given a function @xmath87 , the flux surface average is defined by @xmath88 here , @xmath89^{-1}$ ] is the square root of the metric determinant and @xmath90 is the derivative of the volume enclosed by the flux surface labeled by @xmath43 .",
    "the symbol @xmath91 stands for integration over the trapped trajectory , where the bounce points @xmath92 are the solutions of @xmath93 for given values of @xmath43 and @xmath94 , and given an initial condition for the particle trajectory .",
    "observe that the orbit average operation has the property @xmath95 for any single - valued function @xmath96 .",
    "we write the radial magnetic drift frequency as a sum of its orbit averaged and fluctuating parts @xmath97 where @xmath98 , that we choose to be odd in @xmath99 , is the radial displacement of the particle s gyrocenter from its mean flux surface .",
    "the solution of the magnetic differential equation that determines @xmath100 is given in  [ sec : mde ] .",
    "defining @xmath101 and @xmath102 , equation ( [ eq : gk2 ] ) yields @xmath103 it is worth noting that the expansion in @xmath104 only makes sense if @xmath105 for @xmath106 , this implies @xmath107 this trivially holds in a tokamak because @xmath108 for all trajectories . in a generic stellarator , @xmath108 only for passing particles .",
    "then , condition ( [ eq : condexpansion ] ) requires that the secular radial drifts of trapped particles be sufficiently small .",
    "we assume that this is the case and carry out the expansion in @xmath104 .",
    "we write @xmath109 with @xmath110 . then , we expand equation ( [ eq : gkunderlinedvariables ] ) .",
    "to lowest order , one obtains @xmath111 implying that @xmath112 is constant along the lowest order trajectories ; _ i.e. _ @xmath113 to next order , we have @xmath114 we do not write @xmath115 to ease the notation . the orbit average of ( [ eq : nextordereqnotinlaplacespace ] ) annihilates the term @xmath116 , and we find @xmath117 it is useful to work in laplace space in order to solve this equation .",
    "the laplace transform of a function @xmath118 is defined as @xmath119 , where @xmath120 denotes the variable in laplace space .",
    "we apply it to ( [ eq : nextordereqnotinlaplacespaceaveraged ] ) and obtain @xmath121 here , @xmath122 and @xmath123 is the initial condition for @xmath73 ; _ i.e. _ @xmath124 .",
    "the solution of ( [ eq : nextordereqinlaplacespaceaveraged ] ) yields @xmath125    in order to have a closed system of equations we employ the gyrokinetic quasineutrality equation ( see , for example , references @xcite ) , @xmath126 here , the short - hand notation @xmath127 means , for a function @xmath128 , @xmath129 using ( [ eq : eikonalvarphi ] ) and ( [ eq : eikonalh ] ) , and flux - surface averaging , we get @xmath130 to lowest order in @xmath81 , and after transforming to laplace space , equation ( [ eq : qn2 ] ) gives @xmath131 we employ ( [ eq : gk6 ] ) to write the right side of ( [ eq : qn2aux ] ) in terms of the electrostatic potential and the initial condition , and solve for @xmath132 .",
    "the result is @xmath133 where we have simplified the notation by defining @xmath134 for gyrophase independent functions on phase space .",
    "the residual value is found from the well - known property of the laplace transform @xmath135 applying ( [ eq : propertylaplacetransform ] ) to equation ( [ eq : qn3 ] ) , we find @xmath136    } ,    \\label{eq : rsk}\\ ] ] where @xmath137 .",
    "the superscript @xmath108 means that the integration is performed only for particles whose trajectory satisfies @xmath108 . in tokamaks ,",
    "this property holds true for both trapped and passing particles , and therefore the integrals in ( [ eq : rsk ] ) are performed over the whole phase space . in stellarators , @xmath108 is satisfied exclusively for passing particles . only in perfectly omnigenous stellarators  @xcite",
    "have trapped particles vanishing average radial magnetic drift .",
    "hence , in a generic stellarator , the integrals in ( [ eq : rsk ] ) with superscript @xmath108 are performed only over the passing region of phase space .",
    "the residual level is usually defined as the normalized value @xmath138 .",
    "the relation between @xmath123 and @xmath139 is given by the flux - surface averaged quasineutrality equation at @xmath140 , @xmath141 here , we have employed the identity @xmath142 , where @xmath143 , and @xmath144 is the zeroth order modified bessel function .",
    "we will use the notation @xmath145 .    for later comparison with gyrokinetic simulations",
    ", it will be useful to have at hand the expressions corresponding to the approximation of adiabatic electrons . using this approximation , equation ( [ eq : qn2 ] )",
    "can be written as @xmath146 proceeding as shown previously for the fully kinetic case , we find that the expression for @xmath147 reads @xmath148    } .",
    "\\label{eq : rsa}\\ ] ] in this case , the equation that relates @xmath123 and @xmath139 is @xmath149    the residual zonal flow was computed in reference @xcite for @xmath150 in a large aspect ratio , circular cross section tokamak with adiabatic electrons .",
    "an extension of the derivation of @xcite was proposed in references @xcite to allow for short - wavelength perturbations , and also for kinetic electrons and more complex tokamak geometries . in reference @xcite ,",
    "comparisons of analytical calculations with gyrokinetic simulations are shown .",
    "the enhancement of tokamak residual zonal flows at short wavelengths was originally found in reference @xcite by means of gyrokinetic simulations with the code gs2 .",
    "but the short - wavelength calculations of @xcite do not correspond to an initial zonal value problem because the quasineutrality equation is forced with a source term . at long wavelengths , the initial value problem and the forced system",
    "give the same result .",
    "this will be explained in more detail in section [ sec : cas3dk ] .    in stellarators ,",
    "the residual zonal flow calculation has been done in @xcite . in references",
    "@xcite the emphasis is put on long - wavelength zonal flows . in references",
    "@xcite , the derivation of the equations is valid for long and short - wavelengths but some approximations are used to describe the magnetic geometry .",
    "the evaluation of the right side of equation ( [ eq : rsk ] ) ( and , of course , ( [ eq : rsa ] ) ) requires the calculation of quantities of the form @xmath151 for functions @xmath152 and @xmath153 , where the orbit average is defined in ( [ eq : bounceaverages ] ) .",
    "these averages depend on the details of the magnetic field and can not be evaluated analytically , except in simplified cases ( for example , in the cases considered in @xcite ) . in this work , we evaluate equation ( [ eq : rsk ] ) using the framework of the code cas3d - k @xcite . for this purpose ,",
    "we have included in this code the relevant finite larmor radius effects , the solution to the magnetic differential equations described in [ sec : mde ] , and the integration over the velocity coordinates @xmath18 and @xmath99 .",
    "the code cas3d - k is well suited to perform the average ( [ eq : bounceaverages ] ) .",
    "since the lowest order particle trajectories lie entirely on flux surfaces , all the calculations are local , thus permitting a parallelization by flux surface using mpi .",
    "the magnetic equilibrium is obtained from the 3d mhd equilibrium code vmec  @xcite and then transformed into boozer coordinates @xmath33 , which can easily be transformed to the coordinates @xmath154 . on a given flux surface ,",
    "the pitch angle @xmath155 distinguishes between passing and trapped trajectories .",
    "the passing - trapped boundary is given by @xmath156 , where @xmath157 is the maximum of @xmath4 on the flux surface .",
    "passing particles have @xmath155 values with @xmath158 and trapped particles are those with @xmath159 , where @xmath160 is the minimum of @xmath4 on the flux surface . trapped particles can live inside one or several magnetic field periods . in cas3d - k ,",
    "they are grouped by the number of periods they go through .",
    "the groups are obtained by setting a large number of initial conditions for the trajectories , and finding the bounce points @xmath92 from the bounce condition @xmath161 for constant @xmath43 and @xmath94 . from this procedure , the boundaries of each group are found and the numerical integration for a given group is performed by covering the region they define with new trajectories .",
    "note that each group requires different numerical resolution .",
    "some trapped trajectories close to the passing - trapped boundary may require a large number of periods until the bounce points are found .",
    "if this number is sufficiently large , typically larger than 500 periods , the trajectories are then considered as passing .",
    "a gauss - legendre quadrature scheme is used for the integration in @xmath36 , @xmath94 and @xmath155 , which avoids the numerical problems that may appear at points where @xmath162 .    in reference",
    "@xcite , the phase space integrations with cas3d - k discussed in the previous paragraph were employed to obtain the zonal flow frequency in stellarator geometry in the long - wavelength limit . in this limit",
    ", there are some simplifications .",
    "we have implemented new functionalities in cas3d - k that also allow to deal with short wavelengths .",
    "next , we describe the main features of this extension of cas3d - k .",
    "first , we note that the integration of the resulting expressions over the velocity coordinate @xmath18 could be performed analytically in @xcite .",
    "if one wants to calculate the averages involved in ( [ eq : rsk ] ) , the integration over the velocity coordinates @xmath18 and @xmath99 must be computed numerically .",
    "we have included in cas3d - k the integration over these coordinates on top of the @xmath36 , @xmath94 and @xmath155 integrations .",
    "for the integration over @xmath18 , a linear scheme has been used .",
    "this scheme allows the computation of any moment in @xmath18 of the maxwellian distribution function , @xmath163 .",
    "second , the equations to obtain the residual level ( [ eq : rsk ] ) and ( [ eq : rsa ] ) incorporate finite larmor radius effects .",
    "these effects are encoded in @xmath164 , @xmath165 and @xmath166 .",
    "here , @xmath167 where @xmath168 is an input parameter and the quantity @xmath169 is obtained from the vmec equilibrium .",
    "we have included those factors and adapted the resolution of the integration on phase space to their strong oscillatory behavior at short wavelengths .",
    "we have also implemented in the code the expression of @xmath100 in stellarator geometry , for both passing and trapped particles ( see the derivations in [ sec : mde ] ) . for passing particles ,",
    "@xmath100 is given by equation ( [ eq : deltap ] ) and for trapped particles it is given by equation ( [ eq : mdet3 ] ) .",
    "the above modifications included in cas3d - k allow us to calculate the residual level in tokamak or stellarator geometry for arbitrary wavelengths . in the rest of the paper",
    ", we use the terminology `` cas3d - k '' and `` extension to cas3d - k '' interchangeably .    ) , by ( [ eq : xckequaltozero ] ) , and by the evaluation of ( [ eq : rsa ] ) with cas3d - k in the long - wavelength limit .",
    "a tokamak with major radius @xmath170  m , minor radius @xmath171  m , and @xmath172 profile given in figure [ fig : qprofilesectionanalyticalchecks ] has been used . ]    as a preliminary check of these extensions to cas3d - k , in this section we compare our results with analytical results available in the literature . for these comparisons ,",
    "we take a plasma consisting of singly charged ions and electrons , and assume flat density and temperature profiles with the same values for both species .    .",
    "]    in reference @xcite , rosenbluth and hinton ( r - h ) calculated the residual level in large aspect ratio tokamaks with circular cross section and adiabatic electrons , in the limit @xmath173 . denote the safety factor by @xmath172 and the inverse aspect ratio by @xmath174 , where @xmath175 is the minor radius and @xmath176 is the major radius .",
    "the result obtained in @xcite is @xmath177 in reference @xcite , xiao and catto gave an expression more accurate in the inverse aspect ratio expansion .",
    "namely , @xmath178 both of these results were obtained by using the analytical equilibrium of a large aspect ratio circular tokamak which , in our coordinates , is given by @xmath179 where @xmath180 is the magnetic field strength at the magnetic axis . the analytical solutions ( [ eq : rh ] ) and ( [ eq : xckequaltozero ] )",
    "are plotted in figure [ fig : rhxc ] , together with the numerical evaluation of ( [ eq : rsa ] ) with cas3d - k , for @xmath173 and a maxwellian initial condition .",
    "we use an axisymmetric tokamak with major radius @xmath170  m , minor radius @xmath171  m , and @xmath172 profile given in figure [ fig : qprofilesectionanalyticalchecks ] . for the cas3d - k computations ,",
    "the equilibrium is obtained with vmec employing the aspect ratio and safety factor values just mentioned .",
    "the wavenumber used in the cas3d - k calculation is @xmath181 and the dimensionless quantity @xmath182 ranges from 0.0015 in the innermost radial position to 0.0068 in the outermost one .",
    "we have checked that the residual zonal flow value obtained with cas3d - k and shown in figure [ fig : rhxc ] does not change if @xmath183 is further decreased .",
    "the regions of figure [ fig : rhxc ] where the curves agree and where the curves differ are as expected ( see the remarks in @xcite about figure 3(a ) in that reference ) .",
    "the analytical equilibrium of a large aspect ratio circular tokamak , used in deriving the equations ( [ eq : rh ] ) and ( [ eq : xckequaltozero ] ) , differs less from the numerical equilibrium obtained with vmec in radial positions closer to the center .",
    "we will see in section [ sec : results ] that the cas3d - k results coincide with gyrokinetic simulations of zonal flow evolution , in which vmec equilibria are also used .    ) , with @xmath184 , and for the numerical equilibrium obtained with vmec ( with @xmath170 m , @xmath171 m ) at @xmath185 . ]    as explained above , xiao and catto ( x - c ) also addressed in references @xcite the extension of the calculation in @xcite to short wavelengths .",
    "they gave the result @xmath186 for the residual zonal flow in a tokamak at arbitrary wavelengths and with kinetic electrons .",
    "the expression provided by x - c for the case of adiabatic electrons is @xmath187    ) with cas3d - k .",
    "the parameters of the tokamak are the same as in figure [ fig : rhxc ] . ]    in order to avoid any confusion , we have to point out that ( [ eq : xck ] ) and ( [ eq : xca ] ) were not derived as the solution of the initial value problem explained in section [ sec : residual ] , but assuming that the quasineutrality equation is forced with a source term .",
    "the argument of x - c can be streamlined as follows .",
    "go back to ( [ eq : rsk ] ) for the tokamak case ( that is , @xmath108 for all particles ) .",
    "x - c consider that finite orbit width effects do not affect the initial condition ; _ i.e. _ @xmath188 \\fl \\hspace{1 cm } \\sum_s z_s\\left\\{j_{0s } f_s(0)/f_{s0 }   \\right\\}_s = \\left\\langle \\sum_s z_s \\int   j_{0s } f_s(0 )   \\mathrm{d}^3 v \\right\\rangle_\\psi .",
    "\\label{eq : xcapprox}\\end{aligned}\\ ] ] hence , in this approximation , ( [ eq : rsk ] ) gives @xmath189    } .",
    "\\label{eq : xcapprox}\\ ] ] the quasineutrality equation at @xmath140 , ( [ eq : qn4 ] ) , can be trivially rewritten as @xmath190 from the quotient of ( [ eq : xcapprox ] ) and ( [ eq : qnt0again ] ) , one obtains equation ( [ eq : xck ] ) .",
    "analogously , one can obtain ( [ eq : xca ] ) from ( [ eq : rsa ] ) . from these manipulations , it is clear that in the x - c calculation the charge perturbation at @xmath140 can be viewed as a constant source term in the quasineutrality equation ( see also the remark after equation ( [ eq : rlta ] ) ) .",
    "references @xcite and @xcite provided analytical evaluations of the right sides of ( [ eq : xck ] ) and ( [ eq : xca ] ) for simplified tokamak geometries .",
    "since we can directly evaluate the right sides of ( [ eq : xck ] ) and ( [ eq : xca ] ) with cas3d - k , we will compare the results as an additional check of our numerical tool .    ) with cas3d - k .",
    "the parameters of the tokamak are the same as in figure [ fig : rhxc ] . ]    in @xcite , the analytical equilibrium of a circular cross section , large aspect ratio tokamak with safety factor @xmath191 and inverse aspect ratio @xmath184 was used . for the calculations with cas3d - k",
    ", we employ the vmec tokamak equilibrium described above , which has similar parameters at @xmath185 . at this radial position ,",
    "the vmec equilibrium satisfies @xmath191 and @xmath184 within an error of 1.5% ( @xmath192 and @xmath193 ) .",
    "the difference between the vmec equilibrium and the analytical one is illustrated in figure [ fig : bfield ] , where we compare the magnetic field strength along a field line for both equilibria . in the vmec equilibrium ,",
    "the value of the magnetic field strength at the magnetic axis is @xmath194 t. in general , deviations from circularity are expected in the numerical equilibrium because of effects like the shafranov shift that are not taken into account in the analytical equilibrium .",
    "these deviations are smaller for radial positions closer to the center .",
    "the comparisons for the cases with fully kinetic species ( [ eq : xck ] ) and with adiabatic electrons ( [ eq : xca ] ) are shown in figures [ fig : xc2 ] and [ fig : xc1 ] .",
    "the agreement is quite good .",
    "the fact that the curves present some differences , especially at short wavelengths , is not surprising because the equilibria are not identical .",
    "as already advanced above , we will see that the cas3d - k calculations agree very well with the results from gyrokinetic simulations carried out with gene  coupled to gist @xcite and euterpe , that also employ vmec equilibria .",
    "it should be noted that further gyrokinetic codes with similar capabilities exist .",
    "the independently developed code gkv - x @xcite , for instance , is also able to handle vmec equilibria .    in the next section ,",
    "we compare cas3d - k calculations of the residual zonal flow with the results obtained from gyrokinetic simulations .",
    "in this section , we calculate the residual zonal flow as an initial value problem for a wide range of radial wavelengths in tokamak and stellarator geometries .",
    "we use the numerical techniques explained in section  [ sec : cas3dk ] to evaluate the required averages using the code cas3d - k .",
    "these calculations will be compared with the results from two gyrokinetic codes , showing that the extension of cas3d - k is faster .",
    "the residual level for the initial value problem is given by ( [ eq : rsk ] ) , once an initial condition @xmath123 has been specified .",
    "this initial condition has to satisfy ( [ eq : qn4 ] ) .",
    "an initial condition fulfilling this equation is @xmath195 using ( [ eq : ic ] ) , we find that the expression for the residual level is @xmath196    } .",
    "\\label{eq : rltk}\\ ] ] similarly , from ( [ eq : rsa ] ) and ( [ eq : ic ] ) we obtain the residual level when using the approximation of adiabatic electrons .",
    "namely , @xmath197    } .",
    "\\label{eq : rlta}\\ ] ] as explained above , in our numerical evaluations of ( [ eq : rltk ] ) and ( [ eq : rlta ] ) with cas3d - k , we assume that in stellarator geometry the trapped trajectories have @xmath198 .    to be precise",
    ", the xiao and catto formulas ( [ eq : xck ] ) and ( [ eq : xca ] ) can be obtained from an initial value problem calculation by choosing an initial condition @xmath123 different from ours .",
    "however , the initial conditions that recover the x - c results necessarily have increasingly fast oscillations along the orbit for increasing @xmath168 , and seem of limited interest for the analysis of turbulence simulations .",
    "for this reason , we choose a different initial condition that is in our opinion more relevant .",
    "the comparison with gyrokinetic simulations will be carried out by using the gene  and euterpe codes .",
    "gene  @xcite is a eulerian gyrokinetic @xmath199 code which can be run in radially global , full flux surface or flux tube simulation domains .",
    "the code can use adiabatic or kinetic electrons and is able to deal with tokamak and stellarator geometries . in the gene  simulations , we calculate the zonal flow response for a wide range of radial wavelengths , using both adiabatic and kinetic electrons .",
    "euterpe  @xcite is a global @xmath199 gyrokinetic code in 3d geometry with a lagrangian particle in cell ( pic ) scheme . in the simulations with euterpe ,",
    "a @xmath200 approximation is employed in the quasineutrality equation that limits the range of wavelengths for which we can carry out the calculations . with euterpe ,",
    "we have been able to simulate adiabatic electrons and also kinetic heavy electrons .",
    "all the gyrokinetic simulations shown in this work are linear and collisionless , with a plasma that , unless stated otherwise , consists of only two species : singly charged ions and electrons , @xmath201 .",
    "we take flat density and temperature profiles with the same values for both species .    in euterpe",
    "an initial condition proportional to @xmath202 is used for the perturbed distribution function .",
    "after the first time step , a zonal perturbation to the potential with the same radial dependence @xmath203 appears , that is used as the initial zonal flow .",
    "for the implementation of the initial condition in euterpe , the bessel functions @xmath204 and @xmath205 are approximated to lowest order in @xmath206 . the initial condition in euterpe",
    "is then @xmath207 since gene  works in fourier space for the radial coordinate , we initialize the perturbed distribution function with only one radial mode which produces a potential with a single mode of unit amplitude .     for the tokamak ( solid line ) and w7-x ( dashed line ) calculations .",
    "]      m , minor radius @xmath208  m and @xmath172 profile given in figure [ fig : qprofilesectiongyrosim ] .",
    "the values predicted by r - h and x - c ( equations ( [ eq : rh ] ) and ( [ eq : xckequaltozero ] ) , respectively ) are also shown for comparison . ]    first , we compare gyrokinetic simulations and cas3d - k calculations in tokamak geometry .",
    "we use an axisymmetric device with major radius @xmath209  m , minor radius @xmath208  m , and @xmath172 profile given in figure [ fig : qprofilesectiongyrosim ] , whose equilibrium is determined by vmec .",
    "we use flat temperature profiles with @xmath210 .",
    "the residual levels obtained with euterpe , cas3d - k and the flux tube version of gene  are shown in figure [ fig : tk_kae ] for a radial position @xmath211 .",
    "we show the calculations with fully kinetic species and also using the approximation of adiabatic electrons .",
    "the results of the gyrokinetic codes have been obtained fitting the temporal evolution of the potential to an exponential decay model @xmath212 the results with cas3d - k correspond to the evaluation of the equations ( [ eq : rltk ] ) and ( [ eq : rlta ] ) . from figure",
    "[ fig : tk_kae ] , we can see that the agreement among the results of cas3d - k , euterpe and gene  is excellent .",
    "when evaluating the residual level with gyrokinetic codes , a certain variability in the results must be assumed .",
    "this variability comes from the fitting method ( smaller than 1% ) , the discretization in phase space and the control of the numerical noise , among other factors .",
    "all the results in this work obtained with gene show variations smaller than 10% . in any case ,",
    "figure [ fig : tk_kae ] shows that the residual level obtained by the three independent methods coincides within a margin smaller than this quantity , which gives us confidence to consider that the overall error is quite small .    ) as in figure [ fig : tk_kae ] , with the adiabatic electron approximation , and the evaluation of equation ( [ eq : rltk ] ) with fully kinetic species for different values of @xmath213 . ]",
    "as can be seen in figure [ fig : tk_kae ] , the residual value has local maxima centered at the scales of the electron and ion larmor radii . in the long - wavelength limit , @xmath214 , the residual level in a tokamak does not depend on @xmath215 .",
    "its value is well predicted by ( [ eq : rh ] ) , and even more accurately by ( [ eq : xckequaltozero ] ) , for a large aspect ratio tokamak with circular cross section . for the vmec equilibrium used here ,",
    "these predictions ( also indicated in figure [ fig : tk_kae ] ) are not so accurate for the reasons discussed in the paragraph below equation ( [ eq : xckequaltozero ] ) . at very short wavelengths , @xmath216 , the residual value approaches zero as @xmath217 when using fully kinetic species and also for the adiabatic electron approximation . in figure [ fig : tk_kae ] , it is shown that the adiabatic electron approximation in tokamaks is good for @xmath218 . in figure",
    "[ fig : larttau ] , we reproduce the results with cas3d - k in figure [ fig : tk_kae ] together with the evaluation of ( [ eq : rltk ] ) for different values of @xmath219 . on the electron scale ,",
    "the results with the adiabatic electron approximation and with kinetic electrons only coincide in the limit @xmath220 . due to the reasons pointed out above ,",
    "the simulations with euterpe have been carried out only for @xmath221 .",
    "finally , it is obvious that the results of the forced system of figures [ fig : xc2 ] and [ fig : xc1 ] and the initial value problem of figure [ fig : tk_kae ] behave in a completely different way for @xmath222 .",
    "now , we turn to stellarator geometry .",
    "we use an equilibrium for the standard configuration of the stellarator w7-x obtained with vmec .",
    "the @xmath172 profile is given in figure [ fig : qprofilesectiongyrosim ] and we take flat density and temperature profiles with @xmath210 . in figure",
    "[ fig : w7xak ] , calculations of the residual level with cas3d - k , euterpe and the full flux surface version of gene  are shown for @xmath211 .",
    "two curves correspond to cas3d - k computations , one using adiabatic electrons ( see equation ( [ eq : rlta ] ) ) and the other one using kinetic electrons ( see equation ( [ eq : rltk ] ) ) . in figure",
    "[ fig : w7xak ] , the results of the gyrokinetic simulations were obtained employing both the approximation of adiabatic electrons and fully kinetic species with gene , whereas only calculations with adiabatic electrons are shown for euterpe .",
    "these results have been fitted to an exponential decay model ( [ eq : expfit ] ) to get the residual value .",
    "similar results can be obtained with an algebraic decay model as suggested in reference @xcite .",
    "the results of cas3d - k show remarkable agreement with both gyrokinetic codes .    .",
    "the @xmath172 profile is shown in figure [ fig : qprofilesectiongyrosim ] . ]    , with deuterium ions ( @xmath223 ) and kinetic heavy electrons ( @xmath224 ) ( @xmath225 ) and also using the approximation of adiabatic electrons . ]    as explained and quantified at the end of this section , the gyrokinetic simulations with kinetic species are much more demanding in terms of computational resources than those with adiabatic electrons .",
    "global simulations with euterpe using fully kinetic electrons in stellarator geometry would require an extremely large computing time .",
    "this time can be reduced by increasing the mass of the species involved .",
    "we have calculated for deuterium ions and kinetic heavy electrons @xmath226 , with @xmath227 and @xmath228 .",
    "the results are shown in figure [ fig : w7x - e_fatd - euterpe - lin-8 ] where we compare the residual level calculated with euterpe and cas3d - k at @xmath211 .",
    "the results with adiabatic electrons shown in this figure are exactly the same as those with adiabatic electrons in figure [ fig : w7xak ] , obtained for hydrogen ions .",
    "note that , with adiabatic electrons , as the residual level only depends on @xmath183 , the curves for hydrogen or deuterium ions are exactly the same .    ) as in figure [ fig : w7xak ] , with the adiabatic electron approximation , and the evaluation of equation ( [ eq : rltk ] ) with fully kinetic species for different values of @xmath213 . ]    in figure [ fig : w7xak ] , like in tokamaks , we find local maxima of the residual level centered around the scales of the electron and ion larmor radii .",
    "however , at long wavelengths , @xmath173 , the residual level as a function of @xmath229 behaves very differently in tokamaks and in stellarators ( see , for example , figures [ fig : tk_kae ] and [ fig : w7xak ] ) . this can be easily understood by expanding ( [ eq : rltk ] ) and ( [ eq : rlta ] ) in @xmath173 .",
    "the numerator of these expressions scales quadratically with @xmath229 in tokamaks and stellarators .",
    "the difference comes from the denominator . in a stellarator ,",
    "the denominator is non - zero when @xmath230 .",
    "however , in a tokamak the denominator scales quadratically with @xmath231 .",
    "the denominator has been often related to the shielding effects of collisionless classical and neoclassical polarization currents @xcite .    ) and with the approximation of adiabatic electrons ( [ eq : stelllwae ] ) , compared to the exact expressions ( [ eq : rltk ] ) and ( [ eq : rlta ] ) , in the standard configuration of the w7-x stellarator at @xmath211 and with @xmath210 . ]",
    "it is worth giving explicitly the @xmath173 expansions of ( [ eq : rltk ] ) and ( [ eq : rlta ] ) in a stellarator and discussing a stellarator specific point in detail .",
    "the lowest order term of ( [ eq : rltk ] ) gives @xmath232 where @xmath233 is the fraction of trapped particles .",
    "here , the superindex `` trapped '' means that the phase space integration is performed only over the trapped region .",
    "however , if we use the approximation of adiabatic electrons , ( [ eq : rlta ] ) , we find @xmath234 hence , in stellarators , the adiabatic electron approximation gives and incorrect residual zonal flow , even at long wavelengths .",
    "this has been pointed out in references  @xcite and is confirmed by the calculations shown in figures [ fig : w7xak ] and [ fig : w7x - e_fatd - euterpe - lin-8 ] . the curves in figure [ fig : w7xtau ] for different values of @xmath213",
    "quantify the error of the adiabatic electron approximation for any wavelength .",
    "as can be seen in this figure , the residual level obtained with this approximation , only coincides with that obtained with fully kinetic species in the limit @xmath220 . in figure",
    "[ fig : lwapprox ] , we plot the curves in figure [ fig : w7xak ] corresponding to cas3d - k together with the evaluation of their expansions to lowest order in @xmath173 , ( [ eq : stelllwke ] ) and ( [ eq : stelllwae ] ) .",
    "it is clear from figure  [ fig : lwapprox ] that ( [ eq : stelllwke ] ) and ( [ eq : stelllwae ] ) are good approximations of ( [ eq : rltk ] ) and ( [ eq : rlta ] ) respectively for @xmath235 .",
    "we point out that at scales comparable to the ion larmor radius , @xmath236 , the residual level appears to be larger in stellarators than in tokamaks ( see , for example , figures [ fig : larttau ] and [ fig : w7xtau ] ) . in order to discard trivial explanations ,",
    "we have studied with cas3d - k the residual level in a tokamak configuration with the same aspect ratio and @xmath172 profile as those of the standard configuration of w7-x and the results are much closer to the tokamak case than to the stellarator results .",
    "this is not surprising because , as shown in reference @xcite , not only the aspect ratio but also shaping effects like elongation , triangularity and shafranov shift , among others , affect the residual level . we leave for a future work a detailed study of the magnetic configuration influence on the residual level .",
    "the converged results shown in this work require disparate computing resources , depending on the code and the physical problem .",
    "the relevant numerical parameters and the computational resources required by each code are described below .    in cas3d - k",
    ", we used 256 points for the integration over the velocity coordinate @xmath18 , with @xmath237 . for",
    "the integration over the @xmath155 coordinate , we used 72 integration points in the tokamak and 24 in w7-x . along the field line",
    ", we used 32 points at long wavelengths and up to 4096 for short wavelengths .",
    "this resolution allows the correct integration of the highly oscillatory functions .",
    "thanks to axisymmetry , in a tokamak all field lines on a flux surface are equivalent . in w7-x , we used 1024 field lines to cover the flux surface for passing particles .",
    "for the evaluation of @xmath100 in the stellarator case , all the modes with @xmath238 and @xmath239 were retained .",
    "the calculations were carried out in the euler cluster at ciemat , equipped with xeon 5450 quadcore processors at 3 ghz and 4xddr infiniband network .    in gene ,",
    "a 1d spatial grid along the field line ( @xmath240 coordinate ) is used in the tokamak cases while in stellarator simulations a 2d spatial grid in coordinates @xmath241 is used to describe a full flux surface ( @xmath242 is the coordinate along the binormal direction ) . in velocity space , a 2d grid in parallel velocity and magnetic moment coordinates @xmath243 is used in both the tokamak and the stellarator cases .",
    "the resolution of the spatial and velocity grids used are given in table [ tab : gene ] together with the time step and the total simulation time for each case .",
    "times are given in @xmath244 units , with @xmath245 , where we recall that @xmath175 is the minor radius and @xmath246 is the thermal velocity of electrons .",
    "the gene simulations were run in hydra @xcite , equipped with intel ivybridge at 2.8 ghz and sandybridge - ep at 2.6 ghz processors interconnected by infiniband fdr14 .",
    ".numerical parameters used in gene simulations .",
    "the time step ( @xmath247 ) and the total simulation time ( @xmath248 ) are given in @xmath249 units , with @xmath245 . [ cols=\">,^,^,^,^,^,^ \" , ]     we observe that euterpe , a 3d global code , requires much more cpu time than gene , particularly in the tokamak case , in which the flux tube version of gene  is used .",
    "the reason is that euterpe simulates the whole plasma while gene  is here operated in a radially local limit .",
    "the computational cost with euterpe increases with @xmath231 , because more flux surfaces have to be considered as @xmath215 increases to properly resolve the radial structure of the potential in all the plasma volume . in euterpe",
    "the different values of @xmath231 at a given radial position are obtained by keeping the value of @xmath250 ( determined by the ion mass , the temperature and the magnetic field ) and varying the value of @xmath215 . in cas3d - k , the resolution at short wavelengths must be increased to correctly calculate the highly oscillatory functions related to the finite orbit width and the finite larmor radius effects .    the analytical expression obtained by rosenbluth and hinton in reference",
    "@xcite , given by equation ( [ eq : rh ] ) , has been largely used as a linear benchmark for gyrokinetic codes in tokamak geometry and in the long - wavelength limit .",
    "the results presented in this work show that cas3d - k can be used to perform those benchmarks not only in tokamak geometry but also in stellarator geometry and for arbitrary wavelengths .",
    "examples of such benchmarks are given in figure  [ fig : tk_kae ] for the global code euterpe and the flux tube version of gene  in tokamak geometry , and in figure  [ fig : w7xak ] for euterpe and the full flux surface version of gene  in stellarator geometry .    finally , it is a matter of fact that the tokamak calculation including a source term in the quasineutrality equation  @xcite has become quite popular in the literature . just for completeness",
    ", we give an analogous calculation for the stellarator in [ sec : forced ] using gyrokinetic simulations and cas3d - k .",
    "we also show the results for the tokamak using gyrokinetic codes ( these were not included in section [ sec : cas3dk ] ) .",
    "in this work we have treated analytically the linear collisionless zonal flow evolution as an initial value problem , and derived expressions ( see ( [ eq : rsk ] ) and ( [ eq : rsa ] ) ) for the residual value that are valid for arbitrary wavelengths and for tokamak and stellarator geometries .",
    "the expressions ( [ eq : rsk ] ) and ( [ eq : rsa ] ) involve certain averages in phase space , and also the solution of magnetic differential equations , that can not be evaluated analytically except for very special situations .",
    "we have extended the code cas3d - k to evaluate such expressions in general .",
    "we have tested the extension of the code by comparing its results with analytical formulae available in the literature for simplified tokamak geometry  @xcite .",
    "these tests are given in figures  [ fig : rhxc ] , [ fig : xc2 ] and [ fig : xc1 ] .",
    "then , we have computed the residual zonal flow level in tokamak and stellarator geometries for a wide range of radial wavelengths , using both the approximation of adiabatic electrons and fully kinetic electrons .",
    "we have compared the results of cas3d - k with those obtained from two gyrokinetic codes : the global code euterpe and the radially local versions of gene  ( full flux surface and flux tube ) .",
    "the comparisons are shown in figures  [ fig : tk_kae ] , [ fig : w7xak ] and [ fig : w7x - e_fatd - euterpe - lin-8 ] .",
    "a stellarator specific effect has been discussed in detail .",
    "namely , the fact that the adiabatic electron approximation gives incorrect zonal flow residuals even for @xmath173 , unlike in tokamaks .",
    "this effect has also been confirmed by means of gyrokinetic simulations .",
    "this is shown in figures [ fig : w7xak ] , [ fig : w7x - e_fatd - euterpe - lin-8 ] and [ fig : w7xtau ] .",
    "finally , we stress the efficiency of our method to determine the residual zonal flow .",
    "gyrokinetic simulations with gene  and euterpe to obtain the residual level are computationally expensive , especially with fully kinetic species , in the short - wavelength region , and in stellarator geometry . on the contrary ,",
    "the calculations with cas3d - k are less demanding ( see table  [ tab : cpuhts ] ) , particularly in stellarator geometry .",
    "these results show that cas3d - k is a useful tool to calculate fast and accurately the residual level in any toroidal geometry and for arbitrary wavelengths .",
    "this code is even more useful in stellarator geometry as kinetic electrons must be considered to correctly calculate the residual level .",
    "it can also provide a good benchmark for gyrokinetic codes .",
    "the authors thank peter catto , bill dorland , per helander , alexey mishchenko and yong xiao for helpful discussions , and antonio lpez - fraguas for his help with the usage of vmec .",
    "the authors thankfully acknowledge the computer resources , technical expertise and assistance provided by the barcelona supercomputing center ( bsc ) , the rechenzentrum garching ( rzg ) and the computing center of ciemat .    this research has been funded in part by grant ene2012 - 30832 , ministerio de economa y competitividad ( spain ) and by an fpi - ciemat phd fellowship .",
    "this work has been carried out within the framework of the eurofusion consortium and has received funding from the euratom research and training programme 2014 - 2018 under grant agreement no 633053 .",
    "the views and opinions expressed herein do not necessarily reflect those of the european commission .",
    "in this section , we give the solution @xmath100 to the magnetic differential equation ( [ eq : mde ] ) .",
    "we use boozer coordinates .",
    "that is , we assume that @xmath33 are such that the contravariant form of @xmath24 is given by ( [ eq : bcontravariantform ] ) , and its covariant form is given by @xmath251 the square root of the metric determinant is @xmath252 . here , @xmath253 and @xmath254 are the toroidal and poloidal currents , respectively . in boozer",
    "coordinates , the radial magnetic drift reads @xmath255\\rho_{\\parallel s}.\\ ] ] the parallel gyroradius is defined as @xmath256 , whereas @xmath257 .      for passing particles , @xmath108 .",
    "the magnetic differential equation to be solved is then given by @xmath258 which in boozer coordinates becomes @xmath259 this equation is easily solved in fourier space , giving @xmath260    { ( \\rho_{\\parallel s})}_{mn } \\mathrm{e}^ { 2\\pi \\mathrm{i}(m\\theta+n\\zeta ) } ,    \\label{eq : mdep1}\\ ] ] where the coefficients @xmath261 are defined by @xmath262 and @xmath263 is a constant . by choosing the integration constant as @xmath264",
    ", we have @xmath265 .",
    "\\label{eq : deltap}\\ ] ] this solution , already given in @xcite , is valid for any toroidal geometry . for axisymmetric tokamaks",
    ", it reduces to @xmath266 .      for trapped particles ,",
    "the magnetic differential equation is given by @xmath267 in coordinates @xmath45 , with @xmath268 ( and @xmath33 being boozer coordinates ) , one has @xmath269",
    "\\rho_{\\parallel s},\\ ] ] and equation ( [ eq : mdet ] ) then reads @xmath270 where @xmath271.\\ ] ] the coordinate along the magnetic field line , @xmath36 , is not monotonic over the periodic orbit delimited by the bounce points @xmath272 and @xmath273 .",
    "we define a monotonic coordinate @xmath213 by @xmath274 with @xmath275 then , the solution of ( [ eq : mdet1 ] ) can be easily written as @xmath276 in order to give a more explicit expression for ( [ eq : mdet2 ] ) , we use periodicity in @xmath213 and write @xmath277 with @xmath278 and @xmath279 here , the fact that @xmath280 is even in @xmath213 has been employed .",
    "finally , @xmath281 note that for axisymmetric tokamaks ( [ eq : mdet3 ] ) simply gives @xmath282 .",
    ") with cas3d - k for the tokamak of section [ sec : results ] at @xmath211 is shown . the corresponding simulation with gene including a source term in the quasineutrality equation is also plotted .",
    "]    , but employing adiabatic electrons . ]    . ]",
    "figures [ fig : gene1 ] and [ fig : gene0 ] are analogous to figures [ fig : xc2 ] and [ fig : xc1 ] , but this time we employ the equilibrium and parameters of section [ sec : results ] , and show the results obtained by both cas3d - k and gene .",
    "the gyrokinetic simulations have been carried out by taking vanishing initial condition and adding a constant source term to the quasineutrality equation .",
    "a formulation of the residual zonal flow problem similar to that given in @xcite gives , in the stellarator case , @xmath283    } ,    \\label{eq : rlfk}\\ ] ] if all species are kinetic . in the approximation of adiabatic electrons",
    ", one has @xmath284    } .",
    "\\label{eq : rlfa}\\ ] ] the evaluation of these expressions with cas3d - k , for the standard configuration of the stellarator w7-x and the parameters detailed in section  [ sec : results ] , is shown in [ fig : gene_stell_forced ] .",
    "the results for gene  simulations are also plotted ."
  ],
  "abstract_text": [
    "<S> in the linear collisionless limit , a zonal potential perturbation in a toroidal plasma relaxes , in general , to a non - zero residual value . </S>",
    "<S> expressions for the residual value in tokamak and stellarator geometries , and for arbitrary wavelengths , are derived . </S>",
    "<S> these expressions involve averages over the lowest order particle trajectories , that typically can not be evaluated analytically . in this work , an efficient numerical method for the evaluation of such expressions is reported . </S>",
    "<S> it is shown that this method is faster than direct gyrokinetic simulations performed with the gene  and euterpe codes . </S>",
    "<S> calculations of the residual value in stellarators are provided for much shorter wavelengths than previously available in the literature . </S>",
    "<S> electrons must be treated kinetically in stellarators because , unlike in tokamaks , kinetic electrons modify the residual value even at long wavelengths . </S>",
    "<S> this effect , that had already been predicted theoretically , is confirmed by gyrokinetic simulations </S>",
    "<S> .    0.5 cm </S>"
  ]
}