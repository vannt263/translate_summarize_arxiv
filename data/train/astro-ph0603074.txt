{
  "article_text": [
    "the cold dark matter(cdm ) scenario@xcite has been the standard theory of the formation and evolution of the structures in the universe . in this scenario ,",
    "galaxies and clusters of galaxies are formed bottom - up .",
    "it has been remarkably successful in explaining the large scale structures @xcite and numerous observational results ( e.g. @xcite ) . until recently , however , the small - scale structures of cdm , like subhalos in a galaxy - sized halo , could not be studied by numerical simulation because of the lack of the computational power .",
    "recent improvement of computational powers made it possible to study not only dark matter halos , but subhalos in a parent halo .",
    "usually these subhalos are interpreted as corresponding to galaxies in cluster - sized halos and satellite dwarf galaxies in galaxy - sized halos .",
    "@xcite and ( 1999 , hereafter m99 ) reported that about 1000 subhalos formed in a simulated galaxy - sized halo .",
    "the number distribution of subhalos as the function of the circular velocity normalized by that of the parent halo turned out to be remarkably similar for galaxy - sized and cluster - sized halos .",
    "this result , of course , is the direct outcome of the scale - free nature of the gravity and almost power - law amplitude of the density fluctuation .",
    "this similarity , which looks quite natural from the theoretical side , showed serious discrepancy with observation .",
    "the number of subhalos in the simulated cdm halo agreed well with the observation of the cluster of galaxies , while the simulation of a galaxy - sized halo predicted too many dwarf - sized halos .",
    "this discrepancy is now known as the `` dwarf galaxy problem '' , or `` missing - dwarf problem '' , and has been one of the main topics in the study of galaxy formation and structure formation in the universe .",
    "solutions so far proposed for this problem can be classified into the following two categories :    * dark matter is different from the cdm model in small scales . *",
    "only a small fraction of subhalos is observed as dwarf galaxies .",
    "many modified dark matter models had been proposed .",
    "self interacting dark matter@xcite is a cdm with small self - interaction cross section , which dumps small - scale fluctuation .",
    "warm dark matter@xcite has a power spectrum which has cut off at small scale .",
    "some simulations with these dark matter models have been done .",
    "( e.g. @xcite , @xcite )    if we assume that the standard cdm is correct and consider the possibility that not all subhalos are observed as dwarf galaxies , the question is which subhalos are observed as dwarf galaxies .",
    "@xcite argued that observed dwarf galaxies are presently most massive subhalos , by comparing numerical result with observation of velocity dispersion profile of dwarf galaxies . on the other hand , ( 2004 , hereafter k04 ) tracked each subhalo s evolution and showed many low - mass subhalos were massive in the past .",
    "additionally , they introduced the model of star formation condition , and claimed that the number and distribution of satellite dsph galaxies was in agreement with that of such previously massive subhalos .    before jumping to such a solution",
    ", however , we should understand what is really the problem .",
    "in previous studies , in order to determine the number of subhalos with circular velocity @xmath5 , the detection limit was set to a few tens of particles . it is not clear whether or not we can rely on the result obtained with such a small number of particles . both softening parameters and the two - body relaxation might significantly affect mass and density profiles of subhalos ( e.g. @xcite , @xcite ) .",
    "@xcite showed that the low mass end of the circular velocity distribution of subhalos is affected by numerical resolution by comparing the results of two cluster - scale simulations with different resolutions .",
    "same tendency can be seen in the more recent studies ( e.g. @xcite , @xcite and @xcite ) .",
    "this means that the agreement in a cluster scale described in m99 might be a numerical artifact .    in the present paper , as a first step to understand the formation and evolution of subhalos , we investigated the reliability of size distribution of subhalos in simulation results .",
    "we performed large - scale @xmath0-body simulations of formation of cdm halos .",
    "we simulated both galaxy - sized and cluster - sized halos .",
    "we carried out @xmath0-body simulations of nine halos of different masses and resolutions and analyzed the distribution of subhalos . from the results of these simulations",
    ", we estimated the effect of the mass resolution on the distribution of subhalos .",
    "when the number of particles in one subhalo is small , both the mass and the circular velocity of that halo are affected , resulting in the deviation from simple power - law dependence .",
    "we formulated the reliability criterion for mass and circular velocity .",
    "we then compared the velocity distribution function obtained by @xmath0-body simulations with that of observed galaxies in the virgo cluster .",
    "we found that the observational result is in good agreement with our medium - resolution result , which is affected by small-@xmath0 effect around @xmath6 .",
    "in other words , our high - resolution simulation predicts the overabundance of moderate - sized galaxies .",
    "previously the mass function of galaxies in a cluster has been believed to be well reproduced by cdm simulations ( e.g. m99 ) .",
    "our result shows that the agreement , in the range of @xmath7 , is due to the lack of mass resolution in previous simulations .",
    "the discrepancy between the simulated halos and observed galaxies extends to higher mass than in the galaxy scale .",
    "this is simply because there was no satellite of that mass in galaxy - scale calculations .",
    "our result indicates that an analogue to the `` missing dwarf problem '' exists also in clusters of galaxies .",
    "therefore , the `` solutions '' for the missing dwarf problem should give a distribution consistent with observations in both the galaxy scale and the cluster scale .",
    "the contents of this paper is as follows . in section 2",
    ", we describe the models and method used in our simulations .",
    "we give detailed explanation of the subhalo detection method we developed . in section 3",
    ", we discuss the reliability limit of the number count of subhalos .",
    "finally we summarize our result and discuss possible solutions to the missing dwarf problem in section 4 .",
    "we adopted the standard cdm model(scdm ) , so that we can directly compare our result with that of m99 who adopted scdm .",
    "cosmological parameters are @xmath8 , @xmath9 , @xmath10 , @xmath11 . to generate the initial condition , we used the standard re - simulation method@xcite .",
    "first we simulated 15 comoving @xmath12 radius using @xmath13 particles(@xmath14 ) and 150 comoving @xmath12 radius using @xmath13 particles ( @xmath15 ) to select candidates for galactic and cluster halos from the distribution of particles at @xmath16 . to select halo candidates , we used the standard friends of friends method ( fof , @xcite ) with the linking length which is 0.2 times the mean interparticle distance .",
    "then we selected particles inside the radius four times larger than radius enclosing particles detected by fof as the region of high resolution calculation , and traced these particles back to the initial condition .",
    "we replaced these particles with high resolution particles and re - ran the simulation . in this way ,",
    "the external tidal force from outside the high resolution region was correctly taken into account .    to generate initial conditions",
    ", we used the grafic2 package @xcite .",
    "the calculation was done on an ibm pseries690 of the data reservoir project of the university of tokyo , and on a workstation with amd opteron 242 processors and 16 gb memory .",
    "we prepared initial conditions of one region with three different resolutions for both galaxy - scale and cluster - scale runs .",
    "these runs are named c1-h , c1-m , and c1-l and g1-h , g1-m , g1-l , for cluster scales and galaxy scales .",
    "here , postfixes h , l and m denotes high , medium and low - resolution runs , respectively .",
    "we also selected two regions for additional cluster - scale runs with medium resolution .",
    "these runs are named c2-m and c3-m .",
    "the initial redshift @xmath17 and particle mass @xmath18 are listed in table [ tab : param ] .",
    "[ cols=\"^,^,^,^,^,^\",options=\"header \" , ]      the time integration was done in physical time and physical coordinates . in high-@xmath19 regime",
    ", we varied time step @xmath20 and the softening length @xmath21 to reduce the time integration error .",
    "we adopted the procedure similar to that used in @xcite .",
    "we used the following formulation @xmath22    where @xmath23 is the redshift at which we switch from @xmath19-dependent timestep and softening to constant timestep and softening .",
    "the constant values are @xmath24 and @xmath25 .",
    "these equations imply @xmath26 and @xmath27 for @xmath28 , where @xmath29 is the mean density , @xmath30 is the scale factor .",
    "the initial redshift(@xmath17 ) and @xmath23 correspond to the standard deviation of density fluctuation @xmath31 is 0.2 and 1.0 , respectively .",
    "we chose @xmath24 so that the energy conservation is better than @xmath32 when calculations are done only for the high resolution particles .",
    "we chose @xmath25 so that it is sufficiently small compared to the size of subhalos . for runs with different @xmath0 , we varied @xmath25 in proportion to @xmath33 .",
    "these values are summarized in table [ tab : param ] .    for actual time integration",
    ", we used a parallel implementation of barnes - hut tree algorithm @xcite on grape-6@xcite and grape-6a @xcite .",
    "the opening angle was @xmath34 for all run .",
    "time integration was done using the standard leapfrog .",
    "table [ tab : prop ] lists virial radii(@xmath35 ) , masses ( @xmath36 ) and numbers of the particles ( @xmath37 ) inside @xmath35 , and circular velocities(@xmath2 ) of the main halo .",
    "here , @xmath35 is the radius in which the average density is 200 times the critical density .",
    "figure [ fig : image ] shows snapshots of a galaxy and a cluster halos from high resolution runs .",
    "( 0.45,0.45)figure1a.eps ( 0.45,0.45)figure1b.eps + ( 0.45,0.45)figure1c.eps ( 0.45,0.45)figure1d.eps      to detect subhalos in simulated galaxy halos , we developed a subhalo detection program based on the hierarchical friends of friends ( hfof ) method @xcite . the hfof method is an extension of the standard fof .",
    "the fof algorithm with the linking length @xmath38 detects the regions with the density higher than @xmath39 . in the hfof method",
    ", fof is repeatedly applied to the regions found by fof , with decreasing linking length , so that we can identify all density peaks .",
    "initially , at level 1 , we use the linking length @xmath40 here @xmath41 is the critical density of the universe and defined as @xmath42 .    for halos detected at level @xmath43 , we apply the fof method at level @xmath44 with linking length @xmath45 i.e. , we shrink the linking length by @xmath46 at each level .",
    "this factor must be small enough so that the result does not depend on its value .",
    "when fof of level @xmath44 is applied to a halo found in level @xmath43 , there are three possibilities .",
    "the first one is that a single halo is again found , but with a smaller number of particles .",
    "second is that nothing is found , or there are too few particles in the detected halo .",
    "the third possibility is that multiple halos are found .",
    "when one or more halos are found , we continue to level @xmath47 .",
    "when the halo vanished at level @xmath44 , we regard that a single halo is detected at level @xmath43 .",
    "the lower limit for the number of particles in a subhalo is 10 .",
    "any method for subhalo detection based on the isodensity contour has a problem that many groups found are not gravitationally bound .",
    "to select gravitationally bound groups , we employed the evaporative method @xcite . using this method",
    ", we can discard unbound groups .",
    "in addition , we can remove unbound particles from bound groups . since the iterative calculation of gravitational potential necessary for this method is computationally expensive , we used grape-6 to calculate the potential energy in order to accelerate calculation .",
    "we applied this method to all subhalo candidates , even when the number of particles is very large .",
    "thus , for all halos , we can accurately determine the bound mass .",
    "to summarize , our halo finding algorithm is following .",
    "first , the hfof method is applied to all particles to construct density hierarchy .",
    "then we apply evaporative method to each of detected density peaks ( at the highest level for which that halo is found ) .",
    "if the peak is rejected by the evaporative method , that peak is regarded as not detected and we apply the same procedure to its parent halo ( halo in one level lower ) .",
    "if the parent halo of one halo contain no other halo , we also regard that it is detected only at level @xmath43 .",
    "we apply this procedure to all hierarchies of subhalos , and regard all remained halos as detected .",
    "total numbers of detected subhalos @xmath48 are listed in table [ tab : prop ] .",
    "right panels of figure [ fig : image ] show the detected subhalos .",
    "( 0.45,0.45)figure2a.eps ( 0.45,0.45)figure2b.eps + ( 0.45,0.45)figure2c.eps ( 0.45,0.45)figure2d.eps    ( 0.45,0.45)figure3a.eps ( 0.45,0.45)figure3b.eps + ( 0.45,0.45)figure3c.eps ( 0.45,0.45)figure3d.eps    top two panels of figure [ fig : num_vc ] show the cumulative number @xmath49 of subhalos as the function of the circular velocity @xmath2 for g1 and c1 halos . in both cases , @xmath1 is proportional to @xmath50 for large subhalos ( higher @xmath2 ) , but for small subhalos the number of subhalos drops off the power - law line .",
    "if we investigate the curves carefully , we can see that @xmath1 drops off from the power law in two stages .",
    "for example , the curve for g1-h starts to deviate from the power - law line at @xmath51 , and then show the second leveling off at @xmath52 .",
    "all other curves show similar two - stage behavior .    to see this tendency more clearly , in bottom panels of figure [ fig : num_vc ] we plot the cumulative number normalized by @xmath50 . in g1",
    "runs , runs h and m show narrow flat region , where the relation @xmath53 holds .",
    "the l ( low - resolution ) run shows hardly any flat region .",
    "similar tendency is visible for c1 runs , though somewhat less clear .    in these panels , it is clear not only the second leveling - offs but also the first deviations are dependent on the resolution . in other words ,",
    "first deviations are numerical artifact , and simulation results are reliable only for the subhalos larger than these first bendings .",
    "this result indicates that the region where the numerical result is reliable is quite narrow . for g1-h run",
    ", the numerical result is reliable only for @xmath54 , for which only @xmath55 halos exist .",
    "figure [ fig : num_mass ] shows the same cumulative number of subhalos , but now as the function of bound mass of halos @xmath56 .",
    "we can see that the result is quite similar to that of figure [ fig : num_vc ] , except that the second leveling - off is not visible .",
    "the reason why the leveling - off is visible for velocity and not for mass is simple .",
    "since we have posed minimum number of particles for subhalos ( @xmath57 ) , there is no subhalo with @xmath58 , which is the reason why the curve terminate suddenly for @xmath59 plot . in the case of @xmath49 ,",
    "halos with @xmath60 but with small @xmath2 were counted , but halos with @xmath61 are not counted no matter how high its @xmath2 is .",
    "thus , @xmath1 levels off gradually .",
    "the bottom two panels of figure [ fig : num_mass ] show the cumulative number normalized by @xmath62 .",
    "again , the bending is clearly visible .",
    "the `` flat '' region is not very clear , perhaps simply due to small number statistics .",
    "for example , if we interpret the result of run c1-m naively , we might conclude that normalized plot in the mass range @xmath63 to @xmath64 is not flat .",
    "however , since there are only 20 subhalos with mass larger than @xmath64 , this result is not statistically significant .    for the small - mass region where runs with different mass resolutions show different results , the statistical noise is small because the number of halos is large . at the first sight",
    "the result in this region might look reliable , simply because of this low noise .",
    "however , clear difference between runs with different resolutions indicate that result in this region is numerical artifact and is not reliable at all .    from figure [ fig : num_mass ]",
    "we can estimate the minimum number of particles in the subhalos above which the number count is reliable .",
    "for run c1-h , the mass at which the normalized cumulative count bends off from the flat line is between @xmath65 and @xmath66 , which correspond to the number of particles in the subhalos between 100 and 200 . for other five runs ,",
    "bending points are all similar , between 100 and 200 .",
    "so we can conclude that the cumulative count is only reliable for subhalos with number of particles larger than 200 .    in order to see this tendency more clearly , in figure [ fig : num_pnum ] we show the cumulative number of subhalos plotted as functions of the number of particles in subhalos .",
    "thin solid curves are fitting function of the form    @xmath67    where @xmath68 and @xmath69 are fitting parameters . for all curves ,",
    "we use @xmath70 .",
    "the other parameter @xmath68 was chosen by eye .",
    "we can see that for all runs formula ( [ eq : ncfitt ] ) gives excellent fit .",
    "@xcite performed simulations similar to what we performed , and measured the cumulative number of subhalos as functions of circular velocity and mass .",
    "they have not reported this bending at @xmath71 . for velocity distribution",
    ", they did not see this bending simply because their cutoff number of particles for subhalos is much bigger than what we used . as the result",
    ", the second leveling off occurs almost simultaneously as the first bending . for mass distribution function",
    ", their figure 11 shows the same bending behavior as we see in figure [ fig : num_pnum ] , though the tendency is less clear simply because of the way the data are plotted , and they did not discuss the shape of the mass distribution function .",
    "qualitatively same tendencies were reported by @xcite in galaxy scale and @xcite in cluster scale .",
    "( 0.9,0.9)figure4.eps      for our largest calculation with 4 m particles in the virial radius of the parent halo , we found that the distribution of subhalos is reliable only up to 100 - 200 most massive subhalos . for smaller subhalos ,",
    "the dependence of the cumulative number on both the circular velocity and mass becomes significantly shallower than the simple power - law .",
    "thus , we should assume that the number of subhalos formed in real cdm cosmology would show this simple power - law behavior down to mass or circular velocity much lower than the limit for which the current simulations can give reliable result .    the classic work by m99 used around 1 m particles for the parent halo , and compared the distribution of around 1,000 subhalos . on the other hand",
    ", we can conclude that their result is actually reliable only for around 20 most massive halos , and the number of smaller subhalos was significantly underestimated .",
    "figure [ fig : num_vel_c123 ] shows the cumulative number of subhalos for runs c2-h , m and l , as well as that estimated for the virgo cluster in the way same as in m99 .",
    "we can see that run c2-m , which used the number of particles similar to that in m99 , shows the best agreement with the observation .",
    "the result of run c2-h shows the slope steeper than the observation starting at @xmath72 .",
    "the actual number count for run c2-h becomes higher than observation only at @xmath73 or around , because the number of massive halos in run c2-h is slightly smaller than the observational value , while c2-m shows better fit for @xmath74 .",
    "this difference between c2-h and c2-m is purely due to the fluctuation in the initial model .",
    "the high - wave number initial fluctuations we added for re - simulation are not exactly the same for these runs .",
    "as we have seen in figure [ fig : num_vc ] , the number count for this run drops off from the power - law line also around @xmath75 .",
    "thus , the actual number of galaxies observed in the virgo cluster goes even lower than the simulation which gives the number lower than the power - law . for reference",
    ", we drew the power - law curve in figure [ fig : num_vel_c123 ] .",
    "the curve implies that , ideally , for @xmath76 , the difference is already significant , and for 50km / s , there is more than a factor of 10 difference .",
    "( 0.9,0.9)figure5.eps      in figure [ fig : vel_mass ] the mass of each subhalo is plotted against its circular velocity for runs g1-h and c1-h .",
    "figure [ fig : vel_mass ] shows that the correlation between @xmath56 and @xmath2 is fairly tight , and well fitted by @xmath78 , for both runs g1 and c1 .",
    "this tight relation , however , becomes somewhat loose for the velocity smaller than 20 km / s in the case of the galaxy scale g1 and than 100 km / s in the case of the cluster scale c1 .",
    "we show the @xmath79 unbiased variances in figure [ fig : vel_mass ] , from which we can sort of see that the distribution of circular velocity for a given mass range is wider for lower mass .    to see this tendency more clearly , in figure [ fig : vel_disp_ave ] we plot the unbiased variance of the circular velocity as the function of halo size .",
    "here , we used the number of particles in subhalos as the indicator of the size of the halo .",
    "we can see that the variance shows essentially the same behavior for three runs with different mass resolutions , at least for cluster - scale runs c1-x .",
    "this behavior indicates that the increase of the variance in low - mass halos is not the physical reality but the numerical artifact .",
    "the real variance is probably around 15% , independent of the mass of subhalos .",
    "the galaxy - scale runs show a similar tendency .",
    "the number of particles below which the variance becomes large is around 200 , the same as the number of particles below which the number count becomes unreliable .",
    "thus , these deviations are probably driven by the same mechanism .",
    "( 0.45,0.45)figure6a.eps ( 0.45,0.45)figure6b.eps +    ( 0.45,0.45)figure7a.eps ( 0.45,0.45)figure7b.eps + ( 0.45,0.45)figure7c.eps ( 0.45,0.45)figure7d.eps",
    "we carried out large scale @xmath0-body simulations of formation of cdm halos .",
    "we simulated the formation of both a galactic size halo and a cluster size halo .",
    "we determined the masses and circular velocities of subhalos for both cases .",
    "we found that the cumulative distribution of subhalos , both as a function of the circular velocity and as that of the mass , is affected by mass resolution of the simulation . in all runs ,",
    "the number of subhalos @xmath80 with more than 200 particles is well expressed by a single power - law of @xmath81 . for the subhalos with less than 200 particles ,",
    "the number of subhalos becomes smaller than this power - law line .",
    "we investigated the distribution of subhalos in the plane of their masses and circular velocities , and found that the there is a tight correlation with @xmath82 .",
    "the tightness of the correlation again depends on the number of particles in subhalos , and for subhalos with less than 200 particles the correlation becomes weaker .      from runs g1-x ,",
    "the number of subhalos with @xmath83 are about 30 for run g1-l , 200 for run g1-h .",
    "so roughly speaking , our result implies that the cumulative distribution of subhalos obtained by @xmath0-body simulation is reliable only for @xmath84 most massive halos , where @xmath0 is the number of particles in the virial radius of the parent halo .",
    "thus , results obtained with , for example , 1 m particles is okay for only the first 50 subhalos .",
    "this result means that the good agreement of the observation and simulation result obtained with around 1 m particles is actually a numerical artifact , and there is a serious discrepancy between the observed number of galaxies in clusters like the virgo cluster and the number of subhalos obtained by @xmath0-body simulation .",
    "ideally the number of subhalos with , say , circular velocity of 100km / s is factor two or three times bigger than the observed count , and for 50km / s this factor is more than 10 .",
    "most `` solutions '' so far proposed for the dwarf galaxy problem were aimed at reducing the number of dwarfs with @xmath85 or less .",
    "( @xcite , @xcite , @xcite , k04 ) however , most of them do not work for halos with mass more than @xmath86 .",
    "one serious theoretical problem with the subhalos with mass @xmath86 is that when they were first formed they were generally much more massive .",
    "( @xcite , k04 ) most of their mass have been stripped out through the tidal interaction with the parent halo .",
    "in other words , they were initially almost as massive as the halo of our galaxy .",
    "thus , a `` solution '' which can account for the discrepancy between the observed number of galaxies in clusters and the subhalos in a cdm halo need to be able to reduce the number of halos with initial virial mass as large as @xmath87 by a factor of two or so .",
    "we thank toshiyuki fukushige and hideki yahagi for helpful discussions .",
    "the simulation was partly done using ibm pseries 690 of the data reservoir project of the university of tokyo .",
    "this research is partially supported by the special coordination fund for promoting science and technology ( grape - dr project ) , and a grant for the 21st century coe program of the university of tokyo , `` quantum extreme systems and their symmetries '' ministry of education , culture , sports , science and technology , japan .                                                      ,",
    "v. , white , s.  d.  m. , jenkins , a. , frenk , c.  s. , yoshida , n. , gao , l. , navarro , j. , thacker , r. , croton , d. , helly , j. , peacock , j.  a. , cole , s. , thomas , p. , couchman , h. , evrard , a. , colberg , j. , & pearce , f. 2005 , , 435 , 629"
  ],
  "abstract_text": [
    "<S> we investigated the formation and evolution of cdm subhalos in galaxy - sized and cluster - sized halos by means of @xmath0-body simulations . </S>",
    "<S> our aim is to make clear what the `` dwarf galaxy problem '' is . </S>",
    "<S> it has been argued that the number of subhalos in simulated galaxy - sized halos is too large compared to the observed number of dwarfs in the local group , while that in cluster - sized halos is consistent with observed number of galaxies in clusters such as the virgo cluster . </S>",
    "<S> we simulated nine halos with several different mass resolutions and physical scales . </S>",
    "<S> we found that the dependence of the cumulative number of subhalos @xmath1 on their maximum circular velocity @xmath2 is given by @xmath3 , down to the reliability limit , independent of the mass of the main halo . </S>",
    "<S> this implies that simulations for cluster - sized halos give too many halos with @xmath4 or less . </S>",
    "<S> previous comparisons of cluster - sized halos gave much smaller number of subhalos in this regime simply because of their limited resolution . </S>",
    "<S> our result implies that any theory which attempts to resolve the missing dwarf problem should also explain the discrepancy of the simulation and observation in cluster - sized halos . </S>"
  ]
}