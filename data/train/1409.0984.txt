{
  "article_text": [
    "we characterize the boundary at infinity of a complex hyperbolic space @xmath0 , @xmath1 , as a compact ptolemy space that satisfies four incidence axioms .",
    "recall that a mbius structure on a set @xmath2 , or a mbius space over @xmath2 , is a class of mbius equivalent metrics on @xmath2 , where two metrics are equivalent if they have the same cross - ratios .",
    "a ptolemy space is a mbius space with the property that the metric inversion operation preserves the mbius structure , that is , the function @xmath3 satisfies the triangle inequality for every metric @xmath4 of the mbius structure and every @xmath5 .",
    "a basic example of a ptolemy space is the boundary at infinity of a rank one symmetric space @xmath6 of noncompact type taken with the canonical mbius structure , see sect .",
    "[ subsect : model_moebius_structure ] . in the case",
    "@xmath7 is a real hyperbolic space , the boundary at infinity @xmath8 taken with the canonical mbius structure is mbius equivalent to an extended euclidean space @xmath9 .",
    "basic objects of our axiom system are @xmath10-circles , @xmath11-circles and harmonic 4-tuples in a mbius space @xmath2 .",
    "any @xmath10-circle is mbius equivalent to the extended real line @xmath12 and any @xmath11-circle is the square root of @xmath12 . in other words ,",
    "an @xmath10-circle can be identified with @xmath13 , and a @xmath11-circle with @xmath14 , where the hyperbolic plane @xmath15 has constant curvature @xmath16 .",
    "an ( ordered ) 4-tuple @xmath17 of pairwise distinct points is _ harmonic _ if @xmath18 for some and hence for any metric @xmath4 of the mbius structure .",
    "we use the notation @xmath19 for the set of harmonic 4-tuples in @xmath20 . in the case",
    "@xmath21 we abbreviate to @xmath22 . in the case",
    "@xmath23 for @xmath24 or @xmath25 a 4-tuple @xmath26 is harmonic if and only if the geodesic lines @xmath27 , @xmath28 intersect each other orthogonally .",
    "we consider the following axioms .",
    "* existence axioms * * through every two distinct points in @xmath2 there is a unique @xmath11-circle . * * for every @xmath11-circle @xmath29 , @xmath30 and @xmath31 there is a unique @xmath10-circle @xmath32 through @xmath33 , @xmath34 that intersects @xmath35 . *",
    "orthogonality axioms : + for every @xmath10-circle @xmath36 and every @xmath11-circle @xmath37 with common distinct points @xmath38 , @xmath33 the following holds * * given @xmath34 , @xmath39 such that @xmath40 , the 4-tuple @xmath41 is harmonic for every @xmath42 , * * given @xmath43 , @xmath44 such that @xmath45 , the 4-tuple @xmath46 is harmonic for every @xmath47 .",
    "our main result is the following    [ thm : complex_hyperbolic ] let @xmath2 be a compact ptolemy space that satisfies axioms ( e ) and ( o ) .",
    "then @xmath2 is mbius equivalent to the boundary at infinity of a complex hyperbolic space @xmath0 , @xmath1 , taken with the canonical mbius structure .    in @xcite",
    "we have obtained a mbius characterization of the boundary at infinity of any rank one symmetric space assuming existence of sufficiently many mbius automorphisms .",
    "in contrast to @xcite , there is no assumption in theorem  [ thm : complex_hyperbolic ] on automorphisms of @xmath2 , and one of the key problems with theorem  [ thm : complex_hyperbolic ] is to establish existence of at least one nontrivial automorphism . in this respect",
    ", theorem  [ thm : complex_hyperbolic ] is an analog for complex hyperbolic spaces of a result obtained in @xcite for real hyperbolic spaces : every compact ptolemy space such that through any three points there exists an @xmath10-circle is mbius equivalent to @xmath48 .",
    "the model space @xmath49 , @xmath50 , serves for motivation and illustration of various notions and constructions used in the proof of theorem  [ thm : complex_hyperbolic ] .",
    "these are reflections with respect to @xmath11-circles , pure homotheties , orthogonal complements to @xmath11-circles , suspensions over orthogonal complements , mbius joins . in sect .",
    "[ sect : model_space ] , we describe the canonical mbius structure on @xmath51 , show that this structure satisfies axioms ( e ) , ( o ) , and study in proposition  [ pro : holonomy_normal_bundle ] holonomy of the normal bundle to a complex hyperbolic plane in @xmath0 .",
    "this proposition plays an important role in sect .",
    "[ sect : moebius_join_equivalence ] , see lemma  [ lem : unique_representative_cfiber ] .",
    "now , we briefly describe the logic of the proof .",
    "the first important step is proposition  [ pro : conjugate_pole ] which leads to existence for every @xmath11-circle @xmath29 of an involution @xmath52 whose fixed point set is @xmath37 , and such that every @xmath10-circle @xmath32 intersecting @xmath37 at two points is @xmath53-invariant , @xmath54 .",
    "the involution @xmath53 is called the reflection with respect to @xmath37 .    in the second step ,",
    "crucial for the paper , we obtain a distance formula , see proposition  [ pro : explicit_distance ] , which is our basic tool . using the distance formula , we establish existence of nontrivial mbius automorphisms @xmath55 beginning with vertical shifts , see sect .",
    "[ subsect : vertical_shifts ] , and then proving that reflections with respect to @xmath11-circles and pure homotheties are mbius , sect .",
    "[ subsect : reflection_ccircle ] and [ subsect : pure_homothety ] .    next , in sect .",
    "[ sect : fiber_filling_map ] we introduce the notion of an orthogonal complement @xmath56 to a @xmath11-circle @xmath29 at a mbius involution @xmath57 without fixed points . in the case of the model space @xmath51",
    ", @xmath58 is the boundary at infinity of the orthogonal complement to the complex hyperbolic plane @xmath59 with @xmath60 at @xmath61 , @xmath62 , where @xmath63 is the central symmetry with respect to @xmath64 .    in the third step , we show that for any mutually orthogonal @xmath11-circles @xmath37 , @xmath65 the intersection @xmath66 of their orthogonal complements , when nonempty , satisfies axioms ( e ) , ( o ) , see sect .  [ subsect : induced_argument ] .",
    "this gives a possibility to proceed by induction on dimension .",
    "to do that , we introduce in sect .",
    "[ sect : moebius_join ] the notion of a mbius join @xmath67 of a @xmath11-circle @xmath37 and its canonical orthogonal subspace @xmath68 .",
    "it turns out that @xmath69 for any @xmath56 .",
    "all what remains to prove is that whenever @xmath70 is mbius equivalent to @xmath71 , the mbius join @xmath72 is equivalent to @xmath73 .",
    "the distance formula works perfectly in the case @xmath74 , i.e. , @xmath68 is a @xmath11-circle , however , if @xmath75 , it does not work directly .",
    "thus we proceed in two steps .",
    "first , we prove that @xmath76 for any mutually orthogonal @xmath11-circles @xmath37 , @xmath65 , in particular , this proves theorem  [ thm : complex_hyperbolic ] in the case @xmath77 . then using this fact as a power tool , we establish that the base @xmath78 of the canonical foliation @xmath79 , @xmath5 , see sect .  [ sect : canonical_foliation ] , is euclidean . using this",
    ", we finally prove the general case for @xmath75 .",
    "_ acknowledgments .",
    "_ the first author is grateful to the university of zrich for hospitality and support .",
    "let @xmath50 , @xmath1 , be the complex hyperbolic space , @xmath80 .",
    "for @xmath81 we identify @xmath25 with the hyperbolic plane of constant curvature @xmath16 .",
    "for @xmath82 we choose a normalization of the metric so that the sectional curvatures of @xmath6 are pinched as @xmath83 .",
    "we use the standard notation @xmath84 for the tangent bundle of @xmath6 and @xmath85 for the subbundle of the unit vectors . for every unit vector @xmath86 , @xmath87 , the eigenspaces @xmath88 of the _ curvature operator _ @xmath89 , where @xmath90 is the subspace orthogonal to @xmath34 , are parallel along the geodesic @xmath91 , @xmath92 , and the respective eigenvalues @xmath93 are constant along @xmath94 .",
    "the dimensions of the eigenspaces are @xmath95 , @xmath96 , @xmath97 .",
    "any @xmath86 and a unit vector @xmath98 span a 2-dimensional subspace @xmath99 for which @xmath100 is a totally geodesic subspace isometric to @xmath15 called a _ complex _ hyperbolic plane , while for every unit @xmath101 the totally geodesic subspace @xmath102 is isometric to @xmath103 and called a _ real _ hyperbolic plane .    at every point @xmath87",
    "there is an isometry @xmath104 with unique fixed point @xmath64 , @xmath105 , such that its differential @xmath106 is the antipodal map , @xmath107 .",
    "the isometry @xmath108 is called the _ central symmetry _ at @xmath64 . for different @xmath64 ,",
    "@xmath109 the composition @xmath110 preserves the geodesic @xmath111 through @xmath64 , @xmath112 and acts on @xmath94 as a shift whose differential is a parallel translation along @xmath94 .",
    "any such isometry is called a _",
    "transvection_.    furthermore , there is a complex structure @xmath113 , where @xmath114 is an isometry with @xmath115 .",
    "then for every @xmath86 , the vectors @xmath34 , @xmath116 form an orthonormal basis of the tangent space to a complex hyperbolic plane @xmath117 .",
    "[ rem:3dim_basis ] given a complex hyperbolic plane @xmath59 and a point @xmath61 , the orthogonal complement @xmath118 to @xmath119 at @xmath64 is a totally geodesic subspace isometric to @xmath120 .",
    "let @xmath59 be a complex hyperbolic plane . here",
    ", we describe the holonomy of the normal bundle @xmath121 along @xmath119 .",
    "the result of this section plays an important role in sect .",
    "[ sect : moebius_join_equivalence ] . for every @xmath61",
    "we have a 1-dimensional fibration @xmath122 of the unit sphere @xmath123 tangent to the orthogonal complement @xmath124 to @xmath119 .",
    "fibers of @xmath122 are circles @xmath125 , where @xmath126 are complex hyperbolic planes through @xmath64 . by a _ holonomy _ of @xmath121 we mean a parallel translation along @xmath119 with respect to the levi - civita connection of @xmath6 .",
    "[ pro : holonomy_normal_bundle ] for every @xmath61 the holonomy of @xmath121 along any ( piece - wise smooth ) loop in @xmath119 with vertex @xmath64 preserves every fiber of @xmath122 , though @xmath121 is not flat .",
    "let @xmath43 , @xmath127 be an orthonormal basis of the tangent space @xmath128 . for an arbitrary @xmath129 we put @xmath130 .",
    "we actually only show that @xmath131 , where @xmath132 is the curvature tensor of @xmath6 .",
    "this implies the proposition .    for @xmath81 , where @xmath50 , there is nothing to prove , and for @xmath133 the first assertion is trivial .",
    "thus assume that @xmath134 .",
    "we take @xmath135 that is orthogonal to @xmath136 , @xmath34 .",
    "we use the following expression of @xmath132 via @xmath137 for arbitrary @xmath138 , see @xcite , where @xmath139 is the scalar product on @xmath140 ,    @xmath141    coming back to our choice of @xmath142 , we obtain @xmath143 , @xmath144 for @xmath145 .",
    "next , using the euler formula @xmath146 for values of a quadratic form on a 2-dimensional vector space , we obtain @xmath147 , @xmath148 for @xmath145 , @xmath149 and @xmath150 therefore , @xmath151 for @xmath145 .",
    "now , we set @xmath152 , @xmath153 , @xmath154 , @xmath155 . for the sectional curvature in the 2-directions @xmath156 and",
    "@xmath157 we have @xmath158 .",
    "thus @xmath159 because @xmath160 .    for @xmath161 , we have @xmath162",
    ". hence @xmath163 , and we obtain @xmath164 .",
    "thus @xmath165 , and @xmath166 .",
    "for the unit vectors @xmath167 , @xmath168 , @xmath169 we have @xmath170 , @xmath171 .",
    "thus @xmath172 , and @xmath173 .",
    "therefore , @xmath174 .",
    "since the vector @xmath175 is orthogonal to @xmath136 , we finally obtain @xmath131 .",
    "we let @xmath49 be the geodesic boundary at infinity of a complex hyperbolic space @xmath6 . for every @xmath87 the function @xmath176 for @xmath177",
    ", @xmath178 is a ( bounded ) metric on @xmath51 , where @xmath179 is the gromov product based at @xmath64 . for every @xmath180 and every busemann function @xmath181 centered at @xmath33 the function @xmath182 and @xmath183 , except for the case @xmath184 ,",
    "is an extended ( unbounded ) metric on @xmath51 with infinitely remote point @xmath33 , where @xmath185 is the gromov product with respect to @xmath112 , see ( * ? ? ?",
    "* sect.3.4.2 ) .",
    "since @xmath6 is a @xmath186-space , the metrics @xmath187 , @xmath188 satisfy the ptolemy inequality and furthermore all these metrics are pairwise mbius equivalent , see @xcite .",
    "we let @xmath189 be the _",
    "canonical _ mbius structure on @xmath51 generated by the metrics of type @xmath187 , @xmath87 , i.e. any metric @xmath190 is mbius equivalent to some metric @xmath187 , @xmath87 .",
    "then @xmath51 endowed with @xmath189 is a compact ptolemy space .",
    "every extended metric @xmath190 is of type @xmath191 for some busemann function @xmath181 , while a bounded metric @xmath190 does not necessary coincide with @xmath192 , for some @xmath87 and @xmath193 , see @xcite .",
    "we emphasize that metrics of @xmath189 are neither carnot - carathodory metrics nor length metrics .",
    "[ pro : axioms_model ] the boundary at infinity @xmath49 of any complex hyperbolic space @xmath50 , @xmath1 , taken with the canonical mbius structure , satisfies axioms ( e ) , ( o ) .",
    "every @xmath11-circle @xmath194 is the boundary at infinity of a uniquely determined complex hyperbolic plane @xmath59 , and every @xmath10-circle @xmath195 is the boundary at infinity of a uniquely determined real hyperbolic plane @xmath196 .",
    "axioms ( e ) , ( o ) are trivially satisfied for @xmath197 .",
    "thus we assume that @xmath82 .",
    "axiom ( @xmath198 ) : given distinct @xmath43 , @xmath199 there is a unique geodesic @xmath111 with the ends @xmath43 , @xmath200 at infinity .",
    "this @xmath94 lies in the unique complex hyperbolic plane @xmath59 .",
    "then @xmath201 is a uniquely determined @xmath11-circle containing @xmath43 , @xmath200 .",
    "axiom ( @xmath202 ) : given a @xmath11-circle @xmath194 , @xmath30 , @xmath203 , we let @xmath59 be the complex hyperbolic plane with @xmath60 , @xmath61 the orthogonal projection of @xmath34 to @xmath119 , i.e. the geodesic ray @xmath204 is orthogonal to @xmath119 at @xmath64 .",
    "there is a unique geodesic @xmath205 through @xmath64 with @xmath33 as one of the ends at infinity .",
    "then @xmath206 and @xmath94 span a real hyperbolic plane @xmath196 , for which @xmath207 is a uniquely determined @xmath10-circle in @xmath51 through @xmath33 , @xmath34 that hits @xmath208 .",
    "axioms ( o ) : given an @xmath10-circle @xmath195 and a @xmath11-circle @xmath194 with common distinct points @xmath38 , @xmath33 , there are real hyperbolic plane @xmath196 , complex hyperbolic plane @xmath59 with @xmath209 , @xmath60",
    ". then @xmath210 and @xmath119 are mutually orthogonal along the geodesic @xmath211 .",
    "( @xmath212 ) : given @xmath34 , @xmath39 such that @xmath40 , we can assume that @xmath213 .",
    "then the geodesic @xmath214 is orthogonal to @xmath94 at @xmath215 .",
    "for every @xmath42 the geodesic rays @xmath216 , @xmath217 span a sector @xmath218 in a real hyperbolic plane @xmath219 , which is isometric to the sectors @xmath220 , @xmath221 .",
    "thus @xmath222 with respect to the metric @xmath223 on @xmath51 .",
    "it follows that @xmath224 .",
    "( @xmath225 ) : given @xmath43 , @xmath44 such that @xmath45 , we can assume that @xmath226 .",
    "then the geodesic @xmath227 is orthogonal to @xmath94 at @xmath228 for @xmath47 , let @xmath229 be the orthogonal projection of @xmath230 on @xmath119 .",
    "then @xmath231 , and the geodesic rays @xmath232 , @xmath233 span a sector @xmath234 in a real hyperbolic plane @xmath219 , which is isometric to the sector @xmath235 in another real hyperbolic plane @xmath236 , while the sectors @xmath237 , @xmath238 are isometric .",
    "thus @xmath239 with respect to the metric @xmath240 on @xmath51 .",
    "it follows that @xmath241 .",
    "here we briefly recall basic notions of mbius geometry . for more detail",
    "see @xcite , @xcite . a quadruple @xmath242 of points in a set @xmath2 is said to be _",
    "admissible _ if no entry occurs three or four times in @xmath243 .",
    "two metrics @xmath4 , @xmath244 on @xmath2 are _ mbius equivalent _ if for any admissible quadruple @xmath245 the respective _ cross - ratio triples _ coincide , @xmath246 , where @xmath247 we consider _ extended _ metrics on @xmath2 for which existence of an _ infinitely remote _",
    "point @xmath5 is allowed , that is , @xmath248 for all @xmath249 , @xmath250 .",
    "we always assume that such a point is unique if exists , and that @xmath251 .",
    "we use notation @xmath252 and the standard conventions for the calculation with @xmath253 .",
    "a _ mbius structure _ on a set @xmath2 , or a mbius space over @xmath2 , is a class @xmath254 of metrics on @xmath2 which are pairwise mbius equivalent .",
    "a map @xmath255 between two mbius spaces is called _ mbius _ , if @xmath256 is injective and for all admissible quadruples @xmath257 @xmath258 where the cross - ratio triples are taken with respect to some ( and hence any ) metric of the mbius structure of @xmath2 and of @xmath259 .",
    "if a mbius map @xmath255 is bijective , then @xmath260 is mbius , @xmath256 is homeomorphism , and the mbius spaces @xmath2 , @xmath259 are said to be _",
    "mbius equivalent_.    if two metrics of a mbius structure have the same infinitely remote point , then they are homothetic , see @xcite .",
    "we always assume that for every @xmath5 the set @xmath261 is endowed with a metric of the structure having @xmath33 as infinitely remote point , and use notation @xmath262 for the distance between @xmath43 , @xmath263 .",
    "sometimes we abbreviate to @xmath264 .",
    "a mbius space @xmath2 is ptolemy , if it satisfies the _ ptolemy inequality _",
    "@xmath265 for any admissible 4-tuple @xmath266 and for every metric of the mbius structure .",
    "this is equivalent to the definition of a ptolemy space given in sect .",
    "[ sect : introduction ] .",
    "an @xmath10-circle @xmath32 satisfies the _ ptolemy equality _",
    "@xmath267 for every 4-tuple @xmath268 ( in this order ) and for every metric of the mbius structure .",
    "in particular , for a fixed @xmath269 we have @xmath270 , i.e. @xmath36 is a geodesic in the space @xmath271 called an @xmath10-_line_.    a @xmath11-circle @xmath29 satisfies the squared ptolemy equality @xmath272 for every 4-tuple @xmath268 ( in this order ) and for every metric of the mbius structure . in particular ,",
    "for a fixed @xmath273 we have @xmath274 , and @xmath37 is called a @xmath11-_line _ in @xmath271 .",
    "an admissible 4-tuple @xmath17 is _ harmonic _ if @xmath275 for some and hence any metric @xmath4 of the mbius structure .",
    "note that if @xmath276 or @xmath277 for an admissible @xmath278 , then @xmath243 is harmonic .",
    "we say that @xmath43 , @xmath279 lie on a sphere between distinct @xmath33 , @xmath280 if the 4-tuple @xmath281 is harmonic . for a fixed @xmath33 , @xmath282",
    "this defines an equivalence relation on @xmath283 , and any equivalence class @xmath284 is called a _ sphere between _ @xmath33 , @xmath282 .",
    "mbius maps preserve spheres between two points : if @xmath285 is mbius , then @xmath286 is a sphere between @xmath287 , @xmath288 . in the metric space",
    "@xmath261 the sphere @xmath289 is a metric sphere centered at @xmath282 , @xmath290 for some @xmath291 .",
    "the points @xmath33 , @xmath282 are _ poles _ of @xmath289 .",
    "the orthogonality axioms  ( o ) tell us that if @xmath292 is harmonic on an @xmath10-circle , then the @xmath11-circle through @xmath38 , @xmath33 lies in a sphere between @xmath34 , @xmath293 , and vice versa , if @xmath294 is harmonic on a @xmath11-circle , then any @xmath10-circle through @xmath43 , @xmath200 lies in a sphere between @xmath38 , @xmath33 .",
    "if we take some point on a sphere as infinitely remote , then the sphere becomes the _ bisector _ between its poles ,    [ lem : bisector ] let @xmath295 is a sphere between distinct @xmath34 , @xmath296 .",
    "then for every @xmath297 the set @xmath298 is the bisector in @xmath261 between @xmath34 , @xmath293 , that is , @xmath299    for every @xmath300 we have @xmath301 .",
    "thus @xmath302 if and only if @xmath303 .",
    "[ cor : bisector_cline ] let @xmath36 , @xmath37 be @xmath10-circle , @xmath11-circle respectively with distinct common points @xmath38 , @xmath33 .",
    "then    * for any @xmath304 the @xmath11-line @xmath305 through @xmath38 lies in the bisector between @xmath34 , @xmath293 , that is , @xmath306 for every @xmath42 , * for any @xmath307 any @xmath10-line @xmath308 through @xmath38 lies in the bisector between @xmath43 , @xmath200 , that is , @xmath309 for every @xmath47 .    in particular , if @xmath310 , @xmath311 with @xmath312 and @xmath313 , then @xmath314    we have @xmath315 .",
    "thus by axiom  ( @xmath212 ) the @xmath11-line @xmath37 lies in the bisector between @xmath34 , @xmath293 , and by axiom  ( @xmath225 ) the @xmath10-line @xmath36 lies in the bisector between @xmath43 , @xmath200 .",
    "[ lem : intersect_rcircle_ccircle ] any @xmath11-circle @xmath37 and any @xmath10-circle @xmath36 have at most two points in common .",
    "assume @xmath316 .",
    "choose @xmath311 such that @xmath40 .",
    "by corollary  [ cor : bisector_cline ] the @xmath11-line @xmath305 lies in the bisector between @xmath34 , @xmath293 .",
    "thus @xmath10-line @xmath308 intersects @xmath208 once ( at @xmath38 ) .",
    "[ lem : three_points_rcircles ] if two @xmath10-circles @xmath36 , @xmath94 have in common three distinct points , then they coincide , @xmath317 .",
    "assume @xmath318 .",
    "then for the @xmath11-circle @xmath37 through @xmath319 we have @xmath320 by lemma  [ lem : intersect_rcircle_ccircle ] . by ( @xmath202 ) , there is at most one @xmath10-circle @xmath36 with @xmath321 .",
    "[ cor : cline_projection ] given a @xmath11-circle @xmath29 and @xmath30 , there is a retraction @xmath322 ( continuous on @xmath261 ) , @xmath323 for @xmath273 and @xmath324 for @xmath31 , where @xmath36 is the @xmath10-circle through @xmath325 that hits @xmath208 .    by lemma  [ lem : intersect_rcircle_ccircle ] ,",
    "the intersection @xmath326 consists of a unique point , thus @xmath327 is well defined .",
    "assume @xmath328 .",
    "we show that @xmath329 is bounded .",
    "this then implies @xmath330 by uniqueness .",
    "assume to the contrary that @xmath331 for some basepoint @xmath332 in the metric of @xmath261 .",
    "let @xmath333 such that @xmath334",
    ". then @xmath335 . but",
    "this would imply that also @xmath336 because @xmath337 and @xmath338 lie on the same sphere between @xmath38 and @xmath339 .",
    "let @xmath29 be a @xmath11-circle .",
    "then by corollary  [ cor : cline_projection ] , every @xmath31 defines an involution @xmath340 without fixed points by @xmath341    [ pro : conjugate_pole ] given a @xmath11-circle @xmath29 and @xmath31 , there exists a unique @xmath342 , @xmath343 , such that @xmath344 for every @xmath345 and for the @xmath10-circle @xmath346 through @xmath347 .",
    "this results defines for a @xmath11-circle @xmath37 an involution @xmath52 with fixed point set @xmath37 in the following way : for @xmath31 let @xmath348 be the unique point defined by proposition  [ pro : conjugate_pole ] . for @xmath273",
    "define @xmath349 .",
    "the involution @xmath53 is called the _ reflection _ with respect to @xmath37 .    in the case that @xmath31",
    "we say that @xmath34 , @xmath293 are _ conjugate poles _ of @xmath37 .",
    "note that @xmath350 for conjugate poles @xmath351 of @xmath37 .",
    "thus in a simplified way one can visualize @xmath37 as equator of a 2-sphere , @xmath352 as the poles , the map @xmath350 as antipodal map on the equator such that for all @xmath43 on the equator the points @xmath353 lie in harmonic position on a circle as in the following picture , where @xmath354 .",
    "[ fi : conj_poles ]     for the proof of proposition  [ pro : conjugate_pole ] we need lemmas  [ lem : bisector_rcircle][lem : concatenation ] .",
    "[ lem : bisector_rcircle ] given a @xmath11-line @xmath355 , @xmath10-circle @xmath308 and @xmath356 with @xmath357 , we have @xmath358 for all @xmath359 .    by corollary  [ cor : bisector_cline](i ) , the @xmath11-line @xmath360 lies in the bisector in @xmath361 between @xmath34 , @xmath362 , thus @xmath363 for every @xmath364 . taking the metric inversion ( [ eq : metric_inversion ] ) with respect",
    "to @xmath33 we obtain @xmath365 for every @xmath359 .",
    "[ lem : sym_dist ] given @xmath366 and a @xmath11-line @xmath355 , the distance function @xmath367 , @xmath368 , is symmetric with respect to @xmath369 , that is , @xmath370 for every @xmath371 with @xmath372 .",
    "if @xmath372 , then @xmath373 . thus by corollary  [ cor : bisector_cline](ii ) , the @xmath10-line @xmath308 through @xmath34 , @xmath38 lies in the bisector in @xmath261 between @xmath230 , @xmath374 .",
    "[ lem : symmetric_functions ] assume for @xmath375 the distance functions @xmath376 along a @xmath11-line @xmath355 coincide , @xmath377 for all @xmath359 , and @xmath378 is symmetric with respect to @xmath379 , while @xmath380 is symmetric with respect to @xmath381 . then @xmath382 .",
    "let @xmath383 be isometric reflections with respect to @xmath384 respectively , @xmath385 .",
    "using @xmath386 and @xmath387 for all @xmath388 , we obtain @xmath389    thus by induction , the function @xmath378 is constant along the sequence @xmath390 .",
    "if one admits that @xmath391 , then @xmath392 in @xmath261 and thus @xmath393 as @xmath394 being a distance function , a contradiction .",
    "hence @xmath382 .",
    "[ lem : concatenation ] assume that @xmath395 for some @xmath375 , where @xmath396 . if @xmath397 , then @xmath398 are contained in an @xmath10-line .",
    "we can assume that @xmath399 .",
    "let @xmath400 be the unit speed parametrizations of the @xmath10-lines through @xmath401 and @xmath402 respectively such that @xmath403 , @xmath404 , @xmath405 .",
    "then by the triangle inequality @xmath406 for all @xmath407 .",
    "we put @xmath408 , @xmath409 .",
    "the function @xmath410 is convex and 1-lipschitz , @xmath411 , @xmath412 by the assumption .",
    "hence @xmath413 for all @xmath414 .",
    "similarly , for a fixed @xmath414 the function @xmath415 is convex and 1-lipschitz , @xmath416 , @xmath417 .",
    "hence @xmath418 for all @xmath419 .",
    "therefore , @xmath420 for all @xmath407 .",
    "thus the concatenation @xmath421 is a geodesic line , which implies that @xmath398 are contained in an @xmath10-line .",
    "let @xmath422 , @xmath94 the @xmath10-line in @xmath261 through @xmath34 , @xmath38 .",
    "we take @xmath423 , @xmath343 , such that @xmath424 .",
    "given @xmath345 , we put @xmath425 , and let @xmath36 be the @xmath10-circle through @xmath426 .",
    "we show that @xmath427 for @xmath428 , @xmath429 , such that @xmath356 .    by lemma  [ lem : bisector_rcircle ] the distance functions @xmath376",
    ", @xmath430 , @xmath431 , coincide , @xmath432 for all @xmath359 . by lemma",
    "[ lem : sym_dist ] , @xmath378 is symmetric with respect to @xmath38 , while @xmath380 is symmetric with respect to @xmath433 .",
    "thus @xmath434 by lemma  [ lem : symmetric_functions ] .    by the triangle inequality @xmath435 . on the other hand , by the ptolemy equality we have @xmath436 by lemma  [ lem : bisector_rcircle ] , @xmath437 , and by corollary  [ cor : bisector_cline](i ) , @xmath438 .",
    "similarly , @xmath439 . by the ptolemy inequality @xmath440",
    "we conclude that @xmath441 .",
    "hence , @xmath442 . from lemma  [ lem : concatenation ]",
    "we conclude that @xmath443 , thus @xmath427 .",
    "[ lem : harmonic_midpoint ] given a @xmath11-circle @xmath37 , @xmath43 , @xmath44 , @xmath31 , there exists @xmath30 such that @xmath444 .",
    "we put @xmath445 , @xmath446 . then for every @xmath447 we have @xmath448 , where @xmath449 is the arc between @xmath450 that does not contain @xmath451 , @xmath452 , and @xmath453 is the arc between @xmath454 that does not contain @xmath43 , @xmath200 . the cross - ratio function",
    "@xmath455 , defined by @xmath456 via a metric of the mbius structure , is continuous and takes values @xmath457 , @xmath458 .",
    "then @xmath33 with @xmath459 does the job .",
    "[ lem : filling_sphere_rcirles ] assume a sphere @xmath295 between @xmath33 , @xmath374 intersects the @xmath11-circle @xmath37 through @xmath33 , @xmath374 at @xmath43 , @xmath451 .",
    "then for every @xmath460 there is an @xmath10-circle @xmath461 with @xmath462 .    by lemma  [ lem : harmonic_midpoint ]",
    "there is @xmath463 such that @xmath464 , where @xmath465 , in particular , there is an @xmath10-circle @xmath466 with @xmath467 . by axiom @xmath225",
    ", @xmath461 lies on a sphere @xmath468 between @xmath469 . since @xmath470",
    ", we conclude that @xmath471 and therefore @xmath472 .    [",
    "pro : moebius_involution ] for every @xmath43 , @xmath473 , @xmath31 we have @xmath474 where @xmath342 is the conjugate to @xmath34 pole of @xmath37 .",
    "we put @xmath475 . by lemma",
    "[ lem : harmonic_midpoint ] there is @xmath30 such that @xmath476 , where @xmath477 . by definition of @xmath478 , there is an @xmath10-circle @xmath36 through @xmath33 , @xmath34 and @xmath38 .",
    "then @xmath37 , @xmath36 are @xmath11-line , @xmath10-line respectively in the metric space @xmath261 , and @xmath38 is the midpoint between @xmath43 , @xmath479 , @xmath480 , where @xmath481 is the distance in @xmath261 .",
    "we denote by @xmath482 the metric reflection with respect to @xmath38 .",
    "then @xmath483 is an isometry with @xmath484 , in particular , @xmath483 is mbius .",
    "note that @xmath37 is in the bisector in @xmath261 between @xmath34 and @xmath293 , that is @xmath485 for every @xmath42 .",
    "furthermore , @xmath36 is in the bisector between any @xmath42 and @xmath486 .",
    "thus @xmath487 .",
    "we show that @xmath488 .    since @xmath489",
    ", there is an @xmath10-circle @xmath490 such that @xmath491 .",
    "let @xmath42 be the midpoint between @xmath136 , @xmath479 , @xmath492 .",
    "the circle @xmath94 is a metric circle in @xmath261 centered at @xmath230 , in particular , @xmath493 .",
    "we put @xmath494 . then @xmath495 and @xmath496 .",
    "it follows that @xmath497 lie on the metric sphere of radius @xmath498 centered at @xmath374 .",
    "thus by lemma  [ lem : filling_sphere_rcirles ] there is a circle @xmath466 through @xmath43 , @xmath451 with @xmath499 .",
    "this means that @xmath445 .",
    "it follows @xmath500    [ cor : phi_u_moebius ] for every @xmath11-circle @xmath37 and every @xmath31 the involution @xmath340 is mbius .",
    "note that @xmath501 for each @xmath43 , @xmath44 , where @xmath293 is the conjugate to @xmath34 pole of @xmath37 .",
    "thus in the space @xmath502 we have @xmath503 by proposition  [ pro : moebius_involution ] , where @xmath504 , @xmath446 .",
    "hence @xmath478 preserves the cross - ratio triple of any admissible 4-tuple in @xmath37 .",
    "using proposition  [ pro : moebius_involution ] , we derive here a distance formula ( see proposition  [ pro : explicit_distance ] ) which plays a very important role in the paper .    [",
    "lem : wharm_basics ] let @xmath34 , @xmath296 be conjugate poles of a @xmath11-circle @xmath37 .",
    "then for every @xmath43 , @xmath473 we have @xmath505 where @xmath506 , @xmath507 .",
    "we consider a background metric @xmath508 with infinitely remote point @xmath293 and we define @xmath509 and @xmath510 as the metric inversions , i.e. @xmath511 and @xmath512 since @xmath37 lies on a sphere between @xmath34 , @xmath293 , we have @xmath513 for every @xmath42 and observe that @xmath514 .",
    "thus we have @xmath515 .",
    "furthermore , @xmath516 and @xmath517    by proposition  [ pro : moebius_involution ] , @xmath518 and also @xmath519 .",
    "each of these cross - ratios is of the form @xmath520 .",
    "hence @xmath521 and @xmath522 .",
    "it follows that @xmath523 and similarly @xmath524 .",
    "we denote by @xmath525 , @xmath526 , and consider the metric inversion @xmath527 with respect to @xmath136 .",
    "we calculate @xmath528 , @xmath529 .",
    "thus two metrics @xmath530 and @xmath531 with the common infinitely remote point @xmath136 coincide , in particular , @xmath532 .    on the other hand , @xmath533 .",
    "therefore @xmath534 and hence @xmath535 .",
    "[ pro : explicit_distance ] given @xmath38 , @xmath366 , let @xmath305 be the @xmath11-line through @xmath38 ( and @xmath33 ) , @xmath536 , and let @xmath537 , @xmath538 , @xmath539 . then @xmath540",
    "we take @xmath43 , @xmath44 with @xmath541 . without loss of generality",
    "we can assume that @xmath542 .",
    "then @xmath543 , @xmath544 .",
    "we have @xmath507 .",
    "the points @xmath43 , @xmath200 , @xmath34 lie on the metric sphere of radius @xmath498 centered at @xmath38 .",
    "thus by lemma  [ lem : filling_sphere_rcirles ] there exists an @xmath10-circle @xmath545 through @xmath43 , @xmath200 , @xmath34 , and therefore @xmath506 . using that @xmath546 by lemma  [ lem : wharm_basics ]",
    ", we obtain @xmath540 .",
    "[ rem : koranyi_gauge ] as it is explained in @xcite , the distance formula @xmath540 gives rise to the kornyi gauge on the heisenberg group @xmath547 , see ( * ? ? ?",
    "* remark  14.4 ) .",
    "we fix @xmath5 and denote by @xmath78 the set of all the @xmath11-circles in @xmath2 through @xmath33 . by axiom  ( @xmath198 ) , for every @xmath300 the",
    "is a unique @xmath11-circle @xmath548 with @xmath345 .",
    "this defines a map @xmath549 , @xmath550 , called the _",
    "canonical _ projection , the set @xmath78 is called the _ base _ of @xmath551 , and the foliation of @xmath261 by the fibers of @xmath551 is said to be _",
    "canonical_. in this section we use notation @xmath552 for the distance between @xmath43 , @xmath263 in the metric space @xmath261 .      [ lem : busemann_constant ] let @xmath308 be an @xmath10-line . any busemann function @xmath553 associated with @xmath36",
    "is constant along any @xmath11-line @xmath305 which meets @xmath36 .",
    "we parametrize @xmath554 by arclength such that @xmath555 and @xmath112 decreases along @xmath36 . by proposition",
    "[ pro : explicit_distance ] we have @xmath556 for every @xmath345 and @xmath92",
    ". therefore @xmath557 .",
    "[ lem : distance_clines ] for every @xmath11-line @xmath305 the function @xmath558 is constant along any @xmath11-line @xmath559 .    for @xmath560 let @xmath554 be the arclength parametrization of the uniquely determined @xmath10-line with @xmath561 , @xmath562 , where @xmath563 .",
    "the busemann function of @xmath36 is 1-lipschitz and by lemma  [ lem : busemann_constant ] it is constant on @xmath37 as well as on @xmath70 .",
    "it follows that @xmath564 for every @xmath44 , @xmath565 .",
    "in particular , @xmath566 for all @xmath565 . by symmetry we get equality .",
    "given @xmath37 , @xmath567 we put @xmath568 for some @xmath560 . by lemma  [ lem : distance_clines ] this is well defined and moreover , it is a metric on @xmath78 .",
    "indeed , given @xmath37 , @xmath70 , @xmath569 , we take @xmath560 and put @xmath570 , @xmath571 . then @xmath572 .",
    "this metric on @xmath78 is said to be _",
    "canonical_.    the projection @xmath549 is 1-lipschitz and isometric if restricted to any @xmath10-line in @xmath261 .",
    "this implies that every two points in @xmath78 lie on a geodesic line .",
    "[ lem : base_unique_geodesic ] the base @xmath78 with the canonical metric is uniquely geodesic , i.e. between any two points there is a unique geodesic . in particular",
    ", @xmath78 is contractible .",
    "given pairwise distinct @xmath37 , @xmath70 , @xmath569 with @xmath573 , we take @xmath560 and put @xmath570 , @xmath571 , @xmath574",
    ". then @xmath575 therefore @xmath576 by proposition  [ pro : explicit_distance ] .",
    "since @xmath577 for @xmath578 and @xmath579 , the points @xmath43 , @xmath451 , @xmath580 are contained in an @xmath10-line by lemma  [ lem : concatenation ] .",
    "this line is unique by lemma  [ lem : three_points_rcircles ] .",
    "the claim follows .",
    "[ lem : mu_isometric ] for every @xmath11-line @xmath305 the retraction @xmath581 if restricted to any @xmath11-line @xmath582 is isometric .",
    "given @xmath451 , @xmath565 we let @xmath583 , @xmath584 , @xmath585 , @xmath586 .",
    "by proposition  [ pro : explicit_distance ] , @xmath587 . on the other hand , @xmath588 .",
    "thus again by proposition  [ pro : explicit_distance ] , @xmath589 .",
    "hence , @xmath590 .",
    "[ lem : limit_circle ] assume that @xmath591 in @xmath2 , and a point @xmath249 distinct from @xmath33 is fixed .",
    "then any @xmath10-circle @xmath592 through @xmath33 , @xmath43 is the ( pointwise ) limit of a sequence of @xmath10-circles @xmath593 through @xmath594 , @xmath43 .",
    "let @xmath595 be a point different from @xmath43 , @xmath33 , and let @xmath596 be the @xmath11-circle through @xmath38 , @xmath33 . for @xmath597 we let @xmath598 be a @xmath11-circle through @xmath38 , @xmath594 , which is uniquely determined for sufficiently large @xmath597 as soon as @xmath599 . since @xmath2 is compact , @xmath600 pointwise and thus for @xmath597 large enough @xmath601 .",
    "by axiom  ( @xmath202 ) there is uniquely determined @xmath10-circle @xmath593 through @xmath594 , @xmath43 which hits @xmath602 .",
    "then @xmath603 subconverges to an @xmath10-circle @xmath604 through @xmath33 , @xmath43 that hits @xmath605 . by axiom  ( @xmath202 ) , @xmath606 and",
    "@xmath607 follows .",
    "the following result has been obtained in ( * ? ? ?",
    "* proposition  4.1 ) , ( * ? ? ?",
    "* corollary  3.19 ) under different assumptions .",
    "[ pro : busemann_affine ] given two @xmath10-lines @xmath608 , @xmath609 , the busemann functions of @xmath608 are affine on @xmath610 .",
    "let @xmath553 be a busemann function of @xmath608 .",
    "we can write @xmath611 for every @xmath300 , where @xmath595 is some fixed point , @xmath612 .",
    "let @xmath613 be the midpoint between @xmath43 , @xmath614 , @xmath615 .",
    "we have to show that @xmath616 .",
    "busemann functions in any ptolemy space are convex , see ( * ? ? ?",
    "* proposition  4.1 ) , thus @xmath617 .    by lemma  [ lem : limit_circle ] , for every sufficiently large @xmath597 there is an @xmath10-circle @xmath618 through @xmath43 and @xmath594 such that the sequence @xmath603 converges pointwise to @xmath610 .",
    "thus there are points @xmath619 with @xmath620 .",
    "the points @xmath43 , @xmath621 divide @xmath603 into two segments .",
    "choose a point @xmath622 in the segment that does not contain @xmath594 such that @xmath623 .",
    "one easily sees that @xmath624 .",
    "the points @xmath43 , @xmath622 , @xmath621 , @xmath594 lie on the @xmath10-circle @xmath603 in this order .",
    "thus @xmath625 and since @xmath626 , we see @xmath627 .",
    "this implies in the limit @xmath628 .",
    "[ lem : busemann_constant_fibers ] busemann functions are constant on the fibers of @xmath549 .",
    "let @xmath553 be a busemann function associated with an @xmath10-line @xmath629 , and let @xmath305 be a @xmath11-line , @xmath345 , @xmath630 .",
    "using lemma  [ lem : busemann_constant ] we can assume that @xmath631 .",
    "we take @xmath632 with @xmath633 and consider the @xmath11-line @xmath582 through @xmath200 .",
    "then @xmath634 . by lemma  [ lem : busemann_constant ]",
    ", the function @xmath112 takes the constant value @xmath635 on @xmath70 .",
    "let @xmath636 .",
    "then @xmath637 , and there is a uniquely determined @xmath10-line @xmath308 through @xmath43 , @xmath136 . by proposition  [ pro : busemann_affine ]",
    "the function @xmath112 takes the constant value @xmath635 along @xmath36 .",
    "given @xmath638 , for the @xmath10-line @xmath639 through @xmath451 , @xmath640 we have @xmath641 by lemma  [ lem : base_unique_geodesic ] .",
    "thus the values of @xmath112 along @xmath642 are uniformly bounded because @xmath112 is lipschitz and the distance of any @xmath643 to @xmath36 equals @xmath644 by lemma  [ lem : mu_isometric ] . since @xmath645 is affine ,",
    "we conclude that @xmath646 , in particular , @xmath647 .",
    "[ pro : base_normed_space ] the base @xmath78 is isometric to a normed vector space of a finite dimension with a strictly convex norm .    by lemma  [ lem : base_unique_geodesic ] , @xmath78 is a geodesic metric space such that through any two distinct points there is a unique geodesic line .",
    "we show that affine functions on @xmath78 separate points .",
    "any busemann function @xmath553 is affine on @xmath10-lines by proposition  [ pro : busemann_affine ] . by lemma  [ lem : busemann_constant_fibers ]",
    ", @xmath112 is constant on the fibers of @xmath551 , thus it determines a function @xmath648 such that @xmath649 .",
    "every geodesic line @xmath650 is of the form @xmath651 for some @xmath10-line @xmath629 , and each unit speed parameterization @xmath652 of @xmath608 induces the unit speed parameterization @xmath653 of @xmath604 . then @xmath654 is an affine function on @xmath10 . through any @xmath43 , @xmath655",
    ", there is a geodesic line @xmath651 .",
    "let @xmath112 be a busemann function on @xmath261 associated with @xmath608 .",
    "then @xmath112 takes different values on the fibers of @xmath551 over @xmath43 , @xmath451 respectively .",
    "thus the affine function @xmath656 separates the points @xmath43 , @xmath451 , @xmath657 .",
    "then by @xcite , @xmath78 is isometric to a convex subset of a normed vector space with a strictly convex norm .",
    "since @xmath78 is geodesically complete , i.e. , through any two points there is a geodesic line , this subset is a subspace , and therefore @xmath78 is isometric to a normed vector space @xmath119 .",
    "the ptolemy space @xmath2 is compact , thus @xmath78 is locally compact , and the dimension of @xmath119 is finite .",
    "[ cor : homeo_sphere ] the space @xmath2 is homeomorphic to sphere @xmath658 , @xmath659 .    by proposition  [ pro : base_normed_space ] , @xmath78 is homeomorphic to an euclidean space @xmath660 , and since @xmath549 is a fibration over @xmath78 with fibers homeomorphic to @xmath10 , the space @xmath261 is homeomorphic to @xmath661 .",
    "thus @xmath2 is homeomorphic to @xmath662 .",
    "[ pro : property_u ] the ptolemy space @xmath2 has the following property : any 4-tuple @xmath257 of pairwise distinct points lies on an @xmath10-circle @xmath32 provided three of the points of @xmath243 lie on @xmath36 and the ptolemy equality holds for the cross - ratio triple @xmath663 .",
    "we assume that @xmath242 , @xmath664 and @xmath665 choosing @xmath200 as infinitely remote , we have @xmath666 and @xmath36 is an @xmath10-line in @xmath361 . recall that the canonical projection @xmath667 is 1-lipschitz and isometric on every @xmath10-line .",
    "thus @xmath668 where @xmath669 .",
    "the triangle inequality in @xmath670 implies @xmath671 . by proposition",
    "[ pro : base_normed_space ] , @xmath670 is isometric to a normed vector space with a strictly convex norm . thus we conclude that @xmath672 lies between @xmath673 and @xmath674 on a line in @xmath670 .",
    "this means that the @xmath11-line @xmath675 through @xmath34 hits @xmath36 , and for @xmath676 we have @xmath677 . by proposition",
    "[ pro : explicit_distance ] , @xmath678 and @xmath679 unless @xmath680 .",
    "we conclude that @xmath681 .",
    "we fix @xmath5 and change notation using the letter @xmath112 for elements of the base @xmath78 and @xmath682 for the respective fiber of @xmath551 . for any two @xmath112 , @xmath683 we have by lemma  [ lem : mu_isometric ] the isometry @xmath684 .",
    "[ lem : continuity_project_fiber ] the isometries @xmath684 depend continuously of @xmath112 , @xmath683 , that is , for @xmath685 and for any @xmath686 , we have @xmath687 .",
    "if a sequence of geodesic segments in a metric space pointwise converges , then the limit is also a geodesic segment . together with uniqueness of @xmath10-lines in @xmath261 and compactness of @xmath2",
    ", this implies the claim .",
    "we fix an orientation of @xmath682 and define the orientation of @xmath688 via the isometry @xmath689 .",
    "this gives a simultaneously determined orientation @xmath690 on all the fibers of @xmath551 .",
    "[ lem : fiber_orient ] the orientation @xmath690 is well defined and independent of the choice of @xmath691 .    by lemma  [ lem : base_unique_geodesic ] , the base @xmath78 is contractible . using lemma  [ lem : continuity_project_fiber ] ,",
    "we see that the orientation of @xmath692 induced by @xmath693 coincides with that induced by @xmath694 for each @xmath695 , @xmath696 .",
    "hence , the claim .",
    "we assume that a simultaneous orientation @xmath690 of @xmath11-lines in @xmath261 is fixed , and we call it the _ fiber orientation_. now we are able to produce nontrivial mbius automorphisms of @xmath2 . using the fiber orientation @xmath690 we define for every @xmath697 the map @xmath698 which acts on every fiber @xmath37 on @xmath551 as the shift by @xmath699 in the direction determined in the obvious way by the sign of @xmath700 and @xmath690 .",
    "the map @xmath94 is called a _ vertical shift_.    [ pro : vshift_isometry ] every vertical shift @xmath701 is an isometry .",
    "this immediately follows from definition of a vertical shift , lemma  [ lem : distance_clines ] and proposition  [ pro : explicit_distance ] .",
    "recall that every mbius map @xmath702 which fixes the point @xmath5 is a homothety of @xmath261 , that is , @xmath703 for some @xmath193 and every @xmath43 , @xmath263 .",
    "[ lem : involution_extended ] for every @xmath11-circle @xmath29 , every mbius involution @xmath704 without fixed points extends to a mbius map @xmath705 .",
    "we identify @xmath706 , where @xmath707 is the hyperbolic plane of constant curvature @xmath16 . for a fixed @xmath30",
    "any vertical shift @xmath708 restricted to @xmath37 is induced by a parabolic rotation @xmath709 , which is an isometry without fixed points in @xmath51 having the unique fixed point @xmath710 .",
    "one easily sees that parabolic rotations generate the isometry group of @xmath51 preserving orientation .",
    "the involution @xmath94 is induced by a central symmetry of @xmath51 .",
    "thus @xmath94 can be represented by a composition of vertical shifts with appropriate fixed points on @xmath37 .",
    "hence @xmath94 extends to a mbius map @xmath705 .",
    "[ lem : homothety_existence ] given distinct @xmath38 , @xmath5 , @xmath193 , there is a homothety @xmath711 with coefficient @xmath712 , @xmath713 , preserving the fiber orientation @xmath690 .",
    "let @xmath37 be the @xmath11-circle determined by @xmath38 , @xmath33 .",
    "using representation @xmath706 for @xmath707 we write @xmath714 for any orientation preserving homothety @xmath704 with fixed @xmath38 , @xmath33 , where @xmath715 , @xmath716 are mbius involutions without fixed points . by lemma",
    "[ lem : involution_extended ] , @xmath94 extends to a mbius @xmath705 .    assuming that @xmath5 is fixed we denote @xmath717 . for an isometry @xmath708 preserving the fiber orientation @xmath690 , we use notation @xmath718 for the rotational part of the induced isometry @xmath719 .",
    "an isometry @xmath701 is called a _ shift , _ if @xmath94 preserves @xmath690 and @xmath720 .",
    "[ lem : refined_shifts ] for any @xmath43 , @xmath721 there is a shift @xmath722 with @xmath723 .",
    "let @xmath724 be the isometry group of @xmath725 preserving a fixed point @xmath726 .",
    "for @xmath727 we put @xmath728 , where the supremum is taken over all unit vectors @xmath729 .",
    "note that @xmath730 is compact and that @xmath731 for every @xmath727 .",
    "we shall use the following well known ( and obvious ) fact . for every @xmath732",
    "there is @xmath733 such that for any @xmath727 there is an integer @xmath734 , @xmath735 , with @xmath736 .    by lemma  [ lem : homothety_existence ] ,",
    "for every @xmath737 , there are homotheties @xmath738 , @xmath739 with coefficient @xmath740 , @xmath741 , @xmath742 . next , there is an integer @xmath734 , @xmath743 , such that @xmath744 . applying the same argument to @xmath745",
    ", we find an integer @xmath498 , @xmath746 , such that @xmath747",
    ". then also @xmath748 , and for @xmath749 , @xmath750 we have @xmath751 , @xmath752 and @xmath753 , @xmath754 . for the isometry @xmath755",
    ", we have @xmath756 , @xmath757 , where @xmath758 as @xmath759 .",
    "thus @xmath760 as @xmath759 with @xmath723 , @xmath761 .",
    "the isometry @xmath762 preserves the fiber orientation @xmath690 because the homotheties @xmath738 , @xmath483 do .",
    "we fix @xmath5 and use notations @xmath717 , @xmath763 . let @xmath764 be a _ pointed _ oriented parallelogram , i.e. , we assume that an orientation and a vertex @xmath38 of @xmath765 are fixed .",
    "we have a map @xmath766 , where @xmath305 is the fiber of @xmath767 over @xmath38 , @xmath768 .",
    "namely , given @xmath345 , by axiom  ( @xmath202 ) there is a unique @xmath10-line in @xmath261 through @xmath43 that projects down by @xmath767 to the first ( according to the orientation ) side of @xmath765 containing @xmath38 .",
    "in that way , we lift the sides of @xmath765 to @xmath261 in the cyclic order according to the orientation and starting with @xmath38 which is initially lifted to @xmath43 .",
    "then @xmath769 is the resulting lift of the parallelogram sides .",
    "[ lem : triangle_lift ] the map @xmath766 is an isometry that preserves orientation and , therefore , it acts on @xmath37 as a vertical shift .",
    "the map @xmath770 is obtained as a composition of four @xmath11-line isometries of type @xmath689 , see sect .",
    "[ subsect : vertical_shifts ] .",
    "any isometry @xmath689 preserves orientation , see lemma  [ lem : fiber_orient ] .",
    "thus @xmath766 is an isometry preserving orientation .",
    "there is a unique vertical shift @xmath701 with @xmath771 .",
    "furthermore , every shift @xmath772 commutes with @xmath94 , thus the extension @xmath94 of @xmath770 coincides with that of @xmath773 for any @xmath774 obtained from @xmath765 by a shift of the base @xmath725 .",
    "we use the same notation for the extension @xmath775 and call it a _",
    "lifting isometry_.    since the group of vertical shifts is commutative , we have @xmath776 for any ( pointed oriented ) parallelograms and even for any closed oriented polygons @xmath765 , @xmath777 .",
    "let @xmath778 be a closed , oriented polygon . adding a segment @xmath779 between points @xmath780 , @xmath781 we obtain closed , oriented polygons @xmath765 , @xmath774 such that @xmath782 , the orientations of @xmath765 , @xmath774 coincide with that of @xmath243 along @xmath243 , and the segment @xmath783 receives from @xmath765 , @xmath774 opposite orientations .",
    "in this case we use notation @xmath784 .",
    "[ lem : adding_lifts ] in the notation above we have @xmath785 .",
    "we fix @xmath786 as the base point . moving from @xmath780 along @xmath243 in the direction prescribed by the orientation of @xmath243",
    ", we also move along one of @xmath765 , @xmath774 according to the induced orientation .",
    "we assume without loss of generality that this is the polygon @xmath765 .",
    "in that way , we first lift @xmath765 to @xmath261 starting with some point @xmath332 , where @xmath37 is the fiber of the projection @xmath787 over @xmath780 , such that the side @xmath788 is the last one while lifting @xmath765 .",
    "now , we lift @xmath774 to @xmath261 starting with @xmath789 moving first along the side @xmath790",
    ". then clearly the resulting lift of @xmath774 gives @xmath791 .",
    "thus @xmath785 .    for a vertical shift @xmath701",
    "we denote @xmath792 the displacement of @xmath94 .",
    "this is independent of @xmath300 .",
    "if @xmath94 , @xmath461 are vertical shifts in the same direction , then @xmath793 .",
    "[ lem : equal_shifts_triangles ] given a representation @xmath794 of an oriented parallelogram @xmath764 by oriented triangles @xmath795 , @xmath796 with induced from @xmath765 orientations , whose common side @xmath797 is a diagonal of @xmath765 , we have @xmath798 .    for every @xmath799",
    "we consider the subdivision @xmath800 of @xmath765 into @xmath801 congruent parallelograms @xmath802 with sides parallel to those of @xmath765 .",
    "we assume that the orientation of each @xmath802 is induced by that of @xmath765 .",
    "the parallelograms @xmath802 , @xmath803 are obtained from each other by a shift of the base @xmath725 , thus @xmath804 for each @xmath64 , @xmath805 , where @xmath806 .    by lemma  [ lem : adding_lifts ]",
    "we have @xmath807 , hence @xmath808 for every @xmath809 .",
    "therefore @xmath810 as @xmath811 .",
    "we subdivide the set @xmath58 into three disjoint subsets @xmath812 , where @xmath813 if and only if the interior of @xmath802 intersects the diagonal @xmath797 of @xmath765 , and @xmath814 if @xmath815 , @xmath816 if @xmath817 .",
    "then @xmath818 , @xmath819 .",
    "we conclude that @xmath820 and @xmath821 as @xmath811 . by lemma  [ lem : adding_lifts ] , @xmath822 .",
    "it follows that @xmath823    the following lemma will be used in sect .",
    "[ subsect : cos_suspension ] , see the proof of proposition  [ pro : sphere_isometric_cos ] .",
    "[ lem : area_lift_triange ] let @xmath824 be an oriented triangle . then for the triangle @xmath825 with @xmath826 $ ] we have @xmath827    arguing as in lemma  [ lem : adding_lifts ] for the oriented parallelogram @xmath828 ( for which @xmath829 is a diagonal ) we find that @xmath830 for @xmath825 , @xmath831 in the case @xmath43 is the midpoint of @xmath832 $ ] .",
    "therefore @xmath833 in this case",
    ". next we obtain by induction the required formula for the case @xmath834 is a dyadic number",
    ". then the general case follows by continuity .",
    "[ lem : homothety_lift_parallelogram ] let @xmath764 be an oriented parallelogram , @xmath835 the parallelogram obtained from @xmath765 by a homothety @xmath836 with coefficient @xmath193 , @xmath837 , @xmath838 . then @xmath839 .",
    "we can assume that the parallelograms @xmath765 , @xmath840 have @xmath38 as a common vertex , and that @xmath712 is rational .",
    "for a general @xmath712 one needs to use approximation .",
    "we choose @xmath799 such that @xmath841 and subdivide @xmath765 into @xmath842 congruent parallelograms , @xmath800 , @xmath801 , as in lemma  [ lem : equal_shifts_triangles ] .",
    "this also gives a subdivision of @xmath840 into @xmath843 parallelograms congruent to ones of the first subdivision , @xmath844 , @xmath845 .",
    "then @xmath846 , @xmath847 and @xmath848      in sect .",
    "[ sect : ccircle_involutions ] we have defined for every @xmath11-circle @xmath29 the reflection @xmath52 whose fixed point set is @xmath37 and @xmath348 is conjugate to @xmath34 pole of @xmath37 for every @xmath31 .    [",
    "pro : moebius_ccircle_involution ] for every @xmath11-circle @xmath29 the reflection @xmath52 is mbius .",
    "we fix @xmath30 and consider @xmath37 as a @xmath11-line in @xmath261 . by definition , @xmath849 preserves every @xmath10-line @xmath308 intersecting @xmath37 and acts on @xmath36 as the reflection with respect to @xmath850 , in particular , @xmath851 is isometric .",
    "it follows from lemma  [ lem : mu_isometric ] that @xmath53 is isometric on every @xmath11-line in @xmath261 , thus @xmath53 induces the central symmetry @xmath852 with respect to @xmath853",
    ".    given @xmath43 , @xmath721 we show that @xmath854 for @xmath855 , @xmath856 .",
    "let @xmath857 , @xmath858 be the @xmath11-lines through @xmath43 , @xmath200 respectively .",
    "we denote @xmath859 , @xmath860 . by proposition",
    "[ pro : explicit_distance ] we have @xmath861 furthermore , @xmath862 because @xmath863 , @xmath864 and @xmath865 , @xmath866 , where `` bar '' means the projection by @xmath551 .    the triangles @xmath867 and @xmath868 in @xmath725 are symmetric to each other by @xmath869 and have the same orientation .",
    "it follows from lemma  [ lem : equal_shifts_triangles ] that any lift of the closed polygon @xmath870 closes up in @xmath261 , that is , @xmath871 .",
    "hence @xmath872 and therefore @xmath873 .",
    "we conclude that @xmath854 .      for an @xmath10-line @xmath308",
    "we define the _ semi@xmath874-plane _ @xmath875 as @xmath876 .",
    "note that @xmath210 has two foliations : one by @xmath11-lines and another by @xmath10-lines .    given a @xmath11-line @xmath305 and an @xmath10-line @xmath308 with @xmath877 ,",
    "let @xmath878 be the semi@xmath874-plane _ spanned _ by @xmath37 and @xmath36 .",
    "every point @xmath879 is uniquely determined by its projections the _ vertical _ to @xmath37 , @xmath880 , and the _ horizontal _ to @xmath36 , @xmath881 , where @xmath857 is the @xmath11-line through @xmath43 .    for @xmath882 and @xmath193",
    "we define a map @xmath883 as follows .",
    "we put @xmath837 and require that @xmath884 preserves the @xmath11-line @xmath37 through @xmath38 and every @xmath10-line @xmath36 through @xmath38 acting on @xmath37 and @xmath36 as the homotheties with coefficient @xmath712 .",
    "finally , @xmath884 preserves every semi@xmath874-plane @xmath210 containing @xmath37 and acts on @xmath210 by @xmath885 , where @xmath210 is spanned by @xmath37 and the @xmath10-line @xmath36 through @xmath38 .",
    "[ pro : pure_homothety ] the map @xmath886 defined above is a homothety with coefficient @xmath712 , @xmath887 for every @xmath43 , @xmath263 , in particular , @xmath884 is mbius .",
    "it follows from definition and proposition  [ pro : explicit_distance ] that the restriction @xmath888 is the required homothety for every semi@xmath874-plane @xmath878 containing the @xmath11-line @xmath37 through @xmath38 .",
    "thus the induced map @xmath889 is the homothety with coefficient @xmath712 .",
    "let @xmath857 be the @xmath11-line through @xmath43 , @xmath36 the @xmath10-line through @xmath38 that intersect @xmath857 .",
    "similarly , let @xmath360 be the @xmath11-line through @xmath200 , @xmath94 the @xmath10-line through @xmath38 that intersect @xmath360 .",
    "we denote @xmath890 the projection of @xmath200 to @xmath857 . then by proposition",
    "[ pro : explicit_distance ] we have @xmath891 .    for the closed polygon @xmath892 , where `` bar '' means the projection by @xmath551",
    ", we have @xmath893 , where @xmath894 , @xmath895 are vertical and horizontal coordinates in respective semi@xmath874-planes .",
    "applying the map @xmath884 we obtain @xmath896 , @xmath897 , @xmath898 , @xmath899 , @xmath900 .",
    "furthermore , the polygon @xmath901 is obtained from @xmath765 by the homothety @xmath889 , @xmath902 , in particular @xmath903 .",
    "using the fact that @xmath904 for any vertical shift @xmath905 with @xmath906 and lemmas  [ lem : equal_shifts_triangles ] , [ lem : homothety_lift_parallelogram ] we obtain @xmath907 .",
    "it means that @xmath908 .",
    "therefore , @xmath909 and @xmath910 again by proposition  [ pro : explicit_distance ] . since @xmath911",
    ", we obtain @xmath912 .    by definition ,",
    "the homothety @xmath886 , @xmath837 , preserves every @xmath10-line @xmath308 through @xmath38 .",
    "every homothety with this property is said to be _",
    "let @xmath29 be a @xmath11-circle .",
    "every @xmath31 determines an involution @xmath340 without fixed points , which is mbius by corollary  [ cor : phi_u_moebius ] . in other words",
    ", we have a map @xmath913 , @xmath914 , where @xmath915 is the set of mbius involutions of @xmath37 without fixed points .",
    "we study fibers of this map , @xmath916 .",
    "the set @xmath917 is called the _ orthogonal complement _ to @xmath37 at @xmath762 .",
    "given distinct @xmath43 , @xmath44 let @xmath918 be the set covered by all @xmath10-circles in @xmath2 through @xmath43 , @xmath200 . by lemma  [ lem : filling_sphere_rcirles ] , this set can be described as the sphere in @xmath2 between @xmath38 , @xmath30 such that @xmath307 .",
    "then for every @xmath919 we have @xmath920 .",
    "thus @xmath921",
    "[ lem : filling_fiber ] given a @xmath11-circle @xmath29 and a mbius involution @xmath57 without fixed points , the orthogonal complement @xmath56 to @xmath37 at @xmath762 can be represented as @xmath922 for any @xmath43 , @xmath332 , @xmath923 , where @xmath924 .",
    "we have @xmath925 by eq .",
    "( [ eq : filling_fiber_represent ] ) . on the other hand , for every @xmath926 we have @xmath927 along the 4-tuple @xmath294 .",
    "thus @xmath927 because any mbius @xmath57 is uniquely determined by values at three distinct points .",
    "hence @xmath928 .",
    "note that the set @xmath929 contains with every @xmath930 the conjugate pole @xmath348 of @xmath37 .",
    "thus @xmath931 is an involution without fixed points . by proposition  [ pro : moebius_ccircle_involution ]",
    "this involution is mbius .",
    "[ lem : orthogonal_covering_ccircles ] for each pair @xmath932 of conjugate poles of @xmath37 the @xmath11-circle @xmath70 through @xmath34 , @xmath293 is contained in @xmath929 .",
    "we take distinct @xmath933 , @xmath934 , such that @xmath307 , where @xmath506 , @xmath935 .",
    "there are @xmath10-circles @xmath936 such that @xmath937 , @xmath938 . by axiom",
    "@xmath212 the @xmath11-circle @xmath70 through @xmath352 is contained in @xmath939 , where @xmath289 , @xmath940 are spheres between @xmath450 and @xmath941 respectively that contain @xmath352 . since @xmath307 , by axiom  @xmath225 we have @xmath942 and @xmath943 , where @xmath944 , @xmath945 are spheres between @xmath450 through @xmath941 and between @xmath941 through @xmath450 respectively .",
    "hence @xmath946 , @xmath947 .",
    "we conclude that @xmath948 , @xmath949",
    ". then @xmath950 by lemma  [ lem : filling_fiber ] , hence @xmath68 .",
    "[ lem : orthogonal_foliated_ccircles ] given a @xmath11-circle @xmath29 and a mbius involution @xmath57 without fixed points , the orthogonal complement @xmath56 is foliated by @xmath11-circles @xmath70 through pairs @xmath951 of conjugate poles of @xmath37 , and @xmath952 preserves every fiber of this fibration .    by lemma  [ lem : orthogonal_covering_ccircles ] ,",
    "@xmath58 is covered by @xmath11-circles @xmath70 .",
    "we have @xmath953 because @xmath53 permutes conjugate poles of @xmath37 .",
    "thus by axiom  @xmath198 distinct @xmath11-circles of the covering are disjoint , that is , the @xmath11-circles @xmath70 form a fibration of @xmath58 .    the fibration of @xmath929 by @xmath11-circles described in lemma  [ lem : orthogonal_foliated_ccircles ] is called _",
    "canonical_. we do not claim that every @xmath11-circle in @xmath929 is a fiber of the canonical fibration , this is actually not true in general .",
    "[ lem : fiber_involution ] given a mbius involution @xmath57 without fixed points of a @xmath11-circle @xmath37 , for every fiber @xmath70 of the canonical fibration of @xmath56 the reflection @xmath954 preserves @xmath58 and its canonical fibration .    for every @xmath928 and @xmath345 there an @xmath10-circle @xmath32 such that @xmath937 , where @xmath955 , @xmath348 .",
    "taking @xmath956 we observe that by definition @xmath957 permutes @xmath43 , @xmath200 , thus @xmath957 preserves @xmath37 and @xmath958 . since @xmath957 is mbius , we have @xmath959 for an arbitrary @xmath928 we have @xmath960 , where @xmath961 , and @xmath962 are conjugate poles of @xmath37 .",
    "thus @xmath957 moves the fiber of the canonical fibration through @xmath352 to the fiber through @xmath963 .",
    "we say that distinct @xmath11-circles @xmath37 , @xmath65 are _ mutually orthogonal _ to each other , @xmath964 , if @xmath953 and @xmath965 .",
    "note that then @xmath37 , @xmath70 are disjoint because by lemma  [ lem : intersect_rcircle_ccircle ] a @xmath11-circle and an @xmath10-circle have in common at most two points .",
    "if @xmath953 , then @xmath965 automatically by definition of @xmath53 .",
    "if @xmath966 and @xmath967 , then @xmath968 and @xmath969 .",
    "we also note that if @xmath964 , then @xmath53 acts on @xmath70 as a mbius involution without fixed points .",
    "[ lem : involutions_commute ] assume a @xmath11-circle @xmath29 is invariant under a mbius @xmath970 .",
    "then @xmath971 commutes with @xmath957 , @xmath972 .",
    "in particular , @xmath973 for mutually orthogonal @xmath11-circles @xmath37 , @xmath70 .",
    "since @xmath37 is the fixed point set for @xmath738 , we have @xmath972 along @xmath37 .",
    "thus to prove the equality @xmath974 for an arbitrary @xmath249 , we can assume that @xmath975 .",
    "for an arbitrary @xmath30 there is a ( uniquely determined ) @xmath10-circle @xmath32 such that @xmath976 , where @xmath977 , @xmath978 .",
    "then for the @xmath10-circle @xmath961 we have @xmath979 , where @xmath980 .",
    "this means that @xmath981 , that is , @xmath982 .    a collection @xmath983 of @xmath11-circles",
    "is said to be _ orthogonal _ , if @xmath984 for each distinct @xmath712 , @xmath985 .",
    "we denote by @xmath986 the respective mbius involutions . by lemma  [ lem : involutions_commute ] , @xmath987 for each @xmath712 , @xmath985 .",
    "[ lem : twoofthree_coincide ] let @xmath983 be an orthogonal collection of @xmath11-circles .",
    "then for distinct @xmath988 we have @xmath989 , in particular , @xmath990 lies in the fixed point set of @xmath991 .    by definition ,",
    "@xmath992 , @xmath993 preserve @xmath990 and therefore act on @xmath990 as mbius involutions without fixed points . since they commute , the composition @xmath991 has a finite order .",
    "it follows that @xmath989 because otherwise @xmath991 would be of infinite order .",
    "[ pro : empty_3d ] assume @xmath994 for mutually orthogonal @xmath11-circles @xmath995 , where @xmath966 , @xmath967",
    ". then @xmath77 .",
    "we let @xmath996 with @xmath659 .",
    "then @xmath997 for @xmath56 , @xmath998 . by lemma  [ lem : orthogonal_foliated_ccircles ]",
    ", @xmath58 is foliated by @xmath11-circles , thus @xmath999 is even . if @xmath1000 , then @xmath23 for @xmath1001 .",
    "we can assume that @xmath82 .",
    "note that the codimension of @xmath58 equals two and that @xmath37 is not contractible in @xmath1002 .",
    "thus the assumption @xmath1003 implies by transversality argument that @xmath1004 .",
    "hence @xmath133 and @xmath77 .",
    "[ pro : intersection_orthogonal_complements ] let @xmath995 be mutually orthogonal @xmath11-circles , @xmath964 , @xmath56 , @xmath998 , where @xmath1005 , @xmath1006 and @xmath971 , @xmath1007 . then for every @xmath1008 we have @xmath1009 .",
    "we denote @xmath1010 , @xmath1011 .",
    "we fix @xmath332 , @xmath1012 and put @xmath1013 , @xmath1014 .",
    "since @xmath1015 , there is an @xmath10-circle @xmath32 such that @xmath1016 .",
    "since @xmath928 , there is an @xmath10-circle @xmath490 such that @xmath1017 .",
    "[ lem : f_symm ] in the metric of @xmath261 we have @xmath1018 , @xmath1019 , @xmath1020 .",
    "the @xmath11-circle @xmath37 is the fixed point set of the mbius @xmath1021 .",
    "thus @xmath738 acts on @xmath261 as an isometry . using that @xmath1022 and @xmath1023",
    ", we obtain @xmath1018 , @xmath1019 .",
    "recall that @xmath1024 and @xmath58 lies in a sphere between @xmath38 , @xmath33 .",
    "thus @xmath1020 .",
    "since @xmath1025 , there is an @xmath10-circle @xmath466 such that @xmath1026 .",
    "[ lem : fprim_symm ] in the metric of @xmath1027 we have @xmath1028 , @xmath1029 , @xmath1030 .",
    "the @xmath11-circle @xmath70 is the fixed point set of the mbius @xmath970 .",
    "thus @xmath957 acts on @xmath1027 as an isometry .",
    "using that @xmath1031 and @xmath1032 , we obtain @xmath1028 , @xmath1029 .",
    "recall that @xmath1033 and @xmath1034 lies in a sphere between @xmath43 , @xmath200 .",
    "thus @xmath1030 .    using lemma  [ lem : fprim_symm ] ,",
    "we obtain @xmath1035 and using lemma  [ lem : f_symm ] , we obtain @xmath1036 that is , @xmath1037 .    next we show that @xmath1038 . using lemma  [ lem : fprim_symm ] , we obtain @xmath1039 by lemma  [ lem : f_symm ] , @xmath1020 , hence @xmath1038 .    since @xmath1026 ,",
    "we have @xmath1040 applying the ptolemy inequality to the 4-tuple @xmath1041 , we obtain @xmath1042 by lemma  [ lem : fprim_symm ] , @xmath1043 thus @xmath1044 we conclude that @xmath1045 .    on the other hand , @xmath1046 and @xmath1047 .",
    "hence @xmath1048 .",
    "therefore , the 4-tuple @xmath1049 satisfies the ptolemy equality @xmath1050 and three of its entries @xmath1051 lie on the @xmath10-circle @xmath94 . by proposition",
    "[ pro : property_u ] , @xmath1052 and hence @xmath427 .",
    "[ pro : intersection_foliation ] let @xmath995 be mutually orthogonal @xmath11-circles , @xmath964 , @xmath56 , @xmath998 , where @xmath1005 , @xmath1006 and @xmath971 , @xmath1007",
    ". then the intersection @xmath66 is the fixed point set of @xmath1053 , and it carries a fibration by @xmath11-circles , which coincides with the restriction of the canonical fibrations of @xmath58 , @xmath1034 to @xmath66 .",
    "assume @xmath1008 .",
    "there is a @xmath11-circle @xmath1054 of the canonical fibration of @xmath58 passing through @xmath34 and @xmath1055 , and there is a @xmath11-circle @xmath1056 of the canonical fibration of @xmath1034 passing through @xmath34 and @xmath1057 . by proposition  [ pro : intersection_orthogonal_complements ] ,",
    "hence @xmath1058 , i.e. @xmath66 carries a fibration by @xmath11-circles , which coincides with the restrictions of the canonical fibrations of @xmath58 , @xmath1034 to @xmath66 .",
    "furthermore , since @xmath738 , @xmath957 are involutions , we have @xmath1059 , i.e. @xmath66 lies in the fixed point set @xmath1060 of @xmath483 .",
    "assume @xmath1061 for some @xmath1062",
    ". then @xmath1063 and @xmath1064 .",
    "thus there is a unique @xmath11-circle @xmath1065 through @xmath34 , @xmath293 .",
    "then @xmath1066 , hence @xmath1067 is an orthogonal collection of @xmath11-circles . by lemma  [ lem : twoofthree_coincide ] , @xmath1068 acts on @xmath37 ( @xmath70 ) as @xmath957 ( @xmath738 ) does , @xmath1069 , @xmath1070 , and @xmath1071 .",
    "therefore @xmath1072 is a @xmath11-circle of the canonical fibrations of @xmath58 , @xmath1034 .",
    "thus @xmath1073 .",
    "[ lem : fixed_point_axioms ] assume a subset @xmath20 foliated by @xmath11-circles is the fixed point set of a mbius @xmath1074",
    ". then @xmath58 satisfies axioms ( e ) , ( o ) .",
    "we only need to check the existence axioms ( e ) .",
    "given distinct @xmath64 , @xmath805 , there is a unique @xmath11-circle @xmath29 through @xmath64 , @xmath1075 . since @xmath1076 , @xmath1077 , we have @xmath1078",
    ". then in the space @xmath1079 , the mbius @xmath1080 acts as a homothety preserving @xmath1075 . on the other hand , @xmath1079 is foliated by @xmath11-lines , one of which , @xmath70 , lies by the assumption in @xmath1060 .",
    "hence , @xmath1080 is an isometry pointwise preserving @xmath70 and @xmath1075 .",
    "this excludes a possibility that @xmath483 acts on @xmath1081 as the reflection at @xmath1075 .",
    "therefore , @xmath1082 , which is axiom  ( @xmath198 ) .    given a @xmath11-circle @xmath1083 , @xmath30 and @xmath1084 , there is a unique @xmath10-circle @xmath32 through @xmath33 , @xmath34 that hits @xmath208 .",
    "thus at least three distinct points of @xmath36 lies in @xmath1060 .",
    "we conclude that @xmath483 pointwise preserves @xmath36 , i.e. @xmath1085 , which is axiom  ( @xmath202 ) .",
    "[ cor : axioms_orthogonal_complements ] let @xmath37 , @xmath65 be mutually orthogonal @xmath11-circles , @xmath964 , @xmath56 , @xmath998 , where @xmath1005 , @xmath1006 and @xmath971 , @xmath1007",
    ". then the intersection @xmath66 satisfies axioms ( e ) and ( o ) .",
    "apply lemma  [ lem : fixed_point_axioms ] to @xmath66 which is by proposition  [ pro : intersection_foliation ] the fixed point set of the mbius @xmath1053 foliated by @xmath11-circles .",
    "let @xmath1086 be a @xmath11-circle in @xmath2 with a mbius involution @xmath57 without fixed points .",
    "let @xmath1087 be a nonempty subspace that satisfies axioms ( e ) , ( o ) , and is invariant under the reflection @xmath52 , @xmath953 .",
    "in this case we say that @xmath70 is a _ canonical _",
    "subspace orthogonal to @xmath37 at @xmath762 , cos for brevity .",
    "note that @xmath70 carries a canonical fibration by @xmath11-circles induced by @xmath53 , where the fiber through @xmath1012 is the uniquely determined @xmath11-circle through @xmath43 , @xmath1088 .",
    "we use notation @xmath1089 for this fibration , and @xmath1090 means that @xmath1091 is a fiber of @xmath1092 .",
    "[ lem : moebius_join_rcircle ] for every @xmath273 , @xmath1012 there are uniquely determined @xmath1093 , @xmath1094 such that @xmath1095 for an @xmath10-circle @xmath32 .    by definition of @xmath1096 , there is a uniquely determined @xmath10-circle @xmath32 through @xmath34 , @xmath43 that hits @xmath37 at @xmath1097 . then there is a unique @xmath1098 such that @xmath1095 .",
    "again , @xmath1094 by definition of @xmath70 .",
    "we define the _ ( mbius ) join _ @xmath72 as the union of @xmath10-circles @xmath32 such that @xmath1095 with @xmath1099 , @xmath1100 , where @xmath1097 , @xmath855 .",
    "every such a circle is called a _ standard _",
    "@xmath10-circle in @xmath72 .",
    "[ lem : moebius_join_intersection ] for any different standard @xmath10-circles @xmath36 , @xmath1101 we have @xmath1102 .",
    "we take @xmath1103 , @xmath1104 , and put @xmath1105 , @xmath1106 . then by axiom  ( @xmath225 ) , for any @xmath1107 , @xmath1108 such that @xmath1109 the @xmath10-circle @xmath642 lies in a sphere @xmath940 between @xmath1107 , @xmath362 .",
    "assume @xmath1110 .",
    "without loss of generality , @xmath434 .",
    "then @xmath1111 and @xmath1112 since otherwise @xmath1113 by lemma  [ lem : three_points_rcircles ] .",
    "thus we can assume that @xmath1114 .",
    "we take @xmath1115 and @xmath1116 such that @xmath1109 . in the space @xmath261",
    ", @xmath36 is an @xmath10-line through @xmath38 , and @xmath37 is a @xmath11-line through @xmath38 , while @xmath468 is the metric sphere centered at the midpoint @xmath1116 between @xmath1117 , @xmath282 , @xmath1118 .",
    "the distance function @xmath1119 , @xmath1120 , is convex and by corollary  [ cor : bisector_cline](i ) it is symmetric with respect to @xmath38 .",
    "thus @xmath1121 takes the value @xmath498 at most two times , that is , @xmath36 intersects @xmath468 at most two times ( actually exactly two times because the pair @xmath1122 separates the pair @xmath1123 on @xmath37 by properties of @xmath762 ) .    on the other hand",
    ", @xmath36 intersects @xmath70 twice and @xmath1124 because @xmath1125 .",
    "thus @xmath1102 .",
    "[ pro : dim_moeb_join ] assume @xmath1086 is a @xmath11-circle in @xmath2 with a free of fixed point mbius involution @xmath57 , @xmath65 a cos to @xmath37 at @xmath762 . if @xmath1126 , then @xmath1127 .",
    "we show that every point @xmath1062 lies on a standard @xmath10-circle in @xmath72 . given @xmath30",
    ", we put @xmath1128 and use notation @xmath264 for the distance between @xmath43 , @xmath200 in @xmath261 .",
    "then @xmath37 is a @xmath11-line in @xmath261 , and every standard @xmath10-circle @xmath1129 through @xmath38 , @xmath33 is an @xmath10-line in @xmath261 .",
    "moreover , every @xmath10-line @xmath545 through @xmath38 intersects @xmath70 because @xmath1126 , furthermore @xmath938 for @xmath1130 and thus @xmath1129 is a standard @xmath10-line .",
    "that is , for every @xmath345 every @xmath10-circle @xmath490 through @xmath43 , @xmath1131 is a standard one in @xmath72 .",
    "let @xmath42 be the midpoint between @xmath43 , @xmath200 , @xmath1132 . by lemma  [ lem : filling_sphere_rcirles ] the sphere @xmath1133 centered at @xmath230 of radius @xmath498 is covered by @xmath10-circles through @xmath43 , @xmath200 .",
    "thus it suffices to show that for every @xmath31 there is @xmath345 such that @xmath1134 , where @xmath42 is the midpoint between @xmath43 , @xmath955 , @xmath1135 .",
    "let @xmath536 be the projection of @xmath34 to @xmath37 in @xmath261 , @xmath1136 , @xmath1137 .",
    "let @xmath1138 be the radius of the sphere in @xmath261 centered at @xmath38 that contains @xmath70 .",
    "for @xmath345 the condition @xmath955 is equivalent to latexmath:[\\[\\label{eq : prod }     assuming that @xmath136 lies on @xmath37 between @xmath38 and @xmath43 in @xmath261 , we also have @xmath1140 , @xmath1141 . by lemma  [ lem : wharm_basics ] , @xmath1142 , which gives another equation for @xmath1143 , @xmath1144 , @xmath1145 ) have a positive solution @xmath1146 , which allows us to find @xmath43 , @xmath1131 and the midpoint @xmath42 between @xmath43 , @xmath200 , that is , @xmath1147 with @xmath1148 .",
    "indeed , we have @xmath1149 , @xmath1150 . using @xmath1142 and proposition  [ pro : explicit_distance ] ,",
    "we obtain @xmath1151 this shows that @xmath1152 .",
    "[ thm : moebius_join_canonical ] let @xmath1086 be a @xmath11-circle in @xmath2 with a fixed point free mbius involution @xmath57 , @xmath65 a canonical subspace orthogonal to @xmath37 at @xmath762 .",
    "assume that @xmath70 is mbius equivalent to @xmath73 , @xmath1 , taken with the canonical mbius structure . then the join @xmath72 is mbius equivalent to @xmath1153 .",
    "[ lem : involution_equivariant_moebius_circles ] let @xmath37 , @xmath1154 be mbius spaces which are equivalent to @xmath1155 , @xmath1 , taken with the canonical mbius structure .",
    "given mbius involutions @xmath57 , @xmath1156 without fixed points , there is a mbius equivalence @xmath1157 that is equivariant with respect to @xmath762 , @xmath1158 , @xmath1159    if we identify @xmath37 with @xmath51 , then there is @xmath1160 such that the central symmetry @xmath104 induces the involution @xmath762 on @xmath37 , @xmath1161 .",
    "similarly , @xmath1162 for @xmath1163 .",
    "thus any isometry @xmath1164 with @xmath1165 induces a required mbius equivalence @xmath1166 .",
    "[ lem : central_symmetry_decomposition ] let @xmath1167 be a complex hyperbolic plane and @xmath61 .",
    "let @xmath1168 be the orthogonal complement to @xmath119 at @xmath64 .",
    "denote by @xmath1169 , @xmath1170 .",
    "then @xmath1171 , where @xmath1172 is the mbius involution without fixed points induced by the central symmetry @xmath104 at @xmath64 , @xmath1173 .",
    "we use the fact that every mbius @xmath1174 is induced by an isometry @xmath1175 . recall that @xmath1154 is the fixed point set of the reflection @xmath1176 .",
    "then @xmath119 is the fixed point set for the isometry @xmath1177 with @xmath1178 , and @xmath1179 acts on @xmath1180 as @xmath108 does , @xmath1181 .",
    "hence @xmath1171 .",
    "recall that the boundary at infinity @xmath49 taken with the canonical mbius structure satisfies axioms ( e ) , ( o ) ( see proposition  [ pro : axioms_model ] ) .",
    "thus all the notions involved in the definition of the mbius join @xmath1183 are well defined for @xmath51 .    the central symmetry @xmath104 induces the mbius involution @xmath1184 without fixed points , for which @xmath1154 , @xmath1185 are invariant , @xmath1186 , @xmath1187 .",
    "furthermore , @xmath1188 is a cos to @xmath1154 at @xmath483 and @xmath1189 . then by proposition  [ pro : dim_moeb_join ] , @xmath1190 .    by lemma  [ lem : involution_equivariant_moebius_circles ]",
    ", there is a mbius equivalence @xmath1191 , which is equivariant with respect to @xmath483 and @xmath762 , @xmath1192 .",
    "note that @xmath52 acts on @xmath70 as a mbius involution without fixed points . by the assumption",
    ", @xmath65 is mbius equivalent to @xmath1188 . by lemma  [ lem : involution_equivariant_moebius_circles ] again , there is a mbius equivalence @xmath1193 which is equivariant with respect to @xmath483 and @xmath1194 , @xmath1195 .",
    "we define @xmath1196 by @xmath1197 , @xmath1198 , and @xmath1199 by @xmath1200 , @xmath1201 .",
    "then @xmath256 is equivariant with respect to @xmath483 and @xmath1202 , @xmath1203 .",
    "furthermore , @xmath256 maps the canonical fibration of @xmath1185 by @xmath11-circles to that of @xmath70 .",
    "the intersection @xmath1204 of every standard @xmath10-circle @xmath1205 with @xmath1206 is invariant under @xmath1202 .",
    "then @xmath1202 uniquely extends to a mbius @xmath1207 , for which we use the same notation @xmath1202 . by lemma  [ lem : moebius_join_intersection ] ,",
    "different standard @xmath10-circles in @xmath72 may have common points only in @xmath1206 .",
    "thus we have a well defined involution @xmath1208 without fixed points , which is mbius along @xmath37 , @xmath70 and every standard @xmath10-circle in @xmath72 .    for every standard @xmath10-circle @xmath1209",
    ", we have the map @xmath1210 , which is equivariant with respect to @xmath483 and @xmath1202 .",
    "the map @xmath256 uniquely extends to a mbius @xmath1211 . by lemma  [ lem : moebius_join_intersection ] different standard @xmath10-circles in @xmath1183",
    ", @xmath72 may have common points only in @xmath1212 , @xmath1206 respectively , thus this gives a well defined bijection @xmath1213 which is mbius along @xmath1154 , @xmath1185 and any standard @xmath10-circle in @xmath51 .",
    "moreover , @xmath256 is equivariant with respect to @xmath483 , @xmath1202 .",
    "it suffices to check that @xmath1221 is an isometry , @xmath1222 for each @xmath34 , @xmath1223 , @xmath1224 , @xmath1225 . for brevity ,",
    "we use notation @xmath1226 regarding @xmath256 as a map between respective metric spaces .    during the proof we will also consider the maps @xmath1227 , where @xmath1224 .",
    "we view @xmath1228 as a map between metric spaces , where on @xmath1229 the metric is defined as the metric inversion ( [ eq : metric_inversion ] ) of @xmath509 and on @xmath1230 the metric inversion of @xmath1231 .",
    "recall that @xmath51 is a compact ptolemy space with axioms ( e ) , ( o ) .",
    "thus @xmath1185 lies in a sphere between @xmath38 , @xmath33 , that is , in a metric sphere in @xmath1218 centered at @xmath38 , while @xmath70 lies in a metric sphere in @xmath1219 centered at @xmath1117 , see sect .",
    "[ sect : fiber_filling_map ] .",
    "the respective radii are called the _ radii _ of @xmath1185 , @xmath70 in @xmath1218 , @xmath1219 respectively .",
    "there is @xmath1233 such that @xmath1235 for @xmath1236 .",
    "any standard @xmath10-circle @xmath195 through @xmath34 , @xmath293 lies in a metric sphere in @xmath1218 centered at @xmath38 .",
    "then @xmath1237 lies in a metric sphere in @xmath1219 centered at @xmath1238 .",
    "since @xmath1239 preserves distances , the metric spheres in @xmath1218 , @xmath1219 centered at @xmath38 , @xmath1117 containing @xmath36 , @xmath642 respectively have equal radii .",
    "hence the radius of @xmath1185 in @xmath1218 is the same as the radius of @xmath70 in @xmath1219 , @xmath1240 for every @xmath1241 , @xmath560 .",
    "any standard @xmath10-circle @xmath195 through @xmath38 , @xmath33 hits @xmath1185 at @xmath43 , @xmath1242 and it is an @xmath10-line in @xmath1218 .",
    "thus @xmath1243 is a homothety with respect to the metrics of @xmath1218 , @xmath1219 . since @xmath1244 for @xmath1245 , we observe that @xmath1246 is an isometry , that is , @xmath1234 preserves distances along any standard @xmath10-line through @xmath38 .",
    "[ lem : metric_inversion_line ] assume for @xmath1233 the map @xmath1228 is isometric along @xmath10-lines ( not necessarily standard ) through some @xmath1247 and preserves the distance between some @xmath43 , @xmath200 on those lines , @xmath1248 , where @xmath1245 , @xmath1249 , @xmath1224 . then @xmath1250 .",
    "we can assume that @xmath1251 since otherwise there is nothing to prove .",
    "let @xmath1252 be the @xmath10-line through @xmath293 , @xmath43 .",
    "then @xmath1237 is an @xmath10-line in @xmath1253 through @xmath1254 .",
    "recall that , @xmath1154 is a @xmath11-line in @xmath1229 .",
    "then by proposition  [ pro : explicit_distance ] the distance @xmath1255 is uniquely determined by @xmath1256 , @xmath1257 for every @xmath1258 , @xmath1259 . since @xmath1228 is isometric along @xmath36 and along @xmath1260 , we have @xmath1261 , @xmath1262 .",
    "hence @xmath1263 , and similarly @xmath1264 .",
    "since @xmath1265 and a similar formula holds for @xmath1266 , we obtain @xmath1250 .",
    "we let @xmath1267 .",
    "then @xmath36 is an @xmath10-line in @xmath1229 , hence by lemma  [ lem : standard_isometry_rlines ] , @xmath1228 is isometric along @xmath36 . by lemma  [ lem : metric_inversion_line ]",
    ", @xmath1234 is isometric along @xmath36 .      given @xmath43 , @xmath1269 , there are standard @xmath10-circles @xmath36 , @xmath1270 through @xmath34 with @xmath1258 , @xmath1271 . by the assumption ,",
    "@xmath1250 for @xmath1245 , @xmath1249 . by corollary  [ cor : standard_isometry_rcircles ] ,",
    "@xmath1272 and @xmath1273 . applying the metric inversions with respect to @xmath34 , @xmath1107 we obtain @xmath1248 .      for @xmath1274 we put @xmath1275 , @xmath1276 .",
    "there are the standard @xmath10-circles @xmath1277 such that @xmath1278 , @xmath1279 , in particular , @xmath36 , @xmath94 are @xmath10-lines in @xmath1218 .",
    "hence @xmath1280 , where @xmath291 is the radius of @xmath1185 in @xmath1218 .",
    "for @xmath1281 we have @xmath1282 , @xmath1283 for the @xmath10-circles @xmath1237 , @xmath1284 .",
    "hence @xmath1285 . since @xmath1286 is mbius , @xmath1287 , and we conclude @xmath1288 on the other hand , @xmath1289 , @xmath1290 because @xmath256 is equivariant with respect to @xmath483 , @xmath1202 .",
    "thus @xmath1291 , @xmath1292 .",
    "furthermore , @xmath1293 , @xmath1294 by lemma  [ lem : central_symmetry_decomposition ] .",
    "recall that @xmath1154 ( @xmath37 ) is the fixed point set of @xmath1295 ( @xmath53 ) , thus @xmath1295 ( @xmath53 ) is an isometry of @xmath1218 ( @xmath1219 ) and hence @xmath1296 , @xmath1297 .",
    "therefore , @xmath1250 for any @xmath43 , @xmath1298 , i.e. @xmath1299 is an isometry .",
    "let @xmath1300 be a cos to a @xmath11-circle @xmath1301 .",
    "for every @xmath1302 , @xmath1303 there is a uniquely determined @xmath10-circle @xmath195 through @xmath34 , @xmath43 that meets @xmath1304 at another point @xmath293 .",
    "we denote by @xmath1305 the set covered by @xmath10-circles in @xmath51 through @xmath34 , @xmath293 which meet @xmath1091 .",
    "note that @xmath1306 , @xmath1307 , for every such an @xmath10-circle @xmath36 .",
    "topologically , @xmath1308 is a _ suspension _ over @xmath1091 .",
    "the points @xmath34 , @xmath293 are called the _",
    "poles _ of @xmath1308 .",
    "the set @xmath1309 is foliated by @xmath10-circles through @xmath352 . slightly abusing terminology , this foliation",
    "is called the @xmath10-_foliation _ of @xmath1308 . in the metric of @xmath1229 ,",
    "the circles of the @xmath10-foliation are @xmath10-lines through @xmath293 , and @xmath1304 is a @xmath11-line .",
    "let @xmath1310 be a pure homothety ( see sect .",
    "[ subsect : pure_homothety ] ) with coefficient @xmath193 centered at @xmath293 , @xmath1311 .",
    "the homothety @xmath884 is induced by an isometry @xmath1312 , which is a transvection along the geodesic @xmath1313 , @xmath1314 .",
    "then @xmath884 preserves every @xmath10-line @xmath1252 through @xmath293 , acting on @xmath36 as the homothety with coefficient @xmath712 , which preserves orientations of @xmath36 .",
    "the image @xmath1315 is the boundary at infinity of @xmath1316 , where @xmath1317 is the subspace with @xmath1318 , and it is also a cos to @xmath1304 . in that way , the cos s @xmath1319 form a foliation of @xmath1309 , which is called the _ cos - foliation _ of @xmath1308 . in the case",
    "@xmath1091 is a @xmath11-circle , we say about @xmath11-foliation of @xmath1308 .    [ lem : cfoliation_isometric ] assume @xmath1228 is isometric along every @xmath210-line @xmath36 of the @xmath10-foliation of @xmath1308 and along @xmath1091 . then @xmath1228 is isometric along every cos @xmath1319 of the @xmath11-foliation .",
    "note that @xmath1320 is equivariant with respect to @xmath884 , @xmath1321 , where @xmath1322 is the pure homothety ( see sect .  [",
    "subsect : pure_homothety ] ) with coefficient @xmath712 with the fixed point @xmath1323 .",
    "it follows that @xmath1324 is an isometry with respect to the metrics of @xmath1229 , @xmath1230 because @xmath1325 .",
    "[ lem : suspension_isometric ] let cos @xmath1091 to @xmath1304 be a @xmath11-circle . under the assumption of lemma  [ lem : cfoliation_isometric ] ,",
    "the map @xmath1228 is isometric along the suspension @xmath1308 .    by the assumption , @xmath1228 is isometric along every @xmath10-line in @xmath1308 through @xmath293 . thus taking @xmath43 ,",
    "@xmath1326 we can assume that neither @xmath43 nor @xmath200 coincides with @xmath34 or @xmath293 .",
    "then there are uniquely determined an @xmath10-line @xmath1327 of the @xmath10-foliation through @xmath43 and a @xmath11-circle @xmath1328 of the @xmath11-foliation through @xmath200 .",
    "the intersection @xmath1329 consists of two points , say , @xmath136 , @xmath230 . taking the metric inversion with respect to @xmath230 we",
    "obtain @xmath1330 and similar expressions for @xmath1331 , @xmath1332 . in the space @xmath2 we have",
    "respectively @xmath1333 and similar expressions for @xmath1334 , @xmath1335 , where `` prime '' means the image under @xmath256 .    by the assumption and lemma  [ lem : cfoliation_isometric ] , @xmath1228 is isometric along @xmath36 and @xmath1319",
    ". hence @xmath1336 , @xmath1337 , and @xmath1338 , @xmath1339 .",
    "on the other hand , @xmath1340 by proposition  [ pro : explicit_distance ] , and we conclude that @xmath1341 . therefore @xmath1248 .",
    "every circle @xmath36 of the @xmath10-foliation of @xmath1345 is standard in @xmath51 , and @xmath36 intersects @xmath1154 at two points @xmath1346 , @xmath1347 .",
    "then by lemma  [ lem : standard_isometry_rlines ] applied to @xmath1348 , @xmath1349 is isometric along @xmath36",
    ". thus @xmath1350 is isometric along @xmath36 because @xmath39 . by lemma  [ lem : standard_isometry_g ]",
    ", @xmath1350 is isometric along @xmath1154 . using lemmas  [ lem : cfoliation_isometric ] and [ lem : suspension_isometric ]",
    ", we obtain that @xmath1350 is isometric along @xmath1345 , in particular , @xmath256 is mbius along @xmath1345 . note that @xmath1351 because @xmath1352 .",
    "thus for any @xmath43 , @xmath1353 the 4-tuple @xmath1354 lies in @xmath1345 .",
    "hence @xmath1355 , where `` prime '' means the image under @xmath256 .",
    "on the other hand , @xmath1356 , and @xmath1261 by corollary  [ cor : standard_isometry_rcircles ] because @xmath1357 lie on a standard @xmath10-circle . therefore @xmath1338 .",
    "we have @xmath1361 for all @xmath697 , and @xmath1362 .",
    "thus @xmath1363 is convex and a unique minimum point @xmath1364 of @xmath1363 is negative , @xmath1365 .",
    "since @xmath1366 , there is a unique positive root @xmath1367 of @xmath1363 .    [",
    "pro : rfoliation_isometric ] let @xmath1368 be a suspension over a @xmath11-circle @xmath1091 with the poles @xmath34 , @xmath1369 , and let @xmath1304 be the @xmath11-circle through @xmath34 , @xmath293 .",
    "assume @xmath1228 is isometric along @xmath1304 and along every @xmath11-circle @xmath1319 of the @xmath11-foliation of @xmath1308 , and the following assumptions hold    * @xmath1370 and @xmath1261 for every @xmath1371 , where @xmath1372 and @xmath1373 are projections to the respective @xmath11-lines , * for every @xmath1371 and every @xmath11-circle @xmath1319 of the @xmath11-foliation there is @xmath1374 such that @xmath1248 ,          given @xmath1381 , @xmath1382 , we assume without loss of generality that @xmath1383 and @xmath1384 .",
    "we put @xmath1385 , @xmath1386 , @xmath1387 , and assume furthermore that @xmath1388 .",
    "note that in the case @xmath1389 the last assumption follows from @xmath1390 because @xmath1391 .",
    "[ rem : nonflat ] since @xmath1228 is isometric along @xmath1397 , the triangle @xmath1398 has two sides @xmath1399 , @xmath1400 preserved by @xmath1228 . our aim is to show that the third distance @xmath1401 is also preserved by @xmath1228 . in the space @xmath1402 the distance @xmath1403 is uniquely determined by @xmath1404 , @xmath1405 , @xmath1406 by proposition  [ pro : explicit_distance ] .",
    "we can pass to @xmath1229 by a metric inversion .",
    "the change of metrics involves the distances @xmath1407 , @xmath1408 which are preserved by @xmath1228 , and the distance @xmath1409 . in that way",
    ", we obtain an equation of 4th degree for @xmath1401 to which we apply lemma  [ lem : positive_root ] .    for brevity , we use notation @xmath1410 for @xmath1411 . the metric inversion with respect to @xmath1346",
    "gives @xmath1412 thus @xmath1413 and we obtain @xmath1414 which we write as @xmath1415 where @xmath1416 , @xmath1417 , @xmath1418 , @xmath1419 .",
    "the coefficients @xmath1420 are positive and preserved by @xmath256 .",
    "we show that @xmath1360 . using ( [ eq : rline_isometric1 ] )",
    ", we have @xmath1421 because @xmath1422 by the assumption . hence @xmath1423 by lemma  [ lem : positive_root ] , the equation ( [ eq : rline_isometric2 ] ) has a unique positive solution @xmath1424 .",
    "thus @xmath1425 .",
    "since the same equation with the same coefficients @xmath1420 holds in the space @xmath1426 for @xmath1427 , we obtain @xmath1428 , that is , @xmath1228 preserves the distance @xmath1429 .",
    "hence in the case @xmath1389 we have @xmath1430 by assumption  ( i ) , the points @xmath362 , @xmath479 , @xmath1107 lie on an @xmath10-circle @xmath1431 , and by the above , the ptolemy equality holds for @xmath1432",
    ". then @xmath1433 by proposition  [ pro : property_u ] .",
    "this shows that @xmath1228 is isometric on the ray @xmath1434 , and similarly , @xmath1228 is isometric on the opposite ray @xmath1435 .",
    "assuming @xmath1436 with @xmath1384 we observe that the equality @xmath1437 implies @xmath1438 because @xmath1439 , @xmath1440 and @xmath1441 .",
    "then by lemma  [ lem : concatenation ] , the concatenation of the rays @xmath1442 is an @xmath10-line in @xmath1230 .",
    "thus @xmath1228 is isometric on @xmath36 .",
    "[ lem : iso_commutes_projections ] for every @xmath1233 the map @xmath256 commutes with the projections @xmath1443 , @xmath1444 ( in @xmath1230 ) , @xmath1224 , @xmath1445 for every @xmath1446 .",
    "moreover , @xmath1447 , where @xmath1448 , @xmath1449 , @xmath1450 .",
    "we can assume that @xmath1451 .",
    "there is a standard @xmath10-circle @xmath195 through @xmath230 .",
    "we let @xmath1452 , @xmath1453 . then @xmath1454 and @xmath1455 for @xmath1237 , @xmath1456 . by corollary  [ cor : standard_isometry_rcircles ]",
    ", @xmath1228 is isometric along @xmath36 , thus we have @xmath1457 , @xmath1336 .",
    "therefore , @xmath1458 for @xmath1459 , and using proposition  [ pro : explicit_distance ] we obtain @xmath1460 .",
    "thus @xmath1461 .",
    "recall that @xmath1188 is a cos to @xmath1154 at @xmath483 , and @xmath1185 carries the canonical fibration @xmath1462 by @xmath11-circles , where the @xmath11-circle @xmath1463 of the fibration through @xmath1241 is determined by @xmath1464 .    for distinct @xmath34 , @xmath1465 the sphere @xmath1466 formed by all @xmath10-circles in @xmath51 through @xmath34 ,",
    "@xmath293 is foliated ( except @xmath352 ) by cos s to @xmath1154 .",
    "one can visualize this picture by taking the geodesic @xmath1467 and regarding the orthogonal projection @xmath1468 .",
    "then @xmath1469 , while the fibers @xmath1470 , @xmath1471 , are cos s to @xmath1154 , which foliate @xmath1472 . in the case",
    "@xmath1236 , i.e. , the geodesic @xmath1473 passes through @xmath64 , the @xmath10-circles through @xmath34 , @xmath293 are standard , and the sphere @xmath1474 is called _ standard_.",
    "every standard sphere is a suspension over @xmath1185 .",
    "if @xmath1474 is not standard , then for every @xmath1475 the fiber @xmath1476 is the intersection @xmath1477 for the uniquely determined standard sphere @xmath1478 , @xmath1479 : one takes the geodesic @xmath1480 through @xmath64 , @xmath112 , then @xmath1481 , and @xmath1482 are the ends at infinity of @xmath1483 .",
    "every cos @xmath1476 to @xmath1154 , @xmath1484 , carries the canonical fibration @xmath1485 by @xmath11-circles , where the @xmath11-circle @xmath1486 through @xmath1487 is determined by @xmath1464 .",
    "note that the @xmath11-circles @xmath1154 , @xmath1091 are mutually orthogonal , @xmath1488 , and @xmath1369 . the suspension @xmath1489 is a 2-dimensional sphere in @xmath1474 .",
    "[ lem : unique_representative_cfiber ] given distinct @xmath1490 with @xmath1491 and a @xmath11-circle @xmath1492 , there is a uniquely determined suspension @xmath1493 , @xmath1494 , over a @xmath11-circle @xmath1495 such that every fiber @xmath1496 of the @xmath11-foliation of @xmath1497 is represented as @xmath1498 for some @xmath1479 .",
    "let @xmath1499 be the geodesic with end points at infinity @xmath352 . by the assumption , @xmath1500 .",
    "we take @xmath1484 , consider the geodesic @xmath1480 through @xmath64 , @xmath112 , put @xmath1501 , and let @xmath1502 be the mbius suspension over @xmath1091 with poles @xmath450 .",
    "the suspension @xmath1503 intersects the cos @xmath1185 over @xmath1091 .",
    "we put @xmath1504 , the fiber of the @xmath11-foliation of @xmath1308 over @xmath112 .          every transvection along a geodesic @xmath111 induces a mbius automorphism of @xmath51 , which is a pure homothety of @xmath1229 for any end @xmath1510 . for brevity , we speak about the action of transvections on @xmath51 .    the fiber @xmath1511 of the @xmath11-foliation of @xmath1497 over @xmath635 is obtained from @xmath1512 by the transvection along @xmath1473 , which moves @xmath112 into @xmath635 , and @xmath1512 is obtained from @xmath1091 by the transvection along @xmath1483 , which moves @xmath64 into @xmath112 .",
    "thus @xmath1496 is obtained from @xmath1091 by the composition of these transvections .",
    "on the other hand , by proposition  [ pro : holonomy_normal_bundle ] , the holonomy of the normal bundle @xmath121 along any loop in @xmath119 preserves any complex hyperbolic plane in @xmath121 .",
    "it follows that @xmath1496 is obtained from @xmath1091 by the transvection along @xmath1513 that moves @xmath64 into @xmath635 .",
    "therefore , @xmath1498 .",
    "[ lem : nonstandard_suspension_isometric ] for every distinct @xmath34 , @xmath1465 the map @xmath1234 is isometric along any suspension @xmath1493 , @xmath1494 , over a @xmath11-circle @xmath1512 that is orthogonal to @xmath1154 .",
    "we first note that for every @xmath1233 , the map @xmath1234 is isometric along any _ standard _",
    "suspension @xmath1305 , where @xmath1463 is a @xmath11-circle of the canonical fibration and @xmath1516 .",
    "indeed , the @xmath10-foliation of @xmath1308 consists of standard @xmath10-circles , and by lemma  [ lem : standard_isometry_rlines ] , @xmath1228 is isometric along every of them . by lemma  [ lem : standard_isometry_ccircle ] , @xmath1228 is isometric on @xmath1091 . thus by lemma  [ lem : suspension_isometric ] , @xmath1228 is isometric on @xmath1308 .",
    "then by lemma  [ lem : metric_inversion_line ] , @xmath1234 is isometric on @xmath1308 .",
    "now , we show that @xmath1234 is isometric along every suspension @xmath1493 , @xmath1233 , where @xmath1517 .",
    "we check that the assumptions of proposition  [ pro : rfoliation_isometric ] are satisfied . in this case ,",
    "@xmath1518 , and @xmath1228 is isometric along @xmath1154 because @xmath1234 is assumed to be isometric along @xmath1154 and @xmath1233 . by the first part of the argument ,",
    "@xmath1228 is isometric on every @xmath11-circle of the @xmath11-foliation of any standard suspension @xmath1508 , @xmath1479 .",
    "thus by lemma  [ lem : unique_representative_cfiber ] , @xmath1228 is isometric on every @xmath11-circle of the @xmath11-foliation of @xmath1497 .",
    "property  ( i ) follows from lemma  [ lem : iso_commutes_projections ] .    to check property  ( ii ) of proposition  [ pro : rfoliation_isometric ] , we take @xmath1519 and a @xmath11-circle @xmath1520 of the @xmath11-foliation of @xmath1497 . there is a @xmath11-circle @xmath1521 of the @xmath11-foliation with @xmath1522 . by lemma  [ lem : unique_representative_cfiber ] , @xmath1523 for some @xmath1524 , and there is an @xmath10-circle @xmath1525 of the @xmath10-foliation with @xmath1526 .",
    "the suspension @xmath1527 is standard , and the intersection @xmath1528 consists of two points .",
    "we take one of them , @xmath1529 .",
    "again , @xmath1530 for some @xmath1479 , and there is a ( standard ) @xmath10-circle @xmath1531 of the @xmath10-foliation with @xmath1532 .",
    "the intersection @xmath1533 consists of two points , and we take one of them , @xmath1534 . note that @xmath36 , @xmath642 are standard @xmath10-circles with @xmath1535 .",
    "thus the suspension @xmath1536 over @xmath1154 with poles @xmath780 , @xmath1537 contains @xmath43 , @xmath200 . by lemma  [ lem : sphere_isometric_omega ]",
    ", @xmath1228 is isometric on @xmath1536 , hence @xmath1248 .",
    "that is , the assumptions of proposition  [ pro : rfoliation_isometric ] are satisfied . by that proposition @xmath1228",
    "is isometric along every @xmath10-circle of the @xmath10-foliation of @xmath1497 .",
    "applying lemma  [ lem : suspension_isometric ] , we see that @xmath1228 is isometric along @xmath1497 .",
    "then by lemma  [ lem : metric_inversion_line ] , @xmath1234 is isometric along @xmath1497 .",
    "there are standard suspensions @xmath1542 , @xmath1543 , @xmath1544 , over @xmath1091 with @xmath1545 , @xmath1546 .",
    "we can assume that @xmath1547 , @xmath1548 are distinct since otherwise we can take @xmath1549 as the required suspension .",
    "then there is a unique geodesic @xmath205 through @xmath673 , @xmath1550 .",
    "let @xmath34 , @xmath1465 be the ends at infinity of @xmath94 .",
    "we can assume that @xmath1491 , since otherwise again @xmath1549 .",
    "then by lemma  [ lem : unique_representative_cfiber ] , there is a uniquely determined suspension @xmath1497 such that every fiber @xmath1496 of the @xmath11-foliation of @xmath1497 is represented as @xmath1498 for some @xmath1479 .",
    "then @xmath1551 , @xmath1552 , in particular , @xmath1541 .",
    "[ rem : case3d ] proposition  [ pro : join_isometric ] implies theorem  [ thm : moebius_join_canonical ] and theorem  [ thm : complex_hyperbolic ] in the case @xmath77 because @xmath1554 by proposition  [ pro : dim_moeb_join ] in that case .",
    "moreover , it implies theorem  [ thm : moebius_join_canonical ] in the case @xmath37 , @xmath70 are mutually orthogonal @xmath11-circles in @xmath2 .",
    "let @xmath1555 , @xmath49 .",
    "we fix @xmath1556 and consider a complex reflection @xmath1557 with respect to a complex hyperbolic plane @xmath59 through @xmath38 .",
    "it acts on @xmath51 as a reflection with respect to the @xmath11-circle @xmath201 .",
    "the tangent space @xmath1558 is a 2-dimension complex vector space with a hermitian form generated by the riemannian metric , and @xmath1559 is a unitary involution whose fixed point set is the complex line @xmath1560 .",
    "we formalize this situation as follows .",
    "let @xmath1561 be the 2-dimensional complex vector space with the standard hermitian form .",
    "a unitary involution @xmath1562 is said to be _ reflection _ if @xmath1563 .",
    "note that @xmath1564 .",
    "thus any product @xmath1565 of unitary involutive reflections lies in @xmath1566 .",
    "we need the following simple    [ lem : transitive_unitary_reflections ] let @xmath1567 be the set of unitary involutive reflections @xmath1568",
    ". then the subgroup @xmath1569 generated by products @xmath1565 with @xmath1570 is transitive on the unit sphere @xmath1571 , and for @xmath1572 there is a dense subset @xmath1573 such that @xmath1574 has a finite order for every @xmath1575 .",
    "we identify @xmath1092 with the set of complex lines in @xmath1576 and fix @xmath1572 .",
    "then we have a decomposition @xmath1577 such that @xmath1578 is the fixed point set of @xmath1363 , and @xmath1363 acts on @xmath1576 as @xmath1579 .",
    "note that @xmath1363 preserves any real 2-subspace @xmath1580 spanned by @xmath1581 , @xmath1582 with @xmath1583 , @xmath1584 , acting on @xmath1585 as the reflection with respect to @xmath1586 .",
    "each pair of opposite points in @xmath1587 is represented as @xmath1588 for some @xmath1589 , @xmath1574 acts on @xmath1585 by a rotation , and the subgroup in @xmath1154 preserving @xmath1585 acts transitively on @xmath1587 . if @xmath1590 is identical on @xmath1585 , then it is identical , @xmath1591 .",
    "thus there is a dense subset @xmath1573 such that @xmath1592 has a finite order for every @xmath1575 .    given @xmath34 , @xmath1593 , @xmath1594 , @xmath1595 , we can find @xmath1596 , @xmath1597 such that @xmath1598 , @xmath1599 .",
    "let @xmath1580 be the real 2-subspace @xmath1580 spanned by @xmath1600 , @xmath1601 .",
    "then there is @xmath1602 with @xmath1603 .",
    "hence @xmath1604 .",
    "we fix a @xmath11-circle @xmath29 through @xmath33 and a mbius involution @xmath57 without fixed points .",
    "we show that the group @xmath1154 of isometries @xmath1605 preserving @xmath1606 acts on @xmath929 transitively .",
    "there is @xmath345 , @xmath1607 , such that @xmath307 , where @xmath955 . by lemma  [ lem : filling_fiber ]",
    "the orthogonal complement @xmath1608 can be represented as @xmath1609 , where @xmath1610 is the sphere in @xmath2 between @xmath941 through @xmath450 and @xmath1611 is the sphere in @xmath2 between @xmath450 through @xmath941 . in the space @xmath261 the sphere @xmath1611 consists of @xmath10-lines through @xmath38 , and @xmath1612 for some @xmath291 , where @xmath1613 . for simplicity of notation",
    "we assume that @xmath1614 .    by lemma  [ lem : orthogonal_foliated_ccircles ]",
    "there is a canonical fibration @xmath1092 of @xmath58 by @xmath11-circles each of which is invariant under the reflection @xmath849 with respect to @xmath37 , in particular , @xmath1615 is odd .",
    "since @xmath1616 is homeomorphism , the unit sphere @xmath1617 centered at @xmath1618 has an odd dimension @xmath1619 .",
    "it follows that @xmath1620 is even .",
    "every @xmath1090 and @xmath37 are mutually orthogonal , @xmath1621 .",
    "proposition  [ pro : join_isometric ] implies that the mbius join @xmath1622 is mbius equivalent to the standard model space @xmath1623 . if @xmath1624 then @xmath1625 , @xmath1626 is mbius equivalent to @xmath1623 , and there is nothing to prove .",
    "thus we assume that @xmath1627 .",
    "the reflection @xmath1628 with respect to @xmath1091 preserves @xmath37 and @xmath1629 , furthermore , by lemma  [ lem : fiber_involution ] , @xmath1630 preserves @xmath58 and its fibration @xmath1092 for every @xmath1090 .",
    "thus the composition @xmath1631 preserves @xmath58 and its fibration @xmath1092 , and it acts on @xmath37 identically for each @xmath11-circles @xmath1091 , @xmath1632 . in particular",
    ", @xmath1633 is an isometry .",
    "we fix a @xmath11-circle @xmath1090 . for every @xmath1632 that is orthogonal to @xmath1091 , @xmath1634 , the mbius join",
    "@xmath1635 is mbius equivalent to @xmath51 by proposition  [ pro : join_isometric ] , hence @xmath1636 satisfies axioms ( e ) and ( o ) .",
    "we show that @xmath1637 .",
    "note that @xmath1636 is invariant under the reflection @xmath53 , @xmath1638 , because @xmath1091 , @xmath1639 are .",
    "thus @xmath1636 carries a fibration @xmath1640 by @xmath11-circles invariant under @xmath53 , in particular , every @xmath11-circle @xmath1641 is orthogonal to @xmath37 , @xmath1642 , and @xmath1643 .    to see that @xmath1644 preserves @xmath1636",
    ", we note that there is a ( unique ) @xmath11-circle @xmath1645 that is orthogonal to @xmath1304 at @xmath1646 , actually , @xmath1647 in @xmath1636 .",
    "then @xmath1648 , and since @xmath1649 acts on @xmath1304 identically , we see that @xmath1644 preserves @xmath1636 , @xmath1650 , because @xmath1636 can be represented as the mbius join @xmath1651 . using conjugation via a mbius isomorphism @xmath1652 and",
    "the fact that @xmath1623 , we can consider @xmath1649 as a unitary involutive reflection of @xmath1561 .",
    "applying lemma  [ lem : transitive_unitary_reflections ] , we find a dense subset @xmath1653 such that the composition @xmath1654 , when restricted to @xmath1636 , has a finite order , @xmath1655 , for every @xmath11-circle @xmath1656 and some @xmath1657 depending on @xmath1304 .",
    "note that @xmath1658 being a composition of two mbius involutions @xmath1659 , @xmath1660 without fixed points has an infinite order or is identical . in the first case",
    "there are two fixed points @xmath34 , @xmath1093 for @xmath1661 , and @xmath1363 acts on @xmath271 as a nontrivial homothety .",
    "this contradicts the fact that @xmath1655 .",
    "therefore , @xmath1662 and thus @xmath1663 . consequently , @xmath1664 . by continuity",
    ", this holds for every @xmath1641 , hence @xmath1637 .    for every @xmath1665 the product @xmath1666",
    "is identical on @xmath37 , hence @xmath1667 is an isometry . by lemma  [ lem : transitive_unitary_reflections ]",
    "isometries of this type act on @xmath1636 transitively .",
    "varying @xmath1090 , @xmath1668 , we see that the mbius joins @xmath1669 cover @xmath58 .",
    "thus the group @xmath1154 acts on @xmath58 transitively .",
    "it follows that the group of isometries of the base @xmath725 preserving @xmath1670 acts on the unit sphere @xmath1671 centered at @xmath1670 transitively . using the standard argument with lvner ellipsoid , we obtain that the unit sphere @xmath1672 is an ellipsoid and thus the metric of @xmath725 is euclidean .",
    "given distinct @xmath34 , @xmath1673 , let @xmath1301 be the @xmath11-circle through @xmath34 , @xmath293 .",
    "the sphere @xmath1466 formed by all @xmath10-circles in @xmath51 through @xmath34 , @xmath293 carries @xmath10- and cos - foliations , see sect .",
    "[ subsect : rcfoliations ] .",
    "note that every fiber @xmath1091 of the cos - foliation of @xmath1474 satisfies axioms ( e ) and ( o ) because @xmath1091 is the boundary at infinity of an orthogonal complement in @xmath1674 to the complex hyperbolic plane @xmath59 with @xmath1675 .",
    "[ pro : sphere_isometric_cos ] given distinct @xmath34 , @xmath1673 assume @xmath1228 is isometric along every @xmath10-circle of the @xmath10-foliation of @xmath1676 and every fiber of the cos - foliation of @xmath289 .",
    "then @xmath1228 is isometric along @xmath289 .",
    "every fiber @xmath1091 of the cos - foliation of @xmath289 lies in a sphere between @xmath34 , @xmath293 , that is , there is @xmath1678 such that @xmath1679 for every @xmath1680 . in the space @xmath1229",
    "every @xmath10-circle @xmath36 of the @xmath10-foliation of @xmath289 is an @xmath10-line through @xmath293 .",
    "since @xmath1228 is isometric along @xmath36 , we can assume that neither @xmath43 nor @xmath200 coincides with @xmath34 or @xmath293 .",
    "then there are uniquely determined an @xmath10-line @xmath1681 of the @xmath10-foliation through @xmath43 and a fiber @xmath1682 of the cos - foliation through @xmath200 , and we also assume that @xmath1683 , @xmath1684 , since otherwise there is nothing to prove .",
    "the intersection @xmath1685 consists of two points , say , @xmath136 , @xmath230 such that the pair @xmath1686 separate the pair @xmath352 on @xmath36 .",
    "the points @xmath1687 subdivide @xmath36 into four arcs , and we assume without loss of generality that @xmath43 lies on the arc @xmath1688 .",
    "since @xmath1091 satisfies axioms ( e ) and ( o ) , the @xmath11-circle @xmath1301 through @xmath230 , @xmath200 lies in @xmath1091 , and we assume that @xmath1689 because otherwise lemma  [ lem : suspension_isometric ] applies . since @xmath1304 is a @xmath11-line in @xmath1690 , we have @xmath1691 , where `` bar '' means the image under @xmath1692 .",
    "it follows from lemma  [ lem : bisector ] that @xmath1091 together with @xmath1304 lies in the bisector in @xmath1690 between @xmath34 , @xmath293 .",
    "thus @xmath1693 , @xmath1694 for every @xmath1695 and therefore @xmath1696 .",
    "note that @xmath36 is an @xmath10-line also in @xmath1690 , thus @xmath1697 , @xmath1698 and @xmath1699 is the midpoint between @xmath672 , @xmath1700 .",
    "the metric on the base @xmath1701 is euclidean , thus the line @xmath1702 through @xmath674 , @xmath1550 is orthogonal to the line @xmath1703",
    ". therefore @xmath1704 .    in the space @xmath2",
    ", we have the sphere @xmath1705 with poles @xmath1107 , @xmath362 , the image @xmath1706 , the @xmath10-circle @xmath1707 with @xmath1708 ( in this cyclic order ) and @xmath1709 with @xmath1710 . by our assumption on @xmath1228",
    "we have @xmath1711 for every @xmath1712 , and @xmath1713 is a @xmath11-circle through @xmath374 , @xmath452 .",
    "thus @xmath1639 lies in a sphere in @xmath2 between @xmath1107 , @xmath362 , hence @xmath1639 together with the @xmath11-line @xmath1714 lies in the bisector in @xmath1715 between @xmath1107 and @xmath362 .    by proposition",
    "[ pro : base_euclidean ] , the base @xmath1716 of the canonical foliation @xmath1717 is also euclidean .",
    "thus we obtain as above @xmath1718 .",
    "note that @xmath1719 is isometric along @xmath36 , hence @xmath1720 . since @xmath1228 is isometric along @xmath1091 , we see that @xmath1719 is also isometric along @xmath1091 applying the metric inversion with respect to @xmath230 , thus @xmath1721 .",
    "it follows that @xmath1722 .    using that @xmath1723 for every @xmath1680 and applying the metric inversion with respect to @xmath230",
    ", we obtain @xmath1724 , @xmath1725 .",
    "hence the map @xmath1719 preserves the distances of @xmath34 , @xmath293 to points of @xmath1304 , @xmath1726 , in particular , @xmath1727 .",
    "let @xmath1728 , @xmath1729 , @xmath1730 be the projections in @xmath1690 of @xmath1731 to the @xmath11-line @xmath1304 . since the map @xmath1719 preserves the distances of @xmath293 to points of @xmath1304 , we see using the distance formula that @xmath1732 , i.e. the projections @xmath1733 , @xmath1734 commute with @xmath256 at @xmath293 . similarly , @xmath1735 .",
    "on the other hand , the point @xmath1736 can be obtained from @xmath1737 by lifting isometry ( see sect .",
    "[ subsect : lifting_isometry ] ) of the oriented triangle @xmath1738 , @xmath1739 .",
    "analogously , in the space @xmath1715 the point @xmath1740 can be obtained from @xmath1741 by lifting isometry of the oriented triangle @xmath1742 , @xmath1743 .",
    "thus @xmath1744 .",
    "using lemma  [ lem : area_lift_triange ] we obtain @xmath1745 for the oriented triangles @xmath1746 , @xmath1747 .",
    "we assume that a fiber orientation of @xmath1748 is fixed and that the fiber orientation of @xmath1749 is induced by @xmath1719 .",
    "then @xmath1750 and we conclude that the projections @xmath1751 , @xmath1752 commute with @xmath256 at @xmath43 , @xmath1753 for @xmath1754 .",
    "hence @xmath1755 by proposition  [ pro : explicit_distance ] . applying the metric inversion with respect to @xmath34 and using that @xmath1756 , @xmath1757 , we finally obtain @xmath1248 .    [ [ proof - of - theoremsthmmoebius_join_canonical - and - thmcomplex_hyperbolic ] ] proof of theorems  [ thm : moebius_join_canonical ] and [ thm : complex_hyperbolic ] ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~      first , we note that for every @xmath1233 the map @xmath1228 is isometric along the standard sphere @xmath1759 , @xmath1236 .",
    "indeed , @xmath1760 is a suspension over @xmath1185 , and @xmath1228 is isometric along the fibers of the @xmath10-foliation of @xmath1761 because they are standard @xmath10-lines in @xmath1229 , and along @xmath1185 by lemma  [ lem : standard_isometry_ccircle ] .",
    "thus by lemma  [ lem : cfoliation_isometric ] , @xmath1228 is isometric along every fiber of the cos - foliation of @xmath1761 . by proposition",
    "[ pro : sphere_isometric_cos ] , @xmath1228 is isometric along @xmath1760 .",
    "it follows from lemma  [ lem : metric_inversion_line ] that @xmath1234 is isometric along @xmath1762 .",
    "given @xmath43 , @xmath199 we can assume that the points @xmath1547 , @xmath1548 are distinct and neither of them coincides with @xmath38 , since otherwise @xmath43 , @xmath200 lie in a standard sphere @xmath1762 for some @xmath1233 , hence @xmath1250 .",
    "then there is a unique geodesic @xmath205 through @xmath673 , @xmath1550 .",
    "let @xmath34 , @xmath1465 be the ends at infinity of @xmath94 , @xmath1491 by our assumption",
    ". then @xmath1763 .",
    "the map @xmath1228 is isometric along the fibers of the cos - foliation of the sphere @xmath1474 because every such a fiber is represented as the fiber @xmath1764 of the cos - foliation of a standard sphere @xmath1765 for some @xmath1479 .",
    "furthermore , @xmath1766 is a suspension over a fiber @xmath1767 of the cos - foliation of @xmath1474 , and every fiber @xmath36 of the @xmath10-foliation of @xmath1474 is a fiber of the @xmath10-foliation of @xmath1768 for a @xmath11-circle @xmath1512 of the canonical fibration of @xmath1767 .",
    "thus as in lemma  [ lem : nonstandard_suspension_isometric ] we see that @xmath1228 is isometric along @xmath36 . by proposition",
    "[ pro : sphere_isometric_cos ] , @xmath1228 is isometric along @xmath1474 . by lemma  [ lem : metric_inversion_line ]",
    "again , @xmath1234 is isometric along @xmath1474 .",
    "hence @xmath1250 .",
    "this completes the proof of theorem  [ thm : moebius_join_canonical ] .",
    "it follows from proposition  [ pro : base_euclidean ] that @xmath1769 is odd , @xmath1770 , @xmath1 . if @xmath81 , then @xmath1771 is a @xmath11-circle . in the case",
    "@xmath133 , theorem  [ thm : complex_hyperbolic ] is already proved , see remark  [ rem : case3d ] .",
    "thus we assume that @xmath134 and argue by induction over dimension .",
    "we take any mutually orthogonal @xmath11-circles @xmath37 , @xmath65 . by proposition",
    "[ pro : empty_3d ] their respective orthogonal complements @xmath58 , @xmath1034 have nonempty intersection @xmath1772 . by corollary  [ cor : axioms_orthogonal_complements ]",
    ", @xmath259 satisfies axioms ( e ) and ( o ) , hence @xmath1773 by the inductive assumption . by theorem",
    "[ thm : moebius_join_canonical ] the join @xmath1774 is mbius equivalent to @xmath71 . since @xmath70 , @xmath1775 , we see as in the proof of proposition  [ pro : base_euclidean ] that @xmath1776 , and therefore @xmath1777 is a cos to @xmath37 . applying theorem  [ thm : moebius_join_canonical ] once again to @xmath1778 , we obtain that @xmath1779 is mbius equivalent to @xmath73",
    ".                    sergei buyalo,11em= viktor schroeder , + st .",
    "petersburg dept . of steklov",
    "institut fr mathematik , universitt + math .",
    "institute ras , fontanka 27 , zrich , winterthurer strasse 190 , + 191023 st .",
    "petersburg , russia , ch-8057 zrich , switzerland + st .",
    "petersburg state university , + sbuyalo@pdmi.ras.ru +"
  ],
  "abstract_text": [
    "<S> we characterize the boundary at infinity of a complex hyperbolic space as a compact ptolemy space that satisfies four incidence axioms .    </S>",
    "<S> * keywords * complex hyperbolic spaces , ptolemy spaces , incidence axioms    * mathematics subject classification * 53c35 , 53c23 </S>"
  ]
}