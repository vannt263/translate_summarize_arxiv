{
  "article_text": [
    "the calculation of electrostatic interactions in computer - simulation studies of condensed - matter systems poses serious problems regarding accuracy and efficiency @xcite .",
    "these are mainly caused by the infinite range of coulomb interactions in conjunction with the finite size of the samples studied . to avoid system - size effects ,",
    "periodic boundary conditions are employed .",
    "the natural description of the electrostatics in this periodic space is obtained by summation of the charge interactions over periodically replicated simulation cells .",
    "this yields the well - known formula of ewald @xcite for the coulomb energy of charges in a lattice .",
    "ewald summation is widely used in computer simulations of charged systems and is generally believed to give the most accurate description of the electrostatics ( with respect to system - size dependence ) .",
    "the ewald formula splits the coulomb energy into two rapidly converging real- and fourier - space lattice sums , where their relative contributions can be controlled by a parameter @xmath0 .",
    "however , in numerical implementations one has to apply truncations of the two ( infinite ) lattice sums . in this work ,",
    "we develop a quantitative description of the errors arising from this truncation .",
    "we then discuss the choice of cutoff distances in real and fourier space with respect to numerical accuracy , resulting in restrictions regarding computational efficiency of ewald - sum implementations .",
    "in particular , we analyze the connection between the real - space screening parameter @xmath0 and the number of fourier - space vectors required for a given accuracy .",
    "we also derive an approximate upper limit for an efficient choice of the fourier - space cutoff .",
    "the ewald - summation formula for the coulomb energy @xmath2 of @xmath3 charges @xmath4 ( with net charge 0 ) at positions @xmath5 can be expressed as a sum over pair interactions and self terms , @xmath6~ , \\nonumber\\\\ \\label{eq : uew}\\end{aligned}\\ ] ] where @xmath7 , with the lattice vector @xmath8 chosen such that @xmath9 is a vector in the unit cell .",
    "this result holds for a background dielectric constant @xmath10 ( or vanishing dipole moment of the cell ) , as discussed in ref .",
    "the effective pair interaction has the following form , @xmath11 where @xmath12 is the volume of the box , erfc is the complementary error function , and @xmath13 .",
    "the two lattice sums extend over real and reciprocal ( fourier ) space lattice vectors @xmath8 and @xmath14 , respectively . in most practical applications ,",
    "the screening parameter @xmath0 is chosen such that only @xmath15 and a few hundred @xmath16 vectors need to be considered .",
    "the convergence parameter @xmath0 can be chosen arbitrarily ( @xmath17 ) , as @xmath18 the choice of @xmath0 gives different weights to the two sums .",
    "however , the requirement of numerical accuracy imposes some restrictions on the choice of @xmath0 .",
    "any truncation of the two lattice sums in eq .",
    "( [ eq : phi ] ) results in deviations from the identity eq .",
    "( [ eq : dudeta ] ) .",
    "this provides us with a measure for the accuracy of a given implementation characterized by a screening parameter @xmath0 and two cutoff distances @xmath19 and @xmath20 for the real- and fourier - space lattice sums ( @xmath21 , @xmath22 ) .",
    "the errors @xmath23 of the total energy and @xmath24 of the single - particle energies are weighted sums of numerical errors @xmath25 in the electrostatic interaction @xmath26 , @xmath27 in most practical cases , we expect a considerably smaller error than indicated by the upper bounds of eqs .",
    "( [ eq : utot - mdep ] ) and ( [ eq : using - mdep ] ) .",
    "a detailed analysis of the errors in disordered charge configurations has been presented by kolafa and perram @xcite . in this work ,",
    "we focus on a model- and configuration - independent measure of the numerical accuracy of truncated ewald sums .",
    "this general error analysis provides insight into the influence of the ewald - sum parameters @xmath0 , @xmath19 , and @xmath20 ( and , possibly , a real - space cutoff @xmath28 ) .",
    "we do not analyze effects of partial error cancellation owing to , e.g. , charge ordering .",
    "we will study a system of two particles with charges @xmath29 , at positions @xmath30 and @xmath31 .",
    "we will restrict our analysis to the most widely used cubic cell .",
    "calculations will be done in reduced coordinates with a lattice constant of 1 , resulting in @xmath8 assuming integer values and @xmath32 .",
    "we define @xmath33 as the maximum deviation from the identity eq .",
    "( [ eq : dudeta ] ) with respect to @xmath34 vectors in the cell @xmath12 .",
    "@xmath33 will serve as our measure for the numerical accuracy of a truncated ewald sum . from eq .",
    "( [ eq : uew ] ) we obtain @xmath35 \\right .",
    "\\nonumber\\\\ & & -\\left .",
    "\\sum_{\\scriptstyle { \\bf k } \\atop \\scriptstyle 0<k\\leq k } \\frac{2\\pi}{\\eta^3}\\exp(-k^2/4\\eta^2)\\left[1- \\exp(i{\\bf k}\\cdot{\\bf r})\\right]\\right|~. \\label{eq : delta}\\end{aligned}\\ ] ] using the identity eq .",
    "( [ eq : dudeta ] ) for the full ewald sum ( @xmath36 ) , we can invert the sign and sum over the complementary @xmath8- and @xmath14-space regions @xmath37 and @xmath38 , respectively .",
    "we approximate the @xmath39-space contributions neglected in eq .",
    "( [ eq : delta ] ) by an integral , @xmath40\\right\\}}\\nonumber\\\\ & & \\approx \\max_{{\\bf r}\\in v}\\left\\ { \\frac{1}{\\pi\\eta^3}\\int_{k}^{\\infty}dk\\,k^2\\ , \\exp(-k^2/4\\eta^2)\\left[1-\\frac{\\sin(kr)}{kr}\\right]\\right\\}~ , \\label{eq : deltaint}\\end{aligned}\\ ] ] noting that @xmath41 .",
    "this results in an approximate expression for the neglected @xmath39-space contributions , @xmath42 we obtain @xmath43 by integration of eq .",
    "( [ eq : deltaint ] ) replacing @xmath44 by its maximum value @xmath45 ( @xmath46 , @xmath47 typically , @xmath0 is large ( @xmath48 ) and only one simulation cell is considered in @xmath49 space ( @xmath50 ) . regarding the sign of the real - space contributions for @xmath50 , @xmath51~ , \\label{eq : deltar}\\end{aligned}\\ ] ] @xmath52",
    "is found to be positive in extensive numerical tests . expressed in terms of theta functions using jacobi s imaginary transformation @xcite , we conjecture @xmath53 \\geq \\exp[-\\eta^2 ( x^2 + y^2 + z^2 ) ] - 1~ ,",
    "\\label{eq : ineq}\\end{aligned}\\ ] ] where @xmath54 , @xmath55 , and @xmath56 ^ 3 $ ] .",
    "the left part of the inequality is trivial .",
    "however , we could not find a formal proof for the lower bound .",
    "the neglected @xmath49-space contributions in @xmath57 come mainly from the neighboring image and reach a maximum at the center of the faces of the cube [ @xmath58 . from eq .",
    "( [ eq : deltar ] ) , the real - space contributions to @xmath57 are estimated as @xmath59 , resulting in an approximate expression for @xmath57 , @xmath60 for the practically less interesting case of @xmath50 and @xmath0 small ( @xmath61 ) , eq .",
    "( [ eq : ineq ] ) can be used to derive an upper bound @xmath62 $ ] .",
    "based on an analysis of the dielectric properties of polar fluids in periodic space , neumann and steinhauser @xcite derived a measure for the effect of a real - space truncation of ewald sums , which for @xmath50 gives @xmath63 ^ 3 $ ] . for large @xmath0 , the deviation from ideality @xmath64 scales as @xmath65 , similar to what we find based on our analysis of @xmath66 .",
    "the dependence of @xmath57 on the @xmath39-space cutoff @xmath20 is depicted in fig .",
    "[ fig : deltamax ] . the curves obtained from the approximation eq .",
    "( [ eq : deltaapp ] ) are compared with the maxima calculated from @xmath67 points @xmath31 randomly chosen in a cubic cell .",
    "we observe excellent agreement of the approximate formula in the range considered ( @xmath68 ) .",
    "( [ eq : deltaapp ] ) can therefore be used for assessing the quality of an implementation ( @xmath69 ) of the ewald sum . an interesting observation from fig .",
    "[ fig : deltamax ] is that certain @xmath20 values show a particularly small fourier - space errors for all @xmath0 values studied .",
    "the @xmath20 values are characterized by a gap in the lattice , i.e. , there do not exist @xmath14 vectors such that @xmath70 .",
    "the numerical values are of the form @xmath71 , 14 , 22 , 30 , 38 , and 46 @xcite ; although followed by a gap , @xmath72 does not give an optimal cutoff .",
    "the inverse of eq .",
    "( [ eq : sigma ] ) can be used to obtain the ratio @xmath73 given an error in the @xmath39-space sum , @xmath74\\ ; ( -\\ln\\sigma)^{-1/2}~ , \\label{eq : siginv}\\end{aligned}\\ ] ] which is asymptotically correct for small errors @xmath75 , but is already a good approximation for @xmath76 .",
    "an important observation is that only ratios @xmath73 enter the formula for the @xmath39-space error eq .",
    "( [ eq : deltak ] ) . correspondingly , to achieve the same accuracy with two values @xmath77 and @xmath78 , the @xmath39-space cutoff distances have to be chosen proportionally , @xmath79 .",
    "the number of @xmath14 vectors @xmath80 for a given value of @xmath20 scales as @xmath81 .",
    "thus , the number of @xmath14 vectors required to maintain a given accuracy increases with the third power of the @xmath0 ratios when increasing @xmath0 , @xmath82 from the analysis of the @xmath14-dependent dielectric constant , neumann @xcite proposed a measure @xmath83 for the fourier - space error , which also depends only on @xmath73 and agrees closely with the asymptotic behavior of @xmath84 .",
    "we now determine a maximum useful value of @xmath20 , given @xmath50 and @xmath0 .",
    "this is obtained from a relation @xmath85 , for which the errors of @xmath39-space and real - space truncations are equal , such that a further increase in the number of @xmath14 vectors would not significantly reduce the overall error . equating the expressions for the real- and fourier - space errors in a cubic lattice , @xmath86 , we obtain an approximate expression , @xmath87 asymptotically valid for large @xmath0 .",
    "( the relative errors of eq .",
    "( [ eq : keta ] ) are less than 0.05 and 0.01 for @xmath88 and 5 , respectively . )    in many calculations , a spherical real - space cutoff @xmath28 is introduced in eq .",
    "( [ eq : phi ] ) , i.e. , the argument of the @xmath8 sum is multiplied with a unit step function @xmath89 . to find an approximate expression for the numerical error of an implementation @xmath90 where @xmath28 is smaller than half of the box length , we use eq .",
    "( [ eq : delta ] ) modified by a @xmath91 function .",
    "we approximate the additional real - space contributions to @xmath57 as @xmath92 , which yields @xmath93~ , \\label{eq : deltaapprc}\\end{aligned}\\ ] ] analogous to eq .",
    "( [ eq : deltaapp ] ) . typically , @xmath0 is large and @xmath28 is chosen smaller than 0.5 , such that the @xmath94 term dominates .",
    "we can then invert eq .",
    "( [ eq : deltaapprc ] ) to find a generalization of eq .",
    "( [ eq : keta ] ) .",
    "this gives the @xmath39-space cutoff @xmath20 at which real- and fourier - space errors are approximately equal , @xmath95 for @xmath96 , we find good agreement for @xmath97 , with the relative error of eq .",
    "( [ eq : ketarc ] ) smaller than 2% .",
    "we illustrate our error analysis of ewald sums using a study of kusalik @xcite , who reports relative errors of dipole - dipole energies for several configurations of a dipolar soft - sphere fluid calculated with @xmath50 , @xmath98 , and @xmath99 and 42 .",
    "14 of ref .",
    "@xcite shows the relative errors ( including the sign ) for the three @xmath20 values as a function of @xmath0 .",
    "given @xmath20 , the relative errors are minimal for some values of @xmath0 .",
    "the optimal combinations of @xmath0 and the @xmath39-space cutoff @xmath20 from kusalik s calculations are approximately @xmath100 , and 6 for @xmath99 and 42 .",
    "these values are in excellent agreement with those derived from our analysis , with eq .",
    "( [ eq : keta ] ) giving @xmath101 and 6.1 for kusalik s @xmath20 values .    in an extension of this study ,",
    "kusalik @xcite reported electrostatic energy , pressure , and dielectric constant of a dipolar soft - sphere system for various ewald - summation parameters ( @xmath96 , @xmath50 , @xmath102 , @xmath103 ) .",
    "however , the statistical errors  although small  do not allow to establish a conclusive picture , since all data are approximately within two estimated standard deviations . large statistical uncertainties of the order of 1020% also prohibit a detailed examination of the errors of the dielectric constant of spc water , as calculated by belhadj et al . @xcite .    to further demonstrate the quantitative power of the proposed error analysis , we have studied the energies of random configurations of @xmath3 charges @xmath29 in a cubic box ( with net charge 0 ) .",
    "energies have been calculated for 10 configurations with @xmath104 and @xmath105 point charges using ewald summation ( @xmath106 and by explicit lattice sums using lattice vectors @xmath8 with @xmath107 ( with the correction for a net dipole moment of the box considered @xcite ) .",
    "the relative errors @xmath108 in the energy with respect to the lattice sums have been determined for @xmath109 and @xmath110 . for given values of @xmath20",
    ", we determine the screening parameter @xmath0 such that the relative errors @xmath111 assume a minimum .",
    "[ fig : keta ] shows the relation between optimal @xmath20 and @xmath0 values together with the derived curve @xmath85 from eq .",
    "( [ eq : keta ] ) .",
    "we observe excellent qualitative agreement between the derived relation @xmath85 and the observed minima .",
    "quantitatively , the results for the random configurations suggest somewhat larger @xmath39-space cutoff distances @xmath20 for given @xmath0 .",
    "however , in most practical applications the charges are more effectively screened by neighboring charges than in random configurations , such that the @xmath39-space contributions to the energy tend to be smaller , justifying somewhat smaller @xmath20 values .",
    "another important point is the relation between @xmath57 and the relative errors @xmath111 in the energy . for @xmath111 ,",
    "the results for the random configurations have been used .",
    "@xmath57 has been calculated from eqs .",
    "( [ eq : deltaapp ] ) and ( [ eq : keta ] ) . fig .",
    "[ fig : rhok ] shows minimum values ( for given @xmath20 ) of @xmath111 and @xmath57 as a function of @xmath20 .",
    "@xmath108 and @xmath57 closely follow each other , supporting the present error analysis . for the random configurations ,",
    "they are proportionally related with a factor of about 100 .",
    "the present error analysis has important implications on the choice of the ewald - sum parameters @xmath0 , @xmath20 , and @xmath28 in computer simulations of condensed - matter systems , helping to avoid unnecessary computational effort and minimize the numerical error .",
    "the analysis of truncation errors allows to choose @xmath0 , @xmath20 , and @xmath28 on a rational basis . using the accuracy measure @xmath57",
    ", it becomes possible ( i ) to assess the numerical quality of an ewald - sum implementation and ( ii ) to compare different implementations using different parameters .",
    "an important application of the ewald - summation error analysis in computer - simulation studies is to optimize the choice of the screening parameter @xmath0 , the real - space cutoff @xmath28 , and the fourier - space cutoff @xmath20 regarding computational speed @xcite . using a few typical configurations of the system",
    ", one can minimize the computer time for the energy ( or force ) calculation using combinations of @xmath0 and @xmath20 that give the same error @xmath57 . the inversion of eqs .",
    "( [ eq : deltaapp ] ) and ( [ eq : deltaapprc ] ) yields the appropriate expressions for @xmath20 , @xmath112~,\\\\ k(\\eta,\\delta , r_c)&=&\\eta\\;\\sigma^{-1}\\!\\left\\ { \\delta - 2\\pi^{-1/2}\\left[\\exp(-\\eta^2/4 ) + \\exp(-\\eta^2 r_c^2)\\right]\\right\\}~,\\end{aligned}\\ ] ] where @xmath113 is the inverse of @xmath75 , as defined in eq .",
    "( [ eq : sigma ] ) . an approximate analytical expression for @xmath113",
    "is given in eq .",
    "( [ eq : siginv ] ) .",
    "this strategy of optimizing @xmath114 pairs along curves of constant error is particularly important in computational studies of large coulombic systems ( e.g. , biomolecules in solution ) , where an overwhelming amount of computer time is spent on the calculation of long - range charge interactions .",
    "the author wants to thank a. e. garca and m. neumann for many helpful discussions .",
    "this work has been funded by the department of energy ( u.s . ) ."
  ],
  "abstract_text": [
    "<S> ewald summation is widely used to calculate electrostatic interactions in computer simulations of condensed - matter systems . </S>",
    "<S> we present an analysis of the errors arising from truncating the infinite real- and fourier - space lattice sums in the ewald formulation . </S>",
    "<S> we derive an optimal choice for the fourier - space cutoff given a screening parameter @xmath0 . </S>",
    "<S> we find that the number of vectors in fourier space required to achieve a given accuracy scales with @xmath1 . </S>",
    "<S> the proposed method can be used to determine computationally efficient parameters for ewald sums , to assess the quality of ewald - sum implementations , and to compare different implementations .    </S>",
    "<S> -.25 in -.25 in -61pt = 5542.5pc    * the numerical accuracy of truncated ewald sums for periodic systems with long - range coulomb interactions * + gerhard hummer + theoretical biology and biophysics group t-10 , ms k710 , + los alamos national laboratory , los alamos , nm 87545 , u.s.a . </S>",
    "<S> + ( chemical physics letters : in press , 1995 ) </S>"
  ]
}