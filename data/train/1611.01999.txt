{
  "article_text": [
    "let @xmath0 be an elliptic curve .",
    "the mordell - weil theorem states that the group @xmath1 of rational points on @xmath2 is finitely generated and , therefore , we have an isomorphism @xmath3 where @xmath4 is the ( finite ) subgroup of points of finite order , and @xmath5 is the rank of the elliptic curve .",
    "the torsion subgroups that arise over @xmath6 are well understood : mazur s theorem settles what groups are possible ( @xcite , @xcite ) , the parametrization of the corresponding modular curves are known ( @xcite ) , and we know the distribution of elliptic curves with a prescribed torsion subgroup ( @xcite ) as a function of the height of the curve .",
    "however , the distribution of ranks of elliptic curves is unknown .",
    "several conjectures can be found in the literature ( e.g. , on the average rank , see @xcite ) , and also some heuristic models ( @xcite , @xcite ) , but the basic questions about the distribution of the ranks remain unanswered . for instance , it is not known whether the rank can be arbitrarily large ( currently , the largest rank known is @xmath7 , due to noam elkies - see @xcite for elkies example , and other current records ) .    in this article , we propose a new probabilistic model for the distribution of ranks of elliptic curves ( in families of fixed @xmath8-selmer rank ) and explore its possible consequences .",
    "in addition , we document a phenomenon we refer to as _ selmer bias _ that seems to play an important role in the data and in our models .",
    "we use the largest database of elliptic curves at our disposal ( @xcite , which we will refer to as the bhkssw database ) in order to test our model and to make predictions .",
    "we have also computed additional data for one million curves in the family of elliptic curves with @xmath9 that are also used to test the model .",
    "in our model , we fix @xmath10 , and we study the probability that an elliptic curve @xmath0 of naive height @xmath11 has rank @xmath10 ( the naive height will be defined in section [ sec - allcurves ] ) .",
    "we will assume throughout that the @xmath8-primary part of the tate - shafarevich group of an elliptic curve @xmath0 , denoted by @xmath12 $ ] , is finite ( therefore , by the existence of the cassels - tate pairing , its size is a square , which in turn implies a number of parity considerations ) .",
    "in particular , if we define the ( @xmath8-)selmer rank of an elliptic curve by @xmath13)$ ] , then the selmer rank and the rank agree modulo @xmath8 .",
    "let us fix some notation :    * for fixed @xmath14 , and for any @xmath15 , let @xmath16)$ ] , @xmath17)$ ] , and @xmath18)$ ] be , respectively , the sets of all elliptic curves , all curves with selmer rank @xmath19 , and curves of rank @xmath20 , with naive height in the interval @xmath21 $ ] .",
    "* we will denote the set of elliptic curves of height exactly @xmath11 by @xmath22)$ ] , and we will write @xmath23)$ ] for the set of all elliptic curves up to height @xmath11 .",
    "we define similarly @xmath24 , @xmath25 , and @xmath26 , @xmath27 , for each @xmath14 . * if @xmath28 is a set of elliptic curves ( say @xmath29 , @xmath30 , @xmath31 , or @xmath32 ) , then we write @xmath33 for @xmath34)$ ] , i.e. , @xmath35 is the counting function of elliptic curves in @xmath36 up to height @xmath11 .    for a fixed rank @xmath10 and a height @xmath11 such that the set @xmath37 is non - empty , we are interested in the probability that an elliptic curve of height @xmath11 belongs to @xmath26 , that is , @xmath38 .",
    "our model is based on the probability formula : @xmath39 where @xmath40 , and we define the conditional probability @xmath41 as @xmath42 if @xmath43 is empty , and by @xmath44 otherwise . in section [ sec - allcurves ] we will discuss the known results about the number of elliptic curves up to height @xmath11 . in sections",
    "[ sec - selmer - ratio ] and [ sec - hasse - ratio ] , and for fixed @xmath45 and @xmath46 , we state two probabilistic hypotheses , @xmath47 and @xmath48 stated in hypotheses [ hypa ] and [ hypb ] respectively , that our model will be rest on , and which we summarize next :    1 .   * hypothesis a * : let @xmath49 be the function such that @xmath50 if @xmath51 has @xmath8-selmer rank @xmath19 , and @xmath52 otherwise .",
    "then , there is a function @xmath53 such that @xmath54 behaves as a random variable with bernoulli distribution @xmath55 . in particular",
    ", this implies that the expected value @xmath56 is @xmath57 .",
    "* hypothesis b * : let @xmath19 be even ( the odd case is slightly different , see [ hypb ] ) , let @xmath58 be a set formed by @xmath59-generators of @xmath60 , for each @xmath61 , and let @xmath62 be the function",
    "such that @xmath63 whenever @xmath64 is trivial in @xmath65 $ ] , and @xmath66 otherwise .",
    "then , there is a function @xmath67 such that @xmath68 behaves as a random variable with bernoulli distribution @xmath69 . from this distribution",
    ", we shall recover the conditional probability @xmath70 for any @xmath71 with @xmath72 ( see corollary [ cor - hasse1 ] ) .",
    "after taking all the available data under consideration ( mainly @xcite ) , we formulate the following conjecture ( which is conjecture [ conj - selmerratio ] plus [ conj - hasseratio ] ) :    [ mainconj ] hypotheses a and b hold for elliptic curves over @xmath6 . moreover , there are constants @xmath73 , @xmath74 , @xmath75 , @xmath76 , for each @xmath77 , such that @xmath78 where the limit values @xmath79 of @xmath53 are those given by a conjecture of poonen and rains , and all constants are positive except @xmath80 .",
    "the data suggest that the values of the constants of conjecture [ mainconj ] , for @xmath81 , are as given in tables [ tab3 ] and [ tab - rhomodel ] , and the limit values @xmath79 are discussed in section [ sec - selmer - ratio ] ( as in @xcite ) . in our main theorems [ thm - predictrank ] and [ thm - averank ] , under the assumption of @xmath47 and @xmath48 , we provide formulas for @xmath82 , i.e. , the number of elliptic curves of rank @xmath20 and selmer rank @xmath19 up to height @xmath11 , and also for the contribution to the average rank coming from elliptic curves of selmer rank @xmath19 .",
    "[ thm - predictrankintro ] let @xmath83 be fixed , such that @xmath84 .",
    "if we assume conjecture [ mainconj ] , then @xmath85 where @xmath86 , and @xmath87 is the expected value defined in remark [ rem - notation ] .    in corollary [ cor - predictrank2 ]",
    "we specialize the formulas of @xmath88 for @xmath89 ( see also table [ tab - predictrank ] ) . using our formulas ,",
    "we have computed approximations of @xmath90 for @xmath91 in the range @xmath92 $ ] , and plotted them in figures [ fig - predictrank123 ] and [ fig - predictrank45 ] .",
    "the error in our approximations is less than @xmath93 in this range ( see table [ tab - predictrank2 ] ) .",
    "our second theorem gives conjectural formulas for the contribution to the average rank of elliptic curves coming from elliptic curves of each selmer rank @xmath77 .",
    "then , the contributions are added up to estimate the behavior of the average rank .",
    "[ thm - averankintro ] assume @xmath47 and @xmath48 , let @xmath77 be fixed .",
    "then , the expected value of @xmath94 is given by @xmath95 moreover , the error in approximating @xmath96 by its expected value is given by @xmath97 where @xmath98 is the covariance function defined in proposition [ prop - equicorr ] .",
    "further , there are constants @xmath99 such that the expected value of @xmath100 is given by @xmath101 in particular , @xmath102 with standard error going to @xmath42 as @xmath103 .",
    "in particular , theorem [ thm - averankintro ] says that our assumptions imply the so - called `` @xmath104 conjecture '' ( see conjecture [ conj-5050 ] ) and , moreover , it predicts not only the @xmath105 limit of the average rank , but also a rate of convergence to said limit .",
    "we have used our formulas to compute an approximation of @xmath106 in the range @xmath92 $ ] and plotted it in figure [ fig - averank ] .",
    "the error in our approximation of @xmath107 is @xmath108 of the actual value ( see remark [ rem - averank ] ) . in table",
    "[ tab - averank ] , and under the assumption of conjecture [ mainconj ] , we have computed approximate values of @xmath109 using numerical integration of the formulas of theorem [ thm - averankintro ] .",
    ".conjectural approximate values of @xmath110 obtained using numerical integration of the formulas of theorem [ thm - averank ] .",
    "the integration was done with sagemath , which reports an absolute error in the numerical integration less than @xmath111 in all cases . by theorem [ thm - averank ] ,",
    "the limit should be @xmath112 . [ cols=\"^,^,^,^\",options=\"header \" , ]     next , using the formulas from corollary [ cor - predictrank2 ] , we can estimate the rate of growth of our rank counting functions @xmath113 .",
    "for instance :    if we assume @xmath47 , @xmath48 , and conjectures [ conj - selmerratio ] and [ conj - hasseratio ] , then there are explicit computable positive constants @xmath114 and @xmath115 , for @xmath116 such that @xmath117 @xmath118 @xmath119 for any @xmath120 .    for each @xmath121 ,",
    "let @xmath122 be the smallest natural number such that @xmath123 .",
    "then , @xmath124)\\ ] ] and , by corollary [ cor - predictrank ] we have @xmath125 ) ) = \\frac{5\\kappa}{6 }   \\binom{\\lfloor \\frac{r}{2 } \\rfloor}{0 } \\int_{h_0}^x \\cfrac { s_{r}\\cdot \\mathbb{e}_{\\lfloor \\frac{r}{2 } \\rfloor,0}^{r}(h)}{(1+c_{r}h^{-e_{r}})\\cdot h^{1/6}}\\ , dh + o(x^{1/2}).\\ ] ] further , since @xmath123 , we can write @xmath126 for any @xmath127 . now , @xmath128 for @xmath129 , and by corollary [ cor - rankprobabilities ] , we have @xmath130 for @xmath131 . further , assuming @xmath48 we have @xmath132 .",
    "putting everything together we obtain , for instance , the following approximation formula for @xmath133 @xmath134)\\\\ & =   & \\pi_{\\mathcal{r}_1\\cap { \\mathcal{s}}_1}(h_1 ) + \\frac{5\\kappa}{6 }   \\int_{h_1}^x \\cfrac{\\theta_{1}(h)}{h^{1/6}}\\ , dh + o(x^{1/2})\\\\ & = & \\pi_{\\mathcal{r}_1\\cap { \\mathcal{s}}_1}(h_1)+ \\frac{5\\kappa s_1}{6 }   \\int_{h_1}^x \\sum_{m=0}^\\infty ( -c_r)^m h^{-\\frac{1}{6}-me_1}\\ , dh + o(x^{1/2})\\\\ & = & \\pi_{\\mathcal{r}_1\\cap { \\mathcal{s}}_1}(h_1)-\\left(\\kappa s_1 h_1^{5/6}\\cdot\\sum_{m=0}^\\infty \\frac{(-c_1)^m}{1-(6/5)\\cdot m",
    "e_1}h_1^{-me_1}\\right)+\\kappa s_1 x^{5/6}\\cdot\\sum_{m=0}^\\infty \\frac{(-c_1)^m}{1-(6/5)\\cdot m e_1}x^{-me_1}\\\\ & = & \\lambda_1 + \\kappa s_1 x^{5/6}\\cdot\\sum_{m=0}^\\infty \\frac{(-c_1)^m}{1-(6/5)\\cdot m e_1}x^{-me_1 } + o(x^{1/2}),\\end{aligned}\\ ] ] with @xmath135 , and we derive formulas for @xmath136 and @xmath137 in a similar manner .",
    "in this section we shall assume hypotheses @xmath47 and @xmath48 and estimate the average rank of all elliptic curves of height @xmath138 : @xmath139 we quote here the average rank conjecture as in @xcite ( see @xcite for goldfeld s version for quadratic twists ) .",
    "[ thm - averank ] assume @xmath47 and @xmath48 , and let @xmath77 be fixed .",
    "then , the expected value of @xmath96 is given by @xmath144 moreover , the error in approximating @xmath96 by its expected value is approximately given by @xmath145    we compute the expected value of the average rank as follows : @xmath146 by corollary [ cor - hasseaverank ] . in particular , theorem [ thm - brumer ] and @xmath47 imply @xmath147 ) } ( n\\bmod 2 ) + 2\\left\\lfloor{\\frac{n}{2}}\\right\\rfloor   \\rho_n(h)\\\\   & = & \\frac{1}{\\pi_\\mathcal{e}(x ) } \\cdot \\sum_{h=1}^x \\pi_{{\\mathcal{s}}_n}([h , h])\\cdot \\left ( ( n\\bmod 2 ) + 2\\left\\lfloor{\\frac{n}{2}}\\right\\rfloor    \\rho_n(h)\\right)\\\\    & = & \\frac{1}{\\pi_{\\mathcal{e}}(x ) } \\cdot \\left(\\frac{5\\kappa}{6}\\int_0^x   \\frac{\\theta_n(h)}{h^{1/6 } } \\left((n\\bmod 2 ) + 2\\left\\lfloor{\\frac{n}{2}}\\right\\rfloor \\rho_n(h)\\right)\\ , dh + \\theta_n(x)\\cdot o(x^{1/2})\\right)\\\\    & = & \\frac{5\\kappa}{6 \\pi_{\\mathcal{e}}(x ) } \\cdot \\int_0^x   \\frac{\\theta_n(h)}{h^{1/6 } } \\left((n\\bmod 2 ) + 2\\left\\lfloor{\\frac{n}{2}}\\right\\rfloor \\rho_n(h)\\right)\\ , dh + \\theta_n(x)\\cdot o(x^{-1/3}),\\\\\\end{aligned}\\ ] ] where we have used proposition [ prop - numberselcurves ] and corollary [ cor - countcurvesaverage ] for the estimate @xmath148 .",
    "moreover , by corollary [ cor - hasseaverank ] , the standard error in the approximation of the average by the expected value is given by @xmath149    [ rem - approxave ] let @xmath150 be the smallest positive integer such that @xmath151 . if we assume conjectures [ conj - selmerratio ] and [ conj - hasseratio ] , then @xmath96 is approximately given by @xmath152 where @xmath153 .",
    "thus ,      where we have abbreviated @xmath155 , and below we shall write @xmath99 for the contents inside the first parenthesis , i.e. , @xmath156 .",
    "@xmath157 hence , we obtain the following result about the average rank of elliptic curves .",
    "[ cor - averank ] if we assume @xmath47 and @xmath48 , and conjectures [ conj - selmerratio ] and [ conj - hasseratio ] , then there are constants @xmath99 such that the expected value of @xmath158 is given by @xmath159 with standard error @xmath160 . in particular , @xmath102 with standard error going to @xmath42 as @xmath103 .",
    "the approximation of the average rank is an immediate consequence of our approximation of the contribution to the average rank coming from each selmer rank @xmath19 given in remark [ rem - approxave ] . from the approximation , it follows that @xmath161 finally , we point out that , by proposition 2.6 of @xcite , the values @xmath79 have a generating function @xmath162 in particular , for @xmath163 we obtain that @xmath164 , for @xmath165 we obtain that @xmath166 , and therefore @xmath167 let us now estimate the error in the approximation of @xmath96 using corollary [ cor - hasseaverank ] :      recall that the covariance coefficient @xmath98 is given by @xmath169 , and since the random variables @xmath170 take only the values @xmath171 , we have @xmath172 . in particular , @xmath173 . also , notice that @xmath174 in the interval @xmath175 $ ] obtains the maximum value of @xmath176 at @xmath177 .",
    "thus , @xmath178 thus , the standard error in the approximation of @xmath158 is bounded by @xmath179 it remains to show that @xmath180 is convergent .",
    "let us define @xmath181 and @xmath182 for @xmath183 .",
    "then , the definition of @xmath79 implies that @xmath184 , and therefore , @xmath185 for any @xmath186 , and therefore @xmath180 is convergent .",
    "thus , the error goes to @xmath42 as @xmath187 , as desired .",
    "[ rem - averank ] using sagemath , in figure [ fig - averank ] we have plotted values of @xmath158 from the bhkssw database , and ( via numerical integration ) the sum of the approximations given in theorem [ thm - averank ] of @xmath96 for @xmath81 . according to the database , we have @xmath188 while our approximation gives @xmath189 .",
    "thus , the absolute error is @xmath190 , which represents a @xmath108 of the true value .",
    "d. goldfeld , _ conjectures on elliptic curves over quadratic fields _ , number theory , carbondale 1979 ( proc .",
    "southern illinois conf . ,",
    "southern illinois univ . , carbondale , ill . , 1979 ) ,",
    "lecture notes in math . , vol .",
    "751 , springer , berlin , 1979 , pp .",
    "108 - 118 ."
  ],
  "abstract_text": [
    "<S> in this article , we propose a new probabilistic model for the distribution of ranks of elliptic curves in families of fixed selmer rank , and compare the predictions with previous results , and with the databases of curves over the rationals that we have at our disposal . in addition , we document a phenomenon we refer to as _ selmer bias _ that seems to play an important role in the data and in our models . </S>"
  ]
}