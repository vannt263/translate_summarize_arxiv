{
  "article_text": [
    "kingman s observation that the genealogy of a random sample of individuals from a panmictic , neutrally - evolving population can be represented as a markov process @xcite ranks as one of the most influential contributions of mathematical population genetics . not only has the coalescent led to a deeper understanding of evolution in neutral populations , but it also plays a central role in statistical genetics where it facilitates the efficient simulation of sample genealogies .",
    "unfortunately , the markov property that makes kingman s coalescent both mathematically and computationally tractable is usually not shared by genealogical processes in populations composed of non - exchangeable individuals . in particular",
    ", this is true when there are fitness differences between individuals , since then the selective interactions between individuals cause genealogies to depend on the history of lineages that are non - ancestral to the sample .",
    "the key to overcoming this difficulty is to extend the genealogy to a higher - dimensional process that does satisfy the markov property .",
    "this has been done in two ways .",
    "one approach is to embed the genealogical tree within a graphical process called the ancestral selection graph @xcite in which lineages can both branch and coalesce .",
    "the intuition behind this construction is that the effects of selection on the genealogy can be accounted for by keeping track of a pool of potential ancestors which includes lineages that have failed to persist due to being out - competed by individuals of higher fitness .",
    "an alternative approach was proposed by kaplan et al .",
    "( 1988 ) @xcite , who showed that the genealogical history of a sample of genes under selection can be represented as a structured coalescent process .",
    "here we think of the population as being divided into several panmictic subpopulations ( called genetic backgrounds ) which consist of individuals that share the same genotype at the selected locus . because individuals with the same genotype are exchangeable ( i.e.",
    ", they have the same fitness ) , the rate of coalescence within a background depends only on the size of the background and the number of ancestral lineages sharing that genotype .",
    "thus , to obtain a markov process , we need to keep track of two kinds of information : ( i ) the types of the ancestral lineages , and ( ii ) the frequencies of the alleles segregating at the selected locus , followed backwards in time . for many applications",
    "it is assumed that the population is at equilibrium and that the forwards in time dynamics of the allele frequencies are described by a stationary diffusion process . in this case , the ancestral process of allele frequencies can be identified by time reversal of the diffusion process . in particular ,",
    "if the diffusion process is one - dimensional , then the time - reversed process conveniently has the same law as the forward process .",
    "a formal derivation of the structured coalescent process for such an equilibrium population is given in @xcite and various applications are discussed in @xcite .",
    "the focus of this article is on the time reversal of a population genetical model that incorporates mutation , selection , genetic drift and population bottlenecks . to be concrete ,",
    "consider a locus with two alleles , @xmath2 and @xmath3 , and let @xmath4 denote the frequency of @xmath3 at time @xmath5 in a population of size @xmath6 . in the absence of bottlenecks",
    ", we will suppose that the jump process @xmath7 can be approximated by the wright - fisher diffusion @xmath8 with generator @xmath9 where @xmath10 and @xmath11 are the scaled mutation rates from @xmath2 to @xmath3 and from @xmath3 to @xmath2 , respectively , and @xmath12 is the scaled and possibly frequency - dependent selection coefficient of @xmath3 relative to @xmath2 . in using the diffusion approximation , we assume that @xmath6 is large , that time is measured in units of @xmath6 generations , and the unscaled mutation rates and selection coefficient are of order @xmath13 .",
    "convergence results justifying the passage to the diffusion limit can be found in @xcite .",
    "population bottlenecks are transient events during which most of the population is descended from a small number of individuals . on the diffusive time scale ,",
    "these can be modeled as instantaneous jumps in the allele frequencies , and in this article we will be concerned with a class of models in which the bottlenecks always result in the temporary fixation of one of the two alleles , i.e. , @xmath8 always jumps to @xmath14 or @xmath15 .",
    "we have two scenarios in mind . in the first",
    ", we consider a locus that is part of a non - recombining segment of dna ( e.g. , a mammalian mitochondrial genome ) subject to strong selective sweeps which occur at rate @xmath16 . during each sweep ,",
    "a unique copy of a favorable mutation arises at some linked site and rises rapidly to fixation . depending on whether the new , strongly - selected mutation occurs on a chromosome carrying an @xmath3 or @xmath17 allele",
    ", the frequency of @xmath3 will either increase from @xmath18 to @xmath15 with probability @xmath18 or decrease from @xmath18 to @xmath14 with probability @xmath19 .",
    "here we imagine that the selective advantage of the favored mutation is so strong that this change can be treated as a jump .",
    "the pseudohitchhiking model introduced by gillespie @xcite belongs to this class , as does a related , more general model studied by kim @xcite .",
    "the second scenario concerns demographic bottlenecks that occur during transmission of parasites from infected to uninfected hosts . here we will let @xmath18 denote the frequency of @xmath3 in a chronological series of infected hosts linked by a transmission chain , and we will assume that @xmath8 can be modeled by a diffusion process from the time when one of these hosts is first infected to the time when that host first transmits the infection to the next host in the transmission chain .",
    "suppose that transmissions occur at rate @xmath16 , and that each new infection is founded by a single parasite , as has been proposed for hiv-1 @xcite and for some bacterial pathogens @xcite . in this case , @xmath18 will jump to @xmath14 or @xmath15 following each transmission depending on the type of the transmitted parasite .",
    "also , to allow for the possibility that transmission itself might be selective ( e.g. , @xcite ) , we will let @xmath20 denote the probability that the transmitted parasite is of type @xmath3 given that the frequency of this allele in the transmitting host is @xmath18 .",
    "in general , we stipulate that @xmath21 , @xmath22 , and that @xmath20 is monotonically increasing . if transmission is unbiased , then @xmath23 , as in the pseudohitchhiking model .",
    "a particular case of this transmission chain model was studied by rouzine and coffin @xcite to understand the effects of selection and transmission bottlenecks on antigenic variation in hiv-1 .",
    "both of these scenarios can be modeled by a jump - diffusion process with infinitesimal generator @xmath24 where for technical reasons we will assume that @xmath12 and @xmath20 are smooth functions on @xmath0 $ ] , and that both mutation rates , @xmath10 and @xmath11 , are positive . under these conditions , it can be shown ( cf .",
    "lemma 3.1 ) that the process @xmath8 has a unique stationary distribution , @xmath25 , which has a density on @xmath0 $ ] . to characterize the structured coalescent process corresponding to this model , we need to identify the stationary time reversal of the process @xmath8 .",
    "formally , this can be done by solving the following adjoint problem for the operator @xmath26 : @xmath27 where @xmath28 is in the domain of @xmath29 .",
    "if @xmath26 generates a markov process @xmath30 , then this process will have the same law as the stationary time reversal of @xmath8 @xcite .",
    "when @xmath31 , @xmath8 is a diffusion process and a simple calculation using integration - by - parts shows that @xmath32 , demonstrating that the law of the diffusion is invariant under time - reversal , as remarked above .",
    "however , if @xmath33 , then for the adjoint condition   to be satisfied for all @xmath34 $ ] , we must instead set @xmath35 where @xmath36 and @xmath37 $ ] satisfies @xmath38 with @xmath39 .",
    "although it is not immediately clear that the operator defined by   is the generator of a markov process , this calculation does show that the process incorporating bottlenecks is not invariant under time reversal .",
    "to gain some insight into the qualitative behavior of the time - reversed process , it is useful to consider two heuristic descriptions .",
    "we begin by observing that the behavior of @xmath30 depends strongly on whether the boundary points @xmath40 are accessible or inaccessible to the diffusive motion of the forward process .",
    "recall that for the wright - fisher diffusion corresponding to @xmath41 ( which we call the diffusive motion of the jump - diffusion process ) , feller s boundary classification conditions show that @xmath14 ( resp .",
    "@xmath15 ) is accessible if and only if @xmath42 ( resp .",
    "@xmath43 ) , see e.g.  section 4.7 in @xcite .",
    "the importance of this distinction is illustrated in figure 1 , which shows sample paths of the jump - diffusion process corresponding to cases where the two boundaries are either inaccessible ( a ) or accessible ( b ) to the forward diffusion .",
    "to see what this suggests about the behavior of the time - reversed process , begin at the top of each figure and follow the sample path backwards in time towards the bottom .",
    "if the boundaries are inaccessible , then whenever the sample path is followed back to a boundary at some time , the forward process will necessarily have reached that boundary via a jump .",
    "consequently , the time - reversed process must immediately jump into the interval @xmath44 whenever it arrives at a boundary that is inaccessible to the forward diffusion .",
    "the behavior of the time - reversed process at a boundary that is accessible to the forward diffusion is very different . in this case ,",
    "when the sample path of the time - reversed jump diffusion hits that boundary , the forward process may have arrived there either diffusively or via a jump from the interior ( figure 1b ) .",
    "accordingly , the time - reversed process need not immediately jump into the interior @xmath44 when it visits the boundary , although jumps can only occur when the process is on the boundary and are certain to occur at some such times if @xmath33 .     in a and @xmath45 in b. ]    a more quantitative picture of this second case can be obtained by considering a less singular process that approximates the jump - diffusion process corresponding to  . for @xmath46 ,",
    "let @xmath47 be a perturbation of a wright - fisher diffusion which at rate @xmath16 jumps to a point chosen uniformly at random from an interval of width @xmath48 adjacent to one of the two boundaries . more precisely , let @xmath49 be the markov process with generator @xmath50 writing @xmath51 for the density of the stationary distribution of this process , a simple calculation using   shows that the stationary time reversal of @xmath49 , denoted @xmath52 , is also a jump diffusion process with generator @xmath53}(p ) \\right )            \\int_{0}^{1 } \\left ( \\frac{w(q ) \\pi_{\\epsilon}(q)}{\\kappa_{\\epsilon } } \\right )           ( \\psi(q ) - \\psi(p ) ) dq   +   \\nonumber \\\\          & &    \\lambda ( 1-\\kappa_{\\epsilon } )   \\left ( \\frac{1}{\\epsilon \\pi_{\\epsilon}(p ) }           1_{[0,\\epsilon)}(p ) \\right )          \\int_{0}^{1 }   \\left ( \\frac{(1-w(q ) ) \\pi_{\\epsilon}(q ) } { 1-\\kappa_{\\epsilon } } \\right )           ( \\psi(q ) - \\psi(p ) ) dq,\\end{aligned}\\ ] ] where @xmath54)$ ] and @xmath55 .",
    "it is easy to read off the behavior of this process from its generator . in particular , we see that @xmath52 can only jump when it is present in the region @xmath56 $ ] and that the rate at which jumps occur out of this region is equal to @xmath57 when @xmath58 $ ] and @xmath59 when @xmath60 .    to relate these observations to the process @xmath30 ,",
    "let @xmath61 and notice that as @xmath48 tends to @xmath14 , the sequence of processes @xmath62 converges in distribution on @xmath63}([0,t])$ ] to @xmath8 .",
    "furthermore , because time reversal is a continuous mapping on @xmath63}([0,t])$ ] , the continuous mapping theorem @xcite implies that the sequence of processes @xmath64 converges in distribution to the process @xmath30 .",
    "in particular , this suggests that @xmath30 has the following behavior . for each @xmath65 , define the additive functionals @xmath66}(\\tilde{p}(s ) ) ds \\nonumber \\\\",
    "l_{0,\\epsilon}(t ) & \\equiv &   \\frac{1}{\\epsilon }           \\int_{0}^{t } \\left (   \\frac{1}{\\pi(\\tilde{p}(s ) ) } \\right )           1_{[0,\\epsilon)}(\\tilde{p}(s ) ) ds,\\end{aligned}\\ ] ] and suppose that for @xmath67 , the limits @xmath68 exist for all @xmath69 . here",
    "we would like to interpret @xmath70 as the local time of the process @xmath30 at @xmath71 .",
    "then , by comparison with the jump - diffusion processes @xmath52 , we expect that if both boundaries are accessible , then @xmath30 is a jump - diffusion with diffusive motion in @xmath44 governed by   which jumps from the boundary point @xmath14 to a random point in the interval @xmath44 distributed as @xmath72 as soon as @xmath73 exceeds an exponential random variable with parameter @xmath74 and which jumps from the boundary point @xmath15 to a random point distributed as @xmath75 on @xmath44 as soon as @xmath76 exceeds an exponential random variable with parameter @xmath77 .",
    "although these remarks are purely heuristic , we show below that they correctly describe the stationary time reversal of the pseudo - hitchhiking model and other jump - diffusions with generators of the form ( 2 ) .",
    "although our principle concern is with the modified wright - fisher process corresponding to  , we state our results for a more general class of jump - diffusion processes , which we now introduce .",
    "let the forward process @xmath78 be the jump - diffusion process on @xmath0 $ ] corresponding to the generator @xmath79 for @xmath80\\bigr)}}}$ ] . in other words , the diffusive motion of @xmath8",
    "is governed by the generator @xmath81\\bigr)}}},\\ ] ] with infinitesimal drift and variance coefficients , @xmath82 and @xmath83 , respectively , while jumps occur at constant rate @xmath84 and move the process from state @xmath85 $ ] either to @xmath14 with probability @xmath86 $ ] or to @xmath15 with probability @xmath87 . throughout this article , we will assume that the following conditions are satisfied .",
    "[ assumptions ] the infinitesimal mean and variance satisfy @xmath88 and @xmath89 for all @xmath90 , respectively . furthermore , @xmath83 , @xmath82 and @xmath91 are analytic functions in a neighborhood of @xmath0 $ ] , and the infinitesimal variance has non - zero derivatives @xmath92 at the boundaries .    for example , if @xmath41 is the generator of a neutral wright - fisher diffusion ( with @xmath93 ) , then assumption [ assumptions ] is satisfied with @xmath94 , @xmath95 , and @xmath96",
    ". we also remark that when assumption  [ assumptions ] is satisfied , lemma [ l : equilibrium_distribution ] shows that @xmath78 has a unique stationary distribution @xmath97 with a density @xmath98 that satisfies a second order ordinary differential equation with non - local boundary conditions .    in theorem 2.1",
    ", we characterize the time - reversed process @xmath99 of the forward process @xmath78 . in keeping with the heuristic description given in the introduction",
    ", @xmath99 is also a jump - diffusion process on @xmath0 $ ] but now with jumps from the boundary @xmath100 to the interior @xmath44 . the diffusive motion of this process is governed by the generator @xmath101 and @xmath102\\bigr)}}}$ ] .",
    "notice that this diffusion has the same infinitesimal variance as the forward diffusion , but has a different infinitesimal drift that depends on the jump events via the stationary density @xmath98 .",
    "also , the jump rates of the time - reversed process depend on a local time process which is described in the following way . recall that the scale function and the speed measure associated with @xmath103 are @xmath104,\\ ] ] respectively .",
    "the scale function will be identified with the associated measure @xmath105 on @xmath0 $ ] and the speed measure @xmath106 will be identified with its density function .",
    "we define the local time process of the jump - diffusion @xmath107 such that it agrees with the local time process of the diffusive motion until the first jump .",
    "more formally , we will introduce a non - negative process @xmath108\\bigr)}}}$ ] which is almost surely continuous in @xmath109 and which satisfies @xmath110 for all measurable @xmath111\\to[0,\\infty)$ ] .",
    "we remark that the local time process satisfying   differs from the semi - martingale local time of the diffusive motion of the time - reversed process by a scalar factor ( see eq .  ) , i.e. , @xmath112 is a weighted semi - martingale local time . that this process is well - defined",
    "is shown below in lemma  [ l : local_time_process ] .",
    "the last ingredient needed in our construction is a pair of independent , exponentially - distributed random variables , @xmath113 and @xmath114 , with parameters @xmath115\\ ] ] where @xmath116 , @xmath117 .",
    "the existence of the limit displayed in   is guaranteed by lemma  [ l : rate ] . by convention , @xmath118 if @xmath119 and @xmath120 if @xmath121 .    with these definitions , we now describe the dynamics of the time - reversed process @xmath99 . between jump times",
    ", @xmath99 evolves according to the law of the diffusion governed by @xmath103 . if this diffusion hits a boundary @xmath117 at a time @xmath122 and if at that time the local time process exceeds the random variable @xmath123 , that is , if @xmath124 , then @xmath107 jumps from @xmath125 to a random point chosen from @xmath44 according to the distribution @xmath126 . from this point ,",
    "@xmath107 restarts independently of the sample path up to that time .    to better understand how the dynamics of @xmath107 are influenced by the boundary behavior of the forward process ,",
    "we take a closer look at the jump times . because the coefficients @xmath83 and @xmath82 are smooth on an interval containing @xmath0 $ ]",
    ", an application of feller s boundary classification criteria shows that a boundary point @xmath117 is accessible to the forward diffusive motion if and only if @xmath127 .",
    "then , in conjunction with lemma  [ l : boundary_behavior_pi ] , which describes the asymptotics of the density @xmath128 near the boundaries , lemma  [ l : rate ] implies that @xmath129 for @xmath117 .",
    "thus , provided that @xmath130 , the time - reversed process immediately jumps into the interior @xmath44 if the boundary point is inaccessible to the forward diffusive motion , that is , if @xmath131 . in this case , the state space of @xmath107 is in fact @xmath0\\setminus\\{i\\}$ ] .",
    "in contrast , if @xmath125 is accessible to the forward diffusion and @xmath132 , then the exponential random variable @xmath133 is almost surely positive and so a positive amount of local time will have to be accrued at @xmath125 before a jump occurs off of this boundary point .",
    "notice that , in either case , we expect that both boundary points are accessible to the backward diffusive motion . according to lemma  [",
    "l : boundary_behavior_mue_tilde ] @xmath134 and again an application of feller s boundary criteria shows that the boundary point @xmath125 is accessible to the backward diffusive motion whenever @xmath135 .",
    "the critical case is more subtle .",
    "then , @xmath136 , and so @xmath125 would be inaccessible if the drift coefficient @xmath137 were analytic in a neighborhood of @xmath125 .",
    "however , we show in lemma  [ l : boundary_behavior_mue_tilde ] that @xmath138 and then feller s criteria reveal that the logarithmic singularity is just sufficient to render the point @xmath125 accessible to the backward diffusive motion when @xmath136 .",
    "our main result states that the process @xmath107 has the same law as the stationary time reversal of the jump - diffusion @xmath8 .",
    "[ thm : main_result ] assume  [ assumptions ] . let @xmath8 be the jump - diffusion on @xmath0 $ ] with generator @xmath29 as defined in  . then the process @xmath99 is a version of the stationary time reversal of @xmath78 , that is , @xmath139 if the distribution of @xmath140 is the stationary distribution @xmath97 .",
    "the proof of theorem  [ thm : main_result ] is deferred to section  [ sec : the_backward_process ] .",
    "theorem  [ thm : main_result ] establishes the time reversal of the stationary process over a fixed time interval @xmath141 $ ] , @xmath142 fixed and non - random .",
    "readers being interested in other pathwise time reversals are referred to the literature .",
    "it has been shown that processes which are in hunt duality ( see ( * ? ? ?",
    "* chapter vi ) ) are time reversals of each other .",
    "reversing time at the end point of an excursion from an accessible boundary point results in the dual process being started at this boundary point , see @xcite .",
    "the paper of mitro  @xcite reverses time at inverse local time points .",
    "the remainder of the paper is organized as follows .",
    "the next section collects some results concerning the stationary distribution of the jump - diffusion process  .",
    "section  [ sec : jump times at inaccessible boundaries ] describes the boundary behavior of @xmath107 .",
    "in particular we show that the time - reversed process jumps immediately off of any boundary that is inaccessible to the forward diffusion . in section  [ sec : the generator of the time - reversed process ] we identify a core for the generator @xmath26 satisfying the adjoint condition  .",
    "the local time process of @xmath107 is introduced and studied in section  [ sec : the local time process ] .",
    "finally , section  [ sec : the_backward_process ] shows that @xmath107 has generator @xmath143 .",
    "the proof of this result depends on an application of the it - tanaka formula .",
    "the following lemma asserts that , if the conditions of assumption  [ assumptions ] are satisfied , then the jump - diffusion process @xmath8 has a unique stationary distribution on @xmath0 $ ] .",
    "it is also shown that this distribution has a density @xmath98 with respect to lebesgue measure which satisfies a second - order ordinary differential equation ( ode ) subject to boundary conditions that are non - local whenever @xmath144 .",
    "if @xmath145 , then this equation can be solved explicitly , leading to the familiar expression @xmath146 where @xmath147 is a normalizing constant , e.g. , see section 4.5 in @xcite .",
    "although a general closed - form expression for @xmath98 apparently does not exist when @xmath144 , @xmath98 can be calculated by numerically solving   using a modification of the shooting method @xcite .",
    "in addition , below we give an explicit formula for the stationary density in the important special case of a neutral wright - fisher diffusion subject to recurrent bottlenecks .",
    "[ l : equilibrium_distribution ] assume  [ assumptions ] .",
    "then there exists a unique stationary distribution for the process @xmath78 .",
    "this distribution is given by @xmath148 where @xmath149 is the unique solution of the non - local boundary value problem @xmath150 where @xmath116 for @xmath117 .",
    "furthermore @xmath151 converges in distribution to the stationary distribution as @xmath152 for every initial distribution of @xmath140 .",
    "existence and uniqueness of a stationary distribution @xmath153 follow from standard arguments , so we only give a sketch .",
    "couple two versions of @xmath78 with different initial distributions through the same jump times such that the diffusive motions in between jumps are independent until they first meet and are identical thereafter . due to the assumption",
    "@xmath88 , the coupling is successful if there are no jumps , that is , if @xmath154 , see theorem v.54.5 in  @xcite . in the presence of jumps @xmath155 ,",
    "the probability that both components jump to the same boundary is positive at every jump and , therefore , the two components agree eventually . as a consequence of this successful coupling and of compactness of @xmath0 $ ]",
    ", @xmath151 converges in distribution to a probability measure @xmath153 as @xmath152 and @xmath153 is an invariant distribution .",
    "next we prove that @xmath156 has a smooth density @xmath98 .",
    "denote by @xmath157 the diffusion governed by @xmath41 ( see ) .",
    "the scale function and the speed measure associated with @xmath41 are @xmath158,\\ ] ] respectively .",
    "existence and smoothness of the density @xmath98 will be derived from existence and uniqueness of the transition density @xmath159 of @xmath157 with respect to the speed measure .",
    "existence of @xmath159 is established in it and mckean ( 1974 ) @xcite ( @xcite is more detailed in a special case ) via an eigen - differential expansion . to state this result more formally",
    ", we introduce the following notation .",
    "the interval defined in @xcite  here denoted by @xmath160  is the unit interval closed at @xmath14 if @xmath14 is accessible , closed at @xmath15 if @xmath15 is accessible and open otherwise . for this , note that whenever @xmath157 hits a boundary point , it immediately returns to the interior @xmath44 because of the assumption @xmath88 .",
    "moreover note that the stopping time @xmath161 is infinity almost surely .",
    "the generator of @xmath157 is defined in @xcite via right derivatives . as",
    "@xmath157 is a regular diffusion , this generator coincides with @xmath162 for @xmath163 .",
    "there exists a solution @xmath164 of @xmath165 for every @xmath166 $ ] such that @xmath167 is continuous for every @xmath168 .",
    "based on these eigenfunctions , it is shown in @xcite that there exists a borel measure @xmath169 from @xmath170 $ ] to @xmath171 symmetric non - negative definite matrices @xmath172 such that @xmath173 is the transition density of @xmath157 with respect to the speed measure @xmath174 .",
    "now as our jump diffusion @xmath8 could also jump to an inaccessible boundary , we need to extend @xmath175 onto @xmath0 $ ] .",
    "note that if @xmath117 is inaccessible , then @xmath125 is an entrance boundary due to the assumption @xmath176 . as in problem 3.6.3 in @xcite ,",
    "one uses the markov property to extend @xmath157 to the state space @xmath0 $ ] .",
    "thus we may assume @xmath159 to be defined on @xmath177\\times i^\\bullet$ ] .    with these results on the transition density of @xmath157 , we now establish existence of a smooth density of @xmath156 .",
    "define @xmath178 $ ] , @xmath179 by @xmath180 and observe that @xmath181 is the probability that a stationary version of the process jumps to the boundary point @xmath125 when it jumps . recall that the jump times of @xmath8 form a poisson process with rate @xmath16 and that in between jumps , @xmath8 evolves according to @xmath41",
    ". if @xmath182 is any borel measurable set in @xmath0 $ ] , then by conditioning on the time and distribution of the last jump , we have @xmath183 interchanging integrals , we infer that @xmath156 has a density with respect to lebesgue measure and we set @xmath184 where @xmath185 satisfies @xmath186 the function @xmath187 is the green s function and is @xmath188 in the second variable for every @xmath85 $ ] . as",
    "the speed density @xmath174 is also @xmath188 in @xmath44 due to assumption  [ assumptions ] , we conclude that the stationary density @xmath98 is twice continuously differentiable .",
    "the main step of the proof is to show that @xmath98 satisfies  . by proposition 4.9.2 of ethier and kurtz  @xcite ,",
    "the stationary distribution @xmath97 satisfies @xmath189 for all @xmath190\\bigr)}}}$ ] .",
    "let @xmath191 .",
    "the functions @xmath192 and @xmath193 are @xmath194 in @xmath195 $ ] .",
    "integration by parts yields @xmath196_{{\\ensuremath{\\varepsilon}}}^{1-{{\\ensuremath{\\varepsilon } } } }         + [ \\phi{\\ensuremath{{\\displaystyle \\cdot}}}{{{\\bigl(\\mu\\pi-(\\tfrac12 v\\pi)^{'}\\bigr)}}}]_{{\\ensuremath{\\varepsilon}}}^{1-{{\\ensuremath{\\varepsilon } } } }         -\\int_{{\\ensuremath{\\varepsilon}}}^{1-{{\\ensuremath{\\varepsilon}}}}\\phi{\\ensuremath{{\\displaystyle \\cdot}}}{{{\\bigl[(\\mu\\pi)^{'}-(\\tfrac12 v\\pi)^ { '' }         + \\lambda\\pi\\bigr]}}}\\,dp .",
    "\\end   { split}\\ ] ] by considering all functions @xmath197 with support in @xmath198 and then letting @xmath199 , we conclude that @xmath98 satisfies the second - order ode in  .",
    "furthermore , because the functions @xmath200 , @xmath201 , @xmath202 are bounded and @xmath193 is integrable , we may apply the dominated convergence theorem to theintegrals on the left - hand side of   as @xmath199 .",
    "together with   this shows that @xmath203_{{\\ensuremath{\\varepsilon}}}^{1-{{\\ensuremath{\\varepsilon } } } }         + \\phi(1){\\ensuremath{{\\displaystyle \\cdot}}}{{\\ensuremath{{\\displaystyle \\lim_{{{\\ensuremath{\\varepsilon}}}{\\rightarrow}0}}}}}{{{\\bigl(\\mu\\pi-(\\tfrac12 v\\pi)^{'}\\bigr)}}}(1-{{\\ensuremath{\\varepsilon } } } )         - \\phi(0){\\ensuremath{{\\displaystyle \\cdot}}}{{\\ensuremath{{\\displaystyle \\lim_{{{\\ensuremath{\\varepsilon}}}{\\rightarrow}0}}}}}{{{\\bigl(\\mu\\pi-(\\tfrac12 v\\pi)^{'}\\bigr)}}}({{\\ensuremath{\\varepsilon}}})\\\\      & = -\\phi(1)\\lambda\\kappa_1-\\phi(0)\\lambda\\kappa_0 .",
    "\\end{split}\\ ] ] as @xmath28 was arbitrary this implies the non - local boundary conditions in  .",
    "if @xmath204 is another normalized solution of  , then reversing the previous arguments shows that   holds with @xmath193 replaced by @xmath204 .",
    "this in turn implies that @xmath205 is another stationary distribution and we conclude that @xmath206 .",
    "it remains to show that @xmath98 is strictly positive .",
    "assuming @xmath207 for some @xmath90 , we conclude that @xmath208 from @xmath18 being necessarily a global minimum . however , the only solution of the second - order ode in   satisfying @xmath209 is the zero function , which contradicts the assumption that @xmath98 is a probability density .",
    "lemma 3.1 can be used to find an explicit formula for @xmath98 when the jump - diffusion process is a model of a neutrally - evolving population subject to recurrent bottlenecks , i.e. , when @xmath8 has generator @xmath210 in this case , is a hypergeometric equation and , using the fact that the mean frequency of allele @xmath3 in a stationary population is @xmath211 , we find that the density @xmath128 is equal to @xmath212,\\ ] ] where @xmath147 is a normalizing constant , @xmath213 is gauss hypergeometric function , and the constants @xmath214 and @xmath215 are determined ( up to interchange ) by the equations @xmath216 and @xmath217 .",
    "the second lemma of this section provides information on the boundary behavior of the density of the stationary distribution .",
    "this information is derived using results on second - order odes with regular singular points .",
    "we adopt the landau big - o and little - o notation .",
    "in addition , for two functions @xmath218 and @xmath219 , we write @xmath220 as @xmath221 if both @xmath222 and @xmath223 as @xmath221 .",
    "[ l : boundary_behavior_pi ] assume  [ assumptions ] .",
    "let @xmath98 be the density of the stationary distribution of the jump - diffusion @xmath8 corresponding to the generator  .",
    "then , for @xmath117 , @xmath98 is equal to @xmath224 as @xmath221 where @xmath225 .",
    "in addition if @xmath226 and @xmath227 , then @xmath228 .",
    "we only consider @xmath229 as the case @xmath230 is analogous .",
    "we begin by observing that @xmath231 is a regular singular point for the differential equation in  , see e.g.  section 9.6 in  @xcite for this concept .",
    "the associated indicial equation for @xmath14 is @xmath232 and has roots @xmath233 and @xmath234 .",
    "note that @xmath235 .",
    "if @xmath236 , then theorem ix.7 in  @xcite tells us that @xmath98 is equal to a linear combination of @xmath237 and @xmath238 in a neighborhood of @xmath14 where @xmath239 and @xmath240 are suitable analytic functions satisfying @xmath241 .    if @xmath242 , then theorem ix.8 in  @xcite shows that @xmath98 is equal to a linear combination of @xmath243 , @xmath244 and @xmath245 in a neighborhood of @xmath14 . if @xmath246 , then assuming @xmath247 , @xmath248 for some constant @xmath249 leads to the contradiction @xmath250 where we have used  .",
    "therefore @xmath251 does not contribute to @xmath98 if @xmath252 .",
    "it remains to calculate the coefficients . in the case",
    "@xmath253 , insert @xmath254 into   to obtain the coefficient @xmath255 @xmath256}}}\\\\    & = \\lim_{p\\to0 }       { { { \\bigl [ { { { \\bigl(\\mu(0)-\\frac{1}{2}v^{'}(0)\\bigr)}}}{{{\\bigl(c_1+c_2p^\\beta\\bigr ) } } }              -\\frac{1}{2}v^{'}(0)p c_2\\beta p^{\\beta-1 } \\bigr]}}}\\\\    & = { { { \\bigl(\\mu(0)-\\frac{1}{2}v^{'}(0)\\bigr)}}}c_1 . \\end{split}\\ ] ] of course if @xmath257 , then @xmath258 implies @xmath259 .",
    "next we show that @xmath260 together with @xmath261 implies @xmath259 .    assuming @xmath262 implies that @xmath263 which contradicts @xmath98 being a density function . in the critical case @xmath264 , implies that @xmath265 therefore the coefficient of @xmath266 is @xmath267 . if @xmath264 and @xmath257 , then assuming @xmath268 implies @xmath269 with @xmath270 and @xmath271 .",
    "inserting this into the ode in   leads to @xmath272 as @xmath273 . dividing by @xmath274 and letting @xmath273 results in the contradiction @xmath275 .",
    "we begin this section by characterizing the boundary behavior of the infinitesimal drift coefficient of the time - reversed process .",
    "this information is of interest for two reasons .",
    "first , it will be used to establish that any boundary point that is accessible to the forwards - in - time process , either diffusively or via jumps , is accessible to the diffusive motion of the time - reversed process .",
    "secondly , we also expect the time - reversed process to have the same state space , @xmath0 $ ] , as the forward process .",
    "indeed , if a boundary point @xmath125 is inaccessible to the forward diffusive motion , then subsequent results will show that the time - reversed process jumps back into the interior as soon as it hits a boundary .",
    "if , however , @xmath125 is accessible to the forward diffusive motion , then because the time - reversed process may visit @xmath125 without jumping , we need to confirm that @xmath30 does not then wander outside of @xmath0 $ ] . to this end , we will show that @xmath276 whenever @xmath14 is accessible and similarly that @xmath277 whenever @xmath15 is accessible .",
    "[ l : boundary_behavior_mue_tilde ] assume  [ assumptions ] . then the drift function @xmath137 of the backward diffusive motion defined in   satisfies @xmath278 as @xmath221 for @xmath117 .",
    "recall that lemma  [ l : boundary_behavior_pi ] describes the asymptotic behavior of @xmath98 as @xmath221 . from this",
    "we obtain @xmath279 as @xmath221 for @xmath117 . inserting this into @xmath280 results in assertion  .",
    "notice that @xmath281 if @xmath282 , so that the diffusive motion of the time - reversed process need not be confined to @xmath0 $ ] . nonetheless , because the boundary @xmath283 is inaccessible to the forward diffusion in this case ( i.e. , @xmath284 )",
    ", the fact that the process @xmath30 immediately jumps back into @xmath44 upon hitting @xmath14 will ensure that the jump - diffusion is confined to @xmath0 $ ] .",
    "we next show that if a boundary point is accessible to the forward jump - diffusion @xmath8 , either diffusively or via a jump , then it must be accessible to the backward diffusive motion governed by @xmath103 .",
    "recall the scale function @xmath285 from  .",
    "[ l : when_accessible ] assume  [ assumptions ] .",
    "the boundary point @xmath117 is accessible to the diffusive motion governed by @xmath103 , that is @xmath286 , if and only if @xmath125 is accessible to the forward jump - diffusion @xmath8 , that is , if @xmath287 or @xmath288 .",
    "w.l.o.g .",
    "we only prove the case @xmath229 . according to lemma 15.6.1 in  @xcite ,",
    "the boundary point @xmath14 is accessible if and only if @xmath289 is finite .",
    "( this is a special case of feller s boundary classification criteria . ) substituting the asymptotic expression for @xmath290 near @xmath283 ( see lemma  [ l : boundary_behavior_mue_tilde ] ) into the definition of @xmath285 , we obtain in the case @xmath260 @xmath291 as @xmath292 . in all three cases",
    ", @xmath293 is integrable over @xmath294 $ ] .",
    "the case @xmath257 follows from similar arguments .",
    "the following lemma shows that the rate constant @xmath295 ( defined in  ) is equal to infinity if the boundary point @xmath117 is inaccessible to the forward diffusive motion .",
    "therefore @xmath107 jumps whenever it hits @xmath125 as @xmath296 .",
    "in addition , if there are no jumps in the forward process , then @xmath121 , and @xmath107 never jumps as @xmath297 .    [",
    "l : rate ] assume  [ assumptions ] . then the rate constant @xmath295 used to define the jump times of @xmath107 satisfies @xmath298 for @xmath117 .",
    "w.l.o.g .",
    "we assume @xmath229 as the case @xmath230 is similar . if @xmath257 , then @xmath299 is trivially correct .",
    "assume @xmath260 for the rest of the proof .",
    "the asymptotic behavior of the scale density @xmath293 is given in  . from this",
    "we derive the asymptotic behavior of the speed density @xmath300 ( defined in  ) as @xmath292 @xmath301 compare   with the boundary behavior of @xmath98 ( see lemma  [ l : boundary_behavior_pi ] ) to obtain  .",
    "in this section we identify the generator of the time - reversed process and show that this operator satisfies the duality condition given in  . that this operator is also the generator of the jump - diffusion process @xmath107 described in section  [ sec : main_result ]",
    "will be established in the final two sections of the paper .",
    "the following notation will be needed to formulate the generator of the time - reversed process .",
    "if @xmath302 is a measure on @xmath0 $ ] with continuous density @xmath303 with respect to lebesgue measure , then we write @xmath304 whenever this limit exists in @xmath305 and denote by @xmath306\\bigr)}}}\\colon & d_\\nu \\psi(p)\\text { exists}{\\ensuremath{\\;\\;\\forall\\;}}p\\in(0,1 ) ,      \\ d_\\nu",
    "\\psi\\text { is continuous}\\\\      & \\text{in } ( 0,1),\\,d_\\nu \\psi(0+)\\text { and } d_\\nu \\psi(1- )      \\text { exist in } { { \\ensuremath{\\mathbbm{r}}}}\\bigr\\ } \\end{split}\\ ] ] the subset of functions which are mapped to continuous functions on @xmath0 $ ] .",
    "note that @xmath307 and @xmath308 , @xmath90 , for every @xmath309 . for @xmath309",
    "the definition of @xmath310 extends to the boundary via @xmath311 and @xmath312 . in this notation , the generator @xmath103 of the backward diffusive motion reads as @xmath313 for every @xmath102\\bigr)}}}$ ] .",
    "the following set will be a core for the generator of the time - reversed process @xmath314 the following lemma asserts that the restriction of @xmath315 to @xmath316 extends to a strong generator of a markov process .",
    "indeed , this can be deduced from theorem ii.4 of mandl ( 1968 ) which shows that the restriction of @xmath315 to @xmath317 is the strong generator of a feller semigroup if @xmath318 and @xmath319 are both non - negative , if @xmath320 is a non - decreasing function on @xmath0 $ ] , and if @xmath321 is continuous , non - decreasing and equal to @xmath285 in a neighborhood of @xmath125 , @xmath322 . only the case @xmath323 is excluded .",
    "the quotient in   is to be interpreted as @xmath324 for @xmath325 and the integral with respect to @xmath326 denotes the lebesgue - stiltjes integral with respect to @xmath320 .",
    "[ l : gent_is_generator ] assume  [ assumptions ] .",
    "the restriction of @xmath327 to the set @xmath316 extends to a strong generator of a markov process .    by theorem ii.4 in  @xcite",
    ", it suffices to prove that @xmath316 is of the form  . according to lemma  [ l : when_accessible ] , the boundary point @xmath117 is accessible to the diffusion governed by @xmath327 if and only if @xmath328 or @xmath288 .",
    "first we show that the condition in   is trivial if @xmath125 is inaccessible , that is , we show @xmath329 for every @xmath330 .",
    "suppose that @xmath331 for some function @xmath332 .",
    "by lemma  [ l : boundary_behavior_pi ] , @xmath128 is bounded above by @xmath333 in a neighborhood of @xmath125 for some @xmath334 .",
    "thus , in a neighborhood of @xmath125 , @xmath335 integrating over @xmath336 $ ] implies that @xmath337 is bounded below by @xmath338 as @xmath221 which contradicts @xmath339 .",
    "an analogous argument applies to the case @xmath340 .",
    "now , let @xmath125 be accessible to the forward process , that is , @xmath341 or @xmath288 .",
    "note that @xmath342 is a bounded continuous non - decreasing function in a neighborhood of @xmath125 .",
    "choose @xmath343 and @xmath344 .",
    "furthermore , let @xmath345}(p){{\\ensuremath{\\mathbbm{1}}}}_{i=0 } + c_1{{\\ensuremath{\\mathbbm{1}}}}_1(p){{\\ensuremath{\\mathbbm{1}}}}_{i=1}\\ ] ] where @xmath346 are to be chosen later . note that @xmath320 is bounded and that @xmath347 puts mass @xmath348 on the point @xmath125 . with these definitions ,",
    "the condition in   takes the form @xmath349 it remains to choose @xmath350 such that @xmath351 for every @xmath352 . using the boundary behavior   of @xmath342 and the asymptotic behavior   of @xmath353",
    ", we arrive at @xmath354 as @xmath221 .",
    "this shows that   holds with some constant @xmath350 .",
    "[ l : generator_backward_process ] assume  [ assumptions ] .",
    "let the process @xmath78 be in equilibrium .",
    "then the time - reversed process @xmath355 exists , that is , there exists a process @xmath355 satisfying @xmath356 in addition , @xmath316 is a core for the generator @xmath143 of @xmath355 and @xmath357    let @xmath143 be the closure of the operator defined in  . by lemma  [ l : gent_is_generator ]",
    ", @xmath143 is the strong generator of a markov process @xmath355 .",
    "recall the generator @xmath29 of @xmath8 from  .",
    "we will prove that @xmath143 is the adjoint operator of @xmath29 with respect to the invariant measure @xmath97 .",
    "let @xmath191 , @xmath80\\bigr)}}}$ ] and @xmath358 . the functions @xmath359 and @xmath193 are @xmath194 in @xmath195 $ ] .",
    "integration by parts yields @xmath360_{{\\ensuremath{\\varepsilon}}}^{1-{{\\ensuremath{\\varepsilon } } } }         + [ \\phi{\\ensuremath{{\\displaystyle \\cdot}}}{{{\\bigl(\\mu\\psi\\pi-(\\tfrac12 v\\psi\\pi)^{'}\\bigr)}}}]_{{\\ensuremath{\\varepsilon}}}^{1-{{\\ensuremath{\\varepsilon}}}}\\\\       & \\qquad\\qquad\\qquad\\ ;            + \\int_{{\\ensuremath{\\varepsilon}}}^{1-{{\\ensuremath{\\varepsilon}}}}\\phi{\\ensuremath{{\\displaystyle \\cdot}}}{{{\\bigl[(\\tfrac12 v\\psi\\pi)^ { '' }            -(\\mu\\psi\\pi)^ { ' } -\\lambda\\psi\\pi\\bigr]}}}\\,dp .",
    "\\end   { split}\\ ] ] as @xmath193 satisfies  , we see that @xmath361 the functions @xmath200 , @xmath362 , @xmath201 , @xmath202 , @xmath28 and @xmath363 are bounded and @xmath193 is integrable .",
    "hence , we may apply the dominated convergence theorem to the integrals in   as @xmath199 .",
    "this also proves that the limits of the boundary terms in   exist as @xmath199 . thus letting @xmath199 in",
    ", we obtain @xmath364 for all @xmath365 and @xmath358 .",
    "the last equality follows from   and from @xmath358 .",
    "this proves that @xmath29 and @xmath143 are adjoint to each other .",
    "consequently , the semigroups of @xmath78 and of @xmath355 are adjoint to each other . according to  @xcite ,",
    "this implies that the markov process @xmath366 associated with @xmath143 has the same law as the time - reversed process of @xmath78 .",
    "this section describes some properties of the local time process of @xmath107 .",
    "first we show existence .",
    "recall the scale function @xmath285 and the speed measure @xmath367 from  .",
    "[ l : local_time_process ] assume  [ assumptions ] .",
    "then there exists a unique , non - negative process @xmath368\\bigr)}}}\\ ] ] which is almost surely continuous in @xmath109 and which satisfies @xmath369 for all measurable @xmath111\\to[0,\\infty)$ ] almost surely .",
    "in addition , if @xmath131 for @xmath117 , then @xmath370 almost surely .",
    "let @xmath371 be the jump times of @xmath107 .",
    "then , by construction of @xmath107 , @xmath372 , @xmath373 , are independent diffusions governed by @xmath103 .",
    "it is well - known that @xmath374 can be written in terms of a brownian motion as follows .",
    "let @xmath375 be a family of independent standard brownian motions with @xmath376 .",
    "denote by @xmath377 the local time process of @xmath378 , see e.g.  section 2.8 in  @xcite , and define @xmath379 then a version of @xmath374 is given by @xmath380 inserting this into the occupation time formula of the brownian motion , a short calculation ( see e.g.  section 5.4 in  @xcite ) shows that @xmath381 where the local time process of @xmath374 with respect to the speed measure is @xmath382 , n\\in{\\ensuremath{\\mathbbm{n}}}_{\\geq1}.\\ ] ] now we put the independent path segments together by defining @xmath383 it is easy to use   to show that @xmath384\\bigr)}}}$ ] satisfies  .",
    "uniqueness follows from standard arguments .",
    "if @xmath131 , then @xmath107 jumps into @xmath44 as soon as it hits the boundary and we conclude that @xmath385 for all @xmath122 .",
    "thus the local time at this boundary point is identically zero .    in the next section",
    ", we will need to be able control the second moment of the local time of the time - reversed jump - diffusion at a boundary point .",
    "we first prove the following estimate concerning the local time of a standard brownian motion .",
    "[ l : bound_on_lbsquare ] let @xmath386 and let @xmath387 be a standard brownian motion with local time @xmath388 at @xmath389 .",
    "suppose that the function @xmath390\\to{{\\ensuremath{\\mathbbm{r}}}}$ ] is non - decreasing .",
    "define @xmath391 and @xmath392 then , for each @xmath393 , there exists a constant @xmath394 independent of @xmath395 and of @xmath396 such that @xmath397 } } }      \\leq c_m{{{\\bigl({{\\ensuremath{\\varepsilon}}}t\\bigr)}}}^{\\frac{m}{2 } }            { { { \\bigl[{{{\\bigl(\\frac{{{\\ensuremath{\\varepsilon}}}t}{\\delta^2}\\bigr)}}}^{\\frac{m}{2 } }                  + 1                 \\bigr]}}}\\ ] ] for all @xmath398 $ ] and @xmath399 .",
    "inequality   is trivial if @xmath400 or @xmath401 , so we may and will assume that @xmath402 , @xmath403 .",
    "fix @xmath398 $ ] .",
    "the left - hand side of   does not depend on the value of @xmath404 , so we will also assume w.l.o.g .",
    "that @xmath405 .",
    "denote by @xmath406 and by @xmath407 the process of the maximum and the process of the absolute maximum , respectively .",
    "define @xmath408 for @xmath122 .",
    "according to section  5.4 in  @xcite , @xmath409 is the local time of @xmath410 at @xmath18 .",
    "the process @xmath410 is equal in distribution to the process @xmath411 reflected at @xmath14 and at @xmath396 .",
    "another way to construct @xmath412 is to take the path of @xmath413 and to identify each @xmath414 $ ] with the set @xmath415 .",
    "thus the local time @xmath416 of @xmath410 in @xmath18 is equal in distribution to the sum of @xmath417 over @xmath418 .",
    "note that @xmath419 almost surely on the event @xmath420 , @xmath389 .",
    "in addition , note that convexity of @xmath421 implies @xmath422 for @xmath423 , @xmath424 .",
    "therefore , @xmath425}}}}\\\\      & = { { \\ensuremath{\\mathbf{e}}}}^{0 }        { { { \\biggl [             \\sum_{k\\in 2\\delta{\\ensuremath{\\mathbbm{n}}}_{\\geq0 } }             \\!\\!\\!\\!{{\\ensuremath{\\mathbbm{1}}}}_{[k , k+2\\delta)}{{{\\bigl({{\\ensuremath{|b|}}}_{{{\\ensuremath{\\varepsilon}}}t}^*\\bigr ) } } }             \\biggl(\\sum_{z=-\\frac{k}{2\\delta}}^{\\frac{k}{2\\delta } }                   \\sum_{x\\in\\{0,2 { { \\ensuremath{\\bar{s}}}}({{\\ensuremath{\\delta}}})\\ } }               l_{2\\delta z+x}^b{{{\\bigl({{\\ensuremath{\\varepsilon}}}t\\bigr)}}}\\biggr)^m        \\biggr]}}}\\\\      & \\leq{{\\ensuremath{\\mathbf{e}}}}^{0 }        { { { \\biggl [             \\sum_{k\\in 2\\delta{\\ensuremath{\\mathbbm{n}}}_{\\geq0 } }             \\!\\!\\!\\!{{\\ensuremath{\\mathbbm{1}}}}_{[k , k+2\\delta)}{{{\\bigl({{\\ensuremath{|b|}}}_{{{\\ensuremath{\\varepsilon}}}t}^*\\bigr ) } } }             { \\ensuremath{{\\displaystyle \\cdot}}}{{{\\bigl(\\frac{2k}{\\delta}+2\\bigr)}}}^{m-1 }             \\!\\!\\!\\!\\sum_{z=-\\frac{k}{2\\delta}}^{\\frac{k}{2\\delta } }             \\sum_{x\\in\\{0,2 { { \\ensuremath{\\bar{s}}}}({{\\ensuremath{\\delta}}})\\ } }               \\!\\!{{{\\bigl(l_{2\\delta z+x}^b{{{\\bigl({{\\ensuremath{\\varepsilon}}}t\\bigr)}}}\\bigr)}}}^m        \\biggr]}}}.    \\end   { split}\\ ] ] use the strong markov property ( e.g.  proposition 2.6.17 in  @xcite ) to restart the brownian motion at the first hitting time of @xmath426 and of @xmath427 , respectively .",
    "thus the left - hand side of   is bounded above by @xmath428}}}\\\\      & \\leq          { { \\ensuremath{\\mathbf{e}}}}^{0 }              { { { \\biggl [              \\bigl(\\frac{2{{\\ensuremath{|b|}}}_{{{\\ensuremath{\\varepsilon}}}t}^*}{\\delta}+2\\bigr)^{m }              \\biggr ] } } }          { { \\ensuremath{\\mathbf{e}}}}^{0}{{{\\bigl[{{{\\bigl(l_0^b{{{({{\\ensuremath{\\varepsilon}}}t)}}}\\bigr)}}}^m\\bigr]}}}.    \\end{split}\\ ] ] note that @xmath429 and @xmath430 are equal in distribution , see e.g.  theorem 3.6.17 in  @xcite .",
    "therefore the left - hand side of   is bounded above by @xmath431 } } }              + 1              \\biggr ] } } }        { { \\ensuremath{\\mathbf{e}}}}^{0}{{{\\bigl[{{{\\bigl(\\frac{1}{2}b_{{{\\ensuremath{\\varepsilon}}}t}^*\\bigr)}}}^m\\bigr ] } } }          \\\\      & \\leq          { { { \\bigl[k_{\\frac{m}{2}}{{{\\bigl(\\frac{{{\\ensuremath{\\varepsilon}}}t}{\\delta^2}\\bigr)}}}^{\\frac{m}{2 } }                + 1\\bigr ] } } }          k_{\\frac{m}{2}}{{{\\bigl({{\\ensuremath{\\varepsilon}}}t\\bigr)}}}^{\\frac{m}{2 } }    \\end   { split}\\ ] ] where @xmath432 is a suitable constant which is independent of @xmath433 and @xmath5 .",
    "the last step follows from the burkholder - davis - gundy inequality , see e.g.  theorem  3.3.28 in  @xcite .",
    "therefore holds with @xmath434 .    in the proof of theorem  [ thm : main_result ] , we will need to exploit the fact that , in the @xmath435 sense , the local time @xmath436 at a boundary point @xmath117 of the backwards process started at @xmath125 decreases to zero faster than @xmath437 as @xmath438 .",
    "this might be surprising as one can show that @xmath439}}}\\sim t{\\ensuremath{\\qquad\\text{as } t\\to0}}.\\ ] ] however , the infinitesimal variance @xmath83 is zero in @xmath125 .",
    "thus , informally speaking , the diffusion governed by @xmath103 is pushed away from zero almost deterministically at rate @xmath440 if the boundary point is accessible at all .",
    "[ l : lt_is_o_of_sqrt_t ] assume  [ assumptions ] .",
    "then the local time at the boundary satisfies @xmath441}}}=0\\ ] ] for @xmath117 .",
    "if @xmath131 , then lemma  [ l : local_time_process ] tells us that @xmath442 , which implies the assertion in this case . for the rest of the proof",
    "assume that @xmath443 .",
    "w.l.o.g .",
    "we assume that @xmath229 as the case @xmath230 is similar .",
    "to begin , we prove that   holds with @xmath444 replaced by @xmath445 . for @xmath446",
    "define @xmath447 the asymptotic behavior   of @xmath448 implies @xmath449 .",
    "recall that @xmath450 is a standard brownian motion started at @xmath451 .",
    "observe that @xmath452 using @xmath453 we obtain an upper bound for @xmath445 as follows @xmath454 } } }      = \\frac1t{{\\ensuremath{\\mathbf{e}}}}{{{\\bigl [         { { { \\bigl(l_{{{\\ensuremath{\\tilde{s}}}}(0)}^{b^{{{{\\ensuremath{\\tilde{s}}}}(0)},1 } } { { { \\bigl({{{\\bigl(\\xi_t^{(1)}\\bigr)}}}^{-1}\\bigr ) } } }             \\bigr)}}}^2                    \\bigr ] } } }      } \\\\      & \\leq\\frac1t{{\\ensuremath{\\mathbf{e}}}}{{{\\bigl [         { { { \\bigl(l_{{{\\ensuremath{\\tilde{s}}}}(0)}^{b^{{{{\\ensuremath{\\tilde{s}}}}(0)},1 } } { { { \\bigl(\\zeta_t^{-1}\\bigr ) } } }             \\bigr)}}}^2                    \\bigr ] } } }      \\leq\\frac{c_2}{{{\\ensuremath{\\underline{{{\\ensuremath{\\tilde{m}}}}}}}}({{\\ensuremath{\\delta } } } ) }           { { { \\biggl[\\frac{t}{{{\\ensuremath{\\underline{{{\\ensuremath{\\tilde{m}}}}}}}}({{\\ensuremath{\\delta}}}){{{\\bigl({{\\ensuremath{\\tilde{s}}}}(\\delta)-{{\\ensuremath{\\tilde{s}}}}(0)\\bigr)}}}^2 }                  + 1\\biggr]}}}\\\\      & { \\xrightarrow{t   { \\rightarrow}0}}\\frac{c_2}{{{\\ensuremath{\\underline{{{\\ensuremath{\\tilde{m}}}}}}}}({{\\ensuremath{\\delta}}})}{\\xrightarrow{{{\\ensuremath{\\delta}}}{\\rightarrow}0}}0    \\end   { split}\\ ] ] for some constant @xmath455 which is independent of @xmath5 and @xmath396 .",
    "the last inequality is lemma  [ l : bound_on_lbsquare ] .",
    "now we come to the local time process @xmath444 .",
    "recall @xmath456 , @xmath113 from section  [ sec : main_result ] and let @xmath457 be the first jump time of @xmath107 from the boundary point @xmath14 .",
    "the local time @xmath458 converges to zero almost surely as @xmath438 . by the theorem of dominated convergence , this implies @xmath459 as @xmath438 .",
    "thus there exists a @xmath460 such that @xmath461 for all @xmath462 .",
    "then we obtain from the definition   of @xmath444 and from the markov property @xmath463 } } }      & \\leq        2{{\\ensuremath{\\mathbf{e}}}}^0{{{\\biggl[{{{\\bigl({{\\ensuremath{\\hat{l}}}}_0^{(1)}(t)\\bigr)}}}^2\\biggr ] } } }        + 2{{\\ensuremath{\\mathbf{e}}}}^0          { { { \\biggl [             { { { \\bigl({{\\ensuremath{\\tilde{l}}}}_0(t)-{{\\ensuremath{\\hat{l}}}}_0^{(1)}(t)\\bigr)}}}^2             { { \\ensuremath{\\mathbbm{1}}}}_{{{\\ensuremath{\\hat{l}}}}_0^{(1)}(t)\\geq r_0 }          \\biggr]}}}\\\\      & \\leq        2{{\\ensuremath{\\mathbf{e}}}}^0{{{\\biggl[{{{\\bigl({{\\ensuremath{\\hat{l}}}}_0^{(1)}(t)\\bigr)}}}^2\\biggr ] } } }        + 2{{\\ensuremath{\\mathbf{e}}}}^{{{\\ensuremath{\\mathcal l^{}\\left({{\\ensuremath{\\tilde{p}}}}(\\tau_1)\\right ) } } } }          { { { \\biggl [             { { { \\bigl({{\\ensuremath{\\tilde{l}}}}_0(t)\\bigr)}}}^2          \\biggr ] } } }        { { \\ensuremath{\\mathbf{e}}}}^0{{{\\biggl[1-e^{-r_0{{\\ensuremath{\\hat{l}}}}_0^{(1)}(t)}\\biggr ] } } }        \\\\      & \\leq        2{{\\ensuremath{\\mathbf{e}}}}^0{{{\\biggl[{{{\\bigl({{\\ensuremath{\\hat{l}}}}_0^{(1)}(t)\\bigr)}}}^2\\biggr ] } } }        + 2{{\\ensuremath{\\mathbf{e}}}}^{0 }          { { { \\biggl [             { { { \\bigl({{\\ensuremath{\\tilde{l}}}}_0(t)\\bigr)}}}^2          \\biggr ] } } }        \\frac14    \\end{split}\\ ] ] for all @xmath462 . using this estimate",
    "we get for @xmath462 @xmath464 } } }       & \\leq{{\\ensuremath{\\mathbf{e}}}}^0{{{\\biggl[{{{\\bigl({{\\ensuremath{\\hat{l}}}}_0^{(1)}(t)\\bigr)}}}^2\\biggr ] } } }           + { { \\ensuremath{\\mathbf{e}}}}^0{{{\\biggl[{{{\\bigl({{\\ensuremath{\\tilde{l}}}}_0(t)\\bigr)}}}^2{{\\ensuremath{\\mathbbm{1}}}}_{\\tau_1<t}\\biggr]}}}\\\\       & \\leq3{{\\ensuremath{\\mathbf{e}}}}^0{{{\\biggl[{{{\\bigl({{\\ensuremath{\\hat{l}}}}_0^{(1)}(t)\\bigr)}}}^2\\biggr ] } } }           + \\frac{1}{2}{{\\ensuremath{\\mathbf{e}}}}^0{{{\\biggl[{{{\\bigl({{\\ensuremath{\\tilde{l}}}}_0(t)\\bigr)}}}^2\\biggr]}}}.    \\end{split}\\ ] ] therefore @xmath465 } } }      \\leq      6\\;{{\\ensuremath{{\\displaystyle \\lim_{t { \\rightarrow}0}}}}}\\frac{1}{t } { { \\ensuremath{\\mathbf{e}}}}^0{{{\\biggl[{{{\\bigl({{\\ensuremath{\\hat{l}}}}_0^{(1)}(t)\\bigr)}}}^2\\biggr ] } } }      = 0\\ ] ] where the last equality is  .",
    "in section  [ sec : the generator of the time - reversed process ] , we identified the generator @xmath143 of the time - reversed process ( see lemma [ l : generator_backward_process ] . ) however , while it is clear that the boundary behavior of this process must be prescribed by the domain of the generator , it is difficult to see how a qualitative description of the process can be deduced from the analytical condition that defines this domain . to address this issue , we show in this section that the process @xmath107 defined in section  [ sec : main_result ] also has generator @xmath143 .",
    "this confirms the heuristic arguments given in the introduction and shows that the time - reversed process is a jump - diffusion process whose jump times depend on the local time process constructed in the preceding section .",
    "the proof of theorem  [ thm : main_result ] is based on the it - tanaka formula for semimartingales which involves the semimartingale local time process . because this local time differs by a scalar factor from the local time process introduced in section 6 ( see eq .   below )",
    ", we have restated the semimartingale it - tanaka formula in terms of @xmath466 .",
    "this is done in the following lemma .",
    "[ l : ito_tanaka_y_tilde ] assume  [ assumptions ] .",
    "let @xmath467 be a diffusion corresponding to the generator @xmath103 defined in ( 8) . then for each @xmath358 @xmath468 for all @xmath122 almost surely .",
    "fix @xmath358 .",
    "we approximate @xmath362 with suitable functions and apply the semimartingale it - tanaka formula .",
    "denote by @xmath469}$ ] the semimartingale local time process of @xmath470 .",
    "we remark that , in general , this local time process is distinct from the local time , @xmath471 , introduced in the preceding section . by theorem 3.7.1 in  @xcite we may and we will assume that @xmath472 is continuous in @xmath5 and cdlg  in @xmath18 .",
    "the occupation time formula ( theorem 3.7.1 in  @xcite ) states that @xmath473 almost surely .",
    "let @xmath474 be a continuous function which is @xmath188 except in @xmath475 $ ] and which admits finite limits @xmath476 and @xmath477 , @xmath478 .",
    "then the it - tanaka formula for continuous semimartingales ( see theorem 3.7.1 and problem 3.6.24 in  @xcite ) states that @xmath479 } } }    \\end   { split}\\ ] ] almost surely .    for every @xmath480 , let @xmath481 be a continuous function which is equal to @xmath362 in @xmath482 and which is constant both in @xmath483 $ ] and in @xmath484 $ ] .",
    "in addition , suppose that @xmath485 approximates @xmath362 uniformly in @xmath0 $ ] and that @xmath486 approximates @xmath487 pointwise and boundedly in @xmath44 .",
    "note that @xmath488 comparing the occupation time formula   of @xmath489 with the occupation time formula   of @xmath471 we see that @xmath490 now applying the it - tanaka formula   to @xmath491 and inserting  , we arrive at @xmath492 note that the lebesgue measure of @xmath493 is equal to zero almost surely . letting @xmath494 in   completes the proof .",
    "recall @xmath143 , @xmath327 and @xmath316 from section  [ sec : the generator of the time - reversed process ] .",
    "lemma  [ l : generator_backward_process ] shows that the generator of the time - reversed process is the closure of @xmath143 .",
    "therefore it remains to be shown that the generator of the markov process @xmath99 restricted to the set @xmath316 coincides with @xmath143 , that is , that @xmath495 holds for all @xmath85 $ ] and every @xmath358 .",
    "recall @xmath496 for @xmath117 from section  [ sec : main_result ] .",
    "fix @xmath358 and note that @xmath362 is @xmath188 in @xmath44 .",
    "using it s formula , it is straightforward to show that the convergence in   holds for every @xmath90 if @xmath497 and holds for every @xmath85 $ ] if @xmath498 .",
    "it remains to prove   for @xmath117 if @xmath499 .",
    "starting at @xmath117 , @xmath99 evolves according to a diffusion @xmath467 which is governed by @xmath103 until the first time @xmath5 such that @xmath124 . at that time , the process restarts from an independent random point @xmath500 in @xmath44 with distribution @xmath501 . thus @xmath502}}}}\\\\      & = { { \\ensuremath{\\mathbf{e}}}}^i{{{\\bigl[\\int_0^{{{\\ensuremath{\\tilde{l}}}}_i(t ) }           { { \\ensuremath{\\mathbf{e}}}}^{j_i}{{{\\bigl [ \\psi({{\\ensuremath{\\tilde{p}}}}{{{(t - l)}}})-\\psi(i)\\bigr ] } } }           r_i e^{-r_i l}\\,dl\\bigr]}}}\\\\      & = { { \\ensuremath{\\mathbf{e}}}}^i{{{\\bigl[\\int_0^{{{\\ensuremath{\\tilde{l}}}}_i(t ) }        { { { \\bigl(\\int_0 ^ 1 { { { \\bigl(\\psi(z)-\\psi(i)\\bigr ) } } }          \\frac{1}{\\kappa_i }   w_i(z)\\pi(z)\\,dz+o(t - l)\\bigr ) } } }          r_i e^{-r_i l}\\,dl\\bigr]}}}\\\\      & = { { \\ensuremath{\\mathbf{e}}}}^i{{{\\bigl[1-e^{-r_i { { \\ensuremath{\\tilde{l}}}}_i(t)}\\bigr ] } } }        \\int_0 ^ 1 { { { \\bigl [ \\psi(z)-\\psi(i)\\bigr ] } } }        \\frac{1}{\\kappa_i } w_i(z)\\pi(z)\\,dz          + o{{{\\bigl(t{\\ensuremath{{\\displaystyle \\cdot}}}{{\\ensuremath{\\mathbf{e}}}}^i{{\\ensuremath{\\tilde{l}}}}_i(t)\\bigr)}}}\\\\      & = o(t)+{{\\ensuremath{\\mathbf{e}}}}^i{{{\\bigl[r_i { { \\ensuremath{\\tilde{l}}}}_i(t)\\bigr ] } } }          ( -1)^{i+1 } \\lim_{p\\to i}{{{\\bigl(\\tfrac12 v\\pi\\psi^{'}\\bigr)}}}(p)\\frac{1}{\\lambda\\kappa_i }          + o{{{\\bigl(t{\\ensuremath{{\\displaystyle \\cdot}}}{{\\ensuremath{\\mathbf{e}}}}^i{{\\ensuremath{\\tilde{l}}}}_i(t)\\bigr)}}}\\\\    \\end   { split}\\ ] ] as @xmath438 . in the last step we used the inequality @xmath503 for @xmath504 together with lemma",
    "[ l : lt_is_o_of_sqrt_t ] and @xmath358 .",
    "the local time @xmath505 converges to zero a.s .  as @xmath438 . by the dominated convergence theorem",
    ", this implies that @xmath506 converges to zero as @xmath438 .",
    "thus the last summand on the right - hand side of   is of order @xmath507 .",
    "furthermore lemma  [ l : rate ] implies @xmath508 next we consider the second expectation on the left - hand side of  .",
    "using hlder s inequality we see that @xmath509 } } }      = { { \\ensuremath{\\mathbf{e}}}}^i{{{\\bigl [ { { { \\bigl(1-e^{-r_i { { \\ensuremath{\\tilde{l}}}}_i(t)}\\bigr ) } } }                             { { { \\bigl(\\psi({{\\ensuremath{\\tilde{y}}}}(t))-\\psi(i)\\bigr ) } } }                           \\bigr]}}}\\\\      & \\leq\\sqrt{{{\\ensuremath{\\mathbf{e}}}}^i{{{\\bigl [ { { { \\bigl({{\\ensuremath{\\tilde{l}}}}_i(t)\\bigr)}}}^2\\bigr ] } } } }           \\sqrt{{{\\ensuremath{\\mathbf{e}}}}^i{{{\\bigl [ { { { \\bigl(\\psi({{\\ensuremath{\\tilde{y}}}}(t))-\\psi(i)\\bigr)}}}^2\\bigr ] } } } }      = \\sqrt{o(t)}\\sqrt{o(t)}=o(t )    \\end{split}\\ ] ] where we have applied lemma  [ l : lt_is_o_of_sqrt_t ] .",
    "thus we obtain from the it - tanaka formula   @xmath510 } } }      = o(t)+ { { \\ensuremath{\\mathbf{e}}}}^i { { { { \\bigl[\\psi({{\\ensuremath{\\tilde{y}}}}(t))-\\psi(i)\\bigr ] } } } } \\\\      & = o(t)+t d_{{\\ensuremath{\\tilde{m}}}}d_{{\\ensuremath{\\tilde{s}}}}\\psi(i )          + ( -1)^i \\frac{1}{2}{{\\ensuremath{\\mathbf{e}}}}^i{{{\\bigl[{{\\ensuremath{\\tilde{l}}}}_{i}(t)\\bigr]}}}{\\ensuremath{{\\displaystyle \\cdot}}}d_{{{\\ensuremath{\\tilde{s}}}}}\\psi(i )    \\end{split}\\ ] ] as @xmath438 .",
    "putting  , and   together completes the proof of theorem  [ thm : main_result ] .",
    "we are grateful to tom kurtz , alison etheridge and two anonymous referees for their suggestions and comments on the manuscript ."
  ],
  "abstract_text": [
    "<S> we describe the processes obtained by time reversal of a class of stationary jump - diffusion processes that model the dynamics of genetic variation in populations subject to repeated bottlenecks . assuming that only one lineage survives each bottleneck , the forward process is a diffusion on @xmath0 $ ] that jumps to the boundary before diffusing back into the interior . </S>",
    "<S> we show that the behavior of the time - reversed process depends on whether the boundaries are accessible to the diffusive motion of the forward process . </S>",
    "<S> if a boundary point is inaccessible to the forward diffusion , then time reversal leads to a jump - diffusion that jumps immediately into the interior whenever it arrives at that point . if , instead , a boundary point is accessible , then the jumps off of that point are governed by a weighted local time of the time - reversed process .    </S>"
  ]
}