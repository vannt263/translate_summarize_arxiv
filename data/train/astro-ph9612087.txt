{
  "article_text": [
    "in this very brief review , i discuss several techniques that attempt to mimic the gravitational dynamics of galaxies using @xmath0-body methods .",
    "the collisionless property of these stellar systems demands algorithms that try , as far as possible , to suppress the relaxation caused by @xmath1-type fluctuations in the particle distribution .",
    "the objective therefore is quite different from collisional problems , discussed by hut ( these proceedings ) , in which the interactions between every pair of particles have to be treated as accurately as possible .",
    "my purpose is to emphasize two quite old , but very powerful , methods which i feel are not being fully exploited in much of the current work in the field .",
    "the first is the superior efficiency of particle - mesh ( pm ) techniques over all others that are widely used , which i demonstrate by presenting some timing comparisons of five codes . while efficiency is important , it is not the only factor that determines the choice of code , and i discuss the strengths and weaknesses of each of these methods .",
    "secondly , i wish to underline the advantage of using a quiet start , which i show reduces noise - driven relaxation for a fixed number of particles .",
    "for all the tests reported here , i used a stellar polytrope of index 5 , or plummer sphere , which has the density profile @xmath2 where @xmath3 is the total mass and @xmath4 is a length scale .",
    "a spherical model with an isotropic distribution function of this form is stable ( binney & tremaine 1987 ) .",
    "this mass distribution is not very centrally condensed , making it particularly easy to simulate .",
    "this infinite mass distribution has to be truncated to fit inside a grid ; for all these tests , i therefore restrict the spatial extent of the particles to @xmath5 at the outset , thereby discarding just over 4% of the mass .    -30pt",
    "figure 1 compares the cpu time required to complete one time step using five different methods .",
    "timings are all on a dec alphastation 500/333",
    ".    the methods in this comparison are two pp ( particle - particle ) methods , direct and tree , a basis function expansion method , or sfp ( smooth field - particle ) and a generic pm ( particle - mesh ) code .",
    "the fifth method is based on an expansion in surface harmonics , which has been widely used in the past , and is a hybrid pm+sh . of these , the sfp , pm and pm+sh codes are much easier to vectorize / parallelize than are the pp methods .",
    "the simplest method of all is nbody1 , the least sophisticated of the sequence of direct @xmath0-body codes devised by aarseth ( 1985 ) ; the fortran source is reproduced in an appendix of binney & tremaine ( 1987 ) .",
    "i set the softening length @xmath6 and accuracy parameter @xmath7 .",
    "since the individual time steps for each particle are determined by the adopted accuracy criterion , i have defined the `` time per step '' as one twentieth of the cpu time to reach one dynamical time @xmath8 , which is the time step length i used for all the other codes .",
    "a least - squares fit to the points in this log - log plot has a slope of 2.3 , i.e , steeper than the usually quoted @xmath9 behavior .",
    "the steeper dependence is because the number of close neighbors rises with @xmath0 , which implies that a larger fraction of the particles requires shorter steps , even though the mass of each is correspondingly less .",
    "performance could , of course , be improved by increasing the softening parameter or relaxing the accuracy criterion .",
    "one could justifiably argue that the softening length should be reduced as @xmath0 is increased , a strategy that would steepen the @xmath0 dependence still more .",
    "the rapid increase of cpu time needed with @xmath0 renders this code far too expensive for desirable numbers of particles and more efficient techniques should be used .",
    "the grape machines implement an algorithm that is not very different ; their strategy seems essential for collisional problems which require highly accurate forces , but collisionless problems allow other algorithms to be employed which yield results more efficiently  more than compensating for the advantage of custom built chips .",
    "the line marked `` tree '' indicates timings obtained using hernquist s ( 1987 ) public - domain tree code , which employs the original barnes & hut ( 1986 ) algorithm .",
    "admittedly this may no longer be regarded as a state - of - the - art code , but most recent improvements have been directed towards improving accuracy while running speeds do not appear to have improved significantly .",
    "in fact , the speeds reported by dubinski ( 1996 ) for an @xmath10  k calculation on the t3d using 128 nodes are only some @xmath11 times higher than the extrapolated line in figure  1 , which is for a single processor workstation .",
    "the timings reported in figure 1 are with quadrupole forces included but use the large opening angle @xmath12 , which leads to quite low accuracy",
    ". a more accurate calculation with a smaller opening angle would , of course , take longer .",
    "the slope of the line shown in figure 1 is approximately 1.3 , which is steeper than the predicted @xmath13 .      the pm+sh method i employ has not been described elsewhere .",
    "it sits between the fully particle - based approach used by villumsen ( 1982 ) , white ( 1983 ) and mcglynn ( 1984 ) and the fully grid - based method used by van albada ( 1982 ) .",
    "i tabulate the set of active coefficients for the expansion of the potential at a number of fixed radii ( a mesh ) and derive the acceleration applied to each particle from linearly interpolated values of these coefficients at the radius of the particle .",
    "there is no need to sort particles and there is no gridding in the non - radial directions .",
    "the radii of grid points can be more closely spaced near the center and there should be many particles between successive grid points .",
    "with this scheme , the cpu time rises linearly with @xmath0 and is virtually independent of the number of radial grid points for fixed @xmath14 .",
    "the timings shown in figure 1 are for @xmath15 with 201 radial grid points .",
    "the line marked sfp in figure 1 is for a basis function expansion method .",
    "it was obtained using hernquist s so - called scf code , but i prefer the acronym sfp ( smooth field - particle ) , since all @xmath0-body codes have self - consistent fields .",
    "hernquist & ostriker ( 1992 ) derive a new basis , but otherwise their algorithm is identically that first proposed by clutton - brock ( 1972 , 1973 ) .",
    "as advertized , the slope of the line in this plot is precisely unity when the number of functions is held fixed .",
    "the data in figure 1 were obtained using the clutton - brock ( 1973 ) basis , employing radial functions @xmath16 and an angular expansion up to @xmath15 .",
    "one could reasonably argue that more functions should be employed as @xmath0 rises , which would steepen the slope . unlike the method described in  2.3 ,",
    "this method becomes more time consuming as the radial resolution is increased , since more functions need to be evaluated .    at the end of his paper , clutton - brock ( 1972 )",
    "conceded that the sfp method was not competitive , in terms of raw speed , with the fourier grid methods which were then emerging , a conclusion that has not changed in the subsequent almost two and a half decades .",
    "-30pt      the curve marked `` @xmath17 grid '' shown in figure 1 results from a cartesian pm code with this number of grid cells .",
    "it incorporates james s ( 1977 ) poisson solver which represents the only significant algorithmic improvement since the first 3-d grid results reported by hockney & brownrigg ( 1974 ) .",
    "it is clear from the near horizontal portion of the line at small @xmath0 that the calculation time is dominated by the field determination except for very large @xmath0 . in fact the slope is still well below linear at the last point which is for @xmath18 m . the dominance of the field calculation part leads to similar @xmath0-dependence for grids of other geometries .",
    "figure 2 illustrates how the @xmath0-independent field calculation time varies with the size of grid employed .",
    "timings are both for james s poisson solver and my own 3-d cylindrical polar grid ( sellwood & valluri 1997 ) , which differs only in details from that described by pfenniger & friedli ( 1993 ) .",
    "the potential returned on the cartesian grid has the full resolution in all three dimensions afforded by each grid .",
    "the forces determined on the polar grid , on the other hand , have azimuthal harmonics restricted to @xmath19 only .",
    "the polar grid is clearly more time consuming , but has the compensating advantage of offering higher spatial resolution near the symmetry axis , where the density of particles is generally greatest .",
    "other grid geometries are clearly possible .",
    "van albada ( 1982 ) used a spherical grid to follow mildly aspherical collapses with spectacular radial resolution . to have conducted such simulations on a fixed cartesian grid with any degree of validity",
    "would have required an impossibly large number of cells .",
    "the moral here is that when resolution demands a huge grid , then a different grid geometry would probably be more appropriate .",
    "adaptive mesh refinement has been shown at this meeting to be highly successful for other applications .",
    "many adaptive pm codes have been described in the recent literature , most of them devised for the problem of cosmological structure formation in which many dense regions develop at random locations on the main grid ; they seem ideally suited to the intended application ( e.g.  couchman , these proceedings ) .",
    "i have not yet found a need for such a method to follow the global dynamics of an isolated galaxy , preferring instead to tailor the grid to the mass distribution under study .",
    "of course , an adaptive refinement strategy on a cartesian grid would be immensely superior to a fixed grid for the collapse problems studied by van albada , yet his well - chosen spherical grid required no adaptivity and remarkably few mesh cells .",
    "while raw cpu speed is clearly an important factor when determining which code to employ for a problem , the physical properties of the model to be studied may render a less efficient code more appropriate .",
    "the principal disadvantage of eulerian pm codes is that the fixed volume and geometry of the mesh make them unsuited to following wholesale rearrangements of the mass distribution , as occur during major galaxy mergers , for example .",
    "this same inflexibility means that different grids are required for different problems .",
    "as these codes are already more complex than pp codes , the need to rewrite for a new grid is a further significant handicap .",
    "furthermore , grid codes generally require a few hundred mb of memory in addition to that needed to store the particle coordinates .",
    "finally , choosing an interpolation scheme that will best hide the discrete nature of the grid is a `` black art '' ; fortunately this problem has been studied in great detail by the plasma physicists , who employ similar codes , and the theory behind the various strategies has been developed at some length ; see e.g. , birdsall & langdon ( 1991 ) . nevertheless , it is not possible to hide the grid completely , and there are some delicate problems for which grid effects are intolerably large .",
    "for example , my attempts to study fully three dimensional warped disks have been compromised by the tendency for a thin flat disk inclined at an angle to the grid planes to experience a weak torque from the grid that causes it to precess and to try to align with the grid planes . until this tendency can be effectively removed ,",
    "a grid method simply can not be used for this problem .",
    "fortunately , serious problems of this kind are rare .    a common , but generally misdirected , criticism of grid methods is that they lack spatial resolution .",
    "it has to be admitted that cartesian grids can not handle steep density gradients , but other grid geometries can ( c.f .",
    "van albada 1982 and the pm+sh code described in  2.3 ) .",
    "furthermore , should problems be identified for which a single fixed grid can not resolve high density regions , one could resort to adaptive mesh refinement , at the cost of some extra software effort .",
    "the criticism that current grid methods are inflexible and can not follow major rearrangements of the mass distribution can be applied _ a fortiori _ to sfp methods .",
    "( 1996 ) extension of the sfp technique to a dynamically changing basis attempts to remedy this inflexibility .",
    "nevertheless , the form of the potential that can be represented by the few hundred terms employed in typical sfp implementations is much more restricted than can be represented on a grid of some million separate mesh points .",
    "( see also  4.1 . )    both surface harmonic methods , and sfp codes in which the non - radial part of the basis uses an expansion in @xmath20 functions , are ill - suited to mass distributions , such as disks , that are far from spherically symmetric .",
    "basis function expansions are best suited to simulations in which only very minor changes in the mass distribution occur .",
    "in fact , earn & sellwood ( 1995 ) found the method to be ideal for following the linear growth of instabilities , where the mass distribution by definition is hardly changing , but to quickly become uncompetitive in the non - linear regime .",
    "lagrangian pp codes , on the other hand , are fully adaptive and can follow arbitrary changes to the mass distribution . however , the cost penalty for not using a grid is so high that pp methods should be regarded as methods of last resort .",
    "in fact , it would be worth considerable effort to develop hybrid or overlapping grids ( or expansion centers ) when the problem warrants , such as have been developed by villumsen ( 1983 ) , or the almost completed effort by weeks ( 1988 ) , for binary galaxies .",
    "particle noise is the major difficulty when modelling collisionless systems . in a simulation with @xmath21k ,",
    "density fluctuations due to shot noise are larger than those in a real elliptical galaxy , say , by factor of @xmath22 .",
    "this problem affects all spatial scales from the importance of two body encounters to global variations .",
    "the implication is therefore that we should try to maximize @xmath0 in order to minimize the noise .",
    "such a strategy places a still higher premium on computational efficiency .      as simulations with sufficient spatial resolution to make meaningful use of billions of particles are still not even remotely possible , some form of smoothing of the density distribution is required .",
    "however desirable smoothing may seem , it must be borne in mind that it is a double - edged sword that yields a _ biased _ estimate of the potential .",
    "the nature of the bias is to limit resolution to the ( effective ) particle size in pp and pm codes , which smooth only locally , and to leave larger scales unsmoothed .",
    "sfp methods , on the other hand , smooth globally but thereby introduce a much more severe form of bias , since density changes that are not represented by the truncated basis have no effect on the potential . the `` _ over_-smoothing '' strategy advocated by weinberg ( 1996 )",
    "reduces the relaxation rate at the cost of further exacerbating the bias .      a quiet start ( sellwood 1983 ) is a strategy for reducing noise without increasing @xmath0 .",
    "it is achieved by distributing the particles smoothly instead of at random .",
    "the use of such techniques in astronomy dates back at least to hnon ( 1968 ) and probably still further in plasma physics .",
    "they have become standard in laying down the initial conditions and perturbation spectrum in cosmological simulations , as first clearly explained by doroshkevich et al .",
    "( 1980 ) , but continue to be largely ignored for galaxies .",
    "figure 3 shows empirical relaxation rates , defined by @xmath23 ^ 2 \\right\\rangle , \\eqno(2)\\ ] ] where @xmath24 is the specific energy of the @xmath25-th particle at time @xmath26 and the angle brackets indicate an average over all particles . in a perfectly collisionless simulation of a stable equilibrium model , each particle would conserve its energy and this rate should be zero .",
    "if the relaxation is caused by shot noise in the particle distribution , we expect @xmath27 ; the mean square changes plotted seem consistent with a slope of @xmath28 .",
    "once again , the data are taken from simulations of the plummer sphere computed , in every case , using the pm+sh method with 201 radial grid points and @xmath29 or 4 .",
    "simulations with particles placed at random initially ( noisy starts ) follow the expected @xmath30 behavior",
    ". models begun with a quiet start , however , relax more slowly  apparently at about the rate for a noisy start with several times the number of particles .",
    "as pointed out by weinberg ( 1993 ) , collective neutral oscillations of the system excited by the random distribution of particles are the most important source of relaxation . in the case of the plummer sphere",
    ", experiments with purely radial forces ( figure 3a ) showed that relaxation is most effectively reduced by suppressing collective radial pulsations of this spherical model .",
    "the most important part of the quiet start strategy in this case is to space several particles ( 10 in this case ) having identical energy and angular momentum components at equal intervals of radial phase .",
    "this strategy reduces the density variations caused by the radial oscillation of randomly selected particles as they pursue their orbits , leading to an impressive reduction in the relaxation rate .",
    "once non - radial forces are included , however , yet more particles are required to reduce the non - radial density variations .",
    "the data in figure 3(b ) were obtained by placing replicas of each independent particle at 72@xmath31 intervals around a circular ring that lies in the plane of that orbit ( normal to its angular momentum vector ) .",
    "all the replica particles lie at a single radius and have equal radial and azimuthal components of velocity and would therefore follow exactly congruent orbits in that plane if the potential were smooth .",
    "this careful set up procedure leads to a relaxation rate that seems to be roughly equivalent to that from a model having several times the number of particles .",
    "the number of particles per ring should exceed @xmath14 , five seem to be adequate when @xmath32 .",
    "the use of 10 rings of 5 particles to smooth both the radial and azimuthal density variations reduces the number of independent orbits by a factor of 50 .",
    "it is therefore desirable to take extra care to select a better - than - random set of orbits ( @xmath33 & @xmath34 values ) from the .",
    "it should be noted that while it is easier to suppress noise by truncating the angular expansion at low order , a similar procedure works well on a 3-d cartesian grid where no angular symmetries are imposed .",
    "again a smooth radial distribution and ten particles per ring produced a very significant reduction in the relaxation rate .",
    "provided the relaxation time greatly exceeds the duration of the experiment , we can regard a simulation as adequately collisionless .",
    "thus in simulations of mergers or collapses , which may need to be followed for only a few dynamical times , relaxation caused by particle noise can be rendered unimportant even with a modest number of randomly placed particles .",
    "quiet starts are therefore advantageous only for initially equilibrium models that are to be evolved in isolation for long periods .",
    "while it remains true that no code is `` best '' for _ every _ problem , pm codes have continued to hold their pre - eminent position as the most efficient and should be considered first for many problems .",
    "pm methods do have a number of drawbacks , principally stemming from the finite volume enclosed by the mesh , and therefore are not appropriate for every problem .",
    "pp methods , on the other hand , are so expensive they should be regarded as an option of last resort for collisionless problems .",
    "i have argued that the resolution limitations of pm methods are generally overstated , since it is often possible to tailor the grid geometry to the problem at hand .",
    "cartesian grids are not the only option , both cylindrical and spherical grids have been used to excellent effect to improve resolution dramatically near the centers .",
    "the moral here is that if attaining satisfactory resolution of the mass distribution of an isolated galaxy seems to require an excessively large number of grid points , then the grid geometry is probably inappropriate . for problems",
    "i have worked on , making this change has seemed more efficient than resorting to adaptive mesh refinement , though this conclusion may not be always true .",
    "my other principal conclusion is that it is rarely necessary to employ many millions of particles for collisionless problems .",
    "i find that @xmath35 is usually adequate and that results with more particles are generally indistinguishable .",
    "the relaxation rate , which clearly should be much slower than the rate of evolution being simulated , can be reduced without increasing @xmath0 simply by employing quiet starts .",
    "* acknowledgments * i would like to thank gerald quinlan for making his copies of nbody1 and hernquist s basis function codes available for timing tests , and for his comments on a draft of this paper . also s.   shandarin pointed out the early reference to quiet starts in cosmology .",
    "this work was supported by nsf grant ast 93/18617 and nasa theory grant nag 5 - 2803 ."
  ],
  "abstract_text": [
    "<S> i compare various popular and unpopular techniques for simulating large collisionless stellar systems . </S>",
    "<S> i give a quantitative comparison of the raw cpu times required for five separate codes , including tree codes and basis function expansions , which demonstrate that grid codes are most efficient for large numbers of particles . since efficiency is only one consideration when choosing a code , i discuss other strengths and weaknesses of the various methods . </S>",
    "<S> while some applications may require the maximum possible number of particles , i argue that quiet start techniques can often permit reliable results to be obtained with moderate particle numbers . </S>",
    "<S> i suggest a quiet start procedure for spherical stellar systems and show that it leads to a significant reduction in the relaxation rate . </S>",
    "<S> the combination of efficient codes and quiet starts allows many galactic dynamical problems to be tackled without the need for supercomputers .    </S>"
  ]
}