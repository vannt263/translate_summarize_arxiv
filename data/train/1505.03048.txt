{
  "article_text": [
    "_ near field communication ( nfc ) _",
    "@xcite is a highly - practical emerging technology  @xcite . indeed ,",
    "nfc - enabled smartphones are being used in several domains , such as payment  @xcite , access control  @xcite and ticketing  @xcite . in the following ,",
    "we focus on mobile ticketing for public transport .",
    "such a ticketing system is operated by a transport authority representing the transport service provider , and it usually consists of three phases  @xcite .",
    "first , the user registers ( _ registration _ ) . secondly , the user obtains the product ( a set of m - tickets ) to be used ( _ provisioning _ ) .",
    "the last phase is the _ validation _ , during which an m - ticket is validated by the transport authority using the nfc connection of a mobile phone . during this phase",
    ", the m - ticketing system must ensure the integrity and authenticity of the m - ticket .",
    "another important aspect is that a network connection  @xcite is sometimes required , either for the validator gate or for the smartphone itself .",
    "moreover , the validation is subject to a hard time constraint imposed by the transport operators  @xcite : the m - ticket validation must occur in less than @xmath2 .    in the literature",
    ", many proposed solutions did not consider the security aspects .",
    "even when security issues are addressed , the concept of user s _ privacy _ , that is users anonymity and users trips unlinkability with respect to the transport service provider , is often overlooked  @xcite .",
    "some recent works  @xcite have shown a special interest in users privacy .",
    "although they managed to ensure user s anonymity , these solutions suffer from privacy weaknesses .    in this paper ,",
    "we propose a new cryptographic protocol for m - ticketing that provides strong authentication , anonymity , and unlinkability properties , whilst remaining efficient when implemented in constrained environments such as sim cards .    towards this goal",
    ", we also make various cryptographic optimizations . in particular",
    ", we present a new efficient set - membership proof enabling a prover to prove , in a zero - knowledge way , that his secret belongs to a given public set . unlike previous constructions",
    ", this proof does not require pairing computations , especially on the prover side , which are quite costly , in the order of seconds , e.g. for the following microprocessors : @xmath3 on an atmega  @xcite , @xmath4 on a philips hipersmartmips  @xcite , @xmath5 on an msp430x  @xcite .",
    "we also propose several optimizations of boneh - boyen signature schemes .",
    "these results are of independent interest and increase the performance and efficiency of bb - signatures .",
    "based on these cryptographic primitives , our m - ticketing protocol enables to securely validate an m - ticket without disclosing any personal information to the transport operator , even if the latter is malicious .",
    "we push forward a strict privacy requirement when using one of the numbered m - tickets : for example , if the user uses the m - ticket number @xmath6 from the set @xmath7 $ ] , the transport operator will only be able to check that the used m - ticket is one among the ten m - tickets @xmath7 $ ] .",
    "we implemented our system on a standard nfc sim card . to the best of our knowledge ,",
    "this is the first implementation of _ efficient _ and _ practical _ set - membership proofs and bb - signatures on sim cards .",
    "the entire validation process can be performed without any connection to a back - end server or computations delegation to the smartphone hosting the sim card .",
    "this avoids any tracking of the user by a malware installed in the smartphone .",
    "we also show that the validation process occurs , on average , in @xmath8 when the mobile is switched on and in @xmath9 when the mobile is switched off or its battery is flat ( battery - off ) .",
    "moreover , we show that our protocol supports the post payment approach ( which provides more flexibility ) and give countermeasures to detect any misuse of the service owing to the regular reports of unused m - tickets .",
    "the paper is structured as follows . section  [ sec : related ] discusses related work on privacy - preserving m - ticketing schemes . in section",
    "[ sec : framework ] , we detail the framework of our m - ticketing protocol . then , we introduce in section  [ sec : req ] our assumptions and the desired security , privacy and functional requirements that an m - ticketing system should fulfil . in section  [ sec : cryp ] , we describe the cryptographic assumptions and building blocks required for the sequel . we introduce our new set - membership proof in section  [ sec : proof ] and our m - ticketing protocol in section  [ sec : sol ] .",
    "section  [ sec : analysis ] gives the security proofs . in section",
    "[ sec : poc ] , we present our implementation before concluding in section  [ sec : conclusion ] .",
    "heydt - benjamin et al . were the first to propose a cryptographic framework for transport service  @xcite .",
    "they discuss the challenges that a privacy - preserving transit system should solve .",
    "using cryptographic transit tickets should not disable basic capabilities like cloning detection , virtual ticket backups or transfers , ticket revocation .",
    "the efficiency of the use of a virtual ticket , especially over the air , is also important .",
    "later , many applied m - ticketing solutions have been proposed  @xcite .",
    "however , each proposal has some limitations that this paper tries to solve .",
    "we briefly describe these limitations in this section .    first , the rsa based m - ticketing solution proposed by ekberg and tamrakar  @xcite , the rfid e - tickets proposed by sadeghi et al .",
    "@xcite and the ticketing solution proposed by blass et al .",
    "@xcite only protect user s privacy with respect to outsiders and not the transport authority .",
    "the transport authority is considered honest which is not anymore a reasonable hypothesis .",
    "second , the most recent protocols that include the expected level of privacy by protecting users privacy even against the transport authority still have some efficiency problems .",
    "for instance , the bbs based protocol proposed by isern - deya et al .",
    "@xcite validates a ticket with a duration of few seconds , even if the implementation has been done on a smartphone .",
    "some recent solutions were close to find the right balance between efficiency and users privacy .",
    "derler et al .",
    "proposal  @xcite provides anonymous tickets but users trips are still linkable .",
    "rupp et al .",
    "proposal  @xcite provides a privacy preserving pre - payment protocol with refund for public transport with a refund verification procedure with a too high cost for constrained devices .",
    "removing this verification makes possible to use the protocol , but it also enables a malicious transport authority to link users trips    , as detailed in appendix  [ appendix : flaw ]    @xcite    .    our m - ticketing protocol tries to fill the remaining gap between efficiency and strong privacy .",
    "it can be used in very constrained devices , like sim cards and offers a high level of privacy .",
    "in privacy - preserving m - ticketing system , we consider three different entities . the user ( u ) is the owner of an nfc - enabled smartphone and wants to use the transport service .",
    "the transport authority ( ta ) is the manager of the transport service .",
    "additionally , we consider a third actor which is a revocation authority ( ra )",
    ". it can revoke m - tickets and users anonymity , and is completely independent of the transport authority .",
    "this role may be split between several authorities in such a way that they should all agree and cooperate before recovering the identity of an m - ticket holder .",
    "an m - ticketing system consists of six different phases in our protocol .",
    "( 1 ) the m - ticketing system parameters and keys are initialized during the _ initialization_. ( 2 ) the _ registration _ phase enables a user to register to the transport service .",
    "( 3 ) in the _ permission token request _",
    "phase , a user gets a _ permission token _ allowing him to generate @xmath10 m - tickets .",
    "( 4 ) the _ validation _ phase consists in generating and validating an m - ticket . ( 5 )",
    "the _ revocation _ phase enables to retrieve the identity of a user who generated a given m - ticket and the m - tickets obtained by a given user . finally , ( 6 ) the _ reporting _ phase enables a user to report his usage ( i.e. the m - tickets that he did not use ) to the transport authority that can detect any duplication of m - tickets ( i.e. m - tickets that have been validated several times ) . in the sequel ,",
    "these phases are modeled with various algorithms and protocols executed by the above entities .",
    "* initialization . *    @xmath11 : this probabilistic algorithm outputs @xmath12 a description of the system parameters .",
    "we assume that @xmath12 are implicit to the other algorithms , and that they include @xmath13 , the security parameter , and @xmath10 , the number of m - tickets that each book / set of m - tickets contains .",
    "they are also an implicit input to the adversary , we will then omit them .",
    "@xmath14(@xmath12 ) : this probabilistic algorithm outputs the two following secret / public key pairs : @xmath15 for the revocation authority and @xmath16 for the transport authority .",
    "the system public key @xmath17 is eventually set as ( @xmath12 , @xmath18 , @xmath19 )",
    ".    * registration . *    @xmath20(@xmath17 , @xmath21 ) : this probabilistic algorithm outputs a secret / public key pair @xmath22 for a user identifier @xmath21 .",
    "@xmath23(@xmath24 ) ) : this is an interactive protocol between a new user that takes as input his identity @xmath21 and his public key @xmath25 , and the ta that takes as input the database @xmath26 where the identifiers of the registered users will be stored .",
    "if ta accepts the protocol , the user s identity and public key are stored within @xmath26 .",
    "* permission token request . *    @xmath27(u@xmath28 , ta@xmath29 ) : this is an interactive protocol between a user that takes as input @xmath30 @xmath31 , and the ta that takes as input @xmath29 .",
    "if the user accepts the protocol , his output is a permission token @xmath32 that will enable him to generate / validate a set of @xmath10 m - tickets .",
    "if ta accepts the protocol , its output is a transcript _ view _ of the protocol .",
    "* validation .",
    "*    @xmath33(@xmath34 ) : this probabilistic algorithm takes as input a user s permission token @xmath32 and outputs an m - ticket @xmath35 with a serial number @xmath36 such that @xmath37 $ ] .",
    "@xmath38(@xmath39 ) : this deterministic algorithm takes as input a ticket @xmath35 .",
    "if @xmath35 is valid , it outputs @xmath40 ( otherwise @xmath41 ) and @xmath35 is stored within the database @xmath42 that will be used to detect the m - tickets that have been used several times .",
    "* revocation . *    @xmath43(@xmath44 , @xmath26 , @xmath35 ) : this deterministic algorithm takes as input the private key @xmath44 , the database @xmath26 and a valid m - ticket @xmath35 .",
    "it outputs the identifier @xmath21 of the user who obtained @xmath35 .",
    "if @xmath21 does not belong to @xmath26 , it outputs @xmath45 .",
    "@xmath46(@xmath44 , _ view _ , @xmath21 ) : this deterministic algorithm takes as input the private key @xmath44 , a user s identifier @xmath21 and a transcript _ view _ of an execution of @xmath27 with this user .",
    "it outputs all the m - tickets that can be generated from the token obtained after the execution of the @xmath27 protocol that led to _",
    "* reporting .",
    "*    @xmath47 : this algorithm is executed by a user with his permission token @xmath32 .",
    "the user generates all the unused m - tickets and collects them in a _ usage report _ @xmath48 .",
    "@xmath48 is then sent to the transport authority .",
    "@xmath49(@xmath50 ) : this deterministic algorithm takes as input @xmath36 the serial number of a valid m - ticket @xmath35 and @xmath42 , and outputs the number of occurrences of @xmath36 in @xmath42 .",
    "in this section , we first describe our trust assumptions .",
    "then , we detail the requirements of our m - ticketing system .",
    "we consider two types of requirements , _ functional _ requirements , which are `` efficiency '' and `` versatility '' and _ security and privacy _ requirements , which consist in `` correctness '' , `` unforgeability '' , `` unlinkability '' and `` non - frameability '' .      at the user s side",
    ", we consider an untrusted mobile platform ( smartphone ) with an incorporated trusted secure element .",
    "we use a sim card as a tamper resistant secure element since it could be certified eal4 +  @xcite . using a sim card",
    "will ensure the integrity of the implementation .",
    "indeed , the m - ticketing cardlet manages the cryptographic credentials of the m - ticketing application and executes required cryptographic computations without delegating any of them to the smartphone .",
    "consequently , if the mobile application is compromised , the security will not be impacted because all the sensitive data and credentials are stored and managed in the sim card . if the sim card gets compromised , we planned countermeasures ( cf .",
    "section  [ subsub : couter ] ) .",
    "m - ticketing systems must fulfil functional requirements imposed by transport operators  @xcite , in particular the validation of an m - ticket must be performed in less than @xmath51 .",
    "we must consider that a sim card has limited computation capabilities .",
    "in particular , pairing apis are not available on current sim cards .",
    "the mobile phone and the validator can not be assumed to be connected to a back - end server during the validation phase .",
    "this enables the user to use an m - ticket in any kind of situation , especially in areas with low connectivity , e.g. , underground , or if the battery of his mobile is flat .",
    "moreover , the m - ticketing system must support the post - payment mode , i.e. , charged later ( after its use ) .      besides the correctness property ( which is obvious )",
    ", we formally define three security and privacy properties of our m - ticketing protocol in which the attack capabilities of a probabilistic polynomial time adversary @xmath52 are modeled by providing him access to some oracles . in the sequel , @xmath53 will denote the set of honest users and @xmath54 the set of corrupted users .",
    "we assume that @xmath52 receives all the exchanged messages in our system .",
    "@xmath52 acts as an active adversary as regards to the messages issued by malicious users and as a passive adversary with respect to honest users .",
    "@xmath55 is an oracle that will be used by an adversary in order to register honest users . by calling this oracle with @xmath21 as argument",
    ", the adversary adds a new user .",
    "the oracle runs @xmath56 and adds @xmath21 ( along with @xmath25 ) to the set @xmath53 .",
    "the private key @xmath57 is kept secret and public key @xmath25 is returned to the adversary .",
    "@xmath58 is an oracle that will be used by an adversary in order to register malicious users .",
    "the adversary calls this oracle with argument the identifier @xmath21 of a user and sets his public key to @xmath25 and his private key to @xmath57 . the identity @xmath21 ( along with @xmath25 ) is added to the set @xmath54 .",
    "@xmath59 is a user secret key oracle enabling the adversary to obtain the private key @xmath57 of a user @xmath60 .",
    "the oracle transfers @xmath21 to @xmath54 and returns @xmath57 .",
    "@xmath61 is an oracle that runs the user s side in the @xmath27 protocol .",
    "this oracle will be used by an adversary playing the role of a malicious ta .",
    "the adversary gives to the oracle an identity @xmath21 of an honest user and his public key @xmath25 .",
    "the adversary is then given a transcript view of the protocol .",
    "@xmath62 is an oracle that runs the transport authority side in the @xmath27 protocol .",
    "this oracle will be used to simulate the execution of the protocol between a user ( corrupted or not ) and an honest ta .",
    "@xmath63 is an oracle that takes as input the identifier @xmath21 of an honest user and a transcript _ view _ of an execution of the @xmath27 protocol with this user and outputs an m - ticket @xmath35 using a fresh index @xmath64 that has not been used in a previous query of @xmath65 on @xmath21 and _ view_. the oracle records ( @xmath21 , @xmath35 ) in a list _ set_.    @xmath66 is an oracle that takes as input the identifier of a user @xmath21 and a transcript _ view _ of an execution of @xmath27 with this user and outputs all the m - tickets that this user is able to generate .",
    "@xmath67 is an oracle that returns the identifier @xmath21 of the user who generated an m - ticket @xmath35 .",
    "@xmath68 is an oracle that takes as input the identifier @xmath21 of an honest user and a transcript _ view _ of a @xmath27 execution with this user and outputs the set of unused m - tickets .",
    "for each unused m - ticket @xmath69 , the oracle records @xmath70 in _",
    "set_.    in the sequel , we denote by @xmath52(_keys _ , _",
    "db _ : _ oracles _ ) an adversary who receives the keys `` _ _ keys _ _ '' .",
    "this adversary has only _ read access _ to the databases `` _ _ db _ _ '' and can query the oracles `` _ _ oracles _ _ '' .      informally speaking",
    ", it should be impossible for anyone to falsely accuse an honest user of having spent an m - ticket .",
    "we formally define the non - frameability experiment @xmath71 in figure  [ fig : nonfra ] .",
    "the scheme is non - frameable , if for any probabilistic polynomial time adversary @xmath52 , the probability + @xmath72[@xmath71=1 ] is negligible .",
    "l +      informally speaking , it should be impossible for anyone ( 1 ) to validate more m - tickets than what he obtained i.e. an adversary who retrieved @xmath73 tokens @xmath32 ( @xmath73 sets of @xmath10 m - tickets ) should not be able to generate more that @xmath74 m - tickets ; ( 2 ) to validate m - tickets such that the algorithm @xmath75 returns @xmath45 , i.e. , an identifier @xmath21 that does nt appear in @xmath26 .",
    "we formally define the unforgeability experiment @xmath76 in figure  [ fig : unf ] .",
    "the scheme is unforgeable if for any probabilistic polynomial time adversary @xmath52 , the probability @xmath77 $ ] is negligible .",
    "l +      informally speaking , it should be impossible , except for the revocation authorities , to trace the m - tickets obtained by a user , in particular : ( 1 ) to link m - tickets obtained during the permission token request phase to the validated / used ones ; ( 2 ) to link two m - tickets validated by the same user or to decide whether two validated m - tickets have the same number / index or not ; ( 3 ) to link validated m - tickets to non - used m - tickets reported by the user to the transport authority . for this",
    ", an adversary has full control over the transport authority ( in particular it owns the private key @xmath78 ) and all the users except two honest users @xmath79 and @xmath80 .",
    "the adversary can initiate the @xmath75 protocol over any m - ticket and can get the user s identity behind it , except for the m - tickets generated by @xmath79 and @xmath80 .",
    "he can also initiate the @xmath81 protocol for all the users except for @xmath79 and @xmath80 .",
    "we define the unlinkability experiment @xmath82 in figure  [ fig : unlink ] .",
    "the scheme is unlinkable if for any probabilistic polynomial time adversary @xmath52 , the advantage @xmath83- 1/2|$ ] is negligible .",
    "l +    * remark : * another basic requirement that our ticketing system should fulfill is the _ traceability _ meaning that revocation should succeed in the face of attacks by malicious users . in fact , our formulations of _ unforgeability _ and _ non - frameability",
    "_ capture this requirement . indeed ,",
    "an attacker who could produce a ticket which either ( 1 ) can not be traced to a user or ( 2 ) identify an honest user who did nt obtain this ticket , would either break the _ unforgeability _ requirement ( 1 ) or the _ non - frameability _ requirement ( 2 ) .",
    "in this section , we introduce the notations , definitions and cryptographic tools used in the description of our set - membership proof and m - ticketing protocol .",
    "we consider throughout this document , except when it is explicitly mentioned , bilinear maps @xmath84 where all groups @xmath85 , @xmath86 and @xmath87 are multiplicative and of prime order @xmath88 .",
    "the mapping @xmath89 satisfies the following properties : @xmath90      * decisional diffie - hellman ( ddh ) .",
    "* for any multiplicative group @xmath91 of prime order @xmath88 , the ddh assumption states that given a random generator @xmath92 , two random elements @xmath93 , @xmath94 in @xmath91 , and a candidate @xmath95 , it is hard to decide whether @xmath96 or not .    *",
    "external diffie - hellman ( xdh ) .",
    "* given three groups @xmath85 , @xmath86 , @xmath87 , and a bilinear map @xmath84 , the xdh assumption states that ddh assumption holds in @xmath85 .",
    "* q - strong diffie - hellman ( q - sdh ) . *",
    "the q - sdh assumption holds for some group @xmath85 if it is hard , given ( @xmath97 , @xmath98 , @xmath99 ) @xmath100 @xmath101 , to output a pair @xmath102 .    * q - decisional diffie - hellman inversion ( q - ddhi ) . * in any multiplicative group @xmath91 of prime order @xmath88 , the q - decisional diffie - hellman inversion assumption states that , given a random generator @xmath92 and the values @xmath103 , for a random @xmath104 and a candidate @xmath95 , it is hard to decide whether @xmath105 or not .    * the decisional composite residuosity assumption .",
    "* there is no probabilistic polynomial time distinguisher for @xmath106-th residues modulo @xmath107 . in other words",
    ", there is no probabilistic polynomial time adversary that can distinguish @xmath108 from @xmath109 , where @xmath110 @xmath111 .",
    "roughly speaking , a zero knowledge proof of knowledge , denoted zkpk , is an interactive protocol during which a prover convinces a verifier that he knows a set of secret values ( @xmath112 ) verifying a given relation @xmath113 without revealing anything else .",
    "such a proof will be denoted in the sequel @xmath114 .",
    "a zkpk should be * complete * ( a valid prover is accepted with overwhelming probability ) , * sound * ( a false prover should be rejected with overwhelming probability ) and * zero - knowledge * ( no information about the secret is revealed ) . these zkpk can be made non - interactive using the generic transformation introduced by fiat and shamir  @xcite . the resulting non - interactive proofs , sometimes called _ signatures of knowledge _",
    "@xcite , can be proven secure in the random oracle model of  @xcite ( see  @xcite ) .",
    "such a signature of knowledge , for the relation @xmath113 , will be denoted @xmath115 .",
    "these signatures , proposed by camesnich and lysyanskaya  @xcite , are equipped with additional protocols .",
    "one of these protocols allows a signature to be issued on messages that are not known by the signer , but for which the signer only knows a commitment .",
    "informally , in a protocol for signing a committed value , we have a signer with public key @xmath116 , and the corresponding secret key @xmath117 , and a user who queries the signer for a signature .",
    "the common input to the protocol is a commitment @xmath118 , known by both parties , on secret values @xmath119 known only by the user . at the end of this protocol , the user obtains a valid @xmath120 and the signer learns nothing about @xmath119 .",
    "another protocol allows to prove knowledge of a signature on a tuple of messages @xmath119 without releasing any information on the corresponding signature .",
    "each message can either be revealed to the verifier , sent in a committed form , or it may be such that the verifier has no information on it . in particular , it is possible to prove the knowledge of a cl - signature on committed values .      a set membership proof allows a prover to prove , in a zero - knowledge way , that his secret lies in a given public set .",
    "such proofs can be used , for instance , in the context of electronic voting , where the voter needs to prove that his secret vote belongs to the set of all possible candidates .",
    "recent propositions of set membership proofs  @xcite follow the same idea : a designated authority produces public signatures on each element of the public set @xmath121 ( and only on these elements ) .",
    "the proof of knowledge of a secret @xmath122 consists in proving the knowledge of a ( public ) signature on the secret @xmath123 ( which will be only possible if @xmath123 belongs to the set @xmath121 ) without revealing @xmath123 or the used signature .",
    "solutions in  @xcite require the prover to perform pairing computations . however , these cryptographic tools are not often convenient for many constrained platforms .",
    "the signature scheme used by the designated authority ( which could be the verifier ) to sign each element of the set @xmath121 is the one proposed by boneh and boyen  @xcite .",
    "based on their scheme , which is secure under the q - sdh assumption , it is possible to prove knowledge of a signature on a message , without revealing the signature nor the message .      having a secret key @xmath124 and two random generators @xmath125",
    ", @xmath126 of @xmath85 , the signature of a message @xmath127 is obtained by computing @xmath128 .",
    "given a bilinear pairing @xmath89 , a signature @xmath129 of @xmath130 is valid if @xmath131 , where @xmath132 is the signer s public key .",
    "let @xmath91 be a cyclic group with prime order @xmath88 where the decisional diffie - hellman ( ddh ) problem is assumed to be hard and @xmath125 , @xmath126 two random generators of @xmath91 .",
    "the signer s private key is @xmath133 and its public key is @xmath134 .",
    "similarly to boneh - boyen signatures with pairings , the signature on a message @xmath130 is the value @xmath135 .",
    "this implies that @xmath136 .",
    "since we work in a group @xmath91 not equipped with a bilinear map , the signer must additionally prove that the signature on @xmath130 is valid , which is done by generating a zkpk @xmath137 that the discrete logarithm of ( @xmath138 ) in the base @xmath139 is equal to the discrete logarithm of @xmath140 in the base @xmath126 : @xmath141 .",
    "such a proof of equality of discrete logarithms has been introduced in  @xcite .",
    "finally , the signature @xmath139 on @xmath130 is valid if the proof @xmath137 is valid .    * theorem 1 . * the boneh - boyen ( bb for short ) signature scheme without pairings is existentially unforgeable under a weak chosen message attack under the q - strong diffie - hellman assumption , in the random oracle model .",
    "* proof ( sketch ) .",
    "* under the q - strong diffie - hellman assumption , it is impossible to find a message @xmath130 ( which was not given to the signing oracle ) and a value @xmath139 such that @xmath142 , as proved in  @xcite .",
    "moreover , in the random oracle model , the proof of knowledge @xmath137 is unforgeable  @xcite , which concludes the proof .",
    "> p0.4- > p0.1 - 2 > p0.5- & & + * public input : * public parameters , sets @xmath121 and @xmath143 & & * public input : * public parameters , sets @xmath121 and @xmath143 + * private input : * @xmath64 & & * private input : * @xmath124 +   +   +   +   +   +   + & @xmath144 & * choose * @xmath145 ( a random challenge ) + & & + & & * check * that @xmath146 + & & @xmath147 if the verifier and the designated entity are the same entity , it implies that the verifier holds the private signature key @xmath124 * ( first case)*. hence the prover does not send the value @xmath148 .",
    "the verifier can compute it : @xmath149 and goes to ( * ) + & & @xmath147 otherwise , if the verifier does nt know the private signature key @xmath124 * ( second case ) * , then , it checks that @xmath150 and goes to ( * ) + & & * ( * ) compute : * @xmath151 and @xmath152 + & & * check * that : @xmath153 +      the el gamal cryptosystem  @xcite works as follows .",
    "let @xmath91 be a cyclic group with prime order @xmath88 where the decisional diffie - hellman ( ddh ) problem is assumed to be hard .",
    "the public key consists of the elements @xmath154 , where @xmath155 is a random generator of @xmath91 , and the corresponding private key is formed by @xmath156 .",
    "the el gamal ciphertext of a message @xmath157 is @xmath158 , where @xmath159 is a random number .",
    "the decryption of the ciphertext @xmath160 is obtained through the following computation : @xmath161 .",
    "the el gamal cryptosystem is semantically secure under the ddh assumption .",
    "the paillier cryptosystem  @xcite works as follows .",
    "let @xmath162 and @xmath163 be random primes for which @xmath164 and @xmath165 .",
    "let @xmath166 , @xmath167 , @xmath168 , and @xmath169 .",
    "the public key is @xmath170 and the secret key is @xmath171 . to encrypt @xmath172 , the user chooses @xmath173 and @xmath174 .",
    "the decryption algorithm is given by @xmath175 .",
    "the paillier cryptosystem is secure under the decisional composite residuosity assumption .    in a threshold version , the el gamal public key and its corresponding private key  @xcite ( resp .",
    "the paillier public key and its corresponding private key  @xcite ) are cooperatively generated by @xmath106 parties ; however , the private key is shared among the parties . in order to decrypt a ciphertext ,",
    "a minimal number of @xmath176 ( the threshold ) out of @xmath106 parties is necessary .",
    "a useful building block of our m - ticketing protocol is the pseudo - random function introduced by dodis and yampolskiy  @xcite .",
    "their construction works as follows .",
    "let @xmath91 be a cyclic group with prime order @xmath88 , @xmath177 a generator of @xmath91 , @xmath178 a private secret .",
    "the pseudo - random function ( prf for short ) @xmath179 takes as input a message @xmath180 and outputs @xmath181 .",
    "this construction is secure under the q - ddhi assumption in @xmath91 .",
    "in this section , we present a new set membership protocol . our set membership proof is a zkpk which allows the prover to convince any verifier that the committed integer @xmath64 lies in the public discrete set @xmath121 .",
    "this zkpk can be made non - interactive using the fiat - shamir heuristic and the random oracle model  @xcite .",
    "the commitment scheme that we use is the one proposed by pedersen  @xcite .",
    "our set membership proof bears some similarities with the protocol proposed by camenisch et al .",
    "@xcite . yet",
    ", our set membership proof does not ask the prover ( a sim card and/or a smartphone in our setting ) nor the verifier ( in a specific scenario ) to perform pairing computations .",
    "our set membership proof is also more efficient and conceptually simpler than the recent one proposed by canard et al . at europki 2013  @xcite .",
    "their scheme which involves several verifiers , who share a decryption key , seems to be tailored to specific applications such as e - voting where the verifiers ( tallying authorities ) own such a key to open ballots .",
    "let @xmath85 , @xmath86 and @xmath87 be three ( multiplicative ) bilinear groups of prime order @xmath88 and a bilinear map @xmath84 .",
    "let @xmath182 and @xmath183 be three generators of @xmath85 and consider a generator @xmath184 of @xmath86 .",
    "a designated authority ( which may or may not be the verifier ) randomly chooses a value @xmath185 ( its private key ) and publishes the corresponding public key @xmath186 . after generating its key",
    ", this designated authority can issue bb - signatures on each element of the public set @xmath121 .",
    "let @xmath64 denote an element of the set @xmath121 and @xmath187 the bb - signature on the value @xmath64 , i.e. , @xmath188 .",
    "the set of all message - signature pairs @xmath189 , that we denote by @xmath143 , is published by the designated authority .",
    "@xmath190 will denote a hash function , for instance , sha-256 .",
    "in figure  [ tab : proof ] , we propose a protocol enabling to prove that the value @xmath64 committed by the prover in the commitment @xmath191 belongs to the set @xmath121 which comes down to proving knowledge of the bb - signature @xmath187 .",
    "* remark 1 : * proving knowledge of a valid bb - signature @xmath188 on a value @xmath64 committed in @xmath192 , without revealing neither @xmath64 nor the signature and without using pairings on the prover s side can be done as follows .",
    "the prover first randomizes @xmath187 by choosing a random value @xmath193 and computes @xmath194 .",
    "since @xmath188 this implies that @xmath195 and then that @xmath196 .",
    "it implies , if we note @xmath197 and @xmath198 that @xmath199 .    as a result , in order to prove that the value @xmath64 committed in @xmath191 belongs to the set @xmath121 , the prover just has to send @xmath200 and @xmath148 to the verifier and compute the following zkpk : @xmath201 .",
    "the computation of the zkpk @xmath202 is described in figure  [ tab : proof ] .    upon receiving @xmath202 , the verifier proceeds to the verification .",
    "we distinguish two cases . in the _ first _ case , the verifier and the designated authority are the same .",
    "thus , the verifier holds the private signature key @xmath124 .",
    "consequently , the verification of @xmath202 occurs without requiring any pairing computations .",
    "this implies that our set membership proof does not require pairing computations for either the prover or the verifier . in the _ second _",
    "case , the verifier does not have the private signature key @xmath124 of the designated authority .",
    "then , the verifier needs to perform some pairing computations in order to verify @xmath202 .",
    "nevertheless , the prover still has no pairing computations to perform .",
    "this is particularly interesting for the m - ticketing use case .",
    "* theorem 2 . *",
    "if the @xmath203sdh assumption holds , then the protocol in figure  [ tab : proof ] is a zero - knowledge argument of set membership for a set @xmath121 .",
    "the proof is in appendix  [ appendix : proof2 ] .",
    "this section begins with an overview of our protocol which main notations are summarized in table  [ tab : notation ] , before moving to our m - ticketing protocol and its post - payment aspects .",
    ".notation used in the m - ticketing protocol [ cols= \" < , < \" , ]      in a post - payment approach , the m - ticketing application must report unused m - tickets to the back - end server , before the pre - defined @xmath148 day .",
    "thus , the regular reports does not question the privacy of the user .",
    "the following example gives further clarification .",
    "suppose that the user retrieved a permission token of @xmath204 m - tickets .",
    "before @xmath148 day , he used 4 m - tickets , i.e. , m - tickets number 1 , 2 , 3 and 4 .",
    "on @xmath148 day , the m - ticketing application will report to the back - end server the m - ticket number 5 using a network connection .",
    "the report contains @xmath205 = @xmath206 and the proof @xmath207)$ ] .",
    "regularly revealing the unused m - tickets enables the transport authority to ( 1 ) charge the user , ( 2 ) check the reliability and accuracy of the reports without questioning the user s privacy .",
    "indeed , the unlinkability of user s m - tickets @xmath208 , both during the use of the service and during the reporting phase , is ensured owing to the q - ddhi and ddh assumptions ( cf .",
    "_ unlinkabililty _ proof ) .      a malicious user s goal simply consists on not paying or paying less than what he is supposed to . to do so",
    ", he may try to block the reporting or attack the cardlet of the sim .",
    "if the user blocks network communications in order to block reporting , the sim cardlet will refuse to issue m - tickets for a permission token after reaching the limit of @xmath10 , or the limit of the time window controlled by @xmath209 .",
    "this countermeasure @xmath118 relies on the security of the sim card .",
    "if the user performs a successful physical attack against the sim card , which is extremely difficult  @xcite , he may try to ( 1 ) defeat the countermeasure @xmath118 and never do reports , or ( 2 ) use the same m - ticket several times or ( 3 ) report a used m - ticket .",
    "this will be detected in @xmath42 and ta can decide to break the user s anonymity and retrieve all his m - tickets usage history .",
    "thus , the user is forced to report his consumption and renew his permission token lest the service is unusable or ta breaks his anonymity .",
    "note that forging an m - ticket is not possible , even with a compromised sim because of the _ unforgeability _ property .",
    "we prove that our m - ticketing protocol provides the security and privacy properties defined in section  [ sub : secmodel ] .    * theorem 4 ( non - frameability ) . *",
    "our m - ticketing protocol is non - frameable , in the random oracle model , under the q - ddhi assumption .",
    "the proof is detailed is appendix  [ appendix : proofs ]",
    ".    * theorem 5 ( unforgeability ) . *",
    "our m - ticketing protocol satisfies the unforgeability requirement , in the random oracle model , under the q - sdh assumption .",
    "the proof is detailed is appendix  [ appendix : proofs ]",
    ".    * theorem 6 ( unlinkability ) . *",
    "our m - ticketing protocol satisfies the unlinkability requirement , in the random oracle model , under the q - ddhi and ddh assumptions .",
    "the proof is detailed is appendix  [ appendix : proofs ] .    because of space limitation",
    ", the proof of theorem  6 is omitted from this paper but is detailed in the extended version  @xcite .",
    "we implemented the user side of our solution on a sim card and the validator side in a regular pc ( cf .",
    "appendix  [ appendix : param ] ) .",
    "we used a 256-bit barreto - naehrig curve  @xcite over @xmath210 since this family of curves provides an optimal size for @xmath211 and @xmath212 while preventing the mov attack  @xcite due to their embedding degree of 12 .",
    "@xmath213 is the group of @xmath210 - rational points of order p and @xmath214 is the subgroup of trace zero points in @xmath215 $ ] .",
    "our pairing is of type-3  @xcite .",
    "more details are given in appendix  [ appendix : param ] .",
    "* pre - computations . *",
    "the pre - computations for preparing one signature occurs in @xmath216 .",
    "it consists in computing elements involved in proving that the user knows a valid signature on his secret @xmath217 .",
    "the total size of the elements that the card has to store for one signature is @xmath218 ( 24 @xmath219 elements , @xmath220 compressed points and one digest output ) .    * validation phase .",
    "* table  [ tab : timing ] gives timings ( average over 50 trials and standard deviation between parentheses ) for the whole validation protocol which includes the validator authentication , the signature generation and an m - ticket verification .",
    "the timings include as well the nfc exchanges duration .",
    "we denote by `` battery - off '' a powered - off phone either by the user , or because the battery is flat . in this situation ,",
    "as stated by nfc standards , nfc - access to the sim card is still possible , but with degraded performances .    regarding the validator authentication , we chose to use rsa with a @xmath221 bits key ( this is the greatest size supported by the sim card ) and a short public verification exponent @xmath222 ( @xmath223 ) .",
    "the validator asks the card for a challenge ( @xmath224 ) .",
    "then , he sends back his response to this challenge , his own challenge ( @xmath225 ) ( @xmath226 bytes ) and the current date ( @xmath227 ) ( @xmath228 bytes ) .",
    "the column `` card signature '' gives the duration of real - time computations of a signature ( computing an m - ticket @xmath36 , @xmath229 and @xmath202 ) and the nfc communication time .",
    "the considered operations for generating the signature are only one hash value and lightweight operations in @xmath219 .",
    "the size of the computed signature is @xmath230 ( sent by 4 apdus ) . regarding the communication between a sim card and a reader , it is slow ( @xmath231 ) , but the whole process ( signature+nfc ) remains very fast , i.e. , @xmath232 on average .    for the signature verification by the validator , we distinguish two cases : the validator holds the private signature keys ( @xmath124 , @xmath233 ) , or not .",
    "the extra pairing computations performed in the second case do not add an important delay to the verification because a regular desktop pc can efficiently achieve such computations .    in total , the m - ticket validation occurs for the first case ( without pairing at the verifier side ) in @xmath0 on average and in @xmath234 for the second case ( with pairing at the verifier side ) .",
    "when the battery is flat , the validation occurs in at most @xmath235 on average .",
    "in this paper , we proposed various cryptographic enhancements : ( 1 ) optimizations of bb - signature schemes and ( 2 ) a new set - membership proof that does not require pairing computations at the prover side .",
    "these contributions enable to design efficient protocols over nfc . then , based on these cryptographic primitives , we designed a secure m - ticketing protocol that prevents a malicious transport authority from linking users trips .",
    "moreover , as the entire computations are done within the sim card , we enhance the user s privacy with regards to a compromised smartphone . owing to regular reports of unused m - tickets ,",
    "the user is able to securely post - pay for his m - tickets without disclosing any information about the performed trips .",
    "moreover , we planned countermeasures against m - ticket cloning and multiple usage . finally , we prove that our protocol is completely off - line and efficient : the validation occurs in @xmath0 and in @xmath1 when the battery is flat .    10    p.  s. barreto and m.  naehrig . .",
    "in b.  preneel and s.  tavares , editors , _ selected areas in cryptography _ , volume 3897 of _ lncs _ , pages 319331 .",
    "springer berlin heidelberg , kingston , on , canada , 2006 .",
    "bellare , namprempre , pointcheval , and semanko .",
    "the one - more - rsa - inversion problems and the security of chaum s blind signature scheme .",
    ", 16(3):185215 , 2003 .",
    "doi : http://dx.doi.org/10.1007/s00145-002-0120-1[10.1007/s00145-002-0120-1 ] .",
    "m.  bellare and p.  rogaway . .",
    "in _ 1st acm conference on computer and communications security _ , ccs 93 , pages 6273 , fairfax , virginia , usa , 1993 .",
    "tickets , fares and route maps .",
    "http://www.berlin.de/en/public-transportation/1772016-2913840-tickets-fares-and-route-maps.en.html .",
    "blass , a.  kurmus , r.  molva , and t.  strufe . .",
    ", 36(4):468480 , 2013 .",
    "doi : http://dx.doi.org/10.1016/j.comcom.2012.10.012[10.1016/j.comcom.2012.10.012 ] .",
    "d.  boneh and x.  boyen . .",
    "in c.  cachin and j.  l. camenisch , editors , _ advances in cryptology - eurocrypt 2004 _ , volume 3027 of _ lncs _ , pages 5673 .",
    "springer berlin heidelberg , interlaken , switzerland , 2004 .",
    "d.  boneh and x.  boyen . .",
    ", 21(2):149177 , 2008 .",
    "doi : http://dx.doi.org/10.1007/s00145-007-9005-7[10.1007/s00145-007-9005-7 ] .",
    "d.  boneh , x.  boyen , and h.  shacham . .",
    "in m.  franklin , editor , _ advances in cryptology - crypto 04 _ , volume 3152 of _ lncs _ , pages 4155 .",
    "springer berlin heidelberg , santa barbara , california , usa , 2004 .",
    "j.  camenisch , r.  chaabouni , and a.  shelat . .",
    "in j.  pieprzyk , editor , _ advances in cryptology - asiacrypt 2008 _ , volume 5350 of _ lncs _ , pages 234252 .",
    "springer berlin heidelberg , melbourne , australia , 2008 .",
    "j.  camenisch and a.  lysyanskaya . .",
    "in m.  franklin , editor , _ advances in cryptology - crypto 04 _ , volume 3152 of _ lncs _ , pages 5672 .",
    "springer berlin heidelberg , santa barbara , california , usa , 2004 .",
    "j.  camenisch , j .-",
    "m . piveteau , and m.  stadler . .",
    "3rd acm conference on computer and communications security _ , ccs 96 , pages 8894 , new delhi , india , 1996 .",
    "s.  canard , i.  coisel , a.  jambert , and j.  traor . . in s.",
    "katsikas and i.  agudo , editors , _ public key infrastructures , services and applications _ , volume 8341 of _ lncs _ , pages 4764 .",
    "springer berlin heidelberg , egham , uk , 2014 .",
    "r.  chaabouni , h.  lipmaa , and b.  zhang . . in a.",
    "keromytis , editor , _ financial cryptography and data security _ ,",
    "volume 7397 of _ lncs _ , pages 179199 .",
    "springer berlin heidelberg , kralendijk , bonaire , 2012 .",
    "d.  chaum and t.  p. pedersen . .",
    "in e.  f. brickell , editor , _ advances in cryptology - crypto 92 _ , volume 740 of _ lncs _ , pages 89105 , santa barbara , california , usa , 1993 .",
    "springer berlin heidelberg .",
    "s.  chaumette , d.  dubernet , and j.  ouoba . .",
    "in s.  balandin , y.  koucheryavy , and h.  hu , editors , _ the 11th international conference on next generation wired / wireless networking _ , volume 6869 of _ lncs _ , pages 165177 , st .",
    "petersburg , russia , 2011 .",
    "springer berlin heidelberg .",
    "d.  derler , k.  potzmader , j.  winter , and k.  dietrich . .",
    "in l.  chen , m.  yung , and l.  zhu , editors , _ trusted systems _",
    ", volume 7222 of _ lncs _ , pages 6683 , beijing , china , 2012 .",
    "springer berlin heidelberg .",
    "y.  g. desmedt and y.  frankel . threshold cryptosystems . in g.",
    "brassard , editor , _ advances in cryptology - crypto 89 _ , volume 435 of _ lncs _ , pages 307315 , santa barbara , california , usa , 1989 .",
    "springer berlin heidelberg .",
    "a.  devegili , m.  scott , and r.  dahab . .",
    "in t.  takagi , t.  okamoto , e.  okamoto , and t.  okamoto , editors , _ pairing - based cryptography - pairing 2007 _ , volume 4575 of _ lncs _ , pages 197207 .",
    "springer berlin heidelberg , tokyo , japan , july 2007 .",
    "a.  dmitrienko , a .- r .",
    "sadeghi , s.  tamrakar , and c.  wachsmann . .",
    "in s.  katzenbeisser , e.  weippl , l.  camp , m.  volkamer , m.  reiter , and x.  zhang , editors , _ trust and trustworthy computing _ , volume 7344 of _ lncs _ , pages 219238 .",
    "springer berlin heidelberg , vienna , austria , 2012 .",
    "y.  dodis . .",
    "in y.  desmedt , editor , _ public key cryptography - pkc 2003 _ , volume 2567 of _ lncs _ , pages 117 .",
    "springer berlin heidelberg , miami , fl , usa , 2003 .",
    "y.  dodis and a.  yampolskiy . .",
    "in s.  vaudenay , editor , _ public key cryptography - pkc 2005 _ , volume 3386 of _ lncs _ , pages 416431 .",
    "springer berlin heidelberg , diablerets , switzerland , 2005 .",
    "ekberg and s.  tamrakar . .",
    "in l.  chen , m.  yung , and l.  zhu , editors , _ third international conference on trusted systems _ , volume 7222 of _ lncs _ , pages 4865 , beijing , china , 2012 .",
    "springer berlin heidelberg .",
    "t.  el  gamal . .",
    "in g.  r. blakley and d.  chaum , editors , _ advances in cryptology - crypto 84 _ , volume 196 of _ lncs _ , pages 1018 , santa barbara , california , usa , 1985 .",
    "springer berlin heidelberg .",
    "m.  eznack , j .-",
    "warry , c.  loiseaux , g.  dufay , r.  atoui , n.  herbreteau , j.  pieniazek , and f.  thabaret . .",
    "http://www.ssi.gouv.fr/img/certificat/anssi-cc-cible_pp-2010-04en.pdf , june 2010 .",
    "a.  fiat and a.  shamir . .",
    "in a.  m. odlyzko , editor , _ advances in cryptology - crypto 86 _ , volume 263 of _ lncs _ , pages 186194 , santa barbara , california , usa , 1987 .",
    "springer berlin heidelberg .",
    "p.  fouque and j.  stern .",
    "fully distributed threshold rsa under standard assumptions . in c.",
    "boyd , editor , _ advances in cryptology - asiacrypt 2001 _ , volume 2248 of _ lncs _ , pages 310330 , gold coast , australia , 2001 .",
    "springer berlin heidelberg .    .",
    "http://www.frost.com/sublib/display-report.do?id=9843-00-13-00-00 , january 2011 .",
    "g.  fuchsbauer , d.  pointcheval , and d.  vergnaud . .",
    "in j.  garay , a.  miyaji , and a.  otsuka , editors , _ cryptology and network security _ , volume 5888 of _ lncs _ , pages 226247 .",
    "springer berlin heidelberg , kanazawa , japan , 2009 .",
    "s.  d. galbraith , k.  g. paterson , and n.  p. smart . .",
    ", 156(16):31133121 , 2008 .",
    "doi : http://dx.doi.org/10.1016/j.dam.2007.12.010[10.1016/j.dam.2007.12.010 ] .",
    "r.  gennaro , s.  jarecki , h.  krawczyk , and t.  rabin . .",
    "in m.  joye , editor , _ topics in cryptology - ct - rsa 2003 _ , volume 2612 of _ lncs _ , pages 373390 .",
    "springer berlin heidelberg , san francisco , ca , usa , 2003 .",
    "c.  p.  l. gouva , l.  b. oliveira , and j.  lpez . .",
    ", 2(1):1929 , 2012 .",
    "doi : http://dx.doi.org/10.1007/s13389-012-0029-z[10.1007/s13389-012-0029-z ] .    . .",
    "september 2012 .",
    "t.  s. heydt - benjamin , h .- j .",
    "chae , b.  defend , and k.  fu . .",
    "in g.  danezis and p.  golle , editors , _",
    "6th international conference on privacy enhancing technologies - pet06 _ , volume 4258 of _ lncs _ , pages 119 , cambridge , uk , 2006 .",
    "springer berlin heidelberg .",
    "e.  hufschmitt and j.  traor . .",
    "in t.  takagi , t.  okamoto , e.  okamoto , and t.  okamoto , editors , _ pairing - based cryptography - pairing 2007 _ , volume 4575 of _ lncs _ , pages 268292 , tokyo , japan , july 2007 .",
    "isern - deya , a.  vives - guasch , m.  mut - puigserver , m.  payeras - capella , and j.  castella - roca . .",
    ", 56(10):11981215 , apr .",
    "doi : http://dx.doi.org/10.1093/comjnl/bxs033[10.1093/comjnl/bxs033 ] .    . .",
    "a.  menezes , s.  vanstone , and t.  okamoto . .",
    "23rd annual acm symposium on theory of computing - stoc 91 _ , pages 8089 , new orleans , louisiana , usa , 1991 .",
    "moscow . http://moscow.ru",
    "/ fr / guide / trip_planning / inner_transport / transport / metro/.    . .",
    "http://nfc-forum.org/wp-content/uploads/2013/12/nfc-in-public-transport.pdf , 2011 .",
    "p.  paillier . .",
    "in _ second international workshop on practice and theory in public key cryptography , pkc 99 _ , volume 1560 of _ lncs _ , pages 223234 , kamakura , japan , mar .",
    "springer berlin heidelberg .",
    "t.  pedersen . . in j.  feigenbaum , editor , _ advances in cryptology - crypto 91",
    "_ , volume 576 of _ lncs _ , pages 129140 .",
    "springer berlin heidelberg , 1992 .",
    "d.  pointcheval and j.  stern . .",
    "in u.  maurer , editor , _ advances in cryptology - eurocrypt 96 _ , volume 1070 of _ lncs _ , pages 387398 .",
    "springer berlin heidelberg , saragossa , spain , 1996 .",
    "d.  pointcheval and j.  stern .",
    "security arguments for digital signatures and blind signatures .",
    ", 13(3):361396 , 2000 .",
    "doi : http://dx.doi.org/10.1007/s001450010003[10.1007/s001450010003 ] .",
    "a.  rupp , g.  hinterwlder , f.  baldimtsi , and c.  paar . .",
    "sadeghi , editor , _ financial cryptography and data security _ ,",
    "volume 7859 of _ lncs _ , pages 205212 .",
    "springer berlin heidelberg , okinawa , japan , 2013 .",
    "a.  sadeghi , i.  visconti , and c.  wachsmann . .",
    "in c.  bettini , s.  jajodia , p.  samarati , and x.  s. wang , editors , _ international workshop on privacy in location - based applications - pilba 2008 _ , volume 397 , malaga , spain , oct . 2008 . ceur .    c.  schnorr . . , 4(3):161174 , 1991",
    "doi : http://dx.doi.org/10.1007/bf00196725[10.1007/bf00196725 ] .    .",
    "proximity mobile payments : leveraging nfc and the contactless financial payments infrastructure .",
    "http://www.smartcardalliance.org/resources/lib/proximity_mobile_payments_200709.pdf , 2007 .",
    "szczechowiak , l.  oliveira , m.  scott , m.  collier , and r.  dahab . .",
    "in r.  verdone , editor , _ wireless sensor networks _ , volume 4913 of _ lncs _ , pages 305320 .",
    "springer berlin heidelberg , bologna , italy , 2008 .",
    "s.  tamrakar and j .- e .",
    "6th international conference on trust & trustworthy computing _ ,",
    "volume 7904 of _ lncs _ , pages 115132 , london , united kingdom , 2013 .",
    "springer berlin heidelberg .    .",
    "public transport in paris .",
    "http://en.parisinfo.com/practical-paris/how-to-get-to-and-around-paris/public-transport-paris .",
    "g.  arfaoui , j .- f .",
    "lalande , j.  traor , n.  desmoulins , p.  berthom , and s.  gharout . .",
    "d.  boneh , b.  lynn , and h.  shacham .",
    "short signatures from the weil pairing . , 17(4):297319 , 2004 .",
    "doi : http://dx.doi.org/10.1007/s00145-004-0314-9[10.1007/s00145-004-0314-9 ] .",
    "s.  brands . .",
    ", 2000 .",
    "fouque and d.  pointcheval . .",
    "in c.  boyd , editor , _ advances in cryptology - asiacrypt 2001 _ , volume 2248 of _ lncs _ , pages 351368 .",
    "springer berlin heidelberg , gold coast , australia , 2001 .",
    "m.  geuss . .",
    "http://ars.to/13t01bc , july 2013 .",
    "v.  shoup . . , 2004 , 2004",
    "in the following , we give further details about the payment protocol for public transport proposed by rupp et al . at fc 2013  @xcite .",
    "then , we present an attack that enables a malicious transport authority to break users privacy .    at first , the user buys a trip authorization token ( @xmath236 ) which consists of an ( extended ) coin in brands scheme  @xcite .",
    "this token enables the user to perform one trip .",
    "then , the user receives a fresh refund token ( @xmath237  such that @xmath238 ) , sets a variable @xmath48 to 1 and @xmath239 to 0 .",
    "@xmath48 will be used to aggregate blinding factors and @xmath239 is the refund amount . at the entry turnstile , the user shows a @xmath236 and proves its ownership .",
    "right after this , the user receives a refund calculation token ( @xmath240 ) which consists of a mac on @xmath236 , a timestamp and the reader i d . at the turnstile of the exit ,",
    "the user shows his @xmath241 and proves the ownership of the @xmath236 contained within it .",
    "in addition , he collects refund on his @xmath242 , as described in figure  [ tab : refundcollect ] .",
    "a refund value @xmath243 is represented as a @xmath243-times bls signature  @xcite @xmath244 such that @xmath245 is the secret bls signature key of the transport authority .",
    "later , the user redeems his @xmath242 .",
    "this consists on sending a blinded version of his @xmath242 ( @xmath246 ) , @xmath247 , @xmath48 and the collected amount @xmath239 to the transport authority .",
    "the latter checks the validity of both @xmath247 and the signature : @xmath248 in  @xcite , rupp et al .",
    "assume that , for efficiency reasons , users do nt verify their rts .",
    "indeed , verifications of refund tokens ( step 1 in figure  [ tab : refundcollect ] ) is too costly and can not be handled by constrained devices such as sim cards .",
    "this lack of verification could lead to serious privacy weaknesses : a malicious transport authority could link users trips .",
    "> p0.3- > p0.2- > p0.45- + * user*&&*exit turnstile * + & & determine the refund @xmath243 based on the received information in @xmath241 + & & + & & @xmath249 * ( 1 ) * + & & + & & +   + * user*&&*transport authority * + & + & & check validity of @xmath247 , + & & @xmath250 , + & +    more precisely , for a given station , the transport authority is able to identify all the users who left at this station . to this end , in step ( 1 ) in figure  [ tab : refundcollect ] , instead of computing @xmath249 , the transport authority chooses a variable @xmath251 and computes @xmath252=@xmath253 . the user will not detect that @xmath252 is improperly calculated because there is no verification on the user s side .",
    "the refund token @xmath242 will then carry on the exponent @xmath176 till the redeeming refund step , i.e. , @xmath254 where @xmath255 corresponds to the number of times the user left the targeted station , @xmath48 is the product of all the variables @xmath256 and @xmath239 is the sum of all the refunds @xmath243 . at the redeeming refund step , upon receiving the serial number @xmath247 , the blinded version of the refund token @xmath257 , the refund amount @xmath239 , and the aggregate blinding factor @xmath48 , the transport authority will as usual check the validity of @xmath247 and whether the amount is within the allowed range @xmath258 $ ] .",
    "now , in order to verify the signature and distinguish users who exited at the relevant station , the transport authority starts by checking the relation  1[eq1 ] ) .",
    "if equation  ( [ eq1 ] ) holds , this implies that the user did not left the targeted station . otherwise , the transport authority checks : @xmath259 to do so , the transport authority will repeat the computations with different values of @xmath255 until the relation  ( [ eq2 ] ) holds .",
    "when @xmath260 equation  ( [ eq2 ] ) holds , this implies that the user left the targeted station @xmath255 times .    in order to monitor several stations at the same time",
    ", the transport authority will have a list of variables @xmath176 , e.g. , @xmath261 for station a , @xmath262 for station b , etc . at the redeeming refund step ,",
    "the transport authority will test different values of @xmath176 until it finds the ones that satisfy the relation  ( [ eq3 ] ) : @xmath263 where @xmath264 characterizes a station @xmath123 and @xmath265 represents the number of exits at the station @xmath123 .",
    "for instance , if the user left the station a four times , the station b twice and the station m once , relation  ( [ eq3 ] ) will be as follows : @xmath266 . in this way",
    ", the transport authority will be able to identify the users that left a pool of targeted stations but also the number of times they exited at these stations : this clearly implies that users trips are _",
    "linkable_.    however , solving relation  ( [ eq3 ] ) and finding the right tuples @xmath267 , becomes quickly a complex and unmanageable task when the number of targeted stations increases ( more than three for example ) . to mitigate this ,",
    "a malicious transport authority could only monitor two stations at the same time and periodically change these monitored stations . in this way",
    ", the transport authority will be able to monitor a large number of stations and will have a global overview of the users journeys which breaks the privacy property of rupp et al . system .",
    "we would like to emphasize that privacy holds in p4r ( rupp et al .",
    "system  @xcite ) if we assume that the transport authority is `` honest but curious '' , i.e. , it will not deviate from the refund protocol , but such an assumption is too strong in the context of transport systems  @xcite .    in order to mitigate this issue",
    ", the user should check the received refund ( step ( 1 ) in figure  [ tab : refundcollect ] ) .",
    "this verification implies pairing computations .",
    "however , in constraint environments such as the sim card , this is not feasible yet .",
    "a straightforward solution would be to delegate these computations to the smartphone .",
    "such a solution has two main drawbacks .",
    "on the one hand , delegating computations to an untrusted environment , i.e. , the smartphone which could be compromised by spywares , will affect the user s privacy . on the other hand , verifying the received refund token would lead to inefficient transactions at exit turnstiles .",
    "* sketch of proof . *",
    "the * completeness * of the protocol follows by inspection .",
    "the * soundness * follows from the extraction property of the underlying proof of knowledge and the unforgeability of the underlying signature scheme .",
    "in particular , the extraction property implies that for any prover @xmath268 that convinces @xmath269 with probability @xmath270 , there exists an extractor which interacts with @xmath268 and outputs a witness @xmath271 with probability poly(@xmath270 ) .",
    "moreover , if we assume that the extractor input consists of two transcripts , i.e. , \\{@xmath272 @xmath273 @xmath274}. the witness can be obtained by computing ( all the computations are done mod p ) : @xmath275 and @xmath276 ; @xmath277 ;    the extractor succeeds when @xmath278 is invertible in @xmath279 .",
    "if the following check @xmath149 holds , this implies that : @xmath280 .",
    "therefore , @xmath281 . let us denote by @xmath282 .",
    "note that we necessarily have @xmath283 , otherwise this would imply that the prover knows the secret value @xmath124 ( which would be equal to @xmath284 ) .",
    "we therefore have @xmath285 and consequently that @xmath188 .",
    "so the prover knows a valid bb - signature on the value @xmath64 .",
    "this implies that @xmath286 .",
    "also note that if @xmath149 then this implies that the prover @xmath287 only knows one representation of @xmath148 in the base @xmath288 and @xmath97 .",
    "otherwise this would imply that @xmath287 knows the private key @xmath124 . indeed , suppose that @xmath287 knows two representations of @xmath148 in the base @xmath288 and @xmath97 .",
    "let us denote by @xmath289 and @xmath290 these two representations .",
    "since @xmath85 is a prime order group and @xmath291 and @xmath292 , this implies that @xmath293 and @xmath294 . since @xmath295",
    ", this implies that @xmath296 and that @xmath297 .",
    "let us denote by @xmath298 . then @xmath299 .",
    "since @xmath85 is a prime order group this implies that @xmath300 .    if @xmath301 , then @xmath268 can be directly used to mount a weak - chosen attack against the bb - signature scheme with probability poly(@xmath270 ) of succeeding",
    ". thus @xmath270 must be negligible .",
    "finally , to prove * ( honest - verifier ) zero - knowledge * , we construct a simulator _ sim _ that will simulate all interactions with any ( honest verifier ) @xmath302 .    1 .",
    "_ sim _ retrieves @xmath140 and @xmath143 from @xmath302 .",
    "sim _ randomly chooses @xmath286 and @xmath193 and computes @xmath303 , @xmath304 and @xmath305 .",
    "3 .   _ sim _ randomly chooses @xmath306 and computes @xmath307 and @xmath308 .",
    "sim _ outputs @xmath309 @xmath310 .",
    "since @xmath85 is a prime order group , then the blinding is perfect in the first two steps and @xmath311 and @xmath302 s view of the protocol are statistically indistinguishable .",
    "* sketch of proof . *",
    "the * completeness * follows by inspection .    *",
    "soundness : * roughly speaking , the whole proof @xmath202 can be divided in three sub - proofs @xmath312 , @xmath313 and @xmath314 , where :    @xmath315    @xmath316    @xmath317    if the verifier accepts the proof @xmath202 this means that : @xmath198 ( 1 ) and @xmath318 ( 2 ) .    note that the proofs @xmath312 , @xmath313 and @xmath314 are classical variants of schnorr s proof of knowledge . using the `` extractors '' of these proofs of knowledge , we can retrieve @xmath319 .    from ( 1 )",
    "we have : @xmath320 .",
    "this implies that @xmath281 .",
    "let us denote by @xmath282 .",
    "( note that @xmath321 , otherwise this would imply that the prover knows the secret value @xmath124 ) .",
    "we therefore have @xmath285 and therefore that @xmath188 .",
    "so the prover knows a valid bb - signature on the value @xmath64 .",
    "this implies that @xmath322 $ ] .    from ( 2 ) we have that @xmath323 .",
    "this implies that @xmath324 .",
    "let us denote by @xmath325 , this implies that @xmath326 ( note that @xmath327 , otherwise this would imply that the prover knows the secret value @xmath233 ) .",
    "so @xmath328 .",
    "the prover therefore knows a valid permission token ( @xmath329 .    in conclusion",
    ", the prover knows a permission token @xmath330 and a value @xmath64 such that @xmath331 , @xmath332 $ ] and @xmath333 is an el gamal encryption of @xmath334 .    *",
    "( honest - verifier ) zero - knowledge : * since @xmath312 , @xmath313 and @xmath314 are classical zkpk , we can easily construct simulators @xmath335 , @xmath336 and @xmath337 ( respectively ) for such proofs .",
    "from these simulators , it is straightforward to construct a simulator @xmath338 that will simulate all interactions with any ( honest ) verifier @xmath302 . since @xmath85 is a prime order group , then the blinding would be perfect and the output of @xmath338 and @xmath302 s view of the protocol would be statistically indistinguishable .",
    "we used javacard 2.2 for developing all the cryptographic computations into the sim card . in particular , the sim card has access to the functions handling elliptic curves operations .",
    "the sim card handles requests from the validator using the ncf contactless interface .",
    "the validator has been developed in java and scala .",
    "the java software uses a native library for ec scalar multiplications and pairings .",
    "this library depends on libgmp for big integers computations and benefits from its assembly optimizations .",
    "furthermore , computations are distributed between threads ( at jvm level ) to benefit from the multi - core architecture of the pc .",
    "the pc is an intel(r ) xeon(r ) with a e5 - 1620 cpu with 4 cores running at 3.70ghz under a 64-bit linux os .",
    "the nfc reader of the validator is an omnikey 5321 dual interfaces .",
    "the curve and pairing parameters that we used in the implementation of our m - ticketing system are :    q = 8243401665430090752057404098378368203946728292799613002    4655912292889294264593    p = 8243401665430090752057404098378368203918016968090658713    6896645255465309139857    b = 5",
    "* discrete logarithm ( dl ) . * for any multiplicative group @xmath91 of prime order @xmath88 , the dl assumption states that given a random generator @xmath92 and a candidate @xmath339 , it is hard to find an integer @xmath340 such that @xmath341 .",
    "* one - more discrete logarithm ( omdl )  @xcite . * for any multiplicative group @xmath91 of prime order @xmath88 , the omdl assumption states that given a random generator @xmath92 , a challenge oracle that produces a random group element @xmath342 when queried and a discrete logarithm oracle ( with respect to @xmath97 ) , it is hard to find , after @xmath176 queries to the challenge oracle ( where @xmath176 is chosen by the adversary ) and at most @xmath343 queries to the discrete logarithm oracle , the discrete logarithms of all @xmath176 elements @xmath342 .    *",
    "q - strong diffie - hellman i ( q - sdh - i ) . * for any multiplicative group @xmath85 of prime order @xmath88 , the q - sdh - i assumption states that given three random generators ( @xmath344 , @xmath125 , @xmath345)@xmath346 , a value @xmath347 , an oracle @xmath348 that on input a value @xmath178 outputs a pair @xmath349 with @xmath350 , it is hard to output a new triplet @xmath351 , with @xmath352 such that @xmath353 has never been queried to @xmath348 .",
    "* remark : * the triplet @xmath354 corresponds to a permission token of our m - ticketing protocol . in the sequel , we will call the oracle @xmath348 , a bb - signature oracle and the value @xmath353 the ( permission ) token secret .    * forking lemma .",
    "* we use the forking lemma  @xcite in our proofs , to prove that an adversary @xmath52 is not able to produce a new valid m - ticket @xmath35 ( respectively a schnorr s signature @xmath355 , see figure  6 ) unless he knows all the underlying secrets @xmath356 ( respectively the secret @xmath357 ) .",
    "@xmath359=(@xmath118 , @xmath360 , @xmath361 , @xmath362 , @xmath363 , @xmath364 , @xmath191 , @xmath200 , @xmath148 , @xmath365 , @xmath366 , @xmath367 , @xmath368 , @xmath369 , @xmath370 , @xmath371 , @xmath372 , @xmath373 , @xmath374 , @xmath375 , @xmath225 ) ,    @xmath345=@xmath376 , @xmath360 , @xmath361 , @xmath362 , @xmath363 , @xmath364 , @xmath191 , @xmath200 , @xmath148 , @xmath365 , @xmath366 , @xmath367 , @xmath368 , @xmath369 , @xmath370 , @xmath371 , @xmath372 , @xmath373 , @xmath374 , @xmath375 , @xmath225 ) and          * sketch of proof .",
    "* we assume that the challenger @xmath387 in the experiment @xmath388 @xmath389 receives a random instance ( @xmath390 , @xmath391 , @xmath383 , @xmath392 ) of the one - more dl problem where @xmath97 is a random generator in @xmath85 .",
    "@xmath387 will run the adversary @xmath52 as a subroutine and act as @xmath52 s challenger in the non - frameability experiment . because @xmath387 is against the one - more dl assumption , he has access to a dl oracle .",
    "@xmath387 picks three random values @xmath393 ,",
    "@xmath394 and @xmath395 in @xmath279 and computes @xmath396 , @xmath397 and @xmath398 .",
    "the other generators of the m - ticketing system are randomly chosen .",
    "@xmath52 chooses the keys @xmath78 for the transport authority and @xmath44 for the revocation authority and @xmath387 chooses the key @xmath399 for the paillier encryption scheme .",
    "@xmath387 is therefore able to construct the public parameters @xmath12 for @xmath52 and can answer to its requests in the following way :    * @xmath55 requests : @xmath387 answers using his input of the one - more dl problem .",
    "@xmath387 puts @xmath400= @xmath401= @xmath402 * @xmath58 requests : @xmath387 does not need to do anything . * @xmath59 requests : @xmath387 uses is dl oracle to give the corresponding @xmath403 to the adversary . * @xmath61 requests : @xmath387 first uses his input of the one - more dl problem to compute the commitment @xmath191 : @xmath387 puts @xmath191= @xmath404= @xmath405 .",
    "if the protocol does not abort then we put @xmath217=@xmath406+@xmath407 and @xmath408 , where @xmath406 is unknown to @xmath387 and @xmath379 is provided by @xmath52 . in the random oracle model , @xmath387 is able to perfectly simulate the proof of knowledge @xmath312 as well as the schnorr s signature @xmath355 .",
    "* @xmath63 requests : all the values involved in the computation of an m - ticket @xmath35 can be easily simulated by @xmath387 except @xmath363 and @xmath36 . to compute @xmath409 where @xmath410 is a random value chosen by @xmath387 , it proceeds as follows : @xmath363 = @xmath411 = @xmath412 .",
    "as @xmath387 does not know the value @xmath217 it can not compute or simulate the value @xmath331 .",
    "it will therefore choose a random value @xmath48 and define @xmath36 as @xmath48 . in the random oracle model , @xmath387 can simulate the proof of knowledge @xmath202 using standard techniques .",
    "the simulation is not perfect since we replace the value @xmath36 by a random value @xmath48 .",
    "however @xmath52 will not detect this change unless he can solve the q - ddhi problem . * @xmath68 requests : @xmath387 proceeds as in an @xmath65 request for each unused m - ticket .",
    "now , we assume that the adversary @xmath52 manages to produce a valid m - ticket @xmath35 such that it breaks the non - frameability of our m - ticketing protocol and it mades @xmath176 requests to the @xmath59 oracle .",
    "this means that this m - ticket has not been obtained on a @xmath65 query and the @xmath75 algorithm on @xmath35 outputs an identifier @xmath21 which is in @xmath53 along with a schnorr s signature @xmath355 that proves that this m - ticket comes from a permission token obtained by this user can be publicly verifiable , a wrong @xmath75 procedure is statistically negligible ( even for a powerful adversary ) . ] .",
    "@xmath359=(@xmath118 , @xmath360 , @xmath361 , @xmath362 , @xmath363 , @xmath364 , @xmath191 , @xmath200 , @xmath148 , @xmath365 , @xmath366 , @xmath367 , @xmath368 , @xmath369 , @xmath370 , @xmath371 , @xmath372 , @xmath373 , @xmath374 , @xmath375 , @xmath225 ) ,    @xmath345=@xmath376 , @xmath360 , @xmath361 , @xmath362 , @xmath363 , @xmath364 , @xmath191 , @xmath200 , @xmath148 , @xmath365 , @xmath366 , @xmath367 , @xmath368 , @xmath369 , @xmath370 , @xmath371 , @xmath372 , @xmath373 , @xmath374 , @xmath375 , @xmath225 ) and    @xmath377=(@xmath378 , @xmath379 , @xmath380 , @xmath381 , @xmath382 , @xmath383 , @xmath384 ) then it can produce two valid m - tickets @xmath358 and @xmath385 such that @xmath386 . using the technique of replay and the soundness property of the proof @xmath202 ,",
    "one is able to extract all the secret values ( @xmath162 , @xmath217 , @xmath256 , @xmath139 , @xmath64 ) .    *",
    "first case : * the value @xmath217 corresponds to a permission token obtained during an @xmath61 on @xmath413 ( i.e. , @xmath334 is equal to the value @xmath414 produced during such a request ) .",
    "@xmath387 outputs the @xmath176 values @xmath403 that comes from the requests to the dl oracle plus the value @xmath415 and so breaks the one - more dl assumption .    *",
    "second case : * the value @xmath217 does not correspond to a permission token obtained during an @xmath61 on @xmath413 ( meaning that all the values @xmath414 generated during such requests are different from @xmath334 ) . we know by the definition of the experiment that no @xmath59 oracle query ( and consequently no dl oracle query ) has been made on this identity",
    ". therefore the public key @xmath400 corresponding to @xmath413 is in the one - more dl problem input .",
    "it follows from the forking lemma that if @xmath52 is sufficiently efficient to produce such a signature @xmath355 , then there exists an algorithm a which can produce two schnorr s signatures with non - negligible probability . using the techniques of replay and soundness , @xmath387 is able to extract the private key @xmath357 used to generate the signature @xmath355 .",
    "@xmath387 outputs the t values @xmath403 , coming from the requests to the dl oracle , plus",
    "the value @xmath416 and so breaks the one - more dl assumption .",
    "we prove the non - frameability under the q - ddhi and one - more discrete logarithm assumptions  @xcite .",
    "we use in fact the omdl assumption to get a better reduction , but the proof can also be done under the discrete logarithm assumption . as the q - ddhi assumption implies the dl one , we can conclude that our m - ticketing protocol is non - frameable , in the random oracle model , under the q - ddhi assumption .",
    "* sketch of proof .",
    "* let @xmath52 be an adversary who breaks the unforgeability requirement of our m - ticketing protocol with non - negligible probability .",
    "we will construct an algorithm @xmath417 , using @xmath52 as an oracle , which breaks the q - sdh - i assumption .",
    "@xmath417 receives on input from its challenger ( @xmath85 , @xmath344 , @xmath125 , @xmath418 @xmath345 , @xmath347 ) the public parameters of the q - sdh - i challenge and has access to a bb - signature oracle .",
    "the other generators of the m - ticketing system are randomly chosen .",
    "@xmath417 also chooses the keys for the paillier encryption scheme .",
    "it sends @xmath419 and the public key of the paillier scheme to @xmath52 .",
    "the private and public keys of the el gamal cryptosystem can be chosen either by @xmath52 or @xmath417 .",
    "@xmath417 is therefore able to construct the public parameters @xmath12 for @xmath52 and can answer to its requests as follow :    * @xmath55 requests : @xmath417 randomly chooses @xmath420 and computes @xmath421 . * @xmath58 requests : @xmath417 does not need to do anything .",
    "* @xmath59 requests : @xmath417 gives @xmath357 to @xmath52 .",
    "* @xmath62 requests : @xmath417 plays as follows : @xmath417 first receives a paillier encryption @xmath422 .",
    "it decrypts it ( recall that @xmath417 chose the private key for the paillier encryption scheme ) and retrieve the corresponding plaintext @xmath378 .",
    "it then queries the bb - signature oracle on @xmath217 where @xmath423 and @xmath379 is randomly chosen by @xmath417 .",
    "the bb - signature oracle sends back a pair @xmath424 with @xmath350 , and @xmath417 transmits it to @xmath52 along with the value @xmath379 .",
    "so @xmath417 perfectly simulates the @xmath62 for @xmath52 .",
    "* @xmath63 requests : since @xmath417 knows the values of all the tokens @xmath330 that have been issued during @xmath62 requests , it can easily answer to @xmath65 queries .",
    "the simulation of this oracle is perfect . *",
    "@xmath68 requests : @xmath417 proceeds as in an @xmath65 request for each unused m - ticket .",
    "* * type-1 forger * : an adversary that outputs a valid m - ticket @xmath35 which can not be linked to a registered user ( corrupted or not ) .",
    "* * type-2 forger * : an adversary that outputs more valid m - tickets than he obtained .",
    "we show that both forgers can be used to solve the q - sdh - i problem .",
    "however , the reduction works differently for each forger type .",
    "therefore , initially @xmath417 chooses a random bit @xmath425 that indicates its guess for the type of forgery that @xmath417 will output .    * if @xmath426 = 1 * : eventually , @xmath417 outputs , with non - negligible probability , a valid m - ticket @xmath427 such that the algorithm @xmath75 , on the input @xmath428 , returns an unknown identifier @xmath429 ( i.e. , does not appear in @xmath26 ) .    *",
    "first case * : @xmath430 ( the plaintext encrypted in @xmath431 ) has been queried during an @xmath62 request but no corresponding signature @xmath355 has been produced .",
    "this means that the adversary did not receive the value @xmath379 ( where @xmath432 ) from the @xmath62 oracle .",
    "we know from the forking lemma and the proofs @xmath202 and @xmath312 that @xmath52 necessarily knows @xmath353 and @xmath379 .",
    "since only @xmath433 has been revealed by this oracle during the @xmath62 , @xmath52 could be used to extract discrete logarithms . therefore under the dl assumption",
    ", this first case could only occur with negligible probability .    * second case * : @xmath431 is an encryption of a commitment @xmath430 of a value @xmath353 that has not been queried during a @xmath62 request",
    ". therefore @xmath353 has not been queried to the bb - signature oracle either . using the forking lemma and the soundness property of the proof @xmath312 , @xmath417 is able to extract with non - negligible probability the secrets @xmath434 underlying the m - ticket @xmath428 .",
    "@xmath417 outputs the triplet @xmath354 to its challenger of the q - sdh - i assumption and therefore breaks it .    * if @xmath426 = 2 * : eventually , @xmath52 outputs , with non - negligible probability @xmath435 , @xmath436 valid m - tickets @xmath437 , where @xmath73 is the number of calls to the @xmath62 oracle , @xmath10 is the number of authorized m - tickets by token and @xmath438 . let us denote by ( @xmath378 , @xmath379 , @xmath383 , @xmath439 ) the @xmath73 token secrets submitted to the bb - signature oracle .",
    "w.l.o.g , we may assume that all these values are different ( recall that a token secret @xmath217 is jointly computed by @xmath52 and @xmath417 ) .",
    "we therefore have @xmath440 distinct token pairs @xmath441 with @xmath442 and @xmath443 .",
    "let @xmath444 be the set containing all these token pairs and @xmath445 the m - ticket corresponding to the token pair @xmath446 .    among the @xmath447 m - tickets output by @xmath52 ,",
    "there is at least one m - ticket @xmath448 for which the corresponding token pair * ( @xmath449 , @xmath450 ) does not belong to @xmath444*. otherwise this would mean that two m - tickets among these @xmath447 m - tickets , e.g. , @xmath451 and @xmath452 , have the same token pair ( since @xmath453 ) .",
    "let us denote by ( @xmath454 , @xmath455 ) ( respectively ( @xmath456 , @xmath457 ) ) the token pair corresponding to @xmath451 ( respectively @xmath452 ) .",
    "therefore the serial number @xmath458 of @xmath451 would be equal to @xmath459 the one of @xmath452 : @xmath458= @xmath460= @xmath461 = @xmath459 .",
    "this case can not occur since all duplicates ( i.e. m - tickets which have the same serial numbers ) are discarded in the experiment @xmath76 .",
    "suppose now that * @xmath462*. since @xmath463 this implies that @xmath464 .",
    "such a case will happen with negligible probability under the q - sdh assumption ( see theorem 2 ) .",
    "therefore @xmath465 and consequently has not been queried to the bb - signature oracle ( @xmath52 is in fact a type-1 forger ) .",
    "@xmath417 then picks a random m - ticket @xmath428 among the @xmath447 m - tickets output by @xmath52 . with probability @xmath466",
    ", it has chosen @xmath448 . using the forking lemma and the soundness property of the proof @xmath202 , @xmath417 is able to extract with non - negligible probability the secrets @xmath434 underlying the m - ticket @xmath428 .",
    "@xmath417 outputs the triplet @xmath354 and therefore breaks the q - sdh - i assumption with non - negligible probability @xmath467 .    to complete the proof , we need to clarify why we discard duplicates in @xmath76 .",
    "we consider that @xmath35 = @xmath468 and @xmath428 = @xmath469 are duplicates if their serial numbers are equal .",
    "let us denote by @xmath470 ( respectively @xmath471 ) the token pair corresponding to the ticket @xmath35 ( respectively @xmath428 ) .",
    "since @xmath36 = @xmath472 , we have @xmath473 = @xmath474 .          _ case 2.2 _ : @xmath217 and @xmath353 @xmath100 @xmath477 .",
    "this implies that @xmath64 and @xmath478 @xmath100 @xmath479 .",
    "otherwise @xmath52 could be used to break the q - sdh assumption ( see the proof of theorem 2 ) . since",
    "@xmath217 and @xmath353 have been randomly chosen ( they are jointly computed by @xmath52 and @xmath417 ) , the probability that @xmath473 = @xmath474 is negligible .",
    "therefore case 2.2 . will occur with negligible probability either .",
    "* sketch of proof .",
    "* we prove the * unlinkability * under a slightly weaker model than the one presented in section  [ unlink ] .",
    "indeed , we consider a slightly different experiment in which the adversary can not query the revocation oracle @xmath480 . we rename this new requirement",
    "* unlinkability**. we would like however to emphasize that the access to revocation functionalities will likely be carefully controlled in a real deployment of an m - ticketing system .",
    "therefore , unlinkability * is a reasonable model to consider .",
    "anyway , in order to satisfy the original unlinkability requirement , we just need to replace the elgamal encryption scheme , which only satisfies ind - cpa security , by an ind - cca2 encryption scheme .",
    "it is well - known that by double encrypting the same message under an ind - cpa scheme and using a _ simulation sound proof of equality _ of plaintexts , we obtain an ind - cca2 scheme .",
    "therefore , by using the double elgamal encryption scheme , which was proved ind - cca2 in  @xcite , our m - ticketing protocol would satisfy the original unlinkability requirement .",
    "let @xmath52 be an adversary who breaks the unlinkability requirement of our m - ticketing protocol .",
    "we will consider that a query to the @xmath481 oracle on ( @xmath21 , _ view _ ) for the report of @xmath255 unused m - tickets is equivalent to @xmath255 queries to the @xmath65 on ( @xmath21 , _ view _ ) .",
    "let @xmath130 = @xmath10 .",
    "we will say that an adversary @xmath52 against our unlinkability experiment @xmath482 is a type-(@xmath483 , @xmath255 ) distinguisher , with @xmath484 and @xmath485 , if @xmath52 after having received its challenge ( from its @xmath482-challenger ) makes at most @xmath483 queries to the @xmath65 oracle on ( @xmath486 , @xmath487 ) and @xmath255 queries to the @xmath65 oracle on ( @xmath80 , @xmath488 ) .",
    "we can remark that a type-(@xmath483 , @xmath255 ) distinguisher , with @xmath484 and @xmath485 , is also a type-(@xmath489 , @xmath489 ) distinguisher .",
    "we may therefore , without loss of generality , restrict our attention to type-(@xmath489 , @xmath489 ) distinguishers . in the sequel , we will thus assume that @xmath52 is such an adversary .",
    "more precisely , we will suppose that after receiving @xmath490 and @xmath491 , @xmath52 arbitrarily queries the @xmath55 , @xmath58 , @xmath59 , @xmath492 and @xmath61 oracles and then queries the @xmath481 oracle on ( @xmath486 , @xmath487 ) and ( @xmath80 , @xmath488 ) .    we give a security proof as a sequence of games , using shoup s methodology  @xcite",
    ". we will only give a rather high - level description of the initial game ( game 0 ) and brief descriptions of the modifications between successive games .",
    "the challenger @xmath387 randomly chooses @xmath97 , @xmath344 , @xmath125 , @xmath177 , @xmath155 , @xmath418 , @xmath345 , @xmath91 , @xmath190 nine generators of @xmath85 and @xmath126 , @xmath184 two generators of @xmath86 .",
    "it also chooses the keys for the paillier encryption scheme as well as the ones for the transport authority and revocation authorities .",
    "@xmath387 sends @xmath17 and @xmath78 to @xmath52 .",
    "@xmath387 answers to @xmath52 s requests as follows :    * @xmath55 requests : @xmath387 randomly chooses @xmath420 and computes @xmath493 = @xmath494 . * @xmath58 requests : @xmath387 does not need to do anything . * @xmath59 requests : @xmath387 gives @xmath357 to @xmath52 .",
    "* @xmath61 requests : @xmath387 chooses a random value @xmath378 to obtain a valid permission token @xmath330 and uses @xmath357 to generate the signature @xmath355 . * @xmath63 requests : @xmath387 uses its permission token @xmath330 and a fresh index @xmath64 that has not been used in a previous query of @xmath65 on @xmath21 and _ view _ and computes a ticket @xmath35 = @xmath468 . * @xmath495 requests : @xmath387 computes the m - tickets @xmath35 based on the secret @xmath217 corresponding to the user identifier @xmath21 and gives them to @xmath52 . * @xmath68 requests : @xmath387 proceeds as in a @xmath65 request for each unused m - ticket .",
    "the adversary chooses two honest users @xmath79 and @xmath80 and two indexes @xmath496 and @xmath455 .",
    "@xmath387 runs the protocol @xmath497 with @xmath79 and @xmath80 and outputs the corresponding views , @xmath487 and @xmath488 , to @xmath52 .",
    "it then generates two valid m - tickets : @xmath490 = @xmath498 for @xmath79 and @xmath491 = @xmath499 for @xmath80 and send them to @xmath52 .",
    "the goal of @xmath52 is to guess the value of @xmath163 .",
    "after having received its challenge , @xmath52 can queries the @xmath55 , @xmath58 , @xmath59 , @xmath61 , @xmath65 , @xmath492 and @xmath481 oracles but with the following restrictions : it can not query the @xmath59 oracle on @xmath79 or @xmath80 or the @xmath492 oracle on ( @xmath486 , @xmath487 ) or ( @xmath80 , @xmath488 ) and can not query the @xmath500 @xmath501 oracle on ( @xmath486 , @xmath487 ) or ( @xmath80 , @xmath488 ) if both users did not validate the same number of m - tickets ( otherwise it can easily win this game ) .    at the end of the game , the adversary outputs a bit @xmath502 , its guess .",
    "let @xmath503 be the event that @xmath504 in this game and @xmath505 the event that @xmath504 in game i. we have : @xmath506 - 1/2|$ ] = @xmath507 = @xmath508- 1/2|$ ]    let @xmath509 denote the @xmath489 unused ( reported ) m - tickets of @xmath79 and @xmath510 = ( @xmath511 , @xmath512 , @xmath513 the ones of @xmath80 , where the @xmath514 s and the @xmath515 s belongs to @xmath516 .",
    "* * game(0,b ) * : this is the same game as * game 0 * except that we replace the el gamal ciphertext @xmath517 by an encryption of a random value and then simulate the proof @xmath518 .",
    "such a simulated proof can easily be done in the random oracle model using standard techniques . under the ddh assumption , @xmath52 can not detect this change . indeed , we can easily construct a ddh distinguisher @xmath209 with ddh - advantage satisfying : + @xmath506- pr[s_{(0,b)}]|$ ] @xmath519 @xmath520 ( 1 ) + where @xmath520 is the ddh - advantage of @xmath209 in solving the ddh problem . in the sequel",
    ", we will use the simplified notation @xmath521 ( respectively @xmath522 ) to denote the ddh - advantage ( respectively the q - ddhi advantage ) of some efficient algorithm in solving the ddh ( respectively q - ddhi ) problem . * * game(0,1-b ) * : this is the same game as * game(0,b ) * except that we replace the el gamal ciphertext @xmath523 by an encryption of a random value and then simulate the proof @xmath524 . such a simulated proof can easily be done in the random oracle model using standard techniques . under the ddh assumption , @xmath52 can not detect this change . indeed , we can easily construct a ddh distinguisher d with ddh - advantage satisfying : + @xmath525- pr[s_{(0,1-b)}]|$ ] @xmath519 @xmath521 ( 2 ) * * game(0,0,b ) * : this is the same game as * game(0,1-b ) * except that we replace the serial number @xmath526 by a random value and then simulate the proof @xmath518 .",
    "such a simulated proof can easily be done in the random oracle model using standard techniques . under the q - ddhi assumption , @xmath52 can not detect this change . indeed , we can easily construct a q - ddhi distinguisher @xmath209 with q ddhi - advantage satisfying : + @xmath527- pr[s_{(0,0,b)}]|$ ] @xmath519 @xmath522 ( 3 ) * * game(0,0,1-b ) * : this is the same game as * game(0,0,b ) * except that we replace the serial number @xmath528 by a random value and then simulate the proof @xmath524 .",
    "such a simulated proof can easily be done in the random oracle model using standard techniques . under the q - ddhi assumption , @xmath52 can not detect this change . indeed , we can easily construct a q - ddhi distinguisher @xmath209 with q ddhi - advantage satisfying : + @xmath529- pr[s_{(0,0,1-b)}]|$ ] @xmath519 @xmath522 ( 4 )      combining ( 1 ) , ( 2 ) , ( 3 ) and ( 4 ) , we obtain : + @xmath506- pr[s_1]|$ ] @xmath519 @xmath530 + @xmath531 + we then proceed similarly for each unused m - ticket of @xmath79 and @xmath80 : @xmath509 and @xmath510 = ( @xmath511 , @xmath512 , @xmath513 . for @xmath532 to @xmath489",
    ", we define the following game .    * * game(i , b ) * : this is the same game as * game i * = * game(i-1,0,1-b ) * except that we replace the el gamal ciphertext @xmath533 by an encryption of a random value and then simulate the proof @xmath534 . *",
    "* game(i,1-b ) * : this is the same game as * game(i , b ) * except that we replace the el gamal ciphertext @xmath535 by an encryption of a random value and then simulate the proof @xmath536 . *",
    "* game(i,0,b ) * : this is the same game as * game(i,1-b ) * except that we replace the serial number @xmath537 by a random value and then simulate the proof @xmath538 .",
    "* * game(i,0,1-b ) * : this is the same game as * game i,0,b ) * except that we replace the serial number @xmath539 by a random value and then simulate the proof @xmath536 .      using our notation ,",
    "* game m * is the same game as * game(m-1,0,1-b)*. in the latter game , the unlinkability - challenger gives no information ( in a strong information theoretic sense ) to @xmath52 about the bit @xmath163 ( since all the el gamal ciphertexts have been replaced by encryptions of random values and all serial numbers have been replaced by random values ) .",
    "therefore we have : @xmath541 = 1/2 $ ] .",
    "we can now give an upper bound for @xmath507 : + @xmath507 = @xmath508- 1/2|$ ] = @xmath506- pr[s_m]|$ ] + we have : + @xmath506- pr[s_m]|$ ] @xmath519 @xmath542- pr[s_{j+1}]|$ ] @xmath519 @xmath543 + @xmath544 + therefore under the ddh and q - ddhi assumptions , the advantage @xmath507 of a type-(@xmath489 , @xmath489 ) distinguisher is negligible ( and consequently the one of a type-(@xmath483 , @xmath255 ) distinguisher , with @xmath484 and @xmath485 , is also negligible ) ."
  ],
  "abstract_text": [
    "<S> to ensure the privacy of users in transport systems , researchers are working on new protocols providing the best security guarantees while respecting functional requirements of transport operators . in this paper[multiblock footnote </S>",
    "<S> omitted ] , we design a secure nfc m - ticketing protocol for public transport that preserves users anonymity and prevents transport operators from tracing their customers trips . to this end , we introduce a new practical set - membership proof that does not require provers nor verifiers ( but in a specific scenario for verifiers ) to perform pairing computations . </S>",
    "<S> it is therefore particularly suitable for our ( ticketing ) setting where provers hold sim / uicc cards that do not support such costly computations . </S>",
    "<S> we also propose several optimizations of boneh - boyen type signature schemes , which are of independent interest , increasing their performance and efficiency during nfc transactions . </S>",
    "<S> our m - ticketing protocol offers greater flexibility compared to previous solutions as it enables the post - payment and the off - line validation of m - tickets . by implementing a prototype using a standard nfc sim card , </S>",
    "<S> we show that it fulfils the stringent functional requirement imposed by transport operators whilst using strong security parameters . in particular , a validation can be completed in @xmath0 when the mobile is switched on , and in @xmath1 when the mobile is switched off or its battery is flat . </S>"
  ]
}