{
  "article_text": [
    "consider a system of differential equations arising from a quadratic vector field @xmath0 where @xmath1 is an @xmath2-valued quadratic form , @xmath3 , and @xmath4 . consider the numerical integration method @xmath5 with step size @xmath6 given by @xmath7 where @xmath8 is the symmetric bilinear form obtained from the quadratic form @xmath1 by polarisation .",
    "we call ( [ eq : kahanmap ] ) the _ kahan method_. it is symmetric ( i.e. , self - adjoint ) , and , crucially , it is only linearly implicit , that is , @xmath9 can be computed by solving a single linear system ( because the right hand side of ( [ eq : kahanmap ] ) is linear in @xmath9 ) . the method ( [ eq : kahanmap ] ) was introduced by kahan in @xcite for two examples , a scalar riccati equation and a 2-dimensional lotka  volterra system ( @xcite , p. 14 ) and written down in the general form ( [ eq : kahanmap ] ) in @xcite ( see also references therein ) .    because of the different treatment of each term and the unusual treatment of the quadratic term , kahan called ( [ eq : kahanmap ] ) an ` unconventional ' method .",
    "the map obtained from applying the kahan method to various quadratic vector fields @xmath10 has been shown to be completely integrable in a number of cases ( see @xcite , @xcite , @xcite , and references therein ) . in most cases ,",
    "the conserved quantities depend on the step size @xmath6 . at present",
    "there is no single ` integrability mechanism ' known which accounts for all integrable cases .    in this paper",
    "we show that the kahan method is a runge  kutta method .",
    "as such it shares a number of features with all runge  kutta methods : it has a b - series , it is affine covariant , and it preserves all affine symmetries and all linear integrals of @xmath10 automatically . as a symmetric linear method it preserves all affine reversing symmetries of @xmath10 automatically , and the b - series of its modified vector field contains only even powers of @xmath6 .",
    "we then consider the case that @xmath10 is a hamiltonian vector field on either a symplectic vector space or a poisson vector space with constant poisson structure , in any dimension @xmath11 .",
    "we show that in this case the kahan map has a conserved quantity that converges to the hamiltonian of the vector field as @xmath12",
    ". it also has a conserved measure which converges to the euclidean measure as @xmath12 .",
    "these general properties explain some of the integrable cases considered in @xcite .",
    "the kahan method coincides with the runge  kutta method @xmath13 restricted to quadratic vector fields .",
    "we have @xmath14    ( many other runge  kutta methods also coincide with the kahan method when restricted to quadratic vector fields . in this paper , we restrict our attention to ( [ eq : kahanrk ] ) . ) as already noted by kahan @xcite , the kahan method also coincides with a certain rosenbrock method on quadratic vector fields , for expanding in taylor series about @xmath15 gives @xmath16 so @xmath17 from the symmetry of the method , or by expanding instead around @xmath9 , kahan s method can also be written @xmath18    the b - series of this method is @xmath19 that is , it contains only tall trees .",
    "( for nonquadratic vector fields , the methods ( [ eq : rosenbrock ] ) and ( [ eq : kahanrk ] ) are not necessarily equivalent . )",
    "the runge  kutta method ( [ eq : kahanrk ] ) has 3 stages and butcher tableau    [ cols=\"^,^,^,^ \" , ]     the modified vector field of the kahan method applied to quadratic vector fields can be calculated using standard methods @xcite .",
    "its first few terms are @xmath20 a calculation using conjugation by b - series , considering only quadratic vector fields , now yields the following result .",
    "we omit the details .",
    "[ prop2 ] kahan s method applied to general quadratic fields has order 2 and is conjugate to symplectic up to order 4 .",
    "it is not conjugate by b - series to a method of order greater than 2 or conjugate - symplectic by b - series to order higher than 4 .",
    "we now consider the conservative properties of the kahan method in the case of canonical hamiltonian systems @xmath21 where @xmath22 is the hamiltonian or energy of the system .",
    "first , note that the method ( [ eq : kahanrk ] ) is the @xmath23 member of the class of runge  kutta methods @xmath24 these are all symmetric , a - stable , and second order .",
    "some other members of this family are also known to have conservative properties :    1 .   when @xmath25 , we have the midpoint rule .",
    "it is symplectic for canonical hamiltonian systems .",
    "because it is symplectic , it conserves the euclidean measure . when the hamiltonian @xmath26 is analytic , the method has a formal invariant @xmath27",
    "when @xmath26 is quadratic ( i.e. when @xmath10 is linear ) this series converges to give a conserved quantity of the method .",
    "when @xmath28 , we have the trapezoidal rule .",
    "it is conjugate to the midpoint rule ( the conjugacy being half an euler step ) , and so it is also conjugate to symplectic and hence conserves a measure close to the euclidean measure , and it also has a formal invariant close to @xmath26 .",
    "when @xmath29 , we have ` simpson s method ' @xcite , so - called because the right hand side of ( [ eq : symrk ] ) is simpson s quadrature of @xmath30 , appearing in the average vector field method @xmath31 , which conserves the hamiltonian in canonical hamiltonian systems .",
    "simpson s method preserves quartic hamiltonians exactly because it coincides with the average vector field method in that case .",
    "it is not conjugate to symplectic in the sense of b - series @xcite .",
    "kahan s method has a conserved quantity given by the modified hamiltonian @xmath32 for all cubic hamiltonian systems on symplectic vector spaces and on all poisson vector spaces with constant poisson structure .",
    "the modified hamiltonian is ( i ) a rational function of @xmath15 ; ( ii ) an even function of @xmath6 ; and ( iii ) given by a convergent series of elementary hamiltonians containing only even - order tall trees .",
    "we first consider the homogeneous case , i.e. , we let @xmath33 where @xmath34 is an arbitrary ( not necessarily invertible ) constant antisymmetric matrix and @xmath35 where @xmath36 is a symmetric trilinear form .",
    "note that @xmath37 for all @xmath15 , @xmath38 .",
    "for any of the methods ( [ eq : symrk ] ) , we have ( writing @xmath39 ) @xmath40    the case @xmath41 is simpson s method , confirming that @xmath42 is conserved in that case .    for kahan s method , @xmath43 , and we have from eqs .",
    "( [ eq : rosenbrock],[eq : rosenbrock2 ] ) that @xmath44 therefore @xmath45\\nabla h(x ' ) \\cr & = 0 .   } \\ ] ] because each matrix in square brackets is antisymmetric .",
    "( each term is an elementary hamiltonian corresponding to a superfluous tall tree . )",
    "the expression is a rational function of @xmath15 and @xmath6 so if its taylor series in @xmath6 is zero , the function is zero .",
    "therefore the kahan method has a first integral @xmath46 .",
    "this can also be written in the symmetric form @xmath47 or explicitly as a function of @xmath15 as @xmath48 as in ( [ eq : cs ] ) , @xmath49 for all @xmath11 , so we can also write @xmath50 in a form manifestly even in @xmath6 , @xmath51    now consider the case that @xmath42 is cubic but not homogeneous . we extend it to a homogeneous function @xmath52 so that @xmath53 , and extend @xmath34 to @xmath54 by adding a zero initial row and column , so that @xmath55 .",
    "the linear integral @xmath56 is conserved by kahan s method , and @xmath57 , so the modified hamiltonian of kahan s method for @xmath58 reduces to a modified hamilton of kahan s method for @xmath59 given by the same formula ( [ eq : ht ] ) as in the homogeneous case .",
    "the kahan map and its conserved quantity @xmath60 are rational functions of @xmath15 whose degrees are described in the following proposition .",
    "when @xmath34 has full rank , for @xmath61 ( resp .",
    "@xmath62 ) , @xmath60 is degree 3 over degree 2 ( resp .",
    "degree 5/2 , degree 5/4 ) and the kahan map is degree 2/2 ( resp .",
    "degree 3/2 , degree 4/4 ) . in the planar case",
    ", kahan s method gives a rational map with cubic invariant curves .",
    "we conjecture that the dynamics of the kahan map in two dimensions is related to the abelian group structure of elliptic curves ( and in higher dimensions , to that of abelian varieties ) as is the case for planar qrt maps @xcite .",
    "let @xmath26 be a cubic in @xmath2 and let @xmath34 be a rank @xmath63 antisymmetric @xmath64 matrix .    1",
    ".   the degree of the denominator of @xmath60 is at most @xmath63 and the degree of the numerator of @xmath60 is at most @xmath65 .",
    "when @xmath66 the degree of the numerator of @xmath60 is at most @xmath67 .",
    "the degree of the denominator of the kahan map is at most @xmath63 and the degree of the numerator is at most @xmath67 . when @xmath66 the degree of the numerator is at most @xmath63 .    1 .",
    "because the method is linearly covariant we can assume without loss of generality that @xmath34 is in its darboux normal form @xmath68 where @xmath69 is @xmath70 .",
    "numbering the blocks of @xmath34 1 and 2 , the denominator of @xmath60 is equal to @xmath71 each entry of the matrix @xmath72 is linear in @xmath15 so the final determinant has degree at most @xmath63 .",
    "next , we write @xmath73 where @xmath74 is the adjoint of @xmath75 .",
    "the first term in the numerator has degree at most @xmath65 , @xmath76 and @xmath10 have degree at most 2 , and @xmath77 where each entry in @xmath78 is the determinant of a @xmath79 matrix whose entries are linear in @xmath15 .",
    "hence the degree of the numerator of @xmath50 is at most @xmath65 .",
    "+ finally we consider the case @xmath66 .",
    "since @xmath63 is even , @xmath11 must be even .",
    "first consider the case that @xmath26 is a homogeneous cubic . then @xmath80 and @xmath81 .",
    "thus in this case we have @xmath82 expanding the matrix inverse using cramer s rule now shows that the degree of the numerator is at most @xmath83 .",
    "the terms of degree @xmath83 come from terms in the minors of @xmath84 of degree @xmath85 in @xmath15 .",
    "every @xmath86 in the matrix @xmath84 is multiplied by @xmath6 , thus these terms also have degree @xmath85 in @xmath6 .",
    "however , @xmath50 is an even function of @xmath6 and so these terms must sum to zero .",
    "thus the degree of the numerator is at most @xmath67 .",
    "+ when @xmath42 is a nonhomogeneous cubic , the terms of degree @xmath65 in the numerator of @xmath50 come from the cubic terms in @xmath42 only , and thus vanish as in the homogeneous case .",
    "the terms of degree @xmath83 are odd in @xmath6 and hence vanish as before .",
    "2 .   the proof for the general case follows as above . for the case @xmath66 , we first consider the case that @xmath26 is a homogeneous cubic",
    ". then @xmath87 and the kahan map can be written @xmath88 expanding the matrix inverse using cramer s rule now shows that the degree of the numerator is at most @xmath67 . in the nonhomogeneous case , the terms of degree @xmath83 in the numerator come from the cubic terms in @xmath26 only , and thus vanish as in the homogeneous case .",
    "examples suggest that there are no other values of @xmath11 or @xmath63 other than @xmath89 which lead to a reduction in degree .",
    "kahan s method preserves the measure @xmath90 for all cubic hamiltonians on symplectic vector spaces and on poisson vector spaces with constant poisson structure .",
    "let @xmath91 be the jacobian of the kahan mapping .",
    "differentiating the mapping ( [ eq : symrk ] ) gives @xmath92 because @xmath93 is linear in @xmath15 .",
    "solving for @xmath75 , @xmath94 now @xmath95 where @xmath96 is symmetric . from sylvester s determinant theorem , @xmath97 .",
    "the sum of such matrices has the same property , so @xmath98 this yields invariant measures @xmath99 in 3 cases :    1 .   when @xmath23 ( kahan s method ) , @xmath100 ; 2 .",
    "when @xmath25 ( midpoint rule ) , @xmath101 ; 3 .",
    "when @xmath28 ( trapezoidal rule ) , @xmath102 .    by _ integrable symplectic map",
    "_ we adopt the definition of bruschi et al .",
    "@xcite : a symplectic map on a @xmath103-dimensional symplectic manifold is integrable if it has @xmath11 functionally independent integrals in involution .",
    "we will say that leaf - preserving poisson maps are integrable if the the map is integrable on each leaf .",
    "[ cor : integrable ] kahan s method yields an integrable mapping of the plane when applied to any canonical hamiltonian system in the plane with cubic hamiltonian .",
    "kahan s method yields an integrable mapping of @xmath104 when applied to any poisson system on @xmath104 with constant poisson structure and any cubic hamiltonian .",
    "a measure and a first integral are sufficient for integrability in the plane . the odd - dimensional case with constant @xmath34 has a linear casimir which is conserved by the method , reducing the situation in this case to two dimensions on each level set of the casimir .",
    "when @xmath61 and @xmath26 is a homogeneous cubic , @xmath105 and kahan s method preserves the @xmath6-independent measure @xmath106 .",
    "we have @xmath107 any map that preserves a measure @xmath108 and an integral @xmath109 also preserves the measure @xmath110 .",
    "taking @xmath111 and @xmath112 gives the @xmath6-independent measure @xmath106 .",
    "htfig1b.pdf ( 75,2)@xmath113(0,65)@xmath114    htfig2b.pdf ( 75,2)@xmath113(0,65)@xmath114    htfig3b.pdf ( 75,2)@xmath113(0,65)@xmath114    htfig4b.pdf ( 75,2)@xmath113(0,65)@xmath114    htfig5.pdf ( 75,2)@xmath113(0,65)@xmath114    htfig6.pdf ( 75,2)@xmath113(0,65)@xmath114    measured rate of energy drift for @xmath115 for runge  kutta methods @xmath116 , varying the parameter @xmath117 .",
    "the step size is @xmath118 and the initial condition is @xmath119 , @xmath120 .",
    "all methods have an approximate modified energy up to @xmath121 .",
    "the energy drift is measured by fitting a straight line to this modified energy over @xmath122 time steps . only the four methods identified by the analysis ( @xmath23 , kahan ; @xmath25 , midpoint",
    "; @xmath29 , simpson ; and @xmath28 , trapezoidal ) show no energy drift by this measure . ]",
    "portion of the phase portrait of the midpoint rule with step size @xmath118 applied to @xmath123 .",
    "the observed chaotic bands and island chains indicate that it does not have a conserved quantity .",
    ", width=340 ]    suzuki s 3-stage , 4th - order composition applied to kahan s method shows a comparatively rapid energy drift , indicating that there is no conserved quantity .",
    "here @xmath115 , @xmath124 , and @xmath125 . , width=340 ]",
    "level sets of @xmath60 are shown in figure [ fig : henon ] for @xmath126 .",
    "notice that the separatrices persist ( and are unchanged ) for all @xmath6 , but that the singular set @xmath127 moves in from infinity as @xmath6 increases and alters the topology of the level sets . for @xmath128",
    "the topology of the bounded orbits is unaltered .",
    "the bounded orbits of figure [ fig : henon ] are symmetric , so for the following numerical experiments we used @xmath129 , which has bounded , nonsymmetric orbits , an elliptic fixed point at @xmath130 , and a separatrix meeting @xmath131 .",
    "level sets of @xmath60 for this case are shown in figure [ fig : nons ] .",
    "numerical experiments strongly indicate that the following observations hold .    1",
    ".   no other method of the family ( [ eq : symrk ] ) has a modified hamiltonian when @xmath26 is cubic , apart from the known cases @xmath25 , @xmath132 , and @xmath133 ( see figure [ fig : family ] ) .",
    "2 .   the midpoint and trapezoidal rules do not have a first integral for all cubic @xmath26 ( even though they do have a formal invariant close to @xmath26 ) ( see figure [ fig : midpoint ] ) .",
    "3 .   simpson s method is not measure - preserving for all cubic @xmath26 .",
    "( for @xmath115 , a numerical calculation finds eigenvalues @xmath134 of periodic orbits , with @xmath135 , contradicting measure preservation . )",
    "kahan s method does not preserve any symplectic form in dimension @xmath136 for all cubic @xmath26 .",
    "( a numerical calculation of periodic points finds eigenvalues that do not occur in @xmath137 , @xmath138 pairs .",
    "proposition [ prop2 ] establishes this for a limited class of symplectic forms . )",
    "5 .   compositions of kahan s method with different step sizes do not have a modified hamiltonian when @xmath26 is cubic ( see figure [ fig : suzuki ] ) .",
    "our results are significant and novel for the study of both the integrability of the mappings produced by kahan s method and for the study of the geometric properties of runge  kutta methods :    * first , our results explain the integrability of the map obtained when kahan s method is applied to _ some _ of the examples of @xcite : their eq .",
    "( 4.2 ) ( @xmath139 ) ; eq . ( 5.4 ) ( @xmath140 ) ; eq . ( 8.1 ) ( volterra chain in @xmath104 , @xmath141 , constant @xmath34 , integral @xmath142 in eq . ( 8.6 ) is a function of our @xmath60 and the casimir @xmath143 ) ; eq .",
    "( 9.1 ) ( dressing chain in @xmath104 , @xmath144 , constant @xmath34 ) .",
    "our results explain the invariant measure and cubic integral of their eq .",
    "( 11.1 ) ( three wave system in @xmath145 , @xmath146 ) , the invariant measure for the family of systems in their prop . 1 , and",
    "the linear integrals throughout @xcite . * second , our results ( e.g. corollary [ cor : integrable ] ) systematically produce new integrable cases of kahan s method .",
    "* third , we have shown that kahan s method in dimension 4 and greater provides examples of maps with nonlinear integrals and conserved measures _ unrelated _ ( in general ) to integrability or obvious symmetries , again a novel feature .",
    "for example , our results imply that kahan s application of the method to the korteweg  de vries equation in @xcite preserves a measure and a modified energy ( but the higher order compositions of the method in @xcite probably do not ) . *",
    "fourth , we have shown that kahan s method has novel properties previously unknown amongst runge  kutta methods , indeed amongst all b - series .",
    "it is known that b - series methods can not conserve the measure @xmath147 even for linear vector fields @xcite ; kahan s method circumvents this by conserving a modified measure .",
    "it is a novel conjugate - to - energy preserving method for cubic @xmath26 . in the plane , it is also conjugate to symplectic .",
    "thus , while no conjugate to symplectic methods are known that are also energy preserving in general , here we have one that preserves at least a modified energy , and preserves it exactly ( not merely as a formal invariant ) .",
    "on the other hand , there are open questions in all of these areas . while it was already suggested in @xcite that there could be an underlying ` integrability mechanism ' unifying the integrable cases , here we have unified only some of these .",
    "in addition the hoped - for unification should now be extended to include non - integrable cases preserving a measure and/or some integrals as well . on the numerical side",
    ", it is not known precisely which runge  kutta or b - series methods share the properties of kahan s method , if any are higher order integrators , or if any are conservative for nonquadratic ( e.g. other polynomial ) vector fields .",
    "this research was supported by a http://wiki.math.ntnu.no/crisp[marie curie international research staff exchange scheme fellowship ] within the http://cordis.europa.eu/fp7/home_en.html[7th",
    "european community framework programme ] , and by the marsden fund of the royal society of new zealand and the australian research council .",
    "we would like to thank the referees for their careful reading of the manuscript ."
  ],
  "abstract_text": [
    "<S> we show that kahan s discretization of quadratic vector fields is equivalent to a runge  kutta method . </S>",
    "<S> when the vector field is hamiltonian on either a symplectic vector space or a poisson vector space with constant poisson structure , the map determined by this discretization has a conserved modified hamiltonian and an invariant measure , a combination previously unknown amongst runge  kutta methods applied to nonlinear vector fields . </S>",
    "<S> this produces large classes of integrable rational mappings in two and three dimensions , explaining some of the integrable cases that were previously known . </S>"
  ]
}