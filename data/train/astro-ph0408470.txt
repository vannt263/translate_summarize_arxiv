{
  "article_text": [
    "precise radial velocity surveys have made detection of jupiter mass companions to nearby stars routine , with more than 100 such `` exoplanets '' now known ( see marcy et al .",
    "2003 for a review ) .",
    "as these surveys continue , the accessible parameter space grows towards lower masses and longer orbital periods .",
    "for example , recent observations have led to the discovery of saturn mass planets in close orbits ( fischer et al .",
    "2003 ) , and a population of jupiters with nearly - circular orbits at distances @xmath4 ( vogt et al .  2002 ; carter et al .  2003 ; jones et al .",
    "in addition , it is now possible to study the statistical occurrence rate and distributions of mass , period , and eccentricity of exoplanets ( vogt et al .",
    "2000 ; tabachnik & tremaine 2002 ; butler et al .  2003",
    "; fischer et al .",
    "2003 ; lineweaver & grether 2003 ; jones et al .  2003 ; udry , mayor , & santos 2003 ) , and how these depend on the metallicity of the host stars ( fischer & valenti 2003 ) .",
    "these distributions contain important information about the planet formation process ( armitage et al .",
    "2002 ; ida & lin 2004 ) .",
    "this recent work emphasises the need to understand the sensitivity of radial velocity surveys at long periods and low amplitudes .",
    "the sensitivity of radial velocity surveys has been discussed previously by several authors , mostly for circular orbits .",
    "the lomb - scargle periodogram ( lomb 1976 ; scargle 1982 ) is a commonly used technique for searching for periodic sinusoidal signals in unevenly - sampled data , and allows analytic estimates of the detection threshold to be written down for periods less than the duration of the observations ( horne & baliunas 1986 ) .",
    "this was applied to planet searches by cochran & hatzes ( 1996 ) and nelson & angel ( 1998 ) .",
    "endl et al .",
    "( 2002 ) briefly investigated the detectability of eccentric orbits with the ls periodogram , finding that detectability was significantly reduced for @xmath5 .",
    "the detectability of long period planets , with orbital periods longer than the duration of the observations , was studied by nelson & angel ( 1998 ) and eisner & kulkarni ( 2001 ) .",
    "rather than use the lomb - scargle periodogram to measure the significance of the @xmath6 fit , nelson & angel ( 1998 ) adopted the square of the best fitting amplitude @xmath7 .",
    "eisner & kulkarni ( 2001 ) pointed out that this leads to reduced sensitivity at long periods , because when fitting sinusoids to noise only , one finds that the amplitude is strongly correlated with the fitted phase .",
    "they adopted an `` amplitude - phase '' analysis to account for this correlation , and showed that the sensitivity was significantly improved .    in this paper ,",
    "i revisit the question of the sensitivity of radial velocity surveys .",
    "the main motivations are first to address how to assess the false alarm probability associated with a keplerian orbit fit to radial velocity measurements , and secondly to derive simple analytic formulae for detection thresholds , including long orbital periods and non - zero orbital eccentricities . i show that significant selection effects operate against highly eccentric orbits , and that at long periods , a seperate analysis of amplitude and phase is not required : the definition of the lomb - scargle periodogram in terms of @xmath8 automatically accounts for the correlations between fitted parameters at long periods . in addition",
    ", i discuss a bayesian approach to this problem which will provide a useful basis for future study of the statistical distributions of extrasolar planet properties , as well as emphasising the fundamental equivalence of periodogram and least squares techniques .",
    "this equivalence , and the idea of extending the periodogram to non - sinusoidal signals have also been discussed in the literature on bayesian statistics ( see bretthorst 1988 , 2001a , b , c ; scargle 2002 ; loredo & chernoff 2003 ) .",
    "an outline of the paper is as follows . in ",
    "2 , i review the lomb - scargle periodogram , and suggest an extension to keplerian orbits . in ",
    "3 , i outline a bayesian approach to the periodogram . in ",
    "4 , i calculate the detection thresholds for short and long periods , and including non - zero eccentricity .",
    "the conclusions are presented in  5 .",
    "we are interested in detecting the radial velocity wobble due to an orbiting planet given a set of measured radial velocities , observation times , and measurement errors .",
    "often the first indication of the presence of a planet is excess scatter in the radial velocities over the expected amount .",
    "a simple way to check for this is to calculate the probability that @xmath9 is drawn from a chi - squared distribution ( the @xmath10 distribution ; hoel , port , & stone 1971 ; press et al .",
    "1992 ) . here , @xmath11 is the expected variability for data point @xmath12 , and @xmath13 is the mean of the data .",
    "a reduced @xmath6 much greater than 1 ( the exact threshold depending on the desired false alarm probability ) indicates excess variability .    however , there is some uncertainty in predicting the expected variability in the radial velocities .",
    "scatter in the radial velocities is expected from statistical and systematic measurement errors , and from intrinsic stellar radial velocity variations , or `` jitter '' .",
    "the typical measurement error depends on the survey , but is typically @xmath14@xmath15 , and promises to improve towards @xmath16 in the near future ( mayor et al .",
    "2003 ; butler et al .",
    "jitter is thought to arise from a combination of surface convective motions , magnetic activity , and rotation ( saar & donahue 1997 ) .",
    "the amount of jitter depends on stellar properties such as rotation rate and spectral type , but is typically @xmath14@xmath15 for chromospherically quiet stars ( saar , butler , & marcy 1998 ; santos et al .",
    "saar et al .",
    "( 1998 ) used data from the lick survey to find a rough relation @xmath17 for g and k type stars ( cumming , marcy , & butler 1999 , hereafter cmb99 ) .    in this paper",
    ", we will generally ignore these uncertainties by assuming that the noise level is unknown , and looking for the best partitioning of the data into gaussian noise plus a single planet on a circular or keplerian orbit .",
    "however , we will also discuss the case where the noise @xmath18 can be predicted in advance .",
    "as we will show , this issue is only important for small @xmath19 , when the noise level is difficult to accurately determine from the data .",
    "we first discuss the lomb - scargle ( ls ) periodogram ( lomb 1976 ; scargle 1982 ) .",
    "since it involves fitting sinusoids to the data , this is particularly appropriate for circular orbits . given a set of observation times @xmath20 , velocities @xmath21 , and measurement errors @xmath22 , and a trial orbital frequency @xmath23 , we fit the function @xmath24 to the data by minimising @xmath6 , which we write as @xmath25 .",
    "the number of degrees of freedom is @xmath26 , since there are three parameters ( @xmath27 ) in the model . here",
    ", we have extended the original lomb - scargle periodogram by allowing the mean to float at each frequency ( walker et al .",
    "1995 ; nelson & angel 1998 ; cmb99 ) , rather than subtracting the mean of the data prior to the fit ( the importance of this is discussed by cmb99 and black & scargle 1982 ) .",
    "the goodness of fit is measured by the ls periodogram power @xmath28 , defined as @xmath29 where @xmath30 , and @xmath31 is the @xmath6 of a fit of a constant to the data",
    ". the periodogram power @xmath32 measures how much the @xmath6 of the fit improves when a sinusoid of frequency @xmath33 is included .",
    "as emphasised by walker et al .",
    "( 1995 ) , this is similar to a classical f - test for comparing fits of different models to data ( e.g.  bevington & robinson 1992 ) . to search for a periodicity",
    ", we evaluate @xmath32 for a range of frequencies , and look for the maximum value @xmath34 .",
    "the significance of the best fit depends on the `` false alarm probability '' , or how often a periodogram power as large as the observed power would arise purely due to noise alone . for a single frequency search , the probability that the power at a given frequency exceeds the value @xmath34 is well - determined analytically for gaussian noise ; it is @xmath35 which is the cumulative probability arising from the @xmath36 distribution ( schwarzenberg - czerny 1998 ; see also cmb99 , appendix b for a summary ) .",
    "this distribution takes the simple form @xmath37 for large @xmath19 .",
    "scargle ( 1982 ) defined the periodogram as @xmath38 , in which case equation ( [ eq : prob2 ] ) is valid for all @xmath19 .",
    "this definition is appropriate when we know the noise level @xmath18 in advance , and is attractive because of the very simple probability distribution of equation ( [ eq : prob2 ] ) .",
    "however , in general the noise level is not known in advance as we discussed in  2.1 , and must be estimated from the data ( e.g.  horne & baliunas 1986 ) . in this case , the periodogram must be `` normalized '' by an estimate of the noise obtained from the data . in equation ( [ eq : zdef ] )",
    ", the normalization factor is the @xmath6 of the best - fitting sinusoid .",
    "the `` normalized '' periodogram acts to partition the data into two pieces , signal plus noise , and determines the best fitting amplitude for each .    for a search of many frequencies ,",
    "each `` independent frequency '' must be counted as an individual trial .",
    "the false alarm probability is then @xmath39^m\\ ] ] where @xmath40 is the number of independent frequencies , and @xmath34 is the observed power . for small @xmath41 , @xmath42 the detection threshold @xmath43 is the periodogram power corresponding to some ( small ) value of @xmath41 ( e.g.  @xmath44 for a 99% detection threshold ) , i.e.  the value of @xmath28 exceeded due to noise alone in only a small fraction @xmath41 of trials .",
    "an observed power larger than @xmath43 indicates that a signal is likely present .",
    "the remaining task is to determine the number of independent frequencies @xmath40 .",
    "whereas sines and cosines are orthogonal functions for evenly - sampled data , leading to a statistically independent set of frequencies , this is no longer the case for unevenly - sampled data .",
    "the seperation between peaks in the periodogram is @xmath45 , giving a simple estimate of the number of independent frequencies @xmath46 , where @xmath47 is the frequency range searched .",
    "often @xmath48 , in which case @xmath49 .",
    "a better determination of @xmath40 is to use monte carlo simulations , in which data sets of noise only are generated , with velocities either drawn from a gaussian distribution , or selected with replacement from the residuals about the mean ( the so - called `` bootstrapping '' method , e.g.  press et al .",
    "the fraction of trials for which the maximum periodogram power exceeds the observed value gives the false alarm probability can be reduced by using the analytic form of the distribution given by equation ( [ eq : fa ] ) .",
    "first , using @xmath40 as a free parameter , fit the analytic distribution to the distribution of noise powers from a small number of trials @xmath50 .",
    "then equation ( [ eq : fa ] ) with the fitted value of @xmath40 allows extrapolation to @xmath51 . ] .",
    "it is worth emphasising the effect of the uneven sampling on the number of independent frequencies . for evenly - spaced data , the number of independent frequencies is @xmath52 , ranging from @xmath45 to the nyquist frequency , @xmath53 . for unevenly - sampled data ,",
    "horne & baliunas ( 1986 ) found that @xmath54 for a search up to the nyquist frequency ( see also press et al .",
    "this agrees with our simple estimate above since @xmath55 .",
    "however , uneven sampling allows frequencies much higher than the nyquist frequency to be searched ( see discussion in scargle 1982 and bretthorst 2001a ) . in general , @xmath56 , by a factor of @xmath57 .",
    "for example , a set of 30 observations over 7 years has @xmath58 .",
    "a search for periods as short as 2 days then has @xmath59 .",
    "the definition of the ls periodogram in equation ( [ eq : zdef ] ) suggests an immediate generalization to eccentric orbits ( which have 2 extra parameters , the longitude of pericenter @xmath60 , and eccentricity @xmath61 ) , @xmath62 where @xmath63 is the @xmath6 of a fit of a keplerian orbit to the data ( with @xmath64 degrees of freedom ) , @xmath65 the @xmath6 of a fit of a constant to the data , and @xmath66 .",
    "again , the normalization factor in the denominator of equation ( [ eq : ze ] ) can be dropped if the noise is known in advance .",
    "the complication in implementing equation ( [ eq : ze ] ) is that keplerian fits are nonlinear , involving relatively slow searches over a complex @xmath6 space .",
    "therefore , we use the period and amplitude of the best fitting sinusoid obtained from the ls periodogram as an initial guess for the keplerian fit .",
    "we then use a levenberg - marquardt scheme ( e.g.  press et al .",
    "1992 ) to find the @xmath6 minimum , trying several initial starting values for the phases and eccentricity .",
    "the minimum @xmath6 is then used to calculate @xmath67 from equation ( [ eq : ze ] ) .",
    "given the redefinition of the periodogram power for keplerian orbits , the search for significant fits proceeds in a similar way as for circular orbits .",
    "for a given data set , we perform a wide frequency search with the ls periodogram , and then use the best fitting sinusoids as starting points for keplerian fits , calculating the periodogram power from equation ( [ eq : ze ] ) .",
    "the significance of the resulting best fitting orbit is determined by a monte carlo method in which we make fake data sets containing noise only , and ask how often @xmath67 exceeds the observed value .",
    "a similar calculation allows the detection threshold corresponding to a given false alarm probability to be determined .    as in the circular orbit case",
    ", there is an analytic estimate for the distribution of noise powers at a single frequency .",
    "the distribution of powers for gaussian noise at a single frequency is given by the @xmath68 distribution ( hoel , port , & stone 1971 ) .",
    "integrating this , we find ) becomes @xmath69 for @xmath70 .",
    "since this is also the cumulative distribution of @xmath71 , this limit applies to the case where the noise is known in advance , with @xmath72 defined without the normalizing @xmath73 factor . ]",
    "@xmath74 where @xmath64 .",
    "the analytic distribution is compared to numerical calculations in figure [ fig : powers ] .",
    "the symbols are the results of numerical calculations for data sets with @xmath75 .",
    "the top panel is for a search at a single frequency , and the bottom panel is for a wide frequency search between periods of 1 day and 10 years .",
    "the results for the ls periodogram ( circles ) , and the corresponding analytic distribution ( dotted curves ) agree extremely well . for the keplerian periodogram",
    ", we show results with the period held fixed during the fit , and with the period allowed to vary during the fit .",
    "the solid curves are the analytic distribution of equation ( [ eq : keplerprob ] ) .",
    "the agreement is good for the case where period is held fixed . when the period is allowed to vary during the fit , the powers are systematically larger , since the search algorithm is able to step off the period grid and find a better fit . for this example , the best - fit number of independent frequencies is @xmath76 for the ls periodogram , and @xmath77 for the keplerian periodogram .",
    "this is roughly 3 times or equal to the simple estimate @xmath78 respectively .",
    "the analytic distribution allows a simple method for estimating the significance of a keplerian fit to radial velocity data .",
    "first , given @xmath63 from the keplerian fit , and @xmath65 from the fit of a constant to the data , calculate the power @xmath34 using equation ( [ eq : ze ] ) .",
    "an estimate of the false alarm probability is then @xmath79 ( eqs .",
    "[ 5 ] and [ 6 ] ) , where @xmath80 is the probability distribution given by equation ( [ eq : keplerprob ] ) .",
    "the number of independent frequencies is roughly @xmath46 , where @xmath81 is the duration of the observations , and @xmath82 the orbital frequency range searched during the fit .",
    "figure [ fig : fap ] shows the fap as a function of @xmath19 for different values of @xmath83 .",
    "solid curves are for @xmath84 , dotted curves are for @xmath85 .",
    "this figure can be used for a quick assessment of the fap associated with a particular keplerian fit .",
    "for example , consider a set of radial velocity measurements with @xmath86 and @xmath87 ( or a reduced @xmath6 of @xmath88 ) , and with the best fitting keplerian having @xmath89 ( reduced @xmath6 of @xmath90 ) .",
    "inspection of figure [ fig : fap ] shows that in this case , with @xmath86 and @xmath91 , the false alarm probability is @xmath92 .",
    "in this section , we show how to understand the lomb - scargle periodogram in terms of basic probabilities , i.e.  a bayesian approach .",
    "this leads naturally to the lomb - scargle statistic for sinusoid fits , and gives a different way to think about the number of independent frequencies .",
    "a comprehensive and detailed discussion of these issues can be found in a series of papers by bretthorst ( bretthorst 1988 , 2001a , b , c ) on the application of bayesian techniques to spectral analysis , as well as scargle ( 2002 ) and loredo & chernoff ( 2003 ) .",
    "in addition , ford ( 2003 ) discusses the advantages of using likelihood functions to calculate uncertainties in orbital parameters .",
    "those readers interested only in the practical results on detection thresholds should skip ahead to  [ sec : detect ] .",
    "we start with the likelihood functions with and without a signal present ( sivia 1996 ) . for a sinusoid fit to the data with parameters @xmath93 ,",
    "the probability of the data given the sinusoid model is @xmath94 which comes from drawing each observed velocity from a gaussian distribution .",
    "here , @xmath95 is not the minimum value of @xmath6 , but is the value of @xmath6 for a particular choice of the parameters @xmath96 .",
    "since we also have keplerian fits in mind , we generalize to @xmath97 parameters , and marginalize or integrate over them to obtain the probability of the data given the presence of a signal , @xmath98 similarly , without a signal present , we may write @xmath99 where we integrate over the constant term @xmath100 , the only parameter in this case . in these expressions , the notation `` 1 '' or `` 0 '' indicates the presence or absence of a planet , and `` @xmath101 '' represents a particular set of radial velocity measurements .",
    "we now follow the detection theory approach of wainstein & zubakov ( 1962 ) .",
    "we write the total probability of the data as @xmath102 where @xmath103 and @xmath104 are the prior probabilities that there is or is not a signal present , and we assume here that the only possibilities are that zero or one planet is present in the data . in this framework , the false alarm probability is the probability that there is no signal present given the data , @xmath105 . combining bayes theorem , @xmath106 , with equation ( [ eq : totalprob ] ) , this is @xmath107 where we have defined an odds ratio @xmath108 for @xmath109 , the false alarm probability is the inverse of the odds ratio , @xmath110",
    ". therefore , the detection threshold corresponds to a critical value of @xmath111 . as in the usual frequentist application of the periodogram , the choice of detection threshold represents a compromise between the desired number of false alarms versus false dismissals of real signals ( see appendix of wainstein & zubakov 1962 for a detailed discussion of this issue ) .",
    "we now calculate @xmath111 and show that it has a direct relationship to the periodogram .",
    "the integrals in equations ( [ eq : pdm ] ) and ( [ eq : pd0 ] ) may be evaluated by expanding the integrand around its maximum in terms of the parameters @xmath112 .",
    "we consider the two cases in which the noise @xmath18 is known or unknown . in the first case ,",
    "expanding @xmath6 near its minimum gives @xmath113 , where the curvature matrix @xmath114 is the inverse of the correlation matrix of the @xmath6 fit , @xmath115 ( e.g.  press et al .",
    "the integral over the parameters is then a standard multidimensional gaussian integral , giving @xmath116 where @xmath117 . evaluating @xmath118 in a similar way , and taking the ratio , gives @xmath119^{1/2}\\ { p(1)\\over p(0)}\\ \\exp\\left({\\delta\\chi^2\\over 2}\\right)\\ ] ] where @xmath120 ( @xmath121 ) is the covariance matrix of the fit without ( with ) a signal present , @xmath122 is the number of parameters describing the signal , and @xmath123 .",
    "when @xmath18 is unknown , we integrate or marginalize equation ( [ eq : pdm ] ) over @xmath18 , taking limits of integration to be @xmath124 to @xmath125 .",
    "this gives @xmath126 with a similar result for equation ( [ eq : pd0 ] ) .",
    "the integrals over parameter space are performed as previously , by making a gaussian approximation near the peak of the integrand .",
    "this gives @xmath127^{1/2 } \\",
    "{ p(1)\\over p(0)}\\ \\left({\\chi^2_{\\rm mean}\\over\\chi^2_{\\rm circ}}\\right)^{\\nu/2}.\\ ] ]    to see the relation of this result to the periodogram , we write @xmath128^{1/2 } \\ { p(0)\\over p(1)},\\ ] ] giving @xmath129 identical to equation ( 6 ) , with @xmath80 given by either equation ( [ eq : prob ] ) or ( [ eq : prob2 ] ) depending on whether @xmath18 is known or unknown here for a circular orbit rather than @xmath130 .",
    "the loss of one degree of freedom comes about because of the integration over period .",
    "we also mention here that this derivation of the probability distributions applies to either choice of periodogram normalization . using an analysis of variance approach",
    ", schwarzenberg - czerny ( 1998 ) showed that normalizing the periodogram by the variance of the data or by the variance of the residuals was statistically equivalent , but led to a different form for @xmath80 in each case ( see table 9 in cumming et al .",
    "in fact , both these distributions are a direct rewrite of the last term in equation ( [ eq : lambda2 ] ) , using the respective definition of @xmath28 . ] .    for sinusoid fits ,",
    "we have recovered the ls periodogram , but with a new interpretation of @xmath40 . for independent parameters ,",
    "the covariance matrix is diagonal , so that @xmath131 , where @xmath132 is the uncertainty in parameter @xmath12 ( e.g.  press et al .",
    "1992 ) . for circular orbits , this gives an estimate @xmath133 the first term is the estimate for @xmath40 that we gave in  2.2 , the range of frequencies searched divided by the frequency resolution . however , we see that in a bayesian approach , @xmath40 also includes the range of amplitudes and phase considered , and the prior probability of a signal being present .",
    "this corresponds to a different picture in which rather than making many trials searching for the lowest @xmath6 , we have instead integrated over all possible values of the parameters , weighting each choice by its relative probability . for fits of keplerian orbits ,",
    "the probability distribution of @xmath67 is given by equation ( [ eq : keplerprob ] ) , which is similar to but slightly different from equations ( [ eq : lambda1 ] ) and ( [ eq : lambda2 ] ) .",
    "the significance of this difference is not clear .",
    "the most useful application of this method is as a powerful tool for population analyses . here",
    ", we have discussed the choice between detection and non - detection so that the connection to the periodogram could be seen . however ,",
    "the advantage of the bayesian approach is that no decision regarding detection needs to be made . instead",
    ", both possibilities can be included , with the probability of each calculated as @xmath134 and @xmath105 .",
    "for example , integrating equation ( [ eq : like ] ) over the `` nuisance '' parameters @xmath135 and @xmath100 gives @xmath136 for each star .",
    "this can be used to study the underlying mass and orbital period distribution .",
    "further integration of @xmath136 gives @xmath137 , equivalent to the periodogram , or @xmath138 from which limits on @xmath139 can be derived .",
    "extension of this approach to eccentric orbits , or multiple planets , is straightforward in principle , but in practice involves more complex integrals ( see ford 2003 for a suggestion of how to evaluate them ) .",
    "in this section , we use the ls periodogram and the keplerian periodogram discussed in  2 to derive analytic expressions for the velocity thresholds .",
    "we discuss orbital periods @xmath140 shorter and longer than the duration of the observations @xmath81 separately .",
    "we first consider circular orbits , and use the ls periodogram .",
    "figure [ fig : signoise ] shows the signal to noise ratio @xmath142 required for 50% and 99% detection probability as a function of the number of observations .",
    "the squares show numerical calculations for sets of @xmath19 observations with realistic spacing between observation times . for each set of observation times",
    ", we use a monte carlo method to determine the detection threshold , generating sequences of velocities drawn from a gaussian distribution , and finding the power exceeded in 0.1% of trials ( the 99.9% detection threshold ) .",
    "we search for periods between 2 days and 10 years .",
    "we then make fake data sets with increasing signal amplitude @xmath139 until the signal is detected in either 50% or 99% of trials .",
    "to obtain an analytic estimate , we first write down the detection threshold @xmath43 corresponding to a critical false alarm probability @xmath41 ( where @xmath143 ) . equations ( [ eq : prob ] ) and ( [ eq : fa2 ] ) give @xmath144,\\ ] ] for a given number of independent frequencies @xmath40 .",
    "when a signal of amplitude @xmath139 is present , the periodogram power @xmath72 has a distribution of values because of noise fluctuations . for large signal amplitude or @xmath19 , the distribution of periodogram powers when a signal is present is gaussian with mean @xmath145 , and variance @xmath146 ( groth 1975 ) , where @xmath147 ( scargle 1982 ; horne & baliunas 1986 ) . in this limit ,",
    "the probability of detecting a signal with mean amplitude @xmath145 for a given detection threshold @xmath43 is @xmath148.\\ ] ] setting @xmath149 gives the signal to noise ratio needed to detect the signal 50% of the time , @xmath150^{1/2},\\ ] ] or , for large @xmath19 , @xmath151^{1/2}\\hspace{0.5 cm}(n\\gg 1),\\ ] ] which shows the expected @xmath152 behavior , where @xmath153 . ] .",
    "the solid lines in figure [ fig : signoise ] show this analytic estimate for @xmath154 .",
    "we include a multiplicative factor of @xmath155 for the 99% detection probability curve ( this factor is given by equation ( [ eq : erf ] ) with @xmath156% ) .",
    "figure [ fig : signoise ] shows that @xmath157@xmath158 is required to be able to detect an orbit with @xmath159@xmath160 , with @xmath161 required to reach amplitudes as small as @xmath162 .",
    "how does that compare to the case where we know the noise level @xmath18 ?",
    "the appropriate formula is then equation ( [ eq : sn ] ) for all @xmath19 .",
    "the dotted curves in figure [ fig : signoise ] show the 50% and 99% detection probability curves in this case .",
    "knowing the noise level in advance gives a significant improvement , allowing a detection of the signal for @xmath163 .",
    "the sparse sampling of the data may increase the detection threshold somewhat over this estimate ( nelson & angel 1998 ) .",
    "it is also interesting here to compare the detection threshold of the ls periodogram with a @xmath6 test for variability .",
    "the dashed line in figure [ fig : signoise ] shows the signal to noise ratio that gives a @xmath6 exceeding the expected value 50% of the time , assuming that the noise level @xmath18 is a known quantity .",
    "here we choose the detection threshold to correspond to a fap of 0.1% .",
    "excess variability at the @xmath164 level is apparent with only a handful of observations .",
    "we next discuss the effect of non - zero eccentricity .",
    "figure [ fig : detect_eff ] shows the detection probability as a function of eccentricity for signal to noise ratios of @xmath165 and @xmath125 , where @xmath125 means that we sample the velocity curve without adding noise .",
    "the top panel shows results for a data set with 16 observations , the lower panel for 39 observations .",
    "the dotted curves show the detection probability using the ls periodogram .",
    "the solid curves show the detection probability using the keplerian periodogram defined in equation ( [ eq : ze ] ) .",
    "not surprisingly , the ls periodogram fails to detect orbits with large eccentricities , particularly for small @xmath19 , whereas fitting keplerian orbits increases the detection probability for eccentric orbits .",
    "figure [ fig : detect_eff ] shows that even when fitting keplerian orbits , detectability decreases for @xmath5 .",
    "there are two reasons for this .",
    "first , even for @xmath166 , we find detection efficiencies @xmath167 ( @xmath168@xmath169% ) for @xmath170 .",
    "in the cases that are not detected , the keplerian fitting routine fails to find the correct solution .",
    "this emphasises the difficulty of finding the global minimum in the complicated @xmath6 space for these nonlinear solutions .",
    "the second effect , dominating at lower @xmath142 , is the uneven sampling of the data , which can lead to a poorly - resolved periastron passage .",
    "an example is shown in figure [ fig : detect_example ] , in which we show two sets of observations of an orbit with @xmath171 .",
    "both fitted lightcurves ( solid curves ) have a lower @xmath6 than the true solution ( dotted curve ) , but whereas the data in the upper panel lead to a detection , the data in the lower panel do not . in the lower panel ,",
    "only a single measurement has been made during the periastron passage .",
    "this greatly reduces the @xmath172 when the keplerian orbit is included in the fit .",
    "an additional danger is that a single discrepant data point might arise due to a systematic error , perhaps making the fit in the lower panel of figure [ fig : detect_example ] worrying in a real life example .",
    "figure [ fig : e1 ] summarizes the effect of eccentricity .",
    "we plot the signal to noise ratio needed for a detection efficiency ( de ) of 50% or 99% as a function of eccentricity .",
    "the solid curves are for the keplerian periodogram , and the dotted curves are for the ls periodogram .",
    "the rapid increase in @xmath142 for the 99% de solid curve at @xmath173 is due to the failure to detect even high signal to noise orbits for @xmath174 . for @xmath2 ,",
    "the effect of eccentricity on the amplitude needed for detection is small .",
    "we have not yet discussed the dependence of the velocity threshold on orbital period .",
    "figure [ fig : threshold ] shows the amplitude needed for 50% and 99% de for @xmath175 as a function of period .",
    "we discuss the long period behavior ( @xmath176 ) in the next section .",
    "the dotted lines are the analytic result for @xmath154 , and compare well with the numerical calculations .",
    "this figure shows that the amplitude threshold is not very sensitive to period for @xmath141 .",
    "there is some loss of sensitivity at periods related to a month and a year , and particularly at @xmath177 day , introduced by the time sampling of the data , but this is a small effect even for @xmath178 .",
    "this insensitivity can also be seen in the curves of walker et al .",
    "( 1995 ) , nelson & angel ( 1998 ) , and cmb99 .",
    "it is a result of the uneven sampling which gives good phase coverage for many frequencies ( press et al .",
    "therefore the velocity threshold @xmath179 characterizes the short period detectability for most periods @xmath180 .      at long periods ,",
    "the detection sensitivity drops because the observations cover only part of an orbit .",
    "for circular orbits , eisner & kulkarni ( 2001 ) pointed out that there is a correlation between the fitted phase and amplitude at long periods , and derived analytic expressions for the velocity threshold . here , we adopt a slightly different approach . it is useful to think of `` sine - like '' and `` cosine - like '' phases , depending on whether the orbit is close to a velocity maximum / minimum or to a zero crossing .",
    "these two cases are illustrated by figure [ fig : longperiod ] .",
    "for @xmath181 , the velocity variation due to the signal is @xmath182 for a sine - like variation , or @xmath183 for a cosine - like variation .",
    "setting @xmath184 then gives an estimate for the velocity amplitude needed for detection .",
    "averaging over phase introduces slightly different numerical factors .",
    "we find that a good approximation to the velocity threshold is @xmath185 for @xmath186 , or @xmath187 for @xmath188 , where @xmath189 is the detection efficiency .",
    "the scaling @xmath190 corresponds to @xmath191 ; the scaling @xmath192 corresponds to @xmath193 .",
    "the reason that the scalings depend on the detection efficiency is that a sine - like phase gives a larger @xmath194 than a cosine - like phase .",
    "so for a 50% detection threshold ( @xmath195 ) the amplitude must be large enough that sine - like phases are detected , but cosine - like phases do not have to be . for a 99% threshold however ( @xmath196 ) , almost all phases must be detected , requiring a large amplitude .",
    "eventually , at very long periods , almost all phases are sine - like , and the scaling changes to @xmath197 once more .",
    "figure [ fig : threshold ] compares the analytic and numerical results at long periods . for this particular example , the change in scaling of the 99% threshold from @xmath198 to @xmath197 can be seen at @xmath199 .    in their investigation of detectabilities ,",
    "nelson & angel ( 1998 ) adopted the square of the best fitting amplitude @xmath7 as their test statistic .",
    "eisner & kulkarni ( 2001 ) pointed out that this leads to reduced sensitivity at long periods , because when fitting sinusoids to noise only , one finds that the amplitude is strongly correlated with the fitted phase .",
    "the cosine - like phases have much larger fitted amplitudes than the sine - like phases , and so the velocity threshold has a @xmath192 scaling . indeed",
    ", our results nicely explain the empirical scaling found by nelson & angel ( 1998 ) , @xmath200 , with @xmath201 and @xmath202 .",
    "our formula gives @xmath203 and @xmath204 .",
    "eisner & kulkarni ( 2001 ) adopted an `` amplitude - phase '' analysis to account for this correlation , in which the detection threshold is set by an ellipse in the @xmath139@xmath135 plane .",
    "they showed that the sensitivity was significantly improved .",
    "however , their proposed method is unnecessarily complicated .",
    "the correlation between amplitude and phase is automatically included in the ls periodogram , which is much simpler to use since it is defined in terms of the single variable @xmath8 .",
    "we have implemented the method of eisner & kulkarni ( 2001 ) and find that it matches the sensitivity of the periodogram at all periods .",
    "figure [ fig : detect_ratio ] shows the ratio of the velocity thresholds from the periodogram to the cosine - like scaling of equation ( [ eq : long2 ] ) .",
    "comparison with figures 8 , 9 , and 10 of eisner & kulkarni ( 2001 ) shows that the ls periodogram has equal sensitivity compared to the amplitude - phase technique .",
    "walker et al .",
    "( 1995 ) looked for long term periodicities by fitting a quadratic to the data @xmath205 , and checking for a significant reduction in @xmath6 using an f - test .",
    "cmb99 adopted a similar approach but with linear fits to the data .",
    "how is this related to the long period sensitivity of the periodogram ?",
    "in fact , for periods @xmath206 , the periodogram is no longer sensitive to the period .",
    "a quadratic fit gives a relation between the amplitude and period @xmath207 so that the best fitting velocity amplitude is determined for all periods ( @xmath208 ) by the fit .",
    "we have checked the sensitivity to long period circular orbits of an f - test based on quadratic fits to the data , and find that quadratic fits reproduce the sensitivity of the periodogram for long periods . in the regime",
    "where the detectable amplitude scales @xmath197 , a linear fit is adequate to detect the signal gives a period measurement @xmath209 which can be inserted into equation ( [ eq : quadk ] ) to find the amplitude @xmath139 .",
    "this implies that if we could make an accurate enough measurement of the radial velocity curve , the complete orbital solution could be determined . ] .",
    "however , the false alarm probability used for the f - test must reflect the number of additional trials that are carried out at high frequency using the periodogram .",
    "for example , a search for long period orbits only might adopt a fap for the f - test of 1% .",
    "however , if short period orbits are also searched , and the number of independent frequencies for @xmath141 is @xmath210 , then we should choose a fap of @xmath211 .",
    "detection efficiency plots for long period eccentric orbits are shown in figures [ fig : longecc1 ] and [ fig : longecc2 ] .",
    "figure [ fig : longperiod ] and the related discussion makes it straightforward to understand the detectability in this case .",
    "at very long periods , the number of parameters needed to describe the data is 1 or 2 as discussed above , and therefore the scalings with period are the same as the ls periodogram .",
    "however , the transition into the long period regime happens at longer orbital periods for eccentric orbits , because of the distorted nature of the lightcurve .",
    "the width of the periastron passage is @xmath212 , so that equations ( [ eq : long1 ] ) and ( [ eq : long2 ] ) still apply , but with the substitution @xmath213 .",
    "the dotted curves in figure [ fig : longecc2 ] show the analytic formula with this substitution . therefore at long periods , eccentric orbits are more easily detected for a given @xmath139 .",
    "the main results of this paper are ( i ) a method for estimating the significance of a keplerian fit to radial velocity data , and ( ii ) an analytic expression for the velocity threshold of single planets in terms of the number and duration of the observations , number of independent frequencies , and the required false alarm probability . for circular orbits , equation ( [ eq : sn1 ] ) ( or eq .  [ [ eq : sn ] ] for @xmath214 )",
    "gives the velocity amplitude threshold at short periods ( @xmath141 ) .",
    "equations ( [ eq : long1 ] ) and ( [ eq : long2 ] ) give the amplitude threshold at long periods ( @xmath176 ) as a function of the required detection efficiency . at long periods , the 99% detection threshold scales as @xmath0 , whereas the 50% detection threshold scales as @xmath1 .",
    "we presented a straightforward generalization of the lomb - scargle periodogram to keplerian orbits , based on the improvement of @xmath6 when a keplerian orbit is included in the fit , and discussed a monte carlo method to calculate the false alarm probability associated with the fit .",
    "an simple analytic estimate of the false alarm probability is as follows .",
    "given @xmath63 from the keplerian fit , and @xmath65 from the fit of a constant to the data , first calculate the power @xmath34 using equation ( [ eq : ze ] ) .",
    "an estimate of the false alarm probability is then @xmath215 , where @xmath46 is the number of independent frequencies ( @xmath82 is the frequency range searched ) , and @xmath80 is the probability distribution given by equation ( [ eq : keplerprob ] ) .",
    "alternatively , figure [ fig : fap ] may be used to find the fap for a given @xmath19 and @xmath83 ratio .",
    "this figure should prove useful for a quick estimate of the fap associated with a keplerian fit .",
    "we used the keplerian periodogram to investigate the effect of eccentricity on detectability .",
    "eccentricity acts to make detection more difficult at short periods , where the uneven sampling often results in inadequate phase coverage during the rapid periastron passage of an eccentric orbit . at long periods , the increased velocity amplitude and acceleration near periastron _ increase _ detectability .",
    "the transition to the long period regime occurs for orbital periods @xmath216 .",
    "we have also discussed the statistics of the lomb - scargle periodogram , including a derivation of the periodogram from basic probability theory .",
    "this bayesian approach gives a simple derivation of the statistical distribution of periodogram powers for gaussian noise , and clarifies the nature of different periodogram normalizations .",
    "the best statistic to use at both short and long orbital periods is @xmath172 , the improvement in @xmath6 when the planet is included in the velocity fit . using the square of the fitted amplitude @xmath7 ( nelson & angel 1998 ) results in decreased sensitivity at long periods . a seperate analysis of @xmath139 and phase @xmath135 recovers this sensitivity at long periods ( eisner & kulkarni 2001 ) , but is unnecessary if @xmath172 is adopted as the statistic .",
    "both nelson & angel ( 1998 ) and eisner & kulkarni ( 2001 ) argue for the superiority of a `` least - squares '' rather than `` periodogram '' approach to this problem .",
    "partly , this is based on a preference for dealing directly with the parameters of the fit ( amplitude @xmath139 and phase @xmath135 for circular orbits ) and the resulting @xmath6 , rather than a `` black box '' periodogram .",
    "for example , the original ls periodogram must be `` modified '' to include a constant term as a free parameter at each frequency ( walker et al .",
    "1995 ; nelson & angel 1998 ; cmb99 ) , whereas this arises naturally when thinking about a @xmath6 fit of a model to the data .",
    "in addition , since the form of the signal is exactly known , i.e.  a keplerian orbit , the argument is that fourier or spectral analysis of the data is not the most efficient way to look for the signal .",
    "we hope in this paper to have clarified the equivalence of the least squares and periodogram approaches when @xmath8 is used as the test statistic .",
    "we have considered only single planets in this paper , whereas multiple systems of planets are common . in cases where planets are well - seperated in period or in amplitude",
    ", our results may be applicable .",
    "for example , a linear trend in the velocities is often included in orbit fits to subtract any long term velocity variations due to a long period companion .",
    "our results apply to this case if the number of degrees of freedom is reduced by 1 , so that @xmath217 becomes @xmath218 , @xmath130 becomes @xmath219 etc .",
    "( see walker et al .",
    "1995 ; cmb99 for discussion of linear and quadratic `` background models '' ) .",
    "of course , this correction is only relevant for small @xmath19 , for large @xmath19 , the results carry over directly .",
    "another case in which two planets are close in period , but well - seperated in amplitude is discussed by narayan , cumming , & lin ( 2004 , in preparation ) .    in many situations",
    "when looking for a periodic signal , it is possible to detect signals with amplitudes much less than the background noise level . in the case of planet searches ,",
    "this is not the case , because of two factors .",
    "the first , which we have discussed in this paper , is statistical .",
    "the small number of observations limit the detectable amplitude to @xmath220@xmath221 for @xmath222@xmath223 ( e.g.  see figure 1 ) . here",
    ", @xmath18 refers to a combination of measurement errors , both statistical and systematic , and intrinsic stellar `` jitter '' . when the number of observations is less than @xmath224 , it is impossible to characterize an orbit , as was previously pointed out by nelson & angel ( 1998 ) .",
    "detection of signals @xmath225 requires @xmath161 .",
    "the second factor which limits detectability is uncertainty surrounding the stellar jitter .",
    "this may arise from convective inhomogeneities , or rotational modulation of magnetic features on the surface ( saar & donahue 1997 ) , all processes with characteristic timescales comparable to extrasolar planet orbital periods .",
    "therefore , although the magnitude of the stellar jitter can be estimated based on stellar properties ( saar et al .  1998 ) , its time variability is a significant source of uncertainty .",
    "planet detections with @xmath226 require a much better understanding of jitter .",
    "observations of magnetic activity indicators simultaneous with the radial velocity measurements offer some hope of correcting for these effects ( saar & fischer 2000 ; paulson et al .",
    "2002 ) , but this work is in its early stages .",
    "improvement in measurement errors to the @xmath16 level will help to disentangle systematic errors and stellar jitter effects .",
    "understanding the distribution of planet orbital period , mass , and eccentricity at low masses , long orbital periods , and large eccentricities requires careful analysis of the radial velocity data for each survey ( e.g.  walker et al .  1995 ; cumming et al .",
    "1999 ; cumming et al .  2003 ; santos et al .  2003 ) . nonetheless , it is interesting to compare the detection thresholds we find in this paper with the observed planet properties . for a mass @xmath227 , the velocity amplitude is @xmath228 where @xmath140 is the orbital period , @xmath227 is the mass of the planet , and @xmath229 is the mass of the star . in figures [ fig : mp ] and",
    "[ fig : me ] , we show the mass , periods , and eccentricities of known planets compared to the detection curves . in figure",
    "[ fig : mp ] , we show curves of 50% and 99% detection efficiency for @xmath230 and 3 , 6 , and 12 years of observations with 5 observations per year . these curves roughly match the observed cutoffs at low masses and long periods .",
    "jupiter s position is indicated by a black square for comparison , indicating that jupiter analogs will be detectable in the near future . in figure",
    "[ fig : me ] , we show 50% and 99% detection efficiency curves for short period orbits , and compare them with the observed @xmath139-@xmath61 distribution .",
    "the lack of observed highly eccentric orbits is possibly due to physical effects which limit their survival ( e.g.  ford , havlikova , & rasio 2001 ) .",
    "however , _ our results emphasise that there remain significant selection effects against eccentric orbits for @xmath3 , and the small number of highly eccentric planets discovered so far may reflect this_. in this regard , it is worth noting that the most eccentric orbit discovered so far , with @xmath231 ( hd  80606 ; naef et al .",
    "2001 ) , also has one of the largest amplitudes @xmath232 ( @xmath233 ) .",
    "future observations may reveal lower mass planets in highly eccentric orbits that have hereto gone undiscovered .",
    "i thank geoff marcy and greg laughlin for useful discussions and insights , alex mcdaniel for comments on an earlier version of the manuscript , and ira wasserman , daniel reichart , and greg ushomirsky for useful suggestions and conversations about bayesian statistics .",
    "the referee kindly pointed me towards references in the statistics literature .",
    "i acknowledge support from nasa through hubble fellowship grant hf-01138 awarded by the space telescope science institute , which is operated by the association of universities for research in astronomy , inc .",
    ", for nasa , under contract nas 5 - 26555 ."
  ],
  "abstract_text": [
    "<S> radial velocity surveys are beginning to reach the time baselines required to detect jupiter analogs , as well as sub - saturn mass planets in close orbits . </S>",
    "<S> therefore it is important to understand the sensitivity of these surveys at long periods and low amplitudes . in this paper , </S>",
    "<S> i derive analytic expressions for the detectability of planets at both short and long periods , for circular and eccentric orbits . in the long period regime , </S>",
    "<S> the scaling of the detection threshold with period depends on the desired detection efficiency . </S>",
    "<S> the 99% velocity threshold scales as @xmath0 , whereas the 50% velocity threshold scales as @xmath1 . </S>",
    "<S> i suggest an extension of the lomb - scargle statistic to keplerian orbits , and describe how to estimate the false alarm probability associated with a keplerian fit . </S>",
    "<S> i use this keplerian periodogram to investigate the effect of eccentricity on detectability . at short periods , </S>",
    "<S> detectability is reduced for eccentric orbits , mainly due to the sparse sampling of the periastron passage , whereas long period orbits are easier to detect on average if they are eccentric because of the steep velocity gradients near periastron . </S>",
    "<S> fitting keplerian orbits allows the lost sensitivity at short orbital periods to be recovered for @xmath2 , however there remain significant selection effects against eccentric orbits for @xmath3 , and the small number of highly eccentric planets discovered so far may reflect this . </S>",
    "<S> finally , i present a bayesian approach to the periodogram which gives a simple derivation of the probability distributions of noise powers , clarifies why the periodogram is an appropriate way to search for long period signals , and emphasises the equivalence of periodogram and least squares techniques .    </S>",
    "<S> binaries : spectroscopic  methods : statistical  planetary systems </S>"
  ]
}