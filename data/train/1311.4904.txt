{
  "article_text": [
    "a word @xmath0 is balanced if and only if for any @xmath1 factors of @xmath0 of the same length , and for any letter @xmath2 , one has @xmath3 , where @xmath4 denotes the number of @xmath2 s in the word @xmath5 .",
    "balanced words appear in several problems in computer science .",
    "for example , altman , gaujal and hordijk @xcite proved that balanced words are optimal sequences for some classes of scheduling problems , such as routing among several systems .",
    "an interesting problem arising in this context is that of constructing infinite balanced words with assigned frequencies of letters . there is a conjecture of a. s. fraenkel @xcite , originally stated in the context of number theory , that is equivalent to the following :",
    "for any fixed @xmath6 , there is only one infinite balanced word ( up to letter permutation ) over an alphabet of size @xmath7 , in which all letters have different frequencies , and this word is periodic .",
    "the fraenkel conjecture has been proved true for small alphabet sizes ( see @xcite and references therein ) , but the general problem remains open .    for any alphabet @xmath8 of size at least two , there exist infinite words over @xmath8 that are balanced and aperiodic . when @xmath9 , these are called infinite sturmian words .",
    "sturmian words are very rich from the combinatorial point of view , and because of this fact they have a lot of equivalent definitions and characterizations ( see , as a classical reference , ( * ? ? ?",
    "* chapter  2 ) ) .",
    "however , if the fraenkel conjecture is true for every @xmath10 , the only balanced infinite words that are aperiodic and have different letter frequencies are the infinite sturmian words .",
    "a finite sturmian word ( or , briefly , a sturmian word ) is a factor of some infinite sturmian word .",
    "the set @xmath11 of sturmian words therefore coincides with the set of binary balanced finite words .    if one considers extendibility within the set @xmath11 of sturmian words , one can define left special sturmian words ( resp .",
    "right special sturmian words ) @xcite as those words @xmath0 over the alphabet @xmath12 such that @xmath13 and @xmath14 ( resp .",
    "@xmath15 and @xmath16 ) are both sturmian words . for example",
    ", the word @xmath17 is left special since @xmath18 and @xmath19 are both sturmian words , but is not right special since @xmath20 is not a sturmian word",
    ".    left special sturmian words are precisely the binary words having suffix automaton is the minimal deterministic finite state automaton accepting the set of suffixes of @xmath0 . ] with minimal state complexity ( cf .",
    "@xcite ) . from combinatorial considerations",
    "one has that right special sturmian words are the reversals of left special sturmian words .",
    "the sturmian words that are both left and right special are called bispecial sturmian words .",
    "they are of two kinds : strictly bispecial sturmian words , that are the words @xmath0 such that @xmath21 , @xmath22 , @xmath23 and @xmath24 are all sturmian words ( e.g.  @xmath25 ) , or non - strictly bispecial sturmian words otherwise ( e.g.  @xmath26 ) .",
    "strictly bispecial sturmian words are also called central words , and have been deeply studied ( see for example  @xcite ) because they constitute the kernel of the theory of sturmian words .",
    "non - strictly bispecial sturmian words , instead , received less attention",
    ".    one important field in which sturmian words arise naturally is discrete geometry .",
    "indeed , infinite sturmian words can be viewed as the digital approximations of euclidean straight lines in the plane .",
    "it is known that given a point @xmath27 in the grid @xmath28 , with @xmath29 , there exists a unique path that approximates from below ( resp .  from above ) the euclidean segment joining the origin @xmath30 to the point @xmath27 .",
    "if one encodes horizontal and vertical unitary segments with the letters @xmath2 and @xmath31 respectively , this path is called the lower ( resp .",
    "upper ) christoffel word and @xmath32 be coprime in the definition of christoffel word . here",
    "we follow the definition given in @xcite and do not require this condition . ]",
    "associated to the pair @xmath27 , and is denoted by @xmath33 ( resp .",
    "@xmath34 ) . by elementary geometrical considerations ,",
    "one has that for any @xmath29 , @xmath35 for some word @xmath36 , and @xmath37 , where @xmath38 is the reversal of @xmath36 . if ( and only if ) @xmath39 and @xmath32 are coprime , the christoffel words @xmath33 and @xmath34 are primitive ( that is , they are not a concatenation of copies of a shorter word ) .",
    "a well known result of jean berstel and aldo de luca @xcite is that a word @xmath36 is a strictly bispecial sturmian word if and only if @xmath40 is a primitive lower christoffel word ( or , equivalently , if and only if @xmath41 is a primitive upper christoffel word ) . as a main result of this paper ,",
    "we show that this correspondence holds in general between bispecial sturmian words and christoffel words .",
    "more precisely , we prove ( in theorem [ theor : main ] ) that @xmath36 is a bispecial sturmian word if and only if there exist letters @xmath42 in @xmath43 such that @xmath44 is a christoffel word .",
    "this characterization allows us to prove an enumerative formula for bispecial sturmian words ( corollary [ cor : formula ] ) : there are exactly @xmath45 bispecial sturmian words of length @xmath46 , where @xmath47 is the euler totient function , i.e. , @xmath48 is the number of positive integers smaller than or equal to @xmath46 and coprime with @xmath46 . surprisingly , enumerative formulae for left special , right special and strictly bispecial sturmian words were known @xcite , but to the best of our knowledge we exhibit the first proof of an enumerative formula for non - strictly bispecial ( and therefore for bispecial ) sturmian words .",
    "we then investigate the minimal forbidden words for the set of finite sturmian words . recall that the set of minimal forbidden words of a factorial language is the set of words of minimal length that do not belong to the language @xcite .",
    "more precisely , given a factorial language @xmath49 over an alphabet @xmath8 , a word @xmath50 , with @xmath51 , is a minimal forbidden word for @xmath49 if @xmath52 and @xmath53 are in @xmath49 , but @xmath54 is not .",
    "minimal forbidden words represent a powerful tool to investigate the structure of a factorial language ( see  @xcite ) , such as the language of factors of a ( finite or infinite ) word , or of a set of words .",
    "they also appear in different contexts in computer science , such as symbolic dynamics @xcite , data compression ( where the set of minimal forbidden words is often called an antidictionary ) @xcite , or bio - informatics ( where they are also called minimal absent words ) @xcite .",
    "we give a characterization of minimal forbidden words for the language @xmath11 of sturmian words in theorem [ theor : mf ] .",
    "we show that they are precisely the words of the form @xmath55 such that @xmath56 is a non - primitive christoffel word , where @xmath57 .",
    "this characterization allows us to give an enumerative formula for the set of minimal forbidden words of @xmath11 ( corollary [ cor : formulamf ] ) : there are exactly @xmath58 minimal forbidden words of length @xmath46 for every @xmath59 .",
    "the paper is organized as follows . in section  [ sec : wsf ] we recall standard definitions on words and factors . in section  [ sec : stch ]",
    "we deal with sturmian words and christoffel words , and present our main result , and in section  [ sec : en ] we give an enumerative formula for bispecial sturmian words .",
    "finally , in section  [ sec : mf ] , we investigate minimal forbidden words for the language of finite sturmian words .",
    "we give here basic definitions on words and fix the notation .",
    "an alphabet , denoted by @xmath8 , is a finite set of symbols , called letters .",
    "a word over @xmath8 is a finite sequence of letters from @xmath8 .",
    "the length of a word @xmath0 is denoted by @xmath60 . the only word of length @xmath61 is called the empty word and is denoted by @xmath62 .",
    "the set of all words over @xmath8 is denoted by @xmath63 .",
    "the set of all words over @xmath8 having length @xmath46 is denoted by @xmath64 .",
    "any subset @xmath65 of @xmath66 is called a language , and we note @xmath67 the set of words of length @xmath46 in @xmath65 .    given a non - empty word @xmath0 , we denote its @xmath68-th letter by @xmath69 $ ] , @xmath70 .",
    "the reversal of the word @xmath71w[2]\\cdots w[n]$ ] is the word @xmath72w[n-1]\\cdots w[1]$ ] .",
    "we set @xmath73 .",
    "a palindrome is a word @xmath0 such that @xmath74 .",
    "a word is called a power if it is the concatenation of copies of another word ; otherwise it is called primitive . for a letter @xmath75",
    ", @xmath76 is the number of @xmath2 s occurring in @xmath0 .",
    "a positive integer @xmath39 is a period of a word @xmath0 if @xmath77 or @xmath69=w[i+p]$ ] for every @xmath78 . for a word @xmath79 , @xmath75 , @xmath80",
    ", we define @xmath81 .",
    "the set of rotations of a word @xmath0 of length @xmath46 is the set @xmath82 .",
    "note that the rotations of a word @xmath0 are all different if and only if @xmath0 is primitive .",
    "a word @xmath5 is a factor of a word @xmath0 if @xmath83 for some @xmath84 . in the special case @xmath85 ( resp .",
    "@xmath86 ) , we call @xmath5 a prefix ( resp .  a suffix ) of @xmath0 .",
    "we let @xmath87 , @xmath88 and @xmath89 denote the set of prefixes , suffixes and factors of the word @xmath0 , respectively .",
    "the factor complexity of a word @xmath0 is the integer function @xmath90 , @xmath91 .    a factor @xmath36 of a ( finite or infinite ) word @xmath0 is called left special ( resp .",
    "right special ) in @xmath0 if there exist @xmath92 , @xmath93 , such that @xmath94 ( resp .",
    "@xmath95 ) .",
    "a bispecial factor is a factor that is both left and right special .",
    "moreover , a bispecial factor @xmath36 of a word @xmath0 is strictly bispecial if @xmath44 is a factor of @xmath0 for every @xmath96 ; otherwise @xmath36 is non - strictly bispecial .",
    "for example , let @xmath97 .",
    "the left special factors of @xmath0 are @xmath62 , @xmath2 , @xmath26 , @xmath31 and @xmath98 .",
    "the right special factors of @xmath0 are @xmath62 , @xmath2 , @xmath26 and @xmath31 .",
    "therefore , the bispecial factors of @xmath0 are @xmath62 , @xmath2 , @xmath26 and @xmath31 . among these",
    ", only @xmath62 is strictly bispecial .",
    "in the rest of the paper , unless otherwise specified , we fix the alphabet @xmath12 .    a word @xmath99 is called sturmian if it is balanced , i.e. , if for any @xmath1 factors of @xmath0 of the same length , one has @xmath3 ( or , equivalently , @xmath100 ) .",
    "we let @xmath11 denote the set of sturmian words .",
    "the language @xmath11 is factorial ( i.e. , if @xmath101 , then @xmath102 ) and extendible ( i.e. , for every @xmath103 , there exist letters @xmath96 such that @xmath104 ) .",
    "the following definitions are in @xcite .",
    "a sturmian word @xmath103 is left special ( resp .",
    "right special ) if and only if @xmath13 , @xmath105 ( resp .  if @xmath15 , @xmath106 ) .",
    "a bispecial sturmian word is a sturmian word that is both left and right special .",
    "moreover , a bispecial sturmian word is strictly bispecial if and only if @xmath21 , @xmath22 , @xmath23 and @xmath24 are all sturmian word ; otherwise it is non - strictly bispecial .",
    "the definition of special sturmian word is different from the ( widely studied ) definition of special _ factor _ of an infinite sturmian word ( see ( * ? ? ?",
    "* definition 10 ) ) . actually , a word is a bispecial factor of some infinite sturmian word if and only if it is a strictly bispecial sturmian word .",
    "we let @xmath107 , @xmath108 , @xmath109 , @xmath110 and @xmath111 denote the sets of left special , right special , bispecial , strictly bispecial and non - strictly bispecial sturmian words , respectively .",
    "thus , one has @xmath112 .",
    "the following lemma is a reformulation of a result of aldo de luca @xcite .",
    "[ lem : prefsuf ] let @xmath0 be a word over @xmath8",
    ". then @xmath113 ( resp .",
    "@xmath114 ) if and only if @xmath0 is a prefix ( resp .  a suffix ) of a word in @xmath110 .    given a bispecial sturmian word , the simplest criterion to determine if it is strictly or non - strictly bispecial is provided by the following nice characterization @xcite :    [ prop : sturmstrispe ] a bispecial sturmian word is strictly bispecial if and only if it is a palindrome .",
    "another useful result is the following ( ( * ? ? ?",
    "* lemma 7 ) ) .",
    "[ lem : delmi ] if @xmath22 and @xmath23 are both in @xmath11 , then @xmath21 and @xmath24 also are , i.e. , @xmath0 is strictly bispecial .",
    "we can now derive the following classification of sturmian words with respect to their extendibility .",
    "[ prop : bisp ] let @xmath0 be a sturmian word .",
    "then :    1 .",
    "@xmath115 if and only if @xmath0 is strictly bispecial ; 2 .",
    "@xmath116 if and only if @xmath0 is non - strictly bispecial ; 3 .   @xmath117 if and only if @xmath0 is left special or right special but not bispecial ; 4 .   @xmath118 if and only if @xmath0 is neither left special nor right special .    \\1 . and 4 .",
    "follow from the definitions .    for 3 .",
    ", if @xmath22 and @xmath23 are both in @xmath11 , then by lemma [ lem : delmi ] , @xmath21 and @xmath24 also are , and then in this case @xmath115 . on the other hand",
    ", it is also known that if @xmath21 and @xmath24 are in @xmath11 , then at least one between @xmath22 and @xmath23 is in @xmath11 , as a consequence of the fact that if @xmath0 is right special , then there exists a letter @xmath119 such that @xmath120 is right special ( see ( * ? ? ?",
    "* lemma 8) ) , and then in this case @xmath121 .",
    "so , the only possible cases for @xmath117 are when @xmath122 or @xmath123 , for different letters @xmath119 and @xmath124 , i.e. , when @xmath0 is left special or right special but not bispecial .    for 2 . , always by lemma [ lem : delmi ]",
    ", we have that the only possible case for @xmath116 is when @xmath21 , @xmath24 and only one between @xmath22 and @xmath23 are in @xmath11 , i.e. , when @xmath0 is bispecial but not strictly .    note",
    "that , in general , if @xmath49 is a factorial and extendible language over @xmath8 and @xmath125 , one can have that @xmath0 is bispecial in @xmath49 and @xmath126 ( for example if @xmath127 or if @xmath128 ) .",
    "the previous proposition shows that this can not happen for the language @xmath11 .",
    "we now recall the definition of central word @xcite .",
    "a word over @xmath8 is central if it has periods @xmath39 and @xmath32 , with @xmath129 , and length equal to @xmath130 .",
    "the word @xmath131 is central , since it has periods @xmath132 and @xmath133 and length @xmath133 .",
    "the empty word is central ( in this case @xmath134 ) ; in fact , any word of the form @xmath135 , @xmath75 , @xmath136 , is central , since it has periods @xmath137 and @xmath138 and length @xmath130 .",
    "a useful combinatorial characterization of central words is the following ( see  @xcite ) :    [ prop : charcentral ] a word @xmath0 over @xmath8 is central if and only if @xmath0 is the power of a single letter or there exist palindromes @xmath139 such that @xmath140 , for different letters @xmath96 .",
    "moreover , if @xmath141 , then @xmath142 is the longest palindromic suffix of @xmath0 .",
    "actually , in the statement of proposition [ prop : charcentral ] , the requirement that the words @xmath143 and @xmath142 are palindromes is not even necessary @xcite .",
    "we have the following remarkable result @xcite :    [ prop : sbscen ] a word over @xmath8 is a strictly bispecial sturmian word if and only if it is a central word .",
    "we now introduce christoffel words , that are words coding the digital approximations of segments in the euclidean plane .",
    "let @xmath59 and @xmath29 be integers such that @xmath144 .",
    "the lower christoffel word @xmath33 is the word defined for @xmath145 by @xmath146 = \\left\\ { \\begin{array}{lllll } a & \\mbox{if $ iq$ mod$(n)>(i-1)q$ mod$(n)$,}\\\\ b & \\mbox{if $ iq$ mod$(n)<(i-1)q$ mod$(n)$.}\\\\ \\end{array } \\right.\\ ] ]    let @xmath147 and @xmath148 .",
    "we have @xmath149 mod@xmath150 .",
    "hence , @xmath151 .",
    "notice that for every @xmath59 , there are exactly @xmath152 lower christoffel words @xmath33 , corresponding to the @xmath152 pairs @xmath27 such that @xmath29 and @xmath144 .    in the literature ,",
    "christoffel words are often defined with the additional requirement that @xmath129 ( cf .",
    "we call such christoffel words primitive , since a christoffel word is a primitive word if and only if @xmath129 .",
    "if one draws a word in the grid @xmath28 by encoding each @xmath2 with a horizontal unitary segment and each @xmath31 with a vertical unitary segment , the lower christoffel word @xmath33 is in fact the best grid approximation from below of the euclidean segment joining @xmath30 to @xmath27 , and has slope @xmath153 , that is , @xmath154 and @xmath155 ( see  [ fig : gc ] ) .",
    "( left ) and the upper christoffel word @xmath156 ( right).[fig : gc],height=188 ]     ( left ) and the upper christoffel word @xmath156 ( right).[fig : gc],height=188 ]    analogously , one can define the upper christoffel word @xmath34 by @xmath157 = \\left\\ { \\begin{array}{lllll } a & \\mbox{if $ ip$ mod$(n)<(i-1)p$ mod$(n)$,}\\\\ b & \\mbox{if $ ip$ mod$(n)>(i-1)p$ mod$(n)$.}\\\\ \\end{array } \\right.\\ ] ] of course , the upper christoffel word @xmath34 is the best grid approximation from above of the euclidean segment joining @xmath30 to @xmath27 ( see  [ fig : gc ] ) .",
    "let @xmath147 and @xmath148 .",
    "we have @xmath158 mod@xmath159 .",
    "hence , @xmath156 .",
    "the next result follows from elementary geometrical considerations .",
    "[ lem : rev ] for every pair of positive integers @xmath27 the upper christoffel word @xmath34 is the reversal of the lower christoffel word @xmath33 .    if ( and only if ) @xmath39 and @xmath32 are coprime , the christoffel word @xmath33 ( resp .",
    "@xmath34 ) intersects the euclidean segment joining @xmath30 to @xmath27 only at the end points , and is a primitive word .    the link between primitive christoffel words and central words ( i.e. , by proposition [ prop : sbscen ] , strictly bispecial sturmian words ) is contained in the following remarkable result of jean berstel and aldo de luca ( cf .",
    "@xcite ) .",
    "[ theor : sbscp ] @xmath160    if instead the integers @xmath39 and @xmath32 are not coprime , then there exist coprime integers @xmath161 such that @xmath162 , @xmath163 , for an integer @xmath164 . in this case",
    ", we have @xmath165 , i.e. , @xmath33 is a power of a primitive christoffel word .",
    "hence , by theorem [ theor : sbscp ] , there exists a central word @xmath36 such that @xmath166 and @xmath167 .",
    "so , we have :    [ lem : npchris ] the word @xmath56 , @xmath168 , is a christoffel word if and only if @xmath169 , for an integer @xmath136 and a central word @xmath36 .",
    "moreover , @xmath56 is a primitive christoffel word if and only if @xmath170 .",
    "another way to construct christoffel words is the following .",
    "let @xmath171 be positive integers and @xmath144 .",
    "write a block of @xmath39 @xmath2 s followed by a block of @xmath32 @xmath31 s . now shift the block of @xmath31 s by @xmath32 positions on the left , modulo @xmath46 , and fit the remaining positions with the @xmath39 @xmath2 s . repeating this procedure @xmath46 times",
    ", one obtains @xmath46 words of length @xmath46 , that can be arranged to form the rows of a square matrix @xmath172 ( see  [ fig : matrix ] for an example ) .",
    "the first column of the matrix @xmath172 is the lower christoffel word @xmath33 , while the last column is the upper christoffel word @xmath34 .",
    "actually , the columns of @xmath172 are precisely the @xmath46 rotations of @xmath33 and are lexicographically ordered from left to right . note that the @xmath46 columns are all distinct if and only if the christoffel word @xmath33 is primitive , i.e. , if and only if @xmath39 and @xmath32 are coprime .",
    "this construction is linked to the fact that christoffel words have a completely clustered burros - wheeler transform ( see @xcite for more details ) .",
    "@xmath173    we are now extending the result in theorem [ theor : sbscp ] to non - primitive christoffel words .    recall from @xcite that the right ( resp .  left ) palindromic closure of a word @xmath0 is the ( unique ) shortest palindrome @xmath174 ( resp .",
    "@xmath175 ) such that @xmath0 is a prefix of @xmath174 ( resp .  a suffix of @xmath175 ) .",
    "if @xmath176 and @xmath54 is the longest palindromic suffix of @xmath0 ( resp .",
    "@xmath36 is the longest palindromic prefix of @xmath0 ) , then @xmath177 ( resp .",
    "@xmath178 ) .",
    "[ lem : rpl ] let @xmath56 be a christoffel word , @xmath96 .",
    "then @xmath174 and @xmath175 are central words .",
    "let @xmath56 be a christoffel word , @xmath96 .",
    "by lemma [ lem : npchris ] , @xmath169 , for an integer @xmath136 and a central word @xmath36 .",
    "we prove the statement for the right palindromic closure , that for the left palindromic closure will then follow by symmetry .",
    "if @xmath170 , then @xmath179 , so @xmath0 is a palindrome and then @xmath180 is a central word .",
    "so suppose @xmath181 .",
    "we first consider the case when @xmath36 is the power of a single letter ( including the case @xmath182 ) .",
    "we have that either @xmath183 or @xmath184 for some @xmath185 . in the first case , @xmath186 , whereas in the second case @xmath187 . in both cases",
    "one has that @xmath174 is a strictly bispecial sturmian word , and thus , by proposition [ prop : sbscen ] , a central word .",
    "let now @xmath36 be not the power of a single letter .",
    "hence , by proposition [ prop : charcentral ] , there exist palindromes @xmath139 such that @xmath188 . now , observe that @xmath189 we claim that the longest palindromic suffix of @xmath0 is @xmath190 .",
    "indeed , the longest palindromic suffix of @xmath0 can not be @xmath0 itself since @xmath0 is not a palindrome , so since any palindromic suffix of @xmath0 longer than @xmath190 must start in @xmath36 , in order to prove the claim it is enough to show that the first non - prefix occurrence of @xmath36 in @xmath0 is that appearing as a prefix of @xmath190 .",
    "now , since the prefix @xmath191 of @xmath0 can be written as @xmath192 , one has by proposition [ prop : charcentral ] that @xmath54 is a central word .",
    "it is easy to prove ( see , for example , @xcite ) that the longest palindromic suffix of a central word does not have internal occurrences , i.e. , appears in the central word only as a prefix and as a suffix .",
    "therefore , since @xmath193 , @xmath36 is the longest palindromic suffix of @xmath54 ( by proposition [ prop : charcentral ] ) , and so appears in @xmath54 only as a prefix and as a suffix .",
    "this shows that @xmath190 is the longest palindromic suffix of @xmath0 .",
    "thus , we have @xmath194 , and we can write : @xmath195 so that @xmath196 for the palindrome @xmath197 . by proposition [ prop : charcentral ]",
    ", @xmath174 is a central word .    we are now ready to state our main result .",
    "[ theor : main ] @xmath198    let @xmath56 be a christoffel word , @xmath96 . then ,",
    "by lemma [ lem : npchris ] , @xmath0 is of the form @xmath169 , @xmath136 , for a central word @xmath36 . by lemma [ lem : rpl ] , @xmath0 is a prefix of the central word @xmath174 and a suffix of the central word @xmath175 , and therefore , by proposition [ prop : sbscen ] and lemma [ lem : prefsuf ] , @xmath0 is a bispecial sturmian word .",
    "conversely , let @xmath0 be a bispecial sturmian word , that is , suppose that the words @xmath120 , @xmath199 , @xmath200 and @xmath201 are all sturmian . if @xmath0 is strictly bispecial , then @xmath0 is a central word by proposition [ prop : sbscen ] , and @xmath56 is a ( primitive ) christoffel word by theorem [ theor : sbscp ] .",
    "so suppose @xmath202 .",
    "by lemma [ lem : npchris ] , it is enough to prove that @xmath0 is of the form @xmath169 , @xmath203 , for a central word @xmath36 and letters @xmath204 .",
    "since @xmath0 is not a strictly bispecial sturmian word , it is not a palindrome ( by proposition [ prop : sturmstrispe ] ) .",
    "let @xmath36 be the longest palindromic prefix of @xmath0 that is also a suffix of @xmath0 , so that @xmath205 , @xmath168 , @xmath206 . if @xmath207 , @xmath208 and we are done .",
    "otherwise , it must be @xmath209 for some @xmath210 , since otherwise either the word @xmath199 would contain @xmath211 and @xmath212 as factors ( a contradiction with the hypothesis that @xmath199 is a sturmian word ) or the word @xmath200 would contain @xmath213 and @xmath214 as factors ( a contradiction with the hypothesis that @xmath200 is a sturmian word ) .",
    "so @xmath215 .",
    "if @xmath216 , then it must be @xmath217 for some @xmath185 , since otherwise either @xmath218 would appear as a factor in @xmath0 , and therefore the word @xmath199 would contain @xmath218 and @xmath219 as factors , being not a sturmian word , or @xmath219 would appear as a factor in @xmath0 , and therefore the word @xmath200 would contain @xmath218 and @xmath219 as factors , being not a sturmian word .",
    "hence , if @xmath182 we are done , and so we now suppose @xmath220 .    by contradiction , suppose that @xmath0 is not of the form @xmath169 .",
    "that is , let @xmath221 , with @xmath222 , @xmath223 , @xmath224 , for different letters @xmath2 and @xmath31 .",
    "if @xmath225 , then either @xmath226 or @xmath227 . in the first case , @xmath228 and @xmath229 , for some @xmath230 , and then the word @xmath199 would contain @xmath211 and @xmath214 as factors , being not a sturmian word . in the second case , @xmath231 and @xmath232 , for some @xmath233",
    "; since @xmath234 is a suffix of @xmath0 , and therefore @xmath235 for some @xmath236 , we would have that the word @xmath200 contains both @xmath213 and @xmath214 as factors , being not a sturmian word .",
    "thus , we can suppose @xmath237 .",
    "now , if @xmath238 and @xmath239 , then the word @xmath199 would contain the factors @xmath240 and @xmath241 , being not a sturmian word ; if instead @xmath242 and @xmath243 , let @xmath244 , so that we can write @xmath245 .",
    "the word @xmath200 would therefore contain the factors @xmath246 and @xmath247 ( since @xmath234 is a suffix of @xmath0 ) , being not a sturmian word ( see  [ fig : theorem ] ) .",
    "in all the cases we obtain a contradiction and the proof is thus complete .",
    ".,height=158 ]    so , bispecial sturmian words are the maximal internal factors of christoffel words .",
    "every bispecial sturmian word is therefore of the form @xmath169 , @xmath136 , for different letters @xmath42 and a central word @xmath36 .",
    "the word @xmath0 is strictly bispecial if and only if @xmath170 . if @xmath248 , @xmath0 is a semicentral word @xcite , i.e. , a word in which the longest repeated prefix , the longest repeated suffix , the longest left special factor and the longest right special factor all coincide .",
    "in this section we give an enumerative formula for bispecial sturmian words .",
    "it is known that the number of sturmian words of length @xmath46 is given by @xmath249 where @xmath47 is the euler totient function , i.e. , @xmath48 is the number of positive integers smaller than or equal to @xmath46 and coprime with @xmath46 ( cf .",
    "@xcite ) .",
    "let @xmath0 be a sturmian word of length @xmath46 .",
    "if @xmath0 is left special , then @xmath13 and @xmath14 are sturmian words of length @xmath250 .",
    "if instead @xmath0 if not left special , then only one between @xmath13 and @xmath14 is a sturmian word of length @xmath250 .",
    "therefore , we have @xmath251 and hence @xmath252 using a symmetric argument , one has that also @xmath253 since @xcite @xmath254 , we obtain @xmath255 therefore , in order to find an enumerative formula for bispecial sturmian words , we only have to enumerate the non - strictly bispecial sturmian words",
    ". we do it in the next proposition .    for every @xmath59",
    ", one has @xmath256",
    "let @xmath257 and @xmath258 by theorem [ theor : main ] , the bispecial sturmian words of length @xmath46 are the words in @xmath259 .",
    "among the @xmath250 words in @xmath260 , there are @xmath261 strictly bispecial sturmian words , that are precisely the palindromes in @xmath260 .",
    "the @xmath262 words in @xmath260 that are not palindromes are non - strictly bispecial sturmian words .",
    "the other non - strictly bispecial sturmian words of length @xmath46 are the @xmath262 words in @xmath263 that are not palindromes . since the words in @xmath263 are the reversals of the words in @xmath260 , and since no non - strictly bispecial sturmian word is a palindrome by proposition [ prop : sturmstrispe ] , there are a total of @xmath264 non - strictly bispecial sturmian words of length @xmath46 .",
    "[ cor : formula ] for every @xmath136 , there are @xmath265 bispecial sturmian words of length @xmath46 .",
    "the christoffel words of length @xmath266 and their maximal internal factors , the bispecial sturmian words of length @xmath267 , are reported in table [ tab : example ] ( the strictly bispecial sturmian words are underlined ) .",
    ".the christoffel words of length @xmath266 .",
    "their maximal internal factors are the bispecial sturmian words of length @xmath267 .",
    "there are @xmath268 strictly bispecial sturmian words , that are the palindromes @xmath269 , @xmath270 , @xmath271 and @xmath272 ( underlined ) , and @xmath273 non - strictly bispecial sturmian words : @xmath274 , @xmath275 , @xmath276 , @xmath277 , @xmath278 , @xmath279 , @xmath280 , @xmath281 , @xmath282 , @xmath283 , @xmath284 , @xmath285 , @xmath286 and @xmath287.[tab : example ] [ cols=\"^,^,^\",options=\"header \" , ]",
    "recall that a language @xmath49 is called factorial if it contains all the factors of its words ( i.e. , for every words @xmath1 such that @xmath288 one has that @xmath36 and @xmath54 belong to @xmath49 ) , and extendible if every of its words has arbitrarily long extensions on the left and on the right ( i.e. , for every @xmath289 , there exist letters @xmath119 and @xmath124 such that @xmath290 ) .    given a factorial language @xmath49 over an alphabet @xmath8 , a word @xmath99 is a minimal forbidden word for @xmath49 if @xmath0 does not belong to @xmath49 but every proper factor of @xmath0 does .",
    "the set @xmath291 of minimal forbidden words for @xmath49 is therefore defined by the equation : @xmath292    note that given a word @xmath0 in a factorial and extendible language @xmath49 over an alphabet @xmath8 , if @xmath0 is a maximal internal factor of a minimal forbidden word for @xmath49 , then @xmath0 is a bispecial word in @xmath49 .",
    "in fact , let @xmath96 be such that @xmath56 is a minimal forbidden word for @xmath49 . by the definition of minimal forbidden word , @xmath120 and @xmath201 belong to @xmath49 .",
    "since @xmath49 is extendible , there is a letter @xmath293 in @xmath8 such that @xmath294 ; symmetrically , there is a letter @xmath295 such that @xmath296 .",
    "since @xmath49 is factorial , @xmath201 , @xmath297 , @xmath120 and @xmath298 belong to @xmath49 , and therefore @xmath0 is bispecial in @xmath49 .",
    "however , the converse is not true : if @xmath0 is a strictly bispecial word in @xmath49 , then it can not be the maximal internal factor of a minimal forbidden word for @xmath49 .    in the next theorem , we give a characterization of the set @xmath299 of minimal forbidden words for the language @xmath11 of finite sturmian words .",
    "[ theor : mf ] @xmath300    if @xmath56 is a non - primitive christoffel word , then by theorems [ theor : sbscp ] and [ theor : main ] , @xmath0 is a non - strictly bispecial sturmian word .",
    "this implies that @xmath55 is not a sturmian word , otherwise by lemma [ lem : delmi ] we have a contradiction . since @xmath199 and @xmath200 are sturmian words , we have @xmath301 .",
    "conversely , let @xmath301 .",
    "we claim that @xmath119 and @xmath124 are different letters . in fact , suppose that @xmath302 ( the case @xmath303 is symmetric ) . then , by the definition of minimal forbidden word , @xmath13 and @xmath15 are sturmian words , and since @xmath11 is extendible , @xmath22 and @xmath23 are sturmian . by lemma",
    "[ lem : delmi ] , @xmath0 is strictly bispecial , and thus @xmath21 is sturmian , a contradiction .",
    "so we can suppose that @xmath204 .",
    "therefore , we have that @xmath304 and @xmath305 are sturmian words .",
    "thus , @xmath0 is a bispecial sturmian word , and since @xmath306 , @xmath0 is a non - strictly bispecial sturmian word . by theorems [ theor : sbscp ] and [ theor : main ] ,",
    "@xmath56 is a non - primitive christoffel word .",
    "[ cor : formulamf ] for every @xmath59 , one has @xmath307",
    "it is known from @xcite that @xmath308 , as a consequence of and of the estimation ( see  @xcite , p. 268 ) @xmath309",
    "so , we have that the number of sturmian words of length smaller than or equal to @xmath46 is @xmath310 . from and",
    ", we have that the number of minimal forbidden words of length smaller than or equal to @xmath46 is @xmath311 .",
    "we studied the combinatorics of bispecial sturmian words , and their relations with christoffel words and digital approximations of segments in the plane .",
    "a natural question is that of extending this setting to higher dimensions , that is , to alphabets of cardinality greater than @xmath132 .",
    "there exist several generalizations of the definition of infinite sturmian word to larger alphabets , each of which captures only a part of the properties of these words .",
    "the most studied generalization is the notion of episturmian word .",
    "an infinite word over an alphabet of cardinality greater than 2 is episturmian if it has at most one left special factor for each length and the set of its factors is closed under reversal ( see @xcite for a survey on episturmian words ) .",
    "unfortunately , episturmian words are not necessarily balanced , and even balanced ones ( g.  paquin and l.  vuillon @xcite gave a combinatorial characterization of balanced episturmian words ) do not seem to correspond precisely to the approximations of the straight lines  see the introduction of @xcite for more references .",
    "another generalization of sturmian words in higher dimensions are billiard words .",
    "billiard words have the property that they are represented by a path that lies at bounded distance from a euclidean straight line .",
    "billiard words are moreover balanced , but in dimension higher than @xmath132 they do not have linear complexity of factors @xcite  which is a fundamental property of sturmian words .    a generalization of the notion of balancedness is @xmath312-balancedness .",
    "given an integer @xmath313 , a word is said to be @xmath312-balanced if for any pair of factors of the same length @xmath36 and @xmath54 , and for any letter @xmath2 , one has @xmath314 .",
    "so what we referred to in this paper as balanced words are precisely the @xmath315-balanced words .",
    "v. berth and s. labb raised the question whether it is possible to construct @xmath312-balanced words with linear factor complexity that have prescribed letter frequencies @xcite .",
    "the same authors also presented interesting results about the algorithmic generation of digital approximations of segments in the 3-dimensional space @xcite .",
    "we believe that an approach based on the combinatorics on words can lead to further insights on problems of digital approximation of lines in the 3-dimensional space .",
    "the author warmly thanks alessandro de luca , sbastien labb , filippo mignosi and antonio restivo for fruitful discussions .",
    "this work has been partially supported by prin 2010/2011 project `` automi",
    "e linguaggi formali : aspetti matematici e applicativi '' of the italian ministry of education ( miur ) .",
    "bal , f.  mignosi , and a.  restivo .",
    "minimal forbidden words and symbolic dynamics . in _",
    "13th annual symposium on theoretical aspects of computer science , stacs 96 _ , volume 1046 of _ lecture notes in comput .",
    "_ , pages 555566 .",
    "springer , 1996 .",
    "v.  berth and s.  labb .",
    "an arithmetic and combinatorial approach to three - dimensional discrete lines . in _ discrete geometry for computer imagery - 16th iapr international conference , dgci 2011 , nancy , france , april 6 - 8 , 2011 .",
    "proceedings _ , volume 6607 of _ lecture notes in comput .",
    "_ , pages 4758 .",
    "springer , 2011 .",
    "v.  berth and s.  labb .",
    "uniformly balanced words with linear complexity and prescribed letter frequencies . in _ proceedings of the 8th international conference words 2011",
    "_ , volume  63 of _ eptcs _ , pages 4452 , 2011 .",
    "a.  carpi and a.  de  luca .",
    "central sturmian words : recent developments . in _ developments in language theory , 9th international conference , dlt 2005 _ , volume 3572 of _ lecture notes in comput .",
    "_ , pages 3656 .",
    "springer , 2005 .",
    "m.  crochemore , f.  mignosi , and a.  restivo .",
    "minimal forbidden words and factor automata . in _ mathematical foundations of computer science , 23rd international symposium , mfcs 98 _ , volume 1450 of _ lecture notes in comput .",
    "_ , pages 665673 .",
    "springer , 1998 .",
    "m.  crochemore , f.  mignosi , a.  restivo , and s.  salemi .",
    "text compression using antidictionaries . in _",
    "automata , languages and programming , 26th international colloquium , icalp99 , prague , czech republic , july 11 - 15 , 1999 , proceedings _ ,",
    "volume 1644 of _ lecture notes in computer science _ , pages 261270 .",
    "springer , 1999 .",
    "g.  fici . a characterization of bispecial sturmian words . in _ proceedings of the 37th international symposium on mathematical foundations of computer science , mfcs  2012 _ , volume 7464 of _ lecture notes in computer science _ , pages 383394 .",
    "springer , 2012 .",
    "m.  sciortino and l.  q. zamboni .",
    "suffix automata and standard sturmian words . in _ developments in language theory , 11th international conference , dlt 2007 _ , volume 4588 of _ lecture notes in comput .",
    "_ , pages 382398 .",
    "springer , 2007 ."
  ],
  "abstract_text": [
    "<S> a balanced word is one in which any two factors of the same length contain the same number of each letter of the alphabet up to one . </S>",
    "<S> finite binary balanced words are called sturmian words . </S>",
    "<S> a sturmian word is bispecial if it can be extended to the left and to the right with both letters remaining a sturmian word . </S>",
    "<S> there is a deep relation between bispecial sturmian words and christoffel words , that are the digital approximations of euclidean segments in the plane . in 1997 , j. berstel and a. de luca proved that _ palindromic _ bispecial sturmian words are precisely the maximal internal factors of _ primitive _ christoffel words . </S>",
    "<S> we extend this result by showing that bispecial sturmian words are precisely the maximal internal factors of _ all _ christoffel words . </S>",
    "<S> our characterization allows us to give an enumerative formula for bispecial sturmian words . </S>",
    "<S> we also investigate the minimal forbidden words for the language of sturmian words .    </S>",
    "<S> sturmian words , christoffel words , special factors , minimal forbidden words , enumerative formula . </S>"
  ]
}