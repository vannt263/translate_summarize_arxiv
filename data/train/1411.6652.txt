{
  "article_text": [
    "in the modern era of large , complex data , statistical analysis is particularly challenging when the sample points are not vectors but rather objects with more intrinsic structure . in the present case ,",
    "each data point is a tree , embedded in @xmath0-dimensional space , with additional attributes such as thickness .",
    "background and additional information concerning these data objects , which represent arteries in human brains ( isolated via magnetic resonance imaging  @xcite ) , occupy section  [ sec : brain - artery - trees ]",
    ". earlier analyses of this data set have correlated certain features with age and produced hints of sex effects  ( section  [ sub : earlier - analyses ] ) .",
    "topological data analysis ( tda ) , implemented here using persistent homology , reveals anatomical insights unavailable from earlier approaches to this data set ( section  [ sec : ph ] ) .",
    "in particular , tda shows age to be correlated with certain measures of how brain arteries bend through space ( sections  [ sub : intuition ] and  [ sub : age - effects ] ) .",
    "this contrasts with a previous study @xcite that correlates age with total artery length , and furthermore the tda correlations are independent of that earlier one ( section  [ sub : total - artery - length ] ) .",
    "tda in our context also finds stronger sex effects than the only other study @xcite to find any sex difference at all ( section  [ sub : sex - effects ] ) .    to quantify the bending of arteries through space , we rely on persistent homology ( section  [ sec : tda ] ) , which we review from scratch .",
    "one of our methods records how the connectedness of the subset of the vessels beneath a given horizontal plane changes as the plane rises from below the brain to above it ( section  [ sub : height ] ) .",
    "another of our methods records the evolution of independent loops contained in the @xmath1-neighborhood of the tree as @xmath1 increases from @xmath2 to  @xmath3 ( section  [ sub : thickening - and - loops ] ) . in either method , for each tree the topological information is recorded in a persistence diagram , which is a finite set of points above the main diagonal in the positive quadrant of the cartesian plane .",
    "these diagrams are turned into feature vectors in a variety of ways , resulting in several statistical analyses , detailed in section  [ sec : detailed ] .",
    "this work fits into the framework of object oriented data analysis ( ooda , @xcite , and also @xcite for a current overview ) .",
    "in particular , the concept of _ data object _ here serves as a platform for interdisciplinary discussion of a type that lies at the core of complicated data analyses .",
    "the transition from @xmath0-dimensional tubular image to persistence diagram to feature vector , with only the latter being amenable to standard linear statistics , demonstrates the power of the notion of data object to incorporate data _ representation _ , in contrast to the concept of _ experimental unit _ in @xcite .",
    "each data point in this study is the tree of arteries in the brain of one person , collected by tube - tracking vessel segmentation from 3-dimensional magnetic resonance angiography ( mra ) images followed by a combination of automatic and manual assembly into trees .",
    "aylward and bullitt @xcite and aydin et al .",
    "@xcite describe and discuss this process .",
    "a visual ( 2-dimensional ) rendering of one such reconstructed tree is shown in figure  [ fig : dataobject ] .",
    "the full data set consists of @xmath4 such trees from people whose ages range from 18 to 72 years old .",
    "tree of arteries from the brain of one person , showing one data object .",
    "thickest arteries appear near the bottom .",
    "arteries bend , twist , and branch through three dimensions , which results in meaningful aspects of the data being captured by persistent homology representations . ]",
    "while the long - term goal of study is to develop methods for exploring stroke tendency , and perhaps to develop diagnostics for brain cancer based on vasculature , pathological cases were deliberately excluded from the handle dataset , with the idea of first understanding variation in the population of non - pathological cases .",
    "the only remaining interesting covariates are age and sex ; understanding correlations with these is the central  goal  of  this  study .      among the earlier analyses of this and closely related data sets , the first was by bullitt , et al . in @xcite , who studied simple summaries of each data tree , such as overall branch length and also average branch thickness , which were both seen to be significantly correlated with age .",
    "a clear avenue for refinement of that approach is to make better use of the large amount of additional information available in this rich data set , such as the tree topologies , and also the multiple individual branch locations , structures , widths , and so on .",
    "early approaches to this , such as @xcite or @xcite , chose to focus solely on the combinatorics of the branching structure , ignoring other aspects such as thickness or the geometry of the 3-dimensional embedding .",
    "the latter paper found statistically significant age effects .",
    "these age effects were studied more deeply using the notion of tree smoothing developed by wang et al . in @xcite .",
    "a much different approach to this data set was taken by shen et al . in @xcite ,",
    "based on representations of planar binary trees via dyck paths , an early appearance of which came in probability theory of branching processes @xcite .",
    "the bijection represents each planar binary tree as a function , allowing application of standard asymptotic methods when trees are viewed as random objects .",
    "adaption to the brain artery tree dataset had the goal of making available the large array of methods available for functional data analysis ( fda ) , where the data objects are curves such as graphs of univariate functions ; see @xcite .",
    "dyck path analysis of the brain tree data found more significant correlation with age as well as the first indication of a significant sex  effect .",
    "a drawback of the above approaches to tree data analysis is that they require 2-dimensional embedding of the given 3-dimensional tree structure , as noted in section  2.1 of @xcite and section  2.1 of shen et al .",
    "for each non - leaf node , a choice must be made as to which child node goes on the left and which goes on the right ( if the tree is not binary , then an ordering of the node s children is required ) .",
    "while ad hoc methods were used to reasonable effect in those papers , it is natural to suspect that they result in loss of statistical efficiency .",
    "this issue can be seen as an instance of the _ correspondence problem _ : planar embedding necessarily violates any consistent , anatomically meaningful assignment of @xmath0-dimensional features across objects in this dataset .",
    "an approach to overcoming this problem is based on the concept of phylogenetic tree from evolutionary biology ; see @xcite for a good introduction to this area , and @xcite for an insightful mathematical treatment . a major challenge in applying this idea to a set of brain artery trees is that phylogenetic trees require a fixed underlying set of leaves , while brain artery trees have leaves that appear where the vessel thickness passes below the imaging resolution of mra , locations of which vary across cases .",
    "one way to resolve this problem was implemented by skwerer et al .",
    "@xcite , who used additional cortical surface information plus a correspondence technique to produce a common set of landmarks , which became the leaves .",
    "that paper went on to find statistically significant age and gender effects , some of which were stronger than those previously found .    for additional treatments of tree - structured data objects that did not analyze this data set ,",
    "feragen et al .",
    "@xcite developed an approach that avoids both the planar embedding and fixed - leaf - set problems , and nye @xcite invented an analogue of principal component analysis for phylogenetic trees .",
    "hotz et al .",
    "@xcite , followed by barden et al .",
    "@xcite have investigated surprising non - standard central limit theory in phylogenetic tree spaces .",
    "the present investigation takes a completely different approach , using topological data analysis ( tda ) ; see @xcite for a good introduction to that set of ideas .",
    "we postpone to sections  [ sec : tda ] and  [ sec : detailed ] a review of precise definitions of key terms from tda and the detailed extraction of useful features for statistical analysis . in this section ,",
    "we confine ourselves to a loose , intuitive description of these features , and we describe the striking age and sex effects found using this new feature set . we also demonstrate that these effects are independent of coarser geometric measures , such as total artery length or average branch thickness , used in the earliest analyses .",
    "the methodology developed here provides a direct and quantitative description , in the form of numerical features usable for statistical analysis , of the way arterial structure occupies space within the @xmath0-dimensional geometry of the brain .",
    "although a full description is deferred to the next section , we illustrate some of what this means here , with the aid of the tree in figure  [ fig : case1gen12 ] .",
    "a matlab rendering of the brain artery tree of patient 1 . highlighted in pink is one of the loops formed by thickening the artery tree within the brain",
    ". also found are some of the loops and bends made by the artery tree within the 3-dimensional geometry of the brain . ]    first , looking near the bottom of figure  [ fig : case1gen12 ] , notice a large @xmath5-shaped bend in the arterial structure .",
    "bends such as these , and other much tighter bends , occur throughout the tree .",
    "the technique of zero - dimensional persistent homology locates these bends and measures their sizes .",
    "tda summarizes these sizes as a sequence @xmath6 of non - negative numbers , where @xmath7 is the size of the @xmath8-th largest bend in a particular brain .    for a different flavor of geometry , imagine gradually thickening each artery so that the tree begins to fill the @xmath0-dimensional space containing it .",
    "loops start to form ( for example , the one outlined in pink in the figure ) and then eventually fill in .",
    "the time between when a loop forms and when it fills in is called its persistence .",
    "the technique of one - dimensional persistent homology locates these loops and measures their persistences , resulting in another sequence @xmath9 of non - negative numbers .",
    "rigorous definitions of the above terms are given in the next two sections .",
    "for the rest of this section , we suppress such details and focus only on the analysis of features derived from persistence .",
    "pca of vector representations .",
    "raw data , mean and mean residuals are in the top row .",
    "other rows show loadings and scores for the first 3 pcs , i.e.  modes of variation .",
    "rainbow colors indicate age .",
    "correlation of pc1 and age is apparent , with warmer colors generally at the bottom and cooler colors generally at the  top . ]",
    "figure  [ fig : curvdat ] depicts a first population level view of the sets of numbers @xmath10 across the entire data set of @xmath4 brain trees .",
    "two out of three panels in each row contain a set of @xmath4 overlaid curves , each of which is a parallel coordinates plot ( see @xcite for an overview of this graphical device ) : the coordinates of each data vector are plotted as heights on the vertical axis as a function of the index , in this case @xmath11 .",
    "color denotes age via a rainbow scheme starting with magenta for the youngest  ( 19 ) , ranging smoothly through blue , green , yellow to red for the oldest  ( 79 ) .",
    "the upper left panel shows the data curves , which already exhibit potential age structure in this sample , with the younger people tending to appear near the top , and the older people near the bottom .",
    "as elegantly illustrated in @xcite , principal component analysis ( pca ) can reveal deeper structure in a sample of curves ; see @xcite for an introduction to that method in general .",
    "pca starts at the center of the data : the mean shown as a curve in the top center panel .",
    "variation about the mean is studied through the mean residuals , which are the data curves minus the mean , shown in the top right panel .",
    "pca next investigates _",
    "modes of variation _ by finding orthogonal projections in the curve space that represent maximal amounts of variation .",
    "projections corresponding to the first pc are shown in the left panel of the second row , which gives a more focused impression of younger people on the top , and older people near the bottom . in pca terminology , this is called a _ loadings plot _ , because each curve is merely a multiple of the first eigenvector , whose entries are called loadings .",
    "the shape of the curve gives insight concerning this component ( mode of variation ) . in this case",
    "the variation is all values moving in unison , being either large or small together .",
    "the center plot in the second row shows the remaining variation , after subtracting the first component from the centered residuals .",
    "careful study of the vertical axes shows there is much less variation present . the second row right panel shows the pc1 scores as horizontal coordinates of points ( with age ordering for the vertical coordinates ) with corresponding rainbow colors , which are the coefficients of the projections shown in the left panel .",
    "these show a clear correlation between age and pc1 .",
    "the second pc explains as much variation in the data as possible among directions orthogonal to pc1 .",
    "this shows the second major mode of variation in the data , which differs in how quickly the values taper off .",
    "similarly for pc3 ( orthogonal to both earlier directions ) in the bottom row . note that neither pc2 nor pc3 seems to have much visual connection with age , suggesting that most age effects have been captured by pc1 .",
    "scatterplot of pc1 vs.  pc2 .",
    "shows joint distribution of scores .",
    "main lesson is pc1 appears strongly correlated with age , but not pc2 does not . ]",
    "figure  [ fig : pc1pc2 ] depicts an alternate pca view of the data .",
    "this is a _ scores scatterplot _ : the scores are the coefficients of the projections . here",
    "each symbol represents a person ( same rainbow coding for age color scheme as in figure  [ fig : curvdat ] ) , with the pc1 score plotted on the vertical axis , and the pc2 score on the horizontal .",
    "this scatterplot is the most variable two - dimensional projection of the data and thus is generally useful for understanding relationships between data objects . in the current case ,",
    "again the rainbow color suggests an age gradient in the horizontal ( pc1 ) direction .",
    "figure  [ fig : pc1pc2 ] also allows study of sex using symbols , with females represented by circles and males by plus signs .",
    "no apparent visual gender differences can be seen here , but it is important to keep in mind this is only a two - dimensional view of a 100-dimensional data space .",
    "this issue is explored more deeply at the end of this section .    a more direct study of the correlation between pc1 and age appears in figure  [ fig : pcage0 ] , which plots the pc1 score as a function of age .",
    "the correlation is visually present , and the pearson correlation of @xmath12 reflects it .",
    "a simple gaussian - based hypothesis test against the null hypothesis of no correlation shows a strongly significant @xmath13-value @xmath14 .",
    "pc1 vs.  age for the zero - dimensional topological features verifies strong correlation of pc1 with age . ]    the same analysis can be repeated for the loop - persistence - based numbers @xmath15 . omitting the lengthy development above",
    ", the key result can be seen in figure [ fig : pcage1 ] , namely that the correlation between pc1 and age is even stronger for this feature set : @xmath16 with a @xmath13-value @xmath17 .",
    "pc1 vs.  age for the one - dimensional topological features exhibits even stronger correlation . ]      early exploration of these data by bullitt et al .",
    "@xcite demonstrated that younger patients tend to have longer total artery length @xmath18 , a statement that might lead ( as it led us ) to justifiable skepticism about the novelty of our findings .",
    "more precisely , we quantify the sizes of artery bends ( and loops ) at different scales , and these sizes could plausibly be controlled by the total artery length of the tree : speaking loosely , an attempt to jam a longer tree into the same skull would naturally lead to more bending behavior .    to ensure we were not merely applying a complicated tda machine to detect a simple geometric phenomenon",
    ", we performed a more sophisticated analysis . for each @xmath8 , linear regression between the variables @xmath7 and  @xmath18 yields a residual @xmath19 . replacing @xmath7 by  @xmath19 in the analysis from section  [ sub : age - effects ] results in an equally strong pearson correlation of @xmath20 , with a @xmath13-value on the order of  @xmath21 .",
    "geometrically motivated methods to control for effects of total artery length yield similarly negligible increases or decreases in pearson correlation and @xmath13-value .",
    "these methods simply divide the numbers  @xmath7 by ( i )  @xmath18 or ( ii )  @xmath22 or ( iii )  @xmath23 l$ ] before running the analysis in section  [ sub : age - effects ] .",
    "the exponents on  @xmath18 correspond to physical models where vessel length ( i )  scales according to total linear skull size , ( ii )  has constant flux ( i.e.  number of arteries passing ) through each unit of cross - sectional area , or ( iii )  remains constant per unit volume .    the strength and significance of correlation after controlling for total length breaks new ground in the analysis of the brain artery data .",
    "in particular , the persistent homology analysis here is sensitive to genuine multi - scale geometrical structure in the arterial systems , and does not simply reflect coarse size aspects of the data .    controlling for total length in the one - dimensional persistence analysis from section  [ sub : age - effects ] yields decidedly weaker ( but still non - negligible ) age correlation : replacing the  @xmath24 features with their residuals  @xmath25 , after running a linear regression between each @xmath24 and  @xmath18 , results in pearson correlation @xmath26 .      also of interest",
    "is an investigation of potential differences in brain artery structure between the sexes .",
    "figure  [ fig : pc1pc2 ] provides a preliminary view : male cases are indicated with a plus sign , and females are shown as circles . as noted in section  [ sub : age - effects ] ,",
    "meaningful sex difference is not apparent in this plot , perhaps because pc1 seems to be driven more by the independent age difference .",
    "however , in high - dimensional data analysis , simple visualization of the first few pc components is frequently revealed to be an inadequate method of understanding all important aspects of such data , because it is driven entirely by variation , which can be a different goal .",
    "a way to focus on desired effects in higher dimension is to calculate the arithmetic mean of the vectors @xmath27 corresponding to male subjects , to do the same for the female subjects , and then compute the euclidean distance between these means in @xmath28 .",
    "the size of this mean difference alone does not tell much as a raw number , but a simple permutation test on the mean - difference statistic reveals more : randomly reassign the @xmath29 vectors into two groups of equal size , compute the difference between the means of the two groups , and repeat this procedure @xmath30 times .",
    "this method has been called diproperm in @xcite , and is illustrated in figure  [ fig : dpp ] .",
    "illustration of diproperm results on the zero - dimensional persistence features .",
    "the left panel shows the result of projecting the data onto the direction vector determined by the means , suggesting some difference .",
    "the results of the permutation test are shown on the right , with the proportion of simulated differences that are bigger than that observed in the original data giving an empirical @xmath13-value . ]    in our test , @xmath31 of the reassignments led to a larger mean - difference than the original male  female split , giving an estimated @xmath13-value of @xmath32 , which is not impressive .",
    "however , we then repeated the entire procedure for the loop - vectors @xmath33 , and found a more compelling @xmath13-value of @xmath34 .    in section  [ sec :",
    "detailed ] , we demonstrate that a more thorough analysis of feature selection results in even lower @xmath13-values for sex difference .",
    "these results are stronger than those in @xcite , which is the only other study to find a statistically significant sex difference in this data set .",
    "we now give a more thorough discussion of topological data analysis , in particular the zero- and one - dimensional persistence diagrams , from which the features @xmath7 and @xmath24 in section  [ sec : ph ] are extracted .",
    "put briefly , a persistence diagram provides a compact two - dimensional record of the geometric and topological changes that occur as an object in space is built in stages .",
    "a rigorous description of persistence diagrams in their most general context requires background from algebraic topology .",
    "fortunately , the applications in this paper involve the simplest type of persistence diagram , which tracks the appearance and disappearance of connected components in a filtered graph , as well as a slightly more complicated diagram , which tracks the formation and destruction of loops in a thickening object .",
    "this section contains a fully rigorous description of the first type of diagram , a broadly intuitive description of the second , and the details of how our initial artery tree data objects produce both types .",
    "interpretation of these diagrams across a population requires the statistical analysis outlined in section  [ sec : detailed ] , but the current section demonstrates , via a few examples , the major features they are meant to isolate .    for more information on persistence diagrams in general ,",
    "see @xcite or @xcite .",
    "for a fully detailed , rigorous exposition of what we outline here , see @xcite .",
    "let @xmath35 be a graph @xcite , which loosely speaking is a set  @xmath36 of vertices with specified pairs from  @xmath36 joined by edges .",
    "fix a real - valued function @xmath37 . for simplicity of exposition ,",
    "assume @xmath38 only if @xmath39 .",
    "as a working example , let @xmath35 be the graph embedded in the plane as shown on the left side of figure  [ fig : tde ] , and let @xmath40 be the height of vertex @xmath41 as measured in the vertical direction . extend  @xmath42 to a function on the edge set by setting @xmath43 for each edge  @xmath44  of  @xmath35 .",
    "the persistence diagram @xmath45 takes @xmath35 and  @xmath42 as input and returns as output a multi - scale summary of the component evolution of the threshold sets of  @xmath42 .",
    "this output is robust with respect to small perturbations of  @xmath42 ( * ? ? ?",
    "* section  3 ) .",
    "we now explain in more detail what this means .    on the left , a graph @xmath46 .",
    "the function @xmath42 measures height in the vertical direction , and the persistence diagram @xmath45 is shown on the right .",
    "the coordinates of the dots are , reading from right to left , @xmath47 and @xmath48 . ]    for each real number  @xmath49 , define @xmath50 to be the full subgraph on the vertices with @xmath42-value at most  @xmath49 .",
    "for example , in figure  [ fig : tde ] , @xmath50 is empty if @xmath51 and @xmath52 whenever @xmath53 .",
    "the graph @xmath35 itself consists of only one connected component , but we are far more interested in what happens for values of  @xmath49 between @xmath54 and  @xmath55 .    to be precise , label the vertices @xmath56 by ascending order of @xmath42-value , choose real numbers @xmath57 such that @xmath58 , and set @xmath59 .",
    "define the _",
    "lower link _ @xmath60 of the vertex @xmath61 to be the set of vertices adjacent to  @xmath61 that have lower @xmath42-value than @xmath61 does .",
    "persistent homology records how the number @xmath62 of connected components of  @xmath63 changes as @xmath8 increases .",
    "observe that @xmath35 has a nested sequence of subgraphs , starting with the empty subgraph , @xmath64 new components appear and then join with older components as the threshold parameter increases . for the graph in figure  [ fig : tde ] , four snapshots in this evolution appear in figure  [ fig : threshold ] .",
    "four threshold sets for the function shown in figure  [ fig : tde ] , with increasing threshold value from left to right .",
    "the component born at the far left only dies as it enters the far right , while the much shorter - lived component born left of center dies entering the very next step.,title=\"fig:\"]four threshold sets for the function shown in figure  [ fig : tde ] , with increasing threshold value from left to right . the component born at the far left only dies as it enters the far right , while the much shorter - lived component born left of center dies entering the very next step.,title=\"fig:\"]four threshold sets for the function shown in figure  [ fig : tde ] , with increasing threshold value from left to right . the component born at",
    "the far left only dies as it enters the far right , while the much shorter - lived component born left of center dies entering the very next step.,title=\"fig:\"]four threshold sets for the function shown in figure  [ fig : tde ] , with increasing threshold value from left to right . the component born at the",
    "far left only dies as it enters the far right , while the much shorter - lived component born left of center dies entering the very next step.,title=\"fig : \" ]    if @xmath65 , then @xmath66 is a _ regular value _ ; this happens precisely when @xmath60 is a single vertex .",
    "otherwise , @xmath66 is a _",
    "critical value_. in figure  [ fig : tde ] , the critical values are the @xmath42-values of the letter - labeled vertices .    when @xmath66 is a critical value , precisely one of the following two things happens when passing from @xmath67 to @xmath63 .",
    "* @xmath68 : this happens when @xmath60 is empty . in this case , a new component @xmath69 is _ born _ at @xmath66 , and we associate  @xmath69 with @xmath61 for the rest of its existence .",
    "the first birth in our example happens at @xmath54 , where the threshold graph changes from the empty set to a single vertex .",
    "subsequent component births can be seen in the far left and center left of figure  [ fig : threshold ] . * @xmath70 for some integer @xmath71 : this happens when @xmath60 consists of @xmath72 vertices . in this case , @xmath73 components _ die _ at @xmath66 ; the only one that remains alive is the one associated to the vertex in @xmath60 with lowest @xmath42-value . for example , referring again to figure  [ fig : threshold ] , the components born at the far left and center left die when entering the far right and center right , respectively .      the evolution of connected components is compactly summarized in the _ persistence diagram _ @xmath45 .",
    "this is a multiset of dots in the plane  @xmath74 , meaning that each dot occurs with positive integer ( or infinite ) multiplicity .",
    "a dot of multiplicity @xmath73 at the planar point @xmath75 indicates that @xmath73 components are born at @xmath42-value  @xmath76 and die at @xmath42-value  @xmath77 . a component that is born at @xmath76 but never dies corresponds to a dot @xmath78 in the diagram , so @xmath74 is extended to allow such points .",
    "all of the dots in  @xmath79 lie above the major diagonal @xmath80 , since birth must always precede death . for technical reasons that will become clear below",
    ", we also add a dot of infinite multiplicity at each point @xmath81 on the major diagonal itself .",
    "the diagram for our example is on the right side of figure [ fig : tde ] .",
    "the _ persistence _ of a dot @xmath82 is defined to be @xmath83 , the vertical distance to the major diagonal .",
    "each such dot corresponds to a component @xmath84 that    * is not present in any of the graphs before threshold value  @xmath76 , * exists as its own independent component for every threshold value between @xmath76 and  @xmath77 , and * joins with another component , born at or before @xmath76 , exactly at the threshold value @xmath77 .",
    "hence the persistence @xmath85 indicates the lifetime of this feature as an independent component .",
    "the actual geometric meaning of this lifetime can vary .",
    "for example , in figures  [ fig : tde ] and  [ fig : threshold ] , the small - persistence dot @xmath86 points to the existence of a small `` wobble '' in the graph , as seen by the height function @xmath42 . on the other hand ,",
    "the large - persistence dot @xmath87 reflects an arm of the tree that is very long , again as measured in the vertical direction .",
    "a general heuristic for interpreting these diagrams is to say that the smaller the persistence of a dot is , the more likely its corresponding feature is to be caused by measurement error or other noise . a small change in the values of @xmath42 , for example , could remove the small wobble that @xmath88 indicates .",
    "this interpretation can be given more rigor by the stability theorem described below .",
    "that said , there is no guarantee of persistence being correlated with importance , just with reliability . indeed , one of the findings in section [ sec : detailed ] is that dots of not - particularly - high persistence have the most distinguishing power in our specific application .",
    "we have outlined a tool that takes as input a real - valued function @xmath42 on a graph and returns a diagram @xmath45 as output .",
    "this tool would be useless if it were not robust to small changes in the input function .",
    "for example , consider the left side of figure  [ fig : noisy ] , which shows two functions @xmath89 ( black ) and @xmath90 ( red ) defined on the same interval ; in this case , imagine that @xmath35 is a simple path and the curves drawn indicate function values as height .",
    "since @xmath90 is just a noisy version of @xmath89 , data analysis would fail to be robust if @xmath91 differed too greatly from @xmath92 .",
    "examining the right side of the same figure , the major features of the two diagrams are very close , the only difference being three extra red dots that lie very close to the diagonal , corresponding to the low - persistence wobbles in the red function .",
    "there are several metrics on the set of all persistence diagrams , but all of them see these diagrams as being close to each other .    on the left , functions @xmath89 and @xmath90 , shown in black and red , respectively .",
    "on the right , their persistence diagrams , with the same color scheme .",
    "the optimal bijection between @xmath91 and @xmath92 matches the three high - persistence dots together , and matches the extra red low - persistence dots to the black diagonal . ]    for example , let @xmath93 and @xmath94 be two diagrams and choose a number @xmath95 .",
    "for each bijection @xmath96 , define its cost to be @xmath97 such bijections always exist , due to the infinite multiplicity of every diagonal dot in each diagram .",
    "the _ @xmath13-th wasserstein distance _ @xmath98 between the two diagrams is the infimum cost @xmath99 as @xmath100 ranges over all possible bijections .",
    "many technical results ( for example ,",
    "@xcite ) all basically say that , under mild conditions , @xmath101 .",
    "having focused the previous discussion on connected components , we now turn to the other type of persistence diagram used in our analysis .",
    "let @xmath102 be a compact subset of some euclidean space @xmath103 .",
    "for each non - negative  @xmath104 , define @xmath105 to be the set of points in @xmath103 whose distance from @xmath102 is at most  @xmath104 . as @xmath104 increases , loops appear and then subsequently fill in .",
    "just as above , plot the birth and death times of each loop as dots in the plane , and call the multiset of all such dots the _ one - dimensional persistence diagram _ @xmath106 .    [ cols=\"^ \" , ]",
    "the methods in prior sections generate persistence diagrams to summarize brain artery trees . from there , statistical analysis can proceed either with further summarization or without . as the analysis in section  [ sec : ph ] shows , vector - based summaries can capture substantial structure while maintaining the possibility to apply the full range of standard statistical analyses .",
    "this section describes our approach in more detail and then examines the effect of changes in feature selection .",
    "our admittedly ad hoc method to turn diagrams into feature vectors is justified somewhat by the nature of the geometry it is intended to capture , but also by the excellent age and sex effects it reveals .",
    "other approaches to the same problem include binning the plane and then turning each diagram into an integral vector consisting of bin counts , as in @xcite , or basing features on more sophisticated algebraic geometry , as advocated in @xcite .",
    "we settled on vector - based analyses as a middle ground .",
    "in general , simple numerical summaries , such as total persistence or total number of dots , miss too much useful information to be potent . at the opposite extreme , it is possible to work directly populations of persistence diagrams , basing the analysis on metrics such as the wasserstein metric @xmath107 in section  [ sub : stability ] .",
    "for example , gamble and heo @xcite found interesting structure using multidimensional scaling with a @xmath107-dissimilarity matrix computed from a set of persistence diagrams , each one associated with a set of landmarks on a single tooth .",
    "one could go further , using methods such as the frchet mean approach of mileyko et al .",
    "@xcite to find the center of the data followed by multidimensional scaling to analyze variation about the mean .",
    "we opted not to go that route because computation of the @xmath107-metric is generally very expensive .",
    "another possibility , which we have not yet investigated , would be to use bubenik s theory of persistence landscapes @xcite to translate the problem into one of functional data analysis .",
    "[ [ initial - approach . ] ] initial approach .",
    "+ + + + + + + + + + + + + + + + +    for each of the @xmath4 zero - dimensional persistence diagrams , we computed the persistence of each dot ; recall a dot has coordinates @xmath108 , where @xmath77 is birth and @xmath109 is death , and that its persistence is @xmath110 .",
    "we then sorted these persistences in descending order , and picked the first @xmath111 to produce a vector @xmath112 for each brain .",
    "in other words , the @xmath8-th coordinate of this vector represents the size of the @xmath8-th largest `` bend '' in the brain , as measured in the vertical direction . the same procedure on the one - dimensional diagrams led to the vectors @xmath113 , so that the number @xmath114 represents the size of the @xmath115-th most persistent loop in the brain .",
    "both sets of vectors were used in the age and sex analyses in section  [ sec : ph ] .    [ [ feature - scale . ] ] feature scale .",
    "+ + + + + + + + + + + + + +    are the observed age correlations being driven more by the high - persistence features or by the lower - scale ones ?",
    "in addition , does restricting to the @xmath111 most persistent dots miss useful information ? to pursue these questions",
    ", we created the following sets of vectors , for each pair of positive integers @xmath116    * @xmath117 , * @xmath118 .    using this notation ,",
    "the original vectors used in our analysis were @xmath119 and @xmath120 .",
    "extensive analysis of this feature set led to the heat map shown in figure  [ fig : hm0 ] .",
    "the horizontal and vertical axes indicate @xmath121 and @xmath122 , respectively , while the color at coordinates @xmath123 shows the age correlation value @xmath124 obtained by running our analysis on the vectors @xmath125 .",
    "color in the lower diagonal part of the plot codes correlation , ranging from very dark red ( lowest ) through hotter colors to white ( highest correlation ) .",
    "the bottom of the color range is @xmath126 and the top is @xmath127 , chosen to maximize use of the color scale .",
    "age correlation heat map for features extracted from zero - dimensional persistent homology analysis .",
    "color indicates the value of the function @xmath124 , which is the age correlation derived from the vectors @xmath125 , with @xmath121 on the horizontal axis and @xmath122 on the vertical .",
    "the upper - right black triangle is meaningless , as @xmath128 does not lead to a vector in our scheme . ]",
    "figure  [ fig : hm0 ] contains a lot of useful information .",
    "first , the small red area in the upper left indicates that the highest - persistence features alone had far less distinguishing power with respect to age ; indeed , the two highest persistences @xmath129 and @xmath130 lead only to an age correlation of @xmath131 . on the other hand",
    ", the rest of the lower triangle shows a fairly uniform , and high , age correlation , leading to the surprising conclusion that one need only include some of the more medium - scale persistence features to obtain good age effects .",
    "in fact , the length of the @xmath132-th longest bar alone is a numerical feature that yields near - optimal correlation .",
    "the same analysis performed on the one - dimensional features produced a very similar pattern , not shown here .",
    "the medium scale at which age correlation is optimized suggests a reason why , in the initial stages of our connected component analysis ( section  [ sub : height ] ) , we found negligible differences in the strength of correlation or significance upon filtering in various directions other than upward .",
    "probably it is due to the stochastic nature of blood vessel formation in the brain at the relevant scale : while large features common to all human brains might have natural ventral - dorsal orientation  such might be the case for major arteries that branch from the circle of willis and arch up to the top of the brain and back down ",
    "the medium - sized features driving the observed correlations are apparently random enough to be devoid of natural orientation , statistically speaking .",
    "recall from section  [ sec : ph ] that a permutation test on the vectors @xmath120 found a significant ( @xmath133 ) separation between male and female subjects .",
    "one can also calculate the sex - difference significance @xmath134 obtained by running an identical analysis on the vectors @xmath135 .",
    "the resulting pattern turns out to be similar to the findings for age correlation , but even more stark .",
    "analyses that use only the most persistent loops do not give clear sex separation ; for example , @xmath136 is only @xmath137 . on the other hand , every single value of @xmath134 with @xmath138 lands below the significance level of @xmath139 , with the minimum value being @xmath140 .",
    "the heat map in figure [ fig : hm1 ] displays all of these values at once ( darker is lower , and hence more significant ) , and the near - uniformity of the sex - difference significance is evident .",
    "sex difference significance heat map for features extracted from one - dimensional persistent homology analysis .",
    "color indicates the value of the function @xmath134 , which is the significance , derived via permuation test , of the difference between the male and the female vectors @xmath135 , with @xmath121 on the horizontal axis and @xmath122 on the vertical .",
    "the upper - right black triangle is meaningless , as @xmath128 does not lead to a vector in our scheme . to provide good contrast between the values , a color scheme running from @xmath32 ( white ) to @xmath2 ( black )",
    "was chosen .",
    "a few values are actually above @xmath32 and are simply shown as white in this scheme . ]",
    "this paper takes analysis of the brain artery tree data in the entirely new direction of persistent homology . this topological analysis approach to data object representation gives stronger results than those from alternative representations used in earlier studies .",
    "this is the first study to find significant results even after controlling for total artery length .",
    "the lessons here are intended to suggest the power of these tools , rather than to be anatomically conclusive , so multiple comparison issues have not been carefully accounted for .",
    "this serves to make the main ideas more accessible than they would be with a careful family - wise error rate , or false discovery rate analysis .",
    "interesting future work is to apply these powerful new methods to other data sets of tree - structured ( or otherwise @xmath141-dimensional ) objects .",
    "an important example of this is the airway data set of feragan et al .",
    "@xcite .",
    "finally , we note that the original data objects under consideration in this paper were not the actual sets of arteries in @xmath29 human brains ; rather , they were the outputs of @xmath29 runs of the tube - tracking algorithm from @xcite .",
    "like all algorithms that process raw data , that algorithm introduces artifacts , leading to the worry that analysis of its output data objects may be picking up more on error than on signal . in our case",
    ", this worry applies to the zero - dimensional analysis , which looks at component evolution in a given tree . in contrast , the loop analysis thickens a point sample from each tree into three - dimensional space , so the stability theorem for persistent homology ensures that replacing the given tree with a slightly modified version  even one whose connectivity properties differ from the output of the tube - tracking algorithm  does not cause great changes in the persistence diagram .",
    "an interesting new paper @xcite uses persistent homology methods to aid in artifact - reduction in the actual `` upstream '' production of the artery trees",
    ". it would be valuable to run our analytical methods on these new data objects to see if significant changes result .",
    "support was provided by nsf grant dms-1001437 for miller and by the research training grant nsf - dms 1045133 for pieloch .",
    "ideas for thi paper arose from discussions at the mathematical biosciences institute ( mbi , dms-0931642 ) and the statistical and applied mathematical sciences institute ( samsi , dms-1127914 ) .",
    "pieloch thanks the information initiative at duke ( iid ) for hosting him during summer 2014 .",
    "the magnetic resonance brain images from healthy volunteers used in this paper were collected and made available by the casilab at the university of north carolina at chapel hill and were distributed by the midas data server at kitware , inc .          stephen  r aylward and elizabeth bullitt .",
    "initialization , noise , singularities , and scale in height ridge traversal for tubular object centerline extraction . _ medical imaging , ieee transactions on _ , 21(2):6175 , 2002 .",
    "paul bendich , sang chin , jesse clarke , john desena , john harer , elizabeth munch , andrew newman , david porter , david rouse , nate strawn , and adam watkins .",
    "topological and statistical behavior classifiers for tracking applications",
    ". 2014 .",
    "frdric chazal , david cohen - steiner , marc glisse , leonidas  j. guibas , and steve  y. oudot .",
    "proximity of persistence modules and their diagrams . in _ proceedings of the 25th annual symposium on computational geometry _ , scg 09 , pages 237246 , new york , ny , usa , 2009 .",
    "acm .",
    "aasa feragen , pechin lo , marleen de  bruijne , mads nielsen , and franois lauze . toward a theory of statistical tree - shape analysis .",
    "_ pattern analysis and machine intelligence , ieee transactions on _ , 35(8):20082021 , 2013 .",
    "xiaosun lu , js  marron , and perry haaland . object oriented data analysis of cell images . _",
    "journal of the american statistical association _",
    ", 109(506):548559 , 2014 . j.  s. marron and andrs  m alonso .",
    "overview of object oriented data analysis .",
    "_ biometrical journal _ , 2014 .",
    "helena molina - abril and alejandro f. frangi .",
    "topo - geometric filtration scheme for geometric active contours and level sets : application to cerebrovascular segmentation . in polina golland ,",
    "nobuhiko hata , christian barillot , joachim hornegger , and robert howe , editors , _ medical image computing and computer - assisted intervention ?",
    "miccai 2014 _ , volume 8673 of _ lecture notes in computer science _ , pages 755762 .",
    "springer international publishing , 2014 .",
    "g.  petri , p.  expert , f.  turkheimer , r.  carhart - harris , d.  nutt , p.  j.  hellyer , f.  vaccarino .",
    "homological scaffolds of brain functional networks .",
    "_ journal of the royal society interface _ , 11(101 ) , 2014 .",
    "dan shen , haipeng shen , shankar bhamidi , yolanda  muoz maldonado , yongdai kim , and js  marron .",
    "functional data analysis of tree data objects .",
    "_ journal of computational and graphical statistics _ , ( just - accepted ) , 2013 .",
    "sean skwerer , elizabeth bullitt , stephan huckemann , ezra miller , ipek oguz , megan owen , vic patrangenaru , scott provan , and js  marron .",
    "tree - oriented analysis of brain artery structure .",
    "_ journal of mathematical imaging and vision _ ,",
    "pages 118 , 2013 .",
    "yuan wang , js  marron , burcu aydin , alim ladha , elizabeth bullitt , and haonan wang . a nonparametric regression model with tree - structured response . _ journal of the american statistical association _ , 107(500):12721285 , 2012 ."
  ],
  "abstract_text": [
    "<S> new representations of tree - structured data objects , using ideas from topological data analysis , enable improved statistical analyses of a population of brain artery trees . a number of representations of each data tree arise from persistence diagrams that quantify branching and looping of vessels at multiple scales . </S>",
    "<S> novel approaches to the statistical analysis , through various summaries of the persistence diagrams , lead to heightened correlations with covariates such as age and sex , relative to earlier analyses of this data set . </S>",
    "<S> the correlation with age continues to be significant even after controlling for correlations from earlier significant summaries . </S>"
  ]
}