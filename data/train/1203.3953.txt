{
  "article_text": [
    "the physical and chemical properties of materials are largely determined by the electronic structure of the atoms and molecules found in them . in all but the simplest cases , the electronic structure can only be determined approximately , and since the late 1920 s a huge amount of work has been devoted to finding suitable approximations and numerical methods for solving this fundamental problem .",
    "traditional methods for electronic structure computations are based on the solution of generalized eigenvalue problems ( diagonalization ) for a sequence of large hermitian matrices , known as one - particle hamiltonians .",
    "the computational cost of this approach scales cubically in the size @xmath0 of the problem , which is in turn determined by the number of electrons in the system . for large systems ,",
    "the costs become prohibitive ; this is often referred to as the @xmath1 bottleneckin the literature .    in the last two decades ,",
    "a number of researchers have been developing approaches that are capable in many cases to achieve optimalcomputational complexity : the computational effort scales linearly in the number of electrons , leading to better performance for sufficiently large systems and making the electronic structure problem tractable for large - scale systems .",
    "these methods , often referred to as @xmath2 methods ,   apply mostly to insulators .",
    "they avoid diagonalization by computing instead the _ density matrix _",
    ", a matrix which encodes all the important physical properties of the system . for insulators at zero temperature",
    ", this is the spectral projector onto the invariant subspace associated with the eigenvalues of the hamiltonian falling below a certain value . for systems at positive temperatures ,",
    "the density matrix can be expressed as a smooth function of the hamiltonian .",
    "the possibility of developing such methods rests on a deep property of electronic matter , called nearsightedness  by w.  kohn @xcite .",
    "kohn s nearsightedness principle   expresses the fact that for a large class of systems the effects of disturbances , or perturbations , remain localized and thus do not propagate beyond a certain ( finite ) range ; in other words , far away parts of the system do not see  each other .",
    "mathematically , this property translates into the rapid off - diagonal decay in the density matrix .",
    "the fast fall - off in the density matrix entries has been often assumed without proof , or proved only in special cases .",
    "moreover , the precise dependence of the rate of decay on properties of the system ( such as the band gap in insulators or the temperature in metallic systems ) has been the subject of much discussion .",
    "the main goal of this paper is to provide a rigorous mathematical foundation for linear scaling methods in electronic structure computations .",
    "we do this by deriving estimates , in the form of decay bounds , for the entries of general density matrices for insulators , and for metallic systems at positive electronic temperatures .",
    "we also address the question of the dependence of the rate of decay on the band gap and on the temperature .",
    "although immediately susceptible of physical interpretation , our treatment is purely mathematical . by stripping the problem down to its essential features and working at the discrete level ,",
    "we are able to develop an abstract theory covering nearly all types of systems and discretizations encountered in actual electronic structure problems .",
    "our results are based on a general theory of decay for the entries in analytic functions of sparse matrices , initially proposed in @xcite and further developed here .",
    "the theory is based on classical approximation theory and matrix analysis .",
    "a bit of functional analysis will be used when considering a simple model of metallic behavior ,  for which the decay in the density matrix is very slow .",
    "the approach described in this paper has a number of potential applications beyond electronic structure computations , and can be applied to any problem involving functions of large matrices where locality of interaction  plays a role . towards the end of the paper",
    "we briefly review the possible use of decay bounds in the study of correlations in quantum statistical mechanics and information theory , in the analysis of complex networks , and in some problems in classical numerical linear algebra , like the computation of invariant subspaces of symmetric tridiagonal matrices .",
    "the discussion of these topics will be necessarily brief , but we hope it will stimulate further work in these areas .    in this paper",
    "we are mostly concerned with the theory behind @xmath2 methods rather than with specific algorithms .",
    "readers who are interested in the computational aspects should consult any of the many recent surveys on algorithms for electronic structure computations ; among these , @xcite are especially recommended .",
    "the remainder of the paper is organized as follows .",
    "section [ materials ] provides some background on electronic structure theory .",
    "the formulation of the electronic structure problem in terms of spectral projectors is reviewed in section [ sec : dm ] .",
    "a survey of previous , related work on decay estimates for density matrices is given in section [ related ] . in section [ norm ]",
    "we formulate our basic assumptions on the matrices ( discrete hamiltonians ) considered in this paper , particularly their normalization and asymptotic behavior for increasing system size ( @xmath3 ) .",
    "the approximation ( truncation ) of matrices with decay properties is discussed in section [ trunc ] .",
    "a few general properties of orthogonal projectors are established in section [ proj ] .",
    "the core of the paper is represented by section [ sec_main ] , where various types of decay bounds for spectral projectors are stated and proved . in section [ overlap ]",
    "we discuss the transformation to an orthonormal basis set .",
    "the case of vanishing gap is discussed in section [ metals ] .",
    "other applications of our results and methods are mentioned in section [ other ] . finally , concluding remarks and some open problems are given in section [ concl ] .",
    "in this section we briefly discuss the basic principles underlying electronic structure theory . for additional details the reader",
    "is referred to , e.g. , @xcite .    consider a physical system formed by a number of nuclei and @xmath4 electrons in three - dimensional ( 3d ) space .",
    "the time - independent schrdinger equation for the system is the eigenvalue problem @xmath5 where @xmath6 is the many - body hamiltonian operator , @xmath7 is the total energy and the functions @xmath8 are the eigenstates of the system .",
    "oppenheimer approximation allows us to separate the nuclear and electronic coordinates . as a consequence ,",
    "we only seek to solve the quantum mechanical problem for the electrons , considering the nuclei as sources of external potential .",
    "then the electronic part of equation can be written as @xmath9 where @xmath10 is the electronic energy and the eigenstates @xmath11 are functions of @xmath12 spatial coordinates and @xmath4 ( discrete ) spin coordinates .",
    "we denote spatial coordinates as @xmath13 and the spin coordinate as @xmath14 ; each electron is then defined by @xmath15 coordinates @xmath16 , and wavefunctions are denoted as @xmath17 .",
    "then the electronic hamiltonian operator in can be written as @xmath18 where @xmath19 is the kinetic energy , @xmath20 is the external potential ( i.e. , the potential due to the nuclei ) and @xmath21 is the potential due to the electron - electron repulsion . , with @xmath22 electronic charge , @xmath23 reduced planck s constant and @xmath24 electronic mass .",
    "] moreover , the ground - state energy is given by @xmath25 where the minimum is taken over all the normalized antisymmetric wavefunctions ( electrons being fermions , their wavefunction is antisymmetric ) . the electronic density is defined as @xmath26 in this expression , the sum over @xmath14 is the sum over the spin values of the first electron , while integration with respect to @xmath27 , with @xmath28 , denotes the integral over @xmath29 and sum over both possible spin values for the @xmath30th electron .",
    "observe that is a many - particle equation that can not be separated into several one - particle equation because of the term @xmath31 .",
    "of course , being able to turn into a separable equation would simplify the problem considerably , since the number of unknowns per equation would drop from @xmath32 to @xmath15 .",
    "this is the motivation for one - electron methods .    for non - interacting particles ,",
    "the many - body eigenstates @xmath17 can be written as slater determinants of occupied orbitals @xmath33 , @xmath34 where each orbital satisfies a single - particle eigenstate equation @xmath35 .",
    "in general , the name one - particle method   is used also when self - consistent terms ( e.g. , involving the density ) are present in @xmath36 ; in this case , the equations are solved iteratively , computing at each step the solution to a single - particle problem and then filling the lowest eigenstates with one electron each , to form a slater determinant .",
    "however , some of the properties of a true non - interacting system ( such as the fact that the energy is the sum of the eigenvalues of occupied states ) are lost .",
    "a fundamental example of one - particle method is density functional theory ( dft ) .",
    "the main idea behind dft consists in rewriting the ground - state energy as a density functional rather than a wavefunction functional .",
    "indeed , the first hohenberg  kohn theorem @xcite states that the potential is uniquely ( up to a constant ) determined by the ground - state density @xmath37 . in other words , the system can be seen as characterized by the density rather than by the potential .",
    "moreover , the ground - state density of a system with given external potential can be computed by minimizing a suitable energy functional of @xmath38 ( second hohenberg ",
    "kohn theorem ) .",
    "while of crucial theoretical importance , though , these results do not give a recipe for computing electronic structures .",
    "the next important step comes with the kohn  sham construction @xcite : roughly speaking , one replaces the original , non - separable system with a fictitious system of non - interacting electrons that have exactly the same density as the original system .",
    "the single - particle equations for the kohn  sham system are ( neglecting spin ) : @xmath39 where the @xmath40 s are the kohn ",
    "sham orbitals and @xmath41 is the single - electron potential .",
    "the associated density is @xmath42 the single - particle potential @xmath41 can be written as @xmath43({\\bf r}),\\ ] ] where the term @xmath44({\\bf r})$ ] is called _ exchange - correlation potential _ and depends on the density .",
    "it is important to point out that the kohn  sham construction is not an approximation , in that the kohn ",
    "sham equations are exact and yield the exact density .",
    "on the other hand , the exchange - correlation energy is not known in practice and needs to be approximated . in the local density approximation ( lda )",
    "framework , for instance , the exchange energy is based on the energy of a uniform electron gas .",
    "introducing spin allows for a more refined approximation ( lsda , or local spin - density approximation ) .",
    "one may also include gradient corrections , thus obtaining the so - called generalized gradient approximation ( gga ) .    the solution of kohn ",
    "sham equations is usually computed via self - consistent iterations .",
    "the iterative process begins with an approximation for the density ; the associated approximate exchange - correlation potential is injected in the kohn  sham equations .",
    "the output density is then used to form a new approximation of the potential .",
    "the process continues until the update term for the density or the potential becomes negligible .",
    "observe that the basic building block of this computational technique is the solution of an eigenvalue problem for non - interacting particles .",
    "electrons at the lowest atomic - like levels ( ` core ' electrons ) do not change much their state within chemical processes .",
    "for this reason , many computational techniques do not consider them explicitly , and replace instead the coulomb attraction of the nucleus with a potential ( called pseudopotential ) that includes the effect of the core electrons on the valence electrons .",
    "this approach is always employed when using plane waves as a basis for wavefunctions , since the number of plane waves required to represent core electrons is prohibitive .",
    "as mentioned earlier , conventional methods for electronic structure calculations require the repeated solution of linear eigenvalue problems for a one - electron hamiltonian operator of the form @xmath45 . in practice",
    ", operators are discretized by grid methods or via galerkin projection onto the finite - dimensional subspace spanned by a set of basis functions @xmath46 . when linear combinations of atom - centered slater or gaussian - type functions ( see below ) are employed , the total number of basis functions is @xmath47 , where @xmath4 is the number of ( valence ) electrons in the system and @xmath48 is a small or moderate integer related to the number of basis functions per atom .",
    "traditional electronic structure algorithms diagonalize the discrete hamiltonian resulting in algorithms with @xmath49 ( equivalently , @xmath1 ) operation count @xcite . in these approaches , a sequence of generalized eigenproblems of the form @xmath50 is solved , where @xmath51 and @xmath52 are , respectively , the discrete hamiltonian and the overlap matrix relative to the basis set @xmath46 .",
    "the eigenvectors @xmath40 in are known as the _ occupied states _ , and correspond to the @xmath4 lowest generalized eigenvalues @xmath53 , the _ occupied levels_. the overlap matrix @xmath52 is just the gram matrix associated with the basis set : @xmath54 for all @xmath55 , where @xmath56 denotes the standard @xmath57-inner product . in dirac s _ bra - ket _ notation , which is the preferred one in the physics and chemistry literature , one writes @xmath58 . for an orthonormal basis set",
    ", @xmath59 ( the @xmath60 identity matrix ) and the eigenvalue problem is a standard one .    instead of explicitly diagonalizing the discretized hamiltonian @xmath51",
    ", one may reformulate the problem in terms of the density operator @xmath61 , which is the @xmath52-orthogonal projector .",
    "] onto the @xmath51-invariant subspace corresponding to the occupied states , that is , the subspace spanned by the @xmath4 eigenvectors @xmath40 in .",
    "virtually all quantities of interest in electronic structure theory can be computed as functionals of the density matrix @xmath61 ; see , e.g. , @xcite .",
    "it is this reformulation of the problem that allows for the development of potentially more efficient algorithms for electronic structure , including algorithms that asymptotically require only @xmath62 ( equivalently , @xmath2 ) arithmetic operations and storage .",
    "most current methodologies , including hartree ",
    "fock , density functional theory ( e.g. , kohn ",
    "sham ) , and hybrid schemes ( like blyp ) involve self - consistent field ( scf ) iterations , in which the density matrix @xmath61 must be computed at each scf step , typically with increasing accuracy as the outer iteration converges ; see , e.g. , @xcite .    as stated in section",
    "[ sec : introduction ] , in this paper we use some classical results from polynomial approximation theory and matrix analysis to provide a mathematical foundation for linear scaling electronic structure calculations for a very broad class of systems .",
    "we assume that the basis functions @xmath63 are localized , i.e. , decay rapidly outside of a small region .",
    "many of the most popular basis sets used in quantum chemistry , such as gaussian - type orbitals ( gto ) , which are functions of the form @xmath64 where @xmath65 is a normalization constant , satisfy this requirement @xcite . for systems with sufficient separation between atoms , this property implies a fast off - diagonal decay of the entries of the hamiltonian matrix ; moreover , a larger distance between atoms corresponds to a faster decay of matrix entries @xcite .",
    "if the entries that fall below a given ( small ) truncation tolerance are set to zero , the hamiltonian turns out to be a sparse matrix .",
    "decay results are especially easy to state in the banded case , is said to be @xmath66-banded if @xmath67 whenever @xmath68 ; for instance , a tridiagonal matrix is @xmath69-banded according to this definition . ] but more general sparsity patterns will be taken into account as well .",
    "we can also assume from the outset that the basis functions form an orthonormal set .",
    "if this is not the case , we perform a congruence transformation to an orthogonal basis and replace the original hamiltonian @xmath51 with @xmath70 , where @xmath71 is either the lwdin ( @xmath72 , see @xcite ) or the inverse cholesky ( @xmath73 , with @xmath74 ) factor of the overlap matrix @xmath52 ; see , e.g. , @xcite . here",
    "@xmath75 denotes the transpose of @xmath76 ; for the lwdin factorization , @xmath76 is symmetric ( @xmath77 ) . up to truncation ,",
    "the transformed matrix @xmath78 is still a banded ( or sparse ) matrix , albeit not as sparse as @xmath51 .",
    "hence , in our decay results we can replace @xmath51 with @xmath78 .",
    "the entries in @xmath79 , and therefore those in @xmath76 , decay at a rate which depends on the conditioning of @xmath52 .",
    "this , in turns , will depend on the particular basis set used , on the total number of basis functions , and on the inter - atomic distances , with larger separations leading to faster decay .",
    "this is further discussed in section [ overlap ] below .",
    "we note that the case of tight - binding hamiltonians is covered by our theory . indeed , the tight - binding method consists in expanding the states of the physical system ( e.g. , a crystal ) in linear combinations of atomic orbitals of the composing atoms ; such an approximation is successful if the atomic orbitals have little overlap , which translates to a sparse hamiltonian .",
    "the same applies to ` real space ' finite difference ( or finite element ) approximations @xcite . for a given sparse discrete hamiltonian @xmath51 in an orthonormal basis",
    ", we consider the problem of approximating the zero - temperature density matrix associated with @xmath51 , that is , the spectral projector @xmath61 onto the occupied subspace spanned by the eigenvectors corresponding to the smallest @xmath4 eigenvalues of @xmath51 : @xmath80 where @xmath81 for @xmath82 .",
    "clearly , @xmath61 is hermitian and idempotent : @xmath83 .",
    "consider now the heaviside ( step ) function @xmath84 where the number @xmath85 ( sometimes called the _ fermi level _ or _ chemical potential _ , see @xcite ) , is such that @xmath86 .",
    "if the _ spectral gap _ @xmath87 , also known as the homo - lumo gap , is not too small , the step function @xmath88 is well approximated by the fermi ",
    "dirac function @xmath89 for suitable values of @xmath90 : @xmath91^{-1}.\\ ] ] the smaller @xmath92 , the larger @xmath93 must be taken in order to have a good approximation : see fig .",
    "[ betagamma ] .",
    "the parameter @xmath93 can be interpreted as an ( artificial ) inverse temperature ; the zero - temperature limit is quickly approached as @xmath94 . a major advantage of the fermi ",
    "dirac function is that it is analytic ; hence , we can replace @xmath88 with @xmath95 and apply to it a wealth of results from approximation theory for analytic functions .",
    "we emphasize that the study of the zero - temperature limit  that is , the ground state of the system  is of fundamental importance in electronic structure theory . in the words of (",
    "* chapter 2 , pp .  11 - 12 ) :    _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ ... the lowest energy ground state of the electrons determines the structure and low - energy motions of the nuclei .",
    "the vast array of forms of matter  from the hardest material known , diamond carbon , to the soft lubricant , graphite carbon , to the many complex crystals and molecules formed by the elements of the periodic table  are largely manifestations of the ground state of the electrons .",
    "_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _    the fermi ",
    "dirac distribution is also used when dealing with systems at positive electronic temperatures ( @xmath96 ) with a small or null gap ( e.g. , metallic systems ) ; in this case @xmath97 , where @xmath98 is boltzmann s constant . in particular , use of the fermi ",
    "dirac function allows one to compute thermodynamical properties ( such as the specific heat ) and the @xmath99-dependence of quantities from first principles . in this case",
    ", of course , the matrix @xmath100 is no longer an orthogonal projector , not even approximately .",
    "we mention in passing that it is sometimes advantageous to impose the normalization condition @xmath101 on the density matrix ; indeed , such a condition is standard and part of the definition of density matrix in the quantum mechanics literature , beginning with von neumann @xcite . at zero temperature",
    "we have @xmath102 , and @xmath61 is replaced by @xmath103 . with this normalization @xmath61 is no longer idempotent , except when @xmath104 . in this paper",
    "we do not make use of such normalization .",
    "the localization ( pseudo - sparsity ) of the density matrix for insulators has been long known to physicists and chemists ; see the literature review in the following section .",
    "a number of authors have exploited this property to develop a host of linear scaling algorithms for electronic structure computations ; see , e.g. , @xcite . in this paper",
    "we derive explicitly computable decay bounds which can be used , at least in principle , to determine _ a priori _ the bandwidth or sparsity pattern of the truncation of the density matrix corresponding to a prescribed error . as we shall see , however , our decay estimates tend to be conservative and may be pessimistic in practice . hence , we regard our results primarily as a theoretical contribution , providing a rigorous ( yet elementary ) mathematical justification for some important localization phenomena observed by physicists .",
    "an important aspect of our work is that our bounds are universal , in the sense that they only depend on the bandwidth ( or sparsity pattern ) of the discrete hamiltonian @xmath51 , on the smallest and largest eigenvalues of @xmath51 , on the gap @xmath92 and , when relevant , on the temperature @xmath99 . in particular ,",
    "our results are valid for a wide range of basis sets and indeed for different discretizations and representations of the hamiltonian .",
    "the localization properties of spectral projectors ( more generally , density matrices ) associated with electronic structure computations in quantum chemistry and solid state physics have been the subject of a large number of papers .",
    "roughly speaking , the results found in the literature fall into three broad categories :    1 .",
    "fully rigorous mathematical results for model systems ( some quite general ) ; 2 .   semi - rigorous  results for specific systems ; these results are often characterized as exact , or analytical  by the authors ( usually phsyicists ) , but would not be recognized as mathematically rigorous by mathematicians ; 3 .",
    "non - rigorous results based on a mixture of heuristics , physical reasoning , and numerics",
    ".    contributions in the first group are typically due to researchers working in solid state and mathematical physics .",
    "these include the pioneering works of kohn @xcite and des cloizeaux @xcite , and the more recent papers by nenciu @xcite , brouder et al .",
    "@xcite , and a group of papers by prodan , kohn , and collaborators @xcite .    before summarizing the content of these contributions",
    ", we should mention that nearly all the results found in the literature are expressed at the continuous level , that is , in terms of decay in _ functions _ rather than decay in _",
    "matrices_. the functions are typically functions of ( real ) space ; results are often formulated in terms of the _ density kernel _ , but sometimes in terms of the _ wannier functions_. the latter form an orthonormal basis set associated with a broad class of hamiltonians , and are widely used in solid state physics . since the wannier functions span the occupied subspace , localization results for the wannier functions immediately imply similar localization results for the corresponding spectral projector .",
    "note , however , that the spectral projector may be exponentially localized even when the wannier functions are not .    at the continuous level , the density matrix @xmath105 is the kernel of the density operator @xmath106 defined by @xmath107 regarded as an integral operator on @xmath108 ; here @xmath109 .",
    "the vectors @xmath13 and @xmath110 represent any two points in @xmath111 , and @xmath112 is their ( euclidean ) distance . the density kernel can be expressed as @xmath113 where now @xmath40 is the ( normalized ) eigenfunction of the hamiltonian operator @xmath114 corresponding to the @xmath30th lowest eigenvalue , @xmath115 , and the asterisk denotes complex conjugation ; see .",
    "e.g. , @xcite .",
    "the density operator @xmath106 admits the dunford integral representation @xmath116 where @xmath117 is a simple closed contour in @xmath118 surrounding the eigenvalues of @xmath114 corresponding to the occupied states , with the remaining eigenvalues on the outside .    in @xcite",
    ", kohn proved the rapid decay of the wannier functions for one - dimensional , one - particle schrdinger operators with periodic and symmetric potentials with non - intersecting energy bands .",
    "this type of hamiltonian describes one - dimensional , centrosymmetric crystals .",
    "kohn s main result takes the following form : @xmath119 where @xmath120 denotes a wannier function ( here @xmath121 is the distance from the center of symmetry ) and @xmath122 is a suitable positive constant . in the same paper ( page 820 )",
    "kohn also points out that for free electrons ( not covered by his theory , which deals only with insulators ) the decay is very slow , being like @xmath123 .",
    "a few observations are in order : first , the decay result ( [ as_decay ] ) is asymptotic , that is , it implies fast decay at sufficiently large distances @xmath124 only .",
    "second , ( [ as_decay ] ) is consistent not only with strict exponential decay , but also with decay of the form @xmath125 where @xmath126 is arbitrary ( positive or negative ) and @xmath127 .",
    "hence , the actual decay could be faster , but also slower , than exponential . since the result in ( [ as_decay ] ) provides only an estimate ( rather than an upper bound ) for the density matrix in real space",
    ", it is not easy to use in actual calculations . to be fair ,",
    "such practical aspects were not discussed by kohn until much later ( see , e.g. , @xcite ) . also , later work showed that the asymptotic regime is achieved already for distances of the order of 1 - 2 lattice constants , and helped clarify the form of the power - law prefactor , as discussed below .",
    "the techniques used by kohn , mostly the theory of analytic functions in one complex variable and some classical asymptotics for linear second - order differential operators with variable coefficients , did not lend themselves naturally to the treatment of higher dimensionl cases or more complicated potentials .",
    "the problem of the validity of kohn s results in two and three dimensions has remained open for a very long time , and has been long regarded as one of the last outstanding problems of one - particle condensed - matter physics .",
    "partial results were obtained by des cloizeaux @xcite and much later by nenciu @xcite .",
    "des cloizeaux , who studied both the decay of the wannier functions and that of the associated spectral projectors , extended kohn s localization results to 3d insulators with a center of inversion ( a specific symmetry requirement ) in the special case of simple , isolated ( i.e. , nondegenerate ) energy bands ; he also treated the tight - binding limit for arbitrary crystals .",
    "nenciu further generalized kohn s results to arbitrary @xmath128-dimensional insulators , again limited to the case of simple bands .",
    "the next breakthrough came much more recently , when brouder et al .",
    "@xcite managed to prove localization of the wannier functions for a broad class of insulators in arbitrary dimensions .",
    "the potentials considered by these authors are sufficiently general for the results to be directly applicable to dft , both within the lda and the gga frameworks .",
    "the results in @xcite , however , also prove that for _ chern insulators _",
    "( i.e. , insulators for which the _ chern invariants _ , which characterize the band structure , are non - vanishing ) the wannier functions do _ not _ decay exponentially , therefore leaving open the question of proving the decay of the density matrix in this case @xcite . it should be mentioned that the mathematics in @xcite is fairly sophisticated , and requires some knowledge of modern differential geometry and topology .",
    "further papers of interest include the work by prodan , kohn , and collaborators @xcite . from the mathematical standpoint ,",
    "the most satisfactory results are perhaps those presented in @xcite . in this paper , the authors use norm estimates for complex symmetric operators in hilbert space to obtain sharp exponential decay estimates for the resolvents of rather general hamiltonians with spectral gap . using the contour integral representation formula ( [ cauchy ] ) , these estimates yield ( for sufficiently large separations ) exponential spatial decay bounds of the form @xmath129 for a broad class of insulators . a lower bound on the decay rate @xmath130 (",
    "also known as the _ decay length _ or _ inverse correlation length _ ) is derived , and the behavior of @xmath130 as a function of the spectral gap @xmath92 is examined .    among the papers in the second group , we mention @xcite .",
    "these papers provide quantitative decay estimates for the density matrix , either based on fairly rigorous analyses of special cases , or on not fully rigorous discussions of general situations .",
    "large use is made of approximations , asymptotics , heuristics and physically motivated assumptions , and the results are often validated by numerical calculations .",
    "also , it is occasionally stated that while the results were derived in the case of simplified models , the conclusions should be valid in general .",
    "several of these authors emphasize the difficulty of obtaining rigorous results for general systems in arbitrary dimension . in spite of not being fully rigorous from a mathematical point of view ,",
    "these contributions are certainly very valuable and seem to have been broadly accepted by physicists and chemists .",
    "we note , however , that the results in these papers usually take the form of order - of - magnitude estimates for the density matrix @xmath131 in real space , valid for sufficiently large separations @xmath112 , rather than strict upper bounds .",
    "as said before of kohn s results , this type of estimates may be difficult to use for computational purposes .",
    "in the case of insulators , the asymptotic decay estimates in these papers take the form @xmath132 where higher order terms have been neglected .",
    "many of these papers concern the precise form of the power - law factor ( i.e. , the value of @xmath14 ) in both insulators and metallic systems .",
    "the actual functional dependence of @xmath130 on the gap and of @xmath14 on the dimensionality of the problem have been the subject of intense discussion , with some authors claiming that @xmath130 is proportional to @xmath92 , and others finding it to be proportional to @xmath133 ; see , e.g. , @xcite and section [ dep_gap ] below .",
    "it appears that both types of behavior can occur in practice .",
    "for instance , in @xcite the authors provide a tight - binding model of an insulator for which the density falls off exponentially with decay length @xmath134 in the diagonal direction of the lattice , and @xmath135 in non - diagonal directions , as @xmath136 .",
    "we also note that in @xcite , the decay behavior of the density matrix for an insulator is found to be given ( up to higher order terms ) by @xmath137 where @xmath128 is the dimensionality of the problem . in practice ,",
    "the power - law factor in the denominator is often ignored , since the exponential decay dominates .    in @xcite ,",
    "goedecker argued that the density matrix for @xmath128-dimensional ( @xmath109 ) metallic systems at electronic temperature @xmath96 behaves to leading order like @xmath138 note that in the zero - temperature limit , a power - law decay ( with oscillations ) is observed .",
    "an analogous result was also obtained in @xcite .",
    "note that the decay length in the exponential goes to zero like the temperature @xmath99 rather than like @xmath139 , as claimed for instance in @xcite .",
    "we will return on this topic in section [ dep_t ] .    finally , as representatives of the third group of papers we select @xcite and @xcite .",
    "the authors of @xcite use the fermi ",
    "dirac approximation of the density matrix and consider its expansion in the chebyshev basis . from an estimate of the rate of decay of the coefficients of the chebyshev expansion of @xmath140",
    ", they obtain estimates for the number of terms needed to satisfy a prescribed error in the approximation of the density matrix . in turn , this yields estimates for the rate of decay as a function of the extreme eigenvalues and spectral gap of the discrete hamiltonian . because of some _ ad hoc _ assumptions and the many approximations used the arguments in this paper can not be considered mathematically rigorous , and the estimates thus obtained are not always accurate .",
    "nevertheless , the idea of using a polynomial approximation for the fermi  dirac function and the observation that exponential decay of the expansion coefficients implies exponential decay in the ( approximate ) density matrix is quite valuable and , as we show in this paper , can be made fully rigorous",
    ".    finally , in @xcite the authors present the results of numerical calculations for various insulators in order to gain some insight on the dependence of the decay length on the gap .",
    "their experiments confirm that the decay behavior of @xmath141 can be strongly anisotropic , and that different rates of decay may occur in different directions ; this is consistent with the analytical results in @xcite .    despite this considerable body of work",
    ", the localization question for density matrices can not be regarded as completely settled from the mathematical standpoint .",
    "we are not aware of any completely general and rigorous mathematical treatment of the decay properties in density matrices associated with general ( localized ) hamiltonians , covering all systems with gap as well as metallic systems at positive temperature .",
    "moreover , rather than order - of - magnitude estimates , actual upper bounds would be more satisfactory .    also , almost all the above - mentioned results concern the continuous , infinite - dimensional case . in practice , of course",
    ", calculations are performed on discrete , @xmath0-dimensional approximations @xmath51 and @xmath61 to the operators @xmath114 and @xmath106 .",
    "the replacement of density operators with finite density matrices can be obtained via the introduction of a system of @xmath0 basis functions @xmath46 , leading to the density matrix @xmath142 with @xmath143 as long as the basis functions are localized in space , the decay behavior of the density function @xmath144 for increasing spatial separation @xmath145 is reflected in the decay behavior of the matrix elements @xmath146 away from the main diagonal ( i.e. , for @xmath147 increasing ) or , more generally , for increasing distance @xmath148 in the graph associated with the discrete hamiltonian ; see section [ trunc ] for details .    in developing and analyzing @xmath2 methods for electronic structure computations , it is important to rigorously establish decay bounds for the entries of the density matrices that take into account properties of the discrete hamiltonians .",
    "it is in principle possible to obtain decay estimates for finite - dimensional approximations using localized basis functions from the spatial decay estimates for the density kernel .",
    "note , however , that any estimates obtained inserting ( [ density_decay_ins ] ) or ( [ density_decay_met ] ) into ( [ density_matrix ] ) would depend on the particular set of basis functions used .    in this paper",
    "we take a different approach . instead of starting with the continuous problem and discretizing it ,",
    "we establish our estimates directly for sequences of matrices of finite , but increasing order .",
    "we believe that this approach is closer to the practice of electronic structure calculations , where matrices are the primary computational objects .",
    "we impose a minimal set of assumptions on our matrix sequences so as to reproduce the main features of problems encountered in actual electronic structure computations , while at the same time ensuring a high degree of generality .",
    "since our aim is to provide a rigorous and general mathematical justification to the possibility of @xmath2 methods , this approach seems to be quite natural .    to put our work further into perspective , we quote from two prominent researchers in the field of electronic structure , one a mathematician , the other a physicist . in his excellent survey",
    "@xcite claude le bris , discussing the basis for linear scaling algorithms , i.e. , the assumed sparsity of the density matrix , wrote ( pages 402 and 404 ) :    _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ the latter assumption is in some sense an _ a posteriori _ assumption , and not easy to analyse [ ... ] it is to be emphasized that the numerical analyis of the linear scaling methods overviewed above that would account for cut - off rules and locality assumptions , is not yet available . _",
    "_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _    it is interesting to compare these statements with two earlier ones by stefan goedecker . in @xcite",
    "he wrote ( page 261 ) :    _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ to obtain a linear scaling , the extended orbitals [ i.e. , the eigenfunctions of the one - particle hamiltonian corresponding to occupied states ] have to be replaced by the density matrix , whose physical behavior can be exploited to obtain a fast algorithm .",
    "this last point is essential .",
    "mathematical and numerical analyses alone are not sufficient to construct a linear algorithm .",
    "they have to be combined with physical intuition . _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _    a similar statement can be found in @xcite , page 1086 :    _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ even though @xmath149 algorithms contain many aspects of mathematics and computer science they have , nevertheless , deep roots in physics .",
    "linear scaling is not obtainable by purely mathematical tricks , but it is based on an understanding of the concept of locality in quantum mechanics . _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _    in the following we provide a general treatment of the question of decay in spectral projectors that is as _ a priori _ as possible , in the sense that it relies on a minimal set of assumptions on the discrete hamiltonians ; furthermore , our theory is purely mathematical , and therefore completely independent of any physical interpretation .",
    "nevertheless , our theory allows us to shed light on questions like the dependence of the decay length on the temperature in the density matrix for metals at @xmath96 ; see section [ dep_t ] .",
    "we do this using for the most part fairly simple mathematical tools from classical approximation theory and linear algebra .",
    "of course , in the development of practical linear scaling algorithms a deep knowledge of the physics involved is extremely important ; we think , however , that locality is as much a _ mathematical phenomenon _ as a physical one .",
    "we hope that the increased level of generality attained in this paper ( relative to previous treatments in the physics literature ) will also help in the development of @xmath2 methods for other types of problems where spectral projectors and related matrix functions play a central role .",
    "a few examples are discussed in section [ other ] .",
    "we will be dealing with sequences of matrices @xmath150 of increasing size .",
    "we assume that each matrix @xmath151 is an hermitian @xmath60 matrix , where @xmath152 ; here @xmath48 is fixed , while @xmath4 is increasing . as explained in section [ sec : dm ] , the motivation for this assumption is that in most electronic structure codes , once a basis set has been selected the number @xmath48 of basis functions per particle is fixed , and one is interested in the scaling as @xmath4 , the number of particles , increases .",
    "hence , the parameter that controls the system size is @xmath4 .",
    "we also assume that the system is contained in a @xmath128-dimensional box of volume @xmath153 and that @xmath154 as @xmath155 in such a way that the average density @xmath156 remains constant ( _ thermodynamic limit _ ) .",
    "this is very different from the case of finite element or finite difference approximations to partial differential equations ( pdes ) , where the system ( or domain ) size is considered fixed while the number of basis functions increases or , equivalently , the mesh size @xmath88 goes to zero .",
    "our scaling assumption has very important consequences on the structural and spectral properties of the matrix sequence @xmath150 ; namely , the following properties hold : +    1 .",
    "the bandwidth of @xmath151 , which reflects the _ interaction range _ of the discrete hamiltonians , remains bounded as the system size increases @xcite .",
    "more generally , the entries of @xmath151 decay away from the main diagonal at a rate independent of @xmath4 ( hence , of @xmath0 ) . see section [ trunc ] for precise definitions and generalizations .",
    "the eigenvalue spectra @xmath157 are also uniformly bounded as @xmath155 . in view of the previous property , this is equivalent to saying that the entries in @xmath151 are uniformly bounded in magnitude : this is just a consequence of gergorin s theorem ( see , e.g. , @xcite ) .",
    "3 .   for the case of hamiltonians modeling insulators or semiconductors , the spectral ( homo - lumo ) gap does not vanish as @xmath158 . more precisely : if @xmath159 denotes the @xmath30th eigenvalue of @xmath151 , and @xmath160 , then @xmath161 . this assumption does not hold for hamiltonians modelling metallic systems ; in this case , @xmath162 , i.e. , the spectral gap goes to zero as @xmath158 .",
    "we emphasize that these properties hold for very general classes of physical systems and discretization methods for electronic structure , with few exceptions ( i.e. , non - localized basis functions , such as plane waves ) .",
    "it is instructive to contrast these properties with those of matrix sequences arising in finite element or finite difference approximations of pdes , where the matrix size increases as @xmath163 , with @xmath88 a discretization parameter . considering the case of a scalar , second - order elliptic pde",
    ", we see that the first property only holds in the one - dimensional case , or in higher - dimensional cases when the discretization is refined in only one dimension .",
    "( as we will see , this condition is rather restrictive and can be relaxed . )",
    "furthermore , it is generally impossible to satisfy the second assumption and the one on the non - vanishing gap ( @xmath161 ) simultaneously . indeed ,",
    "normalizing the matrices so that their spectra remain uniformly bounded will generally cause the eigenvalues to completely fill the spectral interval as @xmath3 .",
    "that is , in general , given any two points inside this interval , for @xmath0 large enough at least one eigenvalue of the corresponding @xmath60 matrix falls between these two points .",
    "our assumptions allow us to refer to the spectral gap of the matrix sequence @xmath150 without having to specify whether we are talking about an absolute or a relative gap .",
    "as we shall see , it is convenient to assume that all the matrices in the sequence @xmath150 have spectrum contained in the interval @xmath164 $ ] ; therefore , the absolute gap and the relative gap of any matrix @xmath151 are the same , up to the factor 2 .",
    "the spectral gap ( more precisely , its reciprocal ) is a natural measure of the conditioning of the problem of computing the spectral projector onto the occupied subspace , i.e. , the subspace spanned by the eigenvectors of @xmath151 corresponding to eigenvalues @xmath165 ; see , e.g. , @xcite for a recent discussion .",
    "the assumption @xmath161 then simply means that the electronic structure problem is _ uniformly well - conditioned _ ; note that this assumption is also very important for the convergence of the outer scf iteration @xcite .",
    "this hypothesis is satisfied for insulators and semiconductors , but not in the case of metals .",
    "discretization of @xmath114 , the hamiltonian operator , by means of basis sets consisting of linear combinations of slater or gaussian - type orbitals leads to matrix representations that are , strictly speaking , full . indeed , since these basis functions are globally supported , almost all matrix elements @xmath166 are non - zero .",
    "the same is true for the entries of the overlap matrix @xmath167 .",
    "however , owing to the rapid decay of the basis functions outside of a localized region , and due to the local nature of the interactions encoded by the hamiltonian operator , the entries of @xmath51 decay exponentially fast with the spatial separation of the basis functions .",
    "( for the overlap matrix corresponding to gaussian - type orbitals , the decay is actually even faster than exponential . )",
    "more formally , we say that a sequence of @xmath60 matrices @xmath168_{ij}\\right ) $ ] has the _ exponential off - diagonal decay property _ if there are constants @xmath169 and @xmath170 independent of @xmath0 such that @xmath171_{ij}\\right | \\leq c\\ , { \\rm e}^{-\\alpha |i - j| } , \\quad { \\rm for \\,\\ , all}\\quad      i , j=1,\\ldots , n. \\label{truncerr}\\ ] ] corresponding to each matrix @xmath172 we then define for a nonnegative integer @xmath66 the matrix @xmath173_{ij}\\right ) $ ] defined as follows : @xmath174_{ij } =   \\begin{cases }      \\begin{array}{cc }      [ a_n]_{ij } & { \\rm if}\\quad   |i - j| \\leq m;\\\\      0 & { \\rm otherwise}.      \\end{array } \\end{cases}\\ ] ] clearly , each matrix @xmath175 is @xmath66-banded and can be thought of as an approximation , or truncation , of @xmath172 .",
    "note that the set of @xmath66-banded matrices forms a vector subspace @xmath176 and that @xmath175 is just the orthogonal projection of @xmath172 onto @xmath177 with respect to the frobenius inner product @xmath178 .",
    "hence , @xmath175 is the best approximation of @xmath172 in @xmath177 with respect to the frobenius norm .",
    "note that we do not require the matrices to be hermitian or symmetric here ; we only assume ( for simplicity ) that the same pattern of non - zero off - diagonals is present on either side of the main diagonal .",
    "the following simple result from @xcite provides an estimate of the rate at which the truncation error decreases as the bandwidth @xmath66 of the approximation increases .",
    "in addition , it establishes @xmath0-independence of the truncation error for @xmath3 for matrix sequences satisfying ( [ truncerr ] ) .",
    "@xcite [ ter ] let @xmath179 be a matrix with entries @xmath180 satisfying ( [ truncerr ] ) and let @xmath181 be the corresponding @xmath66-banded approximation . then for any @xmath182 there is an @xmath183 such that @xmath184 for @xmath185 .",
    "the integer @xmath183 in the foregoing proposition is easily found to be given by @xmath186 clearly , this result is of interest only for @xmath187 ( in fact , for @xmath188 ) .",
    "let us consider a tridiagonal matrix @xmath51 of size @xmath189 , with eigenvalues randomly chosen in @xmath190\\cup [ 0.5,1]$ ] , and let @xmath61 be the associated density matrix with @xmath191 .",
    "numerical computation shows that @xmath61 satisfies the bound with @xmath192 and @xmath193 ( as long as its entries are larger than the machine precision ) .",
    "[ mbarexample ] depicts the absolute value of the entries in the first row of @xmath61 and the bound , in a logarithmic scale .",
    "choose , for instance , a tolerance @xmath194 ; then it follows from the previous formula that the truncated matrix @xmath195 satisfies @xmath196 for any bandwidth @xmath197 .",
    "what is important about this simple result is that when applied to a sequence @xmath198_{ij}\\right ) $ ] of @xmath60 matrices having the off - diagonal decay property ( [ truncerr ] ) with @xmath199 and @xmath130 independent of @xmath0 , the bandwidth @xmath183 is itself independent of @xmath0 . for convenience ,",
    "we have stated proposition [ ter ] in the @xmath69-norm ; when @xmath200 the same conclusion holds for the @xmath201-norm , owing to the inequality @xmath202 ( see ( * ? ? ?",
    "* corollary 2.3.2 ) ) .",
    "moreover , a similar result also applies to other types of decay , such as algebraic ( power - law ) decay of the form @xmath203_{ij}\\right | \\leq \\frac{c}{|i - j|^p + 1 } , \\quad { \\rm for \\,\\ , all } \\quad i , j = 1,\\ldots , n\\ ] ] with @xmath199 and @xmath126 independent of @xmath0 , as long as @xmath204 .",
    "it is worth emphasizing that the above considerations do not require that the matrix entries @xmath205_{ij}$ ] themselves actually decay exponentially away from the main diagonal , but only that they are bounded above in an exponentially decaying manner . in particular , the decay behavior of the matrix entries need not be monotonic .",
    "although we have limited ourselves to absolute approximation errors in various norms , it is easy to accommodate relative errors by normalizing the matrices .",
    "indeed , upon normalization all the hamiltonians satisfy @xmath206 ; furthermore , for density matrices this property is automatically satisfied , since they are orthogonal projectors . in the next section",
    "we also consider using the frobenius norm for projectors .",
    "the foregoing considerations can be extended to matrices with more general decay patterns , i.e. , with exponential decay away from a subset of selected positions @xmath207 in the matrix ; see , e.g. , @xcite as well as @xcite . in order to formalize this notion ,",
    "we first recall the definition of _ geodetic distance _ @xmath148 in a graph @xcite : it is the number of edges in the shortest path connecting two nodes @xmath30 and @xmath208 , possibly infinite if there is no such path .",
    "next , given a ( sparse ) matrix sequence @xmath209 we associate with each matrix @xmath172 a graph @xmath210 with @xmath0 nodes and @xmath211 edges . in order to obtain meaningful results , however , we need to impose some restrictions on the types of sparsity allowed . recall that the _ degree _ of node @xmath30 in a graph is just the number of neighbors of @xmath30 , i.e. , the number of nodes at distance 1 from @xmath30 .",
    "we denote by @xmath212 the degree of node @xmath30 in the graph @xmath210 .",
    "we shall assume that the maximum degree of any node in @xmath210 remains bounded as @xmath3 ; that is , there exists a positive integer @xmath213 independent of @xmath0 such that @xmath214 for all @xmath0 .",
    "note that when @xmath215 ( discretized hamiltonian ) , this property is a mathematical restatement of the physical notion of locality , or finite range , of interactions .",
    "now let us assume that we have a sequence of @xmath60 matrices @xmath216_{ij}\\right ) $ ] with associated graphs @xmath210 and graph distances @xmath217 .",
    "we will say that @xmath218 has the _ exponential decay property relative to the graph @xmath210 _ if there are constants @xmath169 and @xmath170 independent of @xmath0 such that @xmath171_{ij}\\right | \\leq c\\ , { \\rm e}^{-\\alpha d_n(i , j ) } ,      \\quad { \\rm for \\,\\ , all}\\quad      i , j=1,\\ldots , n. \\label{truncerr1}\\ ] ]    we have the following simple result .    [ ter1 ]",
    "let @xmath209 be a sequence of @xmath60 matrices satisfying the exponential decay property ( [ truncerr1 ] ) relative to a sequence of graphs",
    "@xmath219 having uniformly bounded maximal degree .",
    "then , for any given @xmath220 , each @xmath172 contains at most @xmath2 entries greater than @xmath221 in magnitude .    for a fixed node @xmath30 , the condition @xmath222_{ij}\\right | > \\epsilon$ ] together with ( [ truncerr1 ] )",
    "immediately implies @xmath223 since @xmath199 and @xmath130 are independent of @xmath0 , inequality ( [ pip ] ) together with the assumption that the graphs @xmath210 have bounded maximal degree implies that for any row of the matrix ( indexed by @xmath30 ) , there is at most a constant number of entries that have magnitude greater than @xmath221 .",
    "hence , only @xmath2 entries in @xmath172 can satisfy @xmath222_{ij}\\right |",
    "> \\epsilon$ ] .",
    "note that the hypothesis of uniformly bounded maximal degrees is certainly satisfied if the graphs @xmath210 have uniformly bounded bandwidths ( recall that the bandwidth of a graph is just the bandwidth of the corresponding adjacency matrix ) .",
    "this special case corresponds to the matrix sequence @xmath209 having the off - diagonal exponential decay property .    under the same assumptions of proposition [ ter1 ]",
    ", we can show that it is possible to approximate each @xmath172 to within an arbitrarily small error @xmath224 in norm with a sparse matrix @xmath175 ( i.e. , a matrix containing only @xmath2 non - zero entries ) .",
    "[ ter2 ] assume the hypotheses of proposition [ ter1 ] are satisfied .",
    "define the matrix @xmath225_{ij}\\right)$ ] , where @xmath174_{ij } =   \\begin{cases }      \\begin{array}{cc }      [ a_n]_{ij } & { \\rm if}\\quad   d_n(i , j ) \\leq m;\\\\      0 & { \\rm otherwise}.      \\end{array } \\end{cases}\\ ] ] then for any given @xmath224 , there exists @xmath183 independent of @xmath0 such that @xmath226 , for all @xmath227 .",
    "moreover , if @xmath200 then it is also @xmath228 for all @xmath227 .",
    "furthermore , each @xmath175 contains only @xmath2 non - zeros .    for each @xmath0 and @xmath66 and for @xmath229 , let @xmath230 we have @xmath231_{ij } \\right | \\le c \\max_{1\\le j\\le n }   \\sum_{i\\in k_{n}^m(j ) } { \\rm e}^{-\\alpha d_n(i , j)}.\\ ] ] letting @xmath232 , we obtain @xmath233 since @xmath234 , for any given @xmath182 we can always find @xmath183 such that @xmath235 if @xmath236 , then @xmath237 for all @xmath227 .",
    "the last assertion follows from the bounded maximal degree assumption .    hence , when forming the overlap matrices and discrete hamiltonians , only matrix elements corresponding to ` sufficiently nearby ' basis functions ( i.e. , basis functions having sufficient overlap ) need to be computed , the others being negligibly small .",
    "the resulting matrices are therefore sparse , and indeed banded for 1d problems , with a number of non - zeros that grows linearly in the matrix dimension . the actual bandwidth , or sparsity pattern ,",
    "may depend on the choice and numbering ( ordering ) of basis functions and ( for the discrete hamiltonians ) on the strength of the interactions , i.e. , on the form of the potential function @xmath238 in the hamiltonian operator .",
    "it should be kept in mind that while the number of non - zeros in the hamiltonians discretized using ( say ) gaussian - type orbitals is @xmath2 , the actual number of non - zeros per row can be quite high , indeed much higher than when finite differences or finite elements are used to discretize the same operators .",
    "it is not unusual to have hundreds or even thousands of non - zeros per row . on the other hand ,",
    "the matrices are very often not huge in size .",
    "as already mentioned , the size @xmath0 of the matrix is the total number of basis functions , which is a small or moderate multiple ( between 2 and 25 , say ) of the number @xmath4 of electrons .",
    "for example , if @xmath239 and @xmath240 , the size of @xmath51 will be @xmath241 and @xmath51 could easily contain several millions of non - zeros .",
    "this should be compared with ` real space ' discretizations based on finite elements or high - order finite difference schemes @xcite .",
    "the resulting hamiltonians are usually very sparse , with a number of non - zero entries per row averaging a few tens at most @xcite . however , these matrices are of much larger dimension than the matrices obtained using basis sets consisting of atom - centered orbitals . in this case , methodologies based on approximating the density matrix are currently not feasible , except for 1d problems .",
    "the same remark applies to discretizations based on plane waves , which tend to produce matrices of an intermediate size between those obtained using localized basis sets and those resulting from the use of real space discretizations .",
    "these matrices are actually dense and are never formed explicitly .",
    "instead , they are only used in the form of matrix - vector products , which can be implemented efficiently by means of ffts ; see , e.g. , @xcite .",
    "the possibility of developing linear scaling methods for electronic structure largely depends on the localization properties of the density matrix @xmath61 .",
    "it is therefore critical to understand the decay behavior of the density matrix .",
    "since at zero temperature the density matrix is just a particular spectral projector , we consider next some general properties of such projectors .",
    "while our main goal in this paper is to study decay properties in orthogonal projectors associated with certain sequences of sparse matrices of increasing size , it is useful to first establish some _ a priori _ estimates for the entries of general projectors .",
    "indeed , the intrinsic properties of a projector like idempotency , positive semidefiniteness , and the relations between their trace , rank , and frobenius norm tend to impose rather severe constraints on the magnitude of its entries , particularly for increasing dimension and rank .",
    "we begin by observing that in an orthogonal projector @xmath61 , all entries @xmath146 satisfy @xmath242 and since @xmath61 is positive semidefinite , its largest entry is on the main diagonal .",
    "also , the trace and rank coincide : @xmath243 .",
    "moreover , @xmath244 and @xmath245 .    in the context of electronic structure computations , we deal with a sequence of @xmath60 orthogonal projectors @xmath246 of rank @xmath4 , where @xmath152 with @xmath4 increasing and @xmath48 fixed",
    "hence , @xmath247 for convenience , we will call a sequence of orthogonal projectors @xmath246 satisfying ( [ dens_mat_seq ] ) a _ density matrix sequence _ ; the entries of @xmath248 will be denoted by @xmath249_{ij}$ ] .",
    "we have the following lemma .    [ lemma1 ]",
    "let @xmath246 be a density matrix sequence .",
    "then @xmath250_{ij}\\right |^2 } \\ ] ] p_n_f^2 1 - .@xmath251    just observe that @xmath252_{ii } = n_e$ ] together with @xmath253_{ii}\\right |\\leq 1 $ ] for all @xmath30 imply that the minimum of the sum @xmath254_{ii}\\right |^2 $ ] is achieved when @xmath249_{ii } = \\frac{n_e}{n } = \\frac{1}{n_b}$ ] for all @xmath30 .",
    "hence , @xmath254_{ii}\\right |^2 \\geq \\frac{n}{n_b^2}= \\frac{n_e}{n_b}$ ]",
    ". therefore , @xmath255_{ij}\\right |^2 = \\|p_n\\|_f^2 -   \\sum_{i=1}^n \\left |[p_n]_{ii}\\right |^2 \\leq \\left ( 1-\\frac{1}{n_b } \\right ) n_e\\ ] ] and the result follows dividing through by @xmath256 .",
    "from the proof one can trivially see that the bound ( [ off ] ) is sharp . in section [ metals ]",
    "we shall see a non - trivial example where the bound is attained .",
    "let @xmath246 be a density matrix sequence .",
    "then , for any @xmath182 , the number of entries of @xmath248 greater than or equal to @xmath221 in magnitude grows at most linearly with @xmath0 .",
    "clearly , it suffices to show that the number of off - diagonal entries @xmath249_{ij}$ ] with @xmath257_{ij}|\\geq \\epsilon$ ] can grow at most linearly with @xmath0 .",
    "let @xmath258_{ij}\\right |^2 = \\sum_{(i , j)\\in { \\cal i}_{\\epsilon}}\\left |[p_n]_{ij}\\right |^2 + \\sum_{(i , j)\\in { \\cal i}\\setminus { \\cal i}_{\\epsilon}}\\left |[p_n]_{ij}\\right |^2\\ ] ] and if @xmath259 , then @xmath260_{ij}\\right |^2 \\geq k\\epsilon^2 \\quad \\rightarrow   \\quad \\frac{\\sum_{i\\neq j}\\left |[p_n]_{ij}\\right |^2 } { \\|p_n\\|_f^2 } \\geq \\frac{k\\epsilon^2}{n_e}=\\frac{k\\epsilon^2n_b}{n}.\\ ] ] hence , by lemma [ lemma1 ] , @xmath261_{ij}\\right |^2 } { \\|p_n\\|_f^2 }   \\leq 1 - \\frac{1}{n_b},\\ ] ] from which we obtain the bound @xmath262 which shows that the number @xmath263 of entries of @xmath248 with @xmath257_{ij}|\\geq \\epsilon$ ] can grow at most as @xmath2 for @xmath3 .    due to the presence of the factor @xmath264 in the denominator of the bound ( [ bound1 ] ) , for small @xmath221 the proportion of entries of @xmath248 that are not smaller than @xmath221 can actually be quite large unless @xmath0 is huge .",
    "nevertheless , the result is interesting because it shows that in any density matrix sequence , the proportion of entries larger than a prescribed threshold must vanish as @xmath3 . in practice , for density matrices corresponding to sparse hamiltonians with gap",
    ", localization occurs already for moderate values of @xmath0 .",
    "we already pointed out in the previous section that if the entries in a matrix sequence @xmath209 decay at least algebraically with exponent @xmath204 away from the main diagonal , with rates independent of @xmath0 , then for any prescribed @xmath224 it is possible to find a sequence of approximants @xmath265 with a fixed bandwidth @xmath66 ( or sparsity pattern ) such that @xmath266 .",
    "this applies in particular to density matrix sequences .",
    "the next result shows that in principle , a _ linear _ rate of decay is enough to allow for banded ( or sparse ) approximation to within any prescribed _ relative _ error in the frobenius norm .",
    "[ linear ] let @xmath246 be a density matrix sequence and assume that there exists @xmath267 independent of @xmath0 such that @xmath253_{ij } \\right | \\leq c/(|i - j| + 1)$ ] for all @xmath268 .",
    "then , for all @xmath182 , there exists a positive integer @xmath183 independent of @xmath0 , such that @xmath269 where @xmath270 is the @xmath66-banded approximation obtained by setting to zero all the entries of @xmath248 outside the band .",
    "we subtract @xmath270 from @xmath248 and compute @xmath271 by adding the squares of the non - zeros entries in the upper triangular part of @xmath272 diagonal by diagonal and multiplying the result by 2 ( since the matrices are hermitian ) . using the decay assumption",
    "we obtain @xmath273 ^ 2}.\\ ] ] to obtain an upper bound for the right - hand side , we observe that the function @xmath274 is strictly increasing and convex on the interval @xmath275 $ ] . hence , the sum can be bounded above by the integral of @xmath276 taken over the same interval : @xmath277 evaluating the integral and substituting @xmath278 in the result we obtain @xmath279.\\ ] ] dividing by @xmath280 we find @xmath281 < \\frac{2c^2}{n_e}\\frac{n+1}{m+1}.\\ ] ] recalling that @xmath152 , we can rewrite the last inequality as @xmath282 a quantity which can be made arbitrarily small by taking @xmath66 sufficiently large .    in practice , linear decay ( or even algebraic decay with a small exponent @xmath283 ) is too slow to be useful in the development of practical @xmath2 algorithms . for example , from the above estimates we obtain @xmath284 which is clearly not a very encouraging result , even allowing for the fact that the above bound may be pessimistic in general . to date ,",
    "practical linear scaling algorithms have been developed only for density matrix sequences exhibiting exponential off - diagonal decay .    in the case of exponential decay",
    ", one can prove the following result .",
    "let @xmath246 be a density matrix sequence with @xmath253_{ij}\\right |\\leq c\\ , { \\rm e}^{-\\alpha |i - j|}$ ] , where @xmath267 and @xmath170 are independent of @xmath0 .",
    "let @xmath285 be the corresponding sequence of @xmath66-banded approximations .",
    "then there exists @xmath286 independent of @xmath0 and @xmath66 such that @xmath287    similar to that of theorem [ linear ] , except that it is now easy to evaluate the upper bound and the constants exactly .",
    "we omit the details .",
    "it is immediate to see that the foregoing bound implies the much more favorable estimate @xmath288 .",
    "again , similar results holds for arbitrary sparsity patterns , replacing @xmath147 with the graph distance .",
    "more precisely , the following result holds .",
    "let @xmath246 be a density matrix sequence with the exponential decay property with respect to a sequence of graphs @xmath219 having uniformly bounded maximal degree .",
    "then , for all @xmath289 , there exists a positive integer @xmath183 independent of @xmath0 such that @xmath290 where @xmath270 is sparse , i.e. , it contains only @xmath2 non - zeros .",
    "we consider now some of the consequences of approximating full , but localized matrices with sparse ones .",
    "the following quantity plays an important role in many electronic structure codes : @xmath291 _ 1 + _ 2 + + _ n_e , @xmath251 where @xmath292 denotes the @xmath30th eigenvalue of the discrete hamiltonian @xmath51 .",
    "minimization of @xmath293 , subject to the constraints @xmath294 and @xmath295 , is the basis of several linear scaling algorithms ; see , e.g. , @xcite .",
    "note that in the tight - binding model , and also within the independent electron approximation , the quantity @xmath296 represents the single - particle energy @xcite .",
    "now , assume that @xmath297 and @xmath298 , and define the corresponding approximation of @xmath299 as @xmath300 .",
    "( we note in passing that in order to compute @xmath301 , only the entries of @xmath302 corresponding to non - zero entries in @xmath303 need to be computed . )",
    "let @xmath304 and @xmath305 .",
    "we have @xmath306 = { \\rm tr}(ph ) + { \\rm tr}(p \\delta_h ) + { \\rm tr}(\\delta_p h ) +   { \\rm tr}(\\delta_p \\delta_h).\\ ] ] neglecting the last term , we obtain for @xmath307 recalling that the frobenius norm is the matrix norm induced by the inner product @xmath308 , using the cauchy  schwarz inequality and @xmath309",
    "we find @xmath310 now , since the orthogonal projector @xmath61 is invariant with respect to scalings of the hamiltonian , we can assume @xmath311 , so that @xmath312 holds . in practice ,",
    "a bound on the _ relative _ error would be more meaningful .",
    "unfortunately , it is not easy to obtain a rigorous bound in terms of the relative error in the approximate projector @xmath302 . if , however , we replace the relative error in @xmath313 with the normalized error obtained by dividing the absolute error by the number @xmath4 of electrons , we obtain @xmath314 a similar bound for @xmath315 that involves matrix 2-norms can be obtained as follows .",
    "recall that @xmath316 , and that @xmath317 for any @xmath60 matrix @xmath179 .",
    "observing that the von neumann trace inequality @xcite implies @xmath318 , we obtain @xmath319 since @xmath48 is constant , an interesting consequence of ( [ err_est_f ] ) is that for large system sizes ( i.e. , in the limit as @xmath158 ) , the normalized error in @xmath313 is essentially determined by the truncation error in the hamiltonian @xmath51 rather than by the error in the density matrix @xmath61 .    on the other hand , scaling @xmath51 so that @xmath311 may not be advisable in practice . indeed , since the frobenius norm of the hamiltonian grows unboundedly for @xmath155 , rescaling @xmath51 so that @xmath311 would lead to a loss of significant information when truncation is applied in the case of large systems .",
    "a more sensible scaling , which is often used in algorithms for electronic structure computations , is to divide @xmath320 by its largest eigenvalue in magnitude , so that @xmath321 .",
    "this is consistent with the assumption , usually satisfied in practice , that the spectra of the hamiltonians remain bounded as @xmath155 .",
    "( note this is the same normalization used to establish the decay bounds in section [ sec_main ] . ) with this scaling we readily obtain , to first order , the bound @xmath322 showing that errors in @xmath323 and @xmath324 enter the estimate for the normalized error in the objective function @xmath325 with approximately the same weight , since @xmath48 is a moderate constant .",
    "we also note that since both error matrices @xmath323 and @xmath324 are hermitian , ( [ norm_ineq ] ) implies that the bounds ( [ err_est_f ] ) and ( [ err_est_2 ] ) remain true if the @xmath201-norm is replaced by the @xmath69-norm .",
    "we mention that the problem of the choice of norm in the measurement of truncation errors has been discussed in @xcite .",
    "these authors emphasize the use of the @xmath201-norm , which is related to the distance between the exact and inexact ( perturbed ) occupied subspaces @xmath326 and @xmath327 as measured by the sine of the principal angle between @xmath328 and @xmath329 ; see @xcite .    one important practical aspect , which we do not address here , is that in many quantum chemistry codes the matrices have a natural block structure ( where each block corresponds , for instance , to the basis functions centered at a given atom ) ; hence , dropping is usually applied to submatrices rather than to individual entries .",
    "exploitation of the block structure is also desirable in order to achieve high performance in matrix - matrix products and other operations , see , e.g. , @xcite .",
    "we conclude this section with a few remarks on the infinite - dimensional case .",
    "recall that any separable , complex hilbert space @xmath330 is isometrically isomorphic to the sequence space latexmath:[\\[{\\ell } ^2:= \\big \\{(\\xi_n ) \\",
    ", | \\ , \\xi_n \\in \\complex \\,\\ ,   \\forall n\\in \\naturals \\,\\,\\ , { \\rm and } \\,\\,\\ , \\sum_{n=1}^\\infty     an orthonormal basis in @xmath330 , to any bounded linear operator @xmath332 on @xmath330 there corresponds the infinite matrix @xmath333 acting on @xmath334 , uniquely defined by @xmath335 .",
    "note that each column of @xmath179 must be in @xmath334 , hence the entries @xmath180 in each column of @xmath179 must go to zero for @xmath336 .",
    "the same is true for the entries in each row ( for @xmath337 since @xmath338 , the adjoint of @xmath179 , is also a ( bounded ) operator defined everywhere on @xmath334 .",
    "more precisely , for any bounded linear operator @xmath333 on @xmath334 the following bounds hold : @xmath339 since @xmath340 .",
    "an orthogonal projector @xmath106 on @xmath330 is a self - adjoint ( @xmath341 ) , idempotent ( @xmath342 ) linear operator .",
    "such an operator is necessarily bounded , with norm @xmath343 .",
    "hence , ( [ cook ] ) implies @xmath344 where @xmath142 denotes the matrix representation of @xmath106 .",
    "the idempotency condition implies @xmath345 in particular , for @xmath346 we get , using the hermiticity property @xmath347 : @xmath348 now , since @xmath61 is a projector its entries satisfy @xmath349 , therefore ( [ p_ii ] ) is a strengthening of inequality ( [ p_cook ] ) .",
    "note in particular that the off - diagonal entries in the first row ( or column ) of @xmath61 must satisfy @xmath350 those in the second row ( or column ) must satisfy @xmath351 and in general the entries @xmath146 with @xmath352 must satisfy @xmath353 hence , decay in the off - diagonal entries in the @xmath30th row of @xmath61 must be fast enough for the bounds ( [ proj_j ] ) to hold . in general , however , it is not easy to quantify the asymptotic rate of decay to zero of the off - diagonal entries in an arbitrary orthogonal projector on @xmath334 . in general , the rate of decay can be rather slow . in section [ metals ] we will see an example of spectral projector associated with a very simple tridiagonal hamiltonian for which the off - diagonal entries decay linearly to zero .",
    "in this section we present and discuss some results on the decay of entries for the fermi  dirac function applied to hamiltonians and for the density matrix ( spectral projector corresponding to occupied states ) .",
    "we consider both the banded case and the case of more general sparsity patterns .",
    "the proofs , which require some basic tools from polynomial approximation theory , will be given in subsection [ proofs ] .",
    "we begin with the following result for the banded case . as usual in this paper , in the following one should think of the positive integer @xmath0 as being of the form @xmath152 with @xmath48 constant and @xmath158 .",
    "[ thm1 ] let @xmath66 be a fixed positive integer and consider a sequence of matrices @xmath150 such that :    * @xmath151 is an @xmath60 hermitian , @xmath66-banded matrix for all @xmath0 ; * for every @xmath0 , all the eigenvalues of @xmath151 lie in the interval @xmath164 $ ] .    for a given fermi level @xmath85 and inverse temperature @xmath93 , define for each @xmath0 the @xmath60 hermitian matrix @xmath354^{-1}$ ] .",
    "then there exist constants @xmath267 and @xmath355 , independent of @xmath0 , such that the following decay bound holds : @xmath356_{ij}|\\leq c\\ , { \\rm e}^{-\\alpha |i - j|},\\qquad i\\neq j.\\label{bound}\\ ] ] the constants @xmath199 and @xmath130 can be chosen as @xmath357 for any @xmath358 , where @xmath359 and @xmath360 is the unique ellipse with foci in @xmath361 and @xmath69 with semi - axes @xmath362 and @xmath363 , and @xmath364 .",
    "the ellipse @xmath360 in the previous theorem is unique because the identity @xmath365 , valid for any ellipse with foci in @xmath69 and @xmath361 , implies @xmath366 , hence the parameter @xmath367 alone completely characterizes the ellipse .",
    "theorem [ thm1 ] can be immediately generalized to the case where the spectra of the sequence @xmath150 are contained in an interval @xmath368 $ ] , for any @xmath369 . it suffices to shift and scale each hamiltonian : @xmath370 so that @xmath371 has spectrum in @xmath164 $ ] .",
    "for the decay bounds to be independent of @xmath0 , however , @xmath372 and @xmath373 must be independent of @xmath0 .     and",
    "@xmath374 , for three different values of @xmath375.,scaledwidth=100.0% ]     and @xmath374.,scaledwidth=100.0% ]    it is important to note that there is a certain amount of arbitrariness in the choice of @xmath375 , and therefore of @xmath199 and @xmath130 . if one is mainly interested in a fast asymptotic decay behavior ( i.e. , for sufficiently large @xmath147 ) , it is desirable to choose @xmath375 as large as possible . on the other hand ,",
    "if @xmath375 is very close to @xmath376 then the constant @xmath199 is likely to be quite large and the bounds might be too pessimistic .",
    "let us look at an example .",
    "take @xmath191 ; in this case we have @xmath377 note that , in agreement with experience , decay is faster for smaller @xmath93 ( i.e. , higher electronic temperatures ) ; see sections [ proofs ] and [ dep_t ] for additional details and discussion .",
    "figures [ fig1 ] and [ fig2 ] show the behavior of the bound given by on the first row of a @xmath189 tridiagonal matrix ( @xmath378 ) for @xmath374 and for three values of @xmath375 .",
    "it is easy to see from the plots that the asymptotic behavior of the bounds improves as @xmath375 increases ; however , the bound given by @xmath379 is less useful than the bound given by @xmath380 .",
    "figure [ fig3 ] is a plot of @xmath199 as a function of @xmath375 and it shows that @xmath199 grows very large when @xmath375 is close to @xmath376 .",
    "this is expected , since @xmath381 has two poles , given by @xmath382 on the regularity ellipse @xmath383 .",
    "it is clear from figures [ fig1 ] and [ fig2 ] that @xmath384 is the best choice among the three proposed values , if one is interested in determining a bandwidth outside of which the entries of @xmath385 can be safely neglected .",
    "as already observed in @xcite , improved bounds can be obtained by adaptively choosing different ( typically increasing ) values of @xmath375 as @xmath147 grows , and by using as a bound the ( lower ) envelope of the curves plotted in figure [ fig5 ] , which shows the behavior of the decay bounds for several values of @xmath386 , with @xmath387 .     as a function of @xmath375 with @xmath191 and @xmath374.,scaledwidth=100.0% ]     and @xmath374 , for several values of @xmath375 . ]",
    "the results of theorem [ thm1 ] can be generalized to the case of hamiltonians with rather general sparsity patterns ; see @xcite . to this end",
    ", we make use of the notion of geodetic distance in a graph already used in section [ trunc ] . the following result holds .",
    "[ thm2 ] consider a sequence of matrices @xmath150 such that :    * @xmath151 is an @xmath60 hermitian matrix for all @xmath0 ; * the spectra @xmath388 are uniformly bounded and contained in @xmath164 $ ] for all @xmath0 .",
    "let @xmath217 be the graph distance associated with @xmath151 .",
    "then the following decay bound holds : @xmath356_{ij}|\\leq c\\ , { \\rm e}^{-\\theta d_n(i , j)},\\qquad   i\\neq j,\\label{generalbound}\\ ] ] where @xmath389 and the remaining notation and choice of constants are as in theorem [ thm1 ] .",
    "we remark that in order for the bound ( [ generalbound ] ) to be meaningful from the point of view of linear scaling , we need to impose some restrictions on the asymptotic sparsity of the graph sequence @xmath219 . as discussed in section [ trunc ] , @xmath2 approximations of @xmath385 are possible if the graphs @xmath210 have maximum degree uniformly bounded with respect to @xmath0 .",
    "this guarantees that the distance @xmath217 grows unboundedly as @xmath147 does , at a rate independent of @xmath0 for @xmath3 .",
    "the previous results establish exponential decay bounds for the fermi  dirac function of general localized hamiltonians and thus for density matrices of arbitrary systems at positive electronic temperature . in this subsection",
    "we consider the case of gapped systems ( like insulators ) at zero temperature . in this case , as we know , the density matrix is the spectral projector onto the occupied subspace . as an example , we consider the density matrix corresponding to the linear alkane n - dopentacontane @xmath390 composed of 52 carbon and 106 hydrogen atoms , discretized in a gaussian - type orbital basis .",
    "the number of occupied states is 209 , or half the total number of electrons in the system . ; see , e.g. , @xcite . ]",
    "the corresponding hamiltonian in the original non - orthogonal basis is displayed in fig .",
    "[ fig_h_jacek ] ( top ) and the ` orthogonalized ' hamiltonian @xmath391 is shown in fig .",
    "[ fig_h_jacek ] ( bottom ) . fig .",
    "[ fig_projector_jacek ] displays the zero temperature density matrix , which is seen to decay exponentially away from the main diagonal . comparing fig .",
    "[ fig_projector_jacek ] and fig .",
    "[ fig_h_jacek ] , we can see that for a truncation level of @xmath392 , the bandwidth of the density matrix is only slightly larger than that of the hamiltonian . the eigenvalue spectrum of the hamiltonian , scaled and shifted so that its spectrum is contained in the interval @xmath164 $ ] ,",
    "is shown in fig .",
    "[ spectrum_jacek ] .",
    "one can clearly see a large gap ( @xmath393 ) between the 52 low - lying eigenvalues corresponding to the core electrons in the system , as well as the smaller homo - lumo gap ( @xmath394 ) separating the 209 occupied states from the virtual ( unoccupied ) ones .",
    "it is worth emphasizing that the exponential decay of the density matrix is independent of the size of the system ; that is , if the alkane chain was made arbitrarily long by adding c and h atoms to it , the density matrix would be of course much larger in size but the bandwidth would remain virtually unchanged for the same truncation level , due to the fact that the bandwidth and the homo - lumo gap of the hamiltonian do not appreciably change as the number of particles increases .",
    "it is precisely this independence of the rate of decay ( hence , of the bandwidth ) on system size that makes @xmath2 approximations possible ( and competitive ) for large @xmath0 .",
    "let us now see how theorem [ thm1 ] can be used to prove decay bounds on the entries of density matrices . let @xmath51 be the discrete hamiltonian associated with a certain physical system and let @xmath85 be the fermi level of interest for this system .",
    "we assume that the spectrum of @xmath51 has a gap @xmath92 around @xmath85 , that is , we have @xmath395 , where @xmath396 is the smallest eigenvalue of @xmath51 to the right of @xmath85 and @xmath397 is the largest eigenvalue of @xmath51 to the left of @xmath85 . in the particular case of the homo - lumo gap ,",
    "we have @xmath398 and @xmath399 .     chain , with 209 occupied states .",
    "white : @xmath400 ; yellow : @xmath401 ; green : @xmath402 ; blue : @xmath403 ; black : @xmath404 .",
    "note : nz refers to the number of ` black ' entries.,scaledwidth=65.0% ]    .,scaledwidth=95.0% ]    the fermi ",
    "dirac function can be used to approximate the heaviside function ; the larger is @xmath93 , the better the approximation . more precisely , the following result is easy to prove ( see @xcite ) :    [ prop1 ] let @xmath405 be given .",
    "if @xmath93 is such that @xmath406 then @xmath407 and @xmath408 .    ) for different values of @xmath92 and @xmath409.,scaledwidth=95.0% ]     as a function of @xmath92 , for different values of @xmath410.,scaledwidth=95.0% ]    in fig .  [ fd ] we show fermi  dirac approximations to the heaviside function ( with a jump at @xmath191 ) for different values of @xmath92 between @xmath411 and @xmath69 , where @xmath93 has been chosen so as to reduce the error in proposition [ prop1 ] above the value @xmath409 .",
    "the behavior of @xmath93 as a function of @xmath92 according to is plotted in fig .",
    "[ betagamma ] .    as a consequence of theorem [ thm1 ] and proposition [ prop1 ] we have :    [ cor1 ]",
    "let @xmath48 be a fixed positive integer and @xmath152 , where the integers @xmath4 form a monotonically increasing sequence .",
    "let @xmath150 be a sequence of hermitian @xmath60 matrices with the following properties :    1 .",
    "each @xmath151 has bandwidth @xmath66 independent of @xmath0 ; 2 .",
    "there exist two fixed intervals @xmath412 ,   i_2=[b,1]\\subset\\mathbb{r}$ ] with @xmath413 , such that for all @xmath152 , @xmath414 contains the smallest @xmath4 eigenvalues of @xmath151 ( counted with their multiplicities ) and @xmath415 contains the remaining @xmath416 eigenvalues .",
    "let @xmath248 denote the @xmath60 spectral projector onto the subspace spanned by the eigenvectors associated with the @xmath4 smallest eigenvalues of @xmath151 , for each @xmath0 .",
    "let @xmath405 be arbitrary . then there exist constants @xmath417 independent of @xmath0 such that @xmath418_{ij}|\\leq \\min\\left \\{1,c\\ , { \\rm e}^{-\\alpha |i - j|}\\right \\}+\\delta ,   \\qquad { \\rm for \\,\\ , all } \\quad i\\neq j.\\label{bound_band}\\ ] ] the constants @xmath199 and @xmath130 can be computed from and , where @xmath375 is chosen in the interval @xmath419 , with @xmath376 given by and @xmath93 such that holds .",
    "corollary [ cor1 ] allows us to determine _ a priori _ a bandwidth @xmath183 independent of @xmath0 outside of which the entries of @xmath248 are smaller than a prescribed tolerance @xmath420 .",
    "observe that it is not possible to incorporate @xmath410 in the exponential bound , but , at least in principle , one may always choose @xmath410 smaller than a certain threshold .",
    "for instance , one may take @xmath421 and define @xmath422 as the smallest integer value of @xmath66 such that the relation @xmath423 holds",
    ".    in the case of hamiltonians with a general sparsity pattern one may apply theorem [ thm2 ] to obtain a more general version of corollary [ cor1 ] . if the fixed bandwidth hypothesis is removed , the following bound holds : @xmath418_{ij}|\\leq   \\min\\left \\{1 , c\\ , { \\rm e}^{-\\theta d_n(i , j)}\\right \\}+\\delta ,   \\qquad { \\rm for \\,\\ , all}\\quad   i\\neq j,\\label{bound_general}\\ ] ] with @xmath389 . once again , for the result to be meaningful some restriction on the sparsity patterns , like the uniformly bounded maximum degree assumption already discussed , must be imposed .",
    "theorem [ thm1 ] is a consequence of results proved in @xcite ( thm .",
    "2.2 ) and @xcite ( thm .",
    "2.2 ) ; its proof relies on a fundamental result in polynomial approximation theory known as bernstein s theorem @xcite . given a function @xmath424 continuous on @xmath164 $ ] and a positive integer @xmath425 ,",
    "the @xmath425th best approximation error for @xmath424 is the quantity @xmath426 where @xmath427 is the set of all polynomials with real coefficients and degree less than or equal to @xmath425 .",
    "bernstein s theorem describes the asymptotic behavior of the best approximation error for a function @xmath424 analytic on a domain containing the interval @xmath164 $ ] .    consider the family of ellipses in the complex plane with foci in @xmath361 and @xmath69 .",
    "as already mentioned , an ellipse in this family is completely determined by the sum @xmath428 of its half - axes and will be denoted as @xmath429 .",
    "[ bern ] [ bernstein ] let the function @xmath424 be analytic in the interior of the ellipse @xmath429 and continuous on @xmath429 .",
    "moreover , assume that @xmath430 is real for real @xmath431 .",
    "then @xmath432 where @xmath433 .",
    "let us now consider the special case where @xmath434 is the fermi  dirac function of parameters @xmath93 and @xmath85 .",
    "observe that @xmath381 has poles in @xmath435 , so the admissible values for @xmath375 with respect to @xmath381 are given by @xmath358 , where the parameter @xmath376 is such that @xmath436 ( the _ regularity ellipse _ for @xmath437 ) . also observe that smaller values of @xmath93 correspond to a greater distance between the poles of @xmath381 and the real axis , which in turn yields a larger value of @xmath438 .",
    "in other words , the smaller @xmath93 , the faster the decay in theorem [ thm1 ] .",
    "explicit computation of @xmath376 yields .",
    "now , let @xmath151 be as in theorem [ thm1 ] .",
    "we have @xmath439 where @xmath440 and @xmath441 .",
    "the bernstein approximation of degree @xmath425 gives a bound on @xmath442_{ij}|$ ] when @xmath443_{ij}=0 $ ] , that is , when @xmath444 .",
    "we may also assume @xmath445 .",
    "therefore , we have @xmath446_{ij}|\\leq c\\ , { \\rm e}^{m(k+1)\\ln(q^{1/m})}= c\\ , { \\rm e}^{-\\alpha m(k+1)}\\leq c\\ , { \\rm e}^{-\\alpha |i - j|}.\\ ] ]    as for theorem [ thm2 ] , note that for a general sparsity pattern we have @xmath447_{ij}=0 $ ] , and therefore @xmath443_{ij}=0",
    "$ ] , whenever @xmath448 .",
    "writing @xmath449 we obtain @xmath446_{ij}|\\leq c\\ , ( 1/\\chi)^{k+1}=c\\ , { \\rm e}^{-\\theta d_n(ij)}.\\ ] ]    let us now prove corollary [ cor1 ] .",
    "assume that @xmath93 satisfies the inequality for given values of @xmath410 and @xmath92 . if we approximate the heaviside function with step at @xmath85 by means of the fermi ",
    "dirac function @xmath450 , the pointwise approximation error is given by @xmath451 for @xmath452 and by @xmath140 for @xmath453 .",
    "it is easily seen that @xmath454 is a monotonically increasing function , whereas @xmath95 is monotonically decreasing . as a consequence , for each hamiltonian",
    "@xmath151 we have that @xmath455 for all eigenvalues @xmath456 and @xmath457 for all @xmath458 .",
    "in other words , the pointwise approximation error on the spectrum of @xmath151 is always bounded by @xmath410 .",
    "therefore , we have @xmath459_{ij}|\\leq \\|p_n - f_{fd}(h_n)\\|_2\\leq\\delta .\\ ] ] we may then conclude using theorem [ thm1 ] : @xmath418_{ij}|\\leq |[f_{fd}(h_n)]_{ij}|+",
    "\\delta\\leq c\\ , { \\rm e}^{-\\alpha|i - j|}+\\delta .\\ ] ] finally , recall that in an orthogonal projector no entry can exceed unity in absolute value . with this in mind , ( [ bound_band ] ) and ( [ bound_general ] ) readily follow .",
    "theorems [ thm1 ] and [ thm2 ] rely on bernstein s result on best polynomial approximation .",
    "following the same argument , one may derive decay bounds for the density matrix from any other estimate on the best polynomial approximation error for classes of functions that include the fermi  dirac function .",
    "for instance , consider the following result of achieser ( see ( * ? ? ?",
    "78 ) , and @xcite ) :    [ thm_achieser ] let the function @xmath424 be analytic in the interior of the ellipse @xmath429 .",
    "suppose that @xmath460 holds in @xmath429 and that @xmath430 is real for real @xmath431 .",
    "then the following bound holds : @xmath461    the series in converges quite fast ; therefore , it suffices to compute a few terms explicitly to obtain a good approximation of the bound .",
    "a rough estimate shows that , in order to approximate the right hand side of within a tolerance @xmath462 , one may truncate the series after @xmath463 terms , where @xmath464 and @xmath465 .",
    "observe that , as in bernstein s results , there is again a degree of arbitrariness in the choice of @xmath375 .",
    "however , the admissible range for @xmath375 is smaller here because of the hypothesis @xmath466 .",
    "the resulting matrix decay bounds have the form @xmath467 for the case of general sparsity patterns . while these bounds are less transparent than those derived from bernstein s theorem , they are computable .",
    "we found that the bounds ( [ bound_achies ] ) improve on for entries close to the main diagonal , but do not seem to have a better asymptotic behavior .",
    "a possibility would be to combine the two bounds by taking the smaller between the two values .",
    "so far we have only considered bounds based on best approximation of analytic functions defined on a single interval . in @xcite",
    ", hasson has obtained an interesting result on polynomial approximation of a step function defined on the union of two symmetric intervals .",
    "let @xmath468 with @xmath469 and let @xmath470 be the sign function defined on @xmath471\\cup [ a , b]$ ] , i.e. , @xmath472 on @xmath471 $ ] and @xmath473 on @xmath368 $ ] .",
    "notice that the sign function is closely related to the heaviside function @xmath474 , since we have @xmath475 .",
    "there exists a positive constant @xmath263 such that @xmath476\\cup [ a , b])\\leq   k\\frac{\\big(\\sqrt{\\frac{b - a}{b+a}}\\,\\big)^k}{\\sqrt{k}}.\\label{hasson_bound}\\ ] ]    given a sequence of hamiltonians @xmath150 with gapped spectra , one may choose @xmath372 and @xmath373 and shift @xmath151 , if necessary , so that the spectrum of each @xmath151 is contained in @xmath471\\cup [ a , b]$ ] and the eigenvalues corresponding to occupied states belong to @xmath471 $ ] .",
    "then we obtain the following decay bound for the density matrix : @xmath477_{ij}\\right |\\leq   k\\frac{{\\rm e}^{-\\xi d(i , j)}}{2\\sqrt{d(i , j)}},\\qquad { \\rm where } \\quad \\xi=\\frac{1}{2}\\ln\\frac{b+a}{b - a}\\,.\\ ] ] under the bounded maximal degree condition , the rate of decay is independent of @xmath0 .",
    "a few remarks on are in order :    * since relies directly on a polynomial approximation of the step function , we do not need here the extra term @xmath410 found in .",
    "* unfortunately , it is not possible to assess whether may be useful in practice without an explicit formula  or at least an estimate  for the constant @xmath263 . the asymptotic decay rate , however , is faster than exponential and indeed faster than for other bounds ; a comparison is shown in fig .",
    "[ fig_hasson ] ( top ) .",
    "notice that this logarithmic plot is only meant to show the slope of the bound ( which is computed for @xmath478 ) . *",
    "a disadvantage of is the requirement that the intervals containing the spectra @xmath388 should be symmetric with respect to @xmath479 .",
    "of course one may always choose @xmath372 and @xmath373 so that this hypothesis is satisfied , but the quality of the decay bound deteriorates if @xmath373 ( or @xmath480 ) is not close to the maximum ( resp . , minimum ) eigenvalue ; see fig .",
    "[ fig_hasson ] ( bottom ) .",
    "the blue curve shows the slope of the decay bound for @xmath481 and @xmath482 , in a logarithmic scale . in green",
    "we display the behavior of the first row of the density matrix associated with a tridiagonal @xmath483 matrix with spectrum in @xmath484\\cup [ 0.25,1]$ ] .",
    "the red plot refers to the first row of the density matrix associated with a matrix with spectrum in @xmath485\\cup [ 0.25,1]$ ] .",
    "the first matrix is clearly better approximated by the decay bound than the second one .",
    "tridiagonal matrix with spectrum in @xmath484\\cup [ 0.25,1]$ ] .",
    "the first row of the exact   density matrix is plotted in red .",
    "bottom : logarithmic plot of hasson decay bounds ( blue ) and first rows of density matrices associated with matrices with different eigenvalue distributions ( red and green).,scaledwidth=85.0% ]     tridiagonal matrix with spectrum in @xmath484\\cup [ 0.25,1]$ ] .",
    "the first row of the exact   density matrix is plotted in red .",
    "bottom : logarithmic plot of hasson decay bounds ( blue ) and first rows of density matrices associated with matrices with different eigenvalue distributions ( red and green).,scaledwidth=85.0% ]    as one can see from the two plots in fig .",
    "[ fig_hasson ] , even for @xmath486 both types of decay bounds are rather conservative , and estimating the truncation bandwidth @xmath183 needed to achieve a prescribed error from these bounds would lead to an overly large band . hence , the bounds may not be very useful in practice .",
    "for further discussion of these issues , see section [ pract ] .",
    "let us assume again that we have a sequence @xmath150 of hermitian @xmath60 hamiltonians ( with @xmath152 , @xmath48 fixed , @xmath155 ) such that    * the matrices @xmath151 are banded with uniformly bounded bandwidth , or sparse with graphs having uniformly bounded maximum degree ; * the spectra @xmath388 are uniformly bounded ; * the sequence @xmath150 has a stable  spectral gap , i.e. , there exist real numbers @xmath487 such that @xmath488\\cap\\sigma(h_n)=\\emptyset$ ] for sufficiently large @xmath0 .",
    "in this subsection we let    * @xmath489 ( fermi level ) , * @xmath490 ( absolute spectral gap ) .",
    "note that because of the uniformly bounded spectra assumption , the absolute spectral gap is within a constant of the relative gap previously defined .",
    "chui and hasson study in @xcite the asymptotic behavior of the error of best polynomial approximation for a sufficiently smooth function @xmath424 defined on the set @xmath491\\cup [ a , b]$ ] , with @xmath469 .",
    "denote as @xmath492 the space of real - valued continuous functions on @xmath493 , with the uniform convergence norm .",
    "then we have ( see ( * ? ? ?",
    "* thm .  1 ) and",
    "@xcite ) :    [ chtheorem ] let @xmath494 be such that @xmath495}$ ] is the restriction of a function @xmath496 analytic on the left half plane @xmath497 and @xmath498}$ ] is the restriction of a function @xmath499 analytic on the right half plane @xmath500 . then @xmath501^{1/k}\\leq\\sqrt{\\frac{b - a}{b+a}},\\ ] ] where @xmath502 is the error of best polynomial approximation for @xmath424 on @xmath493 .",
    "the authors of @xcite observe that the above result can not be obtained by extending @xmath276 to a continuous function on @xmath503 $ ] and applying known bounds for polynomial approximation over a single interval .",
    "theorem [ chtheorem ] looks potentially useful for our purposes , except that it provides an asymptotic result , rather than an explicit bound for each value of @xmath425 .",
    "therefore , we need to reformulate the argument in @xcite . to this end , we prove a variant of bernstein s theorem ( cf .",
    "theorem [ bern ] ) adapted to our goals . instead of working on the interval",
    "@xmath164 $ ] we want to bound the approximation error on the interval @xmath504 $ ] .",
    "[ cor2 ] let @xmath505)$ ] be the restriction of a function @xmath424 analytic in the interior of the ellipse @xmath506 with foci in @xmath507 and a vertex at the origin .",
    "then , for all @xmath508 with @xmath509 there exists a constant @xmath263 such that @xmath510)\\leq k\\left ( \\frac{1}{\\xi } \\right)^k.\\ ] ]    the proof closely parallels the argument given in @xcite for the proof of theorem [ bern ] .",
    "first of all , observe that the ellipse @xmath429 in bernstein s theorem has foci in @xmath511 and vertices in @xmath512 and @xmath513 .",
    "the parameter @xmath375 is the sum of the lengths of the semiaxes .",
    "similarly , the ellipse @xmath506 has foci in @xmath507 and vertices in @xmath479 , @xmath514 and @xmath515 .",
    "also observe that @xmath516 is the sum of the lengths of the semiaxes of @xmath506 , normalized w.r.t . the semifocal length , so that it plays exactly the same role as @xmath375 for @xmath429 .",
    "now we look for a conformal map that sends an annulus in the complex plane to the ellipse where @xmath424 is analytic . when this ellipse is @xmath429 , a suitable map is @xmath517 , which sends the annulus @xmath518 to @xmath429 .",
    "when the desired ellipse has foci in @xmath519 , we compose @xmath520 with the change of variable @xmath521 thus obtaining a function that maps the annulus @xmath522 to an ellipse . denote this ellipse as @xmath523 and observe that it is contained in the interior of @xmath506 .",
    "therefore we have that the function @xmath524\\frac{b^2-a^2}{2 } \\right ) \\ ] ] is analytic on @xmath525 and continuous on @xmath526 .",
    "the proof now proceeds as in the original bernstein theorem .",
    "the laurent expansion @xmath527 converges in @xmath525 with @xmath528 .",
    "moreover , we have the bound @xmath529 where @xmath530 is the maximum value ( in modulus ) taken by @xmath424 on the ellipse @xmath523 .",
    "now observe that @xmath531 describes the real interval @xmath164 $ ] for @xmath532 , so for @xmath533 $ ] we have @xmath534 where @xmath535 is the @xmath536-th chebyshev polynomial .",
    "since @xmath537 is a linear transformation , we have @xmath538)=e_k(f(u),[-1,1])$ ] , so from the theory of chebyshev approximation @xcite we obtain @xmath510)=e_k(f(u),[-1,1])\\leq 2m(\\xi ) \\sum_{\\nu = k+1}^{\\infty}\\xi ^{-\\nu}=\\frac{2m(\\xi)}{\\xi-1}\\xi ^{-k},\\ ] ] hence the thesis .",
    "note that the explicit value of @xmath263 is computable .",
    "the following result is based on ( * ? ? ?",
    "* thm .  1 ) .",
    "[ thm3 ] let @xmath494 be as in theorem [ chtheorem ] .",
    "then , for all @xmath508 with @xmath509 there exists @xmath539 independent of @xmath425 such that @xmath540    let @xmath427 and @xmath541 be polynomials of best uniform approximation of degree @xmath425 on the interval @xmath504 $ ] for the functions @xmath542 and @xmath543 , respectively .",
    "then by theorem [ cor2 ] there are constants @xmath544 and @xmath545 such that @xmath546 } |p_k(x)-f_2(\\sqrt{x})| \\leq k_1\\xi^{-k}\\label{approx1}\\ ] ] and @xmath546}|q_k(x)-f_2(\\sqrt{x})/\\sqrt{x}| \\leq k_2\\xi^{-k}.\\label{approx2}\\ ] ] we use the polynomials @xmath427 and @xmath541 to define a third polynomial @xmath547/2 $ ] , of degree @xmath548 , which approximates @xmath276 on @xmath368 $ ] and has small norm on @xmath471 $ ] . indeed , from and we have : @xmath549}|r_{2k+1}(x)-f(x)| & \\leq\\frac{1}{2}\\max_{x\\in [ a , b]}|p_k(x^2)-f(x)|+ \\frac{1}{2}\\max_{x\\in [ a , b]}|xq_k(x^2)-f(x)|\\\\ & \\leq\\frac{1}{2}k_1\\xi^{-k } + \\frac{1}{2}bk_2\\xi^{-k } = \\frac{k_1 + bk_2}{2}\\xi^{-k } \\end{split}\\ ] ] and @xmath550 } |r_{2k+1}(x)|\\leq\\frac{1}{2 } \\max_{x\\in [ a , b]}|p_k(x^2)-f(x)+ f(x)-xq_k(x^2)|\\\\ \\hspace{-.2 in } \\leq\\frac{1}{2}\\max_{x\\in [ a , b]}|p_k(x^2)-f(x)|+ \\frac{1}{2}\\max_{x\\in [ a , b]}|xq_k(x^2)-f(x)| \\leq\\frac{k_1 + bk_2}{2}\\xi^{-k}.\\end{aligned}\\ ] ] similarly , we can find another polynomial @xmath551 such that @xmath552 } |s_{2k+1}(x)-f(x)|\\leq\\frac{k_3 + bk_4}{2}\\xi^{-k}\\ ] ] and @xmath553}|s_{2k+1}(x)|\\leq\\frac{k_3 + bk_4}{2}\\xi^{-k}.\\label{lastdis}\\ ] ] then , from the inequalities - we have @xmath554}|r_{2k+1}(x)-f(x)| + \\max_{x\\in [ a , b]}|s_{2k+1}(x)|\\\\ + \\max_{x\\in [ -b ,- a]}|s_{2k+1}(x)-f(x)|+\\max_{x\\in [ -b ,-",
    "a]}|r_{2k+1}(x)|\\\\ \\leq ( k_1+k_3+b(k_2+k_4))\\xi^{-k}\\,,\\end{aligned}\\ ] ] and therefore @xmath555 for odd values of @xmath425 , and @xmath556 for even values of @xmath425 .",
    "this completes the proof .    in the following we assume , without loss of generality , that @xmath425 is odd . in order to obtain bounds on the density matrix",
    ", we apply theorem [ thm3 ] to the step function @xmath424 defined on @xmath493 as follows : @xmath557 i.e. , @xmath424 is the restriction of @xmath558 on @xmath471 $ ] and the restriction of @xmath559 on @xmath368 $ ] . here",
    "the polynomial approximation of @xmath542 , @xmath543 and @xmath560 is exact , so we have @xmath561 . as for @xmath562 , observe that @xmath563 achieves its maximum on the vertex of @xmath523 with smallest abscissa ; therefore we have @xmath564 where @xmath565\\frac{b^2-a^2}{2}.\\ ] ] moreover , we find @xmath566 and @xmath567 , where @xmath568 is the polynomial of best uniform approximation for @xmath569 on @xmath504 $ ] .",
    "thus , we obtain the bound @xmath570 where @xmath65 is given by @xmath571    let us now apply this result to our sequence of hamiltonians .",
    "we will assume that the matrices are shifted so that @xmath191 , that is , we replace each @xmath151 by @xmath572 . under this hypothesis ,",
    "the natural choice for @xmath372 is @xmath573 , whereas @xmath373 is the smallest number such that @xmath574\\cup [ a , b]$ ] for every @xmath0 .    using the same argument used in section [ proofs ] for the derivation of matrix decay bounds",
    "( see also @xcite and @xcite ) , we can obtain bounds on the off - diagonal entries of @xmath575 .",
    "if @xmath151 is banded with bandwidth @xmath66 independent of @xmath0 , we have @xmath576_{ij } \\right |=|[f(h_n)]_{ij}|\\leq\\sqrt{\\xi}\\ , \\frac{2m(\\xi)}{\\xi-1}\\,b\\ , \\xi ^{-\\frac{|i - j|}{2m}},\\label{bound3}\\ ] ] whereas if @xmath151 has a more general sparsity pattern we obtain @xmath576_{ij } \\right |=|[f(h_n)]_{ij}|\\leq\\sqrt{\\xi}\\ , \\frac{2m(\\xi)}{\\xi-1}\\,b\\ , \\xi ^{-\\frac{d_n(i , j)}{2}},\\label{bound2}\\ ] ] where @xmath217 is the distance between nodes @xmath30 and @xmath208 in the graph @xmath210 associated with @xmath151 .",
    "next , we compare the bounds derived in this section with those for the fermi  dirac approximation of the step function obtained in section [ sec_fd ] , using a suitable choice of the inverse temperature @xmath93 . recall that if @xmath429 denotes the regularity ellipse for the fermi  dirac function , the earlier bounds for the banded case are : @xmath576_{ij } \\right |\\leq\\frac{2m(\\chi)}{\\chi-1 } \\left(\\frac{1}{\\chi}\\right)^{\\frac{|i - j|}{m}}.\\label{oldbound}\\ ] ] for ease of computation , we assume in this section that @xmath191 and that the spectrum of each matrix @xmath151 is contained in @xmath164 $ ] . as explained in section [ sec_fd ] , once @xmath92 is known , we pick a tolerance @xmath410 and compute @xmath93 so that the fermi  dirac function provides a uniform approximation of the step function with error @xmath577 outside the gap : @xmath578 then the supremum of the set of admissible values of @xmath375 , which ensures optimal asymptotic decay in this framework , is @xmath579     and @xmath580 for several values of the spectral gap . here @xmath581.,scaledwidth=70.0% ]     and @xmath580 w.r.t .",
    "several values of the spectral gap . here",
    "@xmath581.,scaledwidth=70.0% ]    figures [ chi_xi_1 ] and [ chi_xi_2 ] compare the values of @xmath582 and @xmath580 ( which characterize the behavior of the bounds and , respectively ) .",
    "note that in general we find @xmath583 ; this means that the asymptotic decay rate is higher for the bound based on disjoint interval approximation .",
    "moreover , the disjoint interval method directly approximates the step function and therefore does not require one to choose a tolerance for intermediate   approximation . as a result , the bounds based on disjoint interval approximation prescribe a smaller truncation bandwidth @xmath183 in the approximation to the spectral projector in order to achieve a given level of error . for instance , in the tridiagonal case ( @xmath378 ) we observed a factor of three reduction in @xmath183 compared to the previous bounds , independent of the size of the gap .",
    "as already mentioned in section [ related ] , the functional dependence of the decay length ( governing the rate of decay in the density matrix ) on the spectral gap has been the subject of some discussion ; see , for instance , @xcite .",
    "some of these authors have argued that the decay length decreases like the square root of the gap if the fermi level is located near one of the gap edges ( i.e. , close to either @xmath584 or to @xmath585 ) , and like the gap itself if the fermi level falls in the middle of the gap .",
    "these estimates hold for the small gap limit .    in this section",
    "we address this problem by studying how the decay described by the bounds and behaves asymptotically with respect to @xmath92 or , equivalently , with respect to @xmath372 ( see the notation introduced in the previous section ) .",
    "note that we are assuming here that the fermi level falls exactly in the middle of the gap .",
    "let us rewrite in the form @xmath418_{ij}|\\leq",
    "c{\\rm e}^{-\\alpha |i - j|/m},\\ ] ] where @xmath586 for a fixed @xmath66 , the decay behavior is essentially described by the parameter @xmath130 .",
    "let us assume for simplicity of notation that @xmath482 , so that the spectral gap is normalized and the expression for @xmath130 becomes @xmath587 the taylor expansion of @xmath130 for @xmath372 small yields @xmath588 therefore , for small values of @xmath92 , the decay behavior is described at first order by the gap itself , rather than by a more complicated function of @xmath92 .",
    "this result is consistent with similar ones found in the literature @xcite .",
    "the fact that some systems exhibit density matrix decay lengths proportional to the square root of the gap ( see , e.g. , @xcite ) does not contradict our result : since we are dealing here with upper bounds a square root - dependence , which corresponds to faster decay for small @xmath372 , is still consistent with our bounds . given that our bounds are completely general",
    ", it does not come as a surprise that we obtain the more conservative estimate among the alternatives discussed in the literature .",
    "another issue that has stirred some controversy in the literature concerns the precise rate of decay in the density matrix in metals at positive temperature ; see , e.g. , the results and discussion in @xcite . recall that in metals at positive temperatures @xmath99 , the density matrix @xmath589 decays exponentially .",
    "the question is whether the decay length is proportional to @xmath99 or to @xmath139 , for small @xmath99 .",
    "our approach shows that the decay length is proportional to @xmath99 .    indeed , from the analysis in section [ sec_fd ] , in particular theorems [ thm1 ] and [ thm2 ]",
    ", we find that the decay length @xmath130 in the exponential decay bound ( [ bound ] ) ( or , more generally , the decay length @xmath590 in the bound ( [ generalbound ] ) ) behaves like @xmath591 , where  assuming for simplicity that @xmath592 , as before ",
    "the parameter @xmath375 is any number satisfying @xmath593    letting @xmath594 and observing that for small @xmath121 @xmath595 we conclude that , at low temperatures , the decay length is proportional to @xmath596 .",
    "this conclusion is in complete agreement with the results in @xcite . to the best of our knowledge ,",
    "this is the first time this result has been established in a fully rigorous and completely general manner .",
    "decay bounds on the entries of spectral projectors can also be obtained from the contour integral representation @xmath597 where @xmath117 is a simple closed curve ( counterclockwise oriented ) in @xmath118 surrounding a portion of the real axis containing the eigenvalues of @xmath151 which correspond to the occupied states and only those .",
    "componentwise , ( [ cauchy2 ] ) becomes @xmath598_{ij}=\\frac{1}{2\\pi { { \\rm i}}}\\int_\\gamma \\left [ ( zi_n - h_n)^{-1 } \\right ] _ { ij } dz\\ , , \\quad 1\\le i , j\\le n,\\ ] ] from which we obtain @xmath576_{ij}\\right | \\le   \\frac{1}{2\\pi}\\int_\\gamma | \\left [ ( zi_n - h_n)^{-1 } \\right ] _ { ij } |\\ , dz\\ , , \\quad 1\\le i ,",
    "j\\le n.\\ ] ] assume the matrices @xmath151 are banded , with uniformly bounded spectra and bandwidths as @xmath3 . by ( * ? ? ?",
    "2.3 ) there exist , for all @xmath599 , explicitly computable constants @xmath600 and @xmath601 ( independent of @xmath0 ) such that @xmath602_{ij}\\big| \\leq c(z ) [ \\lambda(z)]^{|i - j|},\\end{aligned}\\]]for all @xmath603 .",
    "moreover , @xmath199 and @xmath604 depend continuously on @xmath599 . since @xmath117 is compact we can set @xmath605",
    "now let us assume that the matrices @xmath151 have spectral gaps @xmath606 satisfying @xmath161 .",
    "it is then clear that @xmath199 is finite and that @xmath607 .",
    "hence , we obtain the following bound : @xmath608_{ij}\\right |",
    "\\leq \\left(c \\cdot \\frac{\\ell(\\gamma)}{2\\pi } \\right ) \\lambda^{|i - j|},\\end{aligned}\\]]for all @xmath603 , where @xmath609 denotes the length of @xmath117 .",
    "finally , letting @xmath610 and @xmath611 we obtain the exponential decay bounds @xmath612_{ij}\\right | \\le c\\cdot { \\rm e}^{-\\alpha |i - j| } , \\quad 1\\le i , j\\le n,\\ ] ] with both @xmath539 and @xmath613 independent of @xmath0 . as usual , the bounds can be easily extended to the case of general sparsity patterns .",
    "one disadvantage of this approach is that explicit evaluation of the constants @xmath65 and @xmath130 is rather complicated .",
    "the integral representation ( [ cauchy2 ] ) is useful not only as a theoretical tool , but also increasingly as a computational tool .",
    "indeed , quadrature rules with suitably chosen nodes @xmath614 can be used to approximate the integral in ( [ cauchy2 ] ) , leading to @xmath615 for suitable quadrature weights @xmath616 . note that this amounts to a rational approximation of @xmath617 . in practice , using the trapezoidal rule with a small number of nodes suffices to achieve high accuracy , due to the exponential convergence of this quadrature rule for analytic functions @xcite .",
    "note that if @xmath248 is real then it is sufficient to use just the @xmath618 in the upper half - plane and then take the real part of the result @xcite . if the spectral gap @xmath606 for @xmath151 is not too small , all the resolvents @xmath619 decay rapidly away from the main diagonal , with exponential rate independent of @xmath4 . hence , @xmath2 approximation is possible , at least in principle .",
    "rational approximations of the type ( [ rational ] ) are especially useful in those situations where only selected entries of @xmath248 are required .",
    "then only the corresponding entries of the resolvents @xmath619 need to be computed .",
    "for instance , in some cases only the diagonal entries of @xmath248 are needed @xcite . in others , only entries in positions corresponding to the non - zero entries in the hamiltonian @xmath151",
    "must be computed ; this is the case , for instance , when computing the objective function @xmath620 in density matrix minimization algorithms .",
    "computing selected entries of a resolvent is not an easy problem .",
    "however , progress has been made on this front in several recent papers ; see , e.g. , @xcite .      in the preceding sections",
    "we have rigorously established exponential decay bounds for zero - temperature density matrices corresponding to finite - range hamiltonians with non - vanishing spectral gap ( ` insulators ' ) , as well as for density matrices corresponding to arbitrary finite - range hamiltonians at positive electronic temperatures .",
    "our results are very general and apply to a wide variety of physical systems and discretizations .",
    "hence , a mathematical justification of the physical phenomenon of ` nearsightedness ' has been obtained , and the possibility of @xmath2 methods firmly established .",
    "having thus achieved our main purpose , the question remains whether our estimates can be of practical use in the design of @xmath2 algorithms .",
    "as shown in section [ trunc ] , having estimated the rate of decay in the density matrix @xmath61 allows one to prescribe _ a priori _ a sparsity pattern for the computed approximation @xmath621 to @xmath61 .",
    "having estimated an ` envelope ' for the non - negligible entries in @xmath61 means that one can estimate beforehand the storage requirements and set up static data structures for the computation of the approximate density matrix @xmath621 .",
    "an added advantage is the possibility of using the prescribed sparsity pattern to develop efficient parallel algorithms ; it is well known that adaptive computations , in which the sparsity pattern is determined ` on the fly ' , may lead to load imbalances and loss of parallel efficiency due to the need for large amounts of communication and unpredictable memory accesses .",
    "this is completely analogous to prescribing a sparsity pattern vs.  using an adaptive one when computing sparse approximate inverses for use as preconditioners when solving linear systems , see @xcite .",
    "most of the @xmath2 algorithms currently in use consist of iterative schemes producing increasingly accurate approximations to the density matrix .",
    "these approximations may correspond to successive terms in an expansion of @xmath61 with respect to a prescribed basis @xcite , or they may be the result of a gradient or descent method in density matrix minimization approaches @xcite .",
    "closely related methods include _ purification _ and algorithms based on approximating the sign function @xcite ; we refer again to @xcite for recent surveys on the state of the art of linear scaling methods for electronic structure .",
    "most of these algorithms construct a sequence of approximations @xmath622 which , under appropriate conditions , converge to @xmath61 .",
    "each iterate is obtained from the preceding one by some matrix - matrix multiplication , or powering , scheme ; each step introduces new nonzeros ( fill - in ) , and the matrices @xmath623 become increasingly dense . the exponential decay property , however , implies that most of these nonzeros will be negligible , with only @xmath2 of them being above any prescribed threshold @xmath624 . clearly , knowing _ a priori _ the location of the non - negligible entries in @xmath61 can be used to drastically reduce the computational burden and to achieve linear scaling , since only those entries need to be computed .",
    "negligible entries that fall _ within _ the prescribed sparsity pattern may be removed using a drop tolerance ; this strategy further decreases storage and arithmetic complexity , but its implementation demands the use of dynamic data structures .",
    "an illustration of this use of the decay estimates can be found for instance in @xcite , where a chebyshev expansion of the fermi  dirac function @xmath625 was used to approximate the density matrix at finite temperatures . given a prescribed error tolerance ,",
    "exponential decay bounds were applied to the fermi  dirac function to determine the truncation bandwidth needed to satisfy the required approximation error . when computing the polynomial @xmath626 using the chebyshev expansion , only entries within the prescribed bandwidth were retained . combined with an estimate of the approximation error obtained by monitoring the magnitude of the coefficients in the chebyshev expansion , this approach worked well for some simple 1d model problems resulting in linear scaling computations .",
    "a related approach , based on qualitative decay estimates for the density matrix , was already used in @xcite .",
    "these authors present computational results for a variety of 1d and 2d systems including insulators at zero temperature and metals at finite temperature ; see further @xcite .",
    "unfortunately , the practical usefulness of our bounds for more realistic calculations is limited .",
    "the bounds are generally pessimistic and tend to be overly conservative , especially for the case of zero or low temperatures .",
    "this is to be expected , since the bounds were obtained by estimating the degree of a polynomial approximation to the fermi",
    " dirac matrix function needed to satisfy a prescribed error tolerance .",
    "these bounds tend to be rather pessimistic because they do not take into account the possibility of numerical cancellation when evaluating the matrix polynomial .",
    "for instance , the bounds must apply in the worst - case scenario where the hamiltonian has non - negative entries and the approximating polynomial has nonnegative coefficients .",
    "moreover , the bounds do not take into account the size of the entries in the hamiltonian , particularly the fact that the nonzeros within the band ( or sparsity pattern ) are not of uniform size but may be spread out over several orders of magnitude .",
    "it should be emphasized that the presence of a gap is only a sufficient condition for localization of the density matrix , not a necessary one : it has been pointed out , for example in @xcite , that disordered systems may exhibit strong localization even in the absence of a well - defined gap .",
    "this is the case , for instance , of the _ anderson model of localization _ in condensed matter physics @xcite .",
    "obviously , our approach is unable to account for such phenomena in the zero temperature case .",
    "the theory reviewed in this paper is primarily a qualitative one ; nevertheless , it captures many of the features of actual physical systems , like the asymptotic dependence of the decay rate on the gap size or on the electronic temperature .",
    "a natural question is whether the bounds can be improved to the point where they can be used to obtain practical estimates of the entries in the density matrix . in order to achieve this ,",
    "additional assumptions on the hamiltonians would be needed , making the theory less general . in other words ,",
    "the price we pay for the generality of our theory is that we get pessimistic bounds .",
    "recall that for a given sparsity pattern in the normalized hamiltonians @xmath151 our decay bounds depend on just one essential parameter , the gap @xmath92 .",
    "our bounds are the same no matter what the eigenvalue distribution is to the left of the highest occupied level , @xmath584 , and to the right to the lowest unoccupied one , @xmath585 .",
    "if more spectral information were at hand , the bounds could be improved .",
    "the situation is very similar to that arising in the derivation of error bounds for the convergence of krylov methods , such as the cg method for solving symmetric positive definite linear systems @xmath627 ; see , e.g. , ( * ? ? ?",
    "* theorem 10.2.6 ) .",
    "bounds based on the spectral condition number @xmath628 alone , while sharp , do not in general capture the actual convergence behavior of cg .",
    "they represent the worst - case behavior , which is rarley observed in practice .",
    "much more accurate bounds can be obtained by making assumptions on the distribution of the eigenvalues of @xmath179 .",
    "for instance , if @xmath179 has only @xmath425 distinct eigenvalues , then the cg method converges ( in exact arithmetic ) to the solution @xmath629 in at most @xmath425 steps . similarly , suppose the hamiltonian @xmath151 has only @xmath630 distinct eigenvalues ( with @xmath85 not one of them ) , and that the multiplicities of the eigenvalues to the left of @xmath85 add up to @xmath4 , the number of electrons .",
    "then there is a polynomial @xmath631 of degree at most @xmath632 such that @xmath633 , the density matrix .",
    "this is just the interpolation polynomial that takes the value 1 on the eigenvalues to the left of @xmath85 , and zero on the eigenvalues to the right of @xmath85 .",
    "this polynomial approximation  is actually exact .",
    "if @xmath634 , and is independent of @xmath0 , then @xmath248 will be a matrix with @xmath2 nonzero entries ; moreover , the sparsity pattern of @xmath248 can be determined _ a priori _ from the graph structure of @xmath151 .",
    "another situation is that in which the eigenvalues of @xmath151 fall in a small number @xmath425 of narrow bands , or tight clusters , with the right - most band to the left of @xmath85 well - separated from the left - most band to the right of @xmath85 . in this case",
    "we can find again a low - degree polynomial @xmath631 with @xmath635 , and improved bounds can be obtained .",
    "the problem , of course , is that these are rather special eigenvalue distributions , and it is difficult to know _ a priori _ whether such conditions hold or not .",
    "another practical issue that should be at least briefly mentioned is the fact that our bounds assume knowledge of lower and upper bounds on the spectra of the hamiltonians @xmath151 , as well as estimates for the size and location of the spectral gap ( this is also needed in order to determine the fermi level @xmath85 ) .",
    "these issues have received a great deal of attention in the literature , and here we limit ourselves to observe that @xmath2 procedures exists to obtain sufficiently accurate estimates of these quantities ; see , e.g. , @xcite .",
    "in this section we discuss the transformation of an hamiltonian from a non - orthogonal to an orthogonal basis .",
    "the main point is that while this transformation results in matrices with less sparsity , the transformed matrices retain the decay properties of the original matrices , only with ( possibly ) different constants .",
    "what is important , from the point of view of asymptotic complexity , is that the rate of decay remains independent of system size .",
    "we begin with a discussion of decay in the inverse of the overlap matrix . to this end , consider a sequence @xmath636 of overlap matrices of size @xmath316 , with @xmath48 constant and @xmath4 increasing to infinity .",
    "we make the following assumptions :    1 .",
    "each @xmath637 is a banded symmetric positive definite ( spd ) matrix with unit diagonal entries and with bandwidth uniformly bounded with respect to @xmath0 ; 2 .",
    "the spectral condition number ( ratio of the largest to the smallest eigenvalue ) of each @xmath637 , @xmath638 , is uniformly bounded with respect to @xmath0 . because of assumption 1 , this is equivalent to requiring that the smallest eigenvalue of @xmath637 remains bounded away from zero , for all @xmath0 .    as always in this paper ,",
    "the bandedness assumption in item 1 is not essential and can be replaced by the weaker hypothesis that each @xmath637 is sparse and that the corresponding graphs @xmath219 have bounded maximal degree with respect to @xmath0 .",
    "actually , it would be enough to require that the sequence @xmath636 has the exponential decay property relative to a sequence of graphs @xmath219 of bounded maximal degree . in order to simplify the discussion , and also in view of the fact that overlap matrices usually exhibit exponential or even super - exponential decay , we assume from the outset that each @xmath637 has already been truncated to a sparse ( or banded ) matrix .",
    "again , this is for notational convenience only , and it is straightforward to modify the following arguments to account for the more general case . on the other hand , the assumption on condition numbers in item 2 is essential and can not be weakened .",
    "we note that assumption 2 above is analogous to the condition that the sequence of hamiltonians @xmath150 has spectral gap bounded below uniformly in @xmath0 ; while this condition ensures ( as we have shown ) the exponential decay property in the associated spectral projectors @xmath248 , assumption 2 above insures exponential decay in the inverses ( or inverse factors ) of the overlap matrices . both conditions amount to asking that the corresponding problems be uniformly well - conditioned in @xmath0 .",
    "the difference is that the decay on the spectral projectors depends on the spectral gap of the hamiltonians and therefore on the nature of the system under study ( i.e. , insulator vs.  metallic system ) , whereas the sparsity and spectral properties of the overlap matrices depend on other features of the system , mainly the inter - atomic distances .    in the following",
    "we shall need some basic results on the decay of the inverses @xcite , inverse cholesky factors @xcite and inverse square roots ( lwdin factors ) @xcite of banded spd matrices ; see also @xcite .",
    "let @xmath179 be spd and @xmath66-banded , and let @xmath372 and @xmath373 denote the smallest and largest eigenvalue of @xmath179 , respectively .",
    "write @xmath639 for the spectral condition number @xmath640 of @xmath179 ( hence , @xmath641 ) .",
    "define @xmath642 furthermore , let @xmath643 . in @xcite , demko et al .  obtained the following bound on the entries of @xmath644 : @xmath645 .",
    "note that the bound ( [ dms ] ) ` blows up ' as @xmath646 , as one would expect .",
    "as shown in @xcite , the decay bound ( [ dms ] ) and the bandedness assumption on @xmath179 imply a similar decay bound on the inverse cholesky factor @xmath647 , where @xmath648 with @xmath649 upper triangular ( @xmath650 lower triangular ) . assuming that @xmath179 has been scaled so that @xmath651 ( which is automatically true if @xmath179 is an overlap matrix corresponding to a set of normalized basis functions ) , we have @xmath652 ; here @xmath263 , @xmath604 are the same as before .",
    "we further note that while @xmath653 , for some classes of matrices it is possible to show that the actual magnitude of the @xmath207 entry of @xmath76 ( as opposed to the bound ( [ z_bound ] ) ) is actually less than the magnitude of the corresponding entry of @xmath644 .",
    "this is true , for instance , for an irreducible @xmath654-matrix ; see @xcite .",
    "finally , let us consider the inverse square root , @xmath655 .",
    "in @xcite the following bound is established : @xmath656_{ij } \\right | \\le k_2\\ , \\lambda^{|i - j| } , \\quad 1\\le i , j\\le n \\,.\\ ] ] here @xmath545 depends again on the extreme eigenvalues @xmath372 and @xmath373 of @xmath179 , whereas @xmath657 , where now @xmath122 is any number satisfying the inequalities @xmath658 as before , the bound ( [ l_bound ] ) blows up as @xmath646 , as one would expect .    introducing the positive scalar @xmath659 , we can rewrite all these bounds in the form @xmath660 for the appropriate matrix @xmath661 and suitable constants @xmath263 and @xmath613 .",
    "let now @xmath636 be a sequence of @xmath60 overlap matrices , where @xmath152 with @xmath48 fixed and @xmath158 .",
    "assuming that the matrices @xmath637 satisfy the above assumptions 1 - 2 , then their inverses satisfy the uniform exponential decay bounds ( [ dms ] ) , with @xmath263 and @xmath604 constant and independent of @xmath0 .",
    "hence , as discussed in section [ trunc ] , for any given @xmath182 there exists an integer @xmath183 independent of @xmath0 such that each matrix @xmath637 in the sequence can be approximated , in norm , by an @xmath183-banded matrix with an error less than @xmath221 . as usual",
    ", this result can be extended from the banded case to the sparse case , assuming that the corresponding graphs @xmath210 have bounded maximal degree as @xmath3 . moreover , under assumptions 1 - 2 above , the inverse cholesky factors @xmath662 satisfy a uniform ( in @xmath0 ) exponential decay bound of the type ( [ z_bound ] ) , and therefore uniform approximation with banded triangular matrices is possible .",
    "again , generalization to more general sparsity patterns is possible , provided the usual assumption on the maximum degree of the corresponding graphs @xmath210 holds .",
    "similarly , under the same conditions we obtain a uniform rate of exponential decay for the entries of the inverse square roots @xmath663 , with a corresponding result on the existence of a banded ( or sparse ) approximation .",
    "let us now consider the sequence of transformed hamiltonians , @xmath664 . here",
    "@xmath662 denotes either the inverse cholesky factor or the inverse square root of the corresponding overlap matrix @xmath637 . assuming that the sequence @xmath150 satisfies the off - diagonal exponential decay property and that @xmath636 satisfies assumptions 1 - 2 above , it follows from the decay properties of the matrix sequence @xmath665 that the sequence @xmath666 also enjoys off - diagonal exponential decay .",
    "this is a straightforward consequence of the following result , which is adapted from a similar one for infinite matrices due to jaffard ( * ? ? ?",
    "* proposition 1 ) .",
    "consider two sequences @xmath209 and @xmath667 of @xmath60 matrices ( where @xmath3 ) whose entries satisfy @xmath203_{ij}\\right | \\le c_1\\ , { \\rm e}^{-\\alpha |i - j| } \\quad { \\rm and }     \\quad \\left |[b_n]_{ij } \\right | \\le c_2\\ , { \\rm e}^{-\\alpha |i - j|}\\ , ,   \\quad 1\\le i , j\\le n\\,,\\ ] ] where @xmath668 , @xmath669 and @xmath170 are independent of @xmath0 .",
    "then the sequence @xmath670 , where @xmath671 , satisfies a similar bound : @xmath672_{ij}\\right | \\le c\\ , { \\rm e}^{-\\alpha ' |i - j| } , \\quad 1\\le i , j\\le n\\,,\\ ] ] for any @xmath673 , with @xmath199 independent of @xmath0 .",
    "first note that the entries of each @xmath172 clearly satisfy @xmath203_{ij}\\right | \\le c_1\\ , { \\rm e}^{-\\alpha ' |i - j| } \\quad { \\rm for\\,\\ , any } \\quad   \\alpha ' < \\alpha\\,.\\ ] ] let @xmath674 .",
    "then @xmath675 and the entries @xmath676_{ij}$ ] of @xmath677 satisfy @xmath678_{ij}\\right | \\le \\sum_{k=1}^n   \\left |[a_n]_{ik}\\right | \\left |[b_n]_{kj } \\right | \\le c_1 c_2 \\ , \\left ( \\sum_{k=1}^n { \\rm e}^{-\\omega |k - j|}\\right ) { \\rm e}^{-\\alpha ' |i - j|}\\,.\\ ] ] to complete the proof just observe that for any @xmath208 , @xmath679 since the last term is independent of @xmath0 , the entries of @xmath680 satisfy ( [ c_bound ] ) with a constant @xmath199 that is also independent of @xmath0 .",
    "the foregoing result can obviously be extended to the product of three matrices .",
    "thus , the entries of the matrix sequence @xmath666 , where @xmath681 , enjoy the exponential off - diagonal decay property : @xmath682_{ij } \\right | \\le c \\ , { \\rm e}^{-\\alpha |i - j| } , \\quad 1 \\le i , j \\le n\\,,\\ ] ] for suitable constants @xmath199 and @xmath613 . alternatively , one could first approximate @xmath151 and @xmath662 with banded matrices @xmath683 and @xmath684 and then define the ( approximate ) transformed hamiltonian as @xmath685 , possibly subject to further truncation .",
    "using the fact that both @xmath151 and @xmath662 have 2-norm bounded independently of @xmath0 , it is easy to show that the final approximation error can be reduced below any prescribed tolerance by reducing the error in @xmath683 and @xmath684 .",
    "hence , with either approach , the transformed hamiltonians @xmath686 can be approximated uniformly in @xmath0 within a prescribed error by banded matrices of constant bandwidth , just like the original ( non - orthogonal ) hamiltonians . while the bandwidth of the approximations will be larger than for the original hamiltonians , the truncated matrices retain a good deal of sparsity and asymptotically contain @xmath2 non - zeros .",
    "hence , we have a justification of the statement ( see section [ sec : introduction ] ) that in our theory we can assume from the outset that the basis set @xmath46 is orthonormal .    in fig .  [ fig_h_jacek ]",
    "we show the hamiltonian @xmath51 for the already mentioned linear alkane @xmath390 ( see section [ sec_density ] ) discretized in a gaussian - type orbital basis ( top ) and the ` orthogonalized ' hamiltonian @xmath687 ( bottom ) .",
    "this figure shows that while the transformation to orthogonal basis alters the magnitude of the entries in the hamiltonian , the bandwidth of @xmath391 ( truncated to a tolerance of @xmath392 ) is only slightly wider than that of @xmath51 . in this case",
    "the overlap matrix @xmath52 is well - conditioned , hence the entries of @xmath76 exhibit fast decay .",
    "an ill - conditioned overlap matrix would lead to a less sparse transformed hamiltonian @xmath391 .    as usual ,",
    "the bandedness assumption was made for simplicity of exposition only ; similar bounds can be obtained for more general sparsity patterns , assuming the matrices @xmath151 and @xmath637 have the exponential decay property relative to a sequence @xmath219 of graphs having maximal degree uniformly bounded with respect to @xmath0 .",
    "it is important to emphasize that in practice , the explicit formation of @xmath686 from @xmath151 and @xmath662 is not needed and is never carried out .",
    "indeed , in all algorithms for electronic structure computation the basic matrix operations are matrix - matrix and matrix - vector products , which can be performed without explicit transformation of the hamiltonian to an orthonormal basis . on the other hand , for the study of the decay properties it is convenient to assume that all the relevant matrices are explicitly given in an orthogonal representation .",
    "linear alkane .",
    "top : non - orthogonal ( gto ) basis .",
    "bottom : orthogonal basis .",
    "white : @xmath400 ; yellow : @xmath401 ; green : @xmath402 ; blue : @xmath403 ; black : @xmath404 .",
    "note : nz refers to the number of ` black ' entries.,scaledwidth=65.0% ]     linear alkane .",
    "top : non - orthogonal ( gto ) basis .",
    "bottom : orthogonal basis .",
    "white : @xmath400 ; yellow : @xmath401 ; green : @xmath402 ; blue : @xmath403 ; black : @xmath404 .",
    "note : nz refers to the number of ` black ' entries.,scaledwidth=65.0% ]    one last issue to be addressed is whether the transformation to an orthonormal basis should be effected via the inverse cholesky factor or via the lwdin ( inverse square root ) factor of the overlap matrix .",
    "comparing the decay bounds for the two factors suggests that the inverse cholesky factor should be preferred ( smaller @xmath130 ) .",
    "also note that the inverse cholesky factor is triangular , and its sparsity can be increased by suitable reorderings of the overlap matrix .",
    "the choice of ordering may also be influenced by the computer architecture used .",
    "we refer to @xcite for the use of bandwidth - reducing orderings like reverse cuthill  mckee , and to @xcite for the use of space - filling curve orderings like the 3d hilbert curve to improve load balancing and data locality on parallel architectures .",
    "in contrast , the lwdin factor is a full symmetric matrix , regardless of the ordering . on the other hand ,",
    "the multiplicative constant @xmath199 is generally smaller for the lwdin factor .",
    "closer examination of a few examples suggests that in practice there is no great difference in the actual decay behavior of these two factors .",
    "however , approximating @xmath663 is generally more expensive and considerably more involved than approximating the inverse cholesky factor . for the latter , the ainv algorithm @xcite and its variants @xcite",
    "are quite efficient and have been successfully used in various quantum chemistry codes . for other @xmath2 algorithms for transformation to an orthonormal basis ,",
    "see @xcite . in all these algorithms ,",
    "sparsity is preserved by dropping small entries in the course of the computation .",
    "explicit decay bounds for the @xmath662 factors could be used , in principle , to establish _ a priori _ which matrix elements _ not _ to compute , thus reducing the amount of overhead .",
    "notice , however , that even if asymptotically bounded , the condition numbers @xmath638 can be fairly large , leading to rather pessimistic decay estimates .",
    "this is again perfectly analogous to the situation with the condition number - based error bounds for the conjugate gradient ( cg ) method applied to a linear system @xmath627 . and",
    "indeed , both the cg error bounds and the estimates ( [ dms ] ) are obtained using chebyshev polynomial approximation for the function @xmath688 .",
    "in this section we discuss the case of a sequence @xmath150 of bounded , finite range hamiltonians for which the spectral gap around the fermi level @xmath85 vanishes as @xmath3 .",
    "recall that this means that @xmath162 , where @xmath689 is the homo - lumo gap for the @xmath0-th hamiltonian ; it is assumed here that @xmath690 for all @xmath152 .",
    "the reciprocal @xmath691 of the gap can be interpreted as the condition number of the problem @xcite , so a vanishing spectral gap means that the conditioning deteriorates as @xmath158 and the problem becomes increasingly difficult .",
    "as already mentioned , in the zero - temperature limit our decay bounds blow up , and therefore lose all meaning as @xmath692 . on the other hand , we know _ a priori _ that some type of decay should be present , in view of the results in section [ proj ] .",
    "a general treatment of the vanishing gap case appears to be rather difficult .",
    "the main reason is that in the limit as @xmath94 the fermi ",
    "dirac approximation to the heaviside function becomes discontinuous , and therefore we can no longer make use of tools from classical approximation theory for analytic functions .",
    "similarly , in the vanishing gap case the decay bounds ( [ cauchy_bd ] ) based on the resolvent estimates ( [ res_est ] ) break down since @xmath693 and @xmath694 in ( [ cc_bound ] ) .    rather than attacking the problem in general , in this section",
    "we give a complete analysis of what is perhaps the simplest nontrivial example of a sequence @xmath150 with vanishing gap .",
    "while this is only a special case , this example captures some of the essential features of the ` metallic ' case , such as the rather slow off - diagonal decay of the entries of the density matrix .",
    "the simple model studied in this section may appear at first sight to be too simple and unrealistic to yield any useful information about actual physical systems .",
    "however , calculation of the density matrix at zero temperature on a system composed of 500 al atoms reported in @xcite reveals a decay behavior which is essentially identical to that obtained analytically for a free electron gas , a model very close to ours ( which is essentially a discrete variant of the one in @xcite ) .",
    "we believe that our analysis will shed some light on more general situations in which a slowly decaying density matrix occurs .",
    "we begin by considering the infinite tridiagonal toeplitz matrix @xmath695 which defines a bounded , banded , self - adjoint operator on @xmath334 .",
    "the graph of this matrix is just a ( semi - infinite ) path .",
    "the operator can be interpreted as an averaging operator , or as a centered second - difference operator with a zero dirichlet condition at one end , shifted and scaled so as to have spectrum contained in @xmath164 $ ] . from a physical standpoint , @xmath51 is the shifted and scaled discrete one - electron hamiltonian where the electron is constrained to the half - line @xmath696 . for @xmath0 even ( @xmath697 , with @xmath698 ) consider the @xmath0-dimensional approximation @xmath699 this corresponds to truncating the semi - infinite path and imposing zero dirichlet conditions at both ends",
    "let now @xmath700 denote the standard basis of @xmath334 , and let @xmath701 denote the identity operator restricted to the subspace of @xmath334 spanned by @xmath702 .",
    "letting @xmath703 the sequence @xmath704 is now a sequence of bounded self - adjoint linear operators on @xmath334 that converges strongly to @xmath51 .",
    "note that @xmath705 $ ] for all @xmath0 ; also , @xmath706 for all even @xmath0 .",
    "it is easy to see that half of the eigenvalues of @xmath151 lie in @xmath707 and the other half in @xmath708 $ ] .",
    "we set @xmath191 and we label as ` occupied ' the states corresponding to negative eigenvalues .",
    "the spectral gap of each @xmath151 is then @xmath709 .",
    "the eigenvalues and eigenvectors of @xmath151 are known explicitly ( * ? ? ?",
    "* lemma 6.1 ) .",
    "indeed , the eigenvalues , in descending order , are given by @xmath710 ( with @xmath711 ) and the corresponding normalized eigenvectors are given by @xmath712 with entries @xmath713 note that the eigenvalues are symmetric with respect to the origin , and that the spectral gap at 0 vanishes , since @xmath714 as @xmath3 .",
    "we also point to the well known fact that the eigenvectors of this operator are strongly delocalized .",
    "nevertheless , as we will see , some localization ( decay ) is present in the density matrix , owing to cancellation ( i.e. , destructive interference ) .",
    "now let @xmath248 be the zero - temperature density matrix associated with @xmath151 , i.e. , the spectral projector onto the subspace of @xmath715 spanned by the eigenvectors of @xmath151 associated with the lowest @xmath4 eigenvalues ( the occupied subspace ) .",
    "we extend @xmath248 to a projector acting on @xmath334 by embedding @xmath248 into an infinite matrix @xmath716 as follows : @xmath717 note that @xmath716 is just the orthogonal projector onto the subspace of @xmath334 spanned by the eigenvectors of @xmath718 associated with eigenvalues in the interval @xmath707 .",
    "moreover , @xmath719 .",
    "the limiting behavior of the sequence @xmath720 ( hence , of @xmath246 ) is completely described by the following result .",
    "[ no_gap ] let @xmath51 , @xmath151 , and @xmath716 be as described above .",
    "then    * @xmath51 has purely absolutely continuous spectrum , on a hilbert space @xmath330 is the spectrum of the restriction of @xmath51 to the subspace @xmath721 of vectors @xmath722 whose spectral measures @xmath723 are absolutely continuous with respect to the lebesgue measure . for details ,",
    "see @xcite . ] given by the interval @xmath164 $ ] .",
    "in particular , @xmath51 has no eigenvalues . *",
    "the union of the spectra of the @xmath0-dimensional sections @xmath151 of @xmath51 is everywhere dense in @xmath724 $ ] . in other words ,",
    "every point in @xmath164 $ ] is the limit of a sequence of the form @xmath725 for @xmath3 , where @xmath726 and @xmath727 . *",
    "the sequence @xmath150 has vanishing gap : @xmath728 .",
    "* the spectral projectors @xmath716 converge strongly to @xmath729 where @xmath730 , the characteristic function of the interval @xmath707 .",
    "* @xmath61 is the orthogonal projector onto an infinite - dimensional subspace of @xmath731 .",
    "statements ( i)-(ii ) are straightforward consequences of classical results on the asymptotic eigenvalue distribution of toeplitz matrices , while ( iv)-(v ) follow from general results in spectral theory .",
    "statement ( iii ) was already noted ( the eigenvalues of @xmath151 are explicitly known ) and it also follows from ( i)-(ii ) .",
    "more in detail , statement ( i ) is a special case of rosenblum s theorem on the spectra of infinite banded toeplitz matrices : see @xcite or ( * ? ? ?",
    "* thm .  1.31 ) .",
    "for the fact that the spectrum of @xmath51 coincides with the interval @xmath164 $ ] and that the finite section eigenvalues @xmath732 are dense in @xmath724 $ ] ( statement ( ii ) ) , see the paper by hartman and wintner @xcite or the book by grenander and szeg ( * ? ? ?",
    "* chapter 5 ) .",
    "statement ( iv ) can be proved as follows . for a linear operator @xmath179 on @xmath731 , write @xmath733 , with @xmath734 .",
    "a sequence @xmath735 of self - adjoint ( hermitian ) operators is said to converge in the _ strong resolvent sense _ to @xmath179 if @xmath736 strongly for all @xmath737 with @xmath738 , that is : @xmath739 it is easy to check , using for instance the results in ( * ? ? ?",
    "* chapter 2 ) , that the sequence @xmath150 converges in the strong resolvent sense to @xmath51 . statement ( iv ) ( as well as ( ii ) ) now follows from ( * ? ? ? * thm .",
    "viii.24 ) . the fact ( v )",
    "that @xmath729 is an orthogonal projector onto an infinite - dimensional subspace of @xmath731 follows from the fact that @xmath191 is not an eigenvalue of @xmath51 ( because of ( i ) ) and from the spectral theorem for self - adjoint operators in hilbert space ; see , e.g. , ( * ? ? ?",
    "* chapter vii ) or ( * ? ? ?",
    "* chapter 12 ) .",
    "the foregoing result implies that the toeplitz matrix sequence @xmath150 given by ( [ toep_n ] ) exhibits some of the key features of the discrete hamiltonians describing metallic systems , in particular the vanishing gap property and the fact that the eigenvalues tend to fill the entire energy spectrum .",
    "the sequence @xmath150 can be thought of as a 1d ` toy model ' that can be solved analytically to gain some insight into the decay properties of the density matrix such systems .",
    "indeed , from the knowledge of the eigenvectors of @xmath151 we can write down the spectral projector corresponding to the lowest @xmath740 eigenvalues explicitly . recalling that the eigenvalues @xmath732 are given in descending order , it is convenient to compute @xmath248 as the projector onto the orthogonal complement of the subspace spanned by the eigenvectors corresponding to the @xmath741 largest eigenvalues : @xmath742 the @xmath207 entry of @xmath248 is therefore given by @xmath598_{ij } = e_i^t p_n e_j = \\delta_{ij } - \\frac{2}{n+1 } \\sum_{k=1}^{n_e }   \\sin \\left ( \\frac{ik\\pi}{n+1}\\right ) \\sin \\left ( \\frac{jk\\pi}{n+1}\\right ) .\\ ] ] for @xmath346",
    ", we find @xmath743_{ii } = 1- \\frac{2}{n+1 } \\sum_{k=1}^{n_e } \\sin^2 \\left ( \\frac{ik\\pi}{n+1}\\right ) = \\frac{1}{2 } , \\quad   { \\rm for \\,\\ , all\\,\\ , } i=1,\\ldots , n \\,\\ , { \\rm and\\,\\ , for \\,\\ , all\\,\\ , } n.\\ ] ] hence , for this system the charge density @xmath744 is constant and the system essentially behaves like a non - interacting electron gas , see for example @xcite .",
    "we note in passing that this example confirms that the bound ( [ off ] ) is sharp , since equality is attained for this particular projector .",
    "moreover , the trigonometric identity @xmath745\\ ] ] implies for all @xmath268 : @xmath746_{ij } =   \\frac{1}{n+1 } \\sum_{k=1}^{n_e } \\left [ \\cos \\left ( \\frac{(i+j)k\\pi}{n+1 } \\right ) -   \\cos \\left ( \\frac{(i - j)k\\pi}{n+1 } \\right ) \\right ] \\,.\\ ] ] from ( [ p_ij ] ) it immediately follows , for all @xmath30 and for all @xmath0 , that @xmath747_{i , i+2l } = 0\\,,\\quad l=1,2,\\ldots\\ ] ] since ( [ diag ] ) and ( [ jplus2 ] ) hold for all @xmath0 , they also hold in the limit as @xmath3 .",
    "hence , the strong limit @xmath61 of the sequence of projectors @xmath720 satisfies @xmath748 and @xmath749 for all @xmath750 , where @xmath751 to determine the remaining off - diagonal entries @xmath146 ( with @xmath752 and @xmath753 ) we directly compute the limit of @xmath249_{ij}$ ] as @xmath3 , as follows . observe that using the substitution @xmath754 and taking the limit as @xmath755 in ( [ p_ij ] ) we obtain for all @xmath756 and for all @xmath753 ( @xmath757 ) : @xmath758 \\ , dx -           \\int_0^{\\frac{1}{2 } } \\cos[(i - j)\\pi x ] \\ , dx \\\\         & = \\frac{1}{\\pi } \\left [ \\frac{(-1)^{\\frac{i+j-1}{2}}}{i+j } +             \\frac{(-1)^{\\frac{i - j+1}{2}}}{i - j}\\right ] \\ , .",
    "\\end{split}\\ ] ] it follows from ( [ integral ] ) that @xmath759 is bounded by a quantity that decays only linearly in the distance from the main diagonal . as a result ,",
    "@xmath2 approximation of @xmath248 for large @xmath0 involves a huge prefactor .",
    "therefore , from this very simple example we can gain some insight into the vanishing gap case .",
    "the analytical results obtained show that the density matrix can exhibit rather slow decay , confirming the well known fact that @xmath2 approximations pose a formidable challenge in the vanishing gap case .",
    "the 2d case is easily handled as follows .",
    "we consider for simplicity the case of a square lattice consisting of @xmath760 points in the plane .",
    "the 2d hamiltonian is given by @xmath761 where the scaling factor @xmath762 is needed so as to have @xmath763 $ ] .",
    "the eigenvalues and eigenvectors of @xmath764 can be explicitly written in terms of those of @xmath151 ; see , e.g. , @xcite .",
    "assuming again that @xmath0 is even , exactly half of the @xmath760 eigenvalues of @xmath764 are negative ( counting multiplicities ) , the other half positive .",
    "as before , we are interested in finding the spectral projector associated with the eigenvectors corresponding to negative eigenvalues .",
    "note again that the spectral gap tends to zero as @xmath3 .",
    "if @xmath765 denotes the spectral projector onto the occupied states , it is not difficult to show that @xmath766 it follows from ( [ 2d_case ] ) that the spectral projector @xmath765 has a natural @xmath60 block structure , where    * each diagonal block is equal to @xmath767 ; note that this gives the correct trace , @xmath768 . * the @xmath769 off - diagonal block @xmath770 is given by @xmath771_{kl}(i_n - 2p_n)$ ] .",
    "hence , each off - diagonal block has a ` striped ' structure , with the main diagonal as well as the third , fifth , etc .",
    "off - diagonal identically zero .",
    "moreover , every block @xmath770 with @xmath772 ( @xmath773 ) is zero .",
    "this shows that in the 2d case , the rate of decay in the spectral projector is essentially the same as in the 1d case . the 3d case can be handled in a similar manner , leading to the same conclusion .    for this simple example we can also compute the entries of the density matrix at positive electronic temperature @xmath96 . recalling that the density matrix in this case is given by the fermi",
    "dirac function with parameter @xmath774 we have in the 1d case ( assuming @xmath191 ) @xmath775}\\,.\\ ] ] making use again of the trigonometric identity ( [ trigid ] ) and using the same substitution @xmath754 , we can reduce the computation of the density matrix element @xmath146 for @xmath3 to the evaluation of the following integral : @xmath776 - \\cos\\ , [ ( i+j)\\pi x ] } { 1 + { \\rm exp}\\ , ( \\beta \\cos \\pi x ) } \\ , dx \\,.\\ ] ] unfortunately , this integral can not be evaluated explicitly in terms of elementary functions .",
    "note , however , that the integral @xmath777 ( where @xmath425 is an integer ) becomes , under the change of variable @xmath778 , @xmath779 hence , up to a constant factor , @xmath780 is just the @xmath425th coefficient in the chebyshev expansion of the fermi  dirac function @xmath781 . since the fermi ",
    "dirac function is analytic on the interior of an ellipse containing the interval @xmath164 $ ] and continuous on the boundary of such an ellipse , it follows from the general theory of chebyshev approximation that the coefficients @xmath780 decay at least exponentially fast as @xmath782 ; see , e.g , @xcite .",
    "this in turn implies that the entries @xmath146 given by ( [ int_postcase ] ) decay at least exponentially fast away from the main diagonal , the faster the larger the temperature is , as already discussed in section [ dep_t ] .",
    "hence , for this special case we have established in a more direct way the exponential decay behavior already proved in general in section [ sec_fd ] . in the present case , however , for any value of @xmath93 the decay rate of the entries @xmath146 given by ( [ int_postcase ] )",
    "can be determined to arbitrary accuracy by numerically computing the chebyshev coefficients of the fermi  dirac function .",
    "we mention that a simple , one - dimensional model of a system with arbitrarily small gap has been described in @xcite .",
    "the ( continuous ) hamiltonian in @xcite consists of the kinetic term plus a potential given by a sum of gaussian wells located at the nuclei sites @xmath783 : @xmath784 with @xmath785 and @xmath786 tunable parameters .",
    "the spectra of this family of hamiltonians present a band structure with band gap proportional to @xmath787 .",
    "note that the model reduces essentially to ours for @xmath788 and/or for @xmath789 . on the other hand , while the gap can be made arbitrarily small by tuning the parameters in the model , for any choice of @xmath170 and @xmath790 the gap does not vanish ; therefore , no approximation of the infinite - size system with a sequence of finite - size ones can lead to a vanishing gap in the thermodynamic limit .",
    "this means that our bounds , when applied to this model , will yield exponential decay , albeit very slow ( since the correlation lengths will be quite large for small @xmath788 and/or for large @xmath14 ) . the model in @xcite , on the other hand",
    ", can be useful for testing purposes when developing algorithms for metal - like systems with slowly decaying density matrices .",
    "in this section we sketch a few possible applications of our decay results to areas other than electronic structure computations .      in quantum statistical mechanics , the equilibrium density matrix for a system of particles subject to a heat bath at absolute temperature @xmath99",
    "is defined as @xmath791 as usual , @xmath97 where @xmath792 denotes the boltzmann constant ; see @xcite .",
    "the matrix @xmath61 is the quantum analog of the canonical gibbs state .",
    "the hamiltonian @xmath51 is usually assumed to have been shifted so that the smallest eigenvalue is zero @xcite .",
    "note that @xmath61 as defined in ( [ heath ] ) is not an orthogonal projector .",
    "it is , however , hermitian and positive semidefinite .",
    "normalization by the _ partition function _",
    "@xmath76 ensures that @xmath793 $ ] and that @xmath101 .",
    "it is clear that for increasing temperature , i.e. , for @xmath794 ( equivalently , for @xmath795 ) the canonical density matrix @xmath61 approaches the identity matrix , normalized by the matrix size @xmath0 . in particular ,",
    "the off - diagonal entries tend to zero .",
    "the physical interpretation of this is that in the limit of large temperatures the system states become totally uncorrelated . for temperatures approaching the absolute zero , on the other hand",
    ", the canonical matrix @xmath61 tends to the orthogonal projector associated with the zero eigenvalue ( ground state ) . in this limit",
    ", the correlation between state @xmath30 and state @xmath208 is given by the @xmath207 entry of the orthogonal projector onto the eigenspace corresponding to the zero eigenvalue , normalized by @xmath0 .",
    "for finite , positive values of @xmath99 , the canonical density matrix @xmath61 is full but decays away from the main diagonal ( or , more generally , away from the sparsity pattern of @xmath51 ) .",
    "the rate of decay depends on @xmath93 : the smaller it is , the faster the decay .",
    "application of the bounds developed in section [ sec_main ] to the matrix exponential is straightforward .",
    "for instance , the bounds based on bernstein s theorem take the form @xmath796 where @xmath797 in these expressions , @xmath798 and @xmath799 are the parameters associated with the bernstein ellipse with foci in @xmath361 and @xmath69 and major semi - axis @xmath800 , as described in section [ sec_main ] .",
    "choosing @xmath375 large makes the exponential term decay @xmath801 very fast , but causes @xmath802 to grow larger .",
    "clearly , a smaller @xmath93 makes the upper bound ( [ exp_dec_bnds ] ) smaller .",
    "bounds on the entries of the canonical density matrix @xmath61 can be obtained dividing through the upper bounds by @xmath76 .",
    "techniques for estimating @xmath76 can be developed using the techniques described in @xcite ; see also @xcite .",
    "although the bound ( [ exp_dec_bnds ] ) is an exponentially decaying one , it can be shown that the decay in the entries of a banded or sparse matrix is actually _ super_-exponential .",
    "this can be shown by expanding the exponential in a series of chebyshev polynomials and using the fact that the coefficients in the expansion , which can be expressed in terms of bessel functions , decay to zero super - exponentially ; see @xcite and also @xcite .",
    "the decay bounds obtained in this way are , however , less transparent and more complicated to evaluate than ( [ exp_dec_bnds ] ) .",
    "finally , exponential decay bounds for spectral projectors and other matrix functions might provide a rigorous justification for @xmath2 algorithms recently developed for disordered systems ; see , e.g. , @xcite .      a related area of research where our decay bounds for matrix functions have proven useful is the study of quantum many - body systems in information theory ; see , e.g. , @xcite . in particular , relationships between spectral gaps and rates of decay for functions of finite range hamiltonians have been established in @xcite using the techniques introduced in @xcite .",
    "the exponential decay of correlations and its relation to the spectral gap have also been studied in @xcite .",
    "as shown in @xcite , exponential decay bounds for matrix functions play a crucial role in establishing so - called _ area laws _ for the _ entanglement entropy _ of ground states associated with bosonic systems .",
    "these area laws essentially state that the entanglement entropy associated with a 3d bosonic lattice is proportional to the surface area , rather than to the volume , of the lattice .",
    "intriguingly , such area laws are analogous to those governing the beckenstein  hawking black hole entropy .",
    "we refer the interested reader to the recent , comprehensive survey paper @xcite for additional information .",
    "the study of complex networks is an emerging field of science currently undergoing vigorous development .",
    "researchers in this highly interdisciplinary field include mathematicians , computer scientists , physicists , chemists , engineers , neuroscientists , biologists , social scientists , etc . among the mathematical tools used in this field , linear algebra and graph theory , in particular spectral graph theory , play a major role .",
    "also , statistical mechanics concepts and techniques have been found to be ideally suited to the study of large - scale networks .    in recent years",
    ", quantitative methods of network analysis have increasingly made use of matrix functions .",
    "this approach has been spearheaded in the works of estrada , rodr ' iguez - vel ' azquez , d.  higham and hatano ; see , e.g. , @xcite , as well as the recent surveys @xcite and the references therein .",
    "functions naturally arising in the context of network analysis include the exponential , the resolvent , and hyperbolic functions , among others .",
    "physics - based justifications for the use of these matrix functions in the analysis of complex networks have been thoroughly discussed in @xcite .",
    "for example , the exponential of the adjacency matrix @xmath179 associated with a simple , undirected graph @xmath803 can be used to give natural definitions of important measures associated with nodes in @xmath804 , such as the _ subgraph centrality _ associated with node @xmath30 , defined as @xmath805_{ii}$ ] , and the _ communicability _ associated with two distinct nodes @xmath30 and @xmath208 , defined as @xmath806_{ij}$ ] . other network quantities that can be expressed in terms of the entries in appropriate matrix functions of @xmath179 include betweenness , returnability , vulnerability , and so forth .",
    "the graph laplacian @xmath807 , where @xmath808 with @xmath809 denoting the degree of node @xmath30 , is sometimes used instead of the adjacency matrix , as well as weighted analogues of both @xmath179 and @xmath650 .",
    "most networks arising in real - world applications are sparse , often with degree distributions closely approximated by power laws .",
    "because the maximum degree in such scale - free   networks increases as the number of nodes tends to infinity , one can not expect uniform exponential decay rates to hold asymptotically for the matrix functions associated with such graphs unless additional structure is imposed , for instance in the form of weights .",
    "nevertheless , our bounds for the entries of functions of sparse matrices can be used to obtain estimates on quantities such as the communicability between two nodes .",
    "a discussion of locality ( or the lack thereof ) in matrix functions used in the analysis of complex networks can be found in @xcite .",
    "we also refer the reader to @xcite for a description of quadrature rule - based bounds for the entries of matrix functions associated with complex networks .",
    "the solution of symmetric tridiagonal eigenvalue problems plays an important role in many field of computational science . as noted for example in @xcite ,",
    "solving such problems is key for most dense real symmetric ( and complex hermitian ) eigenvalue computations and therefore plays a central role in standard linear algebra libraries such as lapack and scalapack . even in the sparse case",
    ", the symmetric tridiagonal eigenvalue problem appears as a step in the lanczos algorithm",
    ".    the efficiency of symmetric tridiagonal eigensolvers can be significantly increased by exploiting localization in the eigenvectors ( more generally , invariant subspaces ) associated with an isolated cluster of eigenvalues",
    ". it would be highly desirable to identify beforehand any localization in the eigenspace in a cost - effective manner , as this would lead to reduced computational costs @xcite .",
    "it is clear that this problem is essentially the same as the one considered in this paper , with the additional assumption that the matrix @xmath51 is tridiagonal . given estimates on the location of the cluster of eigenvalues and on the size of the gaps separating it from the remainder of the spectrum , the techniques described in this paper can be used to bound the entries in the spectral projector associated to the cluster of interest ; in turn , the bounds can be used to identify banded approximations to the spectral projectors with guaranteed prescribed error . whether the estimates obtained in this manner are accurate enough to lead to practical algorithms with substantially improved run times and storage demands over current ones remains an open question for further research .",
    "finally , in the recent paper @xcite the exponential decay results in @xcite are used to derive error bounds and stopping criteria for the lanczos method applied to the computation of @xmath810 , where @xmath179 is a large symmetric positive definite matrix , @xmath811 is a vector , and @xmath812 .",
    "the bounds are applied to the exponential of the tridiagonal matrix @xmath813 generated after @xmath425 steps by the lanczos process in order to obtain the approximation error after @xmath425 steps .",
    "although the main focus of the paper has been the study of functions of sparse hermitian matrices , many of our results can be extended , under appropriate conditions , to non - hermitian matrices .",
    "the generalizations of our decay bounds to _ normal _ matrices , including for example skew - hermitian ones , is relatively straightforward ; see , e.g. , the results in @xcite and @xcite . further generalizations to diagonalizable matrices have been given in @xcite , although the bounds now contain additional terms taking into account the departure from normality .",
    "these bounds may be difficult to use in practice , as knowledge of the eigenvectors or of the field of values of the matrix is needed .",
    "bounds for functions of general sparse matrices can also be obtained using contour integration ; see , e.g. , @xcite and @xcite .",
    "it is quite possible that these bounds will prove useful in applications involving functions of sparse , non - normal matrices .",
    "examples include functions of digraphs in network analysis , like returnability , or functions of the hamiltonians occurring in the emerging field of non - hermitian quantum mechanics ; see , respectively , @xcite and @xcite .",
    "in this paper we have described a general theory of localization for the density matrices associated with certain sequences of banded or sparse discrete hamiltonians of increasing size .",
    "we have obtained , under very general conditions , exponential decay bounds for the off - diagonal entries of zero - temperature density matrices for gapped systems ( ` insulators ' ) and for density matrices associated with systems at positive electronic temperature .",
    "the theory , while purely mathematical , recovers well - known physical phenomena such as the fact that the rate of decay is faster at higher temperatures and for larger gaps , and even captures the correct asymptotics for small gaps and low temperatures .",
    "thus , we have provided a theoretical justification for the development of @xmath2 methods for electronic structure computations . as an integral part of this theory , we have also surveyed the approximation of rapidly decaying matrices by banded or sparse ones , the effects of transforming a hamiltonian from a non - orthogonal to an orthogonal basis , and some general properties of orthogonal projectors .    in the case of zero - temperature and vanishing gaps ,",
    "our bounds deteriorate for increasing @xmath0 . in the limit as @xmath3",
    "we no longer have exponentially decaying bounds , which is entirely consistent with the physics . for metallic systems at zero temperature the decay in the spectral projector follows a power law , and we have exhibited a simple model hamiltonians for which the decay in the corresponding density matrix is only linear in the distance from the main diagonal .    because of the slow decay",
    ", the development of @xmath2 methods in the metallic case at zero temperature is problematic .",
    "we refer the reader to @xcite for some attempts in this direction , but the problem remains essentially open . in the metallic case",
    "it may be preferable to keep @xmath61 in the factorized form @xmath814 , where @xmath815 is any matrix whose columns span the occupied subspace , and to seek a maximally localized @xmath816 .",
    "note that @xmath817 for any unitary @xmath818 matrix @xmath819 , so the question is whether the occupied subspace admits a set of basis vectors that can be rotated so as to become as localized as possible .",
    "another possibility is to research the use of rank - structured approximations ( such as hierarchical matrix techniques @xcite ) to the spectral projector .",
    "combinations of tensor product approximations and wavelets appear to be promising .",
    "we refer here to @xcite for a study of the decay properties of density matrices in a wavelet basis ( see also @xcite ) , and to @xcite for an early attempt to exploit near low - rank properties of spectral projectors . see also the more recent works by w.  hackbusch and collaborators @xcite .    besides the motivating application of electronic structure , our theory is also applicable to other problems where localization plays a prominent role .",
    "we hope that this paper will stimulate further research in this fascinating and important area at the crossroads of mathematics , physics , and computing",
    ".    * acknowledgements .",
    "* we are indebted to three anonymous referees for carefully reading the original manuscript and for suggesting a number of corrections and improvements .",
    "thanks also to the handling editor , fadil santosa , for useful feedback and for his patience and understanding during the several months it took us to revise the paper .",
    "we would also like to acknowledge useful discussions with david borthwick , matt challacombe , jean - luc fattebert , roberto grena , daniel kressner and maxim olshanskii .",
    "finally , we are grateful to jacek jakowski for providing the data for the linear alkane .                , _ comparison of conjugate gradient density matrix search and chebyshev expansion methods for avoiding diagonalization in large - scale electronic structure calculations _ , j.  chem .",
    "phys . , 109 ( 1998 ) , pp .",
    "33083312 .",
    ", _ concepts of data - sparse tensor - product approximation in many - particle modelling _ , in v.  olshevsky and e.  tyrtyshnikov ( eds . ) , _ matrix methods : theory , algorithms and applications : dedicated to the memory of gene golub _ , world scientific , 2010 .                                                                                                    , _ density matrix methods in linear scaling electronic structure theory _ , in r.  zaleny et al .",
    "( eds . ) , _ linear - scaling techniques in computational chemistry and physics _ ,",
    "springer , new york , 2011 , pp .",
    "439473 .                                  ,",
    "_ methods for hartree  fock and density functional theory electronic structure calculations with linearly scaling processor time and memory usage _",
    ", in r.  zaleny et al .",
    "( eds . ) , _ linear - scaling techniques in computational chemistry and physics _ ,",
    "springer , new york , 2011 , pp .",
    "269300 .          ,",
    "_ linear algebra with disordered sparse matrices that have spatial structure : theory and computation _ , phd thesis , department of physics , universit degli studi di roma la sapienza ,  rome , italy , 2004 .                              , _ wahrscheinlichkeitstheoretischer aufbau der quantenmechanik _ , gtt",
    ".  nach . , 1927 .",
    "see also _ collected works , volume i _ , a.  h.  taub , ed . , pergamon press , new",
    "york / oxford / london / paris ( 1961 ) , pp .  208235 .    , _ approximative properties of matrices of high finite order _ , portugaliae math . , 3 ( 1942 ) ,",
    "see also _ collected works , volume iv _ , a.  h.  taub , ed . ,",
    "pergamon press , new york / oxford / london / paris ( 1961 ) , pp ."
  ],
  "abstract_text": [
    "<S> motivated by applications in quantum chemistry and solid state physics , we apply general results from approximation theory and matrix analysis to the study of the decay properties of spectral projectors associated with large and sparse hermitian matrices . </S>",
    "<S> our theory leads to a rigorous proof of the exponential off - diagonal decay ( `` nearsightedness '' ) for the density matrix of gapped systems at zero electronic temperature in both orthogonal and non - orthogonal representations , thus providing a firm theoretical basis for the possibility of linear scaling methods in electronic structure calculations for non - metallic systems . </S>",
    "<S> we further discuss the case of density matrices for metallic systems at positive electronic temperature . </S>",
    "<S> a few other possible applications are also discussed </S>",
    "<S> .    electronic structure , localization , density functional theory , density matrix , spectral gap , matrix function , orthogonal projector    primary 65f60 , 65f50 , 65n22 . </S>",
    "<S> secondary 81q05 , 81q10 . </S>"
  ]
}