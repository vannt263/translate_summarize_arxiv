{
  "article_text": [
    "kohn - sham density functional theory ( ksdft )  @xcite is the most widely used electronic structure theory for condensed matter systems .",
    "when solving the kohn - sham equations , the choice of basis functions usually poses a dilemma for practitioners .",
    "the accurate and systematically improvable basis functions that are uniform in space , such as plane waves or finite elements , typically result in a large number of degrees of freedom ( @xmath0 ) per atom in the framework of norm conserving pseudopotential  @xcite especially for transition metal elements . the number of basis functions per atom can be reduced to the order of hundreds using ultrasoft pseudopotential  @xcite , or augmentation techniques in the core - region such as the linearized augmented plane - wave ( lapw ) method  @xcite and the projector augmented wave ( paw ) method  @xcite .",
    "the relatively large number of basis functions used leads to a large prefactor in front of the already expensive cubic scaling for solving ksdft .",
    "contracted basis functions , such as gaussian type orbitals , atomic orbitals or muffin - tin orbitals , can represent the kohn - sham orbitals with a small number of degrees of freedom per atom ( @xmath1 ) .",
    "these contracted basis functions contain a number of parameters to be determined .",
    "the flexibility for choosing different forms of parameters has generated a vast amount of literature ( see _ e.g. _  refs .  ) in the past few decades , which has been reviewed recently in ref .  .",
    "the parameters in the contracted basis functions are typically constructed by a fitting procedure for a range of reference systems .",
    "the necessary inclusion of polarization basis  @xcite , diffuse basis  @xcite , multiple radial functions for each angular momentum ( multiple @xmath2 basis  @xcite ) are just a few examples when the choice of basis functions becomes difficult and system dependent especially for complex systems .",
    "it is desirable to combine the advantage of uniform basis set in which the accuracy is controlled by no more than a handful of universal parameters for almost all materials , and the advantage of contracted basis functions with a very small number of basis functions per atom . in other words , we would like to generate a small number of contracted basis functions by a unified procedure with high accuracy comparable to that obtained from uniform basis functions . in a recent work  @xcite , we have developed a unified method for constructing a set of contracted basis functions from a uniform basis set such as planewaves in the pseudopotential framework .",
    "the new basis set , called adaptive local basis ( alb ) set , is constructed by solving the kohn - sham problem restricted to a small part of the domain called _",
    "each alb is discontinuous from the perspective of the global domain , and the continuous kohn - sham orbitals are approximated by the discontinuous albs under a discontinuous galerkin framework  @xcite .",
    "it was demonstrated that the albs are able to achieve high accuracy ( in the order of @xmath3 mev ) using disordered na and si as examples . however , the number of basis functions per atom increases with respect to dimensionality .",
    "for example , @xmath4 basis functions per atom is needed to reach the accuracy of @xmath3 mev / atom for 3d bulk na system .    in this paper , we propose a new basis set that is constructed from linear combination of adaptive local basis functions .",
    "each new basis function , dubbed _ element orbital _ ( eo ) , has localized nature around its associated element of the domain .",
    "the number of eos used is significantly reduced compared to the number of albs for 3d bulk systems .",
    "we demonstrate that @xmath5 eos per atom are sufficient to achieve @xmath3 mev per atom accuracy for 3d bulk na system with disorderedness .",
    "we also apply eos to study na , si and graphene , with varying system sizes , lattice constants or types of defects .",
    "the new method consistently achieves mev accuracy for calculating the total energy when compared to standard electronic structure software such as abinit  @xcite .",
    "since the eos are contracted from a uniform basis set such as planewave basis set , the shape of the eos has more flexibility to reflect the environmental effect than contracted basis sets which are centered around atoms .",
    "numerical result indicates that the shape of eos can resemble both atomic orbitals of different angular momentum and chemical bonds centered in the interstitial region , depending on their chemical environment .",
    "we remark that the construction of the eos is closely related to several existing techniques for reducing the number of basis functions per atom , starting from a large primitive basis set consisting of gaussian orbitals or atomic orbitals  @xcite .",
    "however , the eos are contracted from a fine uniform basis set such as planewaves , and a number of difficulties arise which makes the previous techniques difficult to be directly applied .",
    "for instance , the filtration technique in ref .   constructs a near - minimal basis set from a large number of gaussian type orbitals by applying a filtration matrix to a set of trial orbitals , taken from one or a few gaussian - type orbitals .",
    "when the gaussian - type orbitals are replaced by a fine uniform basis set such as planewaves , finding a good set of trial orbitals itself becomes a difficult task , and the construction of trial orbitals can inevitably introduce a set of undetermined parameters , which is not desirable in the current framework .",
    "this paper is organized as follows : section  [ sec : alb ] introduces the adaptive local absis functions in the discontinuous galerkin framework for solving kohn - sham density functional theory in the pseudopotential framework .",
    "the construction of the element orbitals is introduced in section  [ sec : eo ] .",
    "section  [ sec : parallel ] discusses briefly the implementation procedure of element orbitals .",
    "the performance of element orbitals is reported in section  [ sec : num ] , followed by the discussion and conclusion in section  [ sec : conclusion ] .",
    "consider a quantum system with @xmath6 electrons under external potential by @xmath7 in a rectangular domain @xmath8 with periodic boundary condition . to simplify the equations",
    ", we ignore the electron spin for now . in kohn - sham density functional theory at a finite @xmath9  @xcite , the helmholtz free energy is given by @xmath10 { \\,\\mathrm{d}}x \\\\    + \\beta^{-1 } \\sum_i \\bigl ( f_i \\ln f_i +   ( 1 - f_i ) \\ln(1 - f_i ) \\bigr),\\end{gathered}\\ ] ] correspondingly @xmath11 and @xmath12 are the solutions to the minimization problem @xmath13 @xmath14 $ ] are the occupation numbers which add up to the total number of electrons @xmath15 . here",
    "we use exchange - correlation functional under local density approximation ( lda )  @xcite and adopt norm conserving pseudopotential  @xcite , with the projection vector of the nonlocal pseudopotential in the kleinman - bylander form  @xcite denoted by @xmath16 , and @xmath17 is a sign . the number of eigenstates @xmath18 calculated in practice is chosen to be slightly larger than the number of electrons @xmath6 in order to compensate for the finite temperature effect , following the criterion that the occupation number @xmath19 is sufficiently small ( less than @xmath20 .",
    "the electron density is given by @xmath21    the kohn - sham equation , or the euler - lagrange equation associated with is  @xcite @xmath22 \\psi_i = \\bigl ( - \\tfrac{1}{2 } \\delta + v_{{\\mathrm{eff}}}[\\rho ]    + \\sum_{\\ell } \\gamma_{\\ell } { \\lvertb_{\\ell}\\rangle } { \\langleb_{\\ell}\\rvert } \\bigr ) \\psi_i     = \\lambda_i \\psi_i,\\ ] ] where the effective one - body potential @xmath23 $ ] is @xmath24(x ) = v_{{\\mathrm{ext}}}(x ) + \\int \\frac{\\rho(y)}{{\\lvertx - y\\rvert}}{\\,\\mathrm{d}}y + { \\epsilon_{\\mathrm{xc}}}'[\\rho(x)]\\ ] ] and the occupation numbers @xmath25 follow the fermi - dirac distribution @xmath26 here the chemical potential @xmath27 is chosen so that @xmath28 . in each scf iteration of , we freeze @xmath29 and solve for the @xmath30 lowest eigenfunctions @xmath31 . this linear eigenvalue problem is the focus of the following discussion .",
    "the discontinuous galerkin ( dg ) framework  @xcite provides flexibility in choosing appropriate basis functions to discretize the kohn - sham hamiltonian @xmath32 $ ] . in the dg framework ,",
    "a smooth function delocalized across the global domain can be systematically approximated by a set of discontinuous functions that are localized in the real space .",
    "let @xmath33 be a collection of _ elements _ , _ i.e. _  disjoint rectangular partitions of @xmath8 , and @xmath34 be the collection of surfaces @xmath35 that correspond to each element @xmath36 in @xmath37 .",
    "we associate with each @xmath38 a set of orthogonal basis functions @xmath39 supported in @xmath38 , with the total number of basis functions given by @xmath40 under such a basis set , the hamiltonian is discretized into an @xmath41 matrix with entries given by @xmath42 } , { \\{\\{\\nabla    u_{k , j}\\}\\}}\\right\\rangle}_{{\\mathcal{s } } } \\\\    & -\\frac{1}{2}{\\left\\langle{\\{\\{\\nabla u_{k',j'}\\}\\ } } ,     { [ [ u_{k , j}]]}\\right\\rangle}_{{\\mathcal{s } } }     + \\alpha { \\left\\langle{[[u_{k',j ' } ] ] } , { [ [ u_{k , j}]]}\\right\\rangle}_{{\\mathcal{s } } } \\\\    & + { \\left\\langleu_{k',j ' } , v_{{\\mathrm{eff } } } u_{k , j}\\right\\rangle}_{{\\mathcal{t } } }     + \\sum_\\ell   \\gamma_{\\ell } { \\left\\langleu_{k',j'},b_\\ell\\right\\rangle}_{{\\mathcal{t } } } { \\left\\langleb_\\ell , u_{k , j}\\right\\rangle}_{{\\mathcal{t } } } ,    \\end{split }    \\label{eqn : ksdg}\\ ] ] where @xmath43 and @xmath44 are inner products in the bulk and on the surface respectively , and @xmath45 is a fixed parameter for penalizing cross - element discontinuity .",
    "the notations @xmath46 and @xmath47}$ ] stand for the average and jump operators across surfaces  @xcite . comparing and , the new terms involving the average and jump operators can be derived from integration by parts of the laplacian operator , and provide consistency and stability of the dg method  @xcite .        in the work of adaptive local basis set",
    "@xcite , the functions @xmath48 in each element @xmath36 are determined as follows .",
    "let @xmath49 be the dimension of the system . for each @xmath38 ( one black box in fig .",
    "[ fig : cartoon ] ) , we define an associated extended element @xmath50 , which includes both @xmath38 and its @xmath51 neighboring elements . define @xmath52 $ ] to be the restriction of @xmath32 $ ] to @xmath50 with periodic boundary condition and with potential given by the restriction of @xmath23 $ ] to @xmath53 . @xmath52",
    "$ ] is then discretized and diagonalized with uniform basis functions such as planewaves .",
    "we denote the corresponding eigenvalues and eigenfunctions by @xmath54 and @xmath55 , respectively , starting from the lowest eigenvalue .",
    "one then restricts the first @xmath56 functions of @xmath57 to @xmath38 , where @xmath56 is set to be proportional to the number of electrons inside the extended element @xmath50 ( see the numerical examples for specific choice of @xmath56 ) .",
    "in addition , we define for each @xmath38 @xmath58 _ i.e. _  the largest selected eigenvalue in @xmath36 which shall be used later . applying the gram - schmidt procedure to @xmath59",
    "then gives rise to a set of orthonormal functions @xmath60 for each @xmath38 .",
    "the union of such functions over all elements @xmath61 gives the set of adaptive local basis functions ( albs ) .",
    "for a given system , the partition of @xmath36 is kept to be the same even with changing atomic configurations as in the case of structure optimization and molecular dynamics .",
    "dangling bonds may form when atoms are present on the surface of the extended elements , but we emphasize that these dangling bonds are not needed to be passivated by introducing auxiliary atoms near the surface of the extended elements  @xcite .",
    "this is because the potential is not obtained self - consistently within @xmath53 , but instead from the restriction of the screened potential in the global domain @xmath8 to @xmath53 in each scf iteration , which mutes the catastrophic damage of the dangling bonds .",
    "the oscillation in the basis functions caused by the discontinuity of the potential at the surface of the @xmath50 ( called gibbs phenomenon ) still exists , but it damps exponentially away from the surface of @xmath50 and has controlled effect in @xmath38 . using disordered na and si as examples , we demonstrated that alb can achieve mev accuracy per atom using @xmath62 basis functions per atom  @xcite .",
    "the high accuracy of albs indicates that the span of @xmath63 approximately contains the span of the kohn - sham orbitals @xmath64 .",
    "however , we found that the number of basis functions per atom may vary significantly with respect to the dimensionality @xmath49 of the system , which has not been seen reported in the literature using traditional contracted basis set to the extent of our knowledge .",
    "the dimension dependence of albs can be intuitively understood as follows , motivated from the success of the contracted basis set such as atomic orbitals .",
    "consider the case where an atom is positioned at the center of element @xmath38 and assume for simplicity that each of its atomic orbital overlaps only with the neighboring elements ( i.e. , those inside the extended element @xmath50 ) . in order to include one",
    "such atomic orbital denoted by @xmath65 in the span of @xmath66 , each neighboring element @xmath67 in @xmath50 should allocate one of its albs for representing the restriction of @xmath65 in @xmath67 .",
    "this implies that @xmath68 , the total number of albs , should roughly be equal to @xmath69 , which becomes increasingly redundant with respect to the dimension @xmath49 .",
    "in fact , this is close to what has been observed in the numerical experiments  @xcite .    in order to avoid this redundancy and motivated by the construction of atomic orbitals",
    ", we propose to build a new basis set by piecing the albs in neighboring elements @xmath70 in @xmath50 to construct functions that are qualitatively close to the atomic orbitals . to distinguish them from the pre - fitted atomic orbitals , we name these functions _ element orbitals _",
    "( eos ) . in order to achieve this ,",
    "one is faced mainly with three issues .",
    "first , the albs are always discontinuous across the element boundaries , while qualitatively the eos should be a _ continuous _ function since the atomic orbitals are continuous .",
    "second , when one pieces back the albs to obtain the eos , it is essential that the resulting functions have _ low - energy_. finally , one needs to make sure that the eos of @xmath38 should be _ localized _ at @xmath38 in order to avoid degeneracy .",
    "a two - step procedure is proposed to address these three issues . in the first step ,",
    "we construct , for each element @xmath38 , a set of _ candidate functions _ that take care of the first two issues .",
    "then in the second step , we identify the element orbitals by localizing the candidate functions .",
    "more specifically , the method proceeds as follows .",
    "let us fix an element @xmath38 .",
    "first , since each alb is only supported in its associated element and equal to zero outside , we seek for a set of _ candidate functions _ for element @xmath38 that are linear combinations of the albs of both @xmath38 and its @xmath51 neighbors ( fig .",
    "[ fig : cartoon ] ) . denoting by @xmath71 the index of all the albs , and by @xmath72 the index set of albs supported in @xmath50 , we define a local hamiltonian @xmath73 i.e. , the restriction of @xmath74 to the index set @xmath75 . following the intuition that",
    "the atomic orbitals should only be affected by the local environment of @xmath38 , it is reasonable to assume that the low eigenfunctions of @xmath76 serve as good candidate functions .",
    "computationally , we diagonalize @xmath76 by @xmath77 where the diagonal of @xmath78 contains all the eigenvalues bounded from above by the cut - off energy @xmath79 given by and the columns of @xmath80 contains the corresponding eigenfunctions . the matrix @xmath80 is called the _ merging matrix _ for element @xmath38 .",
    "we argue that this step addresses the continuity and low - energy issues of the element orbitals since the eigenfunctions are qualitatively smooth due to the cross - element penalty term of the dg formulation . choosing the eigenfunctions below @xmath79",
    "ensures that the candidate functions have low - energy .",
    "second , we localize these candidate functions to be centered at @xmath38 using a penalizing weight function @xmath81 defined for @xmath82 .",
    "@xmath81 is only nonzero in the extended element @xmath50 outside a certain distance , called the _ localization radius _",
    ", from the boundary of @xmath36 ( light gray area in fig .",
    "[ fig : cartoon ] ) . for simplicity",
    "we choose @xmath83 in the penalty area and @xmath84 otherwise .",
    "more sophisticated weighting function as developed for linear scaling methods  @xcite and confining potentials as developed for atomic orbitals  @xcite can be used and optimized for eos in the future work .",
    "a weighting matrix @xmath85 for the adaptive basis functions in the index set @xmath75 is defined in the extended element @xmath50 by @xmath86 in order to localize the candidate functions , we solve a second eigenvalue problem @xmath87 where @xmath88 since @xmath89 are orthogonal from .",
    "the columns of @xmath90 and the diagonal of @xmath91 consist of the first @xmath92 eigenfunctions and eigenvalues , respectively . here",
    "@xmath92 is the number of element orbitals ( eos ) of @xmath38 .",
    "as will be shown later in the numerical results , a small number of eos per atom already achieve high accuracy in the total energy calculation .",
    "we call the matrix @xmath90 the _ localization matrix _ , and the product @xmath93 gives the coefficients of the eos in @xmath38 in terms of the albs indexed by @xmath75 . in order to present these eos in terms of the whole adaptive basis set ,",
    "we introduce an @xmath94 _ selection matrix _",
    "@xmath95 such that @xmath96 is equal to the identity and all zero otherwise .",
    "by defining the @xmath97 coefficient matrix @xmath98 , we can construct the element orbitals associated with @xmath38 by @xmath99 note that , since these functions are localized in @xmath50 by construction , the index @xmath100 only runs through the elements insides @xmath50 .",
    "finally , the coefficient matrix @xmath101 gives the whole set of coefficients of the @xmath102 element orbitals based on adaptive local basis functions .",
    "once the element orbitals are identified , we solve an @xmath103 generalized eigenvalue problem @xmath104 where the diagonal of @xmath105 gives the kohn - sham eigenvalues @xmath106 and the columns of @xmath107 provide the coefficients of kohn - sham orbitals in terms of eos .",
    "from @xmath106 , one can calculate the chemical potential @xmath27 and the occupation number @xmath108 .",
    "finally , by introducing the gram matrix @xmath109 we can write @xmath110 as @xmath111 where @xmath112 indexes the element that contains @xmath113 .",
    "notice that one only needs the knowledge of the diagonal blocks of the gram matrix @xmath114 to construct the electron density .",
    "this allows us to use the recently developed pole expansion and selected inversion type fast algorithms  @xcite to reduce the asymptotic scaling for solving the generalized eigenvalue problem   from cubic scaling to at most quadratic scaling for 3d bulk systems .",
    "our algorithm is implemented fully in parallel for message - passing environment , based on the implementation details presented in ref .  .",
    "here we summarize the key components of the parallel implementation .",
    "the global domain is discretized with a uniform cartesian grid with a spacing fine enough to capture the local oscillations of the kohn - sham orbitals and the electron density . rather than using the dual grid approach with one set of grid for representing the kohn - sham wavefunctions , and another set of denser grid for representing the electron density , we only use one set of cartesian grid for both the kohn - sham wavefunctions and the electron density for simplicity of the implementation .",
    "the grid inside an element @xmath38 is a three - dimensional cartesian legendre - gauss - lobatto ( lgl ) grid in order to accurately carry out the operations of the basis functions such as numerical integration .",
    "the albs are first represented in a planewave basis set in each extended element @xmath50 solved by lobpcg algorithm  @xcite with a preconditioner  @xcite , and are interpolated to each element @xmath36 and orthogonalized .",
    "the eigenvalue problems involved in constructing the eos are performed by lapack subroutine .    to simplify the discussion of the parallel implementation , we assume that the number of processors is equal to the number of elements .",
    "it is then convenient to index the processors @xmath115 with the same index @xmath116 used for the elements . in the more general setting where the number of elements is larger than the number of processors",
    ", each processor takes a couple of elements and the following discussion will apply with only minor modification . each processor",
    "@xmath117 locally generates and stores the albs @xmath118 for @xmath119 and the coefficients for the eos @xmath120 for @xmath119 and @xmath121 .",
    "the eos @xmath122 are not explicitly formed in the real space .",
    "we further partition the non - local pseudopotentials @xmath123 by assigning @xmath124 to the processor @xmath117 if and only if the atom associated to @xmath124 is located in the element @xmath38 .",
    "since the matrices @xmath125 and @xmath74 are sparse , the hamiltonian matrix @xmath126 and the mass matrix @xmath127 in are also sparse matrices .",
    "however , these matrices are treated as dense matrices in our implementation for simplicity .",
    "the parallel matrix - matrix multiplication for constructing @xmath126 and @xmath128 are performed using pblas subroutine , and the generalized eigenvalue problem   is solved by converting it to a standard eigenvalue problem using scalapack  @xcite subroutine and , and the standard eigenvalue problem is solved by scalapack subroutine .    in our implementation , the matrices @xmath74 and @xmath125 are constructed locally according to the element indices .",
    "however , the scalapack routines that operate on @xmath74 and @xmath125 require them to be stored in the two dimensional block cyclic pattern . in order to support these two types of data storage",
    ", we have implemented a rather general communication framework that only requires the programmer to specify the desired non - local data .",
    "this framework then automatically fetches the data from the processors that store them locally .",
    "the actual communication is mostly done using asynchronous communication routines and .",
    "the new method is implemented with hartwigsen - goedecker - hutter ( hgh ) pseudopotential  @xcite , with the local and nonlocal pseudopotential implemented fully in the real space  @xcite .",
    "finite temperature formulation of the kohn - sham density functional theory  @xcite is used , and the temperature is set to be @xmath129k only for the purpose of accelerating the convergence of scf iteration . since finite temperature is used , the accuracy is quantified by the error of the total free energy  @xcite per atom .",
    "hgh pseudopotential has analytic expression , which allows us to minimize the effect of numerical interpolation and perform accurate comparison with existing electronic structure code .",
    "we compare our result with abinit  @xcite which also supports hgh pseudopotential .",
    "the albs and eos start from random initial guess , and are refined iteratively in the scf iteration together with the electron density . in all the calculations , anderson mixing  @xcite with kerker preconditioner  @xcite are used for the scf iteration .",
    "gamma point brillouin sampling is used for simplicity . in section  [ sec : alb ] and section  [ sec : eo ] , we count the number of basis functions in terms of the number of albs per element and the number of eos per element . in this section",
    ", we count the number of albs and eos per atom instead , in order to be consistent with literature .",
    "all computational experiments are performed on the hopper system at the national energy research scientific computing ( nersc ) center .",
    "each hopper node consists of two twelve - core amd `` magnycours '' 2.1-ghz processors and has 32 gigabytes ( gb ) ddr3 1333-mhz memory .",
    "each core processor has 64 kilobytes ( kb ) l1 cache and 512 kb l2 cache .",
    "it also has access to a 6 megabytes ( mb ) of l3 cache shared among 6 cores .    as mentioned earlier ,",
    "the albs have been shown to achieve effective dimension reduction for quasi-1d systems , but with deteriorating performance as the dimensionality of the system increases  @xcite .",
    "using na as example , it has been shown that while @xmath5 albs per atom is enough to reach @xmath3 mev accuracy for quasi-1d systems , @xmath4 albs per atom is necessary to reach the same accuracy for 3d bulk systems . now using a 3d bulk na system with @xmath130 atoms as example , we illustrate that the number of basis functions per atom can be effectively reduced using eo .",
    "the supercell for na is simple cubic and the length of the supercell along each dimension is @xmath131 .",
    "a random perturbation with standard deviation @xmath132  is applied to each atom in the supercell to eliminate the translational invariance of the system .",
    "the supercell is partitioned into @xmath133 elements , with the length of each dimension of each element being @xmath134 .",
    "the length of each dimension of each extended element is @xmath135  which is @xmath136 times larger than that of the element .",
    "the penalty parameter @xmath137 in is set to be @xmath138 .",
    "the supercell is discretized with a uniform mesh of dimension @xmath139 in the real space .",
    "this mesh is used for representing both the electron density and the kohn - sham orbitals , which corresponds to a planewave cutoff of @xmath140 ry in the fourier space .",
    "abinit uses a dual grid for representing the kohn - sham wavefunctions and the electron density .",
    "the planewave cutoff for wavefunctions used in abinit is @xmath141 ry .",
    "this corresponds to a planewave cutoff for the electron density at @xmath142 ry , with a uniform mesh of dimension @xmath143 in the real space .",
    "the different numbers of grid points along each dimension come from the automatic grid adjustment in abinit .",
    "we remark that the grid size is chosen to be larger than the typical setup in electronic calculation for na to make sure that the error introduced by the grid size is small compared to that introduced by using albs and eos . inside each element",
    "a legendre - gauss - lobatto ( lgl ) grid of dimension @xmath144 is used for numerical integration in the assembly process of the discretized hamiltonian matrix @xmath74 .",
    "the error of the total free energy per atom only using albs is shown in fig .",
    "[ fig : naconv ] ( a ) .",
    "the error systematically decreases with the increase of the number of albs .",
    "when the number of albs exceeds @xmath145 , the error of the total free energy per atom is less than @xmath3 mev .",
    "element orbitals ( eos ) provide further dimension reduction compared to albs .",
    "[ fig : naconv ] ( b ) shows the difference of the free energy per atom calculated from eos and that from abinit .",
    "we construct eos from as many as @xmath146 albs per atom , following the criterion for the choice of the candidate functions and using a localization radius of @xmath147 .",
    "compared to a converged alb calculation , the error using only @xmath136 eos per atom is already within @xmath148 mev per atom . when @xmath149 eos are used , the total free energy calculated is essentially the same as that using @xmath146 albs , and the error compared to abinit is less than @xmath3 mev per atom . fig .",
    "[ fig : naconv ] ( b ) indicates that the eos are indeed effective for reducing the number of basis functions per atom for 3d bulk systems .     atoms .",
    "( b ) convergence of element orbitals ( eo ) for the same na system with fixed number of albs .",
    "( c ) convergence in terms of the localization radius for the same na system with fixed number of albs and fixed number of eos.,scaledwidth=50.0% ]    compared to alb , the eo approach introduces an additional parameter which is the localization radius . fig .",
    "[ fig : naconv ] ( c ) shows the error of the total free energy per atom using @xmath146 albs per atom , and @xmath149 eos per atom but with different localization radius . when the localization radius is @xmath150  which is @xmath151 the length of an element , the error of the total energy per atom is @xmath152 mev .",
    "moderate choice of the localization radius of @xmath147  ( @xmath153 of the length of an element ) yields accuracy around @xmath3 mev per atom .",
    "[ fig : naconv ] ( c ) shows that our method is stable even for a large localization radius @xmath154  ( @xmath155 of the length of an element ) , and the error is even smaller and is below @xmath3 mev per atom .",
    "we also remark that if the localization radius is further increased , the eos are no longer localized around the element , but become fully extended in the extended element .",
    "this can lead to an unstable scheme with large error .",
    "[ fig : naconv ] ( c ) shows that the accuracy of the eo is not very sensitive to the choice of localization radius .",
    "eos can resemble atomic orbitals but with local modifications reflecting the environmental effect , despite the fact that they are constructed in the extended elements with rectangular domain . using the same na system as example",
    ", we show in fig .",
    "[ fig : basis ] the isosurface of the first @xmath156 element orbitals ( @xmath157 to @xmath158 ) belonging to the same extended element , with the red and blue color indicating the positive and negative part of the eos , respectively .",
    "@xmath159 atoms nearest to these eos within a sphere of radius @xmath147  are also plotted in fig .",
    "[ fig : basis ] as gold balls .",
    "we see that @xmath160 mimics @xmath161 orbital , @xmath162-@xmath163 mimic @xmath164-orbitals , and @xmath165-@xmath158 mimic @xmath49-orbitals . both the general shape and the multiplicity of the element orbitals agree well with the physical intuition .",
    "we also find that hybridization of the @xmath166 orbitals naturally appears in the eos , reflecting the effect of the environment .",
    "for example , the isosurface of @xmath160 exhibits `` holes '' around atoms .",
    "these holes are not described in the spherical symmetric @xmath161 atomic orbital , but can only be reflected in orbitals of higher angular momentum such as @xmath49 orbitals .",
    "therefore , eos are natural generalization of atom - centered orbitals , with both the atomic and environmental effect taken into account simultaneously .",
    "element orbitals belonging to the same extended element , for a 3d bulk na system with @xmath130 atoms .",
    "the @xmath159 na atoms nearest to the element orbitals within a sphere of radius @xmath147  are plotted as gold balls .",
    "the positive and negative part of the element orbitals are represented by red and blue color , respectively.,title=\"fig:\",scaledwidth=50.0% ]    eos are localized in the extended elements . since",
    "each candidate function is not continuous across the boundary of the extended element , eos are still discontinuous across the boundary of the extended element .",
    "nonetheless , the eos are `` qualitatively continuous '' at the boundary of the extended elements .",
    "[ fig : basis1d ] ( a ) shows the behavior of @xmath167 for the na system along one @xmath168 $ ] direction , with the zoom - in near the boundary of the extended element shown in fig .  [ fig : basis1d ] ( b ) .",
    "eos are very close to a continuous function especially for @xmath160 and @xmath163 with lower angular momentum .",
    "the value of eos of higher angular momentum such as @xmath169 at the grid point closest to the boundary of the extended element is within @xmath170 .",
    "( blue solid line),@xmath163 ( red dashed line ) , and @xmath169 ( black dot dashed line ) along one @xmath168 $ ] direction of a 3d bulk na system with @xmath130 atoms .",
    "the two red circles indicate the boundary of the extended element .",
    "( b ) zoom - in of ( a ) to the region near the boundary of the extended element . the same set of element orbitals @xmath160 ( blue solid line with circles ) ,",
    "@xmath163 ( red dashed line with triangles ) and @xmath169 ( black dot dashed line with diamonds ) are shown , with the symbols indicating the position of the numerical grids .",
    "the red circle indicates the boundary of the extended element.,title=\"fig:\",scaledwidth=50.0% ]    eos can be used for calculating the relative energies of different atomic configurations .",
    "[ fig : latconst ] ( a ) shows the total free energy per atom for a crystal of na consisting of @xmath171 unit cells with @xmath130 atoms .",
    "each unit cell is body centered cubic with @xmath172 na atoms .",
    "the lattice constant ranges from @xmath173  to @xmath174 .",
    "the size of each element is equal to that of one unit cell .",
    "@xmath5 eos per atom are constructed from @xmath146 albs per atom and are used for calculating the total free energy .",
    "the planewave cutoff for kohn - sham wavefunctions in abinit is @xmath141 ry .",
    "the difference of the total energy per atom is less than @xmath172 mev across all the lattice constants .",
    "similar result can be obtained for si .",
    "the supercell for si contains @xmath175 unit cells with @xmath176 atoms in total .",
    "each unit cell is diamond cubic with @xmath177 si atoms .",
    "[ fig : latconst ] ( b ) reports the total free energy per atom for lattice constants from @xmath178  to @xmath179 .",
    "each element only covers @xmath180 unit cells .",
    "we remark that elements occupying a fraction of the unit cell are allowed , which is important especially when eos are applied to systems with defects and disorderedness .",
    "the planewave cutoff for kohn - sham wavefunctions in abinit is set to be @xmath181 ry to achieve the high accuracy as benchmark solution .",
    "the localization radius is also @xmath147 . starting from @xmath182 albs per atom ,",
    "@xmath183 eos per atom are computed .",
    "the difference of the total free energy per atom is less than @xmath3 mev for all lattice constants .",
    "atoms ( a ) and 3d bulk si system with @xmath176 atoms ( b ) , with different lattice constants calculated from abinit and from element orbitals.,title=\"fig:\",scaledwidth=50.0% ]    eos are also effective for calculating the total energy of systems with defects . for a crystal na system with @xmath130 atoms and the length of each dimension of the supercell being @xmath131 ,",
    "the total free energy evaluated using abinit is @xmath184 .",
    "using the same setup as done in the crystal system with @xmath5 eos per atom , the total free energy evaluated using eo is @xmath185 .",
    "the difference is as small as @xmath186 mev per atom .",
    "since our implementation takes the spin - unpolarized form , we consider a system with two vacancies by removing @xmath172 na atoms belonging to one unit cell from the supercell .",
    "all the parameters are the same as those for the calculation of the crystal system .",
    "the total free energy evaluated using abinit is @xmath187 , and the total free energy evalauted using @xmath5 eos per atom is @xmath188 , with the difference being @xmath189 mev per atom .",
    "the error for both the crystal and the defect system is less than @xmath3 mev per atom .",
    "we also estimate the formation energy of @xmath190 neutral vacancies by @xmath191 with @xmath192 being the free energy for the crystal system with @xmath6 atoms , and @xmath193 being the free energy for the same system but with @xmath190 atoms removed .",
    "atomic relaxation is not taken into account at this stage .",
    "using , the formation energy calculated from abinit is @xmath194 ev , and that calculated from eo is @xmath195 ev . the difference of the formation energy is @xmath196 ev , and the relative error of the formation energy is @xmath197 .",
    "the calculation of the defect formation energy for si is as follows . for a crystal si system with @xmath176 atoms and the length of each dimension of the supercell being @xmath198 ,",
    "the total free energy evaluated using abinit is @xmath199 , and the total free energy evaluated using @xmath183 eos per atom is @xmath200 .",
    "the difference is as small as @xmath201 mev per atom .",
    "a defect system is constructed by removing one si atom , and all the parameters are the same as those for the crystal calculation .",
    "the total free energy evaluated using abinit is @xmath202 , and the total free energy evaluated using @xmath183 eos per atom is @xmath203 , with the difference being @xmath204 mev per atom . the error for both the crystal system and that for the defect system is less than @xmath3 mev per atom .",
    "the formation energy calculated from abinit is @xmath205 ev , and that calculated from eo is @xmath206 ev . the difference of the formation energy is @xmath207 ev , and the relative error of the formation energy is @xmath208 .",
    "c atoms ( cyan balls ) with @xmath3 c atom substituted by a si atom ( gold ball ) .",
    "each black box represents an element .",
    "( a ) the first element orbital @xmath160 ( green ) for the upper element with @xmath172 c atoms , and the first element orbital @xmath160 ( red ) for the lower element with @xmath3 c atom and @xmath3 si atom .",
    "( b ) the second element orbital @xmath162 ( green for the positive part and black for the negative part ) for the upper element with @xmath172 c atoms , and the second element orbital @xmath162 ( red for the positive part and blue for the negative part ) for the lower element with @xmath3 c atom and @xmath3 si atom.,title=\"fig:\",scaledwidth=50.0% ]    next we study graphene sheet consisting of @xmath209 c atoms ( cyan balls ) , with @xmath3 c atom replaced by a si atom ( gold ball ) , as shown in fig .",
    "[ fig : graphenebasis ] .",
    "the length of the supercell is @xmath210 , @xmath211  and @xmath212  for @xmath213 directions , respectively .",
    "the c and si atoms are in the @xmath214 plane .",
    "the supercell consists of @xmath215 elements , with each element containing @xmath172 atoms , and represented by one black box .",
    "the length of each element is therefore @xmath216 , @xmath217  and @xmath218  along @xmath213 directions , respectively .",
    "the shape of the eos is shown in fig .",
    "[ fig : graphenebasis ] ( a ) for the first eos @xmath160 belonging to @xmath172 different elements , and ( b ) for the second eos @xmath162 belonging to the same @xmath172 elements , respectively .",
    "we find that @xmath160 in the upper element reflects the c - c bond and @xmath160 in the lower element reflects the c - si bond , respectively .",
    "similarly , @xmath162 reflects the @xmath219 bonds in both the upper and the lower elements .",
    "the shape of the eos agree well with the physical intuition .",
    "in particular , the element orbitals are not centered around individual atoms but correspond directly to chemical bonds , which are of lower energy than individual atomic orbitals .",
    "[ fig : graphenebasis ] shows that the eos constructed from a complete basis set such as planewaves provides a more flexible treatment of chemical environment than atom centered orbitals .",
    "the total free energy calculated using abinit with a planewave cutoff at @xmath220 ry is @xmath221 .",
    "@xmath222 eos per atom contracted from @xmath4 albs per atom with localization radius being @xmath223 .",
    "the total free energy calculated using eo is @xmath224 .",
    "the difference in the total free energy per atom is @xmath225 mev .",
    "a more complicated example is a graphene sheet with @xmath176 c atoms , and with @xmath226 of the c atoms randomly selected and replaced by si atoms .",
    "the atomic configuration is shown in fig .",
    "[ fig : graphenedensity ] ( a ) , with the c atoms represented by cyan balls and si atoms represented by gold balls , respectively .",
    "the atoms are all in the @xmath214 plane , and the dimension of the supercell is @xmath210 , @xmath227  and @xmath228  along @xmath213 directions , respectively . the electron density in the @xmath214 plane is shown in fig .  [ fig : graphenedensity ] ( b ) .",
    "the total free energy calculated from abinit is @xmath229 , and the total free energy calculated from eo with @xmath222 eos per atom for all elements is @xmath230 .",
    "the error of the total free energy per atom is @xmath231 mev per atom .",
    "c atoms ( cyan balls ) , with @xmath226 c atoms randomly selected and substituted by si atoms ( gold balls ) .",
    "( b ) the electron density across @xmath214 plane.,title=\"fig:\",scaledwidth=50.0% ]    the fact that a small number of eos per atom already achieve high accuracy allows us to perform calculations for systems of large size .",
    "here we study 3d bulk na systems of various sizes , ranging from @xmath226 atoms to @xmath232 atoms .",
    "the length of the supercell along each dimension is also proportional to the system size , from @xmath233  for @xmath226 atoms to @xmath234  for @xmath232 atoms .",
    "the number of processors ( computational cores ) used is chosen to be proportional to the number of atoms , with @xmath235 processors used for @xmath226 atoms , and @xmath236 processors used for @xmath237 atoms .",
    "@xmath5 eos per atom are constructed from @xmath146 albs per atom for all calculations .",
    "the total time per scf iteration is shown in fig .  [ fig : na3dtime ] .",
    "we find that even though the number of atoms increase by a factor of @xmath238 , the wall clock time only increases by less than @xmath5 times from @xmath239 sec for @xmath226 atoms to @xmath240 sec for @xmath232 atoms .",
    "the small increase of the total wall clock time is because the time for solving the generalized eigenvalue problem  , which is asymptotically the computationally dominating part , only takes less than @xmath138 sec even for system as large as @xmath237 atoms , thanks to the small number of basis functions per atom allowed to be used in the calculation .",
    "the time for generating the albs using lobpcg and the time for constructing the eos from the albs are flat for all systems , since these steps are localized in each extended element and the computational cost is independent of the global system size .",
    "the overall time for solving the generalized eigenvalue problem   has not dominated the computational time for @xmath237 atoms with a hamiltonian matrix of size @xmath241 .",
    "however , the wall clock time for this part already scales quadratically with respect to the number of atoms .",
    "since the number of processors scale linearly with respect to the system size , the overall time for solving the generalized eigenvalue problem scales cubically with respect to the system size , and will eventually dominate the overall running time for systems of larger size .",
    "the overhead of the dg calculation involves the assembly of the dg matrix @xmath74 , the construction of the hamiltonian matrix @xmath242 and the mass matrix @xmath243 using parallel matrix - matrix multiplication , as well as the communication time .",
    "as alluded to earlier , the parallel matrix - matrix multiplication treats @xmath125 and @xmath74 as dense matrices in the current implementation .",
    "therefore the asymptotic scaling of this part has the same asymptotic cubic scaling as solving the generalized eigenvalue problem . all the rest of the computational time ( classified as `` other time '' in fig .",
    "[ fig : na3dtime ] ) mainly includes constructing the electron density using in the global domain , solving the kohn - sham potential from the electron density , charge mixing as well as the extra data communication .",
    "atoms to @xmath232 atoms .",
    "the breakdown of the total computational time includes the time for using lobpcg to generate adaptive local basis functions ( blue dashed line with diamonds ) , the time for constructing the element orbitals from adaptive local basis functions ( black dot dashed line with circles ) , the time for solving the generalized eigenvalue problem using dense scalapack solver ( green solid line with left - pointing triangles ) , the overhead time for solving the dg problem ( magenta dashed line with right - pointing triangles ) , and the rest of the time in a scf iteration ( cyan dot dashed line with stars).,title=\"fig:\",scaledwidth=35.0% ]    we also remark that treating the hamiltonian matrix as dense matrices greatly increases the memory cost and the communication volume .",
    "[ fig : namemorycommunication ] ( a ) shows the amount of memory used per processor . when the number of atoms is @xmath232 , the memory used per processor is @xmath244 gb , which becomes the bottleneck for further increasing the system size , despite that the computational time per scf is still within affordable range . the communication volume , indicated by the percentage of the communication time within the total computational time is shown in fig .",
    "[ fig : namemorycommunication ] ( b ) .",
    "the communication time occupies more than @xmath245 of the total time for systems with @xmath232 atoms .",
    "both the large memory cost and the large communication volume is largely due to the treatment of @xmath125 and @xmath74 as dense matrices , and shall be improved in the future work .",
    "atoms to @xmath232 atoms.,title=\"fig:\",scaledwidth=50.0% ]",
    "in conclusion , we have introduced the element orbitals for discretizing the kohn - sham hamiltonian in the pseudopotential framework , which are contracted automatically from a uniform basis set . comparing with the existing contracted basis sets , element orbitals",
    "incorporate environment information by including directly all atoms in the neighboring elements on the fly .",
    "the implementation of element orbitals is straightforward thanks to the rectangular partitioning of the domain .",
    "the accuracy of element orbitals are systematically improvable and the same procedure can be applied to systems under various conditions .",
    "the element orbitals are constructed by solving ksdft locally in the real space , and localized on each element via a localization procedure .",
    "we remark that the localization procedure used for constructing the element orbitals is not grounded on the near - sightedness property as in the linear scaling methods for insulating systems  @xcite .",
    "instead of finding the compact representations for the kohn - sham invariant subspaces  @xcite , the current work seeks for a set of compact basis functions in the real space , while the coefficients of the basis set for representing the kohn - sham orbitals can still be delocalized . as is shown by the numerical examples ,",
    "the current procedure is applicable to both insulating and metallic systems .",
    "our numerical examples also indicate that treating @xmath125 and @xmath74 as dense matrices can greatly increase the memory cost , the communication volume and the computational time especially for systems of large size .",
    "the future improvement includes treating @xmath125 and @xmath74 as sparse matrices so that the construction of the hamiltonian matrix @xmath242 and the mass matrix @xmath243 is of linear scaling . by treating @xmath125 and @xmath74 as sparse matrices",
    ", we can also incorporate the recently developed pole expansion and selected inversion type fast algorithms  @xcite to reduce the asymptotic scaling for solving the generalized eigenvalue problem   from cubic scaling to at most quadratic scaling for 3d bulk systems .",
    "we also remark that the current procedure for constructing the orbitals from adaptive local basis functions is still a costly procedure inside each element .",
    "method for generating element orbitals directly inside the extended element is also under our exploration .",
    "this work is partially supported by nsf career grant 0846501 ( l.  y. ) , and by the laboratory directed research and development program of lawrence berkeley national laboratory under the u.s .",
    "department of energy contract number de - ac02 - 05ch11231 ( l.  l. ) .",
    "the authors thank jianfeng lu for helpful discussions , and national energy research scientific computing center ( nersc ) for the support to perform the calculations .",
    "l.  l. also thanks weinan e for encouragement , and the university of texas at austin for the hospitality where the idea of this paper starts ."
  ],
  "abstract_text": [
    "<S> we present a method to discretize the kohn - sham hamiltonian matrix in the pseudopotential framework by a small set of basis functions automatically contracted from a uniform basis set such as planewaves . </S>",
    "<S> each basis function is localized around an element , which is a small part of the global domain containing multiple atoms . </S>",
    "<S> we demonstrate that the resulting basis set achieves mev accuracy for 3d densely packed systems with a small number of basis functions per atom . </S>",
    "<S> the procedure is applicable to insulating and metallic systems . </S>"
  ]
}