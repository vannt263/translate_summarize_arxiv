{
  "article_text": [
    "in solar physics one of the most important subjects is related to the dynamics of the plasma in the solar atmosphere .",
    "specifically , phenomena which are related to the propagation of magnetohydrodynamic waves ( e. g. alfvn , slow , fast magnetoacoustic ) , and transients ( e. g. vortices , jets , spicules ) .",
    "recent observations based on data provided by current space missions , such as transition region and coronal explorer ( trace ) , solar dynamics observatory ( sdo ) , solar optical telescope ( sot ) , x - ray telescope ( xrt ) and swedish solar telescope ( sst ) @xcite have enhanced the study of these phenomena in the solar atmosphere .",
    "the type of effects in the solar atmosphere are considered when the plasma is fully ionized and therefore the ideal mhd equations represent a good model .",
    "however in this limit , these equations are highly non - linear and numerical simulations are essential , where accurate numerical algorithms play an important role . over the recent years a number of codes have been used to understand various effects in the solar atmosphere . for instance , in the authors used a modification of athena code @xcite to study vertical oscillations of solar coronal loops and magnetoacoustic waves in a corollarygravitationally stratified solar atmosphere . in the authors use a modification of the flash code to simulate the propagation of mhd waves in two and three dimensions .",
    "moreover in @xcite the authors study the propagation of alfvn waves in the solar atmosphere using the pluto code @xcite .",
    "wave phenomena in the solar atmosphere have influenced the development of numerical codes dedicated specifically to study mhd wave propagation , e.g. the vac code @xcite , which is capable to simulate the interaction of any arbitrary perturbation with a magnetohydrostatic equilibrium background .",
    "the surya code @xcite , allows to study the propagation of waves in a stratified non - isothermal magnetic solar atmosphere , in particular in the chromosphere - corona interface .",
    "numerical simulations also permit to analyze some transient effects , for example in using flash , the authors simulate the formation of spicules and macrospicules in the solar atmosphere .",
    "in addition in @xcite the authors propose a model for jet activity that is commonly observed in solar corona .",
    "also the 3d ideal mhd equations are used to model the magnetic reconnection producing massive and high - speed jets @xcite .    even though all the aforementioned codes are available , well documented and can be applied to various problems , we present our new application , with convergence tests and error analyses .",
    "our code is at the moment useful to study solar phenomena in the photosphere - corona region , however with plan to generalize it to deal with magnetic reconnection and solar jets including radiative processes .",
    "the paper is organized as follows . in section [ sec : mhd ] we describe the ideal mhd equations and mention the numerical methods implemented in our code . in section [ sec : tests ] we show the standard tests in 1d and 2d dimensions . as a solar test in 2d",
    "we study the transverse oscillations of alfvnic pulses in the solar coronal loops .",
    "we also present as a 3d test the propagation of mhd waves in a gravitationally non - isothermal solar atmosphere .",
    "finally , in section [ sec : conclusions ] we mention some final comments .",
    "we consider the set of the ideal mhd equations submitted to an external constant gravitational field .",
    "we choose to write down these equations in a conservative form , which is optimal for our numerical methods :    @xmath0    where @xmath1 is the plasma mass density , @xmath2 is the total ( thermal + magnetic ) pressure , @xmath3 represents the plasma velocity field , @xmath4 is the magnetic field , @xmath5 is the unit matrix and @xmath6 is the total energy density , that is , the sum of the internal , kinetic , and magnetic energy density    @xmath7    the internal energy term is calculated considering an equation of state of an ideal gas    @xmath8    where @xmath9 is the internal energy density and @xmath10 is the adiabatic index .",
    "this equation also serves to close the system of equations ( [ density])-([divergenceb ] ) . in solar surface problems",
    "one considers the gravitational source term given by @xmath11 $ ] with magnitude @xmath12 m/@xmath13 , which is the value of the constant gravitational acceleration on the solar surface .",
    "these equations are written in units such that @xmath14 .",
    "it is also convenient to write the equation of state in terms of the temperature , that is    @xmath15    where @xmath16 is boltzmann s constant , @xmath17 is the mean particle mass defined in terms of the mean atomic weight @xmath18 in the following way @xmath19 , where @xmath20 is the proton mass .",
    "the above mentioned system of equations ( [ density])-([divergenceb ] ) can be written as a first - order hyperbolic system of flux - conservative equations , which in cartesian coordinates reads    @xmath21    with @xmath22 a vector of conservative quantities    @xmath23    and @xmath24 , @xmath25 and @xmath26 are the fluxes along each spatial direction    @xmath27,\\ ] ]    @xmath28,\\ ] ]    @xmath29.\\ ] ]    finally the source vector @xmath30 is given by    @xmath31.\\ ] ]      the numerical methods used to solve the mhd equations require the characteristic information from the jacobian matrices associated to the system of equations ( [ eq : conservative ] )    @xmath32    as we can see , @xmath25 and @xmath26 can be obtained from an adequate index permutation of @xmath24 .",
    "therefore , @xmath33 and @xmath34 have similar characteristic structure as @xmath35 .",
    "the set of eigenvectors for the jacobian matrices has been well stablished and extensively studied by several authors .",
    "the corresponding eigenvalues for @xmath35 , following the @xmath36 eigen - system of powell @xcite are given by    @xmath37    where @xmath38 is the alfvn speed    @xmath39    @xmath40 and @xmath41 are the fast and slow magnetoacoustic speeds respectively    @xmath42^{1/2 } , \\\\",
    "\\nonumber c_s & = & \\left[\\frac{1}{2}\\left(a^2 + \\frac{b^2}{\\rho } - \\sqrt{\\left(a^2 + \\frac{b^2}{\\rho}\\right)^2 - 4a^2c_a^2 }    \\right ) \\right]^{1/2}\\end{aligned}\\ ] ]    and @xmath43 is the sound speed .",
    "finally , similar expressions are found for @xmath33 and @xmath34 .",
    "we solve numerically the magnetized euler equations given by the system ( [ density])-([divergenceb ] ) on a single uniform cell centered grid , using the method of lines with a third order total variation diminishing runge - kutta time integrator ( rk3 ) . in order to use the method of lines , the right hand sides of mhd equations",
    "are discretized using a finite volume approximation with high resolution shock capturing methods . for this",
    ", we first reconstruct the variables at cell interfaces using the minmod and mc linear piecewise second - order reconstructors , and the fifth - order weighted essentially non oscillatory ( weno5 ) method , that uses a polynomial interpolation with a fifth order precision for smooth distributions and third order at strong shocks . even though the accuracy of the rk3 dominates over a high order accuracy reconstructor during the time integration ,",
    "we include weno5 because it introduces a small amount of dissipation .    on the other hand ,",
    "the numerical fluxes are built with the harten - lax - van - leer - einfeldt ( hlle ) approximate riemann solver formula , using the left and right states of the primitive and conservative reconstructed variables @xcite .",
    "the hlle approximate solver uses a two - wave approximation to compute the fluxes across the discontinuity at the cell interfaces , including those of the magnetic and hydrodynamic waves .",
    "such waves move with the highest and lowest velocities that correspond to eigenvalues of the jacobian matrix .",
    "these numerical methods were implemented successfully in relativistic mhd , where we have studied different phenomena with fixed and dynamic background space - times , including the presence of black holes @xcite .    additionally , in order to preserve the constraint ( [ divergenceb ] ) and avoid the violation of maxwell s equations ( i.e. the development of unphysical results like the presence of magnetic charges ) we use the flux constraint transport ( flux - ct ) algorithm .",
    "the flux - ct method is adapted to the conservative scheme computing the fluxes at cell vertex as an average of the fluxes at intercell boundaries and resulting in a cell - faced evolution equation of the components of the magnetic field .",
    "this scheme maintains the divergence of the magnetic field computed at cell corners to round - off accuracy along the numerical evolution .",
    "the details of the numerical implementation can be found in @xcite and other divergence constraint control methods are summarized in @xcite .",
    "we include a set of 1d and 2d tests that involve the evolution with the gravitational field switched off .",
    "the solar tests include 2.5d and 3d tests involving the propagation of mhd waves in the solar atmosphere submitted to a constant gravitational field along the vertical direction .      in order to illustrate how our implementation handles the evolution of a magnetized gas , in this subsection we present the standard shock tube tests in one direction .",
    "the 1d tests are riemann problems under various initial conditions and we compare the numerical results with the exact solution calculated in .",
    "we calculate the numerical solution of these tests using the hlle formula and the various limiters mentioned , in the domain @xmath44 $ ] with @xmath45 identical cells , a constant courant factor @xmath46 for the first test , and @xmath47 for the others .",
    "the reason to choose this value is that in order to compare among reconstructors used here , we use a value that can be handled by all of them .",
    "the initial discontinuity in this case is located at @xmath48 . in order to estimate the error between the numerical solution and the exact solution , we calculate the numerical solution using four spatial resolutions @xmath49 , @xmath50 , @xmath51 and @xmath52 . for these tests",
    "we are using the 3d code with four cells along the transverse directions .",
    "the various parameters of 1d tests are summarized in table [ tab : mhd_tests ] and we practiced this test for the three limiters mentioned .",
    "the brio - wu mhd shock tube problem tests the capability of a code to handle waves of various types , shocks , rarefactions , contact discontinuities and the compound structures of mhd . a snapshot of the wave structure at @xmath53 of the solution is shown in fig .",
    "[ fig : brio - wu ] . the left - moving fast rarefaction wave from @xmath54 to @xmath55 and the slow compound wave at @xmath56 are well captured .",
    "the contact discontinuity is captured at @xmath57 .",
    "finally the slow shock is captured at @xmath58 and fast rarefaction from @xmath59 to @xmath60 .",
    "test 1 : brio - wu shock tube problem at @xmath53 .",
    "we show the numerical solution for @xmath1 , @xmath61 and @xmath62 ( points ) and the exact solution ( line ) . in this case",
    "we use the minmod limiter.,width=226 ]      this test was introduced by .",
    "it is important to check on the ability of the numerical scheme to handle a fast shock , a rarefaction shock , a slow shock , a slow rarefaction , and a contact discontinuity . a snapshot of the evolution is displayed in fig . [ fig : ryu - jones_1b ] .",
    "our results show that fast shock at @xmath63 and the slow shock at @xmath64 are well captured .",
    "in addition the contact discontinuity appears at @xmath65 and the slow rarefaction is located at @xmath66 .",
    "finally the fast rarefaction is captured at @xmath67 .",
    "test 2 : ryu & jones 1b shock tube problem at @xmath68 .",
    "we show the numerical solution for @xmath1 , @xmath61 and @xmath69 ( points ) compared with the exact solution ( line ) .",
    "again we use the minmod limiter.,width=226 ]      this is a test containing magnetosonic rarefactions waves .",
    "the numerical solution shows only two strong and identical magnetosonic rarefractions .",
    "our code was able to capture this structure and the results are shown in fig .",
    "[ fig : ryu - jones_3b ] .",
    "test 3 : ryu & jones 3b shock tube problem at @xmath53 .",
    "we show the numerical solution for @xmath1 , @xmath70 and magnetic field @xmath62 ( points ) compared with the exact solution ( line).,width=226 ]      in order to compare the numerical solutions using different limiters implemented in our code , we have calculated the error for each 1d riemann test described above , and the results are summarized in table [ tab : mhd_error ] . in all the tests , with the three reconstructors used , our runs lie within the consistency regime , that is , the error decreases when resolution is increased . in order to go",
    "further we check for the order of convergence . for this",
    "we calculate the @xmath71 norm of the error as compared with the exact solution .",
    "since we always consider resolution factors of two , the order of convergence is given by @xmath72 , where @xmath73 is the error calculated with the resolution @xmath74 .",
    "thus we carried out the tests with four spatial resolutions .",
    "for all the tests we obtained near first order convergence as expected , considering all the initial data start with discontinuities and in table [ tab : mhd_error ] we show how the different reconstructors perform in the different tests .",
    "[ cols=\"^,^,^,^,^,^,^,^,^\",options=\"header \" , ]     [ table:1 ]      vertical perturbations in the sun could be generated by @xmath75-modes @xcite , which are pressure or acoustic modes with frequencies greater than 1 mhz .",
    "this kind of perturbation is given by the component @xmath76 in equation ( [ vz_perturbation ] ) .",
    "the initial pulse triggers longitudinal magnetoacoustic - gravity waves . at the initial point where the wave is launched",
    ", the gas pressure is greater than the magnetic pressure , which implies that @xmath77 .",
    "this excites fast and slow magnetoacoustic - gravity waves which are coupled .",
    "the initial pulse splits into two propagating waves at time @xmath78 s shown in fig .",
    "[ fig : vertical_perturbation_yz_xz ] ( top ) . at time @xmath79",
    "s , the two magnetocoustic waves move upwards until @xmath80 mm , in the same way as in fig . 3 of @xcite .",
    "the waves continue moving until they reach the transition region .",
    "this vertical perturbation produces the propagation of magnetoacoustic - gravity waves in a symmetric way , as shown in fig .",
    "[ fig : vertical_perturbation_yz_xz ] at the @xmath81 and @xmath82 planes . in these two planes",
    "the propagation is seen in the same way .",
    "we also show the propagation as seen from above , on the @xmath83 plane in fig .",
    "[ fig : vertical_perturbation_xy ] . even though the structure of the magnetoacoustic - gravity waves in the solar atmosphere looks complex , the value of @xmath84 at time @xmath85 s in the @xmath83 plane remains low as is shown in fig .",
    "[ fig : vertical_perturbation_xy ] .",
    "ccc @xmath78 s & @xmath79 s & @xmath85 s + & & +   + & &   +   + & &   +    ccc @xmath78 s & @xmath79 s & @xmath85 s + & & +   + & &   +   + &   +    we show snapshots of the fluid streamlines at times @xmath78 s and @xmath85 in fig .",
    "[ fig : streamlines_vertical_pert ] .",
    "these streamlines reveal vortices specially at time @xmath78 s , which are produced by the vertical perturbation @xmath76 and are located at 1 mm over the photosphere .",
    "temporal snapshots of streamlines at @xmath78 s ( top ) and @xmath85 s ( bottom ) for the case of vertical perturbation .",
    "color represents the vorticity magnitude.,title=\"fig:\",width=226 ]    temporal snapshots of streamlines at @xmath78 s ( top ) and @xmath85 s ( bottom ) for the case of vertical perturbation .",
    "color represents the vorticity magnitude.,title=\"fig:\",width=226 ]      horizontal perturbations in the solar atmosphere can be generated due to granular cells as a result of convection toward the photosphere . in this case",
    "we simulate these waves by exciting the @xmath70 component in equation ( [ vx_perturbation ] ) .",
    "this initial pulse excites all mhd waves which are affected by the gravitational constant field . since early times",
    "we can see the magnetoacoustic - gravity waves propagating upwards in the @xmath81 plane as ligth yellow wave - fronts in fig .",
    "[ fig : horizontal_perturbation_yz_xz ] ( top ) . at time @xmath85",
    "s we can see the magnetoacoustic - gravity waves light yellow patches reaching the level @xmath86 mm as shown in the top of fig",
    ". 6 of @xcite . at time @xmath87",
    "s , the waves reach the transition region , which causes the appareance of a light blue patch in fig . [",
    "fig : horizontal_perturbation_yz_xz ] , but later on , they are reflected back . in order to see the propagation of the waves from different planes , we show @xmath70 projected on the @xmath81 and @xmath82 planes in fig .",
    "[ fig : horizontal_perturbation_yz_xz ] ( bottom ) .",
    "unlike the previous test , in this case the velocity is not symmetrical .",
    "moreover , the propagation of the waves seen from above show how the wave - fronts change their amplitudes until the reflection happens , this is shown in the top panel of fig .",
    "[ fig : horizontal_perturbation_xy ] . as in the previous case",
    "we show a snapshot of @xmath84 at time @xmath85 s in fig . [",
    "fig : horizontal_perturbation_xy ] ( bottom ) .",
    "ccc @xmath88 s & @xmath85 s & @xmath87 s + & & +   + & &   +   + & &   +    ccc @xmath88 s & @xmath85 s & @xmath87 s + & & +   + & &   +   + &   +    in this case we also show snapshots of the fluid streamlines at times @xmath88 s and @xmath85 s in fig . [ fig : streamlines_horizontal_pert ] .",
    "in the same way as in the case of the vertical perturbation , the horizontal perturbation generates vortices , but in this case the vorticity is more complex .",
    "it has been proposed that vortices are triggered by convective or granular motions @xcite .",
    "temporal snapshots of streamlines at @xmath88 s ( top ) and @xmath85 s ( bottom ) for the case of the horizontal perturbation .",
    "color represents the vorticity magnitude.,title=\"fig:\",width=226 ]    temporal snapshots of streamlines at @xmath88 s ( top ) and @xmath85 s ( bottom ) for the case of the horizontal perturbation .",
    "color represents the vorticity magnitude.,title=\"fig:\",width=226 ]",
    "we have presented a new code that solves the ideal mhd equations intended to model phenomena in the solar atmosphere .",
    "we have included standard 1d riemann problem tests and shown that the order of convergence lies within the expected range corresponding to the methods we use .",
    "we conclude from our analysis , that mc and weno5 perform better than the minmod limiter .",
    "we have also presented standards 2d tests including the orszag - tang vortex and a current sheet test problem showing magnetic reconnection . in these tests",
    "we have kept the magnetic field divergence free constraint under control , in all the tests near round - off error .",
    "we notice that , according to previous experience , due to the dissipation , minmod performs well and the mc and weno5 limiters allow more refined structures in general .",
    "the solar tests have been oriented to study wave propagation in a gravitationally stratified solar atmosphere .",
    "we track the transverse oscillations of alfvnic pulses in solar coronal loops in a 2.5d model , in adittion we study the propagation of mhd - gravity waves and vortices on a 3d solar atmosphere .",
    "these results were compared to previous results in the literature .",
    "we have also shown that the constraint has been kept under control .",
    "we have decided to use unigrid mode instead of mesh refinement in order to avoid the use of artificial viscosity at boundaries between refinement levels , which is used to damp out spurious oscillations .",
    "we also want to avoid the carbuncle effect at corners of refined grids . in order to carry out production runs with high resolution",
    ", we have parallelized our code .",
    "finally , the code is public and available under request at http://www.ifm.umich.mx/~cafe",
    "this research is partly supported by grant cic - umsnh-4.9 .",
    "a. c - o gratefully acknowledges a dgapa postdoctoral grant to universidad nacional autnoma de mxico ( unam )                              de pontieu b. , mcintosh s. w. , carlsson m. , hansteen v. h. , tarbell t. d. , schrijver c. j. , title a. m. , shine r. a. , tsuneta s. , katsukawa y. , ichimito k. , suematsu y. , shimizu t. , nagata s. , 2007 , sci , 318 , 1574                                                lora - clavijo f. d. , gracia - linares m. , guzmn f. s. , 2014 , mnras , 3 , 443 arxiv:1406.7233 [ astro-ph.ga ] lora - clavijo f .",
    "d. , guzmn f. s. , cruz - osorio a. , 2013 , jcap , 12 , 015 arxiv:1312.0989 [ astro-ph.co ] lora - clavijo f. d. , cruz - perez j. p. , guzmn f. s. , gonzalez j. a. , 2013 , rev .",
    "e 59 , 28 - 50 arxiv:1303.3999 [ astro-ph.he ]"
  ],
  "abstract_text": [
    "<S> we present a new code designed to solve the equations of classical ideal magnetohydrodynamics ( mhd ) in three dimensions , submitted to a constant gravitational field . the purpose of the code centers on the analysis of solar phenomena within the photosphere - corona region . </S>",
    "<S> we present 1d and 2d standard tests to demonstrate the quality of the numerical results obtained with our code . as solar tests we present the transverse oscillations of alfvnic pulses in coronal loops using a 2.5 d model , and as 3d tests we present the propagation of impulsively generated mhd - gravity waves and vortices in the solar atmosphere . </S>",
    "<S> the code is based on high - resolution shock - capturing methods , uses the hlle flux formula combined with minmod , mc and weno5 reconstructors . </S>",
    "<S> the divergence free magnetic field constraint is controlled using the flux constrained transport method .    </S>",
    "<S> [ firstpage ]    mhd - methods : numerical - sun : atmosphere </S>"
  ]
}