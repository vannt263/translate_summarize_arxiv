{
  "article_text": [
    "the paper first concisely sets out the model for spin - orbit coupling in , for instance , the sun - mercury system , as described by makarov  @xcite and further discussed by noyelles , frouard , makarov and efroimsky in  @xcite .",
    "we refer to this model as the nfme model throughout .",
    "we then describe a fast numerical algorithm , based on the high - order euler method ( hem ) introduced in  @xcite , for solving the spin - orbit ode incorporating the nfme model . after rigorous testing",
    ", we conclude that the proposed algorithm is about 7.5 times faster than simply using a general - purpose numerical ode solver .",
    "there are two main reasons for developing a fast algorithm for solving this version of the spin - orbit ode , bearing in mind that the ultimate objective is to establish , by monte carlo simulation , the probability of capture in the various attracting solutions of the ode .",
    "the first reason is that , since the dissipation in the problem is low , very long integration times  of the order of that of the formation of the planets  are needed in order to establish capture .",
    "the second reason is that to estimate capture probabilities with high confidence , solutions starting from many randomly - chosen initial conditions need to be considered : in fact , the width of the confidence interval decreases only as the square root of the number of solutions investigated . in most of the previous related work , for instance , @xcite , @xcite , @xcite , @xcite ,",
    "only about 1000 initial conditions were considered . by contrast , we are able to consider more than 50,000 here , for which the total computation time is of order two weeks .    the dynamics of the solutions of the spin - orbit ode with the nfme model are also interesting , and we discuss these in a separate paper  @xcite .    in  @xcite ,",
    "the authors point out how the model that they advocate describes more realistically the effect of tidal dissipation , in comparison with the much simpler constant time - lag ( ctl ) model .",
    "the latter has been used extensively in the literature since the seminal paper by goldreich and peale @xcite  see for instance  @xcite , @xcite , @xcite and @xcite for recent results on the basins of attraction of the principal attractors .",
    "a clear drawback of the ctl model is that , for the parameters of the sun - mercury system , the main attractor ( with 70% probability of being observed ) is quasi - periodic , with an approximate frequency of 1.256 .",
    "in fact , mercury is in a 3:2 spin - orbit resonance , and the ctl model indicates that the probability of this is only about 8% . on the other hand , with the nfme model , all attractors have mean velocity close to rational values , and about 42% of the initial data are captured by an attractor with mean velocity close to 3/2 .",
    "the greater realism of the nfme model comes at a cost , however :    1 .",
    "the nfme model is not smooth ; in fact , it is only @xmath0 in the angular velocity , @xmath2 , as we shall see .",
    "2 .   there is considerable detail to take into account in implementing the nfme model mathematically .",
    "3 .   the functions in the model",
    "take considerably more computation time to evaluate , and so numerical calculations are comparatively slow .",
    "the first point is important both for application of perturbation theory to the problem as well as for implementing an appropriate fast hem - type algorithm to solve the ode .",
    "both of these objectives are important .",
    "for instance , perturbation theory is a useful tool for obtaining any kind of analytical results for the dynamics ; and the motivation for faster algorithms has already been discussed above .    throughout this paper",
    ", the units for mass , length and time will be kg , km and earth years , yr , respectively .",
    "for ease of cross - referencing , an equation numbered ( n.@xmath3 ) in this paper is equation ( @xmath3 ) in  @xcite , modified if necessary .",
    "when we refer to a ` standard numerical method ' or ` numerical method ' for ode solving , we mean one of the family of well - known general purpose ode solvers ( e.g. runge - kutta , adams ) ; when we mean hem , which is of course also numerical , we refer to it explicitly by name .",
    "the ode is @xmath4 where @xmath5 is a measure of the inhomogeneity of the planet ( with @xmath6 for a homogeneous sphere ) , @xmath7 is the mass of the planet and @xmath8 is its radius .",
    "numerical values for these , and indeed all relevant parameters can be found in table  [ numvals ] .      the triaxiality - caused torque along the @xmath9-axis , @xmath10 , is a torque exerted on the planet by the gravitational field of the star , arising from the fact that the planet is not a perfect sphere .",
    "goldreich and peale  @xcite and nfme approximate @xmath11 by its quadrupole part , which is given by @xmath12 where the principal moments of inertia of the planet , along the @xmath3 , @xmath13 and @xmath9 axes respectively , are @xmath14 ; @xmath15 is its mean motion ; @xmath16 is the distance between the centres of mass of the star and the planet at time @xmath17 ; @xmath18 is the semi - major axis of the orbit of the planet ; @xmath19 is the sidereal angle of the planet , measured from the major axis of its orbit ; and @xmath20 is the true anomaly as seen from the star .",
    "we further define @xmath21 , the mean anomaly , which is such that @xmath22 , with a good approximation  @xcite being given by yr@xmath23 for mercury and the approximation yields @xmath24 yr@xmath23 . ] @xmath25 , where @xmath26 is the gravitational constant and @xmath27 is the mass of the star . hence , aside from a constant of integration which we set to zero , @xmath28 .",
    "the standard procedure from this point is to make the following pair of fourier expansions : @xmath29 where @xmath30 are the hansen coefficients , which depend on the orbital eccentricity @xmath31 .",
    "nfme compute them via  @xcite @xmath32 where @xmath33 , @xmath34 is the @xmath35-th order bessel function of the first kind , and @xmath36 with the binomial coefficients ( extended to all integer arguments ) being given by @xmath37    for convenience , we define the functions @xmath38 . then finally , @xmath39 in practice , nfme sum over @xmath40 .",
    "nfme forcefully point out the problems associated with the constant time - lag ( ctl ) model , which leads to a dissipation term of the form @xmath41 , with @xmath42 and @xmath43 constants .",
    "this model , among other things , can give rise to quasi - periodic solutions for the spin - orbit problem  @xcite , and the fact that these have not been observed in practice is evidence that the ctl model is in some way unphysical .",
    "nfme model tidal dissipation by expanding both the tide - raising potential of the star , and the tidal potential of the planet , as fourier series .",
    "the fourier modes are written @xmath44 , where @xmath45 are integers .",
    "appendix b of  @xcite justifies the simplification @xmath46 , @xmath47 , which arises from the smallness of the obliquity of the orbit ( axial tilt ) , in combination with an averaging argument .",
    "this then gives the following approximation for the polar component of the tidal torque : @xmath48.\\ ] ] here , @xmath49 ; @xmath50 , where both @xmath51 ( a positive definite , even function of the mode @xmath44 ) and @xmath52 ( an odd function of the mode ) are functions to be given shortly ; and @xmath53 is the usual signum function . hence ,",
    "overall , @xmath54 is an _",
    "odd _ function of @xmath3 .",
    "the reason why @xmath55 is written in this form is that it will turn out to depend on a _ fractional power _ of @xmath56 : the oddness of @xmath54 is thereby retained without raising a negative number to this fractional power .",
    "the additive error terms for this expression are @xmath57 , @xmath58 and @xmath59 , in which @xmath60 is the obliquity of the orbit and @xmath61 , which is @xmath62 , is a phase lag . for mercury , @xmath63 , @xmath64 and @xmath65 .",
    "nfme then make the additional approximation that , since the terms with @xmath66 oscillate , they naturally affect the detailed dynamics of the planet , but nonetheless , the overall capture probabilities are insensitive to them  @xcite . hence , the tidal torque is well approximated by the secular part only , i.e.  the @xmath67 terms ; this gives @xmath68 neglecting precessions , we have @xmath69 with @xmath70 , @xmath71 and @xmath72 . for the reasons mentioned earlier ,",
    "we consider only the mode @xmath73 .    finally , we give the nfme model for the quality function , @xmath74 .",
    "we use the abbreviation @xmath75 , in terms of which @xmath76 where @xmath77 with @xmath78 being the unrelaxed rigidity ; @xmath79 and @xmath80 in these expressions , @xmath81 is the usual gamma function , @xmath82 and @xmath83 are the andrade and maxwell times of the mantle respectively and @xmath84 is the andrade parameter .      in table",
    "[ numvals ] we give numerical values appropriate to the sun and mercury for the parameters introduced so far .",
    "we standardise the units to kg for mass , km for length and ( earth ) years for time .",
    "lll + name & symbol & numerical value + semimajor axis & @xmath18 & @xmath85 km + mean motion & @xmath15 & 26.0879 rad yr@xmath23 + planetary radius & @xmath8 & @xmath86 km + dimensionless m.o.i .",
    "( inhomogeneity ) & @xmath87 & 0.346 + triaxiality & @xmath88 & @xmath89 + planetary mass & @xmath7 & @xmath90 kg + unrelaxed rigidity & @xmath78 & @xmath91 kg km@xmath23 yr@xmath92 + present - day orbital eccentricity & @xmath31 & @xmath93 + andrade time & @xmath82 & @xmath94 yr + maxwell time & @xmath83 & @xmath94 yr + andrade parameter & @xmath84 & @xmath95 +   + triaxiality acceleration constant & @xmath96 & @xmath97 yr@xmath92 + tidal acceleration constant & @xmath98 & @xmath99 yr@xmath92 +   + mass of sun & @xmath27 & @xmath100 kg + gravitational constant & @xmath26 & @xmath101 kg@xmath23 km@xmath102 yr@xmath92 + triaxiality index range & @xmath103 & @xmath104 + tidal index range & @xmath105 & @xmath106 +      in order to study the spin - orbit problem further , it is convenient to introduce two quantities with the dimensions of angular acceleration @xmath107 taken individually , these quantities are not accelerations _ per se _  more correctly , they might be described as the triaxiality / tidal contributions to the angular acceleration , since , when computed on the solution @xmath19 , their sum is @xmath108 , as we shall see from equation  ( [ ode ] )  but for brevity , we refer to them as the triaxiality and tidal accelerations .",
    "we then define @xmath109 and @xmath110 for @xmath111 , so that @xmath112 where @xmath113 and @xmath114 and @xmath115 are defined in equation  ( [ rpip ] ) .    in terms of these angular accelerations ,",
    "the spin - orbit ode becomes @xmath116 and this is our starting point for the rest of the paper .",
    "we now look at the behaviour and magnitude of the various functions that go to make up the nfme model , using the values for the sun and mercury given in the table  [ numvals ] .       for @xmath117 ( the latter two values being for illustration ) and @xmath118 .",
    "note that , for all values of @xmath31 considered , ( i ) only @xmath119 is negative , and ( ii ) @xmath120 and is therefore not plotted . , width=288 ]    in figure  [ hansen ] we plot the hansen coefficients relevant to the problem , @xmath121 , for @xmath122 and 0.4 and for @xmath123 .",
    "these were computed from equation  ( [ hancomp ] ) by truncating the first sum at @xmath124 and using 20 significant figures for computation  these values allow the computation of the coefficients to a much higher precision than necessary .",
    "we first make a simple estimate of the order of magnitude of @xmath125 . treating @xmath126 and @xmath17 as independent variables , it is clear from equation  ( [ ttri ] ) that @xmath127 $ ] for all @xmath126 , @xmath17 , where @xmath128 we find @xmath129 , @xmath130 and @xmath131 yr@xmath92 .    in figure  [ triax ] we give a plot of @xmath132 for @xmath133 , @xmath134 , @xmath135 , the latter two values being ( almost arbitrarily ) chosen to approximate a solution starting from an angular velocity slightly greater than @xmath15 .",
    "note that @xmath136 $ ] , which is consistent with the estimate , from equation  ( [ dest ] ) , of @xmath137 $ ] when @xmath133 .     as a function of time , with @xmath133 , and @xmath138.,width=288 ]      we now discuss the tidal acceleration @xmath139 . throughout this section ,",
    "we take @xmath133 .",
    "figures  [ kink1][kink3 ] show the tidal acceleration , plotted vertically , versus the relative rate of rotation , @xmath140 .    , with @xmath133 , as given by equation  ( [ ddttid ] ) .",
    "` kinks ' occur at values @xmath141 , although those at @xmath142 are too small to see on this scale .",
    "note that the angular acceleration does not change sign at a kink for @xmath143.,width=288 ]    , as shown in figure  [ kink1 ] .",
    "the width of each plot is @xmath144 and the vertical range is @xmath145 yr@xmath92.,width=288 ]    this function is illustrated in figure  [ kink1 ] , which shows @xmath139 , plotted over the entire range of interest , @xmath146 $ ] .",
    "the dominant features here are the ` kinks ' , which occur at @xmath147 for @xmath148 , this being the range of the sum defining the tidal acceleration .",
    "the five ` kinks ' at which @xmath149 changes sign are those corresponding to @xmath150 , and , for the purpose of comparison , these are plotted over the same narrow range of @xmath151 , and on the same vertical scale , @xmath145 , in figure  [ kink2 ] .    , suggesting that the derivative is finite for all values of @xmath140.,width=288 ]    the fact that @xmath149 is continuous , even at a kink , is implied in figure  [ kink3 ] , in which @xmath149 has been plotted against @xmath140 for @xmath152 $ ] .",
    "however , the derivative @xmath153 displays a cusp at the values of @xmath140 corresponding to a kink , as is apparent from the definition of @xmath74 in equation  ( [ q2 ] ) , in particular from its dependence on @xmath154 .",
    "this is illustrated in figure  [ deriv ] .",
    "d@xmath149/d@xmath2 , showing the cusp at @xmath155.,width=288 ]",
    "we find several different solutions to the differential equation  ( [ ode ] ) , which one is observed depending on the initial conditions . as well as periodic solutions , some of the solutions we find appear , numerically at least , not to be simply periodic  we shall have more to say about these solutions in  @xcite . here , we just point out that we distinguish the different captured solutions from each other solely by their mean @xmath2 values , @xmath156 , defined by @xmath157 ; and that capture can take place in solutions for which a term in the sum  ( [ ttri ] ) , the triaxiality torque , is approximately zero , _",
    "i.e. _  for @xmath158 ,",
    "hence , we only expect solutions for which @xmath160 and @xmath161 .    in order to compute probabilities of capture by the different solutions , with small confidence intervals , via monte carlo simulation ,",
    "many solutions to equation  ( [ ode ] ) , starting from random initial conditions in the set @xmath162\\times [ { \\dot\\theta_{\\mathrm{min } } } , { \\dot\\theta_{\\mathrm{max}}}]$ ] , must be computed .",
    "many are needed because , for a given confidence level , the width of the confidence interval is proportional to @xmath163 , where @xmath164 is the number of solutions computed : more simulations narrow the confidence interval , but rather slowly .",
    "we take @xmath162\\times [ 0 , 5n]$ ] in what follows .",
    "the triaxiality acceleration depends on @xmath165 and so we need only consider @xmath166 $ ] ; and the right - most kink is at @xmath167 , so we choose the maximum value of @xmath168 to be somewhat greater than this .",
    "we now describe a fast algorithm for solving equation  ( [ ode ] ) , which is based on the high - order euler method ( hem ) , described in detail in  @xcite .",
    "this method has to be adapted for the nfme model because of the discontinuities in the second derivative of @xmath139  that is , at the centres of the kinks  that occur at @xmath169 .",
    "the adaptation we use requires that the subset @xmath170 of the @xmath171 phase plane be split into strips , all with @xmath172 , but with a variety of ranges of @xmath2 .",
    "this splitting is needed in order to meet the error criterion  see below .",
    "a strip can be of type h ( hem ) , when it is far enough removed from the kinks that the hem can be used ; and type n ( numerical ) , surrounding a kink , where a suitable numerical method has to be used . in a type n strip , there is a possibility that the ode is stiff , and the numerical method chosen should take this into account .",
    "are shown .",
    "a ` x ' shows the expansion point for a series solution .",
    "the width of a region in terms of @xmath140 over which the series solution is valid , for all @xmath126 , to within the error bounds ( see text ) is shown below the line .",
    "the strips are grouped into bands . in bands 0 and 9 there are four h strips and one n strip ; in the remaining bands , there are five h , and two n strips.,width=480 ]    the detail of this splitting is given in figure  [ bands ] , in which @xmath140 is plotted horizontally , with type h regions being shown as continuous lines , type n as dashed lines .",
    "the strips are grouped into ten bands , one band covering the region between two kinks .",
    "for instance , band 0 consists of four type h strips , centred on @xmath173 and @xmath174 and with widths @xmath175 and @xmath176 respectively ; and one type n strip , where @xmath177 $ ] , @xmath178 being the position of the first kink .",
    "the reasoning behind the choice of these values is given in sections  [ reg_a ] and  [ reg_n ] .",
    "the expansion point @xmath179 for the series solution is always the centre of the strip , and is shown by ` x ' in figure  [ bands ] .      the hem , which is a fixed timestep implementation of the frobenius method , can in principle be used to solve equation  ( [ ode ] ) in regions of the phase plane , @xmath171 , where the functions @xmath180 and @xmath149 are analytic . from its definition",
    ", @xmath125 is an entire function , so this is no bar to using the hem .",
    "however , @xmath139 is @xmath0 in @xmath2 , with its second derivative being undefined at @xmath181 .",
    "hence we approximate @xmath149 by its taylor series of degree @xmath182 about a point @xmath183 , bearing in mind that this will only be good for values of @xmath2 far from the kinks .",
    "in the work reported here , our error criterion ( see below ) is satisfied with @xmath184 for all strips .    with these provisos ,",
    "the hem works well .",
    "we briefly review the method here ; full details can be found in  @xcite .",
    "let the state vector @xmath185 and define @xmath186 where @xmath187 is a timestep .",
    "the ode allows us to compute , recursively , derivatives of @xmath19 of all orders , far from the kinks .",
    "let the @xmath188-th time derivative of @xmath19 be written as @xmath189 .",
    "we then write the degree-@xmath190 series solution to equation  ( [ ode ] ) as @xmath191 where @xmath192 ( @xmath193 gives the euler method ) , and @xmath194 .",
    "note that @xmath195 depends on @xmath17 as well as @xmath196 because the ode is non - autonomous .",
    "for the same reason , @xmath197 depends on @xmath60 . to satisfy the error criterion ,",
    "the following values of @xmath190 are used in the various bands :    [ cols=\"<,^,^,^,^,^,^,^,^,^,^ \" , ]",
    "it was not the main purpose of this paper to give results of the computation of probabilities of capture for various sets of parameters  rather , we wanted to show how this computation , in the case of constant eccentricity @xmath31 , can be accelerated .",
    "this requires us to solve the ode  ( [ ode ] ) , and bearing in mind that this is periodic in time with period @xmath198 , our objective is to compute the poincar map , which advances the state variables @xmath199 by a time @xmath200 , as fast as possible .",
    "this enables us to generate a sequence of values @xmath201 , from which salient information about the dynamics can be deduced .",
    "the dissipation term , @xmath139 , which is a @xmath0 function of the angular velocity @xmath2 , and additionally varies rapidly in the ranges of @xmath2 around the so - called ` kinks ' , complicates the computation , and requires the use of a standard numerical ode solver for some of the time .",
    "we point out ways in which these purely numerical computations can be carried out efficiently , by streamlining the calculation of the triaxiality and tidal accelerations .",
    "however , in about 88% of the phase plane the high - order euler method  @xcite can be used , and this speeds up the computation significantly .",
    "the present case should be contrasted with the constant time lag model , in which dissipation is just proportional to @xmath202 with @xmath43 a constant . in the light of its simplicity , this has been used in many publications , for instance , @xcite and references therein . in that case , only a single set of integrators @xmath203 , defined in equation  ( [ ppm ] ) , was needed to build up the poincar map . in other words , there was only one strip , which was the whole of @xmath170 , and the hem could be used everywhere .",
    "compare that with the current case using the parameters in table  [ numvals ] .",
    "here , @xmath170 has to be divided into 48 strips and an integrator set up for each .",
    "setting up the codes for the hem in each strip , which is done by computer algebra , itself takes significant time , but the pay - off is an increase in speed by a factor of approximately 65 in the strips where hem can be used , compared to using a standard numerical method .    a probability of capture computation requires a capture detection algorithm , and one has been described .",
    "it is based on the fact that after capture , the angular velocity has no underlying decay : a captured solution has a close to constant mean value of @xmath204 for all @xmath35 greater than the value at which capture takes place .",
    "typically , the mean is taken over @xmath205 successive @xmath35 values .    a test run of our algorithm , in which 57,600 initial conditions were iterated until capture took place , reveals that the overall speed of computation is faster by a factor of about @xmath1 compared to using a standard numerical algorithm alone .",
    "an important question left unanswered in this paper is ` what is the nature of the solutions in which capture takes place ? '",
    "the answer turns out to be more complicated than expected : periodic solutions with mean @xmath206 have been computed ( high - accuracy numerics are needed ) .",
    "there is also numerical evidence for the existence of attracting solutions whose period is not a small integer multiple of @xmath200 .",
    "the dynamics of solutions to equation  ( [ ode ] ) , both pre- and post - capture , will be subject of a future publication  @xcite ."
  ],
  "abstract_text": [
    "<S> we present an algorithm for the rapid numerical integration of a time - periodic ode with a small dissipation term that is @xmath0 in the velocity . </S>",
    "<S> such an ode arises as a model of spin - orbit coupling in a star / planet system , and the motivation for devising a fast algorithm for its solution comes from the desire to estimate probability of capture in various solutions , via monte carlo simulation : the integration times are very long , since we are interested in phenomena occurring on times similar to the formation time of the planets . </S>",
    "<S> the proposed algorithm is based on the high - order euler method ( hem ) which was described in  @xcite , and it requires computer algebra to set up the code for its implementation . </S>",
    "<S> the pay - off is an overall increase in speed by a factor of about @xmath1 compared to standard numerical methods . </S>",
    "<S> means for accelerating the purely numerical computation are also discussed . </S>"
  ]
}