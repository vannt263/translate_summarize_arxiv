{
  "article_text": [
    "the capture of stellar remnants - white dwarfs , neutron stars and black holes - by the massive black holes that are thought to reside at the centers of most galaxies provide an excellent laboratory for performing precision tests of general relativity .",
    "the large discrepancy in the masses allows the smaller body to be treated as a perturbation to the spacetime of the galactic black hole , and the evolution of the system can be treated analytically .",
    "the gravitational wave signals from these systems encode effects such as frame dragging , periastron advance , and spin - orbit coupling in highly modulated waveforms .",
    "the detection and characterization of these extreme mass ratio inspirals ( emris ) is a key science goal of future space based gravitational wave detectors such as lisa  @xcite .",
    "finding emri signals in the output of a noisy detector presents a challenging data analysis problem as the signals have to be followed for tens of thousands of cycles in order to accumulate sufficient signal - to - noise ratio ( snr ) for detection .",
    "it has been estimated  @xcite that it would take of order @xmath0 templates to perform an exhaustive matched - filter search for these signals .",
    "we either have to hope for a major advance in computing , or look for sub - optimal techniques to the emri detection problem .",
    "it is natural to consider hierarchical strategies that either work with some subset of the data ( for example , smaller time segments ) , or coarser parameter search grids that are then refined in the regions surrounding candidate detections . in ref .",
    "@xcite a stack - slide  @xcite search algorithm was put forward that combines both of these strategies , and it was estimated that with year 2013 computing resources it would be possible to detect systems with snrs greater than 30 , which is a factor of two or three worse than could be done with a fully coherent search . implementing the stack - slide algorithm is a non - trivial task , but it would be interesting to see how it performs on the simulated emri data sets that have been produced for the mock lisa data challenges ( mldcs )  @xcite .",
    "another approach to the emri detection problem is to use time - frequency techniques  @xcite to search for tracks in spectrograms of the data .",
    "this approach has the advantage of being computationally cheap , and it has been applied with some success to the mldc data sets  @xcite , but there are concerns about how it will perform when applied to more realistic data containing the signals from millions of galactic binaries , multiple massive black hole binaries and hundreds of emris .    here",
    "i describe a collection of techniques , that when combined , have proven effective at detecting blind emri signal injections in simulated lisa data .",
    "the techniques fall into two categories : the first are computational techniques that either `` soften up '' the likelihood function or speed up its calculation ; the second are stochastic search techniques that facilitate the efficient exploration of high dimensional spaces .",
    "the former are equally applicable to traditional grid based searches , while the latter provide a more efficient search strategy .",
    "the search strategy uses a hybrid of techniques from markov chain monte carlo and genetic algorithms .",
    "key elements of the algorithm are the use of multiple chains running at different `` temperatures '' , with communication between chains via metropolis - hastings exchange and genetic cross - over .",
    "the individual chains are updated by a mixture of techniques , including jumps along eigendirections of the fisher information matrix , differential evolution , mode jumping proposals between harmonics of the waveform , and hill climbing moves ( using conjugate gradient or nelder - mead ) .",
    "while this may sound like a `` kitchen sink algorithm '' , the various elements are not thrown together haphazardly : there is a method to the madness .",
    "the individual techniques were developed by researchers in many fields of science ( only the implementation of mode jumping described here is new ) , and almost all of the techniques have been used at one time or another in lisa data analysis studies ( mcmc , tempering , and fisher matrix based jumps were first introduced in ref .",
    "@xcite ; genetic algorithms and nelder - mead in ref .",
    "@xcite ; mode jumping in refs .",
    "@xcite ; and multiple tempered chains in ref .",
    "many of these techniques have also been studied in the context of ligo - virgo data analysis ( see _ e.g. _ refs .",
    "more important than the specific techniques being used are the basic principles on which the algorithm is based .",
    "the modular structure of the algorithm makes it easy to incorporate new techniques as they become available . a closely related approach to emri detection that shares a common heritage to the approach outlined here",
    "is described in ref .",
    "@xcite .",
    "i begin in section  [ sec : wavelike ] with a brief description of the emri waveforms used in this study and the techniques used to soften the likelihood surface and speed up the calculation .",
    "then in section  [ sec : search ] i describe the design of the search algorithm and the new approach to mode jumping .",
    "waveform models describing the inspiral of a small compact object into a much more massive kerr black hole have come along way in the past decade , but we are still lacking a complete description .",
    "for the purposes of data analysis development , the mldc taskforce adopted the philosophy of barack & cutler  @xcite , who argued that most of the features of the full analysis could be captured by considering `` kludge waveforms '' that are parameterized by the same 14 parameters as the exact model , and share the same qualitative features such as eccentricity , periastron precession , spin - orbit induced precession of the orbital plane and the loss of energy and angular momentum due to gravitational wave emission . on the other hand ,",
    "the barack - cutler kludge waveforms fail to capture relativistic effects such as `` zoom - whirl '' behavior  @xcite and non - adiabatic resonances  @xcite , so developing a data analysis algorithm that is capable of detecting these simpler signals is only a first step towards tackling the emri detection problem .",
    "a full description of the barack - cutler waveform model used in the mldc can be found in ref .",
    "the waveforms are described at any instant by a collection of harmonics @xmath1 of the azimuthal orbital frequency @xmath2 , the periapse precession frequency @xmath3 and the orbital plane precession frequency @xmath4 : @xmath5 where @xmath6 are integers . unlike the full emri waveforms , the kludge waveforms are limited to harmonics with @xmath7 and @xmath8 $ ] ( though this is from obvious in the precessing frame of ref .",
    "@xcite ) , and the relatively low eccentricity of systems considered in the mldc data sets allows us to ignore harmonics with @xmath9 . since @xmath4 is roughly an order of magnitude smaller than @xmath10 or @xmath3 , the harmonics come in bands of five labeled by @xmath11 .",
    "the frequency and amplitude of each harmonic evolve slowly over time as the system loses energy and angular momentum .",
    "the lisa response function imparts additional modulations on the waveform due to the motion of the detector about the sun .",
    "the codes used to generate the emri waveforms for the mldc data sets do not exploit the separation of timescales available in the problem , and as a result each waveform takes seconds to minutes to generate on the processors available today .",
    "when a waveform model is available , gravitational wave data analysis boils down to comparing a model waveform @xmath12 , described by parameters @xmath13 , to the observed time series @xmath14 .",
    "the goodness of fit is measured by the chi - squared @xmath15 , where @xmath16 denotes the noise weighted inner product . for gaussian noise",
    "the likelihood @xmath17 is proportional to @xmath18 .",
    "calculating the waveforms and noise weighted products directly using the tools provided by the mldc taskforce can cost minutes per point in parameter space , and with a complicated 14 dimensional parameter space to explore , the run time of a search can be prohibitive .",
    "thus , the first priority is to find ways to speed up the calculation of the likelihood , and if possible , reduce the dimension of the search .",
    "it is possible to dramatically speed up the likelihood calculation using variants of the techniques described in refs .",
    "the first step is to heterodyne the data using a collection of trial frequency evolution functions , @xmath19 , for each set of harmonics .",
    "the heterodyned data is then low pass filtered , which effectively throws away all the data that is not close to the @xmath19 evolution track ( as viewed in a time - frequency representation ) . for the mldc data sets most of the power is concentrated in the @xmath20 bands , and these are usually sufficient for detection purposes . to achieve an effective compression of the data we need @xmath19 to approximately follow the evolution of the @xmath21 harmonic , which depends on parameters such as the mass and spin of the central black hole , and the initial orbital frequency .",
    "to account for this , a coarse grid of heterodyne functions are used to generate multiple reduced data sets that are stored for later use .",
    "the template parameters @xmath13 are used to select the appropriate reduced data set for the likelihood calculation .",
    "since the heterodyning procedure takes out most of the frequency evolution , the emri signal now looks like a collection of galactic binaries ( albeit ones that have a slowly changing amplitude and polarization ) , and it is possible to generate the individual harmonics directly in the fourier domain using a slightly modified version of the fast galactic binary generator described in ref .",
    "the net result is a likelihood calculator that runs thousands of times faster than the direct approach .",
    "in addition to speeding up the likelihood evaluations it is also possible to reduce the effective dimension of search space by analytically maximizing the likelihood with respect to some of the waveform parameters . working in the fourier domain it is possible to maximize the likelihood by analytically rotating the phase of the waveform and sliding it in time .",
    "the corrected distance @xmath22 to the emri system can be found via the relation @xmath23 .",
    "the time - slide maximization is equivalent to solving for the initial orbital frequency @xmath24 , while the phase maximization of three or more harmonics fixes the initial phases @xmath25 , @xmath26 and @xmath27 .",
    "these standard analytic maximization techniques take care of 5 of the 14 emri parameters .",
    "not only does the maximization shrink the search space , it also `` softens up '' the likelihood surface : suppose that we have a fairly good match with some set of parameters @xmath28 , and the algorithm proposes a move to a new set of parameters @xmath29 with slightly different mass and spin parameters , and with the phase parameters held fixed .",
    "in general the likelihood at @xmath29 will be lower than the likelihood at @xmath28 since the frequency and phase of the waveform shifts as the parameters are changed .",
    "but if we maximize over the initial frequency and phase these shifts can be compensated for , and there is a good chance that the modified set of parameters @xmath30 will return a likelihood comparable to that at @xmath28 .",
    "figure  [ like ] shows cross sections of the regular and maximized log likelihood along a line in parameter space connecting a secondary mode to the primary mode .",
    "the valley between the peaks is far shallower , and the peaks are far wider for the maximized likelihood , which makes it easier for a search algorithm to finds its way from one peak to the next .",
    "the softening of the likelihood can be taken a step further if we allow for additional flexibility in the maximization .",
    "for example , while the physical harmonics have relative phases that are set by @xmath25 , @xmath26 and @xmath27 , there is nothing stopping us from phase maximizing each of the harmonics separately during the search",
    ". this additional flexibility can help compensate for incorrect values of the other signal parameters .",
    "similarly , while there can only be one value for @xmath31 , it is possible to introduce some additional flexibility into the time - shift maximization step . separately maximizing each harmonic",
    "will not work since all of the harmonics will slide over to match the brightest harmonic of the signal , but it is possible to perform a simultaneous maximization that maintains a frequency separation between the @xmath4 harmonics .",
    "this allows us to solve for @xmath32 in addition to @xmath31 , the combination of which provide an improved estimate for the spin of the larger black hole .",
    "additional softening can be achieved by dividing the signal up into shorter time segments and phase maximizing each harmonic in each segment individually .",
    "the price that has to paid for softening the likelihood is that the templates can more easily latch onto features in the instrument noise .",
    "ultimately this is not a serious problem since the maximization is turned off as the algorithm switches from the initial search phase to a mcmc exploration of the posterior distribution function , and matches that only exist because of the maximization are lost .",
    "our goal is to detect and characterize emri signals .",
    "the detection phase is an optimization problem - we seek to find the maximum of the posterior distribution function @xmath33 . here",
    "@xmath34 is the prior distribution , @xmath35 the likelihood , and @xmath36 is the marginal likelihood or evidence .",
    "the characterization phase is where we map out the peaks of the posterior distribution and compute confidence intervals for the recovered parameters .",
    "the characterization stage is now well understood within the gravitational wave community , and techniques such as markov chain monte carlo and nested sampling have been shown to do a very good job of mapping the peaks of the posterior distribution , including those for emri signals .",
    "finding the modes , or peaks , is another problem entirely , and while there is a vast literature devoted to similar optimization problems spanning many fields of study , there is no universal optimization algorithm that outperforms all others in every situation .",
    "the mcmc algorithms used to map the posterior can perform quiet well as search algorithms .",
    "indeed , there are theorems  @xcite which prove that samples from a markov chain will always converge to give the posterior distribution ( which in practice means that the chains will end up spending most of their time exploring the peaks of @xmath37 )",
    ". however , the rate of convergence to the target distribution ( `` burn - in time '' ) , and the number of samples needed to accurately reconstruct the posterior ( `` mixing time '' ) depend on the particular implementation of the metropolis hastings algorithm being used , and on the nature of the target distribution . for a wide class of algorithms it is possible to prove that the markov chains produced by the metropolis - hastings algorithm are _ geometrically ergodic _",
    "@xcite , and for such chains there are theorems that provide bounds on the burn - in and mixing times - see ref .",
    "@xcite for an accessible review .",
    "unfortunately these bounds are very weak , and the number of iterations required for the burn - in phase can be impractically large .    from an optimization standpoint , mcmc algorithms are not sufficiently `` greedy '' . to be markovian the chains must respect detailed balance , that is , steps in either direction along the chain must be equally probable .",
    "but that is the last thing you want in a search , where the goal is to go uphill . on the other hand , simple hill climbing schemes such as conjugate gradient or nelder - mead methods have a tendency to climb up the first bump they find and get stuck .",
    "there is a clear advantage in combining the tendency to go up hill ( _ e.g. _ nelder - mead ) with the ability to go down hill ( mcmc ) .",
    "wider exploration of the parameter space can be promoted by tempering the likelihood surface , which is done by modifying the likelihood function : @xmath38 , where @xmath39 plays the role of temperature . in the limit @xmath40 the likelihood function is flat , and the markov chain recovers the prior distribution .",
    "simulated annealing schemes can be successful , whereby the temperature starts at a high value and is steadily reduced to @xmath41 via some cooling schedule , but the performance can be quiet sensitive to the choice of cooling scheme .",
    "a more robust alternative is parallel tempering  @xcite , whereby multiple chains are run in parallel , each with a fixed temperature @xmath42 on a temperature ladder @xmath43 .",
    "the parameters of adjacent chains on the temperature ladder can be exchanged through a metropolis - hastings move , which results in solutions with higher likelihood sinking down to the lowest rung on the temperature ladder .",
    "the cold chains help the search to `` remember '' good solutions , while the hot chains are free to explore the full parameter space and find other modes of the posterior .",
    "the effectiveness of parallel tempering is affected by the spacing of the chains on the temperature ladder and the number of chains used , but these parameters are easy to tune .    a parallel tempered mcmc ( ptmcmc ) algorithm shares many attributes with evolutionary or genetic algorithms ( for descriptions of genetic algorithms in the context of gravitational wave data analysis see refs.@xcite ) . in ptmcmc",
    "there are a population of `` organisms '' ( the individual chains ) , each with its own `` dna '' ( the parameter values ) .",
    "mutation of the dna occurs by metropolis - hastings updates of each chain , and the temperature ladder acts like a selection mechanism with the `` fitter '' organisms sinking to the bottom , where their dna is more likely to be preserved .",
    "the key ingredient that is missing is reproduction or crossover . in ptmcmc",
    "the chains can swap parameters , but their is no mechanism for mixing or combing the parameters from different chains .",
    "this deficiency can be corrected by allowing genetic crossover between the chains , leading to an algorithm called evolutionary monte carlo ( emc )  @xcite .",
    "the emc algorithm preserves detailed balance in the genetic crossover operation , so the resulting samples are those of a markov chain , but this severely limits the types of reproduction that can be used . during the search phase",
    "we are not concerned about reversibility , and it is more effective to use crossover operations that violate detailed balance , such as intermediate and line recombination  @xcite . another way to view",
    "the emc algorithm is as a genetic algorithm the uses metropolis - hastings updates for the mutation operation , which has proven to be far more effective than the random binary coded mutation schemes used in refs .",
    "@xcite .    in any mcmc scheme",
    "the choice of proposal distribution , from which new candidate points are drawn , is crucial to the success of the algorithm .",
    "past experience has shown that it helps to have a mixture of proposal distributions , and the current version of our emc algorithm uses a combination of fisher matrix jumps along eigendirections of the fisher information matrix @xmath44 , conjugate gradient jumps along the gradient of the likelihood , @xmath45  @xcite , draws from the prior @xmath34 , small gaussian jumps in each parameter , differential evolution ( de )  @xcite , and mode hoping jumps based on the emri harmonics .",
    "the de moves are a new addition to the mix , and they are extremely effective during the characterization phase . the de procedure is to propose a jump from the current location to a new point along a vector connection two points drawn from the past history of the chain .",
    "this technique is very well suited to exploring posterior distributions with highly correlated parameters , and is asymptotically markovian in the limit where the past history of samples is large . during the search phase it is better to use local de , where the jump direction is drawn from the recent history of the chain .",
    "the mode hoping jumps address one of the biggest problems encountered by earlier versions of our emri search algorithm . in round 1b of the mldc  @xcite ,",
    "the montana group s entries for data sets 1b.3.2 and 1b.3.3 corresponded to secondary modes of the posterior , with @xmath3 offset from the correct value by @xmath46 .",
    "this offset seriously biased the recovered mass and spin parameters .",
    "the latest version of the algorithm turns the harmonic mismatch problem from a detriment to a benefit , as now whenever the search locks onto a secondary mode of the posterior corresponding to a harmonic mismatch , it quickly transitions to the primary mode by accepting a mode hoping proposal . the mode hops work as follows .",
    "suppose the chain is at @xmath28 with harmonics @xmath47 .",
    "we now propose a jump to a new location @xmath29 with harmonics @xmath48 , where @xmath49 can equal @xmath50 .",
    "the trick is in finding the parameters @xmath29 that yield the desired harmonic offset .",
    "this is done using an emc search of a likelihood defined by the chi - squared @xmath51 here @xmath52 is the time of observation and @xmath53 is a scaling parameter that sets the tolerance for the search .",
    "physically , this chi - squared measures the frequency offset of the harmonic tracks using a taylor series approximation .",
    "because this chi - squared is very cheap to compute , it only takes a fraction of a second to find a good solution for @xmath29 . with the harmonic jumps in the mix ,",
    "the search no longer gets stuck at secondary maxima caused by harmonic mis - match .",
    "figure  [ hjumps ] shows 2-dimensional scatter plots of the parameters @xmath29 found by the harmonic jump emc chains .    [ cols=\"^,^ \" , ]     in round 3 of the mldc , an earlier version of the emc algorithm successfully detected 3 of the 5 moderate snr , overlapping emri signals that had been injected into a single data set  @xcite .",
    "the two that were missed had lower mass central black holes , and consequently higher frequencies .",
    "since the earlier version of the search code did not heterodyne the data , the computational cost of searching for these low mass systems was higher , and the search had not converged to the correct solution by the challenge deadline .",
    "the new and improved version of the code now finds all the overlapping emri signals with no difficulty , as will be demonstrated in the next round of blind challenges .",
    "it has been my pleasure to collaborate with edward porter and jonathan gair on the development of several of these emri detection techniques .",
    "i have also benefited from discussion with curt cutler , stas babak and michele vallisneri ."
  ],
  "abstract_text": [
    "<S> the capture of compact stellar remnants by galactic black holes provides a unique laboratory for exploring the near horizon geometry of the kerr spacetime , or possible departures from general relativity if the central cores prove not to be black holes . the gravitational radiation produced by these extreme mass ratio inspirals ( emris ) </S>",
    "<S> encodes a detailed map of the black hole geometry , and the detection and characterization of these signals is a major scientific goal for the lisa mission . </S>",
    "<S> the waveforms produced are very complex , and the signals need to be coherently tracked for hundreds to thousands of cycles to produce a detection , making emri signals one of the most challenging data analysis problems in all of gravitational wave astronomy . </S>",
    "<S> estimates for the number of templates required to perform an exhaustive grid - based matched - filter search for these signals are astronomically large , and far out of reach of current computational resources . </S>",
    "<S> here i describe an alternative approach that employs a hybrid between genetic algorithms and markov chain monte carlo techniques , along with several time saving techniques for computing the likelihood function . </S>",
    "<S> this approach has proven effective at the blind extraction of relatively weak emri signals from simulated lisa data sets . </S>"
  ]
}