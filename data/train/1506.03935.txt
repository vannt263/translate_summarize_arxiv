{
  "article_text": [
    "the problem of computing local marginals of an arbitrary probability measure is computationally hard but essential , for example , in the study of inverse problems and in solving for solutions to random constraint satisfaction problems .",
    "the loopy belief propagation ( bp ) algorithm is an efficient approximate algorithm that has proven very helpful in the study of random optimization problems @xcite .",
    "the bp algorithm , relying on the bethe approximation , is exact for systems living on tree interaction graphs .",
    "it is also expected to be asymptotically exact for locally tree - like graphs as long as the variables are not strongly correlated . in general , the accuracy and convergence of the loopy bp algorithm are not guaranteed , especially in the presence of short loopy interactions . therefore , characterizing the algorithm performance in the presence of loopy interactions @xcite , and its generalizations @xcite , have been the subject of many studies in recent years . in fact , the loopy bp marginals are not globally consistent in the presence of loopy interactions .",
    "this means that the algorithm performance can be improved by demanding more consistency for the bp marginals , e.g. , by ensuring that the local marginals satisfy the fluctuation - response relations @xcite .",
    "there are also many efforts to take into account more accurately the effect of loopy interactions by an expansion around the bp solution in a loopy graph @xcite .    in this study",
    ", we consider the ising model on a loopy interaction graph , e.g. , the two - dimensional square lattice . given a spanning tree of the interaction graph",
    ", we can unambiguously identify the set of loopy interactions , the number of links between the endpoints of a loopy interaction on the spanning tree ( length of loop ) , and the minimum number of links between the endpoints of two loopy interactions ( distance of two loops ) ( see fig . [ f1 ] ) .",
    "we write a high - temperature expansion for the loopy interactions that is given by a sum over all the possible frustration - free loop configurations .",
    "a subset of loopy interactions is called frustration - free if there exists at least one spin configuration that satisfies all the interactions in that subset .",
    "we consider the loop expansion as a partition function for a system of globally interacting loop variables .",
    "the nonlocal loop interactions can be expressed in terms of the correlation functions of the spin variables in the tree interaction graph .",
    "we then resort to approximations of different complexity to study such a system of globally interacting loop variables .",
    "see also ref .",
    "@xcite , where a high - temperature expansion of loopy interactions was proposed , and the low orders of loop corrections to the gibbs free energy were computed .     and @xmath0 of lengths @xmath1 and @xmath2 , respectively .",
    "the two loops have distance @xmath3 defined as the minimum separation of their endpoints along the tree.,width=151 ]    the following arguments rely heavily on the clustering property of the pure gibbs state defined by the probability measure of the spin variables on the tree interaction graph : the fact that spin correlations decay exponentially with distance along the tree .",
    "therefore , as long as the loops are well separated , we can approximate the system of loopy interactions by an effective system of independent loops .",
    "this independent - loop ( il ) approximation works reasonably well in the high - temperature phase down to the critical region of the ferromagnetic ising model in two spatial dimensions . here",
    ", the approximation performance is determined by the length and distance distribution of the loopy interactions ; in one hand , short loops have more contribution in the loop expansion than the longer ones , and in the other hand , the more distant loops are better described within the il approximation .    to go beyond the il approximation",
    ", we make use of the bethe approximation to write the global loop interactions in terms of local correlation functions involving the neighboring loopy interactions .",
    "these local correlations in the tree graph can be computed exactly , and then the loop corrections can be computed by the standard belief propagation ( bp ) algorithm . in this way , and in the low orders of the approximation , we obtain results that are comparable to those of the loopy bp , with algorithms that exhibit better convergence properties than the loopy bp algorithm . this is because these approximations rely on the structure of the loopy interactions instead of the whole interaction graph .",
    "indeed for the ising model with random couplings on the two - dimensional square lattice , already the il approximation works better than the loopy bp in estimating the spin correlations on loopy interactions .",
    "the paper is organized as follows .",
    "section [ s1 ] gives the basic definitions and equations we use in this paper . in sec .",
    "[ s2 ] , we write the main equations for the high - temperature loop expansions . in sec .",
    "[ s3 ] , we present approximate algorithms based on the loop expansions , starting from the independent - loop approximation .",
    "finally , sec .",
    "[ s4 ] gives the concluding remarks .",
    "consider the ising model on an arbitrary graph @xmath4 with hamiltonian : @xmath5=-\\sum_{i=1}^n h_i \\sigma_i-\\sum_{(ij ) \\in g } j_{ij } \\sigma_i\\sigma_j,\\end{aligned}\\ ] ] where @xmath6 with @xmath7 .",
    "the probability of finding the system in spin configuration @xmath8 at inverse temperature @xmath9 is given by the gibbs probability measure , @xmath10}.\\end{aligned}\\ ] ] the partition function @xmath11 and the free energy @xmath12 are given by @xmath13}=e^{-\\beta f}.\\end{aligned}\\ ] ]    we choose a spanning tree @xmath14 of the interaction graph @xmath4 .",
    "this defines the set of loopy interactions @xmath15 .",
    "the length @xmath16 of a loopy interaction @xmath17 is defined by the number of links connecting the endpoints @xmath18 and @xmath19 on the spanning tree .",
    "the distance @xmath20 of two loopy interactions is defined by the minimum number of links connecting the endpoints @xmath21 to @xmath22 on the spanning tree , i.e. , @xmath23 .",
    "figure [ f2 ] shows the length and distance distributions of loops in two- and three - dimensional cubic lattices .",
    "we use @xmath24 and @xmath25 for the neighborhood set of @xmath18 in @xmath26 and @xmath27 , respectively .     of the loopy interactions in the two - dimensional ( @xmath28 ) and three - dimensional ( @xmath29 ) square lattices with respect to a random spanning tree .",
    "here @xmath30 is the linear size of the lattices with periodic boundary conditions.,width=604 ]    let us rewrite the hamiltonian as @xmath31=h_0[\\boldsymbol\\sigma]+h_{\\epsilon}[\\boldsymbol\\sigma]$ ] , separating the energy contribution of interactions on the spanning tree and the loopy interactions , @xmath32 & = -\\sum_{i=1}^n h_i \\sigma_i-\\sum_{(ij ) \\in \\mathsf{t } } j_{ij } \\sigma_i\\sigma_j,\\\\ h_{\\epsilon}[\\boldsymbol\\sigma ] & = -\\sum_{(ij ) \\in \\mathcal{l } } j_{ij } \\sigma_i\\sigma_j,\\end{aligned}\\ ] ] and define @xmath33}=e^{-\\beta f_0}.\\end{aligned}\\ ] ]    for the model on the spanning tree @xmath14 , we can exactly compute the local marginals by the bethe equations for the cavity marginals @xmath34 . here",
    ", @xmath34 is the probability of finding spin @xmath18 in state @xmath35 , in the absence of interaction with spin @xmath19 , that is , @xmath36 these are the belief propagation ( bp ) equations @xcite . to shorten the notation",
    ", we defined @xmath37 and @xmath38 .    there is only one solution to the above equations which can be obtained by iteration starting from arbitrary cavity marginals .",
    "then , the local one- and two - spin marginals are given by @xmath39 at the end , the free energy is obtained by @xmath40 , where the local free energy changes read as @xmath41 the reader can refer to ref .",
    "@xcite for derivation of the above equations .",
    "the above marginals are enough to obtain the local expectation values @xmath42 .",
    "we can use the bethe formalism to compute the higher order correlations @xmath43 for @xmath44 , @xmath45}=e^{\\sum_i \\delta_i-\\sum_{(ij)\\in \\mathsf{t}}\\delta_{ij}},\\end{aligned}\\ ] ] where @xmath46 the @xmath34 are the bp cavity marginals given before , and the new cavity marginals satisfy the following bp equations : @xmath47 along the same lines , one can compute the probability of observing a subset of spin variables in a given configuration , @xmath48 .",
    "the extension of the above equations to loopy graphs gives the approximate loopy bp equations ; this is simply done by replacing @xmath49 with @xmath50 in the above equations .",
    "let us expand the partition function @xmath11 for small couplings in @xmath51 to get @xmath52 where @xmath53 identifies a loop configuration with @xmath54 showing the absence or presence of an interaction . here",
    "the averages @xmath56 } \\prod_{(ij ) \\in \\mathcal{l}}(\\sigma_i\\sigma_j)^{s_{ij}},\\end{aligned}\\ ] ] can be computed efficiently , as described in the previous section .",
    "note that these averages are trivial when all the nodes in the subgraph @xmath57 , induced by the present loopy interactions in @xmath58 , have an even degree .",
    "we rewrite the right hand side of the above expansion in another form as @xmath59 with @xmath60 independent of the value of @xmath61 .",
    "the leading term @xmath62 is obtained when all the @xmath63 are zero . in this way",
    ", we obtain a high - temperature expansion for the loopy interactions : @xmath64 where now @xmath65    let us define @xmath66 as the number of ferromagnetic loopy interactions in loop configuration @xmath58 .",
    "the step function @xmath67 for ferromagnetic loopy interactions ( @xmath68 ) , otherwise @xmath69 .",
    "this allows us to separate the positive and negative contributions to the expansion , @xmath70 we know that the right hand side is positive , and if we are interested in the free energy densities @xmath71 in the thermodynamic limit , then @xmath72 in other words , it is @xmath73 that is responsible for any nonanalytic behavior of the free energy density .",
    "note that instead of working with the ferromagnetic loopy interactions , we could work with the anti - ferromagnetic ones to get @xmath74 where @xmath75 . here",
    "the positive contribution to the expansion comes from loop configurations with an even number of anti - ferromagnetic loopy interactions @xmath76 .",
    "thus , in the thermodynamic limit , we have @xmath77    the two different loop expansions provide the same free energy , therefore , @xmath78 these are indeed relationships between the free energies of two interacting systems of loop variables , with effective energy functions @xmath79 $ ] that depend on the couplings of the original system defined by @xmath80 $ ] . and",
    ", in the presence of a phase transition , the two systems display the same critical behavior .",
    "finally , we can use both the ferromagnetic and anti - ferromagnetic representations to write the loop expansion as @xmath81 now @xmath82 , @xmath83 , and we defined @xmath84 . note that here every loop configuration @xmath58 has a nonnegative contribution to the expansion .",
    "the average @xmath85 is the probability of having @xmath86 for all the loopy interactions .",
    "we denote this probability by @xmath87 .",
    "the complexity of computing this probability grows exponentially with the number of connected clusters in the graph @xmath57 induced by the set of present loopy interactions in @xmath58 ; the neighboring spins in each cluster should satisfy @xmath88 , and this is possible only if each cluster of loopy interactions is free of frustration , otherwise @xmath89 .",
    "in other words , only frustration - free loop configurations enter in the above expansion , and each configuration has a nonnegative contribution .",
    "so far , we have made no approximation in deriving the high - temperature loop expansions presented in the previous section .",
    "but , to obtain the loop corrections , still we have to compute the nonlocal loop interactions that appear in these expansions . in this section",
    ", we will focus on different approximations to simplify the loop interactions .      for tree interaction graphs , we are sure that the averages @xmath90 are computed within a pure state , where clustering holds and with a good approximation for distant loopy interactions @xmath91 this independent - loop ( il ) approximation results in @xmath92 .",
    "\\end{aligned}\\ ] ] note that in a ferromagnetic system this approximation underestimates the correlations and thus provides an upper bound for the free energy .    in a homogeneous system @xmath93 , and in the absence of external fields",
    "@xmath94 , we have @xmath95 , thus @xmath96 where @xmath97 is the number of loopy interactions of length @xmath98 .    in general , we obtain the magnetization by @xmath99}{\\cosh k_{kl}+\\sinh k_{kl}\\left\\langle \\sigma_k\\sigma_l \\right\\rangle_0 } , \\end{aligned}\\ ] ] and the two - spin correlation @xmath100 by @xmath101}{\\cosh k_{kl}+\\sinh k_{kl}\\left\\langle \\sigma_k\\sigma_l \\right\\rangle_0 } , \\hskip0.5 cm ( ij)\\notin \\mathcal{l}. \\end{aligned}\\ ] ]    in fig .",
    "[ f3 ] we show the free energy obtained by the il approximation for the ferromagnetic ising model on the two - dimensional square lattice .",
    "we also compare the il approximation with a mean - field approximation of the loopy interactions @xcite , where a loopy interaction @xmath102 is replaced with two effective fields @xmath103 and @xmath104 acting on spins @xmath18 and @xmath19 . here",
    "the local magnetizations @xmath105 are determined self - consistently .",
    "one can indeed do better than this naive approximation by replacing the @xmath106 in the effective fields with the cavity magnetizations @xmath107 computed in the absence of the loopy interaction .    ) on the @xmath28 square lattice is compared with the independent - loop approximation based on a random and regular ( chain ) spanning tree .",
    "( b ) the il approximation compared with a mean - field approximation of loopy interactions ( mfl ) , where a loopy interaction @xmath17 is replaced with effective fields @xmath103 and @xmath104 determined self - consistently .",
    "the arrows show the position of the ferromagnetic phase transition.,width=604 ]      in the independent - loop ( il ) approximation we do not consider the overlap of the neighboring loopy interactions . an approximate way to do this is the following : @xmath108 leading to @xmath109 where @xmath55 , and @xmath110 this independent - site ( is ) approximation , which again relies on the clustering property , is appropriate for systems in external fields where the local magnetizations @xmath111 are nonzero .",
    "now , the sum over the loop configurations can be computed by the bethe approximation , which is exact when the loopy interactions have a tree structure . here",
    "we need the cavity messages @xmath112 for loop variables @xmath63 in the absence of @xmath113 and @xmath114 .",
    "these cavity messages are governed by the following bethe equations : @xmath115 we solve the above equations by iteration , and compute the free energy from @xmath116 , where @xmath117 in fig .",
    "[ f4 ] we compare the above free energy with the exact and loopy bp free energies for random ising models on the two - dimensional square lattice .",
    "we see that in the presence of external fields , the is free energy is very close to the one obtained by the loopy bp , and at the same time , the is algorithm converges down to very low temperatures , where the loopy bp does not converge .    ) on the @xmath28 square lattice .",
    "the positive and negative values for the fields and the couplings are chosen with equal probability .",
    "the loopy bp algorithm does not converge for @xmath118 indicated by the arrows.,width=377 ]    here the local magnetizations are given by @xmath119 which can easily be computed given the @xmath112 and derivatives @xmath120 note that the bethe free energy @xmath121 is stationary with respect to changes in the messages @xmath112 , computed at the fixed point of the bp equations",
    ". thus we can safely take @xmath122    in appendix [ app - mc ] we obtain the two - spin correlations @xmath123 .",
    "figure [ f5 ] displays the error we make in estimating the local magnetizations by the il and is approximations .",
    "the figure also shows the results obtained by the loopy bp algorithm , which is still doing better than the above approximations . in the following ,",
    "we propose a systematic scheme to obtain more accurate approximations .",
    ", on the @xmath28 square lattice .",
    "both the il and is approximations are based on a maximum - weight spanning tree , with weight @xmath124 .",
    "the @xmath125 are computed by an exact algorithm ( for the smaller system in panel(a ) ) or by the monte carlo algorithm ( for the larger system in panel ( b ) ) .",
    "the errorbars are about the size of the symbols .",
    "the rms error is given by @xmath126.,width=604 ]      more accurate expressions for the nonlocal loop interactions can be obtained by the bethe approximation , for example , @xmath127 here , @xmath128 and @xmath129 are , respectively , the probability of having @xmath130 and @xmath131 , for a given loop configuration @xmath58 .",
    "more precisely , @xmath132 by @xmath129 we are indeed taking into account interactions between the neighboring loopy interactions @xmath133 with distance @xmath134 .    the above approximation for the nonlocal loop interactions can be used in any of the high - temperature loop expansions given in sec . [ s2 ] . in appendix",
    "[ app - even ] we show how the even or odd parts of expansions [ l2 ] and [ l4 ] can be computed by an approximate message - passing algorithm . in the following",
    ", instead we focus on the expression given by eq .",
    "[ l5 ] , where all the expansion terms are nonnegative .",
    "then we have @xmath135 where now @xmath136    the sum over the loop configurations can be computed within the bethe approximation . here the cavity marginal @xmath112 in the absence of @xmath137 , is recursively obtained by the following bp equations @xcite : @xmath138 the solutions to these equations are found by iteration ; starting from arbitrary cavity messages , we update the messages according to the above equations for a sufficiently large number of iterations to reach a fixed point of the equations . then , the free energy reads as @xmath139 , where @xmath140     and @xmath126 , obtained by different approximations : independent - loop ( il ) , correlated - loops ( cl ) , loopy belief propagation ( lbp ) , and generalized belief propagation ( gbp ) for random ising models with random couplings uniformly distributed in @xmath141 on the @xmath28 square lattice .",
    "the fields are zero in panels ( a ) and ( b ) , but they are nonzero and uniformly distributed in @xmath141 in panels ( c ) and ( d ) . both the il and cl approximations are based on a maximum - weight spanning tree , with weight @xmath124 .",
    "the @xmath142 and @xmath125 are computed by an exact algorithm for the smaller system in panel ( a ) , and by the monte carlo algorithm for the larger systems in panels ( b)-(d ) .",
    "the errorbars are about the size of the symbols.,width=604 ]    in appendix [ app - mc ] we give the expressions for @xmath143 and @xmath144 obtained by taking derivatives of the above free energy .",
    "in particular , we can easily obtain an estimation of spin correlations on loopy interactions , @xmath145 note that in computing the above derivatives , we need only to consider the explicit dependence of the free energy on @xmath146 , because the bethe free energy is stationary with respect to changes in the cavity messages at the fixed point .",
    "figure [ f6 ] displays the error in spin correlations on loopy interactions obtained by the above correlated - loops ( cl ) approximation for some random ising models on the two - dimensional square lattice . for comparison",
    ", the figure also shows the error obtained by the il approximation , loopy bp algorithm , and generalized bp ( shown only for the small system in panel ( a ) ) . the latter works with larger regions of variables ( here plaquettes ) to extend the consistency range of the local marginals @xcite .",
    "we see that already the il approximation is working better than the loopy bp in the absence of the external fields . and , considering the interactions between the neighboring loop variables in the cl approximation results in spin correlations that are comparable to those of the generalized bp .",
    "nevertheless , one could still obtain better results with the loopy bp for small temperatures , especially in the presence of strong fields .",
    "the same is true for homogeneous systems with uniform couplings , where the absence of a dominant spanning tree means we have to take into account the longer - ranged interactions between the loop variables .",
    "we can still improve on the above approximation by increasing the interaction range of the loop variables .",
    "for instance , to get better approximations , we may add interactions between the more distant loop variables , @xmath147 where @xmath148 the interactions @xmath149 can be limited to close loopy interactions with distances @xmath20 smaller than a given distance @xmath150 .",
    "again , from the clustering property , we expect to obtain a good approximation already for small @xmath150 .",
    "we leave further studies in this direction for future works .",
    "we started from a high - temperature loop expansion for the ising model on a loopy interaction graph regarded as a globally interacting system of loop variables .",
    "we then suggested different approximations for the nonlocal loop interactions , writing the problem of computing loop corrections in a form that is amenable to local message - passing algorithms .",
    "the quality of these approximations depends on the structure of the loopy interactions ; when the loopy interactions have a tree structure , we can use the belief propagation algorithm to compute `` exactly '' the loop corrections within a local approximation of the nonlocal loop interactions .",
    "this provides approximate message - passing algorithms that rely on the structure of the loopy interactions , and thus exhibiting better convergence properties than the loopy bp algorithm . in this way",
    ", we could obtain more accurate estimations for spin correlations on loopy interactions from these approximations than from the loopy bp algorithm for the ising model on the @xmath28 square lattice with random couplings .",
    "it would be interesting to find out the typical loop configurations close to a phase transition point .",
    "the relevant loop configurations with no frustration could behave differently as we approach ferromagnetic or spin - glass phase transition points .",
    "close to a continuous phase transition the loop variables are strongly correlated , and the global nature of loop interactions becomes more important .",
    "therefore , it would be important to have better approximations for the nonlocal loop interactions , and work with the higher - order interactions between the loop variables .",
    "finally , instead of starting from a spanning tree in the loop expansions , we could start from any subgraph that allows for accurate computation of the local expectations needed in the expansions .",
    "for instance , the starting subgraph can be obtained by adding an appropriate subset of loopy interactions to the spanning tree @xcite .",
    "we would like to thank a. braunstein , e. daryaei , and j. realpe - gomez for reading the manuscript and helpful discussions .",
    "given the free energy @xmath12 , we obtain the local expectation values from @xmath151 and @xmath100 .    in the independent - site (",
    "is ) approximation the free energy is given by @xmath152 , where @xmath153 is the free energy of the system living on the spanning tree .",
    "the other terms give the loop corrections computed by the belief propagation ( bp ) algorithm in the is approximation .",
    "the precise definitions along with the computation of the local magnetizations can be found in the main text , sec .",
    "for the two - spin correlations , we have @xmath154 to compute the above quantities we need to know the bp messages @xmath112 satisfying eq . [ bp - is ] , and the following derivatives : @xmath155 here the loop variables @xmath156 show the absence or presence of loopy interactions , and the averages @xmath157 are taken in the tree interaction graph .    in the correlated - loops ( cl )",
    "approximation , the free energy reads @xmath158 .",
    "the precise definitions are given in the main text , sec .",
    "[ s33 ] . here",
    "we obtain a local magnetization by @xmath159 where @xmath160 to compute the loop corrections , we need the cavity messages @xmath112 governed by eq . [ bp - cl ] , and the following derivatives : @xmath161    the two - spin correlations in the cl approximation are given by @xmath162 where @xmath163 in the above equations , we defined @xmath164",
    "in this section we explain an approximate message - passing algorithm to compute the contribution of loop configurations @xmath166 with an even number of ferromagnetic loopy interactions , @xmath167 here @xmath66 , @xmath168 is the heaviside function , and @xmath169 .",
    "the aim is to find an estimation of @xmath165 by the bethe approximation , given an approximate factorization of the nonlocal loop interactions @xmath170 here @xmath171 , and @xmath128 is the probability of having @xmath130 in the tree interaction graph .",
    "similarly , @xmath129 is the probability of having @xmath131 .",
    "then we have @xmath172 with @xmath173    let us for simplicity assume that the graph @xmath174 induced by the loopy interactions is a tree , otherwise we choose one of its spanning trees @xcite .",
    "then , we introduce auxiliary variables @xmath175 on the directed links of @xmath174 , where @xmath176 gives the parity of the ferromagnetic loopy interactions in the cavity tree @xmath177 ; a branch of the tree that includes @xmath18 and cavity trees @xmath178 . more precisely , @xmath179 now we have to work with extended marginals @xmath180 governed by the following bp equations @xmath181 the solution to these equations can be found by iteration .",
    "then , for an even number of ferromagnetic loopy interactions , the free energy shifts are given by @xmath182 where @xmath183 and the local @xmath184 is computed like the cavity one @xmath185 but considering the contribution from all the neighbors in @xmath25 .",
    "finally , the even free energy reads as @xmath186 ."
  ],
  "abstract_text": [
    "<S> we consider an interacting system of spin variables on a loopy interaction graph , identified by a tree graph and a set of loopy interactions . </S>",
    "<S> we start from a high - temperature expansion for loopy interactions represented by a sum of nonnegative contributions from all the possible frustration - free loop configurations . </S>",
    "<S> we then compute the loop corrections using different approximations for the nonlocal loop interactions induced by the spin correlations in the tree graph . </S>",
    "<S> for distant loopy interactions , we can exploit the exponential decay of correlations in the tree interaction graph to compute loop corrections within an independent - loop approximation . </S>",
    "<S> higher orders of the approximation are obtained by considering the correlations between the nearby loopy interactions involving larger number of spin variables . in particular </S>",
    "<S> , the sum over the loop configurations can be computed `` exactly '' by the belief propagation algorithm in the low orders of the approximation as long as the loopy interactions have a tree structure . </S>",
    "<S> these results might be useful in developing more accurate and convergent message - passing algorithms exploiting the structure of loopy interactions . </S>"
  ]
}