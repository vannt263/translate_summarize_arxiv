{
  "article_text": [
    "the search for a non - zero electric dipole moment ( edm ) of the neutron , initiated 60 years ago by norman ramsey@xcite , continues today to motivate experimental activity with increasing precision .",
    "a non - zero electric dipole moment for a spin 1/2 particle , such as the neutron , implies the violation of both parity ( p ) and time reversal ( t ) symmetries ; according to the cpt theorem this would also imply a violation of the combined cp symmetry . since cp violation beyond the standard model of particle physics is required to explain the asymmetry between matter and antimatter , the so - called baryon asymmetry of our universe , electric dipole moments provide a window on the early universe when the baryon asymmetry was generated .",
    "for a recent review on the connection between neutron physics and cosmology , see @xcite and references therein .",
    "the best measurement of the neutron edm @xcite was obtained at the institute laue - langevin ( ill ) in grenoble , france and provided the upper limit @xmath0 ( 90% c.l . ) .",
    "it was extracted from the precession frequency of trapped ultra - cold neutrons ( ucn ) in a weak ( @xmath1= 1 t ) magnetic field , using ramsey s method of separated oscillating fields@xcite .",
    "in addition , the apparatus has also been used to perform sensitive tests of lorentz invariance with neutrons @xcite , where a daily modulation of the larmor frequency was searched for .",
    "the new experiment , installed at the paul scherrer institute ( psi ) , villigen , switzerland , uses an upgraded version of this apparatus@xcite and aims at improving the sensitivity by an order of magnitude , thanks to a higher ucn density .",
    "the development of a completely renewed data - acquisition system ( daq ) was part of the numerous upgrades .",
    "to this end , new electronic modules were needed to execute all requested actions and control the experiment . instead of multiple specialized modules ,",
    "we have opted for a central and multifunction module .",
    "with such a solution , we expect to benefit from the limited number of connectors , thus minimizing the delicate problem of bad contacts .",
    "after a brief summary of the experiment principle , a description of a typical measurement cycle will be given in section  [ part2 ] .",
    "the experiment most stringent requirements are given in section  [ requirements ]",
    ". section  [ hardwaresec ] will present in details the electronic board , and section  [ firmwaresec ] the embedded firmware . finally , section  [ protovalsec ] will report on some of the achieved performances .",
    "the psi edm experiment@xcite uses the ral / sussex / ill apparatus , connected to the newly built psi ucn source@xcite .",
    "the main elements of the apparatus are depicted in fig .",
    "[ experimentdesc ] .",
    "the central part , the precession chamber , is a 21 liters cylindrical bottle ( d=47 cm , h= 12 cm ) used to store polarized ultra - cold neutrons and polarized @xmath2hg atoms .",
    "this chamber is shielded against the ambient magnetic field with a four - layer mu - metal assembly . a highly homogeneous vertical magnetic field @xmath1= 1 t is generated inside the mu - metal shield by a set of coils .",
    "additionally , oscillating transverse ( to @xmath1 ) fields can be applied by pairs of coils in the x or y directions ( fig .",
    "[ experimentdesc ] ) .",
    "the bottom and top parts of the precession chamber also serve as electrodes to generate a strong electric field ( typically @xmath3 ) , either parallel or antiparallel to the @xmath1 magnetic field .",
    "the principle of the experiment consists in measuring the neutrons larmor precession frequency using ramsey s method of separated oscillating fields .",
    "the neutron larmor frequency is proportional to the magnitude of @xmath1 , plus possibly a small frequency shift due to the neutron edm",
    ". a frequency difference , proportional to e , between the parallel and antiparallel configurations would be the signature for a non - zero edm .",
    "however , the small drifts of the @xmath1 field during the experiment could easily hide the signal . to measure and",
    "correct for these fluctuations , an atomic magnetometer using a vapor of polarized @xmath2hg atoms cohabiting in the same volume as the ucn is used@xcite .    a standard edm cycle , sketched in fig .  [ standardedmcycle ] ,",
    "is composed of seven successive steps detailed below .    1 .",
    "* ucn fill : * polarized ucn are guided toward the storage chamber .",
    "the filling time , controlled by the ucn valve , lasts typically 20s .",
    "* mercury fill : * the mercury valve is opened for 2 s , to let the @xmath2hg gas , optically pumped in the polarization cell , diffuse in the precession chamber .",
    "* mercury pulse : * a rotating transverse magnetic field is generated for 2s by two pairs of coils .",
    "the signal frequency is equal to the larmor frequency of the @xmath2hg atoms ( approx .",
    "7.6hz for @xmath1=1 t ) , measured during the previous cycle .",
    "the signals feeding the x and y coils are in phase quadrature sine waves and their amplitudes are adjusted so that the hg spins rotate by @xmath4rad .",
    "a triangular envelope was chosen in order to minimize the effect of the mercury pulse on the neutrons spins .",
    "* first ucn pulse : * similarly to the mercury pulse , two pairs of coils induce a @xmath4 flip of the neutrons spins .",
    "the signal frequency is also calculated from the mercury larmor frequency measured at the previous cycle . however , for the neutrons , the excitation frequency is changed , from one cycle to the next , using two working points , on both sides of the central ramsey resonance fringe .",
    "these four working points are used to fit the larmor neutron precession frequency ( approx .",
    "29hz for @xmath1=1 t ) . 5 .",
    "* free precession : * for a typical duration of 200s , both neutron and mercury spins precess in the horizontal plane around @xmath1 .",
    "the mercury free precession is optically monitored , using through - going polarized light produced by a mercury lamp .",
    "the light intensity , measured with a photomultiplier ( pmt ) , is modulated at the larmor frequency of the mercury spins .",
    "the pmt signal is sampled with the daq electronics and an estimate of the frequency is extracted . as discussed above , the estimated frequency @xmath5 serves to set the frequency of both mercury and neutron pulses at the next cycle , thus accounting for the drifts in magnetic field .",
    "* second ucn pulse : * at the end of the precession time , a second neutron @xmath4 pulse , in phase with the first one , is generated , thus completing the ramsey sequence .",
    "* neutron polarization measurement : * the ucn valve is opened to empty the precession chamber and neutrons fall down toward a neutron detector . on their way , neutrons encounter a magnetized ferromagnetic foil that serves as spin analyzer by letting only one spin component go through . after a fixed amount time , an adiabatic fast passage ( afp ) spin flipper is turned on to count the number of neutrons in the other component . from this information and the knowledge of the @xmath4 pulse frequency , the neutron larmor frequency can be extracted .",
    "the described sequence is repeated continuously to accumulate statistics , with periodic reversal of the electric field .",
    "two years of data - taking at the psi ucn source are planned to record about 50,000 cycles and gain an order of magnitude in sensitivity .",
    "in this section , the most stringent experimental requirements are discussed .",
    "* experiment timing resolution + the sequence of actions described above must be controlled with high precision .",
    "the most demanding actions correspond to the control of the @xmath6/2 pulses and of the neutron counting sequence .",
    "an error on the @xmath6/2 pulse duration will affect the precision of the frequency extraction but not the frequency itself .",
    "for the mercury as well as for the neutron @xmath6/2 pulses , we have estimated that a 1ms deviation from a 2s pulse would result in a precision loss of 10@xmath7 relative to the extracted frequency , a negligible amount .",
    "likewise , having a resolution of @xmath81ms on the counting time sequence would induce an error on the up / down asymmetry much smaller than the statistical fluctuations , which is sufficient . *",
    "wave generator frequency resolution + the neutron larmor precession frequency is extracted from the combination of the applied frequency of the @xmath6/2 pulse and of the neutron counting .",
    "the resolution of the wave generator should be therefore significantly better than the expected statistical precision @xmath9 , i.e at 30hz a resolution of about 0.1mhz is required .",
    "* scaler counting rate + with the increased neutron density provided by the new psi source , peak counting rates as high as 10@xmath10hz can be reached . *",
    "mercury signal encoding resolution + the precision on the extracted mercury larmor frequency is directly proportional to the signal - to - noise ratio ( snr ) of the precession signal measurement .",
    "our current snr is typically 2000 at the beginning of the precession , which limits us to a frequency precision of 0.5hz . in the future ,",
    "we plan to reach a snr of about 10000 to approach a 0.1hz precision .",
    "therefore to have a significant margin over the quantization noise , a 16 bit adc is required .",
    ".,scaledwidth=95.0% ]    a picture of the electronic board is shown in fig .",
    "[ boardpicture ] and its block diagram is shown in fig .",
    "[ bloccartev2 ] .",
    "it is designed around a field programmable gate array ( fpga ) ( xilinx xc3s400fg456 ) , whose main purposes are to perform the system precise operation sequencing ( ` micro - timer ' ) and the data acquisition . the communication with the board is done via a usb2.0 capable micro - controller ( cypress cy7c68013a ) , this allows to perform the system control and the data readout .",
    "furthermore , it is used to load the fpga firmware at board power up and to perform the monitoring of 16 input channels with a 16 bit adc .",
    "it directly controls the signal multiplexer and reads out the adc .",
    "channel 0 is reserved for reading the photo multiplier tube ( pmt ) dc signal .    a rb atomic clock/10s and long term stability : @xmath11 3@xmath12/month .",
    "] , operating at 10mhz , is directly connected to the fpga in order to reference the whole system ( signal generation and measurements ) .",
    "the various sine wave generation is ensured by two kinds of direct digital synthesis ( dds ) circuits whose outputs are connected or disconnected by fpga driven switches .",
    "the first dds kind ( ad9833 ) is used to provide the spin flipper signals ( typical frequency of 19khz ) .",
    "they have a 28 bit resolution phase accumulator and thus can achieve a frequency resolution of 37mhz when supplied with a 10mhz reference clock .",
    "these dds are configured by the micro - controller via a serial peripheral interface ( spi ) link .",
    "each dds output signal , which has an amplitude resolution of 10 bit , is filtered by an active second order low pass filter ( lpf ) before passing through the fpga controlled switch . the switch output",
    "is then amplified by 16 before being provided to the spin flipper coils .",
    "the second dds kind ( ad9852 ) is used to provide the two neutron ( around 30hz ) and two mercury ( around 8hz ) excitation signals with a very high precision in frequency .",
    "they feature a 48 bit phase accumulator and , given the fact that they are referenced at 500khz ( a divided version of the atomic clock ) , they have a tuning resolution of 1.77nhz .",
    "this resolution which is therefore far better than the experimental requirement of 0.1mhz . also these dds offer the possibility to add an offset to the internal phase accumulators result .",
    "consequently , it is possible to generate the excitation signal pair with a known phase relationship by updating them synchronously with the same phase increment value but with different phase offset .",
    "this synchronous update is achieved the fpga which directly controls both dds update input pin of a pair . moreover , by performing this operation slightly before closing the dds output switches , which are also fpga controlled , it is possible to adjust the start phases of both sine waves ( see fig .",
    "[ osksequence ] ) .",
    "another advantage , is that the sine wave output amplitude , which has an amplitude resolution of 12 bit , can be digitally adjusted either by a constant factor or by using the output shape keying ( osk ) feature . as illustrated in fig .",
    "[ ofskprinciple ] , this allows the control of the signal amplitude as a function of time and therefore to generate the required triangular shape envelope instead of the abrupt rectangular shape . with the dds clock running at 500khz , the ramping time",
    "can be adjusted from 32.768ms up to 2.096s with a step resolution of 8.192ms .",
    "the ramping ( up or down ) is deterministically activated by the micro - timer embedded in the fpga via a dedicated pin ( labeled osk ) .",
    "an example of the control sequence allowing to adjust the initial phase , the ramping and the switch control is displayed in fig .",
    "[ osksequence ] .",
    "each dds output signal is amplified with an adjustable gain up to a factor ten and filtered by an active fourth order low pass filter ( lpf ) before passing through the fpga controlled switch . a serial resistor ( 820@xmath13 ) has been added at the circuit output in order to have a current - source - like output .",
    "consequently , the magnetic field generated is less sensitive to the coil resistance variation due to thermal fluctuations ( typical coil resistance is around 10@xmath13 ) .",
    "the pmt signal is connected to a conditioning block detailed in fig .",
    "[ pmtfe ] .",
    "the first stage converts the current signal in a voltage signal with a current preamplifier having a 1m@xmath13 resistor feedback .",
    "the alternating ( ac ) and continuous ( dc ) components of the signal are then separated : the dc component is extracted via a second order low pass filter while the ac part passes through a q=8 band pass filter centered around 8hz .",
    "the resulting signal is level shifted by half of the adc full - scale in order to fit in the available adc range .",
    "some additional features of this module include :    * the possibility to control eight external electromechanical devices synchronously to the micro - timer with the provided buffered ttl outputs . * the generation of a real - time four bit signal at each micro - timer step , encoding the step number to permit the synchronization with other electronic modules . * the availability of twelve 32 bit scalers to record the neutron counts at the end of a edm cycle .",
    "an overview of the fpga firmware which is the core of the system and whose main purposes are to perform the system precise operation sequencing and the data acquisition is shown in fig .  [ blocfpgav2 ] .",
    "it is composed of seven different blocks : the frequency divider , the usb interface for communication , the scalers , the micro - timer for precise operation sequencing the adc interface for data acquisition and the two dds interface blocks .",
    "the frequency divider is used to divide the atomic clock frequency by a factor 20 for referencing of the dds . as explained in section  [ hardwaresec ] , the frequency",
    "must be lowered in order to reach the highest resolution on the output signal frequency but also to be able to have slow ramping amplitudes .",
    "this division is performed by a 0 to 9 counter which keeps a 50% duty cycle .",
    "the micro - timer block is designed to manage up to 16 time sequences .",
    "each sequence has a programmable duration , that can be adjusted with a 1s step resolution in a 1 to 2 ^ 32 ^ -1 range , and can manage up to 32 different actions .",
    "the actions to be executed during each step are controlled by a 32-bit word ( action mask ) , each action having a dedicated bit .",
    "the 32 micro - timer parameters , the 16 durations and the 16 action masks , are written in the dual port block ram by the usb interface before starting the time sequence execution .",
    "the micro - timer block is managed by a simple two states finite state machine ( fsm ) which starts the time sequence execution when the run signal , provided by the usb interface , is activated . before executing each instruction cycle , the corresponding parameters are read from the memory . additionally , the 4 most significant bit ( msb ) of the memory read pointer are used to reflect the current sequence in progress .",
    "this information is available for usb readout and on the board for external synchronization .",
    "the possible micro - timer actions are listed below :    * the eight ` ttlout ' may activate external electro - mechanical actuators ( ucn and hg valves ) . * ` hgexcupd ' and ` neuexcupd ' : signals to trigger the dds parameters update for mercury and neutron , respectively . *",
    "` enhgexc ' and ` enneuexc ' : enabling of signals generation for mercury and neutron respectively . * ` oskhg ' and ` oskneu ' : initialization of the ramping of the sine wave amplitude ( see figure  [ ofskprinciple ] ) . * ` enadc ' : enabling of pmt signal acquisition . *",
    "the four ` enspinflipper ' are used to activate the selected 19khz sine wave generator . *",
    "the ` enspinupcnt ' and ` enspindncnt ' bit are respectively used to allow the 12 associated scalers to count during spin up and spin down .",
    "the dds interface blocks are used to simultaneously configure the dds pairs ( mercury or neutron ) with the parameters provided by the usb interface in their embedded block memory .",
    "each dds requires up to 40 configuration bytes .",
    "consequently , the two dds parameters bytes are concatenated in a single word and the whole configuration is conveniently stored in the 40 first memory words ( 16 bit ) .",
    "the fsm , which manages the communication protocol with the dds , initiates the parameter transfer upon reception of the update signal provided by the micro - timer table or by the usb interface .",
    "the firmware features a scaler containing two banks of twelve 32-bit counters , each counter having the capacity to count with a frequency up to 100mhz .",
    "these counters are operated in a gated mode with the gating signals provided by the micro - timer as previously described .",
    "the pmt signal acquisition is managed by the adc interface block which performs the data acquisition at the selected sampling period and when activated by the micro - timer .",
    "the digitized data are written in the embedded output fifo and real - time data - readout is realized via the usb interface .",
    "the sampling period , which is a sub - division of the atomic reference clock , can be adjusted by steps of 100ns between a minimum of 10s and a maximum of 1677ms .",
    "it should be noted that running at a conversion rate significantly higher than the signal frequency ( 8hz ) can be an asset .",
    "indeed , at the price of more computing power , it is possible to apply an off - line sharp digital filtering to further reduce the bandwidth given by the analog band pass filter .",
    "hence , the signal - to - noise ratio can be further improved .",
    "a series of tests was conducted to check the main performances of the board and ensure it fulfills the requirements . as an example of the various basic functional tests , we show in fig .",
    "[ triangle-2s_1khz ] the generation of a sine wave signal with a triangular envelope .",
    "this 8hz sine wave having a duration of 2s and 1s rise and fall times , was sampled at 1khz with the board s own adc .",
    "we have quantified the quality of the waveform by fitting the signal with phase , starting time and maximum amplitude as free parameters ( the frequency and the total duration of the signal were fixed to preset values ) .",
    "we found a residual better than 10 ^ -3^ relative to the maximum amplitude .",
    "the most critical and demanding function of the board concerns the pmt signal treatment . indeed , as discussed in section  [ part2 ] , the hg co - magnetometer is a key element of the nedm apparatus since , by measuring the mercury precession frequency , we can precisely measure the magnetic field seen by the neutrons and correct for its fluctuations .",
    "systematic tests were therefore carried out to study the measurement chain performances .    at first , the ac input band pass filter was characterized . to this end",
    ", one of the mercury ` 8hz ' outputs was connected to the pmt signal input , and its frequency was varied from 0.2hz to 11.5hz .",
    "the result of the measurement , displayed in fig .",
    "[ reponsefiltre8hz ] , is in accordance with a q=8 filter , centered at 8hz .",
    "the next crucial test consisted in checking that the intrinsic board noise was negligible as compared to the physical noise which is obviously one of the parameter limiting the precision .",
    "the power spectrum density ( psd ) of the complete board input chain was measured : this includes the amplifier ( tested with a gain 1 ) , the band pass filter and the adc . as in the previous measurement ,",
    "the input signal was a mercury ` 8hz ' signal generated by the board itself .",
    "a sampling rate of 100hz and an acquisition time of 100s were chosen as they represent typical values used by the experiment .",
    "the fast fourier transform of the digitized signal is shown in fig .  [ dds_8hz_reboucle_100s_100hz ] .",
    "the measured noise floor is compatible with the expected adc performances as advertised by the manufacturer for the same amount of points .",
    "it is also worth noting that the noise floor inside and outside of the filter bandwidth is identical , indicating that the electronics noise is due to quantization only .",
    "the signal - to - noise ratio obtained from the psd spectrum is about 14000 .",
    "those performances should be compared with the precession signal measurement in the experimental setup .",
    "the psd of a typical measurement is shown in fig .",
    "[ psd_psi ] .",
    "in contrast to the loop - back measurement , the noise floor greatly increases in the filter bandwidth , showing that the measurement noise is dominated by the physical noise . the signal - to - noise ratio obtained from the psd spectrum is about 840 .    from this test",
    ", we can conclude that the sensitivity in the frequency extraction of the mercury signal will not be limited by the electronic performances ( security coefficient of 10 ) .",
    "we have designed and constructed an electronic board for the data acquisition and control of the neutron electric dipole moment experiment at the paul scherrer institute .",
    "the board , organized around a field programmable gate array ( fpga ) , is a multifunction module which fulfills a large fraction of the requirements regarding the time - sequencing and the data acquisition of the experiment .",
    "thanks to the use of a fpga , it is compact , versatile and evolutive . additionally , the high integration level and the corresponding limited number of connections should result in a better reliability .",
    "a list of the main functions and specifications is given in table  [ perftable ] .",
    "it must be noted that all requirements given in section  [ requirements ] are all easily met ."
  ],
  "abstract_text": [
    "<S> experiments aiming at measuring the neutron electric dipole moment ( nedm ) are at the forefront of precision measurements and demand instrumentation of increasing sensitivity and reliability . in this paper </S>",
    "<S> , we report on the development of a dedicated acquisition and control electronics board for the nedm experiment at the paul scherrer institute ( psi ) in switzerland . </S>",
    "<S> this multifunction module is based on a fpga ( field - programmable gate array ) which allows an optimal combination of versatility and evolution capacities . </S>"
  ]
}