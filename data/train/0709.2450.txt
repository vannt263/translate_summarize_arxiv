{
  "article_text": [
    "star formation is known for being the place of extreme variations in length and density scales . although it is established that stars form in dense cores , the non - linear evolution makes it difficult to perform accurate calculations of the collapse and the fragmentation of a prestellar core .",
    "the star formation process is the outcome of complex gas dynamics involving non - linear interactions of gravity , turbulence , magnetic field and radiation .",
    "klein et al . (",
    "2007 ) point out that developing a theory for low - mass star formation remains one of the most elusive and important goals of theoretical astrophysics .",
    "numerical simulations allow today to study star formation processes and , thanks to the recent development of super computers , a significant increase in the description of the dynamical range of low - mass star formation has been reached .",
    "the computational challenge stems from the fact that star formation occurs in clouds over many orders of magnitude in spatial and density scales .",
    "the main issue for the simulations is to follow the gravitational collapse while resolving precisely the jeans length , which scales as @xmath1 for an isothermal gas .",
    "different approaches are used to study star formation through numerical simulations and include more and more detailed physics .",
    "one key question resides in the choice of the most appropriate numerical method to be used to study low - mass star formation .",
    "nowadays , two completely different approaches can handle this problem with sufficient accuracy : the adaptive mesh refinement method for eulerian grids ( amr ) and the smoothed particle hydrodynamics method ( sph ) for a lagrangian approach .",
    "we use the amr code ramses ( teyssier 2002 ) and the sph code dragon ( goodwin et al .",
    "the debate about whether one method is most appropriate remains open and no systematic comparison has been done in the domain of low - mass star formation . recently , in a comparative study between sph and amr , agertz et al .",
    "( 2006 ) have shown that the sph method is of limited accuracy for describing kelvin - helmotz instabilities in the presence of a strong density gradient .",
    "this effect in sph simulations is due mainly to the cyclic , kick - drift phenomenon , which strongly depends on the form of the sph force calculation coupled with the treatment of neighbor particles . in the low - mass star formation field ,",
    "fromang et al . ( 2006 ) compares quite successfully amr hydrodynamical collapse calculations with sph ones .",
    "several studies provide key starting points for the numerical investigation of low - mass star formation .",
    "truelove et al . (",
    "1997 ) give an empirical criterion for the jeans length resolution in amr calculations to avoid spurious numerical fragmentation while bate & burkert ( 1997 ) provide a minimum resolution criterion for sph calculations with self - gravity to correctly model fragmentation .",
    "in the present study , we compare thoroughly the two approaches in the context of low - mass prestellar core formation .",
    "we focus on the dependency of angular momentum conservation and fragmentation on physical and numerical initial conditions , in order to derive resolution criteria adapted to our study .",
    "to make comparison between codes easier , we adopt simple initial conditions , similar to those chosen in previous studies ( bate & burkert 1997 ) .",
    "we consider an uniform sphere of molecular gas of initial radius @xmath2 , rotating around the @xmath0-axis with a constant angular velocity @xmath3 .",
    "we set up the cloud mass at @xmath4 m@xmath5 and the temperature at 10 k. for a mixture of molecular hydrogen , helium and heavy elements , with mean molecular weight @xmath6 , this corresponds to an isothermal sound speed of @xmath7 km.s@xmath8 . for the case where fragmentation occurs , we use a @xmath9 azimuthal density perturbation .",
    "the initial energy balance of our model is determined by two dimensionless parameters corresponding to the ratio @xmath10 between the thermal energy and the gravitational energy and to the ratio @xmath11 of the rotational and the gravitational energy : @xmath12 since we use a constant initial mass of 1 m@xmath5 and a constant temperature , changing one of the two parameters , namely @xmath10 , gives the sphere radius @xmath2 .",
    "the higher @xmath10 , the larger @xmath2 .",
    "the angular velocity is given by the parameter @xmath11 .    in order to mimic the thermal behaviour of a star - forming gas",
    ", we use a barotropic equation of state .",
    "masunaga & inutsuka ( 2000 ) showed that the core follows closely a barotropic equation of state , providing a good approximation without resolving radiative transfer .",
    "we use @xmath13 , \\label{baro}\\ ] ] where @xmath14 is the isothermal sound speed at 10 k and @xmath15 g.@xmath16 is the critical density which corresponds to the transition from an isothermal to an adiabatic state ( larson 1969 ) . at low densities , @xmath17 , @xmath18 km.s@xmath8 .",
    "the molecular gas is able to radiate freely by coupling thermally to the dust and therefore remains isothermal at 10 k. at high densities @xmath19 , we assume that the cooling due to radiative transfer is trapped by the dust opacity . therefore , @xmath20 which corresponds to an adiabatic monoatomic gas with adiabatic exponent @xmath21 .",
    "note that molecular hydrogen behaves like a monoatomic gas until the temperature reaches several hundred kelvin , since the rotational degrees of freedom are not excited at lower temperatures , and hence @xmath21 is the appropriate adiabatic exponent ( e.g. masunaga & inutsuka 2000 ) .",
    "in this paper , we use the amr code ramses ( teyssier 2002 ) , which integrates the `` tree - based '' data structure allowing recursive grid refinements on a cell - by - cell basis .",
    "ramses combines a tree - based amr grid and a second order godunov hydrodynamical scheme coupled with a gravity solver .",
    "the godunov hydrodynamical solver is able to capture discontinuities with a high precision level .",
    "the equations solved in ramses are the euler equations in their conservative form .",
    "furthermore , it has the possibility to use variable timesteps at each refinement level .",
    "concerning time integration , ramses uses a second - order midpoint scheme , where positions and velocities are updated by a predictor - corrector step .",
    "recently , an ideal mhd version of ramses has been developed by fromang et al .",
    "( 2006 ) .",
    "our refinement criterion is based on the jeans length resolution which is necessary to treat accurately gravitational collapse .",
    "we impose a minimum number of points @xmath22 per jeans length @xmath23 . the cells dimension must be smaller than a constant fraction of the local jeans length .",
    "the dimension of cells belonging to the @xmath24 refinement level is @xmath25 , where @xmath26 is the physical length of the simulation box .",
    "the mesh is locally refined in order to verify the local jeans criterion : @xmath27    truelove et al .",
    "( 1997 ) defined a minimum resolution condition for the validity of grid - based simulations aimed at modeling the collapse of a molecular cloud core , namely @xmath28 .",
    "this condition ensures that the collapse is of physical rather than of numerical origin .",
    "we use the sph code dragon ( goodwin et al .",
    "the sph formalism relies on an interpolation method which allows any function to be expressed in terms of its values at the location of various points called particles . for numerical works , the integral interpolant for the variable @xmath29",
    "is approximated by a summation interpolation over the particle s nearest neighbors : @xmath30 where @xmath31 is the value associated with particle @xmath32 , @xmath33 and @xmath34 is the adaptive smoothing length of particle @xmath35 , defined such that the particle kernel volume ( i.e the resolution element ) contains a constant mass , i.e. a constant number of neighbors @xmath36 .",
    "the main advantage of sph is its lagrangian conservation property in contrast with grid - based methods .",
    "resolution elements are then concentrated in high density regions in sph methods whereas the amr allows high resolution of all regions in the flow .",
    "the standard sph formalism adopts artificial viscosity .",
    "some alternative formalism such as godunov sph has been proposed in order to avoid the use of artificial viscosity , but these methods are not yet mature .    in the sph , the resolution in mass is fixed and thus the jeans length resolution deteriorates with increasing density during the isothermal phase , contrary to the amr .",
    "bate & burkert ( 1997 ) showed that the behaviour of a jeans - mass clump of gas with radius @xmath37 is dominated by the numerical implementation .",
    "the minimum resolvable mass must then be larger than the interpolation mass .",
    "bate & burkert ( 1997 ) take the smallest mass than can be resolved in sph calculations to be equal to the mass of @xmath38 particles .",
    "we can determine our initial number of sph particles according to this criterion .",
    "the jeans mass is @xmath39 and the minimum resolvable mass is @xmath40 , where @xmath41 is the particle mass .",
    "hence , we can define a jeans condition corresponding to the minimum value of @xmath42 , given by the barotropic equation of state ( [ baro ] ) , i.e. @xmath43 : @xmath44 considering a spherical cloud of mass @xmath45 m@xmath5 , the initial number of particles @xmath46 has to verify @xmath47 if @xmath48 .",
    "this is the critical number of particles used in sph calculations to study the collapse of a dense core .",
    "we have in that case exactly @xmath49 ( i.e. two resolution elements ) particles per critical jeans mass .",
    "ccc +    .summary of the different simulations ( left table : sph , right table : amr ) performed to study angular momentum conservation .",
    "@xmath50 for the amr calculations gives us the number of cells describing the initial sphere .",
    "the quantity @xmath51 representing the number of cells / particles with density @xmath52 g.@xmath16 .",
    "time t@xmath53 is the time when the density becomes higher than @xmath54 g.@xmath16 . [",
    "cols=\"^,^,^,^,^\",options=\"header \" , ]     [ sum_homorot ]    we start by comparing the global properties of the collapse in the two codes in the simple case of a uniform sphere rotating with a constant angular velocity around the @xmath0-axis , with no perturbation .",
    "we look at the collapse time , the accretion shock ( see commeron et al . 2007 ) and finally the angular momentum conservation . in this section ,",
    "we focus on this last issue . considering our axisymetric model , without azimuthal perturbation",
    ", we can easily investigate the effect of numerical resolution on local angular momentum conservation , since local angular momentum should be perfectly conserved .",
    "the loss of local angular momentum in our model is only due to unphysical transport inherent to the numerical methods used in the two codes.thanks to its lagrangian properties , the sph calculation gives access to the angular momentum that each particle has initially , i.e. the angular momentum that particle should have if the numerical scheme was conserving it exactly .",
    "having access to the particle initial angular momentum and to the same quantity at a given time , the loss of angular momentum is easily calculated .",
    "we carried out a set of simulations within a wide range of resolution parameters .",
    "the initial sphere has the parameters @xmath55 corresponding to an initial radius @xmath56 cm and a density @xmath57 g.@xmath16 .",
    "the corresponding freefall time is t@xmath58 kyr .",
    "we set @xmath59 , corresponding to an orbital time t@xmath60 kyr .",
    "table [ sum_homorot ] summarizes the different sph and amr calculation runs for this case .",
    "calculations converged with increasing numerical resolution to a value slightly greater than the theoretical freeffall time because of the rotational support .",
    "figure [ homorot ] ( left ) displays the azimuthal velocity component as a function of the radius @xmath61 on the @xmath62-plane for the sph simulations .",
    "it is obvious that low resolution simulations are not able to conserve properly the angular momentum . with @xmath63 particles ,",
    "we obtain contra - rotating particles at the center .",
    "this pure numerical effect shows that a minimum resolution is required even for a simple collapse model .",
    "it appears that a minimum of @xmath64 particles is required to get an acceptable angular momentum conservation , within less than @xmath65 , for the case of the present study .",
    "the improvement of angular momentum conservation with a larger number of particles eventually saturates for large numbers of particles .",
    "we checked that using a larger number of neighbours does not improve the conservation of local angular momentum .",
    "figure [ homorot ] ( right ) shows results obtained with the ramses code .",
    "amr curves are plotted and compared with the theoretical one obtained previously for the sph .",
    "the simulations with @xmath66 and @xmath67 give approximately the same results .",
    "in all these amr simulations , the core resolution is better than with the sph ( see parameter @xmath51 in table [ sum_homorot ] ) . for an initial resolution of @xmath68=5",
    ", the amr scheme does produce some angular momentum lag .",
    "this can be due to the fact that with a poor initial resolution , the interpolation of the gravitational potential tends to convert gravitational energy into rotational energy .",
    "this subsection is devoted to the exploration of various numerical parameters in a physical case known to fragment . in commeron",
    "et al . ( 2007 ) , we study the effect of varying the initial grid resolution @xmath68 and the number of cells within a jeans length @xmath22 for amr calculations . we also present our sph calculations with various @xmath69 and @xmath46 .",
    "we carry out this study for three different cases with various thermal support . here",
    ", we focus on the case with initial parameters : @xmath70 , @xmath71 , giving @xmath72 g.@xmath16 , @xmath73 cm , @xmath74 rad.s@xmath8 and t@xmath75 kyr .",
    "the initial perturbation amplitude is @xmath76 .",
    "figure [ comp_a050 ] shows density maps in the equatorial plane for the results of two amongst the most resolved calculations at three timesteps , namely , from top to bottom , t@xmath53 + 5 kyr , t@xmath53 + 6 kyr and t@xmath53 + 7 kyr .",
    "the left column shows maps for amr calculations with @xmath67 and @xmath77 whereas the right column displays sph maps for calculations with @xmath78 and @xmath48 .",
    "we show here the two converged calculations of each method that we first studied independently .",
    "the convergence between the two methods for these physical and numerical parameters set is striking for the two first timesteps .",
    "the calculations give the same fragmentation time and pattern , although satellites and the central object are bigger with the sph .",
    "symmetry is eventually broken with the sph calculations , whereas the amr ones preserve the symmetry longer .",
    "-plane at three different times for the case @xmath79 , @xmath71 .",
    "the times correspond to t@xmath80 kyr , t@xmath81 kyr and t@xmath82 kyr , from to bottom , respectively .",
    "the amr calculations plotted on the left column have been run with @xmath67 and @xmath77 .",
    "the right column shows the results for the sph calculations with @xmath78 and @xmath48.,height=403 ]",
    "we show that we reach good convergence between amr and sph methods provided one uses sufficient numerical resources .",
    "first , we take a simple model to study local angular momentum conservation .",
    "the initial study shows that angular momentum is better conserved with the amr approach . as shown in fig .",
    "[ homorot]a , a smaller number of particles in sph calculations leads to poor local angular momentum conservation . in amr calculations ,",
    "a poor initial computational domain resolution ( i.e. @xmath83 ) leads to unphysical transfer of gravitational energy to rotational energy ( see fig .",
    "[ homorot]b ) .",
    "a significant loss of angular momentum will affect fragmentation since less rotational support can balance gravitational collapse .",
    "the smallest parameter set for sph calculations , required to go through gravitational collapse without significant loss of angular momentum , corresponds to a number of @xmath84 particles per jeans mass at the critical density @xmath85 , i.e. 5 particles per jeans _",
    "length_. the equivalent minimum resolution criterion for amr calculations is @xmath86 and @xmath87 .    for the fragmentation case ,",
    "the two approaches show good agreement for the general pictures .",
    "details are better resolved in amr calculations thanks to the refinement method based on the local jeans length , whereas the resolution deteriorates with increasing density with the sph , because of the fixed mass resolution .",
    "numerical calculations of protostellar collapse should thus be conducted with great care , with a detailed examination of numerical resolution .",
    "the resolution criteria to reach convergence for the cases we explore in details is about @xmath88 particle per jeans mass in sph and @xmath77 in amr , and could become prohibitive in some cases , particularly for low thermal support .",
    "in such a case , it is more difficult to get a convergence .",
    "the horizon of predictability is very short , since fragmentation occurs very quickly .",
    "the latter parameter set seems to be a lower resolution limit for dense core collapse and fragmentation with sph calculations .",
    "using a lower number of particles will lead to spurious early fragmentation due to numerical effects .",
    "the present work can be used to assess the validity of numerical tools to study star formation .",
    "calculations have been performed thanks at the psmn ( ens lyon ) and ccrt ( cea ) supercomputating facilities , as well as on the cemag computing facility supported by the french ministry of research and education through a chaire dexcellence awarded to steven balbus ."
  ],
  "abstract_text": [
    "<S> the development of parallel supercomputers allows today the detailed study of the collapse and the fragmentation of prestellar cores with increasingly accurate numerical simulations . </S>",
    "<S> thanks to the advances in sub - millimeter observations , a wide range of observed initial conditions enable us to study the different modes of low - mass star formation . </S>",
    "<S> the challenge for the simulations is to reproduce the observational results . </S>",
    "<S> two main numerical methods , namely amr and sph , are widely used to simulate the collapse and the fragmentation of prestellar cores . </S>",
    "<S> we compare here thoroughly these two methods with numerical resolution requirements deduced from previous studies . </S>",
    "<S> our physical model is as simple as possible , and consists of an isothermal sphere rotating around the @xmath0-axis . </S>",
    "<S> we first study the conservation of angular momentum as a function of the resolution . </S>",
    "<S> then , we explore a wide range of simulation parameters to study the fragmentation of prestellar cores . </S>",
    "<S> there seems to be a convergence between the two methods , provided resolution in each case is sufficient . </S>",
    "<S> resolution criteria adapted to our physical cases , in terms of resolution per jeans mass , for an accurate description of the formation of protostellar cores are deduced from the present study . </S>",
    "<S> this convergence is encouraging for future work in simulations of low - mass star formation , providing the aforementioned criteria are fulfilled . </S>"
  ]
}