{
  "article_text": [
    "the angular power spectrum @xmath8 of the fluctuations in the cosmic microwave background ( cmb ) is a gold mine of cosmological information .",
    "since it depends on virtually all classical cosmological parameters ( the hubble parameter @xmath9 , the density parameter @xmath10 , the cosmological constant @xmath11 , ) , an accurate measurement of @xmath8 would amount to an accurate measurement of most of these parameters @xcite . in the last few years",
    ", the angular power spectrum has emerged as the standard way of presenting experimental results in the literature , replacing other fluctuation measures such as the correlation function and the gaussian autocorrelation function amplitude ( as described in @xcite ) .",
    "there are several reasons for this :    1 .",
    "the boltzmann equation is diagonal in the fourier ( multipole ) domain rather than in real space , so the features of the power spectrum can be given a direct and intuitive physical interpretation ( see @xcite ) .",
    "2 .   a plot of power - spectrum estimates allows experiments to be compared in a model - independent way , as opposed to , say , parameter estimates and exclusion plots that are only valid within the framework of particular cosmological models .",
    "3 .   for gaussian models ,",
    "power spectrum estimation constitutes a useful ( and arguable necessary ) data compression trick for making the analysis of future megapixel sky maps feasible in practice .    in what follows",
    ", we will pay considerable attention to the the third point , since there are at present no unbeatable methods available that are computationally feasible when @xmath3 , the number of map pixels , is very large .",
    "the cpu time needed for applying the maximum - likelihood method directly to a map scales as @xmath2 , since it involves computing determinants of @xmath12 ( non - sparse ) covariance matrices , and the karhunen - love data compression method ( see @xcite and references therein ) unfortunately requires the diagonalization of an @xmath12 matrix , which also scales as @xmath2 .",
    "such a brute - force approach has so far only been implemented up to @xmath13 @xcite , and it currently appears unfeasible to push it much beyond @xmath14 .",
    "in contrast , the upcoming satellite missions _",
    "map _ and _ planck _ will have @xmath3 in the range @xmath15 .",
    "the data - compression aspect of power spectrum estimation is illustrated in figure 1 : if the power spectrum retains ( in a distilled form ) all the cosmological information that was present in the map , then the computationally unfeasible step of estimating the parameters directly from the map can be split in to two feasible steps , giving exactly the same answer and and the same error bars .",
    "this is completely analogous to the way in which map - making is an intermediate step , and as was recently shown @xcite , there are indeed map - making methods that destroy no cosmological information at all .    in this paper , we will derive a new method for estimating @xmath8 from maps that has the following desirable properties :    1 .",
    "it is _ unbeatable _ in the sense that no other method can give smaller error bars on @xmath0 or on any cosmological parameters upon which @xmath0 depends .",
    "it is _ quadratic _ , which means that the statistical properties of the estimates are easy to compute .",
    "it is _ faster _ than the maximum - likelihood method and the eigenmode method @xcite , with the required cpu time for the crucial steps scaling as @xmath1 rather than @xmath2 .",
    "it is transparent and easy to understand intuitively .",
    "the rest of this paper is organized as follows . in section 2 ,",
    "we discuss in more detail how to assess the merits of a power spectrum estimation method , and derive a simple test for determining whether it is unbeatable in the above sense . in section 3",
    ", we derive the new method and prove that it is in fact unbeatable in the sense of section 2 . in section 4 , we explore its properties , illustrated with an application to the 4 year cobe / dmr data . in section 5 , we discuss how to use this method in the analysis of a future megapixel map , both for graphically presenting the data and for measuring cosmological parameters . finally , we summarize our conclusions in section 6 .",
    "above we listed three uses for power spectrum estimation methods . especially for the third use , as a data compression technique , we clearly want a method to have the following properties :    1 .   it should be computationally feasible in practice .",
    "2 .   it should produce estimates of @xmath8 whose statistical properties are well enough understood to make them useful for parameter estimation and model testing .",
    "3 .   it should destroy as little information as possible .",
    "we will now elaborate on the third of these criteria , and return to the other two further on .",
    "the fisher information matrix formalism ( see @xcite for a comprehensive review ) offers a simple and a useful way of diagnosing the methods corresponding to the various boxes in figure 1 , to measure how much information they destroy .",
    "given any set of cosmological parameters of interest ( @xmath9 , @xmath10 , ) , their fisher matrix @xmath16 gives the smallest error bars with which the parameters can possibly be measured from a given data set .",
    "@xmath17 can , crudely speaking , be thought of as the best possible covariance matrix for the measurement errors on the parameters .",
    "for instance , the cramer - rao inequality shows that no unbiased method whatsoever can measure the @xmath18 parameter with error bars ( standard deviation ) less than @xmath19 .",
    "if the other parameters are not known but estimated from the data as well , the minimum standard deviation rises to @xmath20 .    by computing the fisher matrix separately from each of the intermediate data sets in figure 1",
    ", we can thus track the flow of information down the data pipeline and check for leaks .",
    "for instance , if the fisher matrix computed from the raw time - ordered data ( tod ) is identical to that computed from the map , then the map - making method ( denoted @xmath21 in the figure ) is _ lossless _ in the sense that no information about these parameters has been lost in the map - making process .",
    "it was recently shown @xcite that some of the popular map - making methods from the literature are lossless whereas others are not .",
    "the advantage of making a lossless map is that this reduces the data set to a more manageable size before the more complicated nonlinear data analysis step ( the final likelihood analysis ) .",
    "we will see that the angular power spectrum plays quite an analogous role , allowing us to subject the map to a second data compression step before commencing the final parameter estimation step , and we can clearly diagnose it in exactly the same way . let us make the following definition , which is applicable to any data compression method whatsoever ( to any procedure that reduces a larger data set into a smaller one ) :    * _ a data compression method is said to be _ lossless _ if any set of cosmological parameters can be measured just as accurately from the compressed data set as from the original data set . _      unfortunately , this definition is not particularly useful for diagnosing a method in practice , since it involves computing the fisher matrices for a large or infinite number of parameter sets .",
    "fortunately , this is equivalent to a much simpler test , as we will now show .    if the probability distribution @xmath22 for the data set @xmath23 ( the pixels temperatures in a sky map ) depends on some parameters @xmath24 , then the fisher information matrix for these parameters is defined as @xcite ^_ij- . since @xmath22 is a probability distribution over @xmath23 , @xmath25 for any choice of the parameter vector @xmath26",
    "differentiating this identity , we obtain = f d^nx = _ if d^nx = 0 . using this result and the chain rule",
    ", we find that if the parameter set @xmath26 depends on some other parameter set @xmath27 , then the fisher matrix for these new parameters is given by ^ = ^t^ , where the jacobian matrix _ ij .",
    "note that this simple transformation rule holds regardless of whether the probability distribution is gaussian or not .",
    "if the cmb fluctuations @xmath23 are gaussian and isotropic , then we know that their probability distribution is entirely determined by the power spectrum .",
    "this means that if we choose the parameters @xmath28 to be the power spectrum coefficients @xmath29 , the fisher matrix for any cosmological parameters whatsoever can be computed directly from @xmath30 , the fisher matrix for the power spectrum itself : ^ = ^t^c , where _ i . in other words",
    ", there is no need to compute and compare large numbers of fisher matrices for various parameter combinations , since they can all be computed directly from @xmath30 . here and throughout",
    ", we will let @xmath31 denote estimates of the true angular power spectrum @xmath8 , so the estimates are _ unbiased _ if they satisfy = c_ . with this notation , we can summarize this section as follows . to test",
    "if a power spectrum estimation method is lossless , we simply compute the covariance matrix _  - and check if it equals the inverse of the fisher matrix @xmath30 of below .",
    "let us now evaluate this important matrix @xmath30 . using the addition theorem for spherical harmonics",
    "gives the well - known correlation function formula = + _ ^_ , where @xmath32 denotes the noise covariance matrix and the matrices @xmath33 are defined as ^_ij p_(_i_j ) . here the @xmath34 denote legendre polynomials and @xmath35 is a unit vector pointing in the direction of pixel @xmath36 .",
    "thus @xmath37 , and equation ( 15 ) of @xcite ( which gives the fisher matrix for a general multivariate gaussian probability distribution ) yields ^c_ = 12= 12 ^ -1^^-1^.    are there any lossless methods ?",
    "below we will answer this question affirmatively .",
    "in this section , we will derive the above - mentioned lossless method .      in many cases ( including some mapmaking algorithms @xcite ) ,",
    "the maximum - likelihood ( ml ) method turns out to be lossless , so one might guess that this would be the case here as well .",
    "indeed , this approach to power - spectrum estimation has been applied to the 4 year cobe dmr data @xcite .",
    "unfortunately , the ml - estimates @xmath31 turn out to depend on the data set @xmath23 in a highly nonlinear way , which gives the ml - estimates two undesirable properties :    1 .",
    "they must be found by numerically solving a system of nonlinear equations , which is time - consuming .",
    "the probability distributions for these estimates are virtually hopeless to compute analytically , which makes it difficult to use the ml - power spectrum estimates in the last step of the data pipeline , in a likelihood analysis to determine cosmological parameters .    for these reasons , it would be a pleasant surprise if the ml - method turned out _ not _ to be lossless , but inferior to some simpler power spectrum estimation technique .",
    "fortunately , as we will see below , there are indeed considerably simpler estimates of the power spectrum that are lossless  specifically , quadratic ones . by a _",
    "quadratic estimator _ ,",
    "we mean one that is a quadratic function of the pixels , taking the form _",
    "= ^t^- _ for some symmetric matrix @xmath38 and some constant @xmath39 . before embarking on detailed calculations ,",
    "let us give a more intuitive argument for why we might expect the best method to be quadratic .",
    "it is easy to see that the entire data set @xmath23 can be recovered from the set of all pair products @xmath40 , apart from an uninteresting overall sign ambiguity : given the matrix @xmath41 , we simply compute @xmath42 and then fix all signs except one using the off - diagonal terms . since the overall sign is irrelevant , the data set consisting of the @xmath1 numbers in @xmath41 therefore contains all the cosmological information that the @xmath3 numbers in @xmath23 did .",
    "our quadratic power estimator @xmath43 is simply a _ linear _ function of these pair products .",
    "is telling us that = _",
    "_ij^_ , , that these pair products are on average just _ linear _ combinations of the coefficients @xmath0 that we want to measure , so by analogy with the mapmaking results of @xcite , we might guess that since the problem is linear , the best solution should be linear , so that there exists an estimator of the form of that is lossless .    encouraged by this , we will now derive the the best method in the quadratic family .",
    "after that , we will give a proof showing that this method is lossless , , that no other ( more nonlinear ) method can possibly do any better .",
    "let us now find the quadratic power spectrum estimators that give the smallest error bars . substituting into and chosing _ =^to make the estimate unbiased , we obtain = _  _ _ , where the _ window function _ is given by _ ^^ .",
    "let us find the estimate of @xmath8 with minimal variance subject to the normalization constraint that @xmath44 .",
    "since we are assuming gaussianity , the covariance matrix of is given by _",
    " = _ ijkl ^_ij^_kl , so we want to find the @xmath38 that minimizes @xmath45 subject to this constraint .",
    "the analogous problem for galaxy surveys was recently solved by hamilton @xcite , and we will follow his notation and let a greek index denote a pair of latin indices , with @xmath46 and @xmath47 . with this notation , @xmath38 and @xmath33 change from @xmath12 matrices to @xmath1-dimensional vectors ( or , since they are symmetric , to @xmath48-dimensional vectors if we restrict ourselves to counting each pixel pair only once ",
    "say , @xmath49 ) . defining the matrix _",
    ", our problem reduces to simply minimizing @xmath50 subject to the constraint @xmath51 . introducing a lagrange multiplier just as in @xcite",
    ", we find the solution to be ^_(^-1)_^_.      unfortunately , is not a very useful result for our application , since the matrix that needs to be inverted is enormous , with dimensions @xmath52\\times[n(n+1)/2]$ ] when eliminating the redundant rows and columns corresponding to double - counted pixel pairs .",
    "for this reason , hamilton proceeds @xcite to provide an approximate method for solving this equation by means of a perturbation series expansion .",
    "fortunately , the giant matrix @xmath53 can be rewritten in a much simpler form using some algebraic tricks .",
    "to show this , let us make an alternative derivation of the optimal matrix @xmath38 .",
    "since both @xmath38 and @xmath54 are symmetric , we can rewrite as _",
    " = 2 , so we simply want to minimize @xmath55 subject to @xmath56 introducing a lagrange multiplier @xmath57 , we wish to minimize the function = . requiring the derivatives with respect to the components of @xmath38 to vanish ,",
    "we obtain ^= ^ , so substituting the @xmath57 that gives @xmath58 leaves us with the simple solution ^= 12_^-1^^-1 , where @xmath16 is the fisher information matrix given by , , @xmath59/2 $ ] . comparing this with ,",
    "we see that has the advantage that only a much smaller matrix @xmath60 needs to be inverted",
    ".      we will discuss the properties of this power spectrum estimation method at some length in section  [ examplesec ] , as well as apply it to the cobe data . before doing this , however , we will now prove that this method is lossless in the sense defined above .",
    "( our derivation of the method merely guaranteed that it was the best _",
    "method , but did not rule out the possibility that it destroys information and is inferior to some more nonlinear technique . )    the way we chose to normalize @xmath61 does clearly not affect the error bars with which we can determine cosmological parameters , since multiplying the estimated power spectrum coefficients @xmath31 by some constants ( or indeed by any invertible matrix ) will not change their information content ( see @xcite ) . to simplify the calculation below ,",
    "let us therefore scrap the @xmath62-factor in and define rescaled power spectrum coefficients y_^t^ , where ^ .",
    "substituting into , we now find that the covariance matrix for @xmath63 reduces to simply -^t = , the fisher matrix .",
    "arranging the true power spectrum coefficients @xmath0 into a vector @xmath64 , takes the simple form = . in other words ,",
    "the window function matrix @xmath21 of is also equal to the ubiquitous fisher matrix .",
    "this means that if we use the vector ^-1to estimate the power spectrum @xmath64 , then this estimator will have the nice property that it is unbiased : = .",
    "this fisher - cramer - rao inequality ( see @xcite for a review ) tells us that the best an unbiased estimator can possibly do ( in terms of giving small error bars ) is for its covariance matrix to equal @xmath17 , the inverse of the fisher matrix . using and",
    ", we find that this covariance matrix is precisely = ^-1[-^t]^-1=^-1 , so @xmath65 is indeed optimal in this sense .",
    "in other words , we have found the best unbiased estimator of the power spectrum , the one which gives the smallest error bars allowed by the fisher - cramer - rao inequality .",
    "is effectively the average of @xmath66 independent multipoles , so for @xmath67 , it will have a virtually perfect gaussian distribution by the central limit theorem .",
    "this means that the post - compression fisher matrix is almost exactly @xmath16 , the value computed from the map , so that the power spectrum estimates retain all the small - scale cosmological information . for the very lowest multipoles @xmath68 ,",
    "the gaussian approximation becomes poor , so that it might be desirable to supplement the power spectrum estimates with some linear measures of the large - scale power ( @xmath69-coefficients , say , as suggested in @xcite ) to ensure that every bit of information is retained .",
    "this may be desirable anyway , to avoid non - gaussianity in the likelihood calculation , as will be further discussed in section  [ parestsec ] .",
    "] the fact that it turned out to be a simple quadratic estimator is good news for cmb data analysis , since this means that it is much simpler to implement in practice than for instance the highly nonlinear ml - method .",
    "in this section , we will discuss various aspects of how the method works . to prevent the discussion from becoming overly dry and abstract",
    ", we will illustrate it with a worked example : application of the method to the 4 year cobe / dmr data .",
    "we combine the 53 and 90 ghz channels ( a and b ) of the cobe dmr 4 year data @xcite into a single sky map by the standard minimum - variance weighting , pixel by pixel .",
    "we use the data set that was pixelized in galactic coordinates .",
    "after excising the region near the galactic plane with the  custom cut \" of the cobe / dmr team @xcite , @xmath70 pixels remain .",
    "as has become standard , we make no attempts to subtract galactic contamination outside this cut .",
    "we remove the monopole and dipole and include this effect as described in the appendix .",
    "the resulting power spectrum is shown in ( top ) , and is very similar to that extracted with the eigenmode method @xcite  we will discuss the relation between various methods below .",
    "a brute force likelihood analysis of the 4 year data set @xcite gives a best fit normalization of @xmath71 for pure sachs - wolfe @xmath72 model , corresponding to the heavy horizontal line in the figure , and we used this as the fiducial power spectrum when computing @xmath54 .",
    "if this model were correct , we would expect approximately @xmath73 of the data points to fall within the shaded @xmath74 error region . as can be seen , the height of this region ( the size of the vertical error bars ) is dominated by cosmic variance for low @xmath75 and by noise for large @xmath75 .",
    "our cobe example illustrates a number of general features regarding how the window function depends on the target multipole and on the sky coverage , as shown in figures 3 and 4 .",
    "however , since we are conforming to the customary way of plotting window functions here , rather than to the definition of , a few clarifying words regarding precisely what is plotted are in order before proceeding .      as has become standard , the vertical axis in shows not @xmath8 but the relatively flat quantity _ (+1)/2 , so we want to interpret the data points as weighted averages of these quantities ( rather than as weighted averages of the @xmath8-coefficients ) , with the window function giving the weights .",
    "in addition , we must take into account the fact that the cobe beam smearing suppresses the true multipoles @xmath8 by the known factors @xmath76 given by @xcite .",
    "we thus rewrite as = = + _ ^_ , where we have defined @xmath77 and _  , and find the fisher matrix for the @xmath78-coefficients to be _",
    " _ __. since each window function by definition must add up to unity , the correct normalization for the band - power estimators of @xmath79 is _ __y_= _ _2^t^-1_^-1 , where the normalization constants are defined by _ ^-1 .",
    "this implies that the mean is = _",
    "__ , where the window function _",
    "__ satisfies @xmath80 , and the covariance is - = _",
    "__. for @xmath81 , this expression gives the ( squared ) error bars plotted on the data points @xmath82 in .",
    "the horizontal point locations and the corresponding horizontal bars give the means and widths of the window functions @xmath83      shows the window functions for estimating the multipoles @xmath8410 , 15 and 20 . as can be seen , their shape and width is more or less the same , so increasing the target multipole @xmath85 merely translates them in @xmath75-space .",
    "this quantitative result is easy to understand in terms of the quantum mechanics analogy made in @xcite : if the wave function of a quantum particle on a sphere is required to vanish in certain regions , then its angular momentum distribution ( spherical harmonic coefficients ) must have a certain minimum width which is independent of the average angular momentum ( in our case , independent of the target multipole @xmath85 ) .",
    "the heisenberg dispersion formula (  uncertainty relationship \" ) tells us that this minimum width is of order @xcite ~1/ , where @xmath86 is the angular size in radians of the smallest dimension of the sky patch .",
    "this simple scaling is quantitatively illustrated in .",
    "for instance , comparing the two middle panels shows that adding a second hemisphere does not reduce the width of the window ( since @xmath86 remains unchanged ) , but merely removes the power leakage from the even multipoles ( since the galaxy cut is approximately symmetric under reflection , and even and odd multipoles remain roughly orthogonal , since they have opposite parity ) .",
    "how does our method work ? in this section",
    ", we will see that it is quite straightforward to acquire an intuitive understanding what the method does with the data and why this improves the situation .",
    "first we note that can be rewritten as _",
    "^t^ , where the vector @xmath87 is defined as ^-1 . since @xmath87 also consists of @xmath3 numbers , we can plot it as a sky map , as is done in .",
    "moreover , by the addition theorem for spherical harmonics , we can factor the matrix @xmath88 as ^= _ _^t , where the @xmath89-dimensional matrix @xmath90 is defined as ^_imy_m(_i ) . here and throughout",
    ", we let @xmath91 denote the real - valued spherical harmonics , which are obtained from the standard spherical harmonics by replacing @xmath92 by @xmath93 , @xmath94 , @xmath95 for @xmath96 , @xmath97 , @xmath98 respectively . combining the last four equations",
    ", we find that _ _m",
    "=- ^ |_i y_m(_i ) z_i|^2 , which we recognize as the method of expansion in truncated spherical harmonics @xcite , _ but applied to the map _",
    "@xmath87 _ instead of the map _",
    ".    compares the maps @xmath23 and @xmath87 , and visual inspection reveals that although the small - scale features of @xmath23 remain visible in @xmath87 , there are two obvious differences :    1 .",
    "@xmath87 looks high - pass filtered , with large - scale fluctuations rendered almost invisible . 2 .",
    "the edges are softened by downweighting the pixels near the galaxy cut , notably in the high signal - to - noise case .",
    "as described below , both of these phenomena have a simple intuitive explanation .      since @xmath99",
    ", it follows that = ^-1 ^ -1=^-1 . in other words , those modes which had the most power in the original map @xmath23",
    "have the least power in the map @xmath87 and vice versa .",
    "computing @xmath82 from @xmath87 with the simple spherical - harmonic method is therefore akin to the standard way of estimating a mean with inverse - variance weighting : first we re - weight the numbers by dividing them by their variance , then we perform a straight average on the result .",
    "illustrates the effect of this procedure in the fourier ( multipole ) domain , on the window functions .",
    "the top panel shows the result of applying the straight spherical - harmonic method directly to @xmath23 .",
    "the reason that the results are so poor is that the power spectrum @xmath29 falls rapidly with @xmath75 , so that even though the  red leak \" from lower multipoles is small on geometric grounds , the amount of large - scale power being aliased into the estimates of high multipoles is nonetheless comparable to the weak small - scale signal that we are trying to measure . the middle panel shows the optimal method , , applying the straight spherical - harmonic method to @xmath87 .",
    "since the power spectrum of @xmath87 is  tilted \" to suppress the large - scale power , the troublesome red leak is seen to be virtually eliminated : it no longer matters that some fraction of the large - scale power in @xmath87 gets aliased down to small scales , since there is is so little large - scale power there in the first place .",
    "the bottom panel shows the window function that would result if the signal - to - noise ratio was about 500 times higher , roughly corresponding to what is expected for the upcoming _",
    "planck _ satellite . here",
    "the high - pass filtering is seen to be more extreme , and the window function is seen to be slightly narrower still . if the pixel noise is uniform and uncorrelated , then @xmath54 will clearly become proportional to the identity matrix if we let the signal - to - noise ratio approach zero .",
    "this means that if the noise in a map is orders of magnitude greater than the signal , then @xmath100 and the best pixel weighting becomes to do nothing at all , leaving the map as it is . in this sense , the three maps in form a progression of @xmath87-maps corresponding to increasing signal - to - noise .",
    "the second salient feature of the method ,  feathering \" the edges , is also easy to understand in terms of the quantum mechanics analogy given in @xcite .",
    "for the window function to be narrow , we loosely speaking want the pixel weighting to be narrow in the fourier ( multipole ) domain , so to avoid excessive  ringing \" in fourier space , the weighting in real space should be continuous and smooth .",
    "this standard signal - processing procedure is also known as apodizing , and is routinely used in the analysis of one - dimensional time series data @xcite .",
    "an alternative way to see why the edges are softened is to consider the noise map , , the map of the standard deviations of the pixels in @xmath87 .",
    "this is simply the square root of the diagonal part of its covariance matrix , , @xmath101 .",
    "as is readily verified even for a simple one - dimensional array of pixels , the diagonal elements of @xmath102 will be smaller near the edges even though all diagonal elements of @xmath54 itself are the same ( since @xmath103 for some correlation function @xmath104 when the noise is uniform ) .",
    "just as with the high - pass filtering , the degree of edge tapering is seen to increase with the signal - to - noise ratio @xmath105 .",
    "as mentioned , @xmath106 gives @xmath107 , , no edge softening at all , whereas the noise map tends to zero at the edges when @xmath108 . in this sense ,",
    "our new method strikes a balance between the all - out apodization of the eigenmode method @xcite and the _ laissez - faire _ approach of the hauser - peebles method @xcite , with the amount of softening depending on what is affordable given the noise . clearly , if @xmath109 , the sole source of variance in @xmath82 is the noise , so the widths of the window functions ( and hence the cosmic variance leakage from unwanted aliased multipoles ) is irrelevant , and we simply wish to weight all pixels equally ( or by the inverse of their noise variance if the noise is non - uniform ) .",
    "if there is very little noise , on the other hand , we can go to great lengths to narrow down the window functions .",
    "indeed , the excellent s / n of _ planck _ drives the algorithm to  deconvolve \" the power spectrum to obtain an even narrower window in the bottom panel of than in the middle one .",
    "a quick glance at might give the impression that inversion and multiplication of @xmath12 matrices are required to compute the estimated power spectrum @xmath82 , which are devastatingly slow @xmath2 operations .",
    "fortunately , this impression is deceptive , since shows that merely a matrix - vector product ( ordo @xmath1 ) , a vector - vector product ( ordo @xmath3 ) and a linear equation solution stemming from need be carried out to obtain the raw power estimates .",
    "the latter is also an ordo @xmath1 operation when using an iterative approach , , the gauss - seidel method .",
    "moreover , there is no need to store the @xmath12 elements of @xmath33 or @xmath54 , since they can be rapidly computed on the fly , as needed , for instance with cubic spline interpolation , so the storage requirements here are merely ordo @xmath3 .",
    "similar manipulations enable great time savings when computing the fisher matrix , which as we saw gave both the window functions and the covariance matrix of the power estimates by simple rescalings of its rows and columns .",
    "suppose we are interested in the power spectrum up to some monopole @xmath110 .",
    "there are @xmath111 spherical harmonics with @xmath112 , so let us define the @xmath113-dimensional matrix @xmath114 just as in @xcite , as _",
    "iy_m(_i ) . here",
    "we have combined @xmath75 and @xmath115 into a single index @xmath116 using , and the fact that a trace of a product of matrices is invariant under cyclic permutations , we obtain the useful result that = 12_m =- ^_m=-^ ( _ )^2 , where the matrix @xmath117 is defined as ^t^-1 . since @xmath118 can be solved iteratively for each spherical harmonic ( row of @xmath114 ) separately , and since the structure of shows that there is no need to ever load the entire @xmath117-matrix into memory all at once , the computation of @xmath16 thus poses no significant computer memory challenges and lends itself well to parallelization .",
    "the computation of the the noise bias corrections @xmath119 are straightforward to accelerate in an analogous way .",
    "note that also proves that all elements of the fisher matrix are non - negative , which among other things means that the optimal method will never give window functions that go negative .    alternatively ,",
    "if an approximation of @xmath16 is deemed satisfactory , it can of course be estimated quite rapidly by computing @xmath82 from a large number of monte - carlo skies .",
    "finally , it should be noted that the calculation of the parameter covariance matrix takes roughly the same amount of time for this method as it does for the hauser - peebles method . for that case",
    ", the covariance matrix for the power spectrum estimates can be rewritten in the form of the right hand side of but with @xmath120 instead of @xmath121 since matrix multiplication takes roughly as long as matrix inversion , this shows that although the simple approach of estimating the power spectrum with a straight truncated spherical harmonic expansion of the original map is inferior in terms of destroying information , it is not substantially faster .",
    "in this section , we will briefly discuss that part of the data analysis pipeline in figure 1 which lies beneath the power spectrum estimation step . as discussed in the introduction",
    ", there are many reasons to plot the power spectrum for direct visual inspection .",
    "the power spectrum estimates also constitutes a small and manageable data set that retains all the cosmological information from the original map in gaussian models , and is therefore useful as a starting point when constraining cosmological models and model parameters .",
    "we will now discuss these two applications in turn .",
    "given the vector of raw power spectrum estimates @xmath123 , where @xmath124 , @xmath125 , and @xmath126 is defined as in section  [ losslesssec ] , there are a number of ways to take linear combinations of them , normalize them and plot them with vertical and horizontal error bars as in .",
    "we will now discuss some natural ones briefly and comment on their relative merits .",
    "the minimalistic approach is of course to do nothing and simply plot @xmath123 as is .",
    "this is the simple approach taken in the top panel of .",
    "one disadvantage of the previous approach is the profusion of data points , sampling the power spectrum with a much narrower @xmath75-spacing ( in intervals @xmath127 ) than the scale on which typical models are expected to vary noticeably ( typically @xmath128 , at least for @xmath129 ) .",
    "a simple remedy is of course to average the raw power estimates in appropriate bands , essentially smoothing .",
    "the exact opposite approach is to  un - smooth \" or deconvolve the power spectrum so that all data points become uncorrelated and all window functions become kronecker delta functions .",
    "although this can be formally accomplished by computing @xmath130 as in section  [ losslesssec ] , where we did this to prove that our method had retained all the information that there was , this is of course a terrible idea in practice , since incomplete sky coverage makes the fisher matrix nearly singular .",
    "the result would be a plot with gigantic error bars , which is simply nature s way of telling us that we can not really measure the power spectrum with a resolution below the natural scale set by @xmath131 .",
    "a more fruitful way of producing uncorrelated data points is to plot the numbers in the vector @xmath132 , where the rows of the matrix @xmath133 are the solution vectors to the generalized eigenvalue problem = for some symmetric matrix @xmath134 .",
    "here @xmath11 is a diagonal matrix containing the eigenvalues .",
    "it is easy to show that for any choice of @xmath134 , all the new data points will be uncorrelated with unit variance ( they are of course appropriately rescaled when plotted ) , and the new window function matrix will be simply @xmath135 .      one special case of the above approach is to choose @xmath136 , the identity matrix , which reduces it to a so - called principal component analysis . by sorting the new data points ( the principal components ) by their eigenvalues ,",
    "one can rank them from best to worst and throw away a substantial number of essentially redundant ones , thereby getting around the problem that there are , loosely speaking , too many data points for them to all be uncorrelated and yet not in some sense pathological .",
    "in two recent papers @xcite , an extensive study of choices of @xmath134 was carried out for the related problem of how to present the power spectrum measured from galaxy surveys .",
    "it was found that most choices , including that of principal component analysis , are unfortunately _ not _ particularly useful , since they tend to produce quantities whose window functions are  unphysical \" in the sense of being extremely broad and often negative .",
    "however , it was found that a certain limiting case @xcite tends to produce nice and clean window functions , and in addition eliminates the need to solve an eigenvalue problem .",
    "these cases correspond to factoring the fisher matrix as = ^t for some matrix @xmath137 , and chosing @xmath138 . of the infinitely many choices of @xmath137 , three are particularly attractive @xcite :    1 .",
    "if one requires @xmath137 to be _ lower - triangular _ , in which case @xmath139 corresponds to a cholesky decomposition , the cobe case gives the narrow and non - negative window functions in the middle panel of , with side lobes only to the right .",
    "2 .   similarly , one could obtain window functions with side lobes only to the left by chosing @xmath137 _ upper - triangular_. 3 .   a third choice ,",
    "which is the personal favorite of the author , is choosing @xmath137 _ symmetric _ , which we write as @xmath140 .",
    "the square root of the fisher matrix is seen to give beautifully symmetric window functions ( , bottom ) that are not only non - negative , but also even narrower than the original ( top ) , which has roughly the bottom profile convolved with itself .",
    "the bottom panel of shows the cobe power spectrum plotted with this last method .",
    "these 29 data points thus contain all the cosmological information from cobe , distilled into 29 chunks that are not only collectively exhaustive ( jointly retaining all the cosmological information ) , but mutually exclusive ( uncorrelated ) as well .",
    "the above - mentioned band averaging now has the nice feature that the band powers will automatically be uncorrelated as well , so to reduce scatter , the 29 measurements have been binned into 8 bands in table 1 and .",
    "the data and references for the other experiments plotted can be found in recent compilations  @xcite .",
    "we close this discussion by remarking that with all these approaches , it is possible for data points to be negative , which may annoy certain readers since the true power spectrum is by definition nonnegative . it should be emphasized that this is a purely stylistic issue of no scientific importance whatsoever . as we proved in section  [ losslesssec ] , the raw power estimates contain all the cosmological information there is , regardless of whether we plot them or not . the total power that we measure in a given multipole will always be nonnegative , and the reason that negative values can occur in figures is simply that we are plotting the difference between two positive quantities : what we measure and the noise bias . plotting the the sum of @xmath141 and the noise bias would result in figures guaranteed to be free of negative points , clearly containing exactly the same information as those described above since the noise bias is a set of known constants , but having the undesirable property of being biased upward .",
    "alternatively , some non - linear mapping could be used to guarantee positivity of the plotted points , but for subsequent analysis as outlined in the following section , we obviously want to retain our simple quadratic estimators to avoid complicating the statistical properties of the measured power spectrum .      the second , and arguably most important , use for the power spectrum estimates is to make it possible to place sharp quantitative constraints on cosmological models and their parameters .      as described in @xcite ,",
    "likelihood analysis has emerged as one of the most popular data analysis tools in cosmology because it is often simple to implement and in addition is the best method in certain asymptotic situations . in our case , measuring say the 11 cdm - parameters of @xcite via a direct likelihood analysis using our power spectrum estimates @xmath82 would unfortunately be extremely cumbersome numerically for the case of a megapixel cmb map .",
    "the reason is that it would , even in the crude and poor approximation that @xmath82 is gaussian all the way down to the lowest multipoles , require computing their @xmath142 covariance matrix at a grid of points in parameter space .",
    "although this covariance matrix is relatively small , we saw above that its computation was so time - consuming that it would be preferable to compute it only once ( or a few times ) .",
    "in addition , the central limit theorem only guarantees that the multipole estimates have gaussian probability distributions for @xmath67 , so the exact likelihood function will be extremely cumbersome to compute when the lower multipoles are included in the analysis .",
    "this situation is similar to that in section  [ firstguesssec ] , where we found that the ml - method was numerically undesirable and hoped that a simpler method would provide error bars that were equally good or better . in that instance , a simple quadratic method came to the rescue , and we will argue that the story repeats itself here in the final step in the pipeline : that the simple ( quadratic ) chi - squared method is likely to be , if not better , at least almost as good as the ml - method when fitting parameters to the power spectra measured from megapixel cmb maps .",
    "the karhunen - love data compression problem has been generalized and solved for the case at hand here @xcite : we have a data vector ( say , the raw power spectrum estimates @xmath63 ) whose mean and covariance matrix - both depend in a known way on the parameters that we wish to estimate ( say @xmath9 , @xmath10 , ) . when changing the parameters , the likelihood function of course changes for two reasons :    *",
    "because @xmath143 changes * because @xmath137 changes    another way of phrasing this is that the information that the ml - method extracts from the parameters comes from two sources : the parameter dependence of @xmath143 and that of @xmath137 . in @xcite , it was found that for our case , as long as the parameters were well constrained ( as is anticipated for both _ map _ and _ planck _",
    "@xcite ) , _ virtually all the information came from @xmath143 , not from @xmath137 .",
    "_ this means that , in the gaussian approximation , the likelihood curve near the maximum is well approximated by l&&[]^-1/2 + & & , where @xmath137 is a merely a _ constant _ matrix evaluated somewhere near the best fit point in parameter space .",
    "maximizing this is of course amounts to making a simple chi - squared model fit to the plotted power spectrum , and requires no overly tedious numerical calculations at all : the mean vector predicted by a given model is simply given by , , by the fisher matrix ( which is computed once and for all ) times the model power spectrum .",
    "if the best fit power spectrum turns out to be so different from the one assumed when computing @xmath16 that the accuracy of comes into doubt , the best fit parameter values can of course be used to repeat the entire procedure iteratively .",
    "needless to say , the approach outlined in this section needs to be implemented and tested in considerable detail before any strong statements can be made about its feasibility . for instance",
    ", there is no guarantee that the chi - squared method ( nor , for that matter , the ml - method ) will give unbiased parameter estimates , so monte - carlo calibrations are necessary in either case .",
    "the fact that the multipole estimates with @xmath144 are non - gaussian also means that chi - squared parameter estimates made with the gaussian expression of are likely to give error bars on the parameters that are slightly above the theoretical minimum .",
    "we merely conclude this section by saying that it appears _ plausible _ that a simple chi - squared approach in the final step of figure 1 will give error bars on cosmological parameters that are almost as small as theoretically possible .",
    "we have presented a new method for power spectrum estimation from cmb maps and argued that it is the best choice for the box labeled @xmath145 in figure 1 :    * just as the mapmaking step above it , it can compress the data set by a large factor while retaining all the cosmological information . *",
    "it is simple enough to be computationally feasible in practice even for future megapixel sky maps . *",
    "the statistical properties of the power spectrum estimates are straightforward to compute , and using a simple chi - squared parameter fitting approach in the bottom box in the figure is likely to give error bars on the parameters that are almost as small as theoretically possible .",
    "we illustrated the method details by applying it to the 4 year cobe / dmr data .",
    "it roughly speaking involves subjecting the map to a high - pass filter and some edge softening , and then analyzing the resulting map with the hauser - peebles method , , with a straight expansion in truncated spherical harmonics .",
    "it reduces to the hauser - peebles method in the limit of zero signal - to - noise .",
    "both of these methods require approximately the same amount of cpu time . when the signal - to - noise is very high , it becomes quite similar to the maximum spectral resolution method @xcite .",
    "however , even in this limit , it has the advantage ( in addition to being strictly lossless , which the method presented in @xcite is not ) that it does not require the solution of an eigenvalue problem , thus being much faster .",
    "it has recently been shown that there is a mapmaking method that is both lossless @xcite and computationally feasible @xcite . combining that with the present results , we conclude that all aspects of the",
    " main tube \" of the data analysis pipeline are now under control , making it plausible that future cmb missions can deliver the promise of accurate measurements of cosmological parameters not merely in principle but also in practice , without floundering on computational difficulties , if all other aspects of the problem are as simple as possible . by this last caveat ,",
    "we mean the following rosy scenario :    * there are no unforeseen systematic errors .",
    "* non - gaussian and anisotropic foregrounds can be removed down to a tolerable level already in the map stage .",
    "* the cmb fluctuations are gaussian .",
    "* the true model will turn out be be something similar to what we expect , so that the power spectrum really contains information about our classical cosmological parameters .",
    "all of these issues require substantial amounts on work before we can trust our fledgling data analysis pipeline in figure 1 to be able to make the most of the real cmb data sets that await us .",
    "the author wishers to thank andrew hamilton for useful discussions .",
    "support for this work was provided by nasa through a hubble fellowship , # hf-01084.01 - 96a , awarded by the space telescope science institute , which is operated by aura , inc . under nasa contract nas5 - 26555 .",
    "the cobe data sets were developed by the nasa goddard space flight center under the guidance of the cobe science working group and were provided by the nssdc .",
    "since the monopole and the kinematic dipole of the cmb are orders of magnitude larger than the multipoles of cosmological interest @xmath146 , one customarily removes them from the map @xmath23 prior to any subsequent analysis .",
    "indeed , the monopole can not even be measured by differential experiments ( such as cobe / dmr ) .",
    "suppose that all multipoles @xmath147 are removed from the data set .",
    "this means that the data set at our disposition , say @xmath148 , is given by , where @xmath149 is a projection matrix that projects onto the subspace orthogonal to these multipoles .",
    "if the columns of a matrix @xmath150 form an orthonormal ( @xmath151 ) basis for the space of these unwanted multipoles is readily constructed by starting with the unwanted columns in the multipole matrix @xmath114 ( the first 4 columns if @xmath152 ) and orthonormalizing them with gram - schmidt or cholesky procedure @xcite .",
    "] , then = -^t .",
    "the covariance matrix of the available data is therefore = = ^t .",
    "since @xmath150 has @xmath153 columns , @xmath149 and @xmath154 have rank @xmath155 .",
    "hence @xmath154 is singular and non - invertible , and the method we have presented can not be applied in its most straightforward implementation .",
    "this problem occurs simply because the numbers in @xmath148 are not independent , , since @xmath153 of them can be expressed as linear combinations of the others .        1 .",
    "simply throw away @xmath153 of the data points in @xmath148 .",
    "all the remaining data points are independent , so the resulting covariance matrix ( @xmath154 with the corresponding rows and columns removed ) is invertible .",
    "the drawback of this approach is that the covariance matrix tends to be poorly conditioned , which may give numerical difficulties if @xmath3 is very large .",
    "2 .   use @xmath54 rather than @xmath154 for the calculations , but choose a fiducial power spectrum where @xmath0 is very large for @xmath147 . then the method itself will remove the unwanted multipoles with great accuracy .",
    "this approach is of course not strictly correct , but is easy to implement and an excellent approximation in most realistic cases .",
    "3 .   follow our method to the letter , but in place of @xmath156 ( which is undefined ) , use the  pseudo - inverse \" of @xmath154 , the matrix defined as ^-1^t .      we will now show that the definition of @xmath137 is independent of the choice of the constant @xmath157 and that this pseudo - inverse approach gives the desired optimal results .",
    "let @xmath158 be an orthonormal @xmath12 matrix whose first @xmath153 columns equal the columns of @xmath150 .",
    "in other words , the columns of @xmath158 form an orthonormal basis and split into two blocks , corresponding to the unwanted and wanted multipoles , respectively . in this new basis , the projection matrix @xmath149 takes the simple form ^t= (        the observed multipoles @xmath159 are plotted with @xmath74 error bars using our basic method ( top ) and made uncorrelated with the @xmath160-method of section  [ uncorrsec ] ( bottom ) .",
    "the vertical error bars include both pixel noise and cosmic variance , and the horizontal bars show the width of the window functions used .",
    "if the true power spectrum is given by @xmath72 and @xmath161 ( the heavy horizontal line ) , then the shaded region gives the @xmath74 error bars and the dark - shaded region shows the contribution from cosmic variance .",
    "[ clfig ]      as the sky coverage decreases , the window function widens from a kronecker delta to have a width @xmath131 .",
    "in addition , since the custom cut is almost symmetric , it approximately preserves the orthogonality of even and odd multipoles .",
    "[ widthfig ]    the 4-year cobe / dmr data ( top ) is shown after multiplication by the inverse pixel covariance matrix corresponding to the actual noise level ( middle ) and corresponding to the noise - level projected for _ planck _ ( bottom ) .",
    "[ mapsfig ]"
  ],
  "abstract_text": [
    "<S> * abstract : * a new method for estimating the angular power spectrum @xmath0 from cosmic microwave background ( cmb ) maps is presented , which has the following desirable properties : + ( 1 ) it is unbeatable in the sense that no other method can measure @xmath0 with smaller error bars . + ( 2 ) </S>",
    "<S> it is quadratic , which makes the statistical properties of the measurements easy to compute and use for estimation of cosmological parameters . </S>",
    "<S> + ( 3 ) it is computationally faster than rival high - precision methods such as the nonlinear maximum - likelihood technique , with the crucial steps scaling as @xmath1 rather than @xmath2 , where @xmath3 is the number of map pixels . </S>",
    "<S> + ( 4 ) it is applicable to any survey geometry whatsoever , with arbitrary regions masked out and arbitrary noise behavior . </S>",
    "<S> + ( 5 ) it is not a  black - box \" method , but quite simple to understand intuitively : it corresponds to a high - pass filtering and edge softening of the original map followed by a straight expansion in truncated spherical - harmonics . </S>",
    "<S> + it is argued that this method is computationally feasible even for future high - resolution cmb experiments with @xmath4 . </S>",
    "<S> it is shown that @xmath0 computed with this method is useful not merely for graphical presentation purposes , but also as an intermediate ( and arguably necessary ) step in the data analysis pipeline , reducing the data set to a more manageable size before the final step of constraining gaussian cosmological models and parameters  while retaining all the cosmological information that was present in the original map .    </S>",
    "<S> # 1#1 # 1#1    # 1;#2;#3;#4;#5    # 1 , _ # 3 _ * # 4 * , # 5 ( # 2 ) .    # 1@xmath5 # 1@xmath6 # 1equation  ( [ # 1 ] ) </S>",
    "<S> # 1equation  ( [ # 1 ] ) # 1  ( [ # 1 ] )    # 1figure  [ # 1 ] # 1figure  [ # 1 ]    *l * *p *  * s *  * c *    = cmmib10    specialpagefalse oddfoot @page>1 @font@page=1 _ accepted for publication in phys . </S>",
    "<S> rev . </S>",
    "<S> d. available in color from h t t p://www.sns.ias.edu/@xmath7max / cl.html _ +   evenfootoddfoot </S>"
  ]
}