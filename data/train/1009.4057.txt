{
  "article_text": [
    "gauge - invariant helicities are meaningful measures of nonpotentiality of a magnetic field in active regions .",
    "these measures in combination with energetic estimates and their time dependence may be used for interpretation and prediction of various forms of solar activity ( see ; ; ; ) .",
    "self and mutual helicities correspond to the twist and writhe of confined flux bundles , and the crossing of field lines in the magnetic configuration respectively @xcite .",
    "time evolution of berger relative helicity measures the transport of magnetic helicity through the surface and the effect of boundary transverse motions @xcite .",
    "these invariants represent magnetic topology of nonpotential magnetic configurations in active regions and its transformation caused by eruption .",
    "this paper considers a problem of exact calculation of the helicity invariants within a rectangular box .",
    "it is supposed that the full magnetic field vector is prescribed everywhere in the rectangular box .",
    "the helicity calculation problem stated in this form as opposed to that stated for a half - space @xcite is best suited for fixing physical characteristics of an active region . at present , it is possible to calculate force - free spatial magnetic field distribution in a bounded volume ( see ; ) . magnetic field extrapolation and calculation of helicity invariants and free energy",
    "may be used for physical analysis of solar activity . in this paper",
    ", we examine the algorithm for calculating helicity invariants and test it on a force - free model @xcite presented in vector - potential form .",
    "a key feature of the algorithm is the numerical solution to the boundary problem for a potential magnetic field @xmath0 in the rectangular box @xmath1 in terms of the vector potential satisfying conditions @xmath2 and @xmath3 .",
    "magnetic helicity as a gauge invariant measure may be strictly defined only for infinite space or finite volume bounded by magnetic surfaces .",
    "the helicity has a property to remain constant even when magnetic reconnection dissipates energy .",
    "the term of magnetic helicity and the condition of constant magnetic topology can not be applied to any bounded volume because the vector potential can not be affected by an arbitrary additional gradient function ( gauge transformation ) . choosing potential field as a reference field @xmath4 , @xmath5 @xmath6",
    "one can obtain three gauge - invariant helicity measures ( see ; and ) for the bounded volume @xmath1 : @xmath7 @xmath8 @xmath9 here @xmath10 ; @xmath11 ; @xmath12 is the outer normal to @xmath1 on @xmath13 . @xmath14  the scalar potential of the gradient field beyond @xmath1 whose normal component on the surface @xmath15 corresponds to that of @xmath16 @xmath17 where @xmath16 for @xmath18 in @xmath1 is defined as @xmath19 using gauge invariance , one can choose the following conditions on the vector potential @xmath20 @xmath21 condition ( [ eq9 ] ) is useful for defining reference helicity ( [ eq5 ] ) .",
    "in this case , the time evolution of @xmath22 describes helicity transport through the surface ( see ) ,",
    "@xmath23    the sum of two gauge measures ( [ eq3 ] ) and ( [ eq4 ] ) is the reference helicity defined by : @xmath24 reference helicities ( [ eq5 ] ) and ( [ eq11 ] ) coincide only in special cases of @xmath1 - the half space or infinite space above the sphere .",
    "given only a magnetic field vector in a bounded volume @xmath25 , it is necessary to do the following steps to obtain helicity invariants ( [ eq3])-([eq5 ] ) :    a ) : :    to solve boundary problems ( [ eq1 ] ) , ( [ eq2 ] ) for the vector potential    @xmath26 ( if @xmath26 is known ,    eq . ( [ eq2 ] )",
    "gives a solution to @xmath27 for a    given @xmath28 ) ; b ) : :    to obtain the vector potential of the confined magnetic field    @xmath16 using eq .",
    "( [ eq7 ] ) ; c ) : :    to obtain the scalar potential @xmath14 on    @xmath29 corresponding to ( [ eq6 ] ) .    in this paper",
    ", we solve problems a ) and c ) for the rectangular domain : @xmath30 . as mentioned above",
    ", problem b ) has already its analytical solution ( [ eq7 ] ) .",
    "let @xmath31 consider the problem of finding the vector potential @xmath32 satisfying equations : @xmath33 and the boundary condition @xmath34 if it is possible to solve the problem ( [ eq12])-([eq14 ] ) , the vector - potential @xmath26 equation corresponding to ( [ eq9 ] ) can be written as @xmath35 where @xmath36 is the solution to ( [ eq13 ] ) with boundary conditions @xmath37 the solution to ( [ eq12])-([eq14 ] ) can be written as a sum : @xmath38 here @xmath39 is the solution to ( [ eq13 ] ) with the boundary function in ( [ eq14 ] ) @xmath40 @xmath41 where @xmath42 - the @xmath43-th side of the rectangular box @xmath1 ; @xmath44 is the superposition of vector potentials given by the system of 5 magnetic monopoles located beyond the box @xmath1 @xmath45}.\\ ] ] this system of monopoles satisfying equations ( [ eq19 ] ) can be easily constructed by fixing their @xmath46 locations and @xmath47 orientations in space and solution of linear algebraic system of equations for unknown magnitudes @xmath48 ( orts @xmath47 should be chosen so that tails of monopoles do not cross the volume @xmath1 ) .",
    "to each problem ( [ eq13]),([eq18 ] ) on @xmath39 there is a solution giving a unique field @xmath49 , and thus there is a solution to ( [ eq12])-([eq14 ] ) on @xmath50 , giving a unique @xmath27 .    due to the freedom to choose gradient normalization",
    ", we can reformulate problem ( [ eq13]),([eq18 ] ) on @xmath39 in terms given by : @xmath51 @xmath52 @xmath53 @xmath54 @xmath55 @xmath56 @xmath57 @xmath58 here the subscript @xmath59 stands for the trace of the operator or the field on the boundary ; the derivative @xmath60 in equation ( [ eq28 ] ) means the derivative of the normal to the surface @xmath61 in the plane of @xmath42 .",
    "further , without loss of generality , is assumed that index @xmath43 corresponds to the side lying in the plane @xmath62 .",
    "then @xmath63 from equation ( [ eq26 ] ) .",
    "if @xmath64 is known , tangential components @xmath65 and @xmath66 are bvp solutions to ( [ eq21])-([eq26 ] ) and satisfy the properties for @xmath61 , which follow from equations ( [ eq24 ] ) and ( [ eq28 ] ) : @xmath67 @xmath68 properties ( [ eq29 ] ) and ( [ eq30 ] ) ) allow us to choose suitable orthonormal bases for @xmath69 and @xmath70 on @xmath42 in @xmath71 @xmath72 @xmath73 here @xmath74 , @xmath75 are the scales of @xmath42 .",
    "basis functions ( [ eq31 ] ) and ( [ eq32 ] ) satisfy ( [ eq29 ] ) and ( [ eq30 ] ) , therefore expansions @xmath69 and @xmath70 in these bases converge according to the norm of @xmath76 in the neighborhood of @xmath61 ( i.e. , their expansions converge to them smoothly on @xmath61 ) .",
    "using equations ( [ eq31 ] ) and ( [ eq32 ] ) , one can find a harmonical solution in @xmath25 to problem ( [ eq21])-([eq28 ] ) : @xmath77 here @xmath78 @xmath79 @xmath80 solution ( [ eq33 ] ) satisfies ( [ eq24 ] ) in @xmath71 and strictly satisfies ( [ eq21])-([eq23 ] ) , ( [ eq25 ] ) and ( [ eq26 ] ) . choosing suitable bases ( [ eq31 ] ) and ( [ eq32 ] )",
    "provides smooth solutions in the neighborhood of @xmath61 .",
    "the magnetic components expressed through partial derivatives @xmath39 can be easily represented by analytical expressions of ( [ eq33 ] ) .",
    "the same method is applied to all sides of @xmath1 . in numerical implementation of this scheme ,",
    "expansions ( [ eq33 ] ) may be limited by the number of terms corresponding to dimensions of the grid @xmath81 . in our implementation , we show integrals of ( [ eq35 ] ) as a sum of analytical integrals in grid cells , representing functions @xmath82 and @xmath83 as a 2d linear interpolation in the cell of their grid values .",
    "let us consider the same side @xmath62 as in previous item .",
    "the solution to ( [ eq27 ] ) , ( [ eq28 ] ) will be presented as follows : @xmath84 where @xmath85 is the inhomogeneous solution to ( [ eq27 ] ) .",
    "the second and third components are potential functions satisfying the two - dimensional homogeneous laplace equation .",
    "@xmath86 will be defined as superposition of the potentials @xmath87 where the vector of coefficients @xmath88 is selected to satisfy eight conditions of equality between tangential derivatives @xmath86 and @xmath89 at four vertices of @xmath42 and three conditions of equality between @xmath86 and @xmath89 integrals on any three edges of @xmath42 .",
    "thus , given that the surface integral of @xmath90 is @xmath91 , the difference of @xmath92 have zero tangential derivatives at vertcies of @xmath42 and zero means on all edges of @xmath42 .",
    "let us label @xmath42 edges by @xmath93 and define boundary univariate functions @xmath94 equal to values of the normal derivative of @xmath92 on corresponding edges @xmath93 .",
    "@xmath95 will be defined as potential functions satisfying the neumann problem and the boundary condition : @xmath96 without loss of generality , let @xmath93 corresponds to an edge on the line @xmath97 .",
    "the solution to the problem @xmath95 in this case can be written in the following form : @xmath98 @xmath99    solution ( [ eq41 ] ) satisfies ( [ eq40 ] ) in @xmath71 and strictly satisfies ( [ eq27 ] ) , ( [ eq28 ] ) in @xmath100 .",
    "solution ( [ eq41 ] ) is smooth at the vertices of @xmath42 .",
    "components @xmath69 and @xmath70 expressed through partial derivatives @xmath95 can be described by the analytical expressions of ( [ eq41 ] ) .",
    "the same method is applied to every edge of @xmath42 . in numerical implementation of this scheme",
    ", expansions ( [ eq41 ] ) can be limited by the number of terms corresponding to grid dimensions @xmath101 . in our implementation",
    ", we show integrals of ( [ eq42 ] ) as a sum of analytical integrals in grid cells , representing functions @xmath102 as a 2d linear interpolation in the cell of its grid values .      to obtain potential @xmath14 satisfying equation ( [ eq6 ] ) on the surface @xmath13",
    ", we use ( [ eq7 ] ) . equation ( [ eq7 ] )",
    "yields @xmath16 on the surface @xmath103 limiting the volume @xmath104 @xmath105 where @xmath106 , are scales of the elementary cell of the discrete grid defined on @xmath1 . to calculate @xmath14",
    ", we first estimate its values on the grid @xmath103 . to do this",
    ", we specify its zero value at an arbitrary vertex of @xmath107 @xmath108 and then calculate integrals on the broken curves @xmath109 jointing vertices @xmath110 on @xmath103 and @xmath111 : @xmath112 where @xmath113 is the unit local tangential vector to @xmath109 . to calculate @xmath14 on @xmath13 ,",
    "we add integrals @xmath114 integrals ( [ eq44 ] ) , ( [ eq45 ] ) are approximated by simple summation .",
    "integrals ( [ eq44 ] ) do not depend on @xmath109 curve shape .",
    "therefore in their discrete implementation the choice of different configurations of @xmath109 should result in small differences between results of integration of ( [ eq44 ] ) , ( [ eq45 ] ) .",
    "let us take the calculation of helicity invariants ( [ eq3])-([eq5 ] ) , ( [ eq11 ] ) as an example for the analytical force - free model @xcite .",
    "the expression for the magnetic field will be written in terms of vector - potential for @xmath115 : @xmath116 @xmath117 where @xmath118 , @xmath119 @xmath120 satisfies nonlinear differential equation @xmath121 with boundary values @xmath122 applying operator @xmath123 to ( [ eq46 ] ) yields @xmath124 that coincides with equation ( [ eq3 ] ) from .    for the tests we employed the force - free model calculated in the rectangular box @xmath1 ( @xmath125 , @xmath126 ; @xmath127 , @xmath128 ) with the following parameters : @xmath129 ; @xmath130 $ ] are coordinates of the source ; the axis of dipole lies in the plane @xmath131 and has an angle @xmath132 to the @xmath133-axis .",
    "next , the notations in ( [ eq3])-([eq5 ] ) and ( [ eq11 ] ) for helicity invariants are used to denote their calculated values . to estimate the accuracy of the algorithm , we have also calculated helicity invariant",
    "( [ eq11 ] ) in terms of the known vector potential @xmath134 : @xmath135 relative helicity ( [ eq5 ] ) was calculated for two different sets @xmath136 ( [ eq44 ] ) and marked with indices @xmath137 . all helicity invariants were normalized to the true ( not invariant ! ) helicity @xmath138    table 1 lists the results .",
    "numbers in table 1 are helicities of the selected model characteristics . the relative errors indicating the level of completion of gauge invariance of finn & antonsen reference helicity ( 3 and 4 columns ) and the degree of accuracy of berger reference helicity ( 5 and 6 columns ) are @xmath139 and @xmath140 respectively .",
    "such sufficiently small errors justify the application of the algorithm presented here to calculate helicity invariants of real active regions ."
  ],
  "abstract_text": [
    "<S> an algorithm for calculating three gauge - invariant helicities ( self- , mutual- and berger relative helicity ) for a magnetic field specified in a rectangular box is described . </S>",
    "<S> the algorithm is tested on a well - known force - free model @xcite presented in vector - potential form . </S>"
  ]
}