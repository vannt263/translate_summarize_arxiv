{
  "article_text": [
    "any tree @xmath1 with positively weighted edges , induces a metric @xmath4 on the set of leaves by considering the weighted path distance in @xmath1 between each pair of leaves .",
    "moreover , provided @xmath1 has no vertices of degree 2 , and that we ignore the labeling of interior vertices , both @xmath1 and its edge weights are uniquely determined by the metric @xmath4 .",
    "this uniqueness result has been known since the @xmath5s and fast algorithms exist for reconstructing both the tree and its edge weights from @xmath4 ( for further background the interested reader may consult  @xcite and @xcite and the references therein ) .",
    "the uniqueness result and the algorithms are important in evolutionary biology for reconstructing an evolutionary tree of species from genetic data @xcite .",
    "however in this setting one frequently may not have @xmath4-values available for all pairs of species , due to the patchy nature of genomic coverage @xcite .",
    "this raises a fundamental mathematical question  for which subsets of pairs of leaves of a tree do we need to know the @xmath4-values in order to uniquely recover the tree and its edge weights ?",
    "in general this appears a difficult question ( indeed determining whether such a partial @xmath4-metric is realized by _ any _ tree is np - hard @xcite ) .",
    "however , some sufficient conditions ( as well as some necessary conditions ) for uniqueness to hold have been found , in @xcite , and more recently in @xcite , and @xcite . in this paper",
    "we consider the uniqueness question for trees that are ` fully - resolved ' ( i.e. all the interior vertices have degree 3 ) as these trees are of particular importance in evolutionary biology , and because the uniqueness question is easier to study for this class of trees .",
    "the structure of this paper is as follows .",
    "first we introduce some background terminology and concepts , and then we define the particular type of subsets of leaf pairs ( called ` stable triplet covers ' ) which we show suffice to uniquely determine a fully - resolved tree .",
    "moreover , we show how this comes about by establishing two combinatorial properties of stable triplet covers - a ` shellability ' property and a graph - theoretic property related to tree - width , which we show is quite different to shellability .",
    "we conclude by providing a proof that a polynomial - time algorithm will reconstruct a tree and its edge weights for any set of leaf pairs that contains a stable triplet cover ( or more generally a shellable subset ) .",
    "our result answers a special case of the question posed at the end of @xcite of whether every ` triplet cover ' of a fully - resolved tree determines the tree and its edge weights .",
    "we now introduce some precise definitions required to state and prove our main results .",
    "we mostly follow the notation and terminology of @xcite and @xcite .      for the rest of the paper , assume that @xmath7 .",
    "an @xmath6tree @xmath8 is a graph theoretical tree whose leaf set is @xmath9 and which does not have any vertices of degree 2 .",
    "we call an @xmath6tree _ fully - resolved _ if every _",
    "interior vertex _ of @xmath1 , that is , every non - leaf vertex of @xmath1 , has degree three .",
    "moreover , we call two distinct leaves @xmath10 and @xmath11 of @xmath1 a _ cherry _ of @xmath1 , denoted by @xmath12 , if the parent of @xmath10 is simultaneously the parent of @xmath11 . for any subset @xmath13 ,",
    "we denote by @xmath14 the @xmath15-tree obtained by restricting @xmath1 to @xmath15 ( suppressing resulting degree two vertices ) .",
    "an example of a fully - resolved @xmath6tree for @xmath16 , and having two cherries , is shown in fig . [ figure1](i ) .    in case @xmath17 ,",
    "say @xmath18 , and the path from @xmath19 to @xmath20 does not share a vertex with the path from @xmath21 to @xmath4 in @xmath14 , we refer to @xmath14 as a _ quartet tree _ and denote it by @xmath22 .",
    "note that by deleting any edge @xmath23 from @xmath1 the leaf sets @xmath24 and @xmath25 of the resulting two trees induce a bipartition of @xmath9 .",
    "we refer to such a bipartition as _",
    "@xmath6split _ and denote it by @xmath26 where @xmath27 and @xmath28 and @xmath24 and @xmath29 are as above .",
    "we say that two @xmath6trees @xmath8 and @xmath30 are _ equivalent _ if there exists a bijection @xmath31 that is the identity on @xmath9 and extends to a graph isomorphism from @xmath1 to @xmath32 .",
    "suppose for the following that @xmath8 is an @xmath6tree .",
    "then we call a map @xmath33 that assigns a _ weight _ , that is , a non - negative real number , to every edge of @xmath1 an _ edge - weighting _ for @xmath1 . note that this definition implies that some of the edges of @xmath1 might have weight zero .",
    "we denote an @xmath6tree @xmath1 together with an edge - weighting @xmath34 by the pair @xmath35 and call an edge - weighting that assign non - zero weight to every edge of @xmath1 that is not incident with a leaf of @xmath1 _ proper_. note that for any edge - weighting @xmath34 of @xmath1 , taking the sum of the weights of the edges on the shortest path from some @xmath36 to some @xmath37 induces a distance between @xmath10 and @xmath11 and thus a distance @xmath38 on @xmath9 .    for example , in the tree in fig .",
    "[ figure1](i ) , if each edge has weight 1 , then @xmath39 , and @xmath40 .",
    "we call a subset of @xmath9 of size two a _ cord _ of @xmath9 and , for @xmath41 distinct write @xmath42 rather than @xmath43 for the cord containing @xmath19 and @xmath20 . also ,",
    "for any non - empty set @xmath44 of cords of @xmath9 , we denote the edges of the graph @xmath45 whose vertex set is @xmath9 and whose edge set is the set @xmath46 by @xmath42 rather than @xmath43 , @xmath47 .",
    "suppose for the following that @xmath44 is a non - empty set of cords of @xmath9 .",
    "if @xmath30 is a further @xmath6tree and @xmath34 and @xmath48 are edge - weightings for @xmath1 and @xmath32 , respectively , such that @xmath49 holds for all @xmath50 then we say that @xmath35 and @xmath51 are _",
    "@xmath0-isometric_. moreover we say that @xmath0 is    1 .",
    "an _ edge - weight lasso _ for @xmath1 if for any two proper edge - weightings @xmath34 and @xmath48 for @xmath1 such that @xmath35 and @xmath52 are @xmath0-isometric we have that @xmath53 .",
    "a _ topological lasso _ for @xmath1 if for any other @xmath6tree @xmath32 and any two proper edge - weightings @xmath34 and @xmath48 for @xmath1 and @xmath32 , respectively , such that @xmath35 and @xmath51 are @xmath0-isometric we have that @xmath1 and @xmath32 are equivalent .",
    "a _ strong lasso _ for @xmath1 if @xmath0 is simultaneously an edge - weight and a topological lasso for @xmath1 .",
    "if @xmath0 is a strong lasso for an @xmath6tree then the graph @xmath54 must be connected , and each component of this graph must be non - bipartite @xcite .",
    "an example of a strong lasso @xmath0 of the tree in fig .",
    "[ figure1](i ) is the set of cords corresponding to the edges of the graph in fig .",
    "[ figure1](ii ) .      given a subset @xmath0 of @xmath55 with @xmath56 , and an @xmath6tree @xmath1 , we say that @xmath57 is _",
    "@xmath1shellable _ if there exists an ordering of the cords in @xmath57 as , say , @xmath58 such that , for every @xmath59 , there exists a pair @xmath60 of ` pivots ' for @xmath61 , i.e. , two distinct elements @xmath62 , for which the tree @xmath63 obtained from @xmath1 by restriction to @xmath64 , is the quartet tree @xmath65 , and all cords in @xmath66 except @xmath61 are contained in @xmath67 . any such ordering of @xmath57 will also be called a _ shellable ordering _ of @xmath57 , and any subset @xmath0 of @xmath55 for which a shellable ordering of @xmath57 exists will also be called an _ shellable lasso for @xmath1_. in ( * ? ? ?",
    "* theorem 6 ) , it was established that every shellable lasso for an @xmath6tree is in particular a strong lasso for that tree .      consider the seven - taxon tree , shown in fig .",
    "[ figure1](i ) , and the lasso @xmath68 ( the edges of the graph in fig .",
    "[ figure1](ii ) ) .",
    "the remaining ten chords in @xmath69 have a shellable ordering , described as follows : @xmath70 where the corresponding cord pivots are : @xmath71 and so @xmath0 is a shellable ( and hence strong ) lasso for @xmath1 .",
    "@xmath72      a necessary condition for @xmath73 to be a edge - weight lasso or a topological lasso for a fully - resolved @xmath6tree is that @xmath0 forms a _",
    "cover _ for @xmath1  that is , for each interior vertex @xmath2 of @xmath1 , @xmath0 contains a pair of leaves from each pair of the three components of @xmath3 .",
    "however this condition is not sufficient for @xmath0 to be either an edge - weight lasso or a topological lasso ( examples are given in @xcite ) .",
    "a particular type of cover for a fully - resolved @xmath6tree is a _ triplet cover _ which is defined as any subset @xmath0 of @xmath74 with the property that for each interior vertex @xmath2 of @xmath1 we can select leaves @xmath75 from each of the three components of @xmath3 so that @xmath76 .",
    "it can be shown that if @xmath0 is a triplet cover for a fully - resolved @xmath6tree @xmath1 then @xmath0 is an edge - weight lasso",
    ". however it is not known whether or not every triplet cover of every such @xmath1 is also a topological ( and thereby a strong ) lasso for @xmath1 .",
    "suppose that @xmath8 is a fully - resolved @xmath6tree , and let @xmath77 where @xmath78 denotes the @xmath6split associated with edge @xmath23 .",
    "we call the elements in @xmath79 ` clusters ' ( in biology , they are also sometimes referred to as ` clans ' @xcite ) . thus a cluster is a subset of @xmath9 that corresponds to the leaf labels on one side of some edge of @xmath1 .    given a collection @xmath80 of non - empty subsets of @xmath9 we say that any function @xmath81 is a _ stable transversal _ for @xmath80 if it satisfies the two properties :    * ( transversality ) @xmath82 , for all @xmath83 ; * ( stability ) @xmath84 for all @xmath85 .",
    "mostly we will be concerned with stable transversals for @xmath79 , which were introduced in @xcite , though for a different purpose .",
    "an example of a stable transversals for @xmath79 is as follows : consider _ any _ stable transversal @xmath86 for @xmath87 ( equivalently , the function @xmath88 under some total ordering of @xmath9 ) , and consider _ any _ proper edge weighting @xmath34 of @xmath1 . for a cluster @xmath89 , consider the subset @xmath90 of leaves of @xmath1 in @xmath91 that are a closest to the edge @xmath92 whose deletion induces the split @xmath93 . here",
    "` closest ' refers to the path distance in @xmath1 from each leaf in @xmath91 to @xmath92 under the edge weighting @xmath34 .",
    "if we let @xmath94 , for each @xmath89 then @xmath95 is a stable transversal for @xmath79 .",
    "notice that this holds also for the corresponding function in which ` closest ' is replaced by ` furthest ' throughout .",
    "@xmath72      consider the fully - resolved @xmath6tree shown in fig .",
    "[ figure2](i ) , and the function @xmath95 defined as follows : @xmath96 for all @xmath10 in @xmath9 , and @xmath97 and @xmath98 then @xmath95 is a stable transversal for @xmath1 .",
    "note that the choices of @xmath99 in the last line could be replaced by , for example , @xmath100 or @xmath101 and we would still have a stable transveral . @xmath72",
    "given a fully - resolved @xmath6tree @xmath1 , a stable transversal @xmath95 of @xmath79 defines a triplet cover for @xmath1 as follows : for each interior vertex @xmath2 of @xmath1 , consider the three components of the graph @xmath3 , and let @xmath102 denote their leaf sets .",
    "then let @xmath103 where @xmath104 denotes the set of interior vertices of @xmath1 .",
    "we say that @xmath0 is a _",
    "stable triplet cover _",
    "( generated by @xmath95 ) if @xmath105 for some stable transversal @xmath95 of @xmath79 .",
    "for example , for the pair @xmath106 described in example 3 , we have : @xmath107 and the graph @xmath54 for @xmath108 is shown in fig . [ figure2](ii ) .",
    "notice that not all triplet covers are stable ; indeed the set of triplet covers of a fully - resolved @xmath6tree @xmath1 is precisely the set of subsets of @xmath74 of the form @xmath109 where @xmath95 is required to satisfy only the transversality property above for some @xmath110 .",
    "interestingly , fig .",
    "[ figure2](ii ) shows that for the set @xmath108 with @xmath1 and @xmath95 from example 3 , the graph @xmath45 is a @xmath111-tree , where a graph @xmath112 is called a _",
    "@xmath111-tree _ if there exists an ordering @xmath113 of @xmath114 such that @xmath115 and , for @xmath116 the vertex @xmath117 has degree 2 in the subgraph of @xmath118 induced by @xmath119 .",
    "@xmath111-trees are examples of @xmath120-trees which were characterized in @xcite and also studied in e.g.@xcite . in fig .",
    "[ figure2](ii ) an acceptable vertex ordering is @xmath121 .",
    "the graph in fig .",
    "[ figure1](ii ) is also a 2d - tree , as can be seen by considering the vertex ordering @xmath122 .",
    "we can now state our first main result which relates stable triplet covers with 2d - trees and shellable lassos .",
    "[ maintheorem ] if @xmath0 is a stable triplet cover of a fully - resolved @xmath6tree @xmath1 with @xmath123 , then    * @xmath45 is a 2d - tree .",
    "* @xmath0 is an shellable lasso for @xmath1 , and so @xmath0 is a strong lasso for @xmath1 .",
    "* @xmath124 , and so @xmath0 is also a minimal strong lasso for @xmath1 .",
    "we prove parts ( i)(iii ) simultaneously by induction on @xmath125 .",
    "shellability holds trivially for @xmath126 ( since then @xmath127 ) , so suppose that it holds when @xmath128 , and that @xmath1 is a fully - resolved tree with @xmath129 leaves , and that @xmath0 is a triplet cover for @xmath1 generated by a stable transversal @xmath95 of @xmath79 .",
    "select any cherry @xmath12 of @xmath1 . without loss of generality",
    ", we may suppose that @xmath130 .",
    "let @xmath131 and define @xmath132 by setting @xmath133 note that , since @xmath95 is a stable transversal for @xmath79 , it follows that @xmath11 is not an element of any cord of @xmath134 , and so @xmath135 .",
    "moreover , @xmath136 for any @xmath137 , and so @xmath138 . it can now be checked that @xmath139 is a stable transversal for @xmath140 and so @xmath134 is a stable triplet cover of @xmath32 , generated by @xmath139 . by the inductive hypothesis ( applied to @xmath32 and @xmath141 )",
    "it follows with regards to ( i ) that @xmath142 is a 2d - tree . clearly adding @xmath11 to the vertex set of that graph and @xmath143 and @xmath144 to its edge set",
    "preserves the 2d - tree property . by the definition of @xmath134",
    "it is easy to see that the resulting graph is @xmath45 .",
    "note that regarding ( ii ) and ( iii ) the induction hypothesis implies that @xmath145 , and so @xmath146 and that @xmath147 is shellable .",
    "so let us fix an ordering of @xmath147 that provides such a shelling .",
    "this will form the initial segment of a shellable ordering of @xmath69 .    to describe this extended ordering ,",
    "let @xmath2 be the interior vertex of @xmath1 adjacent to leaves @xmath10 and @xmath11 , and let @xmath148 be the interior vertex of @xmath1 adjacent to @xmath2 .",
    "consider the three components of the graph @xmath149 .",
    "one component contains @xmath12 , and we will denote the leaf sets of the other two components by @xmath150 and @xmath151 , where , without loss of generality , @xmath152 . notice that @xmath69 is the disjoint union of the three sets : @xmath153 we order @xmath69 as follows : the elements of @xmath154 come first , ordered by their shellable ordering , followed by the elements @xmath155 with @xmath156 ( in any order ) , followed by the elements @xmath155 with @xmath157 ( in any order ) .",
    "we claim that any such ordering provides a shellable ordering of @xmath69 . to see this , observe first that , for any leaf @xmath156 , the elements @xmath158 provide ` pivots ' for the pair @xmath159 , since @xmath160 and all cords in @xmath161 except @xmath155 are contained in @xmath162 .",
    "also , for any leaf @xmath163 , if we select any leaf @xmath164 then the pair @xmath165 provides a ` pivot ' for @xmath159 , since @xmath166 , and all cords in @xmath167 except @xmath155 are contained in @xmath168 . in all cases , the cords required for pivoting come earlier in the ordering .",
    "thus , we have established that @xmath134 is an shellable lasso for @xmath1 , and so , by theorem 6 of @xcite , @xmath0 is also a strong lasso for @xmath1 .",
    "moreover , we showed that @xmath169 , and since this equals the number of edges in any fully - resolved @xmath9tree , linear algebra ensures that no strict subset of @xmath134 could be an edge weight - lasso for @xmath1 .",
    "hence , @xmath0 is a minimal strong lasso for @xmath1 , which completes the proof of the induction step , and thereby of the theorem .      *",
    "just because a graph @xmath54 is a 2d - tree , it does not follow that @xmath0 forms a strong ( let alone a shellable ) lasso for every given fully - resolved @xmath6tree @xmath1 .",
    "a simple example is furnished by @xmath170 and @xmath171 , for which @xmath54 is a 2d - tree , and yet @xmath0 fails to be a strong lasso for @xmath172 .",
    "+ however , if @xmath54 forms a 2d - tree , or more generally if @xmath0 contains a subset @xmath134 such that @xmath173 is a 2d - tree , then @xmath0 is a strong lasso for at least one fully - resolved @xmath6tree .",
    "the proof is constructive based on the ordering @xmath174 in the definition of a 2d - tree : start with the tree consisting of leaves @xmath175 and @xmath176 , and construct a fully - resolved tree as follows : for each @xmath177 , if @xmath117 is adjacent to @xmath178 and @xmath179 in @xmath180 ( where @xmath181 ) then let @xmath117 be the leaf that is attached by a new edge to a _ new _ subdivision vertex on the path connecting @xmath178 and @xmath179 in the tree so - far constructed .",
    "+ it may be of interest to explore further the connection between shellability and 2d - trees , and in particular , the question of when the former property for some set @xmath73 entails the latter property for @xmath0 , or for some subset of @xmath0 . *",
    "suppose that @xmath1 is a fully - resolved @xmath6tree , and @xmath73 contains a stable triplet cover .",
    "a natural setting in which this situation arises is the following .",
    "suppose @xmath35 is a properly edge - weighted fully - resolved @xmath6tree , and @xmath73 has the property that , for any interior vertex , @xmath2 , @xmath0 contains every chord @xmath143 for which @xmath10 is a closest leaf to @xmath2 in one subtree of @xmath3 and @xmath11 is a closest leaf to @xmath2 in another subtree of @xmath3 .",
    "then , as noted in example 2 above , @xmath0 contains a stable triplet cover .",
    "+ now , when @xmath0 contains a stable triplet cover for @xmath1 , it follows by theorem  [ maintheorem ] that @xmath0 is a shellable , and thereby also a strong lasso for @xmath1 ( since any superset of a strong lasso for a tree is also a strong lasso for that tree ) .",
    "however , it is perhaps not clear how one might efficiently construct @xmath35 from the distances induced by @xmath0 , particularly when the subset of @xmath0 corresponding to the stable triplet cover is not also given explicitly .",
    "thus , in the next section we describe a polynomial - time algorithm for reconstructing @xmath182 whenever @xmath0 contains some ( unknown ) shellable lasso for @xmath1 .",
    "suppose that @xmath44 and that @xmath1 is a fully - resolved @xmath6tree , @xmath34 is a proper edge - weighting of @xmath1 and @xmath38 .",
    "starting with @xmath184 add cords to @xmath185 and extend the domain of @xmath4 to those cords , by repeated application of the following extension rule ( @xmath186 ) , described in @xcite ( section 6.2 , page 246 ) :    * whenever @xmath187 and @xmath188 @xmath189 add @xmath190 to @xmath185 , and let @xmath191    let @xmath192 be the set of resulting set of cords obtained from the initial set @xmath0 when this extension rule no longer yields any new cords .",
    "note that @xmath192 can be computed in polynomial time , and that @xmath193values are assigned for all cords in @xmath192 .",
    "moreover , if @xmath194 , then @xmath192 is a strong lasso for @xmath1 , however the converse does not hold ( example 6.2 of @xcite provides a counterexample ) .    if @xmath44 contains an shellable lasso for a fully - resolved @xmath6tree @xmath1 , and @xmath195 , for some proper edge weighting @xmath34 , then @xmath194 .",
    "consequently , @xmath1 and @xmath34 can be reconstructed in polynomial time from the restriction of @xmath4 to @xmath0 .",
    "suppose that @xmath196 is a shellable lasso for @xmath1 ; we will show that @xmath197 and so @xmath194 .",
    "suppose to the contrary that @xmath198 is a strict subset of @xmath74 , and consider any shelling @xmath199 of the cords in @xmath200 ( such a shelling exists by the assumption that @xmath134 is an shellable lasso for @xmath1 ) .",
    "let @xmath201 be the smallest index for which @xmath202 .",
    "then the condition on the shelling ensures that there exists pivots @xmath203 so that for @xmath204 we have @xmath14 is the quartet tree @xmath205 and that each cord in @xmath206 either is an element of @xmath134 or it occurs earlier in the ordering for the shelling than @xmath207 , and so , by the minimality assumption concerning @xmath208 , all these cords lie in @xmath198 .",
    "consequently , @xmath209 , a contradiction .",
    "thus , our assumption that @xmath198 is a strict subset of @xmath74 is not possible , as required .",
    "finally , to efficiently recover @xmath182 , once @xmath4 has been defined on all of @xmath74 , one can apply standard distance - based reconstruction methods for fully - resolved trees , such as the neighbor - joining method @xcite .",
    "_ m.s . thanks the royal society of nz under its james cook fellowship scheme . both authors thank the organizers of the `` structure discovery in biology : motifs , networks @xmath210 phylogenies '' , schloss dagstuhl , germany , meeting where this paper was conceived . _"
  ],
  "abstract_text": [
    "<S> it is a classical result that any finite tree with positively weighted edges , and without vertices of degree 2 , is uniquely determined by the weighted path distance between each pair of leaves . </S>",
    "<S> moreover , it is possible for a ( small ) strict subset @xmath0 of leaf pairs to suffice for reconstructing the tree and its edge weights , given just the distances between the leaf pairs in @xmath0 . </S>",
    "<S> it is known that any set @xmath0 with this property for a tree in which all interior vertices have degree 3 must form a _ cover _ for @xmath1  that is , for each interior vertex @xmath2 of @xmath1 , @xmath0 must contain a pair of leaves from each pair of the three components of @xmath3 . here </S>",
    "<S> we provide a partial converse of this result by showing that if a set @xmath0 of leaf pairs forms a cover of a certain type for such a tree @xmath1 then @xmath1 and its edge weights can be uniquely determined from the distances between the pairs of leaves in @xmath0 . </S>",
    "<S> moreover , there is a polynomial - time algorithm for achieving this reconstruction . </S>",
    "<S> the result establishes a special case of a recent question concerning ` triplet covers ' , and is relevant to a problem arising in evolutionary genomics .    </S>",
    "<S> * keywords : * phylogenetic tree , tree metric , tree reconstruction , triplet cover .    * email : * katharina.huber@cmp.uea.ac.uk ( corresponding author ) </S>"
  ]
}