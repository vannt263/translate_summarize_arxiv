{
  "article_text": [
    "technological advances are pushing the size of device components and the demands on their performance to ever smaller sizes and higher standards . these trends , which are only expected to accelerate in the future ,",
    "make it imperative that the structure and behavior of systems at the atomistic level are thoroughly understood from a fundamental perspective .",
    "while experimental methods are steadily improving in their ability to probe atomistic processes of materials , computational approaches provide a complementary technique for systematic and well - controlled studies .",
    "tuning and optimization of the properties of materials , taking into account their chemical composition , require computational methods that are of general applicability , unbiased and accurate .",
    "first - principles methods based on density functional theory ( dft ) @xcite have proven to be an accurate and reliable tool in understanding and predicting a wide range of physical properties of finite ( such as molecules and clusters ) and extended structures ( such as bulk crystalline solids , their defects and surfaces ) .",
    "such methods must obtain the quantum mechanical ground state of the interacting electrons and ions , which makes them computationally very intensive .",
    "the computational cost scales as a rather high power ( typically 3 ) of the number of atoms or electrons in the system , which limits the sizes that can be investigated in a reasonable time .",
    "improvement of the efficiency of first - principles calculations is therefore an important goal .",
    "this goal can be reached either by improving the algorithms to obtain better scaling with system size , or by exploiting modern computational resources and in particular parallel architectures .",
    "the scaling of the calculation of the quantum mechanical ground state of interacting electrons and ions can be improved by exploiting what w. kohn has called `` the short - sightedness '' of quantum mechanics : due to screening , interactions are essentially _ short _ ranged . a natural way to express this property is through the density matrix of the system .",
    "thus , implementations of linear scaling ( referred to as @xmath0 methods , with @xmath1 a number representing the system size , like the number of electrons ) typically involve density - matrix expressions with localized orbitals  @xcite . in terms of the computational time ,",
    "@xmath0 methods prove advantageous for insulating systems with @xmath2 or metallic systems with @xmath3 electrons ( the number of atoms in the system is typically an order of magnitude smaller than the number of electrons ) .",
    "this difference in efficiency of the @xmath0 methods between insulators and metals is related to the long - range behavior of the density matrix which has a different fall off , i.e. exponential in the former vs. power law in the latter .",
    "these methods are well suited for the calculation of the total energy of the system , which provides useful information about its optimal structure , dynamics , and response to mechanical loading . in addition to the total energy",
    ", it is often important to study the electronic structure of the system .",
    "this is necessary for understanding electronic , optical and magnetic properties , and is relevant for the study of both insulators ( semiconductors ) and metals .",
    "a dft electronic structure calculation requires the calculation of the eigenvalue spectrum of the single - particle hamiltonian , a problem which is not easily amenable to improvements in scaling since diagonalization of the hamiltonian typically scales as @xmath4 .",
    "localization of the electronic orbitals can be detrimental to the accuracy of electronic properties though it helps improve the efficiency of @xmath0 methods .    in dft calculations ,",
    "the single - particle hamiltonian matrix itself depends on the eigenfunctions , so the complete solution must be obtained by iterating the solution to self - consistency .",
    "the size of the hamiltonian matrix depends on the basis set used to represent the electronic wavefunctions and the electronic charge density .",
    "ideally , one would like to work with a sparse hamiltonian , which can be solved efficiently using iterative algorithms ; the use such algorithms reduces both computer memory and time requirements .",
    "a natural way to generate a sparse hamiltonian is to use a real space grid for the representation of the electronic eigenfunctions and charge density : each term in the hamiltonian , evaluated at some point in space , acts only on the wavefunctions at the same point in space , except for the laplacian in the kinetic energy operator which involves several points simultaneously .",
    "the number of points included in the evaluation of the laplacian determines the few off - diagonal non - zero matrix elements in each row ( or column ) of the hamiltonian matrix .",
    "the calculation can be made even more efficient by using an adaptive grid in real space for representation of the eigenfunctions , with points distributed according to the electronegativity of ions .",
    "the adaptive grid can be mapped onto a regular grid in curvilinear space through the proper definition of a metric .",
    "the regular grid in curvilinear space makes it possible to exploit fully the capabilities of modern computational platforms based on parallel processing .",
    "thus , this formulation of the problem satisfies all requirements for very efficient electronic structure calculations : ( a ) _ sparsity _ for fast iterative diagonalization of the hamiltonian ; ( b ) _ adaptability _ for efficient distribution of grid points as demanded by the physical system ; and ( c ) _ efficient parallelization _ of the computation due to the natural distribution of the regular curvilinear space grid onto the processor grid .",
    "our original implementation of such a method  @xcite demonstrated the feasibility of performing calculations within this framework .",
    "the data structures and operations involved in this method make it easily parallelizable , particularly using high performance fortran ( hpf ) . in the present paper",
    "we discuss several algorithmic issues that enhance the performance of the method and their implementation using hpf ; we refer to the new implementation as hares for hpf - adaptive - grid real - space electronic structure .",
    "the paper is organized as follows : in section  [ sec : theory_frame ] we briefly review the theory underlying the hares method and present an analysis of the computational effort involved in the various parts of the calculation . in section  [ sec : alg_enhance ]",
    "we discuss the recent algorithmic enhancements and their implementation . in section  [ sec : applications ] we illustrate the efficacy of these algorithmic enhancements through several applications of hares to interesting systems .",
    "these include : ( a ) a few simple elemental crystals and a few molecules composed of atoms in the first row of the periodic table which typically present a computational challenge to plane - wave ( pw ) methods ; ( b ) blue bronze , a quasi one - dimensional conductor ; and ( c ) a zeolite , that is , a complex structure composed of si - o tetrahedra and large pores , which represents a molecular sieve .",
    "section  [ sec : summary ] contains our conclusions .",
    "the problem of finding the quantum mechanical ground state of electrons in solids is a many body problem which , at present , can be solved only approximately . the computational framework of choice for a wide range of problems involving a system of ions and interacting electrons is dft @xcite .",
    "the central theorem of dft , proven by hohenberg and kohn , states that the ground state energy of an electronic system is a unique functional of its charge density @xmath5 and is an extremum ( a minimum ) with respect to variations in the charge density .",
    "kohn and sham @xcite expressed the charge density in terms of single particle wavefunctions @xmath6 ( referred to as kohn - sham orbitals ) and occupation numbers @xmath7 @xmath8 the ground state energy functional is then given by @xmath9   \\psi_{\\alpha } ( { { \\bf r } } ) d{{\\bf r}}+ \\\\",
    "e_{\\rm\\scriptscriptstyle h } [ \\rho({{\\bf r } } ) ] + e_{\\rm\\scriptscriptstyle xc } [ \\rho({{\\bf r } } ) ] , \\label{dft_func } \\end{split}\\ ] ] where @xmath10 is the external potential experienced by the electrons due to the presence of the ions , @xmath11 is the electrostatic ( also known as hartree ) energy due to coulomb repulsion of electrons and @xmath12 is the exchange - correlation ( xc ) contribution , which embodies the many - body properties of the interacting electron system .",
    "a variational argument in terms of the single - particle states @xmath6 leads to a set of single - particle equations for fictitious non - interacting particles that produce the same density as the real electrons : @xmath13 \\psi_{\\alpha}({{\\bf r } } ) =   \\epsilon_{\\alpha}\\psi_{\\alpha}({{\\bf r } } ) .",
    "\\label{dft_eqns}\\ ] ] the effective potential @xmath14 in these single - particle equations is : @xmath15 + v_{\\rm xc}[\\rho({{\\bf r } } ) ] \\ ] ] where @xmath16 is the electrostatic potential due to coulomb repulsion between electrons ( known as the hartree potential ) and @xmath17 is the exchange correlation potential . the system of eqs .",
    "( [ dft_eqns ] ) , referred to as kohn - sham equations , represents a set of nonlinear coupled equations due to the dependence of @xmath16 and @xmath18 on the density ( and hence the wave functions @xmath19 ) ; these equations are solved iteratively , beginning with a guess for the @xmath19 s , until self - consistency is achieved .    the only significant approximation in this set of equations is the form of @xmath20 $ ] , which is not analytically known .",
    "the standard choices involve expressions that depend locally on @xmath5 ( known as the local density approximation  lda ) , or involve both @xmath5 and its gradients ( known as the generalized gradient approximation  gga ) .",
    "such expressions have been derived from analyzing the behavior of the uniform or non - uniform electron gas in certain limits , or by fitting the results of accurate calculations based on quantum monte carlo techniques for sampling the many - body wavefunction ; they work well in reproducing the energetics of a wide variety of ground state structures of extended ( crystalline ) or finite ( cluster or molecular ) systems .",
    "we discuss next the basic features of the lda and gga approaches and their limitations and capabilities .    in the lda , the exchange - correlation functional",
    "is expressed as : @xmath21 = \\int \\rho({{{\\bf r } } } )   \\epsilon_{\\rm\\scriptscriptstyle xc}^{\\rm 0}(\\rho({{{\\bf r } } } ) )   { \\mathrm d}^3{{\\bf r}}. \\label{eq : xc - lda}\\ ] ] when the number of spin - up and spin - down states in the system are equal ( we refer to this as the `` spin compensated '' case ) . in this expression @xmath22",
    "is the exchange correlation energy of the _ uniform _ electron gas of density @xmath23 , which can be obtained by more elaborate computational methods like quantum monte carlo , or even analytically in certain limits",
    ". the ground state of a number of physical systems , such as atoms , molecules , and magnetic crystals can exhibit nonzero spin - polarization . in the above description of dft , the single particle states label @xmath24",
    "can be extended to include the spin ( up or down ) quantum number , and the energy functional can be readily generalized to take into account the spin - polarized electrons . the spin - polarized version of the exchange - correlation energy functional in the so called local spin density approximation ( lsda ) is written as @xmath25 =   \\int \\rho({{{\\bf r } } } ) \\epsilon_{\\rm\\scriptscriptstyle xc}^{\\rm 0 } ( \\rho_\\uparrow({{{\\bf r}}}),\\rho_\\downarrow({{{\\bf r } } } ) )",
    "{ \\mathrm d}^3{{\\bf r } } , \\label{eq : eks - spp}\\ ] ] where @xmath26 and @xmath27 are the electronic densities of spin - up and spin - down electrons , in terms of which the total electronic density @xmath5 is : @xmath28    among the various proposed xc functionals @xmath29 , in our approach to the dft method we have implemented two different parametrizations of the ceperley - alder ( ca ) functional @xcite for both spin - polarized and spin - compensated systems : the first is the perdew - zunger @xcite parametrization ( pz - ca ) and the second is the perdew - wang @xcite parametrization ( pw - ca ) .",
    "the pw - ca functional uses a more accurate spin interpolation formula for the correlation , proposed by vosko , wilk , and nusair @xcite , which is based on the random - phase approximation ; the pz - ca functional uses the von barth - hedin @xcite spin - dependence for the correlation which is correct for the exchange part of the functional .",
    "although the l(s)da has proved successful in a variety of chemical and physical applications , it suffers certain well known deficiencies . among those ,",
    "the most serious are :    1 .   the tendency to produce more bonding in solids than is observed experimentally ; manifestations of this tendency include the underestimate of the lattice constant or bond length and the overestimate of the cohesive energy and the bulk modulus .",
    "poor representation of activation energies which are related to chemical reactions or transitions between structures .",
    "incorrect relative stability of different magnetic phases for some magnetic materials .    in order to correct these deficiencies ,",
    "expressions for the xc functional which go beyond the density and include gradients of the density have been devised . in the so - called generalized gradient approximation ( gga ) ,",
    "the xc energy functional is expressed as follows : @xmath30 = \\\\",
    "\\int \\rho({{{\\bf r } } } )   \\epsilon_{\\rm\\scriptscriptstyle xc}^{\\rm\\scriptscriptstyle gga } ( \\rho_\\uparrow({{{\\bf r}}}),\\rho_\\downarrow({{{\\bf r } } } ) , \\nabla\\rho_\\uparrow({{{\\bf r}}}),\\nabla\\rho_\\downarrow({{{\\bf r } } } ) ) { \\mathrm d}^3{{\\bf r}}. \\label{eq : eks - gga } \\end{split}\\ ] ] applications of gga to real materials show a tendency to over - correct the deficiencies of l(s)da .",
    "for instance , the lattice constants of common crystalline solids tend to be overestimated within gga calculations , while bulk moduli are underestimated  @xcite .",
    "we have implemented in hares the recently developed parameter - free gga functionals ( pw91 @xcite and pbe96 @xcite ) .",
    "present capabilities include the use of the gga functional in two different modes : ( a ) fully self - consistent gga calculations and ( b ) _ a posteriori _ correction of the total energy with the perturbative gga xc correction applied at the end of a self - consistent lda calculation as : @xmath31   - e_{\\rm\\scriptscriptstyle xc}^{\\rm\\scriptscriptstyle lda } [ \\rho^{\\rm\\scriptscriptstyle lda } ] .",
    "\\label{eq : post - lda}\\ ] ] it is important to point out that the core  valence xc interaction is significantly different between lda and gga as was noted by fuchs _",
    "et al_. @xcite therefore , in order to ensure the reliability of the gga results , it is necessary to perform either the fully self - consistent gga calculation using gga - constructed pseudopotentials ( referred to as mode ( a ) above ) or the _ a posteriori _ gga correction after the self - consistent lda calculation using the lda - constructed pseudopotentials with the partial - core electron density ( referred to as mode ( b ) above ) .    for the spin - polarized systems ,",
    "we consider two different modes of the computation : ( 1 ) the conventional unconstrained calculation , where the total electron density and the magnetic moment are determined simultaneously and self - consistently ; and ( 2 ) the fixed spin moment ( fsm ) method @xcite , which constrains the magnetic moment to be constant , but allows the possibility of different fermi energies for the spin - up and the spin - down electron densities .",
    "the latter method has certain advantages : a series of fsm calculations with different magnetic moments provide the total energy as a function of the magnetic moment , yielding detailed information about the magnetic phase .",
    "in addition , the fsm calculations rapidly achieve self - consistency and are numerically more stable compared with the unconstrained calculations .",
    "there exist a variety of methods for solving the set of single - particle equations derived from dft , eqs .",
    "( [ dft_eqns ] ) . in the broadest classification ,",
    "these methods fall into two categories , depending on how they describe the single - particle wavefunctions and charge density : methods in the first category use explicit basis sets to represent the wavefunctions and charge density , while those in the second category use finite , discrete grids ( or meshes ) of points on which these functions are represented.@xcite a standard approach of the first type employs a pw basis , which is a natural basis for periodic systems.@xcite the plane waves needed in the expansion are determined by the reciprocal lattice of the crystal while the number of plane waves included in the basis is determined by the highest kinetic energy , a parameter referred to as the `` energy cutoff '' .",
    "hares falls in the second category of methods , as it employs a discrete mesh for the calculation .",
    "an important difference in the two types of methods is that in the former all operators have a unique representation once the basis set is chosen , whereas in the latter operators involving differentials have many possible representations with different order of approximation . in this sense ,",
    "the latter type of methods involve an additional degree of approximation . both types of methods map the kohn - sham problem onto a matrix eigenvalue problem , denoted by @xmath32 .",
    "one of the desirable features of grid - based methods is to produce a sparse matrix @xmath32 ; this makes it possible to employ iterative algorithms for its solution .",
    "hares uses a uniform grid in curvilinear space which is analytically mapped onto a grid in real space with resolution ( grid - spacing ) adapted to natural inhomogeneities in the problem . with the use of the adaptive grid",
    ", one can use hares for both all - electron and pseudopotential calculations .",
    "however , use of pseudopotentials proves effective in most practical calculations . in the kohn - sham problem ,",
    "inhomogeneities arise fundamentally from @xmath10 , which is the potential that each electron experiences due to the presence of the nuclei .",
    "the cartesian coordinates @xmath33 depend on the curvilinear coordinates @xmath34 and a set of parameters @xmath35 that allows tuning of the coordinate representation to a particular physical problem .",
    "the jacobian of the transformation is @xmath36 and describes how derivatives transform between the coordinate systems ; its determinant @xmath37 is a measure of how the volume element is changed by the coordinate transformation .",
    "the metric giving the elemental length associated with infinitesimal displacement is given by @xmath38 details of the coordinate transformation can be found in ref .  .",
    "the gist of the transformation is to enhance spatial resolution in the region where it is desirable to increase the accuracy of the finite - difference derivatives and the representation of charge density inhomogeneities .",
    "the equivalent enhancement of resolution in the pw approach is the increase of the energy cutoff .",
    "the connection between the effective energy cutoff and the local resolution of the hares grid is given by the factor @xmath39 .",
    "the differential equation of the kohn - sham problem in the adaptive grid representation becomes a finite matrix eigenvalue problem , with only the kinetic energy term ( the laplacian in the single - particle equations ) having off - diagonal elements .",
    "the uniform mesh in @xmath40coordinates is subsequently broken into blocks that are distributed over a number of processors on a parallel computer architecture .",
    "the wavefunctions , potentials , and charge density are represented on this mesh allowing for balanced distribution on processors . in the iterative solution of the eigenvalue problem ,",
    "an operation that is performed frequently during the calculation is the product of the hamiltonian matrix with a vector representing a single - particle wavefunction . in parallel execution of this operation , it is the kinetic energy term ( the laplacian ) with off - diagonal elements that requires most of the communication and makes the solution of the eigenvalue problem nontrivial .      in dft calculations based on a real - space grid ,",
    "boundary conditions enter in the way the laplacian is applied to a function .",
    "there are only two aspects of a calculation where this is relevant : ( i ) the kinetic energy operator , that is , the laplacian acting on wavefunctions and ( ii ) the calculation of the electrostatic potential , obtained by solving the poisson equation , that is , the laplacian acting on the potential . since the calculation of the laplacian ( represented as a finite difference ) of a function at a given grid point uses values of the function at adjacent grid points , imposition of the boundary conditions requires knowledge of the function at a few grid points outside the boundary . for calculations on infinite crystalline solids ,",
    "we use periodic boundary conditions ( pbc ) demanding that the function is periodic in space with the period of a unit cell that models a physical system .",
    "application of the laplacian at any point in the unit cell involves values of the function inside the unit cell making implementation of boundary conditions for this case straight - forward . for calculations on finite systems ( atoms , molecules or clusters )",
    ", we use open boundary conditions ( obc ) . in this case",
    ", the treatment of boundary conditions is more intricate since the grid points adjacent to the ones on the boundary fall both inside and outside the region containing the system . in fig .",
    "[ fig : obc ] , we show how this is treated in hares . we choose a rectangular box with a spherical region inside , the interior of which is large enough to contain the physical system .",
    "the thickness of the buffer region surrounding this sphere depends on the order of the finite - difference laplacian , and is equal to this order times the grid - spacing .",
    "thus , the distance between the sphere and the box vanishes in the continuum limit and the ratio of the volumes of the sphere to the box becomes @xmath41 .",
    "the wavefunctions and charge density vanish outside the spherical region ; this takes care of the boundary conditions in the kinetic energy part .",
    "there is one more term that deserves special attention in handling obc : it is the electrostatic potential which has long range , and therefore can not be assumed to be zero in the buffer region outside the spherical region .",
    "we obtain values for the electrostatic potential in the buffer region through a multipole expansion up to order 4 , using the density inside the spherical region ; we use the values at those points as the boundary conditions for @xmath16 in the solution of the poisson equation .",
    "= 1.0      it is useful at this point to analyze the computational effort involved in various aspects of a dft calculation using hares and compare it to that performed using the pw method .    in the pw method ,",
    "there is one grid in real ( direct ) space and another in reciprocal space .",
    "the wavefunctions are stored in reciprocal space on part of the grid inside a spherical region with diameter equal to half of the side of the full grid .",
    "these are transformed into real space using the fast fourier transform ( fft ) whenever necessary .",
    "the calculations of the charge density , the local ionic potential , and the exchange correlation energy are carried out in real space , whereas the calculation of the kinetic energy and the hartree energy are carried out in reciprocal space .",
    "the calculation of the energy related to the nonlocal pseudopotential can be done on either grid . for small system sizes ,",
    "the most time - consuming part is often that of performing the ffts , which scales as @xmath42 .",
    "the number of ffts scales linearly with system size giving an overall @xmath43 scaling for the entire calculation . for large system sizes ,",
    "the orthonormalization of wavefunctions , or equivalent constraints imposed during minimization of the energy functional , dominate the computational time .",
    "these operations scale as @xmath44 .",
    "calculation of the contribution from the nonlocal pseudopotentials normally scales as @xmath44 , but can in principle be improved to @xmath45 scaling by exploiting the short - range character of the potentials in real space",
    ".    @l|c|c calculation of & hares & plane wave method + charge density & @xmath45 & @xmath46 + kinetic energy & @xmath45 & @xmath47 + local potential & @xmath45 & @xmath48 + nonlocal potential & @xmath44 & @xmath44 + hartree energy & @xmath49 & @xmath50 + xc functional & @xmath49 & @xmath50 + orthogonalization & @xmath44 & @xmath51 +    in hares , the wavefunctions are stored on the full grid in real space and all operations are performed on the same grid , eliminating the need for ffts .",
    "the calculation of the kinetic energy is carried out using finite - difference formulae for derivatives on a grid in real space .",
    "the hartree energy and the long - range electrostatic potential due to periodic charge density are computed by solving the poisson equation , which scales as @xmath0 . for large system sizes ,",
    "orthonormalization of the wavefunctions dominates the computational time , which then scales as @xmath44 .",
    "the treatment of the nonlocal pseudopotentials also scales as @xmath44 , unless their short - range character is exploited .",
    "we summarize the comparison of scaling between hares and a pw method in table  [ tab : scaling ] .",
    "the current parallel implementation of hares is in high performance fortran ( hpf ) , which involves single instruction multiple data ( simd ) coding .",
    "since the wavefunctions and charge density are stored in real space and distributed across processors , communication between processors is necessary in calculating :    1 .",
    "the finite - difference derivatives using the cshift operation , which cyclically shifts the data in an array on a grid along the specified direction ; and 2 .   the inner product of two functions using the the sum operation .",
    "the scaling of inter - processor communication with system size is presented in table  [ tab : communication ] . for large enough system size",
    ", the sum operations dominate the communications in a parallel calculation .",
    "@l|c|c hpf & communication & number of + operation & per operation & operations + cshift & @xmath52 & @xmath0 + sum & @xmath53 & @xmath45 +",
    "finite - difference formulae for derivatives of functions represented on a grid with finite spacing are designed to achieve high accuracy and are reasonably accurate for a polynomial function up to certain order .",
    "these formulae are typically derived for functions of one variable on grids of uniform spacing .",
    "their generalization to higher dimensions is trivial through direct product if the grid is orthogonal in the various dimensions . for periodic crystals with non - orthogonal unit cell ,",
    "it is often not possible to design an orthogonal grid with the same periodicity in all directions ; in this case the implementation of finite - difference formulae is not trivial .",
    "the coordinate transformation employed in hares provides a very simple method to treat non - orthogonal unit cells and grids . in this case",
    ", the transformation is uniform throughout the unit cell and maps an orthogonal unit cell in @xmath40space onto a non - orthogonal unit cell in @xmath54space .",
    "if @xmath55 is a matrix that gives the deformation of the orthogonal unit cell into the one under study ( _ i.e. _ its columns are the non - orthogonal unit cell vectors ) , one can always obtain a transformation that is symmetric by filtering out the rotational part of @xmath55 as follows : first obtain an auxiliary matrix @xmath56 defined as @xmath57 and then diagonalize @xmath56 to obtain a diagonal matrix @xmath58 .",
    "the jacobian for a rotation - free transformation is then given by @xmath59 where @xmath60 is a matrix that diagonalizes @xmath56 : @xmath61 .",
    "once the mapping onto an orthogonal @xmath40grid is obtained , the derivatives , length and volume elements can be obtained using the formalism described in section [ coord_trans ] .",
    "the dominant part of a dft calculation often consists of solving an eigenvalue problem , that is , obtaining the lowest few ( compared with the full spectrum ) eigenvalues and eigenvectors of a very large matrix .",
    "in the case of pw basis , the size of the matrix is determined by the number of pw components included in the basis . in the case of hares , the size of the matrix",
    "is determined by the number of points that constitute the real space grid . for small enough matrices",
    "the standard techniques of linear algebra can be employed , which give the exact ( within the numerical accuracy of the algorithm ) eigenvalues and eigenvectors of the matrix .",
    "when the size of the matrix is large , the conventional methods are not practical and the only alternative is to employ iterative approaches which approximate the eigenvalues and eigenvectors in successively improving steps .",
    "we considered two iterative algorithms for the diagonalization task in hares :    1 .",
    "an inverse iteration ( ii ) algorithm with multigrid preconditioning @xcite ; 2 .   a conjugate gradient ( cg ) algorithm @xcite with suitable preconditioning in real space .",
    "the implementation of the former has been presented earlier @xcite and we want to focus on the cg algorithm in this subsection .    in fig .",
    "[ fig : cg ] , we present a flowchart of the cg algorithm .",
    "it is similar to the one in ref .  ,",
    "presented for a pw basis . in real space ,",
    "most steps in the algorithm remain unchanged except for the preconditioning .",
    "the main idea in preconditioning is to filter out high fourier components in the wavefunctions and the charge density .",
    "we achieve this through multiple application of a coarsening transformation .",
    "for example , the coarsening applied to the charge density gives : @xmath62 , \\end{split}\\ ] ] where @xmath63 are indices of the grid points at which the charge density @xmath23 is calculated .",
    "we find that application of this transformation twice on the function under consideration results in adequate preconditioning .",
    "better preconditioning is possible in principle for selected cases but may not be worth the extra effort required ; this method provides a preconditioner that works reasonably well in all cases we have considered .",
    "another aspect of a dft calculation is that the eigenvalue problem needs to be solved repeatedly while updating the charge density to achieve self - consistency between the wavefunctions and the corresponding effective potential , which depends on the density .",
    "specifically , a self - consistent dft calculation starts with an initial guess for the density and subsequently follows an iterative procedure of alternating steps of diagonalization and improved estimate for the charge density .",
    "each iteration @xmath64 starts with a charge density @xmath65 and obtains the part of the eigenspectrum of @xmath32 that corresponds to occupied single - particle states and some low - lying unoccupied states , which depends on @xmath65 through the effective potential . at the end of an iteration",
    "the eigenfunctions are used to obtain an output charge density @xmath66 . an improved estimate for the charge density",
    "is obtained from @xmath65 and @xmath66 ; this is discussed in detail in the following subsection .",
    "we observe that diagonalization with full convergence , that is , with the tolerance for the difference between the @xmath65 and @xmath66 set to be very low , can be computationally demanding and depends on the initial guess for the density . since the charge density at the initial stage of self - consistency is far away from the self - consistent one , accurate diagonalization of the hamiltonian matrix at this stage",
    "is not worthwhile .",
    "accordingly , we limit the number of cg steps for diagonalization at the initial stages of the self - consistency loop to relatively few  we found that two cg iterations at this stage yield optimal efficiency .",
    "accurate diagonalization is achieved in the course of self - consistency as the initial guess for the eigensolver is steadily improved .",
    "we have found that the performance of the ii and cg algorithms for convergence to self - consistency is comparable .",
    "the differences are rather small and system - dependent .",
    "the advantage of the cg algorithm is that all operations take place on the same grid , whereas in the ii algorithm multi - grid preconditioning requires the mesh sizes to be a power of two .",
    "we return now to the way in which the charge density is updated at the end of each iteration . in general",
    ", the new charge density at the end of step @xmath64 can be constructed from the charge densities of previous steps : @xmath67 where @xmath68 s are mixing coefficients and @xmath69 is called the  depth \" of the mixing procedure , _",
    "i.e. _ the number of previous iterations used in the improved estimate of the density .",
    "various mixing schemes are available and have been discussed in ref .  .    in our work",
    ", we added another feature to mixing : we optimize the strength of mixing , that is , the values of the parameters @xmath68 , as a function of iteration .",
    "this feature can be used along with most of the mixing schemes employed in the literature . to illustrate the basic idea",
    ", we take a simple realization of a mixing scheme : @xmath70 @xmath71 is an extreme case where no knowledge of the input density is used , and @xmath72 corresponds to the opposite extreme where the density is not updated at all . for @xmath71 , there can be oscillations between input and output densities corresponding to underdamped mixing .",
    "on the other hand , for small @xmath73 the oscillations are overdamped resulting in slow update of the density and hence the approach to self - consistency .",
    "we have devised a way to achieve the optimal _ critical damping _ in the mixing procedure . in our scheme",
    ", we calculate the root mean square change in density @xmath74 at each iteration @xmath64 : @xmath75 where @xmath76 is the unit cell volume , and define the rate of self - consistency as @xmath77 where @xmath78 is a fictitious time associated with iterations .",
    "@xmath79 is a rough measure of how well a calculation is evolving toward a self - consistent solution .",
    "we monitor both the rate and the mixing coefficient at each iteration and can estimate @xmath80 . if @xmath79 is too small ( @xmath81 ) , the approach to self - consistency is too slow . in that case ,",
    "the mixing coefficient is increased or decreased , depending on the sign of @xmath82 , by an amount @xmath83 ,  a positive @xmath82 corresponds to smaller @xmath73 and a negative @xmath82 to larger @xmath73 compared with the optimal value of this parameter .",
    "this has the effect of keeping the strength of mixing @xmath73 near a value where @xmath84 is optimal _",
    "i.e. _ , in the neighborhood of critical damping .",
    "the magnitude of change @xmath83 is reduced over time to make sure that it converges to its optimal value .",
    "the nonlocal part of the pseudopotentials @xmath85 is used in a separable form @xcite to facilitate fast calculation of its product with the wavefunction @xmath86 : @xmath87 where @xmath24 is an atomic index , @xmath88 and @xmath89 are angular quantum indices , and @xmath90 are constants related to the normalization of the nonlocal projectors @xmath91 . straightforward application of @xmath85 on the wavefunctions scales as @xmath44 , since there are @xmath92 wavefunctions on @xmath1 grid points , and @xmath93 atoms ( the number of grid points @xmath1 is proportional to the system size measured by either @xmath93 or @xmath92 , which also scale with each other ) .",
    "this computation can be accelerated significantly , by noticing that @xmath94 is a localized function centered on atom @xmath24 .",
    "thus , a calculation of @xmath95 in real space involves only the grid points near atom @xmath24 making it an @xmath53 computation , which gives @xmath45 for the overall calculation involving the non - local pseudopotential .",
    "we use a filtered pseudopotential approach  @xcite with a filter that is smooth in @xmath96-space ( as opposed to the theta - function used in plane - wave approaches ) .",
    "this minimizes the errors in the evaluation of @xmath95 in addition to using the adaptive grid .",
    "the parallel implementation of such a calculation is not trivial , since it involves only those processors which store the grid points near the given atom @xmath24 . to address this issue",
    ", we represent the atomic projectors @xmath97 in terms of the packed projectors @xmath98 shown schematically as follows : @xmath99 where @xmath100 is defined as the projector of the @xmath101-th largest magnitude at a given grid point @xmath102 ( e.g.  @xmath103 ) , and @xmath104 is the index of the atom from which @xmath100 was generated ( in the case of the above example @xmath105 ) .",
    "we only keep a number of important pseudoprojectors @xmath106 , ( thus letting @xmath101 vary from 1 to @xmath106 ) , which we call the depth of the packed projectors .",
    "we find that @xmath107 is typically sufficient ; for example , this is exact if the nonlocal projectors of at most three atoms are nonzero at any point @xmath102 .",
    "this changes the scaling of memory requirements for the nonlocal potential from @xmath45 to @xmath0 . with this choice of packing ,",
    "the expression for the inner product becomes : @xmath108 this is readily evaluated using an extrinsic subroutine call in hpf , which involves execution of the whole routine on each processor , but on different data .",
    "effectively , an inner product @xmath95 with contribution from only the grid points inside a sphere centered at atom @xmath24 is calculated by distributing the data with respect to @xmath24 rather than grid points .",
    "forces on the atoms are calculated using the hellman - feynman theorem , as is usual in dft calculations : @xmath109 where @xmath110 is the position of atom @xmath24 . for reasons similar to those mentioned in the previous subsection",
    ", the contribution of the nonlocal pseudopotential to atomic forces is computationally demanding and scales as @xmath44 .",
    "with packed projectors @xmath111 , the scaling of this computational cost is improved to @xmath45 .",
    "this is a significant improvement for problems involving structural relaxation of large systems .",
    "the implementation of packed projectors in the calculation of forces deserves further elaboration .",
    "the force calculation with nonlocal pseudopotentials involves both the projectors @xmath97 and their derivatives @xmath112 .",
    "since the latter is needed only during the calculation of forces , it does not need to be packed and stored but can be obtained at the time when it is needed .",
    "the inner products of @xmath91 with @xmath113 have to be computed for all atoms @xmath24 at once at the beginning of a force calculation since they are packed . with these improvements ,",
    "we obtain a factor of 7 speedup in the calculation of forces for systems containing about 30 atoms .",
    "finally , we should note that as in any method that involves a computational basis which changes with the positions of the atoms , the adaptive grid generates fictitious forces referred to as pulay forces .",
    "we have implemented the correction related to the pulay forces and found that it is not significant when the grid is refined to the point where it yields adequate accuracy .",
    "thus , for all practical purposes , with an accurate grid the pulay correction to the forces can be neglected ( see also ref .  ) .      in modern _",
    "ab initio _ total energy calculations , one of the objectives is to obtain minimum energy geometries ( corresponding to local minima or , if possible , the global minimum of the energy ) , where the hellmann - feynman force on each atom is zero or , more precisely , smaller in magnitude than a prescribed value ( typically @xmath114  mry / a.u . ) .",
    "the process in which the initial ionic geometry is sequentially updated to relax to a neighboring local minimum is referred to as the _ ionic relaxation_. mathematically , the ionic relaxation is a nonlinear optimization problem , which is a subject of vast interest in applied mathematics .",
    "many optimization algorithms have been proposed so far , which can be broadly classified into three groups :    1 .",
    "algorithms which require only the evaluation of the function ; 2 .",
    "algorithms requiring the function values and its gradients ; 3 .",
    "algorithms requiring the function values and its first and second derivatives ( the gradients and the hessians ) .    in electronic structure calculations , the function",
    "to be optimized is the total energy and its gradients are the forces on the atoms . since the forces are not too computationally demanding compared to the self - consistency loop ( especially after implementing the improvement discussed in the previous subsection ) , it is natural to use the methods of class ( ii ) for ionic relaxation .    among the gradient algorithms ,",
    "the quasi - newton ( also referred to as variable metric ) method is known to be most efficient @xcite . the inverse hessian is approximated and updated at each iteration .",
    "suppose @xmath115 is an initial estimate of the minimizer of the total energy @xmath116 , @xmath117 is the corresponding gradient , and @xmath118 is the initial guess for the inverse hessian .",
    "at the @xmath119-th relaxation step , the next approximate minimizer is given by @xmath120 where the step size @xmath121 is determined by the line search @xcite ( or the line minimization ) .",
    "the inverse hessian is updated by @xmath122 where @xmath123 is the correction to @xmath124 and is determined by requiring that it satisfies the quasi - newton condition , @xmath125 with @xmath126 and @xmath127 .    among different update formulae for the inverse hessian @xcite",
    ", we have implemented the initially - scaled broyden - fletcher - goldfarb - shanno ( is - bfgs ) expression @xcite : @xmath128 where @xmath129 , when @xmath130 and @xmath131 , otherwise .",
    "implemented in combination with the approximate line search algorithm @xcite , the is - bfgs provides an efficient ionic relaxation tool which assures the convergence of the approximate inverse hessian to the correct inverse hessian and is numerically stable . as noticed in other works @xcite , restarting the update sequence [ eq .",
    "( [ eq : is - bfgs ] ) ] can be beneficiary in some cases , and we have used the following restart criterion : @xmath132 .",
    "this implies that the displacement of an atom is not too different from the direction of the calculated force acting on it .",
    "typically , the representation of the charge density and local potentials in a dft calculation needs twice as much spatial resolution as that of the wavefunctions . to exploit this aspect of electronic structure calculations",
    ", we have developed a version of hares which employs two separate real - space grids  a coarser one and a finer one .",
    "the wavefunctions are represented on the coarser grid and the charge density on the finer one with half the grid - spacing of the former .",
    "the finer grid corresponds to the fft grid in a pw calculation .",
    "this version of the code reduces memory requirements substantially .",
    "the computational cost of the worst scaling part of the calculation ( the wavefunction orthogonalization ) is reduced by a factor of 8 .    the transformation from the coarser to the finer grid",
    "is performed only when the charge density needs to be calculated from the wavefunctions .",
    "we use wavelet interpolants  @xcite to achieve this .",
    "the poisson equation is solved on the finer mesh to obtain the electrostatic potential .",
    "the exchange correlation potential and the local part of the pseudopotential are also calculated on the finer grid ; these terms are convolutions in @xmath96-space and in a pw method are calculated on the fft grid . the kinetic energy operator and the nonlocal pseudopotential act on the wavefunctions directly on the coarser grid",
    ". naturally , this necessitates usage of a higher order laplacian in the calculation of the kinetic energy , while the one with lower order is adequate in the solution of the poisson equation .    to check the accuracy of the dual - grid code , we calculated the energy difference between two configurations of the o@xmath133 molecule and compared it with the result of a pw calculation .",
    "both methods were used at different energy cutoffs , or equivalently , of spatial resolution .",
    "we found that the energy difference as a function of the energy cutoff behaves the same way in both methods .",
    "in fact , at a low energy cutoff , the sign of the energy difference was inverted in both calculations and the magnitude was within 6  % of the correct value .    while the dual - grid approach to real - space electronic structure calculation enhances the performance significantly",
    ", we caution that the errors introduced by breaking of translational invariance , a feature inherent in real - space grids ( see ref .  ) , are larger than those in the single finer grid calculations .",
    "this is due to the coarser grid used in the representation of wavefunctions and the higher order expression for the laplacian on the coarser grid . within the pw method",
    ", the same error enters in calculating the xc potential on the real - space fft mesh .",
    "these errors enter into the calculation of forces and can be minimized if necessary by using fourier - filtered pseudopotentials .",
    "we expect the use of the dual - grid approach to be very advantageous at the initial stages of ionic relaxation of a system with large number of atoms , when the accuracy in forces or wavefunctions is not crucial since the system is presumably far from its optimal structure .      @l|c|c system & cpu time ( 8 nodes ) & cpu time ( 1 node ) + & hares & castep 2.1 + o@xmath133 & 150 sec & 1548 sec + si@xmath134o@xmath135 & 7.5 hours & 36 hours +    in table  [ tab : acres - pw ] , we present a comparison of the performance of hares and that of a pw code , for dft calculations on the o@xmath133 molecule and a zeolite , si@xmath134o@xmath135 .",
    "we have selected for the comparison the academic version of castep  @xcite , a pw package which uses all the standard methods for such calculations and is freely available to academic researchers , as is also the case for hares .",
    "we believe this provides the most meanigful comparison of the performance of the different approaches , for codes at equivalent levels of development and availability to the academic community .",
    "it is clear that the performance of hares for the oxygen molecule is definitely better than the pw code . in general",
    ", we find that hares performs better for metallic systems .",
    "for the zeolite , which is an insulator , castep uses a variational method for direct minimization of the total energy , which is not applicable to the case of metals .",
    "this makes the performance of castep very good for such systems , though the performance of hares is not unacceptable ( a factor of 1.66 slower than castep ) .",
    "this advantage of castep over hares is lost when applied to metallic systems , in many of which the academic version of castep available to us failed to converge in the self - constistency loop .",
    "we have been informed that in commercial versions of this package the problematic convergence to self - consistency in metallic systems has been solved and the performance has been improved  @xcite .",
    "we point out that a comparison of _ ab initio _ packages , is meaningful only for methods that employ the same type of pseudopotentials . in the comparison discussed here ,",
    "both methods use conventional norm - conserving pseudopotentials .",
    "there exists another class of pseudopotentials , called ultra - soft pseudopotentials  @xcite , which reduce the size of the hamiltonian matrix substantially , making the calculations more efficient .",
    "codes that employ this class of pseudopotentials are naturally faster , whether they use a pw basis or a real - space grid . for instance , the vasp code based on the pw formulation uses ultra - soft pseudopotentials and has proven quite effective@xcite ; the commercial version of castep also uses these pseudopotentials  @xcite . this class of pseudopotentials has not been yet implemented in hares .",
    "as a test of the accuracy and the efficiency of the algorithmic improvements discussed above , we offer a range of example applications of hares . these include representative elemental crystals , some molecules , and a couple of rather complex materials  blue molybdenum bronze and the ton zeolite .",
    "all the calculations were performed on a silicon graphics origin 2000 , using from 2 to 16 processors in parallel mode .",
    "the simplest test of the method is its application to elemental crystalline solids .",
    "we have calculated the basic structural and electronic properties for representative elemental solids , including alkali metals ( li , k ) , group ii a metals ( be , ca ) , sp - electron metals ( al , ga ) , d - electron non - magnetic metals ( v , cu , mo ) , d - electron magnetic metals ( fe , ni ) , and semiconductors and insulators ( si , c ) . the properties of these solids are extracted from total energy calculations for a given crystal structure , using the lda and applying the _ a posteriori _ gga corrections .",
    "we have used norm - conserving pseudopotentials from bachelet  _ et al _",
    "@xcite for v , and pseudopotentials generated with the troullier and martins  @xcite scheme for the all the other elements .",
    "we perform the calculations as follows : we choose a sufficiently dense grid of * k*-points in the monkhorst - pack scheme  @xcite and fold it to the irreducible part of the brillouin zone by applying the symmetry operations of the point group of the crystal including inversion which is always a symmetry operation in reciprocal space .",
    "we make sure the calculation is converged with respect to the real space grid spacing in the neighborhood of the anticipated equilibrium lattice constant , and keep the grid spacing approximately constant for a range of lattice constants up to about twice the equilibrium value .",
    "we then fit the resulting energies to powers of @xmath136 , where @xmath76 is the volume of the unit cell .",
    "we thus obtain accurate values of the equilibrium lattice constant and minimum total energy .",
    "these values are used to fit the two - parameter universal binding energy relation  @xcite , which has a simple analytical form from which the bulk modulus and the cohesive energy are obtained .",
    "this procedure relies on the fact that the total energy differences used to fit the universal binding energy relation converge quicker than the total energy with respect to the grid parameters . for the nonmagnetic materials we use the non - spin - polarized code to perform these calculations for reasons of computational efficiency .",
    "the free atoms in most of the cases we calculated are polarized , the extreme case being molybdenum were all six valence electrons have the same spin .",
    "we thus add to the cohesive energy as calculated previously the difference of a free atom calculation using the spin - polarized and spin - average codes .",
    "the free atom calculations can be converged to the same , high degree of accuracy by use of the adaptive grid and thus the relative energies of the spin polarized and unpolarized atoms are evaluated on an equal footing with the other energy differences .    [ cols=\"^,^,^,^,^,^,^,^,^,^,^ \" , ]     = 1.00    in table  [ tab : elements ] , we summarize the results of the calculations .",
    "the experimental values are a compilation of results from kittel@xcite ; for certain elements we considered a simpler lattice than the experimental ground state , and in these cases we compare our results to the all - electron calculations of moruzzi  _ _ et al__@xcite .",
    "note that , as expected , the lda results for the lattice constant are lower , and for the bulk modulus are higher than the experimental values .",
    "the gradient correction tends to improve the situation .",
    "overall , the agreement with experiment is quite good , except for the cohesive energies , which is a well known deficiency of the approach we are using . looking at the gradient corrected results , other than ca which seems to have large offsets , the lattice constants are within 2.0% of the experimental values , bulk moduli within 22% , and cohesive energies are within 26% . in fig .",
    "[ fig : scaled - elemental ] we present the scaled results of the gradient corrected calculations and the corresponding universal curve .",
    "the magnetic moments of the ferromagnetic materials at their equilibrium lattice constant values as calculated with the lda ( gc ) are 2.06 ( 2.30 ) @xmath137/atom for fe and 0.57 ( 0.59 ) @xmath137/atom for ni .",
    "these values compare well with the experimental values of 2.22 @xmath137/atom for fe and 0.61 @xmath137/atom for ni , as well as with the summary of the results of various theoretical methods that is presented in ref .  .      in sec",
    "[ bound_cond ] , we described how two types of boundary conditions  obc and pbc  can be readily used in a hares calculation .",
    "many dft methods designed to do calculations for solids use pbc and are constrained to use a large supercell to study an isolated molecule or a cluster of atoms . here , we present results for four molecules n@xmath133 , o@xmath133 , h@xmath133o , and nh@xmath138 obtained using hares with the two types of boundary conditions keeping all other computational parameters fixed .",
    "we use a periodic box of dimensions 24 @xmath139 18 @xmath139 18 a.u.@xmath140 for the n@xmath133 and o@xmath133 molecules and 20 @xmath139 20 @xmath139 20 a.u.@xmath140 box for the h@xmath133o and nh@xmath138 molecules , with a grid spacing of 0.25 a.u .    in table",
    "[ tab : molecule - bc ] , the various results for small molecules are summarized . in ammonia",
    ", we also calculated the inversion barrier of the potential energy surface , by relaxing the positions of the hydrogen atoms in the plane for selected heights of the nitrogen atom .",
    "we find that the bond - lengths obtained with obc tend to be smaller than those obtained with pbc , though the difference is quite small , in most cases smaller than the accuracy in the reported results .",
    "the energies , on the other hand , have significantly larger differences .",
    "we suggest that this is due to the electrostatic interaction of the field in a supercell calculation with pbc .",
    "this interaction between the molecule and its periodic images changes the energy of the molecule . in the examples considered here a cubic cell geometry",
    "is used , which results in zero dipole interaction ( it can be shown analytically that the interaction energy of a dipole with a full shell of dipoles is zero ) .",
    "this indicates that the discrepancy is due to higher - order multipole terms .",
    "the computational time for the calculations with pbc and obc is similar , so there is no particular advantage to either approach from the point of computational cost .",
    "it appears , however , that for truly isolated systems the obc approach gives more realistic results due to the absence of any spurious long range fields .",
    "@l|c|c|c|c molecule & property & expt . &",
    "obc & pbc + n@xmath133 & bond - length (  ) & 1.10 & 1.10 & 1.10 + & cohesive energy(ev ) & 9.9 & 9.8 & 10.0 + & vibration ( @xmath141 ) & 2359 & 2395 & 2390 + o@xmath133 & bond - length (  ) & 1.21 & 1.22 & 1.22 + & cohesive energy(ev ) & 5.20 & 7.63 & 7.79 + & vibration ( @xmath141 ) & 1580 & 1584 & 1571 + h@xmath133o & bond - length (  ) & 0.98 & 0.97 & 0.97 + & bond - angle & @xmath142 & @xmath143 & @xmath144 + nh@xmath138 & h - h distance (  ) & 1.64 & 1.67 & 1.68 + & n - h bond - length (  ) & 1.00 & 1.02 & 1.02 + & energy barrier ( ev ) & 0.23 & 0.13 & 0.10 +      the material called blue bronze ( bb ) , whose chemical composition is a@xmath147moo@xmath148 with a an alkali metal , exhibits a variety of interesting physical properties including a metal - to - semiconductor transition at @xmath149  k , quasi - one - dimensional electronic properties above @xmath150 , and the existence of incommensurate and commensurate charge density wave ( cdw ) phases  @xcite .",
    "recently , a family of molybdenum bronzes has been extensively studied in experiments using angle - resolved photoemission spectroscopy ( arpes ) to explore a possible realization of non - fermi - liquid behavior due to its low - dimensional electronic properties  @xcite . to our knowledge",
    ", the only published electronic band calculation of bb is based on a tight - binding ( tb ) method using some model structures  @xcite .",
    "the dispersion of the tb bands around the fermi level is _ qualitatively _ different from the arpes experimental results  @xcite .",
    "it is of great importance to have an accurate and reliable _ ab initio _ calculation of the electronic structure of bb in order to interpret the arpes measurement in terms of possibly interesting physics . with a large number of atoms in the unit cell , including 10 mo atoms and 30 o atoms which are typically difficult to handle with pw approaches",
    ", bb provides a challenging system for performing state - of - the - art _ ab initio _ calculations of the electronic structure ; this requires a highly efficient computational tool such as hares .",
    "the structure and the lattice parameters of bb is well documented in ref .",
    ": the bravais lattice is centered monoclinic ( cm ) , the space group is c2/m , and the lattice constants of the simple monoclinic cell are @xmath151  , @xmath152  , and @xmath153    with the angle @xmath154 between @xmath155 and @xmath156 .",
    "the basic building block of bb is the moo@xmath157 octahedron ; ten octahedra form a rigid unit by edge - sharing . within the simple monoclinic ( sm ) cell , two rigid units",
    "are arranged so that one of them is located at the apex and the other at the center of the cell . as a result ,",
    "neighboring rigid units share a corner oxygen to form a slab spanned by @xmath158 and @xmath159 and four infinitely - connected moo chains ( per primitive unit cell ) parallel to @xmath159 .",
    "the crystal structure is illustrated in fig .",
    "[ fig : bb - str ] where the simple monoclinic cell is indicated by a box ; the two different classes of octahedra are indicated by different colors : yellow for those that participate actively to conduction along the high - conduction direction ( @xmath159 ) and blue for those that are apparently inactive .",
    "= 0.9    we have performed electronic structure calculations for bb with hares . for these calculations we use the ceperley - alder xc functional as parametrized by perdew and zunger  @xcite .",
    "the ions are represented by norm - conserving pseudopotentials generated by the troullier - martins scheme  @xcite in the fully separable form of kleinman and bylander  @xcite .",
    "the brillouin zone ( bz ) integrations are performed using a @xmath160 monkhorst - pack * k*-point mesh@xcite in the bz of the cm cell .",
    "we used a grid spacing of @xmath161  a.u .  which gives around 200,000 real - space grid points .",
    "= 1.00    in fig .",
    "[ fig : bb - rho ] , we show isosurfaces of the valence electron density obtained from the fully self - consistent calculation .",
    "a few interesting features can be observed from the green isosurfaces which correspond to high electron density :    1 .",
    "the high density region has a cylindrical shape with its axes overlapping with moo infinite chains ; 2 .",
    "the electron density is `` marginally '' connected along the [ @xmath162 crystallographic direction , which is within the slab but perpendicular to the chain direction ; 3 .",
    "the electron density is `` barely '' connected along the slab normal .    from these observations",
    ", we expect that electronic conduction will be highly anisotropic and the chain direction is the most favored . on the other hand ,",
    "the blue isosurfaces , corresponding to low electron density , indicate that the valence electrons are largely depleted around the potassium ion sites , suggesting that k atoms play the role of donors .",
    "= 1.00    the full spectrum of the energy bands is shown in fig .",
    "[ fig : bb - band ] .",
    "the lower valence band manifold ( 30 bands ) has o(@xmath163 ) orbital character , the upper valence band manifold ( 90 bands ) has o(@xmath164 ) character mixed with mo(@xmath165 ) orbitals near the top of the energy range .",
    "there are two bands crossing the fermi level shown in red , well separated from both the valence band and the conduction band manifolds .",
    "these bands disperse primarily along the chain direction which is indicated by gray panels in fig .",
    "[ fig : bb - band ] .    the two partially filled bands of our _ ab initio _ calculation are qualitatively different from the tb bands  @xcite as illustrated in fig .",
    "[ fig : bb - band - ldantb ] . for instance , the two lda bands cross each other near the bz boundary whereas the tb bands do not . within the sm bz ( from -@xmath166 to @xmath166 ) ,",
    "the lda bands have occupied bandwidths of 1.3 and 0.3 ev while both of the tb bands disperse by 0.3 ev .",
    "the occupied bandwidth of 1.3 ev for the low - lying band is in good agreement with the apres data@xcite .",
    "these qualitative differences in the _ ab initio _ and tb bands originate from the correct and unbiased description of the interactions and the use of a realistic atomic structure in our calculations .",
    "our analysis of the wavefunction character at the @xmath167-point shows anisotropic hybridization between the mo @xmath69-states and the o @xmath168-states",
    ". it would be rather difficult to describe this situation within the context of the tb approach .",
    "= 1.00    the significant dispersion of the partially filled bands only along the chain direction results in planar fermi surfaces , which are nested along the chain direction . in turn ,",
    "the nested fermi surfaces induce a cdw .",
    "the estimated cdw wave vector is @xmath169 @xmath170 compared with the observed one in the range of @xmath171 ",
    "a more detailed analysis of the physics of this material will be presented elsewhere  @xcite .    in summary",
    ", our application of hares to the electronic structure of bb suggests that an accurate and reliable method with a realistic atomic structure is needed in order to investigate the behavior of such complex materials .",
    "the _ ab initio _ energy bands are in good agreement with the arpes measurement and the nature of the electronic states relevant to conduction can thus be elucidated .",
    "the word `` zeolite '' ( of greek origin ) means `` boiling stone '' and derives from the visible loss of water when natural zeolite minerals are heated .",
    "zeolites are materials with unique properties which make them useful in a variety of applications such as oil cracking , nuclear waste management , catalysis and animal feed supplements .",
    "they form a well - defined class of naturally occurring crystalline alumino - silicate minerals .",
    "they have elegant three - dimensional structures arising from a framework of [ sio@xmath175^{4-}$ ] and [ alo@xmath175^{5-}$ ] coordination tetrahedra linked at their corners .",
    "the frameworks are generally very open and contain cavities that enclose cations and water molecules .",
    "the presence of cavities make zeolites porous and gives rise to their low density and unique properties .",
    "since the cations , water or other molecules that can be contained in these cavities , interact weakly with the cavity walls , these entities have high mobility in the solid zeolite . as a result",
    "a number of interesting physical and chemical properties arise : facile ion exchange , easy water loss upon heating , molecular sieve behavior , etc .",
    "= 1.0    in this section , we study a zeolite which is referred to by the code name `` ton ''  @xcite and has the general chemical formula na@xmath173al@xmath173 si@xmath174o@xmath135 ; we will consider the structures for @xmath130 and @xmath176 .",
    "the framework of tetrahedra in its crystal structure is displayed in fig .",
    "[ fig : zeo_str ] .",
    "ton has an orthorhombic crystal structure with three different types of pores or channels parallel to the @xmath177-axis . for @xmath130",
    ", its unit cell has 24 formula units of sio@xmath133 with a volume of about 1320  @xmath140 .",
    "its space group is cmc2@xmath178 and four of the 24 formula units are symmetry - independent . for @xmath176 ( called theta-1 ) ,",
    "the structure has been determined from x - ray powder experiments  @xcite .",
    "theta-1 is the first reported unidimensional medium - pore high - silica zeolite .    starting with the experimental geometry  @xcite , we relaxed the atomic structure of si@xmath134o@xmath135 using hares .",
    "all the bond lengths obtained from the calculation are within 2% of the experimental values .",
    "we next considered four independent si sites where an al atom can be substituted for a si atom to obtain alsi@xmath179o@xmath135 , and relaxed its atomic structure .",
    "interestingly enough , we find that all four possible structures have very similar energies . within the accuracy of our calculations the four sites can not be differentiated .",
    "addition of a sodium atom to the alsi@xmath179o@xmath135 structure introduces a variety of structural possibilities .",
    "we explored three possible structures , based on the three types of cavities in which the na atom can be placed . in fig .",
    "[ fig : zeo_unit ] , we show a unit cell of a structure with na added in the largest of the three cavities . since alsi@xmath179o@xmath135 is missing one electron due to the substitution of a si atom by an al atom , the added na atom will naturally prefer to stay in the vicinity of the al atom to which is can donate its valence electron . in the relaxed structure , the na atom sits closest to three o atoms that are bonded to the al atom and as a result the al - o bonds are elongated .",
    "= 1.0    in fig .",
    "[ fig : zeo_unit ] , we also show an isosurface of the electron density for naalsi@xmath179o@xmath135 and compare it with that of si@xmath134o@xmath135 .",
    "the two systems have very similar charge distribution except in the region localized near the na and al atoms .",
    "the isosurfaces clearly have the same topology as the geometrical structure in fig .",
    "[ fig : zeo_unit ] : o atoms are at the center of the bulging regions of the isosurface and si atoms at the joints or vertices .",
    "this indicates that the bonding is primarily ionic , with negatively charged o and positively charged si atoms .",
    "partial covalent character is also evident from the fully connected isosurface .    in naalsi@xmath179o@xmath135 , the valence electron donated by na compensates for the one missing electron in the four bonds formed by the al atom .",
    "the nature of bonding of al with o atoms on the opposite side of the na atom is clearly different from that with the three o atoms on the na side .",
    "the latter is very similar to the bonding character between si and o in si@xmath134o@xmath135 .",
    "the charge on both al and na is positive , which has the effect of displacing the al atom slightly away from the na atom resulting in longer al - o bonds .",
    "this introduces small structural distortions and changes in charge distribution in the neighboring sio@xmath180 tetrahedra .",
    "since the addition of na results in compensating electrostatic and covalent interactions , we expect that the energy barrier in the process of attachment of na ( or in general a cation ) to the walls of cavities in this zeolite should be very small .",
    "further investigation of the chemical activity inside these pores and its effect in the electronic structure of the zeolite will be the subject of future studies  @xcite .",
    "in this paper , we provided a comprehensive review of the theory underlying hares , which is a method for _ ab initio _ electronic structure calculations implementated using hpf on a shared memory parallel computer architecture .",
    "several applications of the method to calculate the properties of simple and complex physical systems were presented to illustrate its capabilities .",
    "we obtained the bulk features of elemental solids such as equilibrium lattice constant , bulk modulus and cohesive energy , for elements from many different columns of the periodic table , and find good agreement with experiment within the limitations of dft / lda calculations . for the small molecules n@xmath133 , o@xmath133 , h@xmath133o , and nh@xmath138 , we find that the structural features do not depend on boundary conditions ( open or periodic ) used in the calculation , while the energy is sensitive to the the choice of boundary conditions .",
    "application of the method to blue molybdenum bronze and a zeolite demonstrate that it can be used effectively to study complex material systems . in the case of blue bronze the results help to clarify important issues of the electronic structure pertaining to recent experiments . in our study of the ton zeolite si@xmath134o@xmath135 and its variations containing al and na atoms",
    ", we demonstrated the ability of the method to capture the nature of bonding between a cation and the walls of cavities in the zeolite ; such interactions are related to the mobility of ions and molecules inside pores of the zeolite framework and should give rise to interesting physical and chemical behavior .",
    "the original development of the adaptive - grid real - space method was supported by the office of naval research through the common high - performance scientific software initiative ( chssi ) and the high performance computation modernization office .",
    "this set of codes is available upon request  .",
    "the subsequent development of hares was funded by ryoka systems inc .",
    "the authors wish to acknowledge useful discussions and collaborations with melvin chen and greg smith , and useful comments from nick choly , ioannis remediakis , jose soler and g .- h .",
    "gweon .",
    "d. m. ceperley and b. j. alder , phys .",
    "* 45 * , 566 ( 1980 ) .",
    "j. p. perdew and a. zunger , phys .",
    "b * 23 * , 5048 ( 1981 ) .",
    "j. p. perdew and y. wang , phys .",
    "b * 45 * , 13244 ( 1992 ) .",
    "s. h. vosko , l. wilk , and m. nusair , can .",
    "j. phys .",
    "* 58 * , 1200 ( 1980 ) .",
    "u. von barth and l. hedin , j. phys .",
    "c * 5 * , 1629 ( 1972 ) . y .-",
    "juan and e. kaxiras , phys .",
    "b * 48 * , 14944 ( 1993 ) . y .-",
    "juan , e. kaxiras , and r.  g.  gordon , phys .",
    "b * 51 * , 9521 ( 1995 ) .",
    "j. p. perdew , in _ electronic structure of solids 91 _ , edited by p. ziesche and h. eschrig ( akademie verlag , berlin , 1991 ) , p.  11 ; j. p. perdew , j. a. chevary , s. h. vosko , k. a. jackson , m. r. pederson , d. j. singh , and c. fiolhais , phys .",
    "b * 46 * , 6671 ( 1992 ) .",
    "j. p. perdew , k. burke , and y. wang , phys .",
    "b * 54 * , 16533 ( 1996 ) .",
    "j. p. perdew , k. burke , and m. ernzerhof , phys .",
    "lett .  * 77 * , 3865 ( 1996 ) .",
    "j. p. perdew , m. ernzerhof , a. zupan , and k. burke , j. chem .",
    "phys .  * 108 * , 1522 ( 1998 ) . m. fuchs , m. bockstedte , e. pehlke , and m. scheffler , phys .",
    "b * 57 * , 2134 ( 1998 ) .",
    "a. r. williams , v. l. moruzzi , j. kbler , and k. schwarz , bull .",
    "* 29 * , 278 ( 1984 ) ; k. schwarz and p. mohn , j. phys .",
    "f * 14 * , 1129 ( 1984 ) . v. l. moruzzi , p. m. marcus , k. schwarz , and p. mohn , phys .",
    "b * 34 * , 1784 ( 1986 ) .",
    "d. j. singh , _",
    "planewaves , pseudopotentials and the lapw method _",
    "( kluwer academic publishers , boston , 1994 ) . j. r. chelikowsky , n. troullier , and y. saad , phys .  rev .  lett .  *",
    "72 * , 1240 ( 1994 ) ; j. r. chelikowsky , n. troullier , k. wu , and y. saad , phys .  rev .",
    "b * 50 * , 11355 ( 1994 ) .",
    "e. l. briggs , d. j. sullivan , and j. bernholc , phys .",
    "b * 52 * , r5471 ( 1995 ) ; phys .",
    "b * 54 * , 14362 ( 1996 ) .",
    "s. baroni and p. giannozzi , europhys .",
    "* 17 * , 547 ( 1992 ) .",
    "k. a. iyer , m. p. merrick , and t. l. beck , j. chem .",
    "phys .  * 103 * , 227 ( 1995 ) .",
    "t. hoshi , m. arai , and t. fujiwara , phys .",
    "b * 52 * , r5459 ( 1995 ) .",
    "f. gygi and g. galli , phys .",
    "b * 52 * , r2229 ( 1995 ) .",
    "j. ihm , a. zunger , and m. l. cohen , j. phys .",
    "c * 12 * , 4409 ( 1979 ) ; * 13 * , 3095(e ) ( 1980 ) .",
    "j. r. chelikowsky and s. g. louie , editors , _ quantum theory of real materials _ ( kluwer press , 1996 ) and",
    "references therein .",
    "n. a. modine , _ ph.d .",
    "department of physics , harvard university , cambridge , ma 02138 .",
    "k. w. brodlie , _ the state of the art in numerical analysis _ , ed .",
    "d. jacobs , ( academic press , london , 1977 ) , chap .",
    "g. r. walsh , _ methods of optimization _ , ( john wiley & sons , london , 1975 ) , chap .",
    "shanno and k .- h .",
    "phua , math .  program .",
    "* 14 * , 149 ( 1978 ) . n. chetty , m. weinert , t. s. rahman , and j. w. davenport , phys .  rev .",
    "b * 52 * , 6313 ( 1995 ) .",
    "r. fletcher , computer j. * 13 * , 317 ( 1970 ) .",
    "m. j. d. powell , math .",
    "programming * 12 * , 241 ( 1977 ) .",
    "d. f. shanno , mathematics of operations research * 3 * , 244 ( 1978 ) .                          c. schlenker , _ low - dimensional electronic properties of molybdenum bronzes and oxides _ , ( kluwer academic publishers,1989 ) .",
    "r. claessen _ et al .",
    "_ , j. electron spectrosc .  relat .",
    "phenom .  * 76 * , 121 ( 1995 ) g .- h .",
    "et al . _ , j. phys .",
    "condens .",
    "matter * 8 * , 9923 ( 1996 ) .",
    "j. d. denlinger , g .- h .",
    "gweon , j. w. allen , c. g. olson , j. marcus , c. schlenker , and l .- s .",
    "hsu , phys .",
    "82 * , 2540 ( 1999 ) .",
    "whangbo and l. f. schneemeyer , inorg .",
    "chem .  * 25 * , 2424 ( 1986 ) .",
    "m. ghedira , j. chenavas , m. marezio , and j. marcus , j. solid state chem .",
    "* 57 * , 300 ( 1985 ) .",
    "h. kim , u. v. waghmare , and e. kaxiras , ( unpublished ) ."
  ],
  "abstract_text": [
    "<S> we discuss our new implementation of the real - space electronic structure method for studying the atomic and electronic structure of infinite periodic as well as finite systems , based on density functional theory . </S>",
    "<S> this improved version which we call hares ( for high - performance - fortran adaptive grid real - space electronic structure ) aims at making the method widely applicable and efficient , using high performance fortran on parallel architectures . </S>",
    "<S> the scaling of various parts of a hares calculation is analyzed and compared to that of plane - wave based methods . </S>",
    "<S> the new developments that lead to enhanced performance , and their parallel implementation , are presented in detail . </S>",
    "<S> we illustrate the application of hares to the study of elemental crystalline solids , molecules and complex crystalline materials , such as blue bronze and zeolites . </S>"
  ]
}