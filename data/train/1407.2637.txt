{
  "article_text": [
    "in the standard scenario of cosmological structure formation , cosmological haloes are the features of the cosmic web of highest overdensity in approximate virial equilibrium , that result from the nonlinear amplification of initially - linear , gaussian - random density fluctuations by gravitational instability .",
    "galaxies and haloes , however , are not unbiased tracers of the underlying density distribution , and thus understanding this `` bias '' effect is crucial to extract cosmological information from the data of galaxy surveys , for example .",
    "the idea that galaxy bias ( from this point on , we will sometimes denote dark matter haloes loosely by `` galaxies '' to reflect the original ideas of associating galaxies purely by high - density peaks without resorting to hydrodynamical cooling mechanism ) exists and can be calculated from the statistics of gaussian random initial density fields was pioneered by @xcite .",
    "@xcite extended this idea to take a full account of the gaussian random density field in a cosmological context , to understand how haloes grow out of this random field and cluster spatially . in the meantime , (",
    "* ps hereafter ) associated cosmological haloes ( or galaxies ) as high - density peaks and estimated halo mass function , and this ps formalism was recounted more rigorously by @xcite through their excursion set formalism ( sometimes called the extended ps formalism ) , where they showed that cloud - in - cloud effect explains the fudge multiplicity factor 2 in the ps mass function . all these ideas form the backbone of the peak - background split scheme for calculating the galaxy bias by @xcite , which bears the idea that haloes ( peaks ) are more typically formed in high density regions .",
    "* mw hereafter ) calculated fully nonlinear bias combining the peak - background split scheme with the spherical top - hat collapse model under the extended press - schechter formalism , and also calculated the useful `` linear bias parameter '' in the linear regime .",
    "the peak - background split scheme may not give a perfectly accurate prediction of n - body simulation results ( e.g. mw ; @xcite ) , which is usually attributed to the discrepancy between the ps mass function and the n - body halo mass function at low- and high - mass ends ( e.g. @xcite , st hereafter ; @xcite ) .",
    "this discrepancy stimulated better - fitting functional forms ( e.g. st ; @xcite ) .",
    "* bl hereafter ) then developed a hybrid scheme of combining st mass function and the linear bias parameter derived from the extended press - schechter formalism and showed that this fitted the linear n - body halo bias better than mw prediction .",
    "bias can of course have stochasticity , which was formulated theoretically by ( * ? ? ?",
    "* dl henceforth ) : haloes sampled inside a suite of eulerian cells of a given density , or count - in - cell ( cic ) haloes , are expected to deviate from purely poisson distribution , if there is either correlation or anti - correlation of haloes at sub - cell scales which then result in variance of the number of haloes ( @xmath4 ) larger or smaller than poissonian value , respectively ( e.g. @xcite ; see also section  [ sub : statistics ] ) .",
    "@xcite compared the prediction by dl to n - body simulation results , and based on the observed @xmath4 they concluded that haloes are usually correlated in overdense regions and anti - correlated in underdense regions ( we will however contradict this claim in section [ sub : result : scatter ] ) . later work found that haloes usually show variance larger than the poissonian value ( e.g. @xcite find that haloes of mass @xmath5 show this `` super - poissonian '' distribution under @xmath6 cells ) , which are well fitted by the functional distributions suggested by @xcite and @xcite .    a useful application of the nonlinear halo bias prescription is to create mock halo catalogues in a large scale for either cosmology or astrophysics .",
    "while mock galaxy catalogues can be created by schemes based on quasi - linear perturbation theory , such as pinocchio @xcite and pthaloes @xcite , they are usually limited to the scales under which density perturbation remains quasi - linear at most .",
    "this limitation can be overcome by nonlinear halo bias schemes , as in @xcite who prove the concept by generating halo catalogues which are statistically consistent with n - body halo catalogues , suited for probing the baryon acoustic oscillation ( bao ) feature by surveys such as the baryon oscillation spectroscopic survey ( boss ) .",
    "we intend to achieve a similar goal in the long run , but with a bias scheme that is fully nonlinear and is applicable regardless of the halo mass , the filtering scale and the redshift . because we will calculate the bias parameter theoretically",
    ", our scheme will mitigate the need to find an empirical fitting formula as done in e.g. @xcite .",
    "a similar formalism can also be applied to astrophysical problems .",
    "understanding the halo bias is crucial e.g. in the study of cosmic reionization , due to the very large dynamic gap between the very small galaxies believed to be the main drivers of reionization ( see e.g. * ? ?",
    "* for a review ) and the large characteristic scales of the reionization patchiness @xcite .",
    "@xcite used a hybrid halo bias scheme to study the fluctuation of the 21 cm background from the fluctuating halo distribution during the epoch of reionization ( eor ) .",
    "fast semi - numerical simulators of reionization @xcite , whose basis was formulated by @xcite and @xcite to replace the time - consuming ray - tracing by a faster excursion set formalism , make use of a similar formalism to seed haloes in a coarse - grained density field .",
    "we have indeed applied this formalism to a simulation of cosmic reionization , by which we could span the full dynamic range of halos hosting radiation sources .",
    "cosmic reionization is believed to occur very inhomogeneously with large h ii regions , whose sizes show a wide distribution peaked at @xmath7 comoving mpc before completion if roughly put .",
    "therefore it is necessary to use a large box in order to simulate the reionization process in a statistically reliable way .",
    "this requirement , however , limits the ability of the simulation to resolve `` minihaloes '' which are believed to host population iii stars , and allows the simulation to only resolve the more massive kind , or `` atomic - cooling halos '' .",
    "indeed most reionization simulations in large boxes used to implement atomic - cooling halos only , while this may underestimate the photon budget in the early stage of reionization . in a large - scale ( box size of",
    "@xmath8 comoving ) simulation of cosmic reionization ( with ray - tracing method ) , @xcite used the conditional halo bias found in section [ sub : minihaloes ] of this paper to include minihaloes , which could not otherwise have been realized due to numerical resolution .",
    "this way , they could span the full dynamic range of haloes  both minihaloes and atomic - cooling haloes  responsible for emitting hydrogen - ionizing and @xmath9-dissociation radiation , and observed that the reionization process is extended further in time to comply better with several observational constraints .    on much larger scales ( box size of @xmath10 comoving )",
    "the same technique was used to perform the largest - volume , ray - tracing simulations of cosmic reionization to date , presented in @xcite and further explored in @xcite , @xcite and @xcite .",
    "this used the results in section  [ sub : atomhalo ] to include the unresolved low - mass atomic cooling haloes ( @xmath11 ) .",
    "another prospective application is in exploring the effects of primordial non - gaussianity on halo bias , which is an active area of research ( e.g. @xcite ; @xcite ; @xcite ) , and which also leads to ionization bias ( e.g. @xcite ) detectable by 21 cm observations ( e.g. @xcite ) .    in this paper",
    ", we examine and compare the nonlinear halo bias from both our suite of cosmological n - body simulations suited for the study of haloes responsible for eor and a semi - analytical , fully nonlinear peak - background split scheme .",
    "this theoretical scheme is a hybrid scheme similar to the one by bl , but also differ as we combine the empirical ( mean ) halo mass function to the bias factor and extend it to the fully nonlinear regime in a non - perturbative way . through this , we investigate whether the bias factor can be purely based upon the excursion set formalism and separated cleanly from the mass function , which bears uncertainty due to its strong dependence on specific halo - identification schemes .",
    "we also study the stochasticity of halo bias from these simulations and examine whether they are purely poissonian or not , which has been investigated recently to conclude that haloes in some mass range indeed have super - poissonian distribution @xcite . toward this , we calculate the 2-point halo correlation function and quantify its contribution to stochasticity in addition to the poisson noise . while our paper is focused on the range of haloes responsible for cosmic reionization at @xmath12 , and therefore it can be used readily in the study of eor , our formalism should be applicable in more generic cases .",
    "this paper is organized as follows . in section  [ sec : nbody ] , we briefly describe our n - body simulation . in section  [ sec : theory ] , we describe the theoretical scheme for the nonlinear halo bias , which combines the peak - background split scheme ( sections [ sub : bias - linear ] and [ sub : bias - nl ] ) with the empirical n - body halo mass function ( section  [ sub : bias_and_hybrid_mass_function ] ) , and also describe the stochasticity and various quantities related ( [ sub : statistics ] ) .",
    "we then describe our results in section  [ sec : result ] , first on the mean halo mass function ( section  [ sub : result : halo - mass - function ] ) , then on the mean bias ( section  [ sub : result : mean ] ) and on the stochasticity ( section  [ sub : result : scatter ] ) .",
    "we further investigate the validity of the usual linear bias approximation in section  [ sub : validity - of - linear ] .",
    "we conclude our paper in section  [ sec : conclusion ] , together with a schematic layout of our bias prescription toward generating mock halo catalogues .",
    "the data used in this work is based on a suite of large simulations , most of which were previously presented in @xcite .",
    "they were performed using the cubep@xmath13 m code , a high - performance , publicly available , cosmological n - body code based on particle - particle - particle - mesh ( p@xmath13 m ) scheme ( for detailed code description and tests see @xcite ) . for memory efficiency and",
    "speed the code uses two - level grid for computing the long - range gravity forces using a particle - mesh method and adds the local direct particle - particle forces at small scales .",
    "cubep@xmath13 m is a massively parallel , hybrid ( using mpi and openmp ) code , scaling well up to tens of thousands of computing cores .",
    "it has been extensively tested and run on a wide variety of parallel platforms .",
    "our complete simulation suite , listed in table  [ summary_n - body_table ] , includes volumes between @xmath14mpc and @xmath15mpc per side and between @xmath16 and @xmath17 particles , thereby covering a large dynamic range , with particle masses ranging from @xmath18 to @xmath19 and force smoothing lengths between @xmath20pc and @xmath21kpc . the smaller - volume , high - resolution simulations with boxes up to @xmath22mpc per side resolve ( with 20 particles or more ) dark matter haloes with mass @xmath23 and above , the expected hosts of the first stars .",
    "in contrast , the larger volume , @xmath15mpc only resolves haloes with mass @xmath24 ( with 20 particles ) and larger , but samples the statistics of rare haloes much better due to its larger volume .",
    "we locate the collapsed haloes at runtime , using the cpmso spherical overdensity method @xcite with overdensity with respect to the mean of 178 , suitable for the high redshifts considered here .",
    "this is done by first interpolating the particles onto a fine grid ( with number of cells per dimension twice the number of particles ) using the cloud - in - cell ( cic ) approximation . local density peaks ( with density at least 100 times the average )",
    "are located and spherical shells are expanded around each peak until the threshold overdensity is crossed .",
    "the resulting object is then marked as a halo ( objects with less than 20 particles are discarded as they can not be reliably identified ) .",
    "the halo centre position is calculated more precisely by quadratic interpolation within the cell and the particles within the halo virial radius are identified and then the halo properties , e.g. mass , velocity dispersion , centre - of - mass , angular momentum , radius , etc . are calculated and saved in the halo catalogue .    [",
    "cols=\"<,<,<,<,<,<,<\",options=\"header \" , ]",
    "formation of cosmological haloes is strongly correlated with their larger - scale density environment . the excursion set formalism ( @xcite )",
    "gives a quantitative description of this biased halo formation in terms of the conditional halo mass function @xmath25 , where @xmath26 is the overdensity of the local environment .",
    "this description is called the peak - background split , where haloes are considered as the high - density `` peaks '' that are placed on large - scale density `` background '' . in the linear regime where @xmath27 , this yields the linear bias parameter which has been used extensively in cosmology ( mw ) .    in this section",
    "we introduce a formalism which is intended to describe the local nonlinear bias in a non - perturbative way , based mostly on the formalism by mw and the idea of bl .",
    "therefore , we revisit previous theoretical work , and at the same time describe modifications we made in this section .",
    "we will then compare the prediction from this formalism to the n - body data results in section [ sec : result ] .",
    "we will occasionally add subscript `` @xmath28 '' to lagrangian quantities , when otherwise these may be confused with eulerian ones .",
    "it is shown in the excursion set formalism that distribution of linear overdensity @xmath2 in the initially gaussian - random matter density field @xmath29 filtered with a `` sharp @xmath30-space filter '' ,    @xmath31    where the window function @xmath32 is the fourier transform of sharp @xmath30-space filter @xmath33 , still follows gaussian distribution ( @xcite ) .",
    "this is obviously true even in the density field linearly extrapolated to the observing redshift with the linear growing factor .",
    "this way , one can use the linearly extrapolated density field and the appropriate halo collapse criterion to predict halo population at any filter scale and redshift .    in this formalism the unconditional , globally - averaged differential halo number density ( mass function ) is given by the press - schechter formula ( @xcite ) @xmath34 , \\label{eq : ps}\\end{aligned}\\ ] ] where @xmath35 is the variance of gaussian distribution of the density field ( linearly extrapolated to the present ) filtered in real space in spheres with radius @xmath36 , @xmath37 is the present matter density , @xmath38 ( with the linear growth factor @xmath39 in @xmath40cdm universe ) is the ratio of critical overdensity @xmath41 in @xmath40cdm in our study , while for @xmath42 one should implement its redshift dependence . ] to @xmath43 , and @xmath36 is the length scale usually associated with @xmath36 in the case of sharp-@xmath30 filtering ( e.g. @xcite ) .",
    "however , we adopt this definition for simplicity . ] with the halo mass @xmath44 by @xmath45 equation ( [ eq : ps ] ) is unconditional in a sense that this represents the average halo distribution in the universe .",
    "the excursion set formalism also predicts halo population inside a region with given mean overdensity and size .",
    "sharp @xmath30-space filtering allows one to write this in terms of conditional probability analytically , because wavemodes at different filter scales are linearly independent .",
    "the barrier crossing and variance under given density environment , which will be denoted by a `` cell '' , is measured from the new origin @xmath46 ( throughout this paper , unless specified differently , we denote the full , nonlinear overdensity of a cell by @xmath2 for simplicity ) and @xmath47 , which are linearly extrapolated density of the cell and variance corresponding to the lagrangian cell size @xmath48 , respectively .",
    "when an eulerian cell has a comoving volume @xmath49 and nonlinear overdensity @xmath2 at some redshift , @xmath48 can be obtained from @xmath50 according to the well - known excursion - set formalism ( @xcite ) , the differential halo number density ( halo mass function ) inside a lagrangian region with @xmath46 ( linearly extrapolated to redshift @xmath51 ) and @xmath48 is then given by a conditional mass function @xmath52 \\label{eq : ps - bias}\\end{aligned}\\ ] ] which takes the same form as equation ( [ eq : ps ] ) but with @xmath35 and @xmath53 replaced by @xmath54 and @xmath55 , respectively . here , @xmath56 .",
    "this defines the lagrangian over - abundance of haloes of mass m , @xmath57    note that two important factors should be considered in order to generalize equation ( [ eq : ps - bias ] ) . first , in the nonlinear regime where @xmath58",
    ", one should match the nonlinear @xmath2 to the linear @xmath46 to use equation ( [ eq : ps - bias ] ) , because this is based on the linear theory .",
    "second,@xmath59 and @xmath60 should be converted into the corresponding eulerian mass function and eulerian halo over - abundance , respectively , because eulerian quantities are of much more practical use than lagrangian quantities .",
    "this conversion will be described in section [ sub : bias - nl ] .",
    "the quantities @xmath59 and @xmath60 in equations ( [ eq : ps - bias ] ) and ( [ eq : deltah_lagrangian ] ) are derived assuming that density grows linearly with the linear growth factor and are defined in the lagrangian volume . in reality ,",
    "growth of density perturbations is nonlinear in general , and this also yields large difference between the lagrangian and eulerian volumes .    therefore , we first need to map nonlinear overdensity @xmath2 to linear overdensity @xmath46 .",
    "we use the mapping scheme based on the tophat collapse model , which has also been used by mw , where @xmath2 , which is nonlinear in general , is linked to @xmath46 in a parametric form of @xmath61 as follows : @xmath62 if @xmath63 . similarly , if @xmath64 , @xmath65 note that @xmath2 increases monotonically as @xmath46 increases , such that there exists one - to - one mapping .",
    "we also need to consider the change of lagrangian volume by multiplying the ratio of lagrangian volume to the eulerian volume to obtain the correct eulerian number density , which yields the final form : @xmath66 by taking further approximation that @xmath67 and @xmath68 mw find a useful linear relation between @xmath69 and @xmath70 .",
    "this approximation implies that total mass contained in haloes inside a cell is much smaller than the total mass of the cell .",
    "however , this approximation is not always valid at high resolution because some cells in our density field , depending on the choice of the cell - size , may achieve very high overdensity @xmath70 such that @xmath71 and @xmath72 .",
    "therefore , we just use equation  ( [ eq : nl_lin_dndm ] ) in its general form , which allows for nonlinear relation between @xmath69 and @xmath70 .      before proceeding ,",
    "let us define the mean conditional bias function @xmath73 ( mw ; dl ) : @xmath74 where @xmath75 is the conditional , eulerian halo over - abundance , and the seemingly repetitive definition of the average is to clarify the fact that the average is taken _ only _ over the cells with the given @xmath2 , following the notation from equations ( 3 ) and ( 4 ) of dl , which is different from the average over all cells regardless of @xmath2 , or @xmath76 .",
    "this average takes the following integral form for any conditional function of @xmath69 under a given @xmath2 , @xmath77 : @xmath78\\equiv\\left\\langle f(\\delta_{{\\rm h}}|\\delta)\\right\\rangle _ { \\delta_{{\\rm h}}|\\delta}\\equiv\\int d\\delta_{{\\rm h}}p(\\delta_{{\\rm h}}|\\delta)f(\\delta_{{\\rm h}}),\\label{eq : bias_dl}\\ ] ] where @xmath79 is the conditional probability for a cell with @xmath2 to have @xmath69 as the halo over - abundance inside it ( dl ) , and only those cells with given @xmath2 are included in the integration . to distinguish the _ conditional _ averaging from the normal averaging @xmath80",
    ", we denote the former by a simple notation , @xmath81 $ ] , in which the dependence on @xmath2 is assumed implicitly .",
    "equation  ( [ eq : bias_dl ] ) is equivalent to equation  ( 5 ) in dl .",
    "equations ( [ eq : ps ] ) , ( [ eq : ps - bias ] ) and ( [ eq : nl_lin_dndm ] ) naturally determine by how much the local halo mass function is modified .",
    "the eulerian over - abundance of haloes is then given by @xmath82=\\frac{\\left(\\frac{dn}{dm}\\right)_{{\\rm ps},\\ , b}(m|\\delta)}{\\left(\\frac{dn}{dm}\\right)_{{\\rm ps}}(m)}-1 \\nonumber \\\\ & & = \\frac{\\left(\\frac{dn}{dm}\\right)_{{\\rm ps}}(\\sigma_{m , l}^{2};\\,\\delta_{c}|\\sigma_{{\\rm cell},l}^{2};\\,\\delta_{lin})}{\\left(\\frac{dn}{dm}\\right)_{{\\rm ps}}(\\sigma_{m , l}^{2};\\delta_{c})}(1+\\delta)-1 , \\label{eq : boost}\\end{aligned}\\ ] ] which is equivalent to equation ( 19 ) of mw .",
    "the bias function @xmath83 becomes independent of @xmath2 in the linear regime where @xmath84 and @xmath85 , and is given as a function of @xmath86 alone , at any given @xmath51 : @xmath87 ( mw ) .",
    "@xmath88 is referred to as the linear bias parameter .",
    "we will test the applicability of this approximation in   [ sub : result : mean ] and [ sub : validity - of - linear ] .",
    "the relation between @xmath69 and @xmath2 is generally nonlinear , and therefore equation ( [ eq : bias_linear ] ) is of limited use for our purposes . even in the linear regime where @xmath89 , using equation ( [ eq : bias_linear ] ) may be problematic because the other condition @xmath90 is not valid in general and then the exponential term in equation  ( [ eq : ps - bias ] ) can not be approximated further .",
    "for example , for minihaloes of @xmath91 , we have @xmath92 , while cells we study here have masses ( when @xmath93 ) as low as @xmath94 ( in both @xmath95 and @xmath96 boxes ) , which corresponds to @xmath97",
    ".    one may naively expect that @xmath98 gives the correct analytical estimate for the biased halo mass function .",
    "however , it is well known that the unconditional ps mass function , @xmath99 , is a poor fit to the empirical halo mass function derived from n - body simulations , in general , depending on the range of mass  especially so for rare haloes  and redshift ( e.g. @xcite ) .",
    "it is thus reasonable to expect that @xmath98 will also become a poor fit to the biased n - body halo mass function .",
    "we therefore adopt a hybrid approach , first introduced by @xcite , to predict the conditional mass function ( or bias ) by combining @xmath100 ( or equivalently @xmath73 ) as in equation ( [ eq : boost ] ) , derived from the excursion set formalism , with the unconditional mass function @xmath101 , which we choose independently .",
    "this approach is somewhat advantageous over @xcite and ps , for example , because @xmath100 or @xmath73 is almost independent of how haloes are identified ( mw ) and thus the unconditional mass function can be found empirically for any arbitrarily identified n - body haloes .",
    "we can then expect that when such an empirical mass function @xmath101 is combined with equation ( [ eq : boost ] ) , the resulting mass function may be a better fit to the actual biased halo mass function @xmath102 .",
    "in contrast to @xcite , who choose the well - known ps and sheth - tormen ( st ) mass functions , we choose three mass functions : ps , st and the empirical fit to our n - body data .",
    "the reason for using the empirical ( unconditional ) mass function is because ( 1 ) both ps and st mass functions are known to be poor - fits to very rare haloes ( see discussion in @xcite and references therein ) and for the redshift and halo mass range of interest here all haloes are rare and ( 2 ) we want a prescription which is independent of the systematic uncertainties of the unconditional mass function due to the varying halo - identification schemes .",
    "the conditional ps bias trivially reduces to @xmath98 , while in the other two cases , the unconditional st @xmath103 and the empirical fit @xmath104 are both simply multiplied by @xmath105 to produce @xmath106 and @xmath107 where @xmath100 is given by equation ( [ eq : boost ] ) .",
    "it is important to note that even when @xmath93 , @xmath108 in general . in order to illustrate this ,",
    "let us consider the limiting case of very rare haloes such that @xmath109 .",
    "such haloes will most likely form at very high - density regions  or more explicitly , high - density cells with some fixed eulerian volume  with @xmath110 . in this case ,",
    "@xmath111 or @xmath112 as @xmath113 , and thus a simple linear relation @xmath114 , which yields @xmath115 as @xmath113 , inevitably fails in estimating the bias correctly even in the linear regime .",
    "more detailed discussion of this aspect is in section  [ sub : validity - of - linear ] .",
    "finally , the fraction of halo - mass to cell - mass , or the collapsed fraction , is given by @xmath116 which is naturally expressed in lagrangian quantities , because both masses inhabit the same lagrangian region .",
    "here once again , @xmath102 can be based on either the ps mass function , the st mass function or the empirical fit to simulations .",
    "we have so far described the mean conditional mass function . in reality",
    ", the observed correlation should exhibit stochasticity as well , because structure forms out of a random density field .",
    "in addition , when haloes of our interest are rare , not all the cells with given @xmath2 will contain such haloes , giving rise to poisson fluctuations .",
    "however , we will soon see that the stochasticity should differ from pure poissonian distribution .",
    "here we consider only the local stochasticity and postpone the analysis of multi - point correlation and corresponding statistics to a future paper .",
    "because the conditional mass function has a stochastic element , the total number of haloes inside cells with given overdensity @xmath2 and eulerian volume @xmath49 would show a scatter around the mean value .",
    "for the total number of haloes in a mass bin @xmath117 $ ] , @xmath118 over different cells with the same @xmath49 and @xmath2 and where @xmath119 is the observed halo mass function inside each cell , one would naively expect that the probability distribution function ( pdf ) of @xmath120 will obey the poisson statistics : @xmath121}\\left[n\\right]^{n}}{n!},\\label{eq : pdf_n}\\ ] ] where the average is again taken only over the cells with given @xmath2 such that @xmath122=\\left\\langle n\\right\\rangle _ { \\delta_{{\\rm h}}|\\delta}=\\left\\langle n(m_{{\\rm min}},\\ , m_{{\\rm max}}|\\delta,\\ , v_{{\\rm cell}})\\right\\rangle _ { \\delta_{{\\rm h}}|\\delta}$ ] .",
    "if so , both the conditional mean and conditional variance of @xmath120 would become identical to @xmath122 $ ] .",
    "however , if correlation of haloes at sub - cell length scale exists , there occurs an additional variance  either positive or negative  in @xmath120 ( @xcite ; dl ) : @xmath123}{v_{{\\rm        cell}}}\\right)^{2}\\int^{v_{{\\rm        cell}}}dv_{1}dv_{2}\\,\\overline{\\xi_{12}}(\\delta ) , \\label{eq : scc}\\ ] ] where `` scc '' denotes sub - cell correlation such that the integration is taken inside a cell and the _ conditional _ sub - cell 2-point correlation function @xmath124 is defined by @xmath125=\\left(\\frac{\\left[n\\right]}{v_{{\\rm cell}}}\\right)^{2}dv_{1}dv_{2}\\,\\left\\ { 1+\\overline{\\xi_{12}}(\\delta)\\right\\ } , \\label{eq : con_correl_definition}\\ ] ] where 1 and 2 denote two different sub - cell positions inside the same cell and @xmath126 and @xmath127 are number of haloes in each sub - cell .",
    "@xmath124 should not be confused with the global sub - cell correlation function @xmath128 , defined by@xmath129 note that equation ( [ eq : scc ] ) and ( [ eq : con_correl_definition ] ) are restricted only to cells with given @xmath2 , which are direct applications of equations ( 7.66 ) and ( 7.63 ) in @xcite , respectively . while these equations were originally intended for unconditional quantities in @xcite , applying these to conditional quantities is trivially achieved by replacing the global average @xmath130 with the conditional average @xmath131 $ ] .",
    "this is easily justified by the fact that when there is no sub - cell correlation in those cells with @xmath2 , or when @xmath132 , the identity @xmath133=[n_{1}][n_{2}]=[n]dv_{1}/v_{\\rm cell}\\,[n]dv_{2}/v_{\\rm    cell}$ ] is satisfied by equation ( [ eq : con_correl_definition ] ) .",
    "the net variance is therefore given as @xmath134\\right)^{2}\\right]=\\left[n\\right]+\\delta_{{\\rm scc}}(\\delta),\\label{eq : all_variance}\\ ] ] which is again an application of equation ( 7.66 ) in @xcite to the conditional cases we consider .",
    "this also suggests that the true pdf deviates from the pure poisson statistics , and the super - poissonian pdf suggested by @xcite , given by @xmath135}{n!}e^{-\\left[n\\right](1-\\beta)-n\\beta}(1-\\beta)\\left([n](1-\\beta)+n\\beta\\right)^{n-1 } , \\label{eq : pdf_superpoi}\\ ] ] shows excellent agreement with e.g. the distribution of n - body haloes of @xmath136 ( @xcite ) . here",
    "@xmath137}$ ] represents the degree of super - poissonianity .",
    "sometimes , we may only be interested in those cells that contain at least one halo .",
    "quantifying this might be useful when haloes are rare , such that not all the cells with given @xmath2 are occupied by these haloes .",
    "it is therefore useful to have the conditional probability that there are @xmath120 haloes in the cell ( with @xmath2 and @xmath49 ) once a halo is found in that cell ( let us denote these cells by `` active cells '' ) .",
    "this requires re - normalizing the pdf@xmath138(1-\\beta ) } } , \\label{eq : concon_pdf_n}\\end{aligned}\\ ] ] where in the last equality we used equation ( [ eq : pdf_superpoi ] ) .",
    "the mean value of @xmath120 inside `` active '' cells will then be given by @xmath139_{a}\\equiv\\sum_{n=1}^{\\infty}np_{{\\rm      cell}}(n|n\\ge1)=\\frac{\\left[n\\right]}{1-e^{-\\left[n\\right](1-\\beta ) } } , \\label{eq : mean_pdf}\\ ] ] which should be used as the estimator of the mean value .",
    "two limiting cases are noteworthy .",
    "first , when @xmath122\\ll1 $ ] , @xmath140 can be approximated as @xmath141 which is no longer dependent on @xmath142 $ ] . in the other extreme , @xmath142\\gg1 $ ] , @xmath143 .",
    "similarly , we use the same renormalization to determine the collapsed fraction inside active cells : @xmath144_{a}=\\frac{\\left[f_{c}(\\delta)\\right]}{1-e^{-[n](1-\\beta)}}.\\label{eq : concon_fcoll}\\ ] ] when @xmath122\\ll1 $ ] , as the mass function is biased toward the least massive haloes , @xmath145_{a}\\simeq m_{{\\rm min}}/m_{{\\rm cell}}=m_{{\\rm min}}\\rho_{0}^{-1}v_{{\\rm cell}}^{-1}(1+\\delta)^{-1}$ ] .",
    "when @xmath122\\gg1 $ ] , @xmath145_{a}$ ] trivially converges to @xmath145 $ ] .",
    "note that @xmath122 $ ] can be smaller than 1 .",
    "this does not mean that we will find a fractional , less - than - unity number of haloes on average , which is simply unphysical .",
    "this means instead , assuming ergodicity , that @xmath146&=&\\frac{{\\rm total\\ , number\\ , of\\ , haloes\\ , found\\ , in\\ , all\\ ,      cells\\ , with\\ , \\delta}}{{\\rm total\\ , number\\ , of\\ , cells\\ , with\\ ,      \\delta } } \\nonumber \\\\ & \\approx&\\frac{{\\rm number\\ , of\\ , active\\ , cells\\ , with\\ ,      \\delta}}{{\\rm total\\ , number\\ , of\\ , cells\\ , with\\ , \\delta } } , \\label{eq : meaning_smalln}\\end{aligned}\\ ] ] where the approximation is made possible due to the fact that when @xmath122\\ll1 $ ] , the pdf @xmath140 is peaked at @xmath147 .",
    "the mean , unconditional halo mass functions at both high and low redshifts were recently discussed in detail in @xcite , much of it based on the same simulations as the current work .",
    "therefore , we will only summarize a selection of the mean mass function properties that are most relevant here .    in fig .",
    "[ fig : meanmf ] we show the mass functions in the mass range @xmath91 at selected redshifts based on the @xmath148 and @xmath149 simulations , together with ps and st analytical mass functions .",
    "the actual quantities plotted are halo number densities @xmath150 , integrated over equal - size logarithmic mass bins .",
    "the last mass bin includes all haloes with mass @xmath151 .",
    "the two simulated mass functions show excellent agreement with each other , except for the high mass end , where the mass function is truncated due to finite volume .",
    "this agreement indicates the consistency of the n - body simulation over varying box size .",
    "compared to the analytical expressions , our n - body mass functions are in better agreement with st than ps mass functions .",
    "the agreement with st at all redshifts is within @xmath152 for @xmath153\\ , m_{\\odot}$ ] , the haloes in which range numerically dominate the minihalo population . at very high redshifts , @xmath154 , st mass function slightly over - predicts halo population at @xmath155\\ , m_{\\odot}$ ] and under - predicts halo abundance at @xmath156 , with tendency to deviate increasingly as @xmath44 increases , while at relatively low redshifts , over - prediction occurs at @xmath157\\ , m_{\\odot}$ ] . as discussed in @xcite",
    "these differences are partly due to our usage of a halo finder based on spherical overdensity instead of the friends - of - friends one used by st , and also to the limitations of the st fit which was based on low - redshift data and relatively small simulations .",
    "in contrast , the classical ps mass function gives a poor fit to n - body minihalo data at all redshifts , severely under - predicting the abundance of rare ( @xmath158 ) haloes and over - predicting the abundance of @xmath159 haloes . only for the most common ( @xmath160 )",
    "haloes ps is a more reasonable approximation ( and also agrees with st ) .    assuming that the prescription for the conditional mass function ( linking eq .",
    "[ eq : boost ] with unconditional mass function ) provides a correct theoretical framework , one may expect that a good fit to unconditional mass function will also provide a good fit to conditional mass function when combined with eq .",
    "( [ eq : boost ] ) .",
    "therefore , we can expect that @xmath161 will be the best fit to the mean conditional mass function from the simulations , and @xmath162 will also be a good fit , while @xmath98 will be a poor fit .",
    "we will test this expectation in section [ sub : result : mean ] .",
    "we now show how the mean , conditional mass functions of n - body haloes behave in terms of @xmath2 , and compare this to the modelling predictions based on the different mass functions , @xmath98 , @xmath162 and @xmath161 .",
    "we also compare these to the model based on the linear bias .",
    "the stochasticity in this relation will be treated in ",
    "[ sub : result : scatter ] .",
    "minihaloes are usually defined by their hydrodynamical properties .",
    "their minimum mass is the cosmic jeans mass determined by the mean igm temperature , and their maximum mass is the mass of haloes whose virial temperature is about @xmath163 .",
    "while this is the general definition , the uncertainty of the mean igm temperature at high redshift makes the definition of the minimum mass somewhat uncertain . in this work",
    "we instead take their mass to be in a fixed range @xmath164\\ , m_{\\odot}$ ] , which is of more direct use to n - body data at fixed mass resolution .",
    "both @xmath149 and @xmath165 boxes resolve haloes down to @xmath166 . the latter simulation",
    "thus provides a better statistics by encompassing a volume 32 times as large as that of the former one .",
    "we first examine how well the models based on the analytical mass function fits match the n - body data .",
    "figs  [ fig : meannumber - mini-6.3 - 14 ] and [ fig : meannumber - mini-6.3 - 44 ] show the analytical estimates and n - body data on the total number of minihaloes @xmath167_{a}$ ] under different eulerian cell sizes .",
    "we find that the numerical data from the two simulation volumes is in excellent agreement and that@xmath162 and @xmath161 fit the n - body data well over almost the entire range of @xmath2 and @xmath51 , while @xmath168 and the linear relation @xmath169 both provide poor fits to the data in general .",
    "even though @xmath167_{a}$ ] and @xmath170_{a}$ ] are integral quantities , given that smallest - mass haloes numerically dominate the halo population , both the data and semi - analytical estimates reflect predominantly the low - mass end .",
    "note that as seen in fig .",
    "[ fig : meanmf ] , @xmath171 agrees well with @xmath172 in the low mass - end , and this is the reason why @xmath162 provides a good fit .",
    "if we focused on the high - mass end only , @xmath162 would be a very poor fit to the observed bias , because the average st mass function @xmath173 has large discrepancy from the actual n - body data for e.g. @xmath174 .",
    "in contrast , the collapsed fraction in haloes @xmath170_{a}$ ] ( figs  1 and 2 of the supplementary material ) is a mass - weighted quantity and thus reflects the high mass end better than does @xmath167_{a}$ ] , but the rapid exponential cutoff of the mean halo mass function @xmath101 at increasing @xmath44 still moderates the contribution from the high - mass haloes .",
    "the similarity between @xmath162 and @xmath161 reflect the simple fact that the unconditional mass functions , @xmath103 and @xmath104 , are similar around the low - mass end .",
    "as the cell size shrinks , however , some discrepancy appears at high @xmath2 regime .",
    "both @xmath162 and @xmath161 predictions overestimate the n - body data substantially at @xmath175 , when the volume of the cell has shrunken from @xmath176 to @xmath177 : see fig .  [",
    "fig : meannumber - mini-6.3 - 44 ] at this point , where @xmath2 approaches the overdensity criterion for halo identification , we suspect that this could be a symptom of extreme nonlinearity : the mean mass of the cell , @xmath178 , is small enough to be comparable to the high - mass end of minihaloes , or @xmath179 .    in summary ,",
    "unless the cell is too small , and thus potentially quite nonlinear , the mean nonlinear bias of n - body minihaloes at high redshifts can be explained well by the simple hybrid prescriptions @xmath161 and @xmath162 .",
    "in contrast , at high redshifts , the linear relation @xmath114 deviates too much from the n - body minihalo data to be of much practical use at least under the filtering scales of @xmath180 .",
    "the disagreement of @xmath168 with the n - body data is just as severe , and we expect that @xmath168 will be useless regardless of the filtering scale , because the disagreement is caused by the poorness of the mean ps mass function . it is notable that the rarity of haloes at high redshifts make the linear relation fail even when @xmath89 , which will be discussed in much detail in section [ sub : validity - of - linear ] .",
    "atomically - cooling haloes ( ach hereafter ) are named after the dominant cooling mechanism of baryonic gas inside .",
    "atomic line radiation can cool primordial - composition gas to @xmath181 from its initially higher virial temperature .",
    "star formation are believed to occur inside these haloes as pre - existing metals or newly - formed @xmath182 can further cool the gas down to @xmath183 .",
    "therefore , achs are usually defined by their virial temperature : haloes with @xmath184 . as",
    "this threshold virial temperature roughly coincides with @xmath185 , here we define achs as those haloes with @xmath186 .",
    "the achs can be grouped further into low - mass achs ( lmach ) , for which the gas pressure of the photoheated igm in an ionized patch prevented the halo from capturing the gas it needs to form stars , and high - mass achs ( hmach ) , for which gravity was strong enough to overcome this `` jeans - mass filter '' and form stars even in the ionized patches .",
    "the dividing line between lmachs and hmachs occurred roughly at @xmath187 ( although the precise boundary value is still uncertain ) .",
    "as our @xmath8 box simulation resolves haloes of @xmath186 , achs defined as above are fully identified . even though the inner structure of low - mass end haloes is not resolved near the resolution limit ( see section [ sec : nbody ] ) , for our considerations only the number count of haloes matters , both for the mean halo bias and stochasticity and   [ sub : result : scatter ] , the conditional halo correlation function determines the stochasticity .",
    "the halo correlation function is composed of the 1-halo term and the 2-halo term , and the dominant contribution to stochasticity comes from the 2-halo term .",
    "therefore , it is not required to fully resolve the halo structure in estimating the stochasticity . ] and therefore our results are not affected by this .",
    "we choose two filtering scales , @xmath188 and @xmath189 . while these choices are somewhat arbitrary , we increased the filtering scales for achs from those for minihaloes , due to the increased rarity of achs .",
    "the halo collapsed fraction is plotted in figs [ fig : meanfcoll - lmach-114 - 64 ] and [ fig : meanfcoll - hmach-114 - 64 ] . while lmachs have a finite range in mass , because hmachs are defined to have a loose end , we assign their maximum mass as the one somewhat smaller than the mass of the average - density cell : @xmath190 and @xmath191 for cells with @xmath192 and @xmath193 , respectively .",
    "otherwise , the bias formalism breaks down ( equation  [ eq : ps - bias ] ) .",
    "overall , the mean values of both the lmach collapsed fraction ( @xmath194_{a}$ ] ) , and the hmach collapsed fraction ( @xmath195_{a}$ ] and @xmath196_{a}$ ] ) are well predicted by equation  ( [ eq : fcoll_bias ] ) when we adopt @xmath197 ( equation [ eq : nbody - bias ] ) . for lmachs",
    ", @xmath198 provides as good a fit as @xmath197 , except at @xmath199 where st prescription somewhat overestimates the mean . for hmachs ,",
    "the biggest discrepancy between @xmath198 and @xmath197 exist at higher redshifts ( e.g. @xmath200 ) at @xmath201 : here the small number of sampled cells at high cell - density makes it difficult to conclude which prescription provides a better estimator for the mean bias .",
    "ps prescription provides a very poor fit at all redshifts .",
    "the linear bias parameter , for both lmachs and hmachs , fails in predicting the mean bias in general .",
    "this is noteworthy because even in the linear regime , including the point @xmath93 , the linear bias parameter predicts the bias to be off from the observed values , which was also the case for minihaloes .",
    "we discuss this issue in detail in section [ sub : validity - of - linear ] .    in summary ,",
    "even though lmachs and hmachs are very rare in the regime we study , the nonlinear bias prescription combined with the mean n - body halo mass function fits the observed mean halo bias very well throughout the ranges of redshift and cell density we observe .",
    "therefore , this hybrid bias prescription can be applied for astrophysical and cosmological applications in general .",
    "we have indeed applied the bias prescription from this work in simulating cosmic reionization by achs in a very large box , @xmath10 , in order to populate eulerian cells with size @xmath202 @xcite .",
    "because the halo mass resolution of the corresponding n - body simulation was only @xmath203 , we assigned each cell the missing lmachs using the mean conditional mass function @xmath161 , where the lmach mean mass function from our @xmath8 simulation was used to generate @xmath161 .",
    "the average behaviour of conditional mass function is well understood in terms of the biased mass function @xmath161 .",
    "now , how does the scatter of correlation around the mean compare to the expected stochasticity ?",
    "we showed in section [ sub : statistics ] that the variance of the number of haloes @xmath120 and given @xmath2 deviate from the simple poisson value @xmath122 $ ] by the amount @xmath204 .",
    "we now show the result of simulation and compare this to the poisson statistics ( equation  [ eq : concon_pdf_n ] ) and @xmath205 ( equation  [ eq : scc ] ) by explicitly calculating the sub - cell - scale correlation function ( equation [ eq : con_correl_definition ] ) .    in fig  [ fig : pdfmhcoarse ]",
    "( see also figs  59 in supplementary material ) we show the actual pdf and compare it to the expected poisson distribution .",
    "we find that the empirical pdf does not follow pure poisson distribution in general : the observed pdfs usually show large outliers compared to the poisson distribution , and there is no convincing case with variance _ smaller _ than the poissonian even though such a case is possible if haloes are anti - correlated under given density environment ( equations  [ eq : scc][eq : all_variance ] ) .",
    "for example , fig .",
    "[ fig : pdfmhcoarse ] shows pdfs of minihalo population inside the @xmath206 mpc box at different redshifts and @xmath2 s . in order to get the distribution ,",
    "each chosen @xmath2 has some width @xmath207 such that cells are chosen if their overdensity lies inside @xmath208 $ ] .",
    "@xmath207 is taken to be narrow enough to guarantee that the pdf in each bin is a fair representation of the true pdf , while at the same time wide enough to generate a large number of cells for statistically reliable measure of the variance .",
    "we also quantify the relative contribution of @xmath209 to @xmath210 by the ratio @xmath211 $ ] ( note that it is compared not to @xmath122_{a}$ ] but @xmath122 $ ] ) , in order to see the degree of deviation of pdf from the pure poisson distribution .",
    "there are several notable features in @xmath211 $ ] : ( 1 ) at a given redshift , the ratio @xmath211 $ ] decreases as mass of haloes increases , and thus lmachs and hmachs show much weaker outliers progressively .",
    "[ fig : pdfmhcoarse ] and figs  59 in supplementary material show this trend : mhs have @xmath211\\simeq[0,\\,30]$ ] , lmachs have @xmath211\\simeq[0,\\,6]$ ] , and hmachs have @xmath211\\simeq[0,\\,2]$ ] ; ( 2 ) as one increases the filtering scale  or the size of cells  @xmath211 $ ] tends to decrease overall .",
    "we nevertheless have some exceptions in this trend for mhs at very high - density cells ( @xmath212 ) ; ( 3 ) @xmath211 $ ] is not a monotonically increasing or decreasing function of @xmath2 ; and ( 4 ) @xmath209 is mostly positive both in underdense and overdense cells , indicating that the sub - cell correlation is overall positive in both regimes ( see equation  [ eq : con_correl_definition ] ; this does not mean that there is no negative values in @xmath124 ) .",
    "this contradicts the claim by @xcite , where they usually find that @xmath213 in underdense regions and @xmath214 in positive regions which led them to conclude that the correlation function is negative inside underdense regions and positive in overdense regions .",
    "we believe that this discrepancy comes from the erroneous definition of @xmath209 in @xcite , where they subtracted the global mean number of haloes @xmath215 averaged over all cells of @xmath2 such that @xmath216 , while one should indeed define this as in equation  [ eq : all_variance ] to reflect the effect of the sub - cell correlation function .",
    "the observed anti - correlation of @xmath124 , or negative values of @xmath124 when @xmath217 becomes comparable to the cell size as seen in fig .",
    "[ fig : corr_mh45 ] ( see also figs  1014 in supplementary material ) , is due to the finite cell size , because any correlation existing inside a cell should be counter - balanced by anti - correlation in order to conserve the halo number .",
    "we explicitly calculate @xmath124 defined by equation ( [ eq : con_correl_definition ] ) and @xmath204 from equation ( [ eq : scc ] ) . toward this , we place a uniform grid with @xmath218 sub - cells on each cell with @xmath2 , such that @xmath219 .",
    "we then sample all sub - cell pairs with given distance @xmath220  discretized as the distance between centres of sub - cells  and calculate @xmath124 using equation ( [ eq : con_correl_definition ] ) and @xmath221 using equation ( [ eq : scc ] ) we compare this value to the observed , residual variance @xmath222 $ ] , which are shown in the bottom panels of fig .",
    "[ fig : pdfmhcoarse ] , denoted by @xmath223 and @xmath224 respectively .",
    "the agreement between the two quantities are excellent , and thus proves the fact that @xmath124 is the sole origin for the super - poissonian ( or sometimes sub - poissonian ) variance in @xmath225 ( see also figs  59 in supplementary material ) . due to halo - number conservation , the correlation function is composed of positive ( correlation ) and negative ( anti - correlation ) parts as seen in fig .",
    "[ fig : corr_mh45 ] ( and figs  1014 in supplementary material ) .",
    "local halo bias is often calculated or fitted in perturbative way , i.e. as a polynomial series of @xmath2 : @xmath226 where the bias parameter @xmath227 is now defined as an @xmath228th - order moment in this expansion . in practice",
    ", one should truncate the series by limiting @xmath229 such that higher order moments decay more rapidly than a few lowest - order moments . in this section , we re - visit the perturbative scheme by mw and examine @xmath227 in more detail .",
    "linear bias approximation , @xmath114 , is widely used in literature and in practical applications such as galaxy surveys for cosmology . here",
    ", the linear bias parameter @xmath88 is useful when the mass of haloes is fixed , because then @xmath88 is a simple constant coefficient for varying @xmath2 , or @xmath230 , and the same relation applies to @xmath30-space bias such that @xmath231 .",
    "its limitation , however , has already been pointed out by mw themselves , by expanding the nonlinear relation ( equation [ eq : boost ] ) to second order in @xmath2 and first order in @xmath232 . such expansion ( and truncation at some order ) is useful in observing the halo bias in @xmath30-space because algebraic connection between real - space parameters and @xmath30-space parameters is possible , and also in understanding the generic behaviour of nonlinear bias .",
    "we therefore examine the taylor - expanded form of equation ( [ eq : boost ] ) .",
    "the main difference from mw is that we expand the nonlinear relation to second order in @xmath2 but keeping @xmath232-dependence accurate , because we sometimes reach @xmath233 .",
    "this will enable us to examine the dependence of nonlinear bias on the filtering scale more accurately .",
    "we thus taylor - expand @xmath234 to the second order in @xmath2 while keeping the dependency on @xmath235 accurate ( as in equation 30 of mw ) : @xmath236 where we use @xmath237 as an expansion of @xmath46 ( @xmath238 ; see mw ) and use the chain rule @xmath239 . using equations ( [ eq : ps - bias ] ) and ( [ eq : boost ] ) ,",
    "we obtain is fixed , and thus so is @xmath240 . because @xmath241 , this means that the @xmath49 changes as @xmath242 , which is not compatible with the notion of uniform grid .",
    "if we were to apply the expanded form on uniform - grid cases instead , @xmath49 is fixed and thus @xmath235 and @xmath240 change as @xmath2 changes .",
    "additional terms due to non - vanishing @xmath243 will appear on @xmath244 and @xmath245 in this case . nevertheless , @xmath240 is a very slowly - varying function in @xmath2 at @xmath89 , and thus we expect it to be higher - order correction in @xmath2 , and simply assume that @xmath246 in the expansion in general . ]",
    "@xmath247 @xmath248 and @xmath249 where @xmath250 and @xmath251 mw approximate the dependence on @xmath252 to first order , and have @xmath253 , @xmath254 , and @xmath255 , to which equations ( [ eq : b0 ] ) , ( [ eq : b1 ] ) and ( [ eq : b2 ] ) converge respectively when @xmath256 .",
    "@xmath257 explains the non - zero offsets @xmath258 and @xmath259 observed in almost all cases ( see figs [ fig : meannumber - mini-6.3 - 14]-[fig : meanfcoll - hmach-114 - 64 ] ) : let us call this the `` 0-point offset '' as mw did .",
    "0-point offset is a natural consequence of the fact that the global mean of a quantity @xmath260 , @xmath261 , differs from the selective average , @xmath262_{\\delta=0}$ ] , only over cells with @xmath93 .",
    "if one is to apply a simple linear relation @xmath114 , it is presumed that @xmath263 ( or @xmath264 ) because @xmath265 with @xmath88 as a constant coefficient . however , even in the linear regime in general , @xmath266 with non - zero @xmath257 .",
    "@xmath257 depends strongly on @xmath86 . the negative sign of @xmath257 reflects the fact that the rarer the haloes , or the higher the @xmath86 , the smaller the chances are to find them in the mean - density environment ( @xmath267 ) ; in the opposite regime when @xmath86 is small , @xmath268 , which means that haloes are more abundant in the mean - density cells than the mean value",
    ". the sign of @xmath257 also indicates , under a given filtering scale , the `` overall '' tendency of halo distribution : when @xmath267 , the net number of haloes found in overdense regions is larger than that in underdense regions , and when @xmath268 , the net number of haloes found in overdense regions is smaller than that in underdense regions . as a practical example , it will be very important to study haloes in voids if those haloes are a very abundant type , or @xmath159 .",
    "it is important to note that if the bias function ( equation [ eq : mean_bias_def ] ) is expanded instead of @xmath69 , one should include the singular term @xmath269 such that @xmath270 , because otherwise the approximated linear bias parameter can not explain the offset . in this sense ,",
    "@xmath83 should not be taken as a physical quantity but merely as a mathematical entity representing the fully nonlinear dependence of @xmath3 on @xmath2 .",
    "@xmath69 ( @xmath271 ) is a physical quantity which does not become singular when @xmath113 .",
    "@xmath244 is a good indicator of the overall trend of bias .",
    "the sign of @xmath244 , which is always positive , guarantees that haloes are not anti - biased but biased for higher cell - densities regardless of @xmath86 or the filtering scale , as long as @xmath2 is in the linear regime .",
    "@xmath244 depends on both @xmath86 and @xmath272 . at fixed halo - mass and filtering scale",
    ", @xmath244 increases as @xmath86 increases when @xmath273 and decreases when @xmath274 ( figure  [ fig : b1-dependence ] ) . such non - monotonic trend in @xmath244",
    "would not be observed when filtering scale is large enough , because then @xmath275 . at fixed halo mass ( and thus fixed @xmath86 and @xmath276 at some @xmath51 ) , the effect of filtering scale or @xmath277 on @xmath244 is also a mixed bag depending on rarity of haloes ( or @xmath86 ) as seen in figure [ fig : b1-dependence ] .     as a function of @xmath86 and @xmath277 ( equation  [ eq : b1 ] ) .",
    "the linear bias parameter of mw corresponds to a case with @xmath278 ( @xmath279 accordingly ) .",
    "note that @xmath280 is in general a non - monotonic function of @xmath86 : both very abundant ( @xmath281 ) and very rare ( @xmath282 ) haloes are weakly biased to the first order in @xmath2 , while the commonly used @xmath283 of mw is a monotonic function of @xmath86 . because @xmath284 in practice , care needs to be taken when using @xmath285 for very rare haloes.,width=321 ]",
    "we investigated the local bias of cosmological halo formation in the fully nonlinear regime , using both halo data from n - body simulations sampled on uniform grids and theoretical estimates for eulerian halo bias . over the wide dynamic range of halo mass , from @xmath286 to @xmath287 , we find that the observed biased population of haloes @xmath102 inside a cell with density @xmath2 can be matched well by the convolution of the mean n - body mass function @xmath288 with the nonlinear bias parameter derived from the extended press - schechter formalism .",
    "convolution with the ps mass function provides very poor fits in general , and convolution with the st mass function provides fits slightly poorer than @xmath289 .",
    "nevertheless , as the st mass function is known to break down for very rare haloes ( see e.g. the large discrepancy of the st mass function for haloes of @xmath290 at @xmath291 in fig .",
    "[ fig : meanmf ] ) , it is best to avoid both ps and st , and instead use @xmath289 in convolving the mean mass function to the bias factor given by equation ( [ eq : boost ] ) .",
    "based on the fact that the observed bias in halo population is well matched by the hybrid estimate @xmath197 which combines two physical quantities with different origins ( the average mass function @xmath288 is determined by a specific halo - identification scheme and the nonlinear bias parameter is based on the extended press - schechter theory ) , this prescription should be applicable in general to cases under other halo - identification schemes .",
    "we also find that the variance of halo numbers inside grid cells with given overdensity is not purely poissonian , but has additional variance .",
    "this variance originates from the sub - cell scale halo - halo correlation , which we proved quantitatively by explicitly calculating the conditional correlation functions . in the regime we studied ( @xmath12 and uni - grid filtering with cell size of @xmath292\\ , h^{-1}\\,{\\rm mpc}$ ] )",
    ", we find that the additional variance is always positive except for some negative values sporadically observed for haloes with @xmath293 .",
    "the nonlinear bias prescription described in our paper can be used to generate mock halo catalogues in the following sequence :    \\(i ) generate or adopt a mean mass function of haloes @xmath172 .",
    "it is advised not to use the ps mass function , due to the large discrepancy from the usual n - body halo catalogues practically over the full mass range .",
    "\\(ii ) generate a density field at a redshift of interest : if n - body data is available , adopt a proper smoothing scheme to generate a density field from the distribution of particles . depending on the size of cells ,",
    "cell - density can become nonlinear , and therefore n - body simulation is recommended .",
    "\\(iii ) place a uniform grid on the density field from step ( ii ) , and identify the comoving volume of the cell as @xmath294 .",
    "\\(iv ) visit a cell , and identify the cell overdensity @xmath2 .",
    "use equation ( [ eq : mass - rcell ] ) to deduce @xmath295 .",
    "take @xmath295 as the spatial filtering scale of the linearly extrapolated density field to @xmath296 , and calculate the corresponding variance @xmath297 .",
    "use equations ( [ eq : lin - nl - pos ] ) and ( [ eq : lin - nl - neg ] ) ( or the numerical fit given by equation 18 of mw ) to find matching @xmath298 of @xmath2 .",
    "\\(v ) to populate a cell with a halo of mass @xmath44 , use equation ( [ eq : mass - r ] ) to obtain @xmath299 , and take this as the filtering scale of the lineaized density field at @xmath296 and calculate the corresponding variance @xmath300 .",
    "\\(vi ) plug quantities from steps ( iv ) and ( v ) in equation ( [ eq : ps - bias ] ) , then use equation ( [ eq : deltah_lagrangian ] ) , then finally use equation ( [ eq : nbody - bias ] ) to calculate the biased halo mass function @xmath301 .",
    "multiplying the infinitesimal mass bin @xmath302 and @xmath294 to @xmath301 , one obtains the mean number of haloes @xmath142 $ ] of @xmath303 $ ] in the cell .",
    "\\(vii ) iterate steps ( iv ) - ( vi ) over all cells in the box .",
    "\\(viii ) if one wants to implement stochasticity , which should indeed affect the power spectrum of halo density field , use equation ( [ eq : pdf_superpoi ] ) with @xmath142 $ ] from step ( vi ) and an empirically found @xmath304 to include super - poisson stochasticity and sample halos by the monte - carlo method . for a selected range of halo masses and cell sizes",
    "as described in sections  [ sub : result : mean ] and [ sub : result : scatter ] , a reader may contact us for these values .",
    "perturbative approach to the nonlinear bias is found limited .",
    "first , one needes to be careful when approximating the halo bias by a simple linear relation @xmath114 , because even when the filtered density field is in the linear regime , @xmath305 , the 0-point offset ( equation  [ eq : b0 ] ) may not be negligible .",
    "in such cases , one should of course take @xmath257 into account such that @xmath306 .",
    "this 0-point offset ( @xmath307 ) occurs in general when ( 1 ) haloes are rare and/or ( 2 ) the cell size is small , which mw has already recognized and we have confirmed from our data . in the nonlinear regime ,",
    "even the second - order perturbation , which we calculated without the approximation taken by mw ( equations  [ eq : b0 ]  [ eq : q_define ] ) , provides a very poor fit in general .",
    "we thus claim that the local nonlinear bias scheme should be used unless perturbative approach is unavoidable .",
    "nonlinear bias schemes such as the one studied in this paper can be applied to both cosmological and astrophysical problems .",
    "for example , we already used the mean bias prescription in this paper as a sub - grid treatment to populate simulation boxes with haloes which are not resolved otherwise , for simulating cosmic reionization process : see @xcite for populating @xmath308 box with minihaloes , and @xcite for populating @xmath309 box with lmachs .",
    "similar approach has been attempted by @xcite , where they test their bias - based sub - grid treatment against resolved n - body haloes in terms of two - point statistics .",
    "their bias prescription , however , is heuristic and thus the corresponding fitting parameters should be re - evaluated when e.g. a very different dynamic range of halo mass is targeted .",
    "in contrast , even though we have just studied cosmological haloes at @xmath310 , the agreement between data and theoretical prediction in such wide range of halo mass , cell size , cell density , and redshift suggest that this prescription is valid in general .",
    "the nonlinear bias scheme studied here is valid when the primordial density field is gaussian , and thus may not be directly used to study non - gaussianity .",
    "it is also preferred that further study of the super - poissonian ( or sometimes sub - poissonian ) stochasticity , which we quantified here with @xmath311 box for minihaloes and @xmath308 box for lmachs and hmachs , is devised with higher - resolution , larger - box simulations to increase statistical reliability .",
    "stochasticity is likely to have temporal correlation as well as spatial correlation , which should be further studied for a more self - contained bias prescription .",
    "this work was supported by a research grant from chosun university ( 2010 ) . all simulations in this work",
    "were undertaken at the texas advanced computing center ( tacc ) at the university of texas at austin under teragrid allocations ."
  ],
  "abstract_text": [
    "<S> we present estimates of the nonlinear bias of cosmological halo formation , spanning a wide range in the halo mass from @xmath0 to @xmath1 , based upon both a suite of high - resolution cosmological n - body simulations and theoretical predictions . </S>",
    "<S> the halo bias is expressed in terms of the mean bias and stochasticity as a function of local overdensity ( @xmath2 ) , under different filtering scales , which is realized as the density of individual cells in uniform grids . </S>",
    "<S> the sampled overdensities span a range wide enough to provide the fully nonlinear bias effect on the formation of haloes . </S>",
    "<S> a strong correlation between @xmath2 and halo population overdensity @xmath3 is found , along with sizable stochasticity . </S>",
    "<S> we find that the empirical mean halo bias matches , with good accuracy , the prediction by the peak - background split method based on the excursion set formalism , as long as the empirical , globally - averaged halo mass function is used . </S>",
    "<S> consequently , this bias formalism is insensitive to uncertainties caused by varying halo identification schemes , and can be applied generically . </S>",
    "<S> we also find that the probability distribution function of biased halo numbers has wider distribution than the pure poisson shot noise , which is attributed to the sub - cell scale halo correlation . </S>",
    "<S> we explicitly calculate this correlation function and show that both overdense and underdense regions have positive correlation , leading to stochasticity larger than the poisson shot noise in the range of haloes and halo - collapse epochs we study .    </S>",
    "<S> [ firstpage ]    cosmology : large - scale structure of universe  cosmology : theory  galaxies : haloes . </S>"
  ]
}