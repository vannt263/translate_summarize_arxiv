{
  "article_text": [
    "a hidden markov model ( hmm ) for a sequence of observations @xmath0 , where @xmath1 , is a discrete - time stochastic process with dynamics depicted in figure  [ hmm ] .",
    "it is defined in terms of a hidden markov chain , the so - called _ signal _ , which in this paper will be taken to be the discrete - time sampling of a time - homogeneous continuous - time markov process @xmath2 , with state - space @xmath3 , transition kernel @xmath4 , and initial distribution @xmath5 .",
    "the observations relate to the signal by means of conditional distributions , assumed to be given by the kernel @xmath6 .",
    "we will assume that @xmath7 for some measure @xmath8 , in which case the corresponding densities are known as the _ observation _ or _ emission _ densities .",
    "the optimal filtering problem is the derivation of the conditional distributions @xmath9 of the unobserved signal given the observations collected up to time @xmath10 , henceforth denoted @xmath11 .",
    "these filtering distributions are the backbone of all statistical estimation problems in this framework , such as the prediction of future observations , the derivation of smoothing distributions ( i.e. , the conditional distribution of @xmath12 given past and future observations ) and the calculation of the likelihood function , that is , the marginal density of the observations when the emission distributions are dominated .",
    "see @xcite for details and applications .        throughout the paper",
    ", we will assume that the signal is stationary and reversible with respect to a probability measure @xmath13 .",
    "section  [ sec : disc ] shows how to extend our result to non - stationary signals .",
    "it is also appealing , from a modeling point of view , to assume that the signal evolves in continuous time , since there is a rich family of such models with a prespecified stationary measure @xmath13 .",
    "in addition , this assumption will give us a powerful tool to study optimal filtering by using the generator of the process , as we show in section  [ sec : dual ] .",
    "in the examples of section  [ sec : examples ] , the state space @xmath3 of the signal will either be a subset of @xmath14 or the @xmath15-dimensional simplex @xmath16 .",
    "mathematically , optimal filtering is the solution of the recursion @xmath17 which involves the following two operators acting on probability measures @xmath18 : @xmath19 \\mbox{prediction : } & \\psi_t({{\\xi } } ) \\bigl({\\mathrm{d}}x'\\bigr)= { { \\xi}}p_t\\bigl({\\mathrm{d}}x'\\bigr)=\\displaystyle\\int _ { { \\mathcal{x}}}{{\\xi}}({\\mathrm{d}}x)p_t\\bigl(x,{\\mathrm{d}}x ' \\bigr ) . \\end{array } \\ ] ] the `` update '' is the application of bayes theorem , and the `` prediction '' gives the distribution of the next step of the markov chain initiated from @xmath18 .",
    "these operators have the following property when applied to _ finite mixtures of distributions _ : @xmath20 this implies that when @xmath3 is a finite set , there is a simple algorithm for the sequential computation of the filtering probabilities . to see this , note that we can think of a distribution @xmath21 on a finite set @xmath3 , specified in terms of probabilities @xmath22 , as a finite mixture of point masses , @xmath23 ; it is easy to compute @xmath24 and then use the above result to obtain the probabilities associated with the distributions @xmath25 and @xmath26 .",
    "this yields a popular algorithm for inference in hmms , commonly known as the baum ",
    "welch filter , whose complexity is easily seen to be @xmath27 , where @xmath28 is the cardinality of @xmath3 .    outside the finite state - space case , the iteration of these two operators typically leads to analytically intractable distributions . however , there are notable exceptions to this rule .",
    "the classic example is the linear gaussian state - space model , for which the filtering distributions are gaussian with mean and covariance that can be iteratively computed using the so - called kalman filter , at cost that grows linearly with @xmath29 .",
    "recent work by genon - catalot and collaborators uncovered that there exist interesting non - gaussian models for which the filtering distributions are _ finite mixtures _ of parametric distributions .",
    "see @xcite , where the authors show how to compute the corresponding parameters sequentially in these models .",
    "we revisit their findings in section  [ sec : examples ] .",
    "however , the number of mixture components increases with @xmath29 in a way such that the cost of computing the filters grows polynomially with @xmath29 ( see section  [ sec : dual ] for details ) .",
    "borrowing and adapting the terminology from @xcite , we will refer to filters with such computational cost as _",
    "computable _ , whereas filters whose cost grows linearly with @xmath29 as _ finite - dimensional_.    the work by genon - catalot and collaborators raises four important questions , which we address in this paper : are there more models which admit computable filters ; do they share some basic structure ; is there a general methodology to identify such models and to obtain the algorithm which computes the sequence of parameters ; what is the computational complexity of such schemes and how can we obtain faster approximate filtering algorithms ?",
    "we show that the answer to all these questions relates to an important probabilistic object : the _ dual process_. duality methods have a long history in probability , dating back to the work of p. lvy @xcite ( see @xcite for a recent review ) .",
    "these have been widely applied to the study of interacting particle systems @xcite and proven to be a powerful method which provides alternative , and often simpler , tools for investigating the sample path properties of the process at hand .",
    "for example , the existence of a dual for a certain markov process ( and for a sufficiently large class of functions ) implies that the associated martingale problem is well defined , hence that the process is unique ; see section  4.4 of @xcite .",
    "see also @xcite and @xcite for applications of duality to population genetics .    in this paper",
    ", we illustrate that dual processes play a central role in optimal filtering and to a great extent can be used to settle the four questions posed above .",
    "we also uncover their potential as auxiliary variables in monte carlo schemes for stochastic processes ( and , hence , as a variance reduction scheme ) . in our framework , the dual will in general be given by two components : a _ deterministic process _ , driven by an ordinary differential equation , and a ( multidimensional ) _ death process _ with countable state - space .",
    "we show how to derive an explicit , recursive filtering scheme once the dual is identified , and apply this methodology to three cases of fundamental interest . in doing so",
    ", we identify what , to the best of our knowledge , is a new _ gamma - type _ duality .",
    "the rest of the paper is organized as follows . in section  [ sec : dual ] , we link optimal filtering to a specific type of duality , we show how to identify the dual in terms of the _ generator _ of @xmath2 , and study the complexity of the resulting filtering algorithm .",
    "section  [ sec : examples ] analyzes three interesting models for which the dual process is derived : the cox  ingersoll ",
    "ross model , the ornstein  uhlenbeck process and the @xmath30-dimensional wright  fisher diffusion .",
    "these models are reversible with respect to the gamma , gaussian and dirichlet distribution , respectively , and for the gaussian case the computable filter reduces to the kalman filter .",
    "section  [ sec : disc ] discusses certain aspects of the methodology , including the extension to infinite - dimensional signals modeled as fleming  viot processes .",
    "before presenting the main results , we introduce three fundamental assumptions which provide the general framework under which the results are derived .",
    "first , we will assume that @xmath31 is reversible with respect to a probability measure @xmath13 :    * @xmath32 .",
    "section  [ sec : disc ] discusses how this assumption can be relaxed to accommodate non - stationary signals . in order to state the second assumption",
    ", we need to introduce a certain amount of notation .",
    "define , for @xmath33 , the space of multi - indices @xmath34 we will use the symbol @xmath35 to denote the vector of zeros , @xmath36 for the vector in @xmath37 whose only non - zero element is found at the @xmath38th coordinate and equals @xmath39 , and let @xmath40 .",
    "furthermore , we will use the product order on @xmath37 , according to which for @xmath41 , @xmath42 if an only if @xmath43 for all @xmath38 . then , for @xmath44 , @xmath45 is the vector with @xmath38th element @xmath46 .",
    "additionally , if @xmath47 , define @xmath48 the notation for @xmath37 does not reflect its dependence on the dimension @xmath30 , but we will reserve boldface for elements of @xmath37 when @xmath49 ( or unspecified ) , whereas normal typeface will be used for elements of @xmath50 .",
    "finally , the following notations will be used to denote conditional expectations @xmath51 = { \\mathbb{e}}\\bigl[f(x_{t})\\vert x_{0}=x\\bigr ] = \\int _ { \\mathcal{x}}f\\bigl(x'\\bigr ) p_t\\bigl(x , { \\mathrm{d}}x'\\bigr).\\ ] ] the first denotes the action on @xmath52 of the semigroup operator associated to the transition kernel , where with some abuse of notation the same symbol is used both for the semigroup and the kernel .    the second assumption is concerned with models where @xmath53 is _ conjugate _ to the emission density @xmath54 :    * for @xmath55 , let @xmath56 be such that @xmath57 for all @xmath58 , and @xmath59 for some @xmath60 . then @xmath61 is assumed to be a family of probability measures such that there exist functions @xmath62 and @xmath63 with @xmath64 increasing and such that @xmath65    hence here with conjugacy , we intend the fact that the family @xmath66 of measures , which includes @xmath13 , is closed under the update operation . the assumption that @xmath67 is bounded in @xmath68",
    "will be discussed after the statement of assumption a4 .    for @xmath69 as in ( [ update - predict ] ) , it is easy to check that in the context of a2 , we have @xmath70 which , despite its appearance , does not depend on @xmath68 .",
    "note that our definitions of @xmath37 and @xmath71 allow the possibility that @xmath72 or @xmath73 , in which case @xmath67 in a2 is function only of the variables with non - zero dimension , whereas the case @xmath74 is not of interest here . in the setting of assumption a2 and for the trivial markov dynamics @xmath75 , with @xmath76 , the filtering problem collapses to conjugate bayesian inference for the unknown parameter @xmath68 of the sampling density @xmath54 .",
    "see section  5.2 and appendix a.2 of @xcite for an exposition of conjugate bayesian inference and stylized conjugate bayesian models , and section  [ sec : examples ] in this paper for examples within our framework .",
    "the third main assumption for our results concerns the existence of a certain type of dual process for the signal .",
    "* we assume that @xmath77 is such that the differential equation @xmath78 has a unique solution for all @xmath79 .",
    "let @xmath80 be an increasing function , @xmath81 be a continuous function , and consider a two - component markov process @xmath82 with state - space @xmath83 , where @xmath84 evolves autonomously according to ( [ eq : ode ] ) , and when at @xmath85 , the process jumps down to state @xmath86 with instantaneous rate @xmath87 we assume @xmath82 is _ dual _ to @xmath2 with respect to the family of functions @xmath67 defined in a2 , in the sense that @xmath88 = { \\mathbb{e}}^{({\\mathbf{m}},\\theta)}\\bigl[h(x , m_t,\\theta_t)\\bigr]\\qquad \\forall x \\in{\\mathcal{x } } , { \\mathbf{m}}\\in{\\mathcal{m } } , \\theta\\in{\\vartheta } , t\\geq0.\\ ] ] when @xmath72 or @xmath73 in a2 , the dual process is just @xmath89 or @xmath90 , respectively , and we adopt the convention that @xmath91    note that @xmath90 can only jump to `` smaller '' states according to the partial order on @xmath37 , and that ( [ eq : dual - rate ] ) implies that 0 is an absorbing state for each coordinate @xmath38 of @xmath92 , so that the vector of zeros is a global absorbing state .    as mentioned in section  [",
    "sec : intro ] , the notion of duality for markov processes with respect to a given function is well known .",
    "see , for example , section ii.4 in @xcite . among the most common type of duality relations we mention _ moment duality",
    "_ , that is duality with respect to functions of type @xmath93 , and _",
    "laplace duality _ , that is with respect to functions of type @xmath94 . see , for example , @xcite . in our framework , the duality functions are radon  nikodym derivatives between measures that are conjugate to the emission density , and this setup is perfectly tailored to optimal filtering .",
    "furthermore , a3 specifies that we are interested in dual processes which can be decomposed into two parts : one purely _",
    "deterministic _ and the other given by a @xmath30-dimensional _ pure death process _ , whose death rates are subordinated by the deterministic process .",
    "the transition probabilities of the death process , conditional on the initial state @xmath95 , will be denoted by @xmath96 ,",
    "\\qquad { \\mathbf{n } } , { \\mathbf{m}}\\in{\\mathcal{m } } , { \\mathbf{n}}\\leq { \\mathbf{m}}.\\ ] ] it is worth mentioning that the requirements on the structure of the dual processes prescribed by assumption a3 , with particular reference to the intensity ( [ eq : dual - rate ] ) , are justified by the three main reasons .",
    "the first is that , as shown in section  [ sec : examples ] , they define a framework general enough to identify duals of processes of interest , the incorporation of a deterministic component being necessary in this respect .",
    "the second reason is that the transition probabilities ( [ eq : trans - dual ] ) are analytically available , as provided by the following result , whose proof can be found in the .",
    "[ prop : trans probab ] let @xmath97 be as in 3 , with @xmath98 , and let @xmath99 .",
    "then the transition probabilities for @xmath92 are @xmath100 and , for any @xmath101 , @xmath102 where @xmath103 and @xmath104 is the multivariate hypergeometric probability mass function with parameters @xmath105 evaluated at @xmath106 .    this result can be interpreted as follows .",
    "the probability that a one - dimensional death process with inhomogeneous rates @xmath107 decreases from @xmath108 to @xmath109 in the interval @xmath110 $ ] is @xmath111 , where the second factor is related to the convolution of the waiting times in an inhomogeneous poisson process ( see section  19.10 in @xcite , and @xcite ) . for a @xmath30-dimensional death process , the same quantity is the probability associated to all paths leading from level @xmath108 to level @xmath109 .",
    "given such event , the probability of the subset of paths leading exactly from @xmath112 to @xmath45 is then given by the multivariate hypergeometric probability @xmath104 ( an expression of this probability can be found in the ) .",
    "note that the special case of proposition  [ prop : trans probab ] yielded by @xmath113 and @xmath114 relates to the result obtained in proposition  4.5 in @xcite .",
    "note also that when @xmath114 and @xmath115 , @xmath116 is the transition probability of the block - counting process of kingman s coalescent with mutation , see @xcite and @xcite for details on such process .",
    "the third motivation behind the type of duality required by a3 is that if it holds , the prediction operator maps measures as in a2 into finite mixtures .",
    "[ prop : prox - mix ] let @xmath117 be as in ( [ update - predict ] ) and assume 123 hold . then @xmath118 with @xmath119 as in proposition  [ prop : trans probab ] and where @xmath89 is the value in @xmath120 of the process in ( [ eq : ode ] ) started from @xmath121 .    from ( [ update - predict ] )",
    ", we have @xmath122 = \\pi\\bigl({\\mathrm{d}}x'\\bigr ) { \\mathbb{e}}^{({\\mathbf{m}},\\theta)}\\bigl[h \\bigl(x',m_t,\\theta_t\\bigr)\\bigr ] \\\\ & = & \\sum_{{\\mathbf{n}}\\leq{\\mathbf{m } } } p_{{\\mathbf{m}},{\\mathbf{n}}}(t;\\theta ) h \\bigl(x',{\\mathbf{n}},\\theta_t\\bigr ) \\pi\\bigl({\\mathrm{d}}x ' \\bigr),\\end{aligned}\\ ] ] where the second equality follows from a1 , the fourth from a3 , and the last from ( [ eq : trans - dual ] ) .    the above result states that reversibility and the existence of the required duality jointly guarantee that the prediction operator can be computed with a finite effort .",
    "the reduction of the operator to a sum is due to the fact that @xmath2 is dual to a markov process with discrete state - space , but it is precisely the fact that @xmath90 is a pure death process that makes the number of terms in the sum being finite .",
    "the next result shows that computable filtering is available in the framework we have outlined .",
    "[ prop : comp ] consider the family of finite mixtures @xmath123 then , under assumptions 123 , @xmath124 is closed under the application of the prediction and update operators ( [ update - predict ] ) , and specifically @xmath125 with @xmath126 \\\\[-8pt ] { \\widehat{w}}_{\\mathbf{n}}&\\propto & w_{{\\mathbf{m } } } c({\\mathbf{m}},\\theta ,",
    "y ) \\qquad\\mbox{for } { \\mathbf{n}}= t(y,{\\mathbf{m } } ) , \\sum_{{\\mathbf{n}}\\in t(y,\\lambda ) } { \\widehat{w}}_{\\mathbf{n}}=1 , \\nonumber\\end{aligned}\\ ] ] and @xmath127    the above proposition shows that under assumption a1 to a3 , and provided the starting state belongs to the family @xmath124 of finite mixtures with components as in a2 , then the filtering distributions evolve within @xmath124 .",
    "furthermore , the explicit reweighing of the mixture components is provided , thus allowing to concretely implement the recursive filtering scheme .",
    "note also that this result generalizes theorem  2.1 in @xcite , which states a similar result for @xmath113 under the assumption a2 and the result in proposition  [ prop : prox - mix ] .",
    "the proof of proposition  [ prop : comp ] follows from ( [ linearities ] ) , a2 and proposition  [ prop : prox - mix ] by direct computation , and is thus omitted .",
    "later in this section , we will derive filtering algorithms based on this result .",
    "however , we first address in the next subsection the most important aspect of the approach described in this section , which is how to find a dual process that satisfies a2 .",
    "it is typically easier to identify a process that satisfies the duality relation ( [ eq : means ] ) for infinitesimal @xmath120 .",
    "formally , this requires studying the _ generator _ of @xmath2 , which we will denote by @xmath128 .",
    "this is a linear operator , with domain denoted @xmath129 , linked to the semigroup operator via the kolmogorov backward equation @xmath130 where on the left hand side @xmath131 is differentiated in @xmath120 for given @xmath68 , whereas on the right hand side , @xmath128 acts on @xmath131 as a function of @xmath68 for given @xmath120 .",
    "see , for example , proposition  1.1.5 in @xcite .",
    "suppose now @xmath2 is a diffusion process which solves an sde on @xmath132 of the form @xmath133 in this case , @xmath128 is the second - order differential operator given by @xmath134 for an appropriate domain @xmath129 and where @xmath135 .",
    "let now @xmath136 denote the generator of the dual process defined in a3 , which can be easily checked to be @xmath137 } \\nonumber \\\\[-8pt ] \\\\[-8pt ] & & { } + \\sum _ { i=1}^{l}{r}_{i}(\\theta ) \\frac{\\partial g({\\mathbf{m}},\\theta)}{\\partial\\theta } , \\qquad g\\in{\\mathscr{d}}({a } ) , \\nonumber\\end{aligned}\\ ] ] with @xmath138 as in ( [ eq : ode ] ) .",
    "the main idea is then to identify the dual process from the generator , instead of the semigroup operator .    *",
    "the function @xmath139 defined in a2 is such that @xmath139 , as a function of @xmath68 belongs to @xmath129 for all @xmath140 , as a function of @xmath141 belongs to @xmath142 for all @xmath143 , and @xmath144    it will typically be the case that in order to have @xmath145 , one needs @xmath67 to be bounded in @xmath68 , requirement included in assumption a2 .",
    "proposition  1.2 of @xcite shows that a4 , together with the further assumption @xmath146 \\in{\\mathscr{d}}({a}),\\qquad { \\mathbb{e}}^{({\\mathbf{m}},\\theta)}\\bigl[h(x , m_t , \\theta_t)\\bigr]\\in{\\mathscr{d}}({\\mathcal{a}}),\\ ] ] implies ( [ eq : means ] ) , whose argument can be sketched as follows . from ( [ eq : gen - eq ] ) , we can write @xmath147 where @xmath148 denotes the identity operator . since @xmath128 and @xmath136 generate strongly continuous contraction semigroups , say on @xmath149 and @xmath150 , their ranges are dense in @xmath149 and @xmath150 , respectively .",
    "moreover , the resolvents @xmath151 , @xmath152 are one - to - one for all @xmath153 , so the previous implies @xmath154 since the resolvent of an operator is the laplace transform of the associated semigroup , and because of the uniqueness of laplace transforms , the previous expression in turn implies ( [ eq : means ] ) .",
    "the approach sketched above for identifying the dual process by means of the local condition ( [ eq : gen - eq ] ) will be implemented in section  [ sec : examples ] , where we will identify the duals for some interesting relevant models .",
    "typically , the initial distribution of the signal process belongs to @xmath66 , and most often equals the invariant measure @xmath13 .",
    "thus , without loss of generality and in order to simplify the exposition below , we make the following additional assumption .    * the initial distribution of the signal is @xmath155 , for some @xmath156 , @xmath157 .",
    "proposition  [ prop : comp ] provides a probabilistic interpretation of the weights involved in the finite mixtures in terms of the transition probabilities of the dual death process @xmath92 .",
    "this interpretation can be elaborated further , in order to facilitate the development of filtering algorithms . with a little abuse of notation ,",
    "denote by @xmath158 a discrete - time process with state - space @xmath83 constructed as follows .",
    "consider a partially observed markov process , where the signal is now @xmath159 and the conditional independence structure , given in figure  [ hmm2 ] graphically , is as follows .",
    "let @xmath160 be the initial state of the chain , with @xmath161 defined in a5 .",
    "then @xmath162 , with @xmath163 as in ( [ eq : norm - const ] ) and @xmath164 in ( [ eq : emission ] ) , and for @xmath165 , @xmath166 is the law of @xmath167 in a3 started from @xmath168 at time 0 .",
    "then , the connection between duality and optimal filtering can be expressed as @xmath169 thus , filtering @xmath170 in the original model in figure  [ hmm ] can be achieved by filtering @xmath171 in the dual model in figure  [ hmm2 ] . since @xmath172 evolves deterministically , optimal filtering for @xmath31 reduces to filtering @xmath173 , which has finite support with probabilities that can be computed recursively using an algorithm similar to the baum ",
    "welch filter , as we now describe .",
    "@xmath174 has support on the single point @xmath175 ; if @xmath176 has support on @xmath177 for @xmath178 and @xmath179 , and assigns probability @xmath180 to state @xmath181 , then @xmath182 has support on @xmath183 , where @xmath184 , for @xmath185 and @xmath186 defined in ( [ eq : gl ] ) and ( [ eq : update - mix ] ) , respectively , @xmath187 the solution of ( [ eq : ode ] ) at time @xmath188 started from @xmath189 , and the probability associated to state @xmath190 is @xmath191 = \\mathop{\\sum _ { { \\mathbf{m}}\\in \\lambda_{n } } } _ { t(y_n,{\\mathbf{m}})\\geq{\\mathbf{n } } } w_{\\mathbf{m}}p_{t(y_n,{\\mathbf{m}}),{\\mathbf{n}}}(t_{n+1}-t_n ; \\theta_n).\\ ] ] therefore , the optimal filtering reduces to the sequential computation of the parameters @xmath192 , the supports @xmath193 and the probabilities on each support point in @xmath194 , for @xmath195 .    ,",
    "where @xmath196 . ]    the computation of the probabilities ( [ eq : dual - prop ] ) for all @xmath197 can be done at a cost that is at most of order @xmath198 .",
    "therefore , the overall cost of computing the filters up to the @xmath29th observation is bounded from above by @xmath199 , we would recover the complexity of the baum ",
    "welch filter , discussed in section  [ sec : intro ] .",
    "however , @xmath200 increases with @xmath201 , as a result of the successive operation of @xmath185 and @xmath186 defined in ( [ eq : gl ] ) and ( [ eq : update - mix ] ) , respectively . clearly , it is hard to make further analysis on the computational complexity without some information on @xmath186 . here",
    "we will assume that @xmath202 , where @xmath203 , a structure that is found in all the examples we study in this paper .",
    "we then have the following key result .",
    "the proof of the lemma is omitted .",
    "[ prop : g ] for any @xmath47 and @xmath204 , we define @xmath205",
    ". then @xmath206    [ prop : complex ] under the assumption that @xmath202 , where @xmath203 , we have that @xmath207 where @xmath208 .",
    "the equality follows by successive application of lemma  [ prop : g ] . for the inequality ,",
    "notice that @xmath209 , with @xmath210 .",
    "then , by ( [ eq : gl ] ) , @xmath211 . then , apply jensen s inequality to @xmath212 will be of order @xmath29 .",
    "therefore , the complexity of carrying out the computations involved in the filtering recursions up to iteration @xmath29 , will be @xmath213 , where the constant depends on @xmath30 but not @xmath29 .",
    "we return to the issue of complexity in section  [ sec : disc ] .",
    "following the local duality approach outlined in the previous section , here we identify the dual processes for the cox ",
    "ross model , diffusion processes with linear coefficients and @xmath30-dimensional wright  fisher diffusions .",
    "in accordance with the rest of the article , we focus on stationary parametrizations of the processes and discuss the non - stationary case in section  [ sec : disc ] .",
    "recall that @xmath214 denote the state space dimension for @xmath215 , @xmath92 and @xmath216 , respectively .",
    "the so - called cox  ingersoll  ross ( cir ) model is a non - negative one - dimensional diffusion , that solves the sde @xmath217 this name is due to @xcite who introduced the model in mathematical finance , although this model had been studied long before in the literature , see , for example , the population growth model in section  13.c of @xcite and the process described in section  5 of @xcite . from a broader perspective , the cir model can also be seen as a special case of a continuous - state branching process with immigration @xcite .",
    "the generator of the cir process is @xmath218 with domain defined as follows . with the above parametrization , and using feller s terminology ,",
    "the boundary point @xmath219 is natural for all choices of parameters , while 0 is regular if @xmath220 and entrance if @xmath221 .",
    "define @xmath222 where @xmath223 is the space of continuous functions vanishing at infinity , and @xmath224 then @xmath225 generates a feller semigroup on @xmath223 .",
    "such choice of the domain for the case @xmath226 guarantees that the boundary 0 is instantaneously reflecting .",
    "see theorems 8.1.2 and 8.2.1 in @xcite . in this case , the cir process is reversible with respect to the gamma distribution @xmath227 previous results on duality for the cir model include a laplace duality , that is with respect to a function of type @xmath94 .",
    "see , for example , @xcite . here",
    "however we identify a new , gamma - type duality relation , which has as special cases a moment and a laplace duality .",
    "now , let @xmath228 , @xmath113 and @xmath229 , and define , for @xmath230 , the function @xmath231 this function can be identified as the radon  nikodym derivative of a @xmath232 distribution with respect to @xmath13 .",
    "the family of gamma distributions that arises by varying @xmath233 and @xmath230 , defines a subset of the family of gamma distributions that is conjugate to emission densities that as a function of @xmath68 are proportional to @xmath234 in which case @xmath120 and @xmath235 in a2 coincide with @xmath236 such type of emission density arises , for example , for observations @xmath237 distributed as poisson with intensity @xmath238 , giving rise to a dynamic version of the poisson - gamma conjugate bayesian model .    on the other hand",
    ", @xmath239 belongs to the domain of @xmath128 only when @xmath240 , in which case @xmath241 . in order to be able to use local duality as in a4",
    "we will assume that the family is defined as @xmath242 but we will return to the case @xmath243 at the end of this subsection .",
    "then a simple computation yields @xmath244h(x , m,\\theta).\\end{aligned}\\ ] ] motivated by this structure , and with view to achieving the local duality in ( [ eq : gen - eq ] ) we consider a two - component process @xmath245 with generator @xmath136 as in ( [ eq : gen - dual ] ) , where @xmath246 it is then easy to check that local duality holds , namely @xmath247 additionally , the conditions that are required to derive ( [ eq : means ] ) from this local duality are satisfied . in this example , the solution of the dynamical system ( [ eq : ode ] ) for @xmath121 is given by @xmath248 which in conjunction with proposition  [ prop : trans probab ] implies that the transition probabilities for the death process simplify to binomial probabilities @xmath249 therefore , we have all the ingredients necessary to implement the filtering algorithm .",
    "finally , note that if @xmath250 , then @xmath251 for all @xmath29 .",
    "notice that the result on the transition probabilities above , together with proposition  [ prop : prox - mix ] , implies the following interesting property of the cir process : @xmath252 \\\\[-8pt ] & & \\quad = \\sum_{k=0}^m \\operatorname{bin } \\biggl(k ; m , { \\gamma\\over \\sigma^2 } \\bigl ( \\theta \\mathrm{e}^{2\\gamma t } + \\gamma/\\sigma^2 - \\theta\\bigr)^{-1 } \\biggr ) \\operatorname{ga } \\biggl(k+\\delta/2 , { \\gamma\\over\\sigma^2 } { \\theta \\mathrm{e}^{2\\gamma t } \\over \\theta \\mathrm{e}^{2\\gamma t } + \\gamma/\\sigma^2 - \\theta } \\biggr ) .",
    "\\nonumber\\end{aligned}\\ ] ] this result has been obtained before , using a completely different approach ; the case @xmath253 can be shown directly by elementary calculations using a change of variables and binomial expansion of the left - hand - side ; the general case was proved in @xcite , see proposition  3.4 and the associated lemma  3.1 , after some rather heavy calculations .",
    "the result in ( [ eq : mixture - cir ] ) leads to a computable filter , as we showed in proposition  [ prop : comp ] , which is precisely the result also obtained in @xcite for the cir process .",
    "it is neat that using duality and the generic result in proposition  [ prop : prox - mix ] , this result can be obtained in a straightforward manner . the proof in @xcite",
    "is based on the following known series expansion of the cir transition kernel , see expression ( 80 ) in @xcite and page 334 of @xcite , which can be re - expressed as a poisson mixture of gamma distributions as follows : @xmath254 it is interesting that instead of deriving ( [ eq : mixture - cir ] ) from ( [ eq : series ] ) , which in any case is laborious , one can prove the former using duality and then obtain ( [ eq : series ] ) by taking @xmath255 and letting @xmath256 in ( [ eq : mixture - cir ] ) .",
    "in view of the arguments of section  [ sec : dual ] , it follows that , for @xmath257 , @xmath258 , hence duality in the sense of a3 can not be established using local duality .",
    "however , in view of the result ( [ eq : mixture - cir ] ) that has already been obtained in @xcite , it is obvious that duality still holds in this case .",
    "this also shows the limitation of the functional analytic method for establishing duality : it is a very powerful when all formal requirements are met , but there will be examples , like this one , where ( [ eq : means ] ) would have to be established by alternative arguments . nevertheless , a formal calculation using the generator reveals the dual even when @xmath259 .",
    "we consider the scalar ornstein  uhlenbeck process that solves an sde of the form @xmath260 which is reversible with respect to the gaussian distribution , @xmath261 the generator is given by @xmath262 with domain @xmath263 . in this model , we have @xmath264 , where @xmath265 , and @xmath266 which can be easily recognised as the radon  nikodym derivative between a @xmath267 and  @xmath13 .",
    "the measures @xmath268 are conjugate to emission densities that as a function of @xmath68 are proportional to @xmath269 with @xmath270 .",
    "such density arises , for example , with data @xmath271 that is gaussian with mean @xmath12 and variance @xmath272 . as with the cir process",
    ", we have the technical problem that this function belongs to @xmath129 only for @xmath273 , hence we will restrict to this case and define @xmath274 .",
    "a direct calculation gives that @xmath275 this suggests that the dual is purely deterministic and described in terms of the odes : @xmath276 duality with respect to this deterministic process implies that the filter evolves within the gaussian family and the computational cost is linear in @xmath29 , that is , we are dealing with a finite - dimensional filter .",
    "of course , all this is known : the odes above are the well - known equations for the first two moments of linear sdes , and the filter is the kalman filter .",
    "thus , within the assumptions we have made in this article , the finite - dimensional filter corresponds to the special case where the dual is purely deterministic .",
    "we considered @xmath228 for simplicity , but the results carry over to multi - dimensional stationary linear sdes .",
    "the same discussion as for the cir applies here regarding the restrictions posed by needing that @xmath277 .",
    "we return to this issue in section  [ sec : disc ] .",
    "wright  fisher ( wf ) processes are @xmath30-dimensional diffusions with paths confined in the @xmath15-dimensional simplex @xmath278^{k}\\dvtx \\sum _ { i=1}^{k}x_{i}=1 \\biggr\\}.\\ ] ] these processes approximate , among others , large - population discrete wright  fisher reproductive models with non - overlapping generations , and describe the time - evolution of the species abundancies when the individuals in the underlying population are subject to random genetic drift and , possibly , mutation , selection and recombination .",
    "see , for example , chapter  5 in @xcite and chapter  10 in @xcite .",
    "here we are interested in the case without selection nor recombination , and with _ parent - independent mutation_. that is , we consider a wf diffusion with generator @xmath279 where @xmath280 denotes the kronecker delta , @xmath281 and @xmath282 .",
    "the domain of the operator @xmath128 is taken to be @xmath283 , and the closure of @xmath128 generates a strongly continuous contractive semigroup on @xmath284 .",
    "see @xcite for details .",
    "note that this is a hypoelliptic diffusion , that is , the square of the diffusion matrix is not full rank , as a result of the constraint @xmath285 . even though we could work with an elliptic diffusion for the @xmath286 variables , it is the formulation above that is desirable for identifying the dual , as we will show .",
    "such diffusion is reversible with respect to the dirichlet distribution @xmath287    in this model , we have @xmath288 and @xmath73 , therefore there is no deterministic component in the dual process .",
    "we denote @xmath289 and define @xmath290 whence clearly @xmath291 .",
    "this can be identified with the radon  nikodym derivative between a dirichlet distribution with parameters @xmath292 and @xmath13 , and it is conjugate to emission densities that as a function of @xmath68 are proportional to @xmath293 in which case @xmath120 in a2 coincides with @xmath294 .",
    "such type of emission density arises , for example , for observations @xmath295 distributed as multinomial with parameters @xmath296 , giving rise to a dynamic version of the dirichlet - multinomial conjugate bayesian model .",
    "then we have @xmath297 this suggests considering a one - component dual process , with @xmath92 a markov jump process with generator @xmath298 obtained by letting @xmath299 in ( [ eq : gen - dual ] ) . since @xmath300 , it is then easy to check that the local duality condition @xmath301 holds . hence , the wf diffusion with parent - independent mutation @xmath215 and the death process @xmath92 on @xmath302 , which jumps from @xmath112 to @xmath303 at rate @xmath304 , are dual with respect to the above @xmath67 in the sense of a3 .",
    "the transition probabilities of @xmath92 are as in proposition  [ prop : trans probab ] .",
    "filtering the wf model when @xmath305 on the basis of binomial data was studied in @xcite .",
    "one can appreciate the strength of the approach we introduce here , since it is straightforward to obtain the filtering recursion using the dual and proposition  [ prop : trans probab ] for any @xmath30 .",
    "it has to be noted that , in our opinion , one of the reasons why the results are harder to obtain using the approach in @xcite , is because they decide to work with the elliptic wf model , which is a scalar diffusion since @xmath305 . working with the elliptic model hides the structure of duality , which is immediately apparent in the hypoelliptic model .",
    "the death process we obtain in this section can be seen as a special case of the process used in @xcite for deriving an infinite mixture expansion for the transition kernel of the wf diffusion with selection .",
    "an extension of wf diffusions to the case of infinitely - many types is given by fleming ",
    "viot processes .",
    "these are measure - valued diffusions whose finite - dimensional projections onto partitions of the type space coincide with wf processes .",
    "a duality relation holds between the fleming ",
    "viot process and a function - valued process related to kingman s coalescent .",
    "see , for example , @xcite .",
    "however , by applying to such dual process the same finite - dimensional projection that yields the wf process , one does not obtain the dual derived here , since binning the process into finitely - many sets hides some important information about the events at the level of particles .",
    "we have demonstrated that computable filtering follows from duality , in the sense described in assumptions a2 and a3 in section  [ sec : dual ] .",
    "a sufficient condition to establish duality is the local duality described in assumption a4 , which is based on the properties of the generator of the signal process and its relation to the semigroup operator via the kolmogorov backward equation .",
    "the use of this functional analytic machinery places some constraints on the duality function in a2 , such as for example that as a function of @xmath68 it has to vanish at infinity .",
    "therefore , even when duality holds in the sense of a3 for functions that do not satisfy such constraints , the local duality can not be used to prove this . on the other hand , the local duality can still be used formally to identify the dual .",
    "both in the cir process when @xmath243 and in the ou process when @xmath273 ( see section  [ sec : examples ] for details ) the formal application of the generator identifies the dual correctly .",
    "we have assumed reversibility with respect to a probability measure @xmath13 .",
    "in fact , our methodology relies on the existence of such reversible measure but does not require that it be a probability measure .",
    "an inspection of proposition  [ prop : prox - mix ] reveals that it is still valid in this more general case , provided @xmath306 is a probability measure .",
    "therefore , @xmath67 is the radon  nikodym derivative between the measures in @xmath66 and the reversible measure , in this more general framework which also covers non - stationary signals .",
    "another topic of investigation is the connection of the duality , as used in this paper , and results about the spectral representation of the transition kernel of the signal , for example , the type of expression in ( [ eq : series ] ) .",
    "there are classic results about such expressions , see , for example , chapter  13 of @xcite , and their existence seems to be related to computable filtering , see section  6.4 of @xcite , but the connection is not well understood .    our results in section  [ sec : dual ]",
    "show that for observations generated by a stationary process the computational cost associated with the identification of the filtering distributions grows polynomially with the number of observations , unless @xmath72 in which case the growth is linear .",
    "however , it might be the case that most of the components in the mixture representations have negligible weight .",
    "previous simulation studies , see , for example , table  1 in @xcite , show that after a few iterations the filter might concentrate all its mass in two or three components .",
    "we believe that the connection to the dual process might be very helpful in studying the effective number of components .",
    "however , there are subtleties in this line of research .",
    "note that when @xmath2 is ergodic , and @xmath307 is large relative to its mixing time , practically all mass of the filtering distribution will be concentrated on a single component , the `` root '' @xmath308 ( see a2 ) that corresponds to the invariant measure @xmath13 .",
    "therefore , the time evolution of the number of states with non - negligible filtering probabilities ( say above a given @xmath309 ) will depend on the number of observations per unit of time in the @xmath31 process .",
    "this aspect deserves careful study .",
    "we have obtained explicit filters also for a class of fleming  viot diffusions with parent independent mutation and for a class of measure - valued branching processes with immigration , under parametrizations which make them reversible with respect to the dirichlet and the gamma process respectively .",
    "a peculiarity of this framework , entailed by the fact that the signal is measure - valued and the observations are random draws from the signal , is the lack of a common dominating measure for the emission distributions , hence the lack of likelihood , which makes the nature of the problem truly non - parametric .",
    "the techniques for obtaining an optimal filter thus necessarily differ from those illustrated in this paper and will be reported elsewhere .",
    "[ sec : proofs ]",
    "before stating the result , we recall a useful lemma , whose proof can be found in @xcite .",
    "[ lemma cg09 ] @xmath310    proof of proposition  [ prop : trans probab ] consider first the one - dimensional case , that is , @xmath311 , denote for brevity @xmath312=\\int_{s}^{t}\\rho(\\theta_{u})\\,{\\mathrm{d}}u$ ] , and define for @xmath313 @xmath314 } \\prod _ { k=1}^{i-1}\\theta_{t_{k } } \\mathrm{e}^{-\\lambda_{m - k}\\theta [ t_{k},t_{k+1}]}\\,{\\mathrm{d}}t_{k}\\,\\theta_{t_{i } } \\mathrm{e}^{-\\lambda_{m - i}\\theta [ t_{i},t]}\\,{\\mathrm{d}}t_{i } , \\\\",
    "i_{1,\\ldots , j-1,j,\\ldots , i } & = & \\int_{0}^{t}\\cdots\\int _ { t_{i-1}}^{t}\\mathrm{e}^{-\\lambda_{m}\\theta[0,t_{1 } ] } \\prod _ { k=1,k\\ne j}^{i-1}\\theta_{t_{k } } \\mathrm{e}^{-\\lambda_{m - k}\\theta [ t_{k},t_{k+1}]}\\,{\\mathrm{d}}t_{k } \\,\\theta_{t_{i } } \\mathrm{e}^{-\\lambda_{m - i}\\theta[t_{i},t]}\\,{\\mathrm{d}}t_{i},\\end{aligned}\\ ] ] where @xmath315 in @xmath316 .",
    "it can be easily seen that @xmath317}-\\mathrm{e}^{-\\lambda_{m}\\theta [ 0,t]}}{\\lambda_{m}-\\lambda_{m - i}}}.\\ ] ] then we have @xmath318 where @xmath319 is the transition probability associated to the one - dimensional death process . by integrating twice , we obtain @xmath320.\\end{aligned}\\ ] ] the iteration of the successive integrations can be represented as a binary tree with root @xmath321 , whose node @xmath322 branches into @xmath323 and @xmath324 , with both branches weighed @xmath325 , determined by the parent node s indices .",
    "the leaves correspond to nodes where the left coordinate touches zero if the right coordinate is already zero , or where the left crosses zero if the right coordinate is positive .",
    "the term associated to the leaf @xmath326 will be @xmath327}$ ] weighed by some appropriate coefficient .",
    "the level before the leaves can be seen as the sequence @xmath328 where every sequence of @xmath329 terms is repeated with the last index augmented by one , and each @xmath330 produces the leaves @xmath331 and @xmath332 . hence given @xmath201",
    ", there are @xmath333 terms @xmath334 , @xmath335 terms @xmath336 ,  , @xmath337 terms @xmath338 , @xmath339 terms @xmath340 and @xmath330 .",
    "note also that @xmath334 has @xmath339 paths in common with @xmath330 , @xmath339 paths in common with @xmath340 , @xmath337 paths in common with @xmath338 ,  , @xmath335 paths in common with @xmath336 .",
    "the correct coefficient for @xmath341 is computed by collecting some constants related to the paths that have the same last coefficient and simplifying . in particular ,",
    "given @xmath201 , the paths to be grouped for @xmath341 are those whose constants for indices greater than @xmath342 change , since according to the rule above , when @xmath342 is the rightmost index in @xmath343 , there is only one path down to @xmath341 .",
    "hence , given @xmath201 , term @xmath341 has coefficient @xmath344 by taking moduli and applying lemma  [ lemma cg09 ] to the sum above , we obtain @xmath345 the result now follows from ( [ eq : i - i ] ) and ( [ eq : rescale - p - i ] ) , and from the fact that in the @xmath30-dimensional case , the probability of going from @xmath112 to @xmath45 , conditional on @xmath346 , is @xmath347",
    "the second author is supported by the european research council ( erc ) through stg `` n - bnp '' 306406 .",
    "the authors would like to thank valentine genon - catalot and aleksandar mijatovi for helpful discussions ."
  ],
  "abstract_text": [
    "<S> we link optimal filtering for hidden markov models to the notion of duality for markov processes . </S>",
    "<S> we show that when the signal is dual to a process that has two components , one deterministic and one a pure death process , and with respect to functions that define changes of measure conjugate to the emission density , the filtering distributions evolve in the family of finite mixtures of such measures and the filter can be computed at a cost that is polynomial in the number of observations . </S>",
    "<S> special cases of our framework include the kalman filter , and computable filters for the cox  ingersoll  </S>",
    "<S> ross process and the one - dimensional wright  fisher process , which have been investigated before . </S>",
    "<S> the dual we obtain for the cox  </S>",
    "<S> ingersoll  </S>",
    "<S> ross process appears to be new in the literature . </S>"
  ]
}