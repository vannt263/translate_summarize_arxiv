{
  "article_text": [
    "kinetic monte carlo simulations are frequently used in various fields to analyze the spatio - temporal evolution of systems consisting of many freely diffusing particles that can collide , react , transform or annihilate .",
    "spatial as well as stochastic aspects are important when diffusion is not sufficiently fast to make the system well - stirred and the number of reactants within diffusion range is small . in this case",
    "a mean - field description , for instance with a set of coupled reaction - diffusion equations , is inappropriate .",
    "moreover , in the limit of extreme dilution methods using a discretization of the underlying stochastic reaction - diffusion system , either in time @xcite or in space @xcite , become computationally inefficient .",
    "the currently most efficient methods to simulate extremely diluted reaction - diffusion systems are green s function reaction dynamics @xcite and first - passage kinetic monte carlo methods @xcite .",
    "in essence they avoid the small diffusion hops of a conventional random walk or brownian dynamics simulation by propagating particles over long distances through a sequence of large displacements .",
    "the latter are generated stochastically according to the exactly known green s function for a freely diffusing particle within so - called protective domains that are free from other particles .",
    "the typical size of these protective domains is inversely proportional to the particle density and the larger these domains are ( i.e. the smaller the particle density is ) the more efficient the algorithm is .    in general , during the free diffusion the particle can also be annihilated or transformed with a rate @xmath0 into a different species , in which case the green s function is still exactly know . in this paper",
    "we address the question how to propagate the particles when the annihilation rate varies in space and time , denoted as @xmath1 .",
    "this problem arises for instance in the context of motor - driven intracellular transport , where particles ( or cargos ) can in addition to diffusion and reaction also attach to a cytoskeleton filament and move ballistically with a constant speed in the direction of the filament . a continuum description of the diffusive and ballistic modes of motion @xcite involves the filament density @xmath2 which determines the local rate with which freely diffusing particles make a transition into the ballistic state . in a typical cell",
    "the filament density is spatially inhomogeneous and thus has to be taken into account during the propagation of particles on large scales .",
    "analogous examples arise in systems in which the annihilation of particles depends on a spatially inhomogeneous concentration field of an abundant reaction partner ( i.e. whose density is much larger such that a continuum description is appropriate for it ) .",
    "green s function reaction dynamics and first - passage time monte carlo methods reduce the simulation of a many - particle reaction - diffusion system to individual particles that diffuse freely as long as other particles are sufficiently distant ( i.e.  outside the interaction range ) , and perform a reaction event once a particle pair reaches a minimum distance .",
    "algorithmically one can ensure free diffusion for instance by estimating the maximum diffusion distance @xcite until a reaction is scheduled or by the definition of protective domains for each particle @xcite depending on the actual arrangement of neighboring particles . in both cases",
    "one then utilizes the free diffusion propagator within predefined domains to generate stochastically a time when either the maximum distance is underrun or a protective domain boundary is reached . for free diffusion",
    "this is achieved using the analytically known green s function , but for free diffusion with spatially varying annihilation rates this propagator is unfortunately not analytically available .",
    "thus in this paper we consider a freely diffusing single particle in an arbitrary domain @xmath3 that can be annihilated with a time and space dependent rate @xmath1 . in general , annihilation means a transition into a different species that is not considered in the present reduced setup . for a particle",
    "initially at time @xmath4 located at @xmath5 this diffusion - annihilation process is described by the following diffusion - annihilation equation    @xmath6    where @xmath7 is the probability density to find the particle at time @xmath8 at @xmath9 . for arbitrary @xmath1 and arbitrary @xmath10",
    "there is no analytic solution of eq .",
    "( [ dglallgemein ] ) available . in principle",
    "this equation can be solved numerically , but in the context of a general reaction - diffusion system ( involving many particles and several particle species ) using for instance the first - passage monte carlo method this is unfeasible : here one needs for each particle hop the whole first - passage time distribution for a particle to reach the protective domain boundary @xmath11 , which is computationally too demanding to be carried out in the innermost loop of the algorithm .",
    "therefore we present in this paper an algorithm that samples times @xmath12 and positions @xmath13 for arbitrary annihilation rates @xmath1 and arbitrary domains for which a particle diffusing according to eq .",
    "( [ dglallgemein ] ) either a ) reaches the boundary for the first time ( @xmath14 ) or b ) is annihilated ( @xmath9 ) .",
    "in addition , a slightly modified version of the algorithm generates the whole probability density @xmath7 within @xmath10 , meaning it solves eq .",
    "( [ dglallgemein ] ) stochastically .",
    "the paper is organized as follows : section [ basic_kmc ] defines all probability densities and flows used throughout this paper . based on the ideas of @xcite , section [ hom_rate ] presents an algorithm for the sampling of @xmath15 on arbitrary domains @xmath10 in the case of a spatially homogeneous but temporally varying annihilation rate @xmath16 .",
    "section [ inhoratsec ] generalizes this method to spatially inhomogeneous rates @xmath17 , proves its correctness and discusses its efficiency . finally section [ simuerg ] shows an application example of this method .",
    "in this section the probability densities and flows used later on are defined .",
    "let @xmath7 be the probability density solving the diffusion - annihilation equation ( [ dglallgemein ] ) within the domain @xmath10 with boundary @xmath11 , possibly partly absorbing , partly reflecting .",
    "the particle annihilation generates a probability flow @xmath18 out of the system given by    @xmath19    the probability flow @xmath20 at the absorbing parts of the boundary at time @xmath8 at position @xmath21 is given by    @xmath22    where @xmath23 denotes the outward pointing unity vector perpendicular to the boundary @xmath11 at @xmath13 .",
    "consequently @xmath7 is not normalized for @xmath24 .",
    "the corresponding probability density @xmath25 for an annihilation or absorption event is given by    @xmath26{\\nonumber\\\\}&=&\\alpha(t|{\\mathbf{r}}_0,t_0)+   \\beta(t|{\\mathbf{r}}_0,t_0)\\end{aligned}\\ ] ]    @xmath27    where @xmath28 denotes the surface element at position @xmath21 .",
    "hence , the task is to sample the pairs @xmath15 in statistical agreement to @xmath18 and @xmath20 , i.e the statistic of @xmath8 will be according to @xmath29 .    in the following",
    "we also need the probability distribution of a freely diffusing particle @xmath30 without annihilation , which obeys    @xmath31    the probability density for being absorbed at the boundary for a purely diffusing particle at time @xmath8 is given by @xmath32 and the probability density of the absorbing position @xmath33 under the condition that the absorption takes place at time t is given by @xmath34 using the gauss s theorem and eq .",
    "( [ dglnurdiff ] ) in the denominator , one obtains : @xmath35    for spatially homogeneous annihilation rates @xmath16 the annihilation process decouples from all spatial variables , i.e. the solution of eq .",
    "( [ dglallgemein ] ) can be written as    @xmath36    hence , the probability density of being annihilated at time @xmath8 under the condition of not being absorbed at the boundary before for a spatially homogeneous rate @xmath37 is given by @xmath38 \\label{rate_dens}\\end{aligned}\\ ] ] and the probability density of the annihilation position @xmath9 under the condition that the particle is annihilated at time @xmath8 is given by @xmath39 which is equal to the probability density of a purely diffusing particle under the condition of not being absorbed .",
    "in this section we present an algorithm that samples times @xmath12 and positions @xmath13 for homogeneous annihilation rates @xmath16 and arbitrary domains @xmath10 for which a particle diffusing according to eq .",
    "( [ dglallgemein ] ) either a ) reaches the boundary for the first time ( @xmath14 ) or b ) is annihilated ( @xmath9 ) .    assuming the ability to generate random numbers according to all the densities , which were defined in the previous section , a correct way of sampling @xmath15 is shown in algorithm [ alg1 ] :    @xmath40 random number according to @xmath41 @xmath42 random number according to @xmath43 @xmath44 @xmath45 random position according to @xmath46    @xmath45 random position at the boundary @xmath11 @xmath47 according to @xmath48    ( @xmath49 )    the probability density @xmath50 that the algorithm produces an annihilation at time @xmath8 at position @xmath13 is then given by    @xmath51    the probability density @xmath52 that the algorithm delivers an absorption at time @xmath8 at position @xmath14 is given by    @xmath53    consequently , the statistic of random pairs @xmath15 generated in this way coincides with @xmath18 and @xmath20 and is therefore correct .",
    "one problem remains : as there are no analytic solutions for eq .",
    "( [ dglnurdiff ] ) available for arbitrary domains @xmath10 , it is not possible to sample the quantities @xmath54 , @xmath55 and @xmath56 directly for arbitrary domains @xmath10 and arbitrary boundary conditions .",
    "only a direct sampling of @xmath57 is possible , as there is always an analytic expression for the corresponding distribution function available : @xmath58 that means , algorithm [ alg1 ] is useful only in some special geometries @xmath10 .    nevertheless , it is possible to use these special cases to sample the random pair @xmath15 for arbitrary domains .",
    "two different methods will be shown now .      in @xcite ,",
    "a kinetic monte carlo method for the simulation of reaction - diffusion processes of many - body systems is presented .",
    "it is based on the fact that there are analytic solutions of eq .",
    "( [ dglnurdiff ] ) for some simple domains @xmath59 and boundary conditions .",
    "the appendix shows a list with some of these domains in one , two and three dimensions and derives expressions for distribution functions , which are necessary for the usage of the inversion method @xcite .",
    "+ if @xmath59 denotes a subset of @xmath10 with @xmath60 , the shape of @xmath61 will not matter for the particle , as long as the particle has not left @xmath59 for the first time .",
    "hence , we can restrict the description of the particle s motion to @xmath59 until it leaves @xmath59 for the first time .",
    "mathematically we are dealing with a first - passage - problem in @xmath59 .",
    "its solution is given by eq .",
    "( [ dglnurdiff ] ) on @xmath59 according to absorbing boundary conditions at the interior of @xmath10 and the boundary conditions of @xmath10 at common boundaries of @xmath10 and @xmath59 ( as far as they exist ) .",
    "assuming that we are able to sample all occurring densities , a random pair @xmath15 for @xmath59 can be generated , as shown in algorithm [ alg1 ] .",
    "if annihilation takes place ( @xmath62 ) , the particle is annihilated before it leaves @xmath59 and therefore it is not influenced by the restriction to @xmath59 .",
    "if the particle reaches the boundary of @xmath59 ( @xmath63 ) , two possibilities have to be distinguished : for @xmath64 it reaches an absorbing boundary of @xmath10 and the algorithm will stop .",
    "otherwise , the particle continues its diffusive motion under the condition of having been at position @xmath65 at time @xmath66 . as it is always possible ( see appendix ) for an arbitrary @xmath67 to find a subset of @xmath10 where there are all needed analytic expressions available , we can go on this way until the particle is annihilated or absorbed at the boundary of @xmath10 .",
    "the pseudo - code of this is shown in algorithm [ alg2 ] .",
    "@xmath68 @xmath69 choose a suitable domain @xmath59 with @xmath70 @xmath40 random number according to @xmath71 on @xmath59 @xmath42 random number according to @xmath72 on @xmath59 @xmath45 rand .",
    "position according to @xmath73 on @xmath59 @xmath45 random position at the boundary @xmath74 @xmath47 according to @xmath75 @xmath76 @xmath15    a sketch of the method in a case where the particle is absorbed at the boundary is shown in fig .",
    "[ pro_box_choice ] .",
    "is sketched , otherwise the algorithm would stop earlier .",
    "depending on the position of the particle the shape of the chosen domain @xmath59 varies ( rectangles and circles).,scaledwidth=48.0% ]    for a given domain @xmath10 , the efficiency of the method depends on the choices of @xmath59 .",
    "ideally , one chooses @xmath59 from the list of possibilities in a way that maximizes the expectation value of @xmath77 .",
    "however , it also takes more time to look for this special subset and eventually calculate the random numbers for this situation . in the cases of a particle in the middle of a circle ( sphere ) or in the middle of a square ( cube )",
    "the random numbers can be generated very fast .",
    "hence , in some situations it might be better to use smaller domains @xmath59 than in principle possible .    up to this point",
    ", there is no approximation involved , but depending on the shape of @xmath11 a problem occurs : if the particle approaches an absorbing part of the boundary of @xmath10 , it will always automatically approach an absorbing part of the boundary of the chosen @xmath59 , too , as @xmath78 . in consequence ,",
    "the expectation value of @xmath77 will decrease , the stopping condition @xmath79 becomes more and more unlikely and the time incrementations in @xmath8 will become smaller and smaller , if the condition @xmath80 is not fulfilled .",
    "but @xmath14 can only be true , if the intersection of @xmath11 and @xmath74 contains more than just single points .",
    "the same problem occurs for reflecting boundaries of @xmath10 .",
    "as the choice of @xmath59 is limited , we sometimes have to approximate @xmath11 by a polygon in order to avoid a critical slowing down of the algorithm .",
    "however , it is important to mention that we can always choose the accuracy of the approximation by the choice of the polygon .",
    "depending on the shape of @xmath11 close to the position of the particle , there is sometimes a better way of propagating the particle than it is shown in the subsection above .",
    "@xcite introduced this idea for the particle s short time behavior in the context of particle - particle interaction , but it can be modified for a usage in our context . it is based on the assumption that there is a maximum distance @xmath81 , which the particle does not reach within a time @xmath82 . hence , within this time interval @xmath82 , only the intersection of @xmath10 with a neighborhood of radius @xmath81 matters . of course",
    ", this assumption is an approximation since there is a non - vanishing probability that the particle leaves this neighborhood within @xmath82 .",
    "however , it is possible to control the accuracy by the definition of @xmath81 via a parameter @xmath83 .",
    "we define :    @xmath84    as @xmath83 increases , it is more and more unlikely for the particle to violate the assumption .",
    "more precisely it is even possible to give an upper boundary for failing the assumption by studying the first passage - process to the boundary of a particle that starts in the middle of a circle ( 2d ) or a sphere ( 3d ) with radius @xmath81 and calculating the probability @xmath85 for not having reached the boundary within @xmath82 .    in 2 dimensions",
    "we obtain : @xmath86    where @xmath87 , @xmath88 are the roots of the bessel function @xmath89 ( see appendix and be aware of the slightly different notation ) . in the following tabular",
    "the corresponding values are calculated for some @xmath83 .",
    "+    [ cols=\">,>,>,>,>,>,>,>,>,>\",options=\"header \" , ]     consequently , for a choice of @xmath83 in the range of @xmath90 one is on the safe side for all practical purposes , where also other numerical error sources ( quality of the random number generator , rounding errors ) come into play .",
    "this gives the possibility to use analytic solutions of eq .",
    "( [ dglnurdiff ] ) of domains which coincide with @xmath10 only in the neighborhood of @xmath81 .",
    "the example of fig .",
    "[ max_dist_bild ] shows the left part of the domain from fig .",
    "[ pro_box_choice ] .",
    "choosing @xmath81 in the shown way , the analytically known solution of an infinite sector ( see appendix ) can be used , as long as @xmath91 .    , the particle is assumed not to cross the black circle line .",
    "so the solution of an infinite sector with reflecting boundaries can be used.,scaledwidth=40.0% ]    hence , if the particle is neither annihilated nor absorbed within @xmath82 , the particle will stay diffusive and a random pair @xmath92 must be created for the particle s new position . in order to avoid repetitions , we skip the pseudo - code details here , as they will be shown in the next section in a more general case .    in most situations",
    "it is much better to use the subset method as its time - increments are generally much larger .",
    "but in a situation like the one sketched in fig .",
    "[ max_dist_bild ] , the particle is very close to the reflecting boundaries and no suitable large domain @xmath59 is available . in consequence",
    ", @xmath59 would be very small , leading to a very small @xmath77 on average .",
    "the last section showed how to find a solution for an arbitrary domain @xmath10 by solving the problem in several steps in smaller domains @xmath59 . hence , without loss of generality , we now assume the ability to sample random numbers according to @xmath56 , @xmath54 and @xmath55 directly .    if the annihilation rate becomes inhomogeneous , eq .",
    "( [ sol_t_dep_rate ] ) is not a solution of ( [ dglallgemein ] ) anymore .",
    "the annihilation - time is now correlated to the complete path of the particle , thus the method presented in the previous section will not work . in this section",
    "we present a way to overcome this problem for arbitrary rates @xmath1 without any additional approximations .",
    "the following method starts with the pair ( @xmath93 ) and generates a series of random pairs ( @xmath94 ) .",
    "the last pair of this series will become the new @xmath15 .",
    "for all @xmath24 we define the spatially homogeneous but time dependent upper bound for the annihilation rates    @xmath95    the density @xmath57 with the rate @xmath96 is denoted by @xmath97 in the following :    @xmath98\\ ; .\\ ] ]    we sample a candidate pair @xmath99 as shown in algorithm [ alg1 ] . for @xmath100 the particle",
    "is absorbed at the boundary , i.e. the first candidate is accepted .",
    "otherwise we compare the ratio @xmath101 to a uniformly distributed random number @xmath102 in @xmath103 $ ] .",
    "if @xmath104 , the particle is annihilated , i.e. the first candidate is also accepted , else we generate a new candidate pair @xmath105 under the condition of having been at position @xmath106 at time @xmath107 .",
    "this can be continued until the particle is absorbed at the boundary of @xmath10 or annihilated .",
    "the algorithm can also be used to sample the complete probability density @xmath7 : if no candidate is accepted until an arbitrarily chosen time @xmath108 is reached , the algorithm returns a random position of the still diffusive particle , i.e a pair @xmath109 whose statistics is given by @xmath110 .",
    "also in case one wants to use the maximum distance method , the time @xmath111 has to be chosen appropriately .",
    "if a break at @xmath111 is not wanted , one simply sets @xmath112 .",
    "a pseudo - code description is shown in algorithm [ alg3 ] .",
    "@xmath68 @xmath69 @xmath40 random number according to @xmath113 @xmath42 random number according to @xmath72 @xmath45 random position according to @xmath114 @xmath115 @xmath45 random position according to @xmath73 @xmath45 random position at the boundary @xmath11 @xmath47 according to @xmath75 @xmath76 @xmath116      the basic mechanism by which the algorithm handles a spatially varying annihilation rate @xmath117 is to generate trial annihilation positions using the propagator for a spatially constant ( but maximal ) annihilation rate @xmath118 .",
    "the annihilation is then accepted with the local probability @xmath119 for . at first sight",
    "it appears counter - intuitive that this local procedure actually gives the correct statistics , since the probability to propagate a particle from @xmath120 to @xmath13 depends on the complete annihilation rate landscape in between and around .",
    "why is it sufficient to probe @xmath117 locally at one or a few positions generated by the algorithm ?",
    "before we answer this question rigorously by proving that it is indeed sufficient , we give an intuitive argument why one might expect the procedure to be correct : the stronger the spatial variation of @xmath117 is in @xmath10 the larger the maximum rate @xmath118 will be .",
    "a large constant annihilation rate @xmath118 gives rise to a particle propagator that forbids large hops , which implies that the algorithm will produce many small intermediate hops and after each hop evaluates @xmath117 . in this way",
    "the algorithm explores stochastically the annihilation landscape on finer or coarser length scales depending on the variation of @xmath117 . if for instance @xmath121 everywhere in @xmath10 except in a small restricted region , where it is @xmath122 , thus @xmath123 .",
    "then the algorithm will explore the complete region @xmath10 with a hop size that is characteristic for the restricted region with the non - vanishing annihilation rate . in the end",
    "this yields the correct statistics for the whole region , which we will prove now .",
    "we will prove that the statistic of the output pairs ( @xmath49 ) satisfy the probability flows @xmath124 and @xmath125 for @xmath126 .",
    "then the case @xmath127 ( particle is still diffusive at time @xmath111 ) occurs with the correct probability , too .",
    "we also prove that the statistic of output pairs @xmath109 coincides with @xmath110 .",
    "the algorithm will stop after a ( unknown ) number @xmath128 ( @xmath129 ) of loop - runs ( see algorithm [ alg3 ] ) . the probability density for being annihilated after",
    "@xmath128 loop - runs at time @xmath8 at the position @xmath13 is denoted by @xmath130 .",
    "analogously the probability density for being absorbed at the boundary after @xmath128 loop - runs at time @xmath8 at the position @xmath13 is denoted by @xmath131 . the probability density for stopping after i+1 loop - runs , still being in the diffusive state at @xmath111 and being located at @xmath13",
    "is denoted by @xmath132 .",
    "as the number of loop - runs is a disjoint decomposition , we can sum over @xmath133 to obtain the total densities for the corresponding events :    @xmath134    @xmath135 @xmath136    starting with @xmath137 , we compute @xmath138 , @xmath139 , @xmath140 :    * @xmath141 + @xmath142 : for this event @xmath143 has to be smaller than @xmath77 , which delivers the second factor in the following product .",
    "the third factor belongs to the choice of the position and the last one arises from the exit - condition of the algorithm s loop : @xmath144 @xmath145 : an analogous procedure delivers @xmath146 + @xmath147 : if the particle reaches the time @xmath111 in the first loop - run , @xmath143 and @xmath77 have to be larger than @xmath111 .",
    "thus @xmath147 is the product of these two independent probabilities with the spatial density @xmath148 : + @xmath149 * @xmath141 + as the algorithm will pass the loop twice here , we have to sum / integrate over all weighted pairs @xmath150 , which will be achieved in the first loop - run .",
    "since the algorithm will only continue with a new loop if @xmath143 is smaller than @xmath77 , for the first loop the factors and integrals look the same for all cases .",
    "the factors of the final loop can be taken from the individual factors of @xmath137 with the starting position @xmath106 and the time @xmath107 instead of @xmath67 and @xmath4 .",
    "defining the probability that the algorithm denies a candidate pair @xmath15 @xmath151 we get :    @xmath152    @xmath153 @xmath154 for @xmath155 we introduce the definitions @xmath156 finally , defining @xmath157 one inductively gets for @xmath158 : @xmath159 hence , the total probability densities can be written as @xmath160 with @xmath161 comparing this with the definitions of @xmath124 and @xmath125 , it remains to show that @xmath162 , i.e. @xmath163 has to satisfy eq .",
    "( [ dglallgemein ] ) with the initial condition @xmath164 . as all @xmath165 with @xmath155 vanish for @xmath166 , the initial condition is simply fulfilled by the definition of @xmath167 . for the time - derivative of @xmath165 one",
    "inductively gets for @xmath155 :    @xmath168    hence , the time - derivative of @xmath163 satisfies @xmath169 thus , using eq .",
    "( [ dglnurdiff ] ) , it follows : @xmath170 which is exactly eq .",
    "( [ dglallgemein ] ) .",
    "hence , the correctness of the algorithm [ alg3 ] is proven .",
    "this section presents a two - dimensional application example of the algorithm .",
    "it is designed to demonstrate how the algorithm handles a situation in which its correctness is most counter - intuitive : we choose the annihilation rate to be non - vanishing just inside a restricted region , a circle , where it oscillates in time and varies spatially . for a chosen test - setup ,",
    "we compare its results with the solution of a commercial fem ( finite element method ) routine .    at @xmath171 the diffusing particle ( @xmath172 ) is located at the position @xmath173 within a rectangle of size @xmath174 .",
    "the right boundary is chosen to be absorbing , all other boundaries are reflecting . a strongly anisotropic time dependent annihilation rate @xmath175 is chosen to be    @xmath176    with @xmath177 and @xmath178 .",
    "[ 2dgeo_example ] presents a sketch of the described setup .",
    "on the one hand the problem has been solved numerically by applying a commercial fem solver with a very fine triangulation ( @xmath179 elements ) to eq .",
    "( [ dglallgemein ] ) . in the following this solution",
    "is denoted by @xmath180 . on the other hand",
    "the monte - carlo algorithm has been applied to the problem in @xmath181 samples . in principle",
    "it is not necessary to use the subset method here , as the analytic solution of eq .",
    "( [ dglnurdiff ] ) is known for the rectangle ( see appendix ) , from which all occurring densities can be sampled .",
    "nevertheless it has been used , as it increases the speed of the algorithm dramatically : for all highly anisotropic annihilation rates the ratio @xmath182 in algorithm [ alg3 ] will mostly be very small ( in our case even 0 ) .",
    "hence , a lot of loop runs with just small time incrementations will on average be needed for an event .",
    "restricting the movement of the particle temporally to a subset of @xmath10 ( subset method ) ensures the possibility of choosing a smaller @xmath96 , which reduces the number of loop - runs in algorithm [ alg3 ] dramatically . using this in our case",
    "it takes around 40 minutes for @xmath183 samples on a single core with @xmath184 ghz .",
    "firstly , the relative frequencies for the times of an event and the kind of the event were counted .",
    "@xmath185 denotes the relative frequency of having had no event until time @xmath8 .",
    "it has to be compared with the value of @xmath186 , which was derived numerically from the fem solution .",
    "@xmath187 denotes the relative frequency of having had an annihilation event before time @xmath8 .",
    "it is compared to @xmath188 .",
    "@xmath189 denotes the relative frequency of being absorbed at the right boundary before time @xmath8 .",
    "it is compared to @xmath190 . a plot of these quantities is shown in fig .",
    "[ kummugraph ] .     and",
    "the numerically integrated probabilities for the events of still being diffusive ( @xmath191 ) , having already been annihilated ( @xmath192 ) and having already been absorbed at the right wall ( @xmath193).,scaledwidth=45.0% ]    it shows an almost perfect coincidence of all corresponding quantities .",
    "the maximum relative deviation is about 1@xmath194 in all curves . keeping in mind that @xmath195 , @xmath196 and @xmath197 are calculated by a numerical time - integration of a numerical spatial integration of a numerical solution of eq .",
    "( [ dglallgemein ] ) , these small deviations are explainable .",
    "more precisely , @xmath198 has to hold for all times , but the numerical discrepancy in this sum is also about 1@xmath194 at maximum .",
    "secondly , we want to compare the spatial distribution of the particle s position from the kmc algorithm to @xmath180 for three characteristic times : @xmath199 , @xmath200 , @xmath201 .",
    "hence , the rectangle is divided in @xmath202 squares @xmath203 ( @xmath204 , @xmath205 ) and the relative frequency @xmath206 for being at the square @xmath203 is counted for @xmath107 , @xmath207 and @xmath208 .",
    "technically this has been done by setting @xmath209 @xmath210 in algorithm [ alg3 ] .",
    "the quotient of @xmath206 and the area of a square element is denoted by @xmath211 .",
    "this density converges to the solution of eq .",
    "( [ dglallgemein ] ) in the limits of increasing sample numbers and @xmath212 .",
    "the upper panel in fig .",
    "[ example_graphs ] shows the density @xmath211 for the chosen times in a 3d plot for @xmath213 . in order to illustrate the influence of the annihilation within the circle ,",
    "the projection on the bottom shows isolines by discretising the density into intervals .",
    "* @xmath199 : the probability density of the particle is still centered around the starting position in the upper left corner",
    ". nevertheless its shape is already influenced by the annihilation within the circle .",
    "* @xmath200 : at time @xmath207 there has been almost no annihilation for a short period ( slope of the red line in fig .",
    "[ kummugraph ] ) . hence , diffusion almost equilibrated the density gradient in y - direction , generated by the annihilation within the time - interval @xmath214 $ ] . *",
    "@xmath201 : at time @xmath208 relatively strong annihilation takes place , which even leads to a local minimum of @xmath215 within the circle .    in order to quantify the local differences between the kmc result and the fem result , we choose squares of size @xmath216 ( @xmath217 ) .",
    "a measure for the spatially resolved relative deviation is @xmath218    the lower panel of fig .",
    "[ example_graphs ] shows @xmath219 .",
    "for all times the deviations are small and in the range of the numerical expectation : for @xmath220 samples and @xmath221 plaquettes one expects ca .",
    "@xmath222 samples per plaquette and thus statistical fluctuation of the order of @xmath223 , i.e.  relative fluctuation in the 1 percent range , which is what the lower panel of fig .",
    "[ example_graphs ] confirms .    on the right side of the simulation rectangle , where the absorbing boundary is located , the statistical error is larger for small times , since the density is still centered around the starting point in the upper left corner , giving a region @xmath224 with very small values of @xmath206 .",
    "but the aim of the algorithm [ alg3 ] is not the stochastic solution of eq .",
    "( [ dglallgemein ] ) , for which finite element methods are suitable .",
    "the aim of the algorithm is to sample correctly _ next events _ ( annihilations or first - passages of boundaries ) according to eq .",
    "( [ dglallgemein ] ) , which can not be handled by a fem routine .",
    "the example demonstrates , that this is possible , even in cases of highly anisotropic and time dependent annihilation rates .",
    "we have presented an algorithm that samples correctly the probability distribution of a diffusing particle with a space dependent annihilation or transformation rate @xmath117 for arbitrary domains . together with first - passage time methods it can serve as the basic building block for a kinetic monte carlo algorithm simulating a general many - particle reaction - diffusion system .",
    "the basic idea is to generate trial moves with the exactly known single particle green s function for a spatially constant annihilation rate @xmath118 , which is the maximum of @xmath117 in the current protecting domain . with probability @xmath119 the particle",
    "is annihilated at the trial position @xmath225 , otherwise a new trial move with initial position @xmath225 is generated .",
    "the iteration proceeds until either the particle is annihilated or the boundary of the protecting domain is reached . in this paper",
    "we proved rigorously the correctness of this algorithm and demonstrated its numerical accuracy and efficiency with an illustrative example .",
    "important applications with a spatially varying transformation rate include continuum models for intracellular transport ( or more generally intermittent search strategies @xcite )",
    ". in intracellular transport particles ( proteins , organelles ) can switch between free diffusion and ballistic motion by molecular motor assisted movement along cytoskeleton filaments .",
    "the density of filaments in the space direction @xmath226 , @xmath227 , is generally very inhomogeneous in space and sometimes even varies over time ( for instance during cell polarization ) .",
    "this situation can be described by the fokker - planck equation for the probability densities @xmath228 and @xmath229 for diffusing particles and particles that move with a constant velocity @xmath230 in direction @xmath226 , respectively @xcite :      where @xmath83 and @xmath232 are the attachment and detachment rates ( to and from filaments ) , respectively .",
    "the freely diffusing particle sees a total annihilation rate @xmath233 , with which it is transformed into a ballistically moving particle with a randomly chosen direction @xmath226 ( and velocity @xmath230 ) with probability @xmath234 .",
    "the algorithm presented in this paper handles a monte carlo simulation of the diffusion process described by ( [ diff ] ) , whereas the implementation of the ballistic motion ( [ ball ] ) is straightforward .",
    "this appendix presents some analytic solutions of eq .",
    "( [ dglnurdiff ] ) , which have mostly been taken from @xcite .",
    "furthermore , it derives expressions for sampling according to the densities @xmath56 , @xmath54 , @xmath55 in cases where this might not be obvious anymore .",
    "we list only frequently used domains in one , two and three dimensions .      *",
    "absorbing on both sides : @xmath236 with @xmath237 .",
    "+ expressions for the probability densities @xmath56 , @xmath54 , @xmath55 and the corresponding distribution functions @xmath238 , @xmath239 , @xmath240 can be derived analytically . * reflecting on the left and absorbing on the right side : @xmath241 with @xmath242 .",
    "+ expressions for the probability densities @xmath56 , @xmath55 and the corresponding distribution functions @xmath238 , @xmath240 are analytically derivable . as there is only @xmath243 for the particle to leave the domain , it follows @xmath244 and @xmath245 . * reflecting on both sides : @xmath246 with @xmath237 .",
    "+ expressions for the probability density @xmath55 and the corresponding distribution function @xmath240 can be derived analytically .",
    "[ [ particle - in - a - rectangle-0atimes-0b - and - in - a - cuboid-0atimes-0btimes-0c ] ] particle in a rectangle @xmath247\\times [ 0,b]$ ] and in a cuboid @xmath247\\times [ 0,b]\\times [ 0,c]$ ] ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    if the boundary conditions do not vary along each side , @xmath248 factorizes : @xmath249 where @xmath250 , @xmath251 ( @xmath252 ) are given by solutions for intervals from the subsection above . depending on the boundary conditions ,",
    "@xmath56 is sampled by generating a random time for every coordinate , where there is at least one absorbing boundary .",
    "the smallest of these times has to be returned as @xmath77 .",
    "the particle reaches the boundary in the corresponding coordinate .",
    "all other quantities are sampled as above .      * absorbing boundary : @xmath254\\;,\\nonumber\\end{aligned}\\ ] ] where @xmath255 denotes the infinite sum over all positive roots @xmath87 of the bessel function @xmath256 .",
    "+ the density of finding the particle at an arbitrary angle at radius @xmath257 is then given by @xmath258 and the corresponding distribution function is given by @xmath259 hence , the distribution function belonging to @xmath56 is given by @xmath260 analytic expressions for all quantities depending on @xmath261 which are needed , are straightforwardly derivable by integrating the @xmath262-functions .",
    "+ having precomputed the values of @xmath87 , random numbers are sampled by inverting the occurring distribution functions numerically .",
    "+ for a particle starting in the center of the circle the @xmath261- dependence becomes uniformly distributed in the interval @xmath263 and @xmath238 simplifies to @xmath264 which is used to derive eq .",
    "( [ assumption_correct_2d ] ) .",
    "* reflecting boundary : @xmath265\\ ; , { \\nonumber}\\end{aligned}\\ ] ] where @xmath255 denotes the infinite sum over all positive roots @xmath87 of @xmath266 .",
    "+ the density of finding the particle at an arbitrary angle at radius @xmath257 is then given by @xmath267 { \\nonumber}\\end{aligned}\\ ] ] and the corresponding distribution function is given by @xmath268 a distribution function for the angle @xmath261 under the condition of being at radius @xmath257 can be derived straightforwardly by integrating the @xmath262-functions .",
    "having precomputed the values of @xmath87 , @xmath257 and @xmath261 are sampled by a numerical inversion of the distribution functions . for a particle starting in the center of the circle the @xmath261-dependence",
    "again becomes uniformly distributed in the interval @xmath263 .",
    "[ [ particle - in - a - sector - of - angle - theta - with - reflecting - boundaries ] ] particle in a sector of angle @xmath269 with reflecting boundaries ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~        the density for finding the particle at an arbitrary angle @xmath261 at radius @xmath257 is then given by @xmath273\\ ; .{\\nonumber}\\end{aligned}\\ ] ] as there is no analytic expression for a distribution function of @xmath274 available , the usage of the inversion method would be very slow , as the integration of @xmath257 would have to be done numerically . fortunately , @xmath274 does not depend on the sector angle @xmath269 , hence the analytically known solution for @xmath275 ( half - plane ) can be used to generate @xmath257 for all @xmath269 .",
    "a distribution function for the angle @xmath261 under the condition of being at radius @xmath257 can be derived straightforwardly by integrating the @xmath262-function .",
    "[ [ particle - in - a - sphere - of - radius - r - with - absorbing - boundary - conditions ] ] particle in a sphere of radius @xmath253 with absorbing boundary conditions ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~      where @xmath255 denotes the infinite sum over all positive zeros @xmath87 of the bessel function @xmath277 , @xmath278 is the n - th legendre polynomial and @xmath279 is the cosine of the angle between @xmath13 and @xmath67 .",
    "+ the density of finding the particle at arbitrary angles @xmath280 at radius @xmath257 is then given by @xmath281 ^ 2}\\quad { \\nonumber\\\\}=\\frac{2r}{r r_0 } \\sum_{n=1}^\\infty   e^{-n^2\\pi^2\\frac{d(t - t_0)}{r^2}}\\sin\\left(\\frac{n\\pi   r_0}{r}\\right)\\sin\\left(\\frac{n\\pi r}{r}\\right)\\ ; .{\\nonumber}\\end{aligned}\\ ] ]      hence , the distribution function belonging to @xmath56 is given by @xmath284 which was used to derive eq .",
    "( [ assumption_correct_3d ] ) with the help of lhospital s rule ( @xmath285 ) . + a distribution function for @xmath286 $ ] under the condition of being at radius @xmath257 can be derived straightforwardly by integrating the legendre polynomials @xmath278 . using the sampled @xmath279 , the angels @xmath261 and @xmath287 are sampled ."
  ],
  "abstract_text": [
    "<S> we present an efficient monte carlo method to simulate reaction - diffusion processes with spatially varying particle annihilation or transformation rates as it occurs for instance in the context of motor - driven intracellular transport . like </S>",
    "<S> green s function reaction dynamics and first - passage time methods , our algorithm avoids small diffusive hops by propagating sufficiently distant particles in large hops to the boundaries of protective domains . since for spatially varying annihilation or transformation rates the single particle diffusion propagator </S>",
    "<S> is not known analytically , we present an algorithm that generates efficiently either particle displacements or annihilations with the correct statistics , as we prove rigorously . the numerical efficiency of the algorithm is demonstrated with an illustrative example . + * keywords : * computer simulations , kinetic monte carlo , reaction - diffusion processes </S>"
  ]
}