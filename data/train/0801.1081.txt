{
  "article_text": [
    "the theory of stellar evolution has been tested extensively mainly through well - studied binary stars ( _ e.g. _ , popper 1980 , lastennet & valls - gabaud 2002 , ribas 2006 ) or simple , coeval stellar populations such as open and globular clusters ( _ e.g. _ vandenberg et al . 1996 , renzini & fusi pecci 1988 ) .",
    "it has been extraordinarily successful at explaining most stellar properties across the different evolutionary stages , by incorporating increasingly complex physics in both stellar interiors and atmospheres ( see salaris & cassisi 2006 for an updated and extensive review ) .",
    "in contrast , and perhaps somewhat paradoxically , the determination of the fundamental parameters of single stellar populations , such as distance , age , metallicity , reddening , convective parameters , etc , has seldom been the subject of a rigorous mathematical determination . more often than not , isochrones are `` fitted '' by eye , and very rough estimates of errors are given , if given at all .",
    "the reason for this state of affairs is perhaps the many degeneracies between these parameters , which makes it seemingly impossible to find a unique solution to the set of fundamental parameters .",
    "alternative , semi - empirical methods have been developed instead to infer _ relative _ quantities , rather than absolute ones .",
    "for instance , the so - called horizontal method relies on the difference in colour between the turn - off ( to ) point and the base of the red giant branch ( rgb ) , and is independent of the assumptions made on the convective theory .",
    "the vertical method , on the other hand , relies on the difference in apparent magnitude between horizontal branch ( hb ) stars and turn - off stars .",
    "both methods rely heavily on `` semi - empirical calibrations '' provided by stellar models , and are subject to many uncertainties ( _ e.g. _ , how to define properly",
    "the to point when photometric errors blur this region of the colour - magnitude diagram ?",
    "what is the vertical offset hb ",
    "to when the hb is not horizontal ? ) which nevertheless have been tackled with some success ( _ e.g. _ rosenberg et al . 1999 ,",
    "salaris & weiss 2002 ) .    here",
    "we want to point out that many of the degeneracies are actually mere artifacts , and that a proper and rigorous mathematical technique can be formulated to measure these parameters in a robust and objective way .",
    "for example , the well - known age - metallicity degeneracy , which states that a given isochrone can be fitted with a different age provided the metallicity is changed appropriately , is a purely _ geometrical _ degeneracy : the _ shape _ of the isochrones is the same , yet stellar evolution predicts that stars with a different metal content will evolve at a different _ speed_. hence , the age - metallicity degeneracy is not a physical one , but simply a result of using the geometrical shape of isochrones as the only discriminant factor . clearly , a simple statistical estimator that would count the number of stars _ along _ the isochrones would give very different results for any pair of age / metallicity values that would give the same geometrical shape to the isochrones . in a more formal way ,",
    "let us consider a curvilinear coordinate @xmath0 along an isochrone of given parameters ( say , distance , reddening , metallicity , age , alpha elements enhancement , etc ) .",
    "this position depends only on the age @xmath1 of that isochrone and on the mass @xmath2 of the star at that precise locus , so that @xmath3 only . an offset in age @xmath4",
    "is reflected only through changes in mass @xmath2 and position @xmath0 along the isochrone of age @xmath1 since dt(m , s ) = .|_s dm + .|_m ds . for a star in this isochrone",
    "the offset is , by definition , zero , hence .|_t",
    "= - .|_s ( .|_m ) ^-1 .",
    "[ eq2 ] the first term is always finite .",
    "the second term is the evolutionary speed , the rate of change for a given mass @xmath2 of its coordinate along the isochrone when the age changes by some small amount .",
    "one can think of @xmath0 as representing some evolutionary phase , and so this term will be large when the phase is short - lived : a small variation in age yields a very large change in position along the isochrone .",
    "alternatively , for a given age , and since the first term is always finite , a wide variation in position implies a narrow range in mass . this is the case of the red giant branch or the white dwarf cooling sequence , for instance . on the other hand , slowly evolving phases such as the main sequence have small evolutionary speeds and wide ranges in mass for a given interval along an isochrone .",
    "clearly , the most important phases to discriminate between alternative ages and metallicities will be the post main - sequence ones , where the range of mass is small ( and hence insensitive to the details of the stellar mass function ) , and at the same time where evolutionary speeds are large . if we consider the mid- to lower main sequence , at fixed metallicity , isochrones of all ages trace the same locus , with only marginal changes in the density distribution of points amongst them . in this sense ,",
    "one of the parameters , @xmath1 , is to a large extent absent from the main sequence , while phases beyond are always substantially a function of both age and metallicity .",
    "the density of stars along an isochrone is therefore = - ( ) ( .",
    "the first term is related to the initial stellar mass function ( imf ) , and , as discussed above , the second term is finite while the third is a strong function of the evolutionary speed . if the mass after the turn - off is assumed to be roughly constant",
    ", this implies that the _ ratio _ in the number of stars in two different evolutionary stages after the turn - off will only depend on the ratio of their evolutionary time scales .    in terms of observables",
    ", this well - know relation has been exploited using luminosity functions as a proxy ( as pioneered by paczyski 1984 ) , that is , number counts of stars as a function of apparent magnitude .",
    "this is not the isochrone coordinate @xmath0 , but rather the projection of the isochrone on the vertical axis of the colour - magnitude diagram .",
    "the fact that the sub - giant branch often appears nearly horizontal in cmds implies that luminosity bins in this regime will not be discriminant .",
    "this is unfortunate because this phase is more heavily populated than the red giant branch , and thus the use of luminosity functions is not optimal .",
    "likewise , the projection on the horizontal axis , a colour , is less sensitive to the details along the rgb . clearly , the optimal strategy is to use the full information provided by the observed density of stars along the isochrone .    to summarize existing methods ,",
    "one approach has grown out of the fitting of geometrical indicators of the observed cmd to isochrones , from single particular indicators such as turn off point ( to ) , magnitude or colour difference between two points on the cmd , to vs. zero - age horizontal branch or tip of the rgb and rgb bump position and combinations thereof .",
    "examples can be found in renzini & fusi pecci ( 1988 ) , buonanno et al .",
    "( 1998 ) , salaris & cassisi ( 1998 ) , salaris & weiss ( 1998 ) , vandenberg & durrel ( 1990 ) , ferraro et al .",
    "( 1999 ) and rosenberg et al .",
    "the accuracy of these approaches has been extended by including several such geometrical indicators simultaneously ( e.g. vandenberg 2000 , meissner & weiss 2006 ) , or a complete geometrical comparison between observed cmd and isochrone ( e.g. straniero & chieffi 1991 ) .",
    "the reduction of the cmd to a few numbers , given the varied and complex physics which enters in determining them implies using only a subset of the information available in the cmd , while the unavoidable observational errors present necessarily lead to ambiguities in the identification of the key points to be used , which are hard to quantify formally , and which result in uncertain confidence intervals being assigned to the inferences derived . neglecting stellar evolutionary effects",
    "limits the information content of the isochrones against which the cmds are compared .",
    "on the other hand , approaches concentrating explicitly on the stellar evolutionary effects have grown out of the already mentioned analysis of luminosity functions presented by paczyski ( 1984 ) , a projection of the cmd onto the vertical axis .",
    "extensions have mostly centered on the easy to measure and age sensitive features of the rgb luminosity function ( _ e.g. _ jimenez & padoan , 1998 , and zoccali & piotto 2000 ) . here again , observational errors together with the binning adopted in generating luminosity functions , imply a limited use of the information available in the observation , while not including the information encoded by the geometry of both the cmd and isochrones limits the accuracy of the inferences .    there are have been a few attempts in the past at using the full information available in a colour - magnitude diagram , as pioneered by flannery & johnson ( 1982 ) and further developed by wilson & hurrey ( 2003 ) and naylor & jeffries ( 2006 ) . unfortunately all these approaches , while mathematically correct , fail to include properly the key discriminating factor discussed above , the stellar evolutionary speed , resulting in wide uncertainties in the inferred parameters .",
    "the only other attempt we are aware of , in the context of inferring parameters from a stellar population , was made by jrgensen & lindegren ( 2005 ) , who adapted our formalism developed in a previous paper ( hernandez , valls - gabaud & gilmore 1999 ) to derive stellar ages .",
    "the present paper is a further and robust extension of this approach .",
    "paper ii in this series ( valls - gabaud & hernandez 2007 ) will apply the method to different sets of observations of stellar populations .    in section 2",
    "we present the rigorous probabilistic model , which is tested with synthetic cases in section 3 . in section 4 we explore and quantify the effects of systematic uncertainties , in section 5 we present an application of the method to a real case , ngc  3201 .",
    "finally in section 6 we present our conclusions on this novel approach .",
    "in trying to recover the physical parameters of an observed cluster , we begin by constructing a model where only 4 numbers determine the above , the age , metallicity , distance and reddening of the cluster , a vector @xmath5 . henceforth , we will define @xmath6 as the total vertical displacement of the stars in the observed cmd with respect to their original positions .",
    "this vertical displacement is of course the distance modulus and the contribution of the extinction in the observed band , that is , @xmath7 , where @xmath8 is the colour excess in the bands considered and @xmath9 the ratio of selective to total absorption .",
    "note that these contributions are , in general , correlated , since at larger distances the reddening usually increases within the galaxy .",
    "note also that @xmath9 may depend on the line of sight considered , even though a universal extinction curve is usually assumed .",
    "for these reasons it is simpler ( and model - independent ) to consider a vertical offset , and a horizontal one , the colour excess , as two independent quantities .",
    "thus , we assume the imf to be known , the binary fraction to be zero and the contamination of background / foreground stars to be negligible .",
    "this conditions are of course not true in a real case , and we will therefore treat them as systematics , the effects of which we shall explore in detail in section 4 .    from a bayesian perspective , given an actual observed cmd , we want to identify the vector @xmath5 which has the highest probability in having resulted in the actual observed cluster , as that from which the cmd most probably actually came from .",
    "this model is essentially what was introduced and tested in hernandez et al .",
    "( 1999 ) , and subsequently used in hernandez et al .",
    "( 2000a , 2000b ) to infer star formation histories of resolved galaxies , although much simplified here for the treatment of single stellar populations .",
    "we must construct a statistical method for determining what is the probability that an observed cmd might have been the result of a given vector @xmath5 .",
    "an observed cmd will be defined by a set of @xmath10 stars , each having a measured magnitude and colour ( in whichever photometric bands or filters ) @xmath11 , with @xmath12 and @xmath13 being the measured ( deduced from photometry data reduction procedures ) 1-sigma errors in these quantities . errors in magnitudes and colours will be assumed as being gaussian in nature , and uncorrelated to each other for the time being .",
    "hence , a reported star @xmath14 , @xmath15 , will be thought of as a two - dimensional gaussian probability density distribution , centered on @xmath11 , with dispersions @xmath12 , and @xmath13 .",
    "we begin with the probability that a given observed star , of magnitude and colour @xmath16 , is in fact a real star of some age @xmath1 , and some metallicity , @xmath17 , of mass @xmath2 , luminosity @xmath18 and colour @xmath19 , observed with an assumed vertical offset of @xmath6 , and a reddening of @xmath8 , both in units of magnitudes .",
    "this will be given by    @xmath20    in the above expression @xmath21 and @xmath22 are the differences in magnitude and colour between the @xmath23th observed star and a generic star of age , metallicity , distance modulus , reddening and mass @xmath24 .",
    "l^2(m , i)=(l_i)^2+(l_m)^2 , _",
    "c^2(m , i)=(c_i)^2+(c_m)^2 , where @xmath25 and @xmath26 are the errors which have to be applied to the theoretical comparison star of mass @xmath2 to map in onto the observed cmd .",
    "i.e. , each theoretical star is being thought of as a gaussian probability density distribution centered on @xmath27 , with dispersions @xmath28 and @xmath29 .",
    "equation [ eq : g ] is hence equivalent to the convolution over the entire cmd plane of two gaussian probability distributions , a first one coming from the reported observed star , and a second one from the probabilistic transfer function which we must apply to a theoretical model star coming from an isochrone to map it onto a particular observed cmd .",
    "if we wanted to consider model stars as mathematical points in this comparison , following bayes theorem , we would identify the probability that a particular reported real star , itself a 2-d probability distribution , was in fact a certain model star , with the probability that this particular model star might actually come from the 2-d probability distribution of the reported star . to treat the problem rigorously ,",
    "we consider only the comparison between a reported star and a model one , only after this last one has been mapped onto the plane where the observed star exists , through a probability function , as described above .    in equation [ eq : g ]",
    "a numerical normalization constant has been left out , as in any case likelihood functions have no absolute normalizations and only relative values are meaningful . whereas @xmath12 and @xmath13 are supplied by a particular observation of a real cmd , @xmath28 and @xmath29",
    "have to be estimated . in a practical application , one could obtain the average of @xmath12 and @xmath13 , as functions of magnitude , and use those two functions as models for @xmath28 and @xmath29 .",
    "having the probability that a single observed star is in fact a particular model star , we can now compute the probability that our observed star came from any point along a particular isochrone in our parameter space @xmath5 as :    @xmath30    in the above expression @xmath31 is the density of stars along the isochrone of metallicity @xmath17 and age @xmath32 , around the test star of mass @xmath2 . as explained in  1 , this density depends both on the assumed imf and on the evolutionary speed predicted by the stellar evolution code at that position of the cmd . the density of points along the isochrone , within a certain interval around a certain mass , in the highly discriminating region beyond the main sequence ,",
    "will be determined essentially by the time spent by a star within that interval , as given by the stellar evolutionary codes .",
    "if a large portion of the main sequence is included in the study , the imf will dominate @xmath31 over that region , as discussed in  1 . on the other hand , the mass interval",
    "beyond the turn off point is so small , that practically any conceivable imf will yield identical results for @xmath31 in this region .",
    "the rbg has a lower density of points than the main sequence not because of the imf , but because of the fast stellar evolutionary speeds .    in practice ,",
    "the extremely rapid variations in magnitude and colour with mass over critical regions of the isochrones make it convenient to carry out the integration in equation [ eq : gint ] over a parameter measuring length over the isochrone , rather than mass , in which case @xmath31 must include weighting factors due to the relative duration of different stellar phases .",
    "also , @xmath33 and @xmath34 are a minimum and a maximum mass considered along each isochrone , such that the luminosity completeness limit of the observations always corresponds to the luminosity of star @xmath33 , while @xmath34 corresponds to the star of age and metallicity @xmath35 at the tip of the rgb .",
    "the explicit exclusion of phases beyond the helium flash reduces to a certain extent the resolution of the method , but increases significantly its robustness , as it guarantees ( see section 4 ) that only well - established physics are considered in the stellar evolutionary models .",
    "we shall refer to @xmath36 as the likelihood matrix , since each element represents the probability that a given star , @xmath23 , was actually formed with metallicity @xmath17 , at time @xmath32 with any mass , and that it was observed with a distance modulus of @xmath6 , and reddening of @xmath8 .",
    "that is , in this bayesian approach , we treat the stellar mass @xmath2 as a nuisance parameter which we marginalize over .",
    "the probability that an entire observed cmd with @xmath37 stars arose from a particular model , _",
    "i.e. _ , from a particular choice of parameters @xmath38 , will now be given by :    @xmath39    in this way , we have constructed an optimal merit function which can be evaluated at any point within the relevant four dimensional parameter space @xmath38 , given an observed cmd .",
    "it is important to remark that this merit function uses all information available in the cmd densely .",
    "no binning or averaging over discrete regions is necessary , and no aspects of the distribution of stars on the cmd are discarded .",
    "also , all the rich stellar evolutionary physics is included in the comparison with the models , as the isochrones are not being reduced to a discrete set of numbers ( e.g. the position of the to , rgb slope , etc . ) or even curves on the cmd .",
    "as we shall see in section  3 , the full use of all features in both data and models , allows a precise estimation of the inferred parameters .    following bayes theorem",
    ", one would now want to identify that point which maximizes , the 4 coordinates which maximize the probability that the observed cmd did in fact arise from a particular point in the parameter space , with the set of physical cluster parameters which have the highest probability of having given rise to the observed cmd .",
    "several methods exist for identifying the global maximum of a multi dimensional surface .",
    "most standard methods run into considerable difficulties in cases where local maxima exist , as our problem turns out to have . the most reliable way of solving this problem is to evaluate   throughout a dense grid in all of the available parameter space .",
    "this however , is highly time consuming , and hence it is highly desirable to find a more efficient method .",
    "we have used the genetic algorithm approach , where a number of `` agents '' are placed at random points within our parameter space , and the position of each codified into a binary number , the `` genes '' of each agent .",
    "the number of binary bits used for each coordinate fixes the resolution of the algorithm , which in this case corresponds to the resolution of the isochrone grid on the ( @xmath40 ) plane , and to 0.01 mag in the ( @xmath41 ) plane .",
    "the value of  is then evaluated at the position of each agent , and the result is used as a fitness function . a second generation",
    "is then constructed by `` mating '' the original agents , pairing them and combining the `` genes '' of each parent to produce two `` offsprings '' .",
    "the fitness function is used to weight the mating probability , such that the fitter individuals have a greater probability of `` mating '' .",
    "the `` genes '' of the offsprings are a combination of those of their parents , and hence as generations proceed , the population gradually moves into regions where the fitness function is higher , _",
    "i.e. _ , into regions of high . to avoid getting trapped into local maxima , a slight `` mutation rate '' is introduced , through which some of the offsprings in each generation have a randomly selected `` gene '' switched from `` 1 '' to `` 0 '' , or vice - versa .",
    "this simplistic algorithm has been shown to converge remarkably efficiently into the global maximum of complex multi - dimensional surfaces , associated to very different problems .",
    "a more complete description of the algorithm can be found in charbonneau ( 1995 ) , with successful applications to diverse astrophysical problems being described in _",
    "e.g. _ teriaca et .",
    "al ( 1999 ) for fitting radiative transfer models to solar atmosphere data , sevenster et al . ( 1999 ) in fitting parameters of galactic structure models to observations , metcalfe ( 2003 ) , for the fitting of white dwarf astroseismology parameters or georgiev & hernandez ( 2005 ) in the problem of inferring optimal wind parameters from observed spectral line profiles , among many others .",
    "in this section we test the method described in section  2 , through the inversion of a series of synthetic cmds . as in this case the point in parameter space from which a particular cmd was simulated is known , we can optimally asses the performance of the method .    in simulating an observed cmd",
    "the first step is to obtain an adequate isochrone library .",
    "different groups have succeeded in producing state - of - the - art stellar evolutionary codes using mostly , but not all the time , the same input physics . since",
    "systematic errors will be produced by the choice of the set of isochrones , we use the results of the three different groups ( bergbusch & vandenberg 1997 , vandenberg et al .",
    "2006 , demarque et al .",
    "2004 , girardi et al . 2002 ) .",
    "we have worked directly with the output of stellar evolutionary codes to produce our own isochrone grid with a dense grid including 180 time steps and 120 metallicity intervals .",
    "each isochrone contains approximately 300 stellar masses .",
    "the time resolution for ages of between 4.5 gyr and the upper limit of 18.0 gyr is of 0.2 gyr , with younger ages being sampled more densely .",
    "the spacing in metallicity is linear in the logarithm , with 0.03 dex per interval . throughout the paper we shall identify metallicity with [ fe / h ] , when using theoretical isochrones , or comparing against empirical inferences .",
    "the spacings of the isochrone grid will determine the maximum resolution of the method , independently of what approach is taken at the following levels of the problem .",
    "for the purposes of presenting the method , these grids are more than appropriate .",
    "it is important to note that the highly non - linear variations in magnitude and colour with mass which appear along isochrones on critical regions of the cmd implies that a direct interpolation between two isochrones will not produce the intermediary one , but an average curve which bares little resemblance to the output of a stellar evolutionary code . in all cases ,",
    "we have limited the isochrones to below the helium flash .",
    "this condition restricts the information we consider in our method to the region where disagreement between different groups working in the field is at a minimum .",
    "once the isochrones have been established , an imf is chosen to distribute stars amongst different masses .",
    "this function proves to be relatively unimportant , as the mass range of stars one is dealing with is small provided stars are selected from one magnitude or so below the to region all the way to the tip of the rgb .",
    "this ensures that the mass range probed by the observations is small .",
    "for example , in globular clusters older than @xmath42 gyr the mass interval is around @xmath43 and hence in this narrow mass range the details of the imf are irrelevant .",
    "the distribution of stars along the isochrone is a much more sensitive function of the stellar evolutionary models , which is in fact what determines that the main sequence is highly populated , the red giant branch much more sparsely so , and that the hr gap region will contain very few stars .",
    "the imf we use is that of kroupa et al .",
    "( 1993 ) , although as mentioned above , any other approximation to this function would yield the same results ( see  4.1 ) .",
    "having an isochrone grid and an imf , we can now pick a point in our @xmath38 parameter space and place a chosen number of stars into the magnitude - colour plane .",
    "for the first implementation we have simulated an extreme example with close to 2000 stars around point @xmath44 , a single stellar population of age 13.9 gyr , metallicity @xmath452.7 ( that is , close to @xmath451.0 in solar units , for a solar metallicity of @xmath461.7 ) , with a distance modulus of 18.8 magnitudes , and observed through a reddening of 0.05 magnitudes .",
    "next we model magnitude and colour errors as gaussian with sigmas as appropriate for current hst or high quality long integration ground - based observations .",
    "explicitly we used @xmath47\\ ] ] @xmath48\\ ] ] where @xmath49 is the magnitude , in the @xmath50 band , of the theoretical star , and @xmath51 its @xmath52 colour . at this point",
    "we can now produce a synthetic cmd , and for this first test obtain the 2009 points shown in figure [ fig01 ] .",
    "a magnitude cut at @xmath53 has been used , limiting analysis to stars brighter than this cutoff .",
    "given the highly correlated way in which star populate the main sequence , together with growing and sometimes divergent errors towards higher magnitudes , it is sufficient to restrict analysis to 2 magnitudes below the turn off region . in what follows",
    "we shall keep the 25 magnitude lower limit , although a changing magnitude cut as described above yields the same results .    at this point ,",
    "equation [ eq : merit ] can be used to obtain the likelihood function of the simulated cmd with respect to any given point on our 4-d parameter space .",
    "as discussed in section  2 , the seeking of the optimal point will be carried out through a genetic algorithm simulation , the workings of which , for this first example , we describe below .",
    "the upper left panel of figure [ fig02 ] shows the evolution of the value of the likelihood merit function of equation [ eq : merit ] over the first 100 generations of the genetic simulation .",
    "the horizontal line gives the value of this same function , evaluated at the actual point in our @xmath38 parameter space which was used to produce the synthetic cmd being inverted .",
    "this first panel shows an increase with the generation number of the optimal value of the likelihood function , as the absolute best point found in all the simulation up to a given generation is what is being plotted .",
    "this value increases very rapidly at first , as the initially random points begin to migrate towards regions more closely resembling the simulated cmd , but progress becomes increasingly slower .",
    "in fact , there is no definitive criterion to establish when a genetic algorithm simulation has finally converged , this has to be inferred from simulations with synthetic data and repeated experiments , as an approximate number of generations , suitable for a particular problem , after which no further improvement is achieved . for the problem",
    "being treated here , we have found the method stops yielding any improvement in the fits in general well before 3500 generations .",
    "we have thus ended the genetic simulations at 3500 generations .",
    "the value of the likelihood function evaluated at the actual input point always remains above the one corresponding to the optimal one found by the simulation for this first 100 generations shown here .",
    "the upper right panel of figure [ fig02 ] gives the evolution of the optimal time grid index ( ti ) along the isochrone grid , found up to a certain point . in this case",
    ", the input age of 13.9 gyr corresponds to our time index 159 out of 180 , over this initial 100 generation period the time index corresponding to the optimal model found fluctuates from an initial value of 120 to 178 , from 6 to 18 gyr , and ends this initial period 12 grid points above the input value , at 16.9 gyr .",
    "the bottom left and right panels show the corresponding evolution of the metallicity index and the distance modulus , again , the horizontal line gives the input parameters .",
    "we can see that after 2 generations the initially random values have approached significantly the input ones , and then show considerable variations of around 35 metallicity grid intervals ( 1.5 dex ) and 0.8 mag in the distance modulus .",
    "it is interesting to re - plot the left panel of figure [ fig02 ] this time over the entire 3500 generation range , this is done in the right panel of figure [ fig02 ] where we can see that substantial improvements in the optimal likelihood value found are still occurring after 1000 generations .",
    "a striking feature seen in the upper left panel of this last figure is that the genetic algorithm has actually found an optimal model which in fact yields a likelihood value above that of the input parameters . at around 1000 generations",
    ", the optimal likelihood found crosses the horizontal line giving the likelihood value of equation [ eq : merit ] of the input parameters , with respect to this particular realization of the cmd corresponding to them .",
    "this apparently paradoxical result is in fact unavoidable , and highlights the statistical nature of the problem .",
    "the construction of a cmd from a point in the single stellar population parameter space can not be thought of as neither a deterministic nor a unique process .",
    "even before the errors associated with procuring the observations enter the picture , the process of sampling an imf has already introduced a probabilistic ingredient intrinsic to the cluster itself ( _ e.g. _ cervio et al .",
    "2002 , cervio & valls - gabaud 2003 ) . in this sense , obtaining a single simulated cmd and using it to compare with an observed one can only be at best a crude first approximation to the inverting of a cmd . in this particular case ,",
    "the convolving of the theoretical stars with error gaussians has shifted the points around in such a way that the isochrone ( understood as a series of stellar evolutionary models , not just a curve on a cmd ) which has the greatest probability of having yielded the cmd is not the input one , but one which is one time grid interval above ( 0.2 gyr ) , 11 metallicity grid intervals below ( 0.4 dex ) and at a distance modulus around 0.05 magnitudes larger than the input parameters .",
    "the above result makes it clear that inferring structural parameters of stellar populations , even in the simplest cases , can not be attempted without a full consideration of the probabilistic nature of the problem , and also , can not give error - free results .",
    "however , it is possible to evaluate the intrinsic errors of the method , in connection to any particular implementation , by the monte carlo method .",
    "the experiment is repeated a large number of times , and the various answers analyzed to obtain mean inferred values with well determined dispersions and correlations .",
    "this method naturally takes into consideration all internal sources of error and dispersion inherent to the procedure being tested , and yields accurate and reliable confidence intervals on the inferences obtained .",
    "figure [ fig01 ] ( right ) shows with filled circles the input parameters of the cmd of figure [ fig01 ] and with empty ones the center of the distributions of the recovered parameters after the whole procedure of constructing a synthetic cmd and inverting it was repeated 20 times .",
    "the ellipses give projections of the error ellipsoid onto the different planes being shown .",
    "it can be seen that the only systematic which appears in this case beyond the @xmath54 level is an @xmath550.03 magnitude offset in the recovered values of the reddening for the cluster .",
    "all other parameters have been recovered with no systematics , the @xmath54 errors for this 13.9 gyr old cluster being 0.5 gyr in age , 0.38 dex in metallicity and 0.05 mag in the distance modulus .",
    "the isochrone corresponding to the solid circles is shown in figure [ fig01 ] by the thick solid curve , which practically lies above the thin ( red ) curve of the isochrone corresponding to the empty circles along all the cmd .",
    "some differences between the two isochrones are evident along the upper half of the red giant branch , where so few stars are expected , that none of the 2009 obtained in the cmd realization shown appear there .",
    "the dotted curves give the isochrones corresponding to the oldest and youngest points on the ellipse in the age - metallicity plane , which are seen to bracket the hr - gap and rgb regions of the cmd shown .",
    "the second example was constructed from point @xmath56 in our parameter space , taken to represent a typical old single stellar population ( ssp ) .",
    "in testing the method for systematics related to effects not explicitly included in the model , comparisons will be made at this point in parameter space , in section   4 .",
    "figure [ fig03 ] shows the cmd which results from convolving the modeled stars with the same simulated errors than last time .",
    "also shown are the isochrone from which the simulated stars were constructed , thick ( black ) curve , and the optimal one found by the genetic algorithm , thin continuous curve .",
    "the dotted curves give the oldest and youngest isochrones consistent with the monte carlo simulation on the inverting procedure at a @xmath54 level , this time spanning 1.2 gyr .",
    "analogous to figure [ fig01 ] , figure  [ fig03](right ) gives the projection of the error ellipsoid for the inferred parameters using the monte carlo method , projected onto 6 different planes .",
    "one again sees that there are no systematics beyond the @xmath54 level , from which we conclude that the method accurately recovers the input parameters of the cluster , and yields meaningful confidence intervals for the answer supplied .",
    "looking at the upper left panel of figure [ fig03 ] ( right ) we clearly see the actual intrinsic age - metallicity degeneracy in the way the @xmath54 ellipse in the ( @xmath40 ) plane slants from the upper left to the lower right .",
    "optimal fits with large ages tend to correspond to lower metallicities , and vice - versa . however , we see that having included all the information available both in the simulated cmd and in the theoretical isochrones minimizes this degeneracy and one obtains closed confidence intervals .",
    "if the cmd is reduced to , say two numbers , corresponding to the location of the turn off , when comparing to a similarly restrictive view of what the stellar evolutionary models encode , one ends up with a confidence region which spans an extensive region of the ( @xmath40 ) plane , merely a relation between the possible age and metallicity , with no way of restricting the answer to a narrower region .",
    "the above highlights problems inherent to methods where information is being discarded , to which must be added ambiguities associated to the definition of the turn off point .",
    "given the current high accuracy of the observations and the theoretical isochrones , inspection of simulated and observed cmds makes it clear that there is in fact no such thing as a turn off point , but rather a diffuse , hazy region which is prone to sampling fluctuations and the presence , or otherwise , of a few odd stars .",
    "other correlations are evident in figures [ fig01 ] and [ fig03 ] , for example a clear negative correlation between the inferred reddening and metallicity , also a generic feature of any stellar population inversion method , inherent to the structure of the isochrones .",
    "it is interesting to note in the lower 3 panels of figures [ fig01 ] and [ fig03 ] that the inferred distance to the cluster shows no strong correlations with any of the other 3 parameters , contrary to what happens when the isochrones are reduced to a set of numbers such as location of the turn off point , slope of the rgb etc .    for a third example , in trying to cover points on our parameter space representative of old ssps , we simulated an old , metal poor such system .",
    "starting from point @xmath57 we construct a series of cmds , one of which is shown in figure 4 , with curves analogous to what appears in figures 2 and 3 .",
    "it is impressive to see how nearly indistinguishable the shapes of the input and mean recovered isochrones are on the cmd , together with the isochrones corresponding to the oldest and youngest isochrone allowed by the monte carlo simulation at a @xmath54 level .",
    "all 4 of these curves appear practically on top of each other in this case , with very minor differences only apparent at the curvature between the hr gap region and the rgb .",
    "the above is particularly surprising when considering that the isochrones shown span almost a 1.5 gyr - long time interval . of course",
    ", the other parameters besides the age have been adjusted to maximize the fit when shifting the age , in accordance with the correlations shown in figure [ fig04 ] , the oldest isochrone has the lowest metallicity together with a somewhat above average reddening correction .",
    "this point again shows that the isochrones have to be treated as collections of full stellar evolution models , not reduced to a few scalar shape parameters , not even to simply shapes on the cmd .",
    "having used the full shape of the isochrones continuously throughout the full cmd , together with information regarding the duration of different stellar phases in constructing the merit function of equation [ eq : merit ] has allowed a much finer discrimination within our @xmath38 parameter space , much beyond what considering only the shape of the isochrones would have allowed .",
    "changing the input parameters of the isochrone even at a 2 - 3 sigma level , would result in curves compatible with the shape of the simulated stellar distribution , but which are ruled out due to having included all available information both in the cmd and the stellar models .",
    "again , no systematic offsets between the input values and the mean recovered ones appears beyond the @xmath54 level , as can be seen from figure [ fig04 ] . in this same figure",
    "we see the same correlations evident in the previous analogous figures , with the confidence intervals , particularly in age and metallicity having grown considerably in comparison to figure [ fig03 ] .",
    "this is obvious when one considers how consecutive isochrones equally spaced in time will show progressively smaller differences as the age of a stellar population increases .",
    "having left the assumed observational errors and stellar numbers constant , the uncertainties in the inferred parameters have grown in going to an old , metal poor population .    for the fourth and fifth examples we complete our sampling of ssps parameter space with two clusters at @xmath58 and @xmath59 .",
    "figures [ fig05 ] and [ fig06 ] are completely analogous to the corresponding previous figures and essentially illustrate the same points mentioned before . for these younger simulated stellar populations the mean recovered parameters appear within one grid interval in metallicity of the input parameters ,",
    "the theoretical maximum resolution of the implementation has been realized at these young ages , even after having considered realistic errors in magnitudes and colours .",
    "the age resolution is still above that of the isochrones , but robust @xmath54 errors of around 0.5 gyr are encouraging .",
    "we add that the precision of the method in recovering distance modulus and reddening parameters is sufficient to make it a useful tool in the determination of distances to single stellar populations , with errors sometimes as good as a few hundredths of a magnitude , as seen in figure [ fig05 ] .",
    "again , the correlations persist , although the details of these correlations change from example to example in ways that reflect the details of the isochrones around each region , and which are dependent on both the magnitude of the assumed observational errors and the actual numbers of stars present in the simulated cmds",
    ".    with simulated errors tending to zero the inferred parameters would tend to the input ones , to within the resolution of the isochrone grid used , always .",
    "also , if the statistical comparison between data and models is robust , the systematics and confidence intervals should tend to zero as the number of data points tends to infinity , which of course is never the case .",
    "having tested successfully the method across representative points in the @xmath38 space , we now turn to the problem of estimating how robust the inferences of our method will be in more realistic cases , where physical ingredients not explicitly considered in the statistical modeling behind equation [ eq : merit ] , and present in a real application , will complicate matters , and might result in systematic offsets between the actual physical parameters of a stellar population and our inferences .    in this section",
    "we explore such cases by constructing synthetic cmds under assumptions different to the ones the method uses in the inversion procedure , and compare how serious these effects are in altering our inferences",
    ". the 5 effects considered will be : ( 1 ) errors in the assumed imf , ( 2 ) the presence of unresolved binaries , ( 3 ) the effects of reducing the numbers of stars present in the observed cmd , ( 4 ) systematics associated with the different sets of stellar tracks used in constructing the isochrone grids , and ( 5 ) the presence of contaminating stars in the observed cmds .",
    "figure [ fig07 ] gives a cmd resulting from the same point in parameter space as figure [ fig03 ] , @xmath56 , but created this time using a substantially different imf , heavily weighted towards massive stars , increasing the slope with respect to the kroupa et al .",
    "( 1993 ) imf such that the typical stellar mass increases by a factor of 3 . obtaining the same number of points",
    "thus requires turning a much larger total mass into stars , but under the assumption of an equal number of stars as in figure [ fig03 ] , the results are highly similar .",
    "the precise manner in which the density of stars varies along the main sequence region is somewhat different from the case of figure [ fig03 ] , but given the highly correlated manner in which magnitudes and colours scale along this region , the information content of the cmd is only marginally altered .",
    "the highly determinant sections beyond the main sequence span such a small mass range that all of these features are virtually left unchanged by even the strongest modifications in the imf .",
    "the inversion procedure was repeated 20 times , but assuming the same imf as in figure [ fig03 ] , which in this case no longer corresponded to the imf used to create the synthetic cmds .",
    "the results of the monte carlo procedure can be seen in figure [ fig07 ] , which from the previous discussions would not have been expected to show any substantial difference to figure [ fig03 ] , as is indeed the case . by comparing with figure [ fig03 ]",
    "we note no substantial differences , all inferred parameters are well within the @xmath54 error estimates , with very low uncertainties of around 0.5 gyr in age , 0.2 dex in metallicity , 0.01 and 0.05 mag in reddening and distance modulus , respectively .",
    "the isochrones corresponding to the input , inferred , and oldest and youngest values recovered ( at a @xmath54 level ) , practically overlap over the entire region over which significant numbers of stars are found .",
    "we see that the theoretical expectations of the previous sections are borne out , and our results are in fact highly robust to even large scale features of the imf .",
    "this is reassuring from the point of view of inferring ages , metallicities , distances and reddening corrections of resolved stellar populations , but disheartening from that of inferring the imf of observed stellar clusters through methods similar to what has been developed here .",
    "the second test was performed again using the same isochrone library , and the input point @xmath56 of figure [ fig03 ] , but this time to one in two of the simulated stars we added an unresolved companion , chosen from the same imf , _",
    "i.e. _ , the synthetic cmd was produced assuming a 50% unresolved binary contribution .",
    "the inversion procedure was however exactly the same as in the previous cases , with equation [ eq : merit ] remaining unchanged , a binary fraction of 0% was assumed in recovering the inferred parameters .",
    "one of the resulting cmds which was used in the monte carlo procedure for the inversion is shown in figure [ fig08 ] , together with isochrones as in the previous figures .",
    "the presence of 50% binaries is particularly conspicuous along the main sequence , where the distribution of points is clearly smeared towards redder colours , evident when comparing , for example , with figure [ fig07 ] .",
    "a few binaries can also be seen around the critical turn off region , but these have had little effect .",
    "given the large difference in luminosity between a rgb star and any main sequence one ( the most likely secondary to be added to a binary ) , binary pollution along the rgb produces absolutely no effects .    by looking at the best",
    "fit inferred isochrones at the base of the main sequence , it can be seen that these have all shifted towards the right , in response to the weighting of the distribution of points towards this direction . by looking at figure",
    "[ fig08 ] one can see that this shift towards the right has been achieved optimally by the genetic algorithm not by altering the reddening correction , but rather through an offset in the distance modulus .",
    "whilst inferred age , metallicity and reddening parameters have been obtained within the @xmath54 error ellipses , the inferred distance modulus is off at around a @xmath60 level , which however corresponds only to 0.15 magnitudes .",
    "the clearest correlation between the inferred parameters is still in the age - metallicity plane , and remains in the same sense as expected .",
    "other than the slight offset in inferred distance modulus , the only other effect of having introduced a relatively high binary population has been the broadening of the errors .",
    "the confidence region is this time 2.5 gyr across , compared to 1.4 gyr for figure [ fig03 ] .",
    "again , the isochrones in figure [ fig08 ] are remarkably close to each other , but although regions beyond the turn off have not been much affected by the inclusion of the binaries , the fact that the main sequence has shifted out of correspondence with these other regions has resulted in poorer fits , and although no systematic offsets in age , metallicity or reddening correction have appeared , the error ellipses have certainly increased in size .",
    "the particular case of blue stragglers has not been treated , but a good approximation can be obtained from the binary contamination example included . binaries and blue stragglers can populate the region close to the turn off , and result in poorer fits .",
    "however , having weighted all the cmd equally , the much larger main sequence population , and the phases beyond the turn off , where errors are much smaller , anchor to a large extent the fit against a small number of blue stragglers or binaries very close to the turn off . more than 2 local error sigma away from the turn off , you can fill in almost any number of blue stragglers , by construction their effect will be negligible , see eq .",
    "[ eq : g ] .    in the context of inverting resolved stellar populations , a binary does not necessarily imply a physical gravitational association between two stars , but merely that the light of two individual stars has appeared in the data as coming from a single point .",
    "the two stars hence show as a single one having the total luminosity of the sum for the two stars , and an effective temperature being the energy weighted sum of the temperatures of the two stars , as per a stefan - boltzmann law .",
    "therefore , especially if thinking of dense systems such as globular clusters where crowding effects can be dominant , the adoption of the same imf for the secondary component of the binary as for the primary one is justified .",
    "we now turn to a possibly important systematic , related to the validity of the underlying hypothesis that a single real star from an observed cmd does in fact behave and evolve as the stellar evolutionary code one is using to construct an isochrone grid assumes it to .",
    "figure [ fig09 ] gives the cmd produced again from the same point @xmath56 in parameter space , but using this time the padova stellar evolutionary models ( girardi et al .",
    "2002 ) , whilst in all previous examples , the yale isochrones where used ( demarque et al .",
    "the distribution of stars on the magnitude - colour plane is much the same as in figure [ fig03 ] , and no significant differences can be detected .    a number of such cmds where then inverted using the yale isochrones , resulting in the error ellipsoid whose projections onto the 6 usual planes is shown in figure [ fig09 ] .",
    "the most immediate conclusion is that changing the stellar models has resulted in no systematics beyond the @xmath54 level , beyond a slight offset in the recovered reddening correction of around 0.02 magnitudes .",
    "asides from the above , comparing with figure [ fig03 ] we note that using a wrong isochrone grid in the inversion procedure has resulted in slightly poorer fits , evident in larger error bars on the recovered parameters , the extremes of the @xmath54 confidence interval now span close to 2.0 gyr , as opposed to only 1.2 gyr when the same isochrone set was used to construct the cmds and to invert them .",
    "this has been due to the details of the stellar evolutionary code in terms of the differential duration of stellar phases , more than to changes in the isochrones as plotted on the cmds . in this particular case ,",
    "the error ranges for the metallicity have grown by a larger fraction than the others . however , this is not a general feature of changing the isochrone set , but something which depends on the errors , no . of stars considered ,",
    "actual age , distance and metallicity of the ssp being studied .",
    "regarding the error ranges , the examples we have shown are only illustrative , and trustworthy error ranges have to be internally calculated for each particular case .    note also that these different sets of isochrones use different calibrations to go from the theoretical diagram to the observed ones in the different sets of filters .",
    "this is perhaps the largest source of uncertainty at this level ( vandenberg 2007 ) for this range of masses and ages .",
    "all the isochrones throughout have been used only up to the tip of the rgb , with regions beyond which give rise to interesting red clump morphologies , having been excluded from the analysis .",
    "even though inclusion of these phases , for example the hb region , would provide interesting independent restrictions and potentially enhance the effectiveness of the method , at present post helium flash regions have to be modeled through the inclusion of rgb mass loss rate recipes which can not yet be calculated or constrained from first principles .",
    "thus , their inclusion would necessarily imply obtaining inferences which would be limited to the validity of the currently poorly grounded hypotheses one would chose regarding late stellar evolution .",
    "perhaps we can not conclude that stellar evolutionary modeling has converged to a final solution , even below the helium flash .",
    "however , by using broad band colours , where integration over relatively wide sections of a stellar spectrum is included , an averaging over details in fine features , and by restricting the analysis to stellar phases which are well understood , a method such as what we have implemented here is now capable of yielding results which are highly robust with regards to the current discussions and disagreements over stellar evolution .    certainly in going from figure [ fig03 ] to figure 9 the error ranges",
    "have increased , but the inferences correctly identify ages , metallicities and distances to within internally computed confidence intervals . in future , it would be desirable to use stellar evolutionary models more extensively , including phases beyond the helium flash , to yield much more restrictive inferences and narrow error ranges , but whilst debate rages over the physics of stars in those regions , we prefer to increase the size of both our error ranges and our confidence in the final results . the same applies to the use of more detailed features of stellar spectra , in going from broad band colours to narrow band colours and finally details of the emission line structure , more information is encoded , the potential of more refined inferences is there , but at least until the different models converge , inferences using such details should be considered as subject to short term revision .",
    "as remarked previously , the numbers of stars in an observed cmd and the size of the observational errors dispersing the stars from their intrinsic locations all influence the quality of the inferences which can be obtained .",
    "figure [ fig10 ] is analogous to figure [ fig03 ] , the same point in parameter space has been modeled , with the same errors , but the number of stars has been reduced in half , of the @xmath61 stars simulated in all previous examples , only @xmath62 where simulated this time .",
    "we see from figure [ fig10 ] that no systematics appear , and that even with only @xmath62 stars , a number easily achievable in current observations of galactic single stellar populations , the recovered parameters are all within the @xmath54 error ellipses of the input ones . by comparing with figure [ fig03 ]",
    "we do note that again , as in the two previous experiments , the confidence intervals have grown considerably , a similar trend is seen if the assumed observational errors are increased .",
    "the cmd of figure [ fig10 ] is clearly much more thinly populated than previous ones , but still the method manages to recover isochrones that do not differ much in their parameters from the input ones .",
    "[ cols=\"<,^,^,<,^,<,<,<\",options=\"header \" , ]     @xmath63 the input distance modulus was kept at 18.80 mag in all cases .",
    "+ @xmath64 the input reddening was kept at 0.05 mag in all tests .        as a final test of systematics which surely apply to the use of real data , we present figure [ fig11 ] , where a fraction of 60% ( by number ) of polluting stars have been added to the cmds , also produced from the same parameters as the previous tests .",
    "the presence of polluting stars is evident in figure [ fig11 ] where the area in the cmd which is taken into account in the analysis is clearly seen to have been filled with contaminating stars . to make this example as realistic as possible ,",
    "we have modeled the contamination produced by field stars using the besanon model of the galaxy ( robin et al .",
    "we simulated a field of one square degree along the direction @xmath65 so that a significant contribution by the thin and thick discs is present .",
    "the errors which we have assumed apply to the polluting points are the same as the average for the actual observed stars at a given luminosity . from the 87000 simulated stars along that direction , we extracted a random sample of size 1200 to simulate a severe contamination of 60 % with respect to the number of stars in the cmd of the simulated cluster .",
    "this contamination appears in the cmd as an essentially constant density addition of random stars , as the typical scales over which variations appear in the besanon model in both colour and magnitude , are larger than the domains of figure  [ fig11 ] .    from the integral over the model isochrone",
    "being compared to the data shown in equation [ eq : gint ] , and from the form of @xmath36 of equation [ eq : g ] , it is obvious that a given star will only contribute significantly to @xmath66 for isochrones passing within 1 - 2 @xmath67 of it .",
    "the convolution of the error gaussian which maps the model stars onto the cmd and the error gaussian for an observed star converges quickly within a distance of @xmath60 of either .",
    "this means that features not yet well modeled by the theoretical stellar models , but which fall directly on the isochrones , such as the red giant branch bump morphology seen in luminosity functions of rgbs , will not have any effect at all on our inferences .",
    "the cmds we have modelled do not have sufficient stars to properly allow us to identify any red giant branch bump , however , this feature is a second order effect the paucity of which , together with the fact that it does not move stars out of the isochrone , and only slightly changes the details of the density of points along it , that make the method robust against it .",
    "the uncertainties in our inferences due to the level of observational errors are already much larger than anything theoretical red giant branch bump uncertainties might introduce .",
    "similarly , the presence of a small number of blue stragglers will tend to bias the estimation , but given that their number is small in comparison with all the other stars which lie along the tentative isochrone , they do not bias the final estimate .",
    "the above discussion leads us to expect that the method we have constructed should be highly robust against the presence of contaminating stars , as indeed can be concluded from figure [ fig11 ] , where the resulting error ellipses for this experiment are shown .",
    "we can see that although the errors have increased , all inferred parameters are practically within @xmath54 error ellipses of the input ones .",
    "some inferences are more affected than others , for example , the error in the age determination has nearly doubled when compared to figure [ fig03 ] , but the one in the reddening correction has hardly changed .",
    "this result holds even for large polluting fractions than what is being simulated , and in fact suggests that the method can be applied to the identification of stellar populations in fields crowded by foreground and background contamination .",
    "the method is however sensitive to polluting stars occurring systematically close to critical regions of the isochrones , e.g. a sequence slightly off to one side of the rgb corresponding to the observed main sequence , essentially equivalent to having used grossly mistaken stellar tracks .",
    "the precise effect of foreground / background contamination will in fact depend on the details of the ssp being studied , @xmath5 parameters , numbers of stars and observational errors , and location of contaminating stars .",
    "the final monte carlo assessment of the confidence intervals must hence also include a modeling of the fields contamination , in order to yield meaningful results .",
    "lastly , as a summary of these last 2 sections we present table 1 , where all the synthetic cases we have treated are given . the values for @xmath5 in the table give the input parameters , followed by the recovered ones with the corresponding 1 sigma error ranges .",
    "in this final section we present an example of the workings of the method , using data from an observed ssp , where in a sense , all possible systematics are at work . of the 7263 stars observed by rosenberg et al .",
    "( 2000 ) for the globular cluster ngc  3201 , we take the 5197 stars brighter than @xmath68 , together with the corresponding error estimates , and use them as inputs for the method .",
    "the value of the magnitude cut used for this example was chosen so that the example should be comparable to the synthetic cases treated previously , where a lower cut of 2 magnitudes below the turn off was consistently assumed .",
    "this value guarantees the level of accuracy seen in the synthetic examples , and is designed to exclude the lower main sequence , where incompleteness begins to enter the data . in this particular case ,",
    "the completeness limit given by the observations lies below the lower limit we take .",
    "also , the discarded region is one of inherent low information content ( see discussion following equation  [ eq2 ] ) . by construction",
    ", the method assumes the observations are complete down to the lower limit included . if one is forced to cut the cmd closer to the turn off region , the quality of the fit is reduced , with growing error ellipses .",
    "inclusion of regions beyond the completeness limit will result in formal error ranges which can appear smaller , but violation of the hypothesis of completeness will result in unreliable inferences .        in general , the choice in the details of any implementation will depend on the robustness of the available data and theoretical models .",
    "one would expect that with time , stellar modeling will improve to the point of making more reliable predictions , not only for very young stellar populations , but also for stellar phases beyond the helium flash , perhaps even into the white dwarf cooling sequence , and including all the currently poorly understood features like blue stragglers and horizontal branch . at that point",
    ", the implementation can be trivially updated by simply changing the range of masses considered along the theoretical isochrone , yielding more accurate and restrictive inferences . on the observational side ,",
    "when for example gaia data are available , the effectiveness of the implementation can be improved by including stars further down along the main sequence , to result in improved metallicity and reddening corrections .",
    "the actual stars for this cluster appear in the left panel of figure [ fig12 ] , together with the best fit isochrone found by the method , using the yale isochrones , changing the isochrone set , yields results only marginally different .",
    "this is clearly seen to be a good fit , obtained this time through a completely automatic and objective procedure , maximizing use of information both from the data and from the stellar models with which the data was compared .",
    "the basic parameters associated to this best fitting isochrone , together with their 1-@xmath69 confidence intervals are : @xmath70 gyr , @xmath71 , @xmath72 mag , and e(v - i)@xmath73 mag , and are shown in the right panel of figure [ fig12 ] . as in the previous examples , the method returns not only best fit values and associated statistically robust confidence intervals , but also the full covariance structure of the inference , as shown in figure [ fig12 ] .",
    "we see the 1-@xmath69 confidence ellipse in the @xmath35 plane slanting as expected from the age - metallicity degeneracy , but again , almost no correlation in the @xmath74 plane . again , when moving along the correlations in the recovered parameters , we see that the maximum and minimum age isochrones , at the 1-@xmath69 level , dotted curves , are practically indistinguishable from each other , or from the the best fit one , based only on shape . the three solid dots in figure [ fig12 ]",
    "give the center of our inferences , for three different values of the [ @xmath75/fe ] enhancement parameter , 0.0 , + 0.3 and + 0.6 , a final systematic , which also has little effect abundance into a metallicity . ] .",
    "the isochrones shown are only for the alpha enhancement of 0.0 , as the inclusion of the corresponding isochrones for the other two values would only result in a complete overlapping of curves , all within the region defined by the oldest and youngest isochrones at [ @xmath75/fe ] = 0.0 shown .",
    "the resolution of the method , as mentioned earlier , is much enhanced from a simple geometric fitting of isochrones by having included the duration of evolutionary phases explicitly in the merit function being used .",
    "confidence intervals similar to the case of figure [ fig11 ] are the result of the large number of stars available above the lower magnitude cut .        for comparison , in the globular cluster compilation by harris ( 1996 )",
    ", ngc  3201 is listed as having @xmath76 mag , e(b - v ) = @xmath77 mag ( which translates into e(v - i)=0.25 ) , and a metallicity of @xmath78 , with no confidence intervals for any of the above .",
    "the more recent salaris & weiss ( 2002 ) report an age for this cluster of @xmath79 gyr , kraft & ivans ( 2003 ) quote a metalicity of between @xmath80 and @xmath81 , taking the extremes of all the possibilities they give , for different red giant spectral metalicity determinations and a solar value of @xmath82 .",
    "rosenberg et al . ( 2000 ) give a value for the apparent @xmath83 mag , with no estimates of the associated confidence intervals .",
    "recent determinations of the reddening towards this field include salaris & cassisi ( 1998 ) giving e(b - v ) = @xmath84 mag ( which translates into e(v - i)=0.29 @xmath85 ) , and piersimoni et al .",
    "( 2002 ) giving e(v - i)=@xmath86 mag , which compares very well with our measure of e(v - i)=r=@xmath87 .",
    "this results in a distance modulus of @xmath88e(v - i ) = 13.38@xmath890.1 , which agrees with the determination of piersimoni et al .",
    "( 2002 ) of @xmath90 mag based on rr lyr stars in the cluster .",
    "the crosses in figure [ fig12 ] summarize the independent determination for the parameters of ngc  3201 which we treated , as discussed in the text above .",
    "overall , comparing our results for ngc  3201 with independent determinations from the literature , we find very good agreement within the uncertainties of the different determinations , and we notice that our results have typically more restrictive confidence intervals .",
    "we see that in spite of the absence of evolutionary phases beyond the helium flash in the models we used , the fit is robust and yields good results .",
    "the presence of a level of contamination and a horizontal branch , lead to larger error ellipses than in the controlled experiments of previous sections , but no evidently wrong systematics are apparent , we conclude no large systematics remain",
    ". the lower region of the cmd appears more poorly fitted , a consequence of having only considered stars brighter than @xmath68 in the fitting procedure .",
    "these lower regions of the cmd however , are heavily affected by incompleteness and very large observational errors , requiring , in the context of the method used , their exclusion .",
    "this results can be seen as an overall validation of the method , as metalicities , distances and reddening corrections reported by the authors cited where often derived through methods completely independent to the stellar evolution model comparisons we have performed here .",
    "we find that in going to real data , the expectations of the previous sections hold , and we are able to obtain a best fit solution which is clearly a good solution , the resulting isochrone is a good match to the observed stars , and the values for the @xmath5 vector obtained match well with completely independent determinations found in the literature .",
    "the fit is of course not perfect , and inconsistencies between stellar models and reality undoubtedly remain , even below the turn off region , where available stellar models largely agree with each other .",
    "however , the full agreement between our inferences and those derived through completely independent physical and astronomical methods noted above , show that no systematics are being introduced by the remaining inadequacies of stellar evolutionary codes , at least not beyond the confidence intervals internally calculated by the method .    the comparison of results obtained with our method against accurate independent determinations of metalicities through spectroscopy , or distances through future parallax measurements ,",
    "could hence be used to check stellar evolution theory .",
    "we have presented a method which treats the inference of structural parameters of single stellar populations in a fully rigorous statistical manner , within a bayesian approach , to construct a merit function for the comparison of an observed cmd in relation to a point in the 4-d parameter space of age , metallicity , distance modulus and reddening .    implementing a genetic algorithm simulation we have shown through various examples using synthetic cmds with parameters as appropriate for current observations of galactic single stellar populations , that the method accurately recovers the input parameters , and yields reliable confidence intervals , including naturally an analysis of the covariances and correlations between the recovered parameters .    by performing extensive monte carlo experiments with systematic effects , which surely apply to real cases and which are explicitly excluded from the formalism presented ,",
    "we have evaluated the consequences these effects are expected to have on the results of our method .",
    "we found that although the error ranges on the recovered parameters typically increase , no systematic offsets appear , at least within the reasonable ranges tested .",
    "this implies that our formalism , which explicitly takes into account the number density of stars along isochrones , can tentatively test stellar evolution models when using clusters with well - measured abundances , distances and reddenings .",
    "this , along with the absolute dating of clusters with precise photometry , will be presented in the second paper of this series ( valls  gabaud & hernandez 2007 ) .",
    "the authors wish to thank the padova , yale - yonsei and victoria stellar evolution groups for assistance and discussions on the use of their isochrones , and sharing material in advance of publication .",
    "the authors wish to thank a second anonymous referee for helpful comments which improved the final version of the manuscript .",
    "x.h . acknowledges the support of grants unam dgapa ( in117803 - 3 ) , conacyt ( 42809/a-1 ) and conacyt ( 42748 ) during the development of this work .",
    "this work was supported by a joint cnrs - conacyt grant ."
  ],
  "abstract_text": [
    "<S> the colour - magnitude diagrams of resolved single stellar populations , such as open and globular clusters , have provided the best natural laboratories to test stellar evolution theory . whilst a variety of techniques have been used to infer </S>",
    "<S> the basic properties of these simple populations , systematic uncertainties arise from the purely geometrical degeneracy produced by the similar shape of isochrones of different ages and metallicities . here </S>",
    "<S> we present an objective and robust statistical technique which lifts this degeneracy to a great extent through the use of a key observable : the number of stars along the isochrone . through extensive monte carlo simulations </S>",
    "<S> we show that , for instance , we can infer the four main parameters ( age , metallicity , distance and reddening ) in an objective way , along with robust confidence intervals and their full covariance matrix . </S>",
    "<S> we show that systematic uncertainties due to field contamination , unresolved binaries , initial or present - day stellar mass function are either negligible or well under control . </S>",
    "<S> this technique provides , for the first time , a proper way to infer with unprecedented accuracy the fundamental properties of simple stellar populations , in an easy - to - implement algorithm .    </S>",
    "<S> [ firstpage ]    methods : statistical  stars : statistics  globular clusters : general  open clusters and associations : general  galaxy : stellar content </S>"
  ]
}