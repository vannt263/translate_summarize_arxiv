{
  "article_text": [
    "understanding the dense packings of hard particles has yielded essential insights into the structure of materials @xcite , granular media @xcite , number theory @xcite , biology @xcite , and computer science @xcite .",
    "this understanding has been hard won : hundreds of years can elapse between a conjecture and its proof .",
    "this is best exemplified by sphere packing , for which a proof kepler s conjecture had not been found until 1998 @xcite .",
    "recent experimental advances have allowed the development of ( nearly ) hard colloids that , for entropic reasons , manifest the densest sphere packing @xcite .",
    "the attempt to obtain a deep understanding of liquid crystal mesophases has prompted study of the dense packing of anisotropic particles .",
    "this has led to recent explorations of the packing of ellipsoids @xcite , polyhedra @xcite , and polygons @xcite .",
    "one of the simplest regular polygons one can pack in two dimensions is the square . on the plane ,",
    "the densest packing is , in this case , trivial  a square lattice of squares .",
    "monte carlo simulations of squares at finite pressure , however , have also found a tetratic phase @xcite , and experiments with hard colloidal squares have found , rather than the tetratic phase , a rhombic crystal having a different symmetry than the square @xcite .",
    "even the dense packing of a finite number of squares can be more complicated than naive considerations would indicate  in fact , the problem of packing squares in another square has been shown to be np - hard @xcite . indeed , the densest known packings can be quite complex @xcite when the number of squares is not a perfect square integer .",
    "higher packing densities than that of a simple , square lattice with vacancies can be achieved through configurations in which some of the squares are rotated and shifted with respect to the square lattice @xcite .    what is the effect of an external potential on packings of hard objects ?",
    "one example of an external potential is fixed boundary conditions .",
    "considerable effort has been devoted to understanding the densest packings of squares and circles in various domains .",
    "another example with greater physical application is an external periodic potential .",
    "if this potential is strong enough , the packing of the hard objects may be forced to be adopt the periodicity of the potential , and new packings are expected to arise . a limiting case of an imposed periodic potential is periodic boundary conditions . in this paper",
    "we explore the densest configurations of hard squares in a torus  that is , inside a larger square with periodic boundary conditions . even with the additional translation symmetry afforded by packing squares in a torus rather than in a square , the resulting dense packings in the torus can still be far from simple .",
    "our results may have experimental relevance for hard square colloidal particles in a periodic potential imposed either by a substrate or an optical lattice .",
    "as in many other mathematical packing problems , the strategy here is to search for the smallest area torus that can accommodate a fixed number of squares @xmath0 .",
    "we use a combination of analytic and monte carlo simulated annealing techniques to accomplish this , and our results can be summarized as follows : we find that whenever @xmath0 can be expressed as the sum of two square integers ",
    "@xmath4  the densest possible configuration is a density - one packing with squares arranged in rows that are oriented at an angle of tan@xmath5 relative to the underlying torus . for other @xmath0",
    ", we find a surprisingly rich collection of dense packing structures . for @xmath0",
    "= 6,11,14 , and 27 , we believe that the densest possible packing is a commensurate bravais lattice packing with density @xmath1 and resembles a bricklayer pattern with periodic gaps . for @xmath6 12,21,22 and 23 , we find that the densest configurations are non - bravais lattice packings , including both regular lattices of holes and of rotated squares .",
    "these results are summarized the table within section ii .    in section",
    "ii , we present a summary analysis of the various structures we found for @xmath0 up to 27 , including both commensurate bravais lattice solutions and non - bravais lattice solutions .",
    "the packing motifs we found through analytic and numerical means are illustrated in this section via drawn figures as well as images generated by our numerical simulations . in section iii , we provide details of our numerical experiments for the hard square system .",
    "section iv is a discussion of our results , including an analysis of the entropy of densest packings , and the rotational invariance of density - one packings as @xmath0 goes to infinity .",
    "in this section we give an analytic treatment of square packings on a torus .",
    "we first describe a set of solutions in which the squares lie on a bravais lattice , and then turn to more complicated cases .",
    "the density - one solutions are optimal by construction , and all of the other solutions are conjectured to be optimal .",
    "the numerical results of sec . [ sec : numerical ] guided us to the conjectured solutions , and the fact that long simulated annealing runs consistently produced these solutions gives us some confidence that they are optimal .",
    "our conjectures for configurations containing @xmath7 squares are summarized in the table .      here",
    "we consider a class of bravais lattice configurations that includes all of the density - one packings and other solutions we have found for @xmath7 . in all of these packings , the squares are lined up in rows ; and for the purposes of this analysis , we assume that these rows are aligned along the x - axis .",
    "thus , one of the primitive vectors of the lattice of squares is @xmath8 , and the second primitive vector is taken to have the form @xmath9 , with @xmath10 and @xmath11 .",
    "note that the primitive vectors of the torus , @xmath12 and @xmath13 , need not be aligned with the primitive vectors of the squares .",
    "the requirement that the squares pack periodically on the torus is equivalent to saying that the lattice of squares is commensurate with the larger square lattice of the torus .",
    "that is , there exist integers @xmath14 , @xmath15 , @xmath16 and @xmath17 such that the torus primitive vectors @xmath12 and @xmath13 are given by @xmath18 in addition , we require that the torus primitive vectors are of equal length , @xmath19    these conditions are uniquely solved by @xmath20 the number of squares @xmath0 packed on the torus is the number of lattice points of the square lattice in a unit cell of the torus lattice @xmath21 and the areal density of the squares @xmath22 is given by @xmath23      there are two classes of density - one packings .",
    "the first is the perfect square packing , for which @xmath24 , @xmath25 , @xmath26 and @xmath27 .",
    "this simple packing is shown in fig .",
    "[ fig : n9 ] for the case of @xmath28 .",
    "note that , on the torus , each of the @xmath14 rows ( or columns , but not both ) may be arbitrarily displaced relative to the other rows ( columns ) without disturbing the density of the packing or its periodicity ; the perfect square packings thus have finite entropy .",
    "[ fig : n9 ]    there is a more general class of density - one packings , in which the lattice of squares may be tilted with respect to the primitive vectors of the torus . setting @xmath25 and @xmath24 in eq .",
    "( [ eq : gap ] ) , we find @xmath29 , @xmath30 , and @xmath31 , the square lattice being oriented at an angle of @xmath32 relative to the torus lattice vectors",
    ". clearly , these density - one , tilted square lattice solutions are optimal for all @xmath0 that are sums of two square integers .",
    "note that the perfect square solution corresponds to the special case @xmath33 .",
    "[ fig : bravais ] shows the case @xmath34 ( @xmath35 and @xmath36 ) .",
    "we thus find that if n is the sum of two squares , there exists a density - one packing .",
    "the converse of this is also true : @xmath0 is a sum of two squares for all density - one packings of squares in the torus . to prove this",
    ", first note that every square in a density - one packing must have at least four other squares bordering it along a finite segment length , forcing all @xmath0 squares to share the same orientation .",
    "now consider three squares in mutual contact with each other  a configuration that must exist if the packing has no gaps .",
    "two of those squares must be aligned in a row , as shown in fig .",
    "[ fig : aligned ] . in order to eliminate gaps in the packing ,",
    "these three squares define a set of rows that the entire packing must respect .",
    "note that periodic boundary conditions allows us to draw the torus vectors so that they begin on the corner of a square and end on the corresponding corner of another square .",
    "thus , @xmath15 and @xmath17 are both integers .",
    "a right triangle can be constructed with @xmath15 as one side and @xmath37 as its hypotenuse ; another right triangle can be drawn with @xmath17 as its base , and @xmath38 as its hypotenuse .",
    "( see fig .",
    "[ fig : aligned ] ) .",
    "these triangles are identical by inspection . @xmath39 and @xmath40 are therfore each equal to @xmath41 , via the pythogorean theorem .      the simplest way to produce candidates for a densest packing for @xmath42 is to remove @xmath43 squares from a density - one packing ; indeed , our numerical results suggest that for several values of @xmath0 , the densest packing is a density - one packing with one missing square .",
    "this is indicated in the comment column in the table using the notation @xmath44 or @xmath45 , depending on whether they are generated by removing @xmath46 square from @xmath0 a square integer , or a sum of two square integers respectively . as is demonstrated in fig .",
    "[ fig : n7 ] for the case of @xmath47 , such vacancies allow for continuous displacement of other squares within a row , leading to a finite entropy for such configurations .",
    "other examples include @xmath48 and @xmath49 .",
    "next we consider bravais lattice solutions that have density less than one  that is , packings with gap @xmath50 . because these solutions have rows that are shifted relative to one another ( @xmath51 ) , we call these `` gapped bricklayer configurations . ''",
    "an example is shown in fig .",
    "[ fig : gb](a ) . equations ( [ eq : gap ] ) allow us to ennumerate all gapped bricklayer configurations .",
    "since the packing density of these configurations is @xmath52 , the highest packing density we can find within this class of configurations with density less than unity must have the form @xmath53 .",
    "this requires that @xmath0 be one more than a sum of two squares .",
    "the first several are gapped bricklayer configurations are seen for @xmath6 2,3,6,11,14,18,26 , and 27 .",
    "based on the numerics we believe that for @xmath54 , 11 , 14 and 27 , the gapped bricklayer packing is the densest possible packing .",
    "these are indicated in the table with the abbreviation `` gb '' in the comment column .",
    "associated ( non - unique ) lattice vectors are shown in the rightmost columns of the table for the gb packings .",
    "there are also gapped bricklayer solutions for density @xmath55 when @xmath0 is two more than a sum of two squares , though we have not found any candidate densest packing solutions of this form for @xmath7 .",
    "unlike the bravais lattice packings with density one , different rows of the gapped bricklayer solutions have a fixed shift given by @xmath56 , where the denominator is the closest sum of two squares below @xmath0 .      here",
    ", we consider special cases suggested by our numerical simulations that do not correspond to bravais lattice packings .",
    "note : if the comment column of the table simply repeats a value of @xmath0 , it indicates a special case for which the squares are not on a bravais lattice and for which there is not an obvious pattern that can be extrapolated easily to optimal packings for higher values of @xmath0 .      the conjectured best packing for @xmath57 is shown in fig . [ fig : n22 ] .",
    "this packing is in fact a gapped bricklayer configuration , except that the unit cell or brick is composed of two squares stacked in the @xmath58 direction ( the direction perpendicular to the rows ) .",
    "the configuration is otherwise identical to the @xmath59 gapped bricklayer and has density @xmath60 .",
    "the conjectured best configurations for @xmath62 and 23 are shown in figs .",
    "[ fig : n12 ] and [ fig : n23 ] , respectively . in both cases",
    "the motif can be described as a lattice of @xmath61 holes .",
    "the torus lattice vectors , eq .  [ eqn : ana ] with @xmath8 and @xmath64 , for @xmath62 are described by @xmath65 and the torus lattice vectors for @xmath2 are described by @xmath66 , and @xmath67 .",
    "it is straightforward to verify that these motifs are in fact packings on the torus and have the density @xmath68 where @xmath43 is the number of holes in the unit cell . for @xmath62 , evidently @xmath69 and for @xmath2 , @xmath70 .      the conjectured densest packing for @xmath71 , shown in fig .  [ fig : n21 ] ,",
    "does not follow any of the motifs described heretofore .",
    "the unit cell consists of a @xmath72 square with motif of 5 squares attached to its side .",
    "this 5-square pattern is also the best packing of 5 squares in a square @xcite .",
    "a simple calculation yields the density , @xmath73 .",
    "this packing has one square per unit cell tilted at 45@xmath74 relative to all other squares .",
    "this is the only example that we found for which not all of the squares in the motif are oriented in the same way .",
    "it was also the most difficult configuration for our simulated annealing algorithm to find .",
    "figure [ fig : n21 ] shows a typical simulation result , which clearly has not yet fully converged .      to summarize : the perfect square , sum of two squares and gapped bricklayer configurations cover most of the case we have found for @xmath7 .",
    "the table gives densest packing configurations ( if @xmath75 ) and conjectured densest packing configurations ( if @xmath76 ) , for each value of @xmath0 less than 28 .",
    "the column `` @xmath22 '' is the density of the configuration .",
    "the comment column describes the type of lattice .",
    "for example , @xmath77 indicates a perfect square and @xmath78 indicates a perfect square with one square missing .",
    "similarly @xmath79 refers to the sum of two squares and `` gb '' stands for `` gapped bricklayer . ''",
    "if a single number is in the comment column it refers to one of the special cases discussed above .",
    "the four columns `` @xmath14 , @xmath15 , @xmath16 , @xmath17 '' are shown if the configuration of squares is itself a bravais lattice ; these integers are the coefficients of the lattice vectors of the torus , in terms of the lattice vectors of the squares as defined in eq .",
    "( [ eqn : ana ] ) .",
    "only those columns needed to specify the lattice are filled in .",
    "[ table ]    .exact and conjectured densest packed configurations of squares on a torus .",
    "refer to the text for the meaning of the columns .",
    "[ cols=\"^,^,^,^,^,>,^,^,^\",options=\"header \" , ]",
    "for all @xmath7 squares on the flat torus , we searched for densest packings of @xmath0 squares on the torus via monte carlo simulations in the npt ensemble .",
    "our approach was to employ a simulated annealing ( sa ) algorithm in which the system was taken from an initial , low - pressure , easy - to - equilibrate state to a final , high - pressure state , via an annealing schedule consisting of a series of steps in inverse pressure . between each pressure increase a metropolis algorithm appropriate to the hard square npt ensemble",
    "was used to equilibrate the system .",
    "although sa quickly falls out of equilibrium at higher pressures as the energy landscape becomes rough , it appears to be an an effective algorithm for finding ground states of the system .",
    "the equilibration procedure we used in our simulated annealing algorithm was a metropolis procedure consisting of three types of monte carlo moves : translations and rotations of individual squares , and changes in the volume of the entire system . at each step of the equilibration procedure ,",
    "a square is selected at random ; then , one of the three types of moves is selected at random , with probabilities .495 , .495 , and .01 , for translation , rotation , and volume change , respectively .",
    "once a square and a move type is selected , the move is attempted . if the move results in any overlaps among the @xmath0 squares , the move is rejected .",
    "if it does not , then for translations or rotations , the move is accepted ; for volume change @xmath80 , the move is accepted with probability @xmath81 $ ] . in practice , rather than changing the volume of the entire system , the periodic box in the simulations was kept at a constant size , and the sizes of the individual squares were all rescaled , in order to achieve the desired new volume .",
    "the equilibration procedure consists of @xmath82 such monte carlo steps ; in our simluations @xmath82 was typically between 200 and 400 steps .",
    "we repeated this simulation 1,000 times and reported the highest density found among these runs . in order to determine the highest - density packing for @xmath0 that did not correspond to a perfect square or a sum of squares",
    ", more extensive runs were conducted  in some cases , as long as 72 hours on a 2ghz processor . the fact that significantly different initial configurations as well as different initial random seeds generated the same final",
    ", high - density configurations signalled that a good candidate for a densest packing of the system had been found .",
    "for all simulations , the pressure was initially set to @xmath83 , and was increased via constant steps in inverse pressure until a maximum pressure of @xmath84 was reached .",
    "( during subsequent explorations of the phase behavior of the system , this pressure was later deemed excessive , but nevertheless produced reasonable results for the purposes of determing the ground state of the system . )",
    "all simulations were begun at an initial areal density @xmath22 of 0.1 , with a square array of unit squares .",
    "before each equilibration procedure began , a trial run was conducted in which the maximum value of translations , rotations , and volume changes were independently optimized in order to achieve an acceptance ratio for each of @xmath85 .    the majority of the computational work during the equilibration procedure consisted in checking for square overlaps .",
    "for this , we relied on a fast algorithm for detecting polygon overlaps by alan murta @xcite , and an associated python wrapper by joerg rdler @xcite .",
    "configurations were visualized using the vpython library @xcite .",
    "in this paper , we have presented an analysis of the densest packing solutions for @xmath0 unit squares in the torus . for @xmath7 ,",
    "the majority of these packings are bravais lattice solutions , manifested either as the `` sum of two square integers '' , or `` gapped bricklayer configurations '' described above .",
    "a few were non - bravais lattice solutions , such as those @xmath71 and @xmath2 . in this section ,",
    "we discuss the frequency and entropy of the various types of packings we found , and pose some questions for further study .",
    "we showed in section [ sec : densityonepackings ] that density - one packings are only possible for those values of @xmath0 that are expressible as the sum of two squares .",
    "though it appears that density - one packings are relatively common from the table , in fact it is known that the frequency of numbers that are equal to the sum of two square integers scales as @xmath86 for large @xmath0 @xcite .",
    "thus the frequency of density - one packings also vanishes with increasing @xmath0 .    despite the relative scarcity of density - one packings , we argue that the packing density approaches one as @xmath3 .",
    "suppose @xmath87 is a sum of two square integers .",
    "construct a new packing for @xmath88 by removing @xmath43 squares .",
    "the resulting packing density gives a lower bound of @xmath89 .",
    "given a number of squares , @xmath0 , however , determining @xmath43 requires knowledge of the nearest density - one packing larger than @xmath0 . for sufficiently large @xmath0",
    ", we can estimate that the distance to the next density - one packing is of order @xmath90 larger than @xmath0 .",
    "therefore , an estimated lower bound on the packing density of @xmath0 squares is @xmath91 for large @xmath0 , which yields the result that the density approaches one asymptotically . this argument does not take into account fluctuations in the spacing of sums of two squares , and it would be interesting to find a mathematically rigorous asymptotic lower bound on the packing density .",
    "the main contributions to the entropy of the various bravais and non - bravais lattice configurations for @xmath7 are readily assessed . for a bravais lattice packing ,",
    "there are no non - trivial continuous symmetries and thus there is no entropy .",
    "however , one can construct density - one packings from the bravais lattice packings by shifting rows relative to one another .",
    "for example , if @xmath0 is a perfect square then each row can be arbitrarily shifted and , ignoring overall shifts of the lattice , the entropy is proportional ( @xmath92 ) . note that either rows or columns may be shifted but not both for density - one packings .",
    "more generally , rows are free to shift unless the contraints of periodicity forbid it .",
    "periodicity forbids two rows from shifting relative to one another if some linear combination of torus lattice vectors connects the rows .",
    "suppose that rows are aligned in the @xmath93-direction .",
    "then , two rows are constrained to their relative positions in the bravais lattice configuration if there are integers @xmath94 and @xmath95 such that @xmath96 connects the two rows .",
    "thus , rows separated by @xmath97 are locked ( see eq .",
    "[ eqn : ana ] and fig .",
    "[ fig : aligned ] ( b ) ) .",
    "bezout s lemma @xcite states that this integer linear combination can be made equal to , but not smaller than , @xmath98 , where @xmath98 is the greatest common divisor of @xmath15 and @xmath17 ( assuming that both @xmath15 and @xmath17 are nonzero ) .",
    "thus , the set of rows can be divided into @xmath98 groups , each of which can be arbitrarily shifted , and the entropy is proportional to @xmath99 .",
    "note that if @xmath100 and @xmath101 are mutually prime , all rows are locked and this contribution to the entropy of the configuration vanishes .",
    "there are two other sources of entropy for packing related to bravais lattice packings .",
    "the gapped bricklayer configurations ( section [ sec : bricklayer ] ) allow squares within a row to shift perpendicular to the row axis ( see figures [ fig : gb ] and [ fig : n22 ] ) , and this `` poor workmanship '' contribution to the entropy will be roughly proportional to the free volume of the configuration .",
    "the density - one configurations with vacancies ( @xmath102 ) , discussed in section [ sec : vacancies ] , also possess finite entropy , since the hole(s ) created by the @xmath43 missing squares may be moved throughout the lattice , or split along a row ; and for @xmath103 , holes can appear in different rows .",
    "in contrast , the unusual , non - bravais lattice packings of the @xmath62 and @xmath2 exhibit no entropy .",
    "the above entropies have implications for which configurations are most likely to be seen at finite pressure .",
    "for example , @xmath104 admits of two classes of configuration : a density - one packing with rows aligned along the torus ( @xmath105 ) or with rows oriented at an angle with respect to the torus ( @xmath106 ) .",
    "as we have seen , the @xmath105 has four rows that are free to slide while @xmath107 is a locked configuration with no entropy ; this implies that the @xmath105 packings will be much more likely to appear at finite pressure .    unlike squares packed into a square boundary ,",
    "squares packed on a torus maintain rotational invariance in the thermodynamic limit .",
    "this can be seen as follows : one can see in figure [ fig : bravais ] that any @xmath4 packing ( which are , as seen above , the only possible packings with density one ) will orient the square lattice at an angle of @xmath108 relative to the torus lattice vectors . to take the thermodynamic limit with a particular square lattice orientation @xmath109 with respect to the underlying torus , it is sufficient to choose a particular subsequence of integers @xmath110 such that @xmath111 .",
    "the thermodynamic limit of density - one packings on the torus thus preserves rotational symmetry .",
    "our study of the densest packings of @xmath0 unit squares in a torus has yielded definitive results for cases in which @xmath0 is the sum of two square integers or is a perfect square , and strong conjectures for other values of @xmath112 .",
    "this work raises many interesting questions : how common are densest packings that have squares with different orientations , such as occurs for @xmath71 ?",
    "which motifs , if any , dominate for large @xmath0 ?",
    "are the @xmath113 motifs of @xmath62 and @xmath2 exhibited for other @xmath0 ?",
    "what role do these dense packing configurations play in the thermodynamic phases observed in finite - temperature simulations and experiments with square colloids ?",
    "we would like to thank james hanna and narayanan menon for useful discussions of some of the issues addressed in this paper . j.m .",
    "acknowledges support from nsf grant dmr-0907235 .",
    "c.d.s . acknowledges support from nsf grant dmr-0846582 , and was partially supported by the nsf - funded center for hierarchical manufacturing , cmmi-1025020 .",
    "d.b . is grateful for use of the hoffman2 computing cluster at ucla ."
  ],
  "abstract_text": [
    "<S> the densest packings of @xmath0 unit squares in a torus are studied using analytical methods as well as simulated annealing . </S>",
    "<S> a rich array of dense packing solutions are found : density - one packings when @xmath0 is the sum of two square integers ; a family of `` gapped bricklayer '' bravais lattice solutions with density @xmath1 ; and some surprising non - bravais lattice configurations , including lattices of holes as well as a configuration for @xmath2 in which not all squares share the same orientation . </S>",
    "<S> the entropy of some of these configurations and the frequency and orientation of density - one solutions as @xmath3 are discussed . </S>"
  ]
}