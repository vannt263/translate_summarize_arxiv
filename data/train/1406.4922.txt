{
  "article_text": [
    "reciprocity is the symmetry of a physical system with respect to the exchange of a source and detector .",
    "for example , in systems which demonstrate nonreciprocal behavior the transmission loss and/or phase delay depends on the direction of propagation  @xcite . in general ,",
    "reciprocal symmetry can be violated in multi - mode devices and the most well - known examples are ferrite - based circulators and isolators  @xcite .",
    "such devices are useful in several practical contexts : circulators for instance are commonly employed in both optical  @xcite and cryogenic microwave systems  @xcite to reduce reflections and , more importantly , to protect from amplifier backaction on the device - under - test .",
    "likewise , in superconducting quantum information , circulators are often used to direct the amplified reflected signal from lumped - element superconducting parametric amplifiers .",
    "since the most common schemes for producing nonreciprocity involve the use of high magnetic fields , they are often incompatible with the goal of integrating several measurement circuits into smaller and smaller physical volumes while also limiting the magnetic flux near sensitive superconducting circuits  @xcite . in the superconducting quantum information and microwave engineering fields ,",
    "this has motivated a push to understand how nonreciprocity can be generated using alternative methods  @xcite and this general pursuit has been paralleled by similar efforts in optics  @xcite .",
    "although these different ideas are embodied in different physical implementations , they all share a common mathematical description based in coupled - mode theory . in this paper , we develop a scheme for determining the scattering matrix of an arbitrary coupled - mode system in terms of _ directed graphs_. in doing so , we show that nonreciprocity is a consequence of asymmetric interference between different connecting paths in a graph , as well as judiciously - placed dissipation in ancillary modes .",
    "we emphasize that while a direct solution of the coupled - mode equations can always be found by means of standard mathematical techniques , the reverse problem of _ synthesizing _ a multi - mode system with desired properties ( gain , impedance match , directionality ) can be much more difficult . with the approach we describe in this work ,",
    "the synthesis of a multi - mode device is translated into the process of building a directed graph whose edges are subject to specific conditions . since this approach is agnostic to physical implementation , it may benefit similar efforts based on optical , mechanical , and hybrid systems .",
    "as many of these systems are parametrically coupled systems , we frame this work in the context of frequency conversion and amplification processes .    this paper is organized as follows in section  [ sections : reciprocity ] we introduce normalization and matrix conventions for extending the coupled - mode equations of motion to several modes .",
    "this facilitates the definition of reciprocity in parametrically coupled systems with three or more modes . in section  [ section : graphrepresentation ] we visualize the matrix representation of the equations of motion using directed graphs and show how the scattering matrix can be computed by use of subgraphs which connect the input / output modes .",
    "we then use this picture to discuss the mechanism for nonreciprocity in general parametrically - coupled systems . in sections  [ section :",
    "threemodeamps ] and [ section : directionality ] we show how directed graphs can be used as both a synthesis and analysis tool . as examples ,",
    "we synthesize a novel 3-mode parametric amplifier in which gain , directionality , and impedance match are present ( section  [ section : threemodeamps ] ) .",
    "finally , we analyze the isolation properties of a complicated system , the dc - squid , by casting it as a 10-mode scattering problem ( section  [ section : directionality ] ) based on earlier work by kamal  _ et al .",
    "_  @xcite .",
    "we conclude the paper with a discussion of how this graphical approach might be effectively applied in future work .",
    "resonant and parametrically coupled modes are typically described by the langevin equations of motion  @xcite . since in this work",
    "we are primarily focused on the _ topology _ of the coupling in a given system , we utilize a normalized matrix form of these equations and build a graph representation of multimode coupling dynamics .",
    "this approach has an additional advantage in that it allows one to deal with systems with several modes in different physical oscillator incarnations as one may encounter in hybrid electro- and opto - mechanical systems . while the transition from the time - domain equations of motion to their matrix representation is given in _",
    "appendix a _ , in this section we present only the matrix variables that are necessary for building the graphs .",
    "we begin by considering a set of @xmath0 coupled resonators , described by a set of @xmath1 internal mode amplitudes . in general",
    ", we allow the number of modes to exceed the number of resonators @xmath2 such that several modes may reside within a single resonator .",
    "this system can be a set of parametrically or resonantly coupled oscillators , but we are not going to assume a particular physical implementation for now , in order to derive results that are as general as possible . we will call @xmath3 and @xmath4 the natural oscillation frequency and total dissipation rate for the resonator in which mode @xmath5 resides",
    ". the complex coupling rate between modes @xmath5 and @xmath6 will be denoted by @xmath7 . in order to describe both mode frequency conversion and amplification , we divide the modes into two subsets of @xmath8 internal mode amplitudes @xmath9 and @xmath10 internal mode amplitudes @xmath11 in the frequency basis , with each set of modes corresponding to the driven response at frequencies @xmath12 and @xmath13 .",
    "we assume that @xmath14 in the case of frequency conversion between modes @xmath5 and @xmath6 ( for @xmath15 or @xmath16 ) and @xmath17 in the case of parametric amplification ( for @xmath18 and @xmath19 , or @xmath20 and @xmath21 ) .",
    "for example , the coupling matrix for a 2-mode frequency converter or resonantly coupled oscillator system corresponds to the case @xmath22 , while a conventional parametric amplifier couples two modes , one at a positive frequency ( @xmath23 ) and the other at a negative frequency ( @xmath24 )  @xcite . with this general prescription for defining our mode basis",
    ", we can perform an input / output analysis of any system of coupled resonators and calculate the corresponding scattering matrix connecting the vector of input fields @xmath25 to the vector of output fields @xmath26 ( see _ appendix a _ ) .",
    "the scattering matrix can in general be expressed as    @xmath27    where @xmath28 is a @xmath29 matrix given by    @xmath30\\ ] ]    and    @xmath31    where we have defined an overall normalization prefactor    @xmath32{\\prod_{\\ell=1}^{n_m}{\\gamma_\\ell}}},\\ ] ]    and environmental coupling matrix ,    @xmath33 .",
    "\\label{eq : kmatrix}\\ ] ]    in general @xmath34 , with the equal sign if the internal dissipation rate of mode @xmath5 is zero .",
    "the diagonal elements of @xmath28 are complex normalized detunings between the driven response frequencies and the natural resonator frequencies and include the mode dissipation rates , while the off - diagonal elements are normalized coupling coefficients . in principal ,",
    "the normalizations above are unnecessary , but they allow one to cast the langevin equations of motion ( see _ appendix a _ ) in a simple matrix form ( as @xmath28 , the `` langevin matrix '' ) , emphasizing the underlying structure of the connections between modes .",
    "we show below that this structure , as revealed in the graph representation of @xmath28 , allows one to draw immediate conclusions about the ( non)reciprocity in multimode coupled systems .",
    "[ [ a - formal - definition - of - reciprocity . ] ] a formal definition of reciprocity .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    in order to proceed , we must formally define reciprocity within the context of several modes , possibly oscillating at different frequencies ( as found in parametrically coupled systems ) .",
    "the scattering matrix ( equation  [ eq : scattering ] ) describes a fully reciprocal system ( transmission between _ any _ two modes is reciprocal ) if it obeys the general constraint  @xcite ,    @xmath35    here the matrix @xmath36 corresponds to a set of phase shifts in the mode basis    @xmath37,\\ ] ]    where we can assume without loss of generality that @xmath38 .",
    "the matrix @xmath36 therefore corresponds to an arbitrary redefinition of the mode phases .",
    "this is similar to the concept of a common mode phase shift , but generalized to several modes .    a system that violates condition  ( [ eq : reciprocity ] )",
    "is nonreciprocal and is characterized by an asymmetric phase and/or amplitude transmission coefficient between at least one pair of modes .",
    "we note that equation  [ eq : reciprocity ] differs from the definition commonly found in textbooks@xcite , @xmath39 .",
    "in fact , equation  [ eq : reciprocity ] is valid for more general multimode parametric systems in which the mode frequencies can differ . as such",
    ", it is a gauge - invariant definition of nonreciprocity  @xcite . since the environmental coupling matrix @xmath40 in equation",
    "[ eq : kmatrix ] is diagonal , it follows from equation  [ eq : scattering ] that reciprocity is guaranteed if and only if the langevin matrix , @xmath28 , obeys the same similarity transformation as in equation  [ eq : reciprocity ] ,    @xmath41    for some set of phase shifts @xmath42 . above",
    ", we noted that all resonant and parametric systems considered here are constrained to couplings which are related by pairwise ( anti)-conjugation , _ i.e. _ , @xmath43 . placing this constraint in equation  [ eq : reciprocityh ] we obtain @xmath44 where @xmath45 is the phase of the coupling coefficient @xmath46 between modes @xmath5 and @xmath6 and @xmath47 is an integer .",
    "the system of equations  [ eq : reciprocityh2 ] has at most a set of @xmath48 independent relations ( if all off - diagonal elements of @xmath28 are nonzero ) in @xmath49 unknown phases @xmath42 .",
    "the system is therefore overdetermined and the reciprocity condition ( eqn .",
    "[ eq : reciprocity ] ) is , for parametrically coupled systems , satisfied only for specific choices of coupling phases .     in  ( [ eq : m_matrix ] ) .",
    "@xmath28 is the adjacency matrix of this graph , _",
    "i.e. _ , every element @xmath50 in @xmath28 is the weight of an oriented edge from vertex @xmath6 to vertex @xmath5 in the graph .",
    "( b ) calculation of the determinant @xmath51 and ( c ) the cofactor @xmath52 by use of permutation subdigraphs .",
    "the cofactor @xmath52 is proportional to the scattering coefficient @xmath53 ( _ see text_).,title=\"fig:\",width=16 ]",
    "the conditions for equations  [ eq : reciprocityh2 ] to have a unique solution , and therefore for the system to be reciprocal , can be visualized by drawing a _ directed graph _ representing the matrix @xmath28 ( see figure  [ fig : determinant_calculation ] ) .",
    "the graph has @xmath1 vertices and we associate a weighted directed branch ( `` edge '' ) between vertices @xmath5 and @xmath6 to every element @xmath46 in the matrix @xmath28 .",
    "the diagonal elements @xmath54 and @xmath55 of @xmath28 are the weights of self - loops in the graph . in other words ,",
    "all of the coupling terms in @xmath28 are shown as directed branches , and all mode detuning and dissipation is represented by self - loops in the graph .    within this representation ,",
    "the conditions for a unique solution for the entire system can be obtained by summing equations  [ eq : reciprocityh2 ] along every closed loop @xmath56 , yielding a simple result ,    @xmath57    where @xmath58 is an integer .",
    "equation  [ eq : reciprocityh3 ] , reminiscent of kirchoff s first law in electrical circuits , is analogous to the reciprocity condition in jaynes - cummings lattices described in  @xcite .",
    "we stress , however that equation  [ eq : reciprocityh3 ] is applicable to any linear coupled - mode system bearing arbitrarily complex connections and is not confined to the nearest - neighbor , planar graph couplings shown here .",
    "moreover , in the case of parametrically coupled devices in particular , the vertices of our graphs represent modes that may physically correspond to energy that is differentiated by both space and frequency . as such",
    ", the graphs are a very general representation of a coupled mode system and can describe coupling of energy at several different frequencies as well as physical ports .    in order for a system to be _ nonreciprocal",
    "_ , the condition [ eq : reciprocityh3 ] must be violated .",
    "this , however , only expresses a minimal requirement for phase nonreciprocity . we must further define a condition for which a system will also demonstrate amplitude nonreciprocity .",
    "specifically , we may ask which conditions allow the amplitude isolation ratio @xmath59 to be different than 1 . from ( [ eq : scattering ] ) it follows that the scattering coefficient @xmath60 scales with the corresponding element of the inverse langevin matrix , @xmath61 .",
    "the problem of calculating the scattering coefficients is therefore reduced to the problem of inverting the langevin matrix which , as we show below , can also be conveniently cast in terms of directed graphs .",
    "the inverse langevin matrix can be expressed in terms of the transpose of its cofactor matrix  @xcite    @xmath62    the scattering coefficient is then given by    @xmath63    where @xmath64 is the kronecker delta function .",
    "the elements of the cofactor matrix @xmath65 are equal to the determinant of the matrix obtained from @xmath28 after removing the @xmath6-th row and the @xmath5-th column ( _ i.e. _ , the @xmath66 minor ) , multiplied by @xmath67  @xcite .",
    "the determinant of @xmath28 and the cofactor @xmath65 can be easily calculated from the graph in figure  [ fig : determinant_calculation](a ) by the following procedure ( _ see _ refs  @xcite ) . given a graph , we call a subgraph @xmath68 a `` permutation subdigraph '' if every vertex in @xmath68 has one and only one outgoing edge and one and only one incoming edge  @xcite . the total weight @xmath69 of a subgraph @xmath68 is the product of the weights of all of its edges times @xmath70 , where @xmath71 is the number of cycles in @xmath68 ( by cycle we mean a sequence of distinct connected vertices , where the first and last vertex coincide )",
    ". the determinant of the matrix @xmath28 is the sum of weights of every possible permutation subdigraph of the graph associated to @xmath28  @xcite , as shown in figure  [ fig : determinant_calculation](b ) .",
    "the cofactor matrix @xmath65 is the coefficient of the @xmath72 element of the matrix @xmath28 in the laplace expansion of the determinant @xmath51 .",
    "therefore , in order to calculate @xmath65 , we need to compute only the permutation subdigraphs in the expansion of @xmath51 that contain the @xmath66 edge , with the @xmath66 edge removed . in other words , for every path @xmath8 from vertex @xmath6 to vertex @xmath5 , we consider the collection of all the permutation subdigraphs @xmath73 of the graph of @xmath28 containing @xmath8 , with the @xmath66 edge removed as in figure  [ fig : determinant_calculation](c ) .",
    "the cofactor @xmath65 is then given by    @xmath74    where @xmath8 varies over all the paths connecting vertex @xmath5 to vertex @xmath6 and @xmath75 varies over all the subdigraphs containing the path @xmath8 .",
    "the minus sign is due to the fact that , by removing the @xmath66 edge , we reduced the number of cycles in the subdigraph by 1 .",
    "an example of this procedure is outlined in figure  [ fig : determinant_calculation](b ) .",
    "the graphs @xmath76 in the expression for the cofactor elements have a simple physical interpretation : they represent the possible scattering mechanisms that connect modes @xmath5 and @xmath6 .",
    "since , from ( [ eq : scattering2 ] ) , the ratio between the scattering coefficients @xmath77 is equal to the ratio between the corresponding cofactors @xmath78 , the problem of analyzing isolation in a given multi - mode system can be reduced to evaluating the differences between the specific graphs that connect @xmath5 to @xmath6 and _ vice versa_.     ( b ) and @xmath79 ( c ) .",
    "the element @xmath80 of the cofactor matrix is calculated by summing the weights of the permutation subdigraphs containing a path from vertex @xmath81 to vertex @xmath82 , with the edge from vertex @xmath82 to vertex @xmath81 removed.,title=\"fig:\",width=16 ]    as a more concrete example , we apply this procedure to a simple three - mode system in which all modes are coupled via frequency conversion ( @xmath83 ) and are therefore described by the following matrix ( see figure  [ fig : determinant_3mode ] ) ,    @xmath84,\\ ] ]    where @xmath54 and @xmath46 are normalized detunings and couplings as before .",
    "the isolation between ports @xmath81 and @xmath82 can be calculated by use of the graphs representing the cofactors ( see figure  [ fig : determinant_3mode](b ) and ( c ) ) yielding the expression ,    @xmath85    where , in the last line , we have removed all normalizations .    from ( [ eq : iso3mode ] ) we observe that if the total dissipation of mode `` 3 '' , @xmath86 , then @xmath87 and there is no isolation between modes 1 and 2 . in this case mode 3",
    "serves as an internal lossless mode and the system behaves as a simple reciprocal two - mode system .",
    "here , dissipation plays a crucial role in violating reciprocity , as it breaks the symmetry between scattering elements which are otherwise related by complex conjugation .",
    "assuming finite dissipation in mode 3 , we find the condition for maximum isolation @xmath88 ,    @xmath89    in other words , to achieve maximum isolation , the sum of the phases of the couplings along the loop connecting the three modes , @xmath90 , must be equal to the detuning angle , @xmath91 $ ] . at zero detuning in mode 3 , @xmath92 , this loop phase must be @xmath93 for perfect isolation .",
    "equivalently , one can interpret this isolation condition , eqn .",
    "[ eq : maxiso3 ] , as interference between the two possible coupling paths connecting modes 1 to 2 in the graph ( figure  [ fig : determinant_3mode ] ) .",
    "although we focus on the isolation here , condition [ eq : maxiso3 ] also yields unit transmission in the forward direction , @xmath94 , for @xmath95 .",
    "in fact , one can continue to build a 3-mode circulator by finding similar constraints for the 2@xmath963 and 1@xmath963 coupling .",
    "and its graph representation . the squid is equivalent to a nonlinear inductor modulated by the magnetic flux through the squid loop .",
    "one pump at frequency @xmath97 is used to obtain parametric amplification between mode 1 at frequency @xmath98 and mode 2 at frequency @xmath99 .",
    "the second pump at frequency @xmath100 generates frequency conversion between mode 1 and mode 3 at frequency @xmath101 .",
    "a third pump at frequency @xmath102 closes the loop and generates parametric amplification between modes 2 and 3 . in this configuration non - reciprocal trans - gain",
    "can be obtained between modes 1 and 2 .",
    "( c ) and ( d ) subgraphs used to calculate the forward and reverse gain between modes 1 and 2.,title=\"fig:\",width=16 ]    traditional single - stage lumped - element parametric amplifiers , such as the one shown in figure  [ fig:3mode_amp](a ) , operate in reflection - mode such that a circulator is needed in order to achieve unidirectionality . in",
    "@xcite a single - stage amplifier with two parametric pumps at the same frequency was introduced , but in addition to forward gain it also had unity reverse gain .",
    "the graph methodology introduced here allows us to revisit the problem of gain and isolation from another perspective .",
    "in particular , our discussion above identified the importance of introducing a multi - edge loop to obtain nonreciprocity . here",
    "we analyze a closed - loop amplifier which we term the `` delta '' amplifier , shown schematically in figure  [ fig:3mode_amp](b ) both as a device concept and as its corresponding graph .",
    "this amplifier can provide forward gain and zero reverse gain as discussed below .",
    "as drawn , the delta amplifier requires three independent pumps to generate three pairs of coupling edges @xmath103 .",
    "two of these pairs create amplification ( _ i.e. , _",
    "@xmath104 , @xmath105 ) , while the third pair couples through frequency conversion ( @xmath106 ) .",
    "one concept for how this might be implemented is shown schematically in figure  [ fig:3mode_amp](b ) as three resonators that share a common current anti - node in which a flux - driven squid is operated as a parametrically modulated inductor . in principle",
    ", one might drive two of these couplings using the same pump frequency@xcite , but for clarity we discuss only the case in which each of the three couplings is driven independently , which has the advantage of increased flexibility due to the increased number of degrees of freedom .",
    "regardless of particular implementation , we can recognize the presence of a closed loop connecting all three modes , as well as the integration of amplification as a coupling process . from this bare description",
    "we recognize that with three independent pumps we are constrained to optimizing only three of the nine possible scattering elements . in laboratory use",
    ", we can choose to optimize for amplification in the `` forward '' direction ( @xmath107 ) , isolation in the `` reverse '' direction ( @xmath108 ) , and low input reflection coefficient ( input match , _",
    "i.e. _ , @xmath109 ) to prevent unwanted reflections of signals propagating away from a device - under - test .",
    "we begin by writing down the expressions for the forward and reverse transmission from equation  [ eq : scattering2 ] ,    @xmath110{\\gamma_1\\gamma_2\\gamma_3}}\\frac{\\beta^*_{12}\\delta_3+\\beta_{31}\\beta_{23}}{|m| } \\\\",
    "s_{12 } & = i\\frac{\\sqrt{\\gamma^{ext}_1\\gamma^{ext}_2}}{\\sqrt[3]{\\gamma_1\\gamma_2\\gamma_3}}\\frac{-\\beta_{12}\\delta_3 - \\beta^*_{23}\\beta_{31}^*}{|m|},\\end{aligned}\\ ] ]    where @xmath51 is the determinant of the coupling matrix represented in the graph shown in figure  [ fig:3mode_amp](b ) .",
    "assuming ideal isolation , @xmath111 , we find an expression similar to equation  [ eq : maxiso3 ] ,    @xmath112    which provides an overall constraint on the coupling amplitudes and phases as a function of the complex detuning of mode 3 . under this primary constraint",
    ", we then set the input reflection coefficient to zero ,    @xmath113{\\gamma_1\\gamma_2\\gamma_3}}\\frac{|\\beta_{23}|^2-\\delta^*_2 \\delta_3}{|m|}-1=0,\\ ] ]    giving a constraint on the determinant ,    @xmath114    if external coupling dominates , @xmath115 , in the limit of small detunings @xmath116 the gain reduces to    @xmath117        note that this form gives the gain at a fixed frequency where the input match is perfect ( equation  [ deltas11 ] ) . by substituting equations",
    "( [ delta_gain ] ) and  ( [ isodelta ] ) in equation  ( [ deltas11 ] ) at resonance we can determine the three coupling rates .",
    "in the limit of high gain , @xmath118 , with the exact value depending on the gain @xmath68 .    we have calculated the resulting @xmath119-parameters for the delta amplifier in figure  [ fig : delta_sym ] under various constraints on the pump detunings for the case of uniform dissipation rates @xmath120 . in practice",
    ", one might fix the pump frequencies , locking the three detunings together , and measure the @xmath119-parameters shown in figure  [ fig : delta_sym](d ) . for this example calculation",
    ", we selected values for the pump amplitudes to fix the nominal power gain to @xmath12120  db while obtaining significant isolation . the device bandwidth is determined according to equation  ( [ delta_gain ] ) that fixes the gain - bandwidth product for specific dissipation rates .",
    "we note here that the device bandwidth is comparable to traditional two - mode superconducting lumped parametric amplifiers , while the center frequency could be tuned by changing the frequencies of the pumps . finally , we find that the calculated output @xmath122 shows reflection gain at the output port , and is consistent with the limitations of having only three parameters ( the independent pumps ) to optimize three of the four scattering parameters between ports 1 and 2",
    ". however , this might not be a limitation in practical use where one is more concerned with the backaction of the amplifier on a quantum circuit on the input side ( port 1 ) .",
    "[ [ added - noise - of - the - three - mode - amplifier . ] ] added noise of the three - mode amplifier .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    we computed the equivalent input added noise @xmath123 of the delta amplifier to check that the device can approach the standard quantum limit .",
    "we assumed that half a photon of noise is injected into every port and calculated the total output noise spectral density from the scattering parameters .",
    "the contribution from ports @xmath82 and @xmath124 , divided by the device power gain @xmath68 , constitutes the equivalent added input noise , as outlined in  @xcite . for a symmetric device , in the limit of large gain and at zero detuning ,",
    "the result is :    @xmath125    where we can neglect @xmath126 as a consequence of the isolation condition .",
    "the results of the numerical calculations for nonzero detuning are shown in figure  [ fig : delta_sym ] .",
    "the fact that the delta amplifier is quantum - limited may be surprising at first , as one might expect the third mode to contribute extra noise beyond the quantum limit .",
    "however the third mode acts only as an effective dissipative coupling between modes @xmath81 and @xmath82  @xcite .",
    "we note that the parametric amplification scheme that is the subject of ref .",
    "@xcite constitutes a three mode device in which the added noise was determined to be at the standard quantum limit .",
    "in fact , the delta amplifier is similar to that device except for the addition of an amplification branch which serves to create a closed loop in its graph description , introducing the necessary interference for directionality .",
    "are coupled through internally generated pump signals at multiples of the josephson frequency @xmath127 . at each frequency",
    "there are two doubly degenerate modes , corresponding to the common and differential excitation of the junction phases . ,",
    "title=\"fig:\",width=12 ]    while the previous discussion focused on using a graphical approach to synthesize a novel amplifier , it can also be used to identify aspects of other systems which enable both gain and directionality . in this section",
    "we use graphs to analyze a complicated multi - mode system , the dc - squid amplifier .",
    "dc - squids are a type of superconducting amplifier with noise temperatures approaching the standard quantum limit  @xcite .",
    "since dc - squids also have inherently low power dissipation ( in addition to high gain and directionality  @xcite ) , they have been the subject of several applied superconductivity efforts to produce reliable amplifiers for microwave quantum information measurements . in ref .",
    "@xcite , kamal _ et al .",
    "_ showed that the directionality of the squid is a consequence of multiple parametric amplification and frequency conversion processes due to frequency mixing between the input microwave signal and internally - generated parametric pumps at multiples of the josephson frequency .",
    "this approach casts the dc - squid as a multi - mode coupling problem and , as such , is also amenable to a graph description . here",
    "we describe the parametric coupling in the squid following the description in ref .",
    "@xcite by use of graphs to map the connections between modes .",
    "in particular , we will direct our attention to the interference and dissipation that must be present to generate nonreciprocity in the presence of gain .",
    "a dc - squid consists of a pair of josephson junctions inside a superconducting loop as in figure  [ fig : squid ] .",
    "each junction is characterized by a phase difference @xmath128 across its terminals , but it is more convenient to recast the dynamics of the dc - squid in terms of the common and differential phase difference @xmath129  @xcite .",
    "@xmath130 can be expressed as the sum of fast oscillating terms at multiples of the josephson frequency @xmath131 , where @xmath132 is the magnetic flux quantum , and slow oscillating terms at the signal frequency @xmath133 .",
    "the fast oscillating terms act as parametric pumps causing mode conversion between @xmath133 and the mixing product frequencies @xmath134 .",
    "the lowest - dimensional model that can capture nonreciprocity involves two parametric pumps and a total of 10 modes at 5 frequencies @xmath135 .",
    "each mode is doubly - degenerate , because for each frequency there are a common and a differential mode excitation . some scattering subgraphs to describe the squid",
    "are shown in figure  [ fig : squid_graph_approximate ] , where , for example , @xmath136 indicates the coupling rate between the common modes at frequency @xmath133 and @xmath137 .",
    "the input and output modes are shown at the very bottom and top respectively .",
    "calculation of the mode coupling rates as a function of the internally generated pump amplitudes is detailed in _",
    "appendix b_.        the number of subgraphs to describe the squid is too large for analytical calculations",
    ". however if the squid bias current is high enough , we can look for an approximate expression for the squid isolation for small values of the bias parameter @xmath138 , where @xmath139 is the critical current of the junctions and @xmath140 is the bias current .",
    "the pump amplitudes and the coupling coefficients can then be calculated for small @xmath141 and we can simplify our calculations by considering only the subgraphs of leading order in @xmath141 . these subgraphs are shown in figure  [ fig : squid_graph_approximate ] .",
    "the order of the graph is given by the product of its edges and therefore depends on the length of the path connecting the input to the output modes as well as the order of the edge weights ( coupling rates ) .",
    "the order of the coupling rates increases with the difference between the mode drive frequencies ( for example @xmath142 ) .",
    "moreover a small ( @xmath143 ) direct coupling exists between modes at the same frequency , as explained in _",
    "appendix b_.    the dissipation rates for the common and differential modes when the squid is terminated into ideal infinite transmission lines , are given by    @xmath144    with @xmath145 , @xmath146 , @xmath147 , @xmath56 is the inductance of the squid loop , and @xmath148 and @xmath149 are the junction shunt resistance and capacitance .",
    "since the squid is a nonresonant system , the mode frequencies @xmath150 in equation  ( [ m_elements1 ] ) are zero .",
    "we can approximately compute the squid isolation by use of the lowest - order subgraphs shown in figure  [ fig : squid_graph_approximate ] .",
    "the first conclusion we can draw , based on our previous discussion , is that non - zero dissipation rates in ( [ gammas ] ) are essential to obtain nonreciprocity in the squid . a change in the impedance terminations at the various mode frequencies @xmath134 will change the amount of nonreciprocity , _ viz .",
    "_ , modes that are terminated in a short or an open circuit ( corresponding to zero dissipation rates ) will not contribute to the squid isolation .",
    "moreover , it is important that @xmath151 .",
    "in fact , by taking into account the symmetries between the mode couplings , the weight of the @xmath152 order subgraphs in figure  [ fig : squid_graph_approximate ] is given by    @xmath153 + 4(\\gamma_c-\\gamma_d)\\operatorname{im}\\left[\\beta^{cc}_{\\omega+\\omega_j,\\omega}\\beta^{cd}_{\\omega,\\omega+\\omega_j}\\right ] , \\ ] ]    apart for a common factor equal to the product of the internal modes normalized detunings .",
    "if @xmath154 , the second term in equation  [ lowest_order ] is zero and the squid becomes reciprocal at first order .",
    "the same cancellation happens in the @xmath155- order subgraphs in figure  [ fig : squid_graph_approximate ] and in the @xmath156-order subgraphs , with the exception the subgraphs in the bottom - left corner of figure  [ fig : squid_graph_approximate ] . in a practical device isolation",
    "can however be restored for @xmath157 if the resonant coupling rate @xmath158 is increased . in a real device",
    "we expect such a rate to be higher , due to the stray capacitive coupling between the input and output as well as other parasitics @xcite . finally , in figure  [ fig : squid_graph_approximate2 ] we show the computed isolation and power gain of the squid as a function of the bias points for the exact numerical solution and for the lowest - order approximations .",
    "we find that graphs up to @xmath156 order in @xmath141 are enough to accurately describe the isolation properties of the squid .",
    "the exact power gain was also computed numerically by extracting the impedance matrix from the scattering matrix of the squid and then calculating the gain as discussed in  @xcite . in principle",
    "the power gain may also be computed from the subgraphs , but the number of necessary graphs is large , even at lowest order . in this system , graphs help identify the elements of a complex multimode parametric scattering problem that contribute to the isolation properties .    ) based on the linearized coupled - mode equations and the approximate solutions including subgraphs up to the @xmath152 , @xmath155 , and @xmath156 order for @xmath159 , @xmath160 and @xmath161 .",
    "( b ) exact power gain.,title=\"fig:\",width=16 ]",
    "in this work we introduced a graph theoretical representation that can be used as a combinatorial accounting tool to analyze nonreciprocity in coupled - mode systems and used it to derive a minimal unilateral parametric amplifier and analyze the condictions for nonreciprocity in squid amplifiers . an abstract graph associated to the coupled - mode system",
    "was used to compute the input / output scattering coefficients between modes and derive general constraints that need to be satisfied in order for nonreciprocity to occur . in order for a multi - mode system to be reciprocal",
    "the sum of the phases along any loop has to be @xmath162 or @xmath163 . if this condition is violated , phase and/or amplitude nonreciprocity is present and this condition can be interpreted as interference between different permutations of connecting paths .",
    "we also find that dissipation in the remaining disjoint vertices / modes is _ crucial _ for amplitude nonreciprocity / isolation .",
    "specifically , it breaks the symmetry between forward and backward multi - mode scattering processes such that one may obtain constructive loop interference in one direction , and destructive interference in the reverse direction . as a result",
    "we were able to design a novel three - mode parametric amplifier , characterized by forward gain , input match and reverse isolation that can be integrated on a superconducting chip .",
    "although the scattering matrix of a multi - mode system can always be computed numerically using more conventional approaches , graphs offer a new perspective that can be useful in the problem of synthesizing new multi - mode systems and devices .",
    "for instance , this can be leveraged as a design tool , allowing one to reduce a set of desired device characteristics to a minimal description that can be utilized to design new amplifier / converter concepts such as the delta amplifier . as an approach ,",
    "it is conceptually similar to the analysis of electric networks by means of circuit representations of the network components , where graphical manipulation rules are used to simplify the circuit analysis .",
    "we also showed , with the complex example of the dc - squid , that graphs aid in identifying the critical elements that create isolation in the presence of forward gain .",
    "finally , graphs may provide a useful approach to engineering nonreciprocity in recent multi - mode parametrically coupled hybrid systems such as the electrical - mechanical - optical ( three - mode ) transduction bridge @xcite and electro - mechanical amplifiers @xcite .",
    "in general , problems like these are particularly well - suited to a graph - based approach since many of the interesting properties one is interested in ( gain , isolation , gain - bandwidth product , _ etc .",
    "_ ) actually arise from the structure of the coupling network ( the topology of the graph ) and not the physical particulars of a given implementation .",
    "the authors would like to thank prof.m.devoret ( yale ) and dr.archana kamal ( mit ) for motivating discussions .",
    "in this section we formally derive equation  [ eq : scattering ] .",
    "we begin by considering a set of @xmath0 coupled resonators described by :    @xmath164    where @xmath165 is a vector of @xmath0 internal complex normal mode amplitudes and @xmath166 describes the set of input signal drives for each of these modes .",
    "we assume that @xmath165 and @xmath166 can be expressed as a sum of periodic functions . in this case harmonic balance",
    "can be used to rewrite equation  [ system_eq ] as a system of @xmath1 coupled - mode equations :    @xmath167    where @xmath168 $ ] is a vector of @xmath169 input stimuli and @xmath170 $ ] is a vector of @xmath1 internal modes that can be expressed as :    @xmath171    and the corresponding conjugate expressions for @xmath21 . here , we allow for the number of modes to exceed the number of resonators , @xmath172 and label the drive / response frequencies with an @xmath173 , while the mode itself is labeled with a subscript @xmath5 so that `` @xmath174 '' denotes the drive / response frequency of mode @xmath5 which can be based within any of the @xmath0 resonators depending on how the coupling is directed within the function @xmath175 .",
    "the diagonal matrix @xmath176 describes coupling to the environment through the external dissipation rates @xmath177 .",
    "the diagonal elements @xmath178 of the @xmath179 coupling matrix @xmath180 can then be expressed in this mode basis as  @xcite :    @xmath181    and the off - diagonal elements @xmath182 are given by    @xmath183    in equations  [ helements ] and [ helements2 ] @xmath3 and @xmath4 are the natural frequency and total dissipation rate for the resonator in which mode @xmath5 resides , while the `` * '' indicates complex conjugation , and @xmath7 is the complex coupling coefficient between modes @xmath5 and @xmath6 .",
    "we further assume that @xmath14 if @xmath15 or @xmath16 and @xmath17 for @xmath18 and @xmath19 , or for @xmath20 and @xmath21 .",
    "for example , the coupling matrix for a 2-mode frequency converter or resonantly coupled oscillator system corresponds to the case @xmath22 , while a conventional parametric amplifier couples two modes , one at a positive frequency ( @xmath23 ) and the other at a negative frequency ( @xmath24 )  @xcite . with this general prescription for defining our mode basis",
    ", we can perform an input / output analysis of the system ( equation  [ eq : coupled_modes ] ) and calculate the vector of output ( scattered ) fields @xmath26 by means of the relation  @xcite :    @xmath184    in general , the phase factor @xmath185 depends on the nature of the coupling to mode @xmath5 . for simplicity , we set @xmath186 , as one would obtain with a small series capacitance or weakly reflecting mirror",
    ". other choices of coupling will have the effect of modifying the identity matrix on the r.h.s .  of equation  [ eq : scattering ] .",
    "by substituting equation  [ eq : modes ] and  [ eq : modes2 ] into equation  [ eq : coupled_modes ] and by use of the input / output boundary conditions ( equation  [ inputoutput ] ) , we can obtain the expression for the scattering matrix in equation  [ eq : scattering ] .",
    "a dc - squid consists of a pair of josephson junctions inside a superconducting loop as in figure  [ fig : squid ] .",
    "each junction is characterized by a phase difference @xmath128 across its terminals . defining the common and differential phase difference @xmath129 , the dynamical equations describing the system are  @xcite :    @xmath187    where @xmath188 , and @xmath189 .",
    "@xmath139 is the junction critical current and @xmath140 is the bias current of the squid , @xmath132 is the magnetic flux quantum , @xmath56 is the loop geometric inductance and @xmath148 is the equivalent shunt resistance across the squid .",
    "the system  ( [ squid_equations ] ) can be linearized around the following bias point :    @xmath190    where @xmath191 are small perturbations . in",
    "@xcite it was shown that by applying a harmonic balance procedure , the phases @xmath192 can be expressed as    @xmath193    where the components @xmath194 are internally generated pumps at frequency @xmath195 , where @xmath196 is the static dc voltage across the squid .",
    "the pumps cause parametric frequency mixing between the various signal modes @xmath197 . in",
    "@xcite the harmonic balance equations were solved for the case @xmath198 to show how nonreciprocity arises from the interference between the different parametric conversion paths . as shown in the main text",
    ", we can employ the graph representation of a coupled - mode system to write explicitly the interference conditions needed to maximize the amount of amplitude nonreciprocity between two modes . in the @xmath198 case we can describe the squid as a 10-mode system .",
    "the 10 modes have frequencies @xmath199 and are doubly degenerate ( for each frequency there are a common and a differential excitation ) . in order to calculate the scattering parameters , we need to find the coupling coefficients between the modes as a function of the internal pump amplitudes .",
    "this can be obtained by linearising equations  ( [ squid_equations ] ) for small signal mode - amplitudes and equating terms at the same frequency in order to obtain a set of coupled mode equations  [ eq : coupled_modes ] . after taking symmetries into account ,",
    "the system can be described by the following five coupling coefficients    @xmath200    where for example @xmath201 corresponds to the coupling between the common modes at frequency @xmath133 and @xmath137 .",
    "10 url # 1#1urlprefix[2][]#2 fan s , baets r , petrov a , yu z , joannopoulos j  d , freude w , melloni a , popovi m , vanwolleghem m , jalas d _ et  al . _ 2012 _ science _ * 335 * 3838"
  ],
  "abstract_text": [
    "<S> in this work we derive the general conditions for obtaining nonreciprocity in multi - mode parametrically - coupled systems . </S>",
    "<S> the results can be applied to a broad variety of optical , microwave , and hybrid systems including recent electro- and opto - mechanical devices . in deriving these results </S>",
    "<S> , we use a graph - based methodology to derive the scattering matrix . </S>",
    "<S> this approach naturally expresses the terms in the scattering coefficients as separate graphs corresponding to distinct coupling paths between modes such that it is evident that nonreciprocity arises as a consequence of multi - path interference and dissipation in key ancillary modes . </S>",
    "<S> these concepts facilitate the construction of new devices in which several other characteristics might also be simultaneously optimized . as an example </S>",
    "<S> , we synthesize a novel three - mode unilateral amplifier design by use of graphs . </S>",
    "<S> finally , we analyze the isolation generated in a common parametric multi - mode system , the dc - squid . </S>"
  ]
}