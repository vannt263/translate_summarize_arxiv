{
  "article_text": [
    "a _ word _ is a finite sequence of letter chosen from a finite alphabet @xmath3 .",
    "the periodicity of words is a classical and well - studied topic in both discrete mathematics and combinatorics on words , starting with the classic paper of fine and wilf and continuing with the works of guibas and olydzko . for more recent work ,",
    "see , for example , .",
    "we say that a word @xmath4 has period @xmath5 if @xmath6 = w[i+p]$ ] for all @xmath7 that make the equation meaningful .",
    "( if @xmath8 and one indexes beginning at position @xmath9 , this would be for @xmath10 . )",
    "trivially every word of length @xmath11 has all periods of length @xmath12 , so we restrict our attention to periods @xmath13 .",
    "the least period is sometimes called _ the _ period . for example , the french word entente has periods @xmath14 , @xmath15 , and @xmath16 .    empirically , one quickly discovers that a randomly chosen word typically has a least period that is very close to its length .",
    "this readily follows from the fact that the number of words over a given alphabet grows exponentially as the length increases .",
    "it can also be seen as a particular case of the fact that most strings are not compressible .    in this paper",
    ", we quantify this basic observation and show that the expected least period of a string of length @xmath11 over an @xmath1-letter alphabet is @xmath17 , where @xmath18 is @xmath19 .",
    "another concept frequently studied in formal language theory is that of _ border _ of a word @xcite .",
    "a word @xmath20 has border @xmath4 if @xmath4 is both a prefix and a suffix of @xmath20 .",
    "normally we do not consider the trivial borders of length @xmath21 or @xmath22 .",
    "thus , for example , the english word ionization has one border : ion .",
    "less trivially , the word alfalfa has two borders : a and alfa .",
    "a word with no borders is _",
    "unbordered_.    there is an obvious connection between periods of a word and its borders : if @xmath4 has a period @xmath5 , then it has a border of length @xmath23 .",
    "for example , the english word abracadabra , of length @xmath24 , has periods @xmath16 , @xmath25 , and @xmath24 , while it has borders of length @xmath9 and @xmath26 .",
    "consequently , the least period of a word corresponds to the length of the longest border ( and an unbordered word corresponds to least period @xmath11 , the length of the word ) .",
    "the reader should be constantly aware of this duality , since it is often useful and more natural to think about periods in terms of borders .",
    "this can be seen from the announced result : it is more compact to speak directly about the expected maximum border length , which is @xmath18 .",
    "if @xmath27 is a set of integers , we shall write @xmath28 for @xmath29 , and @xmath30 for @xmath31 .    by @xmath32 , we mean the prefix of length @xmath7 of the word @xmath33 .",
    "we shall obtain our results by counting words with a given length @xmath11 and a given finite set of periods @xmath34 , or equivalently , with a given set of border lengths @xmath28 . for technical reasons , in order to be able to deal with unbordered words , we shall always suppose that @xmath35 , that is , we shall say that every word has a border length zero .",
    "there are two basic types of requirements .",
    "let @xmath36 and let @xmath37 be the cardinality of @xmath38 .",
    "similarly , let @xmath39 and let @xmath40 be the cardinality of @xmath41 .",
    "words with many periods have been amply studied . in particular",
    ", there is a fast algorithm constructing a word of length @xmath11 with periods @xmath27 and maximal possible number of letters .",
    "such a word , called an @xmath42-word in the literature , is unique up to renaming of the letters .",
    "let @xmath43 denote the cardinality of the alphabet of the @xmath42-word of length @xmath11 and periods @xmath27 .",
    "let @xmath44 and @xmath45 . the well - known periodicity lemma ( often called the fine and wilf theorem , which is the origin of the term @xmath42-word ) states that if a word of length at least @xmath46 has periods @xmath5 and @xmath47 , then it also has period @xmath48 .",
    "moreover , the bound @xmath46 is sharp ; for all @xmath49 there are words of length @xmath50 with period @xmath5 and @xmath47 but not period @xmath48 .",
    "this can be stated , using the just - introduced terminology , by the two assertions @xmath51 and @xmath52 .",
    "the number @xmath43 can be computed and the corresponding @xmath42-word constructed using the algorithm of tijdeman and zamboni @xcite ( see @xcite for an alternative presentation ) .",
    "the computation is summarized by the following formula :    @xmath53    where @xmath54 and @xmath55 .    since each word having the periods in @xmath27 ( and possibly others ) results from a coding ( a letter - to - letter mapping ) of the corresponding @xmath42-word",
    ", we obtain @xmath56 which is the starting point of our computation .",
    "note that @xmath57 is the set of words from @xmath58 having least period @xmath5 .",
    "equivalently , @xmath59 is the set of words with the longest border of length @xmath60 . for @xmath61 ,",
    "let @xmath62 denote the relative number of such words .",
    "our goal is to compute @xmath63 which is the expected maximum border length for words in @xmath58 .",
    "we first show that this quantity converges as @xmath11 approaches infinity .",
    "[ limit ] for each @xmath64 and each @xmath61 , @xmath65    case 1 : @xmath66 . then @xmath67 recall that @xmath68 ( resp . ,",
    "@xmath69 ) counts the words with longest border length @xmath60 from @xmath70 ( resp . , @xmath58 ) .",
    "first , note that @xmath71 for any @xmath5 and @xmath11 .",
    "this implies @xmath72 and we are done .",
    "case 2 : @xmath73 .",
    "there is a useful correspondence between @xmath58 and @xmath70 , given by the insertion of a letter in the middle of the shorter word .",
    "the basic observation , already used in @xcite , is that this insertion does not influence borders of length at most @xmath74 .",
    "define @xmath75 then @xmath76 .",
    "let @xmath77 and write @xmath78 with @xmath79 , @xmath80 , and @xmath81 .",
    "the words @xmath4 and @xmath82 have the same borders up to length @xmath74 .",
    "since @xmath83 , we deduce that @xmath82 has a border of length at least @xmath84 , that is , a period at most @xmath85 .",
    "this implies @xmath86 similarly , a word @xmath87 has period at most @xmath88 , and so @xmath89 we thus obtain @xmath90    for each @xmath64 and @xmath91 , the limits @xmath92 exist .",
    "furthermore , the convergence is exponential",
    ".    follows directly from the definition of @xmath93 and lemma [ limit ] .",
    "from the estimates of the previous section , we know that @xmath93 and @xmath94 both converge quickly to @xmath95 and @xmath96 , respectively .",
    "thus , they can be estimated to a few digits by explicit enumeration .    in order to evaluate @xmath18 to dozens of decimal places ,",
    "however , we need a more efficient way to calculate @xmath97 .",
    "this can be done using the recurrence formulas that we derive below .",
    "they are reformulations and generalizations of formulas given by harborth @xcite for sets of periods .",
    "we first prove the following auxiliary claim .    [ pq ]",
    "let a word @xmath4 have a period @xmath98 and let @xmath99 be the prefix of @xmath4 of length @xmath23 .",
    "then @xmath4 has a period @xmath100 if and only if @xmath99 has a period @xmath101 .",
    "note that @xmath99 is a border of @xmath4 .",
    "the following conditions are easily seen to be equivalent :    * @xmath4 has a period @xmath47 , * @xmath4 has a border of length @xmath102 , * @xmath99 has a border of length @xmath102 , * @xmath99 has a period @xmath103 .    since @xmath104",
    ", the proof is completed .",
    "[ rec ] let @xmath27 be a set of periods with @xmath54 and @xmath105 .",
    "then @xmath106 where @xmath107 \\ell^{2p - n}\\cdot { { f}}_\\ell(p - p , n - p ) , & \\text{if $ p\\geq { \\left\\lceil n/2 \\right\\rceil}$ } \\ , . \\end{cases}\\end{aligned}\\ ] ]    from @xmath37 we have to subtract the number of words from @xmath58 that have periods @xmath27 but also a period smaller than @xmath108 .",
    "we define , for each @xmath109 , the set @xmath110 if @xmath111 then @xmath112 is empty , since a word @xmath113 also has a period @xmath114 , and @xmath115 contradicts the definition of @xmath116 .",
    "moreover , the sets @xmath117 are pairwise disjoint , and @xmath118 it remains to show that @xmath119 is the cardinality of @xmath112 for each @xmath120 .",
    "let @xmath121 .",
    "we claim that @xmath122 is a one - to - one mapping of @xmath112 to @xmath123 .",
    "let @xmath113 .",
    "by lemma [ pq ] , the word @xmath124 has periods @xmath125 and no period @xmath126 with @xmath127 , that is , no period less than @xmath128 . since @xmath129 and",
    "since @xmath124 also has a period @xmath5 , we have @xmath130 .",
    "similarly , one can verify that if @xmath131 , then @xmath132 and @xmath133 .",
    "let @xmath134 .",
    "again , using lemma [ pq ] , it is straightforward to verify that @xmath135    if @xmath136 is small , then we can formulate a more explicit formula that uses the mbius @xmath137-function .    let @xmath27 be a set of periods with @xmath138 .",
    "then @xmath139    let @xmath4 be a word of length @xmath11 with a period @xmath108 and let @xmath5 be the least period of @xmath4 .",
    "then , by the periodicity lemma , we have that @xmath5 divides @xmath108 , since @xmath140 implies @xmath141 .",
    "therefore , for each divisor @xmath5 of @xmath108 , @xmath142 and the claim follows from mbius inversion .",
    "in this section we derive explicit formulas for @xmath143 and @xmath144 , which are the asymptotic probabilities that a random word is unbordered , or has longest border of length one , respectively .",
    "these are two cases in which lemma [ rec ] yields a relatively simple expression , since @xmath145 .",
    "the number of unbordered words satsifies a well known recurrence formula ( see , e.g. , ( * ? ? ?",
    "* , eq .  ( 34 ) ) for the binary case and @xcite for the general case ) .",
    "the formula can be verified using theorem [ rec ] but we shall give an elementary proof . in this section ,",
    "let @xmath146 denote @xmath147 , and let @xmath148 denote @xmath149 .",
    "[ unb ] @xmath150    for @xmath151 , the verification is straightforward",
    ". let @xmath20 and @xmath152 be nonempty words with @xmath153 and consider words @xmath154 , @xmath155 and @xmath156 where @xmath157 and @xmath158 are letters .",
    "since the shortest border of @xmath155 has length at most @xmath159 , the word @xmath154 is unbordered if and only if @xmath155 is .",
    "this proves @xmath160 if @xmath11 is odd .    on the other hand",
    ", @xmath156 can have the shortest border of length @xmath161 .",
    "therefore , @xmath156 is unbordered if and only if ( i ) @xmath154 is unbordered and ( ii ) @xmath162 . since the shortest border is itself unbordered , we obtain @xmath163 if @xmath11 is even .",
    "theorem [ unb ] directly yields , for each @xmath164 , @xmath165 therefore @xmath166 defining the generating function @xmath167 , we get @xmath168 the next step is to obtain a functional equation for @xmath169 : @xmath170 therefore @xmath171 successively substituting @xmath172 , @xmath173 , @xmath174 ,  , we get @xmath175 since it is easy to see that @xmath176 we obtain    @xmath177    a similar analysis was given previously by @xcite , although our analysis is slightly cleaner .",
    "there is also a relatively simple recurrence for @xmath178 , that is , for words with the longest border of length 1 .",
    "the particular case @xmath179 was previously given by harborth ( * ? ? ? * , eq .",
    "( 36 ) ) . in this section",
    ", we let @xmath180 denote @xmath178 , and let @xmath181 denote @xmath182 .",
    "[ bor1 ] @xmath183    verify that @xmath184 and @xmath185 , and let @xmath20 and @xmath152 be nonempty words with @xmath153 .",
    "consider words @xmath186 , @xmath187 and @xmath188 where @xmath189 are ( not necessarily distinct ) letters .",
    "the letter @xmath190 is the longest border of the word @xmath187 if and only if ( i ) @xmath190 is the longest border of @xmath186 and ( ii ) @xmath191 .",
    "moreover , ( i ) @xmath190 is the shortest border of @xmath186 , and ( ii ) @xmath192 @xmath193 if and only if @xmath190 is the shortest border of @xmath194 .",
    "this implies @xmath195 for @xmath196 odd .",
    "similarly , @xmath190 is the shortest border of @xmath188 if and only if ( i ) @xmath190 is the longest border of @xmath186 and ( ii ) @xmath197 . as above",
    ", we have to subtract the number of words @xmath194 with the longest border @xmath190 .",
    "it follows that @xmath198 for @xmath199 even .    from theorem  [ bor1 ]",
    ", we deduce @xmath200 using , we obtain @xmath201 defining the generating function @xmath202 , we then get @xmath203 a functional equation for @xmath204 is obtained as follows : @xmath205 we have @xmath206 and @xmath207 from here , we deduce @xmath208    we do not know how to obtain similar expressions for other border lengths .",
    "theorem [ rec ] , as well as explicit formulas from the previous section allow fast computer evaluation of @xmath93 and @xmath209 for large @xmath11 , and therefore also evaluation of @xmath210 and @xmath95 with high precision .",
    "we list some rounded values in the following tables .",
    "@xmath211    @xmath212    and some values of @xmath213 rounded to four decimal digits : @xmath214    for example , we see that a long binary word chosen randomly has about @xmath215 chance to be unbordered .",
    "a bit more probable , at @xmath216 , is that such a word will have its longest border of length one . over a five - letter alphabet , more than three words out of four",
    "are unbordered , on average .",
    "figure  [ fig1 ] shows the distribution of lengths of the shortest period for binary words of length @xmath217 .    , width=432 ]    [ fig1 ]    our original motivation was a question about the average period of a binary word .",
    "the answer is , that the border of a binary word has asymptotically constant expected length , namely @xmath218",
    "recently there has been some interest in computing the expected value of the largest unbordered factor of a word .",
    "this is a related , but seemingly much harder , problem .",
    "a.  loptev , g.  kucherov , and t.  starikovskaya . on",
    "maximal unbordered factors . in f.",
    "cicalese et  al . ,",
    "editor , _ cpm 2015 _ , volume 9133 of _ lecture notes in computer science _ , pages 343354 .",
    "springer - verlag , 2015 ."
  ],
  "abstract_text": [
    "<S> we investigate the behavior of the periods and border lengths of random words over a fixed alphabet . </S>",
    "<S> we show that the asymptotic probability that a random word has a given maximal border length @xmath0 is a constant , depending only on @xmath0 and the alphabet size @xmath1 . </S>",
    "<S> we give a recurrence that allows us to determine these constants with any required precision . </S>",
    "<S> this also allows us to evaluate the expected period of a random word . for the binary case , </S>",
    "<S> the expected period is asymptotically about @xmath2 . </S>",
    "<S> we also give explicit formulas for the probability that a random word is unbordered or has maximum border length one . </S>"
  ]
}