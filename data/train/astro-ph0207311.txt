{
  "article_text": [
    "random fields are widely used in astrophysics to model realistic scenarios of physical processes that depend on random components . for example",
    ", they are widely used in cosmology to model different types of galactic and extragalactic backgrounds ( e.g. , * ? ? ?",
    "the physical characteristics of the backgrounds are translated into statistical characteristics of the field .",
    "the fields are usually required to be ergodic so that information about the model can be extracted from a single realization of the field .",
    "in addition , they are assumed to be isotropic ( the correlation between two points depends only on the distance that separates them ) or homogeneous ( the correlation depends on the difference of their position vectors ) to reflect the geometry of the cosmological model .",
    "given the complexity of the cosmological models , characteristics of the fields are usually studied via monte carlo simulations where model predictions are compared with observations .    to simulate a gaussian random field we only need to specify the mean and spectrum ( or correlation function )",
    "but there are non - gaussian models whose predictions also have to be tested against observations . for example",
    ", standard inflationary models predict gaussian temperature fluctuations of the cosmic microwave background but there are other cosmological models that predict non - gaussian fluctuations @xcite .",
    "homogeneous non - gaussian random fields are more difficult to define and simulate , and since they are not uniquely determined by their first two moments , we often have to accept only a partial second order description of the fields .    @xcite ( hereafter _ vaw",
    "_ ) presented numerical methods for the simulation of homogeneous scalar random fields @xmath1 with prescribed one - dimensional distribution function ( marginal distribution ) @xmath2 and correlation structure .",
    "these methods can be used , for example , to generate cosmic microwave background maps with a given spectrum and a marginal distribution that allows for asymmetry or kurtosis in the pixel temperatures . in this paper",
    "we generalize these methods to the case of pair - wise correlated random fields defined on the same physical space .",
    "this will allow us , for example , to simulate backgrounds and source fields that are not independent , as in star - forming regions where the already formed stars are linked to the surrounding gaseous and dusty environment from which they originate .",
    "we consider random fields defined in @xmath0-dimensional `` parameter spaces '' where the coordinates @xmath3 may correspond to spatial / angular coordinates ( spatial random fields ) , time ( time processes ) , a mix of these two ( spatio - temporal random fields ) , or to even more general situations .",
    "we also consider the case of random fields defined on the sphere , that is , random fields that depend only on the direction in the sky .",
    "if the multivariate random field is @xmath4 , @xmath5,@xmath6 , @xmath7 , the goal is to generate a field with components @xmath8 having ( possibly different ) prescribed marginal distributions @xmath9 , prescribed correlation functions , and prescribed pair - wise cross - correlations .    in theory ,",
    "a complete description of a random field requires the definition of all finite - dimensional joint distributions , but , unless the field is gaussian , this is a terribly difficult task . in practical applications",
    "one only considers a second order description of the field that specifies the marginals @xmath9 , the means @xmath10 $ ] and the cross - covariance functions @xmath11,\\ ] ] where @xmath12 $ ] stands for expected value ( ensemble average ) .",
    "as mentioned before , it is often possible , even necessary , to adopt some simplifying assumptions like isotropy or homogeneity of the field @xmath13 . in the multidimensional context",
    ", isotropy means that the cross - covariance function depends on the length @xmath14 of the vector @xmath15 but not on its direction : @xmath16 . in this case",
    "the cross - correlation function ( normalized covariance function ) depends only on @xmath17 @xmath18 where @xmath19\\ ] ] and @xmath20 is the variance corresponding to the marginal @xmath9 . by definition ,",
    "@xmath21 for @xmath22 .",
    "although the isotropic case is of great interest in astronomical applications , here we consider multidimensional homogeneous random fields in general , that is , random fields whose covariance function depends on @xmath23 . in this case , the correlation function @xmath24 is defined as in equation ( [ eq : rhos ] ) but with @xmath23 instead of @xmath17 .",
    "the rest of the paper is organized as follows . in section [ sec :",
    "notes ] we describe a general procedure for generating non - gaussian random fields by point - wise transformations of gaussian ones . in section [ sec : practical ]",
    "we provide practical recipes for the methods outlined in section [ sec : notes ] and show how they can be used in either @xmath0-dimensional cartesian spaces or on the celestial sphere .",
    "section [ sec : examples ] presents some examples .",
    "we show simulated maps of the background and localized source field components of a far - ir sky map of the infrared space observatory ( iso ) . in the iso map , the locations and intensities of the sources",
    "are correlated with the background field and only a multidimensional simulation may reproduce such physical characteristic .",
    "in section [ sec : grf ] we discuss methods for generating homogeneous gaussian random fields with a prescribed correlation structure .",
    "the procedures are straightforward , at least in principle , while , in contrast , generating homogeneous non - gaussian fields is not a trivial task .",
    "fortunately , a large family of such fields can be obtained via pointwise transformations of homogeneous gaussian fields .",
    "these transformations are the basis of the methods used in _",
    "vaw _ to simulate non - gaussian scalar random fields . in this paper",
    "we generalize them to the multivariate case .",
    "we propose the following procedure for simulating multidimensional homogeneous non - gaussian fields @xmath13 with prescribed cross - correlation structure @xmath24 and one - dimensional marginals @xmath25 : ( a ) generate a zero - mean , unit - variance , homogeneous multivariate gaussian field @xmath26 with a fixed cross - correlation structure @xmath27 ; ( b ) transform @xmath26 to a non - gaussian field @xmath28 via @xmath29,\\ ] ] where @xmath30 . the problem is to determine a gaussian field @xmath26 and functions",
    "@xmath31 that transform @xmath27 into @xmath24 .    as discussed in _",
    "vaw _ , given marginals @xmath32 with no atoms ( a concentration of a finite probability mass at a point ) , the integral transform @xmath33= f^{-1}_{r_i } \\ { \\,f_{x } [ \\ , x_i({\\boldsymbol t})\\ , ] \\ , \\ } ; \\qquad i=1,2,\\ldots , m,\\ ] ] where @xmath34 denotes the standard gaussian distribution function and @xmath35 is the inverse distribution function of @xmath36 , provides a random field with marginals @xmath32 .",
    "since @xmath37 is a strictly monotonic function , transformation ( [ eq : map1 ] ) is invertible and @xmath38 can be calculated through @xmath39 ~[g_j(x_2 ) - \\mu_{r_j } ] ~\\phi(x_1 , x_2 ; \\rho_{x_i x_j}({\\boldsymbol{\\tau}}))~dx_1 ~dx_2,\\ ] ] where , @xmath40 , @xmath41 , and @xmath42^{1/2 } } ~\\exp \\left ( - \\frac{x_1 ^ 2 + x_2 ^ 2 - 2 \\rho_{x_i x_j}({\\boldsymbol{\\tau}})\\ , x_1 x_2}{2\\ , [ \\,1 - \\rho_{x_i x_j}^2({\\boldsymbol{\\tau}})\\ , ] } \\right).\\ ] ] for example , figure [ fig : rhos ] shows the relationship between @xmath43 and @xmath44 for some standard marginal distributions .",
    "equation ( [ eq : change ] ) can be used to solve for the cross - correlations of a gaussian field that transform to those of the non - gaussian field .",
    "@xcite show that @xmath38 is a monotonic increasing function of @xmath45 and that ( [ eq : change ] ) does not present invertibility problems",
    ". however , although via this inversion it is always possible to map a value of @xmath45 to its corresponding value @xmath38 , there is no guarantee that the resulting @xmath45 is in fact a non - negative definite function and hence a valid cross - correlation function .",
    "this condition must be checked ( see below ) .",
    "there are also restrictions on the distributions @xmath46 that can be obtained .",
    "for example , as already shown in _",
    "vaw _ , the values of @xmath44 that can be inverted are those in the interval @xmath47 $ ] , where @xmath48 and @xmath49 correspond , respectively , to the values of @xmath50 and @xmath51 of @xmath43 for a fixed function @xmath52 .",
    "this is clearly seen in figure [ fig : rhos ] where relationships between @xmath53 and @xmath54 for some classic distribution functions are shown .    to conclude this section we note that the fields @xmath36 can be forced to have a chosen mean @xmath55 and variance @xmath56 by applying the transformation @xmath57 without modifying the cross - correlation structure .",
    "to simulate a non - gaussian field @xmath13 via equations ( [ eq : map1 ] ) and ( [ eq : change ] ) we need to ( a ) determine the appropriate cross - correlation functions @xmath45 of the gaussian fields @xmath58 to be transformed , ( b ) check that @xmath27 is a non - negative definite function , and ( c ) simulate the gaussian fields @xmath58 .      in principle , @xmath45 can be obtained by inverting equation ( [ eq : change ] ) but this procedure is computationally expensive . instead , since the relationship between @xmath45 and @xmath38 is generally smooth , it is sufficient to choose a set of values in the interval @xmath59 $ ] for @xmath45 and to solve for their corresponding values @xmath38 via the numerical integration of equation ( [ eq : change ] ) .",
    "the complete relationship between the two correlation functions may be obtained by spline interpolation . the interpolated function",
    "is then used to determine @xmath45 as a function of @xmath23 .",
    "the function @xmath27 has to be non - negative definite to correspond to a homogeneous field .",
    "this means that every @xmath45 is a non - negative definite function and that the matrix @xmath27 is non - negative definite for each @xmath23 . to check this conditions just note that the fourier transform of @xmath45 , which provides the cross - spectrum between the fields @xmath58 and @xmath60 , must be a non - negative function .",
    "it is therefore sufficient to check that the @xmath0-fold fourier transform of @xmath45 does not take negative values for any pair @xmath61 .",
    "in addition , for any fixed @xmath23 , @xmath27 has to be a non - negative definite matrix and therefore its eigenvalues have to be non - negative .",
    "this is automatically checked within the field simulation procedure described in the sections below .          1 .",
    "determine the cross - spectra @xmath79 by applying the @xmath0-fold discrete fourier transform to @xmath27 .",
    "factor @xmath79 as indicated in equation ( [ eq : factor ] ) .",
    "3 .   generate a set of @xmath72 random fourier increments from equation ( [ eq : increment ] ) using a set of @xmath72 independent random phase angles uniformly distributed over @xmath89 $ ] , and a set of @xmath72 independent rayleigh deviates .",
    "the phase angles and the rayleigh deviates at different wave numbers must be independent .",
    "rayleigh deviates @xmath83 can be generated by the transformation @xmath90^{1/2}$ ] , where @xmath91 is a uniform random number on the interval @xmath92 $ ] @xcite .",
    "4 .   apply the ( @xmath0-fold ) inverse fourier transform of the random fourier increments to obtain a set of @xmath72 complex ( or @xmath93 real ) random fields .",
    "note that the factorization ( [ eq : factor ] ) of @xmath79 is not unique , there are a variety of methods that can be used , some being more stable than others .",
    "one possibility is to obtain @xmath94 via the singular value decomposition square root of @xmath79 @xmath95 where @xmath96 is a matrix whose columns are eigenvectors of @xmath97 , and @xmath98 is a diagonal matrix containing the corresponding eigenvalues .",
    "alternativeley , one can use the cholesky factorization , which may be more numerically stable @xcite . with either factorization it is easy to test if the matrix @xmath79 is non - negative definite for each @xmath74 . indeed ,",
    "if @xmath79 does not satisfy this condition the algorithm providing the cholesky factorization does not converge , and the matrix @xmath98 contains one or more negative entries .",
    "another point to consider is that , although we are interested in the numerical simulation of real valued random fields , the suggested procedure does not impose the necessary symmetry restrictions on the rayleigh deviates and phase angles in ( [ eq : mul5 ] ) to avoid complex values of the fields @xmath58 .",
    "however , if the rayleigh deviates and phase angles are generated with no symmetry restrictions , then the resulting field @xmath99 is complex with independent real and imaginary parts , each with cross - correlation matrix given by @xmath100 ( e.g. , * ? ? ? * ) .",
    "thus , the real and the imaginary parts of @xmath101 provide two independent real valued realizations of the desired random fields .",
    "a zero mean random field @xmath102 on the unit sphere is homogeneous if the covariance of the field between two different directions , @xmath103 and @xmath104 , depends only on the angular distance that separates them . in this case",
    "the correlation function can be written as @xmath105}{\\sigma^ 2_{rr}},\\ ] ] where @xmath106 , and @xmath107={\\rm e}\\,[\\,r({\\boldsymbol { r}}_2)^2\\,]$ ] .",
    "the field has the spectral representation @xmath108 where @xmath109 is a basis of spherical harmonics .",
    "the coefficients @xmath110 are zero mean complex uncorrelated random variables with variance that depends only on @xmath111 @xmath112 = \\sigma_\\ell^2,\\ ] ] and @xmath113 .",
    "similarly , a zero mean multivariate random field @xmath114 is homogeneous if each @xmath8 is a homogeneous field and the pair - wise cross - correlations depend only on the angular distance . in this case",
    "the cross - correlation function is as in ( [ eq : rhos ] ) but with @xmath115 taking the place of @xmath17 .",
    "the spectral representation of the cross - correlation function of @xmath116 is @xcite @xmath117 where @xmath118 is the legendre polynomial of degree @xmath111 and @xmath119 are non - negative definite matrices .",
    "the corresponding spectral representation of the multivariate field is @xmath120 where @xmath121 are @xmath122 zero mean complex random vectors with @xmath123 & = & { \\boldsymbol s}_\\ell,\\\\ { \\rm e}\\left[\\,{\\boldsymbol a}_{\\ell , m}\\,{\\boldsymbol a}_{\\ell , m}^*\\,\\right ] & = & { \\bf 0}\\quad\\quad\\mbox{for $ \\ell\\neq \\ell'$ or $ m\\neq m'$}.\\end{aligned}\\ ] ] each matrix @xmath124 can be factored as in equation ( [ eq : factor ] ) : @xmath125 as mentioned in the previous section , different factorizations lead to spectral estimates with different variance characteristics .",
    "any such factorization leads to representations like ( [ eq : mul5 ] ) and ( [ eq : idft ] ) for gaussian fields in terms of independent uniform random phases @xmath126 and independent rayleigh deviates @xmath127 @xmath128\\,y_{\\ell , m}({\\boldsymbol { r}})\\\\ & = & \\mbox{sft } \\big [ \\ , \\sum_s ( { \\boldsymbol h}_\\ell)_{ks}\\,\\xi_s(\\ell , m)\\,e^{\\iota\\theta_s(\\ell , m)}\\,\\big ] ; \\qquad",
    "i=1, ... ,m,\\end{aligned}\\ ] ] where sft stands for spherical fourier transform . for discrete implementations of the spherical fourier transform",
    "see , for example , @xcite and @xcite .",
    "we start with a simple numerical simulation .",
    "figure [ fig : cfields ] shows a simulation of three two - dimensional , isotropic , random fields with a standard gaussian @xmath129 , a @xmath130 , and a uniform @xmath131 as marginals , respectively . to illustrate different degrees of correlation in the simulation",
    ", we use the cross - correlation matrix @xmath132    the procedure used is the one described in section [ sec : practical ] with a matrix @xmath94 obtained by a cholesky factorization of @xmath79 .",
    "the marginal distributions in the three maps are very different ; the gaussian is symmetric about zero , the @xmath133 is nonnegative and right skewed , the uniform is bounded between zero and one .",
    "however , they all have the same autocorrelation function and there is a clear correlation between every pair of maps ; the correlation is stronger between the gaussian and the uniform because of the 0.9 coefficient in @xmath134 .",
    "_ vaw _ presented simulations of iso far - ir maps but their method was unable to integrate the correlation between the field of localized point sources and the diffuse background .",
    "this integration is needed since in the observed data the location and the intensity of the brightest sources are correlated with the brightest regions in the background . as a result ,",
    "the methodology presented in _",
    "wav _ is unable to satisfactorily reproduce the localized source features of the original iso map on large scale .",
    "we now show that the methods presented in the previous sections can account for this type of correlation information and efficiently exploit it in generating the simulated map .",
    "figure [ fig : map ] shows simulations of the random background and source components of a far - ir map obtained by the following procedure .",
    "figure [ fig : map]a is the _ observed _ map , recorded by the isophot camera @xcite on board the iso satellite @xcite at @xmath135 @xmath136 m , with a projected size of roughly @xmath137 @xcite .",
    "this map is used to generate a gaussian background field ( figure [ fig : map]b ) via fourier phase randomization .",
    "if physical models of the diffuse background were available , they could also be used to simulate this field .",
    "it is well known that extreme values of distributions can be used to generate point processes .",
    "for example , consider @xmath138 uncorrelated gaussian random variables .",
    "define @xmath0 as the number of @xmath139 above a threshold @xmath17 and @xmath140 $ ] . then @xmath0 is a binomial @xmath141 that can be approximated by a poisson with @xmath142 for @xmath143 large and @xmath144 small . in our case",
    "we need more than a point process for the location of the sources , we also need a distribution for their intensity . for this reason",
    "we have adopted a different approach based on gaussian mixtures .",
    "these distributions have been successfully used to model outliers and other types of nonstationary behavior in time series @xcite .",
    "recall that the distribution of a @xmath145-component gaussian mixture is of the form @xmath146 , where the @xmath147 ( @xmath148 ) define the probabilities of sampling from each of the gaussian distributions @xmath149 ( note that a gaussian mixture with more than one component is not gaussian ) .",
    "for the iso example we have used a mixture of two gaussian components for the marginal distribution of the pixels .",
    "the idea is the following .",
    "the location of the extreme values of this mixture define the point process , the intensities are defined by the gaussian distribution of the first mixture component .",
    "the second component generates an essentially zero background . for example , figure 4 shows a realization of the gaussian mixture used for figure 3c ( the intensities in the original iso map were normalized to unit standard deviation ) .",
    "we also define a cross - correlation function to correlate the location and intensities of the sources with the gaussian background in figure 3b .    since we do not have a separate image of the source field , in order to fix the parameters of the mixture , we identified point sources by choosing peaks in the original iso image .",
    "the mean and standard deviation of the selected sources were used to define the gaussian component with a fraction @xmath150 equal to the proportion of pixels identified as sources .",
    "we used a gaussian centered at zero with a small standard deviation for the second mixture component ( see figure 4 ) .",
    "this means that a proportion @xmath151 of the simulated observations are essentially zero .",
    "the rest of the observations have an intensity spread about the mean of the observed sources . in practice",
    "the gaussians are truncated to avoid numerical instabilities in the integral transform ( [ eq : map1 ] ) .",
    "finally we have to choose a cross - correlation matrix .",
    "to illustrate the correlation of the sources with the bright regions in the background , we used the cross - correlation function @xmath152 where @xmath153 is the auto - correlation function of the original iso map , @xmath154 $ ] is a constant , and @xmath155 is the correlation function introduced by the instrument s smoothing .",
    "the choice of this form for @xmath156 is based on a lack of sufficient information about the source field .",
    "in particular , the cross - correlation of the background and source fields is assumed to be a multiple of @xmath153 only for illustrative purposes ; there are of course applications where this is not true , see for example @xcite . for the same reason , we decided to assume that the correlations in the source field were introduced only by the gaussian beam smoothing of the instrument .",
    "figures [ fig : map]c , d show fields of sparse localized sources for @xmath157 and @xmath158 , respectively . in both cases ,",
    "the check described in section [ sec : invprob ] has confirmed that @xmath156 is a valid cross - correlation matrix for each @xmath17 .",
    "it is clear that the correlation of the locations and intensities of the sources with the background map of figure [ fig : map]b increases with @xmath159 .",
    "the application of this methodology for the realistic simulation of far - ir maps recorded by the array cameras on board the _ herschel _ satellite @xcite is under investigation .",
    "the combination of both physical models and observations is compelling in determining the types of distributions and cross - correlation functions that are appropriate for the particular application under investigation .",
    "we have described spectral methods for the simulation of homogeneous non - gaussian multivariate random fields with prescribed cross - correlation and marginal distributions . the basic idea is to apply pointwise transformations to homogeneous gaussian fields to guarantee the homogeneity of the field .",
    "the transformations are chosen to obtain the desired marginal distributions and cross - correlation function .",
    "the proposed methodology works for a wide range of cross - correlation functions and marginal distributions of general interest . among these",
    ", some gaussian mixture models may be useful to model fields of localized sources .",
    "we have illustrated the methods by simulating sky maps with background and source components that are physically linked .",
    "the same methods can also be applied to simulate and/or analyse more complex maps , such as those from all - sky surveys of the planck mission ( mandolesi et al . , 1998 ; puget et al . , 1998 ) .",
    "the objective of the planck satellite is to observe the cosmic microwave background anisotropies which account , however , for only a very small part of the much more conspicuous backgrounds , either galactic and extragalactic .",
    "sky maps will be produced at nine different frequencies but strong correlations are expected among different maps because of the wide frequency distribution of the expected emissions .",
    "many algorithms have been already tested to recover as much information as possible from the observed maps ( see e.g. maino et al . , 2001 and references therein ) .",
    "but to extract important cosmological information the methods should provide information on all the contributing components and should be able to model the correlations among them .",
    "the methods we have presented here are based on theoretically simple assumptions but do require data , or other available physical information , to select the correct model parameters ( cross - correlation function , marginal distributions , gaussian mixture parameters , etc . ) .",
    "appropriate modeling of more complex sky maps is the goal of future research .",
    "avelino , p.p . ,",
    "shellard , e.p.s .",
    ", wu , j.h.p . &",
    "allen , b. 1998 , , 507 , l101 diggle , p.j 1983 , statistical analysis of spatial point patterns ( london : academic press ) dilts , g. a. 1985 , journal of computational physics , 57 , 439 dole , h. , et al .",
    "2001 , , 372 , 364 driscoll , j. r. & healy , d. 1994 , adv . in appl .",
    ", 15 , 202 kessler , m.f . , et al .",
    "1996 , , 315 , l27 le , n. d. , martin , d. & raftery , a. e. 1996 , journal of the american statistical association , 91 , 1504 lemke , d , klaas , u. & abolins , j. 1996 , , 316 , l64 maino d. , et al .",
    "2001 , , _ submitted _ ( astro - ph/0108362 ) mandolesi n. , et al .",
    "1998 , planck low frequency instrument , a proposal submitted to esa martinez , v.j . &",
    "saar , e. 2001 , statistics of the galaxy distribution ( new york : chapman & hall ) mclachlan , g. & peel , d.a .",
    "2000 , finite mixture models ( new york : wiley ) mo , h.j . & white , s.d.m .",
    "1996 , mnras , 282 , 347 ogorodnikov , v.a .",
    "& prigarin , s.m .",
    "1996 , numerical modelling of random processes and fields : algorithms and applications ( utrecht : vsp ) peebles , p.j.e .",
    "1999 , , 510 , 531 pilbratt , g. 2001 , the first esa cornerstone mission , in iau symp .",
    "204 , the extragalactic infrared background and its cosmological implications , august 2000 manchester , eds .",
    "m. harwit & m.g .",
    "hauser ( san francisco : asp ) , 39 popescu , r. , deodatis , g. & prevost , h. 1998 , prob .",
    ", 13 , 1 priestley , m.b . 1981 , spectral analysis and time series ( london : academic press ) puget , j.l . ,",
    "1998 , high frequency instrument for the planck mission , a proposal submitted to esa ruan , f. & mclaughlin , d. 1998 , advances in water resources , 21 , 385 vio , r. , andreani , p. & wamsteker , w. 2001 , , 113 , 1009 ( vaw ) yaglom , a. m. 1986 , correlation theory of stationary random functions i ( new york : springer - verlag )"
  ],
  "abstract_text": [
    "<S> we provide theoretical procedures and practical recipes to simulate non - gaussian correlated , homogeneous random fields with prescribed marginal distributions and cross - correlation structure , either in a @xmath0-dimensional cartesian space or on the celestial sphere . </S>",
    "<S> we illustrate our methods using far - infrared maps obtained with the infrared space observatory . </S>",
    "<S> however , the methodology presented here can be used in other astrophysical applications that require modeling correlated features in sky maps , for example , the simulation of multifrequency sky maps where backgrounds , sources and noise are correlated and can be modeled by random fields . </S>"
  ]
}