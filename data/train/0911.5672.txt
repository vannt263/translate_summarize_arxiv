{
  "article_text": [
    "models for gene genealogies of biological populations often assume a constant , time - independent population size @xmath0 . this is the case for the wright - fisher model @xcite , for the moran model @xcite , and for their representation in terms of the coalescent @xcite . in real biological populations , by contrast",
    ", the population size changes over time .",
    "such fluctuations may be due to catastrophic events ( bottlenecks ) and subsequent population expansions , or just reflect the randomness in the factors determining the population dynamics .",
    "many authors have argued that genetic variation in a population subject to size fluctuations may nevertheless be described by the wright - fisher model , if one replaces the constant population size in this model by an effective population size of the form @xmath1 ( see , e.g. , @xcite for a review of different measures of the effective population size , and @xcite for recent extensions of this concept ) . the harmonic average in eq .",
    "( [ eq : neff ] ) is argued to capture the significant effect of catastrophic events on patterns of genetic variation in a population : if for example a population went through a a recent bottleneck , a large fraction of individuals in a given sample would originate from few parents .",
    "this in turn would lead to significantly reduced genetic variation , parameterised by a small value of @xmath2 .",
    "the concept of an effective population size has been frequently used in the literature , implicitly assuming that the distribution of neutral mutations in a large population of fluctuating size is identical to the distribution in a wright - fisher model with the corresponding constant effective population size given by eq .",
    "( [ eq : neff ] ) .",
    "however , recently it has been shown that this is true only under certain circumstances @xcite .",
    "it is argued by @xcite that the concept of an effective population size is appropriate when the time scale of fluctuations of @xmath3 is either much smaller or much larger than the typical time between coalescent events in the sample genealogy . in these limits",
    "it can be proven that the distribution of the sample genealogies is exactly given by that of the coalescent with a constant , effective population size .",
    "[ ] [ t]@xmath4 [ t][]@xmath5 [ ] [ ] * a * [ ] [ ] * b * [ ] [ ] * c * [ ] [ ] * d * [ ] [ ] * e *     numerically computed distributions @xmath6 of total branch lengths @xmath5 in genealogies of samples of size @xmath7 . the model employed in the simulations",
    "is outlined in sec .",
    "[ sec : sim ] .",
    "it describes a population subject to a time - varying carrying capacity .",
    "panels * a * to * e * show @xmath6 for populations with increasingly rapidly oscillating carrying capacity .",
    "the dashed red line in * a * shows a low - frequency approximation to @xmath4 obtained for a constant carrying capacity .",
    "the dashed red lines in * d * and * e * show the large - frequency approximations given by eq .",
    "( [ eq : large_w_approx ] ) .",
    "further numerical and analytical results on the frequency dependence of the moments of these distributions are shown in fig .",
    "[ fig : stoch_moments ] .",
    "parameter values ( see sec . [",
    "sec : sim ] for details ) : @xmath8 , @xmath9 , @xmath10 , and * a * @xmath11 , * b * @xmath12 , * c * @xmath13 , * d * @xmath14 , and * e * @xmath15 . ,",
    "width=302 ]    more importantly , it follows from these results that , in populations with variable size , the coalescent with a constant effective population size is not always a valid approximation for the sample genealogies .",
    "deviations between the predictions of the standard coalescent model and empirical data are frequently observed , and there is a number of different statistical tests quantifying the corresponding discrepancies ( see for example @xcite ) .",
    "the analysis of such deviations is of crucial importance in understanding for example human genetic history @xcite .",
    "but while there is a substantial amount of work numerically quantifying deviations , often in terms of a single number , little is known about their qualitative origins and their effect upon summary statistics in the population in question .",
    "illustrates the effect of population - size oscillations on the genealogy of a sample of size @xmath16 ( schematic ) . left : genealogy described by kingman s coalescent for a large population of constant size , illustrated by the light blue rectangle .",
    "right : sinusoidally varying population size .",
    "coalescence is accelerated in regions of small population sizes , and vice versa .",
    "this significantly alters the tree and gives rise to changes in the distribution of the number of mutations , and of the population homozygosity.,width=377 ]    the aim of this paper is to study the effect of population - size fluctuations on the patterns of genetic variation for the case where the scale of the population - size fluctuations is comparable to the time between coalescent events in the ancestral tree . as is well - known , empirical measures of genetic variation can usually be computed from the total branch length of the sample genealogy ( the expected number of single - nucleotide polymorphisms , for example , is proportional to the average total branch length ) . in the following we therefore analyse the distributions of the total branch lengths for sample genealogies in a population of fluctuating size .",
    "an example is given in fig .",
    "[ fig : dist ] which shows numerically computed branch - length distributions for a particular model population ( described in sec .",
    "[ sec : sim ] ) with a time - dependent carrying capacity .    as fig .",
    "[ fig : dist ] shows , the distributions depend in a complex manner on the form of the size changes .",
    "we observe that when the frequency of the population - size fluctuations is either very small or very large , the results are well described by kingman s coalescent with a constant ( effective ) population size .",
    "apart from these special limits , however , the form of the distributions appears to depend in a complicated manner upon the frequency of the population - size variation .",
    "the observed behaviour is caused by the fact that coalescence proceeds faster for smaller population sizes , and more slowly for larger population sizes , as illustrated in fig .",
    "[ fig : examples ] .",
    "but the question is how to quantitatively account for the changes displayed in fig .",
    "[ fig : dist ] .",
    "we show in this paper that the results of the simulations shown in fig .",
    "[ fig : dist ] are explained by a general expression  eq .",
    "( [ eq : corr2 ] )  for the moments of the distributions shown in fig .",
    "[ fig : dist ] .",
    "our general result is obtained within the coalescent approximation valid in the limit of large population size .",
    "but we find that in most cases , the coalescent approximation works very well down to small population sizes ( a few hundreds of individuals ) .",
    "our result enables us to understand and quantitatively describe the frequency dependencies of the distributions shown in fig .",
    "[ fig : dist ] .",
    "it makes possible to determine for example how the variance , skewness , and the kurtosis of these distributions depend upon the frequency of demographic fluctuations .",
    "this in turn allows us to compute the population homozygosity and to characterise genetic variation in populations with size fluctuations .",
    "the remainder of this paper is organised as follows . in sec .",
    "[ sec : obs ] we review how empirical observables are related to the branch lengths of the sample genealogies .",
    "section  [ sec : rec ] summarises our analytical results for the moments of the total branch length . in sec .",
    "[ sec : sim ] we describe the model employed in the computer simulations .",
    "the corresponding numerical results are compared to the analytical predictions in sec .",
    "[ sec : num ] . finally , in sec .",
    "[ sec : conclusions ] we summarise how population - size fluctuations influence the distribution of total branch lengths , discuss the implications for patterns of genetic variation , and conclude with an outlook .",
    "in this section we review how empirical observables are related to the branch lengths of the sample genealogies .    patterns of genetic variation reflect the gene genealogy corresponding to a given sample . within a neutral infinite - sites model , mutations are assumed to occur randomly at a constant rate @xmath17 on the genealogy . for a sample of size @xmath18",
    ", the number @xmath19 of single - nucleotide polymorphisms conditioned on the total branch length @xmath5 of the sample genealogy has a poisson distribution with mean @xmath20 ( here @xmath21 is a scaled mutation parameter , @xmath22 where @xmath23 is a suitable measure of the population size ) : @xmath24 similarly , moments of @xmath25 can be computed in terms of moments of @xmath5 .",
    "as is well known , the corresponding relations are most conveniently expressed in terms of the function @xmath26 from which the moments can be computed by repeated differentiation with respect to @xmath27 : @xmath28 note that @xmath29 is the probability of observing no mutations in a sample of size @xmath18 ( thus @xmath30 is the population homozygosity ) .",
    "the corresponding function for the moments of @xmath25 is found to be : @xmath31 for a constant population size , this equation is equivalent to eq .",
    "( 1.3a ) in @xcite .    in short ,",
    "the distribution of single - nucleotide polymorphisms is determined by the function @xmath26 , or equivalently by the moments @xmath32 .",
    "microsatellite loci by contrast are usually modeled in terms of a step - wise mutation model @xcite in which a mutation corresponds to either the gain or , equally likely , the loss of a repeat unit .",
    "provided that such steps ( mutations ) occur according to a poisson process , the distribution of the difference @xmath33 in the numbers of repeats between two randomly sampled sequences is determined by the function @xmath34 @xcite : @xmath35 in summary , the function @xmath36 ( or equivalently the moments @xmath37 ) allow to compute the statistical fluctuations of the numbers of single - nucleotide polymorphisms and of the number of steps in a step - wise mutation model . in sec .",
    "[ sec : rec ] we show how the moments and the function @xmath26 may be determined for a large neutral population subject to smooth population - size changes of otherwise arbitrary form .",
    "in this section we show how to calculate the function @xmath26 and the moments @xmath32 within the coalescent approximation , for a population with a smoothly varying size .    for @xmath38 ,",
    "the quantity @xmath39 is just the probability that @xmath40 sequences sampled at the present time are identical .",
    "thus in a population of constant size , @xmath26 is given by @xmath41 this recursion has the well - known solution ( with initial condition @xmath42 ) @xmath43    the question is how to obtain a corresponding expression for the case of a changing population size .",
    "we assume that in the limit of large population sizes , the changes in population size are described by a smooth curve @xmath44 , so that @xmath45 and @xmath46 at the present time , @xmath47 . as common in the coalescent approximation time",
    "is counted backwards , that is @xmath48 increases from the present ( @xmath47 ) to the past .     *",
    "a * illustrates the definition of the variables @xmath49 and @xmath50 used in the calculation of @xmath26 . in the example",
    "given , the sample size is @xmath51 . *",
    "b * illustrates the definition of the times in eq .",
    "( [ eq : tij2 ] ) .",
    ", width=453 ]    given a realisation of the curve @xmath52 , the function @xmath26 can be calculated as follows .",
    "the starting point is the joint distribution of times @xmath49 ( illustrated in fig .",
    "[ fig : theta]*a * ) .",
    "as shown by @xcite it can be written in terms the variables @xmath50 : @xmath53}\\,.\\ ] ] here @xmath54 and @xmath55 is the population - size intensity function defined by @xcite .",
    "the distribution of the times @xmath49 during which the sample genealogy has @xmath33 lines depends upon the sample size @xmath18 .",
    "this dependence is not made explicit here , neither in eq .",
    "( [ eq : ft ] ) nor in the following .",
    "the corresponding joint density for the variables @xmath56 is simply @xcite @xmath57}\\ ] ] ( for @xmath58 , and @xmath59 ) .",
    "now we make use of the fact that the total time is given by @xmath60 ( see fig .",
    "[ fig : theta]*a * ) .",
    "the function @xmath26 can therefore be written as @xmath61 expanding the multiple integrals one obtains @xmath62 } \\cdots           b_2 \\int_{s_3}^\\infty \\frac{{\\rm d}s_2}{x(s_2 ) } { \\rm e}^{-[\\lambda(s_2)+2q s_2]}\\,.\\ ] ] for small sample sizes @xmath18 , eq .",
    "( [ eq : r2 ] ) provides a convenient way of computing the function @xmath26 and the corresponding moments @xmath63 .",
    "for example , for @xmath64 one finds simply @xmath65 this makes it possible to compute the population homozygosity in large populations with arbitrary size variations , as well as the distribution of steps in a step - wise mutation model , according to eq .",
    "( [ eq : pj ] ) .    for large values of @xmath18 , by contrast , the large number of nested integrals in ( [ eq : r2 ] ) becomes increasingly difficult to evaluate . in this limit , however , the distribution is conveniently characterised in terms of its cumulants which can be expressed in terms of the moments @xmath32 .    in the remainder of this section",
    "we show how to calculate the moments for arbitrary sample sizes @xmath18 . according to eq .",
    "( [ eq : genf ] ) , these moments are obtained by repeated differentiation of eq .",
    "( [ eq : r2 ] ) .",
    "however , in the following we describe a more elegant approach making use of a result obtained by @xcite . as fig .",
    "[ fig : theta]*a * shows , an alternative expression for the total time is simply @xmath66 .",
    "the @xmath67-th moment of the distribution of @xmath5 is therefore @xmath68 where the variables @xmath69 can assume values between @xmath70 and @xmath67 ( subject to the constraint @xmath71 ) . in a population of constant size ,",
    "@xmath72 , the variables @xmath73 are independent and their correlation functions factorise . in general",
    "this is not the case : @xcite , for example , have calculated @xmath74 for a smoothly varying population ( eqs .",
    "( 2 ) and ( 3 ) in their paper ) .    in the following",
    "we show how the correlation functions of arbitrary order appearing in ( [ eq : tnk2 ] ) can be calculated in a very simple manner .",
    "consider first the case @xmath75 .",
    "we have @xmath76 here @xmath77 denotes the number of lines for a particular realisation of the coalescent process at time @xmath48 in a sample of size @xmath78 .",
    "the indicator function in eq .",
    "( [ eq : taujind ] ) is unity when @xmath79 and zero otherwise .",
    "averaging over realisations gives @xmath80 here @xmath81 is the conditional probability that @xmath18 ancestral lines at @xmath82 coalesce to @xmath83 lines at time @xmath84 .    for a constant population size ( @xmath72 ) , the coalescent is invariant under time translations , @xmath85 . here",
    "@xmath86 if @xmath87 and zero otherwise . the conditional probability @xmath88 was derived by @xcite . for @xmath89",
    "the result is : @xmath90 in the general case of a variable population size , as shown by @xcite , the conditional probability depends only on the intensity @xmath91 during the time - interval @xmath92 $ ] : @xmath93    now consider the case @xmath94 .",
    "for @xmath95 we have simply @xmath96 because the second indicator function vanishes when @xmath97 .",
    "averaging over realisations we find : @xmath98 this result is illustrated in fig .",
    "[ fig : theta]*b*. in deriving it we have used the multiplicative rule @xmath99 for @xmath100 , by contrast , we find @xmath101 which upon averaging yields @xmath102 more general correlation functions are readily obtained in terms of multiple integrals over the functions @xmath103 . inserting into ( [ eq : tnk2 ] )",
    "we see that the combinatorial factors @xmath104 @xmath105 @xmath106 cancel to obtain @xmath107 eq .",
    "( [ eq : corr ] ) provides an explicit expression for the moments of the total branch lengths @xmath5 in populations with smooth population - size variations .",
    "note that eq .",
    "( [ eq : corr ] ) expresses the @xmath67-th moment of @xmath5 in terms of a @xmath108-fold sum ( according to ( [ eq : gnm ] ) each factor of @xmath109 contains a sum over @xmath110 ) .",
    "( [ eq : corr ] ) can be further simplified by explicitly performing the sums over @xmath111 .",
    "this results in @xmath112}\\\\\\nonumber & & \\hspace*{2cm}\\cdots\\!\\ !",
    "\\int_{t_{k-1}}^\\infty\\!\\!\\!\\!\\!{\\rm d}{t_k } { \\rm e}^{-b_{j_k}[\\lambda(t_k)-\\lambda(t_{k-1})]}\\,.\\end{aligned}\\ ] ] the coefficients are determined by recursion : @xmath113 for the first moment , an expression corresponding to eq .",
    "( [ eq : corr ] ) for the particular case @xmath75 was derived by @xcite . evaluating ( [ eq : corr ] ) for @xmath75 using ( [ eq : corr2 ] ) and ( [ eq : d1 ] ) we find @xmath114 here @xmath115 denotes taking the integer part .",
    "this result is equivalent to eq .",
    "( 3 ) in @xcite , and also to the result obtained by summing eq .",
    "( 1 ) in @xcite . for @xmath94 ,",
    "the coefficients @xmath116 are tabulated in tab .",
    "[ tab:1 ] in appendix [ sec : b ] for small values of @xmath18 . in general ,",
    "the nested integrals in eq .",
    "( [ eq : corr2 ] ) can not be simplified further ; their form expresses the correlations of the times @xmath49 due to population - size variations .",
    "finally note that for @xmath64 , eq .",
    "( [ eq : corr ] ) can be evaluated to give ( [ eq : t2k ] ) .",
    "we show this explicitly because it demonstrates how the expression ( [ eq : corr ] ) simplifies when @xmath117 .",
    "we have @xmath118 this yields eq .",
    "( [ eq : t2k ] ) .",
    "we conclude this section by remarking that appendix [ sec : a ] summarises an alternative approach to calculating @xmath26 and the moments @xmath32 , again resulting in eqs .",
    "( [ eq : r2 ] ) and ( [ eq : corr ] ) . the approach described in appendix [ sec : a ] yields a simple recursion , eq .",
    "( [ eq : mom_9 ] ) , which allows for a convenient calculation of the moments @xmath32 .",
    "this result also demonstrates explicitly how the moments @xmath32 , for a given curve @xmath52 , depend upon the time at which the population is sampled .    in the following two sections we describe a simple population model subject to population - size variations , and",
    "compare results of numerical simulations of this model to the analytical results obtained above .",
    "the purpose of this section is to describe a modified wright - fisher model with fluctuating population size .",
    "this model is used in the numerical simulations of sample genealogies described in sec .",
    "[ sec : num ] .",
    "recall the three key assumptions of the wright - fisher model : ( a ) constant population - size , ( b ) discrete , non - overlapping generations , ( c ) a symmetric multinomial distribution of family sizes .",
    "we have adopted the following approach : in our simulations , assumptions ( b ) and ( c ) are still satisfied , but assumption ( a ) is relaxed .",
    "we study a large but finite population of fluctuating size @xmath119 , where @xmath120 labels the discrete , non - overlapping generations forward in time .",
    "the model we have adopted is the following : consider a generation @xmath121 consisting of @xmath119 individuals .",
    "the number of individuals in generation @xmath122 is then given by @xmath123 where the random family sizes @xmath124 are independent and identically distributed random variables having a poisson distribution with parameter @xmath125 ( specified below ) . consequently the number @xmath126 is poisson distributed with mean @xmath127 .",
    "this model exhibits a fluctuating population size @xmath119 , rapidly changing from generation to generation . as pointed out in the introduction , in large populations such fluctuations",
    "are averaged over by the ancestral coalescent process , and can be captured in terms of an effective population size .",
    "the resulting genealogies are simply described by kingman s coalescent for a constant effective population size of the form ( [ eq : neff ] ) .",
    "interesting population - size fluctuations occur on larger time scales , corresponding to slow variations of the population size over several generations .",
    "such slow changes are most commonly interpreted as consequences of a changing environment .",
    "a natural model for such changes is to impose a finite carrying capacity @xmath128 on the population which varies as a function of @xmath121 .",
    "this is the approach adopted in the following , and we choose @xmath129 for a certain parameter value @xmath130 . here",
    "@xmath131 is the carrying capacity in generation @xmath122 .",
    "if the environmental changes affected the population through fertility variations , @xmath131 would be replaced by @xmath132 in eq .",
    "( [ eq : lt ] ) .",
    "( [ eq : lt ] ) is chosen so that the population ceases to grow on average when the carrying capacity is reached ( @xmath133 for @xmath134 ) .",
    "when the population size is small , the population growth follows the logistic law , @xmath135 , where @xmath136 is the logistic growth rate .",
    "the particular form of eq .",
    "( [ eq : lt ] ) ensures that @xmath137 .",
    "note that fluctuations of @xmath119 in this model are due to two different sources : rapid fluctuations are caused by the randomness of the family sizes , slow fluctuations are caused by the time dependence of the carrying capacity .",
    "our choice for the time dependence of @xmath128 is dictated by the following considerations .",
    "the aim is to describe the influence of a fluctuating population size upon the statistics of genetic variation . to this end",
    "we need to consider the functional form of @xmath128 .",
    "a simple choice for @xmath128 is a periodically varying function , such as @xmath138\\,.\\ ] ] note that a more complex dependence of @xmath128 upon @xmath121 can be obtained from superpositions of such functions with different amplitudes @xmath139 and frequencies @xmath140 .",
    "here we use simply ( [ eq : ktau ] ) , and investigate how the statistics of genetic variation in a sample depends upon frequency of the fluctuations in @xmath128 .",
    "[ fig : nt ] shows a realisation of a curve @xmath119 obtained in this manner ( the choice of parameters is given in the figure caption ) .",
    "the figure clearly exhibits fluctuations in @xmath119 on two time scales . as pointed out above , we are interested in determining the effect of the size variations occurring at long time scales",
    ".     shows one realisation of the curve @xmath119 obtained from simulations of the model described in sec .",
    "[ sec : sim ] ( black solid line ) .",
    "choice of parameters : @xmath9 , @xmath141 , @xmath10 , and @xmath142 .",
    "also shown is an average over the fast fluctuations , @xmath143 $ ] , red dashed line .",
    "the upper horizontal axis illustrates where the population is sampled , and how time is counted backwards in the coalescent approximation .",
    "@xmath23 denotes the size of the population at the time of sampling.,width=302 ]    last but not least we note that conditional on the sequence of population sizes , the genealogy of a set of individuals sampled at time @xmath121 can be determined recursively by randomly choosing ancestors in the preceding generations .",
    "this is ensured by the assumption that , conditioned on the values of @xmath119 and @xmath126 , the family sizes follow a symmetric multinomial distribution @xmath144 .",
    "the resulting correspondence with the wright - fisher rule of reproduction ensures that the genealogies can be determined recursively in the way suggested above .",
    "in this section we discuss the numerically computed distributions shown in fig .",
    "[ fig : dist ] in terms of the results obtained using the coalescent approximation .",
    "the shapes observed in fig .  [ fig : dist ] are conveniently characterised in terms their mean @xmath145 , variance , skewness , and kurtosis : @xmath146 recall that for a normal distribution the skewness vanishes , and the kurtosis equals three .",
    "we can write the skewness and kurtosis in terms of the moments @xmath147 using @xmath148 and @xmath149 .    as argued in sec .",
    "[ sec : sim ] and as shown in fig .",
    "[ fig : nt ] , our model populations exhibit fast size changes due to the random distribution of family sizes .",
    "as pointed out in the introduction , these fluctuations are averaged over by the genealogical process and need not be considered .",
    "the model populations are also subject to slow ( and deterministic ) size fluctuations given by the time - dependence ( [ eq : ktau ] ) of the carrying capacity .",
    "averaging over the fast fluctuations these give rise to a smooth population - size dependence @xmath52 .",
    "( [ eq : ktau ] ) , the distribution of @xmath5 depends upon the instance in time when the population is sampled . in the simulations we sampled at a particular point ( illustrated in fig . [",
    "fig : nt ] as a dashed vertical line ) , so that @xmath150 here the frequency is given by @xmath151 , and time @xmath48 is now counted backwards , as in sec .",
    "[ sec : rec ] .",
    "if the population were sampled at a different time , the distribution @xmath4 of @xmath5 ( and hence its moments and the corresponding function @xmath26 ) would change : the distribution depends for example upon whether most recently the population was expanding or declining .",
    "the results derived in appendix [ sec : a ] make it possible to determine the corresponding changes to @xmath4 in a transparent manner , but we do not discuss this issue further here .",
    "[ fig : stoch_moments ] shows how the mean , variance , skewness , and kurtosis of the distribution of @xmath5 depend on the frequency @xmath152 of the population size variation , eq .",
    "( [ eq : xt ] ) . shown",
    "are results of numerical simulations of the model described in section [ sec : sim ] ( symbols ) , and results obtained within the coalescent approximation using eq .",
    "( [ eq : mom_9 ] ) .",
    "we observe that the coalescent approximation describes the results of the numerical simulations well , even for small population sizes .        in the numerical simulations we have found that , for very small population sizes , random fluctuations of @xmath119 around the time - dependent carrying capacity @xmath128 become increasingly important .",
    "since we suspected that the small deviations observed in fig .",
    "[ fig : stoch_moments]*a * for @xmath153 were due to such fluctuations , we performed slightly modified simulations imposing a deterministic law upon @xmath119 by forcing @xmath154 in every generation ( where @xmath128 is given by ( [ eq : ktau ] ) ) .",
    "comparison of the corresponding results ( not shown ) with fig .",
    "[ fig : stoch_moments]*a * indicates that the deviations for @xmath153 at large frequencies are indeed caused by the stochastic fluctuations in the population dynamics underlying fig .",
    "[ fig : stoch_moments]*a*. a different interpretation of this effect is the following : when the population size is very small , and when @xmath139 is close to unity , the population may exhibit a non - negligible probability of becoming extinct during the expected time to the most recent common ancestor for a sample of size @xmath18 . in this case",
    "we have conditioned on the existence of the population during @xmath155 generations using rejection sampling . in practice",
    "this avoids extinction , but it leads to a biased size distribution .",
    "consider now the frequency dependence of the moments shown in fig .",
    "[ fig : stoch_moments ]",
    ". it can be qualitatively and quantitatively understood using eq .",
    "( [ eq : corr2 ] ) together with the following expression for @xmath156 : @xmath157 we discuss the limits of small and large frequencies @xmath152 separately . in the limit of @xmath158 ,",
    "( [ eq : lt ] ) simplifies to @xmath159 .",
    "inserting this into ( [ eq : tn5 ] ) and approximating @xmath160 we find @xmath161 here @xmath162 and @xmath163 .",
    "( [ eq : tn6 ] ) is shown in fig .",
    "[ fig : stoch_moments]*a * as a dash - dotted line . to compute the variance we approximate @xmath164 } \\approx\\frac{1}{b_{j_1}b_{j_2}}+\\epsilon\\omega \\frac{b_{j_1}+2b_{j_2}}{b_{j_1}^2b_{j_2}^2}\\,,\\ ] ] and find an approximate expression for @xmath165 which results in the following expression for the variance : @xmath166 with @xmath167 .",
    "the limiting value for zero frequency is that of the standard coalescent with constant population size @xmath72 .",
    "( [ eq : vn ] ) is shown in fig .",
    "[ fig : stoch_moments]*b * as a dash - dotted line .",
    "similarly the standard results for the constant - size coalescent are obtained for the skewness and for the kurtosis in the limit of @xmath168 .",
    "this limiting behaviour is illustrated in fig .",
    "[ fig : dist]*a * which shows that the distribution of @xmath5 approaches that for kingman s coalescent for a constant population size @xmath72 in the limit of small frequencies .",
    "we note that for @xmath169 , the population - size dependence is essentially that of a declining population , because the time to the most recent common ancestor is reached before the first maximum in @xmath52 going backwards in time ( see fig .",
    "[ fig : nt ] and eq .",
    "( [ eq : xt ] ) .    of particular interest is the limit of large frequencies , as we now show .",
    "as the frequency tends to infinity , one expects that the coalescent process averages over the population - size oscillations , and the standard coalescent process with a constant effective population size should be obtained . for large but finite frequencies , by contrast , fig .",
    "[ fig : stoch_moments]*a * exhibits deviations from the standard coalescent behaviour . in the following we analyse the behaviour of the moments in this regime . in the limit of large frequencies ,",
    "( [ eq : lt ] ) simplifies to @xmath170 for large frequencies , the function @xmath156 is well approximated by a shifted linear function @xmath171 here @xmath172 is the effective population size according to eq .",
    "( [ eq : neff ] ) , it describes the influence of the demographic fluctuations upon the part of the genealogy in the far past .",
    "the small offset @xmath173 describes the influence of demographic changes on the most recent part of the genealogy .",
    "inserting the approximation ( [ eq : l0 ] ) into ( [ eq : corr2 ] ) we find for large frequencies ( and when the amplitude @xmath139 is not too close to unity ) : @xmath174 the first term in ( [ eq : tn7 ] ) is the expected time of kingman s coalescent for a constant effective population size @xmath175 . the curve corresponding to ( [ eq : tn7 ] )",
    "is shown as a dashed line in fig .",
    "[ fig : stoch_moments]*a*.    we now discuss the behaviour of the variance shown in fig .",
    "[ fig : stoch_moments]*b*. for the second moment we find : @xmath176 the first term in eq .",
    "( [ eq : tn11 ] ) corresponds to the second moment of @xmath5 in kingman s coalescent with a constant effective population size @xmath175 . the second term in ( [ eq : tn11 ] ) represents a correction due to finite but large frequencies",
    ", it depends in a simple fashion on the effective population size @xmath175 and on the sample size @xmath18 .    comparing eqs .",
    "( [ eq : tn7 ] ) and ( [ eq : tn11 ] ) we arrive at the conclusion that the corresponding correction for the variance @xmath177 vanishes .",
    "this is consistent with the fact that , at large frequencies , the variance of @xmath5 is surprisingly insensitive to changes in frequency ( as opposed to the behaviour of @xmath145 , see fig .",
    "[ fig : stoch_moments]*a * and * b * ) .",
    "in fact , the limiting value ( shown in fig .",
    "[ fig : stoch_moments]*b * as a dashed line ) is a very good approximation to @xmath177 down to @xmath178 .",
    "consider now the skewness and the kurtosis shown in figs .",
    "[ fig : stoch_moments]*c * and * d*. their behaviour is similar to that of the variance : over a substantial range , the skewness and the kurtosis are essentially independent of @xmath152 .",
    "the results shown in fig . [ fig : stoch_moments ] imply that over a large range of frequencies , the distribution of the total branch lengths @xmath5 can be approximated as follows : the distribution is essentially that of the standard kingman coalescent with an effective population size @xmath175 , but the distribution is shifted such that its mean is given by eq .",
    "( [ eq : tn7 ] ) , rather than by @xmath179 .",
    "one may wonder when this rigid shift occurs .",
    "( [ eq : corr ] ) it is straightforward to work out the fluctuations of the times @xmath49 within the approximation ( [ eq : l0 ] ) .",
    "we find that for @xmath180 , the expected value of @xmath49 is exactly that of the standard kingman coalescent with effective population size @xmath175 .",
    "but for @xmath181 it is rigidly shifted by @xmath182 .",
    "this indicates that the genealogies are essentially those of the standard coalescent , but modified by an initial rigid shift . in the parameter regime",
    "discussed here , the distribution of times is expected to be well approximated by a two - parameter family of distributions : @xmath183^{n-1 }   \\end{aligned}\\ ] ] when @xmath184 , and @xmath185 for smaller values of @xmath186 .",
    "the first parameter is the effective population size @xmath175 which determines the slope of the function @xmath156 at large times and describes the demographic effect on the far past of the genealogy .",
    "the second parameter , @xmath187 describes the influence of the demographic fluctuations on the initial part of the sample genealogy .",
    "this parameter can be negative ( initial population expansion , this is the case shown in fig .",
    "[ fig : stoch_moments ] ) or positive ( initial population decline ) . when @xmath188 , the distribution @xmath4 is rigidly shifted to the left . in this case",
    "the approximation ( [ eq : l0 ] ) is expected to break down when the body of the distribution reaches @xmath189 .",
    "note that the distribution ( [ eq : large_w_approx ] ) can not be described by a single parameter ( a generalised effective population size ) .",
    "the approximation ( [ eq : large_w_approx ] ) was used to generate the red dashed curves in fig .",
    "[ fig : dist]*d * and * e*.",
    "the aim of this paper was to investigate how the frequency of smooth population - size fluctuations determines the shape of the distribution of total branch lengths of sample genealogies , and thus of statistical measures of genetic variation .",
    "we have performed simulations for a modified wright - fisher model of a population subject to a time - periodically varying carrying capacity and have determined the distribution of the total branch lengths , shown in fig .  [",
    "fig : dist ] .",
    "we have characterised how the shapes of the distributions depend upon the frequency of the population size fluctuations by computing the frequency dependence of the moments of these distributions .",
    "we could explain these dependencies in terms of coalescent approximations .",
    "in particular , we derived a general expression  eq .",
    "( [ eq : corr2 ] )  for the moments @xmath32 in populations subject to smooth population changes of otherwise arbitrary form .",
    "our results show how quickly ( or slowly ) the standard coalescent result for a constant ( effective ) population sizes is recovered in the limits of large and small frequencies .",
    "more importantly , our coalescent results allow to determine how significant deviations are at large but finite frequencies . in this case",
    "we have argued that at large frequencies , the distribution of @xmath5 is essentially that of the standard kingman coalescent with an effective population size @xmath175 , but with a shifted mean value @xmath190 the first term on the rhs corresponds to the result of the standard kingman coalescent with constant effective population size @xmath175 .",
    "the second term on the rhs is the correction term resulting from the population - size variations ( @xmath139 is the amplitude of the population - size oscillations , @xmath152 its frequency , and @xmath18 is the sample size ) .",
    "last but not least we have found that the coalescent approximation yields a reliable description of the numerical data , even for very small populations .",
    "these results enable us to determine how the distribution of the number @xmath25 of mutations ( single - nucleotide polymorphisms ) in a sample of size @xmath18 depends upon the frequency and on the amplitude of population - size fluctuations : eq .",
    "( [ eq : psn ] ) allows to compute moments of @xmath25 from eq .",
    "( [ eq : corr2 ] ) . in this way we have determined",
    "the mean , variance , skewness , and the kurtosis of the distribution of @xmath25 .",
    "the results are shown in figs . [",
    "fig : sn1 ] and [ fig : sn100 ] .            as expected , the moments of @xmath25 approach those of @xmath20 as the scaled mutation parameter @xmath21 increases .",
    "this can be verified by comparing the red curves ( corresponding to @xmath10 ) in fig .",
    "[ fig : sn100 ] to the red curves in fig .",
    "[ fig : stoch_moments ] .",
    "the higher moments converge more slowly than the mean and the variance . in conclusion ,",
    "[ fig : sn1 ] and [ fig : sn100 ] demonstrate that the distribution of the number @xmath25 of mutations in samples of size @xmath18 depends in a complex manner on the amplitude and on the frequency of the population - size variations , and on the mutation parameter @xmath21 .",
    "we close with a number of remarks .",
    "first , eq .",
    "( [ eq : corr2 ] ) is easily generalised to describe the moments of observables which are polynomial functions of the times @xmath49 ( see fig .",
    "[ fig : theta]*a * for a definition of these times ) .",
    "particularly simple is the case of observables @xmath191 that are linear functions of the times @xmath49 , @xmath192 . in this case",
    "the @xmath67-th moment of @xmath193 is given by eq .",
    "( [ eq : corr2 ] ) , but with modified coefficients : the factors @xmath83 in eqs .",
    "( [ eq : d1 ] ) and ( [ eq : d2 ] ) are replaced by @xmath194 .",
    "second , some observables ( such as the f - statistic @xcite ) can be written as linear functions of @xmath49 , but with random coefficients . in this case",
    "too it is possible to explicitly compute the moments of the distribution of the observable .",
    "these two questions are addressed in a separate paper @xcite .",
    "third , a result derived in appendix [ sec : a ] , eq .",
    "( [ eq : mom_9 ] ) , allows us to determine in a transparent fashion how the fluctuations of @xmath5 and other observables depend upon the time at which the population is sampled .",
    "this will make it possible to discuss for example how tajima s @xmath195-statistic or the @xmath196-statistic depend upon the time of sampling after a bottleneck , a population expansion , or a decline .",
    "fourth , population - size fluctuations are sampled non - uniformly by the genealogies : initial coalescent events occur at faster rates and are thus more sensitive to recent size fluctuations .",
    "remote coalescent events , by contrast , occur at slower rates thus damping the effect of size fluctuations in the far past .",
    "we therefore expect significant deviations from the standard coalescent behaviour arising from the most recent history for large sample sizes @xmath18 . it would be interesting to quantify this expectation by computing the covariances and higher moments of the times @xmath49 during which the sample genealogy has @xmath33 lines : first for large @xmath197 and @xmath198 we expect to observe strong correlations @xmath199 and thus deviations from the coalescent .",
    "second for small values of @xmath200 and @xmath33 we expect the times @xmath201 and @xmath49 to de - correlate and to follow the distribution of the standard coalescent ( with an effective population size ) .",
    "fifth , the model introduced in sec .",
    "[ sec : sim ] assumes a carrying capacity that varies sinusoidally , with a single frequency .",
    "it turns out , however , that our findings are valid for arbitrary time - dependent fluctuations with sufficiently strong modes at small frequencies .",
    "examples are linear combinations of high - frequency oscillations , or stochastic fluctuations around a constant population size with sufficiently short auto - correlation time . in this more general case ,",
    "too , we expect that @xmath156 is well approximated by ( [ eq : l0 ] ) .",
    "if this is the case , the distribution of times is of the form ( [ eq : large_w_approx ] ) when @xmath187 is small .    taken together , the results derived in this paper give a rather complete understanding of the fluctuations of empirical observables due to smooth population size variations .",
    "these results will be significant when attempting to disentangle the effects of population - size variations from other factors influencing genetic variation .",
    "our results raise the question under which circumstances the deviations from standard coalescent behaviours due to population - size fluctuations ( figs .",
    "[ fig : dist ] , [ fig : stoch_moments ] , [ fig : sn1 ] , and [ fig : sn100 ] ) are most likely to strongly affect the interpretation of empirical data .",
    "as our analysis indicates , the deviations become substantial when the frequency @xmath151 is of the order of or less than the inverse expected time between coalescent events in the sample . here",
    "@xmath140 is the frequency of the population size variations , eq .",
    "( [ eq : xt ] ) , and @xmath202 is a suitable measure of the population size ( the arithmetically averaged carrying capacity in our example ) . in other words ,",
    "rapid population - size fluctuations will have the strongest effect ( other than simply determining the effective population size , eq .",
    "( [ eq : neff ] ) ) in small local sub - populations with restricted gene flow between sub - populations with different fluctuations .",
    "the deviations are expect to be smaller at larger spatial scales , because the ancestral process averages over the spatial fluctuations .",
    "more generally , we conclude that deviations from standard coalescent behaviour are expected for populations subject to an environment which smoothly changes as a function of space and time .",
    "an example for such a population is the marine snail _",
    "l. saxatilis_. its habitat on the northern coast of bohusln ( sweden ) is fragmented into sub - populations with strongly restricted gene flow between them , effective population sizes of sub populations have been found to be very small @xcite . starting from the results derived in this paper , we hope to determine gene genealogies in such fragmented populations subject to smooth variations of population size in space and time .    _",
    "acknowledgements_. support from vetenskapsradet , the bank of sweden tercentenary foundation , and from the centre for theoretical biology at the university of gothenburg are gratefully acknowledged .",
    "25 natexlab#1#1    , b.  jung - muller , b.  godelle , and p.  gouyon , 1997 evolution of coalescence times , genetic diversity and structure during colonization .",
    "biol . * 51 * : 148164 .    ,",
    "1982 the concept of the effective population size .",
    "popul . biol . *",
    "21 * : 373378 .",
    ", 1930 _ the genetical theory of natural selection._. clarendon , oxford .    , and w.  li , 1993 statistical tests of neutrality of mutations .",
    "genetics * 133 * : 693709 .    , and m.  f. hammer , 2006 reconstructing human origins in the genomic era .",
    "* 7 * : 669680 .    , and s.  tavar , 1994 sampling theory for neutral alleles in a varying environment .",
    "b * 344 * : 403410 .    , and s.  sagitov , 2004 convergence to the coalescent in populations of substantially varying size . journal of applied probability * 41 * : 368378 .    , 2009 private communication .    , and s.  krone , 2003 the coalescent process in a population with stochastically varying size .",
    ". prob . * 40 * : 3348 .    , and r.  chakraborty , 1996 measures of variation at dna repeat loci under a general stepwise mutation model .",
    "theoretical population biology * 50 * : 345367 .    , 1982 the coalescent .",
    "* 13 * : 235248 .    , 1958 random processes in genetics .",
    ". soc . * 54 * : 6071 .    , and",
    "s.  krone , 2003 _ modern developments in population genetics : the legacy of gustave malcot_. oxford university press , oxford , 194232 .    , and m.  kimura , 1973 a model of mutation appropriate to estimate the number of electrophoretically detectable alleles in a finite population .",
    "genet res * 22 * : 201204 .    , m.  rafajlovic , b.  mehlig , and a.  eriksson , 2010 external branch lengths of genealogies in expanding and in declining populations . unpublished .    , i.  kaj , s.  krone , m.  lascoux , and m.  nordborg , 2005 on the meaning and existence of an effective population size .",
    "genetics * 169 * : 10611070 .",
    ", 1996 gene genealogies within mutant allelic classes .",
    "genetics * 143 * : 579587 .    , 1989 statistical method for testing the neutral mutation hypothesis by dna polymorphism .",
    "genetics * 123 * : 585595 .    , 1984 evolution of coalescence times , genetic diversity and structure during colonization . theor .",
    "* 26 * : 119164 .    ,",
    "2004 _ ancestral inference in population genetics_. springer , berlin , 1188 .    , and o.  sargsyan , 2009 extensions of the coalescent effective population size .",
    "genetics * 181 * : 341345 .    , 1975 on the number of segregation sites in genetical models without recombination .",
    "* 7 * : 256276 .",
    ", 1931 evolution in mendelian populations .",
    "genetics * 16 * : 97159 .    , y.  fu , s.  shi , and c.  wu , 2006 statistical tests for detecting positive selection by utilizing high - frequency variants .",
    "genetics * 174 * : 14311439 .    , and t.  wiehe , 2008 second - order moments of segregating sites under variable population size .",
    "genetics * 180 * : 341357 .",
    "in this appendix we demonstrate and alternative way of calculating function @xmath26 and the moments @xmath32 within the coalescent approximation .     *",
    "a * illustrates the definition of @xmath203 which for @xmath38 is the probability that @xmath18 sequences sampled at time @xmath48 are identical .",
    "the corresponding branches in the tree are drawn as solid lines , and @xmath204 in the figure . *",
    "b * shows schematically how the population size @xmath52 depends upon time.,width=340 ]    given a realisation of the curve @xmath52 , the function @xmath26 can be calculated as follows .",
    "consider the function @xmath203 that is , for @xmath38 , the probability that @xmath18 sequences sampled at time @xmath48 are identical .",
    "the time argument describes how @xmath36 depends upon the time at which the population is sampled , given a smooth population - size curve @xmath52 .",
    "the definition of @xmath203 is illustrated for the case @xmath205 in fig .",
    "[ fig : theta2 ] . in secs .",
    "[ sec : rec ] and [ sec : num ] , the populations were sampled at @xmath47 , which corresponds to the choice @xmath206 . the more general quantity",
    "@xmath203 allows to determine how the fluctuations of sample genealogies depend upon the time of sampling ( in a population of constant size , @xmath36 is independent of @xmath48 ) .    to obtain a recursion for @xmath203 in a population of fluctuating size ,",
    "take @xmath207 and consider a small time interval @xmath208 .",
    "a change in @xmath36 during this time interval is due to either a mutation in one of the ancestral lines , or to two ancestral lines having a common ancestor .",
    "thus , to first order in @xmath208 @xmath209 f_n(q , t + \\delta t )   +   \\frac{n ( n-1)}{2 x(t)}\\delta t f_{n-1}(q , t+\\delta t ) .",
    "\\end{aligned}\\ ] ] taking the limit @xmath210 , we obtain : @xmath211 f_n(q , t ) - \\frac{n ( n-1)}{2 x(t ) } f_{n-1}(q , t ) .",
    "\\end{aligned}\\ ] ] the recursion is terminated by @xmath212 for all values of @xmath48 . in a population of constant size @xmath72 , @xmath203 does not depend upon @xmath48 and the result ( [ eq : fn ] ) is immediately recovered from ( [ eq : fn_der_2 ] ) . to find the general solution , eq .",
    "( [ eq : fn_der_2 ] ) is rewritten as follows : @xmath213 } f_{n-1}(q , s)\\,.\\ ] ] it is convenient to consider the function @xmath214 .",
    "it obeys the recursion @xmath215 here @xmath216 is the operator @xmath217 and @xmath218 . in terms of this operator ,",
    "the recursion is simply solved by repeated action of @xmath216 on the function @xmath219 : @xmath220 where we have used the fact that @xmath221 .",
    "noting that @xmath222 we obtain the desired expression ( [ eq : r2 ] ) for @xmath26 : @xmath223    the moments @xmath32 can be calculated in a similar fashion .",
    "consider the function @xmath224 describing the moments of the total length of all solid branches shown in fig .",
    "[ fig : theta2 ] .",
    "then @xmath225 , and @xmath224 obeys the recursion : @xmath226\\ , .",
    "\\end{aligned}\\ ] ] we introduce the function @xmath227 . with the initial conditions @xmath228 for @xmath229 and @xmath230 for @xmath231 ,",
    "the recursion ( [ eq : mom_1 ] ) is simply : @xmath232 where @xmath233 is the integral operator @xmath234 .",
    "now we show that the action of the chain @xmath235 of operators on an arbitrary function @xmath236 can be represented in terms of a single integral . to show this ,",
    "it is convenient to make a change of variables to @xmath237 : @xmath238 the task is to seek a kernel @xmath239 such that for any function @xmath236 @xmath240 the kernel must satisfy @xmath241 together with the initial condition @xmath242\\ , h(z'-z)$ ] , this recursion allows to compute the kernel in closed form .",
    "this can for example be achieved by considering the laplace transform of ( [ eq : kernel ] ) .",
    "we find : @xmath243 this kernel can be used to evaluate ( [ eq : mom_5 ] ) . for any function @xmath244",
    "we have that @xmath245 with @xmath246 ( and @xmath247 ) . inserting this result into ( [ eq : mom_5 ] ) yields @xmath248 identifying @xmath249 we find @xmath250 this recursion yields eq .",
    "( [ eq : corr ] ) .",
    "in tab . [ tab:1 ] we give the coefficients @xmath251 determining the second moment @xmath253 according to eq .",
    "( [ eq : corr2 ] ) for @xmath252 .",
    "note that the coefficient for @xmath64 is consistent with eq .",
    "( [ eq : t2k ] ) ."
  ],
  "abstract_text": [
    "<S> we consider neutral evolution of a large population subject to changes in its population size . for a population with a time - variable carrying capacity </S>",
    "<S> we have computed the distributions of the total branch lengths of its sample genealogies . within the coalescent approximation we have obtained a general expression  eq .  </S>",
    "<S> ( [ eq : corr2 ] )  for the moments of these distributions for an arbitrary smooth dependence of the population size on time . </S>",
    "<S> we investigate how the frequency of population - size variations alters the distributions . </S>",
    "<S> this allows us to discuss their influence on the distribution of the number of mutations , and on the population homozygosity in populations with variable size . </S>",
    "<S> +   + _ keywords : _ population - size fluctuations , population homozygosity , genealogy , single - nucleotide polymorphims , coalescent approximation </S>"
  ]
}