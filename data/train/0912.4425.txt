{
  "article_text": [
    "numerous numerical methods have been devised to solve maxwell s equations in both time@xcite and frequency@xcite domains .",
    "we refer to these schemes as direct solvers , since they compute the electric and magnetic fields based on current sources , charge distributions and surrounding dielectric and/or metallic structures . while extremely useful in simulating optical components , using direct methods to design optical components , especially in two or three dimensions ,",
    "typically requires an extremely time - consuming brute force search in a large parameter space@xcite .    on the other hand",
    ", an inverse solver would be much more adept in such design and optimization problems@xcite . in this work ,",
    "we define the inverse problem as that where the electromagnetic field is known , but the surrounding structure is not known .",
    "the goal in the inverse problem is , then , to find a dielectric structure that will produce that specific electromagnetic field profile .",
    "we show that one can design nanophotonic resonators by specifying the electromagnetic field and its desirable characteristics ( such as cavity quality ( q ) factor and/or mode volume ) and then using an inverse solver to find the corresponding dielectric structure .",
    "we show that the inverse method used is not only computationally - fast , but is also able to optimize for multiple device characteristics and produce multiple resonances , both of which are very difficult using direct methods .",
    "we start from the time - harmonic eigenvalue equation @xmath0 where @xmath1 , @xmath2 , @xmath3 and @xmath4 are the magnetic field , relative permittivity , resonance frequency and speed of light respectively . to solve the problem numerically , @xmath1 and @xmath2 are discretized in space using the standard yee cell used in finite difference methods@xcite .",
    "also , the curl operators , since they are linear , are represented by the matrix @xmath5 .",
    "eq .   can now be written as @xmath6 where @xmath7 in this form , given @xmath8 , we can solve the direct problem by computing @xmath9 using an eigenvalue solver@xcite .",
    "however , we note that eq .   is also linear in @xmath8 , which allows us , if @xmath9 is held constant , to solve the inverse problem by expressing eq .   as @xmath10 where @xmath11 here",
    ", @xmath12 is the matrix with the values of @xmath13 along the main diagonal and zeros elsewhere .",
    "second to complete on a generic desktop computer .",
    "the periodic singularities in the dielectric structure are non - physical and will be addressed later in the article . ]",
    "the result of applying this method to a simple one - dimensional problem is shown in fig .",
    "[ ls pic ] . a generic least - squares",
    "solver  @xcite was used to find the dielectric structure , @xmath14 ( green region ) , that exactly produces the target field , @xmath9 ( blue line ) , using eq .  .",
    "using a generic desktop computer , the solution was obtained in less than a second . then a finite - difference time - domain ( fdtd ) solver",
    "was used to obtain the actual field ( red circles ) produced by the structure and to verify the accuracy of @xmath14 .",
    "as expected , fig .",
    "[ ls pic ] shows that the target field is reproduced exactly by the dielectric structure .",
    "however , the resulting structure is full of undesireable singularities .",
    "the rest of the section focuses on producing a well - behaved dielectric structure that still reproduces the target field accurately .",
    "the simplest way to produce a well - behaved dielectric structure is to add a regularization term to our least - squares problem , @xmath15 which is equivalent to solving the following optimization problem @xmath16 here @xmath17 represents some initial guess for the dielectric structure , that we want the values of @xmath14 to stay close to .",
    "this method allows us to trade off accuracy in order to keep @xmath2 close to acceptable values , by increasing @xmath18 .",
    "we chose to constrain @xmath2 around a constant value of @xmath19 and solved the least - squares system for @xmath20 , @xmath21 , and @xmath22 . the results , each still obtained in under a second ,",
    "are shown in fig .",
    "[ regls pic ] and illustrate the trade - off between constraining @xmath2 and accurately reproducing @xmath1 .    , and",
    "the computation time remains below @xmath23 second .",
    "as the regularization parameter , @xmath18 , is increased , @xmath2 is increasingly constrained to a chosen constant value of @xmath24 . at the same time , the mismatch between target and actual fields increases markedly .",
    "this illustrates the apparent trade - off between producing reasonable structures and accurately reproducing a fixed target field . ]",
    "the fundamental problem in the previous examples is actually not in the methods themselves , but in the improper selection of a target field . in fact , it is very difficult to select a suitable target resonant field because not every resonant mode even has a corresponding dielectric structure that is able to reproduce it .",
    "furthermore , it is nearly impossible to select a multi - dimensional field which corresponds to a well - behaved , isotropic and discretely - valued @xmath2 , as would be needed for practical structures .    for this reason",
    ", a successful method must be allowed to either modify the target field , or specify it completely , in which case the user would only determine certain characteristics ( e.g. mode - volume , q - factor ) that the target field should have .",
    "the former strategy is developed in both one and two dimensions , while the latter strategy is implemented in section [ sec:2dbounded ] in order to design two - dimensional resonators with discrete values of @xmath2 .",
    "we start with the same target field as in the previous examples but we now formulate a method that allows for it to be modified during the design process . the formulation chosen is a complementary optimization routine , where we continually alternate between modifying @xmath2 to better fit the field , and then modifying the field to better fit @xmath2 . here , we use the term `` fit '' to mean that either @xmath2 or @xmath1 is solved so that the residual error from eq .",
    "is minimized .",
    "additionally , both iterations are regularized in order to stably approach a solution .",
    "this algorithm can be summarized as follows , @xmath25 where @xmath26 , @xmath27 and @xmath28 .",
    "@xmath29 is used instead of @xmath30 to avoid the trivial @xmath31 solution and does not affect the overall accuracy since @xmath9 changes very slowly .     and",
    "[ regls pic ] is used as the initial target field .",
    "the rates of change for both @xmath2 and @xmath1 are controlled by regularization parameters @xmath32 and @xmath33 respectively .",
    "the @xmath34 iterations used to achieve this result took @xmath35 seconds to compute .",
    "this method results in a well - behaved @xmath2 that actually produces a field very similar to the original target field .",
    "interestingly , the formation of a `` steady - state '' periodic structure toward the sides of the structure has emerged . ]",
    "[ comp pic ] shows that the complementary optimization algorithm , after @xmath34 iterations and with the correct choice of regularization parameters @xmath36 and @xmath37 , results in a well - behaved structure that is able to closely reproduce the modified target field .",
    "numerically , the least - squares problem must now be solved numerous times , which increases the computational time needed to around @xmath35 seconds .      in order to achieve a more practical , discretely - valued dielectric structure",
    ", we can impose strict upper- and lower - bounds on @xmath2 . to this end , we modify our algorithm as such , @xmath38 in this algorithm , eq .",
    "is a convex optimization problem@xcite .",
    "this allows us to impose hard constraints on @xmath2 , which in turn allows us to remove the regularization term present in eq .  .",
    "the _ cvx _",
    "package@xcite is used to solve eq .",
    ", with each iteration of the algorithm now requiring roughly @xmath23 second of computation time .    .",
    "the parameters are identical to those used to produce fig .",
    "[ comp pic ] with the exception that only one regularization term is now needed ( @xmath33 ) .",
    "the algorithm was run for @xmath39 iterations , which took @xmath39 seconds .",
    "the structure turns out to be almost completely binary - valued and looks like a periodic structure with tapered duty cycle .",
    "it produces an actual field which very closely matches the final target field . ]    a nearly binary - valued dielectric structure is obtained in fig .",
    "[ bounded comp pic ] , which accurately produces the final target field .",
    "this is very useful for the design of practical structures , since they usually consist of two or three different materials at most .",
    "interestingly , although the directly discreteness of @xmath2 was not enforced ( since that would make the problem non - convex ) , a discrete , binary - valued structure has still arisen .",
    "we now demonstrate that the complementary optimization method is versatile and can be scaled to multiple dimensions . to ensure that @xmath2 is well - behaved we use a point - spread function which does not allow @xmath2 to change at a certain point in space without affecting the values surrounding it .    in order to show that our method can produce complex designs , we choose an s - shaped target field which is non - trivial to reproduce .",
    "the optimization results , using the complementary optimization method from section [ sec : comp ] , are shown in fig .",
    "[ s pic ] .",
    "the resulting dielectric structure is continuous , unbounded and contains some singularities ( white dots ) , but the final target and actual fields match up well .",
    "also , the computational cost remains quite reasonable ; the @xmath40 iterations needed required only @xmath41 minutes of computation time .",
    "the resulting structure is completely unintuitive , and illustrates the kind of new capabilities offered by the inverse design strategy .",
    "specifically , that a complex , intricate structure can be designed just by specifying the shape and frequency of a rather simple electromagnetic mode .    .",
    "the design was initialized by specifying an initial dielectric structure ( @xmath42 everywhere ) and a resonant field in the shape of an `` s '' .",
    "the final dielectric structure was produced after @xmath40 iterations which took @xmath43 seconds to complete in total .",
    "the final dielectric structure is quite unintuive , and yet reproduces the target field surprisingly well .",
    "this example demonstrates the versatility of the complementary optimization method in producing designs , from very simple specifications , which otherwise could be attained only with considerable difficulty . ]",
    "the complementary optimization method can also be extended to produce dielectric structures with multiple resonances .",
    "to do so , multiple initial target fields are specified .",
    "the dielectric structure is first modified to simultaneously fit all target fields using a multi - objective least - squares method .",
    "then each target field is individually modified to fit the structure ; and we continue alternating between optimizing @xmath2 and @xmath44 in this way .",
    "a benefit of this scheme is that only the @xmath2 optimization increases in size , so the design process remains computationally tractable , even for several resonant fields .",
    "this algorithm can be summarized as follows , @xmath45 the design of an `` x '' resonator with two perpendicular , degenerate modes is shown in fig .",
    "[ x pic ] .",
    "the added complexity increases the total computation time to @xmath41 minutes for @xmath46 iterations of the algorithm .    .",
    "as in fig .",
    "the initial value of @xmath2 was @xmath23 everywhere .",
    "the two initial target fields used are only slightly perturbed and are very similar to the two final actual target fields .",
    "computationally , this design took @xmath41 minutes to complete and required @xmath46 iterations .",
    "this example shows that the complementary optimization strategy can be extended to produce dielectric structures with multiple resonances . such an `` x '' resonator is useful for polarization - entangled single - photon sources for example@xcite . ]",
    "the multi - mode inverse design method can also be applied to the design of waveguiding devices such as multiplexers / demultiplexers , waveguide couplers , crossbars and dispersion - tailored waveguides .",
    "this can be accomplished by treating a waveguiding device as a doubly - degenerate resonator at its operational frequencies and then enforcing opposite symmetries ( even / odd or cosine / sine ) in the degenerate modes .",
    "a single - to - dual beam waveguide coupler designed based on eq .   and",
    "is shown in fig .",
    "[ wg pic ] , and motivates how one might design other waveguiding devices such as channel - drop filters .    .",
    "two degenerate modes with opposite symmetry ( sine and cosine ) are used as target fields .",
    "only @xmath47 iterations ( @xmath48 seconds ) are needed to achieve this solution .",
    "this is a simple demonstration showing that the complementary optimization method can also be extended to design waveguiding devices . ]",
    "in addition to macroscopic waveguiding devices , one should also be able to create novel periodic waveguiding structures .",
    "for instance , by controlling the frequency of a particular waveguiding mode at each of its @xmath49-vectors , one could create a waveguide with a customized dispersion characteristic , which would be useful in the design of slow - light waveguides .",
    "we now use the complementary optimization method to design resonators with discrete , binary @xmath2 in two dimensions . at the same time , the algorithm is modified so that we no longer specify an initial target field ; instead , only an initial dielectric structure and the maximum desired mode volume ( i.e. mode area in 2d ) are specified .",
    "in addition , the optimization process attempts to maximize the q - factor .",
    "such an algorithm now consists of iteratively solving two convex optimization problem , @xmath50 in this algorithm , the field optimization , eq .  , differs significantly from eq .  .",
    "first , the eigenvalue equation term @xmath51 no longer utilizes @xmath52 . also , a new `` fourier - minimizing '' term @xmath53 has been added . here ,",
    "the row vectors of @xmath54 consist of the field fourier components that we do not want incorporated in the final solution .",
    "the motivation for adding this term is to design high - q resonators using planar structures , where the q - factor is limited by out - of - plane losses , and can thus be improved by eliminating field fourier components that are not localized by total internal reflection ( components inside the light cone )  @xcite .",
    "lastly , the @xmath55 term allows us to specify the mode area ( mode volume in three dimensions ) , that we desire for our resonant field .",
    "this works because the two minimization objectives in eq .",
    "will generally cause the mode area to be as large as possible , which means we always end up with @xmath56 .",
    "the addition of the two new terms in eq .",
    "signifies that the field iteration in our algorithm attempts to do more than to just satisfy maxwell s equations . rather than only trying to fit the dielectric structure , the resonant field now",
    "also minimizes some of its fourier components while working with a limited mode area .",
    "in contrast with the field optimization given by eq .  , the structure optimization given by eq .   remains identical to the equation in the one - dimensional case , eq .  , and contains no terms related to notions of fourier components or mode area .",
    "in fact , the only objective in the @xmath2 optimization is to better fit the field generated from the field optimization .",
    "this means that in this scheme , the field iteration is leading the structure iteration . in other words ,",
    "eq .   `` looks ahead '' and gradually adapts itself to become a more desirable field , while eq .",
    "just `` follows along '' .",
    "for this reason , this algorithm is unique from the other complementary optimization algorithms previously presented in the article , since in those algorithms both iterations follow one another and eventually `` meet in the middle '' .",
    "finally , in this scheme , we chose to limit the degrees of freedom of both @xmath57 and @xmath58 . some components of @xmath57",
    "were fixed at non - zero values and were not allowed to be modified simply to avoid the @xmath31 situation . to enhance the aesthetics of the resulting dielectric structure ,",
    "some components of @xmath58 were frozen as well , which is useful in cases where one would only like to modify the dielectric structure within a waveguide only , for example .      .",
    "the initial specification is very simple and consists an initial dielectric structure ( @xmath59 everywhere ) , the frequency and mode - volume of the resonance field as well as a weighting factor , @xmath18 , to avoid leaky field fourier components .",
    "additionally , the values of @xmath2 are only allowed to be modified within a central circular region and must be kept between @xmath23 and @xmath60 .",
    "after @xmath46 iterations which took @xmath61 minutes to complete , a discrete structure emerged with excellent match between the predicted ( @xmath62 ) and actual fields .",
    "the structure resembles a circular grating with a bowtie - like central structure for focusing the resonant energy to a single point . ]",
    "[ circle pic ] shows the design of a circular grating resonator using the method from section [ sec:2dnum ] .",
    "the dielectric structure emerged from a very simple choice of initial structure , namely a constant @xmath59 everywhere .",
    "the range of @xmath2 was limited to be from @xmath23 to @xmath60 , the mode area was set to @xmath41 and @xmath63 .",
    "central components of @xmath57 were held constant to ensure that an electric dipole in the y - direction was produced in the center of the structure .",
    "additionally , the components of @xmath2 outside a specified circle were held at a constant @xmath59 for the duration of the design process .",
    "the entire algorithm was run for @xmath46 iterations and took @xmath61 minutes .",
    "after @xmath46 iterations , we see that a strong binary - valued structure has formed .",
    "interestingly , the central bowtie - like structure has emerged from previous geneetic optimization methods as well@xcite .",
    "note also the extremely small amount of information needed to produce this result : only the frequency and mode area of the resonant field desired , and a trivial intial @xmath2 . the ability to produce a rather advanced design from such a simple problem specification highlights the potential usefulness of inverse methods in the design of novel nanophotonic devices .",
    "the same approach was used to design a beam resonator as shown in fig .",
    "[ line pic ] .",
    "the parameters used in this design are identical to those used for the circular resonator , with the exception that the initial dielectric structure now consists of an unbroken waveguide , and the region where @xmath2 can be modified is now confined to the center of the waveguide .    .",
    "the initial conditions are identical to those for fig .",
    "[ circle pic ] , except that the initial dielectric structure is an unbroken waveguide , and @xmath2 can only be modified within that waveguide .",
    "the structure emerged after @xmath46 iterations , which took @xmath41 minutes of computation .",
    "the bowtie - like structure has reappeared in the center .",
    "interestingly , the effect of the fourier term in eq .  , is seen in the outward tapering of the holes . ]",
    "these two , simple modifications produce a vastly different result as is plainly seen from fig .",
    "[ line pic ] .",
    "some characteristics remain , such as the two closely spaced holes in the center of the structures which focus the electromagnetic energy to a central point .",
    "other features are unique to the beam resonator , such as a gradual outward tapering of hole diameters and size ending in a periodic `` steady - state '' structure , in similar fashion to fig .",
    "[ comp pic ] .",
    "this tapering is a direct result of the fourier term in eq .   as it leads to a smooth field profile variation and minimization of the components in the light cone that lead to out - of - plane losses@xcite .",
    "in summary , we have introduced and demonstrated a complementary optimization method for the inverse design of nanophotonic resonators as well as waveguiding structures .",
    "we have demonstrated that , in two dimensions , this method can be used to design non - trivial as well as multi - resonant structures .",
    "furthermore , we have shown that by constraining the range of available dielectric constants , the same underlying method can produce binary - valued , discrete dielectric structures .",
    "the methods presented here can readily be extended into three dimensions .",
    "in essence , the only hurdle is the size of the convex optimization problem for the field optimization .",
    "since a full three - dimensional grid often consists of tens of millions of variables , solving the field optimization problem , eq .  , using methods such as lu factorization is no longer computationally tractable . instead , iterative methods such as truncated newton methods must be employed . as it turns out ,",
    "such iterative methods are especially well suited to this complementary optimization scheme , since they can take advantage of the information in @xmath52 in order to solve @xmath57 very quickly .",
    "this is very applicable to our algorithm since the field changes very little from one iteration to the next .",
    "although solving the field optimization problem is numerically challenging in three dimensions , solving the structure optimization problem , eq .",
    ", in three dimensions is much simpler .",
    "this is because only structural variations in - plane need to be accounted for planar nanophotonic devices .",
    "the number of variables in eq .   for both two- and three - dimensional problems is then effectively the same , and the same numerical techniques can be employed to solve both .",
    "a full three - dimensional inverse design method based on complementary optimization would enable the design of novel nanophotonic resonators .",
    "for instance , a resonator for efficient wavelength - conversion could be designed by creating a structure with multiple well - placed resonant frequencies  @xcite .",
    "furthermore , effects such as mode overlap and the use of frequency - dependent refractive index materials could be taken into account with such a method .",
    "this work has been supported in part by the afosr for compex and robust on - chip nanophotonics ( dr . gernot pomrenke ) .",
    "we thank prof .",
    "stephen boyd for many fruitful discussions regarding convex optimization .",
    "99 k. yee , `` numerical solution of initial boundary value problems involving maxwell s equations in isotropic media , '' ieee trans .",
    "antennas propagat .",
    "* 14 * , 302 - 307 ( 1966 ) .",
    "m.  albani and p.  bernardi , `` a numerical method based on the discretization of maxwell equations in integral form , '' ieee trans .  on microwave theory *",
    "22 * , 446 - 450 ( 1974 ) .",
    "j.  m.  gerardy and m.  ausloos , `` absorption spectrum of clusters of spheres from the general solution of maxwell s equations . the long - wavelength limit , '' phys .  rev .",
    "b * 22 * , 4950 - 4959 ( 1979 ) .",
    "p. deotare , m. mccutcheon , i. frank , m. khan , m. loncar , `` high quality factor photonic crystal nanobeam cavities , '' applied physics letters * 94 * , 121106 ( 2009 ) .",
    "j. vuckovic , m. loncar , h. mabuchi , a. scherer , `` design of photonic crystal microcavities for cavity qed , '' physical review e * 65 * , 1 - 11 ( 2002 ) .",
    "y.  akahane , t.  asano , b.  song , s.  noda , `` fine - tuned high - q photonic - crystal nanocavity , '' optics express * 13 * , 1202 - 1214 ( 2005 ) .",
    "a. gondarenko , m. lipson , `` low modal volume dipole - like dielectric slab resonator , '' optics express * 16 * , 17689 - 17694 ( 2008 ) .",
    "a. hakansson , j. sanchez - dehesa , `` inverse designed photonic crystal de - multiplex waveguide coupler , '' optics express * 13 * , 5440 - 5449 ( 2005 ) .",
    "p. borel , a. harpth , l. frandsen , m. kristensen , p. shi , j. jensen , and o. sigmund , `` topology optimization and fabrication of photonic crystal structures , '' optics express * 12 * , 1996 - 2001 ( 2004 ) .",
    "d. englund , i. fushman , and j. vuckovic .",
    "`` general recipe for designing photonic crystal cavities , '' optics express * 12 * , 59615975 ( 2005 ) .",
    "_ cholmod _ software package , accessed via _ matlab_. s.  g.  johnson , j.  d.  joannopoulos , `` block - iterative frequency - domain methods for maxwell s equations in a planewave basis , '' optics express * 8 * , 967 - 970 ( 1999 ) .",
    "s. boyd , l. vandenberghe , _ convex optimization _",
    "( cambridge university press , 2004 ) .",
    "m. grant and s. boyd , _ cvx : matlab software for disciplined convex programming _",
    ", ` http://stanford.edu/\\simboyd/cvx ` , june 2009 .",
    "k. hennessy , c.  hogerle , e.  hu , a. badolato , a. imamoglu , `` tuning photonic nanocavities by atomic force microscope nano - oxidation , '' apl * 89 * , 041118 ( 2006 ) . b.  -s .",
    "song , s.  noda , t.  asano , y.  akahane , `` ultra - high - q photonic double - heterostructure nanocavity , '' nature materials * 4 * , 207 - 210 ( 2005 ) .",
    "k.  rivoire , z.  lin , f.  hatami , w.  ted masselink , and j.  vuckovic , `` second harmonic generation in gallium phosphide photonic crystal nanocavities with ultralow continuous wave pump power , '' optics express * 17 * , 22609 - 22615 ( 2009 ) ."
  ],
  "abstract_text": [
    "<S> a computationally - fast inverse design method for nanophotonic structures is presented . </S>",
    "<S> the method is based on two complementary convex optimization problems which modify the dielectric structure and resonant field respectively . </S>",
    "<S> the design of one- and two - dimensional nanophotonic resonators is demonstrated and is shown to require minimal computational resources . </S>"
  ]
}