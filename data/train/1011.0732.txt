{
  "article_text": [
    "inhomogeneities in the large - scale matter distribution can in many ways affect the light signals coming from very distant objects . these effects need to be understood well if we want to map the expansion history and determine the composition of the universe to a high precision from cosmolgical observations .",
    "in particular the evidence for dark energy in the current cosmological concordance model is heavily based on the analysis of the apparent magnitudes of distant type ia supernovae ( sne )  @xcite .",
    "inhomogeneities can affect the observed sne magnitude - redshift relation for example through gravitational lensing , in a way which essentially depends on size and composition of the structures through which light passes on its way from source to observer .",
    "the fundamental quantity describing this statistical magnification is the lensing probability distribution function ( pdf ) .",
    "it is not currently possible to extract the lensing pdf from the observational data and we have to resort to theoretical models .",
    "two possible alternatives have been followed in the literature . a first approach ( e.g.  ref .",
    "@xcite ) relates a `` universal '' form of the lensing pdf to the variance of the convergence , which in turn is fixed by the amplitude of the power spectrum , @xmath0 .",
    "moreover the coefficients of the proposed pdf are trained on some specific n - body simulations . a second approach ( e.g.  ref .",
    "@xcite ) is to build _ ab - initio _ a model for the inhomogeneous universe and directly compute the relative lensing pdf , usually through time - consuming ray - tracing techniques . the flexibility of this method is therefore penalized by the increased computational time .    in ref .",
    "@xcite we introduced a stochastic approach to cumulative weak lensing ( hereafter sgl method ) which combines the flexibility in modeling with a fast performance in obtaining the lensing pdf .",
    "the speed gain is actually a sine - qua - non for likelihood approaches , in which one needs to scan many thousands different models ( see ref .",
    "the sgl method is based on the weak lensing approximation and generating stochastic configurations of inhomogeneities along the line of sight .",
    "the major improvements introduced here are the use of a realistic halo mass function to determine the halo mass spectrum and the incorporation of large - scale structures in the form of filaments .",
    "the improved modeling together with the flexibility to include a wide array of systematic biases and selection effects makes the sgl method a powerful and comprehensive tool to study the impact of lensing on observations .",
    "we show in particular that the sgl method , endowed with the new array of inhomogeneities , naturally and accurately reproduces the lensing pdf of the millenium simulation  @xcite .",
    "we also study a simple selection effect model and show that selection biases can reduce the variance of the observable pdf . such reduction could at least partly cancel the opposite effect coming from large scale inhomogeneities , masking their effect on the observable pdf .",
    "we also show how a jdem - like survey could constrain the lensing pdf relative to a given cosmological model . along with this paper , we release an updated version of the package , which is a simple and very fast mathematica implementation of the sgl method @xcite .    this paper is organized as follows . in section  [ sup ]",
    "we introduce the cosmological background , the generic layout of inhomogeneities and review the basic formalism needed to compute the weak lensing convergence . in section  [ sec : inhoprop ]",
    "we derive the halo mass function and the halo density profiles and define the precise modeling of filaments .",
    "in section  [ hmf ] we present the revised and extended sgl method .",
    "the exact discretization of the model parameters , which is a crucial step in the sgl model building , is explained in section  [ mbin ] and in section  [ confi ] we explain how the realistic structures where halos are confined in filaments are modelled in the sgl method .",
    "section  [ results ] contains our numerical results including the comparison with the cosmology of the millennium simulation  @xcite and , finally , in section  [ conco ] we will give our conclusions .",
    "we consider homogeneous and isotropic friedmann - lematre - robertson - walker ( flrw ) background solutions to einstein s equations , whose metric can be written as : @xmath1 \\ , , \\ ] ] where @xmath2 and @xmath3 & \\ ; k<0 \\\\    \\end{array}\\right.\\ ; , \\ ] ] where @xmath4 is the spatial curvature of any @xmath5slice .    in particular we will focus on @xmath6cdm models whose hubble expansion rate depends on redshift according to : @xmath7 where @xmath8 is given by : @xmath9 here @xmath10 could be taken to follow _",
    "e.g. _  the parameterization  @xcite : @xmath11 for which : @xmath12 for a constant equation of state @xmath13 , the latter reduces to @xmath14 .",
    "@xmath15 , @xmath16 and @xmath17 are the present - day density parameters of dark energy , matter and radiation and @xmath18 represents the spatial - curvature contribution to the friedmann equation . introducing the hubble radius @xmath19 and the spatial - curvature radius @xmath20 , we have at any time the relation @xmath21 .",
    "we will also need the matter and dark energy density parameters at a given time or redshift : @xmath22 throughout this paper , the subscript @xmath23 will denote the present - day values of the quantities .",
    "for example the critical density today is @xmath24 where @xmath25 km s@xmath26 mpc@xmath26 , while @xmath27 is the critical density at any time .    substituting in eq .",
    "( [ hhh ] ) @xmath28 and @xmath29 we obtain the equation we have to solve in order to find the time evolution of the scale factor @xmath30 , the only dynamical variable in an flrw model .",
    "we fix the radiation density parameter to @xmath31 .",
    "moreover @xmath32 , that is , dark and baryonic matter contribute together to the total matter density .",
    "the line - of - sight and transverse comoving distances are : @xmath33 from which we find the angular and luminosity distances together with the distance modulus : @xmath34 for scales smaller than the spatial - curvature radius @xmath35 , @xmath36 and we can use the euclidean geometry .      the aim of this paper is to compute statistical weak lensing corrections to the measured light intensities , generated by the inhomogeneous matter distribution along the line of sight to a distant object .",
    "the basic quantity we need to model is the matter density contrast @xmath37 : @xmath38 where the lowercase @xmath39 indicates the local and inhomogeneous matter field while @xmath40 is the time dependent average mass density .",
    "the density contrast directly enters the expression for the weak lensing convergence  @xcite : @xmath41 where @xmath42 is the co - moving position of the source and the integral is along an unperturbed light geodesic . the density",
    "@xmath43 is the constant matter density in a co - moving volume and we defined the auxiliary function @xmath44 which gives the optical weight of an inhomogeneity at the comoving radius @xmath45 .",
    "the convergence is related to the shift in the distance modulus by : @xmath46 where @xmath47 is the net magnification and the second - order contribution of the shear has been neglected  @xcite .",
    "it is obvious that an accurate statistical modeling of the magnification pdf calls for a detailed description of the inhomogeneous mass distribution .    in this paper",
    "we will significantly improve the modeling of the inhomogeneities from our previous work  @xcite , where only single - mass spherical overdensities were considered .",
    "first of all , we improve the modeling of these  halos \" by using a realistic halo mass function @xmath48 , which gives the fraction of the total mass in halos of mass @xmath49 at the redshift @xmath50 .",
    "the function @xmath48 is related to the ( comoving ) number density @xmath51 by : @xmath52 where we defined @xmath53 as the number density of halos in the mass range @xmath54 .",
    "the halo function is by definition normalized to unity @xmath55 the idea is of course that halos describe large virialized mass concentrations such as large galaxies , galaxy clusters and superclusters .",
    "not all matter is confined into virialized halos however . moreover , only very large mass concentrations play a significant role in our weak lensing analysis : for example the stellar mass in galaxies affects the lensing pdf only at very large magnifications @xcite where the pdf is close to zero .",
    "therefore the fraction of mass @xmath56 concentrated in large virialized halos can be defined by introducing a lower limit to the integral ( [ eq : fmnorm ] ) : @xmath57 only mass concentrations with @xmath58 are treated as halos . the remaining mass is divided into a family of large mass , but low density contrast objects with a fraction @xmath59 and a uniform component with a fraction @xmath60 , such that @xmath61 the low contrast objects are introduced to account for the filamentary structures observed in the large scale structures of the universe . in our analysis they will be modeled by elongated objects with random positions and orientations .",
    "the mass in these objects can consist of a smooth unvirialized ( dark ) matter field and/or of a fine `` dust '' of small virialized objects with @xmath62 . in weak lensing this distinction does not matter because small halos act effectively as a mean field , with a sizeable contribution only at very large magnifications ( see comment above about stellar mass ) .    for later use",
    "we define @xmath63 which gives the total mass fraction not in large virialized halos .",
    "if we only consider virialized masses larger than companion galaxies ( @xmath64 ) , then typical values for the concordance model are @xmath65 at @xmath66@xcite and @xmath67 at @xmath68 , with a weak dependence on the particular @xmath48 used . although @xmath69 is sensitive on @xmath70 , the lensing pdf depends only weakly on the cut mass .",
    "moreover , halo functions obtained from n - body simulations are valid above a mass value imposed by the numerical resolution of the simulation itself and so the use of @xmath70 is also necessary in this case @xcite .    to obtain an as accurate modeling as possible , we will use realistic mass functions and spatial density profiles for the halo distribution .",
    "there is less theoretical and observational input to constrain the mass distribution of the filamentary structures or their internal density profiles .",
    "we will therefore parametrize the filaments with reasonable assumptions for their lengths and widths and by employing cylindrical nonuniform density profiles .",
    "mpc thick slice generated by our stochastic model .",
    "the shaded disks represent clusters and the shaded cylinders the filamentary dark matter structures . only large clusters are displayed.,width=8 ]    our modeling allows treating the two families of inhomogeneities independently .",
    "both can be given random spatial distributions , or alternatively all halos can be confined to have random positions in the interiors of randomly distributed cylinders .",
    "the latter configuration more closely resembles the observed large scale structures , and an illustration created by a numerical simulation using the turbogl package is shown in fig .",
    "[ slice ] . in section [ discu ]",
    "we will discuss the power spectrum and the large - scale correlations of our model universe .",
    "we can now formally rewrite eq .",
    "( [ contra1 ] ) for our model universe in which the density distribution is given by  @xmath71 : @xmath72 where the index @xmath73 labels all the inhomogeneities , we used eq .",
    "( [ eq : sumrule ] ) and we defined @xmath74 , so that both virialized halos and the unvirialized objects are described by a generic reduced density profile @xmath75 which satisfies the normalization @xmath76 .",
    "the lensing convergence we are interested in can now be written as @xmath77 where the positive contribution due to the inhomogeneities ( halos and low contrast objects ) is @xmath78 the also positive contribution due to the uniformly distributed matter is @xmath79 and the negative empty beam convergence is : @xmath80 a light ray that misses all the inhomogeneities @xmath81 will experience a negative total convergence @xmath82 , which gives the maximum possible demagnification in a given model universe . in an exactly homogeneous flrw model the two contributions @xmath83 and @xmath84",
    "cancel and there is no net lensing . in an inhomogeneous universe ,",
    "on the other hand , a light ray encounters positive or negative density contrasts , and its intensity will be magnified or demagnified , respectively .",
    "the essence of the sgl method is finding a simple statistical expression for the probability distribution of the quantity @xmath83 in the inhomogeneous universe described above .",
    "for a discussion about the validity of the weak lensing approximation within our setup see ref .",
    "@xcite , where it was shown that the error introduced is @xmath85% .",
    "we stress again that the lensing caused by stellar mass in galaxies is negligible in the weak lensing regime @xcite and so we can focus on just modeling the dark matter distribution in the universe .",
    "also , we will treat the inhomogeneities as perturbations over the background metric of eq .",
    "( [ metric ] ) . in particular we will assume that redshifts can be related to comoving distances through the latter metric .",
    "see ref .",
    "@xcite for a discussion of redshift effects .    in the next section",
    "we will give the accurate modeling of the inhomogeneities .",
    "we begin by introducing the halo mass function and the detailed halo profiles , and then move on to describe the precise modeling of the cylindrical filaments .",
    "we begin by explaining our dark matter halo modeling .",
    "the two main concepts here are the halo mass function @xmath48 giving the normalized distribution of the halos as a function of their mass and redshift , and the dark matter density profile within each individual halo .",
    "both quantities are essential for an accurate modeling of the weak lensing effects by inhomogeneities",
    ". we shall begin with the halo mass function introduced above in eq .",
    "( [ eq : halomassf ] ) .",
    "the halo mass function acquires an approximate universality when expressed with respect to the variance of the mass fluctuations on a comoving scale @xmath45 at a given time or redshift , @xmath86 . relating the comoving scale @xmath45 to the mass scale by @xmath87",
    ", we can define the variance in a given mass scale by @xmath88 .",
    "the variance @xmath86 can be computed from the power spectrum : @xmath89 where @xmath90 is the fourier transform of the chosen ( top - hat in this work ) window function and the dimensionless power spectrum extrapolated using linear theory to the redshift @xmath50 is : @xmath91 here @xmath92 is the spectral index and @xmath93 is the amplitude of perturbations on the horizon scale today , which we fix by requiring : @xmath94 where the value of @xmath0 is estimated by cluster abundance constraints @xcite .",
    "@xmath95 is the linear growth function which describes the growth speed of the linear perturbations in the universe .",
    "fit functions for @xmath96 could be found , _",
    "e.g. _ , in ref .",
    "@xcite , but it can also be easily solved numerically from the equation : @xmath97 \\nonumber \\\\ & -&{3 \\over 2 } { d(z ) \\over ( 1+z)^{2 } } \\ , \\omega_{m}(z)=0 \\,,\\end{aligned}\\ ] ] where we have neglected the radiation . as usual",
    ", we normalize @xmath96 to unity at the present time , @xmath98 .",
    "finally , for the transfer function @xmath99 we use the fit provided by the equations ( 28 - 31 ) of ref .",
    "@xcite , which accurately reproduces the baryon - induced suppression on the intermediate scales but ignores the acoustic oscillations , which are not relevant for us here .",
    "with @xmath100 given , we can now define our halo mass function .",
    "several different mass functions have been introduced in the literature , but here we will consider the mass function given in eq .",
    "( b3 ) of ref .",
    "@xcite : @xmath101 which is valid in the range @xmath102 . because of the change of variable , @xmath103 is related to our original definition of @xmath104 by : @xmath105 the mass function of eq .  ( [ jenk ] )",
    "is defined relative to a spherical - overdensity ( so ) halo finder , and the overdensity used to identify a halo of mass @xmath49 at redshift @xmath50 is @xmath106 with respect to the mean matter density @xmath107 .",
    "the so finder allows therefore a direct relation between halo mass @xmath49 and the radius @xmath108 : @xmath109 the subscript @xmath110 will denote the proper values of otherwise comoving quantities throughout this paper .",
    "for example , the comoving halo radius @xmath111 is related to the proper value by @xmath112 .",
    "a direct relation between the mass and the radius of a cluster is necessary for our sgl method .",
    "this is why we prefer mass functions based on so finders over mass functions based on friends - of - friends halo finders ; for the latter an appropriate @xmath113 to be used in eq .",
    "( [ mdel ] ) is not directly available .",
    "moreover , as shown in ref .",
    "@xcite , the so(180 ) halo finder gives a good degree of universality to the mass function .",
    "another mass function which manifests approximate universality with the so(180 ) halo finder @xcite is provided by sheth & tormen in ref .",
    "@xcite .      with the halo mass function given",
    "the only missing ingredient is the halo profile which , as said after eq .",
    "( [ contra2 ] ) , we describe by means of the reduced halo profile @xmath114 .",
    "we stress that our halo of a given mass @xmath49 and redshift @xmath50 is an avererage representative of the total ensemble of halos , which in reality have some scatter in the density profiles .",
    "we will focus on the navarro - frenk - white ( nfw ) profile @xcite : @xmath115 here the scale radius is related to the halo radius by @xmath116 , where @xmath117 is the concentration parameter to be defined below . by integrating equation ( [ eq : nfwprofile ] )",
    "one finds the total mass @xmath118 $ ] which , when combined with eq .",
    "( [ mdel ] ) , gives : @xmath119 this relation fixes @xmath120 once the concentration parameter is given .",
    "the reduced halo profile @xmath114 in comoving coordinates is then : @xmath121^{-1 }   , \\ ] ] where the @xmath122-dependence ( as well as @xmath49-dependence ) arises through the redshift dependence of @xmath111 ( eq .  ( [ mdel ] ) ) and @xmath117 ( eq .  ( [ duffy ] ) ) .",
    "the last ingredient needed to fully specify the nfw profile is a relation between the concentration parameter and the halo mass at a given redshift .",
    "for the @xmath123cdm model we will use the following fit obtained from numerical simulations  @xcite satisfying wmap5 cosmology  @xcite : @xmath124 where the pivot mass scale is @xmath125 .",
    "apart from the nfw profile , alternative simple density profiles of interest include : @xmath126 \\over ( 2 \\pi)^{3/2 } ( r/3)^{3 } } \\phantom{ggg } \\textrm{gaussian , } \\label{gau } \\\\",
    "\\varphi_{h } & = & { 1 \\over 4 \\pi r^{2 } r } \\phantom{ggggggggggggggggggi } \\textrm{sis , } \\label{sis}\\end{aligned}\\ ] ] where @xmath111 is again given by eq .",
    "( [ mdel ] ) .",
    "the normalization factor in ( [ gau ] ) is necessary to have the correct volume integral of unity and is due to the restriction of the profile between 0 and @xmath111 . in these cases",
    "there are no further parameters to be fixed .",
    "we will model dark matter filaments by cylindrical , non - uniform low density objects .",
    "let us stress that throughout this chapter by a ",
    "filament \" we refer only to the smoothly distributed dark matter component of a real filament ; we shall later explain how virialized halos can be embedded within these objects to form a more realistic model of the true filamentary structures in the full sgl framework . keeping the low contrast component and",
    "the halos as separate entities in our evaluation is convenient for the modeling and explicitly avoids double counting .    using eqs .",
    "( [ eq : halomassf ] ) and ( [ eq : sumrule ] ) we can obtain the following equation which relates the comoving filament density @xmath127 and the filament mass @xmath128 to the fraction @xmath69 of mass not confined in virialized halos : @xmath129 where the quantity @xmath130 defines the fraction of the total unvirialized mass which is confined in filaments : @xmath131 . because of the ongoing halo formation @xmath69 decreases with time and we shall simply assume that @xmath132 is a constant .",
    "we will assume that all filaments have the same mass , but this assumption can easily be relaxed later by introducing a filament mass function @xcite .",
    "we are also neglecting merging of smaller filaments into larger ones , whereby the comoving number density of filaments @xmath127 remains a constant .",
    "this assumption seems to be supported by numerical simulations @xcite at least at low redshifts . from eq",
    "( [ eq : fila ] ) it then follows that the filament mass @xmath128 is not constant , but it gradually decreases as more and more halos virialize .",
    "( the total mass of the full filamentary structure which includes the halos remains on average constant . )",
    "now we need to specify the precise geometry , dimensions and time - dependent density profile @xmath133 for our filaments .",
    "first , we will relate the filament mass to its length and radius at present day according to : @xmath134 where @xmath135 and @xmath136 are the present - day filament proper radius and length and @xmath137 is the average overdensity of the filament with respect to the flrw matter density .",
    "consistent with our assumptions of neglecting filament mergers and using a constant comoving filament density , we will assume that filaments have a constant comoving length .",
    "this is again in accordance with the generic picture of a web of filaments of constant comoving length condensing with time seen in numerical simulations .",
    "finally , for simplicity , we will choose our filaments to have a constant proper radius .",
    "summarizing , we will use : @xmath138 the simplest assumption would be to take filaments to have uniform density . in this case",
    "the reduced density profile is simply @xmath139 .",
    "however , we will also consider a profile which is uniform along the length of the filament @xmath140 , but which has a gaussian profile in the radial direction . in this case",
    "@xmath141 \\over l \\ , 2 \\pi ( r/3)^{2 } }   \\,,\\ ] ] where @xmath142 and @xmath143 , and @xmath144 otherwise .    finally , let us compute the mass of the `` dressed '' filaments which comprises the `` bare '' filaments until now discussed together with the halos ( to be embedded in section [ confi ] ) . it is easy to find that : @xmath145   \\,,\\ ] ] where also the contribution from the uniformly distributed matter is included .",
    "( [ dressed ] ) is valid if all halos are embedded within the filaments and has to be slightly modified if different levels of confinement are considered .",
    "this completes our description of the _ objects _ in our model .",
    "next we shall have to understand how to simulate their effect on the weak lensing properties of the complete inhomogeneous model universe .",
    "in this section we will review and extend the stochastic gravitational lensing ( sgl ) method of ref .",
    "@xcite for computing the probability distribution function of the lens convergence @xmath146 in the presence of inhomogeneities .",
    "the basic quantity to evaluate is the inhomogeneity - induced part @xmath147 in eq .",
    "( [ eq : kappaih ] ) : @xmath148 where @xmath149 .",
    "we wish to obtain a probabilistic prediction for this quantity along a line of sight to a source located at @xmath150 , through a random distribution of halos and filaments .",
    "the problem could be solved by constructing a large comoving volume of statistically distributed objects such as the one shown in fig .",
    "[ slice ] , and then computing the distribution of @xmath83 along random directions in this space . however , an equivalent and computationally much more efficient approach is to construct random realizations of object locations along a fixed geodesic and compute the lensing pdf from a large sample of such realizations .",
    "let @xmath151 refer to a particular _ realization _ of the integral in eq .",
    "( [ eq : kappa3b ] ) and denote the resulting convergence by @xmath152 . because of the finite size of the halos and filaments , only a finite number @xmath153 of objects intercept the geodesic and contribute to the sum .",
    "moreover , because all objects are small compared to a typical comoving distance to the source @xmath154 , the function @xmath155 is , to a good approximation , a constant @xmath156 for each individual object .",
    "similarly , one can assume that @xmath157 with @xmath158 , and so one finds : @xmath159 where @xmath160 is the surface mass density of the @xmath73-th intercepting object in the realization .",
    "next divide the geodesic into @xmath161 subintervals with centers at @xmath162 and with ( possibly variable ) length @xmath163 , such that @xmath164 holds within each interval . in this way we can write @xmath165 where @xmath166 labels all objects encountered by the geodesic within the comoving length bin @xmath167 , such that @xmath168 . at this level eq .",
    "( [ eq : realization2 ] ) still consists of a sum over all _ objects _ along a given path .",
    "next we categorize these objects into different classes depending on the parameters that define the surface density @xmath169 . for spherical halos of a given @xmath170-profile @xmath171",
    "depends only on the mass of the halo and the impact parameter , and for filaments the relevant parameters are the angle between the main filament axis and the geodesic and the impact parameter in the cylindrical radius .",
    "now assume all these variables are discretized into finite - length bins .",
    "the precise way of the discretization will be discussed in detail in section [ mbin ] , but for now we simply let a generic index @xmath172 label the set of independent parameter cells created by the binning . if we now let @xmath173 denote the number of objects that fall into the cell labeled by indices @xmath174 and @xmath172 in the realization @xmath151 , we can replace the sum over the individual objects in eq .",
    "( [ eq : realization2 ] ) by a weighted sum over the discrete parameter cells : @xmath175 where @xmath176 is the total number of independent parameter cells , and so the indexing @xmath172 and the number of different parameter cells @xmath177 could in fact depend on @xmath174 , but we suppress this notation for simplicity . ]",
    "used in the binning , @xmath178 and @xmath179 is the convergence due to one object in the bin @xmath180 : @xmath181 note that the quantity @xmath179 is a function of the distance and internal variables , it is universal for arbitrary realizations : all the information specific to a particular realization @xmath151 is contained in the set of integers  @xmath182 .",
    "equation ( [ eq : realization3 ] ) is the starting point of the sgl analysis , because it can be easily turned into a probabilistic quantity .",
    "indeed , instead of thinking of realizations @xmath151 along arbitrary lines of sight through a pre - created model universe , we can define _ a statistical distribution of convergences _ through eq .",
    "( [ eq : realization3 ] ) .",
    "indeed , we have shown in ref .",
    "@xcite that , for random initial and final points of the geodesics , the integers @xmath173 are distributed as poisson random variables : @xmath183 where the parameter @xmath184 is the _ expected _ number of objects in the bin volume @xmath185 : @xmath186 here @xmath187 is the comoving density of objects corresponding to the parameters in the bin @xmath188 and @xmath189 is the corresponding cross sectional area of these objects in co - moving units .",
    "we shall specify these quantities precisely in section [ mbin ] .",
    "physically , the statistical distribution of convergences is equivalent to our original set of realizations @xmath151 averaged over the position of the observer .",
    "this is a welcome feature because the statistical model explicitly incorporates the copernican principle .",
    "the original realization @xmath151 has now been replaced by _ a configuration _ of random integers @xmath190 and the convergence equation eq .",
    "( [ eq : realization3 ] ) by a statistical convergence : @xmath191 where the probability for a particular configuration to occur is just @xmath192 it is easy to show that this probability distribution is correctly normalized .",
    "moreover , including the convergence @xmath193 due to the uniformly distributed matter and the empty space ( see eq .",
    "( [ kem ] ) and below ) , one can show that the total convergence corresponding to the configuration @xmath190 becomes  @xcite : @xmath194 for a configuration without any inhomogeneities we correctly recover @xmath195 , see section [ mbin ] .",
    "moreover , eq .  ( [ eq : fullkappa ] ) shows explicitly that the _ expected _ convergence vanishes consistently with the photon conservation in weak lensing , because @xmath196 for a random variable following eq .",
    "( [ eq : poisson - i ] ) . the final convergence pdf can now be formally written as @xmath197 where @xmath198 is a discrete probability distribution .",
    "note that the most likely configuration which maximises @xmath199 corresponds to the mode of the poisson distribution , which is the floor of its parameter : @xmath200 .",
    "moreover , for a large @xmath184 the poisson distribution approximates a gaussian with mean and variance equal to @xmath184 and the most likely configuration therefore approaches the mean : @xmath201 . when this is the case the mode of the lensing pdf vanishes even for a single observation and the pdf tends to a gaussian .",
    "one can similarly create the pdf in the shift in the distance modulus @xmath202 or in the magnification @xmath47 , using eq .",
    "( [ eq : mukappa ] ) to compute these quantities for a given configuration and then replacing @xmath146 by the desired quantity in equations ( [ eq : pdf2a]-[eq : pdf1 ] ) .    in practice ,",
    "equations ( [ eq : pdf2a]-[eq : pdf1 ] ) are not useful for a direct evaluation of the pdf .",
    "indeed , the configuration spaces are infinite and a direct evaluation of the sum of configurations would not be feasible even for relatively roughly discretized systems . instead , we compute an approximation for @xmath203 by statistically creating a large set of random configurations @xmath190 from the probability distribution @xmath199 , and by forming a discrete normalized histogram out from the corresponding set of convergences ( or distance moduli or magnifications ) .",
    "that is , we define a histogram pdf using the function : @xmath204 where @xmath205 is the total number of realizations and @xmath206 is the number of convergences in the sample falling in the bin @xmath207 centered around the mean value @xmath208 .",
    "it is easy to check that eq .",
    "( [ eq : pdf2 ] ) is correctly normalized to unity .",
    "moreover , the more configurations one creates in the simulation step , the more fine - detailed and accurate approximation for @xmath209 can be constructed . from the simulated data as a moving average weighted by some window function , but that would not give any advantage in the analysis with respect to using the simple histogram of eq .",
    "( [ eq : pdf2 ] ) . ]    to summarize , the sgl method consists of two steps : first the internal variables specifying the inhomogeneities are binned , reducing them to a finite number of different object classes labeled by the cell index @xmath172 , for which universal convergence functions @xmath179 can be computed .",
    "second the occupation numbers @xmath210 of these objects within a given co - moving distance bin are shown to be poisson distributed with parameter @xmath184 .",
    "the lensing pdf is then computed statistically , binning the convergence distribution obtained from a large set of random configurations @xmath190 on a given geodesic .",
    "computing the lensing pdf this way is very efficient . finding the pdf for a given model universe using the turbogl package  @xcite typically takes a few seconds in an ordinary desktop computer .",
    "see the appendix [ perf ] for more details about its performance .",
    "let us point out that eq .",
    "( [ eq : pdf2 ] ) treats all objects on the same footing .",
    "that is , all object families are independently randomly distributed throughout the space .",
    "confining the halos to within filaments will require slight modifications which we will explain in the section  [ confi ] .",
    "for now , we shall study the effects that may cause the actual observed pdf deviate from the fundamental weak lensing pdf .",
    "the lensing pdf ( [ eq : pdf2 ] ) is the fundamental quantity inherent to a given background model and a set of inhomogeneities .",
    "however , in reality there are interferences that prevent us from observing @xmath203 directly .",
    "firstly , the intrinsic magnitudes of the sources are not known with arbitrary accuracy , and so the _ observed _ lensing pdf is at best a convolution : @xmath211 where @xmath212 describes the source magnitude dispersion for an imperfect standard candle .",
    "clearly the fundamental lensing pdf is recovered in the limit that @xmath212 becomes a delta function .",
    "if there were no other sources of errors , the distribution @xmath213 could be used to contrast observations against different cosmological background models , sets of inhomogeneities and the models for the source magnitude distributions .",
    "however , there can be several different types of selection effects caused by matter between the source and the observer or by the search strategies , that may bias the observed pdf from the one predicted by eq .",
    "( [ eq : obspdf1 ] ) .",
    "one of the strengths of the sgl method is that it can be easily extended to model the effects of a wide range of selection biases on the observable pdf .",
    "let us begin with a simple class of biases that might affect the observed distance modulus beyond the weak lensing correction ; an obvious example would be an error made in the estimate of reddening .",
    "what makes such correction nontrivial , is that one would expect the error to be _ correlated _ with the types of mass concentrations encountered by the photon beam on its way from the source to the observer .",
    "the effects should thus be different along different lines of sight , affecting mostly those directions where light has to travel through volumes with higher mass densities . in the sgl method such correlated biases",
    "are very easily modelled , as one needs merely to replace @xmath214 where the first part @xmath215 is the usual weak lensing correction and the second part the object - specific correction .",
    "indeed , the bias function @xmath216 can be correlated with the redshifts @xmath217 and @xmath218 , and with all the internal characteristics of the objects , such as the halo and filament masses and impact parameters .",
    "a quantitative analysis of the possible magnitude of the function @xmath219 would require detailed astrophysical information and it is beyond the scope of this paper .",
    "however , once properly modelled , the sgl allows a very easy way of evaluating the outcome of biases on the observations .",
    "other types of _ selection _ biases might not directly affect the magnitudes , but rather the relative likelihood of observing particular events , in a way that is correlated with the mass density .",
    "this includes , for example , all sources leading to obscuration of the light beam , either alone or in combination with restrictions coming from imperfect search efficiencies and strategies .",
    "for example selection by extinction effects or by outlier rejection mainly relate to high - magnification events which are clearly correlated with having high intervening mass concentrations ( halos with large @xmath49 and/or small @xmath220 ) along the light geodesic .",
    "similarly , short duration events might be missed by search telescopes or be rejected from the data due to poor quality of the light curve , for example in cases where a supernova is not separable from the image of a bright foreground galaxy .",
    "probability of such events would obviously be correlated with the brightness of the source ( @xmath217 and source dependent parameters ) , with the density and redshift of the intervening matter and of course with the search efficiencies .",
    "the selection biases can be studied in the sgl framework by introducing a new , object - dependent _ survival probability function_. that is , we replace @xmath221 in the probability distribution for the magnification pdf  ( [ eq : pdf1 ] ) .",
    "here @xmath222 is a normalization constant that makes sure that the final pdf is normalized to unity .",
    "the most generic form of the survival probability function is @xmath223 this allows the survival function to depend on the arbitrary local properties along the photon geodesic .",
    "the physical interpretation of @xmath224 is of course clear : it gives the relative probability that an event whose signal intercepts an object with characteristics given by internal parameters @xmath172 at redshift @xmath218 would make it to the accepted observational sample .",
    "given the form ( [ eq : piu ] ) the proper normalization is easily seen to be : @xmath225 where @xmath226 the correct expression for the convergence is still given by eq .",
    "( [ eq : fullkappa ] ) , with the important difference that the random integers @xmath210 used to evaluate eq .",
    "( [ eq : pdf2 ] ) are now drawn from the poisson distribution of eq .",
    "( [ eq : survival2 ] ) with parameter the effective expected number of objects @xmath227 .    as mentioned above ,",
    "modeling @xmath224 quantitatively would need detailed input of the astrophysical properties of the intervening matter distributions and of the observational apparatus , which is beyond the scope of this work .",
    "see ref  @xcite for an analytical example giving @xmath228 , where @xmath229 is the effective filling factor of a partially - filled beam  @xcite ( see @xcite for an extension of the partially - filled beam formalism ) .",
    "we will discuss an illustrative numerical example in section [ results ] where we will consider as survival probability a simple step - function in the impact parameter .    to summarise ,",
    "let us note that it is easy to combine both types of observational biases discussed in this section .",
    "the true observational pdf can be defined as @xmath230 where @xmath212 again is the intrinsic source magnitude dispersion and the effective lensing probability distribution function @xmath231 is computed from eq .",
    "( [ eq : pdf2 ] ) using the effective probability distribution of eq .",
    "( [ eq : survival2 ] ) , and computing the effective magnitudes for configurations from equations ( [ eq : deltameff ] ) and ( [ eq : mukappa ] ) .",
    "this setting clearly allows modeling a very complex structure of observational biases .",
    "finally note that the generic trend among all the effects discussed above is to suppress events with higher magnifications .",
    "it could then be that a non - negligible overestimate of the observed magnitudes follows from neglecting the selection biases , even if the individual effects were relatively small .",
    "moreover , while the present data can not yet constrain the lensing pdf itself , it can put bounds on its variance .",
    "since the observational biases are suppressing the high magnification tail , they give @xmath232 a smaller effective variance which may open the possibility for a comparison with the experiments .",
    "we will further discuss these topics in section [ results ] .",
    "we conclude this section by deriving an effective distribution @xmath233 for a data sample @xmath234 , where the set @xmath234 refers to a given binning of the original data .",
    "@xmath233 could be computed directly from the fundamental pdf  @xcite , but it is much faster to create it directly during the initial simulation , bypassing the calculation of the fundamental @xmath203 altogether .",
    "indeed , if we label the configurations within a given sample of observations by @xmath235 , the mean convergence after @xmath236 observations is : @xmath237 where in the second line we have used the fact that the quantities @xmath179 are independent of @xmath235 and in the last line we have used the property that the independent poisson variables @xmath238 ( with the same weight ) sum exactly ( in a statistical sense ) into the poisson variable @xmath239 of parameter given by the sum of the individual parameters , which is @xmath240 .",
    "@xmath233 is then given by an expression similar to eqs .",
    "( [ eq : pdf2a]-[eq : pdf1 ] ) or eq .",
    "( [ eq : pdf2 ] ) .",
    "note , however , that including the selection effects ( see section [ sbs ] ) in general does not commute with taking an average over the observations .",
    "in other words , if the @xmath241 measurements are correlated , we can not use eq .",
    "( [ equation : kappa3 ] ) , but we have to start from the fundamental pdf . on the other hand , eq .",
    "( [ equation : kappa3 ] ) displays explicitly the effect of the size of the data sample : even if @xmath146 had a skewed pdf and a nonzero mode for @xmath242 , for large @xmath241 the distribution approaches a gaussian and eventually converges to a @xmath243-function with a zero convergence , as it is clear from the properties of poisson variables .      from the general expression eq .",
    "( [ equation : kappa3 ] ) , including a nontrivial survival probability , it follows that the expected value and variance of the convergence are : @xmath244 and @xmath245 where we assumed that the survival probability for a light ray going through the uniformly distributed matter density @xmath246 equals unity and that the random variables @xmath210 are uncorrelated .",
    "( [ averagekappa]-[varkappa ] ) can then be put back in integral form giving the following _ exact _ results : @xmath247 and @xmath248 where the integral limits for the last two integrals are implicitly defined and the explicit form of surface area element @xmath249 depends on the geometrical properties of the object of mass  @xmath49 . for example , for spherical halos it is @xmath250 .",
    "we again stress that the quantity @xmath251 is a generic function that describes the probability that a light ray is observed when it hits a halo of mass @xmath49 at the redshift @xmath50 and impact parameter @xmath220 for a source at redshift  @xmath252 .",
    "( [ averagekappax]-[varkappax ] ) are a simple and direct prediction of the sgl method and allow to draw some general considerations .",
    "first , if @xmath253 , the expected value of the convergence is correctly zero , showing the `` benevolent '' nature of weak lensing corrections for unbiased observations .",
    "if however the survival probability is not trivial , selection biases persist even in very large datasets so that the average convergence over a large number of observations approaches a nonvanishing value .",
    "second , eq .  ( [ varkappax ] ) is a product of positive quantities and so _ a nontrivial survival probability always reduces the observed variance . _    we would like to stress that it is easy to numerically evaluate the integrals of eqs .",
    "( [ averagekappax]-[varkappax ] ) , and their predictions can be straightforwardly implemented in @xmath254 analyses based on gaussian likelihoods , which may be a reasonable approximation if the observable pdf is not strongly skewed .",
    "the key role played by the discretization of the model parameters in the sgl method is now quite obvious . of course",
    ", the final lensing pdf should not depend on the discretization . indeed , as the numerical value of a riemann integral does not depend on the binning chosen",
    "if the integrand does not significantly vary within the bins , the resulting pdf will not depend on the specific binning if the cosmological functions @xmath179 are approximately constant within the bin cells @xmath188 .",
    "once this condition is well met a further refinement of binning does not increase the accuracy .",
    "this statement can be proved formally as follows : imagine that we have a valid binning prescription @xmath255 and we want to move to a new prescription @xmath256 which is @xmath257 times finer . because @xmath258 is valid , the convergences @xmath259 are approximately constant within each @xmath255-bin .",
    "the relative poisson variables can then be resummed as done in eq .",
    "( [ equation : kappa3 ] ) , and we obtain the same formal expression in terms of @xmath258-bins we started from .",
    "this theorem also explains why we do not need to bin any variable in which the surface mass density @xmath171 of a given object is constant , such as the rotational angle along the center of a spherical halo in the lens plane .",
    "as the convergences @xmath179 are constants within angular bins , their contributions can be resummed to give a model without any angular binning .",
    "that is , the fundamental halo objects are actually finite - width rings in the convergence plane .    the first quantity to be binned is the co - moving distance to the source . here",
    "the basic quantity that needs to be accurately modelled is the function @xmath260 , which gives the optical weight of a given convergence plane .",
    "this is a rather smooth function with a shallow peak , and only slightly dependent on @xmath150 when expressed in the scaled variable @xmath261 .",
    "simple linear bins @xmath162 have been found to give accurate results , with only @xmath262 redshift slices .",
    "this turns out to be the typical number of bins needed for an accurate modeling of most of the internal variables as well .",
    "we begin by discretizing the halo parameters , which are the mass and the impact parameter in the lens plane . binning the halo masses",
    "involves two main considerations .",
    "first , the halo mass function only carries information about high - contrast virialized halos within a specific mass range ( see eq .",
    "( [ jenk ] ) ) .",
    "moreover , as explained in section [ mati ] , only very large mass concentrations play a significant role in our weak lensing analysis .",
    "consequently , we introduced the lower cut @xmath70 to the mass distribution so that only mass concentrations with @xmath58 are treated as halos , while the remaining mass has been divided into low contrast objects and uniform matter density ( see eq .",
    "( [ eq : sumrule ] ) ) .",
    "second , the fact that the concentration parameter of eq .",
    "( [ duffy ] ) follows a power law suggests the use of a logarithmic binning in mass .",
    "the mass function drops quickly at very large masses , so that we can combine all masses above a certain limit to a single bin .",
    "we found it reasonable to define at any redshift .",
    "one could , for example , use bins such that @xmath69 has always the present - day value .",
    "see section [ mati ] for a discussion about @xmath69 .",
    "] the cell boundaries by @xmath263 and the cell centers by @xmath264 , with @xmath265 . because @xmath266 to a very good approximation , it is sufficient to bin with an integer @xmath267 between 10 and 15 : @xmath268 the fraction of total mass in a bin is then @xmath269 which correctly gives the total halo mass fraction ( see eq .",
    "( [ eq : def_of_fh ] ) ) when summed over all the halo bins : @xmath270 finally , the binned comoving halo densities are @xmath271 which also allows to relate the mass @xmath272 to the interhalo scale @xmath273 .",
    "the halo impact parameter @xmath274 in the lens plane is restricted to the range @xmath275 $ ] , where @xmath111 is the comoving halo radius .",
    "it should be noted that through eq .",
    "( [ mdel ] ) the radius depends both on the halo mass and the redshift .",
    "see fig .",
    "[ sketch ] for an illustrative sketch .",
    "it is efficient to discretize @xmath220 into bins of constant integrated surface density ( constant equal mass ) : @xmath276 where @xmath277 is the number of @xmath220-bins used and the surface density is given by ( see fig .",
    "[ sketch ] ) : @xmath278    after the redshift and the halo mass is specified , the bin boundaries @xmath279 and the weighted centers of gravity @xmath280 can be computed using eq .",
    "( [ binbounds ] ) .",
    "after these are defined , the corresponding area functions @xmath281 , needed for the poisson parameters @xmath282 and the binned surface densities @xmath283 , can be computed .",
    "overall , our halo model is described by the redshift index and two internal indices for the discretized mass and impact parameter . in terms of the generic parameter @xmath172",
    "we can formally express this as : @xmath284 , where the label @xmath285 refers to the  halo \" family of the inhomogeneities .",
    ".,width=8 ]     of eq .",
    "( [ ltt ] ) as shown in fig .",
    "[ cylinder2].,width=8 ]    the position and the orientation of a generic object in the three dimensional space is described by three position and three orientation degrees of freedom . since",
    "our filaments objects are confined to within a given @xmath286 slice , they generically have only five degrees of freedom . special symmetries of a sphere reduced the number of relevant parameters for halos to a sigle one , the impact parameter @xmath274 . for filaments",
    "the situation is slightly more complicated because a cylinder is invariant only for rotations around one symmetry axis .",
    "this leaves us with four degrees of freedom .",
    "the relevant parameters , however , are reduced by the symmetries to only two : the angle @xmath151 of the filament main axes with respect to the geodesic and the impact parameter @xmath287 . for illustration",
    "see figs .",
    "[ cylinder2]-[cylinder1 ] .",
    "this can be understood by the fact that all the possible filament configurations with the same @xmath151 and @xmath287 have the same surface density @xmath288 and so can be resummed using the theorem given above . in particular , the projected surface density of our filaments does not depend on the coordinate @xmath289 along the projected main axes we  move \" the triangular section as shown in fig .",
    "[ cylinder2 ] . strictly speaking our filaments",
    "do not have a cylindrical symmetry , but a @xmath151-dependent  tilted \" rotation symmetry , such that the projected surface densities follow equation ( [ gammat0 ] ) for all @xmath290 .",
    "this approximation should be good for long filaments with @xmath291 . ]",
    "allowing to resum the @xmath289-bins into a single effective bin of the total @xmath151-dependent length of the projection : @xmath292 the angle @xmath151 is physically important because objects seen with a smaller @xmath151 have a smaller cross section and a higher surface density .",
    "accounting for this geometrical effect leads to a more strongly skewed lensing pdf .",
    "the expression for the surface density is given by @xmath293 for the uniform filament profile this gives simply @xmath294 , where @xmath295 .",
    "for the gaussian profile ( [ filagau ] ) one instead finds @xmath296    \\ , .",
    "\\label{gammat}\\ ] ]    the angle @xmath151 can be restricted by symmetry to the interval @xmath297 $ ] , which we divide into @xmath298 uniform length bins around centers @xmath299 .",
    "the impact parameter is restricted to @xmath300 $ ] , and it will be discretized into @xmath301 bins using the equal mass criteria , as in the halo case defined in eq .",
    "( [ binbounds ] ) .",
    "that is , our filaments will be represented by a family of  bars \" of different surface densities @xmath302 and length @xmath303 .",
    "the surface area of these bars to be used in the poisson parameters is @xmath304 .",
    "overall , our filament model is described by the redshift index , and two internal indices for the discretized angle and impact parameter . in terms of the generic parameter @xmath172",
    "we can again formally express this as : @xmath305 , where the family label @xmath104 refers to the  filament \" family of the inhomogeneity .",
    "of course adding , _",
    "e.g. _ , a mass distribution for filaments and/or an @xmath306-dependent density profile would increase the necessary number of indices in the discrete model .",
    "until now we have implicitly assumed that the halo and the filament families are independent . we will now show how a more realistic model with halos confined to the filaments can be set up in the sgl approach .",
    "the central observation is that the exact positions of halos and filaments within the co - moving distance bins are irrelevant in eq .",
    "( [ eq : fullkappa ] ) for the convergence .",
    "it then does not matter if we really confine the halos to filaments ; for the same effect it is sufficient to merely confine them into the equivalent volume occupied by the filaments in a given bin .",
    "we can actually do even better than imposing a simple volume confinement .",
    "indeed , it is natural to assume that the halo distribution follows the smooth density profile that defines the filament , which can be accounted for by weighting the volume elements by their reduced density profiles . because only the projected matter density is relevant for lensing ,",
    "this weighting is accounted for by the effective surface densities of the objects .",
    "we then introduce the effective co - moving thickness for the low density objects as : to refer to generic internal filamentary degrees of freedom . ]",
    "@xmath307 where @xmath308 is the average mass density of the filament with volume @xmath309 .",
    "the total effective length of a configuration of filaments @xmath310 along the line of sight is then : @xmath311 it is easy to show that the statistical average of @xmath312 over the configuration space is just the expected distance covered by filaments : @xmath313 where we defined the comoving average filament volume fraction : @xmath314 the confining simulation can now be performed in two steps : in the first step a random configuration of filaments is generated and eq .",
    "( [ eq : master1 ] ) is used to compute the effective lengths @xmath315 at different co - moving slices .",
    "these lengths define then the poisson parameters for the halos through eq .",
    "( [ deltan ] ) : @xmath316 note that the halo densities @xmath317 are corrected to account for the reduced volume available due to confinement : @xmath318 where @xmath319 are the usual halo densities of eq .",
    "( [ nbins ] ) when the halos are uniformly distributed through all space .",
    "inserting eq .",
    "( [ eq : haloweights ] ) back to ( [ deltanhalos ] ) and using eqs .",
    "( [ eq : master1]-[eq : master2 ] ) we can rewrite eq .",
    "( [ deltanhalos ] ) simply as @xmath320 where @xmath321 are the usual configuration independent poisson parameters computed without confinement .",
    "note that the central quantities needed in the evaluation of eq .",
    "( [ deltanf ] ) are the filamentary weights @xmath322 and surface densities @xmath323 . with",
    "these given , all the information about the specific low contrast objects used is condensed into the single stochastic variable : @xmath324 which has an expectation value of unity and a mode smaller than unity . the lensing effects due to large - scale structures",
    "are thus tied to the probability distribution of @xmath325 : its added skewness is the effect coming from confining halos within filaments .",
    "this opens the possibility to investigate and compare different filamentary geometries by means of the @xmath325-pdf .",
    "we will develop these thoughts further in a forthcoming paper @xcite .",
    "we can further generalize the picture given in this section by considering different levels of confinement for halos of different masses . indeed , because halos of different mass are treated independently in eq .",
    "( [ deltanf ] ) , one could have small halos populate also the voids and massive halos only the filamentary structure .",
    "let us finally point out that in practical computations the convergence pdf is obtained by creating a large number of independent halo configurations for each  master \" filament configuration .",
    "typically we use simulations with few hundred master configurations with a few hundred halo configurations each .      in this section",
    "we will discuss the power spectrum of our model universe and the importance of large - scale correlations for the lensing pdf .",
    "we start by making a connection between the sgl method and the so - called `` halo model '' ( see , for example , @xcite and @xcite for a review ) , where inhomogeneities are approximated by a collection of different kinds of halos whose spatial distributions satisfies the linear power spectrum .",
    "the idea behind the halo model is that on small scales ( large wavenumbers @xmath326 ) the statistics of matter correlations are dominated by the internal halo density profiles , while on large scales the halos are assumed to cluster according to linear theory .",
    "the two components are then combined together .",
    "the sgl modeling of the inhomogeneities can be thought as a two - step halo model where we first create the random filamentary structures and then place the halos randomly within these structures .",
    "similarly to the halo model , one can then combine the linearly - evolved power spectrum with the nonlinear one coming from the filaments and the halos they contain . in this sense",
    "our filamentary structures extend the halo model by introducing correlations in the intermediate scales between the halo substructures and the cosmological scale controlled by the linear power spectrum . in the halo model",
    "the power spectrum can be computed analytically , but here the calculation has to be done numerically .",
    "we are currently extending the sgl method such that the simulation will produce also the power spectrum  @xcite in addition to the lensing pdf .",
    "the power spectrum can indeed place useful constraints on the filament parameters which , as remarked in section [ mati ] , are not tightly constrained by observations .",
    "while the power spectrum is relevant for understanding the correlations at the largest observable scales , the lensing pdf depends mainly on the much stronger inhomogeneities at smaller scales .",
    "this can be understood from eq .",
    "( [ eq : kappa1 ] ) which shows the direct dependence of the lensing convergence on the density contrast .",
    "the small lensing variance from the large - scale correlations induced by the linear power spectrum was numerically computed , for example , in  @xcite .",
    "moreover , weak lensing and the power spectrum probe somewhat different aspects of the inhomogeneities .",
    "the web - like structures of filaments and voids that affect weak lensing are mainly described by higher order correlation terms beyond the power spectrum , and so special care has to be put in designing the filamentary structure .",
    "this is indeed the goal of the sgl method : to give an accurate and flexible modeling of the universe as far as its lensing properties are concerned .",
    "our main goal in this section is to compare the sgl approach with the convergence pdf computed from large scale simulations .",
    "the idea is that by achieving a good agreement with numerical simulations we are proving that the sgl method does provide a good and accurate description of the weak lensing phenomena .",
    "as we shall see , this is indeed the case , as we can naturally reproduce the lensing pdf of the millenium simulation .",
    "let us stress that while a comparison to simulations is a good benchmark test for the sgl approach , the simulations and underlying @xmath123cdm model do not necessarily describe nature .",
    "indeed observations do not yet provide strong constraints to the lensing pdf , which leaves room for very different types of large scale structures , examples of which have been studied for example in ref .",
    "@xcite .    with the accuracy of the method tested",
    ", one can reliably compute the effects of selection biases using sgl . while we lack the necessary expertise to quantitatively estimate the possible bias parameters , we will study a simple toy model for the survival probability function @xmath224 to show qualitatively how selection effets might bias the observable pdf .",
    "finally , we will also show how a jdem - like survey could constrain the lensing pdf relative to a given cosmological model .",
    "we shall begin , however , by the comparison with the simulations .",
    "we shall now confront the sgl method with the cosmology described by the millennium simulation ( ms )  @xcite .",
    "accordingly , we will fix the cosmological parameters to @xmath327 , @xmath328 , @xmath329 , @xmath330 , @xmath331 @xmath332 and @xmath333 .",
    "moreover , the mass function of eq .",
    "( [ jenk ] ) agrees with the ms results .",
    "these parameters completely fix the background cosmology and the halos .",
    "we are then left with the filament parameters to specify .",
    "first , we fix @xmath334 , which means that half of the unvirialized mass forms filaments , while the other half is uniformly distributed .",
    "this value determines the maximum possible demagnification @xmath335 in the lensing pdf , corresponding to light that misses all the inhomogeneities . for the background model described above this",
    "implies @xmath336 mag .       for each @xmath337",
    "the sgl method evaluates the corresponding occupational number from the poisson statistics .",
    "the program mathematica using one core of a cpu at @xmath338  ghz takes a time @xmath339  s to produce an array of @xmath340 poisson numbers .",
    "other programs will likely have similar performances .",
    "@xmath341 determines the statistics with which the lensing pdf is generated . using this information we",
    "can then estimate the performance of the sgl method by evaluating @xmath342 .",
    "the results are shown in table  [ turbo ] where we fixed @xmath343 , @xmath344 and @xmath345 .",
    "confining halos within filaments typically makes calculations about ten times longer .",
    "p.  valageas , astron .",
    "astrophys .   * 356 * , 771 ( 2000 ) .",
    "d.  munshi and b.  jain , mon .  not .",
    "soc .   * 318 * , 109 ( 2000 ) .",
    "y.  wang , d.  e.  holz and d.  munshi , astrophys .",
    "j.   * 572 * , l15 ( 2002 ) .",
    "s.  das and j.  p.  ostriker , astrophys .",
    "j.   * 645 * , 1 ( 2006 ) .",
    "l.  amendola , k.  kainulainen , v.  marra and m.  quartin , phys .",
    "* 105 * , 121302 ( 2010 ) .",
    "s.  hilbert , s.  d.  m.  white , j.  hartlap and p.  schneider , mon .  not .",
    "* 382 * , 121 ( 2007 ) .",
    "s.  hilbert , s.  d.  m.  white , j.  hartlap and p.  schneider , mon .  not .",
    "* 386 * , 1845 ( 2008 ) .",
    "v.  springel _ et al .",
    "_ , nature * 435 * , 629 ( 2005 ) . m.  chevallier and d.  polarski , int .  j.  mod",
    ".  phys .",
    "d * 10 * , 213 ( 2001 ) ; e.  v.  linder , phys .",
    "lett .   * 90 * , 091301 ( 2003 ) . m.  bartelmann and p.  schneider , phys .",
    "rept .   *",
    "340 * , 291 ( 2001 ) .",
    "a.  jenkins _ et al .",
    "_ , mon .  not .",
    "soc .   * 321 * , 372 ( 2001 ) .",
    "r.  kantowski , astrophys .",
    "j.   * 155 * , 89 ( 1969 ) .",
    "v.  marra , e.  w.  kolb , s.  matarrese and a.  riotto , phys .",
    "d * 76 * , 123004 ( 2007 ) ; v.  marra , e.  w.  kolb and s.  matarrese , phys .",
    "d * 77 * , 023003 ( 2008 ) ; v.  marra , arxiv:0803.3152 [ astro - ph ] ; e.  w.  kolb , v.  marra and s.  matarrese , gen .",
    "grav .   * 42 * , 1399 ( 2010 ) .",
    "e.  rozo _ et al .",
    "_ , astrophys .  j.   * 708 * , 645 ( 2010 ) . w.  j.  percival , astron .",
    "astrophys .   * 443 * , 819 ( 2005 ) ; see also : s.  basilakos , astrophys .",
    "j.   * 590 * , 636 ( 2003 ) .",
    "d.  j.  eisenstein and w.  hu , astrophys .",
    "j.   * 496 * , 605 ( 1998 ) .",
    "m.  j.  .",
    "white , astrophys",
    ".  j.  suppl .",
    "* 143 * , 241 ( 2002 ) .",
    "r.  k.  sheth and g.  tormen , mon .  not .",
    "soc .   * 308 * ( 1999 ) 119 .",
    "j.  f.  navarro , c.  s.  frenk and s.  d.  m.  white , astrophys .  j.   * 462 * , 563 ( 1996 ) .",
    "a.  r.  duffy , j.  schaye , s.  t.  kay and c.  dalla vecchia , mon .  not .",
    "390 * , l64 ( 2008 ) .",
    "e.  komatsu _ et al .",
    "_ [ wmap collaboration ] , astrophys .  j.  suppl .   * 180 * , 330 ( 2009 ) ."
  ],
  "abstract_text": [
    "<S> we revise and extend the stochastic approach to cumulative weak lensing ( hereafter the sgl method ) first introduced in ref .  </S>",
    "<S> @xcite . here </S>",
    "<S> we include a realistic halo mass function and density profiles to model the distribution of mass between and within galaxies , galaxy groups and galaxy clusters . </S>",
    "<S> we also introduce a modeling of the filamentary large - scale structures and a method to embed halos into these structures . </S>",
    "<S> we show that the sgl method naturally reproduces the weak lensing results for the millennium simulation . </S>",
    "<S> the strength of the sgl method is that a numerical code based on it can compute the lensing probability distribution function for a given inhomogeneous model universe in a few seconds . </S>",
    "<S> this makes it a useful tool to study how lensing depends on cosmological parameters and its impact on observations . </S>",
    "<S> the method can also be used to simulate the effect of a wide array of systematic biases on the observable pdf . as an example </S>",
    "<S> we show how simple selection effects may reduce the variance of observed pdf , which could possibly mask opposite effects from very large scale structures . </S>",
    "<S> we also show how a jdem - like survey could constrain the lensing pdf relative to a given cosmological model . </S>",
    "<S> the updated code is available at . </S>"
  ]
}