{
  "article_text": [
    "the seminal papers by swerling @xcite , klmn @xcite , and klmn and bucy @xcite instigated the development of data - fusion algorithms for systems of known dynamical behaviour , the family of the kalman filters ( kfs ) .",
    "the kfs are simple methods providing a trade - off between the expectations of the actual ( also called ` true ' ) state of a system ( obtained on the basis of a physical or mathematical model , to be called ` dynamical ' henceforth ) and measurements yielding information on that state .",
    "it is assumed that the process of extracting information from the system does not disturb its temporal evolution .",
    "kfs have been applied in numerous research and development domains .",
    "standard applications include the navigation and control of vehicles .",
    "notable examples are the nasa space shuttle and the international space station .",
    "other standard applications range from robotic motion and trajectory optimisation to machine learning . from the practical point of view ,",
    "an advantage of the kfs is that their implementation in real - time applications does not require the storage of the history of the states of the system and of the measurements .",
    "the application of kfs is usually thought of as comprising two phases , a categorisation which however rests upon a logistical basis : prediction and correction  . in the prediction phase , an estimate of the state of the system is obtained from the estimate of the system s last state .",
    "this prediction also takes account of the effects of the so - called control inputs , i.e. , of the means to enforce changes onto the system via deliberate actions , e.g. , as the case is when the brakes are applied in order to bring a moving vehicle to a halt at a road intersection .",
    "this prediction is usually referred to as the _ a priori _ state estimate . in the correction phase ,",
    "the _ a priori _ state estimate is blended with the current - time measurement , to refine the system s state estimate .",
    "this improved estimate is called _ a posteriori _ state estimate and represents a weighted average of the _ a priori _ state estimate and of the measurement , a result which is more representative of the actual state of the system than either the _ a priori _ state estimate or the measurement . typically ( but not necessarily ) , the prediction and correction phases alternate .    as aforementioned ,",
    "the kfs make use of the state - transition model , the known control inputs , as well as the acquired measurements , to provide reliable estimates of the actual state of the system .",
    "one additional operator relates the actual state of the system and the result of the observation .",
    "the effects of the noise , in both phases , are included via appropriate covariance matrices .",
    "the basic kf ( bkf ) is applicable in case of linear systems .",
    "two other kfs have been developed in order to cover non - linear systems : the extended kf ( ekf ) and the unscented kf ( ukf ) .",
    "the kfs do not rely on assumptions about the uncertainties involved in each particular problem . if the predictions of the state of a linear system and the measurements follow gaussian distributions , the bkf is the optimal method for extracting the important information from the observations .",
    "aiming at providing simplified explanations of the essentials of the kfs , numerous papers have appeared in scientific and in popular journals . in my opinion , many of these papers do not serve their cause , due to the lack of clarity and/or of rigorousness , omission of examples , and , sadly , the mistakes they contain . some of the available works give the impression that their authors ambition was to provide recipes for fast implementation , rather than insight into the basic concepts underlying these algorithms .",
    "rigorous and detailed overviews on the subject may be obtained from refs .",
    "the present document aims at providing a short , didactical introduction to three standard versions of the kf ( i.e. , the bkf , the ekf , and the ukf ) .",
    "it is addressed to the non - expert ( i am no expert in kalman filtering ) who wishes to understand the basics of an algorithm prior to applying it in order to obtain solutions .",
    "it is assumed that the temporal evolution of a deterministic system is under study and that measurements are performed on the system at specific time instants @xmath1 , @xmath2 , ",
    ", thus yielding @xmath3 time series , where @xmath3 stands for the dimension of the measurement vector @xmath4 , i.e. , for the number of independent pieces of information obtained from the system at one time instant .",
    "it is also assumed that the system is fully described ( at all times ) by a real @xmath5-dimensional ( ket ) state vector @xmath6 ( e.g. , encompassing position vectors of the system s components , velocities , etc . ) . without loss of generality",
    ", one may choose @xmath5 to be the minimal number of quantities necessary for the full description of the system .",
    "independent measurements imply that @xmath7 . in the following",
    ", the state and measurement vectors at time instant @xmath8 will be denoted as @xmath9 and @xmath10 , respectively . from now on , reference to the time instants @xmath8 will be made by simply quoting the index @xmath11 .",
    "the temporal evolution of a deterministic physical system is known , if the state of the system is _ exactly _ known at one time instant .",
    "of course , given that all measurements are subject to finite ( non - zero ) uncertainties , ` exactitude ' in experimental results is of no practical relevance .",
    "for systems which are observed only once and let evolve , the difference between the predicted and actual states is expected to increase with time ; this is simply the consequence of error propagation in predictions . to obtain as reliable predictions as possible , it is required that the system be regularly monitored and its updated state be used in the derivation of new predictions .",
    "of course , the frequency at which the state vector is updated is linked to the lapse of time within which the predictions may be considered as reliable .",
    "the following matrices must be specified :    * @xmath12 : the @xmath13 state - transition matrix , * @xmath14 : the @xmath15 state - to - measurement transformation matrix , * @xmath16 : the @xmath13 covariance matrix of the process noise , and * @xmath17 : the @xmath18 covariance matrix of the measurement noise .",
    "one additional matrix ( @xmath19 , known as the control - input matrix ) maps the control inputs onto the state of the system .",
    "this is an @xmath20 matrix , where @xmath21 is the dimension of the ( ket ) control - input vector @xmath22 .",
    "let us consider the problem of determining the position of a vehicle given the underlying deterministic dynamics , the effects of the application of the control inputs ( accelerator , brakes , steering direction , etc . ) , and a time series of ( noisy ) measurements ( of the position of the vehicle ) .",
    "most vehicles are equipped with a gps unit nowadays , providing an estimate of the vehicle s actual position within a few metres .    in the prediction phase , the laws of motion ( @xmath12 ) , using as input the vehicle s old position , and the changes induced by the control inputs ( @xmath22 ) yield an _ a priori _ state estimate of a new position at the time instant corresponding to the subsequent measurement . in the correction phase , a measurement of the vehicle s position @xmath10 is obtained from the gps unit .",
    "the _ a priori _ state estimate and the measurement are blended together , aiming at the minimisation of the difference between the _ a posteriori _ state estimate and the actual position of the vehicle .",
    "the scheme is shown in fig .",
    "[ fig : bkfscheme ] . the uncertainties , associated with the predictions and with the measurements ,",
    "are taken into account via the covariance matrices @xmath16 and @xmath17 .",
    "the scheme underlying the application of the basic kalman filter .",
    "the output of the algorithm at time instant @xmath23 comprises estimates of the state vector @xmath24 and of the covariance matrix @xmath25 . using the laws of motion ( @xmath12 ) and",
    "the effects of the control inputs ( @xmath19 ) , one obtains predictions at time instant @xmath11 , i.e. , of the state vector @xmath26 and of the covariance matrix @xmath27 ; these predictions comprise the input at that time instant .",
    "a prediction of the measurement at time instant @xmath11 is obtained from @xmath26 on the basis of the state - to - measurement transformation matrix ( @xmath14 ) ; this prediction is blended with the measurement @xmath10 at time instant @xmath11 , resulting in updated predictions of the state vector @xmath28 and of the covariance matrix @xmath29 at time instant @xmath11 ; these predictions comprise the output of the algorithm at time instant @xmath11 .",
    "the next iteration involves quantities pertaining to time instants @xmath11 and @xmath30.,width=585 ]      all kfs assume that the actual state of the system at time instant @xmath11 evolves from that at time instant @xmath23 . in the bkf ,",
    "the two actual states are related via the expression : @xmath31 where @xmath32 is the process noise , drawn from a zero - mean multi - variate normal distribution with covariance matrix @xmath16 . at time",
    "instant @xmath11 , a measurement @xmath10 is conducted , relating to the actual state of the system via the expression : @xmath33 where @xmath34 is the measurement noise , drawn from a zero - mean multi - variate normal distribution with covariance matrix @xmath17 . at all time instants , the state estimates and the noise",
    "are not correlated . the matrices @xmath12 and @xmath14 are not dependent on the state vector of the system .    at time",
    "instant @xmath23 , two quantities are obtained :    * @xmath26 : the _ a priori _ state estimate and * @xmath27 : the _ a priori _ covariance matrix .",
    "the subscript @xmath35 indicates estimates corresponding to time instant @xmath36 , given information available at time instant @xmath37 . at time",
    "instant @xmath11 , two quantities are obtained :    * @xmath28 : the _ a posteriori _ state estimate and * @xmath29 : the _ a posteriori _ covariance matrix .    * prediction equations *    the two prediction equations are :    * _ a priori _ state estimate ( @xmath5-dimensional ket ) @xmath38 * _ a priori _ covariance matrix ( @xmath13 matrix ) @xmath39    * correction equations *    the correction scheme is based on the following relations :    * predicted measurements ( @xmath3-dimensional ket ) @xmath40 * residuals ( @xmath3-dimensional ket ) @xmath41 * covariance matrix of the residuals ( @xmath18 matrix ) @xmath42 * optimal gain ( @xmath43 matrix ) @xmath44 * _ a posteriori _ state estimate ( @xmath5-dimensional ket ) @xmath45 * _ a posteriori _ covariance matrix ( @xmath13 matrix ) corresponding to the optimal gain @xmath46    in the last expression , @xmath47 denotes the @xmath13 identity matrix .",
    "* some matrix algebra *    at first glance , relations ( [ eq : eq004],[eq : eq007],[eq : eq008],[eq : eq010 ] ) may appear quasi - mystical , yet they are easily obtained on the basis of very simple mathematics .",
    "i start with the _ a priori _ covariance matrix which is defined as the following expectation value : @xmath48 \\ , \\ , \\ , .\\ ] ] invoking eqs .",
    "( [ eq : eq001],[eq : eq003 ] ) , one obtains @xmath49\\nonumber\\\\ & = e \\left [ \\left ( f_k ( x_{k-1 } - \\hat{x}_{k-1 \\vert k-1 } ) + q_k \\right ) \\left ( ( x_{k-1 } - \\hat{x}_{k-1 \\vert k-1})^t f_k^t + q_k^t \\right ) \\right]\\nonumber\\\\ & = e \\left [ f_k ( x_{k-1 } - \\hat{x}_{k-1 \\vert k-1 } ) ( x_{k-1 } - \\hat{x}_{k-1 \\vert k-1})^t f_k^t + q_k q_k^t \\right]\\nonumber\\\\ & + e \\left [ f_k ( x_{k-1 } - \\hat{x}_{k-1 \\vert k-1 } ) q_k^t + q_k ( x_{k-1 } - \\hat{x}_{k-1 \\vert k-1})^t f_k^t \\right]\\nonumber\\\\ & = e \\left [ f_k ( x_{k-1 } - \\hat{x}_{k-1 \\vert k-1 } ) ( x_{k-1 } - \\hat{x}_{k-1 \\vert k-1})^t f_k^t \\right ] + e \\left [ q_k q_k^t \\right]\\nonumber\\\\ & = f_k p_{k-1 \\vert k-1 } f_k^t + q_k \\ , \\ , \\ , ; \\end{aligned}\\ ] ] equation ( [ eq : eq004 ] ) is thus obtained . to derive this expression ,",
    "use has been made of the assumption that the process noise is not correlated with the dynamics of the system .",
    "i will next derive the expression for the covariance matrix of the residuals @xmath50 .",
    "obviously , @xmath51 \\ , \\ , \\ , , \\ ] ] which , after invoking eqs .",
    "( [ eq : eq002],[eq : eq005],[eq : eq006 ] ) , attains the form : @xmath52\\nonumber\\\\ & = e \\left [ \\left ( h_k ( x_k - \\hat{x}_{k \\vert k-1 } ) + r_k \\right ) \\left ( ( x_k - \\hat{x}_{k \\vert k-1})^t h_k^t + r_k^t \\right ) \\right]\\nonumber\\\\ & = e \\left [ h_k ( x_k - \\hat{x}_{k \\vert k-1 } ) ( x_k - \\hat{x}_{k \\vert k-1})^t h_k^t + r_k r_k^t \\right]\\nonumber\\\\ & + e \\left [ h_k ( x_k - \\hat{x}_{k \\vert k-1 } ) r_k^t + r_k ( x_k - \\hat{x}_{k \\vert k-1})^t h_k^t \\right]\\nonumber\\\\ & = e \\left [ h_k ( x_k - \\hat{x}_{k \\vert k-1 } ) ( x_k - \\hat{x}_{k \\vert k-1})^t h_k^t \\right ] + e \\left [ r_k r_k^t \\right]\\nonumber\\\\ & = h_k p_{k \\vert k-1 } h_k^t + r_k \\ , \\ , \\ , , \\end{aligned}\\ ] ] which is eq .",
    "( [ eq : eq007 ] ) . to derive this expression ,",
    "use has been made of the assumption that the measurement noise is not correlated with the system under observation .",
    "let me finally come to the derivation of the expression for the _ a posteriori _ covariance matrix @xmath29 , defined by the expression : @xmath53 \\ , \\ , \\ , , \\ ] ] where the _ a posteriori _ state estimate @xmath28 is taken from eq .",
    "( [ eq : eq009 ] ) . invoking eqs .",
    "( [ eq : eq002],[eq : eq005],[eq : eq006],[eq : eq007 ] ) , one obtains @xmath54\\nonumber\\\\ & = e \\left [ \\left ( ( i_n - k_k h_k)(x_k - \\hat{x}_{k \\vert k-1 } ) - k_k r_k \\right ) \\left ( ( x_k - \\hat{x}_{k \\vert k-1})^t ( i_n - h_k^t k_k^t ) - r_k^t k_k^t \\right ) \\right]\\nonumber\\\\ & = e \\left [ ( i_n - k_k h_k)(x_k - \\hat{x}_{k \\vert k-1 } ) ( x_k - \\hat{x}_{k \\vert k-1})^t ( i_n - h_k^t k_k^t ) \\right]\\nonumber\\\\ & + e \\left [ k_k r_k r_k^t k_k^t \\right]\\nonumber\\\\ & - e \\left [ ( i_n - k_k h_k)(x_k - \\hat{x}_{k \\vert k-1 } ) r_k^t k_k^t \\right]\\nonumber\\\\ & - e \\left [ k_k r_k ( x_k - \\hat{x}_{k \\vert k-1})^t ( i_n - h_k^t k_k^t ) \\right]\\nonumber\\\\ & = ( i_n - k_k h_k ) p_{k \\vert k-1 } ( i_n - h_k^t k_k^t ) + k_k r_k k_k^t \\nonumber\\\\ & = p_{k \\vert k-1 } - p_{k \\vert k-1 } h_k^t k_k^t - k_k h_k p_{k \\vert k-1 } + k_k h_k p_{k \\vert k-1 } h_k^t k_k^t + k_k r_k k_k^t \\nonumber\\\\ & = p_{k \\vert k-1 } - p_{k \\vert k-1 } h_k^t k_k^t - k_k h_k p_{k \\vert k-1 } + k_k s_k k_k^t \\ , \\ , \\ , ; \\end{aligned}\\ ] ] this relation is known as the ` joseph form ' .",
    "the matrix @xmath55 may be chosen such that @xmath29 be minimised , in which case it satisfies the relation : @xmath56 or , equivalently , @xmath57 the quantity @xmath55 of eqs .",
    "( [ eq : eq017],[eq : eq018 ] ) is the so - called optimal gain . substituting the optimal gain into eq .",
    "( [ eq : eq016 ] ) and using the fact that the covariance matrix @xmath27 is symmetric ( hence its transpose is equal to the matrix itself ) , one finally obtains @xmath58 it should be stressed that eq .",
    "( [ eq : eq019 ] ) is applicable for the optimal gain , whereas eq .",
    "( [ eq : eq016 ] ) is the expression for the _ a posteriori _ covariance matrix for arbitrary gain .",
    "the importance of the model predictions , relative to the measurements , is regulated by the gain matrix .",
    "large values of the gain - matrix elements place larger weight on the measurements ; for small values , the filtered data follow the model predictions more closely .",
    "the bkf yields the optimal solution when the following conditions are fulfilled :    * the dynamics of the system is known and linear , * the noise is white and gaussian , and * the covariance matrices of the noise ( @xmath16 and @xmath17 ) are known .",
    "experience shows that , in case of incomplete modelling of the dynamical behaviour of a system , the performance of the filter deteriorates .",
    "there are also issues relating to its numerical stability : round - off uncertainties may lead to noise covariance matrices which are not positive - definite , as the case is when they involve small values or when the noise level is high .      one representative example of the straightforward application of the bkf deals with the motion of a massive object in the gravitational field of the earth ; treated in several textbooks is the case where the air resistance is neglected .",
    "( for the sake of completeness , the dynamical model when the resistance is proportional to the velocity of the object is detailed in appendix [ app : appa ] . )",
    "the object is released at height @xmath59 ( @xmath60 on the surface of the earth , positive upwards or , better expressed , away from the centre of gravity ) at time @xmath61 and the release velocity is equal to @xmath62 , in the radial direction of the gravitational field . without loss of generality ,",
    "@xmath1 may be fixed to @xmath63 ( i.e. , the clock starts ticking at the moment the object is released ) .",
    "elementary physics dictates that the height @xmath64 and the velocity @xmath65 of the object are given by the expressions : @xmath66 and @xmath67 where @xmath68 m s@xmath69 @xcite is the standard gravitational acceleration .",
    "of course , these two relations are valid so long as @xmath70 may be assumed to be constant . discretising the motion in the time domain",
    ", one may put these two equations into the compact form : @xmath71 where @xmath72 .",
    "this simple deterministic system is fully described if the position and the velocity of the object are known at ( any ) one time instant .",
    "a comparison of this expression with eq .",
    "( [ eq : eq001 ] ) in the absence of process noise ( @xmath73 ) leads to the straightforward identification of the state - transition and control - input matrices , as well as of the control - input vector @xmath22 which reduces ( in this problem ) to a mere constant ( @xmath74 ) . in the absence of a control input ,",
    "no force is exerted on the object and newton s first law of motion is recovered .",
    "the dimensions @xmath5 and @xmath21 are equal to @xmath75 and @xmath76 , respectively .    using the initial conditions of @xmath77 m and @xmath78 m / s , adding white gaussian noise to the data ( process : @xmath75 mm and @xmath75 mm / s ; measurement : @xmath79 mm and @xmath79 mm / s ) , and applying the filter to @xmath80 measurements of the height and velocity ( @xmath81 ) for @xmath82 , one obtains figs .",
    "[ fig : altitude ] and [ fig : velocity ] . evidently , the filter is successful in reducing the noise present in the raw measurements .",
    "difference of the position ( height ) to the exact solution corresponding to the free - fall example of section [ sec : bkfexample ] : the raw data are represented by the points , the filtered data by the black zigzag line .",
    "the green line marks the level of the exact noise - free solution.,width=585 ]    same as fig .",
    "[ fig : altitude ] for the velocity.,width=585 ]    in comparison , the time dependence of the height and of the velocity is also shown in case that only the height is monitored ( @xmath83 ) , see figs .",
    "[ fig : altitudeo1 m ] and [ fig : velocityo1 m ] for the same initial conditions as before . evidently , the filter is successful in reducing the noise present in the measurements of the height . on the other hand ,",
    "some systematic effects are seen in fig .",
    "[ fig : velocityo1 m ] .",
    "same as fig .",
    "[ fig : altitude ] in the case that only the height of the object is measured ( @xmath83).,width=585 ]    same as fig .",
    "[ fig : velocity ] in the case that only the height of the object is measured ( @xmath83).,width=585 ]    at this point , one remark needs to be made .",
    "the bkf reduces the noise level ; it does not eliminate it .",
    "this implies that , if a smooth solution is sought in an application , a smoothing procedure must be applied to the filtered data .",
    "in such a case , the process of applying the bkf to the raw measurements might have been an unnecessary step ; an optimisation scheme ( i.e. , directly fitting to the measurements ) might have been a more appropriate approach .",
    "in the ekf , the state - transition matrix @xmath84 and the state - to - measurement transformation matrix @xmath85 are replaced by differentiable functions , to be denoted by @xmath86 and @xmath87 , respectively .",
    "i will assume that the function @xmath86 also includes the effects of the control inputs .",
    "equations ( [ eq : eq001],[eq : eq002 ] ) take the form : @xmath88 and @xmath89    to make use of the prediction and correction expressions developed in the case of the bkf , i.e. , of the scheme outlined by eqs .",
    "( [ eq : eq003]-[eq : eq010 ] ) , the functions @xmath86 and @xmath87 are linearised around the state estimate , and the corresponding jacobian matrices of the transformations @xmath90 and @xmath91 are analytically evaluated and supplied to the algorithm .",
    "equations ( [ eq : eq003],[eq : eq005 ] ) take the form : @xmath92 and @xmath93 the matrices @xmath12 and @xmath14 in eqs .",
    "( [ eq : eq004],[eq : eq007]-[eq : eq010 ] ) must be replaced by the corresponding jacobians .",
    "the lotka - volterra equations   century @xcite . ] are non - linear , first - order , differential equations , which are frequently employed in the modelling of the dynamics of isolated ecosystems , consisting of a number of interacting ( in terms of their dietary habits ) biological species .",
    "the simplest of these ecosystems involves just two species : one serving as prey ( herbivores ) , another as predators ( preying on the herbivores ) .",
    "the temporal evolution of such a two - species ecosystem is deterministic and may be modelled according to the following set of equations .",
    "@xmath94 where @xmath6 and @xmath95 denote the prey and predator populations , respectively ; @xmath96 , @xmath97 , @xmath98 , and @xmath99 are positive parameters .",
    "a numerical solution to this set of equations may be obtained with standard solvers , e.g. , see ref .",
    "@xcite ( chapter 17 ) .    in the absence of predators ( @xmath100 )",
    ", the first equation yields an exponentially growing prey population ( which , of course , is unrealistic as vegetation will become scarce at some time , resulting in the decrease of the population ) .",
    "the decrease of the prey population due to predation is assumed to be proportional to the probability at which predators and prey occupy the same regions of spacetime ; this probability involves the product @xmath101 . on the other hand , in the absence of prey ( @xmath60 ) , the predator population is bound to decrease exponentially with time ; this is taken into account by the negative sign of the term @xmath102 in the second of eqs .",
    "( [ eq : eq027 ] ) . finally , the reproduction rate of the predators is related to the availability of food , i.e. , to the probability ( once again ) of the encounters between predators and prey ( term @xmath103 ) .",
    "one example of the temporal evolution of a two - species ecosystem is illustrated in fig .",
    "[ fig : preypredator ]",
    ". as expected , the two populations are intricately interrelated . with abundant prey ,",
    "the predator population rises ; this leads to the decrease of the prey population ; this leads the decrease of the predator population ; this leads to the increase of the prey population , and so on .",
    "one observes that the two scatter plots @xmath64 and @xmath104 are somewhat shifted ( in time ) with respect to each other , the prey - population maximum preceding that of the predators .",
    "one example of the temporal evolution of a two - species ecosystem .",
    "the parameters @xmath96 , @xmath97 , @xmath98 , and @xmath99 were fixed to @xmath105 , @xmath106 , @xmath107 , and @xmath108 , respectively .",
    "the initial conditions for the populations were : @xmath109.,width=585 ]    from eqs .",
    "( [ eq : eq027 ] ) , one obtains the approximate expressions : @xmath110 yielding the jacobian matrix : @xmath111    using the initial conditions of @xmath112 , adding white gaussian noise to the data ( process : @xmath106 ; measurement : @xmath105 ) , and applying the filter to @xmath80 measurements of the two populations ( @xmath81 ) for @xmath82 , one obtains figs .",
    "[ fig : prey ] and [ fig : predator ] .",
    "difference of the solution for the prey population to the numerical solution of the set of eqs .",
    "( [ eq : eq027 ] ) , used in the modelling of the predator - prey problem of section [ sec : ekfexample ] : the raw data are represented by the points , the filtered data by the black zigzag line .",
    "the green line marks the level of the exact , noise - free solution.,width=585 ]    same as fig .",
    "[ fig : prey ] for the predator population.,width=585 ]",
    "it has been demonstrated that the ekf performs poorly when the functions @xmath86 and @xmath87 of eqs .",
    "( [ eq : eq023],[eq : eq024 ] ) are highly non - linear @xcite .",
    "the selective ( deterministic ) sampling of these functions , rather than the use of single points in the derivation of predictions , has been put forth as the ` treatment plan ' for the linearisation problem : the ukf was thus established .",
    "one frequently advertised feature of this algorithm is that no jacobian matrices need to be evaluated . in my opinion ,",
    "the emphasis which many authors place on this ` advantage ' is misleading and counter - productive , as it diverts attention away from the main feature of the ukf , which is the inclusion of higher - order effects in the taylor expansions of the non - linear functions @xmath86 and @xmath87 .",
    "i will next outline the procedure of applying the ukf , starting from the estimates @xmath24 and @xmath25 .",
    "compact implementations of the ukf , inspired by refs .",
    "@xcite , may be found in the literature , e.g. , see ref .",
    "@xcite ( and several other later works ) ; most of these implementations rest upon operations with enhanced state vector and covariance matrices , after the incorporation of the effects ( i.e. , of the expectation values and covariance matrices ) of the process and/or of the measurement noise .",
    "however , i refrain from sacrificing straightforwardness for elegance , and describe herein only what is known as ` standard ' implementation of the ukf .",
    "a commendable effort towards explaining the application of the ukf to continuous - time filtering problems may be found in ref .",
    ". a schematic overview of the ukf is given in fig .",
    "[ fig : ukfscheme ] .    the adaptation of fig .",
    "[ fig : bkfscheme ] for the unscented kalman filter .",
    "the essential differences between the two figures pertain to the use of the functions @xmath86 and @xmath87 in the mappings @xmath90 and @xmath91 , respectively , as well as to the introduction of @xmath113 representative points ( i.e. , of the sigma points ) in the derivation of the predictions.,width=585 ]    in the prediction phase , one first selects @xmath113 representative points around @xmath24 ( e.g. , the so - called sigma points ) , propagates these points through the non - linear function @xmath86 , and obtains estimates for @xmath26 and @xmath27 as weighted averages over the transformed points .",
    "these estimates are expected to perform better than their ekf counterparts ( which are solely based on one single point , namely @xmath24 ) , the improvement originating in the inclusion of the higher - order effects in the mapping of the function @xmath86 ( and , in the correction phase , of @xmath87 ) .",
    "there is no unique prescription for drawing the sigma points .",
    "one of the possibilities , utilising two sigma points per component of the vector @xmath24 ( as well as the central value @xmath24 ) , is outlined as follows . @xmath114 the quantity @xmath115 in eqs .",
    "( [ eq : eq030 ] ) represents the @xmath116 column of the ` square root ' of the matrix @xmath117 where @xmath118 will be dealt with shortly .",
    "the cholesky decomposition is a robust method for obtaining the ` square root ' matrix , e.g. , see ref .",
    "@xcite ( chapter 2.9 ) .",
    "the sigma points come with two types of weights : one set ( @xmath119 ) for the determination of state and measurement predictions , another ( @xmath120 ) for the various covariance matrices relating to the method .",
    "these weights are defined as follows . @xmath121",
    "the weights @xmath119 are normalised : @xmath122 the scaling parameter @xmath118 is expressed in terms of two parameters , @xmath123 $ ] and @xmath124 , according to the formula : @xmath125 obviously , three parameters need adjustment before applying the ukf : @xmath96 , @xmath97 , and @xmath124 . the parameters @xmath96 and @xmath124 regulate the range of values of the sigma points : the distance between corresponding sigma points widens with increasing values of these two parameters .",
    "a general method for obtaining the optimal values of @xmath96 , @xmath97 , and @xmath124 is still to be established ; these parameters may be ` fine - tuned ' , aiming at the optimisation of the results in each particular problem . in case of gaussian distributions , the choice @xmath126 is optimal @xcite .    in the correction phase",
    ", one selects a new set of @xmath113 representative points around @xmath26 ( taking the updated covariance matrix @xmath27 into account , in accordance with eq .",
    "( [ eq : eq005 ] ) ) , propagates these points through the non - linear function @xmath87 , and obtains estimates for @xmath28 and @xmath29 as weighted averages over the transformed points .",
    "two sigma points per component of the vector @xmath26 ( as well as the central value ) , are selected .",
    "@xmath127 the quantity @xmath128 represents the @xmath116 column of the ` square root ' of the matrix @xmath129 apart from the use of a single point to utilising a set of appropriately selected points , one additional modification over the steps outlined by eqs .",
    "( [ eq : eq005]-[eq : eq010 ] ) is worth mentioning : in the ukf , the optimal gain matrix @xmath55 involves the so - called state - measurement cross - covariance matrix ; the product @xmath130 of eq .",
    "( [ eq : eq008 ] ) is replaced by this matrix .",
    "* prediction equations *    the two prediction equations take the form :    * _ a priori _ state estimate ( @xmath5-dimensional ket ) @xmath131 * _ a priori _ covariance matrix ( @xmath13 matrix ) @xmath132    * correction equations *    the correction equations take the form :    * predicted measurements ( @xmath3-dimensional ket ) @xmath133 * residuals ( @xmath3-dimensional ket ) @xmath134 * innovation matrix ( @xmath18 matrix ) @xmath135 * state - measurement cross - covariance matrix ( @xmath43 matrix ) @xmath136 * optimal gain ( @xmath43 matrix ) @xmath137 * _ a posteriori _ state estimate ( @xmath5-dimensional ket ) @xmath138 * _ a posteriori _ covariance matrix ( @xmath13 matrix ) @xmath139    the weights @xmath119 and @xmath120 ( identical in both phases ) have been detailed in eqs .",
    "( [ eq : eq031 ] ) .",
    "the re - entry problem ( i.e. , the motion of an earth - bound spacecraft , impacting the earth s atmosphere ) , tailored to the case of the space shuttle , is described in appendix [ app : appb ] .",
    "the position and the direction of motion of the incoming spacecraft are monitored by terrestrial radars , providing the measurements ( for the filters ) .",
    "mehra @xcite compared the performance of several non - linear filters on such data , including two ekfs ( formulated in two different coordinate systems ) , whereas chang , whiting , and athans @xcite addressed the modelling accuracy and complexity , as well as the real - time processing requirements , also exploring techniques compensating for modelling inaccuracies by increasing the process noise .",
    "austin and leondes @xcite developed a robust filter , based on statistical linearisation .",
    "more recently , crassidis and markley @xcite , as well as a number of other authors with contributions in the proceedings of various aiaa and ieee conferences , dealt with the re - entry problem , which is generally regarded as stressful for filters and trackers @xcite .",
    "one simplification of the problem is achieved by considering the @xmath140-dimensional motion of the vehicle as planar ; in this approximation , the object remains on the plane defined by the velocity vector at the beginning of the re - entry and the centre of gravity , see fig .",
    "[ fig : reentrygeometry ] .    the coordinate system used in the re - entry problem .",
    "point @xmath141 corresponds to the position of the vehicle at time @xmath142 ; as in ref .",
    "@xcite , an initial altitude of @xmath143 km is assumed .",
    "figure ( a ) , drawn to scale , demonstrates the smallness of this altitude in comparison to the radius of the earth .",
    "figure ( b ) , also drawn to scale , is a close - up of fig .",
    "( a ) around points @xmath141 and @xmath144 ; the axis @xmath145 is parallel to @xmath146 .",
    "the green vector indicates the initial velocity of the vehicle ( @xmath147 km / s,@xmath148 km / s ) @xcite .",
    "the coordinate system ( @xmath149,@xmath145 ) , hence also ( @xmath149,@xmath146 ) , may be chosen at will ; however , it makes sense to place the origin of the system in the vicinity of the region of interest , i.e. , of the points @xmath141 and @xmath144.,width=585 ]    the dynamical model , followed in ref .",
    "@xcite , attempts the determination of the motion on the basis of three forces .",
    "* the aerodynamic drag .",
    "this velocity- and altitude - dependent force is the dominant one . *",
    "the gravitational force . * forces associated with random buffeting effects .",
    "the state of the system is assumed to be a @xmath150-dimensional vector , comprising the coordinates @xmath149 and @xmath146 of the position vector , the corresponding velocities @xmath151 and @xmath152 , as well as one term associated with the aerodynamic aspects of the motion ( @xmath153 ) .",
    "the rate of change of the two velocity components and of @xmath153 , including the process noise @xmath154 of eq .",
    "( [ eq : eq001 ] ) , is given in ref .",
    "@xcite as : @xmath155 where @xmath156 for the sake of brevity , all dependences on the appropriate variables , as well as on time , are not explicitly given in eqs .",
    "( [ eq : eq043],[eq : eq044 ] ) .",
    "the constants are fixed as follows : @xmath157 km @xcite , @xmath158 m@xmath159 kg@xmath160 s@xmath69 , @xmath161 kg , and @xmath162 km @xcite .    regarding this problem , the reader should be warned that refs .",
    "@xcite contain a number of mistakes ; a subsequent short communication @xcite attempted corrections to some of these flaws , but did not cover all the issues raised below .",
    "the corrected flaws are as follows .    * a representative value of the ballistic coefficient @xmath163 ( this parameter being denoted as @xmath164 therein )",
    "was given in refs .",
    "@xcite as @xmath165 km@xmath160 ( in both papers , most of the physical units were omitted ; si base units were generally assumed , save for the lengths which were expressed in km ) .",
    "however , given the overall sign of the function @xmath141 ( denoted as @xmath166 therein ) , a negative @xmath163 value would inevitably result in a drag force pointing toward the centre of gravity , i.e. , in the direction of motion ; therefore , when adopting the negative sign of refs .",
    "@xcite ( see first of eqs .",
    "( [ eq : eq044 ] ) ) , the correct @xmath163 value is @xmath167 km@xmath160 .",
    "reference @xcite provided a correction by reverting the overall sign of the function @xmath141 ( and retaining the @xmath163 value given in refs .",
    "@xcite ) . * in the formula of the gravitational force , the quantity @xmath168 in refs .",
    "@xcite was replaced by @xmath169 @xcite . * the covariance matrix of the process noise @xmath16 , given in refs .",
    "@xcite , corresponds to the input in the monte - carlo simulation ; the matrix driving the filter ( to be given shortly ) contains a non - zero diagonal element for the state - vector component @xmath153 @xcite .",
    "* figures 5 @xcite and 9 @xcite are confusing . the caption of the figures refers to one solid line , yet two solid curves appear in each of these figures ; the dots of the dotted curves can not be discerned , and these curves also appear as solid ( thicker , however , than the curves which were intended to be ` solid lines ' ) .",
    "reference @xcite provided a set of improved figures .",
    "for some inexplicable reason , the reviewers of these two works missed all these obvious problems .",
    "two additional flaws in refs .",
    "@xcite remain uncorrected : one is an obvious ` slip of the pen ' , whereas the second one is rather serious . regarding the former ,",
    "the statistical term ` variance ' is used in section 4 of ref .",
    "@xcite , at the point where the covariance matrix of the measurement noise is introduced , rather than ` standard deviation ' ; that passage was obviously copied - and - pasted to part b of section vi of ref .",
    "@xcite , which contains the same mistake .",
    "the serious flaw will be discussed shortly .",
    "assumed in ref .",
    "@xcite is that the motion of the vehicle is monitored by a radar positioned at ( @xmath149,@xmath146)=(@xmath170,@xmath171 ) ; i will use @xmath172 and @xmath173 , i.e. , a radar positioned at point @xmath144 in fig .",
    "[ fig : reentrygeometry ] .",
    "the radar of ref .",
    "@xcite provides measurements of the distance @xmath174 , as well as of the elevation angle @xmath175 , at the sampling rate of @xmath79 hz .",
    "evidently , @xmath176 where @xmath177 and @xmath178 represent the two components of the measurement noise ; herein , the root - mean - square ( rms ) of the measurement noise was set to @xmath76 m for @xmath174 and @xmath179 mrad for @xmath175 @xcite . in fig .",
    "[ fig : reentrygeometry ] , the distance @xmath174 of the first of eqs .",
    "( [ eq : eq045 ] ) is the magnitude of the position vector of the vehicle in the coordinate system ( @xmath149,@xmath145 ) with origin at point @xmath144 ; @xmath175 is the angle of the position vector with the @xmath145 axis .",
    "the second uncorrected flaw of refs .",
    "@xcite relates to the rms of the noise in the angle measurement .",
    "on page 102 of ref .",
    "@xcite , chang , whiting , and athans wrote in 1977 : `` the angle measurement standard deviation is assumed to be @xmath179 mrad . ''",
    "quoting that paper in refs .",
    "@xcite , julier and uhlmann explain : ``  @xmath180 and @xmath181 [ equivalent to the quantities @xmath177 and @xmath178 of eqs .",
    "( [ eq : eq045 ] ) ] are zero mean uncorrelated noise processes with variances [ _ sic _ ] of @xmath76 m and @xmath182 mrad , respectively . ''",
    "up to the present time , it remains a mystery why the noise level in the measurement of the angle in refs .",
    "@xcite was increased by two orders of magnitude ( that is , if the value quoted in refs .",
    "@xcite is not one additional mistype ) .",
    "the actual state of the system at @xmath142 is given in ref .",
    "@xcite as @xmath183 and the process noise as @xmath184 where @xmath185 km@xmath186/s@xmath187 @xcite and @xmath188 @xcite .    on the basis of this input",
    ", one may obtain series of simulated radar measurements ( @xmath174,@xmath175 ) and filter the data using the ukf .",
    "one representative example of residuals ( i.e. , of the differences between the simulated and the filtered data ) is displayed in figs .",
    "[ fig : residualsreentrydistance ] and [ fig : residualsreentryangle ] . the reduced @xmath189 ( i.e. , the overall @xmath189 value divided by the number of degrees of freedom ) , obtained on the basis of these residuals for the measurement uncertainties of ref .  @xcite , comes out equal to about @xmath190 .",
    "this value suggests that the filtering of the raw measurements is successful   value is significantly smaller than @xmath76 ; this is the result of the obvious double - counting of the uncertainties in the simulation and in the processing of the simulated data . ] .",
    "furthermore , the residuals come out independent of the free variable in the problem ( i.e. , the time @xmath191 ) ; this is the expected result in all successful optimisation schemes .",
    "plots [ fig : residualsreentrydistance ] and [ fig : residualsreentryangle ] have been obtained using the @xmath96 , @xmath97 , and @xmath124 values of @xmath192 , @xmath75 , and @xmath63 , respectively @xcite .",
    "it has been confirmed that the sensitivity of the present results to the variation of the parameters   values ( e.g. , they use @xmath193 ) , as well as the choice @xmath194 @xcite . in ref .",
    "@xcite , srkk also used a ` large ' @xmath96 value ( namely , @xmath195 ) ; however , the comparison of his parameter values with those of other works might not be appropriate , as it is not clear whether the second of his eqs .",
    "( 10 ) - i.e. , the expression yielding his weight @xmath196 , denoted as @xmath197 in this work , see the second of eqs .",
    "( [ eq : eq031 ] ) - is a mistype or represents the actual formula employed in srkk s work . ]",
    "@xmath96 ( fixed at @xmath198 , @xmath192 , @xmath199 , @xmath195 , and @xmath76 ) and @xmath124 ( fixed at @xmath200 and @xmath63 ) is very low . for @xmath201 , the reduced @xmath189 varied between @xmath202 and @xmath203 ; somewhat smaller values were obtained for @xmath204 , but the temporal dependence of the diagonal elements of the covariance matrix @xmath205 was rather noisy .",
    "the time series of the residuals between the simulated and filtered data of the distance @xmath174 for @xmath206 s.,width=585 ]    the time series of the residuals between the simulated and filtered data of the elevation angle @xmath175 for @xmath206 s.,width=585 ]    the effort notwithstanding , i have not been able to reproduce the temporal dependence of the variance of the state - vector components @xmath149 , @xmath207 , and @xmath153 , given in refs .  @xcite ; unfortunately , it has not been possible to resolve this issue with the first author of these works .",
    "the inability to reproduce these plots may be due to my misinterpretation of the process and measurement covariance matrices , given in these three papers .",
    "srkk , who also studied the re - entry problem in ref .",
    "@xcite , did not report discrepancies with the results of refs .",
    "@xcite .",
    "the figures in this paper have been produced either with carmetal , a dynamic geometry free software ( gnu - gpl license ) , first developed by ren grothmann and recently under eric hakenholz @xcite , or with matlab .",
    "99 p.  swerling , first - order error propagation in a stagewise smoothing procedure for satellite observations , ca : rand corporation , santa monica ( 1959 ) .",
    "r.  e.  klmn , a new approach to linear filtering and prediction problems , j.  basic eng .  82 ( 1960 ) 35 - 45 .",
    "r.  e.  klmn , r.  s.  bucy , new results in linear filtering and prediction theory , j.  basic eng .  83 ( 1961 ) 95 - 108 .",
    "g.  welch , g.  bishop , an introduction to the kalman filter ; available from the web page : http://www.cs.unc.edu/~tracker/ref/s2001/kalman/index.html s.  thrun , w.  burgard , d.  fox , probabilistic robotics , the mit press ( 2005 ) .",
    "k.  a.  olive , particle data group , the review of particle physics , chin .",
    "c 38 ( 2014 ) 090001 .",
    "a.  j.  lotka , contribution to the theory of periodic reactions , j.  phys .",
    "14 ( 1910 ) 271 - 274 . w.  h.  press , s.  a.  teukolsky , w.  t.  vetterling , b.  p.  flannery , numerical recipes : the art of scientific computing , third edition , cambridge university press ( 2007 ) . s.  j.  julier , j.  k.  uhlmann , new extension of the kalman filter to nonlinear systems , proc .",
    "spie 3068 , signal processing , sensor fusion , and target recognition vi ( 1997 ) 182 - 193 .",
    "s.  j.  julier , j.  k.  uhlmann , unscented filtering and nonlinear estimation , proc .",
    "ieee 92 ( 2004 ) 401 - 422 .",
    "s.  j.  julier , j.  k.  uhlmann , corrections to `` unscented filtering and nonlinear estimation '' , proc .",
    "ieee 92 ( 2004 ) 1958 .",
    "e.  a.  wan , r.  van der merwe , the unscented kalman filter for nonlinear estimation , ieee 2000 symposium on adaptive systems for signal processing , communications , and control ( 2000 ) 153 - 158 .",
    "r.  kandepu , b.  foss , l.  imsland , applying the unscented kalman filter for nonlinear state estimation , j.  process contr .",
    "18 ( 2008 ) 753 - 768 .",
    "r.  van der merwe , e.  a.  wan , the square - root unscented kalman filter for state and parameter estimation , ieee 2001 international conference on acoustics , speech , and signal processing 6 ( 2001 ) 3461 - 3464 .",
    "s.  srkk , on unscented kalman filtering for state estimation of continuous - time nonlinear systems , ieee t.  automat .",
    "52 ( 2007 ) 1631 - 1641 .",
    "r.  k.  mehra , a comparison of several nonlinear filters for reentry vehicle tracking , ieee t.  automat .",
    "contr .  16 ( 1971 ) 307 - 319 .",
    "chaw - bing chang , r.  h.  whiting , m.  athans , on the state and parameter estimation for maneuvering reentry vehicles , ieee t.  automat .",
    "contr .  22 ( 1977 ) 99 - 105 .",
    "j.  w.  austin , c.  t.  leondes , statistically linearized estimation of reentry trajectories , ieee t.  aero .",
    "17 ( 1981 ) 54 - 61 .",
    "j.  l.  crassidis , f.  l.  markley , unscented filtering for spacecraft attitude estimation , j.  guid .",
    "control dynam .  26 ( 2003 ) 536 - 542 .",
    "the equation for viscous resistance is applicable in the case of slow motion of an object through a fluid ; the turbulence may be neglected and the force , associated with the resistance of the fluid , is proportional to the velocity of the object : @xmath208 where @xmath209 is a constant depending on the fluid and on geometrical properties of the object in motion .    taking account of the air resistance of eq .",
    "( [ eq : eqa01 ] ) , newton s second law of motion in case of a massive object , moving in the gravitational field of the earth , is of the form : @xmath210 where @xmath37 denotes the mass of the object .",
    "this equation may be written as : @xmath211 where @xmath212 .",
    "the solution of this equation , compatible with the initial condition @xmath213 , is : @xmath214 for @xmath215 , @xmath216 and eq .  ( [ eq : eq021 ] ) is retrieved .    the altitude @xmath64 is easily obtained via the integration of eq .",
    "( [ eq : eqa04 ] ) .",
    "the solution , compatible with the initial condition @xmath217 , is : @xmath218 for @xmath215 , it is easy to show that eq .",
    "( [ eq : eq020 ] ) is retrieved . as the square of the quantity @xmath219 appears in the denominator of the third term on the right - hand side of eq .",
    "( [ eq : eqa05 ] ) , it is necessary to retain ( in that part ) the terms up to @xmath220 in the taylor expansion of @xmath221 ; for @xmath215 , @xmath222 .",
    "the re - entry procedure of the space shuttle ( henceforth , simply ` orbiter ' ) is initiated at an altitude of @xmath223 km ( above the surface of the earth ) , slightly over one hour before touchdown . at this altitude ,",
    "the velocity of the circular orbit is about @xmath224 km / s .",
    "the orbiter revolves around the earth upside - down , its top side facing toward the globe , with its nose in the direction of the motion .",
    "the orbiter is first flipped about its pitch axis via the application of thrusters .",
    "the oms ( orbital maneuvering system ) engines face now forward and their engagement provides the necessary decrease in velocity ( by slightly over @xmath225 km / h ) , bringing the orbit s perigee into the upper part of the atmosphere and committing the orbiter to the descent .",
    "the orbiter is next flipped - via lateral rcs ( reaction control system ) thrusters - about its yaw axis and attains descent configuration , its nose being in the general direction of the motion and diving toward the surface of the earth .    at an altitude of about @xmath226",
    "km , the hypersonic orbiter enters the upper part of the atmosphere .",
    "it is critical that the angle at which the orbiter impinges onto the atmosphere ( also referred to as the ` angle of attack ' ) be kept within a narrow margin of @xmath227 , thus restricting the motion of the orbiter within a @xmath140-dimensional re - entry corridor ; significantly smaller angles would make the orbiter ` bounce off ' the atmosphere , whereas larger ones would result in its incineration and the loss of the crew .    during the re - entry ,",
    "the kinetic energy of the orbiter is converted into heat and emitted into the atmosphere . in the upper part of the atmosphere , where the air is tenuous",
    ", the descent generates a pressure wave , compressing the air ahead of the plunging orbiter and causing intense atmospheric ionisation .",
    "the largest amount of heat , which the orbiter suffers during re - entry , is dissipated via this detached shock wave .",
    "viscous drag becomes progressively more important as the air density rises with decreasing altitude .    from the moment when the re - entry procedure is initiated to an altitude of about @xmath228 km",
    ", the motion of the orbiter is ballistic . at about this altitude ,",
    "the orbiter becomes manoeuvrable , turning into a giant ( and inelegant ) glider . to expedite the loss of kinetic energy , the orbiter undergoes four steep s - shaped banking turns . in terms of resilience to heat and efficiency in heat dissipation ,",
    "this is the most demanding phase of the re - entry .",
    "temperatures rise up to @xmath229 @xmath230c ; the only protection of the orbiter and of its crew consists of the surface - insulation tiles on the orbiter s underside , a @xmath231-tonne wall between life and death .",
    "the drag on the orbiter increases considerably as it comes into the thicker parts of the atmosphere , the orbiter decelerates at increasing rate , and the autopilot disengages .",
    "manual control of the orbiter is now assumed and its heading is adjusted for landing . shortly before touchdown , the velocity of the orbiter drops below the speed of sound .",
    "as the orbiter is aligned with the runway , it is set into a steep descent , pitching at almost @xmath232 below the local horizontal , seven times steeper than commercial airplanes ."
  ],
  "abstract_text": [
    "<S> the present document aims at providing a short , didactical introduction to three standard versions of the kalman filter , namely its variants identified as basic , extended , and unscented . </S>",
    "<S> the application of these algorithms in three representative problems is discussed . </S>",
    "<S> + _ pacs : _ 42.79.ta , 43.60.+d , 87.85.ng    basic kalman filter ; extended kalman filter ; unscented kalman filter    @xmath0e - mail : evangelos[dot]matsinos[at]sunrise[dot]ch </S>"
  ]
}