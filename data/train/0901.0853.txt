{
  "article_text": [
    "the lattice boltzmann methods in their original form ( see @xcite ) do not guarantee the proper entropy production and may violate the second law .",
    "the proper entropy balance remains up to now a challenging problem for many lattice boltzmann models @xcite .    the entropic lattice boltzmann method ( elbm )",
    "was invented first in 1998 as a tool for construction of single relaxation time lattice boltzman models which respect the @xmath0-theorem @xcite .",
    "for this purpose , instead of the mirror image with local equilibrium as reflection center , the entropic involution was proposed , which preserves the entropy value .",
    "later , we call it the karlin - succi involution @xcite . in 2000",
    ", it was reported that exact implementation of the karlin - succi involution ( which keeps the entropy balance ) significantly regularizes the post - shock dispersive oscillations @xcite .",
    "this regularization seems very surprising , because the entropic lattice bgk ( elbgk ) model gives a second - order approximation to the navier  stokes equation ( different proofs of that degree of approximation were given in @xcite and @xcite ) , and due to the godunov theorem @xcite linear second - order finite difference methods have to be non monotonic .",
    "moreover , lax @xcite and levermore with liu @xcite , demonstrated that these _ dispersive oscillations _ are unavoidable in classical numerical methods .",
    "schemes with precise control of entropy production , studied by tadmor with zhong @xcite , also demonstrated post - shock oscillations .",
    "of course , there remains some gap between methods with proven existence of dispersive oscillations , and elbm .",
    "however , recently , the existence of oscillations in the vicinity of the shock , at small values of viscosity for elbm , was reported for burgers equation @xcite . in a recent paper @xcite post",
    "shock oscillations of elbgk were reported too , and no difference was found between elbgk and lbgk in that regard .",
    "nevertheless , absence of dispersive oscillations for elbgk was reported many times since 2000 . in this paper",
    "we answer the question : does the precise control of entropy production by elbgk smooth the post - shock oscillation ?",
    "the answer is negative .",
    "the exact implementation of the entropic involution does not smooth the dispersive oscillation ( similarly , the exact control of entropy production does not smooth the post shock oscillation in finite difference methods @xcite ) .",
    "hence , the smoothing effect is caused by numerical imprecision in calculations of entropic involution , i.e. in solution of the following transcendental equation with respect to @xmath1 ( @xmath2 ) : @xmath3 where @xmath4 is entropy , @xmath5 is a current distribution , and @xmath6 is the corresponding equilibrium .    in the first part of this paper we discuss a different numerical implementation of the elbgk and",
    "conduct an investigation into exactly what stabilization properties it exhibits .",
    "the choice of the method for solution of ( [ eq : entinv ] ) should be very precise , and in section  [ numsol ] we describe a cubically converging root finding algorithm .",
    "it is not sufficient to have high precision when we have average deviation of the current distribution @xmath5 from the associated equilibrium @xmath6 .",
    "for example , for solutions with shocks , it is usual for the distribution of this deviation to far from being exponential @xcite , and there appear points with deviation of several orders higher than the average .",
    "moreover , it is sufficient to smooth a solution at _ one point _ only .",
    "we demonstrate this in the second part of the paper .",
    "we select the lattice site with most nonequilibrium @xmath5 and regularize the field of nonequilibrium entropy at this point with 3-point median filter @xcite . as a result",
    ", the dispersive oscillations drastically decrease .",
    "the lattice boltzmann method arises as a discretization of boltzmann s kinetic transport equation @xmath7 the _ population function _",
    "@xmath5 describes the distribution of single particles in the system and the _ collision integral _ @xmath8 their interaction . altogether",
    "( [ eq : boltzmanntransport ] ) describes the behaviour of the system at the microscopic level . by selecting a finite number of velocities @xmath9",
    "we create discrete approximation of the kinetic equation in velocity space .",
    "an appropriate choice of the velocities and time step discretizes space . for a time step of @xmath10",
    "the lattice can be created by unscaled space shifts of the velocities , and we get the fully discrete lattice botzmann gas : @xmath11 where the proper transition from continuous collision integral @xmath12 to its fully discrete form @xmath13 is assumed . the simplest and the most common choice for the discrete collision integral @xmath14 is the bhatnagar - gross - krook operator with over - relaxation @xmath15 for the standard lbgk method @xmath16 and @xmath17 $ ] ( usually , @xmath18 $ ] ) is the over - relaxation coefficient used to control viscosity . for @xmath19",
    "the collision operator returns the _ local equilibrium _ @xmath20 and @xmath21 ( the _ mirror reflection _ ) returns the collision for a liquid at the zero viscosity limit . for a viscosity @xmath22 the parameter @xmath23 is chosen by @xmath24 .",
    "it should be noted that a collision integral such as ( [ eq : collisionintegral ] ) demands prior knowledge of a local equilibrium state for the given lattice .    a variation on the lbgk is the elbgk @xcite . in this case",
    "@xmath1 is varied to ensure a constant entropy condition according to the discrete @xmath0-theorem .",
    "in general the entropy function is based upon the lattice and can not always be found explicitly . however in the case of the simple one dimensional lattice with velocities @xmath25 and corresponding populations @xmath26 an explicit boltzmann style entropy function is known @xcite : @xmath27 with knowledge of such a function @xmath1 is found as the non - trivial root of the equation @xmath28 the trivial root @xmath29 returns the entropy value of the original populations .",
    "elbgk then finds the non - trivial @xmath1 such that ( [ eq : elbmcondition ] ) holds .",
    "this version of bgk collision one calls entropic bgk ( or ebgk ) collision .",
    "solution of ( [ eq : elbmcondition ] ) must be found at every time step and lattice site .",
    "entropic equilibria ( also derived from the @xmath0-theorem ) are always used for elbgk .",
    "in the continuous case the boltzmann @xmath0 the maxwellian distribution maximizes entropy and therefore also has zero entropy production . in the context of lattice boltzmann methods",
    "a discrete form of the @xmath0-theorem has been suggested as a way to introduce thermodynamic control to the system @xcite .    from this perspective",
    "the goal is to find an equilibrium state equivalent to the maxwellian in the continuum which will similarly maximize entropy .",
    "before the equilibrium can be found an appropriate @xmath0 function must be known for a given lattice .",
    "these functions have been constructed in a lattice dependent fashion in @xcite , and @xmath30 with s from ( [ eq : elbmentropy ] ) is an example of a @xmath0 function constructed in this way .",
    "using equilbria derived from a @xmath0 function with entropy considerations in mind leads to a thermodynamically correct lbm .",
    "this is easy to see in the case of the ebgk collision operator ( [ eq : collisionintegral ] ) with explicit local equilibrium .",
    "ebgk collision obvioulsly respect the second law ( if @xmath31 ) , and simple analysis of entropy dissipation gives the proper evaluation of viscosity .",
    "elbgk finds the value of @xmath1 that with @xmath21 ( inviscid fluid ) would give zero entropy production , therefore making the position of zero entropy production the limit of any relaxation .",
    "for the fixed @xmath1 used in the lbgk method it remains possible , particularly for low viscosity fluids , to relax past this point resulting in negative entropy production , violating the second law .",
    "near to the zero - viscosity limit the lbgk method produces spurious oscillations around shockwaves .",
    "apart from the thermodynamic benefits of using elbgk it has been claimed @xcite that elbgk s thermodynamic considerations act as a regularizer .",
    "this claim seems to be at odds with other numerical methods which respect the same thermodynamic laws as elbgk .",
    "for example the results of tadmoor and zhong @xcite for an entropy correct method display intensive post - shock oscillations .",
    "furthermore it has been demonstrated @xcite that such dispersive oscillations are artifacts of the lattice rather than thermodynamic issues .",
    "as elbgk clearly operates on exactly the same lattice as lbgk and other finite difference schemes it warrants a deeper investigation into exactly how it achieves the regularization properties claimed .",
    "in order to investigate the stabilization properties of elbgk it is necessary to craft a numerical method capable of finding the non - trivial root in ( [ eq : elbmcondition ] ) . in this section",
    "we fix the population vectors @xmath32 and @xmath33 , and are concerned only with this root finding algorithm .",
    "we recast ( [ eq : elbmcondition ] ) as a function of @xmath1 only : @xmath34 in this setting we attempt to find the non - trivial root @xmath35 of ( [ eq : newcondition ] ) such that @xmath36 .",
    "it should be noted that as we search for @xmath35 numerically we should always take care that the approximation we use is less than @xmath35 itself .",
    "an upper approximation could result in negative entropy production .",
    "the following theorem gives cubic convergence order for a simple algorithm for finding the roots of a concave function based on local quadratic approximations to the target function .",
    "analogously to the case for newton iteration , the constant in the estimate is the ratio of third and first derivatives in the interval of iteration",
    ".    * theorem . * for a three times continously differentiable concave entropy function @xmath37 an iterative root finding method based on the zeros of a second order taylor parabola has cubic convergence sufficiently close to the root .",
    "* proof : * assume that we are operating in a neighbourhood @xmath38 , in which @xmath39 is negative ( as well of course @xmath40 is negative ) . at each iteration",
    "the new estimate for @xmath35 is the greater root of the parabola @xmath41 , the second order taylor polynomial at the current estimate , @xmath42 the lagrange remainder form of the error is @xmath43 where @xmath44 lies between @xmath45 and @xmath1 .",
    "evaluating this at @xmath35 we see that @xmath46 now , using the mean value theorem , for some value @xmath47 $ ] , @xmath48    we use a newton step to estimate the accuracy of the method at each iteration : @xmath49 in fact we use a convergence criteria based not solely on @xmath1 but on @xmath50 , this has the intuitive appeal that in the case where the populations are close to the local equilibrium @xmath51 will be small and a very precise estimate of @xmath1 is unnecessary .",
    "we have some freedom in the choice of the norm used and we select between the standard @xmath52 norm and the entropic norm .",
    "the entropic norm is defined as @xmath53 where @xmath54 is the second differential of entropy at point @xmath33 , and @xmath55 is the standard scalar product .",
    "the final root finding algorithm then is beginning with the lbgk estimate @xmath56 to iterate using the roots of successive parabolas .",
    "if this first initiation step produces non - positive population , then the _ positivity rule _",
    "@xcite could be used ( instead of the mirror image we choose the closest value of @xmath1 which gives non - negative value of populations ) .",
    "the same regularization rule might be suggested if there exists no root we are looking for . in the tests described below , this situation never arose .",
    "we stop the method at the point , @xmath57 to ensure that we use an estimate that is less than the root , at the point where the method has converged we check the sign of @xmath58 .",
    "if @xmath59 then we have achieved a lower estimate , if @xmath60 we correct the estimate to the other side of the root with a double length newton step , @xmath61    at each time step before we begin root finding we eliminate all sites with @xmath62 . for these sites",
    "we make a simple lbgk step . at such sites",
    "we find that round off error in the calculation of @xmath63 by solution of equation ( [ eq : entinv ] ) can result in the root of the parabola becoming imaginary .",
    "we note that in such cases a mirror image given by lbgk is effectively indistinct from the exact elbgk collision .",
    "we now experimentally study the convergence of the method .",
    "the convergence of the bisection method is presented for control . for the bisection method",
    "we calculate an initial estimate using the root of the parabola ( [ eq : parabola ] ) with @xmath64 . whichever side of the root this estimate is on , an estimate for the opposite side can be found using a double length newton step .",
    "we then have both an upper and lower estimate for the root as required for the beginning of the bisection method . for this test @xmath65",
    "is set to @xmath66 .",
    "this is the maximum accuracy following the bound on @xmath67 of @xmath68 due to the quadratic nature of @xmath63 .     under ( [ eq : convergencetwo ] ) using ( * a * )",
    "parabola method with @xmath52 norm ; ( * b * ) parabola method with entropic norm ; ( * c * ) bisection method with @xmath52 norm ; ( * d * ) bisection method with entropic norm .",
    "[ fig : convergencegraph ] ]    for shock tube test using 800 lattice sites at the 400th iteration step ( see detailed description in section  [ tests ] ) , fig .",
    "[ fig : convergencegraph ] shows that the parabola based method required two iterations , but not more than two , at some points in a vicinity of shock .",
    "in other areas one iteration is sufficient for the desired accuracy . across the whole lattice",
    "the entropic norm stipulates a slightly greater number of iterations in both methods .",
    "a standard experiment for the testing of lbms is the one - dimensional shock tube problem .",
    "the lattice velocities used are @xmath69 , so that space shifts of the velocities give lattice sites separated by the unit distance .",
    "800 lattice sites are used and are initialized with the density distribution @xmath70 initially all velocities are set to zero .",
    "we compare the elbgk equipped with the parabola based root finding algorithm using the entropic norm with the standard lbgk method using both standard polynomial and entropic equilibria .",
    "the polynomial equilibria are given in @xcite : @xmath71 the entropic equilibria also used by the elbgk are available explicitly as the maximum of the entropy function ( [ eq : elbmentropy ] ) , @xmath72 now following ( [ lbmeq ] ) the governing equations for the simulation are @xmath73    ] ; ( * b * ) lbgk with entropic equilibria [ @xmath74 ; ( * c * ) elbgk [ @xmath74 ; ( * d * ) lbgk with polynomial equilibria [ @xmath75 ; ( * e * ) lbgk with entropic equilibria [ @xmath75 ; ( * f * ) elbgk [ @xmath76.[fig : elbmresults ] ]    from this experiment we observe no benefit in terms of regularization in using the elbgk rather than the standard lbgk method ( fig .",
    "[ fig : elbmresults ] ) . in both the medium and low viscosity regimes elbgk fails to supress the spurious oscillations found in the standard lbgk method .    to explain previous results showing regularization by the elbgk we note that in the collision integral ( [ eq : collisionintegral ] ) that @xmath1 and @xmath23 are composite . in this sense entropy production controlled by @xmath1 and viscosity controlled by @xmath23",
    "are the same thing .",
    "a weak lower approximation to @xmath1 would lead effectively to addition of entropy at the mostly far from equilibrium sites and therefore would locally increase viscosity .",
    "this numerical viscosity could , probably , explain the regularization and smoothing of the shock profile seen in some elbgk simulations .",
    "finally we consider regularizing the lbgk method using median filtering at a single point .",
    "we follow the prescription detailed in @xcite . first ,",
    "at each time step , we locate the single lattice site @xmath77 with the maximum value of @xmath78 , and call this value @xmath79 . secondly , we find the median value of @xmath80 in the three nearest neighbours of @xmath77 including itself , calling this value @xmath81 .",
    "now instead of being updated using the standard bgk over - relaxation this single site is updated as follows : @xmath82 we observe that filtering a single point at each time step still results in a significant amount of regularization ( fig .",
    "[ fig : medianresults ] ) .    ] ; ( * b * ) lbgk with entropic equilibria and one point median filtering [ @xmath75 .",
    "[ fig : medianresults ] ]    we also examine in each case the lattice site where the filtering is applied .",
    "the zero position is defined as the rightmost lattice site with @xmath83 at each time step and the position of the filtering is measured relative to this site .",
    "the occurrences at each relative position are then summed over the experiment .",
    "we can see ( fig .",
    "[ fig : medianpositions ] ) that the majority of filtering takes place on the shock .",
    "however , in the low viscosity case , we observe that at a small number of time steps the filtered site moves significantly ` behind ' the shockwave .    ] ; ( * b * ) lbgk with entropic equilibria and one point median filtering [ @xmath76.[fig : medianpositions ] ]",
    "we present three main conclusions from this study .    1 .",
    "we do not find any evidence that maintaining proper balance of entropy regularize spurious oscillations the lattice boltzmann method . for elbgk",
    "we confirm the conclusions of lax @xcite and levermore with liu @xcite that _ dispersive oscillations _ are unavoidable in numerical simulation of shocks .",
    "2 .   in order to clean up the parasite dispersive oscillations in the lattice boltzmann method",
    "it is necessary to filter the entropy in some way , so as to reduce the extremely - localised incidents of high non - equilibrium entropy ; see @xcite .",
    "previously reported smoothing of shocks must have been via the inadvertent introduction of numerical dissipation .",
    "( perhaps , this conclusion could be extended to all known regularisers of lbm , including those proposed by ourselves in @xcite . )",
    "3 .   for the 1d shock tube ,",
    "one only needs to filter the entropy at one point per time step ( usually very local to the shock ) , even at very low viscosity , in order to effectively eliminate the post - shock oscillation .",
    "we can expect that in 2d and 3d shocks it will be also necessary to filter nonequilibrium entropy in some local maxima points near the shock front only .",
    "the entropy filtering for non - entropic equilibria is possible @xcite with use of the kullback ",
    "leibler distance from current distribution to equilibrium ( the relative entropy ) .",
    "the matlab code used to produce these results is provided in the appendix .",
    "11    s.  ansumali , i.  v.  karlin , stabilization of the lattice boltzmann method by the @xmath0-theorem : a numerical test , phys . rev .",
    "e , 62 ( 6):79998003 , 2000 .",
    "r.  benzi , s.  succi , and m.  vergassola , the lattice boltzmann - equation  theory and applications , phys .",
    "reports , 222:145197 , 1992 .",
    "b.  m.  boghosian , p.  j.  love , and j.  yepez , entropic lattice boltzmann model for burgers equation , 362:16911702 , 2004 .",
    "r.  a.  brownlee , a.  n.  gorban , and j.  levesley , stability and stabilization of the lattice boltzmann method , phys .",
    "e , 75:036711 , 2007 .",
    "r.  a.  brownlee , a.  n.  gorban , and j.  levesley , nonequilibrium entropy limiters in lattice boltzmann methods , physica a , 387 ( 2 - 3):385406 , 2008 .",
    "s.  k.  godunov , a difference scheme for numerical solution of discontinuous solution of hydrodynamic equations , math .",
    "sbornik , 47:271306 , 1959 .",
    "a.  n.  gorban , basic types of coarse - graining , in : a.  n. gorban , n.  kazantzis , i.  g. kevrekidis , h .- c .",
    "ttinger , and c.  theodoropoulos ( eds . ) , model reduction and coarse - graining approaches for multiscale phenomena , pages 117176 .",
    "springer , berlin - heidelberg - new york , 2006 .",
    "cond - mat/0602024 .",
    "i.  v. karlin , a.  ferrante , and h.  c.  ttinger , perfect entropy functions of the lattice boltzmann method , europhys .",
    "lett . 47:182188 , 1999 .",
    "i.  v.  karlin , a.  n.  gorban , s.  succi , and v.  boffi , maximum entropy principle for lattice kinetic equations , 81:69 , 1998 .",
    "d.  lax , on dispersive difference schemes , phys .",
    "d , 18:250254 , 1986 .    c.  d.  levermore and j .- g .",
    "liu , large oscillations arising in a dispersive numerical scheme , physica d 99:191216 , 1996 .",
    "s.  succi , , oxford university press , new york , 2001 .",
    "e.  tadmor and w.  zhong , entropy stable approximations of navier  stokes equations with no artificial numerical viscosity , j. hyberbolic differ .",
    "equ . , 3:529559 , 2006 .",
    "yong and l .- s .",
    "luo , nonexistence of @xmath0 theorems for the athermal lattice boltzmann models with polynomial equilibria , phys .",
    "e , 67:051105 ."
  ],
  "abstract_text": [
    "<S> we conduct an investigation into the dispersive post - shock oscillations in the entropic lattice - boltzmann method ( elbm ) . to this end </S>",
    "<S> we use a root finding algorithm to implement the elbm which displays fast cubic convergence and guaranties the proper sign of dissipation . </S>",
    "<S> the resulting simulation on the one - dimensional shock tube shows no benefit in terms of regularization from using the elbm over the standard lbgk method . </S>",
    "<S> we also conduct an experiment investigating of the lbgk method using median filtering at a single point per time step . here </S>",
    "<S> we observe that significant regularization can be achieved .    </S>",
    "<S> * keywords * : fluid dynamics , lattice boltzmann , entropy balance , dispersive oscillations , numerical test , shock tube    * ams subject classifications . * </S>",
    "<S> 65n12 , 76m28 , 74q10 , 74j40 </S>"
  ]
}