{
  "article_text": [
    "kinetic models are based on the description of the velocity distribution function for electrons and ions .",
    "an often - used approach is to describe this distribution statistically , employing a sample of particles : this is the pic method  @xcite .",
    "a critical distinction within pic methods is between explicit and implicit algorithms .",
    "explicit algorithms alternatively move particles ( in the fields known until that time ) and advance the fields ( with the sources provided by the particle velocity and position known until that time ) .",
    "this alternative advancing decouples the field and particle equations resulting in a very simple and highly computational efficient technique .",
    "however , the explicit method is limited in what ranges of time steps and grid spacing it can use : the electron scales need to be resolved down to the smallest scales @xcite .",
    "if the electron physics does not necessarily need to be resolved with great accuracy , the explicit method is not appropriate because the attempt to run the simulation with less resolution is met first with an excessive numerical heating due to the failure of energy conservation , followed by numerical instability if the resolution is too coarse @xcite .",
    "this limitation is eliminated by the implicit methods @xcite , where particles and fields are advanced together in a non - linear iterative scheme . to remove the complexity of the non linear coupling and to reduce the computational cost per time step , semi - implicit methods",
    "have been invented @xcite . in this case , the coupling between particles and fields is approximated linearly and a self - consistent equation is solved for the fields alone without needing to iterate with the particles .",
    "two previous semi - implicit classes of algorithms have been published : the direct implicit method ( dim ) @xcite based on expressing the particle response to field changes via a sensitivity matrix , and the implicit moment method ( imm ) @xcite based on approximating the plasma response using moments of the distribution function ( typically up to the pressure tensor ) .",
    "while implicit methods conserve energy exactly , semi - implicit methods tend to either lose or gain energy depending on the specifics of the configuration of the run @xcite . this lack of energy conservation results in limiting the range of resolution accessible .",
    "for example , in reconnection simulations @xcite such as the one reported as an example here , the grid resolution needs to resolve the electron skin depth to represent the physics correctly , but it does not need to resolve the debye length . similarly , the particle trajectories need to be well resolved , a goal reached by resolving well the electron cyclotron motion , but the plasma frequency does not need to be resolved accurately . for low density , low temperature plasmas , there is a vast gap between the debye and skin depth scale . in these situations ,",
    "the semi - implicit methods struggle to conserve energy at a sufficiently good degree to prevent numerical instability .",
    "a new semi - implicit method has been recently developed to conserve energy exactly , to machine precision @xcite .",
    "the first published tests confirm exact energy conservation and suggest that when the method is applied to multiple scale problems , the range of resolution where the method remains stable is wider than in previous semi - implicit schemes .",
    "this possible beneficial effect is put to test in the present paper showing that for three examples of multiple scale problems indeed the new method allows to cover a wide range of resolution without losing stability or energy conservation .",
    "first , we consider the ion acoustic wave , where both electron and ion physics play a role in the evolution and the method shows its ability to run resolving only the ions scales without artificially heating the electrons .",
    "then , the electron acoustic instability is analysed . here",
    ", the concurrent presence of three species : ions and cold and hot electrons , whose dynamics is characterised by different temporal and spatial scales , makes the problem multi - scale . in this case",
    ", we show that ecsim is able to capture the correct physics even when the smallest scales are not resolved .",
    "finally , the well known problem of the so - called gem challenge @xcite is used to show that the only scales which need to be properly resolved are the electron skin - depth in space and the cyclotron period in time ( instead of the electron debye length and the inverse of the electron frequency ) .",
    "stepping over the smaller electron scales ( debye and plasma scales ) does not lead to loss of energy conservation or stability even for cold rarefied plasmas where these scales are orders of magnitude smaller than the resolved scales .",
    "recently a new semi - implicit pic method has been proposed to conserve energy exactly to machine precision @xcite .",
    "the fundamental enabling step that led to the new method is a new mover that allows the explicit analytical calculation of the current generated by the particles during one time step without any approximation .",
    "the new mover combines the dim @xmath0 scheme @xcite with the imm and ecpic @xmath1-scheme @xcite .",
    "the particle position is advanced as in the @xmath0 scheme , but the velocity is advanced as in the @xmath1 scheme : @xmath2 where @xmath3 .",
    "we evaluate the fields at the time staggered particle position @xmath4 known explicitly from the time staggering of the leap - frog , but we use the implicit electric field at the @xmath1 time level : @xmath5 as in the standard imm .",
    "the fields are computed at the known position @xmath4 rather than at the unknown position @xmath6 that in the standard imm requires the predictor - corrector iteration .",
    "these two positions are conceptually similar , expressing the particle position at the mid - time between the old and new evaluations of the velocity . but one is computed explicitly while the other is computed as part of a predictor - corrector iteration .",
    "both are second order accurate , but the scheme in eq.([thetaecsim ] ) is simpler to compute .",
    "the combined scheme is second order accurate and has the same stability properties of the imm .",
    "this property allows one to write the scheme to be exactly energy conserving .",
    "the equation for the velocity can be solved analytically to express explicitly @xmath7  @xcite . using vector manipulation ,",
    "the velocity equation can be rewritten in the equivalent form : @xmath8 where hatted quantities have been rotated by the magnetic field : @xmath9 via a rotation matrix @xmath10 defined as : @xmath11 where @xmath12 is the dyadic tensor ( matrix with diagonal of 1 ) and @xmath13 ( independent of the particle weight and unique to a given species ) .",
    "the fields at the particle positions are computed by interpolation : @xmath14 where we have assumed that the field equations are discretized on a grid with a generic index @xmath15 . for brevity",
    "we introduced the notation : @xmath16 and @xmath17 . in the examples below , the interpolation functions @xmath18 are b - splines of order @xmath19 @xcite .      for the maxwell s equations we use the same discretization as in the standard imm @xcite .",
    "the two curl maxwell s equations are discretized in time with another @xmath1-scheme : @xmath20 where @xmath21 is computed at the mid temporal location . for each species we use @xmath22 where the summation is over the particles of the same species , labeled by @xmath23 .",
    "the total current is obtained summing over the species .",
    "the spatial operators in eq .",
    "( [ maxwell - discrete ] ) are discretized on a grid , indicating @xmath24 as a shorthand for the spatial discretization of the operators . in the examples below the same discretization of ipic3d",
    "is used  @xcite , however , all the derivations below are not critically dependent on which spatial discretization is used .",
    "the set of maxwell s and newton s equations are coupled . in the spirit of the semi - implicit method ,",
    "we do not want to solve two coupled sets with a single non - linear iteration and find instead a way to extract analytically from the equations of motion the information needed for computing the current without first moving the particles . in previous semi - implicit methods this is done via a linearization procedure . the new mover used here",
    "allows us , instead , to derive the current rigorously without any approximation .    substituting then eq .",
    "( [ theta - rotated ] ) into eq .",
    "( [ currentecsim ] ) , we obtain without any approximation or linearization : @xmath25 where we shortened the notation @xmath26 and the summation is intended over all particles of species @xmath23 .",
    "the following hatted currents were defined : @xmath27 representing the current based on the hatted velocities .",
    "computing then the electric field on the particles by interpolation from the grid as in eq.([interp ] ) , eq.([currentecsim2 ] ) becomes : @xmath28    the formula above is conveniently expressed introducing mass matrices  @xcite defined by elements as @xmath29 there are 3@xmath30 such matrices , where @xmath30 is the dimensionality of the magnetic field and velocity vector , not to be confused with the dimensionality of the geometry used for space @xmath31 .",
    "the indices @xmath32 and @xmath33 in eq .",
    "( [ mass - matrices ] ) vary in the 3@xmath30-space .",
    "for example for full 3-components vectors , @xmath34 and there are 9 mass matrices .",
    "each matrix is symmetric and very sparse with just @xmath35 diagonals . in matrix notation",
    "the @xmath36 mass matrices defined above are written as @xmath37 , i.e. without the indices @xmath38 for the vector directions .",
    "using the mass matrices , the current becomes : @xmath39    equation ( [ currentecsimfinal ] ) is the central ingredient of the ecsim method : it expresses the advanced current at the mid - point of the time step and the electric field at the advanced time .",
    "this linear relationship can be substituted into the discretized maxwell s equations ( [ maxwell - discrete ] ) to form a linear set of equations to be solved on the grid : @xmath40 where we have introduced the total current @xmath41 and the species summed mass matrices that written by elements are : @xmath42 which can be more usefully held in memory , reducing the memory consumption by a factor equal to the number of species .      the method described above , in the specific case @xmath43 , satisfies an exact energy conservation principle proven in @xcite : @xmath44    the left hand side is recognized as the variation of the magnetic and electric energy .",
    "the first term on the right hand side is the energy exchange term with the particles and the last term is the divergence of the poynting flux .",
    "this is the usual equation for electromagnetic energy conservation .",
    "the examples below will further confirm in practice the validity of the result above , energy is conserved to machine precision .",
    "the new ecsim has been implemented in a parallel code , which was built over the very basic structure of the implicit moment pic code ipic3d @xcite . despite the differences between the algorithm used in ipic3d and",
    "the one presented here , there are many modules of ipic3d that could be retained in the new code , like the particle communications between processors or the input / output procedure . as its predecessor",
    ", the new code has been written in c and c++ and it uses mpi for parallel communication between processes .",
    "similarly to ipic3d , the new code uses a three dimensional cartesian grid to compute the fields where the particles are immersed .",
    "when several processors are used , the physical domain is divided into sub - domains . in order to compute the derivatives , each process not only owns one sub domain , but also the first cells of its neighbours ( ghost cells ) .",
    "those ghost values are communicated between processes through mpi routines .",
    "analogously , each process owns the particles , which belong to its domain . after every cycle ,",
    "the particles that have left the sub - domain are communicated to the right process via mpi routines .",
    "the results of the simulation are written on disk using the hdf5 format for fields and particles , and in ascii for other additional data ( as the energy of the system or the input data used ) . except for that , everything is different in the new code : the moment gathering , the field solver and the particle mover .    in order to solve the field equations ( eq . ) , the implicit current and the mass matrices need to be computed in advance .",
    "the calculation of the implicit current is different from what was done in ipic3d . here",
    ", for each particle it is necessary to interpolate the magnetic field from the grid to the particle position , then compute the @xmath45 matrix and once the implicit current for that particle has been calculated , interpolate it to the grid .",
    "the mass matrices were not present in ipic3d , and their calculation is the most time demanding part of the code .",
    "for each node there are 27 three - by - three mass matrices ( @xmath46 can take the value of @xmath15 and all the neighbors nodes ) . however , due to their symmetry ( @xmath47 ) , only 14 matrices must be stored in memory for each node , which means that 126 scalar values have to be computed for each node .    in the ecsim algorithm both the electric and the magnetic field",
    "are solved together whereas in ipic3d first the electric field is obtained and then the magnetic field is computed as the curl of the electric field .",
    "thus the linear system is twice as big as the one in ipic3d .",
    "for this reason we decided to use petsc @xcite for the task .",
    "petsc is a suite of libraries , which provide several tools to deal with problems ruled by differential equations .",
    "the main advantages of petsc are that it is specially intended for parallel calculations , meaning that it should scale well when using many cores , and it allows the user to change between several linear and non linear solvers very easily .    finally , once the fields are known , the position and the velocity of the particles can be updated .",
    "unlike what happens in ipic3d , here the mover has an explicit scheme ( no iterations are needed ) . however , for each particle the @xmath45 matrix needs to be computed .",
    "note that this matrix was calculated in the moment gathering , but due to the high number of particles usually employed in the simulations , it is not practical to store these matrices in memory . instead , the @xmath45 matrix is computed again for each particle .",
    "this implies the interpolation of both the electric and magnetic fields from the grid to the particles .",
    "despite this fact , the particle mover in this code is much simpler than it was in ipic3d and it is less time consuming .        in fig .",
    "[ fig:4.1 ] the scheme of the main loop and the percentage of the total time spent in each task are shown .",
    "the data correspond to two different simulations of magnetic reconnection . in both cases ,",
    "the domain was discretised in 256x128 cells and the time step considered was @xmath48 .",
    "a different number of particles per cell has been employed in the two simulations : 256 and 1024 .",
    "both tests have been carried out with 16 mpi processes in a single node with an intel xeon sandy bridge e5 - 2680 processor .",
    "the most time demanding portion of the code is the moment gathering ; in particular the calculation of the mass matrices is clearly the dominant part .",
    "as the number of particles decreases , we would expect the field solver time to become more important , however , even with only 256 particles per cell , the moment gathering is still the most time consuming part of the code .",
    "in all the tests performed , the time required by the particle mover is always negligible when compared with the moment gathering . taking into account",
    "that , the optimization of the code should be focused on the moment gathering stage , and in particular on the mass matrix calculation .",
    "for instance , the vectorization of the mass matrix calculation ( the field interpolation between the grid and the particles and the calculation of the elements of the mass matrices ) will dramatically improve the performance .",
    "future work will address this aspect .",
    "regarding the computation time required by the new code , if we analyze the time per cycle ( with the same input values ) ecsim is more time demanding than ipic3d ( it takes about 3 times more ) .",
    "however , if we look at the big picture , taking into account the fact that in the new code the time step can be chosen much larger than in ipic3d , the new code will need less cycles to cover the same physical time than ipic3d , and hence the total time of the simulation will be considerably reduced . moreover , the grid size ( i.e. the number of cells ) is no longer a constraint .",
    "this means that if we are not interested in the smallest scales of the problem , we can use larger cells ( that is , less cells ) and then reduce the time needed for each cycle .",
    "the peaks are located at @xmath49 , in perfect agreement with the solution of eq .  .",
    "]    ion acoustic waves are longitudinal low frequency modes , where both the ion and the electron dynamics play a role @xcite .",
    "therefore , they represent an optimum multi - scale test for the ecsim algorithm .",
    "the wave is triggered by a density perturbation in a plasma composed of hot electrons and relatively colder ions .",
    "considering maxwellian electrons and ions with temperature @xmath50 and @xmath51 respectively , the wave dispersion relation is @xcite @xmath52 with the susceptibilities @xmath53 given by @xmath54 , \\label{suscept}\\ ] ] where the subscript @xmath33 has been used to indicate the @xmath55 species , @xmath56 and @xmath57 are the wave frequency and the wavenumber respectively , @xmath58 is the plasma frequency of the @xmath55 species having density @xmath59 and mass @xmath60 , @xmath61 is the elementary charge , @xmath62 is the thermal speed and @xmath63 is the plasma dispersion function  @xcite .",
    "0.0043 ( black ) , 0.0089 ( green ) , 0.01 ( orange ) , 0.0133 ( blue ) and 0.0177 ( red ) @xmath64 . ]    a series of numerical simulations were performed to check the code stability and accuracy .",
    "similar parameters to those in @xcite have been used .",
    "a homogeneous plasma composed of electrons and ions with a reduced mass - to - charge ratio of 200 was introduced .",
    "hot electrons with @xmath65 and ions with @xmath66 were considered . at @xmath67 ,",
    "a small sinusoidal perturbation was superimposed to the equilibrium density @xmath68 : @xmath69,\\ ] ] where @xmath70 is the simulation box length , @xmath71 is the speed of light in vacuum , @xmath72 is the ion plasma frequency and @xmath73 is the longitudinal coordinate .",
    "the simulation box was discretised using 32 cells , so that @xmath74 , with @xmath75 electron debye length .",
    "all the simulations used 32000 particles per species , which were pushed until @xmath76 .    at first , code results have been compared with theory . in this case , a time step @xmath77 was employed .",
    "it is important to notice that this time step corresponds to the maximum value that can be used in an explicit electromagnetic pic algorithm for stability reasons ( @xmath78 ) .",
    "figure [ dispersion ] shows the fourier transform in the frequency domain of the electric field .",
    "the field component corresponding to the excited mode @xmath79 is displayed .",
    "the peaks correspond to a wave frequency @xmath49 , in perfect agreement with the solution of eq . .",
    "a detailed study was performed increasing progressively the time step until the semi - implicit limit @xmath80 .",
    "results are summarised in fig .",
    "[ iaw_kinetic_energy ] , where the evolution of the ion and electron kinetic energy is shown .",
    "in all the case considered here , the long term behaviour of the ion acoustic wave is well described .",
    "a stronger damping of the wave is observed when increasing the @xmath81  @xcite , but results are overall convergent and the physics of the wave is captured correctly , even when a big @xmath81 is chosen . in all the simulations ,",
    "the total energy is conserved down to round - off precision as demonstrated in sect .",
    "[ th_energy_conservation ] .",
    "( black ) .",
    "the over - plotted red line represents the theoretical growth rate as provided by the solution of eq . .",
    "( b ) evolution of the electric field energy for @xmath82 1 ( black ) , 2 ( blue ) , 3.5 ( orange ) , 7 ( red ) and 14 ( green ) @xmath83 . ]    in a plasma where ions are at rest and two different populations of electrons with similar density , but different temperature are streaming against each other , when the relative drift is greater than the thermal velocity of the colder species , the electron acoustic instability may arise .",
    "the dispersion relation of the instability is given by @xcite @xmath84 where the subscripts @xmath71 , @xmath85 and @xmath32 indicate cold electrons , hot electrons and ions , respectively .",
    "if maxwellian particles are considered , the ion susceptibility can be expressed by eq .  , while the electron susceptibilities are @xmath86,\\ ] ] being @xmath87 and @xmath88 the drift velocity .    since @xmath89 and @xmath90 , where @xmath91 is the maximum growth rate of the instability , the electron acoustic instability represents a good multi - scale test for the ecsim algorithm .",
    "a simulation box with length @xmath92 filled with a homogenous three species plasma has been considered .",
    "ions with realistic charge to mass ratio are distributed according to a maxwellian with zero average speed and temperature @xmath93 .",
    "the cold electrons with density @xmath94 are characterised by bulk velocity @xmath95 and temperature @xmath96 .",
    "the density and the speed of the hot electrons are such that @xmath97 and @xmath98 , while their temperature is @xmath99 .",
    "the instability is triggered by an initial density perturbation @xmath100 $ ] , where @xmath101 is given by the solution of eq .",
    "and @xmath102 is the corresponding wavenumber .",
    "code results have been compared with the numerical solution of eq . .",
    "in this case the domain was discretised with 1024 cells , so that @xmath103 , being @xmath83 the smallest spatial scale in the system .",
    "the time step was chosen to be the maximum time step allowed in an explicit code : @xmath104 .",
    "figure [ eaw_gr](a ) shows the growth rate @xmath105 of the field component corresponding to @xmath106 .",
    "the simulation growth rate is measured to be @xmath107 , as predicted by the theory .",
    "a set of simulations have been carried out to check the code convergence and stability versus coarser spatial discretisation .",
    "results are reported in fig .",
    "[ eaw_gr](b ) , which shows the evolution of the electric field energy for @xmath108 .",
    "in all the cases analysed , the field energy shows the same trend .",
    "the correct growth rate of the instability can be retrieved by all the simulations and the same saturation level is reached .",
    "the particle phase spaces have been also compared , to determine whether kinetic effects were properly retained .",
    "figure [ eaw_phasespace ] shows the longitudinal phase space for cold and hot electrons at the saturation of the instability ( @xmath109 ) , obtained with the finest and the coarsest resolution .",
    "plots do not show appreciable differences : particle trapping is well described even when @xmath110 , confirming that results are accurate and the algorithm can reproduce well the physics with a coarse discretisation .    ) .",
    "results ( a ) and ( b ) have been obtained with @xmath111 , while ( c ) and ( d ) with @xmath112 . ]      magnetic reconnection @xcite is an important example of electromagnetic processes with multiple scales . in the process of reconnection",
    ", electrons and ions become separated from the field lines , braking the frozen - in condition . in the process , magnetic energy",
    "is released to particle energy ( macroscopic flows and heating ) .",
    "the critical aspect of interest here is that the reconnection process presents two scales : the ion become decoupled from the frozen - in flow on a scale comparable with the ion inertial length , @xmath113 , the electrons instead decouple in a much smaller scale , the electron skin depth , @xmath114 @xcite .",
    "the debye length does not play a significant role in this specific process , although it does play a role in other aspects especially along the separatrices @xcite .",
    "for very cold plasmas the ratio of @xmath115 can be very large .",
    "explicit but even previous semi - implicit method are limited in how far they can exceed the condition @xmath116 .",
    "we show here one example , based on the classic gem - challenge  @xcite .",
    "the system is periodic in all directions and the initial state corresponds to a double harris equilibrium . in particular the initial magnetic field in the x - direction is given by @xcite : @xmath117 where @xmath118 and @xmath119 are the dimensions of the box , @xmath120 and @xmath121 the position of the two current sheets .",
    "the magnetic field @xmath122 is computed from the pressure balance condition @xmath123 , @xmath50 and @xmath124 being the temperature of the electrons and ions .",
    "the magnetic field in z and y directions is zero as are all the components of the electric field .",
    "all the particles of the same species are at the same thermal temperature with maxwellian distribution and the drift velocity is set to ensure force balance .    to trigger the nonstationary reconnection we add a perturbation to the initial magnetic field .",
    "the perturbation chosen in this case is the same as in @xcite and its vector potential is given by @xmath125 where @xmath126 and @xmath127 .",
    "the initial charge density of the system is given by eq .",
    "@xmath128 where @xmath68 is the density of particles with drift velocity and @xmath129 is the density of the background particles ( particles without drift velocity ) .",
    "this perturbation is simular to that in the standard gem challenge  @xcite but more localized in space in @xcite .",
    "the perturbation is strong bringing reconnection immediately to a non - linear state , avoiding the need for a long linear phase of slow growth .",
    "this is the central feature of the gem challenge that makes it a widely used benchmark for new codes .",
    "we have carried out two sets of simulations , in both we use @xmath130 , @xmath131 , @xmath132 , @xmath133 , @xmath134 and @xmath135 ( where the length of the box is in units of the skin depth of the ions ) .",
    "the number of cells in each direction are @xmath136 . in the case of high temperature",
    "the thermal velocity of the electrons is @xmath137 which leads to @xmath138 and in the case of low temperature @xmath139 with @xmath140 ( the velocity is given in units of the speed of light and @xmath122 in units of the alfven magnetic field ) .    for the high temperature case we use two values of the time step @xmath141 and @xmath142 ( in units of the inverse of the ions plasma frequency ) .",
    "in the simulations performed with ipic3d the damping parameter used is @xmath143 , otherwise the energy dramatically increases and the code crashes . with ecsim",
    "we use @xmath144 ( in which case the energy is exactly conserved ) and @xmath145 , which damps out the high frequencies and hence prevents energy conservation .",
    "it is important to note that conversely to what happens in ipic3d , when the energy is not conserved in ecsim , it is because some frequencies are damped , which means that the energy associated to them is lost .",
    "therefore , the energy will always decrease and the system is stable .    , out of plane",
    "magnetic field ( @xmath146 ) in @xmath147.,height=226 ]    in fig .",
    "[ fig:4.2.1 ] we see the magnetic field out of plane ( z - component ) from three different simulations , ipic3d ( @xmath143 ) , ecsim with @xmath143 and ecsim with @xmath144 .",
    "all the results are in good agreement and the only difference is that in the case with @xmath144 there is more noise , which is due to the high frequencies which were damped in the other cases .            in fig .",
    "[ fig:4.2.2 ] the variation of the total energy is shown and , as we expected , the total energy is conserved up to the tolerance of the field solver ( in all cases @xmath148 ) in the results from ecsim with @xmath144 .",
    "the evolution of the magnetic energy ( fig .",
    "[ fig:4.2.3 ] ) , which gives us an idea of the reconnection rate , is very similar in all cases .",
    "the situation in the low temperature case is completely different . if in the high temperature case we needed to simulate up to @xmath149",
    ", here we will need @xmath150 .",
    "if we use the same time step the simulation would be 100 times more expensive , and even in that case , ipic3d is not capable of dealing with this situation : after a given number of cycles the energy dramatically increases ( see fig .",
    "[ fig:4.2.4 ] ) and the simulation has no physical meaning . on the other hand , in ecsim the energy is exactly conserved and hence we are able to use a larger time step without any problems . but even with @xmath143 ( which no longer guarantees energy conservation ) , the energy remains stable , it changes : but the variation is small enough to not distort the results .",
    "this can be seen in fig .",
    "[ fig:4.2.5 ] where the variation of the magnetic energy from ecsim with @xmath143 and @xmath144 is shown .",
    "the new method can capture the kinetic level of description for both species . while some aspects of reconnection can be captured accurately by fluid models ( see @xcite for a review ) , to obtain the phase space distribution of electron and ions ,",
    "full kinetic description is needed .",
    "as reconnection develops , the average electron flows determine the electric and magnetic field structure .",
    "the most typical feature is the formation of the hall magnetic field , seen in fig .",
    "[ fig:4.2.1 ] . these effects can be captured also by fluid models .",
    "but the results reported in fig .",
    "[ fig:4.2.6 ] and [ fig:4.2.7 ] are typical of kinetic approaches .    in fig .",
    "[ fig:4.2.6 ] , the electron and ion phase space is reported in the cross section @xmath151 .",
    "the four panels compare ions and electrons and the cold and hot case ( note the different velocity axis ) .",
    "ions are accelerated at the reconnection site ( located near @xmath152 ) .",
    "we are showing here the distribution function for particles located in the range @xmath153 $ ] and are integrated in the two velocities not reported .",
    "figure [ fig:4.2.7 ] reports the distribution function for the same @xmath154 range but in the plane @xmath155 ( integrated in the other two velocities ) .    for the distribution in @xmath156 , at each @xmath73 the distribution is fairly maxwellian , as can be observed by its symmetry with respect with the peak .",
    "this effect is due to the nature of the particle acceleration along @xmath73 that is caused by the lorentz force associated with the vertical magnetic field  @xcite .",
    "instead , the distribution changes strongly in space , being much narrower at the reconnection site and broadening away from it .",
    "the distribution in @xmath157 , is highly non - maxwellian .",
    "the acceleration along the @xmath158-direction is caused by the reconnection electric field active effectively in the electron diffusion region where the electrons become demagnetized and instead of @xmath159 drifting are accelerated  @xcite . a consequence if this mechanism is the strong distortion of the particle distribution in the vicinity of the x - point .",
    "moving away from the x - point the distribution remains strongly non - maxwellian , especially for the ions , with a distinct asymmetry between positive and negative @xmath157 , the negative side having a much wider width .    . in color",
    "the charge density is shown .",
    "the scale of the ion charge density is shown in the right top side and the one of the electron in the right bottom part.,height=226 ]    .",
    "in color the charge density is shown .",
    "the scale of the ion charge density is shown in the right top side and the one of the electron in the right bottom part.,height=226 ]    in summary , we have shown that , in the situations where ipic3d can be used , the new code gives the same result , and in those set - ups in which ipic3d is limited , the new code is able to give good results , and even more , to speed up the simulation time by using a larger time step .",
    "the new method is capable not only of capturing the non - linear macroscopic effects of reconnection , such as the production of the hall magnetic field but also the detail microphysics of particle acceleration at the kinetic level .",
    "33 natexlab#1#1#1#1 # 1#1 # 1#1#1#1#1_#1 _ # 1#1#1*#1 * # 1#1 # 1#1 # 1#1#1#1#1#1#1_#1 _    c web page .",
    "http://www.mcs.anl.gov/petsc .    .",
    ".    . , .",
    ". .    . , .    , ed . .    .  ( 1 ) , .    .",
    "( 18 ) , .    . ,",
    "( 4 ) , .    .",
    "( 12 ) , .    .",
    "( 9 ) , .    .",
    ".    . , .",
    ". .    . , .    .",
    "( 3 ) , .    .",
    ".    . , .    .  ( 7 ) , .    .",
    "( 8) , .    .",
    "( 17 ) .    .",
    "( 18 ) , .    .",
    "( a3 ) , .    .",
    "( 2 ) , .    .",
    "we presented the ecsim algorithm and tested its ability to handle multiple scales .",
    "the ecsim is based on two innovations .",
    "first , a new mover is presented , a hybrid of the @xmath1-scheme and the leap - frog algorithm .",
    "the new mover is still implicit and unconditionally stable but it allows to more readily compute the interpolation between particles and cells .",
    "second , we use a new method to compute the current needed for maxwell equations .",
    "the new method introduces a number of mass matrices that produce an exact representation of the current .",
    "the relationship between the electric field and the current mediated by the mass matrix is an exact consequence of the mover without any linearization and it is naturally linear .",
    "these two innovations lead to one critical consequence : the new ecsim is exactly energy conserving .",
    "this point is important in two aspects .",
    "first , energy conservation is a desirable property because energy is of course conserved in reality and missing this aspect , as most pic method do , is unsatisfactory .",
    "second , the existence of energy conservation is in itself a proof on non - linear stability in @xmath160-norm .",
    "the fact that an energy integral exist to limit the energy error , eliminating the tendency of pic methods to numerically heat .    compared with explicit pic @xcite",
    ", the new method eliminates all instabilities and in particular the finite grid instability .",
    "this numerical instability leads to numerical exponential growth of the total energy and destroys the simulations , when the grid spacing far exceeds the debye length . in the simplest explicit pic",
    ", this condition requires @xmath116 , a condition that can be somewhat relaxed using higher order interpolation .",
    "the ecsim eliminates this completely , allowing the grid spacing to be several orders of magnitude larger than the debye length , we reported recently a case where the grid spacing was 16 orders of magnitude larger @xcite .",
    "compared with fully implicit methods @xcite that also conserves energy exactly and is stable for any grid spacing , the ecsim differs for its linear formulation of the field equations that removes the need for the newton non - linear iteration .    compared with previous semi - implicit methods , such as the moment implicit @xcite and the direct implicit @xcite , ecsim does not require any linearization step .",
    "the linearization used in the previous semi - implicit methods breaks energy conservation and @xmath160 stability , reintroducing the finite grid instability and a limitation to the size of the cells allowed .",
    "practice and experience ensures that in the implicit moment method , the condition @xmath161 ensures no finite grid instability .",
    "this condition allows much larger cells than in the explicit pic , but still prevents the method from exceeding the debye scales by too large a factor .",
    "this factor , unfortunately is empirical and problem dependent .",
    "practice shows that a plasma with low temperature electrons where the skin depth is much larger than the debye length , @xmath162 , is very hard to model without resolving very small scales .",
    "ecsim , instead , allows the user to completely ignore this limitation and set the grid spacing entirely on accuracy considerations without worrying about stability .",
    "the results section highlights the advantages above in three practical cases .",
    "first , the ion acoustic wave shows the ability of ecsim to resolve accurately the ion scales without needing to resolve the electron scales unnecessarily .",
    "second , the electron acoustic instability is used to show how ecsim can resolve one subpopulation of electrons without needing to resolve the smallest scales of the cold electrons .",
    "finally , for a classic reconnection problem , the gem challenge , ecsim shows the ability described above to resolve the electron scale at the skin depth level without suffering any finite grid instability even for very cold plasmas where @xmath162 .",
    "the present work is supported by the us air force eoard project fa2386 - 14 - 1 - 0052 , by the onderzoekfonds ku leuven ( research fund ku leuven , goa scheme and space weaves run project ) and by the interuniversity attraction poles programme of the belgian science policy office ( iap p7/08 charm ) .",
    "this research used resources of the national energy research scientific computing center , which is supported by the office of science of the u.s .",
    "department of energy under contract no .",
    "de - ac02 - 05ch11231 .",
    "additional computing has been provided by nasa nas and nccs high performance computing , by the flemish supercomputing center ( vsc ) and by prace tier-0 allocations ."
  ],
  "abstract_text": [
    "<S> the recently developed energy conserving semi - implicit method ( ecsim ) for pic simulation is applied to multiple scale problems where the electron - scale physics needs to be only partially retained and the interest is on the macroscopic or ion - scale processes . unlike hybrid methods , </S>",
    "<S> the ecsim is capable of providing kinetic electron information , such as wave - electron interaction ( landau damping or cyclotron resonance ) and non - maxwellian electron velocity distributions . </S>",
    "<S> however , like hybrid , the ecsim does not need to resolve all electron scales , allowing time steps and grid spacing orders of magnitude larger than in explicit pic schemes . </S>",
    "<S> the additional advantage of the ecsim is that the stability at large scale is obtained while conserving energy exactly . </S>",
    "<S> three examples are presented : ion acoustic waves , electron acoustic instability and reconnection processes . </S>"
  ]
}