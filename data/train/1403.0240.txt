{
  "article_text": [
    "computational analysis of microscopy images has become a key step in many biological studies .",
    "it enables processing ever - larger sets of images at high throughput , improves reproducibility , and enables image - based modeling and simulation of biological systems  @xcite .",
    "additionally , computational image analysis methods can sometimes detect signals that the human eye can not see  @xcite .",
    "biological microscopy image data , however , come with their own set of challenges : they are usually diffraction limited and recorded at low signal - to - noise ratios ( snr ) , in order to minimize photo - toxic effects in the sample . in addition , the trend is to acquire three or even higher - dimensional images using microscopy techniques such as selective plane illumination microscopy ( spim )  @xcite .",
    "the noise in these images is often not gaussian . in fluorescence microscopy ,",
    "only the fluorescently labeled structures are visible in the image , whereas other structures that are present in the sample are not imaged .",
    "this limits system observability . for these and other reasons ,",
    "bio - image analysis tasks tend to be highly ill - posed .",
    "the strong ill - posedness of bio - image analysis problems requires additional regularization .",
    "this can be done in a biologically meaningful way by including prior knowledge about the imaged system and the imaging process into the analysis algorithms .",
    "this prior knowledge constrains the set of possible solutions to biologically and physically feasible ones , hence regularizing the analysis task .",
    "bio - image analysis aims to extract quantitative information from higher - dimensional low - signal images , exploiting strong prior knowledge  @xcite .",
    "bayesian inference provides a principled way for including prior knowledge into image - analysis algorithms . in bayesian image analysis ,",
    "one aims to maximize the _",
    "posterior _ probability of the analysis result to be correct , given the observed image ( see methods section ) .",
    "using bayes formula , the posterior is expressed as the product of the _ likelihood _ of observing the image and the _ prior _ probability of the result ( see methods section ) . in image segmentation ,",
    "deformable models provide for a straightforward implementation of bayesian , or `` model - based '' , methods  @xcite . in this class of methods ,",
    "the contours of the objects in the image are represented using models from computational geometry , such as splines  @xcite , level sets  @xcite , or triangulated surfaces  @xcite .",
    "these models then deform and move over the image so as to maximize the posterior .",
    "the evolution is driven by an optimization algorithm .    in segmentation of fluorescence microscopy images , the prior knowledge that has been used to improve",
    "the quality and robustness of the results includes : ( 1 ) the point - spread function of the microscope to describe how the image has been acquired and to yield `` deconvolving segmentations ''  @xcite ; ( 2 ) the statistical distribution of the noise in the image in order to produce optimally denoised segmentations  @xcite ; ( 3 ) topological priors about the connectedness of regions in the image  @xcite ; ( 4 ) physical priors about the mechanics of the imaged objects  @xcite ; ( 5 ) the expected shape of the imaged objects  @xcite ; ( 6 ) the expected color , texture , or motion of the imaged objects  @xcite , etc .",
    "a fundamental choice in any bayesian method is how one measures distances between different shapes or segmentations .",
    "this is required by the optimization algorithm in order to perturb the deformable model and quantify the magnitude of this perturbation . defining the gradient of the posterior hence relies on defining an inner product in the set of perturbations of a deformable model .",
    "the most common choice is the geometric @xmath0-type inner product .",
    "this has , however , been shown to lead to a pathological metric in which the `` distance '' between _ any _ two curves is zero  @xcite . as a result , optimizing a deformable model via a @xmath0-type gradient flow is very sensitive to noise and requires length or curvature regularization of the contour  @xcite .",
    "another undesirable feature of @xmath0-gradient flows is that they do not distinguish between global ( rigid - body ) _ motion _ of the contour and local _ deformation",
    "_  @xcite .",
    "the pathological nature of the riemannian metric induced by the @xmath0 inner product on the space of smooth curves is effectively avoided when using sobolev gradients  @xcite .",
    "this considers the bayesian posterior to be an element of a sobolev space  @xcite . in a sobolev space , the definition of neighborhood is naturally adapted to the segmentation problem  @xcite",
    "this leads to results that are more robust against noise , smoother , and allow for more `` natural '' contour perturbations .",
    "it is well known and has previously been demonstrated that sobolev gradients are useful in a variety of segmentation and tracking algorithms , since they allow one to use model formulations that would be ill - posed or numerically intractable when using @xmath0-based gradients  @xcite .    here",
    ", we show how a recently introduced particle - based deformable model  @xcite can be extended to sobolev gradients .",
    "the particle - method nature of the algorithm enables a novel , simple and computationally efficient approximation of sobolev gradients .",
    "we exploit the fact that pairwise particle  particle interactions amount to a discrete convolution  @xcite . since sobolev gradients can be computed by convolution of the @xmath0 gradient with a decaying kernel function ( see eq .",
    "( 13 ) in ref .",
    "@xcite ) , they can be approximated by local interactions between the contour particles within a certain cutoff radius .",
    "this effectively avoids solving a global poisson equation at each iteration , as was previously necessary  @xcite . in the present particle - based algorithm ,",
    "sobolev gradients incur virtually no additional implementation overhead , are computationally efficient , and can easily be parallelized .",
    "we provide the mathematical formalism for approximating sobolev gradients using discrete particle methods , and we show that this approximation preserves the known qualitative properties of sobolev gradient flows as compared to @xmath0 gradient flows .",
    "deformable models consist of a geometry representation and an evolution law  @xcite .",
    "the evolution law acts on the degrees of freedom of the geometry representation  @xcite . in bayesian methods ,",
    "this is done such as to maximize the posterior or , equivalently ( according to a boltzmann distribution ) , minimize the energy functional obtained by taking the negative logarithm of the posterior ( see methods section ) .",
    "deformable models can be continuous or discrete . in either case",
    "they can be implicit ( also called geometric models , such as level sets  @xcite ) or explicit ( also called parametric models , such as splines  @xcite ) .",
    "the relationship between explicit and implicit models has previously been studied  @xcite . in continuous deformable models ,",
    "the contour is represented by a mathematical object that is a continuous function of space .",
    "the contour is hence not limited to the pixel grid of a digital image , but may also evolve in sub - pixel steps  @xcite .",
    "discrete representations directly store region labels at grid nodes .",
    "grid nodes usually coincide with pixels .",
    "this allows straightforward representation of multiple regions and efficient querying of spatial information .    here , we consider a discrete deformable model where the contour is represented by computational particles placed in the pixels around which the contour passes .",
    "this is illustrated in fig .",
    "[ fig : fg_simple ] and provides a geometry representation that is somewhere between explicit and implicit  @xcite .",
    "particles migrate to neighboring pixels in order to deform the contour .",
    "all foreground regions are defined as closed sets , i.e. , the contour pixels belong to the foreground region .",
    "there is only one single background region in the entire image , which is an open set .",
    "foreground regions are constrained to be connected sets of pixels , whereas the background region may be disconnected .",
    "see ref .",
    "@xcite for details .",
    "the region competition algorithm  @xcite is a discrete optimization algorithm to drive the evolution of contours represented by discrete particles .",
    "the algorithm can advance an arbitrary number of contours simultaneously and provides topological control over the evolving contours .",
    "topological control ensures that contours remain connected ( i.e. , `` intact '' according to the region definition used  @xcite ) and provides control over merging and splitting events between different contours .",
    "local energy minimization is done by gradient descent , approximating the gradient as the energy difference between a perturbed and the original set of particles .",
    "the result of the algorithm does not depend on the order in which the particles are processed ( or , equivalently , the indexing order of the particles ) , since the particles are ranked in order of decreasing energy difference before the moves are executed .",
    "the rc algorithm readily generalizes to 3d images , as the particle contour representation remains unaltered .",
    "rc has been demonstrated on 2d and 3d images using a variety of image models , including piecewise constant , piecewise smooth , and deconvolving models  @xcite .",
    "the computational performance of rc is competitive with other state - of - the - art discrete methods , such as graph - cuts  @xcite . for details ,",
    "we refer to the original publication  @xcite .",
    "the original work presenting the rc algorithm used a @xmath0-type discrete gradient approximation , which is known to frequently get trapped in local minima and be sensitive to noise .",
    "here , we show how sobolev gradients can be approximated in the same algorithm , and we demonstrate the computational efficiency of the resulting implementation .",
    "sobolev active contours are deformable models whose evolution is driven by the sobolev gradient flow of the underlying bayesian energy  @xcite .",
    "the original application of sobolev gradients is the numerical solution of nonlinear partial differential equations  @xcite . in image segmentation ,",
    "sobolev gradients have successfully been used for continuous deformable models , in particular for level sets methods . there , the sobolev gradients are either directly computed on the continuous implicit function representation using variational calculus  @xcite , or the implicit representation is intermediately translated to an explicit ( linear spline ) representation and the sobolev gradients approximated there  @xcite .    here , we integrate sobolev gradients into discrete contour models represented by particles .",
    "the rc algorithm amounts to a gradient descent , where the gradient is approximated at discrete points .",
    "the original work used a @xmath0-type gradient  @xcite .",
    "this implies that one can only consider energies ( image models ) belonging to the @xmath0 inner - product function space .",
    "this inner product has a number of undesirable properties for deformable models  @xcite .",
    "for discrete models , the following two of these properties are of special interest : first , the inner product does not contain any regularity terms .",
    "there is hence nothing in the metric that would discourage the emergence and evolution of non - smooth contour / time ( hyper ) surfaces .",
    "hence , in the presence of noise , the contour becomes non - smooth during evolution , which in term reduces the numerical accuracy of the gradient approximation .",
    "curvature regularization via priors is typically required to prevent this .",
    "second , the @xmath0-type gradient is ignorant with respect to the type of contour motion , such as global translations or local deformations .",
    "intuitively , the contour therefore locally optimizes `` on a small scale '' and frequently gets trapped in local optima of the bayesian posterior .",
    "a sobolev function space is equipped with an inner product that contains @xmath1-terms and derivatives of the function .",
    "the metric on that space induced by this inner product hence includes smoothness terms that allow addressing the regularity issues mentioned above .",
    "using such a metric does not affect the global minimum of the function , but it amounts to _ preconditioning _ the gradient flow , hence rendering it less ill - posed .",
    "while sobolev gradients are computationally more expensive to compute , they often result in a smaller overall number of iterations required by the segmentation algorithm to converge to a local optimum .",
    "depending on the problem at hand , the cost of sobolev gradient approximation may hence be amortized .",
    "we consider a sobolev space @xmath2 , which is a hilbert space @xmath3 , with inner product  @xcite @xmath4 where @xmath5 and @xmath6 are elements of the tangent space of the evolving contour @xmath7 .",
    "the tangent space is the set of all possible deformations of @xmath7 .",
    "the @xmath8-operator in eq .",
    "( [ eq : sobolev_inner_product ] ) is with respect to the @xmath0-norm .",
    "the scalar @xmath9 is a hyper parameter for smoothness and @xmath10 determines the length scale of the smoothness terms in the inner product  @xcite .",
    "the average @xmath11 of @xmath5 over @xmath7 is @xmath12 where @xmath13 is the intrinsic position along the contour , in image coordinates ( e.g. , pixels ) .",
    "the average @xmath14 is defined similarly .",
    "the @xmath0 inner product is @xmath15",
    "we present a deformable model where the geometry representation uses a discrete particle method and the the evolution law is given by a sobolev gradient flow .",
    "we use the rc algorithm to numerically optimize the resulting system , and we demonstrate and benchmark its behavior on synthetic and real - world images .",
    "we adapt the rc algorithm to use an approximate sobolev gradient flow to maximize the segmentation model posterior . in bayesian energy minimization ,",
    "as described in the methods section , this requires computing the first - order sobolev gradient @xmath16 of the image energy @xmath17 using the metric induced by the inner product in eq .",
    "( [ eq : sobolev_inner_product ] ) .",
    "it has been shown  @xcite that this amounts to a convolution of the @xmath0-type gradient @xmath18 @xmath19 with convolution kernel @xmath20 \\ , .\\ ] ] figure  [ fig : sobolev_kernel ] shows @xmath21 for different @xmath22  @xcite .",
    "equation ( [ eq : sobolev_graident ] ) enables computing the first - order sobolev gradient from the @xmath0 gradient .",
    "the convolution domain is @xmath7 .",
    "all distances @xmath23 are hence geodesic distances along the contour .",
    "kernel @xmath21 for different @xmath22 .",
    "the solid , dotted , and dashed curves show @xmath21 for @xmath24 , @xmath25 , and @xmath26 , respectively .",
    "the kernel becomes local ( decays to zero at @xmath27 ) for @xmath24 .",
    "the parameter @xmath28 controls the length scale of the inner product .",
    "it is often set equal to the total contour arc - length @xmath29 in order to obtain a scale - invariant inner product  @xcite .",
    "gradient information is then shared along the entire contour , which enables global ( rigid - body ) contour movements , such as translations and rotations . however",
    ", this also introduces a global coupling into the computations , requiring the solution of a global poisson equation  @xcite or convolution  @xcite at each iteration of the algorithm , which is computationally expensive .    here , we fix @xmath28 and thus impose a scale with respect to the image coordinate system .",
    "this makes sense in bio - image segmentation , where the length - scale of the objects of interest is often known .",
    "@xmath28 hence becomes a user - defined free parameter of the method .",
    "we find @xmath30 to work well on the examples presented hereafter .",
    "we always use @xmath31 in order to get a kernel that decays to zero at @xmath32 , rendering particle  particle interactions local ( see fig .  [",
    "fig : sobolev_kernel ] ) . using this kernel ,",
    "a length scale of @xmath28 of 10 to 12 hence corresponds to a particle  particle interactions radius of 5 to 6 pixel .",
    "as we show below , this leads to a simple and fast approximation of sobolev gradients , which is accurate enough to retain the favorable properties of sobolev gradient flows .      in a discrete particle representation of the contour , the domain of the convolution in eq .",
    "( [ eq : sobolev_graident ] ) is the set of all particles representing that contour . in rc ,",
    "the particles store a discrete @xmath0-type gradient approximation on both sides of the contour @xmath7 , we can thus approximate the sobolev gradient by discretizing eq .",
    "( [ eq : sobolev_graident ] ) over particles  @xcite .",
    "let @xmath33 be the set of particles that are located in the support of @xmath21 and belong to the same contour as particle @xmath34 , i.e. , have region label @xmath35 , thus : @xmath36 .",
    "similarly , let @xmath37 be the particles within the kernel support that lie on the other side of the contour , i.e. , @xmath38 . for each particle @xmath34",
    "we then compute the energy difference as : @xmath39 this amounts to local pairwise particle  particle interactions , as they are commonplace in particle methods , where a convolution is approximated by a sum over particles  @xcite .",
    "we use cell lists  @xcite with a cell edge - length equal to the interaction cutoff radius of @xmath40 in order to efficiently find the neighbors ( interaction partners ) of each particle .",
    "this reduces the average time complexity of the discrete convolution from @xmath41 to @xmath42 for a total of @xmath43 contour particles .    if both terms in eq .",
    "( [ eq : smoothing_sobolev_energy_update ] ) have the same sign , the approximated sobolev gradients on both sides of the contour have opposite directions .",
    "this happens at an extremum of the energy .",
    "since the discrete contour representation does not allow sub - pixel deformations , the contour then oscillates .",
    "this , however , is easily detected  @xcite and the optimizer switches back to using @xmath0-type gradients when oscillations occur .",
    "according to eq .",
    "( [ eq : sobolev_graident ] ) , the distance between two particles on the contour @xmath7 should be the geodesic arc distance @xmath44 between the two points where the particles are located . the present discrete representation ,",
    "however , does not allow computing this quantity . since we consider a relatively small support of @xmath21 ( @xmath45 pixel ) , and objects in biological microscopy images are usually smoother than that , we approximate geodesic distances by euclidean distances @xmath46 .",
    "this approximation breaks down when contours in the image significantly curve on length scales below @xmath28 .",
    "one may then argue , however , that a continuous contour representation is anyway advised  @xcite .",
    "we demonstrate the computational efficiency of particle - approximated sobolev gradients in the rc algorithm  @xcite by comparing with a previous mesh - based level - set implementation  @xcite .",
    "we also illustrate that the present approximation retains the known favorable properties of sobolev gradient flows by qualitatively comparing with segmentations obtained using approximated @xmath0 gradients for a range of regularization parameters @xmath47 ( see methods section for an explanation of the meaning of @xmath47 ) .",
    "all benchmarks are performed using a c++ implementation of rc with @xmath0 and sobolev gradients , run on a single 2.67ghz intel i7 core with 4 gb ram using the intel c++ compiler ( v.  12.0.2 ) .     and",
    "sobolev gradient approximations for the piecewise smooth deconvolving energy described in ref .",
    "( a )  ground - truth data with overlaid gaussian point - spread function of width @xmath48 pixels .",
    "( b )  blurred image convolved with the point - spread function .",
    "( c )  convolved image with poisson noise of psnr 6 .",
    "( d )  initialization for both algorithms .",
    "( e  h ) rc segmentations after 15 , 59 , 88 , and 500 iterations using @xmath0-type gradients . ( i  l )",
    "rc segmentations after 15 , 59 , 88 , and 282 iterations using sobolev gradients .",
    "the sobolev gradient flow is more regular and converges faster .",
    "the same @xmath49 is used for both flows .",
    "the energy landscapes are hence identical , permitting direct comparison between optimization trajectories.,title=\"fig : \" ] a : ground truth [ fig : fanta4_gt ]     and sobolev gradient approximations for the piecewise smooth deconvolving energy described in ref .  @xcite .",
    "( a )  ground - truth data with overlaid gaussian point - spread function of width @xmath48 pixels .",
    "( b )  blurred image convolved with the point - spread function .",
    "( c )  convolved image with poisson noise of psnr 6 .",
    "( d )  initialization for both algorithms .",
    "( e  h ) rc segmentations after 15 , 59 , 88 , and 500 iterations using @xmath0-type gradients . ( i  l )",
    "rc segmentations after 15 , 59 , 88 , and 282 iterations using sobolev gradients .",
    "the sobolev gradient flow is more regular and converges faster .",
    "the same @xmath49 is used for both flows .",
    "the energy landscapes are hence identical , permitting direct comparison between optimization trajectories.,title=\"fig : \" ] b : blurred image [ fig : fanta4_conv ]     and sobolev gradient approximations for the piecewise smooth deconvolving energy described in ref .",
    "( a )  ground - truth data with overlaid gaussian point - spread function of width @xmath48 pixels .",
    "( b )  blurred image convolved with the point - spread function .",
    "( c )  convolved image with poisson noise of psnr 6 .",
    "( d )  initialization for both algorithms .",
    "( e  h ) rc segmentations after 15 , 59 , 88 , and 500 iterations using @xmath0-type gradients . ( i  l ) rc segmentations after 15 , 59 , 88 , and 282 iterations using sobolev gradients .",
    "the sobolev gradient flow is more regular and converges faster .",
    "the same @xmath49 is used for both flows .",
    "the energy landscapes are hence identical , permitting direct comparison between optimization trajectories.,title=\"fig : \" ] c : noisy , blurred image [ fig : fanta4_data ]     and sobolev gradient approximations for the piecewise smooth deconvolving energy described in ref .",
    "( a )  ground - truth data with overlaid gaussian point - spread function of width @xmath48 pixels .",
    "( b )  blurred image convolved with the point - spread function .",
    "( c )  convolved image with poisson noise of psnr 6 .",
    "( d )  initialization for both algorithms .",
    "( e  h ) rc segmentations after 15 , 59 , 88 , and 500 iterations using @xmath0-type gradients . ( i  l ) rc segmentations after 15 , 59 , 88 , and 282 iterations using sobolev gradients .",
    "the sobolev gradient flow is more regular and converges faster .",
    "the same @xmath49 is used for both flows .",
    "the energy landscapes are hence identical , permitting direct comparison between optimization trajectories.,title=\"fig : \" ] d : initial segmentation [ fig : fanta4_init ]     and sobolev gradient approximations for the piecewise smooth deconvolving energy described in ref .  @xcite .",
    "( a )  ground - truth data with overlaid gaussian point - spread function of width @xmath48 pixels .",
    "( b )  blurred image convolved with the point - spread function .",
    "( c )  convolved image with poisson noise of psnr 6 .",
    "( d )  initialization for both algorithms .",
    "( e  h ) rc segmentations after 15 , 59 , 88 , and 500 iterations using @xmath0-type gradients . ( i  l ) rc segmentations after 15 , 59 , 88 , and 282 iterations using sobolev gradients .",
    "the sobolev gradient flow is more regular and converges faster .",
    "the same @xmath49 is used for both flows .",
    "the energy landscapes are hence identical , permitting direct comparison between optimization trajectories.,title=\"fig : \" ] e : @xmath0 after 15 iter .",
    "[ fig : sobolev_without_frame15 ]     and sobolev gradient approximations for the piecewise smooth deconvolving energy described in ref .",
    "( a )  ground - truth data with overlaid gaussian point - spread function of width @xmath48 pixels .",
    "( b )  blurred image convolved with the point - spread function .",
    "( c )  convolved image with poisson noise of psnr 6 .",
    "( d )  initialization for both algorithms .",
    "( e  h ) rc segmentations after 15 , 59 , 88 , and 500 iterations using @xmath0-type gradients . ( i  l ) rc segmentations after 15 , 59 , 88 , and 282 iterations using sobolev gradients .",
    "the sobolev gradient flow is more regular and converges faster .",
    "the same @xmath49 is used for both flows .",
    "the energy landscapes are hence identical , permitting direct comparison between optimization trajectories.,title=\"fig : \" ] f : @xmath0 after 59 iter .",
    "[ fig : sobolev_without_frame59 ]     and sobolev gradient approximations for the piecewise smooth deconvolving energy described in ref .  @xcite .",
    "( a )  ground - truth data with overlaid gaussian point - spread function of width @xmath48 pixels .",
    "( b )  blurred image convolved with the point - spread function .",
    "( c )  convolved image with poisson noise of psnr 6 .",
    "( d )  initialization for both algorithms .",
    "( e  h ) rc segmentations after 15 , 59 , 88 , and 500 iterations using @xmath0-type gradients .",
    "( i  l ) rc segmentations after 15 , 59 , 88 , and 282 iterations using sobolev gradients .",
    "the sobolev gradient flow is more regular and converges faster .",
    "the same @xmath49 is used for both flows .",
    "the energy landscapes are hence identical , permitting direct comparison between optimization trajectories.,title=\"fig : \" ] g : @xmath0 after 88 iter .",
    "[ fig : sobolev_without_frame88 ]     and sobolev gradient approximations for the piecewise smooth deconvolving energy described in ref .",
    "@xcite . ( a )",
    "ground - truth data with overlaid gaussian point - spread function of width @xmath48 pixels .",
    "( b )  blurred image convolved with the point - spread function .",
    "( c )  convolved image with poisson noise of psnr 6 .",
    "( d )  initialization for both algorithms .",
    "( e  h ) rc segmentations after 15 , 59 , 88 , and 500 iterations using @xmath0-type gradients .",
    "( i  l ) rc segmentations after 15 , 59 , 88 , and 282 iterations using sobolev gradients .",
    "the sobolev gradient flow is more regular and converges faster .",
    "the same @xmath49 is used for both flows .",
    "the energy landscapes are hence identical , permitting direct comparison between optimization trajectories.,title=\"fig : \" ] h : @xmath0 after 500 iter .",
    "[ fig : sobolev_without_frame500 ]     and sobolev gradient approximations for the piecewise smooth deconvolving energy described in ref .",
    "( a )  ground - truth data with overlaid gaussian point - spread function of width @xmath48 pixels .",
    "( b )  blurred image convolved with the point - spread function .",
    "( c )  convolved image with poisson noise of psnr 6 .",
    "( d )  initialization for both algorithms .",
    "( e  h ) rc segmentations after 15 , 59 , 88 , and 500 iterations using @xmath0-type gradients . ( i ",
    "l ) rc segmentations after 15 , 59 , 88 , and 282 iterations using sobolev gradients .",
    "the sobolev gradient flow is more regular and converges faster .",
    "the same @xmath49 is used for both flows .",
    "the energy landscapes are hence identical , permitting direct comparison between optimization trajectories.,title=\"fig : \" ] i : sobolev after 15 iter .",
    "[ fig : sobolev_with_frame15 ]     and sobolev gradient approximations for the piecewise smooth deconvolving energy described in ref .",
    "( a )  ground - truth data with overlaid gaussian point - spread function of width @xmath48 pixels .",
    "( b )  blurred image convolved with the point - spread function .",
    "( c )  convolved image with poisson noise of psnr 6 .",
    "( d )  initialization for both algorithms .",
    "( e  h ) rc segmentations after 15 , 59 , 88 , and 500 iterations using @xmath0-type gradients .",
    "( i  l ) rc segmentations after 15 , 59 , 88 , and 282 iterations using sobolev gradients .",
    "the sobolev gradient flow is more regular and converges faster .",
    "the same @xmath49 is used for both flows .",
    "the energy landscapes are hence identical , permitting direct comparison between optimization trajectories.,title=\"fig : \" ] j : sobolev after 59 iter .",
    "[ fig : sobolev_with_frame59 ]     and sobolev gradient approximations for the piecewise smooth deconvolving energy described in ref .",
    "( a )  ground - truth data with overlaid gaussian point - spread function of width @xmath48 pixels .",
    "( b )  blurred image convolved with the point - spread function .",
    "( c )  convolved image with poisson noise of psnr 6 .",
    "( d )  initialization for both algorithms .",
    "( e  h ) rc segmentations after 15 , 59 , 88 , and 500 iterations using @xmath0-type gradients . ( i  l ) rc segmentations after 15 , 59 , 88 , and 282 iterations using sobolev gradients .",
    "the sobolev gradient flow is more regular and converges faster .",
    "the same @xmath49 is used for both flows .",
    "the energy landscapes are hence identical , permitting direct comparison between optimization trajectories.,title=\"fig : \" ] k : sobolev after 88 iter .",
    "[ fig : sobolev_with_frame88 ]     and sobolev gradient approximations for the piecewise smooth deconvolving energy described in ref .",
    "( a )  ground - truth data with overlaid gaussian point - spread function of width @xmath48 pixels .",
    "( b )  blurred image convolved with the point - spread function .",
    "( c )  convolved image with poisson noise of psnr 6 .",
    "( d )  initialization for both algorithms .",
    "( e  h ) rc segmentations after 15 , 59 , 88 , and 500 iterations using @xmath0-type gradients . ( i  l )",
    "rc segmentations after 15 , 59 , 88 , and 282 iterations using sobolev gradients .",
    "the sobolev gradient flow is more regular and converges faster .",
    "the same @xmath49 is used for both flows .",
    "the energy landscapes are hence identical , permitting direct comparison between optimization trajectories.,title=\"fig : \" ] l : sobolev after 282 iter .",
    "[ fig : sobolev_with_frame282 ]    the metric induced by the inner product in a sobolev space includes smoothness terms that favor smooth contour evolution , whereas the @xmath0-type gradient flow tends to produce non - smooth contours  @xcite .",
    "we use an artificial deconvolution problem to illustrate that the present particle approximation retains this property .",
    "figure  [ fig : sobolev_fantastic4]c shows the artificial data , which is generated by blurring the ground - truth scene in fig .  [ fig : sobolev_fantastic4]a with the point - spread function shown as a bright spot .",
    "this yields the noise - free image shown in fig .",
    "[ fig : sobolev_fantastic4]b . the input image for rc",
    "is obtained by adding modulatory poisson noise ( fig .",
    "[ fig : sobolev_fantastic4]c ) , modeling a common situation in fluorescence microscopy . from this image",
    ", the algorithm should reconstruct the denoised , deblurred , and segmented objects of the ground truth . the rc algorithm is always initialized with 25 bubbles on a cartesian grid as show in fig .",
    "[ fig : sobolev_fantastic4]d . intermediate results during energy minimization are shown in figs .",
    "[ fig : sobolev_fantastic4]e  g and [ fig : sobolev_fantastic4]i  k for @xmath0 and sobolev gradient flows , respectively . during the first 15 iterations , regions evolve almost identically for both gradient types ( figs .  [",
    "fig : sobolev_fantastic4]e and i ) . after 59 iterations ,",
    "the sobolev - gradient approach is closer to the final solution ( figs .",
    "[ fig : sobolev_fantastic4]f and j ) . after 88 iterations",
    ", it starts oscillating and therefore falls back to the @xmath0-gradient mode ( figs .",
    "[ fig : sobolev_fantastic4]g and k ) .",
    "it converges after 282 iterations ( fig .",
    "[ fig : sobolev_fantastic4]l ) .",
    "the @xmath0-gradient approach converges after 500 iterations ( fig .",
    "[ fig : sobolev_fantastic4]h ) .",
    "the results for both algorithms are shown in figs .",
    "[ fig : sobolev_fantastic4]h and [ fig : sobolev_fantastic4]l .",
    "as expected , they are visually indistinguishable , because changing the gradient flow ( at constant @xmath49 for both flows ) does not change the location of the energy minimum .",
    "however , the sobolev flow uses a different optimization trajectory , which produces intermediate contours that are smoother than those generated by the @xmath0 flow .",
    "this leads to faster convergence and lower computational cost , since the the computational cost of the rc algorithm is proportional to the total contour length  @xcite .",
    "the average iteration times are 0.74s with and 0.73s without sobolev gradients .    , ( b ) @xmath50 , ( c ) @xmath50 , ( d ) @xmath51.,title=\"fig : \" ] , ( b ) @xmath50 , ( c ) @xmath50 , ( d ) @xmath51.,title=\"fig : \" ] a : twocells    , ( b ) @xmath50 , ( c ) @xmath50 , ( d ) @xmath51.,title=\"fig : \" ] , ( b ) @xmath50 , ( c ) @xmath50 , ( d ) @xmath51.,title=\"fig : \" ] b : twoobjects    , ( b ) @xmath50 , ( c ) @xmath50 , ( d ) @xmath51.,title=\"fig : \" ] , ( b ) @xmath50 , ( c ) @xmath50 , ( d ) @xmath51.,title=\"fig : \" ] c : horseshoe    , ( b ) @xmath50 , ( c ) @xmath50 , ( d ) @xmath51.,title=\"fig : \" ] , ( b ) @xmath50 , ( c ) @xmath50 , ( d ) @xmath51.,title=\"fig : \" ] d : airplane    next , we compare the present particle approximation with a fully accurate mesh - based sobolev solver , both in terms of the solutions found and in terms of computational cost . in fig .",
    "[ fig : comp_renka ] we consider the same four test images as were used to benchmark the mesh - based level - set implementation of renka  @xcite .",
    "the results obtained with the present particle method are visually indistinguishable from the results shown in ref .",
    "@xcite , and even seem to be slightly better for the airplane image .",
    "the present particle approximation does hence not seem to have a detectable adverse effect on the solution quality compared with a fully resolved mesh - based level - set method . the present implementation using particle  particle interactions ,",
    "however , leads to significant computational savings , as shown in table [ tab : comp_renka_itime ] . compared with the full - grid method",
    ", the present algorithm is between 3.6 and 17 times faster .",
    "compared with the efficient narrow - band level - set implementation , the present particle method is still between 2.8 and 10 times faster .",
    "the present method is also easier to implement , as it does not require programming an additional poisson solver .",
    ".runtime comparisons ( in seconds per iteration ) of the present particle - based implementation as compared with those reported by renka for a mesh - based level - set implementation of sobolev gradients  @xcite .",
    "[ cols=\"^,^,^,^,^\",options=\"header \" , ]     one case where sobolev gradients are popular is for segmenting very noisy images , where the amount of regularization that would be required in an @xmath0 flow is so large that it would destroy the solution  @xcite . in fig .  [",
    "fig : sobolev_cells ] we show an example of such as case , a microscopy image of fluorescently labeled cells at low signal - to - noise ratio ( snr ) .",
    "the example illustrates that the present implementation retains the known property that sobolev gradients keep the contour smooth despite the noise , resulting in less noise - sensitive segmentations , as shown in fig .",
    "[ fig : sobolev_cells]b .",
    "the @xmath0-gradient flow requires strong curve - length penalization in order to sufficiently regularize the contour ( here , ) .",
    "however , this fails in the present example , as the regions collapse when the regularization parameter is increased to that level , as shown in fig .",
    "[ fig : sobolev_cells]a . for the same @xmath47 ,",
    "this is not the case for the sobolev flow ( fig .",
    "[ fig : sobolev_cells]b ) .",
    "the present example is hence impossible to segment using a piecewise constant image model with @xmath0-type gradients .",
    "-type gradient approximations .",
    "( b ) final rc segmentation when using sobolev gradient approximations . in both cases",
    ".,title=\"fig : \" ] a : @xmath0 gradient result [ fig : sobolev_cells_with_l2 ]    -type gradient approximations .",
    "( b ) final rc segmentation when using sobolev gradient approximations . in both cases",
    ".,title=\"fig : \" ] b : sobolev gradient result [ fig : sobolev_cells_with_sobolev ]    -type gradient approximation ( d  f ) and the sobolev gradient approximation ( g  i ) .",
    "the rc algorithm is used with a piecewise smooth energy and a poisson noise model  @xcite .",
    "the initial segmentation is obtained by otsu thresholding .",
    "the final foreground region is the set union of all foreground regions found by rc .",
    "( a ) raw image with cell membranes fluorescently labeled . image courtesy of prof .",
    "christian dahmann , technical university of dresden .",
    "( b ) result using sobolev gradients until spatial convergence .",
    "oscillations are detected at iteration 23 and the algorithm switches to @xmath0 gradients , leading to a less smooth result after the next iteration ( c ) .",
    "( d ) rc result with @xmath52 gradients and length regularization @xmath53 .",
    "( e ) rc result with @xmath52 gradients and @xmath54 .",
    "( f ) rc result with @xmath52 gradients and @xmath55 .",
    "( g ) rc result with sobolev gradients and @xmath53 .",
    "( h ) rc result with sobolev gradients and @xmath54 .",
    "( i ) rc result with sobolev gradients and @xmath55.,title=\"fig : \" ] + a : raw data    -type gradient approximation ( d  f ) and the sobolev gradient approximation ( g  i ) .",
    "the rc algorithm is used with a piecewise smooth energy and a poisson noise model  @xcite .",
    "the initial segmentation is obtained by otsu thresholding .",
    "the final foreground region is the set union of all foreground regions found by rc .",
    "( a ) raw image with cell membranes fluorescently labeled . image courtesy of prof .",
    "christian dahmann , technical university of dresden .",
    "( b ) result using sobolev gradients until spatial convergence .",
    "oscillations are detected at iteration 23 and the algorithm switches to @xmath0 gradients , leading to a less smooth result after the next iteration ( c ) .",
    "( d ) rc result with @xmath52 gradients and length regularization @xmath53 .",
    "( e ) rc result with @xmath52 gradients and @xmath54 .",
    "( f ) rc result with @xmath52 gradients and @xmath55 .",
    "( g ) rc result with sobolev gradients and @xmath53 .",
    "( h ) rc result with sobolev gradients and @xmath54 .",
    "( i ) rc result with sobolev gradients and @xmath55.,title=\"fig : \" ] + b : sobolev , @xmath53 , iter .",
    "@xmath56    -type gradient approximation ( d  f ) and the sobolev gradient approximation ( g  i ) . the rc algorithm is used with a piecewise smooth energy and a poisson noise model  @xcite .",
    "the initial segmentation is obtained by otsu thresholding .",
    "the final foreground region is the set union of all foreground regions found by rc .",
    "( a ) raw image with cell membranes fluorescently labeled . image courtesy of prof .",
    "christian dahmann , technical university of dresden .",
    "( b ) result using sobolev gradients until spatial convergence .",
    "oscillations are detected at iteration 23 and the algorithm switches to @xmath0 gradients , leading to a less smooth result after the next iteration ( c ) .",
    "( d ) rc result with @xmath52 gradients and length regularization @xmath53 .",
    "( e ) rc result with @xmath52 gradients and @xmath54 .",
    "( f ) rc result with @xmath52 gradients and @xmath55 .",
    "( g ) rc result with sobolev gradients and @xmath53 .",
    "( h ) rc result with sobolev gradients and @xmath54 .",
    "( i ) rc result with sobolev gradients and @xmath55.,title=\"fig : \" ] + c : sobolev , @xmath53 , iter .",
    "@xmath57    -type gradient approximation ( d  f ) and the sobolev gradient approximation ( g  i ) . the rc algorithm is used with a piecewise smooth energy and a poisson noise model  @xcite .",
    "the initial segmentation is obtained by otsu thresholding .",
    "the final foreground region is the set union of all foreground regions found by rc .",
    "( a ) raw image with cell membranes fluorescently labeled . image courtesy of prof .",
    "christian dahmann , technical university of dresden .",
    "( b ) result using sobolev gradients until spatial convergence .",
    "oscillations are detected at iteration 23 and the algorithm switches to @xmath0 gradients , leading to a less smooth result after the next iteration ( c ) .",
    "( d ) rc result with @xmath52 gradients and length regularization @xmath53 .",
    "( e ) rc result with @xmath52 gradients and @xmath54 .",
    "( f ) rc result with @xmath52 gradients and @xmath55 .",
    "( g ) rc result with sobolev gradients and @xmath53 .",
    "( h ) rc result with sobolev gradients and @xmath54 .",
    "( i ) rc result with sobolev gradients and @xmath55.,title=\"fig : \" ] + d : @xmath0 , @xmath53    -type gradient approximation ( d  f ) and the sobolev gradient approximation ( g  i ) . the rc algorithm is used with a piecewise smooth energy and a poisson noise model  @xcite .",
    "the initial segmentation is obtained by otsu thresholding .",
    "the final foreground region is the set union of all foreground regions found by rc .",
    "( a ) raw image with cell membranes fluorescently labeled . image courtesy of prof .",
    "christian dahmann , technical university of dresden .",
    "( b ) result using sobolev gradients until spatial convergence .",
    "oscillations are detected at iteration 23 and the algorithm switches to @xmath0 gradients , leading to a less smooth result after the next iteration ( c ) .",
    "( d ) rc result with @xmath52 gradients and length regularization @xmath53 .",
    "( e ) rc result with @xmath52 gradients and @xmath54 .",
    "( f ) rc result with @xmath52 gradients and @xmath55 .",
    "( g ) rc result with sobolev gradients and @xmath53 .",
    "( h ) rc result with sobolev gradients and @xmath54 .",
    "( i ) rc result with sobolev gradients and @xmath55.,title=\"fig : \" ] + e : @xmath0 , @xmath54    -type gradient approximation ( d  f ) and the sobolev gradient approximation ( g  i ) . the rc algorithm is used with a piecewise smooth energy and a poisson noise model  @xcite .",
    "the initial segmentation is obtained by otsu thresholding .",
    "the final foreground region is the set union of all foreground regions found by rc .",
    "( a ) raw image with cell membranes fluorescently labeled . image courtesy of prof .",
    "christian dahmann , technical university of dresden .",
    "( b ) result using sobolev gradients until spatial convergence .",
    "oscillations are detected at iteration 23 and the algorithm switches to @xmath0 gradients , leading to a less smooth result after the next iteration ( c ) .",
    "( d ) rc result with @xmath52 gradients and length regularization @xmath53 .",
    "( e ) rc result with @xmath52 gradients and @xmath54 .",
    "( f ) rc result with @xmath52 gradients and @xmath55 .",
    "( g ) rc result with sobolev gradients and @xmath53 .",
    "( h ) rc result with sobolev gradients and @xmath54 .",
    "( i ) rc result with sobolev gradients and @xmath55.,title=\"fig : \" ] + f : @xmath0 , @xmath55    -type gradient approximation ( d  f ) and the sobolev gradient approximation ( g  i ) . the rc algorithm is used with a piecewise smooth energy and a poisson noise model  @xcite .",
    "the initial segmentation is obtained by otsu thresholding .",
    "the final foreground region is the set union of all foreground regions found by rc . ( a ) raw image with cell membranes",
    "fluorescently labeled .",
    "image courtesy of prof .",
    "christian dahmann , technical university of dresden .",
    "( b ) result using sobolev gradients until spatial convergence .",
    "oscillations are detected at iteration 23 and the algorithm switches to @xmath0 gradients , leading to a less smooth result after the next iteration ( c ) .",
    "( d ) rc result with @xmath52 gradients and length regularization @xmath53 .",
    "( e ) rc result with @xmath52 gradients and @xmath54 .",
    "( f ) rc result with @xmath52 gradients and @xmath55 .",
    "( g ) rc result with sobolev gradients and @xmath53 .",
    "( h ) rc result with sobolev gradients and @xmath54 .",
    "( i ) rc result with sobolev gradients and @xmath55.,title=\"fig : \" ] + g : sobolev , @xmath53    -type gradient approximation ( d  f ) and the sobolev gradient approximation ( g  i ) . the rc algorithm is used with a piecewise smooth energy and a poisson noise model  @xcite .",
    "the initial segmentation is obtained by otsu thresholding .",
    "the final foreground region is the set union of all foreground regions found by rc .",
    "( a ) raw image with cell membranes fluorescently labeled . image courtesy of prof .",
    "christian dahmann , technical university of dresden .",
    "( b ) result using sobolev gradients until spatial convergence .",
    "oscillations are detected at iteration 23 and the algorithm switches to @xmath0 gradients , leading to a less smooth result after the next iteration ( c ) .",
    "( d ) rc result with @xmath52 gradients and length regularization @xmath53 .",
    "( e ) rc result with @xmath52 gradients and @xmath54 .",
    "( f ) rc result with @xmath52 gradients and @xmath55 .",
    "( g ) rc result with sobolev gradients and @xmath53 .",
    "( h ) rc result with sobolev gradients and @xmath54 .",
    "( i ) rc result with sobolev gradients and @xmath55.,title=\"fig : \" ] + h : sobolev , @xmath54    -type gradient approximation ( d  f ) and the sobolev gradient approximation ( g  i ) . the rc algorithm is used with a piecewise smooth energy and a poisson noise model  @xcite .",
    "the initial segmentation is obtained by otsu thresholding .",
    "the final foreground region is the set union of all foreground regions found by rc .",
    "( a ) raw image with cell membranes fluorescently labeled . image courtesy of prof .",
    "christian dahmann , technical university of dresden .",
    "( b ) result using sobolev gradients until spatial convergence .",
    "oscillations are detected at iteration 23 and the algorithm switches to @xmath0 gradients , leading to a less smooth result after the next iteration ( c ) .",
    "( d ) rc result with @xmath52 gradients and length regularization @xmath53 .",
    "( e ) rc result with @xmath52 gradients and @xmath54 .",
    "( f ) rc result with @xmath52 gradients and @xmath55 .",
    "( g ) rc result with sobolev gradients and @xmath53 .",
    "( h ) rc result with sobolev gradients and @xmath54 .",
    "( i ) rc result with sobolev gradients and @xmath55.,title=\"fig : \" ] + i : sobolev , @xmath55    sobolev gradients precondition the optimization problem and lead to less ill - posed inverse problems  @xcite .",
    "this renders the result less sensitive to the choice of regularization constant @xmath47 , i.e. , giving more weight to the image data and less weight to the bayesian prior ( see methods section ) .",
    "this is desirable since it frees the user of the tedious parameter tuning of finding a `` good '' @xmath47 for a given image .",
    "we illustrate that the present fast implementation retains the property of being robust against the choice of @xmath47 .",
    "we do so by comparing results obtained with the rc algorithm with @xmath0-type and sobolev gradient approximations for different values of the regularization constant ( higher @xmath47 means stronger regularization and more weight to the prior ) .",
    "the results are shown in fig .",
    "[ fig : wing_noise ] for fluorescently labeled cell membranes of a small group of four cells in a fly wing disk , acquired at low snr ( raw data courtesy of prof .  ch .",
    "dahmann , tu dresden ) .",
    "the fluorescence signal varies inhomogeneously across the tissue ( see fig .  [",
    "fig : wing_noise]a ) , which is why we use a piecewise smooth image model in this case  @xcite .",
    "we also assume poisson noise in the image , since shot noise is the dominant noise source in confocal fluorescence microscopy .",
    "figure  [ fig : wing_noise]a shows the raw data . after 23 iterations ,",
    "the rc algorithm with sobolev gradient converged to a point where the contour oscillates around a local energy minimum ( fig .",
    "[ fig : wing_noise]b ) .",
    "the algorithm hence switches to @xmath0 gradients , leading to a significantly less smooth contour after the subsequent iteration , i.e. , after one step of @xmath0-gradient descent ( fig .",
    "[ fig : wing_noise]c ) . nevertheless , the result is still smoother than when using @xmath0 gradients from the beginning ( fig .",
    "[ fig : wing_noise]d ; 39 iterations required to converge ) , indicating that the sobolev gradient flow converged to a different local minimum than the @xmath0 flow . when increasing the regularization constant @xmath47 , the @xmath0 results become smoother , but image features start to be missed , leading in to the formation of a `` hole '' in membrane of the second cell from the left ( figs .",
    "[ fig : wing_noise]e  f ) .",
    "it is hence very important for @xmath0 flows that the user properly tunes @xmath47 by trial and error in order to obtain a topologically correct segmentation .",
    "the final segmentations when using sobolev gradients are less sensitive to changes in @xmath47 and yield the correct topology of the segmentation mask in all tested cases ( figs .",
    "[ fig : wing_noise]g  i ) .",
    "when using sobolev gradients , the contour is also less sensitive to noise and good segmentation results are obtained already for smaller regularization constants than when using @xmath0-type gradients .",
    "this is beneficial in practice , as it frees to user of some of the tedious parameter tuning involved in finding a good @xmath47 for a given image .",
    "the present particle approximation retains this known property of sobolev flows .",
    "the per - iteration cpu time is 0.01s when using @xmath0 gradients and 0.02s for sobolev gradients .",
    "-type gradient approximation ( b  c ) and the sobolev gradient approximation ( d ) . the rc algorithm is used with a piecewise smooth energy and a poisson noise model  @xcite .",
    "the initial segmentation is obtained by otsu thresholding .",
    "( a ) raw data with spectrin fluorescently labeled .",
    "images courtesy of dr .",
    "guillaume salbreux , max planck institute for the physics of complex systems , dresden .",
    "( b ) rc result with @xmath52 gradients and @xmath58 .",
    "( c ) rc result with @xmath52 gradients and @xmath59 ( d ) rc result with sobolev gradients and @xmath58.,title=\"fig : \" ] + a : raw data    -type gradient approximation ( b  c ) and the sobolev gradient approximation ( d ) .",
    "the rc algorithm is used with a piecewise smooth energy and a poisson noise model  @xcite .",
    "the initial segmentation is obtained by otsu thresholding .",
    "( a ) raw data with spectrin fluorescently labeled .",
    "images courtesy of dr .",
    "guillaume salbreux , max planck institute for the physics of complex systems , dresden .",
    "( b ) rc result with @xmath52 gradients and @xmath58 .",
    "( c ) rc result with @xmath52 gradients and @xmath59 ( d ) rc result with sobolev gradients and @xmath58.,title=\"fig : \" ] + b : @xmath0 , @xmath58    -type gradient approximation ( b  c ) and the sobolev gradient approximation ( d ) . the rc algorithm is used with a piecewise smooth energy and a poisson noise model  @xcite .",
    "the initial segmentation is obtained by otsu thresholding .",
    "( a ) raw data with spectrin fluorescently labeled .",
    "images courtesy of dr .",
    "guillaume salbreux , max planck institute for the physics of complex systems , dresden .",
    "( b ) rc result with @xmath52 gradients and @xmath58 .",
    "( c ) rc result with @xmath52 gradients and @xmath59 ( d ) rc result with sobolev gradients and @xmath58.,title=\"fig : \" ] + c : @xmath0 , @xmath59    -type gradient approximation ( b  c ) and the sobolev gradient approximation ( d ) . the rc algorithm is used with a piecewise smooth energy and a poisson noise model  @xcite .",
    "the initial segmentation is obtained by otsu thresholding .",
    "( a ) raw data with spectrin fluorescently labeled .",
    "images courtesy of dr .",
    "guillaume salbreux , max planck institute for the physics of complex systems , dresden .",
    "( b ) rc result with @xmath52 gradients and @xmath58 .",
    "( c ) rc result with @xmath52 gradients and @xmath59 ( d ) rc result with sobolev gradients and @xmath58.,title=\"fig : \" ] + d : sobolev , @xmath58    in any estimation problem , there is a fundamental tradeoff between completeness ( fitting the data as completely as possible ) and smoothness ( generalization ; not over - fitting the noise in the data ) .",
    "this is also true in image segmentation .",
    "the regularization parameter @xmath47 allows the user to tune this tradeoff .",
    "it is known that the increased robustness of sobolev gradients against the choice of @xmath47 comes from the fact that the optimization problem is pre - conditioned in a way that relaxes this tradeoff  @xcite .",
    "we illustrate next that the present particle approximation shares this property of relaxing the tradeoff between contour smoothness and not missing weak image features ( see fig .  [",
    "fig : spec ] ) . the raw data in fig .",
    "[ fig : spec]a shows a part of a cyst in a fruit fly with the cytoskeletal protein spectrin fluorescently labeled .",
    "the rc segmentation results using @xmath0-type gradients are shown in figs .",
    "[ fig : spec]b  c . for a small @xmath47 , the contour is non - smooth , as it delineates noise ( fig .",
    "[ fig : spec]b ; over - fitting ) . for even smaller @xmath47 the @xmath0 gradient flow does not converge due to insufficient regularization .",
    "this is hence the most - connected segmentation one can obtain on this image when using @xmath0 gradients .",
    "increasing the regularization constant @xmath47 makes the contour smoother , but causes filaments to break and to go missing , as shown in fig .",
    "[ fig : spec]c .",
    "we use a piecewise smooth image model here , which is able to handle intensity variations within a foreground region .",
    "the missing and broken filaments in the center of the image in fig .",
    "[ fig : spec]c are hence not a problem of photometry , but are caused by the @xmath0 gradient flow being trapped in a local minimum due to noise .",
    "this is the reason for the above - mentioned tradeoff between smoothness and completeness .",
    "it is known that this tradeoff is relaxed when using sobolev gradients , leading to smoother and more connected segmentations already for low regularization constants  @xcite , as confirmed in fig .",
    "[ fig : spec]d .",
    "albeit in the present case the segmentation remains unsatisfactory from a biological point of view , the present fast particle approximation seems to preserve the property of sobolev flows to relax the tradeoff between smoothness and completeness of a segmentation . for @xmath58 ,",
    "the per - iteration cpu time was 0.04s for @xmath0 gradients and 0.08s for sobolev gradients .",
    "the ratios for other @xmath47 s were similar .",
    "-type gradients ( b  c ) and sobolev gradients ( d ) .",
    "the rc algorithm is used with a piecewise smooth energy and a poisson noise model  @xcite .",
    "the initial segmentation is obtained by otsu thresholding .",
    "( a ) volume rendering of the 3d raw image with cell membranes fluorescently labeled .",
    "image courtesy of prof .",
    "christian dahmann , technical university of dresden .",
    "( b ) rc result with @xmath52 gradients and @xmath60 .",
    "( c ) rc result with @xmath52 gradients and @xmath61 .",
    "( d ) rc result with sobolev gradients and @xmath62 . when using @xmath0 gradients , the algorithm did not converge for @xmath62 due to insufficient regularization.,title=\"fig : \" ] + a : raw data , volume rendering    -type gradients ( b  c ) and sobolev gradients ( d ) .",
    "the rc algorithm is used with a piecewise smooth energy and a poisson noise model  @xcite .",
    "the initial segmentation is obtained by otsu thresholding .",
    "( a ) volume rendering of the 3d raw image with cell membranes fluorescently labeled .",
    "image courtesy of prof .",
    "christian dahmann , technical university of dresden .",
    "( b ) rc result with @xmath52 gradients and @xmath60 .",
    "( c ) rc result with @xmath52 gradients and @xmath61 .",
    "( d ) rc result with sobolev gradients and @xmath62 .",
    "when using @xmath0 gradients , the algorithm did not converge for @xmath62 due to insufficient regularization.,title=\"fig : \" ] + b : @xmath0 , @xmath60    -type gradients ( b  c ) and sobolev gradients ( d ) . the rc algorithm is used with a piecewise smooth energy and a poisson noise model  @xcite .",
    "the initial segmentation is obtained by otsu thresholding .",
    "( a ) volume rendering of the 3d raw image with cell membranes fluorescently labeled .",
    "image courtesy of prof .",
    "christian dahmann , technical university of dresden .",
    "( b ) rc result with @xmath52 gradients and @xmath60 .",
    "( c ) rc result with @xmath52 gradients and @xmath61 .",
    "( d ) rc result with sobolev gradients and @xmath62 .",
    "when using @xmath0 gradients , the algorithm did not converge for @xmath62 due to insufficient regularization.,title=\"fig : \" ] + c : @xmath0 , @xmath61    -type gradients ( b  c ) and sobolev gradients ( d ) . the rc algorithm is used with a piecewise smooth energy and a poisson noise model  @xcite .",
    "the initial segmentation is obtained by otsu thresholding .",
    "( a ) volume rendering of the 3d raw image with cell membranes fluorescently labeled .",
    "image courtesy of prof .",
    "christian dahmann , technical university of dresden .",
    "( b ) rc result with @xmath52 gradients and @xmath60 .",
    "( c ) rc result with @xmath52 gradients and @xmath61 .",
    "( d ) rc result with sobolev gradients and @xmath62 . when using @xmath0 gradients , the algorithm did not converge for @xmath62 due to insufficient regularization.,title=\"fig : \" ] + d : sobolev ,",
    "@xmath62    we next show that the present particle - based contour representation naturally extends to 3d images and allows segmentation using much less regularization than what would be required by an @xmath0 flow to generate comparable results .",
    "this is important in practice , because the regularizer is often chosen _ ad hoc _ with no biological meaning .",
    "one hence wishes to keep @xmath47 as small as possible in order to limit the regularization bias in the result , but still @xmath47 has to be chosen large enough so the solution does not over - fit the noise in the image . figure  [ fig : wing_noise3d ] shows a 3d example with a piecewise smooth image model . using sobolev gradients",
    "yields a smoother and less noisy segmentation with smaller @xmath47 , as shown in fig .",
    "[ fig : wing_noise3d]d . for the same value of @xmath62",
    ", the @xmath0 gradient descent does not converge due to insufficient regularization .",
    "the smallest regularization for which the @xmath0 flow produces a stable result is @xmath60 .",
    "this result is shown in fig .",
    "[ fig : wing_noise3d]b",
    ". it is completely irregular and dominated by noise . in order to achieve a result that is qualitatively comparable to that in fig .",
    "[ fig : wing_noise3d]d , the @xmath0 flow requires a 500-fold ( ! ) stronger regularization than the sobolev flow ( fig .",
    "[ fig : wing_noise3d]c ) .",
    "this massive regularization , however , introduces a visible bias in the final result .",
    "some of the loops and geometric features in the tissue are broken ( fig .",
    "[ fig : wing_noise3d]c ) . at @xmath60 , rc with sobolev gradients requires 359 iterations to converge , with @xmath0 gradients 896 iterations .",
    "the per - iteration cpu time was 8s when using @xmath0 gradients and 11s when using sobolev gradients .",
    "sobolev gradients hence segment this image about twice faster than @xmath0 gradients .",
    "pixels ( source : @xcite ) .",
    "( b ) initial segmentation using otsu thresholding . ( c )",
    "segmentation result using @xmath0 gradients .",
    "( d ) segmentation result using approximated sobolev gradients . in both cases @xmath55 , hence keeping the energy landscape the same.,title=\"fig : \" ] + a : raw data , scale bar : 20@xmath63 m    pixels ( source : @xcite ) .",
    "( b ) initial segmentation using otsu thresholding . ( c )",
    "segmentation result using @xmath0 gradients .",
    "( d ) segmentation result using approximated sobolev gradients . in both cases @xmath55 , hence keeping the energy landscape the same.,title=\"fig : \" ] + b : otsu thresholding    pixels ( source : @xcite ) .",
    "( b ) initial segmentation using otsu thresholding . ( c )",
    "segmentation result using @xmath0 gradients .",
    "( d ) segmentation result using approximated sobolev gradients . in both cases @xmath55 , hence keeping the energy landscape the same.,title=\"fig : \" ] + c : @xmath0 gradient result , @xmath55    pixels ( source : @xcite ) .",
    "( b ) initial segmentation using otsu thresholding . ( c )",
    "segmentation result using @xmath0 gradients .",
    "( d ) segmentation result using approximated sobolev gradients . in both cases @xmath55 , hence keeping the energy landscape the same.,title=\"fig : \" ] + d : sobolev gradient result , @xmath55    another known property of sobolev gradients is that they lead to final segmentations with less `` holes '' , as the flow can overcome small local minima that are induced by noise .",
    "figure [ fig : plant ] illustrates that the present particle approximation retains this property .",
    "the figure shows an image of fluorescently labeled plant tissue at low snr ( data : @xcite ) .",
    "even for the same @xmath55 , the sobolev flow leads to contours that are more connected and less broken ( fig .  [",
    "fig : plant]d ) than those obtained by the @xmath0 flow ( fig .",
    "[ fig : plant]c ) .",
    "since the same @xmath47 is used in both cases , this can only be because the sobolev flow converges to a different , less noisy local minimum .",
    "this present implementation hence retains this property .",
    "rc with @xmath0 and gradients needed 106 iterations ( 254s ) to converge , with sobolev gradients 200 iterations ( 549s ) .",
    "this is hence an example of where the sobolev flow converges slower , but finds a different , better local minimum .",
    "+ a     + d     + g     + b     + e     + h     + c     + f     + i    since sobolev flows require less additional regularization , they are also popular to process images that contain very little or no noise . in those cases , sobolev flows sometimes allows segmenting the image with no additional regularization at all .",
    "we present such an example in fig .",
    "[ fig : laser ] .",
    "it is not a microscopy example , because microscopy images always contain significant noise .",
    "instead , the image shows proton emission patterns that occur when a high - energy laser beam hits a block of metal ( data : bussmann group , helmholtz center dresden rossendorf ) .",
    "we initialize the rc algorithm with small bubbles around local intensity maxima .",
    "since intensities are varying within filament patterns , we use a piecewise smooth energy model  @xcite .",
    "the images are almost noise - free , and the present fast particle - sobolev flow allows segmenting them with @xmath64 , i.e. , without any additional regularization .",
    "this absence of regularization maximizes the detection ability for dark filaments , a property that is retained by the present particle approximation .",
    "however , the final result is sensitive to the initialization , and the topological prior that a region is a connected component is necessary in this case  @xcite .    in summary",
    ", the examples shown here confirm that the present approximation of sobolev gradients using local particle interactions qualitatively retains the known qualitative properties of sobolev flows and does not seem to have a detectable adverse effect on solution quality .",
    "however , the local character of the computations and the simple implementation as particle  particle interactions provide savings in both runtime and programmer effort .",
    "the use of sobolev gradients preconditions the energy - minimization problem .",
    "this leads to smoother results that are less sensitive to noise and to the value of the regularization constant @xmath47 .",
    "the sobolev gradient flow frequently converges to a different local minimum than the @xmath0-type gradient flow and requires less regularization .",
    "a bayesian model is determined by a likelihood @xmath65 and a prior @xmath66 , where in image segmentation @xmath67 is the image data and @xmath7 the segmentation contour .",
    "the vector @xmath68 contains photometric parameters such as region intensities .",
    "the posterior probability density function is obtained using bayes formula : @xmath69    the likelihood expresses how likely it is to observe the measured image @xmath67 given a certain segmentation @xmath7 and parameters @xmath68 .",
    "the likelihood therefore formalizes the image - formation model .",
    "the image - formation model describes the mapping between a ground - truth object state @xmath70 and an expected image @xmath71 conditional on that state . for many image - formation models ,",
    "@xmath68 is jointly determined by the model and by @xmath67 .",
    "for example , in many popular models the estimated intensity @xmath72 of a region @xmath73 is equal to the mean intensity of the area enclosed by that region s contour @xmath74 in @xmath67 .",
    "we therefore mostly omit @xmath68 in our notation .",
    "generating @xmath71 from @xmath7 is called the _ forward problem_. it amounts to simulating the expected ( i.e. , noise - free ) image under a given segmentation . in fluorescence microscopy ,",
    "the forward model is linear : @xmath75 and amounts to a convolution of the expected intensity distribution @xmath76 with the point - spread function ( impulse - response function ) @xmath77 of the microscope .",
    "the function @xmath78 is called the image - generating function .",
    "it assigns an expected intensity to each pixel according to the image - formation model .",
    "frequently used image - generating functions are the piecewise constant approximation , assigning a constant intensity @xmath79 to all pixels enclosed by contour @xmath80 , and the piecewise smooth approximation , assigning shaded intensities within regions .",
    "estimating the region intensities @xmath68 ( and their distribution inside regions ) from the image data is called the _",
    "photometric estimation problem_. finding the contours @xmath74 constitutes the _ geometric estimation problem_. estimating @xmath7 and @xmath68 from given @xmath67 , @xmath77 , and @xmath78 is an _ inverse problem _ that is addressed using bayesian inference .",
    "prior terms measure how likely a certain segmentation @xmath7 is , independent of the observed image .",
    "the most popular prior term penalizes the contour length @xmath29 , favoring short ( and hence smooth ) region boundaries  @xcite .",
    "other priors may include global shape characteristics and penalize deviations of the segmented shape from a template shape  @xcite .",
    "both the likelihood ( i.e. , the forward model ) and the bayesian prior can be used to include prior knowledge into the image - analysis algorithm .",
    "we hence define _ prior knowledge _ more general than just the _ bayesian prior_.      in bayesian ( i.e. , model - based ) image segmentation , the estimation problem of finding @xmath7 and @xmath68 given @xmath67 , @xmath77 , and @xmath78 is formulated as a maximum - a - posteriori ( map ) problem @xmath81 the problem is often restated as minimizing the anti - logarithm of the posterior , called the _ energy function _ @xmath82 .",
    "the use of a logarithm is motivated by the boltzmann distribution and changes the product of the likelihood and the prior to a sum of energy terms .",
    "the energies corresponding to the likelihood and the prior are called the _ external _ and _ internal _ energy , respectively . the resulting energy - minimization problem",
    "then reads : @xmath83 = \\min_{\\gamma,\\vec{\\theta}}\\left [ \\mathcal{e}_{\\textrm{external } } + \\lambda \\mathcal{e}_{\\textrm{internal } } \\right].\\ ] ] the denominator in bayes formula  ( [ eq : bayes_formula ] ) drops out as a constant shift .",
    "the scalar parameter @xmath47 is included in order to weight the prior with respect to the likelihood .",
    "the larger @xmath47 , the more weight is given to the prior and the less weight to the image data .",
    "this increases the regularization . choosing the optimal @xmath47 is an open problem . in practice",
    ", however , one usually wants to choose @xmath47 as small as possible to still get a robust segmentation and give as much weight to the image data @xmath67 as possible .",
    "a plethora of minimization algorithms for the total energy @xmath84 has been presented in the literature .",
    "the method of choice depends on the characteristics of @xmath17 .",
    "gradient - based local optimization of @xmath17 is a popular approach for non - convex @xmath17 . in a discrete space ,",
    "the energy gradient becomes an energy difference @xmath85 . in order to evolve the contour along the energy gradient flow",
    ", we ( only ) need to be able to evaluate energy differences , corresponding to posterior ratios @xmath86 for the original contour @xmath7 and the perturbed contour @xmath87 .",
    "the quantity of interest hence is the energy difference @xmath85 when deforming @xmath7 to @xmath87 .",
    "we assume that image noise is realized independently for each pixel . using bayes formula ( [ eq : bayes_formula ] )",
    "we then decompose @xmath85 as @xmath88 where the images @xmath71 and @xmath89 are computed using eq .",
    "( [ eq : image_formation ] ) . @xmath90 and @xmath91 are the regions ( sets of pixels ) enclosed by @xmath74 and @xmath92 , respectively .",
    "@xmath93 is the total number of regions .",
    "foreground regions are defined as closed sets , whereas the background region with index 0 is an open set ( see fig .",
    "[ fig : fg_simple ] ) .",
    "we have shown how sobolev gradients can be used to drive the evolution of a discrete particle - based deformable model . the particle nature of the present method allows for a simple and efficient approximation of sobolev gradients and dispenses with the need to implement additional global solvers .",
    "this does not only reduce the runtime of sobolev codes , but also reduces the programmer burden during software development .",
    "sobolev gradients are known to precondition the optimization problem in bayesian image segmentation and hence have a number of favorable properties : they are less sensitive to noise , they require less regularization , they favor the evolution of smooth contours , and they distinguish between local contour deformations and global contour motion  @xcite .",
    "sobolev gradients can be approximated from @xmath0-type gradients by convolution with a local kernel  @xcite . in particle methods ,",
    "discrete convolution amounts to particle  particle interactions  @xcite , which can efficiently be computed if the kernel is local .",
    "particle methods in image processing are hence naturally suited for more general gradient definitions , such as the sobolev gradients considered here .    the region competition ( rc ) algorithm is a local black - box ( i.e. , zeroth - order ) optimizer for particle - based deformable models  @xcite .",
    "since it only requires point - wise evaluations of energy differences , which are used as discrete gradient approximations , the gradient definition can easily be changed without affecting the rest of the algorithm .",
    "in fact , sobolev gradients can easily be plugged into any discrete optimization algorithm or convexification scheme by simply changing the way the gradient is approximated .",
    "this renders them an appealing extension to existing methods .",
    "we have benchmarked the rc algorithm with and without sobolev gradients on a number of artificial and real - world images , showing that the known qualitative properties of sobolev flows are preserved by the present approximation algorithm .",
    "we have also compared the results obtained with the present approximation algorithm with results from the literature that were computed using a fully accurate mesh - based solver .",
    "the results obtained with the present particle - based scheme do not visibly differ from those obtained with mesh - based level - sets , but the present particle scheme is between 2.8 and 17 times faster than the level - set solver .",
    "also in the present implementation , sobolev gradients remain computationally more costly to evaluate than @xmath0-type gradients . however , they precondition the problem such that less iterations are required for the optimizer to converge to the same solution , or such that better solutions ( different local minima , possibly requiring more iterations to be reached ) are found .",
    "this may amortize the increased cost per iteration .",
    "currently , our implementation is limited by mainly two approximations : first , we have approximated the intrinsic geodesic distance along the contour by the euclidean distance .",
    "this limits the accuracy of the present gradient approximation if the contour is significantly curved on small length scales ( ) .",
    "future work will consider using the true geodesic distance , exploiting concepts from differential geometry as applied to particle methods on curved riemannian manifolds  @xcite .",
    "second , we have fixed the length scale @xmath28 of the sobolev inner product to a user - defined value .",
    "this was required in order to keep particle ",
    "particle interactions local and hence computationally efficient .",
    "global all - against - all interactions would incur a nominal computational complexity in @xmath41 for @xmath43 contour particles , which is not practically feasible . in order to allow global ( rigid - body ) movements of the contour , it would , however , be desirable to consider all - against - all interactions in future work",
    ". the resulting @xmath43-body problem could be efficiently ( in @xmath42 ) approximated using fast multipole solvers  @xcite .",
    "the present implementation is available from http://mosaic.mpi-cbg.de as open - source as part of the rc filter in the itk image - processing toolkit  @xcite , implemented in c++ .",
    "we thank all members of the mosaic group for the many fruitful discussions .",
    "particular thanks go to dr .",
    "grgory paul for sharing his expertise in image segmentation and pointing us to the sobolev gradient literature .",
    "we thank prof .",
    "christian dahmann ( technical university of dresden ) , dr .",
    "guillaume salbreux ( max planck institute for the physics of complex systems , dresden ) , and dr .",
    "michael bussmann ( helmholtz center dresden rossendorf ) for providing test images .",
    "this work was supported by the swiss systemsx.ch initiative under grant wingx and the german federal ministry of research and education ( bmbf ) under funding code 031a099 .",
    "alexandre dufour , roman thibeaux , elisabeth labruyere , nancy guillen , and jean - christophe olivo - marin .",
    "active meshes : fast discrete deformable models for cell tracking in 3-d time - lapse microscopy . , 20(7):19251937 , 2011 .",
    "jo  a. helmuth and ivo  f. sbalzarini . deconvolving active contours for fluorescence microscopy images . in _ proc .",
    "symp .  visual computing ( isvc ) _ , volume 5875 of _ lecture notes in computer science _ , pages 544553 , las vegas , usa , november 2009 .",
    "springer .",
    "m.  jung , g.  chung , g.  sundaramoorthi , l.  vese , and a.  yuille .",
    "obolev gradients and joint variational image segmentation , denoising and deblurring . in _",
    "spie electronic imaging conference proceedings , computational imaging vii _ , volume 7246 .",
    "spie , 2009 .",
    "janick cardinale , alexander rauch , yves barral , gabor szkely , and ivo  f. sbalzarini .",
    "ayesian image analysis with on - line confidence estimates and its application to microtubule tracking . in _ proc .",
    "ieee intl .",
    "symposium biomedical imaging ( isbi ) _ , pages 10911094 ,",
    "boston , usa , june 2009 .",
    "m.  leventon , e.  grimson , and o.  faugeras .",
    "statistical shape influence in geodesic active contours . in _",
    "computer vision and pattern recognition ( cvpr ) , ieee conference on _ , volume  1 , pages 316323 .",
    "ieee , 2000 .",
    "g.  charpiat , r.  keriven , j .-",
    "pons , , and faugeras o. designing spatially coherent minimizing flows for variational problems based on active contours . in _ proc .",
    "ieee intl .",
    "conf .  computer vision ( iccv ) _ , volume  2 , pages 14031408 .",
    "ieee , 2005 .",
    "ganesh sundaramoorthi , anthony yezzi , and andrea mennucci .",
    "obolev active contours . in _",
    "variational , geometric , and level set methods in computer vision _",
    ", number 3752 in lecture notes in computer science , pages 109120 , heidelberg , germany , 2005 .",
    "springer .",
    "chenyang xu  jr . , a.  yezzi , and j.  l. prince .",
    "on the relationship between parametric and geometric active contours . in _ proc .",
    "34th ieee asilomar conf .",
    "signals , systems , and computers _ , volume  1 , pages 483489 .",
    "ieee , 2000 ."
  ],
  "abstract_text": [
    "<S> bio - image analysis is challenging due to inhomogeneous intensity distributions and high levels of noise in the images . </S>",
    "<S> bayesian inference provides a principled way for regularizing the problem using prior knowledge . </S>",
    "<S> a fundamental choice is how one measures `` distances '' between shapes in an image . </S>",
    "<S> it has been shown that the straightforward geometric @xmath0 distance is degenerate and leads to pathological situations . </S>",
    "<S> this is avoided when using sobolev gradients , rendering the segmentation problem less ill - posed . </S>",
    "<S> the high computational cost and implementation overhead of sobolev gradients , however , have hampered practical applications .    </S>",
    "<S> we show how particle methods as applied to image segmentation allow for a simple and computationally efficient implementation of sobolev gradients . </S>",
    "<S> we show that the evaluation of sobolev gradients amounts to particle  particle interactions along the contour in an image . </S>",
    "<S> we extend an existing particle - based segmentation algorithm to using sobolev gradients . using synthetic and real - world images , we benchmark the results for both 2d and 3d images using piecewise smooth and piecewise constant region models .    </S>",
    "<S> the present particle approximation of sobolev gradients is 2.8 to 10 times faster than the previous reference implementation , but retains the known favorable properties of sobolev gradients . </S>",
    "<S> this speedup is achieved by using local particle  particle interactions instead of solving a global poisson equation at each iteration . </S>",
    "<S> the computational time per iteration is higher for sobolev gradients than for @xmath0 gradients . </S>",
    "<S> since sobolev gradients precondition the optimization problem , however , a smaller number of overall iterations may be necessary for the algorithm to converge , which can in some cases amortize the higher per - iteration cost .    </S>",
    "<S> [ 1995/12/01 ] </S>"
  ]
}