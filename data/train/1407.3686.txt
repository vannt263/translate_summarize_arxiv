{
  "article_text": [
    "localizing humans in images is key for applications such as video surveillance , avoiding pedestrian - to - vehicle collisions , collecting statistics of players or athletes in sport videos , etc . developing a reliable vision - based pedestrian detector is a very challenging task with more than a decade of history by now . as a result",
    ", a plethora of features , models , and learning algorithms , have been proposed to develop the pedestrian classifiers which are at the core of pedestrian detectors @xcite .",
    "the research for boosting the accuracy of pedestrian classifiers has followed different lines .",
    "some authors have researched image descriptors well - suited for pedestrians ( , hog @xcite , hog+lbp @xcite , hog+css+hof @xcite , opphog @xcite , haar+eoh @xcite , integral channels @xcite , macrofeatures @xcite ) , others have researched different image modalities ( , appearance + motion @xcite , appearance+depth+motion @xcite ) , others have focused on the pedestrian model ( , deformable multi - component part - based models @xcite , multi - resolution @xcite ) , others on the classification architecture ( , hog - svm / lrf - mlp cascades @xcite , haar + eoh - adaboost cascades with meta - stages @xcite , random forest of hog+lbp - svms @xcite ) , and others in the process of collecting good samples for training ( , generative approach @xcite , active learning @xcite , virtual - world data with domain adaptation @xcite ) .",
    "the outcome of each of the above mentioned proposals is a pedestrian classifier , termed here as _ base classifier _ , which determines if a given image window contains a pedestrian or background . in practice ,",
    "such classifiers provide a relatively high response at neighbor windows overlapping a pedestrian , while the responses around potential false positives are expected to be lower .",
    "note that , in fact , non - maximum suppression ( nms ) is usually performed as last detection stage in order to reduce multiple detections arising from the same pedestrian to a single one .",
    "an analogous reasoning applies for image sequences .",
    "if there is a pedestrian located within a frame , the same pedestrian is expected to appear close to the same location in neighbor frames .",
    "therefore , such a location has chances of receiving high classification scores during several frames , while false positives are expected to be more spurious .",
    "in fact , this may allow removing such undesired spurious by the use of a tracker .    in this paper",
    "we propose to exploit such expected _ response correlations _ for improving the accuracy of the classification stage itself .",
    "in other words , instead of only exploiting spatiotemporal coherence by means of general post - classification stages like nms and tracking , we propose to add such a type of reasoning in the classification stage itself as well .",
    "in particular , we propose to use a two - stage classification strategy which not only rely on the image descriptors required by the base classifiers , but also on the response of the own base classifiers in a given spatiotemporal neighborhood . more specifically , we train pedestrian classifiers using a stacked sequential learning ( ssl ) paradigm @xcite .",
    "temporal ssl involves the analysis of window volumes .",
    "the different types of temporal volumes can be potentially useful for different applications depending on the motion of the camera and the targets of interest , as well as the working frame rate and the targets size . in this paper , we are specially interested in on - board pedestrian detection within urban scenarios .",
    "therefore , camera and targets are in movement .",
    "accordingly , in this paper we test our ssl approach for a fixed neighborhood ( , fixed spatial window coordinates across frames ) and for an scheme relying on an ego - motion compensation approximation ( , varying spatial window coordinates across frames ) .",
    "moreover , in order to assess the dependency of the results with respect to the frame rate , we acquired our own pedestrian dataset at 30fps by normal driving in an urban scenario .",
    "this new dataset is used as main guide for our experiments , but we also complement our study with other challenging dataset publicly available : caltech .    in this paper",
    "we start by using a competitive baseline in pedestrian detection @xcite , namely a holistic base classifier based on hog+lbp features and linear svm .",
    "note that hog / linear - svm is the core of more sophisticated pedestrian detectors as the popular deformable part - based model ( dpm ) @xcite .",
    "moreover , hog with lbp are also used as base descriptors of multi - modal multi - view pedestrian models @xcite , and hog+lbp / linear - svm has been used for classifiers with occlusion handling @xcite , as well as for acting as node experts in random forest ensembles @xcite .",
    "in addition , it has recently been shown that hog+lbp / linear - svm approaches are well suited for domain adaptation @xcite .",
    "altogether , we think that hog+lbp / linear - svm is a proper baseline to start assessing our proposal .",
    "moreover we have extended this baseline with the hof @xcite motion descriptor that complements the appearance and texture features of the baseline .",
    "overall , the obtained results show that our spatiotemporal ssl proposal boosts detection accuracy significantly .",
    "especially , when the pedestrians are close to the camera , in the most critical situations . therefore , encouraging to augment the study for other pedestrian base classifiers as well as other object categories .",
    "the rest of the paper is organized as follows . in sect .",
    "[ sec : rw ] we review some works related to our proposal . section [ sec : ssl ] briefly introduces the ssl paradigm . in sect .",
    "[ sec : sslpd ] we develop our proposal .",
    "section [ sec : er ] presents the experiments carried out to assess our spatiotemporal ssl , and discuss the obtained results .",
    "finally , sect .",
    "[ sec : conclusion ] draws our main conclusions .",
    "the use of motion patterns as image descriptors was already proposed as an extension of spatial haar - like filters for video surveillance applications ( static zenital camera ) @xcite and for detecting human visual events @xcite . in these cases ,",
    "original spatial haar - like filters were extended with a temporal dimension .",
    "popular hog descriptor was also extended to encode temporal information for detecting humans @xcite , in this case using optical flow to compensate motion . in the same spirit",
    "the histograms of flow ( hof ) were also introduced for detecting pedestrians @xcite . in all cases motion information",
    "was complemented with appearance information ( , haar / hog for luminance and/or color channels ) .",
    "in contrast with these approaches , our proposal does not involve to compute new temporal image descriptors as new features for the classification process .",
    "as we will see , we use the responses of a given base classifier in neighbor frames as new features for our ssl classifier .",
    "in fact , our proposal can also be applied to base classifiers that already incorporate motion features .",
    "therefore , the reviewed literature and our proposal are complementary strategies .    focusing on single frames",
    ", it has been recently shown how pedestrian detection accuracy can be boosted by analyzing the image area surrounding potential pedestrian detections .",
    "in particular , @xcite follow an iterative process that uses contextual features of several orders ( , involving co - occurences ) for progressively enhancing the response of base classifiers for true pedestrians and lowering it for hallucinatory ones .",
    "our ssl proposal does not require new image descriptors of pedestrian surroundings and is not iterative , which makes it inherently faster .",
    "moreover , we treat equally spatial and temporal response correlations , , under the ssl paradigm , giving rise to a more straightforward method .",
    "finally , we would like to clarify that our ssl proposal is not a substitute for nms and tracking post - classification stages .",
    "what we expect is to allow these stages to produce more accurate results by increasing the accuracy of the classification stage .",
    "for instance , tracking must be used for predicting pedestrian intentions @xcite , thus , if less false positives reach the tracker , we can reasonably expect to obtain more reliable pedestrian trajectories and so guessing intentions in the very short time this information is required ( , around a quarter of second before a potential collision ) .",
    "stacked sequential learning ( ssl ) was introduced by cohen @xcite with the aim of improving base classifiers when the data to be processed has some sort of sequential order . in particular , given a data sample to be classified , the core intuition is to consider not only the features describing the sample but also the response of the base classifier in its neighbor samples .",
    "figure [ fig : ssl ] summarizes the ssl learning process that we explain in more detail in the rest of this section .",
    "let @xmath0 be an ordered training sequence of cardinality @xmath1 .",
    "the ssl approach involves to select a sub - sequence for training a base classifier , @xmath2 , and the rest to apply @xmath2 and so training the ssl classifier , @xmath3 .",
    "if this is done once , then the final classifier @xmath3 would be trained with less than @xmath1 samples .",
    "thus , to avoid this , it is followed a cross - validation style were @xmath0 is divided in @xmath4 disjoint sub - sequences , @xmath5 , and @xmath6 rounds are performed by using a different subset each round to test the @xmath7 and the rest of subsets for training this @xmath7 . at the end of the process , joining the @xmath6 sub - sequences processed by the corresponding @xmath7 , we can have @xmath1 _ augmented _ training samples for learning @xmath3 .",
    "@xmath8 means to train the @xmath9 and @xmath10 on the same training set , without actually doing partitions .",
    "let us explain what means _ augmented _ training samples .",
    "the elements of @xmath0 , , the initial training samples , are of the form @xmath11 , where @xmath12 is a vector of features with associated label @xmath13 .",
    "therefore , the elements of each sub - sequence @xmath14 are of the same form .",
    "as we have mentioned before , during each round @xmath15 of the cross - validation - style process , a sub - sequence @xmath16 is selected among @xmath17 , while the rest are appended together to form a sub - sequence @xmath18 . from @xmath18",
    "it is learned @xmath7 and applied to @xmath16 to obtain a new @xmath19 .",
    "the elements of @xmath19 are of the form @xmath20 , where we have augmented the feature @xmath12 with the classifier score @xmath21 .",
    "therefore , after the @xmath6 rounds , we have a training set of @xmath1 samples of the form @xmath20 .",
    "it is at this point when we can introduce the concept of neighbor scores into the learning process . in particular ,",
    "the final training samples are of the form @xmath22 , where @xmath23 denotes a neighborhood of size @xmath24 anchored to the sample @xmath25 .",
    "for instance , @xmath26 is a _",
    "past _ neighborhood , @xmath27 is a _ future _ neighborhood , and @xmath28 is a _ centered _ neighborhood , which are analogous concepts to the ones of filtering , extrapolation and smoothing , resp . , used in the classical tracking nomenclature .",
    "in this section , without loosing generality , we will assume the use of the _ past neighborhood _",
    "[ sec : ssl ] ) to illustrate and explain our ssl approach . from the viewpoint of the processing of image sequences",
    ", this means to use previous images to do detection in the current one ( , in the last one acquired when processing directly from a camera ) .",
    "actually there is no need to save the previous images .",
    "the detection scores of the neighbouring windows , that were already computed , are enough to compute the current ssl descriptor making the computation of ssl very computational efficient .      for object detection in general and for pedestrian detection in particular , applying ssl starts by defining which are the neighbors of a given window under analysis . in learning time",
    ", such a window will correspond either to the bounding box of a labeled pedestrian or to a rectangular chunk of the background . in operation time",
    "( , testing ) , such a window will correspond to a candidate generated by a pyramidal sliding window scheme or any other candidate selection method . in this paper",
    "we assume the processing of image sequences and , consequently , we propose the use of a spatiotemporal neighborhood .",
    "temporal ssl involves the analysis of window volumes .",
    "therefore , there are several possibilities to consider ( see fig .",
    "[ fig : neighborhoods ] ) .",
    "let us term as @xmath29 the set of coordinates defining an image window in frame @xmath30 , and @xmath31 the window volume defined by a temporal neighbor of @xmath32 frames .",
    "the simplest volume is obtained by assuming fixed locations across frames , which we term as _ projection _ approach .",
    "in other words , @xmath33 . another possibility",
    "consists in building volumes taking into account motion information .",
    "for instance , @xmath34 , where @xmath35 is a 2d translation defined by considering the _ optical flow _ contained in @xmath36 , and @xmath37 stands for summation to all coordinates defining @xmath36 .",
    "spatial ssl involves the analysis of windows spatially overlapping the window of interest ( see fig . [",
    "fig : neighborhoods ] ) .",
    "for instance , we can fix a 2d displacement @xmath38 and @xmath39 displacements in the @xmath40 axis , to the left and to the right , an analogously for the @xmath41 axis given a @xmath42 number of up and down displacements .",
    "our proposal combines both ideas , , the temporal volumes and the spatial overlapping windows , in order to define the spatiotemporal neighborhood required by ssl ( sect .",
    "[ sec : ssl ] ) .      as usual , we assume an image sequence with labeled pedestrians ( , using bounding boxes ) for training .",
    "negative samples for training are obtained by random sampling of the same images , of course , these samples can not highly overlap labeled pedestrians .",
    "the cross - validation - style rounds of ssl ( sect .",
    "[ sec : ssl ] ) are performer with respect to the images of the sequence , not with respected to the set of labeled pedestrians and negative samples as it may suggest the straightforward application of ssl ( note that pedestrian / negative labels are for individual windows not for full images ) . moreover , as we have seen in sect .",
    "[ ssec : spatiotemporal ] , the neighborhood relationship is not only temporal but spatial too .",
    "the training process is divided in two stages .",
    "first , we train the auxiliary classifiers ( @xmath7 ) as usual using three bootstraping rounds .",
    "then we train the ssl classifier ( using final @xmath7 as auxiliary ) , again we run three bootstrapping rounds for obtaining the final classifier ( @xmath3 ) .    using the full training dataset",
    ", we also assume the training of a base classifier @xmath43 .",
    "another possibility is to understand the different @xmath7 as the result of a bagging procedure and ensemble them to obtain @xmath43 . without loosing generality , in this paper",
    "we have focused on the former approach .          the proposed pedestrian detection pipeline is shown in fig .",
    "[ fig : ssldetection ] .",
    "as we can see there are two main stages .",
    "the first stage basically consists in a classical pedestrian detection method relying on the learned base classifier @xmath43 . in fig . [",
    "fig : ssldetection ] we have illustrated the idea for a pyramidal sliding window approach , but using other candidate selection approaches is also possible .",
    "detections at this stage are just considered as potential ones .",
    "then , the second stage applies the spatiotemporal ssl classifier , @xmath3 , to such potential detections in order to reject or keep them as final detections .",
    "there are some details worth to mention .",
    "first , the usual non - maximum suppression ( nms ) step included in pedestrian detectors is not performed for the output of the first stage , but it is done for the output of the second stage .",
    "second , for ensuring that true pedestrians reach the second stage , we apply a threshold on @xmath43 such that it guarantees a very high detection rate even having a very high rate of false positives . in our experiments",
    "this usually implies that while the @xmath43 processes hundred of thousands windows ( for pyramidal sliding window ) , @xmath3 only process a few thousands .",
    "third , although in fig .",
    "[ fig : ssldetection ] we show pyramids of images for a temporal neighborhood of t frames , what we actually keep from frame to frame are the already computed features , so that we compute them only once . however , this depends on the type of temporal neighborhood we use ( sect .",
    "[ ssec : spatiotemporal ] ) .",
    "for instance , using projection style no feature are needed to keep ( , keeping the classification scores is enough ) .",
    "however , if we use optical flow we may need to compute features in previous frames if the window under consideration does not map to a location where they were already computed .",
    "[ [ protocol . ] ] * protocol . * + + + + + + + + + + +    as evaluation methodology we follow the de - facto caltech standard for pedestrian detection @xcite , we plot curves of false positives per image ( fppi ) miss rate . the miss rate average in the range of @xmath44 to @xmath45 fppi is taken as indicative of each detector accuracy , .",
    "the lower the better .",
    "moreover , during testing we consider three different subset based on the pedestrian height .",
    "_ near _ subset include pedestrians with height equal or higher than 75 pixels , _ medium _ subset include pedestrian between 50 and 75 pixel height .",
    "finally we group the two previous subset in the _ reasonable _ subset ( height @xmath46 50 pixels ) .    [",
    "cols=\">,^,<,^,^,^\",options=\"header \" , ]     [ ssl : table : results ]    [ [ our - own - dataset - ourds . ] ] * our own dataset ( ourds ) . *",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + +    since the temporal axis is important for the ssl classifier , we acquired our own dataset to be sure we have stable 30 fps sequences .",
    "the sequences were acquired on - board under normal urban driving conditions .",
    "the images are monochrome and of @xmath47 pixels .",
    "we used a 4 mm focal length lens , so providing a wide field of view .",
    "we drove during 30 minutes approximately , giving rise to a sequence of around 60,000 frames .",
    "then , using steps of 10 frames we annotated all the pedestrians .",
    "this turns out in 7,900 annotated pedestrians , 5,400 reasonable and non occluded .",
    "we have divided the video sequence into three sequential parts , the first one for training , the last one for testing , in the middle we have leaved a gap for avoiding testing and training with the same persons .",
    "overall we train with 3,600 reasonable pedestrians , and test on 1,300 reasonable ones .    [",
    "[ caltech - dataset . ] ] * caltech dataset .",
    "* + + + + + + + + + + + + + + + + + +    we have also used other popular dataset acquired on - board .",
    "the caltech dataset @xcite , which contain 3,700 reasonable pedestrians for training .",
    "[ [ base - detectors . ] ] * base detectors .",
    "* + + + + + + + + + + + + + + + + +    for the experiments presented in this section we use our own implementation of hog and lbp features , which provides significant better results than the one proposed in @xcite , , removing the occlusion handling reasoning .",
    "moreover , using tv - l1 @xcite for computing optical flow , we obtain hof features @xcite as well .",
    "these features complement hog and lbp by motion information .",
    "we call base to the hog+lbp / linear - svm and base+hof to the hog+lbp+hof / linear - svm .    [",
    "[ ssl . ] ] * ssl .",
    "* + + + + + +    the experiments are based on the spatiotemporal ssl ( with past temporal window style ) and settings @xmath48 . in preliminary experiments we tested several values of @xmath6 ( fig .",
    "1 ) , ranging from @xmath49 to @xmath50 .",
    "the obtained results were very similar , thus we decided to set @xmath50 ( i.e. , omitting the partition of the training sequence ) since then the training is faster .",
    "[ [ experiments . ] ] * experiments .",
    "* + + + + + + + + + + + + + +    in table [ ssl : table : results ] we show the results for the ssl experiments . as baseline detectors we use the base and base+hof .",
    "the experiments are run over the different datasets , and different frame rates for the oursds case .",
    "we tested them for different ranges of pedestrian sizes .",
    "we observe significant accuracy improvements for all the tested datasets comparing the baseline detector and its ssl counterpart .",
    "for instance , in ourds near with ssl(base+hof ) we obtain an accuracy improvement of ten points approximately .",
    "also , significant accuracy improvements are obtained for all the tested frame rates ( 30 fps , 10 fps , 3 fps ) of ourds dataset .",
    "besides , we observe an improvement due to the optical flow in the volume generation at high frame rates",
    ". however , no significant difference is observed at low frame rates .",
    "the ssl accuracy improvement is more clear for the near pedestrians . in fig .",
    "[ fig : plotsresults ] we plot the accuracy curves obtained for some representative experiments .",
    "[ [ discussion . ] ] * discussion . *",
    "+ + + + + + + + + + + + +    ssl approach outperforms its baseline in almost all the tested configurations .",
    "however , the improvement is more clear for near pedestrians at high frame rates .",
    "if we generate the _ past neighborhood _ over the far away pedestrians , we should expect a _",
    "past neighborhood _ with pedestrians smaller than the minimum pedestrian size that the base detector can detect .",
    "that is why the ssl improvement is not so clear for the medium subset .",
    "however , in near pedestrians _ past neighborhood _ is more probable to find a history of confident responses .",
    "this is a very relevant improvement since for close pedestrians the detection system has less time to take decisions like braking or doing any other manoeuvre .",
    "regarding the neighborhood generation approaches , the optical flow slightly improves the projection one as it captures the movement of the pedestrians in the temporal neighborhood .",
    "in this paper we have presented a new method for improving pedestrian detection based on spatiotemporal ssl .",
    "we have shown how even simple projection windows can boost the detection accuracy in different datasets acquired on - board .",
    "we have shown that our approach is effective for different frame rates . in this paper",
    "we have focused on hog+lbp / linear - svm and hog+lbp+hof / linear - svm pedestrian base classifiers , thus , our immediate future work will focus on testing the same approach for other base classifiers of the pedestrian detection state - of - the - art . regarding the improvement obtained using optical flow neighborhood ,",
    "we want to further explore different approaches for dealing with the neighborhood generation for moving pedestrians .",
    "this work is supported by the spanish micinn projects tra2011 - 29454-c03 - 01 and tin2011 - 29494-c03 - 02 and sebastian ramos fpi grant bes-2012 - 058280 ."
  ],
  "abstract_text": [
    "<S> pedestrian classifiers decide which image windows contain a pedestrian . in practice , </S>",
    "<S> such classifiers provide a relatively high response at neighbor windows overlapping a pedestrian , while the responses around potential false positives are expected to be lower . </S>",
    "<S> an analogous reasoning applies for image sequences . </S>",
    "<S> if there is a pedestrian located within a frame , the same pedestrian is expected to appear close to the same location in neighbor frames . </S>",
    "<S> therefore , such a location has chances of receiving high classification scores during several frames , while false positives are expected to be more spurious . in this paper </S>",
    "<S> we propose to exploit such correlations for improving the accuracy of base pedestrian classifiers . </S>",
    "<S> in particular , we propose to use two - stage classifiers which not only rely on the image descriptors required by the base classifiers but also on the response of such base classifiers in a given spatiotemporal neighborhood . </S>",
    "<S> more specifically , we train pedestrian classifiers using a stacked sequential learning ( ssl ) paradigm . </S>",
    "<S> we use a new pedestrian dataset we have acquired from a car to evaluate our proposal at different frame rates . </S>",
    "<S> we also test on a well known dataset : caltech . </S>",
    "<S> the obtained results show that our ssl proposal boosts detection accuracy significantly with a minimal impact on the computational cost . </S>",
    "<S> interestingly , ssl improves more the accuracy at the most dangerous situations , when a pedestrian is close to the camera . </S>"
  ]
}