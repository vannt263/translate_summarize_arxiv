{
  "article_text": [
    "the desire to directly image extrasolar terrestrial planets has motivated much research into space - based missions .",
    "one approach proposed for direct imaging in visible to near - infrared light is a coronagraph , which use internal masks and stops to change the point spread function of the telescope , creating regions in the image of high contrast where a dim planet can be seen .",
    "coronagraphs possess an extreme sensitivity to wavefront aberrations generated by the errors in the system optics ( occulters are immune to this problem because the starlight never enters the telescope ) .",
    "this necessitates wavefront control algorithms to correct for the aberrations and relax manufacturing tolerances and stability requirements within the observatory . in this paper",
    "we discuss the challenges associated with wavefront estimation and control in a coronagraphic imager .",
    "advances in these correction algorithms have primarily been focused on development of the controller , by choosing some criterion that decides how best to suppress aberrations given an estimate of the electric field at that point in time .",
    "these estimators do not utilize prior knowledge of the electric field estimate , and as such require a large number of images to reconstruct the estimate . by utilizing prior estimates and the control history",
    "we develop a method that requires fewer images to update the estimate , thus improving the efficiency of the correction algorithm .",
    "the high contrast imaging laboratory ( hcil ) at princeton tests coronagraphs and wavefront control algorithms for quasi - static speckle suppression .",
    "the collimating optic is a six inch off - axis parabola ( oap ) followed by two deformable mirrors ( dms ) in series and a shaped pupil coronagraph , which is imaged with a second six inch oap ( figure [ optical ] ) .",
    "we use a shaped pupil coronagraph , shown in figure [ sp ] , and described in detail in belikov et al.@xcite .",
    "this coronagraph produces a discovery space with a theoretical contrast of @xmath0 in two @xmath1 regions as shown in figure [ ideal_psf ] . at the princeton hcil , the aberrations in the system result in an uncorrected average contrast of just under @xmath2 in the area immediately surrounding the core of the point spread function ( psf ) , which agrees with the simulations shown in figure [ ab_psf ] .",
    "since the coronagraph is a binary mask , its contrast performance is fundamentally achromatic , subject only to the physical scaling of the psf with wavelength .",
    "using a taylor series expansion of the aberrated electric field it was shown in pueyo et al .",
    "@xcite that , to first order , two dms in series are capable of correcting both amplitude and phase aberrations , resulting in symmetric dark holes in the image plane .",
    "physically , such a controller relies on the amplitude - to - phase mixing resulting from propagation of the field between non - conjugate planes ( the first dm to the second ) .",
    "if the magnitude of the first dm s actuation is chosen correctly , then it can exactly conjugate the amplitude variations at the pupil plane at which point the second dm , assumed to be at a conjugate pupil , can correct the residual phase aberrations .",
    "algorithmically this is achieved through a number of methods , each with its set of advantages and disadvantages . in general ,",
    "focal plane wavefront correction methods are broken down into a wavefront estimation step followed by a control step where the correction is decided . in this paper",
    "we use the stroke minimization algorithm as the controller to test the estimator .",
    "it corrects the wavefront by minimizing the actuator stroke on the dms subject to a target contrast value@xcite . expressing the dm actuator amplitudes as a vector , @xmath3 , the optimization problem can be written as @xmath4 where @xmath5 is the commanded height of actuator @xmath6",
    ", @xmath7 is the residual intensity in the dark hole after correction , and @xmath8 is the target contrast .",
    "we solve the optimization by approximating @xmath7 as a quadratic form ,    @xmath9    where @xmath10 is a vector describing the interaction between the dm shape and the aberrated field , @xmath11 is a vector that expresses contrast in the dark hole , and @xmath12 is the matrix which describes the linearized mapping of dm actuation to intensity in the dark hole .",
    "the resulting quadratic subprogram is easily solved by augmenting the cost function via lagrange multiplier , @xmath13 , and solving for the commanded actuator heights : @xmath14    we find the optimal actuator commands via a line search on @xmath13 to minimize the augmented cost function ( eq .  ( [ eq : monocost ] ) ) .",
    "since this is a quadratic subprogram of the full nonlinear problem we can iterate to reach any target contrast @xcite .",
    "in addition to regularizing the problem of minimizing the contrast in the search area , minimizing the stroke has the added advantage of keeping the actuation small and thus within the linear approximation . if the dm model and its transformation to the electric field ( embedded in the @xmath12 matrix ) were perfectly known , the achievable monochromatic contrast using stroke minimization would be limited only by estimation error as long as the dm actuation remains within the bounds of the linearization . our ability to estimate the field",
    "is driven largely by the residual model error associated with the dm .",
    "to date , almost all high - contrast wavefront control approaches use dm - diversity@xcite to estimate the wavefront . we thus use it as a baseline to compare with the kalman filter estimation scheme .",
    "it has given the best results to date using the stroke minimization control algorithm at the princeton hcil in both monochromatic and broadband suppression @xcite .",
    "the linearized interaction of the dm actuation and the aberrated electric field can be written in matrix form by taking difference images using @xmath15 pre - determined shapes with amplitudes prescribed by the normalized intensity of the aberrated field @xcite .",
    "the image @xmath16 is taken with one deformable mirror shape , @xmath17 , while @xmath18 is the image taken with the negative of that shape , @xmath19 , applied to the deformable mirror . the difference of each conjugate pair is then used to construct a vector of noisy measurements , @xmath20,\\ ] ] for each pixel . by making the measurement the difference of two images",
    "we can remove incoherent light , such as detector noise and planet light , leaving only the coherent component of the field . additionally ,",
    "since the images were taken with conjugate deformable mirror shapes , only the contribution of the product of the dm field and the aberrated field to the intensity measurement exists in @xmath21 . defining @xmath22 as the image plane electric field state",
    ", we write @xmath21 as a linear equation in @xmath22 and include additive noise , @xmath23 , @xmath24 where @xmath25 is the observation matrix that relates the observed quantity to the state we seek to estimate . by writing @xmath22 as the real and imaginary parts of the electric field at a specific pixel , @xmath26,\\ ] ] we can construct the observation matrix , @xmath25 , so that it contains the real and imaginary parts of the @xmath27 dm perturbation , @xmath28 , in each row . taking multiple measurments , the observation matrix is given by @xmath29.\\ ] ] the product @xmath30 will then match the intensity distribution in the measurement @xmath21 . with at least three measurements , @xmath31 , we can take a left pseudo - inverse to solve for the estimate of the real and imaginary parts of the aberrated field at each pixel in the image plane with least - squares minimal error : @xmath32    while the problem is still invertible using two image pairs to construct @xmath21 and @xmath25 , a minimum of 3 image pairs must be used to create an overdetermined system that will produce a unique estimate with least - squares minimal error from the available data . practically , we find that 4 image pairs must be used to get a good enough estimate at the princeton hcil .",
    "consequently , 8 images are taken per iteration to estimate the electric field when using the dm diversity algorithm .",
    "the laboratory starts at an initial contrast of @xmath33 ( fig .",
    "[ mono_initial ] ) . using the least - squares estimation technique it is capable of reaching an average contrast of @xmath34 in a ( 7 - 10)x(-2 - 2 ) @xmath35 region within 30 iterations ( fig .",
    "[ mono_corrected ] ) on both sides of the image plane , a unique capability that is a result of the two deformable mirrors in the system . in 20 iterations of the algorithm , requiring a total of 160 estimation exposures , the system reached a contrast level of @xmath36 .",
    "the dm - diversity algorithm @xcite is quite effective , but it is limited by the fact that it is only a batch process method . as shown in fig .",
    "[ fig : feedback ] , it does not close the loop on the state estimate .",
    "therefore all state estimate information , @xmath37 , acquired about the electric field in the prior control step is lost .",
    "thus each iteration operates as if it was the first , requiring that we take a full set of estimation images to estimate the field again .",
    "in addition to being very costly with regard to exposures , the measurements will become progressively noisier as higher contrast levels are reached . if we include feedback of the state estimate we will have a certain degree of robustness to new , noisy measurements by including information from prior measurements with better signal - to - noise .",
    "since we already have demonstrated a model based controller , we should be able to use this model to predict the change in the electric field after the controller has applied a dm command .",
    "in doing so we do want to consider the relative effect of process and detector noise to optimally combine an extrapolation of the state estimate with new measurement updates .",
    "this is exactly the problem a discrete time kalman filter solves .    with the kalman filter",
    "we seek to optimally include new measurements to improve the state and covariance estimates .",
    "these noisy measurements , @xmath38 , will still be difference images of probe pairs .",
    "the conjugate pairs allow us to construct a linear observation matrix , @xmath39 .",
    "if we were not in a low aberration regime our observer would have to be nonlinear .",
    "this is not impossible for a kalman filter , but can make it highly biased @xcite and computationally expensive . as we decide how to optimally update the field , we must also have an estimate of our measurement noise covariance , which we define as @xmath40.\\ ] ]    like the dm diversity estimator @xcite , the kalman filter produces an estimate with least - squares minimal error . since the kalman filter operates on the estimate in closed loop , the weighted cost function used to derive the solution for the dm diversity estimator , @xmath41^t r_k^{-1 }   [ h_k\\hat x_k - z_k],\\label{eq : batchcost}\\ ] ] will not adequately represent the error contributions in the system",
    ". we must also include an estimate of the state covariance , @xmath42 , since this will also propagate error in the estimate update . defining the error as both the difference between the noisy observation and the estimated observation , @xmath43 , and the difference between our current estimate and the estimate extrapolation , @xmath44",
    ", we write the quadratic cost function as @xmath45^t p_k(-)^{-1 } [ \\hat x_k - \\hat x_k(-)\\right ] + \\frac{1}{2 } \\left[h_k\\hat x_k - z_k\\right]^t r_k^{-1 }   \\left[h_k\\hat x_k - z_k\\right].\\ ] ] we can formulate the cost in matrix form as @xmath46 where we have now defined a new set of augmented matrices as @xmath47 evaluating the partial derivative of eq .  [",
    "eq : kalmanquad ] the state estimate update is given by @xmath48^{-1 } \\left[z_k - h_k \\hat x_k(- ) \\right ] .",
    "\\label{eq : deriveupdate}\\ ] ] from eq .",
    "[ eq : deriveupdate ] , we define the optimal gain to be @xmath49^{-1}.\\label{eq : gainderive}\\ ] ]    eq .",
    "[ eq : gainderive ] optimally combines the prior estimate history with measurement updates to minimize the total error contributions based on the expected state and measurement covariance . much like the batch process method the kalman filter produces a solution that minimizes a quadratic cost function , eq .",
    "[ eq : batchcost ] , but it is also subject to the constraining dynamic equations given by @xmath50 and @xmath42 .",
    "however , looking at eq .",
    "[ eq : kalmanquad ] there is a major advantage of the kalman filter in its minimization of the cost function . for @xmath51 to be overdetermined",
    ", we only require a single measurement .",
    "thus , at a fundamental level the kalman filter is formulated in such a way that it solves a least squares , left pseudo - inverse problem , regardless of the number of measurements taken .",
    "this gives us the freedom to minimize the number of exposures required to estimate the field to a precision adequate for suppressing the field to the target contrast level .",
    "finally , we update the state covariance estimate , @xmath52 , by applying eq .",
    "[ eq : deriveupdate ] to the expected value of the covariance , @xmath53,\\ ] ] which gives @xmath54^{-1}.\\label{eq : covderive}\\ ] ] for the weighted form of the least - squares method , the covariance of the batch process method described in  [ batch ] is given by @xmath55\\\\ & = \\left(h^t r^{-1 } h\\right)^{-1}. \\label{eq : batchcov}\\end{aligned}\\ ] ] as shown in eq .",
    "[ eq : batchcov ] , the state covariance of the batch process method resets after every control step , and is tied to the noise in that particular set of measurements . however , the covariance of the kalman filter is also a function of the prior state covariance .",
    "looking at eq .",
    "[ eq : covderive ] , @xmath56 , is guaranteed to be positive definite .",
    "thus additional measurements taken at each iteration will act to reduce the magnitude of the covariance since additional measurements can do nothing but make the inversion smaller .",
    "we can use the contrast normalization for the measurements to get an idea of the estimator s robustness .",
    "if we do not take a long enough exposure in the probe images @xmath57 will become large , indicating a poor signal to noise ratio . in this case",
    "the covariance may not get better , but it is guaranteed not to get worse . in the batch - process estimator , we are stuck with these measurements and will receive an estimate with large covariance . in this case",
    "the control will not be effective , which is why we often see jumps in contrast when using this estimator once we reach low contrast levels , as seen in fig .",
    "[ diversity ] . in the case of the kalman filter , this high covariance is dampened by the contribution of prior covariance estimates via @xmath42 , stabilizing the state estimate and its covariance in the event of a bad measurement . since we can not guarantee that a probe will provide good signal , particularly at low contrast levels , this is an extremely attractive component of the kalman filter estimator .",
    "to complete the filter we need to propagate the prior estimate , @xmath58 , to the current time step .",
    "the filter extrapolates to the current state estimate , @xmath50 , by applying a time update to the prior state estimate via the state transition matrix , @xmath59 , and numerically propagating the control output from stroke minimization at the prior iteration , @xmath60 , via a linear transformation described by @xmath61 .",
    "we also have a disturbance from the process noise , @xmath62 , which is propagated to the current state of the electric field via the linear transformation , @xmath63 . assuming these components are additive , the state estimate extrapolation is @xmath64 we will apply the linearized optical model used to develop the batch process estimation method and stroke minimization control algorithm . using",
    "a linearized model avoids generating arbitrary bias in the estimate at each pixel , a common problem with a nonlinear filter @xcite .",
    "the first step in propagating the state forward in time is to update any dynamic variation between the discrete time steps with the state transition matrix , @xmath59 . in this system",
    ", @xmath59 captures any variation of the field due to temperature fluctuations , vibration , or air turbulence that perturb the optical system . to simplify the model",
    ", we recognize that there is no reliable way to measure or approximate small changes in the optical system over time with alternate sensors ; we assume that the state remains constant between control steps , making the state transition matrix , @xmath59 , @xmath65 .",
    "each submatrix for @xmath66 , shown in table  [ filtertable ] , is of dimension @xmath67 and represents the control effect on a single pixel of the matrix . making the standard assumption that the process noise is gaussian white noise , the expected value of the state when we extrapolate is    @xmath68    it s associated covariance extrapolation is then given by @xmath69    combining eq .",
    "[ eq : deriveupdate ] , eq .",
    "[ eq : gainderive ] , and , eq .  [ eq : covderive ] with the extrapolation equations , this form of the filter consists of five equations that describe the state estimate extrapolation , covariance estimate extrapolation , filter gain computation , state estimate update , and covariance estimate update at the @xmath70 iteration @xcite : @xmath71^{-1}\\label{eq : gain}\\\\ \\hat x_k(+ ) & = \\hat x_k(- ) + k_k \\left[z_k - h_k \\hat x_k(- ) \\right ] \\label{eq : estupdate}\\\\ p_k(+ ) & = \\left[p_k(-)^{-1 } + h_k^t r_k^{-1}h_k \\right]^{-1}\\label{eq : covupdate}\\end{aligned}\\ ] ]    with @xmath39 , @xmath72 , @xmath66 , @xmath37 , and @xmath73 constructed , the dimension and form of the rest of the filter follows .",
    "table  [ filtertable ] and table  [ filtervectors ] define all the matrices and vectors in the filter equations for this problem and provides their dimensionality for clarity .",
    "the initialization of the covariance , @xmath74 , is critical for the performance of the filter . in our system",
    "this can not be measured , so we must initialize with a reasonable guess .",
    "the focal plane measurements @xmath72 are identical to that of  [ batch ] , and are constructed into a vertical stack of difference images taken in a  pair - wise \" fashion to produce @xmath15 measurements for @xmath23 pixels .",
    "likewise @xmath39 takes on a similar form , and is a matrix constructed from the effect of a specific deformable mirror shape @xmath17 on the real and imaginary parts of the electric field in the image plane .",
    "finally , we compute the covariance update , @xmath52 , based on the added noise from the new measurements . the estimated state is a vertical stack of the real and imaginary parts of the electric field at each pixel of the dark hole in the image plane .",
    "the control signal @xmath3 is a vertical stack of the actuators of each dm , with @xmath75 being stacked on top of @xmath76 .",
    "since we are only considering process noise at the dms , the process disturbance @xmath77 is a vertical stack of the variance expected from each actuator .",
    ".definition of all filter matrices .",
    "@xmath78 is the number of actuators on a single dm , @xmath79 is the number of pixels in the area targeted for dark hole generation , and @xmath80 is the number of image pairs taken while applying positive and negative shapes to the deformable mirror [ cols=\"^,^\",options=\"header \" , ]     @xmath39 is constructed by separating the real and imaginary parts of the dm probe field .",
    "thus it will be underdetermined unless at least @xmath81 pairs of images are used in the measurement , one of the major limitations of the dm diversity algorithm .",
    "this will result in a non - unique solution to the state when using a batch - process , and will only provide the solution with the smallest quadratic norm since it must be solved via the right pseudo - inverse . on the other hand , the kalman filter only requires a single measurement as an update to the state . therefore it is nt necessary for the matrix to be square or overdetermined , and we maintain a favorable dimensionality when updating the state .",
    "an additional advantage of the kalman filter is that we may apply the filter iteratively , feeding the newly computed state @xmath82 and covariance update @xmath52 back into the filter again , setting @xmath60 to zero . for sufficiently small control",
    "this will help account for nonlinearity in the actuation and better filter noise in the system , limited only by the accuracy of the observation matrix , @xmath39 . with no control update",
    ", the control signal will be set to zero when we iterate the filter . following a notation similar to gelb @xcite ,",
    "the @xmath27 iteration of feedback into the iterative kalman filter at the @xmath70 control step is @xmath83^{-1}\\label{eq : itergain}\\\\ \\hat x_{j , k}(+ ) & = \\hat x_{j , k}(- ) + k_{j , k } \\left[z_{j , k } - h_{j , k } \\hat x_{j , k}(- ) \\right ] \\label{eq : iterupdate}\\\\ p_{j , k}(+ ) & = \\left[p_{,j}k(-)^{-1 } + h_{j , k}^t r_{j , k}^{-1}h_{j , k } \\right]^{-1}.\\label{eq : itercov}\\end{aligned}\\ ] ]    the power of iterating the filter lies in what we are fundamentally trying to achieve . for a successful control signal",
    ", we will have suppressed the field .",
    "this means that the magnitude of the probe signal will be lower than the control perturbation .",
    "this guarantees that @xmath39 will better satisfy the linearity condition than @xmath84 . as a result ,",
    "if we iterate the filter on itself during a given control step we can use the discrepancy between the image predicted by @xmath85 and the measurements , @xmath72 , in eq .",
    "[ eq : iterupdate ] to filter out any error due to nonlinear terms not accounted for in @xmath66 . in this way",
    ", we can accommodate a small amount of nonlinearity in our extrapolation of the state without having to resort to a nonlinear , or extended , kalman filter .",
    "this means that we do nt have to re - linearize about @xmath86 , as would be the case for an iterative extended kalman filter ( iekf ) .",
    "it also avoids having to concern ourselves with any bias introduced into the estimate by a nonlinear filter .",
    "it should be pointed out here that while we have chosen not to in this case , we can move to an iekf by simply re - linearizing about the estimate output , @xmath87 , at each step @xmath15 until the estimate converges .",
    "two important design parameters for the performance of the filter are the process noise , @xmath88 , and the sensor noise , @xmath57 . in order for the filter to operate optimally in the laboratory",
    "we make reasonable assumptions by appealing to physical scaling of the two largest known sources of error in the system .",
    "our sensor noise will be determined by the dark current and read noise inherent to our detector .",
    "our process noise will largely come from errors in our actuation shape .",
    "we treat the process noise as poor knowledge of the dm surface , which comes from the inherent nonlinearity in the voltage - to - actuation gain as a function of voltage , the variance in this gain from actuator to actuator , and the accuracy of the superposition model used to construct the mirror surface that covers the 32x32 actuator array of the boston micromachines kilo - dm .",
    "physical models , such as those found in blain et al .",
    "@xcite , have been constructed to produce a more accurate surface prediction over the full @xmath89 stroke range with an rms error of @xmath90 nanometers .",
    "the kalman filter presents a solution where we can treat actuation errors as additive process noise and include them in the estimator in a statistical fashion , rather than deterministically in a physical model .",
    "since there is no physical reasoning to justify varying @xmath91 at each iteration , it will be kept constant throughout the entire control history ( @xmath92 constant ) .",
    "two versions of process noise can be considered in this case .",
    "the first is where there is no correlation between actuators , giving a purely diagonal matrix with a magnitude corresponding to the square of the actuation variance , @xmath93 .",
    "the second version of @xmath94 which we may consider is one that has symmetric off - diagonal elements .",
    "this will treat uncertainty due to inter - actuator coupling and errors in the superposition model statistically . as a first step",
    ", we will not consider inter - actuator coupling to help avoid a poorly conditioned matrix .",
    "this helps guarantee that the kalman filter itself will be well behaved .",
    "thus the process noise for the filter will be    @xmath95    following howell @xcite the noise from both the incident light and dark noise in a ccd detector follows a poisson distribution . since our measurement is a difference of pairwise images each measurement will follow a zero - mean distribution that will become more gaussian as the exposure time increases .",
    "we simplify the noise statistics by assuming it is uncorrelated and constant from pixel to pixel .",
    "@xmath57 is thus a diagonal matrix of the mean pixel covariance , @xmath96 , given by @xmath97    where @xmath98 is the peak count rate of the psf s core ( allowing us to describe @xmath99 in units of contrast ) . having appealed to physical scaling in the hcil",
    ", we now have close approximations of the true process and sensor noise exhibited in the experiment .",
    "the choice of the probe shape used for estimation is critical to create a well - posed problem .",
    "these shapes are typically chosen to be analytical functions that can be proven analytically to modulate the field as uniformly as possible .",
    "however , there is no true formalism to determine the ",
    "best \" shapes to probe the dark hole . in any dark hole",
    "there are discrete aberrations that are much brighter than others , requiring that we apply more amplitude to those spatial frequencies .",
    "conversely the bright speckles raise the amplitude of the probe shape , making it too bright for to take a good measurement of dimmer speckles . excluding this issue , we also can not truly generate the analytical functions , meaning that we could get a poor measurement update .",
    "even the dm with the highest actuator density available , the boston micromachines 4k - dm , can only approximate each function with 64 actuators .",
    "we account for the true shape in our model but this shape does not truly probe each pixel in the dark hole with equal weight , which was the primary advantage of the analytical function for a probe shape in the first place .",
    "fortunately , we can once again appeal to our mathematical model for estimation and control to help determine an adequate probe shape .",
    "in closed loop , the control law determines a shape to suppress the speckles in the dark hole .",
    "first , we recognize that the controller has necessarily modulated the aberrated field in the dark hole . in principle , if we apply the conjugate of the control shape we will increase the energy of the aberrated field . instead of applying probes in addition to the control shape , we use the control shape itself ( and its negative ) to probe the elecric field in the dark hole .",
    "thus , we can rely on the controller to compute probe shapes , eliminating our reliance on an analytical form . in this way",
    ", we can optimally choose probe shapes that will inherently modulate brighter speckles more strongly than dimmer speckles and we have confidence that the shape will adequately perturb the dark hole field .",
    "we corrected the field using the kalman filter estimator using four , three , two , and one pair of images as a measurement update to assess the degradation in performance as information is lost .",
    "we begin with four measurements ( four image pairs ) , to compare its performance using the same number of measurements as were used in the dm diversity estimator . using 4 pairs ,",
    "the filter achieved a contrast of @xmath100 in ( 7 - 10)x(-2 - 2 ) @xmath35 symmetric dark holes within 20 iterations of the controller , shown in fig .",
    "[ fig:4pairs ] .",
    "note that this used a total of @xmath101 estimation images , which is the same amount of information available to the dm diversity estimator when it achieved a contrast of @xmath36 in @xmath102 iterations .",
    "when the number of image pairs is reduced to three , the correction algorithm was still able to reach a contrast level of @xmath103 using only @xmath104 estimation images , as shown in fig.[fig:3pairs ] .",
    "having proven that we can successfully reach very close to the same limits with fewer exposures , we now tune the covariance initialization and noise matrices and attempt only using two pairs of images . by reducing the number of image pairs to two",
    ", we are using half as many images as the correction using the dm diversity estimator and have reached a point where the batch process method will no longer provide a solution that takes advantage of the averaging effect of the left pseudo - inverse solution . after further tuning the covariance and noise matrices , the contrast achieved after @xmath105 iterations of the correction algorithm was @xmath34 , shown in fig .",
    "[ fig:2pairs ] .",
    "note that this is better than the case which used three pairs because we have improved the covariance initialization and increased the number of times the filter is iterated in a single control step .",
    "in fact it should be noted that making the filter iterative is critical to its performance since it accounts for nonlinearity , particularly in the propagation of the control .    reducing the number of measurements to a single pair we find a very interesting result .",
    "the quality of the measurement at any particular time step of the algorithm is now dependent on the quality of that particular probe shape . as a result ,",
    "if the probe does not happen to modulate the field well the field estimate gets worse .",
    "it is also important to cycle through the probe shapes . a single probe may not modulate a specific location of the field well , so we must choose a different probe shape to guarantee that we adequately cover the entire dark hole .",
    "starting from an aberrated field with an average contrast of @xmath106 , fig .",
    "[ fig : onepair_initial ] , we achieved a contrast of @xmath107 in @xmath105 iterations and @xmath108 in @xmath109 iterations of control , fig .",
    "[ fig : onepair_final ] .",
    "looking at the contrast plot in fig .",
    "[ fig : onepair_contrast ] , the sensitivity of a single measurement update to the quality of the probe is very clear .",
    "what is interesting , however , is that the modulation damps out over the control history .",
    "while we do not suppress as quickly in earlier iterations , as in the case with more probes , we achieve our ultimate contrast levels in almost the exact same number of iterations .",
    "this is a direct result of developing good coverage across the dark hole over time by changing the probe shape at each iteration .",
    "thus , even with one measurement update at each iteration the prior state estimate history stabilizes the estimate in the presence of the measurement update s poor signal - to - noise at high contrast levels . what is further encouraging is that these results use arbitrary probe shapes based on an analytical function , with no criteria to evaluate how effectively each modulates the field .",
    "if we were to choose our probes more carefully , we will see a dramatic improvement in the rate of convergence for a single measurement update .",
    "a very promising aspect of this estimation scheme is that its performance did not degrade significantly as the amount of measurement data was reduced . with only 86 estimation images it was capable of reaching the same final contrast achieved by the dm diversity algorithm in  [ batch ] , which achieved a contrast of @xmath110 in 30 iterations .",
    "the batch process required @xmath111 images to maintain an estimate of the entire control history , achieving a contrast of @xmath34 .",
    "thus by making the estimation method more dependent on a model we were able to reduce our need to measure deterministic perturbations in the image plane electric field .",
    "[ fig : probepair ] shows the preliminary results using the control and its conjugate shape as the probe pair for estimating the field with the kalman filter .",
    "the current contrast level is limited to @xmath112 on both sides of the image plane .",
    "the assymetry of the dark holes actually hints at the reason for not achieving a higher contrast level . in a 2-dm system , the idea that the optimal control signal can be used as the probe shape requires that we use both mirrors to probe the field .",
    "since the estimator is currently written assuming one mirror is probing the field , we were forced to collapse both control shapes onto the same dm .",
    "this means that we are not fully perturbing the field as we would have expected , leaving a particular set of aberrations unprobed .",
    "this is not a problem for a single sided dark hole using one dm , where the control and probe surfaces are one and the same .",
    "for a two dm system , we simply need to reformulate the estimator as a function of both dms for this concept to be effective .",
    "in this paper we have demonstrated a discrete time extended kalman filter to estimate the image plane electric field in closed loop .",
    "this type of progress is critical for improving the efficiency of future coronagraphic missions , thereby maximizing the likelihood of planetary detections .",
    "we demonstrate the fastest suppression to date in the princeton hcil by only requiring a single measurement at each iteration , currently requiring @xmath11330% of the original set of images for estimation .",
    "faster algorithms also makes focal plane estimation techniques more feasible for ground - based coronagraphic instruments .",
    "the closed loop nature of the estimator also provides a more stable to measurement because a measurement update with poor signal - to - noise does not adversely affect the covariance of the state estimate .",
    "we have also shown with the single measurement update that not all probe shapes are best for estimation , motivating us to try using the control shape as the probing function .",
    "preliminary results for using the control shape as a probe signal is promising , and may further reduce the number of required exposures to one image per iteration .",
    "the kalman filter also opens up the possibility of adaptive control techniques to learn laboratory physical parameters and bias estimation to gain certainty in planetary detection using only the control history .",
    "this work was funded by nasa grant # nnx09ab96 g and the nasa earth and space science fellowship      r.  belikov , a.  giveon , b.  kern , e.  cady , m.  carr , s.  shaklan , k.  balasubramanian , v.  white , p.  echternach , m.  dickie , j.  trauger , a.  kuhnert , and n.  j. kasdin , `` demonstration of high contrast in 10% broadband light with the shaped pupil coronagraph , '' _ proceedings of spie _  * 6693 * , pp .",
    "pp . 66930y1 ",
    "66930y11 , sept .",
    "l.  pueyo , j.  kay , n.  kasdin , t.  groff , m.  mcelwain , a.  giveon , and r.  belikov , `` optimal dark hole generation via two deformable mirrors with stroke minimization , '' _ applied optics _  * 48*(32 ) , pp .  62966312 , 2009 .",
    "a.  giveon , b.  kern , and s.  shaklan , `` pair - wise , deformable mirror , image plane - based diversity electric field estimation for high contrast coronagraphy , '' in _ proceedings of spie _ , * 8151 * , p.  815110",
    ", 2011 .        c.  blain , r.  conan , c.  bradley , o.  guyon , and c.  vogel , `` characterisation of the influence function non - additivities for a 1024-actuator mems",
    "deformable mirror , '' _ proceedings of the 1st ao for elt conference _ , 01 2010 ."
  ],
  "abstract_text": [
    "<S> space - based coronagraphs for future earth - like planet detection will require focal plane wavefront control techniques to achieve the necessary contrast levels . </S>",
    "<S> these correction algorithms are iterative and the control methods require an estimate of the electric field at the science camera , which requires nearly all of the images taken for the correction . we demonstrate a kalman filter estimator that uses prior knowledge to create the estimate of the electric field , dramatically reducing the number of exposures required to estimate the image plane electric field . </S>",
    "<S> in addition to a significant reduction in exposures , we discuss the relative merit of this algorithm to other estimation schemes , particularly in regard to estimate error and covariance . as part of the reduction in exposures </S>",
    "<S> we also discuss a novel approach to generating the diversity required for estimating the field in the image plane . </S>",
    "<S> this uses the stroke minimization control algorithm to choose the probe shapes on the deformable mirrors , adding a degree of optimality to the problem and once again reducing the total number of exposures required for correction . </S>",
    "<S> choosing probe shapes has been largely unexplored up to this point and is critical to producing a well posed set of measurements for the estimate . </S>",
    "<S> ultimately the filter will lead to an adaptive algorithm which can estimate physical parameters in the laboratory and optimize estimation . </S>"
  ]
}