{
  "article_text": [
    "in the 1970s paul erds and george purdy @xcite posed the question , given a finite set of points @xmath0 , what is the maximum number of similar copies @xmath4 that can be determined by @xmath3 points in the plane ? .",
    "this problem remains open in general .",
    "however , there has been some progress regarding the order of magnitude of this maximum as a function of @xmath3 .",
    "elekes and erds @xcite noted that @xmath8 for any pattern @xmath0 and they also gave a quadratic lower bound for @xmath4 when @xmath9 or when all the coordinates of the points in @xmath0 are algebraic numbers .",
    "they also proved a slightly subquadratic lower bound for all other patterns @xmath0 .",
    "later , laczkovich and ruzsa @xcite characterized precisely those patterns @xmath0 for which @xmath10 . in spite of this",
    ", the coefficient of the quadratic term is not known for any non - trivial pattern ; it is not even known if @xmath11 exists !    apart from being a natural question in discrete geometry , this problem also arose in connection to optimization of algorithms designed to look for patterns among data obtained from scanners , digital cameras , telescopes , etc .",
    "( see @xcite for further references . )",
    "our paper considers the case when @xmath0 is the set of vertices of an isosceles right triangle .",
    "the case when @xmath0 is the set of vertices of an equilateral triangle has been considered in @xcite . to avoid redundancy",
    ", we refer to an isosceles right triangle as an @xmath12 for the remainder of the paper .",
    "we begin with some definitions .",
    "let @xmath1 denote a finite set of points in the plane .",
    "we define @xmath13 to be the number of triplets in @xmath1 that are the vertices of an @xmath12 .",
    "furthermore , let @xmath14 as it was mentioned before , elekes and erds established that @xmath15 and it is implicit from their work that @xmath16 .",
    "the main goal of this paper is to derive improved constants that bound the function @xmath17 .",
    "specifically , in sections [ sec : lower ] and [ sec : upper ] , we prove the following result :    @xmath18    we then proceed to determine , in section [ sec : small cases ] , the exact values of @xmath19 when @xmath20 .",
    "several ideas for the proofs of these bounds come from the equivalent bounds for equilateral triangles in @xcite .",
    "we use the following definition . for @xmath21 , let @xmath22 be the @xmath23 counterclockwise rotation of @xmath1 with center @xmath24 .",
    "furthermore , let @xmath25 be the number of isosceles right triangles in @xmath1 such that @xmath24 is the right - angle vertex of the triangle .",
    "if @xmath21 , then @xmath26 can be computed by simply rotating our point set @xmath1 by @xmath23 about @xmath24 and counting the number of points in the intersection other than @xmath24 .",
    "therefore , @xmath27 due to the fact that an @xmath12 has only one right angle , then @xmath28 that is , the sum computes the number of @xmath12s in @xmath1 . from this identity an initial @xmath29 lower",
    "bound can be derived for @xmath30 using the set @xmath31 we now improve this bound .",
    "the following theorem generalizes our method for finding a lower bound .",
    "we denote by @xmath32 the lattice generated by the points @xmath33 and @xmath34 ; furthermore , we refer to points in @xmath32 as _ lattice points_. the next result provides a formula for the leading term of @xmath13 when our points in @xmath1 are lattice points enclosed by a given shape .",
    "this theorem , its proof , and notation , are similar to theorem 2 in @xcite , where the authors obtained a similar result for equilateral triangles in place of @xmath12s .    [ integral ]",
    "let k be a compact set with finite perimeter and area 1 .",
    "define @xmath35 as @xmath36 where @xmath37 .",
    "if @xmath38 is a similar copy of @xmath39 intersecting @xmath32 in exactly @xmath3 points , then @xmath40    given a compact set @xmath41 with finite area and perimeter , we have that @xmath42 where @xmath43 is the scaling of @xmath41 by a factor @xmath44 .",
    "therefore , @xmath45 we see that each error term in the sum is bounded by the perimeter of @xmath38 , which is finite by hypothesis .",
    "thus , @xmath46 the last sum is a riemann approximation for the function @xmath47 over the region @xmath48 , thus @xmath49 since @xmath50 it follows that , @xmath51 as a result , @xmath52    the importance of this theorem can be seen immediately .",
    "although our @xmath29 lower bound for @xmath53 was derived by summing the degrees of each point in a square lattice , the same result can be obtained by letting @xmath39 be the square @xmath54 .",
    "it follows that @xmath55 and @xmath56    an improved lower bound will follow provided that we find a set @xmath39 such that the value for the integral in theorem [ integral ] is larger than @xmath29 . we get a larger value for the integral by letting @xmath39 be the circle @xmath57 . in this case @xmath58 and @xmath59    it was conjectured in @xcite that not only does @xmath60 exist , but it is attained by the uniform lattice in the shape of a circle .",
    "( @xmath61 denotes the maximum number of equilateral triangles determined by @xmath3 points in the plane . ) the corresponding conjecture in the case of the isosceles right triangle turns out to be false .",
    "that is , if @xmath62 exists , then it must be strictly greater than @xmath63 .",
    "define @xmath64 to be the translation of @xmath32 by the vector @xmath65 .",
    "the following lemma will help us to improve our lower bound .",
    "[ lem : lambda ] if @xmath66 and @xmath67 or @xmath68 , then @xmath69    observe that @xmath70 first suppose @xmath71 . since @xmath72 ,",
    "then @xmath73 if and only if @xmath74 and @xmath75 .",
    "this can only happen when either both @xmath76 and @xmath77 are half - integers ( i.e. , @xmath78 ) , or both @xmath76 and @xmath77 are integers ( i.e. , @xmath79 ) .",
    "now suppose @xmath80 . in this case",
    ", because both @xmath81 and @xmath82 are half - integers , we conclude that @xmath83 if and only if both @xmath74 and @xmath75 .",
    "once again this occurs if and only if @xmath84 .",
    "recall that if @xmath39 denotes the circle of area 1 , then @xmath85 is the leading term of @xmath86 .",
    "the previous lemma implies that , if we were to adjoin a point @xmath87 to @xmath88 such that @xmath24 has half - integer coordinates and is located near the center of the circle formed by the points of @xmath88 , then @xmath26 will approximately equal @xmath89 .",
    "we obtain the next theorem by further exploiting this idea .",
    "@xmath90    let @xmath39 be the circle of area 1 , @xmath91 , and @xmath92 .",
    "moreover , position @xmath93 so that its points are centered on the circle formed by the points in @xmath94 ( see figure [ fig : centered ] ) .",
    "we let @xmath95 and @xmath96 , where @xmath97 is a constant to be determined .",
    "( gray points ) centered on set @xmath94 ( black points ) , ( b ) plot of the @xmath98 coefficient of @xmath99 as @xmath100 ranges from 0 to 1 . ]",
    "we proceed to maximize the leading coefficient of @xmath101 as @xmath100 varies from 0 to @xmath102 . by lemma [ lem : lambda ] , there can not exist an @xmath103whose right - angle vertex lies in @xmath94 while one @xmath104 vertex lies in @xmath94 and the other lies in @xmath93 . similarly , there can not exist an whose right angle - vertex lies in @xmath93 while one @xmath104 vertex lies in @xmath94 and the other lies in @xmath93 .",
    "therefore , each with vertices in @xmath105 must fall under one of the following four cases : + _ case 1 : all three vertices in @xmath94_. using theorem [ integral ] , it follows that there are @xmath106 s in this case .",
    "since @xmath107 , the number of s in terms of @xmath3 equals @xmath108 + _ case 2 : all three vertices in @xmath93_. by theorem [ integral ] , there are @xmath109 s in this case .",
    "this time @xmath110 and the number of s in terms of @xmath3 equals @xmath111 + _ case 3 : right - angle vertex in @xmath93 , @xmath104 vertices in @xmath94_. the relationship given by lemma [ lem : lambda ] allows us to slightly adapt the proof of theorem [ integral ] in order to compute the number of s in this case .",
    "the integral approximation to the number of s in this case is given by    @xmath112 but @xmath113 so @xmath114 expressing this value in terms of @xmath3 gives @xmath115 + _ case 4 : right - angle vertex in @xmath94 , @xmath104 vertices in @xmath93_. as in case 3 , the number of s is given by    @xmath116    now recall that @xmath117 .",
    "it follows that @xmath118 if and only if @xmath119 is farther than @xmath120 from the center of @xmath121 .",
    "thus for small enough values of @xmath122 , the region of integration in equation ( [ eqn : integral ] ) is actually @xmath123 , so it does not depend on @xmath124 .",
    "we consider two subcases .",
    "first , if @xmath125 ( i.e. , @xmath126 ) , then @xmath127 the left side of the above inequality is the radius of @xmath123 , meanwhile the right side is the radius of @xmath128 , thus the region of integration where @xmath129 is nonzero equals @xmath123 .",
    "hence , the number of s equals    @xmath130    now we consider the case @xmath131 ( i.e. , @xmath132 ) . in this case , @xmath129 is nonzero for all points in @xmath133 .",
    "thus the number of s in this case equals @xmath134    by equation ( [ circle function ] ) , we have that for @xmath135 , @xmath136 therefore , putting all four cases together ( i.e. , expressions ( [ case 1 ] ) , ( [ case 2 ] ) , ( [ case 3 ] ) , and either ( [ case 4a ] ) or ( [ case 4b ] ) ) , we obtain that the @xmath98 coefficient of @xmath137 equals @xmath138 if @xmath139 , or @xmath140 if @xmath141 .",
    "letting @xmath100 vary from 0 to 1 , it turns out that this coefficient is maximized ( see figure [ fig : centered ] ) when @xmath142 ( this corresponds to when the radius of @xmath93 is approximately 18.87% of the radius of @xmath94 ) .",
    "letting @xmath100 equal this value gives @xmath143 as a decimal approximation to the maximum value attained by the @xmath98 coefficient .    at this point",
    ", one might be tempted to further increase the quadratic coefficient by placing a third set of lattice points arranged in a circle and centered on the circle formed by @xmath93 .",
    "it turns out that forming such a configuration does not improve the results in the previous theorem .",
    "this is due to lemma [ lem : lambda ] .",
    "more specifically , given our construction from the previous theorem , there is no place to adjoin a point @xmath24 to the center of @xmath105 such that @xmath144 or @xmath145 .",
    "hence , if we were to add the point @xmath24 to the center of @xmath105 , then any new s would have their right - angle vertex located at @xmath24 with one @xmath104 vertex in @xmath94 and the other @xmath104 vertex in @xmath93 .",
    "doing so can produce at most @xmath146 new s ( recall that @xmath147 in our construction ) . on the other hand , adding @xmath24 to the perimeter of @xmath94 , gives us @xmath148 new s.",
    "we now turn our attention to finding an upper bound for @xmath149 .",
    "it is easy to see that @xmath150 , since any pair of points can be the vertices of at most 6 @xmath12s .",
    "our next theorem improves this bound .",
    "the idea is to prove that there exists a point in @xmath1 that does not belong to many @xmath12s .",
    "first , we need the following definition .    for every @xmath21 ,",
    "let @xmath151 and @xmath152 be the dilations of @xmath1 , centered at @xmath24 , by a factor of @xmath153 and @xmath154 , respectively ; followed by a @xmath104 counterclockwise rotation with center @xmath24 .",
    "furthermore , let @xmath155 and @xmath156 be the number of isosceles right triangles @xmath157 with @xmath158 such that @xmath157 is ordered in counterclockwise order , and @xmath159 , respectively @xmath160 , is the hypotenuse of the triangle @xmath157 .",
    "much like the case of @xmath161 , @xmath162 and @xmath163 can be computed with the following identities , @xmath164    [ theorem3]for @xmath165 , @xmath166    by induction on @xmath3 . if @xmath167 , then @xmath168 .",
    "now suppose the theorem holds for @xmath169 .",
    "we must show this implies the theorem holds for @xmath170 .",
    "suppose that there is a point @xmath21 such that @xmath171 .",
    "then by induction , @xmath172 the last equality can be verified by considering the three possible residues of @xmath77 when divided by 3 .",
    "hence , our theorem is proved if we can find a point @xmath21 with the desired property .",
    "let @xmath158 be points such that @xmath100 and @xmath173 form the diameter of @xmath1 .",
    "in other words , if @xmath174 , then the distance from @xmath175 to any other point in @xmath1 is less than or equal to the distance from @xmath100 to @xmath173 .",
    "we now prove that either @xmath100 or @xmath173 is a point with the desired property mentioned above .",
    "we begin by analyzing @xmath163 .",
    "we use the same notation from theorem 1 in @xcite .    define @xmath176 and @xmath177 .",
    "it follows from our identities that , @xmath178 and @xmath179 .",
    "furthermore , by the inclusion - exclusion principle for finite sets , we have @xmath180 we shall prove by contradiction that @xmath181 .",
    "suppose that there are two points @xmath182 .",
    "this means that there are points @xmath183 such that the triangles @xmath184 are @xmath12s oriented counterclockwise with right angle at either @xmath185 or @xmath186 .",
    "but notice that the line segments @xmath187 and @xmath188 are simply the @xmath189)-counterclockwise rotations of @xmath190 about centers @xmath185 and @xmath186 respectively .",
    "hence , @xmath191 is a parallelogram with two sides having length @xmath190 as shown in figure [ theoremlemma4](a ) .",
    "this is a contradiction since one of the diagonals of the parallelogram is longer than any of it sides .",
    "thus , @xmath181 .",
    "furthermore , @xmath192 and @xmath193 , so @xmath194 and thus @xmath195 this also implies that @xmath196 since we can follow the exact same argument applied to the reflection of @xmath1 about the line @xmath190 .",
    "we now look at @xmath197 and @xmath198 .",
    "first we need the following lemma .    for every @xmath199 , at most one of @xmath200 or @xmath201",
    "belongs to @xmath1 .",
    "let @xmath202 and @xmath203 ( see figure [ theoremlemma4](b ) ) .",
    "note that the distance @xmath204 is exactly the distance @xmath190 but scaled by @xmath153 .",
    "this contradicts the fact that @xmath190 is the diameter of @xmath1 .",
    "let us define a graph @xmath205 with vertex set @xmath206 and where @xmath207 is an edge of @xmath205 , ( i.e. , @xmath208 ) if and only if @xmath209 or @xmath210 .",
    "[ inequalitylemma]@xmath211    the left inequality follows from the fact each edge counts an @xmath12 in either @xmath197 or @xmath198 and possibly in both .",
    "however , if @xmath207 is an edge of @xmath205 so that @xmath209 and @xmath212 , then @xmath213 is a square , so this can only happen for at most one edge .",
    "now , let @xmath214 be the number of edges in @xmath215 incident to @xmath185 .",
    "we prove the following lemma .",
    "[ deglemma ] for every @xmath216 , @xmath217 .",
    "suppose @xmath218 , see figure [ fig : lemma56](a ) .",
    "without loss of generality we can assume that @xmath219 .",
    "if @xmath220 , then we conclude that @xmath221 or @xmath222 , because @xmath223 or @xmath224 .",
    "this contradicts the fact that @xmath190 is the diameter of @xmath1 .",
    "similarly , if @xmath225 and @xmath226 are defined as @xmath227 and @xmath228 , then at most one of @xmath225 or @xmath226 can be in @xmath1 .     and [ pathlemma ] .",
    "]    we still need one more lemma for our proof .",
    "[ pathlemma ] all paths in @xmath205 have length at most 2 .",
    "we prove this lemma by contradiction .",
    "suppose we can have a path of length 3 or more . to assist us ,",
    "let us place our points on a cartesian coordinate system with our diameter @xmath190 relabeled as the points @xmath229 and @xmath230 , furthermore , assume @xmath231 and that the four vertices of the path of length @xmath232 are @xmath233 , @xmath234 , @xmath235 , and @xmath236 .",
    "our aim is to show that the distance between @xmath236 and @xmath235 contradicts that @xmath44 is the diameter of @xmath1 .",
    "now , if paths of length 3 were possible , then the distance between every pair of points in figure [ fig : lemma56](b ) must be less than or equal to @xmath44 . since @xmath237 then @xmath238 .",
    "now let us analyze the square of the distance from @xmath236 to @xmath235 . because @xmath239 , it follows that @xmath240 but @xmath241 , so @xmath242 and thus @xmath243 equality occur if and only if @xmath244 and @xmath245 ;",
    "otherwise , @xmath246 is strictly greater than @xmath44 , contradicting the fact that the diameter of @xmath1 is @xmath44 .",
    "therefore if @xmath247 or @xmath248 then there is no path of length 3 . in the case that @xmath244 and @xmath245 the points @xmath234 and @xmath236 become the same and so do the points @xmath233 and @xmath235 .",
    "thus we are left with a path of length 1 .",
    "it follows from lemmas [ deglemma ] and [ pathlemma ] that all paths of length 2 are disjoint .",
    "in other words , @xmath205 is the union of disjoint paths of length less than or equal to 2 .",
    "let @xmath249 denote the number of paths of length 2 and @xmath250 denote the number of paths of length 1 , then @xmath251 recall from lemma [ inequalitylemma ] that either @xmath252 or @xmath253 .",
    "if @xmath252 , then @xmath254 so @xmath255 moreover , if @xmath256 , then @xmath257 and we get a minor improvement , @xmath258 so @xmath259 .",
    "we are now ready to put everything together . between the two points @xmath100 and @xmath173",
    ", we derived the following bounds : @xmath260 because the degree of a point must take on an integer value , it must be the case that either @xmath100 or @xmath173 satisfies @xmath261 .",
    "in this section we determine the exact values of @xmath7 when @xmath262 .",
    "we begin with @xmath167 .",
    "since @xmath232 points uniquely determine a triangle , and there is an @xmath103with 3 points ( figure [ fig : smallcases](a ) ) , this situation becomes trivial and we therefore conclude that @xmath270          having @xmath278 implies that we must always have more than one @xmath12 in @xmath1 . hence , we can begin with a single @xmath12 and examine the possible ways of adding a point and producing more @xmath12s .",
    "we accomplish this task in figure [ fig : smallcases](a ) .",
    "the 10 numbers in the figure indicate the location of a point , and the total number of @xmath12s after its addition to the set of black dots .",
    "all other locations not labeled with a number do not increase the number of @xmath12s . therefore , except for symmetries , all the possibilities for @xmath1 are shown in figures [ fig : smallcases](b)(e ) .",
    "suppose that within @xmath1 , every @xmath77-point configuration contains at most @xmath250 @xmath12s .",
    "the number of @xmath12s in @xmath1 can then be counted by adding all the @xmath12s in every @xmath77-point subset of @xmath1 . however , in doing so , we end up counting a fixed @xmath12 exactly @xmath284 times .",
    "because @xmath280 we get , @xmath285 notice that @xmath13 can only take on integer values so , @xmath286    now suppose @xmath287 . if @xmath288 for all @xmath281 with @xmath289 , then by lemma [ sumlemma ] , @xmath290 .",
    "otherwise , by lemma [ p=4 ] , @xmath1 must contain one of the 4 sets shown in figures [ fig : smallcases](b)[fig : smallcases](e ) .",
    "the result now follows by examining the possibilities for producing more @xmath12s by placing a fifth point in the 4 distinct sets . in figures [ fig : smallcases](b ) , [ fig : smallcases](c ) , [ fig : smallcases](d ) , and [ fig : smallcases](e ) we accomplish this task . in the same way as we did in lemma [ p=4 ]",
    ", every number in a figure indicates the location of a point , and the total number of @xmath12s after its addition to the set of black dots .",
    "it follows that the maximum value achieved by placing a fifth point is @xmath291 and so @xmath265 .",
    "the point - set that uniquely achieves equality is shown in figure [ fig : smallcases](f ) .",
    "moreover , there is exactly one set @xmath1 with @xmath292 ( shown in figure [ fig : smallcases](g ) ) , and two sets @xmath1 with @xmath293 ( figures [ fig : smallcases](h ) and [ fig : smallcases](i ) ) .",
    "now suppose @xmath294 . if @xmath295 for all @xmath281 with @xmath296 , then by lemma [ sumlemma ] , @xmath297 .",
    "otherwise , @xmath1 must contain one of the sets in figures [ fig : smallcases](f)[fig : smallcases](i ) .",
    "we now check all possibilities for adding more @xmath12s by joining a sixth point to our 4 distinct sets .",
    "this is shown in figures [ fig : smallcases](f)[fig : smallcases](i ) .",
    "it follows that the maximum value achieved is @xmath298 and so @xmath266 .",
    "the point - set that uniquely achieves equality is shown in figure [ fig : smallcases](j ) .",
    "also , except for symmetries , there are exactly 3 sets @xmath1 with @xmath299 ( figures [ fig : smallcases](k)[fig : smallcases](m ) ) and only one set @xmath1 with @xmath300 ( figure [ fig : smallcases](n ) ) .",
    "now suppose @xmath301 . if @xmath302 for all @xmath281 with @xmath303 , then by the lemma [ sumlemma ] , @xmath304 .",
    "otherwise , @xmath1 must contain one of the sets in figures [ fig : smallcases](j)[fig : smallcases](n ) .",
    "we now check all possibilities for adding more @xmath12s by joining a seventh point to our 5 distinct configurations .",
    "we complete this task in figures [ fig : smallcases](j)[fig : smallcases](n ) . because the maximum value achieved is @xmath305",
    ", we deduce that @xmath267 . in this case",
    ", there are exactly two point - sets that achieve 15 @xmath12s .",
    "the proof for the values @xmath306 and @xmath307 follows along the same lines , but there are many more intermediate sets to be considered .",
    "we omit the details .",
    "all optimal sets are shown in figure [ fig : optimal ] .",
    "inspired by our method used to prove exact values of @xmath308 , a computer algorithm was devised to construct the best 1-point extension of a given base set .",
    "this algorithm , together with appropriate heuristic choices for some initial sets , lead to the construction of point sets with many @xmath12s giving us our best lower bounds for @xmath308 when @xmath309 .",
    "these lower bounds are shown in table 1 and the point - sets achieving them in figure [ fig : bestconst ] .",
    "@xmath3 & 10 & 11 & 12 & 13 & 14 & 15 & 16 & 17 + @xmath310 & 35 & 43 & 52 & 64 & 74 & 85 & 97 & 112 +   + @xmath3 & 18 & 19 & 20 & 21 & 22 & 23 & 24 & 25 + @xmath310 & 124 & 139 & 156 & 176 & 192 & 210 & 229 & 252 +        * acknowledgements .",
    "* we thank virgilio cerna who , as part of the curm mini - grant that supported this project , helped to implement the program that found the best lower bounds for smaller values of @xmath3 .",
    "we also thank an anonymous referee for some useful suggestions and improvements to the presentation .",
    "p. erds and g. purdy . some extremal problems in geometry iii .",
    "6th southeastern conference in combinatorics , graph theory and comp .",
    "( florida atlantic univ . , boca raton , fla . , 1975 ) _ , pp .",
    "congressus numerantium , no .",
    "xiv , utilitas math . ,",
    "winnipeg , man . ,",
    "p. erds and g. purdy .",
    "some extremal problems in geometry iv . _",
    "7th southeastern conference in combinatorics , graph theory and comp .",
    "( louisiana state univ .",
    ", baton rouge , la . , 1976 )",
    "_ , pp . 307322 .",
    "congressus numerantium , no .",
    "xvii , utilitas math . ,",
    "winnipeg , man ."
  ],
  "abstract_text": [
    "<S> let @xmath0 be a finite set of points in the plane . for any set @xmath1 of points in the plane </S>",
    "<S> , @xmath2 denotes the number of similar copies of @xmath0 contained in @xmath1 . for a fixed @xmath3 , erds and purdy asked to determine the maximum possible value of @xmath2 , denoted by @xmath4 , over all sets @xmath1 of @xmath3 points in the plane . </S>",
    "<S> we consider this problem when @xmath5 is the set of vertices of an isosceles right triangle . </S>",
    "<S> we give exact solutions when @xmath6 , and provide new upper and lower bounds for @xmath7 . </S>"
  ]
}