{
  "article_text": [
    "in fluorescence microscopy , cells are exposed to high power illumination light .",
    "excitation intensities on a standard widefield fluorescence microscope are on the order of 400 , about 2500-fold higher than the flux of sunlight hitting earth on the brightest day of the year .",
    "illumination intensity on a point scanning confocal may be as much as three orders of magnitude higher . in most cases ,",
    "mammalian tissue culture cells are derived from tissues that are never exposed to light in their native context .",
    "thu , this high - intensity illumination light damages cells , and has been shown to induce a wide variety of biological changes @xcite .",
    "some cellular responses to phototoxicity , such as retraction , rounding , or death by apoptosis , are visually striking even to researchers with little experience in live cell imaging , but many effects of high - intensity illumination are less obvious . by the time the obvious phenotypes appear , cells may already be experiencing the effects of photodamage .",
    "for example , microtubule dynamics @xcite and contractile dynamics @xcite have been shown to be altered at relatively small light doses , before major , visually obvious , morphological changes are visible .    phototoxicity can be minimized with carefully chosen acquisition settings , but choosing such appropriate settings requires a method for determining whether or not cells are experiencing photodamage .",
    "most researchers detect phototoxicity during live cell imaging experiments by inspecting transmitted light images and looking for visibly sick cells .",
    "for example , cell biologists with many years of experience can learn to identify subtle signs of phototoxicity , using cues that may be easily missed by less experienced researchers .",
    "since this qualitative method relies on the expertise of the experimenter , it is subject to bias and can significantly decrease the reproducibility of such studies .",
    "existing quantitative methods to measure phototoxicity are generally difficult to implement , requiring either additional fluorescent probes @xcite or imaging of the sample hours or days after the initial experiment @xcite .",
    "some methods calibrate phototoxicity using standard samples , and use relative measurements of phototoxicity to select minimally damaging imaging conditions @xcite . because the effects of phototoxicity vary widely between samples , these methods are limited in their utility .",
    "thus there is a need for a quantitative and unbiased method to assess cell health and phototoxicity that can be easily applied to a wide range of microscopy samples .",
    "we propose to address this issue by applying deep convolutional neural networks ( convnets ) , which have recently achieved human - level accuracy for other image classification tasks @xcite , to assess phototoxicity in phase contrast transmitted light images .",
    "we chose to work with phase contrast images because they can be readily integrated into the workflow of many if not most light microscopy experiments .",
    "these images result in insignificant additional light exposure for the sample , and do not require the introduction of new labels .",
    "being `` label - free '' , phase contrast images are also non - specific , their content being derived solely from variations in the optical path length through the sample resulting from local changes in index of refraction .",
    "this makes these images information rich , and therefore it s plausible that they contain features indicative of cellular phototoxicity response .",
    "[ fig : workflow ]    furthermore , phase contrast images can be readily acquired in large quantities from cells that have experienced a known dose of fluorescence illumination light .",
    "these experimentally - derived annotations can then provide a supervisory signal for training a deep convnet .",
    "once trained , this convnet provides a powerful , objective , and unbiased assessment of photoxicity , that can be easily applied to a single phase contrast image acquired at the end of an imaging experiment ( see figure  [ fig : workflow ] for proposed workflow ) .",
    "u2os cells were cultured in mccoy s 5a media supplemented with 10% fbs and penicillin - streptomycin , according to standard protocols .",
    "cells were plated for imaging on black 24-well or 6-well # 1.5 coverslip glass bottom plates ( cellvis ) .",
    "all phototoxicity experiments were performed on a nikon ti eclipse inverted microscope equipped with a lumencor spectra - x light engine for fluorescence illumination , a coolled pe-100 illuminator for transmitted light , prior proscan iii motorized stage , and an okolab cage incubator to maintain samples at 37@xmath0c under humidified 5% co2 .",
    "all experiments were performed with a 20x/0.75 plan apo ph2 dm objective lens .",
    "illumination to induce phototoxicity was delivered using the violet led ( 395/30 nm ) in the spectra - x light engine .",
    "images were collected on a hamamatsu orca - er cooled ccd camera .",
    "the microscope was controlled with metamorph image acquisition software ( molecular devices ) .    for each experiment , 3 - 4 non - overlapping positions per well were chosen for imaging .",
    "all positions in a single well received the same light dose . a single dose of continuous 395 nm light was used to induce phototoxicity .",
    "a range of exposure times were used , from 0 to 200s .",
    "the 200s maximum was empirically determined to cause mass cell death by the end of the 18 - 24 hour timelapse .",
    "light exposure was automated with a custom metamorph journal , which moved the stage to each stored position and turned on the led illuminator for 0 - 200s , depending on the specified light dose .",
    "a multi - position timelapse experiment was started immediately after light exposure using metamorph s multi - dimensional acquisition .",
    "phase contrast images of each position were collected every 8 minutes for 18 - 24 hours .      * data set a. * to generate the first data set for training and testing , we selected stage positions that could be labeled en masse .",
    "images of healthy cells were generated by simply selecting stage positions that were not exposed to any uv light .",
    "to annotate sick cells , we first selected stage positions where every cell was unambiguously dead or dying by the end of the 18 - 24 hr timelapse . from these positions , we searched for images at the beginning of the timelapse where cells were still relatively healthy looking , and these few frames were labeled as sick . from each of these annotated full images ( 1344x1024 px ) , we extracted overlapping crops of 256x256 px , generating 54 annotated crops per full annotated image . by this strategy",
    ", we were able to easily generate a large amount of annotated data ( approx .",
    "2000 crops for training ) ; however , as a consequence , sick cells in this data set all correspond to relatively high uv exposure conditions .",
    "* data set b. * at numerous stage positions , generally corresponding to lower light dose , uv exposure caused local regions of cells to die , while other regions persisted , and even seemingly recovered from the initial insult . in such images , our previous mass - annotation strategy was not possible , yet many of these cells still displayed signs of phototoxicity identifiable by microscopists with extensive live - cell imaging experience .",
    "thus , we employed human annotation by cell biologists ( `` experts '' ) who have used fluorescence and phase microscopy to image live mammalian cells in their own research for many years , and have acquired the knowledge necessary to identify phototoxicity based on commonly accepted indicators and their own experience . to generate the data for annotating , we selected images with 0 - 80s uv exposure and extracted 256x256 px non - overlapping crops .",
    "each crop contained 10 consecutive frames from the timelapse ( temporal information is a strong discriminator between healthy and sick ) . to facilitate remote annotation , we constructed a javascript - based website that presented images at random .",
    "experts were asked to categorize each 10-frame image sequence as `` healthy '' , `` sick '' or `` unsure '' and responses were logged in an sql database ( see figure  [ fig : surveydata ] for a summary of these annotations ) .",
    "to ensure annotation overlap , every 5th image presented to the annotator was selected from a pool of images that were already scored by another annotator .",
    "after an image region was annotated , all 10 frames were associated with the same class and used as ground truth data . to avoid over - estimating the generalization capacity of our convnets , we were careful to ensure that the train and test sets did not contain crops from images acquired at the same stage position .",
    "after filtering these annotated images for concordance among our experts we had approx .",
    "900 images , of which 700 were used for training .",
    "data augmentation was used to expand the size of the training data set .",
    "each training image was augmented to generate multiple near copies , with the same class , via the following procedure :    1 .",
    "thin - plate spline warp ( * w * ) : input images were deformed by a thin - plate spline , as proposed by  @xcite .",
    "control points were placed on a grid at 128px intervals , and displaced according to @xmath1 , with @xmath2px .",
    "rotation and mirror image ( * r * ) : all 8 unique combinations of horizontal and vertical reflections , with 90@xmath0 rotations were applied .",
    "3 .   gaussian blur ( * b * ) : images were blurred using a gaussian blur kernel with @xmath3 uniformly sampled from 1.1 - 1.5px to represent focus variation during imaging .",
    "4 .   crop ( * c * ) : images were cropped from their original size of 1344x1024 px down to 256x256 px , such that each cropped field of view contained approximately 1 - 6 uncentered cells . in the case of low light dosage , this allowed us to account for the fact that each full image may contain a combination of healthy and sick cells .",
    "overlapping crops were taken with a stride of 128px .",
    "5 .   time ( * t * ) : a small window in time from the time - lapse was used , and all images were given the same label .",
    "additive gaussian noise ( * n * ) : after variance normalization , gaussian noise was added with @xmath4 .",
    "note that in all cases , independent of augmentation by gaussian noise , variance normalization ( such that @xmath5 , and @xmath6 ) was applied at the level of cropped images .",
    "applying the above transformations , we generated a total of * w * @xmath7 * r * @xmath7 * b * @xmath7 * c * = 3x8x2x54 = 2592 augmented images for every full sized image in data set a. for data set b , our experts labeled cropped images , rather than full images , limiting the amount of augmentation that we could apply to each annotated image to * r * @xmath7 * b * @xmath7 * t * @xmath7 * n * = 8x3x10x3 = 720 fold",
    ". the extent of augmentation was not optimized .",
    "the input to our network was a 220x220 px crop , randomly selected from within a 256x256 px image generated above .",
    "note that this introduces additional augmentation .",
    "our network architecture followed the vgg - style  @xcite with small ( 3x3 px ) , stacked convolutional kernels with stride and pad equal to 1 px .",
    "we used 8 convolutional ( conv ) layers , 3 fully connected ( fc ) layers , and 4 max pool layers .",
    "we increased the number of feature maps by a factor of two after every spatial pooling layer , resulting in an overall bi - pyramidal architecture .",
    "each conv or fc layer was batch normalized  @xcite , with learned scale and shift , and then a relu non - linearity was applied @xcite .",
    "the first two fc layers were regularized by drop - out , with a drop - out ratio of 0.5 .",
    "the final activation was a 2-way softmax classification . for more details on this architecture , see table  [ tab : architecture ] .",
    "we trained the networks using mini - batch stochastic gradient descent , based on backpropagation with nesterov momentum .",
    "the loss function was cross - entropy , with additional regularization in the form of @xmath8 weight decay .",
    "all networks were trained from random initializations , except where explicitly stated , using the xavier initialization scheme  @xcite .",
    "the initial learning rate was set to 0.0003 , and decayed according to an inverse schedule .",
    "momentum was 0.9 , and weight decay was 0.001 .",
    "training was done using a single geforce titanx ( maxwell ) or geforce gtx1080 ( pascal ) , for approx .",
    "500k iterations ( 16hrs ) with a batch size of 20 images . for additional details and parameter values , the train and solver prototxts for the best performing networks can be found at https://github.com/hms-idac/deadnet .    .*convnet architecture . *",
    "this architecture was trained on both data set a and data set b. [ cols=\"<,<,<,<,<\",options=\"header \" , ]     [ tab : architecture ]      to estimate uncertainties on model classification performance we used bootstrap sampling over 100 virtual batches @xcite each composed of a random set of 10 healthy and 10 sick cells .",
    "we then sampled from these classifications bootstrap samples with replacement and calculated @xmath9 confidence intervals using the bias - corrected accelerated percentile method @xcite .",
    "* grad - cam .",
    "* we used the method of gradient class activation mapping ( grad - cam ) to visualize the salient regions of images that contributed significantly to their classification  @xcite .",
    "grad - cam is a generalization of class activation mapping ( cam ) to arbitrary convnet architectures  @xcite .",
    "a grad - cam image can be computed as follows . for an input image , @xmath10",
    ", the convnet generates @xmath11 feature maps @xmath12 , for @xmath13 , @xmath14 , of reduced spatial domain @xmath15 at layer @xmath16 in the network .",
    "the output layer of the network computes a score , @xmath17 , for each class @xmath18 , before applying softmax activation to produce a probability distribution over all classes .",
    "the weight , or importance , of feature map @xmath19 , contributing to the score of class @xmath18 , for a particular image can be computed by equation  [ eq : gradcam1 ] .",
    "@xmath20    the grad - cam image , @xmath21 , then takes the weighted sum of the feature activation maps , and finally suppresses any negative values ( equation  [ eq : gradcam2 ] ) .",
    "we visualized grad - cam images from the final conv layer ( _ i_._e_. , l = conv4_2 ) , leading to a coarse 26x26 px activation map , and up - sampled this to the full image resolution .",
    "@xmath22_{+ } \\label{eq : gradcam2}\\ ] ]    we initially observed that the grad - cam images constructed from overlapping crops were not perfectly consistent in the overlapping regions .",
    "this was in large part due to the weights in equation  [ eq : gradcam1 ] being computed on a per - crop basis . to mitigate this effect , we computed average weights over the ensemble of all training images of class @xmath18 , following equation  [ eq : gradcam3 ] .",
    "@xmath23    where @xmath24 is an index over images in the training set , @xmath25 is a function indicating whether image @xmath24 is from class @xmath18 , and @xmath26 is the number of images of class @xmath18 in the training set . *",
    "class model visualization * we also estimated class models  @xcite to infer what , if any , larger - scale structures the model relied on for discrimination .",
    "we first tested the class model estimation using a vgg-16 model trained on imagenet  @xcite , where we determined that , inspired by @xcite , an additional regularization term encouraging spatial continuity improved the subjective quality of large - scale structure in class models , giving the update rule :    @xmath27    where @xmath28 represents a penalty on the @xmath8 norm of the class model image @xmath10 , and @xmath29 is a smoothness term encouraging local pixel correlations . initializing @xmath10 with zeros and applying this update rule using vgg-16 , we subjectively determined the optimal step size and regularization parameters to be @xmath30 , @xmath31,@xmath32 with 500 iterations , which resulted in interpretable class models for most imagenet classes tested .",
    "we then used the same parameters to estimate class models from our networks , initializing @xmath10 to either zeros or to an image from the opposing class .",
    "we trained convnets of identical architecture ( see table  [ tab : architecture ] ) on two different data sets , designated data set a and data set b , roughly representing low dose and high dose phototoxicity experiments , respectively . on data set a , the convnet converged ( both in terms of loss and accuracy on the test set ) after approx .",
    "@xmath33 iterations , and achieved a final accuracy of 94.5% on the test set ( figure  [ fig : results](a , b ) ) .",
    "this result corresponded to only seven incorrectly classified images out of 126 , 4 of which were partially - overlapping crops .",
    "we show two examples of healthy cells that were incorrectly labeled as sick by our convnet ( figure  [ fig : results](c ) ) , and in both cases it seems quite possible that the label is incorrect , not the prediction .",
    "this could result from cell health being affected by factors other than phototoxicity .",
    "we also show a number of examples of correctly classified cells ( figure  [ fig : results](d ) ) .",
    "these images demonstrate the ability of the trained convnet to distinguish subtle changes between sick and healthy cells .        after training this convnet , we applied it to a timelapse movie of cells that had been exposed to a lower dose of uv light .",
    "the convnet was applied as a sliding window classifier , and the final classification heat map was then upsampled to the original image size via bilinear interpolation .",
    "the results clearly demonstrate the ability of the convnet to distinguish regions within the larger image where cells are sick and dying , from regions of healthy cells ( figure  [ fig : deathmaps ] ) .",
    "this highlights the applicability of our approach to analyzing large amounts of microscopy data , and automatically identifying unhealthy regions within this data . in practice , images such as these with large swaths of cells showing clear signs of phototoxicity would be thrown out entirely , since all cells in the image were exposed to the same amount of light .",
    "next , we applied a similar strategy to train a convnet on data set b. this data set in general corresponded to cells with lower light dose , requiring expert human annotators to generate the ground truth labels ( see section  [ subsec : methods : annotation ] ) . on this data set , we were able to achieve 75.7% test set accuracy . while this is significantly lower than the performance that we achieved on data set a , this data set contained numerous challenging and ambiguous samples .    to determine a reasonable upper limit on the performance that we might expect from our convnet , we assessed the accuracy of the annotations by two methods .",
    "first , we presented a number of images to multiple annotators and measured their concordance on this subset .",
    "out of 263 images with overlapping annotations , for which neither annotator labeled it as `` unsure '' , there was disagreement on 49 ( 18.6% ) of these images . before training our convnet , we filtered out all images with disagreeing labels ; however , this does nt imply that all remaining images were unequivocal . assuming that our annotators randomly agreed on equivocal images 50% of the time ( because there are two possible labels )",
    ", this would imply that the original labeled set contained 37.2% ambiguous images , and the final training set had 22.9% ambiguous images remaining , after removing the disagreeing labels .",
    "while this line of reasoning makes numerous assumptions , it does give some indication that the upper limit of performance that could be expected on the current training set is roughly 77.1% , which is similar to the 75.2% accuracy achieved by our convnet ( figure  [ fig : results ] , inset table ) .",
    "as a second indicator of expert human performance on this task , we included a subset of images from cells that were never exposed to uv light .",
    "we assume that these are true healthy cells , but acknowledge that they could show signs of poor health for other reasons ( see figure  [ fig : surveydata ] for example images of unexposed cells ) . on this subset of images , our expert annotators labeled 230 / 256 ( 89.8% ) of these cells healthy . on the subset of these same images that were not used during training ,",
    "our convnet labeled 88.8% of them as healthy ( confidence interval = @xmath34 ) ) .",
    "thus , a convnet can be trained to achieve near expert level performance on this task .",
    "as we have demonstrated , convnets can be trained to successfully distinguish u2os cells suffering from phototoxicity . in practice for this tool",
    "to be integrated into scientific imaging workflows , its interpretability is just as important as its accuracy .",
    "convnets are notoriously difficult to interpret , due to their high level of abstraction and end - to - end training .",
    "a number of methods have recently been developed to address this concern , by producing visualizations that represent _ what _ a trained net has learned to detect , and _ where _ it is `` looking '' in an image when it makes a classification .",
    "we started by applying the method of gradient class activation mapping ( grad - cam ) , to generate heat maps that highlight _ where _ the convnet is looking  @xcite .",
    "_ i_._e_. , these images highlight areas that are discriminative for a particular class ( see section  [ subsec : methods : visualization ] for more details ) . the results of applying this method to the test data from data set a are shown in figure  [ fig : cam ] .",
    "grad - cam visualizations of data set b were more difficult to interpret , and are nt included here .",
    "we observed that in healthy cells , the grad - cam images often highlighted regions with multiple nucleoli , large isolated vacuoles , and/or mitotic cells ( figure  [ fig : cam ] ( left column ) ) .",
    "by contrast , structures that were highlighted in images of sick cells were dark aggregations at cell boundaries , retraction fibers , and/or the edge of rounded - up cells ( figure  [ fig : cam ] ( middle column ) ) .",
    "in general , we observed more variability in the grad - cam images of sick cells than we did of healthy cells , and in many cases these images were uninterpretable by our expert microscopists ( figure  [ fig : cam ] ( right column , bottom ) ) .",
    "this may imply that the convnet has learned to characterize healthy cells , and identified sick cells , which were more highly variable in phenotype , as outliers .",
    "however , it is also possible that our visualizations were affected by over - fitting to the limited amount of data that these models were trained on .        finally , we also occasionally observed interpretable , yet undesirable behavior in our convnets .",
    "for example , empty regions of images often contributed to the classification of sick cells ( figure  [ fig : cam ] ( right column , top ) ) .",
    "this is clearly interpretable , because as cells round up and die , it increases the exposed area in these images .",
    "this highlights the importance of visualizing the behaviour of a convnet , for identifying and controlling unwanted confounding variation in the training data .    to complement the grad - cam images",
    ", we also explored the use of class model visualizations  @xcite , to visualize _ what _ our trained convnets learned to look for .",
    "this method generates images that optimize the score assigned to a particular class by the convnet , and in this way they reflect the learned model for the different classes ( see section  [ subsec : methods : visualization ] for details ) .",
    "the results of generating class model visualizations for healthy and sick classes , starting both from random initializations and from images of the opposing class , are shown in figure  [ fig : cmv ] .",
    "starting from a zero image , we observed that the convnet generated bright and dark punctae for both healthy and sick classes ; however , with different spatial distributions .",
    "initializing this process from an image of the sick class ( figure  [ fig : cmv ] , top right ) , and driving the optimization towards the healthy class , the convnet appeared to add nucleoli - like punctae in clusters near to the nucleus .",
    "starting from an image of the healthy class ( figure  [ fig : cmv ] bottom right ) , and driving towards the sick class , the convnet added dark punctae more indiscriminately throughout the image .",
    "we also observed that bright streaks at the edges of cells were reduced in both healthy and sick images , and multiple bright vacuoles were removed from the sick image ; however removal of bright or dark regions was more difficult to interpret because it could be driven by the @xmath8 regularization term in the optimization process .",
    "overall , we found it difficult to interpret the class model visualizations generated by our trained convnets .",
    "it s worth noting that this method does tend to generate very noisy images , even when applied to networks trained on millions of images  @xcite .",
    "furthermore , we are applying this to a fine - grained recognition problem , where the classes are not as different as , say dog vs. car .",
    "this may limit the applicability of such a visualization method .",
    "we also observed that some of our trained convnets generated cleaner and more interpretable class model visualizations , despite their performance being otherwise indistinguishable to less interpretable convnets .",
    "_ e_._g_. , the images shown in figure  [ fig : cmv ] were from a slightly different model architecture than described in table  [ tab : architecture ] , and trained on data set b. this raises the interesting question of how to design and train convnets to optimize for their interpretability .",
    "this question has similarly arisen in other works  @xcite , but is potentially even more important and challenging to address in the scientific domain where interpretability is of utmost importance , and optimizing for it requires including experts in - the - loop .",
    "in this paper , we have demonstrated the plausibility of using deep convnets to predict phototoxicity from label - free phase contrast images of u2os cells . on one data set ,",
    "corresponding to a higher phototoxicity condition , we achieved 94.5% prediction accuracy . on a second , more challenging data set with lower phototoxicity , we obtained 75.7% accuracy ; however , this still rivaled expert level performance .",
    "going beyond this result will require larger annotated data sets , and we plan to pursue the use of live - dead markers to scale up our labeling efforts and more definitively assign class labels . in future work",
    ", we also hope to generalize these findings to a wider range of cell types and microscopes , _",
    "e.g. _ , brightfield and dic microscopy .",
    "another focus of this work was interpreting the predictions made by our convnets .",
    "we applied methods for visualizing the internal class model that was learned by our convnets , and for highlighting features within an image that influenced its classification .",
    "the convnet that achieved 94.5% accuracy had fairly reproducible behaviour , highlighting nucleoli , large vacuoles and mitotic cells in healthy images , and retraction fibers , dark cell boundaries , and rounded up cells in sick images .",
    "by contrast , the class model visualizations were very challenging to interpret , likely due to the limited data that our model was trained on .",
    "interestingly , we found that interpretability varied almost orthogonally to performance , and we plan to further investigate network architectures that result in more interpretable behavior .",
    "analysis of such networks would not only avoid classification based on undesireable confounding factors , but potentially provide novel insight into any generic cellular response to toxic levels of light .",
    "furthermore , it seems quite plausible that this type of analysis could generalize to other cellular insults .",
    "the authors would like to acknowledge yuyu song , ana pasapera and bob fischer for contributing annotations to data set b. we would also like to acknowledge the harvard medical school tools and technology fund for supporting idac and this research ."
  ],
  "abstract_text": [
    "<S> exposure to intense illumination light is an unavoidable consequence of fluorescence microscopy , and poses a risk to the health of the sample in every live - cell fluorescence microscopy experiment . </S>",
    "<S> furthermore , the possible side - effects of phototoxicity on the scientific conclusions that are drawn from an imaging experiment are often unaccounted for . </S>",
    "<S> previously , controlling for phototoxicity in imaging experiments required additional labels and experiments , limiting its widespread application . here </S>",
    "<S> we provide a proof - of - principle demonstration that the phototoxic effects of an imaging experiment can be identified directly from a single phase - contrast image using deep convolutional neural networks ( convnets ) . </S>",
    "<S> this lays the groundwork for an automated tool for assessing cell health in a wide range of imaging experiments . </S>",
    "<S> interpretability of such a method is crucial for its adoption . </S>",
    "<S> we take steps towards interpreting the classification mechanism of the trained convnet by visualizing salient features of images that contribute to accurate classification .    </S>",
    "<S> phototoxicity , deep learning , convolutional neural network , label - free , transmitted light microscopy , phase contrast </S>"
  ]
}