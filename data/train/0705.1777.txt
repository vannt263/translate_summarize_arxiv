{
  "article_text": [
    "the magnetic observation of the earth with satellites has now matured to a point where continuous measurements of the field are available from 1999 onwards , thanks to the oersted , sac - c , and champ missions ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* and references therein ) . in conjunction with ground - based measurements ,",
    "such data have been used to produce a main field model of remarkable accuracy , in particular concerning the geomagnetic secular variation ( gsv)@xcite . let us stress that we are concerned in this paper with recent changes in the earth s magnetic field , occurring over time scales on the order of decades to centuries .",
    "this time scale is nothing compared to the age of the earth s dynamo ( @xmath0 gyr ) , or the average period at which the dynamo reverses its polarity ( a few hundreds of kyr , see for instance @xcite ) , or even the magnetic diffusion time scale in earth s core , on the order of @xmath1 kyr ( e.g. * ? ? ?",
    "it is , however , over this minuscule time window that the magnetic field and its changes are by far best documented ( e.g. * ? ? ?",
    "downward - projecting the surface magnetic field at the core - mantle boundary , and applying the continuity of the normal component of the field across this boundary , one obtains a map of this particular component at the top of the core .",
    "the catalog of these maps at different epochs constitutes most of the data we have at hand to estimate the core state . until now",
    ", this data has been exploited within a kinematic framework @xcite : the normal component of the magnetic field is a passive tracer , the variations of which are used to infer the velocity that transports it ( e.g. * ? ? ? * ; * ? ? ?",
    "for the purpose of modeling the core field and interpreting its temporal variations not only in terms of core kinematics , but more importantly in terms of core dynamics , it is crucial to make the best use of the new wealth of satellite data that will become available to the geomagnetic community , especially with the launch of the swarm mission around 2010 @xcite .",
    "this best use can be achieved in the framework of data assimilation . in this respect",
    ", geomagnetists are facing challenges similar to the ones oceanographers were dealing with in the early nineteen - nineties , with the advent of operational satellite observation of the oceans .",
    "inasmuch as oceanographers benefited from the pioneering work of their atmosphericist colleagues ( data assimilation is routinely used to improve weather forecasts ) , geomagnetists must rely on the developments achieved by the oceanic and atmospheric communities to assemble the first bricks of geomagnetic data assimilation .",
    "dynamically speaking , the earth s core is closer to the oceans than to the atmosphere .",
    "the similarity is limited though , since the core is a conducting fluid whose dynamics are affected by the interaction of the velocity field with the magnetic field it sustains . these considerations , and their implications concerning the applicability of sophisticated ocean data assimilation strategies to the earth s core , will have to be addressed in the future . today , geomagnetic data assimilation is still in its infancy ( see below for a review of the efforts pursued in the past couple of years ) .",
    "we thus have to ask ourselves zero - th order questions , such as : variational or sequential assimilation ?    in short , one might be naively tempted to say that variational data assimilation ( vda ) is more versatile than sequential data assimilation ( sda ) , at the expense of a more involved implementation -for an enlightening introduction to the topic , see @xcite . through an appropriately defined misfit function , vda can in principle answer any question of interest , provided that one resorts to the appropriate adjoint model . in this paper , we specifically address the issue of improving initial conditions to better explain a data record , and show how this can be achieved , working with a non - linear , one - dimensional magneto - hydrodynamic ( mhd ) model .",
    "sda is more practical , specifically geared towards better forecasts of the model state , for example in numerical weather prediction @xcite .",
    "no adjoint model is needed here ; the main difficulty lies in the computational burden of propagating the error covariance matrix needed to perform the so - called analysis , the operation by which past information is taken into account in order to better forecast future model states ( e.g. * ? ? ?",
    "promising efforts in applying sda concepts and techniques to geomagnetism have recently been pursued : @xcite have performed so - called observing system simulation experiments ( osses ) using a three - dimensional model of the geodynamo , to study in particular the response ( as a function of depth ) of the core to surface measurements of the normal component of the magnetic field , for different approximations of the above mentioned error covariance matrix .",
    "also , in the context of a simplified one - dimensional mhd model , which retains part of the ingredients that make the complexity ( and the beauty ) of the geodynamo , @xcite have applied an optimal interpolation scheme that uses a monte - carlo method to calculate the same matrix , and studied the response of the system to assimilation for different temporal and spatial sampling frequencies .",
    "both studies show a positive response of the system to sda ( i.e. better forecasts ) .    in our opinion ,",
    "though , sda is strongly penalized by its formal impossibility to use current observations to improve past data records -even if this does not hamper its potential to produce good estimates of future core states . as said above , most of the information we have about the core is less that @xmath2 yr old @xcite .",
    "this record contains the signatures of the phenomena responsible for its short - term dynamics , possibly hydromagnetic waves with periods of several tens of years @xcite .",
    "our goal is to explore the vda route in order to see to which extent high - resolution satellite measurements of the earth s magnetic field can help improve the historical magnetic database , and identify more precisely physical phenomena responsible for short - term geomagnetic variations . to tackle this problem",
    ", we need a dynamical model of the high - frequency dynamics of the core , and an assimilation strategy .",
    "the aim of this paper is to reveal the latter , and illustrate it with a simplified one - dimensional nonlinear mhd model .",
    "such a toy model , similar to the one used by @xcite , retains part of the physics , at the benefit of a negligible computational cost .",
    "it enables intensive testing of the assimilation algorithm .",
    "this paper is organized as follows : the methodology we shall pursue in applying variational data assimilation to the geomagnetic secular variation is presented in sect .",
    "[ sec : metho ] ; its implementation for the one - dimensional , nonlinear mhd toy model is described in detail in sect .",
    "[ sec : toy ] .",
    "various synthetic assimilation experiments are presented in sect .",
    "[ sec : sae ] , the results of which are summarized and further discussed in sect .  [ sec : dis ] .",
    "in this section , we outline the bases of variational geomagnetic data assimilation , with the mid - term intent of improving the quality of the past geomagnetic record using the high - resolution information recorded by satellites .",
    "we resort to the unified set of notations proposed by @xcite .",
    "what follows is essentially a transcription of the landmark paper by @xcite with these conventions , transcription to which we add the possibility of imposing constraints to the core state itself during the assimilation process .",
    "assume we have a prognostic , nonlinear , numerical model @xmath3 which describes the dynamical evolution of the core state at any discrete time @xmath4 . if @xmath5 denotes the time - step size , the width of the time window considered here is @xmath6 , the initial ( final ) time being @xmath7 ( @xmath8 ) . in formal assimilation parlance , this is written as @xmath9 , \\label{eq : mod}\\ ] ] in which @xmath10 is a column vector describing the model state .",
    "if @xmath3 relies for instance on the discretization of the equations governing secular variation with a grid - based approach , this vector contains the values of all the field variables at every grid point .",
    "the secular variation equations could involve terms with a known , explicit time dependence , hence the dependence of @xmath3 on time in eq .",
    "( [ eq : mod ] ) . within this framework ,",
    "the modeled secular variation is entirely controlled by the initial state of the core , @xmath11 .",
    "assume now that we have knowledge of the true dynamical state of the core @xmath12 through databases of observations @xmath13 collected at discrete locations in space and time : @xmath14 + { {    \\hbox{\\mathversion{bold}$\\epsilon$}}}_i,\\ ] ] in which @xmath15 and @xmath16 are the discrete observation operator and noise , respectively .",
    "for gsv , observations consist of ( scalar or vector ) measurements of the magnetic field , possibly supplemented by decadal timeseries of the length of day , since these are related to the angular momentum of the core @xcite .",
    "the observation operator is assumed linear and time - dependent : in the context of geomagnetic data assimilation , we can safely anticipate that its dimension will increase dramatically when entering the recent satellite era ( 1999-present ) .",
    "however , @xmath17 will always produce vectors whose dimension is much lower than the dimension of the state itself : this fundamental problem of undersampling is at the heart of the development of data assimilation strategies .",
    "the observational error is time - dependent as well : it is assumed to have zero mean and we denote its covariance matrix at discrete time @xmath18 by @xmath19 .",
    "variational assimilation aims here at improving the definition of the initial state of the core @xmath11 to produce modeled observations as close as possible to the observations of the true state .",
    "the distance between observations and predictions is measured using a quadratic misfit function @xmath20 @xmath21^t { { \\mathbf{r}}}_i^{-1 }                        \\left [ h_i { \\mathbf{x}}_{i } - { \\mathbf{y}^o}_i \\right ] ,   \\label{defjh}\\ ] ] in which the superscript ` @xmath22 ' means transpose .",
    "in addition to the distance between observations and predictions of the past record , we might as well wish to try and apply some further constraints on the core state that we seek , through the addition of an extra cost function @xmath23 @xmath24 in which @xmath25 is a matrix which describes the constraint one would like @xmath10 to be subject to .",
    "this constraint can originate from some a priori ideas about the physics of the true state of the system , and its implication on the state itself , should this physics not be properly accounted for by the model @xmath3 , most likely because of its computational cost . in the context of geomagnetic data assimilation ,",
    "this a priori constraint can come for example from the assumption that fluid motions inside the rapidly rotating core are almost invariant along the direction of earth s rotation , according to taylor ",
    "proudman s theorem ( e.g. * ? ? ?",
    "we shall provide the reader with an example for @xmath25 when applying these theoretical concepts to the 1d mhd model ( see sect .",
    "[ sec : const ] ) .",
    "consequently , we write the total misfit function @xmath26 as @xmath27 where @xmath28 and @xmath29 are the weights of the observational and constraint - based misfits , respectively . these two coefficients should be normalized ; we will discuss the normalization in sect .",
    "[ sec : sae ] .      to minimize @xmath26",
    ", we express its sensitivity to @xmath11 , namely @xmath30 . with our conventions",
    ", @xmath30 is a row vector , since a change in @xmath11 , @xmath31 , is responsible for a change in @xmath26 , @xmath32 , given by @xmath33    to compute this gradient , we first introduce the tangent linear operator which relates a change in @xmath34 to a change in the core state at the preceding discrete time , @xmath35 : @xmath36 the tangent linear operator @xmath37 is obtained by linearizing the model @xmath38 about the state @xmath39 .",
    "successive applications of the above relationship allow us to relate perturbations of the state vector @xmath40 at a given model time @xmath41 to perturbations of the initial state @xmath42 : @xmath43 the sensitivity of @xmath26 to any @xmath39 expresses itself via @xmath44 that is @xmath45 additionally , after differentiating eq .",
    "( [ defj ] ) using eqs .",
    "( [ defjh ] ) and ( [ defjc ] ) , we obtain @xmath46 gathering the observational and constraint contributions to @xmath26 originating from every state vector @xmath39 finally yields @xmath47 \\cdot              \\prod_{j=0}^{i-1 } m'_j \\delta { \\mathbf{x}}_{0 }   \\\\            & & + \\left [ \\alpha_h     ( h_0 { \\mathbf{x}}_0 - { \\mathbf{y}^o}_0)^t   { \\mathbf{r}}^{-1}_0 h_0             + \\alpha_c { \\mathbf{x}}_0^t { { c}}\\right ]   \\delta { \\mathbf{x}}_{0 } \\\\                        & = & \\left\\ { \\sum_{i=1}^n \\left [ \\alpha_h     ( h_i { \\mathbf{x}}_i - { \\mathbf{y}^o}_i)^t   { \\mathbf{r}}_i^{-1 } h_i             + \\alpha_c { \\mathbf{x}}_i^t { { c}}\\right ]               \\prod_{j=0}^{i-1 } m'_j \\right .",
    "\\\\          & & +   \\alpha_h     ( h_0 { \\mathbf{x}}_0 - { \\mathbf{y}^o}_0)^t   { \\mathbf{r}}_0^{-1 } h_0              + \\alpha_c { \\mathbf{x}}_0^t { { c}}\\bigg\\ }    \\delta { \\mathbf{x}}_{0 } ,                      \\end{aligned}\\ ] ] which implies in turn that @xmath48          \\prod_{j=0}^{i-1 } m'_j \\nonumber\\\\          & & + \\alpha_h     ( h_0 { \\mathbf{x}}_0 - { \\mathbf{y}^o}_0)^t   { \\mathbf{r}}_0^{-1 } h_0 + \\alpha_c { \\mathbf{x}}_0^t { { c}}.   \\label{gradrow}\\end{aligned}\\ ] ]      the computation of @xmath49 via eq .  ( [ gradrow ] ) is injected in an iterative method to adjust the initial state of the system to try and minimize @xmath26 .",
    "the @xmath50-th step of this algorithm is given in general terms by @xmath51 in which @xmath52 is a descent direction , and @xmath53 an appropriate chosen scalar . in the case of the steepest descent algorithm ,",
    "@xmath54 , and @xmath53 is an a priori set constant .",
    "the descent direction is a column vector , hence the need to take the transpose of @xmath55 . in practice , the transpose of eq .",
    "( [ gradrow ] ) yields , at the @xmath56-th step of the algorithm , @xmath57^t & = &   \\sum_{i=1}^n   m'^t_{0 } \\cdots m'^t_{i-1 }         \\left[\\alpha_h h_i^t { \\mathbf{r}}^{-1}_i(h_i { \\mathbf{x}}_i^l - { \\mathbf{y}^o}_i )        + \\alpha_c { { c}}{\\mathbf{x}}_i^l \\right ] \\nonumber \\\\       & & + \\alpha_h   h_0^t   { \\mathbf{r}}^{-1}_0 ( h_0 { \\mathbf{x}}_0^l - { \\mathbf{y}^o}_0 ) + \\alpha_c { { c}}{\\mathbf{x}}_0^l . \\end{aligned}\\ ] ] introducing the adjoint variable @xmath58 , the calculation of @xmath59 is therefore performed practically by integrating the so - called adjoint model @xmath60 starting from @xmath61 , and going backwards in order to finally estimate @xmath62 equation ( [ adjm ] ) is at the heart of variational data assimilation @xcite .",
    "some remarks and comments concerning this so - called adjoint equation are in order :    1 .   it requires to implement the transpose of the tangent linear operator , the so - called adjoint operator , @xmath63 .",
    "if the discretized forward model is cast in terms of matrix - matrix and/or matrix - vector products , then this implementation can be rather straightforward ( see sect .",
    "[ sec : toy ] ) .",
    "still , for realistic applications , deriving the discrete adjoint equation can be rather convoluted ( e.g. * ? ? ?",
    "2 .   the discrete adjoint equation ( eq .  [ adjm ] )",
    "is based on the already discretized model of the secular variation .",
    "such an approach is essentially motivated by practical reasons , assuming that we already have a numerical model of the geomagnetic secular variation at hand .",
    "we should mention here that a similar effort can be performed at the continuous level , before discretization .",
    "the misfit can be defined at this level ; the calculus of its variations gives then rise to the euler ",
    "lagrange equations , one of which being the continuous backward , or adjoint , equation .",
    "one could then simply discretize this equation , using the same numerical approach as the one used for the forward model , and use this tool to adjust @xmath11 .",
    "according to @xcite , though , the  discrete adjoint equation \" is not the  adjoint discrete equation \" , the former breaking adjoint symmetry , which results in a solution being suboptimal @xcite .",
    "3 .   aside from the initial state @xmath11 , one can in principle add model parameters ( @xmath64 , say ) as adjustable variables , and invert jointly for @xmath11 and @xmath64 , at the expense of expressing the discrete sensitivity of @xmath26 to @xmath64 as well . for geomagnetic vda , this versatility might be of interest , in order for instance to assess the importance of magnetic diffusion over the time window of the historical geomagnetic record .",
    "4 .   the whole sequence of core states @xmath65 , has to be kept in memory .",
    "this memory requirement can become quite significant when considering dynamical models of the gsv .",
    "besides , even if the computational cost of the adjoint model is by construction equivalent to the cost of the forward model , the variational assimilation algorithm presented here is at least one or two orders of magnitude more expensive than a single forward realization , because of the number of iterations needed to obtain a significant reduction of the misfit function .",
    "when tackling ` real ' problems in the future ( as opposed to the illustrative problem of the next sections ) , memory and cpu time constraints might make it necessary to lower the resolution of the forward ( and adjoint ) models , by taking parameters values further away from the real core . a constraint such as the one imposed through eq .",
    "( [ defjc ] ) can then appear as a way to ease the pain and not to sacrifice too much physics , at negligible extra computational cost .",
    "we give a practical illustration of these ideas and concepts in the next two sections .",
    "we consider a conducting fluid , whose state is fully characterized by two scalar fields , @xmath66 and @xmath67 .",
    "formally , @xmath67 represents the magnetic field ( it can be observed ) , and @xmath66 is the velocity field ( it is invisible ) .",
    "the conducting fluid has density @xmath68 , kinematic viscosity @xmath69 , electrical conductivity @xmath70 , magnetic diffusivity @xmath71 , and magnetic permeability @xmath72 ( @xmath73 ) .",
    "its pseudo - velocity @xmath66 and pseudo - magnetic field @xmath67 are both scalar fields , defined over a domain of length @xmath74 , @xmath75 $ ] .",
    "we refer to pseudo fields here since these fields are not divergence - free .",
    "if they were so , they would have to be constant over the domain , which would considerably limit their interest from the assimilation standpoint .",
    "bearing this remark in mind , we shall omit the ` pseudo ' adjective in the remainder of this study .",
    "we choose @xmath76 as the length scale , the magnetic diffusion time scale @xmath77 as the time scale , @xmath78 as the magnetic field scale , and @xmath79 as the velocity scale ( i.e. the alfvn wave speed ) .",
    "accordingly , the evolution of @xmath66 and @xmath67 is controlled by the following set of non - dimensional equations : @xmath80 - 1,1 [ \\times [ 0,t ] , \\nonumber \\\\ \\partial_t u + s \\",
    "u \\partial_x u & = &   s\\   b \\partial_x b + pm\\partial_x^2 u \\label{mom } , \\\\",
    "\\partial_t b + s \\ u \\partial_x b & = &   s \\",
    "b \\partial_x u +   \\partial_x^2 b , \\label{ind}\\end{aligned}\\ ] ] supplemented by the boundary and initial conditions @xmath81 eq .",
    "( [ mom ] ) is the momentum equation : the rate of change of the velocity is controlled by advection , magnetic forces and diffusion .",
    "similarly , in the induction equation ( [ ind ] ) , the rate of change of the magnetic field results from the competition between inductive effects and ohmic diffusion .",
    "two non - dimensional numbers define this system , @xmath82 which is the lundquist number ( ratio of the magnetic diffusion time scale to the alfvn time scale ) , and @xmath83 which is the magnetic prandtl number , a material property very small for liquid metals - @xmath84 for earth s core ( e.g. * ? ? ?",
    "fields are discretized in space using one legendre spectral element of order @xmath85 .",
    "in such a framework , basis functions are the lagrangian interpolants @xmath86defined over the collection of @xmath87 gauss  lobatto  legendre ( gll ) points @xmath88 ( for a comprehensive description of the spectral element method , see * ? ? ?",
    "figure  [ fig : bf ] shows such a basis function for @xmath89 .",
    "having basis functions defined everywhere over @xmath90 $ ] makes it straightforward to define numerically the observation operator @xmath17 ( see sect . [",
    "sec : obstrue ] ) .",
    "we now drop the superscript @xmath85 for the sake of brevity .",
    "the semi - discretized velocity and magnetic fields are column vectors , denoted with bold fonts @xmath91^t , \\\\ { \\mathbf{b}}(t)&=&\\left[b(\\xi_0=-1,t),b(\\xi_1,t),\\dots , b(\\xi_n=1,t ) \\right]^t.\\end{aligned}\\ ] ]     an example of a basis function used to discretize the mhd model in space .",
    "this particular lagrangian interpolant , @xmath92 , is obtained for a polynomial order @xmath93 , and it is attached to the 51st gauss  lobatto  legendre point . ]",
    "discretization is performed in time with a semi - implicit finite - differencing scheme of order @xmath94 , explicit for nonlinear terms , and implicit for diffusive terms . as in the previous section , assuming that @xmath95 is the time step size , we define @xmath96 as a result of discretization in both space and time , the model is advanced in time by solving the following algebraic system @xmath97 } = \\left [             \\begin{array}{cc }              { \\mathbf{\\sf h}_u}^{-1 }    &   0    \\\\              0   &   { \\mathbf{\\sf h}_b}^{-1 }     \\\\             \\end{array }             \\right ]              { \\left [                     \\begin{array}{l }                     { \\mathbf{f}}_{u , i}\\\\                     { \\mathbf{f}}_{b , i }                     \\end{array }                     \\right]},\\ ] ] where @xmath98 are the helmholtz operators acting on velocity field and the magnetic field , and the forcing terms for each of these two , respectively .",
    "we have introduced the following definitions :    * @xmath99 , which is the diagonal mass matrix , * @xmath100 , which is the so - called stiffness matrix ( it is symmetric definite positive ) , * @xmath101 , which denotes the hadamard product : @xmath102 , * and @xmath103 , the so - called derivative matrix @xmath104    the knowledge of which is required to evaluate the nonlinear terms .",
    "advancing in time requires to invert both helmholtz operators , which we do directly resorting to standard linear algebra routines @xcite .",
    "let us also bear in mind that the helmholtz operators are symmetric ( i.e. self - adjoint ) .    in assimilation parlance , and according to the conventions introduced in the previous section , the state vector @xmath10 is consequently equal to @xmath105^t$ ] , and its dimension is @xmath106 ( since the value of both the velocity and magnetic fields are prescribed on the boundaries of the domain ) .",
    "since we are dealing in this paper with synthetic observations , it is necessary to define the true state of the 1d system as the state obtained via the integration of the numerical model defined in the preceding paragraph , for a given set of initial conditions , and specific values of the lundquist and magnetic prandtl numbers , @xmath107 and @xmath108 .",
    "the true state ( denoted with the superscript ` @xmath109 ' ) will always refer to the following initial conditions @xmath110 , \\label{bt}\\end{aligned}\\ ] ] along with @xmath111 and @xmath112 .",
    "the model is integrated forward in time until @xmath113 ( a fifth of a magnetic diffusion time ) .",
    "the polynomial order used to compute the true state is @xmath114 , and the time step size @xmath115 .",
    "figure [ fig : true ] shows the velocity ( left ) and magnetic field ( right ) at initial ( black curves ) and final ( red curves ) model times .",
    "the low value of the magnetic prandtl number @xmath108 reflects itself in the sharp velocity boundary layers that develop near the domain boundaries , while the magnetic field exhibits in contrast a smooth profile ( the magnetic diffusivity being three orders of magnitude larger than the kinematic viscosity ) . to properly resolve these hartmann boundary layers there must be enough points in the vicinity of the domain boundaries : we benefit here from the clustering of gll points near the boundaries @xcite . besides , even if the magnetic profile is very smooth , one can nevertheless point out here and there kinks in the final profile .",
    "these kinks are associated with sharp velocity gradients ( such as the one around @xmath116 ) and are a consequence of the nonlinear @xmath117 term in the induction eq .",
    "( [ ind ] ) .      in order to mimic the situation relevant for the earth s",
    "core and geomagnetic secular variation , assume that we have knowledge of @xmath67 at discrete locations in space and time , and that the velocity @xmath66 is not measurable .",
    "for the sake of generality , observations of @xmath67 are not necessarily made at collocation points , hence the need to define a spatial observation operator @xmath118 ( at discrete time @xmath18 ) consistent with the numerical approximation introduced above .",
    "if @xmath119 denotes the number of virtual magnetic stations at time @xmath18 , and @xmath120 their locations ( @xmath121 ) , @xmath118 is a rectangular @xmath122 matrix , whose coefficients write @xmath123 a database of magnetic observations @xmath124 is therefore produced at discrete time @xmath18 via the matrix - vector product @xmath125 integration of the adjoint model also requires the knowledge of the transpose of the observation operator ( eq .  [ adjm ] ) , the construction of which is straightforward according to the previous definition . to construct the set of synthetic observations , we take for simplicity the observational noise to be zero . during the assimilation process",
    ", we shall assume that estimation errors are uncorrelated , and that the level of confidence is the same for each virtual observatory .",
    "consequently , @xmath126 in which @xmath127 is the @xmath128 identity matrix , throughout the numerical experiments .    as an aside ,",
    "let us notice that magnetic observations could equivalently consist of an ( arbitrarily truncated ) set of spectral coefficients , resulting from the expansion of the magnetic field on the basis of legendre polynomials .",
    "our use of stations is essentially motivated by the fact that our forward model is built in physical space . for real applications ,",
    "a spectral approach is interesting since it can naturally account for the potential character of the field in a source - free region ; however , it is less amenable to the spatial description of observation errors , if these do not vary smoothly .",
    "as stated in the the previous section , the tangent linear operator @xmath37 at discrete time @xmath18 is obtained at the discrete level by linearizing the model about the current solution @xmath129 . by perturbing these two fields",
    "@xmath130 we get ( after some algebra ) @xmath131 } = \\left[\\begin{array}{cc }                    { \\mathbf{\\sf a}}_i &    { \\mathbf{\\sf b}}_i \\\\                    { \\mathbf{\\sf c}}_i &    { \\mathbf{\\sf e}}_i                    \\end{array } \\right]{\\left [                     \\begin{array}{l }                     \\delta { \\mathbf{u}}_{i}\\\\                     \\delta { \\mathbf{b}}_{i }                     \\end{array }                     \\right]}\\ ] ] having introduced the @xmath132 following matrices @xmath133 aside from the @xmath132 identity matrix @xmath134 , matrices and notations appearing in these definitions have already been introduced in  [ sec : num ] . in connection with the general definition introduced in the previous section , @xmath135",
    ", @xmath37 is the block matrix @xmath136 .",
    "\\label{eq : tlo}\\ ] ]      the sensitivity of the model to its initial conditions is computed by applying the adjoint operator , @xmath137 , to the adjoint variables - see eq .",
    "( [ adjm ] ) . according to eq .",
    "( [ eq : tlo ] ) , one gets @xmath138 , \\label{eq : adjb}\\ ] ] with each transpose given by @xmath139 in writing the equation in this form , we have used the symmetry properties of the helmholtz and mass matrices , and introduced the transpose of the derivative matrix , @xmath140 .",
    "programming the adjoint model is very similar to programming the forward model , provided that one has cast the latter in terms of matrix - matrix , matrix - vector , and hadamard products .",
    "having all the numerical tools at hand , we start out by assuming that we have imperfect knowledge of the initial model state , through an initial guess @xmath141 , with the model parameters and resolution equal to the ones that helped us define the true state of  [ true ] . we wish here to quantify how assimilation of observations can help improve the knowledge of the initial ( and subsequent ) states , with particular emphasis on the influence of spatial and temporal sampling . in the series of results reported in this paragraph ,",
    "the initial guess at model initial time is : @xmath142 + ( 1/2 ) \\sin ( 2 \\pi x ) .",
    "\\label{bg}\\end{aligned}\\ ] ] with respect to the true state at the initial time , the first guess is missing the small - scale component of @xmath66 , i.e. the second term on the right - hand side of eq .",
    ". in addition , our estimate of @xmath67 has an extra parasitic large - scale component ( the third term on the right - hand side of eq .",
    "( [ bg ] ) ) , a situation that could occur when dealing with the gsv , for which the importance of unmodeled small - scale features has been recently put forward given the accuracy of satellite data @xcite .",
    "figure [ fig : gvst ] shows the initial and final @xmath143 and @xmath144 , along with @xmath145 and @xmath146 at the same epochs for comparison , and the difference between the two , multiplied by a factor of five .",
    "differences in @xmath67 are not pronounced . over the time window considered here ,",
    "the parasitic small - scale component has undergone considerable diffusion . to quantify the differences between the true state and the guess , we resort to the @xmath147 norm @xmath148 and define the relative magnetic and fluid errors at time @xmath18 by @xmath149 the initial guess given by eqs .",
    "( [ ug])([bg ] ) is characterized by the following errors : @xmath150 and @xmath151 .",
    "observations of @xmath146 are performed at @xmath152 virtual observatories which are equidistant in space , at a number of epochs @xmath153 evenly distributed over the time interval .",
    "assuming no a priori constraint on the state , we set @xmath154 in def .",
    "the other constant @xmath155    the minimization problem is tackled by means of a conjugate gradient algorithm ,  la polak  ribire @xcite .",
    "iterations are stopped either when the initial misfit has decreased by 8 orders of magnitude , or when the iteration count exceeds 5,000 . in most cases ,",
    "the latter situation has appeared in our simulations .",
    "a typical minimization is characterized by a fast decrease in the misfit during the first few tens of iterations , followed by a slowly decreasing ( almost flat ) behaviour .",
    "even if the solution keeps on getting better ( i.e. closer to the synthetic reality ) during this slow convergence period , practical considerations ( having in mind the cost of future geomagnetic assimilations ) prompted us to stop the minimization .",
    "a typical example of a variational assimilation result is shown in fig .",
    "[ fig : typ ] . in this case ,",
    "@xmath156 and @xmath157 .",
    "the recovery of the final magnetic field @xmath158 is excellent ( see fig . [",
    "fig : typ]d ) , the relative @xmath147 error being @xmath159 .",
    "the benefit here is double : first , the network of observatories is dense enough to sample properly the field , and second , a measurement is made exactly at this discrete time instant , leaving no time for error fields to develop .",
    "when the latter is possible , the recovered fields can be contaminated by small - scale features , that is features that have length scales smaller than the spatial sampling scale .",
    "we see this happening in fig .",
    "[ fig : typ]c ) , in which the magnified difference between the recovered and true @xmath160 , shown in blue , appears indeed quite spiky ; @xmath161 has still decreased from an initial value of @xmath162 ( fig .",
    "[ fig : gvst]c ) down to @xmath163 . results for velocity are shown in figs .",
    "[ fig : typ]a and [ fig : typ]b .",
    "the recovered velocity is closer to the true state than the initial guess : this is the expected benefit from the nonlinear coupling between velocity and magnetic field in eqs .",
    "( [ mom])-([ind ] ) .",
    "the indirect knowledge we have of @xmath66 , through the observation of @xmath67 , is sufficient to get better estimates of this field variable . at the end of the assimilation process , @xmath164 and @xmath165 , which were approximately equal to @xmath166 with the initial",
    "guess , have been brought down to @xmath167 and @xmath168 % , respectively .",
    "the velocity at present time ( fig .",
    "@xmath169 ) is remarkably close to the true velocity , save for the left boundary layer sharp structure , which is undersampled ( see the distribution of red triangles ) .",
    "we further document the dynamical evolution of @xmath147 errors by plotting on fig .",
    "[ fig : dyne ] the temporal evolution of @xmath170 and @xmath171 for this particular configuration . instants at which observations are made are represented by circles , and the temporal evolution of the guess errors are also shown for comparison .",
    "the guess for the initial magnetic field is characterized by a decrease of the error that occurs over @xmath172 diffusion time scale , that is roughly the time it takes for most of the parasitic small - scale error component to diffuse away , the error being then dominated at later epochs by advection errors , originating from errors in the velocity field .",
    "the recovered magnetic field ( fig .",
    "[ fig : dyne]a , solid line ) , is in very good agreement with the true field as soon as measurements are available ( @xmath173 of a magnetic diffusion time , see the circles on fig .",
    "[ fig : dyne]a ) .",
    "even though no measurements are available for the initial epoch , the initial field has also been corrected significantly , as discussed above . in the latter parts of the record , oscillations in the magnetic error field are present",
    "-they disappear if the minimization is pushed further ( not shown ) .",
    "the unobserved velocity field does not exhibit such a drastic reduction in error as soon as observations are available ( fig .",
    "[ fig : dyne]b , solid line ) .",
    "still , it is worth noticing that the velocity error is significantly smaller in the second part of the record , in connection with the physical observation that most of the parasitic small - scale component of the field has decayed away ( see above ) : advection errors dominate in determining the time derivative of @xmath67 in eq .",
    "( [ ind ] ) , leaving room for a better assessment of the value of @xmath66 .",
    "for other cases ( different @xmath152 and @xmath153 ) , we find a similar behaviour ( not shown ) .",
    "we comment on the effects of an irregular time sampling on the above observations in section [ irregtime ] .    having in mind what one gets in this particular @xmath174 configuration ,",
    "we now summarize in fig .",
    "[ fig : sys ] results obtained by varying systematically these @xmath175 parameters . after assimilation",
    ", the logarithmic value of the @xmath147 velocity and magnetic field errors , at the initial and final stages ( @xmath176 and @xmath177 ) , are plotted versus @xmath153 , using @xmath178 and @xmath179 virtual magnetic stations . as far as temporal sampling",
    "is concerned , @xmath153 can be equal to @xmath94 ( having one observation at present time only ) , @xmath1 , @xmath180 , @xmath181 or @xmath179 .",
    "inspection of fig .",
    "[ fig : sys ] leads us to make the following comments :    * regarding @xmath67 : * * 50 stations are enough to properly sample the magnetic field in space . in this case",
    "@xmath182 is sufficient to properly determine @xmath183 , and no real improvement is made when increasing @xmath153 ( fig .",
    "[ fig : sys]b ) . during the iterative process",
    ", the value of the field is brought to its observed value at every station of the dense network , and this is it : no dynamical information is needed . * * when , on the other hand , spatial sampling is not good enough , information on the dynamics of @xmath67 helps improve partially its knowledge at present time .",
    "for instance , we get a factor of @xmath184 reduction in @xmath185 with @xmath156 , going from @xmath182 to @xmath186 ( fig .  [",
    "fig : sys]b , circles ) .",
    "the improvement then stabilizes upon increasing @xmath153 : spatial error dominates . *",
    "* this also applies for the initial magnetic field @xmath187 , see fig .",
    "[ fig : sys]a . as a matter of fact",
    ", having no dynamical information about @xmath67 ( @xmath182 ) precludes any improvement on @xmath187 , for any density of the spatial network .",
    "improvement occurs for @xmath188 .",
    "if the spatial coverage is good enough ( @xmath189 ) , no plateau is reached , since the agreement between the assimilated and true fields keeps on getting better , as it should . *",
    "regarding @xmath66 : * * the recovered @xmath66 is always sensitive to spatial resolution , even for @xmath182 ( figs .  [",
    "fig : sys]c and [ fig : sys]d ) . * * if @xmath153 is increased , the error decreases and reaches a plateau which is again determined by spatial resolution .",
    "this holds for @xmath164 and @xmath165 .",
    "for the reason stated above , @xmath190 is better known than @xmath191 .",
    "the error is dominated in both cases by a poor description of the left boundary layer ( see the blue curves in figs .  [",
    "fig : typ]a and [ fig : typ]b ) .",
    "the gradient associated with this layer is not sufficiently well constrained by magnetic observations ( one reason being that the magnetic diffusivity is three times larger than the kinematic viscosity ) .",
    "consequently , we can speculate that the error made in this specific region at the final time is retro - propagated and amplified going backwards in time , through the adjoint equation , resulting in @xmath192 .",
    "we have also studied the effect of an irregular spatial sampling by performing a suite of simulations identical to the ones described above , save that we assumed that stations were only located in the left half of the domain ( i.e. the @xmath193 $ ] segment ) .",
    "the global conclusion is then the following : assimilation results in an improvement of estimates of @xmath67 and @xmath66 in the sampled region , whereas no benefit is visible in the unconstrained region . to illustrate this tendency ( and keep a long story short ) , we only report in fig .",
    "[ fig : bias ] the recovered @xmath66 and @xmath67 for @xmath194 , which corresponds to the  regular \" case depicted in fig .",
    "[ fig : typ ] , deprived from its @xmath1 stations located in @xmath195 $ ] .",
    "the lack of transmission of information from the left - hand side of the domain to its right - hand side is related to the short duration of model integration ( @xmath196 magnetic diffusion time , which corresponds to @xmath196 advective diffusion time with our choice of @xmath111 ) .",
    "we shall comment further on the relevance of this remark for the assimilation of the historical geomagnetic secular variation in the discussion .",
    "the lack of observational constraint on the right - hand side of the domain results sometimes in final errors larger than the initial ones ( compare in particular figs .  [",
    "fig : bias]a and [ fig : bias]b , with figs .",
    "[ fig : typ]a and [ fig : typ]b ) .",
    "we also note large error oscillations located at the interface between the left ( sampled ) and right ( not sampled ) regions , particularly at initial model time ( figs .",
    "[ fig : bias]a and [ fig : bias]c ) .",
    "the contrast in spatial coverage is likely to be the cause of these oscillations ( for which we do not have a formal explanation ) ; this type of behaviour should be kept in mind for future geomagnetic applications .",
    "we can also assume that the temporal sampling rate is not constant ( keeping the spatial network of observatories homogeneous ) , restricting for instance drastically the epochs at which observations are made to the last @xmath1 % of model integration time , the sampling rate being ideal ( that is performing observations at each model step ) .",
    "not surprisingly , we are penalized by our total ignorance of the @xmath197 remaining per cent of the record .",
    "we illustrate the results obtained after assimilation with our now well - known array of @xmath156 stations by plotting the evolution of the errors in @xmath67 and @xmath66 ( as defined above ) versus time in fig .",
    "[ fig : dyne_irreg ] .        although the same amount of information ( @xmath198 ) has been collected to produce figs .",
    "[ fig : dyne ] and [ fig : dyne_irreg ] , the uneven temporal sampling of the latter has dramatic consequences on the improvement of the estimate of @xmath67 . in particular",
    ", the initial error @xmath161 remains large .",
    "the error decreases then linearly with time until the first measurement is made .",
    "we also observe that the minimum @xmath170 is obtained in the middle of the observation era .",
    "the poor quality of the temporal sampling , coupled with the not - sufficient spatial resolution obtained with these 20 stations , does not allow us to reach error levels as small as the ones obtained in fig .",
    "[ fig : dyne ] , even at epochs during which observations are made .",
    "the velocity is sensitive to a lesser extent to this effect , with velocity errors being roughly @xmath175 times larger in fig .",
    "[ fig : dyne_irreg ] than in fig .",
    "[ fig : dyne ] .      as stated in sect .",
    "[ sec : metho ] , future applications of variational data assimilation to the geomagnetic secular variation might require to try and impose a priori constraints on the core state . in a kinematic framework",
    ", this is currently done in order to restrict the extent of the null space when trying to invert for the core flow responsible for the gsv @xcite .",
    "assume for instance that we want to try and minimize the gradients of the velocity and magnetic fields , in a proportion given by the ratio of their diffusivities , that is the magnetic prandtl number @xmath108 , at any model time .",
    "the associated cost function is written @xmath199 , \\label{defconst}\\ ] ] in which @xmath103 is the derivative matrix introduced in ",
    "[ sec : num ] .",
    "the total misfit reads , according to eq .",
    "( [ defj ] ) @xmath200 with @xmath201 as before , and @xmath202 $ ] , in which @xmath203 is the parameter that controls the constraint to observation weight ratio .",
    "influence of an a priori imposed constraint ( in this case aiming at reducing the gradients in the model state ) on the results of variational assimilation .",
    "shown are the difference fields ( arbitrary scales ) between the assimilated and true states , for the velocity field ( left panel ) and the magnetic field ( right panel ) , at initial model time . again , as in fig .",
    "[ fig : typ ] , we have made @xmath157 measurements at @xmath156 evenly distributed stations .",
    "@xmath203 measures the relative ratio of the constraint to the observations . indicated for reference are the @xmath147 errors corresponding to each configuration .",
    "the grey line is the zero line . ]",
    "response of the assimilated model to the imposed constraint is illustrated in fig .",
    "[ fig : const ] , using the @xmath204 reference case of fig .",
    "[ fig : typ ] , for three increasing values of the @xmath203 parameter : @xmath205 and @xmath206 , and showing also for reference what happens when @xmath207 .",
    "we show the error fields ( the scale is arbitrary , but the same for all curves ) at the initial model time , for velocity ( left panel ) and magnetic field ( right panel ) .",
    "the @xmath147 errors for each field at the end of assimilation indicate that this particular constraint can result in marginally better estimate of the initial state of the model , provided that the value of the parameter @xmath203 is kept small . for @xmath208 ,",
    "the initial magnetic field is much smoother than the one obtained without the constraint and makes more physical sense ( fig .",
    "[ fig : const]d ) .",
    "the associated velocity field remains spiky , with peak to peak error amplitudes strongly reduced in the heart of the computational domain ( fig .",
    "[ fig : const]c ) .",
    "this results in smaller errors ( reduction of about @xmath209 for @xmath160 and @xmath210 for @xmath211 ) .",
    "increasing further the value of @xmath203 leads to a magnetic field that is too smooth ( and an error field even dominated by large - scale oscillations , see fig .",
    "[ fig : const]h ) , simply because too much weight has been put on the large - scale components of @xmath67 .",
    "the velocity error is now also smooth ( fig .",
    "[ fig : const]g ) , at the expense of a velocity field being further away from the sought solution ( @xmath212% ) , especially in the left hartmann boundary layer .",
    "convergence behaviour for different constraint levels @xmath203 .",
    "the ratio of the current value of the misfit @xmath213 ( normalized by its initial value @xmath214 ) is plotted against the iteration count @xmath56 .",
    "@xmath203 measures the strength of the constraint imposed on the state relative to the observations . ]    in the case of real data assimilation ( as opposed to the synthetic case here , the true state of which we know , and departures from which we can easily quantify ) , we do not know the true state . to get a feeling for the response of the system to the imposition of an extra constraint , it is nevertheless possible to monitor for instance the convergence behaviour during the descent . on fig .",
    "[ fig : conv ] , the ratio of the misfit to its initial value is plotted versus the iteration number in the conjugate gradient algorithm ( log - log plot ) .",
    "if @xmath203 is small , the misfit keeps on decreasing , even after 5,000 iterations ( green curve ) . on the other hand , a too strong a constraint ( blue and red curves in fig .  [",
    "fig : conv ] ) is not well accommodated by the model and results in a rapid flattening of the convergence curve , showing that convergence behaviour can be used as a proxy to assess the efficacy of an a priori imposed constraint .",
    "again , we have used the constraint given by eq .",
    "( [ defconst ] ) for illustrative purposes , and do not claim that this specific low - pass filter is mandatory for the assimilation of gsv data .",
    "similar types of constraints are used to solve the kinematic inverse problem of gsv @xcite ; see also @xcite and @xcite for recent innovative studies on the subject .",
    "the example developed in this section aims at showing that a formal continuity exists between the kinematic and dynamical approaches to the gsv .      in most of the cases presented above",
    ", the iteration counts had reached @xmath215 before the cost function had decreased by @xmath216 orders of magnitude . even though the aim of this paper is not to address specifically the matter of convergence acceleration algorithms , a few comments are in order , since @xmath215 is too large a number when considering two- or three - dimensional applications .    * in many cases , a reduction of the initial misfit by only @xmath217 orders of magnitude gives rise to decent solutions , obtained typically in a few hundreds of iterations .",
    "for example , in the case corresponding to fig .",
    "[ fig : typ ] , a decrease of the initial misfit by @xmath217 orders of magnitude is obtained after @xmath218 iterations .",
    "the resulting error levels are already acceptable : @xmath219  @xmath220 , @xmath221  @xmath220 , @xmath222  @xmath220 , and @xmath223  @xmath224 . * more importantly , in future applications , convergence will be sped up through the introduction of a background error covariance matrix @xmath225 , resulting in an extra term @xcite @xmath226^t { \\mathbf{b}}^{-1 } [ { \\mathbf{x}}_0 - { \\mathbf{x}}_b ] \\ ] ] added to the cost function ( eq .  ( [ defj ] ) ) . here , @xmath227 denotes the background state at model time  @xmath228 , the definition of which depends on the problem of interest . in order to illustrate how this extra term can accelerate the inversion process",
    ", we have performed the following assimilation experiment : we take the network of virtual observatories of fig .",
    "[ fig : typ ] , and define the background state at model time @xmath228 to be zero for the velocity field ( which is not directly measured ) , and the polynomial extrapolation of the @xmath229 magnetic observations made at the @xmath156 stations on the @xmath87 gll grid points for the magnetic field ( resorting to lagrangian interpolants defined by the network of stations ) . the background error covariance matrix is chosen to be diagonal , without cross - covariance terms .",
    "this approach enables a misfit reduction by @xmath184 orders of magnitude in 238 iterations , with the following @xmath147 error levels : @xmath230  @xmath220 , @xmath231  @xmath220 , @xmath232  @xmath233 , and @xmath234  @xmath224 .",
    "this rather crude approach is beneficial for a ) the computational cost and b ) the estimate of the magnetic field .",
    "the recovery of the velocity is not as good as it should be , because we have made no assumption at all on the background velocity field . in future applications of vda to the gsv , some a priori information on the background velocity field inside the core will have to be introduced in the assimilation process .",
    "the exact nature of this information is beyond the scope of this study .",
    "we have laid the theoretical and technical bases necessary to apply variational data assimilation to the geomagnetic secular variation , with the intent of improving the quality of the historical geomagnetic record . for the purpose of illustration",
    ", we have adapted these concepts ( well established in the oceanographic and atmospheric communities ) to a one - dimensional nonlinear mhd model .",
    "leaving aside the technical details exposed in section [ sec : toy ] , we can summarize our findings and ideas for future developments as follows :    * observations of the magnetic field always have a positive impact on the estimate of the invisible velocity field , even if these two fields live at different length scales ( as could be expected from the small value of the magnetic prandtl number ) . * with respect to a purely kinematic approach",
    ", having successive observations dynamically related by the model allows one to partially overcome errors due to a poor spatial sampling of the magnetic field .",
    "this is particularly encouraging in the prospect of assimilating main geomagnetic field data , the resolution of which is limited to spherical harmonic degree @xmath235 ( say ) , because of ( remanent or induced ) crustal magnetization .",
    "* over the model integration time ( @xmath180 % of an advection time ) , regions poorly covered exhibit poor recoveries of the true fields , since information does not have enough time to be transported there from well covered regions . in this respect , model dynamics clearly controls assimilation behaviour .",
    "concerning the true gsv , the time window we referred to in the introduction has a width of roughly a quarter of an advective time scale .",
    "again , this is rather short to circumvent the spatial limitations mentioned above , if advective transport controls the gsv catalog .",
    "this catalog , however , could contain the signature of global hydromagnetic oscillations @xcite , in which case our hope is that problems due to short duration and coarse spatial sampling should be alleviated .",
    "this issue is currently under investigation in our simplified framework , since the toy model presented here supports alfvn waves .",
    "* a priori imposed constraints ( such as the low - pass filter of sect .",
    "[ sec : const ] ) can improve assimilation results .",
    "they make variational data assimilation appear in the formal continuity of kinematic geomagnetic inverse problems as addressed by the geomagnetic community over the past @xmath236 years .        finally , in order to illustrate the potential interest of applying vda techniques to try and improve the recent gsv record , we show in fig .",
    "[ fig : gufm ] the results of two synthetic assimilation experiments .",
    "these are analogous to the ones described in great length in sect .",
    "[ sec : sae ] ( same physical and numerical parameters , constraint parameter @xmath208 ) . in both cases ,",
    "observations are made by a network of @xmath237 evenly distributed stations during the first half of model integration time ( the logbooks era , say ) .",
    "the second half of the record is then produced by a network of @xmath238 stations for case a ( the observatory era ) . for case",
    "b , this is also the case , save that the last @xmath184% of the record are obtained via a high - resolution network of @xmath239 stations .",
    "the two records therefore only differ in the last @xmath184% of model integration time .",
    "case b is meant to estimate the potential impact of the recent satellite era on our description of the historical record .    the evolution of the magnetic error @xmath170 backwards in time ( fig .",
    "[ fig : gufm]a ) shows that the benefit due to the dense network is noticeable over three quarters of model integration time , with an error reduction of roughly a factor of @xmath184 .",
    "the velocity field is ( as usual ) less sensitive to the better quality of the record ; still , it responds well to it , with an average decrease of @xmath171 on the order of @xmath180% , evenly distributed over the time window .",
    "even if obtained with a simplified model ( bearing in particular in mind that real geomagnetic observations are only available at the core surface ) , these results are promising and indicate that vda should certainly be considered as the natural way of using high - quality satellite data to refine the historical geomagnetic record in order to ` reassimilate ' @xcite pre - satellite observations .",
    "to do so , a good initial guess is needed , which is already available @xcite ; also required is a forward model ( and its adjoint ) describing the high - frequency physics of the core .",
    "this model could either be a full three - dimensional model of the geodynamo , or a two - dimensional , specific model of short - period core dynamics , based on the assumption that this dynamics is quasi - geostrophic @xcite .",
    "the latter possibility is under investigation .",
    "we thank andrew tangborn and an anonymous referee for their very useful comments , and lisabeth canet , dominique jault , alexandra pais , and philippe cardin for stimulating discussions .",
    "af also thanks ric beucler for sharing his knowledge of inverse problem theory , and lisabeth canet for her very careful reading of the manuscript ."
  ],
  "abstract_text": [
    "<S> secular variations of the geomagnetic field have been measured with a continuously improving accuracy during the last few hundred years , culminating nowadays with satellite data . </S>",
    "<S> it is however well known that the dynamics of the magnetic field is linked to that of the velocity field in the core and any attempt to model secular variations will involve a coupled dynamical system for magnetic field and core velocity . </S>",
    "<S> unfortunately , there is no direct observation of the velocity . independently of the exact nature of the above - mentioned coupled system  some version being currently under construction  </S>",
    "<S> the question is debated in this paper whether good knowledge of the magnetic field can be translated into good knowledge of core dynamics . </S>",
    "<S> furthermore , what will be the impact of the most recent and precise geomagnetic data on our knowledge of the geomagnetic field of the past and future ? </S>",
    "<S> these questions are cast into the language of variational data assimilation , while the dynamical system considered in this paper consists in a set of two oversimplified one - dimensional equations for magnetic and velocity fields . </S>",
    "<S> this toy model retains important features inherited from the induction and navier - stokes equations : non - linear magnetic and momentum terms are present and its linear response to small disturbances contains alfvn waves . </S>",
    "<S> it is concluded that variational data assimilation is indeed appropriate in principle , even though the velocity field remains hidden at all times ; it allows us to recover the entire evolution of both fields from partial and irregularly distributed information on the magnetic field . </S>",
    "<S> this work constitutes a first step on the way toward the reassimilation of historical geomagnetic data and geomagnetic forecast . </S>"
  ]
}