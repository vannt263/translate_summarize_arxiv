{
  "article_text": [
    "at high - luminosity hadron colliders such as cern s large hadron collider ( lhc ) , an issue that has an impact on many analyses is pileup , the superposition of multiple proton - proton collisions at each bunch crossing .",
    "pileup affects a range of observables , such as jet momenta and shapes , missing transverse energy and lepton and photon isolation . in the specific case of jets",
    ", it can add tens of gev to a jet s transverse momentum and significantly worsens the resolution for reconstructing the jet momentum . in the coming years",
    "the lhc will move towards higher luminosity running , ultimately increasing pileup by up to a factor of ten for the high - luminosity lhc  @xcite .",
    "the experiments ability to mitigate pileup s adverse effects will therefore become increasingly crucial to fully exploit the lhc data , especially at low and moderate momentum scales , for example in studies of the higgs sector .",
    "some approaches to reducing the impact of pileup are deeply rooted in experimental reconstruction procedures .",
    "for example , charged hadron subtraction ( chs ) in the context of particle flow  @xcite , exploits detectors ability to identify whether a given charged track is from a pileup vertex or not .",
    "other aspects of pileup mitigation are largely independent of the experimental details : for example both atlas and cms  @xcite rely on the area ",
    "median approach  @xcite , which makes a global estimate for the transverse momentum - flow density , @xmath0 , and then applies a correction to each jet in proportion to its area .    in this article",
    ", we introduce and study a new generic pileup - removal method . instead of correcting individual jets , it corrects for pileup at the level of particles .",
    "such a method should make a guess , for each particle in an event , as to whether it comes from pileup or from the hard collision of interest .",
    "particles deemed to be from pileup are simply discarded , while the much smaller set of residual `` hard - collision '' particles are passed to the jet clustering .",
    "event - wide particle - level subtraction , if effective , would greatly simplify pileup mitigation in advanced jet studies such as those that rely on jet substructure  @xcite .",
    "even more importantly , as we shall see , it has the potential to bring significant improvements in jet resolution and computational speed .",
    "this latter characteristic makes our approach particularly appealing also for trigger - level applications .",
    "the basis of our pileup suppression method , which we dub `` softkiller '' ( sk ) , is that the simplest characteristic of a particle that affects whether it is likely to be from pileup or not is its transverse momentum . in other words",
    ", we will discard particles that fall below a certain transverse momentum threshold .",
    "the key feature of the method will be its event - by - event determination of that threshold , chosen as the lowest @xmath1 value that causes @xmath0 , in the median ",
    "area method , to be evaluated as zero . in a sense",
    ", this can be seen as the extreme limit of atlas s approach of increasing the topoclustering noise threshold as pileup increases  @xcite .",
    "this approach might at first sight seem excessively nave in its simplicity .",
    "we have also examined a range of other methods .",
    "for example , one approach involved an all - orders matrix - element analysis of events , similar in spirit to shower deconstruction  @xcite ; others involved event - wide extensions of a recent intrajet particle - level subtraction method  @xcite and subjet - level  @xcite approaches ( see also @xcite ) ; we have also been inspired by calorimeter  @xcite and particle - level  @xcite methods developed for heavy - ion collisions . such methods and their extensions",
    "have significant potential .",
    "however we repeatedly encountered additional complexity , for example in the form of multiple free parameters that needed fixing , without a corresponding gain in performance . perhaps with further work those drawbacks can be alleviated , or performance can be improved . for now , we believe that it is useful to document one method that we have found to be both simple and effective .",
    "the softkiller method involves eliminating particles below some @xmath1 cutoff , @xmath2 , chosen to be the minimal value that ensures that @xmath0 is zero . here , @xmath0 is the event - wide estimate of transverse - momentum flow density in the area ",
    "median approach  @xcite : the event is broken into patches and @xmath0 is taken as the median , across all patches , of the transverse - momentum flow density per unit area in rapidity - azimuth : @xmath3 where @xmath4 and @xmath5 are respectively the transverse momentum and area of patch @xmath6 . in the original formulation of the area  median method , the patches were those obtained by running inclusive @xmath7 clustering  @xcite , but subsequently it was realised that it was much faster and equally effective to use ( almost ) square patches of size @xmath8 in the rapidity - azimuth plane .",
    "that will be our choice here .",
    "the use of the median ensures that hard jets do not overly bias the @xmath0 estimate ( as quantified in  ref .",
    "@xcite ) .. ]    .,title=\"fig:\",scaledwidth=48.0% ] .,title=\"fig:\",scaledwidth=48.0% ]    choosing the minimal transverse momentum threshold , @xmath9 , that results in @xmath10 is equivalent to gradually raising the @xmath1 threshold until exactly half of the patches contain no particles , which ensures that the median is zero .",
    "this is illustrated in fig .",
    "[ fig : sk - illustration ] .",
    "computationally , @xmath9 is straightforward to evaluate : one determines , for each patch @xmath6 , the @xmath1 of the hardest particle in that patch , @xmath11 and then @xmath12 is given by the median of @xmath11 values : @xmath13 with this choice , half the patches will contain only particles that have @xmath14 .",
    "these patches will be empty after application of the @xmath1 threshold , leading to a zero result for @xmath0 as defined in eq .",
    "( [ eq : rho - median - no - rap ] ) . threshold to individual particles is not collinear safe ; in the specific context of pileup removal , we believe that this is not a significant issue , as we discuss in more detail in appendix  [ sec : collinear - safety ] . ] the computational time to evaluate @xmath2 as in eq .",
    "( [ eq : ptmin ] ) scales linearly in the number of particles and the method should be amenable to parallel implementation .    imposing a cut on particles transverse",
    "momenta eliminates most of the pileup particles , and so might reduce the fluctuations in residual pileup contamination from one point to the next within the event .",
    "however , as with other event - wide noise - reducing pileup and underlying - event mitigation approaches , notably the cms heavy - ion method  @xcite ( cf .",
    "the analysis in appendix a.4 of ref .",
    "@xcite ) , the price that one pays for noise reduction is the introduction of biases .",
    "specifically , some particles from pileup will be above @xmath9 and so remain to contaminate the jets , inducing a net positive bias in the jet momenta .",
    "furthermore some particles in genuine hard jets will be lost , because they are below the @xmath9 , inducing a negative bias in the jet momenta .",
    "the jet energy scale will only be correctly reproduced if these two kinds of bias are of similar size , , and since jets tend to have only a few low-@xmath1 particles from the hard scatter , the loss will also be order of @xmath2 . ] so that they largely cancel .",
    "there will be an improvement in the jet resolution if the fluctuations in these biases are modest .",
    "cut applied by the softkiller , displayed as a function of the number of pileup events .",
    "we show results for two different values of the generator minimal @xmath1 for the hard event , @xmath15 .",
    "the solid line is the average @xmath2 value while the dashed lines indicate the one - standard - deviation band .",
    "right : plot of the @xmath1 that is lost when applying a given @xmath1 cut ( the @xmath16 axis ) to the constituents of jets clustered ( anti-@xmath7 , @xmath17 ) from the hard event ( solid lines ) and the residual pileup @xmath1 that remains after applying that same cut to the constituents of circular patches of radius @xmath18 in pure - pileup events ( dashed lines).,title=\"fig:\",scaledwidth=48.0% ]   cut applied by the softkiller , displayed as a function of the number of pileup events .",
    "we show results for two different values of the generator minimal @xmath1 for the hard event , @xmath15 .",
    "the solid line is the average @xmath2 value while the dashed lines indicate the one - standard - deviation band .",
    "right : plot of the @xmath1 that is lost when applying a given @xmath1 cut ( the @xmath16 axis ) to the constituents of jets clustered ( anti-@xmath7 , @xmath17 ) from the hard event ( solid lines ) and the residual pileup @xmath1 that remains after applying that same cut to the constituents of circular patches of radius @xmath18 in pure - pileup events ( dashed lines).,title=\"fig:\",scaledwidth=48.0% ]    figure  [ fig : killer - cut ] shows , on the left , the average @xmath9 value , together with its standard deviation ( dashed lines ) , as a function of the number of pileup interactions , @xmath19 .",
    "the event sample consists of a superposition of @xmath19 zero - bias on one hard dijet event , in 14  tev proton ",
    "proton collisions , all simulated with pythia  8 ( tune 4c )  @xcite .",
    "the underlying event in the hard event has been switched off , and all particles have been made massless , maintaining their @xmath1 , rapidity and azimuth .",
    "for both the area ",
    "median approach and the softkiller ) is subtracted together with the pileup correction , affecting slightly the observed shifts .",
    "keeping massive particles does not affect the sk performance but requires an extra correction for the area ",
    "median subtraction  @xcite .",
    "we therefore use massless particles for simplicity . ]",
    "these are our default choices throughout this paper .",
    "the grid used to determine @xmath9 has a spacing of @xmath20 and extends up to @xmath21 .",
    "one sees that @xmath9 remains moderate , below @xmath22 , even for pileup at the level foreseen for the high - luminosity upgrade of the lhc ( hl - lhc ) , which is expected to reach an average ( poisson - distributed ) number of pileup interactions of @xmath23 .",
    "the right - hand plot shows the two sources of bias : the lower ( solid ) curves , illustrate the bias on the hard jets induced by the loss of genuine hard - event particles below @xmath9 .",
    "jet clustering is performed with the anti-@xmath7 jet algorithm  @xcite with @xmath17 , as implemented in a development version of fastjet  3.1  @xcite .",
    "the three line colours correspond to different jet @xmath1 ranges .",
    "the loss has some dependence on the jet @xmath1 itself , notably for higher values of @xmath9 .",
    "particles in a jet of a given flavour is actually independent of the jet s @xmath1  @xcite . ] in particular it grows in absolute terms for larger jet @xmath1 s , though it decreases relative to the jet @xmath1 . the positive bias from residual pileup particles ( in circular patches of radius @xmath18 at rapidity @xmath24 ) is shown as dashed curves , for three different pileup levels . to estimate the net bias",
    ", one should choose a value for @xmath19 , read the average @xmath9 from the left - hand plot , and for that @xmath9 compare the solid curve with the dashed curve that corresponds to the given @xmath19 . performing this exercise reveals that there is indeed a reasonable degree of cancellation between the positive and negative biases .",
    "based on this observation , we can move forward with a more detailed study of the performance of the method .",
    "cutoffs , rather than dynamically determined ones , is performed in appendix  [ fixed - pt - cutoff ] . ]",
    "for a detailed study of the softkiller method , the first step is to choose the grid spacing @xmath25 so as to break the event into patches .",
    "the spacing @xmath25 is the one main free parameter of the method . the patch - size parameter jet radius . ] is present also for area  median pileup subtraction . there",
    "the exact choice of this parameter is not too critical .",
    "the reason is that the median is quite stable when pileup levels are high : all grid cells are filled , and nearly all are dominated by pileup .",
    "however the softkiller method chooses the @xmath9 so as to obtain a nearly empty event . in this limit ,",
    "the median operation becomes somewhat more sensitive to the grid spacing  @xcite .",
    "[ fig : killer - scan ] considers a range of hard event samples ( different line styles ) and pileup levels ( different colours ) . for each , as a function of the grid spacing @xmath25 , the left - hand plot shows the average , @xmath26 , of the net shift in the jet transverse momentum , @xmath27 while the right - hand plot shows the dispersion , @xmath28 , of that shift from one jet to the next , here normalised to @xmath29 ( right ) .     for different hard - event samples and three different pileup levels (",
    "poisson - distributed with average pileup event multiplicities of @xmath30 ) .",
    "left : average @xmath1 shift ; right : @xmath1 shift dispersion , normalised to @xmath29 for better readability .",
    "results are given for a variety of hard processes and pileup conditions to illustrate robustness .",
    "curves labelled @xmath31 correspond to dijet events , in which one studies only those jets that in the hard event have a transverse momentum greater than @xmath32 . for the @xmath33 sample ,",
    "restricted to fully hadronic decays of the top quarks , the study is limited to jets that have @xmath34 in the hard event . ]",
    "one sees that the average jet @xmath1 shift has significant dependence on the grid spacing @xmath25 .",
    "however , there exists a grid spacing , in this case @xmath35 , for which the shift is not too far from zero and not too dependent either on the hard sample choice or on the level of pileup . in most cases",
    "the absolute value of the shift is within about @xmath22 , the only exception being for the @xmath36 dijet sample , for which the bias can reach up to @xmath37 for @xmath38 .",
    "this shift is , however , still less than the typical best experimental systematic error on the jet energy scale , today of the order of @xmath39 or slightly better  @xcite .",
    "it is not trivial that there should be a single grid spacing that is effective across all samples and pileup levels : the fact that there is can be considered phenomenologically fortuitous .",
    "the value of the grid spacing @xmath25 that minimises the typical shifts is also close to the value that minimises the dispersion in the shifts . that optimal value of @xmath25 is nt identical across event samples , and can also depend on the level of pileup .",
    "however the dispersion at @xmath40 is always close to the actual minimal attainable dispersion for a given sample .",
    "accordingly , for most of the rest of this article , we will work with a grid spacing of @xmath41 .",
    "is adequate as long as jet finding is carried out mostly with jets of radius @xmath42 . later in this section",
    "we will supplement our @xmath17 studies with a discussion of larger jet radii . ]",
    "poisson - distributed pileup events .",
    "we plot the distribution of the shift @xmath43 between the jet @xmath1 after pileup removal and the jet @xmath1 in the hard event alone .",
    "results are compared between the area - median approach and the softkiller . for comparison",
    ", the ( orange ) dash - dotted line corresponds to the situation where no pileup corrections are applied . ]",
    "shift after subtraction , compared to the original jets in the hard event .",
    "right : the corresponding dispersion.,title=\"fig:\",scaledwidth=48.0% ]   shift after subtraction , compared to the original jets in the hard event .",
    "right : the corresponding dispersion.,title=\"fig:\",scaledwidth=48.0% ]    next , let us compare the performance of the softkiller to that of area ",
    "median subtraction .",
    "figure  [ fig : killer - pt - hdiff ] shows the distribution of shift in @xmath1 , for ( hard ) jets with @xmath44 in a dijet sample .",
    "the average number of pileup events is @xmath45 , with a poisson distribution .",
    "one sees that in the softkiller approach , the peak is about @xmath46 higher than what is obtained with the area ",
    "median approach and the distribution correspondingly narrower .",
    "the peak , in this specific case , is well centred on @xmath47 .    figure  [ fig : killer - v - npu ] shows the shift ( left ) and dispersion ( right ) as a function of @xmath19 for two different samples : the @xmath48 dijet sample ( in blue ) , as used in fig .",
    "[ fig : killer - pt - hdiff ] , and a hadronic @xmath33 sample , with a @xmath49 @xmath1 cut on jets ( in green ) .",
    "again , the figure compares the area ",
    "median ( dashed ) and softkiller results ( solid ) .",
    "one immediately sees that the area ",
    "median approach gives a bias that is more stable as a function of @xmath19 .",
    "nevertheless , the bias in the softkiller approach remains between about @xmath50 and @xmath51 , which is still reasonable when one considers that , experimentally , some degree of recalibration is anyway needed after area ",
    "median subtraction . as concerns sample dependence of the shift , comparing @xmath33 v.dijet , the area ",
    "median and softkiller methods appear to have similar systematic differences . in the case of softkiller",
    ", there are two main causes for the sample dependence : firstly the higher multiplicity of jets has a small effect on the choice of @xmath2 and secondly the dijet sample is mostly composed of gluon - induced jets , whereas the @xmath33 sample is mostly composed of quark - induced jets ( which have fewer soft particles and so lose less momentum when imposing a particle @xmath1 threshold ) . turning to the right - hand plot , with the dispersions",
    ", one sees that the the softkiller brings a significant improvement compared to area ",
    "median subtraction for @xmath52 .",
    "the relative improvement is greatest at high pileup levels , where there is a reduction in dispersion of @xmath53 , beating the @xmath54 scaling that is characteristic of the area  median method . while the actual values of the dispersion depend a little on the sample , the benefit of the softkiller approach is clearly visible for both .",
    "( solid lines ) , with a comparison to the area - median subtraction method ( dashed lines ) . left : the average shifts for the jet @xmath1 ( blue ) and mass ( green ) , after subtraction .",
    "right : the corresponding dispersions .",
    ", title=\"fig:\",scaledwidth=48.0% ]   ( solid lines ) , with a comparison to the area - median subtraction method ( dashed lines ) . left : the average shifts for the jet @xmath1 ( blue ) and mass ( green ) , after subtraction .",
    "right : the corresponding dispersions .",
    ", title=\"fig:\",scaledwidth=48.0% ]    figure  [ fig : killer - v - pt ] shows the shift ( left ) and dispersion ( right ) for jet @xmath1 s and jet masses , now as a function of the hard jet minimum @xmath1 .",
    "again , dashed curves correspond to area  median subtraction , while solid ones correspond to the softkiller results .",
    "all curves correspond to an average of @xmath55 pileup interactions .",
    "for the jet @xmath1 ( blue curves ) one sees that the area ",
    "median shift ranges from @xmath56 to @xmath57 as @xmath1 increases from @xmath58 to @xmath59 , while for sk the dependence is stronger , from about @xmath60 to @xmath61 , but still reasonable . for the jet mass ( green curves ) , again the area ",
    "median method is more stable than sk , but overall the biases are under control , at the @xmath62 to @xmath22 level . considering the dispersions ( right )",
    ", one sees that sk gives a systematic improvement , across the whole range of jet @xmath1 s . in relative terms , the improvement is somewhat larger for the jet mass ( @xmath63 ) than for the jet @xmath1 ( @xmath64 ) .     events .",
    ", title=\"fig:\",scaledwidth=48.0% ]   events . ,",
    "title=\"fig:\",scaledwidth=48.0% ]    fig .",
    "[ fig : mass - spectra ] shows the actual mass spectra of @xmath17 jets , for two samples : a qcd dijet sample and a boosted @xmath33 sample . for both samples , we only considered jets with @xmath65 in the hard event .",
    "one sees that sk gives slightly improved mass peaks relative to the area ",
    "median method and also avoids area ",
    "median s spurious peak at @xmath66 , which is due to events in which the squared jet mass came out negative after four - vector area - subtraction and so was reset to zero .",
    "the plot also shows results from the recently proposed constituent subtractor method  @xcite , using v.  1.0.0 of the corresponding code from fastjet contrib  @xcite .",
    "it too performs better than area ",
    "median subtraction for the jet mass , though the improvement is not quite as large as for sk . of @xmath67 has been subtracted .",
    "this shows performance similar to that of the constituent subtractor . ]",
    "the left - hand plot is without grooming , the right - hand plot with grooming ( trimming  @xcite with @xmath68 and @xmath69 ) .",
    ", title=\"fig:\",scaledwidth=48.0% ]   jets .",
    "the left - hand plot is without grooming , the right - hand plot with grooming ( trimming  @xcite with @xmath68 and @xmath69 ) . ,",
    "title=\"fig:\",scaledwidth=48.0% ]    one might ask why we concentrated on @xmath17 jets here , given that jet - mass studies often use large-@xmath70 jets .",
    "the reason is that large-@xmath70 jets are nearly always used in conjunction with some form of grooming , for example trimming , pruning or filtering  @xcite .",
    "grooming reduces the large - radius jet to a collection of small - radius jets and so the large - radius groomed - jet mass is effectively a combination of the @xmath1 s and masses of one or more small - radius jets .    for the sake of completeness ,",
    "let us briefly also study the softkiller performance for large-@xmath70 jets .",
    "figure  [ fig : large - r ] shows jet - mass results for the same @xmath33 sample as in fig .  [ fig : mass - spectra ] ( right ) , now clustered with the anti-@xmath7 algorithm with @xmath71 .",
    "the left - hand plot is without grooming : one sees that sk with our default spacing of @xmath41 gives a jet mass that has better resolution than area  median subtraction ( or the constituentsubtractor ) , but a noticeable shift , albeit one that is small compared to the effect of uncorrected pileup .",
    "that shift is associated with some residual contamination from pileup particles : in an @xmath17 jet , there are typically a handful of particles left from pileup , which compensate low-@xmath1 particles lost from near the core of the jet . if one substantially increases the jet radius without applying grooming , then that balance is upset , with substantially more pileup entering the jet , while there is only slight further loss of genuine jet @xmath1 .",
    "to some extent this can be addressed by using the softkiller with a larger grid spacing ( cf .  the @xmath72 result ) , which effectively increases the particle @xmath2 .",
    "this comes at the expense of performance on small-@xmath70 jets ( cf.fig .",
    "[ fig : killer - scan ] ) .",
    "an interesting , open problem is to find a simple way to remove pileup from an event such that , for a single configuration of the pileup removal procedure , one simultaneously obtains good performance on small-@xmath70 and large-@xmath70 jets .",
    "threshold could be made to depend on a particle s distance from the nearest jet core ; however this then requires additional parameters to define what is meant by a nearby jet core and to parametrise the distance - dependence of the @xmath1 cut . ]    as we said above , however , large-@xmath70 jet masses are nearly always used in conjunction with some form of grooming . fig .",
    "[ fig : large - r ] ( right ) shows that when used together with trimming  @xcite , softkiller with our default @xmath41 choice performs well both in terms of resolution and shift .",
    "cut on anti-@xmath7 , @xmath17 jets . for comparison of the subtraction performance we also quote , for each observable @xmath32 , @xmath73 , the dispersion of the distribution of the observable in the hard event . for @xmath74",
    "there is the additional requirement ( in the hard event ) that the jet mass is above 30 gev and for @xmath75 we further impose that @xmath76 ( again in the hard event ) , so as to ensure infrared safety .",
    "[ fig : shape - stats ] ]    returning to @xmath17 jets , the final figure of this section , fig .",
    "[ fig : shape - stats ] , shows average shifts ( left ) and dispersions ( right ) as a function of @xmath19 for several different jet `` shapes '' : jet masses , @xmath7 clustering scales  @xcite , the jet width ( or broadening or girth  @xcite ) , an energy - energy correlation moment  @xcite and the @xmath77 and @xmath78 n - subjettiness ratios  @xcite , using the exclusive @xmath7 axes with one - pass of minimisation . except in the case of the jet mass ( which uses `` safe '' area subtraction , as mentioned above ) , the area ",
    "median results have been obtained using the shape subtraction technique  @xcite , as implemented in v.  1.2.0 of the genericsubtractor in fastjet contrib .",
    "as regards the shifts , the sk approach is sometimes the best , other times second best .",
    "which method fares worst depends on the precise observable . in all cases ,",
    "when considering the dispersions , it is the sk that performs best , though the extent of the improvement relative to other methods depends strongly on the particular observable .",
    "overall this figure gives us confidence that one can use the softkiller approach for a range of properties of small - radius jets .",
    "it is important to verify that a new pileup mitigation method works not just at particle level , but also at detector level .",
    "there are numerous subtleties in carrying out detector - level simulation , from the difficulty of correctly treating the detector response to low-@xmath1 particles , to the reproduction of actual detector reconstruction methods and calibrations , and even the determination of which observables to use as performance indicators . here",
    "we will consider two cases : idealised charged - hadron - subtraction , which simply examines the effect of discarding charged pileup particles ; and simple calorimeter towers .    for events with particle flow  @xcite and charged - hadron subtraction ( chs ) ,",
    "we imagine a situation in which all charged particles can be unambiguously associated either with the leading vertex or with a pileup vertex .",
    "we then apply the sk exclusively to the neutral particles , which we assume to have been measured exactly .",
    "this is almost certainly a crude approximation , however it helps to illustrate some general features .    , for events with charged - hadron subtraction ( chs ) .",
    "note that the grid size used for the softkiller curves has been set to @xmath79.,title=\"fig:\",scaledwidth=48.0% ] , for events with charged - hadron subtraction ( chs ) .",
    "note that the grid size used for the softkiller curves has been set to @xmath79.,title=\"fig:\",scaledwidth=48.0% ]    one important change that arises from applying sk just to the neutral particles is that there is a reduced contribution of low-@xmath1 hard - event particles .",
    "this means that for a given actual amount of pileup contamination ( in terms of visible transverse momentum per unit area ) , one can afford to cut more aggressively , i.e.  raise the @xmath9 as compared to the full particle - level case , because for a given @xmath9 there will be a reduced loss of hard - event particles .",
    "this can be achieved through a moderate increase in the grid spacing , to @xmath79 .",
    "figure  [ fig : chs - performance ] shows the results , with the shift ( left ) and dispersion ( right ) for the jet @xmath1 in dijet and @xmath33 samples .",
    "the sk method continues to bring an improvement , though that improvement is slightly more limited than in the particle - level case .",
    "we attribute this reduced improvement to the fact that sk s greatest impact is at very high pileup , and for a given @xmath80 , sk with chs is effectively operating at lower pileup levels than without chs .",
    "next let us turn to events where the particles enter calorimeter towers .",
    "here we encounter the issue , discussed also in appendix  [ sec : collinear - safety ] , that sk is not collinear safe .",
    "while we argue there that this is not a fundamental drawback from the point of view of particle - level studies , there are issues at calorimeter level : on one hand a single particle may be divided between two calorimeter towers ( we wo nt attempt to simulate this , as it is very sensitive to detector details ) ; on the other , within a given tower ( say @xmath81 ) it is quite likely that for high pileup the tower may receive contributions from multiple particles . in particular ,",
    "if a tower receives contributions from a hard particle with a substantial @xmath1 and additionally from pileup particles , the tower will always be above threshold , and the pileup contribution will never be removed .",
    "there are also related effects due to the fact that two pileup particles may enter the same tower . to account for the fact that towers have finite area , we therefore adapt the sk as follows . in a first step",
    "we subtract each tower : @xmath82 where @xmath0 is as determined on the event prior to any correction . , namely the grid version of the area ",
    "median method , with a grid spacing of @xmath83 and rapidity scaling as discussed in appendix  [ sec : rap - dep ] .",
    "one could equally well use the same grid spacing for the @xmath0 determination as for the softkiller . ]",
    "this in itself eliminates a significant fraction of pileup , but there remains a residual contribution from the roughly @xmath84 of towers whose @xmath1 was larger than @xmath85 .",
    "we then apply the softkiller to the subtracted towers , @xmath86 where @xmath87 is the @xmath1 , after subtraction , of the hardest tower in patch @xmath6 , in analogy with eq .",
    "( [ eq : ptmin ] ) . in the limit of infinite granularity ,",
    "a limit similar to particle level , @xmath88 .",
    "the step in eq .",
    "then has no effect and one recovers the standard softkiller procedure applied to particle level .     for events with a simple calorimeter simulation .",
    "the softkiller was used here with a grid spacing of @xmath89 and includes the tower subtraction of eq .",
    "( [ eq : tower - correction]).,title=\"fig:\",scaledwidth=48.0% ]   for events with a simple calorimeter simulation .",
    "the softkiller was used here with a grid spacing of @xmath89 and includes the tower subtraction of eq .",
    "( [ eq : tower - correction]).,title=\"fig:\",scaledwidth=48.0% ]    results are shown in fig .",
    "[ fig : calo - performance ] .",
    "the energy @xmath90 in each @xmath91 tower is taken to have gaussian fluctuations with relative standard deviation @xmath92 .",
    "a @xmath1 threshold of @xmath93 is applied to each tower after fluctuations .",
    "the sk grid spacing is set to @xmath94 .",
    "interestingly , with a calorimeter , the area ",
    "median method starts to have significant biases , of a couple of gev , which can be attributed to the calorimeter s non - linear response to soft energy .",
    "the sk biases are similar in magnitude to those in fig .",
    "[ fig : killer - v - npu ] at particle level ( note , however , the need for a different choice of grid spacing @xmath25 ) .",
    "the presence of a calorimeter worsens the resolution both for area - median subtraction and sk , however sk continues to perform better , even if the improvement relative to area  median subtraction is slightly smaller than for the particle - level results .",
    "we have also investigated a direct application of the particle - level softkiller approach to calorimeter towers , i.e.  without the subtraction in eq .",
    "( [ eq : tower - correction ] ) . we find that the biases were larger but still under some degree of control with an appropriate tuning of @xmath25 , while the performance on dispersion tends to be intermediate between that of area ",
    "median subtraction and the version of softkiller with tower subtraction .",
    "the above results are not intended to provide an exhaustive study of detector effects .",
    "for example , particle flow and chs are affected by detector fluctuations , which we have ignored ; purely calorimetric jet measurements are affected by the fact that calorimeter towers are of different sizes in different regions of the detector and furthermore may be combined non - trivially through topoclustering .",
    "nevertheless , our results help illustrate that it is at least plausible that the softkiller approach could be adapted to a full detector environment while retaining much of its performance advantage relative to the area  median method .",
    "the computation time for the softkiller procedure has two components : the assignment of particles to patches , which is @xmath95 , i.e.linear in the total number of particles @xmath96 and the determination of the median , which is @xmath97 where @xmath98 is the number of patches .",
    "the subsequent clustering is performed with a reduced number of particles , @xmath99 , which , at high pileup is almost independent of the number of pileup particles in the original event . in this limit , the procedure is therefore expected to be dominated by the time to assign particles to patches , which is linear in @xmath96 .",
    "this assignment is almost certainly amenable to being parallelised .    in studying the timing , we restrict our attention to particle - level events for simplicity .",
    "we believe that calorimeter - type extensions as described in section  [ sec : adapt - calor - towers ] can be coded in such a way as to obtain similar ( or perhaps even better ) performance .",
    "timings are shown in fig .",
    "[ fig : timing ] versus initial multiplicity ( left ) and versus the number of pileup vertices ( right ) .",
    "each plot shows the time needed to cluster the full event and the time to cluster the full event together with ghosts ( as needed for area - based subtraction ) .",
    "it also shows the time to run the softkiller procedure , the time to cluster the resulting event , and the total time for sk plus clustering .",
    "overall , one sees nearly two orders of magnitude improvement in speed from the sk procedure , with run times per event ranging from @xmath100 to @xmath101ms as compared to @xmath102 to @xmath103ms for clustering with area information . at low multiplicities ,",
    "the time to run sk is small compared to that needed for the subsequent clustering . as the event multiplicity increases , sk has the effect of limiting the event multiplicity to about @xmath104 particles , nearly independently of the level of pileup and so the clustering time saturates .",
    "however the time to run sk grows and comes to dominate over the clustering time .",
    "asymptotically , the total event processing time then grows linearly with the level of pileup . a significant part of that time ( about @xmath105 per particle , 75% of the run - time at high multiplicity ) is taken by the determination of the particles rapidity and azimuth in order to assign them to a grid cell .",
    "if the particles rapidity and azimuth are known before applying the softkiller to an event ( as it would be the case e.g. for calorimeter towers ) , the computing time to apply the softkiller would be yet faster , as indicated by the dotted orange line on fig .",
    "[ fig : timing ] .",
    "because of its large speed improvement , the softkiller method has significant potential for pileup removal at the trigger level .",
    "since softkiller returns an event with fewer particles , it will have a speed performance edge also in situations where little or no time is spent in jet - area calculations ( either because voronoi areas or fast approximate implementations are used ) .",
    "this can be seen in fig .",
    "[ fig : timing ] by comparing the green and the solid blue curves .",
    "the softkiller method appears to bring significant improvements in pileup mitigation performance , in particular as concerns the jet energy resolution , whose degradation due to pileup is reduced by @xmath106 relative to the area ",
    "median based methods . as an example , the performance that is obtained with area ",
    "median subtraction for 70 pileup events can be extended to 140 pileup events when using softkiller .",
    "this sometimes comes at the price of an increase in the biases on the jet @xmath1 , however these biases still remain under control .",
    "since the method acts directly on an event s particles , it automatically provides a correction for jet masses and jet shapes , and in all cases that we have studied brings a non - negligible improvement in resolution relative to the shape subtraction method , and also ( albeit to a lesser extent ) relative to the recently proposed constituent subtractor approach .",
    "the method is also extremely fast , bringing nearly two orders of magnitude speed improvement over the area ",
    "median method for jet @xmath1 s .",
    "this can be advantageous both in time - critical applications , for example at trigger level , and in the context of fast detector simulations .",
    "there remain a number of open questions .",
    "it would be of interest to understand , more quantitatively , why such a simple method works so well and what dictates the optimal choice of the underlying grid spacing .",
    "this might also bring insight into how to further improve the method .",
    "in particular , the method is known to have deficiencies when applied to large-@xmath70 ungroomed jets , which would benefit from additional study .",
    "finally , we have illustrated that in simple detector simulations it is possible to reproduce much of the performance improvement seen at particle level , albeit at the price of a slight adaption of the method to take into account the finite angular resolution of calorimeters .",
    "these simple studies should merely be taken as indicative , and we look forward to proper validation ( and possible further adaptation ) taking into account full detector effects .",
    "* note added : * as this work was being completed , we became aware of the development of another particle - level pileup removal method , puppi  @xcite .",
    "initial particle - level comparisons at the 2014 pileup workshop  @xcite suggest that both bring comparable improvements .",
    "we are grateful to phil harris , peter loch , david miller , filip moortgat , ariel schwartzman , and many others , for stimulating conversations on pileup removal .",
    "we are especially grateful to filip moortgat for his comments on the manuscript .",
    "this work was supported by erc advanced grant higgs@lhc , by the french agence nationale de la recherche , under grant anr-10-cexc-009 - 01 and by the eu itn grant lhcphenonet , pitn - ga-2010 - 264564 and by the ilp labex ( anr-10-labx-63 ) supported by french state funds managed by the anr within the investissements davenir programme under reference anr-11-idex-0004 - 02 .",
    "gps and gs wish to thank princeton university and cern , respectively , for hospitality while this work was being carried out .",
    "collinear safety is normally essential in order to get reliable results from perturbation theory .",
    "one reaction to the softkiller proposal is that it is not collinear safe , because it relies only on information about individual particles transverse momenta .",
    "there are at least two perspectives on why this is not a severe issue .",
    "the first relates to the intrinsic low-@xmath1 nature of the @xmath9 , which is typically of order @xmath107 . at these scales ,",
    "non - perturbative dynamics effectively regulates the collinear divergence .",
    "consider one element of the hadronisation process , namely resonance decay , specifically @xmath108 : if the @xmath0 has a @xmath1 of order @xmath22 , the rapidity - azimuth separation of the two pions is of the order of @xmath109 ( see e.g.  ref .",
    "@xcite ) . alternatively , consider the emission from a high - energy parton of a gluon with a @xmath1 of the order of @xmath110 : this gluon can only be considered perturbative if its transverse momentum relative to the emitter is at least of order a gev , i.e.  if it has an angle relative to the emitted of order @xmath62 .",
    "both these examples illustrate that the collinear divergence that is of concern at parton level is smeared by non - perturbative effects when considering low-@xmath1 particles .",
    "furthermore , the impact of these effects on the jet @xmath1 will remain of the order of @xmath2 , i.e.  power - suppressed with respect to the scale of hard physics .",
    "the second perspective is from the strict point of view of perturbative calculations .",
    "one would not normally apply a pileup reduction mechanism in such a context .",
    "but it is conceivable that one might wish to _ define _ the final state such that it always includes a pileup and underlying event ( ue ) removal procedure",
    ". then one should understand the consequences of applying the method at parton level .",
    "considering patches of size @xmath111 and particles with @xmath112 , there are a total of 120 patches ; only when the perturbative calculation has at least @xmath55 particles , i.e.  attains order @xmath113 , can @xmath9 be non - zero ; so the collinear safety issue would enter at an inconceivably high order , and all practical fixed - order parton - level calculations would give results that are unaffected by the procedure .",
    "collinear safety , as well as being important from a theoretical point of view , also has experimental relevance : for example , depending on its exact position , a particle may shower predominantly into one calorimeter tower or into two .",
    "collinear safety helps ensure that results are independent of these details . while we carried out basic detector simulations in section  [ sec : adapt - calor - towers ] , a complete study of the impact of this type of effect would require full simulation and actual experimental reconstruction methods ( e.g.  particle flow or topoclustering ) .",
    "one issue with the area  median method is that a global @xmath0 determination fails to account for the substantial rapidity dependence of the pileup contamination .",
    "accordingly , the method is often extended by introducing an a - priori determined function @xmath114 that encodes the shape of the pileup s dependence on rapidity @xmath115 , @xmath116 this is the approach that we have used throughout this paper .. ] the rapidity dependence of @xmath0 , shown as the dashed lines in fig .",
    "[ fig : rapidity - dep ] ( left ) , is substantial and therefore we account for it through rescaling .",
    "the figure shows two different tunes ( 4c and monash  2013 ) , illustrating the fact that they have somewhat different rapidity dependence .",
    "density per unit area ( @xmath117 ) , and of the average @xmath1 per particle ( scaled by a factor of @xmath60 for readability ) , comparing pythia8 s 4c and monash  2013  @xcite tunes .",
    "right : the average shift in jet @xmath1 as a function of rapidity for the area ",
    "median method with rapidity rescaling ( default in this paper ) , without rapidity rescaling , and for the softkiller as used throughout this paper , i.e.  without rapidity rescaling.,title=\"fig:\",scaledwidth=48.0% ]    density per unit area ( @xmath117 ) , and of the average @xmath1 per particle ( scaled by a factor of @xmath60 for readability ) , comparing pythia8 s 4c and monash  2013  @xcite tunes .",
    "right : the average shift in jet @xmath1 as a function of rapidity for the area ",
    "median method with rapidity rescaling ( default in this paper ) , without rapidity rescaling , and for the softkiller as used throughout this paper , i.e.  without rapidity rescaling.,title=\"fig:\",scaledwidth=48.0% ]    the softkiller method acts not on the average energy flow , but instead on the particle @xmath1 s .",
    "the solid lines in fig .",
    "[ fig : rapidity - dep ] ( left ) show that the average particle @xmath1 is nearly independent of rapidity .",
    "this suggests that there may not be a need to explicitly account for rapidity in the sk method , at least at particle level ( detector effects introduce further non - trivial rapidity dependence ) .",
    "this is confirmed in the right - hand plot of fig .",
    "[ fig : rapidity - dep ] , which shows the rapidity - dependence of the shift in the jet @xmath1 with the area  median and sk methods . our default area ",
    "median curve , which includes rapidity rescaling , leads to a nearly rapidity - independent shift .",
    "however , without the rapidity rescaling , there are instead rapidity - dependent shifts of up to @xmath118 at high pileup . in contrast , the sk method , which in our implementation does not involve any parametrisation of rapidity dependence , automatically gives a jet @xmath1 shift that is fairly independent of rapidity , to within about @xmath22 . we interpret this as a consequence of the fact ( cf .  the left - hand plot of fig .",
    "[ fig : rapidity - dep ] ) that the average particle @xmath1 appears to be far less dependent on rapidity than the average @xmath1 flow . )",
    ", one could also imagine introducing a rapidity - dependent rescaling of the particle @xmath1 s before applying softkiller , and then inverting the rescaling afterwards .",
    "our initial tests of this approach suggest that it does largely correct for the residual sk rapidity dependence . ]",
    "cut . the average shift ( left ) and its dispersion ( right )",
    "are shown as a function of @xmath80 for dijet events , with a hard jet cut of @xmath44 . , title=\"fig:\",scaledwidth=48.0% ]      one key aspect of the softkiller approach is not simply that it applies a @xmath1 cutoff , but rather that there is a straightforward dynamical way of determining a @xmath1 cutoff , on an event - by - event basis , that removes the bulk of the effects of pileup with modest biases and improved dispersion .    for completeness ,",
    "it is interesting to compare its performance to that of a fixed @xmath1 cut .",
    "figure  [ fig : fixed - pt - cut ] shows the shifts ( left ) and dispersions ( right ) , as a function of @xmath80 , as obtained for the area ",
    "median method , the softkiller , and three fixed particle - level @xmath2 values , @xmath110 , @xmath51 and @xmath22 . for each of these fixed @xmath2 values",
    ", there is a value of @xmath120 for which the shift in jet @xmath1 is zero , respectively @xmath121 , @xmath55 and @xmath122 .",
    "however , as soon as one moves away from that particular @xmath120 value , large biases appear . around the @xmath120 that has zero bias for a given fixed @xmath2 ,",
    "the dispersion of the @xmath1 shift is quite close to that obtained in the softkiller approach .",
    "however , away from that @xmath120 value , the dispersion becomes somewhat worse .",
    "overall , therefore , the softkiller approach works noticeably better than any fixed cut .",
    "one further study that we have carried out is to parametrise the average @xmath2 shown in fig .",
    "[ fig : killer - cut ] ( left ) as a function of @xmath120 , and to apply a @xmath2 that is chosen event - by - event according to that event s actual value of @xmath120 .",
    "we have found that this has performance that is similar to that of the softkiller , i.e.  softkiller s slight event - by - event adaptation of the @xmath2 for a fixed @xmath120 ( represented by the 1-@xmath123 dashed lines in fig .",
    "[ fig : killer - cut ] ( left ) ) does not appear to be critical to its success .",
    "this suggests that any approach that chooses an @xmath120-dependent @xmath2 so as to give a near - zero average @xmath1 shift may yield performance on dispersions that is similar to that of softkiller . from this point of view",
    ", softkiller provides an effective heuristic for the dynamic determination of the @xmath2 value .",
    "high luminosity lhc upgrade , http://cern.ch/hl-lhc ; see also d.  abbaneo _ et al .",
    "_ , proceedings of `` ecfa high luminosity lhc experiments workshop : physics and technology challenges , '' https://cds.cern.ch/record/1631032[ecfa-13-284 ] .",
    "cms collaboration , `` particle - flow event reconstruction in cms and performance for jets , taus , and met , '' cms - pas - pft-09 - 001 .",
    "the atlas collaboration , `` pile - up subtraction and suppression for jets in atlas , '' http://inspirehep.net/record/1260963/files/atlas-conf-2013-083.pdf[atlas-conf-2013-083 ] .",
    "cms collaboration , `` jet energy scale performance in 2011 , '' http://inspirehep.net/record/1230033/files/dp2012_006.pdf[cms-dp-2012-006 ] .",
    "m.  cacciari and g.  p.  salam , phys .",
    "b * 659 * ( 2008 ) 119 [ arxiv:0707.1378 [ hep - ph ] ] .",
    "m.  cacciari , g.  p.  salam and g.  soyez , jhep * 0804 * ( 2008 ) 005 [ arxiv:0802.1188 [ hep - ph ] ] .",
    "a.  altheimer , a.  arce , l.  asquith , j.  backus mayes , e.  bergeaas kuutmann , j.  berger , d.  bjergaard and l.  bryngemark _ et al .",
    "_ , arxiv:1311.2708 [ hep - ex ] .",
    "p.  loch , `` topoclustering pileup suppression , '' + http://indico.cern.ch/event/306155/session/2/contribution/10/material/slides/0.pdf    d.  e.  soper and m.  spannowsky , phys",
    ".  rev .",
    "d * 84 * ( 2011 ) 074002 [ arxiv:1102.3480 [ hep - ph ] ] ; + d.  e.  soper and m.  spannowsky , arxiv:1402.1189 [ hep - ph ] .",
    "p.  berta , m.  spousta , d.  w.  miller and r.  leitner , jhep * 1406 * ( 2014 ) 092 [ arxiv:1403.3108 [ hep - ex ] ] .",
    "m.  cacciari , j.  rojo , g.  p.  salam and g.  soyez , jhep * 0812 * ( 2008 ) 032 [ arxiv:0810.1304 [ hep - ph ] ] .",
    "d.  krohn , m.  low , m.  d.  schwartz and l .- t .",
    "wang , arxiv:1309.4777 [ hep - ph ] .",
    "m.  cacciari , g.  p.  salam and g.  soyez , arxiv:1404.7353 [ hep - ph ] .",
    "et al _ , `` study of @xmath124+jet channel in heavy ion collisions with cms , '' cms - note-1998 - 063 ; + v.  gavrilov , a.  oulianov , o.  kodolova and i.  vardanian , `` jet reconstruction with pileup subtraction , '' cms - rn-2003 - 004 ; + o.  kodolova , i.  vardanian , a.  nikitenko and a.  oulianov , eur .",
    "j.  c * 50 * ( 2007 ) 117 .",
    "m.  cacciari , g.  p.  salam and s.  sapeta , jhep * 1004 * ( 2010 ) 065 [ arxiv:0912.4926 [ hep - ph ] ] .",
    "m.  cacciari , g.  p.  salam and g.  soyez , eur .",
    "j.  c * 71 * ( 2011 ) 1692 [ arxiv:1101.2878 [ hep - ph ] ] .",
    "t.  sjostrand , s.  mrenna and p.  z.  skands , comput .",
    "commun .   * 178 * ( 2008 ) 852 [ arxiv:0710.3820 [ hep - ph ] ] .",
    "g.  soyez , g.  p.  salam , j.  kim , s.  dutta and m.  cacciari , phys .",
    "* 110 * ( 2013 ) 16 , 162001 [ arxiv:1211.2811 [ hep - ph ] ] .",
    "m.  cacciari , g.  p.  salam and g.  soyez , jhep * 0804 * ( 2008 ) 063 [ arxiv:0802.1189 [ hep - ph ] ] .",
    "m.  cacciari and g.  p.  salam , phys .",
    "b * 641 * ( 2006 ) 57 [ hep - ph/0512210 ] .",
    "m.  cacciari , g.  p.  salam and g.  soyez , eur .",
    "j.  c * 72 * ( 2012 ) 1896 [ arxiv:1111.6097 [ hep - ph ] ] .",
    "v.  a.  khoze , s.  lupia and w.  ochs , eur .",
    "j.  c * 5 * ( 1998 ) 77 [ hep - ph/9711392 ] .",
    "h.  kirschenmann [ cms collaboration ] , j.  phys .",
    "* 404 * ( 2012 ) 012013 .",
    "g.  aad _ et al . _ [ atlas collaboration ] , arxiv:1406.0076 [ hep - ex ] .",
    "fastjet contrib , http://fastjet.hepforge.org/contrib  .",
    "s.  d.  ellis , c.  k.  vermilion and j.  r.  walsh , phys .",
    "d * 80 * ( 2009 ) 051501 [ arxiv:0903.5081 [ hep - ph ] ] .",
    "j.  m.  butterworth , a.  r.  davison , m.  rubin and g.  p.  salam , phys .",
    "* 100 * ( 2008 ) 242001 [ arxiv:0802.2470 [ hep - ph ] ] .",
    "s.  catani , g.  turnock and b.  r.  webber , phys .",
    "b * 295 * ( 1992 ) 269 . c.  f.  berger , t.  kucs and g.  f.  sterman , phys .",
    "d * 68 * ( 2003 ) 014012 [ hep - ph/0303051 ] .",
    "l.  g.  almeida , s.  j.  lee , g.  perez , g.  f.  sterman , i.  sung and j.  virzi , phys .",
    "d * 79 * ( 2009 ) 074017 [ arxiv:0807.0234 [ hep - ph ] ] .",
    "a.  j.  larkoski , g.  p.  salam and j.  thaler , jhep * 1306 * ( 2013 ) 108 [ arxiv:1305.0007 [ hep - ph ] ] .",
    "j.  thaler and k.  van tilburg , jhep * 1103 * ( 2011 ) 015 [ arxiv:1011.2268 [ hep - ph ] ] ; jhep * 1202 * ( 2012 ) 093 [ arxiv:1108.2701 [ hep - ph ] ] .",
    "d.  bertolini , p.  harris , m.  low , n.  tran , puppi , + https://indico.cern.ch/event/306155/session/0/contribution/4/material/slides/0.pdf ."
  ],
  "abstract_text": [
    "<S> existing widely - used pileup removal approaches correct the momenta of individual jets . in this article </S>",
    "<S> we introduce an event - level , particle - based pileup correction procedure , softkiller . </S>",
    "<S> it removes the softest particles in an event , up to a transverse momentum threshold that is determined dynamically on an event - by - event basis . in simulations </S>",
    "<S> , this simple procedure appears to be reasonably robust and brings superior jet resolution performance compared to existing jet - based approaches . </S>",
    "<S> it is also nearly two orders of magnitude faster than methods based on jet areas .    </S>",
    "<S> cern - ph - th/2014 - 116 + july 2014 </S>"
  ]
}