{
  "article_text": [
    "given a sample @xmath0 ( where @xmath5 are from a finite alphabet @xmath6 ) which is known to be generated by a stationary ergodic process , we wish to decide whether it was generated by a distribution belonging to a family @xmath1 , versus it was generated by a distribution belonging to a family @xmath2 . unlike most of the works on the subject",
    ", we do not assume that @xmath5 are i.i.d .",
    ", but only make a much weaker assumption that the distribution generating the sample is stationary ergodic .    a test is a function that takes a sample and gives a binary ( possibly incorrect ) answer : the sample was generated by a distribution from @xmath1 or from @xmath2 .",
    "an answer @xmath7 is correct if the sample is generated by a distribution that belongs to @xmath8 .",
    "here we are concerned with characterizing those pairs of @xmath1 and @xmath2 for which consistent tests exist",
    ".    * consistency . * in this work we consider the following notion of consistency . for two hypothesis @xmath1 and @xmath2 , a test is called _ uniformly consistent _",
    ", if for any @xmath9 there is a sample size @xmath4 such that the _ probability of error on a sample of size larger than @xmath4 is not greater than @xmath3 if any distribution from @xmath10 is chosen to generate the sample_. thus , a uniformly consistent test provides performance guarantees for finite sample sizes .",
    "* the results . * here we obtain some topological conditions of the hypotheses for which consistent tests exist , for the case of stationary ergodic distributions .    a distributional distance between two process distributions",
    "is defined as a weighted sum of probabilities of all possible tuples @xmath11 , where @xmath6 is the alphabet and the weights are positive and have a finite sum .",
    "the test @xmath12 that we construct is based on empirical estimates of distributional distance .",
    "it outputs @xmath13 if the given sample is closer to the ( closure of ) @xmath1 than to the ( closure of ) @xmath2 , and outputs 1 otherwise .",
    "the main result is as follows",
    ".    * theorem .",
    "* let @xmath14 , where @xmath15 is the set of all stationary ergodic process distributions .",
    "if , for each @xmath7 the set @xmath8 has probability 1 with respect to ergodic decompositions of every element of @xmath8 , then there is a uniformly consistent test for @xmath1 against @xmath2 .",
    "conversely , if there is a uniformly consistent test for @xmath1 against @xmath2 , then , for each @xmath7 , the set @xmath16 has probability 0 with respect to ergodic decompositions of every element of @xmath8 .",
    "* prior work .",
    "* this work continuous our previous research @xcite , which provides similar necessary and sufficient conditions for the existence of a consistent test , for a weaker notion of _ asymmetric _ consistency : type i error is uniformly bounded , while type ii error is required to tend to 0 as the sample size grows .",
    "besides that , there is of course a vast body of literature on hypothesis testing for i.i.d .",
    "( real- or discrete - valued ) data ( see e.g. @xcite ) .",
    "there is , however , much less literature on hypothesis testing beyond i.i.d . or parametric models . for a weaker notion of consistency , namely , requiring that the test should stabilize on the correct answer for a.e .",
    "realization of the process ( under either @xmath1 or @xmath2 ) , @xcite constructs a consistent test for so - called constrained finite - state model classes ( including finite - state markov and hidden markov processes ) , against the general alternative of stationary ergodic processes . for the same notion of consistency",
    ", @xcite gives sufficient conditions on two hypotheses @xmath1 and @xmath2 that consist of stationary ergodic real - valued processes , under which a consistent test exists , extending the results of  @xcite for i.i.d . data .",
    "the latter condition is that @xmath1 and @xmath2 are contained in disjoint @xmath17 sets ( countable unions of closed sets ) , with respect to the topology of weak convergence .",
    "asymmetrically consistent tests for some specific hypotheses , but under the general alternative of stationary ergodic processes , have been proposed in @xcite , which address problems of testing identity , independence , estimating the order of a markov process , and also the change point problem .",
    "noteworthy , a conceptually simple hypothesis of homogeneity ( testing whether two sample are generated by the same or by different processes ) does not admit a consistent test even in the weakest asymptotic sense , as was shown in @xcite .",
    "let @xmath6 be a finite alphabet , and denote @xmath18 the set of words ( or tuples ) @xmath19 . for a word @xmath20 the symbol @xmath21 stands for the length of @xmath20 .",
    "denote @xmath22 the @xmath23th element of @xmath18 , enumerated in such a way that the elements of @xmath24 appear before the elements of @xmath25 , for all @xmath26 .",
    "_ distributions _ or _",
    "( stochastic ) processes _ are probability measures on the space @xmath27 , where @xmath28 is the borel sigma - algebra of @xmath29 .",
    "denote @xmath30 the number of occurrences of a word @xmath20 in a word @xmath11 and @xmath31 its frequency : @xmath32 and @xmath33 where @xmath34 .",
    "for example ,",
    "@xmath35    we use the abbreviation @xmath36 for @xmath37 .",
    "a process @xmath38 is _ stationary _ if @xmath39 for any @xmath40 and @xmath41 .",
    "denote @xmath42 the set of all stationary processes on @xmath29 . a stationary process",
    "@xmath38 is called _",
    "( stationary ) ergodic _ if the frequency of occurrence of each word @xmath20 in a sequence @xmath43 generated by @xmath38 tends to its a priori ( or limiting ) probability a.s . : @xmath44 .",
    "denote @xmath15 the set of all stationary ergodic processes .",
    "a * distributional distance * is defined for a pair of processes @xmath45 as follows  @xcite : @xmath46 where @xmath47 are summable positive real weights ( e.g. @xmath48 : we fix this choice for the sake of concreteness ) .",
    "it is easy to see that @xmath49 is a metric .",
    "equipped with this metric , the space of all stochastic processes is a compact , and the set of stationary processes @xmath42 is its convex closed subset .",
    "( the set @xmath15 is not closed . )",
    "when talking about closed and open subsets of @xmath42 we assume the topology of  @xmath49 .",
    "compactness of the set @xmath42 is one of the main ingredients in the proofs of the main results .",
    "another is that the distance @xmath49 can be consistently estimated , as the following lemma shows ( because of its importance for further development , we give it with a proof ) .",
    "[ th : dd ] let @xmath50 and let a sample @xmath36 be generated by @xmath38",
    ". then @xmath51    for any @xmath9 find such an index @xmath52 that @xmath53 .",
    "for each @xmath54 we have @xmath55 a.s .",
    ", so that @xmath56 from some @xmath57 on ; denote @xmath58 this @xmath57 .",
    "let @xmath59 ( @xmath60 depends on the realization @xmath43 ) .",
    "thus , for @xmath61 we have @xmath62 which proves the statement .    considering the borel ( with respect to the metric @xmath49 ) sigma - algebra @xmath63 on the set @xmath42",
    ", we obtain a standard probability space @xmath64 .",
    "an important tool that will be used in the analysis is * ergodic decomposition * of stationary processes ( see e.g. @xcite ) : any stationary process can be expressed as a mixture of stationary ergodic processes .",
    "more formally , for any @xmath65 there is a measure @xmath66 on @xmath64 , such that @xmath67 , and @xmath68 , for any @xmath69 .",
    "the _ support _ of a stationary distribution @xmath38 is the minimal closed set @xmath70 such that @xmath71 .",
    "a * test * is a function @xmath72 that takes a sample and outputs a binary answer , where the answer @xmath23 is interpreted as `` the sample was generated by a distribution that belongs to @xmath8 '' .",
    "the answer @xmath23 is correct if the sample was indeed generated by a distribution from @xmath8 , otherwise we say that the test made an * error*.    a test @xmath73 is called * uniformly consistent * if for every @xmath74 there is an @xmath75 such that for every @xmath76 the probability of error on a sample of size @xmath4 is less than @xmath74 : @xmath77 for every @xmath78 and every @xmath7 .",
    "the tests presented below are based on _ empirical estimates of the distributional distance @xmath49 _ : @xmath79 where @xmath80 , @xmath65 , @xmath81 .",
    "that is , @xmath82 measures the discrepancy between empirically estimated and theoretical probabilities . for a sample @xmath81 and a hypothesis @xmath83 define @xmath84    for @xmath85 , denote @xmath86 the closure of @xmath87 ( with respect to the topology of @xmath49 ) . for @xmath88 , the * uniform test * @xmath12 is constructed as follows . for each @xmath80",
    "let @xmath89    [ th : uni ] let @xmath90 and @xmath91 . if @xmath92 for every @xmath93 then the test @xmath12 is uniformly consistent .",
    "conversely , if there exists a uniformly consistent test for @xmath1 against @xmath2 then @xmath94 for any @xmath95 .    the proof is deferred to section  [ s : proofs ] .",
    "first of all , it is obvious that sets that consist of just one or finitely many stationary ergodic processes are closed and closed under ergodic decompositions ; therefore , for any pair of disjoint sets of this type , there exists a uniformly consistent test .",
    "( in particular , there is a uniformly consistent test for @xmath96 against @xmath97 , where @xmath98 . )",
    "it is clear that for any @xmath99 there is no uniformly consistent test for @xmath100 against @xmath101 .",
    "more generally , for any non - empty @xmath1 there is no uniformly consistent test for @xmath1 against @xmath102 provided the latter complement is also non - empty .",
    "indeed , this follows from theorem  [ th : uni ] since in these cases the closures of @xmath1 and @xmath2 are not disjoint .",
    "one might suggest at this point that a uniformly consistent test exists if we restrict @xmath2 to those processes that are sufficiently far from @xmath99 .",
    "however , this is not true .",
    "we can prove an even stronger negative result .",
    "[ th : no ] let @xmath103 , @xmath104 and let @xmath9 .",
    "there is no uniformly consistent test for @xmath105 against @xmath106 .",
    "the proof of the proposition is deferred to the appendix .",
    "what it means is that , while distributional distance is well suited for characterizing those hypotheses for which consistent test exist , it is not suited for _ formulating the actual hypotheses_. apparently a stronger distance is needed for the latter .    the following statement is easy to demonstrate from theorem  [ th : uni ]",
    ".    given two disjoint sets @xmath1 and @xmath2 each of which is continuously parametrized by a compact set of parameters and is closed under taking ergodic decompositions , there exists a uniformly consistent test of @xmath1 against @xmath2 .",
    "examples of parametrisations mentioned in the corollary are the sets of @xmath57-order markov sources , parametrised by transition probabilities .",
    "thus , any two disjoint closed subsets of these sets satisfy the assumption of the corollary .",
    "the proof of theorem  [ th : uni ] will use the following lemmas , whose proofs can be found in @xcite .    [",
    "th : count ] let @xmath107 , @xmath65 , @xmath85 , and @xmath9 .",
    "then @xmath108 where @xmath109 is the sum of all the weights of tuples longer than @xmath57 in the definition of @xmath49 : @xmath110 , and @xmath111    the meaning of this lemma is as follows .",
    "for any word @xmath112 , if it is far away from ( or close to ) a given distribution @xmath113 ( in the empirical distributional distance ) , then some of its shorter subwords @xmath114 is far from ( close to ) @xmath113 too . by stationarity",
    ", we may assume that @xmath115 .",
    "therefore , the probability of a @xmath116-ball of samples of a given length is close to the probability of a @xmath116-ball of samples of smaller size . in other words",
    ", it can not happen that a small sample is likely to be close to @xmath113 , but a larger sample is likely to be far .",
    "[ th : cont ] let @xmath117 , @xmath118 be a sequence of processes that converges to a process @xmath119 .",
    "then , for any @xmath120 and @xmath9 if @xmath121 for infinitely many indices @xmath57 , then @xmath122 .      to prove the first statement of the theorem",
    ", we will show that the test @xmath12 is a uniformly consistent test for @xmath124 against @xmath125 ( and hence for @xmath1 against @xmath2 ) , under the conditions of the theorem .",
    "suppose that , on the contrary , for some @xmath126 for every @xmath127 there is a process @xmath128 such that @xmath129 for some @xmath130 .",
    "define @xmath131 which is positive since @xmath132 and @xmath133 are closed and disjoint .",
    "we have @xmath134 this implies that either @xmath135 or @xmath136 , so that , by assumption , at least one of these inequalities holds for infinitely many @xmath80 for some sequence @xmath137 .",
    "suppose that it is the first one , that is , there is an increasing sequence @xmath138 , @xmath26 and a sequence @xmath139 , @xmath26 such that @xmath140 the set @xmath42 is compact , hence so is its closed subset @xmath132 .",
    "therefore , the sequence @xmath141 , @xmath26 must contain a subsequence that converges to a certain process @xmath142 . passing to a subsequence if necessary",
    ", we may assume that this convergent subsequence is the sequence @xmath141 , @xmath26 itself .",
    "using lemma  [ th : count ] , ( [ eq : count1 ] ) ( with @xmath143 , @xmath144 , @xmath145 , and @xmath146 ) , and taking @xmath57 large enough to have @xmath147 , for every @xmath148 large enough to have @xmath149 , we obtain @xmath150 that is , we have shown that for any large enough index @xmath151 the inequality @xmath152 holds for infinitely many indices @xmath153 . from this and",
    "lemma  [ th : cont ] with @xmath154 we conclude that @xmath155 .",
    "the latter holds for infinitely many @xmath57 ; that is , @xmath156 infinitely often .",
    "therefore , @xmath157 however , we must have @xmath158 for every @xmath142 : indeed , for @xmath159 it follows from lemma  [ th : dd ] , and for @xmath160 from lemma  [ th : dd ] , ergodic decomposition and the conditions of the theorem .",
    "thus , we have arrived at a contradiction that shows that @xmath161 can not hold for infinitely many @xmath80 for any sequence of @xmath162 .",
    "analogously , we can show that @xmath163 can not hold for infinitely many @xmath80 for any sequence of @xmath162 . indeed , using lemma  [ th : count ] , equation  ( [ eq : count2 ] )",
    ", we can show that @xmath164 for a large enough @xmath153 implies @xmath165 for a smaller @xmath151 .",
    "therefore , if we assume that @xmath163 for infinitely many @xmath80 for some sequence of @xmath162 , then we will also find a @xmath119 for which @xmath166 for infinitely many @xmath4 , which , using lemma  [ th : dd ] and ergodic decomposition , can be shown to contradict the fact that @xmath167 .",
    "thus , returning to  ( [ eq : union ] ) , we have shown that from some @xmath4 on there is no @xmath128 for which @xmath168 holds true .",
    "the statement for @xmath169 can be proven analogously , thereby finishing the proof of the first statement .    to prove the second statement of the theorem",
    ", we assume that there exists a uniformly consistent test @xmath73 for @xmath1 against @xmath2 , and we will show that @xmath94 for every @xmath93 .",
    "indeed , let @xmath128 , that is , suppose that there is a sequence @xmath170 such that @xmath171 .",
    "assume @xmath172 and take @xmath173 .",
    "since the test @xmath73 is uniformly consistent , there is an @xmath174 such that for every @xmath175 we have @xmath176 recall that , for @xmath120 , @xmath177 is a continuous function in @xmath113 . in particular",
    ", this holds for the set @xmath178 , for any given @xmath80 .",
    "therefore , for every @xmath175 and for every @xmath23 large enough , @xmath179 implies also @xmath180 which contradicts @xmath181 .",
    "this contradiction shows @xmath182 for every @xmath128 .",
    "the case @xmath183 is analogous .",
    "the theorem is proven .",
    "assume @xmath184 ( the other case is obvious ) .",
    "consider the process @xmath185 on pairs @xmath186 , such that the distribution of @xmath187 is @xmath188 , the distribution of @xmath189 is @xmath38 and the two components @xmath190 and @xmath191 are independent ; in other words , the distribution of @xmath192 is @xmath193 .",
    "consider also a two - state stationary ergodic markov chain @xmath113 , with two states @xmath194 and @xmath195 , whose transition probabilities are @xmath196 , where @xmath197 .",
    "the limiting ( and initial ) probability of the state @xmath194 is @xmath198 and that of the state @xmath195 is @xmath199 .",
    "finally , the process @xmath200 is constructed as follows : @xmath201 if @xmath113 is in the state @xmath202 and @xmath203 otherwise ( here it is assumed that the chain @xmath113 generates a sequence of outcomes independently of @xmath192 . clearly , for every @xmath204 satisfying @xmath197 the process @xmath200 is stationary ergodic ; denote @xmath205 its distribution .",
    "let @xmath206 , @xmath80 .",
    "since @xmath184 , we can find a @xmath207 such that @xmath208 where @xmath209 is the distribution @xmath205 with parameters @xmath210 and @xmath211 , where @xmath211 satisfies @xmath212 .",
    "thus , @xmath213 for all @xmath80 .",
    "however , @xmath214 where @xmath215 is the stationary distribution with @xmath216 and @xmath217 .",
    "therefore , @xmath218 and @xmath219 , so that by theorem  [ th : uni ] there is no uniformly consistent test for @xmath1 against @xmath2 , which concludes the proof .",
    "this work has been partially supported by the french ministry of higher education and research , nord - pas de calais regional council and feder through the `` contrat de projets etat region ( cper ) 2007 - 2013 '' , by the french national research agency ( anr ) , project explo - ra anr-08-cosi-004 , and by pascal2 .",
    "b.  ryabko , j.  astola , and a.  gammerman .",
    "application of kolmogorov complexity and universal codes to identity testing and nonparametric testing of serial independence for time series .",
    ", 359:440448 , 2006 ."
  ],
  "abstract_text": [
    "<S> given a discrete - valued sample @xmath0 we wish to decide whether it was generated by a distribution belonging to a family @xmath1 , or it was generated by a distribution belonging to a family @xmath2 . in this work </S>",
    "<S> we assume that all distributions are stationary ergodic , and do not make any further assumptions ( e.g. no independence or mixing rate assumptions ) . </S>",
    "<S> we would like to have a test whose probability of error ( both type i and type ii ) is uniformly bounded . </S>",
    "<S> more precisely , we require that for each @xmath3 there exist a sample size @xmath4 such that probability of error is upper - bounded by @xmath3 for samples longer than @xmath4 . </S>",
    "<S> we find some necessary and some sufficient conditions on @xmath1 and @xmath2 under which a consistent test ( with this notion of consistency ) exists . </S>",
    "<S> these conditions are topological , with respect to the topology of distributional distance . </S>"
  ]
}