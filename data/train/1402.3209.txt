{
  "article_text": [
    "the balance of useful accuracy with computational efficiency makes density - functional theory ( dft ) popular for finding ground - state electronic properties of a wide range of systems and materials @xcite .",
    "while exact conditions @xcite and fitting to chemical data sets @xcite are often used to construct approximations , another major source of inspiration has been highly accurate calculations of kohn - sham ( ks ) quantities for simple systems , such as the he atom @xcite .",
    "the exact ks potential , orbitals , energies , and energy components have been enormously useful in illustrating basic theorems of dft and testing approximations .",
    "many algorithms now exist for extracting the ks potential from accurate densities @xcite .",
    "time - dependent density - functional theory ( tddft ) @xcite has become the standard dft method for calculating excitation energies , at least for molecules , with typical accuracies and efficiency comparable to what can be achieved in ground - state dft @xcite . once again , accurate ks energies , of both occupied and unoccupied orbitals , play a vital role @xcite .",
    "but alternative density - functional approaches for excitation energies can be valuable , both as practical tools and for gaining physical insight @xcite .",
    "the ensemble density - functional theory ( edft ) formalism for excited states @xcite is based on a variational principle of ensembles comprising the ground state and a chosen number of excited states . despite its rigorous formal framework and appealing physical motivation@xcite ,",
    "the edft excited - state formalism has seen only limited practical success .",
    "the lack of good approximate exchange - correlation ( xc ) functionals for edft leads to inaccurate transition frequencies .",
    "better approximations are needed for edft to become more useful .    here",
    ", we describe an algorithm that extracts the ensemble ks and xc potentials from the various eigenstate densities , and apply that algorithm to highly accurate densities of the helium atom .",
    "we use the exact results to analyze errors in approximations that have been designed for use in edft , plot various potentials , and check the virial theorem for the ensemble correlation potential .",
    "we demonstrate the weight - independence of transition frequencies in the exact case , but also find a strong weight - dependence in the individual elements contributing to the exact expression , all of which cancels in the final excitation energy .",
    "we show that approximations all yield ( incorrectly ) weight - dependent transition frequencies , and demonstrate how this is related to the ensemble derivative discontinuity .",
    "an ensemble in edft consists of the ground state and @xmath0 excited states . for the lowest @xmath1 eigenstates @xmath2 of the many - body hamiltonian @xmath3 , sorted by energy in ascending order , each state",
    "is assigned a weight @xmath4 .",
    "edft states that for _ 0 _ 1_2_m0 , there is a one - to - one correspondence between the ensemble density n()=_m=0^m _",
    "m_m | ( ) | _ m and the external potential @xcite . a kohn - sham ( ks ) scheme",
    "can then be constructed in the usual way @xcite .",
    "we consider only bi - ensembles of the ground and first - excited states . for a non - degenerate ground state , @xmath5&=\\wtb~e_0+g~\\wt~e_1,\\end{aligned}\\ ] ] where @xmath6 is the degeneracy of the excited state , @xmath7 , and subscripts 0 and 1 refer to the ground and excited states .",
    "edft also holds for ensembles of states that share a symmetry - projected hamiltonian @xcite . for helium ,",
    "the ground state is a singlet , the first excited state is a triplet , and the second excited state is again a singlet , shown in fig .",
    "[ fig : he : density : compare ] .",
    "the ( unprojected ) bi - ensemble always includes the ground state and the first excited state .",
    "here we focus on calculations in the spin - projected ensemble to find the transition to the lowest singlet .",
    "the corresponding ensemble ks potential @xmath8(\\br)$ ] is defined as the potential of the non - interacting system \\{-^2+v_s()}_j()=_j_j ( ) , which reproduces the exact ensemble density as n _ ( ) = ( 1+)|_1()|^2+g |_2()|^2 , where @xmath9 are ks orbitals .",
    "atomic units ( @xmath10 ) are used throughout , and all ks quantities are @xmath11-dependent . then e_=t_s,[n]+^3rn()v ( ) + e , where @xmath12=(1+\\wtb)\\ , t_1 + g\\ , \\wt\\ , t_2 $ ] is the ensemble ks kinetic energy , with @xmath13 the kinetic energy of @xmath14 .",
    "@xmath15 is the external potential of the interacting system .",
    "[ eqn : ehx ] e&=  _ 0,[n ] | |-|^-1 | _ 0,[n ]   + & + g  _ 1,[n ]",
    "| |-|^-1 | _ 1,[n ] is the ensemble hartree - exchange energy , and the ensemble correlation energy @xmath16 . @xmath17 $ ] is the ks many - body wavefunction , with @xmath18 or @xmath19 again indicating the ground or excited state . here",
    "we choose @xmath20 to be the hartree energy of the ensemble density , although it contains `` ghost '' interactions@xcite .",
    "the exchange energy is then defined as the expectation of the electron - electron repulsion on the ks ensemble minus the hartree energy .",
    "this definition of @xmath21 is consistent with our choice of spin eigenstates that are necessarily multi - determinant .",
    "the ensemble ks potential is v_s,[n]()=v()+v ( ) , where @xmath22(\\br)=\\delta e\\hxcw[n]/\\delta n(\\br)$ ] .",
    "the excitation energy is then independent of @xmath11 : = e_1-e_0=_+e/|_n = n _ , [ eqn : theory : exciteng ] where @xmath23 .",
    "the @xmath11-dependence of the hxc energy comes from both the @xmath11-dependence of @xmath24 and from the hxc energy functional .",
    "( [ eqn : theory : exciteng ] ) shows that the correction to the ks gap originates from the @xmath11-dependence of xc , not from @xmath24 . using a ground - state xc functional in edft yields no correction to the ks excitation energy .",
    "edft is a more general theory encompassing ground - state dft , and the ground - state xc functional is only a special case ( @xmath25 ) of the ensemble xc functional .",
    "however , the excitation energies can also be obtained from the difference of two consecutive equiensemble energies .",
    "in contrast to eq .",
    "( [ eqn : theory : exciteng ] ) , the density - based @xmath11-dependence of @xmath26 does not drop out in that approach , and using ground - state xc functionals would yield finite corrections .",
    "these two approaches for the excitation energy yield the same result using the _ exact _ functional , but no known approximations can achieve such consistency .",
    "the only unknown in the ensemble ks procedure is the xc functional . without this functional , an inversion method for edft",
    "is needed to extract xc potentials from accurate densities .",
    "@xcite presented an inversion scheme for edft similar to the van leeuwen - baerends ( lb ) algorithm in ground - state dft@xcite , but we found its numerical stability unsatisfactory . ref .",
    "@xcite observed that a lb - type algorithm can not change the local sign of the ks potential during the iteration . while not a fundamental problem , it makes the algorithm less stable .",
    "also , it can be hard to obtain the @xmath27 asymptotic behavior of @xmath28 using the lb algorithm without having to build it in the initial guess .",
    "@xcite suggested an alternative ground - state density - inversion algorithm , where the xc potential is updated iteratively by    @xmath29\\notag\\\\ & \\quad+[i_{\\text{ks}}^{(i)}-i]\\left[\\theta(1-r)r^\\gamma+\\frac{\\theta(r-1)}{r^\\delta}\\right ] , \\label{eqn : numerical : gsdeninv}\\end{aligned}\\ ] ]    where @xmath30 , @xmath31 , @xmath32 , @xmath33 are parameters controlling the speed of convergence , and @xmath34 is the ionization energy . in the asymptotic region ,",
    "the density difference in the second term of eq .",
    "( [ eqn : numerical : gsdeninv ] ) is very small , so the convergence needs to be accelerated by the use of the @xmath35 in front of this term .",
    "even so , the @xmath27 asymptotic behavior of @xmath28 can be hard to obtain , and the third term of eq .",
    "( [ eqn : numerical : gsdeninv ] ) is there to ensure this asymptotic behavior .",
    "our scheme for edft is based on the ground - state density - inversion method of ref .",
    "@xcite and eq .",
    "( [ eqn : numerical : gsdeninv ] ) , producing the ensemble xc potential from any given ensemble density . for simplicity",
    ", we describe the scheme for spherical systems , but it can be extended to other systems easily .",
    "we modify the ground - state eq .",
    "( [ eqn : numerical : gsdeninv ] ) for edft usage as v_,^(i+1)(r)=v_,^(i)(r)+r^[n_,^(i)(r)-n_(r)]/h(r ) , [ eqn : numerical : ensdeninv ] where @xmath36 is described below . since the ionization energies of eq .",
    "( [ eqn : numerical : gsdeninv ] ) are not defined for an ensemble , a double - loop scheme is used to ensure the correct @xmath27 asymptotic behavior .    in the first iterative loop , we update the ensemble xc potential with eq .",
    "( [ eqn : numerical : ensdeninv ] ) and set @xmath37 .",
    "convergence is reached when ^3r|n^(i)_ks,()-n_| < _ 1 , [ eqn : numerical : convg ] for a chosen accuracy @xmath38 . even if large @xmath31 values are used to accelerate convergence in the large-@xmath39 region , this first loop is usually insufficient to produce the @xmath27 asymptotic behavior in the ensemble xc potential , due to the exponential asymptotic decay of the density . to compensate for this",
    ", we use a second iterative loop . starting from the result of the first loop ,",
    "the ensemble xc potential is updated using eq .",
    "( [ eqn : numerical : ensdeninv ] ) with @xmath40 and new values of @xmath30 and @xmath31 . the convergence of the second loop is also checked with eq .",
    "( [ eqn : numerical : convg ] ) , but with a smaller @xmath41",
    ". this second loop updates the ensemble xc potential with the relative error in the ensemble density , so the correction in the large-@xmath39 region for each iteration is larger than in the first loop .",
    "the second loop is therefore more sensitive to the initial guess than the first loop , so it can not be used independently .",
    "we consistently obtain @xmath27 asymptotic behavior in the ensemble xc potentials produced by this double - loop procedure , without having to build it in the algorithm or in the initial guess .",
    "this double loop scheme guarantees both numerical stability and good convergence in the asymptotic region .    for ensembles of the helium atom",
    ", we found that parameters @xmath42 $ ] and @xmath43 $ ] guarantee convergence of the first loop .",
    "for the second loop , @xmath44 $ ] and @xmath43 $ ] guarantee convergence , if @xmath11 is not close to 0 . as @xmath11 approaches 0 , the value of @xmath30 needs to be smaller to prevent the second loop from becoming unstable .",
    "the double - loop scheme has had good numerical performance in all types of grids and discretizations of the hamiltonian tested thus far .",
    "we apply this scheme to highly accurate helium densities . fig . [",
    "fig : he : density : compare ] shows the ground and first two excited state densities for helium , which are essentially numerically exact .",
    "two - body electronic wave functions were obtained by optimizing an expansion in hylleraas functions@xcite .",
    "analytic integration of the density matrix associated with the optimum wave function provides an accurate spherically averaged charge density at each radius as a sum of terms .",
    "basis sets composed of @xmath45 and @xmath46 hylleraas functions for the singlet and triplet states , respectively , result in total energies within @xmath47 a.u .",
    "of accurate estimates@xcite .",
    "the errors in the virial are below @xmath48 a.u . for the ground state and",
    "@xmath49 a.u .",
    "for the first singlet excited state , used in the singlet bi - ensemble .",
    "our calculation for @xmath25 agrees with the known exact ground - state dft quantities of helium @xcite .",
    "the exact equiensemble density and potential are plotted in fig .",
    "[ fig : he : general ] , along with those resulting from an equal mixture of orbitals from the ground - state ks potential .",
    "the subtle shell - like structure in the ensemble density corresponds to the cross - over between the ground - state density and the first singlet excited - state density .",
    "the upward bump near @xmath50 in the ensemble ks potential ensures its ensemble density matches the interacting one , unlike the ensemble of orbitals from the ground - state ks potential .",
    "this bump is shifted left in the xc potential for the unprojected bi - ensemble ( fig .",
    "[ fig : he : vxc : compare ] ) .    .",
    "]        fig .",
    "[ fig : he : vxcatw ] shows the exact ensemble xc potentials at various @xmath11 values , which have been found by subtracting the hartree potential of the ensemble density from the ks potential .",
    "the bump near @xmath50 develops as @xmath11 increases .",
    "even when @xmath11 is close to 0 , @xmath51 differs from the @xmath25 ( ground - state ) xc potential in fig .",
    "[ fig : he : vxcatw ] . the potentials shift further and further from the ground - state curve in the small-@xmath39 region as @xmath11 increases .     as @xmath52 .",
    "the location of the step depends logarithmically on @xmath11 . as @xmath52 , the drop - off to the @xmath25 value moves infinitely far from the origin . ]    , showing the shoulder in the xc potential developing from the small-@xmath11 step as @xmath11 increases . since @xmath11 is no longer near zero , the asymptotic formula for the position of the drop - off no longer holds . ]",
    "this discrepancy between small-@xmath11 and @xmath25 potentials is due to the ensemble derivative discontinuity@xcite . for any nonzero @xmath11 ,",
    "the asymptotic behavior of the ensemble density is dominated by that of the excited state .",
    "levy @xcite proved an analog of the derivative discontinuity of ground - state dft : the ensemble ks highest - occupied - molecular - orbital ( homo ) energy has a finite change as @xmath11 changes from 0 ( ground state ) to @xmath53 : @xmath54(\\br)-v\\hxc[n](\\br)\\\\ & = \\lim_{\\wt\\to0}{\\partial e\\hxcw[n]}/{\\partial \\wt}|_{n = n_\\wt}. \\label{eqn : numerical : deltavxc2}\\end{aligned}\\ ] ] this is an exact property of number - conserving excitations@xcite . according to eq .",
    "( [ eqn : theory : exciteng ] ) and ( [ eqn : numerical : deltavxc2 ] ) , we obtain @xmath55 a.u . for the singlet bi - ensemble .",
    "[ fig : he : deltavxc : exact ] shows the exact xc potential jump for small @xmath11 values .",
    "a step structure occurs since the ensemble density at small @xmath39 is dominated by the homo density , and at large @xmath39 the dominating behavior switches to the lowest - unoccupied - molecular - orbital ( lumo ) density , which decays more slowly than the homo density . as @xmath11 decreases , the switching point @xmath56 moves to the right .",
    "in the limit of @xmath57 , the homo density dominates @xmath58 for finite @xmath39 , so @xmath59 becomes a constant .",
    "the ground - state limit is thus recovered since an additional constant on a potential has no physical effect . though this difference is not close to a constant in the small-@xmath39 region for larger @xmath11 ( fig .",
    "[ fig : he : deltavxc : more ] ) , evidence of the step down remains in the shoulder present before the sharp decrease to the ground - state potential .",
    "we showed@xcite that the switching point @xmath56 for small values of @xmath11 depends on @xmath60 , so the @xmath57 limit is achieved slowly as @xmath11 decreases . the large-@xmath11 difference between the ground - state and ensemble xc potentials ( fig .",
    "[ fig : he : vxcatw ] ) appears to emerge continuously from the step - like small-@xmath11 behavior , suggesting that the derivative discontinuity is crucial for replication of the bump in @xmath61 .    with the exact ensemble xc potentials available , we can numerically verify exact conditions of edft , such as the virial theorem@xcite . with traditionally defined hartree , its form is similar to its ground - state counterpart@xcite : t_c,[n]=-e-^3rn()v ( ) .",
    "[ eqn : virialxc ] the virial as defined by nagy yields the same results as directly calculated kinetic correlation to within 1% .    ) applied to the exact helium singlet ensemble , demonstrating the exact cancellation of all @xmath11-dependence in ks gaps ( red ) and corrections to the ks gap ( green ) , leading to no @xmath11 dependence in the calculated optical gap ( blue ) .",
    "gaps are shifted by the true optical gap @xmath62 for ease of comparison .",
    "color online . ]",
    "( [ eqn : theory : exciteng ] ) converts the @xmath11-dependent ks transition energies , @xmath63 , into the exact , @xmath11-independent transition frequency . the last term in eq .",
    "( [ eqn : theory : exciteng ] ) is significant for all values of @xmath11 and is strongly @xmath11-dependent .",
    "[ fig : deltaedeltaeps : exact ] shows the exact cancellation of the @xmath11-dependence as required by eq .",
    "( [ eqn : theory : exciteng ] ) .",
    "if this cancellation is incomplete , as it is in existing approximations , @xmath11-dependent excitation energies will result .",
    "the strong @xmath11-dependence in the exact ks gap @xmath63 is related to the bumps in the exact xc potentials ( fig .",
    "[ fig : he : vxcatw ] ) .",
    "the bump near @xmath50 creates a local confinement effect near the nucleus , shifting the ks eigenvalues upward from the ground - state values .",
    "the effect is smaller for the 1s orbital because the 1s orbital density is already small and monotonically decaying at the position of the bump . the ks gap becomes larger as the bump is more prominent , as can be seen in the large-@xmath11 region of fig .",
    "[ fig : deltaedeltaeps : exact ] . the sharp change of @xmath63 in the small-@xmath11 region of fig . [ fig : deltaedeltaeps : exact ] is due to the ensemble derivative discontinuity , since @xmath59 effectively creates a bump in the xc potential in the small-@xmath39 region .",
    "to illustrate the usefulness of these results , we test the few existing approximations to edft , including the quasi - local - density approximation ( qlda)@xcite , the single - slater - determinant ghost - corrected exact exchange ( sd)@xcite , and the symmetry eigenstate hartree - exchange ( sehx)@xcite . both sd and sehx are approximations falling under the overarching work on ghost interactions by gidopoulos , papaconstantinou , and gross@xcite , which we denote here as gpg .",
    "the flexibility of gpg lies in its general approach to the description and elimination of ghost interactions introduced by the exchange and traditionally defined hartree energies .",
    "these ghosts occur when one uses the ensemble density as input into these terms , as there are spurious interactions between the ground and excited states .",
    "if one uses the ensemble definition of hartree - exchange in eq .",
    "( [ eqn : ehx ] ) , these ghosts are avoided .    as a general methodology",
    ", gpg can be used in various forms . when faced with degenerate states ,",
    "one always has choices about which states to use to describe the system of interest .",
    "two obvious choices are single- and multi - determinant descriptions .",
    "when the gpg methodology is applied to ensemble hartree - exchange using symmetry eigenstates with the krieger - li - iafrate approximation@xcite , one produces the sehx approximation .",
    "alternatively , one may choose to use single - determinant states within the gpg methodology .",
    "we show this sd approach alongside the sehx approximation to clarify the effect of using full eigenstates to describe ensemble ghosts , since previous calculations@xcite can be reevaluated in light of these comparisons .",
    "the general equation of the sehx energy for an ensemble up to the @xmath34-th group of degenerate states(`multiplet ' ) is@xcite    @xmath64\\delta_{\\sigma_\\mu,\\sigma_\\nu}\\big\\}\\sum_{i=1}^i\\sum_{k=1}^{g_i}\\wt_{i , k}\\sum_{p=1}^{\\tilde{g}_{\\tilde{i}}}{\\left|c_{i , k ,",
    "p}\\right|}^2f_{\\tilde{i},p,\\mu}f_{\\tilde{i},p,\\nu}\\\\ + \\sum_{\\substack{\\mu,\\nu>\\mu\\\\ \\kappa,\\lambda>\\kappa}}[\\phi_\\mu^*(\\br)\\phi_\\nu^*(\\br')\\phi_\\kappa(\\br)\\phi_\\lambda(\\br')\\delta_{\\sigma_\\mu,\\sigma_\\kappa}\\delta_{\\sigma_\\nu,\\sigma_\\lambda}-\\phi_\\mu^*(\\br)\\phi_\\nu^*(\\br')\\phi_\\lambda(\\br)\\phi_\\kappa(\\br')\\delta_{\\sigma_\\mu,\\sigma_\\lambda}\\delta_{\\sigma_\\nu,\\sigma_\\kappa } ] \\sum_{i=1}^i\\sum_{k=1}^{g_i}\\wt_{i , k}\\sum_{p , q\\ne p}^{\\tilde{g}_{\\tilde{i}}}c_{i , k , p}^*c_{i , k , q}\\\\ \\times f_{\\tilde{i},p,\\mu}f_{\\tilde{i},p,\\nu}f_{\\tilde{i},q,\\kappa}f_{\\tilde{i},q,\\lambda}\\prod_{\\eta\\ne\\mu,\\nu,\\kappa,\\lambda}\\delta_{f_{\\tilde{i},p,\\eta},f_{\\tilde{i},q,\\eta}}\\bigg\\},\\end{gathered}\\ ] ]    where @xmath65 denotes a multiplet ; @xmath66 denotes a specific state in the @xmath65-th multiplet ; @xmath67 is the degeneracy of the @xmath65-th multiplet ; @xmath68 is the degeneracy of the corresponding kohn - sham ( ks ) multiplet ; @xmath69 denote specific ks single slater determinants ; @xmath70 denote ks orbitals ; @xmath71 is the weight of the @xmath66-th state in the @xmath65-th multiplet ; @xmath72 is the mixing coefficient of the @xmath73-th determinant to make up the @xmath66-th state in the @xmath65-th multiplet ; @xmath74 is the occupation number of the @xmath75-th orbital in the @xmath73-th determinant of the @xmath76-th ks multiplet ; @xmath77 denotes spin , @xmath78 denotes ks orbitals ; @xmath79 is the orbital density of the @xmath75-th orbital ; and @xmath80 .",
    "this form is more explicit than the one given in our previous work@xcite , in order to facilitate use of the sehx version of gpg .",
    "@xcite presents the general framework and a single - determinant example based on the exact exchange oep formalism of nagy@xcite .",
    "however , the authors use the ensemble hartree - exchange definition of eq .",
    "( [ eqn : ehx ] ) and symmetry eigenstates to calculate their reported results .",
    "we have denoted such a procedure as sehx .",
    "sehx , as written out here and in ref .",
    "@xcite , yields self - consistent results that agree to within 0.03 ev with those presented in table i of ref .",
    "@xcite , with this difference assumed to be due to numerical differences in implementation .",
    "comparison of exact and approximate quantities exposes differences in single- and multi - determinant approximations , as well as the shortcomings both share . fig . [",
    "fig : he : approx ] shows exact and approximate xc potentials using the exact ensemble density .",
    "both the sd and the sehx are oeps , which guarantees their correct @xmath27 asymptotic behavior in the xc potential ( fig .",
    "[ fig : he : approx ] ) .",
    "however , only the sehx potential shows the large @xmath11 bump and recovers the general shape of the exact @xmath81 .     for the helium singlet equiensemble .",
    "the approximated @xmath28 s are evaluated using the exact ensemble density as input . ]     for the helium singlet equiensemble shows two upward bumps and does not depend on the definition of the hartree potential used .",
    "these are obtained by subtracting sehx @xmath82 of the exact ensemble density from the exact @xmath81 . ]",
    "the correlation potential @xmath83 displays two distinct bumps , shown in fig .",
    "[ fig : he : correct : vc ] .",
    "the @xmath84 correlation potential matches perfectly with the exact ground - state correlation potential in ref .",
    "the first bump at about @xmath85 also exists in the ground - state @xmath86 , while the second bump at about @xmath50 , which vanishes rapidly as @xmath11 decreases , is unique to edft .",
    "[ fig : he : deltavxc:0001 ] shows that , in the small @xmath11 region , only sehx generates a step - like form for the ensemble derivative discontinuity .",
    "the sehx xc potential is also the only approximation that has the characteristic bump of the exact xc potential .",
    "both sehx and sd are oep methods , but the former satisfies the exact condition of the ensemble derivative discontinuity , while the latter does not .",
    "the sehx potential is obtained by applying the kli approximation@xcite to the optimized effective potential ( oep ) equation@xcite .",
    "equations for @xmath87 of the helium singlet bi - ensemble are given in eqs .",
    "41 - 43 of ref .",
    "@xcite .     of various approximations at @xmath88 . only sehx ( dotted red ) replicates a shift similar to that of the exact curve ( solid black ) .",
    "color online . ]    to understand the absence of the derivative discontinuity in sd , we compare the small-@xmath11 behavior of both sd and sehx@xcite .",
    "the sd potential for the spin - up electron is    v_hx,^()=&\\{(1-)n_1^()[v_1()+|v_hx1,-|v_1 ] + & + n_2^()[v_2()+|v_hx2,-|v_2]}/n _ , ( ) ,    where @xmath89 , and v_1()=v_2()=n^_1( ) .",
    "barred quantities are defined    @xmath90 , for instance , is the expectation value of the spin - up hx potential with respect to @xmath91 .",
    "comparing the sehx@xcite and sd expressions for the hx potentials makes the disappearance of the derivative discontinuity in the sd approximation clear .",
    "when @xmath11 is very small , in the region where @xmath39 is smaller than a certain @xmath56 , @xmath24 is dominated by the @xmath92 term ( see eq .",
    "41 of ref .",
    "@xcite ) . in the @xmath93 region , however , it is dominated by the @xmath94 term due to the slower decay of @xmath95 .",
    "thus , when @xmath11 is very small , we have v_hx,0^()\\ {    ll v_1()+|v_hx1-|v_1 , & r < r , + v_2()+|v_hx2-|v_2 , & r > r ,    . [ eqn : sehx : v1v2 ] and v_hx,0^()\\ {    ll v_1()+|v_hx1,-|v_1 , & r < r , + v_2()+|v_hx2,-|v_2 , & r > r ,    . [ eqn : sdgpg : v1v2 ]    for any @xmath11 , @xmath96",
    ", so the sd approximation yields the same behavior at large or small @xmath11 .",
    "in contrast , when @xmath11 is very small within the sehx approximation , v_1()n_1( ) , and [ fdefn ]    v_2()&= + & = v_1()+f ( ) .",
    "@xmath97 and @xmath98 therefore have a finite difference even at @xmath25 .",
    "we have shown that @xmath99 in ref .",
    "@xcite , so the constant terms in eq .",
    "( [ eqn : sehx : v1v2 ] ) are     & _ rc^rn_1^()f ( ) ,    [ eqn : sehx : barv1 ] because the integrand vanishes when @xmath100 and @xmath11 is small .",
    "similarly ,    @xmath101 decreases rapidly as @xmath102 increases , since @xmath103 decays faster asymptotically than @xmath104 .",
    "since @xmath101 is a part of @xmath98 , which only dominates the large-@xmath39 behavior of @xmath105 , the difference between the large-@xmath39 and small-@xmath39 behaviors of @xmath105 is due to the constant terms in eqs .",
    "( [ eqn : sehx : barv1 ] ) and ( [ eqn : sehx : barv2 ] ) . in the @xmath106 limit ,",
    "( [ eqn : sehx : barv1 ] ) vanishes , and eq .",
    "( [ eqn : sehx : barv2 ] ) approaches a finite negative value .",
    "the additive constant in the hx potential obtained needs to be determined by matching with the known @xmath107 behavior , and the resulting potential would show the upward ensemble derivative discontinuity step illustrated in fig .",
    "[ fig : he : deltavxc : exact ] . since",
    "both @xmath108 and @xmath109 vanish in the @xmath57 limit , there is no ensemble derivative discontinuity for sd .    ) applied to self - consistent quasi - lda results .",
    "the correction to the quasi - lda ks gap ( dashed green ) is not 0 , but it is too small to be noticed on this scale .",
    "this correction is inadequate to cancel the @xmath11-dependence in the qlda ks gap ( dashed red ) , resulting in inaccurate , @xmath11-dependent calculated optical gaps ( dashed blue ) .",
    "the gaps have been shifted in this figure by the optical gap @xmath62 for easier comparison , and the exact results of fig .",
    "[ fig : deltaedeltaeps : exact ] are also shown for context .",
    "color online . ]    ) applied to self - consistent sd results .",
    "the spin - up sd ks gap ( dashed red ) is insufficiently corrected by the sd corrections to the ks gap ( dashed green ) , yielding calculated optical gaps that are too small ( dashed blue ) . though the @xmath11-dependence is less severe than for qlda , it is still non - negligible .",
    "the gaps have been shifted in this figure by the optical gap @xmath62 for easier comparison , and the exact results of fig .",
    "[ fig : deltaedeltaeps : exact ] are also shown for context .",
    "color online . ]    ) applied to approximate self - consistent sehx results .",
    "sehx produces far less variation in calculated excitation energies with @xmath11 ( dashed blue ) , which appears to be the result of its ensemble derivative discontinuity .",
    "this produces approximate ks gaps ( dashed red ) and ks gap corrections ( dashed green ) that most closely resemble the exact curves in overall shape .",
    "the exact results ( as in fig . [ fig : deltaedeltaeps : exact ] ) are also shown for context .",
    "the gaps have been shifted in this figure by the optical gap @xmath62 for easier comparison , and the exact results of fig .",
    "[ fig : deltaedeltaeps : exact ] are also shown for context . color online . ]    figs . [",
    "fig : deltaedeltaeps : qlda ] , [ fig : deltaedeltaeps : sd ] , and [ fig : deltaedeltaeps : sehx ] demonstrate that qlda , sd , and sehx approximations are unable to generate @xmath11-independent excitation energies .",
    "the less severe @xmath11-dependence of the sehx ks gap is due to its closer replication of the exact ensemble derivative discontinuity , though the sehx cancellation of excitation energy @xmath11-dependence is not exact .",
    "[ fig : he : approx ] shows that the position of the large @xmath11 bump of sehx is at smaller @xmath39 values than the exact one .",
    "this agrees with the less rapid change of the sehx ks gap in the large-@xmath11 region . in fig .",
    "[ fig : deltaedeltaeps : sehx ] , the sharp change of the sehx ks gap in the small-@xmath11 region is similar to that of the exact ensemble , which is due to the bump created by the step in @xmath110 .",
    "qlda and sd potentials have neither the large-@xmath11 bump nor the small-@xmath11 derivative discontinuity step , so the @xmath11-dependencies of their ks gaps are very different from the exact one . comparing to figs .",
    "[ fig : he : vxcatw ] and [ fig : he : approx ] , the @xmath50 bump in the correlation potential ( fig .",
    "[ fig : he : correct : vc ] ) fixes the position of the bump in the exchange - only ( sehx ) potential , and thereby sets the @xmath11-dependence of the ks gap and its correction .",
    "this work provides a method for inverting ensemble densities , so that the resulting exact ensemble ks systems can be used as references for developing approximated edft functionals .",
    "we show the density - inversion method for spherically - symmetric systems in this paper , but it is not difficult to generalize the method for other types of systems . we have tested the density - inversion method in cylindrically - symmetric systems and it also yields good results@xcite . for systems with lower symmetry , the real - space approach shown in this paper would not yield accurate results without a massive grid point set .",
    "though expression in a basis set may solve this problem , further study is required to determine the effect this would have on the density - inversion method s stability and performance .",
    "we applied the density - inversion method on the helium singlet bi - ensemble for its simplicity .",
    "this exposes the continuous emergence of the exact xc potential bump from the ensemble derivative discontinuity and facilitates comparison with approximations .",
    "the singlet bi - ensemble is by no means the limit of the applicability of the density - inversion method , however . in ref .",
    "@xcite , we apply the method to ensembles of various real and model 2-electron systems , in which it retains the numerical stability and accuracy seen in this paper .",
    "this work illustrates that edft properties deviate from ground - state dft ones in previously unseen ways . also , some exact conditions , such as eq .",
    "( [ eqn : theory : exciteng ] ) , do not suggest obvious methods for their satisfaction by approximations .",
    "of the approximations we tested , the sehx version of gpg , the only one with an ensemble derivative discontinuity , generated the most accurate xc potentials and excitation energies .",
    "these complications make developing a good edft functional considerably harder than in ground state , and we hope the exact results shown in this work can alleviate some burden on edft developers .",
    "we thank nikitas gidopoulos for providing very helpful clarifications regarding ref .",
    "thanks yu zhang and daniel jensen for very helpful discussions on density inversion problems .",
    "z .- h.y . and c.a.u . are supported by nsf grant no .",
    "a.p.j . is supported by doe grant de - fg02 - 97er25308 .",
    "j.r.t . and r.j.n .",
    "acknowledge financial support from the engineering and physical sciences research council ( epsrc ) of the uk .",
    "k.b . supported by doe grant de - fg02 - 08er46496 ."
  ],
  "abstract_text": [
    "<S> we construct exact kohn - sham potentials for the ensemble density - functional theory ( edft ) from the ground and excited states of helium . </S>",
    "<S> the exchange - correlation ( xc ) potential is compared with the quasi - local - density approximation and both single determinant and symmetry eigenstate ghost - corrected exact exchange approximations . </S>",
    "<S> symmetry eigenstate hartree - exchange recovers distinctive features of the exact xc potential and is used to calculate the correlation potential . unlike the exact case , excitation energies calculated from these approximations depend on ensemble weight , and it is shown that only the symmetry eigenstate method produces an ensemble derivative discontinuity . </S>",
    "<S> differences in asymptotic and near - ground - state behavior of exact and approximate xc potentials are discussed in the context of producing accurate optical gaps . </S>"
  ]
}