{
  "article_text": [
    "analytical nuclear gradients for fully internally contracted complete - active - space second - order perturbation theory ( caspt2),@xcite recently developed by one of us,@xcite can not only allow for geometry optimization of strongly correlated molecules but also provide the basis for accurate and affordable computations of properties of such molecules that are sensitive to dynamical electron correlation . in this work , we develop a method for predicting hyperfine coupling constants ( hfccs ) in the electron paramagnetic resonance ( epr ) spin hamiltonian based on the caspt2 wave functions .",
    "the hyperfine coupling term in the epr spin hamiltonian is @xmath3 which accounts for coupling between nuclear and electronic spins .",
    "the hyperfine interaction causes splitting in epr spectra that is often used as an experimental probe for delocalization of unpaired electrons . here",
    "@xmath4 and @xmath5 label the cartesian components , @xmath6 is the nuclear spin vector of nucleus @xmath7 , and @xmath8 is the pseudo - spin operator of the electronic system .",
    "@xmath9 is called the hfccs formally defined as @xmath10 where @xmath11 is the energy of a molecule placed in a magnetic field generated by nuclear spins , whose vector potential in the coulomb gauge is given by @xmath12 with @xmath13 and @xmath14 being the nuclear @xmath15 value and magneton of nucleus @xmath7 , respectively .",
    "because of its importance in the interpretation of experimental epr spectra , there have been many developments of _ ab initio _ electronic structure methods for computing hfccs.@xcite for instance , the methods based on single - reference many - body perturbation and coupled - cluster theories have been studied in the past few decades.@xcite in general , the coupled cluster approaches provide benchmark accuracy when the wave function is well described by a single slater determinant .",
    "the methods based on the complete active space self - consistent field ( casscf ) and ( uncontracted ) multiconfiguration interaction ( mrci ) methods have been reported as well.@xcite yet another approach is based on density functional theory ( dft).@xcite these approaches have been generalized to relativistic analogues to account for the scalar relativistic and spin ",
    "orbit effects.@xcite recently , lan _",
    "et al._@xcite has used the casscf method with the density - matrix renormalization group ( dmrg ) algorithm to show that it is capable of reproducing experimental results when used with very large active spaces ( up to 36 orbitals ) . though the work by lan _",
    "et al._@xcite has clearly shown that the dmrg - casscf method provides benchmark accuracy for small systems , the use of such large active spaces severely limits the scope of applications ; the necessity of such large active spaces originates from the fact that the dmrg - casscf model is not designed to efficiently capture dynamical electron correlation , the importance of which has been emphasized in the previous studies based on the coupled cluster theory.@xcite to overcome this problem , a method based on caspt2 is developed in this work to efficiently and accurately describe the contributions to hfccs from both static and dynamical electron correlation .",
    "the explicit formula for the hfccs in the absence of spin  orbit coupling is @xmath16 in which @xmath17 and @xmath18 are the @xmath15 value and bohr magneton of an electron , @xmath13 and @xmath14 are those of nucleus @xmath7 , @xmath19 and @xmath20 label atomic orbitals , and @xmath21 is a spin - density matrix .",
    "the fermi - contact and spin  dipole integrals ( @xmath22 and @xmath23 , respectively ) are defined as    @xmath24    where @xmath25 , @xmath26 is its cartesian component , and @xmath27 is a gaussian basis function . in the following , we present an algorithm for computing the unrelaxed and relaxed spin - density matrices from the caspt2 wave functions , which is followed by numerical examples .",
    "the unrelaxed spin - density matrix can be written as @xmath28 according to the perturbation order , where @xmath29 and @xmath30 label any molecular orbitals .",
    "the zeroth - order contribution @xmath31 is only non - zero in the active  active block and can be readily evaluated from the reference wave function .",
    "the first - order contribution to the spin - density matrix , @xmath32 is calculated from the spin - free density matrices . here",
    ", @xmath33 is a permutation operator . for states in their highest spin projection ( @xmath34 ) , the spin - density matrices ( @xmath35 ) can be expressed in terms of the spin - free density matrices as ( in the mo representation)@xcite @xmath36,\\label{spindensity}\\end{aligned}\\ ] ] with @xmath37 being the number of electrons .",
    "the spin - free density matrices on the right hand side are those appearing in the caspt2 analytical nuclear gradient theory , i.e. ,    @xmath38    in which @xmath39 is a spin - free excitation operator . in practice",
    ", it is convenient to use the following simplified form : @xmath40 where @xmath41 is the number of active electrons , @xmath42 labels active orbitals , and @xmath43 is the set of closed orbitals .    the same trick , however , can not be applied to the second - order part , because the second - order two - body density matrix ( @xmath44 ) is not available ; therefore , we directly compute the second - order spin - density matrix , @xmath45 where @xmath46 .",
    "this is done by extending the code generator@xcite such that it can be used to compute the ",
    "@xmath47 density \" matrix , @xmath48 for instance , one of the contributions to the spin - free density matrix , @xmath49 is replaced by the following expression , @xmath50 here , we introduce partially - spin - dependent reference density matrices ,    [ spinden ] @xmath51    in which only one pair of indices are restricted to the @xmath47 spin .",
    "the higher - order analogues are likewise defined .",
    "the necessary changes in the code generator are two - fold : first , some of the factors due to spin summation should be halved when the spin - dependent operators participate in the summation as in the first term of eq .  ;",
    "second , some of the density matrices are replaced by those in eq .   and their higher - order analogues .",
    "note that the active indices in the reduced density matrices have to be sorted in a canonical way such that the spin - dependent indices can be easily identified .",
    "finally , we compute the spin - density matrix from the spin - free and @xmath47 density matrices as @xmath52 . the newly - extended code generator has been validated using the first - order contribution [ eq .  ] .",
    "we have also confirmed that the trace of @xmath53 [ eq .",
    "] is always zero as it should .",
    "the relaxed spin - density matrix is then obtained by adding orbital and configurational relaxation contributions to the above unrelaxed density matrix using the caspt2 lagrangian.@xcite the explicit formula for the relaxed caspt2 spin - density matrix is @xmath54,\\end{aligned}\\ ] ] in which @xmath55 is the orbital part of the so - called @xmath0-vector .",
    "@xmath56 is only nonzero within the active  active block , which reads @xmath57 where @xmath58 is the configuration part of the @xmath0-vector , and @xmath59 labels slater determinants in the active space .",
    "the above @xmath60 can be computed by a similar formula to eq .",
    ", since the spin - free analogues ( both one- and two - body density matrices ) are available in the code for solving the @xmath0-vector equation .",
    "regarding the terms in the lagrangian for the frozen - core approximation , we note in passing that the frozen - core constraints do not contribute to the relaxed spin - density matrix . in any event ,",
    "the frozen - core approximation is typically not used when calculating hfccs .",
    "ldd method & a^ & a^ +   + casscf ( 9@xmath61 , 8@xmath62 ) & 629.4 & -51.1 + casscf ( 9@xmath61 , 28@xmath62 ) & 596.5 & -52.3 + casscf ( 13@xmath61 , 30@xmath62 ) & 561.9 & -52.9 + caspt2 ( 9@xmath61 , 8@xmath62 ) , unrelaxed & 692.9 & -53.0 + caspt2 ( 9@xmath61 , 8@xmath62 ) , relaxed & 540.3 & -54.4 + ccsd(t ) & 556.1 & -56.7 + b3lyp & 572.6 & -59.9 + tpss & 504.8 & -59.3 + exp .",
    "( ar matrix ) & 588.1(3 ) & +   + casscf ( 9@xmath61 , 8@xmath62 ) & -19.7 & -17.9 + casscf ( 9@xmath61 , 28@xmath62 ) & -3.4 & -19.2 + casscf ( 13@xmath61 , 30@xmath62 ) & -20.1 & -19.3 + caspt2 ( 9@xmath61 , 8@xmath62 ) , unrelaxed & -15.2 & -17.5 + caspt2 ( 9@xmath61 , 8@xmath62 ) , relaxed & -17.9 & -19.8 + ccsd(t ) & -18.3 & -19.1 + b3lyp & -18.9 & -21.7 + tpss & -16.4 & -22.1 + exp .",
    "( ar matrix ) & -12.6(3 ) & -15.4(3 )    first , we applied the method to to compute the hfccs for the cn radical ( the bond length was set to @xmath63   ) .",
    "the results are complied in table  [ cntable ] .",
    "the epr - iii basis set@xcite was used together with a nearly complete fitting basis set consisting of [ @xmath64 functions .",
    "the errors due to the density fitting approximation with the above fitting basis set were found negligible to all the digits shown in the table .",
    "the full valence active space was used ( 9 electrons in 8 orbitals ) in the caspt2 calculation .",
    "the caspt2 results were compared with the previously reported dmrg - casscf results,@xcite that computed by ccsd(t),@xcite those from dft,@xcite and the experimental values ( using ar matrix).@xcite kossmann and neese used a slightly different bond length ( @xmath65   ) in their ccsd(t ) calculation , though it has been shown that this difference only affects the hfccs by up to @xmath66  mhz.@xcite    the full valence caspt2 results using the relaxed spin - density matrix agree very well with the ccsd(t ) results with differences up to 24  % for both isotropic and dipolar contributions .",
    "it is apparent from table  [ cntable ] that the use of the relaxed spin - density matrix is essential in caspt2 hfcc calculations ; the unrelaxed values are far worse than the casscf ones in this case .",
    "the discrepancy between the caspt2 values and the experimental results should be ascribed to the remaining electron correlation contributions , vibrational contributions , basis - set incompleteness , and the use of ar matrix in the experiment .",
    "the wall time for computing the hfccs using the caspt2 relaxed density matrix ( excluding the casscf reference calculations ) was about 4  min using 4 computer nodes , each of which consists of 2 xeon e5 - 2650 sandy bridge , 2.0  ghz and infiniband qdr interconnects .",
    "note that the program is parallelized using mpi3 s remote memory access protocol . threading within a node can still improve .",
    "the results show that the hfccs computed by caspt2 are as accurate as those from dmrg - casscf using an active space as large as cas(13@xmath61 , 30@xmath62 ) with a fraction of the computational costs .",
    "ldd method & a^ & a^ +   + casscf ( 9@xmath61 , 8@xmath62 ) & 830.1 & -47.6 + casscf ( 15@xmath61 , 28@xmath62 ) & 629.3 & -53.1 + casscf ( 15@xmath61 , 33@xmath62 ) & 573.1 & -54.8 + casscf ( 21@xmath61 , 36@xmath62 ) & 712.7 & -54.2 + caspt2 ( 9@xmath61 , 8@xmath62 ) , unrelaxed & 998.8 & -53.3 + caspt2 ( 9@xmath61 , 8@xmath62 ) , relaxed & 788.3 & -55.8 + b3lyp & 512.2 & -60.0 + tpss & 656.8 & -56.1 + ccsd(t ) & 565.3 & -56.2 + exp .",
    "( gas phase ) & 738.0(14 ) & -56.4(1 ) + exp .",
    "( ne matrix ) & & -53.0(7 ) +   + casscf ( 9@xmath61 , 8@xmath62 ) & -1.3 & 37.3 + casscf ( 15@xmath61 , 28@xmath62 ) & -42.3 & 49.2 + casscf ( 15@xmath61 , 33@xmath62 ) & -57.3 & 55.5 + casscf ( 21@xmath61 , 36@xmath62 ) & -35.0 & 52.2 + caspt2 ( 9@xmath61 , 8@xmath62 ) , unrelaxed & -0.5 & 34.4 + caspt2 ( 9@xmath61 , 8@xmath62 ) , relaxed & 13.4 & 52.6 + b3lyp & 8.2 & 66.2 + tpss & 9.5 & 59.9 + ccsd(t ) & 19.3 & 58.9 + exp .",
    "( ne matrix ) & 2 & 50    lddd method & & & + ub3lyp & -162 & 32 & -163 + ubp & -166 & 33 & -164 + rohf & 0.0 & 0.0 & 0.0 + casscf ( 10@xmath62 ) & -0.6 & -23.1 & 66.8 + casscf ( 14@xmath62 ) & -126.1 & 4.2 & -106.3 + casscf ( 19@xmath62 ) & -120.5 & 4.1 & -117.2 + casscf ( 23@xmath62 ) & -132.7 & 8.9 & -113.0 + caspt2 ( rohf ) & -268.9 & 56.8 & -301.6 + caspt2 ( 10@xmath62 ) & -232.0 & 45.3 & -224.2 + @xmath67so & -10 & 3 & -2 + exp . &",
    "-247 & 55 & -245    next , we computed the hfccs for the alo radical ( @xmath68   ) .",
    "the iglo - iii and epr - iii basis sets were used for al and o , respectively,@xcite and the active space was chosen to be the full valence space consisting of 9 electrons in 8 orbitals .",
    "the same nearly - complete fitting basis set was used , as described above .",
    "the caspt2 results were compared to those obtained by the dmrg - casscf,@xcite ccsd(t),@xcite and dft@xcite and the experimental values.@xcite the previous computations were performed using the same basis set .",
    "the results have been tabulated in table  [ alotable ] . since the ground state of the alo radical has a multi - configuration character due to the resonance between al@xmath69o@xmath70 and al@xmath71o@xmath72 , single - reference electron correlation methods , such as ccsd(t ) ,",
    "fail to describe the spin - density matrix accurately , resulting in errors in the predicted hfccs up to 170  mhz.@xcite the values obtained by caspt2 for the al and o centers are comparable and superior to the largest dmrg - casscf computation reported in ref .  , respectively , albeit much reduced computational costs .",
    "the deviations from the experimental values on the al center are only 7  % and 1  % for the isotropic and dipolar contributions , respectively .",
    "the deviations on the o center are 11 and 3  mhz .",
    "it is again observed that the use of the relaxed spin - density matrix is crucial for accurate computation of hfccs .",
    "o)@xmath73 ( m @xmath74 v@xmath1 , cr@xmath2 , and mn@xmath1).[active],scaledwidth=48.0% ]    finally , we applied our method to the isotropic transition - metal hfccs for @xmath75[v(h@xmath76o)@xmath73]@xmath71 , @xmath75[cr(h@xmath76o)@xmath73]@xmath78 , and @xmath79[mn(h@xmath76o)@xmath73]@xmath71 .",
    "note that the anisotropic hfccs are zero due to symmetry .",
    "the molecular structures were determined at the ub3lyp - d3bj/6 - 31 g * * level of theory ( the geometric data are given in the supporting information ) .",
    "the active orbitals are shown in fig .  [",
    "active ] ; 10 orbitals were included in the caspt2 calculations , consisting of 3s , 4s , and 3d orbitals and t@xmath80 4d orbitals of the transition metals , some of which were mixed with ligand orbitals .",
    "the casscf calculations were performed using the orz package of yanai and co - workers , and the resulting orbitals were read via the molden interface in bagel and used in the caspt2 calculation .",
    "the triply polarized [ cp(ppp ) ] basis set@xcite and the def2-svp basis set@xcite were used for the transition metals and ligands , respectively .",
    "the def2-tzvpp - jkfit basis set@xcite was used for density fitting in the caspt2 calculations .",
    "the errors due to density fitting were found to be negligible .    the calculated isotropic hfccs are shown in table  [ metaltable ] , together with the experimental values taken from ref .",
    "( the original experimental works were reported in refs .   and ,",
    "from which these values were derived ) .",
    "the results from dft@xcite and large - scale casscf based on the dmrg algorithm with @xmath81 are also shown .",
    "the caspt2 values based on the rohf ( 3 active orbitals for the v@xmath1 and cr@xmath2 complexes and 5 active orbitals for the mn@xmath1 complex ) and 10-orbital casscf references are both in good agreement with the experimental values ; the former slightly overestimates the magnitude of the hfccs ( up to 50  mhz for @xmath79[mn(h@xmath76o)@xmath73]@xmath71 ) , while the latter is consistently within 20  mhz from the experimental values .",
    "orbit contributions estimated by dft in ref .   suggest that the agreement would improve if the results are corrected for the spin  orbit effect .",
    "it is worth noting that the caspt2 method provides excellent accuracy without breaking the spin symmetry .",
    "for these complexes , spin - unrestricted b3lyp severely underestimate the hfccs values .",
    "the dmrg - casscf results , even with 23 orbitals in the active space , underestimate the magnitudes of the metal hfccs by 50130 mhz , which clearly shows that the explicit treatment of dynamical correlation is necessary for accurate simulation of the hfccs .",
    "the wall times for computing the caspt2 values are around 2 min on 16 cpu cores ( 2 xeon e5 - 2650 cpus ) with the rohf reference and 15 min on 64 cpu cores ( 8 xeon e5 - 2650 cpus ) with the 10-orbital casscf reference , respectively .",
    "in this work , we have developed an algorithm for computing the hfccs from the caspt2 spin - density matrices including orbital and configurational relaxation and implemented it into and an efficient computer program .",
    "the program is an extension of the analytical nuclear gradient code for fully internally contracted caspt2.@xcite in our implementation , spin - density matrices can be computed as efficiently as spin - free analogues , owing to the use of partially spin - dependent density matrices .",
    "we have applied this approach to the cn and alo radicals and the hexaaqua complexes with v@xmath1 , cr@xmath2 , and mn@xmath1 to demonstrate the accuracy and efficiency of our program .",
    "the code has been implemented in the bagel package,@xcite which is publicly available under the gnu general public license .",
    "the implementation in the orz package is under way . to account for relativistic contributions to hfccs , generalization of the present work to the fully relativistic framework based on the four - component dirac equation",
    "will be investigated in the future .",
    "t.s . has been supported by the national science foundation career award ( che-1351598 ) .",
    "the development of the underlying program for the caspt2 nuclear gradients was in part supported by the air force office of scientific research young investigator program ( afosr grant no .  fa9550 - 15 - 1 - 0031 ) .",
    "t.y . acknowledges support by jsps kakenhi grant numbers jp16h04101 and jp15h01097 .",
    "44ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ] ",
    "+ 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop  ,   ( ) in  @noop _",
    "_ ,  ( , ,  )  chap",
    ".  , pp .   @noop",
    "* * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) in  @noop _ _ ,  vol .",
    "( ,  , )  pp .   @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) in  @noop _ _ ,  ( ,  ,  ) pp .",
    "@noop * * ,   ( ) @noop"
  ],
  "abstract_text": [
    "<S> we present an accurate method for calculating hyperfine coupling constants ( hfccs ) based on the complete active space second - order perturbation theory ( caspt2 ) with full internal contraction . </S>",
    "<S> the hfccs are computed as a first - order property using the relaxed caspt2 spin - density matrix that takes into account orbital and configurational relaxation due to dynamical electron correlation . the first - order unrelaxed spin - density matrix </S>",
    "<S> is calculated from one- and two - body spin - free counterparts that are readily available in the caspt2 nuclear gradient program [ m. k. macleod and t. shiozaki , j. chem . </S>",
    "<S> phys . * 142 * , 051103 ( 2015 ) ] , whereas the second - order part is computed directly using the newly extended automatic code generator . </S>",
    "<S> the relaxation contribution is then calculated from the so - called @xmath0-vectors that are available in the caspt2 nuclear gradient program . </S>",
    "<S> numerical results are presented for the cn and alo radicals , for which the caspt2 values are comparable ( or , even superior in some cases ) to the ones computed by the coupled - cluster and density matrix renormalization group methods . </S>",
    "<S> the hfccs for the hexaaqua complexes with v@xmath1 , cr@xmath2 , and mn@xmath1 are also presented to demonstrate the accuracy and efficiency of our code . </S>"
  ]
}