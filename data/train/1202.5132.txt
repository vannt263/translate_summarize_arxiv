{
  "article_text": [
    "inference of evolutionary or _",
    "phylogenetic _ trees is a fundamental task in many areas of biology , and tree estimation has developed over several decades into a mature statistical field @xcite . on a phylogenetic tree , leaves correspond to existing observed taxa , internal vertices correspond to ancestral taxa , and branch lengths represent the degree of evolutionary divergence between taxa .",
    "a  phylogenetic tree representing the division and divergence of different species is called a _",
    "species tree_. however , individual regions of dna can evolve according to trees that differ from the underlying species tree , and an inferred phylogenetic tree from a particular gene or dna region is called a _ gene tree_. gene trees can differ from the species tree for several reasons : random variation in the process of dna letter substitution ; population effects by which the evolutionary course of an individual gene does not match that of the species as a whole @xcite ; and even relatively rare events whereby genetic material is exchanged between species in a nontree - like manner @xcite .",
    "phylogenetic analysis of a number of different genes in a fixed set of species therefore generally gives rise to a collection of alternative phylogenetic trees .",
    "collections of alternative phylogenetic trees also arise from inferential methods that involve simulation : bootstrap replication and mcmc sampling from bayesian posteriors are widely used in the construction of phylogenetic estimates .",
    "given such a collection of alternative trees , whether gene trees or a simulated sample , identifying differences and quantifying variation is a difficult problem , since we might potentially have several hundred trees on thousands of species .",
    "standard multivariate statistical methods such as clustering @xcite and multi - dimensional scaling ( mds ) @xcite have been used to address this problem .",
    "principal components analysis ( pca ) , in contrast , can not be applied directly since the space of phylogenetic trees on a fixed set of species is not a euclidean vector space .",
    "this paper describes a geometric approach to pca for sets of alternative phylogenetic trees .",
    "the aim is to identify which tree features are most variable within a given set of trees and to quantify this variation  just as the first few components in regular pca pick out the most variable features of a euclidean data set . although pca has been used to analyze different phylogenetic data previously ( such as distance matrix data ) , the method presented here is the first to work intrinsically within the space of phylogenetic trees",
    ". the approach relies to a large extent on existing mathematical tools , and the main novel contribution comes from combining those elements into a computationally feasible method .",
    "a key feature of our approach is the incorporation of both topological and geometrical information from the trees under analysis , via the so - called _ geodesic metric _ on the space of trees @xcite .",
    "_ topological _ information refers to the exact pattern of branching within a tree , while _ geometrical _",
    "information refers to the distances between taxa induced by branch lengths on the tree .",
    "topological features are generally more straightforward to characterize in a set of alternative trees , by counting the proportion of trees containing a given feature . for example , bootstrap replicate data sets are often represented by a single `` consensus '' tree annotated with a percentage support for each clade within the tree @xcite .",
    "however , the geometry and topology of evolutionary trees are intimately related : we can continuously change the topology of a tree by shrinking down the length of any internal branch and expanding out an alternative branch in its place , as shown in figure [ figstitch ] .    ,",
    "different quadrants are joined along their edges .",
    "tree @xmath0 can be continuously deformed into tree @xmath1 by shrinking down the branch @xmath2 via tree @xmath3 and replacing it with the branch @xmath4 .",
    "it follows that tree @xmath1 is obtained from @xmath0 via nearest neighbor interchange ( nni ) of the split @xmath5 into split @xmath6 .",
    "however , at @xmath3 another nni move is possible : @xmath5 could be replaced by @xmath7 , corresponding to the lower left quadrant . ]",
    "recent authors @xcite have stressed the importance of using geometrical information to draw comparisons between trees on account of the interdependence of tree geometry and topology , and due to the increased distinguishability obtained by using continuous rather than discrete metrics .",
    "moreover , tree geometry plays an important role in inference : it has been shown that long branches tend to `` attract '' each other , leading to mistakes in the topology of inferred trees @xcite .",
    "taking a set of alternative phylogenetic trees on some fixed set of taxa as input , our approach identifies a path @xmath8 through tree - space that can be thought of analogously to the first principal component in regular euclidean pca .",
    "the path consists of a smoothly changing tree structure in which certain branches expand or shrink .",
    "alternative topologies emerge when internal branches are shrunk to have zero length and are then replaced with topologically distinct branches .",
    "the path @xmath8 is constructed in such a way that the changing features  both in terms of topology and geometry  correspond to the most variable features within the data set . just as for regular pca",
    ", @xmath8 also captures correlations in the data set : features that tend to occur together in the data are also represented together on @xmath8 .",
    "a quantitative measure of variability can be assigned to @xmath8 , in analogy with the proportion of variance contributed by each component in regular pca . unlike euclidean vector spaces",
    ", there is no inner product on tree - space , and so the analysis can not be extended in a straightforward manner to provide higher order principal paths by working orthogonally to @xmath8 .",
    "further discussion is given in section  [ secconc ] .",
    "our approach  which we will refer to as @xmath9pca ( for `` phylogenetic '' pca)is motivated by geometrical analogy with regular vector space pca .",
    "construction of the first principal component in a euclidean vector space can be thought of as follows :    given a set of vectors @xmath10 identify the centroid @xmath11 .    for a fixed line @xmath8 through @xmath11 take the orthogonal projection of the points @xmath10 onto @xmath8 .",
    "identify the line that maximizes the variance of the projected points along  @xmath8 , or , equivalently , which minimizes the sum of squared orthogonal distances of the points from the line .    for a euclidean vector space ,",
    "these steps can be re - expressed and solved in terms of simple linear algebra .",
    "however , the space of phylogenetic trees on a  fixed set of taxa is not a euclidean vector space , so these steps can not be applied directly in the same way to sets of alternative phylogenies .",
    "tree - space can be equipped with various metrics that allow geometry to be performed , and for reasons described below , we use the geodesic metric @xcite .",
    "@xmath9pca then follows a similar set of steps to those above , but working with the geodesic metric , @xmath12 . in step",
    "( 2 ) , the lines @xmath8 become paths in tree - space with the property that , for any pair of points on the path , the path coincides with the geodesic between the points .",
    "trees @xmath10 are `` projected '' onto each path by finding points @xmath13 on the path that minimize the distance @xmath14 for @xmath15 .",
    "pythagoras theorem does not hold in tree - space , so in the analog of step ( 3 ) , paths which maximize the variance can be different from paths which minimize the sum of squared distances .",
    "we consider searching for both types of paths .",
    "step ( 3 ) is potentially excessively computationally demanding , and so we describe ( i ) a greedy algorithm for constructing optimal paths and ( ii ) a monte carlo optimization approach .",
    "the methods we propose for steps ( 2 ) and ( 3 ) form the novel contribution of this paper . `` projection '' of points onto a geodesic path @xmath8 in step ( 2 ) is relatively simple to perform using existing methods for computing the geodesic metric , but a detailed algorithm has not been given previously .",
    "searching over the set of possible paths is more technically demanding .",
    "consideration of this particular problem and the solutions we present appear to be entirely novel .",
    "the development of @xmath9pca has been influenced by a recent paper by wang and marron @xcite .",
    "wang and marron addressed a similar problem , developing a form of pca for data sets with a tree - like structure . in a  second paper @xcite",
    ", they applied their method to sets of trees obtained from medical imaging data .",
    "in particular , their reformulation of pca in terms of the geometrical steps specified above motivated the corresponding steps in @xmath9pca .",
    "other authors have also developed analogs of pca in nonstandard geometries @xcite , and wang and marron give an excellent overview of this area of research @xcite .",
    "however , it must be stressed that the method of wang and marron does not apply to sets of phylogenetic trees , and that @xmath9pca is not simply a reworking of their approach . on account of the ostensible similarities between the approaches ,",
    "we devote a section to explaining the relationship between them later in the paper .",
    "the remainder of the paper is structured in the following way .",
    "we first describe the geometry of tree - space and set up necessary notation and mathematical background .",
    "section [ secmethods ] contains a description of the @xmath9pca approach and proofs of its properties .",
    "we then explain more fully the relationship to the work of wang and marron , before evaluating @xmath9pca on simulated sets of trees and a real set of gene trees from metazoan species .",
    "we will work throughout with a fixed set of taxa @xmath16 and the set of unrooted phylogenetic trees @xmath17 on @xmath18 . given a tree @xmath19 , cutting any branch on @xmath0 partitions the taxa into two unordered nonoverlapping sets .",
    "such a partition is called a _ split _ , and splits are usually denoted @xmath20 where @xmath21 and @xmath22 denotes the complement in @xmath18 .",
    "there are @xmath23 possible ( nonempty ) splits of the set @xmath18 , and the set of these is denoted @xmath24 .",
    "it is crucial to note that arbitrary sets of splits do not generally correspond to valid tree topologies  a compatibility condition must be satisfied .",
    "for example , if @xmath25 , then the two splits @xmath26 and @xmath27 can not both be represented on the same tree .",
    "any tree @xmath19 can be regarded as a weighted set of compatible splits , where the weight assigned to each split is given by the length of the corresponding branch on @xmath0 .",
    "we only consider trees with positive branch lengths .",
    "we write @xmath28 to denote the set of splits in @xmath0 , and encapsulate the branch lengths via a function @xmath29 defined by @xmath30 tree - space @xmath17 can then be embedded in @xmath31 in the following way .",
    "take the standard basis of @xmath31 and associate each split @xmath32 with a different basis vector @xmath33 .",
    "any tree @xmath19 can then be associated uniquely with the vector @xmath34 in fact , it is convenient to abuse notation slightly and write @xmath35 for the basis vector  @xmath33 , identifying each split directly with the corresponding vector in  @xmath31 .",
    "equation ( [ equembed ] ) essentially associates every tree @xmath0 with a vector of branch lengths , but due to the compatibility relations between splits , not every such vector corresponds to a tree .",
    "in fact , each tree contains at most @xmath36 splits , so as the number of taxa @xmath37 increases , @xmath38 and @xmath17 becomes an increasingly sparse subset of @xmath31 .",
    "since a collection @xmath10 of trees can be regarded as a set of vectors @xmath39 , why not just perform pca on these vectors ? in general , the principal components obtained in this way will not correspond to valid trees , and interpretation of the principal components becomes impossible .",
    "a form of pca which operates intrinsically within @xmath17 and which produces interpretable `` components '' is required .",
    "the geometry of @xmath17 was first comprehensively studied in a paper by billera et al .",
    "@xcite , which included the definition and proof of existence of geodesics . their description of @xmath17 amounts to a decomposition into a set of overlapping component pieces , each piece corresponding to a different tree topology .",
    "in this section we recall aspects of this decomposition which are central to @xmath9pca , most importantly for the definition of geodesics on  @xmath17 .",
    "the decomposition is easiest to understand by identifying @xmath17 with its image under the embedding in @xmath31 .",
    "every tree in @xmath17 contains the set of splits corresponding to terminal edges ( those that end in a leaf ) , denoted @xmath40 .",
    "since every tree contains every terminal split @xmath41 where @xmath42 denotes the span of vectors with nonnegative weights , and  @xmath43 is the part of tree - space corresponding to internal splits .",
    "next consider a  single unrooted tree @xmath0 which is fully resolved , by which we mean every internal vertex has exactly 3 neighbors .",
    "let @xmath44 denote the topology of @xmath0 or , more precisely , the set of nonterminal splits @xmath45 .",
    "since @xmath0 is fully resolved , it has @xmath46 internal edges , so @xmath44 contains @xmath46 splits .",
    "the internal branch lengths of any tree with topology @xmath44 are determined by a point in @xmath47 .",
    "we call @xmath48 the _ topological orthant _ containing @xmath0 , and it is isomorphic to the positive orthant of @xmath49 .",
    "the faces of the orthant  @xmath48 correspond to trees that have some zero length branches .",
    "such trees are not fully resolved or , in other words , some internal vertices have more than  3 neighbors .",
    "this structure is illustrated in figure [ figstitch ] .",
    "tree - space @xmath17 is formed from the union of the orthants @xmath48 over all possible fully resolved topologies @xmath44 : @xmath50 the individual orthants @xmath48 are stitched together along their faces , since each unresolved tree occurs on the face of more than one orthant . to understand how the orthants are stitched together in more detail ,",
    "consider a  point on the face of an orthant @xmath48 at which a single branch length corresponding to a split  @xmath51 has been collapsed to zero .",
    "as illustrated in figure [ figstitch ] , there are two ways in which this branch can be replaced with an alternative , thereby obtaining a fully resolved tree with a different topology .",
    "each -dimensional face of @xmath48 is therefore identified with corresponding faces in two other orthants @xmath52 and @xmath53 . the operation illustrated in figure  [ figstitch ] is called _ nearest neighbor interchange _ ( or nni ) ; we say that topologies  @xmath54 and @xmath55 are obtained by nni of the split @xmath51 within @xmath44 .",
    "faces of @xmath48 with co - dimension greater than @xmath56 will be contained in more than two other orthants .",
    "later , we will need to deal with paths in @xmath17 between such faces and so we need to extend the definition of nni ( which is usually taken as a relationship between strictly binary trees ) .",
    "given a split @xmath51 in a fixed tree , there are two or more subtrees hanging from each end of the associated edge in the tree .",
    "an _ extended _ nni move ( or xnni ) consists of swapping a subtree from one end of the branch with a  subtree from the opposite end .",
    "this operation removes split @xmath51 from the tree and replaces it with an incompatible split @xmath57 . on a  binary tree",
    "this definition coincides with the standard definition of nni @xcite , and xnni includes all nni moves .",
    "@xmath17 can be equipped with metrics via the embedding into @xmath31 described above .",
    "in particular , @xmath58 norm on  @xmath31 defines a metric : latexmath:[$d_2(x , y ) =    intrinsic to tree - space .",
    "for example , when @xmath0 and @xmath3 have different topologies , @xmath60 corresponds to the length of a straight line segment joining @xmath0 to @xmath3 through @xmath31 , but this line contains points outside the image of @xmath17 under the embedding .",
    "billera et al .",
    "@xcite proved the existence of a metric that locally resembles the @xmath58 metric , but which is intrinsic to @xmath17 independent of the embedding in @xmath31 .",
    "this metric is called the _ geodesic _",
    "metric @xmath61 , and it is the canonical metric for @xmath9pca due to its intrinsic nature .",
    "it is defined as follows . for two trees @xmath0 and @xmath3 with the same topology , @xmath62 .",
    "when @xmath0 and  @xmath3 have different topologies , @xmath63 is defined as the length of the shortest continuous path joining @xmath0 to @xmath3 in @xmath17 which consists of a series of straight line segments through any feasible sequence of topological orthants .",
    "the length of such a path is defined to be the sum of the euclidean lengths of each constituent line segment .",
    "the shortest such path joining @xmath0 to @xmath3 is called the _ geodesic _ between @xmath0 and @xmath3 .",
    "the proof that geodesics exist between points in  @xmath17 and that geodesics define a valid metric is given in @xcite .",
    "as part of the proof , billera et al .",
    "@xcite showed that tree - space is cat@xmath64 @xcite .",
    "this means that triangles in @xmath17 are `` skinny '' in comparison to triangles in the euclidean plane .",
    "more formally , given points @xmath65 , consider the triangle between points @xmath66 in the euclidean plane with the same edge lengths , so that @xmath67 , etc . if @xmath68 is the path - length parameterized geodesic between @xmath0 and @xmath3 and @xmath69 the corresponding geodesic in the euclidean plane , then @xmath70 for all points @xmath68 between @xmath0 and @xmath3 .",
    "( 20,18 )    ( 10.0,9.0)(0,1)8 ( 10.0,9.0)(0,-1)8 ( 10.0,9.0)(1,0)8 ( 10.0,9.0)(-1,0)8 ( 8.2,17.3)@xmath71 ( 17.3,8.0)@xmath72 ( 8.2,0.0)@xmath73 ( 0.5,8.0)@xmath74    ( 10.0,9.0)(0.25,0)26(0,-0.25)26(1,-1)1.0 ( 2.0,16.0)(-1,1)1 ( 2.0,16.0)(1,1)1 ( 2.0,15.0)(1,0)1 ( 2.0,15.0)(0,1)1 ( 3.0,15.0)(1,1)1 ( 3.0,15.0)(1,-1)1 ( 2.0,15.0)(-1,-1)1 ( 0.5,17.1)@xmath75 ( 3.0,17.1)@xmath76 ( 4.1,16.1)@xmath77 ( 4.0,13.3)@xmath78 ( 0.5,13.3)@xmath79    ( 16.0,16.0)(-1,1)1 ( 16.0,16.0)(-1,-1)1 ( 18.0,16.0)(1,1)1 ( 18.0,16.0)(1,-1)1 ( 17.0,16.0)(1,0)1 ( 17.0,16.0)(-1,0)1 ( 17.0,16.0)(0,1)1 ( 14.5,17.1)@xmath75 ( 16.8,17.1)@xmath76 ( 19.1,17.1)@xmath77 ( 19.0,14.3)@xmath78 ( 14.5,14.3)@xmath79    ( 2.0,4.0)(-1,1)1 ( 2.0,4.0)(1,1)1 ( 2.0,2.0)(-1,-1)1 ( 2.0,2.0)(1,-1)1 ( 2.0,3.0)(1,0)1 ( 2.0,3.0)(0,1)1 ( 2.0,3.0)(0,-1)1 ( 0.5,5.2)@xmath75 ( 3.0,5.2)@xmath76 ( 3.1,2.8)@xmath77 ( 2.9,0.2)@xmath78 ( 0.5,0.2)@xmath79    ( 12.0,15.0 ) ( 4.0,7.0 ) ( 7.0,4.0 ) ( 15.0,12.0 ) ( 12.2,15.2)@xmath80 ( 3.8,6.3)@xmath81 ( 6.5,3.3)@xmath82 ( 15.2,12.2)@xmath83    ( 4.0,7.0)(1,1)8 ( 10.0,9.0)(5,3)5 ( 10.0,9.0)(-3,-5)3    geodesics in @xmath17 have the following properties .",
    "first , if @xmath84 have the same topology @xmath44 , then the geodesic joining them is the obvious euclidean line segment in  @xmath48 .",
    "second , when @xmath0 and @xmath3 have some but not all splits in common , the splits in the intersection @xmath85 are all included at every point along the geodesic . the length of the branch associated to @xmath86 changes in the obvious linear way from @xmath87 to @xmath88",
    "third , when @xmath0 and  @xmath3 have different topologies , the geodesic may pass through other topological orthants than the two associated with @xmath0 and  @xmath3 , as illustrated by figure [ figgeodesicandcone ] .",
    "this is the case for points @xmath80 and @xmath81 in the figure . , trees along the geodesic only ever contain splits from @xmath89 , albeit in different combinations .",
    "it follows that when @xmath0 and @xmath3 have different topologies , computing the geodesic distance  @xmath63 is nontrivial .",
    "however , an efficient polynomial - time algorithm has been developed for constructing geodesics @xcite , and we use this algorithm to calculate distances in @xmath9pca .",
    "a crucial feature of cat@xmath64 spaces is that paths which are everywhere locally geodesic are necessarily globally geodesic ( see @xcite , lemma 2.1 ) .",
    "geodesics like that between @xmath80 and @xmath81 in figure [ figgeodesicandcone ] must therefore not `` bend '' as they cross between different orthants .",
    "for some pairs @xmath90 , however , the shortest path is given by collapsing branch lengths for splits in @xmath91 down to zero , so that the topology is then @xmath92 followed by expanding out branch lengths in @xmath93 to obtain @xmath3 .",
    "any two points can be joined by such a path , and they are referred to as _ cone paths_. in figure [ figgeodesicandcone ]",
    "the cone path coincides with geodesic for points @xmath83 and @xmath82 ; geodesic between @xmath94 is clearly shorter than the cone path .",
    "we now have the geometrical ingredients needed to define the @xmath9pca procedure .",
    "@xmath9pca seeks to construct a  principal path from the set of @xmath17-lines defined as follows .",
    "[ defline ] a path @xmath95 in @xmath17 is a @xmath17-_line _ if :    every sub - path of @xmath95 is the geodesic between its endpoints , and    @xmath95 extends to infinity in two directions .",
    "we will often just use the term _ line _ to mean a @xmath17-line where the context is obvious .",
    "results in @xcite show that any geodesic can be extended into a  @xmath17-line ( though often not uniquely ) .",
    "the following proposition establishes existence and uniqueness of closest points on lines .",
    "[ propproj ] given a @xmath17-line @xmath8 and a point @xmath19 , there is a  unique closest point @xmath96 to @xmath0 .",
    "the proof relies mainly on the cat@xmath64 property to enable comparison with euclidean space .",
    "let @xmath97 be any point on @xmath8 and suppose  @xmath98 is a  path - length parameterization of @xmath8 such that @xmath99 .",
    "defining @xmath100 , consider the triangle @xmath101 for some @xmath102 .",
    "the `` skinny '' triangle property implies that @xmath103 the same bound applies to @xmath104 .",
    "the closest point @xmath96 , if it exists , must therefore lie on @xmath98 for @xmath105 $ ] .",
    "since this is a compact set and since the geodesic distance is a continuous function , @xmath106 achieves its minimum on the interval . to prove uniqueness of the closest point @xmath3 ,",
    "suppose two distinct points @xmath107 achieve the same minimum distance @xmath108 .",
    "again , the `` skinny '' triangle property for the triangle @xmath109 implies that points on @xmath8 between @xmath3 and @xmath110 are closer to @xmath0 than distance @xmath108 .",
    "this is a contradiction , so  @xmath3 is unique .",
    "now suppose we are given a set of points @xmath111 . for every line  @xmath8 through",
    "@xmath97 we can obtain the projection @xmath112 of @xmath113 onto  @xmath8 .",
    "this defines two functions , @xmath114 and @xmath115 , which are , respectively , defined as the sum of squared distance along @xmath8 , @xmath116 , and the sum of squared distances perpendicular to @xmath8 , @xmath117 .",
    "there is a @xmath17-line through @xmath97 which maximizes @xmath118 .",
    "similarly , there is a @xmath17-line through @xmath97 which minimizes @xmath119 .    we know from the proof of proposition [ propproj ] that given any line @xmath8 through @xmath97 , the points @xmath13 are at most distance @xmath120 from @xmath97 , where @xmath121 .",
    "let @xmath122 be the sphere @xmath123 .",
    "each pair @xmath124 represents a pair of geodesics @xmath125 and @xmath126 .",
    "if @xmath127 , then necessarily the geodesic between @xmath1 and @xmath128 is exactly  @xmath125 followed by @xmath126 , and we say @xmath129 are _",
    "antipodal_. every line  @xmath8 through @xmath97 determines an antipodal pair @xmath130 , and since the projected points @xmath13 all lie on the geodesic between that pair , @xmath118 and @xmath119 only depend on the pair @xmath130 . by continuity of the function @xmath131 ,",
    "the set of antipodal pairs is a closed subset of @xmath132 and is therefore compact .",
    "it follows that there is a geodesic between antipodal points on @xmath122 which optimizes either @xmath118 or @xmath119 .",
    "the geodesic can be extended into a line , and that establishes the proposition",
    ".    the optimal line may be nonunique for two reasons .",
    "first , different extensions of the geodesic between an antipodal pair @xmath130 might exist .",
    "this would arise , for example , if all the points @xmath10 lay in the same topological orthant .",
    "second , as in regular euclidean pca , the collection of points @xmath133 can be isotropic , so that the optimal pair @xmath130 is nonunique .    given the existence of optimal @xmath17-lines , we can now consider how to construct a principal line .",
    "as outlined in the , construction of the principal line consists of the following steps :    given trees @xmath10 , construct a `` central point '' @xmath97 .    given a line @xmath8 through @xmath97 , `` project '' @xmath10 onto @xmath8 by finding the closest point @xmath13 in @xmath8 to @xmath134 for @xmath135 .",
    "find the line @xmath8 such which optimizes the particular choice of objective function @xmath136 ( either @xmath118 or @xmath119 ) .",
    "the details of each of these steps is described in turn , but step 3 forms the main challenge .      ideally , @xmath97 should be chosen so as to minimize the sum of squared distances : @xmath137 in a euclidean vector space , this reduces to finding the mean of the data @xmath138 . in tree - space ,",
    "due to the lack of additive structure , the mean does not make sense , and there is no known closed solution to ( [ equmidpoint ] ) . instead , billera et al .",
    "@xcite suggest using the _ centroid _ , which is defined via a  recursive procedure based on finding the midpoint along the geodesic between any two points .",
    "however , for large data sets , this procedure is computationally demanding .",
    "we therefore propose taking @xmath97 to be the _ majority consensus _",
    "tree @xcite .",
    "finding an `` average '' or consensus tree is a well - studied problem in phylogeny @xcite and various forms of consensus tree exist .",
    "the majority consensus topology consists of splits which are found in strictly more than half the trees @xmath10 .",
    "branch lengths on @xmath97 are assigned their average value in the data set : @xmath139 for all @xmath140 where @xmath141 is the set @xmath142 .",
    "results obtained later in this paper were obtained using this choice of @xmath97 .",
    "however , construction of the principal line @xmath8 does not rely on any particular properties of the point  @xmath97 , and @xmath9pca works with any sensible choice .",
    "given any line @xmath8 and points @xmath143 , proposition [ propproj ] established the existence of closest points @xmath144 .",
    "here we describe computational aspects of this `` projection '' onto @xmath8 .",
    "although this relies on existing mathematics , as presented in section [ secbackground ] , the details of an algorithm for projection onto a geodesic path have not previously been given .",
    "we will assume @xmath98 is a path - length parameterization of @xmath8 .",
    "for each point @xmath134 , euclidean projection under the embedding into @xmath145 described in section [ secsplits ] is used to obtain a first guess @xmath146 for @xmath3 .",
    "amenta et al .",
    "@xcite showed that the geodesic distance between two points is bounded by the euclidean distance : @xmath147 it follows that if @xmath148 denotes the euclidean distance between @xmath134 and @xmath146 , then @xmath13 lies on @xmath149 .",
    "this bounding interval for @xmath13 is used as the starting point for a golden - ratio search , which is iterated until some tolerance on @xmath13 is achieved .",
    "it can be shown that finding @xmath13 is a convex optimization , so the golden - ratio search is guaranteed to converge .",
    "the proof of convexity relies on the cat(0 ) property and convexity of the equivalent euclidean problem .",
    "the algorithm of owen and provan @xcite is used to calculate geodesic distance during the golden - ratio search .",
    "however , it is not necessary to recompute geodesics from scratch at every iteration : the sequence of orthants for a  geodesic at one iteration can often be reused in the next iteration , with an associated gain in computational efficiency .    in euclidean vector spaces ,",
    "pythagoras theorem gives a decomposition of the total sum of squared distances @xmath150 of a collection of points into contributions from directions perpendicular and parallel to any given line @xmath8 .",
    "however , this decomposition does not apply in @xmath17 with the geodesic metric .",
    "nonetheless , we can evaluate the quantities @xmath151 for any metric .",
    "it can be shown that for the geodesic metric , unlike the euclidean case , the sum of these two quantities depends on @xmath8 . despite this , when evaluated for a principal path @xmath8 , the sums of squared distances provide a useful quantification of variability , as we demonstrate in the results sections .",
    "we need to construct @xmath17-lines through @xmath97 and identify one which optimizes our choice of objective function , @xmath136 .",
    "this is a  challenging problem which has not previously been considered in the literature . in order to achieve computational tractability , we restrict to a particular class of @xmath17-lines and then employ different optimization algorithms to search over the restricted class . to motivate this approach , we start by considering properties of lines through @xmath97 .    in the topological orthant containing @xmath97 ,",
    "any @xmath17-line @xmath8 consists of a  straight line segment . for brevity",
    ", we will write @xmath152 for the midpoint topology  @xmath153 and  @xmath154 for the branch length function @xmath155 .",
    "let  @xmath156 denote the orthant containing @xmath97 , and for now assume that  @xmath97 is a binary tree ( so it contains the maximal number of splits ) .",
    "if @xmath51 is a split contained in @xmath156 , then the branch length at a point @xmath157 on @xmath8 has the form @xmath158 where @xmath159 is a `` weight '' associated to split @xmath51 , and @xmath160 lies on some interval containing zero .",
    "the set of weights determines the direction vector of the line segment through  @xmath97 .",
    "given such a line segment , we need to know how it might extend beyond @xmath156 into the rest of tree - space .",
    "where the segment meets a face of @xmath156 , at least one split is assigned zero branch length .",
    "generically , the line segment will meet a co - dimension @xmath56 face of @xmath156 , so that just one split @xmath51 will have zero length .",
    "solving equation ( [ equgeocoord ] ) for this split gives @xmath161 the line then extends from this point into one of the neighboring alternative orthants . in a similar way , every other split whose length varies in the initial line segment containing @xmath97",
    "is associated with a solution of equation ( [ equsolns ] ) and , correspondingly , with an alternative split related to the first by nni .",
    "if we restrict to the set of `` generic '' lines ( those which always meet a co - dimension  @xmath56 face of every orthant ) , then finding the optimal line @xmath8 therefore consists of a topological problem ( namely , choosing a new split @xmath57 to replace each @xmath51 ) and a geometrical problem ( finding the best set of weights @xmath159 ) .",
    "however , these problems are not independent .",
    "we can order the solutions to ( [ equsolns ] ) as we move out from @xmath97 in a particular direction along @xmath8 .",
    "suppose the first solution we come to is at @xmath162 and we replace split @xmath163 with @xmath164 .",
    "at the next solution @xmath165 , split @xmath166 is assigned zero length and we replace it via an nni move . however , the choice of splits available as replacements for @xmath166 does not depend solely on @xmath166 but also on the rest of the tree topology just before @xmath165and therefore potentially on the choice of replacement @xmath164 of @xmath163 .",
    "thus , the topological aspect of construction depends on the relative order of the solutions to ( [ equsolns ] ) , which in turn depends on the weights @xmath159 .",
    "optimization over the set of possible weights and splits will be computationally demanding for trees with more than a few species  an exhaustive search will not be possible .",
    "a key feature of the description above is the assumption that line segments meet the boundary of orthants in co - dimension @xmath56 faces .",
    "we restrict our search space for @xmath8 similarly , but take into account the possibility that @xmath97 might not be fully resolved .",
    "we make this more formal as follows .",
    "suppose @xmath32 is compatible with @xmath97 and @xmath167 is obtained by extended nearest neighbor interchange of @xmath51 in @xmath168 . the _ simple line _ through @xmath97 associated with @xmath169 and",
    "weight @xmath170 is the path @xmath171 defined by @xmath172    such a path moves through a single pair of orthants .",
    "the next definition extends simple lines to pass through more than two orthants .",
    "[ defext ] suppose @xmath173 is the simple line through @xmath97 defined by split pairs @xmath174 and weights @xmath175 , and suppose that the pair of splits @xmath176 and weight @xmath177 satisfy the following :    @xmath178 is compatible with @xmath173 for all @xmath160 such that @xmath179 ,    @xmath180 is compatible with @xmath173 for all @xmath160 such that @xmath181 ,    @xmath182 are related by xnni in @xmath183 where @xmath184 .",
    "then the simple line @xmath185 defined by @xmath186 and weights @xmath187 is given by @xmath188\\\\[-8pt ] & = & 0 \\qquad \\mbox{otherwise},\\nonumber\\\\ \\label{equbl2 } \\lambda_{y(s)}(p'_i ) & = & -\\bigl(\\lambda_0(p_i ) + s w_i\\bigr ) \\qquad\\mbox{if } \\lambda_0(p_i ) + s w_i\\leq 0\\nonumber\\\\[-8pt]\\\\[-8pt ] & = & 0 \\qquad \\mbox{otherwise},\\nonumber\\\\ \\label{equbl3 } \\lambda_{y(s)}(q ) & = & \\lambda_0(q ) \\qquad\\mbox{if } q\\notin\\{p_i\\}\\cup \\{p'_i\\},\\qquad i=1,\\ldots , k+1.\\end{aligned}\\ ] ]    to prove that simple lines satisfy the conditions of definition [ defline ] , proposition 4.2 of @xcite can be applied to any pair of points on a simple line in order to show that the subpath between those points is geodesic .",
    "simple lines through @xmath97 resemble the geodesic between @xmath80 and @xmath81 in figure  [ figgeodesicandcone ] : they continue between orthants without bends , and hence are always locally geodesic .",
    "moreover , any straight line segment through @xmath97 can be obtained as part of a simple line .",
    "nonetheless , restriction to the class of simple lines removes many lines from consideration .",
    "cone paths are ruled out , together with any geodesic for which some subset of the splits changes like a  cone path .",
    "( this latter class of geodesics resembles @xmath189 in figure [ figgeodesicandcone ] for some splits and @xmath190 for others . )",
    "this restriction is carried out for the sake of computational tractability .",
    "more discussion is given in section [ secconc ] .",
    "definition [ defext ] describes how to extend a simple line on @xmath191 split pairs to one on @xmath192 split pairs .",
    "our algorithms for finding an optimal simple line are based precisely on this operation .",
    "suppose a simple line @xmath8 is determined by sets of splits @xmath193 and weights @xmath194 .",
    "conditions ( i)(iii ) of definition [ defext ] place constraints on any proposed splits @xmath169 and weight @xmath170 which might be used to extend @xmath8 .",
    "the values @xmath195 correspond to points at which @xmath8 crosses the boundary between orthants , and we can assume they are ordered with @xmath196 .",
    "they divide @xmath8 up into @xmath192 intervals @xmath197 $ ] for @xmath198 taking @xmath199 and @xmath200 , such that the topology of @xmath8 is constant on each interval .",
    "let @xmath201 denote the tree topology on @xmath202 .",
    "now suppose that @xmath51 is compatible with @xmath152 and @xmath57 is a proposed replacement for  @xmath51 .",
    "suppose we also propose an interval @xmath202 on which we require the xnni move to be performed .",
    "conditions ( i)(iii ) are then equivalent to the following.=1    _ geometrical constraint _ : @xmath203    _ topological constraint _ :    * if @xmath204 , then @xmath51 must be compatible with @xmath205 and @xmath57 must be compatible with @xmath206 ; or * if @xmath207 , then @xmath57 must be compatible with @xmath208 and @xmath51 must be compatible with @xmath209 .",
    "when @xmath51 is not contained in @xmath152 , but instead _ extends _ the midpoint topology , then @xmath210 and the solution to equation ( [ equsolns ] ) is @xmath211 . in this case",
    ", the geometric constraint corresponds to an unbounded interval for @xmath170 , and the interval @xmath202 on which the xnni move @xmath212 takes place must necessarily contain @xmath211 .",
    "the following algorithm repeatedly extends a simple line by adding in a new split pair at each iteration .",
    "the pair chosen is the one which gives the best improvement in the objective @xmath136 :    let @xmath213 be the set of feasible splits ( see below ) .",
    "consider in turn every split @xmath51 in @xmath213 that is compatible with @xmath152 , and every possible replacement @xmath57 for @xmath51 .    for each interval @xmath202 , test whether @xmath57 is an xnni replacement of @xmath51 in  @xmath201 .",
    "if ( ii ) holds on interval @xmath202 , then next check whether the pair @xmath169 satisfies either topological constraint for that interval .",
    "fix the sign of @xmath170 depending on which constraint applies .",
    "if either topological constraint holds , then find @xmath170 that maximizes the variance of the projected points on @xmath8 , subject to the geometrical constraint and sign of  @xmath170 .",
    "this is carried out using the golden ratio search for the optimum value of @xmath170 .",
    "repeat for all feasible pairs @xmath214 and find the pair that gives the maximum projected variance .",
    "add @xmath51 , @xmath57 and @xmath170 to the lists @xmath215 , @xmath216 and @xmath217 , and reorder the lists according to the solutions of ( [ equsolns ] ) .",
    "remove @xmath169 from @xmath213 , and repeat from step 2 .",
    "the algorithm continues until no more splits can be added to @xmath8 .",
    "this will occur in at most @xmath46 iterations where @xmath37 is the number of species , since every tree can contain at most @xmath46 nontrivial splits .",
    "the set of feasible splits @xmath213 could be taken to be the entire set of possible splits  @xmath24 , but this is inefficient . if neither split @xmath169 is contained in any of the trees @xmath218 , then adding the pair to @xmath8 will only increase the distances @xmath14 so that @xmath8 is a worse approximation to the data .",
    "we therefore take  @xmath213 to be the set of nontrivial splits found in at least one tree @xmath138 .",
    "it is possible that at some stage the best improvement in @xmath136 might be given by some @xmath219 and a replacement @xmath220 ( e.g. , consider the case that all the trees @xmath134 lie in the same orthant ) .",
    "however , in such a situation , the data would not be informative about the choice of @xmath57 , and so we disregard this possibility .",
    "the greedy algorithm terminates after at most @xmath46 iterations . during each iteration",
    "@xmath221 pairs of splits and @xmath222 possible intervals for the move @xmath212 are considered . for each pair of splits and interval ,",
    "@xmath223 trees are projected onto the proposed line .",
    "each projection requires @xmath224 steps .",
    "the golden ratio search during projection is performed to a fixed tolerance , and so is independent of @xmath37 , @xmath223 and @xmath225 .",
    "overall , the algorithm therefore requires @xmath226 steps where @xmath213 is at worst @xmath227 .",
    "a monte carlo optimization algorithm was also implemented in order to provide comparisons with the greedy approach .",
    "a simulated - annealing type approach was adopted , where the state at each iteration comprised a simple line @xmath8 through @xmath97 . at each iteration a `` birth '' or `` death '' move was randomly proposed from the current state .",
    "birth moves consisted of adding a valid split pair to @xmath8 , while death moves consisted of removing a split pair from @xmath8 .",
    "birth moves were obtained by selecting @xmath219 uniformly at random , then selecting @xmath57 uniformly at random from the possible xnni replacements of @xmath51 satisfying the constraints defined above .",
    "the weight assigned to @xmath169 was obtained by the golden ratio search , as for the greedy approach .",
    "death moves were carried out by choosing at random the split pair at either end of @xmath8 ( i.e. , with largest positive or negative @xmath228 ) and removing it .",
    "removing other split pairs results in incompatible sets of splits along @xmath8 and is therefore forbidden .",
    "the relative probabilities of birth and death depended on the number @xmath191 of split pairs in  @xmath8 and were designed to favor birth for small @xmath191 and death when @xmath191 was large .",
    "proposals leading to improvement in the objective were always accepted .",
    "other proposals were accepted with probability @xmath229 where @xmath230 is the absolute difference of the objective for the proposed and current state , @xmath77 is a bound for @xmath230 , and @xmath231 is the `` temperature . '' for @xmath232 , @xmath77 was taken to be @xmath233 , while for @xmath234 , @xmath77 was taken to be @xmath118 for the current state .",
    "the temperature @xmath231 was slowly decreased as the optimization progressed .",
    "we investigated certain transformations of the data @xmath10 prior to analysis with @xmath9pca .",
    "kupczok et al .",
    "@xcite suggest scaling each tree @xmath235 to have the same total branch length . in practice , this seemed to make little difference to the examples we looked at in the results section below .",
    "instead we considered the following branch length normalization . for each split @xmath51 ,",
    "branch lengths were scaled by a constant so that the average branch length associated with @xmath51 across the whole data set was unity .",
    "this was repeated for each split in the data set .",
    "the idea behind this is to make @xmath9pca measure variability relative to branch length and to amplify the variability in short branches . in regular pca",
    "the correlation matrix can be analyzed instead of the covariance matrix , and this branch length transformation can be thought of as being analogous to the correlation matrix version .",
    "principal geodesics obtained for branch - length normalized data can be back - transformed onto the original scale by scaling the weights @xmath217 .",
    "wang and marron  @xcite previously developed pca in a space of trees , and on account of the similarities of our approach to theirs , in this section we look in detail at the relationship between the approaches .",
    "the steps underlying our approach specified at the start of section  [ secmethods ] were taken directly from @xcite , but the details of how these steps are carried out are quite different on account of the different geometries under consideration .    in @xcite",
    "rooted bifurcating trees are considered , but , unlike phylogenetic trees , the leaf vertices are not assigned taxon labels . instead , each vertex can have a `` left '' and a `` right '' descendant , and trees in the data set can have different depths from root to leaf .",
    "most importantly , branches do not have any associated length , but , instead , each vertex present in a tree has an associated real number ( or vector ) .",
    "an example of such data consists of blood vessel information from medical imaging : vertices represent blood vessels , edges represent connections between blood vessels , and the data value associated to each vertex corresponds to some measurement at that point in the blood vessel structure .",
    "one crucial difference between the two spaces of trees is that in @xcite there is no relationship between the values associated to vertices and the topological structure of the tree .",
    "this is different from the space @xmath17 , in which branch lengths can be shrunk down and replaced by an alternative topology .    this separation of `` topological '' and `` geometrical '' aspects of the problem in @xcite results in principal components with separate topological and geometrical parts . in wang and marron s terminology , a _ structure tree line _",
    "is a sequence of vertices , each descended from the previous vertex , which can be thought of as ( discontinuous ) `` growth '' of a tree toward a leaf , by grafting on branches .",
    "in contrast , an _ attribute tree line _ consists of a fixed tree structure with `` direction vectors '' associated to vertices .",
    "this is clearly very different from the lines constructed by @xmath9pca in which the principal path reflects both topological and geometrical variability in the data set .    not surprisingly , given the different structures of the spaces considered , the metrics used in the two approaches differ .",
    "the metric in @xcite is a linear combination of the ( unweighted ) robinson  foulds metric @xcite and a euclidean distance between the vectors associated to each vertex .",
    "this metric is inexpensive to compute , in contrast to the geodesic metric which we consider , and this reduces the computational burden of their approach relative to ours .",
    "the midpoint @xmath97 in @xcite is taken to have the majority consensus topology @xcite , as used here , since this minimizes the sum of the robinson ",
    "foulds distances of the midpoint from @xmath138 .",
    "however , while wang and marron obtain an exact form of pythagoras theorem with their metric , that is not the case for @xmath9pca ( see section [ secproj ] ) .    in summary ,",
    "the method of wang and marron can not be applied directly to phylogenetic trees , since the trees they consider lack taxon labels and branch lengths and so can not represent phylogenies .",
    "while our approach builds on the same framework as that laid out in @xcite , differences in the geometries of the spaces under consideration make the mathematical details of the implementation of pca substantially different .",
    "in particular , @xmath9pca relies heavily on the geometry of @xmath17 described by billera et al .",
    "it is interesting to note how a seemingly small difference in the geometry of the space under consideration can substantially change the way pca is implemented .",
    "@xmath9pca was used to analyze collections of randomly generated trees with two ( or more ) known underlying topologies .",
    "these simulations were not intended as a model of a specific process giving rise to alternative trees , but were performed in order to verify the methodology and demonstrate how it works on simple examples .",
    "we describe the simulations very briefly here , but give more details in the supplementary material  @xcite .",
    "two sets of simulations were performed . in the first set , trees were simulated such that each had one of two possible topologies @xmath236 or @xmath237 .",
    "the underlying topologies @xmath238 were related by an nni move and represented alternative positions for a clade within the tree .",
    "topology @xmath236 was adopted with probability  @xmath239 and @xmath237 with probability @xmath240 . apart from branches affected by the change in topology ,",
    "all other branch lengths were kept fixed . for each value of  @xmath239 ,",
    "100 trees were randomly generated in this way .",
    "additional variability was added by simulating a dna alignment for each tree , and then replacing the tree with the maximum likelihood ( ml ) tree estimated from the alignment .",
    "@xmath9pca was used to analyze these estimated trees .",
    "a  second set of simulations was performed in which there were two correlated changes in topology .",
    "each tree consisted of two subtrees , and each subtree had either topology  @xmath236 or @xmath237 as in the first set of simulations .",
    "the alternative topologies in each half of the tree were simulated to arise with correlation  @xmath108 .",
    "again , additional variability was added by simulating alignments and replacing each tree with an ml estimate .",
    "100 trees were generated for each pair of values  @xmath241 and @xmath9pca was used to analyze each set of estimated ml trees .",
    "the results indicated that optimization of @xmath118 gave the best performance : paths obtained by optimizing @xmath119 sometimes missed the changes in topology imposed in the data sets . in this non - euclidean",
    "setting the sum @xmath242 is generally less than the total sum of squared distances @xmath243 , so optimization of  @xmath119 may result in principal paths that fail to capture variability in the data by finding paths in which both sums @xmath244 and @xmath245 are small .    in both sets of simulations ,",
    "@xmath9pca with @xmath118 gave principal paths corresponding to the change between the imposed alternative topologies .",
    "in the first set of simulations , based on a single pair of alternative topologies , as  @xmath239 increased the change between the underlying topologies @xmath238 dominated the principal path ( the corresponding splits received a higher weight ) as variability due to tree estimation from alignments was dominated by the imposed variability in topology . in the second set of simulations , for small values of @xmath108 the principal path corresponded to change between the alternative topologies on one part of the tree , with the other pair of alternative topologies receiving a low weight . for larger @xmath108 ,",
    "the correlated alternatives in both parts of the tree were identified by the principal path .",
    "more details are given in the supplementary material @xcite .      in order to demonstrate a potential application of @xmath9pca , a simple study of long branch attraction ( lba ) was performed .",
    "lba is a feature of phylogenetic methods in which species on long branches are often grouped together erroneously on estimated trees .",
    "we took a tree from the literature @xcite representing a deep phylogeny of eukaryote species which includes two long branches and a distant out - group , as shown in figure [ figlba ] .",
    "100 trees were simulated by first simulating amino acid alignments from the base tree ( 300 base pairs , @xmath246 model ) using the seq - gen software @xcite and then obtaining an ml estimate tree from each alignment using phyml @xcite .",
    "@xmath9pca was used to analyze the set of trees estimated from the simulated alignments .",
    "analysis of the simulated trees was carried out first with un - normalized data and then again with the normalization procedure described in section [ sectrans ] .",
    "optimization was carried out using the @xmath118 objective function , and results were obtained with both the greedy and monte carlo algorithms . despite long runs , the monte carlo algorithm failed to improve on the results obtained with the greedy algorithm .",
    "the results obtained with the greedy algorithm are shown in table [ tablba ] and figure [ figlba ] shows the principal path obtained with normalized branch lengths .",
    "the `` proportion of variance '' @xmath247 was greater with the normalized data , and so we suggest that normalization is preferable for this data set .",
    "@ll@ @xmath248 & +   + @xmath249 & guilardia moves past pairing with rhodophyta to top of clade with plants + @xmath250 & guilardia moves from top of clade with plants to position closer to archaea +   + @xmath251 & microsporidia moves from grouping with fungi to top of clade with metazoa + @xmath252 & microsporidia grouped with archaea +    as explained in @xcite , estimated trees tend to place the long branches ( _ guillardia _ and microsporidia ) next to the out - group ( archaea ) .",
    "the analyses of both the un - normalized and normalized data show this effect with , respectively , _",
    "guillardia _ and microsporidia `` floating '' round the tree to be placed closer to the archaea .",
    "the fact that each principal path captures a single such effect suggests that the attraction of the two long branches to the archaea is uncorrelated in the data .",
    "@xmath9pca exactly captures the expected lba artefact in the simulated data .",
    "@xmath9pca was applied to a set of 118 gene trees from 21 metazoan ( animal ) species , previously analyzed in @xcite .",
    "@xmath9pca was performed on both unscaled and branch length normalized data using the @xmath118 objective function .",
    "the monte carlo optimization algorithm obtained principal paths with slightly higher @xmath118 scores than the greedy algorithm , and so we refer to that set of results here .",
    "the principal paths obtained with the two algorithms were similar , and shared the majority of split pairs in common .",
    "the `` proportion of variance '' @xmath247 was @xmath253 for the unscaled data and @xmath254 for the normalized data  relatively low in both cases .",
    "however , the simulation studies produced similarly low scores ( between @xmath255 and @xmath256 on artificial data ) , suggesting that low scores might be common even when @xmath9pca is successfully capturing aspects of variability in the data .",
    "further comments about the low proportion of variance are made in section [ secconc ] .",
    "the principal path obtained for the unscaled data corresponded to uncertainty in the positioning of the out - group , yeast .",
    "it moves from being placed next to the worms to being grouped with sea squirt .",
    "this might be an lba effect since sea squirt and yeast lie on relatively long branches .",
    "results of the analysis using data with normalized branch lengths are shown in figure [ figmetazoa ] .",
    "the principal path indicates uncertainty in the placement of human : it is either grouped with chimpanzee or macaque .",
    "the position of human relative to its neighbors was a longstanding problem in phylogenetics  @xcite .",
    "uncertainty in the positioning arises from the presence of a relatively short internal branch in the species tree joining human and chimpanzee to the other primates . although well known in evolutionary biology",
    ", this simple example illustrates how @xmath9pca can be used to identify and visualize alternatives within a set of trees .",
    "we have presented a procedure for identifying principal paths in the space of phylogenetic trees which best approximate a set of alternative phylogenies in an analogous way to standard pca in euclidean vector spaces .",
    "a key feature of the approach is the use of metrics that combine geometric and topological information about trees .",
    "the principal paths constructed coincide with the geodesic between every pair of points on the path .",
    "each principal path is equipped with a summary statistic analogous to the euclidean proportion of variance which quantifies variability along the path .",
    "results obtained from simulated and experimental data sets gave values for the `` proportion of variance '' @xmath257 which were relatively low in comparison to typical values for standard pca ( e.g. , about @xmath256 for the normalized metazoa data set ) .",
    "this is the result of two features of the problem .",
    "first , the data sets analyzed in this paper are high dimensional ( containing over @xmath258 different splits ) , and in the same way as for standard euclidean data , this tends to lead to lower proportions of variance . to illustrate this , consider , for example , a multivariate normal distribution with dimension @xmath258 and covariance matrix @xmath259 .",
    "standard pca would give a proportion of variance of roughly @xmath256 even though the variance along the principal component is substantially higher than in other directions .",
    "second , the failure of pythagoras theorem in tree - space means that for any analysis variance `` leaks out , '' that is , the sum of squares @xmath260 is less than the total sum of square distances for the original data @xmath261 , further decreasing @xmath257 .    in order to construct principal paths ,",
    "two approximations have been imposed :    a greedy algorithm or monte carlo search is carried out in the configuration space of paths in order to find the optimal path .",
    "there is no guarantee that the optimal path will always be found .",
    "the configuration space itself is restricted to a subclass of paths ( referred to as simple lines ) . by restricting in this way we might rule out capturing types of variability in the data under analysis .",
    "we consider the second of these approximations to be more limiting , and it is difficult to generalize the approach we have described to overcome it .",
    "another area requiring further research is the construction of higher - dimensional approximations to data , analogous to second and third , etc .",
    "principal components .",
    "construction of higher order principal components in euclidean vector spaces is carried out by working orthogonally to the first principal component .",
    "tree - space is not equipped with an inner product , and so this procedure can not carry over directly to  @xmath17 .",
    "our algorithms for constructing the principal path @xmath8 do not therefore readily generalize to give higher order paths .",
    "instead , we would need to consider two - dimensional subsets of @xmath17 which approximate the data @xmath10 as closely as possible .",
    "in analogy to the definition of @xmath17-lines , we would require that such subsets  @xmath262 contain the geodesic between any two points in @xmath262 , and so @xmath262 would locally resemble a plane in each orthant .",
    "however , in contrast to the theory of geodesics , the theory of higher - dimensional surfaces in tree - space is not well developed .",
    "we have not attempted to advance this theory in this paper , but have focused on the already considerable problem of identifying lines which best approximate the data .",
    "the @xmath9pca procedure has been presented as an empirical analysis of sampled trees without reference to any underlying distribution that generated the trees .",
    "distributions such as sampling distributions , bootstrap distributions and bayesian posteriors are of fundamental importance in phylogenetic inference , but the geometrical properties of these distributions have received little study .",
    "billera et al .",
    "@xcite considered spherically symmetric distributions with density decaying exponentially away from a central point .",
    "a second form of isotropic distribution consists of the limit of a random walk in tree - space from a fixed central point . by simulating samples from a  suitable random walk and carrying out @xmath9pca on the samples",
    ", an empirical @xmath51-value could be assigned to the proportion of variance of a principal line constructed from experimental data , as a test for significant departure from isotropy .",
    "holmes @xcite , however , suggests that the assumption of spherical symmetry is not realistic for most distributions of interest .",
    "one area where distributions on tree - space have been defined more precisely is the study of population - genetic effects on gene phylogenies @xcite .",
    "such distributions could be studied in the context of tree - space geometry , and it might be possible to obtain the sampling theory of principal lines under @xmath9pca in this case .    this paper has presented the results of applying @xmath9pca to some relatively simple examples , and demonstrated the type of information principal paths reveal . the method can be applied to larger data sets and it has the potential to provide new insights into a range of problems in evolutionary biology .",
    "software for performing @xmath9pca and for visualizing principal paths as animations of trees is available in the supplementary material @xcite , together with the data sets analyzed in this paper .",
    "the author would like to thank anne kupczok and the group of arndt von haeseler for generously providing the set of metazoan gene trees .",
    "i am also grateful to two anonymous reviewers for their very helpful comments ."
  ],
  "abstract_text": [
    "<S> phylogenetic analysis of dna or other data commonly gives rise to a collection or sample of inferred evolutionary trees . </S>",
    "<S> principal components analysis ( pca ) can not be applied directly to collections of trees since the space of evolutionary trees on a fixed set of taxa is not a vector space . </S>",
    "<S> this paper describes a novel geometrical approach to pca in tree - space that constructs the first principal path in an analogous way to standard linear euclidean pca . </S>",
    "<S> given a data set of phylogenetic trees , a geodesic principal path is sought that maximizes the variance of the data under a form of projection onto the path . </S>",
    "<S> due to the high dimensionality of tree - space and the nonlinear nature of this problem , the computational complexity is potentially very high , so approximate optimization algorithms are used to search for the optimal path . </S>",
    "<S> principal paths identified in this way reveal and quantify the main sources of variation in the original collection of trees in terms of both topology and branch lengths . </S>",
    "<S> the approach is illustrated by application to simulated sets of trees and to a set of gene trees from metazoan ( animal ) species .    .    . </S>"
  ]
}