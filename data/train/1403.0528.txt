{
  "article_text": [
    "to collect data needed to provide coastal communities with timely tsunami warnings , the national oceanic and atmospheric administration ( noaa ) has deployed an array of deep - ocean assessment and reporting of tsunamis ( dart^^ ) buoys at strategic locations in the pacific and atlantic oceans ( gonzlez _ et al . _ , 2005 ; titov _ et al .",
    "_ , 2005 ; spillane _ et al .",
    "_ , 2008 ; mofjeld , 2009 ) .",
    "when a tsunami event occurs , data from these buoys are analyzed at u.s .",
    "tsunami warning centers ( twcs ) using the short - term inundation forecast for tsunamis ( sift ) application ( gica _ et al .",
    "_ , 2008 ; titov , 2009 ) .",
    "the sift application was developed by the noaa center for tsunami research to rapidly and efficiently forecast tsunami heights at specific coastal communities .",
    "sift compares dart^^  buoy data with precomputed models as one step in creating the forecast . matching precomputed models with data",
    "requires that any tidal components in the data be either removed or compensated for in some manner , an operation that we refer to as detiding . to facilitate the operational needs of sift , detiding of data from dart^^  buoys",
    "must be done as soon as possible after the data become available .",
    "in the course of developing the sift application , we have entertained multiple methods for detiding dart^^  buoy bottom pressure ( bp ) data nearly in real time . in this paper",
    "we compare five such methods using archived data collected by eleven dart^^  buoys .",
    "these buoys are deployed in both the pacific and atlantic oceans in places with different tidal regimes . besides the dominant tides ,",
    "the archived data contain other bp fluctuations of the kind that would be present during an actual tsunami event .",
    "we take data from periods when no known significant tsunamis occurred and introduce an artificial tsunami signal .",
    "each signal is patterned after a precomputed computer model for an actual tsunami event .",
    "the magnitude of the artificial event is controlled by a source coefficient @xmath0 .",
    "we consider five different methods for extracting the artificial tsunami signal , each of which handles the tidal component in a different manner .",
    "we assess how well each of the five detiding methods allows us to extract the known @xmath0 . by repeating this scheme for many different combinations of dart^^  data and artificial tsunami signals",
    ", we can evaluate how well the five detiding methods work under idealized conditions ( thus , while we make use of observed tidally - dominated data , we do not take into consideration confounding factors , an important one being a mismatch between the actual tsunami event and our model for it ) .",
    "the remainder of the article is organized as follows . in sect .",
    "[ sec : bpmeasurements ] we review the format of bp measurements from dart^^  buoys as received by u.s .",
    "we next describe construction of simulated tsunami events , which are formed by adding archived data from eleven representative buoys to associated models for tsunami signals ( sect .",
    "[ sec : scenarios ] ) .",
    "we give details about the five methods for extracting tsunami signals in sect .",
    "[ sec : detidingpressuremeasurements ] .",
    "the first two are well - known methods based on harmonic models .",
    "the next two are non - standard linear filters that utilize either empirical orthogonal functions or kalman smoothing in conjunction with a local - level state space model . the final method , which is based on a regression model that includes terms for both the tsunami signal and tidal components , proves to be the method of choice in study described in sect .  [ sec : results ] .",
    "we compare the five methods using dart^^  buoy data collected during the devastating 2011 japan tsunami in sect .",
    "[ sec : tohoku ] .",
    "we state our conclusions and discuss our results in sect .",
    "[ sec : conclusions ] .",
    "a dart^^  buoy actually consists of two units : a surface buoy and a unit located at the bottom of the ocean with a pressure recorder ( gonzlez _ et al .",
    "_ , 2005 ; noaa data management committee , 2008 ; mofjeld , 2009 ) . the bottom unit stores measurements of water pressure integrated over non - overlapping 15-sec time windows , for a total of @xmath1 measurements every hour .",
    "these internally recorded measurements only become fully available when the bottom unit returns to the surface and is recovered for servicing ( time between servicings can be as long as two or three years ) .",
    "we refer to the internally recorded data as the 15-sec stream .",
    "normally the buoy operates in standard reporting mode in which the bottom unit packages together one measurement every 15 minutes ( a 60 fold reduction in data ) over a 6-h block for transmission via acoustic telemetry up to the surface buoy once every 6  h. the surface buoy then relays the data up to the iridium satellite system for dissemination to the outside world .",
    "we refer to data collected in standard reporting mode as the 15-min stream .",
    "when a typical tsunami event occurs , the bottom unit detects a seismic event , which causes the dart^^  buoy to go into event reporting mode .",
    "the transmission of the 15-min stream is suspended while the dart^^  buoy is in event reporting mode . as part of this mode , the bottom unit averages together four consecutive 15-sec measurements and transmits these averages up to the surface buoy .",
    "we refer to these data as the 1-min stream .",
    "an additional 2 hours of 1-min data are transmitted on the hour during the event reporting mode .",
    "when the outside world first gets access to the 1-min stream , there can be a gap between it and the most recent value of the 15-min stream ranging up to almost 6  h. after the on - hour data transmission an additional 1 to 2 hours of 1-min data before the event will be available .",
    "if we assume that tsunami events commence at random within the 6-h reporting cycle for the 15-min stream , then the average size of this gap will be 3  h. the data that are thus typically available during a tsunami event are a portion of the 15-min stream prior to the event and a 1-min stream that becomes available piece - by - piece in real time as the event evolves and that contains at least 1  h of data occurring before the event .",
    "the goal of this paper is to objectively compare different detiding methods for extracting tsunami signals in near real - time .",
    "a model for what is recorded by a dart^^  buoy during a tsunami event has three components : a tsunami signal , tidal fluctuations and background noise .",
    "the latter is due to seismic , meteorological , measurement and other nontidal effects ( cartwright _ et al .",
    "_ , 1987 ; niiler _ et al .",
    "_ , 1993 ; webb , 1998 ; cummins _ et al .",
    "_ , 2001 ; mofjeld _ et al . _ , 2001 ; zhao and alford , 2009 ) .",
    "the purpose of detiding is to compensate for tidal fluctuations in the recorded data ( consoli _ et al .",
    "_ , 2014 ) .",
    "although dart^^  buoys have recorded a number of tsunami events , use of these data to evaluate different detiding methods is problematic : we ideally need to know the true tidal fluctuations , and these are not known to sufficient accuracy for actual data due to the presence of background noise .",
    "one solution is to simulate each of the three components . in combining these components to simulate tsunami events",
    ", we would then know the true tidal fluctuations and thus be in a position to quantify how well different detiding methods did ; however , simulating tidal fluctuations and background noise in a manner that does not give an unfair advantage to certain detiding methods is tricky .",
    "we can bypass simulation of both tidal fluctuations and background noise by making use of actual bp measurements from dart^^  buoys under the realistic assumption that significant tsunami signals are rare events .",
    "in this paper we use archived 15-sec streams retrieved from eleven representative dart^^  buoys .",
    "the buoys are in the atlantic and pacific oceans and are listed in table  [ tab : buoys ] .",
    "their locations are displayed in fig .",
    "[ fig : detidingpaperchart ] .",
    "these particular buoys were chosen because the data they collect represent four well - known types of tides , hence offering the study of detiding over a broad range of ocean tidal conditions .",
    "all data were obtained from noaa s national geophysical data center ( ngdc ; the reader is referred to mungov , _ et al . _ , 2012 , for details about data collection and processing ) .",
    "the units for the data archived by ngdc are in pounds per square inch absolute ( psia ) , which we convert to water depth in meters by multiplication by @xmath2  m / psia ( this conversion factor is based on a standard ocean , but its value does not impact any of the results we present ) .    as documented in table  [ tab : buoys ] , we have from 321 to 998 days of 15-sec streams for each of the eleven buoys .",
    "we use these streams to construct ` scenarios ' mimicking the tidal fluctuations and background noise that might have been present in 15-min and 1-min streams available during an actual tsunami event . to do so for a particular buoy",
    ", we start by selecting a random starting time @xmath3 . the first part of the scenario associated with @xmath3 consists of a 29-day segment of a 15-min stream extracted by subsampling from the 15-sec stream immediately prior to @xmath3 . to mimic typical operational conditions , we create a 3-h gap prior to @xmath3 by eliminating part of the constructed 15-sec stream . using data from the 15-sec stream occurring immediately after @xmath3 , we form a 1-day segment of a 1-min stream by averaging four adjacent values .",
    "the constructed 15-min and 1-min streams constitute one scenario . for each buoy",
    "we form a total of 1000 scenarios with starting times @xmath3 chosen at random without replacement from the set of all possible starting times ( for example , as indicated in table  [ tab : buoys ] for buoy 21416 , this set ranges from 29 days after 07/25/2007 up to 1 day prior to 07/01/2009 ) .",
    "figure  [ fig : scenario ] shows an example of one scenario .",
    "( there are occasional missing values in the 15-sec streams archived by ngdc .",
    "these can lead to gaps in a constructed 15-min stream in additional to the usual 3-h gap prior to @xmath3 .",
    "all of the detiding methods in our study can handle these gaps . if , however , the missing values lead to gaps in the constructed 1-min stream , we have elected to disregard the chosen @xmath3 and randomly pick a new one merely to simplify evaluation of the performance of the various detiding methods .",
    "thus , a given scenario can have gaps at arbitrary times in its 15-min stream , but none in its 1-min stream . )    with tidal fluctuations and background noise being handled using actual data from dart^^  buoys , we now turn our attention to simulating tsunami signals and combining these with the other two components to simulate the 1-min streams observed during a tsunami event .",
    "let @xmath4 be a vector containing a simulated 1-min stream observed during a tsunami event starting at time @xmath3 and lasting for one day ( the bar over @xmath5 is a reminder that the 1-min stream is produced from four - point averages of the 15-s stream ) .",
    "we model this vector as @xmath6 where @xmath7 , @xmath8 ,  , @xmath9 and @xmath10 are vectors representing , respectively , tidal fluctuations , components derived from @xmath11 unit sources ( these collectively serve to model the tsunami signal ) and background noise , while @xmath12 ,  , @xmath13 are @xmath14 nonnegative scalars known as source coefficients ( percival _ et al . _ ,",
    "2011 ) . forming the @xmath15 s",
    "is discussed in detail in titov _",
    "et al . _  ( 1999 ) and gica _ et al . _  ( 2008 ) , and the following overview is taken from percival _ et al . _  ( 2011 ) .",
    "tsunami source regions are defined along subduction zones and other portions of oceans from which earthquake - generated tsunamis are likely to occur ( see the solid curves on fig .",
    "[ fig : detidingpaperchart ] ) .",
    "each source region is divided up into a number of unit sources , each of which has a fault area of @xmath16  @xmath17 . for each pairing of a given dart^^  buoy with a particular unit source , a model",
    "@xmath15 has been calculated predicting what would be observed at the buoy from time @xmath3 and onwards based upon the assumption that the tsunami event was caused by a reverse - thrust earthquake with standardized moment magnitude @xmath18 starting at @xmath3 and located within the unit source .",
    "the source coefficient @xmath19 is used to adjust the standardized magnitude in the model to reflect the magnitude in an actual tsunami event .",
    "the sum of the @xmath19 s is a measure of the overall strength of the tsunami event and provides initial conditions for models that predict coastal inundation . as discussed in percival _",
    "et al . _  ( 2011 ) , given @xmath14 candidate unit sources and based on varying amounts of data , a least squares procedure can be used to obtain statistically tractable estimates of the @xmath19 s under the assumption that the tidal fluctuations @xmath7 are known to reasonable accuracy .    to focus on detiding , we assume a simplified version of equation  [ eq : modelk ] , namely , @xmath20 i.e. , the simulated 1-min stream involves just a single unit source and a single source coefficient .",
    "the scenarios for a given buoy are stand - ins for @xmath21 .",
    "we take the unit source - based @xmath22 and multiply it by @xmath0 to form an artificial tsunami signal @xmath23 . from an examination of actual tsunami events",
    ", we set @xmath24 as a representative source coefficient .",
    "figure  [ fig : oneevent ] shows an example of constructing a simulated tsunami event based upon the 1-min stream shown in fig .  [ fig : scenario ] and a unit source chosen for dart^^  buoy 52402 .    for each of the eleven buoys in our study",
    ", we picked from three to seven unit sources with different orientations with respect to the buoy ",
    "these choices are listed in table  [ tab : unitsources ] and depicted as solid circles in fig .",
    "[ fig : detidingpaperchart ] . for dart^^  buoys near a subduction zone , we selected the closest unit source so that the buoy would be in the main beam of the radiated tsunami energy .",
    "we then added two additional unit sources , bearing 30 to 45 degrees to either side of the first , to represent waves traveling obliquely toward the buoy . in the case of dart^^",
    "buoy 21416 , which is representative of the northwest pacific and proximate to both the aleutian and kamchatka source regions , we selected unit sources from both regions .",
    "buoy 32411 ( located close to both central and south america ) has a similar geometry , so we chose three unit sources from central america and three from south america . for mid - ocean buoys ( 51406 , 51407 and 44401 ) , we selected unit sources from several subduction zones to which the buoy might respond .",
    "there are 42 unit sources in all , 5 of which are used by two buoys , for a total of 47 pairings of buoys and unit sources .",
    "each pairing leads to a different artificial tsunami signal @xmath25 .",
    "twelve representative signals are shown in fig .",
    "[ fig : unitsources ] ( here the coefficient @xmath0 is adjusted separately for each signal merely for plotting purposes  the actual range for all 47 @xmath26 s is listed in table  [ tab : unitsources ] and varies from 0.2 to 13.1  cm ) .",
    "each plot shows a 120-min segment of a given artificial tsunami signal @xmath25 , one point for each minute , but a different segment for each signal .",
    "for use later on , five hand - picked points are colored red . from left to right , the first four of these points mark the approximate occurrence of a quarter , a half , three - quarters and all of the first full wave comprising the signal ( table  [ tab : unitsources ] lists the actual times associated with these points ) . the final ( right - most ) point marks one hour past the end of the first full wave .",
    "each of the eleven buoys is represented once in fig .",
    "[ fig : unitsources ] , except for buoy 32411 , which has two signals associated with it that are visually quite different ( left - hand and middle plots on second row ) .",
    "one of these two depicted signals ( cs027b , left - hand plot , second row ) is generated from the same @xmath16  @xmath17 region as the signal depicted for 51406 ( left - hand plot , bottom row ) .",
    "again these two signals are visually quite different .",
    "these duplicate - buoy / duplicate - unit - source pairings illustrate the fact that each signal depends upon both the location of the buoy and the location of the unit source .",
    "figure  [ fig : tsunamievents ] shows 120-min segments of twelve simulated tsunami events , each of which make use of the artificial tsunami signals shown in corresponding plots of figure  [ fig : unitsources ] .",
    "these events were formed by adding @xmath27 ( with @xmath0 now set to 6 ) to the 1-min stream from a randomly chosen scenario for each buoy ( the scenario chosen for buoy 52402 is the same one used in fig .  [",
    "fig : oneevent ]  thus the left - most plot in the third row of fig .",
    "[ fig : tsunamievents ] is a zoomed - in version of bottom plot of fig .",
    "[ fig : oneevent ] ) .",
    "the vertical axis for each plot in fig .  [ fig : tsunamievents ] spans 1.2 m .",
    "it is easy to visually pick out the tsunami signal in some plots , but harder in others , which illustrates the fact that , even though @xmath28 in all cases , the signal - to - noise ratio varies substantially .",
    "here we describe five methods that take bp measurements @xmath4 and use them to estimate the source coefficient @xmath0 in equation  [ eq : model1 ] .",
    "each method deals with the tidal fluctuations @xmath29 in a different manner .",
    "the first four methods do so by predicting or estimating the fluctuations using , say , @xmath30 .",
    "this prediction is then subtracted from @xmath4 to yield detided bp measurements : @xmath31 where @xmath32 is an error term encompassing both background noise and inaccuracies in predicting the tidal fluctuations .",
    "given the detided measurements , we then use the ordinary least squares ( ols ) method to estimate @xmath0 , yielding the estimator @xmath33 where @xmath34 denotes the transpose of the vector @xmath22 .",
    "the fifth method is different from the other four in that it uses ols to create @xmath35 and to estimate @xmath0 jointly . the inversion algorithms for estimating source coefficients from multiple buoys currently in sift ( percival , _ et al .",
    "_ , 2011 ) and under development  ( percival , _ et al .",
    "_ , 2014 ) are based on least squares methods , but go beyond ols by including nonnegativity constraints and penalties to induce automatic unit source selection .",
    "these algorithms assume the model of equation  [ eq : modelk ] for the multiple buoys , but proceed under the assumption that the bp measurements have been adjusted so that tidal fluctuations have been removed as much as possible .",
    "for studying how best to deal with tides , it suffices to use a single buoy and the simplified model of equation  [ eq : model1 ] , and there is no real gain in using anything other than the ols estimator of equation  [ eq : alphahat ] .",
    "the first two of the five methods are based on harmonic modeling , which we describe in sect .",
    "[ sec : harmonic ] .",
    "the third method is based on empirical orthogonal functions ( sect .",
    "[ sec : eof ] ) , while the fourth employs kalman smoothing , but makes use of harmonic modeling for initialization purposes ( sect .",
    "[ sec : ks ] ) .",
    "[ sec : joint ] describes the fifth method , which in part involves a simplified version of harmonic modeling .",
    "the harmonic prediction method is the standard one used by noaa to predict the tides at coastal stations . for detiding dart^^  data ,",
    "it can be thought of as the classic method of tidal prediction .",
    "it assumes that the tides are sums of sinusoidal constituents , each with its own frequency . to make tidal predictions at a dart^^  station , the amplitude and phase lag of each constituent",
    "are determined via a tidal analysis of observed bp data .",
    "the first detiding method is a harmonic prediction method that carries out the tidal analysis in the following manner .",
    "consider one of the scenarios described in section  [ sec : scenarios ] .",
    "each scenario consists of a one - day segment of a 1-min stream starting at time @xmath3 , which is preceded by 29 days ( less 3 hours ) of a 15-min stream . without loss of generality , set @xmath36 to simplify the discussion , and let @xmath37 denote an observation from the 15-min stream , but with @xmath38 indexing the underlying 15-sec stream from which the 15-min stream is subsampled ; i.e.",
    ", the actual time associated with @xmath37 is @xmath39 , where @xmath40s .",
    "assuming @xmath37 to be tidally dominated , we entertain a harmonic model of the form @xmath41 + e_n \\label{eq : harmmodelbc}\\end{aligned}\\ ] ] for @xmath42 ( note that index @xmath43 corresponds to the last value in the observed 15-min stream , which occurs prior to the 3-h gap , while @xmath44 indexes the first value , which occurs 29 days prior to @xmath36 ) . in the above",
    "@xmath45 is an unknown overall mean level ; @xmath46 is one of @xmath47 known tidal frequencies ; @xmath48 and @xmath49 are unknown coefficients that can be used to deduce the amplitudes @xmath50 and phase lags @xmath51 ; and @xmath52 is a residual term ( hopefully small ) .",
    "we use an ols fitting procedure to estimate @xmath45 , @xmath48 and @xmath49 via , say , @xmath53 , @xmath54 and @xmath55 .",
    "if we replace @xmath45 , @xmath48 and @xmath49 by their estimates , we can then use the right - hand side of equation  [ eq : harmmodelbc ] with the residual term set to zero to predict what the tidal fluctuation should be at any desired time index @xmath38 .",
    "after an artificial tsunami signal is added to the 1-min stream of the scenario to form a tsunami event , we detide this stream by forming @xmath56\\,\\delta ) + c_m \\sin(\\omega_m [ n+k]\\,\\delta ) \\right]\\ ] ] for @xmath57 , where @xmath58 is an element from the 1-min stream @xmath4 . for 29 days of prior data ,",
    "we make use of @xmath59 tidal frequencies @xmath60 ,  , @xmath61 commonly referred to as n2 , m2 , s2 , q1 , o1 and k1 ( see , e.g. , table  1 in ray and luthcke , 2006 ) .",
    "the @xmath62 s given above form the elements of the vector @xmath35 used to form the estimator @xmath63 of equation  [ eq : alphahat ] .    the first row of fig .",
    "[ fig : detidingfive ] shows detided bp measurements @xmath62 corresponding to the simulated tsunami event shown in the bottom plot of fig .",
    "[ fig : oneevent ] .",
    "visually there is evidence that this detiding is not entirely satisfactory : there is a systematic drift downwards over the first hour that arguably is due to tidal fluctuations and thus should not be present in @xmath62 .",
    "as described in the caption to the figure , the five black circles mark various time points associated with the artificial tsunami signal .",
    "if we place the data from @xmath3 up to one of these five time points into the vector @xmath35 and create the corresponding vector @xmath26 , we can obtain an estimate of the source coefficient @xmath0 using equation  [ eq : alphahat ] .",
    "the resulting estimates @xmath63 are listed in the first row of table  [ tab : alphaestimates ] .",
    "recalling that the true value of @xmath0 is 6 , we see that , not unexpectedly , the better estimates are associated with larger amounts of data . looking at estimates based on varying amounts of data is of considerable operational interest .",
    "as more bp measurements become available as a tsunami event evolves , we can expect in general to get better estimates of @xmath0 , but at the expense of a delay in issuing timely warnings .",
    "determining how much an estimate of @xmath0 is likely to improve by waiting for more data is vital for managing the trade - off between accuracy and timeliness .",
    "for this example , there is improvement in waiting until the first full wave occurs , but none in waiting an hour past that time .",
    "the second detiding method is based on a harmonic analysis that , for a given buoy , is based on _ all _ the 15-s data listed for it in table  [ tab : buoys ] .",
    "this ` blanket ' harmonic model has the same form as equation  [ eq : harmmodelampphase ] , but now the time index @xmath38 increases in steps of one rather than 60 , and we use @xmath64 sinusoidal constituents . for optimal accuracy of this type of an analysis , the measurements should span at least one year , which table  [ tab : buoys ] indicates is true for all buoys with the exception of 41420 ( this buoy has 321 days of data , slightly less than a year ) .",
    "the tidal predictions are made by adjusting the lunar harmonic constants for perigean ( 8.85-year ) and nodal ( 18.6-year ) variations in the moon s orbit , computing the height associated with each constituent at the times of interest , and then summing these heights to yield the prediction .",
    "detiding of the 1-min series in a scenario is accomplished using an equation similar to equation  [ eq : detideoneminuteusingha ] , the only difference being that the overall mean level @xmath45 is estimated using the scenario s 15-min stream rather than being pre - specified .",
    "a particular strength of the second detiding method is that it requires minimal use of the 15-min stream ( it is only used to estimate @xmath45 ) .",
    "in one extreme case , this stream was entirely missing for buoy 21416 over a six - week period prior to 1/15/2009 , when a kuril islands event triggered reporting of the 1-min stream .",
    "if the 15-min stream is not available , it is possible to estimate @xmath45 using just the 1-min stream , but care would be needed to ensure that the tsunami signal does not unduly distort the estimate .",
    "a number of software packages are available to do tidal analyses of observations and to make the tidal predictions , a standard one being the foreman fortran 77 package ( foreman , 1977 , revised 2004 ) . for our study , we used tidal predictions generated by ngdc ( see mungov _",
    "et al . _ , 2012 , for details ) .    the second row of fig .",
    "[ fig : detidingfive ] shows detided bp measurements @xmath62 produced by this second harmonic method .",
    "in contrast to the first method , we no longer see a systematic drift downwards over the first hour ; however , the @xmath62 s during that hour are systematically elevated above zero , which is questionable .",
    "the five estimates @xmath63 corresponding to different amounts of data are listed in the second row of table  [ tab : alphaestimates ] .",
    "these estimates are worse than the ones we obtained from the first harmonic method except when using the largest amount of data ; however , we should nt rely on this single example to draw conclusions about the relative merits of the two harmonic methods  see the discussion in section  [ sec : results ] .",
    "when tidal predictions are subtracted from bp measurements , fluctuations always remain in the tidal bands .",
    "they are due to non - stationary fluctuations , non - linear tides , and tidal constituents not accounted for in the tidal analysis . of these ,",
    "internal tides are certainly significant .",
    "they are generated around the ocean margins and shallow ridges and then propagate elsewhere in the ocean ( e.g. , cummins _",
    "et al . _ , 2001 ; zhou and alford , 2009 ) .",
    "the residual tides limit the degree to which the total tide can be removed from bp data through simple subtraction of a predicted tide , even when the tidal analysis is performed on the same time series ( as is the case here ) .",
    "the two best known approaches for detiding data are to subtract off a prediction from a harmonic model ( as described in the previous section ) and to subject the data to a linear time - invariant ( lti ) high - pass filter . to isolate a tsunami signal without distortion , the high - pass filter should retain components with periods as long as 2  hrs .",
    "the so - called ` edge effects ' of such a filter distort at least 1-hr sections at the beginning and at the end of the tsunami signal .",
    "thus an lti filter can not reliably isolate a tsunami signal immediately after it is registered by a dart^^  buoy , whereas it is desirable to make use of this data as soon as possible following the start of a tsunami event .",
    "moreover , most digital filters are designed to work with regularly sampled data and are not easy to adapt if there are gaps in the data . while the bp unit in a dart^^  buoy internally records a measurement once every 15  s , only gappy segments of these data ( or 1-min averages thereof ) are typically available externally following an earthquake event .    in this section and",
    "the next , we explore two approaches to detiding involving linear ( but not time - invariant ) filters .",
    "these approaches are tolerant of data gaps and are less prone to edge effects , thus overcoming the two problems we noted about standard lti high - pass filters .",
    "the first approach is based on extracting the tidal component in a segment of data by back and forth projection onto a specific sub - space in an @xmath65-dimensional space of vectors .",
    "the sub - space is spanned by the empirical orthogonal functions ( eofs ) of segments of length @xmath65 of archived 15-min streams from dart^^  buoys ( tolkova , 2009 ; tolkova , 2010 ) .",
    "the following description of this approach is based on tolkova  ( 2010 ) , to which we refer the reader for more details .",
    "the eof method relies on the premise that , due to the structure of tides in the deep ocean , the sub - space spanned by the leading eofs of tidally dominated data segments of up to 3-days in length is fairly universal across various dart^^  buoys .",
    "oceanic tidal energy is concentrated in the long - period , diurnal , and semidiurnal frequency bands centered around 0 , 1 , and 2 cycles per day ( cpd ) .",
    "the effective diurnal band is from 0.8 to 1.1  cpd , and the semidiurnal , from 1.75 to 2.05  cpd , so the bandwidth for both bands is 0.3  cpd ( munk and cartwright , 1966 ) .",
    "tidal motion thus has two inherent time scales : one day ( the apparent tidal quasi - period ) and 3.3  days ( the shortest tidal segment from which we can in theory resolve individual constituents within either of the two major bands ) .",
    "since tides at different locations differ only in the fine structure of the tidal bands , the premise behind the eof method says that the sub - space spanned by the leading eofs of tidal segments is essentially the same at all dart^^  locations as long as the segment length is so short as to not allow resolution of the fine structure in the tidal bands .",
    "tolkova  ( 2010 ) computed the basis of the eof sub - space of tidally dominated data encompassing one lunar - day ( 24  h 50  min ) using an ensemble of 250 segments taken from dart^^  buoy 46412 in 2007 .",
    "each segment consists of 99 readings sampled at 15  min intervals .",
    "the eofs associated with the seven largest eigenvalues , complemented with a constant vector with elements all equal to @xmath66 , provide the basis for a sub - space spanned by @xmath67 vectors of dimension @xmath68 .",
    "this sub - space is sufficient to capture the bulk of tidal variations in segments of length 99 from a 15-min stream recorded by any dart^^  buoy . to process 1-min streams within the sift system , the @xmath47 vectors were re - sampled to a 1-min interval , yielding vectors of length @xmath69 .",
    "re - orthogonalization and re - normalization produces vectors @xmath70 , @xmath71 , satisfying @xmath72 for @xmath73 and @xmath74 for @xmath75 .",
    "figure  [ fig : eighteofs ] shows the resulting eight vectors .",
    "three steps are needed to accomplish detiding using the @xmath70 vectors . for the sake of argument , suppose the vector @xmath76 contains a segment from a 1-min stream of length @xmath77 ( i.e. , approximately one lunar day ) .",
    "first , we project this segment onto the vectors @xmath70 to obtain @xmath47 coefficients @xmath78 .",
    "second , we estimate the tidal component by taking the @xmath47 vectors , multiplying them by their corresponding coefficients and then adding together the resulting scaled vectors . finally , this estimate of the tidal component is subtracted from @xmath76 , yielding the detided data @xmath35 .",
    "mathematically , we can write @xmath79 where @xmath80 is a @xmath81 matrix whose columns are @xmath82 , and @xmath83 is a vector containing the @xmath47 coefficients . letting @xmath58 and @xmath84 denote , respectively , the @xmath38th element of @xmath76 and the @xmath85th element of @xmath80 and momentarily regarding @xmath86 as a function of @xmath87 , we note that setting @xmath88 equal to @xmath89 results in minimizing the above sum of squares .    we can generalize this technique to handle the case of irregular sampling by the following simple procedure , which ignores the distinction between the 1-min and 15-min streams . for a span of @xmath77 minutes of interest , construct a vector @xmath90 of length @xmath65 that contains all available values from either one of the streams .",
    "let @xmath91 if the @xmath38th element @xmath92 of @xmath90 is actually available from one of the streams , and let @xmath93 if it is not available .",
    "we set @xmath94 such that @xmath95 is minimized with respect to @xmath96 .",
    "minimization of  ( [ eq : aminim ] ) is a least squares problem whose associated normal equations are @xmath97 where @xmath98 is an @xmath81 matrix whose @xmath99th element is @xmath100 .",
    "the system  ( [ eq : aequ ] ) has a numerically viable solution as long as the symmetric @xmath101 matrix @xmath102 is not poorly conditioned . in this case the detided data are contained in @xmath103    the third row of fig .",
    "[ fig : detidingfive ] shows detided bp measurements @xmath62 produced by the eof method .",
    "in contrast to the two methods based on harmonic analysis , the values that are subtracted from the 1-min stream to accomplish eof detiding depend upon the stream itself and hence can change as different amounts of this stream are utilized , as this example illustrates . in particular",
    "we see a systematic upward drift when utilizing data less than or equal to the first full wave , but this drift disappears when we use data one hour past the end of the first full wave .",
    "the five estimates @xmath63 corresponding to different amounts of data are listed in the third row of table  [ tab : alphaestimates ] .",
    "for the three largest amounts of data , these estimates are an improvement in this example over the ones we obtained from the two harmonic methods .",
    "kalman smoothing ( ks ) has been used in numerous applications as a method for optimally smoothing time series as new values of the series become available over time .",
    "the optimality of this procedure is contingent upon our ability to adequately describe the underlying dynamics of the time series in terms of a so - called state space model .",
    "ks - based detiding has been advocated before ( see consoli _",
    "et al . _ , 2014 , and references therein ) ,",
    "but the approach we describe here for detiding data from dart^^  buoys differs from previous approaches in important aspects ( for detailed expositions on ks , see brockwell and davis , 2002 ; durbin and koopman , 2012 ; shumway and stoffer , 2011 ) .",
    "our ks approach is a two - stage procedure .",
    "as before , let @xmath58 represent the 1-min stream from a given scenario to which we have added an artificial tsunami signal .",
    "the first stage is to detide @xmath58 using the first harmonic modeling method , yielding the detided series @xmath62 , @xmath104 , via equation  [ eq : detideoneminuteusingha ] . merely to simplify equations that follow ,",
    "we reindex this first - stage detided series by defining @xmath105 , @xmath106 .",
    "the second stage applies ks to @xmath107 , for which we assume a local level model ( also called a random walk plus noise model ; see brockwell and davis , 2002 ; durbin and koopman , 2012 ) .",
    "this model consists of two equations , the first of which is known as the state equation , and the second , the observation equation .",
    "the state equation takes the form @xmath108 where @xmath109 is the initial state variable , and @xmath110 is a white noise sequence with mean zero and variance @xmath111 .",
    "the observation equation takes the form @xmath112 where @xmath113 is another white noise sequence with mean zero , but now with time - varying variance @xmath114 ( the sequences @xmath113 and @xmath110 are uncorrelated ) .",
    "the intent with this model is to use @xmath115 to track any tidal component left over in the first - stage detiding @xmath107 and to compensate for the presence of the tsunami signal by adjusting @xmath114 appropriately .",
    "based upon the initial state variable @xmath109 , the first - stage detided data @xmath116 and the parameters @xmath111 and @xmath114 , there is an elegant set of equations known as the kalman recursions that give the best ( in the sense of minimum mean square error ) linear estimates of the unknown state variables @xmath117 .",
    "we denote these estimates as @xmath118 . for a fixed index @xmath119 , the estimate @xmath120 of @xmath121 changes as @xmath38 increases , i.e. , as more and more of the first - stage detided series becomes available . given @xmath116",
    ", we define the ks - based detided series to be @xmath122 the corresponding estimate of the source coefficient @xmath0 is given by equation  [ eq : alphahat ] , where now the vector @xmath35 contains the @xmath123 variables .    the unknown parameters that we must set to implement ks - based detiding are @xmath109 , @xmath114 and @xmath111 . for purposes of this paper",
    ", we just use @xmath124 to estimate @xmath109 ; however , to offer some protection against rogue values , the operational version of sift has an option for using the median of @xmath125 .",
    "our estimate @xmath126 of @xmath114 is the sample variance of the seven variables @xmath127 , with estimates for the first three variances @xmath128 , @xmath129 and @xmath130 being set to @xmath131 ( estimates for the last three variances are handled in an analogous manner ) .",
    "we determined a setting for the final parameter @xmath111 in the following manner .",
    "for all 1000 scenarios for a given pairing of a buoy and an artificial tsunami signal with the source coefficient @xmath28 , we used the ks detiding method to compute source coefficient estimates @xmath132 , @xmath133 , over a grid of values for @xmath111 and for various amounts of data .",
    "we then determined which value minimized @xmath134 .",
    "different pairings of buoys and signals and different data lengths led to different minimizing values .",
    "we set @xmath135 after considering a large collection of representative pairings and data lengths  while this value was not optimal for all such pairings and lengths , it performed well overall .    the fourth row of fig .",
    "[ fig : detidingfive ] shows detided bp measurements @xmath136 produced by the ks method . the starting point for this method",
    "is the detided series shown in the first row , which was produced by the first harmonic modeling method .",
    "a comparison of these two detided series shows that the ks method has eliminated the downward trend that is evident in the first seventy minutes of the detrended series produced by harmonic modeling .",
    "in contrast to the first three methods , there is no evidence in the ks detided series of a drift or offset that might be attributable to lingering tidal fluctuations .",
    "similar to eof detiding , ks detided values can change as different amounts of the 1-min stream are utilized , but the changes in the ks method are smaller than those for the eof method in this example .",
    "the five ks - based estimates of @xmath63 corresponding to different amounts of data are listed in the fourth row of table  [ tab : alphaestimates ] .",
    "for this example , these estimates are closer to the true value @xmath28 than the ones corresponding to the first three methods .",
    "the four detiding methods we have considered so far are similar in that they all produce a detided series @xmath35 .",
    "we then use @xmath35 to produce an estimate @xmath63 of the source coefficient via the ols estimator of equation  [ eq : alphahat ] .",
    "the fifth and final method estimates the tidal component jointly with the source coefficient based on just the 1-min stream ( merely to simplify the description below , we assume this stream to be gap - free , but it is easy to reformulate this method to handle gaps ) .",
    "this joint estimation method is based on the model @xmath137 where @xmath76 is an @xmath65 dimensional vector containing a portion of the 1-min stream from a scenario to which the artificial tsunami signal @xmath138 has been added ; @xmath139 is a vector of ones ; @xmath140 is a vector whose elements are @xmath141 , @xmath142 , with @xmath143 and @xmath60 being , respectively , the tidal frequency m2 and half that frequency and with @xmath144  min ; @xmath145 is analogous to @xmath140 , but with sines replacing cosines ; @xmath146 is a vector of errors ( presumed to have mean zero and a common variance ) ; and @xmath45 , @xmath147 , @xmath148 , @xmath149 , @xmath150 and @xmath0 are unknown parameters . in essence",
    ", this method estimates the tidal component via a two - constituent harmonic model ( as alternatives to this model , we also considered harmonic models with other than two constituents and polynomial models of various orders , but the two - constituent harmonic model worked best overall for joint estimation of @xmath0 ) .",
    "equation  [ eq : joint ] can be rewritten as @xmath151 where @xmath152 is an @xmath153 design matrix whose columns are @xmath139 , @xmath154 , @xmath155 , @xmath156 , @xmath157 and @xmath22 , while @xmath158 is a vector of coefficients .",
    "the ols estimate @xmath159 of @xmath160 satisfies the normal equations @xmath161 subject to the invertibility of @xmath162 ( in the study discussed in sect .",
    "[ sec : results ] , no instances of non - invertibility were encountered ) .",
    "we can take the detided series for this method to be @xmath163 a strength of this detiding method is that , in contrast to the other four methods , it does not make any use of the 15-min stream , which , as we ve noted before , was entirely missing in one actual tsunami event .    the fifth row of fig .",
    "[ fig : detidingfive ] shows detided bp measurements @xmath164 produced by the joint estimation method , with the five estimates of @xmath63 corresponding to different amounts of data being listed in the fifth row of table  [ tab : alphaestimates ] .",
    "although in this example the detided series for this and the ks method are visually similar to each other , the joint estimation - based @xmath63 estimates are always closer to the true value of @xmath28 than the ks - based estimates .",
    "here we compare the five detiding methods described in the previous section by considering how well each method estimates the source coefficient @xmath0 from simulated tsunami events constructed as per equation  [ eq : model1 ] ( an example of one such event is shown in fig .",
    "[ fig : oneevent ] ) . for each of the 47 buoy / unit source pairings listed in table  [ tab : unitsources ]",
    ", we constructed 1000 simulated events based upon the 1000 scenarios created for each buoy .",
    "for each such event and for five different amounts of data from the 1-min stream ranging from a quarter of the first full wave ( 1/4 ffw ) of the tsunami signal up to an hour past the end of the ffw , we estimated @xmath0 using the five detiding methods , thus yielding @xmath165 estimated coefficients for each method .",
    "the task at hand is to summarize how well each method did .",
    "we start by considering results for the pairing of buoy 52402 with unit source ki060b ( this same combination is used in all or part of figs .",
    "[ fig : scenario ] to [ fig : detidingfive ] and in table  [ tab : alphaestimates ] ) . figure  [ fig : scatterfive ] has five rows , one for each of the five methods .",
    "the dots in a given row show the 1000 estimates @xmath63 derived from data just up to 3/4 ffw .",
    "ideally we would like to see estimates that cluster tightly around the true value @xmath24 ( indicated by a blue dashed line ) .",
    "the scatter in the estimates for the two methods based on harmonic analysis ( top two rows ) is much larger than that for the three remaining methods . with only a few exceptions ,",
    "this pattern persists for all 47 buoy / unit source pairings and for all five amounts of data and tells us that these two methods are not competitive with the other methods .    the distribution of the estimates in each row of fig .",
    "[ fig : scatterfive ] is summarized on the right - hand side by a boxplot ( chambers _ et al .",
    "_ , 1983 ) .",
    "the central box in each boxplot has three horizontal lines , which indicate , from bottom to top , the lower quartile , the median and the upper quartile of the data .",
    "the short horizontal line below the central box is the lower hinge , which indicates the estimate @xmath63 that is closest to  but not less than  the value of the lower quartile minus 1.5 times the interquartile distance ( the upper quartile minus the lower quartile ) . the upper hinge has a similar interpretation , with ` not less than ' replaced by ` not greater than ' and with ` lower quartile minus ' replaced by ` upper quartile plus ' .",
    "any estimates @xmath63 that happen to be either smaller than the lower hinge or greater than the upper hinge are indicated by circles . because the variability in the estimates for the first two methods is so much greater than those for the three remaining methods , only the boxplots for the former are clearly visible in fig .",
    "[ fig : scatterfive ] .",
    "figure  [ fig : boxplots ] shows boxplots for the just latter three methods on a common scale , but now for all five amounts of data rather than just data up to 3/4 ffw .",
    "these boxplots show that the eof estimates tend to be biased low when using data less than or equal to 3/4 ffw , whereas the ks estimates are biased high , but to a lesser degree ( the boxplots show medians , but there would be no noticeable differences had we shown sample means rather medians in fig .  [",
    "fig : boxplots ] ) .",
    "by contrast there is little evidence of bias in the joint - estimation estimates . for estimates based on data up to the ffw or smaller amounts ,",
    "the spreads of the distributions are generally greatest for the eof estimates and smallest for the joint - estimation estimates .",
    "figure  [ fig : onermse ] summarizes the spreads in the distributions involved in figs .",
    "[ fig : scatterfive ] and  [ fig : boxplots ] via root - mean - square errors ( rmses ) , i.e. , @xmath166 ) . by this measure",
    "the two methods based on harmonic analysis are about an order of magnitude worse than the best method ( joint estimation ) . with almost no exceptions",
    ", this poor rmse performance persists through all 47 buoy / unit source pairings and all five amounts of data under study .",
    "the joint estimation method outperforms the eof and ks methods , but the former becomes competitive when the largest amount of data is used , and the latter , for the smallest and two largest amounts . increasing",
    "the amount of data from 1/4 ffw to ffw results in approximately half an order of magnitude drop in rmse for all five methods ( table  [ tab : unitsources ] indicates that the time it takes to collect the extra data from 1/4 ffw to ffw is 14  min for this particular buoy / unit source pairing ) .",
    "figure  [ fig : stackedrmses ] is similar to fig .",
    "[ fig : onermse ] , but now shows rmse plots for the twelve representative buoy / unit source pairings shown in figs .  [ fig : unitsources ] and  [ fig : tsunamievents ] . to simplify this figure , we do not show results for the two non - competitive methods based upon harmonic analysis .",
    "the joint estimation method tends to outperform the eof and ks methods when more than 1/4 ffw of data is involved , but not uniformly so ( the pairing of buoy 51407 with unit source cs100b in the middle plot on the bottom row offers a counterexample ) .",
    "the ks method generally outperforms the eof method .",
    "there are a number of instances in which rmse increases for the eof and ks methods when the amount of data increases from 1/4 ffw to 1/2 ffw .",
    "this pattern is counterintuitive since more data should imply a more stable estimate of @xmath0 ; however , this behavior is confirmed by an analytic theory in which the tsunami s partial waves are regarded as a filter on the tides .    figure  [ fig : bestrmseqw ] has five plots , one for each amount of data under study , with points indicating ratios of rmses involving all 47 twelve buoy / unit source pairings .",
    "the ratios are formed by taking the rmse for either the eof , ks or joint estimation method and dividing it by the best rmse amongst all five detiding methods .",
    "a ratio of one for a particular method indicates that it is the best method .",
    "the top plot is for 1/4 ffw and shows the ks and joint estimation methods about evenly divided for best - method honors .",
    "the buoys are ordered such that those that are separated most in distance from their unit sources ( 51406 , 51407 and 44401 ) are on the right - hand side of the plots .",
    "the ks method generally outperforms the joint estimation method for these buoys , which tend to have lower signal - to - noise ratios than the buoy / unit source pairings on the left - hand side of the plot . as the amount of data increases beyond 1/4 ffw ( four bottom plots ) ,",
    "there are increasingly fewer pairings where the joint estimation method fails to be the method of choice .",
    "we also note that the disparity amongst the three methods tends to decrease as the amount of data increases .",
    "finally , we note that , as alternatives to rmse as a summary measure , we also considered the mean absolute error @xmath167 , the maximum absolute error @xmath168 and the maximum absolute negative error , i.e. , @xmath168 with @xmath169 ranging over values such that @xmath170 .",
    "these last two measures are based on worst - case scenarios , which are of considerable operational interest ; in particular , the last measure focuses on worst - case underestimation of @xmath0 , which can lead to forecasting coastal inundations that are too small .",
    "all three additional measures lead to the same conclusions we drew using the rmse : the joint estimation method is generally to be preferred over the eof and ks methods , and the two methods involving only harmonic analyses are not competitive .",
    "here we apply the five detiding methods to data collected during the devastating 2011 japan tsunami , which was generated by the great mw 9.0 earthquake that occurred on march 3rd at 05:46:23  ut ( @xmath3 ) ( tang _ et al .",
    "_ , 2012 ; wei _ et al .",
    "_ , 2012 ; wei _ et al .",
    "_ , 2014 ) .",
    "several dart^^  buoys recorded this event , including buoy 52402 .",
    "figure  [ fig : tohokudata ] shows the data from 52402 we make use of here .",
    "the data consist of a 15-min stream starting 29  days prior to @xmath3 and ending 2.0  hrs before @xmath3 , and a 1-min stream starting 1.8  hrs prior to @xmath3 and ending a day after @xmath3 ( there is a small gap in the 15-min stream around 14 days prior to @xmath3 ) .",
    "the first method uses a 6 constituent harmonic analysis based on the 29 days of data prior to the event time @xmath3 ( these are mostly from the 15-min stream , but there are 1.8 hours from the 1-min stream ) . the top plot in fig .",
    "[ fig : detidingtohoku ] shows the corresponding detided series , which is the difference between data from the 1-min stream recorded after @xmath3 and predicted values based on the fitted harmonic model .",
    "this series shows rapid fluctuations starting about 10  min after @xmath3 and dissipating after about 90  min .",
    "these are evidently due to seismic noise from the earthquake . ignoring this noise ,",
    "the detided series starts at a positive intercept and then rises almost linearly until about 210 minutes , at which point the tsunami signal becomes evident .",
    "the five black circles are subjectively chosen markers of a quarter of the first full wave ( ffw ) , a half , three quarters , the end of the ffw and one hour past the end of the ffw ( these occur at , respectively , 225 , 232 , 236 , 245 and 305  min after @xmath3 ) .",
    "the true tidal fluctuations are of course unknown , but a reasonable conjecture is that the linear increase in evidence here is actually a tidal component that the first method failed to properly extract .",
    "the second method uses a 68 constituent harmonic analysis based on 465 days of data collected by buoy 52402 between 12/13/2006 and 3/21/2008 , i.e. , well before the 2011 japan tsunami . the detided series , shown below the top plot in fig .",
    "[ fig : detidingtohoku ] , is again the difference between data from the 1-min stream and predicted values based on the fitted harmonic model , but with the mean level of the predictions adjusted using the 29 days of data prior to @xmath3 . in comparison to the first method , there is now only a slight linear increase in the first three hours , but the positive intercept is larger .",
    "the third method is eof - based and yields detided series that depend on the amount of the 1-min stream after @xmath3 we wish to detide . the middle plot in fig .",
    "[ fig : detidingtohoku ] shows five detided series color coded to indicate the amount of data used ( red , green , cyan , magenta and black for data ending at , respectively from left to right , the locations of the five solid circles , and starting 1470 minutes earlier ) .",
    "differences between the displayed detided series at the same location in time are typically small , but do get as large as 5.7  cm . ignoring seismic noise , all five detided series are relatively flat out to 150  min , after which they exhibit a noticeable dip prior to the arrival of the tsunami signal . while we might be tempted to regard this dip as a remanent tidal component ,",
    "caution is in order since true tidal fluctuations are unknown .",
    "the fourth method ",
    "kalman smoothing  is similar to the eof method in that the detided series depends on the amount of the 1-min stream to be detided , but is dissimilar in that detiding involves data prior to @xmath3 only indirectly because the starting point for the ks method is the detided series provided by the first method . the next - to - bottom plot in fig .",
    "[ fig : detidingtohoku ] shows five detided series color coded in the same manner as before .",
    "the differences between the detided series at the same point in time are again typically small , with the largest difference now being 0.7  cm .",
    "there is only a slight hint here of the dip readily apparent in the eof detided series .",
    "similar to the eof and ks methods , the final method ( a 2 constituent local harmonic analysis with joint source coefficient estimation ) yields detided series that depend upon the amount of the 1-min stream to be detided , but , in contrast , it makes no direct or indirect use of any data prior to @xmath3 .",
    "this method , however , does depend upon a suitable model for the tsunami signal .",
    "_  ( 2014 ) discuss selection of unit sources for the japan tsunami using an objective automatic method .",
    "the selection is based on data from three dart^^  buoys ( 21401 , 21413 and 21418 ) located much closer to the epicenter of the earthquake than buoy 52402 is .",
    "these buoys registered the tsunami signal within 5  min after @xmath3 , well before it arrived at buoy 52402 more than 3  h later .",
    "the automatic method selected seven unit sources @xmath8 , ",
    ", @xmath171 to model the tsunami signal .",
    "accordingly , we need to adjust the joint estimation method to make use of seven unit sources rather than just one .",
    "we do so by suitably redefining the design matrix @xmath152 and the vector of coefficients @xmath172 in equation  [ eq : jointrewritten ] .",
    "thus @xmath152 is now of dimension @xmath173 , with its first five columns being as before and with its next seven columns now being @xmath8 ,  , @xmath171 ; correspondingly , @xmath174 is augmented to dimension 12 , with its last seven elements being the source coefficients for the unit sources .",
    "after these adjustments to @xmath152 and @xmath174 , we produce the detided series using the same equations as before ( [ eq : normalequations ] and [ eq : jointdetided ] ) . the bottom plot in fig .",
    "[ fig : detidingtohoku ] shows detided series for the joint estimation method ( five in all corresponding to different amounts of data ) .",
    "these series are visually quite similar to the ks detided series , but the largest difference between the joint detided series is larger ( 3.6  cm ) than for the ks series ( 0.7  cm ) .",
    "it is important to note that , in contrast to the other four methods , the joint estimation method is dependent upon a suitable model for the tsunami signal . to demonstrate this fact , the two plots in fig .  [ fig : detidingtohokuoneus ] show detided series using the joint estimation method , but based upon different models .",
    "the top plot is the same as the bottom plot in fig .",
    "[ fig : detidingtohoku ] , for which the detided series utilize a model involving seven unit sources . in the bottom plot",
    "the detided series use a model based on only one of these seven sources ( ki026b ) .",
    "the magnitude of the earthquake that generated the 2011 japan tsunami was so large that it is physically unrealistic for the signal to be well - modeled by a single unit source ( papazachos _ et al . _ , 2004 ) .",
    "the detided series from this presumably inadequate model have low - frequency fluctuations in the first three hours that are not evident in the top plot ( or in the ks - based detided series , which are shown in the next - to - bottom plot of fig .",
    "[ fig : detidingtohoku ] ) .",
    "these fluctuations are best attributed to a failure on the part of the joint estimation method due to an inappropriate model .",
    "we have undertaken a comprehensive comparison of five methods for estimating the source coefficient @xmath0 based upon dart^^  buoy bottom pressure ( bp ) data collected during a tsunami event ( this coefficient reflects the strength of the event and is used to provide initial conditions for predicting coastal inundation ) .",
    "any method for estimating @xmath0 must deal with the fact that the variability in bp data is typically dominated by tidal fluctuations , and hence all viable methods must detide the data in some explicit or implicit manner .",
    "the five methods under study have been entertained as part of the on - going development of the sift application , a tool developed at noaa for use by u.s .",
    "tsunami warning centers for real - time assessment of tsunami events .",
    "the clear method of choice is a scheme by which @xmath0 is estimated jointly in a regression model that accounts for the tidal components using sinusoidal constituents involving the tidal frequency m2 and half that frequency .",
    "this method is particularly convenient from an operational point of view in that it does not make direct use of data occurring prior to a tsunami event , as is true in varying degrees for the four other methods under study . amongst the four remaining methods , the kalman smoothing ( ks ) method performed best overall in our study . in some cases ,",
    "the eof method is competitive with the joint estimation and ks methods , but the two methods based on only harmonic analyses proved to be markedly inferior to the other three methods .",
    "note that we evaluated the performance of the eof method using a specific set of eight basis vectors adapted for use within the sift system .",
    "we limited this set to eight vectors due to the fact that only this number of vectors defines a location - independent tidal sub - space , should the set be derived using data from a single buoy , as was the case here ( tolkova , 2010 ) . expanding",
    "the set of vectors by deriving them from multiple buoys might allow for more accurate detiding .    despite the fact that our study points to the joint estimation method as the method of choice , some caution is in order .",
    "a presumption behind our study is that the model for the tsunami signal is known perfectly , which is obviously unrealistic in practice .",
    "the issue of model mismatch must therefore temper our conclusions , a point that is reinforced by the discussion surrounding fig .",
    "[ fig : detidingtohokuoneus ] . for graphical presentation of detided series within sift",
    ", the fact that the ks method does not depend on an assumed model for the tsunami signal  but often compares favorably with the joint estimation method  suggests its use . as currently implemented , the ks method uses the output from the 29-day harmonic analysis method as its starting point . in cases where the 15-min stream is not available over much of the preceding 29 days , the blanket harmonic method could provide a model - free detiding for display purposes , as could the eof method if the 15-min stream were available going back about a lunar day from the start of the tsunami signal .",
    "there is thus potential use within sift for all five methods we have studied . as of this writing ,",
    "the current version of sift supports the 29-day harmonic analysis , eof and ks methods , and there are plans to implement the joint estimation method within an overall scheme for automatically selecting unit sources to serve as models for the tsunami signal .",
    "this work was funded by the joint institute for the study of the atmosphere and ocean ( jisao ) under noaa cooperative agreement no .",
    "na17rj1232 and is jisao contribution no .",
    "this work is also contribution no .",
    "4089 from noaa / pacific marine environmental laboratory .",
    "the authors thank george mungov of noaa s national geophysical data center for supplying dart^^  buoy data and predictions based upon harmonic analyses with 68 sinusoidal constituents .",
    "brockwell , p.j . , and davis , r.a .",
    "( 2002 ) , _ introduction to time series and forecasting _ , 2nd edition .",
    "springer , 448  p. cartwright , d.e . , spencer , r. , and vassie , j.m .",
    "( 1987 ) , _ pressure variations on the atlantic equator _ , j.  geophys .",
    "92_(c1 ) , 725741 , doi:10.1029.jc092ic01p00725 . chambers , j.m . ,",
    "cleveland , w.s . ,",
    "kleiner , b. , and tukey , p.a .",
    "( 1983 ) , _ graphical methods for data analysis_. wadsworth & brooks / cole , 409  p. consoli , s. , recupero , d.r . , and zavarella , v.  ( 2014 ) , _ a survey of tidal analysis and forecasting methods for tsunami detection _ , j.  tsunami soc .  int .  _",
    "33_(1 ) , 156 .",
    "cummins , p.f . ,",
    "cherniawsky , j.y . , and foreman , m.g.g .",
    "( 2001 ) , _ north pacific internal tides from the aleutian ridge : altimeter observations and modeling _ ,",
    "j.  marine res .  _",
    "59_(2 ) , 167191 . durbin , j. , and koopman , s.j .",
    "( 2012 ) , _ time series analysis by state space methods _ , 2nd edition .",
    "oxford university press , 368  p. foreman , m.g.g .",
    "( 1977 , revised 2004 ) , _",
    "manual for tidal heights analysis and prediction .",
    "pacific marine science report . _ 7710 .",
    "institute of ocean sciences , patricia bay , 58 pp .",
    "gica , e. , spillane , m.c . ,",
    "titov , v.v . , chamberlin , c.d . , and newman , j.c .",
    "( 2008 ) , _ development of the forecast propagation database for noaa s short - term inundation forecast for tsunamis ( sift)_. noaa tech .  memo .",
    "oar pmel139 , 89 pp .",
    "gonzlez , f.i . ,",
    "bernard , e.n . ,",
    "meinig , c. , ebl , m.c . ,",
    "mofjeld , h.o . , and",
    "stalin , s.  ( 2005 ) , _ the nthmp tsunameter network _ , natural hazards _",
    "35_(1 ) , special issue , u.s .",
    "national tsunami hazard mitigation program , 2539 .",
    "mofjeld , h.o .",
    "( 2009 ) , _ tsunami measurements_. in the sea , volume 15 : tsunamis ( eds .  e.n .",
    "bernard and a.r .",
    "robinson ) , harvard university press , cambridge , ma , pp .",
    "mofjeld , h.o . , whitmore , p.m. , ebl , m.c .",
    ", gonzlez , f.i . , and newman , j.c .",
    "( 2001 ) , _ seismic - wave contributions to bottom pressure fluctuations in the north pacific  implications for the dart tsunami array_. proceedings of the international tsunami symposium 2001 ( its 2001 ) ,",
    "session 5 - 10 , seattle , wa , 710 august 2001 , 633641 .",
    "mungov , g. , elb , m. , and bouchard , r  ( 2012 ) , _",
    "dart^^  tsunameter retrospective and real - time data : a reflection on 10 years of processing in support of tsunami research and operations _ , pure appl .",
    "geophys .  _",
    "170_(910 ) , 13691384 , doi:10.1007/s00024 - 012 - 0477 - 5 munk , w.h . , and cartwright , d.e .",
    "( 1966 ) , _ tidal spectroscopy and prediction _ , phil .",
    "london , series a , mathematical and physical sciences _ 259 _ , 533581 .",
    "niiler , p.p . ,",
    "filloux , j. , liu , w.t . ,",
    "samelson , r.m . ,",
    "paduan , j.d . , and paulson , c.a .",
    "( 1993 ) , _ wind - forced variability of the deep eastern north pacific : observations of seafloor pressure and abyssal currents _ , j.  geophys .",
    "98_(c12 ) , 2258922602 , doi:10.1029/93jc01288 noaa data management committee  ( 2008 ) , _ tsunami data management : an initial report on the management of environmental data required to minimize the impact of tsunamis in the united states _ , version 1.0 , 87 pp .",
    "http://www.ngdc.noaa.gov/noaa_pubs/index.shtml papazachos , b.c . ,",
    "scordilis , e.m . ,",
    "panagiotopoulos , d.g . ,",
    "papazachos , c.b . , and karakaisis , g.f .",
    "( 2004 ) , _ global relations between seismic fault parameters and earthquake moment _ , horizontal parker , b.p .",
    "( 2007 ) , _ tidal analysis and prediction_. noaa special publication nos co - ops 3 ; 378 p. percival , d.b . , denbo , d.w . ,",
    "elb , m.c . ,",
    "gica , e. , mofjeld , h.o . , spillane , m.c .",
    ", tang , l. , and titov , v.v .",
    "( 2011 ) , _ extraction of tsunami source parameters via inversion of dart^^  buoy data _ , natural hazards _",
    "58_(1 ) , 567590 , doi:10.1007/s11069 - 010 - 9688 - 1 percival , d.m . ,",
    "percival , d.b . ,",
    "denbo , d.w . ,",
    "gica , e. , huang , p.y . , mofjeld , h.o . , and spillane , m.c .",
    "( 2014 ) , _ automated tsunami source modeling using the sweeping window positive elastic net _ , j.  amer .  stat .",
    "assoc .  under review",
    ". ray , r.d . , and luthcke , s.b .",
    "( 2006 ) , _ tide model errors and grace gravimetry : towards a more realistic assessment _ , geophys .",
    "j.  int .  _",
    "167_(3 ) , 10551059 , doi:10.1111/j.1365 - 246x.2006.03229.x shumway , r.h . , and stoffer , d.s .  ( 2011 ) , _ time series analysis and its applications with r examples _",
    ", 3rd edition .",
    "springer , 608  p. spillane , m.c .",
    ", gica , e. , titov , v.v . , and mofjeld , h.o .",
    "( 2008 ) , _ tsunameter network design for the u.s .",
    "dart^^  arrays in the pacific and atlantic oceans_. noaa tech",
    ".  memo .",
    "oar pmel143 , 165 pp .",
    "http://nctr.pmel.noaa.gov/pubs.html tang , l. , titov , v.v . ,",
    "bernard , e.n .",
    ", wei , y. , chamberlin , c.d . , newman , j.c .",
    ", mofjeld , h.o . , arcas , d. , eble , m.c . ,",
    "moore , c. , uslu , b. , pells , c. , spillane , m. , wright , l. , and gica , e.  ( 2012 ) , _ direct energy estimation of the 2011 japan tsunami using deep - ocean pressure measurements _ , j.  geophys .",
    "117_(c8 ) , c08008 , doi:10.1029/2011jc007635 .",
    "titov , v.v .",
    "( 2009 ) , _ tsunami forecasting_. in the sea , volume 15 : tsunamis ( eds .  e.n .",
    "bernard and a.r .",
    "robinson ) , harvard university press , cambridge , ma , pp .",
    "titov , v.v . ,",
    "gonzlez , f.i . ,",
    "bernard , e.n . ,",
    "ebl , m.c .",
    ", mofjeld , h.o . , newman , j.c . , and venturato , a.j .",
    "( 2005 ) , _ real - time tsunami forecasting : challenges and solutions _ , natural hazards _",
    "35_(1 ) , special issue , u.s .  national tsunami hazard mitigation program , 4158 .",
    "titov , v.v . ,",
    "mofjeld , h.o .",
    ", gonzlez , f.i . , and newman , j.c .",
    "( 1999 ) , _ offshore forecasting of hawaiian tsunamis generated in alaskan  aleutian subduction zone_. noaa tech",
    ".  memo .",
    "oar pmel114 , 22 pp . http://nctr.pmel.noaa.gov/pubs.html tolkova , e.  ( 2009 ) , _ principal component analysis of tsunami buoy record : tide prediction and removal _ , dyn .",
    "46_(14 ) , 6282 , doi:10.1016/j.dynatmoce.2008.03.001 tolkova , e.  ( 2010 ) , _ eof analysis of a time series with application to tsunami detection _ , dyn .",
    "50_(1 ) , 3554 , doi:10.1016/j.dynatmoce.2009.09.001 webb , s.c .",
    "( 1998 ) , _ broadband seismology and noise under the ocean _ , rev .",
    "geophys .  _",
    "36_(1 ) , 105142 .",
    "wei , y. , chamberlin , c. , titov , v.v . ,",
    "tang , l. , and bernard , e.n .",
    "( 2013 ) , _ modeling of the 2011 japan tsunami : lessons for near - field forecast _ , pure appl .",
    "geophys .  _",
    "170_(68 ) , 13091331 , doi : 10.1007/s00024 - 012 - 0519-z wei , y. , newman , a.v . ,",
    "hayes , g.p . ,",
    "titov , v.v . , and tang , l.  ( 2014 ) , _ improving tsunami forecast by joint inversion of real time tsunami waveforms and seismic or gps data : application to the tohoku 2011 tsunami _ , pure appl .",
    "geophys .  in press .",
    "zhao , z. , and alford , m.h .",
    "( 2009 ) , _ new altimetry estimates of mode-1 m2 internal tides in the central north pacific ocean _ , j.  phys .",
    "ocean .  _",
    "39_(7 ) , 16691684 , doi:10.1175/2009jpo3922.1    .eleven representative dart^^  buoys used in detiding study .",
    "the buoy locations are shown by triangles on fig .",
    "[ fig : detidingpaperchart ] .",
    "the tidal range is a mean daily range as estimated from the harmonic constituents described in sect .",
    "[ sec : harmonic ] for the second harmonic method ( mofjeld _ et al .",
    "_ , 2004 ) .",
    "the type of tide is also based upon these constituents ( parker , 2007 ) .",
    "the start / stop dates are those associated with the bottom pressure data retrieved from the particular buoy , and the column marked ` days ' gives the number of days spanned by the data . [ cols=\"^,^,^,^,^,^ \" , ]       set to 9:21:00  ut on 27 june 2007 .",
    "the points show the 15-min stream , which starts 29 days prior to @xmath3 , but has a 3-h gap just prior to it .",
    "the dark curve on the right - hand side is the 1-min stream , which starts at @xmath3 and ends one day later .",
    ", title=\"fig : \" ] +    -6pt as the dark curve on the right - hand side ) .",
    "this stream is assumed to consist of tidal fluctuations and background noise summed together , i.e. , @xmath21 from equation  [ eq : model1 ] .",
    "the middle plot shows @xmath175 with @xmath0 set to 6 , where @xmath26 is based on ki060b , one of the unit sources associated with 52402 ( see table  [ tab : unitsources ] ) . the bottom plot is a simulated tsunami event @xmath4 formed by adding @xmath23 to @xmath21 .",
    ", title=\"fig : \" ] +    -25pt .",
    "each signal is based upon a model for what would be observed eventually over a 120-min segment of time at a particular buoy due to an earthquake originating within a particular unit source ( the starting time of each segment is different for each signal ) .",
    "the source coefficient @xmath0 is adjusted separately for each signal merely for plotting purposes ( the actual ranges for the unscaled @xmath26 s are listed in table  [ tab : unitsources ] ) .",
    "there are five hand - picked red points in each plot .",
    "these are associated with varying amounts of data related to the first full wave of the signal , namely , the first quarter of the full wave , half , three - quarters , all the full wave and one - hour past the end of the first full wave .",
    ", title=\"fig : \" ] +    -25pt .",
    "each event is formed by adding the artificial tsunami signal @xmath27 shown in fig .",
    "[ fig : unitsources ] ( but with @xmath0 now set to 6 ) to the 1-min stream of a scenario randomly chosen from amongst the 1000 scenarios for a given buoy .",
    "the vertical height of each plot is 1.2 m .",
    ", title=\"fig : \" ] +    -6pt . each plot corresponds to one of the five methods under study . from top to bottom , these are ( 1 )  a 6 constituent harmonic analysis ( ha ) based on 29 days of the 15-min stream before @xmath3 ( the start of the 1-min stream ) , ( 2 )  a 68 constituent ha based on all available 15-sec data , ( 3 )  an empirical orthogonal function approach , ( 4 )  a kalman smoother approach and ( 5 )  a 2 constituent local ha with joint estimation of the source coefficient @xmath0 . in plots  ( 3 ) to  ( 5 ) , there are five color - coded curves , each corresponding to detiding based upon one of five different amounts of data ( some curves in  ( 4 ) and  ( 5 ) are partially obscured because they are virtually identical to other curves ) .",
    "red indicates use of data from @xmath3 up to a quarter of the first full wave ( ffw ) of the tsunami signal ; green , to half of the ffw ; cyan , to three quarters ; magenta , to the end of the ffw ; and black , to one hour past the end of the ffw .",
    "the five ending times are shown by black circles ( the first four are listed in table  [ tab : unitsources ] on the row pertaining to buoy 52402 and unit source ki060b , and all five are shown as red circles in the left - hand plots on the third rows of figs .",
    "[ fig : unitsources ] and  [ fig : tsunamievents ] ) .",
    ", title=\"fig : \" ] +    , @xmath176 , used in eof - based detiding .",
    "the vectors consist of a constant vector @xmath177 and vectors related to eofs having the seven largest eigenvalues .",
    "the vectors are arranged in the plot according to their number @xmath178 of zero crossings .",
    ", title=\"fig : \" ] +    -6pt ( dots ) given by , from top to bottom , ( 1 )  a 6 constituent harmonic analysis ( ha ) based on 29 days of the 15-min stream before @xmath3 ( the start of the event ) , ( 2 )  a 68 constituent ha based on all available 15-sec data , ( 3 )  an empirical orthogonal function approach , ( 4 )  a kalman smoother approach and ( 5 )  a 2 constituent local ha with joint estimation of the source coefficient @xmath0 .",
    "each estimate is based on data up to three quarters of the first full wave from one of the 1000 scenarios for buoy 52402 , to which has been added an artificial tsunami signal based on unit source ki060b with source coefficient @xmath28 .",
    "the dots for the estimates for scenario 943 are surrounded by a red triangle ( this scenario is used as an example in figs .  [",
    "fig : scenario ] , [ fig : oneevent ] and  [ fig : detidingfive ] and in table  [ tab : alphaestimates ] ) .",
    "the boxplot on each row summarizes the distribution of the corresponding @xmath63 estimates ( see text for details ) .",
    ", title=\"fig : \" ] +     based on simulated tsunami events constructed from buoy 52402 and unit source ki060b .",
    "the estimates are based on , respectively , the eof , ks and joint estimation methods ( top to bottom ) and data up to ( from left to right ) a quarter of the first full wave ( ` qw ' ) , half of the full wave ( ` hw ' ) , three - quarters ( ` tqw ' ) , the full wave ( ` fw ' ) and one hour past the end of the first full wave ( ` hr ' ) . , title=\"fig : \" ] +     based on simulated tsunami events constructed from buoy 52402 and unit source ki060b . for each of five methods ,",
    "rmses are shown for estimates based on data up to ( from left to right ) a quarter of the first full wave ( ` qw ' ) , half of the full wave ( ` hw ' ) , three - quarters ( ` tqw ' ) , the full wave ( ` fw ' ) and one hour past the end of the first full wave ( ` hr ' ) . , title=\"fig : \" ] +         set to 05:46:23  ut on 3/11/2011 .",
    "the points show the 15-min stream , which goes from 29 days up to 2.0 hours prior to @xmath3 .",
    "the dark curve on the right - hand side is the 1-min stream , which starts 1.8 hours prior to @xmath3 and ends one day after @xmath3 .",
    ", title=\"fig : \" ] +    -6pt .",
    "each plot corresponds to a different detiding method . from top to bottom , these are ( 1 )  a 6 constituent harmonic analysis ( ha ) based on 29 days of data before @xmath3 ( the start of the event ) , ( 2 )  a 68 constituent ha based on 15-sec data recorded from 12/13/2006 to 3/21/2008 ; ( 3 )  an empirical orthogonal function approach , ( 4 )  a kalman smoother approach and ( 5 )  a 2 constituent local ha with joint estimation of source coefficients .",
    "see the caption to fig .",
    "[ fig : detidingfive ] for an explanation of the black circles and the color - coded curves in the bottom three plots .",
    ", title=\"fig : \" ] +    -6pt using the method based on a two constituent local harmonic analysis with joint estimation of source coefficients .",
    "the top plot here is identical to the bottom plot of fig .",
    "[ fig : detidingtohoku ] , for which the detided series are based on a model for the tsunami signal that is the linear combination of six unit sources selected by an objective automatic procedure ( percival _ et al . _ , 2014 ) . in the bottom plot ,",
    "the detided series are based on a single unit source that is presumably an inadequate description of the underlying tsunami signal .",
    "see the caption to fig .",
    "[ fig : detidingfive ] for an explanation of the black circles and the color - coded curves in these plots .",
    ", title=\"fig : \" ] +"
  ],
  "abstract_text": [
    "<S> u.s .  </S>",
    "<S> tsunami warning centers use real - time bottom pressure ( bp ) data transmitted from a network of buoys deployed in the pacific and atlantic oceans to tune source coefficients of tsunami forecast models . for accurate coefficients and therefore forecasts , tides at the buoys </S>",
    "<S> must be accounted for . in this study , </S>",
    "<S> five methods for coefficient estimation are compared , each of which accounts for tides differently . </S>",
    "<S> the first three subtract off a tidal prediction based on ( 1 )  a localized harmonic analysis involving 29 days of data immediately preceding the tsunami event , ( 2 )  68 pre - existing harmonic constituents specific to each buoy , and ( 3 )  an empirical orthogonal function fit to the previous 25 hrs of data . </S>",
    "<S> method  ( 4 ) is a kalman smoother that uses method  ( 1 ) as its input . </S>",
    "<S> these four methods estimate source coefficients after detiding . </S>",
    "<S> method  ( 5 ) estimates the coefficients simultaneously with a two - component harmonic model that accounts for the tides . </S>",
    "<S> the five methods are evaluated using archived data from eleven dart^^  buoys , to which selected artificial tsunami signals are superimposed . </S>",
    "<S> these buoys represent a full range of observed tidal conditions and background bp noise in the pacific and atlantic , and the artificial signals have a variety of patterns and induce varying signal - to - noise ratios . the root - mean - square errors ( rmses ) of least squares estimates of sources coefficients using varying amounts of data are used to compare the five detiding methods . </S>",
    "<S> the rmse varies over two orders of magnitude between detiding methods , generally decreasing in the order listed , with method  ( 5 ) yielding the most accurate estimate of source coefficient . </S>",
    "<S> the rmse is substantially reduced by waiting for the first full wave of the tsunami signal to arrive . as a case study , the five method </S>",
    "<S> are compared using data recorded from the devastating 2011 japan tsunami . </S>"
  ]
}