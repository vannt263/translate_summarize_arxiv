{
  "article_text": [
    "let @xmath0 be the symmetric group on @xmath1 symbols and @xmath2 be the long cycle in @xmath0 .",
    "this paper is focused on the enumeration of the number of factorizations of @xmath3 as a product of three permutations @xmath4 , @xmath5 , @xmath6 with a given number of cycles @xmath7 , @xmath8 , @xmath9 .",
    "factorizations in the symmetric group received significant attention over the past two decades . among the most celebrated results in the field , harer and zagier in @xcite enumerated the factorization of the long cycle as a product of a permutations and a fixed point free involution . later on , jackson ( @xcite ) derived a more general formula enumerating the factorizations of a permutation into an arbitrary number of permutations with a given number of cycles .",
    "both works rely on character theoretical techniques and leave little room for combinatorial interpretation .",
    "the first combinatorial proof of the harer - zagier formula was given recently by lass in @xcite .",
    "in @xcite , goulden and nica developed another combinatorial proof relying on a direct bijection .",
    "the first combinatorial approach to the case involving two general permutations was developed by goupil and schaeffer in @xcite .",
    "subsequently , schaeffer and vassilieva used a bijective method in @xcite to address the same issue .",
    "this later article relies on the direct correspondence between @xmath10-factorizations of a permutation and graphs with black and white vertices embedded in surfaces called _ bicolored maps_. our purpose is to start with a similar equivalence to solve the @xmath11-factor case by means of a combinatorial development .",
    "while at first glance the @xmath10-factor and the @xmath11-factor cases seem to share common characteristics , a number of difficulties appear with the later case . as a result ,",
    "a new methodology involving a particular set of _ cactus trees _ is developed .",
    "the main result can be stated as follows :    [ th1 ] the numbers @xmath12 of factorizations of a long cycle @xmath13 into three permutations with @xmath14 cycles verify : @xmath15    * outline of the paper and additional notations + * the goal of this paper is to give a bijective proof of the result stated above . in the following sections , we introduce the combinatorial objects used as the basis of our construction .",
    "then we describe the bijective mapping and prove it is indeed one - to - one .",
    "+ in what follows , we note @xmath16 ( resp .",
    "@xmath17 ) the set of unordered ( resp .",
    "ordered ) subsets of set @xmath18 containing exactly @xmath19 elements .",
    "maps can be defined as @xmath20cell decompositions of an oriented surface into a finite number of vertices ( @xmath21cells ) , edges ( @xmath22cells ) and faces ( @xmath20cells ) homeomorphic to open discs ( see @xcite for more details about maps and their applications ) .",
    "they are defined up to an homeomorphism of the surface that preserves its orientation , the type of cells and incidences in the graph .",
    "a map is bicolored if the vertices are colored black and white such that two adjacent vertices have different colors . bicolored maps are also known as _",
    "hypermaps_. + while @xmath10-factorizations of a permutation are easily interpreted as bicolored maps , @xmath23-factorizations ( @xmath24 ) can be represented as _ @xmath23-constellations _ ( see @xcite ) . within a topological point of view , @xmath23-constellations are specific maps with black and white faces such that all the black faces are @xmath23-gons and not adjacent to each other .",
    "the degree of the white faces is a multiple of @xmath23 . often ( see @xcite ) ,",
    "constellations are supposed to be planar maps ( embedded in a surface of genus @xmath25 ) . in this paper",
    "we suppose that they can be embedded in a surface of any genus .",
    "besides , we consider only _ rooted _ constellations , i.e. constellations with a marked edge .",
    "we assume as well that within each @xmath23-gon the @xmath23 vertices are colored with @xmath23 distinct colors so that moving around the @xmath23-gons clockwise the vertex of color @xmath26 ( modulo @xmath23 ) follows the vertex of color @xmath27 . a constellation with only one white face",
    "is usually called a _",
    "cactus_. figure 1 shows a @xmath11-cactus embedded in the sphere ( genus @xmath25 ) and two @xmath11-cacti embedded in a surface of genus @xmath28 .    rooted @xmath23-cacti with @xmath1 black @xmath23-gons are in bijection with @xmath23-tuples of permutations @xmath4 , @xmath5 , ... , @xmath29 in @xmath0 such that @xmath30    let @xmath31 be a @xmath23-cactus with @xmath1 black faces of degree @xmath23 and one white face @xmath32 of degree @xmath33 ( as black faces have no adjacent edges , each edge belongs to exactly one black face as well as to the white face ) .",
    "we assume that the root edge links a vertex of color @xmath28 and a vertex of color @xmath23 . moving around the @xmath33 vertices of @xmath32 counter - clockwise starting with the vertex of color @xmath28 of the root edge ,",
    "the various edges connecting couples of vertices of color @xmath28 and @xmath23 are traversed exactly once .",
    "we denote @xmath34 the black face containing the @xmath35 such edge met .",
    "then , we consider the permutations @xmath36 in @xmath0 mapping @xmath27 to @xmath37 if and only if @xmath34 and @xmath38 have a vertex @xmath39 of color @xmath40 in common and @xmath38 follows @xmath34 in counter - clockwise order around @xmath39 . according to the cyclic order of the vertices colors , the permutation @xmath41 maps @xmath27 to @xmath26 ( modulo @xmath1 ) for @xmath42 .",
    "in other words , @xmath30 .",
    "+ conversely , given a @xmath23-tuple of permutations @xmath41 in @xmath0 such that @xmath30 we can define a @xmath23-cactus following the construction rules below :    * let @xmath43 , @xmath44 , ... , @xmath45 be @xmath1 @xmath23-gons whose vertices colors are @xmath28 , @xmath10 , ... , @xmath23 in clockwise order .",
    "* we use the permutations @xmath46 to merge the polygons vertices of the same color so that moving around a vertex @xmath39 of color @xmath37 counter - clockwise , @xmath47 is following @xmath48 if @xmath49 .",
    "then , starting from @xmath43 , follow the edges of the polygons linking the vertices of colors @xmath28 and @xmath23 , @xmath23 and @xmath50 , ... , @xmath10 and @xmath28 , @xmath28 and @xmath23 , etc . the edge @xmath51 linking vertices @xmath52 and @xmath53 of colors @xmath27 and @xmath54 follows the edge @xmath55 linking @xmath39 of color @xmath26 and @xmath52 if @xmath51 follows @xmath55 in counter - clockwise order around @xmath52 .",
    "as @xmath30 , we traverse all the @xmath47 and come back to @xmath43 . this traversal defines the edges of the unique white face of degree @xmath56 .",
    "[ cacspher ]            the cactus on the left hand side of figure 1 can be associated to the three permutations @xmath57 .",
    "the cactus in the middle in figure 1 can be associated to the three permutations @xmath58 .",
    "the cactus on the right hand side corresponds to the three permutations @xmath59 .",
    "as non recursive and non planar objects , cacti are very difficult to compute directly and so far no direct method to enumerate general sets of cacti with given numbers of vertices of each color has been found . to overcome this issue",
    ", we introduce a new set of objects we named _ partitioned cacti_.",
    "as shown below , there exists a simple relation between the cardinalities of sets of partitioned cacti and sets of traditional cacti .",
    "the point of this paper is to show that partitioned cacti can be interpreted via a bijective mapping as cactus trees and some simple combinatorial objects ( permutations , ordered and unordered subsets of @xmath60 $ ] ) .",
    "being planar and recursive , cactus trees can be computed using the lagrange theorem for implicit functions . formally , we have the following definition : +    let @xmath61 be the set of @xmath62-tuples @xmath63 such that @xmath64,@xmath65 and @xmath66 are partitions of @xmath67 $ ] into @xmath68 , @xmath69 and @xmath70 blocks and @xmath71 , @xmath72 are permutations of @xmath73 such that each block of @xmath64 ( resp .",
    "@xmath65 , @xmath66 ) is the union of cycles of @xmath71 ( resp .",
    "@xmath72 , @xmath74 ) any such @xmath62-uple is called a _ partitioned @xmath11-cactus _ with @xmath1 triangles , @xmath68 white , @xmath69 black and @xmath70 grey blocks .",
    "[ ex : pc1 ] as an example , we add partitions @xmath75 , @xmath76 , where @xmath77 , to the cactus of figure 1 in order to get the partitioned cactus @xmath78 depicted on figure  [ fig : ex ] .",
    "similarly to @xcite , we associate a particular shape to each of the blocks of the partitions .",
    "* link with cacti * + partitioned @xmath11-cacti and @xmath11-cacti are linked through the following formula : @xmath79 where @xmath80 , the stirling number of the second kind , gives the number of partitions of a set of @xmath81 elements into @xmath82 nonempty , unordered sets .",
    "using @xmath83 @xmath84 ( see e.g  @xcite ) where the falling factorial @xmath85 : @xmath86 in order to prove our main theorem , we focus on a bijective description of partitioned cacti .",
    "as stated above , our construction relies on a particular set of cactus trees described afterwards in this section .",
    "we introduce the notion of white , black and grey traversals of a partitioned 3-cacti , a critical tool for the bijection . moving around the white face of the cactus according to the surface orientation and starting with the white to grey edge of the root , we define three new labelings of the triangles .",
    "we assign `` white '' ( resp .",
    "`` black '' , `` grey '' ) label @xmath27 ( resp .",
    "@xmath37 , @xmath40 ) to the triangle containing the @xmath27th ( resp .",
    "@xmath37th , @xmath40th ) edge linking a white and a grey ( resp .",
    "a black and a white , a grey and a black ) vertex .",
    "this three labeling of the faces will be called respectively white , black and grey traversal labeling .",
    "[ wbgt ] it can be shown that if @xmath27 is the initial label of a triangle , @xmath27 is as well its white traversal label , @xmath87 and @xmath88 are respectively its black and grey traversal labels .",
    "figure [ wbgtraversals ] depicts these three traversals for the partitioned cactus in example [ ex : pc1 ] .",
    "moreover , we define for any block of @xmath89 ( resp .",
    "@xmath90 , @xmath91 ) , a _ last passage _ white ( resp .",
    "black , grey ) vertex .",
    "let @xmath92 , @xmath93 and @xmath94 be the blocks of the partitions @xmath64 , @xmath65 and @xmath66 respectively , where the indexing of the blocks is subject only to the condition that @xmath95 . the last passage white ( resp .",
    "black , grey ) vertex of block @xmath96 ( resp .",
    "@xmath97 , @xmath98 ) is the one belonging to the triangle with maximum white ( resp .",
    "black , grey ) traversal label .",
    "as an immediate consequence of lemma [ wbgt ] , the ( initial ) indices of the triangles containing the last passage vertex of blocks @xmath96 , @xmath97 and @xmath98 are respectively : @xmath99 in what follows , we denote by @xmath100 the maximal element of @xmath101 ( @xmath102 ) , by @xmath103 the maximal element of the set @xmath104 for @xmath105 ( equal to @xmath106 as @xmath90 is stable by @xmath5 ) ] and by @xmath107 the maximal element of @xmath108 for @xmath109 .",
    "the initial indices of the last passage vertices in example [ ex : pc1 ] are 3 and 5 ( white blocks ) , 5 and 1 ( black blocks ) , 3 and 1 ( grey blocks ) .",
    "figure [ blast ] shows how the last passage black vertex of the block represented by the circle is identified .",
    ", width=188 ]      we focus on particular 3-colored cactus trees with two kinds of polygons : triangles and usual edges .",
    "more specifically we consider the sets @xmath110 of rooted cactus trees with @xmath111 white vertices , @xmath112 black vertices , @xmath113 grey vertices , @xmath81 triangles rooted in a grey vertex , @xmath82 triangles rooted in a white vertex , @xmath114 triangles rooted in a black vertex such that :    * the root of the cactus tree is a white vertex * a white vertex has black descending vertices and/or descending triangles rooted in this white vertex * a black vertex has grey descending vertices and/or descending triangles rooted in this black vertex * a grey vertex has white descending vertices and/or descending triangles rooted in this grey vertex * triangles are composed of a white , a black and a grey vertex .",
    "moving around triangles clockwise , these vertices are following each other in the white - black - grey - white cyclic order .",
    "as a direct consequence , triangles can be seen as adding a `` non - tree '' edge linking a vertex and the rightmost descendant of one of its descendants .",
    "note that edges can not intersect triangles .",
    "[ ex : ex ] figure [ fig : ex ct ] shows an example of a cactus tree of @xmath115 ,        the cardinality of the considered set of cactus trees is : [ l : ct ] @xmath116    the proof is postponed until appendix [ proof ]",
    "in this section we construct a bijective mapping @xmath117 .",
    "let @xmath118 be a partitioned @xmath119cactus",
    ". then we associate to it by @xmath117 a 7-tuple @xmath120 composed of    * an ordered cactus tree @xmath121 for a given triple @xmath122 , * unordered sets @xmath123)$ ] , @xmath124)$ ] , @xmath125)$ ] , * an ordered set @xmath126)$ ] such that @xmath127 * and permutations @xmath128 , @xmath129 .",
    "the remaining of the section is devoted to detailed description of these objects and of how each of them is obtained from initial partitioned @xmath119cactus .",
    "+      * labeled @xmath11-colored tree * + first we build the last passage @xmath11-colored labeled tree @xmath130 with @xmath68 white , @xmath69 black and @xmath70 grey vertices associated to the blocks of @xmath89 , @xmath90 and @xmath91 such that white vertex @xmath111 associated with block @xmath131 is the root and ascendant / descendant relations are defined by the last passage vertices as follows .",
    "black vertex @xmath37 associated to block @xmath97 is the descendants of white vertex @xmath27 associated to block @xmath96 if the last passage vertex of block @xmath97 belongs to the same triangle in the partitioned cactus as a white vertex of block @xmath96 .",
    "if two black vertices @xmath132 and @xmath133 are descendant of the same white vertex @xmath27 , then @xmath132 is on the left of @xmath133 if the white traversal label of the triangle containing the last passage vertex of @xmath134 is less than the one of @xmath135 .",
    "similar rules apply to define the grey descendants of a black vertex and the white descendants of a grey vertex .",
    "figure [ 2grey ] illustrates the identification of the two grey descendants of the black vertex associated with a circle in example [ ex : pc1 ] , as well as their order .        more formally :    * @xmath136 is the ordered set of black descendants of white vertex @xmath27 if @xmath137 and @xmath138 for @xmath139 .",
    "* @xmath140 is the ordered set of grey descendants of black vertex @xmath37 if @xmath141 and + @xmath142 for @xmath139 .",
    "* @xmath143 ( @xmath144 ) is the ordered set of white descendants of grey vertex @xmath40 if @xmath145 and @xmath146 for @xmath139 .",
    "the labeled @xmath11-colored tree @xmath130 is correctly defined .",
    "assume non root white vertex @xmath147 is a descendant of grey vertex @xmath40 , that is in its turn a descendant of black vertex @xmath37 .",
    "suppose now that @xmath37 is a descendant of white vertex @xmath148 .",
    "following our construction rules , we have @xmath149 , so that @xmath150",
    ". then @xmath151 as @xmath152(@xmath90 is stable by @xmath5 ) . finally , as @xmath153 , @xmath154 and @xmath155 .",
    "two cases can occur :    * @xmath156 then @xmath157 . as a direct consequence , @xmath158 * @xmath159 and @xmath160 . as a direct consequence",
    ", @xmath148 is the root vertex .    using a similar argument",
    ", one can show that if black vertex @xmath132 ( resp .",
    "grey vertex @xmath161 ) is on a descending branch of black vertex @xmath133 ( resp .",
    "grey vertex @xmath162 ) , then @xmath163 ( resp .",
    "@xmath164 ) . consequently , the white , black and grey vertices labels on each branch of the graph are strictly increasing and the last vertex of the branch is always the root vertex ( the block containing @xmath28 ) .",
    "* cactus tree * + remove the labels from @xmath130 to obtain the _ @xmath11-colored ordered tree _",
    "next step is to construct the @xmath11-colored cactus tree @xmath166 . to that purpose",
    "we draw a `` non - tree '' edge between the rightmost descendant and the ascendant of a _ non root _",
    "vertex @xmath39 whenever the last passage vertices associated to @xmath39 and its rightmost descendant belong to the same triangle within the partitioned cactus .",
    "clearly , this last condition can only be verified by the rightmost descendant . indeed",
    ", last passage vertices associated with other descendants belong to triangles with strictly lower indices with respect to the traversal of the color of @xmath39 .",
    "this case happens for instance for the square and circle blocks on figure  [ triangle ] .",
    "more formally , we have :        * a triangle rooted in a grey vertex when : @xmath167 * a triangle rooted in a white vertex when : @xmath168 * a triangle rooted in a black vertex when : @xmath169    [ ex : t&ct ] let us now apply the full procedure to example  [ ex : pc1 ] . since @xmath170 ,",
    "the black circle @xmath28 is a descendant of the root triangle @xmath10 . as @xmath171 and @xmath172 , the grey rhombus @xmath28 and the grey square @xmath10 are both descendants of the black circle @xmath28",
    "moreover , since @xmath173 the grey rhombus @xmath28 is to the left of the grey square @xmath10 .",
    "the white hexagon @xmath28 is a descendant of the grey square @xmath10 since @xmath174 and the black pentagon @xmath10 is in its turn a descendant of the white hexagon @xmath28 as @xmath175 .",
    "this is how we construct the tree @xmath130 .",
    "then by removing the labels and shapes from @xmath130 we get the tree @xmath165 . as @xmath176",
    "we create a triangle rooted in the root vertex of @xmath165 connecting the root vertex of @xmath165 with its right grey vertex and , as @xmath177 , we construct a triangle rooted in this grey vertex connecting it with the top black vertex of @xmath165 .",
    "finally , we obtain the cactus tree @xmath166 from the tree @xmath165 ( see figure  [ fig : t&ct ] ) .    from now to the end of this section",
    ", we will denote by @xmath81 the number of triangles rooted in grey vertices , by @xmath82 the number of triangles rooted in white vertices and by @xmath114 the number of triangles rooted in black vertices .",
    ", tree @xmath165 and cactus tree @xmath166,width=188 ]      * relabeled support sets * + _ ( i ) _ _ relabeling permutations . _ + using a similar approach as in @xcite , we construct three relabeling permutations @xmath178 . first we consider the _ reverse - labelled _",
    "tree @xmath179 resulting from the labelling of @xmath165 , based on three independant reverse - labelling procedures for white , black and grey vertices .",
    "the root is labelled @xmath111 , the white vertices at level @xmath180 are labeled from right to left , beginning with @xmath181 , proceeding by labelling from right to left white vertices at level @xmath182 and all the other white levels until reaching the leftmost white vertex at the top white level labelled by @xmath28 .",
    "we proceed in the same way to label black and grey vertices .",
    "next step consists in relabeling the blocks ( white , black and grey ) by using the new indices from @xmath179 .",
    "if a white vertex is labeled @xmath27 in @xmath130 and @xmath183 in @xmath179 , we note @xmath184 .",
    "black and grey blocks are relabeled in the similar way .",
    "let @xmath185 , @xmath186 , @xmath187 be the strings given by writing the elements of @xmath188 , @xmath189 , @xmath190 in increasing order .",
    "denote @xmath191 , @xmath192 , @xmath193 , concatenations of the strings defined above .",
    "we define @xmath194 by setting @xmath195 the first line and @xmath60 $ ] the second line of the two - line representation of this permutation .",
    "similarly , we define @xmath196 and @xmath197 . + _",
    "( ii)__support sets _ + now we define the unordered set @xmath198 $ ] of size @xmath199 as @xmath200 the set @xmath201 $ ] of size @xmath202 as @xmath203 the set @xmath204 $ ] of size @xmath205 as @xmath206 ( note that @xmath1 is * always * in @xmath207 and @xmath208 as @xmath209 ) +    [ ex : relabeling ] let us go back to our example  [ ex : t&ct ] and construct relabeling permutations and support sets . using a reverse labeling of trees @xmath130 we can set : @xmath210 then the strings @xmath185 , @xmath186 and @xmath187 are defined by : @xmath211 let us construct the relabeling permutations @xmath212 , @xmath213 and @xmath214 :    @xmath215 then relabeled support sets are defined by : @xmath216 relabeling permutations and support sets are pictured on figure [ figu : label ] .        * relabeled ordered support complement set . *",
    "+ we define an ordered set @xmath217 of size @xmath218 .",
    "the relation @xmath127 is clearly verified .",
    "+    [ ex : chi ] the support complement set @xmath219 for our previous example  [ ex : relabeling ] is @xmath220 .",
    "it is represented on figure [ figu : label ] .    * permutations * + we need two additional objects to end our construction .",
    "we proceed in two steps .",
    "+ _ ( i ) partial permutations _ + first we define the sets @xmath221 \\setminus \\lambda_1\\{m_{1}^{i } , \\alpha_{3}(m_{3}^{k } ) \\mid 1\\leq i\\leq p_{1}-1,\\,1\\leq k \\leq p_{3}\\}$ ] and @xmath222 \\setminus \\lambda_1\\{\\alpha_{2}\\circ \\alpha_{3}(m_{2}^{'j } ) , \\alpha_{3}(m_{3}^{k } ) \\mid 1\\leq j\\leq p_{2},\\,1\\leq k \\leq p_{3}\\}$ ] .",
    "we construct partial permutations @xmath223 and @xmath224 defined respectively on @xmath225 and @xmath226 in the following way : @xmath227 \\setminus s_1 \\\\ \\nonumber u\\phantom{an } \\ ; & \\longmapsto & \\;\\lambda_3\\circ\\alpha_3^{-1}\\circ\\lambda_1^{-1}(u)\\\\ \\nonumber \\phantom{\\widetilde{\\sigma_2 } : } \\phantom{lalalalaal }   \\phantom{e } \\phantom{an}\\\\ \\nonumber \\widetilde{\\sigma_2 } : \\phantom{lalalalaal }   e_2 \\phantom{an } & \\longrightarrow & [ n ] \\setminus s_2 \\\\ \\nonumber u\\phantom{an } \\ ; & \\longmapsto & \\;\\lambda_2\\circ\\alpha_3^{-1}\\circ\\alpha_2^{-1}\\circ\\lambda_1^{-1}(u)\\end{aligned}\\ ] ]    _ ( ii ) permutations _",
    "+ for the second step , we define the ordered set @xmath228 with all the elements of @xmath225 sorted in increasing order and @xmath229 the labeling function which associates to each element of @xmath225 its position index in @xmath228 . as a direct consequence , we have @xmath230 $ ] .",
    "similarly we define @xmath231 to label the elements of @xmath226 , @xmath232 to label the elements of @xmath60 \\setminus s_1 $ ] and @xmath233 to label the elements of @xmath60 \\setminus s_2 $ ] .",
    "we can now state the definition of permutations @xmath234 and @xmath235 as : @xmath236 }   [ n - p_1 + 1-p_3+c ] \\phantom{an } & \\longrightarrow & [ n - p_1 + 1-p_3+c ] \\\\",
    "\\nonumber u\\phantom{an } \\ ; & \\longmapsto & \\ ; \\rho_3\\circ\\widetilde{\\sigma_1}\\circ\\rho_1^{-1}(u)\\\\ \\nonumber \\phantom{\\widetilde{\\sigma_2 } : } \\phantom{lalalalaal }   \\phantom{e } \\phantom{an}\\\\ \\nonumber { \\sigma_2 } : \\phantom{[p_1 + 1-c ] }    [ n - p_2 - p_3+b ] \\phantom{an } & \\longrightarrow & [ n - p_2 - p_3+b ] \\\\",
    "\\nonumber u\\phantom{an } \\ ; & \\longmapsto & \\;\\rho_4\\circ\\widetilde{\\sigma_2}\\circ\\rho_2^{-1}(u)\\end{aligned}\\ ] ]    [ ex : permutations ] let us continue the previous example  [ ex : chi ] .",
    "the sets @xmath237 and @xmath238 are equal to @xmath239\\setminus \\{1 , 3\\ } = \\{2 , 4\\ } , e_{2}= [ 4]\\setminus \\{1 , 3\\ } = \\{2 , 4\\ } $ ] . then the partial permutations @xmath240 and @xmath241 and the permutations @xmath242 and @xmath243 ( see figure [ figu : label ] ) are :    @xmath244",
    "let @xmath245 be the set of 7-uple as defined in the previous section .",
    "we have : @xmath246 ) \\right .",
    "\\\\ \\nonumber & &   \\times p_{p_1 - 1 + p_3 - 1- c}([n -1 ] ) \\times p_{p_3 + p_2 - 1- b}([n - 1 ] ) \\\\",
    "\\nonumber & & \\left .",
    "\\times op_{p_3 - b - c}([n])\\times \\sigma_{n - p_1 + 1- p_3 + c}\\times \\sigma_{n - p_2 - p_3 + b } \\mid s_0 \\cap \\chi = \\emptyset \\right \\}\\end{aligned}\\ ] ] we prove our main theorem by showing :    the mapping @xmath247 defined by : [ th2 ] @xmath248 is actually a bijection .",
    "the proof of this theorem is detailed in the next section .",
    "theorem [ th1 ] is a direct consequence of theorem [ th2 ] .",
    "indeed , we have the following lemma :    the cardinality of the image set of @xmath247 verifies : [ l : imth ] @xmath249    cardinality of @xmath250 has already been stated in lemma [ l : ct ] .",
    "the numbers of ways to choose the unordered subsets @xmath251 , @xmath252 and @xmath253 are defined by binomial coefficients @xmath254 ( respectively ) .",
    "then , since @xmath127 , the number of ways to choose @xmath219 is equal to @xmath255 the number of permutations @xmath256 is equal to @xmath257 + combining everything and summing over @xmath122 gives : @xmath258 equation ( [ ee ] ) leaves room for a lot of simplifications on the binomial coefficients : @xmath259 where the last element on the right hand side of the equation is a multinomial coefficient .",
    "the computation is conducted to the final result by arranging properly the terms depending on @xmath82 and @xmath114 , and summing over these two parameters with the help of vandermonde s convolution",
    ".    the formula above can be symmetrized by noticing that @xmath260 and doing : @xmath261 furthermore : @xmath262\\\\ & & \\times\\binomial{n}{a , b , c , p_1 - 1-a - c , p_2-a - b , p_3-b - c}\\\\   & & =   \\sum_{a , b , c}n(n - a)\\binomial{n-1}{a , b , c , p_1 - 1-a - c , p_2 - 1-a - b , p_3 - 1-b - c}\\end{aligned}\\ ] ] putting everything together , we have : @xmath263 this symmetric version is a direct consequence of jackson s formula in @xcite .",
    "* injectivity * + for the first step of the proof we focus on injectivity of @xmath247 .",
    "let @xmath120 be the image by @xmath247 of @xmath118 .",
    "our aim is to show that @xmath63 is uniquely determined by @xmath120 .",
    "we proceed in the following way .",
    "+ first we note that @xmath264 and @xmath166 determines @xmath265 since @xmath264 gives the set of values of all these elements ( by construction ) and @xmath166 gives the relations of order on them ( including equalities ) . indeed , according to the construction of @xmath166 and @xmath266 , the @xmath267 s are sorted in increasing order with respect to the reverse label order in @xmath166 , the @xmath268 s associated with black vertices descending from the same white vertex are sorted in increasing order from left to right .",
    "assume the @xmath269th black vertex in the reverse labeling of @xmath166 is the descendant of the @xmath35 white vertex .",
    "necessarily @xmath270 . as a consequence",
    "we have one of the following three cases : @xmath271 @xmath272 or @xmath273 if the @xmath269th black vertex and the @xmath183th white vertex belong to the same triangle rooted in grey vertex . +",
    "similarly the sets @xmath274 and @xmath275 are uniquely determined .",
    "+ looking at the triangles rooted in a white or a black vertex within @xmath166 we can determine @xmath276 .",
    "the complementary ordered set @xmath219 uniquely determines the @xmath277 .",
    "assume @xmath120 is given by figure [ ex rec ] .",
    "following the construction rules stated above , we have necessarily :    * @xmath278 since the first black and first white vertices of the cactus tree belong to the same triangle and @xmath28 is the smallest in @xmath264 * @xmath279 * @xmath280 , @xmath281 and @xmath282 * @xmath283 , @xmath284 , @xmath285 and @xmath286 * @xmath287 , @xmath288    the following step is to notice that elements reconstructed so far uniquely determine the supports of the partial permutations @xmath223 and @xmath224 and the partial permutations themselves . then we define extensions @xmath289 and @xmath290 of @xmath223 and @xmath224 on the whole set @xmath60 $ ] by setting @xmath291 if @xmath27 belongs to the support of @xmath223 , and @xmath292 otherwise ( we have a similar construction for @xmath293 ) . now the partition @xmath294 is uniquely determined as well since @xmath295 $ ] , @xmath296\\setminus[\\lambda_1(m_{1}^{i-1 } ) ] \\mbox { for } 2\\leq i\\leq p_1 $ ] .",
    "similar reconstruction applies to @xmath297 and @xmath298 . by applying @xmath299 ( resp .",
    "@xmath300 ) to @xmath298 ( resp .",
    "@xmath297 ) we determine uniquely @xmath301 ( resp .",
    "@xmath302 ) .",
    "following example [ recons ] , we find that the domain of @xmath223 is @xmath303\\setminus\\{1,2,3\\ } = \\{4\\}$ ] .",
    "its range is @xmath304\\setminus\\{2,3\\ } = \\{1\\}$ ] .",
    "the construction of @xmath305 and @xmath306 yields : @xmath307 as a next step , we have : @xmath308    figure [ bb ] depicts the resulting partitioned cactus",
    ".        then we show by induction that the relabeling permutations @xmath266 , @xmath196 , @xmath197 are uniquely determined . the element @xmath309 is uniquely determined as the minimum element of @xmath310 .",
    "assume that @xmath311 , @xmath312 and @xmath313 have been uniquely determined for @xmath314 for a given @xmath315 .",
    "as @xmath197 is an increasing function on the blocks of @xmath91 , the element @xmath316 is necessarily the minimal ( not yet attributed within the procedure ) element of @xmath317 , where @xmath318 is the index of the grey block such that @xmath319 .",
    "hence @xmath316 is uniquely determined .",
    "we proceed by computing @xmath320",
    ". then we identify @xmath321 as being the minimal ( not yet attributed within the procedure ) element of @xmath322 where @xmath323 is the index of the black block such that @xmath324 .",
    "we compute @xmath325 .",
    "then we identify @xmath326 as being the minimal ( not yet attributed within the procedure ) element of @xmath327 where @xmath328 is the index of the white block such that @xmath329 .",
    "( for @xmath89 is stable by @xmath4 , the element @xmath330 belongs to the same white block as @xmath331 and @xmath326 is uniquely determined . ) finally , @xmath332 and @xmath333 are uniquely determined .",
    "proceeding with our example , we find that the smallest integer of @xmath334 is equal @xmath10 and as a consequence @xmath335 .",
    "as @xmath10 belongs to @xmath336 and the smallest ( not yet attributed ) element of @xmath337 is @xmath28 , we have @xmath338 . then , @xmath339 and looking at @xmath302 , we get @xmath340 .",
    "we compute @xmath341 .",
    "the minimal not yet attributed element of the block of @xmath294 containing @xmath10 is equal to @xmath11 . as a result",
    "we obtain @xmath342 .",
    "the full reconstruction yields @xmath343 , @xmath344 , @xmath345 .    as a direct consequence , the partitioned cactus is uniquely determined since @xmath346    we have @xmath347 , @xmath348 , @xmath349 @xmath350 and @xmath351 , @xmath352    * surjectivity * + the final step of this proof is to show that @xmath353 is a surjection .",
    "let @xmath120 be any 7-uple of @xmath245 .",
    "provided that @xmath127 we can always define the partitions @xmath294 , @xmath354 and @xmath298 and the permutations @xmath355 and @xmath293 according to the reconstruction procedure we pointed out in the previous subsection . as a direct consequence , we can always define @xmath302 and @xmath301 using that @xmath356 and @xmath357 . to prove surjectivity of @xmath247 we need to show that the iterative reconstruction of @xmath266 , @xmath196",
    ", @xmath197 defined in the injectivity proof can always be fulfilled and always gives valid objects as an output .",
    "the main difficulty lies in the boundary condition .",
    "first of all let us remark that we can always define @xmath309 as the minimal element of @xmath310 .",
    "suppose now that we were able to reconstruct @xmath311 for @xmath358 with @xmath359 , as well as @xmath360 and @xmath361 for @xmath362 . we would not be able to reconstruct @xmath363 if and only if all the elements of @xmath364 such that @xmath365 have already been allocated during the procedure .",
    "clearly it would mean that @xmath366 different elements would belong to the set @xmath367 that is an obvious contradiction .",
    "the impossibility of reconstructing @xmath368 would be equivalent to the fact that all the elements of @xmath369 with @xmath370 have already been allocated .",
    "since @xmath355 is a bijection , this leads to a similar contradiction .",
    "same argument applies to reconstruction of @xmath371 if @xmath372 with @xmath373 . if @xmath374 we can only tell that @xmath375 different integers belongs to @xmath376 since @xmath309 was not constructed in the same way as the other @xmath311 . however according to our construction ,",
    "if the black vertex in @xmath166 corresponding to a given block @xmath377 is the direct descendant of the white vertex associated with @xmath378 then @xmath379 .",
    "hence , if all the elements of @xmath380 have been used for the reconstruction process , the maximum elements ( and therefore all the elements ) of all the blocks @xmath381 corresponding to descending vertices of the white vertex associated with @xmath380 have been used during this process .",
    "similarly we can show that for any vertex of any color , if all of the elements of the corresponding block have been used during the reconstruction process , all the elements of the block corresponding to descending vertices have been used for the reconstruction process .",
    "since @xmath382 is associated with the root of the cactus tree @xmath166 , if all the elements of @xmath376 have been used for the reconstruction process , it means that all the elements of all the blocks have been used as well . as a conclusion we state that the reconstruction process came to its expected end and @xmath383 which is a contradiction with our hypothesis .",
    "+ for the final step , let us show that the reconstructed objects are valid 5-tuples of @xmath384 , i.e. that the stability conditions of the partitions by the permutation are respected .",
    "if we have @xmath385 , then according to our procedure @xmath386 for @xmath387 . besides , we showed that @xmath388 with @xmath389 .",
    "hence , for all @xmath390 , elements @xmath390 and @xmath391 belong to the same block of @xmath89 and @xmath89 is stable by @xmath392 or , equivalently , by @xmath4 .",
    "similarly , if @xmath393 , i.e. @xmath394 , then @xmath395 . as a result , @xmath90 is stable by @xmath396 .",
    "trivially , @xmath91 is stable by @xmath397 since @xmath398 according to our definition .",
    "enumeration of cactus trees can be easily performed as they are recursive objects and can be decomposed in ( i ) the white root , ( ii ) the cactus trees rooted in a black vertex descending from the root , ( iii ) a triple composed of a black rooted cactus tree , a grey rooted cactus tree , a triangle for each triangle descending from the root , ( iv ) the positions of the triangles in the descendant list . as an example the cactus tree in figure [ fig : ex ct ] is decomposed on figure [ fig : decomplagrange ] .",
    "similarly we define , @xmath400 ( resp .",
    "@xmath401 ) , the generating function of the black rooted cactus trees ( resp .",
    "grey rooted ) .",
    "finally , we denote @xmath402 ( resp .",
    "@xmath403 , @xmath404 ) the generating function of a grey rooted triangle ( resp .",
    "white , black ) . obviously @xmath405 and using the previous decomposition",
    ", we have : @xmath406 where * i * is an integer vector indicating the positions of the @xmath37 triangles among the @xmath40 descendants from the root .",
    "going ahead gives : @xmath407 similarly , @xmath408 as a direct consequence , the generating functions @xmath409 are solutions of a functional equation of the type @xmath410 , where @xmath411 and @xmath412 with @xmath413 for @xmath414 .",
    "+ using the multivariate lagrange formula for monomials ( see @xcite ) , we find : @xmath415\\phi_i^{k_i } \\label{eq lagrange}\\end{aligned}\\ ] ] where @xmath416 and the sum is over all @xmath417 integer matrices @xmath418 such that      looking for zero contribution terms in expression ( [ eq lagrange ] ) , we notice that @xmath401 and @xmath403 have necessarily the same degree in the formal power series expansion of @xmath427 ( see equation ( [ eq w ] ) ) .",
    "hence , a non zero contribution of @xmath428\\phi_1^{k_1}$ ] implies @xmath429 .",
    "similar remarks gives non zero contributions only for @xmath430 and @xmath431 . as a result only one matrix @xmath432 yields a non zero contribution .",
    "+ for this particular @xmath432 , @xmath433 .",
    "then notice that : @xmath434 as a result , the coefficient in @xmath435 is equal to @xmath436 .",
    "using the same argument we have : @xmath437\\phi_2^{p_2 } & = & \\binomial{p_2+p_3 - 1-b}{p_2 - 1,\\,\\,p_3-b - c}\\\\ \\left [ w^{\\mu_{31}}b^{\\mu_{32}}g^{\\mu_{33}}t_1^{\\mu_{34}}t_2^{\\mu_{35}}t_3^{\\mu_{36}}\\right ] \\phi_3^{p_3 } & = & \\binomial{p_1+p_3 - 2-c}{p_3 - 1,\\,\\,p_1 - 1-a - c}\\end{aligned}\\ ] ] putting everything together yields the desired result .",
    "aa , _ the euler characteristic of the moduli space of curves _ , inventiones mathematicae , * 85 * , 457486 , 1986 , _ some combinatorial problems associated with products of conjugacy classes of the symmetric group _ , j. combinatorial theory ( a ) * 49 * , 363369 , 1988    , _ dmonstration combinatoire de la formule de harer - zagier _ , c. r. acad .",
    "paris , * 333 * , srie i , 155160 , 2001 , _ a direct bijection for the harer - zagier formula _ , j. combinatorial theory ( a ) * 111 * , 224238 , 2005 , _ factoring n - cycles and counting maps of given genus _ , europ",
    ". j. combinatorics , * 19(7 ) * , 819 - 834 , 1998 , _ a bijective proof of jackson s formula for the number of factorizations of a cycle _ , j. combinatorial theory series a , * 115(6 ) * , 903924 , 2008 , _",
    "graphs on surfaces and their applications _ , encyclopaedia of mathematical sciences * 141 * , springer - verlag , berlin , 2004 with an appendix by d.b .",
    "zagier , _ enumeration of planar constellations _ , advances in applied mathematics , * 24 * , 337368 , 2000 , _ constructive combinatorics _ , springer - verlag , new york , 1986 , _ combinatorial enumeration _ , wyley interscience series in discrete math , new york , 1983 , _ maps , hypermaps and their automorphisms : a survey i , ii , iii _ , expositiones math .",
    ", * 10 * , 403427 , 429447 , 449467 , 1992 , _ conjugaison darbres et cartes combinatoires alatoires _ , ph.d",
    ". thesis , luniversit bordeaux i , 1998"
  ],
  "abstract_text": [
    "<S> this paper is dedicated to the factorizations of the symmetric group . introducing a new bijection for partitioned 3-cacti </S>",
    "<S> , we derive an elegant formula for the number of factorizations of a long cycle into a product of three permutations . as the most salient aspect </S>",
    "<S> , our construction provides the first purely combinatorial computation of this number . </S>"
  ]
}