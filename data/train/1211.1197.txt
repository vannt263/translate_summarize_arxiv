{
  "article_text": [
    "suppose that we observe a vector @xmath0 in @xmath1 such that @xmath2 for independent standard normal random variables @xmath3 and an unknown vector of means @xmath4 .",
    "we are interested in bayesian inference on @xmath5 , in the situation that this vector is possibly _",
    "sparse_.    non - bayesian approaches to this problem have recently been considered by many authors .",
    "golubev  @xcite obtained results for model selection methods and threshold estimators for the mean - squared risk .",
    "birg and massart  @xcite treated the model within their general context of model selection by penalized least squares .",
    "abramovich et al .",
    "@xcite studied the performance of the false discovery rate method .",
    "the earlier work by donoho and johnstone  @xcite can be viewed as studying the problem within an @xmath6 context .",
    "many authors ( see , e.g. ,  @xcite and references cited there ) have investigated the connection to the lasso or similar methods .",
    "methods with a bayesian connection were studied by george and foster  @xcite , zhang  @xcite , johnstone and silverman @xcite , abramovich , grinshtein and pensky @xcite and jiang and zhang  @xcite .",
    "george and foster @xcite and johnstone and silverman  @xcite considered an empirical bayes method , consisting of modeling the parameters @xmath7 a priori as independently drawn from a mixture of a dirac measure at @xmath8 and a continuous distribution , determining an appropriate mixing weight by the method of ( restricted ) marginal maximum likelihood and finally employing the posterior median or mean .",
    "the second paper  @xcite motivated penalties , applied in a penalized minimum contrast scheme , by prior distributions on the parameters , and derived estimators for the number of nonzero @xmath9 and the @xmath9 , itself .",
    "the first is a posterior mode , but the estimator for @xmath10 , called `` bayesian testimation , '' does not seem itself bayesian .",
    "( in fact , the gaussian prior for the nonzero parameters in  @xcite will be seen to perform suboptimally in our fully bayesian set - up . )",
    "zhang  @xcite and jiang and zhang  @xcite obtain sharp results on ( nonparametric ) empirical bayes estimators .",
    "other related papers include @xcite .",
    "a penalized minimum contrast estimator can often be viewed as the mode of the posterior distribution , and it is helpful to interpret penalties accordingly . however , the bayesian approach yields a full posterior distribution , which is a random probability distribution on the parameter space .",
    "it has both a location and a spread , and can be marginalized to give posterior distributions for any functions of the parameter vector of interest .",
    "it is this object that we study in this paper .",
    "such full bayesian inference was recently considered by scott and berger  @xcite , who discussed various aspects not covered in the present paper , but no concentration results .",
    "one example of our results is that the beta - binomial priors in @xcite , combined with moderately to heavy tailed priors on the nonzero means , yield optimal recovery .",
    "_ sparsity _ can be defined in various ways .",
    "perhaps the most natural definition is the class of _ nearly black _ vectors , defined as @xmath11 = \\bigl\\ { \\theta\\in{\\mathbb{r}}^n\\dvtx \\#(1\\le i\\le n\\dvtx{\\theta}_i \\neq0 ) \\leq p_n \\bigr\\}.\\ ] ] here @xmath12 is a given number , which in theoretical investigations is typically assumed to be @xmath13 , as @xmath14 .",
    "sparsity may also mean that many means are small , but possibly not exactly zero .",
    "definitions that make this precise use _ strong _ or _ weak @xmath15-balls _",
    ", typically for @xmath16 .",
    "these are defined as , with @xmath17}\\geq{\\theta}_{[2]}\\geq\\cdots\\geq{\\theta}_{[n]}$ ]",
    "the nonincreasing permutation of the coordinates of @xmath4 , @xmath18 & = & \\biggl\\ { \\theta\\in{\\mathbb{r}}^n\\dvtx \\frac1n\\sum_{i=1}^{n } | \\theta_i|^s \\leq\\biggl(\\frac{p_n}n \\biggr)^s \\biggr\\ } , \\\\ m_s[p_n ] & = & \\biggl\\ { \\theta\\in{\\mathbb{r}}^n\\dvtx \\frac{1}n\\max_{1\\le i\\le n } i|{\\theta}_{[i]}|^s \\leq \\biggl(\\frac{p_n}n \\biggr)^s \\biggr\\}.\\end{aligned}\\ ] ] because the nonzero coefficients in @xmath19 $ ] are not quantitatively restricted , there is no inclusion relationship between this space and the weak and strong balls , although results for the latter can be obtained by projecting them into @xmath19 $ ] . on the other hand , the inclusion @xmath20 \\subset m_s[p_n]$ ] holds for any @xmath21 .",
    "the extent of the sparsity , measured by the constant @xmath12 , is assumed unknown .",
    "our bayesian approach starts by putting a prior @xmath22 on this number , a given probability measure on the set @xmath23 .",
    "next we complete this to a prior on the set of all possible sequences @xmath4 in @xmath1 , by given a draw @xmath24 from  @xmath22 , choosing a random subset @xmath25 of cardinality @xmath24 , and choosing the corresponding coordinates @xmath26 from a density @xmath27 on @xmath28 and setting the remaining coordinates @xmath29 equal to zero . given this prior , bayes s rule yields the posterior distribution of @xmath5 , as usual .",
    "we investigate the properties of this posterior distribution , in its dependence on the priors on the dimension and on the nonzero coefficients , in the non - bayesian set - up where @xmath30 follows  ( [ eqmodel ] ) with @xmath10 equal to a fixed , `` true '' parameter @xmath31 .",
    "if the true parameter vector @xmath31 belongs to @xmath19 $ ] , then it is desirable that the posterior distribution concentrates most of its mass on nearly black vectors . one main result of the paper is that this is the case provided the prior probabilities @xmath32 decrease exponentially fast with the dimension @xmath24 .    the quality of the reconstruction of the full vector @xmath10 can be measured by various distances .",
    "a natural one is the euclidean distance , with square @xmath33 if the indices of the @xmath12 nonzero coordinates of a vector in the model @xmath19 $ ] were known a priori , then the vector could be estimated with mean square error of the order @xmath12 . in @xcite",
    "it is shown that , as @xmath34 with @xmath35 , @xmath36 } p_{n,{\\theta } } \\bigl\\|\\hat{{\\theta}}-{\\theta}\\bigr\\|^2 = 2p_n \\log(n / p_n ) \\bigl(1+o(1 ) \\bigr).\\ ] ] here the infimum is taken over all estimators @xmath37 , and @xmath38 denotes taking the expectation under the assumption that @xmath30 is @xmath39-distributed .",
    "in other words , the square minimax rate over @xmath19 $ ] is @xmath40 , meaning that the unknown identity of the nonzero means needs to lead only to a logarithmic loss .    the bayesian approach is presumably adopted for the intuition provided by prior modeling , and is not necessarily directed at attaining minimax rates .",
    "however , for theoretical investigation , it is natural to take the minimax rate as a benchmark , and it is of particular interest to know which priors yield a posterior distribution that concentrates most of its mass on balls around @xmath31 of square radius of order @xmath41 , or close relatives as @xmath42 that loose ( only ) a logarithmic factor .",
    "a second main result of the paper is that the minimax rate is attained for many combinations of priors .",
    "it suffices that the priors @xmath22 decrease exponentially with dimension , and give sufficient weight to the true level of sparsity : for some @xmath43 , @xmath44 furthermore , the priors on the nonzero coordinates should have tails that are not lighter than laplace , and satisfy a number of other technical properties .",
    "if inequality  ( [ eqlbonpin ] ) fails , then the rate of contraction may be slower than minimax ; we show that it is not slower than @xmath45 .",
    "[ the word `` contraction '' is in line with other literature on nonparametric bayesian procedures ; with the present choice of metrics ( which grow with @xmath46 ) the rates actually increase to infinity . ]    more generally , we consider reconstruction relative to the @xmath47 metric for , defined ( without @xmath48th root ) by @xmath49 for @xmath50 this `` metric '' is more sensitive to small variations in the coordinates than the square euclidean metric , which is @xmath51 .",
    "( for @xmath52 the definition gives a true metric @xmath53 ; for @xmath54 it does not . ) from  @xcite the minimax rate over @xmath19 $ ] for @xmath53 is known to be of the order @xmath55 we show that the posterior `` contraction '' rate attains this order under conditions as in the preceding paragraph , and more generally characterize the rate in terms of @xmath56 .    besides nearly black vectors , we consider rates of contraction if @xmath31 is in a weak @xmath15-ball",
    ". the minimax rate over @xmath57 $ ] relative to @xmath53 is ( see  @xcite ) @xmath58 this is shown to be also the rate of posterior contraction under slightly stronger conditions on the priors than before : the prior on dimension must decrease slightly faster than exponential . under the same conditions",
    "we also show that the posterior distribution has exponential concentration , and therefore contracts also in the stronger sense of ( any , euclidean ) moments .",
    "a summary of these results is that good priors for the dimension decrease at exponential or , perhaps better , slightly faster rate , and good priors on the nonzero means have tails that are heavier than laplace .",
    "we also show that priors with lighter tails , such as the gaussian , attain significantly lower contraction rates at true parameter vectors @xmath31 that are not close to the origin .",
    "the structure of the article is as follows . in section [ sectionmainresults ] we state the main concentration results .",
    "a practical algorithm , simulations and some pictures are presented in section [ sectionsimulations ] . proofs are gathered at the end of the paper and in the supplementary appendix  @xcite .",
    "we denote by @xmath59 and @xmath60 the minimum and maximum of two real numbers @xmath61 , and write @xmath62 if @xmath63 for a universal constant @xmath64 .",
    "the notation @xmath65 means `` equal by definition to . ''",
    "we call _ support _ of a vector @xmath66 the set of indices of nonzero coordinates , and denote this by @xmath67 .",
    "we set @xmath68 , and let @xmath69 be the cardinality of a set @xmath70 .",
    "throughout the paper we consider a prior @xmath71 on @xmath1 constructed in three steps :    a _ dimension _",
    "@xmath24 is chosen according to a prior probability measure @xmath22 on the set @xmath23 .",
    "given @xmath24 a subset @xmath72 of size @xmath73 is chosen uniformly at random from the @xmath74 subsets of size @xmath24 .",
    "given @xmath75 a vector @xmath68 is chosen from a probability distribution with lebesgue density @xmath27 on @xmath76 ( if @xmath77 ) , and this is extended to @xmath78 by setting the remaining coordinates @xmath79 equal to 0 .",
    "for simplicity we use the same density @xmath27 for every set of a given dimension @xmath69 , and will denote this also by @xmath80 .",
    "we also assume that the prior on dimension is positive , that is @xmath81 for any integer @xmath24 .",
    "given the prior @xmath71 , bayes s rule yields the _ posterior distribution _",
    "@xmath82 , the conditional distribution of @xmath10 given @xmath30 if the conditional distribution of @xmath30 given @xmath10 is taken equal to the normal distribution @xmath39 .",
    "the probability @xmath83 of a borel set @xmath84 under the posterior distribution can be written @xmath85 here @xmath86 is the vector in @xmath1 formed by adding coordinates @xmath87 to @xmath68 , at the positions left open by @xmath72 ( in the correct order of the coordinates and not at the end , as the notation suggests ) .",
    "this expression is somewhat unwieldy ; we consider computation in section  [ sectionsimulations ] .",
    "the posterior distribution is a random probability distribution on @xmath1 , which we study under the assumption that the vector @xmath88 is distributed according to a multivariate normal distribution with mean vector @xmath31 and covariance matrix the identity .",
    "we let @xmath89 denote the expected value of a function @xmath90 under this distribution",
    ".    we shall be interested in two aspects of the posterior distribution : its dimensionality and its ability to recover the mean vector @xmath10 . because the conditions are simpler in the case that the nonzero coordinates are independent under the prior , in the first two results we assume that the densities @xmath27 in ( p3 ) are of product form .",
    "concrete examples of priors as in ( p1 ) and ( p3 ) that satisfy the conditions imposed in the theorems are given in section  [ sectionexamples ] .",
    "in the context of @xmath19$]-classes , we say that the prior @xmath22 on dimension has _ exponential decrease _ if , for some constants @xmath91 and @xmath92 , @xmath93 if the condition is also satisfied with @xmath94 , we say that the prior on dimension has _ strict _ exponential decrease .",
    "[ theoremdimension ] if @xmath22 has exponential decrease  ( [ priordim ] ) and @xmath27 is a product of @xmath69 copies of a univariate density @xmath95 , with mean zero and finite second moment , then there exists @xmath96 such that , as @xmath97 , @xmath98 } p_{n,{\\theta}_0 } \\pi_n \\bigl({\\theta}\\dvtx     for reasonable priors , we may hope that the posterior distribution spreads mass in the @xmath12-dimensional subspace that supports a true mean vector @xmath99 $ ] .",
    "the theorem shows that the posterior distribution `` overshoots '' this space by subspaces of dimension at most a multiple of @xmath12 . because the overshoot can have a random direction",
    ", this does not mean that the posterior distribution concentrates overall on a fixed @xmath100-dimensional subspace .",
    "the theorem shows that it concentrates along @xmath100-dimensional coordinate planes , but its support will be far from convex .",
    "obviously the posterior distribution will concentrate on low - dimensional subspaces if the higher - dimensional spaces receive little mass under the prior @xmath22 . by the theorem , exponential decrease is sufficient .",
    "the next step is to show that exponential decrease is not too harsh : it is compatible with good reconstruction of the full mean vector @xmath10 .",
    "this then , of course , requires a lower bound on the prior mass given to the spaces of `` correct '' dimension ; for instance , see ( [ eqlbonpin ] ) .",
    "good recovery requires also appropriate prior densities @xmath27 on the nonzero coordinates . because the statistical problem of recovering @xmath10 from a @xmath101 distributed observation is equivariant in @xmath10 , we may hope that the location of the nonzero coordinates of @xmath31 does not play a role in its recovery rate .",
    "the non - bayesian procedures considered in , for instance ,  @xcite indeed fulfill this expectation .",
    "however , a bayesian procedure ( with proper priors ) necessarily favors certain regions of the parameter space .",
    "depending on the choice of priors @xmath27 in  ( p3 ) , this may lead to a shrinkage effect , even in the `` average '' recovery of the parameter as @xmath14 , yielding suboptimal behavior for true parameters @xmath31 that are far from the origin .",
    "this shrinkage effect can be prevented by choosing priors @xmath27 with sufficiently heavy tails .",
    "again we first consider the case of independent coordinates . in the following theorem",
    "we assume that @xmath27 is a product of @xmath69 densities of the form @xmath102 , for a function @xmath103 satisfying @xmath104 this covers all densities @xmath102 with a uniformly lipshitz function @xmath105 , such as the laplace and student densities .",
    "( for the student density the following theorem assumes more than 2 degrees of freedom to ensure also finiteness of the second moment . )",
    "it also covers other smooth densities with polynomial tails , and densities of the form @xmath106 for some @xmath107 $ ] , which have a function @xmath105 that is bounded in a neighborhood of the origin and uniformly lipschitz outside the neighborhood . on the other hand",
    "the standard normal density is ruled out . in theorem",
    "[ theoremlb ] we shall see that this indeed causes a shrinkage effect .    recall definition  ( [ eqdefdq ] ) of the ( square ) distance @xmath53",
    ".    [ theoremconcentrationindependent ] if @xmath22 has exponential decrease  ( [ priordim ] ) and @xmath27 is a product of @xmath69 univariate densities of the form @xmath102 with mean zero and finite second moment and @xmath105 satisfying  ( [ eqproductprior ] ) , then for any @xmath108 $ ] , for @xmath109 satisfying @xmath110 and sufficiently large @xmath111 , as @xmath112 such that @xmath113 , @xmath98 } p_{n,{\\theta}_0 } \\pi_n \\bigl({\\theta}\\dvtx d_q({\\theta},{\\theta}_0 ) > m r_n^q",
    "p_n^{1-q/2 } { |}x \\bigr ) \\to0.\\ ] ]    for @xmath114 the theorem refers to the square euclidean distance @xmath51 , and asserts that the posterior distribution contracts at the rate @xmath115 , uniformly over @xmath19 $ ] .",
    "the first inequality in ( [ eqconditionrate ] ) says that this rate is ( of course ) not faster than the minimax rate @xmath116 .",
    "the second shows that it is also limited by the amount of prior mass @xmath117 put on the true dimension . if this satisfies  ( [ eqlbonpin ] ) ,",
    "then @xmath118 and the rate @xmath115 is equal to the minimax rate .    condition  ( [ eqlbonpin ] ) for every @xmath12 leaves a free margin of a @xmath119-term over just exponential decrease of the prior @xmath22 .",
    "if the decrease is still faster than  ( [ eqlbonpin ] ) , then the rate of contraction may be slower .",
    "for instance , for @xmath120 , for some @xmath121 , the rate for the square euclidean distance given by the theorem is not better than @xmath122 , which is much bigger than @xmath123 .",
    "in contrast , for @xmath124 the theorem gives the minimax rate .",
    "for @xmath125 we can make similar remarks .",
    "the minimax rate @xmath126 over @xmath19 $ ] for @xmath53 is given in  ( [ eqdefrnq ] ) . because @xmath127 the theorem shows contraction of the posterior distribution relative to @xmath53 at the minimax rate @xmath126 over @xmath19 $ ] under the same conditions that it gives the minimax rate @xmath128 for @xmath51 : ( [ eqlbonpin ] ) suffices .",
    "furthermore , if there is less prior mass at @xmath12 , then the rate of contraction will be slower .    in the case that @xmath129",
    "the result is surprising at first when compared to the finding in  @xcite that the posterior _ median _ , or more generally so - called `` strict - thresholding rules , '' attain the convergence rate @xmath126 , but the posterior _ mean _ converges at a",
    "_ strictly slower _ rate ( even when @xmath130 ; see section 10 in  @xcite and the remark below ) . by the preceding theorem the _ full _ posterior distribution _ does _ contract at the optimal rate @xmath126 , for any @xmath131 .",
    "this is true in particular for the case of binomial priors on dimension considered in  @xcite with the `` best possible '' ( oracle ) choice @xmath132 .",
    "the slower convergence of the posterior mean relative to the contraction of the full posterior distribution is made possible by the fact that @xmath53-balls have astroid - type shapes for @xmath129 , and differ significantly from their convex hull if @xmath46 is large . the posterior mean , which is in the convex hull of the support of the posterior , can therefore be significantly farther in @xmath53-distance from @xmath31 than the bulk of the distribution . by theorem  [ theoremdimension ]",
    "only few coordinates outside the support of @xmath31 are given nonzero values by the posterior .",
    "however , the corresponding indices are random and _ on average _ spread over @xmath133 , which makes that the posterior mean at a fixed coordinate is typically nonzero . adding up all small errors in @xmath47 typically gives a much higher total sum for @xmath134 than for @xmath135 .",
    "in contrast the posterior median does not suffer from this averaging effect .",
    "the posterior measure thus provides a unifying point of view on the considered objects .",
    "in this perspective for @xmath129 the posterior mean is a bad representation of the full posterior measure .    from the arguments exposed in  @xcite , it is not hard to check that the posterior mean generally fails to attain the minimax rate over @xmath19 $ ] relative to @xmath53 for @xmath129 .",
    "let us consider the case of @xmath19 $ ] classes with @xmath130 .",
    "with the notation of @xcite , the posterior mean @xmath136 with data @xmath137 for the binomial prior on dimension with parameters @xmath138 satisfies @xmath139 , by the same reasoning as in the last display of page 1647 in @xcite ( the weight parameter @xmath140 is fixed here and equals @xmath141 ) .",
    "hence the @xmath47-power loss @xmath142 when @xmath130 is bounded from below by a constant times @xmath143 .",
    "thus , even for the `` oracle '' parameter @xmath132 , this is much above the minimax risk for any @xmath129 .",
    "the preceding theorems are also true for priors that render the coordinates @xmath9 dependent . in the remaining theorems",
    "we assume that the densities @xmath27 in ( p3 ) satisfy the conditions , for every @xmath144 and a universal constant @xmath145 , @xmath146 here @xmath147 is the projection defined by @xmath148 .",
    "( the constant 64 corresponds to the constant 32 in lemma  [ lemmatestphi ] , but has no special significance and can be improved . )    for a partition @xmath149 , we denote by @xmath150 the corresponding partition of @xmath151 and by @xmath152 the corresponding density . in the next theorem",
    "we assume that there exist @xmath153 and , for any @xmath154 , probability densities @xmath155 on @xmath156 , such that for any @xmath157 and @xmath158 , @xmath159 this condition expresses that the `` mixing between the coordinates within a given subspace '' is not too important .",
    "examples are given in section  [ sectionexamples ] .",
    "[ theoremconcentrationdependent ] suppose @xmath22 has strict exponential decrease , that is , satisfies ( [ priordim ] ) with @xmath94 and some @xmath160 .",
    "the assertions of theorems  [ theoremdimension ] and  [ theoremconcentrationindependent ] are also true if the densities @xmath27 are not product densities , but general densities with finite second moments that satisfy ( [ eqgone ] ) ,  ( [ eqgtwo ] ) and  ( [ eqboundconditionaldensity ] ) with , and @xmath161 the constant in ( [ eqboundconditionaldensity ] ) .      the next results are designed for application to the particular priors @xmath22 of the form , for positive constants @xmath61 , @xmath162 where @xmath163 stands for `` proportional to . '' because @xmath164 , this prior is inversely proportional to the number of models of size @xmath24 , a quantity that could be viewed as the _ model complexity _ for a given dimension @xmath24 . thus this prior appears particularly suited to the purpose of `` downweighting the complexity . ''",
    "forgetting about the extra component @xmath27 of the prior , we can also consider it an analog of the penalty `` @xmath165 '' used in model selection in this context by ( e.g. ) birg and massart in  @xcite .",
    "every particular model with support @xmath166 of size @xmath73 receives prior probability bounded below and above by expressions of the type @xmath167 from this prior .    because the _ complexity prior _  ( [ priorone ] ) has exponential decrease  ( [ priordim ] )",
    "when @xmath168 and satisfies  ( [ eqlbonpin ] ) , theorems  [ theoremdimension ] and  [ theoremconcentrationdependent ] ( or theorem  [ theoremconcentrationindependent ] ) show that the corresponding posterior distribution concentrates on low - dimensional spaces and attains the minimax rate of contraction over @xmath19 $ ] relative to ( any ) @xmath53 if combined with densities @xmath27 satisfying the conditions of theorem  [ theoremconcentrationdependent ] .",
    "the following theorem relaxes the condition on @xmath27 and gives a more precise result on the contraction of the posterior measure .",
    "the theorem applies more generally to priors on dimension satisfying the upper bound , for some @xmath169 , and every @xmath170 , @xmath171    [ theoremmainexponentialdecrease ] if the densities @xmath27 have finite second moments , satisfy ( [ eqgone ] ) and  ( [ eqgtwo ] ) for some constant @xmath145 , and the priors @xmath22 satisfy  ( [ prioroneonesided ] ) for some @xmath172 and @xmath173 , then , for @xmath109 satisfying  ( [ eqconditionrate ] ) , for any @xmath174 and any @xmath175 , @xmath98}p_{n,{\\theta}_0}\\pi_n \\bigl({\\theta}\\dvtx\\|{\\theta}- { \\theta}_0\\| >",
    "45r_n+10r{|}x \\bigr ) \\lesssim e^{- r^2/10}.\\ ] ]    consistent with the preceding findings , the posterior distribution concentrates on euclidean balls of radius of the order @xmath109 around @xmath31 .",
    "in addition the theorem shows that its `` tail '' is sub - gaussian , uniformly in @xmath46 and uniformly over @xmath19 $ ] . as one consequence , for every @xmath176 , @xmath177 by jensen s inequality ,",
    "this in turn implies the following corollary .    under the conditions of theorem  [ theoremmainexponentialdecrease ] , @xmath178 } p_{n,{\\theta}_0 } \\biggl\\|",
    "\\int{\\theta}\\,d \\pi_n({\\theta}{|}x ) -{\\theta}_0 \\biggr\\|^l \\lesssim r_n^l.\\ ] ]    the posterior mean @xmath179 as a point estimator of @xmath31 has a risk of the order @xmath109 , relative to every polynomial loss function .",
    "in particular , it is rate - minimax over @xmath19 $ ] for the squared @xmath180-risk .",
    "the posterior coordinate - wise median considered in the simulation study below is another interesting functional of the posterior measure . under the conditions of theorem  [ theoremmainexponentialdecrease ] and ( [ priorone ] ) ,",
    "the posterior coordinate - wise median is rate - minimax over @xmath19 $ ] , _ for any _ @xmath53-distance , @xmath181 ; see  @xcite .",
    "the theorem , with its explicit bound , is also the basis for results on the concentration of the posterior distribution when the true vector is in a weak @xmath57$]-class .",
    "results for the posterior mean and @xmath180-risk can be obtained as above as a consequence .",
    "[ theoremweakclass ] if the densities @xmath27 have finite second moments , satisfy ( [ eqgone ] ) and  ( [ eqgtwo ] ) for some constant @xmath145 , and the priors @xmath22 satisfy  ( [ prioroneonesided ] ) for some @xmath172 and @xmath173 , then , for @xmath109 satisfying @xmath182\\ ] ] for any @xmath174 , @xmath16 and any @xmath175 , @xmath183}p_{n,{\\theta}_0}\\pi_n \\bigl({\\theta}\\dvtx\\|{\\theta}- { \\theta}_0\\| > 80r_n+20r{|}x \\bigr ) \\lesssim e^{- r^2/10}.\\ ] ]    for the `` complexity prior '' @xmath22 given by  ( [ priorone ] ) the third term @xmath184 in the minimum defining it is smaller than a multiple of the second term , and hence can be omitted .",
    "the minimum can then be determined by equating the first two terms , leading to @xmath185 if @xmath186 , then this value is eligible in the minimum , and the first and second terms evaluated at @xmath187 are of the same order , given by @xmath188 this in fact is the minimax rate @xmath189 for the square euclidean metric @xmath51 over the class @xmath57 $ ] ; see  ( [ eqdefmunq ] ) .",
    "thus the complexity priors combined with densities @xmath27 satisfying  ( [ eqgone ] ) and  ( [ eqgtwo ] ) [ in particular , product densities satisfying  ( [ eqproductprior ] ) ] yield contraction at the minimax rate over both the nearly black vectors @xmath19 $ ] and the weak @xmath57 $ ] classes . for priors on dimension that are significantly smaller than the complexity priors , the third term in the minimum must be taken into account , and the rate of contraction is smaller than minimax .",
    "the condition @xmath186 is satisfied as soon as the sparsity coefficient @xmath190 is not too small .",
    "if the signal is very sparse and has @xmath191 , then the minimum in the definition of @xmath115 is taken at @xmath192 , leading to a squared rate of the order @xmath193 .",
    "this is within a constant of the rate achieved by hard thresholding in that case .",
    "the previous result extends under slightly stronger conditions to @xmath53-distances with @xmath194 .",
    "furthermore , the following theorem shows that @xmath187 is indeed an upper bound on the dimensionality of the posterior distribution . for simplicity we only state the result in the case of complexity priors .",
    "recall that @xmath195 , given in  ( [ eqdefmunq ] ) , denotes the minimax rate over the class @xmath57 $ ] relative to @xmath53 .",
    "[ thmpq ] suppose the densities @xmath27 have finite second moments , satisfy ( [ eqgone ] ) ,  ( [ eqgtwo ] ) and  ( [ eqboundconditionaldensity ] ) , and @xmath22 satisfies  ( [ priorone ] ) for sufficiently large @xmath172 and @xmath196 .",
    "then for any @xmath16 , any @xmath197 and any @xmath198 such that @xmath199 and @xmath187 given by  ( [ eqdefpnstar ] ) is bounded away from 0 , for a sufficiently large constant @xmath111 , @xmath200}p_{n,{\\theta}_0 } \\pi_n \\bigl({\\theta}\\dvtx    \\\\ \\sup_{{\\theta}_0\\in m_s[p_n]}p_{n,{\\theta}_0 } \\pi_n \\bigl({\\theta}\\dvtx d_q({\\theta},{\\theta}_0 ) > m\\mu^*_{n , s , q } { |}x \\bigr)&\\to&0.\\end{aligned}\\ ] ]      in this section we discuss examples of priors on dimension @xmath22 and prior densities @xmath27 on the nonzero coordinates that satisfy the conditions of the preceding theorems .",
    "consider the prior on @xmath201 corresponding to sampling the coordinates @xmath9 independently from a mixture @xmath202 of a dirac measure at 0 and a univariate density  @xmath95 , for a given @xmath203 .",
    "the coordinates of @xmath10 are then independently zero with probability @xmath204 , and hence the dimension of the model is binomially distributed with parameters @xmath46 and @xmath205 . furthermore , the nonzero coordinates are distributed according to the product of copies of @xmath95 .",
    "thus this prior fits in our set - up , with @xmath22 the binomial@xmath206-distribution and @xmath27 a product density .    for a fixed @xmath205 the coordinates @xmath9",
    "are independent , under both the prior and the posterior distribution .",
    "furthermore , the posterior distribution of @xmath9 depends on @xmath207 only .",
    "this prior is considered in  @xcite and  @xcite , in combination with a gaussian or a heavy tailed density @xmath95 , respectively . in the next section",
    "we show that gaussian priors are deficient if the nonzero coordinates of the signal are large .",
    "the authors of  @xcite propose to use the coordinatewise posterior median ( or another univariate point estimator ) for estimating @xmath10 , with the weight parameter @xmath208 set by a thresholded empirical bayes method : the parameter is chosen equal to the maximum likelihood estimator of @xmath205 based on the marginal distribution of @xmath30 in the bayesian set - up ( i.e. , with @xmath10 integrated out but with fixed @xmath205 ) subject to the constraint that the resulting posterior median ( after plugging in @xmath209 ) given an observation in the interval @xmath210 $ ] is zero .",
    "the authors show that the resulting point estimator works remarkably well , in a minimax sense , for various metrics and sparsity classes .",
    "a natural bayesian approach is to put a prior on @xmath205 , which yields a mixture of binomials as a prior @xmath22 on the dimension of the model .",
    "the independence of the coordinates @xmath9 is then lost .",
    "we discuss this prior further in the following example .",
    "[ priorhie ] the binomial @xmath211 distribution as the prior @xmath22 on dimension gives an expected dimension of @xmath212 . in the sparse",
    "setting a small value of @xmath213 is therefore natural .",
    "if the sparsity parameter @xmath12 were known , we could consider the choice @xmath132 ; we shall refer to the corresponding law as _",
    "oracle binomial prior_. assume that @xmath214 with @xmath113 .",
    "the binomial prior has exponential decrease  ( [ priordim ] ) if @xmath215 .",
    "the oracle binomial prior @xmath216 is at the upper end of this range , and also satisfies  ( [ eqlbonpin ] ) , and thus yields the minimax rate of contraction .",
    "the choice @xmath217 yields @xmath218 of the order @xmath219 , and hence attains the minimax rate if @xmath12 is of the order @xmath220 , @xmath221 ; for larger @xmath12 it may miss the minimax rate by a logarithmic factor .",
    "a natural bayesian strategy is to view the unknown `` sparsity '' parameter @xmath208 as a hyperparameter and put a prior on it .",
    "the classical choice is the beta prior , leading to the hierachical scheme @xmath222 and @xmath223 , which corresponds to the following prior on @xmath24 : @xmath224 the mean dimension is @xmath225 , which suggests to choose the hyper parameters of the beta distribution so that @xmath226 is in the range @xmath227 .",
    "it is easy to verify that the prior has exponential decrease  ( [ priordim ] ) , with @xmath228 , if @xmath229 .",
    "this suggests to choose small @xmath230 and large @xmath231 , thus giving a small variance to the beta distribution . for @xmath232 and @xmath233",
    "we obtain @xmath234",
    ". then @xmath235 , showing ( strict ) exponential decrease  ( [ priordim ] ) , with @xmath236 . by a binomial identity the norming constant is equal to @xmath237 , so @xmath238 for @xmath113 , this gives @xmath239 , and hence  ( [ eqlbonpin ] ) is satisfied .",
    "more generally , we may choose @xmath240 , @xmath241 , which leads to @xmath242 .",
    "the priors given by @xmath243 , for some @xmath244 are a further alternative .",
    "the poisson@xmath245 distribution truncated to @xmath246 , yields priors satisfying @xmath247 for @xmath248 , by stirling s approximation .",
    "the mean is approximately @xmath208 , suggesting @xmath208 in the range @xmath249 . as @xmath250 ,",
    "the prior has exponential decrease  ( [ priordim ] ) for @xmath251 .",
    "if we put an exponential @xmath252 hyperprior on @xmath208 , then @xmath22 transforms into a shifted geometric distribution ( shifted @xmath253 to have support starting at 0 ) with success probability @xmath254 .",
    "a gamma hyperprior yields a shifted negative binomial . for fixed hyper ",
    "hyper parameters both are of the form @xmath255 for some constant @xmath64 , and hence have exponential decrease , and satisfy  ( [ eqlbonpin ] ) .",
    "the prior @xmath256 has exponential decrease  ( [ priordim ] ) for @xmath257 and satisfies  ( [ eqlbonpin ] ) .",
    "theorems  [ theoremmainexponentialdecrease ] ,  [ theoremweakclass ] and  [ thmpq ] show that this prior also gives sparsity and minimax recovery of the parameter over weak @xmath15-classes .",
    "although our results do not show the opposite assertion that mere exponential decrease is not enough for minimaxity on weak classes ( while together with  ( [ eqlbonpin ] ) it is enough for minimaxity over @xmath19 $ ] ) , this might be a potential advantage of complexity priors over the binomial and poisson - based priors discussed previously .",
    "[ exproduct ] densities @xmath27 that are products of @xmath69 copies of a univariate density with finite second moment of the form @xmath258 for @xmath103 a function that satisfies  ( [ eqproductprior ] ) , satisfy  ( [ eqgone ] ) ,  ( [ eqgtwo ] ) and ( [ eqboundconditionaldensity ] ) . in this sense theorem  [ theoremconcentrationdependent ] is a generalization of theorem  [ theoremconcentrationindependent ] .    to see this note that for a product density the function @xmath27 takes the form @xmath259 .",
    "hence if ( [ eqproductprior ] ) holds with proportionality constant  1 , then the left - hand side of  ( [ eqgone ] ) is bounded in absolute value by @xmath260 furthermore , the left - hand side of  ( [ eqgtwo ] ) is bounded by @xmath261 the @xmath262-norm of @xmath263 can be bounded by a linear combination of @xmath264 and the square @xmath265-norm , as before , and hence the whole expression is bounded by @xmath266 , for some constant @xmath64 .    because a product density @xmath27 is a product of the marginal densities ,",
    "the validity of condition  ( [ eqboundconditionaldensity ] ) is clear .",
    "[ wmprior ] for @xmath103 a function satisfying  ( [ eqproductprior ] ) so that @xmath102 is integrable and @xmath267 a lipschitz function that is bounded below , consider , for @xmath268 , @xmath269 where @xmath270 is the normalizing constant .",
    "an example is the prior , for @xmath271 , @xmath272 in the appendix  @xcite it is shown that priors of this form satisfy  ( [ eqgone ] ) and  ( [ eqgtwo ] ) .",
    "furthermore , it is shown that  ( [ eqboundconditionaldensity ] ) is also satisfied , with @xmath273 if @xmath274 is the absolute value of the identity function and the lipschitz constant @xmath275 of @xmath276 is strictly smaller than 1 [ i.e. , @xmath277 for @xmath221 ] .",
    "thus any prior of this form combined with any prior on dimension that decreases exponentially such that @xmath279 , for @xmath280 the constant in  ( [ priordim ] ) , gives recovery at the minimax rate over @xmath19 $ ] , by theorem  [ theoremconcentrationdependent ] , and also over @xmath20 $ ] if combined with a complexity prior on dimension satisfying the conditions of theorems  [ theoremweakclass ] and  [ thmpq ] .",
    "for instance , the hierarchical binomial prior @xmath234 in example  [ priorhie ] has @xmath236 and hence @xmath281 suffices for contraction over @xmath19 $ ] .",
    "condition  ( [ eqproductprior ] ) [ or  ( [ eqgone ] ) and  ( [ eqgtwo ] ) ] on the priors @xmath27 for the nonzero coefficients ensures that the posterior does not shrink to the center of the prior too much . in the next theorem",
    "we investigate the necessity of conditions of this type .",
    "the theorem shows that product priors with marginal densities proportional to @xmath282 for some @xmath121 lead to a slow contraction rate for large true vectors @xmath31 .",
    "we formulate this in an asymptotic setting with a sequence of true vectors , written as @xmath283 , tending to infinity .",
    "we denote by @xmath12 the number of nonzero coordinates of @xmath283 .",
    "the theorem applies in particular to the normal distribution . for this",
    "prior a problem ( only ) arises if the parameter vector @xmath283 tends to infinity faster than the optimal rate @xmath284 the posterior then puts no mass on balls of radius a multiple of @xmath285 around the true parameter . for `` small '' @xmath283",
    "no problem occurs , because shrinkage to the origin is desirable in that case .",
    "however , if the true parameter satisfies @xmath286 , then the estimator that is zero , irrespective of the observations , possesses mean square error of the order the minimax risk for the problem .",
    "thus it is rather poor consolation that the bayes procedure based on gaussian priors performs well in this case , as it is no better than the `` zero estimator . ''",
    "gaussian priors really are problematic .    product priors with marginal density proportional to @xmath287 give behavior as the gaussian prior for every @xmath288 .",
    "for @xmath289 the result is slightly more complicated and involves the quantities @xmath290 where denotes the usual @xmath291-norm on @xmath1 ( i.e. , @xmath292 ) .",
    "the numbers @xmath293 increase to infinity as @xmath283 tends to infinity at a sufficiently fast rate .",
    "for instance @xmath294 is of the order @xmath295 if @xmath296 and @xmath297 for scalars @xmath298 and fixed vectors @xmath299 .",
    "the following theorem shows that if @xmath294 increases to infinity faster than the optimal rate @xmath300 , then the posterior does not charge balls of radius a small multiple of @xmath294 .",
    "[ theoremlb ] assume that the densities @xmath27 are products of @xmath166 univariate densities proportional to @xmath301 and the prior @xmath22 on dimension satisfies  ( [ eqlbonpin ] ) for some @xmath43 :    if @xmath288 and @xmath302 , then for sufficiently small @xmath303 , as @xmath304 , @xmath305    if @xmath306 and @xmath307 , then for sufficiently small @xmath303 , as @xmath304 , @xmath308    theorem  [ theoremlb ] shows problematic behavior of the posterior distribution for signals with large energies @xmath285 . instead of using fixed priors on the coordinates , we could make them depend on the sample size , for instance , gaussian priors with variance @xmath309 , or uniform priors on intervals @xmath310 $ ] with @xmath311 .",
    "such priors will push the `` problematic boundary '' toward infinity , but the same reasoning as for the theorem will show that shrinkage remains for ( very ) large @xmath283 .",
    "the above results show that @xmath27 needs to have heavy tails .",
    "another important condition , this time concerning the prior @xmath22 on the dimension @xmath312 , concerns the amount of mass @xmath117 at the true dimension . if this quantity is too small , then the bayes procedure might not be optimal .",
    "[ tlbdim ] suppose also that the prior @xmath22 on dimension in is decreasing and that there exist integers @xmath313 such that , for some @xmath314 and a sequence @xmath315 such that @xmath316 , @xmath317 denoting @xmath318 , there exists @xmath31 in @xmath319 $ ] such that , for sufficiently small @xmath303 , as @xmath304 , @xmath320    if @xmath321 , with @xmath322 the appropriate normalizing constant , let us apply the preceding result with the choices @xmath323 , @xmath324 , for some sequence @xmath325 .",
    "it holds @xmath326 as long as we impose @xmath327 and @xmath328 ( which holds for large enough @xmath46 ) , the last display is at most @xmath329 .",
    "theorem  [ tlbdim ] implies that there is a vector @xmath31 in @xmath330 $ ] with @xmath331 for a small enough constant @xmath332 .",
    "this implies that the corresponding estimator does not reach the optimal rate over the class @xmath19 $ ] as soon as @xmath333 tends to infinity faster than @xmath40 [ take , e.g. , @xmath334 .",
    "we have identified general conditions on the prior that ensure optimal convergence rates for estimating a sparse mean vector in gaussian noise . in particular , natural fully bayes estimates ( e.g. , beta - binomial prior on dimension ) are shown to be adaptive with respect to the unknown smoothing parameter @xmath190 .    especially in high - dimensional contexts the full posterior measure and special aspects of it can start to have divergent behaviors .",
    "we have seen that for nonconvex distances the posterior mean is not a satisfactory projection .",
    "it can also happen that the mode and the full posterior behave differently .    in some situations one might want to estimate prior hyperparameters , and in this case ,",
    "it is desirable to assess the convergence properties of the resulting plug - ins . to our knowledge",
    ", there are only a few works in this direction ; see  @xcite .",
    "potential alternative proofs could consist in obtaining first ( suitably uniform ) results for the ( full ) posterior measure and combine them with a statement saying that `` the plug - in estimate is not too bad . ''",
    "also , here , one could evaluate the sparsity coefficient @xmath335 via the posterior number @xmath336 of selected models and plug this estimate into the full posterior for the binominal prior on dimension .",
    "since @xmath337 does not exceed @xmath338 with high probability , we have some control of the plug - in into the full posterior .",
    "the question of then deriving results for estimates of it ( e.g. , the mean ) , remains open .",
    "in this section we provide an algorithm to compute several functionals of the posterior measure associated with the prior defined by , including the posterior mean , marginal posterior quantiles and the posterior of the number of selected models .",
    "the algorithm is exact in that it does not rely on an approximation of the posterior distribution , but computes the exact expressions .",
    "we illustrate the posterior quantities through simulations .",
    "we assume that the densities @xmath27 on @xmath28 are products of @xmath166 copies of a univariate density @xmath95 . because the prior on the number of nonzero coordinates induces dependence , this",
    "generally does not entail a factorization of the posterior distribution as a product measure .",
    "( an exception is the binomial distribution for @xmath22 . )    for all computations , we need the denominator of the posterior measure in  ( [ eqposterior ] ) ( the `` partition function '' ) . for @xmath339 the standard normal density , and @xmath340 its convolution with the density @xmath95 , this can be written @xmath341 naive computation directly from this expression would require a number of operations that grows exponentially with @xmath46 .",
    "however , the sum over all models @xmath166 of size  @xmath24 ( the inner sum in the display ) is equal to the coefficient of @xmath342 in the polynomial @xmath343 this polynomial can be computed by a quadratic number of operations by computing the products term by term , and in @xmath344 operations by a more clever algorithm .",
    "the posterior mean @xmath345 is a random vector in @xmath1 . letting @xmath346 ,",
    "we can write its first coordinate in the form @xmath347 the inner sum ( over @xmath166 ) is the coefficient of @xmath342 in the polynomial @xmath348 .",
    "hence it can be computed as before .",
    "the distribution function of the marginal posterior distribution of the first coordinate can be written , for any real @xmath349 , @xmath350\\times{\\mathbb{r}}^{n-1 } { |}x \\bigr ) = ( 1-q_{n,1 } ) 1_{u\\ge0 } + q_{n,1 } \\frac{\\psi(x_1,u)}{\\psi(x_1)},\\ ] ] where @xmath351 is the posterior probability that the first coordinate is zero , and @xmath352 .",
    "the former probability can be written @xmath353 hence it can be computed as before , now involving the polynomial @xmath354 .",
    "given the marginal posterior distribution , we can compute marginal quantiles .",
    "for instance , the first component of the coordinatewise median @xmath355 is given by , with @xmath356 the inverse of @xmath357 , @xmath358 + \\biggl[h_{n,1}^{-1 } \\biggl(\\frac{1}{2q_{n,1 } } \\biggr)\\wedge0 \\biggr].\\ ] ] the last display should be understood with the convention @xmath359 if @xmath360 and @xmath361 if @xmath362 .",
    "the posterior distribution of the number @xmath363 of nonzero coordinates of @xmath78 is the random distribution on the set @xmath364 given by @xmath365 the same computational scheme applies .",
    "in fact the sum will already be computed in the derivation of @xmath366 .      in a small simulation study we considered the prior defined by ( p1)(p3 ) with @xmath95 a laplace density @xmath367 , with scale parameter and two priors on dimension , suggested by our theoretical results , given by @xmath368 here",
    "@xmath369 is a real parameter , which for both priors quantifies how fast they decrease to zero with @xmath24 . in the results shown we used @xmath370 and @xmath371 .",
    "we simulated signals @xmath372 of length @xmath373 , for various settings of the sparsity @xmath374 and for signals @xmath10 with the nonzero coordinates set equal to a fixed number @xmath375 .",
    "we show the results for @xmath376 and `` signal strength '' @xmath377 .    @l c r c c c c c c c@ @xmath378 & & & + & & & + @xmath379 & * 3 * & & * 5 * & * 3 * & * 4 * & * 5 * & * 3 * & * 4 * & * 5 * +   + [ -4pt ] pm1&111&96 & 94 & 176 & 165 & 154 & 267&302&307 + pm2 & * 106 * & 92 & 82 & 169 & 165 & 152 & 269&280&274 + ebm & * 103 * & 96 & 93 & 166 & 177 & 174 & 271&312&319 + pmed1 & 129 & * 83 * & 73 & 205 & 149 & * 130 * & * 255*&279 & 283 + pmed2 & 125 & 86 & * 68 * & 187&148 & * 129 * & 273&*254 * & * 245 * + ebmed & 110 & * 81 * & 72 & * 162 * & 148&142&*255*&294&300 + ht&175 & 142 & * 70 * & 339 & 284 & 135 & 676&564&252 + hto & 136 & 92 & 84 & 206 & 159 & 139&306&261 & 245 +    @l c",
    "r r r r r c c c@ @xmath378 & & & + & & & + @xmath379 & * 3 * & & & & & & & & +   + [ -4pt ] pm1 & 80 & 101 & 110 & 127 & 145 & 147 & 240&268&270 + pm2 & 79 & 85 & 87 & 135 & 145 & 144 & 219&232&232 + ebm & 95 & 110 & 117 & 191 & 200 & 176 & 260&285&281 + pmed1 & * 51 * & 43 & 45 & * 86 * & * 80 * & 78 & 178&225&230 + pmed2 & * 50 * & * 40 * & 37 & * 86 * & * 79 * & 76 & * 156*&*162*&163 + ebmed & * 50 * & 48 & 45 & 108 & 121 & 97 & 212 & 258 & 257 + ht & 63 & 44 & * 27 * & 122 & 86 & * 53 * & 244&173&*102 * + hto & 53 & 41 & 40 & 91 & 79 & 74 & 157&148&144 +    tables  [ table1 ] and  [ table2 ] report estimates of the mean square errors @xmath380 and mean absolute deviation errors @xmath381 of eight estimators @xmath382 .",
    "these estimates are the average ( square ) error of 100 estimates @xmath383 computed from @xmath384 data vectors simulated independently from model  ( [ eqmodel ] ) .",
    "the eight estimators include the posterior means _ pm1 _ , _",
    "pm2 _ and coordinatewise medians _",
    "pmed1 _ , _ pmed2 _ associated with the two priors @xmath22 with @xmath385 ,",
    "the empirical bayes mean _ ebm _ and median _ ebmed _ considered in  @xcite with a standard laplace prior , and the hard - thresholding _",
    "ht _ and hard - thresholding - oracle _ hto _ estimators , given by @xmath386 the last estimator uses the `` oracle '' value of the sparsity parameter @xmath12 , whereas the other seven estimators do not use this value .",
    "the tables show that the mean and median of the full bayesian posterior distribution are competitive with the empirical bayes estimates .",
    "the behavior of the full bayes and empirical bayes estimates seems similar , up to a few aspects . in terms of squared risk ,",
    "empirical bayes estimates appear to be slightly better for small @xmath12 and small @xmath375 , while the full bayes estimates appear to be slightly better for larger signals and larger @xmath12 . for @xmath387-risk ,",
    "the full bayes estimates appear to outperform the eb - estimates in most of the cases .",
    "( additional simulation results , not shown , suggest that the situation becomes less unfavorable for empirical bayes as the scale parameter @xmath275 of the laplace prior is taken smaller than @xmath388 . ) in agreement with  @xcite , in most cases the mean estimates perform not quite as well as the median ones , already in terms of squared - risk .",
    "the parameter @xmath275 of the laplace prior plays the same role for the full bayes as for the empirical bayes estimates .",
    "although we do not investigate this aspect here , it could be estimated from the data , as is proposed in the ebayesthresh package , or be treated as a hyperparameter in a full bayes approach .",
    "[ a single scale parameter for high - dimensional densities @xmath27 appears to create dependence between the coordinates that is stronger than what is allowed by our conditions  ( [ eqgone ] ) and  ( [ eqgtwo ] ) , and hence would need further analysis . ]",
    "similar remarks pertain to the parameter @xmath369 .",
    "the choice @xmath385 seemed to be fairly good uniformly over all considered simulations , also for smaller @xmath46 s . for further illustration figure  [ figure1 ]",
    "shows marginal 95% credible intervals ( orange bars ) for the parameters @xmath7 , and marginal posterior medians ( red dots ) for a single simulation of the data vector , with single strength @xmath389 ,",
    "@xmath390 and @xmath373 .",
    "the observations @xmath391 are indicated by green dots .",
    "the credible intervals are defined as intervals between the 2.5% and 97.5% percent quantiles of the marginal posterior distributions of the parameters .",
    "the intervals corresponding to zero and nonzero coefficients @xmath9 are clearly separated , although some of the credible intervals of nonzero @xmath9 contain the value zero .",
    "also visible is that the posterior medians and the credible intervals surrounding them are shrunk toward zero relative to the observed value @xmath207 , for the zero coordinates @xmath9 , which is desirable , but also for the nonzero @xmath392 .",
    "figure  [ figure1 ] ( bottom ) shows that for @xmath232 the shrinkage effects are stronger , and the credible intervals shorter .     for a single data vector @xmath391",
    "simulated according to the model ( [ eqmodel ] ) with @xmath393 , where @xmath373 and the last @xmath390 coordinates are nonzero .",
    "the data points are indicated by green dots .",
    "the prior @xmath95 is the standard laplace density , and @xmath22 is as in ( [ eqprior2 ] ) with `` inverse temperature '' @xmath394 ( top graph ) and @xmath395 ( bottom graph ) . ]    since our main goal here is illustration , we only implemented a simple version of the algorithm .",
    "this computes the polynomials with direct loops and can be improved .",
    "this implementation is limited to @xmath46 of the order 500 , not by computing time , but by the appearance of large numbers in the polynomial coefficients that overflow standard memory capacity @xmath396 .",
    "handling larger @xmath46 should certainly be possible by improved programming , for instance , by computing on a logarithmic scale .",
    "algorithmic complexity appears not to be a major issue .",
    "we first prove the theorem for priors on dimension @xmath397 with strict exponential decrease and densities @xmath27 that are not necessarily of product form , but that satisfy ( [ eqboundconditionaldensity ] ) , for @xmath398 , and @xmath280 the constant in  ( [ priordim ] ) . thus the proof also covers half of theorem  [ theoremconcentrationdependent ] . in view of example",
    "[ exproduct ] , densities of the product form satisfy  ( [ eqboundconditionaldensity ] ) with @xmath399 , and hence automatically have @xmath398 .    since the true parameter @xmath31 is assumed to have @xmath12 nonzero coordinates , it is sufficient to prove that the intersection of the support @xmath400 with the complement @xmath401 of the support @xmath402 of @xmath31 has dimension of the order @xmath12 under the posterior distribution .",
    "the following proposition gives an explicit bound on this dimension ; it is followed by a lemma that shows that this bound tends to zero under the conditions of the theorems .",
    "the idea of the proof of the proposition is to condition on the vector of the coordinates @xmath403 of @xmath10 that belong to @xmath404 .",
    "the unconditional density of @xmath405 for @xmath10 drawn from the prior @xmath71 is given by , with @xmath406 denoting a `` dirac density at @xmath8 , '' @xmath407 the conditional density of @xmath408 given @xmath409 is proportional to this expression viewed as function of @xmath410 .",
    "this shows the conditional distribution has the same structure as the prior @xmath71 , but with sample space @xmath411 rather than @xmath1 , with the density of the nonzero coordinates of @xmath412 given by @xmath413 , proportional to @xmath414 , and the prior on dimension given by @xmath415 the extra factor ( quotient ) on the right arises because @xmath416 and @xmath417 are the probabilities of the given dimensions , and hence the sums of the probabilities of all subsets of that dimension .",
    "recall also that we assume that @xmath397 is positive for any @xmath24 , which makes the maximum appearing in the following proposition always finite .",
    "[ propositiondimension ] if the densities @xmath27 satisfy  ( [ eqboundconditionaldensity ] ) , then , for any @xmath418 , @xmath98}p_{n,{\\theta}_0}\\pi_n\\bigl({\\theta}\\dvtx \\bigl|s_{\\theta}\\cap s_{{\\theta}_0}^c\\bigr|\\ge a { |}x \\bigr ) \\leq \\sum_{p = a}^{n - p_n } m_1^{p_n+p } \\max_{0 \\le k \\le p_n } \\biggl [ \\frac { \\pi_{n , k}(p ) } { \\pi_{n , k}(0 ) } \\biggr].\\ ] ]    for @xmath419 and @xmath420 the marginal distribution of @xmath409 if @xmath10 is distributed according to the posterior distribution , @xmath421 in the bayesian setting the vectors @xmath422 and @xmath423 are conditionally independent given @xmath10 with marginal conditional distributions depending on @xmath409 and @xmath412 only , respectively .",
    "this implies that the distribution of @xmath412 given @xmath424 depends on @xmath425 only .",
    "the joint distribution of @xmath426 can be generated by first generating @xmath409 from its marginal distribution derived from @xmath71 , next generating @xmath412 from its conditional given @xmath409 derived from @xmath71 , and finally generating @xmath423 from the @xmath427-distribution .",
    "it follows that the conditional distribution of @xmath412 given @xmath424 can also be described as the `` ordinary '' posterior distribution of @xmath428 given the observation @xmath423 relative to the prior on @xmath412 given by the conditional distribution of @xmath412 given @xmath409 derived from @xmath71 . if @xmath429 denotes the prior induced on @xmath411 when conditioning @xmath71 to the event that @xmath430 , and @xmath431 , then @xmath432 the denominator of the right - hand side can be bounded below by restricting the integrating set to the singleton @xmath433 , leading to @xmath434    let @xmath154 denote the indices of the nonzero coordinates of @xmath435 , @xmath436 the vector of their values and @xmath437 , and similarly for @xmath438 .",
    "then @xmath439 with the notation @xmath440 introduced above , one obtains @xmath441 on the other hand , an application of bayes s formula leads to @xmath442 and the last ratio of prior probabilities of subsets is equal to @xmath443 combining the previous identities and condition ( [ eqboundconditionaldensity ] ) , one obtains that @xmath444 is bounded above , uniformly in @xmath445 , by @xmath446 \\frac{m_1^{p_n+p}}{{n - p_n\\choose p } } \\int\\frac{p_{n_2,{\\theta}_2}}{p_{n_2,0_{s_2}}}(x_{s_2}){\\gamma}_{s_2 } ( { \\theta}_2 ) \\,d{\\theta}_2.\\ ] ] the proposition follows , since @xmath447 .",
    "[ lemexpde2 ] if @xmath22 satisfies  ( [ priordim ] ) with @xmath94 and a constant @xmath280 such that @xmath448 , then @xmath449 { \\rightarrow}0 $ ] for @xmath450 bigger than a sufficiently large multiple of @xmath12 and @xmath451 .    from the expression of @xmath452 in  ( [ eqdefpink ] )",
    ", simple algebra leads to @xmath453 using the assumed strict exponential decrease , the second ratio in the last display is bounded above by @xmath454 . for any integer @xmath312 between @xmath8 and @xmath12 , the last factor ( ratio ) in the last display is bounded above by @xmath388 and @xmath455 is bounded above by @xmath456 . since @xmath457",
    ", for @xmath96 as soon as @xmath458 is larger than a sufficiently large multiple of @xmath111 , the result follows .",
    "combining proposition  [ propositiondimension ] and lemma [ lemexpde2 ] concludes the proof of the first half of theorem [ theoremconcentrationdependent ] and of theorem  [ theoremdimension ] for priors on dimension with strict exponential decrease .    for @xmath27 of the product form and @xmath22 with just exponential decrease [ @xmath314 in  ( [ priordim ] ) ] such as the oracle binomial prior , we use a slight variant of the above argument . starting from ( [ eqhulpdim ] )",
    ", the denominator can be bounded below with the help of lemma  [ lemlowbound ] ( below ) , applied with @xmath459 instead of @xmath46 , with @xmath130 and both @xmath460 .",
    "this implies that @xmath461 is bounded above by @xmath462 where @xmath463 and @xmath464 .",
    "in fact @xmath465 , by the assumption that the common density @xmath95 has zero mean .",
    "if @xmath466 denotes the second moment of @xmath95 , we have @xmath467 this implies that @xmath461 is uniformly bounded in @xmath468 by @xmath469 to conclude one takes the @xmath470-expectation and uses lemma [ lemexpde ] below .",
    "[ lemexpde ] if @xmath22 satisfies  ( [ priordim ] ) , then @xmath471 with @xmath472 that depends on @xmath473 in  ( [ priordim ] ) only .",
    "furthermore , @xmath474 for @xmath450 bigger than a sufficiently large multiple of @xmath12 and @xmath451 .",
    "[ secmeanmed ] in view of theorem  [ theoremdimension ] the posterior mass of models of dimension bigger than @xmath475 , for a large constant @xmath375 , tends to zero .",
    "thus it suffices to show concentration around @xmath31 in models with @xmath476 .",
    "this is achieved using testing arguments .",
    "proposition  [ theorem2 ] gives an explicit bound on concentration with respect to the euclidean metric .",
    "general @xmath53-metrics are next treated by interpolation of metrics .",
    "let @xmath477 be the standard normal distribution function and @xmath478 .",
    "[ lemmatestphi ] for any @xmath479 and any @xmath480 there exists a test @xmath339 based on @xmath481 , such that for every @xmath78 with @xmath482 , @xmath483 this quantity can be further bounded by @xmath484 .",
    "we note that the bound of lemma  [ lemmatestphi ] , even though valid for every @xmath479 , is of interest only if @xmath208 and @xmath485 are not too different : if @xmath486 or @xmath487 , then the trivial tests @xmath488 and @xmath489 give the better bounds @xmath208 and @xmath485 , respectively .",
    "[ lemlowbound ] for any prior probability distribution @xmath490 on @xmath1 , any positive measure @xmath491 with @xmath492 , and any @xmath493 , @xmath494 where @xmath495 and @xmath496 .",
    "consequently , for any @xmath497 , @xmath498    [ lemmavolume ] the volume @xmath499 of the @xmath24-dimensional euclidean unit ball satisfies , for every @xmath77 , setting @xmath500 and @xmath501 , @xmath502    [ lembeta ] let @xmath70 , @xmath503 , @xmath504 and @xmath505 .",
    "let @xmath506 with support @xmath166 and @xmath507 .",
    "for some universal constant @xmath508 , we have that @xmath509    denoting @xmath510 the quantity in the logarithm in the last display , @xmath511 let us decompose , for any @xmath512 and @xmath513 , @xmath514 combining this identity with  ( [ eqgone ] ) and  ( [ eqgtwo ] ) , we obtain , with @xmath515 , @xmath516 denoting by @xmath517 the vectors of @xmath1 with respective supports @xmath518 and such that @xmath519 , @xmath520 , note that the last line of the previous display is bounded above by @xmath521 . for @xmath522 and @xmath523 , we have @xmath524 due to lemma  [ lemmavolume ] , the quotient @xmath525 is bounded by @xmath526 since @xmath527 by assumption , we have @xmath528 , and because the function @xmath529 takes a maximum at @xmath530 , we obtain , for some universal constants @xmath531 , @xmath532 to conclude , one notes that @xmath533 and that @xmath534 by the assumption on @xmath109 , so that @xmath535 .    [ theorem2 ] if the densities @xmath27 satisfy  ( [ eqgone ] ) and  ( [ eqgtwo ] ) and have finite second moments , then there exist universal constants @xmath536 such that for and @xmath537 and @xmath115 satisfying  ( [ eqconditionrate ] ) and @xmath199 , as @xmath538 , @xmath539 } p_{n,{\\theta}_0 } \\pi_n\\bigl({\\theta}\\dvtx\\|{\\theta}- { \\theta}_0\\|>m r_n ,",
    "|s_{\\theta}|\\le ap_n { |}x\\bigr ) \\\\ & & \\qquad\\le e^{-r_n^2/8 } + d_1 \\pmatrix{n \\cr a p_n } e^{d_2ap_n -d_3(mr_n)^2}.\\end{aligned}\\ ] ]    let @xmath540 be the collection of subsets @xmath541 such that @xmath542 . for each such @xmath166 and @xmath543 let @xmath544 be a maximal @xmath545-separated set inside the set @xmath546 . because the latter set is within a ball of radius @xmath547 of the projection @xmath548 onto the subspace of vectors with support inside @xmath166",
    ", a volume argument shows that the cardinality of @xmath549 is at most @xmath550 .",
    "we can partition the set of vectors with exactly support @xmath166 by assigning each such vector to a closest point @xmath551 for some @xmath552 and @xmath553 .",
    "the resulting partitioning sets @xmath554 will fit into balls of radius @xmath545 . for each @xmath551",
    "fix a test @xmath555 as in lemma  [ lemmatestphi ] with @xmath124 and the triple @xmath556 , @xmath557 and @xmath485 taken equal to the triple @xmath558 , @xmath559 and @xmath560 , where the last numbers will be determined later . in view of the second assertion of lemma  [ lemlowbound ] applied with @xmath322 equal to @xmath109",
    ", there exist events @xmath561 such that @xmath562 , on which @xmath563 we have that @xmath564 \\biggr ) \\\\ & & \\qquad\\le\\sum_{s\\in{{\\mathcal{s}}}_1}\\sum_{j\\ge m } \\sum_{i \\in i_{s , j } } \\bigl(p_{n,{\\theta}_0 } \\phi_{s , j , i}+{\\beta}_{s , j , i}\\sup_{{\\theta}\\in b_{s , j , i}}p_{n,{\\theta}}(1- \\phi_{s , j , i } ) \\bigr),\\end{aligned}\\ ] ] where we have denoted @xmath565 in view of lemma  [ lemmatestphi ] the term within the triple sum is bounded using by @xmath566 . since @xmath567 and @xmath199 , we can take @xmath46 large enough in order to have both @xmath568 and @xmath569 for any @xmath504 . since @xmath570 , we have @xmath571 , so we also have @xmath572 .    combination with lemma  [ lembeta ] now yields the bound , for @xmath571 , @xmath573 one easily checks that this is bounded by @xmath574 , for @xmath575 when @xmath571 .",
    "thus the probability at stake is bounded from above by @xmath576 for @xmath577 large enough . by assumption @xmath578 , so each binomial term is bounded by the last one .",
    "using simple algebra this yields the second term in the bound of the theorem .",
    "the first term comes from @xmath579 .     in view of  ( [ eqconditionrate ] )",
    "we have @xmath580 .",
    "therefore , the right - hand side of proposition  [ theorem2 ] tends to zero . combining this with theorem  [ theoremdimension ] yields proofs of theorems  [ theoremconcentrationindependent ] and  [ theoremconcentrationdependent ] for @xmath53 the square euclidean norm @xmath51 .",
    "the theorems for @xmath125 are a corollary of the case @xmath114 , by interpolation between the distances .",
    "due to hlder s inequality , for any @xmath581 with @xmath582 , @xmath583 this implies , for any @xmath96 , if @xmath99 $ ] , @xmath584 the first term on the right - hand side tends to zero for sufficiently large @xmath375 .",
    "next the second tends to zero for sufficiently large @xmath111 .",
    "the theorem is proved by bounding the ( posterior ) risk under a vector @xmath585 $ ] by the risk under its projection into @xmath586 $ ] obtained by setting the smallest @xmath587 coordinates of @xmath31 equal to zero .",
    "the value @xmath24 that minimizes the expression that defines the rate @xmath115 is the optimal dimension of a projection , and the complicated expression itself is a trade - off of an approximation error and a rate .",
    "the comparison between @xmath31 and its projection @xmath392 is made in the following lemma .",
    "[ postcomp ] for any measurable function @xmath276 and any @xmath588 in @xmath589 , @xmath590    in view of the cauchy ",
    "schwarz inequality , @xmath591 the second integral on the right - hand side is equal to @xmath592 .",
    "let @xmath187 be an index for which the minimum that defines the rate @xmath115 is attained",
    ". for given @xmath31 belonging to @xmath57 $ ] , let @xmath392 denote the vector deduced from @xmath31 by keeping unchanged its @xmath187 largest components and putting the other ones to @xmath8 . by definition @xmath392",
    "belongs to @xmath593 $ ] and @xmath594}|^2 \\leq \\biggl(\\frac{p_n}{n } \\biggr)^2 \\sum _ { i > p_n^ * } \\biggl(\\frac { n}{i } \\biggr)^{2/s } \\nonumber\\\\[-8pt]\\\\[-8pt ] & \\leq & \\biggl(\\frac{p_n}{n } \\biggr)^2 \\biggl ( \\frac{s}{2-s } \\biggr ) n^{2/s } \\bigl(p_n^ * \\bigr)^{1 - 2/s } \\le r_n^2,\\nonumber\\end{aligned}\\ ] ] where the first inequality is obtained using the definition of the @xmath57$]-class , and the second follows by comparison of the series with an integral .",
    "therefore , the triangle inequality implies @xmath595 by lemma  [ postcomp ] the expectation of the right - hand side under @xmath470 is bounded by @xmath596 finally apply theorem  [ theoremmainexponentialdecrease ] , with @xmath322 of the theorem taken equal to @xmath597 .",
    "the proof of theorem  [ theoremlb ] follows the approach to get lower bound type results introduced in  @xcite , which uses the principle that sets with very little prior mass receive no posterior mass , see also figure  [ fig2 ] .",
    "[ lemlb ] we have @xmath598 , for any @xmath599 for which there exist @xmath109 such that @xmath600    [ lemvol ] there exist a constant @xmath314 such that if @xmath70 and @xmath109 is a sequence of real numbers such that @xmath601 , it holds @xmath602    proof of theorem  [ theoremlb ] we first consider the ( more complicated ) case that @xmath306 . for this range of @xmath208 an application of hlder s inequality gives that @xmath603 ,    . ]    if @xmath24 is the number of nonzero coordinates of a vector @xmath10 .",
    "let us introduce @xmath604 then @xmath605 and @xmath606 .",
    "also , @xmath607 define @xmath608 then the ball in @xmath609 of radius @xmath599 around @xmath610 is contained in the ball of radius @xmath109 around @xmath611 .",
    "it follows that the second - to - last display is bounded above by @xmath612 with @xmath613 and @xmath614 .",
    "we finish the proof by bounding the densities @xmath615 and @xmath616 above and below on the given sets .    if @xmath617 , then by the triangle inequality followed by hlder s inequality , @xmath618 because @xmath619 and @xmath620 .",
    "similarly , if @xmath621 and @xmath622 , then @xmath623 and @xmath624 we deduce that , for any @xmath166 such that @xmath625 , denoting by @xmath626 the normalizing constant of the density @xmath627 , @xmath628 \\\\ & \\leq & \\exp\\biggl[-2{\\alpha}(5/8)^{\\alpha-1}r_n\\frac{\\|{\\theta}_0\\|_{\\alpha}^{\\alpha}}{4\\|{\\theta}_0\\| } \\biggr]\\leq\\exp\\bigl[-4{\\alpha}(5/8)^{\\alpha-1}r_n^2 \\bigr],\\end{aligned}\\ ] ] where to obtain the second last inequality we have used that for any @xmath629 and @xmath630 it holds @xmath631 . hence the expression in ( [ eqquotientprooflb ] ) is bounded above by @xmath632 by lemma  [ lemvol ] .",
    "the right - hand side is of smaller order than @xmath633 .",
    "an application of lemma  [ lemlb ] concludes the proof for the case that @xmath306 .    the proof in the case that @xmath288 follows the same lines , except that we use the inequality @xmath634 , for every @xmath635 , without the factor @xmath636 that is necessary if @xmath296 .",
    "we define @xmath637 .",
    "the authors would like to thank subhashis ghosal for suggesting a simplified argument in the proof of proposition  [ propositiondimension ] ."
  ],
  "abstract_text": [
    "<S> we consider full bayesian inference in the multivariate normal mean model in the situation that the mean vector is sparse . </S>",
    "<S> the prior distribution on the vector of means is constructed hierarchically by first choosing a collection of nonzero means and next a prior on the nonzero values . </S>",
    "<S> we consider the posterior distribution in the frequentist set - up that the observations are generated according to a fixed mean vector , and are interested in the posterior distribution of the number of nonzero components and the contraction of the posterior distribution to the true mean vector . </S>",
    "<S> we find various combinations of priors on the number of nonzero coefficients and on these coefficients that give desirable performance . </S>",
    "<S> we also find priors that give suboptimal convergence , for instance , gaussian priors on the nonzero coefficients . </S>",
    "<S> we illustrate the results by simulations . </S>"
  ]
}