{
  "article_text": [
    "probabilistic latent component analysis ( plca ) is a straightforward extension of probabilistic latent semantic indexing @xcite which deals with an arbitrary number of dimensions and can exhibit various features such as sparsity or shift - invariance .",
    "the basic model is defined as    @xmath2    where @xmath3 is an @xmath4-dimensional distribution of the random variable @xmath5 , @xmath6 is a latent variable and the @xmath7 are one dimensional distributions with @xmath8 .",
    "such a general model has been successfully applied to audio signals , with a theoretical framework developed by @xcite .",
    "especially , plca has been proven to be an efficient probabilistic tool for non - negative data analysis , which offers a convenient way of designing spectrogram models . from its general formulation ( eq . [ geneplca ] ) , and considering a spectrogram @xmath9 as a probability distribution @xmath10 , a latent variable @xmath6 is introduced to model @xmath10 as    @xmath11    where @xmath12 and @xmath13 represent respectively frequency and time , and are both conditionally independent given @xmath6 , @xmath14 are the spectral bases corresponding to component @xmath6 , and @xmath15 their time activations . since there is usually no closed - form solution for the maximization of the log - likelihood or the posterior , iterative update rules based on the expectation - maximization ( em ) algorithm",
    "are employed to estimate @xmath14 and @xmath15 .",
    "the major limitation of current plca models lies in the inherent problems of the em algorithm .",
    "this algorithm was originally introduced by @xcite to overcome the difficulties in maximizing likelihoods of missing data models .",
    "the main advantage of that method is its easy implementation , consisting of initializing the parameters and iterating expectation and maximization likelihoods in a step - by - step process until convergence .",
    "its major drawback , besides the requirement of convex likelihoods , lies in its sensitivity to initialization , which increase the risks to local convergences @xcite .",
    "that issue is exacerbated in the case of multimodal likelihoods .",
    "indeed , the increase of the likelihood function at each step of the algorithm ensures its convergence to the maximum likelihood estimator in the case of unimodal likelihoods , but implies a dependence on initial conditions for multimodal likelihoods .",
    "alternative techniques have also been proposed to optimize the search of global maxima , such as running the algorithm a number of times with different , random starting points , or using variants from the basic em algorithm such as deterministic annealing em ( daem ) algorithm @xcite .",
    "these theoretical issues have reached research fields working on audio signals . to tackle the problem of dependency to initialization",
    ", some authors @xcite perform a training of the instrument templates , which has proved to be an effective way to initialise the spectral bases .",
    "indeed , by fixing them without data - driven updating , we obtain a stable output for the gain function , independent of its initialisation .",
    "however , when the model becomes more complex with for example the introduction of different instrument variables , performing robust initialization is more difficult . for what concerns the local convergence problem , some works @xcite have used the daem algorithm based on a temperature parameter .",
    "this limitation becomes particularly critical when integrating priors into the plca framework .",
    "generally speaking , this integration introduces generic problems in optimization convergence to global maxima , especially when the prior has a multi - modality form .",
    "indeed , when a prior is injected , the maximization step becomes a maximum a posteriori step and the log posterior probability needs to have the right properties for maximization .",
    "@xcite used of a numerical fixed point algorithm to solve the modified em equations with a sparsity prior , whose convergence is only theoretically supposed , but `` observed in practice '' ( although the sensitivity of the algorithm convergence to the evaluation sound dataset is not detailed ) . @xcite privileged the use of pre - defined templates , which allows them to skip computing the em update equation of templates , and just to apply a sparsity constraint on the pitch activity matrix and the pitch - wise source contribution matrix .",
    "also , the simultaneous use of several priors on a same model parameter leads to some difficulties in terms of mathematical calculation and increases convergence problems @xcite .      in the framework of bayesian variable selection , markov chain monte carlo , or particle filtering ( pf ) ,",
    "type approaches have been proposed @xcite .",
    "these methods consist in sampling the posterior distribution over larger parameter ranges , making them more demanding than their em - like counterparts , but which also , in return , offer increased robustness in convergence ( i.e. reduced problems of convergence to local minima ) and a complete monte carlo description of this parameter posterior density @xcite .      many problems in statistical signal processing @xcite can be stated in a state space form as follows ,    @xmath16    @xmath17    where @xmath18 are unobserved states of the system and @xmath19 are observations made over some time , @xmath13 . @xmath20 and @xmath21 are pre - specified state evolution and observation densities . a primary concern in many state - space inference problems is the sequential estimation of the filtering distribution @xmath22 , and the simulation of the entire smoothing distribution @xmath23 , where @xmath24 and @xmath25 .",
    "updating of the filtering distribution can be achieved , in principle , using the standard filtering recursions @xcite    @xmath26    @xmath27    smoothing can also be performed recursively backwards in time using the smoothing formula @xcite    @xmath28    in practice , these filtering ( eq . [ filt ] ) and smoothing ( eq .",
    "[ smooth ] ) computations can only be performed in closed form for linear gaussian models using the kalman filter / smoother , and for finite state - space hidden markov models . in the case of non - linear non - gaussian models , there is no general analytic expression for the computations of these density functions . as a consequence",
    ", an approximation strategy is required to estimate the filtering and smoothing densities , which is commonly performed with the pf method , also known as sequential monte carlo methods . within the pf framework ,",
    "the filtering distribution is approximated with an empirical distribution formed from point masses also called particles ,    @xmath29    @xmath30    where @xmath31 is the dirac delta function and @xmath32 is a weight attached to particle @xmath33 .",
    "given this particle approximation to the posterior distribution , we can estimate the expected value of any function @xmath12 @xmath34 the distribution @xmath35 , defined as @xmath36 , using the following monte carlo approximation    @xmath37    particle smoothers generate batched realisations of @xmath38 based on the forward pf results . in other words , the particle smoothers are an efficient method for generating realisations from the entire smoothing density @xmath38 using filtering approximation .",
    "we consider the filtering distribution @xmath22 .",
    "using the bayes rule , this distribution can be rewritten as follows ,    @xmath39    assuming that a particle approximation to @xmath40 has already been generated ,    @xmath41    then , assuming that @xmath42 and @xmath43 can be evaluated pointwise , we generate , for each state trajectory @xmath44 , a random sample from a proposal distribution @xmath45 .",
    "then , the weights @xmath46 of the filtering distribution ( eq . [ approxpf ] ) can be approximated by    @xmath47    finally , we perform a multinomial resampling step , such that the probability that @xmath33 is selected is proportional to @xmath32 , to obtain an unweighted approximate random draw from the filtering distribution @xmath22 .",
    "it is noteworthy that if the resampling step is forgotten , a degeneracy phenomenon can occur . indeed , after a few iterations , all but one particle will have negligible weight .",
    "@xcite has shown that the variance of the importance weights can only increase over time , and thus , it is impossible to avoid the degeneracy phenomenon .",
    "this degeneracy implies that a large computational effort is devoted to updating particles whose contribution is almost zero . as a result",
    ", a resampling step is needed to eliminate particles with small weights and generate a new set @xmath48 , which is an i.i.d .",
    "( independent and identically distributed ) sample from the approximate density @xmath22 , with a resetting of the weights @xmath49 to @xmath50 .      the entire smoothing density @xmath38 can be factorized as :    @xmath51    using the filter approximation ( eq . [ approxpf ] ) to @xmath22 and the markovian assumptions of the model , we can write ,    @xmath52    with the modified weights    @xmath53    this revised particle distribution can be used to generate states successively in the reverse - time direction , conditioning upon future states .",
    "the main objective of this paper is to propose an alternative formulation of current plca models applied to audio signals , replacing the em algorithm by a more generic parameter estimation algorithm based on a pf method .",
    "we call this new algorithm plca - pf in the following .",
    "the main advantage expected from this new algorithm is to be able to scan the whole parameter space so as to take into account any features of the parameters , and thus overcoming the limitations underlined in our introduction specific to current plca models . in regards to prior integration",
    "particularly , this new framework allows releasing the constraints on prior mathematical forms and number .",
    "this paves the way towards more complete modelings of the multi - faceted information carried by musical signals , covering both time ( e.g. tempo and rhythm ) and frequency ( e.g. note spectra and chords ) domains , and the different prior knowledge classes related to musicology , timbre and playing style .",
    "considering the equations [ geneplca ] - [ plcaaudio ] , the plca can be expressed as :    @xmath54    with :    * @xmath55 is a vector of @xmath56 latent components @xmath57 associated to a finite subset @xmath58 * @xmath59 is the time variable * @xmath60 is a vector of @xmath4 features @xmath61 where @xmath62    in this decomposition , @xmath63 can be seen as the activation distribution of the latent variable @xmath64 , @xmath65 as the weight of the variable @xmath66 conditionally to @xmath67 and @xmath68 as the @xmath4 features basis . + to estimate the set of parameters @xmath69 at each time @xmath59 , the model can be rearranged as a state space process @xmath70",
    "@xmath71    where @xmath12 is the transition state density function for @xmath72 defined above and @xmath73 the observation function of @xmath74 .        assuming that each latent variable @xmath75 is i.i.d , each marginal vector @xmath76 and @xmath65 can be independently estimated . recalling that at a given time @xmath13 , @xmath76 and @xmath65 represent distributions , dirichlet priors are injected to ensure that their elements belong to @xmath77 $ ] , as follows , @xmath78    @xmath79    @xmath80    where @xmath81 and @xmath82 are random variables representing the weight of each component of @xmath64 in @xmath76 and @xmath65",
    ". that injection leads to the following hierarchical model    @xmath83    with @xmath84 the new states defined by    @xmath85    @xmath86    where we have defined    @xmath87    @xmath88    with @xmath89 and @xmath90 are positive distributions .",
    "@xmath74 has been defined as a representation of @xmath91 at time @xmath13 . in that state space approach ,",
    "each component of @xmath74 is represented by the sum of the plca model and a white noise , @xmath92 ,    @xmath93    where @xmath94 . denoting @xmath95 the vector of components @xmath96",
    ", the observation density @xmath73 follows a normal distribution , i.e. @xmath97 .      to overcome limits of current music information retrieval systems , a practical engineering solution was to use computational techniques from statistics and digital signal processing allowing the insertion of prior knowledge from different scientific disciplines ( e.g. cognitive science , neuroscience , musicology , musical acoustics ) @xcite .",
    "such systems perform a process of reconciliation between the observed acoustic features and the predictions of an internal model of the data - producing entities in the environment .",
    "this approach is close to human experience , who perceive the sound in view of different hierarchical levels of prior knowledge , using a collection of global properties , such as musical genre , tempo , and orchestration , as well as more instrument specific properties , such as timbre .",
    "it has been widely applied in many music information retrieval tasks , such as genre recognition and automatic music transcription @xcite .    in mathematical terms , priors are used to sharpen up estimation of model parameters by emphasizing the most likely values in their distributions .",
    "this prior integration is performed during state generation , by re - weighting each particle value with a corresponding prior gain .",
    "adding prior knowledge on parameters @xmath72 leads up to sample from the posterior distribution ,    @xmath98    where @xmath99 identifies to the observation density @xmath73 and @xmath100 the prior knowledge . when the prior and the likelihood are conjugate , sampling from the posterior distribution is rather straightforward .",
    "when the posterior does not have a well known form , as it is the case in most real - life applications , computational statistics methods can be introduced to sample from the posterior .",
    "the metropolis - hasting algorithm @xcite , based on monte carlo methods , brings a powerful framework to tackle that issue .",
    "this algorithm is a random walk that uses an acceptance / rejection rule to converge to the specified target distribution , and proceeds as described in the algorithm [ algo_mh ] .",
    "draw a starting point @xmath101 , for which @xmath102 , from a starting distribution @xmath103 ;    sample a proposal @xmath104 from a jumping distribution at iteration @xmath105 , @xmath106 ;    calculate the ratio of densities ,    @xmath107    set    @xmath108    considering the filtering particle framework defined above , few remarks about the different steps can be highlighted .",
    "first , the initial draw is replaced by the pf draw we want to interfere in . even if the posterior distribution is unknown ,",
    "the ratio @xmath109 can be computed as the ratio of the product of the likelihood and the prior since the normalization constant is removed in the ratio .",
    "@xmath110    the jumping distribution @xmath111 is chosen as a normal distribution to simplify the ratio computation .",
    "indeed , the symmetry property of the normal distribution involves that @xmath111 can be removed in eq .",
    "[ ratio_r ] , to get    @xmath112",
    "we now propose an application of our plca - pf framework to the task of automatic music transcription ( amt ) , and present evaluation results on this task with quantitative comparisons with other state - of - the - art methods .",
    "work on amt dates back more than 30 years , and has known numerous applications in the fields of music information retrieval , interactive computer systems , and automated musicological analysis @xcite . due to the difficulty in producing all the information required for a complete musical score , amt is commonly defined as the computer - assisted process of analyzing an acoustic musical signal so as to write down the musical parameters of the sounds that occur in it , which are basically the pitch , onset time , and duration of each sound to be played .",
    "this task of  low - level \" transcription , to which we will restrict ourselves in this study , has interested more and more researchers from different fields ( e.g. library science , musicology , machine learning , cognition ) , and been a very competitive task in the music information retrieval community @xcite since 2000 . despite this large enthusiasm for amt challenges , and several audio - to - midi converters available",
    "commercially , perfect polyphonic amt systems are out of reach of today s technology @xcite .",
    "to overcome these limitations , a practical engineering solution was to use computational techniques from statistics and digital signal processing allowing the insertion of prior knowledge from cognitive science , musicology and musical acoustics @xcite .",
    "this approach is close to human experience , in which the perception of sounds is embedded with prior knowledge , using a collection of global properties such as musical genre , tempo , and orchestration , as well as more specific properties , such as the timbre of a particular instrument .        in the audio framework ,",
    "plca views the input magnitude spectrogram of a sound source as a histogram of  sound quanta \" across time and frequency , and modeling it as as a linear combination of spectral vectors from a dictionary @xcite .",
    "plca method is then based on the assumption that a suitably normalized magnitude spectrogram , v , can be modeled as a joint distribution over time and frequency , @xmath10 , with f is the log - frequency index and t the time index .",
    "this quantity can be factored into a frame probability @xmath113 , which can be computed directly from the observed data ( i.e. energy spectrogram ) , and a conditional distribution over frequency bins @xmath114 , as follows    @xmath115    spectrogram frames are then treated as repeated draws from an underlying random process characterized by @xmath114 .",
    "we can model this distribution with a mixture of latent factors related to polyphonic music transcription of single instruments as follows :    @xmath116    where @xmath117 are the spectral templates for pitch @xmath118 ( with * i * the set of pitches , and @xmath119 the number of pitches ) and playing mode @xmath120 ( with * m * the set of playing modes , and @xmath121 the number of modes ) , @xmath122 is the playing mode activation , and @xmath123 is the pitch activation ( i.e. the transcription ) . in this paper ,",
    "the playing mode m will refer to different dynamics of instrument playing ( i.e. note loudness ) .",
    "@xcite extended the plca model of eq .",
    "[ eqplca ] by exploiting the fact that in a cqt , a change of fundamental frequency is reflected by a simple frequency translation of its partials , resulting in a shift invariance over log - frequency .",
    "the model proposed , called shift - invariant plca ( siplca ) , then consists in shifting the templates @xmath117 over the log - frequency range of the cqt , thus performing a multi - pitch detection with a frequency resolution higher than midi scale .",
    "[ eqplca ] is re - written as follows    @xmath124    where @xmath125 is the pitch shifting factor . to constrain @xmath125 so that each sound state template is associated with a single pitch",
    ", the shifting occurs in a semitone range around the ideal position of each pitch .",
    "thus because we are using in this paper a log - frequency representation with a spectral resolution of 60 bins / octave , i.e. a 20 cent resolution , we have @xmath125 @xmath126 [ -2:2 ] , with @xmath127 the length of this set of values .    @xmath128    in eq .",
    "[ eq_siplca_pfarg ] , we also identify the different pf arguments , where at a given time @xmath13 , @xmath129 is a vector of length @xmath119 representing the elements of the pitch activity matrix @xmath130 ( equal to @xmath131 , through the baye s rule ) , @xmath132 is the @xmath133 matrix whose coefficients are the weights @xmath134 , and @xmath135 is the @xmath136 tensor corresponding to the spectral weights coefficients @xmath137 .",
    "the spectral shifted templates @xmath138 are extracted from isolated note samples using a one component plca , and are not updated .",
    "eventually , as in most spectrogram factorization - based transcription or pitch tracking methods @xcite , we use a simple threshold - based detection of the note activations from the pitch activity matrix @xmath130 , followed by a minimum duration pruning . the threshold for minimum duration for pruning",
    "was set to 50 ms .",
    "the use of this simple thresholding method should allow one to better highlight the intrinsic differences from the different amt systems we will compare .",
    "since , the spectral shifted templates @xmath138 are learned , the set of unknown parameters is @xmath139 , and @xmath140^f$ ] denotes the observations . as described in [ transidensity ] , each marginal vector @xmath141 , @xmath142 and @xmath143 are independently forecasted through a dirichlet distribution , as follows    @xmath144    @xmath145    @xmath146    concerning the @xmath89 , @xmath147 and @xmath148 distributions producing the states @xmath149 , we opt for a gamma distribution to obtain a non biased transition and to control the variance of the transition .",
    "that choice leads to the following transition rules where @xmath150 ,    @xmath151    @xmath152    @xmath153    with hyperparameters @xmath154 , @xmath155 , @xmath156 , @xmath157 , @xmath158 and @xmath159 . conditionally to @xmath160 and @xmath161    @xmath162    @xmath163    @xmath164    recalling that the mean of @xmath165 is @xmath166 , a non biased transition for @xmath81 involves that @xmath167 since @xmath168 is expected .",
    "under the same argument , @xmath169 and @xmath170 .",
    "figure [ mpeallgraphs ] provides an example of piano - roll transcription output obtained with our pf - plca system .",
    "a musical signal is highly structured , in both time and frequency domains . in time domain , tempo and beat specify the range of likely note transition times . in the frequency domain , as audio signals are both additive and oscillatory ( musical objects in polyphonic music superimpose and not conceal each other ) , several notes played at the same time form chords , or polyphony , merging their respective spectral structures .",
    "when designing priors for an amt system , one basically aims to help the system figuring out `` which notes are present at time t '' and `` by which ones they will be followed '' .",
    "these two types of information belong respectively to frame - wise spectral priors ( e.g. sparseness , spectrum modeling including inharmonicity @xcite ) and to frame - to - frame temporal priors ( e.g. harmonic content transitions , smoothing of spectrum envelop ) , and will both be developed into our plca - pf framework .    in transcription systems with a general application @xcite , prior knowledge",
    "is generally incorporated with no regard to their musical / physical sense , but with the sole preoccupation of convergence optimization and enhancement of transcription results on a specific musical corpus . as a consequence",
    ", priors mostly take the form of a single constant factor , set arbitrarily after simulation experiments . here , we propose a more complex modeling of musical signal with explicit music - related knowledge .    to do so , we quantify relations of influence between the different pitches of the instrument pitch range , either within a frame ( for spectral priors ) , or from one frame to the next one ( for temporal priors ) .",
    "these priors will then take the form of a matrix s of size @xmath171 , which quantifies average relations of influence between the @xmath172 couples of different pitches , and is defined as follows , @xmath173 ,    @xmath174    the plca - pf framework allows a general insertion of this matrix through the term @xmath100 of eq .",
    "[ priorcomput ] , to which we can give the following form    @xmath175    where @xmath176 , @xmath177 , and @xmath178 is a vector of length @xmath119 associated to @xmath72 .",
    "it is noteworthy that simpler modeling of prior knowledge , such as a simple pitch - dependent vector , can also take the form of a diagonal matrix s of size @xmath171 , with the vector values put into this diagonal ( the zero - coefficients of s provide an unitary prior value which does not affect particle weights ) .      during the multi - pitch estimation step of an amt process",
    ", a too much large number of non - zero activation scores is often observed , making the operation of  finding the right notes \" more difficult . in order to overcome this flaw",
    ", a sparseness prior can reduce the number of active notes per frame in selecting the most salient ones .",
    "previous works mostly use pitch - independent sparse prior in plca - em algorithms .",
    "@xcite compute a sparseness prior @xmath179 to constrain the impulse distribution @xmath129 , as follows    @xmath180    with @xmath181 and @xmath182 a positive hyperparameter indicating the strength of the prior . with this",
    "prior , a numerical fixed point algorithm is required to obtain a solution with the em algorithm .",
    "other works @xcite impose sparsity on the pitch activity matrix and the pitch - wise source contribution matrix by modifying em equations .    the common point to all these em - based sparse priors",
    "is that they are pitch - independent , and rely on hyper - parameters , which are either arbitrary set and/or optimized on a given sound dataset . in this paper , we define sparse priors informed by explicit musical acoustics related knowledge .",
    "musically , the occurrence of simultaneous notes can result either from  acoustic polyphony \" , or from  musical polyphony `` . ' ' acoustics polyphony \" is strongly related to the timbre of the instrument , and more precisely to the physical phenomena of mutual resonances and note persistence .",
    "although this type of polyphony is an integral part of instrument timbre , it represents a noise signal added to the actual played note from the point of view of music transcription . for what concerns  musical polyphony \" , it corresponds to the note combinations played by the musician and intended by a composer with a proper polyphonic writing .",
    "it directly provides useful information about which notes are commonly played simultaneously in a musical piece .",
    "prior knowledge can be learned from both of these polyphonic origins for an instrument repertoire , studying respectively the timbre of the instrument or the frame - wise musical characteristics of the repertoire .    a first sparse prior @xmath183 on note mixture likelihood",
    "has then been defined .",
    "following the form of matrix s ( eq . [ symp ] ) , each coefficient is computed by a frame - wise counting of the pitches j played simultaneously to pitch i , from our training midi transcripts ( see sec .",
    "[ sounddata ] for details on the sound database ) .",
    "we propose a second sparse prior @xmath184 on mutual resonances . for strings on a bowed , plucked , or hammered instruments ,",
    "mutual resonances result from sympathetic strings , which vibrate ( and thereby sound a note ) in sympathetic resonance with the note sounded near them by some other agent . here , to compute each coefficient @xmath185",
    ", we used two datasets of isolated notes , a first one composed of free - resonating notes , and a second one in which all strings were muted excepting the played one .",
    "for each note sample of these two datasets , the spectrum was computed with a fft using a 4096-sample hamming window after the onset , unitary normalized and labelled @xmath186 for pitch i and dataset d ( equal to 1 or 2 ) .",
    "we then used the algorithm [ algosij ] to get the scores s(i , j ) .",
    "@xmath187 = @xmath188    binary thresholding of @xmath187 , i.e.    @xmath189    s(i , j ) = @xmath190 , with [ @xmath191 the element - wise product    these two priors @xmath192 and @xmath193 are represented in figure [ allpriormatrices ] through their respective matrices @xmath194 and @xmath195 . eventually , for this sparse type prior , the set of prior parameters @xmath72 in eq .",
    "[ symprior ] is equal to @xmath129 and @xmath178 is set to @xmath129 , which becomes    @xmath196    for prior @xmath183 , before injecting it in eq .",
    "[ pspa ] , we normalized its matrix @xmath197 with the operator @xmath198 ( eq . [ eqpi ] ) defined as    @xmath199    as we need knowledge rejecting the hypothesis of certain pitch combinations .",
    "many previous works @xcite on amt have used sequential priors to model each pitch activity / inactivity phases , which is done using two - state on / off hmms for each of them during a post - processing stage .",
    "this operation performs a time filtering of note detection decision , which mainly avoids a lot of single miss errors and smooths note boundaries . but musically , the information is very restricted , as it consists only in knowing how long a given pitch note remains active , which can result from both playing techniques of the musician and vibratory properties of the instrument .",
    "the sequential prior we present in this paper is defined as the probability to switch between two successive mixtures of notes in a musical piece .",
    "these transition probabilities are determined by sampling the training midi transcripts at the precise times corresponding to the analysis frames of the activation matrix , and just checking for the presence of a note in each frame .",
    "these probabilities give us a global view of the usual and unusual harmonic transitions of an instrument repertoire .",
    "original mixtures , i.e. those not encountered during the training phase , get a likelihood weighted accordingly to the witten - bell discounting algorithm @xcite .",
    "this prior @xmath200 is represented in figure [ allpriormatrices ] through their matrix @xmath201 . eventually , for this sequential type prior , @xmath72 in eq .",
    "[ symprior ] is equal to @xmath129 and @xmath178 is set to @xmath202 , which leads to    @xmath203      the plca - pf framework offers an easy - to - implement unifying way of integrating priors from both time and frequency domains . in this framework , priors are injected during the filtering process through eq .",
    "[ priorcomput ] , and modify the parameters without disturbing their generation . in the set of parameters @xmath72 , the independence between each parameter @xmath204 leads to    @xmath205    within a defined parameter @xmath204 , the general prior @xmath206 can be seen as the product of the different priors @xmath207 associated to @xmath204 @xmath208    using equations [ symprior ] , [ intra ] and [ inter ] , we combine the different priors , characterized by their respective matrices @xmath209 , as follows    @xmath210      as a time - frequency representation , all input signals sampled undergo a q - constant with 60 bins / octave , with window size of 23 ms ( 1024 coefficients at 44.1-khz sampling rate ) and a 50 % hop , which is adequate for the tonal part of the signal .",
    "we now present the different algorithms implemented in our pf framework .      such as in @xcite",
    ", we develop a generic pf algorithm assuming that the proposal distribution @xmath211 , as detailed in the pseudo - algorithm [ genpf ] .",
    "the resample step is processed as detailed in the pseudo - algorithm [ resampalgo ] .",
    "let @xmath212 be state prior distribution .",
    "then for @xmath213 to @xmath214 :    @xmath215 , generate @xmath216 samples from the proposal @xmath211 ,    @xmath217    @xmath215 , evaluate the importance weights and normalise    @xmath218    resample @xmath219 @xmath216 times with replacement .",
    "initialize the cdf : @xmath220 @xmath221    * construct cdf : @xmath222    start at the bottom of the cdf : @xmath223 draw a starting point : @xmath224 $ ] @xmath225    * move along the cdf : @xmath226 * while @xmath227 , @xmath228 * assign sample : @xmath229 * assign weight : @xmath230    return @xmath231 .",
    "after having generated weighted particles @xmath232 from the pf , the smoothing algorithm proceeds as detailed in the pseudo - algorithm [ smoothalgo ] .",
    "choose @xmath233 with probability @xmath234 .",
    "for @xmath235 to 1 :    * calculate @xmath236 for each @xmath237 ; * choose @xmath238 with probability @xmath239 .",
    "@xmath240 is an approximate realisation from @xmath38 .        to evaluate comparatively transcription performance of our plca - pf algorithm , we tested different algorithms on the same test datasound .",
    "table [ recmpealgos ] provides an overview of these algorithms .",
    "halca is short for the harmonic adaptive latent component analysis algorithm @xcite . here",
    ", each note in a constant - q transform is locally modeled as a weighted sum of fixed narrowband harmonic spectra , spectrally convolved with some impulse that defines the pitch .",
    "all parameters are estimated by means of the em algorithm , in the plca framework .",
    "this algorithm was recently evaluated by mirex and obtained the @xmath241 best score ( * ? ? ?",
    "* @xmath241 best scores in the multi - pitch estimation task , 2009 - 2012 ) .",
    "the algorithm plca - em is the algorithm proposed by @xcite , whose main characteristics is its use of pre - defined templates , allowing them to avoid updating the templates in the maximization step of the em algorithm .",
    "this algorithm is also state - of - the - art ( * ? ? ?",
    "* @xmath242 best scores in the multi - pitch estimation task , 2009 - 2012 ) .",
    "plca - daem is the same as plca - em , only replacing the em algorithm by a daem algorithm .",
    "@xcite observed significant improvements on their transcriptions through this modification .      to test our amt system and train the sparse priors proposed ,",
    "we need three different sound corpus : audio musical pieces of an instrument repertoire , the corresponding scores in the form of midi files , and a complete dataset of isolated notes for this instrument .",
    "we will use two different decay instruments for evaluation , namely the classical piano and the _ marovany _ zither from madagascar . for piano",
    ", audio data was extracted from the maps database @xcite , which is composed of high - quality note samples and recordings from a real upright piano , whose midi scores have been automatically compiled using the disklavier technology . for the marovany instrument",
    ", sound templates and musical pieces were extracted from personal recordings made in our laboratory .",
    "pieces were transcribed with an original multi - sensor retrieval system @xcite .    from these sound databases , we extracted different sets of training and test data , as our prior must be trained using automatically generated knowledge from midi files and template datasets . to do so , we first divided each musical pieces into 15-second sequences , which provided us with a total of 1.2 and 0.83 hours of audio , respectively for the piano and marovany datasets . within each dataset ,",
    "the musical sequences were randomly split into training and testing sequences , using by default 30 % of sequences for testing , and the 70% remaining ones for training . in our simulation experiments , this procedure is repeated five times , and an average is computed on the resulting scores . to prevent any overfitting of our data",
    ", we carefully distinguished between training and test data .",
    "especially , sound templates used in the plca model were extracted from an instrument model different from the one used in recordings .",
    "also , sequences used to train the priors were not used for evaluation .      for assessing the performance of our proposed transcription system ,",
    "we adopt a note - oriented approach , according to which a note event is assumed to be correct if it fills the condition that its onset is within a 50 ms range from a ground - truth onset ( i.e. the standard tolerance commonly used @xcite ) .",
    "such a tolerance level is considered to be a fair margin for an accurate transcription , although it is far more tolerant than human ears would , as we remind that those are able to distinguish between two onsets as close as 10 ms apart @xcite .",
    "evaluation metrics are defined by equations [ metr1]-[metr4 ] @xcite , resulting in the note - based recall ( tpr ) , precision ( ppv ) and f - measure ( the harmonic mean of precision and recall ) :    @xmath243}}{\\sum_{n=1}^n { \\text{tp}[n ] + \\text{fn}[n]}}\\ ] ]    @xmath244}}{\\sum_{n=1}^n { \\text{tp}[n ] + \\text{fp}[n]}}\\ ] ]    @xmath245    where n is the total number of notes , and tp , fp and fn scores stand for the well - known true positive , false positive and false negative detections .",
    "the recall is the ratio between the number of relevant and original items ; the precision is the ratio between the number of relevant and detected items ; and the f - measure is the harmonic mean between precision and recall .",
    "for all these evaluation metrics , a value of 1 represents a perfect match between the estimated transcription and the reference one .",
    "we present in the following simulation experiments on parameter initialization dependency and transcription performance , comparing our proposed pf - based algorithm with three other state - of - the - art algorithms ( see table [ recmpealgos ] ) .",
    "figure [ computationaltimevsnberparticles ] shows the computational time of our plca - pf system on a 15-s test musical sequence against the number of particles .",
    "both the computational time and transcription performance increase with the number of particles used .",
    "it is well - known that filtering particle is very demanding in computation time , which increases exponentially with the number of particles . in its current form ,",
    "our system is not very efficient computationally , as it produces a transcription in about 50 at real time on a pc computer ( e.g. , for a 15 sec recording it requires 12.5 mins ) with 2000 particles . increasing the number of particles also increases transcription accuracy , rising the average f - measure with gains as high as 14 @xmath0 between 10 and 1000 particles , which begins to stagnate after 5000 particles .",
    "this tendency remains observed regardless the instrument repertoire . a trade - off between computation time and transcription precision",
    "must then be considered .",
    "figure [ variancestranscriperfo ] compares dependency of transcription outputs on parameter initialization .",
    "these results are computed from 40 simulation trials on one test sequence with a randomized parameter initialization .",
    "black bars indicate the reference scores of each system , obtained with an uniform initialization of parameters , as it is commonly done by default ( e.g. ( * ? ? ?",
    "* paragraph v.a.1 ) ) .",
    "we observe that the proposed systems including filtering particle are globally more robust to parameter initialization , in comparison to other em or daem -based systems , which present an important variability in the average f - measure ( e.g. , @xmath246 the plca - em model for the _ marovany _ repertoire .",
    "then , depending on the sound dataset under evaluation , the set of initialization parameters may be sub - optimal , with performance losses rising as high as 5 @xmath0 in the average f - measure . in definitive , making amt systems less dependent on data should favour their generalization to the diversity of music .",
    "table [ resulttranscriperfos ] compares transcription performance of our different amt systems through the different error metrics , for the piano and the _ marovany _ repertoires , respectively .",
    "both of them present a complex polyphony structure .",
    "the _ marovany _ repertoire is characterized by fast arpeggios , with an ample halo - like sound with rich overtones due to the complex resonating behavior of the instrument .",
    "the classical piano repertoire presents more complex and richer chord transitions , with different playing techniques and dynamics which interfere continuously on the timbre of the instrument . for both of these repertoires ,",
    "the improvements brought by pf - based systems in transcription performance are likely related to the em limitations evoked in our introduction , which make em - based algorithms less efficient in finding active notes in complex polyphonic signals due to problems of local maxima convergences .",
    "also , information from standard deviations shows that our proposed algorithm presents the minimum value for the standard deviation ( 2.3 @xmath0 ) , which implies a higher robustness to transcribe polyphonic signals with different musical features .",
    "current plca - based systems for amt use the well - known em algorithm to estimate the model parameters .",
    "this algorithm presents well - known inherent defaults ( local convergence , initialization dependency ) , making em - based systems limited in their applications to amt , particularly in regards to the mathematical form and number of priors . to overcome such limits ,",
    "we have developed in this paper a different estimation framework based on particle filtering , which consists in sampling the posterior distribution over larger parameter ranges .",
    "this framework proves to be more robust in parameter estimation , more flexible and unifying in the integration of prior knowledge in the system .",
    "it provides the abilities of injecting more complex musicological knowledge , as well as combining simultaneously a theoretically infinite number of priors .",
    "our proposed particle - filtering systems achieve promising rankings in terms of accuracy rate , and further experimentations will be necessary to confirm these preliminary results .      at the risk of omitting some relevant names , the authors would like to especially thank march chemillier ( cams - ehess ) for his help in recording the _ marovany _ , and laurent quartier ( lam - upmc ) for technical supports .",
    "bello , j. p.and  sandler , m.b .",
    "( * 2000 * ) . ``",
    "blackboard systems and topdown processing for the transcription of simple polyphonic music . '' in _ proceedings of the international conference on digital audio effects ( dafx)_.    benetos , e. , cherla , s. , and weyde , t. ( * * 2013**a ) .",
    "`` an efficient shift - invariant model for polyphonic music transcription . '' in _ 6th int . workshop on machine learning and music , prague , czech republic_.        benetos , e. , dixon , s. , giannoulis , d. , kirchhoff , h. , and klapuri , a. ( * * 2013**b ) .",
    "`` automatic music transcription : challenges and future directions . '' j. of intelligent information systems , * 41 * , 407434 .",
    "cheng , t. , dixon , s. , and mauch , m. ( * 2013 * ) .",
    "`` a deterministic annealing algorithm for automatic music transcription . '' in _ 14th international society for music information retrieval conference , curitiba , pr , brazil_.      dessein , a. , cont , a. , and lemaitre , g. ( * 2010 * ) .",
    "`` real - time polyphonic music transcription with nonnegative matrix factorization and beta - divergence . '' in _ 11th international society for music information retrieval conference , utretcht , netherlands_. pp .",
    "489494 .",
    "emiya , v. , badeau , r. , and richard , g. ( * 2010 * ) .",
    "`` multipitch estimation of piano sounds using a new probabilistic spectral smoothness principle . ''",
    "ieee trans . on audio ,",
    "speech , lang .",
    "proc . , * 18 * , 16431654 .",
    "fvotte , c. , torrsani , b. , daudet , l. , and godsill , s. ( * 2008 * ) . `` sparse linear regression with structured priors and application to denoising of musical audio . ''",
    "ieee trans .",
    "audio speech language processing , * 16 * , 174185 .",
    "fuentes , b. , badeau , r. , and richard , g. ( * 2013 * ) . `` harmonic adaptive latent component analysis of audio and application to music transcription . ''",
    "ieee trans . on audio speech lang .",
    "processing , * 21 * , 18541866 .",
    "grindlay , g. and ellis , d.p.w .",
    "( * 2010 * ) . `` a probabilistic subspace model for multi - instrument polyphonic transcripton . '' in _",
    "11th international society for music information retrieval conference , utrecht , netherlands_.                      rigaud , f. , falaize , a. , david , b. , and daudet , l. ( * 2013 * ) .",
    "`` does inharmonicity improve an nmf - based piano transcription model ? '' in _ ieee international conference on acoustics , speech and signal processing ( icassp)_. pp . 1115 .",
    "smaragdis , p. , raj , b. , and shashanka , m. ( * 2008 * ) .",
    "`` sparse and shift - invariant feature extraction from non - negative data . '' in _ international conference acoustical speech and signal processing , las vegas , nv_. pp . 20692072 .",
    "vermaak , j. , andrieu , c. , and doucet , a. ( * 2000 * ) .",
    "`` particle filtering for non - stationary speech modelling and enhancement . '' in _ 6th international conference on spoken language processing_. pp .",
    "594597 .",
    "witten , i.h . and",
    "bell , t.c .",
    "( * 1991 * ) .",
    "`` the zero - frequency problem : estimating the probabilities of novel events in adaptive text compression . '' ieee transactions on information theory , * 37 * , 10851094 ."
  ],
  "abstract_text": [
    "<S> automatic music transcription ( amt ) consists in automatically estimating the notes in an audio recording , through three attributes : onset time , duration and pitch . </S>",
    "<S> probabilistic latent component analysis ( plca ) has become very popular for this task . </S>",
    "<S> plca is a spectrogram factorization method , able to model a magnitude spectrogram as a linear combination of spectral vectors from a dictionary . </S>",
    "<S> such methods use the expectation - maximization ( em ) algorithm to estimate the parameters of the acoustic model . </S>",
    "<S> this algorithm presents well - known inherent defaults ( local convergence , initialization dependency ) , making em - based systems limited in their applications to amt , particularly in regards to the mathematical form and number of priors . to overcome such limits , we propose in this paper to employ a different estimation framework based on particle filtering ( pf ) , which consists in sampling the posterior distribution over larger parameter ranges . </S>",
    "<S> this framework proves to be more robust in parameter estimation , more flexible and unifying in the integration of prior knowledge in the system . </S>",
    "<S> note - level transcription accuracies of 61.8 @xmath0 and 59.5 @xmath0 were achieved on evaluation sound datasets of two different instrument repertoires , including the classical piano ( from maps dataset ) and the marovany zither , and direct comparisons to previous plca - based approaches are provided . </S>",
    "<S> steps for further development are also outlined .    * particle filtering for plca model with application to music transcription *    cazau dorian@xmath1 , guillaume revillon@xmath1 , yuancheng wang@xmath1 and olivier adam@xmath1 +     + </S>"
  ]
}