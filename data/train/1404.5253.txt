{
  "article_text": [
    "it is well known that a sharp contrast exists today in the quantum - mechanical treatment of few- and many - body systems between very effective and fast bound - state calculations , on the one hand , and very time - consuming few - particle scattering calculations on the other hand .",
    "practical solutions for a discrete spectrum may incorporate many hundreds or even thousands particles with simple coulomb - like interactions in atomic or molecular physics , or up to 20 - 25 nucleons with complicated realistic @xmath1 interactions in nuclear physics , while even the solution of the four - nucleon scattering problem with realistic @xmath1-interactions , especially above the three - body breakup threshold , represent a strong challenge for modern theorists  @xcite",
    ". there are at least two reasons for such a strong contrast .",
    "first , the few - body scattering problem includes complicated boundary conditions , especially above the three- or four - body breakup thresholds , and second , the multi - particle hamiltonian has a degenerate continuous spectrum , so that each pair or triple of particles can be in infinite number of states at the same energy .",
    "the first problem has been solved mathematically by formulation of the faddeev ",
    "yakubovsky equations whose full solution satisfies , as has been strictly proved @xcite , all of the necessary boundary conditions . however , the price for this correct formulation is a very sophisticated form of these integral equations , whose kernels have complicated moving singularities .",
    "therefore , in the previous four decades a lot of exact and approximate methods for solving the faddeev ",
    "yakubovsky equations were proposed . however , due to the complexity of realistic few - body scattering problems , practical solutions usually require a massively parallel implementation , so that even now exact faddeev - like scattering calculations are performed mainly on powerful supercomputers ( see e.g. the recent @xmath2-calculations @xcite ) .",
    "the complexity of the few - body equations leads to the fact that an accurate numerical treatment for realistic few - body scattering problems remains available only to a limited number of experts .",
    "the most effective way to treat the second key problem related to degeneracy of few - body continuous spectra of the total and channel hamiltonians is their discretization by one or another method and usage of @xmath0 normalized states as approximations for exact continuum states . nowadays , many such discretization methods exist ( see , for example , a recent comprehensive review  @xcite ) .",
    "however , it is still not clear whether these particular discretization methods give a discrete form of scattering equations , which permit a high degree of parallelism in a numerical solution .",
    "the last point is crucially important for further progress in few - body scattering calculations because even powerful supercomputers can not give essential acceleration of the calculations if the solution method does not permit an effective parallelization for all parts of the algorithm .",
    "quite recently , a new computational technique has been introduced based on the general - purpose graphics processing unit ( gpgpu ) .",
    "this technique utilizes a graphics processing unit ( gpu ) which has been initially designed to carry out computations for computer graphics .",
    "nowadays , gpus are specialized to perform ultra - fast general purpose computations and they can replace a supercomputer realization in many particular cases . also , special extensions of standard programming languages are developed to use gpu facilities in tedious scientific calculations ( see e.g. @xcite ) .    this technique has been actively pursued and successfully used in quantum chemistry @xcite , in lattice qcd calculations @xcite , monte - carlo simulations etc .",
    "recently , _ ab - initio _ nuclear structure gpu - calculations @xcite have been performed as well as gpu treatments of faddeev equations for quantum trimer systems @xcite .",
    "it is of great interest to apply such gpu - techniques to realistic few - body scattering calculations .",
    "this would open new possibilities for accurate few - body studies in general and could make them more accessible to a wider number of researchers .",
    "however , the gpu realization requires an appropriate and specific formulation for scattering problems because this realization is most effective for the algorithms with a high degree of parallelism and minimal interdependence between data processing in parallel threads .",
    "the present authors suggested in previous years the wave - packet continuum discretization technique @xcite which has been tested carefully for the model @xmath1 interactions and found to be very efficient .",
    "one of the important features of the above discrete approach is that the resulting discretized form of the scattering equations is well suited for such a parallel realization .",
    "below we show that such a massively parallel implementation of the whole solution can be made on a standard pc with a modern graphics processor that can perform all of the calculations using many thousands of parallel threads .    in the present paper",
    "we have also made a generalization of the wave - packet approach to few - body equations with fully realistic @xmath1 interaction which is not a trivial problem and requires a new determination for the multi - channel resolvent in an analytical form .",
    "so we included a section with this description in the present paper .",
    "the paper is organized as follows . in sect .",
    "ii we summarize the main features of the wp approach and describe how it is used to solve three - body scattering problem . in sect .",
    "iii the case of the coupled - channel two - body input interaction is discussed and formulas for the three - body channel resolvent are given .",
    "the results for the @xmath3 elastic scattering problem are represented in sect .",
    "section v is dedicated to a description of our first gpu tests for the problem in question and a comparison of the corresponding computational efficiency of the cpu and gpu realizations on the same pc .",
    "the main results of the paper are summarized in the conclusion .",
    "the present work discusses the solution few- and many - body scattering problems in atomic , molecular , nuclear and hadronic physics .",
    "here we discuss in detail all of the steps needed to implement our new approach and we illustrate the whole technique using a non - trivial example  the solution of the faddeev equations for @xmath4 scattering below and above the three - body breakup threshold with a realistic @xmath1 interaction .      in our approach , we change all of the steps used in the conventional procedure for solving the faddeev equations in momentum space .",
    "\\(i ) the first step is to replace the conventional form of the faddeev integral equation , e.g. for a transition operator @xmath5 describing elastic @xmath3 scattering @xcite , @xmath6 with the half - shell equivalent form @xmath7 here @xmath8 is the two - body interaction , @xmath9 is the two - body @xmath10-matrix , @xmath11 is the resolvent of the free three - body hamiltonian , @xmath12 , @xmath13 is the particle permutation operator and @xmath14^{-1}$ ] is the resolvent of the channel hamiltonian @xmath15 where @xmath16 is the two - body @xmath1 sub - hamiltonian and @xmath17 is sub - hamiltonian describing free motion of the third nucleon relative to the @xmath1 subsystem .",
    "the index @xmath18 is the jacobi - set index of the initial state .",
    "one of the main purposes for such a replacement is to change the required two - body input : instead of fully off - shell two - body @xmath10-matrices at many energies , we suggest employing two - body interactions @xmath8 in combination with the channel resolvent @xmath19 .",
    "however , in such a replacement , one has to evaluate additionally the channel resolvent operator @xmath19 .",
    "fortunately , in the wave - packet approach , the finite - dimensional approximation for this operator is calculated easily in a closed analytical form @xcite .",
    "moreover , the whole energy dependence appears now in the channel resolvent operator ( rather than in the off - shell @xmath10-matrix , as in the conventional formulation ) , which is calculated explicitly .",
    "so that , with such a replacement , we can find a solution of few - body scattering equations _ at many energies almost with the same computational effort that is needed for a single energy_.    another important advantage of our approach is a new treatment of three - body breakup .",
    "contrary to the conventional approach , we treat three- or many - body breakup processes as particular cases of inelastic excitations ( into states of the discretized continuum ) @xcite .",
    "such a treatment strongly facilitates breakup calculations .",
    "\\(ii ) the second step is to project the integral kernels of the reformulated faddeev equations and the solution onto a special orthogonal basis of the stationary wave packets ( wps ) , which corresponds to a formulation of the scattering problem on a momentum lattice .",
    "such basis is very appropriate for constructing normalized analogs of continuum states for the channel hamiltonian @xmath20 .",
    "it follows that the solution of the three - body scattering problem is described in the terms of asymptotic channel states , in contrast to conventional approach which employs free three - body states ( the plane waves ) .",
    "such a projection of the three - body scattering equations onto a three - body wp basis results in matrix equations which allow us to circumvent the main difficulties that arise in the conventional solution of the initial singular integral equation .",
    "firstly , the use of a finite matrix for the permutation operator in a discrete wp basis eliminates the need for the very numerous multi - dimensional interpolations of a given solution into the `` rotated '' jacobi set during iterations .",
    "further , all singularities of the faddeev kernel ( in the form @xmath21 ) are isolated now in the channel resolvent @xmath22 and thus can be easily smoothed and averaged when using the wp representation @xcite . at last , the resulting matrix equations can be solved directly at real energies without any contour rotations or deformations onto complex plane , which are often employed in the solution of singular integral equations .",
    "the resulting matrix equation ( of high dimension ) obtained in the wp approach is solved by simple iterations when they converge or otherwise by applying an additional pade - approximant summation .",
    "the computational scheme turns out to be very efficient and thus the whole calculation can be performed even on a standard pc .",
    "following these steps , in our previous papers , @xcite , we studied elastic scattering and breakup cross sections in a @xmath2 system with a central @xmath1 potential .",
    "but it was still unclear if the advantages of the above computational scheme remain valid for realistic @xmath1 interactions including tensor , spin - orbit etc .",
    "components and in the particularly when the number of contributing spin - orbital partial channels is large . to investigate this question",
    "we will apply our approach to a three - nucleon system interacting with a realistic @xmath1 interaction , including a tensor component ( the nijmegen @xmath1 potential @xcite ) , at energies below and above three - body breakup threshold .",
    "\\(iii ) to further extend the complexity of scattering problems that can be treated accurately , it is desirable to develop a highly parallel algorithm for the solution of the resulting matrix equations of large dimension . _ the third step _ is to parallelize the algorithm to adapt it for computations by a gpu .",
    "such a gpu realization is shown in the present paper to make the solution of resulting matrix equations ( derived from multi - channel system of integral faddeev equations ) extremely fast even on a standard pc .",
    "here we briefly describe our approach based on a continuum discretization using the stationary wave packets .",
    "we illustrate this using the example of the faddeev equation ( [ ueq ] ) for the transition operator @xmath5 for @xmath3 scattering ( further details see in @xcite ) .      to construct the three - body wp basis functions , we start from the two - body case and introduce partitions of the continua of two free sub - hamiltonians , @xmath23 and @xmath17 , onto non - overlapping intervals @xmath24\\}_{i=1}^m$ ] and @xmath25\\}_{j=1}^n$ ] respectively .",
    "these sub - hamiltonians describe the free motion of particles 2 and 3 with relative momentum @xmath26 and the free motion of particle 1 with momentum @xmath27 relative to the center of mass of the pair ( 23 ) , respectively .",
    "thus the free stationary wave packets @xmath28 and @xmath29 are built as integrals of free solutions @xmath30 and @xmath31 over the discretization bins :    @xmath32    where @xmath33 and @xmath34 are normalization factors and weight functions respectively @xcite . here and below we denote the functions and values corresponding to @xmath27-variable with additional bar mark to distinguish them from the functions corresponding to the @xmath26-variable .    when constructing the three - body wp basis one should take into account spin and angular parts of the basis functions .",
    "we use the following quantum numbers for the subsystems and the whole three - body system according to the @xmath35-coupling scheme : @xmath36 where @xmath37 and @xmath38 are @xmath1 quantum numbers : @xmath39 is an orbital momentum , @xmath40 is a spin and @xmath41 is a total angular momentum of the subsystem ( the interaction potential depends on the value of @xmath38 ) .",
    "the other quantum numbers are the following : @xmath42 is an orbital momentum and @xmath43 is a total momentum of the third nucleon , where @xmath44 is its spin .",
    "finally , @xmath45 is a total angular momentum of the three - body system , @xmath46 is the total isospin and @xmath47 is parity , all of them are conserved .",
    "let s also note that the pair isospin @xmath10 can be defined by values of @xmath39 and @xmath40 , because the sum @xmath48 must be odd .",
    "the free wp states should be defined for each partial wave @xmath39 and @xmath49 and further they are multiplied by appropriate spin - angular states .",
    "thus the three - body basis function can be written as : latexmath:[\\[\\label{xij }     spin - angular state of the @xmath1 pair , @xmath51 is a spin - angular state of the third nucleon , and @xmath52 is a set of three - body quantum numbers .",
    "the state ( [ xij ] ) is the wp analog of the exact plane wave state in three - body continuum @xmath53 for the three - body free hamiltonian @xmath54 .",
    "the free stationary wave packets defined in eq .",
    "( [ pq ] ) with unit weights are step - like functions in the momentum representation @xcite while the three - body free wp basis functions are constant inside the cells of the lattice built by a convolution of two one - dimensional cells @xmath55 and @xmath56 .",
    "we refer to the free wp basis as _ a lattice _ basis .",
    "we denote the two - dimensional bins ( i.e. the lattice cells ) by @xmath57 .      in the case of a single - channel two - body input interaction (",
    "e.g. the central one ) , we have demonstrated @xcite that it is possible to define _ scattering wps _ corresponding to the exact scattering wave functions @xmath58 of the sub - hamiltonian @xmath59 : @xmath60 are partition intervals and @xmath61 and @xmath62 are a normalization factor and a weight function .    to use the states ( [ z_k ] ) practically",
    ", one can approximate them with the pseudostates of the sub - hamiltonian @xmath59 in some @xmath0 basis @xcite .",
    "also it has been shown that the free wp basis is very appropriate to approximate scattering states because the respective functions have a very long - range behavior in configuration space .",
    "so we can calculate the eigenstates ( the bound and pseudostates ) of the sub - hamiltonian @xmath59 matrix in the two - body wp - basis @xmath63 via a diagonalization procedure . as a result one",
    "gets the eigenstates of the @xmath59 sub - hamiltonian expanded in the free wp basis ( for each partial wave @xmath39 ) :    @xmath64    for the case of a central interaction , the three - body quantum numbers for the channel hamiltonian @xmath20 are the same as those for the three - body free hamiltonian @xmath12 , so that total three - body wp states corresponding to the channel hamiltonian @xmath20 ( three - body scattering wave packets  swp ) are built as direct products of the two - body wps with the same spin - angular quantum numbers @xmath65 : @xmath66 the main advantage of the basis constructed from swp ( [ 3swp ] ) is that one gets _",
    "an explicit analytical _ and even _ diagonal form _ for the matrix of three - body channel resolvent @xmath19 @xcite .",
    "having the wp basis for the channel - hamiltonian ( [ 3swp ] ) at our disposal , it is possible to project all of the constituents of the integral equation ( [ ueq ] ) and find its finite - dimensional , i.e. matrix , analog . as an important result of the projecting of the channel operator @xmath67 onto the swp - basis , one gets the main part of the faddeev kernel matrix in a convenient analytical form , with a completely analytical energy dependence , in sharp contrast to a conventional approach with a fully off - shell @xmath10-matrix in a numerical form .",
    "the permutation operator matrix @xmath68 in the three - body swp basis @xmath69 can be expressed through the overlap matrix @xmath70 in the free wp basis @xmath71 using the rotation matrices @xmath72 from the expansion ( [ exp_z ] ) : @xmath73    a matrix element of the operator @xmath74 in the free wp basis is equal to the overlap between basis functions defined in different jacobi sets .",
    "such a matrix element can be calculated by integration with the basis functions over the momentum lattice cells : @xmath75 where the prime on the lattice cell @xmath76 indicates that the cell belongs to the other jacobi set while @xmath77 is the kernel of particle permutation operator in momentum space .",
    "this kernel , as is well known @xcite , is proportional to the product of a dirac delta and a heaviside theta function .",
    "however , due to integration in the eq .",
    "( [ perm ] ) , these singularities get averaged over the momentum lattice cells and , as a result , the elements of the permutation operator matrix in the wp basis are finite and regular .    the matrix element in the eq .",
    "( [ perm ] ) can be calculated using a double numerical integration .",
    "the practical technique of such calculation is described in the appendix to the present paper .",
    "having evaluated the matrix of permutation operator @xmath74 , the calculation of the kernel @xmath21 matrix becomes fast and straightforward .    as a result of projecting the integral equation ( [ ueq ] ) onto the three - body swp basis ,",
    "one gets its matrix analog ( for the each set of three - body quantum numbers @xmath78 ) : @xmath79 here @xmath80 , @xmath81 and @xmath82 are matrices of the permutation operator , the pair interaction and the channel resolvent respectively defined in the swp basis .",
    "the on - shell elastic amplitude for the @xmath3 scattering in the wp representation is defined by a diagonal matrix element of the @xmath83-matrix @xcite : @xmath84 where @xmath85 is the nucleon mass , @xmath86 is the initial two - body momentum and @xmath87 is the swp basis state corresponding to the initial scattering state . here",
    "@xmath88 is the bound state of the pair ( the deuteron , in our case ) , the index @xmath89 denotes the bin @xmath90 , including the on - shell momentum @xmath86 , and @xmath91 is the momentum width of this bin .    it should be noted here that in our discrete wp approach _ the three - body breakup is treated as a particular case of an inelastic scattering _",
    "@xcite ( defined by the transitions to the specific two - body discretized continuum states ) , so that the breakup amplitude can be defined in terms of _ the same matrix _",
    "@xmath83 determined from eq .",
    "( [ m_pvg ] ) .    for the case of the tensor components of the @xmath1 interaction ( or other coupled - channel two - body interactions @xmath8 ) , the generalization of the whole formalism is straightforward .",
    "however , it is necessary to take into account some new aspects related to the discretized spectrum of the two - body _ multichannel _ hamiltonian @xmath59 to build the correct approximation for the discretized resolvent @xmath19 .",
    "the three - body swp states corresponding to the channel hamiltonian @xmath20 can be defined similarly to the one - channel two - body interaction case , i.e. as direct products of two - body wp states for the @xmath17 and @xmath59 sub - hamiltonians ( jointly with the bound - state ) multiplied by spin - angular functions of the system .",
    "however , here the possible spin - angular couplings in the @xmath92 subsystem due to the tensor component in a pairwise interaction @xmath8 should be taken into account .",
    "recently , the present authors have developed a convenient approach for solving multichannel scattering problems via a straightforward diagonalization of the multichannel hamiltonian in a wp basis  the discrete spectral - shift ( dss ) formalism @xcite . in this approach ,",
    "the multichannel hamiltonian pseudostates have been shown to correspond to scattering wave functions defined in the so called eigenchannel representation ( er ) @xcite for which the multichannel @xmath93-matrix is diagonal .",
    "let s introduce two types of scattering states of the sub - hamiltonian @xmath59 : the scattering states @xmath94 ( which include radial and orbital parts ) corresponding to the initial wave with a definite orbital momentum @xmath39 and the scattering states defined in the er @xmath95 , where @xmath96 is an eigenchannel index . in case of a tensor @xmath1 interaction , the scattering states @xmath95",
    "are linear combinations of states @xmath94 , e.g. the coupled pairs @xmath97 , @xmath98 etc .",
    "the main advantage of the er formalism is that one gets the following spectral expansion for the resolvent of the pair sub - hamiltonian @xmath99^{-1}$ ] ( see e.g. @xcite ) : @xmath100 which is _ diagonal _ in the eigenchannel index @xmath96 . in eq .",
    "( [ 2g1 ] ) , @xmath101 is an energy of the bound state @xmath102 and @xmath85 is the nucleon mass .",
    "thus , it is convenient to construct multi - channel two - body swp s as integrals of exact scattering wave functions of the sub - hamiltonian @xmath59 defined in the er : @xmath103 where @xmath104 $ ] are new partition intervals whose parameters might be different for different @xmath105 .",
    "the crucial feature of the dss formalism defined in @xcite is that these multichannel swp can be constructed ( jointly with the deuteron bound state wave function ) as pseudostates of the hamiltonian @xmath59 matrix in the multichannel free wp basis @xmath106 ( where radial and angular parts of wave functions included ) . because @xmath39 is not conserved , for each value of total momentum @xmath38 , the two - channel @xmath59 sub - hamiltonian states are constructed from free wp bases @xmath107 defined for both possible values of @xmath108 and @xmath109 .",
    "finally , we have at our disposal the multichannel swp basis functions which are related to the free wps by a simple orthogonal transformation as in the one - channel case ( [ exp_z ] ) : @xmath110 where the spin - angular parts of wave functions are taken into account as well and the multi - index @xmath111 related to the er is introduced .",
    "below we will not detail the index @xmath112 which is a part of the multi - index @xmath113 .    in this way , we construct the three - body swp basis functions for the channel hamiltonian @xmath20 as direct products of the two - body ones for the @xmath17 and @xmath59 sub - hamiltonians : @xmath114 of the channel hamiltonian @xmath20 .",
    "hence , starting from free wp bases for each two - body sub - hamiltonian one gets a set of basis states both for the three - body free and channel hamiltonians , @xmath12 and @xmath20 respectively , which are related to each other by a simple matrix rotation .",
    "the spectral expansion of the three - body channel resolvent @xmath19 in the er can be found straightforwardly by making a convolution of the multi - channel subresolvent @xmath115 with the resolvent @xmath116^{-1}$ ] for the free sub - hamiltonian @xmath17 of the third nucleon    @xmath117    this leads to the following representation for the multi - channel three - body resolvent operator @xmath19 via the scattering eigenfunctions of the @xmath1 subsystem defined in the er : @xmath118 the first term ( the bound - continuum part ) in eq .",
    "( [ g11 ] ) is a spectral sum over three - body states corresponding to the free motion of the third nucleon relative to the deuteron .",
    "the second term ( the continuum - continuum part ) in eq .",
    "( [ g11 ] ) for the channel resolvent includes channel three - body states with @xmath1 pair interacting in the continuum ( in the er ) and its imaginary part is defined by a discontinuity across the three - body cut on the riemann energy surface .    by projecting the channel resolvent operator onto the three - body swp basis defined in eq .",
    "( [ si ] ) , one can find analytical formulas for matrix elements of operator @xmath19 in such a basis .",
    "the respective matrix is diagonal in all wave - packet and spin indices : @xmath119 here the diagonal matrix elements @xmath120 depend , in general , on the spectral partition parameters ( i.e. @xmath121 and @xmath122 values ) and total energy @xmath123 only .",
    "these matrix elements do not depend explicitly on the interaction potential @xmath8 .",
    "the matrix elements @xmath120 are defined as integrals over the respective momentum intervals for the bound - continuum part of the whole operator : @xmath124 and for the continuum - continuum part : @xmath125 if the solution of the scattering equations in the finite - dimensional wp basis converges with increasing the basis dimension , the final result turns out to be _ independent _ of the particular spectral partition parameters",
    ".    representations ( [ dg1]a ) and ( [ dg1]b ) for the channel resolvent are the basis of the wave - packet approach , since , after a straightforward analytical evaluation of the integrals ) when one uses the wp s with the weight functions @xmath126 , @xmath127 . ] in ( [ dg1]a ) and ( [ dg1]b ) , one gets explicit formulas for the three - body resolvent and thus a drastic simplification of the solution of a general three - body scattering problem .",
    "these analytical expressions can be used directly to solve the matrix faddeev equation in eq .",
    "( [ m_pvg ] ) .",
    "in this section the effectiveness of the new approach in few - body calculations will be illustrated by solving the faddeev equations for @xmath3 scattering with the realistic nijmegen @xmath1 potential  @xcite .",
    "the @xmath93-matrix of elastic @xmath128 scattering is usually parameterized by the eigen phase shifts and mixing angles in the total channel spin @xmath129 representation ( here @xmath40 is the @xmath1 pair spin and @xmath130 is a spin of the third nucleon ) .",
    "unitary transformation between amplitudes defined in the representation of the total angular momentum of the third nucleon @xmath131 and the @xmath132-representation is given by the matrix @xcite : @xmath133    in the figs .",
    "[ phases]-[ay ] the results of our fully discrete calculations for elastic @xmath3 scattering with the nijm  i @xmath1 interaction performed within the wp approach are compared with the results of conventional faddeev calculations of the bochum ",
    "krakow group  @xcite .    in the example",
    ", we restricted ourselves to the total isospin value @xmath134 and took into account all of the pairwise @xmath1 channels with two - body total angular momentum @xmath135 ( this gives up to 54 spin - angular channels ) .    in fig .",
    "[ phases ] the results for the lowest even partial phase shifts @xmath136 of elastic @xmath3 scattering both below and above a three - body breakup threshold are shown . in the example",
    ", we employed wp bases with dimensions @xmath137 along two jacobi coordinates .",
    "this gives a matrix system with the dimension @xmath138 which has been handled easily on an ordinary pc in contrast to typical conventional calculations for similar faddeev system which require supercomputer facilities ( see e.g. @xcite ) .",
    "it should be especially emphasized that the calculation of the phase shifts at 100 different energy values displayed in fig .",
    "[ phases ] takes in our approach only about twice as much time as the calculation for a single energy because for all energies we employ the same permutation matrix @xmath68 which is calculated only once .    in fig .",
    "[ cross13 ] our results for the differential cross section for elastic @xmath3 scattering at 13  mev are compared to the results of conventional faddeev calculations . ]",
    "@xcite . while in fig .",
    "[ ay ] the same comparison is given for the neutron vector analyzing powers @xmath139 for the elastic @xmath3 scattering at 35  mev . here the wp basis with dimension @xmath140 has been used and the partial waves with the total angular momentum up to @xmath141 have been taken into account .    it is clear from all of the above illustrative examples that one can achieve almost perfect agreement between our results and the results of the standard faddeev calculations @xcite performed on a powerful supercomputer .",
    "the present calculations were performed on the serial pc with an intel i7 - 3770k ( 3.50ghz ) processor with 32 gb of ram .",
    "the real cpu computational time ( which includes the permutation matrix evaluation ) , i.e. the total calculation which starts from two - body interaction potential and ends with partial three - body amplitudes for a 54-channel calculation with the basis dimension @xmath142 for a single value of the total angular momentum @xmath143 and parity takes about 7 minutes .",
    "although the whole calculation for many partial waves will take a longer time , there is the possibility within the present approach to accelerate the whole calculation and thus solve more complicated scattering problems already using an ordinary pc .",
    "so , keeping in mind our general aim to simplify and accelerate drastically realistic many - body scattering calculations in nuclear , atomic , molecular etc .",
    "studies by using a discrete matrix reduction of the integral scattering equations in the wp scheme , we propose to employ the ultra - fast gpgpu technique to further optimize the solution of the resulting matrix equations .",
    "in this section , we demonstrate a high efficiency of using a graphics processor in numerical solution of the above matrix equation for the three - body scattering problem .      first we describe the overall numerical scheme for solving the three - body scattering problem in the wp formalism , paying particular attention to those aspects that are important for an efficient parallelization .",
    "the use of a fixed matrix for the permutation operator completely eliminates the necessity of the numerous and time consuming interpolations of a current solution in the iterations .",
    "these computations take the majority of the computing time in the standard integral approach .",
    "contrary to this , in our approach , the main computational effort ( in case of cpu - calculations ) are spent on a calculation of the permutation matrix @xmath70 in the lattice wp basis .",
    "however , the matrix @xmath144 is independent of energy , and therefore , being calculated once , it can be used to solve the scattering problem at many energies , as well as for various two - particle input interactions . while in the standard approach , the whole calculation must be repeated for each energy and for each type of two - body interaction .",
    "the main difficulty which is met in the practical solution of the matrix equation ( [ m_pvg ] ) is its large dimension .",
    "so , it is impossible even to store the entire matrix of the kernel @xmath145 in a ram of a computer .",
    "however , one can effectively employ the fact that the matrix @xmath146 can be represented as a product of four matrices : a very sparse matrix @xmath70 ( only about 1  % of its matrix elements are nonzero @xcite ) , a diagonal matrix @xmath19 and two block matrices .",
    "so that , it is sufficient to store only factors of the matrix @xmath147 instead of all its matrix elements ( only the nonzero elements of the sparse matrix are stored ) . in this way , the required memory can be reduced by about 100 times .",
    "this eliminates the need for an external memory in the process of iteration , which in turn reduces a computational time by an order of magnitude even for a conventional cpu realization .",
    "so , our overall numerical scheme should be quite suitable for parallelization and implementation on the multiprocessor systems , particularly on a gpu .",
    "the optimized algorithm for the solution of the realistic @xmath3 scattering problem consists of the following main steps : + 1 .",
    "construction of the three - body swp basis including preparation of two - body bases ( via diagonalization of the pairwise @xmath1 sub - hamiltonian matrix in the free wp basis ) ; the calculation of the algebraic coefficients @xmath148 ( [ gal ] ) for the coupling of different spin - angular channels .",
    "selection of the nonzero elements of the overlap matrix @xmath70 .",
    "calculation of the nonzero elements of @xmath70 .",
    "calculation of the channel resolvent @xmath19 .",
    "solution of the resulting matrix equation by iteration using the pade - approximant technique .",
    "+ the runtimes for the steps 1 and 4 are negligible in comparison with the total running time , so that we can leave these steps for sequential execution on the cpu . the main computational effort ( in the cpu realization )",
    "is spent just on the calculation of the matrix elements of @xmath149-matrix ( i.e. the step 3 ) which are calculated independently of each other .",
    "so this step is ideal for parallelization and we primarily parallelized only the corresponding part of the computer code . however , since the matrix @xmath70 is very sparse , in order to reach the high efficiency of its parallel computation , the preliminary selection of its nonzero elements should be carried out ( step 2 ) .",
    "the execution of the 5th step  iteration solution of the matrix equation  can certainly be accelerated using linear algebra routines implemented on the gpu , but as its execution time takes no more than 20% of the total time for solving the whole problem we did not optimize this step in the present study .",
    "thus , in this calculation we have only parallelized the time - consuming steps 2 and 3 for the gpu .      in this section",
    "we compare the runtimes for the cpu and gpu realizations of realistic @xmath3 elastic scattering calculations . for our gpu calculations we used an ordinary nvidia gtx-670 video card , which is not specialized for general - purpose computing .",
    "first we compare the cpu and gpu realizations of the above algorithm for case of the @xmath93-wave mt i - iii @xmath1 interaction .",
    "this example clearly demonstrates the advantage of the gpu acceleration .",
    "[ time_gpu ] shows the dependence of the cpu- and gpu - computing times for the above steps 2 , 3 , 5 and the complete solution for dimensions @xmath150 and @xmath151 of the wp bases chosen along both jacobi variables .",
    "we take for simplicity @xmath152 in all of our tests so that , the total dimension of the matrix kernel is equal to @xmath153 .",
    "it is clear from fig .",
    "[ time_gpu ] that the complete solution of @xmath3 scattering problem in our approach for a basis of the large dimension is quite enough .",
    "] @xmath154 takes only ca . 7  sec on a serial pc using gpu !",
    "this ultra - fast solution handles a huge matrix @xmath155 including the calculation of the ca .",
    "@xmath156 millions nonzero elements of matrix @xmath70 where each matrix element is reduced to a integral of a rather complicated algebraic function .",
    "the integrals are calculated numerically with a 48-grid - point gaussian quadrature .    from fig .",
    "[ time_gpu ] it is seen that all of these 256 million integrals can be computed on gpu in just 2.3 seconds compared to 255 seconds on the cpu .",
    "this demonstrates the real very high speed of gpu computations for the case discussed here .    in fig .",
    "[ accel_gpu ] we present the dependence of the gpu acceleration ratio @xmath157 on the dimension of the basis @xmath152 for the solution of the @xmath93-wave faddeev problem .",
    "the total acceleration for the complete solution varies from 10 to 50 times depending on the basis dimension , while the time for calculating the nonzero elements of the matrix @xmath70 ( the step 3 ) which takes the main part of the cpu - computing time is reduced by a factor of more than 100 .",
    "we now turn to the case of the realistic @xmath3 scattering problem with the nijmegen @xmath1 potential . taking into account higher partial waves",
    "leads to the system of coupled two - dimensional integral faddeev equations . now",
    "the calculation of each matrix element of @xmath70 for partial waves with nonzero angular momenta includes several tens of double numerical integrals with some trigonometric functions and uses a large set of algebraic coefficients @xmath158 ( [ gal ] ) .",
    "the proper parallelization for this calculation with pre - selection of the nonzero matrix elements leads again to rather fast algorithm realized on gpu .",
    "[ time_gpu_nijm ] demonstrates the gpu acceleration ratio @xmath157 for the complete solution ( solid line ) and for the steps 2 ( dashed line ) and 3 ( dot - dashed ) as a function of the basis dimension @xmath152 for the solution of the 18-channel faddeev equations for the @xmath159 partial @xmath3 elastic amplitude .",
    "it is evident from the results presented that the passing from cpu- to gpu - realization _ on the same pc _ allows one to obtain a significant acceleration of whole three - body calculation by an order of magnitude or higher .",
    "it is clear also that the use of a more powerful specialized graphics processor , like the tesla k40 , would lead even to a considerably higher acceleration of calculations .",
    "however , it should be emphasized that the total acceleration which can be achieved by using gpu depends crucially on the method used , the numerical scheme and parallelization implementation .",
    "in conclusion , let s summarize the most important points of the proposed new general approach for the solution of few - body scattering problems .",
    "first , we rewrite the initial faddeev equations , which include an off - shell @xmath10-matrix , in a fully equivalent form which incorporates the product of the channel resolvent and the interaction operator .",
    "this allows us to simplify the required two - body input and also to fix all of the energy singularities in the channel resolvent operator .",
    "we note here that the four- and more particle integral faddeev - yakubovsky equations have , in principle , some similar structure as compared to three - body faddeev equations ( surely being more complicated and having a higher dimension ) . therefore the discrete wp technique outlined in this paper can be employed for solving these general equations as well .    \\2 .",
    "after that , we project out the transition and interaction operators onto a discrete wave - packet basis and employ a specific analytical form for one- and multi - channel resolvent operators .",
    "this discrete form is extremely convenient for few - body calculations because we get a fixed matrix form ( with fully regular matrix elements ) for the scattering equations ( of lippmann  schwinger , faddeev or faddeev - yakubovsky types ) .",
    "the most important improvement in such a wp projection is the fact that we can replace the permutation operators by fixed matrices , thus completely avoiding the numerous and time consuming interpolations at every iteration step .",
    "moreover , this matrix is energy- and interaction - independent and , being calculated once , can be used to solve various scattering problems with different potentials and at many energies .",
    "these two steps lead to a rather effective numerical scheme which is realized on a standard pc for realistic @xmath2 scattering calculations .",
    "\\3 . at last ,",
    "we perform a proper parallelization of the solution and eventually we employ the ultra - fast gpu technique to make very effective parallel calculations on a serial pc .",
    "this gpu realization for realistic scattering problems reduces the computational time by at least one order of magnitude ( while for separate parts of the numerical scheme the total acceleration could reach two orders ) .",
    "all of the above points open a new way for doing extensive many - body scattering calculations via continuum discretization e.g. in quantum chemistry , nuclear reaction theory , solid state theory etc ..    there is little doubt that a similar ( but surely more tedious ) approach can also be applied to other scattering problems , e.g. to solve the relativistic faddeev equations , bethe ",
    "salpeter equations etc .",
    "* acknowledgments * the authors thank dr .",
    "boreskov for discussions of problems associated with a use of the gpu .",
    "the authors are also deeply grateful to prof .",
    "w. polyzou for careful reading of the manuscript and valuable comments .",
    "this work has been supported partially by the russian foundation for basic research , grants nos .",
    "12 - 02 - 00908 and 13 - 02 - 00399 .",
    "the kernel of the permutation operator in momentum space has the form @xcite @xmath160 where the multi - indices @xmath161 and @xmath162 include all possible spin - angular quantum numbers for the three - body states ( as they are detailed in the sec.iv , i.e. @xmath163 ) and the following notations @xmath164 are used .",
    "the spin - angular coefficients @xmath165 can be found from the formula @xmath166 where @xmath39 and @xmath167 are two - body subsystem orbital momenta and the indices @xmath168 arise from intermediate triangle sums .",
    "the sum in ( [ ggaga ] ) runs according to the triangle rules in partial coefficient @xmath158 which have the following explicit form @xcite : @xmath169 where the summation is done over all allowed intermediate quantum numbers .",
    "projection of free three - body wave - functions @xmath170 ( plane waves ) onto the wp states can be found ( for the case of unit weights @xmath171 and @xmath172 ) from the formula @xcite : @xmath173 here @xmath174 , @xmath175 are the widths of momentum intervals and function @xmath176 is analog of the heaviside step - function : @xmath177 if @xmath26 belongs to the interval @xmath178 and @xmath179 otherwise .    to obtain the permutation matrix elements in the lattice basis ( [ perm ] ) , one should integrate kernel ( [ p_kern ] ) over the lattice cells @xmath180 and @xmath181 .",
    "these matrix elements are defined by the following integrals : @xmath182_{ij , i'j'}^{{\\gamma}{\\gamma}'}\\equiv \\langle x_{ij}^{\\gamma}|p|x_{i'j'}^{{\\gamma}'}\\rangle=\\sum_{kl_1l'_1}\\frac{g_{{\\gamma}{\\gamma}'}^{kl_1l'_1 } } { \\sqrt{d_i\\bar{d}_j d_{i'}\\bar{d}_{j'}}}\\times\\nonumber\\\\ \\int_{{\\mathfrak{d}}_{ij } } dpdq \\int_{{\\mathfrak{d}}_{i'j'}}dp'dq ' \\int_{-1}^1dx \\frac{q^{l_2+l'_2 + 1}(q')^{l_1+l'_1 + 1}}{(p')^{l'+1}p^{l+1}}\\times\\nonumber\\\\ \\delta(p'-\\pi_1)\\delta(p-\\pi_2)p_k(x).\\qquad\\end{aligned}\\ ] ] using the dirac delta - functions , the integrals over @xmath26 and @xmath183 are evaluated analytically : @xmath184_{ij , i'j'}^{{\\gamma}{\\gamma}'}=\\sum_{kl_1l'_1}\\frac{g_{{\\gamma}{\\gamma } ' } } { \\sqrt{d_i\\bar{d}_j d_{i'}\\bar{d}_{j'}}}\\int_{{\\bar{\\mathfrak{d}}}_{j } } dq \\int_{{\\bar{\\mathfrak{d}}}_{j'}}dq ' \\int_{-1}^1dx\\nonumber\\times\\\\ \\frac{q^{l_2+l'_2 + 1}(q')^{l_1+l'_1 + 1}}{(\\pi_1)^{l'+1}(\\pi_2)^{l+1}}p_k(x)\\theta(\\pi_1\\in{\\mathfrak{d}}_{i ' } ) \\theta(\\pi_2\\in{\\mathfrak{d}}_i).\\qquad\\end{aligned}\\ ] ] further , the residual integrals can be evaluated in polar coordinates : @xmath185 then the matrix element takes the form : @xmath186_{ij , i'j'}^{{\\gamma}{\\gamma}'}=\\sum_{kl_1l'_1}\\frac{g_{{\\gamma}{\\gamma } ' } } { \\sqrt{d_i\\bar{d}_j d_{i'}\\bar{d}_{j ' } } } i,\\ ] ] where @xmath187 and the following notations are employed : @xmath188 the boundaries of the integral area in @xmath189-plane are defined by transformation of the rectangle in the @xmath190-plane , so that : @xmath191 evaluating the @xmath192-integral analytically , one gets the expression for the integral @xmath131 : @xmath193 where the following function is introduced : @xmath194 ^ 2 -\\nonumber\\\\ { { \\frac{1}{2}}}\\left[\\max\\left(\\frac{q_{j-1}}{\\cos\\phi},\\frac{q'_{j'-1}}{\\sin\\phi } , \\frac{p'_{i'-1}}{\\zeta_1},\\frac{p_{i-1}}{\\zeta_2}\\right)\\right]^2.\\qquad \\qquad\\end{aligned}\\ ] ] finally , one gets the eventual formula for the permutation matrix @xmath195_{ij , i'j'}^{{\\gamma}{\\gamma}'}=\\sum_{kl_1l'_1}\\frac{g_{{\\gamma}{\\gamma}'}^{kl_1l'_1 } } { \\sqrt{d_i\\bar{d}_j d_{i'}\\bar{d}_{j'}}}\\int_{-1}^1dx p_k(x)\\times\\nonumber\\\\ \\int_{\\phi_1}^{\\phi_2}d\\phi f_{ij , i'j'}(\\phi , x ) \\frac{(\\cos\\phi)^{l_2+l'_2 + 1}(\\sin\\phi)^{l_1+l'_1 + 1}}{(\\zeta_1)^{l'+1}(\\zeta_2)^{l+1}}.\\end{aligned}\\ ] ] in practical treatments these integrals are evaluated numerically .",
    "abs j. carbonell , a. deltuva , a.c .",
    "fonseca , r. lazauskas , progr .",
    ". phys . * 74 * , 55 ( 2014 ) .",
    "faddeev , sov .",
    "phys.- jetp * 12 * , 1014 ( 1961 ) ; o.a .",
    "yakubovsky , sov . j. nuclear . phys . * 5 * , 937 ( 1967 ) .",
    "h. witaa , w.glckle , phys .",
    "c * 85 * , 064003 ( 2012 ) .",
    "https://developer.nvidia.com/cuda-zone k.a .",
    "wilkinson , p. sherwood , m.f .",
    "guest , k.j .",
    "naidoo , j. comp .",
    "chem . * 32 * , 2313 ( 2011 ) .",
    "clark , r. babich , k. barrose , r.c .",
    "brower , c. rebbi , comp .",
    "phys . com .",
    "* 181 * , 1517 ( 2010 ) .",
    "h. potter et al .",
    ", proceedings of ntse-2013 ( ames , ia , usa , may 13 - 17 2013 ) , eds .",
    "a.m. shirokov and a.i .",
    "mazur , khabarovsk , russia , p. 263",
    "( 2014 ) ; http://www.ntse-2013.khb.ru/proc/sosonkina.pdf .",
    "e. yarevsky , lncs 7125 , mathematical modeling and computational science , eds .",
    "a. gheorghe , j. bua and m. hnatic , p. 290",
    "pomerantsev , v.i .",
    "kukulin , o.a .",
    "rubtsova , phys .",
    "c * 79 * , 064602 ( 2009 ) ; _ ibid .",
    "_ * 79 * , 034001 ( 2009 ) .",
    "rubtsova , v.n .",
    "pomerantsev , v.i .",
    "kukulin , a.  faessler , phys .",
    "c * 86 * , 034004 ( 2012 ) . w. glckle , h. witaa , d.hber , h. kamada , j. golack , phys .",
    "rep . * 274 * , 107 ( 1996 ) .",
    "stoks , r.a.m .",
    "klomp , c.p.f .",
    "terheggen , j.j  de  swart , phys .",
    "c * 49 * , 2950 ( 1994 ) .",
    "rubtsova , v.i .",
    "kukulin , v.n .",
    "pomerantsev , a.  faessler , phys .",
    "c * 81 * , 064003 ( 2010 ) .",
    "m. danos , w. greiner , phys .",
    "rev . * 146 * , 708 ( 1966 ) .",
    "rubtsova , v.i .",
    "kukulin , v.n .",
    "pomerantsev , physics of atomic nuclei * 77 * , 486 ( 2014 ) .",
    "kukulin , v.n .",
    "pomerantsev , o.a .",
    "rubtsova , theor .",
    "* 150 * , 403 ( 2007 ) .",
    "s.n . bunker _",
    "et al . _ ,",
    "a * 113 * , 461 ( 1968 ) ."
  ],
  "abstract_text": [
    "<S> background : : :    the numerical solution of few - body scattering problems with realistic    interactions is a difficult problem that normally must be solved on    powerful supercomputers , taking a lot of computer time . </S>",
    "<S> this strongly    limits the possibility of accurate treatments for many important    few - particle problems in different branches of quantum physics . </S>",
    "<S> purpose : : :    to develop a new general highly effective approach for the practical    solution of few - body scattering equations that can be implemented on a    graphics processing unit . methods : : :    the general approach is realized in three steps : ( i ) the reformulation    of the scattering equations using a convenient analytical form for the    channel resolvent operator ; ( ii ) a complete few - body continuum    discretization and projection of all operators and wave functions onto    a @xmath0 basis constructed from stationary wave packets and    ( iii ) the ultra - fast solution of the resulting matrix equations using    graphics processor . results : : :    the whole approach is illustrated by a calculation of the    neutron - deuteron elastic scattering cross section below and above the    three - body breakup threshold with a realistic @xmath1    potential which is performed on a standard pc using a graphics    processor with an extremely short runtime . </S>",
    "<S> conclusions : : :    the general technique proposed in this paper opens a new way for a    fast practical solution of quantum few - body scattering problems both    in non - relativistic and relativistic formulations in hadronic , nuclear    and atomic physics . </S>"
  ]
}