{
  "article_text": [
    "our main theorems in this paper , theorems [ main - theorem ] and [ theo-3pt - int ] , characterize spheres and hemispheres in the context of metric mbius geometry by the existence of many circles .",
    "it is useful to recall in this context the classical charcterization of circles which goes back to claudius ptolemaeus ( ca .",
    "90 - 168 ) .",
    "[ theo - pt ] ( ptolemy s theorem ) + consider four points in the euclidean space , @xmath5 . then @xmath6 moreover , equality holds if and only if the four points lie on a circle @xmath7 such that @xmath8 and @xmath9 lie in different components of @xmath10 .    a metric space @xmath11 is called a _ ptolemy metric space _ if inequality ( [ eqn - ptolemy - inequality ] ) holds for arbitrary quadruples in the space .",
    "we call a subset @xmath12 a _ circle _ , if @xmath13 is homeomorphic to @xmath14 and for any for points @xmath15 on @xmath13 ( in this order ) we have equality in ( [ eqn - ptolemy - inequality ] ) .    consider on @xmath1 the chordal metric @xmath16 , i.e. the metric induced by its standard embedding @xmath17 . via",
    "the stereographic projection @xmath3 is mbius equivalent to @xmath18 and by theorem [ theo - pt ] a ptolemy metric space such that through any three points there exists a circle .",
    "[ main - theorem ] let @xmath11 be a compact extended ptolemy metric space which contains at least three points . if any three points in @xmath19 lie on a circle , then @xmath19 is mbius equivalent to @xmath3 for some @xmath20 .    for the notion of extended metric spaces , i.e. metric spaces allowing one point at infinity , see section [ sec : moeb - geo ] .",
    "+ finally , we define a ptolemy segment to be the analogon of a segment of a circle .",
    "let @xmath21 be a metric on some closed , bounded interval @xmath22 , giving back its standard topology . then @xmath23 is called a _ ptolemy segment _ if equality holds in inequality ( [ eqn - ptolemy - inequality ] ) whenever @xmath15 lie in this order on the segment @xmath24 .    for ptolemy metric spaces with the property that through each three given points there exists a ptolemy segment containing these points",
    ", we obtain the analogon of theorem [ main - theorem ] as follows .",
    "[ theo-3pt - int ] let @xmath11 be a compact extended ptolemy metric space containing at least three points .",
    "if any three points in @xmath19 lie on a circle or on a ptolemy segment , then @xmath11 is mbius equivalent to either some @xmath3 or to some hemisphere @xmath25 for some @xmath20 .    on the way to our main results",
    "we obtain some other results about ptolemy metric spaces .",
    "there are many different isometry types of ptolemy circles ( cf .",
    "propositions [ prop - segment ] and [ prop - circle ] as well as remarks [ rem - segments ] and [ rem - circles ] ) , but there is only one mbius type .",
    "[ thm : moebch - circ ] let @xmath7 and @xmath26 be ptolemy circles .",
    "let @xmath27 and @xmath28 be distinct points on @xmath7 respectively on @xmath26 .",
    "then there exists a unique mbius homeomorphism @xmath29 with @xmath30 .    from this",
    "we obtain almost immediately the analogon of theorem [ main - theorem ] , when considering ptolemy metric spaces with the property that through each four points there exists a ptolemy circle containing these four points .",
    "[ cor-4points ] an extended ptolemy metric space with the property that through each four points of the space there exists a ptolemy circle containing these points , is mbius equivalent to @xmath14 when endowed with its chordal metric .",
    "note that here we do not have to assume the space to be compact .",
    "+ however , if we drop the assumption of compactness in theorem [ main - theorem ] , the conclusion no longer holds .",
    "in fact there are a lot such non - compact spaces with interesting properties ( cf .",
    "example [ example - non - unique - circle ] and theorem [ theo - emb-3-pt - circle - space ] )",
    ".    the paper is structured as follows : + in section [ sec : moeb - geo ] we give a short introduction to metric mbius geometry and state other preliminary results . in section [ sec - charac - circles ] we classify ptolemy circles and segments up to mbius equivalence and up to isometry . in section [ sec - many circles ] we proof the main results .",
    "our main motivation to study ptolemy metric spaces is the fact that they occur naturally on the boundary at infinity of a @xmath31 space .",
    "this relation is described in @xcite .",
    "let @xmath19 be a set which contains at least two points .",
    "an _ extended metric _ on @xmath19 is a map @xmath32 $ ] , such that there exists a set @xmath33 with cardinality @xmath34 , such that @xmath21 restricted to the set @xmath35 is a metric ( taking only values in @xmath36 ) and such that @xmath37 for all @xmath38 , @xmath39 .",
    "furthermore @xmath40 .",
    "+ if @xmath41 is not empty , we sometimes denote @xmath39 simply as @xmath42 and call it the ( infinitely ) remote point of @xmath11 .",
    "we often write also @xmath43 for the set @xmath41 and @xmath44 for the set @xmath45 .",
    "the topology considered on @xmath11 is the topology with the basis consisting of all open distance balls @xmath46 around points in @xmath47 and the complements @xmath48 of all closed distance balls @xmath49 .",
    "+ we call an extended metric space _",
    "complete _ , if first every cauchy sequence in @xmath44 converges and secondly if the infinitely remote point @xmath50 exists in case that @xmath44 is unbounded .",
    "for example the real line @xmath51 , with its standard metric is _ not _ complete ( as extended metric space ) , while @xmath52 is complete .",
    "we say that a quadruple @xmath53 is _ admissible _ , if no entry occurs three or four times in the quadruple .",
    "we denote with @xmath54 the set of admissible quadruples .",
    "we define the _ cross ratio triple _ as the map @xmath55 which maps admissible quadruples to points in the real projective plane defined by @xmath56 here @xmath57 is the subset of points @xmath58 , where all entries @xmath59 are nonnegative or all entries are nonpositive .",
    "note that @xmath57 can be identified with the standard @xmath60-simplex , @xmath61 .",
    "we use the standard conventions for the calculation with @xmath42 .",
    "if @xmath42 occurs once in @xmath62 , say @xmath63 , then @xmath64 . if @xmath42 occurs twice , say @xmath65 then @xmath66 .",
    "similar as for the classical cross ratio there are six possible definitions by permuting the entries and we choose the above one .",
    "it is not difficult to check that @xmath67 is continuous , where @xmath62 and @xmath57 carry the obvious topologies induced by @xmath19 and @xmath68 .",
    "thus , if @xmath69 for @xmath70 and asume @xmath71 , where @xmath72 then @xmath73 .",
    "a map @xmath74 between two extended metric spaces is called _ mbius _ , if @xmath75 is injective and for all admissible quadruples @xmath76 of @xmath19 , @xmath77 mbius maps are continuous .    two extended metric spaces @xmath11 and @xmath78 are _ mbius equivalent _ , if there exists a bijective mbius map @xmath74 . in this case",
    "also @xmath79 is a mbius map and @xmath75 is in particular a homeomorphism .",
    "+ we say that two extended metrics @xmath21 and @xmath80 on a set @xmath19 are _ mbius equivalent _ , if the identity map @xmath81 is a mbius map .",
    "mbius equivalent metrics define the same topology on @xmath19 .",
    "a _ mbius structure _ on a set @xmath19 is a nonempty set @xmath82 of extended metrics on @xmath19 , which are pairwise mbius equivalent and which is maximal with respect to that property .",
    "a mbiusstructure defines a topology on @xmath19 .",
    "in general two metrics in @xmath82 can look very different .",
    "however if two metrics have the same remote point at infinity , then they are homothetic .",
    "since this result is crucial for our considerations , we state it as a lemma .",
    "[ lem : homothety ] let @xmath82 be a mbiusstructure on a set @xmath19 , and let @xmath83 , such that @xmath84 is the remote point of @xmath21 and of @xmath80",
    ". then there exists @xmath85 , such that @xmath86 for all @xmath87 .",
    "since otherwise the result is trivial , we can assume that there are distinct points @xmath88 .",
    "choose @xmath85 such that @xmath86 .",
    "if @xmath89 , then @xmath90 is the same in the metric @xmath21 and @xmath80 , hence @xmath91 since @xmath86 we therefore obtain @xmath92 and @xmath93 .",
    "an extended metric space @xmath11 is called a _ ptolemy space _ , if for all quadruples of points @xmath94 the _ ptolemy inequality",
    "_ holds @xmath95    we can reformulate this condition in terms of the cross ratio triple . let @xmath96 be the set of points @xmath97 , such that the entries @xmath59 satisfy the triangle inequality .",
    "this is obviously well defined .",
    "if we identify @xmath98 with the standard @xmath60-simplex , i.e. the convex hull of the unit vectors @xmath99 , then @xmath100 is the convex subset spanned by @xmath101 , @xmath102 and @xmath103 .",
    "we denote by @xmath104 , @xmath105 and @xmath106 .",
    "note that also @xmath100 is homeomorphic to a @xmath60-simplex and @xmath107 is homeomorphic to @xmath14 .",
    "then an extended space is ptolemy , if @xmath108 for all allowed quadruples @xmath62 .",
    "this description shows that the ptolemy property is mbius invariant and thus a property of the mbiusstructure @xmath82 .",
    "the importance of the ptolemy property comes from the following fact .",
    "a mbiusstructure @xmath82 on a set @xmath19 is ptolemy , if and only if for all @xmath109 there exists @xmath110 with @xmath111 .",
    "assume that @xmath82 is ptolemy and that @xmath109 .",
    "choose some @xmath112 .",
    "if @xmath113 , we have our desired metric .",
    "if not we define @xmath114 $ ] by @xmath115    since for @xmath116 @xmath117 we see that @xmath118 satisfies the triangle inequality and hence @xmath119 .",
    "if on the other hand for every @xmath109 there is a metric @xmath120 with @xmath121 , then for all @xmath116 and all @xmath112 @xmath122 which implies the ptolemy inequality .    for a ptolemy metric space @xmath11 we call @xmath123 the inversion of @xmath11 at @xmath109 .",
    "+ on the other hand we allways have bounded metrics in a mbius structure .",
    "let @xmath82 be a ptolemy mbius structure on a set @xmath19 .",
    "then there exists a bounded metric @xmath112 .",
    "take any @xmath112 .",
    "we can assume that @xmath11 is unbounded .",
    "let @xmath124 , @xmath125 .",
    "on @xmath19 we define a new bounded metric @xmath126 .",
    "we let @xmath127 note that this expression extends continuously to the point @xmath42 ( in case that @xmath128 exists ) , with @xmath129 , and @xmath130 .",
    "then @xmath131 defines a bounded metric on @xmath19 which is mbius equivalent to the old one .",
    "in fact , one can see this construction isn the following way : extend @xmath11 to a ( ptolemy ! ) extended metric space @xmath132 with some additional finite point @xmath133 , where @xmath134 , @xmath135 and @xmath136 . then apply an involution at @xmath133 .",
    "the restriction of this metric to @xmath19 yields the bounded metric @xmath131 .",
    "a circle in a ptolemy space @xmath11 is a subset @xmath12 hoemeomorphic to @xmath14 such that for distinct points @xmath137 ( in this order ) @xmath138 here the phrase `` in this order '' means that @xmath139 and @xmath140 are in different components of @xmath141 .",
    "we recall that the classical ptolemy theorem states , that four points @xmath142 of the euclidean plane lie on a circle ( in this order ) , if and only if their distances satisfy the ptolemy equality ( [ eq : pt_eq ] ) .",
    "one can reformulate this via the crossratio triple .",
    "a subset @xmath13 homeomorphic to @xmath14 is a circle , if and only if for all admissible quadruples @xmath76 of point in @xmath13 we have @xmath143 .",
    "this shows that the definition of a circle is mbius invariant and hence a concept of the mbius structure .",
    "let @xmath13 be a circle and let @xmath144 and consider @xmath145 in a metric with remote point @xmath50 , then @xmath146 says that for @xmath147 ( in this order ) @xmath148 , i.e. it implies that @xmath149 is a geodesic , actually a complete geodesic isometric to @xmath150 .",
    "we note that via the stereographic projection the extended ptolemy space @xmath18 is mbius equivalent to @xmath3 , where @xmath16 is the chordal metric , i.e. the restriction of the metric on @xmath151 .      in this section",
    "we consider a 3-point ptolemy circle space @xmath19 , i.e. we assume that through any three given points in @xmath19 there exists a circle .",
    "we show that in the case that @xmath19 is compact , circles are uniquely determined by three distinct points :    [ thm : unique_circle ] let @xmath19 be a compact extended 3-point ptolemy circle space , then through three distinct points there exists a unique circle .",
    "we prove this result by using suitable involutions .",
    "let @xmath152 be an arbitrary point , then consider the mbius equivalent extended metric @xmath153 on @xmath19 ( in @xmath153 the point @xmath154 is the infinitely remote point ) .",
    "now one easily sees that a ptolemy circle through @xmath154 is in the metric @xmath153 a geodesic .",
    "thus we can reduce the uniqueness of circles to the uniqueness of geodesics .",
    "note that since @xmath11 is a 3-point ptolemy circle space , @xmath155 is a geodesic spaces , i.e. through @xmath156 there exists a geodesic in @xmath155 .",
    "we apply the following theorem on geodesic ptolemy metric spaces from @xcite .",
    "[ theorem 1.2 in @xcite ] a locally compact , geodesic ptolemy metric space is uniquely geodesic .    to prove theorem [ thm : unique_circle ] , consider three distinct points @xmath157 . by taking the involution @xmath118 and the above result",
    ", we see that the segment of the ptolemy circle between @xmath158 and @xmath139 which does not contain @xmath159 is uniquely determined . by symmetry of the argument",
    "this is also true for the two other segments .",
    "this implies the uniqueness .",
    "we point out that the assumption of compactness is crucial , as the following theorem from @xcite shows .",
    "[ theorem 1.1 in @xcite ] every ptolemy metric space @xmath11 admits an isometric embedding into a complete , geodesic ptolemy space @xmath160 .    thus , start with a metric space @xmath11 consisting of four points , where five of the six distances are equal to one and the remaining distance is equal to two .",
    "this space is ptolemy and by the above can be isometrically embedded into a geodesic ptolemy space .",
    "but this space is not uniquely geodesic .",
    "+ in general , there might exist different ptolemy circles through three given points , as the following example shows .",
    "[ example - non - unique - circle ] the construction method of @xmath160 as in the theorem cited above allows to add arbitrarily many geodesics between any two points such that all distance functions @xmath161 to points @xmath162 are affine .",
    "now taking any three points in @xmath163 then for any choice of three such geodesics connecting the given points to each other , their concatenation yields a ptolemy circle .",
    "this observation can also be formulated as follows .",
    "[ theo - emb-3-pt - circle - space ] every ptolemy metric space @xmath11 admits an isometric embedding into a @xmath164-point ptolemy circle space .",
    "recall that a geodesic metric space @xmath11 is called _ distance convex _",
    ", if all its distance functions to points @xmath109 @xmath165 are convex , i.e. , that their restriction to any geodesic segment in @xmath11 is convex .",
    "+ a geodesic ptolemy metric space is distance convex , which follows immediately from the ptolemy inequality applied to points @xmath166 and @xmath139 , where @xmath167 is a midpoint of @xmath158 and @xmath139 , i.e. @xmath168 .",
    "+ let @xmath169 be a geodesic ray parameterized by arclength . as usual",
    "we define the _ busemann function _ @xmath170 .",
    "+ if @xmath19 is a geodesic ptolemy space , then @xmath171 is convex , being the limit of the convex functions @xmath172 .",
    "+ for more information on busemann functions in geodesic ptolemy spaces",
    "we refer the reader to @xcite      let @xmath19 be a geodesic metric space . for @xmath87",
    "we denote by @xmath173 the set of midpoints of @xmath158 and @xmath139 .",
    "a map @xmath174 between two geodesic metric spaces is called _ affine _ , if for all @xmath87 , we have @xmath175 . thus a map is affine if and only if it maps geodesics parameterized proportionally to arclength into geodesics parameterized proportionally to arclength .",
    "an affine map @xmath176 is called an affine function .",
    "let @xmath19 be a geodesic metric space .",
    "we say that affine functions on @xmath19 _ separate points _ , if for every @xmath177 , @xmath178 , there exists an affine function @xmath179 with @xmath180 .",
    "the following beautiful rigidity theorem , which is due to hitzelberger and lytchak , is a main tool in our argument .",
    "( @xcite ) [ theo - hl ] let @xmath19 be a geodesic metric space . if the affine functions on @xmath19 separate points , then @xmath19 is isometric to a convex subset of a ( strictly convex ) normed vector space .",
    "for a proof of a variant of this statement , cf . section [",
    "subsec-3point - segment ] .",
    "the other main ingredient when characterizing the @xmath164-point ptolemy - circle and - segment spaces is the following theorem due to schoenberg .",
    "( @xcite ) [ theo - sch ] a normed vector space @xmath181 is a ptolemy metric space if and only if it is euclidean .",
    "this , together with the fact that the ptolemy condition is invariant under scaling , yields the    [ cor : sch ] an open subset of a normed vector space @xmath181 is a ptolemy space , if and only if @xmath181 is euclidean .",
    "in this section we classify circles and segments in ptolemy spaces . we start with a classification up to mbius equivalence .      we prove theorem [ thm : moebch - circ ] and its analogue for ptolemy segments .",
    "[ thm : moebch - segm ] let @xmath24 , @xmath182 be ptolemy segments .",
    "let @xmath183 be the boundary points of @xmath24 and @xmath184 be the boundary points of @xmath182 .",
    "let in addition @xmath8 and @xmath185 inner points of @xmath24 and @xmath182 .",
    "then there exists a unique mbius homeomorphism @xmath186 with @xmath187 .",
    "( of theorem [ thm : moebch - circ ] ) define @xmath188 by @xmath189 . since @xmath7 is a ptolemy circle the image of @xmath190 is actually in @xmath107 .",
    "the map is continuous and maps @xmath191 to @xmath192 , @xmath8 to @xmath193 and @xmath194 to @xmath195 .",
    "one also easily checks that @xmath196 .",
    "now @xmath197 consists out of three open segments @xmath198 , such that @xmath199 and @xmath200 are boundary points of @xmath201 , and @xmath202 is not @xmath201 ( here @xmath203 ) .",
    "correspondingly @xmath204 consists of three open segments @xmath205 .",
    "note that @xmath206 consists of all @xmath207 , such that @xmath208 . since @xmath190 gives a bijection @xmath209 , @xmath190 maps @xmath210 to @xmath206 .",
    "if @xmath211 , this implies that the equality in the triangle inequality is written in the following way : @xmath212    we now show that @xmath190 is injective .",
    "assume that @xmath213 .",
    "this implies that there exists @xmath214 such that @xmath215 for @xmath216 .",
    "in particular we have @xmath217    we can also assume w.l.o.g . that @xmath218 , and hence the same holds for @xmath219 .",
    "this implies that @xmath219 and @xmath220 are in the same component of @xmath221 ( namely the component @xmath222 ) .",
    "thus we have ( eventually after permuting @xmath220 and @xmath219 ) @xmath223 which implies @xmath224 because of ( [ eq : c1 ] ) .",
    "since @xmath7 is homeomorphic to @xmath14 and @xmath188 is injective and continuous , it is also surjective and a homeomorphism .",
    "now the map @xmath225 , @xmath226 is a mbius homeomorphism and maps @xmath199 to @xmath227 .",
    "assume on the other side that @xmath228 is a mbius homeomorphism with @xmath229 .",
    "then @xmath230 , which implies @xmath231 .",
    "the proof of theorem [ thm : moebch - segm ] is completely analogous .",
    "the map @xmath232 now maps @xmath24 homeomorphically on the path in @xmath107 , which goes from @xmath233 via @xmath234 to @xmath235 .",
    "again @xmath236 is the required homeomorphism .",
    "we now study ptolemy segments and classify them up to isometry .",
    "+ we first consider the special case that one boundary point of the segment is the point @xmath42 .",
    "let @xmath237 be the other boundary point .",
    "let @xmath238 points on the segment ( where the order is induced by the homeomorphism of the segment to @xmath239 $ ] ) .",
    "then the ptolemy equality implies @xmath240 .",
    "this says that the segment is isometric to an interval and actually isometric to @xmath241 \\subset { \\mathbb{r}}\\cup\\{\\infty\\}$ ] .",
    "+ we now consider a ptolemy segment @xmath242,d)$ ] , with @xmath243 a positive and finite number .",
    "let let @xmath244 .",
    "we define a map @xmath245\\to q$ ] by @xmath246 , where @xmath247 and @xmath248 .",
    "thus @xmath249 is a curve in @xmath62 from @xmath250 to @xmath251 .",
    "note that the above ptolemy condition applied to the quadruple @xmath252 implies that @xmath253 , where @xmath254 is the standard scalar product on @xmath62 and @xmath255 the standard rotation @xmath256 .",
    "now for two points @xmath257 we have @xmath258 iff @xmath259 . as a consequence",
    "this implies that @xmath260 is a strictly increasing function .",
    "this motivates that we consider for two points @xmath257 the expression @xmath261 as a kind of `` signed distance '' .",
    "this `` signed distance '' is related to the ptolemy equality , as a trivial computation shows :    [ lem : pt - condition ] for @xmath262 ( actually for arbitrary @xmath263 ) we have @xmath264    thus the expression @xmath265 has the symmetries of a curvature tensor .",
    "the above lemma corresponds to the bianchi identity .",
    "the other symmetries are obvious .",
    "the expression @xmath261 does not satisfy the triangle inequality and we have to study more precisely what conditions correspond to the triangle inequality .",
    "let us therefore consider three points @xmath266 such that @xmath267 .",
    "this implies that @xmath268 , with @xmath269 .",
    "we say that @xmath270 _ satisfies the triangle inequality _ , if the following three inequalities hold :    1 .",
    "@xmath271 2 .",
    "@xmath272 3 .",
    "@xmath273    clearly for @xmath274 the points @xmath275 have to satisfy the triangle inequality .",
    "an easy computation shows the following :    [ lem : trianglecondition ] let @xmath266 as above .",
    "then the three triangle inequalities are respectively equivalent to : @xmath276 , @xmath277 and @xmath278 , i.e. that the three non - negative numbers @xmath279 satisfy the triangle inequality .",
    "let @xmath280 with @xmath281 .",
    "we define the region @xmath282    note that @xmath283 is the convex region in @xmath62 which is bounded by the line segment @xmath284 , where @xmath285 from @xmath286 to @xmath140 , and the two parallel rays @xmath287 resp .",
    "@xmath288 for @xmath289 .",
    "these three affine segments correspond to the three triangle inequalities .",
    "this can easily be verified , since the equation @xmath290 defines the line @xmath291 , the equation @xmath292 the line @xmath293 and @xmath294 the line @xmath295 .",
    "the last two lines are parallel , the inequalities define corresponding halfspaces . here we denote for different @xmath257 with @xmath296 the affine line determined by @xmath154 and @xmath297 .",
    "if we consider a ptolemy interval , then the corresponding curve @xmath249 satisfies : if @xmath298 then @xmath299 .",
    "in particular the whole curve is contained in the set @xmath300 .",
    "the first of the three inequalities ( namely @xmath276 ) is easy to understand .",
    "it just means that the curve @xmath249 is convex in the following sense .",
    "we call a curve @xmath249 in @xmath62 from @xmath301 to @xmath302 _ convex _ , if @xmath249 is continuous , @xmath303 is strictly increasing and the bounded component of @xmath304\\}$ ] is convex .    surprisingly this condition together with the condition that @xmath305 imply all other triangle conditions .",
    "[ prop : t - condition ] let @xmath249 be a convex curve in @xmath300 from @xmath301 to @xmath302 , then for @xmath298 we have @xmath299 .",
    "let @xmath249 be a convex curve in @xmath306 from @xmath307 to @xmath308 .",
    "we denote @xmath309 .",
    "we have to show that @xmath310 .",
    "consider the lines @xmath311 and @xmath312 .",
    "there are two cases .",
    "first assume that the lines are parallel ( and hence do not intersect ) .",
    "in this case @xmath286 and @xmath140 lie on the two boundary rays of @xmath300 and one easily checks that @xmath283 is the unbounded component of @xmath313 .",
    "since @xmath249 is convex , this implies that @xmath310 .",
    "thus we consider the second case that the two lines intersect in a point @xmath159 .",
    "since @xmath249 is a convex curve containing @xmath314 , we see that @xmath159 is in the unbounded component of @xmath315 \\}$ ] and @xmath316 , where @xmath317 is the corresponding triangle .",
    "it remains to prove that @xmath318 .",
    "let @xmath319 , where @xmath320 is the origin , and @xmath321 the usual euclidean angle .",
    "let @xmath322 .",
    "thus @xmath323 .",
    "we assume ( without loss of generality ) that @xmath324 .",
    "consider the two lines @xmath295 and @xmath325 , which are the lines containing the boundary rays of @xmath283 .",
    "then @xmath326 intersect the boundary of @xmath62 in a point @xmath327 and @xmath328 intersects the boundary of @xmath62 in @xmath329 . since @xmath324",
    ", we have @xmath330 . since @xmath331 and @xmath332 ( since @xmath333 )",
    ", we see that @xmath334 and hence also @xmath335 .",
    "this implies that @xmath336 is in the strip bounded by @xmath326 and @xmath328 and hence in @xmath283 .",
    "collecting all results we can now state :    [ prop - segment ] the isometry classes of ptolemy intervals @xmath242,d)$ ] with @xmath337 stay in @xmath338 relation to the convex curves in @xmath300 from @xmath301 to @xmath302 modulo reflection at the bisecting line in @xmath62 .",
    "indeed given such a ptolemy interval , we obtain such a convex curve .",
    "if we have otherwise given such a convex curve @xmath339 \\to q$ ] , @xmath340 , then for given @xmath341 $ ] we have @xmath342 , @xmath343 , @xmath344 , @xmath345 .",
    "now @xmath346 is determined by the ptolemy equality : @xmath347 thus the curve determines the isometry class completely .",
    "+ note that two ptolemy segments are isometric to each other if and only if their ptolemy parameterizations as above either coincide or if they are obtained from one another by reflection at the bisecting line in @xmath62 . +    [ rem - segments ]    ( i ) : :    on ptolemy intervals which can be realized in    @xmath348 .",
    "+    let @xmath349 be two points of distance    @xmath350 .",
    "then for @xmath351 there is    exactly one ptolemy segment ( namely a halfcircle of radius r ) in    @xmath348 connecting two points of distance    @xmath352 up to isometry , whereas for    @xmath353 there are exactly two such segments .",
    "these    segments are precisely the ptolemy segments which can be isometrically    embedded in @xmath348 ( this follows essentially from    the classical characterization of circles by the ptolemy equality ) .",
    "we    claim now , that their images in @xmath62 are the intersections    of @xmath62 with the ellipses in @xmath354    through @xmath301 and @xmath302 with axis along    @xmath355 and    @xmath356 . indeed , for    @xmath357 , @xmath358 consider a circle in    @xmath348 with radius @xmath359 connecting two    points @xmath154 and @xmath297 in distance    @xmath350 of each other . seen from the circles origin ,",
    "the    points @xmath154 and @xmath297 enclose an angle    @xmath360 with    @xmath361 .",
    "in each point    @xmath167 on the circle segment considered , let    @xmath362 denote the angle of @xmath154 and    @xmath297 at @xmath167 .",
    "this angle    @xmath363 $ ] is constant along the    segment and using the law of cosine in @xmath348 the    image of this circle segment in @xmath62 is given in the    coordinates @xmath364 and @xmath365 of @xmath62    through @xmath366 .",
    "since the last    equation describes the ball of radius @xmath352 around the    origin w.r.t",
    ". the scalar product on @xmath354 with    @xmath367 and    @xmath368 , it determines an ellipse as    claimed .",
    "+    this remark shows that the possible isometry classes of ptolemy    segments are much richer than those of circles which can be realized    in the euclidean plane .",
    "( ii ) : :    the ptolemy parameterization .",
    "+    given a ptolemy segment @xmath23 , there exists a unique    ptolemy parameterization    @xmath369\\longrightarrow q$ ] as    above , parameterizing the segment by the angle    @xmath370 $ ] its image point in    @xmath62 encloses with @xmath371 .",
    "+    consider two ptolemy segments @xmath210 , @xmath372 ,    and denote their ptolemy parameterizations by    @xmath373 , @xmath372 .",
    "then the map    @xmath374 satisfying    @xmath375 for all    @xmath376 is a mbius map .    .",
    "their corresponding euclidean configurations are shown on the right hand side . ]",
    "we now study ptolemy circles .",
    "let @xmath377 .",
    "we will assume that @xmath378 .",
    "now @xmath14 consists of two `` segments '' from @xmath379 to @xmath380 .",
    "let @xmath381 be the upper halfspace .",
    "we now define a map @xmath382 \\to h$ ] , by @xmath383 , where @xmath384 and @xmath385 for @xmath386 and @xmath387 for @xmath388 .",
    "let @xmath389 be a ptolemy circle and let @xmath390 .",
    "then the ptolemy condition for the circle applied to the three possible cases @xmath391 , @xmath392 and @xmath393 always gives the distance @xmath394 .",
    "this implies that @xmath395 is strictly increasing with @xmath220 .",
    "the discussion with the triangle inequality is similar as in the case of a ptolemy segment .",
    "however , note that in the proof of lemma [ lem : trianglecondition ] we used the fact that @xmath396 .",
    "thus the argument does not work for @xmath397 and @xmath398 .",
    "we can , however , say the following : if @xmath399 are three points in the open interval @xmath400 , then the triangle condition is equivalent to @xmath401 as above .",
    "the same is true if @xmath402 and @xmath403 ( resp . @xmath404 and @xmath405 ) .",
    "we want to understand the limit case @xmath406 .",
    "therefore we define for a unit vector @xmath407 with @xmath408 the sector @xmath409 .",
    "the analogon of proposition [ prop - segment ] for ptolemy circles now reads as follows .",
    "[ prop - circle ] the ptolemy circles @xmath389 with @xmath410 are in @xmath338 relation to the convex curves @xmath249 in @xmath411 from @xmath301 via @xmath302 to @xmath412 which are contained in @xmath413 for some @xmath414 with @xmath415 .",
    "the condition that ( for @xmath416 ) @xmath401 implies that the curve @xmath249 convex , i.e. the bounded component of @xmath417 is convex .",
    "the condition also implies ( for @xmath402 and @xmath418 a limit condition that @xmath419 for some @xmath414 .",
    "since @xmath420 we have @xmath415 .",
    "conversely let us assume that @xmath421 , @xmath422 is a convex curve in @xmath411 from @xmath423 via @xmath424 to @xmath425 which is contained in @xmath413 for some @xmath414 with @xmath415 . for @xmath426",
    "define @xmath427 . by lemma [ lem : pt - condition",
    "] @xmath389 satisfies the ptolemy condition .",
    "we have to show that @xmath21 is indeed a metric , hence that for @xmath416 we have @xmath401 .",
    "the proof is similar to the proof of proposition [ prop : t - condition ]    we write @xmath309 and have to show that @xmath310 .",
    "consider the lines @xmath428 and @xmath429 .",
    "if these lines are parallel , then they are the boundary rays of @xmath430 and @xmath283 is the closure of the unbounded component of @xmath431 .",
    "if the lines are not parallel , let @xmath432 be the intersection point and we have to show @xmath433 .",
    "consider the parallel lines @xmath295 and @xmath325 , which are the lines containing the boundary rays of @xmath283 .",
    "these lines intersect the boundary of @xmath411 in points @xmath434 and @xmath435 for some @xmath436 .",
    "the condition that @xmath437 implies @xmath438 .",
    "this implies that @xmath159 is in the strip bounded by @xmath326 and @xmath328 .",
    "[ rem - circles ]    ( i ) : :    on the ptolemy circles which can be realized in    @xmath348 . +    now we can have a similar discussion of the variety of ptolemy circles    as the one in remark [ rem - segments ] ( i ) . for ptolemy segments .",
    "once    again , the ptolemy circles which admit isometric embeddings in    @xmath348 are precisely given by the intersections of    the upper halfplane @xmath411 with the ellipses in    @xmath354 considered above .",
    "( ii ) : :    the ptolemy parameterization .",
    "+    the analogon of remark [ rem - segments ] ( ii ) also applies to ptolemy    circles once one fixes additional two points on the circle , fixing its    ptolemy parameterization .",
    "+    note that in contrast to the situation for ptolemy segments , ptolemy    circles do not admit the pair of an initial- and an endpoint .",
    "our    characterization of isometry classes therefore requires the additional    choice of two distinct points on the circle .",
    "it therefore is a    characterization of two - pointed ptolemy circles .",
    "in this section we characterize ptolemy spaces with many circles or many segments . for simplicity",
    "we call a metric space a @xmath439-point ptolemy - circle ( resp .",
    "ptolemy - segment ) space , if any @xmath439 points are contained in a ptolemy ccircle ( respectively ptolemy segment ) .",
    "we assume first , that @xmath19 is a space such that for any allowed quadruple @xmath441 we have @xmath442 , i.e. for all quadruples of points the ptolemy equality holds .",
    "we choose some point @xmath152 and consider the metric space @xmath155 .",
    "the ptolemy equality implies now that for a triple of points in @xmath443 we have equality in the triangle inequality .",
    "thus @xmath19 is mbius equivalent to @xmath444 , where @xmath445 .",
    "since we always assume that @xmath19 contains at least two points and ptolemy segment spaces are connected , we immediately obtain corollary [ cor-4points ] .      in this section",
    "we characterize all @xmath164-point ptolemy circle spaces up to mbius equivalence and prove theorem [ main - theorem ] .",
    "+ the idea of the proof is the following .",
    "first we take an arbitrary point @xmath446 and consider the metric space @xmath447 .",
    "this is a geodesic space by the results of section [ subsec : uofptcirc ] .",
    "we show that on this space the affine functions separate points .",
    "thus , by the hitzelberger - lytchak theorem , @xmath448 is isometric to a convex subset of a normed vector space .",
    "actually since all geodesics extend to lines it is isometric to a normed vector space . by schoenberg s theorem",
    "this vector space is an inner product space and hence by local compactness isometric to @xmath449 , which completes the proof",
    ".      we will show below that the busemann function @xmath171 associated to a geodesic ray @xmath451 in @xmath452 is affine .",
    "assume this for a moment , and let @xmath453 , @xmath178 be distinct points .",
    "note that by the results of section [ subsec : uofptcirc ] the geodesic between @xmath158 and @xmath139 is a part of the unique geodesic circle through @xmath454 whose part in @xmath447 is a geodesic line @xmath455 .",
    "this line contains @xmath158 and @xmath139 and the busemann function of this line separates these points , @xmath456 .",
    "let @xmath458 be an arbitrary geodesic ray in @xmath450 .",
    "in order to prove that the busemann function @xmath459 is affine , consider @xmath460 with @xmath461 . since busemann functions are convex ( cf .",
    "section [ sec : bus_convex ] ) , we have @xmath462 .          we consider the subsegment of this circle which contains @xmath158 and @xmath468 as boundary points and @xmath139 as interior point . on this segment",
    "we consider the orientation that @xmath469 and we choose for @xmath470 large enough @xmath471 with @xmath472 , such that @xmath473 , and hence @xmath474 . by the ptolemy equality on the segment we have @xmath475 and hence @xmath476",
    "since @xmath479 are on a geodesic and @xmath481 , we have @xmath482 . by triangle inequalities this implies @xmath483 , and",
    "hence @xmath139 is a midpoint of @xmath167 and @xmath286 .",
    "this again implies @xmath484      lemma [ lemma - affine ] now allows us to provide the + * proof of theorem [ main - theorem ] : * from theorem by [ theo - hl ] , we deduce with lemma [ lemma - affine ] that @xmath485 is a convex subset of a ( strictly convex ) normed vector space .",
    "furthermore , all geodesic segments extend to complete lines .",
    "thus we see that @xmath448 , is itself isometric to a normed vector space .",
    "since it also is a ptolemy space , schoenberg s theorem , theorem [ theo - sch ] , implies that it is a euclidean space . by local compactness",
    "it is isometric to @xmath449 for some @xmath486 .        in this section",
    "we provide an example of a metric sphere which is mbius equivalent , but not homothetic to the standard chordal sphere",
    ". + let @xmath19 be a @xmath488-space , @xmath489 , and let @xmath124 .",
    "we recall that the bourdon metric @xmath490 can also be expressed in terms of the gromov product on @xmath491 .",
    "+ given @xmath177 , the _ gromov product _",
    "@xmath492 of @xmath158 and @xmath139 w.r.t .",
    "the basepoint @xmath320 is defined as @xmath493 .\\ ] ] this gromov product naturally extends to points at infinity , by @xmath494 where @xmath495 and @xmath496 are sequences in @xmath19 converging to @xmath497 and @xmath498 , respectively , i.e. sequences which satisfy @xmath499 and @xmath500 , respectively , where @xmath501 denotes the unique geodesic ray connecting @xmath320 to @xmath502 . +",
    "this limit exists and does not depend on the choice of sequence .",
    "this phenomenon is referred to as the so called boundary continuity of @xmath488-spaces ( cf .",
    "section 3.4.2 in @xcite and note that one can generalize the proof given there for proper @xmath503-spaces to the non - proper case ) .",
    "+ with this notation one can write the bourdon metric @xmath504 as @xmath505    [ example - exotic - m - s ] consider the @xmath164-dimensional real hyperbolic space @xmath506 of constant curvature @xmath380 in the poincar ball model .",
    "let @xmath320 denote the center of the ball and consider a complete geodesic @xmath507 through @xmath320 .",
    "+ now we glue a real hyperbolic halfplane @xmath411 of curvature @xmath380 along @xmath507 . the resulting space",
    "@xmath19 is a @xmath508-space .",
    "+ let @xmath509 be some point , the projection of which in @xmath411 on @xmath507 coincides with @xmath320 .",
    "the bourdon metric @xmath504 of @xmath510 w.r.t .",
    "@xmath320 when restricted to the boundary of @xmath506 , @xmath511 , is isometric to @xmath512 when endowed with half of its chordal metric .",
    "+ the bourdon metric @xmath513 of @xmath510 w.r.t .",
    "@xmath514 when restricted to @xmath515 is mbius equivalent to @xmath504 .",
    "we now verify that @xmath516 is not homothetic to the standard chordal sphere @xmath517 .",
    "+ let @xmath518 and @xmath519 denote the endpoints of @xmath507 in @xmath512 .",
    "they are diametral points w.r.t . @xmath504 and define the equator @xmath520 as such sets of points with coinciding distances to @xmath521 and @xmath522 , respectively .",
    "note that by the symmetry of the construction , @xmath520 has the very same property w.r.t .",
    "the metric @xmath513 + since every geodesic ray in @xmath19 from @xmath514 to some @xmath523 contains @xmath320 , @xmath520 endowed with the bourdon metric @xmath513 with respect to @xmath514 is isometrically a euclidean circle of radius @xmath524 , where @xmath525 .",
    "+ in contrast to the points @xmath523 , the points @xmath521 and @xmath522 also lie in the boundary of the halfplane @xmath411 .",
    "hence the geodesic rays connecting @xmath514 to @xmath521 and @xmath522 , respectively , do not contain @xmath320 .",
    "in fact , denote by @xmath526 the busemann function associated to @xmath507 normalized such that @xmath527 , then @xmath528 it follows that @xmath516 is not homothetic to @xmath517 .",
    "[ prop : eucl ] let @xmath530 with @xmath128 such that @xmath531 is a closed subset of @xmath532 .",
    "assume that through any three distinct points of @xmath19 there exists a circle segment through these points .",
    "then @xmath531 is contained in an affine subspace @xmath533 ( which could be @xmath532 again ) and @xmath534 is isometric either to @xmath411 , to some closed halfspace in @xmath411 or to the complement of some open distance ball in @xmath411 .",
    "we now come to the proof of theorem [ theo-3pt - int ] .",
    "+ let @xmath11 be a compact @xmath164-point ptolemy segment space , and consider again a chosen point @xmath109 and the locally compact metric space @xmath535 .",
    "let @xmath536 be distinct points .",
    "by assumption there exists a ptolemy segment @xmath537 in @xmath19 containing @xmath454 . using the arguments of section [ subsec-4point ] and lemma [ lem : triangle ] we see that @xmath538 is in the metric space @xmath539 isometric to a subset of the real line @xmath150 . thus using some parameterization by arclength",
    "there exists an isometric map @xmath540 , with @xmath541 , @xmath542 , where @xmath543 is either empty or an open interval .",
    "we call the image @xmath544 an _ geodesic minus interval _ through @xmath158 and @xmath139 .",
    "we do not know uniqueness in the moment .",
    "the geodesic minus interval contains at least one ray .",
    "it may be that @xmath545 $ ] and in this case , there may not be a geodesic between @xmath158 and @xmath139 .",
    "thus @xmath539 is in general not a geodesic space .",
    "in particular we can not directly use the results of section [ subsec : uofptcirc ] .",
    "even if a geodesic exists between two points , we do not know uniqueness .",
    "we can also not use the hitzelberger lytchak theorem .",
    "instead we have to reprove the relevant results in our special situation .",
    "we first have to state some properties of affine functions .",
    "let @xmath539 be a ( not necessarily geodesic ) metric space . in our context",
    "@xmath539 is the space @xmath448 .",
    "for @xmath546 we denote by @xmath547 the set of midpoints of @xmath158 and @xmath139 .",
    "a function @xmath176 is called _ affine _ , if for all @xmath87 and all @xmath548 , we have @xmath549 . + essential for our argument is that busemann functions of geodesic rays are affine in this sense .",
    "we postpone the proof and focus on the consequences .",
    "+ we set @xmath551 @xmath552 is a banachspace , where @xmath553 is the optimal lipschitz constant .",
    "we set @xmath554 , where @xmath555 if @xmath556 is constant . by @xmath557",
    "$ ] we denote the equivalence class of @xmath75 .",
    "then also @xmath558 is a banachspace , where @xmath559\\|=\\|f\\|$ ] .",
    "+ let @xmath560 be the banach dual space of @xmath558 with the norm @xmath561\\in{\\mathcal{a}}(m)}\\frac{|\\rho([f])|}{\\|[f]\\|}.\\ ] ] for @xmath546 let @xmath562 be the evaluation map @xmath563)=f(x)-f(y)$ ] .",
    "it follows directly from the definitions that @xmath564 .",
    "+ for a given basepoint @xmath565 the map @xmath566 note that @xmath567 is @xmath379-lipschitz since @xmath568 if @xmath536 and @xmath569 then for all @xmath557 \\in { \\mathcal{a}}$ ] we have @xmath570=f(z)-f(o)=\\frac{1}{2}(f(x)+f(y))-f(o ) = ( \\frac{1}{2}e(x , o)+\\frac{1}{2}e(y , o))[f].\\ ] ] this implies @xmath571 we now show that @xmath567 is actually an isometric map .",
    "let @xmath546 , then we have a geodesic minus interval @xmath572 . recall that @xmath573 contains at least one ray and",
    "let @xmath365 the busemann function of such a ray .",
    "then @xmath365 is @xmath379-lipschitz and @xmath574 . +",
    "hence @xmath575)|=|b(y)-b(x)|=d(x , y).\\ ] ] thus @xmath567 is an isometric embedding of @xmath539 into the banachspace @xmath576 .",
    "the equation ( [ eq : add ] ) shows that the geodesic minus interval is mapped to an affine line minus interval in the banachspace @xmath577 .",
    "+ for simplicity we consider in the sequel @xmath539 as a subset of the vector space @xmath577 .",
    "[ l:1 ] let @xmath578 be finitely many points .",
    "let @xmath579 be the affine hull of these points , i.e. the smallest affine subspace containing these points .",
    "then @xmath580 contains an open set in the induced topology of @xmath579 .",
    "this is proven by induction on the dimension of @xmath579 , where the case of dimension @xmath581 is trivial .",
    "assume now that the affine hull of @xmath582 has dimension @xmath583 .",
    "then there exists a subset @xmath584 , that the dimension of the affine hull @xmath585 of @xmath586 is @xmath167 and by induction hypothesis there exists an open subset @xmath587 , with @xmath588 .",
    "furthermore there exists a point @xmath589 such that @xmath590 . for",
    "every @xmath591 consider the line minus interval @xmath592 .",
    "we reparameterize these lines minus interval proportionally to arclength such that @xmath593 and @xmath594 .",
    "then @xmath595 is an open interval .",
    "if for all @xmath591 , @xmath596 = \\emptyset$ ] , then @xmath597 is an open subset of @xmath579 .",
    "if for some @xmath598 we have @xmath599\\ne \\emptyset$ ] then @xmath600 and then also @xmath601 for all @xmath602 , where @xmath603 is an open neighborhood of @xmath598 in @xmath604 . then @xmath605 is an open subset of @xmath579 .",
    "let @xmath609 be distinct points .",
    "by assumption on @xmath539 the exists a ptolemy segment @xmath537 in @xmath610 containing these points .",
    "we have to show that @xmath611 .",
    "we actually show that @xmath612 , where @xmath585 is the affine hull of @xmath613 .",
    "let @xmath614 , we show that @xmath615 .",
    "we can assume @xmath616 and furthermore that all four points are distinct .",
    "take the affine hull @xmath617 of @xmath618 , then @xmath619 .",
    "by lemma [ l:2 ] @xmath617 is a euclidean space and the four points satisfy the ptolemy equality . by the classical ptolemy theorem",
    "this implies that @xmath9 is contained in the affine hull of the three other points .",
    "it suffices to show that there is a number @xmath620 , such that the dimension of the affine hull of any finite subset @xmath621 is bounded by @xmath439 .",
    "if we assume the contrary , there are points @xmath622 , such that the affine hull of @xmath623 is an @xmath0-dimensional euclidean affine subspace @xmath624 .",
    "by lemma [ l:3 ] , @xmath625 is a @xmath164-point ptolemy segment space , and hence @xmath625 is either @xmath626 , isometric to a closed halfspace or isometric to the complement of a distance ball in @xmath626 by proposition [ prop : eucl ] . in every case @xmath580 contains a complete hyperplane @xmath627 of dimension @xmath628 through the point @xmath629 .",
    "we can arrange the hyperplanes such that @xmath630 for all @xmath0 . since @xmath539 is locally compact ,",
    "this is a contradiction .",
    "now we can finish the proof of theorem [ theo-3pt - int ] . by lemma [ l:4 ]",
    ", @xmath539 can be considered as a subset of the classical space @xmath631 and for this case the result follows from proposition [ prop : eucl ] .",
    "+ now we give the      let @xmath458 be an arbitrary geodesic ray in @xmath450 and let @xmath365 a busemann function of that ray . consider again @xmath460 with @xmath461 . as in the proof of [ pro : busemann_convex_circle ] we have again to show the equation ( [ eq:0 ] ) :        we restrict the segment that it contains two of these points as boundary points and one as an interior point .",
    "after choice of a subsequence , we can assume that one of the following three cases occurs : all @xmath466 have          in case ( ii ) there exists a pt segment @xmath466 with boundary points @xmath158 and @xmath139 and interior point @xmath468 .",
    "here we choose the orientation , such that @xmath633 and again we choose @xmath471 , with @xmath634 such that @xmath635 .",
    "the pt equality for this segment implies again @xmath636 and hence we again obtain estimate ( [ eq:1 ] ) .",
    "the pt equality for @xmath466 says @xmath637 this implies again for @xmath465 , that @xmath638 , which again implies that @xmath139 is a midpoint of @xmath167 and @xmath286 and hence we have ( [ eq:3 ] ) again .",
    "( of proposition [ prop : eucl ] ) consider @xmath530 as in the assumption .",
    "let @xmath411 be the smallest affine subspace of @xmath532 containing @xmath639 . to simplify the notation we assume that @xmath640 ( otherwise the result follows by induction ) .",
    "case 2 : assume that @xmath642 is contained in some halfspace . by changing coordinates we may assume @xmath643 .",
    "let @xmath644 and assume that for the last coordinates we have @xmath645 .",
    "since @xmath646 are on a circle - segment ( i.e. line - segment ) contained in @xmath19 , but @xmath642 does not intersect the lower halfspace , we see that the semiline @xmath647 , @xmath648 is completely contained in @xmath19 .                case 3 : in the remaining case we consider that @xmath642 is not contained in a halfspace and not the complete @xmath532",
    ". then there exists an open distance ball @xmath657 , such that there exists a point @xmath658 . by changing coordinates",
    "we can assume that @xmath659 is the origin .",
    "now apply the involution @xmath660 , @xmath661 , @xmath662 , which is a mbius map and maps circles to circles . under",
    "this involution @xmath663 goes to an open halfspace and hence we have reduced this case to case 2 .",
    "thomas foertsch,10em= viktor schroeder , + mathematisches institut , institut fr mathematik , + universitt bonn , universitt zrich , + endenicher allee 60 , winterthurer strasse 190 , + d-53115 bonn , deutschland ch-8057 zrich , switzerland + foertsch@math.uni-bonn.de +"
  ],
  "abstract_text": [
    "<S> in this paper we characterize compact extended ptolemy metric spaces with many circles up to mbius equivalence . </S>",
    "<S> this characterization yields a mbius characterization of the @xmath0-dimensional spheres @xmath1 and hemispheres @xmath2 when endowed with their chordal metrics . </S>",
    "<S> in particular , we show that every compact extended ptolemy metric space with the property that every three points are contained in a circle is mbius equivalent to @xmath3 for some @xmath4 , the @xmath0-dimensional sphere @xmath1 with its chordal metric . </S>"
  ]
}