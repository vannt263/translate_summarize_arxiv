{
  "article_text": [
    "in this paper , we present a technique to apply perturbative techniques to maxwell s equations with anisotropic materials , in particular for the case where the position of an interface between two such materials is perturbed , generalizing an earlier result for isotropic materials @xcite . in this case , the discontinuities of the fields at the interface cause many standard perturbative methods to fail , which is unfortunate because such methods are very useful for many problems in electromagnetism where one wishes to study the effect of small deviations from a given structure  not only do perturbative methods allow one to apply the computational efficiency of idealized problems to more realistic situations , but they may also offer greater analytical insight than brute - force numerical approaches .",
    "the corrected solution described in this paper should aid the study of interface perturbations , from surface roughness to fiber birefringence , in the context of anisotropic materials .",
    "such materials have become increasingly important thanks to the discovery of `` metamaterials , '' subwavelength composite structures that simulate homogeneous media with unusual properties such as negative refractive indices @xcite , and which may be strongly anisotropic in certain applications  for example , those involving spherical or cylindrical geometries @xcite such as recent proposals for `` invisibility '' cloaks @xcite .",
    "furthermore , we have recently shown that interface - perturbation analyses benefit even purely brute - force computations , because they enable the design of sub - pixel smoothing techniques that greatly increase the accuracy ( and may even increase the _ order _ of convergence ) of discretized methods @xcite , which are normally degraded by discontinuous interfaces @xcite . here ,",
    "we show that our corrected perturbation analysis provides similar benefits for modeling anisotropic materials , where it yields a second - order accurate smoothing technique ( correcting a _ _ _ _ previous heuristic proposal @xcite ) .",
    "there have been several previous approaches to rigorous treatment of interface perturbations in electromagnetism , where classic approaches for small @xmath0 perturbations fail because of the field discontinuities @xcite .",
    "one approach that was applied successfully to boundaries between isotropic materials is essentially to guess the correct form of the perturbation integral and then to prove _ a posteriori _ that it is correct @xcite . for isotropic materials , where there is some guidance from effective - medium heuristics @xcite , this was practical , but the correct answer ( below ) appears to be much more difficult to guess for anisotropic materials .",
    "another approach , which generalizes to the more difficult case of small surface `` bumps '' that are not locally flat , was to express the problem in terms of finding the polarizability of the perturbation and then connecting it back to the perturbation integral via the method of images @xcite . for a locally flat perturbation between isotropic materials ,",
    "this process can be carried out analytically to reproduce the previous result from ref .",
    "@xcite , but it becomes rather complicated for anisotropic media .",
    "third , one can transform the problem into a statement about the coordinate system to avoid problems of shifting field discontinuities , by finding a coordinate transformation that expresses the interface shift @xcite .",
    "this approach , while powerful , has two shortcomings : first , finding an explicit coordinate transformation may be difficult for a complicated interface perturbation ; and second , the resulting perturbation integrals are expressed in terms of the fields everywhere in space , not just at the boundaries .",
    "intuitively , one expects that the effect of the perturbation should depend only on the field at the boundaries , as was found explicitly for the isotropic case @xcite . in this paper",
    ", we derive precisely such an expression for the case of interfaces between anisotropic materials , by developing a general new analytical technique for interface perturbations : we express the perturbation as a coordinate transformation , but using a coordinate transform _ localized _ around the perturbed interface , and take a limit in which this localization becomes narrower and narrower so that the choice of transform disappears from the final result .    in the following sections , we first formulate the problem of the effect of an interface perturbation more precisely , relate our formulation to other possibilities , and summarize our final result in the form of eq .",
    "( [ eq : pert - surf ] ) .",
    "we then derive quite generally how to formulate the problem of interface perturbations in terms of a localized coordinate transformation , and show how this allows us to express the perturbation - theory integral as a sum of contributions around individual _ points _ on the interface .",
    "next , we apply this framework to the specific problem of a boundary between two anisotropic dielectric materials , and derive our final result . as a check",
    ", our perturbation theory is then validated against brute - force computations for a simple numerical example . finally ,",
    "we discuss the application of our new perturbation result to sub - pixel smoothing of discretized numerical methods , and show that we obtain a smoothing technique that leads to much more accurate results at a given spatial resolution . in the appendix",
    ", we provide a compact derivation and generalization of a useful result @xcite relating coordinate transformations to changes in @xmath1 and @xmath2 .",
    "there are many ways to formulate perturbation techniques in electromagnetism .",
    "one common formulation , analogous to `` time - independent perturbation theory '' in quantum mechanics @xcite , is to express maxwell s equations as a generalized hermitian eigenproblem @xmath3 in the frequency @xmath4 and electric field @xmath5 ( or equivalent formulations in terms of the magnetic field @xmath6 ) @xcite , and then to consider the first - order change @xmath7 in the frequency from a small change @xmath0 in the dielectric function @xmath8 ( assumed real and positive ) , which turns out to be @xcite : @xmath9 where @xmath5 and @xmath4 are the electric field and eigenfrequency of the _ unperturbed _ structure @xmath1 , respectively , and @xmath10 denotes complex conjugation .",
    "the key part of this expression is the numerator of the right - hand side , which is what expresses the effect of the perturbation , and this same numerator appears in a nearly identical form for many different perturbation techniques .",
    "for example , one obtains a similar expression in : finding the perturbation @xmath11 in the propagation constant @xmath12 of a waveguide mode @xcite ; the coupling coefficient ( @xmath13 ) between two modes @xmath5 and @xmath14 in coupled - wave theory @xcite ; or the scattering current @xmath15 ( and the scattered power @xmath16 ) in the `` volume - current '' method ( equivalent to the first born approximation ) @xcite .",
    "( [ eq : freq - pert ] ) also corresponds to an _ exact _ result for the _ derivative _ of @xmath4 with respect to any parameter @xmath17 of @xmath1 , since if we write @xmath18 we can divide both sides by @xmath19 and take the limit @xmath20 ; this result is equivalent to the hellman - feynman theorem of quantum mechanics @xcite . in cases where the unperturbed @xmath1 is not real",
    ", corresponding to absorption or gain , or when one is considering `` leaky modes , '' the eigenproblem typically becomes complex - symmetric rather than hermitian and one obtains a similar formula but without the complex conjugation @xcite .",
    "therefore , any modification to the form of this numerator for the frequency - perturbation theory immediately leads to corresponding modified formulas in many other perturbative techniques , and it is sufficient for our purposes to consider frequency - perturbation theory only .",
    "schematic of an interface perturbation : the interface between two materials @xmath21 and @xmath22 ( possibly anisotropic ) is shifted by some small position - dependent displacement @xmath23 . ]    as we showed in ref .",
    "@xcite , eq .",
    "( [ eq : freq - pert ] ) is not valid when @xmath0 is due to a small change in the position of a boundary between two dielectric materials ( except in the limit of low dielectric contrast ) , but a simple correction is possible . in particular ,",
    "let us consider situations like the one shown in fig .",
    "[ fig : surface - pert ] , where the dielectric boundary between two materials @xmath24 and @xmath25 is shifted by some small displacement @xmath23 ( which may be a function of position ) . directly applying eq .",
    "( [ eq : freq - pert ] ) , with @xmath26 in the regions where the material has changed , gives an incorrect result , and in particular @xmath27 ( which should ideally go to the exact derivative @xmath28 ) is incorrect even for @xmath29 .",
    "the problem turns out to be not so much that @xmath0 is not small , but rather that @xmath5 is discontinuous at the boundary , and the standard method in the limit @xmath29 leads to an ill - defined surface integral of @xmath5 over the interfaces . for _ isotropic _ materials , corresponding to _ scalar _",
    "@xmath30 , the correct numerator turns out to be , instead , the following surface integral over the boundary @xcite : @xmath31{\\mathbf{h}}\\cdot d{\\mathbf{a}},\\label{eq : pert - surf - scalar}\\end{gathered}\\ ] ] where @xmath32 and @xmath33 are the ( continuous ) components of @xmath5 and @xmath34 parallel and perpendicular to the boundary , respectively , @xmath35 points towards @xmath25 , and @xmath36 is the displacement of the interface from @xmath24 towards @xmath25 .    in this paper",
    ", we will generalize eq .",
    "( [ eq : pert - surf - scalar ] ) to handle the case where the two materials are _ anisotropic _ , corresponding to arbitrary @xmath37 tensors @xmath21 and @xmath22 ( assumed hermitian and positive - definite to obtain a well - behaved hermitian eigenproblem ) . in the generalized case , it is convenient to define a local coordinate frame @xmath38 at each point on the surface , where the @xmath39 direction is orthogonal to the surface and the @xmath40 directions are parallel .",
    "we also define a continuous field `` vector '' @xmath41 so that @xmath42 and @xmath43 . as derived below , the resulting numerator of eq .",
    "( [ eq : freq - pert ] ) , generalizing eq .",
    "( [ eq : pert - surf - scalar ] ) , is : @xmath44\\cdot{\\mathbf{f}}\\,{\\mathbf{h}}\\cdot d{\\mathbf{a}},\\label{eq : pert - surf}\\ ] ] where @xmath45 is the @xmath37 matrix : @xmath46 which reduces to eq .",
    "( [ eq : pert - surf - scalar ] ) when @xmath47 is a scalar multiple @xmath1 of the identity matrix .",
    "( our assumption that @xmath47 is positive - definite guarantees that @xmath48 . )",
    "we should note an important restriction : eq .",
    "( [ eq : pert - surf - scalar ] ) and eq .",
    "( [ eq : pert - surf ] ) require that the radius of curvature of the interface be much larger than @xmath49 , except possibly on a set of measure zero ( such as at isolated corners or edges ) .",
    "otherwise , more complicated methods must be employed @xcite .",
    "for example one can not apply the above equations to the case of a hemispherical `` bump '' of radius @xmath23 on the unperturbed surface , in which case the lowest order perturbation is @xmath50 and requires a small numerical computation of the polarizability of the hemisphere @xcite .",
    "the difficulty with applying the standard perturbation - theory result ( [ eq : freq - pert ] ) to a boundary perturbation is that , instead of a _ small _ @xmath0 with _ fixed _",
    "boundary conditions on the fields ( to lowest order ) , we have a _ large _",
    "@xmath0 over a small region in which the field boundary discontinuities have _",
    "shifted_. however , we can transform one problem into the other : we construct a coordinate transformation that maps the new boundary location back onto the old boundary , so that in the new coordinates the boundary conditions are unaltered while there is a small change in the differential operators due to the coordinate shift . in expressing the problem in this fashion",
    ", we will present two key techniques .",
    "first , we employ a result from @xcite , generalized in the appendix to anisotropic materials , that expresses an arbitrary coordinate transform as a change @xmath51 and @xmath52 in the permittivity and permeability tensors , which allows us to directly apply eq .",
    "( [ eq : freq - pert ] ) .",
    "second , unlike refs .",
    "@xcite , we do not wish to _ explicitly _ construct any coordinate transformation , since this may become very complicated for an arbitrary perturbation in an arbitrary - shaped boundary .",
    "instead , we express the boundary shift in terms of a _ local _ coordinate transform , that only `` nudges '' the coordinates near the perturbed boundary , and in the limit where the region of this coordinate perturbation becomes arbitrarily small we will recover the coordinate - independent surface integrals ( [ eq : pert - surf - scalar ] ) and ( [ eq : pert - surf ] ) .",
    "suppose that in a certain coordinate system @xmath53 we have electric field @xmath54 , magnetic field @xmath55 , dielectric tensor @xmath56 , and relative magnetic permeability tensor @xmath57 , satisfying the euclidean maxwell s equations .",
    "now , we transform to some new coordinates @xmath58 , with a @xmath37 jacobian matrix @xmath59 defined by @xmath60 . in the new coordinates , the fields can still be written as the solution of the euclidean maxwell s equations if the following transformations are made in addition to the change of coordinates : @xmath61 @xmath62 @xmath63 @xmath64 where @xmath65 denotes the transpose .",
    "this result is derived in the appendix , generalized from the result for scalar @xmath1 and @xmath2 from ref .",
    "@xcite .    now",
    ", suppose the coordinate change is `` small , '' meaning that @xmath66 , where the eigenvalues of @xmath67 are everywhere @xmath68 for some small parameter @xmath69 .",
    "then @xmath70=o(\\delta)$ ] and similarly @xmath71 .",
    "therefore , the solutions of maxwell s equations will be _ nearly _ those of @xmath47 and @xmath72 merely translated to the new coordinate locations , and the difference due to @xmath51 and @xmath52 can be accounted for , to @xmath73 , by first - order perturbation theory",
    ". that is , generalizing eq .",
    "( [ eq : freq - pert ] ) to the case of anisotropic media with both @xmath47 and @xmath72 , one finds by elementary perturbation theory for the generalized eigenproblem:@xmath74\\ , d^{3}{\\mathbf{x}}'}{\\int\\left[{\\mathbf{e}}_{0}^{*}\\cdot{\\boldsymbol{\\varepsilon}}\\cdot{\\mathbf{e}}_{0}+{\\mathbf{h}}_{0}^{*}\\cdot{\\boldsymbol{\\mu}}\\cdot{\\mathbf{h}}_{0}\\right]\\ , d^{3}{\\mathbf{x}}'}+o(\\delta^{2})\\nonumber \\\\   & = -\\frac{\\int\\left[{\\mathbf{e}}_{0}^{*}\\cdot\\delta{\\boldsymbol{\\varepsilon}}\\cdot{\\mathbf{e}}_{0}+{\\mathbf{h}}_{0}^{*}\\cdot\\delta{\\boldsymbol{\\mu}}\\cdot{\\mathbf{h}}_{0}\\right]\\ , d^{3}{\\mathbf{x}}'}{2\\int{\\mathbf{e_{0}}}^{*}\\cdot{\\boldsymbol{\\varepsilon}}\\cdot{\\mathbf{e}}_{0}\\ , d^{3}{\\mathbf{x}}'}+o(\\delta^{2}),\\label{eq : freq - pert - aniso}\\end{aligned}\\ ] ] where the `` 0 '' subscripts denote the solution for the unperturbed system , given by @xmath75 $ ] and @xmath76 $ ] , i.e. @xmath47 and @xmath72 simply translated into the @xmath77 coordinates without transforming by the jacobian factors .",
    "suppose that we have an unperturbed interface between two materials @xmath21 and @xmath22 that forms a surface @xmath78 ( i.e. , the points @xmath79 ) , and we perturb it to a new interface @xmath80 by a small perpendicular shift @xmath81 as depicted schematically in fig .",
    "[ fig : surface - pert ] . in order to investigate this boundary shift",
    ", we will perform a coordinate transform @xmath58 that shifts @xmath80 to @xmath82 .",
    "that is , in our new coordinates , the interface has not been perturbed , but the materials have changed by the jacobian factors as described in the previous section .",
    "moreover , we will construct our coordinate transform so that it is _ localized _ to the interface , i.e. so that @xmath83 far from @xmath78 . in particular , we write : @xmath84 where @xmath85 $ ] is some differentiable localized function , equal to unity on the interface [ @xmath86 and identically zero outside some small radius-@xmath87 neighborhood of the interface ( the _ support _ of @xmath88 lies within this neighborhood ) , chosen so that @xmath89 . eq .  ( [ eq : coord - shift ] )",
    "is constructed so that @xmath90 implies @xmath91 , causing the new interface @xmath80 to be mapped to @xmath78 as desired .",
    "thus , @xmath81 for @xmath90 must be the perpendicular displacement from @xmath78 to @xmath80 .",
    "for @xmath92 , @xmath81 should be some differentiable , slowly - varying function ( except possibly at isolated surface kinks and discontinuities ) .",
    "the precise functions @xmath88 and @xmath36 will turn out to be irrelevant to our final answer ( [ eq : pert - surf ] ) , so we need not construct them explicitly",
    ".    we will take @xmath93 to be the small parameter of our perturbation theory , and will concern ourselves with obtaining the correct first - order @xmath7 in the limit @xmath29 .",
    "we will also eventually take the limit @xmath94 , but will still require @xmath95 in order to ensure , as shall become apparent below , that the jacobian factor of the coordinate transformation remains close to unity .",
    "( that is , we let @xmath23 go to zero faster than @xmath96 . ) finally , in order to have @xmath81 be sufficiently slowly varying that we can neglect its derivatives compared to the derivatives of @xmath97 , below , it will be important to require that the radius of curvature of @xmath78 and @xmath80 be much larger than @xmath23 , except possibly at isolated points ; otherwise , more complicated perturbative methods are required @xcite .",
    "the coordinate transformation ( [ eq : coord - shift ] ) representing our boundary perturbation is localized around the perturbed interface , but is convenient to go one step further : we will represent the coordinate transform as a _ summation _ of coordinate transformations localized around individual _",
    "points _ on the interface , by exploiting the concept of a _ partition of unity _ from topology @xcite , reviewed below .",
    "consider the support of the function @xmath97 from above .",
    "this support is covered by the open set of spherical radius-@xmath96 neighborhoods of every point on the surface , and that covering must admit a locally finite subcovering @xmath98 ; that is , a subset of neighborhoods @xmath98 such that every point on the surface intersects finitely many neighborhoods @xmath99 , and the union of the @xmath99 covers the support of @xmath88 .",
    "there must also exist a partition of unity @xmath100 : a set of differentiable functions @xmath101 $ ] with support @xmath102 , such that @xmath103 everywhere in the support of @xmath88 .",
    "we can then write @xmath104l({\\mathbf{x}})=\\sum_{\\alpha}k^{(\\alpha)}({\\mathbf{x}}),\\label{eq : l - partition}\\ ] ] where each @xmath105 $ ] is a differentiable function localized to a small radius-@xmath96 neighborhood @xmath99 of a single point on the interface .",
    "the jacobian @xmath59 of the coordinate transformation ( [ eq : coord - shift ] ) can then be written in the form : @xmath106 where @xmath107\\label{eq : delta - jactens - alpha}\\ ] ] has support @xmath102 .",
    "the key advantage of this construction arises if we look at @xmath108 from eq .",
    "( [ eq : eps - trans ] ) . assuming @xmath109 is small and we are computing @xmath51 to first - order",
    ", then we can write @xmath110 as a sum of contributions from each @xmath111 individually , and similarly for @xmath52 .",
    "therefore , when computing the first - order perturbation @xmath7 from eq .",
    "( [ eq : freq - pert - aniso ] ) , we can write @xmath112 as a sum of contributions @xmath113 analyzed in each point neighborhood separately .",
    "this removes the need to deal with the complex shape of the entire boundary at once , and is the procedure that we adopt in the following section .",
    "in the previous section , we established several important preliminary results that allow us to express a boundary perturbation , via coordinate transformation , as a sum of localized material perturbations @xmath114 and @xmath115 around individual points of the boundary .",
    "we will now explicitly evaluate those contributions , taking the limit as the perturbation @xmath29 and the coordinate distortion radius @xmath94 to obtain our coordinate - independent final result , eq .",
    "( [ eq : pert - surf ] ) .",
    "schematic of an interface perturbation as in fig .",
    "[ fig : surface - pert ] , magnifying a small portion of the interface where the surface is locally flat .",
    "a local coordinate frame @xmath38 is chosen so that @xmath39 is perpendicular to the surface , and so that @xmath116 denotes the location of the perturbed surface @xmath80 ( shifted perpendicularly by @xmath36 from the original surface @xmath78 ) . ]",
    "we therefore restrict our attention to a single neighborhood @xmath99 and the contribution from the corresponding term @xmath117 in the coordinate transformation . in this small neighborhood of radius @xmath96 , we can take @xmath118 to be a constant to lowest order in @xmath96 . in this case , the interface is locally flat , and we can choose a local coordinate frame @xmath38 so that @xmath39 is the direction perpendicular to the interface at @xmath116 , with @xmath119 corresponding to @xmath21 and @xmath120 corresponding to @xmath22 , as shown in fig .",
    "[ fig : surface - pert - zoom ] . in this coordinate frame @xmath121 , the jacobian contribution @xmath111 simplifies to : @xmath122 where @xmath123 is the kronecker delta and @xmath124 denotes @xmath125 . since @xmath126 by assumption and @xmath127 $ ] is a smooth localized function with support of radius @xmath96 , @xmath117 can be constructed so that @xmath128 , i.e so that the derivatives are small .",
    "this will make @xmath59 close to unity and allow us to use the perturbation equation  ( [ eq : freq - pert - aniso ] ) .",
    "we must now construct @xmath114 to first order . since @xmath129",
    ", we obtain : @xmath130 combined with eq .",
    "( [ eq : delta - jactens - alpha ] ) , we can now evaluate eq .",
    "( [ eq : eps - trans ] ) for @xmath131 , to lowest order , to obtain @xmath132 , with @xmath133h^{(\\alpha)}.\\label{eq : delta - eps - alpha}\\ ] ] this will contribute to ( [ eq : freq - pert - aniso ] ) via the integral : @xmath134 where we have dropped the `` @xmath135 '' subscript from the unperturbed field @xmath5 for simplicity . in order to simplify this integral",
    ", we will write @xmath136 in terms of @xmath41 , since @xmath137 is continuous whereas @xmath138 is not . solving for @xmath138 in @xmath139 yields @xmath140 , and thus @xmath141 where @xmath142 because @xmath137 is continuous , we can write @xmath143 , where the @xmath144 term is a higher - order contribution to @xmath145 that can be dropped and the @xmath146 is a constant that can be pulled out of the integral .",
    "therefore , we are left with@xmath147\\cdot{\\mathbf{f}}^{(\\alpha)}+o(hr),\\label{eq : i - alpha - f}\\ ] ] where @xmath148 is the conjugate - transpose .",
    "this integral now simplifies a great deal , because the only non - constant terms are from the @xmath124 and the step - function @xmath149 dependence of @xmath56 .",
    "in particular , the integrals over the @xmath150 and @xmath151 terms vanish , because along the @xmath152 and @xmath153 directions , respectively , they are integrals of the derivatives of a function @xmath117 that vanishes at the endpoints .",
    "we are left with the @xmath154 terms , which yield the integrand : @xmath155\\,\\theta(x_{1})\\right\\ } \\ , k_{1}^{(\\alpha)}h^{(\\alpha)}\\label{eq : k1-integrand}\\end{gathered}\\ ] ] where the product of the three matrices gives precisely the matrix @xmath45 defined in eq .",
    "( [ eq : ptens - definition ] ) , using the assumption that @xmath47 is hermitian ( @xmath156 ) . when eq .",
    "( [ eq : k1-integrand ] ) is integrated by parts in the @xmath39 direction , we obtain the integral of @xmath117 multiplied by a delta function @xmath157 from the derivative of @xmath149 , producing : @xmath158\\ , k^{(\\alpha)}(0,x_{2},x_{3})h^{(\\alpha)}dx_{2}dx_{3}.\\label{eq : i - alpha - final}\\ ] ] when this is summed over @xmath159 to obtain the total perturbation integral , however , @xmath160 by construction ( since @xmath161 on the interface ) .",
    "thus , we obtain the surface integral of eq .",
    "( [ eq : pert - surf ] ) , as desired , where @xmath162 .",
    "the analysis of the @xmath115 term proceeds identically , although here the continuous field components are @xmath163 , but in this case it yields zero if @xmath164 ( as in the common case of non - magnetic materials where @xmath2 is identically 1 ) .",
    "to check the correctnessf of the perturbative analysis above , we performed the following numerical computation .",
    "we solve the full - vector maxwell eigenproblem numerically , for inhomogeneous anisotropic dielectric structures , by iterative rayleigh - quotient minimization in a planewave basis , using a freely available software package @xcite .",
    "given an arbitrary structure , we can then evaluate the derivative of the eigenfrequency for a shifting interface , both by the perturbation eq .",
    "( [ eq : pert - surf ] ) and by numerical differentiation of the eigenfrequencies ( here , differentiating a cubic - spline interpolation ) .    numerical validation of perturbation - theory formula , applied to compute the derivative @xmath28 for a gaussian `` bump '' of height @xmath23 on a square lattice ( period @xmath165 ) of anisotropic-@xmath1 rectangles ( inset ) with an eigenfrequency @xmath4 ( corresponding to @xmath166 ) .",
    "positive / negative @xmath23 indicate bumps / indentations ( see lower - right / left insets for @xmath167 ) , respectively .",
    "solid lines are numerical differentiation of the eigenfrequency , and dots are from perturbation theory .",
    "the different lines correspond to different random dielectric tensors @xmath21 and @xmath22 . ]    in particular , we considered a two - dimensional photonic crystal @xcite consisting of a square lattice ( lattice constant @xmath165 ) of @xmath168 dielectric blocks of a material @xmath21 surrounded by @xmath22 , with gaussian bumps on one side ( inset of fig .",
    "[ fig : randbump ] ) . here ,",
    "@xmath21 and @xmath22 are chosen to be random symmetric positive - definite matrices with eigenvalues ranging from 2 to 12 for @xmath21 and from 1 to 5 for @xmath22 .",
    "on the right side of each block ( along one of the @xmath169 edges ) is a gaussian bump of height @xmath170 , with a width @xmath171 and amplitude @xmath23 ( where @xmath172 denotes an indentation ) .",
    "we then computed the lowest eigenvalue @xmath173 and eigenfields @xmath5 for a set of @xmath23 values @xmath174 $ ] , at a bloch wavevector @xmath175 ( leading to modes with a vacuum wavelength @xmath166 ) .",
    "given this data , we then compared the derivative @xmath28 as computed by the perturbation equation  ( [ eq : pert - surf ] ) compared to the derivative of a cubic - spline fit of the frequency data .",
    "this was repeated for six different random @xmath21 and @xmath22 .",
    "the results , shown in fig .  [ fig : randbump ] , demonstrate that the perturbation formula indeed predicts the exact slope @xmath23 as expected ( with tiny discrepancies , due to the finite resolution , too small to see on this graph ) .",
    "in any numerical method involving the solution of the full - vector maxwell s equations on a discrete grid or its equivalent , such as the planewave method above @xcite or the finite - difference time - domain ( fdtd ) method @xcite , discontinuities in the dielectric function @xmath1 ( and the corresponding field discontinuities ) generally degrade the accuracy of the method , typically reducing it to only linear convergence with resolution @xcite .",
    "unfortunately , piecewise - continuous @xmath1 is the most common experimental situation , so a technique to improve the accuracy ( without switching to an entirely different computational method ) is desirable .",
    "one simple approach that has been proposed by several authors is to _ smooth _ the dielectric function , or equivalently to set the @xmath1 of each `` pixel '' to be some average of @xmath1 within the pixel , rather than merely sampling @xmath1 in a `` staircase '' fashion @xcite .",
    "unfortunately , this smoothing itself changes the structure , and therefore introduces errors .",
    "we analyzed this situation in a recent paper for the fdtd method @xcite , and showed that the problem is closely related to perturbation theory : one desires a smoothing of @xmath1 that has _ zero first - order effect _",
    ", to minimize the error introduced by smoothing and so that the underlying second - order accuracy can potentially be preserved . at an interface between two isotropic dielectric materials , the first - order perturbation is given by eq .",
    "( [ eq : pert - surf - scalar ] ) , and this leads to an _ anisotropic _ smoothing : one averages @xmath176 for field components perpendicular to the interface , and averages @xmath1 for field components parallel to the interface , a result that had previously been proposed heuristically by several authors @xcite .    in this section",
    ", we generalize that result to interfaces between anisotropic materials , and illustrate numerically that it leads to both dramatic improvements in the absolute magnitude and the convergence rate of the discretization error . in the anisotropic - interface case ,",
    "a heuristic subpixel smoothing scheme was previously proposed @xcite , but we now show that this method was suboptimal : although it is better than other smoothing schemes , it does not set the first - order perturbation to zero and therefore does not minimize the error or permit the possibility of second - order accuracy .",
    "specifically , as discussed more explicitly below , a second - order smoothing is obtained by averaging @xmath45 and then inverting @xmath45 to obtain the smoothed `` effective '' dielectric tensor .",
    "because this scheme is analytically guaranteed to eliminate the first - order error otherwise introduced by smoothing , we expect it to generally lead to the smallest numerical error compared to competing smoothing schemes , and there is the hope that the overall convergence rate may be quadratic with resolution .    first , let us analyze how perturbation theory leads to a smoothing scheme .",
    "suppose that we smooth the underlying dielectric tensor @xmath56 into some locally averaged tensor @xmath177 , by some method to be determined below .",
    "this involves a change @xmath178 , which is likely to be large near points where @xmath47 is discontinuous ( and , conversely , is zero well inside regions where @xmath47 is constant ) . in particular",
    ", suppose that we employ a smoothing radius ( defined more precisely below ) proportional to the spatial resolution @xmath179 of our numerical method , so that @xmath51 is zero [ or at most @xmath180 $ ] except within a distance @xmath181 of discontinuous interfaces .",
    "to evaluate the effect of this large perturbation near an interface , we must employ an equivalent reformulation of eq .",
    "( [ eq : pert - surf ] ) : @xmath182 where @xmath183 ) .",
    "it is sufficient to look at the perturbation in @xmath4 , since ( as we remarked in sec .",
    "[ sec : problem - formulation ] ) the same integral appears in the perturbation theory for many other quantities ( such as scattered power , etc . ) .",
    "if we let @xmath39 denote the ( local ) coordinate orthogonal to the boundary , then the @xmath39 integral is simply proportional to @xmath184 : since @xmath137 is continuous and @xmath185 except near the interface , we can pull @xmath137 out of the @xmath39 integral to lowest order .",
    "that means , in order to make the first - order perturbation zero for all fields @xmath137 , it is sufficient to have @xmath186 .",
    "this is achieved by averaging @xmath187 as follows .",
    "the most straightforward interpretation of `` smoothing '' would be to convolve @xmath47 with some localized kernel @xmath188 , where @xmath189 and @xmath190 for @xmath191 greater than some smoothing radius ( the support radius ) proportional to the resolution @xmath181 .",
    "that is , @xmath192 .",
    "for example , the simplest subpixel smoothing , simply computing the average of @xmath47 over each pixel , corresponds to @xmath193 inside a pixel at the origin and @xmath194 elsewhere .",
    "however , this will not lead to the desired @xmath195 to obtain second order accuracy . instead",
    ", we employ : @xmath196={\\boldsymbol{\\tau}}^{-1}\\left\\ { \\int{\\boldsymbol{\\tau}}\\left[{\\boldsymbol{\\varepsilon}}({\\mathbf{y}})\\right]\\ , s({\\mathbf{x}}-{\\mathbf{y}})\\ , d^{3}{\\mathbf{y}}\\right\\ }",
    ".\\label{eq : eps - average}\\ ] ] where @xmath197 is the inverse of the @xmath45 mapping , given by:@xmath198 the reason why eq .",
    "( [ eq : eps - average ] ) works , regardless of the smoothing kernel @xmath188 , is that @xmath199\\ , s({\\mathbf{x}}-{\\mathbf{y}})\\ , d^{3}{\\mathbf{y}}-{\\boldsymbol{\\varepsilon}}({\\mathbf{x}})\\right\\ } \\nonumber \\\\   & = \\int d^{3}{\\mathbf{y\\,}}{\\boldsymbol{\\tau}}\\left[{\\boldsymbol{\\varepsilon}}({\\mathbf{y}})\\right]\\left\\ { \\int\\ , s({\\mathbf{x}}-{\\mathbf{y}})\\ , d^{3}{\\mathbf{y}}-1\\right\\ } \\nonumber \\\\   & = 0.\\label{eq : convolution - delta - tau - integral}\\end{aligned}\\ ] ] this guarantees that the integral of @xmath200 is zero over all space , but above we required what appears to be a stronger condition , that the local , interface - perpendicular integral @xmath201 be zero ( at least to first order ) . however , in a small region where the interface is locally flat ( to first order in the smoothing radius ) , @xmath200 must be a function of @xmath39 only by translational symmetry , and therefore ( [ eq : convolution - delta - tau - integral ] ) implies that @xmath186 by itself .",
    "although the above convolution formulas may look complicated , for the simplest smoothing kernel @xmath188 the procedure is quite simple : in each pixel , average @xmath45 in the pixel and then apply @xmath197 to the result .",
    "( this is not any more difficult to apply than the procedure implemented in ref .",
    "@xcite , for example . )    strictly speaking , the use of this smoothing does not guarantee second - order accuracy , even if the underlying numerical method is nominally second - order accurate or better . for one thing , although we have canceled the first - order error due to smoothing , it may be that the next - order correction is not second - order .",
    "precisely this situation occurs if one has a structure with sharp dielectric corners , edges , or cusps , as discussed in ref .",
    "@xcite : in this case , smoothing leads to a convergence rate between first order ( what would be obtained with no smoothing ) and second order , with the exponent determined by the nature of the field singularity that occurs at the corner .      as a simple illustration of the efficacy of the subpixel smoothing we propose in eq .",
    "( [ eq : eps - average ] ) , let us consider a two - dimensional example problem : a square lattice ( period @xmath165 ) of ellipses made of @xmath21 surrounded by @xmath22 , where we will find the lowest-@xmath4 bloch eigenmode . as above , we choose the dielectric tensors to be random positive - definite symmetric matrices with random eigenvalues in @xmath202 $ ] for @xmath21 and in @xmath203 $ ] for @xmath22 , and the ellipses are oriented at an arbitrary angle , at an arbitrary bloch wavevector @xmath204 , to avoid fortuitous symmetry effects .",
    "( the vacuum wavelength @xmath205 corresponding to the eigenfrequency @xmath4 is @xmath206 . ) for each resolution @xmath179 , we assign an @xmath207 to each pixel by computing @xmath197 of the average of @xmath45 within that pixel .",
    "then , we compute the relative error @xmath208 ( compared to a calculation at a much higher resolution ) as a function of resolution . for comparison , we also consider four other smoothing techniques : no smoothing , averaging @xmath47 in each pixel @xcite , averaging @xmath209 in each pixel , and a heuristic anisotropic averaging proposed by ref .",
    "@xcite in analogy to the scalar case .",
    "the results are shown in fig .",
    "[ fig : ellipse3 ] , based on the same planewave method as above @xcite , and show that the new smoothing technique clearly leads to the lowest errors @xmath208 .",
    "also , whereas the other methods yield clearly first - order convergence , the new method seems to exhibit roughly second - order convergence .",
    "the no - smoothing case has extremely erratic errors , as is typical for stair - casing phenomena .",
    "relative error @xmath208 for an eigenmode calculation with a square lattice ( period @xmath165 ) of 2d anisotropic ellipses ( green inset ) , versus spatial resolution , for a variety of sub - pixel smoothing techniques .",
    "straight lines for perfect linear ( black dashed ) and perfect quadratic ( black solid ) convergence are shown for reference . ]    in fig .",
    "[ fig:3dellipse3 ] , we also show results from a similar calculation in three dimensions . here , we look at the lowest eigenmode of a cubic lattice ( period @xmath165 ) of 3d ellipsoids ( oriented at a random angle ) made of @xmath21 surrounded by @xmath22 , both random positive - definite symmetric matrices as above .",
    "the frequency @xmath4 , at an arbitrarily chosen wavevector @xmath210 , corresponds to a vacuum wavelength @xmath211 .",
    "again , the new method almost always has the lowest error by a wide margin , especially if the unpredictable dips of the no - smoothing case are excluded , and is the only one to exhibit ( apparently ) better than linear convergence .",
    "relative error @xmath208 for an eigenmode calculation with cubic lattice ( period @xmath165 ) of 3d anisotropic ellipsoids ( green inset ) , versus spatial resolution , for a variety of sub - pixel smoothing techniques .",
    "straight lines for perfect linear ( black dashed ) and perfect quadratic ( black solid ) convergence are shown for reference . ]    our previous heuristic proposal from ref .",
    "@xcite , while better than the other smoothing schemes ( and less erratic than no smoothing ) , is clearly inferior to the new method .",
    "previously , we had observed what seemed to have been quadratic convergence from the heuristic scheme @xcite , but this result seems to have been fortuitous  as we demonstrated recently , even non - second - order schemes can sometimes appear to have second - order convergence over some range of resolutions for a particular geometry @xcite .",
    "the key distinction of the new scheme , that lends us greater confidence in it than one or two examples can convey , is that it is no longer heuristic .",
    "the new smoothing scheme is based on a clear analytical criterion  setting the first - order perturbative effect of the smoothing to zero  that explains why it should be an accurate choice in a wide variety of circumstances .",
    "we have shown how to correctly treat lowest - order perturbations to a boundary between two anisotropic materials , a problem for which previous approaches had been stymied by the complicated discontinuous boundary conditions on the electric field .",
    "this result immediately led to an improved subpixel smoothing scheme for discretized numerical methods  we demonstrated it for a planewave method , but we expect that it will similarly be applicable to other methods , e.g. fdtd @xcite . the same result can also be applied to constructing an effective - medium theory for subwavelength multilayer films of anisotropic materials .",
    "moreover , in the process of deriving our perturbative result , we developed a _",
    "local coordinate - transform _ approach that may be useful in treating many other types of interface perturbations , because it circumvents the difficulty of shifting discontinuities without requiring one to construct an explicit coordinate transformation .",
    "this work was supported in part by dr .",
    "dennis healy of darpa mto , under award n00014 - 05 - 1 - 0700 administered by the office of naval research .",
    "we are also grateful to i.  singer at mit for helpful discussions .",
    "as discussed in sec .  [ sub : coordinate - perturbations ] above , any differentiable coordinate transformation of maxwell s equations can be recast as merely a transformation of @xmath1 and @xmath2 , with the same solutions @xmath5 and @xmath6 only multiplied by a matrix in addition to the coordinate change @xcite .",
    "this result has been exploited by pendry et  al . to obtain a number of beautiful analytical results from cylindrical superlenses @xcite to `` invisibility '' cloaks @xcite . it",
    "( and related ideas ) can be used to derive coupled - mode expressions for bending loss in optical waveguides @xcite .",
    "a similar result has also been employed to design perfectly - matched layers ( pml ) , via a _ complex _",
    "coordinate stretching , to truncate numerical grids @xcite .",
    "it is likely that there are many other applications , as well as equivalent derivations , that we are not aware of . here , we review the proof in a compact form , generalized to arbitrary anisotropic media .",
    "( most previous derivations seem to have been for isotropic media in at least one coordinate frame @xcite , or for coordinate transformations with purely diagonal jacobians @xmath59 where @xmath212 depends only on @xmath213 @xcite , or for constant affine coordinate transforms @xcite . )",
    "we begin with the usual maxwell s equations for euclidean space ( in natural units ) : @xmath214 where @xmath215 and @xmath216 are the usual free current and charge densities , respectively",
    ". we will proceed in index notation , employing the einstein convention whereby repeated indices are summed over .",
    "ampere s law , eq .",
    "( [ eq : maxwell - h ] ) , is now expressed:@xmath217 where @xmath218 is the usual levi - civita permutation tensor and @xmath219 . under a coordinate change @xmath220 , if we let @xmath221 be the ( non - singular ) jacobian matrix associated with the coordinate transform ( which may be a function of @xmath53 ) , we have @xmath222 furthermore , as in eqs .",
    "( [ eq : e - trans][eq : h - trans ] ) , let @xmath223 hence , eq .",
    "( [ eq : maxwell - h - einstein ] ) becomes @xmath224 here , the @xmath225 derivative falls on both the @xmath226 and @xmath227 terms , but we can eliminate the former thanks to the @xmath218 : @xmath228 because @xmath229 .",
    "then , again multiplying both sides by the jacobian @xmath230 , we obtain @xmath231 noting that @xmath232 by definition of the determinant , we finally have@xmath233 or , back in vector notation , @xmath234 where @xmath235 .",
    "thus , we see that we can interpret ampere s law in arbitrary coordinates as the usual equation in euclidean coordinates , as long as we replace the materials etc . by eqs .",
    "( [ eq : e - trans][eq : eps - trans ] ) . by an identical argument , we obtain@xmath236 which yields the corresponding transformation ( [ eq : mu - trans ] ) for @xmath72 .",
    "the transformation of the remaining divergence equations into equivalent forms in the new coordinates is also straightforward .",
    "gauss s law , eq .",
    "( [ eq : maxwell - gauss - e ] ) , becomes @xmath237 which gives @xmath238 for @xmath239 .",
    "similarly for eq .",
    "( [ eq : maxwell - gauss - h ] ) . here",
    ", we have used the fact that@xmath240 from the cofactor formula for the matrix inverse , and recalling that @xmath228 from above . in particular , note that @xmath241 and @xmath242 , so a non - singular coordinate transformation preserves the absence ( or presence ) of sources .",
    "s.  g. johnson , m.  ibanescu , m.  a. skorobogatiy , o.  weisberg , j.  d. joannopoulos , and y.  fink , `` perturbation theory for maxwell s equations with shifting material boundaries , '' _ physical review  e _ , vol .",
    "65 , p.  066611",
    ", 2002 .",
    "a.  farjadpour , d.  roundy , a.  rodriguez , m.  ibanescu , p.  bermel , j.  d. joannopoulos , s.  g. johnson , and g.  w. burr , `` improving accuracy by subpixel smoothing in the finite - difference time domain , '' _ optics letters _",
    "31 , pp .  29722974 , 2006 .",
    "m.  lohmeyer , n.  bahlmann , and p.  hertel , `` geometry tolerance estimation for rectangular dielectric waveguide devices by means of perturbation theory , '' _ optics communications _ , vol .",
    "163 , pp .  8694 , 1999 .",
    "m.  skorobogatiy , s.  a. jacobs , s.  g. johnson , and y.  fink , `` geometric variations in high index - contrast waveguides , coupled mode theory in curvilinear coordinates , '' _ optics express _ , vol .",
    "10 , pp .  12271243 , 2002 .",
    "s.  g. johnson , m.  l. povinelli , m.  soljai , a.  karalis , s.  jacobs , and j.  d. joannopoulos , `` roughness losses and volume - current methods in photonic - crystal waveguides , '' _ appl .",
    "b _ , vol .  81 , pp .  283293 , 2005 .",
    "r.  d. meade , a.  m. rappe , k.  d. brommer , j.  d. joannopoulos , and o.  l. alerhand , `` accurate theoretical analysis of photonic band - gap materials , '' _ physical review  b _ , vol .",
    "48 , pp .",
    "84348437 , 1993 .",
    "erratum : s.  g. johnson , _ ibid .",
    "_ * 55 * , 15942 ( 1997 ) .",
    "s.  g. johnson , m.  ibanescu , m.  skorobogatiy , o.  weisberg , t.  d. engeness , m.  soljai , s.  a. jacobs , j.  d. joannopoulos , and y.  fink , `` low - loss asymptotically single - mode propagation in large - core omniguide fibers , '' _ optics express _ , vol .  9 , no .  13 , pp .",
    "748779 , 2001 .",
    "s.  g. johnson , p.  bienstman , m.  skorobogatiy , m.  ibanescu , e.  lidorikis , and j.  d. joannopoulos , `` adiabatic theorem and continuous coupled - mode theory for efficient taper transitions in photonic crystals , '' _ physical review  e _ , vol .",
    "66 , p.  066608",
    ", 2002 .",
    "s.  dey and r.  mittra , `` a conformal finite - difference time - domain technique for modelling cylindrical dielectric resonators , '' _ ieee transactions on microwave theory and techniques _ , vol .",
    "47 , no .  9 , pp .  17371739 , 1999 .",
    "j.  nadobny , d.  sullivan , w.  wlodarczyk , p.  deuflhard , and p.  wust , `` a 3-d tensor fdtd - formulation for treatment of sloped interfaces in electrically inhomogeneous media , '' _ ieee transactions on antennas and propagation _ , vol .",
    "51 , no .  8 , pp .  17601770 , 2003 .",
    "a.  mohammadi , h.  nadgaran , and m.  agio , `` contour - path effective permittivities for the two - dimensional finite - difference time - domain method , '' _ optics express _ , vol .  13 , no .  25 , pp .",
    "1036710381 , 2005 .",
    "f.  l. teixeira and w.  c. chew , `` general closed - form pml constitutive tensors to match arbitrary bianisotropic and dispersive linear media , '' _ ieee microwave and guided wave letters _ , vol .  8 , no .  6 , pp .",
    "223225 , 1998 ."
  ],
  "abstract_text": [
    "<S> we derive a correct first - order perturbation theory in electromagnetism for cases where an interface between two anisotropic dielectric materials is slightly shifted . </S>",
    "<S> most previous perturbative methods give incorrect results for this case , even to lowest order , because of the complicated discontinuous boundary conditions on the electric field at such an interface . </S>",
    "<S> our final expression is simply a surface integral , over the material interface , of the continuous field components from the unperturbed structure . </S>",
    "<S> the derivation is based on a `` localized '' coordinate - transformation technique , which avoids both the problem of field discontinuities and the challenge of constructing an explicit coordinate transformation by taking a limit in which a coordinate perturbation is infinitesimally localized around the boundary . not only is our result potentially useful in evaluating boundary perturbations , e.g. from fabrication imperfections , in highly anisotropic media such as many metamaterials , but it also has a direct application in numerical electromagnetism . in particular , we show how it leads to a sub - pixel smoothing scheme to ameliorate staircasing effects in discretized simulations of anisotropic media , in such a way as to greatly reduce the numerical errors compared to other proposed smoothing schemes . </S>"
  ]
}